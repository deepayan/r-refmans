<!DOCTYPE html><html lang="en"><head><title>Help for package dfmeta</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {dfmeta}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#dfmeta-package'>
<p>Meta-Analysis of Phase I Dose-Finding Early Phases Clinical Trials.</p></a></li>
<li><a href='#doseRecords'>
<p>Random Effect Analysis</p></a></li>
<li><a href='#findFirstLast'>
<p>The first or the last occurence of a unique value.</p></a></li>
<li><a href='#glimem'>
<p>The logistic regression mixed effect model.</p></a></li>
<li><a href='#MA_estimates'>
<p>Executing the random effect model-based algorithm (REMB).</p></a></li>
<li><a href='#plot+2CZKO+2Cmissing-method'><p>The graphical representation of dose-toxicity curve.</p></a></li>
<li><a href='#REMB-class'><p>An S4 class to represent the results using the random effect model-based (REMB) algorithm.</p></a></li>
<li><a href='#show-methods'><p>S4 Methods for Function <code>show</code></p></a></li>
<li><a href='#Toxdata'>
<p>A toxicity database.</p></a></li>
<li><a href='#VarWT'>
<p>The variance weighted (VarWT) pooling approach.</p></a></li>
<li><a href='#ZKO'>
<p>Meta-analysis approach based on Zohar et al, 2011.</p></a></li>
<li><a href='#ZKO-class'><p>An S4 class to represent the results using the ZKO algorithm.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Meta-Analysis of Phase I Dose-Finding Early Clinical Trials</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2018-03-25</td>
</tr>
<tr>
<td>Author:</td>
<td>Artemis Toumazi &lt;artemis.toumazi@gmail.com&gt;, Sarah Zohar &lt;sarah.zohar@inserm.fr&gt;, Anand N. Vidyashankar &lt;avidyash@gmu.edu&gt;, Jie Xu &lt;jxu13@gmu.edu&gt; and Moreno Ursino &lt;moreno.ursino@inserm.fr&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Artemis Toumazi &lt;artemis.toumazi@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Meta-analysis approaches for Phase I dose finding early phases clinical trials in order to better suit requirements in terms of maximum tolerated dose (MTD) and maximal dose regimen (MDR). This package has currently three different approaches: (a) an approach proposed by Zohar et al, 2011, &lt;<a href="https://doi.org/10.1002%2Fsim.4121">doi:10.1002/sim.4121</a>&gt; (denoted as ZKO), (b) the Variance Weighted pooling analysis (called VarWT) and (c) the Random Effects Model Based (REMB) algorithm, where user can input his/her own model based approach or use the existing random effect logistic regression model (named as glimem) through the 'dfmeta' package.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a> | file LICENSE</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.2), lme4, stats4, plyr, data.table</td>
</tr>
<tr>
<td>Imports:</td>
<td>ggplot2 (&ge; 2.0.0), methods, graphics, grDevices, stats, utils</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="http://github.com/artemis-toumazi/dfmeta">http://github.com/artemis-toumazi/dfmeta</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="http://github.com/artemis-toumazi/dfmeta/issues">http://github.com/artemis-toumazi/dfmeta/issues</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.0.1</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>C++11</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-03-25 14:13:52 UTC; artemistoumazi</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-03-27 16:01:30 UTC</td>
</tr>
</table>
<hr>
<h2 id='dfmeta-package'>
Meta-Analysis of Phase I Dose-Finding Early Phases Clinical Trials.
</h2><span id='topic+dfmeta-package'></span><span id='topic+dfmeta'></span>

<h3>Description</h3>

<p>Meta-analysis approaches for Phase I dose finding early phases clinical trials in order to better suit requirements in terms of maximum tolerated dose (MTD) and maximal dose regimem (MDR). This package has currently three different approaches: (a) an approach proposed by Zohar et al, 2011 (denoted as ZKO), (b) the Variance Weighted pooling analysis (called VarWT) and, (c) the Random 
Effects Model Based (REMB) algorithm, where user can put his/her own model based approach or use the existing random effect logistic regression model (named as glimem) through 'dfmeta' package.
</p>


<h3>Author(s)</h3>

<p>Artemis Toumazi &lt;artemis.toumazi@gmail.com&gt;, Sarah Zohar &lt;sarah.zohar@inserm.fr&gt;, Anand N. Vidyashankar &lt;avidyash@gmu.edu&gt;, Jie Xu &lt;jxu13@gmu.edu&gt; and Moreno Ursino &lt;moreno.ursino@inserm.fr&gt;
</p>
<p>Maintainer: Artemis Toumazi &lt;artemis.toumazi@gmail.com&gt;
</p>


<h3>References</h3>

<p>Zohar, S. , Katsahian, S. and O'Quigley, J. (2011), An approach to meta analysis of dose finding studies. Statist. Med., &lt;doi:10.1002/sim.4121&gt;.
</p>

<hr>
<h2 id='doseRecords'>
Random Effect Analysis
</h2><span id='topic+doseRecords'></span>

<h3>Description</h3>

<p>This function make a random effects analysis that can be used after in the random effects model based algorithm. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>doseRecords(data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="doseRecords_+3A_data">data</code></td>
<td>

<p>a data frame containing information for each patient at each simulation and trial.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Artemis Toumazi &lt;artemis.toumazi@gmail.com&gt;, Sarah Zohar &lt;sarah.zohar@inserm.fr&gt;, Anand N. Vidyashankar &lt;avidyash@gmu.edu&gt;, Jie Xu &lt;jxu13@gmu.edu&gt; and Moreno Ursino &lt;moreno.ursino@inserm.fr&gt;
</p>


<h3>References</h3>

<p>Zohar, S. , Katsahian, S. and O'Quigley, J. (2011), An approach to meta analysis of dose finding studies. Statist. Med., &lt;doi:10.1002/sim.4121&gt;.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MA_estimates">MA_estimates</a></code>, <code><a href="#topic+glimem">glimem</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  ################################################################
  ### Give a toxicity data for each simulation and each trial. ###
  ################################################################
  
  ### Using a toxicity data for each simulation and each trial including in the dfmeta package.
  data("Toxdata") 
  dim(Toxdata)
  colnames(Toxdata)
  
  ## NOTE: The toxicity dataset must have the same structure as below. ##
  ## Check it before running the VarWT function! ##
  str(Toxdata)
  
  analyf0 &lt;- Toxdata[order(Toxdata$simulation), ]


  ####################################################
  ## Taking the records from random effect analysis ##
  ####################################################
  rec &lt;- doseRecords(analyf0)
</code></pre>

<hr>
<h2 id='findFirstLast'>
The first or the last occurence of a unique value.
</h2><span id='topic+findFirstLast'></span>

<h3>Description</h3>

<p>This function can be used to find the first or the last occurence of each unique value in a column.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>findFirstLast(myDF, findFirst = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="findFirstLast_+3A_mydf">myDF</code></td>
<td>

<p>a data.frame or a matrix.
</p>
</td></tr>
<tr><td><code id="findFirstLast_+3A_findfirst">findFirst</code></td>
<td>

<p>a logical variable indicating the first or the last occurence.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>By default, it finds the first occurence (i.e. findFirst = TRUE). If instead, we want to find the last, we must set findFirst = FALSE.
</p>


<h3>Author(s)</h3>

<p>Artemis Toumazi &lt;artemis.toumazi@gmail.com&gt;, Sarah Zohar &lt;sarah.zohar@inserm.fr&gt;, Anand N. Vidyashankar &lt;avidyash@gmu.edu&gt;, Jie Xu &lt;jxu13@gmu.edu&gt; and Moreno Ursino &lt;moreno.ursino@inserm.fr&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+VarWT">VarWT</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  ################################################################
  ### Give a toxicity data for each simulation and each trial. ###
  ################################################################
  
  ### Using a toxicity data for each simulation and each trial including in the dfmeta package.
  
  data("Toxdata")
  dim(Toxdata)
  colnames(Toxdata)
  
  ## NOTE: The toxicity dataset must have the same structure as below. ##
  ## Check it before running the VarWT function! ##
  str(Toxdata)
  
  analyf0 &lt;- Toxdata[order(Toxdata$simulation), ] # sort the imported data by simulation.
  
  ## Using the function findFirstLast to find when starts the first trial. ##
  first.trial = findFirstLast(analyf0)$Trial
</code></pre>

<hr>
<h2 id='glimem'>
The logistic regression mixed effect model. 
</h2><span id='topic+glimem'></span>

<h3>Description</h3>

<p>This function corresponds to the generalized logistic regression mixed effect model. This model is a model-based method for combining toxicities across the trials and cycles. We model:
</p>
<p style="text-align: center;"><code class="reqn">log(\frac{R_{ij}(x)}{1 - R_{ij}(x)}) = \mu_{ij}(x) + Z_i,</code>
</p>

<p>where <code class="reqn">Z_{i}</code>'s are assumed to be i.i.d <code class="reqn">\mathcal{N}(0, \sigma^{2}(x))</code>. Notice that <code class="reqn">\mu_{i1}(x), \mu_{i2}(x),..., \mu_{iP}(x) = \bar{\mu}_i</code> represents the mean toxicities on the logit scale across the cycles.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>glimem(simData, sim0, sim1, family = binomial, link = "logit", nAGQ, 
  control = glmerControl(optimizer = "bobyqa"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="glimem_+3A_simdata">simData</code></td>
<td>

<p>a data frame containing the variables named in the formula (i.e. a toxicity data for each patient at each simulation and trial.
</p>
</td></tr>
<tr><td><code id="glimem_+3A_sim0">sim0</code></td>
<td>

<p>the simulation starting point; defaults to the minimum number of the simulation in the given data frame.
</p>
</td></tr>
<tr><td><code id="glimem_+3A_sim1">sim1</code></td>
<td>

<p>the simulation ending point; defaults to the maximum number of the simulation in the given data frame.
</p>
</td></tr>
<tr><td><code id="glimem_+3A_family">family</code></td>
<td>

<p>a distribution family for the response variable; defaults to binomial distribution. See <code><a href="stats.html#topic+glm">glm</a></code> and <code>glmer</code> for details.
</p>
</td></tr>
<tr><td><code id="glimem_+3A_link">link</code></td>
<td>

<p>a specification for the model link function. This can be a name/expression, a literal character string or a length-one character vector; defaults to logit link function. See <code>glmer</code> for details.
</p>
</td></tr>
<tr><td><code id="glimem_+3A_nagq">nAGQ</code></td>
<td>

<p>an integer scalar - the number of points per axis for evaluating the adaptive Gauss-Hermite approximation to the log-likelihood; defaults to 1, corresponding to the Laplace approximation. Values greater than 1 produce greater accuracy in the evaluation of the log-likelihood at the expense of speed. 
</p>
</td></tr>
<tr><td><code id="glimem_+3A_control">control</code></td>
<td>

<p>a list (of correct class, resulting from <code>lmerControl</code>() or <code>glmerControl</code>() respectively) containing control parameters, including the nonlinear optimizer to be used and parameters to be passed through to the nonlinear optimizer, see the *lmerControl* documentation for details.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list is returned, consisting of the generalized logistic regression mixed effect model's results. The output generated by this function contains the following components: 
</p>
<table role = "presentation">
<tr><td><code>m</code></td>
<td>
<p>a summary of the generalized logistic regression model.</p>
</td></tr>
<tr><td><code>coeff</code></td>
<td>
<p>the random and the fixed effects coefficients for each explanatory variable for each level of each grouping factor.</p>
</td></tr>
<tr><td><code>simData</code></td>
<td>
<p>a data frame including the predicted values and the residuals for the selected simulation.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Artemis Toumazi &lt;artemis.toumazi@gmail.com&gt;, Sarah Zohar &lt;sarah.zohar@inserm.fr&gt;, Anand N. Vidyashankar &lt;avidyash@gmu.edu&gt;, Jie Xu &lt;jxu13@gmu.edu&gt; and Moreno Ursino &lt;moreno.ursino@inserm.fr&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MA_estimates">MA_estimates</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  ## Not run: 
    ################################################################
    ### Give a toxicity data for each simulation and each trial. ###
    ################################################################
    
    ### Using a toxicity data for each simulation and each trial including in the dfmeta package.
    data("Toxdata")
    dim(Toxdata)
    colnames(Toxdata)
    
    ## NOTE: The toxicity dataset must have the same structure as below. ##
    ## Check it before running the VarWT function! ##
    str(Toxdata)
    
    analyf0 &lt;- Toxdata[order(Toxdata$simulation), ]
    
    ## Using the random effect analysis's function including in the dfmeta package ##
    simData &lt;- doseRecords(analyf0)
    NewData &lt;- simData$doseRecords
    
    ########################################################################################
    ## In the following example the function glimem is using to find the predicted random ##  
    ###################### effect center mu only for the simulation 10 #####################
    ########################################################################################
    
    mod &lt;- glimem(NewData, 10, 10, family = binomial, link = "logit", nAGQ = 1, 
                  control = glmerControl(optimizer = "bobyqa"))
    mod
  
## End(Not run)
</code></pre>

<hr>
<h2 id='MA_estimates'>
Executing the random effect model-based algorithm (REMB).
</h2><span id='topic+MA_estimates'></span>

<h3>Description</h3>

<p>This function computes the meta-analysis estimates using one of the random effect model-based algorithms.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MA_estimates(data, sim0, sim1, family = binomial, link = "logit", nAGQ = 1, 
control = glmerControl(optimizer = "bobyqa"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MA_estimates_+3A_data">data</code></td>
<td>

<p>a data frame containing the variables named in the formula (i.e. a toxicity data for each patient at each simulation and trial. 
</p>
</td></tr>
<tr><td><code id="MA_estimates_+3A_sim0">sim0</code></td>
<td>

<p>the simulation starting point; defaults to the minimum number of the simulation in the given data frame. 
</p>
</td></tr>
<tr><td><code id="MA_estimates_+3A_sim1">sim1</code></td>
<td>

<p>the simulation ending point; defaults to the maximum number of the simulation in the given data frame.
</p>
</td></tr>
<tr><td><code id="MA_estimates_+3A_family">family</code></td>
<td>

<p>a distribution family for the response variable; defaults to binomial distribution. See <code><a href="stats.html#topic+glm">glm</a></code> and <code>glmer</code> for details. 
</p>
</td></tr>
<tr><td><code id="MA_estimates_+3A_link">link</code></td>
<td>

<p>a specification for the model link function. This can be a name/expression, a literal character string or a length-one character vector; defaults to logit link function. See <code>glmer</code> for details. 
</p>
</td></tr>
<tr><td><code id="MA_estimates_+3A_nagq">nAGQ</code></td>
<td>

<p>an integer scalar - the number of points per axis for evaluating the adaptive Gauss-Hermite approximation to the log-likelihood; defaults to 1, corresponding to the Laplace approximation. Values greater than 1 produce greater accuracy in the evaluation of the log-likelihood at the expense of speed.
</p>
</td></tr>
<tr><td><code id="MA_estimates_+3A_control">control</code></td>
<td>

<p>a list (of correct class, resulting from <code>lmerControl</code>() or <code>glmerControl</code>() respectively) containing control parameters, including the nonlinear optimizer to be used and parameters to be passed through to the nonlinear optimizer, see the *lmerControl* documentation for details.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class &quot;REMB&quot; is returned, consisting of prediction of the probability of toxicity and estimations. Objects generated by MA_estimates contain at least the following components:
</p>
<table role = "presentation">
<tr><td><code>dataTox</code></td>
<td>
<p>A data frame containing information for each patient at each simulation and trial.</p>
</td></tr>
<tr><td><code>sim0</code></td>
<td>
<p>The simulation starting point; must be numeric.</p>
</td></tr>
<tr><td><code>sim1</code></td>
<td>
<p>The simulation ending point; must be numeric.</p>
</td></tr>
<tr><td><code>family</code></td>
<td>
<p>A distribution family for the response variable; defaults to binomial distribution. See <code><a href="stats.html#topic+glm">glm</a></code> and <code>glmer</code> for details.</p>
</td></tr>
<tr><td><code>link</code></td>
<td>
<p>A specification for the model link function. This can be a name/expression, a literal character string or a length-one character vector; defaults to logit link function. See <code>glmer</code> for details.</p>
</td></tr>
<tr><td><code>estimates</code></td>
<td>
<p>A data frame including the predicted toxicity probabilities (column named as &quot;rndpt&quot;), at each simulation, trial and dose, using either the predicted random effect center &quot;mu&quot; (column named as &quot;PredMu&quot;), if it's available, or the value ratio (i.e. # of toxicities / # of subjects) if the corresponding &quot;mu&quot; is not available. Note that, &quot;PredMu&quot; value is equal to &quot;NA&quot; when there is no prediction for it.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Artemis Toumazi &lt;artemis.toumazi@gmail.com&gt;, Sarah Zohar &lt;sarah.zohar@inserm.fr&gt;, Anand N. Vidyashankar &lt;avidyash@gmu.edu&gt;, Jie Xu &lt;jxu13@gmu.edu&gt; and Moreno Ursino &lt;moreno.ursino@inserm.fr&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+glimem">glimem</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  ## Not run: 
    ################################################################
    ### Give a toxicity data for each simulation and each trial. ###
    ############ using "Toxdata"" including in package #############
    ################################################################
    
    data("Toxdata")
    dim(Toxdata)
    colnames(Toxdata)
    
    ## NOTE: The toxicity dataset must have the same structure as below. ##
    ## Check it before running the VarWT function! ##
    
    str(Toxdata)
    
    ## Running the MA_estimates function! ##

    test &lt;- MA_estimates(Toxdata, 10, 10, family = binomial, link = "logit", nAGQ = 1, 
    			 control = glmerControl(optimizer = "bobyqa"))
    
    ### You can see the "show" S4 method to present the REMB algorithm's results
    test

    ##################################################
    ## Taking the predicted probability of toxicity ##
    ##################################################
    
    test@estimates
  
## End(Not run)
</code></pre>

<hr>
<h2 id='plot+2CZKO+2Cmissing-method'>The graphical representation of dose-toxicity curve.</h2><span id='topic+plot+2CZKO+2Cmissing-method'></span>

<h3>Description</h3>

<p>A plotting function representing graphically the dose-toxicity relationship including the target probability of toxicity. In addition you can see as circles the proportional sizes of the number of patients evaluated for toxicity at each dose level.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'ZKO,missing'
plot(x, y = NA, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot+2B2CZKO+2B2Cmissing-method_+3A_x">x</code></td>
<td>
<p>a &quot;ZKO&quot; object.</p>
</td></tr>
<tr><td><code id="plot+2B2CZKO+2B2Cmissing-method_+3A_y">y</code></td>
<td>
<p>the &quot;y&quot; argument is not used in the plot-method for &quot;ZKO&quot; object.</p>
</td></tr>
<tr><td><code id="plot+2B2CZKO+2B2Cmissing-method_+3A_...">...</code></td>
<td>
<p>other arguments to the <code><a href="graphics.html#topic+graphics">plot.default</a></code> function can be passed here.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Artemis Toumazi &lt;artemis.toumazi@gmail.com&gt;, Sarah Zohar &lt;sarah.zohar@inserm.fr&gt;, Anaund N. Vidyashankar &lt;avidyash@gmu.edu&gt;, Jie Xu &lt;jxu13@gmu.edu&gt; and Moreno Ursino &lt;moreno.ursino@inserm.fr&gt;
</p>


<h3>References</h3>

<p>Zohar, S. , Katsahian, S. and O'Quigley, J. (2011), An approach to meta analysis of dose finding studies. Statist. Med., &lt;doi:10.1002/sim.4121&gt;.
</p>

<hr>
<h2 id='REMB-class'>An S4 class to represent the results using the random effect model-based (REMB) algorithm.</h2><span id='topic+REMB-class'></span>

<h3>Description</h3>

<p>An S4 class to represent the results using the random effect model-based (REMB) algorithm.
</p>


<h3>Slots</h3>


<dl>
<dt><code>dataTox</code></dt><dd><p>A data frame containing information for each patient at each simulation and trial.</p>
</dd>
<dt><code>sim0</code></dt><dd><p>The simulation starting point; must be numeric.</p>
</dd>
<dt><code>sim1</code></dt><dd><p>The simulation ending point; must be numeric.</p>
</dd>
<dt><code>family</code></dt><dd><p>A distribution family for the response variable; defaults to binomial distribution. See <code><a href="stats.html#topic+glm">glm</a></code> and <code>glmer</code> for details.</p>
</dd>
<dt><code>link</code></dt><dd><p>A specification for the model link function. This can be a name/expression, a literal character string or a length-one character vector; defaults to logit link function. See <code>glmer</code> for details.</p>
</dd>
<dt><code>estimates</code></dt><dd><p>A data frame including the predicted toxicity probabilities (column named as &quot;rndpt&quot;) using either the predicted random effect center &quot;mu&quot; (column named as &quot;PredMu&quot;), if it's available, or the value ratio (i.e. # of toxicities / # of subjects) if the corresponding &quot;mu&quot; is not available. Note that, &quot;PredMu&quot; value is equal to &quot;NA&quot; when there is no prediction for it.</p>
</dd>
</dl>

<hr>
<h2 id='show-methods'>S4 Methods for Function <code>show</code></h2><span id='topic+show-methods'></span><span id='topic+show+2CZKO-method'></span><span id='topic+show+2CREMB-method'></span>

<h3>Description</h3>

<p>S4 Methods for function <code>show</code>.
</p>


<h3>Methods</h3>


<dl>
<dt><code>signature(object = "ZKO")</code></dt><dd>
<p>S4 method to store and present the ZKO algorithm's results. 
</p>
</dd>
<dt><code>signature(object = "REMB")</code></dt><dd>
<p>S4 method to store and present the REMB algorithm's results.
</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Artemis Toumazi &lt;artemis.toumazi@gmail.com&gt;, Sarah Zohar &lt;sarah.zohar@inserm.fr&gt;, Anand N. Vidyashankar &lt;avidyash@gmu.edu&gt;, Jie Xu &lt;jxu13@gmu.edu&gt; and Moreno Ursino &lt;moreno.ursino@inserm.fr&gt;
</p>

<hr>
<h2 id='Toxdata'>
A toxicity database.
</h2><span id='topic+Toxdata'></span>

<h3>Description</h3>

<p>A dataframe consisting 60000 observations of 6 different variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("Toxdata")</code></pre>


<h3>Format</h3>

<p>A data frame with 60000 observations on the following 6 variables.
</p>

<dl>
<dt><code>simulation</code></dt><dd><p>a numeric vector including the simulation.</p>
</dd>
<dt><code>dose</code></dt><dd><p>a numeric vector of the dose levels.</p>
</dd>
<dt><code>Trial</code></dt><dd><p>a numeric vector which gives the number of the trial.</p>
</dd>
<dt><code>n</code></dt><dd><p>a numeric vector of the number of allocation.</p>
</dd>
<dt><code>x</code></dt><dd><p>a numeric vector giving the number of toxicities.</p>
</dd>
<dt><code>trueptoxic</code></dt><dd><p>a numeric vector consisting the true probability of toxicity.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Artemis Toumazi &lt;artemis.toumazi@gmail.com&gt;, Sarah Zohar &lt;sarah.zohar@inserm.fr&gt;, Anand N. Vidyashankar &lt;avidyash@gmu.edu&gt;, Jie Xu &lt;jxu13@gmu.edu&gt; and Moreno Ursino &lt;moreno.ursino@inserm.fr&gt;
</p>


<h3>References</h3>

<p>Zohar, S., Katsahian, S. and O'Quigley, J. (2011), An approach to meta-analysis of dose-finding studies. Statist. Med.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("Toxdata")  
## maybe str(Toxdata): plot(Toxdata) ...
</code></pre>

<hr>
<h2 id='VarWT'>
The variance weighted (VarWT) pooling approach. 
</h2><span id='topic+VarWT'></span>

<h3>Description</h3>

<p>An alternative method to combine toxicities across the trials. Accordingly, we estimate the pooled toxicity probability at dose level x using the </p>
<p style="text-align: center;"><code class="reqn">R_c(x) = \sum_{i=1}^{R} \frac{\sigma_{i}^2 (x)}{\sigma^{2}(x)} \bar{R_i}(x),</code>
</p>
<p> where </p>
<p style="text-align: center;"><code class="reqn">\sigma_{i}^2(x) = N_i(x)\bar{R_i}(x)(1-\bar{R_i}(x))</code>
</p>
<p> and </p>
<p style="text-align: center;"><code class="reqn">\sigma^{2}(x) = \sum_{i=1}^{R} \sigma_i^2 (x), x \in D.</code>
</p>

<p>Then, to find the pooled estimates of MTD you can use either (a) the non-parametric pooled MTD estimator can be definied by the dose <code class="reqn">x_0 \in D</code> such that:
</p>
<p style="text-align: center;"><code class="reqn">|R_c(\hat{x_0}) - \theta| &lt;= |R_c(x) - \theta|,  x \neq \hat{x_0}</code>
</p>

<p>OR (b) the model-based algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>VarWT(dataTox, saveName)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="VarWT_+3A_datatox">dataTox</code></td>
<td>

<p>a data frame containing information for each patient at each simulation and trial.
</p>
</td></tr>
<tr><td><code id="VarWT_+3A_savename">saveName</code></td>
<td>

<p>the name of the .txt output which will be created and saved in the current working directory; must be in characters; defaults to NULL. If saveName = NULL, means that nothing will be saved in the working directory.
</p>
</td></tr>
</table>


<h3>Value</h3>

 
<p>A list is returned, combining the toxicities across the trials. The output, generated by the function VarWT, contains the following components:
</p>
<table role = "presentation">
<tr><td><code>dataTox</code></td>
<td>

<p>A data frame containing the estimated pooled toxicity probabilities at each dose level for each simulation.
</p>
</td></tr>
</table>
<p>If saveName is not equal to &quot;NULL&quot; then a .txt file is saved in the working directory storing the estimated pooled toxicity probabilities at each dose level for each simulation.
</p>


<h3>Author(s)</h3>

<p>Artemis Toumazi &lt;artemis.toumazi@gmail.com&gt;, Sarah Zohar &lt;sarah.zohar@inserm.fr&gt;, Anand N. Vidyashankar &lt;avidyash@gmu.edu&gt;, Jie Xu &lt;jxu13@gmu.edu&gt; and Moreno Ursino &lt;moreno.ursino@inserm.fr&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ZKO">ZKO</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  ## Not run: 
    ## Using the toxicity dataset for each simulation and each trial, which is 
    ## existing in the dfmeta package.
    
    data("Toxdata")
    dim(Toxdata)
    colnames(Toxdata)
    
    ## NOTE: The toxicity dataset must have the same structure as below. ##
    ## Check it before running the VarWT function! ##
    
    str(Toxdata)

    #################################
    ## Running the VarWT function! ##
    #################################
    
    WT &lt;- VarWT(Toxdata)
    
    ######### If we want to save the result in a text file ###########
    ####### we need to give a name in the argument "saveName" ########
    
    WT &lt;- VarWT(Toxdata, tempdir())
  
## End(Not run)
</code></pre>

<hr>
<h2 id='ZKO'>
Meta-analysis approach based on Zohar et al, 2011. 
</h2><span id='topic+ZKO'></span>

<h3>Description</h3>

<p>This function utilizes the meta-analysis approach proposed by Zohar et al, 2011. It utilizes the power model </p>
<p style="text-align: center;"><code class="reqn">\Psi(x, \alpha) = (\alpha(x))^{a}</code>
</p>
<p> in order to estimate <code class="reqn">a</code> by running simulated CRMs using </p>
<p style="text-align: center;"><code class="reqn">R_C(x) = \sum_{i=1}^{r} \frac{N_{i.}}{N_{..}} \bar{R_i}(x).</code>
</p>
<p> Then the estimated dose-toxicity curve is used to estimate the maximum tolerated dose (MTD). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ZKO(dataTox, doses, target = 0.3, dr, nbSimu)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ZKO_+3A_datatox">dataTox</code></td>
<td>

<p>a data frame containing information for each patient at each simulation and trial. The data frame must have the following structure with the column's names be set as: 1) &quot;doses&quot;, representing the drug's dose levels, 2) &quot;proba&quot;, representing the true probabilities of toxicity, 3) &quot;nbPatients&quot;, representing the number of patients at each dose level and 4) &quot;nbTox&quot;, representing the number of DLTs obtained at each dose level. The data frames with different structure will not be accepted in the function.
</p>
</td></tr>
<tr><td><code id="ZKO_+3A_doses">doses</code></td>
<td>

<p>a vector containing the drug's dose levels.
</p>
</td></tr>
<tr><td><code id="ZKO_+3A_target">target</code></td>
<td>

<p>the target of the probability of toxicity; defaults to 0.3.
</p>
</td></tr>
<tr><td><code id="ZKO_+3A_dr">dr</code></td>
<td>

<p>the initial guess of dose-toxicity relationship (usually is selected based on information from experts).
</p>
</td></tr>
<tr><td><code id="ZKO_+3A_nbsimu">nbSimu</code></td>
<td>

<p>the number of simulated CRM studies.  
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class &quot;ZKO&quot; is returned, consisting the estimated probability of toxicity. Objects generated by ZKO function contain at least the following components:
</p>
<table role = "presentation">
<tr><td><code>dataTox</code></td>
<td>
<p>A data frame containing information for each patient at each simulation and trial. The data frame must be have the following structure with the column's names be set as: 1) &quot;doses&quot;, 2) &quot;proba&quot;, 3) &quot;nbPatients&quot; and 4) &quot;nbTox&quot;. Note that, any data frames with different structure will not be accepted in the function.</p>
</td></tr>
<tr><td><code>target</code></td>
<td>
<p>The target of probability of toxicity.</p>
</td></tr>
<tr><td><code>doses</code></td>
<td>
<p>A vector with the doses panel.</p>
</td></tr>
<tr><td><code>ti</code></td>
<td>
<p>A vector including the total number of toxicities at each dose level.</p>
</td></tr>
<tr><td><code>ni</code></td>
<td>
<p>A vector consisting the total number of patients at each dose level.</p>
</td></tr>
<tr><td><code>realite</code></td>
<td>
<p>A vector with the observed toxicity probabilities at each dose level.</p>
</td></tr>
<tr><td><code>relfreq</code></td>
<td>
<p>A vector with the mean relative frequencies of allocation at each dose level.</p>
</td></tr>
<tr><td><code>estimAlpha</code></td>
<td>
<p>The estimated value for variable alpha.</p>
</td></tr>
<tr><td><code>estimProb</code></td>
<td>
<p>The estimated probability of toxicity.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Artemis Toumazi &lt;artemis.toumazi@gmail.com&gt;, Sarah Zohar &lt;sarah.zohar@inserm.fr&gt;, Anand N. Vidyashankar &lt;avidyash@gmu.edu&gt;, Jie Xu &lt;jxu13@gmu.edu&gt; and Moreno Ursino &lt;moreno.ursino@inserm.fr&gt;
</p>


<h3>References</h3>

<p>Zohar, S., Katsahian, S. and O'Quigley, J. (2011), An approach to meta analysis of dose finding studies. Statist. Med., &lt;doi:10.1002/sim.4121&gt;.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+VarWT">VarWT</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  ## Not run: 
  
  	###############################################
  	#### A simple example using a simple data #####
  	###############################################
  
  	vanGroeningen &lt;- rbind(c(25,0/6, 6), c(35, 0/5,5), c(40, 4/11, 11), c(45, 3/5, 5))
  	Hoff &lt;- rbind(c(30, 3/9, 9), c(35, 2/3, 3), c(40, 2/3, 3))
  	Zhu &lt;- rbind(c(30, 0/12, 12), c(35, 2/3, 3))
  	dataTox &lt;- rbind(vanGroeningen, Hoff, Zhu)
  	dataTox &lt;- data.frame(dataTox)
  	colnames(dataTox) &lt;- c("doses", "proba", "nbPatients")
  	nbTox &lt;- dataTox$proba*dataTox$nbPatients
  	dataTox &lt;- data.frame(dataTox, nbTox)
  	doses &lt;- c(25, 30, 35, 40, 45)
  	nbSimu &lt;- 10
  	zko &lt;- ZKO(dataTox, doses, target = 0.3, dr = c(0.05, 0.15, 0.2, 0.3, 0.35), nbSimu)
    
  	###########################################################################
  	################ A second example using the data "Toxdata" ################
  	################### included in the "dfmeta" R package ####################
  	###########################################################################
  
  	data(Toxdata)
  	pos &lt;- which(Toxdata$simulation == 0)
  	dataTox2 &lt;- Toxdata[pos, ]
  	dataTox2 &lt;- dataTox2[, c(2,6,4,5)]
  
  	### Remember that the structure of the database must be in the following structure ###
  
  	colnames(dataTox2) &lt;- c("doses", "proba", "nbPatients", "nbTox")
  	doses &lt;- 0:5
  	nbSimu &lt;- 10
  	zko2 &lt;- ZKO(dataTox2, doses, target = 0.3, dr = c(0.05, 0.15, 0.2, 0.3, 0.35, 0.45),
  	nbSimu)
  
## End(Not run)
</code></pre>

<hr>
<h2 id='ZKO-class'>An S4 class to represent the results using the ZKO algorithm.</h2><span id='topic+ZKO-class'></span>

<h3>Description</h3>

<p>An S4 class to represent the results using the ZKO algorithm.
</p>


<h3>Slots</h3>


<dl>
<dt><code>dataTox</code></dt><dd><p>A data frame containing information for each patient at each simulation and trial.</p>
</dd>
<dt><code>target</code></dt><dd><p>The target of probability of toxicity.</p>
</dd>
<dt><code>doses</code></dt><dd><p>A vector with the doses panel.</p>
</dd>
<dt><code>ti</code></dt><dd><p>A vector including the total number of toxicities at each dose level.</p>
</dd>
<dt><code>ni</code></dt><dd><p>A vector consisting the total number of patients at each dose level.</p>
</dd>
<dt><code>realite</code></dt><dd><p>A vector with the observed toxicity probabilities at each dose level.</p>
</dd>
<dt><code>relfreq</code></dt><dd><p>A vector with the mean relative frequencies of allocation at each dose level.</p>
</dd>
<dt><code>estimAlpha</code></dt><dd><p>The estimated value for variable alpha.</p>
</dd>
<dt><code>estimProb</code></dt><dd><p>The estimated probability of toxicity.</p>
</dd>
</dl>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
