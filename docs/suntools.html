<!DOCTYPE html><html><head><title>Help for package suntools</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {suntools}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#suntools-package'><p>suntools: calculate sun position, sunrise, sunset, solar noon and twilight</p></a></li>
<li><a href='#.balanceCrdsTimes'><p>Balance coordinates and times</p></a></li>
<li><a href='#crepuscule'><p>Compute crepuscular time</p></a></li>
<li><a href='#solarnoon'><p>Compute solar noon time</p></a></li>
<li><a href='#solarpos'><p>Compute solar position</p></a></li>
<li><a href='#sunriset'><p>Calculate sunrise/sunset</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-06-08</td>
</tr>
<tr>
<td>Title:</td>
<td>Calculate Sun Position, Sunrise, Sunset, Solar Noon and Twilight</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods, sf, stats</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides a set of convenient functions for calculating sun-related information, including the sun's position (elevation and azimuth), and the times of sunrise, sunset, solar noon, and twilight for any given geographical location on Earth. These calculations are based on equations provided by the National Oceanic &amp; Atmospheric Administration (NOAA) <a href="https://gml.noaa.gov/grad/solcalc/calcdetails.html">https://gml.noaa.gov/grad/solcalc/calcdetails.html</a> as described in "Astronomical Algorithms" by Jean Meeus (1991, ISBN: 978-0-943396-35-4). A resource for researchers and professionals working in fields such as climatology, biology, and renewable energy.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/adokter/suntools/">https://github.com/adokter/suntools/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/adokter/suntools/issues">https://github.com/adokter/suntools/issues</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-07-05 17:12:26 UTC; alexandertedeschi</td>
</tr>
<tr>
<td>Author:</td>
<td>Roger Bivand <a href="https://orcid.org/0000-0003-2392-6140"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Adriaan M. Dokter <a href="https://orcid.org/0000-0001-6573-066X"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb, cre],
  Pieter Huybrechts <a href="https://orcid.org/0000-0002-6658-6062"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb],
  Sebastian Luque [aut],
  Greg Pelletier [ctb],
  Alexander Tedeschi
    <a href="https://orcid.org/0000-0003-0772-6931"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Adriaan M. Dokter &lt;amd427@cornell.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-07-06 14:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='suntools-package'>suntools: calculate sun position, sunrise, sunset, solar noon and twilight</h2><span id='topic+suntools'></span><span id='topic+suntools-package'></span>

<h3>Description</h3>

<p>Provides a set of convenient functions for calculating sun-related information, including the sun's position (elevation and azimuth), and the times of sunrise, sunset, solar noon, and twilight for any given geographical location on Earth. These calculations are based on equations provided by the National Oceanic &amp; Atmospheric Administration (NOAA) <a href="https://gml.noaa.gov/grad/solcalc/calcdetails.html">https://gml.noaa.gov/grad/solcalc/calcdetails.html</a> as described in &quot;Astronomical Algorithms&quot; by Jean Meeus (1991, ISBN: 978-0-943396-35-4). A helpful resource for researchers and professionals working in fields such as climatology, biology, and renewable energy.
</p>


<h3>Details</h3>

<p>suntools provides functions for calculating the sun's position, sunrise, sunset,
solar noon, and crepuscular (twilight) times for any given geographical location and time on earth.
</p>
<p>Main package functions:
</p>

<ul>
<li> <p><code><a href="#topic+crepuscule">crepuscule()</a></code>: Calculates crepuscular (twilight) times, i.e. the time of dawn or dusk.
</p>
</li>
<li> <p><code><a href="#topic+sunriset">sunriset()</a></code>: Calculates the times of sunrise and sunset at a given location.
</p>
</li>
<li> <p><code><a href="#topic+solarpos">solarpos()</a></code>: Calculates the solar position (elevation and azimuth) at a given location and time.
</p>
</li>
<li> <p><code><a href="#topic+solarnoon">solarnoon()</a></code>: Calculates solar noon time at a given location.
</p>
</li></ul>



<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Adriaan M. Dokter <a href="mailto:amd427@cornell.edu">amd427@cornell.edu</a> (<a href="https://orcid.org/0000-0001-6573-066X">ORCID</a>) [contributor]
</p>
<p>Authors:
</p>

<ul>
<li><p> Roger Bivand <a href="mailto:Roger.Bivand@nhh.no">Roger.Bivand@nhh.no</a> (<a href="https://orcid.org/0000-0003-2392-6140">ORCID</a>)
</p>
</li>
<li><p> Sebastian Luque
</p>
</li></ul>

<p>Other contributors:
</p>

<ul>
<li><p> Pieter Huybrechts <a href="mailto:pieter.huybrechts@inbo.be">pieter.huybrechts@inbo.be</a> (<a href="https://orcid.org/0000-0002-6658-6062">ORCID</a>) [contributor]
</p>
</li>
<li><p> Greg Pelletier [contributor]
</p>
</li>
<li><p> Alexander Tedeschi <a href="mailto:at744@cornell.edu">at744@cornell.edu</a> (<a href="https://orcid.org/0000-0003-0772-6931">ORCID</a>) [contributor]
</p>
</li></ul>



<h3>References</h3>

<p>This package uses algorithms provided by the National Oceanic &amp; Atmospheric Administration (NOAA), for more information see
</p>

<ul>
<li><p> NOAA's <a href="https://gml.noaa.gov/grad/solcalc/sunrise.html">Sunrise/Sunset Calculator</a>
</p>
</li>
<li><p> NOAA's <a href="https://gml.noaa.gov/grad/solcalc/azel.html">Solar Position Calculator</a>
</p>
</li>
<li><p> Meeus, J. (1991) Astronomical Algorithms. Willmann-Bell, Inc.
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/adokter/suntools/">https://github.com/adokter/suntools/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/adokter/suntools/issues">https://github.com/adokter/suntools/issues</a>
</p>
</li></ul>


<hr>
<h2 id='.balanceCrdsTimes'>Balance coordinates and times</h2><span id='topic+.balanceCrdsTimes'></span>

<h3>Description</h3>

<p>Ensures that the 'crds' and 'dateTime' inputs have the same number of rows.
If 'crds' has a single row but 'dateTime' has multiple rows, 'crds' is replicated to match 'dateTime'.
Similarly, if 'dateTime' has a single row but 'crds' has multiple rows, 'dateTime' is replicated to match 'crds'.
If 'crds' and 'dateTime' have different numbers of rows and neither has just one row, an error is thrown.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.balanceCrdsTimes(crds, dateTime)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".balanceCrdsTimes_+3A_crds">crds</code></td>
<td>
<p>A matrix with longitude and latitude coordinates.</p>
</td></tr>
<tr><td><code id=".balanceCrdsTimes_+3A_datetime">dateTime</code></td>
<td>
<p>A matrix with year, month, day, timezone, and daylight saving time rows, or a POSIXct time.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with 'crds' and 'dateTime' matrices, both with the same number of rows.
</p>

<hr>
<h2 id='crepuscule'>Compute crepuscular time</h2><span id='topic+crepuscule'></span><span id='topic+crepuscule+2Csf+2CPOSIXct-method'></span><span id='topic+crepuscule+2Cmatrix+2CPOSIXct-method'></span><span id='topic+crepuscule+2CSpatialPoints+2CPOSIXct-method'></span>

<h3>Description</h3>

<p>Calculates the crepuscular time, i.e., the time of dawn or dusk
at a specific geographical location and time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crepuscule(crds, dateTime, ...)

## S4 method for signature 'sf,POSIXct'
crepuscule(
  crds,
  dateTime,
  solarDep,
  direction = c("dawn", "dusk"),
  POSIXct.out = FALSE
)

## S4 method for signature 'matrix,POSIXct'
crepuscule(
  crds,
  dateTime,
  crs = sf::st_crs(4326),
  solarDep,
  direction = c("dawn", "dusk"),
  POSIXct.out = FALSE
)

## S4 method for signature 'SpatialPoints,POSIXct'
crepuscule(
  crds,
  dateTime,
  solarDep,
  direction = c("dawn", "dusk"),
  POSIXct.out = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="crepuscule_+3A_crds">crds</code></td>
<td>
<p>Geographical coordinates. It can be an object of
class <code>sf</code>, <code>matrix</code>, or <code>SpatialPoints</code>.</p>
</td></tr>
<tr><td><code id="crepuscule_+3A_datetime">dateTime</code></td>
<td>
<p>A <code>POSIXct</code> object representing the date and time.</p>
</td></tr>
<tr><td><code id="crepuscule_+3A_...">...</code></td>
<td>
<p>Additional arguments that are passed to methods.</p>
</td></tr>
<tr><td><code id="crepuscule_+3A_solardep">solarDep</code></td>
<td>
<p>A numerical value representing the solar depression angle.</p>
</td></tr>
<tr><td><code id="crepuscule_+3A_direction">direction</code></td>
<td>
<p>Character, determines whether to calculate the time of sunrise or sunset.</p>
</td></tr>
<tr><td><code id="crepuscule_+3A_posixct.out">POSIXct.out</code></td>
<td>
<p>Logical, if <code>TRUE</code>, the result is returned as a <code>POSIXct</code> object, otherwise, it is returned as a fraction of a day.</p>
</td></tr>
<tr><td><code id="crepuscule_+3A_crs">crs</code></td>
<td>
<p>A <code>CRS</code> object representing the coordinate reference system.
Default is <code>sf::st_crs(4326)</code> which denotes WGS84 (World Geodetic System 1984).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Methods are available for different classes of geographical coordinates, including:
</p>

<ul>
<li> <p><code>sf</code>: an object of class <code>sf</code>.
</p>
</li>
<li> <p><code>matrix</code>: An unnamed matrix of coordinates, with each row containing a pair of geographical coordinates in <code>c(lon, lat)</code> order. See the example below.
</p>
</li>
<li> <p><code>SpatialPoints</code>: an object of class <code>SpatialPoints</code>.
Input can consist of one location and at least one <code>POSIXct</code> time, or one <code>POSIXct</code>
time and at least one location. <code>solarDep</code> is recycled as needed.
Do not use the daylight savings time zone string for supplying <code>dateTime</code>, as many OS
will not be able to properly set it to standard time when needed.
</p>
</li></ul>

<p>Compared to NOAA’s original Javascript code, the sunrise and sunset estimates from this translation
may differ by +/- 1 minute, based on tests using selected locations spanning the globe.
This translation does not include calculation of prior or next sunrises/sunsets for locations above the Arctic
Circle or below the Antarctic Circle.
</p>


<h4>Solar position calculation</h4>

<p>Details for the calculations are provided by NOAA <a href="https://gml.noaa.gov/grad/solcalc/calcdetails.html">here</a>,
which we repeat below as a reference.
</p>
<p>The calculations in the NOAA Sunrise/Sunset and Solar Position Calculators are based on equations
from Astronomical Algorithms, by Jean Meeus. The sunrise and sunset results are theoretically accurate
to within a minute for locations between +/- 72° latitude, and within 10 minutes outside of those latitudes.
However, due to variations in atmospheric composition, temperature, pressure and conditions, observed values may vary from calculations.
</p>
<p>For the purposes of these calculators the current Gregorian calendar is extrapolated backward through time.
When using a date before 15 October, 1582, you will need to correct for this. The year preceding year 1 in
the calendar is year zero (0). The year before that is -1. The approximations used in these programs are very
good for years between 1800 and 2100. Results should still be sufficiently accurate for the range
from -1000 to 3000. Outside of this range, results may be given, but the potential for error is higher.
</p>



<h4>Atmospheric refraction correction</h4>

<p>For sunrise and sunset calculations, we assume 0.833° of atmospheric refraction.
In the solar position calculator, atmospheric refraction is modeled as:</p>

<table>
<tr>
 <td style="text-align: left;">
   Solar Elevation </td><td style="text-align: left;"> Approximate Atmospheric Refraction Correction (°) </td>
</tr>
<tr>
 <td style="text-align: left;">
   85° to 90° </td><td style="text-align: left;"> 0 </td>
</tr>
<tr>
 <td style="text-align: left;">
   5° to 85° </td><td style="text-align: left;"> <code class="reqn">\frac{1}{3600}\left(\frac{58.1}{\tan(h)} - \frac{0.07}{\tan^3(h)} + \frac{0.000086}{\tan^5(h)}\right)</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
   -0.575° to 5° </td><td style="text-align: left;"> <code class="reqn">\frac{1}{3600}\left(1735 - 518.2 h + 103.4 h^2 - 12.79 h^3 + 0.711 h^4\right)</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
   &lt; -0.575° </td><td style="text-align: left;"> <code class="reqn">\frac{1}{3600}\left(\frac{-20.774}{\tan(h)}\right)</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>The effects of the atmosphere vary with atmospheric pressure, humidity and other variables.
Therefore the solar position calculations presented here are approximate. Errors in sunrise
and sunset times can be expected to increase the further away you are from the equator,
because the sun rises and sets at a very shallow angle. Small variations in the atmosphere
can have a larger effect.
</p>



<h3>Value</h3>

<p>data.frame with the time of crepuscular light as a fraction of a day; if POSIXct.out=TRUE returns an additional
POSIXct timestamp column (default = TRUE)
</p>


<h3>References</h3>


<ul>
<li><p> Meeus, J. (1991) Astronomical Algorithms. Willmann-Bell, Inc.
</p>
</li>
<li><p> NOAA's <a href="https://gml.noaa.gov/grad/solcalc/sunrise.html">sunrise/sunset calculator</a>.
These algorithms include corrections for atmospheric refraction effects.
</p>
</li>
<li><p> NOAA's <a href="https://gml.noaa.gov/grad/solcalc/calcdetails.html">solar calculations details</a>
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>#Civil dawn in Ithaca, NY on June 1, 2023

crepuscule(
       matrix(c(-76.4511, 42.4800), nrow = 1),
       as.POSIXct("2023-06-01", tz = "America/New_York"),
       solarDep = 6,
       direction = "dawn",
       POSIXct.out = TRUE
     )

</code></pre>

<hr>
<h2 id='solarnoon'>Compute solar noon time</h2><span id='topic+solarnoon'></span><span id='topic+solarnoon+2Csf+2CPOSIXct-method'></span><span id='topic+solarnoon+2Cmatrix+2CPOSIXct-method'></span><span id='topic+solarnoon+2CSpatialPoints+2CPOSIXct-method'></span>

<h3>Description</h3>

<p>Calculates the solar noon, i.e., the time when the sun is at its highest point in the sky
at a specific geographical location and time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>solarnoon(crds, dateTime, ...)

## S4 method for signature 'sf,POSIXct'
solarnoon(crds, dateTime, POSIXct.out = FALSE)

## S4 method for signature 'matrix,POSIXct'
solarnoon(crds, dateTime, crs = sf::st_crs(4326), POSIXct.out = FALSE)

## S4 method for signature 'SpatialPoints,POSIXct'
solarnoon(crds, dateTime, POSIXct.out = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="solarnoon_+3A_crds">crds</code></td>
<td>
<p>Geographical coordinates. It can be an object of
class <code>sf</code>, <code>matrix</code>, or <code>SpatialPoints</code>.</p>
</td></tr>
<tr><td><code id="solarnoon_+3A_datetime">dateTime</code></td>
<td>
<p>A <code>POSIXct</code> object representing the date and time.</p>
</td></tr>
<tr><td><code id="solarnoon_+3A_...">...</code></td>
<td>
<p>Additional arguments that are passed to methods.</p>
</td></tr>
<tr><td><code id="solarnoon_+3A_posixct.out">POSIXct.out</code></td>
<td>
<p>Logical, if <code>TRUE</code>, the result is returned as a <code>POSIXct</code> object, otherwise, it is returned as a fraction of a day.</p>
</td></tr>
<tr><td><code id="solarnoon_+3A_crs">crs</code></td>
<td>
<p>A <code>CRS</code> object representing the coordinate reference system.
Default is <code>sf::st_crs(4326)</code> which denotes WGS84 (World Geodetic System 1984).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Methods are available for different classes of geographical coordinates, including:
</p>

<ul>
<li> <p><code>sf</code>: an object of class <code>sf</code>.
</p>
</li>
<li> <p><code>matrix</code>: An unnamed matrix of coordinates, with each row containing a pair of geographical coordinates in <code>c(lon, lat)</code> order. See the example below.
</p>
</li>
<li> <p><code>SpatialPoints</code>: an object of class <code>SpatialPoints</code>.
Input can consist of one location and at least one <code>POSIXct</code> time, or one <code>POSIXct</code>
time and at least one location. <code>solarDep</code> is recycled as needed.
Do not use the daylight savings time zone string for supplying <code>dateTime</code>, as many OS
will not be able to properly set it to standard time when needed.
</p>
</li></ul>

<p>Compared to NOAA’s original Javascript code, the sunrise and sunset estimates from this translation
may differ by +/- 1 minute, based on tests using selected locations spanning the globe.
This translation does not include calculation of prior or next sunrises/sunsets for locations above the Arctic
Circle or below the Antarctic Circle.
</p>


<h4>Solar position calculation</h4>

<p>Details for the calculations are provided by NOAA <a href="https://gml.noaa.gov/grad/solcalc/calcdetails.html">here</a>,
which we repeat below as a reference.
</p>
<p>The calculations in the NOAA Sunrise/Sunset and Solar Position Calculators are based on equations
from Astronomical Algorithms, by Jean Meeus. The sunrise and sunset results are theoretically accurate
to within a minute for locations between +/- 72° latitude, and within 10 minutes outside of those latitudes.
However, due to variations in atmospheric composition, temperature, pressure and conditions, observed values may vary from calculations.
</p>
<p>For the purposes of these calculators the current Gregorian calendar is extrapolated backward through time.
When using a date before 15 October, 1582, you will need to correct for this. The year preceding year 1 in
the calendar is year zero (0). The year before that is -1. The approximations used in these programs are very
good for years between 1800 and 2100. Results should still be sufficiently accurate for the range
from -1000 to 3000. Outside of this range, results may be given, but the potential for error is higher.
</p>



<h4>Atmospheric refraction correction</h4>

<p>For sunrise and sunset calculations, we assume 0.833° of atmospheric refraction.
In the solar position calculator, atmospheric refraction is modeled as:</p>

<table>
<tr>
 <td style="text-align: left;">
   Solar Elevation </td><td style="text-align: left;"> Approximate Atmospheric Refraction Correction (°) </td>
</tr>
<tr>
 <td style="text-align: left;">
   85° to 90° </td><td style="text-align: left;"> 0 </td>
</tr>
<tr>
 <td style="text-align: left;">
   5° to 85° </td><td style="text-align: left;"> <code class="reqn">\frac{1}{3600}\left(\frac{58.1}{\tan(h)} - \frac{0.07}{\tan^3(h)} + \frac{0.000086}{\tan^5(h)}\right)</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
   -0.575° to 5° </td><td style="text-align: left;"> <code class="reqn">\frac{1}{3600}\left(1735 - 518.2 h + 103.4 h^2 - 12.79 h^3 + 0.711 h^4\right)</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
   &lt; -0.575° </td><td style="text-align: left;"> <code class="reqn">\frac{1}{3600}\left(\frac{-20.774}{\tan(h)}\right)</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>The effects of the atmosphere vary with atmospheric pressure, humidity and other variables.
Therefore the solar position calculations presented here are approximate. Errors in sunrise
and sunset times can be expected to increase the further away you are from the equator,
because the sun rises and sets at a very shallow angle. Small variations in the atmosphere
can have a larger effect.
</p>



<h3>Value</h3>

<p>data.frame with the time of solar noon as a fraction of a day; if POSIXct.out=TRUE returns an additional
POSIXct timestamp column (default = TRUE)
</p>


<h3>References</h3>


<ul>
<li><p> Meeus, J. (1991) Astronomical Algorithms. Willmann-Bell, Inc.
</p>
</li>
<li><p> NOAA's <a href="https://gml.noaa.gov/grad/solcalc/azel.html">solar position calculator</a>.
These algorithms include corrections for atmospheric refraction effects.
</p>
</li>
<li><p> NOAA's <a href="https://gml.noaa.gov/grad/solcalc/calcdetails.html">solar calculations details</a>
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'># Solar noon in Ithaca, NY, USA on June 1, 2023

solarnoon(
 matrix(c(-76.4511, 42.4800), nrow = 1),
 as.POSIXct("2023-06-01", tz = "America/New_York"),
 POSIXct.out=TRUE
)
</code></pre>

<hr>
<h2 id='solarpos'>Compute solar position</h2><span id='topic+solarpos'></span><span id='topic+solarpos+2Csf+2CPOSIXct-method'></span><span id='topic+solarpos+2Cmatrix+2CPOSIXct-method'></span><span id='topic+solarpos+2CSpatialPoints+2CPOSIXct-method'></span>

<h3>Description</h3>

<p>Calculates the solar position, i.e., the sun's elevation and azimuth,
at a specific geographical location and time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>solarpos(crds, dateTime, ...)

## S4 method for signature 'sf,POSIXct'
solarpos(crds, dateTime, ...)

## S4 method for signature 'matrix,POSIXct'
solarpos(crds, dateTime, crs = sf::st_crs(4326), ...)

## S4 method for signature 'SpatialPoints,POSIXct'
solarpos(crds, dateTime, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="solarpos_+3A_crds">crds</code></td>
<td>
<p>Geographical coordinates. It can be an object of
class <code>sf</code>, <code>matrix</code>, or <code>SpatialPoints</code>.</p>
</td></tr>
<tr><td><code id="solarpos_+3A_datetime">dateTime</code></td>
<td>
<p>A <code>POSIXct</code> object representing the date and time.</p>
</td></tr>
<tr><td><code id="solarpos_+3A_...">...</code></td>
<td>
<p>Additional arguments that are passed to methods.</p>
</td></tr>
<tr><td><code id="solarpos_+3A_crs">crs</code></td>
<td>
<p>A <code>CRS</code> object representing the coordinate reference system.
Default is <code>sf::st_crs(4326)</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Methods are available for different classes of geographical coordinates, including:
</p>

<ul>
<li> <p><code>sf</code>: an object of class <code>sf</code>.
</p>
</li>
<li> <p><code>matrix</code>: An unnamed matrix of coordinates, with each row containing a pair of geographical coordinates in <code>c(lon, lat)</code> order. See the example below.
</p>
</li>
<li> <p><code>SpatialPoints</code>: an object of class <code>SpatialPoints</code>.
Input can consist of one location and at least one <code>POSIXct</code> time, or one <code>POSIXct</code>
time and at least one location. <code>solarDep</code> is recycled as needed.
Do not use the daylight savings time zone string for supplying <code>dateTime</code>, as many OS
will not be able to properly set it to standard time when needed.
</p>
</li></ul>

<p>Compared to NOAA’s original Javascript code, the sunrise and sunset estimates from this translation
may differ by +/- 1 minute, based on tests using selected locations spanning the globe.
This translation does not include calculation of prior or next sunrises/sunsets for locations above the Arctic
Circle or below the Antarctic Circle.
</p>


<h4>Solar position calculation</h4>

<p>Details for the calculations are provided by NOAA <a href="https://gml.noaa.gov/grad/solcalc/calcdetails.html">here</a>,
which we repeat below as a reference.
</p>
<p>The calculations in the NOAA Sunrise/Sunset and Solar Position Calculators are based on equations
from Astronomical Algorithms, by Jean Meeus. The sunrise and sunset results are theoretically accurate
to within a minute for locations between +/- 72° latitude, and within 10 minutes outside of those latitudes.
However, due to variations in atmospheric composition, temperature, pressure and conditions, observed values may vary from calculations.
</p>
<p>For the purposes of these calculators the current Gregorian calendar is extrapolated backward through time.
When using a date before 15 October, 1582, you will need to correct for this. The year preceding year 1 in
the calendar is year zero (0). The year before that is -1. The approximations used in these programs are very
good for years between 1800 and 2100. Results should still be sufficiently accurate for the range
from -1000 to 3000. Outside of this range, results may be given, but the potential for error is higher.
</p>



<h4>Atmospheric refraction correction</h4>

<p>For sunrise and sunset calculations, we assume 0.833° of atmospheric refraction.
In the solar position calculator, atmospheric refraction is modeled as:</p>

<table>
<tr>
 <td style="text-align: left;">
   Solar Elevation </td><td style="text-align: left;"> Approximate Atmospheric Refraction Correction (°) </td>
</tr>
<tr>
 <td style="text-align: left;">
   85° to 90° </td><td style="text-align: left;"> 0 </td>
</tr>
<tr>
 <td style="text-align: left;">
   5° to 85° </td><td style="text-align: left;"> <code class="reqn">\frac{1}{3600}\left(\frac{58.1}{\tan(h)} - \frac{0.07}{\tan^3(h)} + \frac{0.000086}{\tan^5(h)}\right)</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
   -0.575° to 5° </td><td style="text-align: left;"> <code class="reqn">\frac{1}{3600}\left(1735 - 518.2 h + 103.4 h^2 - 12.79 h^3 + 0.711 h^4\right)</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
   &lt; -0.575° </td><td style="text-align: left;"> <code class="reqn">\frac{1}{3600}\left(\frac{-20.774}{\tan(h)}\right)</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>The effects of the atmosphere vary with atmospheric pressure, humidity and other variables.
Therefore the solar position calculations presented here are approximate. Errors in sunrise
and sunset times can be expected to increase the further away you are from the equator,
because the sun rises and sets at a very shallow angle. Small variations in the atmosphere
can have a larger effect.
</p>



<h3>Value</h3>

<p>matrix with the solar azimuth (in degrees from North), and elevation.
</p>


<h3>References</h3>


<ul>
<li><p> Meeus, J. (1991) Astronomical Algorithms. Willmann-Bell, Inc.
</p>
</li>
<li><p> NOAA's <a href="https://gml.noaa.gov/grad/solcalc/azel.html">solar position calculator</a>.
These algorithms include corrections for atmospheric refraction effects.
</p>
</li>
<li><p> NOAA's <a href="https://gml.noaa.gov/grad/solcalc/calcdetails.html">solar calculations details</a>
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'># Solar position in Ithaca, NY, USA on June 1, 2023 at 08:00:00

solarpos(
 matrix(c(-76.4511, 42.4800), nrow = 1),
 as.POSIXct("2023-06-01 08:00:00", tz = "America/New_York")
)
</code></pre>

<hr>
<h2 id='sunriset'>Calculate sunrise/sunset</h2><span id='topic+sunriset'></span><span id='topic+sunriset+2Csf+2CPOSIXct-method'></span><span id='topic+sunriset+2Cmatrix+2CPOSIXct-method'></span><span id='topic+sunriset+2CSpatialPoints+2CPOSIXct-method'></span>

<h3>Description</h3>

<p>Calculates sunrise or sunset at a specific geographical location and time
depending on the <code>direction</code> parameter.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sunriset(crds, dateTime, ...)

## S4 method for signature 'sf,POSIXct'
sunriset(
  crds,
  dateTime,
  direction = c("sunrise", "sunset"),
  POSIXct.out = FALSE
)

## S4 method for signature 'matrix,POSIXct'
sunriset(
  crds,
  dateTime,
  crs = sf::st_crs(4326),
  direction = c("sunrise", "sunset"),
  POSIXct.out = FALSE
)

## S4 method for signature 'SpatialPoints,POSIXct'
sunriset(
  crds,
  dateTime,
  direction = c("sunrise", "sunset"),
  POSIXct.out = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sunriset_+3A_crds">crds</code></td>
<td>
<p>Geographical coordinates. It can be an object of
class <code>sf</code>, <code>matrix</code>, or <code>SpatialPoints</code>.</p>
</td></tr>
<tr><td><code id="sunriset_+3A_datetime">dateTime</code></td>
<td>
<p>A <code>POSIXct</code> object representing the date and time.</p>
</td></tr>
<tr><td><code id="sunriset_+3A_...">...</code></td>
<td>
<p>Additional arguments that are passed to methods.</p>
</td></tr>
<tr><td><code id="sunriset_+3A_direction">direction</code></td>
<td>
<p>Character, determines whether to calculate the time of sunrise or sunset.</p>
</td></tr>
<tr><td><code id="sunriset_+3A_posixct.out">POSIXct.out</code></td>
<td>
<p>Logical, if <code>TRUE</code>, the result is returned as a <code>POSIXct</code> object, otherwise, it is returned as a fraction of a day.</p>
</td></tr>
<tr><td><code id="sunriset_+3A_crs">crs</code></td>
<td>
<p>A &quot;CRS&quot; object representing the coordinate reference system.
Default is <code>sf::st_crs(4326)</code> which denotes WGS84 (World Geodetic System 1984).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Methods are available for different classes of geographical coordinates, including:
</p>

<ul>
<li> <p><code>sf</code>: an object of class <code>sf</code>.
</p>
</li>
<li> <p><code>matrix</code>: An unnamed matrix of coordinates, with each row containing a pair of geographical coordinates in <code>c(lon, lat)</code> order. See the example below.
</p>
</li>
<li> <p><code>SpatialPoints</code>: an object of class <code>SpatialPoints</code>.
Input can consist of one location and at least one <code>POSIXct</code> time, or one <code>POSIXct</code>
time and at least one location. <code>solarDep</code> is recycled as needed.
Do not use the daylight savings time zone string for supplying <code>dateTime</code>, as many OS
will not be able to properly set it to standard time when needed.
</p>
</li></ul>

<p>Compared to NOAA’s original Javascript code, the sunrise and sunset estimates from this translation
may differ by +/- 1 minute, based on tests using selected locations spanning the globe.
This translation does not include calculation of prior or next sunrises/sunsets for locations above the Arctic
Circle or below the Antarctic Circle.
</p>


<h4>Solar position calculation</h4>

<p>Details for the calculations are provided by NOAA <a href="https://gml.noaa.gov/grad/solcalc/calcdetails.html">here</a>,
which we repeat below as a reference.
</p>
<p>The calculations in the NOAA Sunrise/Sunset and Solar Position Calculators are based on equations
from Astronomical Algorithms, by Jean Meeus. The sunrise and sunset results are theoretically accurate
to within a minute for locations between +/- 72° latitude, and within 10 minutes outside of those latitudes.
However, due to variations in atmospheric composition, temperature, pressure and conditions, observed values may vary from calculations.
</p>
<p>For the purposes of these calculators the current Gregorian calendar is extrapolated backward through time.
When using a date before 15 October, 1582, you will need to correct for this. The year preceding year 1 in
the calendar is year zero (0). The year before that is -1. The approximations used in these programs are very
good for years between 1800 and 2100. Results should still be sufficiently accurate for the range
from -1000 to 3000. Outside of this range, results may be given, but the potential for error is higher.
</p>



<h4>Atmospheric refraction correction</h4>

<p>For sunrise and sunset calculations, we assume 0.833° of atmospheric refraction.
In the solar position calculator, atmospheric refraction is modeled as:</p>

<table>
<tr>
 <td style="text-align: left;">
   Solar Elevation </td><td style="text-align: left;"> Approximate Atmospheric Refraction Correction (°) </td>
</tr>
<tr>
 <td style="text-align: left;">
   85° to 90° </td><td style="text-align: left;"> 0 </td>
</tr>
<tr>
 <td style="text-align: left;">
   5° to 85° </td><td style="text-align: left;"> <code class="reqn">\frac{1}{3600}\left(\frac{58.1}{\tan(h)} - \frac{0.07}{\tan^3(h)} + \frac{0.000086}{\tan^5(h)}\right)</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
   -0.575° to 5° </td><td style="text-align: left;"> <code class="reqn">\frac{1}{3600}\left(1735 - 518.2 h + 103.4 h^2 - 12.79 h^3 + 0.711 h^4\right)</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
   &lt; -0.575° </td><td style="text-align: left;"> <code class="reqn">\frac{1}{3600}\left(\frac{-20.774}{\tan(h)}\right)</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>The effects of the atmosphere vary with atmospheric pressure, humidity and other variables.
Therefore the solar position calculations presented here are approximate. Errors in sunrise
and sunset times can be expected to increase the further away you are from the equator,
because the sun rises and sets at a very shallow angle. Small variations in the atmosphere
can have a larger effect.
</p>



<h3>Value</h3>

<p>data.frame with the time of sunrise as a fraction of a day; if POSIXct.out=TRUE returns an additional
POSIXct timestamp column (default = TRUE)
</p>


<h3>References</h3>


<ul>
<li><p> Meeus, J. (1991) Astronomical Algorithms. Willmann-Bell, Inc.
</p>
</li>
<li><p> NOAA's <a href="https://gml.noaa.gov/grad/solcalc/sunrise.html">sunrise/sunset calculator</a>.
These algorithms include corrections for atmospheric refraction effects.
</p>
</li>
<li><p> NOAA's <a href="https://gml.noaa.gov/grad/solcalc/calcdetails.html">solar calculations details</a>
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>#Sunset in Ithaca, NY, USA on June 1, 2023

sunriset(
 matrix(c(-76.4511, 42.4800), nrow = 1),
 as.POSIXct("2023-06-01", tz = "America/New_York"),
 direction='sunset',
 POSIXct.out=TRUE
)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
