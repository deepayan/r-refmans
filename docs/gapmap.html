<!DOCTYPE html><html lang="en"><head><title>Help for package gapmap</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {gapmap}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#gapmap-package'><p>Draws gapped heatmap (gapmap) and gapped dendrograms using ggplot2 in [R].</p></a></li>
<li><a href='#as.gapdata'><p>Make a gapdata class object</p></a></li>
<li><a href='#assign_branch_positions'><p>Re-evaluate the position of branches</p></a></li>
<li><a href='#assign_positions'><p>Re-evaluate the position of leaves</p></a></li>
<li><a href='#calculate_gap'><p>Calculate the gaps based on distance</p></a></li>
<li><a href='#count_gap'><p>Count the number of gaps based on a threshold</p></a></li>
<li><a href='#extract_list'><p>Extract a list from the dendrogram object</p></a></li>
<li><a href='#format_number'><p>Function to format a number</p></a></li>
<li><a href='#gap_data'><p>Generate a gapdata class object from a dendrogram object</p></a></li>
<li><a href='#gap_dendrogram'><p>Function to draw a gapped dendrogram</p></a></li>
<li><a href='#gap_heatmap'><p>Function to draw a gapped heatmap</p></a></li>
<li><a href='#gap_label'><p>Function to draw a gapped labels</p></a></li>
<li><a href='#gapmap'><p>Function to draw a gapped cluster heatmap</p></a></li>
<li><a href='#get_most_left_leaf'><p>Get the most left leaf object from a dendrogram</p></a></li>
<li><a href='#get_most_right_leaf'><p>Get the most right leaf object from a dendrogram</p></a></li>
<li><a href='#get_segment_df'><p>Make a data.frame object</p></a></li>
<li><a href='#is.gapdata'><p>Function to check if a object is a gapdata class object</p></a></li>
<li><a href='#map'><p>A function to map values in a range</p></a></li>
<li><a href='#map.exp'><p>A function to map values in a range exponentially</p></a></li>
<li><a href='#sample_tcga'><p>Sample data matrix from the integrated pathway analysis of gastric cancer from the Cancer Genome Atlas (TCGA) study.</p></a></li>
<li><a href='#set_most_right_leaf'><p>Set the most right leaf object from a dendrogram</p></a></li>
<li><a href='#sum_distance'><p>Sum the distance of all branches in a dendrogram</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Drawing Gapped Cluster Heatmaps with 'ggplot2'</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Description:</td>
<td>The gap encodes the distance between clusters and improves
    interpretation of cluster heatmaps. The gaps can be of the same
    distance based on a height threshold to cut the dendrogram. Another
    option is to vary the size of gaps based on the distance between
    clusters.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Depends:</td>
<td>ggplot2, reshape2</td>
</tr>
<tr>
<td>Imports:</td>
<td>grid</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, dendsort, RColorBrewer, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/evanbiederstedt/gapmap">https://github.com/evanbiederstedt/gapmap</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/evanbiederstedt/gapmap/issues">https://github.com/evanbiederstedt/gapmap/issues</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Evan Biederstedt &lt;evan.biederstedt@gmail.com&gt;</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-01-22 17:42:53 UTC; evanbiederstedt</td>
</tr>
<tr>
<td>Author:</td>
<td>Ryo Sakai [aut],
  Evan Biederstedt [cre, aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-01-22 20:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='gapmap-package'>Draws gapped heatmap (gapmap) and gapped dendrograms using ggplot2 in [R].</h2><span id='topic+gapmap-package'></span>

<h3>Description</h3>

<p>Functions for drawing gapped cluster heatmap with ggplot2
</p>


<h3>Details</h3>

<p>This is a set of tools for drawing gapmaps using <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code>
</p>
<p><code><a href="#topic+gap_data">gap_data</a></code> extracts data from a dendrogram object. Make sure to convert <code>hclust</code> object to <code>dendrogram</code> object by calling <code>as.dendrogram()</code>.
This method generates an object class <code>gapdata</code>, consisting of a list of <code>data.frames</code>.
The general workflow is as following:
</p>

<ol>
<li><p>Hierarchical clustering <code>hclust()</code>
</p>
</li>
<li><p>Convert the <code>hclust</code> output class into <code>dendrogram</code> by calling <code>as.dendrogram()</code>
</p>
</li>
<li><p>Generate a gapped cluster heatmap by specifying a <code>matrix</code> and <code>dendrogram</code> objects for rows and columns in <code>gapmap()</code> function
</p>
</li></ol>



<h3>Author(s)</h3>

<p>Ryo Sakai <a href="mailto:ryo.sakai@esat.kuleuven.be">ryo.sakai@esat.kuleuven.be</a>
</p>

<hr>
<h2 id='as.gapdata'>Make a gapdata class object</h2><span id='topic+as.gapdata'></span>

<h3>Description</h3>

<p>This function generates a gapdata class object.  This object is used for drawing dendrograms and heatmaps.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.gapdata(d, segments, labels, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="as.gapdata_+3A_d">d</code></td>
<td>
<p>dendrogram class object</p>
</td></tr>
<tr><td><code id="as.gapdata_+3A_segments">segments</code></td>
<td>
<p>a data.frame containing segments information</p>
</td></tr>
<tr><td><code id="as.gapdata_+3A_labels">labels</code></td>
<td>
<p>a data.frame containing labels information</p>
</td></tr>
<tr><td><code id="as.gapdata_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the gapdata class object
</p>

<hr>
<h2 id='assign_branch_positions'>Re-evaluate the position of branches</h2><span id='topic+assign_branch_positions'></span>

<h3>Description</h3>

<p>This function reevaluate the position of branches based on the gaps calculated.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>assign_branch_positions(d, verbose = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="assign_branch_positions_+3A_d">d</code></td>
<td>
<p>dendrogram class object</p>
</td></tr>
<tr><td><code id="assign_branch_positions_+3A_verbose">verbose</code></td>
<td>
<p>logical for whether in verbose mode or not</p>
</td></tr>
<tr><td><code id="assign_branch_positions_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the reevaluated dendrogram object
</p>

<hr>
<h2 id='assign_positions'>Re-evaluate the position of leaves</h2><span id='topic+assign_positions'></span>

<h3>Description</h3>

<p>This function reevaluate the position of leaves based on the gaps calculated.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>assign_positions(d, runningX = 1, verbose = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="assign_positions_+3A_d">d</code></td>
<td>
<p>dendrogram class object</p>
</td></tr>
<tr><td><code id="assign_positions_+3A_runningx">runningX</code></td>
<td>
<p>numerical position of leaf node on display</p>
</td></tr>
<tr><td><code id="assign_positions_+3A_verbose">verbose</code></td>
<td>
<p>logical for whether in verbose mode or not</p>
</td></tr>
<tr><td><code id="assign_positions_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the reevaluated dendrogram object
</p>

<hr>
<h2 id='calculate_gap'>Calculate the gaps based on distance</h2><span id='topic+calculate_gap'></span>

<h3>Description</h3>

<p>This function takes a dendrogram class object and other attributes to calcuate the 
size of gaps between leaves. The gap is stored in a  leaf to its left. The function
is called recursively.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculate_gap(
  d,
  sum,
  gap_total,
  mode = c("quantitative", "threshold"),
  mapping = c("exponential", "linear"),
  scale = 0.2,
  max_height = 0,
  threshold = 2,
  gap_size = 0,
  verbose = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calculate_gap_+3A_d">d</code></td>
<td>
<p>dendrogram class object</p>
</td></tr>
<tr><td><code id="calculate_gap_+3A_sum">sum</code></td>
<td>
<p>the sum of distance</p>
</td></tr>
<tr><td><code id="calculate_gap_+3A_gap_total">gap_total</code></td>
<td>
<p>the total width allocated for gaps</p>
</td></tr>
<tr><td><code id="calculate_gap_+3A_mode">mode</code></td>
<td>
<p>gap mode, either &quot;threshold&quot; or &quot;quantitative&quot;</p>
</td></tr>
<tr><td><code id="calculate_gap_+3A_mapping">mapping</code></td>
<td>
<p>in case of quantitative mode, either &quot;linear&quot; or &quot;exponential&quot; mapping</p>
</td></tr>
<tr><td><code id="calculate_gap_+3A_scale">scale</code></td>
<td>
<p>the sclae log base for the exponential mapping</p>
</td></tr>
<tr><td><code id="calculate_gap_+3A_max_height">max_height</code></td>
<td>
<p>the highest distance value, which is the value of the first dendrogram branch</p>
</td></tr>
<tr><td><code id="calculate_gap_+3A_threshold">threshold</code></td>
<td>
<p>the threshold value for threshold mode</p>
</td></tr>
<tr><td><code id="calculate_gap_+3A_gap_size">gap_size</code></td>
<td>
<p>the size of gap for threshold mode</p>
</td></tr>
<tr><td><code id="calculate_gap_+3A_verbose">verbose</code></td>
<td>
<p>logical for whether in verbose mode or not</p>
</td></tr>
<tr><td><code id="calculate_gap_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the annotated dendrogram class object
</p>

<hr>
<h2 id='count_gap'>Count the number of gaps based on a threshold</h2><span id='topic+count_gap'></span>

<h3>Description</h3>

<p>This function counts the number of gaps based on the cutting the tree method.
It counts the number of branches that are above the threshold distance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>count_gap(d = d, count = 0, threshold = threshold)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="count_gap_+3A_d">d</code></td>
<td>
<p>dendrogram class object</p>
</td></tr>
<tr><td><code id="count_gap_+3A_count">count</code></td>
<td>
<p>count</p>
</td></tr>
<tr><td><code id="count_gap_+3A_threshold">threshold</code></td>
<td>
<p>a numeric value for threshold</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the count of gaps
</p>

<hr>
<h2 id='extract_list'>Extract a list from the dendrogram object</h2><span id='topic+extract_list'></span>

<h3>Description</h3>

<p>This function extract list of data.frames for drawing dendrograms
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_list(d, type, segments_df = NULL, labels_df = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extract_list_+3A_d">d</code></td>
<td>
<p>dendrogram class object</p>
</td></tr>
<tr><td><code id="extract_list_+3A_type">type</code></td>
<td>
<p>either &quot;triangular&quot; or &quot;rectangular&quot;. It determines the same of branches.</p>
</td></tr>
<tr><td><code id="extract_list_+3A_segments_df">segments_df</code></td>
<td>
<p>data.frame storing the segment information</p>
</td></tr>
<tr><td><code id="extract_list_+3A_labels_df">labels_df</code></td>
<td>
<p>data.frame storking the label positions</p>
</td></tr>
<tr><td><code id="extract_list_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the extracted list
</p>

<hr>
<h2 id='format_number'>Function to format a number</h2><span id='topic+format_number'></span>

<h3>Description</h3>

<p>This function takes a floating number and round to 2 decimal point
</p>


<h3>Usage</h3>

<pre><code class='language-R'>format_number(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="format_number_+3A_x">x</code></td>
<td>
<p>a floating number</p>
</td></tr>
</table>


<h3>Value</h3>

<p>formatted number
</p>

<hr>
<h2 id='gap_data'>Generate a gapdata class object from a dendrogram object</h2><span id='topic+gap_data'></span>

<h3>Description</h3>

<p>This function takes a dendrogram class object as an input, and generate a gapdata class object as an output.
By parsing the dendrogram object based on parameters for gaps, gaps between leaves in a dendrogram are introduced,
and the coordinates of the leaves are adjusted. The gaps can be based on the a height (or distance) threshold to
to introduce the gaps of the same width, or quantitative mapping of distance values mapped linearly or exponentially.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gap_data(
  d,
  mode = c("quantitative", "threshold"),
  mapping = c("exponential", "linear"),
  ratio = 0.2,
  scale = 0.5,
  threshold = 0,
  verbose = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gap_data_+3A_d">d</code></td>
<td>
<p>dendrogram class object</p>
</td></tr>
<tr><td><code id="gap_data_+3A_mode">mode</code></td>
<td>
<p>gap mode, either &quot;threshold&quot; or &quot;quantitative&quot;</p>
</td></tr>
<tr><td><code id="gap_data_+3A_mapping">mapping</code></td>
<td>
<p>in case of quantitative mode, either &quot;linear&quot; or &quot;exponential&quot; mapping</p>
</td></tr>
<tr><td><code id="gap_data_+3A_ratio">ratio</code></td>
<td>
<p>the percentage of width allocated for the sum of gaps.</p>
</td></tr>
<tr><td><code id="gap_data_+3A_scale">scale</code></td>
<td>
<p>the sclae log base for the exponential mapping</p>
</td></tr>
<tr><td><code id="gap_data_+3A_threshold">threshold</code></td>
<td>
<p>the height at which the dendrogram is cult to infer clusters</p>
</td></tr>
<tr><td><code id="gap_data_+3A_verbose">verbose</code></td>
<td>
<p>logical for whether in verbose mode or not</p>
</td></tr>
<tr><td><code id="gap_data_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of data frames that contain coordinates for drawing a gapped dendrogram
</p>

<hr>
<h2 id='gap_dendrogram'>Function to draw a gapped dendrogram</h2><span id='topic+gap_dendrogram'></span>

<h3>Description</h3>

<p>This function draws a gapped dendrogram using the ggplot2 package. The input for the
function is the gapdata class object, generated from gap_data() function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gap_dendrogram(
  data,
  leaf_labels = TRUE,
  rotate_label = FALSE,
  orientation = c("top", "right", "bottom", "left"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gap_dendrogram_+3A_data">data</code></td>
<td>
<p>gapdata class object</p>
</td></tr>
<tr><td><code id="gap_dendrogram_+3A_leaf_labels">leaf_labels</code></td>
<td>
<p>a logical to show labels or not</p>
</td></tr>
<tr><td><code id="gap_dendrogram_+3A_rotate_label">rotate_label</code></td>
<td>
<p>a logical to rotate labels or not</p>
</td></tr>
<tr><td><code id="gap_dendrogram_+3A_orientation">orientation</code></td>
<td>
<p>a character to set the orientation of dendrogram. Choices are &quot;top&quot;, &quot;right&quot;, &quot;bottom&quot;, &quot;left&quot;.</p>
</td></tr>
<tr><td><code id="gap_dendrogram_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a ggplot object
</p>

<hr>
<h2 id='gap_heatmap'>Function to draw a gapped heatmap</h2><span id='topic+gap_heatmap'></span>

<h3>Description</h3>

<p>This function draws a gapped heatmap using the ggplot2 package. The input for the
function are the gapdata class objects, generated from gap_data() function, and the data matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gap_heatmap(
  m,
  row_gap = NULL,
  col_gap = NULL,
  row_labels = TRUE,
  col_labels = TRUE,
  rotate = FALSE,
  col = c("#053061", "#2166AC", "#4393C3", "#92C5DE", "#D1E5F0", "#F7F7F7", "#FDDBC7",
    "#F4A582", "#D6604D", "#B2182B", "#67001F")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gap_heatmap_+3A_m">m</code></td>
<td>
<p>data matrix</p>
</td></tr>
<tr><td><code id="gap_heatmap_+3A_row_gap">row_gap</code></td>
<td>
<p>a gapdata class object for rows</p>
</td></tr>
<tr><td><code id="gap_heatmap_+3A_col_gap">col_gap</code></td>
<td>
<p>a gapdata class object for columns</p>
</td></tr>
<tr><td><code id="gap_heatmap_+3A_row_labels">row_labels</code></td>
<td>
<p>a logical to show labels for rows</p>
</td></tr>
<tr><td><code id="gap_heatmap_+3A_col_labels">col_labels</code></td>
<td>
<p>a logical to show lables for columns</p>
</td></tr>
<tr><td><code id="gap_heatmap_+3A_rotate">rotate</code></td>
<td>
<p>a logical to rotate row labels</p>
</td></tr>
<tr><td><code id="gap_heatmap_+3A_col">col</code></td>
<td>
<p>colors used for heatmap</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a ggplot object
</p>

<hr>
<h2 id='gap_label'>Function to draw a gapped labels</h2><span id='topic+gap_label'></span>

<h3>Description</h3>

<p>This function draws a gapped labels using the ggplot2 package. The input for the
function is the gapdata class object, generated from gap_data() function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gap_label(data, orientation, label_size = 5)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gap_label_+3A_data">data</code></td>
<td>
<p>gapdata class object</p>
</td></tr>
<tr><td><code id="gap_label_+3A_orientation">orientation</code></td>
<td>
<p>orientation of the labels, &quot;left&quot;, &quot;top&quot;, &quot;right&quot;, or &quot;bottom&quot;</p>
</td></tr>
<tr><td><code id="gap_label_+3A_label_size">label_size</code></td>
<td>
<p>a numeric to set the label text size</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a ggplot object
</p>

<hr>
<h2 id='gapmap'>Function to draw a gapped cluster heatmap</h2><span id='topic+gapmap'></span>

<h3>Description</h3>

<p>This function draws a gapped cluster heatmap using the ggplot2 package. The input for the
function is the a matrix, two dendrograms, and parameters for gaps.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gapmap(
  m,
  d_row,
  d_col,
  mode = c("quantitative", "threshold"),
  mapping = c("exponential", "linear"),
  ratio = 0.2,
  scale = 0.5,
  threshold = 0,
  row_threshold = NULL,
  col_threshold = NULL,
  rotate_label = TRUE,
  verbose = FALSE,
  left = "dendrogram",
  top = "dendrogram",
  right = "label",
  bottom = "label",
  col = c("#053061", "#2166AC", "#4393C3", "#92C5DE", "#D1E5F0", "#F7F7F7", "#FDDBC7",
    "#F4A582", "#D6604D", "#B2182B", "#67001F"),
  h_ratio = c(0.2, 0.7, 0.1),
  v_ratio = c(0.2, 0.7, 0.1),
  label_size = 5,
  show_legend = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gapmap_+3A_m">m</code></td>
<td>
<p>matrix</p>
</td></tr>
<tr><td><code id="gapmap_+3A_d_row">d_row</code></td>
<td>
<p>a dendrogram class object for rows</p>
</td></tr>
<tr><td><code id="gapmap_+3A_d_col">d_col</code></td>
<td>
<p>a dendrogram class object for columns</p>
</td></tr>
<tr><td><code id="gapmap_+3A_mode">mode</code></td>
<td>
<p>gap mode, either &quot;threshold&quot; or &quot;quantitative&quot;</p>
</td></tr>
<tr><td><code id="gapmap_+3A_mapping">mapping</code></td>
<td>
<p>in case of quantitative mode, either &quot;linear&quot; or &quot;exponential&quot; mapping</p>
</td></tr>
<tr><td><code id="gapmap_+3A_ratio">ratio</code></td>
<td>
<p>the percentage of width allocated for the sum of gaps.</p>
</td></tr>
<tr><td><code id="gapmap_+3A_scale">scale</code></td>
<td>
<p>the sclae log base for the exponential mapping</p>
</td></tr>
<tr><td><code id="gapmap_+3A_threshold">threshold</code></td>
<td>
<p>the height at which the dendrogram is cut to infer clusters</p>
</td></tr>
<tr><td><code id="gapmap_+3A_row_threshold">row_threshold</code></td>
<td>
<p>the height at which the row dendrogram is cut</p>
</td></tr>
<tr><td><code id="gapmap_+3A_col_threshold">col_threshold</code></td>
<td>
<p>the height at which the column dendrogram is cut</p>
</td></tr>
<tr><td><code id="gapmap_+3A_rotate_label">rotate_label</code></td>
<td>
<p>a logical to rotate column labels or not</p>
</td></tr>
<tr><td><code id="gapmap_+3A_verbose">verbose</code></td>
<td>
<p>logical for whether in verbose mode or not</p>
</td></tr>
<tr><td><code id="gapmap_+3A_left">left</code></td>
<td>
<p>a character indicating &quot;label&quot; or &quot;dendrogram&quot; for composition</p>
</td></tr>
<tr><td><code id="gapmap_+3A_top">top</code></td>
<td>
<p>a character indicating &quot;label&quot; or &quot;dendrogram&quot; for composition</p>
</td></tr>
<tr><td><code id="gapmap_+3A_right">right</code></td>
<td>
<p>a character indicating &quot;label&quot; or &quot;dendrogram&quot; for composition</p>
</td></tr>
<tr><td><code id="gapmap_+3A_bottom">bottom</code></td>
<td>
<p>a character indicating &quot;label&quot; or &quot;dendrogram&quot; for composition</p>
</td></tr>
<tr><td><code id="gapmap_+3A_col">col</code></td>
<td>
<p>colors used for heatmap</p>
</td></tr>
<tr><td><code id="gapmap_+3A_h_ratio">h_ratio</code></td>
<td>
<p>a vector to set the horizontal ratio of the grid. It should add up to 1. top, center, bottom.</p>
</td></tr>
<tr><td><code id="gapmap_+3A_v_ratio">v_ratio</code></td>
<td>
<p>a vector to set the vertical ratio of the grid. It should add up to 1. left, center, right.</p>
</td></tr>
<tr><td><code id="gapmap_+3A_label_size">label_size</code></td>
<td>
<p>a numeric to set the label text size</p>
</td></tr>
<tr><td><code id="gapmap_+3A_show_legend">show_legend</code></td>
<td>
<p>a logical to set whether to show a legend or not</p>
</td></tr>
<tr><td><code id="gapmap_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a ggplot object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1234)
#generate sample data
x &lt;- rnorm(10, mean=rep(1:5, each=2), sd=0.4)
y &lt;- rnorm(10, mean=rep(c(1,2), each=5), sd=0.4)
dataFrame &lt;- data.frame(x=x, y=y, row.names=c(1:10))
#calculate distance matrix. default is Euclidean distance
distxy &lt;- dist(dataFrame)
#perform hierarchical clustering. default is complete linkage.
hc &lt;- hclust(distxy)
dend &lt;- as.dendrogram(hc)
#make a cluster heatmap plot
gapmap(m = as.matrix(distxy), d_row= rev(dend), d_col=dend)

</code></pre>

<hr>
<h2 id='get_most_left_leaf'>Get the most left leaf object from a dendrogram</h2><span id='topic+get_most_left_leaf'></span>

<h3>Description</h3>

<p>This function returns the most left leaf object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_most_left_leaf(d)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_most_left_leaf_+3A_d">d</code></td>
<td>
<p>dendrogram class object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the most left leaf object
</p>

<hr>
<h2 id='get_most_right_leaf'>Get the most right leaf object from a dendrogram</h2><span id='topic+get_most_right_leaf'></span>

<h3>Description</h3>

<p>This function returns the most right leaf object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_most_right_leaf(d)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_most_right_leaf_+3A_d">d</code></td>
<td>
<p>dendrogram class object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the most right leaf object
</p>

<hr>
<h2 id='get_segment_df'>Make a data.frame object</h2><span id='topic+get_segment_df'></span>

<h3>Description</h3>

<p>This function just make a data.frame based on 4 input parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_segment_df(x0, y0, x1, y1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_segment_df_+3A_x0">x0</code></td>
<td>
<p>x coordinate of point 1</p>
</td></tr>
<tr><td><code id="get_segment_df_+3A_y0">y0</code></td>
<td>
<p>y coordinate of point 1</p>
</td></tr>
<tr><td><code id="get_segment_df_+3A_x1">x1</code></td>
<td>
<p>x coordinate of point 2</p>
</td></tr>
<tr><td><code id="get_segment_df_+3A_y1">y1</code></td>
<td>
<p>y coordinate of point 2</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame
</p>

<hr>
<h2 id='is.gapdata'>Function to check if a object is a gapdata class object</h2><span id='topic+is.gapdata'></span>

<h3>Description</h3>

<p>This function checks if a object is a gapdata class object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.gapdata(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="is.gapdata_+3A_x">x</code></td>
<td>
<p>a object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a logical TRUE or FALSE
</p>

<hr>
<h2 id='map'>A function to map values in a range</h2><span id='topic+map'></span>

<h3>Description</h3>

<p>This function maps a value in one range to another range.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>map(value, start1, stop1, start2, stop2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="map_+3A_value">value</code></td>
<td>
<p>input value</p>
</td></tr>
<tr><td><code id="map_+3A_start1">start1</code></td>
<td>
<p>lower bound of the value's current range</p>
</td></tr>
<tr><td><code id="map_+3A_stop1">stop1</code></td>
<td>
<p>upper bound of the value's current range</p>
</td></tr>
<tr><td><code id="map_+3A_start2">start2</code></td>
<td>
<p>lower bound of the value's taget range</p>
</td></tr>
<tr><td><code id="map_+3A_stop2">stop2</code></td>
<td>
<p>upper bound of the value's target range</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a numeric value
</p>

<hr>
<h2 id='map.exp'>A function to map values in a range exponentially</h2><span id='topic+map.exp'></span>

<h3>Description</h3>

<p>This function maps a value in one range to another range exponentially.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>map.exp(value, start1, stop1, start2, stop2, scale = 0.5)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="map.exp_+3A_value">value</code></td>
<td>
<p>input value</p>
</td></tr>
<tr><td><code id="map.exp_+3A_start1">start1</code></td>
<td>
<p>lower bound of the value's current range</p>
</td></tr>
<tr><td><code id="map.exp_+3A_stop1">stop1</code></td>
<td>
<p>upper bound of the value's current range</p>
</td></tr>
<tr><td><code id="map.exp_+3A_start2">start2</code></td>
<td>
<p>lower bound of the value's taget range</p>
</td></tr>
<tr><td><code id="map.exp_+3A_stop2">stop2</code></td>
<td>
<p>upper bound of the value's target range</p>
</td></tr>
<tr><td><code id="map.exp_+3A_scale">scale</code></td>
<td>
<p>scale log base</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a numeric value
</p>

<hr>
<h2 id='sample_tcga'>Sample data matrix from the integrated pathway analysis of gastric cancer from the Cancer Genome Atlas (TCGA) study.</h2><span id='topic+sample_tcga'></span>

<h3>Description</h3>

<p>a multivariate table obtained from the integrated pathway analysis of gastric cancer from the Cancer Genome Atlas (TCGA) study.
In this data set, each column represents a pathway consisting of a set of genes and each row represents a cohort of samples based 
on specific clinical or genetic features. For each pair of a pathway and a feature, a continuous value of between 1 and -1 is 
assigned to score positive or negative association, respectively.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(sample_tcga)
</code></pre>


<h3>Format</h3>

<p>A data frame with 215 rows and 117 variables
</p>


<h3>Details</h3>

<p>We would like to thank Sheila Reynolds and Vesteinn Thorsson from the Institute for Systems Biology for sharing this sample data set.
</p>

<hr>
<h2 id='set_most_right_leaf'>Set the most right leaf object from a dendrogram</h2><span id='topic+set_most_right_leaf'></span>

<h3>Description</h3>

<p>This function replace the most right leaf with provided dendrogram
</p>


<h3>Usage</h3>

<pre><code class='language-R'>set_most_right_leaf(d, d2, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="set_most_right_leaf_+3A_d">d</code></td>
<td>
<p>dendrogram class object, subtree object</p>
</td></tr>
<tr><td><code id="set_most_right_leaf_+3A_d2">d2</code></td>
<td>
<p>dendrogram class object, a leaf to replace the most right</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the dendrogram class object where the most right leaf is replaced
</p>

<hr>
<h2 id='sum_distance'>Sum the distance of all branches in a dendrogram</h2><span id='topic+sum_distance'></span>

<h3>Description</h3>

<p>This function takes a dendrogram class object as an input, and adds up all the distances of branches. 
This function is called recursively to adds up the sum. In case of exponential mapping for the quantitative
mode, the sum is in the exponential scale
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sum_distance(
  d,
  sum = 0,
  mapping = c("exponential", "linear"),
  scale = 0,
  max_height = 0,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sum_distance_+3A_d">d</code></td>
<td>
<p>dendrogram class object</p>
</td></tr>
<tr><td><code id="sum_distance_+3A_sum">sum</code></td>
<td>
<p>the sum of distance</p>
</td></tr>
<tr><td><code id="sum_distance_+3A_mapping">mapping</code></td>
<td>
<p>in case of quantitative mode, either &quot;linear&quot; or &quot;exponential&quot; mapping</p>
</td></tr>
<tr><td><code id="sum_distance_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the sum of distances
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
