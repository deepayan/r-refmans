<!DOCTYPE html><html><head><title>Help for package robustreg</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {robustreg}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#fit_rcpp'>
<p>Predict y from X and b</p></a></li>
<li><a href='#mad_rcpp'>
<p>Median Absolute Deviation (MAD)</p></a></li>
<li><a href='#median_rcpp'>
<p>Median</p></a></li>
<li><a href='#psiBS_rcpp'>
<p>Tukey's Bisquare Psi Function</p></a></li>
<li><a href='#psiHuber_rcpp'>
<p>Huber Psi Function</p></a></li>
<li><a href='#robustRegBS'><p>Robust Fitting of Linear Models using Bisquare Psi Function</p></a></li>
<li><a href='#robustRegH'><p>Robust Fitting of Linear Models using Huber Psi Function</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>0.1-11</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-05-09</td>
</tr>
<tr>
<td>Title:</td>
<td>Robust Regression Functions</td>
</tr>
<tr>
<td>Author:</td>
<td>Ian M. Johnson &lt;ijca2013@gmail.com&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Ian M. Johnson &lt;ijca2013@gmail.com&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6.0)</td>
</tr>
<tr>
<td>Description:</td>
<td>Linear regression functions using Huber and bisquare psi functions. Optimal weights are calculated using IRLS algorithm.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats (&ge; 3.6.0), Matrix (&ge; 1.1.0), Rcpp (&ge; 0.11.3)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-05-09 23:07:35 UTC; ianjohns</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-05-10 07:50:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='fit_rcpp'>
Predict y from X and b
</h2><span id='topic+fit_rcpp'></span>

<h3>Description</h3>

<p>Predict y vector from X design matrix and b vector 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_rcpp(X,b)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit_rcpp_+3A_x">X</code></td>
<td>
<p>Design matrix</p>
</td></tr>
<tr><td><code id="fit_rcpp_+3A_b">b</code></td>
<td>
<p>Estimates of beta</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ian M. Johnson</p>


<h3>Examples</h3>

<pre><code class='language-R'>j &lt;- rep(1, 5)
x1 &lt;- rnorm(5)
x2 &lt;- rnorm(5, 10, 20)
X = as.matrix(data.frame(j, x1, x2))
b &lt;- 1:3
fit_rcpp(X, b)
</code></pre>

<hr>
<h2 id='mad_rcpp'>
Median Absolute Deviation (MAD)
</h2><span id='topic+mad_rcpp'></span>

<h3>Description</h3>

<p>Rcpp fast implementation of median absolute deviation (MAD)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mad_rcpp(r,scale_factor = 1.4826)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mad_rcpp_+3A_r">r</code></td>
<td>
<p>A numeric vector</p>
</td></tr>
<tr><td><code id="mad_rcpp_+3A_scale_factor">scale_factor</code></td>
<td>
<p>Scale factor</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ian M. Johnson</p>


<h3>Examples</h3>

<pre><code class='language-R'>mad(1:100)
</code></pre>

<hr>
<h2 id='median_rcpp'>
Median
</h2><span id='topic+median_rcpp'></span>

<h3>Description</h3>

<p>Rcpp fast implementation of median
</p>


<h3>Usage</h3>

<pre><code class='language-R'>median_rcpp(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="median_rcpp_+3A_x">x</code></td>
<td>
<p>A numeric vector containing the values whose median is to be computed.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ian M. Johnson</p>


<h3>Examples</h3>

<pre><code class='language-R'>median_rcpp(1:100)
</code></pre>

<hr>
<h2 id='psiBS_rcpp'>
Tukey's Bisquare Psi Function
</h2><span id='topic+psiBS_rcpp'></span>

<h3>Description</h3>

<p>Rcpp fast implementation of Tukey's Bisquare psi function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>psiBS_rcpp(r,c)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="psiBS_rcpp_+3A_r">r</code></td>
<td>
<p>A numeric vector</p>
</td></tr>
<tr><td><code id="psiBS_rcpp_+3A_c">c</code></td>
<td>
<p>Tuning constant</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ian M. Johnson</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
psiBS_rcpp(r,c)

## End(Not run)
</code></pre>

<hr>
<h2 id='psiHuber_rcpp'>
Huber Psi Function
</h2><span id='topic+psiHuber_rcpp'></span>

<h3>Description</h3>

<p>Rcpp fast implementation of Huber's Psi Function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>psiHuber_rcpp(r,c)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="psiHuber_rcpp_+3A_r">r</code></td>
<td>
<p>A numeric vector</p>
</td></tr>
<tr><td><code id="psiHuber_rcpp_+3A_c">c</code></td>
<td>
<p>Tuning constant</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ian M. Johnson</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
psiHuber_rcpp(r,c)

## End(Not run)
</code></pre>

<hr>
<h2 id='robustRegBS'>Robust Fitting of Linear Models using Bisquare Psi Function</h2><span id='topic+robustRegBS'></span>

<h3>Description</h3>

<p>Using iteratively reweighted least squares (IRLS), the function calculates the optimal weights to perform m-estimator or bounded influence regression.  Returns robust beta estimates, mean squared error (MSE) and prints robust ANOVA table.</p>


<h3>Usage</h3>

<pre><code class='language-R'>robustRegBS(formula,data,tune=4.685,m=TRUE,max.it=1000,tol=1e-5,anova.table=FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="robustRegBS_+3A_formula">formula</code></td>
<td>
<p>Model</p>
</td></tr>
<tr><td><code id="robustRegBS_+3A_data">data</code></td>
<td>
<p>A data frame containing the variables in the model.</p>
</td></tr>
<tr><td><code id="robustRegBS_+3A_tune">tune</code></td>
<td>
<p>Tuning Constant.  Default value of 4.685 is 95% asymptotically efficient against outliers</p>
</td></tr>
<tr><td><code id="robustRegBS_+3A_m">m</code></td>
<td>
<p>If <code>TRUE</code>, calculates m estimates of beta.  If <code>FALSE</code>, calculates bounded influence estimates of beta</p>
</td></tr>
<tr><td><code id="robustRegBS_+3A_max.it">max.it</code></td>
<td>
<p>Maximum number of iterations to achieve convergence in IRLS algorithm</p>
</td></tr>
<tr><td><code id="robustRegBS_+3A_tol">tol</code></td>
<td>
<p>Tolerance level in determining convergence</p>
</td></tr>
<tr><td><code id="robustRegBS_+3A_anova.table">anova.table</code></td>
<td>
<p>If <code>TRUE</code>, prints robust ANOVA table</p>
</td></tr>
</table>


<h3>Details</h3>

<p>M-estimates of beta should be used when evaluating least squares estimates of beta and diagnostics show outliers.  Least squares estimates of beta should be used as starting points to achieve convergence.
</p>
<p>Bounded influence estimates of beta should be used when evaluating least squares estimates of beta and diagnostics show large values of the &quot;Hat Matrix&quot; diagonals and outliers.</p>


<h3>Note</h3>

<p>Original package written in 2006</p>


<h3>Author(s)</h3>

<p>Ian M. Johnson</p>


<h3>References</h3>

<p>Tukey,
</p>
<p>Birch, Robust F-Test, 1983</p>


<h3>See Also</h3>

<p>robustRegH()</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(stackloss)
robustRegBS(stack.loss~Air.Flow+Water.Temp,data=stackloss)

#If X matrix contained large values of H matrix (high influence points)
robustRegBS(stack.loss~Air.Flow+Water.Temp,data=stackloss,m=FALSE)
</code></pre>

<hr>
<h2 id='robustRegH'>Robust Fitting of Linear Models using Huber Psi Function</h2><span id='topic+robustRegH'></span>

<h3>Description</h3>

<p>Using iteratively reweighted least squares (IRLS), the function calculates the optimal weights to perform m-estimator or bounded influence regression.  Returns robust beta estimates, mean squared error (MSE) and prints robust ANOVA table</p>


<h3>Usage</h3>

<pre><code class='language-R'>robustRegH(formula,data,tune=1.345,m=TRUE,max.it=1000,tol=1e-5,anova.table=FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="robustRegH_+3A_formula">formula</code></td>
<td>
<p>Model</p>
</td></tr>
<tr><td><code id="robustRegH_+3A_data">data</code></td>
<td>
<p>A data frame containing the variables in the model.</p>
</td></tr>
<tr><td><code id="robustRegH_+3A_tune">tune</code></td>
<td>
<p>Tuning Constant.  Default value of 1.345 is 95% asymptotically efficient against outliers</p>
</td></tr>
<tr><td><code id="robustRegH_+3A_m">m</code></td>
<td>
<p>If <code>TRUE</code>, calculates m estimates of beta.  If <code>FALSE</code>, calculates bounded influence estimates of beta</p>
</td></tr>
<tr><td><code id="robustRegH_+3A_max.it">max.it</code></td>
<td>
<p>Maximum number of iterations to achieve convergence in IRLS algorithm</p>
</td></tr>
<tr><td><code id="robustRegH_+3A_tol">tol</code></td>
<td>
<p>Tolerance level in determining convergence</p>
</td></tr>
<tr><td><code id="robustRegH_+3A_anova.table">anova.table</code></td>
<td>
<p>If <code>TRUE</code>, prints robust ANOVA table</p>
</td></tr>
</table>


<h3>Details</h3>

<p>M-estimates of beta should be used when evaluating least squares estimates of beta and diagnostics show outliers.  Least squares estimates of beta are used as starting points to achieve convergence.
</p>
<p>Bounded influence estimates of beta should be used when evaluating least squares estimates of beta and diagnostics show large values of the &quot;Hat Matrix&quot; diagonals and outliers.</p>


<h3>Note</h3>

<p>Original package written in 2006</p>


<h3>Author(s)</h3>

<p>Ian M. Johnson</p>


<h3>References</h3>

<p>P. J. Huber (1981) Robust Statistics. Wiley. 
</p>
<p>Birch (1983) Robust F-Test</p>


<h3>See Also</h3>

<p>robustRegBS()</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(stackloss)
robustRegH(stack.loss~Air.Flow+Water.Temp,data=stackloss)

#If X matrix contained large values of H matrix (high influence points)
robustRegH(stack.loss~Air.Flow+Water.Temp,data=stackloss,m=FALSE)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
