<!DOCTYPE html><html lang="en"><head><title>Help for package windows.pls</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {windows.pls}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#beer'><p>Beer Dataset from Near Infrared Spectroscopy</p></a></li>
<li><a href='#convert.names.wl'><p>Turns wavelengths into variable's names</p></a></li>
<li><a href='#cv.wpls'><p>Cross-validation for segmented spectral regions of the original spectra.</p></a></li>
<li><a href='#global.r2'><p>Plots in a single window the R2 of each model.</p></a></li>
<li><a href='#global.rmse'><p>Plots in a single window the RMSE of each model.</p></a></li>
<li><a href='#map.best.window'><p>Plots spectra highlighting windows with the best performance.</p></a></li>
<li><a href='#map.spectra.gradient'><p>Colors and plots each spectra based on the associated concentration of the outcome variable</p></a></li>
<li><a href='#r2.single.window'><p>Plots R2 of calibration and cross-validation of a single nindow.</p></a></li>
<li><a href='#rmse.single.window'><p>Plots RMSE of calibration and cross-validation of a single wnindow.</p></a></li>
<li><a href='#segment.windows'><p>Displays how  spectra are divided in windows</p></a></li>
<li><a href='#sel.best.window'><p>Selection of the best window computed with cv.wpls</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Segmentation Approaches in Chemometrics</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Elia Gonzato &lt;elia.gonzato@outlook.it&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Evaluation of prediction performance of smaller regions of
    spectra for Chemometrics. Segmentation of spectra, evolving dimensions
    regions and sliding windows as selection methods. Election of the best
    model among those computed based on error metrics. Chen et al.(2017)
    &lt;<a href="https://doi.org/10.1007%2Fs00216-017-0218-9">doi:10.1007/s00216-017-0218-9</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/egonzato/windows.pls">https://github.com/egonzato/windows.pls</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/egonzato/windows.pls/issues">https://github.com/egonzato/windows.pls/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr, ggplot2, grDevices, mdatools, readr, stringr, tidyr,
tidyverse</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-08 18:07:28 UTC; Elia Gonzato</td>
</tr>
<tr>
<td>Author:</td>
<td>Elia Gonzato [aut, cre, cph]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-09 17:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='beer'>Beer Dataset from Near Infrared Spectroscopy</h2><span id='topic+beer'></span>

<h3>Description</h3>

<p>The beer dataset contains 60 samples published by Norgaard et al. Recorded with a 30mm quartz cell
on the undiluted degassed beer and measured
from 1100 to 2250 nm (576 data points) in steps of 2 nm.
A good playing ground for regression methods starting from spectral intensities.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>beer
</code></pre>


<h3>Format</h3>



<h4><code>beer</code></h4>

<p>A data frame with 80 rows and 577 columns:
</p>

<dl>
<dt>y</dt><dd><p>Original extract concentration</p>
</dd>
<dt>xtrain</dt><dd><p>Intesities measured on 576 different data points</p>
</dd>
</dl>




<h3>Source</h3>

<p><a href="https://www.kaggle.com/datasets/robertoschimmenti/beer-nir?resource=download">https://www.kaggle.com/datasets/robertoschimmenti/beer-nir?resource=download</a>
</p>


<h3>References</h3>

<p>Norgaard, L., Saudland, A., Wagner, J., Nielsen, J. P., Munck, L., &amp; Engelsen, S. B. (2000). Interval partial least-squares regression (iPLS): a comparative chemometric study with an example from near-infrared spectroscopy. Applied Spectroscopy, 54(3), 413–419.
Adapted from a R dataset available as part of the OHPL package (https://search.r-project.org/CRAN/refmans/OHPL/html/00Index.html).
</p>

<hr>
<h2 id='convert.names.wl'>Turns wavelengths into variable's names</h2><span id='topic+convert.names.wl'></span>

<h3>Description</h3>

<p>Turns wavelengths into variable's names
</p>


<h3>Usage</h3>

<pre><code class='language-R'>convert.names.wl(start = NULL, stop = NULL, step = 2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="convert.names.wl_+3A_start">start</code></td>
<td>
<p>First wavelength of the spectra.</p>
</td></tr>
<tr><td><code id="convert.names.wl_+3A_stop">stop</code></td>
<td>
<p>Last wavelength of the spectra.</p>
</td></tr>
<tr><td><code id="convert.names.wl_+3A_step">step</code></td>
<td>
<p>Distance between each recorded wavelength.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns vector with syntactically valid names for each wavelength
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(beer)
X=beer[,2:ncol(beer)]
head(names(X))
names(X)=convert.names.wl(1100,2250,2)
head(names(X))
</code></pre>

<hr>
<h2 id='cv.wpls'>Cross-validation for segmented spectral regions of the original spectra.</h2><span id='topic+cv.wpls'></span>

<h3>Description</h3>

<p>Computes and stores cross-validation metrics for one of the three possible modes ‘wpls’, ‘epls’, ‘swpls’.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cv.wpls(
  xblock = NULL,
  yblock = NULL,
  windows = 3,
  window.size = 30,
  increment = 10,
  cv = 10,
  scale = FALSE,
  ncp = 10,
  mode = "wpls"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cv.wpls_+3A_xblock">xblock</code></td>
<td>
<p>A matrix containing one spectra for each observation.</p>
</td></tr>
<tr><td><code id="cv.wpls_+3A_yblock">yblock</code></td>
<td>
<p>A vector containing the concentration associated to each spectra in the <em>xblock</em> matrix.</p>
</td></tr>
<tr><td><code id="cv.wpls_+3A_windows">windows</code></td>
<td>
<p>Parameter used when either ‘wpls’ or ‘ewpls’ is chosen. Points out how many windows the user wants to divide the spectra in.</p>
</td></tr>
<tr><td><code id="cv.wpls_+3A_window.size">window.size</code></td>
<td>
<p>Parameter used when ‘swpls’ is chosen. Indicates the width of the window that slides along the spectra.</p>
</td></tr>
<tr><td><code id="cv.wpls_+3A_increment">increment</code></td>
<td>
<p>Parameter used when ‘swpls’ is chosen. Indicates how many steps the window slides forward.</p>
</td></tr>
<tr><td><code id="cv.wpls_+3A_cv">cv</code></td>
<td>
<p>Number of segments used for cross-validation.</p>
</td></tr>
<tr><td><code id="cv.wpls_+3A_scale">scale</code></td>
<td>
<p>logical, asks to perform standardization.</p>
</td></tr>
<tr><td><code id="cv.wpls_+3A_ncp">ncp</code></td>
<td>
<p>Maximum number of principal components to be computed for each model.</p>
</td></tr>
<tr><td><code id="cv.wpls_+3A_mode">mode</code></td>
<td>
<p>'wpls','ewpls' or 'swpls', see <strong>Details</strong> for more.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>NIR and Vis-NIR technologies are used to obtain spectra which might
contain helpful information about the content of the samples the user is investigating.
Since this method has been combined with multivariate statistical methods, researchers have
been questioning the importance of using spectra in its entirety or if it might be a better
solution to divide it in smaller regions which can guarantee higher performance in terms of predictions.
Several methods have been proposed, from selecting only some regions to selecting combinations of those which are performing the best.
This function provides three possibilities:
</p>

<ol>
<li> <p><strong>‘wpls’</strong>, which stands for <em>Window PLS</em>, divides the original spectra into several windows, computes PLS and stores metrics of interest such as RMSE and R2 for calibration and cross-validation both.
</p>
</li>
<li> <p><strong>‘ewpls’</strong>, which stands for <em>Evolving Window PLS</em>, divides the original spectra into several windows, but each new window incorporates the previous ones, so that we are comparing smaller windows with the entire spectra.
</p>
</li>
<li> <p><strong>’swpls’</strong>, which stands for <em>Sliding Window Window PLS</em>, ,asks the width of the window that will be used to compute the model and the step that the window will make forward in the spectra so that a new model is calculated. In this way the window slides along spectra and computes several models, which will be compared with metrics.
</p>
</li></ol>

<p>This function proposes a simpler version of <strong>iPLS</strong>, that can be found in the <strong>mdatools</strong> package, which divides the spectra in smaller segments and tries to find the combination with the lowest RMSE in cross-validation.
</p>


<h3>Value</h3>

<p>Returns a list containing:
</p>
<table role = "presentation">
<tr><td><code>xblock</code></td>
<td>
<p>Matrix containing spectra used to train the model.</p>
</td></tr>
<tr><td><code>yblock</code></td>
<td>
<p>Vector containing values of the dependent variable.</p>
</td></tr>
<tr><td><code>cal</code></td>
<td>
<p>List containing RMSE and R2 of calibratrion.</p>
</td></tr>
<tr><td><code>cv</code></td>
<td>
<p>List containing RMSE and R2 of cross-validation.</p>
</td></tr>
<tr><td><code>ncp</code></td>
<td>
<p>Number of components used to compute the model.</p>
</td></tr>
<tr><td><code>scale</code></td>
<td>
<p>Contains logical condition used for standardization.</p>
</td></tr>
<tr><td><code>cv.segment</code></td>
<td>
<p> Number of segments used for cross-validation.</p>
</td></tr>
</table>


<h3>References</h3>


<ol>
<li><p> Chen, J., Yin, Z., Tang, Y. et al. Vis-NIR spectroscopy with moving-window PLS method applied to rapid analysis of whole blood viscosity. Anal Bioanal Chem 409, 2737–2745 (2017).
</p>
</li>
<li><p> Y.P. Du, Y.Z. Liang, J.H. Jiang, R.J. Berry, Y. Ozaki, Spectral regions selection to improve prediction ability of PLS models by changeable size moving window partial least squares and searching combination moving window partial least squares, Analytica Chimica Acta, Volume 501, Issue 2, 2004, Pages 183-191,
</p>
</li>
<li> <p><strong>mdatools</strong> package, https://github.com/svkucheryavski/mdatools
</p>
</li></ol>



<h3>Examples</h3>

<pre><code class='language-R'>data(beer)
conc=beer[,1]
sp=beer[,2:ncol(beer)]
names(sp)=convert.names.wl(1100,2250,2)
conc=unlist(conc)
mywpls=cv.wpls(sp, conc,mode='wpls', windows = 5)
</code></pre>

<hr>
<h2 id='global.r2'>Plots in a single window the R2 of each model.</h2><span id='topic+global.r2'></span>

<h3>Description</h3>

<p>Plots in a single window the R2 of each model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>global.r2(
  wpls = NULL,
  col.cal = "blue",
  col.cv = "red",
  col.strip.background = "orange",
  xlab = NULL,
  ylab = NULL,
  title = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="global.r2_+3A_wpls">wpls</code></td>
<td>
<p>object obtained from <strong>cv.wpls</strong>.</p>
</td></tr>
<tr><td><code id="global.r2_+3A_col.cal">col.cal</code></td>
<td>
<p>color for the calibration line.</p>
</td></tr>
<tr><td><code id="global.r2_+3A_col.cv">col.cv</code></td>
<td>
<p>color for the cross-validation line.</p>
</td></tr>
<tr><td><code id="global.r2_+3A_col.strip.background">col.strip.background</code></td>
<td>
<p>color of the banner for each window.</p>
</td></tr>
<tr><td><code id="global.r2_+3A_xlab">xlab</code></td>
<td>
<p>title of the x axis.</p>
</td></tr>
<tr><td><code id="global.r2_+3A_ylab">ylab</code></td>
<td>
<p>title of the y axis.</p>
</td></tr>
<tr><td><code id="global.r2_+3A_title">title</code></td>
<td>
<p>title of the plot.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Plot of R2 of each spectra region used to compute PLS.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(beer)
conc=beer[,1]
sp=beer[,2:ncol(beer)]
names(sp)=convert.names.wl(1100,2250,2)
conc=unlist(conc)
mywpls=cv.wpls(sp, conc,mode='wpls', windows = 5)
global.r2(mywpls,col.cal='navy',
               col.cv='red',
               col.strip.background='orange',
               xlab='Component',
               ylab=expression(R^2))
</code></pre>

<hr>
<h2 id='global.rmse'>Plots in a single window the RMSE of each model.</h2><span id='topic+global.rmse'></span>

<h3>Description</h3>

<p>Plots in a single window the RMSE of each model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>global.rmse(
  wpls = NULL,
  col.cal = "blue",
  col.cv = "red",
  col.strip.background = "steelblue",
  xlab = NULL,
  ylab = NULL,
  title = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="global.rmse_+3A_wpls">wpls</code></td>
<td>
<p>object obtained from <strong>cv.wpls</strong>.</p>
</td></tr>
<tr><td><code id="global.rmse_+3A_col.cal">col.cal</code></td>
<td>
<p>color for the calibration line.</p>
</td></tr>
<tr><td><code id="global.rmse_+3A_col.cv">col.cv</code></td>
<td>
<p>color for the cross-validation line.</p>
</td></tr>
<tr><td><code id="global.rmse_+3A_col.strip.background">col.strip.background</code></td>
<td>
<p>color of the banner for each window.</p>
</td></tr>
<tr><td><code id="global.rmse_+3A_xlab">xlab</code></td>
<td>
<p>title of the x axis.</p>
</td></tr>
<tr><td><code id="global.rmse_+3A_ylab">ylab</code></td>
<td>
<p>title of the y axis.</p>
</td></tr>
<tr><td><code id="global.rmse_+3A_title">title</code></td>
<td>
<p>title of the plot.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Plot of RMSE of each spectra region used to compute PLS.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(beer)
conc=beer[,1]
sp=beer[,2:ncol(beer)]
names(sp)=convert.names.wl(1100,2250,2)
conc=unlist(conc)
mywpls=cv.wpls(sp, conc,mode='wpls', windows = 5)
global.rmse(mywpls,col.cal='navy',
               col.cv='red',
               col.strip.background='orange',
               xlab='Component',
               ylab='RMSE')
</code></pre>

<hr>
<h2 id='map.best.window'>Plots spectra highlighting windows with the best performance.</h2><span id='topic+map.best.window'></span>

<h3>Description</h3>

<p>Plots spectra highlighting windows with the best performance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>map.best.window(
  wpls = NULL,
  fade = 0.7,
  col.window = "steelblue",
  xlab = "Wavelengths",
  ylab = "Absorbance",
  title = NULL,
  legend = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="map.best.window_+3A_wpls">wpls</code></td>
<td>
<p>object obtained from <strong>cv.wpls</strong>.</p>
</td></tr>
<tr><td><code id="map.best.window_+3A_fade">fade</code></td>
<td>
<p>opacity of the window.</p>
</td></tr>
<tr><td><code id="map.best.window_+3A_col.window">col.window</code></td>
<td>
<p>color of the window that highlights the region.</p>
</td></tr>
<tr><td><code id="map.best.window_+3A_xlab">xlab</code></td>
<td>
<p>title of the x axis.</p>
</td></tr>
<tr><td><code id="map.best.window_+3A_ylab">ylab</code></td>
<td>
<p>title of the y axis.</p>
</td></tr>
<tr><td><code id="map.best.window_+3A_title">title</code></td>
<td>
<p>title of the plot.</p>
</td></tr>
<tr><td><code id="map.best.window_+3A_legend">legend</code></td>
<td>
<p>description description</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Plot of the spectra with a window that highlights the region with the lowest cross-validation error.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(beer)
conc=beer[,1]
sp=beer[,2:ncol(beer)]
names(sp)=convert.names.wl(1100,2250,2)
conc=unlist(conc)
mywpls=cv.wpls(sp, conc,mode='wpls', windows = 5)
map.best.window(mywpls)
</code></pre>

<hr>
<h2 id='map.spectra.gradient'>Colors and plots each spectra based on the associated concentration of the outcome variable</h2><span id='topic+map.spectra.gradient'></span>

<h3>Description</h3>

<p>Colors and plots each spectra based on the associated concentration of the outcome variable
</p>


<h3>Usage</h3>

<pre><code class='language-R'>map.spectra.gradient(
  xblock = NULL,
  yblock = NULL,
  legend.title = "Gradient",
  plot.title = "Spectra with gradient based on Y variable",
  xlab = "Wavelength",
  ylab = "Absorbance",
  grad = 10,
  l.width = 0.75,
  col.legend = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="map.spectra.gradient_+3A_xblock">xblock</code></td>
<td>
<p>A matrix containing one spectra for each observation.</p>
</td></tr>
<tr><td><code id="map.spectra.gradient_+3A_yblock">yblock</code></td>
<td>
<p>A vector containing the concentration associated to each spectra in the <em>xblock</em> matrix.</p>
</td></tr>
<tr><td><code id="map.spectra.gradient_+3A_legend.title">legend.title</code></td>
<td>
<p>Title of the legend which displays the gradient.</p>
</td></tr>
<tr><td><code id="map.spectra.gradient_+3A_plot.title">plot.title</code></td>
<td>
<p>Title of the plot.</p>
</td></tr>
<tr><td><code id="map.spectra.gradient_+3A_xlab">xlab</code></td>
<td>
<p>Title of the x axis.</p>
</td></tr>
<tr><td><code id="map.spectra.gradient_+3A_ylab">ylab</code></td>
<td>
<p>Title of the y axis.</p>
</td></tr>
<tr><td><code id="map.spectra.gradient_+3A_grad">grad</code></td>
<td>
<p>Number of colors for the gradient's palette.</p>
</td></tr>
<tr><td><code id="map.spectra.gradient_+3A_l.width">l.width</code></td>
<td>
<p>Width of each spectra.</p>
</td></tr>
<tr><td><code id="map.spectra.gradient_+3A_col.legend">col.legend</code></td>
<td>
<p>Deletes presence of the legend.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Plot with spectra of all observations, mapped with the intensity of the associated concentration.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(beer)
X=beer[,2:ncol(beer)]
names(X)=convert.names.wl(1100,2250,2)
Y=unlist(beer[,1])
map.spectra.gradient(X,Y)
</code></pre>

<hr>
<h2 id='r2.single.window'>Plots R2 of calibration and cross-validation of a single nindow.</h2><span id='topic+r2.single.window'></span>

<h3>Description</h3>

<p>Plots R2 of calibration and cross-validation of a single nindow.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>r2.single.window(
  wpls = NULL,
  condition = "Complete",
  shape.cal = 19,
  shape.cv = 19,
  width = 1,
  size = 2,
  col.cal = "blue",
  col.cv = "red",
  xaxis.title = "Component",
  yaxis.title = expression(R^2),
  title = paste("Plot of R2 for the", condition, "model"),
  legend.name = NULL,
  x.legend = 0.9,
  y.legend = 0.2
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="r2.single.window_+3A_wpls">wpls</code></td>
<td>
<p>object obtained from <strong>cv.wpls</strong>.</p>
</td></tr>
<tr><td><code id="r2.single.window_+3A_condition">condition</code></td>
<td>
<p>name of the Window the user wants to plot.</p>
</td></tr>
<tr><td><code id="r2.single.window_+3A_shape.cal">shape.cal</code></td>
<td>
<p>shape of the point of the calibration line.</p>
</td></tr>
<tr><td><code id="r2.single.window_+3A_shape.cv">shape.cv</code></td>
<td>
<p>shape of the point of the cross-validation line.</p>
</td></tr>
<tr><td><code id="r2.single.window_+3A_width">width</code></td>
<td>
<p>width of the line.</p>
</td></tr>
<tr><td><code id="r2.single.window_+3A_size">size</code></td>
<td>
<p>size of the points of calibration and cross-validation.</p>
</td></tr>
<tr><td><code id="r2.single.window_+3A_col.cal">col.cal</code></td>
<td>
<p>color for the calibration line.</p>
</td></tr>
<tr><td><code id="r2.single.window_+3A_col.cv">col.cv</code></td>
<td>
<p>color for the cross-validation line.</p>
</td></tr>
<tr><td><code id="r2.single.window_+3A_xaxis.title">xaxis.title</code></td>
<td>
<p>title of the x axis.</p>
</td></tr>
<tr><td><code id="r2.single.window_+3A_yaxis.title">yaxis.title</code></td>
<td>
<p>title of the y axis.</p>
</td></tr>
<tr><td><code id="r2.single.window_+3A_title">title</code></td>
<td>
<p>title of the plot.</p>
</td></tr>
<tr><td><code id="r2.single.window_+3A_legend.name">legend.name</code></td>
<td>
<p>displays legend and its name.</p>
</td></tr>
<tr><td><code id="r2.single.window_+3A_x.legend">x.legend</code></td>
<td>
<p>position of the legend on the x axis, ranges from 0 to 1.</p>
</td></tr>
<tr><td><code id="r2.single.window_+3A_y.legend">y.legend</code></td>
<td>
<p>position of the legend on the y axis, ranges from 0 to 1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Plot of R2 of the region requested by the user.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(beer)
conc=beer[,1]
sp=beer[,2:ncol(beer)]
names(sp)=convert.names.wl(1100,2250,2)
conc=unlist(conc)
mywpls=cv.wpls(sp, conc,mode='wpls', windows = 5)
r2.single.window(mywpls,'Window2')
</code></pre>

<hr>
<h2 id='rmse.single.window'>Plots RMSE of calibration and cross-validation of a single wnindow.</h2><span id='topic+rmse.single.window'></span>

<h3>Description</h3>

<p>Plots RMSE of calibration and cross-validation of a single wnindow.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rmse.single.window(
  wpls = NULL,
  condition = "Complete",
  shape.cal = 19,
  shape.cv = 19,
  width = 1,
  size = 2,
  col.cal = "blue",
  col.cv = "red",
  xaxis.title = "Component",
  yaxis.title = "RMSE",
  title = paste("Plot of RMSE for the", condition, "model"),
  legend.name = NULL,
  x.legend = 0.1,
  y.legend = 0.2
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rmse.single.window_+3A_wpls">wpls</code></td>
<td>
<p>object obtained from <strong>cv.wpls</strong>.</p>
</td></tr>
<tr><td><code id="rmse.single.window_+3A_condition">condition</code></td>
<td>
<p>name of the Window the user wants to plot.</p>
</td></tr>
<tr><td><code id="rmse.single.window_+3A_shape.cal">shape.cal</code></td>
<td>
<p>shape of the point of the calibration line.</p>
</td></tr>
<tr><td><code id="rmse.single.window_+3A_shape.cv">shape.cv</code></td>
<td>
<p>shape of the point of the cross-validation line.</p>
</td></tr>
<tr><td><code id="rmse.single.window_+3A_width">width</code></td>
<td>
<p>width of the line.</p>
</td></tr>
<tr><td><code id="rmse.single.window_+3A_size">size</code></td>
<td>
<p>size of the points of calibration and cross-validation.</p>
</td></tr>
<tr><td><code id="rmse.single.window_+3A_col.cal">col.cal</code></td>
<td>
<p>color for the calibration line.</p>
</td></tr>
<tr><td><code id="rmse.single.window_+3A_col.cv">col.cv</code></td>
<td>
<p>color for the cross-validation line.</p>
</td></tr>
<tr><td><code id="rmse.single.window_+3A_xaxis.title">xaxis.title</code></td>
<td>
<p>title of the x axis.</p>
</td></tr>
<tr><td><code id="rmse.single.window_+3A_yaxis.title">yaxis.title</code></td>
<td>
<p>title of the y axis.</p>
</td></tr>
<tr><td><code id="rmse.single.window_+3A_title">title</code></td>
<td>
<p>title of the plot.</p>
</td></tr>
<tr><td><code id="rmse.single.window_+3A_legend.name">legend.name</code></td>
<td>
<p>displays legend and its name.</p>
</td></tr>
<tr><td><code id="rmse.single.window_+3A_x.legend">x.legend</code></td>
<td>
<p>position of the legend on the x axis, ranges from 0 to 1.</p>
</td></tr>
<tr><td><code id="rmse.single.window_+3A_y.legend">y.legend</code></td>
<td>
<p>position of the legend on the y axis, ranges from 0 to 1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Plot of RMSE of the region requested by the user.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(beer)
conc=unlist(beer[,1])
sp=beer[,2:ncol(beer)]
names(sp)=convert.names.wl(1100,2250,2)
mywpls=cv.wpls(sp, conc,mode='wpls', windows = 5)
rmse.single.window(mywpls,'Window2')
</code></pre>

<hr>
<h2 id='segment.windows'>Displays how  spectra are divided in windows</h2><span id='topic+segment.windows'></span>

<h3>Description</h3>

<p>Displays how  spectra are divided in windows
</p>


<h3>Usage</h3>

<pre><code class='language-R'>segment.windows(
  xblock = NULL,
  yblock = NULL,
  windows = 3,
  fade = 0.3,
  xlab = "Wavelength",
  ylab = "Absorbance",
  title = paste("Spectra divided in", windows, "segments", sep = " "),
  legend = NULL,
  grad = 10
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="segment.windows_+3A_xblock">xblock</code></td>
<td>
<p>A matrix containing one spectra for each observation.</p>
</td></tr>
<tr><td><code id="segment.windows_+3A_yblock">yblock</code></td>
<td>
<p>A vector containing the concentration associated to each spectra in the <em>xblock</em> matrix.</p>
</td></tr>
<tr><td><code id="segment.windows_+3A_windows">windows</code></td>
<td>
<p>Number of windows the spectra has to be divided in.</p>
</td></tr>
<tr><td><code id="segment.windows_+3A_fade">fade</code></td>
<td>
<p>Opacity of the window.</p>
</td></tr>
<tr><td><code id="segment.windows_+3A_xlab">xlab</code></td>
<td>
<p>Title of the x axis.</p>
</td></tr>
<tr><td><code id="segment.windows_+3A_ylab">ylab</code></td>
<td>
<p>Title of the y axis.</p>
</td></tr>
<tr><td><code id="segment.windows_+3A_title">title</code></td>
<td>
<p>Title of the plot.</p>
</td></tr>
<tr><td><code id="segment.windows_+3A_legend">legend</code></td>
<td>
<p>Name of the substance which drives the gradient of spectra’s mapping.</p>
</td></tr>
<tr><td><code id="segment.windows_+3A_grad">grad</code></td>
<td>
<p>Number of colors that are used to build the gradient.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Plot of spectra in which segments have a different background color.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(beer)
conc=unlist(beer[,1])
sp=beer[,2:ncol(beer)]
names(sp)=convert.names.wl(1100,2250,2)
segment.windows(sp,conc,windows=7,fade=0.25)
</code></pre>

<hr>
<h2 id='sel.best.window'>Selection of the best window computed with cv.wpls</h2><span id='topic+sel.best.window'></span>

<h3>Description</h3>

<p>Takes as input the object containing metrics of the several models computed
with cv.wpls and selects the best basing on the lowest RMSE available; then computes
PLS and gives as output an object containing results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sel.best.window(wpls = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sel.best.window_+3A_wpls">wpls</code></td>
<td>
<p>object obtained from cv.wpls.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object containing results of the best model. Has the same content of a model obtained from the function <strong>pls</strong> of <strong>mdatools</strong>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(beer)
conc=beer[,1]
sp=beer[,2:ncol(beer)]
names(sp)=convert.names.wl(1100,2250,2)
conc=unlist(conc)
mywpls=cv.wpls(sp, conc,mode='wpls', windows = 5)
best.pls=sel.best.window(mywpls)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
