<!DOCTYPE html><html><head><title>Help for package smovie</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {smovie}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#clt'><p>Central Limit Theorem (CLT)</p></a></li>
<li><a href='#cltq'><p>Central Limit Theorem (CLT) for sample quantiles</p></a></li>
<li><a href='#continuous'><p>Univariate Continuous Distributions: p.d.f and c.d.f.</p></a></li>
<li><a href='#correlation'><p>Sampling distribution of the correlation coefficient movie</p></a></li>
<li><a href='#discrete'><p>Univariate Discrete Distributions: p.m.f and c.d.f.</p></a></li>
<li><a href='#ett'><p>Extremal Types Theorem (ETT)</p></a></li>
<li><a href='#Fcorr'><p>Fisher's transformation of the product moment correlation coefficient</p></a></li>
<li><a href='#lev_inf'><p>Leverage and influence in simple linear regression movie</p></a></li>
<li><a href='#mean_vs_median'><p>Sample mean vs sample median</p></a></li>
<li><a href='#movies'><p>Main menu for smovie movies</p></a></li>
<li><a href='#shypo'><p>Testing simple hypotheses</p></a></li>
<li><a href='#smovie-package'><p>smovie: some movies to illustrate concepts in statistics</p></a></li>
<li><a href='#wws'><p>Wald, Wilks and Score tests</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Some Movies to Illustrate Concepts in Statistics</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.6</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-12-02</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides movies to help students to understand statistical 
  concepts.  The 'rpanel' package  <a href="https://cran.r-project.org/package=rpanel">https://cran.r-project.org/package=rpanel</a> 
  is used to create interactive plots that move to illustrate key statistical 
  ideas and methods.  There are movies to: visualise probability distributions
  (including user-supplied ones); illustrate sampling distributions of the
  sample mean (central limit theorem), the median, the sample maximum 
  (extremal types theorem) and (the Fisher transformation of the) 
  product moment correlation coefficient; examine the influence of an 
  individual observation in simple linear regression; illustrate key concepts 
  in statistical hypothesis testing. Also provided are dpqr functions for the 
  distribution of the Fisher transformation of the correlation coefficient 
  under sampling from a bivariate normal distribution.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.3.0), rpanel (&ge; 1.1-3)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Imports:</td>
<td>graphics, stats</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, numDeriv, revdbayes (&ge; 1.1.0), tkrplot, testthat,
rmarkdown, SuppDists</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://paulnorthrop.github.io/smovie/">https://paulnorthrop.github.io/smovie/</a>,
<a href="https://github.com/paulnorthrop/smovie/">https://github.com/paulnorthrop/smovie/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/paulnorthrop/smovie/issues">https://github.com/paulnorthrop/smovie/issues</a></td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-12-02 20:48:52 UTC; Paul</td>
</tr>
<tr>
<td>Author:</td>
<td>Paul J. Northrop [aut, cre, cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Paul J. Northrop &lt;p.northrop@ucl.ac.uk&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-12-03 01:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='clt'>Central Limit Theorem (CLT)</h2><span id='topic+clt'></span>

<h3>Description</h3>

<p>A movie to illustrate the ideas of the sampling distribution of a mean
and the central limit theorem.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clt(
  n = 20,
  distn,
  params = list(),
  panel_plot = TRUE,
  hscale = NA,
  vscale = hscale,
  n_add = 1,
  delta_n = 1,
  arrow = TRUE,
  leg_cex = 1.25,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="clt_+3A_n">n</code></td>
<td>
<p>An integer scalar.  The size of the samples drawn from the
distribution chosen using <code>distn</code>.</p>
</td></tr>
<tr><td><code id="clt_+3A_distn">distn</code></td>
<td>
<p>A character scalar specifying the distribution from which
observations are sampled.   Distributions <code>"beta"</code>,
<code>"binomial"</code>, <code>"chisq"</code>, <code>"chi-squared"</code>,
<code>"exponential"</code>, <code>"f"</code>, <code>"gamma"</code>, <code>"geometric"</code>,
<code>"gev"</code>, <code>"gp"</code>, <code>"hypergeometric"</code>, <code>"lognormal"</code>,
<code>"log-normal"</code>, <code>"negative binomial"</code>, <code>"normal"</code>,
<code>"poisson"</code>, <code>"t"</code>, <code>"uniform"</code> and <code>"weibull"</code> are
recognised, case being ignored.
</p>
<p>If <code>distn</code> is not supplied then <code>distn = "exponential"</code>
is used.
</p>
<p>The <code>"gev"</code> and <code>"gp"</code> cases use the
<code><a href="revdbayes.html#topic+gev">gev</a></code> and <code><a href="revdbayes.html#topic+gp">gp</a></code>
distributional functions in the
<code><a href="revdbayes.html#topic+revdbayes">revdbayes</a></code> package.
</p>
<p>The other cases use the distributional functions in the
<code><a href="stats.html#topic+stats-package">stats-package</a></code>.
If <code>distn = "gamma"</code> then the <code>(shape, rate)</code>
parameterisation is used.  If <code>scale</code> is supplied via <code>params</code>
then <code>rate</code> is inferred from this.
If <code>distn = "negative binomial"</code> then the <code>(size, prob)</code>
parameterisation is used.  If <code>mu</code> is supplied via <code>params</code>
then <code>prob</code> is inferred from this (and <code>size</code>).
If <code>distn = "beta"</code> then <code>ncp</code> is forced to be zero.</p>
</td></tr>
<tr><td><code id="clt_+3A_params">params</code></td>
<td>
<p>A named list of additional arguments to be passed to the
density function associated with distribution <code>distn</code>.
The <code>(shape, rate)</code> parameterisation is used for the gamma
distribution (see <code><a href="stats.html#topic+GammaDist">GammaDist</a></code>) even if the value of
the <code>scale</code> parameter is set using <code>params</code>.
</p>
<p>If a parameter value is not supplied then the default values in the
relevant distributional function set using <code>distn</code> are used,
except for
<code>"beta"</code> (<code>shape1 = 2, shape2 = 2</code>),
<code>"chisq"</code> (<code>df = 4</code>),
<code>"f"</code> (<code>df1 = 4, df2 = 8</code>),
<code>"gev"</code> (<code>shape = 0.2</code>).
<code>"gamma"</code> (<code>shape = 2</code>,
<code>"gp"</code> (<code>shape = 0.1</code>),
<code>"poisson"</code> (<code>lambda = 5</code>) and
<code>"t"</code> (<code>df = 4</code>) and
<code>"weibull"</code> (<code>shape = 2</code>).</p>
</td></tr>
<tr><td><code id="clt_+3A_panel_plot">panel_plot</code></td>
<td>
<p>A logical parameter that determines whether the plot
is placed inside the panel (<code>TRUE</code>) or in the standard graphics
window (<code>FALSE</code>).  If the plot is to be placed inside the panel
then the tkrplot library is required.</p>
</td></tr>
<tr><td><code id="clt_+3A_hscale">hscale</code>, <code id="clt_+3A_vscale">vscale</code></td>
<td>
<p>Numeric scalars.  Scaling parameters for the size
of the plot when <code>panel_plot = TRUE</code>. The default values are 1.4 on
Unix platforms and 2 on Windows platforms.</p>
</td></tr>
<tr><td><code id="clt_+3A_n_add">n_add</code></td>
<td>
<p>An integer scalar.  The number of simulated datasets to add
to each new frame of the movie.</p>
</td></tr>
<tr><td><code id="clt_+3A_delta_n">delta_n</code></td>
<td>
<p>A numeric scalar.  The amount by which n is increased
(or decreased) after one click of the + (or -) button in the parameter
window.</p>
</td></tr>
<tr><td><code id="clt_+3A_arrow">arrow</code></td>
<td>
<p>A logical scalar.  Should an arrow be included to show the
simulated sample mean from the top plot being placed into the
bottom plot?</p>
</td></tr>
<tr><td><code id="clt_+3A_leg_cex">leg_cex</code></td>
<td>
<p>The argument <code>cex</code> to <code><a href="graphics.html#topic+legend">legend</a></code>.
Allows the size of the legend to be controlled manually.</p>
</td></tr>
<tr><td><code id="clt_+3A_...">...</code></td>
<td>
<p>Additional arguments to the rpanel functions
<code><a href="rpanel.html#topic+rp.button">rp.button</a></code> and
<code><a href="rpanel.html#topic+rp.doublebutton">rp.doublebutton</a></code>, not including <code>panel</code>,
<code>variable</code>, <code>title</code>, <code>step</code>, <code>action</code>, <code>initval</code>,
<code>range</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Loosely speaking, a consequence of the
<a href="https://en.wikipedia.org/wiki/Central_limit_theorem">Central Limit Theorem</a>
is that the mean of a <strong>large number</strong> of independent and
identically distributed random variables, each with mean <code class="reqn">\mu</code> and
finite standard deviation <code class="reqn">\sigma</code>, has <strong>approximately</strong> a
normal distribution, even if these original variables are not normally
distributed.
</p>
<p>This movie considers examples where this limiting result holds and
illustrates graphically the closeness of the limiting approximation
provided by the relevant normal limit to the true finite-<code class="reqn">n</code>
distribution.  Of course, when <code>distn = "normal"</code> this result is
exact.
</p>
<p>Samples of size <code>n</code> are repeatedly simulated from the distribution
chosen using <code>distn</code>.  These samples are summarized using a plot
that appears at the top of the movie screen.  For each sample the mean
of these <code>n</code> values is calculated, stored and added to another plot,
situated below the first plot.
This plot is either a histogram or an empirical c.d.f., chosen using a
radio button.
A <code><a href="graphics.html#topic+rug">rug</a></code> is added to a histogram provided that it
contains no more than 1000 points.
</p>
<p>The p.d.f. (for a continuous variable) or p.m.f. (for a discrete variable)
of the original variables is added to the top plot.
</p>
<p>Once it starts, four aspects of this movie are controlled by the user.
</p>

<ul>
<li><p> There are buttons to increase (+) or decrease (-) the sample
size, that is, the number of values over which a mean is
calculated.
</p>
</li>
<li><p> Each time the button labelled &quot;simulate another <code>n_add</code>
samples of size n&quot; is clicked <code>n_add</code> new samples are simulated
and their sample mean are added to the bottom histogram.
</p>
</li>
<li><p> There is a button to switch the bottom plot from displaying
a histogram of the simulated means and the limiting normal p.d.f. to
the empirical c.d.f. of the simulated data and the limiting normal
c.d.f.
</p>
</li>
<li><p> There is a checkbox to add to the bottom plot the approximate
(large <code>n</code>) normal p.d.f./c.d.f. (with mean <code class="reqn">\mu</code> and
standard deviation <code class="reqn">\sigma / \sqrt{n}</code>), implied by the CLT.
</p>
</li></ul>



<h3>Value</h3>

<p>Nothing is returned, only the animation is produced.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+movies">movies</a></code>: a user-friendly menu panel.
</p>
<p><code><a href="#topic+smovie">smovie</a></code>: general information about smovie.
</p>
<p><code><a href="#topic+cltq">cltq</a></code>: Central Limit Theorem for sample quantiles.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Exponential data
clt()

# Uniform data
clt(distn = "uniform")

# Poisson data
clt(distn = "poisson")
</code></pre>

<hr>
<h2 id='cltq'>Central Limit Theorem (CLT) for sample quantiles</h2><span id='topic+cltq'></span>

<h3>Description</h3>

<p>A movie to illustrate the ideas of the sampling distribution of the
sample 100<code class="reqn">p</code>% quantile and the central limit theorem for sample
quantiles.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cltq(
  n = 20,
  p = 0.5,
  distn,
  params = list(),
  type = 7,
  panel_plot = TRUE,
  hscale = NA,
  vscale = hscale,
  n_add = 1,
  delta_n = 1,
  arrow = TRUE,
  leg_cex = 1.25,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cltq_+3A_n">n</code></td>
<td>
<p>An integer scalar.  The size of the samples drawn from the
distribution chosen using <code>distn</code>.</p>
</td></tr>
<tr><td><code id="cltq_+3A_p">p</code></td>
<td>
<p>A numeric scalar in (0, 1).  The value of <code class="reqn">p</code>.</p>
</td></tr>
<tr><td><code id="cltq_+3A_distn">distn</code></td>
<td>
<p>A character scalar specifying the (continuous) distribution
from which observations are sampled.   Distributions <code>"beta"</code>,
<code>"chisq"</code>, <code>"chi-squared"</code>,
<code>"exponential"</code>, <code>"f"</code>, <code>"gamma"</code>,
<code>"gev"</code>, <code>"gp"</code>, <code>"lognormal"</code>,
<code>"log-normal"</code>, <code>"normal"</code>,
<code>"t"</code>, <code>"uniform"</code> and <code>"weibull"</code> are
recognised, case being ignored.
</p>
<p>If <code>distn</code> is not supplied then <code>distn = "exponential"</code>
is used.
</p>
<p>The <code>"gev"</code> and <code>"gp"</code> cases use the
<code><a href="revdbayes.html#topic+gev">gev</a></code> and <code><a href="revdbayes.html#topic+gp">gp</a></code>
distributional functions in the
<code><a href="revdbayes.html#topic+revdbayes">revdbayes</a></code> package.
</p>
<p>The other cases use the distributional functions in the
<code><a href="stats.html#topic+stats-package">stats-package</a></code>.
If <code>distn = "gamma"</code> then the <code>(shape, rate)</code>
parameterisation is used.  If <code>scale</code> is supplied via <code>params</code>
then <code>rate</code> is inferred from this.
If <code>distn = "beta"</code> then <code>ncp</code> is forced to be zero.</p>
</td></tr>
<tr><td><code id="cltq_+3A_params">params</code></td>
<td>
<p>A named list of additional arguments to be passed to the
density function associated with distribution <code>distn</code>.
The <code>(shape, rate)</code> parameterisation is used for the gamma
distribution (see <code><a href="stats.html#topic+GammaDist">GammaDist</a></code>) even if the value of
the <code>scale</code> parameter is set using <code>params</code>.
</p>
<p>If a parameter value is not supplied then the default values in the
relevant distributional function set using <code>distn</code> are used,
except for
<code>"beta"</code> (<code>shape1 = 2, shape2 = 2</code>),
<code>"chisq"</code> (<code>df = 4</code>),
<code>"f"</code> (<code>df1 = 4, df2 = 8</code>),
<code>"gev"</code> (<code>shape = 0.2</code>).
<code>"gamma"</code> (<code>shape = 2</code>,
<code>"gp"</code> (<code>shape = 0.1</code>),
<code>"t"</code> (<code>df = 4</code>) and
<code>"weibull"</code> (<code>shape = 2</code>).</p>
</td></tr>
<tr><td><code id="cltq_+3A_type">type</code></td>
<td>
<p>An integer between 1 and 9. The value of the argument
<code>type</code> to be passed to <code><a href="stats.html#topic+quantile">quantile</a></code> to when
calculating a sample quantile.</p>
</td></tr>
<tr><td><code id="cltq_+3A_panel_plot">panel_plot</code></td>
<td>
<p>A logical parameter that determines whether the plot
is placed inside the panel (<code>TRUE</code>) or in the standard graphics
window (<code>FALSE</code>).  If the plot is to be placed inside the panel
then the tkrplot library is required.</p>
</td></tr>
<tr><td><code id="cltq_+3A_hscale">hscale</code>, <code id="cltq_+3A_vscale">vscale</code></td>
<td>
<p>Numeric scalars.  Scaling parameters for the size
of the plot when <code>panel_plot = TRUE</code>. The default values are 1.4 on
Unix platforms and 2 on Windows platforms.</p>
</td></tr>
<tr><td><code id="cltq_+3A_n_add">n_add</code></td>
<td>
<p>An integer scalar.  The number of simulated datasets to add
to each new frame of the movie.</p>
</td></tr>
<tr><td><code id="cltq_+3A_delta_n">delta_n</code></td>
<td>
<p>A numeric scalar.  The amount by which n is increased
(or decreased) after one click of the + (or -) button in the parameter
window.</p>
</td></tr>
<tr><td><code id="cltq_+3A_arrow">arrow</code></td>
<td>
<p>A logical scalar.  Should an arrow be included to show the
simulated sample quantile from the top plot being placed into the
bottom plot?</p>
</td></tr>
<tr><td><code id="cltq_+3A_leg_cex">leg_cex</code></td>
<td>
<p>The argument <code>cex</code> to <code><a href="graphics.html#topic+legend">legend</a></code>.
Allows the size of the legend to be controlled manually.</p>
</td></tr>
<tr><td><code id="cltq_+3A_...">...</code></td>
<td>
<p>Additional arguments to the rpanel functions
<code><a href="rpanel.html#topic+rp.button">rp.button</a></code> and
<code><a href="rpanel.html#topic+rp.doublebutton">rp.doublebutton</a></code>, not including <code>panel</code>,
<code>variable</code>, <code>title</code>, <code>step</code>, <code>action</code>, <code>initval</code>,
<code>range</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Loosely speaking, a consequence of the CLT for sample quantiles
is that the 100<code class="reqn">p</code>% sample quantile of a <strong>large number</strong> of
identically distributed random variables, each with probability density
function <code class="reqn">f</code> and 100<code class="reqn">p</code>% quantile <code class="reqn">\xi(p)</code>, has
<strong>approximately</strong> a normal distribution.  See, for example,
Lehmann (1999) for a precise statement and conditions.
</p>
<p>This movie considers examples where this limiting result holds and
illustrates graphically the closeness of the limiting approximation
provided by the relevant normal limit to the true finite-<code class="reqn">n</code>
distribution.
</p>
<p>Samples of size <code>n</code> are repeatedly simulated from the distribution
chosen using <code>distn</code>.  These samples are summarized using a plot
that appears at the top of the movie screen.  For each sample the
100<code class="reqn">p</code>% sample quantile of these <code>n</code> values is calculated,
stored and added to another plot, situated below the first plot.
This plot is either a histogram or an empirical c.d.f., chosen using a
radio button.
A <code><a href="graphics.html#topic+rug">rug</a></code> is added to a histogram provided that it
contains no more than 1000 points.
</p>
<p>The p.d.f. of the original variables is added to the top plot.
</p>
<p>Once it starts, four aspects of this movie are controlled by the user.
</p>

<ul>
<li><p> There are buttons to increase (+) or decrease (-) the sample
size, that is, the number of values for which a sample quantile is
calculated.
</p>
</li>
<li><p> Each time the button labelled &quot;simulate another <code>n_add</code>
samples of size n&quot; is clicked <code>n_add</code> new samples are simulated
and their sample quantile are added to the bottom histogram.
</p>
</li>
<li><p> There is a button to switch the bottom plot from displaying
a histogram of the simulated sample quantiles and the limiting normal
p.d.f. to the empirical c.d.f. of the simulated data and the limiting
normal c.d.f.
</p>
</li>
<li><p> There is a checkbox to add to the bottom plot the approximate
(large <code class="reqn">n</code>) normal p.d.f./c.d.f. implied by the CLT for sample
quantiles: the mean is equal to <code class="reqn">\xi(p)</code> and standard deviation is
equal to <code class="reqn">\sqrt p \sqrt q  / n f(\xi(p))</code>, where <code class="reqn">q = 1-p</code>.
</p>
</li></ul>



<h3>Value</h3>

<p>Nothing is returned, only the animation is produced.
</p>


<h3>References</h3>

<p>Lehman, E. L. (1999) <em>Elements of Large-Sample Theory</em>,
Springer-Verlag, London. <a href="https://doi.org/10.1007/b98855">doi:10.1007/b98855</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+movies">movies</a></code>: a user-friendly menu panel.
</p>
<p><code><a href="#topic+smovie">smovie</a></code>: general information about smovie.
</p>
<p><code><a href="#topic+clt">clt</a></code>: Central Limit Theorem.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Exponential data
cltq()

# Uniform data
cltq(distn = "t", params = list(df = 2))
</code></pre>

<hr>
<h2 id='continuous'>Univariate Continuous Distributions: p.d.f and c.d.f.</h2><span id='topic+continuous'></span>

<h3>Description</h3>

<p>A movie to illustrate how the probability density function (p.d.f.) and
cumulative distribution function (c.d.f.) of a continuous random variable
depend on the values of its parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>continuous(
  distn,
  var_range = NULL,
  params = list(),
  param_step = list(),
  param_range = list(),
  p_vec = NULL,
  smallest = 0.01,
  plot_par = list(),
  panel_plot = TRUE,
  hscale = NA,
  vscale = hscale,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="continuous_+3A_distn">distn</code></td>
<td>
<p>Either a character string or a function to choose the
continuous random variable.
</p>
<p>Strings <code>"beta"</code>, <code>"cauchy"</code>, <code>"chisq"</code>
<code>"chi-squared"</code>, <code>"exponential"</code>, <code>"f"</code>, <code>"gamma"</code>,
<code>"gev"</code>, <code>"gp"</code>, <code>"lognormal"</code>, <code>"log-normal"</code>,
<code>"normal"</code>, <code>"t"</code>, <code>"uniform"</code> and <code>"weibull"</code> are
recognised, case being ignored.  The relevant distributional functions
<code>dxxx</code> and <code>pxxx</code> in the <code><a href="stats.html#topic+stats-package">stats-package</a></code>
are used.  The abbreviations <code>xxx</code> are also recognised.
The <code>"gev"</code> and <code>"gp"</code> cases use the
<code><a href="revdbayes.html#topic+gev">gev</a></code> and <code><a href="revdbayes.html#topic+gp">gp</a></code>
distributional functions in the <code><a href="revdbayes.html#topic+revdbayes">revdbayes</a></code>
package.
If <code>distn = "gamma"</code> then the <code>(shape, rate)</code>
parameterisation is used, unless a value for <code>scale</code> is provided
via the argument <code>params</code> when the <code>(shape, scale)</code>
parameterisation is used.
</p>
<p>Valid functions are set up like a standard distributional function
<code>dxxx</code>, with first argument <code>x</code>, last argument <code>log</code>
and with arguments to set the parameters of the distribution in between.
See the <a href="https://CRAN.R-project.org/view=Distributions">
CRAN task view on distributions</a>.
</p>
<p>If <code>distn</code> is not supplied then <code>distn = "normal"</code>
is used.</p>
</td></tr>
<tr><td><code id="continuous_+3A_var_range">var_range</code></td>
<td>
<p>A numeric vector of length 2.  Can be used to set a fixed
range of values over which to plot the p.d.f. and c.d.f., in order better
to see the effects of changing the parameter values.
If <code>var_range</code> is set then it overrides <code>p_vec</code> (see below).</p>
</td></tr>
<tr><td><code id="continuous_+3A_params">params</code></td>
<td>
<p>A named list of initial parameter values with which to start
the movie.  If <code>distn</code> is a string and a particular parameter value
is not supplied then the following values are used.
<code>"beta"</code>: <code>shape1 = 2, shape2 = 2, ncp = 0</code>;
<code>"cauchy"</code>: <code>location = 0, scale = 1</code>;
<code>"chi-squared"</code>: <code>df = 4, ncp = 0</code>;
<code>"exponential"</code>: <code>rate = 1</code>;
<code>"f"</code>: <code>df1 = 4, df2 = 8, ncp =0</code>;
<code>"gamma"</code>: <code>shape = 2, rate = 1</code>;
<code>"gev"</code>: <code>loc = 0, scale = 1, shape = 0.1</code>;
<code>"gp"</code>: <code>loc = 0, scale = 1, shape = 0.1</code>;
<code>"lognormal"</code>: <code>meanlog = 0, sdlog = 1</code>;
<code>"normal"</code>: <code>mean = 0, sd = 1</code>;
<code>"t"</code>: <code>df = 4, ncp = 0</code>;
<code>"uniform"</code>: <code>min = 0, max = 1</code>;
<code>"weibull"</code>: <code>shape = 2, scale = 1</code>.
</p>
<p>If <code>distn</code> is a function then <code>params</code> must set any required
parameters.
</p>
<p>If parameter value is outside the corresponding range specified by
<code>param_range</code> then it is set to the closest limit of the range.</p>
</td></tr>
<tr><td><code id="continuous_+3A_param_step">param_step</code></td>
<td>
<p>A named list of the amounts by which the respective
parameters in <code>params</code> are increased/decreased after one click of
the +/- button. If <code>distn</code> is a function then the default is 0.1
for all parameters.  If <code>distn</code> is a string then a sensible
distribution-specific default is set internally.</p>
</td></tr>
<tr><td><code id="continuous_+3A_param_range">param_range</code></td>
<td>
<p>A named list of the ranges over which the respective
parameters in <code>params</code> are allowed to vary.  Each element of the list
should be a vector of length 2: the first element gives the lower limit
of the range, the second element the upper limit.
Use <code>NA</code> to impose no limit.
If <code>distn</code> is a function then all parameters are unconstrained.</p>
</td></tr>
<tr><td><code id="continuous_+3A_p_vec">p_vec</code></td>
<td>
<p>A numeric vector of length 2.  The p.d.f. and c.d.f. are
plotted between the 100<code>p_vec[1]</code>% and 100<code>p_vec[2]</code>%
quantiles of the distribution.  If <code>p_vec</code> is not supplied then
a sensible distribution-specific default is used.  If <code>distn</code> is
a function then the default is <code>p_vec = c(0.001, 0.999)</code>.</p>
</td></tr>
<tr><td><code id="continuous_+3A_smallest">smallest</code></td>
<td>
<p>A positive numeric scalar.  The smallest value to be
used for any strictly positive parameters when <code>distn</code> is a string.</p>
</td></tr>
<tr><td><code id="continuous_+3A_plot_par">plot_par</code></td>
<td>
<p>A named list of graphical parameters
(see <code><a href="graphics.html#topic+par">par</a></code>) to be passed to
<code><a href="graphics.html#topic+plot.default">plot</a></code>.  This may be used to alter the
appearance of the plots of the p.m.f. and c.d.f.</p>
</td></tr>
<tr><td><code id="continuous_+3A_panel_plot">panel_plot</code></td>
<td>
<p>A logical parameter that determines whether the plot
is placed inside the panel (<code>TRUE</code>) or in the standard graphics
window (<code>FALSE</code>).  If the plot is to be placed inside the panel
then the tkrplot library is required.</p>
</td></tr>
<tr><td><code id="continuous_+3A_hscale">hscale</code>, <code id="continuous_+3A_vscale">vscale</code></td>
<td>
<p>Numeric scalars.  Scaling parameters for the size
of the plot when <code>panel_plot = TRUE</code>. The default values are 1.4 on
Unix platforms and 2 on Windows platforms.</p>
</td></tr>
<tr><td><code id="continuous_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to
<code><a href="rpanel.html#topic+rp.doublebutton">rp.doublebutton</a></code>, not including <code>panel</code>,
<code>variable</code>, <code>title</code>, <code>step</code>, <code>action</code>, <code>initval</code>,
<code>range</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The movie starts with a plot of the p.d.f. of the distribution
for the initial values of the parameters.  Buttons
increase (+) or decrease (-) each parameter.  There are radio buttons
to switch the plot from the p.d.f. to the c.d.f. and back.
</p>


<h3>Value</h3>

<p>Nothing is returned, only the animation is produced.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+movies">movies</a></code>: a user-friendly menu panel.
</p>
<p><code><a href="#topic+smovie">smovie</a></code>: general information about smovie.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Normal example
continuous()
# Fix the range of values over which to plot
continuous(var_range = c(-10, 10))

# The same example, but using a user-supplied function and setting manually
# the initial parameters, parameter step size and range
continuous(distn = dnorm, params = list(mean = 0, sd = 1),
           param_step = list(mean = 1, sd = 1),
           param_range = list(sd = c(0, NA)))

# Gamma distribution. Show the use of var_range
continuous(distn = "gamma", var_range = c(0, 15))
</code></pre>

<hr>
<h2 id='correlation'>Sampling distribution of the correlation coefficient movie</h2><span id='topic+correlation'></span>

<h3>Description</h3>

<p>A movie to illustrate how the sampling distribution of the product moment
sample correlation coefficient <code class="reqn">r</code> depends on the sample size <code class="reqn">n</code>
and on the true correlation <code class="reqn">\rho</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>correlation(
  n = 30,
  rho = 0,
  panel_plot = TRUE,
  hscale = NA,
  vscale = hscale,
  delta_n = 1,
  delta_rho = 0.1,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="correlation_+3A_n">n</code></td>
<td>
<p>An integer scalar.  The initial value of the sample size.
Must not be less than 2.</p>
</td></tr>
<tr><td><code id="correlation_+3A_rho">rho</code></td>
<td>
<p>A numeric scalar.  The initial value of the true correlation
<code class="reqn">\rho</code>.  Must be in [-1, 1].</p>
</td></tr>
<tr><td><code id="correlation_+3A_panel_plot">panel_plot</code></td>
<td>
<p>A logical parameter that determines whether the plot
is placed inside the panel (<code>TRUE</code>) or in the standard graphics
window (<code>FALSE</code>).  If the plot is to be placed inside the panel
then the tkrplot library is required.</p>
</td></tr>
<tr><td><code id="correlation_+3A_hscale">hscale</code>, <code id="correlation_+3A_vscale">vscale</code></td>
<td>
<p>Numeric scalars.  Scaling parameters for the size
of the plot when <code>panel_plot = TRUE</code>. The default values are 1.4 on
Unix platforms and 2 on Windows platforms.</p>
</td></tr>
<tr><td><code id="correlation_+3A_delta_n">delta_n</code></td>
<td>
<p>An integer scalar.  The amount by which the value of the
sample size is increased/decreased after one click of the +/- button.</p>
</td></tr>
<tr><td><code id="correlation_+3A_delta_rho">delta_rho</code></td>
<td>
<p>A numeric scalar.  The amount by which the value of
rho is increased/decreased after one click of the +/- button.</p>
</td></tr>
<tr><td><code id="correlation_+3A_...">...</code></td>
<td>
<p>Additional arguments to the rpanel functions
<code><a href="rpanel.html#topic+rp.button">rp.button</a></code> and
<code><a href="rpanel.html#topic+rp.doublebutton">rp.doublebutton</a></code>, not including <code>panel</code>,
<code>variable</code>, <code>title</code>, <code>step</code>, <code>action</code>, <code>initval</code>,
<code>range</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Random samples of size <code class="reqn">n</code> are simulated from a
<a href="https://en.wikipedia.org/wiki/Multivariate_normal_distribution">bivariate normal distribution</a>
in which each of the variables has a mean of 0 and a variance of 1 and
the correlation <code class="reqn">\rho</code> between the variables is chosen by the user.
</p>
<p>The movie contains two plots.  On the top is a scatter plot of the
simulated sample, illustrating the strength of the association between
the simulated values of the variables.
A new sample is produced by clicking &quot;simulate another sample.
For each simulated sample the sample (product moment) correlation
coefficient <code class="reqn">r</code> is calculated and displayed in the title of the top
plot.
</p>
<p>The values of the sample correlation coefficients are stored and are
plotted in a histogram in the bottom plot.  A rug displays the individual
values, with the most recent value coloured red. As we accumulate a large
number of values in this histogram the shape of the sampling
distribution of <code class="reqn">r</code> emerges.  The exact p.d.f. of <code class="reqn">r</code> is
superimposed on this histogram, as is the value of <code class="reqn">\rho</code>.
</p>
<p>The bottom plot can be changed in two ways:
(i) a radio button can be pressed to replace the histogram and pdf with
a plot of the empirical c.d.f. and exact cdf;
(ii) the variable can be changed from <code class="reqn">\rho</code> to Fisher's
z-transformation <code class="reqn">F(\rho) = arctanh(\rho) = [ln(1+\rho) - ln(1-\rho)]/2</code>.
For sufficiently large values of <code class="reqn">n</code>, <code class="reqn">F(\rho)</code> has approximately
a normal distribution with mean <code class="reqn">\rho</code> and variance
<code class="reqn">1 / (n - 3)</code>.
</p>
<p>The values of the sample size <code class="reqn">n</code> or true correlation coefficient
<code class="reqn">\rho</code> can be changed using the respective +/- buttons.
If one of these is changed then the bottom plot is
reset using the sample correlation coefficient of the first sample
simulated using the new combination of <code class="reqn">n</code> and <code class="reqn">\rho</code>.
</p>


<h3>Value</h3>

<p>Nothing is returned, only the animation is produced.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+movies">movies</a></code>: a user-friendly menu panel.
</p>
<p><code><a href="#topic+smovie">smovie</a></code>: general information about smovie.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>correlation(rho = 0.8)
correlation(n = 10)
</code></pre>

<hr>
<h2 id='discrete'>Univariate Discrete Distributions: p.m.f and c.d.f.</h2><span id='topic+discrete'></span>

<h3>Description</h3>

<p>A movie to illustrate how the probability mass function (p.m.f.) and
cumulative distribution function (c.d.f.) of a discrete random variable
depend on the values of its parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>discrete(
  distn,
  var_support = NULL,
  params = list(),
  param_step = list(),
  param_range = list(),
  p_vec = NULL,
  smallest = 0.01,
  plot_par = list(),
  panel_plot = TRUE,
  hscale = NA,
  vscale = hscale,
  observed_value = NA,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="discrete_+3A_distn">distn</code></td>
<td>
<p>Either a character string or a function to choose the discrete
random variable.
</p>
<p>Strings <code>"binomial"</code>, <code>"geometric"</code>,
<code>"hypergeometric"</code>, <code>"negative binomial"</code> and <code>"poisson"</code>
are recognised, case being ignored.  The relevant distributional functions
<code>dxxx</code> and <code>pxxx</code> in the <code><a href="stats.html#topic+stats-package">stats-package</a></code>
are used.  The abbreviations <code>xxx</code> are also recognised.
If <code>distn = "negative binomial"</code> then the <code>(size, prob)</code>
parameterisation is used, unless a value for <code>mu</code> is provided
via the argument <code>params</code> when the <code>(size, mu)</code>
parameterisation is used.
</p>
<p>Valid functions are set up like a standard distributional function
<code>dxxx</code>, with first argument <code>x</code>, last argument <code>log</code>
and with arguments to set the parameters of the distribution in between.
See the <a href="https://CRAN.R-project.org/view=Distributions">
CRAN task view on distributions</a>.
It is assumed that the support of the random variable is a
subset of the integers, unless <code>var_support</code> is set to the contrary.
</p>
<p>If <code>distn</code> is not supplied then <code>distn = "binomial"</code>
is used.</p>
</td></tr>
<tr><td><code id="discrete_+3A_var_support">var_support</code></td>
<td>
<p>A numeric vector.  Can be used to set a fixed set of
values for which to plot the p.m.f. and c.d.f., in order better
to see the effects of changing the parameter values or to set a support
that isn't a subset of the integers.
If <code>var_support</code> is set then it overrides <code>p_vec</code> (see below).</p>
</td></tr>
<tr><td><code id="discrete_+3A_params">params</code></td>
<td>
<p>A named list of initial parameter values with which to start
the movie.  If <code>distn</code> is a string and a particular parameter value
is not supplied then the following values are used.
<code>"binomial"</code>: <code>size = 10, prob = 0.5</code>;
<code>"geometric"</code>: <code>prob = 0.5</code>;
<code>"hypergeometric"</code>: <code>m = 10, n = 7, k = 8</code>;
<code>"negative binomial"</code>: <code>size = 10, prob = 0.5</code>;
<code>"poisson"</code>: <code>lambda = 5</code>.
</p>
<p>If <code>distn</code> is a function then <code>params</code> must set any required
parameters.
</p>
<p>If parameter value is outside the corresponding range specified by
<code>param_range</code> then it is set to the closest limit of the range.</p>
</td></tr>
<tr><td><code id="discrete_+3A_param_step">param_step</code></td>
<td>
<p>A named list of the amounts by which the respective
parameters in <code>params</code> are increased/decreased after one click of
the +/- button. If <code>distn</code> is a function then the default is 0.1
for all parameters.  If <code>distn</code> is a string then a sensible
distribution-specific default is set internally.</p>
</td></tr>
<tr><td><code id="discrete_+3A_param_range">param_range</code></td>
<td>
<p>A named list of the ranges over which the respective
parameters in <code>params</code> are allowed to vary.  Each element of the list
should be a vector of length 2: the first element gives the lower limit
of the range, the second element the upper limit.
Use <code>NA</code> to impose no limit.
If <code>distn</code> is a function then all parameters are unconstrained.</p>
</td></tr>
<tr><td><code id="discrete_+3A_p_vec">p_vec</code></td>
<td>
<p>A numeric vector of length 2.  The p.d.f. and c.d.f. are
plotted between the 100<code>p_vec[1]</code>% and 100<code>p_vec[2]</code>%
quantiles of the distribution.  If <code>p_vec</code> is not supplied then
a sensible distribution-specific default is used.  If <code>distn</code> is
a function then the default is <code>p_vec = c(0.001, 0.999)</code>.</p>
</td></tr>
<tr><td><code id="discrete_+3A_smallest">smallest</code></td>
<td>
<p>A positive numeric scalar.  The smallest value to be
used for any strictly positive parameters when <code>distn</code> is a string.</p>
</td></tr>
<tr><td><code id="discrete_+3A_plot_par">plot_par</code></td>
<td>
<p>A named list of graphical parameters
(see <code><a href="graphics.html#topic+par">par</a></code>) to be passed to
<code><a href="graphics.html#topic+plot.default">plot</a></code>.  This may be used to alter the
appearance of the plots of the p.m.f. and c.d.f.</p>
</td></tr>
<tr><td><code id="discrete_+3A_panel_plot">panel_plot</code></td>
<td>
<p>A logical parameter that determines whether the plot
is placed inside the panel (<code>TRUE</code>) or in the standard graphics
window (<code>FALSE</code>).  If the plot is to be placed inside the panel
then the tkrplot library is required.</p>
</td></tr>
<tr><td><code id="discrete_+3A_hscale">hscale</code>, <code id="discrete_+3A_vscale">vscale</code></td>
<td>
<p>Numeric scalars.  Scaling parameters for the size
of the plot when <code>panel_plot = TRUE</code>. The default values are 1.4 on
Unix platforms and 2 on Windows platforms.</p>
</td></tr>
<tr><td><code id="discrete_+3A_observed_value">observed_value</code></td>
<td>
<p>A non-negative integer.  If <code>observed_value</code> is
supplied then the corresponding line in the plot of the p.m.f. is coloured
in red.</p>
</td></tr>
<tr><td><code id="discrete_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to
<code><a href="rpanel.html#topic+rp.doublebutton">rp.doublebutton</a></code>, not including <code>panel</code>,
<code>variable</code>, <code>title</code>, <code>step</code>, <code>action</code>, <code>initval</code>,
<code>range</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The movie starts with a plot of the p.m.f. of the distribution
for the initial values of the parameters.  Buttons
increase (+) or decrease (-) each parameter.  There are radio buttons
to switch the plot from the p.m.f. to the c.d.f. and back.
</p>
<p>If <code>distn == "geometric"</code> then there are radio buttons to switch
between the version of the the geometric distribution based on the
number of trials up to including the first success and the number of
failures until the first success.
</p>
<p>Owing to a conflict with the argument <code>size</code> of the function
<code><a href="rpanel.html#topic+rp.control">rp.control</a></code> the parameter <code>size</code> of,
for example, the binomial and negative binomial distributions, is
labelled as <code>n</code>.
</p>


<h3>Value</h3>

<p>Nothing is returned, only the animation is produced.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+movies">movies</a></code>: a user-friendly menu panel.
</p>
<p><code><a href="#topic+smovie">smovie</a></code>: general information about smovie.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Binomial example
discrete()

# The same example, but using a user-supplied function and setting manually
# the initial parameters, parameter step size and range
discrete(distn = dbinom, params = list(size = 10, prob = 0.5),
         param_step = list(size = 1),
         param_range = list(size = c(1, NA), prob = c(0, 1)))

# Poisson distribution. Show the use of var_support
discrete(distn = "poisson", var_support = 0:20)
</code></pre>

<hr>
<h2 id='ett'>Extremal Types Theorem (ETT)</h2><span id='topic+ett'></span>

<h3>Description</h3>

<p>A movie to illustrate the extremal types theorem, that is, convergence
of the distribution of the maximum of a random sample of size <code class="reqn">n</code>
from certain distributions to a member of the Generalized Extreme Value
(GEV) family, as <code class="reqn">n</code> tends to infinity.
Samples of size <code class="reqn">n</code> are simulated repeatedly from the chosen
distribution.  The distributions (simulated empirical and true) of the
sample maxima are compared to the relevant GEV limit.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ett(
  n = 20,
  distn,
  params = list(),
  panel_plot = TRUE,
  hscale = NA,
  vscale = hscale,
  n_add = 1,
  delta_n = 1,
  arrow = TRUE,
  leg_cex = 1.25,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ett_+3A_n">n</code></td>
<td>
<p>An integer scalar.  The size of the samples drawn from the
distribution chosen using <code>distn</code>.  <code>n</code> must be no smaller
than 2.</p>
</td></tr>
<tr><td><code id="ett_+3A_distn">distn</code></td>
<td>
<p>A character scalar specifying the distribution from which
observations are sampled.   Distributions <code>"beta"</code>,
<code>"cauchy"</code>, <code>"chisq"</code>, <code>"chi-squared"</code>,
<code>"exponential"</code>, <code>"f"</code>, <code>"gamma"</code>, <code>"gp"</code>,
<code>"lognormal"</code>, <code>"log-normal"</code>,  <code>"ngev"</code>, <code>"normal"</code>,
<code>"t"</code>, <code>"uniform"</code> and <code>"weibull"</code> are recognised, case
being ignored.
</p>
<p>If <code>distn</code> is not supplied then <code>distn = "exponential"</code>
is used.
</p>
<p>The <code>"gp"</code> case uses the <code><a href="revdbayes.html#topic+gp">gp</a></code>
distributional functions in the
<code><a href="revdbayes.html#topic+revdbayes">revdbayes</a></code> package.
</p>
<p>The <code>"ngev"</code> case is a negated GEV(1 / <code class="reqn">\xi</code>, 1, <code class="reqn">\xi</code>)
distribution, for <code class="reqn">\xi</code> &gt; 0, and uses the <code><a href="revdbayes.html#topic+gev">gev</a></code>
distributional functions in the
<code><a href="revdbayes.html#topic+revdbayes">revdbayes</a></code> package.
If <code class="reqn">\xi</code> = 1 then this coincides with Example 1.7.5 in Leadbetter,
Lindgren and Rootzen (1983).
</p>
<p>The other cases use the distributional functions in the
<code><a href="stats.html#topic+stats-package">stats-package</a></code>.
If <code>distn = "gamma"</code> then the <code>(shape, rate)</code>
parameterisation is used.  If <code>scale</code> is supplied via <code>params</code>
then <code>rate</code> is inferred from this.
If <code>distn = "beta"</code> then <code>ncp</code> is forced to be zero.</p>
</td></tr>
<tr><td><code id="ett_+3A_params">params</code></td>
<td>
<p>A named list of additional arguments to be passed to the
density function associated with distribution <code>distn</code>.
The <code>(shape, rate)</code> parameterisation is used for the gamma
distribution (see <code><a href="stats.html#topic+GammaDist">GammaDist</a></code>) even if the value of
the <code>scale</code> parameter is set using <code>params</code>.
</p>
<p>If a parameter value is not supplied then the default values in the
relevant distributional function set using <code>distn</code> are used,
except for
<code>"beta"</code> (<code>shape1 = 2, shape2 = 2</code>),
<code>"chisq"</code> (<code>df = 4</code>),
<code>"f"</code> (<code>df1 = 4, df2 = 8</code>),
<code>"ngev"</code> (<code>shape = 0.2</code>).
<code>"gamma"</code> (<code>shape = 2</code>,
<code>"gp"</code> (<code>shape = 0.1</code>),
<code>"t"</code> (<code>df = 4</code>) and
<code>"weibull"</code> (<code>shape = 2</code>).</p>
</td></tr>
<tr><td><code id="ett_+3A_panel_plot">panel_plot</code></td>
<td>
<p>A logical parameter that determines whether the plot
is placed inside the panel (<code>TRUE</code>) or in the standard graphics
window (<code>FALSE</code>).  If the plot is to be placed inside the panel
then the tkrplot library is required.</p>
</td></tr>
<tr><td><code id="ett_+3A_hscale">hscale</code>, <code id="ett_+3A_vscale">vscale</code></td>
<td>
<p>Numeric scalars.  Scaling parameters for the size
of the plot when <code>panel_plot = TRUE</code>. The default values are 1.4 on
Unix platforms and 2 on Windows platforms.</p>
</td></tr>
<tr><td><code id="ett_+3A_n_add">n_add</code></td>
<td>
<p>An integer scalar.  The number of simulated datasets to add
to each new frame of the movie.</p>
</td></tr>
<tr><td><code id="ett_+3A_delta_n">delta_n</code></td>
<td>
<p>A numeric scalar.  The amount by which n is increased
(or decreased) after one click of the + (or -) button in the parameter
window.</p>
</td></tr>
<tr><td><code id="ett_+3A_arrow">arrow</code></td>
<td>
<p>A logical scalar.  Should an arrow be included to show the
simulated sample maximum from the top plot being placed into the
bottom plot?</p>
</td></tr>
<tr><td><code id="ett_+3A_leg_cex">leg_cex</code></td>
<td>
<p>The argument <code>cex</code> to <code><a href="graphics.html#topic+legend">legend</a></code>.
Allows the size of the legend to be controlled manually.</p>
</td></tr>
<tr><td><code id="ett_+3A_...">...</code></td>
<td>
<p>Additional arguments to the rpanel functions
<code><a href="rpanel.html#topic+rp.button">rp.button</a></code> and
<code><a href="rpanel.html#topic+rp.doublebutton">rp.doublebutton</a></code>, not including <code>panel</code>,
<code>variable</code>, <code>title</code>, <code>step</code>, <code>action</code>, <code>initval</code>,
<code>range</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Loosely speaking, a consequence of the
<a href="https://en.wikipedia.org/wiki/Extreme_value_theory#Univariate_theory">Extremal Types Theorem</a>
is that, in many situations, the maximum of a <em>large number</em>
<code class="reqn">n</code> of independent random variables has <em>approximately</em> a
GEV(<code class="reqn">\mu, \sigma, \xi)</code>) distribution, where <code class="reqn">\mu</code> is a location
parameter, <code class="reqn">\sigma</code> is a scale parameter and <code class="reqn">\xi</code> is a shape
parameter.  See Coles (2001) for an introductory account and
Leadbetter et al (1983) for greater detail and more examples.
The Extremal Types Theorem is an asymptotic result that considers the
possible limiting distribution of linearly normalised maxima
as <code class="reqn">n</code> tends to infinity.
This movie considers examples where this limiting result holds and
illustrates graphically the closeness of the limiting approximation
provided by the relevant GEV limit to the true finite-<code class="reqn">n</code>
distribution.
</p>
<p>Samples of size <code>n</code> are repeatedly simulated from the distribution
chosen using <code>distn</code>.  These samples are summarized using a histogram
that appears at the top of the movie screen.  For each sample the maximum
of these <code>n</code> values is calculated, stored and added to another plot,
situated below the first plot.
A <code><a href="graphics.html#topic+rug">rug</a></code> is added to a histogram provided that it
contains no more than 1000 points.
This plot is either a histogram or an empirical c.d.f., chosen using a
radio button.
</p>
<p>The probability density function (p.d.f.) of the original
variables is superimposed on the top histogram.
There is a checkbox to add to the bottom plot the exact p.d.f./c.d.f. of
the sample maxima and an approximate (large <code>n</code>) GEV p.d.f./c.d.f.
implied by the ETT.
The GEV shape parameter <code class="reqn">\xi</code> that applies in the limiting
case is used.  The GEV location <code class="reqn">\mu</code> and scale
<code class="reqn">\sigma</code> are set based on constants used to normalise the maxima
to achieve the GEV limit.
Specifically, <code class="reqn">\mu</code> is set at the 100(1-1/<code class="reqn">n</code>)% quantile of the
distribution <code>distn</code> and <code class="reqn">\sigma</code> at
(1 / <code class="reqn">n</code>) / <code class="reqn">f(\mu)</code>, where <code class="reqn">f</code> is the
density function of the distribution <code>distn</code>.
</p>
<p>Once it starts, four aspects of this movie are controlled by the user.
</p>

<ul>
<li><p> There are buttons to increase (+) or decrease (-) the sample
size, that is, the number of values over which a maximum is
calculated.
</p>
</li>
<li><p> Each time the button labelled &quot;simulate another <code>n_add</code>
samples of size n&quot; is clicked <code>n_add</code> new samples are simulated
and their sample maxima are added to the bottom histogram.
</p>
</li>
<li><p> There is a button to switch the bottom plot from displaying
a histogram of the simulated maxima, the exact p.d.f. and the
limiting GEV p.d.f. to the empirical c.d.f. of the simulated data,
the exact c.d.f. and the limiting GEV c.d.f.
</p>
</li>
<li><p> There is a box that can be used to display only the bottom
plot.  This option is selected automatically if the sample size
<code class="reqn">n</code> exceeds 100000.
</p>
</li>
<li><p> There is a box that can be used to display only the bottom
plot.  This option is selected automatically if the sample size
<code class="reqn">n</code> exceeds 100000.
</p>
</li></ul>

<p>For further detail about the examples specified by <code>distn</code>
see Chapter 1 of Leadbetter et al. (1983) and Chapter 3 of
Coles (2001).  In many of these examples
(<code>"exponential"</code>, <code>"normal"</code>, <code>"gamma"</code>,
<code>"lognormal"</code>, <code>"chi-squared"</code>, <code>"weibull"</code>, <code>"ngev"</code>)
the limiting GEV distribution has a shape
parameter that is equal to 0.  In the <code>"uniform"</code> case the limiting
shape parameter is -1 and in the <code>"beta"</code> case it is
-1 / <code>shape2</code>, where <code>shape2</code> is the
second parameter of the <code><a href="stats.html#topic+Beta">Beta</a></code> distribution.
In the other cases the limiting shape parameter is positive,
with respective values <code>shape</code>
(<code>"gp"</code>, see <code><a href="revdbayes.html#topic+gp">gp</a></code>),
1 / <code>df</code> (<code>"t"</code>, see <code><a href="stats.html#topic+TDist">TDist</a></code>),
1 (<code>"cauchy"</code>, see <code><a href="stats.html#topic+Cauchy">Cauchy</a></code>),
2 / <code>df2</code> (<code>"f"</code>, see <code><a href="stats.html#topic+FDist">FDist</a></code>).
</p>


<h3>Value</h3>

<p>Nothing is returned, only the animation is produced.
</p>


<h3>References</h3>

<p>Coles, S. G. (2001) <em>An Introduction to Statistical
Modeling of Extreme Values</em>, Springer-Verlag, London.
<a href="https://doi.org/10.1007/978-1-4471-3675-0_3">doi:10.1007/978-1-4471-3675-0_3</a>
</p>
<p>Leadbetter, M., Lindgren, G. and Rootzen, H. (1983)
<em>Extremes and Related Properties of Random Sequences and Processes.</em>
Springer-Verlag, New York.
<a href="https://doi.org/10.1007/978-1-4612-5449-2">doi:10.1007/978-1-4612-5449-2</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+movies">movies</a></code>: a user-friendly menu panel.
</p>
<p><code><a href="#topic+smovie">smovie</a></code>: general information about smovie.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Exponential data: xi = 0
ett()

# Uniform data: xi =-1
ett(distn = "uniform")

# Student t data: xi = 1 / df
ett(distn = "t", params = list(df = 5))
</code></pre>

<hr>
<h2 id='Fcorr'>Fisher's transformation of the product moment correlation coefficient</h2><span id='topic+Fcorr'></span><span id='topic+dFcorr'></span><span id='topic+pFcorr'></span><span id='topic+qFcorr'></span><span id='topic+rFcorr'></span>

<h3>Description</h3>

<p>Density, distribution function, quantile function and random generator
for the distribution of Fisher's transformation of product moment
correlation, based on a random sample from a bivariate normal distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dFcorr(x, N, rho = 0, log = FALSE)

pFcorr(q, N, rho = 0, lower.tail = TRUE, log.p = FALSE)

qFcorr(p, N, rho = 0, lower.tail = TRUE, log.p = FALSE)

rFcorr(n, N, rho = 0, lower.tail = TRUE, log.p = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Fcorr_+3A_x">x</code>, <code id="Fcorr_+3A_q">q</code></td>
<td>
<p>Numeric vectors of quantiles.</p>
</td></tr>
<tr><td><code id="Fcorr_+3A_n">N</code></td>
<td>
<p>Numeric vector.  Number of observations, (N &gt; 3).</p>
</td></tr>
<tr><td><code id="Fcorr_+3A_rho">rho</code></td>
<td>
<p>Numeric vector.  Population correlations, (-1 &lt; rho &lt; 1).</p>
</td></tr>
<tr><td><code id="Fcorr_+3A_log">log</code>, <code id="Fcorr_+3A_log.p">log.p</code></td>
<td>
<p>A logical scalar; if TRUE, probabilities p are given as
log(p).</p>
</td></tr>
<tr><td><code id="Fcorr_+3A_lower.tail">lower.tail</code></td>
<td>
<p>A logical scalar.  If TRUE (default), probabilities
are P[X &lt;= x], otherwise, P[X &gt; x].</p>
</td></tr>
<tr><td><code id="Fcorr_+3A_p">p</code></td>
<td>
<p>A numeric vector of probabilities in [0,1].</p>
</td></tr>
<tr><td><code id="Fcorr_+3A_n">n</code></td>
<td>
<p>Numeric scalar.  The number of observations to be simulated.
If <code>length(n) &gt; 1</code> then <code>length(n)</code> is taken to be the number
required.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions rely on the
<code><a href="SuppDists.html#topic+Pearson">correlation coefficient</a></code>
functions in the SuppDists package.  SuppDists must be installed in order
for these functions to work.
</p>


<h3>References</h3>

<p>Fisher, R. A. (1915). Frequency distribution of the values of
the correlation coefficient in samples of an indefinitely large
population. <em>Biometrika</em>, <strong>10</strong>(4), 507-521.
</p>
<p>Fisher, R. A. (1921). On the &quot;probable error&quot; of a coefficient
of correlation deduced from a small sample. <em>Metron</em>, <strong>1</strong>,
3-32.
<a href="https://digital.library.adelaide.edu.au/dspace/bitstream/2440/15169/1/14.pdf">https://digital.library.adelaide.edu.au/dspace/bitstream/2440/15169/1/14.pdf</a>
</p>


<h3>See Also</h3>

<p><code><a href="SuppDists.html#topic+Pearson">correlation coefficient</a></code> in the
SuppDists package for dpqr functions for the untransformed product moment
correlation coefficient.
</p>
<p><code><a href="#topic+correlation">correlation</a></code>: correlation sampling distribution movie.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>got_SuppDists &lt;- requireNamespace("SuppDists", quietly = TRUE)

if (got_SuppDists) {
  dFcorr(-1:1, N = 10)
  dFcorr(0, N = 11:20)

  pFcorr(0.5, N = 10)
  pFcorr(0.5, N = 10, rho = c(0, 0.3))

  qFcorr((1:9)/10, N = 10, rho = 0.2)
  qFcorr(0.5, N = c(10, 20), rho = c(0, 0.3))

  rFcorr(6, N = 10, rho = 0.6)
}
</code></pre>

<hr>
<h2 id='lev_inf'>Leverage and influence in simple linear regression movie</h2><span id='topic+lev_inf'></span>

<h3>Description</h3>

<p>A movie to examine the influence of a single outlying observation on a
least squares regression line.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lev_inf(
  association = c("positive", "negative", "none"),
  n = 25,
  panel_plot = TRUE,
  hscale = NA,
  vscale = hscale
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lev_inf_+3A_association">association</code></td>
<td>
<p>A character scalar.  Determines the type of association
between (not-outlying) observations: &quot;positive&quot; for positive linear
association; &quot;negative&quot; negative linear association; &quot;none&quot; for no
association.</p>
</td></tr>
<tr><td><code id="lev_inf_+3A_n">n</code></td>
<td>
<p>An integer scalar.  The size of the sample of (non-outlying)
observations.</p>
</td></tr>
<tr><td><code id="lev_inf_+3A_panel_plot">panel_plot</code></td>
<td>
<p>A logical parameter that determines whether the plot
is placed inside the panel (<code>TRUE</code>) or in the standard graphics
window (<code>FALSE</code>).  If the plot is to be placed inside the panel
then the tkrplot library is required.</p>
</td></tr>
<tr><td><code id="lev_inf_+3A_hscale">hscale</code>, <code id="lev_inf_+3A_vscale">vscale</code></td>
<td>
<p>Numeric scalars.  Scaling parameters for the size
of the plot when <code>panel_plot = TRUE</code>. The default values are 1.4 on
Unix platforms and 2 on Windows platforms.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>n</code> pairs of observations are simulated with the property
that the mean of response variable <code class="reqn">y</code> is a linear function of the
values of the explanatory variable <code class="reqn">x</code>.  These pairs of observations
are plotted using filled black circles.  An extra observation is plotted
using a filled red circle.  Initially this observation is placed in the
middle of the plot.
</p>
<p>Superimposed on the plot are two least squares regression lines:
one based on all the data ('with observation') and one in which the
'red' observation has been removed ('without observation').
Initially these lines coincide.
</p>
<p>The location of the &lsquo;red&rsquo; observation can be changed using the
+/- buttons so that the effect of the position of this observation
on the &lsquo;with observation&rsquo; line can be seen.
</p>
<p>We see that if the red observation is outlying, that is, it is far
from the least squares line fitted to the other observations, then
its <strong>influence</strong> on the least squares regression line depends on
its x-coordinate.  If its x-coordinate is much larger or smaller than
the x-coordinate of the other observations (<strong>high leverage</strong>) then
the influence is higher than if it has a similar x-coordinate to the
other observations (<strong>low leverage</strong>).  An observation with high
leverage does not necessarily have high influence: if its y-coordinate
falls very close to the regression line fitted to the other observations
then its influence will be low.
</p>


<h3>Value</h3>

<p>Nothing is returned, only the animation is produced.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+movies">movies</a></code>: a user-friendly menu panel.
</p>
<p><code><a href="#topic+smovie">smovie</a></code>: general information about smovie.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Positive association
lev_inf()

# No association
lev_inf(association = "none")
</code></pre>

<hr>
<h2 id='mean_vs_median'>Sample mean vs sample median</h2><span id='topic+mean_vs_median'></span>

<h3>Description</h3>

<p>A movie to compare the sampling distributions of the sample mean
and sample median based on a random sample of size <code class="reqn">n</code> from
either a standard normal distribution or a standard Student's <code class="reqn">t</code>
distribution.  An interesting comparison is between the normal
and Student t with 2 degrees of freedom cases (see <strong>Examples</strong>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mean_vs_median(
  n = 10,
  t_df = NULL,
  panel_plot = TRUE,
  hscale = NA,
  vscale = hscale,
  n_add = 1,
  delta_n = 1,
  arrow = TRUE,
  leg_cex = 1.75,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mean_vs_median_+3A_n">n</code></td>
<td>
<p>An integer scalar.  The size of the samples drawn from a
standard normal distribution.</p>
</td></tr>
<tr><td><code id="mean_vs_median_+3A_t_df">t_df</code></td>
<td>
<p>A positive scalar.  The degrees of freedom <code>df</code> of
a Student t distribution, as in <code><a href="stats.html#topic+TDist">TDist</a></code>.
If <code>t_df</code> is not supplied then data are simulated from a standard
normal distribution.</p>
</td></tr>
<tr><td><code id="mean_vs_median_+3A_panel_plot">panel_plot</code></td>
<td>
<p>A logical parameter that determines whether the plot
is placed inside the panel (<code>TRUE</code>) or in the standard graphics
window (<code>FALSE</code>).  If the plot is to be placed inside the panel
then the tkrplot library is required.</p>
</td></tr>
<tr><td><code id="mean_vs_median_+3A_hscale">hscale</code>, <code id="mean_vs_median_+3A_vscale">vscale</code></td>
<td>
<p>Numeric scalars.  Scaling parameters for the size
of the plot when <code>panel_plot = TRUE</code>. The default values are 1.4 on
Unix platforms and 2 on Windows platforms.</p>
</td></tr>
<tr><td><code id="mean_vs_median_+3A_n_add">n_add</code></td>
<td>
<p>An integer scalar.  The number of simulated datasets to add
to each new frame of the movie.</p>
</td></tr>
<tr><td><code id="mean_vs_median_+3A_delta_n">delta_n</code></td>
<td>
<p>A numeric scalar.  The amount by which n is increased
(or decreased) after one click of the + (or -) button in the parameter
window.</p>
</td></tr>
<tr><td><code id="mean_vs_median_+3A_arrow">arrow</code></td>
<td>
<p>A logical scalar.  Should an arrow be included to show the
simulated sample maximum from the top plot being placed into the
bottom plot?</p>
</td></tr>
<tr><td><code id="mean_vs_median_+3A_leg_cex">leg_cex</code></td>
<td>
<p>The argument <code>cex</code> to <code><a href="graphics.html#topic+legend">legend</a></code>.
Allows the size of the legend to be controlled manually.</p>
</td></tr>
<tr><td><code id="mean_vs_median_+3A_...">...</code></td>
<td>
<p>Additional arguments to the rpanel functions
<code><a href="rpanel.html#topic+rp.button">rp.button</a></code> and
<code><a href="rpanel.html#topic+rp.doublebutton">rp.doublebutton</a></code>, not including <code>panel</code>,
<code>variable</code>, <code>title</code>, <code>step</code>, <code>action</code>, <code>initval</code>,
<code>range</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The movie is based on simulating repeatedly samples of size
<code>n</code> from either a standard normal N(0,1) distribution or a standard
Student t distribution.  The latter is selected by supplying the degrees
of freedom of this distribution, using <code>t_df</code>.  The movie contains
three plots.  The top plot contains a histogram of the most recently
simulated dataset, with the relevant probability density function (p.d.f.)
superimposed.  A <code><a href="graphics.html#topic+rug">rug</a></code> is added to a histogram
provided that it contains no more than 1000 points.
</p>
<p>Each time a sample is simulated the sample mean and sample median are
calculated.  These values are indicated on the top plot using an
arrow (if <code>arrow = TRUE</code>) or a vertical (rug) line on the horizontal
axis (<code>arrow = FALSE</code>), coloured red for the sample mean and blue for
the sample median.
If <code>arrow = TRUE</code> then the arrows show the positionings of most
recent mean and median in the two plots below.  If <code>arrow = FALSE</code>
then the rug lines are replicated in these plots.
</p>
<p>The plot in the middle contains a histogram of
the sample means of <em>all</em> the simulated samples.
The plot on the bottom contains a histogram of
the sample medians of <em>all</em> the simulated samples.
A <code><a href="graphics.html#topic+rug">rug</a></code> is added to these histograms
provided that they contains no more than 1000 points.
</p>
<p>Once it starts, three aspects of this movie are controlled by the user.
</p>

<ul>
<li><p> There are buttons to increase (+) or decrease (-) the sample
size, that is, the number of values over which a maximum is
calculated.
</p>
</li>
<li><p> Each time the button labelled &quot;simulate another <code>n_add</code>
samples of size n&quot; is clicked <code>n_add</code> new samples are simulated
and their sample mean are added to the bottom histogram.
</p>
</li>
<li><p> For the N(0,1) case only, there is a checkbox to add to the
bottom plot the p.d.f.s of the distribution of the sample mean and
the (approximate, large <code>n</code>) distribution of the sample median.
</p>
</li></ul>



<h3>Value</h3>

<p>Nothing is returned, only the animation is produced.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+movies">movies</a></code>: a user-friendly menu panel.
</p>
<p><code><a href="#topic+smovie">smovie</a></code>: general information about smovie.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Sampling from a standard normal distribution
mean_vs_median()

# Sampling from a standard t(2) distribution
mean_vs_median(t_df = 2)
</code></pre>

<hr>
<h2 id='movies'>Main menu for smovie movies</h2><span id='topic+movies'></span>

<h3>Description</h3>

<p>Uses the template <code><a href="rpanel.html#topic+rp.cartoons">rp.cartoons</a></code> function to produce
a menu panel from which any of the movies in
<code><a href="#topic+smovie">smovie</a></code> package can be launched. For greater control
of an individual example call the relevant function directly.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>movies(fixed_range = TRUE, hscale = NA, vscale = hscale)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="movies_+3A_fixed_range">fixed_range</code></td>
<td>
<p>A logical scalar.  Only relevant to the <strong>Discrete</strong>
and <strong>Continuous</strong> menus.  If <code>TRUE</code> then in the call to
<code><a href="#topic+discrete">discrete</a></code> or <code><a href="#topic+continuous">continuous</a></code> the argument
<code>var_support</code> (<code>discrete</code>) or <code>var_range</code>
(<code>continuous</code>) is set so that the values on the horizontal axes
are fixed at values that enable the movie to show the effects of changing
the parameters of the distribution, at least locally to the default
initial values for the parameters.  For greater control call
<code><a href="#topic+discrete">discrete</a></code> or <code><a href="#topic+continuous">continuous</a></code> directly.</p>
</td></tr>
<tr><td><code id="movies_+3A_hscale">hscale</code>, <code id="movies_+3A_vscale">vscale</code></td>
<td>
<p>Numeric scalars.  Scaling parameters for the size
of the plot when <code>panel_plot = TRUE</code>. The default values are 1.4 on
Unix platforms and 2 on Windows platforms.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+discrete">discrete</a></code>, <code><a href="#topic+continuous">continuous</a></code>,
<code><a href="#topic+clt">clt</a></code>, <code><a href="#topic+cltq">cltq</a></code>, <code><a href="#topic+ett">ett</a></code>,
<code><a href="#topic+mean_vs_median">mean_vs_median</a></code>, <code><a href="#topic+correlation">correlation</a></code>,
<code><a href="#topic+lev_inf">lev_inf</a></code>, <code><a href="#topic+wws">wws</a></code>, <code><a href="#topic+shypo">shypo</a></code>.
</p>
<p><code><a href="#topic+smovie">smovie</a></code>: general information about smovie.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>movies()
</code></pre>

<hr>
<h2 id='shypo'>Testing simple hypotheses</h2><span id='topic+shypo'></span>

<h3>Description</h3>

<p>A movie to illustrate statistical concepts involved in the testing
of one simple hypothesis against another.  The example used is a
random sample from a normal distribution whose variance is assumed
to be known.  The simple hypotheses relate to the value of the mean
<code class="reqn">\mu</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>shypo(
  mu0 = 0,
  sd = 6,
  eff = sd,
  n = 10,
  a = mu0 + eff/2,
  target_alpha = 0.05,
  target_beta = 0.1,
  panel_plot = TRUE,
  hscale = NA,
  vscale = hscale,
  delta_n = 1,
  delta_a = sd/(10 * sqrt(n)),
  delta_eff = sd,
  delta_mu0 = 1,
  delta_sd = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="shypo_+3A_mu0">mu0</code></td>
<td>
<p>A numeric scalar.  The value of <code class="reqn">\mu</code> under the null
hypothesis H0 with which to start the movie.</p>
</td></tr>
<tr><td><code id="shypo_+3A_sd">sd</code></td>
<td>
<p>A positive numeric scalar.  The (common) standard deviation
<code class="reqn">\sigma</code> of the normal distributions of the data under the two
hypotheses.</p>
</td></tr>
<tr><td><code id="shypo_+3A_eff">eff</code></td>
<td>
<p>A numeric scalar.  The <em>effect size</em>. The amount by which
the value of <code class="reqn">\mu</code> under the alternative hypothesis is greater than
the value <code>mu0</code> under the null hypothesis.
That is, <code>mu1</code> = <code>eff</code> + <code>mu0</code>.
<code>eff</code> must be non-negative.</p>
</td></tr>
<tr><td><code id="shypo_+3A_n">n</code></td>
<td>
<p>A positive integer scalar.  The sample size with which to start
the movie.</p>
</td></tr>
<tr><td><code id="shypo_+3A_a">a</code></td>
<td>
<p>A numeric scalar.  The critical value of the test with which to
start the movie. H0 is rejected if the sample mean is greater than
<code>a</code>.</p>
</td></tr>
<tr><td><code id="shypo_+3A_target_alpha">target_alpha</code></td>
<td>
<p>A numeric scalar in (0,1).  The target value of the
type I error to be achieved by setting <code>a</code> and/or <code>n</code>
if the user asks for this using a radio button.</p>
</td></tr>
<tr><td><code id="shypo_+3A_target_beta">target_beta</code></td>
<td>
<p>A numeric scalar in (0,1).  The target value of the
type II error to be achieved by setting <code>a</code> and/or <code>n</code>
if the user asks for this using a radio button.</p>
</td></tr>
<tr><td><code id="shypo_+3A_panel_plot">panel_plot</code></td>
<td>
<p>A logical parameter that determines whether the plot
is placed inside the panel (<code>TRUE</code>) or in the standard graphics
window (<code>FALSE</code>).  If the plot is to be placed inside the panel
then the tkrplot library is required.</p>
</td></tr>
<tr><td><code id="shypo_+3A_hscale">hscale</code>, <code id="shypo_+3A_vscale">vscale</code></td>
<td>
<p>Numeric scalars.  Scaling parameters for the size
of the plot when <code>panel_plot = TRUE</code>. The default values are 1.4 on
Unix platforms and 2 on Windows platforms.</p>
</td></tr>
<tr><td><code id="shypo_+3A_delta_mu0">delta_mu0</code>, <code id="shypo_+3A_delta_eff">delta_eff</code>, <code id="shypo_+3A_delta_a">delta_a</code>, <code id="shypo_+3A_delta_n">delta_n</code>, <code id="shypo_+3A_delta_sd">delta_sd</code></td>
<td>
<p>Numeric scalars.  The
respective amounts by which the values of <code>mu0, eff, a, n</code> and
<code>sd</code> are increased (or decreased) after one click of the + (or -)
button in the parameter window.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The movie is based on two plots.
</p>
<p>The top plot shows the (normal)
probability density functions of the sample mean under the null
hypothesis H0 (mean <code>mu0</code>) and the alternative hypothesis H1
(mean <code>mu1</code>, where <code>mu1</code> &gt; <code>mu0</code>), with the values
of <code>mu0</code> and <code>mu1</code> indicated by vertical dashed lines.
H0 is rejected if the sample mean exceeds the critical value <code>a</code>,
which is indicated by a vertical black line.
</p>
<p>The bottom plot shows how the probabilities of making a type I or type II
error (alpha and beta respectively) depend on the value of <code>a</code>,
by plotting these probabilities against <code>a</code>.
</p>
<p>A parameter window enables the user to change the values of <code>n</code>,
<code>a</code>, <code>mu0</code>, <code>eff</code> = <code>mu1</code> - <code>mu0</code> or <code>sd</code>
by clicking the +/- buttons.
</p>
<p>Radio buttons can be used either to:
</p>

<ul>
<li><p> set <code>a</code> to achieve the target type I error probability
<code>target_alpha</code>, based on the current value of <code>n</code>;
</p>
</li>
<li><p> set <code>a</code> and (integer) <code>n</code> to achieve (or better) the
respective target type I and type II error probabilities of
<code>target_alpha</code> and <code>target_beta</code>.
</p>
</li></ul>

<p>If <code>eff = 0</code> then a plot will be produced even though this case is
not practically meaningful.  In the &quot;set a and n to achieve target alpha
and beta&quot; case, the plot will be the same as the case &quot;set a and n by
hand&quot; case.
</p>


<h3>Value</h3>

<p>Nothing is returned, only the animation is produced.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+movies">movies</a></code>: a user-friendly menu panel.
</p>
<p><code><a href="#topic+smovie">smovie</a></code>: general information about smovie.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># 1. Change a (for fixed n) to achieve alpha = 0.05
# 2. Change a and n to achieve alpha &lt;= 0.05 and beta &lt;= 0.1
shypo(mu0 = 0, eff = 5, n = 16, a = 2.3, delta_a = 0.01)
</code></pre>

<hr>
<h2 id='smovie-package'>smovie: some movies to illustrate concepts in statistics</h2><span id='topic+smovie'></span><span id='topic+smovie-package'></span>

<h3>Description</h3>

<p>These movies are animations used to illustrate key statistical ideas.
They are produced using the <code><a href="rpanel.html#topic+rpanel.package">rpanel</a></code>
package.
</p>


<h3>Details</h3>

<p>When one of these functions is called R opens up a small
<em>parameter window</em> containing clickable buttons that can be
used to change parameters underlying the plot. For the effects of
these buttons see the documentation of the individual functions.
</p>
<p>See <code>vignette("smovie-vignette", package = "smovie")</code> for an overview
of the package and the <a href="#topic+movies">user-friendly menu panel</a>.
</p>
<p>There are movies on the following topics.
</p>


<h3>Probability distributions</h3>


<ul>
<li> <p><a href="#topic+discrete">Discrete distributions</a>
</p>
</li>
<li> <p><a href="#topic+continuous">Continuous distributions</a>
</p>
</li></ul>



<h3>Sampling distributions</h3>


<ul>
<li> <p><a href="#topic+clt">Central Limit Theorem: sampling distribution
of a sample mean</a>
</p>
</li>
<li> <p><a href="#topic+cltq">Central Limit Theorem for sample quantiles: sampling
distribution of the 100p% sample quantile</a>
</p>
</li>
<li> <p><a href="#topic+mean_vs_median">Sampling distributions of the mean
and median</a>
</p>
</li>
<li> <p><a href="#topic+ett">Extremal Types Theorem: sampling distribution
of a sample maximum</a>
</p>
</li>
<li> <p><a href="#topic+correlation">Correlation coefficient</a>
</p>
</li></ul>



<h3>Regression</h3>


<ul>
<li> <p><a href="#topic+lev_inf">Leverage and influence in simple linear
regression</a>
</p>
</li></ul>



<h3>Hypothesis testing</h3>


<ul>
<li> <p><a href="#topic+wws">Wald, Wilks and Score tests</a>
</p>
</li>
<li> <p><a href="#topic+shypo">Testing simple hypotheses</a>
</p>
</li></ul>



<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Paul J. Northrop <a href="mailto:p.northrop@ucl.ac.uk">p.northrop@ucl.ac.uk</a> [copyright holder]
</p>


<h3>References</h3>

<p>Bowman, A., Crawford, E., Alexander, G. and Bowman, R. W.
(2007). rpanel: Simple Interactive Controls for R Functions Using the
tcltk Package.  <em>Journal of Statistical Software</em>, <strong>17(9)</strong>,
1-18. <a href="https://doi.org/10.18637/jss.v017.i09">doi:10.18637/jss.v017.i09</a>.
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://paulnorthrop.github.io/smovie/">https://paulnorthrop.github.io/smovie/</a>
</p>
</li>
<li> <p><a href="https://github.com/paulnorthrop/smovie/">https://github.com/paulnorthrop/smovie/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/paulnorthrop/smovie/issues">https://github.com/paulnorthrop/smovie/issues</a>
</p>
</li></ul>


<hr>
<h2 id='wws'>Wald, Wilks and Score tests</h2><span id='topic+wws'></span>

<h3>Description</h3>

<p>A movie to illustrate the nature of the Wald, Wilks and score
likelihood-based test statistics, for a model with a scalar unknown
parameter <code class="reqn">\theta</code>.  The user can change the value of the parameter
under a simple null hypothesis and observe the effect on the test
statistics and (approximate) p-values associated with the tests of
this hypothesis against the general alternative.  The user can
specify their own log-likelihood or use one of two in-built examples.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wws(
  model = c("norm", "binom"),
  theta_range = NULL,
  ...,
  mult = 3,
  theta0 = if (!is.null(theta_range)) sum(c(0.25, 0.75) * theta_range) else NULL,
  panel_plot = TRUE,
  hscale = NA,
  vscale = hscale,
  delta_theta0 = if (!is.null(theta_range)) abs(diff(theta_range))/20 else NULL,
  theta_mle = NULL,
  loglik = NULL,
  alg_score = NULL,
  alg_obs_info = NULL,
  digits = 3
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wws_+3A_model">model</code></td>
<td>
<p>A character scalar.  Name of the the distribution on which
one of two in-built examples are based.
</p>
<p>If <code>model = "norm"</code> then the setting is a random sample of
size <code>n</code> from a normal distribution with unknown mean
<code>mu</code> = <code class="reqn">\theta</code> and known standard deviation <code>sigma</code>.
</p>
<p>If <code>model = "binom"</code> then the setting is a random sample from a
Bernoulli distribution with unknown success probability
<code class="reqn">\theta</code>.
</p>
<p>The behaviour of these examples can be controlled using arguments
supplied via <code>...</code>.  In particular, the data can be supplied
using <code>data</code>.  If <code>model = "norm"</code> then <code>n</code>, <code>mu</code>,
and <code>sigma</code> can also be chosen.
The default cases for these examples are:
</p>

<ul>
<li> <p><code>model = "norm"</code>: <code>n</code> = 10, <code>mu</code> = 0,
<code>sigma</code> = 1 and <code>data</code> contains a sample of
a sample of size <code>n</code> simulated, using
<code><a href="stats.html#topic+Normal">Normal</a></code>, from a normal distribution with mean
<code>mu</code> and standard deviation <code>sigma</code>.
</p>
</li>
<li> <p><code>model = "binom"</code>: <code>data = c(7, 13)</code>, that is,
7 successes and 13 failures observed in 20 trials.  For the purposes
of this movie there must be at least one success and at least one
failure.
</p>
</li></ul>
</td></tr>
<tr><td><code id="wws_+3A_theta_range">theta_range</code></td>
<td>
<p>A numeric vector of length 2.  The range of values of
<code class="reqn">\theta</code> over which to plot the log-likelihood.
If <code>theta_range</code> is not supplied then the argument <code>mult</code>
is used to set the range automatically.</p>
</td></tr>
<tr><td><code id="wws_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to <code>loglik</code>,
<code>alg_score</code> and <code>alg_obs_info</code> if <code>loglik</code> is supplied,
or to functions functions relating to the in-built examples otherwise.
See the description of <code>model</code> above for details.</p>
</td></tr>
<tr><td><code id="wws_+3A_mult">mult</code></td>
<td>
<p>A positive numeric scalar.  If <code>theta_range</code> is not
supplied then an interval of width 2 x <code>mult</code> standard errors centred
on <code>theta_mle</code> is used.  If <code>model = "binom"</code> then
<code>theta_range</code> is truncated to (0,1) if necessary.</p>
</td></tr>
<tr><td><code id="wws_+3A_theta0">theta0</code></td>
<td>
<p>A numeric scalar.  The value of <code class="reqn">\theta</code> under the null
hypothesis to use at the start of the movie.</p>
</td></tr>
<tr><td><code id="wws_+3A_panel_plot">panel_plot</code></td>
<td>
<p>A logical parameter that determines whether the plot
is placed inside the panel (<code>TRUE</code>) or in the standard graphics
window (<code>FALSE</code>).  If the plot is to be placed inside the panel
then the tkrplot library is required.</p>
</td></tr>
<tr><td><code id="wws_+3A_hscale">hscale</code>, <code id="wws_+3A_vscale">vscale</code></td>
<td>
<p>Numeric scalars.  Scaling parameters for the size
of the plot when <code>panel_plot = TRUE</code>. The default values are 1.4 on
Unix platforms and 2 on Windows platforms.</p>
</td></tr>
<tr><td><code id="wws_+3A_delta_theta0">delta_theta0</code></td>
<td>
<p>A numeric scalar.  The amount by which the value of
<code>theta0</code> is increased (or decreased) after one click of the + (or -)
button in the parameter window.</p>
</td></tr>
<tr><td><code id="wws_+3A_theta_mle">theta_mle</code></td>
<td>
<p>A numeric scalar.  The user may use this to supply the
value of the maximum likelihood estimate (MLE) of <code class="reqn">\theta</code>.
Otherwise, <code><a href="stats.html#topic+optim">optim</a></code> is used to search for the MLE,
using <code>theta0</code> as the initial value and <code>theta_range</code> as
bounds within which to search.</p>
</td></tr>
<tr><td><code id="wws_+3A_loglik">loglik</code></td>
<td>
<p>An R function, vectorised with respect to its first argument,
that returns the value of the log-likelihood (up to an additive constant).
The movie will not work if the observed information is not finite at the
maximum likelihood estimate.</p>
</td></tr>
<tr><td><code id="wws_+3A_alg_score">alg_score</code></td>
<td>
<p>A R function that returns the score function, that is,
the derivative of <code>loglik</code> with respect to <code class="reqn">\theta</code>.</p>
</td></tr>
<tr><td><code id="wws_+3A_alg_obs_info">alg_obs_info</code></td>
<td>
<p>A R function that returns the observed information
that is, the negated second derivative of <code>loglik</code> with respect
to <code class="reqn">\theta</code>.</p>
</td></tr>
<tr><td><code id="wws_+3A_digits">digits</code></td>
<td>
<p>An integer indicating the number of significant digits to
be used in the displayed values of the test statistics and
p-values.  See <code><a href="base.html#topic+signif">signif</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <a href="https://en.wikipedia.org/wiki/Wald_test">Wald</a>,
<a href="https://en.wikipedia.org/wiki/Likelihood-ratio_test">Wilks</a>
(or likelihood ratio)
and <a href="https://en.wikipedia.org/wiki/Score_test">Score</a> tests are
asymptotically equivalent tests of a simple hypothesis that a parameter
of interest <code class="reqn">\theta</code> is equal to a particular value <code class="reqn">\theta_0</code>.
The test statistics are all based on the log-likelihood <code class="reqn">l(\theta</code>
for <code class="reqn">\theta</code> but they differ in the way that they measure the
distance between the maximum likelihood estimate (MLE) of <code class="reqn">\theta</code> and
<code class="reqn">\theta_0</code>.  The Wilks statistic is the amount by which the
log-likelihood evaluated <code class="reqn">\theta_0</code> is smaller than the log-likelihood
evaluated at the MLE.  The Walk statistics is based on the absolute
difference between the MLE and <code class="reqn">\theta_0</code>.  The score test is
based on the gradient of the log-likelihood (the score function)
at <code class="reqn">\theta_0</code>.
For details see Azzalini (1996).
</p>
<p>This movie illustrates the differences between the test
statistics for simple models with a single scalar parameter.
In the (default) normal example the three test statistics coincide.
This is not true in general, as shown by the other in-built example
(<code>distn</code> = &quot;binom&quot;).
</p>
<p>A user-supplied log-likelihood can be provided via <code>loglik</code>.
</p>


<h3>Value</h3>

<p>Nothing is returned, only the animation is produced.
</p>


<h3>References</h3>

<p>Azzalini, A. (1996) Statistical Inference Based on the
Likelihood, Chapman &amp; Hall / CRC, London.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+movies">movies</a></code>: a user-friendly menu panel.
</p>
<p><code><a href="#topic+smovie">smovie</a></code>: general information about smovie.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># N(theta, 1) example, test statistics equivalent
wws(theta0 = 0.8)

# binomial(20, theta) example, test statistics similar
wws(theta0 = 0.5, model = "binom")

# binomial(20, theta) example, test statistic rather different
# for theta0 distant from theta_mle
wws(theta0 = 0.9, model = "binom", data = c(19, 1), theta_range = c(0.1, 0.99))

# binomial(2000, theta) example, test statistics very similar
wws(theta0 = 0.5, model = "binom", data = c(1000, 1000))

set.seed(47)
x &lt;- rnorm(10)
wws(theta0 = 0.2, model = "norm", theta_range = c(-1, 1))

# Log-likelihood for a binomial experiment (up to an additive constant)
bin_loglik &lt;- function(p, n_success, n_failure) {
  return(n_success * log(p) + n_failure * log(1 - p))
}

wws(loglik = bin_loglik, theta0 = 0.5, theta_range = c(0.1, 0.7),
    theta_mle = 7 / 20, n_success = 7, n_failure = 13)

bin_alg_score &lt;- function(p, n_success, n_failure) {
  return(n_success / p - n_failure / (1 - p))
}
bin_alg_obs_info &lt;- function(p, n_success, n_failure) {
  return(n_success / p ^ 2 + n_failure / (1 - p) ^ 2)
}
wws(loglik = bin_loglik, theta0 = 0.5, theta_range = c(0.1, 0.7),
    theta_mle = 7 / 20, n_success = 7, n_failure = 13,
    alg_score = bin_alg_score, alg_obs_info = bin_alg_obs_info)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
