<!DOCTYPE html><html><head><title>Help for package DGLMExtPois</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {DGLMExtPois}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#AIC'><p>AIC and BIC for hyper-Poisson Fits</p></a></li>
<li><a href='#AIC_CMP'><p>AIC and BIC for COM-Poisson Fitted Models</p></a></li>
<li><a href='#Bids'><p>Bids Received by U.S. Firms</p></a></li>
<li><a href='#confint.glm_CMP'><p>Confidence Intervals for glm_hP Fits</p></a></li>
<li><a href='#confint.glm_hP'><p>Confidence Intervals for glm_hP Fits</p></a></li>
<li><a href='#CustomerProfile'><p>Customer profile for a household supplies company</p></a></li>
<li><a href='#DGLMExtPois-package'><p>DGLMExtPois: Double Generalized Linear Models Extending Poisson Regression</p></a></li>
<li><a href='#expected'><p>Expected Probabilities and Frequencies for the hyper-Poisson and COM-Poisson</p>
Model</a></li>
<li><a href='#glm.CMP'><p>Fit a COM-Poisson Double Generalized Linear Model</p></a></li>
<li><a href='#glm.hP'><p>Fit a hyper-Poisson Double Generalized Linear Model</p></a></li>
<li><a href='#hP'><p>The hyper-Poisson Distribution</p></a></li>
<li><a href='#lrtest'><p>Likelihood Ratio Test for Nested glm_CMP and glm_hP Fits</p></a></li>
<li><a href='#plots'><p>Plot Diagnostics for glm_hP and glm_CMP Objects</p></a></li>
<li><a href='#predict.glm_CMP'><p>Predict Method for glm_CMP Fits</p></a></li>
<li><a href='#predict.glm_hP'><p>Predict Method for glm_hP Fits</p></a></li>
<li><a href='#residuals'><p>Extract and Visualize hyper-Poisson and COM-Poisson Model Residuals</p></a></li>
<li><a href='#summary.glm_CMP'><p>Summarizing COM-Poisson Fits</p></a></li>
<li><a href='#summary.glm_hP'><p>Summarizing hyper-Poisson Fits</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Double Generalized Linear Models Extending Poisson Regression</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.3</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Francisco Martinez &lt;fmartin@ujaen.es&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Model estimation, dispersion testing and diagnosis of hyper-Poisson
    Saez-Castillo, A.J. and Conde-Sanchez, A. (2013) 
    &lt;<a href="https://doi.org/10.1016%2Fj.csda.2012.12.009">doi:10.1016/j.csda.2012.12.009</a>&gt; and Conway-Maxwell-Poisson Huang, A. (2017)
    regression models.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Imports:</td>
<td>nloptr (&ge; 1.2.1), COMPoissonReg</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/franciscomartinezdelrio/DGLMExtPois">https://github.com/franciscomartinezdelrio/DGLMExtPois</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/franciscomartinezdelrio/DGLMExtPois/issues">https://github.com/franciscomartinezdelrio/DGLMExtPois/issues</a></td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-09-04 09:37:20 UTC; UJA</td>
</tr>
<tr>
<td>Author:</td>
<td>Antonio Jose Saez-Castillo [aut],
  Antonio Conde-Sanchez [aut],
  Francisco Martinez [aut, cre]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-09-04 09:50:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='AIC'>AIC and BIC for hyper-Poisson Fits</h2><span id='topic+AIC'></span><span id='topic+AIC.glm_hP'></span><span id='topic+BIC.glm_hP'></span>

<h3>Description</h3>

<p>Computes the Akaike's information criterion or the Schwarz's Bayesian criterion
for hyper-Poisson Fits
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'glm_hP'
AIC(object, ..., k = 2)

## S3 method for class 'glm_hP'
BIC(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="AIC_+3A_object">object</code></td>
<td>
<p>an object of class <code>"glm_hP"</code>, typically the result of a
call to <code><a href="#topic+glm.hP">glm.hP</a></code>.</p>
</td></tr>
<tr><td><code id="AIC_+3A_...">...</code></td>
<td>
<p>optionally more fitted model objects.</p>
</td></tr>
<tr><td><code id="AIC_+3A_k">k</code></td>
<td>
<p>numeric, the <em>penalty</em> per parameter to be used; the
default <code>k = 2</code> is the classical AIC.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Fit a hyper-Poisson model
Bids$size.sq &lt;- Bids$size ^ 2
fit &lt;- glm.hP(formula.mu = numbids ~ leglrest + rearest + finrest +
              whtknght + bidprem + insthold + size + size.sq + regulatn,
              formula.gamma = numbids ~ 1, data = Bids)

## Obtain its AIC and BIC
AIC(fit)
BIC(fit)
</code></pre>

<hr>
<h2 id='AIC_CMP'>AIC and BIC for COM-Poisson Fitted Models</h2><span id='topic+AIC_CMP'></span><span id='topic+AIC.glm_CMP'></span><span id='topic+BIC.glm_CMP'></span>

<h3>Description</h3>

<p>Computes the Akaike's information criterion or the Schwarz's Bayesian criterion
for COM-Poisson Fits
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'glm_CMP'
AIC(object, ..., k = 2)

## S3 method for class 'glm_CMP'
BIC(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="AIC_CMP_+3A_object">object</code></td>
<td>
<p>an object of class <code>"glm_CMP"</code>, typically the result of a
call to <code><a href="#topic+glm.CMP">glm.CMP</a></code>.</p>
</td></tr>
<tr><td><code id="AIC_CMP_+3A_...">...</code></td>
<td>
<p>optionally more fitted model objects.</p>
</td></tr>
<tr><td><code id="AIC_CMP_+3A_k">k</code></td>
<td>
<p>numeric, the <em>penalty</em> per parameter to be used; the
default <code>k = 2</code> is the classical AIC.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Estimate a COM-Poisson model
Bids$size.sq &lt;- Bids$size ^ 2
fit &lt;- glm.CMP(formula.mu = numbids ~ leglrest + rearest + finrest +
              whtknght + bidprem + insthold + size + size.sq + regulatn,
              formula.nu = numbids ~ 1, data = Bids)

## Compute its AIC and BIC
AIC(fit)
BIC(fit)
</code></pre>

<hr>
<h2 id='Bids'>Bids Received by U.S. Firms</h2><span id='topic+Bids'></span>

<h3>Description</h3>

<p>A dataset with bids received by U.S. firms.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Bids
</code></pre>


<h3>Format</h3>

<p>A data frame with 126 rows and 13 variables: </p>

<dl>
<dt>docno</dt><dd><p>doc no.</p>
</dd> <dt>weeks</dt><dd><p>weeks</p>
</dd> <dt>numbids</dt><dd><p>count</p>
</dd>
<dt>takeover</dt><dd><p>delta(1 if taken over)</p>
</dd> <dt>bidprem</dt><dd><p>bid Premium</p>
</dd>
<dt>insthold</dt><dd><p>institutional holdings</p>
</dd> <dt>size</dt><dd><p>size measured in
billions</p>
</dd> <dt>leglrest</dt><dd><p>legal restructuring</p>
</dd> <dt>rearest</dt><dd><p>real
restructuring</p>
</dd> <dt>finrest</dt><dd><p>financial restructuring</p>
</dd>
<dt>regulatn</dt><dd><p>regulation</p>
</dd> <dt>whtknght</dt><dd><p>white knight</p>
</dd> </dl>



<h3>Source</h3>

<p>Sanjiv Jaggia and Satish Thosar (1993) &quot;Multiple Bids as a
Consequence of Target Management Resistance&quot;, Review of Quantitative
Finance and Accounting, 3(4), pp. 447-457.
</p>
<p>A. Colin Cameron and Per Johansson (1997) &quot;Count Data Regression Models using
Series Expansions: with Applications&quot;, Journal of Applied Econometrics, 12,
pp. 203-223.
</p>

<hr>
<h2 id='confint.glm_CMP'>Confidence Intervals for glm_hP Fits</h2><span id='topic+confint.glm_CMP'></span>

<h3>Description</h3>

<p>Computes confidence intervals for one or more parameters in a <code>glm_CMP</code>
object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'glm_CMP'
confint(object, parm, level = 0.95, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="confint.glm_CMP_+3A_object">object</code></td>
<td>
<p>a fitted object of class inheriting from <code>"glm_CMP"</code>.</p>
</td></tr>
<tr><td><code id="confint.glm_CMP_+3A_parm">parm</code></td>
<td>
<p>a specification of which parameters are to be given confidence
intervals, either a vector of numbers or a vector of names. If missing, all
parameters are considered.</p>
</td></tr>
<tr><td><code id="confint.glm_CMP_+3A_level">level</code></td>
<td>
<p>the confidence level required.</p>
</td></tr>
<tr><td><code id="confint.glm_CMP_+3A_...">...</code></td>
<td>
<p>additional argument(s) for methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix (or vector) with columns giving lower and upper confidence
limits for each <code>beta</code> parameter. These will be labelled as
(1-level)/2 and 1 - (1-level)/2 in (by default 2.5% and 97.5%).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Estimate the model
Bids$size.sq &lt;- Bids$size ^ 2
fit &lt;- glm.CMP(formula.mu = numbids ~ leglrest + rearest + finrest +
               whtknght + bidprem + insthold + size + size.sq + regulatn,
               formula.nu = numbids ~ 1, data = Bids)

## Compute confidence intervals
confint(fit)
</code></pre>

<hr>
<h2 id='confint.glm_hP'>Confidence Intervals for glm_hP Fits</h2><span id='topic+confint.glm_hP'></span>

<h3>Description</h3>

<p>Computes confidence intervals for one or more parameters in a <code>"glm_hP"</code>
object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'glm_hP'
confint(object, parm, level = 0.95, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="confint.glm_hP_+3A_object">object</code></td>
<td>
<p>a fitted object of class inheriting from <code>"glm_hP"</code>.</p>
</td></tr>
<tr><td><code id="confint.glm_hP_+3A_parm">parm</code></td>
<td>
<p>a specification of which parameters are to be given confidence
intervals, either a vector of numbers or a vector of names. If missing, all
parameters are considered.</p>
</td></tr>
<tr><td><code id="confint.glm_hP_+3A_level">level</code></td>
<td>
<p>the confidence level required.</p>
</td></tr>
<tr><td><code id="confint.glm_hP_+3A_...">...</code></td>
<td>
<p>additional argument(s) for methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix (or vector) with columns giving lower and upper confidence
limits for each <code>beta</code> parameter. These will be labelled as
(1-level)/2 and 1 - (1-level)/2 in % (by default 2.5% and 97.5%).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Estimate the model
Bids$size.sq &lt;- Bids$size ^ 2
fit &lt;- glm.hP(formula.mu = numbids ~ leglrest + rearest + finrest +
         whtknght + bidprem + insthold + size + size.sq + regulatn,
              formula.gamma = numbids ~ 1, data = Bids)

## Compute confidence intervals for parameters
confint(fit)
</code></pre>

<hr>
<h2 id='CustomerProfile'>Customer profile for a household supplies company</h2><span id='topic+CustomerProfile'></span>

<h3>Description</h3>

<p>An observation corresponds to the census tracts within 10-mile radius around
certain store.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CustomerProfile
</code></pre>


<h3>Format</h3>

<p>A data frame with 110 rows and 6 variables: </p>

<dl>
<dt>ncust</dt><dd><p>number of customer of the census tracts who visit the store.</p>
</dd>
<dt>nhu</dt><dd><p>number of housing units in the census tracts</p>
</dd> <dt>aid</dt><dd><p>average
income in dollars</p>
</dd> <dt>aha</dt><dd><p>average housing unit in years</p>
</dd>
<dt>dnc</dt><dd><p>distance to the nearest competitor in miles</p>
</dd> <dt>ds</dt><dd><p>distance
to store in miles</p>
</dd> </dl>



<h3>Source</h3>

<p>http://www.leg.ufpr.br/lib/exe/fetch.php/publications:papercompanions:ptwdataset4.txt
</p>

<hr>
<h2 id='DGLMExtPois-package'>DGLMExtPois: Double Generalized Linear Models Extending Poisson Regression</h2><span id='topic+DGLMExtPois'></span><span id='topic+DGLMExtPois-package'></span>

<h3>Description</h3>

<p>Model estimation, dispersion testing and diagnosis of hyper-Poisson Saez-Castillo, A.J. and Conde-Sanchez, A. (2013) <a href="https://doi.org/10.1016/j.csda.2012.12.009">doi:10.1016/j.csda.2012.12.009</a> and Conway-Maxwell-Poisson Huang, A. (2017) regression models.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Francisco Martinez <a href="mailto:fmartin@ujaen.es">fmartin@ujaen.es</a>
</p>
<p>Authors:
</p>

<ul>
<li><p> Antonio Jose Saez-Castillo <a href="mailto:ajsaez@ujaen.es">ajsaez@ujaen.es</a>
</p>
</li>
<li><p> Antonio Conde-Sanchez <a href="mailto:aconde@ujaen.es">aconde@ujaen.es</a>
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/franciscomartinezdelrio/DGLMExtPois">https://github.com/franciscomartinezdelrio/DGLMExtPois</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/franciscomartinezdelrio/DGLMExtPois/issues">https://github.com/franciscomartinezdelrio/DGLMExtPois/issues</a>
</p>
</li></ul>


<hr>
<h2 id='expected'>Expected Probabilities and Frequencies for the hyper-Poisson and COM-Poisson
Model</h2><span id='topic+expected'></span><span id='topic+hP_expected'></span><span id='topic+CMP_expected'></span>

<h3>Description</h3>

<p>The <code>hP_expected</code> and <code>CMP_expected</code> functions calculate the
probability distribution of the count response variable Y for each observation
and obtain the corresponding expected frequencies. It is an informal way of
assessing the fit of the hP or CMP model by comparing the predicted
distribution of counts with the observed distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hP_expected(object)

CMP_expected(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="expected_+3A_object">object</code></td>
<td>
<p>a fitted object of class inheriting from <code>"glm_hP"</code> or
<code>"glm_CMP"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The average expected probabilities are computed as </p>
<p style="text-align: center;"><code class="reqn">\bar(Pr)(y=k) =
\frac{1}{n} \sum_{i=1}^n \widehat{Pr}(y_i = k | x_i)</code>
</p>

<p>The expected frequencies are obtained by multiplying by n.
</p>
<p>Two measures are offered for summarizing the comparison between expected and
observed frequencies: the sum of the absolute value of differences and the sum
of the square of differences (similar to the Pearson statistic of goodness of
fit).
</p>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr><td><code>frequencies</code></td>
<td>
<p>the expected counts for the hP or CMP fit.</p>
</td></tr>
<tr><td><code>observed_freq</code></td>
<td>
<p>the observed distribution.</p>
</td></tr>
<tr><td><code>probabilities</code></td>
<td>
<p>the expected distribution for the hP or CMP
fit.</p>
</td></tr> <tr><td><code>dif</code></td>
<td>
<p>sum of the absolute value of differences between
<code>frequencies</code> and <code>observed_freq</code>.</p>
</td></tr> <tr><td><code>chi2</code></td>
<td>
<p>sum of the
square of differences between <code>frequencies</code> and <code>observed_freq</code>.</p>
</td></tr>
</table>


<h3>References</h3>

<p>J. M. Hilbe (2011). Negative Binomial Regression. (2nd ed.). Cambridge
University Press.
</p>
<p>M. Scott Long and Jeremy Freese (2014). Regression Models for Categorical
Dependent Variables using STATA. (3rd ed.). Stata Press.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Fit a hyper-Poisson model

Bids$size.sq &lt;- Bids$size ^ 2
hP.fit &lt;- glm.hP(formula.mu = numbids ~ leglrest + rearest + finrest +
                 whtknght + bidprem + insthold + size + size.sq + regulatn,
                 formula.gamma = numbids ~ 1, data = Bids)

## Compute the expected probabilities and the frequencies

hP_expected(hP.fit)
## Estimate a COM-Poisson model

Bids$size.sq &lt;- Bids$size ^ 2
CMP.fit &lt;- glm.CMP(formula.mu = numbids ~ leglrest + rearest + finrest +
                   whtknght + bidprem + insthold + size + size.sq + regulatn,
                   formula.nu = numbids ~ 1, data = Bids)

## Compute the expected probabilities and the frequencies

CMP_expected(CMP.fit)
</code></pre>

<hr>
<h2 id='glm.CMP'>Fit a COM-Poisson Double Generalized Linear Model</h2><span id='topic+glm.CMP'></span>

<h3>Description</h3>

<p>The <code>glm.CMP</code> function is used to fit a COM-Poisson double generalized
linear model with a log-link for the mean (<code>mu</code>) and the dispersion
parameter (<code>nu</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>glm.CMP(
  formula.mu,
  formula.nu,
  init.beta = NULL,
  init.delta = NULL,
  data,
  weights,
  subset,
  na.action,
  maxiter_series = 1000,
  tol = 0,
  offset,
  opts = NULL,
  model.mu = TRUE,
  model.nu = TRUE,
  x = FALSE,
  y = TRUE,
  z = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="glm.CMP_+3A_formula.mu">formula.mu</code></td>
<td>
<p>regression formula linked to <code>log(mu)</code></p>
</td></tr>
<tr><td><code id="glm.CMP_+3A_formula.nu">formula.nu</code></td>
<td>
<p>regression formula linked to <code>log(nu)</code></p>
</td></tr>
<tr><td><code id="glm.CMP_+3A_init.beta">init.beta</code></td>
<td>
<p>initial values for regression coefficients of <code>beta</code>.</p>
</td></tr>
<tr><td><code id="glm.CMP_+3A_init.delta">init.delta</code></td>
<td>
<p>initial values for regression coefficients of <code>delta</code>.</p>
</td></tr>
<tr><td><code id="glm.CMP_+3A_data">data</code></td>
<td>
<p>an optional data frame, list or environment (or object coercible
by <code><a href="base.html#topic+as.data.frame">as.data.frame</a></code> to a data frame) containing the
variables in the model. If not found in data, the variables are taken from
<code>environment(formula)</code>, typically the environment from which
<code>glm.CMP</code> is called.</p>
</td></tr>
<tr><td><code id="glm.CMP_+3A_weights">weights</code></td>
<td>
<p>an optional vector of &lsquo;prior weights&rsquo; to be used in the
fitting process. Should be <code>NULL</code> or a numeric vector.</p>
</td></tr>
<tr><td><code id="glm.CMP_+3A_subset">subset</code></td>
<td>
<p>an optional vector specifying a subset of observations to be
used in the fitting process.</p>
</td></tr>
<tr><td><code id="glm.CMP_+3A_na.action">na.action</code></td>
<td>
<p>a function which indicates what should happen when the data
contain <code>NAs</code>. The default is set by the <code>na.action</code> setting of
<code><a href="base.html#topic+options">options</a></code>, and is <code><a href="stats.html#topic+na.fail">na.fail</a></code> if that is
unset. The &lsquo;factory-fresh&rsquo; default is
<code><a href="stats.html#topic+na.fail">na.omit</a></code>. Another possible value is
<code>NULL</code>, no action. Value <code><a href="stats.html#topic+na.fail">na.exclude</a></code> can
be useful.</p>
</td></tr>
<tr><td><code id="glm.CMP_+3A_maxiter_series">maxiter_series</code></td>
<td>
<p>Maximum number of iterations to perform in the
calculation of the normalizing constant.</p>
</td></tr>
<tr><td><code id="glm.CMP_+3A_tol">tol</code></td>
<td>
<p>tolerance with default zero meaning to iterate until additional
terms to not change the partial sum in the calculation of the normalizing
constant.</p>
</td></tr>
<tr><td><code id="glm.CMP_+3A_offset">offset</code></td>
<td>
<p>this can be used to specify an a priori known component to be
included in the linear predictor during fitting. This should be <code>NULL</code>
or a numeric vector of length equal to the number of cases. One or more
<code><a href="stats.html#topic+offset">offset</a></code> terms can be included in the formula instead or
as well, and if more than one is specified their sum is used. See
<code><a href="stats.html#topic+model.extract">model.offset</a></code>.</p>
</td></tr>
<tr><td><code id="glm.CMP_+3A_opts">opts</code></td>
<td>
<p>a list with options to the optimizer,
<code><a href="nloptr.html#topic+nloptr">nloptr</a></code>, that fits the model. See, the <code>opts</code>
parameter of <code><a href="nloptr.html#topic+nloptr">nloptr</a></code> for further details.</p>
</td></tr>
<tr><td><code id="glm.CMP_+3A_model.mu">model.mu</code></td>
<td>
<p>a logical value indicating whether the <em>mu model frame</em>
should be included as a component of the returned value.</p>
</td></tr>
<tr><td><code id="glm.CMP_+3A_model.nu">model.nu</code></td>
<td>
<p>a logical value indicating whether the <em>nu model frame</em>
should be included as a component of the returned value.</p>
</td></tr>
<tr><td><code id="glm.CMP_+3A_x">x</code></td>
<td>
<p>logical value indicating whether the mu model matrix used in the
fitting process should be returned as a component of the returned value.</p>
</td></tr>
<tr><td><code id="glm.CMP_+3A_y">y</code></td>
<td>
<p>logical value indicating whether the response vector used in the
fitting process should be returned as a component of the returned value.</p>
</td></tr>
<tr><td><code id="glm.CMP_+3A_z">z</code></td>
<td>
<p>logical value indicating whether the nu model matrix used in the
fitting process should be returned as a component of the returned value.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Fit a COM-Poisson double generalized linear model using as optimizer the
NLOPT_LD_SLSQP algorithm of function <code><a href="nloptr.html#topic+nloptr">nloptr</a></code>.
</p>


<h3>Value</h3>

<p><code>glm.CMP</code> returns an object of class <code>"glm_CMP"</code>. The
function <code><a href="base.html#topic+summary">summary</a></code> can be used to obtain or print a
summary of the results. An object of class <code>"glm_CMP"</code> is a list
containing at least the following components: </p>
<table>
<tr><td><code>coefficients</code></td>
<td>
<p>a
named vector of coefficients.</p>
</td></tr> <tr><td><code>residuals</code></td>
<td>
<p>the residuals, that
is response minus fitted values.</p>
</td></tr> <tr><td><code>fitted.values</code></td>
<td>
<p>the fitted
mean values.</p>
</td></tr> <tr><td><code>linear.predictors</code></td>
<td>
<p>the linear fit on link
scale.</p>
</td></tr> <tr><td><code>call</code></td>
<td>
<p>the matched call.</p>
</td></tr> <tr><td><code>offset</code></td>
<td>
<p>the
offset vector used.</p>
</td></tr> <tr><td><code>weights</code></td>
<td>
<p>the weights initially supplied,
a vector of <code>1s</code> if none were.</p>
</td></tr> <tr><td><code>y</code></td>
<td>
<p>if requested (the
default) the y vector used.</p>
</td></tr> <tr><td><code>matrix.mu</code></td>
<td>
<p>if requested, the mu
model matrix.</p>
</td></tr> <tr><td><code>matrix.nu</code></td>
<td>
<p>if requested, the nu model matrix.</p>
</td></tr>
<tr><td><code>model.mu</code></td>
<td>
<p>if requested (the default) the mu model frame.</p>
</td></tr>
<tr><td><code>model.nu</code></td>
<td>
<p>if requested (the default) the nu model
frame.</p>
</td></tr><tr><td><code>nloptr</code></td>
<td>
<p>an object of class <code>"nloptr"</code> with the
result returned by the optimizer <code><a href="nloptr.html#topic+nloptr">nloptr</a></code></p>
</td></tr>
</table>


<h3>References</h3>

<p>Alan Huang (2017). &quot;Mean-parametrized Conway–Maxwell–Poisson
regression models for dispersed counts&quot;, Statistical Modelling, 17(6), pp.
359&ndash;380.
</p>
<p>S. G. Johnson (2018). <a href="https://CRAN.R-project.org/package=nloptr">The
nlopt nonlinear-optimization package</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Fit model
Bids$size.sq &lt;- Bids$size^2
fit &lt;- glm.CMP(formula.mu = numbids ~ leglrest + rearest + finrest +
               whtknght + bidprem + insthold + size + size.sq + regulatn,
               formula.nu = numbids ~ 1, data = Bids)

## Summary of the model
summary(fit)

## To see termination condition of the optimization process
fit$nloptr$message

## To see number of iterations of the optimization process
fit$nloptr$iterations
</code></pre>

<hr>
<h2 id='glm.hP'>Fit a hyper-Poisson Double Generalized Linear Model</h2><span id='topic+glm.hP'></span>

<h3>Description</h3>

<p>The <code>glm.hP</code> function is used to fit a hyper-Poisson double generalized
linear model with a log-link for the mean (<code>mu</code>) and the dispersion
parameter (<code>gamma</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>glm.hP(
  formula.mu,
  formula.gamma,
  init.beta = NULL,
  init.delta = NULL,
  data,
  weights,
  subset,
  na.action,
  maxiter_series = 1000,
  tol = 0,
  offset,
  opts = NULL,
  model.mu = TRUE,
  model.gamma = TRUE,
  x = FALSE,
  y = TRUE,
  z = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="glm.hP_+3A_formula.mu">formula.mu</code></td>
<td>
<p>an object of class &quot;formula&quot; (or one that can be coerced to
that class): a symbolic description of the model to be fitted.</p>
</td></tr>
<tr><td><code id="glm.hP_+3A_formula.gamma">formula.gamma</code></td>
<td>
<p>regression formula linked to <code>log(gamma)</code></p>
</td></tr>
<tr><td><code id="glm.hP_+3A_init.beta">init.beta</code></td>
<td>
<p>initial values for regression coefficients of <code>beta</code>.</p>
</td></tr>
<tr><td><code id="glm.hP_+3A_init.delta">init.delta</code></td>
<td>
<p>initial values for regression coefficients of <code>delta</code>.</p>
</td></tr>
<tr><td><code id="glm.hP_+3A_data">data</code></td>
<td>
<p>an optional data frame, list or environment (or object that can
be coerced by <code><a href="base.html#topic+as.data.frame">as.data.frame</a></code> to a data frame) containing
the variables in the model. If not found in data, the variables are taken
from <code>environment(formula)</code>, typically the environment from which
<code>glm.hP</code> is called.</p>
</td></tr>
<tr><td><code id="glm.hP_+3A_weights">weights</code></td>
<td>
<p>an optional vector of &lsquo;prior weights&rsquo; to be used in the
fitting process. Should be <code>NULL</code> or a numeric vector.</p>
</td></tr>
<tr><td><code id="glm.hP_+3A_subset">subset</code></td>
<td>
<p>an optional vector specifying a subset of observations to be
used in the fitting process.</p>
</td></tr>
<tr><td><code id="glm.hP_+3A_na.action">na.action</code></td>
<td>
<p>a function which indicates what should happen when the data
contain <code>NAs</code>. The default is set by the <code>na.action</code> setting of
<code><a href="base.html#topic+options">options</a></code>, and is <code><a href="stats.html#topic+na.fail">na.fail</a></code> if that is
unset. The &lsquo;factory-fresh&rsquo; default is
<code><a href="stats.html#topic+na.fail">na.omit</a></code>. Another possible value is
<code>NULL</code>, no action. Value <code><a href="stats.html#topic+na.fail">na.exclude</a></code> can
be useful.</p>
</td></tr>
<tr><td><code id="glm.hP_+3A_maxiter_series">maxiter_series</code></td>
<td>
<p>Maximum number of iterations to perform in the
calculation of the normalizing constant.</p>
</td></tr>
<tr><td><code id="glm.hP_+3A_tol">tol</code></td>
<td>
<p>tolerance with default zero meaning to iterate until additional
terms to not change the partial sum in the calculation of the normalizing
constant.</p>
</td></tr>
<tr><td><code id="glm.hP_+3A_offset">offset</code></td>
<td>
<p>this can be used to specify an a priori known component to be
included in the linear predictor during fitting. This should be <code>NULL</code>
or a numeric vector of length equal to the number of cases. One or more
<code><a href="stats.html#topic+offset">offset</a></code> terms can be included in the formula instead or
as well, and if more than one is specified their sum is used. See
<code><a href="stats.html#topic+model.extract">model.offset</a></code>.</p>
</td></tr>
<tr><td><code id="glm.hP_+3A_opts">opts</code></td>
<td>
<p>a list with options to the optimizer,
<code><a href="nloptr.html#topic+nloptr">nloptr</a></code>, that fits the model. See, the <code>opts</code>
parameter of <code><a href="nloptr.html#topic+nloptr">nloptr</a></code> for further details.</p>
</td></tr>
<tr><td><code id="glm.hP_+3A_model.mu">model.mu</code></td>
<td>
<p>a logical value indicating whether the <em>mu model frame</em>
should be included as a component of the returned value.</p>
</td></tr>
<tr><td><code id="glm.hP_+3A_model.gamma">model.gamma</code></td>
<td>
<p>a logical value indicating whether the <em>gamma model
frame</em> should be included as a component of the returned value.</p>
</td></tr>
<tr><td><code id="glm.hP_+3A_x">x</code></td>
<td>
<p>logical value indicating whether the mu model matrix used in the
fitting process should be returned as a component of the returned value.</p>
</td></tr>
<tr><td><code id="glm.hP_+3A_y">y</code></td>
<td>
<p>logical value indicating whether the response vector used in the
fitting process should be returned as a component of the returned value.</p>
</td></tr>
<tr><td><code id="glm.hP_+3A_z">z</code></td>
<td>
<p>logical value indicating whether the gamma model matrix used in the
fitting process should be returned as a component of the returned value.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Fit a hyper-Poisson double generalized linear model using as optimizer the
NLOPT_LD_SLSQP algorithm of function <code><a href="nloptr.html#topic+nloptr">nloptr</a></code>.
</p>


<h3>Value</h3>

<p><code>glm.hP</code> returns an object of class <code>"glm_hP"</code>. The
function <code><a href="base.html#topic+summary">summary</a></code> can be used to obtain or print a
summary of the results.
</p>
<p>The generic accessor functions <code><a href="stats.html#topic+coef">coef</a></code>,
<code><a href="stats.html#topic+fitted.values">fitted.values</a></code> and <code><a href="stats.html#topic+residuals">residuals</a></code> can
be used to extract various useful features of the value returned by
<code>glm.hP</code>.
</p>
<p><code>weights</code> extracts a vector of weights, one for each case in the fit
(after subsetting and <code>na.action</code>).
</p>
<p>An object of class <code>"glm_hP"</code> is a list containing at least the
following components:
</p>
<table>
<tr><td><code>coefficients</code></td>
<td>
<p>a named vector of coefficients.</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>the residuals, that is response minus fitted
values.</p>
</td></tr> <tr><td><code>fitted.values</code></td>
<td>
<p>the fitted mean values.</p>
</td></tr>
<tr><td><code>linear.predictors</code></td>
<td>
<p>the linear fit on link scale.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the matched call.</p>
</td></tr> <tr><td><code>offset</code></td>
<td>
<p>the offset
vector used.</p>
</td></tr> <tr><td><code>weights</code></td>
<td>
<p>the weights initially supplied, a
vector of <code>1s</code> if none were.</p>
</td></tr> <tr><td><code>df.residual</code></td>
<td>
<p>the residual
degrees of freedom.</p>
</td></tr> <tr><td><code>df.null</code></td>
<td>
<p>the residual degrees of freedom
for the null model.</p>
</td></tr> <tr><td><code>y</code></td>
<td>
<p>if requested (the default) the y
vector used.</p>
</td></tr> <tr><td><code>matrix.mu</code></td>
<td>
<p>if requested, the mu model matrix.</p>
</td></tr>
<tr><td><code>matrix.gamma</code></td>
<td>
<p>if requested, the gamma model matrix.</p>
</td></tr>
<tr><td><code>model.mu</code></td>
<td>
<p>if requested (the default) the mu model frame.</p>
</td></tr>
<tr><td><code>model.gamma</code></td>
<td>
<p>if requested (the default) the gamma model
frame.</p>
</td></tr> <tr><td><code>nloptr</code></td>
<td>
<p>an object of class <code>"nloptr"</code> with the
result returned by the optimizer <code><a href="nloptr.html#topic+nloptr">nloptr</a></code></p>
</td></tr>
</table>


<h3>References</h3>

<p>Antonio J. Saez-Castillo and Antonio Conde-Sanchez (2013). &quot;A hyper-Poisson
regression model for overdispersed and underdispersed count data&quot;,
Computational Statistics &amp; Data Analysis, 61, pp. 148&ndash;157.
</p>
<p>S. G. Johnson (2018). <a href="https://CRAN.R-project.org/package=nloptr">The
nlopt nonlinear-optimization package</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Fit model
Bids$size.sq &lt;- Bids$size ^ 2
fit &lt;- glm.hP(formula.mu = numbids ~ leglrest + rearest + finrest +
              whtknght + bidprem + insthold + size + size.sq + regulatn,
              formula.gamma = numbids ~ 1, data = Bids)

## Summary of the model
summary(fit)

## To see the termination condition of the optimization process
fit$nloptr$message

## To see the number of iterations of the optimization process
fit$nloptr$iterations
</code></pre>

<hr>
<h2 id='hP'>The hyper-Poisson Distribution</h2><span id='topic+hP'></span><span id='topic+dhP'></span><span id='topic+phP'></span><span id='topic+rhP'></span>

<h3>Description</h3>

<p>Density, distribution function and random generation for the hyper-Poisson
distribution with parameters <code>gamma</code> and <code>lambda</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dhP(x, gamma, lambda)

phP(q, gamma, lambda, lower.tail = TRUE)

rhP(n, gamma, lambda)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hP_+3A_x">x</code></td>
<td>
<p>vector of (non-negative integer) quantiles.</p>
</td></tr>
<tr><td><code id="hP_+3A_gamma">gamma</code></td>
<td>
<p>dispersion parameter. Must be strictly positive.</p>
</td></tr>
<tr><td><code id="hP_+3A_lambda">lambda</code></td>
<td>
<p>location parameter. Must be strictly positive.</p>
</td></tr>
<tr><td><code id="hP_+3A_q">q</code></td>
<td>
<p>vector of quantiles.</p>
</td></tr>
<tr><td><code id="hP_+3A_lower.tail">lower.tail</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), probabilities are
<code class="reqn">P[X \le x]</code>, otherwise, <code class="reqn">P[X &gt; x]</code>.</p>
</td></tr>
<tr><td><code id="hP_+3A_n">n</code></td>
<td>
<p>number of random values to return.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>dhP</code> gives the density, <code>phP</code> gives the distribution
function and <code>rhP</code> generates random deviates.
</p>
<p>Invalid <code>gamma</code> or <code>lambda</code> will result in return value
<code>NaN</code>, with a warning.
</p>
<p>The length of the result is determined by n for <code>rhP</code>, and is the
maximum of the lengths of the numerical arguments for the other functions.
</p>
<p>The numerical arguments other than <code>n</code> are recycled to the length of
the result. Only the first element of the logical arguments is used.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## density function for hyper-Poisson
dhP(3, 15, 2)
## distribution function for hyper-Poisson
phP(3, 15, 2)
## random generation for the hyper-Poisson
rhP(10, 15, 2)
</code></pre>

<hr>
<h2 id='lrtest'>Likelihood Ratio Test for Nested glm_CMP and glm_hP Fits</h2><span id='topic+lrtest'></span>

<h3>Description</h3>

<p>Performs the likelihood ratio chi-squared test to compare nested models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lrtest(object1, object2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lrtest_+3A_object1">object1</code>, <code id="lrtest_+3A_object2">object2</code></td>
<td>
<p>fitted objects of classes inheriting from
<code>"glm_CMP"</code> or <code>"glm_hP"</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The test statistics is calculated as <code class="reqn">2(llik- llik_0)</code>.
The test statistics has a chi-squared distribution with r degrees of freedom,
where r is the difference in the number of parameters between the full and
null models.
</p>


<h3>Value</h3>

<p>A list with class <code>"lrtest"</code> containing the following components:
</p>
<table>
<tr><td><code>statistics</code></td>
<td>
<p>the value of the statistic.</p>
</td></tr> <tr><td><code>df</code></td>
<td>
<p>the
degrees of freedom.</p>
</td></tr> <tr><td><code>p-value</code></td>
<td>
<p>the p-value for the test.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>Bids$size.sq &lt;- Bids$size ^ 2

## Fit null model
fit0 &lt;- glm.hP(formula.mu = numbids ~ leglrest + rearest + finrest +
              whtknght + bidprem + insthold + size + size.sq + regulatn,
              formula.gamma = numbids ~ 1, data = Bids)

## Fit full model
fit &lt;- glm.hP(formula.mu = numbids ~ leglrest + rearest + finrest +
              whtknght + bidprem + insthold + size + size.sq + regulatn,
              formula.gamma = numbids ~ leglrest, data = Bids)

## Likelihood ratio test for the nested models
lrtest(fit,fit0)
</code></pre>

<hr>
<h2 id='plots'>Plot Diagnostics for glm_hP and glm_CMP Objects</h2><span id='topic+plots'></span><span id='topic+plot.glm_hP'></span><span id='topic+plot.glm_CMP'></span>

<h3>Description</h3>

<p>Two plots are currently available: a plot of residuals against fitted values
and a Normal Q-Q plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'glm_hP'
plot(
  x,
  type = c("quantile", "pearson", "response"),
  ask = prod(graphics::par("mfcol")) &lt; 2 &amp;&amp; grDevices::dev.interactive(),
  ...
)

## S3 method for class 'glm_CMP'
plot(
  x,
  type = c("quantile", "pearson", "response"),
  ask = prod(graphics::par("mfcol")) &lt; 2 &amp;&amp; grDevices::dev.interactive(),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plots_+3A_x">x</code></td>
<td>
<p><code>glm_hP</code> or <code>glm_CMP</code> object, typically the result of
<code><a href="#topic+glm.hP">glm.hP</a></code> or <code><a href="#topic+glm.CMP">glm.CMP</a></code>.</p>
</td></tr>
<tr><td><code id="plots_+3A_type">type</code></td>
<td>
<p>the type of residuals. The alternatives are: &quot;quantile&quot;
(default), &quot;pearson&quot; and &quot;response&quot;. Can be abbreviated.</p>
</td></tr>
<tr><td><code id="plots_+3A_ask">ask</code></td>
<td>
<p>logical; if TRUE, the user is asked before each plot, see
<code><a href="graphics.html#topic+par">par</a></code>(ask=.).</p>
</td></tr>
<tr><td><code id="plots_+3A_...">...</code></td>
<td>
<p>other parameters to be passed through to plotting functions.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Fit the hyper-Poisson model
Bids$size.sq &lt;- Bids$size ^ 2
hP.fit &lt;- glm.hP(formula.mu = numbids ~ leglrest + rearest + finrest +
              whtknght + bidprem + insthold + size + size.sq + regulatn,
              formula.gamma = numbids ~ 1, data = Bids)
oldpar &lt;- par(mfrow = c(1, 2))

## Plot diagnostics

plot(hP.fit)
par(oldpar)
## Fit the COM-Poisson model
Bids$size.sq &lt;- Bids$size ^ 2
CMP.fit &lt;- glm.CMP(formula.mu = numbids ~ leglrest + rearest + finrest +
              whtknght + bidprem + insthold + size + size.sq + regulatn,
              formula.nu = numbids ~ 1, data = Bids)
oldpar &lt;- par(mfrow = c(1, 2))

## Plot diagnostics
plot(CMP.fit)
par(oldpar)
</code></pre>

<hr>
<h2 id='predict.glm_CMP'>Predict Method for glm_CMP Fits</h2><span id='topic+predict.glm_CMP'></span>

<h3>Description</h3>

<p>Obtains predictions from a fitted <code>glm_CMP</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'glm_CMP'
predict(object, newdata = NULL, type = c("link", "response"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.glm_CMP_+3A_object">object</code></td>
<td>
<p>a fitted object of class inheriting from <code>"glm_CMP"</code>.</p>
</td></tr>
<tr><td><code id="predict.glm_CMP_+3A_newdata">newdata</code></td>
<td>
<p>optionally, a data frame in which to look for variables with
which to predict. If omitted, the fitted linear predictors are used.</p>
</td></tr>
<tr><td><code id="predict.glm_CMP_+3A_type">type</code></td>
<td>
<p>the type of prediction required. The default is on the scale of
the linear predictors; the alternative <code>"response"</code> is on the scale of
the response variable.</p>
</td></tr>
<tr><td><code id="predict.glm_CMP_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector with the prediction means.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Fit a model
Bids$size.sq &lt;- Bids$size ^ 2
fit &lt;- glm.CMP(formula.mu = numbids ~ leglrest + rearest + finrest +
               whtknght + bidprem + insthold + size + size.sq + regulatn,
               formula.nu = numbids ~ 1, data = Bids)

## As the newdata parameter is not used the fitted values are obtained
predict(fit, type = "response")
</code></pre>

<hr>
<h2 id='predict.glm_hP'>Predict Method for glm_hP Fits</h2><span id='topic+predict.glm_hP'></span>

<h3>Description</h3>

<p>Obtains predictions from a fitted <code>"glm_hP"</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'glm_hP'
predict(object, newdata = NULL, type = c("link", "response"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.glm_hP_+3A_object">object</code></td>
<td>
<p>a fitted object of class inheriting from <code>"glm_hP"</code>.</p>
</td></tr>
<tr><td><code id="predict.glm_hP_+3A_newdata">newdata</code></td>
<td>
<p>optionally, a data frame in which to look for variables with
which to predict. If omitted, the fitted linear predictors are used.</p>
</td></tr>
<tr><td><code id="predict.glm_hP_+3A_type">type</code></td>
<td>
<p>the type of prediction required. The default is on the scale of
the linear predictors; the alternative <code>"response"</code> is on the scale of
the response variable.</p>
</td></tr>
<tr><td><code id="predict.glm_hP_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector with the prediction means.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Bids)
## Fit a hype-Poisson model
Bids$size.sq &lt;- Bids$size ^ 2
fit &lt;- glm.hP(formula.mu = numbids ~ leglrest + rearest + finrest +
              whtknght + bidprem + insthold + size + size.sq + regulatn,
              formula.gamma = numbids ~ 1, data = Bids)

## As the newdata parameter is not used the fitted values are obtained
predict(fit, type = "response")
</code></pre>

<hr>
<h2 id='residuals'>Extract and Visualize hyper-Poisson and COM-Poisson Model Residuals</h2><span id='topic+residuals'></span><span id='topic+residuals.glm_hP'></span><span id='topic+residuals.glm_CMP'></span>

<h3>Description</h3>

<p>residuals is a method which extracts model residuals from a <code>"glm_hP"</code>
or <code>"glm_CMP"</code> object, commonly returned by <code><a href="#topic+glm.hP">glm.hP</a></code> or
<code><a href="#topic+glm.CMP">glm.CMP</a></code>. Optionally, it produces a half normal plot with a
simulated envelope of the residuals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'glm_hP'
residuals(
  object,
  type = c("pearson", "response", "quantile"),
  envelope = FALSE,
  rep = 19,
  title = "Simulated Envelope of Residuals",
  ...
)

## S3 method for class 'glm_CMP'
residuals(
  object,
  type = c("pearson", "response", "quantile"),
  envelope = FALSE,
  rep = 19,
  title = "Simulated Envelope of Residuals",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="residuals_+3A_object">object</code></td>
<td>
<p>an object of class <code>"glm_hP"</code> or <code>"glm_CMP"</code>,
typically the result of a call to <code><a href="#topic+glm.hP">glm.hP</a></code> or
<code><a href="#topic+glm.CMP">glm.CMP</a></code>.</p>
</td></tr>
<tr><td><code id="residuals_+3A_type">type</code></td>
<td>
<p>the type of residuals which should be returned. The alternatives
are: &quot;pearson&quot; (default), &quot;response&quot; and &quot;quantile&quot;. Can be abbreviated.</p>
</td></tr>
<tr><td><code id="residuals_+3A_envelope">envelope</code></td>
<td>
<p>a logical value indicating whether the envelope should be
computed.</p>
</td></tr>
<tr><td><code id="residuals_+3A_rep">rep</code></td>
<td>
<p>number of replications for envelope construction. Default is 19,
that is the smallest 95 percent band that can be built.</p>
</td></tr>
<tr><td><code id="residuals_+3A_title">title</code></td>
<td>
<p>a string indicating the main title of the envelope.</p>
</td></tr>
<tr><td><code id="residuals_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The response residuals (<code class="reqn">r_i=y_i - \mu_i</code>), Pearson
residuals (<code class="reqn">r^P_i = r_i/\sigma_i</code>) or randomized
quantile residuals are computed. The randomized quantile residuals are
obtained computing the cumulative probabilities that the fitted model being
less than <em>y</em> and less or equal than <em>y</em>. A random value from a
uniform distribution between both probabilities is generated and the value of
the residual is the standard normal variate with the same cumulative
probability. Four replications of the quantile residuals are recommended
because of the random component (see Dunn and Smyth, 1996 for more details).
</p>
<p>The functions <code><a href="#topic+plot.glm_hP">plot.glm_hP</a></code> and <code><a href="#topic+plot.glm_CMP">plot.glm_CMP</a></code>
generate a residuals against fitted values plot and a Normal Q-Q plot.
</p>
<p>The Normal Q-Q plot may show an unsatisfactory pattern of the Pearson
residuals of a fitted model: then we are led to think that the model is
incorrectly specified.
The half normal plot with simulated envelope indicates that, under the
distribution of the response variable, the model is fine when only a few
points fall off the envelope.
</p>


<h3>Value</h3>

<p>Residual values.
</p>


<h3>References</h3>

<p>Peter K. Dunn and Gordon K. Smyth (1996). &quot;Randomized quantile
residuals&quot;. Journal of Computational and Graphical Statistics, 5(3), pp.
236-244.
</p>
<p>A. C. Atkinson (1981). &quot;Two graphical displays for outlying and influential
observations in regression&quot;. Biometrika, 68(1), pp. 13–20.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plots">plots</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Estimate a hyper-Poisson model
Bids$size.sq &lt;- Bids$size ^ 2
hP.fit &lt;- glm.hP(formula.mu = numbids ~ leglrest + rearest + finrest +
              whtknght + bidprem + insthold + size + size.sq + regulatn,
              formula.gamma = numbids ~ 1, data = Bids)

## Compute residuals

r &lt;- residuals(hP.fit)
## Estimate a COM-Poisson model

Bids$size.sq &lt;- Bids$size ^ 2
CMP.fit &lt;- glm.CMP(formula.mu = numbids ~ leglrest + rearest + finrest +
              whtknght + bidprem + insthold + size + size.sq + regulatn,
              formula.nu = numbids ~ 1, data = Bids)

## Compute its residuals

r &lt;- residuals(CMP.fit)
</code></pre>

<hr>
<h2 id='summary.glm_CMP'>Summarizing COM-Poisson Fits</h2><span id='topic+summary.glm_CMP'></span><span id='topic+print.summary.glm_CMP'></span>

<h3>Description</h3>

<p>These functions are all methods for class <code>"glm_CMP"</code> or
<code>summary.glm_CMP</code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'glm_CMP'
summary(object, ...)

## S3 method for class 'summary.glm_CMP'
print(
  x,
  digits = max(3, getOption("digits") - 3),
  signif.stars = getOption("show.signif.stars"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.glm_CMP_+3A_object">object</code></td>
<td>
<p>an object of class <code>"glm_CMP"</code>, usually, a result of a call
to <code>glm.CMP</code>.</p>
</td></tr>
<tr><td><code id="summary.glm_CMP_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
<tr><td><code id="summary.glm_CMP_+3A_x">x</code></td>
<td>
<p>an object of class <code>"summary.glm_CMP"</code>, usually, a result of a
call to <code>summary.glm_CMP</code>.</p>
</td></tr>
<tr><td><code id="summary.glm_CMP_+3A_digits">digits</code></td>
<td>
<p>the number of significant digits to use when printing.</p>
</td></tr>
<tr><td><code id="summary.glm_CMP_+3A_signif.stars">signif.stars</code></td>
<td>
<p>logical. If <code>TRUE</code>, &lsquo;significance stars&rsquo;
are printed for each coefficient.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Fit a COM-Poisson model
Bids$size.sq &lt;- Bids$size^2
fit &lt;- glm.CMP(formula.mu = numbids ~ leglrest + rearest + finrest +
               whtknght + bidprem + insthold + size + size.sq + regulatn,
               formula.nu = numbids ~ 1, data = Bids)

## Obtain a summary of the fitted model

summary(fit)
</code></pre>

<hr>
<h2 id='summary.glm_hP'>Summarizing hyper-Poisson Fits</h2><span id='topic+summary.glm_hP'></span><span id='topic+print.summary.glm_hP'></span>

<h3>Description</h3>

<p>These functions are all methods for class <code>"glm_hP"</code> or
<code>summary.glm_hP</code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'glm_hP'
summary(object, ...)

## S3 method for class 'summary.glm_hP'
print(
  x,
  digits = max(3, getOption("digits") - 3),
  signif.stars = getOption("show.signif.stars"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.glm_hP_+3A_object">object</code></td>
<td>
<p>an object of class <code>"glm_hP"</code>, usually, a result of a call
to <code>glm.hP</code>.</p>
</td></tr>
<tr><td><code id="summary.glm_hP_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
<tr><td><code id="summary.glm_hP_+3A_x">x</code></td>
<td>
<p>an object of class <code>"summary.glm_hP"</code>, usually, a result of a
call to <code>summary.glm_hP</code>.</p>
</td></tr>
<tr><td><code id="summary.glm_hP_+3A_digits">digits</code></td>
<td>
<p>the number of significant digits to use when printing.</p>
</td></tr>
<tr><td><code id="summary.glm_hP_+3A_signif.stars">signif.stars</code></td>
<td>
<p>logical. If <code>TRUE</code>, &lsquo;significance stars&rsquo;
are printed for each coefficient.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Fit a hyper-Poisson model

Bids$size.sq &lt;- Bids$size ^ 2
fit &lt;- glm.hP(formula.mu = numbids ~ leglrest + rearest + finrest +
              whtknght + bidprem + insthold + size + size.sq + regulatn,
              formula.gamma = numbids ~ 1, data = Bids)

## Obtain a summary of the fitted model

summary(fit)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
