<!DOCTYPE html><html><head><title>Help for package bgeva</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {bgeva}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bgeva-package'><p>Binary Generalized Extreme Value Additive Modelling</p></a></li>
<li><a href='#bg.checks'><p>Some convergence diagnostics</p></a></li>
<li><a href='#bgeva'><p>Binary Generalized Extreme Value Additive Modelling</p></a></li>
<li><a href='#bgeva.gIMa'><p>Internal Function</p></a></li>
<li><a href='#bgeva.gIMb'><p>Internal Function</p></a></li>
<li><a href='#bgevaObject'><p>Fitted bgeva object</p></a></li>
<li><a href='#plot.bgeva'><p>bgeva plotting</p></a></li>
<li><a href='#print.bgeva'><p>Print a bgeva object</p></a></li>
<li><a href='#print.summary.bgeva'><p>Print a summary.bgeva object</p></a></li>
<li><a href='#S.m'><p>Internal Function</p></a></li>
<li><a href='#summary.bgeva'><p>bgeva summary</p></a></li>
<li><a href='#working.comp'><p>Internal Function</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>0.3-1</td>
</tr>
<tr>
<td>Author:</td>
<td>Giampiero Marra, Raffaella Calabrese and Silvia Angela Osmetti </td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Giampiero Marra &lt;giampiero.marra@ucl.ac.uk&gt;</td>
</tr>
<tr>
<td>Title:</td>
<td>Binary Generalized Extreme Value Additive Models</td>
</tr>
<tr>
<td>Description:</td>
<td>Routine for fitting regression models for binary rare events with linear and nonlinear covariate effects when using the quantile function of the Generalized Extreme Value random variable.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.15.1), mgcv</td>
</tr>
<tr>
<td>Imports:</td>
<td>magic, trust</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="http://www.ucl.ac.uk/statistics/people/giampieromarra">http://www.ucl.ac.uk/statistics/people/giampieromarra</a></td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2017-05-19 06:07:36 UTC</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2017-05-18 19:03:43 UTC; Giampiero</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
</table>
<hr>
<h2 id='bgeva-package'>Binary Generalized Extreme Value Additive Modelling</h2><span id='topic+bgeva-package'></span>

<h3>Description</h3>

<p><code>bgeva</code> provides a function for univariate modelling for binary rare events data with linear and nonlinear predictor effects when using the quantile function of the Generalized Extreme Value random variable.
</p>


<h3>Details</h3>

<p><code>bgeva</code> provides a function for flexible regression models for binary rare events data. The underlying representation and 
estimation of the model is based on a penalized regression spline approach, with automatic smoothness selection. The 
numerical routine carries out function minimization using a trust region algorithm from the package <code>trust</code> in combination with
an adaptation of a low level smoothness selection fitting procedure from the package <code>mgcv</code>. 
</p>
<p><code><a href="#topic+bgeva">bgeva</a></code> supports the use of many smoothers as extracted from <code>mgcv</code>. Scale invariant tensor product smooths
are not currently supported. Estimation is by penalized maximum likelihood with automatic smoothness selection achieved 
by using the approximate Un-Biased Risk Estimator (UBRE). 
</p>
<p>Confidence intervals for smooth components are derived using a Bayesian approach. Approximate p-values for testing 
individual smooth terms for equality to the zero function are also provided. Functions <code><a href="#topic+plot.bgeva">plot.bgeva</a></code> and 
<code><a href="#topic+summary.bgeva">summary.bgeva</a></code> extract such information from a fitted <code><a href="#topic+bgevaObject">bgevaObject</a></code>. Variable 
selection is also possible via the use of shrinakge smoothers or information criteria. 
</p>
<p>Consider also using the faster and more stable version implemented in the <code>gamlss()</code> function of the 
<code>SemiParBIVProbit</code> package. <code>gamlss()</code> also allows for a much wider choice of smoothers.
</p>


<h3>Author(s)</h3>

<p>Raffaella Calabrese (University of Milano-Bicocca, Department of Statistics and Quantitative Methods), Giampiero Marra (University College London, Department of Statistical Science) and Silvia Osmetti (University Cattolica del Sacro Cuore, Department of Statistics) 
</p>
<p>Maintainer: Giampiero Marra <a href="mailto:giampiero.marra@ucl.ac.uk">giampiero.marra@ucl.ac.uk</a>
</p>


<h3>References</h3>

<p>Calabrese R., Marra G., Osmetti S.A. (2016), Bankruptcy Prediction of Small and Medium Enterprises Using a Flexible Binary Generalized Extreme Value Model. <em>Journal of the Operational Research Society</em>, 67(4), 604-615.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bgeva">bgeva</a></code>
</p>

<hr>
<h2 id='bg.checks'>Some convergence diagnostics</h2><span id='topic+bg.checks'></span>

<h3>Description</h3>

<p>It takes a fitted <code>bgeva</code> object produced by <code>bgeva()</code> and produces some diagnostic information about the fitting procedure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
bg.checks(x)


</code></pre>


<h3>Arguments</h3>

 
<table>
<tr><td><code id="bg.checks_+3A_x">x</code></td>
<td>
<p>A <code>bgeva</code> object produced by <code>bgeva()</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Maintainer: Giampiero Marra <a href="mailto:giampiero.marra@ucl.ac.uk">giampiero.marra@ucl.ac.uk</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bgeva">bgeva</a></code>
</p>

<hr>
<h2 id='bgeva'>Binary Generalized Extreme Value Additive Modelling</h2><span id='topic+bgeva'></span>

<h3>Description</h3>

 
<p><code>bgeva</code> can be used to fit regression models for binary rare events where the link function is the quantile function of 
the Generalized Extreme Value random variable. The linear predictor can be flexibly specified using parametric and 
regression spline components. Regression 
spline bases are extracted from the package <code>mgcv</code>. Multi-dimensional smooths are available 
via the use of penalized thin plate regression splines (isotropic). The current implementation does not support scale invariant tensor 
product smooths. 
</p>
<p>Consider also using the faster and more stable version implemented in the <code>gamlss()</code> function of the 
<code>SemiParBIVProbit</code> package. <code>gamlss()</code> also allows for a much wider choice of smoothers.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bgeva(formula.eq, data=list(), tau=-0.25, Hes=TRUE, gIM="a", iterlimSP=50, 
                  pr.tol=1e-6, 
                  gamma=1, aut.sp=TRUE, fp=FALSE, start.v=NULL, start.vo=1, 
                  rinit=1, rmax=100, fterm=sqrt(.Machine$double.eps), 
                  mterm=sqrt(.Machine$double.eps),   
                  control=list(maxit=50,tol=1e-6,step.half=25,
                               rank.tol=sqrt(.Machine$double.eps)))
</code></pre>


<h3>Arguments</h3>

 
<table>
<tr><td><code id="bgeva_+3A_formula.eq">formula.eq</code></td>
<td>
<p>A GAM formula. <code>s</code> terms are used to specify smooth functions of 
predictors. See the examples below and the documentation of <code>mgcv</code> for further details on GAM formula specifications.</p>
</td></tr> 
<tr><td><code id="bgeva_+3A_data">data</code></td>
<td>
<p>An optional data frame, list or environment containing the variables in the model.  If not found in <code>data</code>, the
variables are taken from <code>environment(formula)</code>, typically the environment from which <code>bgeva</code> is called.</p>
</td></tr> 
<tr><td><code id="bgeva_+3A_tau">tau</code></td>
<td>
<p>Shape parameter of the GEV distribution. It must be provided.</p>
</td></tr> 
<tr><td><code id="bgeva_+3A_hes">Hes</code></td>
<td>
<p>If <code>FALSE</code>, then the Fisher (rather than the observed) information matrix is employed.</p>
</td></tr>
<tr><td><code id="bgeva_+3A_gim">gIM</code></td>
<td>
<p>Different versions of GEV distribution. Options are <code>a</code> and <code>b</code>.</p>
</td></tr>
<tr><td><code id="bgeva_+3A_iterlimsp">iterlimSP</code></td>
<td>
<p>A positive integer specifying the maximum number of loops to be performed before the smoothing parameter estimation step is terminated.</p>
</td></tr> 
<tr><td><code id="bgeva_+3A_pr.tol">pr.tol</code></td>
<td>
<p>Tolerance to use in judging convergence of the algorithm when automatic smoothing parameter selection is used.</p>
</td></tr> 
<tr><td><code id="bgeva_+3A_gamma">gamma</code></td>
<td>
<p>It is an inflation factor for the model degrees of freedom in the UBRE score. Smoother models can be obtained setting 
this parameter to a value greater than 1. Typically <code>gamma=1.4</code> achieves this.</p>
</td></tr>
<tr><td><code id="bgeva_+3A_aut.sp">aut.sp</code></td>
<td>
<p>If <code>TRUE</code>, then automatic multiple smoothing parameter selection is carried out. If <code>FALSE</code>, then smoothing parameters 
are set to the values obtained from the univariate fits.</p>
</td></tr>
<tr><td><code id="bgeva_+3A_fp">fp</code></td>
<td>
<p>If <code>TRUE</code>, then a fully parametric model with regression splines is fitted. See the example below.</p>
</td></tr>  
<tr><td><code id="bgeva_+3A_start.v">start.v</code></td>
<td>
<p>Starting values for the parameters can be provided here.</p>
</td></tr>  
<tr><td><code id="bgeva_+3A_start.vo">start.vo</code></td>
<td>
<p>Default is 1 meaning that starting values are obtained from fitting a logistic model. Otherwise, these can be set as described in Calabrese and Osmetti (2013) (<code>start.vo=2</code>) or from a 
combination of options 1 and 2 (<code>start.vo=3</code>).</p>
</td></tr> 
<tr><td><code id="bgeva_+3A_rinit">rinit</code></td>
<td>
<p>Starting trust region radius. The trust region radius is adjusted as the algorithm proceeds. See the documentation
of <code>trust</code> for further details.</p>
</td></tr>
<tr><td><code id="bgeva_+3A_rmax">rmax</code></td>
<td>
<p>Maximum allowed trust region radius. This may be set very large. If set small, the algorithm traces a steepest 
descent path.</p>
</td></tr>        
<tr><td><code id="bgeva_+3A_fterm">fterm</code></td>
<td>
<p>Positive scalar giving the tolerance at which the difference in objective function values in a step is considered close 
enough to zero to terminate the algorithm.</p>
</td></tr>
<tr><td><code id="bgeva_+3A_mterm">mterm</code></td>
<td>
<p>Positive scalar giving the tolerance at which the two-term Taylor-series approximation to the difference in objective 
function values in a step is considered close enough to zero to terminate the algorithm.</p>
</td></tr>
<tr><td><code id="bgeva_+3A_control">control</code></td>
<td>
<p>It is a list containing iteration control constants with the following elements: <code>maxit</code>: maximum number of iterations of the 
<code>magic</code> algorithm; <code>tol</code>: tolerance to use in judging convergence; <code>step.half</code>: if a trial step fails then 
the method tries halving it up to a maximum of <code>step.half</code> times; <code>rank.tol</code>: constant used to test for numerical rank 
deficiency of the problem. See the documentation of <code>magic</code> in <code>mgcv</code> for further details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Binary Generalized Extreme Value Additive model has the quantile function of the Generalized Extreme Value (GEV) random variable as link 
function. The linear predictor is flexibly specified using 
parametric components and smooth functions of covariates. Replacing the smooth components with their regression 
spline expressions yields a fully parametric univariate GEV model. In principle, classic 
maximum likelihood estimation can be employed. However, to avoid overfitting, penalized likelihood maximization has to be employed instead. Here the 
use of 
penalty matrices allows for the suppression of that part of smooth term complexity which has no support from the data. The trade-off 
between smoothness 
and fitness is controlled by smoothing parameters associated with the penalty matrices. Smoothing parameters are chosen to 
minimize the approximate Un-Biased Risk Estimator (UBRE).
</p>
<p>More details can be found in Calabrese, Marra and Osmetti (2016).
</p>
<p>Consider also using the faster and more stable version implemented in the <code>gamlss()</code> function of the 
<code>SemiParBIVProbit</code> package. <code>gamlss()</code> also allows for a much wider choice of smoothers.
</p>


<h3>Value</h3>

<p>The function returns an object of class <code>bgeva</code> as described in <code>bgevaObject</code>.
</p>


<h3>WARNINGS</h3>

<p>Any automatic smoothing parameter selection procedure is not likely to work well when the data have low information content. In binary models, this 
issue is especially relevant the number of observations low. Here, convergence failure is
typically associated with an infinite cycling between the two steps detailed above. If this occurs, as some practical solutions, one might 
either (i) lower the total number of parameters to estimate by reducing the dimension of the regression spline 
bases, (ii) set the smoothing parameters to the values obtained from the univariate fits (<code>aut.sp=FALSE</code>), or (iii) set the smoothing 
parameters to the values obtained from the non-converged algorithm. The default option is (iii).
</p>
<p>The GEV distribution may not be defined for certain combinations of parameter and covariate values. In such cases, a sub-design matrix is formed. This 
consists of the rows (of the original design matrix) for which the distributrion is defined.
</p>


<h3>Author(s)</h3>

<p>Maintainer: Giampiero Marra <a href="mailto:giampiero.marra@ucl.ac.uk">giampiero.marra@ucl.ac.uk</a>
</p>


<h3>References</h3>

<p>Calabrese R., Marra G., Osmetti S.A. (2016), Bankruptcy Prediction of Small and Medium Enterprises Using a Flexible Binary Generalized Extreme Value Model. <em>Journal of the Operational Research Society</em>, 67(4), 604-615.
</p>
<p>Gu C. (1992), Cross validating non-Gaussian data. <em>Journal of Computational and Graphical Statistics</em>, 1(2), 169-179.
</p>
<p>Wood S.N. (2004), Stable and efficient multiple smoothing parameter estimation for generalized additive models. <em>Journal of the American Statistical Association</em>, 99(467), 673-686.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.bgeva">plot.bgeva</a></code>, <code><a href="#topic+bgeva-package">bgeva-package</a></code>, <code><a href="#topic+bgevaObject">bgevaObject</a></code>, <code><a href="#topic+summary.bgeva">summary.bgeva</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(bgeva)

##########
## EXAMPLE 
##########

set.seed(0)

n &lt;- 1500

x1 &lt;- round(runif(n))
x2 &lt;- runif(n)
x3 &lt;- runif(n)

f1 &lt;- function(x) (cos(pi*2*x)) + sin(pi*x)
f2 &lt;- function(x) (x+exp(-30*(x-0.5)^2))   

y &lt;- as.integer(rlogis(n, location = -6 + 2*x1 + f1(x2) + f2(x3), scale = 1) &gt; 0)

dataSim &lt;- data.frame(y,x1,x2,x3)

out &lt;- bgeva(y ~ x1 + s(x2) + s(x3))
bg.checks(out)

summary(out)
plot(out,scale=0,pages=1,shade=TRUE)


#
#

</code></pre>

<hr>
<h2 id='bgeva.gIMa'>Internal Function</h2><span id='topic+bgeva.gIMa'></span>

<h3>Description</h3>

<p>It provides the log-likelihood, gradient and Hessian (or Fisher) information matrix for penalized or unpenalized maximum likelihood optimization.</p>


<h3>Author(s)</h3>

<p>Maintainer: Giampiero Marra <a href="mailto:giampiero.marra@ucl.ac.uk">giampiero.marra@ucl.ac.uk</a>
</p>

<hr>
<h2 id='bgeva.gIMb'>Internal Function</h2><span id='topic+bgeva.gIMb'></span>

<h3>Description</h3>

<p>It provides an alternative version of the log-likelihood, gradient and Hessian (or Fisher) information matrix for penalized or unpenalized maximum likelihood optimization.</p>


<h3>Author(s)</h3>

<p>Maintainer: Giampiero Marra <a href="mailto:giampiero.marra@ucl.ac.uk">giampiero.marra@ucl.ac.uk</a>
</p>

<hr>
<h2 id='bgevaObject'>Fitted bgeva object</h2><span id='topic+bgevaObject'></span>

<h3>Description</h3>

<p>A fitted Binary Generalized Extreme Value Additive object returned by function <code>bgeva</code> and of class.</p>


<h3>Value</h3>

 
<table>
<tr><td><code>fit</code></td>
<td>
<p>A list of values and diagnostics extracted from the output of the algorithm. For instance, <code>fit$argument</code> and <code>fit$S.h</code> return
the estimated parameters and overall penalty matrix scaled by its smoothing parameters, for the model. See the 
documentation of <code>trust</code> for diagnostics.</p>
</td></tr>
<tr><td><code>coefficients</code></td>
<td>
<p>The coefficients of the fitted model provided as follows. Parametric and regression spline
coefficients.</p>
</td></tr>
<tr><td><code>gam.fit</code></td>
<td>
<p>A univariate logistic additive model object. See the documentation of <code>mgcv</code> for full details.</p>
</td></tr>
<tr><td><code>sp</code></td>
<td>
<p>Estimated smoothing parameters of the smooth components for the fitted model.</p>
</td></tr>
<tr><td><code>fp</code></td>
<td>
<p>If <code>TRUE</code>, then a fully parametric model was fitted.</p>
</td></tr> 
<tr><td><code>iter.sp</code></td>
<td>
<p>Number of iterations performed for the smoothing parameter estimation step.</p>
</td></tr>
<tr><td><code>iter.if</code></td>
<td>
<p>Number of iterations performed in the initial step of the algorithm.</p>
</td></tr>
<tr><td><code>iter.inner</code></td>
<td>
<p>Number of iterations performed inside smoothing parameter estimation step.</p>
</td></tr>
<tr><td><code>tau</code></td>
<td>
<p>The tail parameter of the link function.</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>Sample size.</p>
</td></tr>
<tr><td><code>X</code></td>
<td>
<p>It returns the design matrix associated with the linear predictor.</p>
</td></tr>
<tr><td><code>Xr</code></td>
<td>
<p>It returns the design matrix actually used in model fitting.</p>
</td></tr>
<tr><td><code>good</code></td>
<td>
<p>It returns a vector indicating which observations have been discarded in the final iteration.</p>
</td></tr>
<tr><td><code>X.d2</code></td>
<td>
<p>Number of columns of the design matrix. This is used for internal calculations.</p>
</td></tr>
<tr><td><code>l.sp</code></td>
<td>
<p>Number of smooth components.</p>
</td></tr>
<tr><td><code>He</code></td>
<td>
<p>Penalized hessian.</p>
</td></tr>
<tr><td><code>HeSh</code></td>
<td>
<p>Unpenalized hessian.</p>
</td></tr>
<tr><td><code>Vb</code></td>
<td>
<p>Inverse of the penalized hessian. This corresponds to the Bayesian variance-covariance matrix used for &lsquo;confidence&rsquo; interval calculations.</p>
</td></tr>
<tr><td><code>F</code></td>
<td>
<p>This is given by <code>Vb*HeSh</code>.</p>
</td></tr> 
<tr><td><code>t.edf</code></td>
<td>
<p>Total degrees of freedom of the estimated model. It is calculated as <code>sum(diag(F))</code>.</p>
</td></tr>
<tr><td><code>bs.mgfit</code></td>
<td>
<p>A list of values and diagnostics extracted from <code>magic</code>.</p>
</td></tr>
<tr><td><code>conv.sp</code></td>
<td>
<p>If <code>TRUE</code> then the smoothing parameter selection algorithm converged.</p>
</td></tr>
<tr><td><code>wor.c</code></td>
<td>
<p>It contains the working model quantities given by the square root of 
the weight matrix times the pseudo-data vector and design matrix, <code>rW.Z</code> and <code>rW.X</code>.</p>
</td></tr>                
<tr><td><code>eta</code></td>
<td>
<p>The estimated linear predictor.</p>
</td></tr>
<tr><td><code>logL</code></td>
<td>
<p>It returns the value of the (unpenalized) log-likelihood evaluated at the (penalized or unpenalized) parameter 
estimates.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Maintainer: Giampiero Marra <a href="mailto:giampiero.marra@ucl.ac.uk">giampiero.marra@ucl.ac.uk</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bgeva">bgeva</a></code>, <code><a href="#topic+plot.bgeva">plot.bgeva</a></code>, <code><a href="#topic+summary.bgeva">summary.bgeva</a></code>
</p>

<hr>
<h2 id='plot.bgeva'>bgeva plotting</h2><span id='topic+plot.bgeva'></span>

<h3>Description</h3>

<p>It takes a fitted <code>bgeva</code> object produced by <code>bgeva()</code> and plots the 
component smooth functions that make it up on the scale of the linear predictor. 
</p>
<p>This function is based on <code>plot.gam()</code> in <code>mgcv</code>. Please see the documentation of <code>plot.gam()</code> for full details. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bgeva'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

 
<table>
<tr><td><code id="plot.bgeva_+3A_x">x</code></td>
<td>
<p>A fitted <code>bgeva</code> object as produced by <code>bgeva()</code>.</p>
</td></tr>
<tr><td><code id="plot.bgeva_+3A_...">...</code></td>
<td>
<p>Other graphics parameters to pass on to plotting commands, as described for <code>plot.gam</code> in <code>mgcv</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function produces plot showing the smooth terms of a fitted semiparametric bivariate probit model. For plots 
of 1-D smooths, the x axis of each plot is labelled using the name of the regressor, while the y axis is labelled as <code>s(regr,edf)</code> 
where <code>regr</code> is the regressor name, and <code>edf</code> the estimated degrees of freedom of the smooth. As for 2-D smooths, perspective plots are produced with the x-axes labelled with the first and second variable names and the y axis 
is labelled as <code>s(var1,var2,edf)</code>, which indicates the variables of which the term is a function and the <code>edf</code> for the term. 
</p>
<p>If <code>seWithMean=TRUE</code>, then the confidence intervals include the uncertainty about the overall mean. That is, 
although each smooth is shown centred, the confidence intervals are obtained as if every other term in the model was 
constrained to have average 0 (average taken over the covariate values) except for the smooth being plotted. The theoretical arguments 
and simulation study of Marra and Wood (2012) suggests that <code>seWithMean=TRUE</code> results in intervals with
close to nominal frequentist coverage probabilities. This option should not be used when fitting a random effect model.
</p>


<h3>Value</h3>

<p>The function generates plots.
</p>


<h3>WARNING</h3>

 
<p>The function can not deal with smooths of more than 2 variables.
</p>


<h3>Author(s)</h3>

<p>Maintainer: Giampiero Marra <a href="mailto:giampiero.marra@ucl.ac.uk">giampiero.marra@ucl.ac.uk</a>
</p>


<h3>References</h3>

<p>Marra G. and Wood S.N. (2012), Coverage Properties of Confidence Intervals for Generalized Additive Model Components. <em>Scandinavian Journal of Statistics</em>, 39(1), 53-74.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bgeva">bgeva</a></code>, <code><a href="#topic+summary.bgeva">summary.bgeva</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## see examples for bgeva
</code></pre>

<hr>
<h2 id='print.bgeva'>Print a bgeva object</h2><span id='topic+print.bgeva'></span>

<h3>Description</h3>

<p>The print method for a <code>bgeva</code> object.</p>


<h3>Usage</h3>

<pre><code class='language-R'>

## S3 method for class 'bgeva'
print(x,...)


</code></pre>


<h3>Arguments</h3>

 
<table>
<tr><td><code id="print.bgeva_+3A_x">x</code></td>
<td>
<p>A <code>bgeva</code> object produced by <code>bgeva()</code>.</p>
</td></tr>
<tr><td><code id="print.bgeva_+3A_...">...</code></td>
<td>
<p>Other arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

 
<p><code>print.bgeva</code> prints out the family, model equation, total number of observations, chosen tail 
parameter and estimated total effective degrees of freedom for the penalized or unpenalized model. 
</p>


<h3>Author(s)</h3>

<p>Maintainer: Giampiero Marra <a href="mailto:giampiero.marra@ucl.ac.uk">giampiero.marra@ucl.ac.uk</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bgeva">bgeva</a></code>
</p>

<hr>
<h2 id='print.summary.bgeva'>Print a summary.bgeva object</h2><span id='topic+print.summary.bgeva'></span>

<h3>Description</h3>

<p>The print method for a <code>summary.bgeva</code> object.</p>


<h3>Usage</h3>

<pre><code class='language-R'>

## S3 method for class 'summary.bgeva'
print(x,digits = max(3, getOption("digits") - 3), 
           signif.stars = getOption("show.signif.stars"),...)


</code></pre>


<h3>Arguments</h3>

 
<table>
<tr><td><code id="print.summary.bgeva_+3A_x">x</code></td>
<td>
<p>A <code>summary.bgeva</code> object produced by <code>summary.bgeva()</code>.</p>
</td></tr>
<tr><td><code id="print.summary.bgeva_+3A_digits">digits</code></td>
<td>
<p>Number of digits printed in output.</p>
</td></tr> 
<tr><td><code id="print.summary.bgeva_+3A_signif.stars">signif.stars</code></td>
<td>
<p>By default significance stars are printed alongside output.</p>
</td></tr> 
<tr><td><code id="print.summary.bgeva_+3A_...">...</code></td>
<td>
<p>Other arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

 
<p><code>print.summary.bgeva</code> prints model term summaries. 
</p>


<h3>Author(s)</h3>

<p>Maintainer: Giampiero Marra <a href="mailto:giampiero.marra@ucl.ac.uk">giampiero.marra@ucl.ac.uk</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+summary.bgeva">summary.bgeva</a></code>
</p>

<hr>
<h2 id='S.m'>Internal Function</h2><span id='topic+S.m'></span>

<h3>Description</h3>

<p>It provides penalty matrices in a format suitable for the automatic smoothness selection procedure.</p>


<h3>Author(s)</h3>

<p>Maintainer: Giampiero Marra <a href="mailto:giampiero.marra@ucl.ac.uk">giampiero.marra@ucl.ac.uk</a>
</p>

<hr>
<h2 id='summary.bgeva'>bgeva summary</h2><span id='topic+summary.bgeva'></span>

<h3>Description</h3>

<p>It takes a fitted <code>bgeva</code> object produced by <code>bgeva()</code> and produces some summaries from it.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
## S3 method for class 'bgeva'
summary(object,s.meth="svd",sig.lev=0.05,...)

                         
</code></pre>


<h3>Arguments</h3>

 
<table>
<tr><td><code id="summary.bgeva_+3A_object">object</code></td>
<td>
<p>A fitted <code>bgeva</code> object as produced by <code>bgeva()</code>.</p>
</td></tr>
<tr><td><code id="summary.bgeva_+3A_s.meth">s.meth</code></td>
<td>
<p>Matrix decomposition used to determine the matrix root of the covariance matrix. See the documentation of <code>mvtnorm</code> for further details.</p>
</td></tr> 
<tr><td><code id="summary.bgeva_+3A_sig.lev">sig.lev</code></td>
<td>
<p>Significance level used for intervals obtained via posterior simulation.</p>
</td></tr> 
<tr><td><code id="summary.bgeva_+3A_...">...</code></td>
<td>
<p>Other arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

 
<p>As in the package <code>mgcv</code>, based on the results of Wood (2013), &lsquo;Bayesian p-values&rsquo; are returned for the smooth terms. These have 
better frequentist performance than their frequentist counterpart. Let <code class="reqn">\hat{\bf f}</code>
and <code class="reqn">{\bf V}_f</code> denote the vector of values of a smooth term evaluated at the original covariate values and the
corresponding Bayesian covariance matrix, and let <code class="reqn">{\bf V}_f^{r-}</code> denote 
the rank <code class="reqn">r</code> pseudoinverse of <code class="reqn">{\bf V}_f</code>. The statistic used 
is <code class="reqn">T=\hat{\bf f}^\prime {\bf V}_f^{r-} \hat{\bf f}</code>. This is 
compared to a chi-squared distribution with degrees of freedom given by <code class="reqn">r</code>, which is obtained by 
biased rounding of the estimated degrees of freedom. See Wood (2013) for further details. 
</p>
<p>Note that covariate selection can also be achieved using a single penalty shrinkage approach as shown in Marra and Wood (2011). 
</p>
<p>Consider also using the version of the model implemented in the <code>gamlss()</code> function of the 
<code>SemiParBIVProbit</code> package, where p-value calculations are more rigorous.
</p>


<h3>Value</h3>

<table>
<tr><td><code>tableP</code></td>
<td>
<p>It returns a table containing parametric estimates, their standard errors, z-values and p-values.</p>
</td></tr>
<tr><td><code>tableNP</code></td>
<td>
<p>It returns a table of nonparametric summaries for each smooth component including estimated degrees of freedom, estimated rank, approximate Wald statistic for testing the null hypothesis that the smooth term is zero, and p-value.</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>Sample size.</p>
</td></tr>
<tr><td><code>tau</code></td>
<td>
<p>Tail parameter of the link function.</p>
</td></tr>
<tr><td><code>formula</code></td>
<td>
<p>The original GAM formula used.</p>
</td></tr>
<tr><td><code>l.sp</code></td>
<td>
<p>Number of smooth components.</p>
</td></tr>
<tr><td><code>t.edf</code></td>
<td>
<p>Total degrees of freedom of the estimated model.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Maintainer: Giampiero Marra <a href="mailto:giampiero.marra@ucl.ac.uk">giampiero.marra@ucl.ac.uk</a>
</p>


<h3>References</h3>

<p>Marra G. and Wood S.N. (2011), Practical Variable Selection for Generalized Additive Models. <em>Computational Statistics and Data Analysis</em>, 55(7), 2372-2387.
</p>
<p>Wood, S.N. (2013). On p-values for smooth components of an extended generalized additive model. <em>Biometrika</em>, 100(1), 221-228.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bgevaObject">bgevaObject</a></code>, <code><a href="#topic+plot.bgeva">plot.bgeva</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## see examples for bgeva
</code></pre>

<hr>
<h2 id='working.comp'>Internal Function</h2><span id='topic+working.comp'></span>

<h3>Description</h3>

<p>It efficiently calculates the working model quantities needed to implement the automatic multiple smoothing parameter 
procedure by exploiting the band structure of the weight matrix.</p>


<h3>Author(s)</h3>

<p>Maintainer: Giampiero Marra <a href="mailto:giampiero.marra@ucl.ac.uk">giampiero.marra@ucl.ac.uk</a>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
