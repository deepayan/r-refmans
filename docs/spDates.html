<!DOCTYPE html><html><head><title>Help for package spDates</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {spDates}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#centers'><p>Coordinates of 9 sites considered as potential centers of origin of the</p>
Neolithic expansion. Modified from Pinhasi et al. (2005).</a></li>
<li><a href='#filterDates'><p>Filter archaeological site coordinates and dates, retaining only the</p>
earliest radiocarbon date per site.</a></li>
<li><a href='#interpolateIDW'><p>Interpolate using inverse distance weighting.</p></a></li>
<li><a href='#iterateSites'><p>Perform regression of dates versus distances from multiple potential origins</p>
in order to find the best model. It is also possible to specify multiple
distances for the spatial binning of the dates.</a></li>
<li><a href='#land'><p>Land polygons.</p></a></li>
<li><a href='#modelDates'><p>Perform regression of archaeological dates on great circle distances from</p>
a hypothetical origin. Dates can be filtered to retain only the earliest
dates per distance bins (Hamilton and Buchanan 2007). Bootstrap is executed
to account for uncertainty in calibrated dates. Regression can be either
reduced major axis or ordinary least squares. If using ordinary least
squares, regression is performed both on time-versus-distance and on
distance-versus-time.</a></li>
<li><a href='#neof'><p>Radiocarbon dates and coordinates of 717 Neolithic sites in the Near East</p>
and Europe. Modified from Pinhasi et al. (2005). Only the earliest dates
per site are included.</a></li>
<li><a href='#plot.dateMap'><p>Plot a map with the results of the iteration over multiple sites, showing</p>
an interpolated surface of r values for the sites considered as potential
origins.</a></li>
<li><a href='#plot.dateModel'><p>Plot the results of the regression bootstrap on archaeological dates versus</p>
distances from a hypothetical origin, with fitted lines.</a></li>
<li><a href='#sampleCalDates'><p>Extract a single year estimate for ranges of calibrated dates with a</p>
probability given by the calibrated probability distribution.</a></li>
<li><a href='#summary.dateModel'><p>Return summary statistics for a dateModel object.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Analysis of Spatial Gradients in Radiocarbon Dates</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Inspired by space-time regressions often performed to assess
    the expansion of the Neolithic from the Near East to Europe (Pinhasi et
    al. 2005 &lt;<a href="https://doi.org/10.1371%2Fjournal.pbio.0030410">doi:10.1371/journal.pbio.0030410</a>&gt;). Test for significant
    correlations between the (earliest) radiocarbon dates of archaeological
    sites and their respective distances from a hypothetical center of origin.
    Both ordinary least squares (OLS) and reduced major axis (RMA) methods
    are supported (Russell et al. 2014 &lt;<a href="https://doi.org/10.1371%2Fjournal.pone.0087854">doi:10.1371/journal.pone.0087854</a>&gt;).
    It is also possible to iterate over many sites to identify the most likely
    origin.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), rcarbon</td>
</tr>
<tr>
<td>Imports:</td>
<td>data.table, dplyr, ggplot2, parallel, raster, smatr,
viridisLite, magrittr, rlang, sp, gstat</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-10-09 10:07:53 UTC; jgregoriods</td>
</tr>
<tr>
<td>Author:</td>
<td>Jonas Gregorio de Souza
    <a href="https://orcid.org/0000-0001-6032-4443"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jonas Gregorio de Souza &lt;jonas.gregorio@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-10-09 10:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='centers'>Coordinates of 9 sites considered as potential centers of origin of the
Neolithic expansion. Modified from Pinhasi et al. (2005).</h2><span id='topic+centers'></span>

<h3>Description</h3>

<p>Coordinates of 9 sites considered as potential centers of origin of the
Neolithic expansion. Modified from Pinhasi et al. (2005).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>centers
</code></pre>


<h3>Format</h3>

<p>A data frame with 9 rows and 3 variables.
</p>

<ul>
<li><p> Latitude. Site latitude in decimal degrees.
</p>
</li>
<li><p> Longitude. Site longitude in decimal degrees.
</p>
</li>
<li><p> Site. Site name.
</p>
</li></ul>


<hr>
<h2 id='filterDates'>Filter archaeological site coordinates and dates, retaining only the
earliest radiocarbon date per site.</h2><span id='topic+filterDates'></span>

<h3>Description</h3>

<p>Filter archaeological site coordinates and dates, retaining only the
earliest radiocarbon date per site.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>filterDates(sites, c14bp)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="filterDates_+3A_sites">sites</code></td>
<td>
<p>A SpatialPointsDataFrame object with archaeological sites and
associated radiocarbon ages.</p>
</td></tr>
<tr><td><code id="filterDates_+3A_c14bp">c14bp</code></td>
<td>
<p>A string. Name of the field with the radiocarbon ages in C14 BP
format.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A SpatialPointsDataFrame object with the earliest C14 date for every
site.
</p>

<hr>
<h2 id='interpolateIDW'>Interpolate using inverse distance weighting.</h2><span id='topic+interpolateIDW'></span>

<h3>Description</h3>

<p>Interpolate using inverse distance weighting.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>interpolateIDW(points, attr)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="interpolateIDW_+3A_points">points</code></td>
<td>
<p>A SpatialPointsDataFrame object.</p>
</td></tr>
<tr><td><code id="interpolateIDW_+3A_attr">attr</code></td>
<td>
<p>A string. Name of the field with values to interpolate.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A RasterLayer.
</p>

<hr>
<h2 id='iterateSites'>Perform regression of dates versus distances from multiple potential origins
in order to find the best model. It is also possible to specify multiple
distances for the spatial binning of the dates.</h2><span id='topic+iterateSites'></span>

<h3>Description</h3>

<p>Perform regression of dates versus distances from multiple potential origins
in order to find the best model. It is also possible to specify multiple
distances for the spatial binning of the dates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>iterateSites(
  ftrSites,
  c14bp,
  origins,
  siteNames,
  binWidths = 0,
  nsim = 999,
  method = "rma",
  ncores = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="iterateSites_+3A_ftrsites">ftrSites</code></td>
<td>
<p>A SpatialPointsDataFrame object with associated earliest
C14 dates per site and respective calibrated distributions (CalDates
objects) in a field named &quot;cal&quot;.</p>
</td></tr>
<tr><td><code id="iterateSites_+3A_c14bp">c14bp</code></td>
<td>
<p>A string. Name of the field with the radiocarbon ages in C14
BP format.</p>
</td></tr>
<tr><td><code id="iterateSites_+3A_origins">origins</code></td>
<td>
<p>A SpatialPointsDataFrame object. The sites to be tested for
the most likely origin of expansion.</p>
</td></tr>
<tr><td><code id="iterateSites_+3A_sitenames">siteNames</code></td>
<td>
<p>A string. Name of the field with the site names or ids for
the potential origins.</p>
</td></tr>
<tr><td><code id="iterateSites_+3A_binwidths">binWidths</code></td>
<td>
<p>A number or vector of numbers. Width(s) of the spatial bins
in km.</p>
</td></tr>
<tr><td><code id="iterateSites_+3A_nsim">nsim</code></td>
<td>
<p>A number. Number of simulations to be run during the
bootstrapping procedure. Default is 999.</p>
</td></tr>
<tr><td><code id="iterateSites_+3A_method">method</code></td>
<td>
<p>A string. Method to be used in the regression. One of &quot;rma&quot;
or &quot;ols&quot;. Default is &quot;rma&quot;.</p>
</td></tr>
<tr><td><code id="iterateSites_+3A_ncores">ncores</code></td>
<td>
<p>A number. Number of cores used for parallel processing.
Default is 1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list with two elements, the result of the iteration over all
potential origins and the best model selected among those.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(neof)
data(centers)
iter &lt;- iterateSites(neof, "C14Age", centers, "Site", binWidths=500)

</code></pre>

<hr>
<h2 id='land'>Land polygons.</h2><span id='topic+land'></span>

<h3>Description</h3>

<p>Land polygons.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>land
</code></pre>


<h3>Format</h3>

<p>A SpatialPolygonsDataFrame object.
</p>

<hr>
<h2 id='modelDates'>Perform regression of archaeological dates on great circle distances from
a hypothetical origin. Dates can be filtered to retain only the earliest
dates per distance bins (Hamilton and Buchanan 2007). Bootstrap is executed
to account for uncertainty in calibrated dates. Regression can be either
reduced major axis or ordinary least squares. If using ordinary least
squares, regression is performed both on time-versus-distance and on
distance-versus-time.</h2><span id='topic+modelDates'></span>

<h3>Description</h3>

<p>Perform regression of archaeological dates on great circle distances from
a hypothetical origin. Dates can be filtered to retain only the earliest
dates per distance bins (Hamilton and Buchanan 2007). Bootstrap is executed
to account for uncertainty in calibrated dates. Regression can be either
reduced major axis or ordinary least squares. If using ordinary least
squares, regression is performed both on time-versus-distance and on
distance-versus-time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>modelDates(
  ftrSites,
  c14bp,
  origin,
  binWidth = 0,
  nsim = 999,
  method = "rma",
  ncores = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="modelDates_+3A_ftrsites">ftrSites</code></td>
<td>
<p>A SpatialPointsDataFrame object with associated earliest
C14 dates per site and respective calibrated distributions (CalDates
objects) in a field named &quot;cal&quot;. Result of applying filterDates() and
calAll().</p>
</td></tr>
<tr><td><code id="modelDates_+3A_c14bp">c14bp</code></td>
<td>
<p>A string. Name of the field with the radiocarbon ages in C14
BP format.</p>
</td></tr>
<tr><td><code id="modelDates_+3A_origin">origin</code></td>
<td>
<p>A SpatialPointsDataFrame object. The site considered as
hypothetical origin of expansion.</p>
</td></tr>
<tr><td><code id="modelDates_+3A_binwidth">binWidth</code></td>
<td>
<p>A number. Width of the spatial bins in km, calculated as
distance intervals from the hypothetical origin. Default is 0 (no bins).</p>
</td></tr>
<tr><td><code id="modelDates_+3A_nsim">nsim</code></td>
<td>
<p>A number. Number of simulations to be run during the
bootstrapping procedure. Default is 999.</p>
</td></tr>
<tr><td><code id="modelDates_+3A_method">method</code></td>
<td>
<p>A string. Method to be used in the regression. One of &quot;rma&quot;
or &quot;ols&quot;. Default is &quot;rma&quot;.</p>
</td></tr>
<tr><td><code id="modelDates_+3A_ncores">ncores</code></td>
<td>
<p>A number. Number of cores used for parallel processing.
Default is 1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a dateModel object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(neof)
data(centers)
jericho &lt;- centers[centers$Site=="Jericho",]
model &lt;- modelDates(neof, "C14Age", jericho, method="ols")


</code></pre>

<hr>
<h2 id='neof'>Radiocarbon dates and coordinates of 717 Neolithic sites in the Near East
and Europe. Modified from Pinhasi et al. (2005). Only the earliest dates
per site are included.</h2><span id='topic+neof'></span>

<h3>Description</h3>

<p>Radiocarbon dates and coordinates of 717 Neolithic sites in the Near East
and Europe. Modified from Pinhasi et al. (2005). Only the earliest dates
per site are included.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>neof
</code></pre>


<h3>Format</h3>

<p>A data frame with 717 rows and 13 variables.
</p>

<ul>
<li><p> Latitude. Site latitude in decimal degrees.
</p>
</li>
<li><p> Longitude. Site longitude in decimal degrees.
</p>
</li>
<li><p> Site. Site name.
</p>
</li>
<li><p> Location. Region where the site is located (Near East, Europe etc).
</p>
</li>
<li><p> Country. Country where the site is located.
</p>
</li>
<li><p> Period. Site period or culture (PPNA, PPNB, LBK etc.).
</p>
</li>
<li><p> LabNumber. Laboratory number of the C14 date.
</p>
</li>
<li><p> C14Age. Date in C14 years BP.
</p>
</li>
<li><p> C14SD. Standard error of the radiocarbon date.
</p>
</li>
<li><p> Material. Material dated (Charcoal, shell etc.).
</p>
</li>
<li><p> Curve. Curve to be used in the calibration of each date (intcal13,
marine13).
</p>
</li>
<li><p> cal. Calibrated dates as CalDates objects.
</p>
</li>
<li><p> med. Median of the calibrated date in cal yr BP.
</p>
</li></ul>


<hr>
<h2 id='plot.dateMap'>Plot a map with the results of the iteration over multiple sites, showing
an interpolated surface of r values for the sites considered as potential
origins.</h2><span id='topic+plot.dateMap'></span>

<h3>Description</h3>

<p>Plot a map with the results of the iteration over multiple sites, showing
an interpolated surface of r values for the sites considered as potential
origins.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'dateMap'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.dateMap_+3A_x">x</code></td>
<td>
<p>a dateMap object. One of the list elements returned from
the iterateSites() function.</p>
</td></tr>
<tr><td><code id="plot.dateMap_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a spplot object.
</p>

<hr>
<h2 id='plot.dateModel'>Plot the results of the regression bootstrap on archaeological dates versus
distances from a hypothetical origin, with fitted lines.</h2><span id='topic+plot.dateModel'></span>

<h3>Description</h3>

<p>Plot the results of the regression bootstrap on archaeological dates versus
distances from a hypothetical origin, with fitted lines.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'dateModel'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.dateModel_+3A_x">x</code></td>
<td>
<p>a dateModel object created with modelDates().</p>
</td></tr>
<tr><td><code id="plot.dateModel_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a ggplot object.
</p>

<hr>
<h2 id='sampleCalDates'>Extract a single year estimate for ranges of calibrated dates with a
probability given by the calibrated probability distribution.</h2><span id='topic+sampleCalDates'></span>

<h3>Description</h3>

<p>Extract a single year estimate for ranges of calibrated dates with a
probability given by the calibrated probability distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sampleCalDates(calDates)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sampleCalDates_+3A_caldates">calDates</code></td>
<td>
<p>A CalDates object or a vector of CalDates.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of cal BP single year estimates.
</p>

<hr>
<h2 id='summary.dateModel'>Return summary statistics for a dateModel object.</h2><span id='topic+summary.dateModel'></span>

<h3>Description</h3>

<p>Return summary statistics for a dateModel object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'dateModel'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.dateModel_+3A_object">object</code></td>
<td>
<p>A dateModel object created with modelDates().</p>
</td></tr>
<tr><td><code id="summary.dateModel_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe with estimated start date and speed of advance.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
