<!DOCTYPE html><html><head><title>Help for package rqlm</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {rqlm}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#rqlm-package'><p>The 'rqlm' package.</p></a></li>
<li><a href='#bsci.ls'><p>Calculating bootstrap confidence interval for modified least-squares regression based on the quasi-score statistic</p></a></li>
<li><a href='#bsci.pois'><p>Calculating bootstrap confidence interval for modified Poisson regression based on the quasi-score statistic</p></a></li>
<li><a href='#exdata01'><p>A simulated example dataset</p></a></li>
<li><a href='#exdata02'><p>A simulated example dataset</p></a></li>
<li><a href='#qesci.ls'><p>Calculating confidence interval for modified least-squares regression based on the quasi-score test</p></a></li>
<li><a href='#qesci.pois'><p>Calculating confidence interval for modified Poisson regression based on the quasi-score test</p></a></li>
<li><a href='#rqlm'><p>Modified Poisson and least-squares regression analyses for binary outcomes</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Modified Poisson and Least-Squares Regressions for Binary
Outcome</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2-1</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-01-18</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Hisashi Noma &lt;noma@ism.ac.jp&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Modified Poisson and least-squares regression analyses for binary outcomes of Zou (2004) &lt;<a href="https://doi.org/10.1093%2Faje%2Fkwh090">doi:10.1093/aje/kwh090</a>&gt; and Cheung (2007) &lt;<a href="https://doi.org/10.1093%2Faje%2Fkwm223">doi:10.1093/aje/kwm223</a>&gt; have been standard multivariate analysis methods to estimate risk ratio and risk difference in clinical and epidemiological studies. This R package involves an easy-to-handle function to implement these analyses by simple commands. Also, recent studies have shown the ordinary robust variance estimator possibly has serious bias under small or moderate sample size situations for these methods. This package also provides computational tools to calculate alternative accurate confidence intervals (Noma and Gosho (2024) &lt;Forthcoming&gt;).</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, MASS, sandwich</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-01-19 01:29:35 UTC; Hisashi</td>
</tr>
<tr>
<td>Author:</td>
<td>Hisashi Noma <a href="https://orcid.org/0000-0002-2520-9949"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-01-19 09:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='rqlm-package'>The 'rqlm' package.</h2><span id='topic+rqlm-package'></span>

<h3>Description</h3>

<p>Modified Poisson and least-squares regression analyses for binary outcomes have been standard multivariate analysis methods to estimate risk ratio and risk difference in clinical and epidemiological studies. This R package involves an easy-to-handle function to implement these analyses by simple commands. Also, recent studies have shown the ordinary robust variance estimator possibly has serious bias under small or moderate sample size situations for these methods. This package also provides computational tools to calculate accurate confidence intervals (Noma and Gosho, 2024).
</p>


<h3>References</h3>

<p>Cheung, Y. B. (2007). A modified least-squares regression approach to the estimation of risk difference. <em>American Journal of Epidemiology</em> <strong>166</strong>, 1337-1344.
</p>
<p>Noma, H. and Gosho, M. (2024). Bootstrap confidence intervals based on quasi-likelihood estimating functions for the modified Poisson and least-squares regressions for binary outcomes. Forthcoming.
</p>
<p>Zou, G. (2004). A modified poisson regression approach to prospective studies with binary data. <em>American Journal of Epidemiology</em> <strong>159</strong>, 702-706.
</p>

<hr>
<h2 id='bsci.ls'>Calculating bootstrap confidence interval for modified least-squares regression based on the quasi-score statistic</h2><span id='topic+bsci.ls'></span>

<h3>Description</h3>

<p>Recent studies revealed the robust standard error estimates of the modified least-squares regression analysis are generally biased under small or moderate sample settings. To adjust the bias and to provide more accurate confidence intervals, confidence interval and P-value of the test for risk difference by modified least-squares regression are calculated based on the bootstrap approach of Noma and Gosho (2024).</p>


<h3>Usage</h3>

<pre><code class='language-R'>bsci.ls(formula, data, x.name=NULL, B=1000, cl=0.95, C0=10^-5,
 digits=4, seed=527916)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bsci.ls_+3A_formula">formula</code></td>
<td>
<p>An object of class &quot;formula&quot; (or one that can be coerced to that class): a symbolic description of the model to be fitted.</p>
</td></tr>
<tr><td><code id="bsci.ls_+3A_data">data</code></td>
<td>
<p>A data frame, list or environment (or object coercible by as.data.frame to a data frame) containing the variables in the model.</p>
</td></tr>
<tr><td><code id="bsci.ls_+3A_x.name">x.name</code></td>
<td>
<p>The variable name that the confidence interval is calculated for the regression coefficient; should be involved in <code>formula</code> as an explanatory variable. Specify as a character object.</p>
</td></tr>
<tr><td><code id="bsci.ls_+3A_b">B</code></td>
<td>
<p>The number of bootstrap resampling (default: 1000)</p>
</td></tr>
<tr><td><code id="bsci.ls_+3A_cl">cl</code></td>
<td>
<p>Confidence level for calculating confidence intervals (default: 0.95)</p>
</td></tr>
<tr><td><code id="bsci.ls_+3A_c0">C0</code></td>
<td>
<p>A tuning parameter to control the precisions of numerical computations of confidence limits (default: 10^-5).</p>
</td></tr>
<tr><td><code id="bsci.ls_+3A_digits">digits</code></td>
<td>
<p>Number of decimal places in the output (default: 4).</p>
</td></tr>
<tr><td><code id="bsci.ls_+3A_seed">seed</code></td>
<td>
<p>Seed to generate random numbers (default: 527916).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Results of the modified least-squares analyses are presented. Three objects are provided: Results of the modified least-squares regression with the Wald-type approximation by <code>rqlm</code>, the bootstrap-based confidence interval for the corresponding covariate, and P-value for the bootstrap test of <code>RD=0</code>.
</p>


<h3>References</h3>

<p>Noma, H. and Gosho, M. (2024). Bootstrap confidence intervals based on quasi-likelihood estimating functions for the modified Poisson and least-squares regressions for binary outcomes. Forthcoming.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(exdata01)

bsci.ls(y ~ x1 + x2 + x3 + x4, data=exdata01, "x3", B=10)
# For illustration. B should be &gt;= 1000 (the number of bootstrap resampling).
</code></pre>

<hr>
<h2 id='bsci.pois'>Calculating bootstrap confidence interval for modified Poisson regression based on the quasi-score statistic</h2><span id='topic+bsci.pois'></span>

<h3>Description</h3>

<p>Recent studies revealed the risk ratio estimates and robust standard error estimates of the modified Poisson regression analysis are generally biased under small or moderate sample settings. To adjust the bias and to provide more accurate confidence intervals, confidence interval and P-value of the test for risk ratio by modified Poisson regression are calculated based on the bootstrap approach of Noma and Gosho (2024).</p>


<h3>Usage</h3>

<pre><code class='language-R'>bsci.pois(formula, data, x.name=NULL, B=1000, eform=FALSE, cl=0.95, C0=10^-5,
 digits=4, seed=527916)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bsci.pois_+3A_formula">formula</code></td>
<td>
<p>An object of class &quot;formula&quot; (or one that can be coerced to that class): a symbolic description of the model to be fitted.</p>
</td></tr>
<tr><td><code id="bsci.pois_+3A_data">data</code></td>
<td>
<p>A data frame, list or environment (or object coercible by as.data.frame to a data frame) containing the variables in the model.</p>
</td></tr>
<tr><td><code id="bsci.pois_+3A_x.name">x.name</code></td>
<td>
<p>The variable name that the confidence interval is calculated for the regression coefficient; should be involved in <code>formula</code> as an explanatory variable. Specify as a character object.</p>
</td></tr>
<tr><td><code id="bsci.pois_+3A_b">B</code></td>
<td>
<p>The number of bootstrap resampling (default: 1000)</p>
</td></tr>
<tr><td><code id="bsci.pois_+3A_eform">eform</code></td>
<td>
<p>A logical value that specify whether the outcome should be transformed by exponential function (default: <code>FALSE</code>)</p>
</td></tr>
<tr><td><code id="bsci.pois_+3A_cl">cl</code></td>
<td>
<p>Confidence level for calculating confidence intervals (default: 0.95)</p>
</td></tr>
<tr><td><code id="bsci.pois_+3A_c0">C0</code></td>
<td>
<p>A tuning parameter to control the precisions of numerical computations of confidence limits (default: 10^-5).</p>
</td></tr>
<tr><td><code id="bsci.pois_+3A_digits">digits</code></td>
<td>
<p>Number of decimal places in the output (default: 4).</p>
</td></tr>
<tr><td><code id="bsci.pois_+3A_seed">seed</code></td>
<td>
<p>Seed to generate random numbers (default: 527916).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Results of the modified Poisson analyses are presented. Three objects are provided: Results of the modified Poisson regression with the Wald-type approximation by <code>rqlm</code>, the bootstrap confidence interval for the corresponding covariate, and P-value for the bootstrap test of <code>RR=1</code>.
</p>


<h3>References</h3>

<p>Noma, H. and Gosho, M. (2024). Bootstrap confidence intervals based on quasi-likelihood estimating functions for the modified Poisson and least-squares regressions for binary outcomes. Forthcoming.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(exdata01)

bsci.pois(y ~ x1 + x2 + x3 + x4, data=exdata01, "x3", B=10, eform=TRUE)
# For illustration. B should be &gt;= 1000 (the number of bootstrap resampling).
</code></pre>

<hr>
<h2 id='exdata01'>A simulated example dataset</h2><span id='topic+exdata01'></span>

<h3>Description</h3>

<p>A simulated cohort data with binomial outcome.
</p>

<ul>
<li> <p><code>y</code>: Dichotomous outcome variable.
</p>
</li>
<li> <p><code>x1</code>: Continuous covariate.
</p>
</li>
<li> <p><code>x2</code>: Binary covariate.
</p>
</li>
<li> <p><code>x3</code>: Binary covariate.
</p>
</li>
<li> <p><code>x4</code>: Binary covariate.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>data(exdata01)
</code></pre>


<h3>Format</h3>

<p>A simulated cohort data with binomial outcome (n=40).</p>

<hr>
<h2 id='exdata02'>A simulated example dataset</h2><span id='topic+exdata02'></span>

<h3>Description</h3>

<p>A simulated cohort data with binomial outcome.
</p>

<ul>
<li> <p><code>y</code>: Dichotomous outcome variable.
</p>
</li>
<li> <p><code>x1</code>: Continuous covariate.
</p>
</li>
<li> <p><code>x2</code>: Binary covariate.
</p>
</li>
<li> <p><code>x3</code>: Binary covariate.
</p>
</li>
<li> <p><code>x4</code>: Binary covariate.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>data(exdata02)
</code></pre>


<h3>Format</h3>

<p>A simulated cohort data with binomial outcome (n=1200).</p>

<hr>
<h2 id='qesci.ls'>Calculating confidence interval for modified least-squares regression based on the quasi-score test</h2><span id='topic+qesci.ls'></span>

<h3>Description</h3>

<p>Recent studies revealed the robust standard error estimates of the modified least-squares regression analysis are generally biased under small or moderate sample settings. To adjust the bias and to provide more accurate confidence intervals, confidence interval and P-value of the test for risk difference by modified least-squares regression are calculated based on the quasi-score test of Noma and Gosho (2024).</p>


<h3>Usage</h3>

<pre><code class='language-R'>qesci.ls(formula, data, x.name=NULL, cl=0.95, C0=10^-5, digits=4)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="qesci.ls_+3A_formula">formula</code></td>
<td>
<p>An object of class &quot;formula&quot; (or one that can be coerced to that class): a symbolic description of the model to be fitted.</p>
</td></tr>
<tr><td><code id="qesci.ls_+3A_data">data</code></td>
<td>
<p>A data frame, list or environment (or object coercible by as.data.frame to a data frame) containing the variables in the model.</p>
</td></tr>
<tr><td><code id="qesci.ls_+3A_x.name">x.name</code></td>
<td>
<p>The variable name that the confidence interval is calculated for the regression coefficient; should be involved in <code>formula</code> as an explanatory variable. Specify as a character object.</p>
</td></tr>
<tr><td><code id="qesci.ls_+3A_cl">cl</code></td>
<td>
<p>Confidence level for calculating confidence intervals (default: 0.95)</p>
</td></tr>
<tr><td><code id="qesci.ls_+3A_c0">C0</code></td>
<td>
<p>A tuning parameter to control the precisions of numerical computations of confidence limits (default: 10^-5).</p>
</td></tr>
<tr><td><code id="qesci.ls_+3A_digits">digits</code></td>
<td>
<p>Number of decimal places in the output (default: 4).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Results of the modified least-squares analyses are presented. Three objects are provided: Results of the modified least-squares regression with the Wald-type approximation by <code>rqlm</code>, quasi-score confidence interval for the corresponding covariate, and P-value for the quasi-score test of <code>RD=0</code>.
</p>


<h3>References</h3>

<p>Noma, H. and Gosho, M. (2024). Bootstrap confidence intervals based on quasi-likelihood estimating functions for the modified Poisson and least-squares regressions for binary outcomes. Forthcoming.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(exdata01)

qesci.ls(y ~ x1 + x2 + x3 + x4, data=exdata01, "x3")
</code></pre>

<hr>
<h2 id='qesci.pois'>Calculating confidence interval for modified Poisson regression based on the quasi-score test</h2><span id='topic+qesci.pois'></span>

<h3>Description</h3>

<p>Recent studies revealed the risk ratio estimates and robust standard error estimates of the modified Poisson regression analysis are generally biased under small or moderate sample settings. To adjust the bias and to provide more accurate confidence intervals, confidence interval and P-value of the test for risk ratio by modified Poisson regression are calculated based on the quasi-score test of Noma and Gosho (2024).</p>


<h3>Usage</h3>

<pre><code class='language-R'>qesci.pois(formula, data, x.name=NULL, eform=FALSE, cl=0.95, C0=10^-5, digits=4)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="qesci.pois_+3A_formula">formula</code></td>
<td>
<p>An object of class &quot;formula&quot; (or one that can be coerced to that class): a symbolic description of the model to be fitted.</p>
</td></tr>
<tr><td><code id="qesci.pois_+3A_data">data</code></td>
<td>
<p>A data frame, list or environment (or object coercible by as.data.frame to a data frame) containing the variables in the model.</p>
</td></tr>
<tr><td><code id="qesci.pois_+3A_x.name">x.name</code></td>
<td>
<p>The variable name that the confidence interval is calculated for the regression coefficient; should be involved in <code>formula</code> as an explanatory variable. Specify as a character object.</p>
</td></tr>
<tr><td><code id="qesci.pois_+3A_eform">eform</code></td>
<td>
<p>A logical value that specify whether the outcome should be transformed by exponential function (default: <code>FALSE</code>)</p>
</td></tr>
<tr><td><code id="qesci.pois_+3A_cl">cl</code></td>
<td>
<p>Confidence level for calculating confidence intervals (default: 0.95)</p>
</td></tr>
<tr><td><code id="qesci.pois_+3A_c0">C0</code></td>
<td>
<p>A tuning parameter to control the precisions of numerical computations of confidence limits (default: 10^-5).</p>
</td></tr>
<tr><td><code id="qesci.pois_+3A_digits">digits</code></td>
<td>
<p>Number of decimal places in the output (default: 4).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Results of the modified Poisson analyses are presented. Three objects are provided: Results of the modified Poisson regression with the Wald-type approximation by <code>rqlm</code>, quasi-score confidence interval for the corresponding covariate, and P-value for the quasi-score test of <code>RR=1</code>.
</p>


<h3>References</h3>

<p>Noma, H. and Gosho, M. (2024). Bootstrap confidence intervals based on quasi-likelihood estimating functions for the modified Poisson and least-squares regressions for binary outcomes. Forthcoming.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(exdata01)

qesci.pois(y ~ x1 + x2 + x3 + x4, data=exdata01, "x3", eform=TRUE)
</code></pre>

<hr>
<h2 id='rqlm'>Modified Poisson and least-squares regression analyses for binary outcomes</h2><span id='topic+rqlm'></span>

<h3>Description</h3>

<p>Modified Poisson and least-squares regression analyses for binary outcomes are performed. This function is handled by a similar way with <code>lm</code> or <code>glm</code>. The model fitting to the binary data can be specified by <code>family</code>. Also, the resultant coefficients and confidence limits can be transformed to exponential scales by specifying <code>eform</code>. The standard error estimates are calculated using the standard robust variance estimator by <code>sandwich</code> package.</p>


<h3>Usage</h3>

<pre><code class='language-R'>rqlm(formula, data, family=poisson, eform=FALSE, cl=0.95, digits=4)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rqlm_+3A_formula">formula</code></td>
<td>
<p>An object of class &quot;formula&quot; (or one that can be coerced to that class): a symbolic description of the model to be fitted.</p>
</td></tr>
<tr><td><code id="rqlm_+3A_data">data</code></td>
<td>
<p>A data frame, list or environment (or object coercible by as.data.frame to a data frame) containing the variables in the model.</p>
</td></tr>
<tr><td><code id="rqlm_+3A_family">family</code></td>
<td>
<p>A description of the error distribution and link function to be used in the model. <code>gaussian</code>: Modified least-squares regression. <code>poisson</code>: Modified Poisson regression.</p>
</td></tr>
<tr><td><code id="rqlm_+3A_eform">eform</code></td>
<td>
<p>A logical value that specify whether the outcome should be transformed by exponential function (default: <code>FALSE</code>)</p>
</td></tr>
<tr><td><code id="rqlm_+3A_cl">cl</code></td>
<td>
<p>Confidence level for calculating confidence intervals (default: 0.95)</p>
</td></tr>
<tr><td><code id="rqlm_+3A_digits">digits</code></td>
<td>
<p>Number of decimal places in the output (default: 4).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Results of the modified Poisson and least-squares regression analyses.
</p>

<ul>
<li> <p><code>coef</code>: Coefficient estimates; transformed to the exponential scale if <code>eform=TRUE</code>.
</p>
</li>
<li> <p><code>SE</code>: Robust standard error estimates for <code>coef</code>.
</p>
</li>
<li> <p><code>CL</code>: Lower limits of confidence intervals.
</p>
</li>
<li> <p><code>CU</code>: Upper limits of confidence intervals.
</p>
</li>
<li> <p><code>P-value</code>: P-values for the coefficient tests.
</p>
</li></ul>



<h3>References</h3>

<p>Cheung, Y. B. (2007). A modified least-squares regression approach to the estimation of risk difference. <em>American Journal of Epidemiology</em> <strong>166</strong>, 1337-1344.
</p>
<p>Noma, H. and Gosho, M. (2024). Bootstrap confidence intervals based on quasi-likelihood estimating functions for the modified Poisson and least-squares regressions for binary outcomes. Forthcoming.
</p>
<p>White, H. (1982). Maximum likelihood estimation of misspecified models. <em>Econometrica</em>, <strong>50</strong>, 1-25.
</p>
<p>Zou, G. (2004). A modified poisson regression approach to prospective studies with binary data. <em>American Journal of Epidemiology</em> <strong>159</strong>, 702-706.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(exdata02)

rqlm(y ~ x1 + x2 + x3 + x4, data=exdata02, family=poisson, eform=TRUE)
# Modifed Poisson regression analysis
# Coefficient estimates are translated to risk ratio scales

rqlm(y ~ x1 + x2 + x3 + x4, data=exdata02, family=gaussian)
# Modifed least-squares regression analysis

rqlm(y ~ x1 + x2 + x3 + x4, data=exdata02, family=gaussian, digits=3)
# Modifed least-squares regression analysis
# Number of decimal places can be changed by specifying "digits"
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
