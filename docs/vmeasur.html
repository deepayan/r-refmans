<!DOCTYPE html><html lang="en"><head><title>Help for package vmeasur</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {vmeasur}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#calibrate_pixel_size'><p>Calibrate the pixel size using a test image</p></a></li>
<li><a href='#example_vessel'><p>Example lymphatic width dataset</p></a></li>
<li><a href='#output_dir'><p>Set the output directory</p></a></li>
<li><a href='#quantify_directory'><p>Quantify the content of an entire directory of sub-directories at once</p></a></li>
<li><a href='#quantify_mean_width'><p>Quantify the vessel width over an entire ROI</p></a></li>
<li><a href='#quantify_mean_width_sections'><p>Quantify the contractility of a vessel in sections along it's length</p></a></li>
<li><a href='#quantify_width_position'><p>Quantify the width of a vessel continuously along it's length</p></a></li>
<li><a href='#scratch_dir'><p>Set the scratch directory for vmeasur</p></a></li>
<li><a href='#select_roi'><p>Select a ROI from a video file</p></a></li>
<li><a href='#threshold_apply'><p>Threshold a video with pre-determined parameters</p></a></li>
<li><a href='#threshold_vessel'><p>Apply a threshold to a single frame</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Quantify the Contractile Nature of Vessels Monitored under an
Operating Microscope</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.4</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>James JW Hucklesby &lt;jhuc964@aucklanduni.ac.nz&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>A variety of tools to allow the quantification of videos of the 
    lymphatic vasculature taken under an operating microscope. Lymphatic vessels
    that have been injected with a variety of blue dyes can be tracked throughout
    the video to determine their width over time. Code is optimised
    for efficient processing of multiple large video files. Functions to calculate
    physiologically relevant parameters and generate graphs from these values 
    are also included.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://creativecommons.org/licenses/by-nc-sa/4.0">CC BY-NC-SA 4.0</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>ggplot2, readr, stringr, tidyr, purrr, ggpubr, imager, av,
tools, dplyr, rlang, foreach, magrittr, graphics, stats, utils,
pracma, crayon, svDialogs, pdftools, doFuture, progressr,
future, scales, tcltk</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-11-11 02:37:47 UTC; jhuc964</td>
</tr>
<tr>
<td>Author:</td>
<td>James JW Hucklesby
    <a href="https://orcid.org/0000-0003-1591-6823"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre],
  Peter S Russell <a href="https://orcid.org/0000-0002-7059-6618"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Anthony RJ Phillips
    <a href="https://orcid.org/0000-0001-6143-5866"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Catherine E Angel <a href="https://orcid.org/0000-0003-1737-8539"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-11-11 19:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='calibrate_pixel_size'>Calibrate the pixel size using a test image</h2><span id='topic+calibrate_pixel_size'></span>

<h3>Description</h3>

<p>In order to calculate absolute densities from pixel sizes, the size of the
field captured by an operating microscope must be determined. This function
allows the user to select an image of a ruler captured under a microscope,
before automatically determining the scale.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calibrate_pixel_size(file_path = tk_file.choose())
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calibrate_pixel_size_+3A_file_path">file_path</code></td>
<td>
<p>The path to the image of a ruler to use for calibration. If
left blank, the user will be prompted to select the file.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A graphical representation of the ruler and calibration process. The
number of pixels per mm will also be displayed.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

file = paste(system.file(package = "vmeasur"), "extdata/mm_scale.jpg", sep = "/")
calibrate_pixel_size(file)


## End(Not run)

</code></pre>

<hr>
<h2 id='example_vessel'>Example lymphatic width dataset</h2><span id='topic+example_vessel'></span>

<h3>Description</h3>

<p>A data set containing the widths of a test vessel in each frame of a video. Identical
in format to that produced by select_roi and threshold_vessel
</p>


<h3>Usage</h3>

<pre><code class='language-R'>example_vessel
</code></pre>


<h3>Format</h3>

<p>A data frame with 245,230 rows and 5 variables:
</p>

<dl>
<dt>X.1</dt><dd><p>identification number of each row</p>
</dd>
<dt>y</dt><dd><p>y position in the image</p>
</dd>
<dt>p_width</dt><dd><p>width of the vessel at that position, in pixels</p>
</dd>
<dt>excluded</dt><dd><p>was that row excluded due to an air bubble</p>
</dd>
<dt>filename</dt><dd><p>which frame was the pixel row acquired from</p>
</dd>
</dl>
<p>...

</p>


<h3>Source</h3>

<p>Collected for this package by Peter Russell (2021)
</p>

<hr>
<h2 id='output_dir'>Set the output directory</h2><span id='topic+output_dir'></span>

<h3>Description</h3>

<p>Set the output directory
</p>


<h3>Usage</h3>

<pre><code class='language-R'>output_dir(set = NULL, use_default = FALSE, set_default = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="output_dir_+3A_set">set</code></td>
<td>
<p>The directory to set to</p>
</td></tr>
<tr><td><code id="output_dir_+3A_use_default">use_default</code></td>
<td>
<p>Should the default value be used, or the system value</p>
</td></tr>
<tr><td><code id="output_dir_+3A_set_default">set_default</code></td>
<td>
<p>Should the system value be updated</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The file path to export to
</p>

<hr>
<h2 id='quantify_directory'>Quantify the content of an entire directory of sub-directories at once</h2><span id='topic+quantify_directory'></span>

<h3>Description</h3>

<p>Quantify the content of an entire directory of sub-directories at once
</p>


<h3>Usage</h3>

<pre><code class='language-R'>quantify_directory(target_folder)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="quantify_directory_+3A_target_folder">target_folder</code></td>
<td>
<p>The folder to quantify the readings in</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A PDF file for each directory quantified, showing the quantification
</p>

<hr>
<h2 id='quantify_mean_width'>Quantify the vessel width over an entire ROI</h2><span id='topic+quantify_mean_width'></span>

<h3>Description</h3>

<p>This function calculates the overall widths and contraction parameters for the vessel as a whole.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>quantify_mean_width(widths_file, pixel_scale = 73)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="quantify_mean_width_+3A_widths_file">widths_file</code></td>
<td>
<p>A CSV file created by select_roi or threshold_vessel</p>
</td></tr>
<tr><td><code id="quantify_mean_width_+3A_pixel_scale">pixel_scale</code></td>
<td>
<p>The number of pixels per mm, can be calculated with
calibrate_pixel_size if unknown</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing:
A graph showing the detected contraction events,
Details of each contraction event,
The mean and standard deviation of the calculated contraction physiological parameters,
The raw data used in the quantification process
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
quantify_mean_width(vmeasur::example_vessel)

</code></pre>

<hr>
<h2 id='quantify_mean_width_sections'>Quantify the contractility of a vessel in sections along it's length</h2><span id='topic+quantify_mean_width_sections'></span>

<h3>Description</h3>

<p>Quantify the physiological parameters in each section of the vessel along it's
length.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>quantify_mean_width_sections(widths_file = tk_file.choose())
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="quantify_mean_width_sections_+3A_widths_file">widths_file</code></td>
<td>
<p>A csv file created by select_roi or threshold_vessel. If
not specified, the user will be prompted to make a selection.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Graphs showing the contractility over time, contraction position and
amplitude detected, length of contraction and a heatmap overlay for verification
of the overall data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# quantify_mean_width_sections(widths_file = vmeasur::example_vessel)

</code></pre>

<hr>
<h2 id='quantify_width_position'>Quantify the width of a vessel continuously along it's length</h2><span id='topic+quantify_width_position'></span>

<h3>Description</h3>

<p>Generate heat maps and line plots showing the changes in vessel diameter along
it's length
</p>


<h3>Usage</h3>

<pre><code class='language-R'>quantify_width_position(widths_file = tk_file.choose())
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="quantify_width_position_+3A_widths_file">widths_file</code></td>
<td>
<p>A csv file created by select_roi or threshold_vessel. The
user will be prompted to select a file if this is not specified.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Two plots: A heat map of the vessel diameter at each position over
time and a plot showing the maximum change in diameter over time
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
quantify_width_position(vmeasur::example_vessel)

</code></pre>

<hr>
<h2 id='scratch_dir'>Set the scratch directory for vmeasur</h2><span id='topic+scratch_dir'></span>

<h3>Description</h3>

<p>vmeasur uses av to unpack temporary image files, which are then stored for
further usage. This runs better if done to a high speed storage location such
as a ram drive. This function sets that directory, and provides other options
for specifying the structure of this temporary data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scratch_dir(
  set = NULL,
  random_subfolder = FALSE,
  file_name = FALSE,
  wipe_scratch = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="scratch_dir_+3A_set">set</code></td>
<td>
<p>new directory to set. If left blank, no directory change will occur</p>
</td></tr>
<tr><td><code id="scratch_dir_+3A_random_subfolder">random_subfolder</code></td>
<td>
<p>Should a random sub folder be created</p>
</td></tr>
<tr><td><code id="scratch_dir_+3A_file_name">file_name</code></td>
<td>
<p>Specify the name of the directory</p>
</td></tr>
<tr><td><code id="scratch_dir_+3A_wipe_scratch">wipe_scratch</code></td>
<td>
<p>Should the folder be cleared before use</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If not specified, the default R tempdir is used
</p>


<h3>Value</h3>

<p>the current location of the scratch directory
</p>


<h3>Examples</h3>

<pre><code class='language-R'>scratch_dir()
scratch_dir("R:")

</code></pre>

<hr>
<h2 id='select_roi'>Select a ROI from a video file</h2><span id='topic+select_roi'></span>

<h3>Description</h3>

<p>This function provides a graphical tool to walk the user through selecting a ROI from an AVI video.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>select_roi()
</code></pre>


<h3>Value</h3>

<p>Saves an annotated AVI and CSV file in the same directory as the video.
Will also output and copy the parameters used to create the video.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
   select_roi()

## End(Not run)

</code></pre>

<hr>
<h2 id='threshold_apply'>Threshold a video with pre-determined parameters</h2><span id='topic+threshold_apply'></span>

<h3>Description</h3>

<p>Using pre-determined values this function generates ROI from a video. If parameters are not known, use select_roi()
This function is optimized to run in parallel, so should be relatively rapid. If running slowly, check the scratch disk is set correctly.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>threshold_apply(
  threshold = 0.5,
  roi_name = "test",
  video_path = "image826.avi",
  radians = 0.217604550320612,
  xlength = 60,
  ylength = 242,
  xstart = 696,
  ystart = 323,
  image_list = NULL,
  fps = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="threshold_apply_+3A_threshold">threshold</code></td>
<td>
<p>The threshold for the red channel. Range 0-1.</p>
</td></tr>
<tr><td><code id="threshold_apply_+3A_roi_name">roi_name</code></td>
<td>
<p>Name assigned to the region of interest</p>
</td></tr>
<tr><td><code id="threshold_apply_+3A_video_path">video_path</code></td>
<td>
<p>Location of the video file to process</p>
</td></tr>
<tr><td><code id="threshold_apply_+3A_radians">radians</code></td>
<td>
<p>Degrees to rotate the image, in radians</p>
</td></tr>
<tr><td><code id="threshold_apply_+3A_xlength">xlength</code></td>
<td>
<p>Number of x pixels in the ROI</p>
</td></tr>
<tr><td><code id="threshold_apply_+3A_ylength">ylength</code></td>
<td>
<p>Number of y pixels in the ROI</p>
</td></tr>
<tr><td><code id="threshold_apply_+3A_xstart">xstart</code></td>
<td>
<p>ROI starting x co-ordinate</p>
</td></tr>
<tr><td><code id="threshold_apply_+3A_ystart">ystart</code></td>
<td>
<p>ROI starting y co-ordinate</p>
</td></tr>
<tr><td><code id="threshold_apply_+3A_image_list">image_list</code></td>
<td>
<p>If pre-computed, a list of images to use rather than a video</p>
</td></tr>
<tr><td><code id="threshold_apply_+3A_fps">fps</code></td>
<td>
<p>Number of fps to process, this can be set lower for validation</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Saves the quantified CSV and overlaid video in the same directory as the video
</p>

<hr>
<h2 id='threshold_vessel'>Apply a threshold to a single frame</h2><span id='topic+threshold_vessel'></span>

<h3>Description</h3>

<p>Apply a threshold to a single frame
</p>


<h3>Usage</h3>

<pre><code class='language-R'>threshold_vessel(file_path = tk_file.choose(), threshold, min_area = 100)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="threshold_vessel_+3A_file_path">file_path</code></td>
<td>
<p>path to the file to be used. If left blank, the user will be
prompted to make a selection</p>
</td></tr>
<tr><td><code id="threshold_vessel_+3A_threshold">threshold</code></td>
<td>
<p>The threshold to use</p>
</td></tr>
<tr><td><code id="threshold_vessel_+3A_min_area">min_area</code></td>
<td>
<p>Minimum area to recognize as a vessel. Any smaller items will
be ignored</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data frame containing the widths of the vessel in each row of the image,
and if any rows were excluded due to overexposure
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
