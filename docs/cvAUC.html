<!DOCTYPE html><html><head><title>Help for package cvAUC</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {cvAUC}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#cvAUC-package'><p>Cross-Validated Area Under the ROC Curve Confidence Intervals</p></a></li>
<li><a href='#adherence'><p>Data set: Simulated Pooled Repeated Measures Data</p></a></li>
<li><a href='#admissions'><p>Data set: Simulated Admissions Data with Binary Outcome</p></a></li>
<li><a href='#AUC'><p>Area Under the ROC Curve</p></a></li>
<li><a href='#ci.cvAUC'>
<p>Confidence Intervals for Cross-validated Area Under the ROC Curve (AUC) Estimates</p></a></li>
<li><a href='#ci.pooled.cvAUC'><p>Confidence Intervals for Cross-validated Area Under the ROC Curve (AUC) Estimates for Pooled Repeated Measures Data</p></a></li>
<li><a href='#cvAUC'><p>Cross-validated Area Under the ROC Curve (AUC)</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Cross-Validated Area Under the ROC Curve Confidence Intervals</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.4</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-01-17</td>
</tr>
<tr>
<td>Author:</td>
<td>Erin LeDell, Maya Petersen, Mark van der Laan</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Erin LeDell &lt;oss@ledell.org&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Tools for working with and evaluating cross-validated area under the ROC curve (AUC) estimators.  The primary functions of the package are ci.cvAUC and ci.pooled.cvAUC, which report cross-validated AUC and compute confidence intervals for cross-validated AUC estimates based on influence curves for i.i.d. and pooled repeated measures data, respectively.  One benefit to using influence curve based confidence intervals is that they require much less computation time than bootstrapping methods.  The utility functions, AUC and cvAUC, are simple wrappers for functions from the ROCR package.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.apache.org/licenses/LICENSE-2.0">Apache License (== 2.0)</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>ROCR, data.table</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/ledell/cvAUC">https://github.com/ledell/cvAUC</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/ledell/cvAUC/issues">https://github.com/ledell/cvAUC/issues</a></td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-01-17 21:39:04 UTC; me</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-01-17 22:42:41 UTC</td>
</tr>
</table>
<hr>
<h2 id='cvAUC-package'>Cross-Validated Area Under the ROC Curve Confidence Intervals</h2><span id='topic+cvAUC-package'></span><span id='topic+cvAUC-package'></span>

<h3>Description</h3>

<p>Tools for working with and evaluating cross-validated area under the ROC curve (AUC) estimators.  The primary functions of the package are <code>ci.cvAUC</code> and <code>ci.pooled.cvAUC</code>, which compute confidence intervals for cross-validated AUC estimates based on influence curves of both regular i.i.d and pooled repeated measures data.  One benefit to using influence function based confidence intervals is that they require much less computation time than bootstrapping methods.  The utility function, <code>cvAUC</code>, which computes cross-validated AUC, is a wrapper for functions from the ROCR package.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> cvAUC</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.1.4</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2022-01-17</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> Apache License (== 2.0)</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>See the help files for the following functions for more information:
</p>
<p><code><a href="#topic+cvAUC">cvAUC</a></code>, <code><a href="#topic+ci.cvAUC">ci.cvAUC</a></code>, <code><a href="#topic+ci.pooled.cvAUC">ci.pooled.cvAUC</a></code>
</p>


<h3>Note</h3>

<p>This work was supported by the Doris Duke Charitable Foundation Grant No. 2011042.
</p>


<h3>Author(s)</h3>

<p>Erin LeDell, Maya Petersen, Mark van der Laan
</p>
<p>Maintainer: Erin LeDell &lt;oss@ledell.org&gt;
</p>


<h3>References</h3>

<p>LeDell, Erin; Petersen, Maya; van der Laan, Mark. Computationally efficient confidence intervals for cross-validated area under the ROC curve estimates. Electron. J. Statist. 9 (2015), no. 1, 1583&ndash;1607. doi:10.1214/15-EJS1035. <a href="http://projecteuclid.org/euclid.ejs/1437742107">http://projecteuclid.org/euclid.ejs/1437742107</a>.
</p>
<p>M. J. van der Laan and S. Rose. Targeted Learning: Causal Inference for Observational and Experimental Data. Springer Series in Statistics. Springer, first edition, 2011.
</p>
<p>Tobias Sing, Oliver Sander, Niko Beerenwinkel, and Thomas Lengauer. ROCR: Visualizing classifier performance in R. Bioinformatics, 21(20):3940-3941, 2005.
</p>


<h3>See Also</h3>

<p><a href="https://cran.r-project.org/package=ROCR">https://cran.r-project.org/package=ROCR</a>
</p>

<hr>
<h2 id='adherence'>Data set: Simulated Pooled Repeated Measures Data</h2><span id='topic+adherence'></span>

<h3>Description</h3>

<p>This is a simulated pooled repeated measures data set of patient medication adherence summaries with a binary outcome.  The independent units are the patients, and each patient has one or more measurements made at different time points in treatment, each associated with a binary outcome that could represent a diagnostic test result.  This data set is meant to be used with the <code>ci.pooled.cvAUC</code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(adherence)</code></pre>


<h3>Format</h3>

<p>A data frame.  The first column, <code>id</code>, is the patient id.  Columns 2-5 represent medication adherence (as a percentage) averaged over the past 2, 7, 14, 21 and 28 days, respectively.  The last column is a binary outcome that could represent a test result.</p>


<h3>See Also</h3>

<p><code><a href="#topic+ci.pooled.cvAUC">ci.pooled.cvAUC</a></code>
</p>

<hr>
<h2 id='admissions'>Data set: Simulated Admissions Data with Binary Outcome</h2><span id='topic+admissions'></span>

<h3>Description</h3>

<p>This is a simulated data set that represents admissions information for a graduate program in the sciences.  The binary outcome is 1 for admitted and 0 for not admitted.  This data set is meant to be used with the <code>ci.cvAUC</code> function.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(admissions)</code></pre>


<h3>Format</h3>

<p>A data frame. The five predictor variables are: <code>quant</code>, <code>verbal</code>, <code>gpa</code>, <code>toptier</code> and <code>research</code>.  We can treat <code>quant</code> and <code>verbal</code>, which represent quantitative and verbal GRE scores, as continuous variables.  The binary indicator variables, <code>toptier</code> and <code>research</code>, indicate whether the application is coming from a &ldquo;top tier&rdquo; institution and whether or not they have prior research experience.  The binary indicator, <code>Y</code>, represents admitted <code>(Y=1)</code> vs. not admitted <code>(Y=0)</code>.
</p>

<hr>
<h2 id='AUC'>Area Under the ROC Curve</h2><span id='topic+AUC'></span>

<h3>Description</h3>

<p>This function calculates Area Under the ROC Curve (AUC).  The AUC can be defined as the probability that the fit model will score a randomly drawn positive sample higher than a randomly drawn negative sample.  This is also equal to the value of the Wilcoxon-Mann-Whitney statistic.  This function is a wrapper for functions from the ROCR package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AUC(predictions, labels, label.ordering = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="AUC_+3A_predictions">predictions</code></td>
<td>

<p>A vector of predictions, or predicted probabilities, for each observation.
</p>
</td></tr>
<tr><td><code id="AUC_+3A_labels">labels</code></td>
<td>

<p>A binary vector containing the true values for each observation.  Must have the same length as <code>predictions</code>.
</p>
</td></tr>
<tr><td><code id="AUC_+3A_label.ordering">label.ordering</code></td>
<td>

<p>The default ordering of the classes can be changed by supplying a vector containing the negative and the positive class label (negative label first, positive label second).
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The value returned is the Area Under the ROC Curve (AUC).
</p>


<h3>Author(s)</h3>

<p>Erin LeDell <a href="mailto:oss@ledell.org">oss@ledell.org</a>
</p>


<h3>References</h3>

<p>References to the underlying ROCR code, used to calculate area under the ROC curve, can be found on the ROCR homepage at:
<a href="https://ipa-tys.github.io/ROCR/">https://ipa-tys.github.io/ROCR/</a>
</p>


<h3>See Also</h3>

<p><code><a href="ROCR.html#topic+prediction">prediction</a></code>, <code><a href="ROCR.html#topic+performance">performance</a></code>, <code><a href="#topic+cvAUC">cvAUC</a></code>, <code><a href="#topic+ci.cvAUC">ci.cvAUC</a></code>, <code><a href="#topic+ci.pooled.cvAUC">ci.pooled.cvAUC</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(cvAUC)
library(ROCR)  #load example data

data(ROCR.simple)
auc &lt;- AUC(ROCR.simple$predictions, ROCR.simple$labels)
# [1] 0.8341875

</code></pre>

<hr>
<h2 id='ci.cvAUC'>
Confidence Intervals for Cross-validated Area Under the ROC Curve (AUC) Estimates
</h2><span id='topic+ci.cvAUC'></span>

<h3>Description</h3>

<p>This function calculates influence curve based confidence intervals for cross-validated area under the ROC curve (AUC) estimates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ci.cvAUC(predictions, labels, label.ordering = NULL, folds = NULL, confidence = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ci.cvAUC_+3A_predictions">predictions</code></td>
<td>

<p>A vector, matrix, list, or data frame containing the predictions.
</p>
</td></tr>
<tr><td><code id="ci.cvAUC_+3A_labels">labels</code></td>
<td>

<p>A vector, matrix, list, or data frame containing the true class labels. Must have the same dimensions as <code>predictions</code>.
</p>
</td></tr>
<tr><td><code id="ci.cvAUC_+3A_label.ordering">label.ordering</code></td>
<td>

<p>The default ordering of the classes can be changed by supplying a vector containing the negative and the positive class label (negative label first, positive label second).
</p>
</td></tr>
<tr><td><code id="ci.cvAUC_+3A_folds">folds</code></td>
<td>

<p>If specified, this must be a vector of fold ids equal in length to <code>predictions</code> and <code>labels</code>, or a list of length V (for V-fold cross-validation) of vectors of indexes for the observations contained in each fold.  The <code>folds</code> argument must only be specified if the <code>predictions</code> and <code>labels</code> arguments are vectors.
</p>
</td></tr>
<tr><td><code id="ci.cvAUC_+3A_confidence">confidence</code></td>
<td>

<p>A number between 0 and 1 that represents confidence level.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See the documentation for the <code><a href="ROCR.html#topic+prediction">prediction</a></code> function in the ROCR package for details on the <code>predictions</code>, <code>labels</code> and <code>label.ordering</code> arguments. 
</p>


<h3>Value</h3>

<p>A list containing the following named elements:
</p>
<table>
<tr><td><code>cvAUC</code></td>
<td>
<p>Cross-validated area under the curve estimate.</p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p>Standard error.</p>
</td></tr>
<tr><td><code>ci</code></td>
<td>
<p>A vector of length two containing the upper and lower bounds for the confidence interval.</p>
</td></tr>
<tr><td><code>confidence</code></td>
<td>
<p>A number between 0 and 1 representing the confidence.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Erin LeDell <a href="mailto:oss@ledell.org">oss@ledell.org</a>
</p>
<p>Maya Petersen <a href="mailto:mayaliv@berkeley.edu">mayaliv@berkeley.edu</a>
</p>
<p>Mark van der Laan <a href="mailto:laan@berkeley.edu">laan@berkeley.edu</a>
</p>


<h3>References</h3>

<p>LeDell, Erin; Petersen, Maya; van der Laan, Mark. Computationally efficient confidence intervals for cross-validated area under the ROC curve estimates. Electron. J. Statist. 9 (2015), no. 1, 1583&ndash;1607. doi:10.1214/15-EJS1035. <a href="http://projecteuclid.org/euclid.ejs/1437742107">http://projecteuclid.org/euclid.ejs/1437742107</a>.
</p>
<p>M. J. van der Laan and S. Rose. Targeted Learning: Causal Inference for Observational and Experimental Data. Springer Series in Statistics. Springer, first edition, 2011.
</p>
<p>Tobias Sing, Oliver Sander, Niko Beerenwinkel, and Thomas Lengauer. ROCR: Visualizing classifier performance in R. Bioinformatics, 21(20):3940-3941, 2005.
</p>


<h3>See Also</h3>

<p><code><a href="ROCR.html#topic+prediction">prediction</a></code>, <code><a href="ROCR.html#topic+performance">performance</a></code>,
<code><a href="#topic+cvAUC">cvAUC</a></code>, <code><a href="#topic+ci.pooled.cvAUC">ci.pooled.cvAUC</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># This i.i.d. data example does the following:

# Load a data set with a binary outcome. For the i.i.d. case we use a simulated data set of 
# 500 observations, included with the package, of graduate admissions data. 
# 
# Divide the indices randomly into 10 folds, stratifying by outcome.  Stratification is not 
# necessary, but is commonly performed in order to create validation folds with similar 
# distributions.  Store this information in a list called folds.
# 
# Define a function to fit a model on the training data and to generate predicted values 
# for the observations in the validation fold, for a single iteration of the cross-validation 
# procedure.  We use a logistic regression fit.
# 
# Apply this function across all folds to generate predicted values for each validation fold.  
# The concatenated version of these predicted values is stored in vector called predictions.  
# The outcome vector, Y, is the labels argument. 


iid_example &lt;- function(data, V = 10){

  .cvFolds &lt;- function(Y, V){  #Create CV folds (stratify by outcome)
    Y0 &lt;- split(sample(which(Y==0)), rep(1:V, length = length(which(Y==0))))
    Y1 &lt;- split(sample(which(Y==1)), rep(1:V, length = length(which(Y==1))))
    folds &lt;- vector("list", length=V)
    for (v in seq(V)) {folds[[v]] &lt;- c(Y0[[v]], Y1[[v]])}		
    return(folds)
  }
  .doFit &lt;- function(v, folds, data){  #Train/test glm for each fold
    fit &lt;- glm(Y~., data = data[-folds[[v]],], family = binomial)
    pred &lt;- predict(fit, newdata = data[folds[[v]],], type = "response")
    return(pred)
  }
  folds &lt;- .cvFolds(Y = data$Y, V = V)  #Create folds
  predictions &lt;- unlist(sapply(seq(V), .doFit, folds = folds, data = data))  #CV train/predict
  predictions[unlist(folds)] &lt;- predictions  #Re-order pred values
  # Get CV AUC and confidence interval
  out &lt;- ci.cvAUC(predictions = predictions, labels = data$Y, 
                  folds = folds, confidence = 0.95)
  return(out)
}


# Load data
library(cvAUC)
data(admissions)

# Get performance
set.seed(1)
out &lt;- iid_example(data = admissions, V = 10) 


# The output is given as follows:
# &gt; out
# $cvAUC
# [1] 0.9046473
# 
# $se
# [1] 0.01620238
# 
# $ci
# [1] 0.8728913 0.9364034
#
# $confidence
# [1] 0.95
</code></pre>

<hr>
<h2 id='ci.pooled.cvAUC'>Confidence Intervals for Cross-validated Area Under the ROC Curve (AUC) Estimates for Pooled Repeated Measures Data 
</h2><span id='topic+ci.pooled.cvAUC'></span>

<h3>Description</h3>

<p>This function calculates influence curve based confidence intervals for cross-validated area under the curve (AUC) estimates, for a pooled repeated measures data set.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ci.pooled.cvAUC(predictions, labels, label.ordering = NULL, 
  folds = NULL, ids, confidence = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ci.pooled.cvAUC_+3A_predictions">predictions</code></td>
<td>

<p>A vector, matrix, list, or data frame containing the predictions.
</p>
</td></tr>
<tr><td><code id="ci.pooled.cvAUC_+3A_labels">labels</code></td>
<td>

<p>A vector, matrix, list, or data frame containing the true class labels. Must have the same dimensions as <code>predictions</code>.
</p>
</td></tr>
<tr><td><code id="ci.pooled.cvAUC_+3A_label.ordering">label.ordering</code></td>
<td>

<p>The default ordering of the classes can be changed by supplying a vector containing the negative and the positive class label (negative label first, positive label second).
</p>
</td></tr>
<tr><td><code id="ci.pooled.cvAUC_+3A_folds">folds</code></td>
<td>

<p>If specified, this must be a vector of fold ids equal in length to <code>predictions</code> and <code>labels</code>, or a list of length V (for V-fold cross-validation) of vectors of indexes for the observations contained in each fold.  The <code>folds</code> argument must only be specified if the <code>predictions</code> and <code>labels</code> arguments are vectors.
</p>
</td></tr>
<tr><td><code id="ci.pooled.cvAUC_+3A_ids">ids</code></td>
<td>

<p>A vector, matrix, list, or data frame containing cluster or entity ids.  All observations from the same entity (i.e. patient) that have been pooled must have the same id.  Must have the same dimensions as 'predictions'. 
</p>
</td></tr>
<tr><td><code id="ci.pooled.cvAUC_+3A_confidence">confidence</code></td>
<td>

<p>A number between 0 and 1 that represents confidence level.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See the documentation for the <code><a href="ROCR.html#topic+prediction">prediction</a></code> function in the ROCR package for details on the <code>predictions</code>, <code>labels</code> and <code>label.ordering</code> arguments. 
</p>
<p>In pooled repeated measures data, the clusters (not the individual observations) are the independent units.  Each observation has a corresponding binary outcome.  This data structure arises often in clinical studies where each patient is measured, and an outcome is recorded, at various time points.  Then the observations from all patients are pooled together.  See the Examples section below for more information. 
</p>


<h3>Value</h3>

<p>A list containing the following named elements:
</p>
<table>
<tr><td><code>cvAUC</code></td>
<td>
<p>Cross-validated area under the curve estimate.</p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p>Standard error.</p>
</td></tr>
<tr><td><code>ci</code></td>
<td>
<p>A vector of length two containing the upper and lower bounds for the confidence interval.</p>
</td></tr>
<tr><td><code>confidence</code></td>
<td>
<p>A number between 0 and 1 representing the confidence.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Erin LeDell <a href="mailto:oss@ledell.org">oss@ledell.org</a>
</p>
<p>Maya Petersen <a href="mailto:mayaliv@berkeley.edu">mayaliv@berkeley.edu</a>
</p>
<p>Mark van der Laan <a href="mailto:laan@berkeley.edu">laan@berkeley.edu</a>
</p>


<h3>References</h3>

<p>LeDell, Erin; Petersen, Maya; van der Laan, Mark. Computationally efficient confidence intervals for cross-validated area under the ROC curve estimates. Electron. J. Statist. 9 (2015), no. 1, 1583&ndash;1607. doi:10.1214/15-EJS1035. <a href="http://projecteuclid.org/euclid.ejs/1437742107">http://projecteuclid.org/euclid.ejs/1437742107</a>.
</p>
<p>M. J. van der Laan and S. Rose. Targeted Learning: Causal Inference for Observational and Experimental Data. Springer Series in Statistics. Springer, first edition, 2011.
</p>
<p>Tobias Sing, Oliver Sander, Niko Beerenwinkel, and Thomas Lengauer. ROCR: Visualizing classifier performance in R. Bioinformatics, 21(20):3940-3941, 2005.
</p>


<h3>See Also</h3>

<p><code><a href="ROCR.html#topic+prediction">prediction</a></code>, <code><a href="ROCR.html#topic+performance">performance</a></code>,
<code><a href="#topic+cvAUC">cvAUC</a></code>, <code><a href="#topic+ci.cvAUC">ci.cvAUC</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># This example is similar to the ci.cvAUC example, with the excpection that
# this is a pooled repeated measures data set.  The example uses simulated
# data that contains multiple time point observations for 500 patients, 
# each observation having a binary outcome.
# 
# The cross-validation folds are stratified by ids that have at least one 
# positive outcome.  All observations belonging to one patient are
# contained within the save CV fold.


pooled_example &lt;- function(data, ids, V = 10){

  .cvFolds &lt;- function(Y, V, ids){
    #Stratify by outcome &amp; id
    classes &lt;- tapply(1:length(Y), INDEX = Y, FUN = split, 1)
    ids.Y1 &lt;- unique(ids[classes$`1`])  #ids that contain an observation with Y==1
    ids.noY1 &lt;- setdiff(unique(ids), ids.Y1)  #ids that have no Y==1 obvervations
    ids.Y1.split &lt;- split(sample(length(ids.Y1)), rep(1:V, length = length(ids.Y1)))
    ids.noY1.split &lt;- split(sample(length(ids.noY1)), rep(1:V, length = length(ids.noY1)))  
    folds &lt;- vector("list", V)
    for (v in seq(V)){
      idx.Y1 &lt;- which(ids %in% ids.Y1[ids.Y1.split[[v]]])
      idx.noY1 &lt;- which(ids %in% ids.noY1[ids.noY1.split[[v]]])
      folds[[v]] &lt;- c(idx.Y1, idx.noY1)
    }
    return(folds)
  }
  .doFit &lt;- function(v, folds, data){  #Train/test glm for each fold
    fit &lt;- glm(Y~., data = data[-folds[[v]],], family = binomial)
    pred &lt;- predict(fit, newdata = data[folds[[v]],], type = "response")
    return(pred)
  }
  folds &lt;- .cvFolds(Y = data$Y, ids = ids, V = V)  #Create folds
  predictions &lt;- unlist(sapply(seq(V), .doFit, folds = folds, data = data))  #CV train/predict
  predictions[unlist(folds)] &lt;- predictions  #Re-order fold indices
  out &lt;- ci.pooled.cvAUC(predictions = predictions, labels = data$Y, 
                         folds = folds, ids = ids, confidence = 0.95)
  return(out)
}


# Load data
library(cvAUC)
data(adherence)


# Get performance
set.seed(1)
out &lt;- pooled_example(data = subset(adherence, select=-c(id)), 
                      ids = adherence$id, V = 10)


# The output is given as follows:
# &gt; out
# $cvAUC
# [1] 0.8648046
#
# $se
# [1] 0.01551888
#
# $ci
# [1] 0.8343882 0.8952211
#
# $confidence
# [1] 0.95


</code></pre>

<hr>
<h2 id='cvAUC'>Cross-validated Area Under the ROC Curve (AUC)</h2><span id='topic+cvAUC'></span>

<h3>Description</h3>

<p>This function calculates cross-validated area under the ROC curve (AUC) esimates.  For each fold, the empirical AUC is calculated, and the mean of the fold AUCs is the cross-validated AUC estimate.  The area under the ROC curve is equal to the probability that the classifier will score a randomly drawn positive sample higher than a randomly drawn negative sample.  This function is a simple wrapper for the AUC functionality inside the ROCR package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cvAUC(predictions, labels, label.ordering = NULL, folds = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cvAUC_+3A_predictions">predictions</code></td>
<td>

<p>A vector, matrix, list, or data frame containing the predictions.
</p>
</td></tr>
<tr><td><code id="cvAUC_+3A_labels">labels</code></td>
<td>

<p>A vector, matrix, list, or data frame containing the true class labels. Must have the same dimensions as <code>predictions</code>.
</p>
</td></tr>
<tr><td><code id="cvAUC_+3A_label.ordering">label.ordering</code></td>
<td>

<p>The default ordering of the classes can be changed by supplying a vector containing the negative and the positive class label (negative label first, positive label second).
</p>
</td></tr>
<tr><td><code id="cvAUC_+3A_folds">folds</code></td>
<td>

<p>If specified, this must be a vector of fold ids equal in length to <code>predictions</code> and <code>labels</code>, or a list of length V (for V-fold cross-validation) of vectors of indexes for the observations contained in each fold.  The <code>folds</code> argument must only be specified if the <code>predictions</code> and <code>labels</code> arguments are vectors.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>predictions</code> and <code>labels</code> are provided as vectors and <code>folds</code> is <code>NULL</code>, then this function will return AUC (not cross-validated).   See the documentation for the <code><a href="ROCR.html#topic+prediction">prediction</a></code> function in the ROCR package for details on the <code>predictions</code>, <code>labels</code> and <code>label.ordering</code> arguments. 
</p>


<h3>Value</h3>

<table>
<tr><td><code>perf</code></td>
<td>
<p>An object of class 'performance' from the <code>ROCR</code> package.  Can be used to plot the ROC curve.</p>
</td></tr>
<tr><td><code>fold.AUC</code></td>
<td>
<p>A vector containing the AUC estimate for each fold.</p>
</td></tr>
<tr><td><code>cvAUC</code></td>
<td>
<p>Cross-validated area under the curve.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Erin LeDell <a href="mailto:oss@ledell.org">oss@ledell.org</a>
</p>


<h3>References</h3>

<p>Tobias Sing, Oliver Sander, Niko Beerenwinkel, and Thomas Lengauer. ROCR: Visualizing classifier performance in R. Bioinformatics, 21(20):3940-3941, 2005.
</p>


<h3>See Also</h3>

<p><code><a href="ROCR.html#topic+prediction">prediction</a></code>, <code><a href="ROCR.html#topic+performance">performance</a></code>, <code><a href="#topic+ci.cvAUC">ci.cvAUC</a></code>, <code><a href="#topic+ci.pooled.cvAUC">ci.pooled.cvAUC</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example of how to get CV AUC and plot the curve.
library(cvAUC)
library(ROCR)  #load example data

data(ROCR.xval)
out &lt;- cvAUC(ROCR.xval$predictions, ROCR.xval$labels)

#Plot fold AUCs
plot(out$perf, col = "grey82", lty = 3, main = "10-fold CV AUC")

#Plot CV AUC
plot(out$perf, col ="red", avg = "vertical", add = TRUE)

# See the ci.cvAUC documentation for an example 
# of how to use the `folds` argument.
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
