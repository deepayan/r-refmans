<!DOCTYPE html><html><head><title>Help for package discharge</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {discharge}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#allstats'><p> Calculate all characteristic stats for a site</p></a></li>
<li><a href='#annualExtremes'><p> Calculate annual extreme flows.</p></a></li>
<li><a href='#annualnoise'><p> Annual noise color</p></a></li>
<li><a href='#assert.equal.length'><p>Check for equal length inputs</p></a></li>
<li><a href='#assert.for.year'><p>Check <code>for.year</code> argument</p></a></li>
<li><a href='#assert.numeric.vector'><p>Check for numeric vector</p></a></li>
<li><a href='#asStreamflow'><p> Create streamflow object</p></a></li>
<li><a href='#circ.s'><p> Estimate directional statistics for one-sigma events</p></a></li>
<li><a href='#compare.periods'><p> Compare residual variability across time periods</p></a></li>
<li><a href='#etowah'><p> Etowah River Data</p></a></li>
<li><a href='#fft_metrics'><p>Discrete Fourier Transform Metrics</p></a></li>
<li><a href='#fftmetrics'>
<p>Summary of spectral anomolies for a specified year.</p></a></li>
<li><a href='#filterBaseline'><p>Filter the baseline signal for a given time window</p></a></li>
<li><a href='#findMed'><p>Find median value</p></a></li>
<li><a href='#fourierAnalysis'><p>Extract seasonal signal from time series</p></a></li>
<li><a href='#getFPExt'><p>Flood Pulse Extent (FPExt)</p></a></li>
<li><a href='#getHSAF'><p>High Spectral Anomaly Frequency (HSAF)</p></a></li>
<li><a href='#getHSAM'><p>High Spectral Anomaly Mangitude (HSAM)</p></a></li>
<li><a href='#getIDI'><p>Inter-Draught Interval (IDI)</p></a></li>
<li><a href='#getIFI'><p>Inter-Flood Interval (IFI)</p></a></li>
<li><a href='#getLSAF'><p>Low Spectral Anomaly Frequency (LSAF)</p></a></li>
<li><a href='#getLSAM'><p>Low Spectral Anomaly Mangitude (LSAM)</p></a></li>
<li><a href='#getNAA'><p>Net Annual Anomaly (NAA)</p></a></li>
<li><a href='#getSignalParts'><p>Signal parts</p></a></li>
<li><a href='#getTimingHSAM'><p>Time of occurence of High Spectral Anomaly Magnitude (HSAM)</p></a></li>
<li><a href='#getTimingLSAM'><p>Time of occurence of Low Spectral Anomaly Magnitude (LSAM)</p></a></li>
<li><a href='#getTransitionTime'><p>Transition Time</p></a></li>
<li><a href='#independentEvents'><p> Independent high- or low-flow events</p></a></li>
<li><a href='#lp3Events'><p> Find 2- and 10-year return levels</p></a></li>
<li><a href='#parameters.list'><p> Calculate all characteristic stats from a list of files</p></a></li>
<li><a href='#prepareBaseline'><p>Build baseline signal</p></a></li>
<li><a href='#residplot.extreme'><p> Plot annual extreme residuals</p></a></li>
<li><a href='#sigmaeventsplot'><p> Plot events by day of the year</p></a></li>
<li><a href='#sigmaHighFlows'><p> Estimate catastrophic flow variability</p></a></li>
<li><a href='#sigmaLowFlows'><p> Estimate catastrophic flow variability</p></a></li>
<li><a href='#sycamore'><p> Sycamore Creek Data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Fourier Analysis of Discharge Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-03-06</td>
</tr>
<tr>
<td>Description:</td>
<td>Computes discrete fast Fourier transform of river discharge data and the derived metrics.
  The methods are described in J. L. Sabo, D. M. Post (2008) &lt;<a href="https://doi.org/10.1890%2F06-1340.1">doi:10.1890/06-1340.1</a>&gt; and J. L. Sabo, A. Ruhi, G. W. Holtgrieve, V. Elliott, M. E. Arias, P. B. Ngor, T. A. Räsänsen, S. Nam (2017) &lt;<a href="https://doi.org/10.1126%2Fscience.aao1053">doi:10.1126/science.aao1053</a>&gt;.</td>
</tr>
<tr>
<td>Imports:</td>
<td>lmom, ggplot2, CircStats, checkmate, boot</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.2)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-03-07 00:35:30 UTC; Samarth</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Author:</td>
<td>Samarth Shah [aut, cre],
  Albert Ruhi [aut],
  Future H2O [cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Samarth Shah &lt;sbshah10@asu.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-03-08 15:42:48 UTC</td>
</tr>
</table>
<hr>
<h2 id='allstats'> Calculate all characteristic stats for a site </h2><span id='topic+allstats'></span>

<h3>Description</h3>

<p>Calculates all parameters at once for a single data file.  The output gives numerical results from the functions <code><a href="#topic+annualnoise">annualnoise</a></code>, <code><a href="#topic+fourierAnalysis">fourierAnalysis</a></code>, <code><a href="#topic+lp3Events">lp3Events</a></code>,<code><a href="#topic+sigmaHighFlows">sigmaHighFlows</a></code>, and <code><a href="#topic+sigmaLowFlows">sigmaLowFlows</a></code>.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>allstats(file.name, river.name, file.type="txt", date.col=3, 
discharge.col=4, skipped.rows=28)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="allstats_+3A_file.name">file.name</code></td>
<td>
<p> Character string of the form &quot;file.txt&quot; or &quot;file.csv&quot;.  </p>
</td></tr>
<tr><td><code id="allstats_+3A_river.name">river.name</code></td>
<td>
<p> Character string specifying river name.</p>
</td></tr>
<tr><td><code id="allstats_+3A_file.type">file.type</code></td>
<td>
<p>Character string, &quot;txt&quot; or &quot;csv&quot;.  Defaults to &quot;txt&quot;.</p>
</td></tr>
<tr><td><code id="allstats_+3A_date.col">date.col</code></td>
<td>
<p> Numeric specifying column containing date in &quot;MM-DD-YYYY&quot; format.  Defaults to 3.</p>
</td></tr>
<tr><td><code id="allstats_+3A_discharge.col">discharge.col</code></td>
<td>
<p> Numeric specifying column containing discharge data. Defaults to 4. </p>
</td></tr>
<tr><td><code id="allstats_+3A_skipped.rows">skipped.rows</code></td>
<td>
<p>Numeric indicating number of rows to skip at beginning of file.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with columns
</p>
<table>
<tr><td><code>a.rms</code></td>
<td>
<p> Root mean squared amplitude. </p>
</td></tr>
<tr><td><code>n.rms</code></td>
<td>
<p> Root mean squared noise. </p>
</td></tr>
<tr><td><code>snr</code></td>
<td>
<p> Signal-to-noise ratio. </p>
</td></tr>
<tr><td><code>theta.d</code></td>
<td>
<p> Daily noise color. </p>
</td></tr>
<tr><td><code>theta.a</code></td>
<td>
<p> Annual noise color. </p>
</td></tr>
<tr><td><code>sigma.lf</code></td>
<td>
<p> Sigma for low flow events. </p>
</td></tr>
<tr><td><code>sigma.hf</code></td>
<td>
<p> Sigma for high flow events. </p>
</td></tr>
<tr><td><code>q2</code></td>
<td>
<p> 2-year return level (flood).</p>
</td></tr>
<tr><td><code>q10</code></td>
<td>
<p> 10-year return level (flood).</p>
</td></tr>
<tr><td><code>l2</code></td>
<td>
<p> 2-year return level (drought).</p>
</td></tr>
<tr><td><code>l10</code></td>
<td>
<p> 10-year return level (drought).</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The arguments &quot;date.col&quot;, &quot;discharge.col&quot;, and &quot;skipped.rows&quot; are designed to give some flexibility in file input; however, tab-delimited text without extra columns will likely work best. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+parameters.list">parameters.list</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># allstats function works on files
# read R data into temporary file handle
data(sycamore)
f = tempfile(fileext="txt")
write.table(sycamore, file=f, sep="\t")

# print all statistics for this river
allstats(f,river.name="sycamore", date.col = 2, discharge.col = 3, skipped.rows = 1)

</code></pre>

<hr>
<h2 id='annualExtremes'> Calculate annual extreme flows. </h2><span id='topic+annualExtremes'></span>

<h3>Description</h3>

<p>Calculates annual extreme events for all years in the series.  By default, the function finds annual extreme discharge in <code>streamflow</code> object, but any matrix or <code>data.frame</code> may be used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>annualExtremes(x,data.col=NULL, year.col=NULL, moving.avg=FALSE)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="annualExtremes_+3A_x">x</code></td>
<td>
<p> Object from which to extract extremes. Should be of class <code>streamflow</code> or <code>data.frame</code> or matrix.  </p>
</td></tr>
<tr><td><code id="annualExtremes_+3A_data.col">data.col</code></td>
<td>
<p> Optional.  If input is a matrix or <code>data.frame</code>, specifies which column contains the data.</p>
</td></tr>
<tr><td><code id="annualExtremes_+3A_year.col">year.col</code></td>
<td>
<p> Optional.  If input is a matrix or <code>data.frame</code>, specifies which column contains the year.</p>
</td></tr>
<tr><td><code id="annualExtremes_+3A_moving.avg">moving.avg</code></td>
<td>
<p> Logical; defaults to FALSE. Can be specified TRUE to use 7-day moving average discharge when input is of class &quot;<code>streamflow</code>&quot;. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>list</code> with items
</p>
<table>
<tr><td><code>annual.max</code></td>
<td>
<p> Matrix giving maximum flow for each year in series.  Each row contains the maximum values and all corresponding variables from that observation.</p>
</td></tr>
<tr><td><code>annual.min</code></td>
<td>
<p> Matrix giving minimum flow for each year in series.  Each row contains the minimum values and all corresponding variables from that observation.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>data(sycamore)
sycamore.flows&lt;-asStreamflow(sycamore,river.name="Sycamore Creek")
syc.extremes&lt;-annualExtremes(sycamore.flows)
names(syc.extremes)
syc.extremes$annual.max[1:3,]

</code></pre>

<hr>
<h2 id='annualnoise'> Annual noise color </h2><span id='topic+annualnoise'></span><span id='topic+summary.annualnoise'></span>

<h3>Description</h3>

 
<p>The autocovariance function is estimated for the annual maxima in the series.  An autoregressive model of the order of the highest significant lag is fit, using the Yule-Walker method to estimate the parameters.  The function is transformed into the frequency domain, yielding an estimate <code>theta.a</code> of the annual noise color.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>annualnoise(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="annualnoise_+3A_x">x</code></td>
<td>
<p> A numeric vector of annual extremes. A <code>streamflow</code> object may also be used.  If input is <code>streamflow</code> the function uses annual maximum discharge. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>To determine the order of the AR model, the ACF is calculated at all lags less than or equal to the highest power of 2 less than the length of the series.  The order of the AR model is the lag with the highest significantly non-zero autocorrelation.
</p>


<h3>Value</h3>

<p>An object of S3 class <code>annualnoise</code> with the following attributes:
</p>
<table>
<tr><td><code>auto.corr</code></td>
<td>
<p> Sample autocorrelation. </p>
</td></tr>
<tr><td><code>lm.fit</code></td>
<td>
 <p><code>lm</code> object from regression of log power spectrum on log frequency. </p>
</td></tr>
<tr><td><code>interval</code></td>
<td>
<p> Upper and lower bounds of a 95% acceptance region when <code class="reqn">\rho=0</code>.  </p>
</td></tr>
<tr><td><code>log.log</code></td>
<td>
<p> Matrix with log frequency and log power spectrum. </p>
</td></tr>
<tr><td><code>reg.stats</code></td>
<td>
<p>Slope and intercept of regression of log power spectrum on log frequency, where slope is the annual noise color (<code>theta.a</code>).</p>
</td></tr>
<tr><td><code>order</code></td>
<td>
<p> Indicates order of fitted AR model. </p>
</td></tr>
<tr><td><code>fit.ar</code></td>
<td>
<p>Object of class <code>ar</code> summarizing the fitted AR model.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>data(sycamore)
sycamore.flows&lt;-asStreamflow(sycamore,river.name="Sycamore Creek")
syc.ar&lt;-annualnoise(sycamore.flows)
</code></pre>

<hr>
<h2 id='assert.equal.length'>Check for equal length inputs</h2><span id='topic+assert.equal.length'></span>

<h3>Description</h3>

<p>Ensure that the given arguments are equal length vectors
</p>


<h3>Usage</h3>

<pre><code class='language-R'>assert.equal.length(arg0, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="assert.equal.length_+3A_arg0">arg0</code></td>
<td>
<p>At least one input argument to be checked needs to be given</p>
</td></tr>
<tr><td><code id="assert.equal.length_+3A_...">...</code></td>
<td>
<p>Other inputs whose length equality needs to be checked</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Stops execution in case of failed check
</p>

<hr>
<h2 id='assert.for.year'>Check <code>for.year</code> argument</h2><span id='topic+assert.for.year'></span>

<h3>Description</h3>

<p>Ensure that the for.year argument is a numeric scalar value
</p>


<h3>Usage</h3>

<pre><code class='language-R'>assert.for.year(for.year)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="assert.for.year_+3A_for.year">for.year</code></td>
<td>
<p>input argument to be checked</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Stops execution in case of failed check
</p>

<hr>
<h2 id='assert.numeric.vector'>Check for numeric vector</h2><span id='topic+assert.numeric.vector'></span>

<h3>Description</h3>

<p>Ensure that the given argument is a numeric vector
</p>


<h3>Usage</h3>

<pre><code class='language-R'>assert.numeric.vector(arg)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="assert.numeric.vector_+3A_arg">arg</code></td>
<td>
<p>input argument to be checked</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Stops execution in case of failed check
</p>

<hr>
<h2 id='asStreamflow'> Create streamflow object </h2><span id='topic+asStreamflow'></span><span id='topic+print.streamflow'></span><span id='topic+summary.streamflow'></span>

<h3>Description</h3>

<p>This function converts a dataset to S3 object of class &quot;streamflow&quot;.  Data in this format can be provided as arguments to other functions to call default procedures.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>asStreamflow(x,river.name=NULL, start.date=NULL, end.date=NULL,max.na=10)
## S3 method for class 'streamflow'
print(x, ...)
## S3 method for class 'streamflow'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="asStreamflow_+3A_x">x</code>, <code id="asStreamflow_+3A_object">object</code></td>
<td>
<p> A matrix with dates in the first column and discharge values in the second column.  Dates should be of the format &quot;YYYY-MM-DD&quot;.  </p>
</td></tr>
<tr><td><code id="asStreamflow_+3A_river.name">river.name</code></td>
<td>
<p> A character vector listing the river name. </p>
</td></tr>
<tr><td><code id="asStreamflow_+3A_start.date">start.date</code></td>
<td>
<p> Optional character string giving date to start analysis, of the format &quot;YYYY-MM-DD&quot;</p>
</td></tr>
<tr><td><code id="asStreamflow_+3A_end.date">end.date</code></td>
<td>
<p> Optional date to start analysis, of the format &quot;YYYY-MM-DD&quot; </p>
</td></tr>
<tr><td><code id="asStreamflow_+3A_max.na">max.na</code></td>
<td>
<p> Optional number specifying maximum NA values to allow. </p>
</td></tr>
<tr><td><code id="asStreamflow_+3A_...">...</code></td>
<td>
<p>Other parameters. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>streamflow</code> containing the following items:
</p>
<table>
<tr><td><code>data</code></td>
<td>
<p> Data frame with 8 columns </p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p> Number of observations in series. </p>
</td></tr>
<tr><td><code>n.nas</code></td>
<td>
<p> Number of NA observations in series. </p>
</td></tr>
<tr><td><code>start</code></td>
<td>
<p> Start date. </p>
</td></tr>
<tr><td><code>end</code></td>
<td>
<p> End date. </p>
</td></tr>
<tr><td><code>name</code></td>
<td>
<p> Name of river. </p>
</td></tr>
<tr><td><code>na.info</code></td>
<td>
<p> Matrix containing the index and start date of all blocks of more than one NA observation. </p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>data(sycamore)
sycamore.flows&lt;-asStreamflow(sycamore,start.date="1965-01-01", 
                             end.date="2010-03-15",river.name="Sycamore Creek")
</code></pre>

<hr>
<h2 id='circ.s'> Estimate directional statistics for one-sigma events </h2><span id='topic+circ.s'></span>

<h3>Description</h3>

<p>Uses the package <a href="https://cran.r-project.org/package=CircStats">&quot;CircStats&quot;</a> to find the mean direction, rho, and kappa of the von Mises distribution summarizing the ordinal day of high- and low-flow events.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>circ.s(x) 

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="circ.s_+3A_x">x</code></td>
<td>
<p> Output from &quot;compare.periods&quot; function (of class &quot;<code>compflows</code>&quot;). </p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>circstats</code></td>
<td>
 <p><code>data.frame</code> with rows corresponding to the high- and low-flows for both periods. The columns list n, mu, rho, and kappa as calculated using the CircStats package. </p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+compare.periods">compare.periods</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load data
data("sycamore")

# compare for periods from 1960 to 1979 and 1980 to 1999
comp = compare.periods(c("1960-01-01", "1979-12-31"), 
c("1980-01-01", "1999-12-31"), sycamore, plot=FALSE)

circ.s(comp)
</code></pre>

<hr>
<h2 id='compare.periods'> Compare residual variability across time periods </h2><span id='topic+compare.periods'></span><span id='topic+plot.compflows'></span>

<h3>Description</h3>

<p>The function finds the seasonal signal in the first of two time periods within the data series.  This signal is used to calculate residual flows in the first time period and &quot;historical residuals&quot;, the residuals when the second period is compared to the signal in the first period. 
</p>
<p>The output of the function gives event information for all residual events greater than <code class="reqn">\sigma</code> as calculated from the functions <code>sigmaHighFlows</code> and <code>sigmaLowFlows</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compare.periods(p1, p2, x, plot=T)
## S3 method for class 'compflows'
 plot(x, ...)


</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compare.periods_+3A_p1">p1</code></td>
<td>
<p> Character vector specifying start and end date of the first period.  &quot;YYYY-MM-DD&quot; format.</p>
</td></tr>
<tr><td><code id="compare.periods_+3A_p2">p2</code></td>
<td>
<p> Character vector specifying start and end date of the second period.  &quot;YYYY-MM-DD&quot; format. </p>
</td></tr>
<tr><td><code id="compare.periods_+3A_x">x</code></td>
<td>
<p> Matrix with first column specifying dates and second column specifying raw discharge data. </p>
</td></tr>
<tr><td><code id="compare.periods_+3A_plot">plot</code></td>
<td>
<p>Logical; defaults to TRUE. If TRUE, the seasonal signal for both periods will be plotted.</p>
</td></tr>
<tr><td><code id="compare.periods_+3A_...">...</code></td>
<td>
<p>Other parameters. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>Object of S3 ckass <code>compflows</code> with the following items: 
</p>
<table>
<tr><td><code>sigma.low</code></td>
<td>
<p>Estimate of <code class="reqn">\sigma-lf</code> from period 1 </p>
</td></tr>
<tr><td><code>sigma.high</code></td>
<td>
<p>Estimate of <code class="reqn">\sigma-hf</code> from period 1</p>
</td></tr>
<tr><td><code>p1.levents</code></td>
<td>
<p> Matrix of low flow events for period 1 </p>
</td></tr>
<tr><td><code>p1.hevents</code></td>
<td>
<p> Matrix of high flow events for period 1 </p>
</td></tr>
<tr><td><code>p2.levents</code></td>
<td>
<p> Matrix of low flow events for period 2 </p>
</td></tr>
<tr><td><code>p2.hevents</code></td>
<td>
<p> Matrix of high flow events for period 2 </p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+sigmaHighFlows">sigmaHighFlows</a></code>
<code><a href="#topic+sigmaLowFlows">sigmaLowFlows</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load data
data("sycamore")

# compare for periods from 1960 to 1979 and 1980 to 1999
compare.periods(c("1960-01-01", "1979-12-31"), 
c("1980-01-01", "1999-12-31"), sycamore)
</code></pre>

<hr>
<h2 id='etowah'> Etowah River Data </h2><span id='topic+etowah'></span>

<h3>Description</h3>

<p>A data series from USGS station 02392000, Etowah River (Canton,GA).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  data(etowah)
</code></pre>


<h3>Format</h3>

<p>The data are supplied as a matrix with years in the first column and average daily discharge in the second column.
The series contains 18282 observations starting Jan 1, 1960 and ending Dec 31, 2009.
</p>


<h3>Source</h3>


<ul>
<li><p>USGS National Water Information Sysem: http://waterdata.usgs.gov/usa/nwis/uv?site_no=02392000
</p>
</li></ul>


<hr>
<h2 id='fft_metrics'>Discrete Fourier Transform Metrics</h2><span id='topic+fft_metrics'></span>

<h3>Description</h3>

<p>This is a wrapper function to calculate all the DFFT metrics for the given input signal
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fft_metrics(data, candmin, candmax, river.name = "",
  baseline.signal = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fft_metrics_+3A_data">data</code></td>
<td>
<p>A matrix with dates in the first column and discharge values in the second column.
Dates should be of the format &quot;YYYY-MM-DD&quot;</p>
</td></tr>
<tr><td><code id="fft_metrics_+3A_candmin">candmin</code></td>
<td>
<p>numeric vector of possible ordinal days in which the predicted signal is lowest. This range need not be narrow, but a string of consecutive days should not include more than only local minimum. Used for calculating the high- and low-flow windows</p>
</td></tr>
<tr><td><code id="fft_metrics_+3A_candmax">candmax</code></td>
<td>
<p>numeric vector of possible ordinal days in which the predicted signal is highest. This range need not be narrow, but a string of consecutive days should not include more than only local maximum.</p>
</td></tr>
<tr><td><code id="fft_metrics_+3A_river.name">river.name</code></td>
<td>
<p>A character vector listing the river name.</p>
</td></tr>
<tr><td><code id="fft_metrics_+3A_baseline.signal">baseline.signal</code></td>
<td>
<p>If <code>NULL</code>, this function calculates baseline.signal using fourierAnalysis over the entire input series. The baseline signal can also be explicitly calculated and passed in as parameter. Check function <code>prepareBaseline()</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing 2 data frames:
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>high.level.metrics</code> </td><td style="text-align: left;"> Data frame containing NAA and FPExt values for each year in the given series</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>naa.shape.components</code> </td><td style="text-align: left;"> Data frame containing HSAM, LSAM, Transition time, HSAF, LSAF, timing of HSAM, timing of LSAM, IFI, IDI
</td>
</tr>

</table>



<h3>Examples</h3>

<pre><code class='language-R'># load sample data
data("sycamore")
x = sycamore

# get streamflow object for the sample data
x.streamflow = asStreamflow(x)

# prepare baseline signal 
x.bl = prepareBaseline(x.streamflow)

# fetch the DFFT metrics for this sample data
# "candmax" chosen because preliminary analysis (e.g. with fourierAnalysis 
#           output) shows the signal is highest sometime between
#           day 190 and day 330
# "candmin" can be estimated analogously.
x.fftmetrics = fft_metrics(x, river.name = "Sycamore", candmin = c(40:125), 
                           candmax = c(190:330), baseline.signal = x.bl)

</code></pre>

<hr>
<h2 id='fftmetrics'>
Summary of spectral anomolies for a specified year.</h2><span id='topic+fftmetrics'></span>

<h3>Description</h3>

<p>This function takes as input a streamFlow object and a year, and outputs the timing and magnitude of noteworthy spectral anomolies.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fftmetrics(x,year,candmin,candmax)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fftmetrics_+3A_x">x</code></td>
<td>
<p>streamflow object, as output from the asStreamflow function.
</p>
</td></tr>
<tr><td><code id="fftmetrics_+3A_year">year</code></td>
<td>
<p>integer; data from this year will be analyzed.  The plotted hydrograph will include data from August of the previous year to April of the following year.</p>
</td></tr>
<tr><td><code id="fftmetrics_+3A_candmin">candmin</code></td>
<td>
<p>numeric vector of possible ordinal days in which the predicted signal is lowest.  This range need not be narrow, but a string of consecutive days should not include more than only local minimum. Used for calculating the high- and low-flow windows.</p>
</td></tr>
<tr><td><code id="fftmetrics_+3A_candmax">candmax</code></td>
<td>
<p>numeric vector of possible ordinal days in which the predicted signal is highest.  This range need not be narrow, but a string of consecutive days should not include more than only local maximum.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list object with the following components;
</p>
<table>
<tr><td><code>sam</code></td>
<td>
<p>dataframe where row 1 corresponds to the largest low-residual event in the year, and row 2 corresponds to the largest high-residual.  The dataframe contains each event's date, ordinal day, magnitude of residual and signal, index in the original data, and timing (in days) relative to the reference point.</p>
</td></tr>
<tr><td><code>ref.point</code></td>
<td>
<p>date used as a reference point for the timing of max and min events.  If not given by the user, it is the first local maximum of the signal, within the year specified.  </p>
</td></tr>
<tr><td><code>events</code></td>
<td>
<p>dataframe with rows corresponding to start dates of the longest low-flow and high-flow events.  The data frame contains signal and residual data for the start date and the lenght of the run.</p>
</td></tr>
<tr><td><code>auc</code></td>
<td>
<p>dataframe with three values: 'net.auc', 'rel.auc.low', and rel.auc.high'. 'net.auc' is the sum of positive residuals in the high flow window divided by the sum of negative residuals in the low flow window. 'rel.auc.low' is postive residuals divided by the sum of negative residuals </p>
</td></tr>
<tr><td><code>noise.color</code></td>
<td>
<p>numeric, &quot;theta.d&quot; as calculated as in the fourierAnalysis function.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>data(etowah)
etowah.flows=asStreamflow(etowah, river.name="Etowah")
# "candmax" chosen because preliminary analysis (e.g., with fourierAnalysis output) 
# shows the signal is highest sometime between day 40 and day 125.
# "candmin" can be estimated analogously.
fftmetrics(etowah.flows,2002,candmin=c(190:330),candmax=c(40:125)) </code></pre>

<hr>
<h2 id='filterBaseline'>Filter the baseline signal for a given time window</h2><span id='topic+filterBaseline'></span>

<h3>Description</h3>

<p>Filter the baseline signal for a given time window
</p>


<h3>Usage</h3>

<pre><code class='language-R'>filterBaseline(bl, filter.date.start, filter.date.end,
  date.format = "%Y-%m-%d")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="filterBaseline_+3A_bl">bl</code></td>
<td>
<p>baseline signal as returned from the function <code>prepareBaseline()</code></p>
</td></tr>
<tr><td><code id="filterBaseline_+3A_filter.date.start">filter.date.start</code></td>
<td>
<p>start date of the filtering window</p>
</td></tr>
<tr><td><code id="filterBaseline_+3A_filter.date.end">filter.date.end</code></td>
<td>
<p>end date of the filtering window</p>
</td></tr>
<tr><td><code id="filterBaseline_+3A_date.format">date.format</code></td>
<td>
<p>format of date specified in <code>filter.date.start</code> and <code>filter.date.end</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>baseline signal filtered for the given date window
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load sample data
data("sycamore")
x = sycamore

# get streamflow object for the sample data
x.streamflow = asStreamflow(x)

# baseline for single run for all the years in input signal
x.bl = prepareBaseline(x.streamflow)

# filter the baseline signal between years 1993 and 2000
x.bl.filtered = filterBaseline(x.bl, filter.date.start = "1993-01-01",
                               filter.date.end = "2000-12-31")

</code></pre>

<hr>
<h2 id='findMed'>Find median value</h2><span id='topic+findMed'></span>

<h3>Description</h3>

<p>Find median value from the filtered part of the input vector.
This function is used as a helper to the bootstrapping routine in prepare baseline
</p>


<h3>Usage</h3>

<pre><code class='language-R'>findMed(data, indices)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="findMed_+3A_data">data</code></td>
<td>
<p>complete input vector</p>
</td></tr>
<tr><td><code id="findMed_+3A_indices">indices</code></td>
<td>
<p>logical vector to filter indices from <code>data</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>median value of the filtered vector
</p>

<hr>
<h2 id='fourierAnalysis'>Extract seasonal signal from time series </h2><span id='topic+fourierAnalysis'></span><span id='topic+plot.ssignal'></span><span id='topic+summary.ssignal'></span>

<h3>Description</h3>

<p>The fast Fourier transform is used to extract the seasonal signal of a time series.  The significant frequencies are found from among periods of length 2-, 3-, 4-, 6-, 12-, and 18-months.  
</p>
<p>The signal may be specified as stationary or non-stationary.  If a non-stationary fit is allowed, simple linear regression estimates the long term linear trend.   The seasonal signal is calculcated from the residuals.
</p>
<p>Predicted flow (and corresponding residual) at each time point is calculated from seasonal signal and, if non-stationary, long term trend coefficient.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fourierAnalysis(x, stationary=F)
## S3 method for class 'ssignal'
 plot(x, plot.type="hydrograph", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fourierAnalysis_+3A_x">x</code></td>
<td>
<p> An object of class <code>streamflow</code></p>
</td></tr>
<tr><td><code id="fourierAnalysis_+3A_stationary">stationary</code></td>
<td>
<p> Logical; defaults to FALSE.</p>
</td></tr>
<tr><td><code id="fourierAnalysis_+3A_plot.type">plot.type</code></td>
<td>
<p> Indicates the type of plot to create.  The default &quot;hydrograph&quot; produces a plot of ordinary day and log normalized discharge, with the seasonal signal overlaid.  &quot;auto.corr&quot; produces a plot of daily autocorrelation as calculated from the residual flows.</p>
</td></tr>
<tr><td><code id="fourierAnalysis_+3A_...">...</code></td>
<td>
<p>Other parameters. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>ssignal</code> with items
</p>
<table>
<tr><td><code>signal</code></td>
<td>
<p> Data matrix augmented to included predicted and residual values. </p>
</td></tr>
<tr><td><code>terms</code></td>
<td>
<p> Matrix containing amplitude, phase, and frequency of seasonal signal.  </p>
</td></tr>
<tr><td><code>detrend.fit</code></td>
<td>
<p> An <code>lm</code> object from regression of discharge on index of observation.  </p>
</td></tr>
<tr><td><code>logps.regression</code></td>
<td>
<p> An <code>lm</code> object from regression of log power spectrum on log frequency (where log frequencies have seasonal signal removed.) </p>
</td></tr>
<tr><td><code>rms</code></td>
<td>
 <p><code>list</code> containing RMS amplitude for noise, RMS amplitude for signal, and signal-to-noise ratio. </p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>data(sycamore)
sycamore.flows&lt;-asStreamflow(sycamore,river.name="Sycamore Creek")
syc.seas&lt;-fourierAnalysis(sycamore.flows)
summary(syc.seas)
</code></pre>

<hr>
<h2 id='getFPExt'>Flood Pulse Extent (FPExt)</h2><span id='topic+getFPExt'></span>

<h3>Description</h3>

<p>Calculate the Flood Pulse Extent (FPExt) from the given residual values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getFPExt(resid, years, for.year = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getFPExt_+3A_resid">resid</code></td>
<td>
<p>A vector of residual values generated with respect to the baseline signal</p>
</td></tr>
<tr><td><code id="getFPExt_+3A_years">years</code></td>
<td>
<p>A vector of years corrosponding to the residual values</p>
</td></tr>
<tr><td><code id="getFPExt_+3A_for.year">for.year</code></td>
<td>
<p>(optional) Calculate FPExt values only for the given year in this argument.
If argument is omitted, NAA values for all years are calculated.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame containing two columns: 
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>year</code> </td><td style="text-align: left;"> First column, represents year </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>FPExt</code> </td><td style="text-align: left;"> Second column, represents FPExt values
</td>
</tr>

</table>



<h3>Examples</h3>

<pre><code class='language-R'># load sample data
data("sycamore")
x = sycamore

# get streamflow object for the sample data
x.streamflow = asStreamflow(x)

# prepare baseline signal 
x.bl = prepareBaseline(x.streamflow)

# FPExt
fpext = getFPExt(x.bl$resid.sig, x.streamflow$data$year)

</code></pre>

<hr>
<h2 id='getHSAF'>High Spectral Anomaly Frequency (HSAF)</h2><span id='topic+getHSAF'></span>

<h3>Description</h3>

<p>Compute High Spectral Anomaly Frequency (HSAF) from the given residual values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getHSAF(resid, years, for.year = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getHSAF_+3A_resid">resid</code></td>
<td>
<p>A vector of residual values generated with respect to the baseline signal</p>
</td></tr>
<tr><td><code id="getHSAF_+3A_years">years</code></td>
<td>
<p>A vector of years corrosponding to the residual values</p>
</td></tr>
<tr><td><code id="getHSAF_+3A_for.year">for.year</code></td>
<td>
<p>(optional) Calculate HSAF values only for the given year in this argument.
If argument is omitted, HSAF values for all years are calculated.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame containing two Columns:
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>year</code> </td><td style="text-align: left;"> First column, represents year </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>HSAF</code> </td><td style="text-align: left;"> Second column, represents HSAF values
</td>
</tr>

</table>



<h3>Examples</h3>

<pre><code class='language-R'># load sample data
data("sycamore")
x = sycamore

# get streamflow object for the sample data
x.streamflow = asStreamflow(x)

# prepare baseline signal 
x.bl = prepareBaseline(x.streamflow)

# HSAF
hsaf = getHSAF(x.bl$resid.sig, x.streamflow$data$year)

</code></pre>

<hr>
<h2 id='getHSAM'>High Spectral Anomaly Mangitude (HSAM)</h2><span id='topic+getHSAM'></span>

<h3>Description</h3>

<p>Compute High Spectral Anomaly Magnitude (HSAM) from the given residual values each year
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getHSAM(resid, years, for.year = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getHSAM_+3A_resid">resid</code></td>
<td>
<p>A vector of residual values generated with respect to the baseline signal</p>
</td></tr>
<tr><td><code id="getHSAM_+3A_years">years</code></td>
<td>
<p>A vector of years corrosponding to the residual values</p>
</td></tr>
<tr><td><code id="getHSAM_+3A_for.year">for.year</code></td>
<td>
<p>(optional) Calculate HSAM values only for the given year in this argument.
If argument is omitted, HSAM values for all years are calculated.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame containing four columns:
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>year</code> </td><td style="text-align: left;"> First column, represents year </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>HSAM</code> </td><td style="text-align: left;"> Second column, represents HSAM values </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>index.year</code> </td><td style="text-align: left;"> Third column, representing index of HSAM value in that <code>year</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>index.all</code> </td><td style="text-align: left;"> Fourth column, representing index of HSAM value in the input <code>resid</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Examples</h3>

<pre><code class='language-R'># load sample data
data("sycamore")
x = sycamore

# get streamflow object for the sample data
x.streamflow = asStreamflow(x)

# prepare baseline signal 
x.bl = prepareBaseline(x.streamflow)

# HSAM
hsam = getHSAM(x.bl$resid.sig, x.streamflow$data$year)

</code></pre>

<hr>
<h2 id='getIDI'>Inter-Draught Interval (IDI)</h2><span id='topic+getIDI'></span>

<h3>Description</h3>

<p>Compute Inter-Draught Interval (IDI) from the given residual values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getIDI(resid, years, highflow.start, highflow.end, unique.years,
  for.year = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getIDI_+3A_resid">resid</code></td>
<td>
<p>A vector of residual values generated with respect to the baseline signal</p>
</td></tr>
<tr><td><code id="getIDI_+3A_years">years</code></td>
<td>
<p>A vector of years corrosponding to the residual values</p>
</td></tr>
<tr><td><code id="getIDI_+3A_highflow.start">highflow.start</code></td>
<td>
<p>A vector giving start index of high-flow window in each year</p>
</td></tr>
<tr><td><code id="getIDI_+3A_highflow.end">highflow.end</code></td>
<td>
<p>A vector giving end index of high-flow window in each year</p>
</td></tr>
<tr><td><code id="getIDI_+3A_unique.years">unique.years</code></td>
<td>
<p>A vector or year values corresponding to the <code>highflow.start</code> 
and <code>highflow.end</code> values.</p>
</td></tr>
<tr><td><code id="getIDI_+3A_for.year">for.year</code></td>
<td>
<p>(optional) Calculate IDI values only for the given year in this argument.
If argument is omitted, IDI values for all years are calculated.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame containing two columns:
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>year</code> </td><td style="text-align: left;"> First column, represents year </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>IDI</code> </td><td style="text-align: left;"> Second column, represents IDI values
</td>
</tr>

</table>



<h3>Examples</h3>

<pre><code class='language-R'># load sample data
data("sycamore")
x = sycamore

# get streamflow object for the sample data
x.streamflow = asStreamflow(x)

# prepare baseline signal 
x.bl = prepareBaseline(x.streamflow)

# signal parts
x.sp = getSignalParts(x.bl$pred2, candmin = c(40:125), candmax = c(190:330),
                      years = x.streamflow$data$year, 
                      months = x.streamflow$data$month,
                      jdays = x.streamflow$data$jday)

# IDI
idi = getIDI(x.bl$resid.sig, x.streamflow$data$year, x.sp$HF.window.start, 
             x.sp$HF.window.end, x.sp$year)

</code></pre>

<hr>
<h2 id='getIFI'>Inter-Flood Interval (IFI)</h2><span id='topic+getIFI'></span>

<h3>Description</h3>

<p>Compute Inter-Flood Interval (IFI) from the given residual values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getIFI(resid, years, lowflow.start, lowflow.end, unique.years,
  for.year = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getIFI_+3A_resid">resid</code></td>
<td>
<p>A vector of residual values generated with respect to the baseline signal</p>
</td></tr>
<tr><td><code id="getIFI_+3A_years">years</code></td>
<td>
<p>A vector of years corrosponding to the residual values</p>
</td></tr>
<tr><td><code id="getIFI_+3A_lowflow.start">lowflow.start</code></td>
<td>
<p>A vector giving start index of low-flow window in each year</p>
</td></tr>
<tr><td><code id="getIFI_+3A_lowflow.end">lowflow.end</code></td>
<td>
<p>A vector giving end index of low-flow window in each year</p>
</td></tr>
<tr><td><code id="getIFI_+3A_unique.years">unique.years</code></td>
<td>
<p>A vector or year values corresponding to the <code>highflow.start</code> 
and <code>highflow.end</code> values.</p>
</td></tr>
<tr><td><code id="getIFI_+3A_for.year">for.year</code></td>
<td>
<p>(optional) Calculate IFI values only for the given year in this argument.
If argument is omitted, IFI values for all years are calculated.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame containing two columns:
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>year</code> </td><td style="text-align: left;"> First column, represents year </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>IFI</code> </td><td style="text-align: left;"> Second column, represents IFI values
</td>
</tr>

</table>



<h3>Examples</h3>

<pre><code class='language-R'># load sample data
data("sycamore")
x = sycamore

# get streamflow object for the sample data
x.streamflow = asStreamflow(x)

# prepare baseline signal 
x.bl = prepareBaseline(x.streamflow)

# signal parts
x.sp = getSignalParts(x.bl$pred2, candmin = c(40:125), candmax = c(190:330),
                      years = x.streamflow$data$year, 
                      months = x.streamflow$data$month,
                      jdays = x.streamflow$data$jday)

# IFI
ifi = getIFI(x.bl$resid.sig, x.streamflow$data$year, x.sp$LF.window.start, 
             x.sp$LF.window.end, x.sp$year)

</code></pre>

<hr>
<h2 id='getLSAF'>Low Spectral Anomaly Frequency (LSAF)</h2><span id='topic+getLSAF'></span>

<h3>Description</h3>

<p>Compute Low Spectral Anomaly Frequency (LSAF) from the given residual values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getLSAF(resid, years, for.year = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getLSAF_+3A_resid">resid</code></td>
<td>
<p>A vector of residual values generated with respect to the baseline signal</p>
</td></tr>
<tr><td><code id="getLSAF_+3A_years">years</code></td>
<td>
<p>A vector of years corrosponding to the residual values</p>
</td></tr>
<tr><td><code id="getLSAF_+3A_for.year">for.year</code></td>
<td>
<p>(optional) Calculate LSAF values only for the given year in this argument.
If argument is omitted, LSAF values for all years are calculated.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame containing two Columns:
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>year</code> </td><td style="text-align: left;"> First column, represents year </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>LSAF</code> </td><td style="text-align: left;"> Second column, represents LSAF values
</td>
</tr>

</table>



<h3>Examples</h3>

<pre><code class='language-R'># load sample data
data("sycamore")
x = sycamore

# get streamflow object for the sample data
x.streamflow = asStreamflow(x)

# prepare baseline signal 
x.bl = prepareBaseline(x.streamflow)

# LSAF
lsaf = getLSAF(x.bl$resid.sig, x.streamflow$data$year)

</code></pre>

<hr>
<h2 id='getLSAM'>Low Spectral Anomaly Mangitude (LSAM)</h2><span id='topic+getLSAM'></span>

<h3>Description</h3>

<p>Compute Low Spectral Anomaly Magnitude (LSAM) from the given residual values each year
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getLSAM(resid, years, for.year = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getLSAM_+3A_resid">resid</code></td>
<td>
<p>A vector of residual values generated with respect to the baseline signal</p>
</td></tr>
<tr><td><code id="getLSAM_+3A_years">years</code></td>
<td>
<p>A vector of years corrosponding to the residual values</p>
</td></tr>
<tr><td><code id="getLSAM_+3A_for.year">for.year</code></td>
<td>
<p>(optional) Calculate LSAM values only for the given year in this argument.
If argument is omitted, LSAM values for all years are calculated.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame containing four columns:
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>year</code> </td><td style="text-align: left;"> First column, represents year </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>LSAM</code> </td><td style="text-align: left;"> Second column, represents LSAM values </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>index.year</code> </td><td style="text-align: left;"> Third column, representing index of LSAM value in that <code>year</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>index.all</code> </td><td style="text-align: left;"> Fourth column, representing index of LSAM value in the input <code>resid</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Examples</h3>

<pre><code class='language-R'># load sample data
data("sycamore")
x = sycamore

# get streamflow object for the sample data
x.streamflow = asStreamflow(x)

# prepare baseline signal 
x.bl = prepareBaseline(x.streamflow)

# LSAM
lsam = getLSAM(x.bl$resid.sig, x.streamflow$data$year)

</code></pre>

<hr>
<h2 id='getNAA'>Net Annual Anomaly (NAA)</h2><span id='topic+getNAA'></span>

<h3>Description</h3>

<p>Calculate Net Annual Anomaly (NAA) from the given residual values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getNAA(resid, years, for.year = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getNAA_+3A_resid">resid</code></td>
<td>
<p>A vector of residual values generated with respect to the baseline signal</p>
</td></tr>
<tr><td><code id="getNAA_+3A_years">years</code></td>
<td>
<p>A vector of years corrosponding to the residual values</p>
</td></tr>
<tr><td><code id="getNAA_+3A_for.year">for.year</code></td>
<td>
<p>(optional) Calculate NAA values only for the given year in this argument.
If argument is omitted, NAA values for all years are calculated.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame containing two columns: 
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>year</code> </td><td style="text-align: left;"> First column, represents year </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>NAA</code> </td><td style="text-align: left;"> Second column, represents NAA values
</td>
</tr>

</table>



<h3>Examples</h3>

<pre><code class='language-R'># load sample data
data("sycamore")
x = sycamore

# get streamflow object for the sample data
x.streamflow = asStreamflow(x)

# prepare baseline signal 
x.bl = prepareBaseline(x.streamflow)

# NAA
naa = getNAA(x.bl$resid.sig, x.streamflow$data$year)

</code></pre>

<hr>
<h2 id='getSignalParts'>Signal parts</h2><span id='topic+getSignalParts'></span>

<h3>Description</h3>

<p>This function computes high flow and low flow window of seasonal signal, and the peak max
and peak min values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getSignalParts(seas.sig, candmin, candmax, years, months, jdays,
  for.year = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getSignalParts_+3A_seas.sig">seas.sig</code></td>
<td>
<p>Seasonal signal as generated from DFFT methods</p>
</td></tr>
<tr><td><code id="getSignalParts_+3A_candmin">candmin</code></td>
<td>
<p>numeric vector of possible ordinal days in which the predicted signal is lowest. 
This range need not be narrow, but a string of consecutive days should not include more than one local minimum. 
Used for calculating the high- and low-flow windows.</p>
</td></tr>
<tr><td><code id="getSignalParts_+3A_candmax">candmax</code></td>
<td>
<p>numeric vector of possible ordinal days in which the predicted signal is highest. 
This range need not be narrow, but a string of consecutive days should not include more than one local maximum.</p>
</td></tr>
<tr><td><code id="getSignalParts_+3A_years">years</code></td>
<td>
<p>A vector of years corrosponding to the seasonal signal values</p>
</td></tr>
<tr><td><code id="getSignalParts_+3A_months">months</code></td>
<td>
<p>A vector of months corrosponding to the seasonal signal values</p>
</td></tr>
<tr><td><code id="getSignalParts_+3A_jdays">jdays</code></td>
<td>
<p>A vector of julian days corrosponding to the seasonal signal values</p>
</td></tr>
<tr><td><code id="getSignalParts_+3A_for.year">for.year</code></td>
<td>
<p>(optional) Calculate signal parts only for the given year in this argument.
If argument is omitted, all years are considered.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame containing following columns.
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>year</code> </td><td style="text-align: left;"> represents year </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>max.peak.index.all</code> </td><td style="text-align: left;"> represents index value within the entire vector </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>max.peak.value</code> </td><td style="text-align: left;"> represents value of max peak </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>highwind.start.index.all</code> </td><td style="text-align: left;"> start index of high flow window within the entire vector </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>highwind.end.index.all</code> </td><td style="text-align: left;"> end index of high flow window within the entire vector </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>lowwind.start.index.all</code> </td><td style="text-align: left;"> start index of low flow window within the entire vector </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>lowwind.end.index.all</code> </td><td style="text-align: left;"> end index of low flow window within the entire vector </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Examples</h3>

<pre><code class='language-R'># load sample data
data("sycamore")
x = sycamore

# get streamflow object for the sample data
x.streamflow = asStreamflow(x)

# prepare baseline signal 
x.bl = prepareBaseline(x.streamflow)

# signal parts
x.sp = getSignalParts(x.bl$pred2, candmin = c(40:125), candmax = c(190:330),
                      years = x.streamflow$data$year, 
                      months = x.streamflow$data$month,
                      jdays = x.streamflow$data$jday)

</code></pre>

<hr>
<h2 id='getTimingHSAM'>Time of occurence of High Spectral Anomaly Magnitude (HSAM)</h2><span id='topic+getTimingHSAM'></span>

<h3>Description</h3>

<p>Compute the number of days separating HSAM and reference point for each year.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getTimingHSAM(index.hsam, index.ref, years, for.year = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getTimingHSAM_+3A_index.hsam">index.hsam</code></td>
<td>
<p>A scalar/vector of index of HSAM values in given year/years</p>
</td></tr>
<tr><td><code id="getTimingHSAM_+3A_index.ref">index.ref</code></td>
<td>
<p>A scalar/vector of index of reference point in given year/years</p>
</td></tr>
<tr><td><code id="getTimingHSAM_+3A_years">years</code></td>
<td>
<p>A vector of years corresponding to HSAM and ref values.
This argument can be NULL if the HSAM and ref values are scalars.</p>
</td></tr>
<tr><td><code id="getTimingHSAM_+3A_for.year">for.year</code></td>
<td>
<p>(optional) Calculate timing (HSAM) only for the given year in this argument.
If argument is omitted, timing (HSAM) values for all years are calculated.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Scalar timing HSAM value if the inputs are scalars, or a Data frame containing two Columns:
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>year</code> </td><td style="text-align: left;"> First column, represents year </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>timing.hsam</code> </td><td style="text-align: left;"> Second column, represents hsam timing values
</td>
</tr>

</table>



<h3>Examples</h3>

<pre><code class='language-R'># load sample data
data("sycamore")
x = sycamore

# get streamflow object for the sample data
x.streamflow = asStreamflow(x)

# prepare baseline signal 
x.bl = prepareBaseline(x.streamflow)

# get signal parts
x.sp = getSignalParts(x.bl$pred2, candmin = c(40:125), candmax = c(190:330),
                      years = x.streamflow$data$year, 
                      months = x.streamflow$data$month,
                      jdays = x.streamflow$data$jday)

# get HSAM values
hsam = getHSAM(x.bl$resid.sig, x.streamflow$data$year)

# timing HSAM
thsam = getTimingHSAM(hsam$Index.all, x.sp$peak.index, x.sp$year)

</code></pre>

<hr>
<h2 id='getTimingLSAM'>Time of occurence of Low Spectral Anomaly Magnitude (LSAM)</h2><span id='topic+getTimingLSAM'></span>

<h3>Description</h3>

<p>Compute the number of days separating LSAM and reference point for each year.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getTimingLSAM(index.lsam, index.ref, years = NULL, for.year = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getTimingLSAM_+3A_index.lsam">index.lsam</code></td>
<td>
<p>A scalar/vector of index of LSAM values in given year/years</p>
</td></tr>
<tr><td><code id="getTimingLSAM_+3A_index.ref">index.ref</code></td>
<td>
<p>A scalar/vector of index of reference point in given year/years</p>
</td></tr>
<tr><td><code id="getTimingLSAM_+3A_years">years</code></td>
<td>
<p>(optional) A vector of years corresponding to LSAM and ref values.
This argument can be NULL if the LSAM and ref values are scalars.</p>
</td></tr>
<tr><td><code id="getTimingLSAM_+3A_for.year">for.year</code></td>
<td>
<p>(optional) Calculate timing (LSAM) only for the given year in this argument.
If argument is omitted, timing (LSAM) values for all years are calculated.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Scalar timing LSAM value if the inputs are scalars, or a Data frame containing two Columns:
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>year</code> </td><td style="text-align: left;"> First column, represents year </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>timing.lsam</code> </td><td style="text-align: left;"> Second column, represents lsam timing values
</td>
</tr>

</table>



<h3>Examples</h3>

<pre><code class='language-R'># load sample data
data("sycamore")
x = sycamore

# get streamflow object for the sample data
x.streamflow = asStreamflow(x)

# prepare baseline signal 
x.bl = prepareBaseline(x.streamflow)

# get signal parts
x.sp = getSignalParts(x.bl$pred2, candmin = c(40:125), candmax = c(190:330),
                      years = x.streamflow$data$year, 
                      months = x.streamflow$data$month,
                      jdays = x.streamflow$data$jday)

# get LSAM values
lsam = getLSAM(x.bl$resid.sig, x.streamflow$data$year)

# timing LSAM
tlsam = getTimingLSAM(lsam$Index.all, x.sp$peak.index, x.sp$year)

</code></pre>

<hr>
<h2 id='getTransitionTime'>Transition Time</h2><span id='topic+getTransitionTime'></span>

<h3>Description</h3>

<p>Compute the number of days separating HSAM and LSAM for the given year/years.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getTransitionTime(index.hsam, index.lsam, years, for.year = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getTransitionTime_+3A_index.hsam">index.hsam</code></td>
<td>
<p>A scalar/vector of index of HSAM values in given year/years</p>
</td></tr>
<tr><td><code id="getTransitionTime_+3A_index.lsam">index.lsam</code></td>
<td>
<p>A scalar/vector of index of LSAM values in given year/years</p>
</td></tr>
<tr><td><code id="getTransitionTime_+3A_years">years</code></td>
<td>
<p>A vector of years corresponding to HSAM and LSAM values.
This argument can be NULL if the HSAM and LSAM values are scalars.</p>
</td></tr>
<tr><td><code id="getTransitionTime_+3A_for.year">for.year</code></td>
<td>
<p>(optional) Calculate transition time only for the given year in this argument.
If argument is omitted, transition times for all years are calculated.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Scalar transition time if the inputs are scalars, or a Data frame containing two Columns:
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>year</code> </td><td style="text-align: left;"> First column, represents year </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>transition.time</code> </td><td style="text-align: left;"> Second column, represents transition times
</td>
</tr>

</table>



<h3>Examples</h3>

<pre><code class='language-R'># load sample data
data("sycamore")
x = sycamore

# get streamflow object for the sample data
x.streamflow = asStreamflow(x)

# prepare baseline signal 
x.bl = prepareBaseline(x.streamflow)

# get HSAM and LSAM values
hsam = getHSAM(x.bl$resid.sig, x.streamflow$data$year)
lsam = getLSAM(x.bl$resid.sig, x.streamflow$data$year)

# transition time
tt = getTransitionTime(hsam$Index.all, lsam$Index.all, hsam$year)

</code></pre>

<hr>
<h2 id='independentEvents'> Independent high- or low-flow events </h2><span id='topic+independentEvents'></span>

<h3>Description</h3>

<p>Finds independent events greater than or less than a specified criterion.  High (or low) -flow days occurring on consecutive days are considered part of one event.  This function can be used to find events exceeding 2- or 10- year return levels (as calculated in <code><a href="#topic+lp3Events">lp3Events</a></code> function, for example), or to find residual flows of a certain magnitude.    
</p>


<h3>Usage</h3>

<pre><code class='language-R'>independentEvents(cutoff.val, data, data.column, below.cutoff=FALSE)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="independentEvents_+3A_cutoff.val">cutoff.val</code></td>
<td>
<p> Numeric specifying event criterion.  </p>
</td></tr>
<tr><td><code id="independentEvents_+3A_data">data</code></td>
<td>
<p> Data matrix or data frame with one column of streamflow data. </p>
</td></tr>
<tr><td><code id="independentEvents_+3A_data.column">data.column</code></td>
<td>
<p> Numeric; specifies column in which to look for events.</p>
</td></tr>
<tr><td><code id="independentEvents_+3A_below.cutoff">below.cutoff</code></td>
<td>
<p> Logical. TRUE to find events less than the <code>cutoff.val</code> and FALSE to find events greater than the <code>cutoff.val</code>. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>data.frame</code> with columns
</p>
<table>
<tr><td><code>events.starts</code></td>
<td>
<p> Index of event start. </p>
</td></tr>
<tr><td><code>events.ends</code></td>
<td>
<p> Index of event end. </p>
</td></tr>
<tr><td><code>events.duration</code></td>
<td>
<p> Length (days) of event. </p>
</td></tr>
<tr><td><code>extreme.this.events</code></td>
<td>
<p> Maximum or minimum flow for this event. </p>
</td></tr>
<tr><td><code>ind.extreme</code></td>
<td>
<p> Index of maximum or minimum flow for this event.  
If extreme is not unique, the chronologically first index is given. </p>
</td></tr>
<tr><td><code>...</code></td>
<td>
<p> All columns of original data, corresponding to max or min flow. These columns will have the same column names as the original data.</p>
</td></tr>
<tr><td><code>duplicates</code></td>
<td>
<p> 0 if the extreme is unique, 1 if it is not unique. </p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+lp3Events">lp3Events</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sycamore)
syc.sf&lt;-asStreamflow(sycamore)
#find 10-year flood
q10&lt;-lp3Events(syc.sf)$Q10

#find all events greater than 10-year flood
independentEvents(q10,syc.sf$data, data.col=8 , below.cutoff=FALSE)
</code></pre>

<hr>
<h2 id='lp3Events'> Find 2- and 10-year return levels </h2><span id='topic+lp3Events'></span>

<h3>Description</h3>

<p>Uses the method of moments to find the 2- and 10-year droughts and floods under the Log-III Pearson distribution. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lp3Events(x)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lp3Events_+3A_x">x</code></td>
<td>
<p> Object of class &quot;<code>streamflow</code>&quot;. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Return levels are calculated using the method of moments through the package <a href="https://cran.r-project.org/package=lmom">&quot;lmom&quot;</a>.  High return levels (floods) are calculated using annual maxima of the raw (log normalized) data, while the low return levels (droughts) are calculated using annual mimima of the 7-day moving averages. 
</p>


<h3>Value</h3>

<p>A <code>list</code> with items
</p>
<table>
<tr><td><code>Q2</code></td>
<td>
<p> 2-year high return level. </p>
</td></tr>
<tr><td><code>Q10</code></td>
<td>
<p> 10-year high return level. </p>
</td></tr>
<tr><td><code>L2</code></td>
<td>
<p> 2-year low return level. </p>
</td></tr>
<tr><td><code>L10</code></td>
<td>
<p> 10-year low return level. </p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>data(sycamore)
syc.sf&lt;-asStreamflow(sycamore)
lp3Events(syc.sf)

</code></pre>

<hr>
<h2 id='parameters.list'> Calculate all characteristic stats from a list of files </h2><span id='topic+parameters.list'></span>

<h3>Description</h3>

<p>Function takes a vector of file names and returns seasonal signal-to-noise ratio, daily and annual noise color, 2- and 10-year return levels, and <code class="reqn">\sigma</code> for high- and low-flow events.  
</p>
<p>All files in the vector should be of the same format.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>parameters.list(x, names=NULL, file.type="txt", date.col=3, dis.col=4, skipped.rows=28) 

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="parameters.list_+3A_x">x</code></td>
<td>
<p> Character vector containing file names.</p>
</td></tr>
<tr><td><code id="parameters.list_+3A_names">names</code></td>
<td>
<p> Optional character vector with names of sites.</p>
</td></tr>
<tr><td><code id="parameters.list_+3A_file.type">file.type</code></td>
<td>
<p>Character string, &quot;txt&quot; or &quot;csv&quot;.  Defaults to &quot;txt&quot;.</p>
</td></tr>
<tr><td><code id="parameters.list_+3A_date.col">date.col</code></td>
<td>
<p> Numeric specifying column containing date in &quot;MM-DD-YYYY&quot; format.  Defaults to 3.</p>
</td></tr>
<tr><td><code id="parameters.list_+3A_dis.col">dis.col</code></td>
<td>
<p> Numeric specifying column containing discharge data. Defaults to 4. </p>
</td></tr>
<tr><td><code id="parameters.list_+3A_skipped.rows">skipped.rows</code></td>
<td>
<p>Numeric indicating number of rows to skip at beginning of file.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with one row for each file and the following columns:
</p>
<table>
<tr><td><code>a.rms</code></td>
<td>
<p> Root mean squared amplitude. </p>
</td></tr>
<tr><td><code>n.rms</code></td>
<td>
<p> Root mean squared noise. </p>
</td></tr>
<tr><td><code>snr</code></td>
<td>
<p> Signal-to-noise ratio. </p>
</td></tr>
<tr><td><code>theta.d</code></td>
<td>
<p> Daily noise color. </p>
</td></tr>
<tr><td><code>theta.a</code></td>
<td>
<p> Annual noise color. </p>
</td></tr>
<tr><td><code>sigma.lf</code></td>
<td>
<p> Sigma for low flow events. </p>
</td></tr>
<tr><td><code>sigma.hf</code></td>
<td>
<p> Sigma for high flow events. </p>
</td></tr>
<tr><td><code>q2</code></td>
<td>
<p> 2-year return level (flood).</p>
</td></tr>
<tr><td><code>q10</code></td>
<td>
<p> 10-year return level (flood).</p>
</td></tr>
<tr><td><code>l2</code></td>
<td>
<p> 2-year return level (drought).</p>
</td></tr>
<tr><td><code>l10</code></td>
<td>
<p> 10-year return level (drought).</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The arguments &quot;date.col&quot;, &quot;discharge.col&quot;, and &quot;skipped.rows&quot; are designed to give some flexibility in file input; however, tab-delimited text without extra columns will work best. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+allstats">allstats</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># this function works on list of files
# read R data into temporary file handle
data(sycamore)
f = tempfile(fileext="txt")
write.table(sycamore, file=f, sep="\t")

# print all statistics for the list of rivers
parameters.list(c(f), names=c("sycamore"), date.col=2,dis.col=3,skipped.rows = 1)

</code></pre>

<hr>
<h2 id='prepareBaseline'>Build baseline signal</h2><span id='topic+prepareBaseline'></span>

<h3>Description</h3>

<p>Runs fourier analysis on the input signal, to build baseline signal.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prepareBaseline(x, year.start = NULL, year.end = NULL,
  window.20 = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prepareBaseline_+3A_x">x</code></td>
<td>
<p>streamflow object, as output from the <code>asStreamflow()</code> function</p>
</td></tr>
<tr><td><code id="prepareBaseline_+3A_year.start">year.start</code></td>
<td>
<p>Start of the year for estimating baseline, or <code>NULL</code> to interpret this from input data</p>
</td></tr>
<tr><td><code id="prepareBaseline_+3A_year.end">year.end</code></td>
<td>
<p>End of the year for estimating baseline, or <code>NULL</code> to interpret this from input data</p>
</td></tr>
<tr><td><code id="prepareBaseline_+3A_window.20">window.20</code></td>
<td>
<p>If <code>TRUE</code>, baseline is constructed using windowing (20 year windows) and bootstrapping. 
If <code>FALSE</code>, baseline is constructed for a single run between start and end year.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>ssignal</code> object containing the baseline signal
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load sample data
data("sycamore")
x = sycamore

# get streamflow object for the sample data
x.streamflow = asStreamflow(x)

# baseline for single run for all the years in input signal
bl.singlerun.all = prepareBaseline(x.streamflow)

# baseline for singlerun between the given start and end years
bl.singlerun.filtered = prepareBaseline(x.streamflow, year.start = 1961, 
                                         year.end = 2000)

# baseline with windowinng and bootstrapping on all years in the input signal
bl.windowed.all = prepareBaseline(x.streamflow, window.20 = TRUE)

# baseline with windowing and bootstrapping on given start year 
#  with end year inferred from singal
bl.windowed.filtered = prepareBaseline(x.streamflow, year.start = 1961, 
                                       window.20 = TRUE)

</code></pre>

<hr>
<h2 id='residplot.extreme'> Plot annual extreme residuals </h2><span id='topic+residplot.extreme'></span>

<h3>Description</h3>

<p>Creates a plot with the maximum annual low- and high residuals for each year in the series.</p>


<h3>Usage</h3>

<pre><code class='language-R'>residplot.extreme(x, text=FALSE, data=FALSE)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="residplot.extreme_+3A_x">x</code></td>
<td>
<p> Object of class <code>streamflow</code>.</p>
</td></tr>
<tr><td><code id="residplot.extreme_+3A_text">text</code></td>
<td>
<p> Logical.  If true, points corresponding to flows greater than <code class="reqn">2\sigma</code> are labeled on the plot.</p>
</td></tr>
<tr><td><code id="residplot.extreme_+3A_data">data</code></td>
<td>
<p>Logical. If true, the extreme residuals are returned in the output.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Plot with year on the x-axis and the maximum residual magnitude for that year on the y-axis.
</p>
<p>If <code>data=TRUE</code>, output includes a <code>list</code> with the following components:
</p>
<table>
<tr><td><code>annual.max</code></td>
<td>
<p> Matrix with data corresponding to the maximum residual flow for each year in series.</p>
</td></tr>
<tr><td><code>annual.min</code></td>
<td>
<p> Matrix with data corresponding to the minimum residual flow for each year in series.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+sigmaHighFlows">sigmaHighFlows</a></code>
<code><a href="#topic+sigmaLowFlows">sigmaLowFlows</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# load data
data(sycamore)

# plot
residplot.extreme(asStreamflow(sycamore))

</code></pre>

<hr>
<h2 id='sigmaeventsplot'> Plot events by day of the year </h2><span id='topic+sigmaeventsplot'></span>

<h3>Description</h3>

<p>Creates a .  This is similar to the plots produced in the &quot;compare.periods&quot; function, but only displays the data for a single time period.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sigmaeventsplot(x)


</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sigmaeventsplot_+3A_x">x</code></td>
<td>
<p> Object of class &quot;streamflow&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A &quot;ggplot2&quot; plot depicting frequency of events greater than sigma, organized circularly by ordinal day of the year.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sigmaHighFlows">sigmaHighFlows</a></code>
<code><a href="#topic+sigmaLowFlows">sigmaLowFlows</a></code>
<code><a href="#topic+compare.periods">compare.periods</a></code>
</p>

<hr>
<h2 id='sigmaHighFlows'> Estimate catastrophic flow variability </h2><span id='topic+sigmaHighFlows'></span>

<h3>Description</h3>

<p>Calculates catastrophic variability for high flow events.  Positive residuals from the seasonal signal are used to calculate <code class="reqn">\sigma.hf</code> , the standard deviation of high-flow events.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sigmaHighFlows(x, resid.column)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sigmaHighFlows_+3A_x">x</code></td>
<td>
<p> An object of class <code>data.frame</code> or <code>streamflow</code>.  If a <code>data.frame</code> is used, one column should contain residuals. </p>
</td></tr>
<tr><td><code id="sigmaHighFlows_+3A_resid.column">resid.column</code></td>
<td>
<p> Optional numeric specifiying which column contains residuals.  Required if <code>x</code> is a data frame.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>list</code> with items
</p>
<table>
<tr><td><code>n.floods</code></td>
<td>
<p> Number of independent events with positive residuals. </p>
</td></tr>
<tr><td><code>sigma.hfa</code></td>
<td>
<p> Estimated sigma using the y-intercept. </p>
</td></tr>
<tr><td><code>sigma.hfb</code></td>
<td>
<p> Estimated sigma using the slope (<code class="reqn">\sigma.hf</code>). </p>
</td></tr>
<tr><td><code>flood.line</code></td>
<td>
<p> Matrix containing fitted, observed, and residual values from regression of log counts on bin midpoints.  </p>
</td></tr>
<tr><td><code>onesigma.events</code></td>
<td>
<p> matrix containing information for all events below <code class="reqn">\sigma.hf</code> (as calculated using the slope).  Columns will contain the same data as the output from the <code><a href="#topic+independentEvents">independentEvents</a></code> function.  </p>
</td></tr>
<tr><td><code>twosigma.events</code></td>
<td>
<p> matrix containing information for all events below <code class="reqn">2\sigma.hf</code>.  Columns will contain the same data as the output from the <code><a href="#topic+independentEvents">independentEvents</a></code> function.  </p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+independentEvents">independentEvents</a></code>
<code><a href="#topic+sigmaLowFlows">sigmaLowFlows</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load data
data(sycamore)

# get streamflow object
sf = asStreamflow(sycamore)

# estimate catastrophic high flow variability
sigmaHighFlows(sf)
</code></pre>

<hr>
<h2 id='sigmaLowFlows'> Estimate catastrophic flow variability </h2><span id='topic+sigmaLowFlows'></span>

<h3>Description</h3>

<p>Calculates catastrophic variability for low flow events.  Negative residuals from the seasonal signal are used to calculate <code class="reqn">\sigma.lf</code> , the standard deviation of low-flow events.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sigmaLowFlows(x, resid.column)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sigmaLowFlows_+3A_x">x</code></td>
<td>
<p> An object of class <code>data.frame</code> or <code>streamflow</code>.  If a <code>data.frame</code> is used, one column should contain residuals. </p>
</td></tr>
<tr><td><code id="sigmaLowFlows_+3A_resid.column">resid.column</code></td>
<td>
<p> Optional numeric specifiying which column contains residuals.  Required if <code>x</code> is a data frame.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>list</code> with items
</p>
<table>
<tr><td><code>n.droughts</code></td>
<td>
<p> Number of independent events with negative residuals. </p>
</td></tr>
<tr><td><code>sigma.lfa</code></td>
<td>
<p> Estimated sigma using the y-intercept. </p>
</td></tr>
<tr><td><code>sigma.lfb</code></td>
<td>
<p> Estimated sigma using the slope (<code class="reqn">\sigma.lf</code>). </p>
</td></tr>
<tr><td><code>drought.line</code></td>
<td>
<p> Matrix containing fitted, observed, and residual values from regression of log counts on bin midpoints.  </p>
</td></tr>
<tr><td><code>onesigma.events</code></td>
<td>
<p> matrix containing information for all events below <code class="reqn">\sigma.lf</code> (as calculated using the slope).  Columns will contain the same data as the output from the <code><a href="#topic+independentEvents">independentEvents</a></code> function.  </p>
</td></tr>
<tr><td><code>twosigma.events</code></td>
<td>
<p> matrix containing information for all events below <code class="reqn">2\sigma.lf</code>.  Columns will contain the same data as the output from the <code><a href="#topic+independentEvents">independentEvents</a></code> function.  </p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+independentEvents">independentEvents</a></code>
<code><a href="#topic+sigmaHighFlows">sigmaHighFlows</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load data
data(sycamore)

# get streamflow object
sf = asStreamflow(sycamore)

# estimate catastrophic low flow variability
sigmaLowFlows(sf)
</code></pre>

<hr>
<h2 id='sycamore'> Sycamore Creek Data </h2><span id='topic+sycamore'></span>

<h3>Description</h3>

<p>A data series from USGS station 09510200, Sycamore Creek (Fort McDowell, AZ).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  data(sycamore)
</code></pre>


<h3>Format</h3>

<p>The data are supplied as a matrix with years in the first column and average daily discharge in the second column.
The series contains 18263 observations starting Jan 1, 1961 and ending Jan 1, 2011.
</p>


<h3>Source</h3>


<ul>
<li><p>USGS National Water Information Sysem: http://waterdata.usgs.gov/usa/nwis/uv?09510200
</p>
</li></ul>


</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
