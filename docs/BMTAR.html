<!DOCTYPE html><html><head><title>Help for package BMTAR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {BMTAR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#auto_mtar'><p>Estimation of a MTAR model for some data</p></a></li>
<li><a href='#autoplot'><p>Create a complete ggplot appropriate to a particular data type</p></a></li>
<li><a href='#autoplot.regime_missing'><p>regime_missing object ggplot for the outputs on the function outputs mtarmissing</p></a></li>
<li><a href='#autoplot.regime_model'><p>regime_model object ggplot for the outputs on the function outputs mtarns and mtastr</p></a></li>
<li><a href='#autoplot.tsregime'><p>tsregime object ggplot for the outputs on the function tsregime</p></a></li>
<li><a href='#datasim'><p>Simulated Multivariate threshold autoregressive process simulation</p></a></li>
<li><a href='#datasim_miss'><p>Multivariate threshold autoregressive process simulation with missing data</p></a></li>
<li><a href='#datasim_numreg'><p>Multivariate threshold autoregressive process simulation for estimate number of regimes</p></a></li>
<li><a href='#diagnostic_mtar'><p>Residual diagnosis for model MTAR</p></a></li>
<li><a href='#dmnormB'><p>Multivariate normal density using Brobdingnag class</p></a></li>
<li><a href='#dwishartB'><p>Wishart density using Brobdingnag class</p></a></li>
<li><a href='#hydrodata'><p>Hydrological data of Colombia</p></a></li>
<li><a href='#lists_ind'><p>Create indicator vector for the regimen of each observation</p></a></li>
<li><a href='#missingest'><p>simulated data</p></a></li>
<li><a href='#mtaregime'><p>Object class &ldquo;<code>regime</code>&rdquo; creation</p></a></li>
<li><a href='#mtarinipars'><p>Organization and check model specification</p></a></li>
<li><a href='#mtarmissing'><p>Estimation of missing values of observed, covariate and threshold processes</p></a></li>
<li><a href='#mtarNAIC'><p>Compute NAIC of a MTAR model</p></a></li>
<li><a href='#mtarns'><p>Estimation of non-structural parameters for MTAR model</p></a></li>
<li><a href='#mtarnumreg'><p>Estimation of the number of regimes in a MTAR model</p></a></li>
<li><a href='#mtarsim'><p>Multivariate threshold autoregressive process simulation</p></a></li>
<li><a href='#mtarstr'><p>Estimation of structural parameters of MTAR model</p></a></li>
<li><a href='#print'><p>print an object appropriate to a particular data type</p></a></li>
<li><a href='#print.regime_missing'><p>Print estimates of a regime_missing object of the function output mtarmissing</p></a></li>
<li><a href='#print.regime_model'><p>print regime_model object for the function outputs mtarns and mtastr</p></a></li>
<li><a href='#print.regime_number'><p>print regime_number object for the function outputs mtarnumreg</p></a></li>
<li><a href='#print.tsregime'><p>Print tsregime object</p></a></li>
<li><a href='#prodB'><p>Function to make product of elements of a list</p></a></li>
<li><a href='#repM'><p>Function to create list of matrix objects</p></a></li>
<li><a href='#tsregime'><p>Creation of class &ldquo;<code>tsregime</code>&rdquo; for some data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-01-18</td>
</tr>
<tr>
<td>Title:</td>
<td>Bayesian Approach for MTAR Models with Missing Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.1</td>
</tr>
<tr>
<td>Author:</td>
<td>Valeria Bejarano Salcedo &lt;vbejaranos@unal.edu.co&gt;,
        Sergio Alejandro Calderon Villanueva &lt;sacalderonv@unal.edu.co&gt;
        Andrey Duvan Rincon Torres &lt;adrincont@unal.edu.co&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Andrey Duvan Rincon Torres &lt;adrincont@unal.edu.co&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6.0)</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements parameter estimation using a Bayesian approach for Multivariate Threshold Autoregressive (MTAR) models with missing data using Markov Chain Monte Carlo methods. Performs the simulation of MTAR processes (mtarsim()), estimation of matrix parameters and the threshold values (mtarns()),  identification of the autoregressive orders using Bayesian variable selection (mtarstr()), identification of the number of regimes using Metropolised Carlin and Chib (mtarnumreg()) and estimate missing data, coefficients and covariance matrices conditional on the autoregressive orders, the threshold values and the number of regimes (mtarmissing()). Calderon and Nieto (2017) &lt;<a href="https://doi.org/10.1080%2F03610926.2014.990758">doi:10.1080/03610926.2014.990758</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Imports:</td>
<td>Brobdingnag,MASS,MCMCpack,expm,ks,mvtnorm,compiler,doParallel,parallel,ggplot2</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-01-18 23:35:40 UTC; Val</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-01-19 05:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='auto_mtar'>Estimation of a MTAR model for some data</h2><span id='topic+auto_mtar'></span>

<h3>Description</h3>

<p>Compute by Bayesian methodology a MTAR model for some data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>auto_mtar(Yt, Zt = NULL, Xt = NULL, l0_min = 2, l0_max = 3,
maxorders = list(pj = 2,qj = 0,dj = 0),
niter = 3000, chain = FALSE, method = 'KUO',parallel = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="auto_mtar_+3A_yt">Yt</code></td>
<td>
<p>matrix type object, observed process. Not NULL</p>
</td></tr>
<tr><td><code id="auto_mtar_+3A_zt">Zt</code></td>
<td>
<p>matrix type object, threshold process. Default NULL</p>
</td></tr>
<tr><td><code id="auto_mtar_+3A_xt">Xt</code></td>
<td>
<p>matrix type object, covariate process. Default NULL</p>
</td></tr>
<tr><td><code id="auto_mtar_+3A_l0_min">l0_min</code></td>
<td>
<p>numeric type between 1 and 4, number of regimes minimum to consider. Default 2</p>
</td></tr>
<tr><td><code id="auto_mtar_+3A_l0_max">l0_max</code></td>
<td>
<p>numeric type between 1 and 4, number of regimes maximum to consider. Default 3</p>
</td></tr>
<tr><td><code id="auto_mtar_+3A_maxorders">maxorders</code></td>
<td>
<p>list type object with names (pj,qj,dj), maximum lags consider for the processes in each regime. Default pj = 2, qj = 0,dj = 0</p>
</td></tr>
<tr><td><code id="auto_mtar_+3A_niter">niter</code></td>
<td>
<p>numeric type, number of runs for every estimation. Default 3000</p>
</td></tr>
<tr><td><code id="auto_mtar_+3A_chain">chain</code></td>
<td>
<p>logical type, if return chains of estimations parameters and values (if missing)</p>
</td></tr>
<tr><td><code id="auto_mtar_+3A_method">method</code></td>
<td>
<p>character type, must be one &ldquo;KUO&rdquo; or &ldquo;SSVS&rdquo;</p>
</td></tr>
<tr><td><code id="auto_mtar_+3A_parallel">parallel</code></td>
<td>
<p>logical, if <code>parallel</code> package should be used. Default FALSE</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The default arguments are designed for rapid estimation of models for any data (Yt, Zt and Xt). Returns the fit of MTAR model.
The function conducts Bayesian estimation with &ldquo;niter&rdquo; chains of the number of regimes with maximum &ldquo;l0&rdquo; and within the maximum lags orders provided &ldquo;maxorders&rdquo;.
It can be a little be faster when used &ldquo;parallel&rdquo; for <code>parallel</code> package.
</p>


<h3>Value</h3>

<p>Return list type object
</p>
<table>
<tr><td><code>tsregime</code></td>
<td>
<p>class &ldquo;<code>tsregime</code>&rdquo; object, if missing values completed with estimations</p>
</td></tr>
<tr><td><code>numreg</code></td>
<td>
<p>class &ldquo;<code>regime_number</code>&rdquo;, number of regimes estimated</p>
</td></tr>
<tr><td><code>pars</code></td>
<td>
<p>class &ldquo;<code>regime_model</code>&rdquo; object with final estimations of parameters</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Valeria Bejarano <a href="mailto:vbejaranos@unal.edu.co">vbejaranos@unal.edu.co</a>, Sergio Calderon <a href="mailto:sacalderonv@unal.edu.co">sacalderonv@unal.edu.co</a> &amp; Andrey Rincon <a href="mailto:adrincont@unal.edu.co">adrincont@unal.edu.co</a></p>


<h3>References</h3>

<p>Calderon, S. and Nieto, F. (2017) <em>Bayesian analysis of multivariate threshold autoregress models with missing data.</em> Communications in Statistics - Theory and Methods 46 (1):296–318. doi:10.1080/03610926.2014.990758.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data('datasim')
  data = datasim$Sim
  auto = auto_mtar(Yt = data$Yt, Zt = data$Zt,niter = 1000)
</code></pre>

<hr>
<h2 id='autoplot'>Create a complete ggplot appropriate to a particular data type</h2><span id='topic+autoplot'></span>

<h3>Description</h3>

<p><code>autoplot</code> uses ggplot2 to draw a particular plot for an object of a
particular class in a single command. This defines the S3 generic that
other classes and packages can extend.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>autoplot(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="autoplot_+3A_object">object</code></td>
<td>
<p>an object, whose class will determine the behaviour of autoplot</p>
</td></tr>
<tr><td><code id="autoplot_+3A_...">...</code></td>
<td>
<p>other arguments passed to specific methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a ggplot object
</p>


<h3>See Also</h3>

<p><code><a href="ggplot2.html#topic+autolayer">autolayer()</a></code>, <code><a href="ggplot2.html#topic+ggplot">ggplot()</a></code> and <code><a href="ggplot2.html#topic+fortify">fortify()</a></code>
</p>

<hr>
<h2 id='autoplot.regime_missing'>regime_missing object ggplot for the outputs on the function outputs mtarmissing</h2><span id='topic+autoplot.regime_missing'></span>

<h3>Description</h3>

<p>Produces a ggplot object for the results of the mtarmissing function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'regime_missing'
autoplot(object, type = 1,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="autoplot.regime_missing_+3A_object">object</code></td>
<td>
<p>Object of class &ldquo;<code>regim_missing</code>&rdquo;. Not NULL</p>
</td></tr>
<tr><td><code id="autoplot.regime_missing_+3A_type">type</code></td>
<td>
<p>character string giving the type of plot to be computed. Allowed
values are 1 for &quot;<code>Missing data (Yt) chains</code>&quot; (the default) or 2 for &ldquo;<code>Missing data (Ut = [Zt,Xt]) chains</code>&rdquo;.
</p>
</td></tr>
<tr><td><code id="autoplot.regime_missing_+3A_...">...</code></td>
<td>
<p>other arguments passed to specific methods</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Graph the strings for the outputs corresponding to the functions &ldquo;<code>mtarmissing</code>&rdquo; which return an object of class &ldquo;<code>regim_missing</code>&rdquo;. The chains corresponding to the samplings in each case do not contain the burning period.
</p>


<h3>Value</h3>

<p>Return a ggplot object.
</p>


<h3>Author(s)</h3>

<p>Valeria Bejarano <a href="mailto:vbejaranos@unal.edu.co">vbejaranos@unal.edu.co</a> &amp; Andrey Rincon <a href="mailto:adrincont@unal.edu.co">adrincont@unal.edu.co</a></p>


<h3>References</h3>

<p>Calderon, S. and Nieto, F. (2017) <em>Bayesian analysis of multivariate threshold autoregress models with missing data.</em> Communications in Statistics - Theory and Methods 46 (1):296–318. doi:10.1080/03610926.2014.990758.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mtarmissing">mtarmissing</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ggplot2)
data('missingest')
autoplot.regime_missing(missingest,1)
</code></pre>

<hr>
<h2 id='autoplot.regime_model'>regime_model object ggplot for the outputs on the function outputs mtarns and mtastr</h2><span id='topic+autoplot.regime_model'></span>

<h3>Description</h3>

<p>Produces a ggplot object for the results of the mtarns and mtarstr functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'regime_model'
autoplot(object, type = 1,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="autoplot.regime_model_+3A_object">object</code></td>
<td>
<p>Object of class &ldquo;<code>regime_model</code>&rdquo;. Not NULL</p>
</td></tr>
<tr><td><code id="autoplot.regime_model_+3A_type">type</code></td>
<td>
<p>character string giving the type of plot to be computed. Allowed
values are 1 for &quot;<code>Thresholds chains</code>&quot; (the default), 2 for &ldquo;<code>Sigma chains</code>&rdquo;, 3 for &ldquo;<code>Theta chains</code>&rdquo;, 4 for &ldquo;<code>Gamma chains</code>&rdquo; or 5 for &ldquo;<code>Output process fit</code>&rdquo;
</p>
</td></tr>
<tr><td><code id="autoplot.regime_model_+3A_...">...</code></td>
<td>
<p>other arguments passed to specific methods</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Graph the strings for the outputs corresponding to the functions &ldquo;<code>mtarns</code>&rdquo; and &ldquo;<code>mtarstr</code>&rdquo; which return an object of class &ldquo;<code>regime_model</code>&rdquo;. The chains corresponding to the samplings in each case do not contain the burning period.
</p>


<h3>Value</h3>

<p>Return a ggplot object.
</p>


<h3>Author(s)</h3>

<p>Valeria Bejarano <a href="mailto:vbejaranos@unal.edu.co">vbejaranos@unal.edu.co</a> &amp; Andrey Rincon <a href="mailto:adrincont@unal.edu.co">adrincont@unal.edu.co</a></p>


<h3>References</h3>

<p>Calderon, S. and Nieto, F. (2017) <em>Bayesian analysis of multivariate threshold autoregress models with missing data.</em> Communications in Statistics - Theory and Methods 46 (1):296–318. doi:10.1080/03610926.2014.990758.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mtarns">mtarns</a></code>, <code><a href="#topic+mtarstr">mtarstr</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ggplot2)
data("datasim")
data = datasim$Sim$Zt
parameters = list(l = 1,orders = list(pj = 1))
initial = mtarinipars(tsregime_obj = tsregime(data),
                      list_model = list(pars = parameters))
estim1 = mtarns(ini_obj = initial,niter = 500,chain = TRUE)

autoplot.regime_model(estim1,2)
autoplot.regime_model(estim1,3)

autoplot.regime_model(estim1,5)
</code></pre>

<hr>
<h2 id='autoplot.tsregime'>tsregime object ggplot for the outputs on the function tsregime</h2><span id='topic+autoplot.tsregime'></span>

<h3>Description</h3>

<p>Produces a ggplot object for the results of the tsregime function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'tsregime'
autoplot(object, type = 1,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="autoplot.tsregime_+3A_object">object</code></td>
<td>
<p>Object of class &ldquo;<code>tsregime</code>&rdquo;.</p>
</td></tr>
<tr><td><code id="autoplot.tsregime_+3A_type">type</code></td>
<td>
<p>character string giving the type of plot to be computed. Allowed
values are 1 for &quot;<code>Output process</code>&quot; (the default), 2 for &ldquo;<code>Threshold process</code>&rdquo;, 3 for &ldquo;<code>Covariate process</code>&rdquo;
</p>
</td></tr>
<tr><td><code id="autoplot.tsregime_+3A_...">...</code></td>
<td>
<p>other arguments passed to specific methods</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Graph for the stochastic processes of the object \ dQuote \ code tsregime for: Output process and if they exist for: Threshold process and Covariates process. In the case that there are missing data, a red line is drawn at the indicated time.
</p>


<h3>Value</h3>

<p>Return a ggplot object.
</p>


<h3>Author(s)</h3>

<p>Valeria Bejarano <a href="mailto:vbejaranos@unal.edu.co">vbejaranos@unal.edu.co</a> &amp; Andrey Rincon <a href="mailto:adrincont@unal.edu.co">adrincont@unal.edu.co</a></p>


<h3>References</h3>

<p>Calderon, S. and Nieto, F. (2017) <em>Bayesian analysis of multivariate threshold autoregress models with missing data.</em> Communications in Statistics - Theory and Methods 46 (1):296–318. doi:10.1080/03610926.2014.990758.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+tsregime">tsregime</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data("datasim")
yt = datasim$Sim
Yt = yt$Yt
Zt = yt$Zt
data = tsregime(Yt,Zt)
autoplot.tsregime(data)
</code></pre>

<hr>
<h2 id='datasim'>Simulated Multivariate threshold autoregressive process simulation</h2><span id='topic+datasim'></span>

<h3>Description</h3>

<p>simulated MTAR process
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(datasim)</code></pre>


<h3>Format</h3>

<p>Object with class <code>mtarsim</code></p>


<h3>Source</h3>

<p>R Simulate</p>


<h3>References</h3>

<p>Calderon, S. and Nieto, F. (2017) <em>Bayesian analysis of multivariate threshold autoregress models with missing data.</em> Communications in Statistics - Theory and Methods 46 (1):296–318. doi:10.1080/03610926.2014.990758.
</p>

<hr>
<h2 id='datasim_miss'>Multivariate threshold autoregressive process simulation with missing data</h2><span id='topic+datasim_miss'></span>

<h3>Description</h3>

<p>simulated MTAR process with missing data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(datasim)</code></pre>


<h3>Format</h3>

<p>Object with class <code>mtarsim</code></p>


<h3>Source</h3>

<p>R Simulate</p>


<h3>References</h3>

<p>Calderon, S. and Nieto, F. (2017) <em>Bayesian analysis of multivariate threshold autoregress models with missing data.</em> Communications in Statistics - Theory and Methods 46 (1):296–318. doi:10.1080/03610926.2014.990758.
</p>

<hr>
<h2 id='datasim_numreg'>Multivariate threshold autoregressive process simulation for estimate number of regimes</h2><span id='topic+datasim_numreg'></span>

<h3>Description</h3>

<p>object of class &ldquo;<code>regime_number</code>&rdquo;
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(datasim_numreg)</code></pre>


<h3>Format</h3>

<p>Object with class <code>regime_number</code></p>


<h3>Source</h3>

<p>R Simulate</p>


<h3>References</h3>

<p>Calderon, S. and Nieto, F. (2017) <em>Bayesian analysis of multivariate threshold autoregress models with missing data.</em> Communications in Statistics - Theory and Methods 46 (1):296–318. doi:10.1080/03610926.2014.990758.
</p>

<hr>
<h2 id='diagnostic_mtar'>Residual diagnosis for model MTAR</h2><span id='topic+diagnostic_mtar'></span>

<h3>Description</h3>

<p>Tests to help evaluate some assumptions about the MTAR model. calculating some tests and graphs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>diagnostic_mtar(regime_model,lagmax = NULL,alpha = '0.05')
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="diagnostic_mtar_+3A_regime_model">regime_model</code></td>
<td>
<p>Object of class &ldquo;<code>regime_model</code>&rdquo;. Not NULL</p>
</td></tr>
<tr><td><code id="diagnostic_mtar_+3A_lagmax">lagmax</code></td>
<td>
<p>maximum lag at which to calculate the acf and pacf. Default NULL</p>
</td></tr>
<tr><td><code id="diagnostic_mtar_+3A_alpha">alpha</code></td>
<td>
<p>level of significance for the graphs, should take values in
c('0.10','0.05','0.025','0.01','0.005'). Default '0.05'</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the graphical tests it returns: &ldquo;<code>Residuals plot</code>&rdquo; and &ldquo;<code>Residuals density plot</code>&rdquo; (overlaps a standard normal density),&ldquo;<code>Residuals plot</code>&rdquo; and &ldquo;<code>Residuals plot</code>&rdquo;, &ldquo;<code>CUSUM</code>&rdquo; statistic for residuals, &ldquo;<code>ACF</code>&rdquo; and &ldquo;<code>PACF</code>&rdquo; plots for residuals series.
</p>


<h3>Value</h3>

<p>Returns a list of ggplot objects with the graphics mentioned before.
</p>


<h3>Author(s)</h3>

<p>Valeria Bejarano <a href="mailto:vbejaranos@unal.edu.co">vbejaranos@unal.edu.co</a>, Sergio Calderon <a href="mailto:sacalderonv@unal.edu.co">sacalderonv@unal.edu.co</a> &amp; Andrey Rincon <a href="mailto:adrincont@unal.edu.co">adrincont@unal.edu.co</a></p>


<h3>References</h3>

<p>Calderon, S. and Nieto, F. (2017) <em>Bayesian analysis of multivariate threshold autoregress models with missing data.</em> Communications in Statistics - Theory and Methods 46 (1):296–318. doi:10.1080/03610926.2014.990758.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ggplot2)
data("datasim")
data = datasim$Sim$Z
parameters = list(l = 1,orders = list(pj = 1))
initial = mtarinipars(tsregime_obj = tsregime(data),
                      list_model = list(pars = parameters))
estim1 = mtarns(ini_obj = initial,niter = 500,chain = TRUE,burn = 500)
diagnostic_mtar(estim1)
</code></pre>

<hr>
<h2 id='dmnormB'>Multivariate normal density using Brobdingnag class</h2><span id='topic+dmnormB'></span>

<h3>Description</h3>

<p>Compute multivariate normal density with class <code>Brobdingnag</code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dmnormB(x,mean,sigma)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dmnormB_+3A_x">x</code></td>
<td>
<p>numeric type object, value to compute the density of multivariate normal distribution. Not NULL</p>
</td></tr>
<tr><td><code id="dmnormB_+3A_mean">mean</code></td>
<td>
<p>numeric type, mean of multivariate normal distribution. Not NULL</p>
</td></tr>
<tr><td><code id="dmnormB_+3A_sigma">sigma</code></td>
<td>
<p>matrix type object, covariance parameter of multivariate normal distribution. Not NULL</p>
</td></tr>
</table>


<h3>Value</h3>

<p>object class <code>Brobdingnag</code>
</p>

<hr>
<h2 id='dwishartB'>Wishart density using Brobdingnag class</h2><span id='topic+dwishartB'></span>

<h3>Description</h3>

<p>Compute Wishart density with class <code>Brobdingnag</code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dwishartB(x,nu,S)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dwishartB_+3A_x">x</code></td>
<td>
<p>matrix type object, value to compute the density of Wishart distribution. Not NULL</p>
</td></tr>
<tr><td><code id="dwishartB_+3A_nu">nu</code></td>
<td>
<p>numeric type, degrees of freedom. Not NULL</p>
</td></tr>
<tr><td><code id="dwishartB_+3A_s">S</code></td>
<td>
<p>matrix type object, parameter of Wishart distribution. Not NULL</p>
</td></tr>
</table>


<h3>Value</h3>

<p>object class <code>Brobdingnag</code>
</p>

<hr>
<h2 id='hydrodata'>Hydrological data of Colombia</h2><span id='topic+hydrodata'></span>

<h3>Description</h3>

<p>Diary rainfall (in mm) and the diary river flow (in m^3/s) of
two rivers where a river empties into the other one in a region of department of Cauca in
Colombia.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(hydrodata)</code></pre>


<h3>Format</h3>

<p>data.frame</p>


<h3>Source</h3>

<p>IDEAM, the oficial Colombian agency for hydrological and meteorological studies</p>


<h3>References</h3>

<p>Calderon, S. and Nieto, F. (2017) <em>Bayesian analysis of multivariate threshold autoregress models with missing data.</em> Communications in Statistics - Theory and Methods 46 (1):296–318. doi:10.1080/03610926.2014.990758.
</p>

<hr>
<h2 id='lists_ind'>Create indicator vector for the regimen of each observation</h2><span id='topic+lists_ind'></span>

<h3>Description</h3>

<p>From a threshold variable and the corresponding processes calculate a vector indicating the number of the regime of each observation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lists_ind(r,Zt,l,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lists_ind_+3A_r">r</code></td>
<td>
<p>value for the threshold variable</p>
</td></tr>
<tr><td><code id="lists_ind_+3A_zt">Zt</code></td>
<td>
<p>threshold processes univariate</p>
</td></tr>
<tr><td><code id="lists_ind_+3A_l">l</code></td>
<td>
<p>number of regimes</p>
</td></tr>
<tr><td><code id="lists_ind_+3A_...">...</code></td>
<td>
<p>other arguments passed to specific methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of length N indicating the number of the regime of each observation
</p>

<hr>
<h2 id='missingest'>simulated data</h2><span id='topic+missingest'></span>

<h3>Description</h3>

<p>results example missing data estimation process for a mtar process
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(missingest)</code></pre>


<h3>Format</h3>

<p>Object whit class <code>mtar_missing</code></p>


<h3>Source</h3>

<p>R Simulation</p>


<h3>References</h3>

<p>Calderon, S. and Nieto, F. (2017) <em>Bayesian analysis of multivariate threshold autoregress models with missing data.</em> Communications in Statistics - Theory and Methods 46 (1):296–318. doi:
10.1080/03610926.2014.990758.
</p>

<hr>
<h2 id='mtaregime'>Object class &ldquo;<code>regime</code>&rdquo; creation</h2><span id='topic+mtaregime'></span>

<h3>Description</h3>

<p>Create an object of class &ldquo;<code>regime</code>&rdquo; given nonstructural and structural parameters for each regime.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mtaregime(orders = list(p = 1,q = 0,d = 0), cs = NULL, Phi,
Beta = NULL, Delta = NULL, Sigma)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mtaregime_+3A_orders">orders</code></td>
<td>
<p>list type object with names (p,q,d), number of lags of Yt, Xt and Zt, respectively. Default p = 1, q = 0, d = 0</p>
</td></tr>
<tr><td><code id="mtaregime_+3A_cs">cs</code></td>
<td>
<p>matrix type object, the constant term of the regime specification. Default NULL</p>
</td></tr>
<tr><td><code id="mtaregime_+3A_phi">Phi</code></td>
<td>
<p>list type object with names (phi1, ..., phip), each one a matrix <code class="reqn">(kxk)</code> type object autoregressive specification. Not NULL</p>
</td></tr>
<tr><td><code id="mtaregime_+3A_beta">Beta</code></td>
<td>
<p>list type object with names (beta1, ..., betaq), each one a matrix <code class="reqn">(kx\nu)</code> type object covariate parameters specification Default NULL</p>
</td></tr>
<tr><td><code id="mtaregime_+3A_delta">Delta</code></td>
<td>
<p>list type object with names (delta1, ..., deltad), each one a matrix <code class="reqn">(kx1)</code> type object parameter specification of Threshold process. Default NULL</p>
</td></tr>
<tr><td><code id="mtaregime_+3A_sigma">Sigma</code></td>
<td>
<p>a positive-definite symmetric matrix <code class="reqn">(kxk)</code>, specification of errors covariate matrix. Not NULL</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Causes creation of the object class &ldquo;<code>regime</code>&rdquo;. Sigma matrix corresponds to <code class="reqn">\Sigma</code> (root of the covariance matrix). When cs is not specified or only matrices are delivered for some lags, the function assumes unspecified 0 (matrix). Rows number in the Phi, Beta and Delta matrix should be the same (k dimension of variables in Yt).
</p>


<h3>Value</h3>

<p>Return list type object of class &ldquo;<code>regime</code>&rdquo; with the values of the arguments
</p>


<h3>Author(s)</h3>

<p>Valeria Bejarano <a href="mailto:vbejaranos@unal.edu.co">vbejaranos@unal.edu.co</a> &amp; Andrey Rincon <a href="mailto:adrincont@unal.edu.co">adrincont@unal.edu.co</a></p>


<h3>References</h3>

<p>Calderon, S. and Nieto, F. (2017) <em>Bayesian analysis of multivariate threshold autoregress models with missing data.</em> Communications in Statistics - Theory and Methods 46 (1):296–318. doi:10.1080/03610926.2014.990758.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mtarsim">mtarsim</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'># Creation of parameters for regimen with orders = c(2,1,1), nu = 1 y k = 2.
## previous objects
orders = list(p = 2,q = 1,d = 1)
Phi = list(phi2 = matrix(c(0.1,0.6,-0.4,0.5),2,2, byrow = TRUE))
Beta = list(beta1 = matrix(c(0.3,-0.4),2, 1))
Delta = list(delta1 = matrix(c(0.6,1),2,1))
Sigma = matrix(c(1,0.6,0.6,1.5),2,2,byrow = TRUE)
cs = matrix(c(1,-1),nrow = 2)
## creacion de la clase regime
Ri = mtaregime(orders = orders,Phi = Phi,Beta = Beta,Delta = Delta,
Sigma = Sigma,cs = cs)
class(Ri)
</code></pre>

<hr>
<h2 id='mtarinipars'>Organization and check model specification</h2><span id='topic+mtarinipars'></span>

<h3>Description</h3>

<p>Model specification of data, known or unknown parameters and its prior distributions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mtarinipars(tsregime_obj, list_model = list(pars = list(l = 2,
orders = list(pj = c(1,1), qj = c(0,0), dj = c(0,0)), r = NULL, Sigma = NULL),
orders = NULL,l0_min = NULL,l0_max = NULL), method = NULL, theta_prior = NULL,
sigma_prior = NULL,gamma_prior = NULL, r_prior = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mtarinipars_+3A_tsregime_obj">tsregime_obj</code></td>
<td>
<p>class &ldquo;<code>tsregime</code>&rdquo; object. Not NULL</p>
</td></tr>
<tr><td><code id="mtarinipars_+3A_list_model">list_model</code></td>
<td>
<p>list type object with at least one of the names (pars, orders, l0).
</p>
<p>{pars: list type object with one of the names (l, orders, r, Sigma) for parameters of the model known
</p>
<p>(l: number of regimes of the model (not known use l0). Default 2
</p>
<p>orders:list type object with names (pj,qj,dj) each a vector of length l, specificate lags orders in each regime. Default list(pj = c(1,1), qj = c(0,0), dj = c(0,0))
</p>
<p>r: threshold value. Default NULL
</p>
<p>Sigma: list type object with names (R1, ..., Rl) each a matrix type object, specification of error covariate matrix. Default NULL)
</p>
<p>orders: list type object with names (pj,qj,dj) each a vector of length l,specificate maximum lags orders in each regime if not known. Default NULL
</p>
<p>l0_min: numeric type, number minimum of regimes to consider for the model if not known. Default NULL
</p>
<p>l0_max: numeric type, number maximum of regimes to consider for the model if not known. Default NULL}
</p>
</td></tr>
<tr><td><code id="mtarinipars_+3A_method">method</code></td>
<td>
<p>character type object, if orders not known or enter l0 it must be one &ldquo;KUO&rdquo; or &ldquo;SSVS&rdquo;, when known it is not necessary. Default NULL</p>
</td></tr>
<tr><td><code id="mtarinipars_+3A_theta_prior">theta_prior</code></td>
<td>
<p>list type object with names (R1, ..., Rl), each one a list type object with at least one of the names (theta0j,cov0j)(if method &ldquo;SSVS&rdquo; (theta0j,cov0j,Cij,Tauij,R)),specification of mean and covariate matrix of the prior distribution for <code class="reqn">\theta</code> parameter. Default NULL</p>
</td></tr>
<tr><td><code id="mtarinipars_+3A_sigma_prior">sigma_prior</code></td>
<td>
<p>list type object with names (R1, ..., Rl), each one a list type object with at least one of the names (S0j,nu0j) specification of matrix and degrees of freedom of the prior distribution for <code class="reqn">\Sigma</code> parameter. Default NULL</p>
</td></tr>
<tr><td><code id="mtarinipars_+3A_gamma_prior">gamma_prior</code></td>
<td>
<p>list type object with names (R1, ..., Rl), each one a vector of prior probabilities for <code class="reqn">\gamma</code> parameter. Default NULL</p>
</td></tr>
<tr><td><code id="mtarinipars_+3A_r_prior">r_prior</code></td>
<td>
<p>list type object with at least one name (za, zb, val_rmh), each one a numeric type object with the minimum, maximum value for r and its parameter for Metropolis-Hasting respectively. Default NULL</p>
</td></tr>
</table>


<h3>Details</h3>

<p>list_model its a easy way to identify what need to be estimated in the MTAR model.
First, pars refers to known parameters in the model like &ldquo;l&rdquo; number of regimes, &ldquo;orders&rdquo; lags for output, covariate and threshold processes, &ldquo;r&rdquo; threshold value and &ldquo;Sigma&rdquo; covariance error matrix for each regime.
Also when lags orders or l0 are unknown this could be added to this list.
Second, in order to identify autoregressive orders in MTAR models, two methods for stochastic search are selected because it permits us that the estimation is done in only one step.
The first method, called Kuo and Mallick (Kuo), was introduced in (Kuo &amp; Mallick, 1998) for variable selection in regression models. The second one was proposed in (George &amp; McCulloch, 1993) and it is called Stochastic Search Variable Selection (SSVS).
Then &ldquo;method&rdquo; refers to one of this two for estimating structural parameters of the MTAR model.
Third, all related to prior distributions of our parameters of interest
</p>
<p style="text-align: center;"><code class="reqn">\theta_j \sim N(\theta_0j,\Sigma_0j) in Regime j and \theta_j = vec(A_j) A_j = [\Phi_0 \Phi_1:p \beta_1:q \delta_1:d]</code>
</p>

<p style="text-align: center;"><code class="reqn">\Sigma_j \sim W(S_0j,\nu_0j)</code>
</p>

<p style="text-align: center;"><code class="reqn">\gamma_ij \sim Ber(p_ij0) where i = 1,..., k*p_j + nu*q_j + d</code>
</p>

<p style="text-align: center;"><code class="reqn"> r \sim U(za,zb) and its proposal for MH algorithm U(-val_rmh,val_rmh)</code>
</p>



<h3>Value</h3>

<p>Return a list type object of class &ldquo;<code>regime_inipars</code>&rdquo;
</p>
<table>
<tr><td><code>tsregime_obj</code></td>
<td>
<p> = tsregime_obj</p>
</td></tr>
<tr><td><code>pars</code></td>
<td>
<p>= list_model$pars</p>
</td></tr>
<tr><td><code>orders</code></td>
<td>
<p> = list_model$orders or list_model$pars$orders</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p> = method</p>
</td></tr>
<tr><td><code>init$r</code></td>
<td>
<p> = r_prior</p>
</td></tr>
<tr><td><code>init$Theta</code></td>
<td>
<p> = theta_prior</p>
</td></tr>
<tr><td><code>init$Sigma</code></td>
<td>
<p> = sigma_prior</p>
</td></tr>
<tr><td><code>init$Gamma</code></td>
<td>
<p> = gamma_prior</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Valeria Bejarano <a href="mailto:vbejaranos@unal.edu.co">vbejaranos@unal.edu.co</a> &amp; Andrey Rincon <a href="mailto:adrincont@unal.edu.co">adrincont@unal.edu.co</a></p>


<h3>References</h3>

<p>Calderon, S. and Nieto, F. (2017) <em>Bayesian analysis of multivariate threshold autoregress models with missing data.</em> Communications in Statistics - Theory and Methods 46 (1):296–318. doi:10.1080/03610926.2014.990758.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("datasim")
tsregime_obj = datasim$Sim
# for estimate non-structural parameters:
# mtarns: l always known,
# Sigma = NULL = list(R1,R2) can be known, r = NULL can be known
# Sigma and r known
parameters = list(l = length(datasim$Reg),
Sigma = list(R1 = datasim$Reg$R1$sigma,R2 = datasim$Reg$R2$sigma),
r = tsregime_obj$r,
orders = list(pj = datasim$pj, qj = datasim$qj, dj = datasim$dj))
initpars_Sr = mtarinipars(tsregime_obj,list_model = list(pars = parameters))
#only r known
parameters = list(l = length(datasim$Reg),Sigma = NULL, r = tsregime_obj$r,
orders = list(pj = datasim$pj, qj = datasim$qj, dj = datasim$dj))
initpars_r = mtarinipars(tsregime_obj,list_model = list(pars = parameters))
#r and Sigma unknown
parameters = list(l = length(datasim$Reg),Sigma = NULL, r = NULL,
orders = list(pj = datasim$pj, qj = datasim$qj, dj = datasim$dj))
initpars = mtarinipars(tsregime_obj,list_model = list(pars = parameters))
# for estimate structural and non-structural parameters
# mtarstr: l always known
parameters = list(l = length(datasim$Reg))
orders = list(pj = c(2,2),dj = c(1,1))
initpars_KUO = mtarinipars(tsregime_obj,
list_model = list(pars = parameters,orders = orders),method = 'KUO')
initpars_SSVS = mtarinipars(tsregime_obj,
list_model = list(pars = parameters,orders = orders),method = 'SSVS')
# mtarnumreg l0_min or l0_max and method always
initpars_l = mtarinipars(tsregime_obj,list_model = list(l0_max = 3),method = 'KUO')
</code></pre>

<hr>
<h2 id='mtarmissing'>Estimation of missing values of observed, covariate and threshold processes</h2><span id='topic+mtarmissing'></span>

<h3>Description</h3>

<p>Estimation using Bayesian methodology of missing values in observed(output), covariate and threshold processes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mtarmissing(ini_obj,niter = 1000, chain = FALSE, level = 0.95,
burn = NULL, cU = 0.5, b = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mtarmissing_+3A_ini_obj">ini_obj</code></td>
<td>
<p>class &ldquo;<code>regime_inipars</code>&rdquo; object, here specificate in pars: l, orders and r known. Not NULL</p>
</td></tr>
<tr><td><code id="mtarmissing_+3A_niter">niter</code></td>
<td>
<p>numeric type, number of runs of MCMC. Default 1000</p>
</td></tr>
<tr><td><code id="mtarmissing_+3A_chain">chain</code></td>
<td>
<p>logical type, if return chains of parameters. Default FALSE</p>
</td></tr>
<tr><td><code id="mtarmissing_+3A_level">level</code></td>
<td>
<p>numeric type, confident interval for estimations. Default 0.95</p>
</td></tr>
<tr><td><code id="mtarmissing_+3A_burn">burn</code></td>
<td>
<p>numeric type, number of initial runs. Default NULL (10% of niter)</p>
</td></tr>
<tr><td><code id="mtarmissing_+3A_cu">cU</code></td>
<td>
<p>numeric type, coefficient of the diagonal covariance matrix of process Ut = (Zt,Xt). Default 0.5</p>
</td></tr>
<tr><td><code id="mtarmissing_+3A_b">b</code></td>
<td>
<p>numeric type greater or equal 1, autoregressive order of Ut = (Zt,Xt). Default NULL meaning 1</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The MTAR model
</p>
<p><code class="reqn">Y_t= \phi^{(j)}_{0}+ \sum_{i=1}^{p_j} \phi_{i}^{(j)}Y_{t-i}+  \sum_{i=1}^{q_j}\beta_{i}^{(j)}X_{t-i} + \sum{i=1}^{d_j}\delta_{i}^{(j)}Z_{t-i} +\Sigma_{(j)}^{1/2} \epsilon_{t}  if  r_{j-1}&lt; Z_t \le r_{j},</code>
</p>
<p>is written into a state space model with regime-switching where the matrices depend on the threshold variable. In order to estimate the missing data in the observed vector <code class="reqn">Y_t</code>, it is necessary to obtain samples of the full conditional distribution of the state vector <code class="reqn">\alpha_t</code>, for all times <code class="reqn">t=1,\cdots,T</code> using Kalman Filter. It is assumed that the process <code class="reqn">U_t=(X_t,Z_t)</code> is a Markov chain, and in order to get samples of the full conditional distribution of <code class="reqn">U_t, t=1,\cdots,T</code>, it is supposed that kernel and initial distribution
are Gaussian for simplicity. However, in the next updates, we are going to get flexibility at this point.
</p>


<h3>Value</h3>

<p>Return list type object of class &ldquo;<code>regime_missing</code>&rdquo;
</p>
<table>
<tr><td><code>tsregime</code></td>
<td>
<p>ini_obj$tsregime_obj with estimated observations</p>
</td></tr>
<tr><td><code>estimates</code></td>
<td>
<p>confident interval and mean of estimated missing values</p>
</td></tr>
<tr><td><code>Chain</code></td>
<td>
<p>if chain TRUE, chains of the estimated missing values</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Valeria Bejarano <a href="mailto:vbejaranos@unal.edu.co">vbejaranos@unal.edu.co</a>, Sergio Calderon <a href="mailto:sacalderonv@unal.edu.co">sacalderonv@unal.edu.co</a> &amp; Andrey Rincon <a href="mailto:adrincont@unal.edu.co">adrincont@unal.edu.co</a></p>


<h3>References</h3>

<p>Calderon, S. and Nieto, F. (2017) <em>Bayesian analysis of multivariate threshold autoregress models with missing data.</em> Communications in Statistics - Theory and Methods 46 (1):296–318. doi:10.1080/03610926.2014.990758.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("datasim")
yt = datasim$Sim
# some missing data
data_yt = yt$Yt
data_zt = yt$Zt
posNA = sample(c(1:500),8)
data_yt[c(posNA),] = c(NA,NA)
posNA = sample(c(1:500),8)
data_zt[c(posNA)] = NA
data_final = tsregime(data_yt,data_zt,r = yt$r)
autoplot.tsregime(data_final,1)
autoplot.tsregime(data_final,2)

initial = mtarinipars(tsregime_obj = data_final,
list_model = list(pars = list(l = 2,r = datasim$Sim$r,
orders = list(pj = c(1,1), qj = c(0,0),dj = c(0,0)))))

missingest = mtarmissing(ini_obj = initial,chain = TRUE,
niter = 500,burn = 500)
print(missingest)
autoplot.regime_missing(missingest,1)
datasim$Sim$Yt[is.na(data_yt[,1]),]
missingest$tsregime$Yt[is.na(data_yt[,1]),]

</code></pre>

<hr>
<h2 id='mtarNAIC'>Compute NAIC of a MTAR model</h2><span id='topic+mtarNAIC'></span>

<h3>Description</h3>

<p>Compute the Non-linear Akaike information criterion (NAIC) of a &ldquo;<code>regime_model</code>&rdquo; class object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mtarNAIC(regimemodel)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mtarNAIC_+3A_regimemodel">regimemodel</code></td>
<td>
<p>object of class &ldquo;<code>regime_model</code>&rdquo;</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Estimation of thresholds was made before starting the Bayesian procedure via the Non-linear Akaike information criterion (NAIC) (Tong, 1990), in MTAR model. The NAIC for a MTAR model with l regimes is:
</p>
<p style="text-align: center;"><code class="reqn">
 NAIC = {\sum_{j = 1}^l AICj(r)}/{\sum_{j = 1}^l N_j}
 </code>
</p>

<p style="text-align: center;"><code class="reqn">
  AICj(r) = Nj ln(|Sj/Nj|) + 2k \eta_j
 </code>
</p>

<p>Nj: number of observations in each regime.
</p>
<p style="text-align: center;"><code class="reqn">
 S_{j}=\sum_{t:j_t = j}(y_t-YP)'(y_t-YP)
 </code>
</p>

<p style="text-align: center;"><code class="reqn">
  YP =  \Phi_{0}^(j)+\sum_{i=1}^{p_j}\Phi_{i}^{(j)} Y_{t-i}+\sum_{i=1}^{q_j} \beta_{i}^{(j)} X_{t-i} + \sum_{i=1}^{d_j} \delta_{i}^{(j)} Z_{t-i}
 </code>
</p>



<h3>Value</h3>

<p>Return a list type object:
</p>
<table>
<tr><td><code>AICj</code></td>
<td>
<p>numeric type, AIC for each regime</p>
</td></tr>
<tr><td><code>NAIC</code></td>
<td>
<p>numeric type, NAIC value</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Valeria Bejarano <a href="mailto:vbejaranos@unal.edu.co">vbejaranos@unal.edu.co</a>, Sergio Calderon <a href="mailto:sacalderonv@unal.edu.co">sacalderonv@unal.edu.co</a> &amp; Andrey Rincon <a href="mailto:adrincont@unal.edu.co">adrincont@unal.edu.co</a></p>


<h3>References</h3>

<p>Calderon, S. and Nieto, F. (2017) <em>Bayesian analysis of multivariate threshold autoregress models with missing data.</em> Communications in Statistics - Theory and Methods 46 (1):296–318. doi:10.1080/03610926.2014.990758.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("datasim")
data = datasim
# Estimate number of regimes with NAIC
initial1 = mtarinipars(tsregime_obj = data$Sim,
list_model = list(pars = list(l = 2,
orders = list(pj = c(1,1),dj = c(1,1)), r = 0.2)))
estruc1 = mtarns(ini_obj = initial1,niter = 100,chain = TRUE,burn = 100)

initial2 = mtarinipars(tsregime_obj = data$Sim,
list_model = list(pars = list(l = 2,
orders = list(pj = c(1,1),dj = c(1,1)), r = 0.3)))
estruc2 = mtarns(ini_obj = initial2,niter = 100,chain = TRUE,burn = 100)
#NAIC
mtarNAIC(estruc1)
mtarNAIC(estruc2)
</code></pre>

<hr>
<h2 id='mtarns'>Estimation of non-structural parameters for MTAR model</h2><span id='topic+mtarns'></span>

<h3>Description</h3>

<p>Bayesian method for estimating non-structural parameters of a MTAR model with prior conjugate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mtarns(ini_obj, level = 0.95, burn = NULL, niter = 1000,
chain = FALSE, r_init = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mtarns_+3A_ini_obj">ini_obj</code></td>
<td>
<p>class &ldquo;<code>regime_inipars</code>&rdquo; object, here specificate l and orders known, might know r or Sigma. Not NULL. Default l = 2, orders = list(pj = c(2,2))</p>
</td></tr>
<tr><td><code id="mtarns_+3A_level">level</code></td>
<td>
<p>numeric type, confident interval for estimations. Default 0.95</p>
</td></tr>
<tr><td><code id="mtarns_+3A_burn">burn</code></td>
<td>
<p>numeric type, number of initial runs. Default NULL (30% of niter)</p>
</td></tr>
<tr><td><code id="mtarns_+3A_niter">niter</code></td>
<td>
<p>numeric type, number of runs of MCMC. Default 1000</p>
</td></tr>
<tr><td><code id="mtarns_+3A_chain">chain</code></td>
<td>
<p>logical type, if return chains of parameters. Default FALSE</p>
</td></tr>
<tr><td><code id="mtarns_+3A_r_init">r_init</code></td>
<td>
<p>numeric type of length l - 1. If r not known, starting value of the chain. Default NULL</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Based on the equation of the Multivariate Threshold Autoregressive(MTAR) Model
</p>
<p><code class="reqn">Y_t= \phi^{(j)}_{0}+ \sum_{i=1}^{p_j} \phi_{i}^{(j)}Y_{t-i}+  \sum_{i=1}^{q_j}\beta_{i}^{(j)}X_{t-i} + \sum{i=1}^{d_j}\delta_{i}^{(j)}Z_{t-i} +\Sigma_{(j)}^{1/2} \epsilon_{t}  if  r_{j-1}&lt; Z_t \le r_{j},</code>
</p>
<p>where process <code class="reqn">\{\epsilon_{t}\}</code> is a k-variate independent Gaussian process, <code class="reqn">\{Y_t\}</code> is k-variate process, <code class="reqn">\{X_t\} is a \nu - variate process.</code>
The function implements Bayesian estimation of non-structural parameters of each regime j(<code class="reqn">\phi^{(j)}_{0} \phi_{i}^{(j)}, \beta_{i}^{(j)}, \delta_{i}^{(j)} and \Sigma_{(j)}^{1/2}</code>) is carried out. The structural parameters: Number of Regimes(l), Thresholds(<code class="reqn">r_1,\cdots,r_{l-1}</code>), and autoregressive orders(<code class="reqn">p_j,q_j,d_j</code>) must be known. Prior distributions where selected in order to get conjugate distributions.
</p>


<h3>Value</h3>

<p>Return a list type object of class &ldquo;<code>regime_model</code>&rdquo;
</p>
<table>
<tr><td><code>Nj</code></td>
<td>
<p>number of observations in each regime</p>
</td></tr>
<tr><td><code>estimates</code></td>
<td>
<p>list for each regime with confident interval and mean value of the parameters</p>
</td></tr>
<tr><td><code>regime</code></td>
<td>
<p>&ldquo;<code>regime</code>&rdquo; class objects with final estimations</p>
</td></tr>
<tr><td><code>Chain</code></td>
<td>
<p>if chain TRUE list type object with parameters chains</p>
</td></tr>
<tr><td><code>fitted.values</code></td>
<td>
<p>matrix type object with fitted.values of the estimated model</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>matrix type object with residuals of the estimated model</p>
</td></tr>
<tr><td><code>logLikj</code></td>
<td>
<p>log-likelihood of each regime with final estimations</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>list type object $Yt and $Ut = (Zt,Xt)</p>
</td></tr>
<tr><td><code>r</code></td>
<td>
<p>final threshold value with acceptance percentage or r if known</p>
</td></tr>
<tr><td><code>orders</code></td>
<td>
<p>list type object with names (pj,qj,dj) known</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Valeria Bejarano <a href="mailto:vbejaranos@unal.edu.co">vbejaranos@unal.edu.co</a>, Sergio Calderon <a href="mailto:sacalderonv@unal.edu.co">sacalderonv@unal.edu.co</a> &amp; Andrey Rincon <a href="mailto:adrincont@unal.edu.co">adrincont@unal.edu.co</a></p>


<h3>References</h3>

<p>Calderon, S. and Nieto, F. (2017) <em>Bayesian analysis of multivariate threshold autoregress models with missing data.</em> Communications in Statistics - Theory and Methods 46 (1):296–318. doi:10.1080/03610926.2014.990758.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("datasim")
data = datasim
#r known
parameters = list(l = 2,
                  orders = list(pj = c(1,1)),
                  r = data$Sim$r)
initial = mtarinipars(tsregime_obj = data$Sim,
                      list_model = list(pars = parameters))

estim1 = mtarns(ini_obj = initial,niter = 1000,chain = TRUE)
print.regime_model(estim1)
autoplot.regime_model(estim1,2)
autoplot.regime_model(estim1,3)
autoplot.regime_model(estim1,5)
diagnostic_mtar(estim1)

#r unknown
parameters = list(l = 2,orders = list(pj = c(1,1)))
initial = mtarinipars(tsregime_obj = data$Sim,
list_model = list(pars = parameters))

estim2 = mtarns(ini_obj = initial,niter = 500,chain = TRUE)
print.regime_model(estim2)
autoplot.regime_model(estim2,1)
autoplot.regime_model(estim2,2)
autoplot.regime_model(estim2,3)
autoplot.regime_model(estim2,5)
diagnostic_mtar(estim2)

</code></pre>

<hr>
<h2 id='mtarnumreg'>Estimation of the number of regimes in a MTAR model</h2><span id='topic+mtarnumreg'></span>

<h3>Description</h3>

<p>Compute estimation of number of regimes by NAIC or Carlin and Chib methodology for a MTAR model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mtarnumreg(ini_obj, level = 0.95, burn_m = NULL,niter_m = 1000,
iterprev = 500, chain_m = FALSE, list_m = FALSE,
NAIC = FALSE,ordersprev = list(maxpj = 2,maxqj = 0,maxdj = 0),
parallel = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mtarnumreg_+3A_ini_obj">ini_obj</code></td>
<td>
<p>class &ldquo;<code>regime_inipars</code>&rdquo; object, here specificate l0_min, l0_max and method. Not NULL. Default l0_min = 2, l0_max = 3, method = 'KUO'</p>
</td></tr>
<tr><td><code id="mtarnumreg_+3A_level">level</code></td>
<td>
<p>numeric type, confident interval for estimations. Default 0.95</p>
</td></tr>
<tr><td><code id="mtarnumreg_+3A_burn_m">burn_m</code></td>
<td>
<p>numeric type, number of initial runs. Default NULL (10% of niter)</p>
</td></tr>
<tr><td><code id="mtarnumreg_+3A_niter_m">niter_m</code></td>
<td>
<p>numeric type, number of runs of MCMC. Default 1000</p>
</td></tr>
<tr><td><code id="mtarnumreg_+3A_iterprev">iterprev</code></td>
<td>
<p>numeric type, number of runs for pseudo values. Default 500</p>
</td></tr>
<tr><td><code id="mtarnumreg_+3A_chain_m">chain_m</code></td>
<td>
<p>logical type, if return chains of parameters. Default FALSE</p>
</td></tr>
<tr><td><code id="mtarnumreg_+3A_list_m">list_m</code></td>
<td>
<p>logical type, if return list of regimes considered. Default FALSE</p>
</td></tr>
<tr><td><code id="mtarnumreg_+3A_naic">NAIC</code></td>
<td>
<p>logical type, if return estimation of number of regimes by NAIC (not run Carlin and Chip for l). Default FALSE</p>
</td></tr>
<tr><td><code id="mtarnumreg_+3A_ordersprev">ordersprev</code></td>
<td>
<p>list type object with names (maxpj,maxqj,maxdj), maximum number of lags of each process consider in the pseudo values for each number of regimes considered . Default maxpj = 2,maxqj = 0, maxdj = 0</p>
</td></tr>
<tr><td><code id="mtarnumreg_+3A_parallel">parallel</code></td>
<td>
<p>logical type, if package <code>parallel</code> should be used. Default FALSE</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Two proposals to identify or estimate the number of regimes l are implemented. Metropolised Carlin and Chib methodology takes into account the changing dimension in the parameter vector when the number of regimes changes, that proposal is  Bayesian model selection. Other methodology consists in calculating the information criterion NAIC.
</p>


<h3>Value</h3>

<p>Return a list type object of class &ldquo;<code>regime_number</code>&rdquo;
</p>
<table>
<tr><td><code>tsregime</code></td>
<td>
<p>ini_obj$tsregime_obj</p>
</td></tr>
<tr><td><code>list_m</code></td>
<td>
<p>if list_m TRUE list of models considered</p>
</td></tr>
<tr><td><code>m_chain</code></td>
<td>
<p>if chain_m TRUE chains of m</p>
</td></tr>
<tr><td><code>estimates</code></td>
<td>
<p>table of the proportions of m estimated</p>
</td></tr>
<tr><td><code>final_m</code></td>
<td>
<p>numeric type, final number of regimes estimated</p>
</td></tr>
</table>
<p>If NAIC TRUE
</p>
<table>
<tr><td><code>tsregime</code></td>
<td>
<p>ini_obj$tsregime_obj</p>
</td></tr>
<tr><td><code>list_m</code></td>
<td>
<p>list of consider models</p>
</td></tr>
<tr><td><code>NAIC</code></td>
<td>
<p>list type of NAIC for each considered model</p>
</td></tr>
<tr><td><code>NAIC_final_m</code></td>
<td>
<p>numeric type, final number of regimes by this criteria</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Valeria Bejarano <a href="mailto:vbejaranos@unal.edu.co">vbejaranos@unal.edu.co</a>, Sergio Calderon <a href="mailto:sacalderonv@unal.edu.co">sacalderonv@unal.edu.co</a> &amp; Andrey Rincon <a href="mailto:adrincont@unal.edu.co">adrincont@unal.edu.co</a></p>


<h3>References</h3>

<p>Calderon, S. and Nieto, F. (2017) <em>Bayesian analysis of multivariate threshold autoregress models with missing data.</em> Communications in Statistics - Theory and Methods 46 (1):296–318. doi:10.1080/03610926.2014.990758.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("datasim")
data = datasim
initial = mtarinipars(tsregime_obj = data$Sim,
list_model = list(l0_max = 3),method = 'KUO')

estim = mtarnumreg(ini_obj = initial,iterprev = 500,niter_m = 500,
burn_m = 500, list_m = TRUE,ordersprev = list(maxpj = 2))
estim$final_m

</code></pre>

<hr>
<h2 id='mtarsim'>Multivariate threshold autoregressive process simulation</h2><span id='topic+mtarsim'></span>

<h3>Description</h3>

<p>Given an list object of the class &ldquo;<code>regime</code>&rdquo; (length = l) with the model specification simulates N observations for a MTAR (Multivariate threshold autoregressive process) process.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mtarsim(N, Rg, r = NULL, Xt = NULL, Zt = NULL, seed = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mtarsim_+3A_n">N</code></td>
<td>
<p>numeric type greater than 0. Number of observation to simulate. Not NULL</p>
</td></tr>
<tr><td><code id="mtarsim_+3A_rg">Rg</code></td>
<td>
<p>list type object of length l number of regimes of the process with names (R1, ..., Rl), each a class &ldquo;<code>regime</code>&rdquo; object. Not NULL</p>
</td></tr>
<tr><td><code id="mtarsim_+3A_r">r</code></td>
<td>
<p>numeric type of length l - 1, threshold value (within the range of Z_t). Default NULL</p>
</td></tr>
<tr><td><code id="mtarsim_+3A_xt">Xt</code></td>
<td>
<p>matrix <code class="reqn">(Nx\nu)</code> type object, covariate process (admit NA values). Default NULL</p>
</td></tr>
<tr><td><code id="mtarsim_+3A_zt">Zt</code></td>
<td>
<p>matrix <code class="reqn">(Nx1)</code> type object, threshold process (admit NA values). Default NULL</p>
</td></tr>
<tr><td><code id="mtarsim_+3A_seed">seed</code></td>
<td>
<p>numeric type, set a seed for simulation</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given a list of length l of object of class &ldquo;<code>regime</code>&rdquo; (model specification), it simulates observations of a MTAR process ($ Sim) and returns them an object of the class &ldquo;<code>mtarsim</code>&rdquo;. We have an MTAR process is given by:
</p>
<p style="text-align: center;"><code class="reqn">
Y_t= \Phi_{0}^(j)+\sum_{i=1}^{p_j}\Phi_{i}^{(j)} Y_{t-i}+\sum_{i=1}^{q_j} \beta_{i}^{(j)} X_{t-i} + \sum_{i=1}^{d_j} \delta_{i}^{(j)} Z_{t-i}+ \Sigma_{(j)}^{1/2} \epsilon_{t}
</code>
</p>

<p style="text-align: center;"><code class="reqn">if r_{j-1}&lt; Z_t \leq r_{j}</code>
</p>

<p>The simulation has 100 burn observations to stabilize the process. It is possible to simulate univariate (TAR, SETAR, etc.) or multivariate (VAR) processes, properly specifying the regime type object according to the model.
</p>


<h3>Value</h3>

<p>Return a list type object of class &ldquo;<code>mtarsim</code>&rdquo;:
</p>
<table>
<tr><td><code>Sim</code></td>
<td>
<p>object class &ldquo;<code>tsregime</code>&rdquo;</p>
</td></tr>
<tr><td><code>Reg</code></td>
<td>
<p>list type object with names (R1, ..., Rl) each one class &ldquo;<code>regime</code>&rdquo;</p>
</td></tr>
<tr><td><code>pj</code></td>
<td>
<p>vector of autoregressive orders in each regime</p>
</td></tr>
<tr><td><code>qj</code></td>
<td>
<p>vector of covariate lags orders in each regime</p>
</td></tr>
<tr><td><code>dj</code></td>
<td>
<p>vector of lags orders of threshold process in each regime</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Valeria Bejarano <a href="mailto:vbejaranos@unal.edu.co">vbejaranos@unal.edu.co</a>, Sergio Calderon <a href="mailto:sacalderonv@unal.edu.co">sacalderonv@unal.edu.co</a> &amp; Andrey Rincon <a href="mailto:adrincont@unal.edu.co">adrincont@unal.edu.co</a></p>


<h3>References</h3>

<p>Calderon, S. and Nieto, F. (2017) <em>Bayesian analysis of multivariate threshold autoregress models with missing data.</em> Communications in Statistics - Theory and Methods 46 (1):296–318. doi:10.1080/03610926.2014.990758.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mtaregime">mtaregime</a></code>,
<code><a href="#topic+mtarns">mtarns</a></code>,
<code><a href="#topic+mtarstr">mtarstr</a></code>,
<code><a href="#topic+mtarmissing">mtarmissing</a></code>,
<code><a href="#topic+mtarnumreg">mtarnumreg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## get Ut data process
Tlen = 500
Sigma_ut = 2
Phi_ut = list(phi1 = 0.3)
R_ut = list(R1 = mtaregime(orders = list(p = 1,q = 0,d = 0),Phi = Phi_ut,Sigma = Sigma_ut))
Ut = mtarsim(N = Tlen,Rg = R_ut,seed = 124)
Zt = Ut$Sim$Yt

# Yt process
k = 2
## R1 regime
Phi_R1 = list(phi1 = matrix(c(0.1,0.6,-0.4,0.5),k,k,byrow = TRUE))
Sigma_R1 = matrix(c(1,0,0,1),k,k,byrow = TRUE)
R1 = mtaregime(orders = list(p = 1,q = 0,d = 0),Phi = Phi_R1,Sigma = Sigma_R1)
## R2 regime
Phi_R2 = list(phi1 = matrix(c(0.3,0.5,0.2,0.7),2,2,byrow = TRUE))
Sigma_R2 = matrix(c(2.5,0.5,0.5,1),2,2,byrow = TRUE)
R2 = mtaregime(orders = list(p = 1,q = 0,d = 0),
Phi = Phi_R2,Sigma = Sigma_R2)
## create list of regime-type objects
Rg = list(R1 = R1,R2 = R2)
r = 0.3

# get the simulation
datasim = mtarsim(N = Tlen,Rg = Rg,r = r,Zt = Zt,seed = 124)
autoplot.tsregime(datasim$Sim,1)
autoplot.tsregime(datasim$Sim,2)
</code></pre>

<hr>
<h2 id='mtarstr'>Estimation of structural parameters of MTAR model</h2><span id='topic+mtarstr'></span>

<h3>Description</h3>

<p>Estimate structural and non-structural parameters of a MTAR model when the number of regimes is fixed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mtarstr(ini_obj, level = 0.95, niter = 1000, burn = NULL, chain = FALSE,
r_init = NULL, parallel = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mtarstr_+3A_ini_obj">ini_obj</code></td>
<td>
<p>class &ldquo;<code>regime_inipars</code>&rdquo; object, here specificate in pars: l known, orders not known. Not NULL. Default for l = 2, orders = list(pj = c(2,2)) and method = 'KUO'</p>
</td></tr>
<tr><td><code id="mtarstr_+3A_level">level</code></td>
<td>
<p>numeric type, confident interval for estimations. Default 0.95</p>
</td></tr>
<tr><td><code id="mtarstr_+3A_burn">burn</code></td>
<td>
<p>numeric type, number of initial runs. Default NULL (30% of niter)</p>
</td></tr>
<tr><td><code id="mtarstr_+3A_niter">niter</code></td>
<td>
<p>numeric type, number of runs of MCMC. Default 1000</p>
</td></tr>
<tr><td><code id="mtarstr_+3A_chain">chain</code></td>
<td>
<p>logical type, if return chains of parameters. Default FALSE</p>
</td></tr>
<tr><td><code id="mtarstr_+3A_r_init">r_init</code></td>
<td>
<p>numeric type of length l - 1. If r not known, starting value of the chain. Default NULL</p>
</td></tr>
<tr><td><code id="mtarstr_+3A_parallel">parallel</code></td>
<td>
<p>logical type, if package <code>parallel</code> should be used. Default FALSE</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the number of regimes <code class="reqn">l</code> is known or fixed, we can estimate other structural parameters of the MTAR model: Thresholds(<code class="reqn">r_1,\cdots,r_{l-1}</code>), and autoregressive orders(<code class="reqn">p_j,q_j,d_j</code>). Of course, the non-structural parameters are also estimated. The problem of estimation the autoregressive orders is addressed to the problem of Bayesian variable selection in regression using Gibbs Variable selection(GVS) or Kuo and Mallick Methodologies. Samples of the full conditional distribution for Threshold values are extracted using Random Walk Metropolis-Hastings Algorithm.
</p>


<h3>Value</h3>

<p>Return a list type object of class &ldquo;<code>regime_model</code>&rdquo;
</p>
<table>
<tr><td><code>Nj</code></td>
<td>
<p>number of observations in each regime</p>
</td></tr>
<tr><td><code>estimates</code></td>
<td>
<p>list for each regime with confident interval and mean value of the parameters</p>
</td></tr>
<tr><td><code>regime</code></td>
<td>
<p>&ldquo;<code>regime</code>&rdquo; class objects with final estimations</p>
</td></tr>
<tr><td><code>Chain</code></td>
<td>
<p>if chain TRUE list type object with parameters chains</p>
</td></tr>
<tr><td><code>fitted.values</code></td>
<td>
<p>matrix type object with fitted.values of the estimated model</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>matrix type object with residuals of the estimated model</p>
</td></tr>
<tr><td><code>logLikj</code></td>
<td>
<p>log-likelihood of each regime with final estimations</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>list type object $Yt and $Ut = (Zt,Xt)</p>
</td></tr>
<tr><td><code>r</code></td>
<td>
<p>final threshold value estimation with acceptance percentage</p>
</td></tr>
<tr><td><code>orders</code></td>
<td>
<p>list type object with names (pj,qj,dj) final estimations</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Valeria Bejarano <a href="mailto:vbejaranos@unal.edu.co">vbejaranos@unal.edu.co</a>, Sergio Calderon <a href="mailto:sacalderonv@unal.edu.co">sacalderonv@unal.edu.co</a> &amp; Andrey Rincon <a href="mailto:adrincont@unal.edu.co">adrincont@unal.edu.co</a></p>


<h3>References</h3>

<p>Calderon, S. and Nieto, F. (2017) <em>Bayesian analysis of multivariate threshold autoregress models with missing data.</em> Communications in Statistics - Theory and Methods 46 (1):296–318. doi:10.1080/03610926.2014.990758.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("datasim")
data = datasim
# KUO method
initial = mtarinipars(tsregime_obj = data$Sim,method = 'KUO',
list_model = list(pars = list(l = 2),orders = list(pj = c(2,2))))

estruc = mtarstr(ini_obj = initial,niter = 500,chain = TRUE)
autoplot.regime_model(estruc,1)
autoplot.regime_model(estruc,2)
autoplot.regime_model(estruc,3)
autoplot.regime_model(estruc,4)
autoplot.regime_model(estruc,5)

# method can also be 'SSVS'
</code></pre>

<hr>
<h2 id='print'>print an object appropriate to a particular data type</h2><span id='topic+print'></span>

<h3>Description</h3>

<p><code>print</code> a particular output for an object of a
particular class in a single command. This defines the S3 generic that
other classes and packages can extend.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>print(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print_+3A_object">object</code></td>
<td>
<p>an object, whose class will determine the behaviour of autoplot</p>
</td></tr>
<tr><td><code id="print_+3A_...">...</code></td>
<td>
<p>other arguments passed to specific methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>print an output
</p>

<hr>
<h2 id='print.regime_missing'>Print estimates of a regime_missing object of the function output mtarmissing</h2><span id='topic+print.regime_missing'></span>

<h3>Description</h3>

<p>Print estimates output of mtarmissing function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'regime_missing'
print(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.regime_missing_+3A_object">object</code></td>
<td>
<p>Object of class &ldquo;<code>regime_model</code>&rdquo;. Not NULL</p>
</td></tr>
<tr><td><code id="print.regime_missing_+3A_...">...</code></td>
<td>
<p>Other plotting parameters to affect the plot.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Print the estimates for the outputs corresponding to the function &ldquo;<code>mtarmissing</code>&rdquo; which return an object of class &ldquo;<code>regime_missing</code>&rdquo;.
</p>


<h3>Value</h3>

<p>Return to console.
</p>


<h3>Author(s)</h3>

<p>Valeria Bejarano <a href="mailto:vbejaranos@unal.edu.co">vbejaranos@unal.edu.co</a> &amp; Andrey Rincon <a href="mailto:adrincont@unal.edu.co">adrincont@unal.edu.co</a></p>


<h3>References</h3>

<p>Calderon, S. and Nieto, F. (2017) <em>Bayesian analysis of multivariate threshold autoregress models with missing data.</em> Communications in Statistics - Theory and Methods 46 (1):296–318. doi:10.1080/03610926.2014.990758.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mtarmissing">mtarmissing</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data('missingest')
print.regime_missing(missingest)
</code></pre>

<hr>
<h2 id='print.regime_model'>print regime_model object for the function outputs mtarns and mtastr</h2><span id='topic+print.regime_model'></span>

<h3>Description</h3>

<p>Print estimates for the results of the mtarns and mtarstr functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'regime_model'
print(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.regime_model_+3A_object">object</code></td>
<td>
<p>Object of class &ldquo;<code>regime_model</code>&rdquo;. Not NULL</p>
</td></tr>
<tr><td><code id="print.regime_model_+3A_...">...</code></td>
<td>
<p>Other print parameters that affect.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Print estimates outputs corresponding to functions &ldquo;<code>mtarns</code>&rdquo; and &ldquo;<code>mtarstr</code>&rdquo; which return an object of class &ldquo;<code>regime_model</code>&rdquo;.
</p>


<h3>Value</h3>

<p>Return to console.
</p>


<h3>Author(s)</h3>

<p>Valeria Bejarano <a href="mailto:vbejaranos@unal.edu.co">vbejaranos@unal.edu.co</a> &amp; Andrey Rincon <a href="mailto:adrincont@unal.edu.co">adrincont@unal.edu.co</a></p>


<h3>References</h3>

<p>Calderon, S. and Nieto, F. (2017) <em>Bayesian analysis of multivariate threshold autoregress models with missing data.</em> Communications in Statistics - Theory and Methods 46 (1):296–318. doi:10.1080/03610926.2014.990758.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mtarns">mtarns</a></code>, <code><a href="#topic+mtarstr">mtarstr</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data("datasim")
data = datasim$Sim$Zt
parameters = list(l = 1,orders = list(pj = 1))
initial = mtarinipars(tsregime_obj = tsregime(data),
                      list_model = list(pars = parameters))
estim1 = mtarns(ini_obj = initial,niter = 500,chain = TRUE,burn = 500)
print.regime_model(estim1)
</code></pre>

<hr>
<h2 id='print.regime_number'>print regime_number object for the function outputs mtarnumreg</h2><span id='topic+print.regime_number'></span>

<h3>Description</h3>

<p>Print estimates for the results of the mtarnumreg function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'regime_number'
print(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.regime_number_+3A_object">object</code></td>
<td>
<p>Object of class &ldquo;<code>regime_number</code>&rdquo;. Not NULL</p>
</td></tr>
<tr><td><code id="print.regime_number_+3A_...">...</code></td>
<td>
<p>Other print parameters that affect.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Print estimates outputs corresponding to function &ldquo;<code>mtarnumreg</code>&rdquo; which return an object of class &ldquo;<code>regime_number</code>&rdquo;.
</p>


<h3>Value</h3>

<p>Return to console.
</p>


<h3>Author(s)</h3>

<p>Valeria Bejarano <a href="mailto:vbejaranos@unal.edu.co">vbejaranos@unal.edu.co</a> &amp; Andrey Rincon <a href="mailto:adrincont@unal.edu.co">adrincont@unal.edu.co</a></p>


<h3>References</h3>

<p>Calderon, S. and Nieto, F. (2017) <em>Bayesian analysis of multivariate threshold autoregress models with missing data.</em> Communications in Statistics - Theory and Methods 46 (1):296–318. doi:10.1080/03610926.2014.990758.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mtarnumreg">mtarnumreg</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data("datasim_numreg")
print.regime_number(datasim_numreg)
</code></pre>

<hr>
<h2 id='print.tsregime'>Print tsregime object</h2><span id='topic+print.tsregime'></span>

<h3>Description</h3>

<p>Print the structure of a object class &ldquo;<code>tsregime</code>&rdquo;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'tsregime'
print(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.tsregime_+3A_object">object</code></td>
<td>
<p>Object of class &ldquo;<code>tsregime</code>&rdquo;. Not NULL</p>
</td></tr>
<tr><td><code id="print.tsregime_+3A_...">...</code></td>
<td>
<p>Other parameters that affect print.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Print the structure of a object class &ldquo;<code>tsregime</code>&rdquo;.
</p>


<h3>Value</h3>

<p>Return to console.
</p>


<h3>Author(s)</h3>

<p>Valeria Bejarano <a href="mailto:vbejaranos@unal.edu.co">vbejaranos@unal.edu.co</a> &amp; Andrey Rincon <a href="mailto:adrincont@unal.edu.co">adrincont@unal.edu.co</a></p>


<h3>References</h3>

<p>Calderon, S. and Nieto, F. (2017) <em>Bayesian analysis of multivariate threshold autoregress models with missing data.</em> Communications in Statistics - Theory and Methods 46 (1):296–318. doi:10.1080/03610926.2014.990758.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+tsregime">tsregime</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data("datasim")
data = datasim
print.tsregime(data$Sim)
</code></pre>

<hr>
<h2 id='prodB'>Function to make product of elements of a list</h2><span id='topic+prodB'></span>

<h3>Description</h3>

<p>Auxiliary function of some functions in the MTAR package
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prodB(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prodB_+3A_x">x</code></td>
<td>
<p>list of objects to make the product</p>
</td></tr>
</table>


<h3>Value</h3>

<p>float number result of the product
</p>

<hr>
<h2 id='repM'>Function to create list of matrix objects</h2><span id='topic+repM'></span>

<h3>Description</h3>

<p>Auxiliary function of some functions in the MTAR package
</p>


<h3>Usage</h3>

<pre><code class='language-R'>repM(M,r)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="repM_+3A_m">M</code></td>
<td>
<p>matrix type object</p>
</td></tr>
<tr><td><code id="repM_+3A_r">r</code></td>
<td>
<p>integer indicating the length of the list</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of matrix of length r
</p>

<hr>
<h2 id='tsregime'>Creation of class &ldquo;<code>tsregime</code>&rdquo; for some data</h2><span id='topic+tsregime'></span>

<h3>Description</h3>

<p>The function tsregime is used to create time-series-regime objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tsregime(Yt, Zt = NULL, Xt = NULL, r = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tsregime_+3A_yt">Yt</code></td>
<td>
<p>matrix <code class="reqn">(Nxk)</code> type object, observed process (admit NA values). Not NULL</p>
</td></tr>
<tr><td><code id="tsregime_+3A_zt">Zt</code></td>
<td>
<p>matrix <code class="reqn">(Nx1)</code> type object, threshold process (admit NA values). Default NULL</p>
</td></tr>
<tr><td><code id="tsregime_+3A_xt">Xt</code></td>
<td>
<p>matrix <code class="reqn">(Nx\nu)</code> type object, covariate process (admit NA values). Default NULL</p>
</td></tr>
<tr><td><code id="tsregime_+3A_r">r</code></td>
<td>
<p>numeric type, threshold value (within the range of <code class="reqn">Z_t</code>) if known. Default NULL</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Create a class &ldquo;<code>tsregime</code>&rdquo; object composed of: <code class="reqn">Y_t</code> and <code class="reqn">X_t</code> stochastics processes such that <code class="reqn">Y_t=[Y_{1t},...,Y_{kt}]</code>', <code class="reqn">X_t=[X_{1t},...,X_{\nu t}]'</code> and <code class="reqn">Z_t</code> is a univariate process. Where <code class="reqn">Y_t</code> follows a MTAR model with threshold variable <code class="reqn">Z_t</code>
</p>
<p style="text-align: center;"><code class="reqn">
Y_t= \Phi_{0}^(j)+\sum_{i=1}^{p_j}\Phi_{i}^{(j)} Y_{t-i}+\sum_{i=1}^{q_j} \beta_{i}^{(j)} X_{t-i} + \sum_{i=1}^{d_j} \delta_{i}^{(j)} Z_{t-i}+ \Sigma_{(j)}^{1/2} \epsilon_{t}
</code>
</p>

<p style="text-align: center;"><code class="reqn">if r_{j-1}&lt; Z_t \leq r_{j}</code>
</p>

<p>Missing data is allowed for processes <code class="reqn">Y_t</code>, <code class="reqn">X_t</code> and <code class="reqn">Z_t</code> (can then be estimated with &ldquo;<code>mtarmissing</code>&rdquo; function). In the case of known r, the output returns the percentages of observations found in each regimen.
</p>


<h3>Value</h3>

<p>Return a list type object of class &ldquo;<code>tsregime</code>&rdquo;:
</p>
<table>
<tr><td><code>Yt</code></td>
<td>
<p>stochastic output process</p>
</td></tr>
<tr><td><code>Xt</code></td>
<td>
<p>stochastic covariate process (if enter)</p>
</td></tr>
<tr><td><code>Zt</code></td>
<td>
<p>stochastic threshold process (if enter)</p>
</td></tr>
<tr><td><code>N</code></td>
<td>
<p>number of observations</p>
</td></tr>
<tr><td><code>k</code></td>
<td>
<p>number of variables</p>
</td></tr>
</table>
<p>If r known:
</p>
<table>
<tr><td><code>r</code></td>
<td>
<p>threshold value</p>
</td></tr>
<tr><td><code>Ind</code></td>
<td>
<p>numeric type, number of the regime each observation belong</p>
</td></tr>
<tr><td><code>Summary_r</code></td>
<td>
<p>data.frame type, number and proportion of observations in each regime</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Valeria Bejarano <a href="mailto:vbejaranos@unal.edu.co">vbejaranos@unal.edu.co</a> &amp; Andrey Rincon <a href="mailto:adrincont@unal.edu.co">adrincont@unal.edu.co</a></p>


<h3>References</h3>

<p>Calderon, S. and Nieto, F. (2017) <em>Bayesian analysis of multivariate threshold autoregress models with missing data.</em> Communications in Statistics - Theory and Methods 46 (1):296–318. doi:10.1080/03610926.2014.990758.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mtaregime">mtaregime</a></code>,
<code><a href="#topic+mtarinipars">mtarinipars</a></code>,
<code><a href="#topic+mtarsim">mtarsim</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("datasim")
yt = datasim$Sim
Yt = yt$Yt
Zt = yt$Zt
(datos = tsregime(Yt,Zt))
autoplot.tsregime(datos,1)
autoplot.tsregime(datos,2)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
