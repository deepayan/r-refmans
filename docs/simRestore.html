<!DOCTYPE html><html><head><title>Help for package simRestore</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {simRestore}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#default_params_doc'><p>Default parameter documentation</p></a></li>
<li><a href='#optimize_adaptive'><p>Optimize a policy assuming a fixed total sum across all generations of</p>
individuals that can be put or pulled (e.g. a fixed effort). This fixed total
sum is distributed across the generations following a beta distribution, and
the parameters of this beta distribution are fitted.</a></li>
<li><a href='#optimize_static'><p>Optimize putting and/or pulling, where it is assumed that the same amount</p>
is applied per generation.</a></li>
<li><a href='#run_shiny_app'><p>runs shiny app locally</p></a></li>
<li><a href='#simulate_policy'><p>Simulate the effect of a restoration policy over time.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Simulate the Effect of Management Policies on Restoration
Efforts</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.4</td>
</tr>
<tr>
<td>Description:</td>
<td>Simulation methods to study the effect of management policies on
    efforts to restore populations back to their original genetic composition.
    Allows for single-scenario simulation and for optimization of specific chosen
    scenarios. Further information can be found in Hernandez, Janzen and Lavretsky 
    (2023) &lt;<a href="https://doi.org/10.1111%2F1755-0998.13892">doi:10.1111/1755-0998.13892</a>&gt;. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp, shiny, subplex, tibble</td>
</tr>
<tr>
<td>Suggests:</td>
<td>dplyr, ggplot2, knitr, magrittr, rmarkdown, shinyBS,
shinythemes, shinyWidgets, testthat, tidyr, egg</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-11-16 19:05:55 UTC; thijsjanzen</td>
</tr>
<tr>
<td>Author:</td>
<td>Thijs Janzen [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Thijs Janzen &lt;thijsjanzen@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-11-17 09:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='default_params_doc'>Default parameter documentation</h2><span id='topic+default_params_doc'></span>

<h3>Description</h3>

<p>Default parameter documentation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>default_params_doc(
  initial_population_size = 400,
  reproduction_success_rate = 0.387,
  reproductive_risk = c(0.2, 0),
  K = 400,
  num_generations = 20,
  pull = 0,
  put = 0,
  starting_freq = 0.5,
  sd_starting_freq = 0.05,
  morgan = c(1),
  establishment_burnin = 30,
  num_replicates = 1,
  seed = NULL,
  max_age = 6,
  mean_number_of_offspring = 6,
  sd_number_of_offspring = 1,
  smin = 0.5,
  smax = 0.9,
  b = -2,
  p = 0.5,
  genetic_model = "point",
  sex_ratio_put = 0.5,
  sex_ratio_pull = 0.5,
  sex_ratio_offspring = 0.5,
  ancestry_put = 1,
  ancestry_pull = 1,
  return_genetics = FALSE,
  random_mating = FALSE,
  extra_pair_copulation = 0,
  use_simplified_model = TRUE,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="default_params_doc_+3A_initial_population_size">initial_population_size</code></td>
<td>
<p>population size at the start</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_reproduction_success_rate">reproduction_success_rate</code></td>
<td>
<p>frequency of females that yield offspring
at the end of the breeding season (e.g. a fraction of
1 - reproduction_success_rate of females. This is a joint effect of
breeding females getting killed
(see <code>female_death_rate</code>) and other sources of failure to produce
offspring. Other sources of failure are calculated from
reproduction_success_rate and female_death_rate, such that the resulting
reproduction failure rate = 1 - reproduction_success_rate /
(1 - female breeding risk)</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_reproductive_risk">reproductive_risk</code></td>
<td>
<p>Additional death rate of males and females as a
result of breeding (e.g. as a result of protecting the offspring against
predators). Provide as a vector where the first index indicates the risk for
females, the second the risk for males.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_k">K</code></td>
<td>
<p>carrying capacity</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_num_generations">num_generations</code></td>
<td>
<p>number of generations</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_pull">pull</code></td>
<td>
<p>vector of the number of individuals pulled per year</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_put">put</code></td>
<td>
<p>vector of the number of individuals added per year</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_starting_freq">starting_freq</code></td>
<td>
<p>initial frequency of target ancestry in the population.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_sd_starting_freq">sd_starting_freq</code></td>
<td>
<p>variation in initial frequency of target ancestry.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_morgan">morgan</code></td>
<td>
<p>a vector with the size of each chromosome in morgan, e.g. if
a single chromosome is to be simulated a single number will suffice, but
for two chromosomes of a size of 1 Morgan, a vector like: c(1, 1) will work.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_establishment_burnin">establishment_burnin</code></td>
<td>
<p>number of generations before establishment</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_num_replicates">num_replicates</code></td>
<td>
<p>number of replicates</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_seed">seed</code></td>
<td>
<p>random number seed, if left open, current time is used.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_max_age">max_age</code></td>
<td>
<p>maximum age an individual can reach.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_mean_number_of_offspring">mean_number_of_offspring</code></td>
<td>
<p>mean number of offspring per female</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_sd_number_of_offspring">sd_number_of_offspring</code></td>
<td>
<p>standard deviation of number of offspring per
female (assuming the number of offspring is always 0 or larger).</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_smin">smin</code></td>
<td>
<p>minimum survival rate</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_smax">smax</code></td>
<td>
<p>maximum survival rate</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_b">b</code></td>
<td>
<p>steepness of the survival rate. Negative values indicate a declining
survival rate with increasing population size, positive values indicate an
increasing survival rate with increasing population size.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_p">p</code></td>
<td>
<p>Density at which the survival rate changes most relative. Expressed
in N / K (e.g., for a value of 1.0, the survival rate changes most rapidly
around N = K, for a value of 0.5, the survival rate changes most rapidly
around N = 0.5K, etc).</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_genetic_model">genetic_model</code></td>
<td>
<p>The model can either use the point ancestry model
(&quot;point&quot;) of underlying genetics, which speeds up simulation
considerably, but underestimates genetic variation. Alternatively, a more
detailed genetic model is available, making use of the theory of junctions,
this can be accessed using the option &quot;junctions&quot;. Default is &quot;point&quot;.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_sex_ratio_put">sex_ratio_put</code></td>
<td>
<p>sex ratio of individuals that are added (if any) to
the population. Sex ratio is expressed as males / (males + females), such
that 0.5 indicates an even sex ratio, 0.9 indicates a male biased sex ratio
and 0.1 indicates a female biased sex ratio.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_sex_ratio_pull">sex_ratio_pull</code></td>
<td>
<p>sex ratio of individuals that are removed (if any) from
the population. The sex ratio
is expressed as males / (males + females), such
that 0.5 indicates an even sex ratio, 0.9 indicates a male biased sex ratio
and 0.1 indicates a female biased sex ratio.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_sex_ratio_offspring">sex_ratio_offspring</code></td>
<td>
<p>sex ratio of newly born offspring. The sex ratio
is expressed as males / (males + females), such
that 0.5 indicates an even sex ratio, 0.9 indicates a male biased sex ratio
and 0.1 indicates a female biased sex ratio.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_ancestry_put">ancestry_put</code></td>
<td>
<p>Average ancestry of individuals being used for
supplementation. If the target is high focal ancestry (e.g. aiming for
focal ancestry of 1.0), ancestry put should reflect this and be set to 1.0 (
which is the default value). When supplementing with non-pure individuals,
this value can consequently be lowered.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_ancestry_pull">ancestry_pull</code></td>
<td>
<p>Ancestry level below which individuals are allowed to
be pulled - this can reduce the effective number of individuals pulled if
none of the individuals in the population match this ancestry level. This can
be used to selectively only remove those with low target ancestry.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_return_genetics">return_genetics</code></td>
<td>
<p>returns a tibble containing all local ancestry
information for all individuals. This tibble contains the following
informative columns: 1) time (the last generation), 2) replicate,
3) individual, 4) sex (0 = male, 1 = female), 5) Linkage Group
(if use_simplified_model == FALSE), 6) chromosome (1 or 2,
returning phased results), 7) position (if use_simplified_model == FALSE) and
8) local ancestry (0 or 1).</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_random_mating">random_mating</code></td>
<td>
<p>by default, simulations assume fixed pair bonding, e.g.
each female mates with exactly one male (if available). Alternatively, if
random_mating = TRUE, females will mate with a random male, introducing the
possibility that some males mate multiple times.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_extra_pair_copulation">extra_pair_copulation</code></td>
<td>
<p>probability of offspring to be fathered by
another male. We assume that all offspring from one mother can have at most
two fathers.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_verbose">verbose</code></td>
<td>
<p>provides verbose output if TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing
</p>

<hr>
<h2 id='optimize_adaptive'>Optimize a policy assuming a fixed total sum across all generations of
individuals that can be put or pulled (e.g. a fixed effort). This fixed total
sum is distributed across the generations following a beta distribution, and
the parameters of this beta distribution are fitted.</h2><span id='topic+optimize_adaptive'></span>

<h3>Description</h3>

<p>Optimize a policy assuming a fixed total sum across all generations of
individuals that can be put or pulled (e.g. a fixed effort). This fixed total
sum is distributed across the generations following a beta distribution, and
the parameters of this beta distribution are fitted.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>optimize_adaptive(
  target_frequency = 0.99,
  initial_population_size = 400,
  reproduction_success_rate = 0.387,
  reproductive_risk = c(0.2, 0),
  K = 400,
  num_generations = 20,
  optimize_put = 100,
  optimize_pull = 0,
  starting_freq = 0.2,
  sd_starting_freq = 0.05,
  morgan = c(1),
  establishment_burnin = 30,
  num_replicates = 1,
  max_age = 6,
  mean_number_of_offspring = 6,
  sd_number_of_offspring = 1,
  genetic_model = "point",
  smin = 0.5,
  smax = 0.9,
  b = -2,
  p = 0.5,
  sex_ratio_put = 0.5,
  sex_ratio_pull = 0.5,
  sex_ratio_offspring = 0.5,
  ancestry_put = 1,
  ancestry_pull = 1,
  random_mating = FALSE,
  extra_pair_copulation = 0,
  verbose = FALSE,
  return_genetics = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="optimize_adaptive_+3A_target_frequency">target_frequency</code></td>
<td>
<p>frequency to aim for</p>
</td></tr>
<tr><td><code id="optimize_adaptive_+3A_initial_population_size">initial_population_size</code></td>
<td>
<p>population size at the start</p>
</td></tr>
<tr><td><code id="optimize_adaptive_+3A_reproduction_success_rate">reproduction_success_rate</code></td>
<td>
<p>frequency of females that yield offspring
at the end of the breeding season (e.g. a fraction of
1 - reproduction_success_rate of females. This is a joint effect of
breeding females getting killed
(see <code>female_death_rate</code>) and other sources of failure to produce
offspring. Other sources of failure are calculated from
reproduction_success_rate and female_death_rate, such that the resulting
reproduction failure rate = 1 - reproduction_success_rate /
(1 - female breeding risk)</p>
</td></tr>
<tr><td><code id="optimize_adaptive_+3A_reproductive_risk">reproductive_risk</code></td>
<td>
<p>Additional death rate of males and females as a
result of breeding (e.g. as a result of protecting the offspring against
predators). Provide as a vector where the first index indicates the risk for
females, the second the risk for males.</p>
</td></tr>
<tr><td><code id="optimize_adaptive_+3A_k">K</code></td>
<td>
<p>carrying capacity</p>
</td></tr>
<tr><td><code id="optimize_adaptive_+3A_num_generations">num_generations</code></td>
<td>
<p>number of generations</p>
</td></tr>
<tr><td><code id="optimize_adaptive_+3A_optimize_put">optimize_put</code></td>
<td>
<p>optimization proceeds such that the sum of all
addition over all generations is equal to this number. Switch off by setting
to zero. The individuals are distributed over time following a beta
distribution.</p>
</td></tr>
<tr><td><code id="optimize_adaptive_+3A_optimize_pull">optimize_pull</code></td>
<td>
<p>Optimization proceeds such that the sum of all
removal is equal to this number. Switch off by setting to zero.</p>
</td></tr>
<tr><td><code id="optimize_adaptive_+3A_starting_freq">starting_freq</code></td>
<td>
<p>initial frequency of target ancestry in the population.</p>
</td></tr>
<tr><td><code id="optimize_adaptive_+3A_sd_starting_freq">sd_starting_freq</code></td>
<td>
<p>variation in initial frequency of target ancestry.</p>
</td></tr>
<tr><td><code id="optimize_adaptive_+3A_morgan">morgan</code></td>
<td>
<p>a vector with the size of each chromosome in morgan, e.g. if
a single chromosome is to be simulated a single number will suffice, but
for two chromosomes of a size of 1 Morgan, a vector like: c(1, 1) will work.</p>
</td></tr>
<tr><td><code id="optimize_adaptive_+3A_establishment_burnin">establishment_burnin</code></td>
<td>
<p>number of generations before establishment</p>
</td></tr>
<tr><td><code id="optimize_adaptive_+3A_num_replicates">num_replicates</code></td>
<td>
<p>number of replicates per parameter combination to be
simulated. Fit of the parameter combination is chosen as the average
frequency across replicates.</p>
</td></tr>
<tr><td><code id="optimize_adaptive_+3A_max_age">max_age</code></td>
<td>
<p>maximum age an individual can reach.</p>
</td></tr>
<tr><td><code id="optimize_adaptive_+3A_mean_number_of_offspring">mean_number_of_offspring</code></td>
<td>
<p>mean number of offspring per female</p>
</td></tr>
<tr><td><code id="optimize_adaptive_+3A_sd_number_of_offspring">sd_number_of_offspring</code></td>
<td>
<p>standard deviation of number of offspring per
female (assuming the number of offspring is always 0 or larger).</p>
</td></tr>
<tr><td><code id="optimize_adaptive_+3A_genetic_model">genetic_model</code></td>
<td>
<p>The model can either use the point ancestry model
(&quot;point&quot;) of underlying genetics, which speeds up simulation
considerably, but underestimates genetic variation. Alternatively, a more
detailed genetic model is available, making use of the theory of junctions,
this can be accessed using the option &quot;junctions&quot;. Default is &quot;point&quot;.</p>
</td></tr>
<tr><td><code id="optimize_adaptive_+3A_smin">smin</code></td>
<td>
<p>minimum survival rate</p>
</td></tr>
<tr><td><code id="optimize_adaptive_+3A_smax">smax</code></td>
<td>
<p>maximum survival rate</p>
</td></tr>
<tr><td><code id="optimize_adaptive_+3A_b">b</code></td>
<td>
<p>steepness of the survival rate. Negative values indicate a declining
survival rate with increasing population size, positive values indicate an
increasing survival rate with increasing population size.</p>
</td></tr>
<tr><td><code id="optimize_adaptive_+3A_p">p</code></td>
<td>
<p>Density at which the survival rate changes most relative. Expressed
in N / K (e.g., for a value of 1.0, the survival rate changes most rapidly
around N = K, for a value of 0.5, the survival rate changes most rapidly
around N = 0.5K, etc).</p>
</td></tr>
<tr><td><code id="optimize_adaptive_+3A_sex_ratio_put">sex_ratio_put</code></td>
<td>
<p>sex ratio of individuals that are added (if any) to
the population. Sex ratio is expressed as males / (males + females), such
that 0.5 indicates an even sex ratio, 0.9 indicates a male biased sex ratio
and 0.1 indicates a female biased sex ratio.</p>
</td></tr>
<tr><td><code id="optimize_adaptive_+3A_sex_ratio_pull">sex_ratio_pull</code></td>
<td>
<p>sex ratio of individuals that are removed (if any) from
the population. The sex ratio
is expressed as males / (males + females), such
that 0.5 indicates an even sex ratio, 0.9 indicates a male biased sex ratio
and 0.1 indicates a female biased sex ratio.</p>
</td></tr>
<tr><td><code id="optimize_adaptive_+3A_sex_ratio_offspring">sex_ratio_offspring</code></td>
<td>
<p>sex ratio of newly born offspring. The sex ratio
is expressed as males / (males + females), such
that 0.5 indicates an even sex ratio, 0.9 indicates a male biased sex ratio
and 0.1 indicates a female biased sex ratio.</p>
</td></tr>
<tr><td><code id="optimize_adaptive_+3A_ancestry_put">ancestry_put</code></td>
<td>
<p>Average ancestry of individuals being used for
supplementation. If the target is high focal ancestry (e.g. aiming for
focal ancestry of 1.0), ancestry put should reflect this and be set to 1.0 (
which is the default value). When supplementing with non-pure individuals,
this value can consequently be lowered.</p>
</td></tr>
<tr><td><code id="optimize_adaptive_+3A_ancestry_pull">ancestry_pull</code></td>
<td>
<p>Ancestry level below which individuals are allowed to
be pulled - this can reduce the effective number of individuals pulled if
none of the individuals in the population match this ancestry level. This can
be used to selectively only remove those with low target ancestry.</p>
</td></tr>
<tr><td><code id="optimize_adaptive_+3A_random_mating">random_mating</code></td>
<td>
<p>by default, simulations assume fixed pair bonding, e.g.
each female mates with exactly one male (if available). Alternatively, if
random_mating = TRUE, females will mate with a random male, introducing the
possibility that some males mate multiple times.</p>
</td></tr>
<tr><td><code id="optimize_adaptive_+3A_extra_pair_copulation">extra_pair_copulation</code></td>
<td>
<p>probability of offspring to be fathered by
another male. We assume that all offspring from one mother can have at most
two fathers.</p>
</td></tr>
<tr><td><code id="optimize_adaptive_+3A_verbose">verbose</code></td>
<td>
<p>provides verbose output if TRUE.</p>
</td></tr>
<tr><td><code id="optimize_adaptive_+3A_return_genetics">return_genetics</code></td>
<td>
<p>returns a tibble containing all local ancestry
information for all individuals. This tibble contains the following
informative columns: 1) time (the last generation), 2) replicate,
3) individual, 4) sex (0 = male, 1 = female), 5) Linkage Group
(if use_simplified_model == FALSE), 6) chromosome (1 or 2,
returning phased results), 7) position (if use_simplified_model == FALSE) and
8) local ancestry (0 or 1).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list with five elements: 1) put: optimal number of individuals to
put (0 if not estimated), 2) pull: optimal number of individuals to pull
(0 if not estimated), 3) results tibble
(see <code><a href="#topic+simulate_policy">simulate_policy</a>()</code>), 4) curve tibble with three columns,
indicating the realized number of put/pull per generation, with column 1)
time in generations, column 2) number of individuals to put in generation t
and 3) number of individuals to pull in generation t. The last element of
the list contains the final obtained frequency for the best fit.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>opt_res &lt;- optimize_adaptive(target_frequency = 0.99,
                             optimize_put = 1000,
                             num_generations = 20,
                             starting_freq = 0.2,
                             initial_population_size = 100)
opt_res$put
</code></pre>

<hr>
<h2 id='optimize_static'>Optimize putting and/or pulling, where it is assumed that the same amount
is applied per generation.</h2><span id='topic+optimize_static'></span>

<h3>Description</h3>

<p>Optimize putting and/or pulling, where it is assumed that the same amount
is applied per generation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>optimize_static(
  target_frequency = 0.99,
  initial_population_size = 400,
  reproduction_success_rate = 0.387,
  reproductive_risk = c(0.2, 0),
  K = 400,
  num_generations = 20,
  optimize_put = TRUE,
  optimize_pull = FALSE,
  starting_freq = 0.2,
  sd_starting_freq = 0.05,
  morgan = c(1),
  establishment_burnin = 30,
  num_replicates = 1,
  max_age = 6,
  mean_number_of_offspring = 6,
  sd_number_of_offspring = 1,
  genetic_model = "point",
  smin = 0.5,
  smax = 0.9,
  b = -2,
  p = 0.5,
  sex_ratio_put = 0.5,
  sex_ratio_pull = 0.5,
  sex_ratio_offspring = 0.5,
  ancestry_put = 1,
  ancestry_pull = 1,
  random_mating = FALSE,
  extra_pair_copulation = 0,
  verbose = FALSE,
  return_genetics = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="optimize_static_+3A_target_frequency">target_frequency</code></td>
<td>
<p>frequency to aim for</p>
</td></tr>
<tr><td><code id="optimize_static_+3A_initial_population_size">initial_population_size</code></td>
<td>
<p>population size at the start</p>
</td></tr>
<tr><td><code id="optimize_static_+3A_reproduction_success_rate">reproduction_success_rate</code></td>
<td>
<p>frequency of females that yield offspring
at the end of the breeding season (e.g. a fraction of
1 - reproduction_success_rate of females. This is a joint effect of
breeding females getting killed
(see <code>female_death_rate</code>) and other sources of failure to produce
offspring. Other sources of failure are calculated from
reproduction_success_rate and female_death_rate, such that the resulting
reproduction failure rate = 1 - reproduction_success_rate /
(1 - female breeding risk)</p>
</td></tr>
<tr><td><code id="optimize_static_+3A_reproductive_risk">reproductive_risk</code></td>
<td>
<p>Additional death rate of males and females as a
result of breeding (e.g. as a result of protecting the offspring against
predators). Provide as a vector where the first index indicates the risk for
females, the second the risk for males.</p>
</td></tr>
<tr><td><code id="optimize_static_+3A_k">K</code></td>
<td>
<p>carrying capacity</p>
</td></tr>
<tr><td><code id="optimize_static_+3A_num_generations">num_generations</code></td>
<td>
<p>number of generations</p>
</td></tr>
<tr><td><code id="optimize_static_+3A_optimize_put">optimize_put</code></td>
<td>
<p>When set to 0, FALSE or a negative number, it will not
be optimized. When negative, the absolute value will be taken as a fixed
contribution to each generation (but will not be optimized)</p>
</td></tr>
<tr><td><code id="optimize_static_+3A_optimize_pull">optimize_pull</code></td>
<td>
<p>When set to 0, FALSE or a negative number, it will not
be optimized. When negative, the absolute value will be taken as a fixed
contribution to each generation (but will not be optimized)</p>
</td></tr>
<tr><td><code id="optimize_static_+3A_starting_freq">starting_freq</code></td>
<td>
<p>initial frequency of target ancestry in the population.</p>
</td></tr>
<tr><td><code id="optimize_static_+3A_sd_starting_freq">sd_starting_freq</code></td>
<td>
<p>variation in initial frequency of target ancestry.</p>
</td></tr>
<tr><td><code id="optimize_static_+3A_morgan">morgan</code></td>
<td>
<p>a vector with the size of each chromosome in morgan, e.g. if
a single chromosome is to be simulated a single number will suffice, but
for two chromosomes of a size of 1 Morgan, a vector like: c(1, 1) will work.</p>
</td></tr>
<tr><td><code id="optimize_static_+3A_establishment_burnin">establishment_burnin</code></td>
<td>
<p>number of generations before establishment</p>
</td></tr>
<tr><td><code id="optimize_static_+3A_num_replicates">num_replicates</code></td>
<td>
<p>number of replicates</p>
</td></tr>
<tr><td><code id="optimize_static_+3A_max_age">max_age</code></td>
<td>
<p>maximum age an individual can reach.</p>
</td></tr>
<tr><td><code id="optimize_static_+3A_mean_number_of_offspring">mean_number_of_offspring</code></td>
<td>
<p>mean number of offspring per female</p>
</td></tr>
<tr><td><code id="optimize_static_+3A_sd_number_of_offspring">sd_number_of_offspring</code></td>
<td>
<p>standard deviation of number of offspring per
female (assuming the number of offspring is always 0 or larger).</p>
</td></tr>
<tr><td><code id="optimize_static_+3A_genetic_model">genetic_model</code></td>
<td>
<p>The model can either use the point ancestry model
(&quot;point&quot;) of underlying genetics, which speeds up simulation
considerably, but underestimates genetic variation. Alternatively, a more
detailed genetic model is available, making use of the theory of junctions,
this can be accessed using the option &quot;junctions&quot;. Default is &quot;point&quot;.</p>
</td></tr>
<tr><td><code id="optimize_static_+3A_smin">smin</code></td>
<td>
<p>minimum survival rate</p>
</td></tr>
<tr><td><code id="optimize_static_+3A_smax">smax</code></td>
<td>
<p>maximum survival rate</p>
</td></tr>
<tr><td><code id="optimize_static_+3A_b">b</code></td>
<td>
<p>steepness of the survival rate. Negative values indicate a declining
survival rate with increasing population size, positive values indicate an
increasing survival rate with increasing population size.</p>
</td></tr>
<tr><td><code id="optimize_static_+3A_p">p</code></td>
<td>
<p>Density at which the survival rate changes most relative. Expressed
in N / K (e.g., for a value of 1.0, the survival rate changes most rapidly
around N = K, for a value of 0.5, the survival rate changes most rapidly
around N = 0.5K, etc).</p>
</td></tr>
<tr><td><code id="optimize_static_+3A_sex_ratio_put">sex_ratio_put</code></td>
<td>
<p>sex ratio of individuals that are added (if any) to
the population. Sex ratio is expressed as males / (males + females), such
that 0.5 indicates an even sex ratio, 0.9 indicates a male biased sex ratio
and 0.1 indicates a female biased sex ratio.</p>
</td></tr>
<tr><td><code id="optimize_static_+3A_sex_ratio_pull">sex_ratio_pull</code></td>
<td>
<p>sex ratio of individuals that are removed (if any) from
the population. The sex ratio
is expressed as males / (males + females), such
that 0.5 indicates an even sex ratio, 0.9 indicates a male biased sex ratio
and 0.1 indicates a female biased sex ratio.</p>
</td></tr>
<tr><td><code id="optimize_static_+3A_sex_ratio_offspring">sex_ratio_offspring</code></td>
<td>
<p>sex ratio of newly born offspring. The sex ratio
is expressed as males / (males + females), such
that 0.5 indicates an even sex ratio, 0.9 indicates a male biased sex ratio
and 0.1 indicates a female biased sex ratio.</p>
</td></tr>
<tr><td><code id="optimize_static_+3A_ancestry_put">ancestry_put</code></td>
<td>
<p>Average ancestry of individuals being used for
supplementation. If the target is high focal ancestry (e.g. aiming for
focal ancestry of 1.0), ancestry put should reflect this and be set to 1.0 (
which is the default value). When supplementing with non-pure individuals,
this value can consequently be lowered.</p>
</td></tr>
<tr><td><code id="optimize_static_+3A_ancestry_pull">ancestry_pull</code></td>
<td>
<p>Ancestry level below which individuals are allowed to
be pulled - this can reduce the effective number of individuals pulled if
none of the individuals in the population match this ancestry level. This can
be used to selectively only remove those with low target ancestry.</p>
</td></tr>
<tr><td><code id="optimize_static_+3A_random_mating">random_mating</code></td>
<td>
<p>by default, simulations assume fixed pair bonding, e.g.
each female mates with exactly one male (if available). Alternatively, if
random_mating = TRUE, females will mate with a random male, introducing the
possibility that some males mate multiple times.</p>
</td></tr>
<tr><td><code id="optimize_static_+3A_extra_pair_copulation">extra_pair_copulation</code></td>
<td>
<p>probability of offspring to be fathered by
another male. We assume that all offspring from one mother can have at most
two fathers.</p>
</td></tr>
<tr><td><code id="optimize_static_+3A_verbose">verbose</code></td>
<td>
<p>provides verbose output if TRUE.</p>
</td></tr>
<tr><td><code id="optimize_static_+3A_return_genetics">return_genetics</code></td>
<td>
<p>returns a tibble containing all local ancestry
information for all individuals. This tibble contains the following
informative columns: 1) time (the last generation), 2) replicate,
3) individual, 4) sex (0 = male, 1 = female), 5) Linkage Group
(if use_simplified_model == FALSE), 6) chromosome (1 or 2,
returning phased results), 7) position (if use_simplified_model == FALSE) and
8) local ancestry (0 or 1).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list with five elements: 1) put: optimal number of individuals to
put (0 if not estimated), 2) pull: optimal number of individuals to pull
(0 if not estimated), 3) results tibble
(see <code><a href="#topic+simulate_policy">simulate_policy</a>()</code>), 4) curve tibble with three columns,
indicating the realized number of put/pull per generation, with column 1)
time in generations, column 2) number of individuals to put in generation t
and 3) number of individuals to pull in generation t. The last element of
the list contains the final obtained frequency for the best fit.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>opt_res &lt;- optimize_static(target_frequency = 0.99,
                           optimize_put = TRUE,
                           num_generations = 10,
                           starting_freq = 0.2,
                           initial_population_size = 100)
opt_res$put
</code></pre>

<hr>
<h2 id='run_shiny_app'>runs shiny app locally</h2><span id='topic+run_shiny_app'></span>

<h3>Description</h3>

<p>This function allows for local execution of the shiny app. Alternatively,
an online version of this app
<a href="https://thijsjanzen.shinyapps.io/simRestoreApp/">can be found here</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>run_shiny_app()
</code></pre>


<h3>Value</h3>

<p>No return value
</p>

<hr>
<h2 id='simulate_policy'>Simulate the effect of a restoration policy over time.</h2><span id='topic+simulate_policy'></span>

<h3>Description</h3>

<p>Using this function, the user can simulate the effect of an
intended management policy on the genetic composition of a focal population.
The population is assumed to have overlapping generations, and the user can
specify two genetic models, either using a simplified average ancestry
representation (genetic_model = &quot;point&quot;), or a more detailed model
tracking explicit recombination among chromosomes, using genetic_model =
&quot;junctions&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulate_policy(
  initial_population_size = 400,
  reproduction_success_rate = 0.387,
  reproductive_risk = c(0.2, 0),
  K = 400,
  num_generations = 20,
  pull = 0,
  put = 0,
  starting_freq = 0.5,
  sd_starting_freq = 0.05,
  morgan = c(1),
  max_age = 6,
  mean_number_of_offspring = 6,
  sd_number_of_offspring = 1,
  genetic_model = "point",
  establishment_burnin = 30,
  num_replicates = 1,
  seed = NULL,
  smin = 0.5,
  smax = 0.9,
  b = -2,
  p = 0.5,
  sex_ratio_put = 0.5,
  sex_ratio_pull = 0.5,
  sex_ratio_offspring = 0.5,
  ancestry_put = 1,
  ancestry_pull = 1,
  random_mating = FALSE,
  extra_pair_copulation = 0,
  verbose = FALSE,
  return_genetics = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simulate_policy_+3A_initial_population_size">initial_population_size</code></td>
<td>
<p>population size at the start</p>
</td></tr>
<tr><td><code id="simulate_policy_+3A_reproduction_success_rate">reproduction_success_rate</code></td>
<td>
<p>frequency of females that yield offspring
at the end of the breeding season (e.g. a fraction of
1 - reproduction_success_rate of females. This is a joint effect of
breeding females getting killed
(see <code>female_death_rate</code>) and other sources of failure to produce
offspring. Other sources of failure are calculated from
reproduction_success_rate and female_death_rate, such that the resulting
reproduction failure rate = 1 - reproduction_success_rate /
(1 - female breeding risk)</p>
</td></tr>
<tr><td><code id="simulate_policy_+3A_reproductive_risk">reproductive_risk</code></td>
<td>
<p>Additional death rate of males and females as a
result of breeding (e.g. as a result of protecting the offspring against
predators). Provide as a vector where the first index indicates the risk for
females, the second the risk for males.</p>
</td></tr>
<tr><td><code id="simulate_policy_+3A_k">K</code></td>
<td>
<p>carrying capacity</p>
</td></tr>
<tr><td><code id="simulate_policy_+3A_num_generations">num_generations</code></td>
<td>
<p>number of generations</p>
</td></tr>
<tr><td><code id="simulate_policy_+3A_pull">pull</code></td>
<td>
<p>vector of the number of individuals pulled per year</p>
</td></tr>
<tr><td><code id="simulate_policy_+3A_put">put</code></td>
<td>
<p>vector of the number of individuals added per year</p>
</td></tr>
<tr><td><code id="simulate_policy_+3A_starting_freq">starting_freq</code></td>
<td>
<p>initial frequency of target ancestry in the population.</p>
</td></tr>
<tr><td><code id="simulate_policy_+3A_sd_starting_freq">sd_starting_freq</code></td>
<td>
<p>variation in initial frequency of target ancestry.</p>
</td></tr>
<tr><td><code id="simulate_policy_+3A_morgan">morgan</code></td>
<td>
<p>a vector with the size of each chromosome in morgan, e.g. if
a single chromosome is to be simulated a single number will suffice, but
for two chromosomes of a size of 1 Morgan, a vector like: c(1, 1) will work.</p>
</td></tr>
<tr><td><code id="simulate_policy_+3A_max_age">max_age</code></td>
<td>
<p>maximum age an individual can reach.</p>
</td></tr>
<tr><td><code id="simulate_policy_+3A_mean_number_of_offspring">mean_number_of_offspring</code></td>
<td>
<p>mean number of offspring per female</p>
</td></tr>
<tr><td><code id="simulate_policy_+3A_sd_number_of_offspring">sd_number_of_offspring</code></td>
<td>
<p>standard deviation of number of offspring per
female (assuming the number of offspring is always 0 or larger).</p>
</td></tr>
<tr><td><code id="simulate_policy_+3A_genetic_model">genetic_model</code></td>
<td>
<p>The model can either use the point ancestry model
(&quot;point&quot;) of underlying genetics, which speeds up simulation
considerably, but underestimates genetic variation. Alternatively, a more
detailed genetic model is available, making use of the theory of junctions,
this can be accessed using the option &quot;junctions&quot;. Default is &quot;point&quot;.</p>
</td></tr>
<tr><td><code id="simulate_policy_+3A_establishment_burnin">establishment_burnin</code></td>
<td>
<p>number of generations before establishment</p>
</td></tr>
<tr><td><code id="simulate_policy_+3A_num_replicates">num_replicates</code></td>
<td>
<p>number of replicates</p>
</td></tr>
<tr><td><code id="simulate_policy_+3A_seed">seed</code></td>
<td>
<p>random number seed, if left open, current time is used.</p>
</td></tr>
<tr><td><code id="simulate_policy_+3A_smin">smin</code></td>
<td>
<p>minimum survival rate</p>
</td></tr>
<tr><td><code id="simulate_policy_+3A_smax">smax</code></td>
<td>
<p>maximum survival rate</p>
</td></tr>
<tr><td><code id="simulate_policy_+3A_b">b</code></td>
<td>
<p>steepness of the survival rate. Negative values indicate a declining
survival rate with increasing population size, positive values indicate an
increasing survival rate with increasing population size.</p>
</td></tr>
<tr><td><code id="simulate_policy_+3A_p">p</code></td>
<td>
<p>Density at which the survival rate changes most relative. Expressed
in N / K (e.g., for a value of 1.0, the survival rate changes most rapidly
around N = K, for a value of 0.5, the survival rate changes most rapidly
around N = 0.5K, etc).</p>
</td></tr>
<tr><td><code id="simulate_policy_+3A_sex_ratio_put">sex_ratio_put</code></td>
<td>
<p>sex ratio of individuals that are added (if any) to
the population. Sex ratio is expressed as males / (males + females), such
that 0.5 indicates an even sex ratio, 0.9 indicates a male biased sex ratio
and 0.1 indicates a female biased sex ratio.</p>
</td></tr>
<tr><td><code id="simulate_policy_+3A_sex_ratio_pull">sex_ratio_pull</code></td>
<td>
<p>sex ratio of individuals that are removed (if any) from
the population. The sex ratio
is expressed as males / (males + females), such
that 0.5 indicates an even sex ratio, 0.9 indicates a male biased sex ratio
and 0.1 indicates a female biased sex ratio.</p>
</td></tr>
<tr><td><code id="simulate_policy_+3A_sex_ratio_offspring">sex_ratio_offspring</code></td>
<td>
<p>sex ratio of newly born offspring. The sex ratio
is expressed as males / (males + females), such
that 0.5 indicates an even sex ratio, 0.9 indicates a male biased sex ratio
and 0.1 indicates a female biased sex ratio.</p>
</td></tr>
<tr><td><code id="simulate_policy_+3A_ancestry_put">ancestry_put</code></td>
<td>
<p>Average ancestry of individuals being used for
supplementation. If the target is high focal ancestry (e.g. aiming for
focal ancestry of 1.0), ancestry put should reflect this and be set to 1.0 (
which is the default value). When supplementing with non-pure individuals,
this value can consequently be lowered.</p>
</td></tr>
<tr><td><code id="simulate_policy_+3A_ancestry_pull">ancestry_pull</code></td>
<td>
<p>Ancestry level below which individuals are allowed to
be pulled - this can reduce the effective number of individuals pulled if
none of the individuals in the population match this ancestry level. This can
be used to selectively only remove those with low target ancestry.</p>
</td></tr>
<tr><td><code id="simulate_policy_+3A_random_mating">random_mating</code></td>
<td>
<p>by default, simulations assume fixed pair bonding, e.g.
each female mates with exactly one male (if available). Alternatively, if
random_mating = TRUE, females will mate with a random male, introducing the
possibility that some males mate multiple times.</p>
</td></tr>
<tr><td><code id="simulate_policy_+3A_extra_pair_copulation">extra_pair_copulation</code></td>
<td>
<p>probability of offspring to be fathered by
another male. We assume that all offspring from one mother can have at most
two fathers.</p>
</td></tr>
<tr><td><code id="simulate_policy_+3A_verbose">verbose</code></td>
<td>
<p>provides verbose output if TRUE.</p>
</td></tr>
<tr><td><code id="simulate_policy_+3A_return_genetics">return_genetics</code></td>
<td>
<p>returns a tibble containing all local ancestry
information for all individuals. This tibble contains the following
informative columns: 1) time (the last generation), 2) replicate,
3) individual, 4) sex (0 = male, 1 = female), 5) Linkage Group
(if use_simplified_model == FALSE), 6) chromosome (1 or 2,
returning phased results), 7) position (if use_simplified_model == FALSE) and
8) local ancestry (0 or 1).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>tibble with 8 columns: 1) replicate, 2) time (in generations), 3)
average frequency of ancestry across all individuals 4) average frequency
of ancestry across all males, 5) average frequency of ancestry across all
females, 6) number of individuals, 7) number of males and 8) number of
females
if return_genetics = TRUE, the output is a list containing the above
mentioned tibble, called 'results', and a second tibble called 'genetics',
with the local ancestry in long format, split out per generation, replicate,
individual, sex, linkage group and chromosome (1 or 2). Here, linkage group
indicates the focal chromosome (linkage group), and 'chromosome' indicates
which of the diploid pair of chromosomes is measured, allowing for phased
output if required.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sim_pop &lt;- simulate_policy(initial_population_size = 100,
                           num_generations = 20,
                           starting_freq = 0.2,
                           K = 400)
plot(sim_pop$results$num_individuals ~ sim_pop$results$t)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
