<!DOCTYPE html><html><head><title>Help for package gIPFrm</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {gIPFrm}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bisection.update'>
<p>Search for the adjustment factor corresponding to the MLE using</p>
the bisection method</a></li>
<li><a href='#g.ipf'>
<p>Generalized Iterative Proportional Fitting for Relational Models</p></a></li>
<li><a href='#gIPFrm-package'>
<p>Generalized Iterative Proportional Fitting for Relational Models</p></a></li>
<li><a href='#grid.update'>
<p>Search for the adjustment factor corresponding to the MLE using a grid</p></a></li>
<li><a href='#ipf.gamma'>
<p>Iterative Proportional Fitting in Relational Models, with a Given Adjustment Factor</p></a></li>
<li><a href='#single.cells'>
<p>Single Cells under a Relational Model</p></a></li>
<li><a href='#suff.stat'>
<p>Sufficient Statistics under a Relational Model</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Generalized Iterative Proportional Fitting for Relational Models</td>
</tr>
<tr>
<td>Version:</td>
<td>3.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2017-07-21</td>
</tr>
<tr>
<td>Author:</td>
<td>Anna Klimova, Tamas Rudas</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Anna Klimova &lt;aklimova25@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Maximum likelihood estimation under relational models, with or without the overall effect.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2017-07-24 09:35:20 UTC; klimoan</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2017-07-24 09:49:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='bisection.update'>
Search for the adjustment factor corresponding to the MLE using 
the bisection method 
</h2><span id='topic+bisection.update'></span>

<h3>Description</h3>

<p><code>bisection.update</code> computes the segment 
that is known to contain the adjustment factor corresponding to the MLE
and finds this adjustment factor using the bisection method. It is needed only for relational models for probabilities.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bisection.update(ModelMx, ObsTbl, tolerance)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bisection.update_+3A_modelmx">ModelMx</code></td>
<td>
<p>an <code>I</code> by <code>J</code> model matrix of a relational model. Here
<code>I</code> is the number of observations and <code>J</code> is the number of generating subsets.  
</p>
</td></tr>
<tr><td><code id="bisection.update_+3A_obstbl">ObsTbl</code></td>
<td>
<p>a vector of observed cell frequencies of length <code>I</code>. 
</p>
</td></tr>
<tr><td><code id="bisection.update_+3A_tolerance">tolerance</code></td>
<td>
<p>tolerance used in stopping criteria.
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>gamma.tilde</code></td>
<td>
<p>the adjustment factor under the precision given by <code>tolerance</code>.</p>
</td></tr>
<tr><td><code>model.tilde</code></td>
<td>
<p>the value returned by <code>ipf.gamma()</code>
with the adjustment factor <code>gamma</code> equal to <code>gamma.tilde</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Anna Klimova, Tamas Rudas</p>


<h3>References</h3>

<p>A. Klimova, Coordinate-Free Exponential Families on Contingency Tables. PhD thesis. Advisers: Tamas Rudas and Thomas Richardson.
</p>
<p>D. Bertsekas, Non-Linear Programming. Athena Scientific, 1999.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
### Multiplicative model from Aitchison and Silvey (1960)

A = matrix(c(1, 0, 0, 1, 0, 1, 1, 
             0, 1, 0, 1, 1, 0, 1,
             0, 0, 1, 0, 1, 1, 1), byrow=TRUE, nrow=3) ## the model matrix 

y = c(46,24,7,15,3,4,1) ## the observed data

bisection.update(A, y, 1e-4)



## The model of independence for a 2 by 2 contingency table

A = matrix(c( 1,1,0,0,
              0,0,1,1,
              1,0,1,0,
              0,1,0,1), byrow=TRUE, nrow=4) ## the model matrix

y = c(1,2,3,4)  ## the observed data


bisection.update(A, y, 1e-5)

</code></pre>

<hr>
<h2 id='g.ipf'>
Generalized Iterative Proportional Fitting for Relational Models
</h2><span id='topic+g.ipf'></span>

<h3>Description</h3>

<p><code>g.ipf</code> computes the maximum likelihood estimates of the cell frequencies and of the model 
parameters under a relational model specified by a model matrix.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>g.ipf(ModelMatrix, ObsTable, tol, estimand, adjustment)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="g.ipf_+3A_modelmatrix">ModelMatrix</code></td>
<td>
<p>an <code>I</code> by <code>J</code> model matrix of a relational model. Here
<code>I</code> is the number of observations and <code>J</code> is the number of generating subsets.  
</p>
</td></tr>
<tr><td><code id="g.ipf_+3A_obstable">ObsTable</code></td>
<td>
<p>a vector of observed cell frequencies of length <code>I</code>. 
</p>
</td></tr>
<tr><td><code id="g.ipf_+3A_tol">tol</code></td>
<td>
<p>tolerance used in stopping criteria.
</p>
</td></tr>
<tr><td><code id="g.ipf_+3A_estimand">estimand</code></td>
<td>
<p>set to <code>"probabilities"</code> in the case of multinomial 
sampling; set to <code>"intensities"</code> in the case of Poisson sampling.   
</p>
</td></tr>
<tr><td><code id="g.ipf_+3A_adjustment">adjustment</code></td>
<td>
<p>set to <code>"grid"</code> if a grid is 
used to update the adjustment factor; set to <code>"bisection"</code> if the bisection method is used to update the 
adjustment factor; 
set to <code>"none"</code> if <code>estimand</code> is <code>"intensities"</code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>model.matrix</code></td>
<td>
<p>the model matrix.</p>
</td></tr>
<tr><td><code>observed.data</code></td>
<td>
<p>the vector of observed cell frequencies.</p>
</td></tr>
<tr><td><code>fitted.values</code></td>
<td>
<p>the maximum likelihood estimates of the cell frequencies.</p>
</td></tr>
<tr><td><code>estimated.total</code></td>
<td>
<p>the sum of the estimated cell frequencies.</p>
</td></tr>
<tr><td><code>adjustment.for.total</code></td>
<td>
<p>the estimated total divided by the observed total.</p>
</td></tr>
<tr><td><code>adjustment.for.subsets</code></td>
<td>
<p>the adjustment factor for the subset sums.</p>
</td></tr>
<tr><td><code>model.parameters</code></td>
<td>
<p>the maximum likelihood estimates for model parameters on the multiplicative scale.</p>
</td></tr>
<tr><td><code>degrees.of.freedom</code></td>
<td>
<p>the degrees of freedom of the relational model.</p>
</td></tr>
<tr><td><code>chisq.statistic</code></td>
<td>
<p>Pearson's chi-squared statistic.</p>
</td></tr>
<tr><td><code>p.value.chisq</code></td>
<td>
<p>the p-value, based on Pearson's chi-squared statistic.</p>
</td></tr>
<tr><td><code>log.likelihood.ratio.statistic</code></td>
<td>
<p>the log likelihood ratio statistic.</p>
</td></tr>
<tr><td><code>p.value.log.likelihood.ratio.statistic</code></td>
<td>
<p>the p-value, based on the log likelihood ratio statistic.</p>
</td></tr>
<tr><td><code>Bregman.statistic</code></td>
<td>
<p>the Bregman statistic.</p>
</td></tr>
<tr><td><code>p.value.Bregman.statistic</code></td>
<td>
<p>the p-value, based on the Bregman statistic.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Anna Klimova, Tamas Rudas</p>


<h3>References</h3>

<p>A.Klimova, T.Rudas, A.Dobra,
Relational models for contingency tables. 
J. Multivariate Anal., 2012, 104, 159&ndash;173. 
</p>
<p>A.Klimova, T.Rudas, 
Iterative proportional scaling for curved exponential families. 
Scand. J. Statist., 2015, 42, 832&ndash;847. 
</p>
<p>A. Klimova, Coordinate-Free Exponential Families on Contingency Tables. PhD thesis. Advisers: Tamas Rudas and Thomas Richardson.
</p>
<p>A.Agresti, Categorical Data Analysis. Wiley, New York, 1990.
</p>
<p>J.Aitchison, S.D.Silvey, Maximum-likelihood estimation procedures and associated tests of significance.
J. Roy. Statist. Soc. Ser.B, 1960, 22, 154&ndash;171.
</p>
<p>G.Kawamura, T.Matsuoka, T.Tajiri, M.Nishida, M.Hayashi,
Effectiveness of a sugarcane-fish combination as bait in trapping swimming crabs.
Fisheries Research, 1995, 22, 155&ndash;160.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
### Multiplicative model from Aitchison and Silvey (1960)

A = matrix(c(1, 0, 0, 1, 0, 1, 1, 
             0, 1, 0, 1, 1, 0, 1,
             0, 0, 1, 0, 1, 1, 1), byrow=TRUE, nrow=3) ## the model matrix 

y = c(46,24,7,15,3,4,1) ## the observed data

g.ipf(A, y, 1e-6, "probabilities", "bisection")
g.ipf(A, y, 1e-4, "probabilities", "grid")



### Bait study in swimming crabs, see Kawamura at al. (1995) :  

A = matrix(c(1,1,0,1,0,1), 2,3,byrow=TRUE) ## the model matrix

y1 = c(36,2,11)  ## the observed data for Charybdis japonica
y2 = c(71,3,44)  ## the observed data for Portunuspelagicus 

## If the model is for intensities, the adjustemnt factor is equal to one;
## the adjustment parameter is redundant.

g.ipf(A, y1, 1e-6, "intensities", "none")
g.ipf(A, y2, 1e-6, "intensities", "none")



</code></pre>

<hr>
<h2 id='gIPFrm-package'>
Generalized Iterative Proportional Fitting for Relational Models 
</h2><span id='topic+gIPFrm-package'></span><span id='topic+gIPFrm'></span>

<h3>Description</h3>

<p>The package provides an iterative scaling procedure that computes the maximum likelihood estimates of the cell frequencies and of the model
parameters under a relational model, with or without the overall effect. </p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> gIPFrm</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 3.1</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2017-07-21</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;= 2)</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>The iterative proportional fitting procedure is called by the function 
<code>g.ipf</code>. 
</p>


<h3>Note</h3>

<p>Tamas Rudas was supported in part by Grant K-106154 
from the Hungarian National Scientific Research Fund (OTKA).
The authors wish to thank Juraj Medzihorsky for his help 
with building this package.
</p>


<h3>Author(s)</h3>

<p>Anna Klimova, Tamas Rudas
</p>
<p>Maintainer: 
Anna Klimova &lt;aklimova25@gmail.com&gt; 
</p>


<h3>References</h3>

<p>A.Klimova, T.Rudas, A.Dobra,
Relational models for contingency tables. 
J. Multivariate Anal., 2012, 104, 159&ndash;173. 
</p>
<p>A.Klimova, T.Rudas, 
Iterative proportional scaling for curved exponential families. 
Scand. J. Statist., 2015, 42, 832&ndash;847. 
</p>
<p>A. Klimova, Coordinate-Free Exponential Families on Contingency Tables. PhD thesis. Advisers: Tamas Rudas and Thomas Richardson.
</p>
<p>A.Agresti, Categorical Data Analysis. Wiley, New York, 1990.
</p>
<p>J.Aitchison, S.D.Silvey, Maximum-likelihood estimation procedures and associated tests of significance.
J. Roy. Statist. Soc. Ser.B, 1960, 22, 154&ndash;171.
</p>
<p>G.Kawamura, T.Matsuoka, T.Tajiri, M.Nishida, M.Hayashi,
Effectiveness of a sugarcane-fish combination as bait in trapping swimming crabs.
Fisheries Research, 1995, 22, 155&ndash;160.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
### Multiplicative model from Aitchison and Silvey (1960)

A = matrix(c(1, 0, 0, 1, 0, 1, 1, 
             0, 1, 0, 1, 1, 0, 1,
             0, 0, 1, 0, 1, 1, 1), byrow=TRUE, nrow=3) ## the model matrix 

y = c(46,24,7,15,3,4,1) ## the observed data

g.ipf(A, y, 1e-4, "probabilities", "grid")
g.ipf(A, y, 1e-6, "probabilities", "bisection")

</code></pre>

<hr>
<h2 id='grid.update'>
Search for the adjustment factor corresponding to the MLE using a grid
</h2><span id='topic+grid.update'></span>

<h3>Description</h3>

<p><code>grid.update</code> computes the segment 
that is known to contain the adjustment factor corresponding to the MLE
and, using a grid on this segment, finds this adjsutment factor. It is needed only for relational models for probabilities.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>grid.update(ModelMx, ObsTbl, tolerance)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="grid.update_+3A_modelmx">ModelMx</code></td>
<td>
<p>an <code>I</code> by <code>J</code> model matrix of a relational model. Here
<code>I</code> is the number of observations and <code>J</code> is the number of generating subsets.  
</p>
</td></tr>
<tr><td><code id="grid.update_+3A_obstbl">ObsTbl</code></td>
<td>
<p>a vector of observed cell frequencies of length <code>I</code>. 
</p>
</td></tr>
<tr><td><code id="grid.update_+3A_tolerance">tolerance</code></td>
<td>
<p>tolerance used in stopping criteria.
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>gamma.tilde</code></td>
<td>
<p>the adjustment factor under the precision given by <code>tolerance</code>.</p>
</td></tr>
<tr><td><code>model.tilde</code></td>
<td>
<p>the value returned by <code>ipf.gamma()</code>
with the adjustment factor <code>gamma</code> equal to <code>gamma.tilde</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Anna Klimova, Tamas Rudas</p>


<h3>References</h3>

<p>A. Klimova, Coordinate-Free Exponential Families on Contingency Tables. PhD thesis. Advisers: Tamas Rudas and Thomas Richardson.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
### Multiplicative model from Aitchison and Silvey (1960)

A = matrix(c(1, 0, 0, 1, 0, 1, 1, 
             0, 1, 0, 1, 1, 0, 1,
             0, 0, 1, 0, 1, 1, 1), byrow=TRUE, nrow=3) ## the model matrix 

y = c(46,24,7,15,3,4,1) ## the observed data

grid.update(A, y, 1e-4)


## The model of independence for a 2 by 2 contingency table

A = matrix(c( 1,1,0,0,
              0,0,1,1,
              1,0,1,0,
              0,1,0,1), byrow=TRUE, nrow=4) ## the model matrix

y = c(1,2,3,4)  ## the observed data


grid.update(A, y, 1e-5)

</code></pre>

<hr>
<h2 id='ipf.gamma'>
Iterative Proportional Fitting in Relational Models, with a Given Adjustment Factor
</h2><span id='topic+ipf.gamma'></span>

<h3>Description</h3>

<p>For a given model matrix and a given vector of observed cell frequencies, 
<code>ipf.gamma</code> computes the vector of frequencies whose subset sums are equal 
to the observed subset sums times the adjustment factor and whose  
relative frequencies satisfy the multiplicative structure prescribed by 
the model. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ipf.gamma(ModelMatrix, ObsTable, gamma, tol, estimand)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ipf.gamma_+3A_modelmatrix">ModelMatrix</code></td>
<td>
<p>an <code>I</code> by <code>J</code> model matrix of a relational model.
<code>I</code> is the number of observations;  <code>J</code> is the number of generating subsets.  
</p>
</td></tr>
<tr><td><code id="ipf.gamma_+3A_obstable">ObsTable</code></td>
<td>
<p>a vector of observed cell frequencies.
</p>
</td></tr>
<tr><td><code id="ipf.gamma_+3A_gamma">gamma</code></td>
<td>
<p>an adjustment factor.
</p>
</td></tr>
<tr><td><code id="ipf.gamma_+3A_tol">tol</code></td>
<td>
<p>tolerance used in stopping criteria.
</p>
</td></tr>
<tr><td><code id="ipf.gamma_+3A_estimand">estimand</code></td>
<td>
<p>set to <code>"probabilities"</code> in the case of multinomial 
sampling; set to <code>"intensities"</code> in the case of Poisson sampling.
</p>
</td></tr>
</table>


<h3>Value</h3>



<table>
<tr><td><code>model.matrix</code></td>
<td>
<p>the model matrix.</p>
</td></tr>
<tr><td><code>observed.data</code></td>
<td>
<p>the vector of observed cell frequencies.</p>
</td></tr>
<tr><td><code>fitted.values</code></td>
<td>
<p>the estimated cell frequencies.</p>
</td></tr>
<tr><td><code>model.parameters</code></td>
<td>
<p>the estimated model parameters on the multiplicative scale.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Anna Klimova, Tamas Rudas 
</p>


<h3>References</h3>

<p> A.Klimova, T.Rudas, A.Dobra,
Relational models for contingency tables. 
J. Multivariate Anal., 2012, 104, 159&ndash;173.
</p>
<p>A.Klimova, T.Rudas, 
Iterative proportional scaling for curved exponential families. 
Scand. J. Statist., 2015, 42, 832&ndash;847. 
</p>
<p>A. Klimova, Coordinate-Free Exponential Families on Contingency Tables. PhD thesis. Advisers: Tamas Rudas and Thomas Richardson.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## The model of independence for a 2 by 2 contingency table

A = matrix(c( 1,1,0,0,
              0,0,1,1,
              1,0,1,0,
              0,1,0,1), byrow=TRUE, nrow=4) ## the model matrix

y = c(1,2,3,4)  ## the observed data

ipf.gamma(A, y, 1, 1e-6, "intensities")   ## Adjustment factor is set to 1 

ipf.gamma(A, y, 0.5, 1e-6, "intensities")   ## Adjustment factor is set to 0.5 


</code></pre>

<hr>
<h2 id='single.cells'>
Single Cells under a Relational Model
</h2><span id='topic+single.cells'></span>

<h3>Description</h3>

<p>The function finds all single cells under a relational model. Such cells appear 
as the only positive entries in their row and column in the model matrix. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>single.cells(ModelMatrix)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="single.cells_+3A_modelmatrix">ModelMatrix</code></td>
<td>
<p>a model matrix of a relational model.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the row and column indices of the single cells.
</p>


<h3>Author(s)</h3>

<p>Anna Klimova
</p>


<h3>Examples</h3>

<pre><code class='language-R'>G = matrix(c( 2,0,0,0,0,
              0,1,1,0,0,
              0,0,1,1,1), byrow=TRUE, nrow=3) ## a given matrix

single.cells(G)  

</code></pre>

<hr>
<h2 id='suff.stat'>
Sufficient Statistics under a Relational Model 
</h2><span id='topic+suff.stat'></span>

<h3>Description</h3>

<p>For an <code>I</code> by <code>J</code> model matrix of a relational model and 
a vector of frequencies of the length <code>I</code>, the function computes 
sufficient statistics under the model (subset sums). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>suff.stat(ModelMatrix, Table)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="suff.stat_+3A_modelmatrix">ModelMatrix</code></td>
<td>

<p><code>ModelMatrix</code> a model matrix of a relational model. 
</p>
</td></tr>
<tr><td><code id="suff.stat_+3A_table">Table</code></td>
<td>

<p><code>Table</code> a vector of frequencies. 
</p>
</td></tr>
</table>


<h3>Value</h3>

<p> a vector of subset sums.</p>


<h3>Author(s)</h3>

<p>Anna Klimova
</p>


<h3>References</h3>

<p>A.Klimova, T.Rudas, A.Dobra,
Relational models for contingency tables. 
J. Multivariate Anal., 104, 159&ndash;173. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
### Multiplicative model from Aitchison and Silvey (1960)

A = matrix(c(1, 0, 0, 1, 0, 1, 1, 
             0, 1, 0, 1, 1, 0, 1,
             0, 0, 1, 0, 1, 1, 1), byrow=TRUE, nrow=3) ## the model matrix 

y = c(46,24,7,15,3,4,1) ## the observed data

suff.stat(A,y) 

### pneumonia infection in calves:

A=matrix(c(2,1,0,0,1,1), 2,3,byrow=TRUE) ## the model matrix

y=c(30,63,63)  ## the observed data

suff.stat(A,y) 

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
