<!DOCTYPE html><html><head><title>Help for package csampling</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {csampling}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#csampling-package'>
<p>Functions for Conditional Simulation in Regression-Scale Models</p></a></li>
<li><a href='#Laplace'>
<p>Calculate Laplace's Marginal Density Approximation</p></a></li>
<li><a href='#Laplace.support'>
<p>Support for function &lsquo;Laplace()&rsquo;</p></a></li>
<li><a href='#make.sample.data'>
<p>Create a Conditional Sampling Data Object</p></a></li>
<li><a href='#mt'>
<p>Multivariate Student t Distribution</p></a></li>
<li><a href='#plot.Lapl'>
<p>Plot uni- and bivariate approximate marginal densities</p></a></li>
<li><a href='#rsm.sample'>
<p>Conditional Sampler for Regression-Scale Models</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>1.2-2.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2014-03-31</td>
</tr>
<tr>
<td>Title:</td>
<td>Functions for Conditional Simulation in Regression-Scale Models</td>
</tr>
<tr>
<td>Author:</td>
<td>S original by Alessandra R. Brazzale &lt;alessandra.brazzale@unipd.it&gt;.
  R port by Alessandra R. Brazzale &lt;alessandra.brazzale@unipd.it&gt;.</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Alessandra R. Brazzale &lt;alessandra.brazzale@unipd.it&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.0), marg, statmod, survival</td>
</tr>
<tr>
<td>Description:</td>
<td>Monte Carlo conditional inference for the parameters of a
  linear nonnormal regression model.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> | file LICENCE [expanded from: GPL (&ge; 2) | file LICENCE]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://www.r-project.org">https://www.r-project.org</a>, <a href="http://statwww.epfl.ch/AA/">http://statwww.epfl.ch/AA/</a></td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-04-16 14:54:24 UTC; hornik</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-04-16 15:01:44 UTC</td>
</tr>
</table>
<hr>
<h2 id='csampling-package'>
Functions for Conditional Simulation in Regression-Scale Models
</h2><span id='topic+csampling-package'></span><span id='topic+csampling'></span>

<h3>Description</h3>

<p>Monte Carlo conditional inference for the parameters of a
linear nonnormal regression model
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> csampling</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.2-0</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2009-10-03</td>
</tr>
<tr>
 <td style="text-align: left;">
Depends: </td><td style="text-align: left;"> R (&gt;= 2.6.0), marg, statmod, survival</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;= 2)</td>
</tr>
<tr>
 <td style="text-align: left;">
URL: </td><td style="text-align: left;"> http://www.r-project.org, http://statwww.epfl.ch/AA/</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyData: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Index:
</p>
<pre>
Functions:
=========
Laplace                 Calculate Laplace's Marginal Density
                        Approximation
dmt                     Multivariate Student t Distribution
make.sample.data        Create a Conditional Sampling Data Object
plot.Lapl.spl           Plot uni- and bivariate approximate marginal
                        densities
rsm.sample              Conditional Sampler for Regression-Scale
                        Models
</pre>


<h3>Author(s)</h3>

<p>S original by Alessandra R. Brazzale &lt;alessandra.brazzale@unimore.it&gt;.
R port by Alessandra R. Brazzale &lt;alessandra.brazzale@unimore.it&gt;.
</p>
<p>Maintainer: Alessandra R. Brazzale &lt;alessandra.brazzale@unimore.it&gt;
</p>

<hr>
<h2 id='Laplace'>
Calculate Laplace's Marginal Density Approximation
</h2><span id='topic+Laplace'></span>

<h3>Description</h3>

<p>Calculates the Laplace approximation to the uni- and bivariate
marginal densities of components of the <abbr><span class="acronym">MLE</span></abbr> in a
regression-scale model.  The reference distribution is the
conditional distribution given the ancillary.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Laplace(which = stop("no choice made"), data = stop("data are missing"), 
        val1, idx1, val2, idx2, log.scale = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Laplace_+3A_which">which</code></td>
<td>

<p>the kind of marginal density that should be approximated.  
Possible choices are <code>c</code> (univariate: regression 
coefficient),
<code>s</code> (univariate: scale parameter), <code>cc</code> (bivariate: two 
regression coefficients) and <code>cs</code> (bivariate: regression 
coefficient and scale parameter).
</p>
</td></tr>
<tr><td><code id="Laplace_+3A_data">data</code></td>
<td>

<p>a special <em>conditional sampling</em> data object.  This object 
must be a list with the following elements:
</p>

<dl>
<dt><code>anc</code></dt><dd>
<p>the vector containing the values of the ancillary; usually the 
Pearson residuals.  It has to be of the same length than the 
number of observations in the linear regression model.  
</p>
</dd>
<dt><code>X</code></dt><dd>
<p>the model matrix.  It may be obtained applying 
<code><a href="stats.html#topic+model.matrix">model.matrix</a></code> to the fitted <code>rsm</code> 
object of interest.  The number of observations has to be the
same than the dimension of the ancillary, and the number of 
covariates must correspond to the number of regression 
coefficients defined in the <code>coef</code> component.
</p>
</dd>
<dt><code>coef</code></dt><dd>
<p>the vector of <em>true</em> values of the regression coefficients,
that is, the values used in the simulation study.
</p>
</dd>
<dt><code>disp</code></dt><dd>
<p>the <em>true</em> value of the scale parameter used in the 
simulation study.
</p>
</dd>
<dt><code>family</code></dt><dd>
<p>a <code><a href="marg.html#topic+family.rsm">family.rsm</a></code> object characterizing the error
distribution of the linear regression model.  The following
generator functions are available in the <code>marg</code> 
package of the <abbr><span class="acronym">R</span></abbr> package bundle <code>hoa</code>: 
<code>student</code> (Student's t), <code>extreme</code> (Gumbel or extreme 
value), <code>logistic</code>, <code>logWeibull</code>, 
<code>logExponential</code>, <code>logRayleigh</code> and <code>Huber</code> 
(Huber's least favourable).  The demonstration file 
&lsquo;<span class="file">margdemo.R</span>&rsquo; that accompanies the <code>marg</code> package shows
how to create a new generator function. 
</p>
</dd> 
<dt><code>fixed</code></dt><dd>
<p>a logical value.  If <code>TRUE</code> the scale parameter is known.
</p>
</dd>
</dl>

<p>The <code><a href="#topic+make.sample.data">make.sample.data</a></code> function can be used
to create this data object from a fitted <code>rsm</code> model.
</p>
</td></tr>
<tr><td><code id="Laplace_+3A_val1">val1</code></td>
<td>

<p>sequence of values for the first <abbr><span class="acronym">MLE</span></abbr> at which to 
calculate the density.
</p>
</td></tr>
<tr><td><code id="Laplace_+3A_idx1">idx1</code></td>
<td>

<p>index of the first regression coefficient, that is, its position 
in the vector <abbr><span class="acronym">MLE</span></abbr>.
</p>
</td></tr>
<tr><td><code id="Laplace_+3A_val2">val2</code></td>
<td>

<p>sequence of values for the second <abbr><span class="acronym">MLE</span></abbr> at which to 
calculate the density.
</p>
</td></tr>
<tr><td><code id="Laplace_+3A_idx2">idx2</code></td>
<td>

<p>index of the second regression coefficient, that is, its position 
in the vector <abbr><span class="acronym">MLE</span></abbr>.
</p>
</td></tr>
<tr><td><code id="Laplace_+3A_log.scale">log.scale</code></td>
<td>

<p>logical value.  If <code>TRUE</code> the approximation is calculated on 
the log scale.  Highly recommended.  The default is <code>TRUE</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Laplace's integral approximation method is used in order to avoid
multi-dimensional numerical integration.  The uni- and bivariate
approximations to the marginal distributions give insight into how
the multivariate conditional distribution of the <abbr><span class="acronym">MLE</span></abbr>
vector is structured.  Methods are available to plot them.  They 
help in choosing a suitable candidate generation density to be used 
in the <code><a href="#topic+rsm.sample">rsm.sample</a></code> function.
</p>
<p>All information is supplied through the <code>data</code> argument.  Note 
that the user has to keep to the structure described above.  If a
conditional simulation is to be performed for a fitted <code>rsm</code> 
object, the <code><a href="#topic+make.sample.data">make.sample.data</a></code> function can be
used to generate this special object.  The logical switch 
<code>fixed</code> in the conditional sampling data object must be 
specified.
</p>


<h3>Value</h3>

<p>Returns a <code>Lapl.spl</code> or <code>Lapl.cont</code> object with the 
approximate uni- or bivariate conditional distribution of one or two
components of the <abbr><span class="acronym">MLE</span></abbr>.  
</p>


<h3>Demonstration</h3>

<p>The file &lsquo;<span class="file">csamplingdemo.R</span>&rsquo; contains code that can be used to 
run a conditional simulation study similar to the one described 
in <cite>Brazzale (2000, Section 7.3)</cite> using the data given in 
Example 3 of <cite>DiCiccio, Field and Fraser (1990)</cite>.
</p>


<h3>References</h3>

<p>Brazzale, A. R. (2000) <em>Practical Small-Sample Parametric 
Inference</em>.  Ph.D. Thesis N. 2230, Department of Mathematics, Swiss 
Federal Institute of Technology Lausanne.
</p>
<p>DiCiccio, T. J., Field, C. A. and Fraser, D. A. S. (1990)  
Approximations of marginal tail probabilities and inference for 
scalar parameters. <em>Biometrika</em>, <b>77</b>, 77&ndash;95.	
</p>


<h3>See Also</h3>

<p><code><a href="#topic+make.sample.data">make.sample.data</a></code>, 
<code><a href="#topic+rsm.sample">rsm.sample</a></code>.
<code><a href="marg.html#topic+family.rsm.object">family.rsm.object</a></code>, 
</p>

<hr>
<h2 id='Laplace.support'>
Support for function &lsquo;Laplace()&rsquo;
</h2><span id='topic+Laplace.c'></span><span id='topic+Laplace.s'></span><span id='topic+Laplace.cc'></span><span id='topic+Laplace.cs'></span><span id='topic+h.c'></span><span id='topic+h.s'></span><span id='topic+h.cc'></span><span id='topic+h.cs'></span>

<h3>Description</h3>

<p>This is support for the function <code><a href="#topic+Laplace">Laplace</a></code>.  
It is not intended to be called directly by users.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Laplace.c(val, idx, data, fixed = FALSE)
Laplace.s(val, data, log.scale = TRUE)
Laplace.cc(val1, val2, idx1, idx2, data, fixed)
Laplace.cs(val1, val2, idx1, data, log.scale = TRUE)
h.c(x, bb, idx, cf, disp, anc, X, family, fixed)
h.s(x, log.s, cf, disp, anc, X, family)
h.cc(x, bb, idx1, idx2, cf, disp, anc, X, family, fixed)
h.cs(x, bb, log.s, idx, cf, disp, anc, X, family)
</code></pre>

<hr>
<h2 id='make.sample.data'>
Create a Conditional Sampling Data Object
</h2><span id='topic+make.sample.data'></span>

<h3>Description</h3>

<p>Uses a fitted <code>rsm</code> model to create the data object used by    
the conditional sampler <code>rsm.sample</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make.sample.data(rsmObject)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="make.sample.data_+3A_rsmobject">rsmObject</code></td>
<td>

<p>a fitted <code>rsm</code> object.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a <em>conditional sampling</em> data object such as needed by 
the <code>rsm.sample</code> function.  This object is a list with the 
following elements:
</p>
<table>
<tr><td><code>anc</code></td>
<td>

<p>the vector containing the values of the ancillary; usually the 
Pearson residuals.  It has to be of the same length than the 
number of observations in the linear regression model.  
</p>
</td></tr>
<tr><td><code>X</code></td>
<td>

<p>the model matrix.  It may be obtained applying 
<code><a href="stats.html#topic+model.matrix">model.matrix</a></code> to the fitted <code>rsm</code> 
object of interest.  The number of observations has to be the
same than the dimension of the ancillary, and the number of 
covariates must correspond to the number of regression 
coefficients defined in the <code>coef</code> component.
</p>
</td></tr>
<tr><td><code>coef</code></td>
<td>

<p>the vector of <em>true</em> values of the regression coefficients,
that is, the values used in the simulation study.
</p>
</td></tr>
<tr><td><code>disp</code></td>
<td>

<p>the <em>true</em> value of the scale parameter used in the 
simulation study.
</p>
</td></tr>
<tr><td><code>family</code></td>
<td>

<p>a <code><a href="marg.html#topic+family.rsm">family.rsm</a></code> object characterizing the error
distribution of the linear regression model.  The following
generator functions are available in the <code>marg</code> 
package of the <abbr><span class="acronym">R</span></abbr> package bundle <code>hoa</code>: 
<code>student</code> (Student's t), <code>extreme</code> (Gumbel or extreme 
value), <code>logistic</code>, <code>logWeibull</code>, 
<code>logExponential</code>, <code>logRayleigh</code> and <code>Huber</code> 
(Huber's least favourable).  The demonstration file 
&lsquo;<span class="file">margdemo.R</span>&rsquo; that accompanies the <code>marg</code> package shows
how to create a new generator function. 
</p>
</td></tr> 
<tr><td><code>fixed</code></td>
<td>

<p>a logical value.  If <code>TRUE</code> the scale parameter is known.
</p>
</td></tr>
</table>
<p>The <code><a href="#topic+make.sample.data">make.sample.data</a></code> function can be used
to create this data object from a fitted <code>rsm</code> model.
</p>


<h3>Demonstration</h3>

<p>The file &lsquo;<span class="file">csamplingdemo.R</span>&rsquo; contains code that can be used to 
run a conditional simulation study similar to the one described
in <cite>Brazzale (2000, Section 7.3)</cite> using the data given in 
Example 3 of <cite>DiCiccio, Field and Fraser (1990)</cite>.
</p>


<h3>References</h3>

<p>Brazzale, A. R. (2000) <em>Practical Small-Sample Parametric 
Inference</em>.  Ph.D. Thesis N. 2230, Department of Mathematics, Swiss 
Federal Institute of Technology Lausanne.
</p>
<p>DiCiccio, T. J., Field, C. A. and Fraser, D. A. S. (1990)  
Approximations of marginal tail probabilities and inference for 
scalar parameters.  <em> Biometrika</em>, <b>77</b>, 77&ndash;95.	
</p>


<h3>See Also</h3>

<p><code><a href="marg.html#topic+rsm.object">rsm.object</a></code>, <code><a href="#topic+rsm.sample">rsm.sample</a></code>
</p>

<hr>
<h2 id='mt'>
Multivariate Student t Distribution
</h2><span id='topic+dmt'></span><span id='topic+rmt'></span>

<h3>Description</h3>

<p>Density and random number generation for the multivariate Student 
t distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dmt(x, df=stop("'df' argument is missing, with no default"), 
    mm=rep(0, length(x)), cov=diag(rep(1, length(x))))
rmt(n, df=stop("'df' argument is missing, with no default"), 
    mm=rep(0, mult), cov=diag(rep(1, mult)), mult, is.chol=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mt_+3A_x">x</code></td>
<td>

<p>a single multivariate observation.  Missing values (<code>NA</code>s) 
are allowed.
</p>
</td></tr>
<tr><td><code id="mt_+3A_n">n</code></td>
<td>

<p>the sample size.  If <code>length(n)</code> is larger than 1, then 
<code>length(n)</code> random vectors are returned, bound together in a 
<code>length(n)</code> times <code>mult</code> matrix, where <code>mult</code> is 
the dimension of the multivariate variable.
</p>
</td></tr>
<tr><td><code id="mt_+3A_df">df</code></td>
<td>

<p>the degrees of freedom.  In <code>rmt</code> this is replicated to be 
of the same length than the number of deviates generated by 
<code>rmt</code>.
</p>
</td></tr>
<tr><td><code id="mt_+3A_mult">mult</code></td>
<td>

<p>the dimension of the multivariate Student t variate.
</p>
</td></tr>
<tr><td><code id="mt_+3A_mm">mm</code></td>
<td>

<p>a vector location parameter.  The default is a vector of 0's.
</p>
</td></tr>
<tr><td><code id="mt_+3A_cov">cov</code></td>
<td>

<p>a square scale matrix.  The default is the identity matrix.
</p>
</td></tr>
<tr><td><code id="mt_+3A_is.chol">is.chol</code></td>
<td>

<p>logical flag.  If <code>TRUE</code>, the argument <code>cov</code> is the 
result from the Choleski decomposition of the original scale 
matrix.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the density (<code>dmt</code>) of or a random sample (<code>rmt</code>) 
from the multivariate Student t distribution on <code>df</code> degrees 
of freedom. 
</p>


<h3>Side Effects</h3>

<p>The function <code>rmt</code> causes creation of the dataset 
<code><a href="base.html#topic+.Random.seed">.Random.seed</a></code> if it does not already exist, 
otherwise its value is updated.
</p>


<h3>Background</h3>

<p>The multivariate Student t distribution is a real valued symmetric
distribution centered at <code>mm</code>.  It is defined as the ratio of a
centred multivariate normal distribution with covariance matrix 
<code>cov</code>, and the square root of an independent 
<code class="reqn">\chi^2</code> distribution with <code>df</code> degrees of 
freedom subsequently translated by <code>mm</code>.  (See 
<cite>Johnson and Kotz, 1976, par. 37.3, pg. 134ff</cite>.)
The multivariate t distribution approaches the multivariate Gaussian
(<code><a href="stats.html#topic+Normal">Normal</a></code>) distribution as the degrees of freedom 
go to infinity.
</p>


<h3>Note</h3>

<p>Elements of <code>x</code> that are missing will cause the corresponding
elements of the result to be missing.
</p>


<h3>References</h3>

<p>Johnson, N. L. and Kotz, S. (1976) <em>Distributions in 
Statistics: Continuous Multivariate Distributions</em>.  New York: 
Wiley.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+TDist">TDist</a></code>, <code><a href="stats.html#topic+Normal">Normal</a></code>, 
<code><a href="base.html#topic+Random">Random</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dmt(c(0.1, -0.4), df = 4, mm = c(1, -1))  
## density of a bivariate t distribution with 4 degrees of freedom 
## and centered at (1,-1)

rmt(n = 100, df = 5, mult = 4)  
## generates 100 replicates of a standard four-variate t distribution 
## with 5 degress of freedom
</code></pre>

<hr>
<h2 id='plot.Lapl'>
Plot uni- and bivariate approximate marginal densities
</h2><span id='topic+plot.Lapl.spl'></span><span id='topic+plot.Lapl.cont'></span>

<h3>Description</h3>

<p>Plots the uni- and bivariate approximations to the marginal 
densities of components of the <abbr><span class="acronym">MLE</span></abbr> obtained by Laplace's 
method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'Lapl.spl'
plot(x, ...)
## S3 method for class 'Lapl.cont'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.Lapl_+3A_x">x</code></td>
<td>

<p>an object of class <code>Lapl.spl</code> or <code>Lapl.cont</code> such as
generated by the <code><a href="#topic+Laplace">Laplace</a></code> function.
</p>
</td></tr>
<tr><td><code id="plot.Lapl_+3A_...">...</code></td>
<td>

<p>additional graphics parameters.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a method for the function <code>plot()</code> for objects 
inheriting from class <code>Lapl.spl</code> and <code>Lapl.cont</code> 
generated by the <code>Laplace()</code> routine.  
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Laplace">Laplace</a></code>
</p>

<hr>
<h2 id='rsm.sample'>
Conditional Sampler for Regression-Scale Models
</h2><span id='topic+rsm.sample'></span>

<h3>Description</h3>

<p>Generates replicates of the <abbr><span class="acronym">MLE</span></abbr>s of the parameters 
occuring in a regression-scale model using as reference distribution
the conditional distribution of the <abbr><span class="acronym">MLE</span></abbr>s given the value 
of the ancillary. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rsm.sample(data = stop("no data given"), R = 10000, 
    ran.gen = stop("candidate distribution is missing, with no default"), 
           trace = TRUE, step = 100, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rsm.sample_+3A_data">data</code></td>
<td>

<p>A special <em>conditional sampling</em> data object.  This object 
must be a list with the following elements:
</p>

<dl>
<dt><code>anc</code></dt><dd>
<p>the vector containing the values of the ancillary; usually the 
Pearson residuals.  It has to be of the same length than the 
number of observations in the linear regression model.  
</p>
</dd>
<dt><code>X</code></dt><dd>
<p>the model matrix.  It may be obtained applying 
<code><a href="stats.html#topic+model.matrix">model.matrix</a></code> to the fitted <code>rsm</code> 
object of interest.  The number of observations has to be the
same than the dimension of the ancillary, and the number of 
covariates must correspond to the number of regression 
coefficients defined in the <code>coef</code> component.
</p>
</dd>
<dt><code>coef</code></dt><dd>
<p>the vector of <em>true</em> values of the regression coefficients,
that is, the values used in the simulation study.
</p>
</dd>
<dt><code>disp</code></dt><dd>
<p>the <em>true</em> value of the scale parameter used in the 
simulation study.
</p>
</dd>
<dt><code>family</code></dt><dd>
<p>a <code><a href="marg.html#topic+family.rsm">family.rsm</a></code> object characterizing the error
distribution of the linear regression model.  The following
generator functions are available in the <code>marg</code> 
package of the <abbr><span class="acronym">R</span></abbr> package bundle <code>hoa</code>: 
<code>student</code> (Student's t), <code>extreme</code> (Gumbel or extreme 
value), <code>logistic</code>, <code>logWeibull</code>, 
<code>logExponential</code>, <code>logRayleigh</code> and <code>Huber</code> 
(Huber's least favourable).  The demonstration file 
&lsquo;<span class="file">margdemo.R</span>&rsquo; that accompanies the <code>marg</code> package shows
how to create a new generator function. 
</p>
</dd> 
<dt><code>fixed</code></dt><dd>
<p>a logical value.  If <code>TRUE</code> the scale parameter is known.
</p>
</dd>
</dl>

<p>The <code><a href="#topic+make.sample.data">make.sample.data</a></code> function can be used
to create this data object from a fitted <code>rsm</code> model.
</p>
</td></tr>
<tr><td><code id="rsm.sample_+3A_r">R</code></td>
<td>

<p>the number of replicates.  
</p>
</td></tr>
<tr><td><code id="rsm.sample_+3A_ran.gen">ran.gen</code></td>
<td>

<p>a function which describes how the candidate values used in the 
Metropolis-Hastings algorithm should be generated.  It must be 
a function of at least two arguments.  The first one is the data 
object <code>data</code>, and the second argument is <code>R</code>, the 
number of replicates required.  Any other information needed may 
be passed through the <code>...</code> argument.  The returned value 
should be a <code>R</code> times <em>k</em> matrix of simulated values.  
For the value of <em>k</em> see the details section below.
</p>
</td></tr>
<tr><td><code id="rsm.sample_+3A_trace">trace</code></td>
<td>

<p>a logical value; if <code>TRUE</code>, the iteration number is printed.
Defaults to <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="rsm.sample_+3A_step">step</code></td>
<td>

<p>a numercial value defining after how many iterations to print the
iteration number.  Default is 100.
</p>
</td></tr>
<tr><td><code id="rsm.sample_+3A_...">...</code></td>
<td>

<p>absorbs additional arguments to <code>ran.gen</code>.  These are passed
unchanged each time this function is called.  
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>rsm.sample</code> function uses the Metropolis-Hastings 
algorithm to generate an ergodic chain with equilibrium distribution
equal to the conditional distribution of the <abbr><span class="acronym">MLE</span></abbr>s given 
the ancillary.  Because of the broad applicability of this 
algorithm 
the candidate generation density was not built in, but has to be 
supplied by the user through the <code>ran.gen</code> argument.  The 
output of this function must be a <code>R</code> times <em>k</em> matrix, 
where <em>k = p</em> + <em>1</em> or <em>k = p</em> + <em>2</em> depending 
on whether the 
scale parameter is fixed or not.  The first <em>p</em> columns contain
the <abbr><span class="acronym">MLE</span></abbr>s of the regression coefficients, the following the
<abbr><span class="acronym">MLE</span></abbr>s of the scale parameter if unknown, and the last 
column contains the probabilities of the candidate values drawn 
from the candidate generation distribution.  Note that these 
probabilities need only be calculated up to a normalizing constant.
</p>
<p>All information is supplied through the <code>data</code> argument.  The 
user has to keep to the structure described above.  If a conditional
simulation is to be performed for a fitted <code>rsm</code> object, the
<code><a href="#topic+make.sample.data">make.sample.data</a></code> function can be used to 
generate this special object.  It is advisable to specify the 
logical switch <code>fixed</code> in the conditional sampling object, 
although it needs not (in which case the scale parameter is supposed
to be unknown).
</p>
<p>The conditional simulation (<code>cs</code>) object generated by 
<code>rsm.sample</code> contains all information necessary for further 
investigation, such as the derivation of the conditional 
distribution of test statistics, the calculation of conditional 
coverage levels of confidence intervals and many more.  As the 
computation is somewhat tricky, an example is given in the 
demonstration file &lsquo;<span class="file">csamplingdemo.R</span>&rsquo;.
</p>


<h3>Value</h3>

<p>The returned value is an object of class <code>cs</code> containing the 
following components:
</p>
<table>
<tr><td><code>sim</code></td>
<td>

<p>a matrix with <code>R</code> rows each of which contains a sample from
the conditional distribution of the <abbr><span class="acronym">MLEs</span></abbr>.
</p>
</td></tr>
<tr><td><code>rho</code></td>
<td>

<p>the acceptance probabilities at each Metropolis-Hastings step, 
that is, the probabilities with which the candidate values drawn from 
the candidate generation distribution are accepted. 
</p>
</td></tr>
<tr><td><code>seed</code></td>
<td>

<p>the value of <code>.Random.seed</code> when <code>rsm.sample</code> was 
called.  
</p>
</td></tr>
<tr><td><code>data</code></td>
<td>

<p>the <code>data</code> as passed to <code>rsm.sample</code>.
</p>
</td></tr>
<tr><td><code>R</code></td>
<td>

<p>the value of <code>R</code> as passed to <code>rsm.sample</code>.
</p>
</td></tr>
<tr><td><code>call</code></td>
<td>

<p>the original call to <code>rsm.sample</code>.
</p>
</td></tr>
</table>


<h3>Side Effects</h3>

<p>The function <code>rsm.sample</code> causes creation of the dataset
<code><a href="base.html#topic+.Random.seed">.Random.seed</a></code> if it does not already exist, 
otherwise its value is updated.
</p>


<h3>Demonstration</h3>

<p>The file &lsquo;<span class="file">csamplingdemo.R</span>&rsquo; contains code that can be used to 
run a conditional simulation study similar to the one described
in <cite>Brazzale (2000, Section 7.3)</cite> using the data given in 
Example 3 of <cite>DiCiccio, Field and Fraser (1990)</cite>.
</p>


<h3>References</h3>

<p>Brazzale, A. R. (2000) <em>Practical Small-Sample Parametric 
Inference</em>.  Ph.D. Thesis N. 2230, Department of Mathematics, Swiss
Federal Institute of Technology Lausanne.
</p>
<p>DiCiccio, T. J., Field, C. A. and Fraser, D. A. S. (1990) 
Approximations of marginal tail probabilities and inference for 
scalar parameters. <em>Biometrika</em>, <b>77</b>, 77&ndash;95.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+make.sample.data">make.sample.data</a></code>, 
<code><a href="marg.html#topic+rsm.object">rsm.object</a></code>,  
<code><a href="marg.html#topic+family.rsm.object">family.rsm.object</a></code>, 
<code><a href="marg.html#topic+rsm">rsm</a></code>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
