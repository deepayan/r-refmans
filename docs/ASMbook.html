<!DOCTYPE html><html lang="en"><head><title>Help for package ASMbook</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ASMbook}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#demoMCMC'><p>Fit a Poisson GLM with MCMC</p></a></li>
<li><a href='#getMLE'><p>Print Estimates, Standard Errors, and 95% Wald-type Confidence Intervals From optim Output</p></a></li>
<li><a href='#nimbleSummary'><p>Summarize MCMC Samples in an mcmc.list Object Created by NIMBLE</p></a></li>
<li><a href='#simDat102'><p>Simulate data for Chapter 10.2: Linear mixed-effects model</p></a></li>
<li><a href='#simDat105'><p>Simulate data for Chapter 10.5: Linear mixed-effects model with correlation between intercepts and slopes</p></a></li>
<li><a href='#simDat11'><p>Simulate data for Chapter 11: Comparing two groups of Poisson counts</p></a></li>
<li><a href='#simDat122'><p>Simulate data for Chapter 12.2: Overdispersed counts</p></a></li>
<li><a href='#simDat123'><p>Simulate data for Chapter 12.3: Zero-inflated counts</p></a></li>
<li><a href='#simDat124'><p>Simulate data for Chapter 12.4: Counts with offsets</p></a></li>
<li><a href='#simDat13'><p>Simulate data for Chapter 13: Poisson ANCOVA</p></a></li>
<li><a href='#simDat14'><p>Simulate data for Chapter 14: Poisson GLMM</p></a></li>
<li><a href='#simDat15'><p>Simulate data for Chapter 15: Comparing two groups of binomial counts</p></a></li>
<li><a href='#simDat16'><p>Simulate data for Chapter 16: Binomial ANCOVA</p></a></li>
<li><a href='#simDat17'><p>Simulate data for Chapter 17: Binomial GLMM</p></a></li>
<li><a href='#simDat18'><p>Simulate data for Chapter 18: model selection</p></a></li>
<li><a href='#simDat19'><p>Simulate data for Chapter 19: Occupancy model</p></a></li>
<li><a href='#simDat19B'><p>Simulate data for Chapter 19B: Binomial N-mixture Model</p></a></li>
<li><a href='#simDat20'><p>Simulate data for Chapter 20: Integrated model</p></a></li>
<li><a href='#simDat4'><p>Simulate data for Chapter 4: Model of the mean</p></a></li>
<li><a href='#simDat5'><p>Simulate data for Chapter 5: Simple linear regression</p></a></li>
<li><a href='#simDat62'><p>Simulate data for Chapter 6.2: Two groups with equal variance</p></a></li>
<li><a href='#simDat63'><p>Simulate data for Chapter 6.3: Two groups with unequal variance</p></a></li>
<li><a href='#simDat72'><p>Simulate data for Chapter 7.2: ANOVA with fixed effects of population</p></a></li>
<li><a href='#simDat73'><p>Simulate data for Chapter 7.3: ANOVA with random effects of population</p></a></li>
<li><a href='#simDat8'><p>Simulate data for Chapter 8: Two-way ANOVA</p></a></li>
<li><a href='#simDat9'><p>Simulate data for Chapter 9: ANCOVA or general linear model</p></a></li>
<li><a href='#tmbSummary'><p>Summarize Output from TMB</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Version:</td>
<td>1.0.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-07-29</td>
</tr>
<tr>
<td>Title:</td>
<td>Functions for the Book "Applied Statistical Modeling for
Ecologists"</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.4.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>coda, lattice, MASS, stats, TMB</td>
</tr>
<tr>
<td>Suggests:</td>
<td>roxygen2</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides functions to accompany the book "Applied Statistical Modeling for Ecologists" by Marc Kéry and Kenneth F. Kellner (2024, ISBN: 9780443137150). Included are functions for simulating and customizing the datasets used for the example models in each chapter, summarizing output from model fitting engines, and running custom Markov Chain Monte Carlo.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://shop.elsevier.com/books/applied-statistical-modelling-for-ecologists/kery/978-0-443-13715-0">https://shop.elsevier.com/books/applied-statistical-modelling-for-ecologists/kery/978-0-443-13715-0</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/kenkellner/ASMbook/issues">https://github.com/kenkellner/ASMbook/issues</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-07-29 14:57:43 UTC; ken</td>
</tr>
<tr>
<td>Author:</td>
<td>Marc Kéry [aut],
  Ken Kellner [cre, aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Ken Kellner &lt;contact@kenkellner.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-07-31 10:20:27 UTC</td>
</tr>
</table>
<hr>
<h2 id='demoMCMC'>Fit a Poisson GLM with MCMC</h2><span id='topic+demoMCMC'></span>

<h3>Description</h3>

<p>This is a demo function that fits a Poisson GLM with one continuous covariate
to some data (y, x) using a random-walk Metropolis Markov chain Monte Carlo algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>demoMCMC(
  y,
  x,
  true.vals = c(2.5, 0.14),
  inits = c(0, 0),
  prior.sd.alpha = 100,
  prior.sd.beta = 100,
  tuning.params = c(0.1, 0.1),
  niter = 10000,
  nburn = 1000,
  quiet = TRUE,
  show.plots = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="demoMCMC_+3A_y">y</code></td>
<td>
<p>A vector of counts, e.g., y in the Swiss bee-eater example</p>
</td></tr>
<tr><td><code id="demoMCMC_+3A_x">x</code></td>
<td>
<p>A vector of a continuous explanatory variable, e.g. year x in the bee-eaters</p>
</td></tr>
<tr><td><code id="demoMCMC_+3A_true.vals">true.vals</code></td>
<td>
<p>True intercept and slope if known (i.e., when run on simulated data)</p>
</td></tr>
<tr><td><code id="demoMCMC_+3A_inits">inits</code></td>
<td>
<p>Initial values in the MCMC algorithm for alpha, beta</p>
</td></tr>
<tr><td><code id="demoMCMC_+3A_prior.sd.alpha">prior.sd.alpha</code></td>
<td>
<p>SD of normal prior for alpha</p>
</td></tr>
<tr><td><code id="demoMCMC_+3A_prior.sd.beta">prior.sd.beta</code></td>
<td>
<p>SD of normal prior for beta</p>
</td></tr>
<tr><td><code id="demoMCMC_+3A_tuning.params">tuning.params</code></td>
<td>
<p>SD of the Gaussian proposal distributions for alpha, beta</p>
</td></tr>
<tr><td><code id="demoMCMC_+3A_niter">niter</code></td>
<td>
<p>Total chain length (before burnin)</p>
</td></tr>
<tr><td><code id="demoMCMC_+3A_nburn">nburn</code></td>
<td>
<p>Burn-in length</p>
</td></tr>
<tr><td><code id="demoMCMC_+3A_quiet">quiet</code></td>
<td>
<p>Logical, suppress console output</p>
</td></tr>
<tr><td><code id="demoMCMC_+3A_show.plots">show.plots</code></td>
<td>
<p>Logical, should diagnostic plots be shown?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing input settings, acceptance probabilities and MCMC samples.
</p>


<h3>Author(s)</h3>

<p>Marc Kéry
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load the real data used in the publication by Mueller (Vogelwarte, 2021)

# Counts of known pairs in the country 1990-2020
y &lt;- c(0,2,7,5,1,2,4,8,10,11,16,11,10,13,19,31,
      20,26,19,21,34,35,43,53,66,61,72,120,102,159,199)
year &lt;- 1990:2020     # Define year range
x &lt;- (year-1989)      # Scaled, but not centered year as a covariate
x &lt;- x-16             # Now it's centered

oldpar &lt;- par(no.readonly = TRUE)
par(mfrow = c(1, 2), mar = c(5,5,5,2), cex.lab = 1.5, cex.axis = 1.5, cex.main = 1.5)
plot(table(y), xlab = 'Count (y)', ylab = 'Frequency', frame = FALSE,
     type = 'h', lend = 'butt', lwd = 5, col = 'gray20', main = 'Frequency distribution of counts')
plot(year, y, xlab = 'Year (x)', ylab = 'Count (y)', frame = FALSE, cex = 1.5,
     pch = 16,  col = 'gray20', main = 'Relationship y ~ x')
fm &lt;- glm(y ~ x, family = 'poisson')        # Add Poisson GLM line of best fit
lines(year, predict(fm, type = 'response'), lwd = 3, col = 'red', lty = 3)


# Execute the function with default function args
# In a real test you should run more iterations
par(mfrow = c(1,1))
str(tmp &lt;- demoMCMC(niter=100, nburn=50))

# Use data created above
par(mfrow = c(1,1))
str(tmp &lt;- demoMCMC(y = y, x = x, niter=100, nburn=50))


par(oldpar)

</code></pre>

<hr>
<h2 id='getMLE'>Print Estimates, Standard Errors, and 95% Wald-type Confidence Intervals From optim Output</h2><span id='topic+getMLE'></span><span id='topic+get_MLE'></span>

<h3>Description</h3>

<p>Print Estimates, Standard Errors, and 95% Wald-type Confidence Intervals From optim Output
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getMLE(opt, dig = 3)

get_MLE(opt, dig = 3)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getMLE_+3A_opt">opt</code></td>
<td>
<p>Object resulting from a call to <code>optim</code></p>
</td></tr>
<tr><td><code id="getMLE_+3A_dig">dig</code></td>
<td>
<p>Number of decimal places to use when printing</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of parameter estimates, standard errors, and 95% Wald-type confidence intervals.
</p>


<h3>Author(s)</h3>

<p>Marc Kéry, Ken Kellner
</p>

<hr>
<h2 id='nimbleSummary'>Summarize MCMC Samples in an mcmc.list Object Created by NIMBLE</h2><span id='topic+nimbleSummary'></span><span id='topic+nimble_summary'></span>

<h3>Description</h3>

<p>Summarize MCMC Samples in an mcmc.list Object Created by NIMBLE
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nimbleSummary(samples, params = NULL)

nimble_summary(samples, params = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nimbleSummary_+3A_samples">samples</code></td>
<td>
<p>An object of class <code>mcmc.list</code></p>
</td></tr>
<tr><td><code id="nimbleSummary_+3A_params">params</code></td>
<td>
<p>An optional list of the parameter names used to sort the output</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame of summary information for each saved parameter
</p>


<h3>Author(s)</h3>

<p>Ken Kellner
</p>

<hr>
<h2 id='simDat102'>Simulate data for Chapter 10.2: Linear mixed-effects model</h2><span id='topic+simDat102'></span>

<h3>Description</h3>

<p>Simulate mass ~ length regressions in 56 populations of snakes
with random population effects for intercepts and slopes.
There is no correlation between the intercept and slope random variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simDat102(
  nPops = 56,
  nSample = 10,
  mu.alpha = 260,
  sigma.alpha = 20,
  mu.beta = 60,
  sigma.beta = 30,
  sigma = 30
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simDat102_+3A_npops">nPops</code></td>
<td>
<p>Number of populations</p>
</td></tr>
<tr><td><code id="simDat102_+3A_nsample">nSample</code></td>
<td>
<p>Samples from each population</p>
</td></tr>
<tr><td><code id="simDat102_+3A_mu.alpha">mu.alpha</code></td>
<td>
<p>Mean of random intercepts</p>
</td></tr>
<tr><td><code id="simDat102_+3A_sigma.alpha">sigma.alpha</code></td>
<td>
<p>SD of random intercepts</p>
</td></tr>
<tr><td><code id="simDat102_+3A_mu.beta">mu.beta</code></td>
<td>
<p>Mean of random slopes</p>
</td></tr>
<tr><td><code id="simDat102_+3A_sigma.beta">sigma.beta</code></td>
<td>
<p>SD of random slopes</p>
</td></tr>
<tr><td><code id="simDat102_+3A_sigma">sigma</code></td>
<td>
<p>Residual standard deviation</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of simulated data and parameters.
</p>
<table role = "presentation">
<tr><td><code>nPops</code></td>
<td>
<p>Number of populations</p>
</td></tr>
<tr><td><code>nSample</code></td>
<td>
<p>Number of samples per population</p>
</td></tr>
<tr><td><code>mu.alpha</code></td>
<td>
<p>Mean of random intercepts</p>
</td></tr>
<tr><td><code>sigma.alpha</code></td>
<td>
<p>SD of random intercepts</p>
</td></tr>
<tr><td><code>mu.beta</code></td>
<td>
<p>Mean of random slopes</p>
</td></tr>
<tr><td><code>sigma.beta</code></td>
<td>
<p>SD of random slopes</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>Residual SD</p>
</td></tr>
<tr><td><code>pop</code></td>
<td>
<p>Indicator for population number</p>
</td></tr>
<tr><td><code>orig.length</code></td>
<td>
<p>Snake body length, not standardized</p>
</td></tr>
<tr><td><code>lengthN</code></td>
<td>
<p>Snake body length, standardized</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>Random intercepts</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>Random slopes</p>
</td></tr>
<tr><td><code>eps</code></td>
<td>
<p>Residuals</p>
</td></tr>
<tr><td><code>mass</code></td>
<td>
<p>Simulated body mass for each snake</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marc Kéry
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(lattice)
str(dat &lt;- simDat102())      # Implicit default arguments
xyplot(dat$mass ~ dat$lengthN | dat$pop, xlab = 'Length', ylab = 'Mass', 
       main = 'Realized mass-length relationships', pch = 16, cex = 1.2, 
       col = rgb(0, 0, 0, 0.4))

# Fewer populations, more snakes (makes patterns perhaps easier to see ?)
str(dat &lt;- simDat102(nPops = 16, nSample = 100))
xyplot(dat$mass ~ dat$lengthN | dat$pop, xlab = 'Length', ylab = 'Mass', 
       main = 'Realized mass-length relationships
       (default random-coefficients model)', 
       pch = 16, cex = 1.2, col = rgb(0, 0, 0, 0.4))

# Revert to random intercept model (and less residual variation), fewer pops 
# and more snakes. Increased sigma.alpha to emphasize the random intercepts part
str(dat &lt;- simDat102(nPops = 16, nSample = 100, sigma.alpha = 50, sigma.beta = 0, sigma = 10))
xyplot(dat$mass ~ dat$lengthN | dat$pop, xlab = 'Length', ylab = 'Mass', 
       main = 'Realized mass-length relationships (random-intercepts model)', 
       pch = 16, cex = 1.2, col = rgb(0, 0, 0, 0.4))

# Revert to random-effects one-way ANOVA model, only random intercepts, but zero slopes
str(dat &lt;- simDat102(nPops = 16, nSample = 100, sigma.alpha = 50, 
                     mu.beta = 0, sigma.beta = 0, sigma = 10))
xyplot(dat$mass ~ dat$lengthN | dat$pop, xlab = 'Length', ylab = 'Mass', 
       main = 'Realized mass-length relationships
       (one-way ANOVA model with random pop effects)', 
       pch = 16, cex = 1.2, col = rgb(0, 0, 0, 0.4))

# Revert to simple linear regression (= no effects of pop on either intercepts or slopes)
str(dat &lt;- simDat102(nPops = 16, nSample = 100, sigma.alpha = 0, sigma.beta = 0, sigma = 10))
xyplot(dat$mass ~ dat$lengthN | dat$pop, xlab = 'Length', ylab = 'Mass', 
       main = 'Realized mass-length relationships
       (de-facto a simple linear regression now)', 
       pch = 16, cex = 1.2, col = rgb(0, 0, 0, 0.4))

# Revert to "model-of-the-mean": no effects of either population or body length
str(dat &lt;- simDat102(nPops = 16, nSample = 100, sigma.alpha = 0, mu.beta = 0, 
                     sigma.beta = 0, sigma = 10))
xyplot(dat$mass ~ dat$lengthN | dat$pop, xlab = 'Length', ylab = 'Mass', 
       main = 'Realized mass-length relationships
       ("model-of-the-mean", no effects of pop or length)', 
       pch = 16, cex = 1.2, col = rgb(0, 0, 0, 0.4))

</code></pre>

<hr>
<h2 id='simDat105'>Simulate data for Chapter 10.5: Linear mixed-effects model with correlation between intercepts and slopes</h2><span id='topic+simDat105'></span>

<h3>Description</h3>

<p>Simulate mass ~ length regressions in 56 populations of snakes
with random population effects for intercepts and slopes.
Note that now there is a correlation between the intercept and slope random variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simDat105(
  nPops = 56,
  nSample = 10,
  mu.alpha = 260,
  sigma.alpha = 20,
  mu.beta = 60,
  sigma.beta = 30,
  cov.alpha.beta = -50,
  sigma = 30
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simDat105_+3A_npops">nPops</code></td>
<td>
<p>Number of populations</p>
</td></tr>
<tr><td><code id="simDat105_+3A_nsample">nSample</code></td>
<td>
<p>Samples from each population</p>
</td></tr>
<tr><td><code id="simDat105_+3A_mu.alpha">mu.alpha</code></td>
<td>
<p>Mean of random intercepts</p>
</td></tr>
<tr><td><code id="simDat105_+3A_sigma.alpha">sigma.alpha</code></td>
<td>
<p>SD of random intercepts</p>
</td></tr>
<tr><td><code id="simDat105_+3A_mu.beta">mu.beta</code></td>
<td>
<p>Mean of random slopes</p>
</td></tr>
<tr><td><code id="simDat105_+3A_sigma.beta">sigma.beta</code></td>
<td>
<p>SD of random slopes</p>
</td></tr>
<tr><td><code id="simDat105_+3A_cov.alpha.beta">cov.alpha.beta</code></td>
<td>
<p>Covariance between alpha and beta</p>
</td></tr>
<tr><td><code id="simDat105_+3A_sigma">sigma</code></td>
<td>
<p>Residual standard deviation</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of simulated data and parameters.
</p>
<table role = "presentation">
<tr><td><code>nPops</code></td>
<td>
<p>Number of populations</p>
</td></tr>
<tr><td><code>nSample</code></td>
<td>
<p>Number of samples per population</p>
</td></tr>
<tr><td><code>mu.alpha</code></td>
<td>
<p>Mean of random intercepts</p>
</td></tr>
<tr><td><code>sigma.alpha</code></td>
<td>
<p>SD of random intercepts</p>
</td></tr>
<tr><td><code>mu.beta</code></td>
<td>
<p>Mean of random slopes</p>
</td></tr>
<tr><td><code>sigma.beta</code></td>
<td>
<p>SD of random slopes</p>
</td></tr>
<tr><td><code>cov.alpha.beta</code></td>
<td>
<p>Covariance betwen alpha and beta</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>Residual SD</p>
</td></tr>
<tr><td><code>pop</code></td>
<td>
<p>Indicator for population number</p>
</td></tr>
<tr><td><code>orig.length</code></td>
<td>
<p>Snake body length, not standardized</p>
</td></tr>
<tr><td><code>lengthN</code></td>
<td>
<p>Snake body length, standardized</p>
</td></tr>
<tr><td><code>ranef.matrix</code></td>
<td>
<p>Random effects matrix</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>Random intercepts</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>Random slopes</p>
</td></tr>
<tr><td><code>eps</code></td>
<td>
<p>Residuals</p>
</td></tr>
<tr><td><code>mass</code></td>
<td>
<p>Simulated body mass for each snake</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marc Kéry
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(lattice)
str(dat &lt;- simDat105())      # Implicit default arguments
xyplot(dat$mass ~ dat$lengthN | dat$pop, xlab = 'Length', ylab = 'Mass', 
       main = 'Realized mass-length relationships', pch = 16, cex = 1.2, 
       col = rgb(0, 0, 0, 0.4))

# Fewer populations, more snakes (makes patterns perhaps easier to see)
str(dat &lt;- simDat105(nPops = 16, nSample = 100))
xyplot(dat$mass ~ dat$lengthN | dat$pop, xlab = 'Length', ylab = 'Mass',
       main = 'Realized mass-length relationships (random-coef model
       intercept-slope correlation)', 
       pch = 16, cex = 1.2, col = rgb(0, 0, 0, 0.4))

# Revert to simpler random-coefficient model without correlation between intercepts and slopes
# (that means to set to zero the covariance term)
str(dat &lt;- simDat105(nPops = 16, nSample = 100, cov.alpha.beta = 0))
xyplot(dat$mass ~ dat$lengthN | dat$pop, xlab = 'Length', ylab = 'Mass',
       main = 'Realized mass-length relationships
       (random-coefficients model without correlation)', 
       pch = 16, cex = 1.2, col = rgb(0, 0, 0, 0.4))

# Revert to even simpler random-intercepts model without correlation between intercepts and slopes
# (that means to set to zero the covariance term and the among-population variance of the slopes)
# Note that sigma.beta = 0 and non-zero covariance crashes owing to non-positive-definite VC matrix
str(dat &lt;- simDat105(nPops = 16, nSample = 100, sigma.alpha = 50, sigma.beta = 0, 
    cov.alpha.beta = 0, sigma = 10))
xyplot(dat$mass ~ dat$lengthN | dat$pop, xlab = 'Length', ylab = 'Mass', 
       main = 'Realized mass-length relationships\n(random-intercepts model)', 
       pch = 16, cex = 1.2, col = rgb(0, 0, 0, 0.4))

# Revert to random-effects one-way ANOVA model, only random intercepts, but zero slopes
str(dat &lt;- simDat105(nPops = 16, nSample = 100, sigma.alpha = 50, mu.beta = 0, sigma.beta = 0, 
    cov.alpha.beta = 0, sigma = 10))
xyplot(dat$mass ~ dat$lengthN | dat$pop, xlab = 'Length', ylab = 'Mass', 
       main = 'Realized mass-length relationships
       (one-way ANOVA model with random pop effects)', 
       pch = 16, cex = 1.2, col = rgb(0, 0, 0, 0.4))

# Revert to simple linear regression (= no effects of pop on either intercepts or slopes)
str(dat &lt;- simDat105(nPops = 16, nSample = 100, sigma.alpha = 0, sigma.beta = 0, 
    cov.alpha.beta = 0, sigma = 10))
xyplot(dat$mass ~ dat$lengthN | dat$pop, xlab = 'Length', ylab = 'Mass', 
       main = 'Realized mass-length relationships
       (this is de-facto a simple linear regression now)', 
       pch = 16, cex = 1.2, col = rgb(0, 0, 0, 0.4))

# Revert to "model-of-the-mean": no effects of either population or body length
str(dat &lt;- simDat105(nPops = 16, nSample = 100, sigma.alpha = 0, mu.beta = 0, sigma.beta = 0,
    cov.alpha.beta = 0, sigma = 10))
xyplot(dat$mass ~ dat$lengthN | dat$pop, xlab = 'Length', ylab = 'Mass', 
       main = 'Realized mass-length relationships
       ("model-of-the-mean" with no effects of pop or length)', 
       pch = 16, cex = 1.2, col = rgb(0, 0, 0, 0.4))

</code></pre>

<hr>
<h2 id='simDat11'>Simulate data for Chapter 11: Comparing two groups of Poisson counts</h2><span id='topic+simDat11'></span>

<h3>Description</h3>

<p>Generate counts of hares in two areas with different landuse
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simDat11(nSites = 30, alpha = log(2), beta = log(5) - log(2))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simDat11_+3A_nsites">nSites</code></td>
<td>
<p>Number of sites</p>
</td></tr>
<tr><td><code id="simDat11_+3A_alpha">alpha</code></td>
<td>
<p>Intercept</p>
</td></tr>
<tr><td><code id="simDat11_+3A_beta">beta</code></td>
<td>
<p>Slope for land use</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of simulated data and parameters.
</p>
<table role = "presentation">
<tr><td><code>nSites</code></td>
<td>
<p>Number of sites</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>Intercept</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>Slope for land use</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>Simulated hare counts</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marc Kéry
</p>


<h3>Examples</h3>

<pre><code class='language-R'>str(dat &lt;- simDat11())      # Implicit default arguments

# Revert to "Poisson model-of-the-mean" 
# (Increase sample size to reduce sampling variability)
str(dat &lt;- simDat11(nSites = 1000, beta = 0)) 

</code></pre>

<hr>
<h2 id='simDat122'>Simulate data for Chapter 12.2: Overdispersed counts</h2><span id='topic+simDat122'></span>

<h3>Description</h3>

<p>Generate counts of hares in two landuse types
when there may be overdispersion relative to a Poisson
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simDat122(nSites = 50, alpha = log(2), beta = log(5) - log(2), sd = 0.5)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simDat122_+3A_nsites">nSites</code></td>
<td>
<p>Number of sites</p>
</td></tr>
<tr><td><code id="simDat122_+3A_alpha">alpha</code></td>
<td>
<p>Intercept</p>
</td></tr>
<tr><td><code id="simDat122_+3A_beta">beta</code></td>
<td>
<p>Slope for land use</p>
</td></tr>
<tr><td><code id="simDat122_+3A_sd">sd</code></td>
<td>
<p>Standard deviation for overdispersion</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of simulated data and parameters.
</p>
<table role = "presentation">
<tr><td><code>nSites</code></td>
<td>
<p>Number of sites</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>Intercept</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>Slope for land use</p>
</td></tr>
<tr><td><code>sd</code></td>
<td>
<p>Standard deviation for overdispersion</p>
</td></tr>
<tr><td><code>C_OD</code></td>
<td>
<p>Simulated hare counts with overdispersion</p>
</td></tr>
<tr><td><code>C_Poisson</code></td>
<td>
<p>Simulated hare counts without overdispersion</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marc Kéry
</p>


<h3>Examples</h3>

<pre><code class='language-R'>str(dat &lt;- simDat122())      # Implicit default arguments

# Much greater OD to emphasize patterns (also larger sample size)
str(dat &lt;- simDat122(nSites = 100, sd = 1))

# Revert to "Poisson model-of-the-mean" (i.e., without an effect of landuse type)
str(dat &lt;- simDat122(nSites = 100, beta = 0, sd = 1))

</code></pre>

<hr>
<h2 id='simDat123'>Simulate data for Chapter 12.3: Zero-inflated counts</h2><span id='topic+simDat123'></span>

<h3>Description</h3>

<p>Generate counts of hares in two landuse types when there may be 
zero-inflation (this is a simple general hierarchical model, see Chapters 19 and 19B in the book)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simDat123(nSites = 50, alpha = log(2), beta = log(5) - log(2), psi = 0.2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simDat123_+3A_nsites">nSites</code></td>
<td>
<p>Number of sites</p>
</td></tr>
<tr><td><code id="simDat123_+3A_alpha">alpha</code></td>
<td>
<p>Intercept</p>
</td></tr>
<tr><td><code id="simDat123_+3A_beta">beta</code></td>
<td>
<p>Slope for land use</p>
</td></tr>
<tr><td><code id="simDat123_+3A_psi">psi</code></td>
<td>
<p>Zero inflation parameter (probability of structural 0)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of simulated data and parameters.
</p>
<table role = "presentation">
<tr><td><code>nSites</code></td>
<td>
<p>Number of sites</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>Intercept</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>Slope for land use</p>
</td></tr>
<tr><td><code>psi</code></td>
<td>
<p>Zero inflation parameter</p>
</td></tr>
<tr><td><code>w</code></td>
<td>
<p>Indicator that count is not a structural 0</p>
</td></tr>
<tr><td><code>C</code></td>
<td>
<p>Simulated hare counts with zero inflation</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marc Kéry
</p>


<h3>Examples</h3>

<pre><code class='language-R'>str(dat &lt;- simDat123())      # Implicit default arguments

# Drop zero inflation (and make sample sizes bigger)
str(dat &lt;- simDat123(nSites = 1000, psi = 0))     # Note 0 % of the sites have structural zeroes now

# Half of all sites have structural zeroes
str(dat &lt;- simDat123(nSites = 1000, psi = 0.5))

# Revert to "model-of-the-mean" without zero inflation
# 0 % of the sites have structural zeroes
str(dat &lt;- simDat123(nSites = 1000, beta = 0, psi = 0))

# Revert to "model-of-the-mean" with zero inflation
# 50 % of the sites have structural zeroes
str(dat &lt;- simDat123(nSites = 1000, beta = 0, psi = 0.5))

</code></pre>

<hr>
<h2 id='simDat124'>Simulate data for Chapter 12.4: Counts with offsets</h2><span id='topic+simDat124'></span>

<h3>Description</h3>

<p>Generate counts of hares in two landuse types 
when study area size A varies and is used as an offset
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simDat124(nSites = 50, alpha = log(2), beta = log(5) - log(2))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simDat124_+3A_nsites">nSites</code></td>
<td>
<p>Number of sites</p>
</td></tr>
<tr><td><code id="simDat124_+3A_alpha">alpha</code></td>
<td>
<p>Intercept</p>
</td></tr>
<tr><td><code id="simDat124_+3A_beta">beta</code></td>
<td>
<p>Slope for land use</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of simulated data and parameters.
</p>
<table role = "presentation">
<tr><td><code>nSites</code></td>
<td>
<p>Number of sites</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>Intercept</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>Slope for land use</p>
</td></tr>
<tr><td><code>A</code></td>
<td>
<p>Site areas</p>
</td></tr>
<tr><td><code>C</code></td>
<td>
<p>Simulated hare counts</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marc Kéry
</p>


<h3>Examples</h3>

<pre><code class='language-R'>str(dat &lt;- simDat124())      # Implicit default arguments
str(dat &lt;- simDat124(nSites = 1000, beta = 0)) # "Model-of-the-mean" without effect of landuse
str(dat &lt;- simDat124(nSites = 100, alpha = log(2), beta = -2)) # Grassland better than arable

</code></pre>

<hr>
<h2 id='simDat13'>Simulate data for Chapter 13: Poisson ANCOVA</h2><span id='topic+simDat13'></span>

<h3>Description</h3>

<p>Simulate parasite load ~ size regressions in 3 populations of goldenring dragonflies
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simDat13(nPops = 3, nSample = 100, beta.vec = c(-2, 1, 2, 4, -2, -5))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simDat13_+3A_npops">nPops</code></td>
<td>
<p>Number of populations</p>
</td></tr>
<tr><td><code id="simDat13_+3A_nsample">nSample</code></td>
<td>
<p>Number of samples per population</p>
</td></tr>
<tr><td><code id="simDat13_+3A_beta.vec">beta.vec</code></td>
<td>
<p>Vector of regression coefficients</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of simulated data and parameters.
</p>
<table role = "presentation">
<tr><td><code>nPops</code></td>
<td>
<p>Number of populations</p>
</td></tr>
<tr><td><code>nSample</code></td>
<td>
<p>Number of samples per population</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>Vector of regression coefficients</p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p>Indicator for population number</p>
</td></tr>
<tr><td><code>pop</code></td>
<td>
<p>Population name (factor)</p>
</td></tr>
<tr><td><code>orig.length</code></td>
<td>
<p>Wing length, non-centered</p>
</td></tr>
<tr><td><code>wing.length</code></td>
<td>
<p>Wing length, centered</p>
</td></tr>
<tr><td><code>load</code></td>
<td>
<p>Simulated parasite loads</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marc Kéry
</p>


<h3>Examples</h3>

<pre><code class='language-R'>str(dat &lt;- simDat13())      # Implicit default arguments

# Revert to main-effects model with parallel lines on the log link scale
str(dat &lt;- simDat13(nSample = 100, beta.vec = c(-2, 1, 2, 4, 0, 0)))

# Same with less strong regression coefficient
str(dat &lt;- simDat13(nSample = 100, beta.vec = c(-2, 1, 2, 3, 0, 0)))

# Revert to simple linear Poisson regression: no effect of population (and less strong coefficient)
str(dat &lt;- simDat13(nSample = 100, beta.vec = c(-2, 0, 0, 3, 0, 0)))

# Revert to one-way ANOVA Poisson model: no effect of wing length
# (Choose larger sample size and greater differences in the intercepts to better show patterns)
str(dat &lt;- simDat13(nSample = 100, beta.vec = c(-1, 3, 5, 0, 0, 0)))

# Revert to Poisson "model-of-the-mean": no effects of either wing length or population
# Intercept chosen such that average parasite load is 10
str(dat &lt;- simDat13(nSample = 100, beta.vec = c(log(10), 0, 0, 0, 0, 0)))
mean(dat$load)        # Average is about 10

</code></pre>

<hr>
<h2 id='simDat14'>Simulate data for Chapter 14: Poisson GLMM</h2><span id='topic+simDat14'></span>

<h3>Description</h3>

<p>Simulate count ~ year regressions in 16 populations of red-backed shrikes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simDat14(
  nPops = 16,
  nYears = 30,
  mu.alpha = 3,
  sigma.alpha = 1,
  mu.beta = -2,
  sigma.beta = 0.6
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simDat14_+3A_npops">nPops</code></td>
<td>
<p>Number of populations</p>
</td></tr>
<tr><td><code id="simDat14_+3A_nyears">nYears</code></td>
<td>
<p>Number of years sampled in each population</p>
</td></tr>
<tr><td><code id="simDat14_+3A_mu.alpha">mu.alpha</code></td>
<td>
<p>Mean of random intercepts</p>
</td></tr>
<tr><td><code id="simDat14_+3A_sigma.alpha">sigma.alpha</code></td>
<td>
<p>SD of random intercepts</p>
</td></tr>
<tr><td><code id="simDat14_+3A_mu.beta">mu.beta</code></td>
<td>
<p>Mean of random slopes</p>
</td></tr>
<tr><td><code id="simDat14_+3A_sigma.beta">sigma.beta</code></td>
<td>
<p>SD of random slopes</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of simulated data and parameters.
</p>
<table role = "presentation">
<tr><td><code>nPops</code></td>
<td>
<p>Number of populations</p>
</td></tr>
<tr><td><code>nYears</code></td>
<td>
<p>Number of years sampled</p>
</td></tr>
<tr><td><code>mu.alpha</code></td>
<td>
<p>Mean of random intercepts</p>
</td></tr>
<tr><td><code>sigma.alpha</code></td>
<td>
<p>SD of random intercepts</p>
</td></tr>
<tr><td><code>mu.beta</code></td>
<td>
<p>Mean of random slopes</p>
</td></tr>
<tr><td><code>sigma.beta</code></td>
<td>
<p>SD of random slopes</p>
</td></tr>
<tr><td><code>pop</code></td>
<td>
<p>Population index</p>
</td></tr>
<tr><td><code>orig.year</code></td>
<td>
<p>Year values, non-scaled</p>
</td></tr>
<tr><td><code>year</code></td>
<td>
<p>Year values, scaled to be between 0 and 1</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>Random intercepts</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>Random slopes</p>
</td></tr>
<tr><td><code>C</code></td>
<td>
<p>Simulated shrike counts</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marc Kéry
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(lattice)
str(dat &lt;- simDat14())
xyplot(dat$C ~ dat$orig.year | dat$pop, ylab = "Red-backed shrike counts", xlab = "Year", pch = 16,
       cex = 1.2, col = rgb(0, 0, 0, 0.4), 
       main = 'Realized population trends\n(random-coefficients model)') # works

# Revert to random intercept model. Increased sigma.alpha to emphasize the random intercepts part
str(dat &lt;- simDat14(nPops = 16, sigma.alpha = 1, sigma.beta = 0))
xyplot(dat$C ~ dat$orig.year | dat$pop, ylab = "Red-backed shrike counts", xlab = "Year",
       pch = 16, cex = 1.2, col = rgb(0, 0, 0, 0.4), 
       main = 'Realized population trends (random-intercepts model)')

# Revert to random-effects one-way Poisson ANOVA model: random intercepts, but zero slopes
str(dat &lt;- simDat14(nPops = 16, sigma.alpha = 1, mu.beta = 0, sigma.beta = 0))
xyplot(dat$C ~ dat$orig.year | dat$pop, ylab = "Red-backed shrike counts", xlab = "Year",
       pch = 16, cex = 1.2, col = rgb(0, 0, 0, 0.4), 
       main = 'Realized population trends
       (random-effects, one-way Poisson ANOVA model)')

# Revert to simple log-linear Poisson regression (no effects of pop on intercepts or slopes)
str(dat &lt;- simDat14(nPops = 16, sigma.alpha = 0, sigma.beta = 0))
xyplot(dat$C ~ dat$orig.year | dat$pop, ylab = "Red-backed shrike counts", 
       xlab = "Year", pch = 16, cex = 1.2, col = rgb(0, 0, 0, 0.4), 
       main = 'Realized population trends\n(simple log-linear Poisson regression)')

# Revert to Poisson "model-of-the-mean": no effects of either population or body length
str(dat &lt;- simDat14(nPops = 16, sigma.alpha = 0, mu.beta = 0, sigma.beta = 0))
xyplot(dat$C ~ dat$orig.year | dat$pop, ylab = "Red-backed shrike counts", 
       xlab = "Year", pch = 16, cex = 1.2, col = rgb(0, 0, 0, 0.4), 
       main = 'Realized population trends\n(Poisson "model-of-the-mean")')

</code></pre>

<hr>
<h2 id='simDat15'>Simulate data for Chapter 15: Comparing two groups of binomial counts</h2><span id='topic+simDat15'></span>

<h3>Description</h3>

<p>Generate presence/absence data for two gentian species (Bernoulli variant)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simDat15(N = 50, theta.cr = 12/50, theta.ch = 38/50)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simDat15_+3A_n">N</code></td>
<td>
<p>Number of sites</p>
</td></tr>
<tr><td><code id="simDat15_+3A_theta.cr">theta.cr</code></td>
<td>
<p>Probability of presence for cross-leaved gentian</p>
</td></tr>
<tr><td><code id="simDat15_+3A_theta.ch">theta.ch</code></td>
<td>
<p>Probability of presence for chiltern gentian</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of simulated data and parameters.
</p>
<table role = "presentation">
<tr><td><code>N</code></td>
<td>
<p>Number of sites</p>
</td></tr>
<tr><td><code>theta.cr</code></td>
<td>
<p>Probability for cross-leaved gentian</p>
</td></tr>
<tr><td><code>theta.ch</code></td>
<td>
<p>Probability for chiltern gentian</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>Simulated presence/absence data</p>
</td></tr>
<tr><td><code>species.long</code></td>
<td>
<p>Species indicator (longform), 1 = chiltern</p>
</td></tr>
<tr><td><code>C</code></td>
<td>
<p>Aggregated presence/absence data</p>
</td></tr>
<tr><td><code>species</code></td>
<td>
<p>Species indicator for aggregated data</p>
</td></tr>
<tr><td><code>chiltern</code></td>
<td>
<p>Effect of chiltern (difference in species intercepts)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marc Kéry
</p>


<h3>Examples</h3>

<pre><code class='language-R'>str(dat &lt;- simDat15())      # Implicit default arguments

# Revert to "Binomial model-of-the-mean"
# (Increase sample size to reduce sampling variability)
str(dat &lt;- simDat15(N = 100, theta.cr = 40/100, theta.ch = 40/100)) 

</code></pre>

<hr>
<h2 id='simDat16'>Simulate data for Chapter 16: Binomial ANCOVA</h2><span id='topic+simDat16'></span>

<h3>Description</h3>

<p>Simulate Number black individuals ~ wetness regressions in adders in 3 regions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simDat16(nRegion = 3, nSite = 10, beta.vec = c(-4, 1, 2, 6, 2, -5))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simDat16_+3A_nregion">nRegion</code></td>
<td>
<p>Number of regions</p>
</td></tr>
<tr><td><code id="simDat16_+3A_nsite">nSite</code></td>
<td>
<p>Number of sites per region</p>
</td></tr>
<tr><td><code id="simDat16_+3A_beta.vec">beta.vec</code></td>
<td>
<p>Vector of regression coefficients</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of simulated data and parameters.
</p>
<table role = "presentation">
<tr><td><code>nRegion</code></td>
<td>
<p>Number of regions</p>
</td></tr>
<tr><td><code>nSite</code></td>
<td>
<p>Number of sites per region</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>Vector of regression coefficients</p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p>Indicator for region number</p>
</td></tr>
<tr><td><code>region</code></td>
<td>
<p>Region name (factor)</p>
</td></tr>
<tr><td><code>wetness</code></td>
<td>
<p>Wetness covariate</p>
</td></tr>
<tr><td><code>N</code></td>
<td>
<p>Number of adders captured at each site</p>
</td></tr>
<tr><td><code>C</code></td>
<td>
<p>Number of black adders captured at each site</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marc Kéry
</p>


<h3>Examples</h3>

<pre><code class='language-R'>str(dat &lt;- simDat16())      # Implicit default arguments

# Revert to main-effects model with parallel lines on the logit link scale
# (also larger sample size to better see patterns)
str(dat &lt;- simDat16(nSite = 100, beta.vec = c(-4, 1, 2, 6, 0, 0)))

# Same with less strong logistic regression coefficient
str(dat &lt;- simDat16(nSite = 100, beta.vec = c(-4, 1, 2, 3, 0, 0)))

# Revert to simple logit-linear binomial regression: no effect of pop (and weaker coefficient)
str(dat &lt;- simDat16(nSite = 100, beta.vec = c(-4, 0, 0, 3, 0, 0)))

# Revert to one-way ANOVA binomial model: no effect of wetness
# (Choose greater differences in the intercepts to better show patterns)
str(dat &lt;- simDat16(nSite = 100, beta.vec = c(-2, 2, 3, 0, 0, 0)))

# Revert to binomial "model-of-the-mean": no effects of either wetness or population
# Intercept chosen such that average proportion of black adders is 0.6
str(dat &lt;- simDat16(nSite = 100, beta.vec = c(qlogis(0.6), 0, 0, 0, 0, 0)))
mean(dat$C / dat$N)        # Average is about 0.6

</code></pre>

<hr>
<h2 id='simDat17'>Simulate data for Chapter 17: Binomial GLMM</h2><span id='topic+simDat17'></span>

<h3>Description</h3>

<p>Simulate Number of successful pairs ~ precipitation regressions in 16 populations of woodchat shrikes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simDat17(
  nPops = 16,
  nYears = 10,
  mu.alpha = 0,
  mu.beta = -2,
  sigma.alpha = 1,
  sigma.beta = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simDat17_+3A_npops">nPops</code></td>
<td>
<p>Number of populations</p>
</td></tr>
<tr><td><code id="simDat17_+3A_nyears">nYears</code></td>
<td>
<p>Number of years sampled in each population</p>
</td></tr>
<tr><td><code id="simDat17_+3A_mu.alpha">mu.alpha</code></td>
<td>
<p>Mean of random intercepts</p>
</td></tr>
<tr><td><code id="simDat17_+3A_mu.beta">mu.beta</code></td>
<td>
<p>Mean of random slopes</p>
</td></tr>
<tr><td><code id="simDat17_+3A_sigma.alpha">sigma.alpha</code></td>
<td>
<p>SD of random intercepts</p>
</td></tr>
<tr><td><code id="simDat17_+3A_sigma.beta">sigma.beta</code></td>
<td>
<p>SD of random slopes</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of simulated data and parameters.
</p>
<table role = "presentation">
<tr><td><code>nPops</code></td>
<td>
<p>Number of populations</p>
</td></tr>
<tr><td><code>nYears</code></td>
<td>
<p>Number of years sampled</p>
</td></tr>
<tr><td><code>mu.alpha</code></td>
<td>
<p>Mean of random intercepts</p>
</td></tr>
<tr><td><code>sigma.alpha</code></td>
<td>
<p>SD of random intercepts</p>
</td></tr>
<tr><td><code>mu.beta</code></td>
<td>
<p>Mean of random slopes</p>
</td></tr>
<tr><td><code>sigma.beta</code></td>
<td>
<p>SD of random slopes</p>
</td></tr>
<tr><td><code>pop</code></td>
<td>
<p>Population index</p>
</td></tr>
<tr><td><code>precip</code></td>
<td>
<p>Precipitation covariate values</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>Random intercepts</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>Random slopes</p>
</td></tr>
<tr><td><code>N</code></td>
<td>
<p>Number of shrike pairs at each site</p>
</td></tr>
<tr><td><code>C</code></td>
<td>
<p>Number of successful shrike pairs at each site</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marc Kéry
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(lattice)
str(dat &lt;- simDat17())      # Implicit default arguments (DOES NOT PRODUCE PLOT FOR SOME REASON)
xyplot(dat$C/dat$N ~ dat$precip | dat$pop, ylab = "Realized woodchat shrike breeding success ", 
       xlab = "Spring precipitation index", main = "Realized breeding success", pch = 16, cex = 1.2,
      col = rgb(0, 0, 0, 0.4))

# Revert to random intercept model. Increased sigma.alpha to emphasize the random intercepts part
str(dat &lt;- simDat17(nPops = 16, sigma.alpha = 1, sigma.beta = 0))
xyplot(dat$C/dat$N ~ dat$precip | dat$pop, ylab = "Realized woodchat shrike breeding success ", 
       xlab = "Spring precipitation index", 
       main = "Realized breeding success (random-intercepts model)",
      pch = 16, cex = 1.2, col = rgb(0, 0, 0, 0.4))

# Revert to random-effects one-way binomial ANOVA model: random intercepts, but zero slopes
str(dat &lt;- simDat17(nPops = 16, sigma.alpha = 1, mu.beta = 0, sigma.beta = 0))
xyplot(dat$C/dat$N ~ dat$precip | dat$pop, ylab = "Realized woodchat shrike breeding success ", 
       xlab = "Spring precipitation index",
       main = "Realized breeding success (random-effects,
       one-way binomial ANOVA model)", 
       pch = 16, cex = 1.2, col = rgb(0, 0, 0, 0.4))

# Revert to simple log-linear binomial (i.e., logistic) regression
#   (= no effects of pop on either intercepts or slopes)
str(dat &lt;- simDat17(nPops = 16, sigma.alpha = 0, sigma.beta = 0))
xyplot(dat$C/dat$N ~ dat$precip | dat$pop, ylab = "Realized woodchat shrike breeding success ", 
       xlab = "Spring precipitation index", 
       main = "Realized breeding success\n(simple logistic regression model)", 
       pch = 16, cex = 1.2, col = rgb(0, 0, 0, 0.4))

# Revert to binomial "model-of-the-mean": no effects of either population or precipitation
str(dat &lt;- simDat17(nPops = 16, sigma.alpha = 0, mu.beta = 0, sigma.beta = 0))
xyplot(dat$C/dat$N ~ dat$precip | dat$pop, ylab = "Realized woodchat shrike breeding success ", 
       xlab = "Spring precipitation index", 
       main = "Realized breeding success (binomial 'model-of-the-mean')",
      pch = 16, cex = 1.2, col = rgb(0, 0, 0, 0.4))

</code></pre>

<hr>
<h2 id='simDat18'>Simulate data for Chapter 18: model selection</h2><span id='topic+simDat18'></span>

<h3>Description</h3>

<p>Simulate counts of rattlesnakes in Virginia
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simDat18(
  nSites = 100,
  beta1.vec = c(1, 0.2, 0.5, 1, -1),
  ncov2 = 50,
  beta2.vec = rnorm(50, 0, 0),
  show.plot = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simDat18_+3A_nsites">nSites</code></td>
<td>
<p>Sample size (number of snakes)</p>
</td></tr>
<tr><td><code id="simDat18_+3A_beta1.vec">beta1.vec</code></td>
<td>
<p>Values of log-linear intercept and coefs of rock, oak, 
and chip (linear and squared), in this order</p>
</td></tr>
<tr><td><code id="simDat18_+3A_ncov2">ncov2</code></td>
<td>
<p>Number of 'other' covariates</p>
</td></tr>
<tr><td><code id="simDat18_+3A_beta2.vec">beta2.vec</code></td>
<td>
<p>Values of coefs of the 'other' covariates (all continuous).
All at zero by default</p>
</td></tr>
<tr><td><code id="simDat18_+3A_show.plot">show.plot</code></td>
<td>
<p>Switch to turn on or off plotting. Set to 'FALSE' when running sims</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of simulated data and parameters.
</p>
<table role = "presentation">
<tr><td><code>nSites</code></td>
<td>
<p>Sample size</p>
</td></tr>
<tr><td><code>rock</code></td>
<td>
<p>Rock covariate vector</p>
</td></tr>
<tr><td><code>oak</code></td>
<td>
<p>Oak covariate vector</p>
</td></tr>
<tr><td><code>chip1</code></td>
<td>
<p>Chip covariate vector</p>
</td></tr>
<tr><td><code>chip2</code></td>
<td>
<p>Chip^2 covariate vector</p>
</td></tr>
<tr><td><code>Xrest</code></td>
<td>
<p>Array of &quot;other&quot; covariate values</p>
</td></tr>
<tr><td><code>beta1.vec</code></td>
<td>
<p>Parameter values for intercept, rock, oak, chip, chip^2</p>
</td></tr>
<tr><td><code>ncov2</code></td>
<td>
<p>Number of &quot;other&quot; covariates</p>
</td></tr>
<tr><td><code>beta2.vec</code></td>
<td>
<p>Vector of coefficient values for &quot;other&quot; covariates</p>
</td></tr>
<tr><td><code>C</code></td>
<td>
<p>Simulated rattlesnake counts</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marc Kéry
</p>


<h3>Examples</h3>

<pre><code class='language-R'>str(dat &lt;- simDat18())  # With default arguments

#### First variant of data simulation: beta1.vec is identical, beta2.vec is not
# Variant B: execute when you want to play with a small data set
set.seed(18)
trainDat &lt;- simDat18(nSites = 50, beta1.vec = c(1, 0.2, 0.5, 1, -1), ncov2 = 10,
                     beta2.vec = rnorm(10, 0, 0.1), show.plot = TRUE)
testDat &lt;- simDat18(nSites = 50, beta1.vec = c(1, 0.2, 0.5, 1, -1), ncov2 = 10,
                    beta2.vec = rnorm(10, 0, 0.1), show.plot = TRUE)
# Note how relatively different the two realizations of the SAME process are  

#### Second variant of data simulation: both beta1.vec and beta2.vec are identical

# Variant B: execute when you want to play with a small data set
set.seed(18)
beta2.vec &lt;- rnorm(10, 0, 0.1)
trainDat &lt;- simDat18(nSites = 50, beta1.vec = c(2, 0.2, 0.5, 1, -1), ncov2 = 10,
                     beta2.vec = beta2.vec, show.plot = TRUE)
testDat &lt;- simDat18(nSites = 50, beta1.vec = c(2, 0.2, 0.5, 1, -1), ncov2 = 10,
                    beta2.vec = beta2.vec, show.plot = TRUE)
# Note how relatively different the two realizations of the SAME process are

</code></pre>

<hr>
<h2 id='simDat19'>Simulate data for Chapter 19: Occupancy model</h2><span id='topic+simDat19'></span>

<h3>Description</h3>

<p>Simulate detection/nondetection data of Chiltern gentians
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simDat19(
  nSites = 150,
  nVisits = 3,
  alpha.occ = 0,
  beta.occ = 2,
  alpha.p = 0,
  beta.p = -3
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simDat19_+3A_nsites">nSites</code></td>
<td>
<p>Number of sites</p>
</td></tr>
<tr><td><code id="simDat19_+3A_nvisits">nVisits</code></td>
<td>
<p>Number of replicate visits per site</p>
</td></tr>
<tr><td><code id="simDat19_+3A_alpha.occ">alpha.occ</code></td>
<td>
<p>Occupancy intercept</p>
</td></tr>
<tr><td><code id="simDat19_+3A_beta.occ">beta.occ</code></td>
<td>
<p>Occupancy slope</p>
</td></tr>
<tr><td><code id="simDat19_+3A_alpha.p">alpha.p</code></td>
<td>
<p>Detection probability intercept</p>
</td></tr>
<tr><td><code id="simDat19_+3A_beta.p">beta.p</code></td>
<td>
<p>Detection probability slope</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of simulated data and parameters.
</p>
<table role = "presentation">
<tr><td><code>nSites</code></td>
<td>
<p>Number of sites</p>
</td></tr>
<tr><td><code>nVisits</code></td>
<td>
<p>Number replicate visits per site</p>
</td></tr>
<tr><td><code>alpha.occ</code></td>
<td>
<p>Occupancy intercept</p>
</td></tr>
<tr><td><code>beta.occ</code></td>
<td>
<p>Occupancy slope</p>
</td></tr>
<tr><td><code>alpha.p</code></td>
<td>
<p>Detection probability intercept</p>
</td></tr>
<tr><td><code>beta.p</code></td>
<td>
<p>Detection probability slope</p>
</td></tr>
<tr><td><code>humidity</code></td>
<td>
<p>Humidity covariate</p>
</td></tr>
<tr><td><code>occ.prob</code></td>
<td>
<p>Probability of occupancy at each site</p>
</td></tr>
<tr><td><code>z</code></td>
<td>
<p>True occupancy state at each site</p>
</td></tr>
<tr><td><code>true_Nz</code></td>
<td>
<p>True number of occupied sites</p>
</td></tr>
<tr><td><code>lp</code></td>
<td>
<p>Linear predictor for detection</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>Probability of detection at each site</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>Simulated detection/non-detection data</p>
</td></tr>
<tr><td><code>obs_Nz</code></td>
<td>
<p>Observed number of occupied sites</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marc Kéry
</p>


<h3>Examples</h3>

<pre><code class='language-R'>str(dat &lt;- simDat19())             # Implicit default arguments
str(dat &lt;- simDat19(nSites = 150, nVisits = 3, alpha.occ = 0, beta.occ = 2,
  alpha.p = 0, beta.p = -3))       # Explicit default arguments
str(dat &lt;- simDat19(nSites = 500)) # More sites
str(dat &lt;- simDat19(nVisits = 1))  # Single-visit data
str(dat &lt;- simDat19(nVisits = 20)) # 20 visits, will yield cumulative detection prob of about 1
str(dat &lt;- simDat19(alpha.occ = 2))# Much higher occupancy
str(dat &lt;- simDat19(beta.occ = 0)) # No effect of humidity on occupancy
str(dat &lt;- simDat19(beta.p = 3))   # Positive effect of humidity on detection
str(dat &lt;- simDat19(beta.p = 0))   # No effect of humidity on detection

</code></pre>

<hr>
<h2 id='simDat19B'>Simulate data for Chapter 19B: Binomial N-mixture Model</h2><span id='topic+simDat19B'></span>

<h3>Description</h3>

<p>Function simulates replicated count data as used in the bonus Chapter 19B
in the ASM book. Abundance, detection and count data simulation 
is undertaken for the approximate elevation of the actual sample of survey
sites in the Swiss breeding bird survey &quot;Monitoring Häufige Brutvögel&quot; (MHB).
Note there is no nSites argument, since this is given in the MHB survey at 267.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simDat19B(
  nVisits = 3,
  alpha.lam = -3,
  beta1.lam = 8.5,
  beta2.lam = -3.5,
  alpha.p = 2,
  beta.p = -2,
  show.plot = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simDat19B_+3A_nvisits">nVisits</code></td>
<td>
<p>Number of occasions, or visits per site</p>
</td></tr>
<tr><td><code id="simDat19B_+3A_alpha.lam">alpha.lam</code></td>
<td>
<p>Intercept of the regression of log expected abundance on scaled elevation</p>
</td></tr>
<tr><td><code id="simDat19B_+3A_beta1.lam">beta1.lam</code></td>
<td>
<p>Linear effect of scaled elevation on log expected abundance</p>
</td></tr>
<tr><td><code id="simDat19B_+3A_beta2.lam">beta2.lam</code></td>
<td>
<p>Quadratic effect of scaled elevation on log expected abundance</p>
</td></tr>
<tr><td><code id="simDat19B_+3A_alpha.p">alpha.p</code></td>
<td>
<p>Intercept of the regression of logit detection on scaled elevation</p>
</td></tr>
<tr><td><code id="simDat19B_+3A_beta.p">beta.p</code></td>
<td>
<p>Linear effect of scaled elevation on logit detection</p>
</td></tr>
<tr><td><code id="simDat19B_+3A_show.plot">show.plot</code></td>
<td>
<p>Show plot of simulated output?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of simulated data and parameters.
</p>
<table role = "presentation">
<tr><td><code>nSites</code></td>
<td>
<p>Number of sites</p>
</td></tr>
<tr><td><code>nVisits</code></td>
<td>
<p>Number of visits to each site</p>
</td></tr>
<tr><td><code>alpha.lam</code></td>
<td>
<p>Abundance intercept</p>
</td></tr>
<tr><td><code>beta1.lam</code></td>
<td>
<p>Linear effect of elevation on abundance</p>
</td></tr>
<tr><td><code>beta2.lam</code></td>
<td>
<p>Quadratic effect of elevation on abundance</p>
</td></tr>
<tr><td><code>alpha.p</code></td>
<td>
<p>Detection intercept</p>
</td></tr>
<tr><td><code>beta.p</code></td>
<td>
<p>Linear effect of elevation on detection</p>
</td></tr>
<tr><td><code>mhbElev</code></td>
<td>
<p>Elevation covariate values</p>
</td></tr>
<tr><td><code>mhbElevScaled</code></td>
<td>
<p>Scaled elevation covariate values</p>
</td></tr>
<tr><td><code>lambda</code></td>
<td>
<p>Expected abundance for each site</p>
</td></tr>
<tr><td><code>N</code></td>
<td>
<p>True abundance at each site</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>Detection probability at each site</p>
</td></tr>
<tr><td><code>C</code></td>
<td>
<p>Observed repeated counts at each site</p>
</td></tr>
<tr><td><code>nocc.true</code></td>
<td>
<p>True number of occupied sites</p>
</td></tr>
<tr><td><code>nocc.app</code></td>
<td>
<p>Apparent number of occupied sites</p>
</td></tr>
<tr><td><code>psi</code></td>
<td>
<p>True proportion of occupied sites</p>
</td></tr>
<tr><td><code>psi.app</code></td>
<td>
<p>Apparent proportion of occupied sites</p>
</td></tr>
<tr><td><code>opt.elev.true</code></td>
<td>
<p>Optimal elevation value</p>
</td></tr>
<tr><td><code>totalN.true</code></td>
<td>
<p>True total population size</p>
</td></tr>
<tr><td><code>totalN.app</code></td>
<td>
<p>Apparent total population size</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marc Kéry
</p>


<h3>Examples</h3>

<pre><code class='language-R'># With implicit default function argument values
str(simDat19B())

# With explicit function argument values
str(simDat19B(nVisits = 3, alpha.lam = -3, beta1.lam = 8.5, beta2.lam = -3.5, 
    alpha.p = 2, beta.p = -2, show.plot = TRUE))

# No plots
str(simDat19B(show.plot = FALSE))

# More visits
str(simDat19B(nVisits = 10))

# A single visit at each site
str(simDat19B(nVisits = 1))

# Greater abundance
str(simDat19B(alpha.lam = 0))

# Much rarer abundance
str(simDat19B(alpha.lam = -5))

# No quadratic effect of elevation on abundance (only a linear one)
str(simDat19B(beta2.lam = 0))

# No effect of elevation at all on abundance
str(simDat19B(beta1.lam = 0, beta2.lam = 0))

# Higher detection probability (intercept at 0.9)
str(simDat19B(alpha.p = qlogis(0.9), beta.p = -2))

# Higher detection probability (intercept at 0.9) and no effect of elevation
str(simDat19B(alpha.p = qlogis(0.9), beta.p = 0))

# Perfect detection (p = 1)
str(simDat19B(alpha.p = 1000))

# Positive effect of elevation on detection probability (and lower intercept)
str(simDat19B(alpha.p = -2, beta.p = 2))

</code></pre>

<hr>
<h2 id='simDat20'>Simulate data for Chapter 20: Integrated model</h2><span id='topic+simDat20'></span>

<h3>Description</h3>

<p>Simulate three count datasets under different data collection conditions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simDat20(
  nsites1 = 500,
  nsites2 = 1000,
  nsites3 = 2000,
  mean.lam = 2,
  beta = -2
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simDat20_+3A_nsites1">nsites1</code></td>
<td>
<p>Number of sites in regular count dataset</p>
</td></tr>
<tr><td><code id="simDat20_+3A_nsites2">nsites2</code></td>
<td>
<p>Number of sites in zero-truncated count dataset</p>
</td></tr>
<tr><td><code id="simDat20_+3A_nsites3">nsites3</code></td>
<td>
<p>Number of sites in detection/non-detection dataset</p>
</td></tr>
<tr><td><code id="simDat20_+3A_mean.lam">mean.lam</code></td>
<td>
<p>Mean site abundance</p>
</td></tr>
<tr><td><code id="simDat20_+3A_beta">beta</code></td>
<td>
<p>Slope for elevation covariate</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of simulated data and parameters.
</p>
<table role = "presentation">
<tr><td><code>nsites1</code></td>
<td>
<p>Number of sites in regular count dataset</p>
</td></tr>
<tr><td><code>nsites2</code></td>
<td>
<p>Number of sites in zero-truncated count dataset</p>
</td></tr>
<tr><td><code>nsites3</code></td>
<td>
<p>Number of sites in detection/non-detection dataset</p>
</td></tr>
<tr><td><code>mean.lam</code></td>
<td>
<p>Mean site abundance</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>Slope for elevation covariate</p>
</td></tr>
<tr><td><code>C1</code></td>
<td>
<p>Simulated regular counts from dataset 1</p>
</td></tr>
<tr><td><code>C2</code></td>
<td>
<p>Simulated regular counts from dataset 2</p>
</td></tr>
<tr><td><code>C3</code></td>
<td>
<p>Simulated regular counts from dataset 3</p>
</td></tr>
<tr><td><code>ztC2</code></td>
<td>
<p>Simulated zero-truncated counts from dataset 2</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>Simulated detection/non-detection data from dataset 3</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marc Kéry
</p>


<h3>Examples</h3>

<pre><code class='language-R'>str(dat &lt;- simDat20())             # Implicit default arguments

# Revert to an 'integrated Poisson/binomial model-of-the-mean': no effect of elevation on abundance
str(dat &lt;- simDat20(nsites1 = 500, nsites2 = 1000, nsites3 = 2000, mean.lam = 2, beta = 0))

</code></pre>

<hr>
<h2 id='simDat4'>Simulate data for Chapter 4: Model of the mean</h2><span id='topic+simDat4'></span>

<h3>Description</h3>

<p>Simulate body mass measurements for n peregrine falcons
from a normal distribution with population mean = 'mean' and population sd = 'sd'
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simDat4(n = 10, mean = 600, sd = 30)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simDat4_+3A_n">n</code></td>
<td>
<p>The sample size</p>
</td></tr>
<tr><td><code id="simDat4_+3A_mean">mean</code></td>
<td>
<p>Population mean</p>
</td></tr>
<tr><td><code id="simDat4_+3A_sd">sd</code></td>
<td>
<p>Population standard deviation</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of simulated data and parameters.
</p>
<table role = "presentation">
<tr><td><code>n</code></td>
<td>
<p>Sample size</p>
</td></tr>
<tr><td><code>mean</code></td>
<td>
<p>Population mean</p>
</td></tr>
<tr><td><code>sd</code></td>
<td>
<p>Population SD</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>Simulated peregrine mass measurements</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marc Kéry
</p>


<h3>Examples</h3>

<pre><code class='language-R'>str(dat &lt;- simDat4())          # Implicit default arguments
str(dat &lt;- simDat4(n = 10^6))  # More than the world population of peregrines
str(dat &lt;- simDat4(n = 10, mean = 900, sd = 40))  # Simulate 10 female peregrines

</code></pre>

<hr>
<h2 id='simDat5'>Simulate data for Chapter 5: Simple linear regression</h2><span id='topic+simDat5'></span>

<h3>Description</h3>

<p>Simulate percent occupancy population trajectory of Swiss Wallcreepers
from a normal distribution. Note that other choices of arguments may
lead to values for x and y that no longer make sense in the light of
the story in Chapter 5 (i.e., where y is a percentage), but will
still be OK for the statistical model introduced in that chapter.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simDat5(n = 16, a = 40, b = -0.5, sigma2 = 25)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simDat5_+3A_n">n</code></td>
<td>
<p>The sample size</p>
</td></tr>
<tr><td><code id="simDat5_+3A_a">a</code></td>
<td>
<p>Value for the intercept</p>
</td></tr>
<tr><td><code id="simDat5_+3A_b">b</code></td>
<td>
<p>Value for the slope</p>
</td></tr>
<tr><td><code id="simDat5_+3A_sigma2">sigma2</code></td>
<td>
<p>Value for the residual variance</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of simulated data and parameters.
</p>
<table role = "presentation">
<tr><td><code>n</code></td>
<td>
<p>Sample size</p>
</td></tr>
<tr><td><code>a</code></td>
<td>
<p>Intercept</p>
</td></tr>
<tr><td><code>b</code></td>
<td>
<p>Slope</p>
</td></tr>
<tr><td><code>sd</code></td>
<td>
<p>Residual SD</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>Simulated wallcreeper occupancy probabilities</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marc Kéry
</p>


<h3>Examples</h3>

<pre><code class='language-R'>str(dat &lt;- simDat5())        # Implicit default arguments
str(dat &lt;- simDat5(b = 0))    # Stable population (this is a de-facto "model-of-the-mean")
str(dat &lt;- simDat5(b = 0.5)) # Expected increase

</code></pre>

<hr>
<h2 id='simDat62'>Simulate data for Chapter 6.2: Two groups with equal variance</h2><span id='topic+simDat62'></span>

<h3>Description</h3>

<p>Simulate wingspan measurements in female and male peregrines with equal variance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simDat62(n1 = 60, n2 = 40, mu1 = 105, mu2 = 77.5, sigma = 2.75)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simDat62_+3A_n1">n1</code></td>
<td>
<p>The sample size of females</p>
</td></tr>
<tr><td><code id="simDat62_+3A_n2">n2</code></td>
<td>
<p>The sample size of males</p>
</td></tr>
<tr><td><code id="simDat62_+3A_mu1">mu1</code></td>
<td>
<p>The population mean males</p>
</td></tr>
<tr><td><code id="simDat62_+3A_mu2">mu2</code></td>
<td>
<p>The population mean females</p>
</td></tr>
<tr><td><code id="simDat62_+3A_sigma">sigma</code></td>
<td>
<p>The standard deviation for both groups</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of simulated data and parameters.
</p>
<table role = "presentation">
<tr><td><code>n1</code></td>
<td>
<p>Female sample size</p>
</td></tr>
<tr><td><code>n2</code></td>
<td>
<p>Male sample size</p>
</td></tr>
<tr><td><code>mu1</code></td>
<td>
<p>Female mean</p>
</td></tr>
<tr><td><code>mu2</code></td>
<td>
<p>Male mean</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>Difference in wingspan mean between sexes</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>Standard deviation for both groups</p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p>Indicator variable for sex, 1 = male</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>Simulated wingspan data</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marc Kéry
</p>


<h3>Examples</h3>

<pre><code class='language-R'>str(dat &lt;- simDat62())      # Implicit default arguments
str(dat &lt;- simDat62(n1 = 1000, n2 = 10000)) # Much larger sample sizes

# Revert to "model-of-the-mean" (with larger sample size)
str(dat &lt;- simDat62(n1 = 10000, n2 = 10000, mu1 = 105, mu2 = 105))

</code></pre>

<hr>
<h2 id='simDat63'>Simulate data for Chapter 6.3: Two groups with unequal variance</h2><span id='topic+simDat63'></span>

<h3>Description</h3>

<p>Simulate wingspan measurements in female and male peregrines with unequal variance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simDat63(n1 = 60, n2 = 40, mu1 = 105, mu2 = 77.5, sigma1 = 3, sigma2 = 2.5)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simDat63_+3A_n1">n1</code></td>
<td>
<p>The sample size of females</p>
</td></tr>
<tr><td><code id="simDat63_+3A_n2">n2</code></td>
<td>
<p>The sample size of males</p>
</td></tr>
<tr><td><code id="simDat63_+3A_mu1">mu1</code></td>
<td>
<p>The population mean males</p>
</td></tr>
<tr><td><code id="simDat63_+3A_mu2">mu2</code></td>
<td>
<p>The population mean females</p>
</td></tr>
<tr><td><code id="simDat63_+3A_sigma1">sigma1</code></td>
<td>
<p>The standard deviation for females</p>
</td></tr>
<tr><td><code id="simDat63_+3A_sigma2">sigma2</code></td>
<td>
<p>The standard deviation for males</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of simulated data and parameters.
</p>
<table role = "presentation">
<tr><td><code>n1</code></td>
<td>
<p>Female sample size</p>
</td></tr>
<tr><td><code>n2</code></td>
<td>
<p>Male sample size</p>
</td></tr>
<tr><td><code>mu1</code></td>
<td>
<p>Female mean</p>
</td></tr>
<tr><td><code>mu2</code></td>
<td>
<p>Male mean</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>Difference in wingspan mean between sexes</p>
</td></tr>
<tr><td><code>sigma1</code></td>
<td>
<p>Standard deviation for females</p>
</td></tr>
<tr><td><code>sigma2</code></td>
<td>
<p>Standard deviation for males</p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p>Indicator variable for sex, 1 = male</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>Simulated wingspan data</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marc Kéry
</p>


<h3>Examples</h3>

<pre><code class='language-R'>str(dat &lt;- simDat63())            # Implicit default arguments
str(dat &lt;- simDat63(sigma1 = 5, sigma2 = 1)) # Very unequal variances

# Much larger sample sizes and larger difference in residual variation
str(dat &lt;- simDat63(n1 = 10000, n2 = 10000, sigma1 = 5, sigma2 = 2))

# Revert to model with homoscedasticity
str(dat &lt;- simDat63(n1 = 10000, n2 = 10000, sigma1 = 5, sigma2 = 5))

# Revert to "model-of-the-mean" (with larger sample size)
str(dat &lt;- simDat63(n1 = 10000, n2 = 10000, mu1 = 105, mu2 = 105, sigma1 = 5, sigma2 = 5))

</code></pre>

<hr>
<h2 id='simDat72'>Simulate data for Chapter 7.2: ANOVA with fixed effects of population</h2><span id='topic+simDat72'></span>

<h3>Description</h3>

<p>Simulate snout-vent length measurements of nSample smooth snakes in each of nPops populations
Data are simulated under the assumptions of a model with fixed effects of populations
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simDat72(nPops = 5, nSample = 10, pop.means = c(50, 40, 45, 55, 60), sigma = 5)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simDat72_+3A_npops">nPops</code></td>
<td>
<p>Number of populations</p>
</td></tr>
<tr><td><code id="simDat72_+3A_nsample">nSample</code></td>
<td>
<p>Samples from each population</p>
</td></tr>
<tr><td><code id="simDat72_+3A_pop.means">pop.means</code></td>
<td>
<p>Vector of mean length for each population</p>
</td></tr>
<tr><td><code id="simDat72_+3A_sigma">sigma</code></td>
<td>
<p>Value for the residual standard deviation</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of simulated data and parameters.
</p>
<table role = "presentation">
<tr><td><code>nPops</code></td>
<td>
<p>Number of populations</p>
</td></tr>
<tr><td><code>nSample</code></td>
<td>
<p>Number of samples per population</p>
</td></tr>
<tr><td><code>pop.means</code></td>
<td>
<p>Population means</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>Residual SD</p>
</td></tr>
<tr><td><code>pop</code></td>
<td>
<p>Indicator for population number</p>
</td></tr>
<tr><td><code>eps</code></td>
<td>
<p>Simulated residuals</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>Simulated lengths</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marc Kéry
</p>


<h3>Examples</h3>

<pre><code class='language-R'>str(dat &lt;- simDat72())      # Implicit default arguments

# More pops, fewer snakes in each
str(dat &lt;- simDat72(nPops = 10, nSample = 5, pop.means = runif(10,20,60)))

# Revert to "model-of-the-mean" (larger sample size to minimize sampling variability)
str(dat &lt;- simDat72(nSample = 1000, pop.means = rep(50, 5), sigma = 5))

</code></pre>

<hr>
<h2 id='simDat73'>Simulate data for Chapter 7.3: ANOVA with random effects of population</h2><span id='topic+simDat73'></span>

<h3>Description</h3>

<p>Simulate snout-vent length measurements of nSample smooth snakes in each of nPops populations.
Data are simulated under the assumptions of a model with random effects of populations
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simDat73(nPops = 10, nSample = 12, pop.grand.mean = 50, pop.sd = 3, sigma = 5)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simDat73_+3A_npops">nPops</code></td>
<td>
<p>Number of populations</p>
</td></tr>
<tr><td><code id="simDat73_+3A_nsample">nSample</code></td>
<td>
<p>Samples from each population</p>
</td></tr>
<tr><td><code id="simDat73_+3A_pop.grand.mean">pop.grand.mean</code></td>
<td>
<p>Mean of population means (hyperparameter)</p>
</td></tr>
<tr><td><code id="simDat73_+3A_pop.sd">pop.sd</code></td>
<td>
<p>Standard deviation of population means (hyperparameter)</p>
</td></tr>
<tr><td><code id="simDat73_+3A_sigma">sigma</code></td>
<td>
<p>Value for the residual standard deviation</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of simulated data and parameters.
</p>
<table role = "presentation">
<tr><td><code>nPops</code></td>
<td>
<p>Number of populations</p>
</td></tr>
<tr><td><code>nSample</code></td>
<td>
<p>Number of samples per population</p>
</td></tr>
<tr><td><code>pop.grand.mean</code></td>
<td>
<p>Mean of population means</p>
</td></tr>
<tr><td><code>pop.sd</code></td>
<td>
<p>SD of population means</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>Residual SD</p>
</td></tr>
<tr><td><code>pop</code></td>
<td>
<p>Indicator for population number</p>
</td></tr>
<tr><td><code>pop.means</code></td>
<td>
<p>Simulated population means</p>
</td></tr>
<tr><td><code>eps</code></td>
<td>
<p>Simulated residuals</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>Simulated lengths</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marc Kéry
</p>


<h3>Examples</h3>

<pre><code class='language-R'>str(dat &lt;- simDat73())      # Implicit default arguments
# More pops, more snakes in each, more among-population variability
str(dat &lt;- simDat73(nPops = 20, nSample = 30, pop.sd = 8)) 

# Revert to "model-of-the-mean" (larger sample size to minimize sampling variability)
str(dat &lt;- simDat73(nSample = 1000, pop.sd = 0, sigma = 5))

</code></pre>

<hr>
<h2 id='simDat8'>Simulate data for Chapter 8: Two-way ANOVA</h2><span id='topic+simDat8'></span>

<h3>Description</h3>

<p>Simulate wing length measurements of mourning cloak butterflies with two factors (habitat and population)
including their interaction if so wished (simulation under a fixed-effects model)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simDat8(
  nPops = 5,
  nHab = 3,
  nSample = 12,
  baseline = 40,
  pop.eff = c(-10, -5, 5, 10),
  hab.eff = c(5, 10),
  interaction.eff = c(-2, 3, 0, 4, 4, 0, 3, -2),
  sigma = 3
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simDat8_+3A_npops">nPops</code></td>
<td>
<p>Number of populations</p>
</td></tr>
<tr><td><code id="simDat8_+3A_nhab">nHab</code></td>
<td>
<p>Number of habitats</p>
</td></tr>
<tr><td><code id="simDat8_+3A_nsample">nSample</code></td>
<td>
<p>Samples from each population-habitat combination</p>
</td></tr>
<tr><td><code id="simDat8_+3A_baseline">baseline</code></td>
<td>
<p>Grand mean length</p>
</td></tr>
<tr><td><code id="simDat8_+3A_pop.eff">pop.eff</code></td>
<td>
<p>Population effects, should be nPops - 1 values</p>
</td></tr>
<tr><td><code id="simDat8_+3A_hab.eff">hab.eff</code></td>
<td>
<p>Habitat effects, should be nHab - 1 values</p>
</td></tr>
<tr><td><code id="simDat8_+3A_interaction.eff">interaction.eff</code></td>
<td>
<p>Interaction effects, should be (nPops-1)*(nHab-1) values</p>
</td></tr>
<tr><td><code id="simDat8_+3A_sigma">sigma</code></td>
<td>
<p>Value for the residual standard deviation</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of simulated data and parameters.
</p>
<table role = "presentation">
<tr><td><code>nPops</code></td>
<td>
<p>Number of populations</p>
</td></tr>
<tr><td><code>nSample</code></td>
<td>
<p>Number of samples per population</p>
</td></tr>
<tr><td><code>baseline</code></td>
<td>
<p>Grand mean length</p>
</td></tr>
<tr><td><code>pop.eff</code></td>
<td>
<p>Population effects</p>
</td></tr>
<tr><td><code>hab.eff</code></td>
<td>
<p>Habitat effects</p>
</td></tr>
<tr><td><code>interaction.eff</code></td>
<td>
<p>Interaction effects</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>Residual SD</p>
</td></tr>
<tr><td><code>all.eff</code></td>
<td>
<p>All effects</p>
</td></tr>
<tr><td><code>pop</code></td>
<td>
<p>Indicator for population number</p>
</td></tr>
<tr><td><code>hab</code></td>
<td>
<p>Indicator for habitat number</p>
</td></tr>
<tr><td><code>eps</code></td>
<td>
<p>Simulated residuals</p>
</td></tr>
<tr><td><code>wing</code></td>
<td>
<p>Simulated wing lengths</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marc Kéry
</p>


<h3>Examples</h3>

<pre><code class='language-R'>str(dat &lt;- simDat8())      # Implicit default arguments (for the model with interactions)
# Model with main effects only (and very large sample size; to minimize sampling error 
# and clarify structure of main effects in plot)
str(dat &lt;- simDat8(nSample = 1000, interaction.eff = c(0,0,0,0, 0,0,0,0)))
str(dat &lt;- simDat8(nSample = 10000, interaction.eff = rep(0, 8))) # same, even larger sample size

# Revert to one-way ANOVA model with only effects of pop (with much larger sample size)
str(dat &lt;- simDat8(nSample = 10000, pop.eff = c(-10, -5, 5, 10),
    hab.eff = c(0, 0), interaction.eff = rep(0, 8)))  # note no effect of habitat

# Revert to one-way ANOVA model with only effects of hab
str(dat &lt;- simDat8(nSample = 10000, pop.eff = c(0, 0, 0, 0),
    hab.eff = c(5, 10), interaction.eff = rep(0, 8)))  # note no effect of pop

# Revert to "model-of-the-mean"
str(dat &lt;- simDat8(nSample = 10000, pop.eff = c(0, 0, 0, 0), 
    hab.eff = c(0, 0), interaction.eff = rep(0, 8)))  # note no effect of pop nor of h

</code></pre>

<hr>
<h2 id='simDat9'>Simulate data for Chapter 9: ANCOVA or general linear model</h2><span id='topic+simDat9'></span>

<h3>Description</h3>

<p>Simulate mass ~ length regressions in 3 populations of asp vipers
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simDat9(
  nPops = 3,
  nSample = 10,
  beta.vec = c(80, -30, -20, 6, -3, -4),
  sigma = 10
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simDat9_+3A_npops">nPops</code></td>
<td>
<p>Number of populations</p>
</td></tr>
<tr><td><code id="simDat9_+3A_nsample">nSample</code></td>
<td>
<p>Samples from each population</p>
</td></tr>
<tr><td><code id="simDat9_+3A_beta.vec">beta.vec</code></td>
<td>
<p>Vector of regression parameter values</p>
</td></tr>
<tr><td><code id="simDat9_+3A_sigma">sigma</code></td>
<td>
<p>Value for the residual standard deviation</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of simulated data and parameters.
</p>
<table role = "presentation">
<tr><td><code>nPops</code></td>
<td>
<p>Number of populations</p>
</td></tr>
<tr><td><code>nSample</code></td>
<td>
<p>Number of samples per population</p>
</td></tr>
<tr><td><code>beta.vec</code></td>
<td>
<p>Regression parameter values</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>Residual SD</p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p>Indicator for population number</p>
</td></tr>
<tr><td><code>pop</code></td>
<td>
<p>Population name (factor)</p>
</td></tr>
<tr><td><code>lengthC</code></td>
<td>
<p>Centered body length for each viper</p>
</td></tr>
<tr><td><code>mass</code></td>
<td>
<p>Simulated body mass for each viper</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marc Kéry
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Implicit default arguments (with interaction of length and pop)
str(dat &lt;- simDat9())

# Revert to main-effects model with parallel lines
str(dat &lt;- simDat9(beta.vec = c(80, -30, -20, 6, 0, 0)))

# Revert to main-effects model with parallel lines 
# (larger sample size to better show patterns)
str(dat &lt;- simDat9(nSample = 100, beta.vec = c(80, -30, -20, 6, 0, 0)))

# Revert to simple linear regression: no effect of population 
# (larger sample size to better show patterns)
str(dat &lt;- simDat9(nSample = 100, beta.vec = c(80, 0, 0, 6, 0, 0)))

# Revert to one-way ANOVA model: no effect of body length 
# (larger sample size to better show patterns)
str(dat &lt;- simDat9(nSample = 100, beta.vec = c(80, -30, -20, 0, 0, 0)))

# Revert to "model-of-the-mean": no effects of either body length or population)
str(dat &lt;- simDat9(nSample = 100, beta.vec = c(80, 0, 0, 0, 0, 0)))

</code></pre>

<hr>
<h2 id='tmbSummary'>Summarize Output from TMB</h2><span id='topic+tmbSummary'></span><span id='topic+tmb_summary'></span>

<h3>Description</h3>

<p>Summarize output from TMB by point estimate (MLE), standard error (SE),
and 95% Wald-type confidence intervals (CIs).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tmbSummary(tmbObject, dig = NULL)

tmb_summary(tmbObject, dig = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tmbSummary_+3A_tmbobject">tmbObject</code></td>
<td>
<p>A TMB object created by <code>MakeADFun</code> that has
been optimized (e.g. with <code>optim</code>)</p>
</td></tr>
<tr><td><code id="tmbSummary_+3A_dig">dig</code></td>
<td>
<p>Number of decimal places to use in output</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of parameter estimates, standard errors, and 95% Wald-type confidence intervals.
</p>


<h3>Author(s)</h3>

<p>Ken Kellner
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
