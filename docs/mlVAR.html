<!DOCTYPE html><html><head><title>Help for package mlVAR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {mlVAR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#getNet'>
<p>Gets a network structure</p></a></li>
<li><a href='#importMplus'>
<p>Import output from Mplus</p></a></li>
<li><a href='#mlVAR'>
<p>Multilevel VAR Estimation for Multiple Time Series</p></a></li>
<li><a href='#mlVAR-effects'>
<p>Fixed and random effects</p></a></li>
<li><a href='#mlVAR0'>
<p>Multilevel VAR Estimation for Multiple Time Series</p></a></li>
<li><a href='#mlVAR0-methods'>
<p>print and summary functions for mlVAR0 objects</p></a></li>
<li><a href='#mlVARcompare'>
<p>Compare mlVAR model fit</p></a></li>
<li><a href='#mlVARsample'>
<p>Simulator function given an mlVAR object</p></a></li>
<li><a href='#mlVARsim'>
<p>Simulates an mlVAR model and data</p></a></li>
<li><a href='#plot.mlVAR'>
<p>Plot Method for mlVAR</p></a></li>
<li><a href='#plot.mlVAR0'>
<p>Plot Method for mlVAR0</p></a></li>
<li><a href='#simulateVAR'>
<p>Simulate data from VAR model</p></a></li>
<li><a href='#summary.mlVAR'>
<p>Summary of mlVAR results</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Multi-Level Vector Autoregression</td>
</tr>
<tr>
<td>Version:</td>
<td>0.5.2</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.3.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>lme4, arm, qgraph, dplyr (&ge; 0.5.0), clusterGeneration,
mvtnorm, corpcor, plyr, abind, methods, parallel,
MplusAutomation, graphicalVAR, rlang</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Sacha Epskamp &lt;mail@sachaepskamp.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimates the multi-level vector autoregression model on time-series data.
             Three network structures are obtained: temporal networks, contemporaneous
             networks and between-subjects networks.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-01 06:40:50 UTC; sachaepskamp</td>
</tr>
<tr>
<td>Author:</td>
<td>Sacha Epskamp [aut, cre],
  Marie K. Deserno [aut],
  Laura F. Bringmann [aut],
  Myrthe Veenman [ctb]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-01 07:10:21 UTC</td>
</tr>
</table>
<hr>
<h2 id='getNet'>
Gets a network structure
</h2><span id='topic+getNet'></span>

<h3>Description</h3>

<p>This function is simply a wrapper around the plotting method for mlVAR objects, that extracts the network structure rather than plotting them.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getNet(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getNet_+3A_x">x</code></td>
<td>

<p>An 'mlVAR' or 'mlVARsim0' object.
</p>
</td></tr>
<tr><td><code id="getNet_+3A_...">...</code></td>
<td>

<p>Arguments sent to <code><a href="#topic+plot.mlVAR">plot.mlVAR</a></code>
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sacha Epskamp &lt;mail@sachaepskamp.com&gt;
</p>

<hr>
<h2 id='importMplus'>
Import output from Mplus
</h2><span id='topic+importMplus'></span>

<h3>Description</h3>

<p>This function imports the output from an Mplus model that has been generated by mlVAR. It can be used to make manual changes to the input file. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>importMplus(outfile)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="importMplus_+3A_outfile">outfile</code></td>
<td>

<p>Location of Mplus output file.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sacha Epskamp &lt;mail@sachaepskamp.com&gt;
</p>

<hr>
<h2 id='mlVAR'>
Multilevel VAR Estimation for Multiple Time Series
</h2><span id='topic+mlVAR'></span>

<h3>Description</h3>

<p>The function <code>mlVAR</code> computes estimates of the multivariate vector autoregression model. This model returns three stuctures: temporal effects (e.g., lag-1 regression weights), contemporaneous relationships (correlations or partial correlations) and between-subject effects (correlations and partial correlations). See details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mlVAR(data, vars, idvar, lags = 1, dayvar, beepvar,
                 estimator = c("default", "lmer", "lm","Mplus"),
                 contemporaneous = c("default", "correlated",
                 "orthogonal", "fixed", "unique"), temporal =
                 c("default", "correlated", "orthogonal", "fixed",
                 "unique"), nCores = 1, verbose = TRUE, compareToLags,
                 scale = TRUE, scaleWithin = FALSE, AR = FALSE, 
                 MplusSave = TRUE, MplusName = "mlVAR", iterations = "(2000)", 
                 chains = nCores, signs, orthogonal
  )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mlVAR_+3A_data">data</code></td>
<td>

<p>Data frame
</p>
</td></tr>
<tr><td><code id="mlVAR_+3A_vars">vars</code></td>
<td>

<p>Vectors of variables to include in the analysis
</p>
</td></tr>
<tr><td><code id="mlVAR_+3A_idvar">idvar</code></td>
<td>

<p>String indicating the subject ID
</p>
</td></tr>
<tr><td><code id="mlVAR_+3A_lags">lags</code></td>
<td>

<p>Vector indicating the lags to include
</p>
</td></tr>
<tr><td><code id="mlVAR_+3A_dayvar">dayvar</code></td>
<td>

<p>String indicating assessment day. Adding this argument makes sure that the first measurement of a day is not regressed on the last measurement of the previous day. IMPORTANT: only add this if the data has multiple observations per day.
</p>
</td></tr>
<tr><td><code id="mlVAR_+3A_beepvar">beepvar</code></td>
<td>

<p>Optional string indicating assessment beep per day. Adding this argument will cause non-consecutive beeps to be treated as missing!
</p>
</td></tr>
<tr><td><code id="mlVAR_+3A_estimator">estimator</code></td>
<td>

<p>The estimator to be used. <code>"lmer"</code> for sequential univariate multi-level estimation, <code>"Mplus"</code> for multivariate Bayesian estimation (requires Mplus), and <code>"lm"</code> for fixed effects estimation.
</p>
</td></tr>
<tr><td><code id="mlVAR_+3A_contemporaneous">contemporaneous</code></td>
<td>

<p>How should the contemporaneous networks be estimated? These networks are always estimated post-hoc by investigating the residuals of the temporal models. <code>"correlated"</code> and <code>"orthogonal"</code> run second multi-level models in which the networks are estimated using node-wise estimation. <code>"fixed"</code> and <code>"unique"</code> simply correlate the residuals, either by computing one network for all subjects (fixed) or a single network per per subject.
</p>
</td></tr>
<tr><td><code id="mlVAR_+3A_temporal">temporal</code></td>
<td>

<p>How should the temporal effects be estimated? <code>"correlated"</code> estimates correlated random effects, <code>"orthogonal"</code> estimates non-correlated random effects and <code>"fixed"</code> estimates a model in which only the intercept is random. Defaults to <code>"correlated"</code> when the number of variables is less than 6 and <code>"orthogonal"</code> otherwise. <code>"unique"</code> uses <code>lm</code> to estimate an unique model for each subject.
</p>
</td></tr>
<tr><td><code id="mlVAR_+3A_ncores">nCores</code></td>
<td>
<p>Number of cores to use in computation</p>
</td></tr>
<tr><td><code id="mlVAR_+3A_verbose">verbose</code></td>
<td>

<p>Logical indicating if console messages and the progress bar should be shown.
</p>
</td></tr>
<tr><td><code id="mlVAR_+3A_scale">scale</code></td>
<td>
<p>Logical, should variables be standardized before estimation?</p>
</td></tr>
<tr><td><code id="mlVAR_+3A_scalewithin">scaleWithin</code></td>
<td>
<p>Logial, should variables be scaled within-person (set to <code>FALSE</code> to only center within-person)</p>
</td></tr>
<tr><td><code id="mlVAR_+3A_comparetolags">compareToLags</code></td>
<td>

<p>A vector indicating which lags to base the data on. If the model is to be compared with a model with multiple lags using <code><a href="#topic+mlVARcompare">mlVARcompare</a></code>, this argument must be used to make sure the number of observations is the same in both models (e.g., a lag 1 model can model the second observation of a day and a lag-2 model can't, causing different number of observations and incomparable models). It is suggested to not use this argument unless you want to compare models, and always run <code>mlVAR</code> without using this argument afterwards in the selected model.
</p>
</td></tr>
<tr><td><code id="mlVAR_+3A_ar">AR</code></td>
<td>
<p>Logical, should an auto-regression only model be fitted?</p>
</td></tr>
<tr><td><code id="mlVAR_+3A_mplussave">MplusSave</code></td>
<td>
<p>Logical, should the Mplus model file and output be saved?</p>
</td></tr>
<tr><td><code id="mlVAR_+3A_mplusname">MplusName</code></td>
<td>
<p>Name of the Mplus model file and output (without extensions)</p>
</td></tr>
<tr><td><code id="mlVAR_+3A_iterations">iterations</code></td>
<td>
<p>The string used to define the number of iterations in Mplus</p>
</td></tr>
<tr><td><code id="mlVAR_+3A_chains">chains</code></td>
<td>
<p>Number of Mplus chains</p>
</td></tr>
<tr><td><code id="mlVAR_+3A_signs">signs</code></td>
<td>
<p>Optional matrix fixing the signs of contemporaneous correlations. Is estimated by running mlVAR with <code>estimator = "lmer"</code> if missing.</p>
</td></tr>
<tr><td><code id="mlVAR_+3A_orthogonal">orthogonal</code></td>
<td>

<p>Deprecated argument only added for backward competability. Ignore.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function estimates the multi-level VAR model to obtain temporal, contemporaneous and between-subject effects using nodewise estimation. Temporal and between-subject effects are obtained directly from the models and contemporaneous effects are estimated post-hoc by correlating the residuals. See arxiv.org/abs/1609.04156 for details.
</p>
<p>Setting <code>estimator = "Mplus"</code> will generate a Mplus model, run the analysis and read the results into R. Mplus 8 is required for this estimation. It is recommended to set <code>contemporaneous = "fixed"</code>, though not required. For the estimation of contemporaneous random effects, the signs of contemporaneous *correlations * (not partial correlations) need be set (or estimated) via the <code>signs</code> argument.
</p>


<h3>Value</h3>

<p>An <code>mlVAR</code> object 
</p>


<h3>Author(s)</h3>

<p>Sacha Epskamp (mail@sachaepskamp.com)
</p>


<h3>References</h3>

<p>Bringmann, L. F., Vissers, N., Wichers, M., Geschwind, N., Kuppens, P., Peeters, F., ... &amp; Tuerlinckx, F. (2013). A network approach to psychopathology: New insights into clinical longitudinal data. PloS one, 8(4), e60188.
</p>
<p>Hamaker, E. L., &amp; Grasman, R. P. (2014). To center or not to center? Investigating inertia with a multilevel autoregressive model. Frontiers in psychology, 5.
</p>
<p>Epskamp, S., Waldorp, L. J., Mottus, R., &amp; Borsboom, D. (2017). Discovering Psychological Dynamics: The Gaussian Graphical Model in Cross-sectional and Time-series Data. arxiv.org/abs/1609.04156.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mlVARcompare">mlVARcompare</a></code>, <code><a href="#topic+summary.mlVAR">summary.mlVAR</a></code>, <code><a href="#topic+plot.mlVAR">plot.mlVAR</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
### Small example ###
# Simulate data:
Model &lt;- mlVARsim(nPerson = 50, nNode = 3, nTime = 50, lag=1)

# Estimate using correlated random effects:
fit1 &lt;- mlVAR(Model$Data, vars = Model$vars, idvar = Model$idvar, lags = 1, temporal = "correlated")

# Print some pointers:
print(fit1)

# Summary of all parameter estimates:
summary(fit1)

# Compare temporal relationships:
layout(t(1:2))
plot(Model, "temporal", title = "True temporal relationships", layout = "circle")
plot(fit1, "temporal", title = "Estimated temporal relationships", layout = "circle")

# Compare contemporaneous partial correlations:
layout(t(1:2))
plot(Model, "contemporaneous", title = "True contemporaneous relationships", 
    layout = "circle")
plot(fit1, "contemporaneous", title = "Estimated contemporaneous relationships", 
    layout = "circle")

# Compare between-subjects partial correlations:
layout(t(1:2))
plot(Model, "between", title = "True between-subjects relationships", layout = "circle")
plot(fit1, "between", title = "Estimated between-subjects relationships", 
    layout = "circle")

# Run same model with non-correlated temporal relationships and fixed-effect model:
fit2 &lt;- mlVAR(Model$Data, vars = Model$vars, idvar = Model$idvar, lags = 1, 
    temporal = "orthogonal")
fit3 &lt;- mlVAR(Model$Data, vars = Model$vars, idvar = Model$idvar, lags = 1, 
    temporal = "fixed")

# Compare models:
mlVARcompare(fit1,fit2,fit3)

# Inspect true parameter correlation matrix:
Model$model$Omega$cor$mean
# Even though correlations are high, orthogonal model works well often!


### Large example ###
Model &lt;- mlVARsim(nPerson = 100, nNode = 10, nTime = 100,lag=1)

# Correlated random effects no longer practical. Use orthogonal or fixed:
fit4 &lt;- mlVAR(Model$Data, vars = Model$vars, idvar = Model$idvar, lags = 1, 
    temporal = "orthogonal")
fit5 &lt;- mlVAR(Model$Data, vars = Model$vars, idvar = Model$idvar, lags = 1, 
    temporal = "fixed")

# Compare models:
mlVARcompare(fit4, fit5)

# Compare temporal relationships:
layout(t(1:2))
plot(Model, "temporal", title = "True temporal relationships", layout = "circle")
plot(fit4, "temporal", title = "Estimated temporal relationships", layout = "circle")

# Compare contemporaneous partial correlations:
layout(t(1:2))
plot(Model, "contemporaneous", title = "True contemporaneous relationships", 
    layout = "circle")
plot(fit4, "contemporaneous", title = "Estimated contemporaneous relationships", 
    layout = "circle")

# Compare between-subjects partial correlations:
layout(t(1:2))
plot(Model, "between", title = "True between-subjects relationships", layout = "circle")
plot(fit4, "between", title = "Estimated between-subjects relationships", 
    layout = "circle")

## End(Not run)
</code></pre>

<hr>
<h2 id='mlVAR-effects'>
Fixed and random effects
</h2><span id='topic+fixedEffects'></span><span id='topic+randomEffects'></span>

<h3>Description</h3>

<p>These functions return a table of the fixed and random effects.
</p>
<p>FUNCTIONS ARE DEPRECATED AND WILL BE REMOVED SOON.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fixedEffects(object, digits = 5)
randomEffects(object, digits = 5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mlVAR-effects_+3A_object">object</code></td>
<td>

<p>A <code>mlVAR</code> object
</p>
</td></tr>
<tr><td><code id="mlVAR-effects_+3A_digits">digits</code></td>
<td>

<p>Number of digits to output
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sacha Epskamp (mail@sachaepskamp.com), Marie K. Deserno (m.k.deserno@uva.nl) and Laura F. Bringmann (laura.bringmann@ppw.kuleuven.be)
</p>

<hr>
<h2 id='mlVAR0'>
Multilevel VAR Estimation for Multiple Time Series
</h2><span id='topic+mlVAR0'></span>

<h3>Description</h3>

<p>The function <code>mlVAR0</code> computes estimates of the multivariate vector autoregression model as introduced by Bringmann et al. (2013) which can be extended through treatment effects, covariates and pre- and post assessment effects. 
</p>
<p>FUNCTION IS DEPRECATED AND WILL BE REMOVED SOON.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mlVAR0(data, vars, idvar, lags = 1, dayvar, beepvar,
                 periodvar, treatmentvar, covariates, timevar,
                 maxTimeDiff, control = list(optimizer = "bobyqa"),
                 verbose = TRUE, orthogonal, estimator = c("lmer",
                 "lmmlasso"), method = c("default", "stepwise",
                 "movingWindow"), laginteractions = c("none", "mains",
                 "interactions"), critFun = BIC, lambda = 0,
                 center = c("inSubject","general","none"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mlVAR0_+3A_data">data</code></td>
<td>

<p>Data frame
</p>
</td></tr>
<tr><td><code id="mlVAR0_+3A_vars">vars</code></td>
<td>

<p>Vectors of variables to include in the analysis
</p>
</td></tr>
<tr><td><code id="mlVAR0_+3A_idvar">idvar</code></td>
<td>

<p>String indicating the subject ID
</p>
</td></tr>
<tr><td><code id="mlVAR0_+3A_lags">lags</code></td>
<td>

<p>Vector indicating the lags to include
</p>
</td></tr>
<tr><td><code id="mlVAR0_+3A_dayvar">dayvar</code></td>
<td>

<p>String indicating assessment day (if missing, every assessment is set to one day)
</p>
</td></tr>
<tr><td><code id="mlVAR0_+3A_beepvar">beepvar</code></td>
<td>

<p>String indicating assessment beep per day (if missing, is added)
</p>
</td></tr>
<tr><td><code id="mlVAR0_+3A_periodvar">periodvar</code></td>
<td>

<p>String indicating the period (baseline, treatment period, etc.) of assessment (if missing, every assessment is set to one period)
</p>
</td></tr>
<tr><td><code id="mlVAR0_+3A_treatmentvar">treatmentvar</code></td>
<td>

<p>Character vector indicating treatment
</p>
</td></tr>
<tr><td><code id="mlVAR0_+3A_covariates">covariates</code></td>
<td>

<p>Character indicating covariates independent of assessment.
</p>
</td></tr>
<tr><td><code id="mlVAR0_+3A_timevar">timevar</code></td>
<td>

<p>Character indicating the time variable
</p>
</td></tr>
<tr><td><code id="mlVAR0_+3A_maxtimediff">maxTimeDiff</code></td>
<td>

<p>Maximum time differece to include observation pairs
</p>
</td></tr>
<tr><td><code id="mlVAR0_+3A_control">control</code></td>
<td>

<p>A list of arguments sent to <code><a href="lme4.html#topic+lmerControl">lmerControl</a></code>
</p>
</td></tr>
<tr><td><code id="mlVAR0_+3A_verbose">verbose</code></td>
<td>

<p>Logical to print progress to the console
</p>
</td></tr>
<tr><td><code id="mlVAR0_+3A_orthogonal">orthogonal</code></td>
<td>

<p>Logical to indicate if orthogonal estimation (no correlated random effects) should be used. Defaults to <code>FALSE</code> if the number of nodes is less than 6 and <code>TRUE</code> otherwise
</p>
</td></tr>
<tr><td><code id="mlVAR0_+3A_estimator">estimator</code></td>
<td>

<p>Estimator to use. Note: <code>lmmlasso</code> implementation is very experimental
</p>
</td></tr>
<tr><td><code id="mlVAR0_+3A_method">method</code></td>
<td>

<p>Method to use. Experimental
</p>
</td></tr>
<tr><td><code id="mlVAR0_+3A_laginteractions">laginteractions</code></td>
<td>

<p>Experimental, do not use.
</p>
</td></tr>
<tr><td><code id="mlVAR0_+3A_critfun">critFun</code></td>
<td>

<p>Experimental, do not use.
</p>
</td></tr>
<tr><td><code id="mlVAR0_+3A_lambda">lambda</code></td>
<td>

<p>lmmlasso lambda parameter
</p>
</td></tr>
<tr><td><code id="mlVAR0_+3A_center">center</code></td>
<td>

<p>Centering to be used. <code>"inSubject"</code> uses within-person centering, <code>"general"</code> uses grand-mean centering and <code>"none"</code> does not use centering. IMPORTANT NOTE: <code>"inSubject"</code> leads to coefficients to resemble within-person slopes, the other centering option leads to coefficients to be a blend of within and between person slopes.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>mlVAR0 has been built to extract individual network dynamics by estimating a multilevel vector autoregression model that models the time dynamics of selected variables both within an individual and on group level. For example, in a lag-1-model each variable at time point t is regressed to a lagged version of itself at time point t-1 and all other variables at time point t-1. In psychological research, for example, this analysis can be used to relate the dynamics of symptoms on one day (as assessed by experience sampling methods) to the dynamics of these symptoms on the consecutive day. </p>


<h3>Value</h3>

<p>mlVAR0 returns a 'mlVAR0' object containing
</p>
<table>
<tr><td><code>fixedEffects</code></td>
<td>
<p>A matrix that contains all fixed effects coefficients with dependent variables as rows and the lagged independent variables as columns.</p>
</td></tr>
<tr><td><code>se.fixedEffects</code></td>
<td>
<p>A matrix that contains all standard errors of the fixed effects.</p>
</td></tr>
<tr><td><code>randomEffects</code></td>
<td>
<p>A list of matrices that contain the random effects coefficients.</p>
</td></tr>
<tr><td><code>randomEffectsVariance</code></td>
<td>
<p>A matrix containing the estimated variances between the random-effects terms</p>
</td></tr>
<tr><td><code>pvals</code></td>
<td>
<p>A matrix that contains p-values for all fixed effects.</p>
</td></tr>
<tr><td><code>pseudologlik</code></td>
<td>
<p>The pseudo log-likelihood.</p>
</td></tr>
<tr><td><code>BIC</code></td>
<td>
<p>Bayesian Information Criterion, i.e. the sum of all univariate models' BICs</p>
</td></tr>
<tr><td><code>input</code></td>
<td>
<p>List containing the names of variables used in the analysis</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sacha Epskamp (mail@sachaepskamp.com), Marie K. Deserno (m.k.deserno@uva.nl) and Laura F. Bringmann (laura.bringmann@ppw.kuleuven.be)
</p>


<h3>References</h3>

<p>Bringmann, L. F., Vissers, N., Wichers, M., Geschwind, N., Kuppens, P., Peeters, F., ... &amp; Tuerlinckx, F. (2013). A network approach to psychopathology: New insights into clinical longitudinal data. PloS one, 8(4), e60188.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fixedEffects">fixedEffects</a></code>, <code><a href="#topic+fixedEffects">fixedEffects</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
### Small network ###
nVar &lt;- 3
nPerson &lt;- 25
nTime &lt;- 25

# Simulate model and data:
Model &lt;- mlVARsim0(nPerson,nVar,nTime,sparsity = 0.5)

# Run mlVAR0:
Res &lt;- mlVAR0(Model)

# Compare true fixed model with significant edges of estimated fixed model:
layout(t(1:2))
plot(Model,"fixed", title = "True model",layout="circle", edge.labels = TRUE)
plot(Res,"fixed", title = "Estimated model", layout = "circle", onlySig = TRUE, 
        alpha = 0.05, edge.labels = TRUE)

# Compare true and estimated individual differences in parameters:
layout(t(1:2))
plot(Model,"fixed", title = "True model",layout="circle", edge.color = "blue", 
        edge.labels = TRUE)
plot(Res,"fixed", title = "Estimated model", layout = "circle", edge.color = "blue", 
        edge.labels = TRUE)

# Compare networks of subject 1:
layout(t(1:2))
plot(Model,"subject",subject = 1, title = "True model",layout="circle", 
        edge.labels = TRUE)
plot(Res,"subject",subject = 1,title = "Estimated model", layout = "circle", 
        edge.labels = TRUE)



### Large network ###
nVar &lt;- 10
nPerson &lt;- 50
nTime &lt;- 50

# Simulate model and data:
Model &lt;- mlVARsim0(nPerson,nVar,nTime, sparsity = 0.5)

# Run orthogonal mlVAR:
Res &lt;- mlVAR0(Model, orthogonal = TRUE)

# Compare true fixed model with significant edges of estimated fixed model:
layout(t(1:2))
plot(Model,"fixed", title = "True model",layout="circle")
plot(Res,"fixed", title = "Estimated model", layout = "circle", onlySig = TRUE, 
        alpha = 0.05)

# Compare true and estimated individual differences in parameters:
layout(t(1:2))
plot(Model,"fixed", title = "True model",layout="circle", edge.color = "blue")
plot(Res,"fixed", title = "Estimated model", layout = "circle", edge.color = "blue")

# Compare networks of subject 1:
layout(t(1:2))
plot(Model,"subject",subject = 1, title = "True model",layout="circle")
plot(Res,"subject",subject = 1,title = "Estimated model", layout = "circle")

## End(Not run)
</code></pre>

<hr>
<h2 id='mlVAR0-methods'>
print and summary functions for mlVAR0 objects
</h2><span id='topic+print.mlVAR0'></span><span id='topic+summary.mlVAR0'></span>

<h3>Description</h3>

<p>Create a short summary of an object created by <code><a href="#topic+mlVAR0">mlVAR0</a></code>.
</p>
<p>FUNCTION IS DEPRECATED AND WILL BE REMOVED SOON.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ## S3 method for class 'mlVAR0'
print(x, ...)
  ## S3 method for class 'mlVAR0'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mlVAR0-methods_+3A_object">object</code></td>
<td>

<p>A &quot;mlVAR0&quot; object
</p>
</td></tr>
<tr><td><code id="mlVAR0-methods_+3A_x">x</code></td>
<td>

<p>A &quot;mlVAR0&quot; object
</p>
</td></tr>
<tr><td><code id="mlVAR0-methods_+3A_...">...</code></td>
<td>

<p>Not used
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sacha Epskamp (mail@sachaepskamp.com), Marie K. Deserno (m.k.deserno@uva.nl) and Laura F. Bringmann (laura.bringmann@ppw.kuleuven.be)
</p>

<hr>
<h2 id='mlVARcompare'>
Compare mlVAR model fit
</h2><span id='topic+mlVARcompare'></span>

<h3>Description</h3>

<p>This function compares the fit of several mlVAR models. Since an mlVAR model is a 
combination of univariate models this function will compare the fits for each univariate model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mlVARcompare(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mlVARcompare_+3A_...">...</code></td>
<td>

<p>Any number of objects obtained from <code><a href="#topic+mlVAR">mlVAR</a></code>
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Important to note is that the number of observations must be equal to make models comparable. If the lags are different and <code>compareToLags</code> was not used in <code>mlVAR</code> this function will stop with an informative error message.
</p>


<h3>Author(s)</h3>

<p>Sacha Epskamp (mail@sachaepskamp.com)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
### Small example ###
# Simulate data:
Model &lt;- mlVARsim(nPerson = 50, nNode = 3, nTime = 50, lag=1)

# Estimate using different methods:
fit1 &lt;- mlVAR(Model$Data, vars = Model$vars, idvar = Model$idvar, lags = 1, 
    temporal = "correlated")
fit2 &lt;- mlVAR(Model$Data, vars = Model$vars, idvar = Model$idvar, lags = 1, 
    temporal = "orthogonal")
fit3 &lt;- mlVAR(Model$Data, vars = Model$vars, idvar = Model$idvar, lags = 1, 
    temporal = "fixed")

# Compare models:
mlVARcompare(fit1,fit2,fit3)

## End(Not run)
</code></pre>

<hr>
<h2 id='mlVARsample'>
Simulator function given an mlVAR object
</h2><span id='topic+mlVARsample'></span><span id='topic+summary.mlVARsample'></span>

<h3>Description</h3>

<p>Simulates data based on an mlVAR object, estimates the mlVAR network model based on the simulated data and compares the estimated network to the mlVAR object network.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mlVARsample(object, nTime = c(25,50,100,200), nSample = 100, pMissing = 0, 
  nReps = 100, nCores = 1, ...)

## S3 method for class 'mlVARsample'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mlVARsample_+3A_object">object</code></td>
<td>

<p>mlVAR object, or mlVARsample object in the summary method
</p>
</td></tr>
<tr><td><code id="mlVARsample_+3A_ntime">nTime</code></td>
<td>

<p>Vector with number of time points to test. 
</p>
</td></tr>
<tr><td><code id="mlVARsample_+3A_nsample">nSample</code></td>
<td>

<p>Number of individuals in the dataset. It is possible to decrease the number of individuals compared to the individuals in the mlVAR object. However, it is not possible to have more individuals than there are in the mlVAR object.     
</p>
</td></tr>
<tr><td><code id="mlVARsample_+3A_pmissing">pMissing</code></td>
<td>

<p>Percentage of missing data to be simulated.   
</p>
</td></tr>
<tr><td><code id="mlVARsample_+3A_nreps">nReps</code></td>
<td>

<p>Number of repetitions for each condition. 
</p>
</td></tr>
<tr><td><code id="mlVARsample_+3A_ncores">nCores</code></td>
<td>

<p>Number of cores to use. 
</p>
</td></tr>
<tr><td><code id="mlVARsample_+3A_...">...</code></td>
<td>

<p>Arguments sent to mlVAR. 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function simulates data based on the mlVAR object. The individual networks (random effects) are used to simulate data using the <code>graphicalVARsim</code> function from the graphicalVAR package (Epskamp, 2020). The individual data is combined into one dataset. This dataset is used to estimate the mlVAR network. 
</p>
<p>For every condition, the function returns four values per network comparison measure (correlation, sensitivity, specificity, bias, and precision): one for the fixed temporal effects, one for the fixed contemporaneous effects, the mean comparison value of the random temporal effects, and the mean comparison value of the random contemporaneous effects. 
</p>


<h3>Author(s)</h3>

<p>Sacha Epskamp &lt;mail@sachaepskamp.com&gt;
</p>


<h3>References</h3>

<p>Sacha Epskamp (2020). graphicalVAR: Graphical VAR for Experience Sampling Data. R package version 0.2.3. https://CRAN.R-project.org/package=graphicalVAR
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mlVARsim">mlVARsim</a></code>, <code><a href="#topic+mlVAR">mlVAR</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
### Small example ###
# Simulate data:
Model &lt;- mlVARsim(nPerson = 100, nNode = 3, nTime = 50, lag=1)

# Estimate using correlated random effects:
fit &lt;- mlVAR(Model$Data, vars = Model$vars, 
             idvar = Model$idvar, lags = 1, 
             temporal = "correlated")

# Sample from fitted model: 
samples &lt;- mlVARsample(fit, nTime = 50, nSample = 50, pMissing = 0.1,
                       nReps = 5, nCores = 1)

# Summarize results:
summary(samples)

## End(Not run) 
</code></pre>

<hr>
<h2 id='mlVARsim'>
Simulates an mlVAR model and data
</h2><span id='topic+mlVARsim'></span>

<h3>Description</h3>

<p>Simulates an mlVAR model and data with a random variance-covariance matrix for the random effects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mlVARsim(nPerson = 10, nNode = 5, nTime = 100, lag = 1, thetaVar = rep(1,nNode),
DF_theta = nNode * 2, mu_SD = c(1, 1), init_beta_SD = c(0.1, 1), fixedMuSD = 1, 
shrink_fixed = 0.9, shrink_deviation = 0.9)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mlVARsim_+3A_nperson">nPerson</code></td>
<td>

<p>Number of subjects
</p>
</td></tr>
<tr><td><code id="mlVARsim_+3A_nnode">nNode</code></td>
<td>

<p>Number of variables
</p>
</td></tr>
<tr><td><code id="mlVARsim_+3A_ntime">nTime</code></td>
<td>

<p>Number of observations per person
</p>
</td></tr>
<tr><td><code id="mlVARsim_+3A_lag">lag</code></td>
<td>

<p>The maximum lag to be used
</p>
</td></tr>
<tr><td><code id="mlVARsim_+3A_thetavar">thetaVar</code></td>
<td>

<p>Contemporaneous fixed effect variances
</p>
</td></tr>
<tr><td><code id="mlVARsim_+3A_df_theta">DF_theta</code></td>
<td>

<p>Degrees of freedom in simulating person-specific contemporaneous covariances (e.g., the individual differences in contemporaneous effects)
</p>
</td></tr>
<tr><td><code id="mlVARsim_+3A_mu_sd">mu_SD</code></td>
<td>

<p>Range of standard deviation for the means
</p>
</td></tr>
<tr><td><code id="mlVARsim_+3A_init_beta_sd">init_beta_SD</code></td>
<td>

<p>Initial range of standard deviations for the temporal effects
</p>
</td></tr>
<tr><td><code id="mlVARsim_+3A_fixedmusd">fixedMuSD</code></td>
<td>

<p>Standard deviation used in sampling the fixed effects
</p>
</td></tr>
<tr><td><code id="mlVARsim_+3A_shrink_fixed">shrink_fixed</code></td>
<td>

<p>Shrinkage factor for shrinking the fixed effects if the VAR model is not stationary
</p>
</td></tr>
<tr><td><code id="mlVARsim_+3A_shrink_deviation">shrink_deviation</code></td>
<td>

<p>Shrinkage factor for shrinking the random effects variance if the VAR model is not stationary
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sacha Epskamp (mail@sachaepskamp.com)
</p>

<hr>
<h2 id='plot.mlVAR'>
Plot Method for mlVAR
</h2><span id='topic+plot.mlVAR'></span><span id='topic+plot.mlVARsim'></span>

<h3>Description</h3>

<p>The function <code>plot.mlVAR</code> plots estimated model coefficients as networks using <code>qgraph</code>. These can be three networks: temporal, contemporaneous and between-subjects effects, of which the latter two can be plotted as a correlation or a partial correlation network.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ## S3 method for class 'mlVAR'
plot(x, type = c("temporal", "contemporaneous", "between"),
                 lag = 1, partial = TRUE, SD = FALSE, subject, order,
                 nonsig = c("default", "show", "hide", "dashed"), rule
                 = c("or", "and"), alpha = 0.05, onlySig = FALSE,
                 layout = "spring", verbose = TRUE, ...)
  ## S3 method for class 'mlVARsim'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.mlVAR_+3A_x">x</code></td>
<td>

<p>An <code>mlVAR</code> object.
</p>
</td></tr>
<tr><td><code id="plot.mlVAR_+3A_type">type</code></td>
<td>

<p>What network to plot?
</p>
</td></tr>
<tr><td><code id="plot.mlVAR_+3A_lag">lag</code></td>
<td>

<p>The lag to use when <code>type = "temporal"</code>
</p>
</td></tr>
<tr><td><code id="plot.mlVAR_+3A_partial">partial</code></td>
<td>

<p>Logical, should partial correlation matrices be plotted instead of correlation methods? Only used if <code>type</code> is <code>"contemporaneous"</code> or <code>"between"</code>. Defaults to <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="plot.mlVAR_+3A_sd">SD</code></td>
<td>

<p>Logical. Plot the standard-deviation of random effects instead of the fixed effect estimate?
</p>
</td></tr>
<tr><td><code id="plot.mlVAR_+3A_subject">subject</code></td>
<td>

<p>Subject number. If not missing, will plot the network of a specific subject instead.
</p>
</td></tr>
<tr><td><code id="plot.mlVAR_+3A_order">order</code></td>
<td>

<p>An optional character vector used to set the order of nodes in the network.
</p>
</td></tr>
<tr><td><code id="plot.mlVAR_+3A_nonsig">nonsig</code></td>
<td>

<p>How to handle non-significant edges? Default will hide non-significant edges when p-values are available (fixed effects, partial correlations and temporal effects).
</p>
</td></tr>
<tr><td><code id="plot.mlVAR_+3A_rule">rule</code></td>
<td>

<p>How to choose significance in node-wise estimated GGMs (contemporaneous and between-subjects). <code>"or"</code> selects an edge as being significant if one node predicting the other is significant, and <code>"and"</code> requires both predictions to be significant.
</p>
</td></tr>
<tr><td><code id="plot.mlVAR_+3A_alpha">alpha</code></td>
<td>

<p>Alpha level to test for significance
</p>
</td></tr>
<tr><td><code id="plot.mlVAR_+3A_onlysig">onlySig</code></td>
<td>

<p>Deprecated argument only used for backward competability.
</p>
</td></tr>
<tr><td><code id="plot.mlVAR_+3A_layout">layout</code></td>
<td>

<p>The layout argument used by <code><a href="qgraph.html#topic+qgraph">qgraph</a></code>
</p>
</td></tr>
<tr><td><code id="plot.mlVAR_+3A_verbose">verbose</code></td>
<td>

<p>Logical, should message be printed to the console?
</p>
</td></tr>
<tr><td><code id="plot.mlVAR_+3A_...">...</code></td>
<td>

<p>Arguments sent to <code><a href="qgraph.html#topic+qgraph">qgraph</a></code>
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sacha Epskamp (mail@sachaepskamp.com)
</p>

<hr>
<h2 id='plot.mlVAR0'>
Plot Method for mlVAR0
</h2><span id='topic+plot.mlVAR0'></span>

<h3>Description</h3>

<p>The function <code>plot.mlVAR0</code> plots estimated model coefficients as a network using <code>qgraph</code>.
</p>
<p>FUNCTION IS DEPRECATED AND WILL BE REMOVED SOON.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ## S3 method for class 'mlVAR0'
plot(x, type = c("fixed", "SD", "subject"), lag = 1,
                 subject, order, onlySig = FALSE, alpha, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.mlVAR0_+3A_x">x</code></td>
<td>

<p>A <code>mlVAR0</code> object obtained through the <code><a href="#topic+mlVAR0">mlVAR0</a></code>-function
</p>
</td></tr>
<tr><td><code id="plot.mlVAR0_+3A_type">type</code></td>
<td>

<p>Indicates whether to plot a network of fixed effects coefficients (&quot;fixed&quot;), the standard deviations of the random effect terms (&quot;SD&quot;) or an individual subject's random effects network (&quot;subject&quot;).
</p>
</td></tr>
<tr><td><code id="plot.mlVAR0_+3A_lag">lag</code></td>
<td>

<p>Vector indicating the lags to include
</p>
</td></tr>
<tr><td><code id="plot.mlVAR0_+3A_subject">subject</code></td>
<td>

<p>If type=&quot;subject&quot;, vector indicating the ID subject number
</p>
</td></tr>
<tr><td><code id="plot.mlVAR0_+3A_order">order</code></td>
<td>

<p>Order of nodes
</p>
</td></tr>
<tr><td><code id="plot.mlVAR0_+3A_onlysig">onlySig</code></td>
<td>

<p>Logical. Set to <code>TRUE</code> to only plot significant fixed effects.
</p>
</td></tr>
<tr><td><code id="plot.mlVAR0_+3A_alpha">alpha</code></td>
<td>

<p>Significance level to test edges at if <code>onlySig == TRUE</code>. Defaults to Bonferonni corrected alpha level of 0.05 divided by the number of fixed effects.
</p>
</td></tr>
<tr><td><code id="plot.mlVAR0_+3A_...">...</code></td>
<td>

<p>Arguments sent to <code><a href="qgraph.html#topic+qgraph">qgraph</a></code>
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sacha Epskamp (mail@sachaepskamp.com), Marie K. Deserno (m.k.deserno@uva.nl) and Laura F. Bringmann (laura.bringmann@ppw.kuleuven.be)
</p>

<hr>
<h2 id='simulateVAR'>
Simulate data from VAR model
</h2><span id='topic+simulateVAR'></span>

<h3>Description</h3>

<p>Simulates a timeseries using VAR parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulateVAR(pars,  means = 0, lags = 1, Nt = 100, init, residuals = 0.1,
                 burnin)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simulateVAR_+3A_pars">pars</code></td>
<td>

<p>A square matrix or a list of square matrices indicating the VAR parameters
</p>
</td></tr>
<tr><td><code id="simulateVAR_+3A_means">means</code></td>
<td>

<p>A vector of means.
</p>
</td></tr>
<tr><td><code id="simulateVAR_+3A_lags">lags</code></td>
<td>

<p>The lags to which the 'pars' argument parameters correspond. If 'pars' is a list then this argument should be a vector indicating which lags are represented by each element of the 'pars' list.
</p>
</td></tr>
<tr><td><code id="simulateVAR_+3A_nt">Nt</code></td>
<td>

<p>Number of time points
</p>
</td></tr>
<tr><td><code id="simulateVAR_+3A_init">init</code></td>
<td>

<p>Initial setup. Must be a matrix of the first lags with rows corresponding to time points and columns corresponding to variables (e.g., if only two lags are used then the matrix must have two rows indicating the first two times points.)
</p>
</td></tr>
<tr><td><code id="simulateVAR_+3A_residuals">residuals</code></td>
<td>

<p>Standard deviation of the residuals or a residual covariance matrix
</p>
</td></tr>
<tr><td><code id="simulateVAR_+3A_burnin">burnin</code></td>
<td>

<p>Initial simulations not returned. Defaults to <code> min(round(Nt/2), 100)</code>.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sacha Epskamp (mail@sachaepskamp.com), Marie K. Deserno (m.k.deserno@uva.nl) and Laura F. Bringmann (laura.bringmann@ppw.kuleuven.be)
</p>

<hr>
<h2 id='summary.mlVAR'>
Summary of mlVAR results
</h2><span id='topic+summary.mlVAR'></span><span id='topic+print.mlVAR'></span>

<h3>Description</h3>

<p>Prints tables with fit indices and parameter estimates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mlVAR'
summary(object, show = c("fit", "temporal", "contemporaneous", "between"), 
      round = 3, ...)
## S3 method for class 'mlVAR'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.mlVAR_+3A_object">object</code></td>
<td>

<p>An <code>mlVAR</code> object.
</p>
</td></tr>
<tr><td><code id="summary.mlVAR_+3A_show">show</code></td>
<td>

<p>Which tables to show?
</p>
</td></tr>
<tr><td><code id="summary.mlVAR_+3A_round">round</code></td>
<td>

<p>Number of digits.
</p>
</td></tr>
<tr><td><code id="summary.mlVAR_+3A_x">x</code></td>
<td>

<p>An <code>mlVAR</code> object.
</p>
</td></tr>
<tr><td><code id="summary.mlVAR_+3A_...">...</code></td>
<td>

<p>Not used
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sacha Epskamp (mail@sachaepskamp.com), Marie K. Deserno (m.k.deserno@uva.nl) and Laura F. Bringmann (laura.bringmann@ppw.kuleuven.be)
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
