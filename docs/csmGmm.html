<!DOCTYPE html><html lang="en"><head><title>Help for package csmGmm</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {csmGmm}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#calc_dens_cor'><p>calc_dens_cor.R</p></a></li>
<li><a href='#calc_dens_ind_2d'><p>calc_dens_ind.R</p></a></li>
<li><a href='#calc_dens_ind_3d'><p>Calculate J trivariate normal densities (all dimensions are independent) under fitted csmGmm.</p></a></li>
<li><a href='#calc_dens_ind_multiple'><p>Calculate the density of K-dimensional multivariate normal (all dimensions are independent) under fitted acsGmm.</p></a></li>
<li><a href='#check_incongruous'><p>check_incongruous.R</p></a></li>
<li><a href='#find_2d'><p>Tells if row x if allTestStats is an incongruous result (has a higher lfdr than a set of</p>
test statistics with lower magnitudes). For K=2 case.</a></li>
<li><a href='#find_3d'><p>Tells if row x if allTestStats is an incongruous result (has a higher lfdr than a set of</p>
test statistics with lower magnitudes). For K=3 case.</a></li>
<li><a href='#find_max_means'><p>find_max_means.R</p></a></li>
<li><a href='#symm_fit_cor_EM'><p>symm_fit_cor.R</p></a></li>
<li><a href='#symm_fit_cor_EM_fulllik'><p>symm_fit_cor_fulllik.R</p></a></li>
<li><a href='#symm_fit_cor_EM_noAssumption'><p>symm_fit_cor_noAssumption.R</p></a></li>
<li><a href='#symm_fit_cor_EM_rho'><p>symm_fit_cor_rho.R</p></a></li>
<li><a href='#symm_fit_ind_EM'><p>symm_fit_ind.R</p></a></li>
<li><a href='#symm_fit_ind_EM_noAssumption'><p>symm_fit_ind_noAssumption.R</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Conditionally Symmetric Multidimensional Gaussian Mixture Model</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements the conditionally symmetric multidimensional Gaussian mixture model (csmGmm) for large-scale testing of composite null hypotheses in genetic association applications such as mediation analysis, pleiotropy analysis, and replication analysis. In such analyses, we typically have J sets of K test statistics where K is a small number (e.g. 2 or 3) and J is large (e.g. 1 million). For each one of the J sets, we want to know if we can reject all K individual nulls. Please see the vignette for a quickstart guide. The paper describing these methods is "Testing a Large Number of Composite Null Hypotheses Using Conditionally Symmetric Multidimensional Gaussian Mixtures in Genome-Wide Studies" by Sun R, McCaw Z, &amp; Lin X (2024, &lt;<a href="https://doi.org/10.1080%2F01621459.2024.2422124">doi:10.1080/01621459.2024.2422124</a>&gt;). The paper is accepted and published online (but not yet in print) in the Journal of the American Statistical Association as of Dec 1 2024.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr, mvtnorm, rlang, magrittr</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-12-02 20:45:12 UTC; rsun3</td>
</tr>
<tr>
<td>Author:</td>
<td>Ryan Sun [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Ryan Sun &lt;ryansun.work@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-12-03 19:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='calc_dens_cor'>calc_dens_cor.R</h2><span id='topic+calc_dens_cor'></span>

<h3>Description</h3>

<p>For J*2 matrix of J sets, calculate the density of bivariate normal under fitted c-csmGmm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_dens_cor(x, Zmat, corMat, log = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calc_dens_cor_+3A_x">x</code></td>
<td>
<p>2*1 vector of means.</p>
</td></tr>
<tr><td><code id="calc_dens_cor_+3A_zmat">Zmat</code></td>
<td>
<p>J*2 matrix of test statistics.</p>
</td></tr>
<tr><td><code id="calc_dens_cor_+3A_cormat">corMat</code></td>
<td>
<p>2*2 matrix describing correlation structure of test statistics.</p>
</td></tr>
<tr><td><code id="calc_dens_cor_+3A_log">log</code></td>
<td>
<p>return logarithm of density</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A J*1 vector of densities for each row of Zmat.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- c(0, 0)
Zmat &lt;- cbind(rnorm(10^5), rnorm(10^5))
calc_dens_cor(x, Zmat, corMat = cor(Zmat))

</code></pre>

<hr>
<h2 id='calc_dens_ind_2d'>calc_dens_ind.R</h2><span id='topic+calc_dens_ind_2d'></span>

<h3>Description</h3>

<p>Calculate J bivariate normal densities (both dimensions are independent) under fitted csmGmm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_dens_ind_2d(x, Zmat)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calc_dens_ind_2d_+3A_x">x</code></td>
<td>
<p>2*1 vector of means.</p>
</td></tr>
<tr><td><code id="calc_dens_ind_2d_+3A_zmat">Zmat</code></td>
<td>
<p>J*2 matrix of test statistics.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A J*1 vector of densities for each row of Zmat.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- c(0, 0)
Zmat &lt;- cbind(rnorm(10^5), rnorm(10^5))
calc_dens_ind_2d(x, Zmat)

</code></pre>

<hr>
<h2 id='calc_dens_ind_3d'>Calculate J trivariate normal densities (all dimensions are independent) under fitted csmGmm.</h2><span id='topic+calc_dens_ind_3d'></span>

<h3>Description</h3>

<p>Calculate J trivariate normal densities (all dimensions are independent) under fitted csmGmm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_dens_ind_3d(x, Zmat)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calc_dens_ind_3d_+3A_x">x</code></td>
<td>
<p>3*1 vector of means.</p>
</td></tr>
<tr><td><code id="calc_dens_ind_3d_+3A_zmat">Zmat</code></td>
<td>
<p>J*3 matrix of test statistics.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A J*1 vector of densities for each row of Zmat.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- c(0, 0)
Zmat &lt;- cbind(rnorm(10^5), rnorm(10^5), rnorm(10^5))
calc_dens_ind_3d(x, Zmat)

</code></pre>

<hr>
<h2 id='calc_dens_ind_multiple'>Calculate the density of K-dimensional multivariate normal (all dimensions are independent) under fitted acsGmm.</h2><span id='topic+calc_dens_ind_multiple'></span>

<h3>Description</h3>

<p>Calculate the density of K-dimensional multivariate normal (all dimensions are independent) under fitted acsGmm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_dens_ind_multiple(x, Zmat)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calc_dens_ind_multiple_+3A_x">x</code></td>
<td>
<p>K*1 vector of means.</p>
</td></tr>
<tr><td><code id="calc_dens_ind_multiple_+3A_zmat">Zmat</code></td>
<td>
<p>J*K matrix of test statistics.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A J*1 vector of densities for each row of Zmat.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- c(0, 0)
Zmat &lt;- cbind(rnorm(10^5), rnorm(10^5), rnorm(10^5), rnorm(10^5))
calc_dens_ind_multiple(x, Zmat)

</code></pre>

<hr>
<h2 id='check_incongruous'>check_incongruous.R</h2><span id='topic+check_incongruous'></span>

<h3>Description</h3>

<p>Check the number of sets of test statistics that have a higher (less significant) lfdr value
than other sets with test statistics of uniformly smaller magnitudes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_incongruous(zMatrix, lfdrVec)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check_incongruous_+3A_zmatrix">zMatrix</code></td>
<td>
<p>J*K vector of all test statistics.</p>
</td></tr>
<tr><td><code id="check_incongruous_+3A_lfdrvec">lfdrVec</code></td>
<td>
<p>J*1 vector of lfdr values corresponding to each set of test statistics.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector with all the indices of all sets that have a higher lfdr value those a set
with smaller test statistic magnitudes.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>zMatrix &lt;- cbind(rnorm(10^4), rnorm(10^4))
lfdrVec &lt;- runif(10^4)
check_incongruous(zMatrix = zMatrix, lfdrVec = lfdrVec)

</code></pre>

<hr>
<h2 id='find_2d'>Tells if row x if allTestStats is an incongruous result (has a higher lfdr than a set of
test statistics with lower magnitudes). For K=2 case.</h2><span id='topic+find_2d'></span>

<h3>Description</h3>

<p>Tells if row x if allTestStats is an incongruous result (has a higher lfdr than a set of
test statistics with lower magnitudes). For K=2 case.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>find_2d(x, allTestStats)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="find_2d_+3A_x">x</code></td>
<td>
<p>Scalar, which row of allTestStats to check.</p>
</td></tr>
<tr><td><code id="find_2d_+3A_allteststats">allTestStats</code></td>
<td>
<p>J*K vector of all test statistics.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A scalar denoting the number of sets with lower lfdr and test statistics of lower magnitude. 0 means congruous result.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>zMatrix &lt;- cbind(rnorm(10^4), rnorm(10^4))
find_2d(x = 5, allTestStats = zMatrix)

</code></pre>

<hr>
<h2 id='find_3d'>Tells if row x if allTestStats is an incongruous result (has a higher lfdr than a set of
test statistics with lower magnitudes). For K=3 case.</h2><span id='topic+find_3d'></span>

<h3>Description</h3>

<p>Tells if row x if allTestStats is an incongruous result (has a higher lfdr than a set of
test statistics with lower magnitudes). For K=3 case.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>find_3d(x, allTestStats)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="find_3d_+3A_x">x</code></td>
<td>
<p>Scalar, which row of allTestStats to check.</p>
</td></tr>
<tr><td><code id="find_3d_+3A_allteststats">allTestStats</code></td>
<td>
<p>J*K vector of all test statistics.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A scalar denoting the number of sets with lower lfdr and test statistics of lower magnitude. 0 means congruous result.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>zMatrix &lt;- cbind(rnorm(10^4), rnorm(10^4),  rnorm(10^4))
find_3d(x = 5, allTestStats = zMatrix)

</code></pre>

<hr>
<h2 id='find_max_means'>find_max_means.R</h2><span id='topic+find_max_means'></span>

<h3>Description</h3>

<p>Find maximum means for each dimension in null settings.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>find_max_means(muInfo)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="find_max_means_+3A_muinfo">muInfo</code></td>
<td>
<p>A list with 2^K elements, where each element is a matrix with K rows and Mb columns.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A K*1 vector of the maximum means for each dimension under the null.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>initMuList &lt;- list(matrix(data=0, nrow=2, ncol=1), matrix(data=c(0, 3, 0, 6), nrow=2),
matrix(data=c(3, 0, 6, 0), nrow=2), matrix(data=c(8, 8), nrow=2))
find_max_means(initMuList)
</code></pre>

<hr>
<h2 id='symm_fit_cor_EM'>symm_fit_cor.R</h2><span id='topic+symm_fit_cor_EM'></span>

<h3>Description</h3>

<p>Fit the correlated csmGmm for sets of correlated elements. Currently restricted to K=2.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>symm_fit_cor_EM(
  testStats,
  corMat,
  initMuList,
  initPiList,
  eps = 10^(-5),
  checkpoint = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="symm_fit_cor_EM_+3A_teststats">testStats</code></td>
<td>
<p>J*K matrix of test statistics where J is the number of sets and K is number of elements in each set.</p>
</td></tr>
<tr><td><code id="symm_fit_cor_EM_+3A_cormat">corMat</code></td>
<td>
<p>K*K matrix that describes the correlation structure of each set.</p>
</td></tr>
<tr><td><code id="symm_fit_cor_EM_+3A_initmulist">initMuList</code></td>
<td>
<p>List of 2^K elements where each element is a matrix with K rows and number of columns equal to the number of possible mean vectors for that binary group.</p>
</td></tr>
<tr><td><code id="symm_fit_cor_EM_+3A_initpilist">initPiList</code></td>
<td>
<p>List of 2^K elements where each element is a vector with number of elements equal to the number of possible mean vectors for that binary group.</p>
</td></tr>
<tr><td><code id="symm_fit_cor_EM_+3A_eps">eps</code></td>
<td>
<p>Scalar, stop the EM algorithm when L2 norm of difference in parameters is less than this value.</p>
</td></tr>
<tr><td><code id="symm_fit_cor_EM_+3A_checkpoint">checkpoint</code></td>
<td>
<p>Boolean, set to TRUE to print iterations of EM.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the elements:
</p>
<table role = "presentation">
<tr><td><code>muInfo</code></td>
<td>
<p>List with same dimensions as initMuList, holds the final mean parameters.</p>
</td></tr>
<tr><td><code>piInfo</code></td>
<td>
<p>List with same dimensions as initPiList, holds the final probability parameters.</p>
</td></tr>
<tr><td><code>iter</code></td>
<td>
<p>Number of iterations run in EM algorithm.</p>
</td></tr>
<tr><td><code>lfdrResults</code></td>
<td>
<p>J*1 vector of all lfdr statistics.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(0)
corMat &lt;- matrix(data=c(1, 0.3, 0.3, 1), nrow=2)
testStats &lt;- rbind(mvtnorm::rmvnorm(n=200, mean=c(3, 0), sigma=corMat),
mvtnorm::rmvnorm(n=200, mean=c(0, 4), sigma=corMat),
mvtnorm::rmvnorm(n=100, mean=c(7, 7), sigma=corMat),
mvtnorm::rmvnorm(n=10^4 - 500, mean=c(0, 0), sigma=corMat))
initMuList &lt;- list(matrix(data=0, nrow=2, ncol=1), matrix(data=c(0, 3), nrow=2),
matrix(data=c(4, 0), nrow=2), matrix(data=c(5, 5), nrow=2))
initPiList &lt;- list(c(0.9), c(0.04), c(0.04), c(0.02))
results &lt;- symm_fit_cor_EM(testStats = testStats, corMat = cor(testStats),
initMuList = initMuList, initPiList = initPiList)


</code></pre>

<hr>
<h2 id='symm_fit_cor_EM_fulllik'>symm_fit_cor_fulllik.R</h2><span id='topic+symm_fit_cor_EM_fulllik'></span>

<h3>Description</h3>

<p>Full likelihood, block correlation, blocks of size 2
</p>


<h3>Usage</h3>

<pre><code class='language-R'>symm_fit_cor_EM_fulllik(
  testStats,
  corMat,
  initMuList,
  initPiList,
  eps = 10^(-5),
  checkpoint = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="symm_fit_cor_EM_fulllik_+3A_teststats">testStats</code></td>
<td>
<p>J*K matrix of test statistics where J is the number of sets and K is number of elements in each set.</p>
</td></tr>
<tr><td><code id="symm_fit_cor_EM_fulllik_+3A_cormat">corMat</code></td>
<td>
<p>K*K matrix that describes the correlation structure of each 2 by 2 block.</p>
</td></tr>
<tr><td><code id="symm_fit_cor_EM_fulllik_+3A_initmulist">initMuList</code></td>
<td>
<p>List of 2^K elements where each element is a matrix with K rows and number of columns equal to the number of possible mean vectors for that binary group.</p>
</td></tr>
<tr><td><code id="symm_fit_cor_EM_fulllik_+3A_initpilist">initPiList</code></td>
<td>
<p>List of 2^K elements where each element is a vector with number of elements equal to the number of possible mean vectors for that binary group.</p>
</td></tr>
<tr><td><code id="symm_fit_cor_EM_fulllik_+3A_eps">eps</code></td>
<td>
<p>Scalar, stop the EM algorithm when L2 norm of difference in parameters is less than this value.</p>
</td></tr>
<tr><td><code id="symm_fit_cor_EM_fulllik_+3A_checkpoint">checkpoint</code></td>
<td>
<p>Boolean, set to TRUE to print iterations of EM.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the elements:
</p>
<table role = "presentation">
<tr><td><code>muInfo</code></td>
<td>
<p>List with same dimensions as initMuList, holds the final mean parameters.</p>
</td></tr>
<tr><td><code>piInfo</code></td>
<td>
<p>List with same dimensions as initPiList, holds the final probability parameters.</p>
</td></tr>
<tr><td><code>iter</code></td>
<td>
<p>Number of iterations run in EM algorithm.</p>
</td></tr>
<tr><td><code>lfdrResults</code></td>
<td>
<p>J*1 vector of all lfdr statistics.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(0)
testStats &lt;- cbind(rnorm(10^4), rnorm(10^4))
testStats[1:100, 1] &lt;- rnorm(100, mean=3)
testStats[101:200, 1] &lt;- rnorm(100, mean=5)
testStats[201:300, 2] &lt;- rnorm(100, mean=4)
testStats[301:400, 1:2] &lt;- rnorm(200, mean=7)
initMuList &lt;- list(matrix(data=0, nrow=2, ncol=1), matrix(data=c(0, 3), nrow=2, ncol=1),
matrix(data=c(3, 0), nrow=2, ncol=1), matrix(data=c(6, 6), nrow=2, ncol=1))
initPiList &lt;- list(c(0.9), c(0.04),c(0.04), c(0.02))
results &lt;- symm_fit_cor_EM_fulllik(testStats = testStats, corMat=diag(c(1,1)),
initMuList = initMuList, initPiList = initPiList)

</code></pre>

<hr>
<h2 id='symm_fit_cor_EM_noAssumption'>symm_fit_cor_noAssumption.R</h2><span id='topic+symm_fit_cor_EM_noAssumption'></span>

<h3>Description</h3>

<p>Fit the correlated csmGmm for sets of correlated elements,
but we don't assume that the means in the composite alternative are greater in magnitude than those in the composite null.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>symm_fit_cor_EM_noAssumption(
  testStats,
  corMat,
  initMuList,
  initPiList,
  eps = 10^(-5),
  checkpoint = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="symm_fit_cor_EM_noAssumption_+3A_teststats">testStats</code></td>
<td>
<p>J*K matrix of test statistics where J is the number of sets and K is number of elements in each set.</p>
</td></tr>
<tr><td><code id="symm_fit_cor_EM_noAssumption_+3A_cormat">corMat</code></td>
<td>
<p>K*K matrix that describes the correlation structure of each set.</p>
</td></tr>
<tr><td><code id="symm_fit_cor_EM_noAssumption_+3A_initmulist">initMuList</code></td>
<td>
<p>List of 2^K elements where each element is a matrix with K rows and number of columns equal to the number of possible mean vectors for that binary group.</p>
</td></tr>
<tr><td><code id="symm_fit_cor_EM_noAssumption_+3A_initpilist">initPiList</code></td>
<td>
<p>List of 2^K elements where each element is a vector with number of elements equal to the number of possible mean vectors for that binary group.</p>
</td></tr>
<tr><td><code id="symm_fit_cor_EM_noAssumption_+3A_eps">eps</code></td>
<td>
<p>Scalar, stop the EM algorithm when L2 norm of difference in parameters is less than this value.</p>
</td></tr>
<tr><td><code id="symm_fit_cor_EM_noAssumption_+3A_checkpoint">checkpoint</code></td>
<td>
<p>Boolean, set to TRUE to print iterations of EM.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the elements:
</p>
<table role = "presentation">
<tr><td><code>muInfo</code></td>
<td>
<p>List with same dimensions as initMuList, holds the final mean parameters.</p>
</td></tr>
<tr><td><code>piInfo</code></td>
<td>
<p>List with same dimensions as initPiList, holds the final probability parameters.</p>
</td></tr>
<tr><td><code>iter</code></td>
<td>
<p>Number of iterations run in EM algorithm.</p>
</td></tr>
<tr><td><code>lfdrResults</code></td>
<td>
<p>J*1 vector of all lfdr statistics.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(0)
corMat &lt;- matrix(data=c(1, 0.3, 0.3, 1), nrow=2)
testStats &lt;- rbind(mvtnorm::rmvnorm(n=200, mean=c(3, 0), sigma=corMat),
mvtnorm::rmvnorm(n=200, mean=c(0, 4), sigma=corMat),
mvtnorm::rmvnorm(n=100, mean=c(7, 7), sigma=corMat),
mvtnorm::rmvnorm(n=10^4 - 500, mean=c(0, 0), sigma=corMat))
initMuList &lt;- list(matrix(data=0, nrow=2, ncol=1), matrix(data=c(0, 3), nrow=2),
matrix(data=c(4, 0), nrow=2), matrix(data=c(5, 5), nrow=2))
initPiList &lt;- list(c(0.9), c(0.04), c(0.04), c(0.02))
results &lt;- symm_fit_cor_EM_noAssumption(testStats = testStats,
corMat = cor(testStats), initMuList = initMuList, initPiList = initPiList)

</code></pre>

<hr>
<h2 id='symm_fit_cor_EM_rho'>symm_fit_cor_rho.R</h2><span id='topic+symm_fit_cor_EM_rho'></span>

<h3>Description</h3>

<p>Fit the correlated csmGmm for sets of correlated elements. Also fits the correlation parameter in EM algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>symm_fit_cor_EM_rho(
  testStats,
  initRho,
  initMuList,
  initPiList,
  eps = 10^(-5),
  checkpoint = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="symm_fit_cor_EM_rho_+3A_teststats">testStats</code></td>
<td>
<p>J*K matrix of test statistics where J is the number of sets and K is number of elements in each set.</p>
</td></tr>
<tr><td><code id="symm_fit_cor_EM_rho_+3A_initrho">initRho</code></td>
<td>
<p>Initial value of rho, any reasonable guess should be ok.</p>
</td></tr>
<tr><td><code id="symm_fit_cor_EM_rho_+3A_initmulist">initMuList</code></td>
<td>
<p>List of 2^K elements where each element is a matrix with K rows and number of columns equal to the number of possible mean vectors for that binary group.</p>
</td></tr>
<tr><td><code id="symm_fit_cor_EM_rho_+3A_initpilist">initPiList</code></td>
<td>
<p>List of 2^K elements where each element is a vector with number of elements equal to the number of possible mean vectors for that binary group.</p>
</td></tr>
<tr><td><code id="symm_fit_cor_EM_rho_+3A_eps">eps</code></td>
<td>
<p>Scalar, stop the EM algorithm when L2 norm of difference in parameters is less than this value.</p>
</td></tr>
<tr><td><code id="symm_fit_cor_EM_rho_+3A_checkpoint">checkpoint</code></td>
<td>
<p>Boolean, set to TRUE to print iterations of EM.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the elements:
</p>
<table role = "presentation">
<tr><td><code>muInfo</code></td>
<td>
<p>List with same dimensions as initMuList, holds the final mean parameters.</p>
</td></tr>
<tr><td><code>piInfo</code></td>
<td>
<p>List with same dimensions as initPiList, holds the final probability parameters.</p>
</td></tr>
<tr><td><code>iter</code></td>
<td>
<p>Number of iterations run in EM algorithm.</p>
</td></tr>
<tr><td><code>lfdrResults</code></td>
<td>
<p>J*1 vector of all lfdr statistics.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(0)
corMat &lt;- matrix(data=c(1, 0.3, 0.3, 1), nrow=2)
testStats &lt;- rbind(mvtnorm::rmvnorm(n=200, mean=c(3, 0), sigma=corMat),
mvtnorm::rmvnorm(n=200, mean=c(0, 4), sigma=corMat),
mvtnorm::rmvnorm(n=100, mean=c(7, 7), sigma=corMat),
mvtnorm::rmvnorm(n=10^4 - 500, mean=c(0, 0), sigma=corMat))
initMuList &lt;- list(matrix(data=0, nrow=2, ncol=1), matrix(data=c(0, 3), nrow=2),
matrix(data=c(4, 0), nrow=2), matrix(data=c(5, 5), nrow=2))
initPiList &lt;- list(c(0.9), c(0.04), c(0.04), c(0.02))
results &lt;- symm_fit_cor_EM_rho(testStats = testStats,
initRho = 0.1, initMuList = initMuList, initPiList = initPiList)

</code></pre>

<hr>
<h2 id='symm_fit_ind_EM'>symm_fit_ind.R</h2><span id='topic+symm_fit_ind_EM'></span>

<h3>Description</h3>

<p>Fit the conditionally symmetric multidimensional Gaussian mixture model for sets of independent elements
</p>


<h3>Usage</h3>

<pre><code class='language-R'>symm_fit_ind_EM(
  testStats,
  initMuList,
  initPiList,
  sameDirAlt = FALSE,
  eps = 10^(-5),
  checkpoint = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="symm_fit_ind_EM_+3A_teststats">testStats</code></td>
<td>
<p>J*K matrix of test statistics where J is the number of sets and K is number of elements in each set.</p>
</td></tr>
<tr><td><code id="symm_fit_ind_EM_+3A_initmulist">initMuList</code></td>
<td>
<p>List of 2^K elements where each element is a matrix with K rows and number of columns equal to the number of possible mean vectors for that binary representation.</p>
</td></tr>
<tr><td><code id="symm_fit_ind_EM_+3A_initpilist">initPiList</code></td>
<td>
<p>List of 2^K elements where each element is a vector with number of elements equal to the number of possible mean vectors for that binary representation.</p>
</td></tr>
<tr><td><code id="symm_fit_ind_EM_+3A_samediralt">sameDirAlt</code></td>
<td>
<p>Boolean, set to TRUE for replication testing, which uses a smaller alternative space.</p>
</td></tr>
<tr><td><code id="symm_fit_ind_EM_+3A_eps">eps</code></td>
<td>
<p>Scalar, stop the EM algorithm when L2 norm of difference in parameters is less than this value.</p>
</td></tr>
<tr><td><code id="symm_fit_ind_EM_+3A_checkpoint">checkpoint</code></td>
<td>
<p>Boolean, set to TRUE to print iterations of EM</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the elements:
</p>
<table role = "presentation">
<tr><td><code>muInfo</code></td>
<td>
<p>List with same dimensions as initMuList, holds the final mean parameters.</p>
</td></tr>
<tr><td><code>piInfo</code></td>
<td>
<p>List with same dimensions as initPiList, holds the final mixture proportions</p>
</td></tr>
<tr><td><code>iter</code></td>
<td>
<p>Number of iterations run in EM algorithm.</p>
</td></tr>
<tr><td><code>lfdrResults</code></td>
<td>
<p>J*1 vector of all lfdr statistics.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(0)
testStats &lt;- cbind(rnorm(10^4), rnorm(10^4))
testStats[1:200, 1] &lt;- rnorm(100, mean=3)
testStats[201:400, 1] &lt;- rnorm(100, mean=5)
testStats[401:600, 2] &lt;- rnorm(100, mean=3)
testStats[601:800, 2] &lt;- rnorm(100, mean=5)
testStats[801:1000, 1:2] &lt;- rnorm(200, mean=7)
initMuList &lt;- list(matrix(data=0, nrow=2, ncol=1), matrix(data=c(0, 3, 0, 5), nrow=2, ncol=2),
matrix(data=c(3, 0, 5, 0), nrow=2, ncol=2), matrix(data=c(7, 7), nrow=2, ncol=1))
initPiList &lt;- list(c(0.9), c(0.02, 0.02),c(0.02, 0.02), c(0.02))
results &lt;- symm_fit_ind_EM(testStats = testStats, initMuList = initMuList, initPiList = initPiList)

</code></pre>

<hr>
<h2 id='symm_fit_ind_EM_noAssumption'>symm_fit_ind_noAssumption.R</h2><span id='topic+symm_fit_ind_EM_noAssumption'></span>

<h3>Description</h3>

<p>Fit the conditionally symmetric multidimensional Gaussian mixture model for sets of independent elements,
but we don't assume that the means in the composite alternative are greater in magnitude than those in the composite null.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>symm_fit_ind_EM_noAssumption(
  testStats,
  initMuList,
  initPiList,
  sameDirAlt = FALSE,
  eps = 10^(-5),
  checkpoint = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="symm_fit_ind_EM_noAssumption_+3A_teststats">testStats</code></td>
<td>
<p>J*K matrix of test statistics where J is the number of sets and K is number of elements in each set.</p>
</td></tr>
<tr><td><code id="symm_fit_ind_EM_noAssumption_+3A_initmulist">initMuList</code></td>
<td>
<p>List of 2^K elements where each element is a matrix with K rows and number of columns equal to the number of possible mean vectors for that binary representation.</p>
</td></tr>
<tr><td><code id="symm_fit_ind_EM_noAssumption_+3A_initpilist">initPiList</code></td>
<td>
<p>List of 2^K elements where each element is a vector with number of elements equal to the number of possible mean vectors for that binary representation.</p>
</td></tr>
<tr><td><code id="symm_fit_ind_EM_noAssumption_+3A_samediralt">sameDirAlt</code></td>
<td>
<p>Boolean, set to TRUE for replication testing, which uses a smaller alternative space.</p>
</td></tr>
<tr><td><code id="symm_fit_ind_EM_noAssumption_+3A_eps">eps</code></td>
<td>
<p>Scalar, stop the EM algorithm when L2 norm of difference in parameters is less than this value.</p>
</td></tr>
<tr><td><code id="symm_fit_ind_EM_noAssumption_+3A_checkpoint">checkpoint</code></td>
<td>
<p>Boolean, set to TRUE to print iterations of EM</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the elements:
</p>
<table role = "presentation">
<tr><td><code>muInfo</code></td>
<td>
<p>List with same dimensions as initMuList, holds the final mean parameters.</p>
</td></tr>
<tr><td><code>piInfo</code></td>
<td>
<p>List with same dimensions as initPiList, holds the final mixture proportions</p>
</td></tr>
<tr><td><code>iter</code></td>
<td>
<p>Number of iterations run in EM algorithm.</p>
</td></tr>
<tr><td><code>lfdrResults</code></td>
<td>
<p>J*1 vector of all lfdr statistics.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(0)
testStats &lt;- cbind(rnorm(10^4), rnorm(10^4))
testStats[1:200, 1] &lt;- rnorm(100, mean=3)
testStats[201:400, 1] &lt;- rnorm(100, mean=5)
testStats[401:600, 2] &lt;- rnorm(100, mean=3)
testStats[601:800, 2] &lt;- rnorm(100, mean=5)
testStats[801:1000, 1:2] &lt;- rnorm(200, mean=7)
initMuList &lt;- list(matrix(data=0, nrow=2, ncol=1), matrix(data=c(0, 3, 0, 5), nrow=2, ncol=2),
matrix(data=c(3, 0, 5, 0), nrow=2, ncol=2), matrix(data=c(7, 7), nrow=2, ncol=1))
initPiList &lt;- list(c(0.9), c(0.02, 0.02),c(0.02, 0.02), c(0.02))
results &lt;- symm_fit_ind_EM_noAssumption(testStats = testStats,
initMuList = initMuList, initPiList = initPiList)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
