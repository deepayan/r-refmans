<!DOCTYPE html><html><head><title>Help for package crossdes</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {crossdes}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#allcombs'><p>Balanced Row-Column Design with all Possible Treatment Orders</p></a></li>
<li><a href='#balmin.RMD'><p>Function to construct the balanced minimal</p>
repeated measurements designs of Afsarinejad (1983)</a></li>
<li><a href='#biertest.d4'><p>Experimental Design for the Beer Testing Data in Kunert (1998)</p></a></li>
<li><a href='#biertest.dat'><p>The Beer Testing Data in Kunert (1998)</p></a></li>
<li><a href='#biertest.f2'><p>Experimental Design for the Beer Testing Data in Kunert (1998)</p></a></li>
<li><a href='#crossdes-internal'><p> Internal Functions in crossdes</p></a></li>
<li><a href='#crossdes-package'>
<p>Design and Analysis of dose-finding studies</p></a></li>
<li><a href='#des.MOLS'><p>Construction of Designs Based on Mutually Orthogonal Latin Squares</p></a></li>
<li><a href='#find.BIB'><p>Generation of Balanced Incomplete Block Designs Using the Package AlgDesign</p></a></li>
<li><a href='#get.plan'><p>Menu-Driven Construction of Carryover Balanced Experimental Designs</p></a></li>
<li><a href='#isCbalanced'><p>Checking Block Designs for Carryover Balance</p></a></li>
<li><a href='#isGYD'><p>Checking Simple Block and Row-Column Designs for Balance</p></a></li>
<li><a href='#MOLS'><p>Construction of Complete Sets of Mutually Orthogonal Latin Squares</p></a></li>
<li><a href='#williams'><p>Construction of Williams Designs</p></a></li>
<li><a href='#williams.BIB'><p>Construction of Carryover Balanced Designs Based on</p>
Balanced Incomplete Block Designs</a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Date:</td>
<td>2022-04-04</td>
</tr>
<tr>
<td>Title:</td>
<td>Construction of Crossover Designs</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1-2</td>
</tr>
<tr>
<td>Author:</td>
<td>Martin Oliver Sailer</td>
</tr>
<tr>
<td>Depends:</td>
<td>AlgDesign, gtools</td>
</tr>
<tr>
<td>Description:</td>
<td>Contains functions for the construction of carryover
        balanced crossover designs. In addition contains functions to
        check given designs for balance.</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Bjoern Bornkamp &lt;bbnkmp@mail.de&gt;</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-04-04 18:57:03 UTC; bjoern</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-04-04 21:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='allcombs'>Balanced Row-Column Design with all Possible Treatment Orders</h2><span id='topic+allcombs'></span>

<h3>Description</h3>

<p>The function constructs a row-column design with subjects as rows and periods as columns. Each subject
gets each treatment at most once. All possible treatment orders are assigned to the subjects. </p>


<h3>Usage</h3>

<pre><code class='language-R'>allcombs(trt, k)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="allcombs_+3A_trt">trt</code></td>
<td>
<p> An integer &gt; 1. Number of treatments (products) to be tested. </p>
</td></tr>
<tr><td><code id="allcombs_+3A_k">k</code></td>
<td>
<p> An integer <code class="reqn">\leq \, trt</code>. Number of periods for each subject. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The design is a carryover balanced generalized Youden design that is uniform on the columns.
The treatments are numbered 1,...,<code class="reqn">trt</code>. The entry <code class="reqn">(i,j)</code> 
of the design corresponds to the treatment the <code class="reqn">i</code>-th subject gets in the <code class="reqn">j</code>-th period.
</p>


<h3>Value</h3>

<p>A matrix with <code class="reqn">\frac{trt!}{(trt-k)!}</code> rows and <code class="reqn">k</code> columns representing the experimental design.
</p>


<h3>Note</h3>

<p> Requires the package <code>gtools</code>. </p>


<h3>Author(s)</h3>

<p> Oliver Sailer  </p>


<h3>References</h3>

 
<p>Patterson, H.D. (1952): The construction of balanced designs for experiments involving sequences of
treatments. Biometrika 39, 32-48. 
</p>
<p>Wakeling, I.N. and MacFie, H.J.H. (1995): Designing consumer trials balanced for first and higher orders of
carry-over effect when only a subset of k samples from t may be tested. Food Quality and Preference 6, 299-308. </p>


<h3>See Also</h3>

 <p><code><a href="#topic+get.plan">get.plan</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'># Design for 4 treatments assigned in 3 periods.
# All possible treatment orders occur.
allcombs(4,3) 
</code></pre>

<hr>
<h2 id='balmin.RMD'>Function to construct the balanced minimal 
repeated measurements designs of Afsarinejad (1983)</h2><span id='topic+balmin.RMD'></span>

<h3>Description</h3>

<p>The function constructs a row-column design with subjects as rows and periods as columns. The design is incomplete, i.e.
no subject gets all the treatments. The design is balanced for carryover effects but will in general not be
a balanced block design.</p>


<h3>Usage</h3>

<pre><code class='language-R'>balmin.RMD(trt, n, p)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="balmin.RMD_+3A_trt">trt</code></td>
<td>
<p> An integer &gt;1 giving the number of treatments (products) to be tested. </p>
</td></tr>
<tr><td><code id="balmin.RMD_+3A_n">n</code></td>
<td>
<p> An integer &gt;1 giving the number of subjects (assessors) in the study. </p>
</td></tr>
<tr><td><code id="balmin.RMD_+3A_p">p</code></td>
<td>
<p> An integer &gt;1 giving the number of periods for each subject. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>A necessary and sufficient condition for the existence of such a design is 
that <code class="reqn">\frac{(trt-1)}{(p-1)}</code> be a positive integer.
In this case <code class="reqn">n = \frac{trt(trt-1)}{(p-1)}</code>.  
In the resulting design the treatments are numbered 1,...,<code class="reqn">trt</code>. 
The entry <code class="reqn">(i,j)</code> 
of the design corresponds to the treatment the <code class="reqn">i</code>-th subject gets in the <code class="reqn">j</code>-th period.
</p>


<h3>Value</h3>

<p>A matrix with <code class="reqn">n</code> rows and <code class="reqn">p</code> columns representing the experimental design.
</p>


<h3>Author(s)</h3>

<p> Oliver Sailer </p>


<h3>References</h3>

 
<p>Afsarinejad, K. (1983): Balanced repeated measurements designs. Biometrika 70, 199-204.
</p>
<p>Wakeling, I.N. and MacFie, H.J.H. (1995): Designing consumer trials balanced for first and higher orders of
carry-over effect when only a subset of k samples from t may be tested. Food Quality and Preference 6, 299-308. </p>


<h3>See Also</h3>

 <p><code><a href="#topic+get.plan">get.plan</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>balmin.RMD(10,30,4) # a balanced minimal RMD
balmin.RMD(11,22,6) # another balanced minimal RMD
</code></pre>

<hr>
<h2 id='biertest.d4'>Experimental Design for the Beer Testing Data in Kunert (1998)</h2><span id='topic+biertest.d4'></span>

<h3>Description</h3>

<p>The design is a balanced incomplete block design with rows 
as blocks. If one assumes that there is a preperiod, i.e. that each assessor is given the treatment of the fifth period
before the experiment starts, then the design is carryover balanced. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(biertest.d4)</code></pre>


<h3>Format</h3>

<p>A matrix with 12 rows corresponding to the assessors, 5 columns corresponding to 
the five periods. 
</p>


<h3>Details</h3>

<p>The five treatments (products) to be tested are numbered 1,...,5.
</p>


<h3>Source</h3>

<p>Kunert, J. (1998): Sensory experiments as crossover studies. Food Quality and Preference 9, 243-253
(design d4). 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(biertest.d4)
</code></pre>

<hr>
<h2 id='biertest.dat'>The Beer Testing Data in Kunert (1998)</h2><span id='topic+biertest.dat'></span>

<h3>Description</h3>

<p>The data comes from a beer testing experiment where assessors had to rate
the bitterness of five beers.    
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(biertest.dat)</code></pre>


<h3>Format</h3>

<p>A matrix with 12 rows corresponding to the assessors, 5 columns corresponding to 
the five periods.
</p>


<h3>Details</h3>

<p>The possible values for the ratings lie in the interval [0, 12].
Note that the data were reordered after the experiment. </p>


<h3>Source</h3>

<p>Kunert, J. (1998): Sensory experiments as crossover studies. Food Quality and Preference 9, 243-253
(table 1). 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(biertest.dat)
</code></pre>

<hr>
<h2 id='biertest.f2'>Experimental Design for the Beer Testing Data in Kunert (1998)</h2><span id='topic+biertest.f2'></span>

<h3>Description</h3>

<p>The design is a row-column design. It is actually a generalized latin square design that is also carryover balanced. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(biertest.d4)</code></pre>


<h3>Format</h3>

<p>A matrix with 10 rows corresponding to the first 10 assessors in a fictional uniformity trial, 
5 columns corresponding to the five periods. 
</p>


<h3>Details</h3>

<p>There are five products to be tested, numbered 1,...,5.
</p>


<h3>Source</h3>

<p>Kunert, J. (1998): Sensory experiments as crossover studies. Food Quality and Preference 9, 243-253
(design f2). 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(biertest.f2)
</code></pre>

<hr>
<h2 id='crossdes-internal'> Internal Functions in crossdes </h2><span id='topic+choices'></span><span id='topic+design.row'></span><span id='topic+factor.comb'></span><span id='topic+GF'></span><span id='topic+mult'></span><span id='topic+Q.t'></span><span id='topic+redu'></span><span id='topic+redu.modp'></span><span id='topic+tcdf.plot'></span><span id='topic+Td'></span>

<h3>Description</h3>

<p>For internal use only.</p>


<h3>Author(s)</h3>

<p> Oliver Sailer </p>

<hr>
<h2 id='crossdes-package'>
Design and Analysis of dose-finding studies
</h2><span id='topic+crossdes-package'></span><span id='topic+crossdes'></span>

<h3>Description</h3>

<p>The crossdes package provides functions for the construction of of
carryover balanced crossover designs. In addition contains functions
to check given designs for balance.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> crossdes</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.1-1</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2013-03-18</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-2
</td>
</tr>

</table>

<p>The main functions are:<br />
<code><a href="#topic+get.plan">get.plan</a></code>: Menu-driven selection of crossover designs<br />
<code><a href="#topic+allcombs">allcombs</a></code>: Construct crossover design with all possible
treatment orders<br />
<code><a href="#topic+williams">williams</a></code>: Construct a Williams design<br />
<code><a href="#topic+williams.BIB">williams.BIB</a></code>: Construct a crossover design based on a
combination of balanced incomplete block designs and Williams designs.<br />
<code><a href="#topic+des.MOLS">des.MOLS</a></code>: Construct crossover design based on mutually
orthogonal Latin Squares<br />
<code><a href="#topic+balmin.RMD">balmin.RMD</a></code>: Construct balanced minimal repeated
measurements crossover design<br />
<code><a href="#topic+isCbalanced">isCbalanced</a></code>: Check whether a crossover design is balanced
for first order carryover effects<br />
<code><a href="#topic+isGYD">isGYD</a></code>: Check whether a crossover design is balanced<br />
<br />
</p>


<h3>Author(s)</h3>

<p>Martin Oliver Sailer
</p>


<h3>References</h3>

<p>Earlier version of the package:<br />
Sailer, O. (2005): crossdes: A package for design and randomization in crossover studies. Rnews 5/2, 24-27.  
</p>
<p>Overview on cross-over designs:<br />
Jones, B. and Kenward, M.G. (1989): Design and Analysis of Cross-Over Trials. Chapman and Hall, London.
</p>
<p>Wakeling, I.N. and MacFie, H.J.H. (1995): Designing consumer trials balanced for first and higher orders of
carry-over effect when only a subset of k samples from t may be tested. Food Quality and Preference 6, 299-308. 
</p>

<hr>
<h2 id='des.MOLS'>Construction of Designs Based on Mutually Orthogonal Latin Squares</h2><span id='topic+des.MOLS'></span>

<h3>Description</h3>

<p>The function constructs row-column designs based on complete sets of mutually orthogonal latin squares.
Each subject may get each tratment at most once. The design is a generalized Youden design that is also 
balanced for carryover effects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>des.MOLS(trt, k = trt)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="des.MOLS_+3A_trt">trt</code></td>
<td>
<p> A prime power less than 100. The number of treatments (products) to be tested. </p>
</td></tr>
<tr><td><code id="des.MOLS_+3A_k">k</code></td>
<td>
<p> An integer <code class="reqn">\leq \, trt</code>. Number of periods for each subject. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>A complete set of mutually orthogonal latin squares is constructed using Galois Fields. 
The rows of the designs represent the treatment
orders for the subjects. If an incomplete design with <code class="reqn">k</code> columns is needed, 
only the first <code class="reqn">k</code> columns of the designs are 
considered.   
The treatments are numbered 1,...,<code class="reqn">trt</code>. The entry <code class="reqn">(i,j)</code> 
of the design corresponds to the treatment the <code class="reqn">i</code>-th subject gets in the <code class="reqn">j</code>-th period.
</p>


<h3>Value</h3>

<p>A matrix with <code class="reqn">trt(trt-1)</code> rows and <code class="reqn">k</code> columns representing the experimental design.
</p>


<h3>Author(s)</h3>

<p> Oliver Sailer </p>


<h3>References</h3>

 
<p>Wakeling, I.N. and MacFie, H.J.H. (1995): Designing consumer trials balanced for first and higher orders of
carry-over effect when only a subset of k samples from t may be tested. Food Quality and Preference 6, 299-308. 
</p>
<p>Williams, E. J. (1949): Experimental designs balanced for the estimation of residual effects
of treatments. Australian Journal of Scientific Research, Ser. A 2, 149-168. 
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+get.plan">get.plan</a></code>, <code><a href="#topic+MOLS">MOLS</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>des.MOLS(7,7)
des.MOLS(8,5)
</code></pre>

<hr>
<h2 id='find.BIB'>Generation of Balanced Incomplete Block Designs Using the Package AlgDesign</h2><span id='topic+find.BIB'></span>

<h3>Description</h3>

<p>The function <code>optBlock</code> of the library <code>AlgDesign</code> is used to search for balanced incomplete block designs
(BIBDs). The design is assigned to a matrix where rows represent blocks (subjects) and 
columns represent periods.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>find.BIB(trt, b, k, iter = 30)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="find.BIB_+3A_trt">trt</code></td>
<td>
<p> An integer &gt; 1 giving the number of treatments of the design. </p>
</td></tr>
<tr><td><code id="find.BIB_+3A_b">b</code></td>
<td>
<p> An integer &gt; 1 giving the number of rows (subjects) of the design. </p>
</td></tr>
<tr><td><code id="find.BIB_+3A_k">k</code></td>
<td>
<p> An integer &gt; 1 giving the number of columns (periods) of the design. </p>
</td></tr>
<tr><td><code id="find.BIB_+3A_iter">iter</code></td>
<td>
<p> The number of iterations of the function <code>optBlock</code> </p>
</td></tr> 
</table>


<h3>Details</h3>

<p>The function <code>optBlock</code> tries to find a D-optimal block design for the specified parameters.
The resulting design need not be a BIBD. 
The necessary conditions for the existence are that <code class="reqn">\frac{bk}{trt}</code> and 
<code class="reqn">\frac{bk(k-1)}{trt(trt-1)}</code> positive integers.
They are NOT checked automatically.
Even if they are fulfilled, there need not be a BIBD.  
If no BIBD is found, the function is iterated.
If no BIBD is found after <code>iter</code> iterations, the search is terminated.
The resulting design should be checked by the user applying <code>isGYD</code>. 
</p>


<h3>Value</h3>

<p>A matrix that represents the experimental design.
</p>


<h3>Note</h3>

<p> As indicated above, the returned design is not necessarily a BIBD design.</p>


<h3>Author(s)</h3>

<p>Oliver Sailer </p>


<h3>References</h3>

 
<p>Wheeler, R.E. (2004). optBlock. AlgDesign. The R project for statistical computing http://www.r-project.org/ 
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+get.plan">get.plan</a></code>, <code><a href="AlgDesign.html#topic+optBlock">optBlock</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>find.BIB(10,30,4)       # BIBD
find.BIB(3,3,3)         # BIBD 
find.BIB(5,5,3, 100)    # There is no BIBD for these parameters   
# isGYD(find.BIB(5,5,3, 100))
</code></pre>

<hr>
<h2 id='get.plan'>Menu-Driven Construction of Carryover Balanced Experimental Designs</h2><span id='topic+get.plan'></span>

<h3>Description</h3>

<p>This menu based function constructs simple experimental designs for repeated measurements with one or two block 
variables. It is assumed that each subject is assigned to each treatment at most once. A maximum number of 
subjects in the study is also requested. Five possible construction methods available.
These construction methods and the characteristics of the resulting designs are described in Wakeling and MacFie (1995).
See also Jones and Kenward (1989), Ch. 5, for a discussion of these designs. The function is demonstrated in more detail 
in Sailer (2005).</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.plan(trt, k = trt, maxsub = 1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get.plan_+3A_trt">trt</code></td>
<td>
<p> An integer &gt; 1, giving the number of treatments.</p>
</td></tr>
<tr><td><code id="get.plan_+3A_k">k</code></td>
<td>
<p> An integer in {2,...,<code class="reqn">trt</code>} giving the number of periods.</p>
</td></tr>
<tr><td><code id="get.plan_+3A_maxsub">maxsub</code></td>
<td>
<p> The maximum number of subjects available.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The five types of designs are: designs based on all possible treatment orders (&quot;all.combin&quot;),
Williams designs (&quot;williams&quot;), designs based on 
mutually orthogonal latin squares (&quot;des.MOLS&quot;), a combination of balanced incomplete block designs (BIBDs) and Williams designs 
(&quot;williams.BIB&quot;) by Patterson (1951) and
the balanced minimal designs of Afsarinejad (&quot;balmin.RMD&quot;). 
Some designs are only available for special combinations of treatment number and number of periods. Other designs
may require too many subjects. Therefore, the possible choices available for the submitted values of <code class="reqn">trt</code>,
<code class="reqn">k</code> and <code class="reqn">maxsub</code> 
are determined. 
If there is no design available, the parameters may be changed interactively.
If more than one design type is available the user has to choose one. The minimum number of subjects required 
for the designs is given and maybe a criterion for selecting a design. All types of designs are balanced for first-order carryover effects.
All types except the balanced minimal RMDs are also balanced block designs. 
The user may want to construct a design for a multiple of the minimum number of subjects required to get closer
to the preferred number of subjects. 
Once the design is chosen the design is displayed.  In practice the
labels for the treatments and subjects should be randomized before the
design is used.  
The treatments are numbered 1,...,<code class="reqn">trt</code>. The entry <code class="reqn">(i,j)</code> 
of the design corresponds to the treatment the <code class="reqn">i</code>-th subject gets in the <code class="reqn">j</code>-th period.
</p>


<h3>Value</h3>

<p>A matrix representing the experimental design.
</p>


<h3>Warning </h3>

 
<p>For the construction of designs that combine BIBDs with Williams designs, the function <code>find.BIB</code> is called
to search for a BIBD. If the necessary conditions for the existence of a BIBD are fulfilled, this approach
always returns a design. This design will however not always be a BIBD! 
When using the Patterson approach, please check the resulting design for balance using <code>isGYD</code> and 
<code>isCbalanced</code>.
</p>
<p>It should be noted that this is a computational problem only, not a problem of the theoretical
approach of Patterson (1951). 
</p>


<h3>Note</h3>

<p>  The &quot;All combinations&quot; approach requires the package <code>gtools</code>. </p>


<h3>Author(s)</h3>

<p>Oliver Sailer </p>


<h3>References</h3>

 
<p>Afsarinejad, K. (1983): Balanced repeated measurements designs. Biometrika 70, 199-204.  
</p>
<p>Jones, B. and Kenward, M.G. (1989): Design and Analysis of Cross-Over Trials. Chapman and Hall, London.
</p>
<p>Patterson, H.D. (1951): Change-over trials. Journal of the Royal Statistical Society B 13, 256-271.
</p>
<p>Patterson, H.D. (1952): The construction of balanced designs for experiments involving sequences of treatments. 
Biometrika 39, 32-48.
</p>
<p>Sailer, O. (2005): crossdes: A package for design and randomization in crossover studies. Rnews 5, 24-27.  
</p>
<p>Wakeling, I.N. and MacFie, H.J.H. (1995): Designing consumer trials balanced for first and higher orders of
carry-over effect when only a subset of k samples from t may be tested. Food Quality and Preference 6, 299-308. 
</p>
<p>Williams, E. J. (1949): Experimental designs balanced for the estimation of residual effects
of treatments. Australian Journal of Scientific Research, Ser. A 2, 149-168. 
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+allcombs">allcombs</a></code>, <code><a href="#topic+balmin.RMD">balmin.RMD</a></code>, <code><a href="#topic+des.MOLS">des.MOLS</a></code>, 
<code><a href="#topic+williams">williams</a></code>, <code><a href="#topic+williams.BIB">williams.BIB</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
get.plan(10,4,60)  
  # "williams.BIB" or "balmin.RMD"
get.plan(7,7,7000) 
  # "all.combin", "williams" or "des.MOLS", "williams" requires 
  # only 14 subjects, "all.combin" requires 5040.   
get.plan(5,5,5)    
  # Increase maxsub

## End(Not run)
</code></pre>

<hr>
<h2 id='isCbalanced'>Checking Block Designs for Carryover Balance</h2><span id='topic+isCbalanced'></span>

<h3>Description</h3>

<p>The function checks whether a block design is balanced for first order carryover effects (residual effects).
The user specifies whether there is a preperiod. The design is checked and the left neighbour incidence matrix is given.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>isCbalanced(d, preperiod = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="isCbalanced_+3A_d">d</code></td>
<td>
<p> A matrix with entries 1,...,<code class="reqn">trt</code> representing the experimental design with
rows as blocks (subjects). 
The columns represent periods.
</p>
</td></tr>
<tr><td><code id="isCbalanced_+3A_preperiod">preperiod</code></td>
<td>
<p> Logical flag. TRUE if there is a preperiod. In this case, each subject experiences in the first period 
the residual effect of the treatment of the last period (i.e. the last period preceeds the first period, i.e. the 
plots in the last period are left neighbours of the plots in the first period). 
FALSE if there are no residual effects in the first period.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The design is said to be carryover balanced (balanced for first order carryover effects), if each treatment is preceeded by all other treatments equally often
and if no treatment is preceeded by itself. 
If the design is balanced, this is stated.
</p>


<h3>Value</h3>

<table>
<tr><td><code>1</code></td>
<td>
<p>Logical flag. TRUE if the design is carryover balanced. This is not displayed on the screen.</p>
</td></tr>
<tr><td><code>2</code></td>
<td>
<p>Left neighbour incidence matrix. The <code class="reqn">(i,j)</code>-th element is the number of times that 
treatment <code class="reqn">i</code> preceeds treatment <code class="reqn">j</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Oliver Sailer  </p>


<h3>See Also</h3>

 <p><code><a href="#topic+isGYD">isGYD</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>d1 &lt;- matrix( c(1,2,3,4,1,1,1,1), 4,2)
d2 &lt;- matrix( c(1:4,2:4,1,4,1:3,3,4,1,2),ncol=4)
d3 &lt;- matrix( rep(1:3,each=2), ncol=2)
isCbalanced(d1)
isCbalanced(d1,TRUE)  
isCbalanced(d2)
isCbalanced(d3,TRUE)
</code></pre>

<hr>
<h2 id='isGYD'>Checking Simple Block and Row-Column Designs for Balance</h2><span id='topic+isGYD'></span>

<h3>Description</h3>

<p>A function to check a simple block or a row-column design for balance. The rows and columns of the design
are blocking variables. It is checked which type of balance the design fulfills. 
Optionally, incidence and concurrence matrices are given.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>isGYD(d, tables=FALSE, type=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="isGYD_+3A_d">d</code></td>
<td>
<p> A matrix representing the experimental design. The treatments must be numbered 1,...,<code class="reqn">trt</code>. </p>
</td></tr>
<tr><td><code id="isGYD_+3A_tables">tables</code></td>
<td>
<p> Logical flag. If TRUE, incidence matrices are displayed. </p>
</td></tr>
<tr><td><code id="isGYD_+3A_type">type</code></td>
<td>
<p> Logical flag. If TRUE, the type of design is displayed. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>A design is said to be a balanced block design if the following three conditions hold:
i)   Each treatment appears equally often in the design.
ii)  The design is binary in the sense that each treatment appears in each block either <code class="reqn">n</code> or <code class="reqn">n</code>+1 times
where <code class="reqn">n</code> is an integer. 
iii) The number of concurrences of treatments <code class="reqn">i</code> and <code class="reqn">j</code> is the same for all
pairs of distinct treatments <code class="reqn">(i,j)</code>.
Here the blocks are either rows or columns.
</p>
<p>A design that has less columns (rows) than treatments is said to be incomplete with respect to 
rows (columns). 
A design that is balanced with respect to both rows and columns is called a generalized Youden design (GYD).
A GYD for which each treatment occurs equally often in each row (column) is called uniform on the rows (columns).
If both conditions hold, it is called a generalized latin square. 
A design where each treatment occurs exactly once in each row and column is called a latin square. 
</p>


<h3>Value</h3>

<p>A list containing information about balance in rows and columns as well as incidence and concurrence matrices
for the design.</p>


<h3>Author(s)</h3>

<p>Oliver Sailer </p>


<h3>See Also</h3>

 <p><code><a href="#topic+isCbalanced">isCbalanced</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>d1 &lt;- matrix( c(1,2,3,4,1,1,1,1), 4,2)          
# d1 is not balanced
d2 &lt;- matrix( c(1:4,2:4,1,4,1:3,3,4,1,2),ncol=4)    
# d2 is a latin square
d3 &lt;- matrix( rep(1:3,each=2), ncol=2)          
# d3 is a balanced incomplete block design.
d1
isGYD(d1,tables=TRUE)  
d2
isGYD(d2,tables=TRUE)
d3
isGYD(d3,tables=TRUE)    
</code></pre>

<hr>
<h2 id='MOLS'>Construction of Complete Sets of Mutually Orthogonal Latin Squares</h2><span id='topic+MOLS'></span>

<h3>Description</h3>

<p>The function constructs sets of mutually othogonal latin squares (MOLS) using Galois fields.
The construction works for prime powers only. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MOLS(p, n, primpol = GF(p, n)[[2]][1, ])
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MOLS_+3A_p">p</code></td>
<td>
<p> A prime number less than 100. </p>
</td></tr>
<tr><td><code id="MOLS_+3A_n">n</code></td>
<td>
<p> A positive integer.</p>
</td></tr>
<tr><td><code id="MOLS_+3A_primpol">primpol</code></td>
<td>
<p> A primitive polynomial of the Galois Field GF(<code class="reqn">p^n</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code class="reqn">trt = p^n</code> is a prime power, then <code class="reqn">trt</code>-1 latin squares of order <code class="reqn">trt</code> 
are constructed.
The elements of the squares are numbered 1,...,<code class="reqn">trt</code>. 
These squares are mutually orthogonal, i.e. if any two of them are superimposed, the resulting
array will contain each ordered pair <code class="reqn">(i,j)</code>, <code class="reqn">i</code>,<code class="reqn">j</code> in {1,...,
<code class="reqn">trt</code>} exactly once.
The squares are in standard order, i.e. the first row is always equal to (1,...,<code class="reqn">trt</code>).
A primitive polynomial may be constructed automatically using the internal function <code>GF</code>.
</p>


<h3>Value</h3>

<p>For <code class="reqn">trt = p^n</code>, an array that contains <code class="reqn">trt</code>-1 latin squares is returned. 
</p>


<h3>Author(s)</h3>

<p> Oliver Sailer </p>


<h3>References</h3>

 
<p>Cherowitzo, W.: http://www-math.cudenver.edu/~wcherowi/courses/finflds.html
</p>
<p>Street, A.P. and Street, D.J. (1987): Combinatorics of experimental design. Oxford University Press, Oxford.
</p>


<h3>See Also</h3>

  <p><code><a href="#topic+des.MOLS">des.MOLS</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>MOLS(7,1) # 6 mutually orthogonal latin squares of order 7
MOLS(2,3) # 7 mutually orthogonal latin squares of order 8
</code></pre>

<hr>
<h2 id='williams'>Construction of Williams Designs </h2><span id='topic+williams'></span>

<h3>Description</h3>

<p>The function constructs williams designs. Williams designs are row-column designs. They are used if 
each of the treatments in the study is given to each of the subjects. If the number of 
treatments to be tested is even, the design is a latin square, otherwise it consists of two latin squares.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>williams(trt)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="williams_+3A_trt">trt</code></td>
<td>
<p> An integer &gt; 1, giving the number of treatments in the design. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The resulting design is a (generalized) latin square that is also balanced for first order carryover effects. 
Carryover balance is achieved with very few subjects.
In the experimental design the treatments are numbered 1,...,<code class="reqn">trt</code>. The entry 
<code class="reqn">(i,j)</code> of the design corresponds 
to the treatment the <code class="reqn">i</code>-th subject gets in the <code class="reqn">j</code>-th period.
</p>


<h3>Value</h3>

<p>A matrix representing the experimental design.
</p>


<h3>Author(s)</h3>

<p> Oliver Sailer </p>


<h3>References</h3>

 
<p>Wakeling, I.N. and MacFie, H.J.H. (1995): Designing consumer trials balanced for first and higher orders of
carry-over effect when only a subset of k samples from t may be tested. Food Quality and Preference 6, 299-308. 
</p>
<p>Williams, E. J. (1949): Experimental designs balanced for the estimation of residual effects
of treatments. Australian Journal of Scientific Research, Ser. A 2, 149-168. 
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+get.plan">get.plan</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>williams(3)
williams(10)
</code></pre>

<hr>
<h2 id='williams.BIB'>Construction of Carryover Balanced Designs Based on 
Balanced Incomplete Block Designs</h2><span id='topic+williams.BIB'></span>

<h3>Description</h3>

<p>Patterson (1951) combined balanced incomplete block designs (BIBDs) with Williams designs to get 
carryover balanced generalized Youden designs. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>williams.BIB(d)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="williams.BIB_+3A_d">d</code></td>
<td>
<p>A matrix representing a BIBD. Rows represent blocks (subjects).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For each row of the design, a Williams design is constructed using the treatments of that row.
The rows of the resulting designs are then combined. 
The treatments are numbered 1,...,<code class="reqn">trt</code>. The entry <code class="reqn">(i,j)</code> 
of the design corresponds to the treatment the <code class="reqn">i</code>-th subject gets in the <code class="reqn">j</code>-th period.
</p>


<h3>Value</h3>

<p>A matrix representing the experimental design.
</p>


<h3>Warning </h3>

<p> The resultig design is only balanced properly if the input design actually is a BIBD.
This is NOT checked automatically. You have to do this by yourself, e.g. by applying <code>isGYD</code> to your design.
</p>


<h3>Note</h3>

<p>  BIBDs may be generated using <code>find.BIB</code>. </p>


<h3>Author(s)</h3>

<p> Oliver Sailer </p>


<h3>References</h3>

 
<p>Patterson, H.D. (1951): Change-over trials. Journal of the Royal Statistical 
Society B 13, 256-271. 
</p>
<p>Wakeling, I.N. and MacFie, H.J.H. (1995): Designing consumer trials balanced for first and higher orders of
carry-over effect when only a subset of k samples from t may be tested. Food Quality and Preference 6, 299-308. 
</p>


<h3>See Also</h3>

  <p><code><a href="#topic+get.plan">get.plan</a></code>, <code><a href="#topic+isGYD">isGYD</a></code>, <code><a href="#topic+find.BIB">find.BIB</a></code>, <code><a href="#topic+williams">williams</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>d &lt;- matrix( rep(1:3,each=2), ncol=2)
# # check for balance
# isGYD(d)
williams.BIB(d)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
