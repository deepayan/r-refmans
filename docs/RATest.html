<!DOCTYPE html><html><head><title>Help for package RATest</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {RATest}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#CvM.stat'><p>Cramer - von Mises statistics</p></a></li>
<li><a href='#group.action'><p>General Construction of Permutation Tests: Group Actions</p></a></li>
<li><a href='#H.cdf'><p>Regression Discontinuity Design Permutation test</p></a></li>
<li><a href='#lee2008'><p>Data set used in Lee (2008)</p></a></li>
<li><a href='#plot.RDperm'><p>Plot RDperm</p></a></li>
<li><a href='#prepivot.ks.permtest'><p>Permutation Test for the two-sample goodness-of-fit problem under covariate-adaptive randomization</p></a></li>
<li><a href='#PT.Khmaladze.fit'><p>Permutation Test for Heterogeneous Treatment Effects with a Nuisance Parameter</p></a></li>
<li><a href='#PT.Khmaladze.MultTest'><p>Martingale transformed Permutation Test: Multiple Testing procedures.</p></a></li>
<li><a href='#PTQTE.Khmaladze.fit'><p>Quantile-Based Permutation Test with an Estimated Nuisance Parameter</p></a></li>
<li><a href='#randomization.test'><p>General Construction of Randomization Tests</p></a></li>
<li><a href='#RDperm'><p>Regression Discontinuity Design Permutation Test</p></a></li>
<li><a href='#RPT'><p>Robust Permutation Test</p></a></li>
<li><a href='#summary.prepivot.ks.permtest'><p>Summarizing Two-sample Goodness-of-fit Permutation Test under Covariate-adaptive Randomization</p></a></li>
<li><a href='#summary.PT.Khmaladze.fit'><p>Summarizing Permutation Test for Heterogeneous Treatment Effects with Estimated Nuisance Parameter</p></a></li>
<li><a href='#summary.PT.Khmaladze.MultTest'><p>Summarizing Permutation Test for Within-grpup Treatment Effect Heterogeneity in the presence of an Estimated Nuisance Parameter</p></a></li>
<li><a href='#summary.PTQTE.Khmaladze.fit'><p>Summarizing Quantile-Based Permutation Test with an Estimated Nuisance Parameter</p></a></li>
<li><a href='#summary.RDperm'><p>Summarizing Regression Discontinuity Design Permutation Test</p></a></li>
<li><a href='#summary.RPT'><p>Summarizing Robust Permutation Test</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Randomization Tests</td>
</tr>
<tr>
<td>Description:</td>
<td>A collection of randomization tests, data sets and examples. The current version focuses on five testing problems and their implementation in empirical work. First, it facilitates the empirical researcher to test for particular hypotheses, such as comparisons of means, medians, and variances from k populations using robust permutation tests, which asymptotic validity holds under very weak assumptions, while retaining the exact rejection probability in finite samples when the underlying distributions are identical. Second, the description and implementation of a permutation test for testing the continuity assumption of the baseline covariates in the sharp regression discontinuity design (RDD) as in Canay and Kamat (2018) <a href="https://goo.gl/UZFqt7">https://goo.gl/UZFqt7</a>. More specifically, it allows the user to select a set of covariates and test the aforementioned hypothesis using a permutation test based on the Cramer-von Misses test statistic. Graphical inspection of the empirical CDF and histograms for the variables of interest is also supported in the package. Third, it provides the practitioner with an effortless implementation of a permutation test based on the martingale decomposition of the empirical process for testing for heterogeneous treatment effects in the presence of an estimated nuisance parameter as in Chung and Olivares (2021) &lt;<a href="https://doi.org/10.1016%2Fj.jeconom.2020.09.015">doi:10.1016/j.jeconom.2020.09.015</a>&gt;. Fourth, this version considers the two-sample goodness-of-fit testing problem under covariate adaptive randomization and implements a permutation test based on a prepivoted Kolmogorov-Smirnov test statistic. Lastly, it implements an asymptotically valid permutation test based on the quantile process for the hypothesis of constant quantile treatment effects in the presence of an estimated nuisance parameter.</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.10</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/ignaciomsarmiento/RATest/issues">https://github.com/ignaciomsarmiento/RATest/issues</a></td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Mauricio Olivares &lt;mau.olivarego@gmail.com&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.00), ggplot2(&ge; 2.2.1), gridExtra</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, quantreg, compiler</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>Author:</td>
<td>Mauricio Olivares [aut, cre],
  Ignacio Sarmiento-Barbieri [aut]</td>
</tr>
<tr>
<td>Collate:</td>
<td>'CvM.stat.R' 'H.cdf.R' 'randomization.test.R' 'group.action.R'
'PT.Khmaladze.fit.R' 'PT.Khmaladze.MultTest.R'
'PTQTE.Khmaladze.fit.R' 'RDperm.R' 'RPT.R' 'lee2008.R'
'plot.RDperm.R' 'prepivot.ks.permtest.R'
'summary.PT.Khmaladze.MultTest.R' 'summary.PT.Khmaladze.fit.R'
'summary.PTQTE.Khmaladze.fit.R' 'summary.RDperm.R'
'summary.RPT.R' 'summary.prepivot.ks.permtest.R'</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-09-28 09:21:54 UTC; hoeffding</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-09-29 04:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='CvM.stat'>Cramer - von Mises statistics</h2><span id='topic+CvM.stat'></span>

<h3>Description</h3>

<p>Calculates the Cramer-von Mises test statistic </p>
<p style="text-align: center;"><code class="reqn">T(S_n)=\frac{1}{2q}\sum_{i=1}^{2q}\left(H^-_n(S_{n,i})-H^+_n(S_{n,i})\right)^2</code>
</p>
<p> where <code class="reqn">H^-_n(\cdot)</code> and <code class="reqn">H^+_n(\cdot)</code> are the empirical CDFs of the the sample of baseline covariates close to the cutoff from the left and right, respectively. See equation (12) in Canay and Kamat (2017).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CvM.stat(Sn)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CvM.stat_+3A_sn">Sn</code></td>
<td>
<p>Numeric. The pooled sample of induced order statistics. The first column of S can be viewed as an independent sample of W conditional on Z being close to zero from the left. Similarly, the second column of S can be viewed as an independent sample of W conditional on Z being close to the cutoff from the right. See section 3 in Canay and Kamat (2017).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the numeric value of the Cramer - von Mises test statistic.
</p>


<h3>Author(s)</h3>

<p>Maurcio Olivares
</p>
<p>Ignacio Sarmiento Barbieri
</p>


<h3>References</h3>

<p>Canay, I and Kamat V, (2018) Approximate Permutation Tests and Induced Order Statistics in the Regression Discontinuity Design. The Review of Economic Studies, 85(3): 1577-1608
</p>

<hr>
<h2 id='group.action'>General Construction of Permutation Tests: Group Actions</h2><span id='topic+group.action'></span>

<h3>Description</h3>

<p>Calculates the pre-specified actions on data. Consider data <code class="reqn">Z</code> taking values in a sample space <code class="reqn">\Omega</code>. Let <code class="reqn">\mathbf{G}</code> be a finite group of transformations from <code class="reqn">\Omega</code>  onto itself, with <code class="reqn">M=\vert \mathbf{G}\vert</code>. This function applies <code class="reqn">gZ</code> as <code class="reqn">g</code> varies in <code class="reqn">\bf{G}</code>. If <code class="reqn">Z</code> is a vector of size<code class="reqn">N</code> and the actions <code class="reqn">g</code> are permutations, <code class="reqn">M=N!</code>. If the actions <code class="reqn">g</code> are sign changes, then <code class="reqn">M=\{1,-1\}^{N}</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>group.action(Z, M, type = "permutations")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="group.action_+3A_z">Z</code></td>
<td>
<p>Numeric. A vector of size <code class="reqn">N</code> to which the group action will act on. In the two-sample testing problem, <code class="reqn">Z</code> is the pooled sample.</p>
</td></tr>
<tr><td><code id="group.action_+3A_m">M</code></td>
<td>
<p>Numeric. Number of actions to be performed. This is the number of transformations used in the stochastic approximation to the test. This is due to the fact that in some cases <code class="reqn">M=\vert \mathbf{G}\vert</code> is too large, which makes the application of the actions computationally expensive.</p>
</td></tr>
<tr><td><code id="group.action_+3A_type">type</code></td>
<td>
<p>Character. The action to be performed. It represents <code class="reqn">gx</code>, the action the action  of <code class="reqn">g\in\mathbf{G}</code> on <code class="reqn">x\in\Omega</code>. It can be either permutations or sign changes.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric. A matrix of size <code class="reqn">N\times M</code> where <code class="reqn">N</code> is the size of input <code class="reqn">Z</code> and <code class="reqn">M</code> is the number of actions to be performed on <code class="reqn">Z</code>.
</p>


<h3>Author(s)</h3>

<p>Maurcio Olivares
</p>
<p>Ignacio Sarmiento Barbieri
</p>


<h3>References</h3>

<p>Lehmann, Erich L. and Romano, Joseph P (2005) Testing statistical hypotheses.Springer Science &amp; Business Media.
</p>

<hr>
<h2 id='H.cdf'>Regression Discontinuity Design Permutation test</h2><span id='topic+H.cdf'></span>

<h3>Description</h3>

<p>Calculates the empirical CDF of the sample of <code class="reqn">W</code> conditional on <code class="reqn">Z</code> being close to the cutoff from either the left or right. Given the induced order for the baseline covariates </p>
<p style="text-align: center;"><code class="reqn">W^{-}_{[q]}, W^{-}_{[q-1]},\dots\le W^{-}_{[1]}</code>
</p>
<p> or </p>
<p style="text-align: center;"><code class="reqn">W^{+}_{[1]}, W^{+}_{[2]},\dots, W^{+}_{[q]}</code>
</p>
<p>, this function will calculate either </p>
<p style="text-align: center;"><code class="reqn">H^-_n(t)=\frac{1}{q}\sum_{i=1}^q I\{W^{-}_{[i]}\le t\}</code>
</p>
<p>  or  </p>
<p style="text-align: center;"><code class="reqn">H^+_n(t)=\frac{1}{q}\sum_{i=1}^q I\{W^{+}_{[i]}\le t\}</code>
</p>
<p> depending on the argument of the function. See section 3 in Canay &amp; Kamat (2017).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>H.cdf(W, t)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="H.cdf_+3A_w">W</code></td>
<td>
<p>Numeric. The sample of induced order statistics. The input can be either <code class="reqn">\{W^{-}_{[q]}, W^{-}_{[q-1]},\dots, W^{-}_{[1]}\}</code> or <code class="reqn">\{W^{+}_{[1]}, W^{+}_{[2]},\dots, W^{+}_{[q]}\}</code>.</p>
</td></tr>
<tr><td><code id="H.cdf_+3A_t">t</code></td>
<td>
<p>Numeric. The scalar needed for the calculation of the CDF.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric. For a sample <code class="reqn">W=(w_1,\dots,w_n)</code>, returns the fraction of observations less or equal to <code class="reqn">t</code>.
</p>


<h3>Author(s)</h3>

<p>Maurcio Olivares
</p>
<p>Ignacio Sarmiento Barbieri
</p>


<h3>References</h3>

<p>Canay, I and Kamat V, (2018) Approximate Permutation Tests and Induced Order Statistics in the Regression Discontinuity Design. The Review of Economic Studies, 85(3): 1577-1608
</p>

<hr>
<h2 id='lee2008'>Data set used in Lee (2008)</h2><span id='topic+lee2008'></span>

<h3>Description</h3>

<p>Randomized experiments from non-random selection in U.S. House elections
</p>


<h3>Format</h3>

<p>A data frame with 6558 observations and two variables:
</p>

<dl>
<dt>demsharenext</dt><dd><p>Democrat vote share election t+1</p>
</dd>
<dt>difdemshare</dt><dd><p>Running variable. Diff. democratic share</p>
</dd>
<dt>demshareprev</dt><dd><p>Democrat vote share t-1</p>
</dd>
<dt>demwinprev</dt><dd><p>Democrat win t-1</p>
</dd>
<dt>demofficeexp</dt><dd><p>Democrat political experience t</p>
</dd>
<dt>othofficeexp</dt><dd><p>Oppositions political experience t</p>
</dd>
<dt>demelectexp</dt><dd><p>Democrat electoral experience t</p>
</dd>
<dt>othelectexp</dt><dd><p>Oposition electoral experience t</p>
</dd>
</dl>



<h3>Source</h3>

<p>Mostly Harmless Econometrics Data Archive: <a href="https://economics.mit.edu/people/faculty/josh-angrist/mhe-data-archive">https://economics.mit.edu/people/faculty/josh-angrist/mhe-data-archive</a>
</p>


<h3>References</h3>

<p>Lee, D. (2008) Randomized experiments from non-random selection in U.S. House elections, <em>Journal of Econometrics</em>, 142, 675-697
</p>

<hr>
<h2 id='plot.RDperm'>Plot RDperm</h2><span id='topic+plot.RDperm'></span>

<h3>Description</h3>

<p>Plots a histogram and empirical cdf
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'RDperm'
plot(x, w, plot.class = "both", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.RDperm_+3A_x">x</code></td>
<td>
<p>Object of class &quot;RDperm&quot;</p>
</td></tr>
<tr><td><code id="plot.RDperm_+3A_w">w</code></td>
<td>
<p>Character. Name of variable to be plotted</p>
</td></tr>
<tr><td><code id="plot.RDperm_+3A_plot.class">plot.class</code></td>
<td>
<p>Character. Can be: &quot;both&quot; for a histogram and cdf plot, &quot;hist&quot; for a histogram or &quot;cdf&quot; for only the cdf plot</p>
</td></tr>
<tr><td><code id="plot.RDperm_+3A_...">...</code></td>
<td>
<p>Additional ggplot2 controls</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Maurcio Olivares
</p>
<p>Ignacio Sarmiento Barbieri
</p>


<h3>References</h3>

<p>Canay, I and Kamat V, (2018) Approximate Permutation Tests and Induced Order Statistics in the Regression Discontinuity Design. The Review of Economic Studies, 85(3): 1577-1608
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
permtest&lt;-RDperm(W=c("demshareprev","demwinprev"),z="difdemshare",data=lee2008)
plot(permtest,w="demshareprev")

## End(Not run)
</code></pre>

<hr>
<h2 id='prepivot.ks.permtest'>Permutation Test for the two-sample goodness-of-fit problem under covariate-adaptive randomization</h2><span id='topic+prepivot.ks.permtest'></span>

<h3>Description</h3>

<p>A permutation test of the two-sample goodness-of-fit hypothesis when the randomization scheme is covariate-adaptive. The permutation test considered here is based on prepivoting the Kolmogorov-Smirnov test statistic following Beran (1987,1988), and adapted by Olivares (2020). Current version includes the following randomization schemes: simple randomization, Efron's biased-coin design, Wei's biased-coin design, and stratified block randomization. This implementation uses a Bayesian bootstrap approximation for prepivoting.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prepivot.ks.permtest(Y1, Y0, alpha, B, n.perm)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prepivot.ks.permtest_+3A_y1">Y1</code></td>
<td>
<p>Numeric. A vector containing the response variable of the treatment group.</p>
</td></tr>
<tr><td><code id="prepivot.ks.permtest_+3A_y0">Y0</code></td>
<td>
<p>Numeric. A vector containing the response variable of the control group.</p>
</td></tr>
<tr><td><code id="prepivot.ks.permtest_+3A_alpha">alpha</code></td>
<td>
<p>Numeric. Nominal level for the test. The default is 0.05.</p>
</td></tr>
<tr><td><code id="prepivot.ks.permtest_+3A_b">B</code></td>
<td>
<p>Numeric. Number of weighted bootstrap samples.</p>
</td></tr>
<tr><td><code id="prepivot.ks.permtest_+3A_n.perm">n.perm</code></td>
<td>
<p>Numeric. Number of permutations needed for the stochastic approximation of the p-values. The default is n.perm=999.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class &quot;prepivot.ks.permtest&quot; containing at least the following components:
</p>
<table>
<tr><td><code>n_populations</code></td>
<td>
<p>Number of grups.</p>
</td></tr>
<tr><td><code>N</code></td>
<td>
<p>Sample Size.</p>
</td></tr>
<tr><td><code>T.obs</code></td>
<td>
<p>Observed test statistic.</p>
</td></tr>
<tr><td><code>cv</code></td>
<td>
<p>Critical Value. This value is used in the general construction of a randomization test.</p>
</td></tr>
<tr><td><code>pvalue</code></td>
<td>
<p>P-value.</p>
</td></tr>
<tr><td><code>rejectrule</code></td>
<td>
<p>Rule. Binary decision for randomization test, where 1 means &quot;to reject&quot;</p>
</td></tr>
<tr><td><code>T.perm</code></td>
<td>
<p>Vector. Test statistic recalculated for all permutations used in the stochastic approximation.</p>
</td></tr>
<tr><td><code>n.perm</code></td>
<td>
<p>Number of permutations.</p>
</td></tr>
<tr><td><code>B</code></td>
<td>
<p>Bayesian bootstrap samples.</p>
</td></tr>
<tr><td><code>sample_sizes</code></td>
<td>
<p>Groups size.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Maurcio Olivares
</p>


<h3>References</h3>

<p>Beran, R. (1987). Prepivoting to reduce level error of confidence sets. Biometrika, 74(3): 457–468.
Beran, R. (1988). Prepivoting test statistics: a bootstrap view of asymptotic refinements. Journal of the American Statistical Association, 83(403):687–697.
Olivares, M. (2020). Asymptotically Robust Permutation Test under Covariate-Adaptive Randomization. Working Paper.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
Y0 &lt;- rnorm(100, 1, 1)
Y1 &lt;- rbeta(100,2,2)
Tx = sample(100) &lt;= 0.5*(100)
# Observed Outcome 
Y = ifelse( Tx, Y1, Y0 )
dta &lt;- data.frame(Y = Y, A = as.numeric(Tx))
pKS.GoF&lt;-prepivot.ks.permtest(dta$Y[dta$A==1],dta$Y[dta$A==0],alpha=0.05,B=1000,n.perm = 999)
summary(pKS.GoF)

## End(Not run)
</code></pre>

<hr>
<h2 id='PT.Khmaladze.fit'>Permutation Test for Heterogeneous Treatment Effects with a Nuisance Parameter</h2><span id='topic+PT.Khmaladze.fit'></span>

<h3>Description</h3>

<p>A permutation test of the two-sample goodness-of-fit hypothesis in the presence of an estimated niusance parameter. The permutation test considered here is based on the Khmaladze transformation of the empirical process (Khmaladze (1981)), and adapted by Chung and Olivares (2020).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PT.Khmaladze.fit(y1, y0, alpha = 0.05, n.perm = 999)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PT.Khmaladze.fit_+3A_y1">y1</code></td>
<td>
<p>Numeric. A vector containing the response variable of the treatment group.</p>
</td></tr>
<tr><td><code id="PT.Khmaladze.fit_+3A_y0">y0</code></td>
<td>
<p>Numeric. A vector containing the response variable of the control group.</p>
</td></tr>
<tr><td><code id="PT.Khmaladze.fit_+3A_alpha">alpha</code></td>
<td>
<p>Numeric. Nominal level for the test. The default is 0.05.</p>
</td></tr>
<tr><td><code id="PT.Khmaladze.fit_+3A_n.perm">n.perm</code></td>
<td>
<p>Numeric. Number of permutations needed for the stochastic approximation of the p-values. The default is n.perm=999.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class &quot;PT.Khmaladze.fit&quot; containing at least the following components:
</p>
<table>
<tr><td><code>n_populations</code></td>
<td>
<p>Number of grups.</p>
</td></tr>
<tr><td><code>N</code></td>
<td>
<p>Sample Size.</p>
</td></tr>
<tr><td><code>T.obs</code></td>
<td>
<p>Observed test statistic.</p>
</td></tr>
<tr><td><code>shift</code></td>
<td>
<p>The estimated nuisance parameter (average treatment effect).</p>
</td></tr>
<tr><td><code>cv</code></td>
<td>
<p>Critical Value. This value is used in the general construction of a randomization test.</p>
</td></tr>
<tr><td><code>pvalue</code></td>
<td>
<p>P-value.</p>
</td></tr>
<tr><td><code>T.perm</code></td>
<td>
<p>Vector. Test statistic recalculated for all permutations used in the stochastic approximation.</p>
</td></tr>
<tr><td><code>n_perm</code></td>
<td>
<p>Number of permutations.</p>
</td></tr>
<tr><td><code>sample_sizes</code></td>
<td>
<p>Groups size.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Maurcio Olivares
</p>


<h3>References</h3>

<p>Khmaladze, E. (1981). Martingale Approach in the Theory of Goodness-of-fit Tests. Theory of Probability and its Application, 26: 240–257.
Chung, E. and Olivares, M. (2021). Permutation Test for Heterogeneous Treatment Effects with a Nuisance Parameter. Forthcoming in Journal of Econometrics.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
Y0 &lt;- rnorm(100, 1, 1)
# Treatment Group with constant shift equals to 1
Y1 &lt;- Y0 + 1
Tx = sample(100) &lt;= 0.5*(100)
# Observed Outcome 
Y = ifelse( Tx, Y1, Y0 )
dta &lt;- data.frame(Y = Y, Z = as.numeric(Tx))
pt.GoF&lt;-PT.Khmaladze.fit(dta$Y[dta$Z==1],dta$Y[dta$Z==0],n.perm = 49)
summary(pt.GoF)

## End(Not run)
</code></pre>

<hr>
<h2 id='PT.Khmaladze.MultTest'>Martingale transformed Permutation Test: Multiple Testing procedures.</h2><span id='topic+PT.Khmaladze.MultTest'></span>

<h3>Description</h3>

<p>This function applies the martingale transformed Permutation test (Chung and Olivares (2020)) to test whether there exists within-group treatment effect heterogeneity. 
The method jointly tests the null hypotheses that treatment effects are constant within mutually exclusive subgroups while allowing them to be different across subgroups. More formally, 
assume the mutually exclusive subgroups are formed from observed covariates, and are taken as given. Denote <code class="reqn">\mathcal{J}</code> the total number of such subgroups. 
Let <code class="reqn">F_0^{j}(y)</code> and <code class="reqn">F_1^{j}(y)</code> be the CDFs of the control and treatment group for subgroup <code class="reqn">1\le j\le \mathcal{J}</code>. The null hypothesis of interest is given by the joint hypothesis
</p>
<p style="text-align: center;"><code class="reqn">\mathbf{H}_{0}: F_1^{j}(y + \delta_{j}) = F_0^{j}(y)</code>
</p>

<p>for all mutually exclusive <code class="reqn">j\in\{1,\dots,\mathcal{J}\}</code>, for some <code class="reqn">\delta_j</code>. We are treating <code class="reqn">\mathbf{H}_0</code> as a multiple testing problem in which every individual hypothesis <code class="reqn">j\in\{1,\dots,\mathcal{J}\}</code>, given by
</p>
<p style="text-align: center;"><code class="reqn">H_{0,j}: F_1^{j}(y + \delta_{j}) = F_0^{j}(y)</code>
</p>

<p>for some <code class="reqn">\delta_j</code> specifies whether the treatment effect is heterogeneous for a particular subgroup.
</p>
<p>To achieve control of the family-wise error rate, the function considers several multiple testing procedures, such as Bonferroni, maxT and minP (Westfall and Young (1993)), and Holm (1979).
For further details, see Chung and Olivares (2020).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PT.Khmaladze.MultTest(
  data,
  procedure = "maxT",
  alpha = 0.05,
  n.perm = 499,
  B = 499,
  na.action
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PT.Khmaladze.MultTest_+3A_data">data</code></td>
<td>
<p>List. Data are presented in the form of a list, where each sublist contains the treatment and control group observations for a specific subgroup.</p>
</td></tr>
<tr><td><code id="PT.Khmaladze.MultTest_+3A_procedure">procedure</code></td>
<td>
<p>multiple testing procedure. Several options are available, including maxT and minP (Westfall and Young (1993)), Bonferroni adjustment, and Holm (1979) procedure. The default is Bonferroni.</p>
</td></tr>
<tr><td><code id="PT.Khmaladze.MultTest_+3A_alpha">alpha</code></td>
<td>
<p>Significance level.</p>
</td></tr>
<tr><td><code id="PT.Khmaladze.MultTest_+3A_n.perm">n.perm</code></td>
<td>
<p>Numeric. Number of permutations needed for the stochastic approximation of the p-values. See Remark 4 in Chung and Olivares (2020). The default is n.perm=499.</p>
</td></tr>
<tr><td><code id="PT.Khmaladze.MultTest_+3A_b">B</code></td>
<td>
<p>Numeric. Number of permutations needed for the stochastic approximation in the Westfall-Young procedures. See Remark 11 in Chung and Olivares (2020). The default is B=499.</p>
</td></tr>
<tr><td><code id="PT.Khmaladze.MultTest_+3A_na.action">na.action</code></td>
<td>
<p>a function to filter missing data. This is applied to the model.frame . The default is na.omit, which deletes observations that contain one or more missing values.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class &quot;PT.Khmaladze.MultTest&quot; is a list containing at least the following components:
</p>
<table>
<tr><td><code>description</code></td>
<td>
<p>Type of multiple testing adjustment. It can be Westfall-Young's maxT, minP, Holm or Bonferroni.</p>
</td></tr>
<tr><td><code>n.subgroups</code></td>
<td>
<p>Number of subgrups for a specific covariate.</p>
</td></tr>
<tr><td><code>T.obs</code></td>
<td>
<p>Vector. Observed test statistic for each subgroup.</p>
</td></tr>
<tr><td><code>pvalues</code></td>
<td>
<p>Vector. P-value for each individual test.</p>
</td></tr>
<tr><td><code>adj.pvalue</code></td>
<td>
<p>Vector. Adjusted p-values according to the user-chosen multiple testing procedure.</p>
</td></tr>
<tr><td><code>n.perm</code></td>
<td>
<p>Number of permutations.</p>
</td></tr>
<tr><td><code>B</code></td>
<td>
<p>Number of permutations used in the Westfall-Young procedure.</p>
</td></tr>
<tr><td><code>sample.sizes</code></td>
<td>
<p>Subgroup sample sizes.</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>Significance level.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Maurcio Olivares
</p>


<h3>References</h3>

<p>Chung, E. and Olivares, M. (2021). Permutation Test for Heterogeneous Treatment Effects with a Nuisance Parameter. Forthcoming in Journal of Econometrics.
Holm, S. (1979). A simple sequentially rejective multiple test procedure. Scandinavian Journal of Statistics, pages 65-70.
Westfall, P.H. and Young, S.S. (1993). Resampling-based multiple testing: Examples and methods for p-value adjustment, Volume 279, John &amp; Wiley Sons.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
subgroup1 &lt;- list()
subgroup1$Y0 &lt;- rnorm(11)
subgrpup1$Y1 &lt;- rnorm(8,1,1) 
subgroup2 &lt;- list()
subgroup2$Y0 &lt;- rnorm(9)
subgroup2$Y1 &lt;- rnorm(7,1,2)
data &lt;- list(subgroup1,subgroup2)
res.minP &lt;- PT.Khmaladze.MultTest(data,"minP",n.perm=100,B=100)
summary(res.minP)
adjusted.p.values &lt;- res.minP$adj.pvalues
adjusted.p.values

## End(Not run)
</code></pre>

<hr>
<h2 id='PTQTE.Khmaladze.fit'>Quantile-Based Permutation Test with an Estimated Nuisance Parameter</h2><span id='topic+PTQTE.Khmaladze.fit'></span>

<h3>Description</h3>

<p>A permutation test for testing whether the quantile treatment effects are constant across quantiles. The permutation test considered here is based on the Khmaladze transformation of the quantile process (Koenler and Xiao (2002)), and adapted by Chung and Olivares (2021).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PTQTE.Khmaladze.fit(
  Y,
  Z,
  taus = seq(0.1, 0.9, by = 0.05),
  alpha = 0.05,
  n.perm = 999
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PTQTE.Khmaladze.fit_+3A_y">Y</code></td>
<td>
<p>Numeric. Vector of responses.</p>
</td></tr>
<tr><td><code id="PTQTE.Khmaladze.fit_+3A_z">Z</code></td>
<td>
<p>Numeric. Treatment indicator. Z=1 if the unit is in the treatment group, and Z=0 if the unit is in the control group.</p>
</td></tr>
<tr><td><code id="PTQTE.Khmaladze.fit_+3A_taus">taus</code></td>
<td>
<p>quantiles at which the process is to be evaluated, if any of the taus lie outside (0,1) then the full process is computed for all distinct solutions.</p>
</td></tr>
<tr><td><code id="PTQTE.Khmaladze.fit_+3A_alpha">alpha</code></td>
<td>
<p>Significance level.</p>
</td></tr>
<tr><td><code id="PTQTE.Khmaladze.fit_+3A_n.perm">n.perm</code></td>
<td>
<p>Numeric. Number of permutations needed for the stochastic approximation of the p-values. The default is n.perm=999.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class &quot;PTQTE.Khmaladze&quot; containing at least the following components:
</p>
<table>
<tr><td><code>n_populations</code></td>
<td>
<p>Number of grups.</p>
</td></tr>
<tr><td><code>N</code></td>
<td>
<p>Sample Size.</p>
</td></tr>
<tr><td><code>KS.obs</code></td>
<td>
<p>Observed two-sample Kolmogorov-Smirnov test statistic based on the quantile process.</p>
</td></tr>
<tr><td><code>shift</code></td>
<td>
<p>The estimated nuisance parameter.</p>
</td></tr>
<tr><td><code>rej.rule</code></td>
<td>
<p>Binary decision for the permutation test, where 1 means rejection.</p>
</td></tr>
<tr><td><code>pvalue</code></td>
<td>
<p>P-value.</p>
</td></tr>
<tr><td><code>KS.perm</code></td>
<td>
<p>Vector. Test statistic recalculated for all permutations used in the stochastic approximation.</p>
</td></tr>
<tr><td><code>n_perm</code></td>
<td>
<p>Number of permutations.</p>
</td></tr>
<tr><td><code>sample_sizes</code></td>
<td>
<p>Groups size.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Maurcio Olivares
</p>


<h3>References</h3>

<p>Khmaladze, E. (1981). Martingale Approach in the Theory of Goodness-of-fit Tests. Theory of Probability and its Application, 26: 240–257.
Koenker, R. and Xiao, Z. (2002) Inference on the Quantile Regression Process. Econometrica, 70(4): 1583-1612.
Chung, E. and Olivares, M. (2021). Comment on &quot;Can Variation in Subgroups' Average Treatment Effects Explain Treatment Effect Heterogeneity? Evidence from a Social Experiment.&quot;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
dta &lt;- data.frame(Y=rnorm(100),Z=sample(c(0,1), 100, replace = TRUE))
pt.QTE&lt;-PTQTE.Khmaladze.fit(dta$Y,dta$Z,taus=seq(.1,.9,by=0.05),alpha=0.05,n.perm = 499)
summary(pt.QTE)

## End(Not run)
</code></pre>

<hr>
<h2 id='randomization.test'>General Construction of Randomization Tests</h2><span id='topic+randomization.test'></span>

<h3>Description</h3>

<p>Calculates the randomization test. Further discussion can be found in chapter 15 of Lehmann and Romano (2005, p 633). Consider data <code class="reqn">X</code> taking values in a sample space <code class="reqn">\Omega</code>. 
Let <code class="reqn">\mathbf{G}</code> be a finite group of transformations from <code class="reqn">\Omega</code>  onto itself, with <code class="reqn">M=\vert \mathbf{G}\vert</code>. Let <code class="reqn">T(X)</code> be a real-valued test statistic such that large values provide 
evidence against the null hypothesis. Denote by </p>
<p style="text-align: center;"><code class="reqn">T^{(1)}(X)\le T^{(2)}(X)\le\dots\le T^{(M)}(X)</code>
</p>
<p> the ordered values of <code class="reqn">\{T(gX)\,:\,g\in\mathbf{G}\}</code>. Let <code class="reqn">k=M-\lfloor M\alpha\rfloor</code> and 
define <code class="reqn">M^{+}(x)</code> and <code class="reqn">M^{0}(x)</code> be the number of values <code class="reqn">T^{(j)}(X)</code>, <code class="reqn">j=1,\dots,M</code>, which are greater than <code class="reqn">T^{(k)}(X)</code> and equal to <code class="reqn">T^{(k)}(X)</code> respectively. Set </p>
<p style="text-align: center;"><code class="reqn">a(X)=\frac{\alpha M-M^{+}(X)}{M^{0}(X)}~.</code>
</p>
 
<p>The randomization test is given by </p>
<p style="text-align: center;"><code class="reqn">\phi(X)=1\{T(x)&gt; T^{(k)}(X)\}+a(X)\times 1\{T(X)= T^{(k)}(X)\}~.</code>
</p>



<h3>Usage</h3>

<pre><code class='language-R'>randomization.test(Tn, Tng, alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="randomization.test_+3A_tn">Tn</code></td>
<td>
<p>Numeric. A scalar representing the observed test statistic <code class="reqn">T(X)</code>.</p>
</td></tr>
<tr><td><code id="randomization.test_+3A_tng">Tng</code></td>
<td>
<p>Numeric. A vector containing <code class="reqn">\{T(gX)\,:\,g\in\mathbf{G}\}</code>.</p>
</td></tr>
<tr><td><code id="randomization.test_+3A_alpha">alpha</code></td>
<td>
<p>Numeric. Nominal level for the test. The default is 0.05.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric. A vector containing <code class="reqn">\phi(X)\in\{0,1\}</code> and <code class="reqn">T^{(k)}(X)</code>. The test rejects the null hypothesis if <code class="reqn">\phi(X)=1</code>, and does not reject otherwise.
</p>


<h3>Author(s)</h3>

<p>Maurcio Olivares
</p>
<p>Ignacio Sarmiento Barbieri
</p>


<h3>References</h3>

<p>Lehmann, Erich L. and Romano, Joseph P (2005) Testing statistical hypotheses.Springer Science &amp; Business Media.
</p>

<hr>
<h2 id='RDperm'>Regression Discontinuity Design Permutation Test</h2><span id='topic+RDperm'></span>

<h3>Description</h3>

<p>A permutation test for continuity of covariates in Sharp Regression Discontinuity Design as described in Canay and Kamat (2018).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RDperm(
  W,
  z,
  data,
  n.perm = 499,
  q_type = 10,
  cutoff = 0,
  test.statistic = "CvM"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RDperm_+3A_w">W</code></td>
<td>
<p>Character. Vector of covariates names. The procedure will test the null hypothesis of continuity of the distribution of each element in W at the cutoff.</p>
</td></tr>
<tr><td><code id="RDperm_+3A_z">z</code></td>
<td>
<p>Character. Running variable name. This is the scalar random variable that defines, along with the cutoff, the treatment assignment rule in the sharp regression discontinuity design.</p>
</td></tr>
<tr><td><code id="RDperm_+3A_data">data</code></td>
<td>
<p>Data.frame.</p>
</td></tr>
<tr><td><code id="RDperm_+3A_n.perm">n.perm</code></td>
<td>
<p>Numeric. Number of permutations needed for the stochastic approximation of the p-values. See remark 3.2 in Canay and Kamat (2018). The default is B=499.</p>
</td></tr>
<tr><td><code id="RDperm_+3A_q_type">q_type</code></td>
<td>
<p>A fixed and small (relative to the sample size) natural number that will define the <code class="reqn">q</code> closest values of the order statistic of <code class="reqn">Z</code> to the right and to the left of the cutoff. The default, 'rot', value is given by the feasible rule of thumb in footnote 4 of Canay and Kamat (2018), section 3.1. If 'arot', it calls for the Rule of Thumb described in equation (15) of Canay and Kamat (2018), section 3.1. The default option grows at a slower rate than the optional rule of thumb, but adds a larger constant.</p>
</td></tr>
<tr><td><code id="RDperm_+3A_cutoff">cutoff</code></td>
<td>
<p>Numeric. The scalar defining the threshold of the running variable.</p>
</td></tr>
<tr><td><code id="RDperm_+3A_test.statistic">test.statistic</code></td>
<td>
<p>Character. A rank test statistic satisfying rank invariance. The default is a Cramer-von Mises test statistic.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The functions <code>summary</code> and <code>plot</code> are used to obtain and print a summary and plot of
the estimated regression discontinuity. The object of class <code>RDperm</code> is a list
containing the following components:
</p>
<table>
<tr><td><code>results</code></td>
<td>
<p>Matrix. Test Statistic, P-values and Q</p>
</td></tr>
<tr><td><code>test.statistic</code></td>
<td>
<p>Test Statistic</p>
</td></tr>
<tr><td><code>q_type</code></td>
<td>
<p>Type of Q used in the calculations, can be either,  &quot;Defined by User&quot;, the &quot;Rule of Thumb&quot;  or the &quot;Alternative Rule of Thumb&quot;.</p>
</td></tr>
<tr><td><code>n_perm</code></td>
<td>
<p>number of permutations</p>
</td></tr>
<tr><td><code>rv</code></td>
<td>
<p>Character. Running variable name</p>
</td></tr>
<tr><td><code>Z</code></td>
<td>
<p>Vector. Running Variable</p>
</td></tr>
<tr><td><code>cutoff</code></td>
<td>
<p>cutoff</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>data set</p>
</td></tr>
<tr><td><code>S</code></td>
<td>
<p>Matrix. Pooled sample of induced order statistics</p>
</td></tr>
<tr><td><code>S_perm</code></td>
<td>
<p>List. Permutations of the induced order statistic.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Maurcio Olivares
</p>
<p>Ignacio Sarmiento Barbieri
</p>


<h3>References</h3>

<p>Canay, I and Kamat V, (2018) Approximate Permutation Tests and Induced Order Statistics in the Regression Discontinuity Design. The Review of Economic Studies, 85(3): 1577-1608
</p>


<h3>Examples</h3>

<pre><code class='language-R'>permtest&lt;-RDperm(W=c("demshareprev"),z="difdemshare",data=lee2008)
summary(permtest)
## Not run: 
permtest&lt;-RDperm(W=c("demshareprev","demwinprev"),z="difdemshare",data=lee2008)
summary(permtest)

## End(Not run)
</code></pre>

<hr>
<h2 id='RPT'>Robust Permutation Test</h2><span id='topic+RPT'></span>

<h3>Description</h3>

<p>This function considers the k-sample problem of comparing general parameters, such as means, medians, or parameters that depend on the joint distribution using permutation tests. Under weak assumptions for comparing estimator, the permutation tests implemented here provide a general test procedure whereby the asymptotic validity of the permutation test holds while retaining the exact rejection probability <code class="reqn">\alpha</code> in finite samples when the underlying distributions are identical.
Here we will consider three test for the 2 sample case, but the function works for k-samples. 
</p>
<p>Difference of means: Here, the null hypothesis is of the form <code class="reqn">H_0: \mu(P)-\mu(Q)=0</code>, and the corresponding test statistic is given by 
</p>
<p style="text-align: center;"><code class="reqn">T_{m,n}=\frac{N^{1/2}(\bar{X}_m-\bar{Y}_n)}{\sqrt{\frac{N}{m}\sigma^2_m(X_1,\dots,X_m)+ \frac{N}{n}\sigma^2_n(Y_1,\dots,Y_n)}}</code>
</p>
  
<p>where <code class="reqn">\bar{X}_m</code> and <code class="reqn">\bar{Y}_n</code> are the sample means from population <code class="reqn">P</code> and population <code class="reqn">Q</code>, respectively, and <code class="reqn">\sigma^2_m(X_1,\dots,X_m)</code> is a consistent estimator of <code class="reqn">\sigma^2(P)</code> when <code class="reqn">X_1,\dots,X_m</code> are i.i.d. from <code class="reqn">P</code>. Assume consistency also under <code class="reqn">Q</code>.
</p>
<p>Difference of medians: Let <code class="reqn">F</code> and <code class="reqn">G</code> be the CDFs corresponding to <code class="reqn">P</code> and <code class="reqn">Q</code>, and denote <code class="reqn">\theta(F)</code> the median of <code class="reqn">F</code> i.e. <code class="reqn">\theta(F)=\inf\{x:F(x)\ge1/2\}</code>. Assume that <code class="reqn">F</code> is continuously differentiable at <code class="reqn">\theta(P)</code> with derivative <code class="reqn">F'</code> (and the same with <code class="reqn">F</code> replaced by <code class="reqn">G</code>). Here, the null hypothesis is of the form  <code class="reqn">H_0: \theta(P)-\theta(Q)=0</code>, and the corresponding test statistic is given by
</p>
<p style="text-align: center;"><code class="reqn">T_{m,n}=\frac{N^{1/2}\left(\theta(\hat{P}_m)-\theta(\hat{Q})\right)}{\hat{\upsilon}_{m,n}}</code>
</p>

<p>where <code class="reqn">\hat{\upsilon}_{m,n}</code> is a consistent estimator of <code class="reqn">\upsilon(P,Q)</code>:
</p>
<p style="text-align: center;"><code class="reqn">\upsilon(P,Q)=\frac{1}{\lambda}\frac{1}{4(F'(\theta))^2}+\frac{1}{1-\lambda}\frac{1}{4(G'(\theta))^2}</code>
</p>

<p>Choices of <code class="reqn">\hat{\upsilon}_{m,n}</code> may include the kernel estimator of Devroye and Wagner (1980), the bootstrap estimator of Efron (1992), or the smoothed bootstrap  Hall et al. (1989) to list a few. For further details, see Chung and Romano (2013). Current implementation uses the bootstrap estimator of Efron (1992)
</p>
<p>Difference of variances: Here, the null hypothesis is of the form <code class="reqn">H_0: \sigma^2(P)-\sigma^2(Q)=0</code>, and the corresponding test statistic is given by 
</p>
<p style="text-align: center;"><code class="reqn">T_{m,n}=\frac{N^{1/2}(\hat{\sigma}_m^2(X_1,\dots,X_,)-\hat{\sigma}_n^2(Y_1,\dots,Y_n))}{\sqrt{\frac{N}{m}(\hat{\mu}_{4,x}-\frac{(m-3)}{(m-1)}(\hat{\sigma}_m^2)^2)+\frac{N}{n}(\hat{\mu}_{4,y}-\frac{(n-3)}{(n-1)}(\hat{\sigma}_y^2)^2)}}</code>
</p>
 
<p>where <code class="reqn">\hat{\mu}_{4,m}</code> the sample analog of <code class="reqn">E(X-\mu)^4</code> based on an i.i.d. sample <code class="reqn">X_1,\dots,X_m</code> from <code class="reqn">P</code>. Similarly for <code class="reqn">\hat{\mu}_{4,n}</code>.
</p>
<p>We could also have the case when the parameter of interest is a function of the joint distribution. The examples considered here are
</p>
<p>Lehmann (1951) two-sample U statistics: Consider testing <code class="reqn">H_0: P=Q</code>, or the more general hypothesis that <code class="reqn">P</code> and <code class="reqn">Q</code> only differ in location against the alternative that the <code class="reqn">Y</code>'s are more spread out than the <code class="reqn">X</code>'s. The null hypothesis is of the form </p>
<p style="text-align: center;"><code class="reqn">H_0: P(\vert Y-Y'\vert&gt;\vert X-X'\vert)=1/2</code>
</p>
<p>.
</p>
<p>Two-sample Wilcoxon statistic, where the null hypothesis is of the form </p>
<p style="text-align: center;"><code class="reqn">H_0: P(X\le Y)=1/2</code>
</p>
<p>.
</p>
<p>Two-sample Wilcoxon statistic without continuity assumption. In this case, the null hypothesis is of the form </p>
<p style="text-align: center;"><code class="reqn">H_0: P(X\le Y)=P(Y\le X)</code>
</p>
<p>.
</p>
<p>Hollander (1967) two-sample U statistics. The null hypothesis is of the form </p>
<p style="text-align: center;"><code class="reqn">H_0: P(X+X'&lt;Y+Y')=1/2</code>
</p>
<p>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RPT(
  formula,
  data,
  test = "means",
  n.perm = 499,
  na.action,
  wilcoxon.option = "continuity"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RPT_+3A_formula">formula</code></td>
<td>
<p>a formula object, with the response on the left of a ~ operator, and the groups on the right.</p>
</td></tr>
<tr><td><code id="RPT_+3A_data">data</code></td>
<td>
<p>a data.frame in which to interpret the variables named in the formula. If this is missing, then the variables in the formula should be on the search list.</p>
</td></tr>
<tr><td><code id="RPT_+3A_test">test</code></td>
<td>
<p>test to be perfomed. Multiple options are available, depending on the nature of the testing problem. In general, we have two types of problem. First, when the researcher is interested in comparing parameters. In this case, &quot;means&quot; will perform a Difference of Means, &quot;medians&quot; a Difference of Medians, &quot;variances&quot; a Difference of Variances. This case allows for 2 or more population comparisons. For the test of difference of medians the Efron (1992) bootstrap estimator is used to estimate the variances (for further details, see Chung and Romano (2013)). Second, when the parameter of interest is a function of the joint distribution. In this case, &quot;lehmann.2S.test&quot; will perform Lehmann (1951) two-sample U statistics, &quot;wilcoxon.2s.test&quot; the two-sample Wilcoxon test (with or without continuity assumption), and &quot;hollander.2S.test&quot; Hollander (1967) two sample U statistics. In this case, only 2 sample comparisons are permitted.</p>
</td></tr>
<tr><td><code id="RPT_+3A_n.perm">n.perm</code></td>
<td>
<p>Numeric. Number of permutations needed for the stochastic approximation of the p-values. See remark 3.2 in Canay and Kamat (2017). The default is n.perm=499.</p>
</td></tr>
<tr><td><code id="RPT_+3A_na.action">na.action</code></td>
<td>
<p>a function to filter missing data. This is applied to the model.frame . The default is na.omit, which deletes observations that contain one or more missing values.</p>
</td></tr>
<tr><td><code id="RPT_+3A_wilcoxon.option">wilcoxon.option</code></td>
<td>
<p>Continuity assumption for Wilcoxon test&quot; with continuity (&quot;continuity&quot;) or without (&quot;discontinuity&quot;). The default is &quot;continuity&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class &quot;RPT&quot; is a list containing at least the following components:
</p>
<table>
<tr><td><code>description</code></td>
<td>
<p>Type of test, can be Difference of Means, Medians, or Variances.</p>
</td></tr>
<tr><td><code>n_populations</code></td>
<td>
<p>Number of grups.</p>
</td></tr>
<tr><td><code>N</code></td>
<td>
<p>Sample Size.</p>
</td></tr>
<tr><td><code>T.obs</code></td>
<td>
<p>Observed test statistic.</p>
</td></tr>
<tr><td><code>pvalue</code></td>
<td>
<p>P-value.</p>
</td></tr>
<tr><td><code>T.perm</code></td>
<td>
<p>Vector. Test statistics from the permutations.</p>
</td></tr>
<tr><td><code>n_perm</code></td>
<td>
<p>Number of permutations.</p>
</td></tr>
<tr><td><code>parameters</code></td>
<td>
<p>Estimated parameters.</p>
</td></tr>
<tr><td><code>sample_sizes</code></td>
<td>
<p>Groups lengths.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Maurcio Olivares
</p>
<p>Ignacio Sarmiento Barbieri
</p>


<h3>References</h3>

<p>Chung, E. and Romano, J. P. (2013). Exact and asymptotically robust permutation tests. The Annals of Statistics, 41(2):484–507.
Chung, E. and Romano, J. P. (2016). Asymptotically valid and exact permutation tests based on two-sample u-statistics. Journal of Statistical Planning and Inference, 168:97–105.
Devroye, L. P. and Wagner, T. J. (1980). The strong uniform consistency of kernel density estimates. In Multivariate Analysis V: Proceedings of the fifth International Symposium on Multivariate Analysis, volume 5, pages 59–77.
Efron, B. (1992). Bootstrap methods: another look at the jackknife. In Breakthroughs in statistics, pages 569–593. Springer.
Hall, P., DiCiccio, T. J., and Romano, J. P. (1989). On smoothing and the bootstrap. The Annals of Statistics, pages 692–704.
Hollander, M. (1967). Asymptotic efficiency of two nonparametric competitors of wilcoxon’s two sample test. Journal of the American Statistical Association, 62(319):939–949.
Lehmann, E. L. (1951). Consistency and unbiasedness of certain nonparametric tests. The Annals of Mathematical Statistics, pages 165–179.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
male&lt;-rnorm(50,1,1)
female&lt;-rnorm(50,1,2)
dta&lt;-data.frame(group=c(rep(1,50),rep(2,50)),outcome=c(male,female))
rpt.var&lt;-RPT(dta$outcome~dta$group,test="variances")
summary(rpt.var)


## End(Not run)
</code></pre>

<hr>
<h2 id='summary.prepivot.ks.permtest'>Summarizing Two-sample Goodness-of-fit Permutation Test under Covariate-adaptive Randomization</h2><span id='topic+summary.prepivot.ks.permtest'></span>

<h3>Description</h3>

<p><code>summary</code> method for class <code>"prepivot.ks.permtest"</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'prepivot.ks.permtest'
summary(object, ..., digits = max(3, getOption("digits") - 3))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.prepivot.ks.permtest_+3A_object">object</code></td>
<td>
<p>an object of class <code>"prepivot.ks.permtest"</code>, the result of calling <code><a href="#topic+prepivot.ks.permtest">prepivot.ks.permtest</a></code></p>
</td></tr>
<tr><td><code id="summary.prepivot.ks.permtest_+3A_...">...</code></td>
<td>
<p>unused</p>
</td></tr>
<tr><td><code id="summary.prepivot.ks.permtest_+3A_digits">digits</code></td>
<td>
<p>number of digits to display</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>summary.prepivot.ks.permtest</code> returns an object of <a href="base.html#topic+class">class</a> &quot;<code>summary.prepivot.ks.permtest</code>&quot; which has the following components
</p>
<table>
<tr><td><code>results</code></td>
<td>
<p>Matrix with the Testing Problem, Sample Sizes, Number of Permutations, Number of Bootstrap samples, Observed test Statistic, Critical value and P-value.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Maurcio Olivares
</p>

<hr>
<h2 id='summary.PT.Khmaladze.fit'>Summarizing Permutation Test for Heterogeneous Treatment Effects with Estimated Nuisance Parameter</h2><span id='topic+summary.PT.Khmaladze.fit'></span>

<h3>Description</h3>

<p><code>summary</code> method for class <code>"PT.Khmaladze.fit"</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'PT.Khmaladze.fit'
summary(object, ..., digits = max(3, getOption("digits") - 3))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.PT.Khmaladze.fit_+3A_object">object</code></td>
<td>
<p>an object of class <code>"PT.Khmaladze.fit"</code>, usually a result of a call to <code><a href="#topic+PT.Khmaladze.fit">PT.Khmaladze.fit</a></code></p>
</td></tr>
<tr><td><code id="summary.PT.Khmaladze.fit_+3A_...">...</code></td>
<td>
<p>unused</p>
</td></tr>
<tr><td><code id="summary.PT.Khmaladze.fit_+3A_digits">digits</code></td>
<td>
<p>number of digits to display</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>summary.PT.Khmaladze.fit</code> returns an object of <a href="base.html#topic+class">class</a> &quot;<code>summary.PT.Khmaladze.fit</code>&quot; which has the following components
</p>
<table>
<tr><td><code>results</code></td>
<td>
<p>Matrix with the Testing Problem, Sample Sizes, Number of Permutations, ATE, Test Statistic, Critical value and P-value.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Maurcio Olivares
</p>
<p>Ignacio Sarmiento Barbieri
</p>

<hr>
<h2 id='summary.PT.Khmaladze.MultTest'>Summarizing Permutation Test for Within-grpup Treatment Effect Heterogeneity in the presence of an Estimated Nuisance Parameter</h2><span id='topic+summary.PT.Khmaladze.MultTest'></span>

<h3>Description</h3>

<p><code>summary</code> method for class <code>"PT.Khmaladze.fit"</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'PT.Khmaladze.MultTest'
summary(object, ..., digits = max(3, getOption("digits") - 3))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.PT.Khmaladze.MultTest_+3A_object">object</code></td>
<td>
<p>an object of class <code>"PT.Khmaladze.MultTest"</code>, usually a result of a call to <code><a href="#topic+PT.Khmaladze.MultTest">PT.Khmaladze.MultTest</a></code></p>
</td></tr>
<tr><td><code id="summary.PT.Khmaladze.MultTest_+3A_...">...</code></td>
<td>
<p>unused</p>
</td></tr>
<tr><td><code id="summary.PT.Khmaladze.MultTest_+3A_digits">digits</code></td>
<td>
<p>number of digits to display</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>summary.PT.Khmaladze.MultTest</code> returns an object of <a href="base.html#topic+class">class</a> &quot;<code>summary.PT.Khmaladze.MultTest</code>&quot; which has the following components
</p>
<table>
<tr><td><code>results</code></td>
<td>
<p>Matrix with the Testing Problem, Number of Permutations for the test and the multiple testing procedure, number of subgroups, (raw) p-values, adjusted p-values, Test Statistic.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Maurcio Olivares
</p>

<hr>
<h2 id='summary.PTQTE.Khmaladze.fit'>Summarizing Quantile-Based Permutation Test with an Estimated Nuisance Parameter</h2><span id='topic+summary.PTQTE.Khmaladze.fit'></span>

<h3>Description</h3>

<p><code>summary</code> method for class <code>"PTQTE.Khmaladze.fit"</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'PTQTE.Khmaladze.fit'
summary(object, ..., digits = max(3, getOption("digits") - 3))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.PTQTE.Khmaladze.fit_+3A_object">object</code></td>
<td>
<p>an object of class <code>"PTQTE.Khmaladze.fit"</code>, the result of calling <code><a href="#topic+PTQTE.Khmaladze.fit">PTQTE.Khmaladze.fit</a></code></p>
</td></tr>
<tr><td><code id="summary.PTQTE.Khmaladze.fit_+3A_...">...</code></td>
<td>
<p>unused</p>
</td></tr>
<tr><td><code id="summary.PTQTE.Khmaladze.fit_+3A_digits">digits</code></td>
<td>
<p>number of digits to display</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>PTQTE.Khmaladze.fit</code> returns an object of <a href="base.html#topic+class">class</a> &quot;<code>PTQTE.Khmaladze.fit</code>&quot; which has the following components
</p>
<table>
<tr><td><code>results</code></td>
<td>
<p>Matrix with the Testing Problem, Sample Sizes, Number of Permutations, Observed test Statistic, Binary Rule and Significance Level.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Maurcio Olivares
</p>

<hr>
<h2 id='summary.RDperm'>Summarizing Regression Discontinuity Design Permutation Test</h2><span id='topic+summary.RDperm'></span>

<h3>Description</h3>

<p><code>summary</code> method for class <code>"RDPerm"</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'RDperm'
summary(object, digits = max(3, getOption("digits") - 3), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.RDperm_+3A_object">object</code></td>
<td>
<p>an object of class <code>"RDperm"</code>, usually a result of a call to <code><a href="#topic+RDperm">RDperm</a></code></p>
</td></tr>
<tr><td><code id="summary.RDperm_+3A_digits">digits</code></td>
<td>
<p>number of digits to display</p>
</td></tr>
<tr><td><code id="summary.RDperm_+3A_...">...</code></td>
<td>
<p>unused</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>summary.RDperm</code> returns an object of <a href="base.html#topic+class">class</a> &quot;<code>summary.RDperm</code>&quot; which has the following components
</p>
<table>
<tr><td><code>results</code></td>
<td>
<p>Matrix with the Test Statistic, P-values and Q used</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Maurcio Olivares
</p>
<p>Ignacio Sarmiento Barbieri
</p>

<hr>
<h2 id='summary.RPT'>Summarizing Robust Permutation Test</h2><span id='topic+summary.RPT'></span>

<h3>Description</h3>

<p><code>summary</code> method for class <code>"RPT"</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'RPT'
summary(object, ..., digits = max(3, getOption("digits") - 3))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.RPT_+3A_object">object</code></td>
<td>
<p>an object of class <code>"RPT"</code>, usually a result of a call to <code><a href="#topic+RPT">RPT</a></code></p>
</td></tr>
<tr><td><code id="summary.RPT_+3A_...">...</code></td>
<td>
<p>unused</p>
</td></tr>
<tr><td><code id="summary.RPT_+3A_digits">digits</code></td>
<td>
<p>number of digits to display</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>summary.RPT</code> returns an object of <a href="base.html#topic+class">class</a> &quot;<code>summary.RPT</code>&quot; which has the following components
</p>
<table>
<tr><td><code>results</code></td>
<td>
<p>Matrix with the Testing Problem, Point Estimates, Sample Sizes, Test Statistic, P-values and Sample Sizes.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Maurcio Olivares
</p>
<p>Ignacio Sarmiento Barbieri
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
