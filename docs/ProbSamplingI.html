<!DOCTYPE html><html lang="en"><head><title>Help for package ProbSamplingI</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ProbSamplingI}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ProbSamplingI-package'><p>Design and Sampling Strategies for Parameter Estimation and Sample Size Determination.</p></a></li>
<li><a href='#BER'><p>Bernoulli Sampling Design</p></a></li>
<li><a href='#CONGL'><p>Conglomerate Sampling</p></a></li>
<li><a href='#ESTRAT'><p>Stratified Sampling</p></a></li>
<li><a href='#M.MET'><p>Multi-Stage Sampling</p></a></li>
<li><a href='#MAS'><p>Simple Random Sampling Design without Replacement</p></a></li>
<li><a href='#MCR'><p>Simple Random Sampling Design with Replacement</p></a></li>
<li><a href='#n.ESTMAS'><p>Sample Size Through Stratified Sampling</p></a></li>
<li><a href='#n.MAS'><p>Sample Size Using Simple Random Sampling Design Without Replacement</p></a></li>
<li><a href='#n.MASC'><p>Sample size using simple random sampling design without conglomerate replacement.</p></a></li>
<li><a href='#PiPT'><p>Sampling Design without Replacement with Proportional Inclusion Probabilities for Sizes</p></a></li>
<li><a href='#PPT'><p>Sampling Design with Replacement and Size Proportional Selection Probabilities</p></a></li>
<li><a href='#R.SIS'><p>R-Systematic Sampling Design</p></a></li>
<li><a href='#WHICH1'><p>Positions of the components of a vector with respect to another vector</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Probabilistic Sampling Design and Strategies</td>
</tr>
<tr>
<td>Version:</td>
<td>2.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-01-31</td>
</tr>
<tr>
<td>Description:</td>
<td>It allows the user to determine sample sizes, select probabilistic samples,
 make estimates of different parameters for the total finite population and in studio domains,
 using the main design drawings.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-01-31 17:41:26 UTC; LENOVO</td>
</tr>
<tr>
<td>Author:</td>
<td>Jorge Barón [aut, cre, cph],
  Guillermo Martínez [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jorge Barón &lt;jorgeabaron@correo.unicordoba.edu.co&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-01-31 22:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='ProbSamplingI-package'>Design and Sampling Strategies for Parameter Estimation and Sample Size Determination.</h2><span id='topic+ProbSamplingI-package'></span>

<h3>Description</h3>

<p>This package provides functions for selecting a sample and estimating parameters such as total, mean, proportion and ratio; through the main sampling designs.
</p>


<h3>Details</h3>


<p>Index of help topics:
</p>
<pre>
BER                     Bernoulli Sampling Design
CONGL                   Conglomerate Sampling
ESTRAT                  Stratified Sampling
M.MET                   Multi-Stage Sampling
MAS                     Simple Random Sampling Design without
                        Replacement
MCR                     Simple Random Sampling Design with Replacement
PPT                     Sampling Design with Replacement and Size
                        Proportional Selection Probabilities
PiPT                    Sampling Design without Replacement with
                        Proportional Inclusion Probabilities for Sizes
ProbSamplingI-package   Design and Sampling Strategies for Parameter
                        Estimation and Sample Size Determination.
R.SIS                   R-Systematic Sampling Design
WHICH1                  Positions of the components of a vector with
                        respect to another vector
n.ESTMAS                Sample Size Through Stratified Sampling
n.MAS                   Sample Size Using Simple Random Sampling Design
                        Without Replacement
n.MASC                  Sample size using simple random sampling design
                        without conglomerate replacement.
</pre>
<p>Application of probabilistic sampling
</p>


<h3>Author(s)</h3>

<p> Jorge Alberto Barón Cárdenas &lt;jorgeabaron@correo.unicordoba.edu.co&gt;
</p>
<p>Guillermo Martínez Flórez &lt;guillermomartinez@correo.unicordoba.edu.co&gt;
</p>
<p>Maintainer: Jorge Alberto Barón Cárdenas &lt;jorgeabaron@correo.unicordoba.edu.co&gt;</p>


<h3>References</h3>

<p>Särndal, C. E., J. H. Wretman, and C. M. Cassel (1992). Foundations of Inference in Survey Sampling. Wiley New York.
</p>
<p>Cochran, W. G. (1977). Sampling Techniques, 3ra ed. New York: Wiley.
</p>
<p>Thompson, S. K. (1945). Wiley Series in Probability and Statistics, Sampling, 1ra ed. United States of America.
</p>

<hr>
<h2 id='BER'>Bernoulli Sampling Design</h2><span id='topic+BER'></span>

<h3>Description</h3>

<p>The BER function selects a random sample or estimates an interest parameter under a Bernoulli design.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BER(N,Pi,yk=NULL,zk=NULL,dk=NULL,type="selec",parameter="total",
    Nc=0.95,Ek=NULL)
# To selectionar: BER(N,Pi)
# To estimate: BER(yk,Pi,type="estm",parameter="total")
# To estimate in domains: BER(yk,Pi,type="estm.Ud",parameter="total")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BER_+3A_n">N</code></td>
<td>
<p>Size of the population.</p>
</td></tr>
<tr><td><code id="BER_+3A_pi">Pi</code></td>
<td>
<p>Probability of inclusion.</p>
</td></tr>
<tr><td><code id="BER_+3A_yk">yk</code></td>
<td>
<p>Vector of observations of the characteristic of interest. This  vector is only   necessary if you want to estimate</p>
</td></tr>
<tr><td><code id="BER_+3A_zk">zk</code></td>
<td>
<p>Vector of observations of the characteristic of interest of equal length that yk. This vector is necessary if the parameter of interest is the ratio and refers to the variable involved in the denominator of the ratio.</p>
</td></tr>
<tr><td><code id="BER_+3A_dk">dk</code></td>
<td>
<p>Factor that indicates the individuals that belong to each domain of interest,
Only needed if &quot;type&quot; is equal to &quot;estm.Ud&quot;.</p>
</td></tr>
<tr><td><code id="BER_+3A_type">type</code></td>
<td>
<p>This argument indicates the procedure that will have the function (&quot;select&quot;, &quot;estm&quot; or &quot;estm.Ud&quot;). If type is equal to &quot;select&quot; the function will make a selection, if it is equal to &quot;estm&quot; the function will perform the estimation of the indicated parameter and if it is equal to &quot;estm.Ud&quot; it will make an estimate in domain.</p>
</td></tr>
<tr><td><code id="BER_+3A_parameter">parameter</code></td>
<td>
<p>This argument indicates the parameter to be estimated (&quot;total&quot;, &quot;mean&quot;, &quot;prop&quot;, or &quot;ratio&quot;). </p>
</td></tr>
<tr><td><code id="BER_+3A_nc">Nc</code></td>
<td>
<p> Confidence level (between 0 and 1), for the confidence interval of the estimator in case the type is equal to &quot;estm&quot; or &quot;estm.Ud&quot;.</p>
</td></tr>
<tr><td><code id="BER_+3A_ek">Ek</code></td>
<td>
<p>Vector of random numbers of length equal to the size of the population. This argument is optional and by default the function generates them from a uniform distribution (0,1).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function returns two types of results using the Bernoulli sampling design, depending on the &quot;type&quot; argument, which indicates whether you want to select a sample (&quot;select&quot;) or estimate a parameter (&quot;estm&quot; or &quot;estm.Ud&quot;).
</p>
<p>If type=&quot;select&quot;, the function returns a list with two elements:
</p>
<table role = "presentation">
<tr><td><code>Ksel</code></td>
<td>
<p>Vector with the positions of the selected individuals.</p>
</td></tr>
<tr><td><code>nk</code></td>
<td>
<p>Selected sample size.</p>
</td></tr>
</table>
<p>If type=&quot;estm&quot; or type=&quot;estm.Ud&quot;, the function returns a data frame with the estimation of the parameter of interest, the estimated variance of the estimator, the standard error, the coefficient of variation (in percentage), a confidence interval and the design effect.
</p>


<h3>Author(s)</h3>

<p> Jorge Alberto Barón Cárdenas &lt;jorgeabaron@correo.unicordoba.edu.co&gt;
</p>
<p>Guillermo Martínez Flórez &lt;guillermomartinez@correo.unicordoba.edu.co&gt;</p>


<h3>References</h3>

<p>Särndal, C. E., J. H. Wretman, and C. M. Cassel (1992). Foundations of Inference in Survey Sampling. Wiley New York.
</p>
<p>Cochran, W. G. (1977). Sampling Techniques, 3ra ed. New York: Wiley.
</p>
<p>Thompson, S. K. (1945). Wiley Series in Probability and Statistics, Sampling, 1ra ed. United States of America.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>yk&lt;-rnorm(100,10,2)
zk&lt;-rnorm(100,10,2)
yk.p&lt;-as.factor(ifelse(yk&gt;10,1,0))


selection&lt;-BER(N=100,Pi=0.3,type="selec")
BER(yk=yk[selection$Ksel],Pi=0.3,type="estm",parameter="total")
BER(Pi=0.3,yk=yk[selection$Ksel],type="estm",parameter="mean")
BER(yk=yk.p[selection$Ksel],Pi=0.3,type="estm",parameter="prop")
BER(yk=yk[selection$Ksel],zk=zk[selection$Ksel],Pi=0.3,
 type="estm",parameter="ratio")

# Domain Estimates

#Sex&lt;-sample(2,100,replace=T)
Sex&lt;-rep(1:2,each=50)
dk&lt;-factor(Sex,labels=c("Man","Woman"))

BER(yk=yk[selection$Ksel],dk=dk[selection$Ksel],Pi=0.3,
 type="estm.Ud",parameter="total")
BER(yk=yk[selection$Ksel],dk=dk[selection$Ksel],Pi=0.3,
 type="estm.Ud",parameter="mean")
BER(yk=yk.p[selection$Ksel],dk=dk[selection$Ksel],Pi=0.3,
 type="estm.Ud",parameter="prop")
BER(yk=yk[selection$Ksel],zk=zk[selection$Ksel],
 dk=dk[selection$Ksel],Pi=0.3,type="estm.Ud",parameter="ratio")
</code></pre>

<hr>
<h2 id='CONGL'>Conglomerate Sampling</h2><span id='topic+CONGL'></span>

<h3>Description</h3>

<p>The CONGL function selects a random sample or estimates a parameter of interest under a cluster sampling design
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CONGL(Argt,cong,design="MAS",type="selec",parameter="total",yk=NULL,
 zk=NULL,dk=NULL,Ek=NULL,Nc=0.95)

# To select: CONGL(Argt=Argt,design)
# To estimate: CONGL(yk,cong,Argt,design,type="estm")
# To estimate in domains: CONGL(yk,dk,cong,Argt,design,type="estm.Ud")

# If the objective is to select a sample, the Argt argument is constructed as follows:

# "MAS": Argt&lt;-list(NI,nI)
# "MCR": Argt&lt;-list(NI,mI)
# "BER": Argt&lt;-list(NI,PiI)
# "PPT": Argt&lt;-list(txkI,mI)
# "PiPT": Argt&lt;-list(txkI,nI)

# If the objective is to estimate a parameter of interest, the Argt argument is
# constructed as follows:

# "MAS": Argt&lt;-list(NI,nI)
# "MCR": Argt&lt;-list(NI,mI)
# "BER": Argt&lt;-list(NI,PiI)
# "PPT": Argt&lt;-list(pkI)
# "PiPT": Argt&lt;-list(pikI,mpiklI)

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="CONGL_+3A_yk">yk</code></td>
<td>
<p>Vector of observations of the characteristic of interest. This vector is only necessary if you want to estimate.</p>
</td></tr>
<tr><td><code id="CONGL_+3A_zk">zk</code></td>
<td>
<p>Vector of observations of the characteristic of interest of equal length that yk. This vector is necessary if the parameter of interest is the ratio and refers to the variable involved in the denominator of the ratio.</p>
</td></tr>
<tr><td><code id="CONGL_+3A_dk">dk</code></td>
<td>
<p>Factor that indicates the individuals that belong to each domain of interest, Only needed if &quot;type&quot;&quot; is equal to &quot;estm.Ud&quot;.</p>
</td></tr>
<tr><td><code id="CONGL_+3A_type">type</code></td>
<td>
<p>This argument indicates the procedure that will have the function (&quot;select&quot;, &quot;estm&quot; or &quot;estm.Ud&quot;). If type is equal to &quot;select&quot; the function will make a selection, if it is equal to &quot;estm&quot; the function will make the estimation of the indicated parameter and if it is equal to &quot;estm.Ud&quot; it will make an estimate in domain.</p>
</td></tr>
<tr><td><code id="CONGL_+3A_argt">Argt</code></td>
<td>
<p>List with the necessary arguments to select or estimate by the design that you want to use.</p>
</td></tr>
<tr><td><code id="CONGL_+3A_cong">cong</code></td>
<td>
<p>Vector indicating which cluster each individual belongs to.</p>
</td></tr>
<tr><td><code id="CONGL_+3A_parameter">parameter</code></td>
<td>
<p>This argument indicates the parameter to be estimated (&quot;total&quot;, &quot;mean&quot;, &quot;prop&quot;, or &quot;ratio&quot;). </p>
</td></tr>
<tr><td><code id="CONGL_+3A_design">design</code></td>
<td>
<p>Sampling sampling design to be implemented (&quot;BER&quot;, &quot;MAS&quot;, &quot;MCR&quot;, &quot;PPT&quot;, &quot;SIS&quot; or &quot;PiPT&quot;).</p>
</td></tr>
<tr><td><code id="CONGL_+3A_nc">Nc</code></td>
<td>
<p>Confidence level (between 0 and 1), for the confidence interval of the estimator in case &quot;type&quot; is equal to &quot;estm&quot; or &quot;estm.Ud&quot;.</p>
</td></tr>
<tr><td><code id="CONGL_+3A_ek">Ek</code></td>
<td>
<p>Vector of random numbers of length equal to the size of the population. This argument is optional and by default the function generates them from a uniform distribution (0,1).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function returns two types of results under the cluster sampling design, depending on the &quot;type&quot; argument, which indicates whether to select a sample (&quot;select&quot;) or to estimate an interest parameter (&quot;estm&quot;, &quot;estm.Ud&quot;). The results obtained in each case depend on the design implemented, in this way, such results are the same ones obtained for the case of element sampling, but nevertheless in the estimation of the total the intra-sample rate of variance is appended (IVI).
</p>


<h3>Author(s)</h3>

<p> Jorge Alberto Barón Cárdenas &lt;jorgeabaron@correo.unicordoba.edu.co&gt;
</p>
<p>Guillermo Martínez Flórez &lt;guillermomartinez@correo.unicordoba.edu.co&gt;</p>


<h3>References</h3>

<p>Särndal, C. E., J. H. Wretman, and C. M. Cassel (1992). Foundations of Inference in Survey Sampling. Wiley New York.
</p>
<p>Cochran, W. G. (1977). Sampling Techniques, 3ra ed. New York: Wiley.
</p>
<p>Thompson, S. K. (1945). Wiley Series in Probability and Statistics, Sampling, 1ra ed. United States of America.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

yk&lt;-rnorm(120,10,2)
zk&lt;-rnorm(120,12,2)
yk.p&lt;-as.factor(ifelse(yk&gt;10,1,0))
cong&lt;-rep(1:12,each=10);cong
Sex&lt;-rep(1:2,each=60)
dk&lt;-factor(Sex,labels=c("Man","Woman"))
tyi&lt;-tapply(yk,cong,sum)
txkI&lt;-runif(12,0.95,1.1)*tyi
cor(tyi,txkI)
D1&lt;-data.frame(cong,yk,yk.p,zk,dk)


# MAS-CONGLOMERATE

Argt&lt;-list(NI=12,nI=3)
selection&lt;-CONGL(Argt=Argt,design="MAS")
D.sel&lt;-D1[WHICH1(selection$Ksel,cong),]
CONGL(yk=D.sel$yk,cong=D.sel$cong,Argt=Argt,design="MAS",type="estm")
CONGL(yk=D.sel$yk,cong=D.sel$cong,Argt=Argt,design="MAS",type="estm",
      parameter="mean")
CONGL(yk=D.sel$yk,zk=D.sel$zk,cong=D.sel$cong,Argt=Argt,design="MAS",
      type="estm",parameter="ratio")
CONGL(yk=D.sel$yk.p,cong=D.sel$cong,Argt=Argt,design="MAS",type="estm",
      parameter="prop")

#MCR-CONGLOMERATE

Argt&lt;-list(NI=10,mI=3)
selection&lt;-CONGL(Argt=Argt,design="MCR")
D.sel&lt;-D1[WHICH1(selection$Ksel,cong),]
Ni&lt;-table(cong)[selection$Ksel]
cong.s&lt;-rep(1:3,Ni)
CONGL(yk=D.sel$yk,cong=cong.s,Argt=Argt,design="MCR",type="estm")
CONGL(yk=D.sel$yk,cong=cong.s,Argt=Argt,design="MCR",type="estm",parameter="mean")
CONGL(yk=D.sel$yk,zk=D.sel$zk,cong=cong.s,Argt=Argt,design="MCR",type="estm",
       parameter="ratio")
CONGL(yk=D.sel$yk.p,cong=cong.s,Argt=Argt,design="MCR",type="estm",parameter="prop")

#BER-CONGLOMERATE

Argt&lt;-list(NI=10,PiI=0.4)
selection&lt;-CONGL(Argt=Argt,design="BER")
D.sel&lt;-D1[WHICH1(selection$Ksel,cong),]
CONGL(yk=D.sel$yk,cong=D.sel$cong,Argt=Argt,design="BER",type="estm")
CONGL(yk=D.sel$yk,cong=D.sel$cong,Argt=Argt,design="BER",type="estm",
      parameter="mean")
CONGL(yk=D.sel$yk,zk=D.sel$zk,cong=D.sel$cong,Argt=Argt,design="BER",
      type="estm",parameter="ratio")
CONGL(yk=D.sel$yk.p,cong=D.sel$cong,Argt=Argt,design="BER",type="estm",
      parameter="prop")

#PPT-CONGLOMERATE

Argt&lt;-list(txkI=txkI,mI=4)
selection&lt;-CONGL(Argt=Argt,design="PPT") ;selection
Argt&lt;-list(pkI=selection$pksel)
D.sel&lt;-D1[WHICH1(selection$Ksel,cong),]
Ni&lt;-table(cong)[selection$Ksel]
cong.s&lt;-rep(1:4,Ni)
CONGL(yk=D.sel$yk,cong=cong.s,Argt=Argt,design="PPT",type="estm")
CONGL(yk=D.sel$yk,cong=cong.s,Argt=Argt,design="PPT",type="estm",parameter="mean")
CONGL(yk=D.sel$yk,zk=D.sel$zk,cong=cong.s,Argt=Argt,design="PPT",type="estm",
      parameter="ratio")
CONGL(yk=D.sel$yk.p,cong=cong.s,Argt=Argt,design="PPT",type="estm",parameter="prop")


#PiPT-CONGLOMERATE

Argt&lt;-list(txkI=txkI,nI=4)
selection&lt;-CONGL(Argt=Argt,design="PiPT")
Argt&lt;-list(pikI=selection$piksel,mpiklI=selection$mpikl.s)
D.sel&lt;-D1[WHICH1(selection$Ksel,cong),]
CONGL(yk=D.sel$yk,cong=D.sel$cong,Argt=Argt,design="PiPT",type="estm")
CONGL(yk=D.sel$yk,cong=D.sel$cong,Argt=Argt,design="PiPT",type="estm",
       parameter="mean")
CONGL(yk=D.sel$yk,zk=D.sel$zk,cong=D.sel$cong,Argt=Argt,design="PiPT",
       type="estm",parameter="ratio")
CONGL(yk=D.sel$yk.p,cong=D.sel$cong,Argt=Argt,design="PiPT",type="estm",
      parameter="prop")


# Domain Estimate
# MAS-CONGLOMERATE

Argt&lt;-list(NI=12,nI=3)
selection&lt;-CONGL(Argt=Argt,design="MAS")
D.sel&lt;-D1[WHICH1(selection$Ksel,cong),]
CONGL(yk=D.sel$yk,dk=D.sel$dk,cong=D.sel$cong,Argt=Argt,
      design="MAS",type="estm.Ud")
CONGL(yk=D.sel$yk,dk=D.sel$dk,cong=D.sel$cong,Argt=Argt,
      design="MAS",type="estm.Ud",parameter="mean")
CONGL(yk=D.sel$yk,zk=D.sel$zk,dk=D.sel$dk,cong=D.sel$cong,Argt=Argt,
       design="MAS",type="estm.Ud",parameter="ratio")
CONGL(yk=D.sel$yk.p,dk=D.sel$dk,cong=D.sel$cong,Argt=Argt,
      design="MAS",type="estm.Ud",parameter="prop")

# Domain Estimate
# MCR-CONGLOMERATE

Argt&lt;-list(NI=10,mI=3)
selection&lt;-CONGL(Argt=Argt,design="MCR")
D.sel&lt;-D1[WHICH1(selection$Ksel,cong),]
Ni&lt;-table(cong)[selection$Ksel]
cong.s&lt;-rep(1:3,Ni)
CONGL(yk=D.sel$yk,dk=D.sel$dk,cong=cong.s,Argt=Argt,
      design="MCR",type="estm.Ud")
CONGL(yk=D.sel$yk,dk=D.sel$dk,cong=cong.s,Argt=Argt,design="MCR",
      type="estm.Ud",parameter="mean")
CONGL(yk=D.sel$yk,zk=D.sel$zk,dk=D.sel$dk,cong=cong.s,Argt=Argt,
      design="MCR",type="estm.Ud",parameter="ratio")
CONGL(yk=D.sel$yk.p,dk=D.sel$dk,cong=cong.s,Argt=Argt,design="MCR",
       type="estm.Ud",parameter="prop")

# Domain Estimate
# BER-CONGLOMERATE

Argt&lt;-list(NI=10,PiI=0.4)
selection&lt;-CONGL(Argt=Argt,design="BER")
D.sel&lt;-D1[WHICH1(selection$Ksel,cong),]
CONGL(yk=D.sel$yk,dk=D.sel$dk,cong=D.sel$cong,Argt=Argt,
      design="BER",type="estm.Ud")
CONGL(yk=D.sel$yk,dk=D.sel$dk,cong=D.sel$cong,Argt=Argt,
      design="BER",type="estm.Ud",parameter="mean")
CONGL(yk=D.sel$yk,dk=D.sel$dk,zk=D.sel$zk,cong=D.sel$cong,Argt=Argt,
      design="BER",type="estm.Ud",parameter="ratio")
CONGL(yk=D.sel$yk.p,dk=D.sel$dk,cong=D.sel$cong,Argt=Argt,
      design="BER",type="estm.Ud",parameter="prop")


</code></pre>

<hr>
<h2 id='ESTRAT'>Stratified Sampling</h2><span id='topic+ESTRAT'></span>

<h3>Description</h3>

<p>The ESTRAT function selects a random sample or estimates an interest parameter under a stratified sampling.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ESTRAT(strata,designs,nh,xk=NULL,yk=NULL,zk=NULL,dk=NULL,type="selec",
       Argt,parameter="total",rh=NULL,Ek=NULL,Nc=0.95)
# To select: ESTRAT(strata,nh,designs,xk,rh)
# To estimate: ESTRAT(yk,zk,strata,designs,type="estm",Argt,parameter)
# To estimate in domains: ESTRAT(yk,zk,dk,strata,designs,type="estm",Argt,parameter)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ESTRAT_+3A_strata">strata</code></td>
<td>
<p>Vector indicating which stratum each individual belongs to.</p>
</td></tr>
<tr><td><code id="ESTRAT_+3A_nh">nh</code></td>
<td>
<p>Vector that indicates the number of individuals to select in each stratum. This argument is required if the type argument is equal to &quot;select&quot;.</p>
</td></tr>
<tr><td><code id="ESTRAT_+3A_yk">yk</code></td>
<td>
<p>Vector of observations of the characteristic of interest. This vector is only necessary if you want to estimate.</p>
</td></tr>
<tr><td><code id="ESTRAT_+3A_zk">zk</code></td>
<td>
<p>Vector of observations of the characteristic of interest of equal length that yk. This vector is necessary if the parameter of interest is the ratio and refers to the variable involved in the denominator of the ratio.</p>
</td></tr>
<tr><td><code id="ESTRAT_+3A_xk">xk</code></td>
<td>
<p>Vector of observations of the auxiliary variable. This vector is only necessary if it is desired to select in any stratum by means of a probability selection or inclusion probability proportional to size design.</p>
</td></tr>
<tr><td><code id="ESTRAT_+3A_dk">dk</code></td>
<td>
<p>Factor that indicates the individuals that belong to each domain of interest, is only necessary if type is equal to &quot;estm.Ud&quot;. </p>
</td></tr>
<tr><td><code id="ESTRAT_+3A_type">type</code></td>
<td>
<p>This argument indicates the procedure that will have the function (&quot;select&quot;, &quot;estm&quot; or &quot;estm.Ud&quot;). If type is equal to &quot;select&quot; the function will make a selection, if it is equal to &quot;estm&quot; the function will perform the estimation of the indicated parameter and if it is equal to &quot;estm.Ud&quot; will make an estimate in domain.</p>
</td></tr>
<tr><td><code id="ESTRAT_+3A_designs">designs</code></td>
<td>
<p>Vector indicating the design to be used in each stratum (&quot;BER&quot;, &quot;MAS&quot;, &quot;MCR&quot;, &quot;PPT&quot;, &quot;SIS&quot; or &quot;PiPT&quot;).</p>
</td></tr>
<tr><td><code id="ESTRAT_+3A_parameter">parameter</code></td>
<td>
<p>This argument indicates the parameter to be estimated (&quot;total&quot;, &quot;average&quot;, &quot;prop&quot; or &quot;reason&quot;). </p>
</td></tr>
<tr><td><code id="ESTRAT_+3A_argt">Argt</code></td>
<td>
<p>It is a list with the necessary arguments for the estimates under the respective designs used in the strata.</p>
</td></tr>
<tr><td><code id="ESTRAT_+3A_rh">rh</code></td>
<td>
<p>Vector of size equal to the number of strata, necessary if it is desired to select under an r-sistematic design, which will have the number of starts to be used in the corresponding strata and zeros in the rest of the positions where this design is not used.</p>
</td></tr>
<tr><td><code id="ESTRAT_+3A_nc">Nc</code></td>
<td>
<p> Confidence level (between 0 and 1), for the confidence interval of the estimator in case the type is equal to &quot;estm&quot; or &quot;estm.Ud&quot;.</p>
</td></tr>
<tr><td><code id="ESTRAT_+3A_ek">Ek</code></td>
<td>
<p>Vector of random numbers of length equal to population size. This argument is optional and by default the function generates them from a uniform distribution (0,1). </p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function returns two types of results under the stratified sampling design depending on the &quot;type&quot; argument, which indicates whether to select (&quot;select&quot;) or estimate (&quot;estm&quot;, &quot;estm.Ud&quot;). If type is equal to &quot;select&quot; the function returns a list with two elements, the first is a data frame (Sample) in which one of its columns indicates the position of the selected individuals in each stratum and the second (Rtdos.h ) is a list with the results obtained in each stratum which are necessary when making a certain estimate. If type is equal to &quot;est&quot; or &quot;estm.Ud&quot;, the function returns a list with two data frames with the estimation of the parameter of interest, the estimated variance of the estimator, the standard error, the coefficient of variation (in percentage) and a confidence interval assuming normality; by stratum and in general.
</p>


<h3>Author(s)</h3>

<p> Jorge Alberto Barón Cárdenas &lt;jorgeabaron@correo.unicordoba.edu.co&gt;
</p>
<p>Guillermo Martínez Flórez &lt;guillermomartinez@correo.unicordoba.edu.co&gt;</p>


<h3>References</h3>

<p>Särndal, C. E., J. H. Wretman, and C. M. Cassel (1992). Foundations of Inference in Survey Sampling. Wiley New York.
</p>
<p>Cochran, W. G. (1977). Sampling Techniques, 3ra ed. New York: Wiley.
</p>
<p>Thompson, S. K. (1945). Wiley Series in Probability and Statistics, Sampling, 1ra ed. United States of America.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>yk&lt;-rnorm(1000,10,2)
xk&lt;-rnorm(1000,10,3)
zk&lt;-rnorm(1000,12,3)
yk.p&lt;-factor(ifelse(yk&gt;10,"A","B"))
strata&lt;-rep(1:5,each=200)
Sex&lt;-rep(1:2,length=1000)
dk&lt;-factor(Sex,labels=c("Man","Woman"))


nh&lt;-c(60,40,40,60,80)
designs&lt;-c("MAS","MAS","MAS","MAS","MAS")
select&lt;-ESTRAT(strata=strata,designs=designs,nh=nh)
Argt&lt;-select$Rtdos.h
Strata&lt;-strata[select$Sample$IND]
yksel&lt;-yk[select$Sample$IND]
yk.psel&lt;-as.factor(yk.p[select$Sample$IND])
zksel&lt;-zk[select$Sample$IND]
ESTRAT(yk=yksel,strata=Strata,designs=designs,Argt=Argt,
       type="estm",parameter="total")
ESTRAT(yk=yksel,strata=Strata,designs=designs,Argt=Argt,
       type="estm",parameter="mean")
ESTRAT(yk=yk.psel,strata=Strata,designs=designs,Argt=Argt,
      type="estm",parameter="prop")
ESTRAT(yk=yksel,zk=zksel,strata=Strata,designs=designs,Argt=Argt,
       type="estm",parameter="ratio")


designs&lt;-c("PiPT","PPT","MAS","MCR","BER")
select&lt;-ESTRAT(xk=xk,strata=strata,designs=designs,nh)
Argt&lt;-select$Rtdos.h
Strata&lt;-strata[select$Sample$IND]
yksel&lt;-yk[select$Sample$IND]
yk.psel&lt;-yk.p[select$Sample$IND]
zksel&lt;-zk[select$Sample$IND]
ESTRAT(yk=yksel,strata=Strata,designs=designs,Argt=Argt,
       type="estm",parameter="total")
ESTRAT(yk=yk.psel,strata=Strata,designs=designs,Argt=Argt,
      type="estm",parameter="prop")
ESTRAT(yk=yksel,strata=Strata,designs=designs,Argt=Argt,
       type="estm",parameter="mean")
ESTRAT(yk=yksel,zk=zksel,strata=Strata,designs=designs,Argt=Argt,
       type="estm",parameter="ratio")

# Estimates in Domains

designs&lt;-c("MAS","MAS","MAS","MAS","MAS")
select&lt;-ESTRAT(strata=strata,designs=designs,nh=nh)
Argt&lt;-select$Rtdos.h
Strata&lt;-strata[select$Sample$IND]
yksel&lt;-yk[select$Sample$IND]
yk.psel&lt;-yk.p[select$Sample$IND]
zksel&lt;-zk[select$Sample$IND]
dksel&lt;-dk[select$Sample$IND]
ESTRAT(yk=yksel,strata=Strata,dk=dksel,designs=designs,Argt=Argt,
        type="estm.Ud",parameter="total")
ESTRAT(yk=yksel,strata=Strata,dk=dksel,designs=designs,Argt=Argt,
      type="estm.Ud",parameter="mean")
ESTRAT(yk=yk.psel,strata=Strata,dk=dksel,designs=designs,Argt=Argt,
       type="estm.Ud",parameter="prop")
ESTRAT(yk=yksel,zk=zksel,strata=Strata,dk=dksel,designs=designs,
       Argt=Argt,type="estm.Ud",parameter="ratio")

</code></pre>

<hr>
<h2 id='M.MET'>Multi-Stage Sampling</h2><span id='topic+M.MET'></span>

<h3>Description</h3>

<p>The M.MET function selects a random sample or estimates an interest parameter under multi-stage sampling (up to four stages).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>M.MET(F.UM,designs,list.arg,p,type="selec",parameter="total",yk=NULL,
      zk=NULL,xk=NULL,dk=NULL,r=NULL,Nc=0.95)
# To select: M.MET(F.UM=F.UM,p=p,designs)
# To estimate: M.MET(yk,F.UM,p,designs,list.arg,type="estm",parameter)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="M.MET_+3A_yk">yk</code></td>
<td>
<p>Vector of observations of the characteristic of interest. This vector is only necessary if you want to estimate.</p>
</td></tr>
<tr><td><code id="M.MET_+3A_zk">zk</code></td>
<td>
<p>Vector of observations of the characteristic of interest of equal length that yk. This vector is necessary if the parameter of interest is the ratio and refers to the variable involved in the denominator of the ratio.</p>
</td></tr>
<tr><td><code id="M.MET_+3A_xk">xk</code></td>
<td>
<p>Vector of observations of the auxiliary variable. This vector is only necessary if you want to select using a layout that uses an auxiliary variable.</p>
</td></tr>
<tr><td><code id="M.MET_+3A_dk">dk</code></td>
<td>
<p>Factor that indicates the individuals that belong to each domain of interest, Only needed if type is equal to &quot;estm.Ud&quot;.</p>
</td></tr>
<tr><td><code id="M.MET_+3A_f.um">F.UM</code></td>
<td>
<p>Data.frame that contains columns indicating which sampling unit each individual belongs to within each stage.</p>
</td></tr>
<tr><td><code id="M.MET_+3A_p">p</code></td>
<td>
<p>Vector indicating the proportion of individuals to be selected at each sampling stage. This argument is necessary if the type is equal to &quot;select&quot;.</p>
</td></tr>
<tr><td><code id="M.MET_+3A_designs">designs</code></td>
<td>
<p>Vector indicating the design to be used in each stage (&quot;BER&quot;, &quot;MAS&quot;, &quot;MCR&quot;, &quot;R.SIS&quot;, &quot;PPT&quot;, &quot;PiPT&quot;).</p>
</td></tr>
<tr><td><code id="M.MET_+3A_list.arg">list.arg</code></td>
<td>
<p>List of arguments required for the estimate</p>
</td></tr>
<tr><td><code id="M.MET_+3A_r">r</code></td>
<td>
<p>Number of starts, this argument is only necessary if a r-systematic design is used in the last step.</p>
</td></tr>
<tr><td><code id="M.MET_+3A_type">type</code></td>
<td>
<p>This argument indicates the procedure that will have the function (&quot;select&quot;, &quot;estm&quot; or &quot;estm.Ud&quot;). If type is equal to &quot;select&quot; the function will make a selection, if it is equal to &quot;estm&quot; the function will perform the estimation of the indicated parameter and if it is equal to &quot;estm.Ud&quot; will make an estimate in domain.</p>
</td></tr>
<tr><td><code id="M.MET_+3A_parameter">parameter</code></td>
<td>
<p>This argument indicates the parameter to be estimated (&quot;total&quot;, &quot;mean&quot;, &quot;prop&quot; or &quot;ratio&quot;).</p>
</td></tr>
<tr><td><code id="M.MET_+3A_nc">Nc</code></td>
<td>
<p>Confidence level (between 0 and 1), for the confidence interval of the estimator in case the type is equal to &quot;estm&quot; or &quot;estm.Ud&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function returns two types of results through the multi-stage sampling strategy that needs to be implemented, depending on the &quot;type&quot; argument, which indicates whether you want to select a sample (&quot;select&quot;) or estimate a parameter (&quot;estm&quot; or &quot;estm.Ud&quot;).
</p>
<p>-If type=&quot;select&quot;, the function will return a list with two elements:
</p>
<table role = "presentation">
<tr><td><code>Sample</code></td>
<td>
<p>Data frame with the location of the selected individuals</p>
</td></tr>
<tr><td><code>Results</code></td>
<td>
<p>List with the results obtained in each stage, which are necessary when making a certain estimate.</p>
</td></tr>
</table>
<p>-If type = &quot;estm&quot; or type = &quot;estm.Ud&quot;, the function returns a data frame with the estimation of the parameter of interest, the estimated variance of the estimator, the standard error, the coefficient of variation (in percent) and a confidence interval.
</p>


<h3>Author(s)</h3>

<p> Jorge Alberto Barón Cárdenas &lt;jorgeabaron@correo.unicordoba.edu.co&gt;
</p>
<p>Guillermo Martínez Flórez &lt;guillermomartinez@correo.unicordoba.edu.co&gt;</p>


<h3>References</h3>

<p>Särndal, C. E., J. H. Wretman, and C. M. Cassel (1992). Foundations of Inference in Survey Sampling. Wiley New York.
</p>
<p>Cochran, W. G. (1977). Sampling Techniques, 3ra ed. New York: Wiley.
</p>
<p>Thompson, S. K. (1945). Wiley Series in Probability and Statistics, Sampling, 1ra ed. United States of America.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Selection and estimation using a 4-stage sampling

F.UPM&lt;-rep(1:5,each=1000)
F.USM&lt;-rep(1:5,each=200,length=5000)
F.UTM&lt;-rep(1:10,each=20,length=5000)
F.UCM&lt;-rep(1:20,length=5000)
F.UM&lt;-data.frame(F.UPM,F.USM,F.UTM,F.UCM)
p&lt;-c(0.3,0.3,0.3,0.2)
y&lt;-rnorm(5000,10,2)
z&lt;-rnorm(5000,12,2)
y.p&lt;-as.factor(ifelse(y&gt;10,"A","B"))
Sex&lt;-rep(1:2,length=5000)
d&lt;-factor(Sex,labels=c("Man","Woman"))

designs&lt;-c("MAS","MAS","MAS","MAS")
select&lt;-M.MET(F.UM=F.UM,p=p,designs=designs)
F.UM.s&lt;-select$Sample[6:8]
yk&lt;-y[select$Sample$IND]
yk.p&lt;-y.p[select$Sample$IND]
zk&lt;-z[select$Sample$IND]
dk&lt;-d[select$Sample$IND]
list&lt;-select$Results
M.MET(yk=yk,F.UM=F.UM.s,p=p,designs=designs,list.arg=list,
      type="estm",parameter="total")
M.MET(yk=yk,F.UM=F.UM.s,p=p,designs=designs,list.arg=list,
      type="estm",parameter="mean")
M.MET(yk=yk.p,F.UM=F.UM.s,p=p,designs=designs,list.arg=list,
      type="estm",parameter="prop")
M.MET(yk=yk,zk=zk,F.UM=F.UM.s,p=p,designs=designs,list.arg=list,
      type="estm",parameter="ratio")
M.MET(yk=yk,dk=dk,F.UM=F.UM.s,p=p,designs=designs,list.arg=list,
      type="estm.Ud",parameter="total")
M.MET(yk=yk,dk=dk,F.UM=F.UM.s,p=p,designs=designs,list.arg=list,
      type="estm.Ud",parameter="mean")
M.MET(yk=yk.p,dk=dk,F.UM=F.UM.s,p=p,designs=designs,list.arg=list,
      type="estm.Ud",parameter="prop")
M.MET(yk=yk,zk=zk,dk=dk,F.UM=F.UM.s,p=p,designs=designs,list.arg=list,
       type="estm.Ud",parameter="ratio")


xk&lt;-rnorm(5000,10,2)
designs&lt;-c("PiPT","MAS","PiPT","MAS")
select2&lt;-M.MET(xk=xk,F.UM=F.UM,p=p,designs=designs)
F.UM.s&lt;-select2$Sample[6:8]
yk&lt;-y[select2$Sample$IND]
yk.p&lt;-y.p[select2$Sample$IND]
zk&lt;-z[select2$Sample$IND]
dk&lt;-d[select2$Sample$IND]
list&lt;-select2$Results
M.MET(yk=yk,F.UM=F.UM.s,p=p,designs=designs,list.arg=list,
      type="estm",parameter="total")
M.MET(yk=yk,F.UM=F.UM.s,p=p,designs=designs,list.arg=list,
      type="estm",parameter="mean")
M.MET(yk=yk.p,F.UM=F.UM.s,p=p,designs=designs,list.arg=list,
      type="estm",parameter="prop")
M.MET(yk=yk,zk=zk,F.UM=F.UM.s,p=p,designs=designs,list.arg=list,
       type="estm",parameter="ratio")
M.MET(yk=yk,dk=dk,F.UM=F.UM.s,p=p,designs=designs,list.arg=list,
       type="estm.Ud",parameter="total")
M.MET(yk=yk,dk=dk,F.UM=F.UM.s,p=p,designs=designs,list.arg=list,
       type="estm.Ud",parameter="mean")
M.MET(yk=yk.p,dk=dk,F.UM=F.UM.s,p=p,designs=designs,list.arg=list,
      type="estm.Ud",parameter="prop")
M.MET(yk=yk,zk=zk,dk=dk,F.UM=F.UM.s,p=p,designs=designs,list.arg=list,
      type="estm.Ud",parameter="ratio")


</code></pre>

<hr>
<h2 id='MAS'>Simple Random Sampling Design without Replacement</h2><span id='topic+MAS'></span>

<h3>Description</h3>

<p>The MAS function selects a random sample or estimates a parameter of interest under a simple random sampling design without replacement.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MAS(N,n,yk=NULL,zk=NULL,dk=NULL,type="selec",method="fmuller",
              parameter="total",Nc=0.95,Ek=NULL)
# To select: MAS(N,n,method="fmuller")
# To estimate: MAS(yk,N,n,type="estm",parameter="total")
# To estimate in domains: MAS(yk,dk,N,n,type="estm.Ud",parameter="total")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MAS_+3A_n">N</code></td>
<td>
<p> Size of the population</p>
</td></tr>
<tr><td><code id="MAS_+3A_n">n</code></td>
<td>
<p>Sample size.</p>
</td></tr>
<tr><td><code id="MAS_+3A_yk">yk</code></td>
<td>
<p>Vector of observations of the characteristic of interest. This vector is only necessary if you want to estimate.</p>
</td></tr>
<tr><td><code id="MAS_+3A_zk">zk</code></td>
<td>
<p>Vector of observations of the characteristic of interest of equal length that yk. This vector is necessary if the parameter of interest is the ratio and refers to the variable involved in the denominator of the ratio.</p>
</td></tr>
<tr><td><code id="MAS_+3A_dk">dk</code></td>
<td>
<p>Factor that indicates the individuals that belong to each domain of interest,
Only needed if &quot;type&quot;&quot; is equal to &quot;estm.Ud&quot;.</p>
</td></tr>
<tr><td><code id="MAS_+3A_type">type</code></td>
<td>
<p>This argument indicates the procedure that will have the function (&quot;select&quot;, &quot;estm&quot; or &quot;estm.Ud&quot;). If type is equal to &quot;select&quot; the function will make a selection, if it is equal to &quot;estm&quot; the function will make the estimation of the indicated parameter and if it is equal to &quot;estm.Ud&quot; it will make an estimate in domain.</p>
</td></tr>
<tr><td><code id="MAS_+3A_method">method</code></td>
<td>
<p>Indicates the method or selection mechanism. If Method is equal to &quot;fmuller&quot; the function uses the Fan-Muller method or if it is equal to &quot;cnegative&quot; the function uses the negative coordinate method.</p>
</td></tr>
<tr><td><code id="MAS_+3A_parameter">parameter</code></td>
<td>
<p>This argument indicates the parameter to be estimated (&quot;total&quot;, &quot;mean&quot;, &quot;prop&quot;, or &quot;ratio&quot;). </p>
</td></tr>
<tr><td><code id="MAS_+3A_nc">Nc</code></td>
<td>
<p> Confidence level (between 0 and 1), for the confidence interval of the estimator in case &quot;type&quot; is equal to &quot;estm&quot; or &quot;estm.Ud&quot;.</p>
</td></tr>
<tr><td><code id="MAS_+3A_ek">Ek</code></td>
<td>
<p>Vector of random numbers of length equal to the size of the population. This argument is optional and by default the function generates them from a uniform distribution (0,1). </p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function returns two types of results using the simple random sample design without replacement depending on the &quot;type&quot; argument, which indicates whether to select a sample (&quot;select&quot;) or to estimate a parameter (&quot;estm&quot; or &quot;estm.Ud&quot;).
</p>
<p>If type=&quot;select&quot;, the function returns a list with a vector (Ksel) with the selected individuals' positions.
</p>
<p>If type=&quot;estm&quot; or type=&quot;estm.Ud&quot;, the function returns a data frame with the estimation of the parameter of interest, the estimated variance of the estimator, the standard error, the coefficient of variation (in percent) and an interval of trust.
</p>


<h3>Author(s)</h3>

<p>Jorge Alberto Barón Cárdenas &lt;jorgeabaron@correo.unicordoba.edu.co&gt;
</p>
<p>Guillermo Martinez Florez &lt;guillermomartinez@correo.unicordoba.edu.co&gt;</p>


<h3>References</h3>

<p>Särndal, C. E., J. H. Wretman, and C. M. Cassel (1992). Foundations of Inference in Survey Sampling. Wiley New York.
</p>
<p>Cochran, W. G. (1977). Sampling Techniques, 3ra ed. New York: Wiley.
</p>
<p>Thompson, S. K. (1945). Wiley Series in Probability and Statistics, Sampling, 1ra ed. United States of America.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>zk&lt;-rnorm(200,15,2)
yk&lt;-rnorm(200,10,3)
yk.p&lt;-as.factor(ifelse(yk&gt;10,"A","B"))
Sex&lt;-rep(1:2,length=200)
dk&lt;-factor(Sex,labels=c("Man","Woman"))
selection&lt;-MAS(N=200,n=40,type="selec",method="fmuller")
MAS(N=200,n=40,type="selec",method="cnegativo")

MAS(yk=yk[selection$K],N=200,n=40,type="estm",parameter="total")
MAS(yk=yk[selection$K],N=200,n=40,type="estm",parameter="mean")
MAS(yk=yk.p[selection$K],N=200,n=40,type="estm",parameter="prop")
MAS(yk=yk[selection$K],zk=zk[selection$K],N=200,n=40,type="estm",
    parameter="ratio")

# Domain Estimate

MAS(yk=yk[selection$K],dk=dk[selection$K],N=200,n=40,type="estm.Ud",
    parameter="total")
MAS(yk=yk[selection$K],dk=dk[selection$K],N=200,n=40,type="estm.Ud",
    parameter="mean")
MAS(yk=yk.p[selection$K],dk=dk[selection$K],N=200,n=40,type="estm.Ud",
    parameter="prop")
MAS(yk=yk[selection$K],zk=zk[selection$K],dk=dk[selection$K],N=200,n=40,
    type="estm.Ud",parameter="ratio")
</code></pre>

<hr>
<h2 id='MCR'>Simple Random Sampling Design with Replacement</h2><span id='topic+MCR'></span>

<h3>Description</h3>

<p>The MCR function selects a random sample or estimates an interest parameter under a simple random sampling design without replacement.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MCR(N,m,yk=NULL,zk=NULL,dk=NULL,type="selec",parameter="total",
    Ek=NULL,Nc=0.95)
# To select: MCR(N,m)
# To estimate: MCR(yk,N,m,type="estm",parameter)
# To domain estimate: MCR(yk,dk,N,m,type="est.Ud",parameter)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MCR_+3A_n">N</code></td>
<td>
<p> Size of the population.</p>
</td></tr>
<tr><td><code id="MCR_+3A_m">m</code></td>
<td>
<p>Sample size.</p>
</td></tr>
<tr><td><code id="MCR_+3A_yk">yk</code></td>
<td>
<p>Vector of observations of the characteristic of interest. This vector is only necessary if you want to estimate.</p>
</td></tr>
<tr><td><code id="MCR_+3A_zk">zk</code></td>
<td>
<p>Vector of observations of the characteristic of interest of equal length that yk. This vector is necessary if the parameter of interest is the ratio and refers to the variable involved in the denominator of the ratio.</p>
</td></tr>
<tr><td><code id="MCR_+3A_dk">dk</code></td>
<td>
<p>Factor that indicates the individuals that belong to each domain of interest,
Only needed if type is equal to &quot;estm.Ud&quot;.</p>
</td></tr>
<tr><td><code id="MCR_+3A_type">type</code></td>
<td>
<p>This argument indicates the procedure that will have the function (&quot;select&quot;, &quot;estm&quot; or &quot;estm.Ud&quot;). If type is equal to &quot;select&quot; the function will make a selection, if it is equal to &quot;estm&quot; the function will make the estimation of the indicated parameter and if it is equal to &quot;estm.Ud&quot; it will make an estimate in domain.</p>
</td></tr>
<tr><td><code id="MCR_+3A_parameter">parameter</code></td>
<td>
<p>This argument indicates the parameter to be estimated (&quot;total&quot;, &quot;mean&quot;, &quot;prop&quot;, or &quot;ratio&quot;). </p>
</td></tr>
<tr><td><code id="MCR_+3A_nc">Nc</code></td>
<td>
<p> Confidence level (between 0 and 1), for the confidence interval of the estimator in case the type is equal to &quot;estm&quot; or &quot;estm.Ud&quot;.</p>
</td></tr>
<tr><td><code id="MCR_+3A_ek">Ek</code></td>
<td>
<p>Vector of random numbers of length equal to the size of the population. This argument is optional and by default the function generates them from a uniform distribution (0,1). </p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function returns two types of results using the simple random sample design with replacement, depending on the &quot;type&quot; argument with which it is indicated to select a sample (&quot;select&quot;) or to estimate a parameter (&quot;estm&quot; or &quot;estm.Ud&quot;).
</p>
<p>If type=&quot;select&quot;, the function returns a list with two elements:
</p>
<table role = "presentation">
<tr><td><code>Ksel</code></td>
<td>
<p>Vector with the positions of the selected individuals.</p>
</td></tr>
<tr><td><code>pksel</code></td>
<td>
<p>Vector with the probabilities of selection of individuals.</p>
</td></tr>
</table>
<p>If type=&quot;estm&quot; or type=&quot;estm.Ud&quot;, the function returns a data frame with the estimation of the parameter of interest, the estimated variance of the estimator, the standard error, the coefficient of variation (in percentage), a confidence interval and the design effect.
</p>


<h3>Author(s)</h3>

<p>Jorge Alberto Barón Cárdenas &lt;jorgeabaron@correo.unicordoba.edu.co&gt;
</p>
<p>Guillermo Martínez Flórez &lt;guillermomartinez@correo.unicordoba.edu.co&gt;</p>


<h3>References</h3>

<p>Särndal, C. E., J. H. Wretman, and C. M. Cassel (1992). Foundations of Inference in Survey Sampling. Wiley New York.
</p>
<p>Cochran, W. G. (1977). Sampling Techniques, 3ra ed. New York: Wiley.
</p>
<p>Thompson, S. K. (1945). Wiley Series in Probability and Statistics, Sampling, 1ra ed. United States of America.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>yk&lt;-rnorm(200,10,2)
zk&lt;-rnorm(200,15,3)
yk.p&lt;-as.factor(ifelse(yk&gt;10,1,0))
selection&lt;-MCR(N=200,m=40)
MCR(yk=yk[selection$Ksel],N=200,m=40,type="estm",parameter="total")
MCR(yk=yk[selection$Ksel],N=200,m=40,type="estm",parameter="mean")
MCR(yk=yk.p[selection$Ksel],N=200,m=40,type="estm",parameter="prop")
MCR(yk=yk[selection$Ksel],zk=zk[selection$Ksel],N=200,m=40,
     type="estm",parameter="ratio")

# Domain Estimate

Sex&lt;-rep(1:2,length=200)
dk&lt;-factor(Sex,labels=c("Man","Woman"))
MCR(yk=yk[selection$K],dk=dk[selection$K],N=200,m=40,type="estm.Ud")
MCR(yk=yk[selection$K],dk=dk[selection$K],N=200,m=40,type="estm.Ud",
    parameter="mean")
MCR(yk=yk.p[selection$Ksel],dk=dk[selection$K],N=200,m=40,
    type="estm.Ud",parameter="prop")
MCR(yk=yk[selection$Ksel],zk=zk[selection$Ksel],dk=dk[selection$K],
    N=100,m=40,type="estm.Ud",parameter="ratio")

</code></pre>

<hr>
<h2 id='n.ESTMAS'>Sample Size Through Stratified Sampling</h2><span id='topic+n.ESTMAS'></span>

<h3>Description</h3>

<p>The n.ESTMAS function determines the sample size with its corresponding allocation by stratum, using a stratified sampling strategy, where a simple random sampling design with no replacement (ESTMAS) is applied in each stratum; taking into account whether the parameter of interest is the average (or total) or a proportion.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>n.ESTMAS(Nh,Sh,Ch,Ph,Emax.a,Nc=0.95,parameter="mean",Asig="Optima")

# n.ESTMAS(Nh,Sh,Ch,Emax.a,Nc=0.95,parameter="mean",Asig="Optima")
# n.ESTMAS(Nh,Ph,Ch,Emax.a,Nc=0.95,parameter="prop",Asig="Optima")

# n.ESTMAS(Nh,Sh,Emax.a,Nc=0.95,parameter="mean",Asig="Neyman")
# n.ESTMAS(Nh,Ph,Emax.a,Nc=0.95,parameter="prop",Asig="Neyman")

# n.ESTMAS(Nh,Sh,Emax.a,Nc=0.95,parameter="mean",Asig="Proportional")
# n.ESTMAS(Nh,Ph,Emax.a,Nc=0.95,parameter="prop",Asig="Proportional")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="n.ESTMAS_+3A_nh">Nh</code></td>
<td>
<p>Numerical vector with the respective sizes of strata.</p>
</td></tr>
<tr><td><code id="n.ESTMAS_+3A_sh">Sh</code></td>
<td>
<p>Numerical vector with the respective standard deviations of the variable of interest of each stratum. This argument is necessary only if the parameter of interest is the mean.</p>
</td></tr>
<tr><td><code id="n.ESTMAS_+3A_ch">Ch</code></td>
<td>
<p>Numerical vector with the costs of sampling an element within each stratum. This argument is only necessary if the allocation by stratum is the optimal allocation.</p>
</td></tr>
<tr><td><code id="n.ESTMAS_+3A_ph">Ph</code></td>
<td>
<p>Numerical vector with estimated proportions within each stratum.</p>
</td></tr>
<tr><td><code id="n.ESTMAS_+3A_emax.a">Emax.a</code></td>
<td>
<p>Absolute maximum error.</p>
</td></tr>
<tr><td><code id="n.ESTMAS_+3A_parameter">parameter</code></td>
<td>
<p>Type of parameter to be estimated, either the mean or a proportion (&quot;mean&quot;, &quot;prop&quot;).</p>
</td></tr>
<tr><td><code id="n.ESTMAS_+3A_nc">Nc</code></td>
<td>
<p>Confidence level (between 0 and 1) that you want to set.</p>
</td></tr>
<tr><td><code id="n.ESTMAS_+3A_asig">Asig</code></td>
<td>
<p>Assignment by stratum (&quot;Optima&quot;, &quot;Neyman&quot; or &quot;Proportional&quot;)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function returns the sample size and the allocation by stratum, through the conditions established in the arguments.
</p>


<h3>Author(s)</h3>

<p> Jorge Alberto Barón Cárdenas &lt;jorgeabaron@correo.unicordoba.edu.co&gt;
</p>
<p>Guillermo Martínez Flórez &lt;guillermomartinez@correo.unicordoba.edu.co&gt;</p>


<h3>References</h3>

<p>Särndal, C. E., J. H. Wretman, and C. M. Cassel (1992). Foundations of Inference in Survey Sampling. Wiley New York.
</p>
<p>Cochran, W. G. (1977). Sampling Techniques, 3ra ed. New York: Wiley.
</p>
<p>Thompson, S. K. (1945). Wiley Series in Probability and Statistics, Sampling, 1ra ed. United States of America.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
Nc&lt;-0.95
E&lt;-0.3
Nh&lt;-c(400,220,380)
Sh&lt;-sqrt(c(0.7521,1.4366,1.1361))
Ph&lt;-c(0.4,0.2,0.6)
Ch&lt;-c(1000,1200,1500)

# Optimal Assignment
n.ESTMAS(Nh=Nh,Sh=Sh,Ch=Ch,E=E,Nc=0.95,parameter="mean",Asig="Optima")
n.ESTMAS(Nh=Nh,Ph=Ph,Ch=Ch,E=E,Nc=0.95,parameter="prop",Asig="Optima")

# Neyman Assignment
n.ESTMAS(Nh=Nh,Sh=Sh,E=E,Nc=0.95,parameter="mean",Asig="Neyman")
n.ESTMAS(Nh=Nh,Ph=Ph,E=E,Nc=0.95,parameter="prop",Asig="Neyman")

# Proportional Assignment
n.ESTMAS(Nh=Nh,Sh=Sh,E=E,Nc=0.95,parameter="mean",Asig="Proportional")
n.ESTMAS(Nh=Nh,Ph=Ph,E=E,Nc=0.95,parameter="prop",Asig="Proportional")


</code></pre>

<hr>
<h2 id='n.MAS'>Sample Size Using Simple Random Sampling Design Without Replacement</h2><span id='topic+n.MAS'></span>

<h3>Description</h3>

<p>The n.MAS function determines the sample size by a simple random sample design without replacement, taking into account whether the parameter of interest is the mean (or total) or a proportion.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>n.MAS(N,Argt,Nc=0.95,opc=2)

# n.MAS(N,Argt=c(S,Emax.a),opc=1,Nc=0.95)
# n.MAS(N,Argt=c(Cve,Emax.r),opc=2,Nc=0.95)
# n.MAS(N,Argt=c(p,Emax.a),opc=3,Nc=0.95)
# n.MAS(N,Argt=c(p,Emax.r),opc=4,Nc=0.95)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="n.MAS_+3A_n">N</code></td>
<td>
<p>Population size.</p>
</td></tr>
<tr><td><code id="n.MAS_+3A_opc">opc</code></td>
<td>
<p>Numeric value from 1 to 4, which indicates the option to choose.</p>
</td></tr>
<tr><td><code id="n.MAS_+3A_argt">Argt</code></td>
<td>
<p>Vector of length two, in which its components depends on the chosen option (&quot;opc&quot;). If option 1, (opc = 1) is chosen, the components of the Argt vector are in their order, the standard deviation of the variable of interest and the respective absolute maximum error that can be admitted; If option 2 (opc = 2) is chosen, the components of the Argt vector are respectively the estimated coefficient of variation and the relative maximum error to be controlled; If option 3 (opc = 3) is chosen, the components are the estimated proportion and absolute maximum error that can be admitted; And if option 4 (opc = 4) is chosen, the components are the estimated ratio and the relative maximum error respectively.</p>
</td></tr>
<tr><td><code id="n.MAS_+3A_nc">Nc</code></td>
<td>
<p>Confidence level (between 0 and 1) that you want to set.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function returns the sample size through the conditions set in the arguments.
</p>


<h3>Author(s)</h3>

<p> Jorge Alberto Barón Cárdenas &lt;jorgeabaron@correo.unicordoba.edu.co&gt;
</p>
<p>Guillermo Martínez Flórez &lt;guillermomartinez@correo.unicordoba.edu.co&gt;</p>


<h3>References</h3>

<p>Särndal, C. E., J. H. Wretman, and C. M. Cassel (1992). Foundations of Inference in Survey Sampling. Wiley New York.
</p>
<p>Cochran, W. G. (1977). Sampling Techniques, 3ra ed. New York: Wiley.
</p>
<p>Thompson, S. K. (1945). Wiley Series in Probability and Statistics, Sampling, 1ra ed. United States of America.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Sample size for the mean (or total) when you want to control the absolute maximum error.

Nc&lt;-0.95
S&lt;-sqrt(6.0590)
Emax.a&lt;-0.2
N&lt;-10000
n.MAS(N=N,Argt=c(S,Emax.a),opc=1)


# Sample size for the mean (or total) when you want to control the relative maximum error.

Cve&lt;-0.4346
Emax.r&lt;-0.05
N&lt;-10000
n.MAS(N=N,Argt=c(Cve,Emax.r))

# Sample size for proportions when you want to control the absolute maximum error.

N&lt;-10000
p&lt;-14/30
Emax.a&lt;-0.04
Nc&lt;-0.9
n.MAS(N=N,Argt=c(p,Emax.a),opc=3,Nc=Nc)

# Sample size for proportions when you want to control the relative maximum error.

N&lt;-10000
p&lt;- 14/30
Emax.r&lt;-0.1
Nc&lt;-0.9
n.MAS(N=N,Argt=c(p,Emax.r),opc=4,Nc=Nc)
</code></pre>

<hr>
<h2 id='n.MASC'>Sample size using simple random sampling design without conglomerate replacement.</h2><span id='topic+n.MASC'></span>

<h3>Description</h3>

<p>The n.MASC function determines sample size using a simple random sampling design without replacement of Conglomerates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>n.MASC(N,NI,Ni,St,Emax.a,Nc=0.95,n.equal=TRUE)

# For clusters with equal sizes.
# n.MASC(NI,Ni,St,Emax.a,Nc)

# For clusters with different sizes.
# n.MASC(N,NI,St,Emax.a,Nc,n.equal=FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="n.MASC_+3A_n">N</code></td>
<td>
<p>Size of the population, this argument is only necessary if the size of the conglomerates is different. </p>
</td></tr>
<tr><td><code id="n.MASC_+3A_ni">NI</code></td>
<td>
<p>Number of clusters in the population.</p>
</td></tr>
<tr><td><code id="n.MASC_+3A_ni">Ni</code></td>
<td>
<p>Size of the clusters, this argument is only necessary if the conglomerates have equal size (constant size).</p>
</td></tr>
<tr><td><code id="n.MASC_+3A_st">St</code></td>
<td>
<p>Standard deviation of conglomerate totals.</p>
</td></tr>
<tr><td><code id="n.MASC_+3A_emax.a">Emax.a</code></td>
<td>
<p>Absolute maximum error.</p>
</td></tr>
<tr><td><code id="n.MASC_+3A_nc">Nc</code></td>
<td>
<p>Confidence level (between 0 and 1) to be set.</p>
</td></tr>
<tr><td><code id="n.MASC_+3A_n.equal">n.equal</code></td>
<td>
<p>Logical value indicating whether clusters have the same size</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function returns the sample size under the conditions set in the arguments, that is, the number of clusters to select.
</p>


<h3>Author(s)</h3>

<p> Jorge Alberto Barón Cárdenas &lt;jorgeabaron@correo.unicordoba.edu.co&gt;
</p>
<p>Guillermo Martínez Flórez &lt;guillermomartinez@correo.unicordoba.edu.co&gt;</p>


<h3>References</h3>

<p>Särndal, C. E., J. H. Wretman, and C. M. Cassel (1992). Foundations of Inference in Survey Sampling. Wiley New York.
</p>
<p>Cochran, W. G. (1977). Sampling Techniques, 3ra ed. New York: Wiley.
</p>
<p>Thompson, S. K. (1945). Wiley Series in Probability and Statistics, Sampling, 1ra ed. United States of America.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

# Sample size for populations with clusters of equal size.

st&lt;-sqrt(1417.8668)
NI&lt;-2000
Ni&lt;-6
e&lt;-2
nc=0.9
n.MASC(St=st,NI=NI,Ni=Ni,Emax.a=e,Nc=nc)

# Sample size for populations with clusters of different sizes.

st=sqrt(2019760.760)
N&lt;-11000
NI&lt;-400
e=10
nc=0.95
n.MASC(St=st,N=N,NI=NI,Emax.a=e,Nc=nc,n.equal=FALSE)
</code></pre>

<hr>
<h2 id='PiPT'>Sampling Design without Replacement with Proportional Inclusion Probabilities for Sizes</h2><span id='topic+PiPT'></span>

<h3>Description</h3>

<p>The PiPT function selects a random sample or estimates an interest parameter under a sampling design with proportional inclusion probabilities proportional to size.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PiPT(xk,n,yk=NULL,zk=NULL,pik=NULL,mpikl=NULL,dk=NULL,type="selec",
     parameter="total",Nc=0.95,Ek=NULL)

# To select: PiPT(xk,n)

# To estimate: PiPT(yk,pik,mpikl,type="estm",parameter="total")

# To estimate in domains
# PiPT(yk,pik,mpikl,dk,type="estm",parameter="total")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PiPT_+3A_xk">xk</code></td>
<td>
<p>Vector of observations of the auxiliary variable. This vector is only necessary if you wish to select.</p>
</td></tr>
<tr><td><code id="PiPT_+3A_n">n</code></td>
<td>
<p>Sample size.</p>
</td></tr>
<tr><td><code id="PiPT_+3A_yk">yk</code></td>
<td>
<p>Vector of observations of the characteristic of interest. This vector is only necessary if you want to estimate.</p>
</td></tr>
<tr><td><code id="PiPT_+3A_zk">zk</code></td>
<td>
<p>Vector of observations of the characteristic of interest of equal length that yk. This vector is necessary if the parameter of interest is the ratio and refers to the variable involved in the denominator of the ratio.</p>
</td></tr>
<tr><td><code id="PiPT_+3A_pik">pik</code></td>
<td>
<p>Vector of the first-order inclusion probabilities.</p>
</td></tr>
<tr><td><code id="PiPT_+3A_mpikl">mpikl</code></td>
<td>
<p>Matrix of second-order inclusion probabilities.</p>
</td></tr>
<tr><td><code id="PiPT_+3A_type">type</code></td>
<td>
<p>This argument indicates the procedure that will have the function (&quot;select&quot;, &quot;estm&quot; or &quot;estm.Ud&quot;). If type is equal to &quot;select&quot; the function will make a selection, if it is equal to &quot;estm&quot; the function will make the estimation of the indicated parameter and if it is equal to &quot;estm.Ud&quot; it will make an estimate in domain.</p>
</td></tr>
<tr><td><code id="PiPT_+3A_dk">dk</code></td>
<td>
<p>Factor that indicates the individuals that belong to each domain of interest,
Only needed if &quot;type&quot;&quot; is equal to &quot;estm.Ud&quot;.</p>
</td></tr>
<tr><td><code id="PiPT_+3A_parameter">parameter</code></td>
<td>
<p>This argument indicates the parameter to be estimated (&quot;total&quot;, &quot;mean&quot;, &quot;prop&quot;, or &quot;ratio&quot;). </p>
</td></tr>
<tr><td><code id="PiPT_+3A_nc">Nc</code></td>
<td>
<p> Confidence level (between 0 and 1), for the confidence interval of the estimator in case &quot;type&quot; is equal to &quot;estm&quot; or &quot;estm.Ud&quot;.</p>
</td></tr>
<tr><td><code id="PiPT_+3A_ek">Ek</code></td>
<td>
<p>Vector of random numbers of length equal to the size of the population. This argument is optional and by default the function generates them from a uniform distribution (0,1). </p>
</td></tr>
</table>


<h3>Value</h3>

<p>The PiPT function returns two types of results using a sampling design with inclusion probabilities proportional to size, depending on the argument
&quot;type&quot;, which indicates whether to select (&quot;select&quot;) or estimate (&quot;estm&quot; or &quot;estm.Ud&quot;).
</p>
<p>If type=&quot;select&quot; the function will return a list with three elements:
</p>
<table role = "presentation">
<tr><td><code>Ksel</code></td>
<td>
<p>Vector with the positions of the selected individuals</p>
</td></tr>
<tr><td><code>piksel</code></td>
<td>
<p>First order inclusion probability vector of selected individuals</p>
</td></tr>
<tr><td><code>mpikl.s</code></td>
<td>
<p>Matrix of the second-order inclusion probabilities</p>
</td></tr>
</table>
<p>If type=&quot;estm&quot; or type=&quot;estm.Ud&quot;, the function returns a data frame with the estimation of the parameter of interest, the estimated variance of the estimator, the standard error, the coefficient of variation (in percentage) and a confidence interval.
</p>


<h3>Author(s)</h3>

<p>Jorge Alberto Barón Cárdenas &lt;jorgeabaron@correo.unicordoba.edu.co&gt;
</p>
<p>Guillermo Martínez Flórez &lt;guillermomartinez@correo.unicordoba.edu.co&gt;</p>


<h3>References</h3>

<p>Särndal, C. E., J. H. Wretman, and C. M. Cassel (1992). Foundations of Inference in Survey Sampling. Wiley New York.
</p>
<p>Cochran, W. G. (1977). Sampling Techniques, 3ra ed. New York: Wiley.
</p>
<p>Thompson, S. K. (1945). Wiley Series in Probability and Statistics, Sampling, 1ra ed. United States of America.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(12265)
yk&lt;-rnorm(100,mean=50,sd=5)
zk&lt;-rnorm(100,mean=51,sd=5)
yk.p&lt;-as.factor(ifelse(yk&gt;50,"A","B"))
set.seed(12245)
# Información Auxiliar
xk&lt;-yk*runif(100,min=0.9,max=1.1)
r&lt;-cor(yk,xk)

selection&lt;-PiPT(xk=xk,n=10,type="selec")
PiPT(yk=yk[selection$Ksel],pik=selection$pik,mpikl=selection$mpikl.s,
     type="estm",parameter="total")
PiPT(yk=yk[selection$Ksel],pik=selection$pik,mpikl=selection$mpikl.s,
     type="estm",parameter="mean")
PiPT(yk=yk.p[selection$Ksel],pik=selection$pik,mpikl=selection$mpikl.s,
     type="estm",parameter="prop")
PiPT(yk=yk[selection$Ksel],zk=zk[selection$Ksel],pik=selection$pik,
     mpikl=selection$mpikl.s,type="estm",parameter="ratio")

# Domain Estimate

Sex&lt;-rep(1:2,length=100)
dk&lt;-factor(Sex,labels=c("Man","Woman"))
PiPT(yk=yk[selection$Ksel],pik=selection$pik,mpikl=selection$mpikl.s,
    dk=dk[selection$Ksel],type="estm.Ud",parameter="total")
PiPT(yk=yk[selection$Ksel],pik=selection$pik,mpikl=selection$mpikl.s,
     dk=dk[selection$Ksel],type="estm.Ud",parameter="mean")
PiPT(yk=yk.p[selection$Ksel],pik=selection$pik,mpikl=selection$mpikl.s,
     dk=dk[selection$Ksel],type="estm.Ud",parameter="prop")
PiPT(yk=yk[selection$Ksel],zk=zk[selection$Ksel],pik=selection$pik,
     mpikl=selection$mpikl.s,dk=dk[selection$Ksel],type="estm.Ud",
     parameter="ratio")


</code></pre>

<hr>
<h2 id='PPT'>Sampling Design with Replacement and Size Proportional Selection Probabilities</h2><span id='topic+PPT'></span>

<h3>Description</h3>

<p>The PPT function selects a random sample or estimates a parameter of interest under a sampling design with proportional proportional selection probabilities (PPT).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PPT(xk,m,yk=NULL,zk=NULL,pk=NULL,dk=NULL,type="selec",parameter="total",
    method ="acum.total",Nc=0.95,Ek=NULL)

# To select: PPT(xk,m,method="acum.total")
# To estimate: PPT(yk,pk,type="estm",parameter)
# To estimate in domains: PPT(yk,pk,dk,type="estm.Ud",parameter)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PPT_+3A_xk">xk</code></td>
<td>
<p> Vector of observations of the auxiliary variable. This vector is only necessary if you wish to select.</p>
</td></tr>
<tr><td><code id="PPT_+3A_m">m</code></td>
<td>
<p>Sample size.</p>
</td></tr>
<tr><td><code id="PPT_+3A_yk">yk</code></td>
<td>
<p>Vector of observations of the characteristic of interest. This vector is only necessary if you want to estimate.</p>
</td></tr>
<tr><td><code id="PPT_+3A_zk">zk</code></td>
<td>
<p>Vector of observations of the characteristic of interest of equal length that yk. This vector is necessary if the parameter of interest is the ratio and refers to the variable involved in the denominator of the ratio.</p>
</td></tr>
<tr><td><code id="PPT_+3A_pk">pk</code></td>
<td>
<p>Vector of the probabilities of selection of individuals.</p>
</td></tr>
<tr><td><code id="PPT_+3A_dk">dk</code></td>
<td>
<p>Factor that indicates the individuals that belong to each domain of interest, is only necessary if &quot;type&quot; is equal to &quot;estm.Ud&quot;.</p>
</td></tr>
<tr><td><code id="PPT_+3A_type">type</code></td>
<td>
<p>This argument indicates the procedure that will have the function (&quot;select&quot;, &quot;estm&quot; or &quot;estm.Ud&quot;). If &quot;type&quot; is equal to &quot;select&quot; the function will make a selection, if it is equal to &quot;estm&quot; the function will perform the estimation of the indicated parameter and if it is equal to &quot;estm.Ud&quot; it will make an estimate in domain.</p>
</td></tr>
<tr><td><code id="PPT_+3A_method">method</code></td>
<td>
<p>Indicates the method or selection mechanism. If method is equal to &quot;total cum.&quot; The function uses the total cumulative method or if it is equal to &quot;lahiri&quot; the function uses the method of Lahiri.</p>
</td></tr>
<tr><td><code id="PPT_+3A_parameter">parameter</code></td>
<td>
<p>This argument indicates the parameter to be estimated (&quot;total&quot;, &quot;mean&quot;, &quot;prop&quot;, or &quot;ratio&quot;). </p>
</td></tr>
<tr><td><code id="PPT_+3A_nc">Nc</code></td>
<td>
<p> Confidence level (between 0 and 1), for the confidence interval of the estimator in case the type is equal to &quot;estm&quot; or &quot;estm.Ud&quot;.</p>
</td></tr>
<tr><td><code id="PPT_+3A_ek">Ek</code></td>
<td>
<p>Vector of random numbers of length equal to the size of the population. This argument is optional and by default the function generates them from a uniform distribution (0,1). </p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function returns two types of results using the PPT sampling design, depending on the &quot;type&quot; argument with which to select (&quot;select&quot;) or estimate (&quot;estm&quot; or &quot;estm.Ud&quot;).
</p>
<p>If type is equal to &quot;select&quot; the function will return a list with two elements:
</p>
<table role = "presentation">
<tr><td><code>Ksel</code></td>
<td>
<p>Vector with the positions of the selected individuals.</p>
</td></tr>
<tr><td><code>pksel</code></td>
<td>
<p>Selection probabilities vector of selected individuals.</p>
</td></tr>
</table>
<p>-If type=&quot;estm&quot; or type=&quot;estm.Ud&quot;, the function returns a data frame with the estimation of the parameter of interest, the estimated variance of the estimator, the standard error, the coefficient of variation (in percentage) and a confidence interval.
</p>


<h3>Author(s)</h3>

<p> Jorge Alberto Barón Cárdenas &lt;jorgeabaron@correo.unicordoba.edu.co&gt;
</p>
<p>Guillermo Martínez Flórez &lt;guillermomartinez@correo.unicordoba.edu.co&gt;</p>


<h3>References</h3>

<p>Särndal, C. E., J. H. Wretman, and C. M. Cassel (1992). Foundations of Inference in Survey Sampling. Wiley New York.
</p>
<p>Cochran, W. G. (1977). Sampling Techniques, 3ra ed. New York: Wiley.
</p>
<p>Thompson, S. K. (1945). Wiley Series in Probability and Statistics, Sampling, 1ra ed. United States of America.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(12265)
yk&lt;-rnorm(100,50,5)
zk&lt;-rnorm(100,12,4)
set.seed(12245)
xk&lt;-yk*runif(100,min=0.9,max=1.1)
r&lt;-cor(yk,xk)
yk.p&lt;-as.factor(ifelse(yk&gt;50,"A","B"))

selection&lt;-PPT(xk=xk,m=10,type="selec",method="acum.total")
PPT(yk=yk[selection$Ksel],pk=selection$pksel,type="estm",parameter="total")
PPT(yk=yk[selection$Ksel],pk=selection$pksel,type="estm",parameter="mean")
PPT(yk=yk.p[selection$Ksel],pk=selection$pksel,type="estm",parameter="prop")
PPT(yk=yk[selection$Ksel],zk=zk[selection$Ksel],pk=selection$pksel,
    type="estm",parameter="ratio")

# Domain Estimate

Sex&lt;-rep(1:2,length=100)
dk&lt;-factor(Sex,labels=c("Man","Woman"))
PPT(yk=yk[selection$Ksel],dk=dk[selection$Ksel],pk=selection$pksel,
    type="estm.Ud",parameter="total")
PPT(yk=yk[selection$Ksel],dk=dk[selection$Ksel],pk=selection$pksel,
    type="estm.Ud",parameter="mean")
PPT(yk=yk.p[selection$Ksel],dk=dk[selection$Ksel],pk=selection$pksel,
    type="estm.Ud",parameter="prop")
PPT(yk=yk[selection$Ksel],zk=zk[selection$Ksel],dk=dk[selection$Ksel],
    pk=selection$pksel,type="estm.Ud",parameter="ratio")

</code></pre>

<hr>
<h2 id='R.SIS'>R-Systematic Sampling Design</h2><span id='topic+R.SIS'></span>

<h3>Description</h3>

<p>The R.SIS function selects a random sample or estimates a parameter of interest under a r-systematic sampling design.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>R.SIS(N,n,r,yk=NULL,zk=NULL,fact=NULL,dk=NULL,type="selec",
      parameter="total",Nc=0.95,Ek=NULL)

# To select: R.SIS(N,n,r)

#To estimate: R.SIS(N,n,r,fact,yk,type="estm",parameter)

# To estimate in domains
# R.SIS(yk,fact,N,n,r,type="estm.Ud",parameter)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="R.SIS_+3A_n">N</code></td>
<td>
<p> Size of the population.</p>
</td></tr>
<tr><td><code id="R.SIS_+3A_n">n</code></td>
<td>
<p>Sample size.</p>
</td></tr>
<tr><td><code id="R.SIS_+3A_r">r</code></td>
<td>
<p>Number of starts.</p>
</td></tr>
<tr><td><code id="R.SIS_+3A_yk">yk</code></td>
<td>
<p>Vector of observations of the characteristic of interest. This vector is only necessary if you want to estimate.</p>
</td></tr>
<tr><td><code id="R.SIS_+3A_zk">zk</code></td>
<td>
<p>Vector of observations of the characteristic of interest of equal length that yk. This vector is necessary if the parameter of interest is the ratio and refers to the variable involved in the denominator of the ratio.</p>
</td></tr>
<tr><td><code id="R.SIS_+3A_fact">fact</code></td>
<td>
<p>Factor indicating that Ur belongs to the observations of the variable of interest and yk. This factor is only necessary if type is equal to &quot;estm&quot; or &quot;estm.Ud&quot;.</p>
</td></tr>
<tr><td><code id="R.SIS_+3A_dk">dk</code></td>
<td>
<p>Factor that indicates the individuals that belong to each domain of interest, is only necessary if type is equal to &quot;estm.Ud&quot;.</p>
</td></tr>
<tr><td><code id="R.SIS_+3A_type">type</code></td>
<td>
<p>This argument indicates the procedure that will have the function (&quot;select&quot;, &quot;estm&quot; or &quot;estm.Ud&quot;). If &quot;type&quot; is equal to &quot;select&quot; the function will make a selection, if it is equal to &quot;estm&quot; the function will perform the estimation of the indicated parameter and if it is equal to &quot;estm.Ud&quot; it will make an estimate in domain.</p>
</td></tr>
<tr><td><code id="R.SIS_+3A_parameter">parameter</code></td>
<td>
<p>This argument indicates the parameter to be estimated (&quot;total&quot;, &quot;mean&quot;, &quot;prop&quot;, or &quot;ratio&quot;).</p>
</td></tr>
<tr><td><code id="R.SIS_+3A_nc">Nc</code></td>
<td>
<p> Confidence level (between 0 and 1), for the confidence interval of the estimator in case &quot;type&quot; is equal to &quot;estm&quot; or &quot;estm.Ud&quot;.</p>
</td></tr>
<tr><td><code id="R.SIS_+3A_ek">Ek</code></td>
<td>
<p>Vector of random numbers of length equal to the size of the population. This argument is optional and by default the function generates them from a uniform distribution (0,1). </p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function returns two types of results using the r-systematic sampling design, depending on the &quot;type&quot; argument with which to select (&quot;select&quot;) or estimate
&quot;estm.Ud&quot;).
</p>
<p>If type=&quot;select&quot;, the function returns a list with four elements:
</p>
<table role = "presentation">
<tr><td><code>Sel</code></td>
<td>
<p>Array with r columns that refers to the clusters selected by each boot</p>
</td></tr>
<tr><td><code>Ksel</code></td>
<td>
<p>Vector with selected individuals</p>
</td></tr>
<tr><td><code>fact</code></td>
<td>
<p>factor indicating which start each selected individual belongs to</p>
</td></tr>
<tr><td><code>n.s</code></td>
<td>
<p>Sample size</p>
</td></tr>
</table>
<p>If type=&quot;estm&quot; or type=&quot;estm.Ud&quot; the function returns a data frame with the estimation of the parameter of interest, the estimated variance of the estimator, the standard error, the coefficient of variation (in percent), an interval of confidence, the intraclass correlation coefficient and the intra-sample rate of variance.
</p>


<h3>Author(s)</h3>

<p> Jorge Alberto Barón Cárdenas &lt;jorgeabaron@correo.unicordoba.edu.co&gt;
</p>
<p>Guillermo Martínez Flórez &lt;guillermomartinez@correo.unicordoba.edu.co&gt;</p>


<h3>References</h3>

<p>Särndal, C. E., J. H. Wretman, and C. M. Cassel (1992). Foundations of Inference in Survey Sampling. Wiley New York.
</p>
<p>Cochran, W. G. (1977). Sampling Techniques, 3ra ed. New York: Wiley.
</p>
<p>Thompson, S. K. (1945). Wiley Series in Probability and Statistics, Sampling, 1ra ed. United States of America.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>yk&lt;-rnorm(100,40,2)
zk&lt;-rnorm(100,12,2)
yk.p&lt;-as.factor(ifelse(yk&gt;40,"A","B"))
selection&lt;-R.SIS(N=100,n=20,r=3,type="selec")


R.SIS(yk=yk[selection$Ksel],fact=selection$fact,N=100,n=20,r=3,
      type="estm",parameter="total")
R.SIS(yk=yk[selection$Ksel],fact=selection$fact,N=100,n=20,r=3,
       type="estm",parameter="mean")
R.SIS(yk=yk.p[selection$Ksel],fact=selection$fact,N=100,n=20,r=3,
       type="estm",parameter="prop")
R.SIS(yk=yk[selection$Ksel],zk=zk[selection$Ksel],fact=selection$fact,
       N=100,n=20,r=3,type="estm",parameter="ratio")


#Domain Estimate

Sex&lt;-rep(1:2,length=100)
dk&lt;-factor(Sex,labels=c("Man","Woman"))
R.SIS(yk=yk[selection$Ksel],fact=selection$fact,dk=dk[selection$Ksel],
      N=100,n=20,r=3,type="estm.Ud",parameter="total")
R.SIS(yk=yk[selection$Ksel],fact=selection$fact,dk=dk[selection$Ksel],
      N=100,n=20,r=3,type="estm.Ud",parameter="mean")
R.SIS(yk=yk.p[selection$Ksel],fact=selection$fact,dk=dk[selection$Ksel],
      N=100,n=20,r=3,type="estm.Ud",parameter="prop")
R.SIS(yk=yk[selection$Ksel],zk=zk[selection$Ksel],fact=selection$fact,
      dk=dk[selection$Ksel],N=100,n=20,r=3,type="estm.Ud",parameter="ratio")

</code></pre>

<hr>
<h2 id='WHICH1'>Positions of the components of a vector with respect to another vector</h2><span id='topic+WHICH1'></span>

<h3>Description</h3>

<p>The WHICH1 function returns the positions in which the vector components (V1) are located in another vector (V2).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>WHICH1(V1,V2)

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="WHICH1_+3A_v1">V1</code></td>
<td>
<p>Vector initial. </p>
</td></tr>
<tr><td><code id="WHICH1_+3A_v2">V2</code></td>
<td>
<p>Vector containing replicates of the components of the initial vector.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function is used to extract the positions of all the individuals that are part of the selected clusters, in a cluster sampling.
</p>


<h3>Author(s)</h3>

<p> Jorge Alberto Barón Cárdenas &lt;jorgeabaron@correo.unicordoba.edu.co&gt;
</p>
<p>Guillermo Martínez Flórez &lt;guillermomartinez@correo.unicordoba.edu.co&gt;</p>


<h3>References</h3>

<p>Särndal, C. E., J. H. Wretman, and C. M. Cassel (1992). Foundations of Inference in Survey Sampling. Wiley New York.
</p>
<p>Cochran, W. G. (1977). Sampling Techniques, 3ra ed. New York: Wiley.
</p>
<p>Thompson, S. K. (1945). Wiley Series in Probability and Statistics, Sampling, 1ra ed. United States of America.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>cong&lt;-rep(1:12,each=10)
Argt&lt;-list(NI=12,nI=3)
selection&lt;-CONGL(Argt=Argt,design="MAS")
WHICH1(selection$Ksel,cong)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
