<!DOCTYPE html><html><head><title>Help for package replicatedpp2w</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {replicatedpp2w}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#croton'>
<p>Replicated Point Pattern of Croton</p></a></li>
<li><a href='#K2w'>
<p>Two-Way ANOVA-Like Method to Analyze Replicated Point Patterns</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Two-Way ANOVA-Like Method to Analyze Replicated Point Patterns</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1-5</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-12-26</td>
</tr>
<tr>
<td>Author:</td>
<td>Marcelino de la Cruz Rot</td>
</tr>
<tr>
<td>Depends:</td>
<td>spatstat (&ge; 2.0-0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>spatstat.geom, spatstat.explore, spatstat.utils</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Marcelino de la Cruz &lt;marcelino.delacruz@urjc.es&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Test for effects of  both individual factors and their interaction on  replicated spatial patterns in a two factorial design, as explained in Ramon et al. (2016) &lt;<a href="https://doi.org/10.1111%2Fecog.01848">doi:10.1111/ecog.01848</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-12-26 11:24:04 UTC; marcelino</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-01-05 16:00:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='croton'>
Replicated Point Pattern of Croton 
</h2><span id='topic+croton'></span>

<h3>Description</h3>

<p>A list with a) a list of 16 point patterns  (with the <a href="spatstat.geom.html#topic+ppp">ppp</a> format of <code>spatstat</code>) of <em>Croton wagneri</em> in Soutern Ecuador; b) a factor  with different elevations (&quot;high&quot;, &quot;slow&quot;)  and c) a factor with different topographical conditions (&quot;steep&quot; or &quot;flat&quot; slope) for each point pattern. Each point pattern is actually the result of a random thining (50 percent) of the original  pattern analyzed by  Ramon et al. (in revision).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("croton")</code></pre>


<h3>References</h3>

<p>Ramon, P., De la Cruz, M., Chacon-Labella, J. &amp; Escudero, A. (in revision). A new two-way ANOVA-like method for analyzing replicated point patterns in ecology.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(croton)
</code></pre>

<hr>
<h2 id='K2w'>
Two-Way ANOVA-Like Method to Analyze Replicated Point Patterns
</h2><span id='topic+K2w'></span><span id='topic+print.k2w'></span><span id='topic+plot.k2w'></span>

<h3>Description</h3>

<p>Test for effects of  both individual factors and their interaction on  replicated spatial patterns in a two factorial design.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>K2w(pplist = NULL, dataKijk = NULL, nijk = NULL, r, r0 = NULL, rmax = NULL,
        tratA, tratB = NULL, wt = NULL, nsim = 999, correction = "trans", ...)
## S3 method for class 'k2w'
print(x,...)
## S3 method for class 'k2w'
plot(x, trat=NULL, ...,  lty = NULL, col = NULL, 
    lwd = NULL, xlim = NULL, ylim = NULL, xlab = NULL, ylab = NULL, 
     legend = TRUE, legendpos = "topleft",  fun="L", main=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="K2w_+3A_pplist">pplist</code></td>
<td>

<p>A list of point patterns with the <a href="spatstat.geom.html#topic+ppp">ppp</a> format of <span class="pkg">spatstat</span>. This argument os alternative to <code>dataKijk</code>.
</p>
</td></tr>
<tr><td><code id="K2w_+3A_datakijk">dataKijk</code></td>
<td>

<p>A <code>data.frame</code> with the K-functions (in columns) of each of the replicated point patterns. This argument os alternative to <code>pplist</code>.
</p>
</td></tr>
<tr><td><code id="K2w_+3A_nijk">nijk</code></td>
<td>

<p>A vector with the number of points in each of the replicated point patterns.
</p>
</td></tr>
<tr><td><code id="K2w_+3A_r">r</code></td>
<td>

<p>Vector of values for the argument r at which the K functions have been or should be evaluated. If the K functions are to be computed (i.e., if <code>dataKijk</code> is NULL), first element of <code>r</code> should be 0.
</p>
</td></tr>
<tr><td><code id="K2w_+3A_r0">r0</code></td>
<td>

<p>Minimum  r value for which K(r) estimates will be employed  to compute BTSS.
</p>
</td></tr>
<tr><td><code id="K2w_+3A_rmax">rmax</code></td>
<td>

<p>Maximum  r value for which K(r) estimates will be employed to compute BTSS.
</p>
</td></tr>
<tr><td><code id="K2w_+3A_trata">tratA</code></td>
<td>

<p>A <code>factor</code> asigning the levels of the first factor to each point pattern replicate.
</p>
</td></tr>
<tr><td><code id="K2w_+3A_tratb">tratB</code></td>
<td>

<p>A <code>factor</code> asigning the levels of the second factor to each point pattern replicate.
</p>
</td></tr>
<tr><td><code id="K2w_+3A_wt">wt</code></td>
<td>

<p>A weighting function employed to compute the BTSS. It can be either an R expression, a vector (with <code>length(wt) ==length (r)</code>) or a single value (i.e., same weight for all distances). By default, <code>K2w</code> will use <code>wt=r^-2 </code>. 
</p>
</td></tr>
<tr><td><code id="K2w_+3A_nsim">nsim</code></td>
<td>

<p>Number of resamples to estimate the sampling distribution of the BTSS statistic.
</p>
</td></tr>
<tr><td><code id="K2w_+3A_correction">correction</code></td>
<td>

<p>Any selection of the options &quot;border&quot;, &quot;bord.modif&quot;, &quot;isotropic&quot;, &quot;Ripley&quot;, &quot;translate&quot;, &quot;translation&quot;, &quot;none&quot; or &quot;best&quot;. It specifies the edge correction to be applied if K functions should be computed.
</p>
</td></tr>
<tr><td><code id="K2w_+3A_...">...</code></td>
<td>

<p>Additional arguments for <a href="spatstat.explore.html#topic+Kest">Kest</a> function of <span class="pkg">spatstat</span> (only applies if K functions should be computed) or additional graphical arguments for the <a href="graphics.html#topic+matplot">matplot</a> function.
</p>
</td></tr>
<tr><td><code id="K2w_+3A_x">x</code></td>
<td>

<p>an object of class <code>k2w</code>.
</p>
</td></tr>
<tr><td><code id="K2w_+3A_trat">trat</code></td>
<td>

<p>(optional)  Factor employed to compute the averaged K functions that will be ploted. By default, <code>plot.k2w</code> plots averaged functions for the interaction (i.e., for combination of levels of factors) if two factors have been employed in the analysis or for the levels of the unique factor employed (in the case of one-way analysis). To select  some specific display, use one of these: &quot;tratA&quot; (for the levels of the first factor), &quot;tratB&quot; (for the levels of the second factor)  or  &quot;tratAB&quot; (for the combinations of levels of both factors).
</p>
</td></tr>
<tr><td><code id="K2w_+3A_lty">lty</code></td>
<td>

<p>(optional) numeric vector of values of the graphical parameter <code>lty</code> controlling the line type of each plot. 
</p>
</td></tr>
<tr><td><code id="K2w_+3A_col">col</code></td>
<td>

<p>(optional) numeric vector of values of the graphical parameter <code>col</code> controlling the colour of each K function.
</p>
</td></tr>
<tr><td><code id="K2w_+3A_lwd">lwd</code></td>
<td>

<p>(optional) numeric vector of values of the graphical parameter <code>lwd</code> controlling the line width of each plot. 
</p>
</td></tr>
<tr><td><code id="K2w_+3A_xlim">xlim</code></td>
<td>

<p>(optional) range of x axis.
</p>
</td></tr>
<tr><td><code id="K2w_+3A_ylim">ylim</code></td>
<td>

<p>(optional) range of y axis.
</p>
</td></tr>
<tr><td><code id="K2w_+3A_xlab">xlab</code></td>
<td>

<p>(optional) label for x axis.
</p>
</td></tr>
<tr><td><code id="K2w_+3A_ylab">ylab</code></td>
<td>

<p>(optional) label for y axis.
</p>
</td></tr>
<tr><td><code id="K2w_+3A_legend">legend</code></td>
<td>

<p>Logical flag or <code>NULL</code>. If <code>legend=TRUE</code>, the algorithm plots a legend in the top left corner of the plot, explaining the meaning of the different line types and colours. 
</p>
</td></tr>
<tr><td><code id="K2w_+3A_legendpos">legendpos</code></td>
<td>

<p>The position of the legend. Either a character string keyword (see <a href="graphics.html#topic+legend">legend</a> for keyword options) or a pair of coordinates in the format <code>list(x,y)</code>.
</p>
</td></tr>
<tr><td><code id="K2w_+3A_fun">fun</code></td>
<td>

<p>One of  <code>"K"</code>  or <code>"L"</code> to select the function to be displayed. By default , L(r) = sqrt(K(r)/pi)-r would be ploted.
</p>
</td></tr>
<tr><td><code id="K2w_+3A_main">main</code></td>
<td>

<p>text to display as the title of the plot. By default, the name of the <code>k2w</code> object would be shown.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function implements a  extension of  the non-parametric one-way ANOVA-like method of Diggle et al. (1991)  to the two-way case, and particularly to test the effects of the interaction of two factors on the spatial structure of replicated point patterns.  From a set of K functions, it generates weighted averaged K functions for each level and combinations of levels of the factors and computes a statistic analogous to a <em>between-treatment sum of squares</em>  (BTSS) in clasical ANOVA.  More details are available in Ramon et al. (in revision).
</p>


<h3>Value</h3>

<p><code>K2w</code> returns an object of class <code>k2w</code>. Basically, a list with components:
</p>
<table>
<tr><td><code>btss.i</code></td>
<td>
<p>  Between treatment sum of squares (BTSS) for  factor A.</p>
</td></tr>
<tr><td><code>btss.j</code></td>
<td>
<p>  BTSS for  factor B.</p>
</td></tr>
<tr><td><code>btss.ij</code></td>
<td>
<p>  BTSS for the interaction of factors A and B.</p>
</td></tr>
<tr><td><code>btss.i.res</code></td>
<td>
<p>  Resampled distribution of the BTSS statistic  for  factor A.</p>
</td></tr>
<tr><td><code>btss.j.res</code></td>
<td>
<p>  Resampled distribution of BTSS for  factor B.</p>
</td></tr>
<tr><td><code>btss.ij.res</code></td>
<td>
<p>  Resampled distribution of BTSS for the interaction of factors A and B.</p>
</td></tr>
<tr><td><code>KrepA</code></td>
<td>
<p> Weighted average of the replicated K functions for each level of factor A.</p>
</td></tr>
<tr><td><code>KrepB</code></td>
<td>
<p> Weighted average of the replicated K functions for each level of factor B.</p>
</td></tr>
<tr><td><code>KrepAB</code></td>
<td>
<p> Weighted average of the replicated K functions for each combination of levels  of factors A and B.</p>
</td></tr>
<tr><td><code>K0i</code></td>
<td>
<p> Global weighted average (i.e., all K fucntions averaged together).</p>
</td></tr>
<tr><td><code>K0j</code></td>
<td>
<p> Global weighted average (i.e., all K fucntions averaged together).</p>
</td></tr>
<tr><td><code>K0ij</code></td>
<td>
<p> Global weighted average (i.e., all K fucntions averaged together).</p>
</td></tr>
<tr><td><code>Rik</code></td>
<td>
<p>  Data.frame with the residual functions for factor A.</p>
</td></tr>
<tr><td><code>Rjk</code></td>
<td>
<p>  Data.frame with the residual functions for factor B.</p>
</td></tr>
<tr><td><code>Rijk</code></td>
<td>
<p>  Data.frame with the residual functions for the interaction of factors A and B.</p>
</td></tr>
<tr><td><code>nsumA</code></td>
<td>
<p> Total number of points among the replicates in each level of factor A.</p>
</td></tr>
<tr><td><code>nsumB</code></td>
<td>
<p> Total number of points among the replicates in each level of factor B.</p>
</td></tr>
<tr><td><code>nsumAB</code></td>
<td>
<p> Total number of points among the replicates in each combinatipon of levels of factors A and B.</p>
</td></tr>
<tr><td><code>wt</code></td>
<td>
<p> Weighting function employed to compute the BTSS.</p>
</td></tr>
<tr><td><code>tratA</code></td>
<td>
<p> Factor A.</p>
</td></tr>
<tr><td><code>tratB</code></td>
<td>
<p> Factor B.</p>
</td></tr>
<tr><td><code>tratAB</code></td>
<td>
<p> Factor with the combination of levels of A and B.</p>
</td></tr>
<tr><td><code>dataKijk</code></td>
<td>
<p>  Data.frame with the empirical, replicated, K-functions.</p>
</td></tr>
<tr><td><code>nijk</code></td>
<td>
<p>  Vector with the number of points in each replicate.</p>
</td></tr>
<tr><td><code>r</code></td>
<td>
<p>  Vector of r distances at which  K functions are estimated.</p>
</td></tr>
<tr><td><code>r0</code></td>
<td>
<p> Minimum  r value for which K values have been employed to compute BTSS.</p>
</td></tr>
<tr><td><code>KA.res</code></td>
<td>
<p> Data.frame with the weighted average of replicated K functions for each level of factor A, for each of the nsim resamples.</p>
</td></tr>
<tr><td><code>KB.res</code></td>
<td>
<p> Data.frame with the weighted average of replicated K functions for each level of factor B, for each of the nsim resamples. </p>
</td></tr>
<tr><td><code>KAB.res</code></td>
<td>
<p> Data.frame with the weighted average of replicated K functions for each combination of levels  of factors A and B, for each of the nsim resamples.</p>
</td></tr>
<tr><td><code>nameA</code></td>
<td>
<p> name of the R object with factor A.</p>
</td></tr>
<tr><td><code>nameB</code></td>
<td>
<p> name of the R object with factor B.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marcelino de la Cruz
</p>


<h3>References</h3>

<p>Diggle, P.J., Nicholas, L. &amp; Benes, F.M. (1991) Analysis of Variance for Replicated Spatial Point Patterns in Clinical Neuroanatomy. <em>Journal of the American Statistical Association</em>, 86: 618-625.
</p>
<p>Ramon, P., De la Cruz, M., Chacon-Labella, J. &amp; Escudero, A. (2016). A new two-way ANOVA-like method for analyzing replicated point patterns in ecology. <em>Ecography</em>, 39:1109-1117. <a href="https://doi.org/10.1111/ecog.01848">doi:10.1111/ecog.01848</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Get the data
data(croton)

croton.2w &lt;- K2w(pplist=croton$list.ppp,  r=seq(0,8, by=0.1),               
               tratA=croton$elevation, tratB=croton$slope, nsim=99)

croton.2w

plot(croton.2w)

plot(croton.2w, "tratB")


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
