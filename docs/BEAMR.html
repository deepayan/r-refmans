<!DOCTYPE html><html lang="en"><head><title>Help for package BEAMR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {BEAMR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#beam_dat'><p>Pediatric T-ALL Clinical Data from COG trial AALL0434</p></a></li>
<li><a href='#beam_dat_sm'><p>Pediatric T-ALL Clinical Data from COG trial AALL0434</p></a></li>
<li><a href='#beam_specs'><p>Pediatric T-ALL BEAM Analysis Specs Data from COG trial AALL0434</p></a></li>
<li><a href='#beam_specs_sm'><p>Pediatric T-ALL BEAM Analysis Specs Data from COG trial AALL0434</p></a></li>
<li><a href='#beam_stats'><p>Pediatric T-ALL Clinical Data from COG trial AALL0434</p></a></li>
<li><a href='#beam_stats_sm'><p>Pediatric T-ALL Clinical Data from COG trial AALL0434</p></a></li>
<li><a href='#check_beam_specs'><p>Check that beam.specs satisfies all necessary conditions</p></a></li>
<li><a href='#check_list_class'><p>Check that each element of a list is of a required class</p></a></li>
<li><a href='#clean_Bmtx'><p>Clean up bootstrap coefficient matrix</p></a></li>
<li><a href='#clinf'><p>Pediatric T-ALL Clinical Data from COG trial AALL0434</p></a></li>
<li><a href='#compute_beam_stats'><p>Compute bootstrap model coefficients for BEAM</p></a></li>
<li><a href='#compute_feature_pvalues'><p>Compute feature level p-values from BEAM statistics</p></a></li>
<li><a href='#compute_set_pvalues'><p>Compute BEAMR p-values for sets</p></a></li>
<li><a href='#extend_set_data'><p>Extend set definition data with genes on the same row separated by commas, semicolons, slashes, etc</p></a></li>
<li><a href='#extract_beam_stats'><p>Extract beam stats for a specific set</p></a></li>
<li><a href='#find_id_clm'><p>Find the column of mtch.data with the most rows containing an element of ids</p></a></li>
<li><a href='#gen_beam_plot_list'><p>Generate BEAM Plot List</p></a></li>
<li><a href='#get_id_index'><p>For each row of the data.frame main.data, find the index of the matching element in vector ids</p></a></li>
<li><a href='#omicann'><p>Pediatric T-ALL Omics Annotation Data from COG trial AALL0434</p></a></li>
<li><a href='#omicdat'><p>Pediatric T-ALL Omics Data from COG trial AALL0434</p></a></li>
<li><a href='#plot_beam_boot'><p>Plot bootstrap output for BEAM sets</p></a></li>
<li><a href='#plot_beam_clin'><p>Plot BEAM Sets</p></a></li>
<li><a href='#plot_feat_clin'><p>Plot BEAM Feature</p></a></li>
<li><a href='#prep_beam_data'><p>Prepare data for BEAM analysis</p></a></li>
<li><a href='#prep_beam_plot'><p>Prepare for BEAM plotting</p></a></li>
<li><a href='#prep_beam_specs'><p>Prepare beam.specs</p></a></li>
<li><a href='#print.beam.data'><p>Print summary information about a beam.data object</p></a></li>
<li><a href='#print.beam.stats'><p>Print summary information about beam.stats object</p></a></li>
<li><a href='#setdat'><p>Map of Pediatric Data from COG trial AALL0434</p></a></li>
<li><a href='#specs'><p>Pediatric T-ALL BEAMR Analysis Specs Data from COG trial AALL0434</p></a></li>
<li><a href='#subset_beam_result'><p>Subset beam.stats Result</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Bootstrap Evaluation of Association Matrices</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.0</td>
</tr>
<tr>
<td>Description:</td>
<td>A bootstrap-based approach to integrate multiple forms of
    high dimensional genomic data with multiple clinical endpoints.  This method
    is used to find clinically meaningful groups of genomic features, such
    as genes or pathways. A manuscript describing this method is in preparation. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr, ggmosaic, ggplot2, ggpubr, logistf, magrittr, MASS,
purrr, rlist, stats, stringr, survival, survminer</td>
</tr>
<tr>
<td>Suggests:</td>
<td>rmarkdown</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://annaseffernick.github.io/BEAMR/">https://annaseffernick.github.io/BEAMR/</a>,
<a href="https://github.com/annaSeffernick/BEAMR">https://github.com/annaSeffernick/BEAMR</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/annaSeffernick/BEAMR/issues">https://github.com/annaSeffernick/BEAMR/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-07-22 13:49:20 UTC; aseffern</td>
</tr>
<tr>
<td>Author:</td>
<td>Anna Eames Seffernick
    <a href="https://orcid.org/0000-0003-0848-4604"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre,
    cph],
  Stanley Pounds [aut],
  Xueyuan Cao [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Anna Eames Seffernick &lt;anna.seffernick@stjude.org&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-07-27 16:00:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='beam_dat'>Pediatric T-ALL Clinical Data from COG trial AALL0434</h2><span id='topic+beam_dat'></span>

<h3>Description</h3>

<p>The beam.data object used in example beam analyses
</p>


<h3>Usage</h3>

<pre><code class='language-R'>beam_dat
</code></pre>


<h3>Format</h3>



<h4><code>beam_dat</code></h4>

<p>A beam.data object, which is a list with the following elements:
</p>

<dl>
<dt>main.data</dt><dd><p>A data.frame with clinical/endpoint data.</p>
</dd>
<dt>mtx.data</dt><dd><p>A list of the omics data matrices.</p>
</dd>
<dt>mtx.anns</dt><dd><p>A list of omic annotation data.frames.</p>
</dd>
<dt>anns.mtch</dt><dd><p>A data.frame with information to link mtx.data and mtx.anns.</p>
</dd>
<dt>set.data</dt><dd><p>A data.frame with set.id, mtx.id, and row.id to link omic features to sets.</p>
</dd>
<dt>set.anns</dt><dd><p>Optional data.frame with set annotation data.</p>
</dd>
<dt>boot.index</dt><dd><p>A matrix with bootstrap indices.</p>
</dd>
</dl>




<h3>Source</h3>

<p>NA
</p>

<hr>
<h2 id='beam_dat_sm'>Pediatric T-ALL Clinical Data from COG trial AALL0434</h2><span id='topic+beam_dat_sm'></span>

<h3>Description</h3>

<p>The smaller beam.data object used in the example for compute_beam_stats function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>beam_dat_sm
</code></pre>


<h3>Format</h3>



<h4><code>beam_dat_sm</code></h4>

<p>A beam.data object, which is a list with the following elements:
</p>

<dl>
<dt>main.data</dt><dd><p>A data.frame with clinical/endpoint data.</p>
</dd>
<dt>mtx.data</dt><dd><p>A list of the omics data matrices.</p>
</dd>
<dt>mtx.anns</dt><dd><p>A list of omic annotation data.frames.</p>
</dd>
<dt>anns.mtch</dt><dd><p>A data.frame with information to link mtx.data and mtx.anns.</p>
</dd>
<dt>set.data</dt><dd><p>A data.frame with set.id, mtx.id, and row.id to link omic features to sets.</p>
</dd>
<dt>set.anns</dt><dd><p>Optional data.frame with set annotation data.</p>
</dd>
<dt>boot.index</dt><dd><p>A matrix with bootstrap indices.</p>
</dd>
</dl>




<h3>Source</h3>

<p>NA
</p>

<hr>
<h2 id='beam_specs'>Pediatric T-ALL BEAM Analysis Specs Data from COG trial AALL0434</h2><span id='topic+beam_specs'></span>

<h3>Description</h3>

<p>The beam.specs object used in example beam analyses
</p>


<h3>Usage</h3>

<pre><code class='language-R'>beam_specs
</code></pre>


<h3>Format</h3>



<h4><code>beam_specs</code></h4>

<p>A data frame with 6 rows and 3 columns:
</p>

<dl>
<dt>name</dt><dd><p>Analysis name with omic and endpoint</p>
</dd>
<dt>mtx</dt><dd><p>Name of omics matrix used in the analysis</p>
</dd>
<dt>mdl</dt><dd><p>Regression model</p>
</dd>
</dl>




<h3>Source</h3>

<p>NA
</p>

<hr>
<h2 id='beam_specs_sm'>Pediatric T-ALL BEAM Analysis Specs Data from COG trial AALL0434</h2><span id='topic+beam_specs_sm'></span>

<h3>Description</h3>

<p>The small beam.specs object used in example compute_beam_stats function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>beam_specs_sm
</code></pre>


<h3>Format</h3>



<h4><code>beam_specs_sm</code></h4>

<p>A data frame with 2 rows and 3 columns:
</p>

<dl>
<dt>name</dt><dd><p>Analysis name with omic and endpoint</p>
</dd>
<dt>mtx</dt><dd><p>Name of omics matrix used in the analysis</p>
</dd>
<dt>mdl</dt><dd><p>Regression model</p>
</dd>
</dl>




<h3>Source</h3>

<p>NA
</p>

<hr>
<h2 id='beam_stats'>Pediatric T-ALL Clinical Data from COG trial AALL0434</h2><span id='topic+beam_stats'></span>

<h3>Description</h3>

<p>The beam.stats object used in example beam analyses
</p>


<h3>Usage</h3>

<pre><code class='language-R'>beam_stats
</code></pre>


<h3>Format</h3>



<h4><code>beam_stats</code></h4>

<p>A beam.stats object, which contains the following objects
</p>

<dl>
<dt>beam.stats</dt><dd><p>A list of data.frames of association statistics for each omic-endpoint pair.</p>
</dd>
<dt>beam.specs</dt><dd><p>A beam.specs object (data.frame with name, mtx, and mdl.)</p>
</dd>
<dt>beam.data</dt><dd><p>The beam.data object.</p>
</dd>
</dl>




<h3>Source</h3>

<p>NA
</p>

<hr>
<h2 id='beam_stats_sm'>Pediatric T-ALL Clinical Data from COG trial AALL0434</h2><span id='topic+beam_stats_sm'></span>

<h3>Description</h3>

<p>The small beam.stats object used in example for compute_beam_stats function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>beam_stats_sm
</code></pre>


<h3>Format</h3>



<h4><code>beam_stats_sm</code></h4>

<p>A beam.stats object, which contains the following objects
</p>

<dl>
<dt>beam.stats</dt><dd><p>A list of data.frames of association statistics for each omic-endpoint pair.</p>
</dd>
<dt>beam.specs</dt><dd><p>A beam.specs object (data.frame with name, mtx, and mdl.)</p>
</dd>
<dt>beam.data</dt><dd><p>The beam.data object.</p>
</dd>
</dl>




<h3>Source</h3>

<p>NA
</p>

<hr>
<h2 id='check_beam_specs'>Check that beam.specs satisfies all necessary conditions</h2><span id='topic+check_beam_specs'></span>

<h3>Description</h3>

<p>Check that beam.specs satisfies all necessary conditions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_beam_specs(beam.specs, mtx.names)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check_beam_specs_+3A_beam.specs">beam.specs</code></td>
<td>
<p>A data.frame with column name, mtx, and mdl</p>
</td></tr>
<tr><td><code id="check_beam_specs_+3A_mtx.names">mtx.names</code></td>
<td>
<p>A vector with the names of the data matrices (beam.data$mtx.data)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame of beam.specs if all conditions satisfied, otherwise throws an error
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(beam_dat)
data(beam_specs)
test_specs &lt;- check_beam_specs(beam_specs, names(beam_dat$mtx.data))
</code></pre>

<hr>
<h2 id='check_list_class'>Check that each element of a list is of a required class</h2><span id='topic+check_list_class'></span>

<h3>Description</h3>

<p>Check that each element of a list is of a required class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_list_class(list.object, required.class)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check_list_class_+3A_list.object">list.object</code></td>
<td>
<p>A list used in BEAMR analysis</p>
</td></tr>
<tr><td><code id="check_list_class_+3A_required.class">required.class</code></td>
<td>
<p>Class for list elements, e.g. matrix</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Logical TRUE if list is of required class
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(omicdat)
check_list_class(omicdat, "matrix")
</code></pre>

<hr>
<h2 id='clean_Bmtx'>Clean up bootstrap coefficient matrix</h2><span id='topic+clean_Bmtx'></span>

<h3>Description</h3>

<p>Clean up bootstrap coefficient matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clean_Bmtx(B)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="clean_Bmtx_+3A_b">B</code></td>
<td>
<p>Matrix of bootstrap coefficients</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Matrix of cleaned bootstrap coefficients
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(beam_stats)
B.mtx &lt;- beam_stats$beam.stats[[1]]
B.cln &lt;- clean_Bmtx(B.mtx)
</code></pre>

<hr>
<h2 id='clinf'>Pediatric T-ALL Clinical Data from COG trial AALL0434</h2><span id='topic+clinf'></span>

<h3>Description</h3>

<p>A subset of clinical data from pediatric and young adult t-lineage acute
lymphoblastic leukmia patients in the Children's Oncology Group trial
AALL0434, published in Liu et al., 2017 Nature Genetics
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clinf
</code></pre>


<h3>Format</h3>



<h4><code>clinf</code></h4>

<p>A data frame with 265 rows and 8 columns:
</p>

<dl>
<dt>ID</dt><dd><p>Subject ID</p>
</dd>
<dt>MRD29</dt><dd><p>Minimal residual disease measured at day 29</p>
</dd>
<dt>RNA.clm</dt><dd><p>Key to match to RNA matrix</p>
</dd>
<dt>Lesion.clm</dt><dd><p>Key to match Lesion matrix</p>
</dd>
<dt>Lesion.id</dt><dd><p>Key to match Lesion matrix</p>
</dd>
<dt>RNA.id</dt><dd><p>Key to match RNA matrix</p>
</dd>
<dt>EFS</dt><dd><p>Event-free survival Surv object</p>
</dd>
<dt>OS</dt><dd><p>Overall survival Surv object</p>
</dd>
</dl>




<h3>Source</h3>

<p><a href="https://www.nature.com/articles/ng.3909">https://www.nature.com/articles/ng.3909</a>
</p>

<hr>
<h2 id='compute_beam_stats'>Compute bootstrap model coefficients for BEAM</h2><span id='topic+compute_beam_stats'></span>

<h3>Description</h3>

<p>Compute bootstrap model coefficients for BEAM
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_beam_stats(beam.data, beam.specs, stdize = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compute_beam_stats_+3A_beam.data">beam.data</code></td>
<td>
<p>Result of prep.beam.data</p>
</td></tr>
<tr><td><code id="compute_beam_stats_+3A_beam.specs">beam.specs</code></td>
<td>
<p>A data.frame of strings with columns name, mtx, mdl (string with R model with mtx.row)</p>
</td></tr>
<tr><td><code id="compute_beam_stats_+3A_stdize">stdize</code></td>
<td>
<p>Logical whether to standardize (center and scale) predictors or not. Default is TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A beam.stats object, which is a list with beam.stats (the association matrices), the beam.specs, and the beam.data
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(beam_dat_sm)
data(beam_specs_sm)
test.beam.stats &lt;- compute_beam_stats(beam.data=beam_dat_sm,
                                      beam.specs=beam_specs_sm, stdize=TRUE)
</code></pre>

<hr>
<h2 id='compute_feature_pvalues'>Compute feature level p-values from BEAM statistics</h2><span id='topic+compute_feature_pvalues'></span>

<h3>Description</h3>

<p>Compute feature level p-values from BEAM statistics
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_feature_pvalues(beam.stats)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compute_feature_pvalues_+3A_beam.stats">beam.stats</code></td>
<td>
<p>A beam.stats object, which is a list with beam.stats (the association matrices), the beam.specs, and the beam.data</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of feature level p-values, with each entry a data frame for a different omics/endpoint associaiton, with columns id, gene, beta, p, q
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(beam_stats)
test.feat.pvals &lt;- compute_feature_pvalues(beam.stats=beam_stats)
</code></pre>

<hr>
<h2 id='compute_set_pvalues'>Compute BEAMR p-values for sets</h2><span id='topic+compute_set_pvalues'></span>

<h3>Description</h3>

<p>Compute BEAMR p-values for sets
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_set_pvalues(
  beam.stats,
  peel = FALSE,
  z = TRUE,
  alpha = 0.1,
  mess.freq = 25
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compute_set_pvalues_+3A_beam.stats">beam.stats</code></td>
<td>
<p>A beam.stats object from compute_beam_stats function</p>
</td></tr>
<tr><td><code id="compute_set_pvalues_+3A_peel">peel</code></td>
<td>
<p>Logical indicating whether to peel in p-value calculation</p>
</td></tr>
<tr><td><code id="compute_set_pvalues_+3A_z">z</code></td>
<td>
<p>Logical indicating whether to z-scale each vector of one coefficient estimate across bootstraps before analysis</p>
</td></tr>
<tr><td><code id="compute_set_pvalues_+3A_alpha">alpha</code></td>
<td>
<p>Maximum depth to peel (reduces computing time); default 0.1.</p>
</td></tr>
<tr><td><code id="compute_set_pvalues_+3A_mess.freq">mess.freq</code></td>
<td>
<p>Message frequency; default 25.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with a data.frame of set p-values from BEAMR analysis, a data.frame of summary row p-values, and a data frame of set matching.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(beam_stats_sm)
test.pvals &lt;- compute_set_pvalues(beam.stats=beam_stats_sm)
</code></pre>

<hr>
<h2 id='extend_set_data'>Extend set definition data with genes on the same row separated by commas, semicolons, slashes, etc</h2><span id='topic+extend_set_data'></span>

<h3>Description</h3>

<p>Extend set definition data with genes on the same row separated by commas, semicolons, slashes, etc
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extend_set_data(set.data, sep)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extend_set_data_+3A_set.data">set.data</code></td>
<td>
<p>A data frame with set definition data.</p>
</td></tr>
<tr><td><code id="extend_set_data_+3A_sep">sep</code></td>
<td>
<p>Punctuation to split on.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(setdat)
extend_set_data(setdat, sep=",")
</code></pre>

<hr>
<h2 id='extract_beam_stats'>Extract beam stats for a specific set</h2><span id='topic+extract_beam_stats'></span>

<h3>Description</h3>

<p>Extract beam stats for a specific set
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_beam_stats(beam.stats, set.id)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extract_beam_stats_+3A_beam.stats">beam.stats</code></td>
<td>
<p>A beam.stats object, which is a list with beam.stats (the association matrices), the beam.specs, and the beam.data</p>
</td></tr>
<tr><td><code id="extract_beam_stats_+3A_set.id">set.id</code></td>
<td>
<p>A character of a set id name (an entry in in beam.data$set.data$set.id)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix with with estimated associations for each endpoint and each omic feature linked to the set
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(beam_stats)
test.stats &lt;- extract_beam_stats(beam_stats, set.id="ENSG00000099810")
</code></pre>

<hr>
<h2 id='find_id_clm'>Find the column of mtch.data with the most rows containing an element of ids</h2><span id='topic+find_id_clm'></span>

<h3>Description</h3>

<p>Find the column of mtch.data with the most rows containing an element of ids
</p>


<h3>Usage</h3>

<pre><code class='language-R'>find_id_clm(mtch.data, ids)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="find_id_clm_+3A_mtch.data">mtch.data</code></td>
<td>
<p>A data.frame</p>
</td></tr>
<tr><td><code id="find_id_clm_+3A_ids">ids</code></td>
<td>
<p>A vector of row ids to match</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of column names with the most matches.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(omicann)
data(omicdat)
lsn.data &lt;- omicann[[1]]
mtx.rows &lt;- rownames(omicdat[[1]])
test &lt;- find_id_clm(lsn.data,mtx.rows)
</code></pre>

<hr>
<h2 id='gen_beam_plot_list'>Generate BEAM Plot List</h2><span id='topic+gen_beam_plot_list'></span>

<h3>Description</h3>

<p>Internal function: generate a list of clinical feature plots.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gen_beam_plot_list(
  beam.result,
  beam.specs,
  beam.feat.pvals,
  number.pairs = 1,
  set.id,
  feat.id = NULL,
  title.size = 10,
  pair.order = "both",
  endpt.order = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gen_beam_plot_list_+3A_beam.result">beam.result</code></td>
<td>
<p>Result of prep.beam.data</p>
</td></tr>
<tr><td><code id="gen_beam_plot_list_+3A_beam.specs">beam.specs</code></td>
<td>
<p>A data.frame of strings with columns name, mtx, mdl, plot</p>
</td></tr>
<tr><td><code id="gen_beam_plot_list_+3A_beam.feat.pvals">beam.feat.pvals</code></td>
<td>
<p>List of feature-level p-values from compute_feature_pvalues</p>
</td></tr>
<tr><td><code id="gen_beam_plot_list_+3A_number.pairs">number.pairs</code></td>
<td>
<p>Numeric; number of features to display in clinical plots, ordered by significance</p>
</td></tr>
<tr><td><code id="gen_beam_plot_list_+3A_set.id">set.id</code></td>
<td>
<p>A character with set name; must be in beam.result$beam.data$set.data$set.id</p>
</td></tr>
<tr><td><code id="gen_beam_plot_list_+3A_feat.id">feat.id</code></td>
<td>
<p>Default NULL; a character with feature name; must be in beam.result$beam.data$set.data$row.id</p>
</td></tr>
<tr><td><code id="gen_beam_plot_list_+3A_title.size">title.size</code></td>
<td>
<p>A numeric. Specify the size of individual plot titles. Default is 10.</p>
</td></tr>
<tr><td><code id="gen_beam_plot_list_+3A_pair.order">pair.order</code></td>
<td>
<p>One of c(&quot;both&quot;, &quot;omic&quot;, &quot;endpoint&quot;). Default is &quot;both.&quot; Specify how to choose feature-endpoint plots to include. If &quot;both&quot;, find the best (based on q, p, effect size) feature-omic pair for each type of omic and each endpoint separately. If &quot;omic&quot;, within each omic, find the best feature-endpoint pair and then plot this feature with all endpoints. If &quot;endpoint&quot;, need to specify endpt.order as the name of chosen endpoint. Then, within each omic, find the feature with best association with the selected endpoint, and plot this feature for all endpoints.</p>
</td></tr>
<tr><td><code id="gen_beam_plot_list_+3A_endpt.order">endpt.order</code></td>
<td>
<p>Default NULL. If pair.order=&quot;endpoint&quot;, specify character with endpoint name (from beam.specs$name, after the period).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of plots for the specified set and/or feature.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(beam_stats)
test.feat.pvals &lt;- compute_feature_pvalues(beam.stats=beam_stats)
plot.specs &lt;- prep_beam_plot(beam.data=beam_stats$beam.data,
                             beam.specs=beam_stats$beam.specs)
plot.list &lt;- gen_beam_plot_list(beam.result=beam_stats, beam.specs=plot.specs,
                                beam.feat.pvals=test.feat.pvals,
                                number.pairs=1, set.id="ENSG00000099810",
                                feat.id=NULL, title.size=11,
                                pair.order="omic", endpt.order=NULL)
</code></pre>

<hr>
<h2 id='get_id_index'>For each row of the data.frame main.data, find the index of the matching element in vector ids</h2><span id='topic+get_id_index'></span>

<h3>Description</h3>

<p>For each row of the data.frame main.data, find the index of the matching element in vector ids
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_id_index(mtch.data, ids, warn = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_id_index_+3A_mtch.data">mtch.data</code></td>
<td>
<p>A data.frame to be linked with the ids</p>
</td></tr>
<tr><td><code id="get_id_index_+3A_ids">ids</code></td>
<td>
<p>A vector of ids to be linked in mtch.data</p>
</td></tr>
<tr><td><code id="get_id_index_+3A_warn">warn</code></td>
<td>
<p>A logical value whether to include warnings with results</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame with matching id index
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(clinf)
data(omicdat)
mtx.clms &lt;- colnames(omicdat[[1]])
id_index &lt;- get_id_index(clinf,mtx.clms)
</code></pre>

<hr>
<h2 id='omicann'>Pediatric T-ALL Omics Annotation Data from COG trial AALL0434</h2><span id='topic+omicann'></span>

<h3>Description</h3>

<p>A subset of genomic lesion and RNA expression data from pediatric and young
adult t-lineage acute lymphoblastic leukmia patients in the Children's
Oncology Group trial AALL0434, published in Liu et al., 2017 Nature
Genetics. This is the annotation mapping feature id to gene name
given by Ensembl ID.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>omicann
</code></pre>


<h3>Format</h3>



<h4><code>omicann</code></h4>

<p>A list with two data frames of omics annotation.
</p>

<dl>
<dt>Lesion</dt><dd><p>A dataframe with 20 rows and 2 columns with lesion ID and Ensembl ID.</p>
</dd>
<dt>RNA</dt><dd><p>A dataframe with 20 rows and 2 columns with featue ID and Ensembl ID.</p>
</dd>
</dl>




<h3>Source</h3>

<p><a href="https://www.nature.com/articles/ng.3909">https://www.nature.com/articles/ng.3909</a>
</p>

<hr>
<h2 id='omicdat'>Pediatric T-ALL Omics Data from COG trial AALL0434</h2><span id='topic+omicdat'></span>

<h3>Description</h3>

<p>A subset of genomic lesion and RNA expression data from pediatric and young
adult t-lineage acute lymphoblastic leukmia patients in the Children's
Oncology Group trial AALL0434, published in Liu et al., 2017 Nature
Genetics
</p>


<h3>Usage</h3>

<pre><code class='language-R'>omicdat
</code></pre>


<h3>Format</h3>



<h4><code>omicdat</code></h4>

<p>A list with two dataframes of omic data for each subject
</p>

<dl>
<dt>Lesion</dt><dd><p>A dataframe with 20 rows and 265 columns indicating presence of lesion.</p>
</dd>
<dt>RNA</dt><dd><p>A dataframe with 20 rows and 265 columns with expression data.</p>
</dd>
</dl>




<h3>Source</h3>

<p><a href="https://www.nature.com/articles/ng.3909">https://www.nature.com/articles/ng.3909</a>
</p>

<hr>
<h2 id='plot_beam_boot'>Plot bootstrap output for BEAM sets</h2><span id='topic+plot_beam_boot'></span>

<h3>Description</h3>

<p>#' plot_beam_boot produces a pairs plot of the beam stats matrices. Default is maximum of 5 plots, ordered by most significant association direction.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_beam_boot(
  beam.result,
  beam.feat.pvals,
  beam.specs = NULL,
  set.id,
  max.plots = 4,
  z = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_beam_boot_+3A_beam.result">beam.result</code></td>
<td>
<p>A beam.stats object from compute_beam_stats</p>
</td></tr>
<tr><td><code id="plot_beam_boot_+3A_beam.feat.pvals">beam.feat.pvals</code></td>
<td>
<p>A list containing feature-level p-values from compute_feature_pvalues.</p>
</td></tr>
<tr><td><code id="plot_beam_boot_+3A_beam.specs">beam.specs</code></td>
<td>
<p>A data.frame. Default NULL, in which case beam.result$beam.specs is used. Otherwise can input other beam.specs data.frame that must contain name, mtx, mdl, plot columns.</p>
</td></tr>
<tr><td><code id="plot_beam_boot_+3A_set.id">set.id</code></td>
<td>
<p>A character specifying the name of a set. Must be in beam.result$beam.data$set.data</p>
</td></tr>
<tr><td><code id="plot_beam_boot_+3A_max.plots">max.plots</code></td>
<td>
<p>A number specifying the max number of rows in the pairs plot. Default is 4, ordered by feature-level p-value.</p>
</td></tr>
<tr><td><code id="plot_beam_boot_+3A_z">z</code></td>
<td>
<p>Logical indicating whether to z-scale each vector of one coefficient estimate across bootstraps before plotting. Default is TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A pairs plot figure.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(beam_stats)
test.pvals &lt;- compute_set_pvalues(beam.stats=beam_stats)
test.feat.pvals &lt;- compute_feature_pvalues(beam.stats=beam_stats)
test.boot.plot &lt;- plot_beam_boot(beam_stats, test.feat.pvals,
                                 set.id="ENSG00000099810")
</code></pre>

<hr>
<h2 id='plot_beam_clin'>Plot BEAM Sets</h2><span id='topic+plot_beam_clin'></span>

<h3>Description</h3>

<p>plot_beam_clin produces a matrix of feature level clinical plots for a set. Users can specify which omic/endpoint pairs they want to see as well as the number of features from the set. Default is all omic/endpoint pairs and the top feature (smallest feature-level p-value).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_beam_clin(
  beam.result,
  beam.specs = NULL,
  beam.set.pvals,
  beam.feat.pvals,
  set.id,
  gene.name = NULL,
  pair.type = NULL,
  number.pairs = 1,
  pair.order = "both",
  endpt.order = NULL,
  n.col = NULL,
  n.row = NULL,
  title.size = 10
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_beam_clin_+3A_beam.result">beam.result</code></td>
<td>
<p>A beam.stats object from compute_beam_stats</p>
</td></tr>
<tr><td><code id="plot_beam_clin_+3A_beam.specs">beam.specs</code></td>
<td>
<p>A data.frame. Default NULL, in which case beam.result$beam.specs is used. Otherwise can input other beam.specs data.frame that must contain name, mtx, mdl, plot columns.</p>
</td></tr>
<tr><td><code id="plot_beam_clin_+3A_beam.set.pvals">beam.set.pvals</code></td>
<td>
<p>A list containing BEAMR set p-values from compute_set_pvalues.</p>
</td></tr>
<tr><td><code id="plot_beam_clin_+3A_beam.feat.pvals">beam.feat.pvals</code></td>
<td>
<p>A list containing feature-level p-values from compute_feature_pvalues.</p>
</td></tr>
<tr><td><code id="plot_beam_clin_+3A_set.id">set.id</code></td>
<td>
<p>A character specifying the name of a set. Must be in beam.result$beam.data$set.data</p>
</td></tr>
<tr><td><code id="plot_beam_clin_+3A_gene.name">gene.name</code></td>
<td>
<p>A character specifying a Gene Name/Symbol for the set. Default is NULL</p>
</td></tr>
<tr><td><code id="plot_beam_clin_+3A_pair.type">pair.type</code></td>
<td>
<p>A character vector. Default NULL, in which case clinical plots for all omic/endpoint pairs are produced. Otherwise specify pairs from beam.stats$beam.specs$name</p>
</td></tr>
<tr><td><code id="plot_beam_clin_+3A_number.pairs">number.pairs</code></td>
<td>
<p>A numeric. Default 1, in which case only feature with best simple test for each pair is plotted. If &gt;1, show top n simple plots ordered by feature-level p-value</p>
</td></tr>
<tr><td><code id="plot_beam_clin_+3A_pair.order">pair.order</code></td>
<td>
<p>One of c(&quot;both&quot;, &quot;omic&quot;, &quot;endpoint&quot;). Default is &quot;both.&quot; Specify how to choose feature-endpoint plots to include. If &quot;both&quot;, find the best (based on q, p, effect size) feature-omic pair for each type of omic and each endpoint separately. If &quot;omic&quot;, within each omic, find the best feature-endpoint pair and then plot this feature with all endpoints. If &quot;endpoint&quot;, need to specify endpt.order as the name of chosen endpoint. Then, within each omic, find the feature with best association with the selected endpoint, and plot this feature for all endpoints.</p>
</td></tr>
<tr><td><code id="plot_beam_clin_+3A_endpt.order">endpt.order</code></td>
<td>
<p>Default NULL. If pair.order=&quot;endpoint&quot;, specify character with endpoint name (from beam.specs$name, after the period).</p>
</td></tr>
<tr><td><code id="plot_beam_clin_+3A_n.col">n.col</code></td>
<td>
<p>A numeric. Specify the number of columns for the plot layout; default NULL will use the number of omics types.</p>
</td></tr>
<tr><td><code id="plot_beam_clin_+3A_n.row">n.row</code></td>
<td>
<p>A numeric. Specify the number of rows for the plot layout; default NULL will automatically define the number of rows after number of columns specified.</p>
</td></tr>
<tr><td><code id="plot_beam_clin_+3A_title.size">title.size</code></td>
<td>
<p>A numeric. Specify the size of individual plot titles. Default is 10.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A figure (ggarrange object)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(beam_stats)
test.pvals &lt;- compute_set_pvalues(beam.stats=beam_stats)
test.feat.pvals &lt;- compute_feature_pvalues(beam.stats=beam_stats)
plot.specs &lt;- prep_beam_plot(beam.data=beam_stats$beam.data,
                             beam.specs=beam_stats$beam.specs)
test.plot &lt;- plot_beam_clin(beam.result=beam_stats, beam.specs=plot.specs,
                            beam.set.pvals=test.pvals,
                            beam.feat.pvals=test.feat.pvals,
                            set.id="ENSG00000099810", gene.name="MTAP",
                            pair.type=NULL, number.pairs=1, n.col=4,
                            n.row=NULL, title.size=11,
                            pair.order="omic", endpt.order=NULL)
</code></pre>

<hr>
<h2 id='plot_feat_clin'>Plot BEAM Feature</h2><span id='topic+plot_feat_clin'></span>

<h3>Description</h3>

<p>plot_feat_clin produces a matrix of feature level clinical plots for a specific feature.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_feat_clin(
  feat.id,
  beam.result,
  beam.specs = NULL,
  beam.set.pvals,
  beam.feat.pvals,
  n.row = NULL,
  n.col = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_feat_clin_+3A_feat.id">feat.id</code></td>
<td>
<p>A character specifying the name of a feature. Must be in beam.result$beam.data$set.data</p>
</td></tr>
<tr><td><code id="plot_feat_clin_+3A_beam.result">beam.result</code></td>
<td>
<p>A beam.stats object from compute_beam_stats</p>
</td></tr>
<tr><td><code id="plot_feat_clin_+3A_beam.specs">beam.specs</code></td>
<td>
<p>A data.frame. Default NULL, in which case beam.result$beam.specs is used. Otherwise can input other beam.specs  data.frame that must contain name, mtx, mdl, plot columns.</p>
</td></tr>
<tr><td><code id="plot_feat_clin_+3A_beam.set.pvals">beam.set.pvals</code></td>
<td>
<p>A list containing BEAMR set p-values from compute_set_pvalues.</p>
</td></tr>
<tr><td><code id="plot_feat_clin_+3A_beam.feat.pvals">beam.feat.pvals</code></td>
<td>
<p>A list containing feature-level p-values from compute_feature_pvalues.</p>
</td></tr>
<tr><td><code id="plot_feat_clin_+3A_n.row">n.row</code></td>
<td>
<p>A numeric. Specify the number of rows for the plot layout; default NULL will automatically define the number of rows after number of columns specified.</p>
</td></tr>
<tr><td><code id="plot_feat_clin_+3A_n.col">n.col</code></td>
<td>
<p>A numeric. Specify the number of columns for the plot layout; default NULL will use the number of omics types.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A figure (ggarrange object)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(beam_stats)
test.pvals &lt;- compute_set_pvalues(beam.stats=beam_stats)
test.feat.pvals &lt;- compute_feature_pvalues(beam.stats=beam_stats)
plot.specs &lt;- prep_beam_plot(beam.data=beam_stats$beam.data, beam.specs=beam_stats$beam.specs)
test.plot &lt;- plot_feat_clin(beam.result=beam_stats, beam.specs=plot.specs,
                            beam.set.pvals=test.pvals, beam.feat.pvals=test.feat.pvals,
                            feat.id="ENSG00000227443_loss",
                            n.col=2, n.row=NULL)
</code></pre>

<hr>
<h2 id='prep_beam_data'>Prepare data for BEAM analysis</h2><span id='topic+prep_beam_data'></span>

<h3>Description</h3>

<p>Prepare data for BEAM analysis
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prep_beam_data(
  main.data,
  mtx.data,
  mtx.anns = NULL,
  set.data = NULL,
  set.anns = NULL,
  n.boot = 1000,
  seed = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="prep_beam_data_+3A_main.data">main.data</code></td>
<td>
<p>A data.frame</p>
</td></tr>
<tr><td><code id="prep_beam_data_+3A_mtx.data">mtx.data</code></td>
<td>
<p>A list, each element is a matrix</p>
</td></tr>
<tr><td><code id="prep_beam_data_+3A_mtx.anns">mtx.anns</code></td>
<td>
<p>A list, each element is a data.frame</p>
</td></tr>
<tr><td><code id="prep_beam_data_+3A_set.data">set.data</code></td>
<td>
<p>A data.frame with columns set.id, mtx.id, row.id</p>
</td></tr>
<tr><td><code id="prep_beam_data_+3A_set.anns">set.anns</code></td>
<td>
<p>A data frame with set.id and other columns</p>
</td></tr>
<tr><td><code id="prep_beam_data_+3A_n.boot">n.boot</code></td>
<td>
<p>Number of bootstraps</p>
</td></tr>
<tr><td><code id="prep_beam_data_+3A_seed">seed</code></td>
<td>
<p>Initial seed for random number generation</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A beam.data object, which is a list with main.data, mtx.data, mtx.anns, anns.mtch, set.data, set.anns, and boot.index
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(clinf)
data(omicdat)
data(omicann)
data(setdat)
test.beam.data &lt;- prep_beam_data(main.data=clinf, mtx.data=omicdat,
                                 mtx.anns=omicann, set.data=setdat,
                                 set.anns=NULL, n.boot=10, seed=123)
</code></pre>

<hr>
<h2 id='prep_beam_plot'>Prepare for BEAM plotting</h2><span id='topic+prep_beam_plot'></span>

<h3>Description</h3>

<p>Add a &quot;plot&quot; column to beam.specs, which includes string of plot commands.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prep_beam_plot(beam.data, beam.specs)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="prep_beam_plot_+3A_beam.data">beam.data</code></td>
<td>
<p>Result of prep.beam.data</p>
</td></tr>
<tr><td><code id="prep_beam_plot_+3A_beam.specs">beam.specs</code></td>
<td>
<p>A data.frame of strings with columns name, mtx, mdl (string with R model with mtx.row)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An updated beam.specs object that includes the column &quot;plot&quot;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(clinf)
data(omicdat)
data(omicann)
data(setdat)
test.beam.data &lt;- prep_beam_data(main.data=clinf, mtx.data=omicdat,
                                 mtx.anns=omicann, set.data=setdat,
                                 set.anns=NULL, n.boot=10, seed=123)
specs &lt;- prep_beam_specs(beam.data=test.beam.data, endpts=c("MRD29", "EFS", "OS"),
                         firth=TRUE)
plot.specs &lt;- prep_beam_plot(beam.data=test.beam.data, beam.specs=specs)
</code></pre>

<hr>
<h2 id='prep_beam_specs'>Prepare beam.specs</h2><span id='topic+prep_beam_specs'></span>

<h3>Description</h3>

<p>Prepare the beam.specs data.frame for BEAM model fitting. Specifies the univariate models needed to compute the BEAMR set p-values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prep_beam_specs(
  beam.data,
  endpts,
  firth = TRUE,
  adjvars = NULL,
  endptmdl = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="prep_beam_specs_+3A_beam.data">beam.data</code></td>
<td>
<p>A beam.data object from prep_beam_data</p>
</td></tr>
<tr><td><code id="prep_beam_specs_+3A_endpts">endpts</code></td>
<td>
<p>A vector of endpoint variable names in main.data</p>
</td></tr>
<tr><td><code id="prep_beam_specs_+3A_firth">firth</code></td>
<td>
<p>A logical value. If TRUE (defaul) fit Firth penalized Cox model to account for monotone likelihood in the presence of rare events or predictors. If FALSE fit usual Cox model.</p>
</td></tr>
<tr><td><code id="prep_beam_specs_+3A_adjvars">adjvars</code></td>
<td>
<p>Default NULL, optional vector of adjustment variable names in main.data</p>
</td></tr>
<tr><td><code id="prep_beam_specs_+3A_endptmdl">endptmdl</code></td>
<td>
<p>Optional model specification data.frame with endpoint name column called &quot;endpt&quot; and model string column called &quot;mdl&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The beam.specs object, a data.frame specifying the omics-endpoint association models to be fit
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(clinf)
data(omicdat)
data(omicann)
data(setdat)
test.beam.data &lt;- prep_beam_data(main.data=clinf, mtx.data=omicdat,
                                 mtx.anns=omicann, set.data=setdat,
                                 set.anns=NULL, n.boot=10, seed=123)
#Without adjustment
prep_beam_specs(beam.data=test.beam.data, endpts=c("MRD29", "OS", "EFS"),
                firth=TRUE)
# With adjustment
prep_beam_specs(beam.data=test.beam.data, endpts=c("OS", "EFS"),
                adjvars=c("MRD29"), firth=TRUE)
</code></pre>

<hr>
<h2 id='print.beam.data'>Print summary information about a beam.data object</h2><span id='topic+print.beam.data'></span>

<h3>Description</h3>

<p>Print summary information about a beam.data object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'beam.data'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.beam.data_+3A_x">x</code></td>
<td>
<p>An object of class &quot;beam.data&quot;</p>
</td></tr>
<tr><td><code id="print.beam.data_+3A_...">...</code></td>
<td>
<p>Other arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Messages about the beam.data object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(beam_dat)
print(beam_dat)
</code></pre>

<hr>
<h2 id='print.beam.stats'>Print summary information about beam.stats object</h2><span id='topic+print.beam.stats'></span>

<h3>Description</h3>

<p>Print summary information about beam.stats object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'beam.stats'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.beam.stats_+3A_x">x</code></td>
<td>
<p>An object of class &quot;beam.stats&quot;</p>
</td></tr>
<tr><td><code id="print.beam.stats_+3A_...">...</code></td>
<td>
<p>Other arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Messages about the beam.data object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(beam_stats)
print(beam_stats)
</code></pre>

<hr>
<h2 id='setdat'>Map of Pediatric Data from COG trial AALL0434</h2><span id='topic+setdat'></span>

<h3>Description</h3>

<p>Map between annotation and omic data for a subset of clinical data from
pediatric and young adult t-lineage acute lymphoblastic leukmia patients
in the Children's Oncology Group trial AALL0434, published in Liu et al.,
2017 Nature Genetics
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setdat
</code></pre>


<h3>Format</h3>



<h4><code>setdat</code></h4>

<p>A data frame with 40 rows and 3 columns
</p>

<dl>
<dt>set.id</dt><dd><p>Ensembl ID that defines gene-feature set</p>
</dd>
<dt>mtx.id</dt><dd><p>Name of omic matrix where corresponding feature data can be found</p>
</dd>
<dt>row.id</dt><dd><p>Feature name in corresponding omic matrix</p>
</dd>
</dl>




<h3>Source</h3>

<p><a href="https://www.nature.com/articles/ng.3909">https://www.nature.com/articles/ng.3909</a>
</p>

<hr>
<h2 id='specs'>Pediatric T-ALL BEAMR Analysis Specs Data from COG trial AALL0434</h2><span id='topic+specs'></span>

<h3>Description</h3>

<p>The beam.specs object used in example beam analyses
</p>


<h3>Usage</h3>

<pre><code class='language-R'>specs
</code></pre>


<h3>Format</h3>



<h4><code>specs</code></h4>

<p>A data frame with 6 rows and 3 columns:
</p>

<dl>
<dt>name</dt><dd><p>Analysis name with omic and endpoint</p>
</dd>
<dt>mtx</dt><dd><p>Name of omics matrix used in the analysis</p>
</dd>
<dt>mdl</dt><dd><p>Regression model</p>
</dd>
</dl>




<h3>Source</h3>

<p>NA
</p>

<hr>
<h2 id='subset_beam_result'>Subset beam.stats Result</h2><span id='topic+subset_beam_result'></span>

<h3>Description</h3>

<p>Filter the beam.stats object from compute_beam_stats with various filtering criteria. Default is to filter to top 50 sets with smallest q-value. At least one filtering criteria must be specified. Can also use intersection or union of multiple criteria.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>subset_beam_result(
  beam.result,
  beam.set.pvals = NULL,
  beam.feat.pvals = NULL,
  mtx.rows = NULL,
  set.ids = NULL,
  endpts = NULL,
  omics = NULL,
  p.limit = NULL,
  q.limit = NULL,
  p.feat.limit = NULL,
  q.feat.limit = NULL,
  intersect = TRUE,
  recalc = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="subset_beam_result_+3A_beam.result">beam.result</code></td>
<td>
<p>A beam.stats object from compute_beam_stats</p>
</td></tr>
<tr><td><code id="subset_beam_result_+3A_beam.set.pvals">beam.set.pvals</code></td>
<td>
<p>A list containing BEAMR set p-values from compute_set_pvalues; required if p.limit or q.limit are specified.</p>
</td></tr>
<tr><td><code id="subset_beam_result_+3A_beam.feat.pvals">beam.feat.pvals</code></td>
<td>
<p>A list containing feature-level p-values from compute_feature_pvalues; required if p.feat.limit or q.feat.limit are specified.</p>
</td></tr>
<tr><td><code id="subset_beam_result_+3A_mtx.rows">mtx.rows</code></td>
<td>
<p>A list of vectors of feature names corresponding to row.id in set.data. List names correspond to mtx.id in set.data. If specified, filter to all sets containing at least one of these features.</p>
</td></tr>
<tr><td><code id="subset_beam_result_+3A_set.ids">set.ids</code></td>
<td>
<p>A character vector of set.ids. If specified, filter to these sets.</p>
</td></tr>
<tr><td><code id="subset_beam_result_+3A_endpts">endpts</code></td>
<td>
<p>A character vector of endpoint names. If specified, filter to sets that correspond to these endpoints.</p>
</td></tr>
<tr><td><code id="subset_beam_result_+3A_omics">omics</code></td>
<td>
<p>A character vector of omics names. If specified, fitler to sets that correspond to these omics.</p>
</td></tr>
<tr><td><code id="subset_beam_result_+3A_p.limit">p.limit</code></td>
<td>
<p>A numeric value. If specified, determine mtx.rows that are below this threshold if p&lt;1 or top p sets if p&gt;1.</p>
</td></tr>
<tr><td><code id="subset_beam_result_+3A_q.limit">q.limit</code></td>
<td>
<p>A numeric value. If specified, determine mtx.rows that are below this threshold if q &lt;1 or top q sets if q&gt;1.</p>
</td></tr>
<tr><td><code id="subset_beam_result_+3A_p.feat.limit">p.feat.limit</code></td>
<td>
<p>A numeric value. If specified, determine mtx.rows that are below this threshold if p.feat&lt;1 or top p.feat sets if p.feat&gt;1 (feature p-values).</p>
</td></tr>
<tr><td><code id="subset_beam_result_+3A_q.feat.limit">q.feat.limit</code></td>
<td>
<p>A numeric value. If specified, determine mtx.rows that are below this threshold if q.feat&lt;1 or top q.feat sets if q.feat&gt;1.</p>
</td></tr>
<tr><td><code id="subset_beam_result_+3A_intersect">intersect</code></td>
<td>
<p>A logical value. Default is TRUE. If TRUE, use intersection of all specified criteria. If FALSE use union of all specified criteria.</p>
</td></tr>
<tr><td><code id="subset_beam_result_+3A_recalc">recalc</code></td>
<td>
<p>A logical value. Default is FALSE. If TRUE, recalculate p-values. If FALSE use original set p-values..</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with filtered beam.stats object, updated beam.set.pvals, and filtered beam.feat.pvals.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(beam_stats)
test.pvals &lt;- compute_set_pvalues(beam.stats=beam_stats)
test.feat.pvals &lt;- compute_feature_pvalues(beam.stats=beam_stats)
filt.beam.stats &lt;- subset_beam_result(beam_stats, test.pvals, test.feat.pvals,
                                      endpts=c("EFS","OS"), q.limit=10, intersect=TRUE,
                                      recalc=FALSE)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
