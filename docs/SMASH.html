<!DOCTYPE html><html lang="en"><head><title>Help for package SMASH</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {SMASH}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#eS'><p>A collection of pre-defined subclone configurations.</p></a></li>
<li><a href='#gen_ITH_RD'><p>gen_ITH_RD</p></a></li>
<li><a href='#gen_subj_truth'><p>gen_subj_truth</p></a></li>
<li><a href='#grid_ITH_optim'><p>grid_ITH_optim</p></a></li>
<li><a href='#ITH_optim'><p>ITH_optim</p></a></li>
<li><a href='#vis_GRID'><p>vis_GRID</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Subclone Multiplicity Allocation and Somatic Heterogeneity</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2025-02-07</td>
</tr>
<tr>
<td>Description:</td>
<td>Cluster user-supplied somatic read counts with corresponding allele-specific copy number and tumor purity to infer feasible underlying intra-tumor heterogeneity in terms of  number of subclones, multiplicity, and allocation (Little et al. (2019) &lt;<a href="https://doi.org/10.1186%2Fs13073-019-0643-9">doi:10.1186/s13073-019-0643-9</a>&gt;).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp, stats, smarter, reshape2, ggplot2</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, devtools</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-02-26 05:10:10 UTC; Admin</td>
</tr>
<tr>
<td>Author:</td>
<td>Paul Little [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Paul Little &lt;pllittle321@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-02-27 16:40:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='eS'>A collection of pre-defined subclone configurations.</h2><span id='topic+eS'></span>

<h3>Description</h3>

<p>A R list containing subclone configurations in matrix 
form for 1 to 5 subclones. For each matrix, each column 
corresponds to a subclone and each row corresponds to a 
variant's allocation across all subclones. For example, 
the first row of each matrix is a vector of 1's to 
represent clonal variants, variants present in all subclones.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eS
</code></pre>


<h3>Format</h3>

<p>An object of class <code>list</code> of length 5.
</p>

<hr>
<h2 id='gen_ITH_RD'>gen_ITH_RD</h2><span id='topic+gen_ITH_RD'></span>

<h3>Description</h3>

<p>Simulates observed alternate and reference read counts
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gen_ITH_RD(DATA, RD)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gen_ITH_RD_+3A_data">DATA</code></td>
<td>
<p>The output data.frame from <code>gen_subj_truth</code></p>
</td></tr>
<tr><td><code id="gen_ITH_RD_+3A_rd">RD</code></td>
<td>
<p>A positive integer for the mean read depth generated from 
the negative binomial distribution</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of simulated alternate and reference read counts.
</p>

<hr>
<h2 id='gen_subj_truth'>gen_subj_truth</h2><span id='topic+gen_subj_truth'></span>

<h3>Description</h3>

<p>Simulates copy number states, multiplicities, allocations
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gen_subj_truth(mat_eS, maxLOCI, nCN = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gen_subj_truth_+3A_mat_es">mat_eS</code></td>
<td>
<p>A subclone configuration matrix pre-defined in R list <code>eS</code></p>
</td></tr>
<tr><td><code id="gen_subj_truth_+3A_maxloci">maxLOCI</code></td>
<td>
<p>A positive integer number of simulated somatic variant calls</p>
</td></tr>
<tr><td><code id="gen_subj_truth_+3A_ncn">nCN</code></td>
<td>
<p>A positive integer for the number of allelic copy number pairings 
to sample from. If <code>NULL</code>, it will be randomly sampled between 1 and 5.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the following components:
</p>

<dl>
<dt><code>subj_truth</code></dt><dd><p>dataframe of each variant's simulated minor 
(<code>CN_1</code>) and major (<code>CN_2</code>) copy number states, total copy 
number (<code>tCN</code>), subclone allocation (<code>true_A</code>), multiplicity 
(<code>true_M</code>), mutant allele frequency (<code>true_MAF</code>), and cellular 
prevalence (<code>true_CP</code>)</p>
</dd>
<dt><code>purity</code></dt><dd><p>tumor purity</p>
</dd>
<dt><code>eta</code></dt><dd><p>the product of tumor purity and subclone proportions</p>
</dd>
<dt><code>q</code></dt><dd><p>vector of subclone proportions</p>
</dd>
</dl>


<hr>
<h2 id='grid_ITH_optim'>grid_ITH_optim</h2><span id='topic+grid_ITH_optim'></span>

<h3>Description</h3>

<p>This function performs a grid search over enumerated 
configurations within the pre-defined list <code>eS</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>grid_ITH_optim(
  my_data,
  my_purity,
  list_eS,
  pi_eps0 = NULL,
  trials = 20,
  max_iter = 4000,
  my_epsilon = 1e-06
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="grid_ITH_optim_+3A_my_data">my_data</code></td>
<td>
<p>A R dataframe containing the following columns:
</p>

<dl>
<dt><code>tAD</code></dt><dd><p>tumor alternate read counts</p>
</dd>
<dt><code>tRD</code></dt><dd><p>tumor reference read counts</p>
</dd>
<dt><code>CN_1</code></dt><dd><p>minor allele count</p>
</dd>
<dt><code>CN_2</code></dt><dd><p>major allele count, where <code>CN_1 &lt;= CN_2</code></p>
</dd>
<dt><code>tCN</code></dt><dd><p><code>CN_1 + CN_2</code></p>
</dd>
</dl>
</td></tr>
<tr><td><code id="grid_ITH_optim_+3A_my_purity">my_purity</code></td>
<td>
<p>A single numeric value of known/estimated purity</p>
</td></tr>
<tr><td><code id="grid_ITH_optim_+3A_list_es">list_eS</code></td>
<td>
<p>A nested list of subclone configuration matrices</p>
</td></tr>
<tr><td><code id="grid_ITH_optim_+3A_pi_eps0">pi_eps0</code></td>
<td>
<p>A user-specified parameter denoting the proportion 
of loci not explained by the combinations of purity, copy number, 
multiplicity, and allocation. If <code>NULL</code>, it is initialized at 
1e-3. If set to 0.0, the parameter is not estimated.</p>
</td></tr>
<tr><td><code id="grid_ITH_optim_+3A_trials">trials</code></td>
<td>
<p>Positive integer, number of random initializations 
of subclone proportions</p>
</td></tr>
<tr><td><code id="grid_ITH_optim_+3A_max_iter">max_iter</code></td>
<td>
<p>Positive integer, preferably 1000 or more, setting 
the maximum number of iterations</p>
</td></tr>
<tr><td><code id="grid_ITH_optim_+3A_my_epsilon">my_epsilon</code></td>
<td>
<p>Convergence criterion threshold for changes in 
the log likelihood, preferably 1e-6 or smaller</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A R list containing two objects. <code>GRID</code> is a 
dataframe where each row denotes a feasible subclone configuration 
with corresponding subclone proportion estimates <code>q</code> and 
somatic variant allocations <code>alloc</code>. <code>INFER</code> is a list 
where <code>INFER[[i]]</code> corresponds to the <code>i</code>-th row or 
model of <code>GRID</code>.
</p>

<hr>
<h2 id='ITH_optim'>ITH_optim</h2><span id='topic+ITH_optim'></span>

<h3>Description</h3>

<p>Performs EM algorithm for a given configuration matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ITH_optim(
  my_data,
  my_purity,
  init_eS,
  pi_eps0 = NULL,
  my_unc_q = NULL,
  max_iter = 4000,
  my_epsilon = 1e-06
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ITH_optim_+3A_my_data">my_data</code></td>
<td>
<p>A R dataframe containing the following columns:
</p>

<dl>
<dt><code>tAD</code></dt><dd><p>tumor alternate read counts</p>
</dd>
<dt><code>tRD</code></dt><dd><p>tumor reference read counts</p>
</dd>
<dt><code>CN_1</code></dt><dd><p>minor allele count</p>
</dd>
<dt><code>CN_2</code></dt><dd><p>major allele count, where <code>CN_1 &lt;= CN_2</code></p>
</dd>
<dt><code>tCN</code></dt><dd><p><code>CN_1 + CN_2</code></p>
</dd>
</dl>
</td></tr>
<tr><td><code id="ITH_optim_+3A_my_purity">my_purity</code></td>
<td>
<p>A single numeric value of known/estimated purity</p>
</td></tr>
<tr><td><code id="ITH_optim_+3A_init_es">init_eS</code></td>
<td>
<p>A subclone configuration matrix pre-defined in R 
list <code>eS</code></p>
</td></tr>
<tr><td><code id="ITH_optim_+3A_pi_eps0">pi_eps0</code></td>
<td>
<p>A user-specified parameter denoting the proportion 
of loci not explained by the combinations of purity, copy number, 
multiplicity, and allocation. If <code>NULL</code>, it is initialized at 
1e-3. If set to 0.0, the parameter is not estimated.</p>
</td></tr>
<tr><td><code id="ITH_optim_+3A_my_unc_q">my_unc_q</code></td>
<td>
<p>An optimal initial vector for the unconstrained 
<code>q</code> vector, useful after running <code>grid_ITH_optim</code>. If 
this variable is <code>NULL</code>, then the subclone proportions, 
<code>q</code>, are randomly initialized. For instance, if 
<code>my_unc_q = ( x1 , x2 )</code>, then <code>q = ( exp(x1) / (1 + exp(x1) + exp(x2)) , exp(x2) / (1 + exp(x1) + exp(x2)) , 1 / (1 + exp(x1) + exp(x2))</code>.</p>
</td></tr>
<tr><td><code id="ITH_optim_+3A_max_iter">max_iter</code></td>
<td>
<p>Positive integer, preferably 1000 or more, setting 
the maximum number of iterations</p>
</td></tr>
<tr><td><code id="ITH_optim_+3A_my_epsilon">my_epsilon</code></td>
<td>
<p>Convergence criterion threshold for changes in 
the log likelihood, preferably 1e-6 or smaller</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If the EM algorithm converges, the output will be a list containing
</p>

<dl>
<dt><code>iter</code></dt><dd><p>number of iterations</p>
</dd>
<dt><code>converge</code></dt><dd><p>convergence status</p>
</dd>
<dt><code>unc_q0</code></dt><dd><p>initial unconstrained subclone proportions parameter</p>
</dd>
<dt><code>unc_q</code></dt><dd><p>unconstrained estimate of <code>q</code></p>
</dd>
<dt><code>q</code></dt><dd><p>estimated subclone proportions among cancer cells</p>
</dd>
<dt><code>CN_MA_pi</code></dt><dd><p>estimated mixture probabilities of multiplicities 
and allocations given copy number states</p>
</dd>
<dt><code>eta</code></dt><dd><p>estimated subclone proportion among tumor cells</p>
</dd>
<dt><code>purity</code></dt><dd><p>user-inputted tumor purity</p>
</dd>
<dt><code>entropy</code></dt><dd><p>estimated entropy</p>
</dd>
<dt><code>infer</code></dt><dd><p>A R dataframe containing inferred variant allocations 
(<code>infer_A</code>), multiplicities (<code>infer_M</code>), cellular prevalences 
(<code>infer_CP</code>).</p>
</dd>
<dt><code>ms</code></dt><dd><p>model size, number of parameters within parameter space</p>
</dd>
<dt><code>LL</code></dt><dd><p>The observed log likelihood evaluated at maximum likelihood 
estimates.</p>
</dd>
<dt><code>AIC = 2 * LL - 2 * ms</code></dt><dd><p>Negative AIC, used for model selection</p>
</dd>
<dt><code>BIC = 2 * LL - ms * log(LOCI)</code></dt><dd><p>Negative BIC, used for model selection</p>
</dd>
<dt><code>LOCI</code></dt><dd><p>The number of inputted somatic variants.</p>
</dd>
</dl>


<hr>
<h2 id='vis_GRID'>vis_GRID</h2><span id='topic+vis_GRID'></span>

<h3>Description</h3>

<p>A simple visualization of SMASH's grid of solutions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vis_GRID(GRID)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="vis_GRID_+3A_grid">GRID</code></td>
<td>
<p>The <code>GRID</code> object output from <code>grid_ITH_optim</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot object for data visualization
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
