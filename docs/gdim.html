<!DOCTYPE html><html><head><title>Help for package gdim</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {gdim}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#%&gt;%'><p>Pipe operator</p></a></li>
<li><a href='#eigcv'><p>Compute cross-validate eigenvalues</p></a></li>
<li><a href='#gdim-package'><p>gdim: Estimate Graph Dimension using Cross-Validated Eigenvalues</p></a></li>
<li><a href='#plot.eigcv'><p>Plot cross-validated eigenvalues</p></a></li>
<li><a href='#print.eigcv'><p>Print cross-validated eigenvalues</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Estimate Graph Dimension using Cross-Validated Eigenvalues</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Cross-validated eigenvalues are estimated by
    splitting a graph into two parts, the training and the test graph.
    The training graph is used to estimate eigenvectors, and
    the test graph is used to evaluate the correlation between the training
    eigenvectors and the eigenvectors of the test graph.
    The correlations follow a simple central limit theorem that can
    be used to estimate graph dimension via hypothesis testing, see
    Chen et al. (2021) &lt;<a href="https://arxiv.org/abs/2108.03336">arXiv:2108.03336</a>&gt; for details.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/RoheLab/gdim">https://github.com/RoheLab/gdim</a>, <a href="https://rohelab.github.io/gdim/">https://rohelab.github.io/gdim/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/RoheLab/gdim/issues">https://github.com/RoheLab/gdim/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>Matrix, R (&ge; 3.5)</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr, ggplot2, irlba, magrittr, methods, progress, rlang,
stats, tibble</td>
</tr>
<tr>
<td>Suggests:</td>
<td>epca, fastRG, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-09-05 15:04:42 UTC; alex</td>
</tr>
<tr>
<td>Author:</td>
<td>Fan Chen <a href="https://orcid.org/0000-0003-4508-6023"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Alex Hayes <a href="https://orcid.org/0000-0002-4985-5160"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [cre,
    aut, cph],
  Karl Rohe [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Alex Hayes &lt;alexpghayes@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-09-05 20:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='+25+26gt+3B+25'>Pipe operator</h2><span id='topic++25+3E+25'></span>

<h3>Description</h3>

<p>See <code>magrittr::<a href="magrittr.html#topic+pipe">%&gt;%</a></code> for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lhs %&gt;% rhs
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_lhs">lhs</code></td>
<td>
<p>A value or the magrittr placeholder.</p>
</td></tr>
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_rhs">rhs</code></td>
<td>
<p>A function call using the magrittr semantics.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The result of calling <code>rhs(lhs)</code>.
</p>

<hr>
<h2 id='eigcv'>Compute cross-validate eigenvalues</h2><span id='topic+eigcv'></span>

<h3>Description</h3>

<p>Estimate graph dimension via eigenvalue cross-validation (EigCV).
A graph has dimension <code>k</code> if the first <code>k</code> eigenvectors of its adjacency
matrix are correlated with its population eigenspace, and the others are not.
Edge bootstrapping sub-samples the edges of the graph (without replacement).
Edge splitting separates the edges into a training part and a testing part.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eigcv(
  A,
  k_max,
  ...,
  num_bootstraps = 10,
  test_portion = 0.1,
  alpha = 0.05,
  method = c("none", "holm", "hochberg", "hommel", "bonferroni", "BH", "BY", "fdr"),
  laplacian = FALSE,
  regularize = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="eigcv_+3A_a">A</code></td>
<td>
<p>The adjacency matrix of graph. Must be non-negative and
integer valued.</p>
</td></tr>
<tr><td><code id="eigcv_+3A_k_max">k_max</code></td>
<td>
<p>The maximum dimension of the graph to consider. This many
eigenvectors are computed. Should be a non-negative integer smallish
relative the dimensions of <code>A</code>.</p>
</td></tr>
<tr><td><code id="eigcv_+3A_...">...</code></td>
<td>
<p>Ignored.</p>
</td></tr>
<tr><td><code id="eigcv_+3A_num_bootstraps">num_bootstraps</code></td>
<td>
<p>The number of times to bootstrap the graph. Since
cross-validated eigenvalues are based on a random graph split, they
are themselves random. By repeatedly computing cross-validated eigenvalues
for different sample splits, the idea is to smooth away some of the
randomness due to the graph splits. A small number of bootstraps
(3 to 10) usually suffices. Defaults to <code>10</code>. Test statistics (i.e.
z-scores for cv eigenvalues) are averaged across bootstraps
and the p-values will be calculated based on the averaged statistics.</p>
</td></tr>
<tr><td><code id="eigcv_+3A_test_portion">test_portion</code></td>
<td>
<p>The portion of the graph to put into the test graph,
as opposed to the training graph. Defaults to <code>0.1</code>. Must be strictly
between zero and one.</p>
</td></tr>
<tr><td><code id="eigcv_+3A_alpha">alpha</code></td>
<td>
<p>Significance level for hypothesis tests. Each dimension
<code style="white-space: pre;">&#8288;1, ..., k_max&#8288;</code> is tested when estimating graph dimension, and the
overall graph dimension is taken to be the smallest number of dimensions
such that all the tests reject.</p>
</td></tr>
<tr><td><code id="eigcv_+3A_method">method</code></td>
<td>
<p>Method to adjust p-values for multiple testing. Must be
one of <code>"none"</code>, <code>"holm"</code>, <code>"hochberg"</code>, <code>"hommel"</code>, <code>"bonferroni"</code>,
<code>"BH"</code>, <code>"BY"</code>, or <code>"fdr"</code>. Passed to <code><a href="stats.html#topic+p.adjust">stats::p.adjust()</a></code>. Defaults to
<code>"none"</code>.</p>
</td></tr>
<tr><td><code id="eigcv_+3A_laplacian">laplacian</code></td>
<td>
<p>Logical value indicating where to compute cross-validated
eigenvalues for the degree-normalize graph Laplacian rather than the
graph adjacency matrix. Experimental and should be used with caution.
Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="eigcv_+3A_regularize">regularize</code></td>
<td>
<p>Only applicable when <code>laplacian == TRUE</code>, in which case
this parameter controls whether or not the degree-normalized graph
Laplacian is regularized. Defaults to <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>eigcv</code> object, which is a list with the following named
elements.
</p>

<ul>
<li> <p><code>estimated_dimension</code>: inferred graph dimension.
</p>
</li>
<li> <p><code>summary</code>: summary table of the tests.
</p>
</li>
<li> <p><code>num_bootstraps</code>: number of bootstraps performed.
</p>
</li>
<li> <p><code>test_portion</code>: graph splitting probability used.
</p>
</li>
<li> <p><code>alpha</code>: significance level of each test.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
library(fastRG)

set.seed(27)

B &lt;- matrix(0.1, 5, 5)
diag(B) &lt;- 0.3

model &lt;- sbm(
  n = 1000,
  k = 5,
  B = B,
  expected_degree = 40,
  poisson_edges = FALSE,
  allow_self_loops = FALSE
)

A &lt;- sample_sparse(model)

eigs&lt;- eigcv(A, k_max = 10)
eigs

plot(eigs, type = "z-score")    # default
plot(eigs, type = "adjacency")
plot(eigs, type = "laplacian")


</code></pre>

<hr>
<h2 id='gdim-package'>gdim: Estimate Graph Dimension using Cross-Validated Eigenvalues</h2><span id='topic+gdim'></span><span id='topic+gdim-package'></span>

<h3>Description</h3>

<p>Cross-validated eigenvalues are estimated by splitting a graph into two parts, the training and the test graph. The training graph is used to estimate eigenvectors, and the test graph is used to evaluate the correlation between the training eigenvectors and the eigenvectors of the test graph. The correlations follow a simple central limit theorem that can be used to estimate graph dimension via hypothesis testing, see Chen et al. (2021) <a href="https://arxiv.org/abs/2108.03336">arXiv:2108.03336</a> for details.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Alex Hayes <a href="mailto:alexpghayes@gmail.com">alexpghayes@gmail.com</a> (<a href="https://orcid.org/0000-0002-4985-5160">ORCID</a>) [copyright holder]
</p>
<p>Authors:
</p>

<ul>
<li><p> Fan Chen <a href="mailto:fchen365@gmail.com">fchen365@gmail.com</a> (<a href="https://orcid.org/0000-0003-4508-6023">ORCID</a>)
</p>
</li>
<li><p> Karl Rohe <a href="mailto:karlrohe@wisc.edu">karlrohe@wisc.edu</a>
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/RoheLab/gdim">https://github.com/RoheLab/gdim</a>
</p>
</li>
<li> <p><a href="https://rohelab.github.io/gdim/">https://rohelab.github.io/gdim/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/RoheLab/gdim/issues">https://github.com/RoheLab/gdim/issues</a>
</p>
</li></ul>


<hr>
<h2 id='plot.eigcv'>Plot cross-validated eigenvalues</h2><span id='topic+plot.eigcv'></span>

<h3>Description</h3>

<p>Plot cross-validated eigenvalues
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'eigcv'
plot(x, type = c("z-score", "adjacency", "laplacian"), threshold = 2, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.eigcv_+3A_x">x</code></td>
<td>
<p>An <code>eigcv</code> object created by a call to <code><a href="#topic+eigcv">eigcv()</a></code>.</p>
</td></tr>
<tr><td><code id="plot.eigcv_+3A_type">type</code></td>
<td>
<p>Specifies what to plot. Must be one of the following options:
</p>

<ul>
<li> <p><code>"z-score"</code>, in which case the Z-statistic test scores are plotted
for each value of <code>k</code> (i.e. dimension of the eigenspace).
</p>
</li>
<li> <p><code>"adjacency"</code> in which case the cross-validated eigenvalues of the
adjacency matrix are plotted for each value of <code>k</code>.
</p>
</li>
<li> <p><code>"laplacian"</code> in which case the cross-validated eigenvalues of the
graph Laplacian matrix are plotted for each value of <code>k</code>.
</p>
</li></ul>
</td></tr>
<tr><td><code id="plot.eigcv_+3A_threshold">threshold</code></td>
<td>
<p>Only used when <code>type == "z-score"</code>. Adds a horizontal
line at the value of <code>threshold</code>, which should be a numeric of length
one. Defaults to <code>2</code>.</p>
</td></tr>
<tr><td><code id="plot.eigcv_+3A_...">...</code></td>
<td>
<p>Ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>ggplot2</code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(fastRG)

set.seed(27)

B &lt;- matrix(0.1, 5, 5)
diag(B) &lt;- 0.3

model &lt;- sbm(
  n = 1000,
  k = 5,
  B = B,
  expected_degree = 40,
  poisson_edges = FALSE,
  allow_self_loops = FALSE
)

A &lt;- sample_sparse(model)

eigs&lt;- eigcv(A, k_max = 10)
eigs

plot(eigs, type = "z-score")    # default
plot(eigs, type = "adjacency")
plot(eigs, type = "laplacian")


</code></pre>

<hr>
<h2 id='print.eigcv'>Print cross-validated eigenvalues</h2><span id='topic+print.eigcv'></span>

<h3>Description</h3>

<p>Print cross-validated eigenvalues
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'eigcv'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.eigcv_+3A_x">x</code></td>
<td>
<p>An <code>eigcv</code> object created by a call to <code><a href="#topic+eigcv">eigcv()</a></code>.</p>
</td></tr>
<tr><td><code id="print.eigcv_+3A_...">...</code></td>
<td>
<p>Ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>x</code>, but invisibly.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(fastRG)

set.seed(27)

B &lt;- matrix(0.1, 5, 5)
diag(B) &lt;- 0.3

model &lt;- sbm(
  n = 1000,
  k = 5,
  B = B,
  expected_degree = 40,
  poisson_edges = FALSE,
  allow_self_loops = FALSE
)

A &lt;- sample_sparse(model)

eigs&lt;- eigcv(A, k_max = 10)
eigs

plot(eigs, type = "z-score")    # default
plot(eigs, type = "adjacency")
plot(eigs, type = "laplacian")


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
