<!DOCTYPE html><html lang="en"><head><title>Help for package chemCal</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {chemCal}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#calplot'><p>Plot calibration graphs from univariate linear models</p></a></li>
<li><a href='#din32645'><p>Calibration data from DIN 32645</p></a></li>
<li><a href='#inverse.predict'><p>Predict x from y for a linear calibration</p></a></li>
<li><a href='#lod'><p>Estimate a limit of detection (LOD)</p></a></li>
<li><a href='#loq'><p>Estimate a limit of quantification (LOQ)</p></a></li>
<li><a href='#massart97ex1'><p>Calibration data from Massart et al. (1997), example 1</p></a></li>
<li><a href='#massart97ex3'><p>Calibration data from Massart et al. (1997), example 3</p></a></li>
<li><a href='#rl95_cadmium'><p>Cadmium concentrations measured by AAS as reported by Rocke and Lorenzato</p>
(1995)</a></li>
<li><a href='#rl95_toluene'><p>Toluene amounts measured by GC/MS as reported by Rocke and Lorenzato (1995)</p></a></li>
<li><a href='#utstats14'><p>Example data for calibration with replicates from University of Toronto</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Version:</td>
<td>0.2.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-03-31</td>
</tr>
<tr>
<td>Title:</td>
<td>Calibration Functions for Analytical Chemistry</td>
</tr>
<tr>
<td>Suggests:</td>
<td>MASS, knitr, testthat, investr, covr, rmarkdown</td>
</tr>
<tr>
<td>Description:</td>
<td>Simple functions for plotting linear
	calibration functions and estimating standard errors for measurements
	according to the Handbook of Chemometrics and Qualimetrics: Part A
	by Massart et al. (1997) There are also functions estimating the limit
	of detection (LOD) and limit of quantification (LOQ).
	The functions work on model objects from - optionally weighted - linear
	regression (lm) or robust linear regression ('rlm' from the 'MASS' package).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/jranke/chemCal/issues">https://github.com/jranke/chemCal/issues</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://pkgdown.jrwb.de/chemCal/">https://pkgdown.jrwb.de/chemCal/</a>,
<a href="https://cgit.jrwb.de/chemCal/about">https://cgit.jrwb.de/chemCal/about</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-03-31 18:01:51 UTC; jranke</td>
</tr>
<tr>
<td>Author:</td>
<td>Johannes Ranke <a href="https://orcid.org/0000-0003-4371-6538"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre, cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Johannes Ranke &lt;johannes.ranke@jrwb.de&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-04-01 12:10:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='calplot'>Plot calibration graphs from univariate linear models</h2><span id='topic+calplot'></span><span id='topic+calplot.default'></span><span id='topic+calplot.lm'></span>

<h3>Description</h3>

<p>Produce graphics of calibration data, the fitted model as well as
confidence, and, for unweighted regression, prediction bands.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calplot(
  object,
  xlim = c("auto", "auto"),
  ylim = c("auto", "auto"),
  xlab = "Concentration",
  ylab = "Response",
  legend_x = "auto",
  alpha = 0.05,
  varfunc = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calplot_+3A_object">object</code></td>
<td>
<p>A univariate model object of class <code><a href="stats.html#topic+lm">lm</a></code> or
<code><a href="MASS.html#topic+rlm">rlm</a></code> with model formula <code>y ~ x</code> or <code>y ~ x -
1</code>.</p>
</td></tr>
<tr><td><code id="calplot_+3A_xlim">xlim</code></td>
<td>
<p>The limits of the plot on the x axis.</p>
</td></tr>
<tr><td><code id="calplot_+3A_ylim">ylim</code></td>
<td>
<p>The limits of the plot on the y axis.</p>
</td></tr>
<tr><td><code id="calplot_+3A_xlab">xlab</code></td>
<td>
<p>The label of the x axis.</p>
</td></tr>
<tr><td><code id="calplot_+3A_ylab">ylab</code></td>
<td>
<p>The label of the y axis.</p>
</td></tr>
<tr><td><code id="calplot_+3A_legend_x">legend_x</code></td>
<td>
<p>An optional numeric value for adjusting the x coordinate of
the legend.</p>
</td></tr>
<tr><td><code id="calplot_+3A_alpha">alpha</code></td>
<td>
<p>The error tolerance level for the confidence and prediction
bands. Note that this includes both tails of the Gaussian distribution,
unlike the alpha and beta parameters used in <code><a href="#topic+lod">lod</a></code> (see note
below).</p>
</td></tr>
<tr><td><code id="calplot_+3A_varfunc">varfunc</code></td>
<td>
<p>The variance function for generating the weights in the
model.  Currently, this argument is ignored (see note below).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot of the calibration data, of your fitted model as well as
lines showing the confidence limits. Prediction limits are only shown for
models from unweighted regression.
</p>


<h3>Note</h3>

<p>Prediction bands for models from weighted linear regression require
weights for the data, for which responses should be predicted. Prediction
intervals using weights e.g. from a variance function are currently not
supported by the internally used function <code><a href="stats.html#topic+predict.lm">predict.lm</a></code>,
therefore, <code>calplot</code> does not draw prediction bands for such models.
</p>
<p>It is possible to compare the <code><a href="#topic+calplot">calplot</a></code> prediction bands with
the <code><a href="#topic+lod">lod</a></code> values if the <code>lod()</code> alpha and beta parameters
are half the value of the <code>calplot()</code> alpha parameter.
</p>


<h3>Author(s)</h3>

<p>Johannes Ranke
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(massart97ex3)
m &lt;- lm(y ~ x, data = massart97ex3)
calplot(m)

</code></pre>

<hr>
<h2 id='din32645'>Calibration data from DIN 32645</h2><span id='topic+din32645'></span>

<h3>Description</h3>

<p>Sample dataset to test the package.
</p>


<h3>Format</h3>

<p>A dataframe containing 10 rows of x and y values.
</p>


<h3>References</h3>

<p>DIN 32645 (equivalent to ISO 11843), Beuth Verlag, Berlin, 1994
</p>
<p>Dintest. Plugin for MS Excel for evaluations of calibration data. Written by
Georg Schmitt, University of Heidelberg. Formerly available from the Website
of the University of Heidelberg.
</p>
<p>Currie, L. A. (1997) Nomenclature in evaluation of analytical methods
including detection and quantification capabilities (IUPAC Recommendations
1995).  Analytica Chimica Acta 391, 105 - 126.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
m &lt;- lm(y ~ x, data = din32645)
calplot(m)

## Prediction of x with confidence interval
prediction &lt;- inverse.predict(m, 3500, alpha = 0.01)

# This should give 0.07434 according to test data from Dintest, which 
# was collected from Procontrol 3.1 (isomehr GmbH) in this case
round(prediction$Confidence, 5)

## Critical value:
crit &lt;- lod(m, alpha = 0.01, beta = 0.5)

# According to DIN 32645, we should get 0.07 for the critical value
# (decision limit, "Nachweisgrenze")
round(crit$x, 2)
# and according to Dintest test data, we should get 0.0698 from
round(crit$x, 4)

## Limit of detection (smallest detectable value given alpha and beta)
# In German, the smallest detectable value is the "Erfassungsgrenze", and we
# should get 0.14 according to DIN, which we achieve by using the method 
# described in it:
lod.din &lt;- lod(m, alpha = 0.01, beta = 0.01, method = "din")
round(lod.din$x, 2)

## Limit of quantification
# This accords to the test data coming with the test data from Dintest again, 
# except for the last digits of the value cited for Procontrol 3.1 (0.2121)
loq &lt;- loq(m, alpha = 0.01)
round(loq$x, 4)

# A similar value is obtained using the approximation 
# LQ = 3.04 * LC (Currie 1999, p. 120)
3.04 * lod(m, alpha = 0.01, beta = 0.5)$x

</code></pre>

<hr>
<h2 id='inverse.predict'>Predict x from y for a linear calibration</h2><span id='topic+inverse.predict'></span><span id='topic+inverse.predict.lm'></span><span id='topic+inverse.predict.rlm'></span><span id='topic+inverse.predict.default'></span>

<h3>Description</h3>

<p>This function predicts x values using a univariate linear model that has
been generated for the purpose of calibrating a measurement method.
Prediction intervals are given at the specified confidence level.  The
calculation method was taken from Massart et al. (1997). In particular,
Equations 8.26 and 8.28 were combined in order to yield a general treatment
of inverse prediction for univariate linear models, taking into account
weights that have been used to create the linear model, and at the same time
providing the possibility to specify a precision in sample measurements
differing from the precision in standard samples used for the calibration.
This is elaborated in the package vignette.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>inverse.predict(
  object,
  newdata,
  ...,
  ws = "auto",
  alpha = 0.05,
  var.s = "auto"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="inverse.predict_+3A_object">object</code></td>
<td>
<p>A univariate model object of class <code><a href="stats.html#topic+lm">lm</a></code> or
<code><a href="MASS.html#topic+rlm">rlm</a></code> with model formula <code>y ~ x</code> or <code>y ~ x -
1</code>.</p>
</td></tr>
<tr><td><code id="inverse.predict_+3A_newdata">newdata</code></td>
<td>
<p>A vector of observed y values for one sample.</p>
</td></tr>
<tr><td><code id="inverse.predict_+3A_...">...</code></td>
<td>
<p>Placeholder for further arguments that might be needed by
future implementations.</p>
</td></tr>
<tr><td><code id="inverse.predict_+3A_ws">ws</code></td>
<td>
<p>The weight attributed to the sample. This argument is obligatory
if <code>object</code> has weights.</p>
</td></tr>
<tr><td><code id="inverse.predict_+3A_alpha">alpha</code></td>
<td>
<p>The error tolerance level for the confidence interval to be
reported.</p>
</td></tr>
<tr><td><code id="inverse.predict_+3A_var.s">var.s</code></td>
<td>
<p>The estimated variance of the sample measurements. The default
is to take the residual standard error from the calibration and to adjust it
using <code>ws</code>, if applicable. This means that <code>var.s</code> overrides
<code>ws</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is an implementation of Equation (8.28) in the Handbook of Chemometrics
and Qualimetrics, Part A, Massart et al (1997), page 200, validated with
Example 8 on the same page, extended as specified in the package vignette
</p>


<h3>Value</h3>

<p>A list containing the predicted x value, its standard error and a
confidence interval.
</p>


<h3>Note</h3>

<p>The function was validated with examples 7 and 8 from Massart et al.
(1997).  Note that the behaviour of inverse.predict changed with chemCal
version 0.2.1. Confidence intervals for x values obtained from calibrations
with replicate measurements did not take the variation about the means into
account.  Please refer to the vignette for details.
</p>


<h3>References</h3>

<p>Massart, L.M, Vandenginste, B.G.M., Buydens, L.M.C., De Jong,
S., Lewi, P.J., Smeyers-Verbeke, J. (1997) Handbook of Chemometrics and
Qualimetrics: Part A, p. 200
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# This is example 7 from Chapter 8 in Massart et al. (1997)
m &lt;- lm(y ~ x, data = massart97ex1)
inverse.predict(m, 15)        #  6.1 +- 4.9
inverse.predict(m, 90)        # 43.9 +- 4.9
inverse.predict(m, rep(90,5)) # 43.9 +- 3.2

# For reproducing the results for replicate standard measurements in example 8,
# we need to do the calibration on the means when using chemCal &gt; 0.2
weights &lt;- with(massart97ex3, {
  yx &lt;- split(y, x)
  ybar &lt;- sapply(yx, mean)
  s &lt;- round(sapply(yx, sd), digits = 2)
  w &lt;- round(1 / (s^2), digits = 3)
})

massart97ex3.means &lt;- aggregate(y ~ x, massart97ex3, mean)

m3.means &lt;- lm(y ~ x, w = weights, data = massart97ex3.means)

inverse.predict(m3.means, 15, ws = 1.67)  # 5.9 +- 2.5
inverse.predict(m3.means, 90, ws = 0.145) # 44.1 +- 7.9


</code></pre>

<hr>
<h2 id='lod'>Estimate a limit of detection (LOD)</h2><span id='topic+lod'></span><span id='topic+lod.lm'></span><span id='topic+lod.rlm'></span><span id='topic+lod.default'></span>

<h3>Description</h3>

<p>The decision limit (German: Nachweisgrenze) is defined as the signal or
analyte concentration that is significantly different from the blank signal
with a first order error alpha (one-sided significance test).  The detection
limit, or more precise, the minimum detectable value (German:
Erfassungsgrenze), is then defined as the signal or analyte concentration
where the probability that the signal is not detected although the analyte
is present (type II or false negative error), is beta (also a one-sided
significance test).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lod(
  object,
  ...,
  alpha = 0.05,
  beta = 0.05,
  method = "default",
  tol = "default"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lod_+3A_object">object</code></td>
<td>
<p>A univariate model object of class <code><a href="stats.html#topic+lm">lm</a></code> or
<code><a href="MASS.html#topic+rlm">rlm</a></code> with model formula <code>y ~ x</code> or <code>y ~ x -
1</code>, optionally from a weighted regression.</p>
</td></tr>
<tr><td><code id="lod_+3A_...">...</code></td>
<td>
<p>Placeholder for further arguments that might be needed by
future implementations.</p>
</td></tr>
<tr><td><code id="lod_+3A_alpha">alpha</code></td>
<td>
<p>The error tolerance for the decision limit (critical value).</p>
</td></tr>
<tr><td><code id="lod_+3A_beta">beta</code></td>
<td>
<p>The error tolerance beta for the detection limit.</p>
</td></tr>
<tr><td><code id="lod_+3A_method">method</code></td>
<td>
<p>The &ldquo;default&rdquo; method uses a prediction interval at the
LOD for the estimation of the LOD, which obviously requires iteration. This
is described for example in Massart, p. 432 ff.  The &ldquo;din&rdquo; method
uses the prediction interval at x = 0 as an approximation.</p>
</td></tr>
<tr><td><code id="lod_+3A_tol">tol</code></td>
<td>
<p>When the &ldquo;default&rdquo; method is used, the default tolerance
for the LOD on the x scale is the value of the smallest non-zero standard
divided by 1000. Can be set to a numeric value to override this.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containig the corresponding x and y values of the estimated
limit of detection of a model used for calibration.
</p>


<h3>Note</h3>

<p>* The default values for alpha and beta are the ones recommended by IUPAC.
* The estimation of the LOD in terms of the analyte amount/concentration xD
from the LOD in the signal domain SD is done by simply inverting the
calibration function (i.e. assuming a known calibration function).
* The calculation of a LOD from weighted calibration models requires a
weights argument for the internally used <code><a href="stats.html#topic+predict.lm">predict.lm</a></code>
function, which is currently not supported in R.
</p>


<h3>References</h3>

<p>Massart, L.M, Vandenginste, B.G.M., Buydens, L.M.C., De Jong,
S., Lewi, P.J., Smeyers-Verbeke, J. (1997) Handbook of Chemometrics and
Qualimetrics: Part A, Chapter 13.7.8
</p>
<p>J. Inczedy, T. Lengyel, and A.M. Ure (2002) International Union of Pure and
Applied Chemistry Compendium of Analytical Nomenclature: Definitive Rules.
Web edition.
</p>
<p>Currie, L. A. (1997) Nomenclature in evaluation of analytical methods
including detection and quantification capabilities (IUPAC Recommendations
1995).  Analytica Chimica Acta 391, 105 - 126.
</p>


<h3>See Also</h3>

<p>Examples for <code><a href="#topic+din32645">din32645</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
m &lt;- lm(y ~ x, data = din32645)
lod(m) 

# The critical value (decision limit, German Nachweisgrenze) can be obtained
# by using beta = 0.5:
lod(m, alpha = 0.01, beta = 0.5)

</code></pre>

<hr>
<h2 id='loq'>Estimate a limit of quantification (LOQ)</h2><span id='topic+loq'></span><span id='topic+loq.lm'></span><span id='topic+loq.rlm'></span><span id='topic+loq.default'></span>

<h3>Description</h3>

<p>The limit of quantification is the x value, where the relative error of the
quantification given the calibration model reaches a prespecified value 1/k.
Thus, it is the solution of the equation </p>
<p style="text-align: center;"><code class="reqn">L = k c(L)</code>
</p>

<p>where c(L) is half of the length of the confidence interval at the limit L
(DIN 32645, equivalent to ISO 11843). c(L) is internally estimated by
<code><a href="#topic+inverse.predict">inverse.predict</a></code>, and L is obtained by iteration.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loq(
  object,
  ...,
  alpha = 0.05,
  k = 3,
  n = 1,
  w.loq = "auto",
  var.loq = "auto",
  tol = "default"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="loq_+3A_object">object</code></td>
<td>
<p>A univariate model object of class <code><a href="stats.html#topic+lm">lm</a></code> or
<code><a href="MASS.html#topic+rlm">rlm</a></code> with model formula <code>y ~ x</code> or <code>y ~ x -
1</code>, optionally from a weighted regression. If weights are specified in the
model, either <code>w.loq</code> or <code>var.loq</code> have to be specified.</p>
</td></tr>
<tr><td><code id="loq_+3A_...">...</code></td>
<td>
<p>Placeholder for further arguments that might be needed by
future implementations.</p>
</td></tr>
<tr><td><code id="loq_+3A_alpha">alpha</code></td>
<td>
<p>The error tolerance for the prediction of x values in the
calculation.</p>
</td></tr>
<tr><td><code id="loq_+3A_k">k</code></td>
<td>
<p>The inverse of the maximum relative error tolerated at the desired
LOQ.</p>
</td></tr>
<tr><td><code id="loq_+3A_n">n</code></td>
<td>
<p>The number of replicate measurements for which the LOQ should be
specified.</p>
</td></tr>
<tr><td><code id="loq_+3A_w.loq">w.loq</code></td>
<td>
<p>The weight that should be attributed to the LOQ. Defaults to
one for unweighted regression, and to the mean of the weights for weighted
regression. See <code><a href="#topic+massart97ex3">massart97ex3</a></code> for an example how to take
advantage of knowledge about the variance function.</p>
</td></tr>
<tr><td><code id="loq_+3A_var.loq">var.loq</code></td>
<td>
<p>The approximate variance at the LOQ. The default value is
calculated from the model.</p>
</td></tr>
<tr><td><code id="loq_+3A_tol">tol</code></td>
<td>
<p>The default tolerance for the LOQ on the x scale is the value of
the smallest non-zero standard divided by 1000. Can be set to a numeric
value to override this.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The estimated limit of quantification for a model used for
calibration.
</p>


<h3>Note</h3>

<p>* IUPAC recommends to base the LOQ on the standard deviation of the
signal where x = 0.
* The calculation of a LOQ based on weighted regression is non-standard and
therefore not tested. Feedback is welcome.
</p>


<h3>See Also</h3>

<p>Examples for <code><a href="#topic+din32645">din32645</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
m &lt;- lm(y ~ x, data = massart97ex1)
loq(m)

# We can get better by using replicate measurements
loq(m, n = 3)

</code></pre>

<hr>
<h2 id='massart97ex1'>Calibration data from Massart et al. (1997), example 1</h2><span id='topic+massart97ex1'></span>

<h3>Description</h3>

<p>Sample dataset from p. 175 to test the package.
</p>


<h3>Format</h3>

<p>A dataframe containing 6 observations of x and y data.
</p>


<h3>Source</h3>

<p>Massart, L.M, Vandenginste, B.G.M., Buydens, L.M.C., De Jong, S.,
Lewi, P.J., Smeyers-Verbeke, J. (1997) Handbook of Chemometrics and
Qualimetrics: Part A, Chapter 8.
</p>

<hr>
<h2 id='massart97ex3'>Calibration data from Massart et al. (1997), example 3</h2><span id='topic+massart97ex3'></span>

<h3>Description</h3>

<p>Sample dataset from p. 188 to test the package.
</p>


<h3>Format</h3>

<p>A dataframe containing 6 levels of x values with 5 observations of y
for each level.
</p>


<h3>Source</h3>

<p>Massart, L.M, Vandenginste, B.G.M., Buydens, L.M.C., De Jong, S.,
Lewi, P.J., Smeyers-Verbeke, J. (1997) Handbook of Chemometrics and
Qualimetrics: Part A, Chapter 8.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# For reproducing the results for replicate standard measurements in example 8,
# we need to do the calibration on the means when using chemCal &gt; 0.2
weights &lt;- with(massart97ex3, {
  yx &lt;- split(y, x)
  ybar &lt;- sapply(yx, mean)
  s &lt;- round(sapply(yx, sd), digits = 2)
  w &lt;- round(1 / (s^2), digits = 3)
})

massart97ex3.means &lt;- aggregate(y ~ x, massart97ex3, mean)

m3.means &lt;- lm(y ~ x, w = weights, data = massart97ex3.means)

# The following concords with the book p. 200
inverse.predict(m3.means, 15, ws = 1.67)  # 5.9 +- 2.5
inverse.predict(m3.means, 90, ws = 0.145) # 44.1 +- 7.9

# The LOD is only calculated for models from unweighted regression
# with this version of chemCal
m0 &lt;- lm(y ~ x, data = massart97ex3) 
lod(m0)

# Limit of quantification from unweighted regression
loq(m0)

# For calculating the limit of quantification from a model from weighted
# regression, we need to supply weights, internally used for inverse.predict
# If we are not using a variance function, we can use the weight from
# the above example as a first approximation (x = 15 is close to our
# loq approx 14 from above).
loq(m3.means, w.loq = 1.67)
# The weight for the loq should therefore be derived at x = 7.3 instead
# of 15, but the graphical procedure of Massart (p. 201) to derive the 
# variances on which the weights are based is quite inaccurate anyway. 

</code></pre>

<hr>
<h2 id='rl95_cadmium'>Cadmium concentrations measured by AAS as reported by Rocke and Lorenzato
(1995)</h2><span id='topic+rl95_cadmium'></span>

<h3>Description</h3>

<p>Dataset reproduced from Table 1 in Rocke and Lorenzato (1995).
</p>


<h3>Format</h3>

<p>A dataframe containing four replicate observations for each of the
six calibration standards.
</p>


<h3>Source</h3>

<p>Rocke, David M. und Lorenzato, Stefan (1995) A two-component model
for measurement error in analytical chemistry. Technometrics 37(2), 176-184.
</p>

<hr>
<h2 id='rl95_toluene'>Toluene amounts measured by GC/MS as reported by Rocke and Lorenzato (1995)</h2><span id='topic+rl95_toluene'></span>

<h3>Description</h3>

<p>Dataset reproduced from Table 4 in Rocke and Lorenzato (1995). The toluene
amount in the calibration samples is given in picograms per 100 ÂµL.
Presumably this is the volume that was injected into the instrument.
</p>


<h3>Format</h3>

<p>A dataframe containing four replicate observations for each of the
six calibration standards.
</p>


<h3>Source</h3>

<p>Rocke, David M. und Lorenzato, Stefan (1995) A two-component model
for measurement error in analytical chemistry. Technometrics 37(2), 176-184.
</p>

<hr>
<h2 id='utstats14'>Example data for calibration with replicates from University of Toronto</h2><span id='topic+utstats14'></span>

<h3>Description</h3>

<p>Dataset read into R from
<a href="https://sites.chem.utoronto.ca/chemistry/coursenotes/analsci/stats/files/example14.xls">https://sites.chem.utoronto.ca/chemistry/coursenotes/analsci/stats/files/example14.xls</a>.
</p>


<h3>Format</h3>

<p>A tibble containing three replicate observations of the response for
five calibration concentrations.
</p>


<h3>Source</h3>

<p>David Stone and Jon Ellis (2011) Statistics in Analytical Chemistry.
Tutorial website maintained by the Departments of Chemistry, University of
Toronto.
<a href="https://sites.chem.utoronto.ca/chemistry/coursenotes/analsci/stats/index.html">https://sites.chem.utoronto.ca/chemistry/coursenotes/analsci/stats/index.html</a>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
