<!DOCTYPE html><html><head><title>Help for package ROCFTP.MMS</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ROCFTP.MMS}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ROCFTP.MMS'><p>Perfect Sampling</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Perfect Sampling</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Majid Nabipoor &lt;nabipoor@ualberta.ca&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>The algorithm provided in this package generates perfect sample for unimodal or multimodal posteriors. Read Once Coupling From The Past, with Metropolis-Multishift is used to generate a perfect sample for a given posterior density based on the two extreme starting paths, minimum and maximum of the most interest range of the posterior. It uses the monotone random operation of multishift coupler which allows to sandwich all of the state space in one point. It means both Markov Chains starting from the maximum and minimum will be coalesced. The generated sample is independent from the starting points. It is useful for mixture distributions too. The output of this function is a real value as an exact draw from the posterior distribution.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Language:</td>
<td>en-us</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/nabipoor/ROCFTP.MMS">https://github.com/nabipoor/ROCFTP.MMS</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats (&ge; 4.0.0), vctrs (&ge; 0.3.8)</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Suggests:</td>
<td>rmarkdown, knitr, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Collate:</td>
<td>'LR.R' 'multishift.R' 'M.MSH.sampler.R' 'CFTP.R'
'ROCFTP.MMS.R'</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-02-17 15:41:55 UTC; mnabi</td>
</tr>
<tr>
<td>Author:</td>
<td>Majid Nabipoor [aut, cre, cph],
  Duncan Murdoch [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-02-18 08:00:08 UTC</td>
</tr>
</table>
<hr>
<h2 id='ROCFTP.MMS'>Perfect Sampling</h2><span id='topic+ROCFTP.MMS'></span>

<h3>Description</h3>

<p><code>ROCFTP.MMS</code>, Read Once Coupling From The Past, with Metropolis-Multishift
is used to generate a perfect sample for a given posterior density based on the
two extreme starting paths, minimum and maximum of the most interest range of
the posterior. It uses the monotone random operation of multishift coupler
which allows to sandwich all of the state space in one point. It means both
Markov Chains starting from the maximum and minimum will be coalesced.
The generated sample is independent from the starting points. It is useful
for mixture distributions too. The output of this function is a real value as an exact
draw from the posterior distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ROCFTP.MMS(LB, start, post, sigma, log = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ROCFTP.MMS_+3A_lb">LB</code></td>
<td>
<p>defines the length of each block. The algorithm starts new blocks to
find a coalescence of the two Markov chains started from extreme points of the
most interest range. So, if it is too small the algorithm after 50 blocks
repetition will give error message, and if it is too large then it will
increase generation time.</p>
</td></tr>
<tr><td><code id="ROCFTP.MMS_+3A_start">start</code></td>
<td>
<p>is a vector of initial values or the two extreme points of the most interest
range of posterior.</p>
</td></tr>
<tr><td><code id="ROCFTP.MMS_+3A_post">post</code></td>
<td>
<p>is the posterior which is defined in the form of an R function.</p>
</td></tr>
<tr><td><code id="ROCFTP.MMS_+3A_sigma">sigma</code></td>
<td>
<p>is a real value for standard deviation of multishift coupler. Multishift coupler
is constructed based on normal density. If the posterior is a mixture
distribution or a multi-modal distribution, then sigma should be chosen in such
a way that Markov chains easily jumps between modes, and if the sigma is
chosen small; the Markov chains may trap in one mode and don't coalesce.</p>
</td></tr>
<tr><td><code id="ROCFTP.MMS_+3A_log">log</code></td>
<td>
<p>has the default value of FALSE for density function of posteriors.
If TRUE; then posterior should be defined in log form.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Nabipoor M, Murdoch D. (2010) ROCFTP With Metropolis-Multishift Coupler, Summer
Research, Department of Statistical and actuarial sciences, University of
Western Ontario
</p>


<h3>Author(s)</h3>

<p>Majid Nabipoor: nabipoor@ualberta.ca
Duncan Murdoch: murdoch.duncan@gmail.com
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Unimodal posterior
post&lt;- function(x)
{
  dnorm(x, mean=30, sd=1)
}
start&lt;- c(20,40)
LB=30
ROCFTP.MMS(LB,start, post,1)
#Generate n i.i.d. exact sample
RG &lt;- function(i){ROCFTP.MMS(30, c(20,40), post, 1)}
n &lt;- 5
mrtx &lt;- matrix(1:n, ncol=1)
dat &lt;- apply(mrtx,1,RG)
qqnorm(dat, pch = 16, frame = FALSE)
qqline(dat, col = "steelblue", lwd = 3)

# multimodal posterior
post &lt;- function(x)
{
 0.2*dnorm(x, mean=-5, sd=1)+0.2*dnorm(x, mean=5, sd=1)+0.6*dnorm(x, mean=15, sd=1)
}
start &lt;- c(-15,25)
LB &lt;- 116
sigma &lt;- 3.5
ROCFTP.MMS(LB,start, post,sigma) #generates one exact sample
#Generate n i.i.d. exact sample
RG &lt;- function(i){ROCFTP.MMS(116, c(-15,25), post, 3.5)}
n &lt;- 5
mrtx &lt;- matrix(1:n, ncol=1)
apply(mrtx,1,RG)

#log form of posterior
post&lt;- function(x) {dnorm(x, mean=30, sd=1, log=TRUE)}
start&lt;- c(20,40)
LB=100
sigma=0.5
ROCFTP.MMS(LB,start, post, sigma, log=TRUE)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
