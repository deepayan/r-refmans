<!DOCTYPE html><html lang="en"><head><title>Help for package MetGen</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {MetGen}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#MetGen-package'>
<p>Stochastic Weather Generator</p></a></li>
<li><a href='#Cycle.effect'><p>diurnal and seasonal effects</p></a></li>
<li><a href='#fit.glm'>
<p>Fitting Generalized Linear Models</p></a></li>
<li><a href='#fit.lasso'>
<p>Lasso regression</p></a></li>
<li><a href='#formating.var'>
<p>Format variables</p></a></li>
<li><a href='#imputation.lagged'>
<p>Imputation</p></a></li>
<li><a href='#lagged.effect'>
<p>lag effect</p></a></li>
<li><a href='#movave.effect'>
<p>Moving average</p></a></li>
<li><a href='#myclimatic_data'>
<p>climatic data</p></a></li>
<li><a href='#mycovariates'>
<p>Covariates data</p></a></li>
<li><a href='#projection.lagged'>
<p>climatic variable simulation</p></a></li>
<li><a href='#rm.buffer'>
<p>Remove buffer</p></a></li>
<li><a href='#sim.glm'>
<p>Simulation of glm</p></a></li>
<li><a href='#spatave.effect'>
<p>Spatial average</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Stochastic Weather Generator</td>
</tr>
<tr>
<td>Version:</td>
<td>0.5</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-05-29</td>
</tr>
<tr>
<td>Author:</td>
<td>Julie Carreau, Nesrine Farhani</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Nesrine Farhani &lt;nesrine.farhani@ird.fr&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>An adaptation of the multi-variable stochastic weather generator proposed in 'Rglimclim' to perform gap-filling and temporal extension at sub-daily resolution. Simulation is performed based on large scale variables and climatic observation data that could be generated from different gauged stations having geographical proximity. SWG relies on reanalyses. Multi-variable dependence is taking into account by using the decomposition of the product rule (in statistics) into conditional probabilities. See <a href="https://hal.archives-ouvertes.fr/hal-02554676">https://hal.archives-ouvertes.fr/hal-02554676</a>.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2.0)]</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), chron, glmnet, MASS</td>
</tr>
<tr>
<td>URL:</td>
<td>www.r-project.org</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-05-29 15:14:13 UTC; farhani</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-06-04 09:40:10 UTC</td>
</tr>
</table>
<hr>
<h2 id='MetGen-package'>
Stochastic Weather Generator
</h2><span id='topic+MetGen-package'></span><span id='topic+MetGen'></span>

<h3>Description</h3>

<p>An adaptation of the multi-variable stochastic weather generator (SWG) proposed in Rglimclim to perform gap-filling and temporal extension at sub-daily resolution. Simulation is performed based on large scale variables and climatic observation data that could be generated from different gauged stations having geographical proximity. SWG relies on ERA5 reanalyses. Multivariable dependance is taking into account by using the decomposition of the product rule (in statistics) into conditional probabilities. See Farhani et al 2020 https://hal.archives-ouvertes.fr/hal-02554676 
</p>


<h3>Details</h3>

<p>The DESCRIPTION file:
</p>

<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> MetGen</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Title: </td><td style="text-align: left;"> Stochastic Weather Generator</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 0.5</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2020-05-29</td>
</tr>
<tr>
 <td style="text-align: left;">
Author: </td><td style="text-align: left;"> Julie Carreau, Nesrine Farhani</td>
</tr>
<tr>
 <td style="text-align: left;">
Maintainer: </td><td style="text-align: left;"> Nesrine Farhani &lt;nesrine.farhani@ird.fr&gt;</td>
</tr>
<tr>
 <td style="text-align: left;">
Description: </td><td style="text-align: left;"> An adaptation of the multi-variable stochastic weather generator proposed in 'Rglimclim' to perform gap-filling and temporal extension at sub-daily resolution. Simulation is performed based on large scale variables and climatic observation data that could be generated from different gauged stations having geographical proximity. SWG relies on reanalyses. Multi-variable dependence is taking into account by using the decomposition of the product rule (in statistics) into conditional probabilities. See &lt;https://hal.archives-ouvertes.fr/hal-02554676&gt;.</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;=2.0)</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyData: </td><td style="text-align: left;"> true</td>
</tr>
<tr>
 <td style="text-align: left;">
Depends: </td><td style="text-align: left;"> chron, glmnet, MASS</td>
</tr>
<tr>
 <td style="text-align: left;">
URL: </td><td style="text-align: left;"> www.r-project.org</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>The SWG is based on generalized linear models (GLMs) for each hydro-meteorological variable with a suitable probability distribution (Normal, Gamma or Binomial) and appropriate covariates. Covariates are considered in the GLMs to account for temporal and spatial variability. The inter-variable dependencies are taken into account by including a subset of hydro-meteorological variables (excluding the one being modelled) in the covariates of the GLMs. Large-scale atmospheric variables and deterministic effects (seasonal and diurnal cycles, geographical information and temporal persistence) are also included in the covariates.
</p>

<p>Index of help topics:
</p>
<pre>
MetGen-package          Stochastic Weather Generator
diurnal.effect          diurnal and seasonal effects
fit.glm                 Fitting Generalized Linear Models
fit.lasso               Lasso regression
formating.var           Format variables
imputation.lagged       Imputation
lagged.effect           lag effect
movave.effect           Moving average
myclimatic_data         climatic data
mycovariates            Covariates data
projection.lagged       climatic variable simulation
rm.buffer               Remove buffer
sim.glm                 Simulation of glm
spatave.effect          Spatial average
</pre>
<p>1- This package helps to define the probability distribution and covariates for each hydro-meteorological variables using <code><a href="#topic+fit.lasso">fit.lasso</a></code> function. 
</p>
<p>2- The package can be used either in a gap filling mode in which missing values in observation period are imputed using <code><a href="#topic+imputation.lagged">imputation.lagged</a></code> function, or in a projection mode in which the generator simulates values on a period with no observations to perform temporal extension using <code><a href="#topic+projection.lagged">projection.lagged</a></code> function. 
</p>


<h3>Author(s)</h3>

<p>Julie Carreau, Nesrine Farhani
</p>
<p>Maintainer: Nesrine Farhani &lt;nesrine.farhani@ird.fr&gt;
</p>


<h3>References</h3>

<p>Chandler, R. 2015. A multisite, multivariate daily weather generator based on Generalized Linear
9 Models. User guide:R package.
</p>
<p>Farhani N, Carreau J, Kassouk Z, Mougenot B, Le Page M, et al.. Sub-daily stochastic weather generator based on reanalyses for water stress retrieval in central Tunisia. 2020. (hal-02554676)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fit.glm">fit.glm</a></code> 
</p>

<hr>
<h2 id='Cycle.effect'>diurnal and seasonal effects 
</h2><span id='topic+diurnal.effect'></span><span id='topic+seasonal.effect'></span>

<h3>Description</h3>

<p>Create covariates to reproduce seasonal and diurnal variability basing on the time
</p>
<p>of the year or of the day.
</p>
<p>Seasonal effects are expressed by cos(2*pi*d/k) and sin(2*pi*d/k),
</p>
<p>with d is the day of the year and k=(365, 183, 96 or 30),
</p>
<p>Diurnal effects are expressed by cos(2*pi*h/k) and sin(2*pi*h/k),
</p>
<p>with h is the hour of the day and k=(24, 12 or 6).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>diurnal.effect(var.mat, period = 24)
seasonal.effect(var.mat, period = 365.25)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Cycle.effect_+3A_var.mat">var.mat</code></td>
<td>

<p>data frame that contains chron variable, possibly including times, geographical information for the measurement site and climatic variables for each time step,
</p>
</td></tr>
<tr><td><code id="Cycle.effect_+3A_period">period</code></td>
<td>

<p>a numeric vector that contains the period of the cycle desired, could be (183, 365, 91 or 30) for seasonal variation or (24, 12 or 6) for diurnal variation
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The same data frame defined in the arguments is returned with supplementary number of columns that contains cycle effects. The number of additional columns depends on the period defined in arguments.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+myclimatic_data">myclimatic_data</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##Perform cycle effects
seasonal_effects &lt;- seasonal.effect(myclimatic_data, period=c(365,183,91,30))
diurnal_effects &lt;- diurnal.effect(myclimatic_data, period=c(24,12,6))
</code></pre>

<hr>
<h2 id='fit.glm'>
Fitting Generalized Linear Models
</h2><span id='topic+fit.glm'></span>

<h3>Description</h3>

<p>fit.glm is used to fit generalized linear models, taking account of covariates specified in the argument list
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit.glm(var.name, dep.var=NULL, geocov=TRUE, large.var, seasonal = TRUE, 
speriod = 365.25, diurnal = TRUE, dperiod = 24, spatave=TRUE, lagspat,
movave = TRUE, bwM = 48, lagmov, spatmovave= TRUE, bwSM = 48, lagspatmov, 
lagvar, add.cov= FALSE, others=NULL,  fam.glm = "gaussian", data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fit.glm_+3A_var.name">var.name</code></td>
<td>

<p>character that forms the name of the climatic variable to be fitted
</p>
</td></tr>
<tr><td><code id="fit.glm_+3A_dep.var">dep.var</code></td>
<td>

<p>character that forms the name of depending variables
</p>
</td></tr>
<tr><td><code id="fit.glm_+3A_geocov">geocov</code></td>
<td>

<p>logical value indicating whether geographical information is part of covariates set
</p>
</td></tr>
<tr><td><code id="fit.glm_+3A_large.var">large.var</code></td>
<td>

<p>character object that forms the name of the large scale variable
</p>
</td></tr>
<tr><td><code id="fit.glm_+3A_seasonal">seasonal</code></td>
<td>

<p>logical value indicating whether seasonal effects are among the covariates
defined for the variable that will be fitted
</p>
</td></tr>
<tr><td><code id="fit.glm_+3A_speriod">speriod</code></td>
<td>

<p>A numeric vector that contains the lenght of seasonal cycles defined for the variable of
interest
</p>
</td></tr>
<tr><td><code id="fit.glm_+3A_diurnal">diurnal</code></td>
<td>

<p>logical value indicating whether diurnal effects are among the covariates defined for the variable that will be fitted
</p>
</td></tr>
<tr><td><code id="fit.glm_+3A_dperiod">dperiod</code></td>
<td>

<p>A numeric vector that contain the lenght of diurnal cycles defined for the variable of
interest
</p>
</td></tr>
<tr><td><code id="fit.glm_+3A_spatave">spatave</code></td>
<td>

<p>logical value indicating whether spatial average effects are among the covariates defined for the variable that will be fitted
</p>
</td></tr>
<tr><td><code id="fit.glm_+3A_lagspat">lagspat</code></td>
<td>

<p>Numeric vector indicating values of lags performed for the spatial average 
</p>
</td></tr>
<tr><td><code id="fit.glm_+3A_movave">movave</code></td>
<td>

<p>logical value indicating whether moving average effects are among the covariates defined for the variable that will be fitted
</p>
</td></tr>
<tr><td><code id="fit.glm_+3A_bwm">bwM</code></td>
<td>

<p>A numeric vector that contains the bandwidth defined for the moving average
</p>
</td></tr>
<tr><td><code id="fit.glm_+3A_lagmov">lagmov</code></td>
<td>

<p>Numeric vector indicating values of lags performed for the moving average 
</p>
</td></tr>
<tr><td><code id="fit.glm_+3A_spatmovave">spatmovave</code></td>
<td>

<p>logical value indicating whether spatial moving average effects are among the covariates defined for the variable that will be fitted
</p>
</td></tr>
<tr><td><code id="fit.glm_+3A_bwsm">bwSM</code></td>
<td>

<p>A numeric vector that contains the bandwidth defined for the spatial moving average
</p>
</td></tr>
<tr><td><code id="fit.glm_+3A_lagspatmov">lagspatmov</code></td>
<td>

<p>Numeric vector indicating values of lags performed for the spatial moving average 
</p>
</td></tr>
<tr><td><code id="fit.glm_+3A_lagvar">lagvar</code></td>
<td>

<p>Numeric vector indicating values of lags performed for the variable 
</p>
</td></tr>
<tr><td><code id="fit.glm_+3A_add.cov">add.cov</code></td>
<td>

<p>logical value indicatng whether we have an additional covariates defined for the variable to fit
</p>
</td></tr>
<tr><td><code id="fit.glm_+3A_others">others</code></td>
<td>

<p>character that forms the name of additional covariates specified for the variable to fit
</p>
</td></tr>
<tr><td><code id="fit.glm_+3A_fam.glm">fam.glm</code></td>
<td>

<p>family objects to specify probability distribution that will be used for the simulation mode (&quot;gaussian&quot;, &quot;gaussian-hetero&quot;, &quot;binomial&quot; or &quot;Gamma&quot;)
</p>
</td></tr>
<tr><td><code id="fit.glm_+3A_data">data</code></td>
<td>

<p>data frame that contains a variable named &quot;dates&quot; in chron format, possibly including times, geographical information for the measurement site, climatic variable to be fitted and all different covariates that will be used to fit the variable of interest
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>value returned is a variable fitted which inherits from the class &quot;lm&quot;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+diurnal.effect">diurnal.effect</a></code>, <code><a href="#topic+seasonal.effect">seasonal.effect</a></code>, <code><a href="#topic+lagged.effect">lagged.effect</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##Create a new data that contains climatic series and all effects that will be 
##used as covariates for the variable to fit
mat_effects &lt;- seasonal.effect(myclimatic_data, period=c(365,183))
mat_effects &lt;- diurnal.effect(mat_effects, period=24)
mat_effects &lt;- lagged.effect(mat_effects, "temp",2, nstat=3)
##Add a large scale variable
mat_effects$t2m &lt;- rnorm(nrow(myclimatic_data), mean=25, sd=1)
temp_fitted &lt;- fit.glm("temp", dep.var = "Rh", geocov=TRUE, large.var="t2m", 
seasonal = TRUE, speriod = c(365, 183), diurnal = TRUE, dperiod = 24, 
spatave = FALSE, movave = FALSE, spatmovave= FALSE, add.cov = FALSE, others = NULL, 
lagvar=2, fam.glm = "gaussian", data=mat_effects)
</code></pre>

<hr>
<h2 id='fit.lasso'>
Lasso regression
</h2><span id='topic+fit.lasso'></span>

<h3>Description</h3>

<p>Fit a generalized linear model via penalized maximum likelihood. LASSO regression is applied to perform a preliminary screening for a large covariate set. It solves a regularized least squares problem recognized for its potential to perform simultaneously variable selection and parameter estimation. It might be used only for gaussian cases to yield parsimonious solutions, i.e. with few covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit.lasso(cov.mat, var.name)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fit.lasso_+3A_cov.mat">cov.mat</code></td>
<td>

<p>data frame that contains only the variable to be fitted, and a large set of covariates that will be tested to choose the parsimonious ones relying on Lasso coefficient estimates 
</p>
</td></tr>
<tr><td><code id="fit.lasso_+3A_var.name">var.name</code></td>
<td>

<p>character object that forms the name of the variable to be fitted 
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of class &quot;cv.glmnet&quot; is returned, which is a list with the ingredients of the cross-validation fit. 
</p>


<h3>See Also</h3>

<p><code><a href="glmnet.html#topic+glmnet">glmnet</a></code>, <code><a href="glmnet.html#topic+cv.glmnet">cv.glmnet</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##Create a new data that contains climatic series and all effects that will be
##used as covariates for the variable to be computed
mat_effects &lt;- seasonal.effect(myclimatic_data, period=c(365,183))
mat_effects &lt;- diurnal.effect(mat_effects, period=24)
mat_effects &lt;- spatave.effect(mat_effects, "temp", nstat = 3, na.proc = TRUE)
mat_effects &lt;- lagged.effect(mat_effects, "temp",2, nstat=3)
mat_effects$t2m &lt;- rnorm(nrow(myclimatic_data), mean=25, sd=1)

fit.lasso(mat_effects[,3:length(mat_effects)], "temp")
</code></pre>

<hr>
<h2 id='formating.var'>
Format variables
</h2><span id='topic+formating.var'></span>

<h3>Description</h3>

<p>Extraction of a variable of interest for each site separetly
</p>


<h3>Usage</h3>

<pre><code class='language-R'>formating.var(var.mat, var.name, nstat)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="formating.var_+3A_var.mat">var.mat</code></td>
<td>

<p>data frame containing chron variable, geographical information and different climatic variables for each time step and for each site
</p>
</td></tr>
<tr><td><code id="formating.var_+3A_var.name">var.name</code></td>
<td>

<p>character object that forms the name of the climatic variable to be picked up from the data frame according to sites
</p>
</td></tr>
<tr><td><code id="formating.var_+3A_nstat">nstat</code></td>
<td>

<p>numeric vector that contains the number of gauged sites included in the data frame
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a new data frame is returned with time steps and temporal series of the variable of interest arranged in columns according to sites
</p>


<h3>Examples</h3>

<pre><code class='language-R'>nstat &lt;- 3
temp_mat &lt;- formating.var(myclimatic_data,"temp", nstat)
</code></pre>

<hr>
<h2 id='imputation.lagged'>
Imputation
</h2><span id='topic+imputation.lagged'></span>

<h3>Description</h3>

<p>Gap filling on time steps with no data during the observation period.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>imputation.lagged(fit, var.name, maxlag, coord, cov = NULL, 
seasonal = TRUE, speriod = 365.25, diurnal = TRUE, dperiod = 24, 
spatave = TRUE, movave = TRUE, bw = 48, na.proc = TRUE, 
fam.glm = "gaussian", occ.cond = NULL, init.buff = 1440)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="imputation.lagged_+3A_fit">fit</code></td>
<td>

<p>Fitted model derived from <code><a href="#topic+fit.glm">fit.glm</a></code>
</p>
</td></tr>
<tr><td><code id="imputation.lagged_+3A_var.name">var.name</code></td>
<td>

<p>Charcter object that forms the name of the climatic variable to be imputed
</p>
</td></tr>
<tr><td><code id="imputation.lagged_+3A_maxlag">maxlag</code></td>
<td>

<p>Numeric vector that forms the maximum amount of lag defined for the fitted model
</p>
</td></tr>
<tr><td><code id="imputation.lagged_+3A_coord">coord</code></td>
<td>

<p>Data frame of two columns (x and y) that contains geographical coordinates of each site
</p>
</td></tr>
<tr><td><code id="imputation.lagged_+3A_cov">cov</code></td>
<td>

<p>Data frame that contains chron object and all external covariates used to fit each climatic variables that will be imputed. These covariates must be available for a buffer period in addition of the period that will be imputed.
</p>
</td></tr>
<tr><td><code id="imputation.lagged_+3A_seasonal">seasonal</code></td>
<td>

<p>A logical value indicating whether seasonal effects are among the covariates defined for the variable that will be imputed
</p>
</td></tr>
<tr><td><code id="imputation.lagged_+3A_speriod">speriod</code></td>
<td>

<p>A numeric vector that contains the lenght of seasonal cycles defined for the variable of interest
</p>
</td></tr>
<tr><td><code id="imputation.lagged_+3A_diurnal">diurnal</code></td>
<td>

<p>A logical value indicating whether diurnal effects are among the covariates defined for the variable that will be imputed
</p>
</td></tr>
<tr><td><code id="imputation.lagged_+3A_dperiod">dperiod</code></td>
<td>

<p>A numeric vector that contains the lenght of diurnal cycles defined for the variable of interest 
</p>
</td></tr>
<tr><td><code id="imputation.lagged_+3A_spatave">spatave</code></td>
<td>

<p>A logical value indicating whether spatial average effects are among the covariates defined for the variable that will be imputed
</p>
</td></tr>
<tr><td><code id="imputation.lagged_+3A_movave">movave</code></td>
<td>

<p>A logical value indicating whether moving average effects are among the covariates defined for the variable that will be imputed
</p>
</td></tr>
<tr><td><code id="imputation.lagged_+3A_bw">bw</code></td>
<td>

<p>A numeric vector that contains the bandwidth defined for the moving average
</p>
</td></tr>
<tr><td><code id="imputation.lagged_+3A_na.proc">na.proc</code></td>
<td>

<p>A logical value indicating whether NA values should be stripped before imputation
</p>
</td></tr>
<tr><td><code id="imputation.lagged_+3A_fam.glm">fam.glm</code></td>
<td>

<p>Family objects to specify probability distribution that will be used for the simulation in the missing period (&quot;gaussian&quot;, &quot;gaussian-hetero&quot;, &quot;binomial&quot; or &quot;Gamma&quot;)
</p>
</td></tr>
<tr><td><code id="imputation.lagged_+3A_occ.cond">occ.cond</code></td>
<td>

<p>character object that specifies the occurrence variable if that exists 
</p>
</td></tr>
<tr><td><code id="imputation.lagged_+3A_init.buff">init.buff</code></td>
<td>

<p>A buffer time is an extra time added before simulation to keep the simulation on track. 
the init.buffer is numeric vector, defined according to the number of climatic observations per the day and the number of few days that we choose as a buffer time before starting the simulation
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An additional column in the cov data frame of the variable of interest with no more missing values 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fit.glm">fit.glm</a></code>, <code><a href="stats.html#topic+glm">glm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>myclimatic_data$dates=myclimatic_data$JD

##random removal of 30 percent of climatic observations to comput artificially 
##missing values
n.miss=round(nrow(myclimatic_data)*0.30)
ind_miss=sample(nrow(myclimatic_data), n.miss)
myclimatic_data$temp[ind_miss]=NA

##Create a new data that contains climatic series and all effects that will be used 
##as covariates for the variable to be computed
temp.effects &lt;- seasonal.effect(myclimatic_data, period=c(365,183))
temp.effects &lt;- diurnal.effect(temp.effects, period=24)
temp.effects &lt;- lagged.effect(temp.effects, "temp",2, nstat=3)
temp.effects$t2m &lt;- rnorm(nrow(myclimatic_data),mean=25,sd=1)

coord &lt;- data.frame(x=c(9.92,9.93,10.04),y=c(35.55,35.62,35.57))
nstat=3
init.buff=48*7 ##48 time step per day and 7 days will be considered as buffer time

##fitted variable
temp.fitted &lt;- fit.glm("temp", dep.var = NULL, geocov=TRUE, large.var="t2m", 
seasonal = TRUE, speriod = c(365, 183), diurnal = TRUE, dperiod = 24, 
spatave = FALSE, movave = FALSE, spatmovave= FALSE, lagvar=2, add.cov = FALSE, 
others = NULL, fam.glm = "gaussian", data= temp.effects)

temp.imputation &lt;- imputation.lagged(temp.fitted, "temp", maxlag=2, coord, 
cov=mycovariates, seasonal = TRUE, speriod = c(365,183), diurnal = TRUE, 
dperiod = 24, spatave = FALSE, movave=FALSE,bw = 0, fam.glm = "gaussian")
</code></pre>

<hr>
<h2 id='lagged.effect'>
lag effect
</h2><span id='topic+lagged.effect'></span>

<h3>Description</h3>

<p>Introduce lag effects for variables
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lagged.effect(var.mat, var.name, maxlag, nstat = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lagged.effect_+3A_var.mat">var.mat</code></td>
<td>

<p>A data frame containing a chron variable and different climatic variables for each time step 
</p>
</td></tr>
<tr><td><code id="lagged.effect_+3A_var.name">var.name</code></td>
<td>

<p>Character object that forms the name of the climatic variable to be lagged
</p>
</td></tr>
<tr><td><code id="lagged.effect_+3A_maxlag">maxlag</code></td>
<td>

<p>Numeric vector that specifies the maximum amount of lag requested
</p>
</td></tr>
<tr><td><code id="lagged.effect_+3A_nstat">nstat</code></td>
<td>

<p>Numeric vector that specifies the number of sites considered
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>lagged effect for the variable var.name, will be observed, according to the amount of maxlag defined in the data frame introduced 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data_lagged4 &lt;- lagged.effect(myclimatic_data, "temp",4, nstat=3)
data_lagged8 &lt;- lagged.effect(myclimatic_data, "temp",8, nstat=3)
</code></pre>

<hr>
<h2 id='movave.effect'>
Moving average
</h2><span id='topic+movave.effect'></span>

<h3>Description</h3>

<p>Averaging previous time steps using different bandwidth to perform temporal auto-correlation 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>movave.effect(var.mat, var.name, bw, nstat = NULL, na.proc = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="movave.effect_+3A_var.mat">var.mat</code></td>
<td>

<p>Data frame containing chron variable and different climatic variables for each time step
</p>
</td></tr>
<tr><td><code id="movave.effect_+3A_var.name">var.name</code></td>
<td>

<p>character object to define the name of the climatic variable that we will perform the moving average
</p>
</td></tr>
<tr><td><code id="movave.effect_+3A_bw">bw</code></td>
<td>

<p>Numeric vector that forms the bandwidth to be used for the moving average 
</p>
</td></tr>
<tr><td><code id="movave.effect_+3A_nstat">nstat</code></td>
<td>

<p>Numeric vector specifying the number of gauged stations used to obtain observation data
</p>
</td></tr>
<tr><td><code id="movave.effect_+3A_na.proc">na.proc</code></td>
<td>

<p>A logical value indicating whether NA values should be stripped before the computation proceeds
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An additional column will be added in the data frame introduced containing the average of the variable of interest over previous time step specified by the bandwith for each site
</p>


<h3>Examples</h3>

<pre><code class='language-R'>temp_movave &lt;- movave.effect(myclimatic_data, "temp", 48, nstat = 3, 
na.proc = TRUE) 
</code></pre>

<hr>
<h2 id='myclimatic_data'>
climatic data
</h2><span id='topic+myclimatic_data'></span>

<h3>Description</h3>

<p>A synthetic climatic data that contains time series, geographical coordinates and different climatic variables for a subdaily resolution. Each row corresponds for a time step, and each time is available for a site.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>myclimatic_data</code></pre>


<h3>Format</h3>

<p>A data frame with 4320 observations on the following 6 variables.
</p>

<dl>
<dt><code>dates</code></dt><dd><p>a chron object to define time steps</p>
</dd>
<dt><code>JD</code></dt><dd><p>a numeric vector sepcifying julian days</p>
</dd>
<dt><code>coord.x</code></dt><dd><p>a numeric vector to define the x coodinates of different sites</p>
</dd>
<dt><code>coord.y</code></dt><dd><p>a numeric vector to define the y coodinates of different sites</p>
</dd>
<dt><code>temp</code></dt><dd><p>a numeric vector for a climatic variable (temperature)</p>
</dd>
<dt><code>Rh</code></dt><dd><p>a numeric vector for a climatic variable (relative humidity)</p>
</dd>
</dl>


<hr>
<h2 id='mycovariates'>
Covariates data
</h2><span id='topic+mycovariates'></span>

<h3>Description</h3>

<p>Covariates data that contains time series, geographical coordinates and different climatic variables for a subdaily resolution. Each row corresponds for a time step, and each time is available for a site.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mycovariates</code></pre>


<h3>Format</h3>

<p>A data frame with 4320 observations on the following 18 variables.
</p>

<dl>
<dt><code>dates</code></dt><dd><p>a numeric vector for the time steps</p>
</dd>
<dt><code>coord.x</code></dt><dd><p>a numeric vector to define the x coodinates of different sites</p>
</dd>
<dt><code>coord.y</code></dt><dd><p>a numeric vector to define the y coodinates of different sites</p>
</dd>
<dt><code>t2m</code></dt><dd><p>a numeric vector for a large scale variable obtained from reanalysis</p>
</dd>
<dt><code>cos.365d</code></dt><dd><p>a numeric vector for the seasonal variabiliy throughout 365 days</p>
</dd>
<dt><code>sin.365d</code></dt><dd><p>a numeric vector for the seasonal variabiliy throughout 365 days</p>
</dd>
<dt><code>cos.183d</code></dt><dd><p>a numeric vector for the seasonal variabiliy throughout 183 days</p>
</dd>
<dt><code>sin.183d</code></dt><dd><p>a numeric vector for the seasonal variabiliy throughout 183 days</p>
</dd>
<dt><code>cos.91d</code></dt><dd><p>a numeric vector for the seasonal variabiliy throughout 91 days</p>
</dd>
<dt><code>sin.91d</code></dt><dd><p>a numeric vector for the seasonal variabiliy throughout 91 days</p>
</dd>
<dt><code>cos.30d</code></dt><dd><p>a numeric vector for the seasonal variabiliy throughout 30 days</p>
</dd>
<dt><code>sin.30d</code></dt><dd><p>a numeric vector for the seasonal variabiliy throughout 30 days</p>
</dd>
<dt><code>cos.24h</code></dt><dd><p>a numeric vector for diurnal variabiliy during a day</p>
</dd>
<dt><code>sin.24h</code></dt><dd><p>a numeric vector for diurnal variabiliy during a day</p>
</dd>
<dt><code>cos.12h</code></dt><dd><p>a numeric vector for diurnal variabiliy during half a day</p>
</dd>
<dt><code>sin.12h</code></dt><dd><p>a numeric vector for diurnal variabiliy during half a day</p>
</dd>
<dt><code>cos.6h</code></dt><dd><p>a numeric vector for diurnal variabiliy during 6 hours</p>
</dd>
<dt><code>sin.6h</code></dt><dd><p>a numeric vector for diurnal variabiliy during 6 hours</p>
</dd>
</dl>


<hr>
<h2 id='projection.lagged'>
climatic variable simulation
</h2><span id='topic+projection.lagged'></span>

<h3>Description</h3>

<p>Projection of climatic variables for a specific period defined by the user. It forms a free simulation from fitted model constraining by covariates that must be available for the period of projection. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>projection.lagged(dstart, dend, fit, var.name, maxlag, coord, cov = NULL, 
seasonal = TRUE, speriod = 365.25, diurnal = TRUE, dperiod = 24, 
spatave = TRUE, movave = TRUE, bw = 48, na.proc = TRUE, 
fam.glm = "gaussian", occ.cond = NULL, init.buff = 1440)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="projection.lagged_+3A_dstart">dstart</code></td>
<td>

<p>Numeric that defines the first time step of the simulation
</p>
</td></tr>
<tr><td><code id="projection.lagged_+3A_dend">dend</code></td>
<td>

<p>Numeric that defines the last time step of the simulation
</p>
</td></tr>
<tr><td><code id="projection.lagged_+3A_fit">fit</code></td>
<td>

<p>fitted model derived from <code><a href="stats.html#topic+glm">glm</a></code> or <code><a href="#topic+fit.glm">fit.glm</a></code>
</p>
</td></tr>
<tr><td><code id="projection.lagged_+3A_var.name">var.name</code></td>
<td>

<p>Character that defines the name of the climatic variable to be simulated
</p>
</td></tr>
<tr><td><code id="projection.lagged_+3A_maxlag">maxlag</code></td>
<td>

<p>Numeric vector that specifies the maximum amount of lag defined for the fitted model
</p>
</td></tr>
<tr><td><code id="projection.lagged_+3A_coord">coord</code></td>
<td>

<p>Data frame of two columns (x and y) that contains geographical coordinates of each site
</p>
</td></tr>
<tr><td><code id="projection.lagged_+3A_cov">cov</code></td>
<td>

<p>Data frame that contains dates and all external covariates used to fit each climatic variables that will be simulated. These covariates must be available for a buffer period in addition of the period of simulation that start at &quot;dstart&quot; and finish at &quot;dend&quot;.
</p>
</td></tr>
<tr><td><code id="projection.lagged_+3A_seasonal">seasonal</code></td>
<td>

<p>A logical value indicating whether seasonal effects are among the covariates defined for the variable that will be simulated
</p>
</td></tr>
<tr><td><code id="projection.lagged_+3A_speriod">speriod</code></td>
<td>

<p>A vector that contains the lenght of seasonal cycles defined for the variable of interest 
</p>
</td></tr>
<tr><td><code id="projection.lagged_+3A_diurnal">diurnal</code></td>
<td>

<p>A logical value indicating whether diurnal effects are among the covariates defined for the variable that will be simulated
</p>
</td></tr>
<tr><td><code id="projection.lagged_+3A_dperiod">dperiod</code></td>
<td>

<p>A vector that contains the lenght of diurnal cycles defined for the variable of interest 
</p>
</td></tr>
<tr><td><code id="projection.lagged_+3A_spatave">spatave</code></td>
<td>

<p>A logical value indicating whether spatial average effects are among the covariates defined for the variable that will be simulated
</p>
</td></tr>
<tr><td><code id="projection.lagged_+3A_movave">movave</code></td>
<td>

<p>A logical value indicating whether moving average effects are among the covariates defined for the variable that will be simulated
</p>
</td></tr>
<tr><td><code id="projection.lagged_+3A_bw">bw</code></td>
<td>

<p>A numeric vector that contains the bandwidth defined for the moving average
</p>
</td></tr>
<tr><td><code id="projection.lagged_+3A_na.proc">na.proc</code></td>
<td>

<p>A logical value indicating whether NA values should be stripped before simulation
</p>
</td></tr>
<tr><td><code id="projection.lagged_+3A_fam.glm">fam.glm</code></td>
<td>

<p>family objects to specify probability distribution that will be used for the simulation mode (&quot;gaussian&quot;, &quot;gaussian-hetero&quot;, &quot;binomial&quot; or &quot;Gamma&quot;)
</p>
</td></tr>
<tr><td><code id="projection.lagged_+3A_occ.cond">occ.cond</code></td>
<td>

<p>Character that specify the name of the occurrence variable if that exists 
</p>
</td></tr>
<tr><td><code id="projection.lagged_+3A_init.buff">init.buff</code></td>
<td>

<p>A buffer time is an extra time added before simulation to keep the simulation on track. 
the init.buffer is numeric vector, defined according to the number of climatic observations per the day and the number of few days that we choose as a buffer time before starting the simulation
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a data frame that contains the covariates data frame with an additional column that contains the simulation of the variable of interest. If the covariates data frame is not specified among arguments, the function will create its own data frame of covariates that contains deterministic effects: geographical, diurnal and seasonal effects. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fit.glm">fit.glm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##Create a new data that contains climatic series and all effects that will be 
##used as covariates for the variable to be projected or simulated
temp.effects &lt;- seasonal.effect(myclimatic_data, period=c(365,183))
temp.effects &lt;- diurnal.effect(temp.effects, period=24)
temp.effects &lt;- spatave.effect(temp.effects, "temp", nstat = 3, na.proc = TRUE) 
temp.effects &lt;- lagged.effect(temp.effects, "temp",2, nstat=3)
temp.effects$t2m &lt;- rnorm(length(myclimatic_data),mean=25,sd=1)

coord &lt;- data.frame(x=c(9.92,9.93,10.04),y=c(35.55,35.62,35.57))
nstat=3
init.buff=48*7 ##48 time step per day and 7 days will be considered as buffer time
dstart=as.numeric(mycovariates[(init.buff*nstat)+1,1]) 
dend=as.numeric(mycovariates$dates[nrow(mycovariates)])

##fitted variable
temp.fitted &lt;- fit.glm("temp", dep.var = NULL, geocov=TRUE, large.var="t2m", 
seasonal = TRUE, speriod = c(365, 183), diurnal = TRUE, dperiod = 24, 
spatave = FALSE, movave = FALSE, spatmovave= FALSE, lagvar=2, add.cov = FALSE, 
others = NULL, fam.glm = "gaussian", data= temp.effects)

temp.projection &lt;- projection.lagged(dstart, dend, temp.fitted, "temp", maxlag=2, 
coord, cov=mycovariates, seasonal = TRUE, speriod = c(365,183),  diurnal = TRUE, 
dperiod = 24, spatave = FALSE, movave=FALSE,bw = 0, fam.glm = "gaussian", 
occ.cond = NULL)

##Remove buffer
temp.projection &lt;- rm.buffer(temp.projection, nstat, bi.length=init.buff)
</code></pre>

<hr>
<h2 id='rm.buffer'>
Remove buffer
</h2><span id='topic+rm.buffer'></span>

<h3>Description</h3>

<p>Remove buffer after using it for simulation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rm.buffer(simdata, nstat, bi.length = 480)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rm.buffer_+3A_simdata">simdata</code></td>
<td>

<p>Data frame obtained after simulation using the function <code><a href="#topic+projection.lagged">projection.lagged</a></code>
</p>
</td></tr>
<tr><td><code id="rm.buffer_+3A_nstat">nstat</code></td>
<td>

<p>Numeric vector specifying the number of sites used 
</p>
</td></tr>
<tr><td><code id="rm.buffer_+3A_bi.length">bi.length</code></td>
<td>

<p>Numeric vector that specifies the period of buffer (number of days* number of climatological observations per day)
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame derived from <code><a href="#topic+projection.lagged">projection.lagged</a></code> that start from dstart and finish on dend
</p>


<h3>See Also</h3>

<p><code><a href="#topic+projection.lagged">projection.lagged</a></code>
</p>

<hr>
<h2 id='sim.glm'>
Simulation of glm
</h2><span id='topic+sim.glm'></span>

<h3>Description</h3>

<p>function for predictions from the results of model fitting functions (<code><a href="#topic+fit.glm">fit.glm</a></code>) or
(<code><a href="stats.html#topic+glm">glm</a></code>)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim.glm(fit, datapred, fam.glm = "gaussian", occ.cond = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sim.glm_+3A_fit">fit</code></td>
<td>

<p>climatic variable fitted returned from &quot;glm&quot; which inherits from the class &quot;lm&quot;.
</p>
</td></tr>
<tr><td><code id="sim.glm_+3A_datapred">datapred</code></td>
<td>

<p>Data frame that contains dates, climatic variables and all covariates used to fit the variable to simulate
</p>
</td></tr>
<tr><td><code id="sim.glm_+3A_fam.glm">fam.glm</code></td>
<td>

<p>family objects to specify probability distribution used for the model (&quot;gaussian&quot;, &quot;gaussian-hetero&quot;, &quot;binomial&quot; or &quot;Gamma&quot;)
</p>
</td></tr>
<tr><td><code id="sim.glm_+3A_occ.cond">occ.cond</code></td>
<td>

<p>character object that specifies the name of the occurrence variable if that exists 
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Value returned belong to the same class of its first argument
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+glm">glm</a></code>, <code><a href="#topic+fit.glm">fit.glm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>temp_fitted=glm(temp~Rh, family=gaussian, data=myclimatic_data)
temp.sim=sim.glm(temp_fitted, myclimatic_data, fam.glm = "gaussian", occ.cond = NULL)
</code></pre>

<hr>
<h2 id='spatave.effect'>
Spatial average
</h2><span id='topic+spatave.effect'></span>

<h3>Description</h3>

<p>Performs average value of climatic variable over different sites 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spatave.effect(var.mat, var.name, nstat = NULL, na.proc = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="spatave.effect_+3A_var.mat">var.mat</code></td>
<td>

<p>A data frame containing a variable named &quot;dates&quot; in chron format and different climatic variables for each time step and for each site
</p>
</td></tr>
<tr><td><code id="spatave.effect_+3A_var.name">var.name</code></td>
<td>

<p>Character object specifying the name of the climatic variable for which we will perfom spatial average
</p>
</td></tr>
<tr><td><code id="spatave.effect_+3A_nstat">nstat</code></td>
<td>

<p>Numeric vector to define the number of sites used to obtain climatic series
</p>
</td></tr>
<tr><td><code id="spatave.effect_+3A_na.proc">na.proc</code></td>
<td>

<p>A logical value indicating whether NA values should be stripped before the computation proceeds
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An additional column will be added in the data frame introduced to contain the average of the variable of interest over the different sites for each time step
</p>


<h3>Examples</h3>

<pre><code class='language-R'>temp_spatave &lt;- spatave.effect(myclimatic_data, "temp", nstat = 3, na.proc = TRUE) 

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
