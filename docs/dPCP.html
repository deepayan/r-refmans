<!DOCTYPE html><html><head><title>Help for package dPCP</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {dPCP}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#centers_data'><p>Prediction of clusters centroid position</p></a></li>
<li><a href='#cmeans_clus'><p>Cluster analysis with fuzzy c-means algorithm</p></a></li>
<li><a href='#dbscan_combination'><p>Test eps and minPts combinations for DBSCAN analysis</p></a></li>
<li><a href='#dPCP'><p>Automated analysis of digital PCR data</p></a></li>
<li><a href='#export_csv'><p>Export dPCP analysis results to a csv file</p></a></li>
<li><a href='#manual_correction'><p>Manual correction of dPCP cluster analysis</p></a></li>
<li><a href='#rain_reclus'><p>Identification and clustering of &quot;rain&quot; data</p></a></li>
<li><a href='#read_reference'><p>Read reference files</p></a></li>
<li><a href='#read_sample'><p>Read sample files</p></a></li>
<li><a href='#read_sampleTable'><p>Read sample table</p></a></li>
<li><a href='#reference_dbscan'><p>Find the empty partitions and single target clusters in the reference sample</p></a></li>
<li><a href='#replicates_quant'><p>Calculation of targets concentration, pooling the sample replicates</p></a></li>
<li><a href='#report_dPCP'><p>Export dPCP analysis results to a pdf report</p></a></li>
<li><a href='#target_quant'><p>Calculation of targets concentration.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Automated Analysis of Multiplex Digital PCR Data</td>
</tr>
<tr>
<td>Version:</td>
<td>2.0.1</td>
</tr>
<tr>
<td>Description:</td>
<td>The automated clustering and quantification of the digital PCR
            data is based on the combination of 'DBSCAN' (Hahsler et al. (2019)
            &lt;<a href="https://doi.org/10.18637%2Fjss.v091.i01">doi:10.18637/jss.v091.i01</a>&gt;) and 'c-means' (Bezdek et al. (1981) 
            &lt;<a href="https://doi.org/10.1007%2F978-1-4757-0450-1">doi:10.1007/978-1-4757-0450-1</a>&gt;) algorithms.
            The analysis is independent of multiplexing geometry, dPCR system, 
            and input amount.
            The details about input data and parameters are available in the
            vignette. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>cluster, dbscan, e1071, exactci, ggplot2, ggpubr, graphics,
raster, rlist, scales, shiny, shinyjs, stats, stringr, utils</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/alfodefalco/dPCP">https://github.com/alfodefalco/dPCP</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/alfodefalco/dPCP/issues">https://github.com/alfodefalco/dPCP/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-12 17:53:04 UTC; alfonsodefalco</td>
</tr>
<tr>
<td>Author:</td>
<td>Alfonso De Falco <a href="https://orcid.org/0000-0001-9985-9920"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Michel Mittelbronn [ctb],
  Christophe Olinger [ctb],
  Daniel Stieber [ctb],
  Laboratoire national de sant√© [cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Alfonso De Falco &lt;alfonsodefalco90@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-12 18:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='centers_data'>Prediction of clusters centroid position</h2><span id='topic+centers_data'></span><span id='topic+plot.centers_data'></span>

<h3>Description</h3>

<p>This function calculates the coodintaes of all clusters centroid.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>centers_data(sample.subquality, sample.table, referenceDB)

## S3 method for class 'centers_data'
plot(x, ..., sample = "all")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="centers_data_+3A_sample.subquality">sample.subquality</code></td>
<td>
<p>an object of class <code>read_sample</code>, inherited
from <code><a href="#topic+read_sample">read_sample</a></code>.</p>
</td></tr>
<tr><td><code id="centers_data_+3A_sample.table">sample.table</code></td>
<td>
<p>object of class <code>sample_table</code>, inherited from
<code><a href="#topic+read_sampleTable">read_sampleTable</a></code>.</p>
</td></tr>
<tr><td><code id="centers_data_+3A_referencedb">referenceDB</code></td>
<td>
<p>an object of class <code>reference_dbscan</code>, inherited
from <code><a href="#topic+reference_dbscan">reference_dbscan</a></code></p>
</td></tr>
<tr><td><code id="centers_data_+3A_x">x</code></td>
<td>
<p>an object of class <code>centers_data</code></p>
</td></tr>
<tr><td><code id="centers_data_+3A_...">...</code></td>
<td>
<p>Arguments to be passed to methods</p>
</td></tr>
<tr><td><code id="centers_data_+3A_sample">sample</code></td>
<td>
<p>'all' to show all samples, or a numeric vector indicating
the row number of samples in the sample table.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>centers_data</code> containing a sublist for
each sample. Each sublist has the following components:
</p>
<table>
<tr><td><code>quality</code></td>
<td>
<p>quality threshold used in <code><a href="#topic+read_sample">read_sample</a></code>.</p>
</td></tr>
<tr><td><code>reference</code></td>
<td>
<p>reference ID.</p>
</td></tr>
<tr><td><code>centers</code></td>
<td>
<p>a data frame with the centroids coordinates.</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>a data frame with the fluorescence intensities.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
library(dPCP)

#Find path of sample table and location of reference and input files
sampleTable &lt;- system.file("extdata", "Template_sampleTable.csv",
                     package = "dPCP")

fileLoc &lt;- system.file("extdata",package = "dPCP")

#Read sample table file
sample.table &lt;- read_sampleTable(sampleTable, system = "bio-rad",
                                 file.location = fileLoc)

#Read reference files
ref &lt;- read_reference(sample.table, system = "bio-rad",
                      file.location = fileLoc)

#Read samples files
samp &lt;- read_sample(sample.table, system = "bio-rad",
                    file.location = fileLoc)

#Reference DBSCAN clustering
dbref &lt;- reference_dbscan(ref, sample.table, save.template = FALSE)

#Predict position of clusters centroid from reference DBSCAN results
cent &lt;- centers_data(samp, sample.table,dbref)

plot(cent, sample = "all")

</code></pre>

<hr>
<h2 id='cmeans_clus'>Cluster analysis with fuzzy c-means algorithm</h2><span id='topic+cmeans_clus'></span><span id='topic+plot.cmeans_clus'></span>

<h3>Description</h3>

<p>This function carries out the c-means cluster analysis, using the centroids
position as initial values for cluster centers.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cmeans_clus(centers.data)

## S3 method for class 'cmeans_clus'
plot(x, ..., sample = "all", color.blind = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cmeans_clus_+3A_centers.data">centers.data</code></td>
<td>
<p>an object of class <code>centers_data</code>, inherited
from <code><a href="#topic+centers_data">centers_data</a></code>.</p>
</td></tr>
<tr><td><code id="cmeans_clus_+3A_x">x</code></td>
<td>
<p>an object of class <code>cmeans_clus</code></p>
</td></tr>
<tr><td><code id="cmeans_clus_+3A_...">...</code></td>
<td>
<p>Arguments to be passed to methods</p>
</td></tr>
<tr><td><code id="cmeans_clus_+3A_sample">sample</code></td>
<td>
<p>'all' to show all samples, or a numeric vector indicating
the row number of samples in the sample table.</p>
</td></tr>
<tr><td><code id="cmeans_clus_+3A_color.blind">color.blind</code></td>
<td>
<p>logical. If TRUE colors optimized for colorblind readers
are used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>cmeans_clus</code> containing a sublist for
each sample. Each sublist has the following components:
</p>
<table>
<tr><td><code>quality</code></td>
<td>
<p>quality threshold used in <code><a href="#topic+read_sample">read_sample</a></code>.</p>
</td></tr>
<tr><td><code>reference</code></td>
<td>
<p>reference ID.</p>
</td></tr>
<tr><td><code>centers</code></td>
<td>
<p>a data frame with the centroids coordinates.</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>a data frame with the fluorescence intensities and clusters
name.</p>
</td></tr>
<tr><td><code>membership</code></td>
<td>
<p>a matrix with the membership values of the data elements
to the clusters. See also <code><a href="e1071.html#topic+cmeans">cmeans</a></code></p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
library(dPCP)

#Find path of sample table and location of reference and input files
sampleTable &lt;- system.file("extdata", "Template_sampleTable.csv",
                     package = "dPCP")

fileLoc &lt;- system.file("extdata",package = "dPCP")

#Read sample table file
sample.table &lt;- read_sampleTable(sampleTable, system = "bio-rad",
                                 file.location = fileLoc)

#Read reference files
ref &lt;- read_reference(sample.table, system = "bio-rad",
                      file.location = fileLoc)

#Read samples files
samp &lt;- read_sample(sample.table, system = "bio-rad",
                    file.location = fileLoc)

#Reference DBSCAN clustering
dbref &lt;- reference_dbscan(ref, sample.table, save.template = FALSE)

#Predict position of clusters centroid from reference DBSCAN results
cent &lt;- centers_data(samp, sample.table,dbref)

#Fuzzy c-means clustering
cmclus &lt;- cmeans_clus(cent)

plot(cmclus, sample = "all")

</code></pre>

<hr>
<h2 id='dbscan_combination'>Test eps and minPts combinations for DBSCAN analysis</h2><span id='topic+dbscan_combination'></span>

<h3>Description</h3>

<p>This function tests all combinations of eps and minPts for DBSCAN analysis
of reference samples indicated in refID. The results are represented in
scatterplots exported to a pdf file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dbscan_combination(
  refID,
  system = NULL,
  file.location = ".",
  reference.quality = 0.5,
  eps = c(120, 150, 180, 200),
  minPts = c(20, 50, 80, 100)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dbscan_combination_+3A_refid">refID</code></td>
<td>
<p>a string or a character vector of chipID (Thermo Fisher) or
the complete file name with the extension (Bio-Rad) of reference sample(s)
to  be analysed.</p>
</td></tr>
<tr><td><code id="dbscan_combination_+3A_system">system</code></td>
<td>
<p>character. The name of digital PCR system used to generate
the data. It must be either Thermo Fisher or Bio-Rad. Abbreviations are
also accepted.</p>
</td></tr>
<tr><td><code id="dbscan_combination_+3A_file.location">file.location</code></td>
<td>
<p>character. Full path name to reference and sample
files location. The default corresponds to the working directory,
(<code><a href="base.html#topic+getwd">getwd</a></code>). Tilde expansion (see
(<code><a href="base.html#topic+path.expand">path.expand</a></code>)) is performed.</p>
</td></tr>
<tr><td><code id="dbscan_combination_+3A_reference.quality">reference.quality</code></td>
<td>
<p>numeric. Between 0 and 1. Quality threshold
to subset the data (just for Thermo Fisher). If different thresholds have
to be applied to various reference samples, a vectror of the same length
of <code>refID</code> has to be provided.</p>
</td></tr>
<tr><td><code id="dbscan_combination_+3A_eps">eps</code></td>
<td>
<p>a numeric vector of values to be tested. Maximum distance
between elements within a cluster in a DBSCAN analysis.
See also <code><a href="dbscan.html#topic+dbscan">dbscan</a></code>.</p>
</td></tr>
<tr><td><code id="dbscan_combination_+3A_minpts">minPts</code></td>
<td>
<p>a numeric vector of values to be tested. Number of minimum
elements to assemble a cluster in a DBSCAN analysis.
See also <code><a href="dbscan.html#topic+dbscan">dbscan</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A pdf file containing the scatterplots of DBSCAN analysis performed
with all combinations of eps and minPts.
Each reference generates a different pdf file.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(dPCP)

#Find path of sample table and location of reference and input files
sampleTable &lt;- system.file("extdata", "Template_sampleTable.csv",
                     package = "dPCP")

fileLoc &lt;- system.file("extdata", package = "dPCP")

dbscan_combination("dilution20200313_B01_Amplitude.csv",
                   file.location = fileLoc, system = "bio-rad",
                   eps = c(150, 160, 180, 190), minPts = c(80, 100, 120))

unlink("dilution20200313_B01_Amplitude.pdf")

</code></pre>

<hr>
<h2 id='dPCP'>Automated analysis of digital PCR data</h2><span id='topic+dPCP'></span><span id='topic+plot.dPCP'></span>

<h3>Description</h3>

<p>This function carries out the autometed clustering of digital PCR data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dPCP(
  file,
  system = NULL,
  file.location = ".",
  reference.quality = 0.5,
  sample.quality = 0.5,
  eps = 200,
  minPts = 50,
  save.template = FALSE,
  rain = TRUE,
  QC.reference = FALSE,
  partition.volume = NULL
)

## S3 method for class 'dPCP'
plot(
  x,
  ...,
  sample = "all",
  reference = "all",
  type = "dPCP",
  color.blind = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dPCP_+3A_file">file</code></td>
<td>
<p>character. The name or the path of csv file to be read. If it
does not contain an absolute path, the file name is relative to the current
working directory, (<code><a href="base.html#topic+getwd">getwd</a></code>).</p>
</td></tr>
<tr><td><code id="dPCP_+3A_system">system</code></td>
<td>
<p>character. The name of digital PCR system used to generate
the data. It must be either Thermo Fisher or Bio-Rad. Abbreviations are
also accepted.</p>
</td></tr>
<tr><td><code id="dPCP_+3A_file.location">file.location</code></td>
<td>
<p>character. Full path name to reference and sample
files location. The default corresponds to the working directory,
(<code><a href="base.html#topic+getwd">getwd</a></code>). Tilde expansion (see
(<code><a href="base.html#topic+path.expand">path.expand</a></code>)) is performed.</p>
</td></tr>
<tr><td><code id="dPCP_+3A_reference.quality">reference.quality</code></td>
<td>
<p>numeric. Between 0 and 1. Quality threshold to
subset the data. If different thresholds have to be applied to various
reference samples, a vectror of the same length of number of reference
samples has to be provided. Used only when the <code>system</code> is Thermo
Fisher.</p>
</td></tr>
<tr><td><code id="dPCP_+3A_sample.quality">sample.quality</code></td>
<td>
<p>numeric. Between 0 and 1. Quality threshold to subset
data. If different thresholds have to be applied to various samples, a
vectror of the same length of number of samples has to be provided. Used
only when the <code>system</code> is Thermo Fisher.</p>
</td></tr>
<tr><td><code id="dPCP_+3A_eps">eps</code></td>
<td>
<p>numeric. Input parameter for the DBSCAN algorithm.
It represents the maximum distance between the elements within a cluster.
See also <code><a href="dbscan.html#topic+dbscan">dbscan</a></code>. If different values have to be
applied to various reference samples, a vectror of the same length of
number of reference samples has to be provided.</p>
</td></tr>
<tr><td><code id="dPCP_+3A_minpts">minPts</code></td>
<td>
<p>numeric. Input parameter for the DBSCAN algorithm.
It represents the number of minimum elements to assemble a cluster. See
also <code><a href="dbscan.html#topic+dbscan">dbscan</a></code>. If different values have to be
applied to various reference samples, a vectror of the same length of
number of reference samples has to be provided.</p>
</td></tr>
<tr><td><code id="dPCP_+3A_save.template">save.template</code></td>
<td>
<p>logical. If TRUE a template of DBSCAN analysis of
reference samples is saved. When <code>system</code> is Thermo Fisher,
<code>save.template</code> can be also a character vector indicating the chipID.</p>
</td></tr>
<tr><td><code id="dPCP_+3A_rain">rain</code></td>
<td>
<p>logical. If TRUE the rain analysis is carried out.</p>
</td></tr>
<tr><td><code id="dPCP_+3A_qc.reference">QC.reference</code></td>
<td>
<p>logical. If TRUE the fraction of rain elements in the
reference samples is carried out. Warning messages are displayed when the
percentage of rain is high.</p>
</td></tr>
<tr><td><code id="dPCP_+3A_partition.volume">partition.volume</code></td>
<td>
<p>numeric. This parameters is taken into account when
the parameter 'system' is set on Other. Indicate the partion volume in
microliters spcific to the digital PCR system.</p>
</td></tr>
<tr><td><code id="dPCP_+3A_x">x</code></td>
<td>
<p>an object of class <code>dPCP</code></p>
</td></tr>
<tr><td><code id="dPCP_+3A_...">...</code></td>
<td>
<p>Arguments to be passed to methods</p>
</td></tr>
<tr><td><code id="dPCP_+3A_sample">sample</code></td>
<td>
<p>'all' to show all samples, or a numeric vector indicating
the row number of samples in the sample table.</p>
</td></tr>
<tr><td><code id="dPCP_+3A_reference">reference</code></td>
<td>
<p>'all' to show all reference samples, or a character vector
with chip ID (Thermo Fisher) or the file name (Bio-rad) of reference
samples to be showed.</p>
</td></tr>
<tr><td><code id="dPCP_+3A_type">type</code></td>
<td>
<p>string. Type of plot to be showed. Available plots:
'reference dbscan', 'centers', 'cmeans', 'rain', 'dPCP'.
@param color.blind logical. If TRUE colors optimized for colorblind
readers are used.</p>
</td></tr>
<tr><td><code id="dPCP_+3A_color.blind">color.blind</code></td>
<td>
<p>logical. If TRUE colors optimized for colorblind readers
are used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>dPCP</code> containing the following components:
</p>
<table>
<tr><td><code>referenceDB</code></td>
<td>
<p>an object of class <code>reference_dbscan</code>.</p>
</td></tr>
<tr><td><code>samples</code></td>
<td>
<p>a list of samples. Each sample sublist contains the
information about the cluster analysis.</p>
</td></tr>
<tr><td><code>results</code></td>
<td>
<p>an object of class <code>replicates_quant</code>.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
library(dPCP)

#Find path of sample table and location of reference and input files
sampleTable &lt;- system.file("extdata", "Template_sampleTable.csv",
                     package = "dPCP")

fileLoc &lt;- system.file("extdata", package = "dPCP")

#dPCP analysis
results &lt;- dPCP(sampleTable, system = "bio-rad", file.location = fileLoc,
                eps = 200, minPts = 50, save.template = FALSE, rain = TRUE,
                QC.reference = FALSE)

plot(results, sample = 1, type = "dPCP")

</code></pre>

<hr>
<h2 id='export_csv'>Export dPCP analysis results to a csv file</h2><span id='topic+export_csv'></span>

<h3>Description</h3>

<p>This function exports dPCP analysis results to a csv file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>export_csv(data, filename)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="export_csv_+3A_data">data</code></td>
<td>
<p>an object of class <code>dPCP</code>, <code>target_quant</code> or
<code>replicates_quant</code>.</p>
</td></tr>
<tr><td><code id="export_csv_+3A_filename">filename</code></td>
<td>
<p>character. File name (no extension) for csv and pdf files to
create on disk.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A csv file with the information and results of dPCP analysis.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(dPCP)

#Find path of sample table and location of reference and input files
sampleTable &lt;- system.file("extdata", "Template_sampleTable.csv",
                     package = "dPCP")

fileLoc &lt;- system.file("extdata",package = "dPCP")

#dPCP analysis
results &lt;- dPCP(sampleTable, system = "bio-rad", file.location = fileLoc,
                eps = 200, minPts = 50, save.template = FALSE,
                rain = TRUE)

export_csv(results, filename = "dPCRproject_1")

</code></pre>

<hr>
<h2 id='manual_correction'>Manual correction of dPCP cluster analysis</h2><span id='topic+manual_correction'></span>

<h3>Description</h3>

<p>This function builds an interactive app to manually correct the dPCP
cluster analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>manual_correction(
  data,
  filename,
  save.plot = FALSE,
  format = "png",
  dpi = 300,
  color.blind = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="manual_correction_+3A_data">data</code></td>
<td>
<p>an object of class <code>dPCP</code>, inherited from
<code><a href="#topic+dPCP">dPCP</a></code>.</p>
</td></tr>
<tr><td><code id="manual_correction_+3A_filename">filename</code></td>
<td>
<p>character. File name (no extension) for csv and pdf files to
create on disk.</p>
</td></tr>
<tr><td><code id="manual_correction_+3A_save.plot">save.plot</code></td>
<td>
<p>logical. If TRUE the plots are exported to a file.</p>
</td></tr>
<tr><td><code id="manual_correction_+3A_format">format</code></td>
<td>
<p>a string indicating the file format for the export.
Available formats: 'eps', 'ps', 'tex', 'pdf', 'jpeg', 'tiff', 'png',
'bmp', 'svg', 'wmf'.</p>
</td></tr>
<tr><td><code id="manual_correction_+3A_dpi">dpi</code></td>
<td>
<p>numeric. Image resolution.</p>
</td></tr>
<tr><td><code id="manual_correction_+3A_color.blind">color.blind</code></td>
<td>
<p>logical. If TRUE colors optimized for colorblind
readers are used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A Shiny session.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(dPCP)

#Find path of sample table and location of reference and input files
sampleTable &lt;- system.file("extdata", "Template_sampleTable.csv",
                     package = "dPCP")

fileLoc &lt;- system.file("extdata",package = "dPCP")

#dPCP analysis
results &lt;- dPCP(sampleTable, system = "bio-rad", file.location = fileLoc,
                eps = 200, minPts = 50, save.template = FALSE,
                rain = TRUE)

manual_correction(results, filename = "manual_dPCR", save.plot = FALSE)

</code></pre>

<hr>
<h2 id='rain_reclus'>Identification and clustering of &quot;rain&quot; data</h2><span id='topic+rain_reclus'></span><span id='topic+plot.rain_reclus'></span>

<h3>Description</h3>

<p>This function identifies the &quot;rain&quot; elements and re-clusters them using the
Mahalanobis distance. Each &quot;rain&quot; element is assigned to the cluster whose
Mahalanobis distance is the lowest.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rain_reclus(cmeans.cluster)

## S3 method for class 'rain_reclus'
plot(x, ..., sample = "all", color.blind = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rain_reclus_+3A_cmeans.cluster">cmeans.cluster</code></td>
<td>
<p>an object of class <code>cmeans_clus</code>, inherited
from <code><a href="#topic+cmeans_clus">cmeans_clus</a></code>.</p>
</td></tr>
<tr><td><code id="rain_reclus_+3A_x">x</code></td>
<td>
<p>an object of class <code>rain_reclus</code></p>
</td></tr>
<tr><td><code id="rain_reclus_+3A_...">...</code></td>
<td>
<p>Arguments to be passed to methods</p>
</td></tr>
<tr><td><code id="rain_reclus_+3A_sample">sample</code></td>
<td>
<p>'all' to show all samples, or a numeric vector indicating
the row number of samples in the sample table.</p>
</td></tr>
<tr><td><code id="rain_reclus_+3A_color.blind">color.blind</code></td>
<td>
<p>logical. If TRUE colors optimized for colorblind readers
are used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>rain_reclus</code> containing a sublist for
each sample. Each sublist has the following components:
</p>
<table>
<tr><td><code>quality</code></td>
<td>
<p>quality threshold used in <code><a href="#topic+read_sample">read_sample</a></code>.</p>
</td></tr>
<tr><td><code>reference</code></td>
<td>
<p>reference ID.</p>
</td></tr>
<tr><td><code>centers</code></td>
<td>
<p>a data frame with the centroids coordinates.</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>a data frame with the fluorescence intensities and clusters
name.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
library(dPCP)

#Find path of sample table and location of reference and input files
sampleTable &lt;- system.file("extdata", "Template_sampleTable.csv",
                     package = "dPCP")

fileLoc &lt;- system.file("extdata",package = "dPCP")

#Read sample table file
sample.table &lt;- read_sampleTable(sampleTable, system = "bio-rad",
                                 file.location = fileLoc)

#Read reference files
ref &lt;- read_reference(sample.table, system = "bio-rad",
                      file.location = fileLoc)

#Read samples files
samp &lt;- read_sample(sample.table, system = "bio-rad",
                   file.location = fileLoc)

#Reference DBSCAN clustering
dbref &lt;- reference_dbscan(ref, sample.table, save.template = FALSE)

#Predict position of clusters centroid from reference DBSCAN results
cent &lt;- centers_data(samp, sample.table,dbref)

#Fuzzy c-means clustering
cmclus &lt;- cmeans_clus(cent)

#Rain classification.
rainclus &lt;- rain_reclus(cmclus)

plot(rainclus, sample = "all")

</code></pre>

<hr>
<h2 id='read_reference'>Read reference files</h2><span id='topic+read_reference'></span>

<h3>Description</h3>

<p>This function reads the results files of reference samples listed in the
sample table. Fluoresce intensity and quality value (just for Thermo Fisher)
are collected.
If a <code><a href="#topic+reference_dbscan">reference_dbscan</a></code> template file with the same input
paramters (reference ID, eps, minPts) is available, fluorescence data,
quality value and dbscan analysis results are retrived from the template
file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_reference(
  sample.table,
  system = NULL,
  file.location = ".",
  reference.quality = 0.5,
  eps = NULL,
  minPts = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read_reference_+3A_sample.table">sample.table</code></td>
<td>
<p>object of class <code>sample_table</code>, inherited from
<code><a href="#topic+read_sampleTable">read_sampleTable</a></code>.</p>
</td></tr>
<tr><td><code id="read_reference_+3A_system">system</code></td>
<td>
<p>character. The name of digital PCR system used to generate
the data. It must be either Thermo Fisher or Bio-Rad. Abbreviations are
also accepted.</p>
</td></tr>
<tr><td><code id="read_reference_+3A_file.location">file.location</code></td>
<td>
<p>character. Full path name to reference and sample
files location. The default corresponds to the working directory,
(<code><a href="base.html#topic+getwd">getwd</a></code>). Tilde expansion (see
(<code><a href="base.html#topic+path.expand">path.expand</a></code>)) is performed.</p>
</td></tr>
<tr><td><code id="read_reference_+3A_reference.quality">reference.quality</code></td>
<td>
<p>numeric. Between 0 and 1. Quality threshold to
subset the data. If different thresholds have to be applied to various
reference samples, a vectror of the same length of number of reference
samples has to be provided. Used only when the <code>system</code> is Thermo
Fisher.</p>
</td></tr>
<tr><td><code id="read_reference_+3A_eps">eps</code>, <code id="read_reference_+3A_minpts">minPts</code></td>
<td>
<p>numeric. Input parameters for the DBSCAN algorithm. If
they match the paramters of <code><a href="#topic+reference_dbscan">reference_dbscan</a></code> template file,
the data are retrived from the template.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>read_reference</code> containing a sublist for
each reference. Each sublist has the following components:
</p>
<table>
<tr><td><code>quality</code></td>
<td>
<p>value of the <code>reference.quality</code> parameter.</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>a matrix with the fluorescence intensities and quality
values.</p>
</td></tr>
<tr><td><code>dbscan</code></td>
<td>
<p>an object of class <code>dbscan_fast</code>, inherited from
<code><a href="dbscan.html#topic+dbscan">dbscan</a></code>. This component is available only if a
<code><a href="#topic+reference_dbscan">reference_dbscan</a></code> template file is used to retrive the
data.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>library(dPCP)

#Find path of sample table and location of reference and input files
sampleTable &lt;- system.file("extdata", "Template_sampleTable.csv",
                     package = "dPCP")

fileLoc &lt;- system.file("extdata", package = "dPCP")

#Read sample table file
sample.table &lt;- read_sampleTable(sampleTable, system = "bio-rad",
                                 file.location = fileLoc)

#Read reference files
ref &lt;- read_reference(sample.table, system = "bio-rad",
                      file.location = fileLoc)
</code></pre>

<hr>
<h2 id='read_sample'>Read sample files</h2><span id='topic+read_sample'></span>

<h3>Description</h3>

<p>This function reads the results files of samples listed in the sample table.
Fluoresce intensity and quality value (just for Thermo Fisher) are
collected.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_sample(
  sample.table,
  system = NULL,
  file.location = ".",
  sample.quality = 0.5,
  partition.volume = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read_sample_+3A_sample.table">sample.table</code></td>
<td>
<p>object of class <code>sample_table</code>, inherited from
<code><a href="#topic+read_sampleTable">read_sampleTable</a></code>.</p>
</td></tr>
<tr><td><code id="read_sample_+3A_system">system</code></td>
<td>
<p>character. The name of digital PCR system used to generate
the data. It must be either Thermo Fisher or Bio-Rad. Abbreviations are
also accepted.</p>
</td></tr>
<tr><td><code id="read_sample_+3A_file.location">file.location</code></td>
<td>
<p>character. Full path name to reference and sample
files location. The default corresponds to the working directory,
(<code><a href="base.html#topic+getwd">getwd</a></code>). Tilde expansion (see
(<code><a href="base.html#topic+path.expand">path.expand</a></code>)) is performed.</p>
</td></tr>
<tr><td><code id="read_sample_+3A_sample.quality">sample.quality</code></td>
<td>
<p>numeric. Between 0 and 1. Quality threshold to subset
data. If different thresholds have to be applied to various samples, a
vectror of the same length of number of samples has to be provided. Used
only when the <code>system</code> is Thermo Fisher.</p>
</td></tr>
<tr><td><code id="read_sample_+3A_partition.volume">partition.volume</code></td>
<td>
<p>numeric. This parameters is taken into account when
the parameter 'system' is set on Other. Indicate the partion volume in
microliters spcific to the digital PCR system.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>read_sample</code> containing a sublist for each
sample. Each sublist has the following components:
</p>
<table>
<tr><td><code>quality</code></td>
<td>
<p>value of the <code>sample.quality</code> parameter.</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>a matrix with the fluorescence intensities and quality
values.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>library(dPCP)

#Find path of sample table and location of reference and input files
sampleTable &lt;- system.file("extdata", "Template_sampleTable.csv",
                     package = "dPCP")

fileLoc &lt;- system.file("extdata", package = "dPCP")

#Read sample table file
sample.table &lt;- read_sampleTable(sampleTable, system = "bio-rad",
                                 file.location = fileLoc)

#Read reference files
ref &lt;- read_reference(sample.table, system = "bio-rad",
                      file.location = fileLoc)

#Read samples files
samp &lt;- read_sample(sample.table, system = "bio-rad",
                    file.location = fileLoc)
</code></pre>

<hr>
<h2 id='read_sampleTable'>Read sample table</h2><span id='topic+read_sampleTable'></span>

<h3>Description</h3>

<p>This function reads a file containing the essential information about the
samples and experimental settings. The file has to be filled out by the user
and formatted as described in the vignette.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_sampleTable(file, system = NULL, file.location = ".")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read_sampleTable_+3A_file">file</code></td>
<td>
<p>character. The name or the path of csv file to be read. If it
does not contain an absolute path, the file name is relative to the current
working directory, (<code><a href="base.html#topic+getwd">getwd</a></code>).</p>
</td></tr>
<tr><td><code id="read_sampleTable_+3A_system">system</code></td>
<td>
<p>character. The name of digital PCR system used to generate
the data. It must be either Thermo Fisher or Bio-Rad. Abbreviations are
also accepted.</p>
</td></tr>
<tr><td><code id="read_sampleTable_+3A_file.location">file.location</code></td>
<td>
<p>character. Full path name to reference and sample
files location. The default corresponds to the working directory,
(<code><a href="base.html#topic+getwd">getwd</a></code>). Tilde expansion (see
(<code><a href="base.html#topic+path.expand">path.expand</a></code>)) is performed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>sample_table</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(dPCP)

#Find path of sample table and location of reference and input files
sampleTable &lt;- system.file("extdata", "Template_sampleTable.csv",
                     package = "dPCP")

fileLoc &lt;- system.file("extdata", package = "dPCP")

#Read sample table file
sample.table &lt;- read_sampleTable(sampleTable, system = "bio-rad",
                                 file.location = fileLoc)
</code></pre>

<hr>
<h2 id='reference_dbscan'>Find the empty partitions and single target clusters in the reference sample</h2><span id='topic+reference_dbscan'></span><span id='topic+plot.reference_dbscan'></span>

<h3>Description</h3>

<p>This function computes a DBSCAN analysis to identify single target clusters
in the reference samples listed in the sample table.
If a <code><a href="#topic+reference_dbscan">reference_dbscan</a></code> template file with the same input
paramters (reference ID, eps, minPts) is available, data are retrived
from the template file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>reference_dbscan(
  reference.subquality,
  sample.table,
  eps = 200,
  minPts = 50,
  save.template = FALSE
)

## S3 method for class 'reference_dbscan'
plot(x, ..., reference = "all")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="reference_dbscan_+3A_reference.subquality">reference.subquality</code></td>
<td>
<p>an object of class <code>read_reference</code>,
inherited from <code><a href="#topic+read_reference">read_reference</a></code>.</p>
</td></tr>
<tr><td><code id="reference_dbscan_+3A_sample.table">sample.table</code></td>
<td>
<p>object of class <code>sample_table</code>, inherited from
<code><a href="#topic+read_sampleTable">read_sampleTable</a></code>.</p>
</td></tr>
<tr><td><code id="reference_dbscan_+3A_eps">eps</code>, <code id="reference_dbscan_+3A_minpts">minPts</code></td>
<td>
<p>numeric. Input parameters for the DBSCAN algorithm. If
they match the paramters of <code><a href="#topic+reference_dbscan">reference_dbscan</a></code> template file,
the data are retrived from the template.</p>
</td></tr>
<tr><td><code id="reference_dbscan_+3A_save.template">save.template</code></td>
<td>
<p>logical. If TRUE a template of DBSCAN analysis of
reference samples is saved. When <code>system</code> is Thermo Fisher,
<code>save.template</code> can be also a character vector indicating the chipID.</p>
</td></tr>
<tr><td><code id="reference_dbscan_+3A_x">x</code></td>
<td>
<p>an object of class <code>reference_dbscan</code></p>
</td></tr>
<tr><td><code id="reference_dbscan_+3A_...">...</code></td>
<td>
<p>Arguments to be passed to methods</p>
</td></tr>
<tr><td><code id="reference_dbscan_+3A_reference">reference</code></td>
<td>
<p>'all' to show all reference samples, or a character vector
with chip ID (Thermo Fisher) or the file name (Bio-rad) of reference
samples to be showed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>reference_dbscan</code> containing a sublist for
each reference. Each sublist has the following components:
</p>
<table>
<tr><td><code>quality</code></td>
<td>
<p>quality threshold used in <code><a href="#topic+read_reference">read_reference</a></code>.</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>a matrix with the fluorescence intensities and quality
values.</p>
</td></tr>
<tr><td><code>dbscan</code></td>
<td>
<p>an object of class <code>dbscan_fast</code>, inherited from
<code><a href="dbscan.html#topic+dbscan">dbscan</a></code>.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
library(dPCP)

#Find path of sample table and location of reference and input files
sampleTable &lt;- system.file("extdata", "Template_sampleTable.csv",
                     package = "dPCP")

fileLoc &lt;- system.file("extdata",package = "dPCP")

#Read sample table file
sample.table &lt;- read_sampleTable(sampleTable, system = "bio-rad",
                                 file.location = fileLoc)

#Read reference files
ref &lt;- read_reference(sample.table, system = "bio-rad",
                      file.location = fileLoc)

#Read samples files
samp &lt;- read_sample(sample.table, system = "bio-rad",
                    file.location = fileLoc)

#Reference DBSCAN clustering
dbref &lt;- reference_dbscan(ref, sample.table, save.template = FALSE)

plot(dbref, reference = "all")

</code></pre>

<hr>
<h2 id='replicates_quant'>Calculation of targets concentration, pooling the sample replicates</h2><span id='topic+replicates_quant'></span>

<h3>Description</h3>

<p>This function calculates the concentration of the targets, combining the
results of the replicates of each sample.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>replicates_quant(raw.results, sample.table)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="replicates_quant_+3A_raw.results">raw.results</code></td>
<td>
<p>an object of class <code>target_quant</code>, inherited
from <code><a href="#topic+target_quant">target_quant</a></code>.</p>
</td></tr>
<tr><td><code id="replicates_quant_+3A_sample.table">sample.table</code></td>
<td>
<p>object of class <code>sample_table</code>, inherited from
<code><a href="#topic+read_sampleTable">read_sampleTable</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>replicates_quant</code> containing a sublist for
every sample. Each sublist has the following components:
</p>
<table>
<tr><td><code>quality</code></td>
<td>
<p>quality threshold used in <code><a href="#topic+read_sample">read_sample</a></code>.</p>
</td></tr>
<tr><td><code>reference</code></td>
<td>
<p>reference ID.</p>
</td></tr>
<tr><td><code>raw results</code></td>
<td>
<p>a data frame with the results of quantification.</p>
</td></tr>
<tr><td><code>replicates results</code></td>
<td>
<p>a data frame with the results of quantification
of pooled replicates.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
library(dPCP)

#Find path of sample table and location of reference and input files
sampleTable &lt;- system.file("extdata", "Template_sampleTable.csv",
                     package = "dPCP")

fileLoc &lt;- system.file("extdata", package = "dPCP")

#Read sample table file
sample.table &lt;- read_sampleTable(sampleTable, system = "bio-rad",
                                 file.location = fileLoc)

#Read reference files
ref &lt;- read_reference(sample.table, system = "bio-rad",
                      file.location = fileLoc)

#Read samples files
samp &lt;- read_sample(sample.table, system = "bio-rad",
                   file.location = fileLoc)

#Reference DBSCAN clustering
dbref &lt;- reference_dbscan(ref, sample.table, save.template = FALSE)

#Predict position of clusters centroid from reference DBSCAN results
cent &lt;- centers_data(samp, sample.table,dbref)

#Fuzzy c-means clustering
cmclus &lt;- cmeans_clus(cent)

#Rain classification.
rainclus &lt;- rain_reclus(cmclus)

#Quantification
quantcm &lt;- target_quant(cmclus, sample.table)
quant &lt;- target_quant(rainclus, sample.table)

#Replicates pooling
rep.quant &lt;- replicates_quant(quant, sample.table)

</code></pre>

<hr>
<h2 id='report_dPCP'>Export dPCP analysis results to a pdf report</h2><span id='topic+report_dPCP'></span>

<h3>Description</h3>

<p>This function generates a pdf report of the dPCP analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>report_dPCP(data, filename, sample = "all", color.blind = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="report_dPCP_+3A_data">data</code></td>
<td>
<p>an object of class <code>dPCP</code>, inherited from
<code><a href="#topic+dPCP">dPCP</a></code>.</p>
</td></tr>
<tr><td><code id="report_dPCP_+3A_filename">filename</code></td>
<td>
<p>character. File name (no extension) for csv and pdf files to
create on disk.</p>
</td></tr>
<tr><td><code id="report_dPCP_+3A_sample">sample</code></td>
<td>
<p>'all' to show all samples, or a numeric vector indicating
the row number of samples in the sample table.</p>
</td></tr>
<tr><td><code id="report_dPCP_+3A_color.blind">color.blind</code></td>
<td>
<p>logical. If TRUE colors optimized for colorblind
readers are used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A pdf file with the information and results of the dPCP analysis.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(dPCP)

#Find path of sample table and location of reference and input files
sampleTable &lt;- system.file("extdata", "Template_sampleTable.csv",
                     package = "dPCP")

fileLoc &lt;- system.file("extdata", package = "dPCP")

#dPCP analysis
results &lt;- dPCP(sampleTable, system = "bio-rad", file.location = fileLoc,
                eps = 200, minPts = 50, save.template = FALSE,
                rain = TRUE)

report_dPCP(results, filename = "dPCRproject_1")

</code></pre>

<hr>
<h2 id='target_quant'>Calculation of targets concentration.</h2><span id='topic+target_quant'></span>

<h3>Description</h3>

<p>This function calculates the concentration of the targets according to the
Poisson distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>target_quant(data.cluster, sample.table)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="target_quant_+3A_data.cluster">data.cluster</code></td>
<td>
<p>an object of class <code>rain_reclus</code> or
<code>cmeans_clus</code>.</p>
</td></tr>
<tr><td><code id="target_quant_+3A_sample.table">sample.table</code></td>
<td>
<p>object of class <code>sample_table</code>, inherited from
<code><a href="#topic+read_sampleTable">read_sampleTable</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>target_quant</code> containing a sublist for
each sample. Each sublist has the following components:
</p>
<table>
<tr><td><code>quality</code></td>
<td>
<p>quality threshold used in <code><a href="#topic+read_sample">read_sample</a></code>.</p>
</td></tr>
<tr><td><code>reference</code></td>
<td>
<p>reference ID.</p>
</td></tr>
<tr><td><code>raw results</code></td>
<td>
<p>a data frame with the results of the quantification.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
library(dPCP)

#Find path of sample table and location of reference and input files
sampleTable &lt;- system.file("extdata", "Template_sampleTable.csv",
                     package = "dPCP")

fileLoc &lt;- system.file("extdata", package = "dPCP")

#Read sample table file
sample.table &lt;- read_sampleTable(sampleTable, system = "bio-rad",
                                 file.location = fileLoc)

#Read reference files
ref &lt;- read_reference(sample.table, system = "bio-rad",
                      file.location = fileLoc)

#Read samples files
samp &lt;- read_sample(sample.table, system = "bio-rad",
                    file.location = fileLoc)

#Reference DBSCAN clustering
dbref &lt;- reference_dbscan(ref, sample.table, save.template = FALSE)

#Predict position of clusters centroid from reference DBSCAN results
cent &lt;- centers_data(samp, sample.table,dbref)

#Fuzzy c-means clustering
cmclus &lt;- cmeans_clus(cent)

#Rain classification.
rainclus &lt;- rain_reclus(cmclus)

#Quantification
quantcm &lt;- target_quant(cmclus, sample.table)
quant &lt;- target_quant(rainclus, sample.table)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
