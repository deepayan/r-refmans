<!DOCTYPE html><html lang="en"><head><title>Help for package GFD</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {GFD}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#calculateGUI'><p>A graphical user interface for the package GFD</p></a></li>
<li><a href='#curdies'><p>Curdies river data set</p></a></li>
<li><a href='#GFD'><p>Tests for General Factorial Designs</p></a></li>
<li><a href='#GFD_GUI'><p>A shiny app for the package GFD</p></a></li>
<li><a href='#pizza'><p>Pizza delivery times</p></a></li>
<li><a href='#QANOVA'><p>QANOVA: Quantile-based analyis-of-variance</p></a></li>
<li><a href='#startup'><p>Startup Costs of five different companies</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Tests for General Factorial Designs</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-01-17</td>
</tr>
<tr>
<td>Author:</td>
<td>Sarah Friedrich, Frank Konietschke, Markus Pauly, Marc Ditzhaus, Philipp Steinhauer</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Sarah Friedrich &lt;sarah.friedrich@math.uni-augsburg.de&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.3)</td>
</tr>
<tr>
<td>Description:</td>
<td>Implemented are the Wald-type statistic,
    a permuted version thereof as well as the ANOVA-type statistic
    for general factorial designs, even with non-normal error terms
    and/or heteroscedastic variances, for crossed designs with an
    arbitrary number of factors and nested designs with up to three factors.
    Friedrich et al. (2017) &lt;<a href="https://doi.org/10.18637%2Fjss.v079.c01">doi:10.18637/jss.v079.c01</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>plyr (&ge; 1.8.3), MASS (&ge; 7.3-43), Matrix (&ge; 1.2-2), magic
(&ge; 1.5-6), plotrix (&ge; 3.5-12), methods, shiny (&ge; 1.4),
shinyjs, shinyWidgets, shinythemes, tippy</td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>Suggests:</td>
<td>RGtk2 (&ge; 2.20.31), knitr, rmarkdown, HSAUR</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.1</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-01-17 17:01:09 UTC; sfriedrich</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-01-18 07:52:51 UTC</td>
</tr>
</table>
<hr>
<h2 id='calculateGUI'>A graphical user interface for the package GFD</h2><span id='topic+calculateGUI'></span><span id='topic+GUI'></span>

<h3>Description</h3>

<p>This function provides a graphical user interface for calculating statistical
tests in general factorial designs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculateGUI()
</code></pre>


<h3>Details</h3>

<p>The function produces a GUI for the calculation of the test statistics and 
for plotting. Data can be loaded via the &quot;load data&quot; button. The formula, 
number of permutations (default: 10,000) and the significance level alpha
(default: 0.05) need to be specified. If the plot option is chosen, an
additional window opens containing information on the plots.
</p>

<hr>
<h2 id='curdies'>Curdies river data set</h2><span id='topic+curdies'></span>

<h3>Description</h3>

<p>A dataset containing the number of flatworms (dugesia) sampled in two seasons at different sites in the Curdies River in Western Victoria.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(curdies)
</code></pre>


<h3>Format</h3>

<p>A data frame with 36 rows and 3 variables:
</p>

<dl>
<dt>season</dt><dd><p>a factor with levels &quot;SUMMER&quot; and &quot;WINTER&quot;</p>
</dd>
<dt>site</dt><dd><p>a factor with levels 1 to 6, nested within &quot;season&quot;</p>
</dd>
<dt>dugesia</dt><dd><p>number of flatworms counted on a particular stone (in no./dm^2)</p>
</dd>
</dl>


<h3>Source</h3>

<p><a href="https://users.monash.edu.au/~murray/AIMS-R-users/ws/ws7.html">https://users.monash.edu.au/~murray/AIMS-R-users/ws/ws7.html</a>
</p>

<hr>
<h2 id='GFD'>Tests for General Factorial Designs</h2><span id='topic+GFD'></span>

<h3>Description</h3>

<p>The GFD function calculates the Wald-type statistic (WTS), the ANOVA-type 
statistic (ATS) as well as a permutation version of the WTS for general 
factorial designs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GFD(formula, data = NULL, nperm = 10000, alpha = 0.05,
  nested.levels.unique = FALSE, CI.method = "t-quantile")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GFD_+3A_formula">formula</code></td>
<td>
<p>A model <code><a href="stats.html#topic+formula">formula</a></code> object. The left hand side
contains the response variable and the right hand side contains the factor
variables of interest. An interaction term must be specified.</p>
</td></tr>
<tr><td><code id="GFD_+3A_data">data</code></td>
<td>
<p>A data.frame, list or environment containing the variables in 
<code>formula</code>. The default option is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="GFD_+3A_nperm">nperm</code></td>
<td>
<p>The number of permutations used for calculating the permuted 
Wald-type statistic. The default option is 10000.</p>
</td></tr>
<tr><td><code id="GFD_+3A_alpha">alpha</code></td>
<td>
<p>A number specifying the significance level; the default is 0.05.</p>
</td></tr>
<tr><td><code id="GFD_+3A_nested.levels.unique">nested.levels.unique</code></td>
<td>
<p>A logical specifying whether the levels of the nested factor(s)
are labeled uniquely or not. Default is FALSE, i.e., the levels of the nested 
factor are the same for each level of the main factor.</p>
</td></tr>
<tr><td><code id="GFD_+3A_ci.method">CI.method</code></td>
<td>
<p>Method for calculating the confidence intervals. Default is 't-quantile' for
CIs based on the corresponding t-quantile. Additionally, the quantile of the permutation 
distribution can be used ('perm').</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The package provides the Wald-type statistic, a permuted version
thereof as well as the ANOVA-type statistic for general factorial designs,
even with non-normal error terms and/or heteroscedastic variances. It is
implemented for both crossed and hierarchically nested designs and allows
for an arbitrary number of factor combinations as well as different sample
sizes in the crossed design.
The <code>GFD</code> function returns three p-values: One for the ATS based on an F-quantile and
two for the WTS, one based on the <code class="reqn">\chi^2</code>
distribution and one based on the permutation procedure.
Since the ATS is only an approximation and the WTS based on the <code class="reqn">\chi^2</code>
distribution is known 
to be very liberal for small sample sizes, we recommend to use the WTPS in these situations.
</p>


<h3>Value</h3>

<p>A <code>GFD</code> object containing the following components:
</p>
<table role = "presentation">
<tr><td><code>Descriptive</code></td>
<td>
<p>Some descriptive statistics of the data for all factor
level combinations. Displayed are the number of individuals per factor
level combination, the mean, variance and 100*(1-alpha)% confidence
intervals.</p>
</td></tr>
<tr><td><code>WTS</code></td>
<td>
<p>The value of the WTS along with degrees of freedom of the central chi-square distribution
and p-value, as well as the p-value of the permutation procedure.</p>
</td></tr>
<tr><td><code>ATS</code></td>
<td>
<p>The value of the ATS, degrees of freedom of the central F distribution and 
the corresponding p-value.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Friedrich, S., Konietschke, F., Pauly, M.(2017). GFD - An R-package
for the Analysis of General Factorial Designs. Journal of Statistical Software, Code Snippets 79(1), 
1&ndash;18, doi:10.18637/jss.v079.c01.
</p>
<p>Pauly, M., Brunner, E., Konietschke, F.(2015). Asymptotic Permutation Tests in General Factorial Designs. 
Journal of the Royal Statistical Society - Series B 77, 461-473.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(startup)
model &lt;- GFD(Costs ~ company, data = startup, CI.method = "perm")
summary(model)

</code></pre>

<hr>
<h2 id='GFD_GUI'>A shiny app for the package GFD</h2><span id='topic+GFD_GUI'></span><span id='topic+GFDsurvGUI'></span>

<h3>Description</h3>

<p>This function provides a shiny app for calculating
GFD and QANOVA test statistics and respective p-values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GFD_GUI()
</code></pre>


<h3>Author(s)</h3>

<p>Philipp Steinhauer
</p>

<hr>
<h2 id='pizza'>Pizza delivery times</h2><span id='topic+pizza'></span>

<h3>Description</h3>

<p>A dataset containing the delivery times for pizza (in minutes) under different conditions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(pizza)
</code></pre>


<h3>Format</h3>

<p>A data frame with 16 rows and 6 variables:
</p>

<dl>
<dt>Crust</dt><dd><p>a factor with levels &quot;thick&quot; and &quot;thin&quot;</p>
</dd>
<dt>Coke</dt><dd><p>whether or not Coke was ordered with the pizza (&quot;yes&quot; or &quot;no&quot;)</p>
</dd>
<dt>Bread</dt><dd><p>whether or not garlic bread was ordered with the pizza (&quot;yes&quot; or &quot;no&quot;)</p>
</dd>
<dt>Driver</dt><dd><p>the sex of the driver, a factor with levels &quot;M&quot; and &quot;F&quot;</p>
</dd>
<dt>Hour</dt><dd><p>time of order in hours after midnight</p>
</dd>
<dt>Delivery</dt><dd><p>Delivery time in minutes</p>
</dd>
</dl>


<h3>Source</h3>

<p><a href="http://www.statsci.org/data/oz/pizza.html">http://www.statsci.org/data/oz/pizza.html</a>
</p>

<hr>
<h2 id='QANOVA'>QANOVA: Quantile-based analyis-of-variance</h2><span id='topic+QANOVA'></span>

<h3>Description</h3>

<p>The function <code>qanova</code> calculates the Wald-type statistic based on the
quantiles and/or their linear combinations, e.g. the interquartile range. Respective p-values
are obtained by a <code class="reqn">\chi^2</code>-approximation and a permutation approach, respectively.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>QANOVA(formula, data = NULL, quantiles = c(0.5), lin_mat = NULL,
  var_method = "interval", nperm = 1999, var_level = 0.95,
  nested.levels.unique = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="QANOVA_+3A_formula">formula</code></td>
<td>
<p>A model <code>formula</code> object. The left hand side contains the response variable and the right
hand side contains the factor variables of interest. An interaction term must be
specified.</p>
</td></tr>
<tr><td><code id="QANOVA_+3A_data">data</code></td>
<td>
<p>A data.frame, list or environment containing the variables in formula
and the censoring status
indicator. Default option is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="QANOVA_+3A_quantiles">quantiles</code></td>
<td>
<p>A vector of probabilties corresponding to the quantiles of interest.
By default is c(0.5), i.e. just the median is included.</p>
</td></tr>
<tr><td><code id="QANOVA_+3A_lin_mat">lin_mat</code></td>
<td>
<p>A matrix specifying which linear combination of the quantiles should be
included for the analysis. By default (<code>NULL</code>) the identity matrix is chosen, i.e.
all chosen quantiles are considered simulatenously.</p>
</td></tr>
<tr><td><code id="QANOVA_+3A_var_method">var_method</code></td>
<td>
<p>Method for the variance estimation of the sample quantiles. The default
(&quot;interval&quot;) is the interval-based estimator of Price and Bonett (2001). Additionally, the bootstrap
method (&quot;boot&quot;) of Efron (1987) or a kernel density approach (&quot;kernel&quot;) can be chosen.</p>
</td></tr>
<tr><td><code id="QANOVA_+3A_nperm">nperm</code></td>
<td>
<p>The number of permutations used for calculating the permuted p-value.
The default option is 1999.</p>
</td></tr>
<tr><td><code id="QANOVA_+3A_var_level">var_level</code></td>
<td>
<p>A number between 0 and 1 specifying the confidence level for the
interval variance estimation method; the default value is 0.95.</p>
</td></tr>
<tr><td><code id="QANOVA_+3A_nested.levels.unique">nested.levels.unique</code></td>
<td>
<p>A logical specifying whether the levels of the nested
factor(s) are labeled uniquely or not.
Default is FALSE, i.e., the levels of the nested factor are the same for each
level of the main factor.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>qanova</code> function calculates the Wald-type statistic based on quantiles
and linear combinations of them for general factorial designs. The procedure is fully
nonparametric and no specific assumption of the underlying distribution is required.
In particular, heteroscedastic settings can be studied. The analysis can be based on a single
quantile (e.g. the median, default choice), a linear combination of quantiles (e.g. the
interquartile range, set <code>quantiles=c(0.25,0.75)</code> and <code>lin_mat = matrix(c(-1,1),ncol=2)</code>)
or on several (combinations of) quantiles simulatenously.
</p>
<p>The <code>qanova</code> function returns the test statistic as well as two
corresponding p-values: the first is based on a <code class="reqn">chi^2</code> approximation and
the second one is based on a permutation procedure.
</p>
<p>@return A <code>qanova</code> object containing the following components:
</p>

<ul>
<li><p>pvalues_statThe p-values obtained by <code class="reqn">\chi^2</code>-approximation
</p>
</li>
<li><p>pvalues_perThe p-values of the permutation approach
</p>
</li>
<li><p>statisticsThe value of the qanova along with degrees of freedom of the
central chi-square distribution and p-value, as well as the p-value of the
permutation procedure.
</p>
</li>
<li><p>npermThe number of permutations used for calculating the permuted p-value.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Philipp Steinhauer
</p>


<h3>References</h3>

<p>Ditzhaus, M., Fried, R. and Pauly, M. (2021). QANOVA: Quantile-based Permutation Methods For General
Factorial Designs. TEST (to appear, ArXiv preprint arXiv:1912.09146).
Efron, B. (1979). Bootstrap methods: Another look at the jackknife. Ann. Statist., 7:1-26.
Price, R. and Bonett, D. (2001). Estimating the variance of the sample median. J. Stat. Comput.
Simul, 68:295-305.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>QANOVA(weightgain ~ source*type, data = HSAUR::weightgain,var_method = "interval", nperm =199)

</code></pre>

<hr>
<h2 id='startup'>Startup Costs of five different companies</h2><span id='topic+startup'></span>

<h3>Description</h3>

<p>A dataset containing the startup costs (in thousands of dollars) of five companies.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(startup)
</code></pre>


<h3>Format</h3>

<p>A data frame with 60 rows and 2 variables:
</p>

<dl>
<dt>Costs</dt><dd><p>price, in thousands of dollars</p>
</dd>
<dt>company</dt><dd><p>company, a factor with levels &quot;pets&quot;, &quot;pizza&quot;, &quot;gifts&quot;, &quot;shoes&quot; and &quot;bakery&quot;</p>
</dd>
</dl>


<h3>Source</h3>

<p><a href="https://college.cengage.com/mathematics/brase/understandable_statistics/7e/students/datasets/owan/frames/frame.html">https://college.cengage.com/mathematics/brase/understandable_statistics/7e/students/datasets/owan/frames/frame.html</a>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
