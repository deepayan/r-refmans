<!DOCTYPE html><html lang="en"><head><title>Help for package lactcurves</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {lactcurves}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#AllCurves'>
<p>Lactation Curve Parameter Estimation</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Lactation Curve Parameter Estimation</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.0</td>
</tr>
<tr>
<td>Author:</td>
<td>Eva M. Strucken</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Eva M. Strucken &lt;eva.strucken@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>AllCurves() runs multiple lactation curve models and extracts selection criteria for each model.
  This package summarises the most common lactation curve models from the last century and provides a tool 
  for researchers to quickly decide on which model fits their data best to proceed with their analysis.
  Start parameters were optimized based on a dataset with 1.7 million Holstein-Friesian cows. If convergence fails, 
  the start parameters need to be manually adjusted.
  The models included in the package are taken from:
  (1) Michaelis-Menten: Michaelis, L. and M.L. Menten (1913).
      &lt;www.plantphys.info/plant_physiology/copyright/MichaelisMentenTranslation2.pdf&gt;
  (1a) Michaelis-Menten (Rook): Rook, A.J., J. France, and M.S. Dhanoa (1993).
      &lt;<a href="https://doi.org/10.1017%2FS002185960007684X">doi:10.1017/S002185960007684X</a>&gt;
  (1b) Michaelis-Menten + exponential (Rook): Rook, A.J., J. France, and M.S. Dhanoa (1993).
      &lt;<a href="https://doi.org/10.1017%2FS002185960007684X">doi:10.1017/S002185960007684X</a>&gt;
  (2) Brody (1923): Brody, S., A.C. Ragsdale, and C.W. Turner (1923).
      &lt;<a href="https://doi.org/10.1085%2Fjgp.5.6.777">doi:10.1085/jgp.5.6.777</a>&gt;
  (3) Brody (1924): Brody, S., C.W. Tuner, and A.C. Ragsdale (1924).
      <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2140670/">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2140670/</a>
  (4) Schumacher: Schumacher, F.X. (1939) in Thornley, J.H.M. and J. France (2007).
      <a href="https://books.google.com.au/books/about/Mathematical_Models_in_Agriculture.html?id=rlwBCRSHobcC&amp;amp;redir_esc=y">https://books.google.com.au/books/about/Mathematical_Models_in_Agriculture.html?id=rlwBCRSHobcC&amp;redir_esc=y</a>
  (4a) Schumacher (Lopez et al. 2015): Lopez, S. J. France, N.E. Odongo, R.A. McBride, E. Kebreab, O. AlZahal, B.W. McBride, and J. Dijkstra (2015).
      &lt;<a href="https://doi.org/10.3168%2Fjds.2014-8132">doi:10.3168/jds.2014-8132</a>&gt;
  (5) Parabolic exponential (Adediran): Adediran, S.A., D.A. Ratkowsky, D.J. Donaghy, and A.E.O. Malau-Aduli (2012).
      &lt;<a href="https://doi.org/10.3168%2Fjds.2011-4663">doi:10.3168/jds.2011-4663</a>&gt;
  (6) Wood: Wood, P.D.P. (1967).
      &lt;<a href="https://doi.org/10.1038%2F216164a0">doi:10.1038/216164a0</a>&gt;
  (6a) Wood reparameterized (Dhanoa): Dhanoa, M.S. (1981).
      &lt;<a href="https://doi.org/10.1017%2FS0003356100027276">doi:10.1017/S0003356100027276</a>&gt;
  (6b) Wood non-linear (Cappio-Borlino): Cappio-Borlino, A., G. Pulina, and G. Rossi (1995).
      &lt;<a href="https://doi.org/10.1016%2F0921-4488%2895%2900713-U">doi:10.1016/0921-4488(95)00713-U</a>&gt;
  (7) Quadratic Polynomial (Dave): Dave, B.K. (1971) in Adediran, S.A., D.A. Ratkowsky, D.J. Donaghy, and A.E.O. Malau-Aduli (2012).
      &lt;<a href="https://doi.org/10.3168%2Fjds.2011-4663">doi:10.3168/jds.2011-4663</a>&gt;
  (8) Cobby and Le Du (Vargas): Vargas, B., W.J. Koops, M. Herrero, and J.A.M Van Arendonk (2000).
      &lt;<a href="https://doi.org/10.3168%2Fjds.S0022-0302%2800%2975005-3">doi:10.3168/jds.S0022-0302(00)75005-3</a>&gt;
  (9) Papajcsik and Bodero 1: Papajcsik, I.A. and J. Bodero (1988).
      &lt;<a href="https://doi.org/10.1017%2FS0003356100003275">doi:10.1017/S0003356100003275</a>&gt;
  (10) Papajcsik and Bodero 2: Papajcsik, I.A. and J. Bodero (1988).
      &lt;<a href="https://doi.org/10.1017%2FS0003356100003275">doi:10.1017/S0003356100003275</a>&gt;
  (11) Papajcsik and Bodero 3: Papajcsik, I.A. and J. Bodero (1988).
      &lt;<a href="https://doi.org/10.1017%2FS0003356100003275">doi:10.1017/S0003356100003275</a>&gt;
  (12) Papajcsik and Bodero 4: Papajcsik, I.A. and J. Bodero (1988).
      &lt;<a href="https://doi.org/10.1017%2FS0003356100003275">doi:10.1017/S0003356100003275</a>&gt;
  (13) Papajcsik and Bodero 6: Papajcsik, I.A. and J. Bodero (1988).
      &lt;<a href="https://doi.org/10.1017%2FS0003356100003275">doi:10.1017/S0003356100003275</a>&gt;
  (14) Mixed log model 1 (Guo and Swalve): Guo, Z. and H.H. Swalve (1995).
      <a href="https://journal.interbull.org/index.php/ib/issue/view/11">https://journal.interbull.org/index.php/ib/issue/view/11</a>
  (15) Mixed log model 3 (Guo and Swalve): Guo, Z. and H.H. Swalve (1995).
      <a href="https://journal.interbull.org/index.php/ib/issue/view/11">https://journal.interbull.org/index.php/ib/issue/view/11</a>
  (16) Log-quadratic (Adediran et al. 2012): Adediran, S.A., D.A. Ratkowsky, D.J. Donaghy, and A.E.O. Malau-Aduli (2012).
      &lt;<a href="https://doi.org/10.3168%2Fjds.2011-4663">doi:10.3168/jds.2011-4663</a>&gt;
  (17) Wilmink: J.B.M. Wilmink (1987).
      &lt;<a href="https://doi.org/10.1016%2F0301-6226%2887%2990003-0">doi:10.1016/0301-6226(87)90003-0</a>&gt;
  (17a) modified Wilmink (Jakobsen): Jakobsen J.H., P. Madsen, J. Jensen, J. Pedersen, L.G. Christensen, and D.A. Sorensen (2002).
      &lt;<a href="https://doi.org/10.3168%2Fjds.S0022-0302%2802%2974231-8">doi:10.3168/jds.S0022-0302(02)74231-8</a>&gt;
  (17b) modified Wilmink (Laurenson &amp; Strucken): Strucken E.M., Brockmann G.A., and Y.C.S.M. Laurenson (2019).
      <a href="http://www.aaabg.org/aaabghome/AAABG23papers/35Strucken23139.pdf">http://www.aaabg.org/aaabghome/AAABG23papers/35Strucken23139.pdf</a>
  (18) Bicompartemental (Ferguson and Boston 1993): Ferguson, J.D., and R. Boston (1993) in Adediran, S.A., D.A. Ratkowsky, D.J. Donaghy, and A.E.O. Malau-Aduli (2012).
      &lt;<a href="https://doi.org/10.3168%2Fjds.2011-4663">doi:10.3168/jds.2011-4663</a>&gt;
  (19) Dijkstra: Dijkstra, J., J. France, M.S. Dhanoa, J.A. Maas, M.D. Hanigan, A.J. Rook, and D.E. Beever (1997).
      &lt;<a href="https://doi.org/10.3168%2Fjds.S0022-0302%2897%2976185-X">doi:10.3168/jds.S0022-0302(97)76185-X</a>&gt;
  (20) Morant and Gnanasakthy (Pollott et al 2000): Pollott, G.E. and E. Gootwine (2000).
      &lt;<a href="https://doi.org/10.1017%2FS1357729800055028">doi:10.1017/S1357729800055028</a>&gt;
  (21) Morant and Gnanasakthy (Vargas et al 2000): Vargas, B., W.J. Koops, M. Herrero, and J.A.M Van Arendonk (2000).
      &lt;<a href="https://doi.org/10.3168%2Fjds.S0022-0302%2800%2975005-3">doi:10.3168/jds.S0022-0302(00)75005-3</a>&gt;
  (22) Morant and Gnanasakthy (Adediran et al. 2012): Adediran, S.A., D.A. Ratkowsky, D.J. Donaghy, and A.E.O. Malau-Aduli (2012).
      &lt;<a href="https://doi.org/10.3168%2Fjds.2011-4663">doi:10.3168/jds.2011-4663</a>&gt;
  (23) Khandekar (Guo and Swalve): Guo, Z. and H.H. Swalve (1995).
      <a href="https://journal.interbull.org/index.php/ib/issue/view/11">https://journal.interbull.org/index.php/ib/issue/view/11</a>
  (24) Ali and Schaeffer: Ali, T.E. and L.R. Schaeffer (1987).
      <a href="https://cdnsciencepub.com/doi/pdf/10.4141/cjas87-067">https://cdnsciencepub.com/doi/pdf/10.4141/cjas87-067</a>
  (25) Fractional Polynomial (Elvira et al. 2013): Elvira, L., F. Hernandez, P. Cuesta, S. Cano, J.-V. Gonzalez-Martin, and S. Astiz (2012).
      &lt;<a href="https://doi.org/10.1017%2FS175173111200239X">doi:10.1017/S175173111200239X</a>&gt;
  (26) Pollott multiplicative (Elvira): Elvira, L., F. Hernandez, P. Cuesta, S. Cano, J.-V. Gonzalez-Martin, and S. Astiz (2012).
      &lt;<a href="https://doi.org/10.1017%2FS175173111200239X">doi:10.1017/S175173111200239X</a>&gt;
  (27) Pollott modified: Adediran, S.A., D.A. Ratkowsky, D.J. Donaghy, and A.E.O. Malau-Aduli (2012).
      &lt;<a href="https://doi.org/10.3168%2Fjds.2011-4663">doi:10.3168/jds.2011-4663</a>&gt;
  (28) Monophasic Grossman: Grossman, M. and W.J. Koops (1988).
      &lt;<a href="https://doi.org/10.3168%2Fjds.S0022-0302%2888%2979723-4">doi:10.3168/jds.S0022-0302(88)79723-4</a>&gt;
  (29) Monophasic Power Transformed (Grossman 1999): Grossman, M., S.M. Hartz, and W.J. Koops (1999).
      &lt;<a href="https://doi.org/10.3168%2Fjds.S0022-0302%2899%2975464-0">doi:10.3168/jds.S0022-0302(99)75464-0</a>&gt;
  (30) Diphasic (Grossman 1999): Grossman, M., S.M. Hartz, and W.J. Koops (1999).
      &lt;<a href="https://doi.org/10.3168%2Fjds.S0022-0302%2899%2975464-0">doi:10.3168/jds.S0022-0302(99)75464-0</a>&gt;
  (31) Diphasic Power Transformed (Grossman 1999): Grossman, M., S.M. Hartz, and W.J. Koops (1999).
      &lt;<a href="https://doi.org/10.3168%2Fjds.S0022-0302%2899%2975464-0">doi:10.3168/jds.S0022-0302(99)75464-0</a>&gt;
  (32) Legendre Polynomial (3th order): Jakobsen J.H., P. Madsen, J. Jensen, J. Pedersen, L.G. Christensen, and D.A. Sorensen (2002).
      &lt;<a href="https://doi.org/10.3168%2Fjds.S0022-0302%2802%2974231-8">doi:10.3168/jds.S0022-0302(02)74231-8</a>&gt;
  (33) Legendre Polynomial (4th order): Jakobsen J.H., P. Madsen, J. Jensen, J. Pedersen, L.G. Christensen, and D.A. Sorensen (2002).
      &lt;<a href="https://doi.org/10.3168%2Fjds.S0022-0302%2802%2974231-8">doi:10.3168/jds.S0022-0302(02)74231-8</a>&gt;
  (34) Legendre + Wilmink (Lidauer): Lidauer, M. and E.A. Mantysaari (1999).
      <a href="https://journal.interbull.org/index.php/ib/article/view/417">https://journal.interbull.org/index.php/ib/article/view/417</a>
  (35) Natural Cubic Spline (3 percentiles): White, I.M.S., R. Thompson, and S. Brotherstone (1999).
      &lt;<a href="https://doi.org/10.3168%2Fjds.S0022-0302%2899%2975277-X">doi:10.3168/jds.S0022-0302(99)75277-X</a>&gt;
  (36) Natural Cubic Spline (4 percentiles): White, I.M.S., R. Thompson, and S. Brotherstone (1999).
      &lt;<a href="https://doi.org/10.3168%2Fjds.S0022-0302%2899%2975277-X">doi:10.3168/jds.S0022-0302(99)75277-X</a>&gt;
  (37) Natural Cubic Spline (5 percentiles): White, I.M.S., R. Thompson, and S. Brotherstone (1999)
      &lt;<a href="https://doi.org/10.3168%2Fjds.S0022-0302%2899%2975277-X">doi:10.3168/jds.S0022-0302(99)75277-X</a>&gt;
  (38) Natural Cubic Spline (defined knots according to Harrell 2001): Jr. Harrell, F.E. (2001).
      <a href="https://link.springer.com/book/10.1007/978-3-319-19425-7">https://link.springer.com/book/10.1007/978-3-319-19425-7</a>
  The selection criteria measure the goodness of fit of the model and include:
  Residual standard error (RSE),
  R-square (R2),
  log likelihood,
  Akaike information criterion (AIC),
  Akaike information criterion corrected (AICC),
  Bayesian Information Criterion (BIC),
  Durbin Watson coefficient (DW).
  The following model parameters are included: 
  Residual sum of squares (RSS),
  Residual standard deviation (RSD),
  F-value (F) based on F-ratio test.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>polynom,orthopolynom,splines</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-01-14 23:10:36 UTC; estrucke</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-01-15 09:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='AllCurves'>
Lactation Curve Parameter Estimation
</h2><span id='topic+AllCurves'></span>

<h3>Description</h3>

<p>AllCurves runs multiple lactation curve models and extracts selection criteria (RSE, R2,
log likelihood, AIC, AICC, and BIC) for each model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AllCurves(x, trait, dim)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AllCurves_+3A_x">x</code></td>
<td>
<p>data frame containing londitudinal trait records	and time points of record collection</p>
</td></tr>
<tr><td><code id="AllCurves_+3A_trait">trait</code></td>
<td>
<p>specifies the column containing longitudinal trait records</p>
</td></tr>
<tr><td><code id="AllCurves_+3A_dim">dim</code></td>
<td>
<p>specifies the column containing time points</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Output
</p>
<table role = "presentation">
<tr><td><code>modelnames</code></td>
<td>
<p>provides names and order number of models</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>gives model equation, default starting parameters, and other model specifications</p>
</td></tr>
<tr><td><code>critall</code></td>
<td>
<p>gives selection criteria for all models sorted from best to worst accroding to specified criteria</p>
</td></tr>
<tr><td><code>modeldescrip</code></td>
<td>
<p>gives RSS, RSD, and F-value for each model</p>
</td></tr>
<tr><td><code>critbest</code></td>
<td>
<p>gives all selection	criteria for best model</p>
</td></tr>
<tr><td><code>bestmodel</code></td>
<td>
<p>gives model equation for best model for each selection criterion</p>
</td></tr>
<tr><td><code>Error</code></td>
<td>
<p>gives a Warning if model failed to converge</p>
</td></tr>
<tr><td><code>ModelParam</code></td>
<td>
<p>gives a list of three tables containing the converged model parameters</p>
</td></tr>
<tr><td><code>summary*</code></td>
<td>
<p>gives the summary of a particular model. summary1 for example give the summary of the first model by Michaelis and Menten</p>
</td></tr>
</table>


<h3>Citation</h3>

<p>Strucken, E.M. (2021). lactcurves: Lactation Curve Parameter Estimation. R package version 1.1.0
</p>


<h3>Note</h3>

<p>lactcurved requires installation of packages polynom, orthopolynom, and splines.
</p>
<p>In general, if a lactation curve model is linear, it can be fitted directly in a test-day (TD)
model. If lactation curve model is non-linear, parameters need to be estimated first and then
fitted in a TD model with other fixed and random effects if required.
</p>
<p>In lactcurves, starting parameters (defined in start) have been optimized across the first three
lactations of 1.7 million Holstein Friesian dairy cows. If a lactation curve model fails to
converge with other data, it is recommended to extract the model code and optimize the start values
for the new data.
</p>


<h3>Author(s)</h3>

<p>Eva M. Strucken
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## create data set for 3 individuals with milk yield records on 24 days

ID=c(rep("ID123",24),rep("ID456",24),rep("ID789",24))

dim=as.integer(rep(seq(from=5, to=340, by=14),3))

mkg=as.numeric(c(23.4,28.3,30.5,31.3,31.5,31.3,30.9,30.5,30.1,29.6,29.1,28.7,28.2,27.7,27.2,26.7,
26.2,25.7,25.2,24.7,24.2,23.7,23.2,22.8,
21.3,25.7,26.9,27.2,26.9,26.5,26.1,25.6,25.1,24.6,24.1,23.6,23.1,22.6,22.1,21.6,21.1,20.6,20.1,
19.6,19.1,18.6,18.1,17.6,
22.0,26.5,28.1,28.4,28.2,27.9,27.4,26.9,26.4,25.9,25.4,24.9,24.4,23.9,23.4,22.9,22.4,21.9,21.4,
20.9,20.4,19.9,19.4,18.9))

data=cbind.data.frame(ID,dim,mkg)

## run example

library(polynom)
library(orthopolynom)
library(splines)

output=AllCurves(data,mkg,dim)

output$critall
output$modeldescrip
output$critbest
output$bestmodel
output$Error
output$ModelParam
output$summary17b

## plot curve
# set the number of days to consider
dim=c(1:340)

# look up the model and its estimated parameters
output$summary17b

# use model and parameters to plot curve
plot(19.293701+(31.358471-19.293701)*(1-exp(1)^(-0.059874*dim))-0.035495*dim)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
