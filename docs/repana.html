<!DOCTYPE html><html><head><title>Help for package repana</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {repana}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#repana-package'><p>repana: Repeatable Analysis in R</p></a></li>
<li><a href='#addDataTable'><p>A wrap to <code>writeDataTable</code></p></a></li>
<li><a href='#clean_database'><p>Helper function to drop all tables from a database</p></a></li>
<li><a href='#clean_structure'><p>Clean the secondary files of the project</p></a></li>
<li><a href='#get_con'><p>Get a DBI connection reading a  configuration file</p></a></li>
<li><a href='#get_dirs'><p>Get the <code>dirs</code> section of the <code>config.yml</code> file</p></a></li>
<li><a href='#get_pool'><p>Get a pool connection reading a configuration file</p></a></li>
<li><a href='#insert_template'><p>RStudio addin app to insert a template to the heading part of a snip code</p></a></li>
<li><a href='#make_structure'><p>Make the structure for a new project</p></a></li>
<li><a href='#master'><p>Render programs</p></a></li>
<li><a href='#master_txt'><p>Runs the programs</p></a></li>
<li><a href='#render_report'><p>A wrap to render a markdown report</p></a></li>
<li><a href='#update_table'><p>Helper function to include a data.frame in the database and update the log</p></a></li>
<li><a href='#write_log'><p>Make a log of the updates on the database</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Repeatable Analysis in R</td>
</tr>
<tr>
<td>Version:</td>
<td>2.1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-01-20</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/johnaponte/repana">https://github.com/johnaponte/repana</a>,
<a href="https://johnaponte.github.io/repana/">https://johnaponte.github.io/repana/</a></td>
</tr>
<tr>
<td>Description:</td>
<td>Set of utilities to facilitate the reproduction of analysis in R.
 It allow to make_structure(), clean_structure(), and run and log programs in a
 predefined order to allow secondary files, analysis and reports be constructed in
 an ordered and reproducible form.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.0</td>
</tr>
<tr>
<td>Depends:</td>
<td>DBI (&ge; 1.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>spelling, testthat, knitr, RSQLite, RPostgres, duckdb, pacman</td>
</tr>
<tr>
<td>Imports:</td>
<td>config, dplyr, magrittr, lubridate, rmarkdown, processx,
readr, rstudioapi, pool, openxlsx, tools, yaml, digest</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-01-30 09:30:10 UTC; master</td>
</tr>
<tr>
<td>Author:</td>
<td>John J. Aponte <a href="https://orcid.org/0000-0002-3014-3673"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>John J. Aponte &lt;john.j.aponte@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-01-30 14:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='repana-package'>repana: Repeatable Analysis in R</h2><span id='topic+repana'></span><span id='topic+repana-package'></span>

<h3>Description</h3>

<p>Set of utilities to facilitate the reproduction of analysis in R. It allow to make_structure(), clean_structure(), and run and log programs in a predefined order to allow secondary files, analysis and reports be constructed in an ordered and reproducible form.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: John J. Aponte <a href="mailto:john.j.aponte@gmail.com">john.j.aponte@gmail.com</a> (<a href="https://orcid.org/0000-0002-3014-3673">ORCID</a>)
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/johnaponte/repana">https://github.com/johnaponte/repana</a>
</p>
</li>
<li> <p><a href="https://johnaponte.github.io/repana/">https://johnaponte.github.io/repana/</a>
</p>
</li></ul>


<hr>
<h2 id='addDataTable'>A wrap to <code><a href="openxlsx.html#topic+writeDataTable">writeDataTable</a></code></h2><span id='topic+addDataTable'></span>

<h3>Description</h3>

<p>Include a <code>data.frame</code> into a workbook applying a tableStyle and
an auto width to the column. For better results you could setup
<code>options("openxlsx.minWidth" = 6)</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>addDataTable(
  wb,
  df,
  sheet,
  tableName,
  tableStyle = "TableStyleMedium1",
  withFilter = TRUE,
  firstActiveCol = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="addDataTable_+3A_wb">wb</code></td>
<td>
<p>a workbook object</p>
</td></tr>
<tr><td><code id="addDataTable_+3A_df">df</code></td>
<td>
<p>a data.frame</p>
</td></tr>
<tr><td><code id="addDataTable_+3A_sheet">sheet</code></td>
<td>
<p>the sheet name. If missing the name of the data.frame</p>
</td></tr>
<tr><td><code id="addDataTable_+3A_tablename">tableName</code></td>
<td>
<p>a name for the table in the excel document. If missing the name of the data.frame</p>
</td></tr>
<tr><td><code id="addDataTable_+3A_tablestyle">tableStyle</code></td>
<td>
<p>a tableStyle name</p>
</td></tr>
<tr><td><code id="addDataTable_+3A_withfilter">withFilter</code></td>
<td>
<p>if TRUE the filter is included</p>
</td></tr>
<tr><td><code id="addDataTable_+3A_firstactivecol">firstActiveCol</code></td>
<td>
<p>First column active on the the freeze panel</p>
</td></tr>
<tr><td><code id="addDataTable_+3A_...">...</code></td>
<td>
<p>other parameters for the <code><a href="openxlsx.html#topic+writeDataTable">writeDataTable</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>silently the wb
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(openxlxs)
options("openxlsx.minWidth" = 6)
wb &lt;- createWorkbook(title = "Test addDataTable")
addDataTable(wb,iris)
saveWorkbook(wb, "test_addDataTable.xlsx")

## End(Not run)
</code></pre>

<hr>
<h2 id='clean_database'>Helper function to drop all tables from a database</h2><span id='topic+clean_database'></span>

<h3>Description</h3>

<p>Helper function to drop all tables from a database
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clean_database(con)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="clean_database_+3A_con">con</code></td>
<td>
<p>DBI connection</p>
</td></tr>
</table>


<h3>Value</h3>

<p>invisible, a lit with result from <code><a href="DBI.html#topic+dbRemoveTable">DBI</a></code>
</p>

<hr>
<h2 id='clean_structure'>Clean the secondary files of the project</h2><span id='topic+clean_structure'></span>

<h3>Description</h3>

<p>Delete and make new <code>database</code>, <code>logs</code> and <code>reports</code> directory
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clean_structure()
</code></pre>


<h3>Value</h3>

<p>Invisible, the directories defined by the  clean_before_new_analysis
entry in the config.yml file.
</p>


<h3>Author(s)</h3>

<p>John J. Aponte
</p>

<hr>
<h2 id='get_con'>Get a DBI connection reading a  configuration file</h2><span id='topic+get_con'></span>

<h3>Description</h3>

<p>This function get a DBI connection to a database reading the parameters from a
<code>config.yml</code> file using the <code><a href="config.html#topic+get">get</a></code> function.
See the vignette for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_con(configname = "defaultdb", file = "config.yml")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_con_+3A_configname">configname</code></td>
<td>
<p>a string with the name of the configuration</p>
</td></tr>
<tr><td><code id="get_con_+3A_file">file</code></td>
<td>
<p>name of the configuration to read from.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>DBI</code> connection
</p>


<h3>Author(s)</h3>

<p>John J. Aponte
</p>

<hr>
<h2 id='get_dirs'>Get the <code>dirs</code> section of the <code>config.yml</code> file</h2><span id='topic+get_dirs'></span>

<h3>Description</h3>

<p>It is a wrap of <code>config::get("dirs")</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_dirs(file = "config.yml")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_dirs_+3A_file">file</code></td>
<td>
<p>by default the <code>config.yml</code> file</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list with the directory entries
</p>

<hr>
<h2 id='get_pool'>Get a pool connection reading a configuration file</h2><span id='topic+get_pool'></span>

<h3>Description</h3>

<p>This function get a pool connection to a database reading the parameters from a
<code>config.yml</code> file using the <code><a href="config.html#topic+get">get</a></code> function.
See the vignette for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_pool(configname = "defaultdb", file = "config.yml")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_pool_+3A_configname">configname</code></td>
<td>
<p>a string with the name of the value</p>
</td></tr>
<tr><td><code id="get_pool_+3A_file">file</code></td>
<td>
<p>name of the configuration to read from.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code><a href="pool.html#topic+dbPool">dbPool</a></code> connection object
</p>


<h3>Author(s)</h3>

<p>John J. Aponte
</p>

<hr>
<h2 id='insert_template'>RStudio addin app to insert a template to the heading part of a snip code</h2><span id='topic+insert_template'></span>

<h3>Description</h3>

<p>RStudio addin app to insert a template to the heading part of a snip code
</p>


<h3>Usage</h3>

<pre><code class='language-R'>insert_template()
</code></pre>


<h3>Value</h3>

<p>The template to insert
</p>

<hr>
<h2 id='make_structure'>Make the structure for a new project</h2><span id='topic+make_structure'></span>

<h3>Description</h3>

<p>Make the following directories
</p>

<ul>
<li><p> data to keep the data necessary for the project
</p>
</li>
<li><p> database to keep the secondary, modified dataset and objects
</p>
</li>
<li><p> handmade to keep reports and dataset modified by hand or not make by the automatic stream
</p>
</li>
<li><p> logs  to keep logs of the automatic stream
</p>
</li>
<li><p> reports to keep the automatic reports
</p>
</li></ul>

<p>The <code>data</code>, <code>handmade</code> are not clean. The rest are clean as they
should be reproduced by the automatic stream. Do not forget to include them
in <code>.gitignore</code> if you use <code>git</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_structure()
</code></pre>


<h3>Value</h3>

<p>the <code>dir</code> structure
</p>


<h3>Author(s)</h3>

<p>John J. Aponte
</p>

<hr>
<h2 id='master'>Render programs</h2><span id='topic+master'></span>

<h3>Description</h3>

<p>By default, all programs with the pattern &quot;nn_&quot; will be executed in order.
The 'Start' and 'Stop' parameters can be used to modify the files to start or stop at
a different number.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>master(
  start = 0,
  stop = Inf,
  format = "html",
  logdir = config::get("dirs")$logs
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="master_+3A_start">start</code></td>
<td>
<p>program to start</p>
</td></tr>
<tr><td><code id="master_+3A_stop">stop</code></td>
<td>
<p>program to stop</p>
</td></tr>
<tr><td><code id="master_+3A_format">format</code></td>
<td>
<p>Format to render the programs values accepted are &quot;pdf&quot;, &quot;html&quot; and &quot;word&quot;</p>
</td></tr>
<tr><td><code id="master_+3A_logdir">logdir</code></td>
<td>
<p>directory to keep the logs of the files. By default
the entry on the <code>config.yml</code> <code>dirs:logs</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The files are treated as <em>snip</em> files for rmarkdown and render in the log
directory, with the format specified in the <em>format</em> parameter.
</p>
<p>The default the log directory is configured in the config.yml file.
</p>


<h3>Value</h3>

<p>a data.frame with the files run, running time and exit status
</p>

<hr>
<h2 id='master_txt'>Runs the programs</h2><span id='topic+master_txt'></span>

<h3>Description</h3>

<p>Run the programs specified by the pattern, in the order as the
pattern select the files. Keep a log of the results. By default
the pattern starting with two numbers and ending with .R is selected.
They are run in order
</p>


<h3>Usage</h3>

<pre><code class='language-R'>master_txt(
  pattern = "^[0-9][0-9].*\\.R$",
  start = 1,
  stop = Inf,
  logdir = config::get("dirs")$logs,
  rscript_path
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="master_txt_+3A_pattern">pattern</code></td>
<td>
<p>Regular expression to select the files to run</p>
</td></tr>
<tr><td><code id="master_txt_+3A_start">start</code></td>
<td>
<p>index of the program to start</p>
</td></tr>
<tr><td><code id="master_txt_+3A_stop">stop</code></td>
<td>
<p>index of the program to stop</p>
</td></tr>
<tr><td><code id="master_txt_+3A_logdir">logdir</code></td>
<td>
<p>directory to keep the logs of the files. By default</p>
</td></tr>
<tr><td><code id="master_txt_+3A_rscript_path">rscript_path</code></td>
<td>
<p>path to the <code>Rscript</code> file
the entry on the <code>config.yml</code> <code>dirs:logs</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The program add (or create if not exists) the files run, time of execution
and exit status in the file master.log of the directory logs.
</p>
<p>WARNING: This is a legacy program. Use master instead.
</p>


<h3>Value</h3>

<p>a data.frame with the files run, running time and exit status
</p>

<hr>
<h2 id='render_report'>A wrap to render a markdown report</h2><span id='topic+render_report'></span>

<h3>Description</h3>

<p>Render the report and copy it to the <code>outputdir</code> directory.
More formats are available but only three are included here
'
</p>


<h3>Usage</h3>

<pre><code class='language-R'>render_report(report, format = "pdf", outputdir = get_dirs()$reports, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="render_report_+3A_report">report</code></td>
<td>
<p>filename of the report</p>
</td></tr>
<tr><td><code id="render_report_+3A_format">format</code></td>
<td>
<p>output format. &quot;pdf&quot;,&quot;html&quot;,&quot;word&quot; are valid entries</p>
</td></tr>
<tr><td><code id="render_report_+3A_outputdir">outputdir</code></td>
<td>
<p>directory to save the  report</p>
</td></tr>
<tr><td><code id="render_report_+3A_...">...</code></td>
<td>
<p>other parameters for <code><a href="rmarkdown.html#topic+render">render</a></code> function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for side effects to render the reports
</p>


<h3>See Also</h3>

<p><code><a href="rmarkdown.html#topic+render">render</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
render_report(myreport.rmd,"pdf")

## End(Not run)

</code></pre>

<hr>
<h2 id='update_table'>Helper function to include a data.frame in the database and update the log</h2><span id='topic+update_table'></span>

<h3>Description</h3>

<p>Helper function to include a data.frame in the database and update the log
</p>


<h3>Usage</h3>

<pre><code class='language-R'>update_table(con, table, source, tablename)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="update_table_+3A_con">con</code></td>
<td>
<p>DBI connection</p>
</td></tr>
<tr><td><code id="update_table_+3A_table">table</code></td>
<td>
<p>the data.frame to be included in the database</p>
</td></tr>
<tr><td><code id="update_table_+3A_source">source</code></td>
<td>
<p>a manual comment to identify the source of the table</p>
</td></tr>
<tr><td><code id="update_table_+3A_tablename">tablename</code></td>
<td>
<p>if present, the data frame will be saved with this name.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the result from <code><a href="DBI.html#topic+dbWriteTable">DBI</a></code>
otherwise the name of the data.frame
</p>

<hr>
<h2 id='write_log'>Make a log of the updates on the database</h2><span id='topic+write_log'></span>

<h3>Description</h3>

<p>Make a log of the database updates. If the log table does not exists it creates it
Make a new entry with the timestamp of the update
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write_log(con, tablename, source)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="write_log_+3A_con">con</code></td>
<td>
<p>DBI connection</p>
</td></tr>
<tr><td><code id="write_log_+3A_tablename">tablename</code></td>
<td>
<p>the name of the table</p>
</td></tr>
<tr><td><code id="write_log_+3A_source">source</code></td>
<td>
<p>a manual comment to identify the source of the table</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the result from <code><a href="DBI.html#topic+dbWriteTable">DBI</a></code>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
