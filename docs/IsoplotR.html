<!DOCTYPE html><html><head><title>Help for package IsoplotR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {IsoplotR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#age'><p>Calculate isotopic ages</p></a></li>
<li><a href='#age2ratio'><p>Predict isotopic ratios from ages</p></a></li>
<li><a href='#agespectrum'><p>Plot a (40Ar/39Ar) release spectrum</p></a></li>
<li><a href='#cad'><p>Plot continuous data as cumulative age distributions</p></a></li>
<li><a href='#central'><p>Fits random effects models to overdispersed datasets</p></a></li>
<li><a href='#ci'><p>Confidence intervals</p></a></li>
<li><a href='#classes'><p>Geochronological data classes</p></a></li>
<li><a href='#concordia'><p>Concordia diagram</p></a></li>
<li><a href='#data2york'><p>Prepare geochronological data for York regression</p></a></li>
<li><a href='#discfilter'><p>Set up a discordance filter</p></a></li>
<li><a href='#diseq'><p>Set up U-series disequilibrium correction for U-Pb</p>
geochronology</a></li>
<li><a href='#diss'><p>Dissimilarity between detrital age distributions</p></a></li>
<li><a href='#ellipse'><p>Get error ellipse coordinates for plotting</p></a></li>
<li><a href='#evolution'><p>Th-U evolution diagram</p></a></li>
<li><a href='#examples'><p>Example datasets for testing <code>IsoplotR</code></p></a></li>
<li><a href='#helioplot'><p>Visualise U-Th-He data on a logratio plot or ternary diagram</p></a></li>
<li><a href='#isochron'><p>Calculate and plot isochrons</p></a></li>
<li><a href='#IsoplotR'><p>library(IsoplotR)</p></a></li>
<li><a href='#IsoplotR-internal'><p>Internal code objects</p></a></li>
<li><a href='#kde'><p>Create (a) kernel density estimate(s)</p></a></li>
<li><a href='#ludwig'><p>Linear regression of U-Pb data with correlated errors, taking</p>
into account decay constant uncertainties.</a></li>
<li><a href='#mclean'><p>Predict disequilibrium concordia compositions</p></a></li>
<li><a href='#mds'><p>Multidimensional Scaling</p></a></li>
<li><a href='#ogls'><p>Omnivariant Generalised Least-Squares Regression</p></a></li>
<li><a href='#Pb0corr'><p>Common Pb correction</p></a></li>
<li><a href='#peakfit'><p>Finite mixture modelling of geochronological datasets</p></a></li>
<li><a href='#radialplot'><p>Visualise heteroscedastic data on a radial plot</p></a></li>
<li><a href='#read.data'><p>Read geochronological data</p></a></li>
<li><a href='#scatterplot'><p>Create a scatter plot with error ellipses or crosses</p></a></li>
<li><a href='#set.zeta'><p>Calculate the zeta calibration coefficient for fission track dating</p></a></li>
<li><a href='#settings'><p>Retrieve and record global settings</p></a></li>
<li><a href='#titterington'><p>Linear regression of X,Y,Z-variables with correlated errors</p></a></li>
<li><a href='#weightedmean'><p>Calculate the weighted mean age</p></a></li>
<li><a href='#york'><p>Linear regression of X,Y-variables with correlated errors</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Statistical Toolbox for Radiometric Geochronology</td>
</tr>
<tr>
<td>Version:</td>
<td>6.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-02-16</td>
</tr>
<tr>
<td>Description:</td>
<td>Plots U-Pb data on Wetherill and Tera-Wasserburg concordia diagrams. Calculates concordia and discordia ages. Performs linear regression of measurements with correlated errors using 'York', 'Titterington', 'Ludwig' and Omnivariant Generalised Least-Squares ('OGLS') approaches. Generates Kernel Density Estimates (KDEs) and Cumulative Age Distributions (CADs). Produces Multidimensional Scaling (MDS) configurations and Shepard plots of multi-sample detrital datasets using the Kolmogorov-Smirnov distance as a dissimilarity measure. Calculates 40Ar/39Ar ages, isochrons, and age spectra. Computes weighted means accounting for overdispersion. Calculates U-Th-He (single grain and central) ages, logratio plots and ternary diagrams. Processes fission track data using the external detector method and LA-ICP-MS, calculates central ages and plots fission track and other data on radial (a.k.a. 'Galbraith') plots. Constructs total Pb-U, Pb-Pb, Th-Pb, K-Ca, Re-Os, Sm-Nd, Lu-Hf, Rb-Sr and 230Th-U isochrons as well as 230Th-U evolution plots.</td>
</tr>
<tr>
<td>Author:</td>
<td>Pieter Vermeesch [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Pieter Vermeesch &lt;p.vermeesch@ucl.ac.uk&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>MASS</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://www.ucl.ac.uk/~ucfbpve/isoplotr/">https://www.ucl.ac.uk/~ucfbpve/isoplotr/</a>,
<a href="https://github.com/pvermees/IsoplotR/">https://github.com/pvermees/IsoplotR/</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-16 20:21:58 UTC; pvermees</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-16 22:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='age'>Calculate isotopic ages</h2><span id='topic+age'></span><span id='topic+age.default'></span><span id='topic+age.UPb'></span><span id='topic+age.PbPb'></span><span id='topic+age.ArAr'></span><span id='topic+age.KCa'></span><span id='topic+age.UThHe'></span><span id='topic+age.fissiontracks'></span><span id='topic+age.ThU'></span><span id='topic+age.ThPb'></span><span id='topic+age.ReOs'></span><span id='topic+age.SmNd'></span><span id='topic+age.RbSr'></span><span id='topic+age.LuHf'></span><span id='topic+age.PD'></span>

<h3>Description</h3>

<p>Calculates U-Pb, Pb-Pb, Th-Pb, Ar-Ar, K-Ca, Re-Os, Sm-Nd, Rb-Sr, Lu-Hf,
U-Th-He, Th-U and fission track ages and propagates their
analytical uncertainties. Includes options for single grain,
isochron and concordia ages.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>age(x, ...)

## Default S3 method:
age(
  x,
  method = "U238-Pb206",
  oerr = 1,
  sigdig = NA,
  exterr = FALSE,
  J = c(NA, NA),
  zeta = c(NA, NA),
  rhoD = c(NA, NA),
  d = diseq(),
  ...
)

## S3 method for class 'UPb'
age(
  x,
  type = 1,
  exterr = FALSE,
  i = NULL,
  oerr = 1,
  sigdig = NA,
  common.Pb = 0,
  discordance = discfilter(),
  ...
)

## S3 method for class 'PbPb'
age(
  x,
  isochron = TRUE,
  common.Pb = 2,
  exterr = FALSE,
  i = NULL,
  oerr = 1,
  sigdig = NA,
  projerr = FALSE,
  ...
)

## S3 method for class 'ArAr'
age(
  x,
  isochron = FALSE,
  i2i = TRUE,
  exterr = FALSE,
  i = NULL,
  oerr = 1,
  sigdig = NA,
  projerr = FALSE,
  ...
)

## S3 method for class 'KCa'
age(
  x,
  isochron = FALSE,
  i2i = TRUE,
  exterr = FALSE,
  i = NULL,
  oerr = 1,
  sigdig = NA,
  projerr = FALSE,
  ...
)

## S3 method for class 'UThHe'
age(x, isochron = FALSE, central = FALSE, i = NULL, oerr = 1, sigdig = NA, ...)

## S3 method for class 'fissiontracks'
age(x, central = FALSE, i = NULL, oerr = 1, sigdig = NA, exterr = FALSE, ...)

## S3 method for class 'ThU'
age(
  x,
  isochron = FALSE,
  Th0i = 0,
  exterr = FALSE,
  i = NULL,
  oerr = 1,
  sigdig = NA,
  ...
)

## S3 method for class 'ThPb'
age(
  x,
  isochron = TRUE,
  i2i = TRUE,
  exterr = FALSE,
  i = NULL,
  oerr = 1,
  sigdig = NA,
  projerr = FALSE,
  ...
)

## S3 method for class 'ReOs'
age(
  x,
  isochron = TRUE,
  i2i = TRUE,
  exterr = FALSE,
  i = NULL,
  oerr = 1,
  sigdig = NA,
  projerr = FALSE,
  ...
)

## S3 method for class 'SmNd'
age(
  x,
  isochron = TRUE,
  i2i = TRUE,
  exterr = FALSE,
  i = NULL,
  oerr = 1,
  sigdig = NA,
  projerr = FALSE,
  ...
)

## S3 method for class 'RbSr'
age(
  x,
  isochron = TRUE,
  i2i = TRUE,
  exterr = FALSE,
  i = NULL,
  oerr = 1,
  sigdig = NA,
  projerr = FALSE,
  ...
)

## S3 method for class 'LuHf'
age(
  x,
  isochron = TRUE,
  i2i = TRUE,
  exterr = FALSE,
  i = NULL,
  oerr = 1,
  sigdig = NA,
  projerr = FALSE,
  ...
)

## S3 method for class 'PD'
age(
  x,
  nuclide,
  isochron = TRUE,
  i2i = TRUE,
  exterr = FALSE,
  i = NULL,
  oerr = 1,
  sigdig = NA,
  projerr = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="age_+3A_x">x</code></td>
<td>
<p>can be:
</p>

<ul>
<li><p> a scalar containing an isotopic ratio,
</p>
</li>
<li><p> a two element vector containing an isotopic ratio and its standard
error, or the spontaneous and induced track densities <code>Ns</code> and
<code>Ni</code>,
</p>
</li>
<li><p> a two element vector containing <code>Ar40Ar39</code>,
<code>s[Ar40Ar39]</code>,
</p>
</li>
<li><p> a two element vector containing <code>K40Ca40</code> and
<code>s[K40Ca40]</code>,
</p>
</li>
<li><p> a six element vector containing <code>U</code>, <code>s[U]</code>, <code>Th</code>,
<code>s[Th]</code>, <code>He</code> and <code>s[He]</code>,
</p>
</li>
<li><p> an eight element vector containing <code>U</code>, <code>s[U]</code>,
<code>Th</code>, <code>s[Th]</code>, <code>He</code>, <code>s[He]</code>, <code>Sm</code> and
<code>s[Sm]</code>
</p>
</li>
<li><p> a two element vector containing <code>Sr87Rb87</code> and
<code>s[Sr87Rb87]</code>
</p>
</li>
<li><p> a two element vector containing <code>Os187Re187</code> and
<code>s[Os187Re187]</code>
</p>
</li>
<li><p> a two element vector containing <code>Nd143Sm147</code> and
<code>s[Nd144Sm147]</code>
</p>
</li>
<li><p> a two element vector containing <code>Hf176Lu176</code> and
<code>s[Hf176Lu176]</code>
</p>
</li>
<li><p> a five element vector containing <code>Th230U238</code>, <code>s[Th230/U238]</code>,
<code>U234U238</code>, <code>s[U234U238]</code> and <code>cov[Th230U238,U234U238]</code>
</p>
</li></ul>

<p>OR
</p>
 <ul>
<li><p> an object of class <code>UPb</code>, <code>PbPb</code>,
<code>ThPb</code>, <code>ArAr</code>, <code>KCa</code>, <code>ThU</code>, <code>RbSr</code>,
<code>SmNd</code>, <code>ReOs</code>, <code>LuHf</code>, <code>UThHe</code> or
<code>fissiontracks</code>.  </p>
</li></ul>
</td></tr>
<tr><td><code id="age_+3A_...">...</code></td>
<td>
<p>additional arguments</p>
</td></tr>
<tr><td><code id="age_+3A_method">method</code></td>
<td>
<p>one of either <code>'U238-Pb206'</code>,
<code>'U235-Pb207'</code>, <code>'Pb207-Pb206'</code>,
<code>'Th232-Pb208'</code>, <code>'Ar-Ar'</code>, <code>'K-Ca'</code>,
<code>'Th-U'</code>, <code>'Re-Os'</code>, <code>'Sm-Nd'</code>, <code>'Rb-Sr'</code>,
<code>'Lu-Hf'</code>, <code>'U-Th-He'</code> or <code>'fissiontracks'</code></p>
</td></tr>
<tr><td><code id="age_+3A_oerr">oerr</code></td>
<td>
<p>indicates whether the analytical uncertainties of the
output are reported as:
</p>
<p><code>1</code>: 1<code class="reqn">\sigma</code> absolute uncertainties.
</p>
<p><code>2</code>: 2<code class="reqn">\sigma</code> absolute uncertainties.
</p>
<p><code>3</code>: absolute (1-<code class="reqn">\alpha</code>)% confidence intervals, where
<code class="reqn">\alpha</code> equales the value that is stored in
<code>settings('alpha')</code>.
</p>
<p><code>4</code>: 1<code class="reqn">\sigma</code> relative uncertainties (<code class="reqn">\%</code>).
</p>
<p><code>5</code>: 2<code class="reqn">\sigma</code> relative uncertainties (<code class="reqn">\%</code>).
</p>
<p><code>6</code>: relative (1-<code class="reqn">\alpha</code>)% confidence intervals, where
<code class="reqn">\alpha</code> equales the value that is stored in
<code>settings('alpha')</code>.
</p>
<p>(only used when <code>isochron</code> and <code>central</code> are <code>FALSE</code>)</p>
</td></tr>
<tr><td><code id="age_+3A_sigdig">sigdig</code></td>
<td>
<p>number of significant digits for the uncertainty
estimate (only used if <code>type=1</code>, <code>isochron=FALSE</code> and
<code>central=FALSE</code>).</p>
</td></tr>
<tr><td><code id="age_+3A_exterr">exterr</code></td>
<td>
<p>propagate the external (decay constant and
calibration factor) uncertainties?</p>
</td></tr>
<tr><td><code id="age_+3A_j">J</code></td>
<td>
<p>two-element vector with the J-factor and its standard
error.</p>
</td></tr>
<tr><td><code id="age_+3A_zeta">zeta</code></td>
<td>
<p>two-element vector with the zeta-factor and its standard
error.</p>
</td></tr>
<tr><td><code id="age_+3A_rhod">rhoD</code></td>
<td>
<p>two-element vector with the track density of the
dosimeter glass and its standard error.</p>
</td></tr>
<tr><td><code id="age_+3A_d">d</code></td>
<td>
<p>an object of class <code><a href="#topic+diseq">diseq</a></code>.</p>
</td></tr>
<tr><td><code id="age_+3A_type">type</code></td>
<td>
<p>scalar flag indicating whether
</p>
<p><code>1</code>: each U-Pb analysis should be considered separately,
</p>
<p><code>2</code>: all the measurements should be combined to calculate a
concordia age,
</p>
<p><code>3</code>: a discordia line should be fitted through all the U-Pb
analyses using the maximum likelihood algorithm of Ludwig
(1998), which assumes that the scatter of the data is solely
due to the analytical uncertainties.
</p>
<p><code>4</code>: a discordia line should be fitted ignoring the analytical
uncertainties.
</p>
<p><code>5</code>: a discordia line should be fitted using a modified
maximum likelihood algorithm that accounts for overdispersion by
adding a geological (co)variance term.</p>
</td></tr>
<tr><td><code id="age_+3A_i">i</code></td>
<td>
<p>index of a particular aliquot</p>
</td></tr>
<tr><td><code id="age_+3A_common.pb">common.Pb</code></td>
<td>
<p>common lead correction:
</p>
<p><code>0</code>: none
</p>
<p><code>1</code>: use the Pb-composition stored in
</p>
<p><code>settings('iratio','Pb207Pb206')</code> (if <code>x</code> has class
<code>UPb</code> and <code>x$format&lt;4</code>);
</p>
<p><code>settings('iratio','Pb206Pb204')</code> and
<code>settings('iratio','Pb207Pb204')</code> (if <code>x</code> has class
<code>PbPb</code> or <code>x</code> has class <code>UPb</code> and
<code>3&lt;x$format&lt;7</code>); or
</p>
<p><code>settings('iratio','Pb206Pb208')</code> and
<code>settings('iratio','Pb207Pb208')</code> (if <code>x</code> has class
<code>UPb</code> and <code>x$format=7</code> or <code>8</code>).
</p>
<p><code>2</code>: use the isochron intercept as the initial Pb-composition
</p>
<p><code>3</code>: use the Stacey-Kramer two-stage model to infer the initial
Pb-composition</p>
</td></tr>
<tr><td><code id="age_+3A_discordance">discordance</code></td>
<td>
<p>discordance calculator. This is an object of
class <code><a href="#topic+discfilter">discfilter</a></code>, or a two element list
containing:
</p>
<p><code>option</code>: one of
</p>
<p><code>1</code> or <code>'t'</code> (absolute age filter);
</p>
<p><code>2</code> or <code>'r'</code> (relative age filter);
</p>
<p><code>3</code> or <code>'sk'</code> (Stacey-Kramers common Pb filter);
</p>
<p><code>4</code> or <code>'a'</code> (perpendicular Aitchison distance);
</p>
<p><code>5</code> or <code>'c'</code> (concordia distance);
</p>
<p><code>6</code> or <code>'p'</code> (p-value of concordance); or
</p>
<p><code>NA</code> (omit the discordance from the output)
</p>
<p><code>before</code>: logical flag indicating whether the discordance
should be calculated before (<code>TRUE</code>) or after (<code>FALSE</code>)
the common-Pb correction.</p>
</td></tr>
<tr><td><code id="age_+3A_isochron">isochron</code></td>
<td>
<p>logical flag indicating whether each analysis
should be considered separately (<code>isochron=FALSE</code>) or an
isochron age should be calculated from all analyses together
(<code>isochron=TRUE</code>).</p>
</td></tr>
<tr><td><code id="age_+3A_projerr">projerr</code></td>
<td>
<p>logical. If <code>TRUE</code>, propagates the uncertainty
of the non-radiogenic isotope correction (the 'projection
error') into the age uncertainty. Note that the resulting
single grain age uncertainties may be strongly correlated with
each other, but these error correlations are not reported in
the output.</p>
</td></tr>
<tr><td><code id="age_+3A_i2i">i2i</code></td>
<td>
<p>&lsquo;isochron to intercept&rsquo;: calculates the initial (aka
&lsquo;inherited&rsquo;, &lsquo;excess&rsquo;, or &lsquo;common&rsquo;)
<code class="reqn">^{40}</code>Ar/<code class="reqn">^{36}</code>Ar, <code class="reqn">^{40}</code>Ca/<code class="reqn">^{44}</code>Ca,
<code class="reqn">^{87}</code>Sr/<code class="reqn">^{86}</code>Sr, <code class="reqn">^{143}</code>Nd/<code class="reqn">^{144}</code>Nd,
<code class="reqn">^{187}</code>Os/<code class="reqn">^{188}</code>Os, <code class="reqn">^{176}</code>Hf/<code class="reqn">^{177}</code>Hf or
<code class="reqn">^{204}</code>Pb/<code class="reqn">^{208}</code>Pb ratio from an isochron
fit. Setting <code>i2i</code> to <code>FALSE</code> uses the default values
stored in <code>settings('iratio',...)</code>.</p>
</td></tr>
<tr><td><code id="age_+3A_central">central</code></td>
<td>
<p>logical flag indicating whether each analysis should
be considered separately (<code>central=FALSE</code>) or a central
age should be calculated from all analyses together
(<code>central=TRUE</code>).</p>
</td></tr>
<tr><td><code id="age_+3A_th0i">Th0i</code></td>
<td>
<p>initial <code class="reqn">^{230}</code>Th correction.
</p>
<p><code>0</code>: no correction
</p>
<p><code>1</code>: project the data along an isochron fit
</p>
<p><code>2</code>: if <code>x$format</code> is <code>1</code> or <code>2</code>, correct the
data using the measured present day <code class="reqn">^{230}</code>Th/<code class="reqn">^{238}</code>U,
<code class="reqn">^{232}</code>Th/<code class="reqn">^{238}</code>U and <code class="reqn">^{234}</code>U/<code class="reqn">^{238}</code>U
activity ratios in the detritus. If <code>x$format</code> is <code>3</code> or
<code>4</code>, correct the data using the measured
<code class="reqn">^{238}</code>U/<code class="reqn">^{232}</code>Th activity ratio of the whole rock, as
stored in <code>x</code> by the <code>read.data()</code> function.
</p>
<p><code>3</code>: correct the data using an assumed initial
<code class="reqn">^{230}</code>Th/<code class="reqn">^{232}</code>Th-ratio for the detritus (only relevant
if <code>x$format</code> is <code>1</code> or <code>2</code>).</p>
</td></tr>
<tr><td><code id="age_+3A_nuclide">nuclide</code></td>
<td>
<p>a text string corresponding to a valid entry for
<code>settings('lambda',...)</code></p>
</td></tr>
</table>


<h3>Value</h3>


<ol>
<li><p> if <code>x</code> is a scalar or a vector, returns the age using
the geochronometer given by <code>method</code> and its standard error.
</p>
</li>
<li><p> if <code>x</code> has class <code>UPb</code> and <code>type=1</code>, returns a
table with the following columns: <code>t.75</code>, <code>err[t.75]</code>,
<code>t.68</code>, <code>err[t.68]</code>, <code>t.76</code>, <code>err[t.76]</code>,
(<code>t.82</code>, <code>err[t.82]</code>,) <code>t.conc</code>, <code>err[t.conc]</code>,
(<code>disc</code>) or <code>err[p.conc]</code>,) containing the
<code class="reqn">^{207}</code>Pb/<code class="reqn">^{235}</code>U-age and standard error, the
<code class="reqn">^{206}</code>Pb/<code class="reqn">^{238}</code>U-age and standard error, the
<code class="reqn">^{207}</code>Pb/<code class="reqn">^{206}</code>Pb-age and standard error, (the
<code class="reqn">^{208}</code>Pb/<code class="reqn">^{232}</code>Th-age and standard error,) the single
grain concordia age and standard error, (and the % discordance or
p-value for concordance,) respectively.
</p>
</li>
<li><p> if <code>x</code> has class <code>UPb</code> and <code>type=2, 3, 4</code> or
<code>5</code>, returns the output of the <code><a href="#topic+concordia">concordia</a></code>
function.
</p>
</li>
<li><p> if <code>x</code> has class <code>PbPb</code>, <code>ThPb</code>, <code>ArAr</code>,
<code>KCa</code>, <code>RbSr</code>, <code>SmNd</code>, <code>ReOs</code>, <code>LuHf</code>,
<code>ThU</code> or <code>UThHe</code> and <code>isochron=FALSE</code>, returns a
table of Pb-Pb, Th-Pb, Ar-Ar, K-Ca, Rb-Sr, Sm-Nd, Re-Os, Lu-Hf,
Th-U or U-Th-He ages and their standard errors.
</p>
</li>
<li><p> if <code>x</code> has class <code>ThU</code> and <code>isochron=FALSE</code>,
returns a 5-column table with the Th-U ages, their standard errors,
the initial <code class="reqn">^{234}</code>U/<code class="reqn">^{238}</code>U-ratios, their standard errors,
and the correlation coefficient between the ages and the initial
ratios.
</p>
</li>
<li><p> if <code>x</code> has class <code>PbPb</code>, <code>ThPb</code>, <code>ArAr</code>,
<code>KCa</code>, <code>RbSr</code>, <code>SmNd</code>, <code>ReOs</code>, <code>LuHf</code>,
<code>UThHe</code> or <code>ThU</code> and <code>isochron=TRUE</code>, returns the
output of the <code><a href="#topic+isochron">isochron</a></code> function.
</p>
</li>
<li><p> if <code>x</code> has class <code>fissiontracks</code> and
<code>central=FALSE</code>, returns a table of fission track ages and
standard errors.
</p>
</li>
<li><p> if <code>x</code> has class <code>fissiontracks</code> or <code>UThHe</code>
and <code>central=TRUE</code>, returns the output of the
<code><a href="#topic+central">central</a></code> function.
</p>
</li></ol>



<h3>See Also</h3>

<p><code><a href="#topic+concordia">concordia</a></code>, <code><a href="#topic+isochron">isochron</a></code>,
<code><a href="#topic+central">central</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>attach(examples)
tUPb &lt;- age(UPb,type=1)
tconc &lt;- age(UPb,type=2)
tdisc &lt;- age(UPb,type=3)
tArAr &lt;- age(ArAr)
tiso &lt;- age(ArAr,isochron=TRUE,i2i=TRUE)
tcentral &lt;- age(FT1,central=TRUE)
</code></pre>

<hr>
<h2 id='age2ratio'>Predict isotopic ratios from ages</h2><span id='topic+age2ratio'></span>

<h3>Description</h3>

<p>Groups a set of functions that take one (or more) ages
(and their uncertainties) as input and produces the U&ndash;Pb,
Th&ndash;Pb, Pb&ndash;Pb, Ar&ndash;Ar, K&ndash;Ca, Rb&ndash;Sr, Sm&ndash;Nd, Lu&ndash;Hf, Re&ndash;Os,
concordia or Stacey-Kramers ratios as output.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>age2ratio(tt, st = 0, ratio = "Pb206U238", exterr = FALSE, d = diseq(), J, sJ)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="age2ratio_+3A_tt">tt</code></td>
<td>
<p>a scalar or (except when <code>ratio</code> =
<code>'Wetherill'</code>, <code>'Tera-Wasserburg'</code> or
<code>'U-Th-Pb'</code>) vector of ages.</p>
</td></tr>
<tr><td><code id="age2ratio_+3A_st">st</code></td>
<td>
<p>a scalar or (except when <code>ratio</code> =
<code>'Wetherill'</code>, <code>'Tera-Wasserburg'</code> or
<code>'U-Th-Pb'</code>) vector with the standard error(s) of
<code>tt</code>. Not used when <code>ratio</code> =
<code>'Stacey-Kramers'</code>.</p>
</td></tr>
<tr><td><code id="age2ratio_+3A_ratio">ratio</code></td>
<td>
<p>one of <code>'Pb206U238'</code>, <code>'Pb207U235'</code>,
<code>'U238Pb206'</code>, <code>'Pb207Pb206'</code>, <code>'Pb208Th232'</code>,
<code>'Wetherill'</code>, <code>'Tera-Wasserburg'</code>, <code>'U-Th-Pb'</code>,
<code>'Ar40Ar39'</code>, <code>'Ca40K40'</code>, <code>'Hf176Lu176'</code>,
<code>'Sr87Rb87'</code>, <code>'Os187Re187'</code>, <code>'Nd143Sm147'</code> or
<code>'Stacey-Kramers'</code>.</p>
</td></tr>
<tr><td><code id="age2ratio_+3A_exterr">exterr</code></td>
<td>
<p>logical. If <code>TRUE</code>, propagates decay constant
uncertainties into <code>st</code>. Not used when <code>ratio</code> =
<code>'Stacey-Kramers'</code>.</p>
</td></tr>
<tr><td><code id="age2ratio_+3A_d">d</code></td>
<td>
<p>an object of class <a href="#topic+diseq">diseq</a>.</p>
</td></tr>
<tr><td><code id="age2ratio_+3A_j">J</code></td>
<td>
<p>the J-factor of the Ar&ndash;Ar system (only used if
<code>ratio</code> is <code>'Ar40Ar39'</code>).</p>
</td></tr>
<tr><td><code id="age2ratio_+3A_sj">sJ</code></td>
<td>
<p>the standard error of <code>J</code> (only used if <code>ratio</code>
is <code>'Ar40Ar39'</code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If <code>ratio</code> is <code>'Pb207U235'</code>, <code>'U238Pb206'</code>,
<code>'Pb207Pb206'</code>, <code>'Pb208Th232'</code>, <code>'Ar40Ar39'</code>,
<code>'Ca40K40'</code>, <code>'Hf176Lu176'</code>, <code>'Sr87Rb87'</code>,
<code>'Os187Re187'</code> or <code>'Nd143Sm147'</code>: either a
two-element vector or a two-column matrix with the predicted
isotopic ratio(s) and its/their standard error(s).
</p>
<p>If <code>ratio</code> is <code>'Wetherill'</code>, <code>'Tera-Wasserburg'</code> or
<code>'U-Th-Pb'</code>: a two-element list containing
</p>
<p><code>x</code>: the concordia ratios
</p>
<p><code>cov</code>: the covariance matrix of the concordia ratios
</p>
<p>If <code>ratio</code> is <code>'Stacey-Kramers'</code>: a three-column matrix
with predicted <code class="reqn">^{206}</code>Pb/<code class="reqn">^{204}</code>Pb,
<code class="reqn">^{207}</code>Pb/<code class="reqn">^{204}</code>Pb and <code class="reqn">^{208}</code>Pb/<code class="reqn">^{204}</code>Pb
ratios.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ratios &lt;- c('Pb206U238','Pb207U235','U238Pb206','Pb207Pb206',
            'Pb208Th232','Wetherill','Tera-Wasserburg','U-Th-Pb',
            'Ar40Ar39','Ca40K40','Hf176Lu176','Sr87Rb87',
            'Os187Re187','Nd143Sm147','Stacey-Kramers')
for (ratio in ratios){
     r &lt;- age2ratio(tt=1000,st=10,ratio=ratio,J=1,sJ=0.1)
     print(r)
}
</code></pre>

<hr>
<h2 id='agespectrum'>Plot a (40Ar/39Ar) release spectrum</h2><span id='topic+agespectrum'></span><span id='topic+agespectrum.default'></span><span id='topic+agespectrum.other'></span><span id='topic+agespectrum.ArAr'></span>

<h3>Description</h3>

<p>Produces a plot of boxes whose widths correspond to the cumulative
amount of <code class="reqn">^{39}</code>Ar (or any other variable), and whose heights
express the analytical uncertainties.  Only propagates the
analytical uncertainty associated with decay constants and
J-factors <em>after</em> computing the plateau composition.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>agespectrum(x, ...)

## Default S3 method:
agespectrum(
  x,
  oerr = 3,
  plateau = TRUE,
  random.effects = FALSE,
  levels = NA,
  clabel = "",
  plateau.col = c("#00FF0080", "#FF000080"),
  non.plateau.col = "#00FFFF80",
  sigdig = 2,
  line.col = "red",
  lwd = 2,
  xlab = "cumulative fraction",
  ylab = "X",
  hide = NULL,
  omit = NULL,
  ...
)

## S3 method for class 'other'
agespectrum(
  x,
  oerr = 3,
  plateau = TRUE,
  random.effects = FALSE,
  levels = NA,
  clabel = "",
  plateau.col = c("#00FF0080", "#FF000080"),
  non.plateau.col = "#00FFFF80",
  sigdig = 2,
  line.col = "red",
  lwd = 2,
  xlab = "cumulative fraction",
  ylab = "X",
  hide = NULL,
  omit = NULL,
  ...
)

## S3 method for class 'ArAr'
agespectrum(
  x,
  oerr = 3,
  plateau = TRUE,
  random.effects = FALSE,
  levels = NA,
  clabel = "",
  plateau.col = c("#00FF0080", "#FF000080"),
  non.plateau.col = "#00FFFF80",
  sigdig = 2,
  exterr = FALSE,
  line.col = "red",
  lwd = 2,
  i2i = FALSE,
  hide = NULL,
  omit = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="agespectrum_+3A_x">x</code></td>
<td>
<p>a three-column matrix whose first column gives the amount of
<code class="reqn">^{39}</code>Ar in each aliquot, and whose second and third columns
give the age and its uncertainty.
</p>
<p>OR
</p>
<p>an object of class <code>ArAr</code></p>
</td></tr>
<tr><td><code id="agespectrum_+3A_...">...</code></td>
<td>
<p>optional parameters to the generic <code>plot</code> function</p>
</td></tr>
<tr><td><code id="agespectrum_+3A_oerr">oerr</code></td>
<td>
<p>indicates whether the analytical uncertainties of the
output are reported in the plot title as:
</p>
<p><code>1</code>: 1<code class="reqn">\sigma</code> absolute uncertainties.
</p>
<p><code>2</code>: 2<code class="reqn">\sigma</code> absolute uncertainties.
</p>
<p><code>3</code>: absolute (1-<code class="reqn">\alpha</code>)% confidence intervals, where
<code class="reqn">\alpha</code> equales the value that is stored in
<code>settings('alpha')</code>.
</p>
<p><code>4</code>: 1<code class="reqn">\sigma</code> relative uncertainties (<code class="reqn">\%</code>).
</p>
<p><code>5</code>: 2<code class="reqn">\sigma</code> relative uncertainties (<code class="reqn">\%</code>).
</p>
<p><code>6</code>: relative (1-<code class="reqn">\alpha</code>)% confidence intervals, where
<code class="reqn">\alpha</code> equales the value that is stored in
<code>settings('alpha')</code>.</p>
</td></tr>
<tr><td><code id="agespectrum_+3A_plateau">plateau</code></td>
<td>
<p>logical flag indicating whether a plateau age should
be calculated. If <code>plateau=TRUE</code>, the function computes
the weighted mean of the largest succession of steps that pass
the Chi-square test for age homogeneity.  If <code>TRUE</code>, it
returns a list with plateau parameters.</p>
</td></tr>
<tr><td><code id="agespectrum_+3A_random.effects">random.effects</code></td>
<td>
<p>if <code>TRUE</code>, computes the weighted mean
using a random effects model with two parameters: the mean and
the dispersion. This is akin to a &lsquo;model-3&rsquo; isochron
regression.
</p>
<p>if <code>FALSE</code>, attributes any excess dispersion to an
underestimation of the analytical uncertainties. This akin to a
&lsquo;model-1&rsquo; isochron regression.</p>
</td></tr>
<tr><td><code id="agespectrum_+3A_levels">levels</code></td>
<td>
<p>a vector with additional values to be displayed as
different background colours of the plot symbols.</p>
</td></tr>
<tr><td><code id="agespectrum_+3A_clabel">clabel</code></td>
<td>
<p>label of the colour legend</p>
</td></tr>
<tr><td><code id="agespectrum_+3A_plateau.col">plateau.col</code></td>
<td>
<p>Fill colours of the rectangles used to mark the steps belonging to
the age plateau. This can either be a single colour or multiple
colours to form a colour ramp (to be used if <code>levels!=NA</code>):
</p>
<p>a single colour: <code>rgb(0,1,0,0.5)</code>, <code>'#FF000080'</code>,
<code>'white'</code>, etc.;
</p>
<p>multiple colours: <code>c(rbg(1,0,0,0.5)</code>,
<code>rgb(0,1,0,0.5))</code>, <code>c('#FF000080','#00FF0080')</code>,
<code>c('blue','red')</code>, <code>c('blue','yellow','red')</code>, etc.;
</p>
<p>a colour palette: <code>rainbow(n=100)</code>,
<code>topo.colors(n=100,alpha=0.5)</code>, etc.; or
</p>
<p>a reversed palette: <code>rev(topo.colors(n=100,alpha=0.5))</code>,
etc.
</p>
<p>For empty boxes, set <code>plateau.col=NA</code></p>
</td></tr>
<tr><td><code id="agespectrum_+3A_non.plateau.col">non.plateau.col</code></td>
<td>
<p>if <code>plateau=TRUE</code>, the steps that do
NOT belong to the plateau are given a different colour.</p>
</td></tr>
<tr><td><code id="agespectrum_+3A_sigdig">sigdig</code></td>
<td>
<p>the number of significant digits of the numerical
values reported in the title of the graphical output.</p>
</td></tr>
<tr><td><code id="agespectrum_+3A_line.col">line.col</code></td>
<td>
<p>colour of the average age line</p>
</td></tr>
<tr><td><code id="agespectrum_+3A_lwd">lwd</code></td>
<td>
<p>width of the average age line</p>
</td></tr>
<tr><td><code id="agespectrum_+3A_xlab">xlab</code></td>
<td>
<p>x-axis label</p>
</td></tr>
<tr><td><code id="agespectrum_+3A_ylab">ylab</code></td>
<td>
<p>y-axis label</p>
</td></tr>
<tr><td><code id="agespectrum_+3A_hide">hide</code></td>
<td>
<p>vector with indices of aliquots that should be removed
from the plot.</p>
</td></tr>
<tr><td><code id="agespectrum_+3A_omit">omit</code></td>
<td>
<p>vector with indices of aliquots that should be plotted
but omitted from age plateau calculation</p>
</td></tr>
<tr><td><code id="agespectrum_+3A_exterr">exterr</code></td>
<td>
<p>propagate the external (decay constant and
calibration factor) uncertainties?</p>
</td></tr>
<tr><td><code id="agespectrum_+3A_i2i">i2i</code></td>
<td>
<p>&lsquo;isochron to intercept&rsquo;: calculates the initial (aka
&lsquo;inherited&rsquo;, &lsquo;excess&rsquo;, or &lsquo;common&rsquo;) <code class="reqn">^{40}</code>Ar/<code class="reqn">^{36}</code>Ar
ratio from an isochron fit. Setting <code>i2i</code> to <code>FALSE</code>
uses the default values stored in <code>settings('iratio',...)</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>IsoplotR</code> defines the &lsquo;plateau age&rsquo; as the weighted mean age
(using a random effects model with two sources of dispersion) of
the longest sequence (in terms of cumulative <code class="reqn">^{39}</code>Ar content)
of consecutive heating steps that pass the modified Chauvenet
criterion (see <code><a href="#topic+weightedmean">weightedmean</a></code>).  Note that this
definition is different (and simpler) than the one used by
<code>Isoplot</code> (Ludwig, 2003). However, it is important to mention
that all definitions of an age plateau are heuristic by nature and
should not be used for quantitative inference. It is possible (and
likely) that the plateau steps exhibit significant
overdispersion. This overdispersion can be manually reduced by
removing individual heating steps with the optional <code>omit</code>
argument.
</p>


<h3>Value</h3>

<p>If <code>plateau=TRUE</code>, returns a list containing the output of the
<code>weightedmean</code> function, plus the following items:
</p>

<dl>
<dt>fract</dt><dd><p>the fraction of <code class="reqn">^{39}</code>Ar contained in the
plateau</p>
</dd>
<dt>i</dt><dd><p>indices of the steps that are retained for the plateau age
calculation</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+weightedmean">weightedmean</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>attach(examples)
par(mfrow=c(2,1))
agespectrum(ArAr)
# removing the first 6 steps yields the longest plateau
# that passes the chi-square test for homogeneity
agespectrum(ArAr,omit=1:6)
</code></pre>

<hr>
<h2 id='cad'>Plot continuous data as cumulative age distributions</h2><span id='topic+cad'></span><span id='topic+cad.default'></span><span id='topic+cad.other'></span><span id='topic+cad.detritals'></span><span id='topic+cad.UPb'></span><span id='topic+cad.PbPb'></span><span id='topic+cad.ArAr'></span><span id='topic+cad.KCa'></span><span id='topic+cad.ThPb'></span><span id='topic+cad.ThU'></span><span id='topic+cad.ReOs'></span><span id='topic+cad.SmNd'></span><span id='topic+cad.RbSr'></span><span id='topic+cad.LuHf'></span><span id='topic+cad.UThHe'></span><span id='topic+cad.fissiontracks'></span>

<h3>Description</h3>

<p>Plot a dataset as a Cumulative Age Distribution (CAD), also known
as a &lsquo;empirical cumulative distribution function&rsquo;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cad(x, ...)

## Default S3 method:
cad(
  x,
  pch = NA,
  verticals = TRUE,
  xlab = "age [Ma]",
  col = "black",
  hide = NULL,
  ...
)

## S3 method for class 'other'
cad(
  x,
  pch = NA,
  verticals = TRUE,
  xlab = "age [Ma]",
  col = "black",
  hide = NULL,
  ...
)

## S3 method for class 'detritals'
cad(
  x,
  pch = NA,
  verticals = TRUE,
  xlab = "age [Ma]",
  col = "rainbow",
  hide = NULL,
  ...
)

## S3 method for class 'UPb'
cad(
  x,
  pch = NA,
  verticals = TRUE,
  xlab = "age [Ma]",
  col = "black",
  type = 4,
  cutoff.76 = 1100,
  cutoff.disc = discfilter(),
  common.Pb = 0,
  hide = NULL,
  ...
)

## S3 method for class 'PbPb'
cad(
  x,
  pch = NA,
  verticals = TRUE,
  xlab = "age [Ma]",
  col = "black",
  common.Pb = 1,
  hide = NULL,
  ...
)

## S3 method for class 'ArAr'
cad(
  x,
  pch = NA,
  verticals = TRUE,
  xlab = "age [Ma]",
  col = "black",
  i2i = FALSE,
  hide = NULL,
  ...
)

## S3 method for class 'KCa'
cad(
  x,
  pch = NA,
  verticals = TRUE,
  xlab = "age [Ma]",
  col = "black",
  i2i = FALSE,
  hide = NULL,
  ...
)

## S3 method for class 'ThPb'
cad(
  x,
  pch = NA,
  verticals = TRUE,
  xlab = "age [Ma]",
  col = "black",
  i2i = TRUE,
  hide = NULL,
  ...
)

## S3 method for class 'ThU'
cad(
  x,
  pch = NA,
  verticals = TRUE,
  xlab = "age [ka]",
  col = "black",
  Th0i = 0,
  hide = NULL,
  ...
)

## S3 method for class 'ThPb'
cad(
  x,
  pch = NA,
  verticals = TRUE,
  xlab = "age [Ma]",
  col = "black",
  i2i = TRUE,
  hide = NULL,
  ...
)

## S3 method for class 'ReOs'
cad(
  x,
  pch = NA,
  verticals = TRUE,
  xlab = "age [Ma]",
  col = "black",
  i2i = TRUE,
  hide = NULL,
  ...
)

## S3 method for class 'SmNd'
cad(
  x,
  pch = NA,
  verticals = TRUE,
  xlab = "age [Ma]",
  col = "black",
  i2i = TRUE,
  hide = NULL,
  ...
)

## S3 method for class 'RbSr'
cad(
  x,
  pch = NA,
  verticals = TRUE,
  xlab = "age [Ma]",
  col = "black",
  i2i = TRUE,
  hide = NULL,
  ...
)

## S3 method for class 'LuHf'
cad(
  x,
  pch = NA,
  verticals = TRUE,
  xlab = "age [Ma]",
  col = "black",
  i2i = TRUE,
  hide = NULL,
  ...
)

## S3 method for class 'UThHe'
cad(
  x,
  pch = NA,
  verticals = TRUE,
  xlab = "age [Ma]",
  col = "black",
  hide = NULL,
  ...
)

## S3 method for class 'fissiontracks'
cad(
  x,
  pch = NA,
  verticals = TRUE,
  xlab = "age [Ma]",
  col = "black",
  hide = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cad_+3A_x">x</code></td>
<td>
<p>a numerical vector OR an object of class <code>UPb</code>,
<code>PbPb</code>, <code>ThPb</code>, <code>ArAr</code>, <code>KCa</code>,
<code>UThHe</code>, <code>fissiontracks</code>, <code>ReOs</code>, <code>RbSr</code>,
<code>SmNd</code>, <code>LuHf</code>, <code>ThU</code> or <code>detritals</code></p>
</td></tr>
<tr><td><code id="cad_+3A_...">...</code></td>
<td>
<p>optional arguments to the generic <code>plot</code> function</p>
</td></tr>
<tr><td><code id="cad_+3A_pch">pch</code></td>
<td>
<p>plot character to mark the beginning of each CAD step</p>
</td></tr>
<tr><td><code id="cad_+3A_verticals">verticals</code></td>
<td>
<p>logical flag indicating if the horizontal lines of
the CAD should be connected by vertical lines</p>
</td></tr>
<tr><td><code id="cad_+3A_xlab">xlab</code></td>
<td>
<p>x-axis label</p>
</td></tr>
<tr><td><code id="cad_+3A_col">col</code></td>
<td>
<p>if <code>x</code> has class <code>detritals</code>, the name of one
of <code>R</code>'s built-in colour palettes (e.g.,
<code>'heat.colors'</code>, <code>'terrain.colors'</code>,
<code>'topo.colors'</code>, <code>'cm.colors'</code>), OR a vector with the
names or codes of two colours to use as the start and end of a
colour ramp (e.g. <code>col=c('yellow','blue')</code>).
</p>
<p>For all other data formats, the name or code for a colour to give
to a single sample dataset</p>
</td></tr>
<tr><td><code id="cad_+3A_hide">hide</code></td>
<td>
<p>vector with indices of aliquots that should be removed
from the plot.</p>
</td></tr>
<tr><td><code id="cad_+3A_type">type</code></td>
<td>
<p>scalar indicating whether to plot the
<code class="reqn">^{207}</code>Pb/<code class="reqn">^{235}</code>U age (<code>type</code>=1), the
<code class="reqn">^{206}</code>Pb/<code class="reqn">^{238}</code>U age (<code>type</code>=2), the
<code class="reqn">^{207}</code>Pb/<code class="reqn">^{206}</code>Pb age (<code>type</code>=3), the
<code class="reqn">^{207}</code>Pb/<code class="reqn">^{206}</code>Pb-<code class="reqn">^{206}</code>Pb/<code class="reqn">^{238}</code>U age
(<code>type</code>=4), the concordia age (<code>type</code>=5), or the
<code class="reqn">^{208}</code>Pb/<code class="reqn">^{232}</code>Th age (<code>type</code>=6).</p>
</td></tr>
<tr><td><code id="cad_+3A_cutoff.76">cutoff.76</code></td>
<td>
<p>the age (in Ma) below which the
<code class="reqn">^{206}</code>Pb/<code class="reqn">^{238}</code>U-age and above which the
<code class="reqn">^{207}</code>Pb/<code class="reqn">^{206}</code>Pb-age is used. This parameter is
only used if <code>type=4</code>.</p>
</td></tr>
<tr><td><code id="cad_+3A_cutoff.disc">cutoff.disc</code></td>
<td>
<p>discordance cutoff filter. This is an object of
class <code><a href="#topic+discfilter">discfilter</a></code>.</p>
</td></tr>
<tr><td><code id="cad_+3A_common.pb">common.Pb</code></td>
<td>
<p>common lead correction:
</p>
<p><code>0</code>: none
</p>
<p><code>1</code>: use the Pb-composition stored in
</p>
<p><code>settings('iratio','Pb207Pb206')</code> (if <code>x</code> has class
<code>UPb</code> and <code>x$format&lt;4</code>);
</p>
<p><code>settings('iratio','Pb206Pb204')</code> and
<code>settings('iratio','Pb207Pb204')</code> (if <code>x</code> has class
<code>PbPb</code> or <code>x</code> has class <code>UPb</code> and
<code>3&lt;x$format&lt;7</code>); or
</p>
<p><code>settings('iratio','Pb206Pb208')</code> and
<code>settings('iratio','Pb207Pb208')</code> (if <code>x</code> has class
<code>UPb</code> and <code>x$format=7</code> or <code>8</code>).
</p>
<p><code>2</code>: use the isochron intercept as the initial Pb-composition
</p>
<p><code>3</code>: use the Stacey-Kramers two-stage model to infer the
initial Pb-composition (only applicable if <code>x</code> has class
<code>UPb</code>)</p>
</td></tr>
<tr><td><code id="cad_+3A_i2i">i2i</code></td>
<td>
<p>&lsquo;isochron to intercept&rsquo;: calculates the initial (aka
&lsquo;inherited&rsquo;, &lsquo;excess&rsquo;, or &lsquo;common&rsquo;)
<code class="reqn">^{40}</code>Ar/<code class="reqn">^{36}</code>Ar, <code class="reqn">^{40}</code>Ca/<code class="reqn">^{44}</code>Ca,
<code class="reqn">^{207}</code>Pb/<code class="reqn">^{204}</code>Pb, <code class="reqn">^{87}</code>Sr/<code class="reqn">^{86}</code>Sr,
<code class="reqn">^{143}</code>Nd/<code class="reqn">^{144}</code>Nd, <code class="reqn">^{187}</code>Os/<code class="reqn">^{188}</code>Os,
<code class="reqn">^{230}</code>Th/<code class="reqn">^{232}</code>Th, <code class="reqn">^{176}</code>Hf/<code class="reqn">^{177}</code>Hf or
<code class="reqn">^{204}</code>Pb/<code class="reqn">^{208}</code>Pb ratio from an isochron
fit. Setting <code>i2i</code> to <code>FALSE</code> uses the default values
stored in <code>settings('iratio',...)</code>.</p>
</td></tr>
<tr><td><code id="cad_+3A_th0i">Th0i</code></td>
<td>
<p>initial <code class="reqn">^{230}</code>Th correction.
</p>
<p><code>0</code>: no correction
</p>
<p><code>1</code>: project the data along an isochron fit
</p>
<p><code>2</code>: if <code>x$format</code> is <code>1</code> or <code>2</code>, correct the
data using the measured present day <code class="reqn">^{230}</code>Th/<code class="reqn">^{238}</code>U,
<code class="reqn">^{232}</code>Th/<code class="reqn">^{238}</code>U and <code class="reqn">^{234}</code>U/<code class="reqn">^{238}</code>U
activity ratios in the detritus. If <code>x$format</code> is <code>3</code> or
<code>4</code>, correct the data using the measured
<code class="reqn">^{238}</code>U/<code class="reqn">^{232}</code>Th activity ratio of the whole rock, as
stored in <code>x</code> by the <code>read.data()</code> function.
</p>
<p><code>3</code>: correct the data using an assumed initial
<code class="reqn">^{230}</code>Th/<code class="reqn">^{232}</code>Th-ratio for the detritus (only relevant
if <code>x$format</code> is <code>1</code> or <code>2</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Empirical cumulative distribution functions or cumulative age
distributions are the most straightforward way to visualise the
probability distribution of multiple dates.  Suppose that we have a
set of <code class="reqn">n</code> dates <code class="reqn">t_i</code>. The CAD is a step function that
sets out the rank order of the dates against their numerical value:
</p>
<p><code class="reqn">CAD(t) = \sum_i 1(t&lt;t_i)/n</code>
</p>
<p>where 1(<code class="reqn">\ast</code>) = 1 if <code class="reqn">\ast</code> is true and 1(<code class="reqn">\ast</code>) = 0
if <code class="reqn">\ast</code> is false. CADs have two desirable properties
(Vermeesch, 2007). First, they do not require any pre-treatment or
smoothing of the data. This is not the case for histograms or
kernel density estimates. Second, it is easy to superimpose several
CADs on the same plot. This facilitates the intercomparison of
multiple samples. The interpretation of CADs is straightforward but
not very intuitive. The prominence of individual age components is
proportional to the steepness of the CAD. This is different from
probability density estimates such as histograms, in which such
components stand out as peaks.
</p>


<h3>References</h3>

<p>Vermeesch, P., 2007. Quantitative geomorphology of the
White Mountains (California) using detrital apatite fission
track thermochronology. Journal of Geophysical Research: Earth
Surface, 112(F3).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+kde">kde</a></code>, <code><a href="#topic+radialplot">radialplot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>attach(examples)
cad(DZ,verticals=FALSE,pch=20)
</code></pre>

<hr>
<h2 id='central'>Fits random effects models to overdispersed datasets</h2><span id='topic+central'></span><span id='topic+central.default'></span><span id='topic+central.UThHe'></span><span id='topic+central.fissiontracks'></span>

<h3>Description</h3>

<p>Computes the logratio mean composition of a continuous mixture of
fission track or U-Th-He data and returns the corresponding age and
fitting parameters. Only propagates the systematic uncertainty
associated with decay constants and calibration factors after
computing the weighted mean isotopic composition. Does not propagate
the uncertainty of any initial daughter correction, because this is
neither a purely random or purely systematic uncertainty.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>central(x, ...)

## Default S3 method:
central(x, ...)

## S3 method for class 'UThHe'
central(x, compositional = FALSE, model = 1, ...)

## S3 method for class 'fissiontracks'
central(x, exterr = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="central_+3A_x">x</code></td>
<td>
<p>an object of class <code>UThHe</code> or <code>fissiontracks</code>,
OR a 2-column matrix with (strictly positive) values and
uncertainties</p>
</td></tr>
<tr><td><code id="central_+3A_...">...</code></td>
<td>
<p>optional arguments</p>
</td></tr>
<tr><td><code id="central_+3A_compositional">compositional</code></td>
<td>
<p>logical. If <code>TRUE</code>, calculates the
'barycentric' U-Th-He, age, i.e. the age corresponding to the
weighted mean logratio composition.</p>
</td></tr>
<tr><td><code id="central_+3A_model">model</code></td>
<td>
<p>only relevant if <code>compositional</code> is
<code>TRUE</code>. If the scatter between the data points is solely
caused by the analytical uncertainty, then the MSWD value
should be approximately equal to one. There are three
strategies to deal with the case where MSWD&gt;1.choose one of the
following statistical models:
</p>
<p><code>1</code>: assume that the analytical uncertainties have been
underestimated by a factor <code class="reqn">\sqrt{MSWD}</code>.
</p>
<p><code>2</code>: ignore the analytical
uncertainties.
</p>
<p><code>3</code>: attribute any excess dispersion to the presence of
geological uncertainty, which manifests itself as an added
(co)variance term.</p>
</td></tr>
<tr><td><code id="central_+3A_exterr">exterr</code></td>
<td>
<p>include the zeta or decay constant uncertainty into
the error propagation for the central age?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The central age assumes that the observed age distribution is the
combination of two sources of scatter: analytical uncertainty and
true geological dispersion.
</p>

<ol>
<li><p> For fission track data, the analytical uncertainty is assumed
to obey Binomial counting statistics and the geological dispersion
is assumed to follow a lognormal distribution.
</p>
</li>
<li><p> For U-Th-He data, the U-Th-(Sm)-He compositions and
uncertainties are assumed to follow a logistic normal distribution.
</p>
</li>
<li><p> For all other data types, both the analytical uncertainties
and the true ages are assumed to follow lognormal distributions.
</p>
</li></ol>

<p>The difference between the central age and the weighted mean age is
usually small unless the data are imprecise and/or strongly
overdispersed.
</p>
<p>The uncertainty budget of the central age does not include the
uncertainty of the initial daughter correction (if any), for the
same reasons as discussed under the <code><a href="#topic+weightedmean">weightedmean</a></code>
function.
</p>


<h3>Value</h3>

<p>If <code>x</code> has class <code>UThHe</code> and <code>compositional</code>
is <code>TRUE</code>, returns a list containing the following items:
</p>

<dl>
<dt>uvw</dt><dd><p>(if the input data table contains Sm) or <strong>uv</strong> (if
it does not): the mean log[U/He], log[Th/He] (, and log[Sm/He])
composition.</p>
</dd>
<dt>covmat</dt><dd><p>the covariance matrix of <code>uvw</code> or <code>uv</code>.</p>
</dd>
<dt>mswd</dt><dd><p>the reduced Chi-square statistic of data concordance,
i.e. <code class="reqn">mswd=SS/df</code>, where <code class="reqn">SS</code> is the sum of squares of the
log[U/He]-log[Th/He] compositions.</p>
</dd>
<dt>model</dt><dd><p>the fitting model.</p>
</dd>
<dt>df</dt><dd><p>the degrees of freedom (<code class="reqn">2n-2</code>) of the fit (only
reported if <code>model=1</code>).</p>
</dd>
<dt>p.value</dt><dd><p>the p-value of a Chi-square test with <code>df</code>
degrees of freedom (only reported if <code>model=1</code>.)</p>
</dd>
<dt>age</dt><dd><p>a two- or three-element vector with:<br />
<code>t</code>: the 'barycentric' age, i.e. the age corresponding to <code>uvw</code>.<br />
<code>s[t]</code>: the standard error of <code>t</code>.<br />
<code>disp[t]</code>: the standard error of <code>t</code> enhanced by a
factor of <code class="reqn">\sqrt{mswd}</code> (only reported if <code>model=1</code>). </p>
</dd>
<dt>w</dt><dd><p>the geological overdispersion term. If <code>model=3</code>,
this is a two-element vector with the standard deviation of the
(assumedly) Normal dispersion and its standard error. <code>w=0</code> if
<code>model&lt;3</code>.</p>
</dd>
</dl>

<p>OR, otherwise:
</p>

<dl>
<dt>age</dt><dd><p>a two-element vector with the central age and its
standard error.</p>
</dd>
<dt>disp</dt><dd><p>a two-element vector with the overdispersion (standard
deviation) of the excess scatter, and its standard error.</p>
</dd>
<dt>mswd</dt><dd><p>the reduced Chi-square statistic of data concordance,
i.e. <code class="reqn">mswd=X^2/df</code>, where <code class="reqn">X^2</code> is a Chi-square statistic
of the EDM data or ages</p>
</dd>
<dt>df</dt><dd><p>the degrees of freedom (<code class="reqn">n-2</code>)</p>
</dd>
<dt>p.value</dt><dd><p>the p-value of a Chi-square test with <code>df</code>
degrees of freedom</p>
</dd>
</dl>



<h3>References</h3>

<p>Galbraith, R.F. and Laslett, G.M., 1993. Statistical models for
mixed fission track ages. Nuclear Tracks and Radiation
Measurements, 21(4), pp.459-470.
</p>
<p>Vermeesch, P., 2008. Three new ways to calculate average (U-Th)/He
ages. Chemical Geology, 249(3), pp.339-347.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+weightedmean">weightedmean</a></code>, <code><a href="#topic+radialplot">radialplot</a></code>,
<code><a href="#topic+helioplot">helioplot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>attach(examples)
print(central(UThHe)$age)

</code></pre>

<hr>
<h2 id='ci'>Confidence intervals</h2><span id='topic+ci'></span>

<h3>Description</h3>

<p>Given a parameter estimate and its standard error,
calculate the corresponding 1-sigma, 2-sigma or
<code class="reqn">100(1-\alpha)\%</code> confidence interval, in absolute or
relative units.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ci(x = 0, sx, oerr = 3, df = NULL, absolute = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ci_+3A_x">x</code></td>
<td>
<p>scalar estimate</p>
</td></tr>
<tr><td><code id="ci_+3A_sx">sx</code></td>
<td>
<p>scalar or vector with the standard error of x without and
(optionally) with <code class="reqn">\sqrt{MSWD}</code> overdispersion multiplier.</p>
</td></tr>
<tr><td><code id="ci_+3A_oerr">oerr</code></td>
<td>
<p>indicates if the confidence intervals should be
reported as:
</p>
<p><code>1</code>: 1<code class="reqn">\sigma</code> absolute uncertainties.
</p>
<p><code>2</code>: 2<code class="reqn">\sigma</code> absolute uncertainties.
</p>
<p><code>3</code>: absolute (1-<code class="reqn">\alpha</code>)% confidence intervals, where
<code class="reqn">\alpha</code> equales the value that is stored in
<code>settings('alpha')</code>.
</p>
<p><code>4</code>: 1<code class="reqn">\sigma</code> relative uncertainties (<code class="reqn">\%</code>).
</p>
<p><code>5</code>: 2<code class="reqn">\sigma</code> relative uncertainties (<code class="reqn">\%</code>).
</p>
<p><code>6</code>: relative (1-<code class="reqn">\alpha</code>)% confidence intervals, where
<code class="reqn">\alpha</code> equales the value that is stored in
<code>settings('alpha')</code>.</p>
</td></tr>
<tr><td><code id="ci_+3A_df">df</code></td>
<td>
<p>(optional) number of degrees of freedom. Only used if
<code>sx</code> is a vector.</p>
</td></tr>
<tr><td><code id="ci_+3A_absolute">absolute</code></td>
<td>
<p>logical. Returns absolute uncertainties even if
<code>oerr</code> is greater than 3. Used for some internal
<code>IsoplotR</code> functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Several of <code>IsoplotR</code>'s plotting functions (including
<code><a href="#topic+isochron">isochron</a></code>, <code><a href="#topic+weightedmean">weightedmean</a></code>,
<code><a href="#topic+concordia">concordia</a></code>, <code><a href="#topic+radialplot">radialplot</a></code> and
<code><a href="#topic+helioplot">helioplot</a></code>) return lists of parameters and their
standard errors. For &lsquo;model-1&rsquo; fits, if the data pass a
Chi-square test of homogeneity, then just one estimate for the
standard error is reported.  This estimate can be converted to
a confidence interval by multiplication with the appropriate
quantile of a Normal distribution. Datasets that fail the
Chi-square test are said to be &lsquo;overdispersed&rsquo; with respect to
the analytical uncertainties. The simplest way (&lsquo;model-1&rsquo;) to
deal with overdispersion is to inflate the standard error with
a <code class="reqn">\sqrt{MSWD}</code> premultiplier. In this case,
<code>IsoplotR</code> returns two estimates of the standard error.
To convert the second estimate to a confidence interval
requires multiplication with the desired quantile of a
t-distribution with the appropriate degrees of freedom.
</p>


<h3>Value</h3>

<p>A scalar or vector of the same size as <code>sx</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>attach(examples)
fit &lt;- isochron(PbPb,plot=FALSE,exterr=FALSE)
err &lt;- ci(x=fit$age[1],sx=fit$age[-1],oerr=5,df=fit$df)
message('age=',signif(fit$age[1],4),'Ma, ',
        '2se=',signif(err[1],2),'%, ',
        '2se(with dispersion)=',signif(err[2],2),'%')
</code></pre>

<hr>
<h2 id='classes'>Geochronological data classes</h2><span id='topic+classes'></span><span id='topic+UPb'></span><span id='topic+PbPb'></span><span id='topic+ThPb'></span><span id='topic+ThU'></span><span id='topic+ArAr'></span><span id='topic+KCa'></span><span id='topic+PD'></span><span id='topic+RbSr'></span><span id='topic+SmNd'></span><span id='topic+LuHf'></span><span id='topic+ReOs'></span><span id='topic+UThHe'></span><span id='topic+fissiontracks'></span><span id='topic+detritals'></span><span id='topic+is.UPb'></span><span id='topic+is.PbPb'></span><span id='topic+is.ThPb'></span><span id='topic+is.ThU'></span><span id='topic+is.ArAr'></span><span id='topic+is.KCa'></span><span id='topic+is.PD'></span><span id='topic+is.RbSr'></span><span id='topic+is.SmNd'></span><span id='topic+is.LuHf'></span><span id='topic+is.ReOs'></span><span id='topic+is.UThHe'></span><span id='topic+is.fissiontracks'></span><span id='topic+is.detritals'></span><span id='topic+is.other'></span><span id='topic+as.UPb'></span><span id='topic+as.PbPb'></span><span id='topic+as.ThPb'></span><span id='topic+as.ThU'></span><span id='topic+as.ArAr'></span><span id='topic+as.KCa'></span><span id='topic+as.PD'></span><span id='topic+as.RbSr'></span><span id='topic+as.SmNd'></span><span id='topic+as.LuHf'></span><span id='topic+as.ReOs'></span><span id='topic+as.UThHe'></span><span id='topic+as.fissiontracks'></span><span id='topic+as.detritals'></span><span id='topic+as.other'></span><span id='topic+is.diseq'></span>

<h3>Description</h3>

<p>S3 classes to store geochronological data generated by
<code><a href="#topic+read.data">read.data</a></code> or <code><a href="#topic+diseq">diseq</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.UPb(x)

is.PbPb(x)

is.ThPb(x)

is.ArAr(x)

is.KCa(x)

is.PD(x)

is.RbSr(x)

is.SmNd(x)

is.LuHf(x)

is.ReOs(x)

is.ThU(x)

is.UThHe(x)

is.fissiontracks(x)

is.detritals(x)

is.other(x)

is.diseq(x)

as.UPb(x, format = 3, ierr = 1, d = diseq())

as.PbPb(x, format = 1, ierr = 1)

as.ArAr(x, format = 3, ierr = 1)

as.ThPb(x, format = 1, ierr = 1)

as.KCa(x, format = 1, ierr = 1)

as.RbSr(x, format = 1, ierr = 1)

as.ReOs(x, format = 1, ierr = 1)

as.SmNd(x, format = 1, ierr = 1)

as.LuHf(x, format = 1, ierr = 1)

as.ThU(
  x,
  format = 1,
  ierr = 1,
  U8Th2 = 0,
  Th02i = c(0, 0),
  Th02U48 = c(0, 0, 1e+06, 0, 0, 0, 0, 0, 0)
)

as.UThHe(x, ierr = 1)

as.fissiontracks(x, format = 1, ierr = 1)

as.detritals(x)

as.other(x, format = NULL, ierr = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="classes_+3A_x">x</code></td>
<td>
<p>a data object returned by <code><a href="#topic+read.data">read.data</a></code> or
<code><a href="#topic+diseq">diseq</a></code>.</p>
</td></tr>
<tr><td><code id="classes_+3A_format">format</code></td>
<td>
<p>data format. See <code><a href="#topic+read.data">read.data</a></code> for details.</p>
</td></tr>
<tr><td><code id="classes_+3A_ierr">ierr</code></td>
<td>
<p>input error. See <code><a href="#topic+read.data">read.data</a></code> for details.</p>
</td></tr>
<tr><td><code id="classes_+3A_d">d</code></td>
<td>
<p>an object of class <code><a href="#topic+diseq">diseq</a></code>.</p>
</td></tr>
<tr><td><code id="classes_+3A_u8th2">U8Th2</code></td>
<td>
<p><code class="reqn">^{238}</code>U/<code class="reqn">^{232}</code>Th activity-ratio of the
whole rock. Used to estimate the initial
<code class="reqn">^{230}</code>Th/<code class="reqn">^{238}</code>U disequilibrium (for Th-U formats 3
and 4).</p>
</td></tr>
<tr><td><code id="classes_+3A_th02i">Th02i</code></td>
<td>
<p>2-element vector with the assumed initial
<code class="reqn">^{230}</code>Th/<code class="reqn">^{232}</code>Th-ratio of the detritus (for
Th-U formats 1 and 2) and its standard error.</p>
</td></tr>
<tr><td><code id="classes_+3A_th02u48">Th02U48</code></td>
<td>
<p>9-element vector with the measured composition of
the detritus, containing <code>X=0/8</code>, <code>sX</code>, <code>Y=2/8</code>,
<code>sY</code>, <code>Z=4/8</code>, <code>sZ</code>, <code>rXY</code>, <code>rXZ</code>,
<code>rYZ</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>IsoplotR</code> uses the following S3 classes to store
geochronological data: <code>UPb</code>, <code>PbPb</code>, <code>ThPb</code>,
<code>KCa</code>, <code>UThHe</code>, <code>fissiontracks</code>,
<code>detritals</code> and <code>PD</code>, where the latter is the parent
class of the simple parent-daughter chronometers <code>RbSr</code>,
<code>SmNd</code>, <code>LuHf</code> and <code>ReOs</code>. All these classes
have overloaded versions of the generic <code>length()</code>
function and <code>`[`</code> subsetting method.
</p>
<p>Additional functions for each class include <code>as.X(x)</code>,
which converts the data table <code>x</code> to an object of class
<code>X</code>; and <code>is.X(x)</code>, which checks if <code>x</code> has
class <code>X</code>.
</p>

<ul>
<li><p><code>UPb</code>: a list containing:
</p>

<dl>
<dt><code>x</code></dt><dd><p>a matrix containing the isotopic measurements</p>
</dd>
<dt><code>format</code></dt><dd><p>a number between 1 and 8</p>
</dd>
<dt><code>d</code></dt><dd><p>an object of class <code>diseq</code>, i.e. the output of
the <code><a href="#topic+diseq">diseq</a></code> function</p>
</dd>
</dl>

</li>
<li><p><code>ArAr</code>: a list containing
</p>

<dl>
<dt><code>x</code></dt><dd><p>a matrix containing the isotopic measurements</p>
</dd>
<dt><code>J</code></dt><dd><p>a two-element vector with the J-factor and its
uncertainty</p>
</dd>
<dt><code>format</code></dt><dd><p>a number between 1 and 3</p>
</dd>
</dl>

</li>
<li><p><code>ThU</code>: a list containing
</p>

<dl>
<dt><code>x</code></dt><dd><p>a matrix containing the isotopic measurements</p>
</dd>
<dt><code>format</code></dt><dd><p>a number between 1 and 4</p>
</dd>
<dt><code>Th02</code></dt><dd><p>a two element vector with the assumed initial
<code class="reqn">^{230}</code>Th/<code class="reqn">^{232}</code>Th-ratio of Th-bearing
detritus. Only aplicable to formats 1 and 2.</p>
</dd>
<dt><code>Th02U48</code></dt><dd><p>9-element vector with the measured
composition of Th-bearing detritus</p>
</dd>
<dt><code>U8Th2</code></dt><dd><p>the measured <code class="reqn">^{238}</code>U/<code class="reqn">^{232}</code>Th
activity ratio of the whole rock. Only applicable to formats
3 and 4</p>
</dd>
</dl>

</li>
<li><p><code>PbPb</code>, <code>ThPb</code>, <code>KCa</code>, <code>PD</code>, <code>RbSr</code>,
<code>SmNd</code>, <code>LuHf</code>, or <code>ReOs</code>: a list containing
</p>

<dl>
<dt><code>x</code></dt><dd><p>a matrix containing the isotopic measurements</p>
</dd>
<dt><code>format</code></dt><dd><p>a number between 1 and 3</p>
</dd>
</dl>

</li>
<li><p><code>UThHe</code>: a matrix of He, U, Th (and Sm) measurements
</p>
</li>
<li><p><code>fissiontracks</code>: a list containing
</p>

<dl>
<dt><code>format</code></dt><dd><p>a number between 1 and 3</p>
</dd>
<dt><code>x</code></dt><dd><p>a matrix of spontaneous and induced fission track
counts (only included if <code>format=1</code>)</p>
</dd>
<dt><code>rhoD</code></dt><dd><p>the track density of the dosimeter glass,
extracted from the input data (only included if <code>format=1</code>)</p>
</dd>
<dt><code>zeta</code></dt><dd><p>the zeta calibration constant extracted from the
input data (only included if <code>format&lt;3</code>)</p>
</dd>
<dt><code>Ns</code></dt><dd><p>a list containing the spontaneous fission track
counts (only included if <code>format&gt;1</code>)</p>
</dd>
<dt><code>U</code></dt><dd><p>a list of lists containing the U-concentration or
U/Ca-ratio measurements for each of the analysed grains (only
included if <code>format&gt;1</code>)</p>
</dd>
<dt><code>sU</code></dt><dd><p>a list of lists containing the standard errors of
the U-concentration or U/Ca-ratio measurements for each of the
analysed grains (only include if <code>format&gt;1</code>)</p>
</dd>
<dt><code>spotSize</code></dt><dd><p>the laser ablation spot size (only included
if <code>format&gt;1</code>)</p>
</dd>
</dl>

</li>
<li><p><code>detritals</code>: a list of named vectors, one for each
detrital sample.
</p>
</li>
<li><p><code>diseq</code>: is a class that contains the output of the
<code><a href="#topic+diseq">diseq</a></code> function, which stores initial disequilibrium
data for U&ndash;Pb geochronology.
</p>
</li></ul>



<h3>Value</h3>

<p><code>is.X(x)</code> returns a logical value.
</p>
<p><code>as.X(x)</code> returns an object of class <code>X</code>.
</p>


<h3>See Also</h3>

<p>read.data diseq
</p>


<h3>Examples</h3>

<pre><code class='language-R'>attach(examples)
ns &lt;- length(UPb)
concordia(UPb[-ns,])
if (is.PD(RbSr)) print('RbSr has class PD')

</code></pre>

<hr>
<h2 id='concordia'>Concordia diagram</h2><span id='topic+concordia'></span>

<h3>Description</h3>

<p>Plots U-Pb data on Wetherill, Tera-Wasserburg or U-Th-Pb concordia
diagrams, calculates concordia ages and compositions, evaluates the
equivalence of multiple
(<code class="reqn">^{206}</code>Pb/<code class="reqn">^{238}</code>U-<code class="reqn">^{207}</code>Pb/<code class="reqn">^{235}</code>U,
<code class="reqn">^{207}</code>Pb/<code class="reqn">^{206}</code>Pb-<code class="reqn">^{206}</code>Pb/<code class="reqn">^{238}</code>U, or
<code class="reqn">^{208}</code>Th/<code class="reqn">^{232}</code>Th-<code class="reqn">^{206}</code>Pb/<code class="reqn">^{238}</code>U)
compositions, computes the weighted mean isotopic composition and
the corresponding concordia age using the method of maximum
likelihood, computes the MSWD of equivalence and concordance and
their respective Chi-squared p-values. Performs linear regression
and computes the upper and lower intercept ages (for Wetherill) or
the lower intercept age and the <code class="reqn">^{207}</code>Pb/<code class="reqn">^{206}</code>Pb
intercept (for Tera-Wasserburg), taking into account error
correlations and decay constant uncertainties.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>concordia(
  x = NULL,
  tlim = NULL,
  type = 1,
  show.numbers = FALSE,
  levels = NA,
  clabel = "",
  ellipse.fill = c("#00FF0080", "#FF000080"),
  ellipse.stroke = "black",
  concordia.col = "darksalmon",
  exterr = FALSE,
  show.age = 0,
  oerr = 3,
  sigdig = 2,
  common.Pb = 0,
  ticks = 5,
  anchor = 0,
  hide = NULL,
  omit = NULL,
  omit.fill = NA,
  omit.stroke = "grey",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="concordia_+3A_x">x</code></td>
<td>
<p>an object of class <code>UPb</code></p>
</td></tr>
<tr><td><code id="concordia_+3A_tlim">tlim</code></td>
<td>
<p>age limits of the concordia line</p>
</td></tr>
<tr><td><code id="concordia_+3A_type">type</code></td>
<td>
<p>one of
</p>
<p><code>1</code>: Wetherill &ndash; <code class="reqn">{}^{206}</code>Pb/<code class="reqn">{}^{238}</code>U
vs. <code class="reqn">{}^{207}</code>Pb/<code class="reqn">{}^{235}</code>U
</p>
<p><code>2</code>: Tera-Wasserburg &ndash; <code class="reqn">{}^{207}</code>Pb/<code class="reqn">{}^{206}</code>Pb
vs. <code class="reqn">{}^{238}</code>U/<code class="reqn">{}^{206}</code>Pb
</p>
<p><code>3</code>: U-Th-Pb concordia &ndash; <code class="reqn">{}^{208}</code>Pb/<code class="reqn">{}^{232}</code>Th
vs. <code class="reqn">{}^{206}</code>Pb/<code class="reqn">{}^{238}</code>U (only available if
<code>x$format=7</code> or <code>8</code>)</p>
</td></tr>
<tr><td><code id="concordia_+3A_show.numbers">show.numbers</code></td>
<td>
<p>logical flag (<code>TRUE</code> to show grain
numbers)</p>
</td></tr>
<tr><td><code id="concordia_+3A_levels">levels</code></td>
<td>
<p>a vector with <code>length(x)</code> values to be displayed
as different background colours within the error ellipses.</p>
</td></tr>
<tr><td><code id="concordia_+3A_clabel">clabel</code></td>
<td>
<p>label for the colour legend (only used if
<code>levels</code> is not <code>NA</code>).</p>
</td></tr>
<tr><td><code id="concordia_+3A_ellipse.fill">ellipse.fill</code></td>
<td>
<p>Fill colour for the error ellipses. This can either be a single
colour or multiple colours to form a colour ramp. Examples:
</p>
<p>a single colour: <code>rgb(0,1,0,0.5)</code>, <code>'#FF000080'</code>,
<code>'white'</code>, etc.;
</p>
<p>multiple colours: <code>c(rbg(1,0,0,0.5)</code>,
<code>rgb(0,1,0,0.5))</code>, <code>c('#FF000080','#00FF0080')</code>,
<code>c('blue','red')</code>, <code>c('blue','yellow','red')</code>, etc.;
</p>
<p>a colour palette: <code>rainbow(n=100)</code>,
<code>topo.colors(n=100,alpha=0.5)</code>, etc.; or
</p>
<p>a reversed palette: <code>rev(topo.colors(n=100,alpha=0.5))</code>,
etc.
</p>
<p>For empty ellipses, set <code>ellipse.fill=NA</code></p>
</td></tr>
<tr><td><code id="concordia_+3A_ellipse.stroke">ellipse.stroke</code></td>
<td>
<p>the stroke colour for the error
ellipses. Follows the same formatting guidelines as
<code>ellipse.fill</code></p>
</td></tr>
<tr><td><code id="concordia_+3A_concordia.col">concordia.col</code></td>
<td>
<p>colour of the concordia line</p>
</td></tr>
<tr><td><code id="concordia_+3A_exterr">exterr</code></td>
<td>
<p>show decay constant uncertainties?</p>
</td></tr>
<tr><td><code id="concordia_+3A_show.age">show.age</code></td>
<td>
<p>one of either:
</p>
<p><code>0</code>: plot the data without calculating an age
</p>
<p><code>1</code>: fit a concordia composition and age
</p>
<p><code>2</code>: fit a discordia line through the data using the maximum
likelihood algorithm of Ludwig (1998), which assumes that the
scatter of the data is solely due to the analytical
uncertainties. In this case, <code>IsoplotR</code> will either calculate
an upper and lower intercept age (for Wetherill concordia), or a
lower intercept age and common
(<code class="reqn">^{207}</code>Pb/<code class="reqn">^{206}</code>Pb)-ratio intercept (for
Tera-Wasserburg). If <code>mswd</code>&gt;0, then the analytical
uncertainties are augmented by a factor <code class="reqn">\sqrt{mswd}</code>.
</p>
<p><code>3</code>: fit a discordia line ignoring the analytical uncertainties
</p>
<p><code>4</code>: fit a discordia line using a modified maximum likelihood
algorithm that includes accounts for any overdispersion by adding a
geological (co)variance term.</p>
</td></tr>
<tr><td><code id="concordia_+3A_oerr">oerr</code></td>
<td>
<p>indicates whether the analytical uncertainties of the
output are reported in the plot title as:
</p>
<p><code>1</code>: 1<code class="reqn">\sigma</code> absolute uncertainties.
</p>
<p><code>2</code>: 2<code class="reqn">\sigma</code> absolute uncertainties.
</p>
<p><code>3</code>: absolute (1-<code class="reqn">\alpha</code>)% confidence intervals, where
<code class="reqn">\alpha</code> equales the value that is stored in
<code>settings('alpha')</code>.
</p>
<p><code>4</code>: 1<code class="reqn">\sigma</code> relative uncertainties (<code class="reqn">\%</code>).
</p>
<p><code>5</code>: 2<code class="reqn">\sigma</code> relative uncertainties (<code class="reqn">\%</code>).
</p>
<p><code>6</code>: relative (1-<code class="reqn">\alpha</code>)% confidence intervals, where
<code class="reqn">\alpha</code> equales the value that is stored in
<code>settings('alpha')</code>.</p>
</td></tr>
<tr><td><code id="concordia_+3A_sigdig">sigdig</code></td>
<td>
<p>number of significant digits for the
concordia/discordia age</p>
</td></tr>
<tr><td><code id="concordia_+3A_common.pb">common.Pb</code></td>
<td>
<p>common lead projection:
</p>
<p><code>0</code>:none
</p>
<p><code>1</code>: use the Pb-composition stored in
</p>
<p><code>settings('iratio','Pb207Pb206')</code> (if <code>x$format&lt;4</code>);
</p>
<p><code>settings('iratio','Pb206Pb204')</code> and
<code>settings('iratio','Pb207Pb204')</code> (if <code>3&lt;x$format&lt;7</code>); or
</p>
<p><code>settings('iratio','Pb208Pb206')</code> and
<code>settings('iratio','Pb208Pb207')</code> (if <code>x$format&gt;6</code>).
</p>
<p><code>2</code>: use the isochron intercept as the initial
Pb-composition. If <code>show.age&gt;1</code>, the data are projected along
the isochron line, but the isochron itself is based on the
uncorrected data.
</p>
<p><code>3</code>: use the Stacey-Kramers two-stage model to infer the initial
Pb-composition.</p>
</td></tr>
<tr><td><code id="concordia_+3A_ticks">ticks</code></td>
<td>
<p>either a scalar indicating the desired number of age
ticks to be placed along the concordia line, OR a vector of
tick ages.</p>
</td></tr>
<tr><td><code id="concordia_+3A_anchor">anchor</code></td>
<td>
<p>control parameters to fix the intercept age or common Pb
composition of the isochron fit. This can be a scalar or a vector.
</p>
<p>If <code>anchor[1]=0</code>: do not anchor the isochron.
</p>
<p>If <code>anchor[1]=1</code>: fix the common Pb composition at the values
stored in <code>settings('iratio',...)</code>.
</p>
<p>If <code>anchor[1]=2</code>: force the isochron line to intersect the
concordia line at an age equal to <code>anchor[2]</code>.
</p>
<p>If <code>anchor[1]=3</code>: anchor the non-radiogenic component to the
Stacey-Kramers mantle evolution model.</p>
</td></tr>
<tr><td><code id="concordia_+3A_hide">hide</code></td>
<td>
<p>vector with indices of aliquots that should be removed
from the concordia diagram</p>
</td></tr>
<tr><td><code id="concordia_+3A_omit">omit</code></td>
<td>
<p>vector with indices of aliquots that should be plotted
but omitted from concordia or discordia age calculation</p>
</td></tr>
<tr><td><code id="concordia_+3A_omit.fill">omit.fill</code></td>
<td>
<p>fill colour that should be used for the omitted
aliquots.</p>
</td></tr>
<tr><td><code id="concordia_+3A_omit.stroke">omit.stroke</code></td>
<td>
<p>stroke colour that should be used for the
omitted aliquots.</p>
</td></tr>
<tr><td><code id="concordia_+3A_...">...</code></td>
<td>
<p>optional arguments passed on to <code><a href="#topic+scatterplot">scatterplot</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The concordia diagram is a graphical means of assessing the
internal consistency of U-Pb data. It sets out the measured
<code class="reqn">^{206}</code>Pb/<code class="reqn">^{238}</code>U- and
<code class="reqn">^{207}</code>Pb/<code class="reqn">^{235}</code>U-ratios against each other (&lsquo;Wetherill&rsquo;
diagram); or, equivalently, the <code class="reqn">^{207}</code>Pb/<code class="reqn">^{206}</code>Pb- and
<code class="reqn">^{206}</code>Pb/<code class="reqn">^{238}</code>U-ratios (&lsquo;Tera-Wasserburg&rsquo;
diagram). Alternatively, for data format 7 and 8, it is also
possible to plot <code class="reqn">^{208}</code>Pb/<code class="reqn">^{232}</code>Th against the
<code class="reqn">^{206}</code>Pb/<code class="reqn">^{238}</code>U.  The space of concordant isotopic
compositions is marked by a curve, the &lsquo;concordia line&rsquo;. Isotopic
ratio measurements are shown as 100(1-<code>alpha</code>)% confidence
ellipses. Concordant samples plot near to, or overlap with, the
concordia line. They represent the pinnacle of geochronological
robustness. Samples that plot away from the concordia line but are
aligned along a linear trend form an isochron (or &lsquo;discordia&rsquo; line)
that can be used to infer the composition of the non-radiogenic
(&lsquo;common&rsquo;) lead or to constrain the timing of prior lead loss.
</p>


<h3>Value</h3>

<p>If <code>show.age=1</code>, returns a list with the following items:
</p>

<dl>
<dt>x</dt><dd><p> a named vector with the (weighted mean) U-Pb composition </p>
</dd>
<dt>cov</dt><dd><p> the covariance matrix of the (weighted mean) U-Pb composition </p>
</dd>
<dt>mswd</dt><dd><p> a vector with three items (<code>equivalence</code>,
<code>concordance</code> and <code>combined</code>) containing the MSWD (Mean
of the Squared Weighted Deviates, a.k.a the reduced Chi-squared
statistic) of isotopic equivalence, age concordance and combined
goodness of fit, respectively. </p>
</dd>
<dt>p.value</dt><dd><p> a vector with three items (<code>equivalence</code>,
<code>concordance</code> and <code>combined</code>) containing the p-value of
the Chi-square test for isotopic equivalence, age concordance and
combined goodness of fit, respectively. </p>
</dd>
<dt>df</dt><dd><p> a three-element vector with the number of degrees of
freedom used for the <code>mswd</code> calculation. </p>
</dd>
<dt>age</dt><dd><p>a two-or three-element vector with:<br />
<code>t</code>: the concordia age (in Ma)<br />
<code>s[t]</code>: the standard error of <code>t</code><br />
<code>disp[t]</code>: the standard error of <code>t</code> augmented by
<code class="reqn">\sqrt{mswd}</code> to account for any overdispersion. </p>
</dd>
</dl>

<p>If <code>show.age=2</code>, <code>3</code> or <code>4</code>, returns a list with the
following items:
</p>

<dl>
<dt>model</dt><dd><p>the fitting model (<code>=show.age-1</code>).</p>
</dd>
<dt>par</dt><dd><p>a vector with the upper and lower intercept ages (if
<code>type=1</code>) or the lower intercept age and common Pb
intercept(s) (if <code>type=2</code>). If <code>show.age=4</code>, includes an
overdispersion term as well.</p>
</dd>
<dt>cov</dt><dd><p> the covariance matrix of the elements in <code>par</code>.</p>
</dd>
<dt>logpar</dt><dd><p>the logarithm of <code>par</code></p>
</dd>
<dt>logcov</dt><dd><p>the logarithm of <code>cov</code></p>
</dd>
<dt>err</dt><dd><p> a matrix with on or two rows:
</p>
<p><code>s</code>: the standard errors of the parameter estimates
</p>
<p><code>disp</code>: the standard errors of the parameter estimates
augmented by <code class="reqn">\sqrt{mswd}</code> to account for overdispersed
datasets (only reported if <code>show.age=2</code>). </p>
</dd>
<dt>df</dt><dd><p> the degrees of freedom of the concordia fit (concordance
+ equivalence)</p>
</dd>
<dt>p.value</dt><dd><p> p-value of a Chi-square test for age homogeneity
(only reported if <code> type=3</code>).</p>
</dd>
<dt>mswd</dt><dd><p> mean square of the weighted deviates &ndash; a
goodness-of-fit measure. <code>mswd &gt; 1</code> indicates overdispersion
w.r.t the analytical uncertainties (not reported if
<code>show.age=3</code>).</p>
</dd>
<dt>n</dt><dd><p> the number of aliquots in the dataset </p>
</dd>
</dl>



<h3>References</h3>

<p>Ludwig, K.R., 1998. On the treatment of concordant
uranium-lead ages. Geochimica et Cosmochimica Acta, 62(4),
pp.665-676.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>attach(examples)
concordia(UPb,show.age=2)

dev.new()
concordia(UPb,type=2,xlim=c(24.9,25.4),
          ylim=c(0.0508,0.0518),ticks=249:254,exterr=TRUE)

dev.new()
concordia(UPb,show.age=2,anchor=c(2,260))

</code></pre>

<hr>
<h2 id='data2york'>Prepare geochronological data for York regression</h2><span id='topic+data2york'></span><span id='topic+data2york.default'></span><span id='topic+data2york.other'></span><span id='topic+data2york.UPb'></span><span id='topic+data2york.ArAr'></span><span id='topic+data2york.ThPb'></span><span id='topic+data2york.KCa'></span><span id='topic+data2york.PbPb'></span><span id='topic+data2york.PD'></span><span id='topic+data2york.UThHe'></span><span id='topic+data2york.ThU'></span>

<h3>Description</h3>

<p>Takes geochronology data as input and produces a five-column table
with the variables, their uncertainties and error correlations as
output. These can subsequently be used for York regression.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data2york(x, ...)

## Default S3 method:
data2york(x, format = 1, ...)

## S3 method for class 'other'
data2york(x, ...)

## S3 method for class 'UPb'
data2york(x, option = 1, tt = 0, ...)

## S3 method for class 'ArAr'
data2york(x, inverse = TRUE, ...)

## S3 method for class 'ThPb'
data2york(x, inverse = FALSE, ...)

## S3 method for class 'KCa'
data2york(x, inverse = FALSE, ...)

## S3 method for class 'PbPb'
data2york(x, inverse = TRUE, ...)

## S3 method for class 'PD'
data2york(x, exterr = FALSE, inverse = FALSE, ...)

## S3 method for class 'UThHe'
data2york(x, ...)

## S3 method for class 'ThU'
data2york(x, type = 2, generic = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="data2york_+3A_x">x</code></td>
<td>
<p>a five or six column matrix OR an object of class
<code>UPb</code>, <code>PbPb</code>, <code>ThPb</code>, <code>ArAr</code>, <code>ThU</code>,
<code>UThHe</code>, or <code>PD</code> (which includes objects of class
<code>RbSr</code>, <code>SmNd</code>, <code>LuHf</code> and <code>ReOs</code>),
generated by the <code>read.data(...)</code> function</p>
</td></tr>
<tr><td><code id="data2york_+3A_...">...</code></td>
<td>
<p>optional arguments</p>
</td></tr>
<tr><td><code id="data2york_+3A_format">format</code></td>
<td>
<p>one of
</p>
<p><code>1</code> or <code>2</code>: <code>X</code>, <code>s[X]</code>, <code>Y</code>, <code>s[Y]</code>,
<code>rXY</code>; where <code>rXY</code> is the error correlation between
<code>X</code> and <code>Y</code>; or
</p>
<p><code>3</code>: <code>X/Z</code>, <code>s[X/Z]</code>, <code>Y/Z</code>, <code>s[Y/Z]</code>,
<code>X/Y</code>, <code>s[X/Y]</code>; for which the error correlations are
automatically computed from the redundancy of the three ratios.</p>
</td></tr>
<tr><td><code id="data2york_+3A_option">option</code></td>
<td>
<p>one of
</p>
<p><code>1</code>: Wetherill concordia ratios: <code>X=07/35</code>,
<code>sX=s[07/35]</code>, <code>Y=06/38</code>, <code>sY=s[06/38]</code>, <code>rXY</code>.
</p>
<p><code>2</code>: Tera-Wasserburg ratios: <code>X=38/06</code>,
<code>sX=s[38/06]</code>, <code>Y=07/06</code>, <code>sY=s[07/06]</code>, <code>rXY</code>.
</p>
<p><code>3</code>: <code>X=38/06</code>, <code>sX=s[38/06]</code>, <code>Y=04/06</code>,
<code>sY=s[04/06]</code>, <code>rXY</code> (only valid if <code>x$format=4,5</code>
or <code>6</code>).
</p>
<p><code>4</code>: <code>X=35/07</code>, <code>sX=s[35/07]</code>, <code>Y=04/07</code>,
<code>sY=s[04/07]</code>, <code>rXY</code> (only valid if <code>x$format=4,5</code>
or <code>6</code>).
</p>
<p><code>5</code>: U-Th-Pb concordia ratios: <code>X=06/38</code>,
<code>sX=s[06/38]</code>, <code>Y=08/32</code>, <code>sY=s[08/32]</code>,
<code>rXY</code> (only valid if <code>x$format=7,8</code>).
</p>
<p><code>6</code>: <code>X=38/06</code>, <code>sX=s[38/06]</code>, <code>Y=08/06</code>,
<code>sY=s[08/06]</code>, <code>rXY</code> (only valid if <code>x$format=7,8</code>).
</p>
<p><code>7</code>: <code>X=35/07</code>, <code>sX=s[35/07]</code>, <code>Y=08/07</code>,
<code>sY=s[08/07]</code>, <code>rXY</code> (only valid if <code>x$format=7,8</code>).
</p>
<p><code>8</code>: <code>X=32/08</code>, <code>sX=s[32/08]</code>, <code>Y=06/08</code>,
<code>sY=s[06/08]</code>, <code>rXY</code> (only valid if <code>x$format=7,8</code>).
</p>
<p><code>9</code>: <code>X=32/08</code>, <code>sX=s[32/08]</code>, <code>Y=07/08</code>,
<code>sY=s[07/08]</code>, <code>rXY</code> (only valid if <code>x$format=7,8</code>).</p>
</td></tr>
<tr><td><code id="data2york_+3A_tt">tt</code></td>
<td>
<p>the age of the sample. This is only used if
<code>x$format=7</code> or <code>8</code>, in order to calculate the
inherited <code class="reqn">{}^{208}</code>Pb/<code class="reqn">{}^{232}</code>Th ratio.</p>
</td></tr>
<tr><td><code id="data2york_+3A_inverse">inverse</code></td>
<td>
<p>toggles between normal and inverse isochron
ratios. <code>data2york</code> returns five columns <code>X</code>,
<code>s[X]</code>, <code>Y</code>, <code>s[Y]</code> and <code>r[X,Y]</code>.
</p>
<p>If <code>inverse=TRUE</code>, then <code>X</code> =
<code class="reqn">{}^{204}</code>Pb/<code class="reqn">{}^{206}</code>Pb and <code>Y</code> =
<code class="reqn">{}^{207}</code>Pb/<code class="reqn">{}^{206}</code>Pb (if <code>x</code> has class
<code>PbPb</code>), or <code>X</code> = <code class="reqn">{}^{232}</code>Th/<code class="reqn">{}^{208}</code>Pb and
<code>Y</code> = <code class="reqn">{}^{204}</code>Pb/<code class="reqn">{}^{208}</code>Pb (if <code>x</code> has class
<code>ThPb</code>), or <code>X</code> = <code class="reqn">{}^{39}</code>Ar/<code class="reqn">{}^{40}</code>Ar and
<code>Y</code> = <code class="reqn">{}^{36}</code>Ar/<code class="reqn">{}^{40}</code>Ar (if <code>x</code> has class
<code>ArAr</code>), or <code>X</code> = <code class="reqn">{}^{40}</code>K/<code class="reqn">{}^{40}</code>Ca and
<code>Y</code> = <code class="reqn">{}^{44}</code>Ca/<code class="reqn">{}^{40}</code>Ca (if <code>x</code> has class
<code>KCa</code>), or <code>X</code> = <code class="reqn">{}^{87}</code>Rb/<code class="reqn">{}^{87}</code>Sr and
<code>Y</code> = <code class="reqn">{}^{86}</code>Sr/<code class="reqn">{}^{87}</code>Sr (if <code>x</code> has class
<code>RbSr</code>), or <code>X</code> = <code class="reqn">{}^{147}</code>Sm/<code class="reqn">{}^{143}</code>Nd and
<code>Y</code> = <code class="reqn">{}^{144}</code>Nd/<code class="reqn">{}^{143}</code>Nd (if <code>x</code> has class
<code>SmNd</code>), or <code>X</code> = <code class="reqn">{}^{187}</code>Re/<code class="reqn">{}^{187}</code>Os and
<code>Y</code> = <code class="reqn">{}^{188}</code>Os/<code class="reqn">{}^{187}</code>Os (if <code>x</code> has class
<code>ReOs</code>), or <code>X</code> = <code class="reqn">{}^{176}</code>Lu/<code class="reqn">{}^{176}</code>Hf and
<code>Y</code> = <code class="reqn">{}^{177}</code>Hf/<code class="reqn">{}^{176}</code>Hf (if <code>x</code> has class
<code>LuHf</code>).
</p>
<p>If <code>inverse=FALSE</code>, then <code>X</code> =
<code class="reqn">{}^{206}</code>Pb/<code class="reqn">{}^{204}</code>Pb and <code>Y</code> =
<code class="reqn">{}^{207}</code>Pb/<code class="reqn">{}^{204}</code>Pb (if <code>x</code> has class
<code>PbPb</code>), or <code>X</code> = <code class="reqn">{}^{232}</code>Th/<code class="reqn">{}^{204}</code>Pb and
<code>Y</code> = <code class="reqn">{}^{208}</code>Pb/<code class="reqn">{}^{204}</code>Pb (if <code>x</code> has class
<code>ThPb</code>), or <code>X</code> = <code class="reqn">{}^{39}</code>Ar/<code class="reqn">{}^{36}</code>Ar and
<code>Y</code> = <code class="reqn">{}^{40}</code>Ar/<code class="reqn">{}^{36}</code>Ar (if <code>x</code> has class
<code>ArAr</code>), or <code>X</code> = <code class="reqn">{}^{40}</code>K/<code class="reqn">{}^{44}</code>Ca and
<code>Y</code> = <code class="reqn">{}^{40}</code>Ca/<code class="reqn">{}^{44}</code>Ca (if <code>x</code> has class
<code>KCa</code>), or <code>X</code> = <code class="reqn">{}^{87}</code>Rb/<code class="reqn">{}^{86}</code>Sr and
<code>Y</code> = <code class="reqn">{}^{87}</code>Sr/<code class="reqn">{}^{86}</code>Sr (if <code>x</code> has class
<code>RbSr</code>), or <code>X</code> = <code class="reqn">{}^{147}</code>Sm/<code class="reqn">{}^{144}</code>Nd and
<code>Y</code> = <code class="reqn">{}^{143}</code>Nd/<code class="reqn">{}^{144}</code>Nd (if <code>x</code> has class
<code>SmNd</code>), or <code>X</code> = <code class="reqn">{}^{187}</code>Re/<code class="reqn">{}^{188}</code>Os and
<code>Y</code> = <code class="reqn">{}^{187}</code>Os/<code class="reqn">{}^{188}</code>Os (if <code>x</code> has class
<code>ReOs</code>), or <code>X</code> = <code class="reqn">{}^{176}</code>Lu/<code class="reqn">{}^{177}</code>Hf and
<code>Y</code> = <code class="reqn">{}^{176}</code>Hf/<code class="reqn">{}^{177}</code>Hf (if <code>x</code> has class
<code>LuHf</code>).</p>
</td></tr>
<tr><td><code id="data2york_+3A_exterr">exterr</code></td>
<td>
<p>If <code>TRUE</code>, propagates the external uncertainties
(e.g. decay constants) into the output errors.</p>
</td></tr>
<tr><td><code id="data2york_+3A_type">type</code></td>
<td>
<p>Return &lsquo;Rosholt&rsquo; or &lsquo;Osmond&rsquo; ratios?
</p>
<p>Rosholt (<code>type=1</code>) returns <code>X=8/2</code>, <code>sX=s[8/2]</code>,
<code>Y=0/2</code>, <code>sY=s[0/2]</code>, <code>rXY</code>.
</p>
<p>Osmond (<code>type=2</code>) returns <code>X=2/8</code>, <code>sX=s[2/8]</code>,
<code>Y=0/8</code>, <code>sY=s[0/8]</code>, <code>rXY</code>.</p>
</td></tr>
<tr><td><code id="data2york_+3A_generic">generic</code></td>
<td>
<p>If <code>TRUE</code>, uses the following column headers:
<code>X</code>, <code>sX</code>, <code>Y</code>, <code>sY</code>, <code>rXY</code>.
</p>
<p>If <code>FALSE</code> and <code>type=1</code>, uses <code>U238Th232</code>,
<code>errU238Th232</code>, <code>Th230Th232</code>, <code>errTh230Th232</code>, <code>rXY</code>
</p>
<p>or if <code>FALSE</code> and <code>type=2</code>, uses <code>Th232U238</code>,
<code>errTh232U238</code>, <code>Th230U238</code>, <code>errTh230U238</code>, <code>rXY</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a five-column table that can be used as input for
<code><a href="#topic+york">york</a></code>-regression.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+york">york</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>f &lt;- system.file("RbSr1.csv",package="IsoplotR")
dat &lt;- read.csv(f)
yorkdat &lt;- data2york(dat)
fit &lt;- york(yorkdat)

</code></pre>

<hr>
<h2 id='discfilter'>Set up a discordance filter</h2><span id='topic+discfilter'></span>

<h3>Description</h3>

<p>Define a discordance cutoff to filter U&ndash;Pb data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>discfilter(option = 0, before = TRUE, cutoff)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="discfilter_+3A_option">option</code></td>
<td>
<p>one of five options:
</p>
<p><code>0</code>: do not apply a discordance filter
</p>
<p><code>1</code> or <code>'t'</code>: the absolute age difference (Ma) between
the <code class="reqn">^{206}</code>Pb/<code class="reqn">^{238}</code>U and <code class="reqn">^{207}</code>Pb/<code class="reqn">^{206}</code>Pb
ages.
</p>
<p><code>2</code> or <code>'r'</code>: the relative age difference (%) between the
<code class="reqn">^{206}</code>Pb/<code class="reqn">^{238}</code>U and <code class="reqn">^{207}</code>Pb/<code class="reqn">^{206}</code>Pb ages.
</p>
<p><code>3</code> or <code>'sk'</code>: percentage of common Pb measured along a
mixing line connecting the measured composition and the
Stacey-Kramers mantle composition in Tera-Wasserburg space.
</p>
<p><code>4</code> or <code>'a'</code>: logratio distance (%) measured along a
perpendicular line connecting Tera-Wasserburg concordia and the
measured composition.
</p>
<p><code>5</code> or <code>'c'</code>: logratio distance (%) measured along a
line connecting the measured composition and the corresponding
single grain concordia age composition.
</p>
<p>Further details in Vermeesch (2021).</p>
</td></tr>
<tr><td><code id="discfilter_+3A_before">before</code></td>
<td>
<p>logical flag indicating whether the discordance
filter should be applied before (<code>TRUE</code>) or after
(<code>FALSE</code>) the common-Pb correction.</p>
</td></tr>
<tr><td><code id="discfilter_+3A_cutoff">cutoff</code></td>
<td>
<p>a two-element vector with the minimum (negative) and
maximum (positive) allowed discordance. Default values vary
between the different options. To view them, enter
<code>discfilter(option)</code> at the <code>R</code> command line.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The most reliable U&ndash;Pb age constraints are obtained from
(zircon) grains whose <code class="reqn">^{206}</code>Pb/<code class="reqn">^{238}</code>U and
<code class="reqn">^{207}</code>Pb/<code class="reqn">^{206}</code>Pb ages are statistically
indistinguishable from each other. U&ndash;Pb compositions that
fulfil this requirements are called &lsquo;concordant&rsquo;. Those that
violate it are called &lsquo;discordant&rsquo;. The discordance of the
<code class="reqn">^{206}</code>Pb/<code class="reqn">^{238}</code>U and <code class="reqn">^{207}</code>Pb/<code class="reqn">^{206}</code>Pb
systems can be defined in five different ways. By setting a
cutoff for any of these criteria, U&ndash;Pb data can be filtered
for data quality.
</p>


<h3>Value</h3>

<p>a list with the input parameters. Default values for
<code>cutoff</code> are
</p>
<p><code>c(-48,140)</code> if <code>option=='t'</code>;
</p>
<p><code>c(-5,15)</code> if <code>option=='r'</code>;
</p>
<p><code>c(-0.36,0.96)</code> if <code>option=='sk'</code>;
</p>
<p><code>c(-1.6,4.7)</code> if <code>option=='a'</code>; and
</p>
<p><code>c(-2,5.8)</code> if <code>option=='c'</code>.
</p>


<h3>References</h3>

<p>Vermeesch (2021) &ldquo;On the treatment of discordant data
in detrital zircon U&ndash;Pb geochronology&rdquo;, Geochronology.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cad">cad</a></code>, <code><a href="#topic+kde">kde</a></code>,
<code><a href="#topic+radialplot">radialplot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dscf &lt;- discfilter(option='c',before=TRUE,cutoff=c(-1,1))
weightedmean(x=examples$UPb,exterr=FALSE,sigdig=2,
             cutoff.disc=dscf,common.Pb=3)

</code></pre>

<hr>
<h2 id='diseq'>Set up U-series disequilibrium correction for U-Pb
geochronology</h2><span id='topic+diseq'></span>

<h3>Description</h3>

<p>The U-Pb method conventionally assumes initial secular
equilibrium of all the intermediate daughters of the
<code class="reqn">{}^{238}</code>U-<code class="reqn">{}^{206}</code>Pb and
<code class="reqn">{}^{235}</code>U-<code class="reqn">{}^{207}</code>Pb decay chains.  Violation of
this assumption may produce inaccurate results.  <code>diseq</code>
sets up initial disequilibrium parameters that are subsequently
passed on to the <code>read.data</code> function for incorporation in
other functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>diseq(
  U48 = list(x = 1, sx = 0, option = 0, m = 0, M = 20, x0 = 1, sd = 10),
  ThU = list(x = 1, sx = 0, option = 0, m = 0, M = 20, x0 = 1, sd = 10),
  RaU = list(x = 1, sx = 0, option = 0, m = 0, M = 20, x0 = 1, sd = 10),
  PaU = list(x = 1, sx = 0, option = 0, m = 0, M = 20, x0 = 1, sd = 10),
  buffer = 1e-05
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="diseq_+3A_u48">U48</code></td>
<td>
<p>a list containing seven items (<code>x</code>, <code>sx</code>,
<code>m</code>, <code>M</code>, <code>x0</code>, <code>sd</code> and <code>option</code>)
specifying the <code class="reqn">{}^{234}</code>U/<code class="reqn">{}^{238}</code>U disequilibrium.
</p>
<p>If <code>option=0</code>, then <code>x</code> and <code>sx</code> are ignored and no
disequilibrium correction is applied.
</p>
<p>If <code>option=1</code>, then <code>x</code> contains the initial
<code class="reqn">{}^{234}</code>U/<code class="reqn">{}^{238}</code>U ratio and <code>sx</code> its
standard error.
</p>
<p>If <code>option=2</code>, then <code>x</code> contains the measured
<code class="reqn">{}^{234}</code>U/<code class="reqn">{}^{238}</code>U ratio and <code>sx</code> its
standard error.
</p>
<p><code>m</code>, <code>M</code> specify the minimum and maximum search limits of
the initial <code class="reqn">{}^{234}</code>U/<code class="reqn">{}^{238}</code>U activity ratio.
</p>
<p><code>x0</code> and <code>sd</code> specify the mean and standard deviation of
the prior distribution for the the initial
<code class="reqn">{}^{234}</code>U/<code class="reqn">{}^{238}</code>U activity ratio.</p>
</td></tr>
<tr><td><code id="diseq_+3A_thu">ThU</code></td>
<td>
<p>a list containing seven items (<code>x</code>, <code>sx</code>,
<code>m</code>, <code>M</code>, <code>x0</code>, <code>sd</code> and <code>option</code>)
specifying the <code class="reqn">{}^{230}</code>Th/<code class="reqn">{}^{238}</code>U disequilibrium.
</p>
<p>If <code>option=0</code>, then <code>x</code> and <code>sx</code> are ignored and no
disequilibrium correction is applied.
</p>
<p>If <code>option=1</code>, then <code>x</code> contains the initial
<code class="reqn">{}^{230}</code>Th/<code class="reqn">{}^{238}</code>U ratio and <code>sx</code> its
standard error.
</p>
<p>If <code>option=2</code>, then <code>x</code> contains the measured
<code class="reqn">{}^{230}</code>Th/<code class="reqn">{}^{238}</code>U ratio and <code>sx</code> its
standard error.
</p>
<p>If <code>option=3</code>, then <code>x</code> contains the measured Th/U ratio
of the magma (assumed or determined from the whole rock or
volcanic glass) and <code>sx</code> its standard error. This only
applies for Th-bearing U-Pb data formats 7 and 8.
</p>
<p><code>m</code>, <code>M</code>, <code>x0</code> and <code>sd</code> are analogous to the
eponymous settings for <code>ThU</code>.</p>
</td></tr>
<tr><td><code id="diseq_+3A_rau">RaU</code></td>
<td>
<p>a list containing seven items (<code>x</code>, <code>sx</code>,
<code>m</code>, <code>M</code>, <code>x0</code>, <code>sd</code> and <code>option</code>)
specifying the <code class="reqn">{}^{226}</code>Ra/<code class="reqn">{}^{238}</code>U disequilibrium.
</p>
<p>If <code>option=0</code>, then <code>x</code> and <code>sx</code> are ignored and no
disequilibrium correction is applied.
</p>
<p>If <code>option=1</code>, then <code>x</code> contains the initial
<code class="reqn">{}^{226}</code>Ra/<code class="reqn">{}^{238}</code>U ratio and <code>sx</code> its
standard error.
</p>
<p><code>m</code>, <code>M</code>, <code>x0</code> and <code>sd</code> are analogous to the
eponymous settings for <code>ThU</code>.</p>
</td></tr>
<tr><td><code id="diseq_+3A_pau">PaU</code></td>
<td>
<p>a list containing seven items (<code>x</code>, <code>sx</code>,
<code>m</code>, <code>M</code>, <code>x0</code>, <code>sd</code> and <code>option</code>)
specifying the <code class="reqn">{}^{231}</code>Pa/<code class="reqn">{}^{235}</code>U disequilibrium.
</p>
<p>If <code>option=0</code>, then <code>x</code> and <code>sx</code> are ignored and no
disequilibrium correction is applied.
</p>
<p>If <code>option=1</code>, then <code>x</code> contains the initial
<code class="reqn">{}^{231}</code>Pa/<code class="reqn">{}^{235}</code>U ratio and <code>sx</code> its
standard error.
</p>
<p><code>m</code>, <code>M</code>, <code>x0</code> and <code>sd</code> are analogous to the
eponymous settings for <code>ThU</code>.</p>
</td></tr>
<tr><td><code id="diseq_+3A_buffer">buffer</code></td>
<td>
<p>small amount of padding to avoid singularities in the
prior distribution, which uses a logistic transformation:
<code class="reqn">y = \ln\left(\frac{x-m+buffer}{M+buffer-x}\right)</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>There are three ways to correct for the initial disequilibrium
between the activity of <code class="reqn">{}^{238}</code>U, <code class="reqn">{}^{234}</code>U,
<code class="reqn">{}^{230}</code>Th, and <code class="reqn">{}^{226}</code>Ra; or between <code class="reqn">{}^{235}</code>U
and <code class="reqn">{}^{231}</code>Pa:
</p>

<ol>
<li><p>Specify the assumed initial activity ratios and calculate how
much excess <code class="reqn">{}^{206}</code>Pb and <code class="reqn">{}^{207}</code>Pb these would have
produced.
</p>
</li>
<li><p>Measure the current activity ratios to infer the initial
ratios.  This approach only works for young samples.
</p>
</li>
<li><p>The initial <code class="reqn">{}^{230}</code>Th/<code class="reqn">{}^{238}</code>U activity ratio
can also be estimated by providing the Th/U-ratio of the magma.
</p>
</li></ol>



<h3>Value</h3>

<p>a list with the following items:
</p>

<dl>
<dt>U48, ThU, RaU, PaU</dt><dd><p>the same as the corresponding input arguments</p>
</dd>
<dt>equilibrium</dt><dd><p>a boolean flag indicating whether
<code>option=TRUE</code> and/or <code>x=1</code> for all activity ratios</p>
</dd>
<dt>Q</dt><dd><p>the eigenvectors of the disequilibrium matrix exponential</p>
</dd>
<dt>Qinv</dt><dd><p>the inverse of <code>Q</code></p>
</dd>
<dt>L</dt><dd><p>a named vector of all the relevant decay constants</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+mclean">mclean</a></code>, <code><a href="#topic+concordia">concordia</a></code>,
<code><a href="#topic+ludwig">ludwig</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d &lt;- diseq(U48=list(x=0,option=1),ThU=list(x=2,option=1),
           RaU=list(x=2,option=1),PaU=list(x=2,option=1))
fn &lt;- system.file("diseq.csv",package="IsoplotR")
UPb &lt;- read.data(fn,method='U-Pb',format=2,d=d)
concordia(UPb,type=2,xlim=c(0,700),ylim=c(0.05,0.5))
</code></pre>

<hr>
<h2 id='diss'>Dissimilarity between detrital age distributions</h2><span id='topic+diss'></span><span id='topic+diss.default'></span><span id='topic+diss.detritals'></span>

<h3>Description</h3>

<p>Calculates the pairwise dissimilarity between detrital
age distributions, using either the Wasserstein-2 or
Kolmogorov-Smirnov distance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>diss(x, ...)

## Default S3 method:
diss(x, y, method = "KS", ...)

## S3 method for class 'detritals'
diss(x, method = "W2", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="diss_+3A_x">x</code></td>
<td>
<p>an object of class <code>detrital</code> OR a vector of numbers</p>
</td></tr>
<tr><td><code id="diss_+3A_...">...</code></td>
<td>
<p>extra arguments (not used)</p>
</td></tr>
<tr><td><code id="diss_+3A_y">y</code></td>
<td>
<p>a vector of numbers</p>
</td></tr>
<tr><td><code id="diss_+3A_method">method</code></td>
<td>
<p>either <code>'KS'</code> (for Kolmogorov-Smirnov distance),
or <code>'W2'</code> (for Wasserstein-2 distance).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Kolmogorov-Smirnov statistic is the maximum vertical
difference between two empirical cumulative distribution
functions. The Wasserstein distance is a function of the area
between them. Both dissimilarity measures are useful for
multidimensional scaling.
</p>


<h3>Value</h3>

<p>an object of class <code>dist</code>.
</p>


<h3>Author(s)</h3>

<p>Written by Pieter Vermeesch, using modified code from
Mathieu Vrac's <code>CDFt</code> package (<code>KolmogorovSmirnov</code>
function), and Dominic Schuhmacher's <code>transport</code> package
(<code>transport1d</code> function).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mds">mds</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d &lt;- diss(examples$DZ,method='KS')
mds(d)
</code></pre>

<hr>
<h2 id='ellipse'>Get error ellipse coordinates for plotting</h2><span id='topic+ellipse'></span>

<h3>Description</h3>

<p>Constructs an error ellipse at a given confidence level
from its centre and covariance matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ellipse(x, y, covmat, alpha = 0.05, n = 50)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ellipse_+3A_x">x</code></td>
<td>
<p>x-coordinate (scalar) for the centre of the ellipse</p>
</td></tr>
<tr><td><code id="ellipse_+3A_y">y</code></td>
<td>
<p>y-coordinate (scalar) for the centre of the ellipse</p>
</td></tr>
<tr><td><code id="ellipse_+3A_covmat">covmat</code></td>
<td>
<p>the [<code>2x2</code>] covariance matrix of the x-y coordinates</p>
</td></tr>
<tr><td><code id="ellipse_+3A_alpha">alpha</code></td>
<td>
<p>the probability cutoff for the error ellipses</p>
</td></tr>
<tr><td><code id="ellipse_+3A_n">n</code></td>
<td>
<p>the resolution (number of segments) of the error ellipses</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an [<code>nx2</code>] matrix of plot coordinates
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x = 99; y = 101;
covmat &lt;- matrix(c(1,0.9,0.9,1),nrow=2)
ell &lt;- ellipse(x,y,covmat)
plot(c(90,110),c(90,110),type='l')
polygon(ell,col=rgb(0,1,0,0.5))
points(x,y,pch=21,bg='black')
</code></pre>

<hr>
<h2 id='evolution'>Th-U evolution diagram</h2><span id='topic+evolution'></span>

<h3>Description</h3>

<p>Plots Th-U data on a
<code class="reqn">^{234}</code>U/<code class="reqn">^{238}</code>U-<code class="reqn">^{230}</code>Th/<code class="reqn">^{238}</code>U evolution
diagram, a <code class="reqn">^{234}</code>U/<code class="reqn">^{238}</code>U-age diagram, or (if
<code class="reqn">^{234}</code>U/<code class="reqn">^{238}</code>U is assumed to be in secular
equilibrium), a
<code class="reqn">^{230}</code>Th/<code class="reqn">^{232}</code>Th-<code class="reqn">^{238}</code>U/<code class="reqn">^{232}</code>Th diagram;
calculates isochron ages.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>evolution(
  x,
  xlim = NULL,
  ylim = NULL,
  oerr = 3,
  transform = FALSE,
  Th0i = 0,
  show.numbers = FALSE,
  levels = NA,
  clabel = "",
  ellipse.fill = c("#00FF0080", "#FF000080"),
  ellipse.stroke = "black",
  line.col = "darksalmon",
  isochron = FALSE,
  model = 1,
  exterr = FALSE,
  sigdig = 2,
  hide = NULL,
  omit = NULL,
  omit.fill = NA,
  omit.stroke = "grey",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="evolution_+3A_x">x</code></td>
<td>
<p>an object of class <code>ThU</code></p>
</td></tr>
<tr><td><code id="evolution_+3A_xlim">xlim</code></td>
<td>
<p>x-axis limits</p>
</td></tr>
<tr><td><code id="evolution_+3A_ylim">ylim</code></td>
<td>
<p>y-axis limits</p>
</td></tr>
<tr><td><code id="evolution_+3A_oerr">oerr</code></td>
<td>
<p>indicates whether the analytical uncertainties of the
output are reported in the plot title as:
</p>
<p><code>1</code>: 1<code class="reqn">\sigma</code> absolute uncertainties.
</p>
<p><code>2</code>: 2<code class="reqn">\sigma</code> absolute uncertainties.
</p>
<p><code>3</code>: absolute (1-<code class="reqn">\alpha</code>)% confidence intervals, where
<code class="reqn">\alpha</code> equales the value that is stored in
<code>settings('alpha')</code>.
</p>
<p><code>4</code>: 1<code class="reqn">\sigma</code> relative uncertainties (<code class="reqn">\%</code>).
</p>
<p><code>5</code>: 2<code class="reqn">\sigma</code> relative uncertainties (<code class="reqn">\%</code>).
</p>
<p><code>6</code>: relative (1-<code class="reqn">\alpha</code>)% confidence intervals, where
<code class="reqn">\alpha</code> equales the value that is stored in
<code>settings('alpha')</code>.</p>
</td></tr>
<tr><td><code id="evolution_+3A_transform">transform</code></td>
<td>
<p>if <code>TRUE</code>, plots <code class="reqn">^{234}</code>U/<code class="reqn">^{238}</code>U
vs. Th-U age.</p>
</td></tr>
<tr><td><code id="evolution_+3A_th0i">Th0i</code></td>
<td>
<p>initial <code class="reqn">^{230}</code>Th correction.
</p>
<p><code>0</code>: no correction
</p>
<p><code>1</code>: if <code>x$format</code> is <code>1</code> or <code>2</code>, project the
data along an isochron fit. If <code>x$format</code> is <code>3</code> or
<code>4</code>, infer the initial <code class="reqn">^{230}</code>Th/<code class="reqn">^{238}</code>U activity
ratio from the isochron.
</p>
<p><code>2</code>: if <code>x$format</code> is <code>1</code> or <code>2</code>, correct the
data using the measured present day <code class="reqn">^{230}</code>Th/<code class="reqn">^{238}</code>U,
<code class="reqn">^{232}</code>Th/<code class="reqn">^{238}</code>U and <code class="reqn">^{234}</code>U/<code class="reqn">^{238}</code>U
activity ratios in the detritus. If <code>x$format</code> is <code>3</code> or
<code>4</code>, anchor the isochrons to the equiline, based on the
measured <code class="reqn">^{238}</code>U/<code class="reqn">^{232}</code>Th activity ratio of the whole
rock, as stored in <code>x</code> by the <code>read.data()</code> function.
</p>
<p><code>3</code>: correct the data using an assumed initial
<code class="reqn">^{230}</code>Th/<code class="reqn">^{232}</code>Th-ratio for the detritus (only relevant
if <code>x$format</code> is <code>1</code> or <code>2</code>).</p>
</td></tr>
<tr><td><code id="evolution_+3A_show.numbers">show.numbers</code></td>
<td>
<p>label the error ellipses with the grain
numbers?</p>
</td></tr>
<tr><td><code id="evolution_+3A_levels">levels</code></td>
<td>
<p>a vector with additional values to be displayed as
different background colours within the error ellipses.</p>
</td></tr>
<tr><td><code id="evolution_+3A_clabel">clabel</code></td>
<td>
<p>label of the colour legend.</p>
</td></tr>
<tr><td><code id="evolution_+3A_ellipse.fill">ellipse.fill</code></td>
<td>
<p>fill colour for the error ellipses. This can
either be a single colour or multiple colours to form a colour
ramp. Examples:
</p>
<p>a single colour: <code>rgb(0,1,0,0.5)</code>, <code>'#FF000080'</code>,
<code>'white'</code>, etc.;
</p>
<p>multiple colours: <code>c(rbg(1,0,0,0.5)</code>,
<code>rgb(0,1,0,0.5))</code>, <code>c('#FF000080','#00FF0080')</code>,
<code>c('blue','red')</code>, <code>c('blue','yellow','red')</code>, etc.;
</p>
<p>a colour palette: <code>rainbow(n=100)</code>,
<code>topo.colors(n=100,alpha=0.5)</code>, etc.; or
</p>
<p>a reversed palette: <code>rev(topo.colors(n=100,alpha=0.5))</code>,
etc.
</p>
<p>For empty ellipses, set <code>ellipse.fill=NA</code></p>
</td></tr>
<tr><td><code id="evolution_+3A_ellipse.stroke">ellipse.stroke</code></td>
<td>
<p>the stroke colour for the error
ellipses. Follows the same formatting guidelines as
<code>ellipse.fill</code></p>
</td></tr>
<tr><td><code id="evolution_+3A_line.col">line.col</code></td>
<td>
<p>colour of the age grid</p>
</td></tr>
<tr><td><code id="evolution_+3A_isochron">isochron</code></td>
<td>
<p>fit an isochron to the data?</p>
</td></tr>
<tr><td><code id="evolution_+3A_model">model</code></td>
<td>
<p>if <code>isochron=TRUE</code>, choose one of three
regression models:
</p>
<p><code>1</code>: maximum likelihood regression, using either the modified
error weighted least squares algorithm of York et al. (2004) for
2-dimensional data, or the Maximum Likelihood formulation of Ludwig
and Titterington (1994) for 3-dimensional data. These algorithms
take into account the analytical uncertainties and error
correlations, under the assumption that the scatter between the
data points is solely caused by the analytical uncertainty. If this
assumption is correct, then the MSWD value should be approximately
equal to one. There are three strategies to deal with the case
where MSWD&gt;1. The first of these is to assume that the analytical
uncertainties have been underestipmated by a factor
<code class="reqn">\sqrt{MSWD}</code>.
</p>
<p><code>2</code>: total least squares regression: a second way to deal
with over- or underdispersed datasets is to simply ignore the
analytical uncertainties.
</p>
<p><code>3</code>: maximum likelihood regression with overdispersion:
instead of attributing any overdispersion (MSWD &gt; 1) to
underestimated analytical uncertainties (model 1), one can also
attribute it to the presence of geological uncertainty, which
manifests itself as an added (co)variance term.</p>
</td></tr>
<tr><td><code id="evolution_+3A_exterr">exterr</code></td>
<td>
<p>propagate the decay constant uncertainty in the
isochron age?</p>
</td></tr>
<tr><td><code id="evolution_+3A_sigdig">sigdig</code></td>
<td>
<p>number of significant digits for the isochron age</p>
</td></tr>
<tr><td><code id="evolution_+3A_hide">hide</code></td>
<td>
<p>vector with indices of aliquots that should be removed
from the plot.</p>
</td></tr>
<tr><td><code id="evolution_+3A_omit">omit</code></td>
<td>
<p>vector with indices of aliquots that should be plotted
but omitted from the isochron age calculation.</p>
</td></tr>
<tr><td><code id="evolution_+3A_omit.fill">omit.fill</code></td>
<td>
<p>fill colour that should be used for the omitted
aliquots.</p>
</td></tr>
<tr><td><code id="evolution_+3A_omit.stroke">omit.stroke</code></td>
<td>
<p>stroke colour that should be used for the omitted
aliquots.</p>
</td></tr>
<tr><td><code id="evolution_+3A_...">...</code></td>
<td>
<p>optional arguments to the generic <code>plot</code> function</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Similar to the <code><a href="#topic+concordia">concordia</a></code> diagram (for U-Pb data) and
the <code><a href="#topic+helioplot">helioplot</a></code> diagram (for U-Th-He data), the
evolution diagram simultaneously displays the isotopic composition
and age of U-series data. For carbonate data (Th-U formats 1 and
2), the Th-U evolution diagram consists of a scatter plot that sets
out the <code class="reqn">^{234}</code>U/<code class="reqn">^{238}</code>U-activity ratios against the
<code class="reqn">^{230}</code>Th/<code class="reqn">^{238}</code>U-activity ratios as error ellipses, and
displays the initial <code class="reqn">^{234}</code>U/<code class="reqn">^{238}</code>U-activity ratios
and ages as a set of intersecting lines.  Alternatively, the
<code class="reqn">^{234}</code>U/<code class="reqn">^{238}</code>U-ratios can also be set out against the
<code class="reqn">^{230}</code>Th-<code class="reqn">^{234}</code>U-<code class="reqn">^{238}</code>U-ages.  In both types of
evolution diagrams, <code>IsoplotR</code> provides the option to project
the raw measurements along the best fitting isochron line and
thereby remove the detrital <code class="reqn">^{230}</code>Th-component. This
procedure allows a visual assessment of the degree of homogeneity
within a dataset, as is quantified by the MSWD.
</p>
<p>Neither the U-series evolution diagram, nor the
<code class="reqn">^{234}</code>U/<code class="reqn">^{238}</code>U vs. age plot is applicable to igneous
datasets (Th-U formats 3 and 4), in which <code class="reqn">^{234}</code>U and
<code class="reqn">^{238}</code>U are in secular equilibrium.  For such datasets,
<code>IsoplotR</code> produces an Osmond-style regression plot that is
decorated with a fanning set of <code><a href="#topic+isochron">isochron</a></code> lines.
</p>


<h3>References</h3>

<p>Ludwig, K.R. and Titterington, D.M., 1994. Calculation
of <code class="reqn">^{230}</code>Th/U isochrons, ages, and errors. Geochimica et
Cosmochimica Acta, 58(22), pp.5031-5042.
</p>
<p>Ludwig, K.R., 2003. Mathematical-statistical treatment of data and
errors for <code class="reqn">^{230}</code>Th/U geochronology. Reviews in Mineralogy and
Geochemistry, 52(1), pp.631-656.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+isochron">isochron</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>attach(examples)
evolution(ThU)

dev.new()
evolution(ThU,transform=TRUE,isochron=TRUE,model=1)

</code></pre>

<hr>
<h2 id='examples'>Example datasets for testing <code>IsoplotR</code></h2><span id='topic+examples'></span>

<h3>Description</h3>

<p>Built-in datasets for U-Pb, Pb-Pb, Ar-Ar, K-Ca, Re-Os,
Sm-Nd, Rb-Sr, Lu-Hf, U-Th-He, Th-U, fission track and detrital
geochronology.
</p>
<p><code>examples</code> is an 18-item list containing:
</p>
<p><code>UPb</code>: an object of class <code>UPb</code> containing a high
precision U-Pb dataset of Kamo et al. (1996) packaged with Ken
Ludwig (2003)'s <code>Isoplot</code> program.
</p>
<p><code>PbPb</code>: an object of class <code>PbPb</code> containing a Pb-Pb
dataset from Connelly et al. (2017).
</p>
<p><code>ThPb</code>: an object of class <code>ThPb</code> containing the Th-Pb
data for allanite sample MF482 of Janots and Rubatto (2014).
</p>
<p><code>DZ</code>: an object of class <code>detrital</code> containing a detrital
zircon U-Pb dataset from Namibia (Vermeesch et al., 2015).
</p>
<p><code>ArAr</code>: an object of class <code>ArAr</code> containing a
<code class="reqn">^{40}</code>Ar/<code class="reqn">^{39}</code>Ar spectrum of Skye basalt produced by Sarah
Sherlock (Open University).
</p>
<p><code>KCa</code>: an object of class <code>KCa</code> containing a
<code class="reqn">^{40}</code>K/<code class="reqn">^{40}</code>Ca dataset for sample 140025 grain h spot 5
of Harrison et al. (2010).
</p>
<p><code>UThHe</code>: an object of class <code>UThHe</code> containing a
U-Th-Sm-He dataset of Fish Lake apatite produced by Daniel Stockli
(UT Austin).
</p>
<p><code>FT1</code>: an object of class <code>fissiontracks</code> containing a
synthetic external detector dataset.
</p>
<p><code>FT2</code>: an object of class <code>fissiontracks</code> containing a
synthetic LA-ICP-MS-based fission track dataset using the zeta
calibration method.
</p>
<p><code>FT3</code>: an object of class <code>fissiontracks</code> containing a
synthetic LA-ICP-MS-based fission track dataset using the absolute
dating approach.
</p>
<p><code>ReOs</code>: an object of class <code>ReOs</code> containing a
<code class="reqn">^{187}</code>Os/<code class="reqn">^{187}</code>Re-dataset from Selby (2007).
</p>
<p><code>SmNd</code>: an object of class <code>SmNd</code> containing a
<code class="reqn">^{143}</code>Nd/<code class="reqn">^{147}</code>Sm-dataset from Lugmair et al. (1975).
</p>
<p><code>RbSr</code>: an object of class <code>RbSr</code> containing an
<code class="reqn">^{87}</code>Rb/<code class="reqn">^{86}</code>Sr-dataset from Compston et al. (1971).
</p>
<p><code>LuHf</code>: an object of class <code>LuHf</code> containing an
<code class="reqn">^{176}</code>Lu/<code class="reqn">^{177}</code>Hf-dataset from Barfod et al. (2002).
</p>
<p><code>ThU</code>: an object of class <code>ThU</code> containing a synthetic
&lsquo;Osmond-type&rsquo; dataset from Titterington and Ludwig (1994).
</p>
<p><code>MountTom</code>: an object of class <code>other</code> containing a
collection of zircon fission track ages and errors from Brandon
(1992).
</p>
<p><code>LudwigMean</code>: an object of class <code>other</code> containing a
collection of <code class="reqn">^{206}</code>Pb/<code class="reqn">^{238}</code>U-ages and errors of the
example dataset by Ludwig (2003).
</p>
<p><code>LudwigKDE</code>: an object of class <code>'other'</code> containing the
<code class="reqn">^{206}</code>Pb/<code class="reqn">^{238}</code>U-ages (but not the errors) of the
example dataset by Ludwig (2003).
</p>
<p><code>LudwigSpectrum</code>: an object of class <code>'other'</code> containing
the <code class="reqn">^{39}</code>Ar abundances, <code class="reqn">^{40}</code>Ar/<code class="reqn">^{39}</code>Ar-ages and
errors of the example dataset by Ludwig (2003).
</p>
<p><code>LudwigMixture</code>: an object of class <code>'other'</code> containing
a dataset of dispersed zircon fission track ages of the example
dataset by Ludwig (2003).
</p>


<h3>References</h3>

<p>Brandon, M.T., 1992. Decomposition of fission-track grain-age
distributions. American Journal of Science, 292(8), pp.535-564.
</p>
<p>Barfod, G.H., Albarede, F., Knoll, A.H., Xiao, S., Telouk, P.,
Frei, R. and Baker, J., 2002. New Lu-Hf and Pb-Pb age constraints on
the earliest animal fossils. Earth and Planetary Science Letters, 201(1),
pp.203-212.
</p>
<p>Compston, W., Berry, H., Vernon, M.J., Chappell, B.W. and Kaye,
M.J., 1971. Rubidium-strontium chronology and chemistry of lunar
material from the Ocean of Storms. In Lunar and Planetary Science
Conference Proceedings (Vol. 2, p. 1471).
</p>
<p>Connelly, J.N., Bollard, J. and Bizzarro, M., 2017. Pb-Pb
chronometry and the early Solar System. Geochimica et Cosmochimica
Acta, 201, pp.345-363.
</p>
<p>Galbraith, R. F. and Green, P. F., 1990: Estimating the component
ages in a finite mixture, Nuclear Tracks and Radiation
Measurements, 17, 197-206.
</p>
<p>Harrison, T.M., Heizler, M.T., McKeegan, K.D. and Schmitt, A.K.,
2010. In situ <code class="reqn">^{40}</code>K-<code class="reqn">^{40}</code>Ca &lsquo;double-plus&rsquo; SIMS dating
resolves Klokken feldspar <code class="reqn">^{40}</code>K-<code class="reqn">^{40}</code>Ar paradox. Earth
and Planetary Science Letters, 299(3-4), pp.426-433.
</p>
<p>Janots, E. and Rubatto, D., 2014. U-Th-Pb dating of collision in the
external Alpine domains (Urseren zone, Switzerland) using low
temperature allanite and monazite. Lithos, 184, pp. 155-166.
</p>
<p>Kamo, S.L., Czamanske, G.K. and Krogh, T.E., 1996. A minimum U-Pb
age for Siberian flood-basalt volcanism. Geochimica et Cosmochimica
Acta, 60(18), 3505-3511.
</p>
<p>Ludwig, K. R., and D. M. Titterington., 1994.
&quot;Calculation of <code class="reqn">^{230}</code>Th/U isochrons, ages, and errors.&quot;
Geochimica et Cosmochimica Acta 58.22, 5031-5042.
</p>
<p>Ludwig, K. R., 2003. User's manual for Isoplot 3.00: a
geochronological toolkit for Microsoft Excel. No. 4.
</p>
<p>Lugmair, G.W., Scheinin, N.B. and Marti, K., 1975. Sm-Nd age and
history of Apollo 17 basalt 75075-Evidence for early
differentiation of the lunar exterior. In Lunar and Planetary
Science Conference Proceedings (Vol. 6, pp. 1419-1429).
</p>
<p>Selby, D., 2007. Direct Rhenium-Osmium age of the
Oxfordian-Kimmeridgian boundary, Staffin bay, Isle of Skye, UK, and
the Late Jurassic time scale.  Norsk Geologisk Tidsskrift, 87(3),
p.291.
</p>
<p>Vermeesch, P. and Garzanti, E., 2015. Making geological sense of
&lsquo;Big Data&rsquo; in sedimentary provenance analysis. Chemical Geology, 409,
pp.20-27.
</p>
<p>Vermeesch, P., 2008. Three new ways to calculate average (U-Th)/He ages.
Chemical Geology, 249(3),pp.339-347.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>attach(examples)

concordia(UPb)

agespectrum(ArAr)

isochron(ReOs)

radialplot(FT1)

helioplot(UThHe)

evolution(ThU)

kde(DZ)

radialplot(LudwigMixture)

agespectrum(LudwigSpectrum)

weightedmean(LudwigMean)

</code></pre>

<hr>
<h2 id='helioplot'>Visualise U-Th-He data on a logratio plot or ternary diagram</h2><span id='topic+helioplot'></span>

<h3>Description</h3>

<p>Plot U-Th(-Sm)-He data on a (log[He/Th] vs. log[U/He]) logratio
plot or U-Th-He ternary diagram
</p>


<h3>Usage</h3>

<pre><code class='language-R'>helioplot(
  x,
  logratio = TRUE,
  model = 1,
  show.barycentre = TRUE,
  show.numbers = FALSE,
  oerr = 3,
  contour.col = c("white", "red"),
  levels = NA,
  clabel = "",
  ellipse.fill = c("#00FF0080", "#0000FF80"),
  ellipse.stroke = "black",
  sigdig = 2,
  xlim = NA,
  ylim = NA,
  fact = NA,
  hide = NULL,
  omit = NULL,
  omit.fill = NA,
  omit.stroke = "grey",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="helioplot_+3A_x">x</code></td>
<td>
<p>an object of class <code>UThHe</code></p>
</td></tr>
<tr><td><code id="helioplot_+3A_logratio">logratio</code></td>
<td>
<p>Boolean flag indicating whether the data should be
shown on bivariate log[He/Th] vs. log[U/He] diagram, or a
U-Th-He ternary diagram.</p>
</td></tr>
<tr><td><code id="helioplot_+3A_model">model</code></td>
<td>
<p>choose one of the following statistical models:
</p>
<p><code>1</code>: weighted mean. This model assumes that the scatter between
the data points is solely caused by the analytical uncertainty. If
the assumption is correct, then the MSWD value should be
approximately equal to one. There are three strategies to deal with
the case where MSWD&gt;1. The first of these is to assume that the
analytical uncertainties have been underestimated by a factor
<code class="reqn">\sqrt{MSWD}</code>.
</p>
<p><code>2</code>: unweighted mean. A second way to deal with over- or
underdispersed datasets is to simply ignore the analytical
uncertainties.
</p>
<p><code>3</code>: weighted mean with overdispersion: instead of attributing
any overdispersion (MSWD &gt; 1) to underestimated analytical
uncertainties (model 1), it can also be attributed to the presence
of geological uncertainty, which manifests itself as an added
(co)variance term.</p>
</td></tr>
<tr><td><code id="helioplot_+3A_show.barycentre">show.barycentre</code></td>
<td>
<p>show the mean composition as a white
ellipse?</p>
</td></tr>
<tr><td><code id="helioplot_+3A_show.numbers">show.numbers</code></td>
<td>
<p>show the grain numbers inside the error
ellipses?</p>
</td></tr>
<tr><td><code id="helioplot_+3A_oerr">oerr</code></td>
<td>
<p>indicates whether the analytical uncertainties of the
output are reported in the plot title as:
</p>
<p><code>1</code>: 1<code class="reqn">\sigma</code> absolute uncertainties.
</p>
<p><code>2</code>: 2<code class="reqn">\sigma</code> absolute uncertainties.
</p>
<p><code>3</code>: absolute (1-<code class="reqn">\alpha</code>)% confidence intervals, where
<code class="reqn">\alpha</code> equales the value that is stored in
<code>settings('alpha')</code>.
</p>
<p><code>4</code>: 1<code class="reqn">\sigma</code> relative uncertainties (<code class="reqn">\%</code>).
</p>
<p><code>5</code>: 2<code class="reqn">\sigma</code> relative uncertainties (<code class="reqn">\%</code>).
</p>
<p><code>6</code>: relative (1-<code class="reqn">\alpha</code>)% confidence intervals, where
<code class="reqn">\alpha</code> equales the value that is stored in
<code>settings('alpha')</code>.</p>
</td></tr>
<tr><td><code id="helioplot_+3A_contour.col">contour.col</code></td>
<td>
<p>two-element vector with the fill colours to be
assigned to the minimum and maximum age contour</p>
</td></tr>
<tr><td><code id="helioplot_+3A_levels">levels</code></td>
<td>
<p>a vector with additional values to be displayed as
different background colours within the error ellipses.</p>
</td></tr>
<tr><td><code id="helioplot_+3A_clabel">clabel</code></td>
<td>
<p>label of the colour scale</p>
</td></tr>
<tr><td><code id="helioplot_+3A_ellipse.fill">ellipse.fill</code></td>
<td>
<p>Fill colour for the error ellipses. This can either be a single
colour or multiple colours to form a colour ramp. Examples:
</p>
<p>a single colour: <code>rgb(0,1,0,0.5)</code>, <code>'#FF000080'</code>,
<code>'white'</code>, etc.;
</p>
<p>multiple colours: <code>c(rbg(1,0,0,0.5)</code>,
<code>rgb(0,1,0,0.5))</code>, <code>c('#FF000080','#00FF0080')</code>,
<code>c('blue','red')</code>, <code>c('blue','yellow','red')</code>, etc.;
</p>
<p>a colour palette: <code>rainbow(n=100)</code>,
<code>topo.colors(n=100,alpha=0.5)</code>, etc.; or
</p>
<p>a reversed palette: <code>rev(topo.colors(n=100,alpha=0.5))</code>, etc.
</p>
<p>For empty ellipses, set <code>ellipse.fill=NA</code></p>
</td></tr>
<tr><td><code id="helioplot_+3A_ellipse.stroke">ellipse.stroke</code></td>
<td>
<p>the stroke colour for the error
ellipses. Follows the same formatting guidelines as
<code>ellipse.fill</code></p>
</td></tr>
<tr><td><code id="helioplot_+3A_sigdig">sigdig</code></td>
<td>
<p>number of significant digits for the barycentric age</p>
</td></tr>
<tr><td><code id="helioplot_+3A_xlim">xlim</code></td>
<td>
<p>optional limits of the x-axis (log[U/He]) of the
logratio plot. If <code>xlim=NA</code>, the axis limits are
determined automatically.</p>
</td></tr>
<tr><td><code id="helioplot_+3A_ylim">ylim</code></td>
<td>
<p>optional limits of the y-axis (log[Th/He]) of the
logratio plot. If <code>ylim=NA</code>, the axis limits are
determined automatically.</p>
</td></tr>
<tr><td><code id="helioplot_+3A_fact">fact</code></td>
<td>
<p>three-element vector with scaling factors of the
ternary diagram if <code>fact=NA</code>, these will be determined
automatically</p>
</td></tr>
<tr><td><code id="helioplot_+3A_hide">hide</code></td>
<td>
<p>vector with indices of aliquots that should be removed
from the plot.</p>
</td></tr>
<tr><td><code id="helioplot_+3A_omit">omit</code></td>
<td>
<p>vector with indices of aliquots that should be plotted
but omitted from the barycentric age calculation.</p>
</td></tr>
<tr><td><code id="helioplot_+3A_omit.fill">omit.fill</code></td>
<td>
<p>fill colour that should be used for the omitted
aliquots.</p>
</td></tr>
<tr><td><code id="helioplot_+3A_omit.stroke">omit.stroke</code></td>
<td>
<p>stroke colour that should be used for the
omitted aliquots.</p>
</td></tr>
<tr><td><code id="helioplot_+3A_...">...</code></td>
<td>
<p>optional arguments to the generic <code>plot</code> function</p>
</td></tr>
</table>


<h3>Details</h3>

<p>U, Th, Sm and He are <em>compositional</em> data.  This means that it
is not so much the absolute concentrations of these elements that
bear the chronological information, but rather their relative
proportions. The space of all possible U-Th-He compositions fits
within the constraints of a ternary diagram or &lsquo;helioplot&rsquo;
(Vermeesch, 2008, 2010). If Sm is included as well, then this
expands to a three-dimensional tetrahaedral space (Vermeesch,
2008).  Data that fit within these constrained spaces must be
subjected to a logratio transformation prior to statistical
analysis (Aitchison, 1986).  In the case of the U-Th-He-(Sm)-He
system, this is achieved by first defining two (or three) new
variables:
</p>
<p><code class="reqn">u \equiv \ln[U/He]</code>
<code class="reqn">v \equiv \ln[Th/He]</code>
<code class="reqn">(, w \equiv \ln[Sm/He] )</code>
</p>
<p>and then performing the desired statistical analysis (averaging,
uncertainty propagation, ...) on the transformed data. Upon
completion of the mathematical operations, the results can then be
mapped back to U-Th-(Sm)-He space using an inverse logratio
transformation:
</p>
<p><code class="reqn">[He] = 1/[e^{u}+e^{v}+(e^{w})+1]</code>,
<code class="reqn">[U] = e^{u}/[e^{u}+e^{v}+(e^{w})+1]</code><br />
<code class="reqn">[Th] = e^{v}/[e^{u}+e^{v}+(e^{w})+1]</code>,
<code class="reqn">([Sm] = e^{w}/[e^{u}+e^{v}+(e^{w})+1])</code>
</p>
<p>where <code class="reqn">[He] + [U] + [Th] (+ [Sm]) = 1</code>. In the context of
U-Th-(Sm)-He dating, the <em>barycentric</em> age (which is
equivalent to the 'central age' of Vermeesch, 2008) is defined as
the date that corresponds to the compositional mean, which is
equivalent to the arithmetic mean composition in logratio space.
<code>IsoplotR</code>'s <code>helioplot</code> function performs this
calculation using the same algorithm that is used to obtain the
weighted mean U-Pb composition for the <code><a href="#topic+concordia">concordia</a></code> age
calculation. Overdispersion is treated similarly as in a regression
context (see <code><a href="#topic+isochron">isochron</a></code>).  Thus, there are options to
augment the uncertainties with a factor <code class="reqn">\sqrt{MSWD}</code> (model
1); to ignore the analytical uncertainties altogether (model 2); or
to add a constant overdispersion term to the analytical
uncertainties (model 3).  The <code>helioplot</code> function visualises
U-Th-(Sm)-He data on either a ternary diagram or a bivariate
<code class="reqn">\ln[Th/U]</code> vs. <code class="reqn">\ln[U/He]</code> contour plot. These diagrams
provide a convenient way to simultaneously display the isotopic
composition of samples as well as their chronological meaning. In
this respect, they fulfil the same purpose as the U-Pb
<code><a href="#topic+concordia">concordia</a></code> diagram and the U-series
<code><a href="#topic+evolution">evolution</a></code> plot.
</p>


<h3>References</h3>

<p>Aitchison, J., 1986, The statistical analysis of
compositional data: London, Chapman and Hall, 416 p.
</p>
<p>Vermeesch, P., 2008. Three new ways to calculate average (U-Th)/He
ages. Chemical Geology, 249(3), pp.339-347.
</p>
<p>Vermeesch, P., 2010. HelioPlot, and the treatment of overdispersed
(U-Th-Sm)/He data. Chemical Geology, 271(3), pp.108-111.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+radialplot">radialplot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>attach(examples)
helioplot(UThHe)
dev.new()
helioplot(UThHe,logratio=FALSE)
</code></pre>

<hr>
<h2 id='isochron'>Calculate and plot isochrons</h2><span id='topic+isochron'></span><span id='topic+isochron.default'></span><span id='topic+isochron.other'></span><span id='topic+isochron.UPb'></span><span id='topic+isochron.PbPb'></span><span id='topic+isochron.ArAr'></span><span id='topic+isochron.ThPb'></span><span id='topic+isochron.KCa'></span><span id='topic+isochron.RbSr'></span><span id='topic+isochron.ReOs'></span><span id='topic+isochron.SmNd'></span><span id='topic+isochron.LuHf'></span><span id='topic+isochron.UThHe'></span><span id='topic+isochron.ThU'></span>

<h3>Description</h3>

<p>Plots cogenetic U-Pb, Ar-Ar, K-Ca, Pb-Pb, Th-Pb, Rb-Sr, Sm-Nd,
Re-Os, Lu-Hf, U-Th-He or Th-U data as X-Y scatterplots, fits an
isochron curve through them using the <code>york</code>,
<code>titterington</code> or <code>ludwig</code> function, and computes the
corresponding isochron age, including decay constant uncertainties.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>isochron(x, ...)

## Default S3 method:
isochron(
  x,
  oerr = 3,
  sigdig = 2,
  show.numbers = FALSE,
  levels = NA,
  clabel = "",
  xlab = "x",
  ylab = "y",
  ellipse.fill = c("#00FF0080", "#FF000080"),
  ellipse.stroke = "black",
  ci.col = "gray80",
  line.col = "black",
  lwd = 1,
  plot = TRUE,
  title = TRUE,
  model = 1,
  wtype = 1,
  anchor = 0,
  show.ellipses = 1 * (model != 2),
  hide = NULL,
  omit = NULL,
  omit.fill = NA,
  omit.stroke = "grey",
  ...
)

## S3 method for class 'other'
isochron(
  x,
  oerr = 3,
  sigdig = 2,
  show.numbers = FALSE,
  levels = NA,
  clabel = "",
  xlab = "x",
  ylab = "y",
  ellipse.fill = c("#00FF0080", "#FF000080"),
  ellipse.stroke = "black",
  ci.col = "gray80",
  line.col = "black",
  lwd = 1,
  plot = TRUE,
  title = TRUE,
  model = 1,
  wtype = 1,
  anchor = 0,
  flippable = 0,
  show.ellipses = 1 * (model != 2),
  hide = NULL,
  omit = NULL,
  omit.fill = NA,
  omit.stroke = "grey",
  ...
)

## S3 method for class 'UPb'
isochron(
  x,
  oerr = 3,
  sigdig = 2,
  show.numbers = FALSE,
  levels = NA,
  clabel = "",
  joint = TRUE,
  ellipse.fill = c("#00FF0080", "#FF000080"),
  ellipse.stroke = "black",
  type = 1,
  ci.col = "gray80",
  line.col = "black",
  lwd = 1,
  plot = TRUE,
  exterr = FALSE,
  model = 1,
  show.ellipses = 1 * (model != 2),
  anchor = 0,
  hide = NULL,
  omit = NULL,
  omit.fill = NA,
  omit.stroke = "grey",
  y0option = 1,
  ...
)

## S3 method for class 'PbPb'
isochron(
  x,
  oerr = 3,
  sigdig = 2,
  show.numbers = FALSE,
  levels = NA,
  clabel = "",
  ellipse.fill = c("#00FF0080", "#FF000080"),
  ellipse.stroke = "black",
  inverse = TRUE,
  ci.col = "gray80",
  line.col = "black",
  lwd = 1,
  plot = TRUE,
  exterr = FALSE,
  model = 1,
  wtype = 1,
  anchor = 0,
  growth = FALSE,
  show.ellipses = 1 * (model != 2),
  hide = NULL,
  omit = NULL,
  omit.fill = NA,
  omit.stroke = "grey",
  ...
)

## S3 method for class 'ArAr'
isochron(
  x,
  oerr = 3,
  sigdig = 2,
  show.numbers = FALSE,
  levels = NA,
  clabel = "",
  ellipse.fill = c("#00FF0080", "#FF000080"),
  ellipse.stroke = "black",
  inverse = TRUE,
  ci.col = "gray80",
  line.col = "black",
  lwd = 1,
  plot = TRUE,
  exterr = FALSE,
  model = 1,
  wtype = 1,
  anchor = 0,
  show.ellipses = 1 * (model != 2),
  hide = NULL,
  omit = NULL,
  omit.fill = NA,
  omit.stroke = "grey",
  ...
)

## S3 method for class 'ThPb'
isochron(
  x,
  oerr = 3,
  sigdig = 2,
  show.numbers = FALSE,
  levels = NA,
  clabel = "",
  ellipse.fill = c("#00FF0080", "#FF000080"),
  ellipse.stroke = "black",
  inverse = FALSE,
  ci.col = "gray80",
  line.col = "black",
  lwd = 1,
  plot = TRUE,
  exterr = FALSE,
  model = 1,
  wtype = 1,
  anchor = 0,
  show.ellipses = 1 * (model != 2),
  hide = NULL,
  omit = NULL,
  omit.fill = NA,
  omit.stroke = "grey",
  ...
)

## S3 method for class 'KCa'
isochron(
  x,
  oerr = 3,
  sigdig = 2,
  show.numbers = FALSE,
  levels = NA,
  clabel = "",
  inverse = FALSE,
  ci.col = "gray80",
  ellipse.fill = c("#00FF0080", "#FF000080"),
  ellipse.stroke = "black",
  line.col = "black",
  lwd = 1,
  plot = TRUE,
  exterr = FALSE,
  model = 1,
  wtype = 1,
  anchor = 0,
  show.ellipses = 1 * (model != 2),
  hide = NULL,
  omit = NULL,
  omit.fill = NA,
  omit.stroke = "grey",
  ...
)

## S3 method for class 'RbSr'
isochron(
  x,
  oerr = 3,
  sigdig = 2,
  show.numbers = FALSE,
  levels = NA,
  clabel = "",
  ellipse.fill = c("#00FF0080", "#FF000080"),
  ellipse.stroke = "black",
  inverse = FALSE,
  ci.col = "gray80",
  line.col = "black",
  lwd = 1,
  plot = TRUE,
  exterr = FALSE,
  model = 1,
  wtype = 1,
  anchor = 0,
  show.ellipses = 1 * (model != 2),
  hide = NULL,
  omit = NULL,
  omit.fill = NA,
  omit.stroke = "grey",
  ...
)

## S3 method for class 'ReOs'
isochron(
  x,
  oerr = 3,
  sigdig = 2,
  show.numbers = FALSE,
  levels = NA,
  clabel = "",
  ellipse.fill = c("#00FF0080", "#FF000080"),
  ellipse.stroke = "black",
  inverse = FALSE,
  ci.col = "gray80",
  line.col = "black",
  lwd = 1,
  plot = TRUE,
  exterr = FALSE,
  model = 1,
  wtype = 1,
  anchor = 0,
  show.ellipses = 1 * (model != 2),
  hide = NULL,
  omit = NULL,
  omit.fill = NA,
  omit.stroke = "grey",
  ...
)

## S3 method for class 'SmNd'
isochron(
  x,
  oerr = 3,
  sigdig = 2,
  show.numbers = FALSE,
  levels = NA,
  clabel = "",
  ellipse.fill = c("#00FF0080", "#FF000080"),
  ellipse.stroke = "black",
  inverse = FALSE,
  ci.col = "gray80",
  line.col = "black",
  lwd = 1,
  plot = TRUE,
  exterr = FALSE,
  model = 1,
  wtype = 1,
  anchor = 0,
  show.ellipses = 1 * (model != 2),
  hide = NULL,
  omit = NULL,
  omit.fill = NA,
  omit.stroke = "grey",
  ...
)

## S3 method for class 'LuHf'
isochron(
  x,
  oerr = 3,
  sigdig = 2,
  show.numbers = FALSE,
  levels = NA,
  clabel = "",
  ellipse.fill = c("#00FF0080", "#FF000080"),
  ellipse.stroke = "black",
  inverse = FALSE,
  ci.col = "gray80",
  line.col = "black",
  lwd = 1,
  plot = TRUE,
  exterr = FALSE,
  model = 1,
  wtype = 1,
  anchor = 0,
  show.ellipses = 1 * (model != 2),
  hide = NULL,
  omit = NULL,
  omit.fill = NA,
  omit.stroke = "grey",
  ...
)

## S3 method for class 'UThHe'
isochron(
  x,
  sigdig = 2,
  oerr = 3,
  show.numbers = FALSE,
  levels = NA,
  clabel = "",
  ellipse.fill = c("#00FF0080", "#FF000080"),
  ellipse.stroke = "black",
  ci.col = "gray80",
  line.col = "black",
  lwd = 1,
  plot = TRUE,
  model = 1,
  wtype = 1,
  anchor = 0,
  show.ellipses = 2 * (model != 2),
  hide = NULL,
  omit = NULL,
  omit.fill = NA,
  omit.stroke = "grey",
  ...
)

## S3 method for class 'ThU'
isochron(
  x,
  type = 2,
  oerr = 3,
  sigdig = 2,
  show.numbers = FALSE,
  levels = NA,
  clabel = "",
  ellipse.fill = c("#00FF0080", "#FF000080"),
  ellipse.stroke = "black",
  ci.col = "gray80",
  line.col = "black",
  lwd = 1,
  plot = TRUE,
  exterr = FALSE,
  model = 1,
  wtype = "a",
  show.ellipses = 1 * (model != 2),
  hide = NULL,
  omit = NULL,
  omit.fill = NA,
  omit.stroke = "grey",
  y0option = 4,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="isochron_+3A_x">x</code></td>
<td>
<p>EITHER a matrix with the following five columns:
</p>
<p><code>X</code>: the x-variable
</p>
<p><code>sX</code>: the standard error of <code>X</code>
</p>
<p><code>Y</code>: the y-variable
</p>
<p><code>sY</code>: the standard error of <code>Y</code>
</p>
<p><code>rXY</code>: the correlation coefficient of <code>X</code> and <code>Y</code>
</p>
<p>OR
</p>
<p>an object of class <code>ArAr</code>, <code>KCa</code>, <code>PbPb</code>,
<code>UPb</code>, <code>ThPb</code>, <code>ReOs</code>, <code>RbSr</code>, <code>SmNd</code>,
<code>LuHf</code>, <code>UThHe</code> or <code>ThU</code>.</p>
</td></tr>
<tr><td><code id="isochron_+3A_...">...</code></td>
<td>
<p>optional arguments to be passed on to <code><a href="#topic+scatterplot">scatterplot</a></code></p>
</td></tr>
<tr><td><code id="isochron_+3A_oerr">oerr</code></td>
<td>
<p>indicates whether the analytical uncertainties of the
output are reported in the plot title as:
</p>
<p><code>1</code>: 1<code class="reqn">\sigma</code> absolute uncertainties.
</p>
<p><code>2</code>: 2<code class="reqn">\sigma</code> absolute uncertainties.
</p>
<p><code>3</code>: absolute (1-<code class="reqn">\alpha</code>)% confidence intervals, where
<code class="reqn">\alpha</code> equales the value that is stored in
<code>settings('alpha')</code>.
</p>
<p><code>4</code>: 1<code class="reqn">\sigma</code> relative uncertainties (<code class="reqn">\%</code>).
</p>
<p><code>5</code>: 2<code class="reqn">\sigma</code> relative uncertainties (<code class="reqn">\%</code>).
</p>
<p><code>6</code>: relative (1-<code class="reqn">\alpha</code>)% confidence intervals, where
<code class="reqn">\alpha</code> equales the value that is stored in
<code>settings('alpha')</code>.</p>
</td></tr>
<tr><td><code id="isochron_+3A_sigdig">sigdig</code></td>
<td>
<p>the number of significant digits of the numerical
values reported in the title of the graphical output</p>
</td></tr>
<tr><td><code id="isochron_+3A_show.numbers">show.numbers</code></td>
<td>
<p>logical flag (<code>TRUE</code> to show grain numbers)</p>
</td></tr>
<tr><td><code id="isochron_+3A_levels">levels</code></td>
<td>
<p>a vector with additional values to be displayed as
different background colours within the error ellipses.</p>
</td></tr>
<tr><td><code id="isochron_+3A_clabel">clabel</code></td>
<td>
<p>label for the colour scale</p>
</td></tr>
<tr><td><code id="isochron_+3A_xlab">xlab</code></td>
<td>
<p>text label for the horizontal plot axis</p>
</td></tr>
<tr><td><code id="isochron_+3A_ylab">ylab</code></td>
<td>
<p>text label for the vertical plot axis</p>
</td></tr>
<tr><td><code id="isochron_+3A_ellipse.fill">ellipse.fill</code></td>
<td>
<p>Fill colour for the error ellipses. This can either be a single
colour or multiple colours to form a colour ramp. Examples:
</p>
<p>a single colour: <code>rgb(0,1,0,0.5)</code>, <code>'#FF000080'</code>,
<code>'white'</code>, etc.;
</p>
<p>multiple colours: <code>c(rbg(1,0,0,0.5)</code>,
<code>rgb(0,1,0,0.5))</code>, <code>c('#FF000080','#00FF0080')</code>,
<code>c('blue','red')</code>, <code>c('blue','yellow','red')</code>, etc.;
</p>
<p>a colour palette: <code>rainbow(n=100)</code>,
<code>topo.colors(n=100,alpha=0.5)</code>, etc.; or
</p>
<p>a reversed palette: <code>rev(topo.colors(n=100,alpha=0.5))</code>,
etc.
</p>
<p>For empty ellipses, set <code>ellipse.col=NA</code></p>
</td></tr>
<tr><td><code id="isochron_+3A_ellipse.stroke">ellipse.stroke</code></td>
<td>
<p>the stroke colour for the error
ellipses. Follows the same formatting guidelines as
<code>ellipse.fill</code></p>
</td></tr>
<tr><td><code id="isochron_+3A_ci.col">ci.col</code></td>
<td>
<p>the fill colour for the confidence interval of the
intercept and slope.</p>
</td></tr>
<tr><td><code id="isochron_+3A_line.col">line.col</code></td>
<td>
<p>colour of the isochron line</p>
</td></tr>
<tr><td><code id="isochron_+3A_lwd">lwd</code></td>
<td>
<p>line width</p>
</td></tr>
<tr><td><code id="isochron_+3A_plot">plot</code></td>
<td>
<p>if <code>FALSE</code>, suppresses the graphical output</p>
</td></tr>
<tr><td><code id="isochron_+3A_title">title</code></td>
<td>
<p>add a title to the plot?</p>
</td></tr>
<tr><td><code id="isochron_+3A_model">model</code></td>
<td>
<p>construct the isochron using either:
</p>
<p><code>1</code>: Error-weighted least squares regression
</p>
<p><code>2</code>: Total least squares regression
</p>
<p><code>3</code>: Error-weighted least squares with overdispersion term</p>
</td></tr>
<tr><td><code id="isochron_+3A_wtype">wtype</code></td>
<td>
<p>controls the parameter responsible for the
overdispersion in model-3 regression.
</p>
<p>If <code>x</code> has class <code>PbPb</code>, <code>ArAr</code> or <code>PD</code>,
<code>wtype</code> can have one of two values:
</p>

<ul>
<li> <p><code>1</code>: attribute the overdispersion to variability in the
non-radiogenic component, as controlled by <code>settings('iratio',...)</code>
</p>
</li>
<li> <p><code>2</code>: attribute the overdispersion to variability in the
age, i.e. to diachronous closure of the isotope system.
</p>
</li></ul>

<p>otherwise, <code>wtype</code> can have one of four values:
</p>

<ul>
<li> <p><code>1</code>: attributes the overdispersion to the y-intercept of the isochron.
</p>
</li>
<li> <p><code>2</code>: attributes the overdispersion to the slope of the isochron.
</p>
</li>
<li> <p><code>'A'</code>: only available if <code>x</code> has class <code>ThU</code> and
<code>x$format</code> is 1 or 2. Attributes the overdispersion to the
authigenic <code class="reqn">^{230}</code>Th/<code class="reqn">^{238}</code>U-intercept of the isochron.
</p>
</li>
<li> <p><code>'B'</code>: only available if <code>x</code> has class <code>ThU</code> and
<code>x$format</code> is 1 or 2. Attributes the overdispersion to the
<code class="reqn">^{230}</code>Th/<code class="reqn">^{232}</code>Th-slope of the isochron.
</p>
</li></ul>
</td></tr>
<tr><td><code id="isochron_+3A_anchor">anchor</code></td>
<td>
<p>control parameters to fix the intercept age or common
Pb composition of the isochron fit. This can be a scalar or a
vector.
</p>
<p>If <code>anchor[1]=0</code>: do not anchor the isochron.
</p>
<p>If <code>anchor[1]=1</code>: fix the common Pb composition at the values
stored in <code>settings('iratio',...)</code>.
</p>
<p>If <code>anchor[1]=2</code>: force the isochron line to intersect the
concordia line at an age equal to <code>anchor[2]</code>.</p>
</td></tr>
<tr><td><code id="isochron_+3A_show.ellipses">show.ellipses</code></td>
<td>
<p>show the data as:
</p>
<p><code>0</code>: points
</p>
<p><code>1</code>: error ellipses
</p>
<p><code>2</code>: error crosses</p>
</td></tr>
<tr><td><code id="isochron_+3A_hide">hide</code></td>
<td>
<p>vector with indices of aliquots that should be removed
from the plot.</p>
</td></tr>
<tr><td><code id="isochron_+3A_omit">omit</code></td>
<td>
<p>vector with indices of aliquots that should be plotted
but omitted from the isochron age calculation.</p>
</td></tr>
<tr><td><code id="isochron_+3A_omit.fill">omit.fill</code></td>
<td>
<p>fill colour that should be used for the omitted
aliquots.</p>
</td></tr>
<tr><td><code id="isochron_+3A_omit.stroke">omit.stroke</code></td>
<td>
<p>stroke colour that should be used for the
omitted aliquots.</p>
</td></tr>
<tr><td><code id="isochron_+3A_flippable">flippable</code></td>
<td>
<p>controls if generic data (where <code>x</code> has class
<code>other</code> and <code>x$format</code> is either <code>4</code> or
<code>5</code>) should be treated as inverse isochrons
(<code>flippable=1</code>) or as conventional isochrons
(<code>flippable=2</code>). If <code>flippable=0</code> (which is the
default value), then the data are passed on to
<code>isochron.default</code>.</p>
</td></tr>
<tr><td><code id="isochron_+3A_joint">joint</code></td>
<td>
<p>logical. Only applies to U-Pb data formats 4 and
above. If <code>TRUE</code>, carries out three dimensional
regression.  If <code>FALSE</code>, uses two dimensional isochron
regression.  The latter can be used to compute
<code class="reqn">{}^{207}</code>Pb/<code class="reqn">{}^{235}</code>U isochrons, which are immune to
the complexities of initial <code class="reqn">{}^{234}</code>U/<code class="reqn">{}^{238}</code>U
disequilibrium.</p>
</td></tr>
<tr><td><code id="isochron_+3A_type">type</code></td>
<td>
<p>if <code>x</code> has class <code>UPb</code> and <code>x$format=4</code>,
<code>5</code> or <code>6</code>:
</p>
<p><code>1</code>: <code class="reqn">^{204}</code>Pb/<code class="reqn">^{206}</code>Pb vs. <code class="reqn">^{238}</code>U/<code class="reqn">^{206}</code>Pb
</p>
<p><code>2</code>: <code class="reqn">^{204}</code>Pb/<code class="reqn">^{207}</code>Pb vs. <code class="reqn">^{235}</code>U/<code class="reqn">^{207}</code>Pb
</p>
<p>if <code>x</code> has class <code>UPb</code> and <code>x$format=7</code> or <code>8</code>:
</p>
<p><code>1</code>: <code class="reqn">^{208}</code>Pb<code class="reqn">{}_\circ</code>/<code class="reqn">^{206}</code>Pb vs. <code class="reqn">^{238}</code>U/<code class="reqn">^{206}</code>Pb
</p>
<p><code>2</code>: <code class="reqn">^{208}</code>Pb<code class="reqn">{}_\circ</code>/<code class="reqn">^{207}</code>Pb vs. <code class="reqn">^{235}</code>U/<code class="reqn">^{207}</code>Pb
</p>
<p><code>3</code>: <code class="reqn">^{206}</code>Pb<code class="reqn">{}_\circ</code>/<code class="reqn">^{208}</code>Pb
vs. <code class="reqn">^{232}</code>Th/<code class="reqn">^{208}</code>Pb
</p>
<p><code>4</code>: <code class="reqn">^{207}</code>Pb<code class="reqn">{}_\circ</code>/<code class="reqn">^{208}</code>Pb
vs. <code class="reqn">^{232}</code>Th/<code class="reqn">^{208}</code>Pb
</p>
<p>if <code>x</code> has class <code>ThU</code>, and following the classification
of Ludwig and Titterington (1994), one of either:
</p>
<p><code>1</code>: &lsquo;Rosholt type-II&rsquo; isochron, setting out
<code class="reqn">^{230}</code>Th/<code class="reqn">^{232}</code>Th vs. <code class="reqn">^{238}</code>U/<code class="reqn">^{232}</code>Th
</p>
<p><code>2</code>: &lsquo;Osmond type-II&rsquo; isochron, setting out <code class="reqn">^{230}</code>Th/<code class="reqn">^{238}</code>U
vs. <code class="reqn">^{232}</code>Th/<code class="reqn">^{238}</code>U
</p>
<p><code>3</code>: &lsquo;Rosholt type-II&rsquo; isochron, setting out <code class="reqn">^{234}</code>U/<code class="reqn">^{232}</code>Th
vs. <code class="reqn">^{238}</code>U/<code class="reqn">^{232}</code>Th
</p>
<p><code>4</code>: &lsquo;Osmond type-II&rsquo; isochron, setting out
<code class="reqn">^{234}</code>U/<code class="reqn">^{238}</code>U vs. <code class="reqn">^{232}</code>Th/<code class="reqn">^{238}</code>U</p>
</td></tr>
<tr><td><code id="isochron_+3A_exterr">exterr</code></td>
<td>
<p>propagate external sources of uncertainty
(J, decay constant)?</p>
</td></tr>
<tr><td><code id="isochron_+3A_y0option">y0option</code></td>
<td>
<p>controls the type of y-intercept or activity ratio
that is reported along with the isochron age. Only relevant to
U-Pb data and Th-U data formats 1 and 2.
</p>
<p>For U-Pb data:
</p>
<p><code>y0option=1</code> reports the common Pb composition,
</p>
<p><code>y0option=2</code> reports the initial <code class="reqn">^{234}</code>U/<code class="reqn">^{238}</code>U
activity ratio.
</p>
<p><code>y0option=3</code> reports the initial <code class="reqn">^{230}</code>Th/<code class="reqn">^{238}</code>U
activity ratio,
</p>
<p>For Th-U data:
</p>
<p><code>y0option=1</code> reports the authigenic
<code class="reqn">^{234}</code>U/<code class="reqn">^{238}</code>U activity ratio,
</p>
<p><code>y0option=2</code> reports the detrital
<code class="reqn">^{230}</code>Th/<code class="reqn">^{232}</code>Th activity ratio,
</p>
<p><code>y0option=3</code> reports the authigenic
<code class="reqn">^{230}</code>Th/<code class="reqn">^{238}</code>U activity ratio,
</p>
<p><code>y0option=4</code> reports the initial <code class="reqn">^{234}</code>U/<code class="reqn">^{238}</code>U
activity ratio.</p>
</td></tr>
<tr><td><code id="isochron_+3A_inverse">inverse</code></td>
<td>
<p>toggles between normal and inverse isochrons. If the
isochron plots <code>Y</code> against <code>X</code>, and
</p>
<p>If <code>inverse=TRUE</code>, then <code>X</code> =
<code class="reqn">{}^{204}</code>Pb/<code class="reqn">{}^{206}</code>Pb and <code>Y</code> =
<code class="reqn">{}^{207}</code>Pb/<code class="reqn">{}^{206}</code>Pb (if <code>x</code> has class
<code>PbPb</code>), or <code>X</code> = <code class="reqn">{}^{232}</code>Th/<code class="reqn">{}^{208}</code>Pb and
<code>Y</code> = <code class="reqn">{}^{204}</code>Pb/<code class="reqn">{}^{208}</code>Pb (if <code>x</code> has class
<code>ThPb</code>), or <code>X</code> = <code class="reqn">{}^{39}</code>Ar/<code class="reqn">{}^{40}</code>Ar and
<code>Y</code> = <code class="reqn">{}^{36}</code>Ar/<code class="reqn">{}^{40}</code>Ar (if <code>x</code> has class
<code>ArAr</code>), or <code>X</code> = <code class="reqn">{}^{40}</code>K/<code class="reqn">{}^{40}</code>Ca and
<code>Y</code> = <code class="reqn">{}^{44}</code>Ca/<code class="reqn">{}^{40}</code>Ca (if <code>x</code> has class
<code>KCa</code>), or <code>X</code> = <code class="reqn">{}^{87}</code>Rb/<code class="reqn">{}^{87}</code>Sr and
<code>Y</code> = <code class="reqn">{}^{86}</code>Sr/<code class="reqn">{}^{87}</code>Sr (if <code>x</code> has class
<code>RbSr</code>), or <code>X</code> = <code class="reqn">{}^{147}</code>Sm/<code class="reqn">{}^{143}</code>Nd and
<code>Y</code> = <code class="reqn">{}^{144}</code>Nd/<code class="reqn">{}^{143}</code>Nd (if <code>x</code> has class
<code>SmNd</code>), or <code>X</code> = <code class="reqn">{}^{187}</code>Re/<code class="reqn">{}^{187}</code>Os and
<code>Y</code> = <code class="reqn">{}^{188}</code>Os/<code class="reqn">{}^{187}</code>Os (if <code>x</code> has class
<code>ReOs</code>), or <code>X</code> = <code class="reqn">{}^{176}</code>Lu/<code class="reqn">{}^{176}</code>Hf and
<code>Y</code> = <code class="reqn">{}^{177}</code>Hf/<code class="reqn">{}^{176}</code>Hf (if <code>x</code> has class
<code>LuHf</code>).
</p>
<p>If <code>inverse=FALSE</code>, then <code>X</code> =
<code class="reqn">{}^{206}</code>Pb/<code class="reqn">{}^{204}</code>Pb and <code>Y</code> =
<code class="reqn">{}^{207}</code>Pb/<code class="reqn">{}^{204}</code>Pb (if <code>x</code> has class
<code>PbPb</code>), or <code>X</code> = <code class="reqn">{}^{232}</code>Th/<code class="reqn">{}^{204}</code>Pb and
<code>Y</code> = <code class="reqn">{}^{208}</code>Pb/<code class="reqn">{}^{204}</code>Pb (if <code>x</code> has class
<code>ThPb</code>), or <code>X</code> = <code class="reqn">{}^{39}</code>Ar/<code class="reqn">{}^{36}</code>Ar and
<code>Y</code> = <code class="reqn">{}^{40}</code>Ar/<code class="reqn">{}^{36}</code>Ar (if <code>x</code> has class
<code>ArAr</code>), or <code>X</code> = <code class="reqn">{}^{40}</code>K/<code class="reqn">{}^{44}</code>Ca and
<code>Y</code> = <code class="reqn">{}^{40}</code>Ca/<code class="reqn">{}^{44}</code>Ca (if <code>x</code> has class
<code>KCa</code>), or <code>X</code> = <code class="reqn">{}^{87}</code>Rb/<code class="reqn">{}^{86}</code>Sr and
<code>Y</code> = <code class="reqn">{}^{87}</code>Sr/<code class="reqn">{}^{86}</code>Sr (if <code>x</code> has class
<code>RbSr</code>), or <code>X</code> = <code class="reqn">{}^{147}</code>Sm/<code class="reqn">{}^{144}</code>Nd and
<code>Y</code> = <code class="reqn">{}^{143}</code>Nd/<code class="reqn">{}^{144}</code>Nd (if <code>x</code> has class
<code>SmNd</code>), or <code>X</code> = <code class="reqn">{}^{187}</code>Re/<code class="reqn">{}^{188}</code>Os and
<code>Y</code> = <code class="reqn">{}^{187}</code>Os/<code class="reqn">{}^{188}</code>Os (if <code>x</code> has class
<code>ReOs</code>), or <code>X</code> = <code class="reqn">{}^{176}</code>Lu/<code class="reqn">{}^{177}</code>Hf and
<code>Y</code> = <code class="reqn">{}^{176}</code>Hf/<code class="reqn">{}^{177}</code>Hf (if <code>x</code> has class
<code>LuHf</code>).</p>
</td></tr>
<tr><td><code id="isochron_+3A_growth">growth</code></td>
<td>
<p>add Stacey-Kramers Pb-evolution curve to the plot?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given several aliquots from a single sample, isochrons allow the
non-radiogenic component of the daughter nuclide to be quantified
and separated from the radiogenic component. In its simplest form,
an isochron is obtained by setting out the amount of radiogenic
daughter against the amount of radioactive parent, both normalised
to a non-radiogenic isotope of the daughter element, and fitting a
straight line through these points by least squares regression
(Nicolaysen, 1961). The slope and intercept then yield the
radiogenic daughter-parent ratio and the non-radiogenic daughter
composition, respectively. There are several ways to fit an
isochron.  The easiest of these is total least squares
regression, which weighs all data points equally. In the presence
of quantifiable analytical uncertainty, it is equally
straightforward to use the inverse of the y-errors as weights.  It
is significantly more difficult to take into account uncertainties
in both the x- and the y-variable (York, 1966). <code>IsoplotR</code>
does so for its U-Th-He isochron calculations. The York (1966)
method assumes that the analytical uncertainties of the x- and
y-variables are independent from each other. This assumption is
rarely met in geochronology.  York (1968) addresses this issue with
a bivariate error weighted linear least squares algorithm that
accounts for covariant errors in both variables. This algorithm was
further improved by York et al. (2004) to ensure consistency with
the maximum likelihood approach of Titterington and Halliday
(1979).
</p>
<p><code>IsoplotR</code> uses the York et al. (2004) algorithm for its
Ar-Ar, K-Ca, Pb-Pb, Th-Pb, Rb-Sr, Sm-Nd, Re-Os and Lu-Hf
isochrons. The maximum likelihood algorithm of Titterington and
Halliday (1979) was generalised from two to three dimensions by
Ludwig and Titterington (1994) for U-series disequilibrium dating.
Also this algorithm is implemented in <code>IsoplotR</code>. Finally, the
constrained maximum likelihood algorithms of Ludwig (1998) and
Vermeesch (2020) are used for isochron regression of U-Pb data. The
extent to which the observed scatter in the data can be explained
by the analytical uncertainties can be assessed using the Mean
Square of the Weighted Deviates (MSWD, McIntyre et al., 1966),
which is defined as:
</p>
<p><code class="reqn">MSWD = ([X - \hat{X}] \Sigma_{X}^{-1} [X - \hat{X}]^T)/df</code>
</p>
<p>where <code class="reqn">X</code> are the data, <code class="reqn">\hat{X}</code> are the fitted values,
and <code class="reqn">\Sigma_X</code> is the covariance matrix of <code class="reqn">X</code>, and <code class="reqn">df
= k(n-1)</code> are the degrees of freedom, where <code class="reqn">k</code> is the
dimensionality of the linear fit. MSWD values that are far smaller
or greater than 1 indicate under- or overdispersed measurements,
respectively. Underdispersion can be attributed to overestimated
analytical uncertainties. <code>IsoplotR</code> provides three
alternative strategies to deal with overdispersed data:
</p>

<ol>
<li><p> Attribute the overdispersion to an underestimation of the
analytical uncertainties. In this case, the excess scatter can be
accounted for by inflating those uncertainties by a <em>factor</em>
<code class="reqn">\sqrt{MSWD}</code>.
</p>
</li>
<li><p> Ignore the analytical uncertainties and perform a total
least squares regression.
</p>
</li>
<li><p> Attribute the overdispersion to the presence of 'geological
scatter'.  In this case, the excess scatter can be accounted for by
adding an overdispersion <em>term</em> that lowers the MSWD to unity.
</p>
</li></ol>



<h3>Value</h3>

<p>If <code>x</code> has class <code>PbPb</code>, <code>ThPb</code>,
<code>ArAr</code>, <code>KCa</code>, <code>RbSr</code>, <code>SmNd</code>, <code>ReOs</code>
or <code>LuHf</code>, or <code>UThHe</code>, returns a list with the
following items:
</p>

<dl>
<dt>a</dt><dd><p>the intercept of the straight line fit and its standard
error.</p>
</dd>
<dt>b</dt><dd><p>the slope of the fit and its standard error.</p>
</dd>
<dt>cov.ab</dt><dd><p>the covariance of the slope and intercept</p>
</dd>
<dt>df</dt><dd><p>the degrees of freedom of the linear fit (<code class="reqn">df=n-2</code>
for non-anchored fits)</p>
</dd>
<dt>y0</dt><dd><p>a two- or three-element list containing:
</p>
<p><code>y</code>: the atmospheric <code class="reqn">^{40}</code>Ar/<code class="reqn">^{36}</code>Ar or initial
<code class="reqn">^{40}</code>Ca/<code class="reqn">^{44}</code>Ca, <code class="reqn">^{187}</code>Os/<code class="reqn">^{188}</code>Os,
<code class="reqn">^{87}</code>Sr/<code class="reqn">^{87}</code>Rb, <code class="reqn">^{143}</code>Nd/<code class="reqn">^{144}</code>Nd,
<code class="reqn">^{176}</code>Hf/<code class="reqn">^{177}</code>Hf or <code class="reqn">^{208}</code>Pb/<code class="reqn">^{204}</code>Pb
ratio.
</p>
<p><code>s[y]</code>: the standard error of <code>y</code>
</p>
<p><code>disp[y]</code>: the standard error of <code>y</code> enhanced by
<code class="reqn">\sqrt{mswd}</code> (only applicable if <code> model=1</code>).  </p>
</dd>
<dt>age</dt><dd><p>a three-element list containing:
</p>
<p><code>t</code>: the <code class="reqn">^{207}</code>Pb/<code class="reqn">^{206}</code>Pb,
<code class="reqn">^{208}</code>Pb/<code class="reqn">^{232}</code>Th, <code class="reqn">^{40}</code>Ar/<code class="reqn">^{39}</code>Ar,
<code class="reqn">^{40}</code>K/<code class="reqn">^{40}</code>Ca, <code class="reqn">^{187}</code>Os/<code class="reqn">^{187}</code>Re,
<code class="reqn">^{87}</code>Sr/<code class="reqn">^{87}</code>Rb, <code class="reqn">^{143}</code>Nd/<code class="reqn">^{144}</code>Nd or
<code class="reqn">^{176}</code>Hf/<code class="reqn">^{177}</code>Hf age.
</p>
<p><code>s[t]</code>: the standard error of <code>t</code>
</p>
<p><code>disp[t]</code>: the standard error of <code>t</code> enhanced by
<code class="reqn">\sqrt{mswd}</code> (only applicable if <code> model=1</code>).  </p>
</dd>
<dt>mswd</dt><dd><p>the mean square of the residuals (a.k.a 'reduced
Chi-square') statistic (omitted if <code>model=2</code>).</p>
</dd>
<dt>p.value</dt><dd><p>the p-value of a Chi-square test for linearity
(omitted if <code>model=2</code>)</p>
</dd>
<dt>w</dt><dd><p>the overdispersion term, i.e. a two-element vector with
the standard deviation of the (assumed) normally distributed
geological scatter that underlies the measurements, and its
standard error (only returned if <code>model=3</code>).</p>
</dd>
<dt>ski</dt><dd><p>(only reported if <code>x</code> has class <code>PbPb</code> and
<code>growth</code> is <code>TRUE</code>) the intercept(s) of the isochron with
the Stacey-Kramers mantle evolution curve.</p>
</dd>
</dl>

<p>OR, if <code>x</code> has class <code>ThU</code>:
</p>

<dl>
<dt>par</dt><dd><p>if <code>x$type=1</code> or <code>x$type=3</code>: the best fitting
<code class="reqn">^{230}</code>Th/<code class="reqn">^{232}</code>Th intercept,
<code class="reqn">^{230}</code>Th/<code class="reqn">^{238}</code>U slope, <code class="reqn">^{234}</code>U/<code class="reqn">^{232}</code>Th
intercept and <code class="reqn">^{234}</code>U/<code class="reqn">^{238}</code>U slope, OR, if
<code>x$type=2</code> or <code>x$type=4</code>: the best fitting
<code class="reqn">^{234}</code>U/<code class="reqn">^{238}</code>U intercept,
<code class="reqn">^{230}</code>Th/<code class="reqn">^{232}</code>Th slope, <code class="reqn">^{234}</code>U/<code class="reqn">^{238}</code>U
intercept and <code class="reqn">^{234}</code>U/<code class="reqn">^{232}</code>Th slope.  </p>
</dd>
<dt>cov</dt><dd><p>the covariance matrix of <code>par</code>.</p>
</dd>
<dt>df</dt><dd><p>the degrees of freedom for the linear fit, i.e. <code class="reqn">(3n-3)</code> if
<code>x$format=1</code> or <code>x$format=2</code>, and <code class="reqn">(2n-2)</code> if
<code>x$format=3</code> or <code>x$format=4</code></p>
</dd>
<dt>a</dt><dd><p>if <code>type=1</code>: the <code class="reqn">^{230}</code>Th/<code class="reqn">^{232}</code>Th
intercept; if <code>type=2</code>: the <code class="reqn">^{230}</code>Th/<code class="reqn">^{238}</code>U
intercept; if <code>type=3</code>: the <code class="reqn">^{234}</code>Th/<code class="reqn">^{232}</code>Th
intercept; if <code>type=4</code>: the <code class="reqn">^{234}</code>Th/<code class="reqn">^{238}</code>U
intercept and its propagated uncertainty.</p>
</dd>
<dt>b</dt><dd><p>if <code>type=1</code>: the <code class="reqn">^{230}</code>Th/<code class="reqn">^{238}</code>U slope;
if <code>type=2</code>: the <code class="reqn">^{230}</code>Th/<code class="reqn">^{232}</code>Th slope; if
<code>type=3</code>: the <code class="reqn">^{234}</code>U/<code class="reqn">^{238}</code>U slope; if
<code>type=4</code>: the <code class="reqn">^{234}</code>U/<code class="reqn">^{232}</code>Th slope and its
propagated uncertainty.</p>
</dd>
<dt>cov.ab</dt><dd><p>the covariance between <code>a</code> and <code>b</code>.</p>
</dd>
<dt>mswd</dt><dd><p>the mean square of the residuals (a.k.a 'reduced
Chi-square') statistic.</p>
</dd>
<dt>p.value</dt><dd><p>the p-value of a Chi-square test for linearity.</p>
</dd>
<dt>y0</dt><dd><p>a three-element vector containing:
</p>
<p><code>y</code>: the initial <code class="reqn">^{234}</code>U/<code class="reqn">^{238}</code>U-ratio
</p>
<p><code>s[y]</code>: the standard error of <code>y</code>
</p>
<p><code>disp[y]</code>: the standard error of <code>y</code> enhanced by
<code class="reqn">\sqrt{mswd}</code>.</p>
</dd>
<dt>age</dt><dd><p>a two (or three) element vector containing:
</p>
<p><code>t</code>: the initial <code class="reqn">^{234}</code>U/<code class="reqn">^{238}</code>U-ratio
</p>
<p><code>s[t]</code>: the standard error of <code>t</code>
</p>
<p><code>disp[t]</code>: the standard error of <code>t</code> enhanced by
<code class="reqn">\sqrt{mswd}</code> (only reported if <code>model=1</code>).</p>
</dd>
<dt>w</dt><dd><p>the overdispersion term, i.e. a two-element vector with
the standard deviation of the (assumedly) Normally distributed
geological scatter that underlies the measurements, and its
standard error.</p>
</dd>
<dt>d</dt><dd><p>a matrix with the following columns: the X-variable for
the isochron plot, the analytical uncertainty of X, the Y-variable
for the isochron plot, the analytical uncertainty of Y, and the
correlation coefficient between X and Y.</p>
</dd>
<dt>xlab</dt><dd><p>the x-label of the isochron plot</p>
</dd>
<dt>ylab</dt><dd><p>the y-label of the isochron plot</p>
</dd>
</dl>

<p>OR if <code>x</code> has class <code>UPb</code>:
</p>

<dl>
<dt>par</dt><dd><p>if <code>model=1</code> or <code>2</code>, a three element vector
containing the isochron age and the common Pb isotope ratios. If
<code>model=3</code>, adds a fourth element with the overdispersion
parameter <code class="reqn">w</code>.</p>
</dd>
<dt>cov</dt><dd><p>the covariance matrix of <code>par</code></p>
</dd>
<dt>logpar</dt><dd><p>the logarithm of <code>par</code></p>
</dd>
<dt>logcov</dt><dd><p>the logarithm of <code>cov</code></p>
</dd>
<dt>n</dt><dd><p>the number of analyses in the dataset</p>
</dd>
<dt>df</dt><dd><p>the degrees of freedom for the linear fit, i.e. <code class="reqn">2n-3</code></p>
</dd>
<dt>a</dt><dd><p>the y-intercept and its standard error</p>
</dd>
<dt>b</dt><dd><p>the isochron slope and its standard error</p>
</dd>
<dt>cov.ab</dt><dd><p>the covariance between <code>a</code> and <code>b</code>.</p>
</dd>
<dt>mswd</dt><dd><p>the mean square of the residuals (a.k.a 'reduced
Chi-square') statistic.</p>
</dd>
<dt>p.value</dt><dd><p>the p-value of a Chi-square test for linearity.</p>
</dd>
<dt>y0</dt><dd><p>a two or three-element vector containing:
</p>
<p><code>y</code>: the initial <code class="reqn">^{206}</code>Pb/<code class="reqn">^{204}</code>Pb-ratio (if
<code>type=1</code> and <code>x$format=4,5</code> or <code>6</code>);
<code class="reqn">^{207}</code>Pb/<code class="reqn">^{204}</code>Pb-ratio (if <code>type=2</code> and
<code>x$format=4,5</code> or <code>6</code>);
<code class="reqn">^{208}</code>Pb/<code class="reqn">^{206}</code>Pb-ratio (if <code>type=1</code> and
<code>x$format=7</code> or <code>8</code>); 
<code class="reqn">^{208}</code>Pb/<code class="reqn">^{207}</code>Pb-ratio (if <code>type=2</code> and
<code>x$format=7</code> or <code>8</code>);
<code class="reqn">^{206}</code>Pb/<code class="reqn">^{208}</code>Pb-ratio (if <code>type=3</code> and
<code>x$format=7</code> or <code>8</code>); or
<code class="reqn">^{207}</code>Pb/<code class="reqn">^{208}</code>Pb-ratio (if <code>type=4</code> and
<code>x$format=7</code> or <code>8</code>).
</p>
<p><code>s[y]</code>: the standard error of <code>y</code>
</p>
<p><code>disp[y]</code>: the standard error of <code>y</code> enhanced by
<code class="reqn">\sqrt{mswd}</code> (only returned if <code>model=1</code>)</p>
</dd>
<dt>y0label</dt><dd><p>the y-axis label of the isochron plot</p>
</dd>
<dt>age</dt><dd><p>a two (or three) element vector containing:
</p>
<p><code>t</code>: the isochron age
</p>
<p><code>s[t]</code>: the standard error of <code>t</code>
</p>
<p><code>disp[t]</code>: the standard error of <code>t</code> enhanced by
<code class="reqn">\sqrt{mswd}</code> (only reported if <code>model=1</code>).</p>
</dd>
<dt>xlab</dt><dd><p>the x-label of the isochron plot</p>
</dd>
<dt>ylab</dt><dd><p>the y-label of the isochron plot</p>
</dd>
</dl>

<p>OR, if <code>x</code> has class <code>other</code> and <code>x$format</code> is
either <code>4</code> or <code>5</code> and <code>flippable</code> is not <code>0</code>,
returns
</p>
<p><code>Dd</code>: the ratio of the inherited radiogenic daughter to its
nonradiogenic sister isotope
</p>
<p><code>DP</code>: the ratio fo the radiogic daughter to its radioactive parent
</p>
<p><code>cov.DdDP</code>: the covariance between <code>Dd</code> and <code>DP</code>.
</p>
<p>In the remaining types of <code>other</code> data, the intercept <code>a</code>
and <code>b</code> are returned along with their covariance.
</p>


<h3>References</h3>

<p>Ludwig, K.R. and Titterington, D.M., 1994. Calculation of
<code class="reqn">^{230}</code>Th/U isochrons, ages, and errors. Geochimica et
Cosmochimica Acta, 58(22), pp.5031-5042.
</p>
<p>Ludwig, K.R., 1998. On the treatment of concordant uranium-lead
ages. Geochimica et Cosmochimica Acta, 62(4), pp.665-676.
</p>
<p>Nicolaysen, L.O., 1961. Graphic interpretation of discordant age
measurements on metamorphic rocks. Annals of the New York Academy
of Sciences, 91(1), pp.198-206.
</p>
<p>Titterington, D.M. and Halliday, A.N., 1979. On the fitting of
parallel isochrons and the method of maximum likelihood. Chemical
Geology, 26(3), pp.183-195.
</p>
<p>Vermeesch, P., 2020. Unifying the U-Pb and Th-Pb methods: joint
isochron regression and common Pb correction, Geochronology, 2,
119-131.
</p>
<p>York, D., 1966. Least-squares fitting of a straight line. Canadian
Journal of Physics, 44(5), pp.1079-1086.
</p>
<p>York, D., 1968. Least squares fitting of a straight line with
correlated errors. Earth and Planetary Science Letters, 5,
pp.320-324.
</p>
<p>York, D., Evensen, N.M., Martinez, M.L. and De Basebe Delgado, J., 2004.
Unified equations for the slope, intercept, and standard
errors of the best straight line. American Journal of Physics,
72(3), pp.367-375.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+york">york</a></code>,
<code><a href="#topic+titterington">titterington</a></code>,
<code><a href="#topic+ludwig">ludwig</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>attach(examples)
isochron(RbSr)

fit &lt;- isochron(ArAr,inverse=FALSE,plot=FALSE)

dev.new()
isochron(ThU,type=4)

</code></pre>

<hr>
<h2 id='IsoplotR'>library(IsoplotR)</h2><span id='topic+IsoplotR'></span><span id='topic+IsoplotR-package'></span>

<h3>Description</h3>

<p>A list of documented functions may be viewed by typing
<code>help(package='IsoplotR')</code>.  Detailed instructions are
provided at <a href="https://www.ucl.ac.uk/~ucfbpve/isoplotr/">https://www.ucl.ac.uk/~ucfbpve/isoplotr/</a>. Further
details about the theoretical background are provided by
Vermeesch (2018).
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Pieter Vermeesch <a href="mailto:p.vermeesch@ucl.ac.uk">p.vermeesch@ucl.ac.uk</a>
</p>


<h3>References</h3>

<p>Vermeesch, P., 2018, IsoplotR: a free and open toolbox
for geochronology. Geoscience Frontiers, 9, 1479-1493, doi:
10.1016/j.gsf.2018.04.001.
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://www.ucl.ac.uk/~ucfbpve/isoplotr/">https://www.ucl.ac.uk/~ucfbpve/isoplotr/</a>
</p>
</li>
<li> <p><a href="https://github.com/pvermees/IsoplotR/">https://github.com/pvermees/IsoplotR/</a>
</p>
</li></ul>


<hr>
<h2 id='IsoplotR-internal'>Internal code objects</h2><span id='topic+IsoplotR-internal'></span>

<h3>Description</h3>

<p>These are not to be called by the user (or in some cases are just
waiting for proper documentation to be written ).
</p>

<hr>
<h2 id='kde'>Create (a) kernel density estimate(s)</h2><span id='topic+kde'></span><span id='topic+kde.default'></span><span id='topic+kde.other'></span><span id='topic+kde.UPb'></span><span id='topic+kde.detritals'></span><span id='topic+kde.PbPb'></span><span id='topic+kde.ArAr'></span><span id='topic+kde.KCa'></span><span id='topic+kde.ThPb'></span><span id='topic+kde.ThU'></span><span id='topic+kde.ReOs'></span><span id='topic+kde.SmNd'></span><span id='topic+kde.RbSr'></span><span id='topic+kde.LuHf'></span><span id='topic+kde.UThHe'></span><span id='topic+kde.fissiontracks'></span>

<h3>Description</h3>

<p>Creates one or more kernel density estimates using a combination of
the Botev (2010) bandwidth selector and the Abramson (1982)
adaptive kernel bandwidth modifier.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kde(x, ...)

## Default S3 method:
kde(
  x,
  from = NA,
  to = NA,
  bw = NA,
  adaptive = TRUE,
  log = FALSE,
  n = 512,
  plot = TRUE,
  rug = TRUE,
  xlab = "age [Ma]",
  ylab = "",
  kde.col = rgb(1, 0, 1, 0.6),
  hist.col = rgb(0, 1, 0, 0.2),
  show.hist = TRUE,
  bty = "n",
  binwidth = NA,
  hide = NULL,
  nmodes = 0,
  sigdig = 2,
  ...
)

## S3 method for class 'other'
kde(
  x,
  from = NA,
  to = NA,
  bw = NA,
  adaptive = TRUE,
  log = FALSE,
  n = 512,
  plot = TRUE,
  rug = TRUE,
  xlab = "age [Ma]",
  ylab = "",
  kde.col = rgb(1, 0, 1, 0.6),
  hist.col = rgb(0, 1, 0, 0.2),
  show.hist = TRUE,
  bty = "n",
  binwidth = NA,
  hide = NULL,
  nmodes = 0,
  sigdig = 2,
  ...
)

## S3 method for class 'UPb'
kde(
  x,
  from = NA,
  to = NA,
  bw = NA,
  adaptive = TRUE,
  log = FALSE,
  n = 512,
  plot = TRUE,
  rug = TRUE,
  xlab = "age [Ma]",
  ylab = "",
  kde.col = rgb(1, 0, 1, 0.6),
  hist.col = rgb(0, 1, 0, 0.2),
  show.hist = TRUE,
  bty = "n",
  binwidth = NA,
  type = 4,
  cutoff.76 = 1100,
  cutoff.disc = discfilter(),
  common.Pb = 0,
  hide = NULL,
  nmodes = 0,
  sigdig = 2,
  ...
)

## S3 method for class 'detritals'
kde(
  x,
  from = NA,
  to = NA,
  bw = NA,
  adaptive = TRUE,
  log = FALSE,
  n = 512,
  plot = TRUE,
  rug = FALSE,
  xlab = "age [Ma]",
  ylab = "",
  kde.col = rgb(1, 0, 1, 0.6),
  hist.col = rgb(0, 1, 0, 0.2),
  show.hist = TRUE,
  bty = "n",
  binwidth = NA,
  ncol = NA,
  samebandwidth = TRUE,
  normalise = TRUE,
  hide = NULL,
  nmodes = 0,
  sigdig = 2,
  ...
)

## S3 method for class 'PbPb'
kde(
  x,
  from = NA,
  to = NA,
  bw = NA,
  adaptive = TRUE,
  log = FALSE,
  n = 512,
  plot = TRUE,
  rug = TRUE,
  xlab = "age [Ma]",
  ylab = "",
  kde.col = rgb(1, 0, 1, 0.6),
  hist.col = rgb(0, 1, 0, 0.2),
  show.hist = TRUE,
  bty = "n",
  binwidth = NA,
  common.Pb = 2,
  hide = NULL,
  nmodes = 0,
  sigdig = 2,
  ...
)

## S3 method for class 'ArAr'
kde(
  x,
  from = NA,
  to = NA,
  bw = NA,
  adaptive = TRUE,
  log = FALSE,
  n = 512,
  plot = TRUE,
  rug = TRUE,
  xlab = "age [Ma]",
  ylab = "",
  kde.col = rgb(1, 0, 1, 0.6),
  hist.col = rgb(0, 1, 0, 0.2),
  show.hist = TRUE,
  bty = "n",
  binwidth = NA,
  i2i = FALSE,
  hide = NULL,
  nmodes = 0,
  sigdig = 2,
  ...
)

## S3 method for class 'KCa'
kde(
  x,
  from = NA,
  to = NA,
  bw = NA,
  adaptive = TRUE,
  log = FALSE,
  n = 512,
  plot = TRUE,
  rug = TRUE,
  xlab = "age [Ma]",
  ylab = "",
  kde.col = rgb(1, 0, 1, 0.6),
  hist.col = rgb(0, 1, 0, 0.2),
  show.hist = TRUE,
  bty = "n",
  binwidth = NA,
  i2i = FALSE,
  hide = NULL,
  nmodes = 0,
  sigdig = 2,
  ...
)

## S3 method for class 'ThPb'
kde(
  x,
  from = NA,
  to = NA,
  bw = NA,
  adaptive = TRUE,
  log = FALSE,
  n = 512,
  plot = TRUE,
  rug = TRUE,
  xlab = "age [Ma]",
  ylab = "",
  kde.col = rgb(1, 0, 1, 0.6),
  hist.col = rgb(0, 1, 0, 0.2),
  show.hist = TRUE,
  bty = "n",
  binwidth = NA,
  i2i = FALSE,
  hide = NULL,
  nmodes = 0,
  sigdig = 2,
  ...
)

## S3 method for class 'ThU'
kde(
  x,
  from = NA,
  to = NA,
  bw = NA,
  adaptive = TRUE,
  log = FALSE,
  n = 512,
  plot = TRUE,
  rug = TRUE,
  xlab = "age [ka]",
  ylab = "",
  kde.col = rgb(1, 0, 1, 0.6),
  hist.col = rgb(0, 1, 0, 0.2),
  show.hist = TRUE,
  bty = "n",
  binwidth = NA,
  Th0i = 0,
  hide = NULL,
  nmodes = 0,
  sigdig = 2,
  ...
)

## S3 method for class 'ReOs'
kde(
  x,
  from = NA,
  to = NA,
  bw = NA,
  adaptive = TRUE,
  log = FALSE,
  n = 512,
  plot = TRUE,
  rug = TRUE,
  xlab = "age [Ma]",
  ylab = "",
  kde.col = rgb(1, 0, 1, 0.6),
  hist.col = rgb(0, 1, 0, 0.2),
  show.hist = TRUE,
  bty = "n",
  binwidth = NA,
  i2i = TRUE,
  hide = NULL,
  nmodes = 0,
  sigdig = 2,
  ...
)

## S3 method for class 'SmNd'
kde(
  x,
  from = NA,
  to = NA,
  bw = NA,
  adaptive = TRUE,
  log = FALSE,
  n = 512,
  plot = TRUE,
  rug = TRUE,
  xlab = "age [Ma]",
  ylab = "",
  kde.col = rgb(1, 0, 1, 0.6),
  hist.col = rgb(0, 1, 0, 0.2),
  show.hist = TRUE,
  bty = "n",
  binwidth = NA,
  i2i = TRUE,
  hide = NULL,
  nmodes = 0,
  sigdig = 2,
  ...
)

## S3 method for class 'RbSr'
kde(
  x,
  from = NA,
  to = NA,
  bw = NA,
  adaptive = TRUE,
  log = FALSE,
  n = 512,
  plot = TRUE,
  rug = TRUE,
  xlab = "age [Ma]",
  ylab = "",
  kde.col = rgb(1, 0, 1, 0.6),
  hist.col = rgb(0, 1, 0, 0.2),
  show.hist = TRUE,
  bty = "n",
  binwidth = NA,
  i2i = TRUE,
  hide = NULL,
  nmodes = 0,
  sigdig = 2,
  ...
)

## S3 method for class 'LuHf'
kde(
  x,
  from = NA,
  to = NA,
  bw = NA,
  adaptive = TRUE,
  log = FALSE,
  n = 512,
  plot = TRUE,
  rug = TRUE,
  xlab = "age [Ma]",
  ylab = "",
  kde.col = rgb(1, 0, 1, 0.6),
  hist.col = rgb(0, 1, 0, 0.2),
  show.hist = TRUE,
  bty = "n",
  binwidth = NA,
  i2i = TRUE,
  hide = NULL,
  nmodes = 0,
  sigdig = 2,
  ...
)

## S3 method for class 'UThHe'
kde(
  x,
  from = NA,
  to = NA,
  bw = NA,
  adaptive = TRUE,
  log = FALSE,
  n = 512,
  plot = TRUE,
  rug = TRUE,
  xlab = "age [Ma]",
  ylab = "",
  kde.col = rgb(1, 0, 1, 0.6),
  hist.col = rgb(0, 1, 0, 0.2),
  show.hist = TRUE,
  bty = "n",
  binwidth = NA,
  hide = NULL,
  nmodes = 0,
  sigdig = 2,
  ...
)

## S3 method for class 'fissiontracks'
kde(
  x,
  from = NA,
  to = NA,
  bw = NA,
  adaptive = TRUE,
  log = FALSE,
  n = 512,
  plot = TRUE,
  rug = TRUE,
  xlab = "age [Ma]",
  ylab = "",
  kde.col = rgb(1, 0, 1, 0.6),
  hist.col = rgb(0, 1, 0, 0.2),
  show.hist = TRUE,
  bty = "n",
  binwidth = NA,
  hide = NULL,
  nmodes = 0,
  sigdig = 2,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kde_+3A_x">x</code></td>
<td>
<p>a vector of numbers OR an object of class <code>UPb</code>,
<code>PbPb</code>, <code>ThPb</code>, <code>ArAr</code>, <code>KCa</code>, <code>ReOs</code>,
<code>SmNd</code>, <code>RbSr</code>, <code>UThHe</code>, <code>fissiontracks</code>,
<code>ThU</code> or <code>detrital</code></p>
</td></tr>
<tr><td><code id="kde_+3A_...">...</code></td>
<td>
<p>optional arguments to be passed on to <code>R</code>'s
<code>density</code> function.</p>
</td></tr>
<tr><td><code id="kde_+3A_from">from</code></td>
<td>
<p>minimum age of the time axis. If <code>NULL</code>, this is
set automatically</p>
</td></tr>
<tr><td><code id="kde_+3A_to">to</code></td>
<td>
<p>maximum age of the time axis. If <code>NULL</code>, this is set
automatically</p>
</td></tr>
<tr><td><code id="kde_+3A_bw">bw</code></td>
<td>
<p>the bandwidth of the KDE. If <code>NULL</code>, <code>bw</code> will
be calculated automatically using the algorithm by Botev et
al. (2010).</p>
</td></tr>
<tr><td><code id="kde_+3A_adaptive">adaptive</code></td>
<td>
<p>logical flag controlling if the adaptive KDE
modifier of Abramson (1982) is used</p>
</td></tr>
<tr><td><code id="kde_+3A_log">log</code></td>
<td>
<p>transform the ages to a log scale if <code>TRUE</code></p>
</td></tr>
<tr><td><code id="kde_+3A_n">n</code></td>
<td>
<p>horizontal resolution (i.e., the number of segments) of
the density estimate.</p>
</td></tr>
<tr><td><code id="kde_+3A_plot">plot</code></td>
<td>
<p>show the KDE as a plot</p>
</td></tr>
<tr><td><code id="kde_+3A_rug">rug</code></td>
<td>
<p>add a rug plot?</p>
</td></tr>
<tr><td><code id="kde_+3A_xlab">xlab</code></td>
<td>
<p>the x-axis label</p>
</td></tr>
<tr><td><code id="kde_+3A_ylab">ylab</code></td>
<td>
<p>the y-axis label</p>
</td></tr>
<tr><td><code id="kde_+3A_kde.col">kde.col</code></td>
<td>
<p>the fill colour of the KDE specified as a four
element vector of <code>r, g, b, alpha</code> values</p>
</td></tr>
<tr><td><code id="kde_+3A_hist.col">hist.col</code></td>
<td>
<p>the fill colour of the histogram specified as a
four element vector of <code>r, g, b, alpha</code> values</p>
</td></tr>
<tr><td><code id="kde_+3A_show.hist">show.hist</code></td>
<td>
<p>logical flag indicating whether a histogram should
be added to the KDE</p>
</td></tr>
<tr><td><code id="kde_+3A_bty">bty</code></td>
<td>
<p>change to <code>"o"</code>, <code>"l"</code>, <code>"7"</code>,
<code>"c"</code>, <code>"u"</code>, or <code>"]"</code> if you want to draw a box
around the plot</p>
</td></tr>
<tr><td><code id="kde_+3A_binwidth">binwidth</code></td>
<td>
<p>scalar width of the histogram bins, in Myr if
<code>log = FALSE</code>, or as a fractional value if <code>log =
TRUE</code>. Sturges' Rule (<code class="reqn">\log_2[n]+1</code>, where <code class="reqn">n</code> is the
number of data points) is used if <code>binwidth = NA</code></p>
</td></tr>
<tr><td><code id="kde_+3A_hide">hide</code></td>
<td>
<p>vector with indices of aliquots that should be removed
from the plot.</p>
</td></tr>
<tr><td><code id="kde_+3A_nmodes">nmodes</code></td>
<td>
<p>label the <code>nmodes</code> most prominent modes of the
distribution. Change to <code>'all'</code> to label all the modes.</p>
</td></tr>
<tr><td><code id="kde_+3A_sigdig">sigdig</code></td>
<td>
<p>the number of significant digits to which the modes
should be labelled. Only used if <code>nmodes</code> is a positive
integer or <code>'all'</code>.</p>
</td></tr>
<tr><td><code id="kde_+3A_type">type</code></td>
<td>
<p>scalar indicating whether to plot the
<code class="reqn">^{207}</code>Pb/<code class="reqn">^{235}</code>U age (<code>type</code>=1), the
<code class="reqn">^{206}</code>Pb/<code class="reqn">^{238}</code>U age (<code>type</code>=2), the
<code class="reqn">^{207}</code>Pb/<code class="reqn">^{206}</code>Pb age (<code>type</code>=3), the
<code class="reqn">^{207}</code>Pb/<code class="reqn">^{206}</code>Pb-<code class="reqn">^{206}</code>Pb/<code class="reqn">^{238}</code>U age
(<code>type</code>=4), the concordia age (<code>type</code>=5), or the
<code class="reqn">^{208}</code>Pb/<code class="reqn">^{232}</code>Th age (<code>type</code>=6).</p>
</td></tr>
<tr><td><code id="kde_+3A_cutoff.76">cutoff.76</code></td>
<td>
<p>the age (in Ma) below which the
<code class="reqn">^{206}</code>Pb/<code class="reqn">^{238}</code>U and above which the
<code class="reqn">^{207}</code>Pb/<code class="reqn">^{206}</code>Pb age is used. This parameter is
only used if <code>type=4</code>.</p>
</td></tr>
<tr><td><code id="kde_+3A_cutoff.disc">cutoff.disc</code></td>
<td>
<p>discordance cutoff filter. This is an object of
class <code><a href="#topic+discfilter">discfilter</a></code>.</p>
</td></tr>
<tr><td><code id="kde_+3A_common.pb">common.Pb</code></td>
<td>
<p>common lead correction:
</p>
<p><code>0</code>: none
</p>
<p><code>1</code>: use the Pb-composition stored in
</p>
<p><code>settings('iratio','Pb207Pb206')</code> (if <code>x</code> has class
<code>UPb</code> and <code>x$format&lt;4</code>);
</p>
<p><code>settings('iratio','Pb206Pb204')</code> and
<code>settings('iratio','Pb207Pb204')</code> (if <code>x</code> has class
<code>PbPb</code> or <code>x</code> has class <code>UPb</code> and
<code>3&lt;x$format&lt;7</code>); or
</p>
<p><code>settings('iratio','Pb206Pb208')</code> and
<code>settings('iratio','Pb207Pb208')</code> (if <code>x</code> has class
<code>UPb</code> and <code>x$format=7,8</code>).
</p>
<p><code>2</code>: use the isochron intercept as the initial Pb-composition
</p>
<p><code>3</code>: use the Stacey-Kramers two-stage model to infer the
initial Pb-composition (only valid if <code>x</code> has class
<code>UPb</code>).</p>
</td></tr>
<tr><td><code id="kde_+3A_ncol">ncol</code></td>
<td>
<p>scalar value indicating the number of columns over
which the KDEs should be divided.</p>
</td></tr>
<tr><td><code id="kde_+3A_samebandwidth">samebandwidth</code></td>
<td>
<p>logical flag indicating whether the same
bandwidth should be used for all samples. If
<code>samebandwidth = TRUE</code> and <code>bw = NULL</code>, then the
function will use the median bandwidth of all the samples.</p>
</td></tr>
<tr><td><code id="kde_+3A_normalise">normalise</code></td>
<td>
<p>logical flag indicating whether or not the KDEs
should all integrate to the same value.</p>
</td></tr>
<tr><td><code id="kde_+3A_i2i">i2i</code></td>
<td>
<p>&lsquo;isochron to intercept&rsquo;: calculates the initial (aka
&lsquo;inherited&rsquo;, &lsquo;excess&rsquo;, or &lsquo;common&rsquo;)
<code class="reqn">^{40}</code>Ar/<code class="reqn">^{36}</code>Ar, <code class="reqn">^{40}</code>Ca/<code class="reqn">^{44}</code>Ca,
<code class="reqn">^{207}</code>Pb/<code class="reqn">^{204}</code>Pb, <code class="reqn">^{87}</code>Sr/<code class="reqn">^{86}</code>Sr,
<code class="reqn">^{143}</code>Nd/<code class="reqn">^{144}</code>Nd, <code class="reqn">^{187}</code>Os/<code class="reqn">^{188}</code>Os,
<code class="reqn">^{230}</code>Th/<code class="reqn">^{232}</code>Th, <code class="reqn">^{176}</code>Hf/<code class="reqn">^{177}</code>Hf or
<code class="reqn">^{204}</code>Pb/<code class="reqn">^{208}</code>Pb ratio from an isochron
fit. Setting <code>i2i</code> to <code>FALSE</code> uses the default values
stored in <code>settings('iratio',...)</code>.</p>
</td></tr>
<tr><td><code id="kde_+3A_th0i">Th0i</code></td>
<td>
<p>initial <code class="reqn">^{230}</code>Th correction.
</p>
<p><code>0</code>: no correction
</p>
<p><code>1</code>: project the data along an isochron fit
</p>
<p><code>2</code>: if <code>x$format</code> is <code>1</code> or <code>2</code>, correct the
data using the measured present day <code class="reqn">^{230}</code>Th/<code class="reqn">^{238}</code>U,
<code class="reqn">^{232}</code>Th/<code class="reqn">^{238}</code>U and <code class="reqn">^{234}</code>U/<code class="reqn">^{238}</code>U
activity ratios in the detritus. If <code>x$format</code> is <code>3</code> or
<code>4</code>, correct the data using the measured
<code class="reqn">^{238}</code>U/<code class="reqn">^{232}</code>Th activity ratio of the whole rock, as
stored in <code>x</code> by the <code>read.data()</code> function.
</p>
<p><code>3</code>: correct the data using an assumed initial
<code class="reqn">^{230}</code>Th/<code class="reqn">^{232}</code>Th-ratio for the detritus (only relevant
if <code>x$format</code> is <code>1</code> or <code>2</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given a set of <code class="reqn">n</code> age estimates <code class="reqn">\{t_1, t_2, ..., t_n\}</code>,
histograms and KDEs are probability density estimators that display
age distributions by smoothing.  Histograms do this by grouping the
data into a number of regularly spaced bins.  Alternatively, kernel
density estimates (KDEs; Vermeesch, 2012) smooth data by applying a
(Gaussian) kernel:
</p>
<p><code class="reqn">KDE(t) = \sum_{i=1}^{n}N(t|\mu=t_i,\sigma=h[t])/n</code>
</p>
<p>where <code class="reqn">N(t|\mu,\sigma)</code> is the probability of observing a value
<code class="reqn">t</code> under a Normal distribution with mean <code class="reqn">\mu</code> and
standard deviation <code class="reqn">\sigma</code>.  <code class="reqn">h[t]</code> is the smoothing
parameter or &lsquo;bandwidth&rsquo; of the kernel density estimate, which may
or may not depend on the age <code class="reqn">t</code>. If <code class="reqn">h[t]</code> depends on
<code class="reqn">t</code>, then <code class="reqn">KDE(t)</code> is known as an &lsquo;adaptive&rsquo; KDE.  The
default bandwidth used by <code>IsoplotR</code> is calculated using the
algorithm of Botev et al. (2010) and modulated by the adaptive
smoothing approach of Abramson (1982).  The rationale behind
adaptive kernel density estimation is to use a narrower bandwidth
near the peaks of the sampling distribution (where the ordered
dates are closely spaced in time), and a wider bandwidth in the
distribution's sparsely sampled troughs. Thus, the resolution of
the density estimate is optimised according to data availability.
</p>


<h3>Value</h3>

<p>If <code>x</code> has class <code>UPb</code>, <code>PbPb</code>, <code>ArAr</code>,
<code>KCa</code>, <code>ReOs</code>, <code>SmNd</code>, <code>RbSr</code>,
<code>UThHe</code>, <code>fissiontracks</code> or <code>ThU</code>, returns an
object of class <code>KDE</code>, i.e. a list containing the
following items:
</p>

<dl>
<dt>x</dt><dd><p> horizontal plot coordinates</p>
</dd>
<dt>y</dt><dd><p> vertical plot coordinates</p>
</dd>
<dt>bw</dt><dd><p> the base bandwidth of the density estimate</p>
</dd>
<dt>ages</dt><dd><p> the data values from the input to
the <code>kde</code> function</p>
</dd>
<dt>log</dt><dd><p> copied from the input</p>
</dd>
<dt>modes</dt><dd><p>a two-column matrix with the <code>x</code> and <code>y</code>
values of the <code>nmodes</code> most prominent modes. Only returned
if <code>nmodes</code> is a positive integer or <code>'all'</code>.</p>
</dd>
</dl>

<p>or, if <code>x</code> has class <code>=detritals</code>, an object of class
<code>KDEs</code>, i.e. a list containing the following items:
</p>

<dl>
<dt>kdes</dt><dd><p>a named list with objects of class <code>KDE</code></p>
</dd>
<dt>from</dt><dd><p>the beginning of the common time scale</p>
</dd>
<dt>to</dt><dd><p>the end of the common time scale</p>
</dd>
<dt>themax</dt><dd><p>the maximum probability density of all the KDEs</p>
</dd>
<dt>xlabel</dt><dd><p>the x-axis label to be used by <code>plot.KDEs(...)</code></p>
</dd>
</dl>



<h3>References</h3>

<p>Abramson, I.S., 1982. On bandwidth variation in kernel estimates-a
square root law. The annals of Statistics, pp.1217-1223.
</p>
<p>Botev, Z. I., J. F. Grotowski, and
D. P. Kroese. &quot;Kernel density estimation via diffusion.&quot; The Annals
of Statistics 38.5 (2010): 2916-2957.
</p>
<p>Vermeesch, P., 2012. On the visualisation of detrital age
distributions. Chemical Geology, 312, pp.190-194.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+radialplot">radialplot</a></code>, <code><a href="#topic+cad">cad</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>kde(examples$UPb)

dev.new()
kde(examples$FT1,log=TRUE)

dev.new()
kde(examples$DZ,from=1,to=3000,kernel="epanechnikov")
</code></pre>

<hr>
<h2 id='ludwig'>Linear regression of U-Pb data with correlated errors, taking
into account decay constant uncertainties.</h2><span id='topic+ludwig'></span>

<h3>Description</h3>

<p>Implements the maximum likelihood algorithm for Total-Pb/U isochron
regression of Ludwig (1998) and extends the underlying methodology
to accommodate U-Th-Pb data and initial U-series disequilibrium.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ludwig(
  x,
  model = 1,
  anchor = 0,
  exterr = FALSE,
  type = "joint",
  plot = FALSE,
  ...
)

ludwig(
  x,
  model = 1,
  anchor = 0,
  exterr = FALSE,
  type = "joint",
  plot = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ludwig_+3A_x">x</code></td>
<td>
<p>an object of class <code>UPb</code></p>
</td></tr>
<tr><td><code id="ludwig_+3A_model">model</code></td>
<td>
<p>one of three regression models:
</p>
<p><code>1</code>: fit a discordia line through the data using the maximum
likelihood algorithm of Ludwig (1998), which assumes that the
scatter of the data is solely due to the analytical
uncertainties. In this case, <code>IsoplotR</code> will either calculate
an upper and lower intercept age (for Wetherill concordia), or a
lower intercept age and common
(<code class="reqn">^{207}</code>Pb/<code class="reqn">^{206}</code>Pb)<code class="reqn">_\circ</code>-ratio intercept (for
Tera-Wasserburg). If the p-value for the chi-square test is less
than <code>alpha()</code>, then the analytical uncertainties are augmented
by a factor <code class="reqn">\sqrt{MSWD}</code>.
</p>
<p><code>2</code>: fit a discordia line ignoring the analytical uncertainties
</p>
<p><code>3</code>: fit a discordia line using a modified maximum likelihood
algorithm that includes accounts for any overdispersion by adding a
geological (co)variance term.</p>
</td></tr>
<tr><td><code id="ludwig_+3A_anchor">anchor</code></td>
<td>
<p>control parameters to fix the intercept age or common Pb
composition of the isochron fit. This can be a scalar or a vector.
</p>
<p>If <code>anchor[1]=0</code>: do not anchor the isochron.
</p>
<p>If <code>anchor[1]=1</code>: fix the common Pb composition at the values
stored in <code>settings('iratio',...)</code>.
</p>
<p>If <code>anchor[1]=2</code>: force the isochron line to intersect the
concordia line at an age equal to <code>anchor[2]</code>.
</p>
<p>If <code>anchor[1]=3</code>: anchor the isochron line to the
Stacey-Kramers mantle evolution model.</p>
</td></tr>
<tr><td><code id="ludwig_+3A_exterr">exterr</code></td>
<td>
<p>propagate external sources of
uncertainty (i.e. decay constants)?</p>
</td></tr>
<tr><td><code id="ludwig_+3A_type">type</code></td>
<td>
<p>only relevant if <code>x$format&gt;3</code>. Can take on the following
values:
</p>
<p><code>'joint'</code> or <code>0</code>: 3-dimensional isochron regression.
</p>
<p><code>1</code>: 2-dimensional regression of
<code class="reqn">{}^{204}</code>Pb/<code class="reqn">{}^{206}</code>Pb vs.
<code class="reqn">{}^{238}</code>U/<code class="reqn">{}^{206}</code>Pb (for U-Pb formats 4, 5 and 6), or
of <code class="reqn">{}^{208}</code>Pb/<code class="reqn">{}^{206}</code>Pb vs.
<code class="reqn">{}^{238}</code>U/<code class="reqn">{}^{206}</code>Pb (for U-Pb formats 7 and 8).
</p>
<p><code>2</code>: 2-dimensional regression of
<code class="reqn">{}^{204}</code>Pb/<code class="reqn">{}^{207}</code>Pb vs.
<code class="reqn">{}^{235}</code>U/<code class="reqn">{}^{207}</code>Pb (for U-Pb formats 4, 5 and 6), or
of <code class="reqn">{}^{208}</code>Pb/<code class="reqn">{}^{207}</code>Pb vs.
<code class="reqn">{}^{235}</code>U/<code class="reqn">{}^{207}</code>Pb (for U-Pb formats 7 and 8).
</p>
<p><code>3</code>: 2-dimensional regression of
<code class="reqn">{}^{206}</code>Pb/<code class="reqn">{}^{208}</code>Pb vs.
<code class="reqn">{}^{232}</code>Th/<code class="reqn">{}^{208}</code>Pb (only for U-Pb formats 7 and 8).
</p>
<p><code>4</code>: 2-dimensional regression of
<code class="reqn">{}^{207}</code>Pb/<code class="reqn">{}^{208}</code>Pb vs.
<code class="reqn">{}^{232}</code>Th/<code class="reqn">{}^{208}</code>Pb (only for U-Pb formats 7 and 8).</p>
</td></tr>
<tr><td><code id="ludwig_+3A_plot">plot</code></td>
<td>
<p>logical. Only relevant for datasets with measured
disequilibrium. If <code>TRUE</code>, plots the posterior
distribution of the age and initial activity ratios.</p>
</td></tr>
<tr><td><code id="ludwig_+3A_...">...</code></td>
<td>
<p>optional arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The 3-dimensional regression algorithm of Ludwig and Titterington
(1994) was modified by Ludwig (1998) to fit so-called 'Total Pb-U
isochrons'. These are constrained to a radiogenic endmember
composition that falls on the <code><a href="#topic+concordia">concordia</a></code> line. In its
most sophisticated form, this algorithm does not only allow for
correlated errors between variables, but also between
aliquots. <code>IsoplotR</code> currently uses this algorithm to
propagate decay constant uncertainties in the total Pb-U isochron
ages.
</p>


<h3>Value</h3>


<dl>
<dt>par</dt><dd><p>a vector with the lower concordia intercept, the common
Pb ratios, the dispersion parameter (if <code>model=3</code>), and the
initial <code class="reqn">{}^{234}</code>U/<code class="reqn">{}^{238}</code>U and
<code class="reqn">{}^{230}</code>Th/<code class="reqn">{}^{238}</code>U activity ratio (in the presence of
initial disequilibrium).</p>
</dd>
<dt>cov</dt><dd><p>the covariance matrix of <code>par</code></p>
</dd>
<dt>df</dt><dd><p>the degrees of freedom of the model fit (<code class="reqn">n-2</code> if
<code>x$format&lt;4</code> or <code class="reqn">2n-3</code> if <code>x$format&gt;3</code>, where <code class="reqn">n</code>
is the number of aliquots).</p>
</dd>
<dt>mswd</dt><dd><p>the mean square of weighted deviates (a.k.a. reduced
Chi-square statistic) for the fit.</p>
</dd>
<dt>p.value</dt><dd><p>p-value of a Chi-square test for the linear fit</p>
</dd>
</dl>



<h3>References</h3>

<p>Ludwig, K.R., 1998. On the treatment of concordant uranium-lead
ages. Geochimica et Cosmochimica Acta, 62(4), pp.665-676.
</p>
<p>Ludwig, K.R. and Titterington, D.M., 1994. Calculation of
<code class="reqn">^{230}</code>Th/U isochrons, ages, and errors. Geochimica et
Cosmochimica Acta, 58(22), pp.5031-5042.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+concordia">concordia</a></code>, <code><a href="#topic+titterington">titterington</a></code>,
<code><a href="#topic+isochron">isochron</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>f &lt;- system.file("UPb4.csv",package="IsoplotR")
d &lt;- read.data(f,method="U-Pb",format=4)
fit &lt;- ludwig(d)

</code></pre>

<hr>
<h2 id='mclean'>Predict disequilibrium concordia compositions</h2><span id='topic+mclean'></span>

<h3>Description</h3>

<p>Returns the predicted <code class="reqn">{}^{206}</code>Pb/<code class="reqn">{}^{238}</code>U and
<code class="reqn">{}^{207}</code>Pb/<code class="reqn">{}^{235}</code>U ratios for any given time with or
without initial U-series disequilibrium.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mclean(tt = 0, d = diseq(), exterr = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mclean_+3A_tt">tt</code></td>
<td>
<p>the age of the sample</p>
</td></tr>
<tr><td><code id="mclean_+3A_d">d</code></td>
<td>
<p>an object of class <a href="#topic+diseq">diseq</a></p>
</td></tr>
<tr><td><code id="mclean_+3A_exterr">exterr</code></td>
<td>
<p>propagate the uncertainties associated with decay
constants and the <code class="reqn">{}^{238}</code>U/<code class="reqn">{}^{235}</code>U-ratio.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>U decays to Pb in 14 (for <code class="reqn">{}^{238}</code>U) or 11/12 (for
<code class="reqn">{}^{235}</code>U) steps. Conventional U-Pb geochronology assumes
that secular equilibrium between all the short lived intermediate
daughters was established at the time of isotopic closure. Under
this assumption, the relative abundances of those intermediate
daughters can be neglected and the age equation reduces to a simple
function of the measured Pb/U ratios. In reality, however, the
assumption of initial secular equilibrium is rarely met. Accounting
for disequilibrium requires a more complex set of age equations,
which are based on a coupled system of differetial equations. The
solution to this system of equations is given by a matrix
exponential. <code>IsoplotR</code> solves this matrix exponential for any
given time, using either the assumed initial activity ratios, or
(for young samples) the measured activity ratios of the longest
lived intermediate daughters. Based on a <code>Matlab</code> script by
Noah McLean.
</p>


<h3>Value</h3>

<p>a list containing the initial and present-day atomic
abundances of the <code class="reqn">{}^{238}</code>U-<code class="reqn">{}^{206}</code>Pb and
<code class="reqn">{}^{235}</code>U-<code class="reqn">{}^{207}</code>Pb decay chains; the
<code class="reqn">{}^{206}</code>Pb/<code class="reqn">{}^{238}</code>U,
<code class="reqn">{}^{207}</code>Pb/<code class="reqn">{}^{235}</code>U and
<code class="reqn">{}^{207}</code>Pb/<code class="reqn">{}^{206}</code>Pb ratios at time <code>tt</code>; the
derivatives of the <code class="reqn">{}^{206}</code>Pb/<code class="reqn">{}^{238}</code>U,
<code class="reqn">{}^{207}</code>Pb/<code class="reqn">{}^{235}</code>U and
<code class="reqn">{}^{207}</code>Pb/<code class="reqn">{}^{206}</code>Pb ratios with respect to time;
and the derivatives of the <code class="reqn">{}^{206}</code>Pb/<code class="reqn">{}^{238}</code>U,
<code class="reqn">{}^{207}</code>Pb/<code class="reqn">{}^{235}</code>U and
<code class="reqn">{}^{207}</code>Pb/<code class="reqn">{}^{206}</code>Pb ratios with respect to the
intermediate decay constants and
<code class="reqn">{}^{238}</code>U/<code class="reqn">{}^{235}</code>U-ratio.
</p>


<h3>Author(s)</h3>

<p>Noah McLean (algorithm) and Pieter Vermeesch (code)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+diseq">diseq</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d &lt;- diseq(U48=list(x=0,option=1),ThU=list(x=2,option=1),
           RaU=list(x=2,option=1),PaU=list(x=2,option=1))
mclean(tt=2,d=d)
</code></pre>

<hr>
<h2 id='mds'>Multidimensional Scaling</h2><span id='topic+mds'></span><span id='topic+mds.default'></span><span id='topic+mds.detritals'></span>

<h3>Description</h3>

<p>Performs classical or nonmetric Multidimensional
Scaling analysis
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mds(x, ...)

## Default S3 method:
mds(
  x,
  classical = FALSE,
  plot = TRUE,
  shepard = FALSE,
  nnlines = FALSE,
  pos = NULL,
  col = "black",
  bg = "white",
  xlab = NA,
  ylab = NA,
  asp = 1,
  ...
)

## S3 method for class 'detritals'
mds(
  x,
  method = "KS",
  classical = FALSE,
  plot = TRUE,
  shepard = FALSE,
  nnlines = FALSE,
  pos = NULL,
  col = "black",
  bg = "white",
  xlab = NA,
  ylab = NA,
  hide = NULL,
  asp = 1,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mds_+3A_x">x</code></td>
<td>
<p>a dissimilarity matrix OR an object of class
<code>detrital</code></p>
</td></tr>
<tr><td><code id="mds_+3A_...">...</code></td>
<td>
<p>optional arguments to the generic <code>plot</code> function</p>
</td></tr>
<tr><td><code id="mds_+3A_classical">classical</code></td>
<td>
<p>logical flag indicating whether classical
(<code>TRUE</code>) or nonmetric (<code>FALSE</code>) MDS should be used</p>
</td></tr>
<tr><td><code id="mds_+3A_plot">plot</code></td>
<td>
<p>show the MDS configuration (if <code>shepard=FALSE</code>) or
Shepard plot (if <code>shepard=TRUE</code>) on a graphical device</p>
</td></tr>
<tr><td><code id="mds_+3A_shepard">shepard</code></td>
<td>
<p>logical flag indicating whether the graphical output
should show the MDS configuration (<code>shepard=FALSE</code>) or a
Shepard plot with the 'stress' value. This argument is only
used if <code>plot=TRUE</code>.</p>
</td></tr>
<tr><td><code id="mds_+3A_nnlines">nnlines</code></td>
<td>
<p>if <code>TRUE</code>, draws nearest neighbour lines</p>
</td></tr>
<tr><td><code id="mds_+3A_pos">pos</code></td>
<td>
<p>a position specifier for the labels (if
<code>par('pch')!=NA</code>). Values of 1, 2, 3 and 4 indicate
positions below, to the left of, above and to the right of the
MDS coordinates, respectively.</p>
</td></tr>
<tr><td><code id="mds_+3A_col">col</code></td>
<td>
<p>plot colour (may be a vector)</p>
</td></tr>
<tr><td><code id="mds_+3A_bg">bg</code></td>
<td>
<p>background colour (may be a vector)</p>
</td></tr>
<tr><td><code id="mds_+3A_xlab">xlab</code></td>
<td>
<p>a string with the label of the x axis</p>
</td></tr>
<tr><td><code id="mds_+3A_ylab">ylab</code></td>
<td>
<p>a string with the label of the y axis</p>
</td></tr>
<tr><td><code id="mds_+3A_asp">asp</code></td>
<td>
<p>aspect ratio of the MDS configuration. See
<code>plot.window</code> for further details.</p>
</td></tr>
<tr><td><code id="mds_+3A_method">method</code></td>
<td>
<p>either <code>'KS'</code> (for the Kolmogorov-Smirnov
distance) or <code>'W2'</code> (for the Wasserstein-2 distance).</p>
</td></tr>
<tr><td><code id="mds_+3A_hide">hide</code></td>
<td>
<p>vector with indices of aliquots that should be removed
from the plot.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Multidimensional Scaling (MDS) is a dimension-reducting technique
that takes a matrix of pairwise &lsquo;dissimilarities&rsquo; between objects
(e.g., age distributions) as input and produces a configuration of
two (or higher-) dimensional coordinates as output, so that the
Euclidean distances between these coordinates approximate the
dissimilarities of the input matrix. Thus, an MDS-configuration
serves as a &lsquo;map&rsquo; in which similar samples cluster closely together
and dissimilar samples plot far apart. In the context of detrital
geochronology, the dissimilarity between samples is given by the
statistical distance between age distributions. There are many ways
to define this statistical distance. <code>IsoplotR</code> uses the
Kolmogorov-Smirnov (KS) statistic due to its simplicity and the
fact that it behaves like a true distance in the mathematical sense
of the word (Vermeesch, 2013). The KS-distance is given by the
maximum vertical distance between two <code><a href="#topic+cad">cad</a></code> step
functions. Thus, the KS-distance takes on values between zero
(perfect match between two age distributions) and one (no overlap
between two distributions).  Calculating the KS-distance between
samples two at a time populates a symmetric dissimilarity matrix
with positive values and a zero diagonal. <code>IsoplotR</code>
implements two algorithms to convert this matrix into a
configuration. The first (&lsquo;classical&rsquo;) approach uses a sequence of
basic matrix manipulations developed by Young and Householder
(1938) and Torgerson (1952) to achieve a linear fit between the
KS-distances and the fitted distances on the MDS configuration. The
second, more sophisticated (&lsquo;nonmetric&rsquo;) approach subjects the
input distances to a transformation <code class="reqn">f</code> prior to fitting a
configuration:
<br /><br />
<code class="reqn">\delta_{i,j} = f(KS_{i,j})</code>
<br /><br />
where <code class="reqn">KS_{i,j}</code> is the KS-distance between samples <code class="reqn">i</code> and
<code class="reqn">j</code> (for <code class="reqn">1 \leq i \neq j \leq n</code>) and <code class="reqn">\delta_{i,j}</code>
is the &lsquo;disparity&rsquo; (Kruskal, 1964).  Fitting an MDS
configuration then involves finding the disparity transformation
that maximises the goodness of fit (or minimises the &lsquo;stress&rsquo;)
between the disparities and the fitted distances. The latter two
quantities can also be plotted against each other as a 'Shepard
plot'.
</p>


<h3>Value</h3>

<p>Returns an object of class <code>MDS</code>, i.e. a list
containing the following items:
</p>

<dl>
<dt>points</dt><dd><p>a two-column vector of the fitted configuration</p>
</dd>
<dt>classical</dt><dd><p>a logical flag indicating whether the MDS
configuration was obtained by classical (<code>TRUE</code>) or
nonmetric (<code>FALSE</code>) MDS</p>
</dd>
<dt>diss</dt><dd><p>the dissimilarity matrix used for the MDS analysis</p>
</dd>
<dt>stress</dt><dd><p>(only if <code>classical=TRUE</code>) the final stress
achieved (in percent)</p>
</dd>
</dl>



<h3>References</h3>

<p>Kruskal, J., 1964. Multidimensional scaling by optimizing goodness
of fit to a nonmetric hypothesis. Psychometrika 29 (1), 1-27.
</p>
<p>Torgerson, W. S. Multidimensional scaling: I. Theory and
method. Psychometrika, 17(4): 401-419, 1952.
</p>
<p>Vermeesch, P., 2013. Multi-sample comparison of detrital age
distributions. Chemical Geology, 341, pp.140-146.
</p>
<p>Young, G. and Householder, A. S. Discussion of a set of points in
terms of their mutual distances. Psychometrika, 3(1):19-22, 1938.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cad">cad</a></code>, <code><a href="#topic+kde">kde</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>attach(examples)
mds(DZ,nnlines=TRUE,pch=21,cex=5)
dev.new()
mds(DZ,shepard=TRUE)
</code></pre>

<hr>
<h2 id='ogls'>Omnivariant Generalised Least-Squares Regression</h2><span id='topic+ogls'></span><span id='topic+ogls.default'></span><span id='topic+ogls.other'></span>

<h3>Description</h3>

<p>Linear regression with inter-sample error correlations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ogls(x, ...)

## Default S3 method:
ogls(x, random.effects = FALSE, ...)

## S3 method for class 'other'
ogls(x, random.effects = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ogls_+3A_x">x</code></td>
<td>
<p>either a <code>n x (n+1)</code> matrix obtained by prepending a
vector of alternating <code>X,Y</code>-values to its covariance
matrix OR an object of class <code>other</code> with
<code>x$format=6</code>.</p>
</td></tr>
<tr><td><code id="ogls_+3A_...">...</code></td>
<td>
<p>optional arguments</p>
</td></tr>
<tr><td><code id="ogls_+3A_random.effects">random.effects</code></td>
<td>
<p>logical. If <code>TRUE</code>, quantifies the
overdispersion associated with the y-intercept of the data.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of the slope and intercept of the best fit line as
well as their standard errors and covariance.
</p>


<h3>Author(s)</h3>

<p>Pieter Vermeesch and Mathieu Daëron
</p>


<h3>References</h3>

<p>Daëron, M., 2023. Making the Case for Reconciled
<code class="reqn">\Delta</code>47 Calibrations Using Omnivariant Generalized
Least-Squares Regression (No. EGU23-10066). Copernicus
Meetings.
</p>
<p>Daëron &amp; Vermeesch, in prep. Omnivariant Generalized Least Squares
Regression: Theory, Geochronological Applications, and Making the
Case for Reconciled <code class="reqn">\Delta</code>47 calibrations, Chemical Geology.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fn &lt;- system.file('UW137.csv',package='IsoplotR')
UW137 &lt;- read.data(fn,method='other',format=6)
fit &lt;- ogls(UW137)
</code></pre>

<hr>
<h2 id='Pb0corr'>Common Pb correction</h2><span id='topic+Pb0corr'></span>

<h3>Description</h3>

<p>Applies a common-Pb correction to a U-Pb dataset using either the
Stacey-Kramers mantle evolution model, isochron regression, or any
nominal inital Pb isotope composition.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Pb0corr(x, option = 3, omit4c = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Pb0corr_+3A_x">x</code></td>
<td>
<p>an object of class <code>UPb</code></p>
</td></tr>
<tr><td><code id="Pb0corr_+3A_option">option</code></td>
<td>
<p>one of either
</p>
<p><code>1</code>: nominal common Pb isotope composition
</p>
<p><code>2</code>: isochron regression
</p>
<p><code>3</code>: Stacey-Kramers correction</p>
</td></tr>
<tr><td><code id="Pb0corr_+3A_omit4c">omit4c</code></td>
<td>
<p>vector with indices of aliquots that should be
omitted from the isochron regression (only used if
<code>option=2</code>)</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>IsoplotR</code> implements nine different methods to correct for
the presence of non-radiogenic (&lsquo;common&rsquo;) lead. This includes three
strategies tailored to datasets that include <code class="reqn">^{204}</code>Pb
measurements, three strategies tailored to datasets that include
<code class="reqn">^{208}</code>Pb measurements, and a further three strategies for
datasets that only include <code class="reqn">^{206}</code>Pb and
<code class="reqn">^{207}</code>Pb.
</p>
<p><code class="reqn">^{204}</code>Pb is the only one of lead's four stable isotopes that
does not have a naturally occurring radioactive parent. This makes
it very useful for common-Pb correction:
</p>
<p><code class="reqn">\left[\frac{{}^{206|7}Pb}{{}^{204}Pb}\right]_r =
\left[\frac{{}^{206|7}Pb}{{}^{204}Pb}\right]_m -
\left[\frac{{}^{206|7}Pb}{{}^{204}Pb}\right]_\circ</code>
</p>
<p>where <code class="reqn">[{}^{206|7}Pb/^{204}Pb]_r</code> marks the radiogenic
<code class="reqn">{}^{206}</code>Pb or <code class="reqn">{}^{207}</code>Pb component;
<code class="reqn">[{}^{206|7}Pb/^{204}Pb]_m</code> is the measured ratio; and
<code class="reqn">[{}^{206|7}Pb/^{204}Pb]_\circ</code> is the non-radiogenic component.
</p>
<p><code>IsoplotR</code> offers three different ways to determine
<code class="reqn">[{}^{206|7}Pb/^{204}Pb]_\circ</code>. The first and easiest option
is to simply use a nominal value such as the
<code class="reqn">{}^{206|7}</code>Pb/<code class="reqn">^{204}</code>Pb-ratio of a cogenetic feldspar,
assuming that this is representative for the common-Pb composition
of the entire sample. A second method is to determine the
non-radiogenic isotope composition by fitting an isochron line
through multiple aliquots of the same sample, using the
3-dimensional regression algorithm of Ludwig (1998).
</p>
<p>Unfortunately, neither of these two methods is applicable to
detrital samples, which generally lack identifiable cogenetic
minerals and aliquots. For such samples, <code>IsoplotR</code> infers the
common-Pb composition from the two-stage crustal evolution model of
Stacey and Kramers (1975). The second stage of this model is
described by:
</p>
<p><code class="reqn">\left[\frac{{}^{206}Pb}{{}^{204}Pb}\right]_\circ =
\left[\frac{{}^{206}Pb}{{}^{204}Pb}\right]_{3.7Ga} +
\left[\frac{{}^{238}U}{{}^{204}Pb}\right]_{sk}
\left(e^{\lambda_{238}3.7Ga}-e^{\lambda_{238}t}\right)</code>
</p>
<p>where <code class="reqn">\left[{}^{206}Pb/{}^{204}Pb\right]_{3.7Ga} = 11.152</code> and
<code class="reqn">\left[{}^{238}U/{}^{204}Pb\right]_{sk} = 9.74</code>. These
Equations can be solved for <code class="reqn">t</code> and
<code class="reqn">\left[{}^{206}Pb/{}^{204}Pb\right]_\circ</code> using the method of
maximum likelihood. The <code class="reqn">{}^{207}</code>Pb/<code class="reqn">{}^{204}</code>Pb-ratio is
corrected in exactly the same way, using
<code class="reqn">\left[{}^{207}Pb/{}^{204}Pb\right]_{3.7Ga} = 12.998</code>.
</p>
<p>In the absence of <code class="reqn">^{204}</code>Pb measurements, a <code class="reqn">^{208}</code>Pb-based
common lead correction can be used:
</p>
<p><code class="reqn">\frac{{}^{206|7}Pb_r}{{}^{208}Pb_\circ} =
\frac{{}^{206|7}Pb_m}{{}^{208}Pb_\circ} -
\left[\frac{{}^{206|7}Pb}{{}^{208}Pb}\right]_\circ</code>
</p>
<p>where <code class="reqn">{}^{208}Pb_\circ</code> marks the non-radiogenic
<code class="reqn">{}^{208}Pb</code>-component, which is obtained by removing the
radiogenic component for any given age.
</p>
<p>If neither <code class="reqn">{}^{204}</code>Pb nor <code class="reqn">{}^{208}</code>Pb were measured,
then a <code class="reqn">^{207}</code> Pb-based common lead correction can be used:
</p>
<p><code class="reqn"> \left[\frac{{}^{207}Pb}{{}^{206}Pb}\right]_m = f
\left[\frac{{}^{207}Pb}{{}^{206}Pb}\right]_\circ + (1-f)
\left[\frac{{}^{207}Pb}{{}^{204}Pb}\right]_r</code>
</p>
<p>where <code class="reqn">f</code> is the fraction of common lead, and
<code class="reqn">[{}^{207}Pb/{}^{206}Pb]_r</code> is obtained by projecting the U-Pb
measurements on the concordia line in Tera-Wasserburg space.  Like
before, the initial lead composition
<code class="reqn">[{}^{207}Pb/{}^{206}Pb]_\circ</code> can be obtained in three
possible ways: by analysing a cogenetic mineral, by isochron
regression through multiple aliquots, or from the Stacey and
Kramers (1975) model.
</p>
<p>Besides the common-Pb problem, a second reason for U-Pb discordance
is radiogenic Pb-loss during igneous and metamorphic activity.
This moves the data away from the concordia line along a linear
array, forming an isochron or &lsquo;discordia&rsquo; line.  <code>IsoplotR</code>
fits this line using the Ludwig (1998) algorithm. If the data are
plotted on a Wetherill concordia diagram, the program will not only
report the usual lower intercept with the concordia line, but the
upper intercept as well. Both values are geologically meaningful as
they constrain both the initial igneous age as well as the timing
of the partial resetting event.
</p>


<h3>Value</h3>

<p>Returns a list in which <code>x.raw</code> contains the original data and
<code>x</code> the common Pb-corrected compositions. All other items in
the list are inherited from the input data.
</p>


<h3>References</h3>

<p>Ludwig, K.R., 1998. On the treatment of concordant uranium-lead
ages. Geochimica et Cosmochimica Acta, 62(4), pp.665-676.
</p>
<p>Stacey, J.T. and Kramers, 1., 1975. Approximation of terrestrial
lead isotope evolution by a two-stage model. Earth and Planetary
Science Letters, 26(2), pp.207-221.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>attach(examples)
corrected &lt;- Pb0corr(UPb,option=2)
concordia(corrected)
# produces identical results as:
dev.new()
concordia(UPb,common.Pb=2)
</code></pre>

<hr>
<h2 id='peakfit'>Finite mixture modelling of geochronological datasets</h2><span id='topic+peakfit'></span><span id='topic+peakfit.default'></span><span id='topic+peakfit.fissiontracks'></span><span id='topic+peakfit.UPb'></span><span id='topic+peakfit.PbPb'></span><span id='topic+peakfit.ArAr'></span><span id='topic+peakfit.ThPb'></span><span id='topic+peakfit.KCa'></span><span id='topic+peakfit.ReOs'></span><span id='topic+peakfit.SmNd'></span><span id='topic+peakfit.RbSr'></span><span id='topic+peakfit.LuHf'></span><span id='topic+peakfit.ThU'></span><span id='topic+peakfit.UThHe'></span>

<h3>Description</h3>

<p>Implements the discrete mixture modelling algorithms of Galbraith
and Laslett (1993) and applies them to fission track and other
geochronological datasets.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>peakfit(x, ...)

## Default S3 method:
peakfit(x, k = "auto", sigdig = 2, oerr = 3, log = TRUE, np = 3, ...)

## S3 method for class 'fissiontracks'
peakfit(
  x,
  k = 1,
  exterr = FALSE,
  sigdig = 2,
  log = TRUE,
  oerr = 3,
  np = 3,
  ...
)

## S3 method for class 'UPb'
peakfit(
  x,
  k = 1,
  type = 4,
  cutoff.76 = 1100,
  cutoff.disc = discfilter(),
  common.Pb = 0,
  exterr = FALSE,
  sigdig = 2,
  log = TRUE,
  oerr = 3,
  np = 3,
  ...
)

## S3 method for class 'PbPb'
peakfit(
  x,
  k = 1,
  exterr = FALSE,
  sigdig = 2,
  log = TRUE,
  common.Pb = 0,
  oerr = 3,
  np = 3,
  ...
)

## S3 method for class 'ArAr'
peakfit(
  x,
  k = 1,
  exterr = FALSE,
  sigdig = 2,
  log = TRUE,
  i2i = FALSE,
  oerr = 3,
  np = 3,
  ...
)

## S3 method for class 'ThPb'
peakfit(
  x,
  k = 1,
  exterr = FALSE,
  sigdig = 2,
  log = TRUE,
  i2i = FALSE,
  oerr = 3,
  np = 3,
  ...
)

## S3 method for class 'KCa'
peakfit(
  x,
  k = 1,
  exterr = FALSE,
  sigdig = 2,
  log = TRUE,
  i2i = FALSE,
  oerr = 3,
  np = 3,
  ...
)

## S3 method for class 'ReOs'
peakfit(
  x,
  k = 1,
  exterr = FALSE,
  sigdig = 2,
  log = TRUE,
  i2i = TRUE,
  oerr = 3,
  np = 3,
  ...
)

## S3 method for class 'SmNd'
peakfit(
  x,
  k = 1,
  exterr = FALSE,
  sigdig = 2,
  log = TRUE,
  i2i = TRUE,
  oerr = 3,
  np = 3,
  ...
)

## S3 method for class 'RbSr'
peakfit(
  x,
  k = 1,
  exterr = FALSE,
  sigdig = 2,
  log = TRUE,
  i2i = TRUE,
  oerr = 3,
  np = 3,
  ...
)

## S3 method for class 'LuHf'
peakfit(
  x,
  k = 1,
  exterr = FALSE,
  sigdig = 2,
  log = TRUE,
  i2i = TRUE,
  oerr = 3,
  np = 3,
  ...
)

## S3 method for class 'ThU'
peakfit(
  x,
  k = 1,
  exterr = FALSE,
  sigdig = 2,
  log = TRUE,
  oerr = 3,
  Th0i = 0,
  np = 3,
  ...
)

## S3 method for class 'UThHe'
peakfit(x, k = 1, sigdig = 2, log = TRUE, oerr = 3, np = 3, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="peakfit_+3A_x">x</code></td>
<td>
<p>either an <code>[nx2]</code> matrix with measurements and their
standard errors, or an object of class <code>fissiontracks</code>,
<code>UPb</code>, <code>PbPb</code>, <code>ThPb</code>, <code>ArAr</code>, <code>KCa</code>,
<code>ReOs</code>, <code>SmNd</code>, <code>RbSr</code>, <code>LuHf</code>, <code>ThU</code>
or <code>UThHe</code></p>
</td></tr>
<tr><td><code id="peakfit_+3A_...">...</code></td>
<td>
<p>optional arguments (not used)</p>
</td></tr>
<tr><td><code id="peakfit_+3A_k">k</code></td>
<td>
<p>the number of discrete age components to be
sought. Setting this parameter to <code>'auto'</code> automatically
selects the optimal number of components (up to a maximum of 5)
using the Bayes Information Criterion (BIC).</p>
</td></tr>
<tr><td><code id="peakfit_+3A_sigdig">sigdig</code></td>
<td>
<p>number of significant digits to be used for any
legend in which the peak fitting results are to be displayed.</p>
</td></tr>
<tr><td><code id="peakfit_+3A_oerr">oerr</code></td>
<td>
<p>indicates whether the analytical uncertainties of the
output are reported in the plot legend as:
</p>
<p><code>1</code>: 1<code class="reqn">\sigma</code> absolute uncertainties.
</p>
<p><code>2</code>: 2<code class="reqn">\sigma</code> absolute uncertainties.
</p>
<p><code>3</code>: absolute (1-<code class="reqn">\alpha</code>)% confidence intervals, where
<code class="reqn">\alpha</code> equales the value that is stored in
<code>settings('alpha')</code>.
</p>
<p><code>4</code>: 1<code class="reqn">\sigma</code> relative uncertainties (<code class="reqn">\%</code>).
</p>
<p><code>5</code>: 2<code class="reqn">\sigma</code> relative uncertainties (<code class="reqn">\%</code>).
</p>
<p><code>6</code>: relative (1-<code class="reqn">\alpha</code>)% confidence intervals, where
<code class="reqn">\alpha</code> equales the value that is stored in
<code>settings('alpha')</code>.</p>
</td></tr>
<tr><td><code id="peakfit_+3A_log">log</code></td>
<td>
<p>take the logs of the data before applying the mixture
model?</p>
</td></tr>
<tr><td><code id="peakfit_+3A_np">np</code></td>
<td>
<p>number of parameters for the minimum age model. Must be
either 3 or 4.</p>
</td></tr>
<tr><td><code id="peakfit_+3A_exterr">exterr</code></td>
<td>
<p>propagate the external sources of uncertainty into
the component age errors?</p>
</td></tr>
<tr><td><code id="peakfit_+3A_type">type</code></td>
<td>
<p>scalar indicating whether to plot the
<code class="reqn">^{207}</code>Pb/<code class="reqn">^{235}</code>U age (<code>type</code>=1), the
<code class="reqn">^{206}</code>Pb/<code class="reqn">^{238}</code>U age (<code>type</code>=2), the
<code class="reqn">^{207}</code>Pb/<code class="reqn">^{206}</code>Pb age (<code>type</code>=3), the
<code class="reqn">^{207}</code>Pb/<code class="reqn">^{206}</code>Pb-<code class="reqn">^{206}</code>Pb/<code class="reqn">^{238}</code>U age
(<code>type</code>=4), the concordia age (<code>type</code>=5), or the
<code class="reqn">^{208}</code>Pb/<code class="reqn">^{232}</code>Th age (<code>type</code>=6).</p>
</td></tr>
<tr><td><code id="peakfit_+3A_cutoff.76">cutoff.76</code></td>
<td>
<p>the age (in Ma) below which the
<code class="reqn">^{206}</code>Pb/<code class="reqn">^{238}</code>U and above which the
<code class="reqn">^{207}</code>Pb/<code class="reqn">^{206}</code>Pb age is used. This parameter is
only used if <code>type=4</code>.</p>
</td></tr>
<tr><td><code id="peakfit_+3A_cutoff.disc">cutoff.disc</code></td>
<td>
<p>discordance cutoff filter. This is an object of
class <code><a href="#topic+discfilter">discfilter</a></code>.</p>
</td></tr>
<tr><td><code id="peakfit_+3A_common.pb">common.Pb</code></td>
<td>
<p>common lead correction:
</p>
<p><code>0</code>:none
</p>
<p><code>1</code>: use the Pb-composition stored in
</p>
<p><code>settings('iratio','Pb206Pb204')</code> (if <code>x</code> has class
<code>UPb</code> and <code>x$format&lt;4</code>);
</p>
<p><code>settings('iratio','Pb206Pb204')</code> and
<code>settings('iratio','Pb207Pb204')</code> (if <code>x</code> has class
<code>PbPb</code> or <code>x</code> has class <code>UPb</code> and
<code>3&lt;x$format&lt;7</code>); or
</p>
<p><code>settings('iratio','Pb206Pb208')</code> and
<code>settings('iratio','Pb207Pb208')</code> (if <code>x</code> has class
<code>UPb</code> and <code>x$format=7</code> or <code>8</code>).
</p>
<p><code>2</code>: use the isochron intercept as the initial Pb-composition
</p>
<p><code>3</code>: use the Stacey-Kramers two-stage model to infer the
initial Pb-composition (only applicable if <code>x</code> has class
<code>UPb</code>)</p>
</td></tr>
<tr><td><code id="peakfit_+3A_i2i">i2i</code></td>
<td>
<p>&lsquo;isochron to intercept&rsquo;: calculates the initial (aka
&lsquo;inherited&rsquo;, &lsquo;excess&rsquo;, or &lsquo;common&rsquo;)
<code class="reqn">^{40}</code>Ar/<code class="reqn">^{36}</code>Ar, <code class="reqn">^{40}</code>Ca/<code class="reqn">^{44}</code>Ca,
<code class="reqn">^{207}</code>Pb/<code class="reqn">^{204}</code>Pb, <code class="reqn">^{87}</code>Sr/<code class="reqn">^{86}</code>Sr,
<code class="reqn">^{143}</code>Nd/<code class="reqn">^{144}</code>Nd, <code class="reqn">^{187}</code>Os/<code class="reqn">^{188}</code>Os,
<code class="reqn">^{230}</code>Th/<code class="reqn">^{232}</code>Th, <code class="reqn">^{176}</code>Hf/<code class="reqn">^{177}</code>Hf or
<code class="reqn">^{204}</code>Pb/<code class="reqn">^{208}</code>Pb ratio from an isochron
fit. Setting <code>i2i</code> to <code>FALSE</code> uses the default values
stored in <code>settings('iratio',...)</code>.</p>
</td></tr>
<tr><td><code id="peakfit_+3A_th0i">Th0i</code></td>
<td>
<p>initial <code class="reqn">^{230}</code>Th correction.
</p>
<p><code>0</code>: no correction
</p>
<p><code>1</code>: project the data along an isochron fit
</p>
<p><code>2</code>: if <code>x$format</code> is <code>1</code> or <code>2</code>, correct the
data using the measured present day <code class="reqn">^{230}</code>Th/<code class="reqn">^{238}</code>U,
<code class="reqn">^{232}</code>Th/<code class="reqn">^{238}</code>U and <code class="reqn">^{234}</code>U/<code class="reqn">^{238}</code>U
activity ratios in the detritus. If <code>x$format</code> is <code>3</code> or
<code>4</code>, correct the data using the measured
<code class="reqn">^{238}</code>U/<code class="reqn">^{232}</code>Th activity ratio of the whole rock, as
stored in <code>x</code> by the <code>read.data()</code> function.
</p>
<p><code>3</code>: correct the data using an assumed initial
<code class="reqn">^{230}</code>Th/<code class="reqn">^{232}</code>Th-ratio for the detritus (only relevant
if <code>x$format</code> is <code>1</code> or <code>2</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Consider a dataset of <code class="reqn">n</code> dates <code class="reqn">\{t_1, t_2, ..., t_n\}</code>
with analytical uncertainties <code class="reqn">\{s[t_1], s[t_2], ...,
s[t_n]\}</code>.  Define <code class="reqn">z_i = \log(t_i)</code> and <code class="reqn">s[z_i] =
s[t_i]/t_i</code>.  Suppose that these <code class="reqn">n</code> values are derived from a
mixture of <code class="reqn">k&gt;2</code> populations with means
<code class="reqn">\{\mu_1,...,\mu_k\}</code>. Such a <em>discrete mixture</em> may be
mathematically described by <code class="reqn">P(z_i|\mu,\omega) = \sum_{j=1}^k
\pi_j N(z_i | \mu_j, s[z_j]^2 )</code> where <code class="reqn">\pi_j</code> is the
proportion of the population that belongs to the <code class="reqn">j^{th}</code>
component, and <code class="reqn">\pi_k=1-\sum_{j=1}^{k-1}\pi_j</code>. This equation
can be solved by the method of maximum likelihood (Galbraith and
Laslett, 1993).  <code>IsoplotR</code> implements the Bayes Information
Criterion (BIC) as a means of automatically choosing <code class="reqn">k</code>. This
option should be used with caution, as the number of peaks steadily
rises with sample size (<code class="reqn">n</code>).  If one is mainly interested in
the youngest age component, then it is more productive to use an
alternative parameterisation, in which all grains are assumed to
come from one of two components, whereby the first component is a
single discrete age peak (<code class="reqn">\exp(m)</code>, say) and the second
component is a continuous distribution (as descibed by the
<code><a href="#topic+central">central</a></code> age model), but truncated at this discrete
value. <code>IsoplotR</code> uses a normal likelihood function
(section 6.11 of Galbraith, 2005) for the minimum age model.
This may result in some inaccuracy for young and/or uranium-poor
fission track samples.
</p>


<h3>Value</h3>

<p>Returns a list with the following items:
</p>

<dl>
<dt>peaks</dt><dd><p>a <code>2 x k</code> matrix with the following rows:
</p>
<p><code>t</code>: the ages of the <code>k</code> peaks
</p>
<p><code>s[t]</code>: the standard errors of <code>t</code>
</p>
</dd>
<dt>props</dt><dd><p>a <code>2 x k</code> matrix with the following rows:
</p>
<p><code>p</code>: the proportions of the <code>k</code> peaks
</p>
<p><code>s[p]</code>: the standard errors of <code>p</code>
</p>
</dd>
<dt>L</dt><dd><p>the log-likelihood of the fit</p>
</dd>
<dt>legend</dt><dd><p>a vector of text expressions to be used in a figure
legend</p>
</dd>
</dl>



<h3>References</h3>

<p>Galbraith, R.F. and Laslett, G.M., 1993. Statistical models for
mixed fission track ages. Nuclear Tracks and Radiation
Measurements, 21(4), pp.459-470.
</p>
<p>Galbraith, R.F. 2005, Statistics for fission track
analysis. Chapman and Hall/CRC, 229p.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+radialplot">radialplot</a></code>, <code><a href="#topic+central">central</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>attach(examples)
peakfit(FT1,k=2)

peakfit(LudwigMixture$x,k='min')
</code></pre>

<hr>
<h2 id='radialplot'>Visualise heteroscedastic data on a radial plot</h2><span id='topic+radialplot'></span><span id='topic+radialplot.default'></span><span id='topic+radialplot.other'></span><span id='topic+radialplot.fissiontracks'></span><span id='topic+radialplot.UPb'></span><span id='topic+radialplot.PbPb'></span><span id='topic+radialplot.ArAr'></span><span id='topic+radialplot.KCa'></span><span id='topic+radialplot.ThPb'></span><span id='topic+radialplot.UThHe'></span><span id='topic+radialplot.ReOs'></span><span id='topic+radialplot.SmNd'></span><span id='topic+radialplot.RbSr'></span><span id='topic+radialplot.LuHf'></span><span id='topic+radialplot.ThU'></span>

<h3>Description</h3>

<p>Implementation of a graphical device developed by Rex Galbraith to
display several estimates of the same quantity that have different
standard errors. Serves as a vehicle to display finite and continuous
mixture models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>radialplot(x, ...)

## Default S3 method:
radialplot(
  x,
  from = NA,
  to = NA,
  z0 = NA,
  transformation = "log",
  sigdig = 2,
  show.numbers = FALSE,
  pch = 21,
  levels = NA,
  clabel = "",
  bg = c("yellow", "red"),
  col = "black",
  k = 0,
  np = 3,
  markers = NULL,
  oerr = 3,
  units = "",
  hide = NA,
  omit = NULL,
  omit.col = NA,
  ...
)

## S3 method for class 'other'
radialplot(
  x,
  from = NA,
  to = NA,
  z0 = NA,
  transformation = "log",
  sigdig = 2,
  show.numbers = FALSE,
  pch = 21,
  levels = NA,
  clabel = "",
  bg = c("yellow", "red"),
  col = "black",
  k = 0,
  np = 3,
  markers = NULL,
  oerr = 3,
  units = "",
  hide = NA,
  omit = NULL,
  omit.col = NA,
  ...
)

## S3 method for class 'fissiontracks'
radialplot(
  x,
  from = NA,
  to = NA,
  z0 = NA,
  transformation = "arcsin",
  sigdig = 2,
  show.numbers = FALSE,
  pch = 21,
  levels = NA,
  clabel = "",
  bg = c("yellow", "red"),
  col = "black",
  markers = NULL,
  k = 0,
  np = 3,
  exterr = FALSE,
  oerr = 3,
  hide = NULL,
  omit = NULL,
  omit.col = NA,
  ...
)

## S3 method for class 'UPb'
radialplot(
  x,
  from = NA,
  to = NA,
  z0 = NA,
  transformation = "log",
  type = 4,
  cutoff.76 = 1100,
  cutoff.disc = discfilter(),
  show.numbers = FALSE,
  pch = 21,
  sigdig = 2,
  levels = NA,
  clabel = "",
  bg = c("yellow", "red"),
  col = "black",
  markers = NULL,
  k = 0,
  np = 3,
  exterr = FALSE,
  common.Pb = 0,
  oerr = 3,
  hide = NULL,
  omit = NULL,
  omit.col = NA,
  ...
)

## S3 method for class 'PbPb'
radialplot(
  x,
  from = NA,
  to = NA,
  z0 = NA,
  sigdig = 2,
  transformation = "log",
  show.numbers = FALSE,
  pch = 21,
  levels = NA,
  clabel = "",
  bg = c("yellow", "red"),
  col = "black",
  markers = NULL,
  k = 0,
  np = 3,
  exterr = FALSE,
  common.Pb = 2,
  oerr = 3,
  hide = NULL,
  omit = NULL,
  omit.col = NA,
  ...
)

## S3 method for class 'ArAr'
radialplot(
  x,
  from = NA,
  to = NA,
  z0 = NA,
  sigdig = 2,
  transformation = "log",
  show.numbers = FALSE,
  pch = 21,
  levels = NA,
  clabel = "",
  bg = c("yellow", "red"),
  col = "black",
  markers = NULL,
  k = 0,
  np = 3,
  exterr = FALSE,
  i2i = FALSE,
  oerr = 3,
  hide = NULL,
  omit = NULL,
  omit.col = NA,
  ...
)

## S3 method for class 'KCa'
radialplot(
  x,
  from = NA,
  to = NA,
  z0 = NA,
  sigdig = 2,
  transformation = "log",
  show.numbers = FALSE,
  pch = 21,
  levels = NA,
  clabel = "",
  bg = c("yellow", "red"),
  col = "black",
  markers = NULL,
  k = 0,
  np = 3,
  exterr = FALSE,
  i2i = FALSE,
  oerr = 3,
  hide = NULL,
  omit = NULL,
  omit.col = NA,
  ...
)

## S3 method for class 'ThPb'
radialplot(
  x,
  from = NA,
  to = NA,
  z0 = NA,
  sigdig = 2,
  transformation = "log",
  show.numbers = FALSE,
  pch = 21,
  levels = NA,
  clabel = "",
  bg = c("yellow", "red"),
  col = "black",
  markers = NULL,
  k = 0,
  np = 3,
  exterr = FALSE,
  i2i = TRUE,
  oerr = 3,
  hide = NULL,
  omit = NULL,
  omit.col = NA,
  ...
)

## S3 method for class 'UThHe'
radialplot(
  x,
  from = NA,
  to = NA,
  z0 = NA,
  sigdig = 2,
  transformation = "log",
  show.numbers = FALSE,
  pch = 21,
  levels = NA,
  clabel = "",
  bg = c("yellow", "red"),
  col = "black",
  markers = NULL,
  k = 0,
  np = 3,
  oerr = 3,
  hide = NULL,
  omit = NULL,
  omit.col = NA,
  ...
)

## S3 method for class 'ReOs'
radialplot(
  x,
  from = NA,
  to = NA,
  z0 = NA,
  sigdig = 2,
  transformation = "log",
  show.numbers = FALSE,
  pch = 21,
  levels = NA,
  clabel = "",
  bg = c("yellow", "red"),
  col = "black",
  markers = NULL,
  k = 0,
  np = 3,
  exterr = FALSE,
  i2i = TRUE,
  oerr = 3,
  hide = NULL,
  omit = NULL,
  omit.col = NA,
  ...
)

## S3 method for class 'SmNd'
radialplot(
  x,
  from = NA,
  to = NA,
  z0 = NA,
  sigdig = 2,
  transformation = "log",
  show.numbers = FALSE,
  pch = 21,
  levels = NA,
  clabel = "",
  bg = c("yellow", "red"),
  col = "black",
  markers = NULL,
  k = 0,
  np = 3,
  exterr = FALSE,
  i2i = TRUE,
  oerr = 3,
  hide = NULL,
  omit = NULL,
  omit.col = NA,
  ...
)

## S3 method for class 'RbSr'
radialplot(
  x,
  from = NA,
  to = NA,
  z0 = NA,
  sigdig = 2,
  transformation = "log",
  show.numbers = FALSE,
  pch = 21,
  levels = NA,
  clabel = "",
  bg = c("yellow", "red"),
  col = "black",
  markers = NULL,
  k = 0,
  np = 3,
  exterr = FALSE,
  i2i = TRUE,
  oerr = 3,
  hide = NULL,
  omit = NULL,
  omit.col = NA,
  ...
)

## S3 method for class 'LuHf'
radialplot(
  x,
  from = NA,
  to = NA,
  z0 = NA,
  sigdig = 2,
  transformation = "log",
  show.numbers = FALSE,
  pch = 21,
  levels = NA,
  clabel = "",
  bg = c("yellow", "red"),
  col = "black",
  markers = NULL,
  k = 0,
  np = 3,
  exterr = FALSE,
  i2i = TRUE,
  oerr = 3,
  hide = NULL,
  omit = NULL,
  omit.col = NA,
  ...
)

## S3 method for class 'ThU'
radialplot(
  x,
  from = NA,
  to = NA,
  z0 = NA,
  sigdig = 2,
  transformation = "log",
  show.numbers = FALSE,
  pch = 21,
  levels = NA,
  clabel = "",
  bg = c("yellow", "red"),
  col = "black",
  markers = NULL,
  k = 0,
  np = 3,
  Th0i = 0,
  oerr = 3,
  hide = NULL,
  omit = NULL,
  omit.col = NA,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="radialplot_+3A_x">x</code></td>
<td>
<p>Either an <code>[nx2]</code> matix of (transformed) values z
and their standard errors s
</p>
<p>OR
</p>
<p>and object of class <code>fissiontracks</code>, <code>UThHe</code>,
<code>ArAr</code>, <code>KCa</code>, <code>ReOs</code>, <code>SmNd</code>, <code>RbSr</code>,
<code>LuHf</code>, <code>ThU</code>, <code>PbPb</code>, <code>ThPb</code> or <code>UPb</code></p>
</td></tr>
<tr><td><code id="radialplot_+3A_...">...</code></td>
<td>
<p>additional arguments to the generic <code>points</code>
function</p>
</td></tr>
<tr><td><code id="radialplot_+3A_from">from</code></td>
<td>
<p>minimum age limit of the radial scale</p>
</td></tr>
<tr><td><code id="radialplot_+3A_to">to</code></td>
<td>
<p>maximum age limit of the radial scale</p>
</td></tr>
<tr><td><code id="radialplot_+3A_z0">z0</code></td>
<td>
<p>central value</p>
</td></tr>
<tr><td><code id="radialplot_+3A_transformation">transformation</code></td>
<td>
<p>one of either <code>log</code>, <code>linear</code>,
<code>sqrt</code> or <code>arcsin</code> (if <code>x</code> has class
<code>fissiontracks</code> and <code>fissiontracks$format</code> <code class="reqn">\neq
1</code>).</p>
</td></tr>
<tr><td><code id="radialplot_+3A_sigdig">sigdig</code></td>
<td>
<p>the number of significant digits of the numerical
values reported in the title of the graphical output.</p>
</td></tr>
<tr><td><code id="radialplot_+3A_show.numbers">show.numbers</code></td>
<td>
<p>boolean flag (<code>TRUE</code> to show grain
numbers)</p>
</td></tr>
<tr><td><code id="radialplot_+3A_pch">pch</code></td>
<td>
<p>plot character (default is a filled circle)</p>
</td></tr>
<tr><td><code id="radialplot_+3A_levels">levels</code></td>
<td>
<p>a vector with additional values to be displayed as
different background colours of the plot symbols.</p>
</td></tr>
<tr><td><code id="radialplot_+3A_clabel">clabel</code></td>
<td>
<p>label of the colour legend</p>
</td></tr>
<tr><td><code id="radialplot_+3A_bg">bg</code></td>
<td>
<p>Fill colour for the plot symbols. This can either be a
single colour or multiple colours to form a colour ramp (to be
used if <code>levels!=NA</code>):
</p>
<p>a single colour: <code>rgb(0,1,0,0.5)</code>, <code>'#FF000080'</code>,
<code>'white'</code>, etc.;
</p>
<p>multiple colours: <code>c(rbg(1,0,0,0.5)</code>,
<code>rgb(0,1,0,0.5))</code>, <code>c('#FF000080','#00FF0080')</code>,
<code>c('blue','red')</code>, <code>c('blue','yellow','red')</code>, etc.;
</p>
<p>a colour palette: <code>rainbow(n=100)</code>,
<code>topo.colors(n=100,alpha=0.5)</code>, etc.; or
</p>
<p>a reversed palette: <code>rev(topo.colors(n=100,alpha=0.5))</code>, etc.
</p>
<p>for plot symbols, set <code>bg=NA</code></p>
</td></tr>
<tr><td><code id="radialplot_+3A_col">col</code></td>
<td>
<p>text colour to be used if <code>show.numbers=TRUE</code></p>
</td></tr>
<tr><td><code id="radialplot_+3A_k">k</code></td>
<td>
<p>number of peaks to fit using the finite mixture models of
Galbraith and Laslett (1993). Setting <code>k='auto'</code>
automatically selects an optimal number of components based on
the Bayes Information Criterion (BIC). Setting <code>k='min'</code>
estimates the minimum value using a three parameter model
consisting of a Normal distribution truncated by a discrete
component.</p>
</td></tr>
<tr><td><code id="radialplot_+3A_np">np</code></td>
<td>
<p>number of parameters for the minimum age
model. Must be either 3 or 4.</p>
</td></tr>
<tr><td><code id="radialplot_+3A_markers">markers</code></td>
<td>
<p>vector of ages of radial marker lines to add to the
plot.</p>
</td></tr>
<tr><td><code id="radialplot_+3A_oerr">oerr</code></td>
<td>
<p>indicates whether the analytical uncertainties of the
output are reported in the plot title as:
</p>
<p><code>1</code>: 1<code class="reqn">\sigma</code> absolute uncertainties.
</p>
<p><code>2</code>: 2<code class="reqn">\sigma</code> absolute uncertainties.
</p>
<p><code>3</code>: absolute (1-<code class="reqn">\alpha</code>)% confidence intervals, where
<code class="reqn">\alpha</code> equales the value that is stored in
<code>settings('alpha')</code>.
</p>
<p><code>4</code>: 1<code class="reqn">\sigma</code> relative uncertainties (<code class="reqn">\%</code>).
</p>
<p><code>5</code>: 2<code class="reqn">\sigma</code> relative uncertainties (<code class="reqn">\%</code>).
</p>
<p><code>6</code>: relative (1-<code class="reqn">\alpha</code>)% confidence intervals, where
<code class="reqn">\alpha</code> equales the value that is stored in
<code>settings('alpha')</code>.</p>
</td></tr>
<tr><td><code id="radialplot_+3A_units">units</code></td>
<td>
<p>measurement units to be displayed in the legend.</p>
</td></tr>
<tr><td><code id="radialplot_+3A_hide">hide</code></td>
<td>
<p>vector with indices of aliquots that should be removed
from the radial plot.</p>
</td></tr>
<tr><td><code id="radialplot_+3A_omit">omit</code></td>
<td>
<p>vector with indices of aliquots that should be plotted
but omitted from the central age calculation or mixture models.</p>
</td></tr>
<tr><td><code id="radialplot_+3A_omit.col">omit.col</code></td>
<td>
<p>colour that should be used for the omitted
aliquots.</p>
</td></tr>
<tr><td><code id="radialplot_+3A_exterr">exterr</code></td>
<td>
<p>include the external sources of uncertainty into
the error propagation for the central age and mixture models?</p>
</td></tr>
<tr><td><code id="radialplot_+3A_type">type</code></td>
<td>
<p>scalar indicating whether to plot the
<code class="reqn">^{207}</code>Pb/<code class="reqn">^{235}</code>U age (<code>type</code>=1), the
<code class="reqn">^{206}</code>Pb/<code class="reqn">^{238}</code>U age (<code>type</code>=2), the
<code class="reqn">^{207}</code>Pb/<code class="reqn">^{206}</code>Pb age (<code>type</code>=3), the
<code class="reqn">^{207}</code>Pb/<code class="reqn">^{206}</code>Pb-<code class="reqn">^{206}</code>Pb/<code class="reqn">^{238}</code>U age
(<code>type</code>=4), the concordia age (<code>type</code>=5), or the
<code class="reqn">^{208}</code>Pb/<code class="reqn">^{232}</code>Th age (<code>type</code>=6).  Ignored if
<code>x$format&gt;8</code>.</p>
</td></tr>
<tr><td><code id="radialplot_+3A_cutoff.76">cutoff.76</code></td>
<td>
<p>the age (in Ma) below which the
<code class="reqn">^{206}</code>Pb/<code class="reqn">^{238}</code>U and above which the
<code class="reqn">^{207}</code>Pb/<code class="reqn">^{206}</code>Pb age is used. This parameter is
only used if <code>type=4</code>.</p>
</td></tr>
<tr><td><code id="radialplot_+3A_cutoff.disc">cutoff.disc</code></td>
<td>
<p>discordance cutoff filter. This is an object of
class <code><a href="#topic+discfilter">discfilter</a></code>.</p>
</td></tr>
<tr><td><code id="radialplot_+3A_common.pb">common.Pb</code></td>
<td>
<p>common lead correction:
</p>
<p><code>0</code>: none
</p>
<p><code>1</code>: use the Pb-composition stored in
</p>
<p><code>settings('iratio','Pb207Pb206')</code> (if <code>x</code> has class
<code>UPb</code> and <code>x$format&lt;4</code>);
</p>
<p><code>settings('iratio','Pb206Pb204')</code> and
<code>settings('iratio','Pb207Pb204')</code> (if <code>x</code> has class
<code>PbPb</code> or <code>x</code> has class <code>UPb</code> and
<code>3&lt;x$format&lt;7</code>); or
</p>
<p><code>settings('iratio','Pb206Pb208')</code> and
<code>settings('iratio','Pb207Pb208')</code> (if <code>x</code> has class
<code>UPb</code> and <code>x$format=7</code> or <code>8</code>).
</p>
<p><code>2</code>: remove the common Pb by projecting the data along an
inverse isochron. Note: choosing this option introduces a degree of
circularity in the central age calculation. In this case the radial
plot just serves as a way to visualise the residuals of the data
around the isochron, and one should be careful not to
over-interpret the numerical output.
</p>
<p><code>3</code>: use the Stacey-Kramers two-stage model to infer the
initial Pb-composition</p>
</td></tr>
<tr><td><code id="radialplot_+3A_i2i">i2i</code></td>
<td>
<p>&lsquo;isochron to intercept&rsquo;: calculates the initial
(aka &lsquo;inherited&rsquo;, &lsquo;excess&rsquo;, or &lsquo;common&rsquo;) <code class="reqn">^{40}</code>Ar/<code class="reqn">^{36}</code>Ar,
<code class="reqn">^{40}</code>Ca/<code class="reqn">^{44}</code>Ca, <code class="reqn">^{207}</code>Pb/<code class="reqn">^{204}</code>Pb,
<code class="reqn">^{87}</code>Sr/<code class="reqn">^{86}</code>Sr, <code class="reqn">^{143}</code>Nd/<code class="reqn">^{144}</code>Nd,
<code class="reqn">^{187}</code>Os/<code class="reqn">^{188}</code>Os, <code class="reqn">^{230}</code>Th/<code class="reqn">^{232}</code>Th,
<code class="reqn">^{176}</code>Hf/<code class="reqn">^{177}</code>Hf or <code class="reqn">^{204}</code>Pb/<code class="reqn">^{208}</code>Pb
ratio from an isochron fit. Setting <code>i2i</code> to <code>FALSE</code> uses
the default values stored in <code>settings('iratio',...)</code>.
</p>
<p>Note that choosing this option introduces a degree of circularity
in the central age calculation. In this case the radial plot plot
just serves as a way to visualise the residuals of the data around
the isochron, and one should be careful not to over-interpret the
numerical output.</p>
</td></tr>
<tr><td><code id="radialplot_+3A_th0i">Th0i</code></td>
<td>
<p>initial <code class="reqn">^{230}</code>Th correction.
</p>
<p><code>0</code>: no correction
</p>
<p><code>1</code>: project the data along an isochron fit
</p>
<p><code>2</code>: if <code>x$format</code> is <code>1</code> or <code>2</code>, correct the
data using the measured present day <code class="reqn">^{230}</code>Th/<code class="reqn">^{238}</code>U,
<code class="reqn">^{232}</code>Th/<code class="reqn">^{238}</code>U and <code class="reqn">^{234}</code>U/<code class="reqn">^{238}</code>U
activity ratios in the detritus. If <code>x$format</code> is <code>3</code> or
<code>4</code>, correct the data using the measured
<code class="reqn">^{238}</code>U/<code class="reqn">^{232}</code>Th activity ratio of the whole rock, as
stored in <code>x</code> by the <code>read.data()</code> function.
</p>
<p><code>3</code>: correct the data using an assumed initial
<code class="reqn">^{230}</code>Th/<code class="reqn">^{232}</code>Th-ratio for the detritus (only relevant
if <code>x$format</code> is <code>1</code> or <code>2</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The radial plot (Galbraith, 1988, 1990) is a graphical device that
was specifically designed to display heteroscedastic data, and is
constructed as follows.  Consider a set of dates
<code class="reqn">\{t_1,...,t_i,...,t_n\}</code> and uncertainties
<code class="reqn">\{s[t_1],...,s[t_i],...,s[t_n]\}</code>. Define <code class="reqn">z_i = z[t_i]</code>
to be a transformation of <code class="reqn">t_i</code> (e.g., <code class="reqn">z_i = log[t_i]</code>),
and let <code class="reqn">s[z_i]</code> be its propagated analytical uncertainty
(i.e., <code class="reqn">s[z_i] = s[t_i]/t_i</code> in the case of a logarithmic
transformation). Create a scatter plot of <code class="reqn">(x_i,y_i)</code> values,
where <code class="reqn">x_i = 1/s[z_i]</code> and <code class="reqn">y_i = (z_i-z_\circ)/s[z_i]</code>,
where <code class="reqn">z_\circ</code> is some reference value such as the mean. The
slope of a line connecting the origin of this scatter plot with any
of the <code class="reqn">(x_i,y_i)</code>s is proportional to <code class="reqn">z_i</code> and, hence,
the date <code class="reqn">t_i</code>.
</p>
<p>These dates can be more easily visualised by drawing a radial scale
at some convenient distance from the origin and annotating it with
labelled ticks at the appropriate angles. While the angular
position of each data point represents the date, its horizontal
distance from the origin is proportional to the
precision. Imprecise measurements plot on the left hand side of the
radial plot, whereas precise age determinations are found further
towards the right. Thus, radial plots allow the observer to assess
both the magnitude and the precision of quantitative data in one
glance.
</p>


<h3>Value</h3>

<p>does not produce any numerical output, but does report the
central age and the results of any mixture modelling in the
title. An asterisk is added to the plot title if the initial
daughter correction is based on an isochron regression, to
highlight the circularity of using an isochron to compute a
central age, and to indicate that the reported uncertainties do
not include the uncertainty of the initial daughter correction.
This is because this uncertainty is neither purely random nor
purely systematic.
</p>


<h3>References</h3>

<p>Galbraith, R.F., 1988. Graphical display of estimates
having differing standard errors. Technometrics, 30(3),
pp.271-281.
</p>
<p>Galbraith, R.F., 1990. The radial plot: graphical assessment of
spread in ages. International Journal of Radiation Applications and
Instrumentation. Part D. Nuclear Tracks and Radiation Measurements,
17(3), pp.207-214.
</p>
<p>Galbraith, R.F. and Laslett, G.M., 1993. Statistical models for
mixed fission track ages. Nuclear Tracks and Radiation
Measurements, 21(4), pp.459-470.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+peakfit">peakfit</a></code>, <code><a href="#topic+central">central</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>attach(examples)
radialplot(FT1)

dev.new()
radialplot(LudwigMixture,k='min')
</code></pre>

<hr>
<h2 id='read.data'>Read geochronological data</h2><span id='topic+read.data'></span><span id='topic+read.data.default'></span><span id='topic+read.data.data.frame'></span><span id='topic+read.data.matrix'></span>

<h3>Description</h3>

<p>Cast a <code>.csv</code> file or a matrix into one of <code>IsoplotR</code>'s
data classes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read.data(x, ...)

## Default S3 method:
read.data(
  x,
  method = "U-Pb",
  format = 1,
  ierr = 1,
  d = diseq(),
  Th02i = c(0, 0),
  Th02U48 = c(0, 0, 1e+06, 0, 0, 0, 0, 0, 0),
  U8Th2 = 0,
  ...
)

## S3 method for class 'data.frame'
read.data(
  x,
  method = "U-Pb",
  format = 1,
  ierr = 1,
  d = diseq(),
  Th02i = c(0, 0),
  Th02U48 = c(0, 0, 1e+06, 0, 0, 0, 0, 0, 0),
  U8Th2 = 0,
  ...
)

## S3 method for class 'matrix'
read.data(
  x,
  method = "U-Pb",
  format = 1,
  ierr = 1,
  d = diseq(),
  Th02i = c(0, 0),
  Th02U48 = c(0, 0, 1e+06, 0, 0, 0, 0, 0, 0),
  U8Th2 = 0,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read.data_+3A_x">x</code></td>
<td>
<p>either a file name (<code>.csv</code> format) OR a matrix</p>
</td></tr>
<tr><td><code id="read.data_+3A_...">...</code></td>
<td>
<p>optional arguments to the <code>read.csv</code> function</p>
</td></tr>
<tr><td><code id="read.data_+3A_method">method</code></td>
<td>
<p>one of <code>'U-Pb'</code>, <code>'Pb-Pb'</code>, <code>'Th-Pb'</code>,
<code>'Ar-Ar'</code>, <code>'K-Ca'</code>, <code>'detritals'</code>,
<code>'Rb-Sr'</code>, <code>'Sm-Nd'</code>, <code>'Re-Os'</code>, <code>'Th-U'</code>,
<code>'U-Th-He'</code>, <code>'fissiontracks'</code> or <code>'other'</code></p>
</td></tr>
<tr><td><code id="read.data_+3A_format">format</code></td>
<td>
<p>formatting option, depends on the value of
<code>method</code>.
</p>
<p>if <code>method='U-Pb'</code>, then <code>format</code> is one of either:
</p>

<ol>
<li><p><code>X=07/35, err[X],</code> <code>Y=06/38, err[Y], rho[X,Y]</code> 
</p>
</li>
<li><p><code>X=38/06, err[X],</code><code>Y=07/06, err[Y] (, rho[X,Y])</code>
</p>
</li>
<li><p><code>X=07/35, err[X],</code> <code>Y=06/38, err[Y],</code>
<code>Z=07/06, err[Z]</code> <code>(, rho[X,Y]) (, rho[Y,Z])</code> 
</p>
</li>
<li><p><code>X=07/35, err[X], Y=06/38, err[Y], Z=04/38, </code>
<code>rho[X,Y], rho[X,Z], rho[Y,Z]</code> 
</p>
</li>
<li><p><code>X=38/06, err[X]</code>, <code>Y=07/06, err[Y]</code>,
<code>Z=04/06, err[Z] (</code>, <code>rho[X,Y], rho[X,Z], rho[Y,Z])</code>
</p>
</li>
<li><p><code>07/35, err[07/35]</code>, <code>06/38, err[06/38]</code>,
<code>04/38, err[04/38]</code>, <code>07/06, err[07/06]</code>,
<code>04/07, err[04/07]</code>, <code>04/06, err[04/06]</code>
</p>
</li>
<li><p><code>W=07/35, err[W]</code>, <code>X=06/38, err[X]</code>,
<code>Y=08/32, err[Y]</code>, <code>Z=32/38, err[Z]</code>,
(<code>rho[W,X], rho[W,Y]</code>, <code>rho[W,Z], rho[X,Y]</code>,
<code>rho[X,Z], rho[Y,Z]</code>)
</p>
</li>
<li><p><code>W=38/06, err[W]</code>, <code>X=07/06, err[X]</code>,
<code>Y=08/06, err[Y]</code>, (<code>Z=32/38, err[Z]</code>,
<code>rho[W,X], rho[W,Y]</code>, <code>rho[W,Z], rho[X,Y]</code>,
<code>rho[X,Z], rho[Y,Z])</code>
</p>
</li>
<li><p><code>X=38/06, err[X]</code>, <code>Y=04/06, err[Y]</code>, (<code>rho[X,Y]</code>)
</p>
</li>
<li><p><code>X=35/07, err[X]</code>, <code>Y=04/07, err[Y]</code>, (<code>rho[X,Y]</code>)
</p>
</li>
<li><p><code>X=38/06, err[X]</code>, <code>Y=08/06, err[Y]</code>,
(<code>Z=32/38, err[Z]</code>, <code>rho[X,Y], rho[X,Z], rho[Y,Z]</code>)
</p>
</li>
<li><p><code>X=35/07, err[X]</code>, <code>Y=08/07, err[Y]</code>,
(<code>Z=32/38, err[Z]</code>, <code>rho[X,Y], rho[X,Z], rho[Y,Z]</code>)
</p>
</li></ol>

<p>where optional columns are marked in round brackets
</p>
<p>if <code>method='Pb-Pb'</code>, then <code>format</code> is one of either:
</p>

<ol>
<li><p><code>6/4, err[6/4], 7/4, err[7/4], rho</code>
</p>
</li>
<li><p><code>4/6, err[4/6], 7/6, err[7/6], rho</code>
</p>
</li>
<li><p><code>6/4, err[6/4], 7/4, err[7/4], 6/7, err[6/7]</code>
</p>
</li></ol>

<p>if <code>method='Th-Pb'</code>, then <code>format</code> is one of either:
</p>

<ol>
<li><p><code>32/04, err[32/04], 08/04, err[08/04], rho</code>
</p>
</li>
<li><p><code>32/08, err[32/08], 04/08, err[08/04], rho</code>
</p>
</li>
<li><p><code>32/04, err[32/04], 08/04, </code>
<code>err[08/04], 32/08, err[32/08]</code>
</p>
</li></ol>

<p>if <code>method='Ar-Ar'</code>, then <code>format</code> is one of either:
</p>

<ol>
<li><p><code>9/6, err[9/6], 0/6, err[0/6], rho (, 39)</code>
</p>
</li>
<li><p><code>6/0, err[6/0], 9/0, err[9/0] (, rho) (, 39)</code>
</p>
</li>
<li><p><code>9/0, err[9/0], 6/0, err[6/0], 9/6, err[9/6] (, 39)</code>
</p>
</li></ol>

<p>if <code>method='K-Ca'</code>, then <code>format</code> is one of either:
</p>

<ol>
<li><p><code>K40/Ca44, err[K40/Ca44], Ca40/Ca44, err[Ca40/Ca44], rho</code>
</p>
</li>
<li><p><code>K40/Ca40, err[K40/Ca40], Ca44/Ca40, err[Ca44/Ca40], rho</code>
</p>
</li>
<li><p><code>K40/Ca44, err[K40/Ca44], Ca40/Ca44, </code>
<code>err[Ca40/Ca44], K40/Ca40, err[K40/Ca40]</code>
</p>
</li></ol>

<p>if <code>method='Rb-Sr'</code>, then <code>format</code> is one of either:
</p>

<ol>
<li><p><code>Rb87/Sr86, err[Rb87/Sr86], Sr87/Sr86, err[Sr87/Sr86] (, rho)</code>
</p>
</li>
<li><p><code>Rb87/Sr87, err[Rb87/Sr87], Sr86/Sr87, err[Sr86/Sr87] (, rho)</code>
</p>
</li>
<li><p><code>Rb, err[Rb], Sr, err[Sr], Sr87/Sr86, err[Sr87/Sr86]</code>
</p>
</li></ol>

<p>where <code>Rb</code> and <code>Sr</code> are in ppm
</p>
<p>if <code>method='Sm-Nd'</code>, then <code>format</code> is one of either:
</p>

<ol>
<li><p><code>Sm147/Nd144, err[Sm147/Nd144], Nd143/Nd144, err[Nd143/Nd144] (, rho)</code>
</p>
</li>
<li><p><code>Sm147/Nd143, err[Sm147/Nd143], Nd144/Nd143, err[Nd144/Nd143] (, rho)</code>
</p>
</li>
<li><p><code>Sm, err[Sm], Nd, err[Nd], Nd143/Nd144, err[Nd143/Nd144]</code>
</p>
</li></ol>

<p>where <code>Sm</code> and <code>Nd</code> are in ppm
</p>
<p>if <code>method='Re-Os'</code>, then <code>format</code> is one of either:
</p>

<ol>
<li><p><code>Re187/Os188, err[Re187/Os188], Os187/Os188, err[Os187/Os188] (, rho)</code>
</p>
</li>
<li><p><code>Re187/Os187, err[Re187/Os187], Os188/Os187, err[Os188/Os187] (, rho)</code>
</p>
</li>
<li><p><code>Re, err[Re], Os, err[Os], Os187/Os188, err[Os187/Os188]</code>
</p>
</li></ol>

<p>where <code>Re</code> and <code>Os</code> are in ppm
</p>
<p>if <code>method='Lu-Hf'</code>, then <code>format</code> is one of either:
</p>

<ol>
<li><p><code>Lu176/Hf177, err[Lu176/Hf177], Hf176/Hf177, err[Hf176/Hf177] (, rho)</code>
</p>
</li>
<li><p><code>Lu176/Hf176, err[Lu176/Hf176], Hf177/Hf176, err[Hf177/Hf176] (, rho)</code>
</p>
</li>
<li><p><code>Lu, err[Lu], Hf, err[Hf], Hf176/Hf177, err[Hf176/Hf177]</code>
</p>
</li></ol>

<p>where <code>Lu</code> and <code>Hf</code> are in ppm
</p>
<p>if <code>method='Th-U'</code>, then <code>format</code> is one of either:
</p>

<ol>
<li><p><code>X=8/2, err[X], Y=4/2, err[Y], Z=0/2, err[Z],</code><br />
<code>rho[X,Y], rho[X,Z], rho[Y,Z]</code>
</p>
</li>
<li><p><code>X=2/8, err[X], Y=4/8, err[Y], Z=0/8, err[Z],</code><br />
<code> rho[X,Y], rho[X,Z], rho[Y,Z]</code>
</p>
</li>
<li><p><code>X=8/2, err[X], Y=0/2, err[Y], rho[X,Y]</code>
</p>
</li>
<li><p><code>X=2/8, err[X], Y=0/8, err[Y], rho[X,Y]</code>
</p>
</li></ol>

<p>where all values are activity ratios
</p>
<p>if <code>method='fissiontracks'</code>, then <code>format</code> is one of
either:
</p>

<ol>
<li><p>the External Detector Method (EDM), which requires a
<code class="reqn">\zeta</code>-calibration constant and its uncertainty, the induced
track density in a dosimeter glass, and a table with the
spontaneous and induced track densities.
</p>
</li>
<li><p>LA-ICP-MS-based fission track data using the
<code class="reqn">\zeta</code>-calibration method, which requires a 'session
<code class="reqn">\zeta</code>' and its uncertainty and a table with the number of
spontaneous tracks, the area over which these were counted and one
or more U/Ca- or U-concentration measurements and their analytical
uncertainties.
</p>
</li>
<li><p>LA-ICP-MS-based fission track data using the 'absolute
dating' method, which only requires a table with the the number of
spontaneous tracks, the area over which these were counted and one
or more U/Ca-ratios or U-concentration measurements (in ppm) and
their analytical uncertainties.  </p>
</li></ol>

<p>if <code>method='other'</code>, then <code>format</code> is one of either:
</p>

<dl>
<dt><code>1</code>:</dt><dd><p><code>X</code></p>
</dd>
<dt><code>2</code>:</dt><dd><p><code>X, err[X]</code></p>
</dd>
<dt><code>3</code>:</dt><dd><p><code>f, X, err[X]</code></p>
</dd> 
<dt><code>4</code>:</dt><dd><p><code>X, err[X], Y, err[Y], rho</code></p>
</dd>
<dt><code>5</code>:</dt><dd><p><code>X/Z, err[X/Z], Y/Z, err[Y/Z], X/Y, err[X/Y]</code></p>
</dd>
<dt><code>6</code>:</dt><dd><p>a <code>n x (n+1)</code> matrix obtained by prepending a
vector of alternating <code>X,Y</code>-values to its covariance matrix</p>
</dd>
</dl>
</td></tr>
<tr><td><code id="read.data_+3A_ierr">ierr</code></td>
<td>
<p>indicates whether the analytical uncertainties of the
input are provided as:
</p>
<p><code>1</code>: 1<code class="reqn">\sigma</code> absolute uncertainties.
</p>
<p><code>2</code>: 2<code class="reqn">\sigma</code> absolute uncertainties.
</p>
<p><code>3</code>: 1<code class="reqn">\sigma</code> relative uncertainties (<code class="reqn">\%</code>).
</p>
<p><code>4</code>: 2<code class="reqn">\sigma</code> relative uncertainties (<code class="reqn">\%</code>).</p>
</td></tr>
<tr><td><code id="read.data_+3A_d">d</code></td>
<td>
<p>an object of class <code><a href="#topic+diseq">diseq</a></code>.</p>
</td></tr>
<tr><td><code id="read.data_+3A_th02i">Th02i</code></td>
<td>
<p>2-element vector with the assumed initial
<code class="reqn">^{230}</code>Th/<code class="reqn">^{232}</code>Th-ratio of the detritus (for
Th-U formats 1 and 2) and its standard error.</p>
</td></tr>
<tr><td><code id="read.data_+3A_th02u48">Th02U48</code></td>
<td>
<p>9-element vector with the measured composition of
the detritus, containing <code>X=0/8</code>, <code>sX</code>, <code>Y=2/8</code>,
<code>sY</code>, <code>Z=4/8</code>, <code>sZ</code>, <code>rXY</code>, <code>rXZ</code>,
<code>rYZ</code>.</p>
</td></tr>
<tr><td><code id="read.data_+3A_u8th2">U8Th2</code></td>
<td>
<p><code class="reqn">^{238}</code>U/<code class="reqn">^{232}</code>Th activity-ratio of the
whole rock. Used to estimate the initial
<code class="reqn">^{230}</code>Th/<code class="reqn">^{238}</code>U disequilibrium (for Th-U formats 3
and 4).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>IsoplotR provides the following example input files:
</p>

<ul>
<li><p>U-Pb: <code>UPb1.csv</code>, <code>UPb2.csv</code>, <code>UPb3.csv</code>,
<code>UPb4.csv</code>, <code>UPb5.csv</code>, <code>UPb6.csv</code>,
<code>UPb7.csv</code>, <code>UPb8.csv</code>
</p>
</li>
<li><p>Pb-Pb: <code>PbPb1.csv</code>, <code>PbPb2.csv</code>, <code>PbPb3.csv</code>
</p>
</li>
<li><p>Th-Pb: <code>ThPb1.csv</code>, <code>ThPb2.csv</code>, <code>ThPb3.csv</code>
</p>
</li>
<li><p>Ar-Ar: <code>ArAr1.csv</code>, <code>ArAr2.csv</code>, <code>ArAr3.csv</code>
</p>
</li>
<li><p>K-Ca: <code>KCa1.csv</code>, <code>KCa2.csv</code>, <code>KCa3.csv</code>
</p>
</li>
<li><p>Re-Os: <code>ReOs1.csv</code>, <code>ReOs2.csv</code>, <code>ReOs3.csv</code>
</p>
</li>
<li><p>Sm-Nd: <code>SmNd1.csv</code>, <code>SmNd2.csv</code>, <code>SmNd3.csv</code>
</p>
</li>
<li><p>Rb-Sr: <code>RbSr1.csv</code>, <code>RbSr2.csv</code>, <code>RbSr3.csv</code>
</p>
</li>
<li><p>Lu-Hf: <code>LuHf1.csv</code>, <code>LuHf2.csv</code>, <code>LuHf3.csv</code>
</p>
</li>
<li><p>Th-U: <code>ThU1.csv</code>, <code>ThU2.csv</code>, <code>ThU3.csv</code>
<code>ThU4.csv</code>
</p>
</li>
<li><p>fissiontracks: <code>FT1.csv</code>, <code>FT2.csv</code>,
<code>FT3.csv</code>
</p>
</li>
<li><p>U-Th-He: <code>UThHe.csv</code>, <code>UThSmHe.csv</code>
</p>
</li>
<li><p>detritals: <code>DZ.csv</code>
</p>
</li>
<li><p>other: <code>LudwigMixture.csv</code>, <code>LudwigMean.csv</code>,
<code>LudwigKDE.csv</code>, <code>LudwigSpectrum.csv</code>
</p>
</li></ul>

<p>The contents of these files can be viewed using the
<code>system.file(...)</code> function. For example, to read the
<code>ArAr1.csv</code> file:
</p>
<p><code>fname &lt;- system.file('ArAr1.csv',package='IsoplotR')</code>
</p>
<p><code>ArAr &lt;- read.data(fname,method='Ar-Ar',format=1)</code>
</p>


<h3>Value</h3>

<p>An object of class <code>UPb</code>, <code>PbPb</code>, <code>ThPb</code>,
<code>KCa</code>, <code>RbSr</code>, <code>SmNd</code>, <code>LuHf</code>, <code>ReOs</code>,
<code>UThHe</code>, <code>fissiontracks</code>, <code>detritals</code> or
<code>PD</code>. See <code><a href="#topic+classes">classes</a></code> for further details.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+examples">examples</a></code>, <code><a href="#topic+settings">settings</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
f1 &lt;- system.file("UPb1.csv",package="IsoplotR")
file.show(f1) # inspect the contents of 'UPb1.csv'
d1 &lt;- read.data(f1,method="U-Pb",format=1)
concordia(d1)

f2 &lt;- system.file("ArAr1.csv",package="IsoplotR")
d2 &lt;- read.data(f2,method="Ar-Ar",format=1)
agespectrum(d2)

f3 &lt;- system.file("ReOs1.csv",package="IsoplotR")
d3 &lt;- read.data(f3,method="Re-Os",format=1)
isochron(d2)

f4 &lt;- system.file("FT1.csv",package="IsoplotR")
d4 &lt;- read.data(f4,method="fissiontracks",format=1)
radialplot(d4)

f5 &lt;- system.file("UThSmHe.csv",package="IsoplotR")
d5 &lt;- read.data(f5,method="U-Th-He")
helioplot(d5)

f6 &lt;- system.file("ThU2.csv",package="IsoplotR")
d6 &lt;- read.data(f6,method="Th-U",format=2)
evolution(d6)

#  one detrital zircon U-Pb file (detritals.csv)
f7 &lt;- system.file("DZ.csv",package="IsoplotR")
d7 &lt;- read.data(f7,method="detritals")
kde(d7)

#  four 'other' files (LudwigMixture.csv, LudwigSpectrum.csv,
#  LudwigMean.csv, LudwigKDE.csv)
f8 &lt;- system.file("LudwigMixture.csv",package="IsoplotR")
d8 &lt;- read.data(f8,method="other",format=2)
radialplot(d8)

</code></pre>

<hr>
<h2 id='scatterplot'>Create a scatter plot with error ellipses or crosses</h2><span id='topic+scatterplot'></span>

<h3>Description</h3>

<p>Takes bivariate data with (correlated) uncertainties as input and
produces a scatter plot with error ellipses or crosses as output.
(optionally) displays the linear fit on this diagram, and can show
a third variable as a colour scale.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scatterplot(
  xy,
  oerr = 3,
  show.numbers = FALSE,
  show.ellipses = 1,
  levels = NA,
  clabel = "",
  ellipse.fill = c("#00FF0080", "#FF000080"),
  ellipse.stroke = "black",
  fit = "none",
  add = FALSE,
  empty = FALSE,
  ci.col = "gray80",
  line.col = "black",
  lwd = 1,
  hide = NULL,
  omit = NULL,
  omit.fill = NA,
  omit.stroke = "grey",
  addcolourbar = TRUE,
  bg,
  cex,
  xlim = NULL,
  ylim = NULL,
  xlab,
  ylab,
  asp = NA,
  log = "",
  box = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="scatterplot_+3A_xy">xy</code></td>
<td>
<p>matrix with columns <code>X, sX, Y, sY(, rXY)</code></p>
</td></tr>
<tr><td><code id="scatterplot_+3A_oerr">oerr</code></td>
<td>
<p>indicates whether the analytical uncertainties of the
output are reported as:
</p>
<p><code>1</code>: 1<code class="reqn">\sigma</code> absolute uncertainties.
</p>
<p><code>2</code>: 2<code class="reqn">\sigma</code> absolute uncertainties.
</p>
<p><code>3</code>: absolute (1-<code class="reqn">\alpha</code>)% confidence intervals, where
<code class="reqn">\alpha</code> equales the value that is stored in
<code>settings('alpha')</code>.
</p>
<p><code>4</code>: 1<code class="reqn">\sigma</code> relative uncertainties (<code class="reqn">\%</code>).
</p>
<p><code>5</code>: 2<code class="reqn">\sigma</code> relative uncertainties (<code class="reqn">\%</code>).
</p>
<p><code>6</code>: relative (1-<code class="reqn">\alpha</code>)% confidence intervals, where
<code class="reqn">\alpha</code> equales the value that is stored in
<code>settings('alpha')</code>.</p>
</td></tr>
<tr><td><code id="scatterplot_+3A_show.numbers">show.numbers</code></td>
<td>
<p>logical flag (<code>TRUE</code> to show grain
numbers)</p>
</td></tr>
<tr><td><code id="scatterplot_+3A_show.ellipses">show.ellipses</code></td>
<td>
<p>show the data as:
</p>
<p><code>0</code>: points
</p>
<p><code>1</code>: error ellipses
</p>
<p><code>2</code>: error crosses</p>
</td></tr>
<tr><td><code id="scatterplot_+3A_levels">levels</code></td>
<td>
<p>a vector with additional values to be displayed as
different background colours within the error ellipses.</p>
</td></tr>
<tr><td><code id="scatterplot_+3A_clabel">clabel</code></td>
<td>
<p>label for the colour scale</p>
</td></tr>
<tr><td><code id="scatterplot_+3A_ellipse.fill">ellipse.fill</code></td>
<td>
<p>Fill colour for the error ellipses. This can either be a single
colour or multiple colours to form a colour ramp. Examples:
</p>
<p>a single colour: <code>rgb(0,1,0,0.5)</code>, <code>'#FF000080'</code>,
<code>'white'</code>, etc.;
</p>
<p>multiple colours: <code>c(rbg(1,0,0,0.5)</code>,
<code>rgb(0,1,0,0.5))</code>, <code>c('#FF000080','#00FF0080')</code>,
<code>c('blue','red')</code>, <code>c('blue','yellow','red')</code>, etc.;
</p>
<p>a colour palette: <code>rainbow(n=100)</code>,
<code>topo.colors(n=100,alpha=0.5)</code>, etc.; or
</p>
<p>a reversed palette: <code>rev(topo.colors(n=100,alpha=0.5))</code>,
etc.
</p>
<p>For empty ellipses, set <code>ellipse.col=NA</code></p>
</td></tr>
<tr><td><code id="scatterplot_+3A_ellipse.stroke">ellipse.stroke</code></td>
<td>
<p>the stroke colour for the error
ellipses. Follows the same formatting guidelines as
<code>ellipse.fill</code></p>
</td></tr>
<tr><td><code id="scatterplot_+3A_fit">fit</code></td>
<td>
<p>the output of <code>york()</code> (optional).</p>
</td></tr>
<tr><td><code id="scatterplot_+3A_add">add</code></td>
<td>
<p>if <code>TRUE</code>, adds the points and lines to the
existing plot.</p>
</td></tr>
<tr><td><code id="scatterplot_+3A_empty">empty</code></td>
<td>
<p>set up an empty plot with the right axis limits to fit
the data</p>
</td></tr>
<tr><td><code id="scatterplot_+3A_ci.col">ci.col</code></td>
<td>
<p>the fill colour for the confidence interval of the
intercept and slope.</p>
</td></tr>
<tr><td><code id="scatterplot_+3A_line.col">line.col</code></td>
<td>
<p>colour of the regression line</p>
</td></tr>
<tr><td><code id="scatterplot_+3A_lwd">lwd</code></td>
<td>
<p>line width of the regression line</p>
</td></tr>
<tr><td><code id="scatterplot_+3A_hide">hide</code></td>
<td>
<p>vector with indices of aliquots that should be removed
from the plot.</p>
</td></tr>
<tr><td><code id="scatterplot_+3A_omit">omit</code></td>
<td>
<p>vector with indices of aliquots that should be plotted
but omitted from the isochron age calculation.</p>
</td></tr>
<tr><td><code id="scatterplot_+3A_omit.fill">omit.fill</code></td>
<td>
<p>fill colour that should be used for the omitted
aliquots.</p>
</td></tr>
<tr><td><code id="scatterplot_+3A_omit.stroke">omit.stroke</code></td>
<td>
<p>stroke colour that should be used for the
omitted aliquots.</p>
</td></tr>
<tr><td><code id="scatterplot_+3A_addcolourbar">addcolourbar</code></td>
<td>
<p>add a colour bar to display the colours used to
<code>levels</code></p>
</td></tr>
<tr><td><code id="scatterplot_+3A_bg">bg</code></td>
<td>
<p>background colour for the plot symbols (only used if
<code>show.ellipses=0</code>).</p>
</td></tr>
<tr><td><code id="scatterplot_+3A_cex">cex</code></td>
<td>
<p>plot symbol magnification.</p>
</td></tr>
<tr><td><code id="scatterplot_+3A_xlim">xlim</code></td>
<td>
<p>(optional) two-element vector with the x-axis limits</p>
</td></tr>
<tr><td><code id="scatterplot_+3A_ylim">ylim</code></td>
<td>
<p>(optional) two-element vector with the y-axis limits</p>
</td></tr>
<tr><td><code id="scatterplot_+3A_xlab">xlab</code></td>
<td>
<p>(optional) x-axis label (only used when
<code>add=FALSE</code>)</p>
</td></tr>
<tr><td><code id="scatterplot_+3A_ylab">ylab</code></td>
<td>
<p>(optional) y-axis label (only used when
<code>add=FALSE</code>)</p>
</td></tr>
<tr><td><code id="scatterplot_+3A_asp">asp</code></td>
<td>
<p>the y/x aspect ratio, see &lsquo;plot.window&rsquo;.</p>
</td></tr>
<tr><td><code id="scatterplot_+3A_log">log</code></td>
<td>
<p>same as the eponymous argument to the generic
<code>plot</code> function.</p>
</td></tr>
<tr><td><code id="scatterplot_+3A_box">box</code></td>
<td>
<p>logical. If <code>TRUE</code>, draws a frame around the plot.</p>
</td></tr>
<tr><td><code id="scatterplot_+3A_...">...</code></td>
<td>
<p>optional arguments to format the points and text.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>X &lt;- c(1.550,12.395,20.445,20.435,20.610,24.900,
       28.530,50.540,51.595,86.51,106.40,157.35)
Y &lt;- c(.7268,.7809,.8200,.8116,.8160,.8302,
       .8642,.9534,.9617,1.105,1.230,1.440)
sX &lt;- X*0.02
sY &lt;- Y*0.01
dat &lt;- cbind(X,sX,Y,sY)
scatterplot(dat,fit=york(dat),show.ellipses=2)
</code></pre>

<hr>
<h2 id='set.zeta'>Calculate the zeta calibration coefficient for fission track dating</h2><span id='topic+set.zeta'></span>

<h3>Description</h3>

<p>Determines the zeta calibration constant of a fission track dataset
(EDM or LA-ICP-MS) given its true age and analytical uncertainty.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>set.zeta(x, tst, exterr = FALSE, oerr = 1, sigdig = NA, update = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="set.zeta_+3A_x">x</code></td>
<td>
<p>an object of class <code>fissiontracks</code></p>
</td></tr>
<tr><td><code id="set.zeta_+3A_tst">tst</code></td>
<td>
<p>a two-element vector with the true age and its standard
error</p>
</td></tr>
<tr><td><code id="set.zeta_+3A_exterr">exterr</code></td>
<td>
<p>logical flag indicating whether the external
uncertainties associated with the age standard or the dosimeter
glass (for the EDM) should be accounted for when propagating
the uncertainty of the zeta calibration constant.</p>
</td></tr>
<tr><td><code id="set.zeta_+3A_oerr">oerr</code></td>
<td>
<p>indicates whether the analytical uncertainties of the
output are reported as:
</p>
<p><code>1</code>: 1<code class="reqn">\sigma</code> absolute uncertainties.
</p>
<p><code>2</code>: 2<code class="reqn">\sigma</code> absolute uncertainties.
</p>
<p><code>3</code>: absolute (1-<code class="reqn">\alpha</code>)% confidence intervals, where
<code class="reqn">\alpha</code> equales the value that is stored in
<code>settings('alpha')</code>.
</p>
<p><code>4</code>: 1<code class="reqn">\sigma</code> relative uncertainties (<code class="reqn">\%</code>).
</p>
<p><code>5</code>: 2<code class="reqn">\sigma</code> relative uncertainties (<code class="reqn">\%</code>).
</p>
<p><code>6</code>: relative (1-<code class="reqn">\alpha</code>)% confidence intervals, where
<code class="reqn">\alpha</code> equales the value that is stored in
<code>settings('alpha')</code>.
</p>
<p>(only used when <code>update</code> is <code>FALSE</code>)</p>
</td></tr>
<tr><td><code id="set.zeta_+3A_sigdig">sigdig</code></td>
<td>
<p>the number of significant digits (only used when
<code>update</code> is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="set.zeta_+3A_update">update</code></td>
<td>
<p>logical flag indicating whether the function should
return an updated version of the input data, or simply return a
two-element vector with the calibration constant and its
standard error.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The fundamental fission track age is given by:
</p>
<p><code class="reqn">t = \frac{1}{\lambda_{238}}
\ln\left(1 + \frac{\lambda_{238}}{\lambda_f} \frac{2 N_s}{[^{238}U]A_sL}\right)
</code> (eq.1)
</p>
<p>where <code class="reqn">N_s</code> is the number of spontaneous fission tracks
measured over an area <code class="reqn">A_s</code>, <code class="reqn">[^{238}U]</code> is the
<code class="reqn">^{238}</code>U-concentration in atoms per unit volume,
<code class="reqn">\lambda_f</code> is the fission decay constant, <code class="reqn">L</code> is the
etchable fission track length, and the factor 2 is a geometric
factor accounting for the fact that etching reveals tracks from
both above and below the internal crystal surface.  Two analytical
approaches are used to measure <code class="reqn">[^{238}U]</code>: neutron activation
and LAICPMS. The first approach estimates the
<code class="reqn">^{238}</code>U-concentration indirectly, using the induced fission
of neutron-irradiated <code class="reqn">^{235}</code>U as a proxy for the
<code class="reqn">^{238}</code>U. In the most common implementation of this approach,
the induced fission tracks are recorded by an external detector
made of mica or plastic that is attached to the polished grain
surface (Fleischer and Hart, 1972; Hurford and Green, 1983). The
fission track age equation then becomes:
</p>
<p><code class="reqn">t = \frac{1}{\lambda_{238}}
\ln\left(1 + \frac{\lambda_{238}\zeta\rho_d}{2}\frac{N_s}{N_i}\right)
</code> (eq.2)
</p>
<p>where <code class="reqn">N_i</code> is the number of induced fission tracks counted in
the external detector over the same area as the spontaneous tracks,
<code class="reqn">\zeta</code> is a &lsquo;zeta&rsquo;-calibration factor that incorporates both
the fission decay constant and the etchable fission track length,
and <code class="reqn">\rho_d</code> is the number of induced fission tracks per unit
area counted in a co-irradiated glass of known
U-concentration. <code class="reqn">\rho_d</code> allows the <code class="reqn">\zeta</code>-factor to be
&lsquo;recycled&rsquo; between irradiations.
</p>
<p>LAICPMS is an alternative means of determining the
<code class="reqn">^{238}</code>U-content of fission track samples without the need for
neutron irradiation. The resulting U-concentrations can be plugged
directly into the fundamental age equation (eq.1). but this is
limited by the accuracy of the U-concentration measurements, the
fission track decay constant and the etching and counting
efficiencies. Alternatively, these sources of bias may be removed
by normalising to a standard of known fission track age and
defining a new &lsquo;zeta&rsquo; calibration constant <code class="reqn">\zeta_{icp}</code>:
</p>
<p><code class="reqn">
t = \frac{1}{\lambda_{238}}
\ln\left( 1 + \frac{\lambda_{238}\zeta_{icp}}{2} \frac{N_s}{[{}^{238}U] A_s} \right)
</code>(eq.3)
</p>
<p>where <code class="reqn">[{}^{238}U]</code> may either stand for the
<code class="reqn">^{238}</code>U-concentration (in ppm) <em>or</em> for the U/Ca (for
apatite) or U/Si (for zircon) ratio measurement (Vermeesch, 2017).
</p>


<h3>Value</h3>

<p>an object of class <code>fissiontracks</code> with an updated
<code>x$zeta</code> value or (if <code>update</code> is <code>FALSE</code>), a
2-element matrix with the zeta estimate and its uncertainty.
</p>


<h3>References</h3>

<p>Fleischer, R. and Hart, H. Fission track dating: techniques and
problems. In Bishop, W., Miller, J., and Cole, S., editors,
Calibration of Hominoid Evolution, pages 135-170. Scottish Academic
Press Edinburgh, 1972.
</p>
<p>Hurford, A. J. and Green, P. F. The zeta age calibration of
fission-track dating. Chemical Geology, 41:285-317, 1983.
</p>
<p>Vermeesch, P., 2017. Statistics for LA-ICP-MS based fission track
dating. Chemical Geology, 456, pp.19-27.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+age">age</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>attach(examples)
print(FT1$zeta)
FT &lt;- set.zeta(FT1,tst=c(250,5))
print(FT$zeta)

</code></pre>

<hr>
<h2 id='settings'>Retrieve and record global settings</h2><span id='topic+settings'></span>

<h3>Description</h3>

<p>Get and set preferred values for decay constants, isotopic
abundances, molar masses, fission track etch efficiences, and
etchable lengths, and mineral densities, either individually or via
a <code>.json</code> file format.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>settings(setting = NA, ..., fname = NA, reset = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="settings_+3A_setting">setting</code></td>
<td>
<p>unless <code>fname</code> is provided, this should be one
of either:
</p>
<p><code>'lambda'</code>: to get and set decay constants
</p>
<p><code>'iratio'</code>: isotopic ratios
</p>
<p><code>'imass'</code>: isotopic molar masses
</p>
<p><code>'mindens'</code>: mineral densities
</p>
<p><code>'etchfact'</code>: fission track etch efficiency factors
</p>
<p><code>'tracklength'</code>: equivalent isotropic fission track length
</p>
<p><code>'alpha'</code>: the significance level of confidence intervals</p>
</td></tr>
<tr><td><code id="settings_+3A_...">...</code></td>
<td>
<p>depends on the value for <code>setting</code>:
</p>
<p>For <code>'lambda'</code>: the isotope of interest (one of either
<code>"fission"</code>, <code>"U238"</code>, <code>"U235"</code>, <code>"U234"</code>,
<code>"Th232"</code>, <code>"Th230"</code>, <code>"Pa231"</code>, <code>"Ra226"</code>,
<code>"Re187"</code>, <code>"Sm147"</code>, <code>"Rb87"</code>, <code>"Lu176"</code>, or
<code>"K40"</code>) PLUS (optionally) the decay constant value and its
analytical error.  Omitting the latter two numbers simply returns
the existing values.
</p>
<p>For <code>'iratio'</code>: the isotopic ratio of interest (one of either
<code>"Ar40Ar36"</code>, <code>"Ar38Ar36"</code>, <code>"Ca40Ca44"</code>,
<code>"K39K41"</code>, <code>"K40K41"</code>, <code>"Rb85Rb87"</code>,
<code>"Sr88Sr86"</code>, <code>"Sr87Sr86"</code>, <code>"Sr84Sr86"</code>,
<code>"Re185Re187"</code>, <code>"Os184Os192"</code> <code>"Os186Os192"</code>,
<code>"Os187Os192"</code>, <code>"Os188Os192"</code>, <code>"Os189Os192"</code>,
<code>"Os190Os192"</code>, <code>"Sm144Sm152"</code>, <code>"Sm147Sm152"</code>,
<code>"Sm148Sm152"</code>, <code>"Sm149Sm152"</code>, <code>"Sm150Sm152"</code>,
<code>"Sm154Sm152"</code>, <code>"Nd142Nd144"</code>, <code>"Nd143Nd144"</code>,
<code>"Nd145Nd144"</code>, <code>"Nd146Nd144"</code>, <code>"Nd148Nd144"</code>,
<code>"Nd150Nd144"</code>, <code>"Lu176Lu175"</code>, <code>"Hf174Hf177"</code>,
<code>"Hf176Hf177"</code>, <code>"Hf178Hf177"</code>, <code>"Hf179Hf177"</code>,
<code>"Hf180Hf177"</code>, <code>"U238U235"</code>, <code>"Pb207Pb206"</code>,
<code>"Pb206Pb204"</code>, <code>"Pb207Pb204"</code>, <code>"Pb208Pb204"</code>,
<code>"Pb206Pb208"</code>, <code>"Pb207Pb208"</code>) PLUS (optionally) the
isotopic ratio and its analytical error.  Omitting the latter two
numbers simply returns the existing values.
</p>
<p>For <code>'imass'</code>: the (isotopic) molar mass of interest (one of
either <code>"U"</code>, <code>"Th"</code>, <code>"Rb"</code>, <code>"Rb85"</code>,
<code>"Rb87"</code>, <code>"Sr84"</code>, <code>"Sr86"</code>, <code>"Sr87"</code>,
<code>"Sr88"</code>, <code>"Re"</code>, <code>"Re185"</code>, <code>"Re187"</code>,
<code>"Os"</code>, <code>"Os184"</code>, <code>"Os186"</code>, <code>"Os187"</code>,
<code>"Os188"</code>, <code>"Os189"</code>, <code>"Os190"</code>, <code>"Os192"</code>,
<code>"Sm"</code>, <code>"Nd"</code>, <code>"Lu"</code>, <code>"Hf"</code>) PLUS
(optionally) the molar mass and its analytical error.  Omitting the
latter two numbers simply returns the existing values.
</p>
<p>For <code>'mindens'</code>: the mineral of interest (one of either
<code>"apatite"</code> or <code>"zircon"</code>) PLUS the mineral
density. Omitting the latter number simply returns the existing
value.
</p>
<p>For <code>'etchfact'</code>: the mineral of interest (one of either
<code>"apatite"</code> or <code>"zircon"</code>) PLUS the etch efficiency
factor. Omitting this number simply returns the existing value.
</p>
<p>For <code>'tracklength'</code>: the mineral of interest (one of either
<code>"apatite"</code> or <code>"zircon"</code>) PLUS the equivalent isotropic
fission track length. Omitting this number simply returns the
existing value.</p>
</td></tr>
<tr><td><code id="settings_+3A_fname">fname</code></td>
<td>
<p>the path of a <code>.json</code> file</p>
</td></tr>
<tr><td><code id="settings_+3A_reset">reset</code></td>
<td>
<p>logical. If <code>TRUE</code>, restores the default values</p>
</td></tr>
</table>


<h3>Value</h3>

<p>if <code>setting=NA</code> and <code>fname=NA</code>, returns a
<code>.json</code> string
</p>
<p>if <code>...</code> contains only the name of an isotope, isotopic ratio,
element, or mineral and no new value, then <code>settings</code> returns
either a scalar with the existing value, or a two-element vector
with the value and its uncertainty.
</p>


<h3>References</h3>


<ol>
<li><p> Decay constants:
</p>

<ul>
<li> <p><code class="reqn">^{238}</code>U, <code class="reqn">^{235}</code>U: Jaffey, A. H., et
al. &quot;Precision measurement of half-lives and specific
activities of U<code class="reqn">^{235}</code> and U<code class="reqn">^{238}</code>.&quot;
Physical Review C 4.5 (1971): 1889.
</p>
</li>
<li> <p><code class="reqn">^{232}</code>Th: Le Roux, L. J., and
L. E. Glendenin. &quot;Half-life of <code class="reqn">^{232}</code>Th.&quot;, Proceedings of the
National Meeting on Nuclear Energy, Pretoria, South Africa. 1963.
</p>
</li>
<li> <p><code class="reqn">^{234}</code>U, <code class="reqn">^{230}</code>Th: Cheng, H., Edwards, R.L.,
Shen, C.C., Polyak, V.J., Asmerom, Y., Woodhead, J., Hellstrom, J.,
Wang, Y., Kong, X., Spotl, C. and Wang, X., 2013. Improvements in
<code class="reqn">^{230}</code>Th dating, <code class="reqn">^{230}</code>Th and <code class="reqn">^{234}</code>U half-life
values, and U-Th isotopic measurements by multi-collector
inductively coupled plasma mass spectrometry. Earth and Planetary
Science Letters, 371, pp.82-91.
</p>
</li>
<li> <p><code class="reqn">^{231}</code>Pa, <code class="reqn">^{226}</code>Ra: Audi, G., Bersillon, O.,
Blachot, J. and Wapstra, A.H., 2003. The NUBASE evaluation of
nuclear and decay properties. Nuclear Physics A, 729(1), pp.3-128.
</p>
</li>
<li><p> Sm: Villa, I.M., Holden, N.E., Possolo, A., Ickert, R.B.,
Hibbert, D.B. and Renne, P.R., 2020. IUPAC-IUGS recommendation on
the half-lives of <code class="reqn">^{147}</code>Sm and <code class="reqn">^{146}</code>Sm. Geochimica et
Cosmochimica Acta, 285, pp.70-77.
</p>
</li>
<li><p> Nd: Zhao, Motian, et
al. &quot;Absolute measurements of neodymium isotopic abundances and atomic
weight by MC-ICPMS.&quot; International Journal of Mass Spectrometry 245.1
(2005): 36-40.
</p>
</li>
<li><p> Re: Smoliar, Michael I., Richard J. Walker, and John
W. Morgan. &quot;Re-Os ages of group IIA, IIIA, IVA, and IVB iron meteorites.&quot;
Science 271.5252 (1996): 1099-1102.
</p>
</li>
<li><p> Ar: Renne, Paul R., et
al. &quot;Response to the comment by WH Schwarz et al. on &quot;Joint
determination of <code class="reqn">^{40}</code>K decay constants and
<code class="reqn">^{40}</code>Ar*/<code class="reqn">^{40}</code>K for the Fish Canyon sanidine standard,
and improved accuracy for <code class="reqn">^{40}</code>Ar/<code class="reqn">^{39}</code>Ar
geochronology&quot; by PR Renne et al.(2010).&quot; Geochimica et
Cosmochimica Acta 75.17 (2011): 5097-5100.
</p>
</li>
<li><p> Rb: Villa, I.M., De Bievre, P., Holden, N.E. and Renne, P.R., 2015.
&quot;IUPAC-IUGS recommendation on the half life of <code class="reqn">^{87}</code>Rb&quot;.
Geochimica et Cosmochimica Acta, 164, pp.382-385.
</p>
</li>
<li><p> Lu: Soederlund, Ulf, et al. &quot;The <code class="reqn">^{176}</code>Lu decay constant
determined by Lu-Hf and U-Pb isotope systematics of Precambrian mafic
intrusions.&quot; Earth and Planetary Science Letters 219.3 (2004): 311-324.
</p>
</li></ul>

</li>
<li><p> Isotopic ratios:
</p>

<ul>
<li><p> Ar: Lee, Jee-Yon, et
al. &quot;A redetermination of the isotopic abundances of atmospheric Ar.&quot;
Geochimica et Cosmochimica Acta 70.17 (2006): 4507-4512.
</p>
</li>
<li><p> K: Garner, E.L., et al.
&quot;Absolute isotopic abundance ratios and the atomic weight of a reference
sample of potassium&quot;. J. Res. Natl. Bur. Stand. A
79.6 (1975): 713-725.
</p>
</li>
<li><p> Ca: Moore, L.J. and Machlan, L.A., 1972. High-accuracy
determination of calcium in blood serum by isotope dilution mass
spectrometry. Analytical chemistry, 44(14), pp.2291-2296.
</p>
</li>
<li><p> Rb: Catanzaro, E. J., et al. &quot;Absolute isotopic abundance ratio and
atomic weight of terrestrial rubidium.&quot; J. Res. Natl. Bur. Stand. A 73
(1969): 511-516.
</p>
</li>
<li><p> Sr: Moore, L. J., et al. &quot;Absolute isotopic abundance ratios and atomic
weight of a reference sample of strontium.&quot; J. Res. Natl. Bur. Stand.
87.1 (1982): 1-8.
</p>
<p>and (for <code class="reqn">^{87}</code>Sr/<code class="reqn">^{86}</code>Sr):
</p>
<p>Compston, W., Berry, H., Vernon, M.J., Chappell, B.W. and Kaye,
M.J., 1971. Rubidium-strontium chronology and chemistry of lunar
material from the Ocean of Storms. In Lunar and Planetary Science
Conference Proceedings (Vol. 2, p. 1471).
</p>
</li>
<li><p> Sm: Chang, Tsing-Lien, et al. &quot;Absolute isotopic composition and atomic
weight of samarium.&quot; International Journal of Mass Spectrometry 218.2
(2002): 167-172.
</p>
</li>
<li><p> Re: Gramlich, John W., et al. &quot;Absolute isotopic abundance ratio and
atomic weight of a reference sample of rhenium.&quot; J. Res. Natl. Bur.
Stand. A 77 (1973): 691-698.
</p>
</li>
<li><p> Os: Voelkening, Joachim, Thomas Walczyk, and Klaus G. Heumann.
&quot;Osmium isotope ratio determinations by negative thermal ionization
mass spectrometry.&quot; Int. J. Mass Spect. Ion Proc. 105.2 (1991): 147-159.
</p>
</li>
<li><p> Lu: De Laeter, J. R., and N. Bukilic.
&quot;Solar abundance of <code class="reqn">^{176}</code>Lu and s-process nucleosynthesis.&quot;
Physical Review C 73.4 (2006): 045806.
</p>
</li>
<li><p> Hf: Patchett, P. Jonathan.
&quot;Importance of the Lu-Hf isotopic system in studies of planetary
chronology and chemical evolution.&quot; Geochimica et Cosmochimica
Acta 47.1 (1983): 81-91.
</p>
</li>
<li><p> Pb: Stacey, J.T. and Kramers,
J. &quot;Approximation of terrestrial lead isotope evolution by a two-stage model.&quot;
Earth and Planetary Science Letters, 26(2) (1975): 207-221.
</p>
</li>
<li><p> U: Hiess, Joe, et
al. &quot;<code class="reqn">^{238}</code>U/<code class="reqn">^{235}</code>U systematics in terrestrial uranium-bearing minerals.&quot;
Science 335.6076 (2012): 1610-1614.
</p>
</li></ul>

</li></ol>



<h3>See Also</h3>

<p><code><a href="#topic+read.data">read.data</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load and show the default constants that come with IsoplotR
json &lt;- system.file("constants.json",package="IsoplotR")
settings(fname=json)
print(settings())

# use the decay constant of Kovarik and Adams (1932)
settings('lambda','U238',0.0001537,0.0000068)
print(settings('lambda','U238'))

# returns the 238U/235U ratio of Hiess et al. (2012):
print(settings('iratio','U238U235'))
# use the 238U/235U ratio of Steiger and Jaeger (1977):
settings('iratio','U238U235',138.88,0)
print(settings('iratio','U238U235'))
</code></pre>

<hr>
<h2 id='titterington'>Linear regression of X,Y,Z-variables with correlated errors</h2><span id='topic+titterington'></span>

<h3>Description</h3>

<p>Implements the maximum likelihood algorithm of Ludwig and
Titterington (1994) for linear regression of three dimensional data
with correlated uncertainties.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>titterington(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="titterington_+3A_x">x</code></td>
<td>
<p>an <code>[nx9]</code> matrix with the following columns:
<code>X, sX,</code> <code>Y, sY,</code> <code>Z, sZ</code>, <code>rXY,</code>
<code>rXZ,</code> <code>rYZ</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Ludwig and Titterington (1994)'s 3-dimensional linear regression
algorithm for data with correlated uncertainties is an extension of
the 2-dimensional algorithm by Titterington and Halliday (1979),
which itself is equivalent to the algorithm of York et al. (2004).
Given <code class="reqn">n</code> triplets of (approximately) collinear measurements
<code class="reqn">X_i</code>, <code class="reqn">Y_i</code> and <code class="reqn">Z_i</code> (for <code class="reqn">1 \leq i \leq n</code>),
their uncertainties <code class="reqn">s[X_i]</code>, <code class="reqn">s[Y_i]</code> and <code class="reqn">s[Z_i]</code>,
and their covariances cov[<code class="reqn">X_i,Y_i</code>], cov[<code class="reqn">X_i,Z_i</code>] and
cov[<code class="reqn">Y_i,Z_i</code>], the <code>titterington</code> function fits two
slopes and intercepts with their uncertainties. It computes the
MSWD as a measure of under/overdispersion.  Overdispersed datasets
(MSWD&gt;1) can be dealt with in the same three ways that are
described in the documentation of the <code><a href="#topic+isochron">isochron</a></code>
function.
</p>


<h3>Value</h3>

<p>A four-element list of vectors containing:
</p>

<dl>
<dt>par</dt><dd><p>4-element vector <code>c(a,b,A,B)</code> where <code>a</code> is
the intercept of the <code>X-Y</code> regression, <code>b</code>
is the slope of the <code>X-Y</code> regression, <code>A</code>
is the intercept of the <code>X-Z</code> regression, and
<code>B</code> is the slope of the <code>X-Z</code> regression.</p>
</dd>
<dt>cov</dt><dd><p><code>[4x4]</code>-element covariance matrix of <code>par</code></p>
</dd>
<dt>mswd</dt><dd><p>the mean square of the residuals (a.k.a 'reduced
Chi-square') statistic</p>
</dd>
<dt>p.value</dt><dd><p>p-value of a Chi-square test for linearity</p>
</dd>
<dt>df</dt><dd><p>the number of degrees of freedom for the
Chi-square test (2<code class="reqn">n</code>-4)</p>
</dd>
<dt>tfact</dt><dd><p>the <code class="reqn">100(1-\alpha/2)\%</code> percentile of the
t-distribution with <code class="reqn">(n-2k+1)</code> degrees of freedom</p>
</dd>
</dl>



<h3>References</h3>

<p>Ludwig, K.R. and Titterington, D.M., 1994. Calculation
of <code class="reqn">^{230}</code>Th/U isochrons, ages, and errors. Geochimica et
Cosmochimica Acta, 58(22), pp.5031-5042.
</p>
<p>Titterington, D.M. and Halliday, A.N., 1979. On the fitting of
parallel isochrons and the method of maximum likelihood. Chemical
Geology, 26(3), pp.183-195.
</p>
<p>York, D., Evensen, N.M., Martinez, M.L. and De Basebe Delgado, J., 2004.
Unified equations for the slope, intercept, and standard
errors of the best straight line. American Journal of Physics,
72(3), pp.367-375.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+york">york</a></code>, <code><a href="#topic+isochron">isochron</a></code>, <code><a href="#topic+ludwig">ludwig</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d &lt;- matrix(c(0.1677,0.0047,1.105,0.014,0.782,0.015,0.24,0.51,0.33,
              0.2820,0.0064,1.081,0.013,0.798,0.015,0.26,0.63,0.32,
              0.3699,0.0076,1.038,0.011,0.819,0.015,0.27,0.69,0.30,
              0.4473,0.0087,1.051,0.011,0.812,0.015,0.27,0.73,0.30,
              0.5065,0.0095,1.049,0.010,0.842,0.015,0.27,0.76,0.29,
              0.5520,0.0100,1.039,0.010,0.862,0.015,0.27,0.78,0.28),
            nrow=6,ncol=9)
colnames(d) &lt;- c('X','sX','Y','sY','Z','sZ','rXY','rXZ','rYZ')
titterington(d)
</code></pre>

<hr>
<h2 id='weightedmean'>Calculate the weighted mean age</h2><span id='topic+weightedmean'></span><span id='topic+weightedmean.default'></span><span id='topic+weightedmean.other'></span><span id='topic+weightedmean.UPb'></span><span id='topic+weightedmean.PbPb'></span><span id='topic+weightedmean.ThU'></span><span id='topic+weightedmean.ArAr'></span><span id='topic+weightedmean.KCa'></span><span id='topic+weightedmean.ThPb'></span><span id='topic+weightedmean.ReOs'></span><span id='topic+weightedmean.SmNd'></span><span id='topic+weightedmean.RbSr'></span><span id='topic+weightedmean.LuHf'></span><span id='topic+weightedmean.UThHe'></span><span id='topic+weightedmean.fissiontracks'></span>

<h3>Description</h3>

<p>Averages heteroscedastic data either using the ordinary weighted
mean, or using a random effects model with two sources of variance.
Computes the MSWD of a normal fit without
overdispersion. Implements a modified Chauvenet criterion to detect
and reject outliers. Only propagates the systematic uncertainty
associated with decay constants and calibration factors after
computing the weighted mean isotopic composition. Does not propagate
the uncertainty of any initial daughter correction, because this is
neither a purely random or purely systematic uncertainty.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>weightedmean(x, ...)

## Default S3 method:
weightedmean(
  x,
  from = NA,
  to = NA,
  random.effects = FALSE,
  detect.outliers = TRUE,
  plot = TRUE,
  levels = NA,
  clabel = "",
  rect.col = c("#00FF0080", "#FF000080"),
  outlier.col = "#00FFFF80",
  sigdig = 2,
  oerr = 3,
  ranked = FALSE,
  hide = NULL,
  omit = NULL,
  omit.col = NA,
  ...
)

## S3 method for class 'other'
weightedmean(
  x,
  from = NA,
  to = NA,
  random.effects = FALSE,
  detect.outliers = TRUE,
  plot = TRUE,
  levels = NA,
  clabel = "",
  rect.col = c("#00FF0080", "#FF000080"),
  outlier.col = "#00FFFF80",
  sigdig = 2,
  oerr = 3,
  ranked = FALSE,
  hide = NULL,
  omit = NULL,
  omit.col = NA,
  ...
)

## S3 method for class 'UPb'
weightedmean(
  x,
  random.effects = FALSE,
  detect.outliers = TRUE,
  plot = TRUE,
  from = NA,
  to = NA,
  levels = NA,
  clabel = "",
  rect.col = c("#00FF0080", "#FF000080"),
  outlier.col = "#00FFFF80",
  sigdig = 2,
  type = 4,
  cutoff.76 = 1100,
  oerr = 3,
  cutoff.disc = discfilter(),
  exterr = FALSE,
  ranked = FALSE,
  common.Pb = 0,
  hide = NULL,
  omit = NULL,
  omit.col = NA,
  ...
)

## S3 method for class 'PbPb'
weightedmean(
  x,
  random.effects = FALSE,
  detect.outliers = TRUE,
  plot = TRUE,
  from = NA,
  to = NA,
  levels = NA,
  clabel = "",
  rect.col = c("#00FF0080", "#FF000080"),
  outlier.col = "#00FFFF80",
  sigdig = 2,
  oerr = 3,
  exterr = FALSE,
  common.Pb = 2,
  ranked = FALSE,
  hide = NULL,
  omit = NULL,
  omit.col = NA,
  ...
)

## S3 method for class 'ThU'
weightedmean(
  x,
  random.effects = FALSE,
  detect.outliers = TRUE,
  plot = TRUE,
  from = NA,
  to = NA,
  levels = NA,
  clabel = "",
  rect.col = c("#00FF0080", "#FF000080"),
  outlier.col = "#00FFFF80",
  sigdig = 2,
  oerr = 3,
  ranked = FALSE,
  Th0i = 0,
  hide = NULL,
  omit = NULL,
  omit.col = NA,
  ...
)

## S3 method for class 'ArAr'
weightedmean(
  x,
  random.effects = FALSE,
  detect.outliers = TRUE,
  plot = TRUE,
  from = NA,
  to = NA,
  levels = NA,
  clabel = "",
  rect.col = c("#00FF0080", "#FF000080"),
  outlier.col = "#00FFFF80",
  sigdig = 2,
  oerr = 3,
  exterr = FALSE,
  ranked = FALSE,
  i2i = FALSE,
  hide = NULL,
  omit = NULL,
  omit.col = NA,
  ...
)

## S3 method for class 'KCa'
weightedmean(
  x,
  random.effects = FALSE,
  detect.outliers = TRUE,
  plot = TRUE,
  from = NA,
  to = NA,
  levels = NA,
  clabel = "",
  rect.col = c("#00FF0080", "#FF000080"),
  outlier.col = "#00FFFF80",
  sigdig = 2,
  oerr = 3,
  exterr = FALSE,
  ranked = FALSE,
  i2i = FALSE,
  hide = NULL,
  omit = NULL,
  omit.col = NA,
  ...
)

## S3 method for class 'ThPb'
weightedmean(
  x,
  random.effects = FALSE,
  detect.outliers = TRUE,
  plot = TRUE,
  from = NA,
  to = NA,
  levels = NA,
  clabel = "",
  rect.col = c("#00FF0080", "#FF000080"),
  outlier.col = "#00FFFF80",
  sigdig = 2,
  oerr = 3,
  exterr = FALSE,
  ranked = FALSE,
  i2i = TRUE,
  hide = NULL,
  omit = NULL,
  omit.col = NA,
  ...
)

## S3 method for class 'ReOs'
weightedmean(
  x,
  random.effects = FALSE,
  detect.outliers = TRUE,
  plot = TRUE,
  from = NA,
  to = NA,
  levels = NA,
  clabel = "",
  rect.col = c("#00FF0080", "#FF000080"),
  outlier.col = "#00FFFF80",
  sigdig = 2,
  oerr = 3,
  exterr = FALSE,
  ranked = FALSE,
  i2i = TRUE,
  hide = NULL,
  omit = NULL,
  omit.col = NA,
  ...
)

## S3 method for class 'SmNd'
weightedmean(
  x,
  random.effects = FALSE,
  detect.outliers = TRUE,
  plot = TRUE,
  from = NA,
  to = NA,
  levels = NA,
  clabel = "",
  rect.col = c("#00FF0080", "#FF000080"),
  outlier.col = "#00FFFF80",
  sigdig = 2,
  oerr = 3,
  exterr = FALSE,
  ranked = FALSE,
  i2i = TRUE,
  hide = NULL,
  omit = NULL,
  omit.col = NA,
  ...
)

## S3 method for class 'RbSr'
weightedmean(
  x,
  random.effects = FALSE,
  detect.outliers = TRUE,
  plot = TRUE,
  from = NA,
  to = NA,
  levels = NA,
  clabel = "",
  rect.col = c("#00FF0080", "#FF000080"),
  outlier.col = "#00FFFF80",
  sigdig = 2,
  oerr = 3,
  exterr = FALSE,
  i2i = TRUE,
  ranked = FALSE,
  hide = NULL,
  omit = NULL,
  omit.col = NA,
  ...
)

## S3 method for class 'LuHf'
weightedmean(
  x,
  random.effects = FALSE,
  detect.outliers = TRUE,
  plot = TRUE,
  from = NA,
  to = NA,
  levels = NA,
  clabel = "",
  rect.col = c("#00FF0080", "#FF000080"),
  outlier.col = "#00FFFF80",
  sigdig = 2,
  oerr = 3,
  exterr = FALSE,
  i2i = TRUE,
  ranked = FALSE,
  hide = NULL,
  omit = NULL,
  omit.col = NA,
  ...
)

## S3 method for class 'UThHe'
weightedmean(
  x,
  random.effects = FALSE,
  detect.outliers = TRUE,
  plot = TRUE,
  from = NA,
  to = NA,
  levels = NA,
  clabel = "",
  rect.col = c("#00FF0080", "#FF000080"),
  outlier.col = "#00FFFF80",
  sigdig = 2,
  oerr = 3,
  ranked = FALSE,
  hide = NULL,
  omit = NULL,
  omit.col = NA,
  ...
)

## S3 method for class 'fissiontracks'
weightedmean(
  x,
  random.effects = FALSE,
  detect.outliers = TRUE,
  plot = TRUE,
  from = NA,
  to = NA,
  levels = NA,
  clabel = "",
  rect.col = c("#00FF0080", "#FF000080"),
  outlier.col = "#00FFFF80",
  sigdig = 2,
  oerr = 3,
  exterr = FALSE,
  ranked = FALSE,
  hide = NULL,
  omit = NULL,
  omit.col = NA,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="weightedmean_+3A_x">x</code></td>
<td>
<p>a two column matrix of values (first column) and their
standard errors (second column) OR an object of class
<code>UPb</code>, <code>PbPb</code>, <code>ThPb</code>, <code>ArAr</code>, <code>KCa</code>,
<code>ReOs</code>, <code>SmNd</code>, <code>RbSr</code>, <code>LuHf</code>, <code>ThU</code>,
<code>fissiontracks</code> or <code>UThHe</code></p>
</td></tr>
<tr><td><code id="weightedmean_+3A_...">...</code></td>
<td>
<p>optional arguments</p>
</td></tr>
<tr><td><code id="weightedmean_+3A_from">from</code></td>
<td>
<p>minimum y-axis limit. Setting <code>from=NA</code> scales the
plot automatically.</p>
</td></tr>
<tr><td><code id="weightedmean_+3A_to">to</code></td>
<td>
<p>maximum y-axis limit. Setting <code>to=NA</code> scales the
plot automatically.</p>
</td></tr>
<tr><td><code id="weightedmean_+3A_random.effects">random.effects</code></td>
<td>
<p>if <code>TRUE</code>, computes the weighted mean
using a random effects model with two parameters: the mean and
the dispersion. This is akin to a &lsquo;model-3&rsquo; isochron
regression.
</p>
<p>if <code>FALSE</code>, attributes any excess dispersion to an
underestimation of the analytical uncertainties. This akin to a
&lsquo;model-1&rsquo; isochron regression.</p>
</td></tr>
<tr><td><code id="weightedmean_+3A_detect.outliers">detect.outliers</code></td>
<td>
<p>logical flag indicating whether outliers
should be detected and rejected using Chauvenet's Criterion.</p>
</td></tr>
<tr><td><code id="weightedmean_+3A_plot">plot</code></td>
<td>
<p>logical flag indicating whether the function should
produce graphical output or return numerical values to the
user.</p>
</td></tr>
<tr><td><code id="weightedmean_+3A_levels">levels</code></td>
<td>
<p>a vector with additional values to be displayed as
different background colours of the plot symbols.</p>
</td></tr>
<tr><td><code id="weightedmean_+3A_clabel">clabel</code></td>
<td>
<p>label of the colour legend</p>
</td></tr>
<tr><td><code id="weightedmean_+3A_rect.col">rect.col</code></td>
<td>
<p>Fill colour for the measurements or age estimates. This can
either be a single colour or multiple colours to form a colour
ramp (to be used if <code>levels!=NA</code>):
</p>
<p>a single colour: <code>rgb(0,1,0,0.5)</code>, <code>'#FF000080'</code>,
<code>'white'</code>, etc.;
</p>
<p>multiple colours: <code>c(rbg(1,0,0,0.5)</code>,
<code>rgb(0,1,0,0.5))</code>, <code>c('#FF000080','#00FF0080')</code>,
<code>c('blue','red')</code>, <code>c('blue','yellow','red')</code>, etc.;
</p>
<p>a colour palette: <code>rainbow(n=100)</code>,
<code>topo.colors(n=100,alpha=0.5)</code>, etc.; or
</p>
<p>a reversed palette: <code>rev(topo.colors(n=100,alpha=0.5))</code>,
etc.
</p>
<p>For empty boxes, set <code>rect.col=NA</code></p>
</td></tr>
<tr><td><code id="weightedmean_+3A_outlier.col">outlier.col</code></td>
<td>
<p>if <code>detect.outliers=TRUE</code>, the outliers are
given a different colour.</p>
</td></tr>
<tr><td><code id="weightedmean_+3A_sigdig">sigdig</code></td>
<td>
<p>the number of significant digits of the numerical
values reported in the title of the graphical output.</p>
</td></tr>
<tr><td><code id="weightedmean_+3A_oerr">oerr</code></td>
<td>
<p>indicates whether the analytical uncertainties of the
output are reported in the plot title as:
</p>
<p><code>1</code>: 1<code class="reqn">\sigma</code> absolute uncertainties.
</p>
<p><code>2</code>: 2<code class="reqn">\sigma</code> absolute uncertainties.
</p>
<p><code>3</code>: absolute (1-<code class="reqn">\alpha</code>)% confidence intervals, where
<code class="reqn">\alpha</code> equales the value that is stored in
<code>settings('alpha')</code>.
</p>
<p><code>4</code>: 1<code class="reqn">\sigma</code> relative uncertainties (<code class="reqn">\%</code>).
</p>
<p><code>5</code>: 2<code class="reqn">\sigma</code> relative uncertainties (<code class="reqn">\%</code>).
</p>
<p><code>6</code>: relative (1-<code class="reqn">\alpha</code>)% confidence intervals, where
<code class="reqn">\alpha</code> equales the value that is stored in
<code>settings('alpha')</code>.</p>
</td></tr>
<tr><td><code id="weightedmean_+3A_ranked">ranked</code></td>
<td>
<p>plot the aliquots in order of increasing age?</p>
</td></tr>
<tr><td><code id="weightedmean_+3A_hide">hide</code></td>
<td>
<p>vector with indices of aliquots that should be removed
from the weighted mean plot.</p>
</td></tr>
<tr><td><code id="weightedmean_+3A_omit">omit</code></td>
<td>
<p>vector with indices of aliquots that should be plotted
but omitted from the weighted mean calculation.</p>
</td></tr>
<tr><td><code id="weightedmean_+3A_omit.col">omit.col</code></td>
<td>
<p>colour that should be used for the omitted
aliquots.</p>
</td></tr>
<tr><td><code id="weightedmean_+3A_type">type</code></td>
<td>
<p>scalar indicating whether to plot the
<code class="reqn">^{207}</code>Pb/<code class="reqn">^{235}</code>U age (<code>type</code>=1), the
<code class="reqn">^{206}</code>Pb/<code class="reqn">^{238}</code>U age (<code>type</code>=2), the
<code class="reqn">^{207}</code>Pb/<code class="reqn">^{206}</code>Pb age (<code>type</code>=3), the
<code class="reqn">^{207}</code>Pb/<code class="reqn">^{206}</code>Pb-<code class="reqn">^{206}</code>Pb/<code class="reqn">^{238}</code>U age
(<code>type</code>=4), the concordia age (<code>type</code>=5), or the
<code class="reqn">^{208}</code>Pb/<code class="reqn">^{232}</code>Th age (<code>type</code>=6).</p>
</td></tr>
<tr><td><code id="weightedmean_+3A_cutoff.76">cutoff.76</code></td>
<td>
<p>the age (in Ma) below which the
<code class="reqn">^{206}</code>Pb/<code class="reqn">^{238}</code>U age and above which the
<code class="reqn">^{207}</code>Pb/<code class="reqn">^{206}</code>Pb age is used. This parameter is
only used if <code>type=4</code>.</p>
</td></tr>
<tr><td><code id="weightedmean_+3A_cutoff.disc">cutoff.disc</code></td>
<td>
<p>discordance cutoff filter. This is an object of
class <code>discfilter</code></p>
</td></tr>
<tr><td><code id="weightedmean_+3A_exterr">exterr</code></td>
<td>
<p>propagate decay constant uncertainties?</p>
</td></tr>
<tr><td><code id="weightedmean_+3A_common.pb">common.Pb</code></td>
<td>
<p>common lead correction:
</p>
<p><code>0</code>: none
</p>
<p><code>1</code>: use the Pb-composition stored in
</p>
<p><code>settings('iratio','Pb207Pb206')</code> (if <code>x</code> has class
<code>UPb</code> and <code>x$format&lt;4</code>);
</p>
<p><code>settings('iratio','Pb206Pb204')</code> and
<code>settings('iratio','Pb207Pb204')</code> (if <code>x</code> has class
<code>PbPb</code> or <code>x</code> has class <code>UPb</code> and
<code>3&lt;x$format&lt;7</code>); or
</p>
<p><code>settings('iratio','Pb206Pb208')</code> and
<code>settings('iratio','Pb207Pb208')</code> (if <code>x</code> has class
<code>UPb</code> and <code>x$format=7</code> or <code>8</code>).
</p>
<p><code>2</code>: remove the common Pb by projecting the data along an
inverse isochron. Note: choosing this option introduces a degree of
circularity in the weighted age calculation. In this case the
weighted mean plot just serves as a way to visualise the residuals
of the data around the isochron, and one should be careful not to
over-interpret the numerical output.
</p>
<p><code>3</code>: use the Stacey-Kramers two-stage model to infer the
initial Pb-composition (only applicable if <code>x</code> has class
<code>UPb</code>)</p>
</td></tr>
<tr><td><code id="weightedmean_+3A_th0i">Th0i</code></td>
<td>
<p>initial <code class="reqn">^{230}</code>Th correction.
</p>
<p><code>0</code>: no correction
</p>
<p><code>1</code>: project the data along an isochron fit
</p>
<p><code>2</code>: if <code>x$format</code> is <code>1</code> or <code>2</code>, correct the
data using the measured present day <code class="reqn">^{230}</code>Th/<code class="reqn">^{238}</code>U,
<code class="reqn">^{232}</code>Th/<code class="reqn">^{238}</code>U and <code class="reqn">^{234}</code>U/<code class="reqn">^{238}</code>U
activity ratios in the detritus. If <code>x$format</code> is <code>3</code> or
<code>4</code>, correct the data using the measured
<code class="reqn">^{238}</code>U/<code class="reqn">^{232}</code>Th activity ratio of the whole rock, as
stored in <code>x</code> by the <code>read.data()</code> function.
</p>
<p><code>3</code>: correct the data using an assumed initial
<code class="reqn">^{230}</code>Th/<code class="reqn">^{232}</code>Th-ratio for the detritus (only relevant
if <code>x$format</code> is <code>1</code> or <code>2</code>).</p>
</td></tr>
<tr><td><code id="weightedmean_+3A_i2i">i2i</code></td>
<td>
<p>&lsquo;isochron to intercept&rsquo;: calculates the initial
(aka &lsquo;inherited&rsquo;, &lsquo;excess&rsquo;, or &lsquo;common&rsquo;) <code class="reqn">^{40}</code>Ar/<code class="reqn">^{36}</code>Ar,
<code class="reqn">^{40}</code>Ca/<code class="reqn">^{44}</code>Ca, <code class="reqn">^{207}</code>Pb/<code class="reqn">^{204}</code>Pb,
<code class="reqn">^{87}</code>Sr/<code class="reqn">^{86}</code>Sr, <code class="reqn">^{143}</code>Nd/<code class="reqn">^{144}</code>Nd,
<code class="reqn">^{187}</code>Os/<code class="reqn">^{188}</code>Os, <code class="reqn">^{230}</code>Th/<code class="reqn">^{232}</code>Th,
<code class="reqn">^{176}</code>Hf/<code class="reqn">^{177}</code>Hf or <code class="reqn">^{204}</code>Pb/<code class="reqn">^{208}</code>Pb
ratio from an isochron fit. Setting <code>i2i</code> to <code>FALSE</code> uses
the default values stored in <code>settings('iratio',...)</code>.
</p>
<p>Note that choosing this option introduces a degree of circularity
in the weighted age calculation. In this case the weighted mean
plot just serves as a way to visualise the residuals of the data
around the isochron, and one should be careful not to
over-interpret the numerical output.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let <code class="reqn">\{t_1, ..., t_n\}</code> be a set of n age estimates
determined on different aliquots of the same sample, and let
<code class="reqn">\{s[t_1], ..., s[t_n]\}</code> be their analytical
uncertainties. <code>IsoplotR</code> then calculates the weighted mean of
these data using one of two methods:
</p>

<ol>
<li><p> The ordinary error-weighted mean:
</p>
<p><code class="reqn">\mu = \sum(t_i/s[t_i]^2)/\sum(1/s[t_i]^2)</code>
</p>
</li>
<li><p> A random effects model with two sources of variance:
</p>
<p><code class="reqn">\log[t_i] \sim N(\log[\mu], \sigma^2 = (s[t_i]/t_i)^2 + \omega^2 )</code>
</p>
<p>where <code class="reqn">\mu</code> is the mean, <code class="reqn">\sigma^2</code> is the total variance
and <code class="reqn">\omega</code> is the 'overdispersion'. This equation can be
solved for <code class="reqn">\mu</code> and <code class="reqn">\omega</code> by the method of maximum
likelihood.
</p>
</li></ol>

<p>IsoplotR uses a modified version of Chauvenet's criterion for
outlier detection:
</p>

<ol>
<li><p> Compute the error-weighted mean (<code class="reqn">\mu</code>) of the <code class="reqn">n</code>
age determinations <code class="reqn">t_i</code> using their analytical uncertainties
<code class="reqn">s[t_i]</code>
</p>
</li>
<li><p> For each <code class="reqn">t_i</code>, compute the probability <code class="reqn">p_i</code> that
that <code class="reqn">|t-\mu|&gt;|t_i-\mu|</code> for <code class="reqn">t \sim N(\mu, s[t_i]^2 MSWD)</code>
(ordinary weighted mean) or <code class="reqn">\log[t] \sim
N(\log[\mu],s[t_i]^2+\omega^2)</code> (random effects model)
</p>
</li>
<li><p> Let <code class="reqn">p_j \equiv \min(p_1, ..., p_n)</code>. If
<code class="reqn">p_j&lt;0.05/n</code>, then reject the j<code class="reqn">^{th}</code> date, reduce <code class="reqn">n</code>
by one (i.e., <code class="reqn">n \rightarrow n-1</code>) and repeat steps 1 through 3
until the surviving dates pass the third step.  </p>
</li></ol>

<p>If the analytical uncertainties are small compared to the scatter
between the dates (i.e. if <code class="reqn">\omega \gg s[t]</code> for all <code class="reqn">i</code>),
then this generalised algorithm reduces to the conventional
Chauvenet criterion. If the analytical uncertainties are large and
the data do not exhibit any overdispersion, then the heuristic
outlier detection method is equivalent to Ludwig (2003)'s &lsquo;2-sigma&rsquo;
method.
</p>
<p>The uncertainty budget of the weighted mean does not include the
uncertainty of the initial daughter correction (if any). This
uncertainty is neither a purely systematic nor a purely random
uncertainty and cannot easily be propagated with conventional
geochronological data processing algorithms. This caveat is
especially pertinent to chronometers whose initial daughter
composition is determined by isochron regression. You may note that
the uncertainties of the weighted mean are usually much smaller
than those of the isochron. In this case the isochron errors are
more meaningful, and the weighted mean plot should just be used to
inspect the residuals of the data around the isochron.
</p>


<h3>Value</h3>

<p>Returns a list with the following items:
</p>

<dl>
<dt>mean</dt><dd><p>a two or three element vector with:
</p>
<p><code>t</code>: the weighted mean. An asterisk is added to the plot title
if the initial daughter correction is based on an isochron
regression, to mark the circularity of using an isochron to compute
a weighted mean.
</p>
<p><code>s[t]</code>: the standard error of the weighted mean, excluding the
uncertainty of the initial daughter correction.  This is because
this uncertainty is neither purely random nor purely systematic.
</p>
</dd>
<dt>disp</dt><dd><p>a two-element vector with the (over)dispersion and its
standard error.</p>
</dd>
<dt>mswd</dt><dd><p>the Mean Square of the Weighted Deviates
(a.k.a. &lsquo;reduced Chi-square&rsquo; statistic)</p>
</dd>
<dt>df</dt><dd><p>the number of degrees of freedom of the Chi-square test
for homogeneity (<code class="reqn">df=n-1</code>, where <code class="reqn">n</code> is the number of
samples).</p>
</dd>
<dt>p.value</dt><dd><p>the p-value of a Chi-square test with <code class="reqn">df</code>
degrees of freedom, testing the null hypothesis that the underlying
population is not overdispersed.</p>
</dd>
<dt>valid</dt><dd><p>vector of logical flags indicating which steps are
included into the weighted mean calculation</p>
</dd>
<dt>plotpar</dt><dd><p>list of plot parameters for the weighted mean
diagram, including <code>mean</code> (the mean value), <code>ci</code> (a grey
rectangle with the (1 s.e., 2 s.e. or 100[1-<code class="reqn">\alpha</code>]%,
depending on the value of <code>oerr</code>) confidence interval ignoring
systematic errors), <code>ci.exterr</code> (a grey rectangle with the
confidence interval including systematic errors), <code>dash1</code> and
<code>dash2</code> (lines marking the confidence interval augmented by
<code class="reqn">\sqrt{mswd}</code> overdispersion if <code>random.effects=FALSE</code>),
and marking the confidence limits of a normal distribution whose
standard deviation equals the overdispersion parameter if
<code>random.effects=TRUE</code>). </p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+central">central</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ages &lt;- c(251.9,251.59,251.47,251.35,251.1,251.04,250.79,250.73,251.22,228.43)
errs &lt;- c(0.28,0.28,0.63,0.34,0.28,0.63,0.28,0.4,0.28,0.33)
weightedmean(cbind(ages,errs))

attach(examples)
weightedmean(LudwigMean)
</code></pre>

<hr>
<h2 id='york'>Linear regression of X,Y-variables with correlated errors</h2><span id='topic+york'></span>

<h3>Description</h3>

<p>Implements the unified regression algorithm of York et al. (2004)
which, although based on least squares, yields results that are
consistent with maximum likelihood estimates of Titterington and
Halliday (1979).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>york(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="york_+3A_x">x</code></td>
<td>
<p>a 4 or 5-column matrix with the X-values, the analytical
uncertainties of the X-values, the Y-values, the analytical
uncertainties of the Y-values, and (optionally) the correlation
coefficients of the X- and Y-values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given n pairs of (approximately) collinear measurements <code class="reqn">X_i</code>
and <code class="reqn">Y_i</code> (for <code class="reqn">1 \leq i \leq n</code>), their uncertainties
<code class="reqn">s[X_i]</code> and <code class="reqn">s[Y_i]</code>, and their covariances
cov[<code class="reqn">X_i,Y_i</code>], the <code>york</code> function finds the best fitting
straight line using the least-squares algorithm of York et
al. (2004). This algorithm is modified from an earlier method
developed by York (1968) to be consistent with the maximum
likelihood approach of Titterington and Halliday (1979). It
computes the MSWD as a measure of under/overdispersion.
Overdispersed datasets (MSWD&gt;1) can be dealt with in the same three
ways that are described in the documentation of the
<code><a href="#topic+isochron">isochron</a></code> function.
</p>


<h3>Value</h3>

<p>A seven-element list of vectors containing:
</p>

<dl>
<dt>a</dt><dd><p>the intercept of the straight line fit and its
standard error</p>
</dd>
<dt>b</dt><dd><p>the slope of the fit and its standard error</p>
</dd>
<dt>cov.ab</dt><dd><p>the covariance of the slope and intercept</p>
</dd>
<dt>mswd</dt><dd><p>the mean square of the residuals (a.k.a
&lsquo;reduced Chi-square&rsquo;) statistic</p>
</dd>
<dt>df</dt><dd><p>degrees of freedom of the linear fit <code class="reqn">(n-2)</code></p>
</dd>
<dt>p.value</dt><dd><p>p-value of a Chi-square value with <code>df</code>
degrees of freedom</p>
</dd>
</dl>



<h3>References</h3>

<p>Titterington, D.M. and Halliday, A.N., 1979. On the fitting of
parallel isochrons and the method of maximum likelihood. Chemical
Geology, 26(3), pp.183-195.
</p>
<p>York, Derek, et al., 2004. Unified equations for the slope,
intercept, and standard errors of the best straight line.  American
Journal of Physics 72.3, pp.367-375.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+data2york">data2york</a></code>, <code><a href="#topic+titterington">titterington</a></code>,
<code><a href="#topic+isochron">isochron</a></code>, <code><a href="#topic+ludwig">ludwig</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X &lt;- c(1.550,12.395,20.445,20.435,20.610,24.900,
       28.530,50.540,51.595,86.51,106.40,157.35)
Y &lt;- c(.7268,.7849,.8200,.8156,.8160,.8322,
       .8642,.9584,.9617,1.135,1.230,1.490)
n &lt;- length(X)
sX &lt;- X*0.01
sY &lt;- Y*0.005
rXY &lt;- rep(0.8,n)
dat &lt;- cbind(X,sX,Y,sY,rXY)
fit &lt;- york(dat)
scatterplot(dat,fit=fit)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
