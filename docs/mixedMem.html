<!DOCTYPE html><html lang="en"><head><title>Help for package mixedMem</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {mixedMem}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#mixedMem-package'>
<p>Tools for fitting discrete multivariate mixed membership models</p></a></li>
<li><a href='#ANES'><p>Responses from 1983 American National Election Survey Pilot</p></a></li>
<li><a href='#computeBIC'><p>Compute the approximate BIC</p></a></li>
<li><a href='#computeELBO'><p>Compute a lower bound on the log-likelihood (ELBO)</p></a></li>
<li><a href='#findLabels'><p>Mixed Membership Post-Processing</p></a></li>
<li><a href='#gmv_theta'><p>Point estimates from Gross and Manrique-Vallier 2014</p></a></li>
<li><a href='#mixedMemModel'><p>Constructor for a Mixed Membership Model Object</p></a></li>
<li><a href='#mmVarFit'><p>Fit  Mixed Membership models using variational EM</p></a></li>
<li><a href='#permuteLabels'><p>Mixed Membership Post-Processing</p></a></li>
<li><a href='#plot.mixedMemModel'><p>Plot a Mixed Membership Model</p></a></li>
<li><a href='#rmixedMem'><p>Simulate Mixed Membership Data</p></a></li>
<li><a href='#summary.mixedMemModel'><p>Summary of a Mixed Membership Model</p></a></li>
<li><a href='#vizMem'><p>Mixed Membership Visualization</p></a></li>
<li><a href='#vizTheta'><p>Mixed Membership Visualization</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Tools for Discrete Multivariate Mixed Membership Models</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-11-28</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Y. Samuel Wang &lt;ysamuelwang@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Fits mixed membership models with discrete multivariate data (with
    or without repeated measures) following the general framework of Erosheva et al
    (2004). This package uses a Variational EM approach by approximating the
    posterior distribution of latent memberships and selecting hyperparameters
    through a pseudo-MLE procedure. Currently supported data types are
    Bernoulli, multinomial and rank (Plackett-Luce). The extended GoM model with 
    fixed stayers from Erosheva et al (2007) is now also supported. See Airoldi et al 
    (2014) for other examples of mixed membership models.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.2)</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 0.11.3), gtools</td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp (&ge; 0.11.3), RcppArmadillo, BH</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, xtable,</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-12-01 04:31:00 UTC; swang24</td>
</tr>
<tr>
<td>Author:</td>
<td>Y. Samuel Wang [aut, cre],
  Elena A. Erosheva [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-12-01 17:30:13 UTC</td>
</tr>
</table>
<hr>
<h2 id='mixedMem-package'>
Tools for fitting discrete multivariate mixed membership models
</h2><span id='topic+mixedMem-package'></span><span id='topic+mixedMem'></span>

<h3>Description</h3>

<p>The <code>mixedMem</code> package contains tools for fitting and interpreting discrete multivariate mixed membership models following the general framework outlined in Erosheva et al 2004. In a mixed membership models, individuals can belong to multiple groups instead of only a single group (Airoldi et al 2014). This extension allows for a richer description of heterogeneous populations and has been applied in a wide variety of contexts including: text data (Blei et al 2003), genotype sequences (Pritchard  et al 2000), ranked data (Gormley and Murphy 2009), and survey data (Erosheva et al 2007, Gross and Manrique-Vallier 2014). 
</p>


<h3>Details</h3>

<p>Mixed membership model objects can be created using the <code>mixedMemModel</code>
constructor function. This function checks the internal consistency of the data/parameters
and returns an object suitable for use by the <code>mmVarFit</code> function. The 
<code>mmVarFit</code> function is the main function in the package. It utilizes a variational EM algorithim to fit an approximate posterior distribution for the latent variables and select pseudo-MLE estimates for the global parameters. A step-by-step guide to using the package is detailed in the package vignette &quot;Fitting Mixed Membership Models using <code>mixedMem</code>&quot;. 
</p>
<p>The package supports multivariate models (with or without repeated measurements) where each variable can be of a different type. Currently supported data types include: Bernoulli, rank (Plackett-Luce) and multinomial. Given a fixed number of sub-populations K, we assume the following generative model for each mixed membership model:
</p>

<ul>
<li><p>For each individual i = 1,... Total:
</p>

<ul>
<li><p>Draw <code class="reqn">\lambda_i</code> from a Dirichlet(<code class="reqn">\alpha</code>). <code class="reqn">\lambda_i</code> is a vector of length K whose components indicates the degree of membership for individual i in each of the K sub-populations.
</p>
</li>
<li><p>For each variable j = 1 ..., J:
</p>
</li>
<li> <p>For each of replicate r = 1, ..., <code class="reqn">R_j</code>:
</p>
</li>
<li><p>For each ranking level n = 1..., <code class="reqn">N_{i,j,r}</code>:
</p>

<ul>
<li><p> Draw <code class="reqn">Z_{i,j,r,n}</code> from a multinomial(1, <code class="reqn">\lambda_i</code>). The latent sub-population indicator <code class="reqn">Z_{i,j,r,n}</code> determines the sub-population which governs the response for observation <code class="reqn">X_{i,j,r,n}</code>. This is sometimes referred to as the context vector because it determines the context from which the individual responds.
</p>
</li>
<li><p>  Draw <code class="reqn">X_{i,j,r,n}</code> from the latent sub-population distribution parameterized by <code class="reqn">\theta_{j,Z_{i,j,r,n}}</code>. The parameter <code class="reqn">\theta</code> governs the observations for each sub-population. For example, if variable j is a multinomial or rank distribution with <code class="reqn">V_j</code> categories/candidates, then <code class="reqn">\theta_{j,k}</code> is a vector of length <code class="reqn">V_j</code> which parameterizes the responses to variable j for sub-population k. Likewise, if variable j is a Bernoulli random variable, then <code class="reqn">\theta_{j,k}</code> is a value which determines the probability of success. 
</p>
</li></ul>
</li></ul>
</li></ul>



<h3>Author(s)</h3>

<p>Y. Samuel Wang &lt;ysamuelwang@gmail.com&gt;, Elena Erosheva &lt;erosheva@uw.edu&gt;
</p>


<h3>References</h3>

<p>Airoldi, E. M., Blei, D., Erosheva, E. A., &amp; Fienberg, S. E.. 2014. Handbook of Mixed Membership Models and Their Applications. CRC Press. Chicago  
</p>
<p>Blei, David; Ng, Andrew Y.; Jordan, Michael I.. 2003. Latent Dirichlet Allocation. Journal of Machine Learning Research, 3, 993-1022. 
</p>
<p>Erosheva, Elena A.; Fienberg, Stephen E.; Joutard, Cyrille. 2007. Describing Disability Through Individual-level Mixture Models for Multivariate Binary Data. The Annals of Applied Statistics 1 (2007), no. 2, 502&ndash;537. doi:10.1214/07-AOAS126.
</p>
<p>Erosheva, Elena A.; Fienberg, Stephen E.; Lafferty, John. 2004. Mixed-membership Models of Scientific Publications&quot;.
PNAS, 101 (suppl 1), 5220-5227. doi:10.1073/pnas.0307760101.
</p>
<p>Gormley, Isobel C.; Murphy, Thomas B.. 2009. A Grade of Membership Model for Rank Data. Bayesian Analysis, 4, 265 - 296. DOI:10.1214/09-BA410.
</p>
<p>National Election Studies, 1983 Pilot Election Study. Ann Arbor, MI: University of Michigan, Center for Political Studies, 1999
</p>
<p>Pritchard, Jonathan K.; Stephens, Matthew; Donnelly, Peter. 2000. Inference of Population Structure using Multilocus Genotype Data. Genetics 155.2: 945-959.
</p>
<p>Gross, Justin; Manrique-Vallier, Daniel. 2014.  A Mixed-membership Approach to the Assessment of Political Ideology from Survey Responses. In Airoldi, Edoardo M.; Blei, David; Erosheva, Elena A.; &amp; Fienberg, Stephen E.. Handbook of Mixed Membership Models and Their Applications. CRC Press. Chicago
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(mixedMem)
data(ANES)
# Dimensions of the data set: 279 individuals with 19 responses each
dim(ANES)
# The 19 variables and their categories
# The specific statements for each variable can be found using help(ANES)
# Variables titled EQ are about Equality
# Variables titled IND are about Econonic Individualism
# Variables titled ENT are about Free Enterprise
colnames(ANES)
# Distribution of responses
table(unlist(ANES))

# Sample Size
Total &lt;- 279
# Number of variables
J &lt;- 19 
# we only have one replicate for each of the variables
Rj &lt;- rep(1, J)
# Nijr indicates the number of ranking levels for each variable.
# Since all our data is multinomial it should be an array of all 1s
Nijr &lt;- array(1, dim = c(Total, J, max(Rj)))
# Number of sub-populations
K &lt;- 3
# There are 3 choices for each of the variables ranging from 0 to 2.
Vj &lt;- rep(3, J)
# we initialize alpha to .2
alpha &lt;- rep(.2, K)
# All variables are multinomial
dist &lt;- rep("multinomial", J)
# obs are the observed responses. it is a 4-d array indexed by i,j,r,n
# note that obs ranges from 0 to 2 for each response
obs &lt;- array(0, dim = c(Total, J, max(Rj), max(Nijr)))
obs[ , ,1,1] &lt;- as.matrix(ANES)

# Initialize theta randomly with Dirichlet distributions
set.seed(123)
theta &lt;- array(0, dim = c(J,K,max(Vj)))
for(j in 1:J)
{
    theta[j, , ] &lt;- gtools::rdirichlet(K, rep(.8, Vj[j]))
}

# Create the mixedMemModel
# This object encodes the initialization points for the variational EM algorithim
# and also encodes the observed parameters and responses
initial &lt;- mixedMemModel(Total = Total, J = J, Rj = Rj,
                         Nijr = Nijr, K = K, Vj = Vj, alpha = alpha,
                         theta = theta, dist = dist, obs = obs)
## Not run: 
# Fit the model
out &lt;- mmVarFit(initial)
summary(out)

## End(Not run)
</code></pre>

<hr>
<h2 id='ANES'>Responses from 1983 American National Election Survey Pilot</h2><span id='topic+ANES'></span>

<h3>Description</h3>

<p><code>ANES</code> contains political ideology survey data from the 1983 American National Election Survey Pilot. Respondents were read a value statement and asked
to report their level of agreement: &lsquo;strongly agree&rsquo;, &lsquo;agree&rsquo;, &lsquo;can&rsquo;t decide', &lsquo;disagree&rsquo;, and strongly disagree'.
The 279 complete responses to the 19 statements selected by Feldman (1988)
and reanalyzed by Gross and Manrique-Vallier (2014) are included. &lsquo;Strongly disagree&rsquo; and &lsquo;disagree&rsquo; as well
as &lsquo;strongly agree&rsquo; and 'agree' have been collapsed into single categories.
0 indicates &lsquo;agree&rsquo;, 1 indicates &lsquo;can&rsquo;t decide', and 2
indicates &lsquo;disagree&rsquo;. The statements have been grouped into 3 overarching themes as
indicated in the variable names- Equality (EQ), Economic Individualism (IND), and Free Enterprise (ENT).
Variable ID's from the original ANES questionnaire are included in parentheses.
An example analysis of the data is included in the
&quot;Fitting Mixed Membership Models Using <code>mixedMem</code>&quot; vignette.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ANES)
</code></pre>


<h3>Format</h3>

<p>A data frame with 279 individuals and 19 variables:
</p>

<dl>
<dt>EQ1</dt><dd><p>If people were treated more equally in this country,
we would have many fewer problems (V832169)</p>
</dd>
<dt>EQ2</dt><dd><p>We should give up on the goal of equality, since people
are so different to begin with (V832172)</p>
</dd>
<dt>EQ3</dt><dd><p>Our society should do whatever is necessary to make sure
that everyone has an equal opportunity to succeed (V832175)</p>
</dd>
<dt>EQ4</dt><dd><p>Some people are just better cut out than others for important
positions in society (V832178)</p>
</dd>
<dt>EQ5</dt><dd><p>Some people are better at running things and should be allowed
to do so (V832250)</p>
</dd>
<dt>EQ6</dt><dd><p>All kinds of people should have an equal say in running
this country, not just those who are successful (V832253)</p>
</dd>
<dt>EQ7</dt><dd><p>One of the big problems in this country is that we don't
give everyone an equal chance (V832256)</p>
</dd>
<dt>IND1</dt><dd><p>Any person who is willing to work hard has a good chance
of succeeding (V832170)</p>
</dd>
<dt>IND2</dt><dd><p>Hard work offers little guarantee of success (V832173)</p>
</dd>
<dt>IND3</dt><dd><p>Most people who don't get ahead should not blame
the system; they really have only themselves to blame (V832176)</p>
</dd>
<dt>IND4</dt><dd><p>Even if people are ambitious, they often cannot succeed (V832251)</p>
</dd>
<dt>IND5</dt><dd><p>If people work hard, they almost always get what they want (V832254)</p>
</dd>
<dt>IND6</dt><dd><p>Even if people try hard, they often cannot reach their goals (V832257)</p>
</dd>
<dt>ENT1</dt><dd><p>The less government gets involved with business and the
economy, the better off this country will be (V832171)</p>
</dd>
<dt>ENT2</dt><dd><p>There are many goods and services that would never be
available to ordinary people without governmental intervention (V832174)</p>
</dd>
<dt>ENT3</dt><dd><p>There should be no government interference with business
and trade (V832177)</p>
</dd>
<dt>ENT4</dt><dd><p>Putting government regulations on business does not
endanger personal freedom (V832252)</p>
</dd>
<dt>ENT5</dt><dd><p>Government intervention leads to too much red tape and
too many problems (V832255)</p>
</dd>
<dt>ENT6</dt><dd><p>Contrary to what some people think, a free enterprise
system is not necessary for our form of government to survive (V832258)</p>
</dd>
</dl>


<h3>References</h3>

<p>Feldman, Stanley. &quot;Structure and consistency in public opinion: The role of core beliefs and values.&quot; American Journal of Political Science (1988): 416-440.
</p>
<p>Gross, J.H. and Manrique-Vallier, D. &quot;A Mixed-Membership Approach to the Assessment of Political Ideology from Survey Responses.&quot;
in Airoldi, E. M., Blei, D. M., Erosheva, E. A., and Fienberg, S. E.
Handbook of Mixed Membership Models and Its Applications. Chapman &amp; Hall/CRC, 2014
</p>
<p>National Election Studies, 1983 Pilot Election Study. Ann Arbor, MI: University of Michigan, Center for Political Studies, 1999
</p>

<hr>
<h2 id='computeBIC'>Compute the approximate BIC</h2><span id='topic+computeBIC'></span>

<h3>Description</h3>

<p><code>computeBIC</code> computes the approximate BIC of a given <code>mixedMemModel</code>, where the lower bound on the log-likelihood
(also called ELBO) is used instead of the intractable true log-likelihood.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>computeBIC(model)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="computeBIC_+3A_model">model</code></td>
<td>
<p>the <code>mixedMemModel</code> object for which the BIC will be calculated.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code class="reqn">BIC = -2 ELBO + p \log(Total)</code>
</p>
<p>where p is the number of estimated parameters and Total is the number of individuals in
the sample.
</p>
<p>This BIC model selection criteria is used in Erosheva et al (2007). The number of estimated parameters P includes the
parameters <code class="reqn">\theta</code> and <code class="reqn">\alpha</code>, but omits the variational parameters <code class="reqn">\phi</code> and <code class="reqn">\delta</code>.
</p>


<h3>Value</h3>

<p><code>computeBIC</code> returns the approximate BIC value, a real number.
</p>


<h3>References</h3>

<p>Erosheva, E. A., Fienberg, S. E., &amp; Joutard, C. (2007). Describing disability through individual-level mixture models for multivariate binary data. The annals of applied statistics, 1(2), 346.
</p>

<hr>
<h2 id='computeELBO'>Compute a lower bound on the log-likelihood (ELBO)</h2><span id='topic+computeELBO'></span>

<h3>Description</h3>

<p><code>computeELBO</code> computes the variational lower bound on the log-likelihood, also called the ELBO, for a mixed membership model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>computeELBO(model)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="computeELBO_+3A_model">model</code></td>
<td>
<p>a <code>mixedMemModel</code> object created by the <code>mixedMemModel</code> constructor.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The lower bound (ELBO) is the objective function in the variational EM algorithim.
It is a function of the latent variables (<code class="reqn">\phi</code> and <code class="reqn">\delta</code>) and the parameters (<code class="reqn">\alpha</code> and <code class="reqn">\theta</code>)
that be derived from Jensen's inequality:
</p>
<p><code class="reqn">E_Q{\log[p(X,Z, \Lambda)]} - E_Q{\log[Q(Z, \Lambda|\phi, \delta)]} \le\log P(obs |\alpha, \theta) </code>
</p>


<h3>Value</h3>

<p><code>computeELBO</code> returns the lower bound on the log-likelihood, a real number.
</p>

<hr>
<h2 id='findLabels'>Mixed Membership Post-Processing</h2><span id='topic+findLabels'></span>

<h3>Description</h3>

<p><code>findLabels</code> finds the optimal permutation of labels that minimizes
the weighted squared difference between the arrays of subpopulation parameters from a fitted mixed membership
model, <code class="reqn">\theta</code> and a given comparison model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>findLabels(model, comparison, exhaustive = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="findLabels_+3A_model">model</code></td>
<td>
<p>the fitted <code>mixedMemModel</code> object.</p>
</td></tr>
<tr><td><code id="findLabels_+3A_comparison">comparison</code></td>
<td>
<p>an array of the same dimensions as model$theta which contains the subpopulation parameters from another model.
<code>findLabels</code> will return a permutation of the labels of <code>model</code> which match to <code>comparison</code> most closely.</p>
</td></tr>
<tr><td><code id="findLabels_+3A_exhaustive">exhaustive</code></td>
<td>
<p>a boolean for whether an exhaustive search should be performed. If false, a greedy algorithim is used instead.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Mixed Membership models are invariant to permutations of the sub-population labels; swapping the names of each sub-population yields an equivalent model.
The ordering of the labels in a fitted model is dependent on the initialization points of the variational EM algorithim. The function <code>findLabels</code> selects a
permutation of the sub-population labels that best matches a given comparison model by minimizing the weighted squared difference between the
<code class="reqn">\theta</code> arrays. The weights are determined by the relative frequencies of each group.
</p>
<p><code class="reqn">Loss = \sum_j \sum_k \alpha_k/\alpha_0 [\sum_v (\hat\theta_{k,v} - \theta_{k,v})^2]</code>
where <code class="reqn">\alpha_0 = \sum_k \alpha_k</code>
</p>
<p>If K, number of sub-populations, is small, the method searches through all K! permutations of the sub-population labels and
select the permutation which minimizes the loss. If K is large, a greedy algorithim can be used instead. This
algorithm selects the best match for each fitted sub-population starting with the group with the largest fitted
relative frequency.
</p>


<h3>Value</h3>

<p><code>findLabels</code> returns a list with two objects: <code>perm</code> and <code>loss</code>. <code>perm</code> is the optimal permutation of the labels with respect to the squared error loss.
<code>loss</code> is the calculated value of the weighted squared error loss (shown above) for the optimal permutation.
</p>


<h3>See Also</h3>

<p>permuteLabels
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# See mixedMemModel documentation for how to generate data and instantiate a mixedMemModel object
# After the data as been generated, we initialize the array of sub-population parameters (theta)
# according to a permutation of the true labeling
set.seed(123)
perm = sample.int(K, size = K, replace = FALSE)
theta1 = theta_truth[,perm,]
test_model &lt;- mixedMemModel(Total = Total, J = J,Rj = Rj, Nijr= Nijr, K = K, Vj = Vj,dist = dist,
 obs = obs, alpha = alpha, theta = theta1)
out &lt;- mmVarFit(test_model)
opt.perm &lt;- findLabels(out, theta_truth)
opt.perm

# produce mixedMemModel object with sub-population labels permuted to best match
# the comparison model
out = permuteLabels(out, opt.perm$perm)

## End(Not run)
</code></pre>

<hr>
<h2 id='gmv_theta'>Point estimates from Gross and Manrique-Vallier 2014</h2><span id='topic+gmv_theta'></span>

<h3>Description</h3>

<p><code>gmv_theta</code> contains the point estimates for the sub-populaton response probabilities, <code class="reqn">\theta</code> from the original Gross and
Manrique-Vallier 2014 analysis. It is a 3 by 19 by 3 dimensional array with
the first dimension corresponding to each latent sub-population, the second dimension corresponding to
each variable, and the 3rd dimension corresponding to response choices (Agree, Can't Decide,
Disagree). Gross and Manrique-Vallier do not report results for group 3 for reasons discussed in the vignette
so all values for group 3 in theta[1, , ] are 0.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(gmv_theta)
</code></pre>


<h3>References</h3>

<p>Gross, J.H.; Manrique-Vallier, D. &quot;A Mixed-Membership Approach to the Assessment of Political Ideology from Survey Responses.&quot;
in Airoldi, E. M., Blei, D. M., Erosheva, E. A., and Fienberg, S. E.
Handbook of Mixed Membership Models and Its Applications. Chapman &amp; Hall/CRC, 2014
</p>

<hr>
<h2 id='mixedMemModel'>Constructor for a Mixed Membership Model Object</h2><span id='topic+mixedMemModel'></span>

<h3>Description</h3>

<p>Constructor for a <code>mixedMemModel</code> object which can be used for analysis
in the <code>mixedMem</code> package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mixedMemModel(Total, J, Rj, Nijr, K, Vj, alpha, theta, phi = NULL,
  delta = NULL, dist, obs, fixedObs = NULL, P = NULL, beta = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mixedMemModel_+3A_total">Total</code></td>
<td>
<p>the number of individuals in the sample.</p>
</td></tr>
<tr><td><code id="mixedMemModel_+3A_j">J</code></td>
<td>
<p>the number of variables observed on each individual.</p>
</td></tr>
<tr><td><code id="mixedMemModel_+3A_rj">Rj</code></td>
<td>
<p>a vector of length J specifying the number of repeated measurements
for each variable.</p>
</td></tr>
<tr><td><code id="mixedMemModel_+3A_nijr">Nijr</code></td>
<td>
<p>an array with dimension (<code>Total</code>, <code>J</code>, <code>max(Rj)</code>) indicating the number
of ranking levels for each variable and each replication. For multinomial and Bernoulli
variables, <code>Nijr</code>[i,j,r] = 1. For rank variables, <code>Nijr</code>[i,j,r] indicates the
number of alternatives ranked.</p>
</td></tr>
<tr><td><code id="mixedMemModel_+3A_k">K</code></td>
<td>
<p>the number of sub-populations.</p>
</td></tr>
<tr><td><code id="mixedMemModel_+3A_vj">Vj</code></td>
<td>
<p>a vector of length <code>J</code> specifying the number of possible candidates
for each variable. For a Bernoulli variable <code>Vj</code>[j] = 1.</p>
</td></tr>
<tr><td><code id="mixedMemModel_+3A_alpha">alpha</code></td>
<td>
<p>a vector of length <code>K</code> which is the parameter for Dirichlet
membership distribution.</p>
</td></tr>
<tr><td><code id="mixedMemModel_+3A_theta">theta</code></td>
<td>
<p>an array with dimensions (<code>J</code>,<code>K</code>,<code>max(Vj)</code>) which governs the variable
distributions. The parameter <code>theta</code>[j,k,] governs the distribution of variable J for a complete member of sub-population k. For instance, if variable j is a Bernoulli variable, theta[j,k,1] is the probability of success; if
variable j is a multinomial variable, <code>theta</code>[j,k, 1:Vj[j]] is the probability for each of the <code>Vj</code>[j] categories; if variable j
is a rank variable, <code>theta</code>[j,k, 1:Vj[j]] are the support parameters for each of the <code>Vj</code>[j] alternatives. Since the dimension of the relevant parameters
can differ across variables, any unused elements of the array should be set to 0, while all other elements should be positive.</p>
</td></tr>
<tr><td><code id="mixedMemModel_+3A_phi">phi</code></td>
<td>
<p>an array with dimensions (<code>Total</code>,<code>K</code>) which specifies the variational
parameters for the membership vectors, <code class="reqn">\lambda</code>. The default group membership initialization is uniform across all groups (phi[i,k] = 1/K for all k).
The default initialization is highly recommended.</p>
</td></tr>
<tr><td><code id="mixedMemModel_+3A_delta">delta</code></td>
<td>
<p>an array with dimensions (<code>Total</code>,<code>J</code>,<code>max(Rj)</code>, <code>max(Nijr)</code>, <code>K</code>) which specifies
the variational parameters for the context vectors Z. The default initialization is
uniform across all sub-populations (<code>delta</code>[i, j, r, n, k] = 1/K for all k).</p>
</td></tr>
<tr><td><code id="mixedMemModel_+3A_dist">dist</code></td>
<td>
<p>a vector of length <code>J</code> specifying variable types. Options are
&quot;bernoulli&quot;, &quot;multinomial&quot; or &quot;rank&quot; corresponing to the distributions
of the observed variables.</p>
</td></tr>
<tr><td><code id="mixedMemModel_+3A_obs">obs</code></td>
<td>
<p>an array with dimensions (<code>Total</code>,<code>J</code>,<code>max(Rj)</code>, <code>max(Nijr)</code>) corresponding to
the observed data. For Bernoulli random variables, the data consist of 0/1's.
For multinomial or rank data the data consist of integers 0,1,...,(Vj[j]-1).</p>
</td></tr>
<tr><td><code id="mixedMemModel_+3A_fixedobs">fixedObs</code></td>
<td>
<p>an array with dimensions (1, <code>J</code>, <code>max(Rj)</code>, <code>max(Nijr)</code>) corresonding to the observed
responses for a fixed group in the extended GoM model from Erosheva et al (2007)</p>
</td></tr>
<tr><td><code id="mixedMemModel_+3A_p">P</code></td>
<td>
<p>scalar between 0 and 1 corresponding to initial value for the proportion of individuals in the fixed group</p>
</td></tr>
<tr><td><code id="mixedMemModel_+3A_beta">beta</code></td>
<td>
<p>scalar between 0 and 1 corresponding to the initial value of beta, the conditional probability of being in the fixed group
for an individual who's observed responses match the fixed group.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function returns an object of <code>mixedMemModel</code> class. This object contains dimensions of the model,
the observed data, and the model parameters. Once a <code>mixedMemModel</code> object is created,
the specified model can be fit for the data using the <code>mmVarFit</code> function. If the inputs are inconsistent (ie if dimensions do not match,
or if observations and distribution types are not compatible,<code>mixedMemModel</code> will throw an error. For additional details on usage, and model
assumptions, see the corresponding vignette &quot;Fitting Mixed Membership Models Using <code>mixedMem</code>&quot;.
</p>


<h3>Value</h3>

<p>returns an object of class <code>mixedMemModel</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)
Total &lt;- 50 # 50 Individuals
J &lt;- 3 # 3 different variables
# distributions of each variable
dist &lt;- c("multinomial", "bernoulli", "rank")
# 100 repeated measures of the multinomial, 5 repeated measures of the
# Bernoulli, 1 repeated measure of the rank
Rj &lt;- c(100, 5, 1)

K &lt;- 4 # 4 sub-populations
alpha &lt;- rep(.5, K) #hyperparameter for dirichlet distribution

# Number of categories/alternatives for each variable. For the Bernoulli, Vj = 1
Vj &lt;- c(10, 1, 4)


theta &lt;- array(0, dim = c(J, K, max(Vj)))
# Parameters governing multinomial
theta[1,,] &lt;- gtools::rdirichlet(K, rep(.3, Vj[1]))
#parameters governing Bernoulli
theta[2,,] &lt;- cbind(rbeta(K, 1,1), matrix(0, nrow = K, ncol = Vj[1]-1))
theta[3,,] &lt;- cbind(gtools::rdirichlet(K, rep(.3, Vj[3])),
 matrix(0, nrow = K, ncol = Vj[1]-Vj[3]))

# Items selected for each observation. For Multinomial and Bernoulli, this is always 1
# For rank data, this will be the number of alternatives ranked
Nijr = array(0, dim = c(Total, J, max(Rj)))
Nijr[,1,c(1:Rj[1])] = 1 # N_ijr is 1 for multinomial variables
Nijr[,2,c(1:Rj[2])] = 1 # N_ijr is 1 for Bernoulli variables
Nijr[,3,c(1:Rj[3])] = sample.int(Vj[3], size = Total, replace = TRUE)

# generate random sample of observations
sampleMixedMem &lt;- rmixedMem(Total, J, Rj, Nijr, K, Vj,
dist, theta, alpha)

## Initialize a mixedMemModel object
test_model &lt;- mixedMemModel(Total = Total, J = J,Rj = Rj,
 Nijr= Nijr, K = K, Vj = Vj,dist = dist, obs = sampleMixedMem$obs,
  alpha = alpha, theta = theta)
# Look at Summary of the initialized model
summary(test_model)
# Plot the current values for theta
plot(test_model)
</code></pre>

<hr>
<h2 id='mmVarFit'>Fit  Mixed Membership models using variational EM</h2><span id='topic+mmVarFit'></span>

<h3>Description</h3>

<p><code>mmVarFit</code> is the primary function of the <code>mixedMem</code> package. The function fits parameters <code class="reqn">\phi</code> and <code class="reqn">\delta</code> for the variational
distribution of latent variables as well as psuedo-MLE estimates for
the population parameters <code class="reqn">\alpha</code> and <code class="reqn">\theta</code>. See documentation for
<code>mixedMemModel</code> or the package vignette, &quot;Fitting Mixed Membership Models Using <code>mixedMem</code>&quot; for a more detailed description of
the variables and notation in a mixed membership model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mmVarFit(model, printStatus = 1, printMod = 1, stepType = 3,
  maxTotalIter = 500, maxEIter = 1000, maxAlphaIter = 200,
  maxThetaIter = 1000, maxLSIter = 400, elboTol = 1e-06,
  alphaTol = 1e-06, thetaTol = 1e-10, aNaught = 1, tau = 0.899,
  bMax = 3, bNaught = 1000, bMult = 1000, vCutoff = 13,
  holdConst = c(-1))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mmVarFit_+3A_model">model</code></td>
<td>
<p>a <code>mixedMemModel</code> object created by the <code>mixedMemModel</code> constructor.</p>
</td></tr>
<tr><td><code id="mmVarFit_+3A_printstatus">printStatus</code></td>
<td>
<p>an integer 0 or 1. When <code>printStatus</code> is 1 <code>mmVarFit</code> will print status updates, when
<code>printStatus</code> is 0 <code>mmVarFit</code> will not print status updates.</p>
</td></tr>
<tr><td><code id="mmVarFit_+3A_printmod">printMod</code></td>
<td>
<p>a positive integer which specifies how often to print status updates. The
status will be printed at each step which is a multiple of <code>printMod</code>. The default value is 1.</p>
</td></tr>
<tr><td><code id="mmVarFit_+3A_steptype">stepType</code></td>
<td>
<p>an integer from 0-3 which specifies what steps to carry out in estimation. 0 performs a single E-Step; this can be used
to find the held out ELBO. 1 performs iterates between E-steps and M-steps for estimating theta but keeps alpha constant.
2 iterates between  E-steps and M-steps for estimating alpha, but keeps theta constant. 3 completes full
E and M steps. The default is 3.</p>
</td></tr>
<tr><td><code id="mmVarFit_+3A_maxtotaliter">maxTotalIter</code></td>
<td>
<p>the maximum total steps before termination. A full E and M step together count as 1 step.
If this maximum is ever achieved, a warning message will be printed at convergence. The default is 500.</p>
</td></tr>
<tr><td><code id="mmVarFit_+3A_maxeiter">maxEIter</code></td>
<td>
<p>the maximum iterations for each E-Step. If this maximum is ever achieved, a warning
message will be printed at convergence. The default is 1000.</p>
</td></tr>
<tr><td><code id="mmVarFit_+3A_maxalphaiter">maxAlphaIter</code></td>
<td>
<p>the maximum iterations when fitting alpha. If this maximum is ever achieved,
a warning message will be printed at convergence. The default is 200.</p>
</td></tr>
<tr><td><code id="mmVarFit_+3A_maxthetaiter">maxThetaIter</code></td>
<td>
<p>the maximum iterations when fitting theta. If this maximum is ever achieved,
a warning message will be printed at convergence. The default is 1000.</p>
</td></tr>
<tr><td><code id="mmVarFit_+3A_maxlsiter">maxLSIter</code></td>
<td>
<p>the maximum backtracking iterations in the line search for updating alpha and theta for rank data.</p>
</td></tr>
<tr><td><code id="mmVarFit_+3A_elbotol">elboTol</code></td>
<td>
<p>the convergence criteria for the EM Algorithim. When the relative increase in the ELBO is less than the convergence critiera,
the algorithm converges. The default is 400.</p>
</td></tr>
<tr><td><code id="mmVarFit_+3A_alphatol">alphaTol</code></td>
<td>
<p>the convergence criteria for updates to alpha. When the relative increase in the ELBO is less than the convergence critiera,
the update to alpha converges. The defualt is 1e-6.</p>
</td></tr>
<tr><td><code id="mmVarFit_+3A_thetatol">thetaTol</code></td>
<td>
<p>the convergence criteria for updates to theta. When the relative increase in the ELBO is less than the convergence critiera,
the update to theta converges. The default is 1e-10.</p>
</td></tr>
<tr><td><code id="mmVarFit_+3A_anaught">aNaught</code></td>
<td>
<p>the first step size in the backtracking line search used to update alpha and theta for rank data. The default is 1.</p>
</td></tr>
<tr><td><code id="mmVarFit_+3A_tau">tau</code></td>
<td>
<p>the backtracking factor in the backtracking line search used to update alpha and theta for rank data. The default is .899.</p>
</td></tr>
<tr><td><code id="mmVarFit_+3A_bmax">bMax</code></td>
<td>
<p>the number of times the penalization factor is increased in the interior point method
for fitting theta for rank data. The default is 3.</p>
</td></tr>
<tr><td><code id="mmVarFit_+3A_bnaught">bNaught</code></td>
<td>
<p>the initial penalization factor in the interior point method for fitting theta for rank data.
<code>bNaught</code> must be positive and the default value is 1000.</p>
</td></tr>
<tr><td><code id="mmVarFit_+3A_bmult">bMult</code></td>
<td>
<p>a positive number by which bNaught is multiplied by in each iteration of the interior point method
for fitting theta for rank data. The default is 1000.</p>
</td></tr>
<tr><td><code id="mmVarFit_+3A_vcutoff">vCutoff</code></td>
<td>
<p>a positive integer cutoff for Vj at which a gradient ascent method is used instead of the Newton Raphson interior point method. This is used to avoid inverting
a large matrix. The default is 13.</p>
</td></tr>
<tr><td><code id="mmVarFit_+3A_holdconst">holdConst</code></td>
<td>
<p>a vector of integers specifying groups to be held fixed during the estimation procedure. The estimation algorithim will hold the
theta parameters of these specific groups constant, but update all other parameters. The group numbers range from 0 to K - 1. To estimate all groups, use the default value of c(-1).</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>mmVarFit</code> selects psuedo-MLE estimates for <code class="reqn">\alpha</code> and <code class="reqn">\theta</code> and approximates
the posterior distribution for the latent variables through a mean field variational approach.
The variational lower bound on the log-likelihood at the data given model parameters is given by Jensen's inequality:
</p>
<p><code class="reqn">E_Q{\log[p(X,Z, \Lambda)]} - E_Q{\log[Q(Z, \Lambda|\phi, \delta)]} \le \log P(obs |\alpha, \theta)</code> where
</p>
<p><code class="reqn">Q = \prod_i [Dirichlet(\lambda_i|\phi_i) \prod_j^J \prod_r^{R_j} \prod_n^{N_{i,j,r}}Multinomial(Z_{i,j,r,n}|\delta_{i,j,r,n})]</code>
</p>
<p>The left hand side of the above equation is often referred to as the Evidence Lower Bound (ELBO). The global parameters
<code class="reqn">\alpha</code> and <code class="reqn">\theta</code> are selected to maximize this bound as a psuedo-MLE procedure. In addition, it can be shown that
maximizing the ELBO with respect to the variational parameters <code class="reqn">\phi</code> and <code class="reqn">\delta</code> is equivalent to
minimizing the KL divergence between the tractable variational distribution and the true posterior.
</p>
<p>The method uses a variational EM approach. The E-step considers the global parameters <code class="reqn">\alpha</code> and <code class="reqn">\theta</code> fixed
and picks appropriate variational parameters <code class="reqn">\phi</code> and <code class="reqn">\delta</code> to minimize the KL divergence between the
true posterior and the variational distribution (or maximize the ELBO). The M-step considers
the variational parameters  fixed and global parameters <code class="reqn">\theta</code> and <code class="reqn">\alpha</code> are selected which maximize the lower bound
on the log-likelihood (ELBO).
</p>


<h3>Value</h3>

<p><code>mmVarFit</code> returns a <code>mixedMemModel</code> object containing updated variational parameters and global parameters.
</p>


<h3>References</h3>

<p>Beal, Matthew James. Variational algorithms for approximate Bayesian inference. Diss. University of London, 2003.
</p>


<h3>See Also</h3>

<p>mixedMemModel
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## The following example generates multivariate observations (both variables are multinomial)
## from a mixed membership model. The observed data is then used to fit a
## mixed membership model using mmVarFit

## Generate Data
Total &lt;- 30 #30 Individuals
J &lt;- 2 # 2 variables
dist &lt;- rep("multinomial",J) # both variables are multinomial
Rj &lt;- rep(100,J) # 100 repititions for each variable
# Nijr will always be 1 for multinomials and bernoulli's
Nijr &lt;- array(1, dim = c(Total, J, max(Rj)))
K &lt;- 4 # 4 sub-populations
alpha &lt;- rep(.5, K) # hyperparameter for dirichlet distribution
Vj &lt;- rep(5, J) # each multinomial has 5 categories
theta &lt;- array(0, dim = c(J, K, max(Vj)))
theta[1,,] &lt;- gtools::rdirichlet(K, rep(.3, 5))
theta[2,,] &lt;- gtools::rdirichlet(K, rep(.3, 5))
obs &lt;- rmixedMem(Total, J, Rj, Nijr, K, Vj, dist, theta, alpha)$obs

## Initialize a mixedMemModel object
test_model &lt;- mixedMemModel(Total = Total, J = J,Rj = Rj, Nijr= Nijr,
 K = K, Vj = Vj,dist = dist, obs = obs,
  alpha = alpha, theta = theta+0)

## Fit the mixed membership model
out &lt;-mmVarFit(test_model)
</code></pre>

<hr>
<h2 id='permuteLabels'>Mixed Membership Post-Processing</h2><span id='topic+permuteLabels'></span>

<h3>Description</h3>

<p>Mixed Membership models are invariant to permutations of the sub-population labels; swapping the names of each sub-population yields an equivalent model.
The ordering of the labels in a fitted model is dependent on the initialization points of the variational EM algorithim.
The <code>permuteLabels</code> function returns a <code>mixedMemModel</code> object where the labels (for <code class="reqn">\theta</code>, <code class="reqn">\phi</code>, <code class="reqn">\delta</code> and <code class="reqn">\alpha</code>) have been permuted
according a given permutation of the integers 1 through K. The <code>findLabels</code> function can be used to find a permutation of the labels which
most closely matches another fitted model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>permuteLabels(model, perm)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="permuteLabels_+3A_model">model</code></td>
<td>
<p>a fitted <code>mixedMemModel</code> object which will be relabeled.</p>
</td></tr>
<tr><td><code id="permuteLabels_+3A_perm">perm</code></td>
<td>
<p>a vector of length K with integers 1:K. This is the permutation by which to relabel the <code>mixedMemModel</code> object such that
group i in the returned mixedMemModel object corresponds to group <code>perm</code>[i] from the input mixedMemModel object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>permuteLabels</code> returns a <code>mixedMemModel</code> object such that
group i in the returned <code>mixedMemModel</code> object corresponds to group perm[i] from the input <code>mixedMemModel</code> object
</p>


<h3>See Also</h3>

<p>findLabels
</p>

<hr>
<h2 id='plot.mixedMemModel'>Plot a Mixed Membership Model</h2><span id='topic+plot.mixedMemModel'></span>

<h3>Description</h3>

<p>Generic S3 function to produce visual representation of a <code>mixedMemModel</code> object. This function calls either the <code>vizTheta</code> or
the <code>vizMem</code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mixedMemModel'
plot(x, type = "theta", compare = NULL,
  main = NULL, varNames = NULL, groupNames = NULL, nrow = NULL,
  ncol = NULL, indices = NULL, fitNames = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.mixedMemModel_+3A_x">x</code></td>
<td>
<p>the <code>mixedMemModel</code> object to be plotted.</p>
</td></tr>
<tr><td><code id="plot.mixedMemModel_+3A_type">type</code></td>
<td>
<p>a string which indicates which estimated parameters to plot; valid options are &quot;theta&quot; or &quot;membership&quot;.
<code>vizTheta</code> is called when the type is &quot;theta&quot; and <code>vizMem</code> is called when the type is &quot;membership&quot;.</p>
</td></tr>
<tr><td><code id="plot.mixedMemModel_+3A_compare">compare</code></td>
<td>
<p>an array or matrix for comparison. When type = &quot;theta&quot;, <code>compare</code> should be an array the same size as x$theta.
When type = &quot;membership&quot;, <code>compare</code> should be a matrix the same size as x$phi.</p>
</td></tr>
<tr><td><code id="plot.mixedMemModel_+3A_main">main</code></td>
<td>
<p>the main figure title.</p>
</td></tr>
<tr><td><code id="plot.mixedMemModel_+3A_varnames">varNames</code></td>
<td>
<p>a vector of strings corresponding to names for each variable if plot type is theta.</p>
</td></tr>
<tr><td><code id="plot.mixedMemModel_+3A_groupnames">groupNames</code></td>
<td>
<p>a vector of strings corresponding to labels for each sub-population.</p>
</td></tr>
<tr><td><code id="plot.mixedMemModel_+3A_nrow">nrow</code></td>
<td>
<p>the number of rows for the grid of plots.</p>
</td></tr>
<tr><td><code id="plot.mixedMemModel_+3A_ncol">ncol</code></td>
<td>
<p>the number of columns for the grid of plots. If plot type is &quot;theta&quot;, this
must be K, if plot type is  &quot;membership&quot;, this must be a positive integer.</p>
</td></tr>
<tr><td><code id="plot.mixedMemModel_+3A_indices">indices</code></td>
<td>
<p>a vector of integers. If the plot type is  &quot;membership&quot;, this indicates which individuals to plot.
When plot type is  &quot;theta&quot;, this indicates which variables to plot.</p>
</td></tr>
<tr><td><code id="plot.mixedMemModel_+3A_fitnames">fitNames</code></td>
<td>
<p>a vector of strings corresponding to labels for each fit.</p>
</td></tr>
<tr><td><code id="plot.mixedMemModel_+3A_...">...</code></td>
<td>
<p>additional parameters to be passed.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>mixedMemModel, vizTheta, vizMem
</p>

<hr>
<h2 id='rmixedMem'>Simulate Mixed Membership Data</h2><span id='topic+rmixedMem'></span>

<h3>Description</h3>

<p>Simulate data from a mixed membership model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rmixedMem(Total, J, Rj, Nijr, K, Vj, dist, theta, alpha, lambda = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rmixedMem_+3A_total">Total</code></td>
<td>
<p>the number of individuals in the sample.</p>
</td></tr>
<tr><td><code id="rmixedMem_+3A_j">J</code></td>
<td>
<p>the number of variables observed on each individual.</p>
</td></tr>
<tr><td><code id="rmixedMem_+3A_rj">Rj</code></td>
<td>
<p>a vector of positive integers of length <code>J</code> specifying the number of repeated measurements
for each variable.</p>
</td></tr>
<tr><td><code id="rmixedMem_+3A_nijr">Nijr</code></td>
<td>
<p>an array of dimension (<code>Total</code>, <code>J</code>, <code>max(Rj)</code>) indicating the number
of ranking levels for each replication. For multinomial and Bernoulli
variables, <code>Nijr</code>[i,j,r] = 1. For rank variables, <code>Nijr</code>[i,j,r] indicates the
number of items ranked for each individual.</p>
</td></tr>
<tr><td><code id="rmixedMem_+3A_k">K</code></td>
<td>
<p>the number of latent sub-populations.</p>
</td></tr>
<tr><td><code id="rmixedMem_+3A_vj">Vj</code></td>
<td>
<p>a vector of length <code>J</code> specifying the number of possible candidates
for each variable. For a Bernoulli variable <code>Vj</code>[j] = 1. For a multinomial
or rank variable, <code>Vj</code>[j] is the number of possible categories/items.</p>
</td></tr>
<tr><td><code id="rmixedMem_+3A_dist">dist</code></td>
<td>
<p>a vector of strings of length <code>J</code> specifying variable types. Options are
&quot;bernoulli&quot;, &quot;multinomial&quot; or &quot;rank&quot; corresponing to the distributions
of the observed variables.</p>
</td></tr>
<tr><td><code id="rmixedMem_+3A_theta">theta</code></td>
<td>
<p>an 3 way array of dimensions (<code>J</code>,<code>K</code>,<code>max(Vj)</code>) which governs the variable
distributions. Parameter <code>theta</code>[j,k,] governs the distirbution of responses on variable j for an inidvidually completely in sub-population k.
If the number of items/categories differs across variables, any
unusued portions of <code>theta</code> should be set to 0.</p>
</td></tr>
<tr><td><code id="rmixedMem_+3A_alpha">alpha</code></td>
<td>
<p>a positive <code>K</code>-length vector  which is the parameter for the Dirichlet
distribution of membership scores.</p>
</td></tr>
<tr><td><code id="rmixedMem_+3A_lambda">lambda</code></td>
<td>
<p>an optional matrix of dimensions (<code>Total</code>, <code>K</code>) containing the membership scores for each individual. If the <code>lambda</code>
argument is not specified, the group membership scores will be automatically sampled from a Dirichlet(<code>alpha</code>)</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>rmixedMem</code> simulates data from a mixed membership model given the specified parameters and dimensions. The function
returns a random sample of observations <code>obs</code>, context indicators <code>Z</code>, and group membership scores <code>lambda</code>.
</p>


<h3>Value</h3>

<p><code>rmixedMem</code> returns a list containing a three items: A matrix of group memberships scores <code>lambda</code>,
an array of context indicators <code>Z</code> and an array of observations <code>obs</code>.
</p>

<hr>
<h2 id='summary.mixedMemModel'>Summary of a Mixed Membership Model</h2><span id='topic+summary.mixedMemModel'></span>

<h3>Description</h3>

<p>Generic S3 summary function for <code>mixedMemModel</code> class.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mixedMemModel'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.mixedMemModel_+3A_object">object</code></td>
<td>
<p>the mixedMemModel object to be summarized</p>
</td></tr>
<tr><td><code id="summary.mixedMemModel_+3A_...">...</code></td>
<td>
<p>additional parameters</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>summary</code> provides a summary of the given <code>mixedMemModel</code> object. The function
prints the ELBO, the dimensions of the model and each variable type.
</p>


<h3>See Also</h3>

<p>mixedMemModel
</p>

<hr>
<h2 id='vizMem'>Mixed Membership Visualization</h2><span id='topic+vizMem'></span>

<h3>Description</h3>

<p><code>vizMem</code> plots estimates for the group membership scores of each individual. This is the function called by the <code>mixedMemModel</code> class
generic plot function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vizMem(model, compare = NULL, main = "Estimated Membership", nrow = NULL,
  ncol = NULL, indices = NULL, groupNames = NULL, fitNames = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="vizMem_+3A_model">model</code></td>
<td>
<p>the <code>mixedMemModel</code> object that will be plotted.</p>
</td></tr>
<tr><td><code id="vizMem_+3A_compare">compare</code></td>
<td>
<p>a matrix of the same dimensions as <code>model$phi</code> which contains parameters to compare
against the fitted model.</p>
</td></tr>
<tr><td><code id="vizMem_+3A_main">main</code></td>
<td>
<p>the main figure title.</p>
</td></tr>
<tr><td><code id="vizMem_+3A_nrow">nrow</code></td>
<td>
<p>the number of rows in each plot.</p>
</td></tr>
<tr><td><code id="vizMem_+3A_ncol">ncol</code></td>
<td>
<p>the number of columns in each plot.</p>
</td></tr>
<tr><td><code id="vizMem_+3A_indices">indices</code></td>
<td>
<p>the specific individuals which will be shown in the plot. If the argument is left blank, all individuals will be plotted.
If the number of individuals to be plotted is larger than <code>nrow * ncol</code> then multiple plots will be produced.</p>
</td></tr>
<tr><td><code id="vizMem_+3A_groupnames">groupNames</code></td>
<td>
<p>a vector specifying labels for each sub-population.</p>
</td></tr>
<tr><td><code id="vizMem_+3A_fitnames">fitNames</code></td>
<td>
<p>a vector of length 2 containing strings which correspond to the names of the models (fitted and comparison).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The estimates plotted are the normalized <code class="reqn">\phi</code>, which are the posterior means from the variational distribution. The
estimated group membership scores are  shown in black, and the estimates from a comparison model (if available) are shown in red. Each plot
represents an individual.
</p>
<p>This is the function called by the plot generic function for mixedMemModel objects.
</p>

<hr>
<h2 id='vizTheta'>Mixed Membership Visualization</h2><span id='topic+vizTheta'></span>

<h3>Description</h3>

<p><code>vizTheta</code> plots <code class="reqn">\theta</code>, the parameters which govern the sub-population distributions of variables in a mixed membership model.
The parameter <code class="reqn">\theta_{j,k}</code> specifies the distribution of variable j for complete members of sub-population k. The estimated
parameters from the given model are shown in black in each plot; the parameters from a comparison model (if available) are shown in red.
Each row of plots represents a single variable, and each column of the plots represents a sub-population.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vizTheta(model, compare = NULL, main = "Estimated Theta", varNames = NULL,
  groupNames = NULL, nrow = NULL, fitNames = NULL, indices = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="vizTheta_+3A_model">model</code></td>
<td>
<p>the <code>mixedMemModel</code> object that will be plotted.</p>
</td></tr>
<tr><td><code id="vizTheta_+3A_compare">compare</code></td>
<td>
<p>an array of the same dimensions as model$theta which contains values to compare against the fitted value.</p>
</td></tr>
<tr><td><code id="vizTheta_+3A_main">main</code></td>
<td>
<p>the main figure title.</p>
</td></tr>
<tr><td><code id="vizTheta_+3A_varnames">varNames</code></td>
<td>
<p>a vector of strings specifying labels for each variable.</p>
</td></tr>
<tr><td><code id="vizTheta_+3A_groupnames">groupNames</code></td>
<td>
<p>a vector of strings specifying labels for each sub-population.</p>
</td></tr>
<tr><td><code id="vizTheta_+3A_nrow">nrow</code></td>
<td>
<p>the number of rows in each plot. If the argument is not specified, all variables will appear in one plot.</p>
</td></tr>
<tr><td><code id="vizTheta_+3A_fitnames">fitNames</code></td>
<td>
<p>the names of the models plotted.</p>
</td></tr>
<tr><td><code id="vizTheta_+3A_indices">indices</code></td>
<td>
<p>a vector which indicates specific variables to plot. If the argument is not specified, all variables will be plotted. If the number of variables
to plot is greater than nrow, then multiple plots will be produced.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is the function called by the plot generic function for <code>mixedMemModel</code> objects.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
