<!DOCTYPE html><html lang="en"><head><title>Help for package MIAmaxent</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {MIAmaxent}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#MIAmaxent-package'><p>MIAmaxent: A Modular, Integrated Approach to Maximum Entropy Distribution Modeling</p></a></li>
<li><a href='#calculateRVA'><p>Calculates variable contributions as RVA</p></a></li>
<li><a href='#chooseModel'><p>Trains a model containing the explanatory variables specified.</p></a></li>
<li><a href='#deriveVars'><p>Derive variables by transformation.</p></a></li>
<li><a href='#modelFromLambdas'><p>Maxent model from .lambdas file.</p></a></li>
<li><a href='#plotFOP'><p>Plot Frequency of Observed Presence (FOP).</p></a></li>
<li><a href='#plotResp'><p>Plot model response.</p></a></li>
<li><a href='#predict.MIAmaxent_iwlr'><p>Predict method for infinitely-weighted logistic regression</p></a></li>
<li><a href='#projectModel'><p>Project model across explanatory data.</p></a></li>
<li><a href='#readData'><p>Read in data object from files.</p></a></li>
<li><a href='#release_questions'><p>Reminders when using devtools::release</p></a></li>
<li><a href='#selectDVforEV'><p>Select parsimonious sets of derived variables.</p></a></li>
<li><a href='#selectEV'><p>Select parsimonious set of explanatory variables.</p></a></li>
<li><a href='#testAUC'><p>Calculate model AUC with test data.</p></a></li>
<li><a href='#toydata_dvs'><p>Derived variables and transformation functions, from toy data.</p></a></li>
<li><a href='#toydata_seldvs'><p>Selected derived variables accompanied by selection trails, from toy data.</p></a></li>
<li><a href='#toydata_selevs'><p>Selected explanatory variables accompanied by selection trails, from toy</p>
data.</a></li>
<li><a href='#toydata_sp1po'><p>Occurrence and environmental toy data.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>A Modular, Integrated Approach to Maximum Entropy Distribution
Modeling</td>
</tr>
<tr>
<td>Version:</td>
<td>1.3.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Tools for training, selecting, and evaluating maximum entropy
    (and standard logistic regression) distribution models. This package 
    provides tools for user-controlled transformation of explanatory variables, 
    selection of variables by nested model comparison, and flexible model 
    evaluation and projection. It follows principles based on the maximum-
    likelihood interpretation of maximum entropy modeling, and uses infinitely-
    weighted logistic regression for model fitting. The package is described in 
    Vollering et al. (2019; &lt;<a href="https://doi.org/10.1002%2Fece3.5654">doi:10.1002/ece3.5654</a>&gt;).</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/julienvollering/MIAmaxent">https://github.com/julienvollering/MIAmaxent</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/julienvollering/MIAmaxent/issues">https://github.com/julienvollering/MIAmaxent/issues</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr (&ge; 0.4.3), e1071 (&ge; 1.6-7), graphics, terra, rlang,
stats, utils</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, R.rsp</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>R.rsp</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-08-23 10:02:04 UTC; julienv</td>
</tr>
<tr>
<td>Author:</td>
<td>Julien Vollering [aut, cre],
  Sabrina Mazzoni [aut],
  Rune Halvorsen [aut],
  Steven Phillips [cph],
  Michael Bedward [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Julien Vollering &lt;julienvollering@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-08-23 10:20:04 UTC</td>
</tr>
</table>
<hr>
<h2 id='MIAmaxent-package'>MIAmaxent: A Modular, Integrated Approach to Maximum Entropy Distribution Modeling</h2><span id='topic+MIAmaxent'></span><span id='topic+MIAmaxent-package'></span>

<h3>Description</h3>

<p>Tools for training, selecting, and evaluating maximum entropy (and standard logistic regression) distribution models. This package provides tools for user-controlled transformation of explanatory variables, selection of variables by nested model comparison, and flexible model evaluation and projection. It follows principles based on the maximum- likelihood interpretation of maximum entropy modeling, and uses infinitely- weighted logistic regression for model fitting. The package is described in Vollering et al. (2019; <a href="https://doi.org/10.1002/ece3.5654">doi:10.1002/ece3.5654</a>).
</p>


<h3>Details</h3>

<p>MIAmaxent is intended primarily for maximum entropy
distribution modeling (Phillips et al., 2006; Phillips et al., 2017), and
provides an alternative to the standard methodology for training,
selecting, and using models. The major advantage in this alternative
methodology is greater user control &ndash; in variable transformations, in
variable selection, and in model output. Comparisons also suggest that this
methodology results in simpler models with equally good predictive ability,
and reduces the risk of overfitting (Halvorsen et al., 2016).
</p>
<p>The predecessor to this package is the MIA Toolbox, which is described in
detail in Mazzoni et al. (2015).
</p>


<h3>Workflow</h3>

<p>The diagram below outlines a common workflow for users of
the package. Function names are in red.
</p>
<p><img src="../help/figures/workflow-flowchart.png" width="70%"   alt="Figure: workflow-flowchart.png" />

</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Julien Vollering <a href="mailto:julienvollering@gmail.com">julienvollering@gmail.com</a>
</p>
<p>Authors:
</p>

<ul>
<li><p> Sabrina Mazzoni
</p>
</li>
<li><p> Rune Halvorsen
</p>
</li></ul>

<p>Other contributors:
</p>

<ul>
<li><p> Steven Phillips [copyright holder]
</p>
</li>
<li><p> Michael Bedward [contributor]
</p>
</li></ul>



<h3>References</h3>

<p>Fithian, W., &amp; Hastie, T. (2013). Finite-sample equivalence in
statistical models for presence-only data. The annals of applied
statistics, 7(4), 1917.
</p>
<p>Halvorsen, R., Mazzoni, S., Bryn, A. &amp; Bakkestuen, V. (2015)
Opportunities for improved distribution modelling practice via a strict
maximum likelihood interpretation of MaxEnt. Ecography, 38, 172-183.
</p>
<p>Halvorsen, R., Mazzoni, S., Dirksen, J.W., Næsset, E., Gobakken,
T. &amp; Ohlson, M. (2016) How important are choice of model selection method
and spatial autocorrelation of presence data for distribution modelling by
MaxEnt? Ecological Modelling, 328, 108-118.
</p>
<p>Mazzoni, S., Halvorsen, R. &amp; Bakkestuen, V. (2015) MIAT: Modular
R-wrappers for flexible implementation of MaxEnt distribution modelling.
Ecological Informatics, 30, 215-221.
</p>
<p>Phillips, S.J., Anderson, R.P., Dudík, M., Schapire, R.E., &amp;
Blair, M.E. (2017). Opening the black box: an open-source release of
Maxent. Ecography, 40(7), 887-893.
</p>
<p>Phillips, S.J., Anderson, R.P. &amp; Schapire, R.E. (2006) Maximum
entropy modeling of species geographic distributions. Ecological Modelling,
190, 231-259.
</p>
<p>Vollering, J., Halvorsen, R., &amp; Mazzoni, S. (2019) The MIAmaxent
R package: Variable transformation and model selection for species
distribution models. Ecology and Evolution, 9(21), 12051–12068.
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/julienvollering/MIAmaxent">https://github.com/julienvollering/MIAmaxent</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/julienvollering/MIAmaxent/issues">https://github.com/julienvollering/MIAmaxent/issues</a>
</p>
</li></ul>


<hr>
<h2 id='calculateRVA'>Calculates variable contributions as RVA</h2><span id='topic+calculateRVA'></span>

<h3>Description</h3>

<p>Calculates the Relative Variation Accounted for (Halvorsen et al.
2015), for the selected model or a chosen model from the results of
<code><a href="#topic+selectEV">selectEV</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculateRVA(selectedEV, formula = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calculateRVA_+3A_selectedev">selectedEV</code></td>
<td>
<p>The list returned by <code>selectEV</code>.</p>
</td></tr>
<tr><td><code id="calculateRVA_+3A_formula">formula</code></td>
<td>
<p>If null, RVA is calculated for the selected model in
<code>selectedEV</code>. Otherwise, a model formula (in the form ~ x + ...)
specifying a model in the trail of forward selection
(<code>selectEV$selection</code>) for which to calculate RVA. Response variable
is irrelevant.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Halvorsen, R., Mazzoni, S., Bryn, A., &amp; Bakkestuen, V. (2015).
Opportunities for improved distribution modelling practice via a strict
maximum likelihood interpretation of MaxEnt. Ecography, 38(2), 172-183.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# From vignette:
calculateRVA(grasslandEVselect, formula("~ prbygall + geoberg + lcucor1 +
tertpi09 + geolmja1"))

## End(Not run)

</code></pre>

<hr>
<h2 id='chooseModel'>Trains a model containing the explanatory variables specified.</h2><span id='topic+chooseModel'></span>

<h3>Description</h3>

<p><code>chooseModel</code> trains a model based on the formula provided. The formula
specifies which explanatory variables (EVs) &mdash; and potentially first-order
interactions between these &mdash; should be included in the model. Each EV can
be represented by 1 or more derived variables (see <code><a href="#topic+deriveVars">deriveVars</a></code>).
The function may be employed to choose a model from the selection pathway of
<code><a href="#topic+selectEV">selectEV</a></code> other than the model selected under the provided alpha
value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chooseModel(dvdata, formula, algorithm = "maxent")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="chooseModel_+3A_dvdata">dvdata</code></td>
<td>
<p>A list containing first the response variable, followed by data
frames of <em>selected</em> derived variables for a given explanatory
variable (e.g. the first item in the list returned by
<code><a href="#topic+selectDVforEV">selectDVforEV</a></code>).</p>
</td></tr>
<tr><td><code id="chooseModel_+3A_formula">formula</code></td>
<td>
<p>A model formula (in the form y ~ x + ...) specifying the
independent terms (EVs) to be included in the model. The item in
<code>dvdata</code> is still taken as the response variable, regardless of
<code>formula</code>.</p>
</td></tr>
<tr><td><code id="chooseModel_+3A_algorithm">algorithm</code></td>
<td>
<p>Character string matching either &quot;maxent&quot; or &quot;LR&quot;, which
determines the type of model built. Default is &quot;maxent&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Explanatory variables should be uniquely named. Underscores ('_') and colons
(':') are reserved to denote derived variables and interaction terms
respectively, and <code>chooseModel</code> will replace these &mdash; along with other
special characters &mdash; with periods ('.').
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# From vignette:
grasslandmodel &lt;- chooseModel(grasslandDVselect$dvdata,
                              formula("~ pr.bygall + geoberg + lcucor1 +
                                      tertpi09 + geolmja1"))

## End(Not run)

</code></pre>

<hr>
<h2 id='deriveVars'>Derive variables by transformation.</h2><span id='topic+deriveVars'></span>

<h3>Description</h3>

<p><code>deriveVars</code> produces derived variables from explanatory variables by
transformation, and returns a list of dataframes. The available
transformation types are as follows, described in Halvorsen et al. (2015): L,
M, D, HF, HR, T (for continuous EVs), and B (for categorical EVs). For spline
transformation types (HF, HR, T),  a subset of possible DVs is pre-selected
by the criteria described under Details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>deriveVars(
  data,
  transformtype = c("L", "M", "D", "HF", "HR", "T", "B"),
  allsplines = FALSE,
  algorithm = "maxent",
  write = FALSE,
  dir = NULL,
  quiet = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="deriveVars_+3A_data">data</code></td>
<td>
<p>Data frame containing the response variable in the first column
and explanatory variables in subsequent columns. The response variable
should represent either presence and background (coded as 1/NA) or presence
and absence (coded as 1/0). The explanatory variable data should be
complete (no NAs). See <code><a href="#topic+readData">readData</a></code>.</p>
</td></tr>
<tr><td><code id="deriveVars_+3A_transformtype">transformtype</code></td>
<td>
<p>Specifies the types of transformations types to be
performed. Default is the full set of the following transformation types: L
(linear), M (monotone), D (deviation), HF (forward hinge), HR (reverse
hinge), T (threshold), and B (binary).</p>
</td></tr>
<tr><td><code id="deriveVars_+3A_allsplines">allsplines</code></td>
<td>
<p>Logical. Keep all spline transformations created, rather
than pre-selecting particular splines based on fraction of total variation
explained.</p>
</td></tr>
<tr><td><code id="deriveVars_+3A_algorithm">algorithm</code></td>
<td>
<p>Character string matching either &quot;maxent&quot; or &quot;LR&quot;, which
determines the type of model used for spline pre-selection. See Details.</p>
</td></tr>
<tr><td><code id="deriveVars_+3A_write">write</code></td>
<td>
<p>Logical. Write the transformation functions to .Rdata file?
Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="deriveVars_+3A_dir">dir</code></td>
<td>
<p>Directory for file writing if <code>write = TRUE</code>. Defaults to the
working directory.</p>
</td></tr>
<tr><td><code id="deriveVars_+3A_quiet">quiet</code></td>
<td>
<p>Logical. Suppress progress messages from spline pre-selection?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The linear transformation &quot;L&quot; is a simple rescaling to the range [0, 1].
</p>
<p>The monotone transformation &quot;M&quot; performed is a zero-skew transformation
(Økland et al. 2001).
</p>
<p>The deviation transformation &quot;D&quot; is performed around an optimum EV value that
is found by looking at frequency of presence (see <code><a href="#topic+plotFOP">plotFOP</a></code>).
Three deviation transformations are created with different steepness and
curvature around the optimum.
</p>
<p>For spline transformations (&quot;HF&quot;, &quot;HR&quot;, and &quot;T&quot;), DVs are created around 20
different break points (knots) which span the range of the EV. Only DVs which
satisfy all of the following criteria are retained: </p>
 <ol>
<li><p> 3 &lt;=
knot &lt;= 18 (DVs with knots at the extremes of the EV are never retained).
</p>
</li>
<li><p> Chi-square test of the single-variable model from the given DV compared
to the null model gives a p-value &lt; 0.05. </p>
</li>
<li><p> The single-variable model
from the given DV shows a local maximum in fraction of variation explained
(D^2, sensu Guisan &amp; Zimmerman, 2000) compared to DVs from the neighboring 4
knots.</p>
</li></ol>
<p> The models used in this pre-selection procedure may be maxent models
(algorithm=&quot;maxent&quot;) or standard logistic regression models (algorithm=&quot;LR&quot;).
</p>
<p>For categorical variables, 1 binary derived variable (type &quot;B&quot;) is created
for each category.
</p>
<p>The maximum entropy algorithm (&quot;maxent&quot;) &mdash; which is implemented in
MIAmaxent as an infinitely-weighted logistic regression with presences added
to the background &mdash; is conventionally used with presence-only occurrence
data. In contrast, standard logistic regression (algorithm = &quot;LR&quot;), is
conventionally used with presence-absence occurrence data.
</p>
<p>Explanatory variables should be uniquely named. Underscores ('_') and colons
(':') are reserved to denote derived variables and interaction terms
respectively, and <code>deriveVars</code> will replace these &mdash; along with other
special characters &mdash; with periods ('.').
</p>


<h3>Value</h3>

<p>List of 2: </p>
 <ol>
<li><p> dvdata: List containing first the
response variable, followed data frames of derived variables produced for
each explanatory variable. This item is recommended as input for
<code>dvdata</code> in <code><a href="#topic+selectDVforEV">selectDVforEV</a></code>. </p>
</li>
<li><p> transformations: List
containing first the response variable, followed by all the transformation
functions used to produce the derived variables. </p>
</li></ol>



<h3>References</h3>

<p>Guisan, A., &amp; Zimmermann, N. E. (2000). Predictive habitat
distribution models in ecology. Ecological modelling, 135(2-3), 147-186.
</p>
<p>Halvorsen, R., Mazzoni, S., Bryn, A., &amp; Bakkestuen, V. (2015).
Opportunities for improved distribution modelling practice via a strict
maximum likelihood interpretation of MaxEnt. Ecography, 38(2), 172-183.
</p>
<p>Økland, R.H., Økland, T. &amp; Rydgren, K. (2001).
Vegetation-environment relationships of boreal spruce swamp forests in
Østmarka Nature Reserve, SE Norway. Sommerfeltia, 29, 1-190.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>toydata_dvs &lt;- deriveVars(toydata_sp1po, c("L", "M", "D", "HF", "HR", "T", "B"))
str(toydata_dvs$dvdata)
summary(toydata_dvs$transformations)

## Not run: 
# From vignette:
grasslandDVs &lt;- deriveVars(grasslandPO,
                           transformtype = c("L","M","D","HF","HR","T","B"))
summary(grasslandDVs$dvdata)
head(summary(grasslandDVs$transformations))
length(grasslandDVs$transformations)
plot(grasslandPO$terslpdg, grasslandDVs$dvdata$terslpdg$terslpdg_D2, pch=20,
     ylab="terslpdg_D2")
plot(grasslandPO$terslpdg, grasslandDVs$dvdata$terslpdg$terslpdg_M, pch=20,
     ylab="terslpdg_M")

## End(Not run)

</code></pre>

<hr>
<h2 id='modelFromLambdas'>Maxent model from .lambdas file.</h2><span id='topic+modelFromLambdas'></span>

<h3>Description</h3>

<p><code>modelFromLambdas</code> returns an R function for a given Maxent model, using
the .lambdas file produced by the MaxEnt program to parameterize the model.
The returned function gives predictions of the model in &quot;raw output&quot; format
from values of explanatory variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>modelFromLambdas(file, raw = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="modelFromLambdas_+3A_file">file</code></td>
<td>
<p>pathway to the .lambdas file of a given Maxent model</p>
</td></tr>
<tr><td><code id="modelFromLambdas_+3A_raw">raw</code></td>
<td>
<p>Logical. Should the function return raw Maxent output instead of
PRO?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>modelFromLambdas</code> function returns a Maxent model, in the form of a
function that calculates Maxent predictions for given values of explanatory
variables.
</p>
<p>Input to the function returned by <code>modelFromLambdas</code> are values of
explanatory variables in the model. The format of this input must be an array
(matrix or data frame) with m columns, and column names must match variable
names in the .lambdas file used to reproduce the model.
</p>


<h3>Value</h3>

<p>returns an R function (object).
</p>

<hr>
<h2 id='plotFOP'>Plot Frequency of Observed Presence (FOP).</h2><span id='topic+plotFOP'></span>

<h3>Description</h3>

<p><code>plotFOP</code> produces a Frequency of Observed Presence (FOP) plot for a
given explanatory variable. An FOP plot shows the rate of occurrence of the
response variable across intervals or levels of the explanatory variable. For
continuous variables, a local regression (&quot;loess&quot;) of the FOP values is added
to the plot as a line. Data density is plotted in the background (grey) to
help visualize where FOP values are more or less certain.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotFOP(
  data,
  EV,
  span = 0.5,
  intervals = NULL,
  ranging = FALSE,
  densitythreshold = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotFOP_+3A_data">data</code></td>
<td>
<p>Data frame containing the response variable in the first column
and explanatory variables in subsequent columns. The response variable
should represent either presence and background (coded as 1/NA) or presence
and absence (coded as 1/0). See Details for information regarding
implications of occurrence data type. See also <code><a href="#topic+readData">readData</a></code>.</p>
</td></tr>
<tr><td><code id="plotFOP_+3A_ev">EV</code></td>
<td>
<p>Name or column index of the explanatory variable in <code>data</code> for
which to calculate FOP.</p>
</td></tr>
<tr><td><code id="plotFOP_+3A_span">span</code></td>
<td>
<p>The proportion of FOP points included in the local regression
neighborhood. Should be between 0 and 1. Irrelevant for categorical EVs.</p>
</td></tr>
<tr><td><code id="plotFOP_+3A_intervals">intervals</code></td>
<td>
<p>Number of intervals into which the continuous EV is divided.
Defaults to the minimum of N/10 and 100. Irrelevant for categorical EVs.</p>
</td></tr>
<tr><td><code id="plotFOP_+3A_ranging">ranging</code></td>
<td>
<p>Logical. If <code>TRUE</code>, will range the EV scale to [0,1].
This is equivalent to plotting FOP over the linear transformation produced
by deriveVars. Irrelevant for categorical EVs.</p>
</td></tr>
<tr><td><code id="plotFOP_+3A_densitythreshold">densitythreshold</code></td>
<td>
<p>Numeric. Intervals containing fewer than this number
of observations will be represented with an open symbol in the plot.
Irrelevant for categorical EVs.</p>
</td></tr>
<tr><td><code id="plotFOP_+3A_...">...</code></td>
<td>
<p>Arguments to be passed to <code>plot</code> or <code>barplot</code> to control
the appearance of the plot. For example: </p>
 <ul>
<li> <p><code>lwd</code> for
line width </p>
</li>
<li> <p><code>cex.main</code> for size of plot title </p>
</li>
<li> <p><code>space</code>
for space between bars </p>
</li></ul>
</td></tr>
</table>


<h3>Details</h3>

<p>A list of the optimum EV value and a data frame containing the plotted data
is returned invisibly. Store invisibly returned output by assigning it to an
object.
</p>
<p>In the local regression (&quot;loess&quot;), the plotted FOP values are regressed
against their EV values. The points are weighted by the number of
observations they represent, such that an FOP value from an interval with
many observations is given more weight.
</p>
<p>For continuous variables, the returned value of 'EVoptimum' is based on the
loess-smoothed FOP values, such that a point maximum in FOP may not always be
considered the optimal value of EV.
</p>
<p>If the response variable in <code>data</code> represents presence/absence data, the
result is an empirical frequency of presence curve, rather than a observed
frequency of presence curve (see Støa et al. [2018], Sommerfeltia).
</p>


<h3>Value</h3>

<p>In addition to the graphical output, a list of 2: </p>
 <ol>
<li>
<p><code>EVoptimum</code>. The EV value (or level, for categorical EVs) at which FOP
is highest </p>
</li>
<li>  <p><code>FOPdata</code>. A data frame containing the plotted data.
Columns in this data frame represent the following: EV interval (&quot;int&quot;),
number of observations in the interval (&quot;n&quot;), mean EV value of the
observations in the interval (&quot;intEV&quot;), mean RV value of the observations
in the interval (&quot;intRV&quot;), and local regression predicted intRV (&quot;loess&quot;).
For categorical variables, only the level name (&quot;level&quot;), the number of
observations in the level (&quot;n&quot;), and the mean RV value of the level
(&quot;levelRV&quot;) are used.</p>
</li></ol>



<h3>References</h3>

<p>Støa, B., R. Halvorsen, S. Mazzoni, and V. I. Gusarov. (2018).
Sampling bias in presence-only data used for species distribution
modelling: theory and methods for detecting sample bias and its effects on
models. Sommerfeltia 38:1–53.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>FOPev11 &lt;- plotFOP(toydata_sp1po, 2)
FOPev12 &lt;- plotFOP(toydata_sp1po, "EV12", intervals = 8)
FOPev12$EVoptimum
FOPev12$FOPdata

## Not run: 
# From vignette:
teraspifFOP &lt;- plotFOP(grasslandPO, "teraspif")
terslpdgFOP &lt;- plotFOP(grasslandPO, "terslpdg")
terslpdgFOP &lt;- plotFOP(grasslandPO, "terslpdg", span = 0.75, intervals = 20)
terslpdgFOP
geobergFOP &lt;- plotFOP(grasslandPO, 10)
geobergFOP

## End(Not run)

</code></pre>

<hr>
<h2 id='plotResp'>Plot model response.</h2><span id='topic+plotResp'></span><span id='topic+plotResp2'></span>

<h3>Description</h3>

<p>Plots the response of a given model over any of the explanatory variables
(EVs) included in that model. For categorical variables, a bar plot is
returned rather than a line plot. Single-effect response curves show the
response of a model containing the explanatory variable of interest only,
while marginal effect response curves show the response of the model when all
other explanatory variables are held constant at their mean values (cf.
<code>plotResp</code>, <code>plotResp2</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotResp(model, transformations, EV, logscale = FALSE, ...)

plotResp2(model, transformations, EV, logscale = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotResp_+3A_model">model</code></td>
<td>
<p>The model for which the response is to be plotted. This may be
the object returned by <code><a href="#topic+chooseModel">chooseModel</a></code>, or the 'selectedmodel'
returned by <code><a href="#topic+selectEV">selectEV</a></code>.</p>
</td></tr>
<tr><td><code id="plotResp_+3A_transformations">transformations</code></td>
<td>
<p>Transformation functions used to create the derived
variables in the model. I.e. the 'transformations' returned by
<code><a href="#topic+deriveVars">deriveVars</a></code>. Equivalently, the full file pathway of the
'transformations.Rdata' file saved as a result of <code><a href="#topic+deriveVars">deriveVars</a></code>.</p>
</td></tr>
<tr><td><code id="plotResp_+3A_ev">EV</code></td>
<td>
<p>Character. Name of the explanatory variable for which the response
curve is to be plotted. Interaction terms not allowed.</p>
</td></tr>
<tr><td><code id="plotResp_+3A_logscale">logscale</code></td>
<td>
<p>Logical. Plot the common logarithm of PRO rather than PRO
itself.</p>
</td></tr>
<tr><td><code id="plotResp_+3A_...">...</code></td>
<td>
<p>Arguments to be passed to <code>plot</code> or <code>barplot</code> to control
the appearance of the plot. For example: </p>
 <ul>
<li> <p><code>lwd</code> for
line width </p>
</li>
<li> <p><code>cex.main</code> for size of plot title </p>
</li>
<li> <p><code>space</code>
for space between bars </p>
</li></ul>
</td></tr>
</table>


<h3>Functions</h3>


<ul>
<li> <p><code>plotResp()</code>: Plot single-effect model response.
</p>
</li>
<li> <p><code>plotResp2()</code>: Plot marginal-effect model response.
</p>
</li></ul>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# From vignette:
plotResp(grasslandmodel, grasslandDVs$transformations, "pr.bygall")
plotResp(grasslandmodel, grasslandDVs$transformations, "geolmja1")

plotResp2(grasslandmodel, grasslandDVs$transformations, "pr.bygall")

## End(Not run)

</code></pre>

<hr>
<h2 id='predict.MIAmaxent_iwlr'>Predict method for infinitely-weighted logistic regression</h2><span id='topic+predict.MIAmaxent_iwlr'></span>

<h3>Description</h3>

<p>Returns model predictions for new data in &quot;PRO&quot; or &quot;raw&quot; format.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'MIAmaxent_iwlr'
predict(object, newdata, type = "PRO", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict.MIAmaxent_iwlr_+3A_object">object</code></td>
<td>
<p>Model of class &quot;MIAmaxent_iwlr&quot;</p>
</td></tr>
<tr><td><code id="predict.MIAmaxent_iwlr_+3A_newdata">newdata</code></td>
<td>
<p>Data frame containing variables with which to predict</p>
</td></tr>
<tr><td><code id="predict.MIAmaxent_iwlr_+3A_type">type</code></td>
<td>
<p>Type of model output: &quot;PRO&quot; or &quot;raw&quot;</p>
</td></tr>
</table>

<hr>
<h2 id='projectModel'>Project model across explanatory data.</h2><span id='topic+projectModel'></span>

<h3>Description</h3>

<p><code>projectModel</code> calculates model predictions for any points where values
of the explanatory variables in the model are known. It can be used to get
model predictions for the training data, or to project the model to a new
space or time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>projectModel(
  model,
  transformations,
  data,
  clamping = FALSE,
  raw = FALSE,
  rescale = FALSE,
  filename = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="projectModel_+3A_model">model</code></td>
<td>
<p>The model to be projected. This may be the object returned by
<code><a href="#topic+chooseModel">chooseModel</a></code>, or the 'selectedmodel' returned by
<code><a href="#topic+selectEV">selectEV</a></code>.</p>
</td></tr>
<tr><td><code id="projectModel_+3A_transformations">transformations</code></td>
<td>
<p>Transformation functions used to create the derived
variables in the model. I.e. the 'transformations' returned by
<code><a href="#topic+deriveVars">deriveVars</a></code>. Equivalently, the full file pathway of the
'transformations.Rdata' file saved as a result of <code><a href="#topic+deriveVars">deriveVars</a></code>.</p>
</td></tr>
<tr><td><code id="projectModel_+3A_data">data</code></td>
<td>
<p>Data frame of all the explanatory variables (EVs) included in the
model (see <code><a href="#topic+readData">readData</a></code>). Alternatively, an object of class
'SpatRaster' containing rasters for all EVs included in the model. Column
or raster names must match EV names.</p>
</td></tr>
<tr><td><code id="projectModel_+3A_clamping">clamping</code></td>
<td>
<p>Logical. Do clamping <em>sensu</em> Phillips et al. (2006).
Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="projectModel_+3A_raw">raw</code></td>
<td>
<p>Logical. Return raw maxent output instead of probability ratio
output (PRO)? Default is FALSE. Irrelevant for &quot;LR&quot;-type models.</p>
</td></tr>
<tr><td><code id="projectModel_+3A_rescale">rescale</code></td>
<td>
<p>Logical. Linearly rescale model output (PRO or raw) with
respect to the projection <code>data</code>? This has implications for the
interpretation of output values with respect to reference values (e.g. PRO
= 1). See details. Irrelevant for &quot;LR&quot;-type models.</p>
</td></tr>
<tr><td><code id="projectModel_+3A_filename">filename</code></td>
<td>
<p>Full file pathway to write raster model predictions if
<code>data</code> is an object of class 'SpatRaster'. File format is inferred
from the filename extension as in <code>terra::writeRaster</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Missing data (NA) for a continuous variable will result in NA output for that
point. Missing data for a categorical variable is treated as belonging to
none of the categories.
</p>
<p>When <code>rescale = FALSE</code> the scale of the maxent model output (PRO or raw)
returned by this function is dependent on the data used to train the model.
For example, a location with PRO = 2 can be interpreted as having a
probability of presence twice as high as an average site in the
<em>training</em> data (Halvorsen, 2013, Halvorsen et al., 2015). When
<code>rescale = TRUE</code>, the output is linearly rescaled with respect to the
data onto which the model is projected. In this case, a location with PRO = 2
can be interpreted as having a probability of presence twice as high as an
average site in the <em>projection</em> data. Similarly, raw values are on a
scale which is dependent on the size of either the training data extent
(<code>rescale = FALSE</code>) or projection data extent (<code>rescale = TRUE</code>).
</p>


<h3>Value</h3>

<p>List of 2: </p>
 <ol>
<li><p> output: A data frame with the model
output in column 1 and the corresponding explanatory data in subsequent
columns, or a raster containing predictions if <code>data</code> is a SpatRaster.
</p>
</li>
<li><p> ranges: A list showing the range of <code>data</code> compared to the
training data, on a 0-1 scale.</p>
</li></ol>
<p> If <code>data</code> is a SpatRaster, the output
is also plotted.
</p>


<h3>References</h3>

<p>Halvorsen, R. (2013) A strict maximum likelihood explanation of
MaxEnt, and some implications for distribution modelling. Sommerfeltia, 36,
1-132.
</p>
<p>Halvorsen, R., Mazzoni, S., Bryn, A. &amp; Bakkestuen, V. (2015)
Opportunities for improved distribution modelling practice via a strict
maximum likelihood interpretation of MaxEnt. Ecography, 38, 172-183.
</p>
<p>Phillips, S.J., Anderson, R.P. &amp; Schapire, R.E. (2006) Maximum
entropy modeling of species geographic distributions. Ecological Modelling,
190, 231-259.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# From vignette:
EVfiles &lt;- c(list.files(system.file("extdata", "EV_continuous", package="MIAmaxent"),
                        full.names=TRUE),
             list.files(system.file("extdata", "EV_categorical", package="MIAmaxent"),
                        full.names=TRUE))
EVstack &lt;- rast(EVfiles)
names(EVstack) &lt;- gsub(".asc", "", basename(EVfiles))
grasslandPreds &lt;- projectModel(model = grasslandmodel,
                               transformations = grasslandDVs$transformations,
                               data = EVstack)
grasslandPreds

## End(Not run)

</code></pre>

<hr>
<h2 id='readData'>Read in data object from files.</h2><span id='topic+readData'></span>

<h3>Description</h3>

<p><code>readData</code> reads in occurrence data in CSV file format and environmental
data in ASCII or GeoTIFF raster file format and produces a data object which
can be used as the starting point for the functions in this package. This
function is intended to make reading in data easy for users familiar with the
maxent.jar program. It is emphasized that important considerations for data
preparation (e.g. cleaning, sampling bias removal, etc.) are not treated in
this package and must be dealt with separately!
</p>


<h3>Usage</h3>

<pre><code class='language-R'>readData(
  occurrence,
  contEV = NULL,
  catEV = NULL,
  maxbkg = 10000,
  PA = FALSE,
  XY = FALSE,
  duplicates = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="readData_+3A_occurrence">occurrence</code></td>
<td>
<p>Full pathway of the '.csv' file of occurrence data. The
first column of the CSV should code occurrence (see Details), while the
second and third columns should contain X and Y coordinates corresponding
to the raster coordinate system. The first row of the csv is read as a
header row.</p>
</td></tr>
<tr><td><code id="readData_+3A_contev">contEV</code></td>
<td>
<p>Pathway to a directory containing continuous environmental
variables in either '.asc' (ASCII) or '.tif' (GeoTIFF) file format.</p>
</td></tr>
<tr><td><code id="readData_+3A_catev">catEV</code></td>
<td>
<p>Pathway to a directory containing categorical environmental
variables in either '.asc' (ASCII) or '.tif' (GeoTIFF) file format.</p>
</td></tr>
<tr><td><code id="readData_+3A_maxbkg">maxbkg</code></td>
<td>
<p>Integer. Maximum number of grid cells randomly selected as
uninformed background locations for the response variable. Default is
10,000. Irrelevant for presence/absence data (<code>PA = TRUE</code>) and ignored
for presence-only data (<code>PA = FALSE</code>) if <code>occurrence</code> contains
'NA' values. See Details.</p>
</td></tr>
<tr><td><code id="readData_+3A_pa">PA</code></td>
<td>
<p>Logical. Does <code>occurrence</code> represent presence/absence data?
This argument affects how the values in <code>occurrence</code> are interpreted,
and controls what type of data object is produced. See Details.</p>
</td></tr>
<tr><td><code id="readData_+3A_xy">XY</code></td>
<td>
<p>Logical. Include XY coordinates in the output. May be useful for
spatial plotting. Note that coordinates included in the training data used
to build the model will be treated as explanatory variables.</p>
</td></tr>
<tr><td><code id="readData_+3A_duplicates">duplicates</code></td>
<td>
<p>Logical. Include each coordinate in <code>occurrence</code> as a
separate row in the output, even if multiple coordinates fall in the same
raster cell. If <code>TRUE</code>, a presence data point in a given cell does not
preclude absence data points in the same cell.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When <code>occurrence</code> represents presence-only data (<code>PA = FALSE</code>), all
rows with values other than 'NA' in column 1 of the CSV file are treated as
presence locations. If column 1 contains any values of 'NA', these rows are
treated as the uninformed background locations. Thus, 'NA' can be used to
specify a specific set of uninformed background locations if desired.
Otherwise uninformed background locations are randomly selected from the full
extent of the raster cells which are not already included as presence
locations. Only cells which contain data for all environmental variables are
retained as presence locations or selected as uninformed background
locations.
</p>
<p>When <code>occurrence</code> represents presence/absence data (<code>PA = TRUE</code>),
rows with value '0' in column 1 of the CSV are treated as absence locations,
rows with value 'NA' are excluded, and all other rows are treated as
presences. If <code>duplicates = FALSE</code>, raster cells containing both
presence and absence locations result in a single presence row.
</p>
<p>The names of the input raster files are used as the names of the explanatory
variables, so these files should be uniquely named. <code>readData</code> replaces
underscores '_', spaces ' ' and other special characters not allowed in names
with periods '.'. In MIAmaxent, underscores and colons are reserved to denote
derived variables and interaction terms, respectively.
</p>


<h3>Value</h3>

<p>Data frame with the Response Variable (RV) in the first column, and
Explanatory Variables (EVs) in subsequent columns. When <code>PA = FALSE</code>,
RV values are 1/NA, and when <code>PA = TRUE</code>, RV values are 1/0.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>toydata_sp1po &lt;- readData(system.file("extdata/sommerfeltia", "Sp1.csv", package = "MIAmaxent"),
   contEV = system.file("extdata/sommerfeltia", "EV_continuous", package = "MIAmaxent"))
toydata_sp1po

## Not run: 
# From vignette:
grasslandPO &lt;- readData(
 occurrence=system.file("extdata", "occurrence_PO.csv", package="MIAmaxent"),
  contEV=system.file("extdata", "EV_continuous", package="MIAmaxent"),
  catEV=system.file("extdata", "EV_categorical", package="MIAmaxent"),
  maxbkg=20000)
str(grasslandPO)

# From vignette:
grasslandPA &lt;- readData(
  occurrence = system.file("extdata", "occurrence_PA.csv", package="MIAmaxent"),
  contEV = system.file("extdata", "EV_continuous", package="MIAmaxent"),
  catEV = system.file("extdata", "EV_categorical", package="MIAmaxent"),
  PA = TRUE, XY = TRUE)
head(grasslandPA)
tail(grasslandPA)

## End(Not run)

</code></pre>

<hr>
<h2 id='release_questions'>Reminders when using devtools::release</h2><span id='topic+release_questions'></span>

<h3>Description</h3>

<p>Reminders when using devtools::release
</p>


<h3>Usage</h3>

<pre><code class='language-R'>release_questions()
</code></pre>

<hr>
<h2 id='selectDVforEV'>Select parsimonious sets of derived variables.</h2><span id='topic+selectDVforEV'></span>

<h3>Description</h3>

<p>For each explanatory variable (EV), <code>selectDVforEV</code> selects the
parsimonious set of derived variables (DV) which best explains variation in a
given response variable. The function uses a process of forward selection
based on comparison of nested models using inference tests. A DV is selected
for inclusion when, during nested model comparison, it accounts for a
significant amount of remaining variation, under the alpha value specified by
the user. See Halvorsen et al. (2015) for a more detailed explanation of the
forward selection procedure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>selectDVforEV(
  dvdata,
  alpha = 0.01,
  retest = FALSE,
  test = "Chisq",
  algorithm = "maxent",
  write = FALSE,
  dir = NULL,
  quiet = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="selectDVforEV_+3A_dvdata">dvdata</code></td>
<td>
<p>List containing first the response variable, followed by data
frames of derived variables produced for each explanatory variable (e.g.
the first item in the list returned by <code><a href="#topic+deriveVars">deriveVars</a></code>).</p>
</td></tr>
<tr><td><code id="selectDVforEV_+3A_alpha">alpha</code></td>
<td>
<p>Alpha-level used for inference testing in nested model
comparison. Default is 0.01.</p>
</td></tr>
<tr><td><code id="selectDVforEV_+3A_retest">retest</code></td>
<td>
<p>Logical. Test variables that do not meet the alpha criterion
in a given round in subsequent rounds? Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="selectDVforEV_+3A_test">test</code></td>
<td>
<p>Character string matching either &quot;Chisq&quot; or &quot;F&quot; to determine
which inference test is used in nested model comparison. The Chi-squared
test is implemented by stats::anova, while the F-test is implemented as
described in Halvorsen (2013, 2015). Default is &quot;Chisq&quot;.</p>
</td></tr>
<tr><td><code id="selectDVforEV_+3A_algorithm">algorithm</code></td>
<td>
<p>Character string matching either &quot;maxent&quot; or &quot;LR&quot;, which
determines the type of model used during forward selection. Default is
&quot;maxent&quot;.</p>
</td></tr>
<tr><td><code id="selectDVforEV_+3A_write">write</code></td>
<td>
<p>Logical. Write the trail of forward selection for each EV to
.csv file? Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="selectDVforEV_+3A_dir">dir</code></td>
<td>
<p>Directory for file writing if <code>write = TRUE</code>. Defaults to the
working directory.</p>
</td></tr>
<tr><td><code id="selectDVforEV_+3A_quiet">quiet</code></td>
<td>
<p>Suppress progress bar?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The F-test available in <code>selectDVforEV</code> is calculated using equation 59
in Halvorsen (2013).
</p>
<p>If using binary-type derived variables from <code><a href="#topic+deriveVars">deriveVars</a></code>, be
aware that a model including all of these DVs will be considered equal to the
the closest nested model, due to perfect multicollinearity (i.e. the dummy
variable trap).
</p>
<p>The maximum entropy algorithm (&quot;maxent&quot;) &mdash; which is implemented in
MIAmaxent as an infinitely-weighted logistic regression with presences added
to the background &mdash; is conventionally used with presence-only occurrence
data. In contrast, standard logistic regression (algorithm = &quot;LR&quot;), is
conventionally used with presence-absence occurrence data.
</p>
<p>Explanatory variables should be uniquely named. Underscores ('_') and colons
(':') are reserved to denote derived variables and interaction terms
respectively, and <code>selectDVforEV</code> will replace these &mdash; along with
other special characters &mdash; with periods ('.').
</p>


<h3>Value</h3>

<p>List of 2: </p>
 <ol>
<li><p> dvdata: A list containing first the
response variable, followed by data frames of <em>selected</em> DVs for each
EV. EVs with zero selected DVs are dropped. This item is recommended as
input for <code>dvdata</code> in <code><a href="#topic+selectEV">selectEV</a></code>. </p>
</li>
<li><p> selection: A list
of data frames, where each data frame shows the trail of forward selection
of DVs for a given EV. </p>
</li></ol>



<h3>References</h3>

<p>Halvorsen, R. (2013). A strict maximum likelihood explanation of
MaxEnt, and some implications for distribution modelling. Sommerfeltia, 36,
1-132.
</p>
<p>Halvorsen, R., Mazzoni, S., Bryn, A., &amp; Bakkestuen, V. (2015).
Opportunities for improved distribution modelling practice via a strict
maximum likelihood interpretation of MaxEnt. Ecography, 38(2), 172-183.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>toydata_seldvs &lt;- selectDVforEV(toydata_dvs$dvdata, alpha = 0.4)

## Not run: 
# From vignette:
grasslandDVselect &lt;- selectDVforEV(grasslandDVs$dvdata, alpha = 0.001)
summary(grasslandDVs$dvdata)
sum(sapply(grasslandDVs$dvdata[-1], length))
summary(grasslandDVselect$dvdata)
sum(sapply(grasslandDVselect$dvdata[-1], length))
grasslandDVselect$selection$terdem

## End(Not run)

</code></pre>

<hr>
<h2 id='selectEV'>Select parsimonious set of explanatory variables.</h2><span id='topic+selectEV'></span>

<h3>Description</h3>

<p><code>selectEV</code> selects the parsimonious set of explanatory variables (EVs)
which best explains variation in a given response variable (RV). Each EV can
be represented by 1 or more derived variables (see <code><a href="#topic+deriveVars">deriveVars</a></code>
and <code><a href="#topic+selectDVforEV">selectDVforEV</a></code>). The function uses a process of forward
selection based on comparison of nested models using inference tests. An EV
is selected for inclusion when, during nested model comparison, it accounts
for a significant amount of remaining variation, under the alpha value
specified by the user. See Halvorsen et al. (2015) for a more detailed
explanation of the forward selection procedure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>selectEV(
  dvdata,
  alpha = 0.01,
  retest = FALSE,
  interaction = FALSE,
  formula = NULL,
  test = "Chisq",
  algorithm = "maxent",
  write = FALSE,
  dir = NULL,
  quiet = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="selectEV_+3A_dvdata">dvdata</code></td>
<td>
<p>List containing first the response variable, followed by data
frames of <em>selected</em> derived variables for a given explanatory
variable (e.g. the first item in the list returned by
<code><a href="#topic+selectDVforEV">selectDVforEV</a></code>).</p>
</td></tr>
<tr><td><code id="selectEV_+3A_alpha">alpha</code></td>
<td>
<p>Alpha-level used in F-test comparison of models. Default is
0.01.</p>
</td></tr>
<tr><td><code id="selectEV_+3A_retest">retest</code></td>
<td>
<p>Logical. Test variables (or interaction terms) that do not meet
the alpha criterion in a given round in subsequent rounds? Default is
<code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="selectEV_+3A_interaction">interaction</code></td>
<td>
<p>Logical. Allow interaction terms between pairs of EVs?
Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="selectEV_+3A_formula">formula</code></td>
<td>
<p>A model formula (in the form y ~ x + ...) specifying a
starting point for forward model selection. The independent terms in the
formula will be included in the model regardless of explanatory power, and
must be represented in <code>dvdata</code>, while the remaining explanatory
variables in <code>dvdata</code> are candidates for selection. The first list
item in <code>dvdata</code> is still taken as the response variable, regardless
of <code>formula</code>. Default is <code>NULL</code>, meaning that forward selection
starts with zero selected variables.</p>
</td></tr>
<tr><td><code id="selectEV_+3A_test">test</code></td>
<td>
<p>Character string matching either &quot;Chisq&quot; or &quot;F&quot; to determine
which inference test is used in nested model comparison. The Chi-squared
test is implemented by stats::anova, while the F-test is implemented as
described in Halvorsen (2013, 2015). Default is &quot;Chisq&quot;.</p>
</td></tr>
<tr><td><code id="selectEV_+3A_algorithm">algorithm</code></td>
<td>
<p>Character string matching either &quot;maxent&quot; or &quot;LR&quot;, which
determines the type of model used during forward selection. Default is
&quot;maxent&quot;.</p>
</td></tr>
<tr><td><code id="selectEV_+3A_write">write</code></td>
<td>
<p>Logical. Write the trail of forward selection to .csv file?
Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="selectEV_+3A_dir">dir</code></td>
<td>
<p>Directory for file writing if <code>write = TRUE</code>. Defaults to the
working directory.</p>
</td></tr>
<tr><td><code id="selectEV_+3A_quiet">quiet</code></td>
<td>
<p>Logical. Suppress progress messages from EV-selection?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The F-test available in <code>selectEV</code> is calculated using equation 59 in
Halvorsen (2013).
</p>
<p>When <code>interaction = TRUE</code>, the forward selection procedure selects a
parsimonious group of individual EVs first, and then tests interactions
between EVs included in the model afterwards. Therefore, interactions are
only explored between terms which are individually explain a significant
amount of variation. When <code>interaction = FALSE</code>, interactions are not
considered. Practically, interactions between EVs are represented by the
products of all combinations of their component DVs (Halvorsen, 2013).
</p>
<p>The maximum entropy algorithm (&quot;maxent&quot;) &mdash; which is implemented in
MIAmaxent as an infinitely-weighted logistic regression with presences added
to the background &mdash; is conventionally used with presence-only occurrence
data. In contrast, standard logistic regression (algorithm = &quot;LR&quot;), is
conventionally used with presence-absence occurrence data.
</p>
<p>Explanatory variables should be uniquely named. Underscores ('_') and colons
(':') are reserved to denote derived variables and interaction terms
respectively, and <code>selectEV</code> will replace these &mdash; along with other
special characters &mdash; with periods ('.').
</p>


<h3>Value</h3>

<p>List of 3: </p>
 <ol>
<li><p> dvdata: A list containing first the
response variable, followed by data frames of DVs for each <em>selected</em>
EV. </p>
</li>
<li><p> selection: A data frame showing the trail of forward selection of
individual EVs (and interaction terms if necessary). </p>
</li>
<li><p> selectedmodel:
the selected model under the given alpha value.</p>
</li></ol>



<h3>References</h3>

<p>Halvorsen, R. (2013). A strict maximum likelihood explanation of
MaxEnt, and some implications for distribution modelling. Sommerfeltia, 36,
1-132.
</p>
<p>Halvorsen, R., Mazzoni, S., Bryn, A., &amp; Bakkestuen, V. (2015).
Opportunities for improved distribution modelling practice via a strict
maximum likelihood interpretation of MaxEnt. Ecography, 38(2), 172-183.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# From vignette:
grasslandEVselect &lt;- selectEV(grasslandDVselect$dvdata, alpha = 0.001,
                              interaction = TRUE)
summary(grasslandDVselect$dvdata)
length(grasslandDVselect$dvdata[-1])
summary(grasslandEVselect$dvdata)
length(grasslandEVselect$dvdata[-1])
grasslandEVselect$selectedmodel$formula

## End(Not run)

</code></pre>

<hr>
<h2 id='testAUC'>Calculate model AUC with test data.</h2><span id='topic+testAUC'></span>

<h3>Description</h3>

<p>For a given model, <code>testAUC</code> calculates the Area Under the Curve (AUC)
of the Receiver Operating Characteristic (ROC) as a threshold-independent
measure of binary classification performance. This function is intended to be
used with occurrence data that is independent from the data used to train the
model, to obtain an unbiased measure of model performance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>testAUC(model, transformations, data, plot = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="testAUC_+3A_model">model</code></td>
<td>
<p>The model to be projected. This may be the object returned by
<code><a href="#topic+chooseModel">chooseModel</a></code>, or the 'selectedmodel' returned by
<code><a href="#topic+selectEV">selectEV</a></code>.</p>
</td></tr>
<tr><td><code id="testAUC_+3A_transformations">transformations</code></td>
<td>
<p>Transformation functions used to create the derived
variables in the model. I.e. the 'transformations' returned by
<code><a href="#topic+deriveVars">deriveVars</a></code>. Equivalently, the full file pathway of the
'transformations.Rdata' file saved as a result of <code><a href="#topic+deriveVars">deriveVars</a></code>.</p>
</td></tr>
<tr><td><code id="testAUC_+3A_data">data</code></td>
<td>
<p>Data frame containing test occurrence data in the first column
and corresponding explanatory variables in the model in subsequent columns.
The test data should be coded as: 1/0/NA, representing presence, absence,
and uninformed. See <code><a href="#topic+readData">readData</a></code>.</p>
</td></tr>
<tr><td><code id="testAUC_+3A_plot">plot</code></td>
<td>
<p>Logical. Plot the ROC curve?</p>
</td></tr>
<tr><td><code id="testAUC_+3A_...">...</code></td>
<td>
<p>Arguments to be passed to <code>plot</code> to control the appearance of
the ROC plot. For example: </p>
 <ul>
<li> <p><code>lwd</code> for line width </p>
</li>
<li>
<p><code>main</code> for plot title </p>
</li>
<li> <p><code>cex</code> for plot text and symbol size </p>
</li></ul>

<p>Note that some graphical parameters may return errors or warnings if they
cannot be changed or correspond to multiple elements in the plot.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If plotted, the point along the ROC curve where the discrimination threshold
is PRO = 1, is shown for reference.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# From vignette:
grasslandPA &lt;- readData(
  occurrence = system.file("extdata", "occurrence_PA.csv", package="MIAmaxent"),
  contEV = system.file("extdata", "EV_continuous", package="MIAmaxent"),
  catEV = system.file("extdata", "EV_categorical", package="MIAmaxent"),
  PA = TRUE, XY = TRUE)
head(grasslandPA)
tail(grasslandPA)
testAUC(model = grasslandmodel, transformations = grasslandDVs$transformations,
        data = grasslandPA)

## End(Not run)

</code></pre>

<hr>
<h2 id='toydata_dvs'>Derived variables and transformation functions, from toy data.</h2><span id='topic+toydata_dvs'></span>

<h3>Description</h3>

<p>Derived variables and transformation functions for distribution modeling of a
small, synthetic data set used in Halvorsen (2013).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>toydata_dvs
</code></pre>


<h3>Format</h3>

<p>List with 2 elements: </p>
 <ol>
<li><p> A list of 5, with the response
variable followed by data frames each containing the derived variables
produced for a given explanatory variable. </p>
</li>
<li><p> A list of the response
variable and all the transformation functions used to produce the derived
variables. </p>
</li></ol>



<h3>Source</h3>

<p>Produced from <code><a href="#topic+toydata_sp1po">toydata_sp1po</a></code> using
<code><a href="#topic+deriveVars">deriveVars</a></code>.
</p>


<h3>References</h3>

<p>Halvorsen, R. (2013) A strict maximum likelihood explanation of
MaxEnt, and some implications for distribution modelling. Sommerfeltia, 36,
1-132.
</p>

<hr>
<h2 id='toydata_seldvs'>Selected derived variables accompanied by selection trails, from toy data.</h2><span id='topic+toydata_seldvs'></span>

<h3>Description</h3>

<p>Selected derived variables and tables showing forward model selection of
derived variables for distribution modeling of a small, synthetic data set
used in Halvorsen (2013).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>toydata_seldvs
</code></pre>


<h3>Format</h3>

<p>List with 2 elements: </p>
 <ol>
<li><p> A list of 3, with the
response variable followed by data frames each containing the derived
variables selected for a given explanatory variable. </p>
</li>
<li><p> A list of the
response variable and forward model selection trails used to select derived
variables. </p>
</li></ol>



<h3>Source</h3>

<p>Produced from <code><a href="#topic+toydata_dvs">toydata_dvs</a></code> using
<code><a href="#topic+selectDVforEV">selectDVforEV</a></code>.
</p>


<h3>References</h3>

<p>Halvorsen, R. (2013) A strict maximum likelihood explanation of
MaxEnt, and some implications for distribution modelling. Sommerfeltia, 36,
1-132.
</p>

<hr>
<h2 id='toydata_selevs'>Selected explanatory variables accompanied by selection trails, from toy
data.</h2><span id='topic+toydata_selevs'></span>

<h3>Description</h3>

<p>Selected explanatory variables and tables showing forward model selection of
explanatory variables for distribution modeling of a small, synthetic data
set used in Halvorsen (2013). Each individual explanatory variable is
represented by a group of derived variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>toydata_selevs
</code></pre>


<h3>Format</h3>

<p>List with 3 elements: </p>
 <ol>
<li><p> A list of 3, with the
response variable followed by data frames, represent selected explanatory
variables. </p>
</li>
<li><p> A trail of forward model selection used to select
explanatory variables and interaction terms. </p>
</li>
<li><p> The selected model </p>
</li></ol>



<h3>Source</h3>

<p>Produced from <code><a href="#topic+toydata_seldvs">toydata_seldvs</a></code> using
<code><a href="#topic+selectEV">selectEV</a></code>.
</p>


<h3>References</h3>

<p>Halvorsen, R. (2013) A strict maximum likelihood explanation of
MaxEnt, and some implications for distribution modelling. Sommerfeltia, 36,
1-132.
</p>

<hr>
<h2 id='toydata_sp1po'>Occurrence and environmental toy data.</h2><span id='topic+toydata_sp1po'></span>

<h3>Description</h3>

<p>A small, synthetic data set for distribution modeling, consisting of
occurrence and environmental data, from Halvorsen (2013). The study area
consists of 40 grid cells, with 8 row and 5 columns, in which 10 presences
occur.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>toydata_sp1po
</code></pre>


<h3>Format</h3>

<p>A data frame with 40 rows and 5 variables: </p>

<dl>
<dt>RV</dt><dd><p>response variable, occurrence either presence or uninformed
background</p>
</dd> <dt>EV11</dt><dd><p>explanatory variable: northing</p>
</dd>
<dt>EV12</dt><dd><p>explanatory variable: easting</p>
</dd> <dt>EV13</dt><dd><p>explanatory
variable: modified random uniform</p>
</dd> <dt>EV14</dt><dd><p>explanatory variable: random
uniform</p>
</dd> </dl>



<h3>Source</h3>

<p>Halvorsen, R. (2013) A strict maximum likelihood explanation of
MaxEnt, and some implications for distribution modelling. Sommerfeltia, 36,
1-132.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
