<!DOCTYPE html><html><head><title>Help for package GofCens</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {GofCens}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ADcens'><p>Anderson-Darling test for complete and right-censored data</p></a></li>
<li><a href='#chisqcens'><p>General chi-squared statistics for right-censored data.</p></a></li>
<li><a href='#cumhazPlot'><p>Cumulative hazard plots to check the goodness of fit of parametric models</p></a></li>
<li><a href='#CvMcens'><p>Cramér-von Mises test for complete and right-censored data</p></a></li>
<li><a href='#gofcens'><p>Kolmogorov-Smirnov, Cramér-von Mises, and Anderson-Darling statistics for</p>
complete and right-censored data</a></li>
<li><a href='#GofCens-package'><p>Goodness-of-Fit Methods for Complete and Right-Censored Data.</p></a></li>
<li><a href='#kmPlot'><p>Plot of the Kaplen-Meier and parametric estimations</p></a></li>
<li><a href='#KScens'><p>Kolmogorov-Smirnov test for complete and right-censored data</p></a></li>
<li><a href='#nba'><p>Survival times of former NBA players.</p></a></li>
<li><a href='#probPlot'><p>Probability plots to check the goodness of fit of parametric models</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Goodness-of-Fit Methods for Complete and Right-Censored Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.98</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-03-22</td>
</tr>
<tr>
<td>Description:</td>
<td>Graphical tools and goodness-of-fit tests for complete and right-censored data:
             1. Kolmogorov-Smirnov, Cramér-von Mises, and Anderson-Darling tests,
                which use the empirical distribution function for complete data 
                and are extended for right-censored data.
             2. Generalized chi-squared-type test, which is based on the squared 
                differences between observed and expected counts using random 
                cells with right-censored data.
             3. A series of graphical tools such as probability or cumulative hazard 
                plots to guide the decision about the most suitable parametric model 
                for the data.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), actuar</td>
</tr>
<tr>
<td>Imports:</td>
<td>survival, fitdistrplus, survsim, grid, ggplot2, gridExtra,
survminer, boot</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-03-22 17:25:35 UTC; klangohr</td>
</tr>
<tr>
<td>Author:</td>
<td>Klaus Langohr [aut, cre],
  Mireia Besalú [aut],
  Matilde Francisco [aut],
  Guadalupe Gómez [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Klaus Langohr &lt;klaus.langohr@upc.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-03-22 19:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='ADcens'>Anderson-Darling test for complete and right-censored data</h2><span id='topic+ADcens'></span>

<h3>Description</h3>

<p><code>ADcens</code> computes the Anderson-Darling test statistic and p-value for complete 
and right-censored data against eight possible distributions using bootstrapping.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ADcens(times, cens = rep(1, length(times)),
       distr = c("exponential", "gumbel", "weibull", "normal",
                 "lognormal", "logistic", "loglogistic", "beta"),
       betaLimits = c(0, 1), igumb = c(10, 10), degs = 3, BS = 999,
       params = list(shape = NULL, shape2 = NULL,
                     location = NULL, scale = NULL), 
       prnt = TRUE, outp = "list", tol = 1e-04)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ADcens_+3A_times">times</code></td>
<td>
<p>Numeric vector of times until the event of interest.</p>
</td></tr>
<tr><td><code id="ADcens_+3A_cens">cens</code></td>
<td>
<p>Status indicator (1, exact time; 0, right-censored time). If not 
provided, all times are assumed to be exact.</p>
</td></tr>
<tr><td><code id="ADcens_+3A_distr">distr</code></td>
<td>
<p>A string specifying the name of the distribution to be studied. 
The possible distributions are the exponential (<code>"exponential"</code>), 
the Weibull (<code>"weibull"</code>), the Gumbel (<code>"gumbel"</code>), 
the normal (<code>"normal"</code>), the lognormal (<code>"lognormal"</code>),
the logistic (<code>"logistic"</code>), the loglogistic (<code>"loglogistic"</code>),
and the beta (<code>"beta"</code>) distribution.</p>
</td></tr>
<tr><td><code id="ADcens_+3A_betalimits">betaLimits</code></td>
<td>
<p>Two-components vector with the lower and upper bounds of the 
Beta distribution. This argument is only required, if the beta
distribution is considered.</p>
</td></tr>
<tr><td><code id="ADcens_+3A_igumb">igumb</code></td>
<td>
<p>Two-components vector with the initial values for the estimation 
of the Gumbel distribution parameters.</p>
</td></tr>
<tr><td><code id="ADcens_+3A_degs">degs</code></td>
<td>
<p>Integer indicating the number of decimal places of the numeric 
results of the output.</p>
</td></tr>
<tr><td><code id="ADcens_+3A_bs">BS</code></td>
<td>
<p>Number of bootstrap samples.</p>
</td></tr>
<tr><td><code id="ADcens_+3A_params">params</code></td>
<td>
<p>List specifying the parameters of the theoretical distribution. 
By default, parameters are set to <code>NULL</code> and estimated with 
the maximum likelihood method. This argument is only considered, 
if all parameters of the studied distribution are specified.</p>
</td></tr>
<tr><td><code id="ADcens_+3A_outp">outp</code></td>
<td>
<p>Indicator of how the output will be displayed. The possible formats are <code>list</code> and <code>table</code>.</p>
</td></tr>
<tr><td><code id="ADcens_+3A_prnt">prnt</code></td>
<td>
<p>Logical to indicate if the estimations of the Anderson-Darling statistic and p-value should be printed. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="ADcens_+3A_tol">tol</code></td>
<td>
<p>Precision of survival times.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When dealing with complete data, we recommend to use the function 
<code>ad.test</code> of the <span class="pkg">goftest</span> package. 
</p>
<p>The parameter estimation is acomplished with the <code>fitdistcens</code> 
function of the <span class="pkg">fitdistrplus</span> package.
</p>
<p>The precision of the survival times is important mainly in 
the data generation step of the bootstrap samples.
</p>


<h3>Value</h3>

<p>If <code>prnt = TRUE</code>, a list containing the following components:
</p>
<table>
<tr><td><code>Distribution</code></td>
<td>
<p>Null distribution.</p>
</td></tr>
<tr><td><code>AD</code></td>
<td>
<p>Value of Anderson-Darling statistic.</p>
</td></tr>
<tr><td><code>p-value</code></td>
<td>
<p>Estimated p-value.</p>
</td></tr>
<tr><td><code>Parameters</code></td>
<td>
<p>List with the maximum likelihood estimates of the parameters 
of the distribution under study.</p>
</td></tr>
</table>
<p>The list is also returned invisibly.
</p>


<h3>Warning </h3>

<p>If the amount of data is large, the execution time of the 
function can be elevated. The parameter <code>BS</code> can 
limit the number of random censored samples generated and 
reduce the execution time.</p>


<h3>Author(s)</h3>

<p>K. Langohr, M. Besalú, M. Francisco, G. Gómez.</p>


<h3>References</h3>

<p>G. Marsaglia and J. Marsaglia. <em>Evaluating the Aderson-Darling Distrinution</em>. In: Journal os Statistical Software, Articles, 9 (2) (2004), 1-5.
</p>


<h3>See Also</h3>

<p>Function <code>ad.test</code> (Package <span class="pkg">goftest</span>) for complete data and 
function <a href="#topic+gofcens">gofcens</a> for statistics and p-value of th Kolmogorov-Smirnov, 
Cramér von-Mises and Anderson-Darling together for right-censored data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Complete data
set.seed(123)
ADcens(times = rweibull(100, 12, scale = 4), distr = "weibull",
       BS = 199)

## Not run: 
# Censored data
library(survival)
colonsamp &lt;- colon[sample(nrow(colon), 100), ]
ADcens(colonsamp$time, colonsamp$status, distr = "normal")

## End(Not run)
</code></pre>

<hr>
<h2 id='chisqcens'>General chi-squared statistics for right-censored data.</h2><span id='topic+chisqcens'></span>

<h3>Description</h3>

<p>Function <code>chisqcens</code> computes the general chi-squared test statistic for 
right-censored data introduced by Kim (1993) and the respective p-value 
using bootstrapping.</p>


<h3>Usage</h3>

<pre><code class='language-R'>chisqcens(times, cens = rep(1, length(times)), M,
          distr = c("exponential", "gumbel", "weibull", "normal",
                    "lognormal", "logistic", "loglogistic", "beta"),
          betaLimits=c(0, 1), igumb = c(10, 10), degs = 3, BS = 999,
          params = list(shape = NULL, shape2 = NULL,
                        location = NULL, scale = NULL),
          prnt = TRUE, outp = "list", tol = 1e-04)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="chisqcens_+3A_times">times</code></td>
<td>
<p>Numeric vector of times until the event of interest.</p>
</td></tr>
<tr><td><code id="chisqcens_+3A_cens">cens</code></td>
<td>
<p>Status indicator (1, exact time; 0, right-censored time). If not 
provided, all times are assumed to be exact.</p>
</td></tr>
<tr><td><code id="chisqcens_+3A_m">M</code></td>
<td>
<p>Number indicating the number of cells that will be considered.</p>
</td></tr>
<tr><td><code id="chisqcens_+3A_distr">distr</code></td>
<td>
<p>A string specifying the name of the distribution to be studied. 
The possible distributions are the exponential (<code>"exponential"</code>), 
the Weibull (<code>"weibull"</code>), the Gumbel (<code>"gumbel"</code>), 
the normal (<code>"normal"</code>), the lognormal (<code>"lognormal"</code>),
the logistic (<code>"logistic"</code>), the loglogistic (<code>"loglogistic"</code>),
and the beta (<code>"beta"</code>) distribution.</p>
</td></tr>
<tr><td><code id="chisqcens_+3A_betalimits">betaLimits</code></td>
<td>
<p>Two-components vector with the lower and upper bounds of the 
Beta distribution. This argument is only required, if the beta
distribution is considered.</p>
</td></tr>
<tr><td><code id="chisqcens_+3A_igumb">igumb</code></td>
<td>
<p>Two-components vector with the initial values for the estimation 
of the Gumbel distribution parameters.</p>
</td></tr>
<tr><td><code id="chisqcens_+3A_degs">degs</code></td>
<td>
<p>Integer indicating the number of decimal places of the numeric 
results of the output.</p>
</td></tr>
<tr><td><code id="chisqcens_+3A_bs">BS</code></td>
<td>
<p>Number of bootstrap samples.</p>
</td></tr>
<tr><td><code id="chisqcens_+3A_params">params</code></td>
<td>
<p>List specifying the parameters of the theoretical distribution. 
By default, parameters are set to <code>NULL</code> and estimated with 
the maximum likelihood method. This argument is only considered, 
if all parameters of the studied distribution are specified.</p>
</td></tr>
<tr><td><code id="chisqcens_+3A_outp">outp</code></td>
<td>
<p>Indicator of how the output will be displayed. The possible formats are                        
<code>list</code> and <code>table</code>.</p>
</td></tr>
<tr><td><code id="chisqcens_+3A_prnt">prnt</code></td>
<td>
<p>Logical to indicate if the estimations of the Anderson-Darling statistic and 
p-value should be printed. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="chisqcens_+3A_tol">tol</code></td>
<td>
<p>Precision of survival times.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function implements the test introduced by Kim (1993) and returns 
the value of the test statistic. 
</p>
<p>The cell boundaries of the test are obtained via the quantiles, which 
are based on the Kaplan-Meier estimate of the distribution function. 
In the presence of right-censored data, it is possible that not all 
quantiles are estimated, and in this case, the value of <code>M</code> 
provided by the user is reduced. 
</p>
<p>The parameter estimation is acomplished with the <code>fitdistcens</code> 
function of the <span class="pkg">fitdistrplus</span> package.
</p>
<p>The precision of the survival times is important mainly in 
the data generation step of the bootstrap samples.
</p>


<h3>Value</h3>

<p>If <code>prnt = TRUE</code>, a list containing the following components:
</p>
<table>
<tr><td><code>Distribution</code></td>
<td>
<p>Null distribution.</p>
</td></tr>
<tr><td><code>Statistic</code></td>
<td>
<p>Value of the test statistic.</p>
</td></tr>
<tr><td><code>p-value</code></td>
<td>
<p>Estimated p-value.</p>
</td></tr>
<tr><td><code>Parameters</code></td>
<td>
<p>The values of the parameters of the null distribution. 
If the user has set the parameters manually, these will 
be the returned parameters, otherwise the maximum 
likelihood estimates are returned.</p>
</td></tr>
<tr><td><code>CellNumber</code></td>
<td>
<p>Vector with two values: the original cell number 
introduced by the user and the final cell number used.</p>
</td></tr>
</table>
<p>The list is also returned invisibly.
</p>


<h3>Author(s)</h3>

<p>K. Langohr, M. Besalú, M. Francisco, G. Gómez.</p>


<h3>References</h3>

<p>J. H. Kim. <em>Chi-Square Goodness-of-Fit Tests for Randomly Censored Data.</em> 
In: The Annals of Statistics, 21 (3) (1993), 1621-1639.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Complete data
set.seed(123)
chisqcens(time = rgumbel(100, 12, scale = 4), M = 8, distr = "gumbel",
          BS = 99)

## Not run: 
# Censored data
library(survival)
colonsamp &lt;- colon[sample(nrow(colon), 100), ]
chisqcens(colonsamp$time, colonsamp$status, M = 6, distr = "normal")

## End(Not run)
</code></pre>

<hr>
<h2 id='cumhazPlot'>Cumulative hazard plots to check the goodness of fit of parametric models</h2><span id='topic+cumhazPlot'></span>

<h3>Description</h3>

<p>Function <code>cumhazPlot</code> uses the cumulative hazard plot to check if a certain distribution 
is an appropiate choice for the data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cumhazPlot(times, cens = rep(1, length(times)), distr = "all6", colour = 1, 
           betaLimits = c(0, 1), igumb = c(10, 10), ggp = FALSE, m = NULL, 
           prnt = TRUE, degs = 3, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cumhazPlot_+3A_times">times</code></td>
<td>
<p>Numeric vector of times until the event of interest.</p>
</td></tr>
<tr><td><code id="cumhazPlot_+3A_cens">cens</code></td>
<td>
<p>Status indicator (1, exact time; 0, right-censored time). If not 
provided, all times are assumed to be exact.</p>
</td></tr>
<tr><td><code id="cumhazPlot_+3A_distr">distr</code></td>
<td>
<p>A string specifying the names of the distributions to be studied. 
The possible distributions are the exponential (<code>"exponential"</code>), 
the Weibull (<code>"weibull"</code>), the Gumbel (<code>"gumbel"</code>), 
the normal (<code>"normal"</code>), the lognormal (<code>"lognormal"</code>),
the logistic (<code>"logistic"</code>), the loglogistic (<code>"loglogistic"</code>),
and the beta (<code>"beta"</code>) distribution. By default, <code>distr</code> 
is set to <code>"all6"</code>, which means that the cumulative hazard 
plots are drawn for the Weibull, loglogistic, lognormal, Gumbel, 
logistic, and normal distributions.</p>
</td></tr> 
<tr><td><code id="cumhazPlot_+3A_colour">colour</code></td>
<td>
<p>Colour of the points. Default colour: black.</p>
</td></tr>
<tr><td><code id="cumhazPlot_+3A_betalimits">betaLimits</code></td>
<td>
<p>Two-components vector with the lower and upper bounds of the 
Beta distribution. This argument is only required, if the beta
distribution is considered.</p>
</td></tr>
<tr><td><code id="cumhazPlot_+3A_igumb">igumb</code></td>
<td>
<p>Two-components vector with the initial values for the estimation 
of the Gumbel distribution parameters.</p>
</td></tr>
<tr><td><code id="cumhazPlot_+3A_ggp">ggp</code></td>
<td>
<p>Logical to use or not the <span class="pkg">ggplot2</span> package to draw the plots. 
Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="cumhazPlot_+3A_m">m</code></td>
<td>
<p>Optional layout for the plots to be displayed.</p>
</td></tr>
<tr><td><code id="cumhazPlot_+3A_prnt">prnt</code></td>
<td>
<p>Logical to indicate if the maximum likelihood estimates of the 
parameters of all distributions considered should be printed. 
Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="cumhazPlot_+3A_degs">degs</code></td>
<td>
<p>Integer indicating the number of decimal places of the numeric 
results of the output.</p>
</td></tr>
<tr><td><code id="cumhazPlot_+3A_...">...</code></td>
<td>
<p>Optional arguments for function <code>par</code>, if <code>ggplo = FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The cumulative hazard plot is based on transforming the cumulative 
hazard function <code class="reqn">\Lambda</code> in such a way that it becomes linear in <code class="reqn">t</code> 
or <code class="reqn">\log(t)</code>. This transformation is specific for each distribution. 
The function uses the data to compute the Nelson-Aalen estimator of the 
cumulative hazard function, <code class="reqn">\widehat{\Lambda}</code>, and the 
maximum likelihood estimators of the parameters of the theoretical 
distribution under study. If the distribution fits the data, the plot is 
expected to be a straight line.
</p>
<p>The parameter estimation is acomplished with the <code>fitdistcens</code> 
function of the <span class="pkg">fitdistrplus</span> package.</p>


<h3>Value</h3>

<p>If <code>prnt = TRUE</code>:
</p>
<table>
<tr><td><code>Parameter estimates</code></td>
<td>
<p>A list with the maximum likelihood estimates of the 
parameters of all distributions considered.</p>
</td></tr></table>


<h3>Author(s)</h3>

<p>K. Langohr, M. Besalú, M. Francisco, G. Gómez.</p>


<h3>Examples</h3>

<pre><code class='language-R'># Complete data and default distributions
set.seed(123)
x &lt;- rlogis(1000, 50, 5)
cumhazPlot(x, lwd = 2)

# Censored data comparing three distributions
data(nba)
cumhazPlot(nba$survtime, nba$cens, distr = c("expo", "normal", "gumbel"))
</code></pre>

<hr>
<h2 id='CvMcens'>Cramér-von Mises test for complete and right-censored data</h2><span id='topic+CvMcens'></span>

<h3>Description</h3>

<p><code>CvMcens</code> computes the Cramér-von Mises statistic and p-value for complete 
and right-censored data against eight possible distributions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CvMcens(times, cens = rep(1, length(times)),
        distr = c("exponential", "gumbel", "weibull", "normal",
                  "lognormal", "logistic", "loglogistic", "beta"),
        betaLimits = c(0, 1), igumb = c(10, 10), degs = 3, BS = 999,
        params = list(shape = NULL, shape2 = NULL,
                      location = NULL, scale = NULL),
        prnt = TRUE, outp = "list", tol = 1e-04)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CvMcens_+3A_times">times</code></td>
<td>
<p>Numeric vector of times until the event of interest.</p>
</td></tr>
<tr><td><code id="CvMcens_+3A_cens">cens</code></td>
<td>
<p>Status indicator (1, exact time; 0, right-censored time). If not 
provided, all times are assumed to be exact.</p>
</td></tr>
<tr><td><code id="CvMcens_+3A_distr">distr</code></td>
<td>
<p>A string specifying the name of the distribution to be studied. 
The possible distributions are the exponential (<code>"exponential"</code>), 
the Weibull (<code>"weibull"</code>), the Gumbel (<code>"gumbel"</code>), 
the normal (<code>"normal"</code>), the lognormal (<code>"lognormal"</code>),
the logistic (<code>"logistic"</code>), the loglogistic (<code>"loglogistic"</code>),
and the beta (<code>"beta"</code>) distribution.</p>
</td></tr>
<tr><td><code id="CvMcens_+3A_betalimits">betaLimits</code></td>
<td>
<p>Two-components vector with the lower and upper bounds of the 
Beta distribution. This argument is only required, if the beta
distribution is considered.</p>
</td></tr>
<tr><td><code id="CvMcens_+3A_igumb">igumb</code></td>
<td>
<p>Two-components vector with the initial values for the estimation 
of the Gumbel distribution parameters.</p>
</td></tr>
<tr><td><code id="CvMcens_+3A_degs">degs</code></td>
<td>
<p>Integer indicating the number of decimal places of the numeric 
results of the output.</p>
</td></tr>
<tr><td><code id="CvMcens_+3A_bs">BS</code></td>
<td>
<p>Number of bootstrap samples.</p>
</td></tr>
<tr><td><code id="CvMcens_+3A_params">params</code></td>
<td>
<p>List specifying the parameters of the theoretical distribution. 
By default, parameters are set to <code>NULL</code> and estimated with 
the maximum likelihood method. This argument is only considered, 
if all parameters of the studied distribution are specified.</p>
</td></tr>
<tr><td><code id="CvMcens_+3A_outp">outp</code></td>
<td>
<p>Indicator of how the output will be displayed. The possible formats are                        
<code>list</code> and <code>table</code>.</p>
</td></tr>
<tr><td><code id="CvMcens_+3A_prnt">prnt</code></td>
<td>
<p>Logical to indicate if the estimations of the Anderson-Darling statistic and p-value should be printed. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="CvMcens_+3A_tol">tol</code></td>
<td>
<p>Precision of survival times.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Koziol and Green (1976) proposed a Cramér-von 
Mises statistic for randomly censored data. This function reproduces 
this test for a given survival data and a theorical distribution. In 
presence of ties, different authors provide slightly different definitions 
of the product-limit estimator, what might provide different values of 
the test statistic.  
When dealing with complete data, we recommend to use the function 
<code>cvm.test</code> of the <span class="pkg">goftest</span> package.
</p>
<p>The parameter estimation is acomplished with the <code>fitdistcens</code> 
function of the <span class="pkg">fitdistrplus</span> package.
</p>
<p>The precision of the survival times is important mainly in 
the data generation step of the bootstrap samples.
</p>


<h3>Value</h3>

<p>If <code>prnt = TRUE</code>, a list containing the following components:
</p>
<table>
<tr><td><code>Distribution</code></td>
<td>
<p>Null distribution.</p>
</td></tr>
<tr><td><code>CvM</code></td>
<td>
<p>Value of Cramér-von Mises statistic.</p>
</td></tr>
<tr><td><code>p-value</code></td>
<td>
<p>Estimated p-value.</p>
</td></tr>
<tr><td><code>Parameters</code></td>
<td>
<p>List with the maximum likelihood estimates of the parameters 
of the distribution under study.</p>
</td></tr>
</table>
<p>The list is also returned invisibly.
</p>


<h3>Warning </h3>

<p>If the amount of data is large, the execution time of the 
function can be elevated. The parameter <code>BS</code> can 
limit the number of random censored samples generated and 
reduce the execution time.</p>


<h3>Author(s)</h3>

<p>K. Langohr, M. Besalú, M. Francisco, G. Gómez.</p>


<h3>References</h3>

<p>J. A. Koziol and S. B. Green. <em>A Cramér-von Mises statistic for randomly 
censored data</em>. In: Biometrika, 63 (3) (1976), 465-474.
</p>
<p>A. N. Pettitt and M. A. Stephens. <em>Modified Cramér-von Mises statistics 
for censored data.</em> In: Biometrika, 63 (2) (1976), 291-298.
</p>


<h3>See Also</h3>

<p>Function <code>cvm.test</code> (Package <span class="pkg">goftest</span>) for complete data and 
<a href="#topic+gofcens">gofcens</a> for statistics and p-value of Kolmogorov-Smirnov, 
Cramér von-Mises and Anderson-Darling together for right-censored data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Complete data
set.seed(123)
CvMcens(times = rweibull(100, 12, scale = 4), distr = "weibull",
       BS = 199)

## Not run: 
# Censored data
library(survival)
colonsamp &lt;- colon[sample(nrow(colon), 100), ]
CvMcens(colonsamp$time, colonsamp$status, distr = "normal")

## End(Not run)
</code></pre>

<hr>
<h2 id='gofcens'>Kolmogorov-Smirnov, Cramér-von Mises, and Anderson-Darling statistics for 
complete and right-censored data</h2><span id='topic+gofcens'></span>

<h3>Description</h3>

<p><code>gofcens</code> computes the Kolmogorov-Smirnov, Cramér-von Mises, and 
Anderson-Darling statistics ans p-values for complete and right-censored data against 
eight possible distributions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gofcens(times, cens = rep(1, length(times)), 
        distr = c("exponential", "gumbel", "weibull", "normal", 
                  "lognormal", "logistic", "loglogistic", "beta"), 
        betaLimits = c(0, 1), igumb = c(10, 10), degs = 3, BS = 999, 
        params = list(shape = NULL, shape2 = NULL, location = NULL, 
                      scale = NULL), outp = "list")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gofcens_+3A_times">times</code></td>
<td>
<p>Numeric vector of times until the event of interest.</p>
</td></tr>
<tr><td><code id="gofcens_+3A_cens">cens</code></td>
<td>
<p>Status indicator (1, exact time; 0, right-censored time). If not 
provided, all times are assumed to be exact.</p>
</td></tr>
<tr><td><code id="gofcens_+3A_distr">distr</code></td>
<td>
<p>A string specifying the name of the distribution to be studied. 
The possible distributions are the exponential (<code>"exponential"</code>), 
the Weibull (<code>"weibull"</code>), the Gumbel (<code>"gumbel"</code>), 
the normal (<code>"normal"</code>), the lognormal (<code>"lognormal"</code>),
the logistic (<code>"logistic"</code>), the loglogistic (<code>"loglogistic"</code>),
and the beta (<code>"beta"</code>) distribution.</p>
</td></tr>
<tr><td><code id="gofcens_+3A_betalimits">betaLimits</code></td>
<td>
<p>Two-components vector with the lower and upper bounds of the 
Beta distribution. This argument is only required, if the beta
distribution is considered.</p>
</td></tr>
<tr><td><code id="gofcens_+3A_igumb">igumb</code></td>
<td>
<p>Two-components vector with the initial values for the estimation 
of the Gumbel distribution parameters.</p>
</td></tr>
<tr><td><code id="gofcens_+3A_degs">degs</code></td>
<td>
<p>Integer indicating the number of decimal places of the numeric 
results of the output.</p>
</td></tr>
<tr><td><code id="gofcens_+3A_bs">BS</code></td>
<td>
<p>Number of bootstrap samples.</p>
</td></tr>
<tr><td><code id="gofcens_+3A_params">params</code></td>
<td>
<p>List specifying the parameters of the theoretical distribution. 
By default, parameters are set to <code>NULL</code> and estimated with 
the maximum likelihood method. This argument is only considered, 
if all parameters of the studied distribution are specified.</p>
</td></tr>
<tr><td><code id="gofcens_+3A_outp">outp</code></td>
<td>
<p>Indicator of how the output will be displayed. The possible formats are <code>list</code> and <code>table</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Fleming et al. (1980) proposed a modified Kolmogorov-Smirnov test to be 
used with right-censored data. Koziol and Green (1976) proposed a Cramér-von 
Mises statistic for randomly censored data. This function reproduces 
this test for a given survival data and a theorical distribution. In 
presence of ties, different authors provide slightly different definitions 
of the product-limit estimator, what might provide different values of 
the test statistic.  
</p>
<p>When dealing with complete data, we recommend the use of functions 
<code><a href="stats.html#topic+ks.test">ks.test</a></code> of the <span class="pkg">stats</span> package and 
<code>cvm.test</code> and <code>ad.test</code> of the <span class="pkg">goftest</span> package. 
</p>


<h3>Value</h3>

<p>A list containing the following components
</p>
<table>
<tr><td><code>Distribution</code></td>
<td>
<p>Null distribution.</p>
</td></tr>
<tr><td><code>Tests statistics</code></td>
<td>
<p>Values of the Kolmogovor-Smirnov, Cramér-von Mises,
and Anderson-Darling test statistics.</p>
</td></tr>
<tr><td><code>p-value</code></td>
<td>
<p>P-values associated with each test.</p>
</td></tr>
<tr><td><code>Parameters</code></td>
<td>
<p>List with the maximum likelihood estimates of the parameters 
of the distribution under study.</p>
</td></tr>
</table>


<h3>Warning </h3>

<p>If the amount of data is large, the execution time of the 
function can be elevated. The parameter <code>BS</code> can 
limit the number of random censored samples generated and 
reduce the execution time.</p>


<h3>Author(s)</h3>

<p>K. Langohr, M. Besalú, M. Francisco, G. Gómez.</p>


<h3>References</h3>

<p>T. R. Fleming et al. <em>Modified Kolmogorov-Smirnov test procedure with application 
to arbitrarily right-censored data</em>. In: Biometrics 36 (1980), 607-625.
</p>
<p>J. A. Koziol and S. B. Green. <em>A Cramér-von Mises statistic for randomly 
censored data</em>. In: Biometrika, 63 (3) (1976), 465-474.
</p>
<p>A. N. Pettitt and M. A. Stephens. <em>Modified Cramér-von Mises statistics 
for censored data.</em> In: Biometrika, 63 (2) (1976), 291-298.
</p>


<h3>See Also</h3>

<p><a href="stats.html#topic+ks.test">ks.test</a> (Package <code>stats</code>), <code>cvm.test</code> 
(Package <code>goftest</code>), and <code>ad.test</code> 
(Package <code>goftest</code>) for complete data, and <a href="#topic+KScens">KScens</a> for the 
Kolmogorov-Smirnov test for right-censored data, which returns the p-value.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Complete data
set.seed(123)
gofcens(times = rweibull(100, 12, scale = 4), distr = "weibull", BS = 499)

# Censored data
library(survival)
colonsamp &lt;- colon[sample(nrow(colon), 100), ]
gofcens(colonsamp$time, colonsamp$status, distr = "normal")

## End(Not run)
</code></pre>

<hr>
<h2 id='GofCens-package'>Goodness-of-Fit Methods for Complete and Right-Censored Data.</h2><span id='topic+GofCens-package'></span><span id='topic+GofCens'></span>

<h3>Description</h3>

<p>This package implements both graphical tools and goodness-of-fit 
tests for complete and right-censored data. It has implemented: 
</p>

<ol>
<li><p> Kolmogorov-Smirnov, Cramér-von Mises, and Anderson-Darling tests,
which use the empirical distribution function for complete data 
and are extended for right-censored data. 
</p>
</li>
<li><p> Generalized chi-squared-type test, which is based on the squared 
differences between observed and expected counts using random 
cells with right-censored data.
</p>
</li>
<li><p> A series of graphical tools such as probability or cumulative hazard 
plots to guide the decision about the most suitable parametric model 
for the data.
</p>
</li></ol>



<h3>Details</h3>

<p>The <code>GofCens</code> package can be used to check the goodness of fit of the following 8 distributions. The list shows the parametrizations of the 
survival functions.
</p>

<ol>
<li><p> Exponential Distribution [Exp<code class="reqn">(\beta)</code>] </p>
<p style="text-align: center;"><code class="reqn">S(t)=e^{-\frac{t}{\beta}}</code>
</p>
 
</li>
<li><p> Weibull Distribution [Wei(<code class="reqn">\alpha,\,\beta</code>)]  </p>
<p style="text-align: center;"><code class="reqn">S(t)=e^{-(\frac{t}{\beta})^\alpha}</code>
</p>
 
</li>
<li><p> Gumbel Distribution [Gum(<code class="reqn">\mu,\,\beta</code>)]  </p>
<p style="text-align: center;"><code class="reqn">S(t)=1 - e^{-e^{-\frac{t-\mu}{\beta}}}</code>
</p>
 
</li>
<li><p> Log-Logistic Distribution [LLogis(<code class="reqn">\alpha, \beta</code>)]  </p>
<p style="text-align: center;"><code class="reqn">S(t)=\frac{1}{1 + \left(\frac{t}{\beta}\right)^\alpha}</code>
</p>

</li>
<li><p> Logistic Distribution [Logis(<code class="reqn">\mu,\beta</code>)]  </p>
<p style="text-align: center;"><code class="reqn">S(t)=\frac{e^{-\frac{t -\mu}{\beta}}}{1 + e^{-\frac{t - \mu}{\beta}}}</code>
</p>

</li>
<li><p> Log-Normal Distribution [LN(<code class="reqn">\mu,\beta</code>)]  </p>
<p style="text-align: center;"><code class="reqn">S(t)=\int_{\frac{\log t - \mu}{\beta}}^\infty \!\frac{1}{\sqrt{2 \pi}}</code>
</p>

</li>
<li><p> Normal Distribution [N(<code class="reqn">\mu,\beta</code>)]  </p>
<p style="text-align: center;"><code class="reqn">S(t)=\int_t^\infty \! \frac{1}{\beta\sqrt{2\pi}}e^{-\frac{(x - \mu)^2}{2 \beta^2}} dx</code>
</p>

</li>
<li><p> 4-Param. Beta Distribution [Beta(<code class="reqn">\alpha, \gamma, a, b</code>)] </p>
<p style="text-align: center;"><code class="reqn">S(t)=1 - \frac{B_{(\alpha, \gamma, a, b)}(t)}{B(\alpha, \gamma)}</code>
</p>

</li></ol>

<p>The list of the parameters of the theoretical distribution can be set manually using the argument <code>params</code> of each function. In that case, the correspondence is: <code class="reqn">\alpha</code> is the <code>shape</code> value, <code class="reqn">\gamma</code> is the <code>shape2</code> value, <code class="reqn">\mu</code> is the <code>location</code> value and <code class="reqn">\beta</code> is the <code>scale</code> value.
</p>

<table>
<tr>
 <td style="text-align: left;">
    Package: </td><td style="text-align: left;"> GofCens</td>
</tr>
<tr>
 <td style="text-align: left;">
    Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
    Version: </td><td style="text-align: left;"> 0.98</td>
</tr>
<tr>
 <td style="text-align: left;">
    Date: </td><td style="text-align: left;"> 2024-03-22</td>
</tr>
<tr>
 <td style="text-align: left;">
    License: </td><td style="text-align: left;"> GPL (&gt;= 2)</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Klaus Langohr, Mireia Besalú, Matilde Francisco, Guadalupe Gómez
</p>
<p>Maintainer: Klaus Langohr &lt;klaus.langohr@upc.edu&gt;</p>

<hr>
<h2 id='kmPlot'>Plot of the Kaplen-Meier and parametric estimations</h2><span id='topic+kmPlot'></span>

<h3>Description</h3>

<p>Function <code>kmPlot</code> is a function that generates a plot that combines a 
Kaplan-Meier survival curve and a parametric survival curve in the same graph. 
It is useful for comparing non-parametric survival estimates with the fitted 
parametric survival model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kmPlot(times, cens = rep(1, length(times)), distr = "all6", colour = 1, 
       betaLimits = c(0, 1), igumb = c(10, 10), ggp = FALSE, m = NULL,
       prnt = TRUE, degs = 3, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kmPlot_+3A_times">times</code></td>
<td>
<p>Numeric vector of times until the event of interest.</p>
</td></tr>
<tr><td><code id="kmPlot_+3A_cens">cens</code></td>
<td>
<p>Status indicator (1, exact time; 0, right-censored time). If not 
provided, all times are assumed to be exact.</p>
</td></tr>
<tr><td><code id="kmPlot_+3A_distr">distr</code></td>
<td>
<p>A string specifying the name of the distribution to be studied. 
The possible distributions are  
the Weibull (<code>"weibull"</code>), the Gumbel (<code>"gumbel"</code>), 
the normal (<code>"normal"</code>), the lognormal (<code>"lognormal"</code>),
the logistic (<code>"logistic"</code>), the loglogistic (<code>"loglogistic"</code>),
the exponential (<code>"exponential"</code>)
and the beta (<code>"beta"</code>) distribution. Default is <code>"all6"</code> and 
includes the fisrt 6 listed which are the most used distributions.</p>
</td></tr>
<tr><td><code id="kmPlot_+3A_colour">colour</code></td>
<td>
<p>Vector indicating the colours of the displayed plots.</p>
</td></tr>
<tr><td><code id="kmPlot_+3A_betalimits">betaLimits</code></td>
<td>
<p>Two-components vector with the lower and upper bounds of the 
Beta distribution. This argument is only required, if the beta
distribution is considered.</p>
</td></tr>
<tr><td><code id="kmPlot_+3A_igumb">igumb</code></td>
<td>
<p>Two-components vector with the initial values for the estimation of 
the Gumbel distribution parameters.</p>
</td></tr> 
<tr><td><code id="kmPlot_+3A_ggp">ggp</code></td>
<td>
<p>Logical to use or not the <span class="pkg">ggplot2</span> package to draw the plots. 
Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="kmPlot_+3A_m">m</code></td>
<td>
<p>Optional layout for the plots to be displayed.</p>
</td></tr>
<tr><td><code id="kmPlot_+3A_prnt">prnt</code></td>
<td>
<p>Logical to indicate if the maximum likelihood estimates of the 
parameters should be printed. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="kmPlot_+3A_degs">degs</code></td>
<td>
<p>Integer indicating the number of decimal places of the numeric 
results of the output.</p>
</td></tr>
<tr><td><code id="kmPlot_+3A_...">...</code></td>
<td>
<p>Optional arguments for function <code>par</code>, if <code>ggp = FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The parameter estimation is acomplished with the <code>fitdistcens</code> 
function of the <span class="pkg">fitdistrplus</span> package.
</p>


<h3>Value</h3>

<p>If <code>prnt = TRUE</code>, a list containing the following components
</p>
<table>
<tr><td><code>Distribution</code></td>
<td>
<p>Distribution under study.</p>
</td></tr>
<tr><td><code>Parameters</code></td>
<td>
<p>List with the maximum likelihood estimates of the parameters 
of the distribution under study.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>K. Langohr, M. Besalú, M. Francisco, G. Gómez.</p>


<h3>References</h3>

<p>Peterson Jr, Arthur V. <em>Expressing the Kaplan-Meier estimator as a function of empirical subsurvival functions</em>. 
In: Journal of the American Statistical Association 72.360a (1977): 854-858.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  # Plots for complete data and default distributions
  set.seed(123)
  x &lt;- rexp(1000, 0.1)
  kmPlot(x)

  # Plots for censored data using ggplot2
  library(survival)
  colonsamp &lt;- colon[sample(nrow(colon), 100), ]
  kmPlot(colonsamp$time, colonsamp$status, distr= "lognormal", ggp = TRUE) 
  
  # Plots for censored data from three distributions
  data(nba)
  kmPlot(nba$survtime, nba$cens, distr = c("normal", "weibull", "lognormal"), 
         prnt = FALSE)
</code></pre>

<hr>
<h2 id='KScens'>Kolmogorov-Smirnov test for complete and right-censored data</h2><span id='topic+KScens'></span>

<h3>Description</h3>

<p>Function <code>KScens</code> computes the Kolmogorov-Smirnov statistic and p-value for complete 
and right-censored data against eight possible distributions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>KScens(times, cens = rep(1, length(times)), 
       distr = c("exponential", "gumbel", "weibull", "normal", 
                 "lognormal", "logistic", "loglogistic", "beta"), 
       betaLimits = c(0, 1), igumb = c(10, 10), degs = 3, 
       params = list(shape = NULL, shape2 = NULL, location = NULL, 
                     scale = NULL), outp = "list", prnt = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="KScens_+3A_times">times</code></td>
<td>
<p>Numeric vector of times until the event of interest.</p>
</td></tr>
<tr><td><code id="KScens_+3A_cens">cens</code></td>
<td>
<p>Status indicator (1, exact time; 0, right-censored time). If not 
provided, all times are assumed to be exact.</p>
</td></tr>
<tr><td><code id="KScens_+3A_distr">distr</code></td>
<td>
<p>A string specifying the name of the distribution to be studied. 
The possible distributions are the exponential (<code>"exponential"</code>), 
the Weibull (<code>"weibull"</code>), the Gumbel (<code>"gumbel"</code>), 
the normal (<code>"normal"</code>), the lognormal (<code>"lognormal"</code>),
the logistic (<code>"logistic"</code>), the loglogistic (<code>"loglogistic"</code>),
and the beta (<code>"beta"</code>) distribution.</p>
</td></tr>
<tr><td><code id="KScens_+3A_betalimits">betaLimits</code></td>
<td>
<p>Two-components vector with the lower and upper bounds of the 
Beta distribution. This argument is only required, if the beta
distribution is considered.</p>
</td></tr>
<tr><td><code id="KScens_+3A_igumb">igumb</code></td>
<td>
<p>Two-components vector with the initial values for the estimation 
of the Gumbel distribution parameters.</p>
</td></tr>
<tr><td><code id="KScens_+3A_degs">degs</code></td>
<td>
<p>Integer indicating the number of decimal places of the numeric 
results of the output.</p>
</td></tr>
<tr><td><code id="KScens_+3A_params">params</code></td>
<td>
<p>List specifying the parameters of the theoretical distribution. 
By default, parameters are set to <code>NULL</code> and estimated with 
the maximum likelihood method. This argument is only considered, 
if all parameters of the studied distribution are specified.</p>
</td></tr>
<tr><td><code id="KScens_+3A_outp">outp</code></td>
<td>
<p>Indicator of how the output will be displayed. The possible formats are <code>list</code> and <code>table</code>.</p>
</td></tr>
<tr><td><code id="KScens_+3A_prnt">prnt</code></td>
<td>
<p>Logical to indicate if the estimations of the Kolmogorov-Smirnov statistic and 
p-value should be printed. Default is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Fleming et al. (1980) proposed a modified Kolmogorov-Smirnov test to use 
with right-censored data. This function reproduces this test for a 
given survival data and a theorical distribution. The p-value is computed 
following the results of Koziol and Byar (1975) and the output of the 
function follows the notation of Fleming et al. (1980). 
</p>
<p>In presence of ties, different authors provide slightly different 
definitions of <code class="reqn">\widehat{F}_n(t)</code>, with which other values of 
the test statistic might be obtained.
</p>
<p>When dealing with complete data, we recommend to use the function 
<code><a href="stats.html#topic+ks.test">ks.test</a></code> of the <span class="pkg">stats</span> package. 
</p>
<p>The parameter estimation is acomplished with the <code>fitdistcens</code> 
function of the <span class="pkg">fitdistrplus</span> package.</p>


<h3>Value</h3>

<p>If <code>prnt = TRUE</code>, a list containing the following components:
</p>
<table>
<tr><td><code>Distribution</code></td>
<td>
<p>Null distribution.</p>
</td></tr>
<tr><td><code>p-value</code></td>
<td>
<p>P-value.</p>
</td></tr>
<tr><td><code>A</code></td>
<td>
<p>Value of the modified Kolmogorov-Smirnov statistic.</p>
</td></tr>
<tr><td><code>F(y_m)</code></td>
<td>
<p>Estimation of the image of the last recorded time.</p>
</td></tr>
<tr><td><code>y_m</code></td>
<td>
<p>Last recorded time.</p>
</td></tr>
<tr><td><code>Parameters</code></td>
<td>
<p>List with the maximum likelihood estimates of the parameters 
of the distribution under study.</p>
</td></tr>
</table>
<p>The list is also returned invisibly.
</p>


<h3>Author(s)</h3>

<p>K. Langohr, M. Besalú, M. Francisco, G. Gómez.</p>


<h3>References</h3>

<p>T. R. Fleming et al. <em>Modified Kolmogorov-Smirnov test procedure with application 
to arbitrarily right-censored data</em>. In: Biometrics 36 (1980), 607-625.
</p>
<p>J.A. Koziol and P. Byar. <em>Percentage Points of the Asymptotic Distributions 
of One and Two Sample K-S statistics for Truncated or Censored Data</em>. In: 
Technometrics 17 (4) (1975), 507-510.
</p>


<h3>See Also</h3>

<p>Function <a href="stats.html#topic+ks.test">ks.test</a> (Package <span class="pkg">stats</span>) for complete data and 
<a href="#topic+gofcens">gofcens</a> for statistics and p-value of Kolmogorov-Smirnov, Cramér von-Mises 
and Anderson-Darling together for right-censored data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Complete data
set.seed(123)
KScens(times = rweibull(1000, 12, scale = 4), distr = "weibull", outp = "table")

# Censored data
library(survival)
colonsamp &lt;- colon[sample(nrow(colon),100),]
KScens(colonsamp$time, colonsamp$status, distr = "norm", outp = "list")

data(nba)
KScens(nba$survtime, nba$cens, "logis", degs = 2)
KScens(nba$survtime, nba$cens, "beta", betaLimits = c(0, 80))
</code></pre>

<hr>
<h2 id='nba'>Survival times of former NBA players.</h2><span id='topic+nba'></span>

<h3>Description</h3>

<p>Survival times of former NBA players after their NBA career.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("nba")</code></pre>


<h3>Format</h3>

<p>A data frame with 3962 observations on the following 3 variables.
</p>

<dl>
<dt><code>id</code></dt><dd><p>Player ID</p>
</dd>
<dt><code>survtime</code></dt><dd><p>Time (in years) from end of NBA career until either
death or July 31, 2019.</p>
</dd>
<dt><code>cens</code></dt><dd><p>Death indicator (1, exact survival time; 0, right-censored 
survival time).</p>
</dd>
</dl>



<h3>Details</h3>

<p>The survival times of former NBA players were analyzed by Martínez et al. (2022). 
</p>


<h3>Source</h3>

<p>J. A. Martínez, K. Langohr, J. Felipo, L. Consuegra and M. Casals. <em>Data set on 
mortality of national basketball association (NBA) players.</em> In: Data in Brief, 
45 (2022).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(nba)
cumhazPlot(nba$survtime, nba$cens)
</code></pre>

<hr>
<h2 id='probPlot'>Probability plots to check the goodness of fit of parametric models</h2><span id='topic+probPlot'></span>

<h3>Description</h3>

<p><code>probPlot</code> provides four types of probability plots: P-P plot, Q-Q plot, Stabilised probability plot, and Empirically Rescaled plot to check if a certain distribution is an appropiate choice for the data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>probPlot(times, cens = rep(1, length(times)), 
         distr = c("exponential", "gumbel", "weibull", "normal", 
                   "lognormal", "logistic", "loglogistic", "beta"), 
         plots = c("PP", "QQ", "SP", "ER"), 
         colour = c("green4", "deepskyblue4", "yellow3", "mediumvioletred"), 
         betaLimits = c(0, 1), igumb = c(10, 10), mtitle = TRUE, ggp = FALSE, 
         m = NULL, prnt = TRUE, degs = 3, 
         params = list(shape = NULL, shape2 = NULL, location = NULL, 
                       scale = NULL), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="probPlot_+3A_times">times</code></td>
<td>
<p>Numeric vector of times until the event of interest.</p>
</td></tr>
<tr><td><code id="probPlot_+3A_cens">cens</code></td>
<td>
<p>Status indicator (1, exact time; 0, right-censored time). If not 
provided, all times are assumed to be exact.</p>
</td></tr>
<tr><td><code id="probPlot_+3A_distr">distr</code></td>
<td>
<p>A string specifying the name of the distribution to be studied. 
The possible distributions are the exponential (<code>"exponential"</code>), 
the Weibull (<code>"weibull"</code>), the Gumbel (<code>"gumbel"</code>), 
the normal (<code>"normal"</code>), the lognormal (<code>"lognormal"</code>),
the logistic (<code>"logistic"</code>), the loglogistic (<code>"loglogistic"</code>),
and the beta (<code>"beta"</code>) distribution.</p>
</td></tr>
<tr><td><code id="probPlot_+3A_plots">plots</code></td>
<td>
<p>Vector stating the plots to be displayed. Possible choices are 
the P-P plot (<code>"PP"</code>), the Q-Q plot (<code>"QQ"</code>), 
the Stabilised Probability plot (<code>"SP"</code>), and the 
Empirically Rescaled plot (<code>"ER"</code>). By default, all four 
plots are displayed.</p>
</td></tr>
<tr><td><code id="probPlot_+3A_colour">colour</code></td>
<td>
<p>Vector indicating the colours of the displayed plots. 
The vector will be recycled if its length is smaller 
than the number of plots to be displayed.</p>
</td></tr>
<tr><td><code id="probPlot_+3A_betalimits">betaLimits</code></td>
<td>
<p>Two-components vector with the lower and upper bounds of the 
Beta distribution. This argument is only required, if the beta
distribution is considered.</p>
</td></tr>
<tr><td><code id="probPlot_+3A_igumb">igumb</code></td>
<td>
<p>Two-components vector with the initial values for the estimation 
of the Gumbel distribution parameters.</p>
</td></tr>
<tr><td><code id="probPlot_+3A_mtitle">mtitle</code></td>
<td>
<p>Logical to add or not the title &quot;Probability plots for a <code>distr</code>
distribution&quot; to the plot. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="probPlot_+3A_ggp">ggp</code></td>
<td>
<p>Logical to use or not the <span class="pkg">ggplot2</span> package to draw the plots. 
Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="probPlot_+3A_m">m</code></td>
<td>
<p>Optional layout for the plots to be displayed.</p>
</td></tr>
<tr><td><code id="probPlot_+3A_prnt">prnt</code></td>
<td>
<p>Logical to indicate if the maximum likelihood estimates of the 
parameters should be printed. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="probPlot_+3A_degs">degs</code></td>
<td>
<p>Integer indicating the number of decimal places of the numeric 
results of the output.</p>
</td></tr>
<tr><td><code id="probPlot_+3A_params">params</code></td>
<td>
<p>List specifying the parameters of the theoretical distribution. 
By default, parameters are set to <code>NULL</code> and estimated with 
the maximum likelihood method. This argument is only considered, 
if all parameters of the studied distribution are specified.</p>
</td></tr>
<tr><td><code id="probPlot_+3A_...">...</code></td>
<td>
<p>Optional arguments for function <code>par</code>, if <code>ggp = FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>By default, function <code>probPlot</code> draws four plots: P-P plot, 
SP plot, Q-Q plot, and EP plot. Following, a description is given for 
each plot.
</p>
<p>The <b>Probability-Probability plot</b> (P-P plot) depicts the empirical
distribution, <code class="reqn">\widehat{F}(t)</code>, which is obtained with the Kaplan-Meier
estimator if data are right-censored, versus the theoretical cumulative
distribution function (cdf), <code class="reqn">\widehat{F_0}(t)</code>. If the data come 
from the chosen distribution, the points of the resulting graph are 
expected to lie on the identity line.
</p>
<p>The <b>Stabilised Probability plot</b> (SP plot), proposed by Michael (1983), 
is a transformation of the P-P plot. It stabilises the variance of the 
plotted points. If <code class="reqn">F_0 = F</code> and the parameters of <code class="reqn">F_0</code> are known,
<code class="reqn">\widehat{F_0}(t)</code> corresponds to the cdf of a uniform order statistic, 
and the arcsin transformation stabilises its variance. If the data come 
from distribution <code class="reqn">F_0</code>, the SP plot will resemble the identity line.
</p>
<p>The <b>Quartile-Quartile plot</b> (Q-Q plot) is similar to the P-P plot, 
but it represents the sample quantiles versus the theoretical ones, 
that is, it plots <code class="reqn">t</code> versus <code class="reqn">\widehat{F}_0^{-1}(\widehat{F}(t))</code>. 
Hence, if <code class="reqn">F_0</code> fits the data well, the resulting plot will resemble 
the identity line.
</p>
<p>A drawback of the Q-Q plot is that the plotted points are not evenly spread.
Waller and Turnbull (1992) proposed the <b>Empirically Rescaled plot</b> 
(EP plot), which plots <code class="reqn">\widehat{F}_u(t)</code> against 
<code class="reqn">\widehat{F}_u(\widehat{F}_0^{-1}(\widehat{F}(t)))</code>, where 
<code class="reqn">\widehat{F}_u(t)</code> is the empirical cdf of the points corresponding 
to the uncensored observations. Again, if <code class="reqn">\widehat{F}_0</code> fits the 
data well, the ER plot will resemble the identity line.
</p>
<p>By default, all four probability plots are drawn and the maximum 
likelihood estimates of the parameters of the chosen parametric model
are returned. The parameter estimation is acomplished with the 
<code>fitdistcens</code> function of the <span class="pkg">fitdistrplus</span> package.
</p>


<h3>Value</h3>

<p>If <code>prnt = TRUE</code>, a list containing the following components
</p>
<table>
<tr><td><code>Distribution</code></td>
<td>
<p>Distribution under study.</p>
</td></tr>
<tr><td><code>Parameters</code></td>
<td>
<p>List with the maximum likelihood estimates of the parameters 
of the distribution under study.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>K. Langohr, M. Besalú, M. Francisco, G. Gómez.</p>


<h3>References</h3>

<p>J. R. Michael. <em>The Stabilized Probability Plot</em>. In: Biometrika 70 (1) (1983), 
11-17.
</p>
<p>L.A. Waller and B.W. Turnbull. <em>Probability Plotting with Censored Data</em>. In:
American Statistician 46 (1) (1992), 5-12.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># P-P, Q-Q, SP, and EP plots for complete data
set.seed(123)
x &lt;- rlnorm(1000, 3, 2)
probPlot(x) 
probPlot(x, distr = "lognormal") 

# P-P, Q-Q, SP, and EP plots for censored data using ggplot2
library(survival)
colonsamp &lt;- colon[sample(nrow(colon), 100), ]
probPlot(colonsamp$time, colonsamp$status, "weibull", ggp = TRUE) 

# P-P, Q-Q and SP plots for censored data and lognormal distribution
data(nba)
probPlot(nba$survtime, nba$cens, "lognorm", plots = c("PP", "QQ", "SP"),
         ggp = TRUE, m = matrix(1:3, nr = 1))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
