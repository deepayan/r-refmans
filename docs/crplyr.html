<!DOCTYPE html><html lang="en-US"><head><title>Help for package crplyr</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {crplyr}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#as_cr_tibble'><p>Flatten a Crunch Cube</p></a></li>
<li><a href='#autoplot'><p>Autoplot methods for Crunch Objects</p></a></li>
<li><a href='#collect'><p>Collect a Crunch dataset from the server</p></a></li>
<li><a href='#filter'><p>Filter a Crunch dataset</p></a></li>
<li><a href='#filter_.CrunchDataset'><p>Filter a Crunch dataset (deprecated)</p></a></li>
<li><a href='#group_by'><p>Group-by for Crunch datasets</p></a></li>
<li><a href='#GroupedCrunchDataset-class'><p>A Crunch Dataset &quot;Grouped By&quot; Something</p></a></li>
<li><a href='#mutate'><p>Mutate Crunch datasets (not implemented)</p></a></li>
<li><a href='#select'><p>Select columns from a Crunch dataset</p></a></li>
<li><a href='#summarize'><p>Aggregate a Crunch dataset</p></a></li>
<li><a href='#theme_crunch'><p>Crunch ggplot theme</p></a></li>
<li><a href='#unweighted_n'><p>Return the unweighted counts from summarize</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>A 'dplyr' Interface for Crunch</td>
</tr>
<tr>
<td>Description:</td>
<td>In order to facilitate analysis of datasets hosted on the Crunch
    data platform <a href="https://crunch.io/">https://crunch.io/</a>, the 'crplyr' package implements 'dplyr'
    methods on top of the Crunch backend. The usual methods 'select', 'filter',
    'group_by', 'summarize', and 'collect' are implemented in such a way as to
    perform as much computation on the server and pull as little data locally
    as possible.</td>
</tr>
<tr>
<td>Version:</td>
<td>0.4.2</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://crunch.io/r/crplyr/">https://crunch.io/r/crplyr/</a>, <a href="https://github.com/Crunch-io/crplyr">https://github.com/Crunch-io/crplyr</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/Crunch-io/crplyr/issues">https://github.com/Crunch-io/crplyr/issues</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/LGPL-3">LGPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.0), crunch (&ge; 1.15.3), dplyr</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods, ggplot2, httptest (&ge; 3.0.0), lazyeval, lifecycle,
purrr, tibble, rlang, scales, stringr, tidyselect, viridisLite</td>
</tr>
<tr>
<td>Suggests:</td>
<td>covr, magrittr, spelling, vdiffr, knitr, testthat, rmarkdown</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-03-13 21:42:18 UTC; gregfreedmanellis</td>
</tr>
<tr>
<td>Author:</td>
<td>Greg Freedman Ellis [aut, cre],
  Jonathan Keane [aut],
  Neal Richardson [aut],
  Mike Malecki [aut],
  Gordon Shotwell [aut],
  Alja≈æ Sluga [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Greg Freedman Ellis &lt;greg@crunch.io&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-03-18 12:40:14 UTC</td>
</tr>
</table>
<hr>
<h2 id='as_cr_tibble'>Flatten a Crunch Cube</h2><span id='topic+as_cr_tibble'></span>

<h3>Description</h3>

<p>Crunch Cubes can be expressed as a long data frame instead of a
multidimensional array. In this form each dimension of the cube is a variable
and the cube values are expressed as columns for each measure. This is useful
both to better understand what each entry of a cube represents, and to work
with the cube result using tidyverse tools.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as_cr_tibble(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="as_cr_tibble_+3A_x">x</code></td>
<td>
<p>a CrunchCube</p>
</td></tr>
<tr><td><code id="as_cr_tibble_+3A_...">...</code></td>
<td>
<p>further arguments passed on to <code>tibble::as_tibble()</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>cr_tibble</code> class is a subclass of <code>tibble</code> that has extra metadata
to allow <code>ggplot::autoplot()</code> to work. If you find that this extra
metadata is getting in the way, you can use <code>as_tibble()</code> to get
a true <code>tibble</code>.
</p>

<hr>
<h2 id='autoplot'>Autoplot methods for Crunch Objects</h2><span id='topic+autoplot'></span><span id='topic+autoplot.DatetimeVariable'></span><span id='topic+autoplot.NumericVariable'></span><span id='topic+autoplot.CategoricalVariable'></span><span id='topic+autoplot.CategoricalArrayVariable'></span><span id='topic+autoplot.MultipleResponseVariable'></span><span id='topic+autoplot.CrunchCube'></span><span id='topic+autoplot.CrunchCubeCalculation'></span><span id='topic+autoplot.tbl_crunch_cube'></span>

<h3>Description</h3>

<p>The Crunch autoplot methods generate <code>ggplots</code> that are tailored to various
Crunch objects. This allows you to visualize the object without bringing it
into memory. You can select between three families of plots, which will
attempt to accomodate the dimensionality of the plotted object. These plots
can be further extended and customized with other ggplot methods.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'DatetimeVariable'
autoplot(object, ...)

## S3 method for class 'NumericVariable'
autoplot(object, ...)

## S3 method for class 'CategoricalVariable'
autoplot(object, ...)

## S3 method for class 'CategoricalArrayVariable'
autoplot(object, ...)

## S3 method for class 'MultipleResponseVariable'
autoplot(object, ...)

## S3 method for class 'CrunchCube'
autoplot(object, ...)

## S3 method for class 'CrunchCubeCalculation'
autoplot(object, plot_type = "dot", ...)

## S3 method for class 'tbl_crunch_cube'
autoplot(object, plot_type = c("dot", "tile", "bar"), measure, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="autoplot_+3A_object">object</code></td>
<td>
<p>A Crunch variable or cube aggregation</p>
</td></tr>
<tr><td><code id="autoplot_+3A_...">...</code></td>
<td>
<p>additional plotting arguments</p>
</td></tr>
<tr><td><code id="autoplot_+3A_plot_type">plot_type</code></td>
<td>
<p>One of <code>"dot"</code>, <code>"tile"</code>, or <code>"bar"</code> which indicates the
plot family you would like to use. Higher dimensional plots add color
coding or facets depending on the dimensionality of the data.</p>
</td></tr>
<tr><td><code id="autoplot_+3A_measure">measure</code></td>
<td>
<p>The measure you wish to plot. This will usually be <code>"count"</code>,
the default but can also be <code>".unweighted_counts"</code> or any other measure
stored in the cube. If omitted, autoplot will select the first measure
appearing in the data.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>ggplot</code> object.
</p>

<hr>
<h2 id='collect'>Collect a Crunch dataset from the server</h2><span id='topic+collect'></span><span id='topic+collect.CrunchDataset'></span><span id='topic+collect.GroupedCrunchDataset'></span>

<h3>Description</h3>

<p>This function brings a Crunch dataset into memory so that you can
work with the data using R functions. Since this can create a long running
query it is recommended that you try to filter the dataset down as much as possible
before running <code>collect()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'CrunchDataset'
collect(x, ...)

## S3 method for class 'GroupedCrunchDataset'
collect(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="collect_+3A_x">x</code></td>
<td>
<p>A Crunch Dataset</p>
</td></tr>
<tr><td><code id="collect_+3A_...">...</code></td>
<td>
<p>Other arguments passed to <code>crunch::as.data.frame()</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>When collecting a grouped CrunchDataset, the grouping will be preserved.
</p>


<h3>Value</h3>

<p>A <code>tbl_df</code> or <code>grouped_df</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
ds %&gt;%
   group_by(cyl) %&gt;%
   select(cyl, gear) %&gt;%
   collect()

## End(Not run)
</code></pre>

<hr>
<h2 id='filter'>Filter a Crunch dataset</h2><span id='topic+filter'></span><span id='topic+filter.CrunchDataset'></span>

<h3>Description</h3>

<p>This function applies a <code>CrunchLogicalExpression</code> filter to a
<code>CrunchDataset</code>. It's a &quot;tidy&quot; way of doing <code>ds[ds$var == val,]</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'CrunchDataset'
filter(.data, ..., .preserve = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="filter_+3A_.data">.data</code></td>
<td>
<p>A <code>CrunchDataset</code></p>
</td></tr>
<tr><td><code id="filter_+3A_...">...</code></td>
<td>
<p>filter expressions</p>
</td></tr>
<tr><td><code id="filter_+3A_.preserve">.preserve</code></td>
<td>
<p>Relevant when the <code>.data</code> input is grouped. If
<code>.presrve = FALSE</code> (the default), the grouping structure is recalculated
based on the resulting data, otherwise the grouping is kept as is.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>.data</code> with the filter expressions applied.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
ds %&gt;%
   select(cyl, gear) %&gt;%
   filter(cyl &gt; 4) %&gt;%
   collect()

## End(Not run)
</code></pre>

<hr>
<h2 id='filter_.CrunchDataset'>Filter a Crunch dataset (deprecated)</h2><span id='topic+filter_.CrunchDataset'></span>

<h3>Description</h3>

<p>This function is deprecated, use <code>filter()</code> instead.
Applies a <code>CrunchLogicalExpression</code> filter to a
<code>CrunchDataset</code>. It's a &quot;tidy&quot; way of doing <code>ds[ds$var == val,]</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'CrunchDataset'
filter_(.data, ..., .dots)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="filter_.CrunchDataset_+3A_.data">.data</code></td>
<td>
<p>A <code>CrunchDataset</code></p>
</td></tr>
<tr><td><code id="filter_.CrunchDataset_+3A_...">...</code></td>
<td>
<p>filter expressions</p>
</td></tr>
<tr><td><code id="filter_.CrunchDataset_+3A_.dots">.dots</code></td>
<td>
<p>More dots!</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>.data</code> with the filter expressions applied.
</p>

<hr>
<h2 id='group_by'>Group-by for Crunch datasets</h2><span id='topic+group_by'></span><span id='topic+group_by.CrunchDataset'></span><span id='topic+ungroup.CrunchDataset'></span>

<h3>Description</h3>

<p><code>group_by()</code> sets grouping variables that affect what <code><a href="#topic+summarize">summarize()</a></code> computes.
<code>ungroup()</code> removes any grouping variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'CrunchDataset'
group_by(.data, ..., .add = FALSE)

## S3 method for class 'CrunchDataset'
ungroup(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="group_by_+3A_.data">.data</code></td>
<td>
<p>For <code>group_by()</code>, a Crunch Dataset</p>
</td></tr>
<tr><td><code id="group_by_+3A_...">...</code></td>
<td>
<p>references to variables to group by, passed to
<code><a href="dplyr.html#topic+group_by_prepare">dplyr::group_by_prepare()</a></code></p>
</td></tr>
<tr><td><code id="group_by_+3A_.add">.add</code></td>
<td>
<p>Logical: add the variables in <code>...</code> to any existing grouping
variables, or replace them (the default).</p>
</td></tr>
<tr><td><code id="group_by_+3A_x">x</code></td>
<td>
<p>For <code>ungroup()</code>, a Crunch Dataset</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that <code>group_by()</code> only supports grouping on variables that exist in the
dataset, not ones that are derived on the fly. <code>dplyr::group_by()</code> supports
that by calling <code>mutate()</code> internally, but <code>mutate</code> is not yet supported in
<code>crplyr</code>.
</p>


<h3>Value</h3>

<p><code>group_by()</code> returns a <code>GroupedCrunchDataset</code> object (a
<code>CrunchDataset</code> with grouping annotations). <code>ungroup()</code> returns a
<code>CrunchDataset</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
ds %&gt;%
   group_by(cyl) %&gt;%
   select(cyl, gear) %&gt;%
   collect()

## End(Not run)
</code></pre>

<hr>
<h2 id='GroupedCrunchDataset-class'>A Crunch Dataset &quot;Grouped By&quot; Something</h2><span id='topic+GroupedCrunchDataset-class'></span><span id='topic+GroupedCrunchDataset'></span>

<h3>Description</h3>

<p>This is a subclass of <code>crunch::CrunchDataset</code> that has a field for recording
&quot;group_by&quot; expressions.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
ds &lt;- loadDataset("Your dataset name")
class(ds) ## "CrunchDataset"
grouped_ds &lt;- group_by(ds, var1)
class(grouped_ds) ## "GroupedCrunchDataset"

## End(Not run)
</code></pre>

<hr>
<h2 id='mutate'>Mutate Crunch datasets (not implemented)</h2><span id='topic+mutate'></span><span id='topic+mutate.CrunchDataset'></span>

<h3>Description</h3>

<p>Just a method that returns a nicer error message. <code>mutate()</code> hasn't been
implemented yet. You can, however, derive expressions on the fly in
<code><a href="#topic+summarize">summarize()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'CrunchDataset'
mutate(.data, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mutate_+3A_.data">.data</code></td>
<td>
<p>A crunch Dataset</p>
</td></tr>
<tr><td><code id="mutate_+3A_...">...</code></td>
<td>
<p>Other arguments, currently ignored</p>
</td></tr>
</table>

<hr>
<h2 id='select'>Select columns from a Crunch dataset</h2><span id='topic+select'></span><span id='topic+select.CrunchDataset'></span>

<h3>Description</h3>

<p>This function uses &quot;tidy select&quot; methods of subsetting the columns of a
dataset. It's another way of doing <code>ds[,vars]</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'CrunchDataset'
select(.data, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="select_+3A_.data">.data</code></td>
<td>
<p>A <code>CrunchDataset</code></p>
</td></tr>
<tr><td><code id="select_+3A_...">...</code></td>
<td>
<p>names of variables in <code>.data</code> or other valid selection functions,
passed to <code>tidyselect::vars_select()</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>.data</code> with only the selected variables.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
ds %&gt;%
   select(contains("ear")) %&gt;%
   filter(gear &gt; 4) %&gt;%
   collect()

## End(Not run)
</code></pre>

<hr>
<h2 id='summarize'>Aggregate a Crunch dataset</h2><span id='topic+summarize'></span><span id='topic+summarise.CrunchDataset'></span>

<h3>Description</h3>

<p>This is an alternate interface to <code>crunch::crtabs()</code> that, in addition to
being &quot;tidy&quot;, makes it easier to query multiple measures at the same time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'CrunchDataset'
summarise(.data, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summarize_+3A_.data">.data</code></td>
<td>
<p>A <code>CrunchDataset</code></p>
</td></tr>
<tr><td><code id="summarize_+3A_...">...</code></td>
<td>
<p>named aggregations to include in the resulting table.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that while <code>mutate()</code> is not generally supported in <code>crplyr</code>, you can
derive expressions on the fly in <code>summarize()</code>.
</p>


<h3>Value</h3>

<p>A <code>tbl_crunch_cube</code> or <code>cr_tibble</code> of results. This subclass
of <code>tibble</code> allows <code>ggplot2::autoplot</code> to work, but can get in the way
in some tidyverse operations. You may wish to convert to a tibble using
<code>as_tibble()</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
ds %&gt;%
    filter(cyl == 6) %&gt;%
    group_by(vs) %&gt;%
    summarize(hp=mean(hp), sd_hp=sd(hp), count=n())

## End(Not run)
</code></pre>

<hr>
<h2 id='theme_crunch'>Crunch ggplot theme</h2><span id='topic+theme_crunch'></span>

<h3>Description</h3>

<p>Style ggplots according to Crunch style.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>theme_crunch(base_size = 12, base_family = "sans")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="theme_crunch_+3A_base_size">base_size</code></td>
<td>
<p>Base text size</p>
</td></tr>
<tr><td><code id="theme_crunch_+3A_base_family">base_family</code></td>
<td>
<p>Base text family</p>
</td></tr>
</table>

<hr>
<h2 id='unweighted_n'>Return the unweighted counts from summarize</h2><span id='topic+unweighted_n'></span>

<h3>Description</h3>

<p>This function allows you to return the unweighted counts from a Crunch dataset
or grouped crunch dataset. It can only be used from within a <code>summarise()</code>
call. If your dataset is unweighted, then unweighted_n() is equivalent to n().
</p>


<h3>Usage</h3>

<pre><code class='language-R'>unweighted_n()
</code></pre>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
ds %&gt;%
   group_by(cyl) %&gt;%
   summarize(
       raw_counts = unweighted_n(),
       mean = mean(wt)
   )

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
