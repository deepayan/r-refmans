<!DOCTYPE html><html><head><title>Help for package fdatest</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {fdatest}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#fdatest-package'>
<p>Interval Testing Procedure for Functional Data</p></a></li>
<li><a href='#ITP1bspline'>
<p>One population Interval Testing Procedure with B-spline basis</p></a></li>
<li><a href='#ITP1fourier'>
<p>One population Interval Testing Procedure with Fourier basis</p></a></li>
<li><a href='#ITP2bspline'>
<p>Two populations Interval Testing Procedure with B-spline basis</p></a></li>
<li><a href='#ITP2fourier'>
<p>Two populations Interval Testing Procedure with Fourier basis</p></a></li>
<li><a href='#ITP2pafourier'>
<p>Two populations Interval Testing Procedure with Fourier basis (phase-amplitude decomposition)</p></a></li>
<li><a href='#ITPaovbspline'>
<p>Interval Testing Procedure for testing Functional analysis of variance with B-spline basis</p></a></li>
<li><a href='#ITPimage'>
<p>Plot of the Interval Testing Procedure results</p></a></li>
<li><a href='#ITPlmbspline'>
<p>Interval Testing Procedure for testing Functional-on-Scalar Linear Models with B-spline basis</p></a></li>
<li><a href='#NASAtemp'>
<p>NASA daily temperatures data set</p></a></li>
<li><a href='#plot.ITP1'>
<p>Plotting ITP results for one-population tests</p></a></li>
<li><a href='#plot.ITP2'>
<p>Plotting ITP results for two-population tests</p></a></li>
<li><a href='#plot.ITPaov'>
<p>Plotting ITP results for functional analysis of variance testing</p></a></li>
<li><a href='#plot.ITPlm'>
<p>Plotting ITP results for functional-on-scalar linear model testing</p></a></li>
<li><a href='#summary.ITPaov'>
<p>Summarizing Functional Analysis of Variance Fits</p></a></li>
<li><a href='#summary.ITPlm'>
<p>Summarizing Functional-on-Scalar Linear Model Fits</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Interval Testing Procedure for Functional Data</td>
</tr>
<tr>
<td>Version:</td>
<td>2.1.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-05-04</td>
</tr>
<tr>
<td>Depends:</td>
<td>fda</td>
</tr>
<tr>
<td>Author:</td>
<td>Alessia Pini, Simone Vantini</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Alessia Pini &lt;alessia.pini@polimi.it&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Implementation of the Interval Testing Procedure for functional data in different frameworks (i.e., one or two-population frameworks, functional linear models) by means of different basis expansions (i.e., B-spline, Fourier, and phase-amplitude Fourier). The current version of the package requires functional data evaluated on a uniform grid; it automatically projects each function on a chosen functional basis; it performs the entire family of multivariate tests; and, finally, it provides the matrix of the p-values of the previous tests and the vector of the corrected p-values. The functional basis, the coupled or uncoupled scenario, and the kind of test can be chosen by the user. The package provides also a plotting function creating a graphical output of the procedure: the p-value heat-map, the plot of the corrected p-values, and the plot of the functional data.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-05-04 08:12:37 UTC; alessiapini</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-05-04 08:30:08 UTC</td>
</tr>
</table>
<hr>
<h2 id='fdatest-package'>
Interval Testing Procedure for Functional Data
</h2><span id='topic+fdatest-package'></span><span id='topic+fdatest'></span>

<h3>Description</h3>

<p>Implementation of the Interval Testing Procedure for functional data in different frameworks (i.e., one or two-population frameworks, functional linear models) by means of different basis expansions (i.e., B-spline, Fourier, and phase-amplitude Fourier). The current version of the package requires functional data evaluated on a uniform grid; it automatically projects each function on a chosen functional basis; it performs the entire family of multivariate tests; and, finally, it provides the matrix of the p-values of the previous tests and the vector of the corrected p-values. The functional basis, the coupled or uncoupled scenario, and the kind of test can be chosen by the user. The package provides also a plotting function creating a graphical output of the procedure: the p-value heat-map, the plot of the corrected p-values, and the plot of the functional data.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> fdatest</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 2.1.1</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2022-05-04</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-2</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Alessia Pini, Simone Vantini
</p>
<p>Maintainer: Alessia Pini &lt;alessia.pini@polimi.it&gt;
</p>


<h3>References</h3>

<p>A. Pini and S. Vantini (2013). The Interval Testing Procedure: Inference for Functional Data Controlling the Family Wise Error Rate on Intervals. <em>MOX-report 13/2013</em>, Politecnico di Milano.
</p>
<p>K. Abramowicz, S. De Luna, C. Häger, A. Pini, L. Schelin, and S. Vantini (2015). Distribution-Free Interval-Wise Inference for Functional-on-Scalar Linear Models. <em>MOX-report 3/2015</em>, Politecnico di Milano.
</p>


<h3>See Also</h3>

<p>See also <code><a href="#topic+ITP1bspline">ITP1bspline</a></code>, <code><a href="#topic+ITP1fourier">ITP1fourier</a></code>, <code><a href="#topic+ITP2bspline">ITP2bspline</a></code>, <code><a href="#topic+ITP2fourier">ITP2fourier</a></code>, <code><a href="#topic+ITP2pafourier">ITP2pafourier</a></code>, <code><a href="#topic+ITPlmbspline">ITPlmbspline</a></code>, <code><a href="#topic+ITPaovbspline">ITPaovbspline</a></code>, and <code><a href="#topic+ITPimage">ITPimage</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Importing the NASA temperatures data set
data(NASAtemp)

# Example 1: 
# Performing the ITP for one population with the Fourier basis
ITP.result &lt;- ITP1fourier(NASAtemp$milan,maxfrequency=10,B=1000)
# Plotting the results of the ITP
plot(ITP.result)

# Plotting the p-value heatmap
ITPimage(ITP.result)

# Selecting the significant coefficients
which(ITP.result$corrected.pval &lt; 0.05)

# Example 2: 
# Performing the ITP for two populations with the B-spline basis
ITP.result &lt;- ITP2bspline(NASAtemp$milan,NASAtemp$paris,nknots=20,B=1000)
# Plotting the results of the ITP
plot(ITP.result)

# Plotting the p-values heatmap
ITPimage(ITP.result)

# Selecting the significant components for the radius at 5% level
which(ITP.result$corrected.pval &lt; 0.05)


# Example 3:
# Fitting and testing a functional-on-scalar linear model  
# Defining data and covariates 
temperature &lt;- rbind(NASAtemp$milan,NASAtemp$paris)
groups &lt;- c(rep(0,22),rep(1,22))

# Performing the ITP
ITP.result &lt;- ITPlmbspline(temperature ~ groups,B=1000,nknots=20,order=3)
# Summary of the ITP results
summary(ITP.result)

# Plot of the ITP results
layout(1)
plot(ITP.result,main='NASA data', plot.adjpval = TRUE,xlab='Day',xrange=c(1,365))

# All graphics on the same device
layout(matrix(1:6,nrow=3,byrow=FALSE))
plot(ITP.result,main='NASA data', plot.adjpval = TRUE,xlab='Day',xrange=c(1,365))


</code></pre>

<hr>
<h2 id='ITP1bspline'>
One population Interval Testing Procedure with B-spline basis
</h2><span id='topic+ITP1bspline'></span>

<h3>Description</h3>

<p>The function implements the Interval Testing Procedure for testing the center of symmetry of a functional population evaluated on a uniform grid. Data are represented by means of the B-spline expansion and the significance of each basis coefficient is tested with an interval-wise control of the Family Wise Error Rate. The default parameters of the basis expansion lead to the piece-wise interpolating function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ITP1bspline(data, mu = 0, order = 2, nknots = dim(data)[2], B = 10000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ITP1bspline_+3A_data">data</code></td>
<td>

<p>Pointwise evaluations of the functional data set on a uniform grid. <code>data</code> is a matrix of dimensions <code>c(n,J)</code>, with <code>J</code> evaluations on columns and <code>n</code> units on rows.
</p>
</td></tr>
<tr><td><code id="ITP1bspline_+3A_mu">mu</code></td>
<td>

<p>The center of symmetry under the null hypothesis: either a constant (in this case, a constant function is used) or a <code>J</code>-dimensional vector containing the evaluations on the same grid which <code>data</code> are evaluated. The default is <code>mu=0</code>.
</p>
</td></tr>
<tr><td><code id="ITP1bspline_+3A_order">order</code></td>
<td>

<p>Order of the B-spline basis expansion. The default is <code>order=2</code>.
</p>
</td></tr>
<tr><td><code id="ITP1bspline_+3A_nknots">nknots</code></td>
<td>

<p>Number of knots of the B-spline basis expansion. The default is <code>nknots=dim(data)[2]</code>.
</p>
</td></tr>
<tr><td><code id="ITP1bspline_+3A_b">B</code></td>
<td>

<p>The number of iterations of the MC algorithm to evaluate the p-values of the permutation tests. The defualt is <code>B=10000</code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>ITP1bspline</code> returns an object of <code><a href="base.html#topic+class">class</a></code> &quot;<code>ITP1</code>&quot;.
</p>
<p>An object of class &quot;<code>ITP1</code>&quot; is a list containing at least the following components:
</p>
<table>
<tr><td><code>basis</code></td>
<td>
<p>String vector indicating the basis used for the first phase of the algorithm. In this case equal to <code>"B-spline"</code>.</p>
</td></tr>
<tr><td><code>test</code></td>
<td>
<p>String vector indicating the type of test performed. In this case equal to <code>"1pop"</code>.</p>
</td></tr>
<tr><td><code>mu</code></td>
<td>
<p>Center of symmetry under the null hypothesis (as entered by the user).</p>
</td></tr>
<tr><td><code>coeff</code></td>
<td>
<p>Matrix of dimensions <code>c(n,p)</code> of the <code>p</code> coefficients of the B-spline basis expansion. Rows are associated to units and columns to the basis index.</p>
</td></tr>
<tr><td><code>pval</code></td>
<td>
<p>Uncorrected p-values for each basis coefficient.</p>
</td></tr>
<tr><td><code>pval.matrix</code></td>
<td>
<p>Matrix of dimensions <code>c(p,p)</code> of the p-values of the multivariate tests. The element <code>(i,j)</code> of matrix <code>pval.matrix</code> contains the p-value of the joint NPC test of the components <code>(j,j+1,...,j+(p-i))</code>.</p>
</td></tr>
<tr><td><code>corrected.pval</code></td>
<td>
<p>Corrected p-values for each basis coefficient.</p>
</td></tr>
<tr><td><code>labels</code></td>
<td>
<p>Labels indicating the population membership of each data (in this case always equal to <code>1</code>).</p>
</td></tr>
<tr><td><code>data.eval</code></td>
<td>
<p>Evaluation on a fine uniform grid of the functional data obtained through the basis expansion.</p>
</td></tr>
<tr><td><code>heatmap.matrix</code></td>
<td>
<p>Heatmap matrix of p-values (used only for plots).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Alessia Pini, Simone Vantini
</p>


<h3>References</h3>

<p>A. Pini and S. Vantini (2013). The Interval Testing Procedure: Inference for Functional Data Controlling the Family Wise Error Rate on Intervals. <em>MOX-report 13/2013</em>, Politecnico di Milano.
</p>


<h3>See Also</h3>

<p>See also <code><a href="#topic+ITP1fourier">ITP1fourier</a></code>, <code><a href="#topic+ITP2bspline">ITP2bspline</a></code>, <code><a href="#topic+ITP2fourier">ITP2fourier</a></code>, <code><a href="#topic+ITP2pafourier">ITP2pafourier</a></code>, and <code><a href="#topic+ITPimage">ITPimage</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Importing the NASA temperatures data set
data(NASAtemp)
# Performing the ITP for two populations with the B-spline basis
ITP.result &lt;- ITP1bspline(NASAtemp$paris,mu=4,nknots=50,B=1000)
# Plotting the results of the ITP
plot(ITP.result,xrange=c(0,12),main='Paris temperatures')

# Plotting the p-value heatmap
ITPimage(ITP.result,abscissa.range=c(0,12))


# Selecting the significant components for the radius at 5% level
which(ITP.result$corrected.pval &lt; 0.05)

</code></pre>

<hr>
<h2 id='ITP1fourier'>
One population Interval Testing Procedure with Fourier basis
</h2><span id='topic+ITP1fourier'></span>

<h3>Description</h3>

<p>The function implements the Interval Testing Procedure for testing the center of symmetry of a functional population evaluated on a uniform grid. Data are represented by means of the Fourier expansion and the significance of each basis coefficient is tested with an interval-wise control of the Family Wise Error Rate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ITP1fourier(data, mu = 0, maxfrequency=floor(dim(data)[2]/2), B = 10000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ITP1fourier_+3A_data">data</code></td>
<td>

<p>Pointwise evaluations of the functional data set on a uniform grid. <code>data</code> is a matrix of dimensions <code>c(n,J)</code>, with <code>J</code> evaluations on columns and <code>n</code> units on rows.
</p>
</td></tr>
<tr><td><code id="ITP1fourier_+3A_mu">mu</code></td>
<td>

<p>The center of symmetry under the null hypothesis: either a constant (in this case, a constant function is used) or a <code>J</code>-dimensional vector containing the evaluations on the same grid which <code>data</code> are evaluated. The default is <code>mu=0</code>.
</p>
</td></tr>
<tr><td><code id="ITP1fourier_+3A_maxfrequency">maxfrequency</code></td>
<td>

<p>The maximum frequency to be used in the Fourier basis expansion of data. The default is <code>floor(dim(data)[2]/2)</code>, leading to an interpolating expansion.
</p>
</td></tr>
<tr><td><code id="ITP1fourier_+3A_b">B</code></td>
<td>

<p>The number of iterations of the MC algorithm to evaluate the p-values of the permutation tests. The defualt is <code>B=10000</code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>ITP1fourier</code> returns an object of <code><a href="base.html#topic+class">class</a></code> &quot;<code>ITP1</code>&quot;.
</p>
<p>An object of class &quot;<code>ITP1</code>&quot; is a list containing at least the following components:
</p>
<table>
<tr><td><code>basis</code></td>
<td>
<p>String vector indicating the basis used for the first phase of the algorithm. In this case equal to <code>"Fourier"</code>.</p>
</td></tr>
<tr><td><code>test</code></td>
<td>
<p>String vector indicating the type of test performed. In this case equal to <code>"1pop"</code>.</p>
</td></tr>
<tr><td><code>mu</code></td>
<td>
<p>Center of symmetry under the null hypothesis (as entered by the user).</p>
</td></tr>
<tr><td><code>coeff</code></td>
<td>
<p>Matrix of dimensions <code>c(n,p)</code> of the <code>p</code> coefficients of the Fourier basis expansion. Rows are associated to units and columns to the basis index: the first column is a0, the following <code>(p-1)/2</code> columns are the ak coefficients (sine coefficients) and the last <code>(p-1)/2</code> columns the bk coefficients (cosine coefficients).</p>
</td></tr>
<tr><td><code>pval</code></td>
<td>
<p>Uncorrected p-values for each frequency.</p>
</td></tr>
<tr><td><code>pval.matrix</code></td>
<td>
<p>Matrix of dimensions <code>c(p,p)</code> of the p-values of the multivariate tests. The element <code>(i,j)</code> of matrix <code>pval.matrix</code> contains the p-value of the joint NPC test of the components <code>(j,j+1,...,j+(p-i))</code>.</p>
</td></tr>
<tr><td><code>corrected.pval</code></td>
<td>
<p>Corrected p-values for each frequency.</p>
</td></tr>
<tr><td><code>labels</code></td>
<td>
<p>Labels indicating the population membership of each data (in this case always equal to <code>1</code>).</p>
</td></tr>
<tr><td><code>data.eval</code></td>
<td>
<p>Evaluation on a fine uniform grid of the functional data obtained through the basis expansion.</p>
</td></tr>
<tr><td><code>heatmap.matrix</code></td>
<td>
<p>Heatmap matrix of p-values (used only for plots).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Alessia Pini, Simone Vantini
</p>


<h3>References</h3>

<p>A. Pini and S. Vantini (2013). The Interval Testing Procedure: Inference for Functional Data Controlling the Family Wise Error Rate on Intervals. <em>MOX-report 13/2013</em>, Politecnico di Milano.
</p>


<h3>See Also</h3>

<p>See also <code><a href="#topic+ITP1bspline">ITP1bspline</a></code>, <code><a href="#topic+ITP2bspline">ITP2bspline</a></code>, <code><a href="#topic+ITP2fourier">ITP2fourier</a></code>, <code><a href="#topic+ITP2pafourier">ITP2pafourier</a></code>, and <code><a href="#topic+ITPimage">ITPimage</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Importing the NASA temperatures data set
data(NASAtemp)
# Performing the ITP
ITP.result &lt;- ITP1fourier(NASAtemp$milan,maxfrequency=20,B=1000)
# Plotting the results of the ITP
plot(ITP.result,main='NASA data',xrange=c(1,365),xlab='Day')

# Plotting the p-value heatmap
ITPimage(ITP.result,abscissa.range=c(1,365))

# Selecting the significant coefficients
which(ITP.result$corrected.pval &lt; 0.05)

</code></pre>

<hr>
<h2 id='ITP2bspline'>
Two populations Interval Testing Procedure with B-spline basis
</h2><span id='topic+ITP2bspline'></span>

<h3>Description</h3>

<p>The function implements the Interval Testing Procedure for testing the difference between two functional populations evaluated on a uniform grid. Data are represented by means of the B-spline basis and the significance of each basis coefficient is tested with an interval-wise control of the Family Wise Error Rate. The default parameters of the basis expansion lead to the piece-wise interpolating function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ITP2bspline(data1, data2, mu = 0, 
            order = 2, nknots = dim(data1)[2], B = 10000, paired = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ITP2bspline_+3A_data1">data1</code></td>
<td>

<p>Pointwise evaluations of the first population's functional data set on a uniform grid. <code>data1</code> is a matrix of dimensions <code>c(n1,J)</code>, with <code>J</code> evaluations on columns and <code>n1</code> units on rows.
</p>
</td></tr>
<tr><td><code id="ITP2bspline_+3A_data2">data2</code></td>
<td>

<p>Pointwise evaluations of the second population's functional data set on a uniform grid. <code>data2</code> is a matrix of dimensions <code>c(n2,J)</code>, with <code>J</code> evaluations on columns and <code>n2</code> units on rows.
</p>
</td></tr>
<tr><td><code id="ITP2bspline_+3A_mu">mu</code></td>
<td>

<p>The difference between the first functional population and the second functional population under the null hypothesis. Either a constant (in this case, a constant function is used) or a <code>J</code>-dimensional vector containing the evaluations on the same grid which <code>data</code> are evaluated. The default is <code>mu=0</code>.
</p>
</td></tr>
<tr><td><code id="ITP2bspline_+3A_order">order</code></td>
<td>

<p>Order of the B-spline basis expansion. The default is <code>order=2</code>.
</p>
</td></tr>
<tr><td><code id="ITP2bspline_+3A_nknots">nknots</code></td>
<td>

<p>Number of knots of the B-spline basis expansion. The default is <code>nknots=dim(data1)[2]</code>.
</p>
</td></tr>
<tr><td><code id="ITP2bspline_+3A_b">B</code></td>
<td>

<p>The number of iterations of the MC algorithm to evaluate the p-values of the permutation tests. The defualt is <code>B=10000</code>.
</p>
</td></tr>
<tr><td><code id="ITP2bspline_+3A_paired">paired</code></td>
<td>

<p>A logical indicating whether the test is paired. The default is <code>FALSE</code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>ITP2bspline</code> returns an object of <code><a href="base.html#topic+class">class</a></code> &quot;<code>ITP2</code>&quot;.
</p>
<p>An object of class &quot;<code>ITP2</code>&quot; is a list containing at least the following components:
</p>
<table>
<tr><td><code>basis</code></td>
<td>
<p>String vector indicating the basis used for the first phase of the algorithm. In this case equal to <code>"B-spline"</code>.</p>
</td></tr>
<tr><td><code>test</code></td>
<td>
<p>String vector indicating the type of test performed. In this case equal to <code>"2pop"</code>.</p>
</td></tr>
<tr><td><code>mu</code></td>
<td>
<p>Difference between the first functional population and the second functional population under the null hypothesis (as entered by the user).</p>
</td></tr>
<tr><td><code>paired</code></td>
<td>
<p>Logical indicating whether the test is paired (as entered by the user).</p>
</td></tr>
<tr><td><code>coeff</code></td>
<td>
<p>Matrix of dimensions <code>c(n,p)</code> of the <code>p</code> coefficients of the B-spline basis expansion, with <code>n=n1+n2</code>. Rows are associated to units and columns to the basis index. The first <code>n1</code> rows report the coefficients of the first population units and the following <code>n2</code> rows report the coefficients of the second population units</p>
</td></tr>
<tr><td><code>pval</code></td>
<td>
<p>Uncorrected p-values for each basis coefficient.</p>
</td></tr>
<tr><td><code>pval.matrix</code></td>
<td>
<p>Matrix of dimensions <code>c(p,p)</code> of the p-values of the multivariate tests. The element <code>(i,j)</code> of matrix <code>pval.matrix</code> contains the p-value of the joint NPC test of the components <code>(j,j+1,...,j+(p-i))</code>.</p>
</td></tr>
<tr><td><code>corrected.pval</code></td>
<td>
<p>Corrected p-values for each basis coefficient.</p>
</td></tr>
<tr><td><code>labels</code></td>
<td>
<p>Labels indicating the population membership of each data.</p>
</td></tr>
<tr><td><code>data.eval</code></td>
<td>
<p>Evaluation on a fine uniform grid of the functional data obtained through the basis expansion.</p>
</td></tr>
<tr><td><code>heatmap.matrix</code></td>
<td>
<p>Heatmap matrix of p-values (used only for plots).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Alessia Pini, Simone Vantini
</p>


<h3>References</h3>

<p>A. Pini and S. Vantini (2013). The Interval Testing Procedure: Inference for Functional Data Controlling the Family Wise Error Rate on Intervals. <em>MOX-report 13/2013</em>, Politecnico di Milano.
</p>


<h3>See Also</h3>

<p>For tests of comparison between two populations, see <code><a href="#topic+ITP2fourier">ITP2fourier</a></code>, <code><a href="#topic+ITP2pafourier">ITP2pafourier</a></code>.
For different types of ITP-based tests, see <code><a href="#topic+ITP1bspline">ITP1bspline</a></code>, <code><a href="#topic+ITP1fourier">ITP1fourier</a></code>, <code><a href="#topic+ITPlmbspline">ITPlmbspline</a></code>, <code><a href="#topic+ITPaovbspline">ITPaovbspline</a></code> and <code><a href="#topic+ITPimage">ITPimage</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Importing the NASA temperatures data set
data(NASAtemp)
# Performing the ITP
ITP.result &lt;- ITP2bspline(NASAtemp$milan,NASAtemp$paris,nknots=50,B=1000)

# Plotting the results of the ITP
plot(ITP.result,main='NASA data',xrange=c(1,365),xlab='Day')

# Plotting the p-values heatmap
ITPimage(ITP.result,abscissa.range=c(0,12))

# Selecting the significant components at 5% level
which(ITP.result$corrected.pval &lt; 0.05)

</code></pre>

<hr>
<h2 id='ITP2fourier'>
Two populations Interval Testing Procedure with Fourier basis
</h2><span id='topic+ITP2fourier'></span>

<h3>Description</h3>

<p>The function implements the Interval Testing Procedure for testing the difference between two functional populations evaluated on a uniform grid. Data are represented by means of the Fourier basis and the significance of each basis coefficient is tested with an interval-wise control of the Family Wise Error Rate. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ITP2fourier(data1, data2, mu = 0, 
            maxfrequency=floor(dim(data1)[2]/2), B = 10000, paired = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ITP2fourier_+3A_data1">data1</code></td>
<td>

<p>Pointwise evaluations of the first population's functional data set on a uniform grid. <code>data1</code> is a matrix of dimensions <code>c(n1,J)</code>, with <code>J</code> evaluations on columns and <code>n1</code> units on rows.
</p>
</td></tr>
<tr><td><code id="ITP2fourier_+3A_data2">data2</code></td>
<td>

<p>Pointwise evaluations of the second population's functional data set on a uniform grid. <code>data2</code> is a matrix of dimensions <code>c(n2,J)</code>, with <code>J</code> evaluations on columns and <code>n2</code> units on rows.
</p>
</td></tr>
<tr><td><code id="ITP2fourier_+3A_mu">mu</code></td>
<td>

<p>The difference between the first functional population and the second functional population under the null hypothesis. Either a constant (in this case, a constant function is used) or a <code>J</code>-dimensional vector containing the evaluations on the same grid which <code>data</code> are evaluated. The default is <code>mu=0</code>.
</p>
</td></tr>
<tr><td><code id="ITP2fourier_+3A_maxfrequency">maxfrequency</code></td>
<td>

<p>The maximum frequency to be used in the Fourier basis expansion of data. The default is <code>floor(dim(data1)[2]/2)</code>, leading to an interpolating expansion.
</p>
</td></tr>
<tr><td><code id="ITP2fourier_+3A_b">B</code></td>
<td>

<p>The number of iterations of the MC algorithm to evaluate the p-values of the permutation tests. The defualt is <code>B=10000</code>.
</p>
</td></tr>
<tr><td><code id="ITP2fourier_+3A_paired">paired</code></td>
<td>

<p>A logical indicating whether the test is paired. The default is <code>FALSE</code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>ITP2fourier</code> returns an object of <code><a href="base.html#topic+class">class</a></code> &quot;<code>ITP2</code>&quot;.
</p>
<p>An object of class &quot;<code>ITP2</code>&quot; is a list containing at least the following components:
</p>
<table>
<tr><td><code>basis</code></td>
<td>
<p>String vector indicating the basis used for the first phase of the algorithm. In this case equal to <code>"Fourier"</code>.</p>
</td></tr>
<tr><td><code>test</code></td>
<td>
<p>String vector indicating the type of test performed. in this case equal to <code>"2pop"</code>.</p>
</td></tr>
<tr><td><code>mu</code></td>
<td>
<p>Difference between the first functional population and the second functional population under the null hypothesis (as entered by the user).</p>
</td></tr>
<tr><td><code>paired</code></td>
<td>
<p>Logical indicating whether the test is paired (as entered by the user).</p>
</td></tr>
<tr><td><code>coeff</code></td>
<td>
<p>Matrix of dimensions <code>c(n,p)</code> of the <code>p</code> coefficients of the Fourier basis expansion. Rows are associated to units and columns to the basis index: the first <code>n1</code> rows report the coefficients of the first population units and the following <code>n2</code> rows report the coefficients of the second population units; the first column is a0, the following <code>(p-1)/2</code> columns are the ak coefficients (sine coefficients) and the last <code>(p-1)/2</code> columns the bk coefficients (cosine coefficients).</p>
</td></tr>
<tr><td><code>pval</code></td>
<td>
<p>Uncorrected p-values for each frequency.</p>
</td></tr>
<tr><td><code>pval.matrix</code></td>
<td>
<p>Matrix of dimensions <code>c(p,p)</code> of the p-values of the multivariate tests. The element <code>(i,j)</code> of matrix <code>pval.matrix</code> contains the p-value of the joint NPC test of the frequencies <code>(j,j+1,...,j+(p-i))</code>.</p>
</td></tr>
<tr><td><code>corrected.pval</code></td>
<td>
<p>Corrected p-values for each frequency.</p>
</td></tr>
<tr><td><code>labels</code></td>
<td>
<p>Labels indicating the population membership of each data.</p>
</td></tr>
<tr><td><code>data.eval</code></td>
<td>
<p>Evaluation on a fine uniform grid of the functional data obtained through the basis expansion.</p>
</td></tr>
<tr><td><code>heatmap.matrix</code></td>
<td>
<p>Heatmap matrix of p-values (used only for plots).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Alessia Pini, Simone Vantini
</p>


<h3>References</h3>

<p>A. Pini and S. Vantini (2013). The Interval Testing Procedure: Inference for Functional Data Controlling the Family Wise Error Rate on Intervals. <em>MOX-report 13/2013</em>, Politecnico di Milano.
</p>


<h3>See Also</h3>

<p>See also <code><a href="#topic+ITP2pafourier">ITP2pafourier</a></code>,  <code><a href="#topic+ITP2bspline">ITP2bspline</a></code>, <code><a href="#topic+ITP1fourier">ITP1fourier</a></code>, <code><a href="#topic+ITP1bspline">ITP1bspline</a></code>, and <code><a href="#topic+ITPimage">ITPimage</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Importing the NASA temperatures data set
data(NASAtemp)
# Performing the ITP
ITP.result &lt;- ITP2fourier(NASAtemp$milan,NASAtemp$paris,maxfrequency=20,B=1000,paired=TRUE)

# Plotting the results of the ITP
plot(ITP.result,main='NASA data',xrange=c(1,365),xlab='Day')

# Plotting the p-value heatmap
ITPimage(ITP.result,abscissa.range=c(1,365))

# Selecting the significant coefficients
which(ITP.result$corrected.pval &lt; 0.05)

</code></pre>

<hr>
<h2 id='ITP2pafourier'>
Two populations Interval Testing Procedure with Fourier basis (phase-amplitude decomposition)
</h2><span id='topic+ITP2pafourier'></span>

<h3>Description</h3>

<p>The function implements the Interval Testing Procedure for testing the difference between two functional populations evaluated on a uniform grid. Data are represented by means of the Fourier basis expansion with the phase-amplitude decomposition and the significance of the amplitude and phase of each frequency is tested with an interval-wise control of the Family Wise Error Rate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ITP2pafourier(data1, data2, 
              maxfrequency=floor(dim(data1)[2]/2), B = 10000, paired = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ITP2pafourier_+3A_data1">data1</code></td>
<td>

<p>Pointwise evaluations of the first population's functional data set on a uniform grid. <code>data1</code> is a matrix of dimensions <code>c(n1,J)</code>, with <code>J</code> evaluations on columns and <code>n1</code> units on rows.
</p>
</td></tr>
<tr><td><code id="ITP2pafourier_+3A_data2">data2</code></td>
<td>

<p>Pointwise evaluations of the second population's functional data set on a uniform grid. <code>data2</code> is a matrix of dimensions <code>c(n2,J)</code>, with <code>J</code> evaluations on columns and <code>n2</code> units on rows.
</p>
</td></tr>
<tr><td><code id="ITP2pafourier_+3A_maxfrequency">maxfrequency</code></td>
<td>

<p>The maximum frequency to be used in the Fourier basis expansion of data. The default is <code>floor(dim(data1)[2]/2)</code>, leading to an interpolating expansion.
</p>
</td></tr>
<tr><td><code id="ITP2pafourier_+3A_b">B</code></td>
<td>

<p>The number of iterations of the MC algorithm to evaluate the p-values of the permutation tests. The defualt is <code>B=10000</code>.
</p>
</td></tr>
<tr><td><code id="ITP2pafourier_+3A_paired">paired</code></td>
<td>

<p>A logical indicating whether the test is paired. The default is <code>FALSE</code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>ITP2pafourier</code> returns an object of <code><a href="base.html#topic+class">class</a></code> &quot;<code>ITP2</code>&quot;.
</p>
<p>An object of class &quot;<code>ITP2</code>&quot; is a list containing at least the following components:
</p>
<table>
<tr><td><code>basis</code></td>
<td>
<p>String vector indicating the basis used for the first phase of the algorithm. Equal to <code>"paFourier"</code>.</p>
</td></tr>
<tr><td><code>test</code></td>
<td>
<p>String vector indicating the type of test performed. Equal to <code>"2pop"</code>.</p>
</td></tr>
<tr><td><code>paired</code></td>
<td>
<p>Logical indicating whether the test is paired (as entered by the user).</p>
</td></tr>
<tr><td><code>coeff_phase</code></td>
<td>
<p>Matrix of dimensions <code>c(n,p)</code> of the <code>p</code> phases of the Fourier basis expansion. Rows are associated to units and columns to frequencies: the first <code>n1</code> rows report the coefficients of the first population units and the following <code>n2</code> rows report the coefficients of the second population units.</p>
</td></tr>
<tr><td><code>coeff_amplitude</code></td>
<td>
<p>Matrix of dimensions <code>c(n,p)</code> of the <code>p</code> amplitudes of the Fourier basis expansion. Rows are associated to units and columns to frequencies: the first <code>n1</code> rows report the coefficients of the first population units and the following <code>n2</code> rows report the coefficients of the second population units.</p>
</td></tr>
<tr><td><code>pval_phase</code></td>
<td>
<p>Uncorrected p-values of the phase tests for each frequency.</p>
</td></tr>
<tr><td><code>pval_amplitude</code></td>
<td>
<p>Uncorrected p-values of the amplitude tests for each frequency.</p>
</td></tr>
<tr><td><code>pval.matrix_phase</code></td>
<td>
<p>Matrix of dimensions <code>c(p,p)</code> of the p-values of the multivariate tests on phase. The element <code>(i,j)</code> of matrix <code>pval.matrix_phase</code> contains the p-value of the joint NPC test of the frequencies <code>(j,j+1,...,j+(p-i))</code>.</p>
</td></tr>
<tr><td><code>pval.matrix_amplitude</code></td>
<td>
<p>Matrix of dimensions <code>c(p,p)</code> of the p-values of the multivariate tests on amplitude. The element <code>(i,j)</code> of matrix <code>pval.matrix_amplitude</code> contains the p-value of the joint NPC test of the frequencies <code>(j,j+1,...,j+(p-i))</code>.</p>
</td></tr>
<tr><td><code>corrected.pval_phase</code></td>
<td>
<p>Corrected p-values of the phase tests for each frequency.</p>
</td></tr>
<tr><td><code>corrected.pval_amplitude</code></td>
<td>
<p>Corrected p-values of the amplitude tests for each frequency.</p>
</td></tr>
<tr><td><code>labels</code></td>
<td>
<p>Labels indicating the population membership of each data.</p>
</td></tr>
<tr><td><code>data.eval</code></td>
<td>
<p>Evaluation on a fine uniform grid of the functional data obtained through the basis expansion.</p>
</td></tr>
<tr><td><code>heatmap.matrix_phase</code></td>
<td>
<p>Heatmap matrix of p-values for phase (used only for plots).</p>
</td></tr>
<tr><td><code>heatmap.matrix_amplitude</code></td>
<td>
<p>Heatmap matrix of p-values for amplitude (used only for plots).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Alessia Pini, Simone Vantini
</p>


<h3>References</h3>

<p>A. Pini and S. Vantini (2013). The Interval Testing Procedure: Inference for Functional Data Controlling the Family Wise Error Rate on Intervals. <em>MOX-report 13/2013</em>, Politecnico di Milano.
</p>


<h3>See Also</h3>

<p>See also <code><a href="#topic+ITP2fourier">ITP2fourier</a></code>,  <code><a href="#topic+ITP2bspline">ITP2bspline</a></code>, <code><a href="#topic+ITP1fourier">ITP1fourier</a></code>, <code><a href="#topic+ITP1bspline">ITP1bspline</a></code>, and <code><a href="#topic+ITPimage">ITPimage</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Importing the NASA temperatures data set
data(NASAtemp)
# Performing the ITP
ITP.result &lt;- ITP2pafourier(NASAtemp$milan,NASAtemp$paris,maxfrequency=20,B=1000,paired=TRUE)
# Plotting the results of the ITP
plot(ITP.result,main='NASA data',xrange=c(1,365),xlab='Day')

# Plotting the p-value heatmap
ITPimage(ITP.result,abscissa.range=c(1,365))


# Selecting the significant coefficients
which(ITP.result$corrected.pval &lt; 0.05)

</code></pre>

<hr>
<h2 id='ITPaovbspline'>
Interval Testing Procedure for testing Functional analysis of variance with B-spline basis
</h2><span id='topic+ITPaovbspline'></span>

<h3>Description</h3>

<p><code>ITPaovbspline</code> is used to fit and test functional analysis of variance.
The function implements the Interval Testing Procedure for testing for significant differences between several functional population evaluated on a uniform grid. Data are represented by means of the B-spline basis and the significance of each basis coefficient is tested with an interval-wise control of the Family Wise Error Rate. The default parameters of the basis expansion lead to the piece-wise interpolating function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ITPaovbspline(formula, order = 2, 
              nknots = dim(model.response(model.frame(formula)))[2], 
              B = 10000, method = "residuals")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ITPaovbspline_+3A_formula">formula</code></td>
<td>

<p>An object of class &quot;<code><a href="stats.html#topic+formula">formula</a></code>&quot; (or one that can be coerced to that class): a symbolic description of the model to be fitted.
</p>
</td></tr>
<tr><td><code id="ITPaovbspline_+3A_order">order</code></td>
<td>

<p>Order of the B-spline basis expansion. The default is <code>order=2</code>.
</p>
</td></tr>
<tr><td><code id="ITPaovbspline_+3A_nknots">nknots</code></td>
<td>

<p>Number of knots of the B-spline basis expansion. 
</p>
<p>The default is <code>dim(model.response(model.frame(formula)))[2]</code>.
</p>
</td></tr>
<tr><td><code id="ITPaovbspline_+3A_b">B</code></td>
<td>

<p>The number of iterations of the MC algorithm to evaluate the p-values of the permutation tests. The defualt is <code>B=10000</code>.
</p>
</td></tr>
<tr><td><code id="ITPaovbspline_+3A_method">method</code></td>
<td>

<p>Permutation method used to calculate the p-value of permutation tests. Choose &quot;<code>residuals</code>&quot; for the permutations of residuals under the reduced model, according to the Freedman and Lane scheme, and &quot;<code>responses</code>&quot; for the permutation of the responses, according to the Manly scheme. 
</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>ITPaovbspline</code> returns an object of <code><a href="base.html#topic+class">class</a></code> &quot;<code>ITPaov</code>&quot;.
</p>
<p>The function <code>summary</code> is used to obtain and print a summary of the results. 
</p>
<p>An object of class &quot;<code>ITPlm</code>&quot; is a list containing at least the following components:
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>The matched call.</p>
</td></tr>
<tr><td><code>design.matrix</code></td>
<td>
<p>The design matrix of the functional-on-scalar linear model.</p>
</td></tr>
<tr><td><code>basis</code></td>
<td>
<p>String vector indicating the basis used for the first phase of the algorithm. In this case equal to <code>"B-spline"</code>.</p>
</td></tr>
<tr><td><code>coeff</code></td>
<td>
<p>Matrix of dimensions <code>c(n,p)</code> of the <code>p</code> coefficients of the B-spline basis expansion. Rows are associated to units and columns to the basis index.</p>
</td></tr>
<tr><td><code>coeff.regr</code></td>
<td>
<p>Matrix of dimensions <code>c(L+1,p)</code> of the <code>p</code> coefficients of the B-spline basis expansion of the intercept (first row) and the <code>L</code> effects of the covariates specified in <code>formula</code>. Columns are associated to the basis index.</p>
</td></tr>
<tr><td><code>pval.F</code></td>
<td>
<p>Uncorrected p-values of the functional F-test for each basis coefficient.</p>
</td></tr>
<tr><td><code>pval.matrix.F</code></td>
<td>
<p>Matrix of dimensions <code>c(p,p)</code> of the p-values of the multivariate F-tests. The element <code>(i,j)</code> of matrix <code>pval.matrix</code> contains the p-value of the joint NPC test of the components <code>(j,j+1,...,j+(p-i))</code>.</p>
</td></tr>
<tr><td><code>corrected.pval.F</code></td>
<td>
<p>Corrected p-values of the functional F-test for each basis coefficient.</p>
</td></tr>
<tr><td><code>pval.factors</code></td>
<td>
<p>Uncorrected p-values of the functional F-tests on each factor of the analysis of variance, separately (rows) and each basis coefficient (columns).</p>
</td></tr>
<tr><td><code>pval.matrix.factors</code></td>
<td>
<p>Array of dimensions <code>c(L+1,p,p)</code> of the p-values of the multivariate F-tests on factors. The element <code>(l,i,j)</code> of array <code>pval.matrix</code> contains the p-value of the joint NPC test on factor <code>l</code> of the components <code>(j,j+1,...,j+(p-i))</code>.</p>
</td></tr>
<tr><td><code>corrected.pval.factors</code></td>
<td>
<p>Corrected p-values of the functional F-tests on each factor of the analysis of variance (rows) and each basis coefficient (columns).</p>
</td></tr>
<tr><td><code>data.eval</code></td>
<td>
<p>Evaluation on a fine uniform grid of the functional data obtained through the basis expansion.</p>
</td></tr>
<tr><td><code>coeff.regr.eval</code></td>
<td>
<p>Evaluation on a fine uniform grid of the functional regression coefficients.</p>
</td></tr>
<tr><td><code>fitted.eval</code></td>
<td>
<p>Evaluation on a fine uniform grid of the fitted values of the functional regression.</p>
</td></tr>
<tr><td><code>residuals.eval</code></td>
<td>
<p>Evaluation on a fine uniform grid of the residuals of the functional regression.</p>
</td></tr>
<tr><td><code>R2.eval</code></td>
<td>
<p>Evaluation on a fine uniform grid of the functional R-squared of the regression.</p>
</td></tr>
<tr><td><code>heatmap.matrix.F</code></td>
<td>
<p>Heatmap matrix of p-values of functional F-test (used only for plots).</p>
</td></tr>
<tr><td><code>heatmap.matrix.factors</code></td>
<td>
<p>Heatmap matrix of p-values of functional F-tests on each factor of the analysis of variance (used only for plots).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Alessia Pini, Simone Vantini
</p>


<h3>References</h3>

<p>D. Freedman and D. Lane (1983). A Nonstochastic Interpretation of Reported Significance Levels. <em>Journal of Business &amp; Economic Statistics</em> 1.4, 292-298.
</p>
<p>B. F. J. Manly (2006). Randomization, <em>Bootstrap and Monte Carlo Methods in Biology</em>. Vol. 70. CRC Press.
</p>
<p>A. Pini and S. Vantini (2013). The Interval Testing Procedure: Inference for Functional Data Controlling the Family Wise Error Rate on Intervals. <em>MOX-report 13/2013</em>, Politecnico di Milano.
</p>
<p>K. Abramowicz, S. De Luna, C. Häger, A. Pini, L. Schelin, and S. Vantini (2015). Distribution-Free Interval-Wise Inference for Functional-on-Scalar Linear Models. <em>MOX-report 3/2015</em>, Politecnico di Milano.
</p>


<h3>See Also</h3>

<p>See <code><a href="#topic+summary.ITPaov">summary.ITPaov</a></code> for summaries and <code><a href="#topic+plot.ITPaov">plot.ITPaov</a></code> for plotting the results. 
</p>
<p>See also <code><a href="#topic+ITPlmbspline">ITPlmbspline</a></code> to fit and test a functional-on-scalar linear model applying the ITP, and <code><a href="#topic+ITP1bspline">ITP1bspline</a></code>, <code><a href="#topic+ITP2bspline">ITP2bspline</a></code>, <code><a href="#topic+ITP2fourier">ITP2fourier</a></code>, <code><a href="#topic+ITP2pafourier">ITP2pafourier</a></code> for one-population and two-population tests.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Importing the NASA temperatures data set
data(NASAtemp)

temperature &lt;- rbind(NASAtemp$milan,NASAtemp$paris)
groups &lt;- c(rep(0,22),rep(1,22))

# Performing the ITP
ITP.result &lt;- ITPaovbspline(temperature ~ groups,B=1000,nknots=20,order=3)

# Summary of the ITP results
summary(ITP.result)

# Plot of the ITP results
layout(1)
plot(ITP.result)

# All graphics on the same device
layout(matrix(1:4,nrow=2,byrow=FALSE))
plot(ITP.result,main='NASA data', plot.adjpval = TRUE,xlab='Day',xrange=c(1,365))

</code></pre>

<hr>
<h2 id='ITPimage'>
Plot of the Interval Testing Procedure results
</h2><span id='topic+ITPimage'></span>

<h3>Description</h3>

<p>Plotting function creating a graphical output of the ITP: the p-value heat-map, the plot of the corrected p-values, and the plot of the functional data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ITPimage(ITP.result, alpha = 0.05, abscissa.range = c(0, 1), nlevel = 20)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ITPimage_+3A_itp.result">ITP.result</code></td>
<td>

<p>Results of the ITP, as created by <code><a href="#topic+ITP1bspline">ITP1bspline</a></code>, <code><a href="#topic+ITP1fourier">ITP1fourier</a></code>, <code><a href="#topic+ITP2bspline">ITP2bspline</a></code>, <code><a href="#topic+ITP2fourier">ITP2fourier</a></code>, and <code><a href="#topic+ITP2pafourier">ITP2pafourier</a></code>.
</p>
</td></tr>
<tr><td><code id="ITPimage_+3A_alpha">alpha</code></td>
<td>

<p>Level of the hypothesis test. The default is <code>alpha</code>=0.05.
</p>
</td></tr>
<tr><td><code id="ITPimage_+3A_abscissa.range">abscissa.range</code></td>
<td>

<p>Range of the plot abscissa. The default is <code>c(0,1)</code>.
</p>
</td></tr>
<tr><td><code id="ITPimage_+3A_nlevel">nlevel</code></td>
<td>

<p>Number of desired color levels for the p-value heatmap. The default is <code>nlevel=20</code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No value returned. 
The function produces a graphical output of the ITP results: the p-value heatmap, a plot of the corrected p-values and the plot of the functional data. 
The basis components selected as significant by the test at level <code>alpha</code> are highlighted in the plot of the corrected p-values by a gray area. 
</p>


<h3>Author(s)</h3>

<p>Alessia pini, Simone Vantini
</p>


<h3>References</h3>

<p>A. Pini and S. Vantini (2013). The Interval Testing Procedure: Inference for Functional Data Controlling the Family Wise Error Rate on Intervals. <em>MOX-report 13/2013</em>, Politecnico di Milano.
</p>


<h3>See Also</h3>

<p>See <code><a href="#topic+plot.ITP1">plot.ITP1</a></code>, <code><a href="#topic+plot.ITP2">plot.ITP2</a></code>, <code><a href="#topic+plot.ITPlm">plot.ITPlm</a></code>, and <code><a href="#topic+plot.ITPaov">plot.ITPaov</a></code> for the plot method applied to the ITP results of one- and two-population tests, linear models, and ANOVA, respectively.
</p>
<p>See also <code><a href="#topic+ITP1bspline">ITP1bspline</a></code>, <code><a href="#topic+ITP1fourier">ITP1fourier</a></code>, <code><a href="#topic+ITP2bspline">ITP2bspline</a></code>, <code><a href="#topic+ITP2fourier">ITP2fourier</a></code>, and <code><a href="#topic+ITP2pafourier">ITP2pafourier</a></code> for applying the ITP.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Importing the NASA temperatures data set
data(NASAtemp)

# Performing the ITP for two populations with the B-spline basis
ITP.result &lt;- ITP2bspline(NASAtemp$milan,NASAtemp$paris,nknots=20,B=1000)

# Plotting the results of the ITP
ITPimage(ITP.result,abscissa.range=c(0,12))

# Selecting the significant components for the radius at 5% level
which(ITP.result$corrected.pval &lt; 0.05)

</code></pre>

<hr>
<h2 id='ITPlmbspline'>
Interval Testing Procedure for testing Functional-on-Scalar Linear Models with B-spline basis
</h2><span id='topic+ITPlmbspline'></span>

<h3>Description</h3>

<p><code>ITPlmbspline</code> is used to fit and test functional linear models. It can be used to carry out regression, and analysis of variance.
The function implements the Interval Testing Procedure for testing the significance of the effects of scalar covariates on a functional population evaluated on a uniform grid. Data are represented by means of the B-spline basis and the significance of each basis coefficient is tested with an interval-wise control of the Family Wise Error Rate. The default parameters of the basis expansion lead to the piece-wise interpolating function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ITPlmbspline(formula, order = 2, 
             nknots = dim(model.response(model.frame(formula)))[2], 
             B = 10000, method = "residuals")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ITPlmbspline_+3A_formula">formula</code></td>
<td>

<p>An object of class &quot;<code><a href="stats.html#topic+formula">formula</a></code>&quot; (or one that can be coerced to that class): a symbolic description of the model to be fitted.
</p>
</td></tr>
<tr><td><code id="ITPlmbspline_+3A_order">order</code></td>
<td>

<p>Order of the B-spline basis expansion. The default is <code>order=2</code>.
</p>
</td></tr>
<tr><td><code id="ITPlmbspline_+3A_nknots">nknots</code></td>
<td>

<p>Number of knots of the B-spline basis expansion. 
</p>
<p>The default is <code>dim(model.response(model.frame(formula)))[2]</code>.
</p>
</td></tr>
<tr><td><code id="ITPlmbspline_+3A_b">B</code></td>
<td>

<p>The number of iterations of the MC algorithm to evaluate the p-values of the permutation tests. The defualt is <code>B=10000</code>.
</p>
</td></tr>
<tr><td><code id="ITPlmbspline_+3A_method">method</code></td>
<td>

<p>Permutation method used to calculate the p-value of permutation tests. Choose &quot;<code>residuals</code>&quot; for the permutations of residuals under the reduced model, according to the Freedman and Lane scheme, and &quot;<code>responses</code>&quot; for the permutation of the responses, according to the Manly scheme. 
</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>ITPlmbspline</code> returns an object of <code><a href="base.html#topic+class">class</a></code> &quot;<code>ITPlm</code>&quot;.
</p>
<p>The function <code>summary</code> is used to obtain and print a summary of the results. 
</p>
<p>An object of class &quot;<code>ITPlm</code>&quot; is a list containing at least the following components:
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>The matched call.</p>
</td></tr>
<tr><td><code>design.matrix</code></td>
<td>
<p>The design matrix of the functional-on-scalar linear model.</p>
</td></tr>
<tr><td><code>basis</code></td>
<td>
<p>String vector indicating the basis used for the first phase of the algorithm. In this case equal to <code>"B-spline"</code>.</p>
</td></tr>
<tr><td><code>coeff</code></td>
<td>
<p>Matrix of dimensions <code>c(n,p)</code> of the <code>p</code> coefficients of the B-spline basis expansion. Rows are associated to units and columns to the basis index.</p>
</td></tr>
<tr><td><code>coeff.regr</code></td>
<td>
<p>Matrix of dimensions <code>c(L+1,p)</code> of the <code>p</code> coefficients of the B-spline basis expansion of the intercept (first row) and the <code>L</code> effects of the covariates specified in <code>formula</code>. Columns are associated to the basis index.</p>
</td></tr>
<tr><td><code>pval.F</code></td>
<td>
<p>Uncorrected p-values of the functional F-test for each basis coefficient.</p>
</td></tr>
<tr><td><code>pval.matrix.F</code></td>
<td>
<p>Matrix of dimensions <code>c(p,p)</code> of the p-values of the multivariate F-tests. The element <code>(i,j)</code> of matrix <code>pval.matrix</code> contains the p-value of the joint NPC test of the components <code>(j,j+1,...,j+(p-i))</code>.</p>
</td></tr>
<tr><td><code>corrected.pval.F</code></td>
<td>
<p>Corrected p-values of the functional F-test for each basis coefficient.</p>
</td></tr>
<tr><td><code>pval.t</code></td>
<td>
<p>Uncorrected p-values of the functional t-tests for each partial regression coefficient including the intercept (rows) and each basis coefficient (columns).</p>
</td></tr>
<tr><td><code>pval.matrix.t</code></td>
<td>
<p>Array of dimensions <code>c(L+1,p,p)</code> of the p-values of the multivariate t-tests. The element <code>(l,i,j)</code> of array <code>pval.matrix</code> contains the p-value of the joint NPC test on covariate <code>l</code> of the components <code>(j,j+1,...,j+(p-i))</code>.</p>
</td></tr>
<tr><td><code>corrected.pval.t</code></td>
<td>
<p>Corrected p-values of the functional t-tests for each partial regression coefficient including the intercept (rows) and each basis coefficient (columns).</p>
</td></tr>
<tr><td><code>data.eval</code></td>
<td>
<p>Evaluation on a fine uniform grid of the functional data obtained through the basis expansion.</p>
</td></tr>
<tr><td><code>coeff.regr.eval</code></td>
<td>
<p>Evaluation on a fine uniform grid of the functional regression coefficients.</p>
</td></tr>
<tr><td><code>fitted.eval</code></td>
<td>
<p>Evaluation on a fine uniform grid of the fitted values of the functional regression.</p>
</td></tr>
<tr><td><code>residuals.eval</code></td>
<td>
<p>Evaluation on a fine uniform grid of the residuals of the functional regression.</p>
</td></tr>
<tr><td><code>R2.eval</code></td>
<td>
<p>Evaluation on a fine uniform grid of the functional R-squared of the regression.</p>
</td></tr>
<tr><td><code>heatmap.matrix.F</code></td>
<td>
<p>Heatmap matrix of p-values of functional F-test (used only for plots).</p>
</td></tr>
<tr><td><code>heatmap.matrix.t</code></td>
<td>
<p>Heatmap matrix of p-values of functional t-tests (used only for plots).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Alessia Pini, Simone Vantini
</p>


<h3>References</h3>

<p>D. Freedman and D. Lane (1983). A Nonstochastic Interpretation of Reported Significance Levels. <em>Journal of Business &amp; Economic Statistics</em> 1.4, 292-298.
</p>
<p>B. F. J. Manly (2006). Randomization, <em>Bootstrap and Monte Carlo Methods in Biology</em>. Vol. 70. CRC Press.
</p>
<p>A. Pini and S. Vantini (2013). The Interval Testing Procedure: Inference for Functional Data Controlling the Family Wise Error Rate on Intervals. <em>MOX-report 13/2013</em>, Politecnico di Milano.
</p>
<p>K. Abramowicz, S. De Luna, C. Häger, A. Pini, L. Schelin, and S. Vantini (2015). Distribution-Free Interval-Wise Inference for Functional-on-Scalar Linear Models. <em>MOX-report 3/2015</em>, Politecnico di Milano.
</p>


<h3>See Also</h3>

<p>See <code><a href="#topic+summary.ITPlm">summary.ITPlm</a></code> for summaries and <code><a href="#topic+plot.ITPlm">plot.ITPlm</a></code> for plotting the results. 
</p>
<p>See also <code><a href="#topic+ITPaovbspline">ITPaovbspline</a></code> to fit and test a functional analysis of variance applying the ITP, and <code><a href="#topic+ITP1bspline">ITP1bspline</a></code>, <code><a href="#topic+ITP2bspline">ITP2bspline</a></code>, <code><a href="#topic+ITP2fourier">ITP2fourier</a></code>, <code><a href="#topic+ITP2pafourier">ITP2pafourier</a></code> for one-population and two-population tests.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Importing the NASA temperatures data set
data(NASAtemp)

# Defining the covariates 
temperature &lt;- rbind(NASAtemp$milan,NASAtemp$paris)
groups &lt;- c(rep(0,22),rep(1,22))

# Performing the ITP
ITP.result &lt;- ITPlmbspline(temperature ~ groups,B=1000,nknots=20)
# Summary of the ITP results
summary(ITP.result)

# Plot of the ITP results
layout(1)
plot(ITP.result,main='NASA data', plot.adjpval = TRUE,xlab='Day',xrange=c(1,365))

# All graphics on the same device
layout(matrix(1:6,nrow=3,byrow=FALSE))
plot(ITP.result,main='NASA data', plot.adjpval = TRUE,xlab='Day',xrange=c(1,365))


</code></pre>

<hr>
<h2 id='NASAtemp'>
NASA daily temperatures data set
</h2><span id='topic+NASAtemp'></span>

<h3>Description</h3>

<p>It contains the daily mean temperatures registered from July 1983 to June 2005 and stored in the NASA database Earth Surface Meteorology for Solar Energy of two different geographical locations: the region (45-46 North, 9-10 East), including the city of Milan (Italy), and the region (48-49 North, 2-3 East), including the city of Paris (France).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(NASAtemp)</code></pre>


<h3>Format</h3>

<p>List of 2 elements:
</p>

<ul>
<li><p><code>milan</code> Matrix of dimensions <code>c(22,365)</code> containing the daily mean temperatures of the region (45-46 North, 9-10 East), including the city of Milan (Italy) registered from July 1983 to June 2005 (22 years).
</p>
</li>
<li><p><code>paris</code> Matrix of dimensions <code>c(22,365)</code> containing the daily mean temperatures of the region (48-49 North, 2-3 East), including the city of Paris (France) registered from July 1983 to June 2005 (22 years).
</p>
</li></ul>



<h3>Source</h3>

<p>These data were obtained from the NASA Langley Research Center Atmospheric Science Data Center Surface meteorological and Solar Energy (SSE) web portal supported by the NASA LaRC POWER Project. Data are freely available at: NASA Surface Meteorology and Solar Energy, A Renewable Energy Resource web site (release 6.0): http://eosweb.larc.nasa.gov
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(NASAtemp)
## Not run: 

matplot(t(NASAtemp$milan),type='l')
matplot(t(NASAtemp$paris),type='l')


## End(Not run)
</code></pre>

<hr>
<h2 id='plot.ITP1'>
Plotting ITP results for one-population tests
</h2><span id='topic+plot.ITP1'></span>

<h3>Description</h3>

<p><code>plot</code> method for class &quot;<code>ITP1</code>&quot;.
Plotting function creating a graphical output of the ITP for the test of the mean of one population: functional data and ITP-adjusted p-values are plotted.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ITP1'
plot(x, xrange = c(0, 1), alpha1 = 0.05, alpha2 = 0.01, 
     ylab = "Functional Data", main = NULL, lwd = 1, col = 1, 
     pch = 16, ylim = range(object$data.eval), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.ITP1_+3A_x">x</code></td>
<td>

<p>The object to be plotted.
An object of class &quot;<code>ITP1</code>&quot;, that is, a result of an ITP for comparison between two populations. Usually a call to <code><a href="#topic+ITP1bspline">ITP1bspline</a></code> or <code><a href="#topic+ITP1fourier">ITP1fourier</a></code>.
</p>
</td></tr>
<tr><td><code id="plot.ITP1_+3A_xrange">xrange</code></td>
<td>

<p>Range of the <code>x</code> axis.
</p>
</td></tr>
<tr><td><code id="plot.ITP1_+3A_alpha1">alpha1</code></td>
<td>

<p>First level of significance used to select and display significant differences. Default is <code>alpha1 = 0.05</code>.
</p>
</td></tr>
<tr><td><code id="plot.ITP1_+3A_alpha2">alpha2</code></td>
<td>

<p>Second level of significance used to select and display significant differences. Default is <code>alpha1 = 0.01</code>. <code>alpha1</code> and <code>alpha2</code> are s.t. <code>alpha2 &lt; alpha1</code>. Otherwise the two values are switched.
</p>
</td></tr>
<tr><td><code id="plot.ITP1_+3A_ylab">ylab</code></td>
<td>

<p>Label of <code>y</code> axis of the plot of functional data. Default is &quot;<code>Functional Data</code>&quot;.
</p>
</td></tr>
<tr><td><code id="plot.ITP1_+3A_main">main</code></td>
<td>

<p>An overall title for the plots (it will be pasted to &quot;<code>Functional Data</code>&quot; for the first plot and &quot;<code>adjusted p-values</code>&quot; for the second plot). 
</p>
</td></tr>
<tr><td><code id="plot.ITP1_+3A_lwd">lwd</code></td>
<td>

<p>Line width for the plot of functional data. 
</p>
</td></tr>
<tr><td><code id="plot.ITP1_+3A_col">col</code></td>
<td>

<p>Color used to plot the functional data.
</p>
</td></tr>
<tr><td><code id="plot.ITP1_+3A_pch">pch</code></td>
<td>

<p>Point character for the plot of adjusted p-values.
</p>
</td></tr>
<tr><td><code id="plot.ITP1_+3A_ylim">ylim</code></td>
<td>

<p>Range of the <code>y</code> axis.
</p>
</td></tr>
<tr><td><code id="plot.ITP1_+3A_...">...</code></td>
<td>

<p>Additional plotting arguments that can be used with function <code>plot</code>, such as <code><a href="graphics.html#topic+graphical+20parameters">graphical parameters</a></code> (see <code><a href="graphics.html#topic+par">par</a></code>).
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No value returned. 
The function produces a graphical output of the ITP results:  the plot of the functional data and the one of the adjusted p-values. 
The basis components selected as significant by the test at level <code>alpha1</code> and <code>alpha2</code> are highlighted in the plot of the corrected p-values and in the one of functional data (in case the test is based on a local basis, such as B-splines) by gray areas (light and dark gray, respectively). 
</p>


<h3>Author(s)</h3>

<p>Alessia Pini, Simone Vantini
</p>


<h3>References</h3>

<p>A. Pini and S. Vantini (2013). The Interval Testing Procedure: Inference for Functional Data Controlling the Family Wise Error Rate on Intervals. <em>MOX-report 13/2013</em>, Politecnico di Milano.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ITPimage">ITPimage</a></code> for the plot of p-values heatmaps. 
</p>
<p>See also <code><a href="#topic+ITP1bspline">ITP1bspline</a></code> and <code><a href="#topic+ITP1fourier">ITP1fourier</a></code> to perform the ITP to test for the mean of a functional populations. 
See <code><a href="#topic+plot.ITP2">plot.ITP2</a></code> and <code><a href="#topic+plot.ITPlm">plot.ITPlm</a></code> for the plot method applied to the ITP results of two-population tests and linear models, respectively.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Importing the NASA temperatures data set
data(NASAtemp)

# Performing the ITP for one population with the B-spline basis
ITP.result.bspline &lt;- ITP1bspline(NASAtemp$paris,mu=4,nknots=50,B=1000)
# Plotting the results of the ITP
plot(ITP.result.bspline,xlab='Day',xrange=c(0,365),main='NASA data')
# Selecting the significant components for the radius at 5% level
which(ITP.result.bspline$corrected.pval &lt; 0.05)


</code></pre>

<hr>
<h2 id='plot.ITP2'>
Plotting ITP results for two-population tests
</h2><span id='topic+plot.ITP2'></span>

<h3>Description</h3>

<p><code>plot</code> method for class &quot;<code>ITP2</code>&quot;.
Plotting function creating a graphical output of the ITP for the test of comparison between two populations: functional data and ITP-adjusted p-values are plotted.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ITP2'
plot(x, xrange = c(0, 1), alpha1 = 0.05, alpha2 = 0.01, 
     ylab = "Functional Data", main = NULL, lwd = 1, 
     col = c(1, 2), pch = 16, ylim = range(object$data.eval), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.ITP2_+3A_x">x</code></td>
<td>

<p>The object to be plotted.
An object of class &quot;<code>ITP2</code>&quot;, that is, a result of an ITP for comparison between two populations. Usually a call to <code><a href="#topic+ITP2bspline">ITP2bspline</a></code>, <code><a href="#topic+ITP2fourier">ITP2fourier</a></code> or <code><a href="#topic+ITP2pafourier">ITP2pafourier</a></code>.
</p>
</td></tr>
<tr><td><code id="plot.ITP2_+3A_xrange">xrange</code></td>
<td>

<p>Range of the <code>x</code> axis.
</p>
</td></tr>
<tr><td><code id="plot.ITP2_+3A_alpha1">alpha1</code></td>
<td>

<p>First level of significance used to select and display significant differences. Default is <code>alpha1 = 0.05</code>.
</p>
</td></tr>
<tr><td><code id="plot.ITP2_+3A_alpha2">alpha2</code></td>
<td>

<p>Second level of significance used to select and display significant differences. Default is <code>alpha1 = 0.01</code>. <code>alpha1</code> and <code>alpha2</code> are s.t. <code>alpha2 &lt; alpha1</code>. Otherwise the two values are switched.
</p>
</td></tr>
<tr><td><code id="plot.ITP2_+3A_ylab">ylab</code></td>
<td>

<p>Label of <code>y</code> axis of the plot of functional data. Default is &quot;<code>Functional Data</code>&quot;.
</p>
</td></tr>
<tr><td><code id="plot.ITP2_+3A_main">main</code></td>
<td>

<p>An overall title for the plots (it will be pasted to &quot;<code>Functional Data</code>&quot; for the first plot and &quot;<code>adjusted p-values</code>&quot; for the second plot). 
</p>
</td></tr>
<tr><td><code id="plot.ITP2_+3A_lwd">lwd</code></td>
<td>

<p>Line width for the plot of functional data. 
</p>
</td></tr>
<tr><td><code id="plot.ITP2_+3A_col">col</code></td>
<td>

<p>Color used to plot the functional data.
</p>
</td></tr>
<tr><td><code id="plot.ITP2_+3A_pch">pch</code></td>
<td>

<p>Point character for the plot of adjusted p-values.
</p>
</td></tr>
<tr><td><code id="plot.ITP2_+3A_ylim">ylim</code></td>
<td>

<p>Range of the <code>y</code> axis.
</p>
</td></tr>
<tr><td><code id="plot.ITP2_+3A_...">...</code></td>
<td>

<p>Additional plotting arguments that can be used with function <code>plot</code>, such as <code><a href="graphics.html#topic+graphical+20parameters">graphical parameters</a></code> (see <code><a href="graphics.html#topic+par">par</a></code>).
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No value returned. 
The function produces a graphical output of the ITP results:  the plot of the functional data and the one of the adjusted p-values. 
The basis components selected as significant by the test at level <code>alpha1</code> and <code>alpha2</code> are highlighted in the plot of the corrected p-values and in the one of functional data (in case the test is based on a local basis, such as B-splines) by gray areas (light and dark gray, respectively). 
In the case of a Fourier basis with amplitude and phase decomposition, two plots of adjusted p-values are done, one for phase and one for amplitude.
</p>


<h3>Author(s)</h3>

<p>Alessia Pini, Simone Vantini
</p>


<h3>References</h3>

<p>A. Pini and S. Vantini (2013). The Interval Testing Procedure: Inference for Functional Data Controlling the Family Wise Error Rate on Intervals. <em>MOX-report 13/2013</em>, Politecnico di Milano.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ITPimage">ITPimage</a></code> for the plot of p-values heatmaps. 
</p>
<p>See also <code><a href="#topic+ITP2bspline">ITP2bspline</a></code>, <code><a href="#topic+ITP2fourier">ITP2fourier</a></code>, <code><a href="#topic+ITP2pafourier">ITP2pafourier</a></code> to perform the ITP to test for differences between two populations. 
See <code><a href="#topic+plot.ITP1">plot.ITP1</a></code> and <code><a href="#topic+plot.ITPlm">plot.ITPlm</a></code> for the plot method applied to the ITP results of one-population tests and a linear models, respectively.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Importing the NASA temperatures data set
data(NASAtemp)

# Performing the ITP for two populations with the B-spline basis
ITP.result.bspline &lt;- ITP2bspline(NASAtemp$milan,NASAtemp$paris,nknots=30,B=1000)
# Plotting the results of the ITP
plot(ITP.result.bspline,xlab='Day',xrange=c(1,365),main='NASA data')

# Selecting the significant components for the radius at 5% level
which(ITP.result.bspline$corrected.pval &lt; 0.05)


</code></pre>

<hr>
<h2 id='plot.ITPaov'>
Plotting ITP results for functional analysis of variance testing
</h2><span id='topic+plot.ITPaov'></span>

<h3>Description</h3>

<p><code>plot</code> method for class &quot;<code>ITPaov</code>&quot;.
Plotting function creating a graphical output of the ITP for the test on a functional analysis of variance: functional data, and ITP-adjusted p-values of the F-tests on the whole model and on each factor are plotted.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ITPaov'
plot(x,xrange=c(0,1), alpha1=0.05, alpha2=0.01,
     plot.adjpval=FALSE,ylim=range(x$data.eval),col=1,
     ylab='Functional Data',main=NULL,lwd=1,pch=16,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.ITPaov_+3A_x">x</code></td>
<td>

<p>The object to be plotted.
An object of class &quot;<code>ITPaov</code>&quot;, usually, a result of a call to <code><a href="#topic+ITPaovbspline">ITPaovbspline</a></code>.
</p>
</td></tr>
<tr><td><code id="plot.ITPaov_+3A_xrange">xrange</code></td>
<td>

<p>Range of the <code>x</code> axis.
</p>
</td></tr>
<tr><td><code id="plot.ITPaov_+3A_alpha1">alpha1</code></td>
<td>

<p>First level of significance used to select and display significant effects. Default is <code>alpha1 = 0.05</code>.
</p>
</td></tr>
<tr><td><code id="plot.ITPaov_+3A_alpha2">alpha2</code></td>
<td>

<p>Second level of significance used to select and display significant effects. Default is <code>alpha1 = 0.01</code>. <code>alpha1</code> and <code>alpha2</code> are s.t. <code>alpha2 &lt; alpha1</code>. Otherwise the two values are switched.
</p>
</td></tr>
<tr><td><code id="plot.ITPaov_+3A_plot.adjpval">plot.adjpval</code></td>
<td>

<p>A logical indicating wether the plots of adjusted p-values have to be done. Default is <code>plot.adjpval = FALSE</code>.
</p>
</td></tr>
<tr><td><code id="plot.ITPaov_+3A_col">col</code></td>
<td>

<p>Colors for the plot of functional data. Default is <code>col = 1</code>.
</p>
</td></tr>
<tr><td><code id="plot.ITPaov_+3A_ylim">ylim</code></td>
<td>

<p>Range of the <code>y</code> axis. Default is <code>ylim = range(x$data.eval)</code>.
</p>
</td></tr>
<tr><td><code id="plot.ITPaov_+3A_ylab">ylab</code></td>
<td>

<p>Label of <code>y</code> axis of the plot of functional data. Default is &quot;<code>Functional Data</code>&quot;.
</p>
</td></tr>
<tr><td><code id="plot.ITPaov_+3A_main">main</code></td>
<td>

<p>An overall title for the plots (it will be pasted to &quot;<code>Functional Data and F-test</code>&quot; for the first plot and &quot;<code>factor</code>&quot; for the other plots). 
</p>
</td></tr>
<tr><td><code id="plot.ITPaov_+3A_lwd">lwd</code></td>
<td>

<p>Line width for the plot of functional data. Default is <code>lwd=16</code>.
</p>
</td></tr>
<tr><td><code id="plot.ITPaov_+3A_pch">pch</code></td>
<td>

<p>Point character for the plot of adjusted p-values. Default is <code>pch=16</code>.
</p>
</td></tr>
<tr><td><code id="plot.ITPaov_+3A_...">...</code></td>
<td>

<p>Additional plotting arguments that can be used with function <code>plot</code>, such as <code><a href="graphics.html#topic+graphical+20parameters">graphical parameters</a></code> (see <code><a href="graphics.html#topic+par">par</a></code>).
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No value returned. 
The function produces a graphical output of the ITP results:  the plot of the functional data, functional regression coefficients, and ITP-adjusted p-values of the F-tests on the whole model and on each factor. 
The basis components selected as significant by the tests at level <code>alpha1</code> and <code>alpha2</code> are highlighted in the plot of the corrected p-values and in the one of functional data by gray areas (light and dark gray, respectively). 
The first plot reports the gray areas corresponding to a significant F-test on the whole model. The remaining plots report the gray areas corresponding to significant F-tests on each factor (with colors corresponding to the levels of the factor).
</p>


<h3>Author(s)</h3>

<p>Alessia Pini, Simone Vantini
</p>


<h3>References</h3>

<p>A. Pini and S. Vantini (2013). The Interval Testing Procedure: Inference for Functional Data Controlling the Family Wise Error Rate on Intervals. <em>MOX-report 13/2013</em>, Politecnico di Milano.
</p>
<p>K. Abramowicz, S. De Luna, C. Häger, A. Pini, L. Schelin, and S. Vantini (2015). Distribution-Free Interval-Wise Inference for Functional-on-Scalar Linear Models. <em>MOX-report 3/2015</em>, Politecnico di Milano.
</p>


<h3>See Also</h3>

<p>See also <code><a href="#topic+ITPaovbspline">ITPaovbspline</a></code> to fit and test a functional analysis of variance applying the ITP, and <code><a href="#topic+summary.ITPaov">summary.ITPaov</a></code> for summaries. 
See <code><a href="#topic+plot.ITPlm">plot.ITPlm</a></code>, <code><a href="#topic+plot.ITP1">plot.ITP1</a></code>, and <code><a href="#topic+plot.ITP2">plot.ITP2</a></code> for the plot method applied to the ITP results of functional-on-scalar linear models, one-population and two-population, respectively.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Importing the NASA temperatures data set
data(NASAtemp)

temperature &lt;- rbind(NASAtemp$milan,NASAtemp$paris)
groups &lt;- c(rep(0,22),rep(1,22))

# Performing the ITP
ITP.result &lt;- ITPaovbspline(temperature ~ groups,B=1000,nknots=20,order=3)

# Summary of the ITP results
summary(ITP.result)

# Plot of the ITP results
layout(1)
plot(ITP.result)

# All graphics on the same device
layout(matrix(1:4,nrow=2,byrow=FALSE))
plot(ITP.result,main='NASA data', plot.adjpval = TRUE,xlab='Day',xrange=c(1,365))

</code></pre>

<hr>
<h2 id='plot.ITPlm'>
Plotting ITP results for functional-on-scalar linear model testing
</h2><span id='topic+plot.ITPlm'></span>

<h3>Description</h3>

<p><code>plot</code> method for class &quot;<code>ITPlm</code>&quot;.
Plotting function creating a graphical output of the ITP for the test on a functional-on-scalar linear model: functional data, functional coefficients and ITP-adjusted p-values for the F-test and t-tests are plotted.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ITPlm'
plot(x, xrange = c(0, 1), alpha1 = 0.05, alpha2 = 0.01, 
     plot.adjpval = FALSE, col = c(1, rainbow(dim(x$corrected.pval.t)[1])), 
     ylim = range(x$data.eval), ylab = "Functional Data", 
     main = NULL, lwd = 1, pch = 16, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.ITPlm_+3A_x">x</code></td>
<td>

<p>The object to be plotted.
An object of class &quot;<code>ITPlm</code>&quot;, usually, a result of a call to <code><a href="#topic+ITPlmbspline">ITPlmbspline</a></code>.
</p>
</td></tr>
<tr><td><code id="plot.ITPlm_+3A_xrange">xrange</code></td>
<td>

<p>Range of the <code>x</code> axis.
</p>
</td></tr>
<tr><td><code id="plot.ITPlm_+3A_alpha1">alpha1</code></td>
<td>

<p>First level of significance used to select and display significant effects. Default is <code>alpha1 = 0.05</code>.
</p>
</td></tr>
<tr><td><code id="plot.ITPlm_+3A_alpha2">alpha2</code></td>
<td>

<p>Second level of significance used to select and display significant effects. Default is <code>alpha1 = 0.01</code>. <code>alpha1</code> and <code>alpha2</code> are s.t. <code>alpha2 &lt; alpha1</code>. Otherwise the two values are switched.
</p>
</td></tr>
<tr><td><code id="plot.ITPlm_+3A_plot.adjpval">plot.adjpval</code></td>
<td>

<p>A logical indicating wether the plots of adjusted p-values have to be done. Default is <code>plot.adjpval = FALSE</code>.
</p>
</td></tr>
<tr><td><code id="plot.ITPlm_+3A_col">col</code></td>
<td>

<p>Vector of colors for the plot of functional data (first element), and functional coefficients (following elements). 
</p>
<p>Default is <code>col = c(1, rainbow(dim(x$corrected.pval.t)[1]))</code>.
</p>
</td></tr>
<tr><td><code id="plot.ITPlm_+3A_ylim">ylim</code></td>
<td>

<p>Range of the <code>y</code> axis. Default is <code>ylim = range(x$data.eval)</code>.
</p>
</td></tr>
<tr><td><code id="plot.ITPlm_+3A_ylab">ylab</code></td>
<td>

<p>Label of <code>y</code> axis of the plot of functional data. Default is &quot;<code>Functional Data</code>&quot;.
</p>
</td></tr>
<tr><td><code id="plot.ITPlm_+3A_main">main</code></td>
<td>

<p>An overall title for the plots (it will be pasted to &quot;<code>Functional Data and F-test</code>&quot; for the first plot and &quot;<code>t-test</code>&quot; for the other plots). 
</p>
</td></tr>
<tr><td><code id="plot.ITPlm_+3A_lwd">lwd</code></td>
<td>

<p>Line width for the plot of functional data. Default is <code>lwd=16</code>.
</p>
</td></tr>
<tr><td><code id="plot.ITPlm_+3A_pch">pch</code></td>
<td>

<p>Point character for the plot of adjusted p-values. Default is <code>pch=16</code>.
</p>
</td></tr>
<tr><td><code id="plot.ITPlm_+3A_...">...</code></td>
<td>

<p>Additional plotting arguments that can be used with function <code>plot</code>, such as <code><a href="graphics.html#topic+graphical+20parameters">graphical parameters</a></code> (see <code><a href="graphics.html#topic+par">par</a></code>).
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No value returned. 
The function produces a graphical output of the ITP results:  the plot of the functional data, functional regression coefficients, and ITP-adjusted p-values for the F-test and t-tests. 
The basis components selected as significant by the tests at level <code>alpha1</code> and <code>alpha2</code> are highlighted in the plot of the corrected p-values and in the one of functional data by gray areas (light and dark gray, respectively). 
The plot of functional data reports the gray areas corresponding to a significant F-test. The plots of functional regression coefficients report the gray areas corresponding to significant t-tests for the corresponding covariate.
</p>


<h3>Author(s)</h3>

<p>Alessia Pini, Simone Vantini
</p>


<h3>References</h3>

<p>A. Pini and S. Vantini (2013). The Interval Testing Procedure: Inference for Functional Data Controlling the Family Wise Error Rate on Intervals. <em>MOX-report 13/2013</em>, Politecnico di Milano.
</p>
<p>K. Abramowicz, S. De Luna, C. Häger, A. Pini, L. Schelin, and S. Vantini (2015). Distribution-Free Interval-Wise Inference for Functional-on-Scalar Linear Models. <em>MOX-report 3/2015</em>, Politecnico di Milano.
</p>


<h3>See Also</h3>

<p>See also <code><a href="#topic+ITPlmbspline">ITPlmbspline</a></code> to fit and test a functional-on-scalar linear model applying the ITP, and <code><a href="#topic+summary.ITPlm">summary.ITPlm</a></code> for summaries. 
See <code><a href="#topic+plot.ITPaov">plot.ITPaov</a></code>, <code><a href="#topic+plot.ITP1">plot.ITP1</a></code>, and <code><a href="#topic+plot.ITP2">plot.ITP2</a></code> for the plot method applied to the ITP results of functional analysis of variance, one-population and two-population, respectively.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Importing the NASA temperatures data set
data(NASAtemp)

data &lt;- rbind(NASAtemp$milan,NASAtemp$paris)
lab &lt;- c(rep(0,22),rep(1,22))

# Performing the ITP
ITP.result &lt;- ITPlmbspline(data ~ lab,B=1000,nknots=20,order=3)
# Summary of the ITP results
summary(ITP.result)

# Plot of the ITP results
layout(1)
plot(ITP.result,main='NASA data',xlab='Day',xrange=c(1,365))

# Plots of the adjusted p-values
plot(ITP.result,main='NASA data', plot.adjpval = TRUE,xlab='Day',xrange=c(1,365))

# To have all plots in one device
layout(matrix(1:6,nrow=3,byrow=FALSE))
plot(ITP.result,main='NASA data', plot.adjpval = TRUE,xlab='Day',xrange=c(1,365))


</code></pre>

<hr>
<h2 id='summary.ITPaov'>
Summarizing Functional Analysis of Variance Fits
</h2><span id='topic+summary.ITPaov'></span>

<h3>Description</h3>

<p><code>summary</code> method for class &quot;<code>ITPaov</code>&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ITPaov'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.ITPaov_+3A_object">object</code></td>
<td>

<p>An object of class &quot;<code>ITPaov</code>&quot;, usually, a result of a call to <code><a href="#topic+ITPaovbspline">ITPaovbspline</a></code>.
</p>
</td></tr>
<tr><td><code id="summary.ITPaov_+3A_...">...</code></td>
<td>

<p>Further arguments passed to or from other methods.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function <code>summary.ITPaov</code> computes and returns a list of summary statistics of the fitted functional analysis of variance given in <code>object</code>, using the component &quot;<code>call</code>&quot; from its arguments, plus:
</p>
<table>
<tr><td><code>factors</code></td>
<td>
<p>A <code>L x 1</code> matrix with columns for the factors of ANOVA, and corresponding (two-sided) ITP-adjusted minimum p-values of the corresponding tests of significance (i.e., the minimum p-value over all <code>p</code> basis components used to describe functional data). </p>
</td></tr>
<tr><td><code>R2</code></td>
<td>
<p>Range of the functional R-squared.</p>
</td></tr>
<tr><td><code>ftest</code></td>
<td>
<p>ITP-adjusted minimum p-value of functional F-test.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Alessia Pini, Simone Vantini
</p>


<h3>References</h3>

<p>A. Pini and S. Vantini (2013). The Interval Testing Procedure: Inference for Functional Data Controlling the Family Wise Error Rate on Intervals. <em>MOX-report 13/2013</em>, Politecnico di Milano.
</p>
<p>K. Abramowicz, S. De Luna, C. Häger, A. Pini, L. Schelin, and S. Vantini (2015). Distribution-Free Interval-Wise Inference for Functional-on-Scalar Linear Models. <em>MOX-report 3/2015</em>, Politecnico di Milano.
</p>


<h3>See Also</h3>

<p>See <code><a href="#topic+ITPaovbspline">ITPaovbspline</a></code> for fitting and testing the functional ANOVA and <code><a href="#topic+plot.ITPaov">plot.ITPaov</a></code> for plots.
See also  <code><a href="#topic+ITPlmbspline">ITPlmbspline</a></code>, <code><a href="#topic+ITP1bspline">ITP1bspline</a></code>, <code><a href="#topic+ITP2bspline">ITP2bspline</a></code>, <code><a href="#topic+ITP2fourier">ITP2fourier</a></code>, <code><a href="#topic+ITP2pafourier">ITP2pafourier</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Importing the NASA temperatures data set
data(NASAtemp)

temperature &lt;- rbind(NASAtemp$milan,NASAtemp$paris)
groups &lt;- c(rep(0,22),rep(1,22))

# Performing the ITP
ITP.result &lt;- ITPaovbspline(temperature ~ groups,B=1000,nknots=20,order=3)

# Summary of the ITP results
summary(ITP.result)


</code></pre>

<hr>
<h2 id='summary.ITPlm'>
Summarizing Functional-on-Scalar Linear Model Fits
</h2><span id='topic+summary.ITPlm'></span>

<h3>Description</h3>

<p><code>summary</code> method for class &quot;<code>ITPlm</code>&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ITPlm'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.ITPlm_+3A_object">object</code></td>
<td>

<p>An object of class &quot;<code>ITPlm</code>&quot;, usually, a result of a call to <code><a href="#topic+ITPlmbspline">ITPlmbspline</a></code>.
</p>
</td></tr>
<tr><td><code id="summary.ITPlm_+3A_...">...</code></td>
<td>

<p>Further arguments passed to or from other methods.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function <code>summary.ITPlm</code> computes and returns a list of summary statistics of the fitted functional-on-scalar linear model given in <code>object</code>, using the component &quot;<code>call</code>&quot; from its arguments, plus:
</p>
<table>
<tr><td><code>ttest</code></td>
<td>
<p>A <code>L+1 x 1</code> matrix with columns for the functional regression coefficients, and corresponding (two-sided) ITP-adjusted minimum p-values of t-tests (i.e., the minimum p-value over all <code>p</code> basis components used to describe functional data). </p>
</td></tr>
<tr><td><code>R2</code></td>
<td>
<p>Range of the functional R-squared.</p>
</td></tr>
<tr><td><code>ftest</code></td>
<td>
<p>ITP-adjusted minimum p-value of functional F-test.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Alessia Pini, Simone Vantini
</p>


<h3>References</h3>

<p>A. Pini and S. Vantini (2013). The Interval Testing Procedure: Inference for Functional Data Controlling the Family Wise Error Rate on Intervals. <em>MOX-report 13/2013</em>, Politecnico di Milano.
</p>
<p>K. Abramowicz, S. De Luna, C. Häger, A. Pini, L. Schelin, and S. Vantini (2015). Distribution-Free Interval-Wise Inference for Functional-on-Scalar Linear Models. <em>MOX-report 3/2015</em>, Politecnico di Milano.
</p>


<h3>See Also</h3>

<p>See <code><a href="#topic+ITPlmbspline">ITPlmbspline</a></code> for fitting and testing the functional linear model and <code><a href="#topic+plot.ITPlm">plot.ITPlm</a></code> for plots.
See also  <code><a href="#topic+ITPaovbspline">ITPaovbspline</a></code>, <code><a href="#topic+ITP1bspline">ITP1bspline</a></code>, <code><a href="#topic+ITP2bspline">ITP2bspline</a></code>, <code><a href="#topic+ITP2fourier">ITP2fourier</a></code>, <code><a href="#topic+ITP2pafourier">ITP2pafourier</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Importing the NASA temperatures data set
data(NASAtemp)

temperature &lt;- rbind(NASAtemp$milan,NASAtemp$paris)
groups &lt;- c(rep(0,22),rep(1,22))

# Performing the ITP
ITP.result &lt;- ITPlmbspline(temperature ~ groups, B=1000,nknots=20)

# Summary of the ITP results
summary(ITP.result)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
