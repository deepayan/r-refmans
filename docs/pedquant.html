<!DOCTYPE html><html><head><title>Help for package pedquant</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {pedquant}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#+25x+26gt+3B+25'><p>crossover operators</p></a></li>
<li><a href='#dt_banks'><p>dataset of bank stocks in sse</p></a></li>
<li><a href='#dt_ssec'><p>dataset of shanghai composite index</p></a></li>
<li><a href='#ed_code'><p>code list by category</p></a></li>
<li><a href='#ed_fred'><p>query FRED economic data</p></a></li>
<li><a href='#ed_fred_symbol'><p>symbol of FRED economic data</p></a></li>
<li><a href='#ed_nbs'><p>query NBS economic data</p></a></li>
<li><a href='#ed_nbs_subregion'><p>subregion code of NBS economic data</p></a></li>
<li><a href='#ed_nbs_symbol'><p>symbol of NBS economic data</p></a></li>
<li><a href='#md_bond'><p>query bond data</p></a></li>
<li><a href='#md_forex'><p>query forex data</p></a></li>
<li><a href='#md_future'><p>query future market data</p></a></li>
<li><a href='#md_future_symbol'><p>symbol of future market data</p></a></li>
<li><a href='#md_money'><p>query interbank offered rate</p></a></li>
<li><a href='#md_moneycn'><p>query chinese benchmark rates</p></a></li>
<li><a href='#md_stock'><p>query stock market data</p></a></li>
<li><a href='#md_stock_adjust'><p>adjust stock prices</p></a></li>
<li><a href='#md_stock_financials'><p>query financial statements</p></a></li>
<li><a href='#md_stock_symbol'><p>symbol components of exchange</p></a></li>
<li><a href='#md_symbol'><p>symbol of market data</p></a></li>
<li><a href='#pq_addti'><p>adding technical indicators</p></a></li>
<li><a href='#pq_addti_funs'><p>technical functions</p></a></li>
<li><a href='#pq_freq'><p>converting frequency of daily data</p></a></li>
<li><a href='#pq_opr'><p>dataframe operation</p></a></li>
<li><a href='#pq_performance'><p>calculating performance metrics</p></a></li>
<li><a href='#pq_performance_funs'><p>performance functions</p></a></li>
<li><a href='#pq_plot'><p>creating charts for time series</p></a></li>
<li><a href='#pq_portfolio'><p>calculating returns/equity of portfolio</p></a></li>
<li><a href='#pq_return'><p>calculating returns by frequency</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>0.2.4</td>
</tr>
<tr>
<td>Title:</td>
<td>Public Economic Data and Quantitative Analysis</td>
</tr>
<tr>
<td>Description:</td>
<td>
    Provides an interface to access public economic and financial data for 
    economic research and quantitative analysis. The data sources including 
    NBS, FRED, Sina, Eastmoney and etc. It also provides quantitative 
    functions for trading strategies based on the 'data.table', 'TTR', 
    'PerformanceAnalytics' and etc packages.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.1.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>data.table, TTR, zoo, PerformanceAnalytics, curl, httr, rvest,
lubridate, stringi, jsonlite, readxl, readr, echarts4r, xefun
(&gt; 0.1.3)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/ShichenXie/pedquant">https://github.com/ShichenXie/pedquant</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/ShichenXie/pedquant/issues">https://github.com/ShichenXie/pedquant/issues</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-01-10 13:41:16 UTC; shichenxie</td>
</tr>
<tr>
<td>Author:</td>
<td>Shichen Xie [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Shichen Xie &lt;xie@shichen.name&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-01-10 14:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='+25x+26gt+3B+25'>crossover operators</h2><span id='topic++25x+3E+25'></span><span id='topic++25x+3C+25'></span>

<h3>Description</h3>

<p>Binary operators which create the upwards or downwards crossover signals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>x %x&gt;% y

x %x&lt;% y
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="+2B25x+2B26gt+2B3B+2B25_+3A_x">x</code>, <code id="+2B25x+2B26gt+2B3B+2B25_+3A_y">y</code></td>
<td>
<p>numeric vectors</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>library(data.table)
library(pedquant)

data("dt_banks")
boc = md_stock_adjust(setDT(dt_banks)[symbol=='601988.SH'])
bocti = pq_addti(boc, x='close_adj', sma=list(n=200), sma=list(n=50))

dtorders = copy(bocti[[1]])[,.(symbol, name, date, close_adj, sma_50, sma_200)
][sma_50 %x&gt;% sma_200, `:=`(
    side = 'buy', prices = close_adj
)][sma_50 %x&lt;% sma_200, `:=`(
    side = 'sell', prices = close_adj
)][, (c('side', 'prices')) := lapply(.SD, shift), .SDcols = c('side', 'prices')]
orders = dtorders[!is.na(side)]
head(orders)

e = pq_plot(boc,  y='close_adj', addti = list(sma=list(n=200), sma=list(n=50)), orders = orders)
e[[1]]

</code></pre>

<hr>
<h2 id='dt_banks'>dataset of bank stocks in sse</h2><span id='topic+dt_banks'></span>

<h3>Description</h3>

<p>The daily historical data of bank stocks
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dt_banks
</code></pre>


<h3>Format</h3>

<p>A data frame with 7506 rows and 15 variables:
</p>

<dl>
<dt>symbol</dt><dd><p>stock ticker symbol</p>
</dd>
<dt>name</dt><dd><p>stock ticker name</p>
</dd>
<dt>date</dt><dd><p>trade date</p>
</dd>
<dt>open</dt><dd><p>stock price at the open of trading</p>
</dd>
<dt>high</dt><dd><p>stock price at the highest point during trading</p>
</dd>
<dt>low</dt><dd><p>stock price at the lowest point during trading</p>
</dd>
<dt>close</dt><dd><p>stock price at the close of trading</p>
</dd>
<dt>volume</dt><dd><p>number of shares traded</p>
</dd>
<dt>amount</dt><dd><p>monetary value of shares traded</p>
</dd>
<dt>turnover</dt><dd><p>rate of shares traded over total</p>
</dd>
<dt>close_adj</dt><dd><p>adjusted stock price at the close of trading</p>
</dd>
</dl>


<hr>
<h2 id='dt_ssec'>dataset of shanghai composite index</h2><span id='topic+dt_ssec'></span>

<h3>Description</h3>

<p>The daily historical Shanghai Composite Index
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dt_ssec
</code></pre>


<h3>Format</h3>

<p>A data frame with 7506 rows and 15 variables:
</p>

<dl>
<dt>symbol</dt><dd><p>stock ticker symbol</p>
</dd>
<dt>name</dt><dd><p>stock ticker name</p>
</dd>
<dt>date</dt><dd><p>trade date</p>
</dd>
<dt>open</dt><dd><p>stock price at the open of trading</p>
</dd>
<dt>high</dt><dd><p>stock price at the highest point during trading</p>
</dd>
<dt>low</dt><dd><p>stock price at the lowest point during trading</p>
</dd>
<dt>close</dt><dd><p>stock price at the close of trading</p>
</dd>
<dt>volume</dt><dd><p>number of shares traded</p>
</dd>
<dt>amount</dt><dd><p>monetary value of shares traded</p>
</dd>
<dt>turnover</dt><dd><p>rate of shares traded over total</p>
</dd>
<dt>close_adj</dt><dd><p>adjusted stock price at the close of trading</p>
</dd>
</dl>


<hr>
<h2 id='ed_code'>code list by category</h2><span id='topic+ed_code'></span>

<h3>Description</h3>

<p><code>ed_code</code> get the code list of country, currency, stock exchange, commodity exchange and administrative district of mainland of China.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ed_code(cate = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ed_code_+3A_cate">cate</code></td>
<td>
<p>The available category values including 'country', 'currency', 'stock_exchange', 'commodity_exchange', 'china_district'.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# specify the categories
code_list1 = ed_code(cate = c('country', 'currency'))

# interactivly return code list
code_list2 = ed_code()


## End(Not run)

</code></pre>

<hr>
<h2 id='ed_fred'>query FRED economic data</h2><span id='topic+ed_fred'></span>

<h3>Description</h3>

<p>ed_fred provides an interface to access the economic data provided by FRED (<a href="https://fred.stlouisfed.org">https://fred.stlouisfed.org</a>)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ed_fred(symbol = NULL, date_range = "10y", from = NULL,
  to = Sys.Date(), na_rm = FALSE, print_step = 1L)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ed_fred_+3A_symbol">symbol</code></td>
<td>
<p>symbols of FRED economic indicators. It is available via function <code>ed_fred_symbol</code> or its website. Default is NULL, which calls <code>ed_fred_symbol</code> in the back.</p>
</td></tr>
<tr><td><code id="ed_fred_+3A_date_range">date_range</code></td>
<td>
<p>date range. Available value includes '1m'-'11m', 'ytd', 'max' and '1y'-'ny'. Default is '10y'.</p>
</td></tr>
<tr><td><code id="ed_fred_+3A_from">from</code></td>
<td>
<p>the start date. Default is NULL. If it is NULL, then calculate using date_range and end date.</p>
</td></tr>
<tr><td><code id="ed_fred_+3A_to">to</code></td>
<td>
<p>the end date. Default is the current date.</p>
</td></tr>
<tr><td><code id="ed_fred_+3A_na_rm">na_rm</code></td>
<td>
<p>logical, whether to remove missing values. Default is FALSE</p>
</td></tr>
<tr><td><code id="ed_fred_+3A_print_step">print_step</code></td>
<td>
<p>a non-negative integer, which will print symbol name by each print_step iteration. Default is 1L.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of dataframes with columns of symbol, name, date, value, geo, unit. The geo column might be NA according to local internet connection.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
dat = ed_fred(c("A191RL1A225NBEA", "GDPCA"))


</code></pre>

<hr>
<h2 id='ed_fred_symbol'>symbol of FRED economic data</h2><span id='topic+ed_fred_symbol'></span>

<h3>Description</h3>

<p>ed_fred_symbol provides an interface to search symbols of economic data from FRED by category or keywords.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ed_fred_symbol(category = NULL, keywords = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ed_fred_symbol_+3A_category">category</code></td>
<td>
<p>the category id. If it is NULL, then search symbols from the top categories step by step.</p>
</td></tr>
<tr><td><code id="ed_fred_symbol_+3A_keywords">keywords</code></td>
<td>
<p>the query text. If it is NULL, the function will search symbols by category.</p>
</td></tr>
<tr><td><code id="ed_fred_symbol_+3A_...">...</code></td>
<td>
<p>ignored parameters</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# search symbols by category
# from top categories
symbol_dt1 = ed_fred_symbol()
# specify the initial categories
symbol_dt2 = ed_fred_symbol(category = 1)

# search symbol by keywords
symbol_dt3 = ed_fred_symbol(keywords = "gdp china")


## End(Not run)

</code></pre>

<hr>
<h2 id='ed_nbs'>query NBS economic data</h2><span id='topic+ed_nbs'></span>

<h3>Description</h3>

<p><code>ed_nbs</code> provides an interface to query economic data from National Bureau of Statistics of China (NBS, <a href="https://www.stats.gov.cn/">https://www.stats.gov.cn/</a>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ed_nbs(symbol = NULL, freq = NULL, geo_type = NULL, subregion = NULL,
  date_range = "10y", from = NULL, to = Sys.Date(), na_rm = FALSE,
  eng = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ed_nbs_+3A_symbol">symbol</code></td>
<td>
<p>symbols of NBS indicators. It is available via <code>ed_nbs_symbol</code>. Default is NULL.</p>
</td></tr>
<tr><td><code id="ed_nbs_+3A_freq">freq</code></td>
<td>
<p>the frequency of NBS indicators, including 'monthly', 'quarterly', 'yearly'. Default is NULL.</p>
</td></tr>
<tr><td><code id="ed_nbs_+3A_geo_type">geo_type</code></td>
<td>
<p>geography type in NBS, including 'nation', 'province', 'city'. Default is NULL.</p>
</td></tr>
<tr><td><code id="ed_nbs_+3A_subregion">subregion</code></td>
<td>
<p>codes of province or city, which is available via <code>ed_nbs_subregion</code>. Default is NULL.</p>
</td></tr>
<tr><td><code id="ed_nbs_+3A_date_range">date_range</code></td>
<td>
<p>date range. Available value includes '1m'-'11m', 'ytd', 'max' and '1y'-'ny'. Default is '10y'.</p>
</td></tr>
<tr><td><code id="ed_nbs_+3A_from">from</code></td>
<td>
<p>the start date. Default is NULL. If it is NULL, then calculate using date_range and end date.</p>
</td></tr>
<tr><td><code id="ed_nbs_+3A_to">to</code></td>
<td>
<p>the end date. Default is the current date.</p>
</td></tr>
<tr><td><code id="ed_nbs_+3A_na_rm">na_rm</code></td>
<td>
<p>logical. Whether to remove missing values from datasets. Default is FALSE.</p>
</td></tr>
<tr><td><code id="ed_nbs_+3A_eng">eng</code></td>
<td>
<p>logical. The language of the query results is in English or in Chinese Default is FALSE.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# query NBS data without setting any parameters
dt = ed_nbs()

# specify paratmeters
dt1 = ed_nbs(geo_type='nation', freq='quarterly', symbol='A010101')
# or using 'n'/'q' represents 'nation'/'quarterly'
dt2 = ed_nbs(geo_type='n', freq='q', symbol='A010101')


# query data in one province
dt3 = ed_nbs(geo_type='province', freq='quarterly', 
  symbol='A010101', subregion='110000')
  
# query data in all province
dt4 = ed_nbs(geo_type='province', freq='quarterly', 
  symbol='A010101', subregion='all')

## End(Not run)

</code></pre>

<hr>
<h2 id='ed_nbs_subregion'>subregion code of NBS economic data</h2><span id='topic+ed_nbs_subregion'></span>

<h3>Description</h3>

<p><code>ed_nbs_subregion</code> query province or city code from NBS
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ed_nbs_subregion(geo_type = NULL, eng = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ed_nbs_subregion_+3A_geo_type">geo_type</code></td>
<td>
<p>geography type in NBS, including 'province', 'city'. Default is NULL.</p>
</td></tr>
<tr><td><code id="ed_nbs_subregion_+3A_eng">eng</code></td>
<td>
<p>logical. The language of the query results is in English or in Chinese. Default is FALSE.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# province code 
prov1 = ed_nbs_subregion(geo_type = 'province') 
# or using 'p' represents 'province'
prov2 = ed_nbs_subregion(geo_type = 'p') 

# city code in Chinese
# city = ed_nbs_subregion(geo_type = 'c', eng = FALSE) 
# city code in English
city = ed_nbs_subregion(geo_type = 'c', eng = TRUE) 

## End(Not run)
</code></pre>

<hr>
<h2 id='ed_nbs_symbol'>symbol of NBS economic data</h2><span id='topic+ed_nbs_symbol'></span>

<h3>Description</h3>

<p><code>ed_nbs_symbol</code> provides an interface to query symbols of economic indicators from NBS.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ed_nbs_symbol(symbol = NULL, geo_type = NULL, freq = NULL, eng = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ed_nbs_symbol_+3A_symbol">symbol</code></td>
<td>
<p>symbols of NBS indicators.</p>
</td></tr>
<tr><td><code id="ed_nbs_symbol_+3A_geo_type">geo_type</code></td>
<td>
<p>geography type in NBS, including 'nation', 'province', 'city'. Default is NULL.</p>
</td></tr>
<tr><td><code id="ed_nbs_symbol_+3A_freq">freq</code></td>
<td>
<p>the frequency of NBS indicators, including 'monthly', 'quarterly', 'yearly'. Default is NULL.</p>
</td></tr>
<tr><td><code id="ed_nbs_symbol_+3A_eng">eng</code></td>
<td>
<p>logical. The language of the query results is in English or in Chinese. Default is FALSE.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># query symbol interactively
## Not run: 
sym = ed_nbs_symbol()
## End(Not run)

</code></pre>

<hr>
<h2 id='md_bond'>query bond data</h2><span id='topic+md_bond'></span>

<h3>Description</h3>

<p><code>md_bond</code> query bond market data from FRED and ChinaBond.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>md_bond(symbol = NULL, type = "history", date_range = "3y",
  from = NULL, to = Sys.Date(), print_step = 1L, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="md_bond_+3A_symbol">symbol</code></td>
<td>
<p>bond symbols. Default is NULL.</p>
</td></tr>
<tr><td><code id="md_bond_+3A_type">type</code></td>
<td>
<p>the data type. Default is history.</p>
</td></tr>
<tr><td><code id="md_bond_+3A_date_range">date_range</code></td>
<td>
<p>date range. Available value includes '1m'-'11m', 'ytd', 'max' and '1y'-'ny'. Default is 3y.</p>
</td></tr>
<tr><td><code id="md_bond_+3A_from">from</code></td>
<td>
<p>the start date. Default is NULL. If it is NULL, then calculate using date_range and end date.</p>
</td></tr>
<tr><td><code id="md_bond_+3A_to">to</code></td>
<td>
<p>the end date. Default is the current date.</p>
</td></tr>
<tr><td><code id="md_bond_+3A_print_step">print_step</code></td>
<td>
<p>a non-negative integer, which will print symbol name by each print_step iteration. Default is 1L.</p>
</td></tr>
<tr><td><code id="md_bond_+3A_...">...</code></td>
<td>
<p>Additional parameters.</p>
</td></tr>
</table>

<hr>
<h2 id='md_forex'>query forex data</h2><span id='topic+md_forex'></span>

<h3>Description</h3>

<p><code>md_forex</code> query forex market data from FRED (history data) or sina (real data).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>md_forex(symbol, type = "history", date_range = "3y", from = NULL,
  to = Sys.Date(), print_step = 1L, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="md_forex_+3A_symbol">symbol</code></td>
<td>
<p>forex symbols. Default is NULL.</p>
</td></tr>
<tr><td><code id="md_forex_+3A_type">type</code></td>
<td>
<p>the data type, available values including history and real. Default is history.</p>
</td></tr>
<tr><td><code id="md_forex_+3A_date_range">date_range</code></td>
<td>
<p>date range. Available value includes '1m'-'11m', 'ytd', 'max' and '1y'-'ny'. Default is 3y.</p>
</td></tr>
<tr><td><code id="md_forex_+3A_from">from</code></td>
<td>
<p>the start date. Default is NULL. If it is NULL, then calculate using date_range and end date.</p>
</td></tr>
<tr><td><code id="md_forex_+3A_to">to</code></td>
<td>
<p>the end date. Default is the current date.</p>
</td></tr>
<tr><td><code id="md_forex_+3A_print_step">print_step</code></td>
<td>
<p>a non-negative integer, which will print symbol name by each print_step iteration. Default is 1L.</p>
</td></tr>
<tr><td><code id="md_forex_+3A_...">...</code></td>
<td>
<p>Additional parameters.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# history data
dtfx_hist1 = md_forex(c('usdcny', 'usdjpy'))

# real data
dtfx_real = md_forex(c('eurusd', 'usdcny', 'usdjpy'), type = 'real')


## End(Not run)


</code></pre>

<hr>
<h2 id='md_future'>query future market data</h2><span id='topic+md_future'></span>

<h3>Description</h3>

<p><code>md_future</code> query future market data from sina finance, <a href="https://finance.sina.com.cn/futuremarket/">https://finance.sina.com.cn/futuremarket/</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>md_future(symbol, type = "history", date_range = "max", from = NULL,
  to = Sys.Date(), freq = "daily", print_step = 1L, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="md_future_+3A_symbol">symbol</code></td>
<td>
<p>future symbols It is available via function <code>md_future_symbol</code> or its website.</p>
</td></tr>
<tr><td><code id="md_future_+3A_type">type</code></td>
<td>
<p>the data type, including history, real and info. Default is history.</p>
</td></tr>
<tr><td><code id="md_future_+3A_date_range">date_range</code></td>
<td>
<p>date range. Available value includes '1m'-'11m', 'ytd', 'max' and '1y'-'ny'. Default is max.</p>
</td></tr>
<tr><td><code id="md_future_+3A_from">from</code></td>
<td>
<p>the start date. Default is NULL. If it is NULL, then calculate using date_range and end date.</p>
</td></tr>
<tr><td><code id="md_future_+3A_to">to</code></td>
<td>
<p>the end date. Default is the current date.</p>
</td></tr>
<tr><td><code id="md_future_+3A_freq">freq</code></td>
<td>
<p>data frequency, default is daily.</p>
</td></tr>
<tr><td><code id="md_future_+3A_print_step">print_step</code></td>
<td>
<p>a non-negative integer, which will print symbol name by each print_step iteration. Default is 1L.</p>
</td></tr>
<tr><td><code id="md_future_+3A_...">...</code></td>
<td>
<p>Additional parameters.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# history data
df_hist = md_future(symbol = c('IF0', 'A0', 'CU0', 'CF0', 'XAU'))

# real data
df_real = md_future(symbol = c('IF0', 'A0', 'CU0', 'CF0', 'XAU'), 
                    type = 'real')

## End(Not run)


</code></pre>

<hr>
<h2 id='md_future_symbol'>symbol of future market data</h2><span id='topic+md_future_symbol'></span>

<h3>Description</h3>

<p><code>md_future_symbol</code> returns all future symbols that provided by sina finance, see details on <a href="http://vip.stock.finance.sina.com.cn/quotes_service/view/qihuohangqing.html">http://vip.stock.finance.sina.com.cn/quotes_service/view/qihuohangqing.html</a> or <a href="http://vip.stock.finance.sina.com.cn/mkt/#global_qh">http://vip.stock.finance.sina.com.cn/mkt/#global_qh</a>)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>md_future_symbol(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="md_future_symbol_+3A_...">...</code></td>
<td>
<p>ignored parameters</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
sybs = md_future_symbol()

## End(Not run)

</code></pre>

<hr>
<h2 id='md_money'>query interbank offered rate</h2><span id='topic+md_money'></span>

<h3>Description</h3>

<p><code>md_money</code> query libor from FRED or shibor from chinamoney.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>md_money(symbol = NULL, date_range = "3y", from = NULL,
  to = Sys.Date(), print_step = 1L)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="md_money_+3A_symbol">symbol</code></td>
<td>
<p>ibor symbols. Default is NULL.</p>
</td></tr>
<tr><td><code id="md_money_+3A_date_range">date_range</code></td>
<td>
<p>date range. Available value includes '1m'-'11m', 'ytd', 'max' and '1y'-'ny'. Default is 3y.</p>
</td></tr>
<tr><td><code id="md_money_+3A_from">from</code></td>
<td>
<p>the start date. Default is NULL. If it is NULL, then calculate using date_range and end date.</p>
</td></tr>
<tr><td><code id="md_money_+3A_to">to</code></td>
<td>
<p>the end date. Default is the current date.</p>
</td></tr>
<tr><td><code id="md_money_+3A_print_step">print_step</code></td>
<td>
<p>a non-negative integer, which will print symbol name by each print_step iteration. Default is 1L.</p>
</td></tr>
</table>

<hr>
<h2 id='md_moneycn'>query chinese benchmark rates</h2><span id='topic+md_moneycn'></span>

<h3>Description</h3>

<p><code>md_moneycn</code> query benchmark rates from chinamoney.com.cn.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>md_moneycn(symbol = NULL, date_range = "3y", from = NULL,
  to = Sys.Date(), print_step = 1L)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="md_moneycn_+3A_symbol">symbol</code></td>
<td>
<p>benchmarks, available values including 'rmbx', 'shibor', 'lpr', 'pr', 'yb'. Default is NULL,</p>
</td></tr>
<tr><td><code id="md_moneycn_+3A_date_range">date_range</code></td>
<td>
<p>date range. Available value includes '1m'-'11m', 'ytd', 'max' and '1y'-'ny'. Default is 3y.</p>
</td></tr>
<tr><td><code id="md_moneycn_+3A_from">from</code></td>
<td>
<p>the start date. Default is NULL. If it is NULL, then calculate using date_range and end date.</p>
</td></tr>
<tr><td><code id="md_moneycn_+3A_to">to</code></td>
<td>
<p>the end date. Default is the current date.</p>
</td></tr>
<tr><td><code id="md_moneycn_+3A_print_step">print_step</code></td>
<td>
<p>a non-negative integer, which will print symbol name by each print_step iteration. Default is 1L.</p>
</td></tr>
</table>

<hr>
<h2 id='md_stock'>query stock market data</h2><span id='topic+md_stock'></span>

<h3>Description</h3>

<p><code>md_stock</code> provides an interface to query stock or fund data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>md_stock(symbol, type = "history", date_range = "3y", from = NULL,
  to = Sys.Date(), forward = NULL, print_step = 1L, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="md_stock_+3A_symbol">symbol</code></td>
<td>
<p>symbols of stock shares.</p>
</td></tr>
<tr><td><code id="md_stock_+3A_type">type</code></td>
<td>
<p>the data type, including history, real. Defaults to history.</p>
</td></tr>
<tr><td><code id="md_stock_+3A_date_range">date_range</code></td>
<td>
<p>date range. Available value including '1m'-'11m', 'ytd', 'max' and '1y'-. Default is '3y'.</p>
</td></tr>
<tr><td><code id="md_stock_+3A_from">from</code></td>
<td>
<p>the start date. Default is NULL.</p>
</td></tr>
<tr><td><code id="md_stock_+3A_to">to</code></td>
<td>
<p>the end date. Default is current system date.</p>
</td></tr>
<tr><td><code id="md_stock_+3A_forward">forward</code></td>
<td>
<p>whether to forward adjust the OHLC prices. If it is NULL, return the original data from source, defaults to NULL.</p>
</td></tr>
<tr><td><code id="md_stock_+3A_print_step">print_step</code></td>
<td>
<p>A non-negative integer. Print symbol name by each print_step iteration. Default is 1L.</p>
</td></tr>
<tr><td><code id="md_stock_+3A_...">...</code></td>
<td>
<p>Additional parameters.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Example I: query history data
# us
FAANG = md_stock(c('META', 'AMZN', 'AAPL', 'NFLX', 'GOOG'))

# hkex
TMX = md_stock(c('00700.hk', '03690.hk', '01810.hk'))

# sse/szse
## the symbol without suffix
dt_cn1 = md_stock(c("000001", "^000001", "512510"))
## the symbol with suffix
dt_cn2 = md_stock(c("000001.sz", "000001.ss", '512510.ss'))

             
# Example III: query real prices
# real price for equities
dt_real1 = md_stock(c('META', 'AMZN', 'AAPL', 'NFLX', 'GOOG',
                     '00700.hk', '03690.hk', '01810.hk',
                     "000001", "^000001", "512510"), type = 'real')
               
               
# query company information 
dt_info1 = md_stock('600036', type = 'info')

## End(Not run)

</code></pre>

<hr>
<h2 id='md_stock_adjust'>adjust stock prices</h2><span id='topic+md_stock_adjust'></span>

<h3>Description</h3>

<p><code>md_stock_adjust</code> adjusts the open, high, low and close stock prices.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>md_stock_adjust(dt, forward = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="md_stock_adjust_+3A_dt">dt</code></td>
<td>
<p>a list/dataframe of time series datasets that didnt adjust for split or dividend.</p>
</td></tr>
<tr><td><code id="md_stock_adjust_+3A_forward">forward</code></td>
<td>
<p>forward adjust or backward adjust, defaults to FALSE.</p>
</td></tr>
<tr><td><code id="md_stock_adjust_+3A_...">...</code></td>
<td>
<p>Additional parameters.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
data("dt_banks")

dtadj1 = md_stock_adjust(dt_banks, adjust = FALSE)
dtadj2 = md_stock_adjust(dt_banks, adjust = TRUE)

</code></pre>

<hr>
<h2 id='md_stock_financials'>query financial statements</h2><span id='topic+md_stock_financials'></span>

<h3>Description</h3>

<p><code>md_stock_financials</code> provides an interface to query financial statements for all listed companies in SSE and SZSE by specified report date.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>md_stock_financials(type = NULL, date_range = "1q", from = NULL,
  to = Sys.Date(), print_step = 1L, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="md_stock_financials_+3A_type">type</code></td>
<td>
<p>the type of financial statements.</p>
</td></tr>
<tr><td><code id="md_stock_financials_+3A_date_range">date_range</code></td>
<td>
<p>date range. Available value including '1m'-'11m', 'ytd', 'max' and '1y'-. Default is '3y'.</p>
</td></tr>
<tr><td><code id="md_stock_financials_+3A_from">from</code></td>
<td>
<p>the start date. Default is NULL.</p>
</td></tr>
<tr><td><code id="md_stock_financials_+3A_to">to</code></td>
<td>
<p>the end date. Default is current system date.</p>
</td></tr>
<tr><td><code id="md_stock_financials_+3A_print_step">print_step</code></td>
<td>
<p>A non-negative integer. Print financial statements name by each print_step iteration. Default is 1L.</p>
</td></tr>
<tr><td><code id="md_stock_financials_+3A_...">...</code></td>
<td>
<p>Additional parameters.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# interactively specify type of financial table 
dtfs1 = md_stock_financials(type="fs0_summary", to = '2022-12-31')
dtfs2 = md_stock_financials(type="fs0_summary", to = c('2022-12-31', '2023-03-31'))
dtfs3 = md_stock_financials(type="fs0_summary", from = '2022-12-31', to = Sys.Date())

# all statements
dtfs4 = md_stock_financials(type = "fs", to = '2022-12-31')

# setting column names to Chinese
dtfs5 = md_stock_financials(type="fs0_summary", to = '2022-12-31', colnam_chn = TRUE)


## End(Not run)

</code></pre>

<hr>
<h2 id='md_stock_symbol'>symbol components of exchange</h2><span id='topic+md_stock_symbol'></span>

<h3>Description</h3>

<p><code>md_stock_symbol</code> returns all stock symbols by exchange
</p>


<h3>Usage</h3>

<pre><code class='language-R'>md_stock_symbol(exchange = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="md_stock_symbol_+3A_exchange">exchange</code></td>
<td>
<p>the available stock exchanges are sse, szse, hkex, amex, nasdaq, nyse.</p>
</td></tr>
<tr><td><code id="md_stock_symbol_+3A_...">...</code></td>
<td>
<p>ignored parameters</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# get stock symbols in a stock exchange
## specify the exchanges
ex_syb1 = md_stock_symbol(exchange = c('sse', 'szse'))

## choose exchanges interactivly
ex_syb2 = md_stock_symbol()


## End(Not run)

</code></pre>

<hr>
<h2 id='md_symbol'>symbol of market data</h2><span id='topic+md_symbol'></span>

<h3>Description</h3>

<p><code>md_stock_symbol</code> returns all symbols by market category, including forex, money, bond, stock, future.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>md_symbol(market = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="md_symbol_+3A_market">market</code></td>
<td>
<p>the market category, including forex, money, bond, stock, future. Default is NULL.</p>
</td></tr>
<tr><td><code id="md_symbol_+3A_...">...</code></td>
<td>
<p>ignored parameters</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
syblst = md_symbol()

## End(Not run)

</code></pre>

<hr>
<h2 id='pq_addti'>adding technical indicators</h2><span id='topic+pq_addti'></span>

<h3>Description</h3>

<p><code>pq_addti</code> creates technical indicators using the functions provided in TTR package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pq_addti(dt, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pq_addti_+3A_dt">dt</code></td>
<td>
<p>a list/dataframe of time series datasets.</p>
</td></tr>
<tr><td><code id="pq_addti_+3A_...">...</code></td>
<td>
<p>list of technical indicator parameters: sma = list(n=50), macd = list().
</p>

<ol>
<li><p> There are four types of parameters.
</p>

<ul>
<li><p> set by default and do not required, such as 'OHLC', 'HLC', 'HL' and 'volume'.
</p>
</li>
<li><p> set by default and can be modified, such as 'price', 'prices', 'x'. Its default value is 'close' or 'value' column.
</p>
</li>
<li><p> always required, such as 'y', 'w'.
</p>
</li>
<li><p> numeric parameters, such as 'n', 'sd', 'v', 'nFast', 'nSlow', 'nSig', 'accel'. These parameters should be provided, otherwise using default values in corresponding function.
</p>
</li></ul>

</li>
<li><p> TTR functions are summarized in below. See TTR package's help document for more detailed parameters.
</p>

<ul>
<li><p> moving averages: SMA, EMA, DEMA, WMA, EVWMA, ZLEMA, VWAP, VMA, HMA, ALMA, GMMA
</p>
</li>
<li><p> rolling functions: runMin, runMax, runMean, runMedian; runCov, runCor; runVar, runSD, runMAD; runSum, wilderSum
</p>
</li>
<li><p> bands / channels: BBands, PBands, DonchianChannel
</p>
</li>
<li><p> SAR, ZigZag
</p>
</li>
<li><p> trend direction/strength: aroon, CCI, ADX, TDI, VHF, EMV
</p>
</li>
<li><p> volatility measures: ATR, chaikinVolatility, volatility, SNR
</p>
</li>
<li><p> money flowing into/out: OBV, chaikinAD, CLV, CMF, MFI, williamsAD
</p>
</li>
<li><p> rate of change / momentum: ROC, momentum, KST, TRIX
</p>
</li>
<li><p> oscillator: MACD, DPO, DVI, ultimateOscillator; RSI, CMO; stoch, SMI, WPR
</p>
</li></ul>

</li></ol>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
# load data
data('dt_ssec')

# add technical indicators
dt_ti1 = pq_addti(dt_ssec, sma=list(n=20), sma=list(n=50), macd = list())

# specify the price column x
dt_ti11 = pq_addti(dt_ssec, sma=list(n=20, x='open'), sma=list(n=50, x='open'))
dt_ti12 = pq_addti(dt_ssec, x='open', sma=list(n=20), sma=list(n=50))

# only technical indicators
dt_ti2 = pq_addti(
  dt_ssec, sma=list(n=20), sma=list(n=50), macd = list(), 
  col_kp = c('symbol', 'name')
)

dt_ti3 = pq_addti(
  dt_ssec, sma=list(n=20), sma=list(n=50), macd = list(), 
  col_kp = NULL
)

# self-defined technical indicators
bias = function(x, n=50, maType='SMA') {
    library(TTR)
    (x/do.call(maType, list(x=x, n=n))-1)*100
}

dt_ti3 = pq_addti(dt_ssec, bias = list(n = 200))


</code></pre>

<hr>
<h2 id='pq_addti_funs'>technical functions</h2><span id='topic+pq_addti_funs'></span>

<h3>Description</h3>

<p>Technical functions provided in TTR package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pq_addti_funs()
</code></pre>

<hr>
<h2 id='pq_freq'>converting frequency of daily data</h2><span id='topic+pq_freq'></span>

<h3>Description</h3>

<p><code>pq_freq</code> convert a daily OHLC dataframe into a specified frequency.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pq_freq(dt, freq = "monthly", date_type = "eop")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pq_freq_+3A_dt">dt</code></td>
<td>
<p>a list/dataframe of time series dataset.</p>
</td></tr>
<tr><td><code id="pq_freq_+3A_freq">freq</code></td>
<td>
<p>the frequency that the input daily data will converted to. It supports weekly, monthly, quarterly and yearly.</p>
</td></tr>
<tr><td><code id="pq_freq_+3A_date_type">date_type</code></td>
<td>
<p>the available date type are eop (end of period) and bop (bebinning of period), defaults to the eop.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(dt_ssec)
dat1_weekly = pq_freq(dt_ssec, "weekly")

data(dt_banks)
dat2_weekly = pq_freq(dt_banks, "monthly")

## End(Not run)

</code></pre>

<hr>
<h2 id='pq_opr'>dataframe operation</h2><span id='topic+pq_opr'></span>

<h3>Description</h3>

<p>It performs arithmetic operation on numeric columns on multiple series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pq_opr(dt, opr, x = "close", rm_na = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pq_opr_+3A_dt">dt</code></td>
<td>
<p>a list/dataframe of time series datasets.</p>
</td></tr>
<tr><td><code id="pq_opr_+3A_opr">opr</code></td>
<td>
<p>operation string.</p>
</td></tr>
<tr><td><code id="pq_opr_+3A_x">x</code></td>
<td>
<p>the numeric column names, defaults to close.</p>
</td></tr>
<tr><td><code id="pq_opr_+3A_rm_na">rm_na</code></td>
<td>
<p>weather to remove NA values when perform arithmetic.</p>
</td></tr>
<tr><td><code id="pq_opr_+3A_...">...</code></td>
<td>
<p>additional parameters.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>data("dt_banks")

dt1 = pq_opr(dt_banks, '601288.SH/601988.SH')
print(dt1)

dt2 = pq_opr(dt_banks, c('(601288.SH+601988.SH)/2', '(601288.SH*601988.SH)^0.5'))
print(dt2)

</code></pre>

<hr>
<h2 id='pq_performance'>calculating performance metrics</h2><span id='topic+pq_performance'></span>

<h3>Description</h3>

<p><code>pq_performance</code> calculates performance metrics based on returns of market price or portfolio. The performance analysis functions are calling from <code>PerformanceAnalytics</code> package, which includes many widely used performance metrics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pq_performance(dt, Ra, Rb = NULL, perf_fun, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pq_performance_+3A_dt">dt</code></td>
<td>
<p>a list/dataframe of time series datasets.</p>
</td></tr>
<tr><td><code id="pq_performance_+3A_ra">Ra</code></td>
<td>
<p>the column name of asset returns.</p>
</td></tr>
<tr><td><code id="pq_performance_+3A_rb">Rb</code></td>
<td>
<p>the column name of baseline returns, defaults to NULL.</p>
</td></tr>
<tr><td><code id="pq_performance_+3A_perf_fun">perf_fun</code></td>
<td>
<p>performance function from <code>PerformanceAnalytics</code> package, see <code>pq_perf_funs</code>.</p>
</td></tr>
<tr><td><code id="pq_performance_+3A_...">...</code></td>
<td>
<p>additional parameters, the arguments used in <code>PerformanceAnalytics</code> functions.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'> 
## Not run: 
library(pedquant) 
library(data.table)

# load data
data(dt_banks)
data(dt_ssec)

# calculate returns
datret1 = pq_return(dt_banks, 'close', freq = 'monthly', rcol_name = 'Ra')
datret2 = pq_return(dt_ssec, 'close', freq = 'monthly', rcol_name = 'Rb')

# merge returns of assets and baseline
datRaRb = merge(
    rbindlist(datret1)[, .(date, symbol, Ra)], 
    rbindlist(datret2)[, .(date, Rb)],
    by = 'date', all.x = TRUE
)

# claculate table.CAPM metrics
perf_capm = pq_performance(datRaRb, Ra = 'Ra', Rb = 'Rb', perf_fun = 'table.CAPM')
rbindlist(perf_capm, idcol = 'symbol')

## End(Not run)

</code></pre>

<hr>
<h2 id='pq_performance_funs'>performance functions</h2><span id='topic+pq_performance_funs'></span>

<h3>Description</h3>

<p>A complete list of performance functions from <code>PerformanceAnalytics</code> package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pq_performance_funs()
</code></pre>

<hr>
<h2 id='pq_plot'>creating charts for time series</h2><span id='topic+pq_plot'></span>

<h3>Description</h3>

<p><code>pq_plot</code> provides an easy way to create interactive charts for time series dataset based on predefined formats.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pq_plot(dt, chart_type = "line", x = "date", y = "close", yb = NULL,
  date_range = "max", yaxis_log = FALSE, title = NULL, addti = NULL,
  nsd_lm = NULL, markline = TRUE, orders = NULL, arrange = list(rows =
  NULL, cols = NULL), theme = "default", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pq_plot_+3A_dt">dt</code></td>
<td>
<p>a list/dataframe of time series dataset</p>
</td></tr>
<tr><td><code id="pq_plot_+3A_chart_type">chart_type</code></td>
<td>
<p>chart type, including line, step, candle.</p>
</td></tr>
<tr><td><code id="pq_plot_+3A_x">x</code></td>
<td>
<p>column name for x axis</p>
</td></tr>
<tr><td><code id="pq_plot_+3A_y">y</code></td>
<td>
<p>column name for y axis</p>
</td></tr>
<tr><td><code id="pq_plot_+3A_yb">yb</code></td>
<td>
<p>column name for baseline</p>
</td></tr>
<tr><td><code id="pq_plot_+3A_date_range">date_range</code></td>
<td>
<p>date range of x axis to display. Available value includes '1m'-'11m', 'ytd', 'max' and '1y'-'ny'. Default is max.</p>
</td></tr>
<tr><td><code id="pq_plot_+3A_yaxis_log">yaxis_log</code></td>
<td>
<p>whether to display y axis values in log. Default is FALSE.</p>
</td></tr>
<tr><td><code id="pq_plot_+3A_title">title</code></td>
<td>
<p>chart title. It will added to the front of chart title if it is specified.</p>
</td></tr>
<tr><td><code id="pq_plot_+3A_addti">addti</code></td>
<td>
<p>list of technical indicators or numerical columns in dt. For technical indicator, it is calculated via <code>pq_addti</code>, which including overlays and indicators.</p>
</td></tr>
<tr><td><code id="pq_plot_+3A_nsd_lm">nsd_lm</code></td>
<td>
<p>number of standard deviation from linear regression fitting values.</p>
</td></tr>
<tr><td><code id="pq_plot_+3A_markline">markline</code></td>
<td>
<p>whether to display markline. Default is TRUE.</p>
</td></tr>
<tr><td><code id="pq_plot_+3A_orders">orders</code></td>
<td>
<p>a data frame of trade orders, which including columns of symbol, date, side, prices, and quantity.</p>
</td></tr>
<tr><td><code id="pq_plot_+3A_arrange">arrange</code></td>
<td>
<p>a list. Number of rows and columns charts to connect. Default is NULL.</p>
</td></tr>
<tr><td><code id="pq_plot_+3A_theme">theme</code></td>
<td>
<p>name of echarts theme, see details in <code><a href="echarts4r.html#topic+e_theme">e_theme</a></code></p>
</td></tr>
<tr><td><code id="pq_plot_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
# single serie
library(data.table)
library(pedquant)
data(dt_ssec)

# line chart (default)
e1 = pq_plot(dt_ssec, chart_type = 'line') # line chart (default)
e1[[1]]

# add technical indicators
e2 = pq_plot(dt_ssec, addti = list(
        sma = list(n = 200), 
        sma = list(n = 50), 
        volume = list(),
        macd = list()
))
e2[[1]]

# linear trend with yaxis in log
e3 = pq_plot(dt_ssec, nsd_lm = c(-0.8, 0, 0.8), markline=FALSE)
e3[[1]]

# multiple series
data(dt_banks)
setDT(dt_banks)
dt_banksadj = md_stock_adjust(dt_banks)

# linear trend
elist = pq_plot(dt_banksadj)
e4 = pq_plot(dt_banksadj, arrange = list(rows=1, cols=1))
e4[[1]]

# orders 
b2 = dt_banks[symbol %in% c('601988.SH', '601398.SH')]
b2orders = b2[sample(.N, 10), .(symbol, date, prices=close, 
              side=sample(c(-1, 1), 10, replace=TRUE))]
                
e5 = pq_plot(b2, orders=b2orders)
e5[[1]]

e6 = pq_plot(b2, orders=b2orders, arrange = list(rows=1, cols=1))
e6[[1]]


</code></pre>

<hr>
<h2 id='pq_portfolio'>calculating returns/equity of portfolio</h2><span id='topic+pq_portfolio'></span>

<h3>Description</h3>

<p><code>pq_portfolio</code> calculates the weighted returns or the equity of a portfolio assets.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pq_portfolio(dt, orders, x = "close", dtb = NULL, init_fund = NULL,
  method = "arithmetic", cols_keep = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pq_portfolio_+3A_dt">dt</code></td>
<td>
<p>a list/dataframe of price by asset.</p>
</td></tr>
<tr><td><code id="pq_portfolio_+3A_orders">orders</code></td>
<td>
<p>a data frame of transaction orders, which includes symbol, date, prices, quantity and side columns.</p>
</td></tr>
<tr><td><code id="pq_portfolio_+3A_x">x</code></td>
<td>
<p>the column name of adjusted asset price, defaults to close.</p>
</td></tr>
<tr><td><code id="pq_portfolio_+3A_dtb">dtb</code></td>
<td>
<p>a list/dataframe of price base asset.</p>
</td></tr>
<tr><td><code id="pq_portfolio_+3A_init_fund">init_fund</code></td>
<td>
<p>initial fund value.</p>
</td></tr>
<tr><td><code id="pq_portfolio_+3A_method">method</code></td>
<td>
<p>the method to calculate asset returns, the available values include arithmetic and log, defaults to arithmetic.</p>
</td></tr>
<tr><td><code id="pq_portfolio_+3A_cols_keep">cols_keep</code></td>
<td>
<p>the columns keep in the return data. The columns of symbol, name and date will always kept if they are exist in the input data.</p>
</td></tr>
<tr><td><code id="pq_portfolio_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>library(pedquant)

data(dt_banks)
datadj = md_stock_adjust(dt_banks)


# example I 
orders = data.frame(
    symbol = c("601288.SH","601328.SH","601398.SH","601939.SH","601988.SH"), 
    quantity = c(100, 200, 300, 300, 100)
)
dtRa = pq_portfolio(datadj, orders=orders) 

e1 = pq_plot(dtRa, y = 'cumreturns')
e1[[1]]


# example II 
data(dt_ssec)
orders = data.frame(
    symbol = rep(c("601288.SH","601328.SH","601398.SH","601939.SH","601988.SH"), 3), 
    date = rep(c('2009-03-02', '2010-01-04', '2014-09-01'), each = 5), 
    quantity = rep(c(100, 200, 300, 300, 100), 3) * rep(c(1, -1, 2), each = 5)
)
dtRab = pq_portfolio(datadj, orders=orders, dtb = dt_ssec, init_fund = 10000) 

e2 = pq_plot(dtRab, y = 'cumreturns', yb = 'cumreturns_000001.SH', addti = list(portfolio=list()))
e2[[1]]


# example III
orders = data.frame(symbol = "000001.SH", 
     date = c("2009-04-13", "2010-03-24", "2014-08-13", "2015-09-10"), 
     quantity = c(400, -400, 300, -300))
dtRa2 = pq_portfolio(dt_ssec, orders=orders, cols_keep = 'all')

e3 = pq_plot(dtRa2, y = 'close', addti = list(cumreturns=list(), portfolio=list()))
e3[[1]]

</code></pre>

<hr>
<h2 id='pq_return'>calculating returns by frequency</h2><span id='topic+pq_return'></span>

<h3>Description</h3>

<p><code>pq_return</code> calculates returns for daily series based on specified column, frequency and method type.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pq_return(dt, x, freq = "daily", n = 1, date_type = "eop",
  method = "arithmetic", cumreturns = FALSE, rcol_name = NULL,
  cols_keep = NULL, date_range = "max", from = NULL, to = Sys.Date(),
  ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pq_return_+3A_dt">dt</code></td>
<td>
<p>a list/dataframe of daily series.</p>
</td></tr>
<tr><td><code id="pq_return_+3A_x">x</code></td>
<td>
<p>the column name of adjusted asset price.</p>
</td></tr>
<tr><td><code id="pq_return_+3A_freq">freq</code></td>
<td>
<p>the frequency of returns. It supports 'daily', 'weekly', 'monthly', 'quarterly', 'yearly' and 'all'. Defaults to daily.</p>
</td></tr>
<tr><td><code id="pq_return_+3A_n">n</code></td>
<td>
<p>the number of preceding periods used as the base value, defaults to 1, which means based on the previous period value.</p>
</td></tr>
<tr><td><code id="pq_return_+3A_date_type">date_type</code></td>
<td>
<p>the available date type are eop (end of period) and bop (beginning of period), defaults to the eop.</p>
</td></tr>
<tr><td><code id="pq_return_+3A_method">method</code></td>
<td>
<p>the method to calculate asset returns, the available methods including arithmetic and log, defaults to arithmetic.</p>
</td></tr>
<tr><td><code id="pq_return_+3A_cumreturns">cumreturns</code></td>
<td>
<p>logical, whether to return cumulative returns. Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="pq_return_+3A_rcol_name">rcol_name</code></td>
<td>
<p>setting the column name of returns, defaults to NULL.</p>
</td></tr>
<tr><td><code id="pq_return_+3A_cols_keep">cols_keep</code></td>
<td>
<p>the columns keep in the return data. The columns of symbol, name and date will always kept if they are exist in the input data.</p>
</td></tr>
<tr><td><code id="pq_return_+3A_date_range">date_range</code></td>
<td>
<p>date range. Available value includes '1m'-'11m', 'ytd', 'max' and '1y'-'ny'. Default is max.</p>
</td></tr>
<tr><td><code id="pq_return_+3A_from">from</code></td>
<td>
<p>the start date. Default is NULL. If it is NULL, then calculate using date_range and end date.</p>
</td></tr>
<tr><td><code id="pq_return_+3A_to">to</code></td>
<td>
<p>the end date. Default is the current date.</p>
</td></tr>
<tr><td><code id="pq_return_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
# load data and adjust
data(dt_banks)
datadj = md_stock_adjust(dt_banks)

# set freq
dts_returns1 = pq_return(datadj, x = 'close_adj', freq = 'all')

# set method
dts_returns2 = pq_return(datadj, x = 'close_adj', method = 'log')

# set cols_keep
dts_returns3 = pq_return(datadj, x = 'close_adj', cols_keep = 'cap_total')

# cumulative returns
dts_cumreturns = pq_return(datadj, x = 'close_adj', from = '2012-01-01', cumreturns = TRUE)
e1 = pq_plot(dts_cumreturns, y = 'cumreturns.daily', title='cumreturns', 
        arrange = list(rows=1, cols=1))
e1[[1]]


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
