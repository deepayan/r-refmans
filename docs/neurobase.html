<!DOCTYPE html><html><head><title>Help for package neurobase</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {neurobase}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#applyEmptyImageDimensions-methods'><p>Apply Subsetting from Empty Image Dimensions</p></a></li>
<li><a href='#boxplot.nifti'><p>Boxplot of Values in an Image</p></a></li>
<li><a href='#breaker'><p>Find Breaks for nifti Image Plotting</p></a></li>
<li><a href='#check_mask'><p>Check Mask is Binary</p></a></li>
<li><a href='#check_mask_fail'><p>Check Mask is Binary, Fail otherwise</p></a></li>
<li><a href='#check_nifti_header-methods'><p>Check if nifti image or read in a nifti header</p></a></li>
<li><a href='#check_nifti-methods'><p>Check if nifti image or read in a nifti image</p></a></li>
<li><a href='#check_outfile'><p>Check output filename</p></a></li>
<li><a href='#checkimg-methods'><p>Force object to filename</p></a></li>
<li><a href='#checknii-methods'><p>Force object to filename with .nii extension</p></a></li>
<li><a href='#checkniigz-methods'><p>Force object to filename with .nii.gz extension</p></a></li>
<li><a href='#cog'><p>Image Center of Gravity</p></a></li>
<li><a href='#colorbar'><p>Add a colorbar to an ortho2 object</p></a></li>
<li><a href='#copyNIfTIHeader'><p>Copy NIfTI Header to an array</p></a></li>
<li><a href='#cut.nifti'><p>Perform Cut on an image</p></a></li>
<li><a href='#datatype'><p>Change Data type for img</p></a></li>
<li><a href='#density.nifti'><p>Density of Values in an Image</p></a></li>
<li><a href='#dicer'><p>Calculate Dice from a Table</p></a></li>
<li><a href='#double_ortho'><p>Double Orthographic Display</p></a></li>
<li><a href='#dropEmptyImageDimensions'><p>Drop Empty Image Dimensions</p></a></li>
<li><a href='#emptyImageDimensionsMask'><p>Make Mask from Empty Image Dimensions</p></a></li>
<li><a href='#ensure_array'><p>Ensure an array output</p></a></li>
<li><a href='#fast_dice_tab'><p>Fast Dice Tabulation</p></a></li>
<li><a href='#fast_readnii'><p>Reading NIfTI images through RNifti</p></a></li>
<li><a href='#file_imgext'><p>Get Image file extension</p></a></li>
<li><a href='#finite_img-methods'><p>Finite Image</p></a></li>
<li><a href='#flip_img'><p>Flip NifTI Image</p></a></li>
<li><a href='#getEmptyImageDimensions'><p>Get Empty Image Dimensions</p></a></li>
<li><a href='#hist.nifti'><p>Histogram of Values in an Image</p></a></li>
<li><a href='#images2matrix'><p>Transform set of images to matrix</p></a></li>
<li><a href='#img_colour_df'><p>Convert Image to Data.frame with Colors</p></a></li>
<li><a href='#img_indices'><p>Retrieve Image Indices</p></a></li>
<li><a href='#img_list_to_ts'><p>Image List to Time Series</p></a></li>
<li><a href='#img_ts_to_df'><p>Image Time Series to Data.frame</p></a></li>
<li><a href='#img_ts_to_list'><p>Image Time Series to list</p></a></li>
<li><a href='#img_ts_to_matrix'><p>Image Time Series to Matrix</p></a></li>
<li><a href='#mask_img'><p>Mask Image</p></a></li>
<li><a href='#mask_vals'><p>Extract or Replace Values Inside a Mask</p></a></li>
<li><a href='#maskEmptyImageDimensions-methods'><p>Apply Masking from Empty Image Dimensions</p></a></li>
<li><a href='#mean.nifti'><p>Mean of Values in an Image</p></a></li>
<li><a href='#minmax_img-methods'><p>Normalize Image using Range</p></a></li>
<li><a href='#multi_overlay'><p>Create Multi-Image Plot with Overlays</p></a></li>
<li><a href='#newnii'><p>Resets image parameters for a copied nifti object</p></a></li>
<li><a href='#niftiarr'><p>Make new nifti from array</p></a></li>
<li><a href='#nii.stub'><p>Grab nii file stubname</p></a></li>
<li><a href='#orient_rpi'><p>Reorient an Image to RPI orientation</p></a></li>
<li><a href='#ortho_diff'><p>Plot differences for Prediction and Gold Standard</p></a></li>
<li><a href='#ortho2'><p>Orthographic Display, added options</p></a></li>
<li><a href='#parse_img_ext'><p>Parse Image Extensions</p></a></li>
<li><a href='#quantile_img'><p>Create Quantile Image</p></a></li>
<li><a href='#quantile.nifti'><p>Sample Quantiles</p></a></li>
<li><a href='#random_nifti'><p>Create Random 'nifti' object</p></a></li>
<li><a href='#randomize_mask'><p>Randomize Image based on Mask</p></a></li>
<li><a href='#read_rpi'><p>Read NIfTI file reoriented to RPI</p></a></li>
<li><a href='#readNIfTI2'><p>readNIfTI with default non-reorientation</p></a></li>
<li><a href='#remake_img'><p>Remake Image from Vector</p></a></li>
<li><a href='#remap_filename'><p>Build Filename (usually for images)</p></a></li>
<li><a href='#replace_dropped_dimensions'><p>Remake Dropped Dimensions</p></a></li>
<li><a href='#replace_outside_surface'><p>Replace Values Outside Surface of image</p></a></li>
<li><a href='#replaceEmptyImageDimensions-methods'><p>Replace Subsetting from Empty Image Dimensions</p></a></li>
<li><a href='#rescale_img'><p>Image Rescaler</p></a></li>
<li><a href='#reverse_orient_rpi'><p>Reverse Reorientation an Image to RPI orientation</p></a></li>
<li><a href='#robust_window'><p>Window image based on quantiles of Image</p></a></li>
<li><a href='#same_dims'><p>Check if Objects have Same Dimensions</p></a></li>
<li><a href='#separate_img-methods'><p>Separate Labeled Image into Multiple Binary Images</p></a></li>
<li><a href='#slice_colour_df'><p>Slice a Image Color Data.frame</p></a></li>
<li><a href='#subset_dti-methods'><p>Subset DTI data based on b-values</p>
#'</a></li>
<li><a href='#tempimg'><p>Create temporary nii.gz file</p></a></li>
<li><a href='#window_img'><p>nifti image windower</p></a></li>
<li><a href='#write_nifti'><p>General NIfTI Writer</p></a></li>
<li><a href='#writeNIfTI2'><p>writeNIfTI with default non-reorientation</p></a></li>
<li><a href='#xyz'><p>Image Center of Gravity Wrapper</p></a></li>
<li><a href='#zero_pad'><p>Zero pads an image</p></a></li>
<li><a href='#zlimmer'><p>Find Image z-limits</p></a></li>
<li><a href='#zscore_img'><p>Get Z-score over a margin of an img</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>'Neuroconductor' Base Package with Helper Functions for 'nifti'
Objects</td>
</tr>
<tr>
<td>Version:</td>
<td>1.32.3</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>John Muschelli &lt;muschellij2@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Base package for 'Neuroconductor', which includes many helper 
    functions that interact with objects of class 'nifti', implemented by
    package 'oro.nifti', for reading/writing and also other manipulation 
    functions.</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods, abind, matrixStats, R.utils, graphics, grDevices,
stats, RNifti</td>
</tr>
<tr>
<td>Depends:</td>
<td>oro.nifti (&ge; 0.11.3), R (&ge; 3.2.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, ggplot2, knitr, rmarkdown, dplyr, reshape2, httr,
covr, brainR</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/muschellij2/neurobase/issues">https://github.com/muschellij2/neurobase/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-10-23 16:00:15 UTC; johnmuschelli</td>
</tr>
<tr>
<td>Author:</td>
<td>John Muschelli [aut, cre]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-10-23 16:32:36 UTC</td>
</tr>
</table>
<hr>
<h2 id='applyEmptyImageDimensions-methods'>Apply Subsetting from Empty Image Dimensions</h2><span id='topic+applyEmptyImageDimensions-methods'></span><span id='topic+applyEmptyImageDimensions'></span><span id='topic+applyEmptyImageDimensions+2Cnifti-method'></span><span id='topic+applyEmptyImageDimensions+2Ccharacter-method'></span><span id='topic+applyEmptyImageDimensions+2Cfactor-method'></span><span id='topic+applyEmptyImageDimensions+2Clist-method'></span><span id='topic+applyEmptyImageDimensions+2Carray-method'></span><span id='topic+applyEmptyImageDimensions+2Canlz-method'></span><span id='topic+applyEmptyImageDimensions+2CANY-method'></span><span id='topic+apply_empty_dim'></span>

<h3>Description</h3>

<p>Simple wrapper for subsetting an image with indices, 
dropping empty dimensions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>applyEmptyImageDimensions(img, inds, reorient = FALSE, ...)

## S4 method for signature 'nifti'
applyEmptyImageDimensions(img, inds, reorient = FALSE, ...)

## S4 method for signature 'character'
applyEmptyImageDimensions(img, inds, reorient = FALSE, ...)

## S4 method for signature 'factor'
applyEmptyImageDimensions(img, inds, reorient = FALSE, ...)

## S4 method for signature 'list'
applyEmptyImageDimensions(img, inds, reorient = FALSE, ...)

## S4 method for signature 'array'
applyEmptyImageDimensions(img, inds, reorient = FALSE, ...)

## S4 method for signature 'anlz'
applyEmptyImageDimensions(img, inds, reorient = FALSE, ...)

## S4 method for signature 'ANY'
applyEmptyImageDimensions(img, inds, reorient = FALSE, ...)

apply_empty_dim(img, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="applyEmptyImageDimensions-methods_+3A_img">img</code></td>
<td>
<p>image, nifti object, or array</p>
</td></tr>
<tr><td><code id="applyEmptyImageDimensions-methods_+3A_inds">inds</code></td>
<td>
<p>indices of subset from <code><a href="#topic+getEmptyImageDimensions">getEmptyImageDimensions</a></code> or
<code><a href="#topic+dropEmptyImageDimensions">dropEmptyImageDimensions</a></code>.</p>
</td></tr>
<tr><td><code id="applyEmptyImageDimensions-methods_+3A_reorient">reorient</code></td>
<td>
<p>Should image be reoriented if a filename?</p>
</td></tr>
<tr><td><code id="applyEmptyImageDimensions-methods_+3A_...">...</code></td>
<td>
<p>not used</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Object of class <code>nifti</code> or <code>array</code> if <code>nifti</code>
is not supplied
</p>


<h3>Note</h3>

<p><code>apply_empty_dim</code> is a shorthand for 
<code>applyEmptyImageDimensions</code> with all the same arguments.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+getEmptyImageDimensions">getEmptyImageDimensions</a></code>, 
<code><a href="#topic+dropEmptyImageDimensions">dropEmptyImageDimensions</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(5)
dims = rep(10, 3)
arr = array(rnorm(prod(dims)), dim = dims)
arr[,,10] = 0
nim = oro.nifti::nifti(arr)
inds = getEmptyImageDimensions(nim)
inds_arr = getEmptyImageDimensions(arr)
testthat::expect_equal(inds, inds_arr)

out = applyEmptyImageDimensions(nim, inds = inds)
out_arr = applyEmptyImageDimensions(arr, inds = inds)
testthat::expect_equal(out_arr, array(out, dim = dim(out)))
out = apply_empty_dim(nim, inds = inds)

set.seed(5)
dims = rep(10, 3)
arr = array(rnorm(prod(dims)), dim = dims)
arr[,,10] = 0
nim = oro.nifti::nifti(arr)
inds = getEmptyImageDimensions(nim)
rnifti = RNifti::asNifti(nim)
timg = tempimg(nim)
limg = list(factor(timg), factor(timg))
apply_empty_dim(nim, inds = inds)
func = function(...) applyEmptyImageDimensions(..., inds = inds)
func(arr)
func(nim)
func(rnifti)
func(timg)
func(limg)



</code></pre>

<hr>
<h2 id='boxplot.nifti'>Boxplot of Values in an Image</h2><span id='topic+boxplot.nifti'></span><span id='topic+boxplot.anlz'></span>

<h3>Description</h3>

<p>Computes the boxplot of values
of an image with the option for a mask.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'nifti'
boxplot(x, ..., mask)

## S3 method for class 'anlz'
boxplot(x, ..., mask)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="boxplot.nifti_+3A_x">x</code></td>
<td>
<p>Object of class <code>nifti</code></p>
</td></tr>
<tr><td><code id="boxplot.nifti_+3A_...">...</code></td>
<td>
<p>Arguments passed to <code><a href="graphics.html#topic+boxplot.default">boxplot.default</a></code></p>
</td></tr>
<tr><td><code id="boxplot.nifti_+3A_mask">mask</code></td>
<td>
<p>object to subset the image.  If missing, then all 
values of the image are plotted.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Output of <code><a href="graphics.html#topic+boxplot">boxplot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>img = nifti(array(rnorm(10^3), dim = rep(10, 3)))
mask = img &gt; 0
boxplot(img)
boxplot(img, mask = mask)
boxplot(as.anlz(img))
</code></pre>

<hr>
<h2 id='breaker'>Find Breaks for nifti Image Plotting</h2><span id='topic+breaker'></span>

<h3>Description</h3>

<p>Helper function for plotting - returns breaks for <code><a href="graphics.html#topic+image">image</a></code> 
plot function for object of class <code>nifti</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>breaker(x, zlim, col, breaks = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="breaker_+3A_x">x</code></td>
<td>
<p>Object of class <code>nifti</code></p>
</td></tr>
<tr><td><code id="breaker_+3A_zlim">zlim</code></td>
<td>
<p>A user-specified <code>zlim</code>.  If <code>NULL</code>, will calculate how 
<code><a href="#topic+ortho2">ortho2</a></code> would calculate <code>zlim</code></p>
</td></tr>
<tr><td><code id="breaker_+3A_col">col</code></td>
<td>
<p>colors to be plotted.  Only used for <code>length(col)</code>, so can be a
vector of length cols to be plotted</p>
</td></tr>
<tr><td><code id="breaker_+3A_breaks">breaks</code></td>
<td>
<p>if <code>!is.null(breaks)</code>, then will calculate breaks.  Otherwise will
return this breaks vector</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of length 2
</p>
<p>If <code>breaks = NULL</code>, then vector of <code>length(col) + 1</code>, 
otherwise returns <code>breaks</code>
</p>

<hr>
<h2 id='check_mask'>Check Mask is Binary</h2><span id='topic+check_mask'></span>

<h3>Description</h3>

<p>Determine if only values in a mask are 0/1
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_mask(mask, allow.NA = FALSE, allow.array = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_mask_+3A_mask">mask</code></td>
<td>
<p>Object of class <code>nifti</code></p>
</td></tr>
<tr><td><code id="check_mask_+3A_allow.na">allow.NA</code></td>
<td>
<p>allow NAs in the mask</p>
</td></tr>
<tr><td><code id="check_mask_+3A_allow.array">allow.array</code></td>
<td>
<p>if <code>class(mask)</code> is <code>"array"</code>, is this OK?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Logical indicating if object is binary mask with only 0, 1, and <code>NA</code>
if applicable
</p>


<h3>Examples</h3>

<pre><code class='language-R'>arr = array(rbinom(1000, size = 1, prob = 0.2), dim = c(10,10,10))
nim = oro.nifti::nifti(arr)
check_mask(nim)
</code></pre>

<hr>
<h2 id='check_mask_fail'>Check Mask is Binary, Fail otherwise</h2><span id='topic+check_mask_fail'></span>

<h3>Description</h3>

<p>Determine if only values in a mask are 0/1.  Will error otherwise.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_mask_fail(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_mask_fail_+3A_...">...</code></td>
<td>
<p>arguments to pass to <code><a href="#topic+check_mask">check_mask</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Either will error if conditions not met or an invisible <code>NULL</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>arr = array(rbinom(1000, size = 1, prob = 0.2), dim = c(10,10,10))
nim = oro.nifti::nifti(arr)
check_mask_fail(nim)
</code></pre>

<hr>
<h2 id='check_nifti_header-methods'>Check if nifti image or read in a nifti header</h2><span id='topic+check_nifti_header-methods'></span><span id='topic+check_nifti_header'></span><span id='topic+check_nifti_header+2Cnifti-method'></span><span id='topic+check_nifti_header+2Ccharacter-method'></span><span id='topic+check_nifti_header+2Cfactor-method'></span><span id='topic+check_nifti_header+2Clist-method'></span><span id='topic+check_nifti_header+2Carray-method'></span><span id='topic+check_nifti_header+2Canlz-method'></span><span id='topic+check_nifti_header+2CANY-method'></span>

<h3>Description</h3>

<p>Simple check to see if input is character or of 
class nifti and read in the header
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_nifti_header(x)

## S4 method for signature 'nifti'
check_nifti_header(x)

## S4 method for signature 'character'
check_nifti_header(x)

## S4 method for signature 'factor'
check_nifti_header(x)

## S4 method for signature 'list'
check_nifti_header(x)

## S4 method for signature 'array'
check_nifti_header(x)

## S4 method for signature 'anlz'
check_nifti_header(x)

## S4 method for signature 'ANY'
check_nifti_header(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_nifti_header-methods_+3A_x">x</code></td>
<td>
<p>character path of image or 
an object of class nifti, or array</p>
</td></tr>
</table>


<h3>Value</h3>

<p>nifti object or character
</p>


<h3>Author(s)</h3>

<p>John Muschelli <a href="mailto:muschellij2@gmail.com">muschellij2@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(5)
dims = rep(10, 4)
arr = array(rpois(prod(dims), lambda = 2), dim = dims)
nim = oro.nifti::nifti(arr)
check_nifti_header(nim)
check_nifti_header(as.anlz(nim))
testthat::expect_error(check_nifti_header(arr))
tfile = tempimg(nim)
check_nifti_header(tfile)
check_nifti_header(RNifti::readNifti(tfile))
check_nifti_header(c(tfile, tfile))
check_nifti_header(list(tfile, tfile))
check_nifti_header(factor(tfile))
</code></pre>

<hr>
<h2 id='check_nifti-methods'>Check if nifti image or read in a nifti image</h2><span id='topic+check_nifti-methods'></span><span id='topic+check_nifti'></span><span id='topic+check_nifti+2Cnifti-method'></span><span id='topic+check_nifti+2Ccharacter-method'></span><span id='topic+check_nifti+2Cfactor-method'></span><span id='topic+check_nifti+2Clist-method'></span><span id='topic+check_nifti+2Carray-method'></span><span id='topic+check_nifti+2Canlz-method'></span><span id='topic+check_nifti+2CANY-method'></span>

<h3>Description</h3>

<p>Simple check to see if input is character or of 
class nifti
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_nifti(
  x,
  reorient = FALSE,
  allow.array = FALSE,
  fast = FALSE,
  need_header = TRUE,
  ...
)

## S4 method for signature 'nifti'
check_nifti(
  x,
  reorient = FALSE,
  allow.array = FALSE,
  fast = FALSE,
  need_header = TRUE,
  ...
)

## S4 method for signature 'character'
check_nifti(
  x,
  reorient = FALSE,
  allow.array = FALSE,
  fast = FALSE,
  need_header = TRUE,
  ...
)

## S4 method for signature 'factor'
check_nifti(
  x,
  reorient = FALSE,
  allow.array = FALSE,
  fast = FALSE,
  need_header = TRUE,
  ...
)

## S4 method for signature 'list'
check_nifti(
  x,
  reorient = FALSE,
  allow.array = FALSE,
  fast = FALSE,
  need_header = TRUE,
  ...
)

## S4 method for signature 'array'
check_nifti(
  x,
  reorient = FALSE,
  allow.array = FALSE,
  fast = FALSE,
  need_header = FALSE,
  ...
)

## S4 method for signature 'anlz'
check_nifti(
  x,
  reorient = FALSE,
  allow.array = FALSE,
  fast = FALSE,
  need_header = TRUE,
  ...
)

## S4 method for signature 'ANY'
check_nifti(
  x,
  reorient = FALSE,
  allow.array = FALSE,
  fast = FALSE,
  need_header = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_nifti-methods_+3A_x">x</code></td>
<td>
<p>character path of image or 
an object of class nifti, or array</p>
</td></tr>
<tr><td><code id="check_nifti-methods_+3A_reorient">reorient</code></td>
<td>
<p>(logical) passed to <code><a href="#topic+readnii">readnii</a></code> 
if the image
is to be re-oriented</p>
</td></tr>
<tr><td><code id="check_nifti-methods_+3A_allow.array">allow.array</code></td>
<td>
<p>(logical) Are array types allowed (TRUE) or
should there be an error if the object is not character or class
nifti.</p>
</td></tr>
<tr><td><code id="check_nifti-methods_+3A_fast">fast</code></td>
<td>
<p>if <code>TRUE</code>, then <code><a href="#topic+fast_readnii">fast_readnii</a></code> will be used 
versus <code><a href="#topic+readnii">readnii</a></code> if the files need to be read in.</p>
</td></tr>
<tr><td><code id="check_nifti-methods_+3A_need_header">need_header</code></td>
<td>
<p>if <code>TRUE</code>, then an image type with header information
will be returned.  If not, then an array is fine.  Used really only in 
conjunction with <code>allow.array</code></p>
</td></tr>
<tr><td><code id="check_nifti-methods_+3A_...">...</code></td>
<td>
<p>additional arguments to pass to <code><a href="#topic+readnii">readnii</a></code> if relevant</p>
</td></tr>
</table>


<h3>Value</h3>

<p>nifti object or array if allow.array=TRUE and x is an array
</p>


<h3>Author(s)</h3>

<p>John Muschelli <a href="mailto:muschellij2@gmail.com">muschellij2@gmail.com</a>
</p>


<h3>See Also</h3>

<p><a href="#topic+readnii">readnii</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x = nifti()
check_nifti(x)
set.seed(5)
dims = rep(10, 4)
arr = array(rpois(prod(dims), lambda = 2), dim = dims)
nim = oro.nifti::nifti(arr)
check_nifti(nim)
check_nifti(as.anlz(nim))
testthat::expect_error(check_nifti(arr, allow.array = FALSE))
tfile = tempimg(nim)
check_nifti(c(tfile, tfile))
check_nifti(list(tfile, tfile))
check_nifti(factor(c(tfile, tfile)))
check_nifti(RNifti::readNifti(tfile))
</code></pre>

<hr>
<h2 id='check_outfile'>Check output filename</h2><span id='topic+check_outfile'></span>

<h3>Description</h3>

<p>This function checks if an output filename is not NULL 
in conjunction
whether the user would like to return an image
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_outfile(outfile, retimg, fileext = ".nii.gz")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_outfile_+3A_outfile">outfile</code></td>
<td>
<p>output filename or NULL</p>
</td></tr>
<tr><td><code id="check_outfile_+3A_retimg">retimg</code></td>
<td>
<p>Should an image be returned</p>
</td></tr>
<tr><td><code id="check_outfile_+3A_fileext">fileext</code></td>
<td>
<p>a non-empty character vector giving the file extension</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Filename of output file or a temporary filename
</p>

<hr>
<h2 id='checkimg-methods'>Force object to filename</h2><span id='topic+checkimg-methods'></span><span id='topic+checkimg'></span><span id='topic+checkimg+2Cnifti-method'></span><span id='topic+checkimg+2CANY-method'></span><span id='topic+checkimg+2Ccharacter-method'></span><span id='topic+checkimg+2Clist-method'></span>

<h3>Description</h3>

<p>Ensures the output to be a character filename (or vector) from an input
image or <code>nifti</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>checkimg(file, allow_array = FALSE, ...)

## S4 method for signature 'nifti'
checkimg(file, allow_array = FALSE, ...)

## S4 method for signature 'ANY'
checkimg(file, allow_array = FALSE, ...)

## S4 method for signature 'character'
checkimg(file, allow_array = FALSE, ...)

## S4 method for signature 'list'
checkimg(file, allow_array = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="checkimg-methods_+3A_file">file</code></td>
<td>
<p>character or <code>nifti</code> object</p>
</td></tr>
<tr><td><code id="checkimg-methods_+3A_allow_array">allow_array</code></td>
<td>
<p>allow arrays to be passed in</p>
</td></tr>
<tr><td><code id="checkimg-methods_+3A_...">...</code></td>
<td>
<p>options passed to <code><a href="#topic+tempimg">tempimg</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>character filename of image or temporary nii, 
with .nii extension
</p>


<h3>Author(s)</h3>

<p>John Muschelli <a href="mailto:muschellij2@gmail.com">muschellij2@gmail.com</a>
</p>

<hr>
<h2 id='checknii-methods'>Force object to filename with .nii extension</h2><span id='topic+checknii-methods'></span><span id='topic+checknii'></span><span id='topic+checknii+2Cnifti-method'></span><span id='topic+checknii+2Cfactor-method'></span><span id='topic+checknii+2Ccharacter-method'></span><span id='topic+checknii+2Clist-method'></span><span id='topic+checknii+2CANY-method'></span><span id='topic+ensure_nii'></span>

<h3>Description</h3>

<p>Ensures the output to be a character filename (or vector) from an input
image or <code>nifti</code>, but not gzipped and has <code>.nii</code> extension
</p>


<h3>Usage</h3>

<pre><code class='language-R'>checknii(file, ...)

## S4 method for signature 'nifti'
checknii(file, ...)

## S4 method for signature 'factor'
checknii(file, ...)

## S4 method for signature 'character'
checknii(file, ...)

## S4 method for signature 'list'
checknii(file, ...)

## S4 method for signature 'ANY'
checknii(file, ...)

ensure_nii(file, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="checknii-methods_+3A_file">file</code></td>
<td>
<p>character or <code>nifti</code> object</p>
</td></tr>
<tr><td><code id="checknii-methods_+3A_...">...</code></td>
<td>
<p>options passed to <code><a href="#topic+checkimg">checkimg</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>character filename of image or temporary nii, 
with .nii extension
</p>


<h3>Author(s)</h3>

<p>John Muschelli <a href="mailto:muschellij2@gmail.com">muschellij2@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(5)
dims = rep(10, 3)
arr = array(rnorm(prod(dims)), dim = dims)
arr[,,10] = 0
nim = oro.nifti::nifti(arr)
rnifti = RNifti::asNifti(nim)
timg = tempimg(nim)
limg = list(factor(timg), factor(timg))
func = checknii
func(nim)
func(rnifti)
func(timg)
func(limg)
</code></pre>

<hr>
<h2 id='checkniigz-methods'>Force object to filename with .nii.gz extension</h2><span id='topic+checkniigz-methods'></span><span id='topic+checkniigz'></span><span id='topic+checkniigz+2Cnifti-method'></span><span id='topic+checkniigz+2CANY-method'></span><span id='topic+checkniigz+2Cfactor-method'></span><span id='topic+checkniigz+2Ccharacter-method'></span><span id='topic+checkniigz+2Clist-method'></span><span id='topic+ensure_nii_gz'></span>

<h3>Description</h3>

<p>Ensures the output to be a character filename (or vector) 
from an input
image or <code>nifti</code>, to be gzipped and has <code>.nii.gz</code> extension
</p>


<h3>Usage</h3>

<pre><code class='language-R'>checkniigz(file, ...)

## S4 method for signature 'nifti'
checkniigz(file, ...)

## S4 method for signature 'ANY'
checkniigz(file, ...)

## S4 method for signature 'factor'
checkniigz(file, ...)

## S4 method for signature 'character'
checkniigz(file, ...)

## S4 method for signature 'list'
checkniigz(file, ...)

ensure_nii_gz(file, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="checkniigz-methods_+3A_file">file</code></td>
<td>
<p>character or <code>nifti</code> object</p>
</td></tr>
<tr><td><code id="checkniigz-methods_+3A_...">...</code></td>
<td>
<p>options passed to <code><a href="#topic+checkimg">checkimg</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Character filename of image or temporary nii, 
with .nii.gz extension
</p>


<h3>Author(s)</h3>

<p>John Muschelli <a href="mailto:muschellij2@gmail.com">muschellij2@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(5)
dims = rep(10, 3)
arr = array(rnorm(prod(dims)), dim = dims)
arr[,,10] = 0
nim = oro.nifti::nifti(arr)
rnifti = RNifti::asNifti(nim)
timg = tempimg(nim)
limg = list(factor(timg), factor(timg))
func = checkniigz
func(nim)
func(rnifti)
func(timg)
func(limg)
</code></pre>

<hr>
<h2 id='cog'>Image Center of Gravity</h2><span id='topic+cog'></span>

<h3>Description</h3>

<p>Find Center of Gravity of Image, after thresholding
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cog(img, thresh = 0, ceil = FALSE, warn = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cog_+3A_img">img</code></td>
<td>
<p>Object of class nifti</p>
</td></tr>
<tr><td><code id="cog_+3A_thresh">thresh</code></td>
<td>
<p>threshold for image, will find <code>img &gt; 0</code></p>
</td></tr>
<tr><td><code id="cog_+3A_ceil">ceil</code></td>
<td>
<p>Run <code><a href="base.html#topic+ceiling">ceiling</a></code> to force integers (usu for plotting)</p>
</td></tr>
<tr><td><code id="cog_+3A_warn">warn</code></td>
<td>
<p>Produce a warning if the image is empty after thresholding</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of length 3
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dims = rep(20, 3)
x = array(rnorm(prod(dims)), dim = dims)
img = nifti(x, dim= dims, 
datatype = convert.datatype()$FLOAT32, cal.min = min(x), 
cal.max = max(x), pixdim = rep(1, 4))
cog(img)
</code></pre>

<hr>
<h2 id='colorbar'>Add a colorbar to an ortho2 object</h2><span id='topic+colorbar'></span>

<h3>Description</h3>

<p>Adds a series of colors mapped to a value
</p>


<h3>Usage</h3>

<pre><code class='language-R'>colorbar(breaks, col, text.col = "white", labels = TRUE, maxleft = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="colorbar_+3A_breaks">breaks</code></td>
<td>
<p>a set of finite numeric breakpoints for the 
colours (see <code><a href="Matrix.html#topic+image">image</a></code></p>
</td></tr>
<tr><td><code id="colorbar_+3A_col">col</code></td>
<td>
<p>a list of colors (see <code><a href="Matrix.html#topic+image">image</a></code></p>
</td></tr>
<tr><td><code id="colorbar_+3A_text.col">text.col</code></td>
<td>
<p>axis and text label color</p>
</td></tr>
<tr><td><code id="colorbar_+3A_labels">labels</code></td>
<td>
<p>labels for tick marks - see <code><a href="graphics.html#topic+axis">axis</a></code></p>
</td></tr>
<tr><td><code id="colorbar_+3A_maxleft">maxleft</code></td>
<td>
<p>Extent the left hand for colorbar</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot
</p>


<h3>Note</h3>

<p>Much of this was taken from <code>vertical.image.legend</code> from
the <code>aqfig</code> package
</p>

<hr>
<h2 id='copyNIfTIHeader'>Copy NIfTI Header to an array</h2><span id='topic+copyNIfTIHeader'></span>

<h3>Description</h3>

<p>Copies slots of a <code>nifti</code> object to an array.  This is useful if you're
subsetting 4D data and getting an array out
</p>


<h3>Usage</h3>

<pre><code class='language-R'>copyNIfTIHeader(
  img,
  arr,
  drop_slots = c(".Data", "dim_"),
  drop = TRUE,
  onlylast = TRUE,
  warn = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="copyNIfTIHeader_+3A_img">img</code></td>
<td>
<p>object of class nifti to copy header</p>
</td></tr>
<tr><td><code id="copyNIfTIHeader_+3A_arr">arr</code></td>
<td>
<p>array to copy header information</p>
</td></tr>
<tr><td><code id="copyNIfTIHeader_+3A_drop_slots">drop_slots</code></td>
<td>
<p>Slots not to copy over from header</p>
</td></tr>
<tr><td><code id="copyNIfTIHeader_+3A_drop">drop</code></td>
<td>
<p>Should <code><a href="oro.nifti.html#topic+dropImageDimension">dropImageDimension</a></code> be called before returning?</p>
</td></tr>
<tr><td><code id="copyNIfTIHeader_+3A_onlylast">onlylast</code></td>
<td>
<p>if <code>drop = TRUE</code>, passed to <code><a href="oro.nifti.html#topic+dropImageDimension">dropImageDimension</a></code>,
if only the last dimensions should be dropped</p>
</td></tr>
<tr><td><code id="copyNIfTIHeader_+3A_warn">warn</code></td>
<td>
<p>if <code>drop = TRUE</code>, passed to <code><a href="oro.nifti.html#topic+dropImageDimension">dropImageDimension</a></code>, 
for warning print out</p>
</td></tr>
<tr><td><code id="copyNIfTIHeader_+3A_...">...</code></td>
<td>
<p>arguments to pass to <code><a href="oro.nifti.html#topic+nifti">nifti</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Object of class nifti the size of <code>arr</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>img = nifti(img = array(rnorm(10^4), dim=rep(10, 4)), dim=rep(10, 4), datatype = 16)
sub = img[,,,1:3]
copyNIfTIHeader(img, sub)
sub = img[,,,1, drop=FALSE]
copyNIfTIHeader(img, sub) 
copyNIfTIHeader(img, sub, drop = FALSE) 
</code></pre>

<hr>
<h2 id='cut.nifti'>Perform Cut on an image</h2><span id='topic+cut.nifti'></span><span id='topic+cut.anlz'></span>

<h3>Description</h3>

<p>Cuts a numeric image into an integer factor,
with the option of a mask.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'nifti'
cut(x, breaks, ..., mask)

## S3 method for class 'anlz'
cut(x, ..., mask)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cut.nifti_+3A_x">x</code></td>
<td>
<p>Object of class <code>nifti</code></p>
</td></tr>
<tr><td><code id="cut.nifti_+3A_breaks">breaks</code></td>
<td>
<p>either a numeric vector of two or more unique cut points 
or a single number (greater than or equal to 2) 
giving the number of intervals into which x is to be cut. 
Passed to <code><a href="base.html#topic+cut">cut</a></code>)</p>
</td></tr>
<tr><td><code id="cut.nifti_+3A_...">...</code></td>
<td>
<p>Arguments passed to <code><a href="base.html#topic+cut">cut</a></code></p>
</td></tr>
<tr><td><code id="cut.nifti_+3A_mask">mask</code></td>
<td>
<p>object to subset the image.  If missing, then all 
values of the image are used</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Object of class <code>nifti</code> with an <code>attribute</code> of levels
</p>


<h3>Examples</h3>

<pre><code class='language-R'>img = nifti(array(rnorm(10^3), dim = rep(10, 3)))
mask = img &gt; 0
cut(img, mask = mask, breaks = 4)
</code></pre>

<hr>
<h2 id='datatype'>Change Data type for img</h2><span id='topic+datatype'></span><span id='topic+datatyper'></span>

<h3>Description</h3>

<p>Tries to figure out the correct datatype for image.  Useful 
for image masks - makes them binary if
</p>


<h3>Usage</h3>

<pre><code class='language-R'>datatyper(
  img,
  type_string = NULL,
  datatype = NULL,
  bitpix = NULL,
  trybyte = TRUE,
  warn = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="datatype_+3A_img">img</code></td>
<td>
<p>nifti object (or character of filename)</p>
</td></tr>
<tr><td><code id="datatype_+3A_type_string">type_string</code></td>
<td>
<p>(NULL) character of datatype and bitpix.  Supercedes
both datatype and bitpix.  If specified 
<code>convert.datatype[[type_string]]</code> and 
<code>convert.bitpix[[type_string]]</code> will be used.</p>
</td></tr>
<tr><td><code id="datatype_+3A_datatype">datatype</code></td>
<td>
<p>(NULL) character of datatype see 
<code><a href="oro.nifti.html#topic+convert.datatype">convert.datatype</a></code></p>
</td></tr>
<tr><td><code id="datatype_+3A_bitpix">bitpix</code></td>
<td>
<p>(NULL) character of bitpix see 
<code><a href="oro.nifti.html#topic+convert.bitpix">convert.bitpix</a></code></p>
</td></tr>
<tr><td><code id="datatype_+3A_trybyte">trybyte</code></td>
<td>
<p>(logical) Should you try to make a byte (UINT8) if image in
c(0, 1)?</p>
</td></tr>
<tr><td><code id="datatype_+3A_warn">warn</code></td>
<td>
<p>Should a warning be issued if defaulting to FLOAT32?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>object of type nifti
</p>


<h3>Examples</h3>

<pre><code class='language-R'>img = nifti(array(rnorm(10^3, sd = 1000), dim = rep(10, 3)))
rimg = round(img)
newnii(datatyper(rimg))
rimg = datatyper(rimg, type_string= "FLOAT32")
</code></pre>

<hr>
<h2 id='density.nifti'>Density of Values in an Image</h2><span id='topic+density.nifti'></span><span id='topic+density.anlz'></span>

<h3>Description</h3>

<p>Computes the density of values
of an image with the option for a mask.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'nifti'
density(x, ..., mask)

## S3 method for class 'anlz'
density(x, ..., mask)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="density.nifti_+3A_x">x</code></td>
<td>
<p>Object of class <code>nifti</code></p>
</td></tr>
<tr><td><code id="density.nifti_+3A_...">...</code></td>
<td>
<p>Arguments passed to <code><a href="stats.html#topic+density.default">density.default</a></code></p>
</td></tr>
<tr><td><code id="density.nifti_+3A_mask">mask</code></td>
<td>
<p>object to subset the image.  If missing, then all 
values of the image are plotted.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Output of <code><a href="stats.html#topic+density">density</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>img = nifti(array(rnorm(10^3), dim = rep(10, 3)))
mask = img &gt; 0
density(img, mask = mask)
density(img)

density(as.anlz(img), mask = mask)
density(as.anlz(img))

</code></pre>

<hr>
<h2 id='dicer'>Calculate Dice from a Table</h2><span id='topic+dicer'></span>

<h3>Description</h3>

<p>Simple wrapper to calculate the Dice Coefficient/Similarity Index
from a table
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dicer(tab, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dicer_+3A_tab">tab</code></td>
<td>
<p>table or matrix that is 2 by 2</p>
</td></tr>
<tr><td><code id="dicer_+3A_verbose">verbose</code></td>
<td>
<p>should the Dice be printed before returned?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric scalar (one number)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>tab = matrix(c(1000, 20, 20, 400), ncol = 2)
dicer(tab)
</code></pre>

<hr>
<h2 id='double_ortho'>Double Orthographic Display</h2><span id='topic+double_ortho'></span>

<h3>Description</h3>

<p>Copy of <code>oro.nifti</code>'s <code><a href="oro.nifti.html#topic+orthographic">orthographic</a></code> function 
with some tweaks such as adding L/R designations for left and right
</p>


<h3>Usage</h3>

<pre><code class='language-R'>double_ortho(
  x,
  y = NULL,
  col.y = gray(0:64/64),
  NA.x = TRUE,
  mfrow = c(2, 4),
  add = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="double_ortho_+3A_x">x</code></td>
<td>
<p>is an object of class nifti or similar.</p>
</td></tr>
<tr><td><code id="double_ortho_+3A_y">y</code></td>
<td>
<p>is an object of class nifti or similar to be set aside x.</p>
</td></tr>
<tr><td><code id="double_ortho_+3A_col.y">col.y</code></td>
<td>
<p>is grayscale (by default).</p>
</td></tr>
<tr><td><code id="double_ortho_+3A_na.x">NA.x</code></td>
<td>
<p>Set any values of 0 in <code>x</code> to <code>NA</code></p>
</td></tr>
<tr><td><code id="double_ortho_+3A_mfrow">mfrow</code></td>
<td>
<p>(numeric) layout of the 3 slices</p>
</td></tr>
<tr><td><code id="double_ortho_+3A_add">add</code></td>
<td>
<p>Should the y-plot be added or its own plot?  Used
in <code>double_ortho</code></p>
</td></tr>
<tr><td><code id="double_ortho_+3A_...">...</code></td>
<td>
<p>other arguments to <code><a href="#topic+ortho2">ortho2</a></code></p>
</td></tr>
</table>


<h3>See Also</h3>

<p><a href="oro.nifti.html#topic+orthographic">orthographic</a>
</p>

<hr>
<h2 id='dropEmptyImageDimensions'>Drop Empty Image Dimensions</h2><span id='topic+dropEmptyImageDimensions'></span><span id='topic+drop_empty_dim'></span>

<h3>Description</h3>

<p>Drops dimensions of an image that has all irrelevant
values
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dropEmptyImageDimensions(
  img,
  value = 0,
  threshold = 0,
  other.imgs = NULL,
  keep_ind = FALSE,
  reorient = FALSE
)

drop_empty_dim(
  img,
  value = 0,
  threshold = 0,
  other.imgs = NULL,
  keep_ind = FALSE,
  reorient = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dropEmptyImageDimensions_+3A_img">img</code></td>
<td>
<p>nifti object</p>
</td></tr>
<tr><td><code id="dropEmptyImageDimensions_+3A_value">value</code></td>
<td>
<p>Value to check against.  If zero, then 
<code>dropEmptyImageDimensions</code> will drop any dimension that has 
fewer than <code>threshold</code> zeroes.  May be a vector of values, matched with 
<code><a href="base.html#topic+match">match</a></code></p>
</td></tr>
<tr><td><code id="dropEmptyImageDimensions_+3A_threshold">threshold</code></td>
<td>
<p>Drop dimension if fewer than <code>threshold</code> voxels
are in the slice</p>
</td></tr>
<tr><td><code id="dropEmptyImageDimensions_+3A_other.imgs">other.imgs</code></td>
<td>
<p>List of other nifti objects or filenames 
to apply the same dropping as <code>img</code>.</p>
</td></tr>
<tr><td><code id="dropEmptyImageDimensions_+3A_keep_ind">keep_ind</code></td>
<td>
<p>keep indices in output.  Will return list, even if 
<code>other.imgs</code> not specified</p>
</td></tr>
<tr><td><code id="dropEmptyImageDimensions_+3A_reorient">reorient</code></td>
<td>
<p>Should image be reoriented if a filename?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of output image indices, and other images
if <code>other.imgs</code> not specified or <code>keep_ind = TRUE</code>. 
Otherwise object of class <code>nifti</code>
</p>


<h3>Note</h3>

<p><code>drop_empty_dim</code> is a shorthand for <code>dropEmptyImageDimensions</code>
with all the same arguments.  Also, <code>NA</code> are set to zero.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+getEmptyImageDimensions">getEmptyImageDimensions</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(5)
dims = rep(10, 3)
arr = array(rnorm(prod(dims)), dim = dims)
arr[,,10] = 0
nim = oro.nifti::nifti(arr)

dnim = dropEmptyImageDimensions(nim, keep_ind = TRUE)
new_nim = dnim$outimg
names(dnim)
dnim = dropEmptyImageDimensions(nim, keep_ind = TRUE, other.imgs = nim)
dims = rep(10, 4)
arr = array(rnorm(prod(dims)), dim = dims)
nim = oro.nifti::nifti(arr)

testthat::expect_error(
{dnim = dropEmptyImageDimensions(nim, keep_ind = TRUE)}
)
</code></pre>

<hr>
<h2 id='emptyImageDimensionsMask'>Make Mask from Empty Image Dimensions</h2><span id='topic+emptyImageDimensionsMask'></span><span id='topic+empty_dim_mask'></span>

<h3>Description</h3>

<p>Make a mask of an image that has all irrelevant
values
</p>


<h3>Usage</h3>

<pre><code class='language-R'>emptyImageDimensionsMask(img, ..., reorient = FALSE)

empty_dim_mask(img, ..., reorient = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="emptyImageDimensionsMask_+3A_img">img</code></td>
<td>
<p>nifti object</p>
</td></tr>
<tr><td><code id="emptyImageDimensionsMask_+3A_...">...</code></td>
<td>
<p>Arguments to be passed to <code><a href="#topic+getEmptyImageDimensions">getEmptyImageDimensions</a></code>.</p>
</td></tr>
<tr><td><code id="emptyImageDimensionsMask_+3A_reorient">reorient</code></td>
<td>
<p>Should image be reoriented if a filename?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Object of class <code>nifti</code>, with binary values
</p>


<h3>Note</h3>

<p><code>empty_dim_mask</code> is a shorthand for <code>emptyImageDimensionsMask</code>
with all the same arguments.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+getEmptyImageDimensions">getEmptyImageDimensions</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(5)
dims = rep(10, 3)
arr = array(rnorm(prod(dims)), dim = dims)
arr[,,10] = 0
nim = oro.nifti::nifti(arr)
out = emptyImageDimensionsMask(nim)
out_arr = emptyImageDimensionsMask(arr)
testthat::expect_equal(out_arr, array(out, dim = dim(out)))
out_arr = empty_dim_mask(arr)
</code></pre>

<hr>
<h2 id='ensure_array'>Ensure an array output</h2><span id='topic+ensure_array'></span>

<h3>Description</h3>

<p>Forces an array output for manipulation and overall conversion
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ensure_array(img)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ensure_array_+3A_img">img</code></td>
<td>
<p>Image object (<code><a href="oro.nifti.html#topic+nifti">nifti</a></code> or <code>niftiImage</code>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Array of same dimensions as image object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(5)
dims = rep(10, 3)
arr = array(rnorm(prod(dims)), dim = dims)
arr[,,10] = 0
nim = oro.nifti::nifti(arr)
rnifti = RNifti::asNifti(nim)
timg = tempimg(nim)
limg = list(factor(timg), factor(timg))
func = ensure_array
func(arr)
func(nim)
func(rnifti)
func(timg)
func(limg[[1]])
</code></pre>

<hr>
<h2 id='fast_dice_tab'>Fast Dice Tabulation</h2><span id='topic+fast_dice_tab'></span><span id='topic+fast_dice'></span>

<h3>Description</h3>

<p>Fast Dice Tabulation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fast_dice_tab(x, y)

fast_dice(x, y, verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fast_dice_tab_+3A_x">x</code></td>
<td>
<p>A <code>nifti</code> image, filename, or <code>niftiImage</code></p>
</td></tr>
<tr><td><code id="fast_dice_tab_+3A_y">y</code></td>
<td>
<p>A <code>nifti</code> image, filename, or <code>niftiImage</code></p>
</td></tr>
<tr><td><code id="fast_dice_tab_+3A_verbose">verbose</code></td>
<td>
<p>A logical indicating output</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A table object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(oro.nifti)
set.seed(20161007)
dims = rep(10, 3)
arr = array(rnorm(10*10*10), dim = dims)
nim = oro.nifti::nifti(arr) &gt; -1
fast_dice_tab(nim, nim)
fast_dice(nim, nim) == 1
</code></pre>

<hr>
<h2 id='fast_readnii'>Reading NIfTI images through RNifti</h2><span id='topic+fast_readnii'></span>

<h3>Description</h3>

<p>This function calls the <code><a href="RNifti.html#topic+readNifti">readNifti</a></code> function from the 
<code>RNifti</code> package, and then converts the image to a <code>nifti</code> object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fast_readnii(fname, dtype = TRUE, drop_dim = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fast_readnii_+3A_fname">fname</code></td>
<td>
<p>file name of the NIfTI file.</p>
</td></tr>
<tr><td><code id="fast_readnii_+3A_dtype">dtype</code></td>
<td>
<p>Should <code><a href="#topic+datatyper">datatyper</a></code> be run after reading?</p>
</td></tr>
<tr><td><code id="fast_readnii_+3A_drop_dim">drop_dim</code></td>
<td>
<p>Should <code><a href="oro.nifti.html#topic+drop_img_dim">drop_img_dim</a></code> be run after reading?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>nifti</code> object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(5)
dims = rep(10, 4)
arr = array(rpois(prod(dims), lambda = 2), dim = dims)
nim = oro.nifti::nifti(arr)
tfile = tempfile(fileext = ".nii.gz")
write_nifti(nim, tfile)
rimg = fast_readnii(tfile)
</code></pre>

<hr>
<h2 id='file_imgext'>Get Image file extension</h2><span id='topic+file_imgext'></span>

<h3>Description</h3>

<p>Get the image file extension, either .nii, .hdr, .nii.gz, 
or .hdr.gz
</p>


<h3>Usage</h3>

<pre><code class='language-R'>file_imgext(file, withdot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="file_imgext_+3A_file">file</code></td>
<td>
<p>Vector of character filenames</p>
</td></tr>
<tr><td><code id="file_imgext_+3A_withdot">withdot</code></td>
<td>
<p>Should the extension begin with <code>"."</code>?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of extensions.  If <code>withdot = FALSE</code>, then will
return <code>nii</code> instead of <code>.nii</code>
</p>

<hr>
<h2 id='finite_img-methods'>Finite Image</h2><span id='topic+finite_img-methods'></span><span id='topic+finite_img'></span><span id='topic+finite_img+2Cnifti-method'></span><span id='topic+finite_img+2Carray-method'></span><span id='topic+finite_img+2CANY-method'></span><span id='topic+finite_img+2Ccharacter-method'></span><span id='topic+finite_img+2Clist-method'></span>

<h3>Description</h3>

<p>Simple wrapper for setting non-finite values to zero
</p>


<h3>Usage</h3>

<pre><code class='language-R'>finite_img(img, replace = 0)

## S4 method for signature 'nifti'
finite_img(img, replace = 0)

## S4 method for signature 'array'
finite_img(img, replace = 0)

## S4 method for signature 'ANY'
finite_img(img, replace = 0)

## S4 method for signature 'character'
finite_img(img, replace = 0)

## S4 method for signature 'list'
finite_img(img, replace = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="finite_img-methods_+3A_img">img</code></td>
<td>
<p>character path of image or 
an object of class <code>nifti</code>, or list of images</p>
</td></tr>
<tr><td><code id="finite_img-methods_+3A_replace">replace</code></td>
<td>
<p>Value to replace non-finite values to</p>
</td></tr>
</table>


<h3>Value</h3>

<p>nifti object
</p>


<h3>Author(s)</h3>

<p>John Muschelli <a href="mailto:muschellij2@gmail.com">muschellij2@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(5)
dims = rep(10, 3)
arr = array(rpois(prod(dims), lambda = 2), dim = dims)
arr[c(5, 6, 7, 8)] = c(NA, NaN, Inf, -Inf)
nim = nifti(arr)
finite_img(nim)
finite_img(arr)
tfile = tempimg(nim)
checkimg(c(tfile, tfile))
checkimg(list(tfile, tfile))
finite_img(list(tfile, tfile))
finite_img(c(tfile, tfile))
img = RNifti::readNifti(tfile)
checkimg(img)
img[c(5, 6, 7, 8)] = c(NA, NaN, Inf, -Inf)
stopifnot(!any(c(is.na(c(finite_img(img))))))
</code></pre>

<hr>
<h2 id='flip_img'>Flip NifTI Image</h2><span id='topic+flip_img'></span>

<h3>Description</h3>

<p>This image will flip x, y, or z direction
</p>


<h3>Usage</h3>

<pre><code class='language-R'>flip_img(img, x = FALSE, y = FALSE, z = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="flip_img_+3A_img">img</code></td>
<td>
<p>nifti object or character filename</p>
</td></tr>
<tr><td><code id="flip_img_+3A_x">x</code></td>
<td>
<p>(logical) Flip x direction</p>
</td></tr>
<tr><td><code id="flip_img_+3A_y">y</code></td>
<td>
<p>(logical) Flip y direction</p>
</td></tr>
<tr><td><code id="flip_img_+3A_z">z</code></td>
<td>
<p>(logical) Flip z direction</p>
</td></tr>
<tr><td><code id="flip_img_+3A_...">...</code></td>
<td>
<p>Arguments passed to <code><a href="#topic+check_nifti">check_nifti</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Object of class nifti
</p>


<h3>Examples</h3>

<pre><code class='language-R'>img = random_nifti(rep(15, 3))
flipped = flip_img(img, x = TRUE, y = TRUE, z = TRUE)
img = random_nifti(rep(15, 2))
flipped = flip_img(img, x = TRUE)
testthat::expect_error(flip_img(img, z= TRUE))
</code></pre>

<hr>
<h2 id='getEmptyImageDimensions'>Get Empty Image Dimensions</h2><span id='topic+getEmptyImageDimensions'></span><span id='topic+get_empty_dim'></span>

<h3>Description</h3>

<p>Creates a list of indices of an image that has all irrelevant
values
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getEmptyImageDimensions(img, value = 0, threshold = 0, reorient = FALSE, ...)

get_empty_dim(img, value = 0, threshold = 0, reorient = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getEmptyImageDimensions_+3A_img">img</code></td>
<td>
<p>nifti object or array</p>
</td></tr>
<tr><td><code id="getEmptyImageDimensions_+3A_value">value</code></td>
<td>
<p>Value to check against.  If zero, then 
<code>getEmptyImageDimensions</code> will include any dimension that has 
fewer than <code>threshold</code> zeroes. May be a vector of values, matched with 
<code><a href="base.html#topic+match">match</a></code></p>
</td></tr>
<tr><td><code id="getEmptyImageDimensions_+3A_threshold">threshold</code></td>
<td>
<p>Include dimension if fewer than <code>threshold</code> voxels
are in the slice</p>
</td></tr>
<tr><td><code id="getEmptyImageDimensions_+3A_reorient">reorient</code></td>
<td>
<p>Should image be reoriented if a filename?</p>
</td></tr>
<tr><td><code id="getEmptyImageDimensions_+3A_...">...</code></td>
<td>
<p>additional arguments to pass to 
<code><a href="#topic+check_nifti">check_nifti</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of length 3 of indices.
</p>


<h3>Note</h3>

<p><code>get_empty_dim</code> is a shorthand for <code>getEmptyImageDimensions</code>
with all the same arguments.  Also, <code>NA</code> are set to zero.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>arr = array(rbinom(1000, size = 1, prob = 0.2), dim = c(10,10,10))
arr[,,1] = 0
arr[2:3,,] = 0
getEmptyImageDimensions(arr)
</code></pre>

<hr>
<h2 id='hist.nifti'>Histogram of Values in an Image</h2><span id='topic+hist.nifti'></span><span id='topic+hist.anlz'></span>

<h3>Description</h3>

<p>Computes and displays a histogram of the values
of an image with the option for a mask.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'nifti'
hist(x, ..., mask)

## S3 method for class 'anlz'
hist(x, ..., mask)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hist.nifti_+3A_x">x</code></td>
<td>
<p>Object of class <code>nifti</code></p>
</td></tr>
<tr><td><code id="hist.nifti_+3A_...">...</code></td>
<td>
<p>Arguments passed to <code><a href="graphics.html#topic+hist.default">hist.default</a></code></p>
</td></tr>
<tr><td><code id="hist.nifti_+3A_mask">mask</code></td>
<td>
<p>object to subset the image.  If missing, then all 
values of the image are plotted.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Output of <code><a href="graphics.html#topic+hist">hist</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>img = nifti(array(rnorm(10^3), dim = rep(10, 3)))
mask = img &gt; 0
hist(img, mask = mask)
</code></pre>

<hr>
<h2 id='images2matrix'>Transform set of images to matrix</h2><span id='topic+images2matrix'></span>

<h3>Description</h3>

<p>Creates a matrix, where the voxels are on the rows 
and images are on the columns
</p>


<h3>Usage</h3>

<pre><code class='language-R'>images2matrix(imgs, mask = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="images2matrix_+3A_imgs">imgs</code></td>
<td>
<p>Vector of files or list of images (niftiImage, array, or nifti)</p>
</td></tr>
<tr><td><code id="images2matrix_+3A_mask">mask</code></td>
<td>
<p>Binary image to subset the voxels</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Matrix of V by p, where V is the product of the dimensions of one 
image or the number of voxels in the mask, and p is the number of images
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(5)
dims = rep(10, 3)
arr = array(rpois(prod(dims), lambda = 2), dim = dims)
nim = oro.nifti::nifti(arr)
imgs = list(nim, arr)
mask = nim &gt; 2
mat1 = images2matrix(imgs)
mat2 = images2matrix(list(nim, nim))
if (packageVersion("oro.nifti") &gt;= package_version("0.10.2")) {
testthat::expect_equal(mat1, mat2)
} else {
testthat::expect_error(testthat::expect_equal(mat1, mat2))
}
mat1 = images2matrix(imgs, mask = mask)
mat2 = images2matrix(list(nim, nim), mask)
</code></pre>

<hr>
<h2 id='img_colour_df'>Convert Image to Data.frame with Colors</h2><span id='topic+img_colour_df'></span><span id='topic+img_color_df'></span>

<h3>Description</h3>

<p>Takes in an image and a color scheme, converts that image
into a <code>data.frame</code> with the data and a color mapping.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>img_colour_df(img, zlim = NULL, breaks = NULL, col = gray(0:64/64))

img_color_df(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="img_colour_df_+3A_img">img</code></td>
<td>
<p>an object to be coerced to <code>nifti</code> using 
<code><a href="#topic+check_nifti">check_nifti</a></code></p>
</td></tr>
<tr><td><code id="img_colour_df_+3A_zlim">zlim</code></td>
<td>
<p>Limits for the domain of the intensities</p>
</td></tr>
<tr><td><code id="img_colour_df_+3A_breaks">breaks</code></td>
<td>
<p>Breaks for the intensities to map to colors</p>
</td></tr>
<tr><td><code id="img_colour_df_+3A_col">col</code></td>
<td>
<p>Colors to map intensities</p>
</td></tr>
<tr><td><code id="img_colour_df_+3A_...">...</code></td>
<td>
<p>not used</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>data.frame</code> with the first columns being the x,y,z (maybe t)
coordinates (named <code>dim</code> and the dimension number), a <code>value</code> 
column that contains the intensity information, and a <code>colour</code> column
representing the color that voxel maps to
</p>


<h3>Note</h3>

<p><code>img_color_df</code> is a duplicate of <code>img_colour_df</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>img = nifti(array(rnorm(10^3), dim = rep(10, 3)))
df = img_colour_df(img)
df = img_color_df(img)
</code></pre>

<hr>
<h2 id='img_indices'>Retrieve Image Indices</h2><span id='topic+img_indices'></span>

<h3>Description</h3>

<p>Extract image xyz indices (in voxels or millimeters), with the
option to append the values
</p>


<h3>Usage</h3>

<pre><code class='language-R'>img_indices(img, mask = NULL, add_values = FALSE, units = c("index", "mm"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="img_indices_+3A_img">img</code></td>
<td>
<p>Object of class <code>nifti</code></p>
</td></tr>
<tr><td><code id="img_indices_+3A_mask">mask</code></td>
<td>
<p>Mask to be applied for indices the index</p>
</td></tr>
<tr><td><code id="img_indices_+3A_add_values">add_values</code></td>
<td>
<p>Should the value be column-bound to the matrix</p>
</td></tr>
<tr><td><code id="img_indices_+3A_units">units</code></td>
<td>
<p>Should the indices be in xyz-coordinates or millimeters.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Matrix of 3 columns if <code>add_values = FALSE</code> or 4 columns, 
otherwise.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(5)
dims = rep(10, 4)
arr = array(rpois(prod(dims), lambda = 2), dim = dims)
nim = oro.nifti::nifti(arr)
ind = img_indices(nim)
ind2 = img_indices(nim, mask = nim &gt; 2)
# 3d example
set.seed(5)
dims = rep(10, 3)
arr = array(rpois(prod(dims), lambda = 2), dim = dims)
nim = oro.nifti::nifti(arr)
ind = img_indices(nim)
ind2 = img_indices(nim, mask = nim &gt; 2)
testthat::expect_equal(colnames(ind2), c("x", "y", "z"))
ind2 = img_indices(nim, mask = nim &gt; 2, add_values = TRUE)
testthat::expect_equal(colnames(ind2), c("x", "y", "z", "value"))
</code></pre>

<hr>
<h2 id='img_list_to_ts'>Image List to Time Series</h2><span id='topic+img_list_to_ts'></span>

<h3>Description</h3>

<p>Turns a a list of 3D images into a 4D time series image
</p>


<h3>Usage</h3>

<pre><code class='language-R'>img_list_to_ts(imgs, copy_nifti = TRUE, warn = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="img_list_to_ts_+3A_imgs">imgs</code></td>
<td>
<p>object of class <code><a href="base.html#topic+list">list</a></code>, each with 3 dimensions,</p>
</td></tr>
<tr><td><code id="img_list_to_ts_+3A_copy_nifti">copy_nifti</code></td>
<td>
<p>Should a <code>nifti</code> object be returned (<code>TRUE</code>) or 
a simply array (<code>FALSE</code>).  Should only be used for slight speed up when
array is adequate</p>
</td></tr>
<tr><td><code id="img_list_to_ts_+3A_warn">warn</code></td>
<td>
<p>Should a warning be printed if object is not class
<code><a href="oro.nifti.html#topic+nifti">nifti</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Object of class <code><a href="oro.nifti.html#topic+nifti">nifti</a></code>
</p>


<h3>Note</h3>

<p>If the object is not of class <code><a href="base.html#topic+list">list</a></code>,
then the object is returned
</p>

<hr>
<h2 id='img_ts_to_df'>Image Time Series to Data.frame</h2><span id='topic+img_ts_to_df'></span>

<h3>Description</h3>

<p>Turns a 4D time series image to a Data.frame
</p>


<h3>Usage</h3>

<pre><code class='language-R'>img_ts_to_df(imgs, warn = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="img_ts_to_df_+3A_imgs">imgs</code></td>
<td>
<p>object of class <code><a href="oro.nifti.html#topic+nifti">nifti</a></code> with 4 dimensions, 
aka a 4D time series</p>
</td></tr>
<tr><td><code id="img_ts_to_df_+3A_warn">warn</code></td>
<td>
<p>Should a warning be printed if object is not class
<code><a href="oro.nifti.html#topic+nifti">nifti</a></code> (e.g. a list instead)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Matrix of values
</p>

<hr>
<h2 id='img_ts_to_list'>Image Time Series to list</h2><span id='topic+img_ts_to_list'></span>

<h3>Description</h3>

<p>Turns a 4D time series image to a list of 3D images
</p>


<h3>Usage</h3>

<pre><code class='language-R'>img_ts_to_list(imgs, copy_nifti = TRUE, warn = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="img_ts_to_list_+3A_imgs">imgs</code></td>
<td>
<p>object of class <code><a href="oro.nifti.html#topic+nifti">nifti</a></code> with 4 dimensions, 
aka a 4D time series</p>
</td></tr>
<tr><td><code id="img_ts_to_list_+3A_copy_nifti">copy_nifti</code></td>
<td>
<p>Should <code>nifti</code> objects be returned (<code>TRUE</code>) or 
simply arrays (<code>FALSE</code>).  Should only be used for slight speed up when
array is adequate</p>
</td></tr>
<tr><td><code id="img_ts_to_list_+3A_warn">warn</code></td>
<td>
<p>Should a warning be printed if object is not class
<code><a href="oro.nifti.html#topic+nifti">nifti</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of images
</p>


<h3>Note</h3>

<p>If the object is not of class <code><a href="oro.nifti.html#topic+nifti">nifti</a></code> or have
4 dimensions, then the object is returned
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(5)
dims = rep(10, 4)
arr = array(rpois(prod(dims), lambda = 2), dim = dims)
nim = oro.nifti::nifti(arr)
simg = img_ts_to_list(nim)
simg_arr = img_ts_to_list(arr)
back = img_list_to_ts(simg_arr)
slist = lapply(simg, function(x) array(x, dim(x)))
testthat::expect_equal(slist, simg_arr)
simg_arr = img_ts_to_matrix(arr)
simg_arr = img_ts_to_df(arr)
</code></pre>

<hr>
<h2 id='img_ts_to_matrix'>Image Time Series to Matrix</h2><span id='topic+img_ts_to_matrix'></span>

<h3>Description</h3>

<p>Turns a 4D time series image to a Matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>img_ts_to_matrix(imgs, warn = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="img_ts_to_matrix_+3A_imgs">imgs</code></td>
<td>
<p>object of class <code><a href="oro.nifti.html#topic+nifti">nifti</a></code> with 4 dimensions, 
aka a 4D time series</p>
</td></tr>
<tr><td><code id="img_ts_to_matrix_+3A_warn">warn</code></td>
<td>
<p>Should a warning be printed if object is not class
<code><a href="oro.nifti.html#topic+nifti">nifti</a></code> (e.g. a list instead)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Matrix of values
</p>

<hr>
<h2 id='mask_img'>Mask Image</h2><span id='topic+mask_img'></span>

<h3>Description</h3>

<p>Takes an image, masks it by 
<code>mask</code>, and returns an object of class <code>nifti</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mask_img(img, mask, allow.NA = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mask_img_+3A_img">img</code></td>
<td>
<p>object of class <code>nifti</code></p>
</td></tr>
<tr><td><code id="mask_img_+3A_mask">mask</code></td>
<td>
<p>array or object of class <code>nifti</code>, same dimensions as img</p>
</td></tr>
<tr><td><code id="mask_img_+3A_allow.na">allow.NA</code></td>
<td>
<p>allow NAs in the mask</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Object of class nifti with values outside mask set to 0 if mask is
0 and NA if mask is NA and img if mask == 1
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  set.seed(5)
  dims = rep(10, 3)
  arr = array(rnorm(prod(dims)), dim = dims)
  nim = oro.nifti::nifti(arr)
  mask = abs(nim) &gt; 1
  masked = mask_img(nim, mask)
  mask[mask == 0] = NA
  na_masked = mask_img(nim, mask, allow.NA = TRUE)
  
set.seed(5)
dims = rep(10, 3)
arr = array(rnorm(prod(dims)), dim = dims)
arr[,,10] = 0
nim = oro.nifti::nifti(arr)
rnifti = RNifti::asNifti(nim)
mask = nim &gt; 0
timg = tempimg(nim)
limg = list(factor(timg), factor(timg))
func = function(...) mask_img(..., mask = mask)
func(arr)
func(nim)
func(rnifti)
func(timg)
lapply(limg, func)
</code></pre>

<hr>
<h2 id='mask_vals'>Extract or Replace Values Inside a Mask</h2><span id='topic+mask_vals'></span><span id='topic+mask_vals-methods+2C'></span><span id='topic+mask_vals+3C-'></span><span id='topic+mask_vals+3C-+2Cnifti-method'></span><span id='topic+mask_vals+3C-+2Cnifti+2CANY+2CANY-method'></span><span id='topic+mask_vals+3C-+2Canlz-method'></span><span id='topic+mask_vals+3C-+2Canlz+2CANY+2CANY-method'></span><span id='topic+mask_vals+3C-+2Carray-method'></span><span id='topic+mask_vals+3C-+2Carray+2CANY+2CANY-method'></span>

<h3>Description</h3>

<p>Methods that act on the <code>.Data</code> field in a
NIfTI/ANALYZE image but only on values inside a mask.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mask_vals(object, mask)

mask_vals(object, mask) &lt;- value

## S4 replacement method for signature 'nifti'
mask_vals(object, mask) &lt;- value

## S4 replacement method for signature 'anlz'
mask_vals(object, mask) &lt;- value

## S4 replacement method for signature 'array'
mask_vals(object, mask) &lt;- value
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mask_vals_+3A_object">object</code></td>
<td>
<p>is an object of class <code>nifti</code> or <code>anlz</code>.</p>
</td></tr>
<tr><td><code id="mask_vals_+3A_mask">mask</code></td>
<td>
<p>is an object of class <code>nifti</code> or <code>anlz</code>.</p>
</td></tr>
<tr><td><code id="mask_vals_+3A_value">value</code></td>
<td>
<p>is the value to assign to the <code>.Data</code> field.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(2022)
img = nifti(array(rnorm(10^3), dim = rep(10, 3)))
mask = img &gt; 1.5
mask_vals(img, mask)
testthat::expect_equal(sum(mask_vals(img, mask)), 117.628200302518)
mask_vals(img, mask) = rep(4, sum(mask))
mask_vals(img, as(mask, "array")) = rep(4, sum(mask))
mask_vals(as(img, "array"), 
    as(mask, "array")) = rep(4, sum(mask))
</code></pre>

<hr>
<h2 id='maskEmptyImageDimensions-methods'>Apply Masking from Empty Image Dimensions</h2><span id='topic+maskEmptyImageDimensions-methods'></span><span id='topic+maskEmptyImageDimensions'></span><span id='topic+maskEmptyImageDimensions+2Cnifti-method'></span><span id='topic+maskEmptyImageDimensions+2Ccharacter-method'></span><span id='topic+maskEmptyImageDimensions+2Cfactor-method'></span><span id='topic+maskEmptyImageDimensions+2Clist-method'></span><span id='topic+maskEmptyImageDimensions+2Carray-method'></span><span id='topic+maskEmptyImageDimensions+2Canlz-method'></span><span id='topic+maskEmptyImageDimensions+2CANY-method'></span><span id='topic+mask_empty_dim'></span>

<h3>Description</h3>

<p>Simple wrapper for replacing indices with a value
</p>


<h3>Usage</h3>

<pre><code class='language-R'>maskEmptyImageDimensions(img, inds, reorient = FALSE, mask.value = 0, ...)

## S4 method for signature 'nifti'
maskEmptyImageDimensions(img, inds, reorient = FALSE, mask.value = 0, ...)

## S4 method for signature 'character'
maskEmptyImageDimensions(img, inds, reorient = FALSE, mask.value = 0, ...)

## S4 method for signature 'factor'
maskEmptyImageDimensions(img, inds, reorient = FALSE, mask.value = 0, ...)

## S4 method for signature 'list'
maskEmptyImageDimensions(img, inds, reorient = FALSE, mask.value = 0, ...)

## S4 method for signature 'array'
maskEmptyImageDimensions(img, inds, reorient = FALSE, mask.value = 0, ...)

## S4 method for signature 'anlz'
maskEmptyImageDimensions(img, inds, reorient = FALSE, mask.value = 0, ...)

## S4 method for signature 'ANY'
maskEmptyImageDimensions(img, inds, reorient = FALSE, mask.value = 0, ...)

mask_empty_dim(img, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="maskEmptyImageDimensions-methods_+3A_img">img</code></td>
<td>
<p>image, nifti object, or array</p>
</td></tr>
<tr><td><code id="maskEmptyImageDimensions-methods_+3A_inds">inds</code></td>
<td>
<p>indices of subset from <code><a href="#topic+getEmptyImageDimensions">getEmptyImageDimensions</a></code> or
<code><a href="#topic+dropEmptyImageDimensions">dropEmptyImageDimensions</a></code>.</p>
</td></tr>
<tr><td><code id="maskEmptyImageDimensions-methods_+3A_reorient">reorient</code></td>
<td>
<p>Should image be reoriented if a filename?</p>
</td></tr>
<tr><td><code id="maskEmptyImageDimensions-methods_+3A_mask.value">mask.value</code></td>
<td>
<p>Value to replace voxels outside the mask.</p>
</td></tr>
<tr><td><code id="maskEmptyImageDimensions-methods_+3A_...">...</code></td>
<td>
<p>not used</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Object of class <code>nifti</code> or <code>array</code> if <code>nifti</code>
is not supplied
</p>


<h3>Note</h3>

<p><code>mask_empty_dim</code> is a shorthand for 
<code>maskEmptyImageDimensions</code> with all the same arguments.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+getEmptyImageDimensions">getEmptyImageDimensions</a></code>, 
<code><a href="#topic+dropEmptyImageDimensions">dropEmptyImageDimensions</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(5)
dims = rep(10, 3)
arr = array(rnorm(prod(dims)), dim = dims)
arr[,,10] = 0
nim = oro.nifti::nifti(arr)
inds = getEmptyImageDimensions(nim)
inds_arr = getEmptyImageDimensions(arr)
res = maskEmptyImageDimensions(nim, inds = inds, mask.value = NA)
res2 = maskEmptyImageDimensions(arr, inds = inds_arr, mask.value = NA)
testthat::expect_equal(array(res, dim = dim(res)), 
array(res2, dim = dim(res2)))

set.seed(5)
dims = rep(10, 3)
arr = array(rnorm(prod(dims)), dim = dims)
arr[,,10] = 0
nim = oro.nifti::nifti(arr)
inds = getEmptyImageDimensions(nim)
rnifti = RNifti::asNifti(nim)
timg = tempimg(nim)
limg = list(factor(timg), factor(timg))
mask_empty_dim(nim, inds = inds)
func = function(...) maskEmptyImageDimensions(..., inds = inds)
func(arr)
func(nim)
func(rnifti)
func(timg)
func(limg)

</code></pre>

<hr>
<h2 id='mean.nifti'>Mean of Values in an Image</h2><span id='topic+mean.nifti'></span><span id='topic+mean.anlz'></span>

<h3>Description</h3>

<p>Computes the mean of values
of an image with the option for a mask.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'nifti'
mean(x, ..., mask)

## S3 method for class 'anlz'
mean(x, ..., mask)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mean.nifti_+3A_x">x</code></td>
<td>
<p>Object of class <code>nifti</code></p>
</td></tr>
<tr><td><code id="mean.nifti_+3A_...">...</code></td>
<td>
<p>Arguments passed to <code><a href="base.html#topic+mean.default">mean.default</a></code></p>
</td></tr>
<tr><td><code id="mean.nifti_+3A_mask">mask</code></td>
<td>
<p>object to subset the image.  If missing, then all 
values of the image are plotted.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Output of <code><a href="base.html#topic+mean">mean</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>img = nifti(array(rnorm(10^3), dim = rep(10, 3)))
mask = img &gt; 0
mean(img, mask = mask)
</code></pre>

<hr>
<h2 id='minmax_img-methods'>Normalize Image using Range</h2><span id='topic+minmax_img-methods'></span><span id='topic+minmax_img'></span><span id='topic+minmax_img+2Cnifti-method'></span><span id='topic+minmax_img+2Carray-method'></span><span id='topic+minmax_img+2CANY-method'></span><span id='topic+minmax_img+2Ccharacter-method'></span><span id='topic+minmax_img+2Cfactor-method'></span><span id='topic+minmax_img+2Clist-method'></span>

<h3>Description</h3>

<p>Calculates the range of values in an image, then
scales the image minimum to 0 and maximum to 1
</p>


<h3>Usage</h3>

<pre><code class='language-R'>minmax_img(img)

## S4 method for signature 'nifti'
minmax_img(img)

## S4 method for signature 'array'
minmax_img(img)

## S4 method for signature 'ANY'
minmax_img(img)

## S4 method for signature 'character'
minmax_img(img)

## S4 method for signature 'factor'
minmax_img(img)

## S4 method for signature 'list'
minmax_img(img)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="minmax_img-methods_+3A_img">img</code></td>
<td>
<p>character path of image or 
an object of class <code>nifti</code>, or list of images</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>nifti</code> object (or list of them) or class of 
object passed in if not specified
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(5)
dims = rep(10, 4)
arr = array(rpois(prod(dims), lambda = 2), dim = dims)
nim = oro.nifti::nifti(arr)
mimg = minmax_img(nim)
marr = minmax_img(arr)
testthat::expect_equal(array(mimg, dim = dim(mimg)), marr)

set.seed(5)
dims = rep(10, 3)
arr = array(rnorm(prod(dims)), dim = dims)
arr[,,10] = 0
nim = oro.nifti::nifti(arr)
rnifti = RNifti::asNifti(nim)
timg = tempimg(nim)
limg = list(factor(timg), factor(timg))
func = minmax_img
func(arr)
func(nim)
func(rnifti)
func(timg)
func(limg)
</code></pre>

<hr>
<h2 id='multi_overlay'>Create Multi-Image Plot with Overlays</h2><span id='topic+multi_overlay'></span><span id='topic+multi_overlay_center'></span>

<h3>Description</h3>

<p>Creates a multi-row or multi-column plot with image
slices and the potential for overlays as well.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multi_overlay(
  x,
  y = NULL,
  z = NULL,
  w = 1,
  mask = NULL,
  col.x = gray(0:64/64),
  col.y = hotmetal(),
  zlim.x = NULL,
  zlim.y = NULL,
  ybreaks = NULL,
  plane = c("axial", "coronal", "sagittal"),
  xlab = "",
  ylab = "",
  axes = FALSE,
  direction = c("horizontal", "vertical"),
  par.opts = list(oma = c(0, 0, 0, 0), mar = rep(0, 4), bg = "black"),
  text = NULL,
  text.x = 0.5,
  text.y = 1.4,
  text.cex = 2.5,
  text.col = "white",
  main = NULL,
  main.col = text.col,
  main.cex = text.cex,
  NA.x = TRUE,
  NA.y = TRUE,
  pdim = NULL,
  useRaster = TRUE,
  ...
)

multi_overlay_center(x, y = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="multi_overlay_+3A_x">x</code></td>
<td>
<p>List of images of class <code>nifti</code> or character vector of filenames</p>
</td></tr>
<tr><td><code id="multi_overlay_+3A_y">y</code></td>
<td>
<p>List of images of class <code>nifti</code> or character vector of filenames.
Same length as <code>x</code>.</p>
</td></tr>
<tr><td><code id="multi_overlay_+3A_z">z</code></td>
<td>
<p>Slice to display.</p>
</td></tr>
<tr><td><code id="multi_overlay_+3A_w">w</code></td>
<td>
<p>3D volume to display if <code>x</code> has 4-D elements</p>
</td></tr>
<tr><td><code id="multi_overlay_+3A_mask">mask</code></td>
<td>
<p><code>nifti</code> image to drop empty image dimensions if wanted. 
Passed to <code><a href="#topic+dropEmptyImageDimensions">dropEmptyImageDimensions</a></code></p>
</td></tr>
<tr><td><code id="multi_overlay_+3A_col.x">col.x</code></td>
<td>
<p>Color to display x images</p>
</td></tr>
<tr><td><code id="multi_overlay_+3A_col.y">col.y</code></td>
<td>
<p>Color to display y images</p>
</td></tr>
<tr><td><code id="multi_overlay_+3A_zlim.x">zlim.x</code></td>
<td>
<p>Limits for <code>x</code> to plot</p>
</td></tr>
<tr><td><code id="multi_overlay_+3A_zlim.y">zlim.y</code></td>
<td>
<p>Limits for <code>y</code> to plot</p>
</td></tr>
<tr><td><code id="multi_overlay_+3A_ybreaks">ybreaks</code></td>
<td>
<p>(numeric) breaks for y to passed to 
<code><a href="graphics.html#topic+image">image</a></code></p>
</td></tr>
<tr><td><code id="multi_overlay_+3A_plane">plane</code></td>
<td>
<p>the plane of acquisition to be displayed</p>
</td></tr>
<tr><td><code id="multi_overlay_+3A_xlab">xlab</code></td>
<td>
<p>Label for x-axis</p>
</td></tr>
<tr><td><code id="multi_overlay_+3A_ylab">ylab</code></td>
<td>
<p>Label for y-axis</p>
</td></tr>
<tr><td><code id="multi_overlay_+3A_axes">axes</code></td>
<td>
<p>Should axes be displayed</p>
</td></tr>
<tr><td><code id="multi_overlay_+3A_direction">direction</code></td>
<td>
<p>Should images be a row or column? Ignored if 
<code>mfrow</code> is in <code>par.opts</code></p>
</td></tr>
<tr><td><code id="multi_overlay_+3A_par.opts">par.opts</code></td>
<td>
<p>Options to pass to <code><a href="graphics.html#topic+par">par</a></code></p>
</td></tr>
<tr><td><code id="multi_overlay_+3A_text">text</code></td>
<td>
<p>Text to be displayed</p>
</td></tr>
<tr><td><code id="multi_overlay_+3A_text.x">text.x</code></td>
<td>
<p>Location of text in x-domain</p>
</td></tr>
<tr><td><code id="multi_overlay_+3A_text.y">text.y</code></td>
<td>
<p>Location of text in y-domain</p>
</td></tr>
<tr><td><code id="multi_overlay_+3A_text.cex">text.cex</code></td>
<td>
<p>Multiplier for text font</p>
</td></tr>
<tr><td><code id="multi_overlay_+3A_text.col">text.col</code></td>
<td>
<p>Color for <code>text</code> and <code>main</code>.</p>
</td></tr>
<tr><td><code id="multi_overlay_+3A_main">main</code></td>
<td>
<p>Title for each plot</p>
</td></tr>
<tr><td><code id="multi_overlay_+3A_main.col">main.col</code></td>
<td>
<p>Color for <code>main</code>. Will default to <code>text.col</code></p>
</td></tr>
<tr><td><code id="multi_overlay_+3A_main.cex">main.cex</code></td>
<td>
<p>Multiplier for text font. Will default to <code>text.cex</code></p>
</td></tr>
<tr><td><code id="multi_overlay_+3A_na.x">NA.x</code></td>
<td>
<p>Should <code>0</code>'s in <code>x</code> be set to <code>NA</code>?</p>
</td></tr>
<tr><td><code id="multi_overlay_+3A_na.y">NA.y</code></td>
<td>
<p>Should <code>0</code>'s in <code>y</code> be set to <code>NA</code>?</p>
</td></tr>
<tr><td><code id="multi_overlay_+3A_pdim">pdim</code></td>
<td>
<p>Pixel dimensions if passing in arrays.  Will be overridden if 
<code>x</code> is a <code>nifti</code> object</p>
</td></tr>
<tr><td><code id="multi_overlay_+3A_useraster">useRaster</code></td>
<td>
<p>if <code>TRUE</code>, a bitmap raster is used to plot 
the image instead of polygons. Passed to <code><a href="graphics.html#topic+image">image</a></code></p>
</td></tr>
<tr><td><code id="multi_overlay_+3A_...">...</code></td>
<td>
<p>Additional arguments to pass to <code><a href="graphics.html#topic+image">image</a></code></p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(5)
dims = rep(10, 4)
arr = array(rnorm(prod(dims)), dim = dims)
arr[,,,c(3, 5)] = rpois(1000*2, lambda = 2)
nim = oro.nifti::nifti(arr)
mask = nim &gt; 2
add_mask = nim[,,,1] &gt; 0
imgs = img_ts_to_list(nim) 
masks = img_ts_to_list(mask) 
multi_overlay(imgs, masks)
multi_overlay(imgs, masks, 
main = "hey", direction = "vertical", plane = "coronal")
multi_overlay(imgs, masks, mask = add_mask, 
main = "hey")



## Not run: 

 if (requireNamespace("brainR", quietly = TRUE)) {
   visits = 1:3
   y = paste0("Visit_", visits, ".nii.gz")
   y = system.file(y, package = "brainR")
   y = lapply(y, readnii)

   y = lapply(y, function(r){
     pixdim(r) = c(0, rep(1, 3), rep(0, 4))
     dropImageDimension(r)
   })

   x = system.file("MNI152_T1_1mm_brain.nii.gz", 
                 package = "brainR")
   x = readnii(x)
   mask = x &gt;0
   x = lapply(visits, function(tmp){
       x
   })
   alpha = function(col, alpha = 1) {
       cols = t(col2rgb(col, alpha = FALSE)/255)
       rgb(cols, alpha = alpha)
   }
   multi_overlay(x, y, 
         col.y = alpha(hotmetal(), 0.5),
         mask = mask, 
         main = paste0("\n", "Visit ", visits),
         text = LETTERS[visits],
         text.x = 0.9,
         text.y = 0.1,
         text.cex = 3)
 }

## End(Not run)
</code></pre>

<hr>
<h2 id='newnii'>Resets image parameters for a copied nifti object</h2><span id='topic+newnii'></span>

<h3>Description</h3>

<p>Resets the slots of a nifti object, usually because an image
was loaded, then copied and filled in with new data instead of making a 
nifti object from scratch.  Just a wrapper for smaller functions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>newnii(img, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="newnii_+3A_img">img</code></td>
<td>
<p>nifti object (or character of filename)</p>
</td></tr>
<tr><td><code id="newnii_+3A_...">...</code></td>
<td>
<p>arguments to be passed to <code><a href="#topic+datatype">datatype</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>object of type nifti
</p>

<hr>
<h2 id='niftiarr'>Make new nifti from array</h2><span id='topic+niftiarr'></span>

<h3>Description</h3>

<p>Make new nifti object by passing in old nifti and array
</p>


<h3>Usage</h3>

<pre><code class='language-R'>niftiarr(img, arr)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="niftiarr_+3A_img">img</code></td>
<td>
<p>object of class nifti</p>
</td></tr>
<tr><td><code id="niftiarr_+3A_arr">arr</code></td>
<td>
<p>array to be passed in to .Data slot</p>
</td></tr>
</table>


<h3>Value</h3>

<p>object of class nifti
</p>

<hr>
<h2 id='nii.stub'>Grab nii file stubname</h2><span id='topic+nii.stub'></span>

<h3>Description</h3>

<p>Quick helper function to strip off .nii or .nii.gz 
from filename
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nii.stub(x, bn = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nii.stub_+3A_x">x</code></td>
<td>
<p>character vector of filenames ending in .nii or .nii.gz</p>
</td></tr>
<tr><td><code id="nii.stub_+3A_bn">bn</code></td>
<td>
<p>Take <code><a href="base.html#topic+basename">basename</a></code> of file?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character vector with the same length as <code>x</code>
</p>

<hr>
<h2 id='orient_rpi'>Reorient an Image to RPI orientation</h2><span id='topic+orient_rpi'></span><span id='topic+orient_rpi_file'></span><span id='topic+is_rpi_oriented'></span>

<h3>Description</h3>

<p>Reorient an Image to RPI orientation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>orient_rpi(file, verbose = TRUE)

orient_rpi_file(file, verbose = TRUE)

is_rpi_oriented(file, verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="orient_rpi_+3A_file">file</code></td>
<td>
<p>Object of class <code>nifti</code> or character path</p>
</td></tr>
<tr><td><code id="orient_rpi_+3A_verbose">verbose</code></td>
<td>
<p>print diagnostic messages</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of 3 elements
</p>

<ul>
<li><p><code>img</code>: Reoriented image of class <code>nifti</code>
</p>
</li>
<li><p><code>convention</code>: Convention (Neurological/Radiological) of original image
</p>
</li>
<li><p><code>orientation</code>: Original image orientations
</p>
</li></ul>



<h3>Note</h3>

<p>'orient_rpi' and 'orient_rpi_file' uses 'RNifti' to ensure the 
reading orientation
</p>


<h3>Examples</h3>

<pre><code class='language-R'>lr_fname = system.file( "nifti", "mniLR.nii.gz", package = "oro.nifti")
img = readnii(lr_fname)

rl_fname = system.file( "nifti", "mniRL.nii.gz", package = "oro.nifti")
rl_img = readnii(rl_fname)
stopifnot(all(rl_img[nrow(rl_img):1,,] == img))

reor = orient_rpi(rl_fname)
stopifnot(all(img == reor$img))

rev = reverse_orient_rpi(reor$img, convention = reor$convention,
orientation = reor$orientation)
stopifnot(all(rev == rl_img))
</code></pre>

<hr>
<h2 id='ortho_diff'>Plot differences for Prediction and Gold Standard</h2><span id='topic+ortho_diff'></span><span id='topic+multi_overlay_diff'></span>

<h3>Description</h3>

<p>Uses <code><a href="#topic+ortho2">ortho2</a></code> to plot differences between a predicted binary
image and the assumed ground truth (<code>roi</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ortho_diff(
  img,
  pred,
  roi,
  xyz = NULL,
  cols = c("#56B4E9", "#D55E00", "#009E73"),
  levels = c("False Negative", "False Positive", "True Positive"),
  addlegend = TRUE,
  center = TRUE,
  leg.cex = 1.5,
  ...
)

multi_overlay_diff(
  x,
  pred,
  roi,
  z = NULL,
  cols = c("#56B4E9", "#D55E00", "#009E73"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ortho_diff_+3A_img">img</code></td>
<td>
<p>image to be underlaid</p>
</td></tr>
<tr><td><code id="ortho_diff_+3A_pred">pred</code></td>
<td>
<p>binary segmentation (prediction)</p>
</td></tr>
<tr><td><code id="ortho_diff_+3A_roi">roi</code></td>
<td>
<p>binary manual segmentation (ground truth)</p>
</td></tr>
<tr><td><code id="ortho_diff_+3A_xyz">xyz</code></td>
<td>
<p>coordinate for the center of the crosshairs.</p>
</td></tr>
<tr><td><code id="ortho_diff_+3A_cols">cols</code></td>
<td>
<p>colors for false negatives/positives</p>
</td></tr>
<tr><td><code id="ortho_diff_+3A_levels">levels</code></td>
<td>
<p>labels for false negatives/positives</p>
</td></tr>
<tr><td><code id="ortho_diff_+3A_addlegend">addlegend</code></td>
<td>
<p>add legend, passed to <code><a href="#topic+ortho2">ortho2</a></code></p>
</td></tr>
<tr><td><code id="ortho_diff_+3A_center">center</code></td>
<td>
<p>run <code><a href="#topic+xyz">xyz</a></code> on <code>roi</code>.  Disregarded if <code>xyz</code> is
not <code>NULL</code></p>
</td></tr>
<tr><td><code id="ortho_diff_+3A_leg.cex">leg.cex</code></td>
<td>
<p>multiplier for legend size</p>
</td></tr>
<tr><td><code id="ortho_diff_+3A_...">...</code></td>
<td>
<p>arguments to be passed to <code><a href="#topic+ortho2">ortho2</a></code> or
<code><a href="#topic+multi_overlay">multi_overlay</a></code></p>
</td></tr>
<tr><td><code id="ortho_diff_+3A_x">x</code></td>
<td>
<p>List of images of class <code>nifti</code> or character vector of filenames</p>
</td></tr>
<tr><td><code id="ortho_diff_+3A_z">z</code></td>
<td>
<p>slice to display</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+ortho2">ortho2</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(5)
dims = rep(10, 3)
arr = array(rpois(prod(dims), lambda = 2), dim = dims)
nim = oro.nifti::nifti(arr)
roi = nim &gt; 2
pred = nim &gt; 1.5
ortho_diff(nim, pred, roi)
set.seed(5)
dims = rep(10, 3)
arr = array(rnorm(prod(dims)), dim = dims)
nim = oro.nifti::nifti(arr)
mask = nim &gt; 2
pred = nim &gt; 1.5
multi_overlay_diff(nim, roi = mask, pred = pred)



 if (requireNamespace("brainR", quietly = TRUE)) {
   visits = 1:3
   y = paste0("Visit_", visits, ".nii.gz")
   y = system.file(y, package = "brainR")
   y = lapply(y, readnii)

   y = lapply(y, function(r){
     pixdim(r) = c(0, rep(1, 3), rep(0, 4))
     dropImageDimension(r)
   })

   x = system.file("MNI152_T1_1mm_brain.nii.gz", 
                 package = "brainR")
   x = readnii(x)
   mask = x &gt; 0
   alpha = function(col, alpha = 1) {
       cols = t(col2rgb(col, alpha = FALSE)/255)
       rgb(cols, alpha = alpha)
   }
   roi = y[[2]]
   pred = y
   multi_overlay_diff(x, roi = roi, pred = pred)
   multi_overlay_diff(x, roi = roi, pred = pred, 
         mask = mask, 
         main = paste0("\n", "Visit ", visits),
         text = LETTERS[visits],
         text.x = 0.9,
         text.y = 0.1,
         text.cex = 3)
 }

</code></pre>

<hr>
<h2 id='ortho2'>Orthographic Display, added options</h2><span id='topic+ortho2'></span>

<h3>Description</h3>

<p>Copy of <code>oro.nifti</code>'s <code><a href="oro.nifti.html#topic+orthographic">orthographic</a></code> function 
with some tweaks such as adding L/R designations for left and right
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ortho2(
  x,
  y = NULL,
  xyz = NULL,
  w = 1,
  col = gray(0:64/64),
  col.y = oro.nifti::hotmetal(),
  zlim = NULL,
  zlim.y = NULL,
  NA.x = FALSE,
  NA.y = TRUE,
  crosshairs = TRUE,
  col.crosshairs = "red",
  xlab = "",
  ylab = "",
  axes = FALSE,
  oma = c(0, 0, 0, ifelse(ycolorbar, 5, 0)),
  mar = rep(0, 4),
  bg = "black",
  text = NULL,
  text.color = "white",
  text.cex = 2,
  text.x = 32,
  text.y = 32,
  add.orient = FALSE,
  mfrow = c(2, 2),
  ybreaks = NULL,
  breaks = NULL,
  addlegend = FALSE,
  leg.x = 32,
  leg.y = 32,
  legend,
  leg.col,
  leg.title = NULL,
  leg.cex,
  window = NULL,
  ycolorbar = FALSE,
  clabels = TRUE,
  add = TRUE,
  pdim = NULL,
  useRaster = is.null(y),
  mask = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ortho2_+3A_x">x</code></td>
<td>
<p>is an object of class nifti or similar.</p>
</td></tr>
<tr><td><code id="ortho2_+3A_y">y</code></td>
<td>
<p>is an object of class nifti or similar for the overlay.</p>
</td></tr>
<tr><td><code id="ortho2_+3A_xyz">xyz</code></td>
<td>
<p>is the coordinate for the center of the crosshairs.</p>
</td></tr>
<tr><td><code id="ortho2_+3A_w">w</code></td>
<td>
<p>is the time point to be displayed (4D arrays only).</p>
</td></tr>
<tr><td><code id="ortho2_+3A_col">col</code></td>
<td>
<p>is grayscale (by default).</p>
</td></tr>
<tr><td><code id="ortho2_+3A_col.y">col.y</code></td>
<td>
<p>is hotmetal (by default).</p>
</td></tr>
<tr><td><code id="ortho2_+3A_zlim">zlim</code></td>
<td>
<p>is the minimum and maximum &lsquo;z&rsquo; values passed into image.</p>
</td></tr>
<tr><td><code id="ortho2_+3A_zlim.y">zlim.y</code></td>
<td>
<p>is the minimum and maximum &lsquo;z&rsquo; values passed into image 
for the overlay.</p>
</td></tr>
<tr><td><code id="ortho2_+3A_na.x">NA.x</code></td>
<td>
<p>Set any values of 0 in <code>x</code> to <code>NA</code></p>
</td></tr>
<tr><td><code id="ortho2_+3A_na.y">NA.y</code></td>
<td>
<p>Set any values of 0 in <code>y</code> to <code>NA</code></p>
</td></tr>
<tr><td><code id="ortho2_+3A_crosshairs">crosshairs</code></td>
<td>
<p>is a logical value for the presence of crosshairs 
in all three orthogonal planes (default = TRUE).</p>
</td></tr>
<tr><td><code id="ortho2_+3A_col.crosshairs">col.crosshairs</code></td>
<td>
<p>is the color of the crosshairs (default = red).</p>
</td></tr>
<tr><td><code id="ortho2_+3A_xlab">xlab</code></td>
<td>
<p>is set to &quot;&quot; since all margins are set to zero.</p>
</td></tr>
<tr><td><code id="ortho2_+3A_ylab">ylab</code></td>
<td>
<p>is set to &quot;&quot; since all margins are set to zero.</p>
</td></tr>
<tr><td><code id="ortho2_+3A_axes">axes</code></td>
<td>
<p>is set to FALSE since all margins are set to zero.</p>
</td></tr>
<tr><td><code id="ortho2_+3A_oma">oma</code></td>
<td>
<p>is the size of the outer margins in the par function.</p>
</td></tr>
<tr><td><code id="ortho2_+3A_mar">mar</code></td>
<td>
<p>is the number of lines of margin in the par function.</p>
</td></tr>
<tr><td><code id="ortho2_+3A_bg">bg</code></td>
<td>
<p>is the background color in the par function.</p>
</td></tr>
<tr><td><code id="ortho2_+3A_text">text</code></td>
<td>
<p>allows the user to specify text to appear in 
the fourth (unused) pane.</p>
</td></tr>
<tr><td><code id="ortho2_+3A_text.color">text.color</code></td>
<td>
<p>is the color of the user-specified text 
(default = &ldquo;white&quot;).</p>
</td></tr>
<tr><td><code id="ortho2_+3A_text.cex">text.cex</code></td>
<td>
<p>is the size of the user-specified text (default = 2).</p>
</td></tr>
<tr><td><code id="ortho2_+3A_text.x">text.x</code></td>
<td>
<p>x coordinate for text</p>
</td></tr>
<tr><td><code id="ortho2_+3A_text.y">text.y</code></td>
<td>
<p>y coordinate for text</p>
</td></tr>
<tr><td><code id="ortho2_+3A_add.orient">add.orient</code></td>
<td>
<p>(logical) Add left/right, A/P, etc. orientation</p>
</td></tr>
<tr><td><code id="ortho2_+3A_mfrow">mfrow</code></td>
<td>
<p>(numeric) layout of the 3 slices</p>
</td></tr>
<tr><td><code id="ortho2_+3A_ybreaks">ybreaks</code></td>
<td>
<p>(numeric) breaks for y to passed to 
<code><a href="graphics.html#topic+image">image</a></code></p>
</td></tr>
<tr><td><code id="ortho2_+3A_breaks">breaks</code></td>
<td>
<p>(numeric) breaks for x to passed to 
<code><a href="graphics.html#topic+image">image</a></code></p>
</td></tr>
<tr><td><code id="ortho2_+3A_addlegend">addlegend</code></td>
<td>
<p>(logical) add legend?</p>
</td></tr>
<tr><td><code id="ortho2_+3A_leg.x">leg.x</code></td>
<td>
<p>(numeric) x coordinate for legend</p>
</td></tr>
<tr><td><code id="ortho2_+3A_leg.y">leg.y</code></td>
<td>
<p>(numeric) y coordinate for legend</p>
</td></tr>
<tr><td><code id="ortho2_+3A_legend">legend</code></td>
<td>
<p>(character) legend text</p>
</td></tr>
<tr><td><code id="ortho2_+3A_leg.col">leg.col</code></td>
<td>
<p>(character) Colors for legend</p>
</td></tr>
<tr><td><code id="ortho2_+3A_leg.title">leg.title</code></td>
<td>
<p>(character) title for legend</p>
</td></tr>
<tr><td><code id="ortho2_+3A_leg.cex">leg.cex</code></td>
<td>
<p>(numeric) <code>cex</code> for <code><a href="graphics.html#topic+legend">legend</a></code></p>
</td></tr>
<tr><td><code id="ortho2_+3A_window">window</code></td>
<td>
<p>(vector) Length-2 vector to limit image to certain range</p>
</td></tr>
<tr><td><code id="ortho2_+3A_ycolorbar">ycolorbar</code></td>
<td>
<p>(logical) Should a colorbar for <code>y</code> be plotted</p>
</td></tr>
<tr><td><code id="ortho2_+3A_clabels">clabels</code></td>
<td>
<p>Label for colorbar (see <code><a href="#topic+colorbar">colorbar</a></code>)</p>
</td></tr>
<tr><td><code id="ortho2_+3A_add">add</code></td>
<td>
<p>Should the y-plot be added or its own plot?  Used
in <code>double_ortho</code></p>
</td></tr>
<tr><td><code id="ortho2_+3A_pdim">pdim</code></td>
<td>
<p>Pixel dimensions if passing in arrays.  Will be overridden if 
<code>x</code> is a <code>nifti</code> object</p>
</td></tr>
<tr><td><code id="ortho2_+3A_useraster">useRaster</code></td>
<td>
<p>logical; if TRUE a bitmap raster is used to 
plot the image instead of polygons.  Passed to 
<code><a href="graphics.html#topic+image">image</a></code>.</p>
</td></tr>
<tr><td><code id="ortho2_+3A_mask">mask</code></td>
<td>
<p>If a mask is passed, <code>drop_empty_dim</code> is applied 
to both <code>x</code> and <code>y</code></p>
</td></tr>
<tr><td><code id="ortho2_+3A_...">...</code></td>
<td>
<p>other arguments to the image function may be provided here.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><a href="oro.nifti.html#topic+orthographic">orthographic</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(10)
x = oro.nifti::nifti(array(rnorm(1000), dim = rep(10, 3)))
ortho2(x)
y = x &gt; 2
mask = x &gt; 2.5
ortho2(x, y)
ortho2(x, y, mask = mask, add.orient = TRUE)
ortho2(x, y, mask = mask, add.orient = TRUE, add = FALSE)
nim = RNifti::asNifti(x, internal = FALSE)
ortho2(nim, y, mask = mask)
neurobase::ortho2(nim, x, mask = mask, 
ybreaks = seq(min(x), max(x), length.out = 65), ycolorbar = TRUE)

ortho2(nim, y, mask = mask, add = FALSE)
arr_x = as.array(x)
arr_y = as.array(y)
ortho2( arr_x)
ortho2( arr_x, arr_y, useRaster = FALSE)

set.seed(10)
x = oro.nifti::nifti(array(rnorm(10000), dim = rep(10, 4)))
y = x &gt; 2
mask = x &gt; 2.5
ortho2(x, y)

set.seed(10)
x = oro.nifti::nifti(array(rnorm(100), dim = rep(10, 2)))
y = x &gt; 2
mask = x &gt; 2.5
ortho2(x, y)
</code></pre>

<hr>
<h2 id='parse_img_ext'>Parse Image Extensions</h2><span id='topic+parse_img_ext'></span>

<h3>Description</h3>

<p>Get image extensions from a filename
</p>


<h3>Usage</h3>

<pre><code class='language-R'>parse_img_ext(file)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="parse_img_ext_+3A_file">file</code></td>
<td>
<p>Character filename to parse</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Extension of file
</p>


<h3>Examples</h3>

<pre><code class='language-R'>parse_img_ext("blah.nii.gz")
parse_img_ext("blah.mnc")
parse_img_ext("blah.nii")
parse_img_ext("blah")
parse_img_ext("blah.img")
parse_img_ext("blah.hdr")
parse_img_ext("blah.hdr.gz")
</code></pre>

<hr>
<h2 id='quantile_img'>Create Quantile Image</h2><span id='topic+quantile_img'></span>

<h3>Description</h3>

<p>Creates output image of the quantiles that each voxel is in, 
after applying the mask
</p>


<h3>Usage</h3>

<pre><code class='language-R'>quantile_img(img, mask = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="quantile_img_+3A_img">img</code></td>
<td>
<p>Character vector, or object of class <code>nifti</code></p>
</td></tr>
<tr><td><code id="quantile_img_+3A_mask">mask</code></td>
<td>
<p>Mask to determine cumulative distribution function (cdf) from</p>
</td></tr>
<tr><td><code id="quantile_img_+3A_...">...</code></td>
<td>
<p>Additional arguments to pass to <code><a href="stats.html#topic+ecdf">ecdf</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Object of class <code>nifti</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(5)
dims = rep(10, 3)
arr = array(rnorm(prod(dims)), dim = dims)
nim = oro.nifti::nifti(arr)
qimg = quantile_img(nim)
qarr = quantile_img(arr)
testthat::expect_equal(qarr, array(qimg, dim = dim(qarr)))
qimg = quantile_img(nim, mask = nim &gt; 0)

</code></pre>

<hr>
<h2 id='quantile.nifti'>Sample Quantiles</h2><span id='topic+quantile.nifti'></span><span id='topic+quantile.anlz'></span>

<h3>Description</h3>

<p>Computes sample 
quantiles for an image, with the option of a mask.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'nifti'
quantile(x, ..., mask)

## S3 method for class 'anlz'
quantile(x, ..., mask)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="quantile.nifti_+3A_x">x</code></td>
<td>
<p>Object of class <code>nifti</code></p>
</td></tr>
<tr><td><code id="quantile.nifti_+3A_...">...</code></td>
<td>
<p>Arguments passed to <code><a href="stats.html#topic+quantile">quantile</a></code></p>
</td></tr>
<tr><td><code id="quantile.nifti_+3A_mask">mask</code></td>
<td>
<p>object to subset the image.  If missing, then all 
values of the image are used</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Output of <code><a href="stats.html#topic+quantile">quantile</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>img = nifti(array(rnorm(10^3), dim = rep(10, 3)))
mask = img &gt; 0
quantile(img, mask = mask)
</code></pre>

<hr>
<h2 id='random_nifti'>Create Random 'nifti' object</h2><span id='topic+random_nifti'></span>

<h3>Description</h3>

<p>Create Random 'nifti' object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>random_nifti(dim, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="random_nifti_+3A_dim">dim</code></td>
<td>
<p>dimensions for the 'nifti' object</p>
</td></tr>
<tr><td><code id="random_nifti_+3A_...">...</code></td>
<td>
<p>arguments to send to <code><a href="oro.nifti.html#topic+nifti">nifti</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A 'nifti' object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>random_nifti(c(10, 10, 2))
random_nifti(c(10, 10))
</code></pre>

<hr>
<h2 id='randomize_mask'>Randomize Image based on Mask</h2><span id='topic+randomize_mask'></span>

<h3>Description</h3>

<p>Randomize the values within a mask
</p>


<h3>Usage</h3>

<pre><code class='language-R'>randomize_mask(img, mask)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="randomize_mask_+3A_img">img</code></td>
<td>
<p>Object of class nifti with values to be randomized</p>
</td></tr>
<tr><td><code id="randomize_mask_+3A_mask">mask</code></td>
<td>
<p>Binary mask indicating which values should be randomized.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Object of class nifti
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  set.seed(5)
  dims = rep(10, 3)
  arr = array(rnorm(prod(dims)), dim = dims)
  nim = oro.nifti::nifti(arr)
  mask = abs(nim) &gt; 1
  randomize_mask(nim, mask)
</code></pre>

<hr>
<h2 id='read_rpi'>Read NIfTI file reoriented to RPI</h2><span id='topic+read_rpi'></span>

<h3>Description</h3>

<p>This function calls the <code><a href="#topic+readnii">readnii</a></code> function after
calling <code><a href="#topic+orient_rpi_file">orient_rpi_file</a></code> to force RPI orientation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_rpi(file, ..., verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read_rpi_+3A_file">file</code></td>
<td>
<p>file name of the NIfTI file.</p>
</td></tr>
<tr><td><code id="read_rpi_+3A_...">...</code></td>
<td>
<p>Arguments to pass to <code><a href="#topic+readnii">readnii</a></code></p>
</td></tr>
<tr><td><code id="read_rpi_+3A_verbose">verbose</code></td>
<td>
<p>print diagnostics, passed to <code><a href="#topic+orient_rpi_file">orient_rpi_file</a></code></p>
</td></tr>
</table>


<h3>Note</h3>

<p>'read_rpi' uses 'RNifti' to ensure the reading orientation
</p>

<hr>
<h2 id='readNIfTI2'>readNIfTI with default non-reorientation</h2><span id='topic+readNIfTI2'></span><span id='topic+readnii'></span>

<h3>Description</h3>

<p>This function calls the <code><a href="oro.nifti.html#topic+readNIfTI">readNIfTI</a></code> function from the 
<code>oro.nifti</code> package, but sets the reorientation to <code>FALSE</code> by default
</p>


<h3>Usage</h3>

<pre><code class='language-R'>readNIfTI2(..., reorient = FALSE)

readnii(
  ...,
  reorient = FALSE,
  dtype = TRUE,
  drop_dim = TRUE,
  reset_slope = FALSE,
  warn = FALSE,
  rm_extensions = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="readNIfTI2_+3A_...">...</code></td>
<td>
<p>Arguments to pass to <code><a href="oro.nifti.html#topic+readNIfTI">readNIfTI</a></code></p>
</td></tr>
<tr><td><code id="readNIfTI2_+3A_reorient">reorient</code></td>
<td>
<p>Reorientation argument to pass to <code><a href="oro.nifti.html#topic+readNIfTI">readNIfTI</a></code></p>
</td></tr>
<tr><td><code id="readNIfTI2_+3A_dtype">dtype</code></td>
<td>
<p>Should <code><a href="#topic+datatyper">datatyper</a></code> be run after reading?</p>
</td></tr>
<tr><td><code id="readNIfTI2_+3A_drop_dim">drop_dim</code></td>
<td>
<p>Should <code><a href="oro.nifti.html#topic+drop_img_dim">drop_img_dim</a></code> be run after reading?</p>
</td></tr>
<tr><td><code id="readNIfTI2_+3A_reset_slope">reset_slope</code></td>
<td>
<p>Reset slope/intercept of image</p>
</td></tr>
<tr><td><code id="readNIfTI2_+3A_warn">warn</code></td>
<td>
<p>Should warnings from <code><a href="oro.nifti.html#topic+readNIfTI">readNIfTI</a></code> be 
printed?  If not, <code><a href="base.html#topic+suppressWarnings">suppressWarnings</a></code> is called.  Also passed to 
<code><a href="#topic+datatyper">datatyper</a></code></p>
</td></tr>
<tr><td><code id="readNIfTI2_+3A_rm_extensions">rm_extensions</code></td>
<td>
<p>should niftiExtensions be converted to simple
nifti objects?</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>nifti</code> object
</p>

<hr>
<h2 id='remake_img'>Remake Image from Vector</h2><span id='topic+remake_img'></span>

<h3>Description</h3>

<p>Wrapper function to take a vector of values and result in a 
<code><a href="oro.nifti.html#topic+nifti">nifti</a></code> object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>remake_img(vec, img, mask = NULL, warn = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="remake_img_+3A_vec">vec</code></td>
<td>
<p>vector of values to be in resulting image</p>
</td></tr>
<tr><td><code id="remake_img_+3A_img">img</code></td>
<td>
<p>object of class <code><a href="oro.nifti.html#topic+nifti">nifti</a></code> to put vector into</p>
</td></tr>
<tr><td><code id="remake_img_+3A_mask">mask</code></td>
<td>
<p>binary array/ <code><a href="oro.nifti.html#topic+nifti">nifti</a></code> object to denote where
vector values are to be.</p>
</td></tr>
<tr><td><code id="remake_img_+3A_warn">warn</code></td>
<td>
<p>Should a warning be issued if defaulting to FLOAT32?</p>
</td></tr>
<tr><td><code id="remake_img_+3A_...">...</code></td>
<td>
<p>additional arguments passed to <code><a href="#topic+datatyper">datatyper</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Object of class <code><a href="oro.nifti.html#topic+nifti">nifti</a></code>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+niftiarr">niftiarr</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(5)
dims = rep(10, 3)
arr = array(rnorm(prod(dims)), dim = dims)
arr[,,10] = 0
nim = oro.nifti::nifti(arr)
remake_img(c(nim), nim)
mask = nim &gt; 5
vals = nim[mask]
vals = sqrt(vals)
remake_img(vals, nim, mask = mask)

</code></pre>

<hr>
<h2 id='remap_filename'>Build Filename (usually for images)</h2><span id='topic+remap_filename'></span>

<h3>Description</h3>

<p>This is a simple function that helps with the case where you want to 
construct a filename (usually for an image) with the same base of the
filename, the same directory (default), but things added to the front or end
of that base filename, with the same extension.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>remap_filename(x, sub_dir = NULL, prefix = "", suffix = "")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="remap_filename_+3A_x">x</code></td>
<td>
<p>input filename/character vector</p>
</td></tr>
<tr><td><code id="remap_filename_+3A_sub_dir">sub_dir</code></td>
<td>
<p>sub-directory for the new filename.  If <code>NULL</code>, then 
the directory is the the same directory as <code>x</code></p>
</td></tr>
<tr><td><code id="remap_filename_+3A_prefix">prefix</code></td>
<td>
<p>string to put in front of base of filename</p>
</td></tr>
<tr><td><code id="remap_filename_+3A_suffix">suffix</code></td>
<td>
<p>string to put at the end of base of filename</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Character vector
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fname = file.path("/path/to/file", "original.nii.gz")
remap_filename(fname, prefix = "preproc_", "_with_gz")
fname = "original.nii"
remap_filename(fname, prefix = "note_", "_has_directory")
remap_filename(c(fname, "other.nii.gz"), prefix = "note_", "_has_directory")
</code></pre>

<hr>
<h2 id='replace_dropped_dimensions'>Remake Dropped Dimensions</h2><span id='topic+replace_dropped_dimensions'></span>

<h3>Description</h3>

<p>This function is the reverse of <code>dropEmptyImageDimensions</code>.
If <code>dropEmptyImageDimensions</code> was run, and the output is a list, 
usually if <code>keep_ind = TRUE</code>, this function reverses that.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>replace_dropped_dimensions(img, inds, orig.dim)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="replace_dropped_dimensions_+3A_img">img</code></td>
<td>
<p>Object of class <code>nifti</code> where image dimensions were dropped.</p>
</td></tr>
<tr><td><code id="replace_dropped_dimensions_+3A_inds">inds</code></td>
<td>
<p>List of length 3 of indices from 
<code><a href="#topic+dropEmptyImageDimensions">dropEmptyImageDimensions</a></code> or <code><a href="#topic+getEmptyImageDimensions">getEmptyImageDimensions</a></code></p>
</td></tr>
<tr><td><code id="replace_dropped_dimensions_+3A_orig.dim">orig.dim</code></td>
<td>
<p>Original dimension of pre-dropped image. Output image will
have dimensions same as this value</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Object of class <code><a href="oro.nifti.html#topic+nifti">nifti</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# nim is an object of class nifti
dd = dropEmptyImageDimensions(nim, keep_ind = TRUE)
remake = replace_dropped_dimensions(img = dd$outimg, 
inds = dd$inds,
orig.dim = dd$orig.dim)
all.equal(nim, remake)

## End(Not run)
</code></pre>

<hr>
<h2 id='replace_outside_surface'>Replace Values Outside Surface of image</h2><span id='topic+replace_outside_surface'></span>

<h3>Description</h3>

<p>Determines values outside the surface of an image and gives a 
mask back with those values set to a replacement.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>replace_outside_surface(
  img,
  value = 0,
  threshold = 0,
  replace_value = NA,
  reorient = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="replace_outside_surface_+3A_img">img</code></td>
<td>
<p>nifti object or array</p>
</td></tr>
<tr><td><code id="replace_outside_surface_+3A_value">value</code></td>
<td>
<p>Value to check against.  If zero, then 
<code>replace_outside_surface</code> will include any dimension that has 
fewer than <code>threshold</code> zeroes. May be a vector of values, matched with 
<code><a href="base.html#topic+match">match</a></code></p>
</td></tr>
<tr><td><code id="replace_outside_surface_+3A_threshold">threshold</code></td>
<td>
<p>Include dimension if fewer than <code>threshold</code> voxels
are in the slice</p>
</td></tr>
<tr><td><code id="replace_outside_surface_+3A_replace_value">replace_value</code></td>
<td>
<p>Value to replace those outside the surface.</p>
</td></tr>
<tr><td><code id="replace_outside_surface_+3A_reorient">reorient</code></td>
<td>
<p>Should image be reoriented if a filename?
Passed to <code><a href="#topic+check_nifti">check_nifti</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Creates an array of binary values.  If <code>img</code> is a <code>nifti</code>
object, then a <code>nifti</code> is returned
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(5)
dims = rep(10, 3)
arr = array(0, dim = dims)

arr[ 3:5, 4:6, c(2, 6:8, 5)] = 1
nim = oro.nifti::nifti(arr)
out = replace_outside_surface(nim, replace_value = 0)
out_arr = replace_outside_surface(arr, replace_value = 0)
testthat::expect_equal(out_arr, array(out, dim = dim(out)))
</code></pre>

<hr>
<h2 id='replaceEmptyImageDimensions-methods'>Replace Subsetting from Empty Image Dimensions</h2><span id='topic+replaceEmptyImageDimensions-methods'></span><span id='topic+replaceEmptyImageDimensions'></span><span id='topic+replaceEmptyImageDimensions+2Cnifti-method'></span><span id='topic+replaceEmptyImageDimensions+2Ccharacter-method'></span><span id='topic+replaceEmptyImageDimensions+2Cfactor-method'></span><span id='topic+replaceEmptyImageDimensions+2Clist-method'></span><span id='topic+replaceEmptyImageDimensions+2Carray-method'></span><span id='topic+replaceEmptyImageDimensions+2Canlz-method'></span><span id='topic+replaceEmptyImageDimensions+2CANY-method'></span><span id='topic+replace_empty_dim'></span>

<h3>Description</h3>

<p>Simple wrapper for subsetting an image with indices, 
dropping empty dimensions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>replaceEmptyImageDimensions(
  img,
  inds,
  target_dim,
  value = 0,
  reorient = FALSE,
  ...
)

## S4 method for signature 'nifti'
replaceEmptyImageDimensions(
  img,
  inds,
  target_dim,
  value = 0,
  reorient = FALSE,
  ...
)

## S4 method for signature 'character'
replaceEmptyImageDimensions(
  img,
  inds,
  target_dim,
  value = 0,
  reorient = FALSE,
  ...
)

## S4 method for signature 'factor'
replaceEmptyImageDimensions(
  img,
  inds,
  target_dim,
  value = 0,
  reorient = FALSE,
  ...
)

## S4 method for signature 'list'
replaceEmptyImageDimensions(
  img,
  inds,
  target_dim,
  value = 0,
  reorient = FALSE,
  ...
)

## S4 method for signature 'array'
replaceEmptyImageDimensions(
  img,
  inds,
  target_dim,
  value = 0,
  reorient = FALSE,
  ...
)

## S4 method for signature 'anlz'
replaceEmptyImageDimensions(
  img,
  inds,
  target_dim,
  value = 0,
  reorient = FALSE,
  ...
)

## S4 method for signature 'ANY'
replaceEmptyImageDimensions(
  img,
  inds,
  target_dim,
  value = 0,
  reorient = FALSE,
  ...
)

replace_empty_dim(img, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="replaceEmptyImageDimensions-methods_+3A_img">img</code></td>
<td>
<p>image, nifti object, or array</p>
</td></tr>
<tr><td><code id="replaceEmptyImageDimensions-methods_+3A_inds">inds</code></td>
<td>
<p>indices of subset from <code><a href="#topic+getEmptyImageDimensions">getEmptyImageDimensions</a></code> or
<code><a href="#topic+dropEmptyImageDimensions">dropEmptyImageDimensions</a></code>.</p>
</td></tr>
<tr><td><code id="replaceEmptyImageDimensions-methods_+3A_target_dim">target_dim</code></td>
<td>
<p>Original dimension from which the data was subset,
the final dimension of the output</p>
</td></tr>
<tr><td><code id="replaceEmptyImageDimensions-methods_+3A_value">value</code></td>
<td>
<p>value to replace in the image where outside the indices</p>
</td></tr>
<tr><td><code id="replaceEmptyImageDimensions-methods_+3A_reorient">reorient</code></td>
<td>
<p>Should image be reoriented if a filename?</p>
</td></tr>
<tr><td><code id="replaceEmptyImageDimensions-methods_+3A_...">...</code></td>
<td>
<p>not used</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Object of class <code>nifti</code> or <code>array</code> if <code>nifti</code>
is not supplied
</p>


<h3>Note</h3>

<p><code>replace_empty_dim</code> is a shorthand for 
<code>replaceEmptyImageDimensions</code> with all the same arguments.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+getEmptyImageDimensions">getEmptyImageDimensions</a></code>, 
<code><a href="#topic+dropEmptyImageDimensions">dropEmptyImageDimensions</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dims = rep(10, 3)
arr = array(rnorm(prod(dims)), dim = dims)
arr[,,10] = 0
nim = oro.nifti::nifti(arr)
rnifti = RNifti::asNifti(nim)
timg = tempimg(nim)
limg = list(factor(timg, timg))
inds = getEmptyImageDimensions(nim)
inds_arr = getEmptyImageDimensions(arr)
testthat::expect_equal(inds, inds_arr)

out = applyEmptyImageDimensions(nim, inds = inds)
result = replaceEmptyImageDimensions(out, inds = inds,
target_dim = dim(nim))
testthat::expect_equal(array(result, dim = dim(result)), 
array(nim, dim = dim(nim)))
replace_empty_dim(out, inds = inds,
target_dim = dim(nim))

target_dim = dim(nim)

arr = array(out, dim = dim(out))
nim = oro.nifti::nifti(arr)
rnifti = RNifti::asNifti(nim)
timg = tempimg(nim)
limg = list(factor(timg), factor(timg))
func = function(...) replaceEmptyImageDimensions(..., 
target_dim = target_dim, inds = inds)
func(arr)
func(nim)
func(rnifti)
func(timg)
func(limg)
</code></pre>

<hr>
<h2 id='rescale_img'>Image Rescaler</h2><span id='topic+rescale_img'></span>

<h3>Description</h3>

<p>Rescales an image to be in certain value range.  This was created
as sometimes DICOM scale and slope parameters may be inconsistent across sites
and the data need to be value restricted
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rescale_img(
  filename,
  pngname = NULL,
  write.nii = FALSE,
  outfile = NULL,
  min.val = -1024,
  max.val = 3071,
  ROIformat = FALSE,
  drop_dim = TRUE,
  writer = "dcm2nii",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rescale_img_+3A_filename">filename</code></td>
<td>
<p>filename of image to be read into R or nifti object</p>
</td></tr>
<tr><td><code id="rescale_img_+3A_pngname">pngname</code></td>
<td>
<p>filename of png of histogram of values of image to be made. For no
png - set to NULL (default)</p>
</td></tr>
<tr><td><code id="rescale_img_+3A_write.nii">write.nii</code></td>
<td>
<p>logical - should the image be written.</p>
</td></tr>
<tr><td><code id="rescale_img_+3A_outfile">outfile</code></td>
<td>
<p>if <code>write.nii = TRUE</code>, filename of output file</p>
</td></tr>
<tr><td><code id="rescale_img_+3A_min.val">min.val</code></td>
<td>
<p>minimum value of image (default -1024 (for CT)).  If no thresholding
set to -Inf</p>
</td></tr>
<tr><td><code id="rescale_img_+3A_max.val">max.val</code></td>
<td>
<p>maximum value of image (default 3071 (for CT)).  If no thresholding
set to Inf</p>
</td></tr>
<tr><td><code id="rescale_img_+3A_roiformat">ROIformat</code></td>
<td>
<p>if TRUE, any values $&lt; 0$ will be set to 0</p>
</td></tr>
<tr><td><code id="rescale_img_+3A_drop_dim">drop_dim</code></td>
<td>
<p>Should <code><a href="oro.nifti.html#topic+drop_img_dim">drop_img_dim</a></code> be applied?</p>
</td></tr>
<tr><td><code id="rescale_img_+3A_writer">writer</code></td>
<td>
<p>character value to add to description slot of NIfTI header</p>
</td></tr>
<tr><td><code id="rescale_img_+3A_...">...</code></td>
<td>
<p>extra methods to be passed to <code><a href="#topic+writenii">writenii</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Object of class nifti
</p>


<h3>Examples</h3>

<pre><code class='language-R'>img = nifti(array(rnorm(10^3, sd = 1000), dim = rep(10, 3)))
outfile = tempfile(fileext = ".nii.gz")
pngname = tempfile(fileext = ".png")
rescale_img(img, write.nii = TRUE, outfile = outfile,
pngname = pngname)
</code></pre>

<hr>
<h2 id='reverse_orient_rpi'>Reverse Reorientation an Image to RPI orientation</h2><span id='topic+reverse_orient_rpi'></span><span id='topic+reverse_orient_rpi_file'></span>

<h3>Description</h3>

<p>Reverse Reorientation an Image to RPI orientation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>reverse_orient_rpi(
  file,
  convention = c("NEUROLOGICAL", "RADIOLOGICAL"),
  orientation,
  verbose = TRUE
)

reverse_orient_rpi_file(
  file,
  convention = c("NEUROLOGICAL", "RADIOLOGICAL"),
  orientation,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="reverse_orient_rpi_+3A_file">file</code></td>
<td>
<p>Object of class <code>nifti</code> or character path</p>
</td></tr>
<tr><td><code id="reverse_orient_rpi_+3A_convention">convention</code></td>
<td>
<p>Convention of original image (usually from <code><a href="#topic+orient_rpi">orient_rpi</a></code>)</p>
</td></tr>
<tr><td><code id="reverse_orient_rpi_+3A_orientation">orientation</code></td>
<td>
<p>Vector of length 3 from original image 
(usually from <code><a href="#topic+orient_rpi">orient_rpi</a></code>)</p>
</td></tr>
<tr><td><code id="reverse_orient_rpi_+3A_verbose">verbose</code></td>
<td>
<p>print diagnostic messages</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Object of class <code>nifti</code>
</p>


<h3>Note</h3>

<p>'reverse_orient_rpi' and 'reverse_orient_rpi_file' uses 'RNifti' to ensure the 
reading orientation
</p>

<hr>
<h2 id='robust_window'>Window image based on quantiles of Image</h2><span id='topic+robust_window'></span>

<h3>Description</h3>

<p>Takes an image, finds the quantiles given by 
<code>probs</code>, then sets values outside these values to other 
values, as determined by <code>replace</code> argument passed to
to <code><a href="#topic+window_img">window_img</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>robust_window(img, non_zero = FALSE, probs = c(0, 0.999), ..., mask = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="robust_window_+3A_img">img</code></td>
<td>
<p>object of class nifti</p>
</td></tr>
<tr><td><code id="robust_window_+3A_non_zero">non_zero</code></td>
<td>
<p>Should zeroes be excluded from the calculation
of quantiles?</p>
</td></tr>
<tr><td><code id="robust_window_+3A_probs">probs</code></td>
<td>
<p>quantiles to constrain the image these define the window sent to <code><a href="#topic+window_img">window_img</a></code></p>
</td></tr>
<tr><td><code id="robust_window_+3A_...">...</code></td>
<td>
<p>additional arguments sent to <code><a href="#topic+window_img">window_img</a></code></p>
</td></tr>
<tr><td><code id="robust_window_+3A_mask">mask</code></td>
<td>
<p>binary image to use to to calculate quantiles</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Object of class nifti with values outside quantiles replaced
by values depending on replace argument passed to <code><a href="#topic+window_img">window_img</a></code>
</p>

<hr>
<h2 id='same_dims'>Check if Objects have Same Dimensions</h2><span id='topic+same_dims'></span>

<h3>Description</h3>

<p>Wrapper to check if multiple objects all have the 
same dimensions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>same_dims(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="same_dims_+3A_...">...</code></td>
<td>
<p>Arguments (matrices or arrays) where the dimension will be 
checked against the first object's dimension</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Logical indicating if all have the same dimensions or not
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mat1 = matrix(1:9, ncol = 3)
mat2 = matrix(rnorm(9), ncol = 3)
mat3 = matrix(rnorm(16), ncol = 4)
mat4 = matrix(rnorm(9), ncol = 3)
same_dims(mat1, mat2)
same_dims(mat1, mat3)
same_dims(mat1, mat2, mat4)
</code></pre>

<hr>
<h2 id='separate_img-methods'>Separate Labeled Image into Multiple Binary Images</h2><span id='topic+separate_img-methods'></span><span id='topic+separate_img'></span><span id='topic+separate_img+2Cnifti-method'></span><span id='topic+separate_img+2Carray-method'></span><span id='topic+separate_img+2CANY-method'></span><span id='topic+separate_img+2Cfactor-method'></span><span id='topic+separate_img+2Ccharacter-method'></span><span id='topic+separate_img+2Clist-method'></span>

<h3>Description</h3>

<p>Takes in an image, gets the unique values, then 
creates a list of binary images for each one of those values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>separate_img(img, levels = NULL, drop_zero = TRUE)

## S4 method for signature 'nifti'
separate_img(img, levels = NULL, drop_zero = TRUE)

## S4 method for signature 'array'
separate_img(img, levels = NULL, drop_zero = TRUE)

## S4 method for signature 'ANY'
separate_img(img, levels = NULL, drop_zero = TRUE)

## S4 method for signature 'factor'
separate_img(img, levels = NULL, drop_zero = TRUE)

## S4 method for signature 'character'
separate_img(img, levels = NULL, drop_zero = TRUE)

## S4 method for signature 'list'
separate_img(img, levels = NULL, drop_zero = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="separate_img-methods_+3A_img">img</code></td>
<td>
<p>character path of image or 
an object of class <code>nifti</code>, or list of images</p>
</td></tr>
<tr><td><code id="separate_img-methods_+3A_levels">levels</code></td>
<td>
<p>if <code>levels</code> is given, then the separation is only
done for those levels and not unique values of the image.</p>
</td></tr>
<tr><td><code id="separate_img-methods_+3A_drop_zero">drop_zero</code></td>
<td>
<p>Should zeroes be dropped from the labels?  Zero 
usually denotes background or non-interesting voxels</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>nifti</code> object (or list of them) or class of 
object passed in if not specified
</p>


<h3>Note</h3>

<p>Exact equalling is using <code>==</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(5)
dims = rep(10, 3)
arr = array(rpois(prod(dims), lambda = 2), dim = dims)
nim = oro.nifti::nifti(arr)
simg = separate_img(nim)
simg_arr = separate_img(arr)
slist = lapply(simg, function(x) array(x, dim(x)))
testthat::expect_equal(slist, simg_arr)

rnifti = RNifti::asNifti(nim)
timg = tempimg(nim)
limg = list(factor(timg), factor(timg))
func = separate_img
func(arr)
func(nim)
func(rnifti)
func(timg)
func(limg)
</code></pre>

<hr>
<h2 id='slice_colour_df'>Slice a Image Color Data.frame</h2><span id='topic+slice_colour_df'></span>

<h3>Description</h3>

<p>Slices a image color <code>data.frame</code> along the 3 planes (axial,
coronal, sagittal) and returns it in a ggplot-ready format for faceting.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>slice_colour_df(img_df, xyz = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="slice_colour_df_+3A_img_df">img_df</code></td>
<td>
<p>an image <code>data.frame</code>, usually from 
<code><a href="#topic+img_colour_df">img_colour_df</a></code>.  Must have the columns: <code>dim1</code>,
<code>dim2</code>, <code>dim3</code>, <code>colour</code>, and <code>value</code>.</p>
</td></tr>
<tr><td><code id="slice_colour_df_+3A_xyz">xyz</code></td>
<td>
<p>coordinates to slice the <code>data.frame</code> in x, y, and z - domains</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>data.frame</code> with x and y coordinates, colour, and intensity
values, along with the associated planes that were sliced.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>img = nifti(array(rnorm(10^3), dim = rep(10, 3)))
df = img_colour_df(img)
sliced = slice_colour_df(df, c(5, 5, 4))
</code></pre>

<hr>
<h2 id='subset_dti-methods'>Subset DTI data based on b-values
#'</h2><span id='topic+subset_dti-methods'></span><span id='topic+subset_dti'></span><span id='topic+subset_dti+2Cnifti-method'></span><span id='topic+subset_dti+2CANY-method'></span><span id='topic+subset_dti+2Ccharacter-method'></span><span id='topic+subset_dti+2Clist-method'></span>

<h3>Description</h3>

<p>Subset DTI data based on b-values
#'
</p>


<h3>Usage</h3>

<pre><code class='language-R'>subset_dti(
  img,
  bvals,
  bvecs,
  b_step = 1,
  maximum = Inf,
  shells = NULL,
  verbose = TRUE,
  ...
)

## S4 method for signature 'nifti'
subset_dti(
  img,
  bvals,
  bvecs,
  b_step = 1,
  maximum = Inf,
  shells = NULL,
  verbose = TRUE,
  ...
)

## S4 method for signature 'ANY'
subset_dti(
  img,
  bvals,
  bvecs,
  b_step = 1,
  maximum = Inf,
  shells = NULL,
  verbose = TRUE,
  ...
)

## S4 method for signature 'character'
subset_dti(
  img,
  bvals,
  bvecs,
  b_step = 1,
  maximum = Inf,
  shells = NULL,
  verbose = TRUE,
  ...
)

## S4 method for signature 'list'
subset_dti(
  img,
  bvals,
  bvecs,
  b_step = 1,
  maximum = Inf,
  shells = NULL,
  verbose = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="subset_dti-methods_+3A_img">img</code></td>
<td>
<p>character or <code>nifti</code> object</p>
</td></tr>
<tr><td><code id="subset_dti-methods_+3A_bvals">bvals</code></td>
<td>
<p>filename of b-values (assuming 1 row)</p>
</td></tr>
<tr><td><code id="subset_dti-methods_+3A_bvecs">bvecs</code></td>
<td>
<p>filename of b-vectors (assuming 3 rows)</p>
</td></tr>
<tr><td><code id="subset_dti-methods_+3A_b_step">b_step</code></td>
<td>
<p>step of b-values to round to</p>
</td></tr>
<tr><td><code id="subset_dti-methods_+3A_maximum">maximum</code></td>
<td>
<p>maximum b-value threshold</p>
</td></tr>
<tr><td><code id="subset_dti-methods_+3A_shells">shells</code></td>
<td>
<p>Shells to keep (after rounding)</p>
</td></tr>
<tr><td><code id="subset_dti-methods_+3A_verbose">verbose</code></td>
<td>
<p>print diagnostic messages</p>
</td></tr>
<tr><td><code id="subset_dti-methods_+3A_...">...</code></td>
<td>
<p>options passed to <code><a href="#topic+checkimg">checkimg</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of filenames of 
image, b-values, and b-vectors that were subsetted.
</p>


<h3>Author(s)</h3>

<p>John Muschelli <a href="mailto:muschellij2@gmail.com">muschellij2@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
img = "~/Downloads/data.nii.gz"
bvals = "~/Downloads/bvals"
bvecs = "~/Downloads/bvals"
verbose = TRUE
b_step = 50
maximum = 1500
shells = NULL
sub = subset_dti(img = img, bvals = bvals, bvecs = bvecs, 
maximum = 1500,
b_step = 50)


## End(Not run)
</code></pre>

<hr>
<h2 id='tempimg'>Create temporary nii.gz file</h2><span id='topic+tempimg'></span>

<h3>Description</h3>

<p>Takes in a object of class nifti, writes it 
to a temp file, appends
.nii.gz as <code><a href="#topic+writenii">writenii</a></code> adds it.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tempimg(
  nim,
  gzipped = TRUE,
  checknan = TRUE,
  check_type = FALSE,
  warn = FALSE,
  drop_dim = TRUE,
  dtype = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tempimg_+3A_nim">nim</code></td>
<td>
<p>object of class nifti</p>
</td></tr>
<tr><td><code id="tempimg_+3A_gzipped">gzipped</code></td>
<td>
<p>Should file be gzipped? Passed to 
<code><a href="#topic+writenii">writenii</a></code></p>
</td></tr>
<tr><td><code id="tempimg_+3A_checknan">checknan</code></td>
<td>
<p>Check for NAs or NaNs</p>
</td></tr>
<tr><td><code id="tempimg_+3A_check_type">check_type</code></td>
<td>
<p>Check the datatype for an image.  Will run <code><a href="#topic+datatyper">datatyper</a></code>.</p>
</td></tr>
<tr><td><code id="tempimg_+3A_warn">warn</code></td>
<td>
<p>Should warnings be displayed if <code><a href="#topic+writenii">writenii</a></code> has
any?  Passed to <code><a href="#topic+writenii">writenii</a></code>.</p>
</td></tr>
<tr><td><code id="tempimg_+3A_drop_dim">drop_dim</code></td>
<td>
<p>Should <code><a href="oro.nifti.html#topic+drop_img_dim">drop_img_dim</a></code> be applied?</p>
</td></tr>
<tr><td><code id="tempimg_+3A_dtype">dtype</code></td>
<td>
<p>Should <code><a href="#topic+datatyper">datatyper</a></code> be run before writing?
Should override 'check_type'</p>
</td></tr>
<tr><td><code id="tempimg_+3A_...">...</code></td>
<td>
<p>Passed to <code><a href="#topic+writenii">writenii</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>filename of output nii.gz
</p>

<hr>
<h2 id='window_img'>nifti image windower</h2><span id='topic+window_img'></span>

<h3>Description</h3>

<p>Windows an image to min and max values and also changes
cal_max and cal_min parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>window_img(
  x,
  window = c(0, 100),
  replace = c("window", "missing", "zero"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="window_img_+3A_x">x</code></td>
<td>
<p>is either a character name for the image or an object of class nifti</p>
</td></tr>
<tr><td><code id="window_img_+3A_window">window</code></td>
<td>
<p>numeric of length 2 that gives min and max for window</p>
</td></tr>
<tr><td><code id="window_img_+3A_replace">replace</code></td>
<td>
<p>either &quot;window&quot; if the any values outside of c(min, max) are
set to the min or max or &quot;missing&quot; for these to be set to NA</p>
</td></tr>
<tr><td><code id="window_img_+3A_...">...</code></td>
<td>
<p>not used</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Object of class nifti
</p>


<h3>See Also</h3>

<p><a href="#topic+readnii">readnii</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  set.seed(5)
  dims = rep(10, 3)
  arr = array(rnorm(prod(dims)), dim = dims)
  nim = oro.nifti::nifti(arr)
  window_img(nim, window = c(1, 5))
  window_img(nim, window = c(1, 5), replace = "missing")
  tfile = tempimg(nim)
  window_img(tfile)
  window_img(as.factor(tfile))
  arr = window_img(img_data(nim))
  rnim = RNifti::readNifti(tfile)
  window_img(rnim, window = c(1, 5))
  range(window_img(rnim, window = c(1, 5)))
  window_img(rnim, window = c(1, 5), replace = "missing")
  range(window_img(rnim, window = c(1, 5), replace = "missing"))
   

</code></pre>

<hr>
<h2 id='write_nifti'>General NIfTI Writer</h2><span id='topic+write_nifti'></span>

<h3>Description</h3>

<p>Writes out NIfTI files for multiple formats.  Currently,
for <code>nifti</code> objects and <code>niftiImage</code> objects from <code>RNifti</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write_nifti(nim, filename, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="write_nifti_+3A_nim">nim</code></td>
<td>
<p>Container for NIfTI Image</p>
</td></tr>
<tr><td><code id="write_nifti_+3A_filename">filename</code></td>
<td>
<p>Filename of image to be written out</p>
</td></tr>
<tr><td><code id="write_nifti_+3A_...">...</code></td>
<td>
<p>additional arguments, to be passed to <code><a href="RNifti.html#topic+writeNifti">writeNifti</a></code> or
<code><a href="#topic+writenii">writenii</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Output from NIfTI writer
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(5)
dims = rep(10, 4)
arr = array(rpois(prod(dims), lambda = 2), dim = dims)
nim = oro.nifti::nifti(arr)
tfile = tempfile(fileext = ".nii.gz")
write_nifti(nim, tfile)
rimg = RNifti::readNifti(tfile)
write_nifti(rimg, tfile)
</code></pre>

<hr>
<h2 id='writeNIfTI2'>writeNIfTI with default non-reorientation</h2><span id='topic+writeNIfTI2'></span><span id='topic+writenii'></span>

<h3>Description</h3>

<p>This function calls the <code><a href="oro.nifti.html#topic+writeNIfTI">writeNIfTI</a></code> function from the 
<code>oro.nifti</code> package, but makes sure to remove <code>.nii</code> extension and
warnings can be suppressed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>writeNIfTI2(nim, filename, dtype = FALSE, compression = 9, ...)

writenii(
  nim,
  filename,
  dtype = TRUE,
  drop_dim = TRUE,
  warn = FALSE,
  compression = 9,
  rm_extensions = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="writeNIfTI2_+3A_nim">nim</code></td>
<td>
<p>object of class <code>nifti</code>, passed to <code><a href="oro.nifti.html#topic+writeNIfTI">writeNIfTI</a></code></p>
</td></tr>
<tr><td><code id="writeNIfTI2_+3A_filename">filename</code></td>
<td>
<p>path to save the NIfTI file.  Suffix will be removed</p>
</td></tr>
<tr><td><code id="writeNIfTI2_+3A_dtype">dtype</code></td>
<td>
<p>Should <code><a href="#topic+datatyper">datatyper</a></code> be run before writing?</p>
</td></tr>
<tr><td><code id="writeNIfTI2_+3A_compression">compression</code></td>
<td>
<p>compression level for gzipped files.</p>
</td></tr>
<tr><td><code id="writeNIfTI2_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code><a href="oro.nifti.html#topic+writeNIfTI">writeNIfTI</a></code></p>
</td></tr>
<tr><td><code id="writeNIfTI2_+3A_drop_dim">drop_dim</code></td>
<td>
<p>Should <code><a href="oro.nifti.html#topic+drop_img_dim">drop_img_dim</a></code> be run before writing?</p>
</td></tr>
<tr><td><code id="writeNIfTI2_+3A_warn">warn</code></td>
<td>
<p>Should warnings from <code><a href="oro.nifti.html#topic+writeNIfTI">writeNIfTI</a></code> be 
printed?  If not, <code><a href="base.html#topic+suppressWarnings">suppressWarnings</a></code> is called</p>
</td></tr>
<tr><td><code id="writeNIfTI2_+3A_rm_extensions">rm_extensions</code></td>
<td>
<p>should niftiExtensions be converted to simple
nifti objects before writing?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing
</p>


<h3>Note</h3>

<p>While <code>writeNIfTI2</code> does not run <code><a href="#topic+datatyper">datatyper</a></code> as default, 
<code>writenii</code> does.  Additional functionality will be added to <code>writenii</code> likely
but will not to <code>writeNIfTI2</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(5)
dims = rep(10, 3)
arr = array(rnorm(prod(dims)), dim = dims)
nim = oro.nifti::nifti(arr)
rnifti = RNifti::asNifti(nim)
tfile = tempfile(fileext = ".nii.gz")
timg = writenii(nim, tfile, rm_extensions = TRUE, warn = TRUE)
timg = writeNIfTI2(nim, tfile, dtype = TRUE)
</code></pre>

<hr>
<h2 id='xyz'>Image Center of Gravity Wrapper</h2><span id='topic+xyz'></span>

<h3>Description</h3>

<p>Find Center of Gravity of Image, after thresholding and
take ceiling (wrapper for <code><a href="#topic+cog">cog</a></code>)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xyz(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="xyz_+3A_...">...</code></td>
<td>
<p>Arguments passed to <code><a href="#topic+cog">cog</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of length 3
</p>


<h3>Note</h3>

<p>Just a convenience wrapper for <code>cog(ceil=TRUE)</code>
</p>

<hr>
<h2 id='zero_pad'>Zero pads an image</h2><span id='topic+zero_pad'></span>

<h3>Description</h3>

<p>This function zero pads an image by a certain number of 
dimensions, usually for convolution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>zero_pad(img, kdim, invert = FALSE, pad_value = 0L, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="zero_pad_+3A_img">img</code></td>
<td>
<p>Array or class nifti</p>
</td></tr>
<tr><td><code id="zero_pad_+3A_kdim">kdim</code></td>
<td>
<p>Dimensions of kernel</p>
</td></tr>
<tr><td><code id="zero_pad_+3A_invert">invert</code></td>
<td>
<p>(logical) If <code>FALSE</code>, does zero padding.  If <code>TRUE</code>, 
reverses the process.</p>
</td></tr>
<tr><td><code id="zero_pad_+3A_pad_value">pad_value</code></td>
<td>
<p>Value to pad the image with.
May use other values, such as -1024 for CT data</p>
</td></tr>
<tr><td><code id="zero_pad_+3A_...">...</code></td>
<td>
<p>Options to <code><a href="#topic+copyNIfTIHeader">copyNIfTIHeader</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Object of class nifti
</p>


<h3>Examples</h3>

<pre><code class='language-R'>kdim = c(3,3,5)
img = array(rnorm(30*30*36), dim = c(30, 30, 36))
pad = zero_pad(img, kdim)
back = zero_pad(pad, kdim, invert=TRUE)
all.equal(back, img)
</code></pre>

<hr>
<h2 id='zlimmer'>Find Image z-limits</h2><span id='topic+zlimmer'></span>

<h3>Description</h3>

<p>Helper function for plotting - returns zlim for <code><a href="graphics.html#topic+image">image</a></code> 
plot function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>zlimmer(x, zlim = NULL, computed_range = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="zlimmer_+3A_x">x</code></td>
<td>
<p>Object of class <code>nifti</code></p>
</td></tr>
<tr><td><code id="zlimmer_+3A_zlim">zlim</code></td>
<td>
<p>A user-specified <code>zlim</code>.  If <code>NULL</code>, will calculate how 
<code><a href="#topic+ortho2">ortho2</a></code> would calculate <code>zlim</code></p>
</td></tr>
<tr><td><code id="zlimmer_+3A_computed_range">computed_range</code></td>
<td>
<p>If the range of the data was already computed,
this can be passed in and will be used if relevant.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If <code>zlim = NULL</code>, then vector of length 2, otherwise returns <code>zlim</code>
</p>

<hr>
<h2 id='zscore_img'>Get Z-score over a margin of an img</h2><span id='topic+zscore_img'></span>

<h3>Description</h3>

<p>Standardizes an image either by the axial, sagittal, or
coronal slice or whole image
</p>


<h3>Usage</h3>

<pre><code class='language-R'>zscore_img(
  img,
  mask = NULL,
  margin = NULL,
  centrality = c("mean", "median", "trimmed_mean"),
  variability = c("sd", "iqrdiff", "mad", "maddiff", "iqr", "trimmed_sd"),
  trim = 0.2,
  remove.na = TRUE,
  remove.nan = TRUE,
  remove.inf = TRUE,
  remove.val = 0,
  remask = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="zscore_img_+3A_img">img</code></td>
<td>
<p>character path of image or 
an object of class nifti</p>
</td></tr>
<tr><td><code id="zscore_img_+3A_mask">mask</code></td>
<td>
<p>character path of mask or 
an object of class nifti</p>
</td></tr>
<tr><td><code id="zscore_img_+3A_margin">margin</code></td>
<td>
<p>Margin of image to z-score over (<code>NULL</code> - whole brain,
3-Axial, 2-Sagittal, 
1-Coronal)</p>
</td></tr>
<tr><td><code id="zscore_img_+3A_centrality">centrality</code></td>
<td>
<p>(character) Measure to center the data, 
either mean or median</p>
</td></tr>
<tr><td><code id="zscore_img_+3A_variability">variability</code></td>
<td>
<p>(character) Measure to scale the data</p>
</td></tr>
<tr><td><code id="zscore_img_+3A_trim">trim</code></td>
<td>
<p>if centrality is <code>trimmed_mean</code> or variability is 
<code>trimmed_sd</code>, then the amount of trimming</p>
</td></tr>
<tr><td><code id="zscore_img_+3A_remove.na">remove.na</code></td>
<td>
<p>(logical) change NAs to remove.val</p>
</td></tr>
<tr><td><code id="zscore_img_+3A_remove.nan">remove.nan</code></td>
<td>
<p>(logical) change NaN to remove.val</p>
</td></tr>
<tr><td><code id="zscore_img_+3A_remove.inf">remove.inf</code></td>
<td>
<p>(logical) change Inf to remove.val</p>
</td></tr>
<tr><td><code id="zscore_img_+3A_remove.val">remove.val</code></td>
<td>
<p>(logical) value to put the NA/NaN/Inf</p>
</td></tr>
<tr><td><code id="zscore_img_+3A_remask">remask</code></td>
<td>
<p>(logical) Should the image be remasked after normalizing?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Array of object of class nifti
</p>


<h3>See Also</h3>

<p><a href="base.html#topic+aperm">aperm</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dim = c(100, 30, 5)
img = array(rnorm(prod(dim), mean=4, sd=4), 
dim=dim)

truth2 = img
for (i in 1:dim(img)[2]) {
truth2[,i,] = (truth2[,i,]- mean(truth2[,i,]))/sd(truth2[,i,])
}

truth1 = img
for (i in 1:dim(img)[1]) {
truth1[i,,] = (truth1[i,,]- mean(truth1[i,,]))/sd(truth1[i,,])
}

truth3 = img
for (i in 1:dim(img)[3]) {
truth3[,,i] = (truth3[,,i]- mean(truth3[,,i]))/sd(truth3[,,i])
}
try3 = zscore_img(img, margin=3)
stopifnot(all.equal(try3, truth3))
try2 = zscore_img(img, margin=2)
stopifnot(all.equal(try2, truth2))
try1 = zscore_img(img, margin=1)
stopifnot(all.equal(try1, truth1))
  
z = zscore_img(img, margin=NULL)
ztrim = zscore_img(img, margin=NULL, 
centrality = "trimmed_mean", variability = "trimmed_sd")

z = zscore_img(img, centrality = "median", variability = "iqr")
z = zscore_img(img, centrality = "median", variability = "iqrdiff")
z = zscore_img(img, centrality = "median", variability = "maddiff")


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
