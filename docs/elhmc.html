<!DOCTYPE html><html><head><title>Help for package elhmc</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {elhmc}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ELHMC'><p>Empirical Likelihood Hamiltonian Monte Carlo Sampling</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Sampling from a Empirical Likelihood Bayesian Posterior of
Parameters Using Hamiltonian Monte Carlo</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2017-07-03</td>
</tr>
<tr>
<td>Author:</td>
<td>Dang Trung Kien &lt;kien.dang@nus.edu.sg&gt;, Sanjay Chaudhuri &lt;stasc@nus.edu.sg&gt;, Neo Han Wei &lt;a0086731@u.nus.edu&gt;,</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Sanjay Chaudhuri &lt;stasc@nus.edu.sg&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>A tool to draw samples from a Empirical Likelihood Bayesian posterior
   of parameters using Hamiltonian Monte Carlo.</td>
</tr>
<tr>
<td>Imports:</td>
<td>emplik, plyr, stats, MASS, utils</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>5.0.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2017-07-03 15:20:35 UTC; kiendang</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2017-07-04 04:44:14 UTC</td>
</tr>
</table>
<hr>
<h2 id='ELHMC'>Empirical Likelihood Hamiltonian Monte Carlo Sampling</h2><span id='topic+ELHMC'></span>

<h3>Description</h3>

<p>This function draws samples from a Empirical Likelihood Bayesian posterior
distribution of parameters using Hamiltonian Monte Carlo.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ELHMC(initial, data, fun, dfun, prior, dprior, n.samples = 100,
  lf.steps = 10, epsilon = 0.05, p.variance = 1, tol = 10^-5,
  detailed = FALSE, FUN, DFUN)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ELHMC_+3A_initial">initial</code></td>
<td>
<p>a vector containing the initial values of the parameters</p>
</td></tr>
<tr><td><code id="ELHMC_+3A_data">data</code></td>
<td>
<p>a matrix containing the data</p>
</td></tr>
<tr><td><code id="ELHMC_+3A_fun">fun</code></td>
<td>
<p>the estimating function <code class="reqn">g</code>. It takes in a parameter vector
<code>params</code> as the first argument and a data point vector <code>x</code> as the
second parameter. This function returns a vector.</p>
</td></tr>
<tr><td><code id="ELHMC_+3A_dfun">dfun</code></td>
<td>
<p>a function that calculates the gradient of the estimating function
<code class="reqn">g</code>. It takes in a parameter vector <code>params</code> as the first argument
and a data point vector <code>x</code> as the second argument. This function
returns a matrix.</p>
</td></tr>
<tr><td><code id="ELHMC_+3A_prior">prior</code></td>
<td>
<p>a function with one argument <code>x</code> that returns the prior
densities of the parameters of interest</p>
</td></tr>
<tr><td><code id="ELHMC_+3A_dprior">dprior</code></td>
<td>
<p>a function with one argument <code>x</code> that returns
the gradients of the log densities of the parameters of interest</p>
</td></tr>
<tr><td><code id="ELHMC_+3A_n.samples">n.samples</code></td>
<td>
<p>number of samples to draw</p>
</td></tr>
<tr><td><code id="ELHMC_+3A_lf.steps">lf.steps</code></td>
<td>
<p>number of leap frog steps in each Hamiltonian Monte Carlo
update</p>
</td></tr>
<tr><td><code id="ELHMC_+3A_epsilon">epsilon</code></td>
<td>
<p>the leap frog step size(s). This has to be a single numeric
value or a vector of the same length as <code>initial</code>.</p>
</td></tr>
<tr><td><code id="ELHMC_+3A_p.variance">p.variance</code></td>
<td>
<p>the covariance matrix of a multivariate normal distribution
used to generate the initial values of momentum <code class="reqn">p</code> in
Hamiltonian Monte Carlo. This can also be a single numeric value or
a vector. See Details.</p>
</td></tr>
<tr><td><code id="ELHMC_+3A_tol">tol</code></td>
<td>
<p>EL tolerance</p>
</td></tr>
<tr><td><code id="ELHMC_+3A_detailed">detailed</code></td>
<td>
<p>If this is set to <code>TRUE</code>, the function will return a list
with extra information.</p>
</td></tr>
<tr><td><code id="ELHMC_+3A_fun">FUN</code></td>
<td>
<p>the same as <code>fun</code> but takes in a matrix <code>X</code> instead of
a vector <code>x</code> and returns a matrix so that <code>FUN(params, X)[i, ]</code> is
the same as <code>fun(params, X[i, ])</code>. Only one of <code>FUN</code> and
<code>fun</code> should be provided. If both are then <code>fun</code> is ignored.</p>
</td></tr>
<tr><td><code id="ELHMC_+3A_dfun">DFUN</code></td>
<td>
<p>the same as <code>dfun</code> but takes in a matrix <code>X</code> instead of
a vector <code>x</code> and returns an array so that <code>DFUN(params, X)[, , i]</code>
is the same as <code>dfun(params, X[i, ])</code>. Only one of <code>DFUN</code> and
<code>dfun</code> should be provided. If both are then <code>dfun</code> is ignored.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Suppose there are data <code class="reqn">x = (x_1, x_2, ..., x_n)</code> where <code class="reqn">x_i</code>
takes values in <code class="reqn">R^p</code> and follow probability distribution <code class="reqn">F</code>.
Also, <code class="reqn">F</code> comes from a family of distributions that depends on
a parameter <code class="reqn">\theta = (\theta_1, ..., \theta_d)</code> and there is
a smooth function
<code class="reqn">g(x_i, \theta) = (g_1(x_i, \theta), ...,g_q(x_i, \theta))^T</code> that
satisfies <code class="reqn">E_F[g(x_i, \theta)] = 0</code> for <code class="reqn">i = 1, ...,n</code>.
</p>
<p><code>ELHMC</code> draws samples from a Empirical Likelihood Bayesian
posterior distribution of the parameter <code class="reqn">\theta</code>, given the data <code class="reqn">x</code>
as <code>data</code>, the smoothing function <code class="reqn">g</code> as <code>fun</code>,
and the gradient of <code class="reqn">g</code> as <code>dfun</code> or <code class="reqn">G(X) =
 (g(x_1), g(x_2), ..., g(x_n))^T</code> as <code>FUN</code> and the gradient of <code class="reqn">G</code>
as <code>DFUN</code>.
</p>


<h3>Value</h3>

<p>The function returns a list with the following elements:
</p>
<table>
<tr><td><code>samples</code></td>
<td>
<p>A matrix containing the parameter samples</p>
</td></tr>
<tr><td><code>acceptance.rate</code></td>
<td>
<p>The acceptance rate</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>The matched call</p>
</td></tr>
</table>
<p>If <code>detailed = TRUE</code>, the list contains these extra elements:
</p>
<table>
<tr><td><code>proposed</code></td>
<td>
<p>A matrix containing the proposed values at
<code>n.samaples - 1</code> Hamiltonian Monte Carlo updates</p>
</td></tr>
<tr><td><code>acceptance</code></td>
<td>
<p>A vector of <code>TRUE</code>/<code>FALSE</code> values
indicates whether each proposed value is accepted</p>
</td></tr>
<tr><td><code>trajectory</code></td>
<td>
<p>A list with 2 elements <code>trajectory.q</code> and
<code>trajectory.p</code>. These are lists of matrices contraining position and
momentum values along trajectory in each Hamiltonian Monte Carlo update.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Chaudhuri, S., Mondal, D. and Yin, T. (2015)
Hamiltonian Monte Carlo sampling in Bayesian empirical likelihood
computation.
<em>Journal of the Royal Statistical Society: Series B</em>.
</p>
<p>Neal, R. (2011) MCMC for using Hamiltonian dynamics.
<em>Handbook of Markov Chain Monte Carlo</em>
(eds S. Brooks, A.Gelman, G. L.Jones and X.-L. Meng), pp. 113-162.
New York: Taylor and Francis.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## Suppose there are four data points (1, 1), (1, -1), (-1, -1), (-1, 1)
x = rbind(c(1, 1), c(1, -1), c(-1, -1), c(-1, 1))
## If the parameter of interest is the mean, the smoothing function and
## its gradient would be
f &lt;- function(params, x) {
 x - params
}
df &lt;- function(params, x) {
 rbind(c(-1, 0), c(0, -1))
}
## Draw 50 samples from the Empirical Likelihood Bayesian posterior distribution
## of the mean, using initial values (0.96, 0.97) and standard normal distributions
## as priors:
normal_prior &lt;- function(x) {
   exp(-0.5 * x[1] ^ 2) / sqrt(2 * pi) * exp(-0.5 * x[2] ^ 2) / sqrt(2 * pi)
}
normal_prior_log_gradient &lt;- function(x) {
   -x
}
set.seed(1234)
mean.samples &lt;- ELHMC(initial = c(0.96, 0.97), data = x, fun = f, dfun = df,
                     n.samples = 50, prior = normal_prior,
                     dprior = normal_prior_log_gradient)
plot(mean.samples$samples, type = "l", xlab = "", ylab = "")

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
