<!DOCTYPE html><html><head><title>Help for package SIRthresholded</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {SIRthresholded}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#plot.SIR'><p>Graphical output of SIR</p></a></li>
<li><a href='#plot.SIR_bootstrap'><p>Graphical output of SIR_bootstrap</p></a></li>
<li><a href='#plot.SIR_threshold'><p>Graphical output of SIR_threshold</p></a></li>
<li><a href='#plot.SIR_threshold_bootstrap'><p>Graphical output of SIR_threshold_bootstrap</p></a></li>
<li><a href='#plot.SIR_threshold_opt'><p>Graphical output of SIR_threshold_opt</p></a></li>
<li><a href='#SIR'><p>Classic SIR</p></a></li>
<li><a href='#SIR_bootstrap'><p>Bootstrap SIR</p></a></li>
<li><a href='#SIR_threshold'><p>SIR threshold</p></a></li>
<li><a href='#SIR_threshold_bootstrap'><p>SIR optimally thresholded on bootstraped replications</p></a></li>
<li><a href='#SIR_threshold_opt'><p>SIR optimally thresholded</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Sliced Inverse Regression with Thresholding</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.2</td>
</tr>
<tr>
<td>Author:</td>
<td>Clement Weinreich [aut, cre],
  Jerome Saracco [aut],
  Hadrien Lorenzo [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Clement Weinreich &lt;clement@weinreich.fr&gt;</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2.0)]</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements a thresholded version of the Sliced Inverse Regression method (Li, K. C. (1991) &lt;<a href="https://doi.org/10.2307%2F2290563">doi:10.2307/2290563</a>&gt;), which allows to do variable selection.</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.0</td>
</tr>
<tr>
<td>Imports:</td>
<td>strucchange</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, mvtnorm</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://clement-w.github.io/SIRthresholded/">https://clement-w.github.io/SIRthresholded/</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-06-09 07:08:26 UTC; clement</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-06-09 07:32:54 UTC</td>
</tr>
</table>
<hr>
<h2 id='plot.SIR'>Graphical output of SIR</h2><span id='topic+plot.SIR'></span>

<h3>Description</h3>

<p>Display the 10 first eigen values and the estimated index versus Y of the SIR model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'SIR'
plot(x, choice = "", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.SIR_+3A_x">x</code></td>
<td>
<p>A SIR object</p>
</td></tr>
<tr><td><code id="plot.SIR_+3A_choice">choice</code></td>
<td>
<p>the graph to plot: 
</p>

<ul>
<li><p> &quot;eigvals&quot; Plot the eigen values of the matrix of interest.
</p>
</li>
<li><p> &quot;estim_ind&quot; Plot the estimated index by the SIR model versus Y.
</p>
</li>
<li><p> &quot;&quot; Plot every graphs (default).
</p>
</li></ul>
</td></tr>
<tr><td><code id="plot.SIR_+3A_...">...</code></td>
<td>
<p>arguments to be passed to methods, such as graphical parameters (not used here).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate Data
set.seed(10)
n &lt;- 500
beta &lt;- c(1,1,rep(0,8))
X &lt;- mvtnorm::rmvnorm(n,sigma=diag(1,10))
eps &lt;- rnorm(n)
Y &lt;- (X%*%beta)**3+eps

# Apply SIR
res = SIR(Y, X, H = 10, graph = FALSE)

# Eigen values
plot(res,choice="eigvals")

# Estimated index versus Y
plot(res,choice="estim_ind")
</code></pre>

<hr>
<h2 id='plot.SIR_bootstrap'>Graphical output of SIR_bootstrap</h2><span id='topic+plot.SIR_bootstrap'></span>

<h3>Description</h3>

<p>Display the 10 first eigen values and the estimated index versus Y of the 
SIRbootstrap model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'SIR_bootstrap'
plot(x, choice = "", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.SIR_bootstrap_+3A_x">x</code></td>
<td>
<p>A SIR_bootstrap object</p>
</td></tr>
<tr><td><code id="plot.SIR_bootstrap_+3A_choice">choice</code></td>
<td>
<p>the graph to plot: 
</p>

<ul>
<li><p> &quot;eigvals&quot; Plot the eigen values of the matrix of interest.
</p>
</li>
<li><p> &quot;estim_ind&quot; Plot the estimated index by the SIR model versus Y.
</p>
</li>
<li><p> &quot;&quot; Plot every graphs (default).
</p>
</li></ul>
</td></tr>
<tr><td><code id="plot.SIR_bootstrap_+3A_...">...</code></td>
<td>
<p>arguments to be passed to methods, such as graphical parameters (not used here).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate Data
set.seed(10)
n &lt;- 500
beta &lt;- c(1,1,rep(0,8))
X &lt;- mvtnorm::rmvnorm(n,sigma=diag(1,10))
eps &lt;- rnorm(n)
Y &lt;- (X%*%beta)**3+eps

# Apply bootstrap SIR
res = SIR_bootstrap(Y, X, H = 10, B = 10)

# Eigen values
plot(res,choice="eigvals")

# Estimated index versus Y
plot(res,choice="estim_ind")
</code></pre>

<hr>
<h2 id='plot.SIR_threshold'>Graphical output of SIR_threshold</h2><span id='topic+plot.SIR_threshold'></span>

<h3>Description</h3>

<p>Display the 10 first eigen values and the estimated index versus Y of the 
thresholded SIR model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'SIR_threshold'
plot(x, choice = "", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.SIR_threshold_+3A_x">x</code></td>
<td>
<p>A SIR_threshold object</p>
</td></tr>
<tr><td><code id="plot.SIR_threshold_+3A_choice">choice</code></td>
<td>
<p>the graph to plot: 
</p>

<ul>
<li><p> &quot;eigvals&quot; Plot the eigen values of the matrix of interest.
</p>
</li>
<li><p> &quot;estim_ind&quot; Plot the estimated index by the SIR model versus Y.
</p>
</li>
<li><p> &quot;&quot; Plot every graphs (default).
</p>
</li></ul>
</td></tr>
<tr><td><code id="plot.SIR_threshold_+3A_...">...</code></td>
<td>
<p>arguments to be passed to methods, such as graphical parameters (not used here).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate Data
set.seed(10)
n &lt;- 500
beta &lt;- c(1,1,rep(0,8))
X &lt;- mvtnorm::rmvnorm(n,sigma=diag(1,10))
eps &lt;- rnorm(n)
Y &lt;- (X%*%beta)**3+eps

# Apply SIR with hard thresholding
res = SIR_threshold(Y, X, H = 10, lambda = 0.2, thresholding = "hard")

# Eigen values
plot(res,choice="eigvals")

# Estimated index versus Y
plot(res,choice="estim_ind")
</code></pre>

<hr>
<h2 id='plot.SIR_threshold_bootstrap'>Graphical output of SIR_threshold_bootstrap</h2><span id='topic+plot.SIR_threshold_bootstrap'></span>

<h3>Description</h3>

<p>Display the estimated index versus Y of the SIR model, the size of the models,
the occurrence of variable selection, the distribution of the coefficients of  
and <code class="reqn">\hat{b}</code> and the distribution of <code class="reqn">\lambda_{opt}</code> found across the replications.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'SIR_threshold_bootstrap'
plot(x, choice = "", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.SIR_threshold_bootstrap_+3A_x">x</code></td>
<td>
<p>A SIR_threshold_bootstrap object</p>
</td></tr>
<tr><td><code id="plot.SIR_threshold_bootstrap_+3A_choice">choice</code></td>
<td>
<p>the graph to plot: 
</p>

<ul>
<li><p> &quot;estim_ind&quot; Plot the estimated index by the SIR model versus Y.
</p>
</li>
<li><p> &quot;size&quot; Plot the size of the models across the replications.
</p>
</li>
<li><p> &quot;selec_var&quot; Plot the occurrence of the selected variables across the replications.
</p>
</li>
<li><p> &quot;coefs_b&quot; Plot the value of <code class="reqn">\hat{b}</code> across the replications.
</p>
</li>
<li><p> &quot;lambdas_replic&quot; Plot the distribution of <code class="reqn">\lambda_{opt}</code> across the replications.
</p>
</li>
<li><p> &quot;&quot; Plot every graphs (default).
</p>
</li></ul>
</td></tr>
<tr><td><code id="plot.SIR_threshold_bootstrap_+3A_...">...</code></td>
<td>
<p>arguments to be passed to methods, such as graphical parameters (not used here).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate Data
set.seed(10)
n &lt;- 200
beta &lt;- c(1,1,rep(0,8))
X &lt;- mvtnorm::rmvnorm(n,sigma=diag(1,10))
eps &lt;- rnorm(n)
Y &lt;- (X%*%beta)**3+eps


res = SIR_threshold_bootstrap(Y,X,H=10,n_lambda=300,thresholding="hard", n_replications=30,k=2)

# Estimated index versus Y
plot(res,choice="estim_ind")

# Model size
plot(res,choice="size")

# Selected variables
plot(res,choice="selec_var")

# Coefficients of b
plot(res,choice="coefs_b")

# Optimal lambdas
plot(res,choice="lambdas_replic")

</code></pre>

<hr>
<h2 id='plot.SIR_threshold_opt'>Graphical output of SIR_threshold_opt</h2><span id='topic+plot.SIR_threshold_opt'></span>

<h3>Description</h3>

<p>Display the 10 first eigen values,the estimated index versus Y of the SIR model,
the evolution of <code class="reqn">cos^2</code> and variable selection according to <code class="reqn">\lambda</code>, and the 
regularization path of <code class="reqn">\hat{b}</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'SIR_threshold_opt'
plot(x, choice = "", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.SIR_threshold_opt_+3A_x">x</code></td>
<td>
<p>A SIR_threshold_opt object</p>
</td></tr>
<tr><td><code id="plot.SIR_threshold_opt_+3A_choice">choice</code></td>
<td>
<p>the graph to plot: 
</p>

<ul>
<li><p> &quot;estim_ind&quot; Plot the estimated index by the SIR model versus Y.
</p>
</li>
<li><p> &quot;opt_lambda&quot; Plot the choice of <code class="reqn">\lambda_{opt}</code>.
</p>
</li>
<li><p> &quot;cos2_selec&quot; Plot the evolution of <code class="reqn">cos^2</code> and variable selection according to 
<code class="reqn">\lambda</code>.
</p>
</li>
<li><p> &quot;regul_path&quot; Plot the regularization path of <code class="reqn">\hat{b}</code>.
</p>
</li>
<li><p> &quot;&quot; Plot every graphs (default).
</p>
</li></ul>
</td></tr>
<tr><td><code id="plot.SIR_threshold_opt_+3A_...">...</code></td>
<td>
<p>arguments to be passed to methods, such as graphical parameters (not used here).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate Data
set.seed(10)
n &lt;- 200
beta &lt;- c(1,1,rep(0,8))
X &lt;- mvtnorm::rmvnorm(n,sigma=diag(1,10))
eps &lt;- rnorm(n)
Y &lt;- (X%*%beta)**3+eps

# Apply SIR with soft thresholding
res = SIR_threshold_opt(Y,X,H=10,n_lambda=100,thresholding="soft")

# Estimated index versus Y
plot(res,choice="estim_ind")

# Choice of optimal lambda
plot(res,choice="opt_lambda")

# Evolution of cos^2 and var selection according to lambda
plot(res,choice="cos2_selec")

# Regularization path
plot(res,choice="regul_path")
</code></pre>

<hr>
<h2 id='SIR'>Classic SIR</h2><span id='topic+SIR'></span>

<h3>Description</h3>

<p>Apply a single-index <code class="reqn">SIR</code> on <code class="reqn">(X,Y)</code> with <code class="reqn">H</code> slices. This function allows to obtain an 
estimate of a basis of the <code class="reqn">EDR</code> (Effective Dimension Reduction) space via the eigenvector 
<code class="reqn">\hat{b}</code> associated with the largest nonzero eigenvalue of the matrix of interest
<code class="reqn">\widehat{\Sigma}_n^{-1}\widehat{\Gamma}_n</code>. Thus, <code class="reqn">\hat{b}</code> is an <code class="reqn">EDR</code> direction.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SIR(Y, X, H = 10, graph = TRUE, choice = "")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SIR_+3A_y">Y</code></td>
<td>
<p>A numeric vector representing the dependent variable (a response vector).</p>
</td></tr>
<tr><td><code id="SIR_+3A_x">X</code></td>
<td>
<p>A matrix representing the quantitative explanatory variables (bind by column).</p>
</td></tr>
<tr><td><code id="SIR_+3A_h">H</code></td>
<td>
<p>The chosen number of slices (default is 10).</p>
</td></tr>
<tr><td><code id="SIR_+3A_graph">graph</code></td>
<td>
<p>A boolean that must be set to true to display graphics (default is TRUE).</p>
</td></tr>
<tr><td><code id="SIR_+3A_choice">choice</code></td>
<td>
<p>the graph to plot: 
</p>

<ul>
<li><p> &quot;eigvals&quot; Plot the eigen values of the matrix of interest.
</p>
</li>
<li><p> &quot;estim_ind&quot; Plot the estimated index by the SIR model versus Y.
</p>
</li>
<li><p> &quot;&quot; Plot every graphs. (default)
</p>
</li></ul>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class SIR, with attributes:
</p>
<table>
<tr><td><code>b</code></td>
<td>
<p>This is an estimated EDR direction, which is the principal 
eigenvector of the interest matrix.</p>
</td></tr>
<tr><td><code>M1</code></td>
<td>
<p>The interest matrix.</p>
</td></tr>
<tr><td><code>eig_val</code></td>
<td>
<p>The eigenvalues of the interest matrix.</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>Sample size.</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>The number of variables in X.</p>
</td></tr>
<tr><td><code>H</code></td>
<td>
<p>The chosen number of slices.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>Unevaluated call to the function.</p>
</td></tr>
<tr><td><code>index_pred</code></td>
<td>
<p>The index Xb' estimated by SIR.</p>
</td></tr>
<tr><td><code>Y</code></td>
<td>
<p>The response vector.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># Generate Data
set.seed(10)
n &lt;- 500
beta &lt;- c(1,1,rep(0,8))
X &lt;- mvtnorm::rmvnorm(n,sigma=diag(1,10))
eps &lt;- rnorm(n)
Y &lt;- (X%*%beta)**3+eps

# Apply SIR
SIR(Y, X, H = 10)
</code></pre>

<hr>
<h2 id='SIR_bootstrap'>Bootstrap SIR</h2><span id='topic+SIR_bootstrap'></span>

<h3>Description</h3>

<p>Apply a single-index <code class="reqn">SIR</code> on <code class="reqn">B</code> bootstraped samples of <code class="reqn">(X,Y)</code> with <code class="reqn">H</code> slices.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SIR_bootstrap(Y, X, H = 10, B = 10, graph = TRUE, choice = "")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SIR_bootstrap_+3A_y">Y</code></td>
<td>
<p>A numeric vector representing the dependent variable (a response vector).</p>
</td></tr>
<tr><td><code id="SIR_bootstrap_+3A_x">X</code></td>
<td>
<p>A matrix representing the quantitative explanatory variables (bind by column).</p>
</td></tr>
<tr><td><code id="SIR_bootstrap_+3A_h">H</code></td>
<td>
<p>The chosen number of slices (default is 10).</p>
</td></tr>
<tr><td><code id="SIR_bootstrap_+3A_b">B</code></td>
<td>
<p>The number of bootstrapped samples to draw (default is 10).</p>
</td></tr>
<tr><td><code id="SIR_bootstrap_+3A_graph">graph</code></td>
<td>
<p>A boolean that must be set to true to display graphics (default is TRUE).</p>
</td></tr>
<tr><td><code id="SIR_bootstrap_+3A_choice">choice</code></td>
<td>
<p>the graph to plot: 
</p>

<ul>
<li><p> &quot;eigvals&quot; Plot the eigen values of the matrix of interest.
</p>
</li>
<li><p> &quot;estim_ind&quot; Plot the estimated index by the SIR model versus Y.
</p>
</li>
<li><p> &quot;&quot; Plot every graphs (default).
</p>
</li></ul>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class SIR_bootstrap, with attributes:
</p>
<table>
<tr><td><code>b</code></td>
<td>
<p>This is an estimated EDR direction, which is the principal eigenvector
of the interest matrix.</p>
</td></tr>
<tr><td><code>mat_b</code></td>
<td>
<p>A matrix of size p*B that contains an estimation of beta in 
the columns for each bootstrapped sample.</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>Sample size.</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>The number of variables in X.</p>
</td></tr>
<tr><td><code>H</code></td>
<td>
<p>The chosen number of slices.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>Unevaluated call to the function.</p>
</td></tr>
<tr><td><code>index_pred</code></td>
<td>
<p>The index b'X estimated by SIR.</p>
</td></tr>
<tr><td><code>Y</code></td>
<td>
<p>The response vector.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># Generate Data
set.seed(10)
n &lt;- 500
beta &lt;- c(1,1,rep(0,8))
X &lt;- mvtnorm::rmvnorm(n,sigma=diag(1,10))
eps &lt;- rnorm(n)
Y &lt;- (X%*%beta)**3+eps

# Apply bootstrap SIR
SIR_bootstrap(Y, X, H = 10, B = 10)
</code></pre>

<hr>
<h2 id='SIR_threshold'>SIR threshold</h2><span id='topic+SIR_threshold'></span>

<h3>Description</h3>

<p>Apply a single-index <code class="reqn">SIR</code> on <code class="reqn">(X,Y)</code> with <code class="reqn">H</code> slices, with a parameter <code class="reqn">\lambda</code> which 
apply a soft/hard thresholding to the interest matrix <code class="reqn">\widehat{\Sigma}_n^{-1}\widehat{\Gamma}_n</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SIR_threshold(
  Y,
  X,
  H = 10,
  lambda = 0,
  thresholding = "hard",
  graph = TRUE,
  choice = ""
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SIR_threshold_+3A_y">Y</code></td>
<td>
<p>A numeric vector representing the dependent variable (a response vector).</p>
</td></tr>
<tr><td><code id="SIR_threshold_+3A_x">X</code></td>
<td>
<p>A matrix representing the quantitative explanatory variables (bind by column).</p>
</td></tr>
<tr><td><code id="SIR_threshold_+3A_h">H</code></td>
<td>
<p>The chosen number of slices (default is 10).</p>
</td></tr>
<tr><td><code id="SIR_threshold_+3A_lambda">lambda</code></td>
<td>
<p>The thresholding parameter (default is 0).</p>
</td></tr>
<tr><td><code id="SIR_threshold_+3A_thresholding">thresholding</code></td>
<td>
<p>The thresholding method to choose between hard and soft (default is hard).</p>
</td></tr>
<tr><td><code id="SIR_threshold_+3A_graph">graph</code></td>
<td>
<p>A boolean that must be set to true to display graphics (default is TRUE).</p>
</td></tr>
<tr><td><code id="SIR_threshold_+3A_choice">choice</code></td>
<td>
<p>the graph to plot: 
</p>

<ul>
<li><p> &quot;eigvals&quot; Plot the eigen values of the matrix of interest.
</p>
</li>
<li><p> &quot;estim_ind&quot; Plot the estimated index by the SIR model versus Y.
</p>
</li>
<li><p> &quot;&quot; Plot every graphs (default).
</p>
</li></ul>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class SIR_threshold, with attributes:
</p>
<table>
<tr><td><code>b</code></td>
<td>
<p>This is an estimated EDR direction, which is the principal eigenvector 
of the interest matrix.</p>
</td></tr>
<tr><td><code>M1</code></td>
<td>
<p>The interest matrix thresholded.</p>
</td></tr>
<tr><td><code>eig_val</code></td>
<td>
<p>The eigenvalues of the interest matrix thresholded.</p>
</td></tr>
<tr><td><code>eig_vect</code></td>
<td>
<p>A matrix corresponding to the eigenvectors of the interest matrix.</p>
</td></tr>
<tr><td><code>Y</code></td>
<td>
<p>The response vector.</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>Sample size.</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>The number of variables in X.</p>
</td></tr>
<tr><td><code>H</code></td>
<td>
<p>The chosen number of slices.</p>
</td></tr>
<tr><td><code>nb.zeros</code></td>
<td>
<p>The number of 0 in the estimation of the vector beta.</p>
</td></tr>
<tr><td><code>index_pred</code></td>
<td>
<p>The index Xb' estimated by SIR.</p>
</td></tr>
<tr><td><code>list.relevant.variables</code></td>
<td>
<p>A list that contains the variables selected by the
model.</p>
</td></tr>
<tr><td><code>cos_squared</code></td>
<td>
<p>The cosine squared between vanilla SIR and SIR thresholded.</p>
</td></tr>
<tr><td><code>lambda</code></td>
<td>
<p>The thresholding parameter used.</p>
</td></tr>
<tr><td><code>thresholding</code></td>
<td>
<p>The thresholding method used.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>Unevaluated call to the function.</p>
</td></tr>
<tr><td><code>X_reduced</code></td>
<td>
<p>The X data restricted to the variables selected by the model.
It can be used to estimate a new SIR model on the relevant variables to improve
the estimation of b.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># Generate Data
set.seed(10)
n &lt;- 500
beta &lt;- c(1,1,rep(0,8))
X &lt;- mvtnorm::rmvnorm(n,sigma=diag(1,10))
eps &lt;- rnorm(n)
Y &lt;- (X%*%beta)**3+eps

# Apply SIR with hard thresholding
SIR_threshold(Y, X, H = 10, lambda = 0.2, thresholding = "hard")
</code></pre>

<hr>
<h2 id='SIR_threshold_bootstrap'>SIR optimally thresholded on bootstraped replications</h2><span id='topic+SIR_threshold_bootstrap'></span>

<h3>Description</h3>

<p>Apply a single-index optimally soft/hard thresholded <code class="reqn">SIR</code> with <code class="reqn">H</code> slices on 
'n_replications' bootstraped replications of <code class="reqn">(X,Y)</code>. The optimal number of 
selected variables is the number of selected variables that came back most often 
among the replications performed. From this, we can get the corresponding <code class="reqn">\hat{b}</code> 
and <code class="reqn">\lambda_{opt}</code> that produce the same number of selected variables in the result of 
'SIR_threshold_opt'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SIR_threshold_bootstrap(
  Y,
  X,
  H = 10,
  thresholding = "hard",
  n_replications = 50,
  graph = TRUE,
  output = TRUE,
  n_lambda = 100,
  k = 2,
  choice = ""
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SIR_threshold_bootstrap_+3A_y">Y</code></td>
<td>
<p>A numeric vector representing the dependent variable (a response vector).</p>
</td></tr>
<tr><td><code id="SIR_threshold_bootstrap_+3A_x">X</code></td>
<td>
<p>A matrix representing the quantitative explanatory variables (bind by column).</p>
</td></tr>
<tr><td><code id="SIR_threshold_bootstrap_+3A_h">H</code></td>
<td>
<p>The chosen number of slices (default is 10).</p>
</td></tr>
<tr><td><code id="SIR_threshold_bootstrap_+3A_thresholding">thresholding</code></td>
<td>
<p>The thresholding method to choose between hard and soft (default is hard).</p>
</td></tr>
<tr><td><code id="SIR_threshold_bootstrap_+3A_n_replications">n_replications</code></td>
<td>
<p>The number of bootstraped replications of (X,Y) done to
estimate the model (default is 50).</p>
</td></tr>
<tr><td><code id="SIR_threshold_bootstrap_+3A_graph">graph</code></td>
<td>
<p>A boolean, set to TRUE to plot graphs (default is TRUE).</p>
</td></tr>
<tr><td><code id="SIR_threshold_bootstrap_+3A_output">output</code></td>
<td>
<p>A boolean, set to TRUE to print information (default is TRUE).</p>
</td></tr>
<tr><td><code id="SIR_threshold_bootstrap_+3A_n_lambda">n_lambda</code></td>
<td>
<p>The number of lambda to test. The n_lambda tested lambdas are
uniformally distributed between 0 and the maximum value of the interest matrix (default is 100).</p>
</td></tr>
<tr><td><code id="SIR_threshold_bootstrap_+3A_k">k</code></td>
<td>
<p>Multiplication factor of the bootstrapped sample size
(default is 1 = keep the same size as original data).</p>
</td></tr>
<tr><td><code id="SIR_threshold_bootstrap_+3A_choice">choice</code></td>
<td>
<p>the graph to plot: 
</p>

<ul>
<li><p> &quot;estim_ind&quot; Plot the estimated index by the SIR model versus Y.
</p>
</li>
<li><p> &quot;size&quot; Plot the size of the models across the replications.
</p>
</li>
<li><p> &quot;selec_var&quot; Plot the occurrence of the selected variables across the replications.
</p>
</li>
<li><p> &quot;coefs_b&quot; Plot the value of b across the replications.
</p>
</li>
<li><p> &quot;lambdas_replic&quot; Plot the optimal lambdas across the replications.
</p>
</li>
<li><p> &quot;&quot; Plot every graphs (default).
</p>
</li></ul>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class SIR_threshold_bootstrap, with attributes:
</p>
<table>
<tr><td><code>b</code></td>
<td>
<p>This is the optimal estimated EDR direction, which is the principal 
eigenvector of the interest matrix.</p>
</td></tr>
<tr><td><code>lambda_opt</code></td>
<td>
<p>The optimal lambda.</p>
</td></tr>
<tr><td><code>vec_nb_var_selec</code></td>
<td>
<p>Vector that contains the number of selected variables 
for each replications.</p>
</td></tr>
<tr><td><code>occurrences_var</code></td>
<td>
<p>Vector that contains at index i the number of times the 
i_th variable has been selected in a replication.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>Unevaluated call to the function.</p>
</td></tr>
<tr><td><code>nb_var_selec_opt</code></td>
<td>
<p>Optimal number of selected variables which is the number 
of selected variables that came back most often among the replications performed.</p>
</td></tr>
<tr><td><code>list_relevant_variables</code></td>
<td>
<p>A list that contains the variables selected by 
the model.</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>Sample size.</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>The number of variables in X.</p>
</td></tr>
<tr><td><code>H</code></td>
<td>
<p>The chosen number of slices.</p>
</td></tr>
<tr><td><code>n_replications</code></td>
<td>
<p>The number of bootstraped replications of (X,Y) done to
estimate the model.</p>
</td></tr>
<tr><td><code>thresholding</code></td>
<td>
<p>The thresholding method used.</p>
</td></tr>
<tr><td><code>X_reduced</code></td>
<td>
<p>The X data restricted to the variables selected by the model.
It can be used to estimate a new SIR model on the relevant variables to improve
the estimation of b.</p>
</td></tr>
<tr><td><code>mat_b</code></td>
<td>
<p>Contains the estimation b at each bootstraped replications.</p>
</td></tr>
<tr><td><code>lambdas_opt_boot</code></td>
<td>
<p>Contains the optimal lambda found by SIR_threshold_opt at 
each replication.</p>
</td></tr>
<tr><td><code>index_pred</code></td>
<td>
<p>The index Xb' estimated by SIR.</p>
</td></tr>
<tr><td><code>Y</code></td>
<td>
<p>The response vector.</p>
</td></tr>
<tr><td><code>M1</code></td>
<td>
<p>The interest matrix thresholded with the optimal lambda.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
# Generate Data
set.seed(8)
n &lt;-  170
beta &lt;- c(1,1,1,1,1,rep(0,15))
X &lt;- mvtnorm::rmvnorm(n,sigma=diag(1,20))
eps &lt;- rnorm(n,sd=8)
Y &lt;- (X%*%beta)**3+eps

# Apply SIR with hard thresholding
SIR_threshold_bootstrap(Y,X,H=10,n_lambda=300,thresholding="hard", n_replications=30,k=2)

</code></pre>

<hr>
<h2 id='SIR_threshold_opt'>SIR optimally thresholded</h2><span id='topic+SIR_threshold_opt'></span>

<h3>Description</h3>

<p>Apply a single-index <code class="reqn">SIR</code> on <code class="reqn">(X,Y)</code> with <code class="reqn">H</code> slices, with a soft/hard thresholding
of the interest matrix <code class="reqn">\widehat{\Sigma}_n^{-1}\widehat{\Gamma}_n</code> by an optimal
parameter <code class="reqn">\lambda_{opt}</code>. The <code class="reqn">\lambda_{opt}</code> is found automatically among a vector
of <code>n_lambda</code> <code class="reqn">\lambda</code>, starting from 0 to the maximum value of
<code class="reqn">\widehat{\Sigma}_n^{-1}\widehat{\Gamma}_n</code>. For each feature of <code class="reqn">X</code>,
the number of <code class="reqn">\lambda</code> associated with a selection of this feature is stored
(in a vector of size <code class="reqn">p</code>). This vector is sorted in a decreasing way. Then, thanks to
<code>strucchange::breakpoints</code>, a breakpoint is found in this sorted vector. The coefficients
of the variables at the left of the breakpoint, tend to be automatically toggled to 0 due
to the thresholding operation based on <code class="reqn">\lambda_{opt}</code>, and so should be removed (useless
variables). Finally, <code class="reqn">\lambda_{opt}</code> corresponds to the first <code class="reqn">\lambda</code> such that the
associated <code class="reqn">\hat{b}</code> provides the same number of zeros as the breakpoint's value.
</p>
<p>For example, for <code class="reqn">X \in R^{10}</code> and <code>n_lambda=100</code>, this sorted vector can look like this :</p>

<table>
<tr>
 <td style="text-align: left;">
   X10 </td><td style="text-align: left;"> X3 </td><td style="text-align: left;"> X8 </td><td style="text-align: left;"> X5 </td><td style="text-align: left;"> X7 </td><td style="text-align: left;"> X9 </td><td style="text-align: left;"> X4 </td><td style="text-align: left;"> X6 </td><td style="text-align: left;"> X2 </td><td style="text-align: left;"> X1 </td>
</tr>
<tr>
 <td style="text-align: left;">
   2 </td><td style="text-align: left;"> 3 </td><td style="text-align: left;"> 3 </td><td style="text-align: left;"> 4 </td><td style="text-align: left;"> 4 </td><td style="text-align: left;"> 4 </td><td style="text-align: left;"> 6 </td><td style="text-align: left;"> 10 </td><td style="text-align: left;"> 95 </td><td style="text-align: left;"> 100 </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Here, the breakpoint would be 8.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SIR_threshold_opt(
  Y,
  X,
  H = 10,
  n_lambda = 100,
  thresholding = "hard",
  graph = TRUE,
  output = TRUE,
  choice = ""
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SIR_threshold_opt_+3A_y">Y</code></td>
<td>
<p>A numeric vector representing the dependent variable (a response vector).</p>
</td></tr>
<tr><td><code id="SIR_threshold_opt_+3A_x">X</code></td>
<td>
<p>A matrix representing the quantitative explanatory variables (bind by column).</p>
</td></tr>
<tr><td><code id="SIR_threshold_opt_+3A_h">H</code></td>
<td>
<p>The chosen number of slices (default is 10).</p>
</td></tr>
<tr><td><code id="SIR_threshold_opt_+3A_n_lambda">n_lambda</code></td>
<td>
<p>The number of lambda to test. The n_lambda tested lambdas are
uniformally distributed between 0 and the maximum value of the interest matrix. (default is 100).</p>
</td></tr>
<tr><td><code id="SIR_threshold_opt_+3A_thresholding">thresholding</code></td>
<td>
<p>The thresholding method to choose between hard and soft (default is hard).</p>
</td></tr>
<tr><td><code id="SIR_threshold_opt_+3A_graph">graph</code></td>
<td>
<p>A boolean, set to TRUE to plot graphs (default is TRUE).</p>
</td></tr>
<tr><td><code id="SIR_threshold_opt_+3A_output">output</code></td>
<td>
<p>A boolean, set to TRUE to print informations (default is TRUE).</p>
</td></tr>
<tr><td><code id="SIR_threshold_opt_+3A_choice">choice</code></td>
<td>
<p>the graph to plot:
</p>

<ul>
<li><p> &quot;estim_ind&quot; Plot the estimated index by the SIR model versus Y.
</p>
</li>
<li><p> &quot;opt_lambda&quot; Plot the choice of the optimal lambda.
</p>
</li>
<li><p> &quot;cos2_selec&quot; Plot the evolution of cos^2 and variable selection according to
lambda.
</p>
</li>
<li><p> &quot;regul_path&quot; Plot the regularization path of b.
</p>
</li>
<li><p> &quot;&quot; Plot every graphs (default).
</p>
</li></ul>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class SIR_threshold_opt, with attributes:
</p>
<table>
<tr><td><code>b</code></td>
<td>
<p>This is the optimal estimated EDR direction, which is the principal
eigenvector of the interest matrix.</p>
</td></tr>
<tr><td><code>lambdas</code></td>
<td>
<p>A vector that contains the tested lambdas.</p>
</td></tr>
<tr><td><code>lambda_opt</code></td>
<td>
<p>The optimal lambda.</p>
</td></tr>
<tr><td><code>mat_b</code></td>
<td>
<p>A matrix of size p*n_lambda that contains an estimation of beta
in the columns for each lambda.</p>
</td></tr>
<tr><td><code>n_lambda</code></td>
<td>
<p>The number of lambda tested.</p>
</td></tr>
<tr><td><code>vect_nb_zeros</code></td>
<td>
<p>The number of 0 in b for each lambda.</p>
</td></tr>
<tr><td><code>list_relevant_variables</code></td>
<td>
<p>A list that contains the variables selected by
the model.</p>
</td></tr>
<tr><td><code>fit_bp</code></td>
<td>
<p>An object of class breakpoints from the strucchange package,
that contains informations about the breakpoint which allows to deduce the
optimal lambda.</p>
</td></tr>
<tr><td><code>indices_useless_var</code></td>
<td>
<p>A vector that contains p items: each variable is
associated with the number of lambda that selects this variable.</p>
</td></tr>
<tr><td><code>vect_cos_squared</code></td>
<td>
<p>A vector that contains for each lambda,
the cosine squared between vanilla SIR and SIR thresholded.</p>
</td></tr>
<tr><td><code>Y</code></td>
<td>
<p>The response vector.</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>Sample size.</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>The number of variables in X.</p>
</td></tr>
<tr><td><code>H</code></td>
<td>
<p>The chosen number of slices.</p>
</td></tr>
<tr><td><code>M1</code></td>
<td>
<p>The interest matrix thresholded with the optimal lambda.</p>
</td></tr>
<tr><td><code>thresholding</code></td>
<td>
<p>The thresholding method used.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>Unevaluated call to the function.</p>
</td></tr>
<tr><td><code>X_reduced</code></td>
<td>
<p>The X data restricted to the variables selected by the model.
It can be used to estimate a new SIR model on the relevant variables to improve
the estimation of b.</p>
</td></tr>
<tr><td><code>index_pred</code></td>
<td>
<p>The index Xb' estimated by SIR.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># Generate Data
set.seed(2)
n &lt;- 200
beta &lt;- c(1,1,rep(0,8))
X &lt;- mvtnorm::rmvnorm(n,sigma=diag(1,10))
eps &lt;- rnorm(n)
Y &lt;- (X%*%beta)**3+eps

# Apply SIR with soft thresholding
SIR_threshold_opt(Y,X,H=10,n_lambda=300,thresholding="soft")
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
