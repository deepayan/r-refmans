<!DOCTYPE html><html><head><title>Help for package RRreg</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {RRreg}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#RRreg-package'><p>Correlation and Regression Analyses for Randomized Response Designs</p></a></li>
<li><a href='#anova.RRlog'><p>Analysis of Deviance for Logistic RR Regression Models</p></a></li>
<li><a href='#getPW'><p>Get Misclassification Matrices for RR Models</p></a></li>
<li><a href='#minarets'><p>Minaret Data</p></a></li>
<li><a href='#plot.powerplot'><p>Plot power of multivariate RR methods</p></a></li>
<li><a href='#plot.RRlog'><p>Plot Logistic RR Regression</p></a></li>
<li><a href='#powerplot'><p>Power plots for multivariate RR methods</p></a></li>
<li><a href='#predict.RRlog'><p>Predict Individual Prevalences of the RR Attribute</p></a></li>
<li><a href='#RRcor'><p>Bivariate correlations including randomized response variables</p></a></li>
<li><a href='#RRgen'><p>Generate randomized response data</p></a></li>
<li><a href='#RRlin'><p>Linear randomized response regression</p></a></li>
<li><a href='#RRlog'><p>Logistic randomized response regression</p></a></li>
<li><a href='#RRmixed'><p>Mixed Effects Logistic Regression for RR Data</p></a></li>
<li><a href='#RRsimu'><p>Monte Carlo simulation for one or two RR variables</p></a></li>
<li><a href='#RRuni'><p>Univariate analysis of randomized response data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Correlation and Regression Analyses for Randomized Response Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.7.5</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-11-25</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>parallel, doParallel, foreach, stats, grDevices, graphics,
lme4</td>
</tr>
<tr>
<td>Suggests:</td>
<td>rmarkdown, knitr, R.rsp</td>
</tr>
<tr>
<td>Description:</td>
<td>
    Univariate and multivariate methods to analyze randomized response 
    (RR) survey designs (e.g., Warner, S. L. (1965). Randomized response: A 
    survey technique for eliminating evasive answer bias. Journal of the 
    American Statistical Association, 60, 63–69, &lt;<a href="https://doi.org/10.2307%2F2283137">doi:10.2307/2283137</a>&gt;). 
    Besides univariate estimates of true proportions, RR variables can be used 
    for correlations, as dependent variable in a logistic regression (with or 
    without random effects), or as predictors in a linear regression
    (Heck, D. W., &amp; Moshagen, M. (2018). RRreg: An R package for correlation and 
    regression analyses of randomized response data. Journal of Statistical 
    Software, 85(2), 1–29, &lt;<a href="https://doi.org/10.18637%2Fjss.v085.i02">doi:10.18637/jss.v085.i02</a>&gt;). For simulations and 
    the estimation of statistical power, RR data can be generated according to 
    several models. The implemented methods also allow to test the link between 
    continuous covariates and dishonesty in cheating paradigms such as the 
    coin-toss or dice-roll task (Moshagen, M., &amp; Hilbig, B. E. (2017). 
    The statistical analysis of cheating paradigms. Behavior Research Methods, 
    49, 724–732, &lt;<a href="https://doi.org/10.3758%2Fs13428-016-0729-x">doi:10.3758/s13428-016-0729-x</a>&gt;).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/danheck/RRreg">https://github.com/danheck/RRreg</a></td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr, R.rsp</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-11-25 14:20:21 UTC; daniel</td>
</tr>
<tr>
<td>Author:</td>
<td>Daniel W. Heck <a href="https://orcid.org/0000-0002-6302-9252"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [cre, aut],
  Morten Moshagen [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Daniel W. Heck &lt;daniel.heck@uni-marburg.de&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-11-25 15:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='RRreg-package'>Correlation and Regression Analyses for Randomized Response Designs</h2><span id='topic+RRreg'></span><span id='topic+RRreg-package'></span>

<h3>Description</h3>

<p>Univariate and multivariate methods for randomized response (RR) survey
designs (e.g., Warner, 1965). Univariate estimates of true proportions can be
obtained using <code><a href="#topic+RRuni">RRuni</a></code>. RR variables can be used in multivariate
analyses for correlations (<code><a href="#topic+RRcor">RRcor</a></code>), as dependent variable in a
logistic regression (<code><a href="#topic+RRlog">RRlog</a></code>), or as predictors in a linear
regression (<code><a href="#topic+RRlin">RRlin</a></code>). The function <code><a href="#topic+RRgen">RRgen</a></code> generates
single RR data sets, whereas <code><a href="#topic+RRsimu">RRsimu</a></code> generates and analyzes RR
data repeatedly for simulation and bootstrap purposes. An overview of the
available RR designs and examples can be found in the package vignette by
<code>vignette('RRreg')</code>.
</p>


<h3>Details</h3>

<p>In case of issues or questions, please refer to the GitHub repository: 
<a href="https://github.com/danheck/RRreg">https://github.com/danheck/RRreg</a>
</p>
<p>An introduction with examples is available via <code>vignette("RRreg")</code> or 
at the website: <a href="https://www.dwheck.de/vignettes/RRreg.html">https://www.dwheck.de/vignettes/RRreg.html</a>
</p>


<h3>Citation</h3>

<p>If you use <code>RRreg</code> in publications, please cite the package as follows:
</p>
<p>Heck, D. W., &amp; Moshagen, M. (2018).
RRreg: An R package for correlation and regression analyses of randomized response data.
<em>Journal of Statistical Software. 85 (2)</em>, 1-29. <a href="https://doi.org/10.18637/jss.v085.i02">doi:10.18637/jss.v085.i02</a>
</p>


<h3>Author(s)</h3>

<p>Daniel W. Heck <a href="mailto:daniel.heck@uni-marburg.de">daniel.heck@uni-marburg.de</a>
</p>


<h3>References</h3>

<p>Warner, S. L. (1965). Randomized response: A survey technique for eliminating
evasive answer bias. <em>Journal of the American Statistical Association, 60</em>, 63–69.
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/danheck/RRreg">https://github.com/danheck/RRreg</a>
</p>
</li></ul>


<hr>
<h2 id='anova.RRlog'>Analysis of Deviance for Logistic RR Regression Models</h2><span id='topic+anova.RRlog'></span>

<h3>Description</h3>

<p>Compute an analysis of deviance table for two logistic RR regression models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'RRlog'
anova(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="anova.RRlog_+3A_object">object</code></td>
<td>
<p>object of class <code>RRlog</code>, that is, logistic RR regression models fitted with the function <code><a href="#topic+RRlog">RRlog</a></code>.</p>
</td></tr>
<tr><td><code id="anova.RRlog_+3A_...">...</code></td>
<td>
<p>a second <code>RRlog</code> model</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Daniel W. Heck
</p>


<h3>Examples</h3>

<pre><code class='language-R'># generate data
n &lt;- 500
x &lt;- data.frame(x1 = rnorm(n))
pi.true &lt;- 1 / (1 + exp(.3 + 1.5 * x$x1))
true &lt;- rbinom(n, 1, plogis(pi.true))
dat &lt;- RRgen(n, trueState = true, model = "Warner", p = .1)
x$response &lt;- dat$response

# fit and plot RR logistic regression
mod1 &lt;- RRlog(response ~ x1, data = x, model = "Warner", p = .1)
mod0 &lt;- RRlog(response ~ 1, data = x, model = "Warner", p = .1)
anova(mod1, mod0)

</code></pre>

<hr>
<h2 id='getPW'>Get Misclassification Matrices for RR Models</h2><span id='topic+getPW'></span>

<h3>Description</h3>

<p>Given some randomization probabilities <code>p</code>, each RR design corresponds
to a misclassification matrix PW.  This square matrix has entries defined as:
<code>PW[i,j] = P(respond i | true state j)</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getPW(model, p, group = 1, par2 = NULL, Kukrep = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getPW_+3A_model">model</code></td>
<td>
<p>one of the available models in the package <code>RRreg</code>:</p>
</td></tr>
<tr><td><code id="getPW_+3A_p">p</code></td>
<td>
<p>randomization probability</p>
</td></tr>
<tr><td><code id="getPW_+3A_group">group</code></td>
<td>
<p>group index (1 or 2) for two-group designs such as
<code>"UQTunknown"</code> or <code>"SLD"</code></p>
</td></tr>
<tr><td><code id="getPW_+3A_par2">par2</code></td>
<td>
<p>the second, estimated parameter in two-group designs (e.g., the
unknown prevalence of the irrelevant question in <code>"UQTunknown"</code>, the
t-parameter for truth in the <code>"SLD"</code>)</p>
</td></tr>
<tr><td><code id="getPW_+3A_kukrep">Kukrep</code></td>
<td>
<p>number of replications in Kuk's RR design (how many cards are
drawn)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The method is used internally for estimation. Moreover, the method
might be useful to check the exact definition of the RR designs.
</p>
<p>Note that for two-group designs, the matrix depends on a second parameter
that is estimated from the data (e.g., the unknown prevalence of the
unknown question in the unrelated question technique). Hence, the matrix
itself is not constant, but an estimate of a random variable itself.
</p>


<h3>References</h3>

<p>van den Hout, A., &amp; Kooiman, P. (2006). Estimating the Linear
Regression Model with Categorical Covariates Subject to Randomized
Response. Computational Statistics &amp; Data Analysis, 50(11), 3311–3323.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>getPW(model = "Warner", p = 2 / 12)
getPW(model = "UQTknown", p = c(2 / 12, .3))
getPW(model = "UQTunknown", p = c(2 / 12, .10 / 12), group = 2, par2 = .4)

</code></pre>

<hr>
<h2 id='minarets'>Minaret Data</h2><span id='topic+minarets'></span>

<h3>Description</h3>

<p>Data by Radukic and Musch (2014)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(minarets)
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 1621 rows and 7 columns.
</p>


<h3>Details</h3>

<p>The following variables are included:
</p>

<ul>
<li> <p><code>age</code> in years
</p>
</li>
<li> <p><code>leftRight</code> political left-right orientation on a scale from -5 to 5
</p>
</li>
<li> <p><code>rrt</code> response to RR question (SLD with randomization probabilities 
<code>p=c(2/12,10/12)</code>)
</p>
</li>
<li> <p><code>condition</code> group membership in SLD (either randomization probability 
<code>p[1]</code> or <code>p[2]</code>)
</p>
</li>
<li> <p><code>RRdesign</code> whether the respondent answered to the RR question 
(RRdesign=1) or to the direct question (RRdesign=-1)
</p>
</li>
<li> <p><code>leftRight.c</code> zero-centered political left-right orientation
</p>
</li>
<li> <p><code>age.c</code> zero-centered age
</p>
</li></ul>


<hr>
<h2 id='plot.powerplot'>Plot power of multivariate RR methods</h2><span id='topic+plot.powerplot'></span>

<h3>Description</h3>

<p>Plot estimated power from Monte Carlo simulation as a function of the sample size, separately for different effect sizes and multivariate RR methods
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'powerplot'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.powerplot_+3A_x">x</code></td>
<td>
<p>a <code><a href="#topic+powerplot">powerplot</a></code> object</p>
</td></tr>
<tr><td><code id="plot.powerplot_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>

<hr>
<h2 id='plot.RRlog'>Plot Logistic RR Regression</h2><span id='topic+plot.RRlog'></span>

<h3>Description</h3>

<p>Plot predicted logit values/probabilities of a randomized response logistic regression model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'RRlog'
plot(
  x,
  predictor = NULL,
  type = c("link", "response", "attribute"),
  center.preds = TRUE,
  plot.mean = TRUE,
  ci = 0.95,
  xlim = NULL,
  steps = 50,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.RRlog_+3A_x">x</code></td>
<td>
<p>a fitted <a href="#topic+RRlog">RRlog</a> object</p>
</td></tr>
<tr><td><code id="plot.RRlog_+3A_predictor">predictor</code></td>
<td>
<p>character name of a predictor of the model to be fitted</p>
</td></tr>
<tr><td><code id="plot.RRlog_+3A_type">type</code></td>
<td>
<p><code>"response"</code> returns predicted probabilities for the (observable) RR responses,
<code>"link"</code> returns predicted logit-values for the (latent) sensitive attribute,
and <code>"attribute"</code> returns predicted probabilities of having the (latent) sensitive attribute.</p>
</td></tr>
<tr><td><code id="plot.RRlog_+3A_center.preds">center.preds</code></td>
<td>
<p>whether to compute predictions by assuming that all other
predictors are at their respective mean values (if <code>FALSE</code>: all other
predictors are set to zero)</p>
</td></tr>
<tr><td><code id="plot.RRlog_+3A_plot.mean">plot.mean</code></td>
<td>
<p>whether to plot the mean of the predictor as a vertical line</p>
</td></tr>
<tr><td><code id="plot.RRlog_+3A_ci">ci</code></td>
<td>
<p>level for confidence intervals. Use <code>ci=0</code> to omit.</p>
</td></tr>
<tr><td><code id="plot.RRlog_+3A_xlim">xlim</code></td>
<td>
<p>if provided, these boundaries are used for the predictor on the x-axis</p>
</td></tr>
<tr><td><code id="plot.RRlog_+3A_steps">steps</code></td>
<td>
<p>number of steps for plotting</p>
</td></tr>
<tr><td><code id="plot.RRlog_+3A_...">...</code></td>
<td>
<p>other arguments passed to the function <a href="graphics.html#topic+plot">plot</a> (e.g., <code>ylim=c(0,1)</code>).</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+predict.RRlog">predict.RRlog</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># generate data
n &lt;- 500
x &lt;- data.frame(x1 = rnorm(n))
pi.true &lt;- 1 / (1 + exp(.3 + 1.5 * x$x1))
true &lt;- rbinom(n, 1, plogis(pi.true))
dat &lt;- RRgen(n, trueState = true, model = "Warner", p = .1)
x$response &lt;- dat$response

# fit and plot RR logistic regression
mod &lt;- RRlog(response ~ x1, data = x, model = "Warner", p = .1)
plot(mod, "x1", ci = .95, type = "attribute", ylim = 0:1)

</code></pre>

<hr>
<h2 id='powerplot'>Power plots for multivariate RR methods</h2><span id='topic+powerplot'></span>

<h3>Description</h3>

<p>Uses the function <code><a href="#topic+RRsimu">RRsimu</a></code> to estimate the power of the
multivariate RR methods (correlation <code><a href="#topic+RRcor">RRcor</a></code>, logistic regression
<code><a href="#topic+RRlog">RRlog</a></code>, and/or linear regression <code><a href="#topic+RRlin">RRlin</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>powerplot(
  numRep,
  n = c(100, 500, 1000),
  pi,
  cor = c(0, 0.1, 0.3),
  b.log = NULL,
  model,
  p,
  method = c("RRcor", "RRlog", "RRlin"),
  complyRates = c(1, 1),
  sysBias = c(0, 0),
  groupRatio = 0.5,
  alpha = 0.05,
  nCPU = 1,
  show.messages = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="powerplot_+3A_numrep">numRep</code></td>
<td>
<p>number of boostrap replications</p>
</td></tr>
<tr><td><code id="powerplot_+3A_n">n</code></td>
<td>
<p>vector of samples sizes</p>
</td></tr>
<tr><td><code id="powerplot_+3A_pi">pi</code></td>
<td>
<p>true prevalence</p>
</td></tr>
<tr><td><code id="powerplot_+3A_cor">cor</code></td>
<td>
<p>vector of true correlations</p>
</td></tr>
<tr><td><code id="powerplot_+3A_b.log">b.log</code></td>
<td>
<p>vector of true logistic regression coefficients</p>
</td></tr>
<tr><td><code id="powerplot_+3A_model">model</code></td>
<td>
<p>randomized response model</p>
</td></tr>
<tr><td><code id="powerplot_+3A_p">p</code></td>
<td>
<p>randomization probability</p>
</td></tr>
<tr><td><code id="powerplot_+3A_method">method</code></td>
<td>
<p>multivariate RR method</p>
</td></tr>
<tr><td><code id="powerplot_+3A_complyrates">complyRates</code></td>
<td>
<p>probability of compliance within carriers/noncarriers of
sensitive attribute</p>
</td></tr>
<tr><td><code id="powerplot_+3A_sysbias">sysBias</code></td>
<td>
<p>probability of responding 'yes' in case of noncompliance</p>
</td></tr>
<tr><td><code id="powerplot_+3A_groupratio">groupRatio</code></td>
<td>
<p>ratio of subgroups in two-group RR designs</p>
</td></tr>
<tr><td><code id="powerplot_+3A_alpha">alpha</code></td>
<td>
<p>type-I error used to estimate power</p>
</td></tr>
<tr><td><code id="powerplot_+3A_ncpu">nCPU</code></td>
<td>
<p>either the number of CPU cores or a cluster initialized via
<code><a href="parallel.html#topic+makeCluster">makeCluster</a></code>.</p>
</td></tr>
<tr><td><code id="powerplot_+3A_show.messages">show.messages</code></td>
<td>
<p>toggle printing of progress messages</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of the class <code>powerplot</code> containing an array <code>res</code>
with the power estimates and details of the simulation (e.g., model, p, pi,
etc.)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+RRsimu">RRsimu</a></code> for Monte-Carlo simulation / parametric bootstrap
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Not run
# pplot &lt;- powerplot(100, n=c(150,250), cor=c(0,.3,.5),
#                   method="RRlog", pi=.6, model="Warner", p=.3)
# plot(pplot)

</code></pre>

<hr>
<h2 id='predict.RRlog'>Predict Individual Prevalences of the RR Attribute</h2><span id='topic+predict.RRlog'></span>

<h3>Description</h3>

<p>Predictions of the RR logistic regression model for the individual probabilities (or logits)
of having the sensitive RR attribute, or of the probability of the RR responses.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'RRlog'
predict(
  object,
  newdata = NULL,
  type = c("link", "response", "attribute"),
  se.fit = FALSE,
  ci = 0.95,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.RRlog_+3A_object">object</code></td>
<td>
<p>A fitted <code><a href="#topic+RRlog">RRlog</a></code> model</p>
</td></tr>
<tr><td><code id="predict.RRlog_+3A_newdata">newdata</code></td>
<td>
<p>An optional vector, matrix, or data.frame with values on the
predictor variables. Note that for matrices, the order of predictors
should match the order of predictors in the formula. Uses the fitted
values of the model if omitted.</p>
</td></tr>
<tr><td><code id="predict.RRlog_+3A_type">type</code></td>
<td>
<p><code>"response"</code> returns predicted probabilities for the (observable) RR responses,
<code>"link"</code> returns predicted logit-values for the (latent) sensitive attribute,
and <code>"attribute"</code> returns predicted probabilities of having the (latent) sensitive attribute.</p>
</td></tr>
<tr><td><code id="predict.RRlog_+3A_se.fit">se.fit</code></td>
<td>
<p>Return standard errors for the predicted values in addition to confidence intervals.
SEs on the logit scale are computed using the observed Fisher information from the fitted model.
Standard errors for the probability scale are computed using the delta method.</p>
</td></tr>
<tr><td><code id="predict.RRlog_+3A_ci">ci</code></td>
<td>
<p>Confidence level for confidence interval. If <code>ci=FALSE</code>, no
confidence interval is returned. Confidence intervals  on the probability
scale (if <code>type="response"</code> or <code>type="attribute"</code>) are computed
based on the CI on the logit-scale using the inverse link function
(hence, the CI will in general not be symmetric).</p>
</td></tr>
<tr><td><code id="predict.RRlog_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Value</h3>

<p>either a vector of predicted values or a matrix with columns for the
point estimates, confidence interval, and standard errors (if <code>se.fit=TRUE</code> and <code>ci=.95</code>).
</p>

<hr>
<h2 id='RRcor'>Bivariate correlations including randomized response variables</h2><span id='topic+RRcor'></span>

<h3>Description</h3>

<p><code>RRcor</code> calculates bivariate Pearson correlations of variables measured
with or without RR.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RRcor(
  x,
  y = NULL,
  models,
  p.list,
  group = NULL,
  bs.n = 0,
  bs.type = c("se.n", "se.p", "pval"),
  nCPU = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RRcor_+3A_x">x</code></td>
<td>
<p>a numeric vector, matrix or data frame.</p>
</td></tr>
<tr><td><code id="RRcor_+3A_y">y</code></td>
<td>
<p><code>NULL</code> (default) or a vector, matrix or data frame with
compatible dimensions to <code>x</code>.</p>
</td></tr>
<tr><td><code id="RRcor_+3A_models">models</code></td>
<td>
<p>a vector defining which RR design is used for each variable.
Must be in the same order as variables appear in <code>x</code> and <code>y</code> (by
columns). Available discrete models: <code>Warner</code>, <code>Kuk</code>, <code>FR</code>,
<code>Mangat</code>, <code>UQTknown</code>, <code>UQTunknown</code>, <code>Crosswise</code>,
<code>Triangular</code>, <code>SLD</code> and <code>direct</code> (i.e., no randomized
response design). Available continuous models: <code>mix.norm</code>,
<code>mix.exp</code>.</p>
</td></tr>
<tr><td><code id="RRcor_+3A_p.list">p.list</code></td>
<td>
<p>a <code>list</code> containing the randomization probabilities of the
RR models defined in <code>models</code>. Either, all <code>direct</code>-variables
(i.e., no randomized response) in <code>models</code> can be excluded in
<code>p.list</code>; or, if specified, randomization probabilities <code>p</code> are
ignored for <code>direct</code>-variables. See <code><a href="#topic+RRuni">RRuni</a></code> for a detailed
specification of p.</p>
</td></tr>
<tr><td><code id="RRcor_+3A_group">group</code></td>
<td>
<p>a matrix defining the group membership of each participant
(values 1 and 2) for all multiple group models(<code>SLD</code>,
<code>UQTunknown</code>). If only one of these models is included in
<code>models</code>, a vector can be used. For more than one model, each column
should contain one grouping variable</p>
</td></tr>
<tr><td><code id="RRcor_+3A_bs.n">bs.n</code></td>
<td>
<p>number of samples used to get bootstrapped standard errors</p>
</td></tr>
<tr><td><code id="RRcor_+3A_bs.type">bs.type</code></td>
<td>
<p>to get boostrapped standard errors, use <code>"se.p"</code> for the
parametric and/or <code>"se.n"</code> for the nonparametric bootstrap. Use
<code>"pval"</code> to get p-values from the parametric bootstrap (assuming a
true correlation of zero). Note that <code>bs.n</code> has to be larger than 0.
The parametric bootstrap is based on the assumption, that the continuous
variable is normally distributed within groups defined by the true state of
the RR variable. For polytomous forced response (FR) designs, the RR
variable is assumed to have equally spaced distances between categories
(i.e., that it is interval scaled)</p>
</td></tr>
<tr><td><code id="RRcor_+3A_ncpu">nCPU</code></td>
<td>
<p>only relevant for the bootstrap: either the number of CPU cores
or a cluster initialized via <code><a href="parallel.html#topic+makeCluster">makeCluster</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Correlations of RR variables are calculated by the method of Fox &amp;
Tracy (1984) by interpreting the variance induced by the RR procedure as
uncorrelated measurement error. Since the error is independent, the
correlation can be corrected to obtain an unbiased estimator.
</p>
<p>Note that the continuous RR model <code>mix.norm</code> with the randomization
parameter <code>p=c(p.truth, mean, SD)</code> assumes that participants respond
either to the sensitive question with probability <code>p.truth</code> or otherwise
to a known masking distribution with known mean and SD. The estimated
correlation only depends on the mean and SD and does not require normality.
However, the assumption of normality is used in the parametric bootstrap to
obtain standard errors.
</p>


<h3>Value</h3>

<p><code>RRcor</code> returns a list with the following components::
</p>
<p><code>r</code> estimated correlation matrix
</p>
<p><code>rSE.p</code>, <code>rSE.n</code> standard errors from parametric/nonparametric
bootstrap
</p>
<p><code>prob</code> two-sided p-values from parametric bootstrap
</p>
<p><code>samples.p</code>, <code>samples.n</code> sampled correlations from
parametric/nonparametric bootstrap (for the standard errors)
</p>


<h3>References</h3>

<p>Fox, J. A., &amp; Tracy, P. E. (1984). Measuring associations with
randomized response. <em>Social Science Research, 13</em>, 188-197.
</p>


<h3>See Also</h3>

<p><code>vignette('RRreg')</code> or
<a href="https://www.dwheck.de/vignettes/RRreg.html">https://www.dwheck.de/vignettes/RRreg.html</a> for a
detailed description of the RR models and the appropriate definition of
<code>p</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># generate first RR variable
n &lt;- 1000
p1 &lt;- c(.3, .7)
gData &lt;- RRgen(n, pi = .3, model = "Kuk", p1)

# generate second RR variable
p2 &lt;- c(.8, .5)
t2 &lt;- rbinom(n = n, size = 1, prob = (gData$true + 1) / 2)
temp &lt;- RRgen(model = "UQTknown", p = p2, trueState = t2)
gData$UQTresp &lt;- temp$response
gData$UQTtrue &lt;- temp$true

# generate continuous covariate
gData$cov &lt;- rnorm(n, 0, 4) + gData$UQTtrue + gData$true

# estimate correlations using directly measured / RR variables
cor(gData[, c("true", "cov", "UQTtrue")])
RRcor(
  x = gData[, c("response", "cov", "UQTresp")],
  models = c("Kuk", "d", "UQTknown"), p.list = list(p1, p2)
)
</code></pre>

<hr>
<h2 id='RRgen'>Generate randomized response data</h2><span id='topic+RRgen'></span>

<h3>Description</h3>

<p>The method <code>RRgen</code> generates data according to a specified
RR model, e.g., <code>"Warner"</code>. True states are either provided by a
vector <code>trueState</code> or drawn randomly from a Bernoulli distribution.
Useful for simulation and testing purposes, e.g., power analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RRgen(
  n,
  pi.true,
  model,
  p,
  complyRates = c(1, 1),
  sysBias = c(0, 0),
  groupRatio = 0.5,
  Kukrep = 1,
  trueState = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RRgen_+3A_n">n</code></td>
<td>
<p>sample size of generated data</p>
</td></tr>
<tr><td><code id="RRgen_+3A_pi.true">pi.true</code></td>
<td>
<p>true proportion in population (a vector for m-categorical
<code>"FR"</code> or <code>"custom"</code> model)</p>
</td></tr>
<tr><td><code id="RRgen_+3A_model">model</code></td>
<td>
<p>specifes the RR model, one of: <code>"Warner"</code>,
<code>"UQTknown"</code>, <code>"UQTunknown"</code>, <code>"Mangat"</code>, <code>"Kuk"</code>,
<code>"FR"</code>, <code>"Crosswise"</code>, <code>"Triangular"</code>, <code>"CDM"</code>,
<code>"CDMsym"</code>, <code>"SLD"</code>,  <code>"mix.norm"</code>,  <code>"mix.exp"</code>,
<code>"custom"</code>. See <code>vignette("RRreg")</code> for details.</p>
</td></tr>
<tr><td><code id="RRgen_+3A_p">p</code></td>
<td>
<p>randomization probability (depending on model, see
<code><a href="#topic+RRuni">RRuni</a></code> for details)</p>
</td></tr>
<tr><td><code id="RRgen_+3A_complyrates">complyRates</code></td>
<td>
<p>vector with two values giving the proportions of carriers
and non-carriers who adhere to the instructions, respectively</p>
</td></tr>
<tr><td><code id="RRgen_+3A_sysbias">sysBias</code></td>
<td>
<p>probability of responding 'yes' (coded as 1) in case of
non-compliance for carriers and non-carriers of the sensitive attribute,
respectively. If <code>sysBias=c(0,0)</code>, carriers and non-carriers
systematically give the nonsensitive response 'no' (also known as
self-protective(SP)-'no' responses). If <code>sysBias=c(0,0.5)</code>, carriers
always respond 'no' whereas non-carriers randomly select a response
category. Note that <code>sysBias = c(0.5,0.5)</code> might be the best choice
for <code>Kuk</code> and <code>Crosswise</code>. For the m-categorical <code>"FR"</code> or
<code>"custom"</code> model, <code>sysBias</code> can be given as a probability vector
for categories 0 to (m-1).</p>
</td></tr>
<tr><td><code id="RRgen_+3A_groupratio">groupRatio</code></td>
<td>
<p>proportion of participants in group 1. Only required for
two-group models, e.g., <code>SLD</code> and <code>CDM</code></p>
</td></tr>
<tr><td><code id="RRgen_+3A_kukrep">Kukrep</code></td>
<td>
<p>Number of repetitions of Kuk's procedure (how often red and
black cards are drawn)</p>
</td></tr>
<tr><td><code id="RRgen_+3A_truestate">trueState</code></td>
<td>
<p>optional vector containing true states of participants
(i.e., 1 for carriers and 0 for noncarriers of sensitive attribute; for
<code>FR</code>: values from 0,1,...,M-1 (M = number of response categories)
which will be randomized according to the defined procedure (if specified,
<code>n</code> and <code>pi.true</code> are ignored)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>trueState</code> is specified, the randomized response procedure
will be simulated for this vector, otherwise a random vector of length
<code>n</code> with true proportion <code>pi.true</code> is drawn. Respondents answer
biases can be simulated by adjusting the compliance rates: if
<code>complyRates</code> is set to <code>c(1,1)</code>, all respondents adhere to the
randomization procedure. If one or both rates are smaller than 1,
<code>sysBias</code> determines whether noncompliant respondents systematically
choose the nonsensitive category or whether they answer randomly.
</p>
<p><code>SLD</code> - to generate data according to the stochastic lie detector with
the proportion <code>t</code> of honest carriers, parameters are set to
<code>complyRates=c(t,1)</code> and <code>sysBias=c(0,0)</code>
</p>
<p><code>CDM</code> - to generate data according to the cheating detection model with
the proportion <code>gamma</code> of cheaters, parameters are set to
<code>complyRates=c(1-gamma,1-gamma)</code> and <code>sysBias=c(0,0)</code>
</p>


<h3>Value</h3>

<p><code>data.frame</code> including the variables <code>true</code> and
<code>response</code> (and for <code>SLD</code> and <code>CDM</code> a third variable
<code>group</code>)
</p>


<h3>See Also</h3>

<p>see <code>vignette('RRreg')</code> for a detailed description of the
models and <code><a href="#topic+RRlog">RRlog</a></code>, <code><a href="#topic+RRlin">RRlin</a></code> and <code><a href="#topic+RRcor">RRcor</a></code>
for the multivariate analysis of RR data
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate responses of 1000 people according to Warner's model,
# every participant complies to the RR procedure
genData &lt;- RRgen(n = 1000, pi.true = .3, model = "Warner", p = .7)
colMeans(genData)

# use Kuk's model with two decks of cards,
# p gives the proportions of red cards for carriers/noncarriers
genData &lt;- RRgen(n = 1000, pi.true = .4, model = "Kuk", p = c(.4, .7))
colMeans(genData)

# Stochastic Lie Detector (SLD):
# Only 80% of carriers answer according to the RR procedure
genData &lt;- RRgen(
  n = 1000, pi.true = .2, model = "SLD", p = c(.2, .8),
  complyRates = c(.8, 1), sysBias = c(0, 0)
)
colMeans(genData)

</code></pre>

<hr>
<h2 id='RRlin'>Linear randomized response regression</h2><span id='topic+RRlin'></span>

<h3>Description</h3>

<p>Linear regression for a continuous criterion, using randomized-response (RR)
variables as predictors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RRlin(
  formula,
  data,
  models,
  p.list,
  group = NULL,
  Kukrep = 1,
  bs.n = 0,
  nCPU = 1,
  maxit = 1000,
  fit.n = 3,
  pibeta = 0.05
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RRlin_+3A_formula">formula</code></td>
<td>
<p>a continuous criterion is predicted by one or more categorical
RR variables defined by <code>models</code>. If the number of predictors exceeds
the number defined by the vector <code>models</code>, the remaining predictors
are treated as non-randomized variables (e.g., direct questions).
Interactions including any of the RR variables cannot be included.</p>
</td></tr>
<tr><td><code id="RRlin_+3A_data">data</code></td>
<td>
<p>an optional data frame, list or environment, containing the
variables in the model.</p>
</td></tr>
<tr><td><code id="RRlin_+3A_models">models</code></td>
<td>
<p>character vector specifying RR model(s) in order of appearance
in formula. Available models: <code>"Warner"</code>, <code>"UQTknown"</code>,
<code>"UQTunknown"</code>, <code>"Mangat"</code>, <code>"Kuk"</code>, <code>"FR"</code>,
<code>"Crosswise"</code>, <code>"Triangular"</code>, <code>"CDM"</code>, <code>"CDMsym"</code>,
<code>"SLD"</code>, <code>"custom"</code> (custom: a randomization matrix must be
specified in the corresponding element of <code>p.list</code>, where the entry
<code>p[i,j]</code> defines the probability of responding i (i-th row) given a
true state of j (j-th column)).</p>
</td></tr>
<tr><td><code id="RRlin_+3A_p.list">p.list</code></td>
<td>
<p>list of randomization probabilities for RR models in the same
order as specified in <code>models</code>. Note, that the randomization
probabilities p must be provided in a <code><a href="base.html#topic+list">list</a></code>, e.g.,
<code>list(p=c(.2, .3))</code>. See <code><a href="#topic+RRuni">RRuni</a></code> for details.</p>
</td></tr>
<tr><td><code id="RRlin_+3A_group">group</code></td>
<td>
<p>vector or matrix specifying group membership by the indices 1
and 2. Only for multigroup RR models, e.g., <code>UQTunknown</code>, <code>CDM</code>
or <code>SLD</code></p>
</td></tr>
<tr><td><code id="RRlin_+3A_kukrep">Kukrep</code></td>
<td>
<p>defines the number of repetitions in Kuk's card playing method</p>
</td></tr>
<tr><td><code id="RRlin_+3A_bs.n">bs.n</code></td>
<td>
<p>Number of samples used for the non-parametric bootstrap</p>
</td></tr>
<tr><td><code id="RRlin_+3A_ncpu">nCPU</code></td>
<td>
<p>only relevant for the bootstrap: either the number of CPU cores
or a cluster initialized via <code><a href="parallel.html#topic+makeCluster">makeCluster</a></code>.</p>
</td></tr>
<tr><td><code id="RRlin_+3A_maxit">maxit</code></td>
<td>
<p>maximum number of iterations in optimization routine</p>
</td></tr>
<tr><td><code id="RRlin_+3A_fit.n">fit.n</code></td>
<td>
<p>number of fitting runs with random starting values</p>
</td></tr>
<tr><td><code id="RRlin_+3A_pibeta">pibeta</code></td>
<td>
<p>approximate ratio of probabilities pi to regression weights
beta (to adjust scaling). Can be used for speeding-up and fine-tuning ML
estimation (i.e., choosing a smaller value for larger beta values).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns an object <code>RRlin</code> which can be analysed by the generic
method <code><a href="base.html#topic+summary">summary</a></code>
</p>


<h3>Author(s)</h3>

<p>Daniel W. Heck
</p>


<h3>References</h3>

<p>van den Hout, A., &amp; Kooiman, P. (2006). Estimating the linear
regression model with categorical covariates subject to randomized
response. <em>Computational Statistics &amp; Data Analysis, 50</em>, 3311-3323.
</p>


<h3>See Also</h3>

<p><code>vignette('RRreg')</code> or
<a href="https://www.dwheck.de/vignettes/RRreg.html">https://www.dwheck.de/vignettes/RRreg.html</a> for a
detailed description of the RR models and the appropriate definition of
<code>p</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># generate two RR predictors
dat &lt;- RRgen(n = 500, pi = .4, model = "Warner", p = .3)
dat2 &lt;- RRgen(n = 500, pi = c(.4, .6), model = "FR", p = c(.1, .15))
dat$FR &lt;- dat2$response
dat$trueFR &lt;- dat2$true

# generate a third predictor and continuous dependent variables
dat$nonRR &lt;- rnorm(500, 5, 1)
dat$depvar &lt;- 2 * dat$true - 3 * dat2$true +
  .5 * dat$nonRR + rnorm(500, 1, 7)

# use RRlin and compare to regression on non-RR variables
linreg &lt;- RRlin(depvar ~ response + FR + nonRR,
  data = dat,
  models = c("Warner", "FR"),
  p.list = list(.3, c(.1, .15)), fit.n = 1
)
summary(linreg)
summary(lm(depvar ~ true + trueFR + nonRR, data = dat))

</code></pre>

<hr>
<h2 id='RRlog'>Logistic randomized response regression</h2><span id='topic+RRlog'></span>

<h3>Description</h3>

<p>A dichotomous variable, measured once or more per person by a randomized
response method, serves as dependent variable using one or more continuous
and/or categorical predictors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RRlog(
  formula,
  data,
  model,
  p,
  group,
  n.response = 1,
  LR.test = TRUE,
  fit.n = 3,
  EM.max = 1000,
  optim.max = 500,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RRlog_+3A_formula">formula</code></td>
<td>
<p>specifying the regression model, see <code><a href="stats.html#topic+formula">formula</a></code></p>
</td></tr>
<tr><td><code id="RRlog_+3A_data">data</code></td>
<td>
<p><code>data.frame</code>, in which variables can be found (optional)</p>
</td></tr>
<tr><td><code id="RRlog_+3A_model">model</code></td>
<td>
<p>Available RR models: <code>"Warner"</code>, <code>"UQTknown"</code>,
<code>"UQTunknown"</code>, <code>"Mangat"</code>, <code>"Kuk"</code>, <code>"FR"</code>,
<code>"Crosswise"</code>, <code>"Triangular"</code>, <code>"CDM"</code>, <code>"CDMsym"</code>,
<code>"SLD"</code>, <code>"custom"</code>. See <code>vignette("RRreg")</code> for details.</p>
</td></tr>
<tr><td><code id="RRlog_+3A_p">p</code></td>
<td>
<p>randomization probability/probabilities (depending on model, see
<code><a href="#topic+RRuni">RRuni</a></code> for details)</p>
</td></tr>
<tr><td><code id="RRlog_+3A_group">group</code></td>
<td>
<p>vector specifying group membership. Can be omitted for
single-group RR designs (e.g., Warner). For two-group RR designs (e.g.,
<code>CDM</code> or <code>SLD</code>), use 1 and 2 to indicate the group membership,
matching the respective randomization probabilities <code>p[1], p[2]</code>. If
an RR design and a direct question (DQ) were both used in the study, the
group indices are set to 0 (DQ) and 1 (RR; 1 or 2 for two-group RR
designs). This can be used to test, whether the RR design leads to a
different prevalence estimate by including a dummy variable for the
question format (RR vs. DQ) as predictor. If the corresponding regression
coefficient is significant, the prevalence estimates differ between RR and
DQ. Similarly, interaction hypotheses can be tested (e.g., the correlation
between a sensitive attribute and a predictor is only found using the RR
but not the DQ design). Hypotheses like this can be tested by including the
interaction of the DQ-RR-dummy variable and the predictor in <code>formula</code>
(e.g., <code>RR ~ dummy*predictor</code>).</p>
</td></tr>
<tr><td><code id="RRlog_+3A_n.response">n.response</code></td>
<td>
<p>number of responses per participant, e.g., if a participant
responds to 5 RR questions with the same randomization probability <code>p</code>
(either a single number if all participants give the same number of
responses or a vector)</p>
</td></tr>
<tr><td><code id="RRlog_+3A_lr.test">LR.test</code></td>
<td>
<p>test regression coefficients by a likelihood ratio test, i.e.,
fitting the model repeatedly while excluding one parameter at a time (each
nested model is fitted only once, which can result in local maxima). The
likelihood-ratio test statistic <code class="reqn">G^2(df=1)</code> is reported in the table of
coefficiencts as <code>deltaG2</code>.</p>
</td></tr>
<tr><td><code id="RRlog_+3A_fit.n">fit.n</code></td>
<td>
<p>Number of fitting replications using random starting values to
avoid local maxima</p>
</td></tr>
<tr><td><code id="RRlog_+3A_em.max">EM.max</code></td>
<td>
<p>maximum number of iterations of the EM algorithm. If
<code>EM.max=0</code>, the EM algorithm is skipped.</p>
</td></tr>
<tr><td><code id="RRlog_+3A_optim.max">optim.max</code></td>
<td>
<p>Maximum number of iterations within each run of <code>optim</code></p>
</td></tr>
<tr><td><code id="RRlog_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The logistic regression model is fitted first by an EM algorithm, in
which the dependend RR variable is treated as a misclassified binary
variable (Magder &amp; Hughes, 1997). The results are used as starting values
for a Newton-Raphson based optimization by <code><a href="stats.html#topic+optim">optim</a></code>.
</p>


<h3>Value</h3>

<p>Returns an object <code>RRlog</code> which can be analysed by the generic
method <code><a href="base.html#topic+summary">summary</a></code>. In the table of coefficients, the column
<code>Wald</code> refers to the Chi^2 test statistic which is computed as Chi^2 =
z^2 = Estimate^2/StdErr^2. If <code>LR.test = TRUE</code>, the test statistic
<code>deltaG2</code> is the likelihood-ratio-test statistic, which is computed by
fitting a nested logistic model without the corresponding predictor.
</p>


<h3>Author(s)</h3>

<p>Daniel W. Heck
</p>


<h3>References</h3>

<p>van den Hout, A., van der Heijden, P. G., &amp; Gilchrist, R. (2007).
The logistic regression model with response variables subject to randomized 
response. <em>Computational Statistics &amp; Data Analysis, 51</em>, 6060-6069.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+anova.RRlog">anova.RRlog</a></code> for model comparisons, <code><a href="#topic+plot.RRlog">plot.RRlog</a></code> 
for plotting predicted regression curves, and <code>vignette('RRreg')</code> or
<a href="https://www.dwheck.de/vignettes/RRreg.html">https://www.dwheck.de/vignettes/RRreg.html</a> for a
detailed description of the RR models and the appropriate definition of
<code>p</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># generate data set without biases
dat &lt;- RRgen(1000, pi = .3, "Warner", p = .9)
dat$covariate &lt;- rnorm(1000)
dat$covariate[dat$true == 1] &lt;- rnorm(sum(dat$true == 1), .4, 1)
# analyse
ana &lt;- RRlog(response ~ covariate, dat, "Warner", p = .9, fit.n = 1)
summary(ana)
# check with true, latent states:
glm(true ~ covariate, dat, family = binomial(link = "logit"))
</code></pre>

<hr>
<h2 id='RRmixed'>Mixed Effects Logistic Regression for RR Data</h2><span id='topic+RRmixed'></span>

<h3>Description</h3>

<p>Uses the package <code><a href="lme4.html#topic+lme4">lme4</a></code> to fit a generalized linear mixed model
(GLMM) with an adjusted link funciton.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RRmixed(formula, data, model, p, const = 1e-04, adjust_control = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RRmixed_+3A_formula">formula</code></td>
<td>
<p>two-sided formula including random and fixed effects (see
below or <code><a href="lme4.html#topic+glmer">glmer</a></code> for details)</p>
</td></tr>
<tr><td><code id="RRmixed_+3A_data">data</code></td>
<td>
<p>an optional data frame with variables named in formula</p>
</td></tr>
<tr><td><code id="RRmixed_+3A_model">model</code></td>
<td>
<p>type of RR design. Only 1-group RR designs are supported at the
moment (i.e., <code>"Warner"</code>, <code>"FR"</code>, <code>"UQTknown"</code>,
<code>"Crosswise"</code>, <code>"Triangular"</code>, <code>"Kuk"</code>, <code>"Mangat"</code>,
<code>"custom"</code>). See <code><a href="#topic+RRuni">RRuni</a></code> or <code>vignette(RRreg)</code> for
details.</p>
</td></tr>
<tr><td><code id="RRmixed_+3A_p">p</code></td>
<td>
<p>randomization probability</p>
</td></tr>
<tr><td><code id="RRmixed_+3A_const">const</code></td>
<td>
<p>the RR link function is not defined for small and/or large
probabilities (the boundaries depend on <code>model</code> and <code>p</code>). To
increase robustness of the estimation, these probabilities smaller and
larger than the respective boundaries (plus/minus a constant defined via
<code>const</code>) are smoothed by separate logit-link functions.</p>
</td></tr>
<tr><td><code id="RRmixed_+3A_adjust_control">adjust_control</code></td>
<td>
<p>whether to adjust the control arguments for
<code>glmer</code>, which might help in case of convergence issues for some
models. <code><a href="lme4.html#topic+lmerControl">lmerControl</a></code> settings are changed to
<code>nAGQ0initStep = FALSE</code> and <code>optimizer = "bobyqa"</code>.</p>
</td></tr>
<tr><td><code id="RRmixed_+3A_...">...</code></td>
<td>
<p>further arguments passed to <code><a href="lme4.html#topic+glmer">glmer</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Some examples for formula: 
</p>
 
<ul>
<li><p>random intercept: 
<code>response ~ covariate + (1 | group)</code> 
</p>
</li>
<li><p>random slope: 
<code>response ~ covariate + (0 + covariate | group)</code> 
</p>
</li>
<li><p>both random slope and intercept: 
<code>response ~ covariate +(covariate | group)</code>
</p>
</li>
<li><p>level-2 predictor (must have constant values within groups!):
<code>response ~ lev2 + (1|group)</code> 
</p>
</li></ul>

<p>Note that parameter estimation will be unstable and might fail if the
observed responses are not in line with the model. For instance, a
Forced-Response model (<code>model="FR"</code>) with <code>p=c(0,1/4)</code> requires
that expected probabilities for responses are in the interval [.25,1.00]. If
the observed proportion of responses is very low (&lt;&lt;.25), intercepts will be
estimated to be very small (&lt;&lt;0) and/or parameter estimation might fail. See
<code><a href="lme4.html#topic+glmer">glmer</a></code> for setting better starting values and
<code><a href="lme4.html#topic+lmerControl">lmerControl</a></code> for further options to increase stability.
</p>


<h3>Value</h3>

<p>an object of class <code>glmerMod</code>
</p>


<h3>References</h3>

<p>van den Hout, A., van der Heijden, P. G., &amp; Gilchrist, R.
(2007). The Logistic Regression Model with Response Variables Subject to
Randomized Response. Computational Statistics &amp; Data Analysis, 51,
6060–6069.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># generate data with a level-1 predictor
set.seed(1234)
d &lt;- data.frame(
  group = factor(rep(LETTERS[1:20], each = 50)),
  cov = rnorm(20 * 50)
)
# generate dependent data based on logistic model (random intercept):
d$true &lt;- simulate(~ cov + (1 | group),
  newdata = d,
  family = binomial(link = "logit"),
  newparams = list(
    beta = c("(Intercept)" = -.5, cov = 1),
    theta = c("group.(Intercept)" = .8)
  )
)[[1]]
# scramble responses using RR:
model &lt;- "FR"
p &lt;- c(true0 = .1, true1 = .2)
d$resp &lt;- RRgen(model = "FR", p = p, trueState = d$true)$response
# fit model:
mod &lt;- RRmixed(resp ~ cov + (1 | group), data = d, model = "FR", p = p)
summary(mod)
</code></pre>

<hr>
<h2 id='RRsimu'>Monte Carlo simulation for one or two RR variables</h2><span id='topic+RRsimu'></span>

<h3>Description</h3>

<p>Simulate and analyse bivariate data including either one RR
variable (either correlation, logistic, or linear regression model) or two
RR variables (only correlations). Useful for power analysis, parametric
bootstraps or for testing the effects of noncompliance on the stability of
estimates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RRsimu(
  numRep,
  n,
  pi,
  model,
  p,
  cor = 0,
  b.log = 0,
  complyRates = c(1, 1),
  sysBias = c(0, 0),
  method = c("RRuni", "RRcor", "RRlog", "RRlin"),
  alpha = 0.05,
  groupRatio = 0.5,
  MLest = FALSE,
  getPower = TRUE,
  nCPU = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RRsimu_+3A_numrep">numRep</code></td>
<td>
<p>number of replications</p>
</td></tr>
<tr><td><code id="RRsimu_+3A_n">n</code></td>
<td>
<p>sample size</p>
</td></tr>
<tr><td><code id="RRsimu_+3A_pi">pi</code></td>
<td>
<p>true proportion of carriers of sensitive attribute (for 2 RR
variables: <code>vector</code>)</p>
</td></tr>
<tr><td><code id="RRsimu_+3A_model">model</code></td>
<td>
<p>either one or two RR model (as <code>vector</code>), see
<code><a href="#topic+RRuni">RRuni</a></code></p>
</td></tr>
<tr><td><code id="RRsimu_+3A_p">p</code></td>
<td>
<p>randomization probability (for 2 RR variables: a <code>list</code>). See
<code><a href="#topic+RRuni">RRuni</a></code>  for details.</p>
</td></tr>
<tr><td><code id="RRsimu_+3A_cor">cor</code></td>
<td>
<p>true Pearson-correlation used for data generation (for
<code><a href="#topic+RRcor">RRcor</a></code>). Can also be used to generate data with two
dichotomous RR variables.</p>
</td></tr>
<tr><td><code id="RRsimu_+3A_b.log">b.log</code></td>
<td>
<p>true regression coefficient in logistic regression (for
<code><a href="#topic+RRlog">RRlog</a></code>)</p>
</td></tr>
<tr><td><code id="RRsimu_+3A_complyrates">complyRates</code></td>
<td>
<p>vector with two values giving the proportions of
participants who adhere to the instructions in the subset with or without
the sensitive attribute, respectively (for 2 RR variables: a <code>list</code>)</p>
</td></tr>
<tr><td><code id="RRsimu_+3A_sysbias">sysBias</code></td>
<td>
<p>probability of responding 'yes' (coded as 1 in the RR
variable) in case of non-compliance for carriers and non-carriers,
respectively. See <code><a href="#topic+RRgen">RRgen</a></code></p>
</td></tr>
<tr><td><code id="RRsimu_+3A_method">method</code></td>
<td>
<p>vector specifying which RR methods to be used in each
replication. For a single RR variable, the methods <code><a href="#topic+RRuni">RRuni</a></code>,
<code><a href="#topic+RRcor">RRcor</a></code>,<code><a href="#topic+RRlog">RRlog</a></code>, and <code><a href="#topic+RRlin">RRlin</a></code> are
available. For 2 RR variables, only <code><a href="#topic+RRcor">RRcor</a></code> is available.</p>
</td></tr>
<tr><td><code id="RRsimu_+3A_alpha">alpha</code></td>
<td>
<p>significance threshold for testing the logistic regression
parameter <code>beta</code></p>
</td></tr>
<tr><td><code id="RRsimu_+3A_groupratio">groupRatio</code></td>
<td>
<p>proportion of participants in group 1. Only for two-group
models (e.g., <code>"SLD"</code>) (for 2 RR variables: <code>vector</code>)</p>
</td></tr>
<tr><td><code id="RRsimu_+3A_mlest">MLest</code></td>
<td>
<p>concerns <code><a href="#topic+RRuni">RRuni</a></code>: whether to use <code>optim</code> to get
ML instead of moment estimates (only relevant if pi is outside of [0,1])</p>
</td></tr>
<tr><td><code id="RRsimu_+3A_getpower">getPower</code></td>
<td>
<p>whether to compute power for <code>method="RRcor"</code> (performs
an additional bootstrap assuming independence)</p>
</td></tr>
<tr><td><code id="RRsimu_+3A_ncpu">nCPU</code></td>
<td>
<p>either the number of CPU cores or a cluster initialized via
<code><a href="parallel.html#topic+makeCluster">makeCluster</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For a single RR variable:
</p>
<p>The parameter <code>b.log</code> is the slope-coefficient for the true, latent
values in a logistic regression model that is used for data generation.
</p>
<p>The argument <code>cor</code> is used for data generation for linear models. The
directly measured covariate is sampled from a normal distribution with
shifted means, depending on the true state on the sensitive attribute
(i.e., the true, underlying values on the RR variable). For dichotomous RR
variables, this corresponds to the assumption of an ordinary t-test, where
the dependent variable is normally distributed within groups with equal
variance. The difference in means is chosen in a way, to obtain the
point-biserial correlation defined by <code>cor</code>.
</p>
<p>For two RR variables:
</p>
<p><code>cor</code> has to be used. In case of two dichotomous RR variables, the
true group membership of individuals is sampled from a 2x2 cross table.
Within this table, probabilities are chosen in a way, to obtain the
point-tetrachoric correlation defined by <code>cor</code>
</p>
<p>Note, that for the FR model with multiple response categories (e.g., from 0
to 4), the specified <code>cor</code> is not the exact target of the sampling
procedure. It assumes a normal distribution for each true state, with
constant differences between the groups (i.e., it assumes an interval
scaled variable).
</p>


<h3>Value</h3>

<p>A list containing </p>
<table>
<tr><td><code>parEsts</code></td>
<td>
<p>matrix containing the estimated
parameters</p>
</td></tr> <tr><td><code>results</code></td>
<td>
<p>matrix  with mean parameters, standard errors,
and number of samples to which the respective method could not be fitted</p>
</td></tr>
<tr><td><code>power</code></td>
<td>
<p>vector with the estimated power of the selected randomized
response procedures</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># Not run: Simulate data according to the Warner model
# mcsim &lt;-  RRsimu(numRep=100, n=300, pi=.4,
#                  model="Warner", p=.2, cor=.3)
# print(mcsim)
</code></pre>

<hr>
<h2 id='RRuni'>Univariate analysis of randomized response data</h2><span id='topic+RRuni'></span>

<h3>Description</h3>

<p>Analyse a data vector <code>response</code> with a specified RR model (e.g.,
<code>Warner</code>) with known randomization probability <code>p</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RRuni(response, data, model, p, group = NULL, MLest = TRUE, Kukrep = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RRuni_+3A_response">response</code></td>
<td>
<p>either vector of responses containing 0='no' and 1='yes' or
name of response variable in <code>data</code>. For the Forced Response
(<code>FR</code>) model, response values are integers from 0 to (m-1), where 'm'
is the number of response categories. In Kuk's card playing method
(<code>Kuk</code>), the observed response variable gives the number of red cards.</p>
</td></tr>
<tr><td><code id="RRuni_+3A_data">data</code></td>
<td>
<p>optional <code>data.frame</code> containing the response variable</p>
</td></tr>
<tr><td><code id="RRuni_+3A_model">model</code></td>
<td>
<p>defines RR model. Available models: <code>"Warner"</code>,
<code>"UQTknown"</code>, <code>"UQTunknown"</code>, <code>"Mangat"</code>, <code>"FR"</code>,
<code>"Kuk"</code>,<code>"Crosswise"</code>, <code>"Triangular"</code>, <code>"CDM"</code>,
<code>"CDMsym"</code>, <code>"SLD"</code>, <code>"mix.norm"</code>,
<code>"mix.exp"</code>,<code>"mix.unknown"</code>, or <code>"custom"</code>. See argument
<code>p</code> or type <code>vignette('RRreg')</code> for detailed specifications.</p>
</td></tr>
<tr><td><code id="RRuni_+3A_p">p</code></td>
<td>
<p>randomization probability (see details or <code>vignette("RRreg")</code>)</p>
</td></tr>
<tr><td><code id="RRuni_+3A_group">group</code></td>
<td>
<p>a group vector of the same length as <code>response</code> containing
values 1 or 2, only required for two-group models, which specify different
randomization probabilities for two groups, e.g., <code>CDM</code> or <code>SLD</code>.
If a data.frame <code>data</code> is provided, the variable <code>group</code> is
searched within it.</p>
</td></tr>
<tr><td><code id="RRuni_+3A_mlest">MLest</code></td>
<td>
<p>whether to use <code>optim</code> to get ML instead of moment
estimates (only relevant if pi is outside of [0,1])</p>
</td></tr>
<tr><td><code id="RRuni_+3A_kukrep">Kukrep</code></td>
<td>
<p>number of repetitions of Kuk's card-drawing method</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Each RR design <code>model</code> differs in the definition of the
randomization probability <code>p</code>, which is defined as a single probability
for
</p>

<ul>
<li> <p><code>"Warner"</code>: Probability to get sensitive Question
</p>
</li>
<li> <p><code>"Mangat"</code>: Prob. for non-carriers to respond truthfully (i.e., with No=0)
</p>
</li>
<li> <p><code>"Crosswise"</code>: Probability to respond 'yes' to irrelevant second 
question (coding of responses: 1=['no-no' or 'yes-yes']; 0=['yes-no' or 'no-yes'])
</p>
</li>
<li> <p><code>"Triangular"</code>: Probability to respond 'yes' to irrelevant second 
question (coding of responses: 0='no' to both questions (='circle'); 1='yes' 
to at least one question ('triangle'))
</p>
</li></ul>

<p>and as a two-valued vector of probabilities for
</p>

<ul>
<li> <p><code>"Kuk"</code>: Probability of red cards in first and second set, 
respectively (red=1, black=0);
</p>
</li>
<li><p> Unrelated Question (<code>"UQTknown"</code>): Prob. to respond to sensitive 
question and known prevalence of 'yes' responses to unrelated question
</p>
</li>
<li><p> Unrelated Question (<code>"UQTunknown"</code>): Prob. to respond to
sensitive question in group 1 and 2, respectively
</p>
</li>
<li><p> Cheating Detection (<code>"CDM"</code>): Prob. to be prompted to say yes 
in group 1 and 2, respectively
</p>
</li>
<li><p> Symmetric CDM (<code>"CDMsym"</code>): 4-valued vector: Prob. to be 
prompted to say 'yes'/'no' in group 1 and 'yes'/'no' in group 2
</p>
</li>
<li><p> Stochastic Lie Detector (<code>"SLD"</code>): Prob. for noncarriers to 
reply with 0='no' in group 1 and 2, respectively
</p>
</li>
<li><p> Forced Response model (<code>"FR"</code>): m-valued vector (m=number of 
response categories) with the probabilities of being prompted to select 
response categories 0,1,..,m-1, respectively (requires <code>sum(p)&lt;1</code>)
</p>
</li>
<li><p> RR as misclassification (<code>"custom"</code>): a quadratic misclassification 
matrix is specified, where the entry <code>p[i,j]</code> defines the 
probability of responding i (i-th row) given a true state of j 
(j-th column)) (see <code><a href="#topic+getPW">getPW</a></code>)
</p>
</li></ul>

<p>For the continuous RR models:
</p>

<ul>
<li> <p><code>"mix.norm"</code>: 3-valued vector - Prob. to respond to sensitive 
question and mean and SD of the masking normal distribution of the 
unrelated question
</p>
</li>
<li> <p><code>"mix.exp"</code>: 2-valued vector - Prob. to respond to sensitive 
question and mean of the masking exponential distribution of the 
unrelated question
</p>
</li>
<li> <p><code>"mix.unknown"</code>: 2-valued vector - Prob. of responding to 
sensitive question in group 1 and 2, respectively
</p>
</li></ul>



<h3>Value</h3>

<p>an <code>RRuni</code> object, can by analyzed by using <code><a href="base.html#topic+summary">summary</a></code>
</p>


<h3>See Also</h3>

<p><code>vignette('RRreg')</code> or 
<a href="https://www.dwheck.de/vignettes/RRreg.html">https://www.dwheck.de/vignettes/RRreg.html</a> for a 
detailed description of the RR models and the appropriate definition of <code>p</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate responses of 1000 people according to Warner's model
# with an underlying true proportion of .3
df &lt;- RRgen(n = 1000, pi = .3, model = "Warner", p = .7)
head(df)

# Analyse univariate data to estimate prevalence 'pi'
estimate &lt;- RRuni(response = df$response, model = "Warner", p = .7)
summary(estimate)

# Generate data in line with the Stochastic Lie Detector
# assuming that 90% of the respondents answer truthfully
df2 &lt;- RRgen(
  n = 1000, pi = .3, model = "SLD", p = c(.2, .8),
  complyRates = c(.8, 1), groupRatio = 0.4
)
estimate2 &lt;- RRuni(
  response = df2$response, model = "SLD",
  p = c(.2, .8), group = df2$group
)
summary(estimate2)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
