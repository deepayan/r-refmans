<!DOCTYPE html><html lang="en-US"><head><title>Help for package teal.logger</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {teal.logger}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#teal.logger-package'><p>teal.logger: Logging Setup for the 'teal' Family of Packages</p></a></li>
<li><a href='#get_val'><p>Get value from environmental variable or R option or default in that order if the previous one is missing.</p></a></li>
<li><a href='#layout_teal_glue_generator'><p>Generate log layout function using common variables available via glue syntax including shiny session token</p></a></li>
<li><a href='#log_shiny_input_changes'><p>Auto logging input changes in Shiny app</p></a></li>
<li><a href='#log_system_info'><p>Logs the basic information about the session.</p></a></li>
<li><a href='#register_handlers'><p>Register handlers for logging messages, warnings and errors</p></a></li>
<li><a href='#register_logger'><p>Registers a logger instance in a given logging namespace.</p></a></li>
<li><a href='#suppress_logs'><p>Suppress logger logs</p></a></li>
<li><a href='#teal_logger_formatter'><p>Teal <code>log_formatter</code></p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Logging Setup for the 'teal' Family of Packages</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2025-02-13</td>
</tr>
<tr>
<td>Description:</td>
<td>Utilizing the 'logger' framework to record events within a
    package, specific to 'teal' family of packages.  Supports logging
    namespaces, hierarchical logging, various log destinations,
    vectorization, and more.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.apache.org/licenses/LICENSE-2.0">Apache License 2.0</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://insightsengineering.github.io/teal.logger/">https://insightsengineering.github.io/teal.logger/</a>,
<a href="https://github.com/insightsengineering/teal.logger/">https://github.com/insightsengineering/teal.logger/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/insightsengineering/teal.logger/issues">https://github.com/insightsengineering/teal.logger/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6)</td>
</tr>
<tr>
<td>Imports:</td>
<td>glue (&ge; 1.0.0), lifecycle (&ge; 0.2.0), logger (&ge; 0.3.0),
methods, shiny (&ge; 1.6.0), utils, withr (&ge; 2.1.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr (&ge; 1.42), rmarkdown (&ge; 2.23), testthat (&ge; 3.1.7)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>RdMacros:</td>
<td>lifecycle</td>
</tr>
<tr>
<td>Config/Needs/verdepcheck:</td>
<td>tidyverse/glue, r-lib/lifecycle,
daroczig/logger, rstudio/shiny, r-lib/withr, yihui/knitr,
rstudio/rmarkdown, r-lib/testthat</td>
</tr>
<tr>
<td>Config/Needs/website:</td>
<td>insightsengineering/nesttemplate</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-02-13 22:47:58 UTC; unardid</td>
</tr>
<tr>
<td>Author:</td>
<td>Dawid Kaledkowski [aut, cre],
  Konrad Pagacz [aut],
  F. Hoffmann-La Roche AG [cph, fnd]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Dawid Kaledkowski &lt;dawid.kaledkowski@roche.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-02-14 05:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='teal.logger-package'>teal.logger: Logging Setup for the 'teal' Family of Packages</h2><span id='topic+teal.logger'></span><span id='topic+teal.logger-package'></span>

<h3>Description</h3>

<p>Logging Setup for the <code>teal</code> Family of Packages.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Dawid Kaledkowski <a href="mailto:dawid.kaledkowski@roche.com">dawid.kaledkowski@roche.com</a>
</p>
<p>Authors:
</p>

<ul>
<li><p> Konrad Pagacz
</p>
</li></ul>

<p>Other contributors:
</p>

<ul>
<li><p> F. Hoffmann-La Roche AG [copyright holder, funder]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://insightsengineering.github.io/teal.logger/">https://insightsengineering.github.io/teal.logger/</a>
</p>
</li>
<li> <p><a href="https://github.com/insightsengineering/teal.logger/">https://github.com/insightsengineering/teal.logger/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/insightsengineering/teal.logger/issues">https://github.com/insightsengineering/teal.logger/issues</a>
</p>
</li></ul>


<hr>
<h2 id='get_val'>Get value from environmental variable or R option or default in that order if the previous one is missing.</h2><span id='topic+get_val'></span>

<h3>Description</h3>

<p>Get value from environmental variable or R option or default in that order if the previous one is missing.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_val(env_var_name, option_name, default = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_val_+3A_env_var_name">env_var_name</code></td>
<td>
<p>(<code>character(1)</code>) name of the system variable</p>
</td></tr>
<tr><td><code id="get_val_+3A_option_name">option_name</code></td>
<td>
<p>(<code>character(1)</code>) name of the option</p>
</td></tr>
<tr><td><code id="get_val_+3A_default">default</code></td>
<td>
<p>optional, default value if both <code>Sys.getenv(env_var_name)</code> and <code>getOption(option_name)</code> are empty</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of any class
</p>

<hr>
<h2 id='layout_teal_glue_generator'>Generate log layout function using common variables available via glue syntax including shiny session token</h2><span id='topic+layout_teal_glue_generator'></span>

<h3>Description</h3>

<p>Generate log layout function using common variables available via glue syntax including shiny session token
</p>


<h3>Usage</h3>

<pre><code class='language-R'>layout_teal_glue_generator(layout)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="layout_teal_glue_generator_+3A_layout">layout</code></td>
<td>
<p>(<code>character(1)</code>)<br />
the log layout. Alongside the standard logging variables provided by the <code>logging</code> package
(e.g. <code>pid</code>) the <code>token</code> variable can be used which will write the last 8 characters of the
shiny session token to the log.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>this function behaves in the same way as <code><a href="logger.html#topic+layout_glue_generator">logger::layout_glue_generator()</a></code>
but allows the shiny session token (last 8 chars) to be included in the logging layout
</p>


<h3>Value</h3>

<p>function taking <code>level</code> and <code>msg</code> arguments - keeping the original call creating the generator
in the generator attribute that is returned when calling log_layout for the currently used layout
</p>

<hr>
<h2 id='log_shiny_input_changes'>Auto logging input changes in Shiny app</h2><span id='topic+log_shiny_input_changes'></span>

<h3>Description</h3>

<p>This is to be called in the <code>server</code> section of the Shiny app.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>log_shiny_input_changes(
  input,
  namespace = NA_character_,
  excluded_inputs = character(),
  excluded_pattern = "_width$",
  session = shiny::getDefaultReactiveDomain()
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="log_shiny_input_changes_+3A_input">input</code></td>
<td>
<p>passed from Shiny <code>server</code></p>
</td></tr>
<tr><td><code id="log_shiny_input_changes_+3A_namespace">namespace</code></td>
<td>
<p>(<code>character(1)</code>) the name of the namespace</p>
</td></tr>
<tr><td><code id="log_shiny_input_changes_+3A_excluded_inputs">excluded_inputs</code></td>
<td>
<p>(<code>character</code>) character vector of input names to exclude from logging</p>
</td></tr>
<tr><td><code id="log_shiny_input_changes_+3A_excluded_pattern">excluded_pattern</code></td>
<td>
<p>(<code>character(1)</code>) <code>regexp</code> pattern of names to be excluded from logging</p>
</td></tr>
<tr><td><code id="log_shiny_input_changes_+3A_session">session</code></td>
<td>
<p>the Shiny session</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function having very similar behavior as <code><a href="logger.html#topic+log_shiny_input_changes">logger::log_shiny_input_changes()</a></code> but adjusted for <code>teal</code> needs.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(shiny)

ui &lt;- bootstrapPage(
  numericInput("mean1", "mean1", 0),
  numericInput("mean2", "mean2", 0),
  numericInput("sd", "sd", 1),
  textInput("title", "title", "title"),
  textInput("foo", "This is not used at all, still gets logged", "foo"),
  passwordInput("password", "Password not to be logged", "secret"),
  plotOutput("plot")
)

server &lt;- function(input, output) {
  log_shiny_input_changes(input, excluded_inputs = "password", excluded_pattern = "mean")

  output$plot &lt;- renderPlot({
    hist(rnorm(1e3, input$mean1, input$sd), main = input$title)
  })
}

shinyApp(ui = ui, server = server)

## End(Not run)
</code></pre>

<hr>
<h2 id='log_system_info'>Logs the basic information about the session.</h2><span id='topic+log_system_info'></span>

<h3>Description</h3>

<p>Logs the basic information about the session.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>log_system_info()
</code></pre>


<h3>Value</h3>

<p><code>invisible(NULL)</code>
</p>

<hr>
<h2 id='register_handlers'>Register handlers for logging messages, warnings and errors</h2><span id='topic+register_handlers'></span>

<h3>Description</h3>

<p>Register handlers for logging messages, warnings and errors
</p>


<h3>Usage</h3>

<pre><code class='language-R'>register_handlers(namespace, package = namespace)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="register_handlers_+3A_namespace">namespace</code></td>
<td>
<p>(<code>character(1)</code>) the logger namespace</p>
</td></tr>
<tr><td><code id="register_handlers_+3A_package">package</code></td>
<td>
<p>(<code>character(1)</code>) the package name</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function registers global handlers for messages, warnings and errors.
The handlers will investigate the call stack and if it contains a function
from the package, the message, warning or error will be logged into the respective
namespace.
</p>
<p>The handlers are registered only once per package and type. Consecutive calls will no effect.
Registering handlers for package <code>base</code> is not supported.
</p>
<p>Use <code>TEAL.LOG_MUFFLE</code> environmental variable or <code>teal.log_muffle</code> R option to optionally
control recover strategies. If <code>TRUE</code> (a default value) then the handler will jump to muffle
restart for a given type of condition and doesn't continue (with output to the console).
Applicable for message and warning types only. The errors won't be suppressed.
</p>


<h3>Value</h3>

<p><code>NULL</code> invisibly. Called for its side effects.
</p>


<h3>Note</h3>

<p>Registering handlers is forbidden within <code>tryCatch()</code> or <code>withCallingHandlers()</code>.
Because of this, handlers are registered only if it is possible.
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+globalCallingHandlers">globalCallingHandlers()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
register_handlers("teal.logger")
# see the outcome
globalCallingHandlers()

## End(Not run)
</code></pre>

<hr>
<h2 id='register_logger'>Registers a logger instance in a given logging namespace.</h2><span id='topic+register_logger'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>register_logger(namespace = NA_character_, layout = NULL, level = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="register_logger_+3A_namespace">namespace</code></td>
<td>
<p>(<code>character(1)</code> or <code>NA_character_</code>)<br />
the name of the logging namespace</p>
</td></tr>
<tr><td><code id="register_logger_+3A_layout">layout</code></td>
<td>
<p>(<code>character(1)</code>)<br />
the log layout. Alongside the standard logging variables provided by the <code>logging</code> package
(e.g. <code>pid</code>) the <code>token</code> variable can be used which will write the last 8 characters of the
shiny session token to the log.</p>
</td></tr>
<tr><td><code id="register_logger_+3A_level">level</code></td>
<td>
<p>(<code>character(1)</code> or <code>call</code>) the log level. Can be passed as
character or one of the <code>logger</code>'s objects.
See <code><a href="logger.html#topic+log_threshold">logger::log_threshold()</a></code> for more information.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Creates a new logging namespace specified by the <code>namespace</code> argument.
When the <code>layout</code> and <code>level</code> arguments are set to <code>NULL</code> (default), the function
gets the values for them from system variables or R options.
When deciding what to use (either argument, an R option or system variable), the function
picks the first non <code>NULL</code> value, checking in order:
</p>

<ol>
<li><p> Function argument.
</p>
</li>
<li><p> System variable.
</p>
</li>
<li><p> R option.
</p>
</li></ol>

<p><code>layout</code> and <code>level</code> can be set as system environment variables, respectively:
</p>

<ul>
<li> <p><code>teal.log_layout</code> as <code>TEAL.LOG_LAYOUT</code>,
</p>
</li>
<li> <p><code>teal.log_level</code> as <code>TEAL.LOG_LEVEL</code>.
</p>
</li></ul>

<p>If neither the argument nor the environment variable is set the function uses the following R options:
</p>

<ul>
<li> <p><code>options(teal.log_layout)</code>, which is passed to <code><a href="logger.html#topic+layout_glue_generator">logger::layout_glue_generator()</a></code>,
</p>
</li>
<li> <p><code>options(teal.log_level)</code>, which is passed to <code><a href="logger.html#topic+log_threshold">logger::log_threshold()</a></code>
</p>
</li></ul>

<p>The logs are output to <code>stdout</code> by default. Check <code>logger</code> for more information
about layouts and how to use <code>logger</code>.
</p>


<h3>Value</h3>

<p><code>invisible(NULL)</code>
</p>


<h3>Note</h3>

<p>It's a thin wrapper around the <code>logger</code> package.
</p>


<h3>See Also</h3>

<p>The package vignettes for more help: <code>browseVignettes("teal.logger")</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>options(teal.log_layout = "{msg}")
options(teal.log_level = "ERROR")
register_logger(namespace = "new_namespace")

logger::log_info("Hello from new_namespace", namespace = "new_namespace")


</code></pre>

<hr>
<h2 id='suppress_logs'>Suppress logger logs</h2><span id='topic+suppress_logs'></span>

<h3>Description</h3>

<p>This function suppresses <code>logger</code> when running tests via <code>testthat</code>.
To suppress logs for a single test, add this function
call within the <code>testthat::test_that</code> expression. To suppress logs for an entire
test file, call this function at the start of the file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>suppress_logs()
</code></pre>


<h3>Value</h3>

<p><code>NULL</code> invisible
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
testthat::test_that("An example test", {
  suppress_logs()
  testthat::expect_true(TRUE)
})

</code></pre>

<hr>
<h2 id='teal_logger_formatter'>Teal <code>log_formatter</code></h2><span id='topic+teal_logger_formatter'></span><span id='topic+teal_logger_transformer'></span>

<h3>Description</h3>

<p>Custom <code>log_formatter</code> supporting atomic vectors. By default <code>glue::glue</code>
returns n-element vector when vector is provided as an input. This function
generates <code>"[elem1, elem2, ...]"</code> for atomic vectors. Function also handles
<code>NULL</code> value which normally causes <code>logger</code> to return empty character.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>teal_logger_formatter()

teal_logger_transformer(text, envir)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="teal_logger_formatter_+3A_text">text</code></td>
<td>
<p>Text (typically) R code to parse and evaluate.</p>
</td></tr>
<tr><td><code id="teal_logger_formatter_+3A_envir">envir</code></td>
<td>
<p>environment to evaluate the code in</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing. Called for its side effects.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
