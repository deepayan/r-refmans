<!DOCTYPE html><html><head><title>Help for package envoutliers</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {envoutliers}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#boxcoxTransform'><p>Box-Cox transformation of data - Only intended for developer use</p></a></li>
<li><a href='#changepoint'><p>Changepoint analysis - Only intended for developer use</p></a></li>
<li><a href='#changepoint.plot'><p>Changepoint outlier detection plot - Only intended for developer use</p></a></li>
<li><a href='#chebyshev.inequality.detect'><p>Chebyshev inequality based identification of outliers on segments - Only intended for developer use</p></a></li>
<li><a href='#control.limits.R'><p>Limits for control chart <em>R</em> - Only intended for developer use</p></a></li>
<li><a href='#control.limits.s'><p>Limits for control chart <em>s</em> - Only intended for developer use</p></a></li>
<li><a href='#control.limits.x'><p>Limits for control chart <em>x</em> - Only intended for developer use</p></a></li>
<li><a href='#controlchart.plot'><p>Control chart outliers detection plot - Only intended for developer use</p></a></li>
<li><a href='#EV.plot'><p>Extreme value outlier detection plot - Only intended for developer use</p></a></li>
<li><a href='#extremal.index.censored'><p>Extremal index estimation (Holesovsky and Fusek, 2020) - Only intended for developer use</p></a></li>
<li><a href='#extremal.index.gomes'><p>Extremal index estimation (Gomes, 1993) - Only intended for developer use</p></a></li>
<li><a href='#extremal.index.intervals'><p>Extremal index estimation (Ferro and Segers, 2003) - Only intended for developer use</p></a></li>
<li><a href='#extremal.index.Kgaps'><p>Extremal index estimation (Suveges and Davison, 2010) - Only intended for developer use</p></a></li>
<li><a href='#extremal.index.runs'><p>Extremal index estimation (Smith and Weissman, 1994) - Only intended for developer use</p></a></li>
<li><a href='#extremal.index.sliding.blocks'><p>Extremal index estimation (Northrop, 2015) - Only intended for developer use</p></a></li>
<li><a href='#find.alpha'><p>Parameter <em>alpha</em> for Quantiles of normal distribution based outlier detection - Only intended for developer use</p></a></li>
<li><a href='#find.L'><p>Parameter L for Chebyshev inequality based outlier detection - Only intended for developer use</p></a></li>
<li><a href='#get.norm'><p>Table of Control Charts Constants - Only intended for developer use</p></a></li>
<li><a href='#grubbs.detect'><p>Grubbs test based identification of outliers on segments - Only intended for developer use</p></a></li>
<li><a href='#grubbs.test'><p>Outlier detection using Grubbs test - Only intended for developer use</p></a></li>
<li><a href='#KRDetect.outliers.changepoint'><p>Identification of outliers using changepoint analysis</p></a></li>
<li><a href='#KRDetect.outliers.controlchart'><p>Identification of outliers using control charts</p></a></li>
<li><a href='#KRDetect.outliers.EV'><p>Identification of outliers using extreme value theory</p></a></li>
<li><a href='#KRDetect.outliers.plot'><p>Outlier detection plot</p></a></li>
<li><a href='#mc.left'><p>Left medcouple (LMC) - Only intended for developer use</p></a></li>
<li><a href='#mc.right'><p>Right medcouple (RMC) - Only intended for developer use</p></a></li>
<li><a href='#mc.test'><p>Robust medcouple MC-LR test - Only intended for developer use</p></a></li>
<li><a href='#Moment.gpd.fit'><p>Moment estimates of GP distribution parameters - Only intended for developer use</p></a></li>
<li><a href='#MRL.plot'><p>Mean residual life (MRL) plot</p></a></li>
<li><a href='#normal.distr.quantiles.detect'><p>Normal distribution based identification of outliers on segments - Only intended for developer use</p></a></li>
<li><a href='#plot.KRDetect'><p>Outlier detection plot</p></a></li>
<li><a href='#return.level.est'><p>Return level estimation - Only intended for developer use</p></a></li>
<li><a href='#segment.length.control'><p>Segment length control - Only intended for developer use</p></a></li>
<li><a href='#smoothing'><p>Kernel regression smoothing</p></a></li>
<li><a href='#stability.plot'><p>Stability plot</p></a></li>
<li><a href='#summary.KRDetect'><p>Summary of the outlier detection results</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Methods for Identification of Outliers in Environmental Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Three semi-parametric methods for detection of outliers in environmental data based on kernel regression and subsequent analysis of smoothing residuals. The first method (Campulova, Michalek, Mikuska and Bokal (2018) &lt;<a href="https://doi.org/10.1002%2Fcem.2997">doi:10.1002/cem.2997</a>&gt;) analyzes the residuals using changepoint analysis, the second method is based on control charts (Campulova, Veselik and Michalek (2017) &lt;<a href="https://doi.org/10.1016%2Fj.apr.2017.01.004">doi:10.1016/j.apr.2017.01.004</a>&gt;) and the third method (Holesovsky, Campulova and Michalek (2018) &lt;<a href="https://doi.org/10.1016%2Fj.apr.2017.06.005">doi:10.1016/j.apr.2017.06.005</a>&gt;) analyzes the residuals using extreme value theory (Holesovsky, Campulova and Michalek (2018) &lt;<a href="https://doi.org/10.1016%2Fj.apr.2017.06.005">doi:10.1016/j.apr.2017.06.005</a>&gt;).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Imports:</td>
<td>MASS, car, changepoint, ecp, graphics, ismev, lokern,
robustbase, stats</td>
</tr>
<tr>
<td>Suggests:</td>
<td>openair</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-05-07 14:29:35 UTC; roman</td>
</tr>
<tr>
<td>Author:</td>
<td>Martina Campulova [cre],
  Martina Campulova [aut],
  Roman Campula [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Martina Campulova &lt;martina.campulova@mendelu.cz&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-05-07 15:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='boxcoxTransform'>Box-Cox transformation of data - Only intended for developer use</h2><span id='topic+boxcoxTransform'></span>

<h3>Description</h3>

<p>Performs Box-Cox power transformation of the data. The optimal value of power parameter is selected based on profile log-likelihoods.
The function is called by <code><a href="#topic+KRDetect.outliers.changepoint">KRDetect.outliers.changepoint</a></code> and is not intended for use by regular users of the package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>boxcoxTransform(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="boxcoxTransform_+3A_x">x</code></td>
<td>
<p>a numeric vector of data values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function computes the Box-Cox power transformation of the data.
The function is exported for developer use only. It does not perform any checks on inputs since it is only a convenience function for a transformation of data to normality.
The optimal value of a power parameter is estimated based on profile log-likelihoods calculated using <code>boxcox</code> function implemented in <span class="pkg">MASS</span> package.
</p>


<h3>Value</h3>

<p>A list is returned with elements:
</p>
<table>
<tr><td><code>lambda</code></td>
<td>
<p>a numeric value giving power parameter</p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p>a numeric vector of data values</p>
</td></tr>
<tr><td><code>x.transformed</code></td>
<td>
<p>a numeric vector of transformed data</p>
</td></tr>
</table>


<h3>References</h3>

<p>Box G, Cox D (1964). An analysis of transformations. Journal of the Royal Statistical Society: Series B, 26, 211â€“234.
</p>
<p>Venables WN, Ripley BD (2002). Modern Applied Statistics with S. New York, fourth edition. ISBN 0-387-95457-0, URL http://www.stats.ox.ac.uk/pub/MASS4.
</p>

<hr>
<h2 id='changepoint'>Changepoint analysis - Only intended for developer use</h2><span id='topic+changepoint'></span>

<h3>Description</h3>

<p>Performs changepoint analysis using PELT algorithm or A Nonparametric Approach for Multiple Changepoints.
The function is called by <code><a href="#topic+KRDetect.outliers.changepoint">KRDetect.outliers.changepoint</a></code> and is not intended for use by regular users of the package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>changepoint(x, cp.analysis.type, pen.value, alpha.edivisive)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="changepoint_+3A_x">x</code></td>
<td>
<p>a numeric vector of data values.</p>
</td></tr>
<tr><td><code id="changepoint_+3A_cp.analysis.type">cp.analysis.type</code></td>
<td>
<p>a character string specifying the type of changepoint analysis
</p>
<p>Possible options are
</p>

<ul>
<li><p><code>"parametric"</code> to perform changepoint analysis using PELT algorithm (Killick et al., 2012)
</p>
</li>
<li><p><code>"nonparametric"</code> to perform a nonparametric approach for multiple changepoins (Matteson and James, 2014)
</p>
</li></ul>
</td></tr>
<tr><td><code id="changepoint_+3A_pen.value">pen.value</code></td>
<td>
<p>A character string giving the formula for manual penalty used in PELT algorithm.
Only required for <code>cp.analysis.type = "parametric"</code>.</p>
</td></tr>
<tr><td><code id="changepoint_+3A_alpha.edivisive">alpha.edivisive</code></td>
<td>
<p>a numeric value giving the moment index used for determining the distance between and within segments in the nonparametric changepoint model.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function performs changepoint analysis using parametric or nonparametric approach.
The function is exported for developer use only. It does not perform any checks on inputs since it is only convenience function for partitioning smoothing residuals into homogeneous segments.
</p>


<h3>Value</h3>

<p>A list is returned with elements:
</p>
<table>
<tr><td><code>x</code></td>
<td>
<p>a numeric vector of data values</p>
</td></tr>
<tr><td><code>cp.segmet</code></td>
<td>
<p>an estimated integer membership vector for individual segments</p>
</td></tr>
</table>


<h3>References</h3>

<p>Killick R, Fearnhead P, Eckley IA (2012). Optimal detection of changepoints with a linear computational cost. Journal of the American Statistical Association, 107(500), 1590â€“1598.
</p>
<p>Matteson D, James N (2014). A Nonparametric Approach for Multiple Change Point Analysis of Multivariate Data. Journal of the American Statistical Association, 109(505), 334â€“345.
</p>
<p>Nicholas A. James, David S. Matteson (2014). ecp: An R Package for Nonparametric Multiple Change Point Analysis of Multivariate Data. Journal of Statistical Software, 62(7), 1-25, URL &quot;http://www.jstatsoft.org/v62/i07/&quot;.
</p>
<p>Killick R, Haynes K, Eckley IA (2016). changepoint: An R package for changepoint analysis. R package version 2.2.2, &lt;URL: https://CRAN.R-project.org/package=changepoint&gt;.
</p>

<hr>
<h2 id='changepoint.plot'>Changepoint outlier detection plot - Only intended for developer use</h2><span id='topic+changepoint.plot'></span>

<h3>Description</h3>

<p>Plot of results obtained using function <code><a href="#topic+KRDetect.outliers.changepoint">KRDetect.outliers.changepoint</a></code> for identification of outliers using changepoint analysis.
The function is called by <code><a href="#topic+plot.KRDetect">plot.KRDetect</a></code> and is not intended for use by regular users of the package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>changepoint.plot(x, show.segments, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="changepoint.plot_+3A_x">x</code></td>
<td>
<p>a list obtained as an output of function <code><a href="#topic+KRDetect.outliers.changepoint">KRDetect.outliers.changepoint</a></code> for identification of outliers using changepoint analysis.</p>
</td></tr>
<tr><td><code id="changepoint.plot_+3A_show.segments">show.segments</code></td>
<td>
<p>a logical variable specifying if vertical lines representing individual segments are plotted.</p>
</td></tr>
<tr><td><code id="changepoint.plot_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to the <code><a href="graphics.html#topic+plot">plot</a></code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function plots the results obtained using function <code><a href="#topic+KRDetect.outliers.changepoint">KRDetect.outliers.changepoint</a></code> identificating outliers using changepoint analysis based method.
The function is exported for developer use only. It does not perform any checks on inputs since it is only convenience function for plotting results obtained using functions implemented in package <span class="pkg">envoutliers</span>.
</p>

<hr>
<h2 id='chebyshev.inequality.detect'>Chebyshev inequality based identification of outliers on segments - Only intended for developer use</h2><span id='topic+chebyshev.inequality.detect'></span>

<h3>Description</h3>

<p>Identification of outlier data values on individual homogeneous segments using Chebyshev inequality.
The function is called by <code><a href="#topic+KRDetect.outliers.changepoint">KRDetect.outliers.changepoint</a></code> and is not intended for use by regular users of the package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chebyshev.inequality.detect(x, cp.segment, L.default)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="chebyshev.inequality.detect_+3A_x">x</code></td>
<td>
<p>a numeric vector of data.</p>
</td></tr>
<tr><td><code id="chebyshev.inequality.detect_+3A_cp.segment">cp.segment</code></td>
<td>
<p>an integer membership vector for individual segments.</p>
</td></tr>
<tr><td><code id="chebyshev.inequality.detect_+3A_l.default">L.default</code></td>
<td>
<p>a numeric value of <em>L</em> parameter determining the criterion for outlier detection:
the limits for outlier observations on individual segments are set as <code class="reqn">+/- L * sample standard deviation of data on the corresponding segment</code>
If <code>L.default = NULL</code>, its value on individual segments is estimated using Algorithm A1 (Campulova et al., 2018).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function detects outlier observations on individual segments using Chebyshev inequality.
The function is exported for developer use only. It does not perform any checks on inputs since it is only convenience function for identification of outlier residuals.
</p>


<h3>Value</h3>

<p>A list is returned with elements:
</p>
<table>
<tr><td><code>L</code></td>
<td>
<p>a numeric vector of <em>L</em> parameters used for outlier identification on individual segments</p>
</td></tr>
<tr><td><code>outlier</code></td>
<td>
<p>a logical vector specifing the identified outliers, <code>TRUE</code> means that corresponding data value from vector <code>x</code> is detected as outlier</p>
</td></tr>
</table>


<h3>References</h3>

<p>Campulova M, Michalek J, Mikuska P, Bokal D (2018). Nonparametric algorithm for identification of outliers in environmental data. Journal of Chemometrics, 32, 453-463.
</p>

<hr>
<h2 id='control.limits.R'>Limits for control chart <em>R</em> - Only intended for developer use</h2><span id='topic+control.limits.R'></span>

<h3>Description</h3>

<p>Estimation of limits of control chart <em>R</em>. The function is called by <code><a href="#topic+KRDetect.outliers.controlchart">KRDetect.outliers.controlchart</a></code> and is not intended for use by regular users of the package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>control.limits.R(x, group.size, L)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="control.limits.R_+3A_x">x</code></td>
<td>
<p>a numeric vector of data values.</p>
</td></tr>
<tr><td><code id="control.limits.R_+3A_group.size">group.size</code></td>
<td>
<p>a positive integer giving the number of observations in individual segments used for computation of control chart limits.
If the data can not be equidistantly divided, the first extra values will be excluded from the analysis.</p>
</td></tr>
<tr><td><code id="control.limits.R_+3A_l">L</code></td>
<td>
<p>a positive numeric value giving parameter <code>L</code> specifying the width of control limits.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function computes parameters based on which control chart <em>R</em> can be constructed.
The function is exported for developer use only. It does not perform any checks on inputs since it is only a convenience function for identification limits based on control chart <em>R</em>.
</p>


<h3>Value</h3>

<p>A list is returned with elements:
</p>
<table>
<tr><td><code>x</code></td>
<td>
<p>a numeric vector of data</p>
</td></tr>
<tr><td><code>range.est</code></td>
<td>
<p>a numeric value giving an estimate of range parameter</p>
</td></tr>
<tr><td><code>groups.count</code></td>
<td>
<p>a numeric value giving a number of segments used for estimating parameters of control chart</p>
</td></tr>
<tr><td><code>groups.range</code></td>
<td>
<p>a numeric vector giving sample ranges in individual segments used for estimating parameters of control chart</p>
</td></tr>
<tr><td><code>LCL</code></td>
<td>
<p>a numeric value giving lower control limit of control chart <em>R</em></p>
</td></tr>
<tr><td><code>UCL</code></td>
<td>
<p>a numeric value giving upper control limit of control chart <em>R</em></p>
</td></tr>
</table>


<h3>References</h3>

<p>Shewhart W (1931). Quality control chart. Bell System Technical Journal, 5, 593â€“603.
</p>
<p>SAS/QC User's Guide, Version 8, 1999. SAS Institute, Cary, N.C.
</p>
<p>Wild C, Seber G (2000). Chance encounters: A first course in data analysis and inference. New York: John Wiley.
</p>

<hr>
<h2 id='control.limits.s'>Limits for control chart <em>s</em> - Only intended for developer use</h2><span id='topic+control.limits.s'></span>

<h3>Description</h3>

<p>Estimation of limits of control chart <em>s</em>. The function is called by <code><a href="#topic+KRDetect.outliers.controlchart">KRDetect.outliers.controlchart</a></code> and is not intended for use by regular users of the package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>control.limits.s(x, group.size, L)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="control.limits.s_+3A_x">x</code></td>
<td>
<p>a numeric vector of data values.</p>
</td></tr>
<tr><td><code id="control.limits.s_+3A_group.size">group.size</code></td>
<td>
<p>a positive integer giving the number of observations in individual segments used for computation of control chart limits.
If the data can not be equidistantly divided, the first extra values will be excluded from the analysis.</p>
</td></tr>
<tr><td><code id="control.limits.s_+3A_l">L</code></td>
<td>
<p>a positive numeric value giving parameter <code>L</code> specifying the width of control limits.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function computes parameters based on which control chart <em>s</em> can be constructed.
The function is exported for developer use only. It does not perform any checks on inputs since it is only a convenience function for identification limits based on control chart <em>s</em>.
</p>


<h3>Value</h3>

<p>A list is returned with elements:
</p>
<table>
<tr><td><code>x</code></td>
<td>
<p>a numeric vector of data</p>
</td></tr>
<tr><td><code>sd.est</code></td>
<td>
<p>a numeric value giving an estimate of standard deviation parameter</p>
</td></tr>
<tr><td><code>groups.count</code></td>
<td>
<p>a numeric value giving a number of segments used for estimating parameters of control chart</p>
</td></tr>
<tr><td><code>groups.sd</code></td>
<td>
<p>a numeric vector giving sample standard deviations in individual segments used for estimating parameters of control chart</p>
</td></tr>
<tr><td><code>LCL</code></td>
<td>
<p>a numeric value giving lower control limit of control chart <em>s</em></p>
</td></tr>
<tr><td><code>UCL</code></td>
<td>
<p>a numeric value giving upper control limit of control chart <em>s</em></p>
</td></tr>
</table>


<h3>References</h3>

<p>Shewhart W (1931). Quality control chart. Bell System Technical Journal, 5, 593â€“603.
</p>
<p>SAS/QC User's Guide, Version 8, 1999. SAS Institute, Cary, N.C.
</p>
<p>Wild C, Seber G (2000). Chance encounters: A first course in data analysis and inference. New York: John Wiley.
</p>

<hr>
<h2 id='control.limits.x'>Limits for control chart <em>x</em> - Only intended for developer use</h2><span id='topic+control.limits.x'></span>

<h3>Description</h3>

<p>Estimation of limits of control chart <em>x</em>. The function is called by <code><a href="#topic+KRDetect.outliers.controlchart">KRDetect.outliers.controlchart</a></code> and is not intended for use by regular users of the package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>control.limits.x(x, method = "range", group.size, L)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="control.limits.x_+3A_x">x</code></td>
<td>
<p>a numeric vector of data values.</p>
</td></tr>
<tr><td><code id="control.limits.x_+3A_method">method</code></td>
<td>
<p>a character string specifying the preferred estimate of standard deviation parameter.
</p>
<p>Possible options are
</p>

<ul>
<li><p><code>"range"</code> for estimation based on sample ranges
</p>
</li>
<li><p><code>"sd"</code> for estimation based on sample standard deviations
</p>
</li></ul>
</td></tr>
<tr><td><code id="control.limits.x_+3A_group.size">group.size</code></td>
<td>
<p>a positive integer giving the number of observations in individual segments used for computation of control chart limits.
If the data can not be equidistantly divided, the first extra values will be excluded from the analysis.</p>
</td></tr>
<tr><td><code id="control.limits.x_+3A_l">L</code></td>
<td>
<p>a positive numeric value giving parameter <code>L</code> specifying the width of control limits.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function computes parameters based on which control chart <em>x</em> can be constructed.
The function is exported for developer use only. It does not perform any checks on inputs since it is only a convenience function for identification limits based on control chart <em>x</em>.
</p>


<h3>Value</h3>

<p>A list is returned with elements:
</p>
<table>
<tr><td><code>x</code></td>
<td>
<p>a numeric vector of data</p>
</td></tr>
<tr><td><code>mean</code></td>
<td>
<p>a numeric value giving sample mean of vector <code>x</code></p>
</td></tr>
<tr><td><code>groups.count</code></td>
<td>
<p>a numeric value giving a number of segments used for estimating parameters of control chart</p>
</td></tr>
<tr><td><code>groups.mean</code></td>
<td>
<p>a numeric vector giving sample means in individual segments used for estimating parameters of control chart</p>
</td></tr>
<tr><td><code>LCL</code></td>
<td>
<p>numeric value giving lower control limit of control chart <em>x</em></p>
</td></tr>
<tr><td><code>UCL</code></td>
<td>
<p>numeric value giving upper control limit of control chart <em>s</em></p>
</td></tr>
</table>


<h3>References</h3>

<p>Shewhart W (1931). Quality control chart. Bell System Technical Journal, 5, 593â€“603.
</p>
<p>SAS/QC User's Guide, Version 8, 1999. SAS Institute, Cary, N.C.
</p>
<p>Wild C, Seber G (2000). Chance encounters: A first course in data analysis and inference. New York: John Wiley.
</p>

<hr>
<h2 id='controlchart.plot'>Control chart outliers detection plot - Only intended for developer use</h2><span id='topic+controlchart.plot'></span>

<h3>Description</h3>

<p>Plot of results obtained using function <code><a href="#topic+KRDetect.outliers.controlchart">KRDetect.outliers.controlchart</a></code> for identification of outliers using control charts.
The function is called by <code><a href="#topic+plot.KRDetect">plot.KRDetect</a></code> and is not intended for use by regular users of the package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>controlchart.plot(x, plot.type = "all", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="controlchart.plot_+3A_x">x</code></td>
<td>
<p>a list obtained as an output of function <code><a href="#topic+KRDetect.outliers.controlchart">KRDetect.outliers.controlchart</a></code> for identification of outliers using control charts.</p>
</td></tr>
<tr><td><code id="controlchart.plot_+3A_plot.type">plot.type</code></td>
<td>
<p>a type of plot with outliers displayed.
</p>
<p>Possible options are
</p>

<ul>
<li><p><code>"all"</code> to show outliers detected using control chart <em>x</em>, <em>R</em> and <em>s</em>
</p>
</li>
<li><p><code>"x"</code> to show outliers detected using control chart <em>x</em>
</p>
</li>
<li><p><code>"R"</code> to show outliers detected using control chart <em>R</em>
</p>
</li>
<li><p><code>"s"</code> to show outliers detected using control chart <em>s</em>
</p>
</li></ul>
</td></tr>
<tr><td><code id="controlchart.plot_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to the <code><a href="graphics.html#topic+plot">plot</a></code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function plots the results obtained using function <code><a href="#topic+KRDetect.outliers.controlchart">KRDetect.outliers.controlchart</a></code> identificating outliers using control charts.
The function is exported for developer use only. It does not perform any checks on inputs since it is only convenience function for plotting results obtained using functions implemented in package <span class="pkg">envoutliers</span>.
</p>

<hr>
<h2 id='EV.plot'>Extreme value outlier detection plot - Only intended for developer use</h2><span id='topic+EV.plot'></span>

<h3>Description</h3>

<p>Plot of results obtained using function <code><a href="#topic+KRDetect.outliers.EV">KRDetect.outliers.EV</a></code> for identification of outliers using extreme value theory.
The function is called by <code><a href="#topic+plot.KRDetect">plot.KRDetect</a></code> and is not intended for use by regular users of the package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EV.plot(x, plot.type = "all", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="EV.plot_+3A_x">x</code></td>
<td>
<p>a list obtained as an output of function <code><a href="#topic+KRDetect.outliers.EV">KRDetect.outliers.EV</a></code> for identification of outliers using extreme value theory.</p>
</td></tr>
<tr><td><code id="EV.plot_+3A_plot.type">plot.type</code></td>
<td>
<p>a type of plot with outliers displayed.
</p>
<p>Possible options are
</p>

<ul>
<li><p><code>"all"</code> to show outliers with both extremely low and high value
</p>
</li>
<li><p><code>"min"</code> to show outliers with extremely low value
</p>
</li>
<li><p><code>"max"</code> to show outliers with extremely high value
</p>
</li></ul>
</td></tr>
<tr><td><code id="EV.plot_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to the <code><a href="graphics.html#topic+plot">plot</a></code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function plots the results obtained using function <code><a href="#topic+KRDetect.outliers.EV">KRDetect.outliers.EV</a></code> identificating outliers using changepoint analysis based method.
The function is exported for developer use only. It does not perform any checks on inputs since it is only convenience function for plotting results obtained using functions implemented in package <span class="pkg">envoutliers</span>.
</p>

<hr>
<h2 id='extremal.index.censored'>Extremal index estimation (Holesovsky and Fusek, 2020) - Only intended for developer use</h2><span id='topic+extremal.index.censored'></span>

<h3>Description</h3>

<p>Estimation of an extremal index using the censored estimator suggested in (Holesovsky and Fusek, 2020).
The function is called by <code><a href="#topic+KRDetect.outliers.EV">KRDetect.outliers.EV</a></code> and is not intended for use by regular users of the package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extremal.index.censored(x, u, D)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extremal.index.censored_+3A_x">x</code></td>
<td>
<p>a numeric vector of observations.</p>
</td></tr>
<tr><td><code id="extremal.index.censored_+3A_u">u</code></td>
<td>
<p>a numeric value giving threshold.</p>
</td></tr>
<tr><td><code id="extremal.index.censored_+3A_d">D</code></td>
<td>
<p>a nonnegative integer giving the value of D parameter (Holesovsky and Fusek, 2020)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function computes the censored estimate of extremal index suggested in (Holesovsky and Fusek, 2020).
The function is exported for developer use only. It does not perform any checks on inputs since it is only convenience function used within <code><a href="#topic+KRDetect.outliers.EV">KRDetect.outliers.EV</a></code>.
</p>


<h3>Value</h3>

<p>a numeric value of an extremal index estimate
</p>


<h3>References</h3>

<p>Holesovsky, J, Fusek, M (2020). Estimation of the Extremal Index Using Censored Distributions. Extremes, DOI: 10.1007/s10687-020-00374-3.
</p>

<hr>
<h2 id='extremal.index.gomes'>Extremal index estimation (Gomes, 1993) - Only intended for developer use</h2><span id='topic+extremal.index.gomes'></span>

<h3>Description</h3>

<p>Estimation of an extremal index using the block maxima approach suggested by (Gomes, 1993).
The function is called by <code><a href="#topic+KRDetect.outliers.EV">KRDetect.outliers.EV</a></code> and is not intended for use by regular users of the package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extremal.index.gomes(x, block.length)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extremal.index.gomes_+3A_x">x</code></td>
<td>
<p>a numeric vector of observations.</p>
</td></tr>
<tr><td><code id="extremal.index.gomes_+3A_block.length">block.length</code></td>
<td>
<p>a numeric value giving the length of blocks.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function computes the estimate of extremal index suggested by (Gomes, 1993).
The function is exported for developer use only. It does not perform any checks on inputs since it is only convenience function used within <code><a href="#topic+KRDetect.outliers.EV">KRDetect.outliers.EV</a></code>.
</p>


<h3>Value</h3>

<p>A numeric value of an extremal index estimate
</p>


<h3>References</h3>

<p>Gomes M (1993). On the estimation of parameter of rare events in environmental time series. In Statistics for the Environment, volume 2 of Water Related Issues, pp. 225-241. Wiley.
</p>
<p>Heffernan JE, Stephenson AG (2016). ismev: An Introduction to Statistical Modeling of Extreme Values. R package version 1.41, URL http://CRAN.R-project.org/package=ismev.
</p>

<hr>
<h2 id='extremal.index.intervals'>Extremal index estimation (Ferro and Segers, 2003) - Only intended for developer use</h2><span id='topic+extremal.index.intervals'></span>

<h3>Description</h3>

<p>Estimation of an extremal index using the Intervals estimator suggested in (Ferro and Segers, 2003).
The function is called by <code><a href="#topic+KRDetect.outliers.EV">KRDetect.outliers.EV</a></code> and is not intended for use by regular users of the package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extremal.index.intervals(x, u)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extremal.index.intervals_+3A_x">x</code></td>
<td>
<p>a numeric vector of observations.</p>
</td></tr>
<tr><td><code id="extremal.index.intervals_+3A_u">u</code></td>
<td>
<p>a numeric value giving threshold</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function computes the estimate of extremal index suggested in (Ferro and Segers, 2003).
The function is exported for developer use only. It does not perform any checks on inputs since it is only convenience function used within <code><a href="#topic+KRDetect.outliers.EV">KRDetect.outliers.EV</a></code>.
</p>


<h3>Value</h3>

<p>a numeric value of an extremal index estimate
</p>


<h3>References</h3>

<p>Ferro, CAT, Segers, J (2003). Inference for Cluster of Extreme Values. Journal of Royal Statistical Society, Series B, 65(2), 545-556.
</p>

<hr>
<h2 id='extremal.index.Kgaps'>Extremal index estimation (Suveges and Davison, 2010) - Only intended for developer use</h2><span id='topic+extremal.index.Kgaps'></span>

<h3>Description</h3>

<p>Estimation of an extremal index using the K-gaps estimator suggested in (Suveges and Davison, 2010).
The function is called by <code><a href="#topic+KRDetect.outliers.EV">KRDetect.outliers.EV</a></code> and is not intended for use by regular users of the package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extremal.index.Kgaps(x, u, K)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extremal.index.Kgaps_+3A_x">x</code></td>
<td>
<p>a numeric vector of observations.</p>
</td></tr>
<tr><td><code id="extremal.index.Kgaps_+3A_u">u</code></td>
<td>
<p>a numeric value giving threshold.</p>
</td></tr>
<tr><td><code id="extremal.index.Kgaps_+3A_k">K</code></td>
<td>
<p>a nonnegative integer giving the value of K parameter (Suveges and Davison, 2010).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function computes the K-gaps estimate of extremal index suggested in (Suveges and Davison, 2010).
The function is exported for developer use only. It does not perform any checks on inputs since it is only convenience function used within <code><a href="#topic+KRDetect.outliers.EV">KRDetect.outliers.EV</a></code>.
</p>


<h3>Value</h3>

<p>a numeric value of an extremal index estimate
</p>


<h3>References</h3>

<p>Suveges, M, Davison, AC (2010). Model Misspecification in Peaks Over Threshold Analysis. The Annals of Applied Statistics, 4(1), 203-221.
</p>

<hr>
<h2 id='extremal.index.runs'>Extremal index estimation (Smith and Weissman, 1994) - Only intended for developer use</h2><span id='topic+extremal.index.runs'></span>

<h3>Description</h3>

<p>Estimation of an extremal index using the runs estimator suggested in (Smith and Weissman, 1994).
The function is called by <code><a href="#topic+KRDetect.outliers.EV">KRDetect.outliers.EV</a></code> and is not intended for use by regular users of the package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extremal.index.runs(x, u, r)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extremal.index.runs_+3A_x">x</code></td>
<td>
<p>a numeric vector of observations.</p>
</td></tr>
<tr><td><code id="extremal.index.runs_+3A_u">u</code></td>
<td>
<p>a numeric value giving threshold.</p>
</td></tr>
<tr><td><code id="extremal.index.runs_+3A_r">r</code></td>
<td>
<p>a positive integer giving the value of runs parameter (Smith and Weissman, 1994).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function computes the runs estimate of extremal index suggested in (Smith and Weissman, 1994).
The function is exported for developer use only. It does not perform any checks on inputs since it is only convenience function used within <code><a href="#topic+KRDetect.outliers.EV">KRDetect.outliers.EV</a></code>.
</p>


<h3>Value</h3>

<p>a numeric value of an extremal index estimate
</p>


<h3>References</h3>

<p>Smith, RL, Weissman, I (1994). Estimating the Extremal Index. Journal of the Royal Statistical Society, Series B, 56, 515-529.
</p>

<hr>
<h2 id='extremal.index.sliding.blocks'>Extremal index estimation (Northrop, 2015) - Only intended for developer use</h2><span id='topic+extremal.index.sliding.blocks'></span>

<h3>Description</h3>

<p>Estimation of an extremal index using the sliding blocks estimator suggested in (Northrop, 2015).
The function is called by <code><a href="#topic+KRDetect.outliers.EV">KRDetect.outliers.EV</a></code> and is not intended for use by regular users of the package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extremal.index.sliding.blocks(x, b = round(sqrt(length(x))))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extremal.index.sliding.blocks_+3A_x">x</code></td>
<td>
<p>a numeric vector of observations.</p>
</td></tr>
<tr><td><code id="extremal.index.sliding.blocks_+3A_b">b</code></td>
<td>
<p>a numeric value giving the length of blocks. Default is <code>b = round(sqrt(n))</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function computes the sliding blocks estimate of extremal index suggested in (Northrop, 2015).
The function is exported for developer use only. It does not perform any checks on inputs since it is only convenience function used within <code><a href="#topic+KRDetect.outliers.EV">KRDetect.outliers.EV</a></code>.
</p>


<h3>Value</h3>

<p>a numeric value of an extremal index estimate
</p>


<h3>References</h3>

<p>Northrop, PJ (2015). An Efficient Semiparametric Maxima Estimator of the Extremal Index. Extremes, 18, 585-603.
</p>

<hr>
<h2 id='find.alpha'>Parameter <em>alpha</em> for Quantiles of normal distribution based outlier detection - Only intended for developer use</h2><span id='topic+find.alpha'></span>

<h3>Description</h3>

<p>Finds the value of parameter <em>alpha</em> defining the criterion for outlier identification using quantiles of normal distribution. The parameter is found using Modified algorithm A1 (Campulova et al., 2018.)
The function is called by <code><a href="#topic+KRDetect.outliers.changepoint">KRDetect.outliers.changepoint</a></code> and is not intended for use by regular users of the package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>find.alpha(x, alpha.start = 0.05, eps = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="find.alpha_+3A_x">x</code></td>
<td>
<p>a numeric vector of data values.</p>
</td></tr>
<tr><td><code id="find.alpha_+3A_alpha.start">alpha.start</code></td>
<td>
<p>a numeric value giving the largest reasonable value of parameter <em>alpha</em>.</p>
</td></tr>
<tr><td><code id="find.alpha_+3A_eps">eps</code></td>
<td>
<p>a numeric value of the epsilon parameter. If <code>eps = NULL</code>, the value is calculated as recommended in Modified Algorithm A1 (Campulova et al., 2018).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function finds the value of parameter <em>alpha</em> defining the criterion for outlier identification using quantiles of normal distribution. The algorithm is based on Modified Algorithm A1 described in (Campulova et al., 2018).
Nonoutliers are characterised as a homogeneous set of data randomly distributed around zero value.
The differences between the data correspond to random fluctuations in the measurements.
The algorithm finds the value of the parameter by scanning possible values of <em>alpha</em> and investigating differences of the corresponding nonoutliers.
The idea is to choose alpha corresponding to the maximum change of the maximum difference found among the ordered nonoutlier data.
The function is exported for developer use only. It does not perform any checks on inputs since it is only convenience function for finding outlier residuals based on quantiles of normal distribution.
</p>


<h3>Value</h3>

<p>A numeric value giving the parameter <em>alpha</em>
</p>


<h3>References</h3>

<p>Campulova M, Michalek J, Mikuska P, Bokal D (2018). Nonparametric algorithm for identification of outliers in environmental data. Journal of Chemometrics, 32, 453-463.
</p>

<hr>
<h2 id='find.L'>Parameter L for Chebyshev inequality based outlier detection - Only intended for developer use</h2><span id='topic+find.L'></span>

<h3>Description</h3>

<p>Finds the value of parameter L defining the criterion for outlier identification using Chebyshev inequality. The parameter is found using Algorithm A1 (Campulova et al., 2018).
The function is called by <code><a href="#topic+KRDetect.outliers.changepoint">KRDetect.outliers.changepoint</a></code> and is not intended for use by regular users of the package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>find.L(x, L.start = 2.5, eps = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="find.L_+3A_x">x</code></td>
<td>
<p>a numeric vector of data values.</p>
</td></tr>
<tr><td><code id="find.L_+3A_l.start">L.start</code></td>
<td>
<p>a numeric value giving the smallest reasonable value of parameter <code>L</code>.</p>
</td></tr>
<tr><td><code id="find.L_+3A_eps">eps</code></td>
<td>
<p>A numeric value of the <em>epsilon</em> parameter. If <code>eps = NULL</code>, the value is calculated as recommended in Modified Algorithm A1 (Campulova et al., 2018).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function finds the value of parameter L defining the criterion for outlier identification using Chebyshev inequality. The algorithm is based on Algorithm A1 described in (Campulova et al., 2018).
Nonoutliers are characterised as a homogeneous set of data randomly distributed around zero value.
The differences between the data correspond to random fluctuations in the measurements.
The algorithm finds the value of the parameter by scanning possible values of <em>L</em> and investigating differences of the corresponding nonoutliers.
The idea is to choose <em>L</em> corresponding to the maximum change of the maximum difference found among the ordered nonoutlier data.
The function is exported for developer use only. It does not perform any checks on inputs since it is only a convenience function for finding outlier residuals based on Chebyshev inequality.
</p>


<h3>Value</h3>

<p>A numeric value giving the parameter <em>L</em>
</p>


<h3>References</h3>

<p>Campulova M, Michalek J, Mikuska P, Bokal D (2018). Nonparametric algorithm for identification of outliers in environmental data. Journal of Chemometrics, 32, 453-463.
</p>

<hr>
<h2 id='get.norm'>Table of Control Charts Constants - Only intended for developer use</h2><span id='topic+get.norm'></span>

<h3>Description</h3>

<p>Creation of Table of Control Chart Constants.
The function is called by <code><a href="#topic+control.limits.x">control.limits.x</a></code>, <code><a href="#topic+control.limits.R">control.limits.R</a></code> and <code><a href="#topic+control.limits.s">control.limits.s</a></code>. This function is not intended for use by regular users of the package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.norm()
</code></pre>


<h3>Details</h3>

<p>This function creates a table with columns giving constants for computation limits of control charts.
The function is exported for developer use only. It does not have any input parameters and does not perform any checks on inputs since it is only a convenience function for computing control chart limits.
</p>


<h3>Value</h3>

<p>data.frame whose columns are numeric vectors giving constants for control charts limits computation
</p>


<h3>References</h3>

<p>JOGLEKAR, Anand M. Statistical methods for six sigma: in R&amp;D and manufacturing. Hoboken, NJ: Wiley-Interscience. ISBN sbn0-471-20342-4.
</p>

<hr>
<h2 id='grubbs.detect'>Grubbs test based identification of outliers on segments - Only intended for developer use</h2><span id='topic+grubbs.detect'></span>

<h3>Description</h3>

<p>Identification of outlier data values on individual homogeneous segments using Grubbs test.
The function is called by <code><a href="#topic+KRDetect.outliers.changepoint">KRDetect.outliers.changepoint</a></code> and is not intended for use by regular users of the package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>grubbs.detect(x, cp.segment)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="grubbs.detect_+3A_x">x</code></td>
<td>
<p>a numeric vector of data.</p>
</td></tr>
<tr><td><code id="grubbs.detect_+3A_cp.segment">cp.segment</code></td>
<td>
<p>an integer membership vector for individual segments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function detects outlier observations on individual segments using Grubbs test.
The function is exported for developer use only. It does not perform any checks on inputs since it is only convenience function for identification of outlier residuals.
</p>


<h3>Value</h3>

<p>A logical vector specifing the identified outliers, <code>TRUE</code> means that corresponding data value from vector <code>x</code> is detected as outlier.
</p>


<h3>References</h3>

<p>Grubbs F (1950). Sample criteria for testing outlying observations. The Annals of Mathematical Statistics, 21(1), 27-58.
</p>
<p>Campulova M, Michalek J, Mikuska P, Bokal D (2018). Nonparametric algorithm for identification of outliers in environmental data. Journal of Chemometrics, 32, 453-463.
</p>

<hr>
<h2 id='grubbs.test'>Outlier detection using Grubbs test - Only intended for developer use</h2><span id='topic+grubbs.test'></span>

<h3>Description</h3>

<p>Sequential identification of outliers using Grubbs' test.
The algorithm first considers the data value with the highest absolute value. If the null hypothesis that such a value is not an outlier is rejected,
the considered value is detected as an outlier and excluded from further analysis. Subsequently, a value with the second-highest absolute value is considered, and its quality is again evaluated using the Grubbs test. This procedure is repeated until no outlier is detected.
The function is called by <code><a href="#topic+KRDetect.outliers.changepoint">KRDetect.outliers.changepoint</a></code> and <code><a href="#topic+grubbs.detect">grubbs.detect</a></code>. The function is not intended for use by regular users of the package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>grubbs.test(x, alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="grubbs.test_+3A_x">x</code></td>
<td>
<p>a numeric vector of data values.</p>
</td></tr>
<tr><td><code id="grubbs.test_+3A_alpha">alpha</code></td>
<td>
<p>a numeric value giving test significance level.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function sequentially identifies outlier data using Grubbs test.
The function is exported for developer use only. It does not perform any checks on inputs since it is only convenience function for identification of outlier residuals using Grubbs test.
</p>


<h3>Value</h3>

<p>A list is returned with elements:
</p>
<table>
<tr><td><code>result</code></td>
<td>
<p>A table containing information about identified outliers. The number of rows of the table corresponds to the number of identified outliers. The table has following columns: <code>index</code> - a numeric value giving the index of detected outlier in the original data, <code>value</code> - a numeric value of the identified outlier, <code>test.value</code> - a numeric value of the test statistics, <code>critical.value</code> - a numeric value giving the test statistics, <code>p.value</code> - a numeric value giving <em>p.value</em> of the test</p>
</td></tr>
<tr><td><code>outliers.exists</code></td>
<td>
<p>A logical value. <code>TRUE</code> means that at least one outlier was detected.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Grubbs F (1950). Sample criteria for testing outlying observations. The Annals of Mathematical Statistics, 21(1), 27-58.
</p>

<hr>
<h2 id='KRDetect.outliers.changepoint'>Identification of outliers using changepoint analysis</h2><span id='topic+KRDetect.outliers.changepoint'></span>

<h3>Description</h3>

<p>Identification of outliers in environmental data using method based on kernel smoothing, changepoint analysis of smoothing residuals and subsequent analysis of residuals on homogeneous segments (Campulova et al., 2018).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>KRDetect.outliers.changepoint(x, perform.smoothing = TRUE,
  perform.cp.analysis = TRUE, bandwidth.type = "local",
  bandwidth.value = NULL, kernel.order = 2,
  cp.analysis.type = "parametric", pen.value = "5*log(n)",
  alpha.edivisive = 0.3, min.segment.length = 30,
  segment.length.for.merge = 15, method = "auto",
  prefer.grubbs = TRUE, alpha.default = NULL, L.default = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="KRDetect.outliers.changepoint_+3A_x">x</code></td>
<td>
<p>data values.
Supported data types
</p>

<ul>
<li><p>a numeric vector
</p>
</li>
<li><p>a time series object <code>ts</code>
</p>
</li>
<li><p>a time series object <code>xts</code>
</p>
</li>
<li><p>a time series object <code>zoo</code>
</p>
</li></ul>
</td></tr>
<tr><td><code id="KRDetect.outliers.changepoint_+3A_perform.smoothing">perform.smoothing</code></td>
<td>
<p>a logical value specifying if data smoothing is performed. If <code>TRUE</code> (default), data are smoothed.</p>
</td></tr>
<tr><td><code id="KRDetect.outliers.changepoint_+3A_perform.cp.analysis">perform.cp.analysis</code></td>
<td>
<p>a logical value specifying if changepoint analysis is performed. If <code>TRUE</code> (default), smoothing residuals are partitioned into homogeneous segments.</p>
</td></tr>
<tr><td><code id="KRDetect.outliers.changepoint_+3A_bandwidth.type">bandwidth.type</code></td>
<td>
<p>a character string specifying the type of bandwidth.
</p>
<p>Possible options are
</p>

<ul>
<li><p><code>"local"</code> (default) to use local bandwidth
</p>
</li>
<li><p><code>"global"</code> to use global bandwidth
</p>
</li></ul>
</td></tr>
<tr><td><code id="KRDetect.outliers.changepoint_+3A_bandwidth.value">bandwidth.value</code></td>
<td>
<p>a local bandwidth array (for <code>bandwidth.type = "local"</code>) or global bandwidth value (for <code>bandwidth.type = "global"</code>) for kernel regression estimation. If <code>bandwidth.type = "NULL"</code> (default) a data-adaptive local plug-in (Herrmann, 1997) (for <code>bandwidth.type = "local"</code>) or data-adaptive global plug-in (Gasser et al., 1991) (for <code>bandwidth.type = "global"</code>) bandwidth is used instead.</p>
</td></tr>
<tr><td><code id="KRDetect.outliers.changepoint_+3A_kernel.order">kernel.order</code></td>
<td>
<p>a nonnegative integer giving the order of the optimal kernel (Gasser et al., 1985) used for smoothing.
</p>
<p>Possible options are
</p>

<ul>
<li><p><code>kernel.order = 2</code> (default)
</p>
</li>
<li><p><code>kernel.order = 4</code>
</p>
</li></ul>
</td></tr>
<tr><td><code id="KRDetect.outliers.changepoint_+3A_cp.analysis.type">cp.analysis.type</code></td>
<td>
<p>a character string specifying the type of changepoint analysis.
</p>
<p>Possible options are
</p>

<ul>
<li><p><code>"parametric"</code> (default) to perform changepoint analysis using PELT algorithm (Killick et al., 2012)
</p>
</li>
<li><p><code>"nonparametric"</code> to perform a nonparametric approach for multiple changepoins (Matteson and James, 2014)
</p>
</li></ul>
</td></tr>
<tr><td><code id="KRDetect.outliers.changepoint_+3A_pen.value">pen.value</code></td>
<td>
<p>a character string giving the formula for manual penalty used in PELT algorithm.
Only required for <code>cp.analysis.type = "parametric"</code>. Default is <code>pen.value = "5*log(n)"</code>.</p>
</td></tr>
<tr><td><code id="KRDetect.outliers.changepoint_+3A_alpha.edivisive">alpha.edivisive</code></td>
<td>
<p>a numeric value giving the moment index used for determining the distance between and within segments in nonparametric changepoint model. Default is <code>alpha.edivisive = 0.3</code>.</p>
</td></tr>
<tr><td><code id="KRDetect.outliers.changepoint_+3A_min.segment.length">min.segment.length</code></td>
<td>
<p>a numeric value giving minimal required number of observations on segments from changepoint analysis.
If a segment contains less than <code>min.segment.length</code> observations and the variances of data on the segment and the previous one are supposed to be equal (based on LeveneÂ´s test (Fox, 2016) for homogeneity of variances), the segment is merged with previous one.
Analogous, the first segment can be merged with the second one. Default is <code>min.segment.length = 30</code>.</p>
</td></tr>
<tr><td><code id="KRDetect.outliers.changepoint_+3A_segment.length.for.merge">segment.length.for.merge</code></td>
<td>
<p>a numeric value giving minimal required number of observations on segments for performing the homogeneity test within changepoint split control.
A segment with less data than <code>segment.length.for.merge</code> is merged with the previous one without testing the homogeneity of variances (the first segment is merged with the second one). Default is <code>min.segment.length.for.merge = 15</code>.</p>
</td></tr>
<tr><td><code id="KRDetect.outliers.changepoint_+3A_method">method</code></td>
<td>
<p>a character string specifying the method for identification of outlier residuals.
</p>
<p>Possible options are
</p>

<ul>
<li><p><code>"auto"</code> (default) for automatic selection based on the structure of the residuals
</p>
</li>
<li><p><code>"grubbs.test"</code> for Grubbs test
</p>
</li>
<li><p><code>"normal.distribution"</code> for quantiles of normal distribution
</p>
</li>
<li><p><code>"chebyshev.inequality"</code> for chebyshev inequality
</p>
</li></ul>
</td></tr>
<tr><td><code id="KRDetect.outliers.changepoint_+3A_prefer.grubbs">prefer.grubbs</code></td>
<td>
<p>a logical variable specyfing if Grubbs test for identification of outlier residuals is preferred to quantiles of normal distribution.
<code>TRUE</code> (default) means that Grubbs test is preferred. Only required for <code>method = "auto"</code>.</p>
</td></tr>
<tr><td><code id="KRDetect.outliers.changepoint_+3A_alpha.default">alpha.default</code></td>
<td>
<p>a numeric value from interval (0,1) of <em>alpha</em> parameter determining the criterion for (residual) outlier detection:
the limits for outlier residuals on individual segments are set as <code class="reqn">+/- (alpha/2-quantile of normal distribution with parameters corresponding to residuals on studied segment) * (sample standard deviation of residuals on corresponding segment)</code>.
If <code>alpha.default = NULL</code> (default), its value on individual segments is estimated using Modified Algorithm A1 (Campulova et al., 2018).</p>
</td></tr>
<tr><td><code id="KRDetect.outliers.changepoint_+3A_l.default">L.default</code></td>
<td>
<p>a numeric value of <em>L</em> parameter determining the criterion for outlier (residual) detection:
the limits for outlier residuals on individual segments are set as <code class="reqn">+/- L * sample standard deviation of residuals on corresponding segment</code>.
If <code>L.default = NULL</code> (default), its value on individual segments is estimated using Algorithm A1 (Campulova et al., 2018).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function identifies outliers in time series using procedure based on kernel smoothing, changepoint analysis of smoothing residuals and subsequent analysis of residuals on homogeneous segments (Campulova et al., 2018).
Three different approaches (Grubbs test, quantiles of normal distribution, Chebyshev inequality), that can be selected automatically based on data structure or specified by the user, can be used to detect outlier residuals.
Crucial for the method is the choice of parameters alpha and <em>L</em> for quantiles of normal distribution and Chebyshev inequality approach, that define the criterion for outlier detection. These values can be specified by the user
or estimated automatically using data driven algorithms (Campulova et al., 2018).
</p>


<h3>Value</h3>

<p>A <code>"KRDetect"</code> object which contains a list with elements:
</p>
<table>
<tr><td><code>method.type</code></td>
<td>
<p>a character string giving the type of method used for outlier idetification</p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p>a numeric vector of observations</p>
</td></tr>
<tr><td><code>index</code></td>
<td>
<p>a numeric vector of index design points assigned to individual observations</p>
</td></tr>
<tr><td><code>smoothed</code></td>
<td>
<p>a numeric vector of estimates of the kernel regression function (smoothed data)</p>
</td></tr>
<tr><td><code>changepoints</code></td>
<td>
<p>an integer membership vector for individual segments</p>
</td></tr>
<tr><td><code>normality.results</code></td>
<td>
<p>a data.frame of normality results of residuals on individual segments</p>
</td></tr>
<tr><td><code>detection.method</code></td>
<td>
<p>a character string giving the type of method used for identification of outlier residuals</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>a numeric vector of alpha parameters used for outlier identification on individual segments</p>
</td></tr>
<tr><td><code>L</code></td>
<td>
<p>a numeric vector of <em>L</em> parameters used for outlier identification on individual segments</p>
</td></tr>
<tr><td><code>outlier</code></td>
<td>
<p>a logical vector specyfing the identified outliers, <code>TRUE</code> means that corresponding observation from vector <code>x</code> is detected as outlier</p>
</td></tr>
</table>


<h3>References</h3>

<p>Campulova M, Michalek J, Mikuska P, Bokal D (2018). Nonparametric algorithm for identification of outliers in environmental data. Journal of Chemometrics, 32, 453-463.
</p>
<p>Gasser T, Kneip A, Kohler W (1991). A flexible and fast method for automatic smoothing. Journal of the American Statistical Association, 86, 643â€“652.
</p>
<p>Herrmann E (1997). Local bandwidth choice in kernel regression estimation. Journal of Computational and Graphical Statistics, 6(1), 35â€“54.
</p>
<p>Eva Herrmann; Packaged for R and enhanced by Martin Maechler (2016). lokern: Kernel Regression Smoothing with Local or Global Plug-in Bandwidth. R package version 1.1-8. https://CRAN.R-project.org/package=lokern.
</p>
<p>Killick R, Fearnhead P, Eckley IA (2012). Optimal detection of changepoints with a linear computational cost. Journal of the American Statistical Association, 107(500), 1590â€“1598.
</p>
<p>Killick R, Haynes K, Eckley IA (2016). changepoint: An R package for changepoint analysis. R package version 2.2.2, &lt;URL: https://CRAN.R-project.org/package=changepoint&gt;.
</p>
<p>Matteson D, James N (2014). A Nonparametric Approach for Multiple Change Point Analysis of Multivariate Data. Journal of the American Statistical Association, 109(505), 334â€“345.
</p>
<p>Nicholas A. James, David S. Matteson (2014). ecp: An R Package for Nonparametric Multiple Change Point Analysis of Multivariate Data. Journal of Statistical Software, 62(7), 1-25, URL &quot;http://www.jstatsoft.org/v62/i07/&quot;.
</p>
<p>Brys G, Hubert M, Struyf A (2008). Goodness-of-fit tests based on a robust measure of skewness. Computational Statistics, 23(3), 429â€“442.
</p>
<p>Todorov V, Filzmoser P (2009). An Object-Oriented Framework for Robust Multivariate Analysis. Journal of Statistical Software, 32(3), 1-47. URL http://www.jstatsoft.org/v32/i03/.
</p>
<p>Box G, Cox D (1964). An analysis of transformations. Journal of the Royal Statistical Society: Series B, 26, 211â€“234.
</p>
<p>Venables WN, Ripley BD (2002). Modern Applied Statistics with S. New York, fourth edition. ISBN 0-387-95457-0, URL http://www.stats.ox.ac.uk/pub/MASS4.
</p>
<p>Grubbs F (1950). Sample criteria for testing outlying observations. The Annals of Mathematical Statistics, 21(1), 27-58.
</p>
<p>Fox J (2016). Applied regression analysis and generalized linear models. 3 edition. Los Angeles: SAGE. ISBN 9781452205663.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("mydata", package = "openair")
x = mydata$o3[format(mydata$date, "%m %Y") == "12 2002"]
result = KRDetect.outliers.changepoint(x)
summary(result)
plot(result)
plot(result, show.segments = FALSE)
</code></pre>

<hr>
<h2 id='KRDetect.outliers.controlchart'>Identification of outliers using control charts</h2><span id='topic+KRDetect.outliers.controlchart'></span>

<h3>Description</h3>

<p>Identification of outliers in environmental data using two-step method based on kernel smoothing and control charts (Campulova et al., 2017).
The outliers are identified as observations corresponding to segments of smoothing residuals exceeding control charts limits.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>KRDetect.outliers.controlchart(x, perform.smoothing = TRUE,
  bandwidth.type = "local", bandwidth.value = NULL, kernel.order = 2,
  method = "range", group.size.x = 3, group.size.R = 3,
  group.size.s = 3, L.x = 3, L.R = 3, L.s = 3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="KRDetect.outliers.controlchart_+3A_x">x</code></td>
<td>
<p>data values.
Supported data types
</p>

<ul>
<li><p>a numeric vector
</p>
</li>
<li><p>a time series object <code>ts</code>
</p>
</li>
<li><p>a time series object <code>xts</code>
</p>
</li>
<li><p>a time series object <code>zoo</code>
</p>
</li></ul>
</td></tr>
<tr><td><code id="KRDetect.outliers.controlchart_+3A_perform.smoothing">perform.smoothing</code></td>
<td>
<p>a logical value specifying if data smoothing is performed. If <code>TRUE</code> (default), data are smoothed.</p>
</td></tr>
<tr><td><code id="KRDetect.outliers.controlchart_+3A_bandwidth.type">bandwidth.type</code></td>
<td>
<p>a character string specifying the type of bandwidth.
</p>
<p>Possible options are
</p>

<ul>
<li><p><code>"local"</code> (default) to use local bandwidth
</p>
</li>
<li><p><code>"global"</code> to use global bandwidth
</p>
</li></ul>
</td></tr>
<tr><td><code id="KRDetect.outliers.controlchart_+3A_bandwidth.value">bandwidth.value</code></td>
<td>
<p>a local bandwidth array (for <code>bandwidth.type = "local"</code>) or global bandwidth value (for <code>bandwidth.type = "global"</code>) for kernel regression estimation. If <code>bandwidth.type = "NULL"</code> (default) a data-adaptive local plug-in (Herrmann, 1997) (for <code>bandwidth.type = "local"</code>) or data-adaptive global plug-in (Gasser et al., 1991) (for <code>bandwidth.type = "global"</code>) bandwidth is used instead.</p>
</td></tr>
<tr><td><code id="KRDetect.outliers.controlchart_+3A_kernel.order">kernel.order</code></td>
<td>
<p>a nonnegative integer giving the order of the optimal kernel (Gasser et al., 1985) used for smoothing.
</p>
<p>Possible options are
</p>

<ul>
<li><p><code>kernel.order = 2</code> (default)
</p>
</li>
<li><p><code>kernel.order = 4</code>
</p>
</li></ul>
</td></tr>
<tr><td><code id="KRDetect.outliers.controlchart_+3A_method">method</code></td>
<td>
<p>a character string specifying the preferred estimate of standard deviation parameter.
</p>
<p>Possible options are
</p>

<ul>
<li><p><code>"range"</code> (default) for estimation based on sample ranges
</p>
</li>
<li><p><code>"sd"</code> for estimation based on sample standard deviations
</p>
</li></ul>
</td></tr>
<tr><td><code id="KRDetect.outliers.controlchart_+3A_group.size.x">group.size.x</code></td>
<td>
<p>a positive integer giving the number of observations in individual segments used for computation of <em>x</em> chart control limits.
If the data can not be equidistantly divided, the first extra values will be excluded from the analysis. Default is <code>group.size.x = 3</code>.</p>
</td></tr>
<tr><td><code id="KRDetect.outliers.controlchart_+3A_group.size.r">group.size.R</code></td>
<td>
<p>a positive integer giving the number of observations in individual segments used for computation of <em>R</em> chart control limits.
If the data can not be equidistantly divided, the first extra values will be excluded from the analysis. Default is <code>group.size.R = 3</code>.</p>
</td></tr>
<tr><td><code id="KRDetect.outliers.controlchart_+3A_group.size.s">group.size.s</code></td>
<td>
<p>a positive integer giving the number of observations in individual segments used for computation of <em>s</em> chart control limits.
If the data can not be equidistantly divided, the first extra values will be excluded from the analysis. Default is <code>group.size.s = 3</code>.</p>
</td></tr>
<tr><td><code id="KRDetect.outliers.controlchart_+3A_l.x">L.x</code></td>
<td>
<p>a positive numeric value giving parameter <code>L</code> specifying the width of <em>x</em> chart control limits. Default is <code>L.x = 3</code>.</p>
</td></tr>
<tr><td><code id="KRDetect.outliers.controlchart_+3A_l.r">L.R</code></td>
<td>
<p>a positive numeric value giving parameter <code>L</code> specifying the width of <em>R</em> chart control limits. Default is <code>L.R = 3</code>.</p>
</td></tr>
<tr><td><code id="KRDetect.outliers.controlchart_+3A_l.s">L.s</code></td>
<td>
<p>a positive numeric value giving parameter <code>L</code> specifying the width of <em>s</em> chart control limits. Default is <code>L.s = 3</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function identifies outliers in environmental data using two-step procedure (Campulova et al., 2017).
The procedure consists of kernel smoothing and subsequent identification of observations corresponding to segments of smoothing residuals exceeding control charts limits.
This way the method does not identify individual outliers but segments of observations, where the outliers occur.
The output of the method are three logical vectors specyfing the outliers identified based on each of the three control charts.
Beside that logical vector specyfing the outliers identified based on at least one type of control limits is returned.
Crucial for the method is the choice of paramaters <code>L.x</code>, <code>L.R</code> and <code>L.s</code> specifying the width of control limits.
Different values of the parameters determine different criteria for outlier detection. For more information see (Campulova et al., 2017).
</p>


<h3>Value</h3>

<p>A <code>"KRDetect"</code> object which contains a list with elements:
</p>
<table>
<tr><td><code>method.type</code></td>
<td>
<p>a character string giving the type of method used for outlier idetification</p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p>a numeric vector of observations</p>
</td></tr>
<tr><td><code>index</code></td>
<td>
<p>a numeric vector of index design points assigned to individual observations</p>
</td></tr>
<tr><td><code>smoothed</code></td>
<td>
<p>a numeric vector of estimates of the kernel regression function (smoothed data)</p>
</td></tr>
<tr><td><code>outlier.x</code></td>
<td>
<p>a logical vector specyfing the identified outliers based on limits of control chart <em>x</em>, <code>TRUE</code> means that corresponding observation from vector <code>x</code> is detected as outlier</p>
</td></tr>
<tr><td><code>outlier.R</code></td>
<td>
<p>a logical vector specyfing the identified outliers based on limits of control chart <em>R</em>, <code>TRUE</code> means that corresponding observation from vector <code>x</code> is detected as outlier</p>
</td></tr>
<tr><td><code>outlier.s</code></td>
<td>
<p>a logical vector specyfing the identified outliers based on limits of control chart <em>s</em>, <code>TRUE</code> means that corresponding observation from vector <code>x</code> is detected as outlier</p>
</td></tr>
<tr><td><code>outlier</code></td>
<td>
<p>a logical vector specyfing the identified outliers based on at least one type of control limits. <code>TRUE</code> means that corresponding observation from vector <code>x</code> is detected as outlier</p>
</td></tr>
<tr><td><code>LCL.x</code></td>
<td>
<p>a numeric value giving lower control limit of control chart <em>x</em></p>
</td></tr>
<tr><td><code>UCL.x</code></td>
<td>
<p>a numeric value giving upper control limit of control chart <em>x</em></p>
</td></tr>
<tr><td><code>LCL.s</code></td>
<td>
<p>a numeric value giving lower control limit of control chart <em>s</em></p>
</td></tr>
<tr><td><code>UCL.s</code></td>
<td>
<p>a numeric value giving upper control limit of control chart <em>s</em></p>
</td></tr>
<tr><td><code>LCL.R</code></td>
<td>
<p>a numeric value giving lower control limit of control chart <em>R</em></p>
</td></tr>
<tr><td><code>UCL.R</code></td>
<td>
<p>a numeric value giving upper control limit of control chart <em>R</em></p>
</td></tr>
</table>


<h3>References</h3>

<p>Campulova M, Veselik P, Michalek J (2017). Control chart and Six sigma based algorithms for identification of outliers in experimental data, with an application to particulate matter PM10. Atmospheric Pollution Research. Doi=10.1016/j.apr.2017.01.004.
</p>
<p>Shewhart W (1931). Quality control chart. Bell System Technical Journal, 5, 593â€“603.
</p>
<p>SAS/QC User's Guide, Version 8, 1999. SAS Institute, Cary, N.C.
</p>
<p>Wild C, Seber G (2000). Chance encounters: A first course in data analysis and inference. New York: John Wiley.
</p>
<p>Joglekar, Anand M. Statistical methods for six sigma: in R&amp;D and manufacturing. Hoboken, NJ: Wiley-Interscience. ISBN sbn0-471-20342-4.
</p>
<p>Gasser T, Kneip A, Kohler W (1991). A flexible and fast method for automatic smoothing. Journal of the American Statistical Association, 86, 643â€“652.
</p>
<p>Herrmann E (1997). Local bandwidth choice in kernel regression estimation. Journal of Computational and Graphical Statistics, 6(1), 35â€“54.
</p>
<p>Eva Herrmann; Packaged for R and enhanced by Martin Maechler (2016). lokern: Kernel Regression Smoothing with Local or Global Plug-in Bandwidth. R package version 1.1-8. https://CRAN.R-project.org/package=lokern
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("mydata", package = "openair")
x = mydata$o3[format(mydata$date, "%m %Y") == "12 2002"]
result = KRDetect.outliers.controlchart(x)
summary(result)
plot(result)
plot(result, plot.type = "x")
plot(result, plot.type = "R")
plot(result, plot.type = "s")
</code></pre>

<hr>
<h2 id='KRDetect.outliers.EV'>Identification of outliers using extreme value theory</h2><span id='topic+KRDetect.outliers.EV'></span>

<h3>Description</h3>

<p>Identification of outliers in environmental data using semiparametric method based on kernel smoothing and extreme value theory (Holesovsky et al., 2018). The outliers are identified as observations whose values are exceeded on average once a given period that is specified by the user.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>KRDetect.outliers.EV(x, perform.smoothing = TRUE,
  bandwidth.type = "local", bandwidth.value = NULL, kernel.order = 2,
  gpd.fit.method = "mle", threshold.min = NULL, threshold.max = NULL,
  k.min = round(length(na.omit(x)) * 0.1),
  k.max = round(length(na.omit(x)) * 0.1), extremal.index.min = NULL,
  extremal.index.max = NULL, extremal.index.type = "block.maxima",
  block.length.min = round(sqrt(length(na.omit(x)))),
  block.length.max = round(sqrt(length(na.omit(x)))), D.min = NULL,
  D.max = NULL, K.min = NULL, K.max = NULL, r.min = NULL,
  r.max = NULL, return.period = 120)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="KRDetect.outliers.EV_+3A_x">x</code></td>
<td>
<p>data values.
Supported data types
</p>

<ul>
<li><p>a numeric vector
</p>
</li>
<li><p>a time series object <code>ts</code>
</p>
</li>
<li><p>a time series object <code>xts</code>
</p>
</li>
<li><p>a time series object <code>zoo</code>
</p>
</li></ul>
</td></tr>
<tr><td><code id="KRDetect.outliers.EV_+3A_perform.smoothing">perform.smoothing</code></td>
<td>
<p>a logical value specifying if data smoothing is performed. If <code>TRUE</code> (default), data are smoothed.</p>
</td></tr>
<tr><td><code id="KRDetect.outliers.EV_+3A_bandwidth.type">bandwidth.type</code></td>
<td>
<p>a character string specifying the type of bandwidth.
</p>
<p>Possible options are
</p>

<ul>
<li><p><code>"local"</code> (default) to use local bandwidth
</p>
</li>
<li><p><code>"global"</code> to use global bandwidth
</p>
</li></ul>
</td></tr>
<tr><td><code id="KRDetect.outliers.EV_+3A_bandwidth.value">bandwidth.value</code></td>
<td>
<p>a local bandwidth array (for <code>bandwidth.type = "local"</code>) or global bandwidth value (for <code>bandwidth.type = "global"</code>) for kernel regression estimation. If <code>bandwidth.type = "NULL"</code> (default) a data-adaptive local plug-in (Herrmann, 1997) (for <code>bandwidth.type = "local"</code>) or data-adaptive global plug-in (Gasser et al., 1991) (for <code>bandwidth.type = "global"</code>) bandwidth is used instead.</p>
</td></tr>
<tr><td><code id="KRDetect.outliers.EV_+3A_kernel.order">kernel.order</code></td>
<td>
<p>a nonnegative integer giving the order of the optimal kernel (Gasser et al., 1985) used for smoothing.
</p>
<p>Possible options are
</p>

<ul>
<li><p><code>kernel.order = 2</code> (default)
</p>
</li>
<li><p><code>kernel.order = 4</code>
</p>
</li></ul>
</td></tr>
<tr><td><code id="KRDetect.outliers.EV_+3A_gpd.fit.method">gpd.fit.method</code></td>
<td>
<p>a character string specifying the method used for the estimate of the scale and shape parameters of GP distribution.
</p>
<p>Possible options are
</p>

<ul>
<li><p><code>"mle"</code> (default) for maximum likelihood estimates (Coles, 2001)
</p>
</li>
<li><p><code>"moment"</code> for moment estimates (de Haan and Ferreira2006)
</p>
</li></ul>
</td></tr>
<tr><td><code id="KRDetect.outliers.EV_+3A_threshold.min">threshold.min</code></td>
<td>
<p>a threshold value for residuals with low values, that is used to find the maximum likelihood estimates of shape and scale parameters of GP distribution and selected types of extremal index estimates (specifically: Intervals estimator (Ferro and Segers, 2003), censored estimator, (Holesovsky and Fusek, 2020), K-gaps estimator (Suveges and Davison, 2010), runs estimator (Smith and Weissman, 1994)). If <code>threshold.min = NULL</code> (default), threshold is estimated as 90% quantile of smoothing residuals.</p>
</td></tr>
<tr><td><code id="KRDetect.outliers.EV_+3A_threshold.max">threshold.max</code></td>
<td>
<p>a threshold value for residuals with high values, that is used to find the maximum likelihood estimates of shape and scale parameters of GP distribution and selected types of extremal index estimates (specifically: Intervals estimator (Ferro and Segers, 2003), censored estimator, (Holesovsky and Fusek, 2020), K-gaps estimator (Suveges and Davison, 2010), runs estimator (Smith and Weissman, 1994)). If <code>threshold.max = NULL</code> (default), threshold is estimated as 90% quantile of smoothing residuals.</p>
</td></tr>
<tr><td><code id="KRDetect.outliers.EV_+3A_k.min">k.min</code></td>
<td>
<p>a positive integer for residuals with low values giving the number of largest order statistics used to find the moment estimates (de Haan and Ferreira, 2006) of shape and scale parameters of GP distribution. Default is <code>k.min = round(length(x) * 0.1)</code>.</p>
</td></tr>
<tr><td><code id="KRDetect.outliers.EV_+3A_k.max">k.max</code></td>
<td>
<p>a positive integer for residuals with high values giving the number of largest order statistics used to find the moment estimates (de Haan and Ferreira, 2006) of shape and scale parameters of GP distribution. Default is <code>k.max = round(length(x) * 0.1)</code>.</p>
</td></tr>
<tr><td><code id="KRDetect.outliers.EV_+3A_extremal.index.min">extremal.index.min</code></td>
<td>
<p>a numeric value giving the extremal index for identification of outliers with extremely low value. If <code>extremal.index.min = NULL</code> (default), the extremal index is estimated using the method specified by the parameter <code>extremal.index.type</code>.</p>
</td></tr>
<tr><td><code id="KRDetect.outliers.EV_+3A_extremal.index.max">extremal.index.max</code></td>
<td>
<p>a numeric value giving the extremal index for identification of outliers with extremely high value. If <code>extremal.index.max = NULL</code> (default), the extremal index is estimated using the method specified by the parameter <code>extremal.index.type</code>.</p>
</td></tr>
<tr><td><code id="KRDetect.outliers.EV_+3A_extremal.index.type">extremal.index.type</code></td>
<td>
<p>a character string specifying the type of extremal index estimate.
</p>
<p>Possible options are
</p>

<ul>
<li><p><code>"block.maxima"</code> (default) for block maxima estimator (Gomes, 1993).
</p>
</li>
<li><p><code>"intervals"</code> for intervals estimator (Ferro and Segers, 2003).
</p>
</li>
<li><p><code>"censored"</code> for censored estimator (Holesovsky and Fusek, 2020).
</p>
</li>
<li><p><code>"Kgaps"</code> for K-gaps estimator (Suveges and Davison, 2010).
</p>
</li>
<li><p><code>"sliding.blocks"</code> for sliding blocks estimator (Northrop, 2015).
</p>
</li>
<li><p><code>"runs"</code> for runs estimator (Smith and Weissman, 1994).
</p>
</li></ul>
</td></tr>
<tr><td><code id="KRDetect.outliers.EV_+3A_block.length.min">block.length.min</code></td>
<td>
<p>a numeric value for residuals with low values giving the length of blocks for estimation of extremal index. Only required for <code>extremal.index.type = "block.maxima"</code> and <code>extremal.index.type = "sliding.blocks"</code>. Default is <code>block.length.min = round(sqrt(length(x)))</code>.</p>
</td></tr>
<tr><td><code id="KRDetect.outliers.EV_+3A_block.length.max">block.length.max</code></td>
<td>
<p>a numeric value for residuals with high values giving the length of blocks for estimation of extremal index. Only required for <code>extremal.index.type = "block.maxima"</code> and <code>extremal.index.type = "sliding.blocks"</code>. Default is <code>block.length.max = round(sqrt(length(x)))</code>.</p>
</td></tr>
<tr><td><code id="KRDetect.outliers.EV_+3A_d.min">D.min</code></td>
<td>
<p>a nonnegative integer for residuals with low values giving the value of D parameter used for censored extremal index estimate (Holesovsky and Fusek, 2020). Only required for <code>extremal.index.type = "censored"</code>.</p>
</td></tr>
<tr><td><code id="KRDetect.outliers.EV_+3A_d.max">D.max</code></td>
<td>
<p>a nonnegative integer for residuals with high values giving the value of D parameter used for censored extremal index estimate (Holesovsky and Fusek, 2020). Only required for <code>extremal.index.type = "censored"</code>.</p>
</td></tr>
<tr><td><code id="KRDetect.outliers.EV_+3A_k.min">K.min</code></td>
<td>
<p>a nonnegative integer for residuals with low values giving the value of K parameter used for K-gaps extremal index estimate (Suveges and Davison, 2010). Only required for <code>extremal.index.type = "Kgaps"</code>.</p>
</td></tr>
<tr><td><code id="KRDetect.outliers.EV_+3A_k.max">K.max</code></td>
<td>
<p>a nonnegative integer for residuals with high values giving the value of K parameter used for K-gaps extremal index estimate (Suveges and Davison, 2010). Only required for <code>extremal.index.type = "Kgaps"</code>.</p>
</td></tr>
<tr><td><code id="KRDetect.outliers.EV_+3A_r.min">r.min</code></td>
<td>
<p>a positive integer for residuals with low values giving the value of runs parameter of runs extremal index estimate (Smith and Weissman, 1994). Only required for <code>extremal.index.type = "runs"</code>.</p>
</td></tr>
<tr><td><code id="KRDetect.outliers.EV_+3A_r.max">r.max</code></td>
<td>
<p>a positive integer for residuals with high values giving the value of runs parameter of runs extremal index estimate (Smith and Weissman, 1994). Only required for <code>extremal.index.type = "runs"</code>.</p>
</td></tr>
<tr><td><code id="KRDetect.outliers.EV_+3A_return.period">return.period</code></td>
<td>
<p>a positive numeric value giving return period. Default is <code>r = 120</code>, which means that observations whose values are exceeded on average once every 120 observations are detected as outliers.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function identifies outliers in time series using two-step procedure (Holesovsky et al., 2018). The procedure consists of kernel smoothing and extreme value estimation of high threshold exceedances for smoothing residuals.
Outliers with both extremely high and extremely low values are identified.
Crucial for the method is the choice of return period - parameter defining the criterion for outliers detection.
The outliers with extremely high values are detected as observations whose values are exceeded on average once a given return.period of observations. Analogous, the outliers with extremely low values are identified.
</p>


<h3>Value</h3>

<p>A <code>"KRDetect"</code> object which contains a list with elements:
</p>
<table>
<tr><td><code>method.type</code></td>
<td>
<p>a character string giving the type of method used for outlier idetification</p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p>a numeric vector of observations</p>
</td></tr>
<tr><td><code>index</code></td>
<td>
<p>a numeric vector of index design points assigned to individual observations</p>
</td></tr>
<tr><td><code>smoothed</code></td>
<td>
<p>a numeric vector of estimates of the kernel regression function (smoothed data)</p>
</td></tr>
<tr><td><code>GPD.fit.method</code></td>
<td>
<p>the method used for the estimate of the scale and shape parameters of GP distribution</p>
</td></tr>
<tr><td><code>extremal.index.type</code></td>
<td>
<p>the type of extremal index estimate used for the identification of outliers</p>
</td></tr>
<tr><td><code>sigma.min</code></td>
<td>
<p>a numeric value giving scale parameter of Generalised Pareto distribution used for identification of outliers with extremely low value</p>
</td></tr>
<tr><td><code>sigma.max</code></td>
<td>
<p>a numeric value giving scale parameter of Generalised Pareto distribution used for identification of outliers with extremely high value</p>
</td></tr>
<tr><td><code>xi.min</code></td>
<td>
<p>a numeric value giving shape parameter of Generalised Pareto distribution used for identification of outliers with extremely low value</p>
</td></tr>
<tr><td><code>xi.max</code></td>
<td>
<p>a numeric value giving shape parameter of Generalised Pareto distribution used for identification of outliers with extremely high value</p>
</td></tr>
<tr><td><code>lambda_u.min</code></td>
<td>
<p>a numeric value giving relative frequency of the number of threshold value exceedances and identification of outliers with extremely low value. The value of the parameter is returned only for <code>gpd.fit.method = "mle"</code>.</p>
</td></tr>
<tr><td><code>lambda_u.max</code></td>
<td>
<p>a numeric value giving relative frequency of the number of threshold value exceedances and identification of outliers with extremely high value. The value of the parameter is returned only for <code>gpd.fit.method = "mle"</code>.</p>
</td></tr>
<tr><td><code>extremal.index.min</code></td>
<td>
<p>a numeric value giving extremal index used for identification of outliers with extremely low value</p>
</td></tr>
<tr><td><code>extremal.index.max</code></td>
<td>
<p>a numeric value giving extremal index used for identification of outliers with extremely high value</p>
</td></tr>
<tr><td><code>threshold.min</code></td>
<td>
<p>a numeric value giving threshold value used for identification of outliers with extremely low value.</p>
</td></tr>
<tr><td><code>threshold.max</code></td>
<td>
<p>a numeric value giving threshold value used for identification of outliers with extremely high value.</p>
</td></tr>
<tr><td><code>return.level.min</code></td>
<td>
<p>a numeric value giving return level used for identification of outliers with extremely low value</p>
</td></tr>
<tr><td><code>return.level.max</code></td>
<td>
<p>a numeric value giving return level used for identification of outliers with extremely high value</p>
</td></tr>
<tr><td><code>outlier.min</code></td>
<td>
<p>a logical vector specyfing the identified outliers with extremely low value. <code>TRUE</code> means that corresponding observation from vector <code>x</code> is detected as outlier</p>
</td></tr>
<tr><td><code>outlier.max</code></td>
<td>
<p>a logical vector specyfing the identified outliers with extremely high value. <code>TRUE</code> means that corresponding observation from vector <code>x</code> is detected as outlier</p>
</td></tr>
<tr><td><code>outlier</code></td>
<td>
<p>a logical vector specyfing the identified outliers with both extremely low and extremely high value. <code>TRUE</code> means that corresponding observation from vector <code>x</code> is detected as outlier</p>
</td></tr>
</table>


<h3>References</h3>

<p>Holesovsky J, Campulova M, Michalek J (2018). Semiparametric Outlier Detection in Nonstationary Times Series: Case Study for Atmospheric Pollution in Brno, Czech Republic. Atmospheric Pollution Research, 9(1).
</p>
<p>Theo Gasser, Alois Kneip &amp; Walter Koehler (1991) A flexible and fast method for automatic smoothing. Journal of the American Statistical Association 86, 643-652. https://doi.org/10.2307/2290393
</p>
<p>E. Herrmann (1997) Local bandwidth choice in kernel regression estimation. Journal of Graphical and Computational Statistics 6, 35-54.
</p>
<p>Herrmann E, Maechler M (2013). lokern: Kernel Regression Smoothing with Local or Global Plug-in Bandwidth. R package version 1.1-5, URL http://CRAN.R-project.org/package=lokern.
</p>
<p>Gasser, T, Muller, H-G, Mammitzsch, V (1985). Kernels for nonparametric curve estimation. Journal of the Royal Statistical Society, B Met., 47(2), 238-252.
</p>
<p>Gomes M (1993). On the estimation of parameter of rare events in environmental time series. In Statistics for the Environment, volume 2 of Water Related Issues, pp. 225-241. Wiley.
</p>
<p>Ferro, CAT, Segers, J (2003). Inference for Cluster of Extreme Values. Journal of Royal Statistical Society, Series B, 65(2), 545-556.
</p>
<p>Holesovsky, J, Fusek, M (2020). Estimation of the Extremal Index Using Censored Distributions. Extremes, In Press.
</p>
<p>Suveges, M, Davison, AC (2010). Model Misspecification in Peaks Over Threshold Analysis. The Annals of Applied Statistics, 4(1), 203-221.
</p>
<p>Northrop, PJ (2015). An Efficient Semiparametric Maxima Estimator of the Extremal Index. Extremes, 18, 585-603.
</p>
<p>Smith, RL, Weissman, I (1994). Estimating the Extremal Index. Journal of the Royal Statistical Society, Series B, 56, 515-529.
</p>
<p>Heffernan JE, Stephenson AG (2016). ismev: An Introduction to Statistical Modeling of Extreme Values. R package version 1.41, URL http://CRAN.R-project.org/package=ismev.
</p>
<p>Coles S (2001). An Introduction to Statistical Modeling of Extreme Values. 3 edition. London: Springer. ISBN 1-85233-459-2.
</p>
<p>de Haan, L, Ferreira, A (2006). Extreme Value Theory: An Introduction. Springer.
</p>
<p>Pickands J (1975). Statistical inference using extreme order statistics. The Annals of Statistics, 3(1), 119-131.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("mydata", package = "openair")
x = mydata$o3[format(mydata$date, "%m %Y") == "12 2002"]
result = KRDetect.outliers.EV(x)
summary(result)
plot(result)
plot(result, plot.type = "min")
plot(result, plot.type = "max")
</code></pre>

<hr>
<h2 id='KRDetect.outliers.plot'>Outlier detection plot</h2><span id='topic+KRDetect.outliers.plot'></span>

<h3>Description</h3>

<p>This function is deprecated. Use <code><a href="#topic+plot.KRDetect">plot.KRDetect</a></code> instead.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>KRDetect.outliers.plot(x, all, segments)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="KRDetect.outliers.plot_+3A_x">x</code></td>
<td>
<p>a list obtained as the output of function KRDetect.outliers.changepoint, KRDetect.outliers.controlchart or KRDetect.outliers.EV for identification of outliers.</p>
</td></tr>
<tr><td><code id="KRDetect.outliers.plot_+3A_all">all</code></td>
<td>
<p>a logical variable,
in case of results obtained using function KRDetect.outliers.controlchart specifying if individual graphs for outliers detected using control chart x, R and s are plotted together with graph visualising outliers detected based on at least 1 control chart.
If all = FALSE, only one graph visualising outliers detected based on at least 1 control chart is plotted.
in case of results obtained using function KRDetect.outliers.EV specifying if individual graphs for outliers with extremely low and extremely high value are plotted together with graph visualising outliers with both extremely low and extremely high value.
If all = FALSE, only one graph visualising outliers with both extremely low and extremely high value is plotted.
Only required for results obtained using functions KRDetect.outliers.controlchart and KRDetect.outliers.EV. Default is all = TRUE.</p>
</td></tr>
<tr><td><code id="KRDetect.outliers.plot_+3A_segments">segments</code></td>
<td>
<p>a logical variable specifying if vertical lines representing individual segments are plotted. Only required for results obtained using KRDetect.outliers.changepoint function. Default is segments = TRUE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Plot of results obrained using functions KRDetect.outliers.changepoint, KRDetect.outliers.controlchart and KRDetect.outliers.EV for identification of outliers.
The function graphically visualizes results obtained using functions for outlier detection implemented in package envoutliers.
</p>
<p>This function plots the results obtained using function KRDetect.outliers.changepoint, KRDetect.outliers.controlchart or KRDetect.outliers.EV implemented in package envoutliers and identificating outliers.
</p>

<hr>
<h2 id='mc.left'>Left medcouple (LMC) - Only intended for developer use</h2><span id='topic+mc.left'></span>

<h3>Description</h3>

<p>Calculates left medcouple (MLC).
The function is called by <code><a href="#topic+KRDetect.outliers.changepoint">KRDetect.outliers.changepoint</a></code> and is not intended for use by regular users of the package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mc.left(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mc.left_+3A_x">x</code></td>
<td>
<p>a numeric vector of data values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function computes left medcouple (LMC).
The function is exported for developer use only. It does not perform any checks on inputs since it is only a convenience function.
</p>


<h3>Value</h3>

<p>A numeric value giving left medcouple
</p>


<h3>References</h3>

<p>Brys G, Hubert M, Struyf A (2008). Goodness-of-fit tests based on a robust measure of skewness. Computational Statistics, 23(3), 429â€“442.
</p>
<p>Todorov V, Filzmoser P (2009). An Object-Oriented Framework for Robust Multivariate Analysis. Journal of Statistical Software, 32(3), 1-47. URL http://www.jstatsoft.org/v32/i03/.
</p>

<hr>
<h2 id='mc.right'>Right medcouple (RMC) - Only intended for developer use</h2><span id='topic+mc.right'></span>

<h3>Description</h3>

<p>Calculates right medcouple (RMC).
The function is called by <code><a href="#topic+KRDetect.outliers.changepoint">KRDetect.outliers.changepoint</a></code> and is not intended for use by regular users of the package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mc.right(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mc.right_+3A_x">x</code></td>
<td>
<p>a numeric vector of data values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function computes right medcouple (RMC).
The function is exported for developer use only. It does not perform any checks on inputs since it is only a convenience function.
</p>


<h3>Value</h3>

<p>A numeric value giving right medcouple
</p>


<h3>References</h3>

<p>Brys G, Hubert M, Struyf A (2008). Goodness-of-fit tests based on a robust measure of skewness. Computational Statistics, 23(3), 429â€“442.
</p>
<p>Todorov V, Filzmoser P (2009). An Object-Oriented Framework for Robust Multivariate Analysis. Journal of Statistical Software, 32(3), 1-47. URL http://www.jstatsoft.org/v32/i03/.
</p>

<hr>
<h2 id='mc.test'>Robust medcouple MC-LR test - Only intended for developer use</h2><span id='topic+mc.test'></span>

<h3>Description</h3>

<p>Performs robust medcouple test to evaluate the fit of the data to normal distribution.
The function is called by <code><a href="#topic+KRDetect.outliers.changepoint">KRDetect.outliers.changepoint</a></code> and is not intended for use by regular users of the package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mc.test(x, alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mc.test_+3A_x">x</code></td>
<td>
<p>a numeric vector of data values.</p>
</td></tr>
<tr><td><code id="mc.test_+3A_alpha">alpha</code></td>
<td>
<p>numeric value giving test significance level.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function performs robust medcouple test based on the left and right medcouple (LMC and LRC).
The function is exported for developer use only. It does not perform any checks on inputs since it is only a convenience function for robust testing of the normality.
</p>


<h3>Value</h3>

<p>A list is returned with elements:
</p>
<table>
<tr><td><code>test.stat</code></td>
<td>
<p>a numeric value giving the value of test statistics</p>
</td></tr>
<tr><td><code>crit numeric</code></td>
<td>
<p>a vector of critical values defining rejection region of the test</p>
</td></tr>
</table>


<h3>References</h3>

<p>Brys G, Hubert M, Struyf A (2008). Goodness-of-fit tests based on a robust measure of skewness. Computational Statistics, 23(3), 429â€“442.
</p>
<p>Todorov V, Filzmoser P (2009). An Object-Oriented Framework for Robust Multivariate Analysis. Journal of Statistical Software, 32(3), 1-47. URL http://www.jstatsoft.org/v32/i03/.
</p>

<hr>
<h2 id='Moment.gpd.fit'>Moment estimates of GP distribution parameters - Only intended for developer use</h2><span id='topic+Moment.gpd.fit'></span>

<h3>Description</h3>

<p>Moment estimates of shape and scale parameters of GP distribution using the approach presented in (de Haan and Ferreira, 2006).
The function is called by <code><a href="#topic+KRDetect.outliers.EV">KRDetect.outliers.EV</a></code> and is not intended for use by regular users of the package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Moment.gpd.fit(x, k = round(length(x) * 0.1))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Moment.gpd.fit_+3A_x">x</code></td>
<td>
<p>a numeric vector of observations.</p>
</td></tr>
<tr><td><code id="Moment.gpd.fit_+3A_k">k</code></td>
<td>
<p>a positive integer giving the number of top rank statistics (de Haan and Ferreira, 2006). Default is <code>k = round(length(x) * 0.1)</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function computes the moment estimates of shape and scale parameters of GP distribution (de Haan and Ferreira, 2006).
The function is exported for developer use only. It does not perform any checks on inputs since it is only convenience function used within <code><a href="#topic+KRDetect.outliers.EV">KRDetect.outliers.EV</a></code>.
</p>


<h3>Value</h3>

<p>a numeric vector giving the moment estimates for the scale and shape parameters, resp.
a numeric vector giving the standard deviations for the scale and shape parameter estimates, resp.
</p>


<h3>References</h3>

<p>de Haan, L, Ferreira, A (2006). Extreme Value Theory: An Introduction. Springer.
</p>

<hr>
<h2 id='MRL.plot'>Mean residual life (MRL) plot</h2><span id='topic+MRL.plot'></span>

<h3>Description</h3>

<p>An empirical mean residual life plot (Coles, 2001), including confidence intervals, is produced based on maximum likelihood or moment estimates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MRL.plot(x, umin = quantile(na.omit(x), probs = 0.8),
  umax = quantile(na.omit(x), probs = 0.95),
  kmin = round(length(na.omit(x)) * 0.05),
  kmax = round(length(na.omit(x)) * 0.2), nint = 100, conf = 0.95,
  est.method = "mle", u0 = NULL, k0 = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MRL.plot_+3A_x">x</code></td>
<td>
<p>data values.
Supported data types
</p>

<ul>
<li><p>a numeric vector
</p>
</li>
<li><p>a time series object <code>ts</code>
</p>
</li>
<li><p>a time series object <code>xts</code>
</p>
</li>
<li><p>a time series object <code>zoo</code>
</p>
</li></ul>
</td></tr>
<tr><td><code id="MRL.plot_+3A_umin">umin</code></td>
<td>
<p>the minimum threshold at which the mean residual life function is calculated based on maximum likelihood estimates. Default is <code>umin = quantile(na.omit(x), probs = 0.8)</code>.</p>
</td></tr>
<tr><td><code id="MRL.plot_+3A_umax">umax</code></td>
<td>
<p>the maximum threshold at which the mean residual life function is calculated based on maximum likelihood estimates. Default is <code>umin = quantile(na.omit(x), probs = 0.95)</code>.</p>
</td></tr>
<tr><td><code id="MRL.plot_+3A_kmin">kmin</code></td>
<td>
<p>the minimum number of largest order statistics for which the mean residual life function is calculated based on moment estimates. Default is <code>kmin = round(length(na.omit(x)) * 0.05)</code>.</p>
</td></tr>
<tr><td><code id="MRL.plot_+3A_kmax">kmax</code></td>
<td>
<p>the maximum number of largest order statistics for which the mean residual life function is calculated based on moment estimates. Default is <code>kmax = round(length(na.omit(x)) * 0.2)</code>.</p>
</td></tr>
<tr><td><code id="MRL.plot_+3A_nint">nint</code></td>
<td>
<p>the number of points at which the mean residual life function is calculated. Default is <code>nint = 100</code>.</p>
</td></tr>
<tr><td><code id="MRL.plot_+3A_conf">conf</code></td>
<td>
<p>the confidence coefficient for the confidence intervals depicted in the plot. Default is <code>conf = 0.95</code>.</p>
</td></tr>
<tr><td><code id="MRL.plot_+3A_est.method">est.method</code></td>
<td>
<p>a character string specifying the type of estimates for the scale and shape parameters of GP distribution.
</p>
<p>Possible options are
</p>

<ul>
<li><p><code>"mle"</code> (default) to use maximum likelihood estimates (Coles, 2001)
</p>
</li>
<li><p><code>"moment"</code> to use moment estimates (de Haan and Ferreira2006).
</p>
</li></ul>
</td></tr>
<tr><td><code id="MRL.plot_+3A_u0">u0</code></td>
<td>
<p>a numeric value giving the threshold meant for a GP approximation of the threshold exceedances. Default is <code>u0 = NULL</code>.</p>
</td></tr>
<tr><td><code id="MRL.plot_+3A_k0">k0</code></td>
<td>
<p>a numeric value giving the number <code>(k0-1)</code> of largest observations meant for a GP approximation. Default is <code>k0 = NULL</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function constructs MRL plot (Coles, 2001) based on maximum likelihood or moment estimates for parameters of GP distribution.
The MRL, i.e. the estimates of the mean excess, are expected to change linearly with threshold levels at which the GP model is appropriate.
If <code>u0</code> (or <code>k0</code>, respectively) is given, a GP mean-threshold dependency line is plotted in addition to the MRL plot (Coles, 2001; Eq. 4.9).
Each of the lines provide the user an option to assess the suitability of <code>u0</code> or <code>k0</code> as a lower bound for the threshold exceedances (for <code>u0</code>) or the number of upper order statistics (for <code>k0</code>) to fit the GP distribution.
In case <code>est.method = "mle"</code> and <code>u0</code> takes a value, the theoretical GP mean is estimated by the MLE estimates of the GP parameters. For the case <code>est.method = "moment"</code> and <code>k0</code> is given, the theoretical GP mean is estimated using the moment estimates.
In case <code>est.method = "moment"</code> the value <code>x(n-k)</code> on the x-axis of MRL plot denotes the <code>(k + 1)</code>-th largest observation of the total number of <code>n</code> observations.
</p>


<h3>References</h3>

<p>Theo Gasser, Alois Kneip &amp; Walter Koehler (1991) A flexible and fast method for automatic smoothing. Journal of the American Statistical Association 86, 643-652. https://doi.org/10.2307/2290393
</p>
<p>E. Herrmann (1997) Local bandwidth choice in kernel regression estimation. Journal of Graphical and Computational Statistics 6, 35-54.
</p>
<p>Herrmann E, Maechler M (2013). lokern: Kernel Regression Smoothing with Local or Global Plug-in Bandwidth. R package version 1.1-5, URL http://CRAN.R-project.org/package=lokern.
</p>
<p>Gasser, T, Muller, H-G, Mammitzsch, V (1985). Kernels for nonparametric curve estimation. Journal of the Royal Statistical Society, B Met., 47(2), 238-252.
</p>
<p>Coles, S (2001). An Introduction to Statistical Modeling of Extreme Values. Springer-Verlag, London, U.K., 208pp.
</p>
<p>de Haan, L, Ferreira, A (2006). Extreme Value Theory: An Introduction. Springer.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("mydata", package = "openair")
x = mydata$o3[format(mydata$date, "%m %Y") == "12 2002"]
res = smoothing(y = x)$residuals
MRL.plot(res)
</code></pre>

<hr>
<h2 id='normal.distr.quantiles.detect'>Normal distribution based identification of outliers on segments - Only intended for developer use</h2><span id='topic+normal.distr.quantiles.detect'></span>

<h3>Description</h3>

<p>Identification of outlier data values on individual homogeneous segments using quantiles of normal distribution.
The function is called by <code><a href="#topic+KRDetect.outliers.changepoint">KRDetect.outliers.changepoint</a></code> and is not intended for use by regular users of the package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>normal.distr.quantiles.detect(x, cp.segment, alpha.default)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="normal.distr.quantiles.detect_+3A_x">x</code></td>
<td>
<p>a numeric vector of data.</p>
</td></tr>
<tr><td><code id="normal.distr.quantiles.detect_+3A_cp.segment">cp.segment</code></td>
<td>
<p>an integer membership vector for individual segments.</p>
</td></tr>
<tr><td><code id="normal.distr.quantiles.detect_+3A_alpha.default">alpha.default</code></td>
<td>
<p>a numeric value from interval (0,1) of alpha parameter determining the criterion for outlier detection:
the limits for outlier observations on individual segments are set as <em>+/- (alpha/2-quantile of normal distribution with parameters corresponding to data on studied segment) * (sample standard deviation of data on corresponding segment)</em>
If <code>alpha.default = NULL</code>, its value on individual segments is estimated using Modified Algorithm A1 (Campulova et al., 2018).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function detects outlier observations on individual segments using quantiles of normal distribution.
The function is exported for developer use only. It does not perform any checks on inputs since it is only convenience function for identification of outlier residuals.
</p>


<h3>Value</h3>

<p>A list is returned with elements:
</p>
<table>
<tr><td><code>alpha</code></td>
<td>
<p>a numeric vector of alpha parameters used for outlier identification on individual segments</p>
</td></tr>
<tr><td><code>outlier</code></td>
<td>
<p>a logical vector specyfing the identified outliers, <code>TRUE</code> means that corresponding data value from vector <code>x</code> is detected as an outlier</p>
</td></tr>
</table>


<h3>References</h3>

<p>Campulova M, Michalek J, Mikuska P, Bokal D (2018). Nonparametric algorithm for identification of outliers in environmental data. Journal of Chemometrics, 32, 453-463.
</p>

<hr>
<h2 id='plot.KRDetect'>Outlier detection plot</h2><span id='topic+plot.KRDetect'></span>

<h3>Description</h3>

<p>Plot of results obtained using functions <code><a href="#topic+KRDetect.outliers.changepoint">KRDetect.outliers.changepoint</a></code>, <code><a href="#topic+KRDetect.outliers.controlchart">KRDetect.outliers.controlchart</a></code> and <code><a href="#topic+KRDetect.outliers.EV">KRDetect.outliers.EV</a></code> for identification of outliers.
The function graphically visualizes results obtained using functions for outlier detection implemented in package <span class="pkg">envoutliers</span>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'KRDetect'
plot(x, show.segments = TRUE, plot.type = "all",
  xlab = "index", ylab = "data values", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.KRDetect_+3A_x">x</code></td>
<td>
<p>a KRDetect object obtained as an output of function <code><a href="#topic+KRDetect.outliers.changepoint">KRDetect.outliers.changepoint</a></code>, <code><a href="#topic+KRDetect.outliers.controlchart">KRDetect.outliers.controlchart</a></code> or <code><a href="#topic+KRDetect.outliers.EV">KRDetect.outliers.EV</a></code> for identification of outliers.</p>
</td></tr>
<tr><td><code id="plot.KRDetect_+3A_show.segments">show.segments</code></td>
<td>
<p>a logical variable specifying if vertical lines representing individual segments are plotted. Only required for results obtained using <code><a href="#topic+KRDetect.outliers.changepoint">KRDetect.outliers.changepoint</a></code> function.</p>
</td></tr>
<tr><td><code id="plot.KRDetect_+3A_plot.type">plot.type</code></td>
<td>
<p>a type of plot with outliers displayed.
</p>
<p>Possible options for <code><a href="#topic+KRDetect.outliers.controlchart">KRDetect.outliers.controlchart</a></code> are
</p>

<ul>
<li><p><code>"all"</code> to show outliers detected using control chart <em>x</em>, <em>R</em> and <em>s</em>
</p>
</li>
<li><p><code>"x"</code> to show outliers detected using control chart <em>x</em>
</p>
</li>
<li><p><code>"R"</code> to show outliers detected using control chart <em>R</em>
</p>
</li>
<li><p><code>"s"</code> to show outliers detected using control chart <em>s</em>
</p>
</li></ul>

<p>Possible options for <code><a href="#topic+KRDetect.outliers.EV">KRDetect.outliers.EV</a></code> are
</p>

<ul>
<li><p><code>"all"</code> to show outliers with both extremely low and high value
</p>
</li>
<li><p><code>"min"</code> to show outliers with extremely low value
</p>
</li>
<li><p><code>"max"</code> to show outliers with extremely high value
</p>
</li></ul>
</td></tr>
<tr><td><code id="plot.KRDetect_+3A_xlab">xlab</code></td>
<td>
<p>a title for the x axis</p>
</td></tr>
<tr><td><code id="plot.KRDetect_+3A_ylab">ylab</code></td>
<td>
<p>a title for the y axis</p>
</td></tr>
<tr><td><code id="plot.KRDetect_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to the <code><a href="graphics.html#topic+plot">plot</a></code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function plots the results obtained using function <code><a href="#topic+KRDetect.outliers.changepoint">KRDetect.outliers.changepoint</a></code>, <code><a href="#topic+KRDetect.outliers.controlchart">KRDetect.outliers.controlchart</a></code> or <code><a href="#topic+KRDetect.outliers.EV">KRDetect.outliers.EV</a></code> implemented in package <span class="pkg">envoutliers</span> and identificating outliers.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("mydata", package = "openair")
x = mydata$o3[format(mydata$date, "%m %Y") == "12 2002"]
result = KRDetect.outliers.EV(x)
plot(result)
</code></pre>

<hr>
<h2 id='return.level.est'>Return level estimation - Only intended for developer use</h2><span id='topic+return.level.est'></span>

<h3>Description</h3>

<p>Estimation of return level for a given threshold value using Peaks Over Threshold model.
The function is called by <code><a href="#topic+KRDetect.outliers.EV">KRDetect.outliers.EV</a></code> and is not intended for use by regular users of the package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>return.level.est(r, u, sigma_u, xi, lambda_u, theta)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="return.level.est_+3A_r">r</code></td>
<td>
<p>a return period.</p>
</td></tr>
<tr><td><code id="return.level.est_+3A_u">u</code></td>
<td>
<p>a threshold value.</p>
</td></tr>
<tr><td><code id="return.level.est_+3A_sigma_u">sigma_u</code></td>
<td>
<p>a scale parameter of Generalized Pareto distribution.</p>
</td></tr>
<tr><td><code id="return.level.est_+3A_xi">xi</code></td>
<td>
<p>a shape parameter of Generalized Pareto distribution.</p>
</td></tr>
<tr><td><code id="return.level.est_+3A_lambda_u">lambda_u</code></td>
<td>
<p>a relative frequency of the number of threshold value exceedances.</p>
</td></tr>
<tr><td><code id="return.level.est_+3A_theta">theta</code></td>
<td>
<p>an extremal index.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function computes the estimate of return level for a given threshold value using Peaks Over Threshold model.
The function is exported for developer use only. It does not perform any checks on inputs since it is only convenience function used within <code><a href="#topic+KRDetect.outliers.EV">KRDetect.outliers.EV</a></code>.
</p>


<h3>Value</h3>

<p>A numeric value of return lever corresponding to return period <code>r</code>
</p>


<h3>References</h3>

<p>Coles S (2001). An Introduction to Statistical Modeling of Extreme Values. 3 edition. London: Springer. ISBN 1-85233-459-2.
</p>
<p>Pickands J (1975). Statistical inference using extreme order statistics. The Annals of Statistics, 3(1), 119-131.
</p>

<hr>
<h2 id='segment.length.control'>Segment length control - Only intended for developer use</h2><span id='topic+segment.length.control'></span>

<h3>Description</h3>

<p>Control of a number of data values on individual segments.
In case a number of data values on a segment is too small, the segment is (under the presumption of meeting certain conditions)
merged with the previous one. The first segment can be merged with the previous one.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>segment.length.control(index, x, cp.segment, min.segment.length,
  segment.length.for.merge)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="segment.length.control_+3A_index">index</code></td>
<td>
<p>a numeric vector of design points.</p>
</td></tr>
<tr><td><code id="segment.length.control_+3A_x">x</code></td>
<td>
<p>a numeric vector of data.</p>
</td></tr>
<tr><td><code id="segment.length.control_+3A_cp.segment">cp.segment</code></td>
<td>
<p>an integer membership vector for individual segments.</p>
</td></tr>
<tr><td><code id="segment.length.control_+3A_min.segment.length">min.segment.length</code></td>
<td>
<p>a numeric value giving minimal required number of observations on segments from changepoint analysis.
If a segment contains less than <code>min.segment.length</code> observations and the variances of data on the segment and the previous one are supposed to be equal (based on LeveneÂ´s test (Fox, 2016) for homogeneity of variances), the segment is merged with previous one.
Analogous, the first segment can be merged with the second one.</p>
</td></tr>
<tr><td><code id="segment.length.control_+3A_segment.length.for.merge">segment.length.for.merge</code></td>
<td>
<p>a numeric value giving giving minimal required number of observations on segments for performing the homogeneity test within changepoint split control.
A segment with fewer data than <code>segment.length.for.merge</code> is merged with the previous one without testing the homogeneity of variances (the first segment is merged with the second one).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Control of data splitting into segments.
If a segment contains less than a given number of observations specified by the user and the variances of data on the segment and the previous one are equally based on the robust version of Levene's test, the segment is merged with previous one.
Analogous, the first segment can be merged with the second one.
The user can also specify a minimum length of a segment for performing the homogeneity test. A segment with fewer data than this minimal length is merged with the previous one without testing the homogeneity of variances.
The function is called by <code><a href="#topic+KRDetect.outliers.changepoint">KRDetect.outliers.changepoint</a></code> and is not intended for use by regular users of the package.
</p>


<h3>Value</h3>

<p>An integer membership vector for individual segments
</p>


<h3>References</h3>

<p>Fox J (2016). Applied regression analysis and generalized linear models. 3 edition. Los Angeles: SAGE. ISBN 9781452205663.
</p>

<hr>
<h2 id='smoothing'>Kernel regression smoothing</h2><span id='topic+smoothing'></span>

<h3>Description</h3>

<p>Nonparametric estimation of regression function using kernel regression with local or global data-adaptive plug-in bandwidth and optimal kernels.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>smoothing(x = c(1:length(y)), y, bandwidth.type = "local",
  bandwidth.value = NULL, kernel.order = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="smoothing_+3A_x">x</code></td>
<td>
<p>data values.
Supported data types
</p>

<ul>
<li><p>a numeric vector
</p>
</li>
<li><p>a time series object <code>ts</code>
</p>
</li>
<li><p>a time series object <code>xts</code>
</p>
</li>
<li><p>a time series object <code>zoo</code>
</p>
</li></ul>
</td></tr>
<tr><td><code id="smoothing_+3A_y">y</code></td>
<td>
<p>a numeric vector of data values.</p>
</td></tr>
<tr><td><code id="smoothing_+3A_bandwidth.type">bandwidth.type</code></td>
<td>
<p>a character string specifying the type of bandwidth.
</p>
<p>Possible options are
</p>

<ul>
<li><p><code>"local"</code> (default) to use local bandwidth
</p>
</li>
<li><p><code>"global"</code> to use global bandwidth
</p>
</li></ul>
</td></tr>
<tr><td><code id="smoothing_+3A_bandwidth.value">bandwidth.value</code></td>
<td>
<p>a local bandwidth array (for <code>bandwidth.type = "local"</code>) or global bandwidth value (for <code>bandwidth.type = "global"</code>) for kernel regression estimation. If <code>bandwidth.type = "NULL"</code> (default), a data-adaptive local plug-in (Herrmann, 1997) (for <code>bandwidth.type = "local"</code>) or data-adaptive global plug-in (Gasser et al., 1991) (for <code>bandwidth.type = "global"</code>) bandwidth is used instead.</p>
</td></tr>
<tr><td><code id="smoothing_+3A_kernel.order">kernel.order</code></td>
<td>
<p>a nonnegative integer giving the order of the optimal kernel (Gasser et al., 1985) used for smoothing.
</p>
<p>Possible options are
</p>

<ul>
<li><p><code>kernel.order = 2</code> (default)
</p>
</li>
<li><p><code>kernel.order = 4</code>
</p>
</li></ul>
</td></tr>
</table>


<h3>Details</h3>

<p>This function computes the estimate of kernel regression function using a local or global data-adaptive plug-in algorithm and optimal kernels (Gasser et al., 1985).
</p>


<h3>Value</h3>

<p>A list is returned with elements:
</p>
<table>
<tr><td><code>data.smoothed</code></td>
<td>
<p>a numeric vector of estimates of the kernel regression function (smoothed data).</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>a numeric vector of smoothing residuals</p>
</td></tr>
</table>


<h3>References</h3>

<p>Gasser T, Kneip A, Kohler W (1991). A flexible and fast method for automatic smoothing. Journal of the American Statistical Association, 86, 643-652.
</p>
<p>Herrmann E (1997). Local bandwidth choice in kernel regression estimation. Journal of Computational and Graphical Statistics, 6(1), 35-54.
</p>
<p>Gasser, T, MÃ¼ller, H-G, Mammitzsch, V (1985). Kernels for nonparametric curve estimation. Journal of the Royal Statistical Society, B Met., 47(2), 238-252.
</p>
<p>Eva Herrmann; Packaged for R and enhanced by Martin Maechler (2016). lokern: Kernel Regression Smoothing with Local or Global Plug-in Bandwidth. R package version 1.1-8. https://CRAN.R-project.org/package=lokern
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("mydata", package = "openair")
x = mydata$o3[format(mydata$date, "%m %Y") == "12 2002"]
smoothed = smoothing(y = x)
smoothed$data.smoothed
smoothed$residuals
</code></pre>

<hr>
<h2 id='stability.plot'>Stability plot</h2><span id='topic+stability.plot'></span>

<h3>Description</h3>

<p>A stability plot for maximum likelihood or moment estimates of the GP parameters (Coles, 2001), including confidence intervals, at a range of thresholds or number of the largest observations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stability.plot(x, umin = quantile(na.omit(x), probs = 0.8),
  umax = quantile(na.omit(x), probs = 0.95),
  kmin = round(length(na.omit(x)) * 0.05),
  kmax = round(length(na.omit(x)) * 0.2), nint = 100, conf = 0.95,
  est.method = "mle", u0 = NULL, k0 = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stability.plot_+3A_x">x</code></td>
<td>
<p>data values.
Supported data types
</p>

<ul>
<li><p>a numeric vector
</p>
</li>
<li><p>a time series object <code>ts</code>
</p>
</li>
<li><p>a time series object <code>xts</code>
</p>
</li>
<li><p>a time series object <code>zoo</code>
</p>
</li></ul>
</td></tr>
<tr><td><code id="stability.plot_+3A_umin">umin</code></td>
<td>
<p>the minimum threshold at which the mean residual life function is calculated. Default is <code>umin = quantile(na.omit(x), probs = 0.8)</code>.</p>
</td></tr>
<tr><td><code id="stability.plot_+3A_umax">umax</code></td>
<td>
<p>the maximum threshold at which the mean residual life function is calculated. Default is <code>ummax = quantile(na.omit(x), probs = 0.95)</code>.</p>
</td></tr>
<tr><td><code id="stability.plot_+3A_kmin">kmin</code></td>
<td>
<p>the minimum number of largest order statistics for which the mean residual life function is calculated based on moment estimates. Default is <code>kmin = round(length(na.omit(x)) * 0.05)</code>.</p>
</td></tr>
<tr><td><code id="stability.plot_+3A_kmax">kmax</code></td>
<td>
<p>the maximum number of largest order statistics for which the mean residual life function is calculated based on moment estimates. Default is <code>kmax = round(length(na.omit(x)) * 0.2)</code>.</p>
</td></tr>
<tr><td><code id="stability.plot_+3A_nint">nint</code></td>
<td>
<p>the number of points at which the mean residual life function is calculated. Default is <code>nint = 100</code>.</p>
</td></tr>
<tr><td><code id="stability.plot_+3A_conf">conf</code></td>
<td>
<p>the confidence coefficient for the confidence intervals depicted in the plot. Default is <code>conf = 0.95</code>.</p>
</td></tr>
<tr><td><code id="stability.plot_+3A_est.method">est.method</code></td>
<td>
<p>a character string specifying the type of estimates for the scale and shape parameters of GP distribution.
</p>
<p>Possible options are
</p>

<ul>
<li><p><code>"mle"</code> (default) to use maximum likelihood estimates (Coles, 2001)
</p>
</li>
<li><p><code>"moment"</code> to use moment estimates (de Haan and Ferreira, 2006).
</p>
</li></ul>
</td></tr>
<tr><td><code id="stability.plot_+3A_u0">u0</code></td>
<td>
<p>a numeric value giving the threshold meant for a GP approximation of the threshold exceedances. Default is <code>u0 = NULL</code>.</p>
</td></tr>
<tr><td><code id="stability.plot_+3A_k0">k0</code></td>
<td>
<p>a numeric value giving the number <code>(k0-1)</code> of largest observations meant for a GP approximation. Default is <code>k0 = NULL</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function estimates the GP parameters at a range of thresholds (in case <code>est.method = "mle"</code>) or a range of upper order statistics (in case of <code>est.method = "moment"</code>), and shows the sample paths of the estimates.
The estimates of the shape or the scale parameter are expected to be constant or to change linearly, respectively, with threshold levels at which the GP model is appropriate.
If <code>u0</code> (or <code>k0</code>, respectively) is given, a threshold-dependency lines for the particular parameters are plotted in addition. The lines provide the user an option to assess the suitability of <code>u0</code> or <code>k0</code> as a lower bound for the threshold exceedances (for <code>u0</code>) or the number of upper order statistics (for <code>k0</code>) to fit the GP distribution.
In case <code>est.method = "mle"</code> and <code>u0</code> takes a value, the theoretical dependency lines for the parameters are evaluated on the basis of MLE estimates. For the case <code>est.method = "moment"</code> and <code>k0</code> is given, the dependency lines are estimated using the moment estimators.
In case <code>est.method = "moment"</code> the value <code>x(n-k)</code> on the x-axis of MRL plot denotes the <code>(k + 1)</code>-th largest observation of the total number of <code>n</code> observations.
</p>


<h3>References</h3>

<p>Theo Gasser, Alois Kneip &amp; Walter Koehler (1991) A flexible and fast method for automatic smoothing. Journal of the American Statistical Association 86, 643-652. https://doi.org/10.2307/2290393
</p>
<p>E. Herrmann (1997) Local bandwidth choice in kernel regression estimation. Journal of Graphical and Computational Statistics 6, 35-54.
</p>
<p>Herrmann E, Maechler M (2013). lokern: Kernel Regression Smoothing with Local or Global Plug-in Bandwidth. R package version 1.1-5, URL http://CRAN.R-project.org/package=lokern.
</p>
<p>Gasser, T, Muller, H-G, Mammitzsch, V (1985). Kernels for nonparametric curve estimation. Journal of the Royal Statistical Society, B Met., 47(2), 238-252.
</p>
<p>Coles, S (2001). An Introduction to Statistical Modeling of Extreme Values. Springer-Verlag, London, U.K., 208pp.
</p>
<p>de Haan, L, Ferreira, A (2006). Extreme Value Theory: An Introduction. Springer.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("mydata", package = "openair")
x = mydata$o3[format(mydata$date, "%m %Y") == "12 2002"]
res = smoothing(y = x)$residuals
stability.plot(res)
</code></pre>

<hr>
<h2 id='summary.KRDetect'>Summary of the outlier detection results</h2><span id='topic+summary.KRDetect'></span>

<h3>Description</h3>

<p>Summary of results obtained using functions <code><a href="#topic+KRDetect.outliers.changepoint">KRDetect.outliers.changepoint</a></code>, <code><a href="#topic+KRDetect.outliers.controlchart">KRDetect.outliers.controlchart</a></code> and <code><a href="#topic+KRDetect.outliers.EV">KRDetect.outliers.EV</a></code> for identification of outliers.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'KRDetect'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.KRDetect_+3A_object">object</code></td>
<td>
<p>a KRDetect object obtained as an output of function <code><a href="#topic+KRDetect.outliers.changepoint">KRDetect.outliers.changepoint</a></code>, <code><a href="#topic+KRDetect.outliers.controlchart">KRDetect.outliers.controlchart</a></code> or <code><a href="#topic+KRDetect.outliers.EV">KRDetect.outliers.EV</a></code> for identification of outliers.</p>
</td></tr>
<tr><td><code id="summary.KRDetect_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to the <code><a href="base.html#topic+summary">summary</a></code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function summarizes the results obtained using functions <code><a href="#topic+KRDetect.outliers.changepoint">KRDetect.outliers.changepoint</a></code>, <code><a href="#topic+KRDetect.outliers.controlchart">KRDetect.outliers.controlchart</a></code> and <code><a href="#topic+KRDetect.outliers.EV">KRDetect.outliers.EV</a></code> for identification of outliers.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("mydata", package = "openair")
x = mydata$o3[format(mydata$date, "%m %Y") == "12 2002"]
result = KRDetect.outliers.changepoint(x)
summary(result)
result = KRDetect.outliers.controlchart(x)
summary(result)
result = KRDetect.outliers.EV(x)
summary(result)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
