<!DOCTYPE html><html><head><title>Help for package clinmon</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {clinmon}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#clinmon'><p>Hemodynamic Indices Calculated From Clinical Monitoring (clinmon)</p></a></li>
<li><a href='#df.data10'><p>Test-data (10 Hz)</p></a></li>
<li><a href='#df.data1000'><p>Test-data (1000 Hz)</p></a></li>
<li><a href='#df.deleter'><p>Test-deleter</p></a></li>
<li><a href='#TFA'><p>Transfer function analysis of dynamic cerebral autoregulation (TFA)</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Hemodynamic Calculations from Clinical Monitoring</td>
</tr>
<tr>
<td>Version:</td>
<td>0.6.0</td>
</tr>
<tr>
<td>Description:</td>
<td>
   Every research team have their own script for calculation of hemodynamic indexes. 
   This package makes it possible  to insert a long-format dataframe, and add both 
   periods of interest (trigger-periods), and delete artifacts with deleter-files.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/lilleoel/clinmon">https://github.com/lilleoel/clinmon</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/lilleoel/clinmon/issues">https://github.com/lilleoel/clinmon/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>Imports:</td>
<td>signal (&ge; 0.7-6)</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-02-02 13:39:52 UTC; MOLS0212</td>
</tr>
<tr>
<td>Author:</td>
<td>Markus Harboe Olsen [cre, aut],
  Christian Riberholt [aut],
  Ronan Berg [aut],
  Kirsten Moeller [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Markus Harboe Olsen &lt;oel@oelfam.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-02-04 11:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='clinmon'>Hemodynamic Indices Calculated From Clinical Monitoring (clinmon)</h2><span id='topic+clinmon'></span>

<h3>Description</h3>

<p><code>clinmon()</code> uses a <em>continuous</em> recording and returns a dataframe with hemodynamic indices for every period, epoch or block depending on the chosen output. Calculates <code>COest</code>, <code>CPPopt</code>, <code>CVRi</code>, <code>Dx</code>, <code>Mx</code>, <code>PI</code>, <code>PRx</code>, <code>PWA</code>, <code>RI</code>, and <code>Sx</code> (see <em>Hemodynamic indices</em>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clinmon(df, variables,
trigger = NULL, deleter = NULL,
blocksize = 3, epochsize = 20,
overlapping = FALSE, freq = 1000,
blockmin = 0.5, epochmin = 0.5,
output = "period", fast = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="clinmon_+3A_df">df</code></td>
<td>
<p>Raw <em>continuous</em> recording with all numeric data and first column has to be time in seconds. (<code>dataframe</code>)</p>
</td></tr>
<tr><td><code id="clinmon_+3A_variables">variables</code></td>
<td>
<p>Defining the type and order of the recorded variables as a list. Middle cerebral artery blood velocity (<code>'mcav'</code>), Arterial blood pressure (<code>'abp'</code>), cerebral perfusion pressure (<code>'cpp'</code>), intracranial pressure (<code>'icp'</code>), and heart rate (<code>'hr'</code>) is currently supported. (<code>list</code>)</p>
</td></tr>
<tr><td><code id="clinmon_+3A_trigger">trigger</code></td>
<td>
<p>Trigger with two columns: first is start, and second is end of periods to be analyzed. Every row corresponds to a period. Default is <code>NULL</code>, which results in analysis of the full dataframe. (<code>dataframe</code>)</p>
</td></tr>
<tr><td><code id="clinmon_+3A_deleter">deleter</code></td>
<td>
<p>Deleter with two columns: first is start and second is end of period with artefacts, which need to be deleted. Every row is a period with artefacts. Default is <code>NULL</code>. (<code>dataframe</code>)</p>
</td></tr>
<tr><td><code id="clinmon_+3A_blocksize">blocksize</code></td>
<td>
<p>Length of a block, in seconds. Default is <code>3</code>. (<code>numeric</code>)</p>
</td></tr>
<tr><td><code id="clinmon_+3A_epochsize">epochsize</code></td>
<td>
<p>Size of epochs in number of blocks. Default is <code>20</code>. (<code>numeric</code>)</p>
</td></tr>
<tr><td><code id="clinmon_+3A_overlapping">overlapping</code></td>
<td>
<p>The number of block which should overlap when calculating correlation based indices, and remain blank if overlapping calculations should not be utilized. Default is <code>FALSE</code>. (<code>numeric</code>)</p>
</td></tr>
<tr><td><code id="clinmon_+3A_freq">freq</code></td>
<td>
<p>Frequency of recorded data, in Hz. Default is <code>1000</code>. (<code>numeric</code>)</p>
</td></tr>
<tr><td><code id="clinmon_+3A_blockmin">blockmin</code></td>
<td>
<p>Minimum measurements required to create a block in ratio. Default is <code>0.5</code> corresponding to 50%. If the block holds less than the defined ratio the block will be omitted. (<code>numeric</code>)</p>
</td></tr>
<tr><td><code id="clinmon_+3A_epochmin">epochmin</code></td>
<td>
<p>Minimum number of blocks required to create an epoch in ratio. Default is <code>0.5</code> corresponding to 50%. If the epoch holds less than the defined ration the epoch will be omitted. (<code>numeric</code>)</p>
</td></tr>
<tr><td><code id="clinmon_+3A_output">output</code></td>
<td>
<p>Select what each row should represent in the output. Correlation based indices are not presented when selecting blocks for every row. Currently <code>'block'</code>, <code>'epoch'</code>, <code>'period'</code> or <code>'cppopt'</code> is supported. Default is <code>'period'</code>. (<code>string</code>)</p>
</td></tr>
<tr><td><code id="clinmon_+3A_fast">fast</code></td>
<td>
<p>Select if you want the data to aggregated before analysis resulting in a faster, but perhaps more imprecise run, in Hz. Default is <code>FALSE.</code> (<code>numeric</code>)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Using a <em>continuous</em> raw recording, <code>clinmon()</code> calculates hemodynamic indices for every period, epoch or block depending on the chosen output.</p>
<pre>View(data)
</pre>
<table>
<tr>
 <td style="text-align: right;">
   <code>time</code> </td><td style="text-align: right;"> <code>abp</code> </td><td style="text-align: right;"> <code>mcav</code> </td>
</tr>
<tr>
 <td style="text-align: right;">
   <code>7.00</code> </td><td style="text-align: right;"> <code>78</code> </td><td style="text-align: right;"> <code>45</code> </td>
</tr>
<tr>
 <td style="text-align: right;">
   <code>7.01</code> </td><td style="text-align: right;"> <code>78</code> </td><td style="text-align: right;"> <code>46</code> </td>
</tr>
<tr>
 <td style="text-align: right;">
   <code>...</code> </td><td style="text-align: right;"> <code>...</code> </td><td style="text-align: right;"> <code>...</code> </td>
</tr>
<tr>
 <td style="text-align: right;">
   <code>301.82</code> </td><td style="text-align: right;"> <code>82</code> </td><td style="text-align: right;"> <code>70</code> </td>
</tr>
<tr>
 <td style="text-align: right;">
   <code>301.83</code> </td><td style="text-align: right;"> <code>81</code> </td><td style="text-align: right;"> <code>69</code> </td>
</tr>
<tr>
 <td style="text-align: right;">
</td>
</tr>

</table>

<p>To calculate the indices insert the data and select the relevant variables.</p>
<pre>clinmon(df=data, variables=c("abp","mcav"))
</pre>
<p>See <strong>Value</strong> for output description.
</p>


<h3>Value</h3>

<p>Returns a dataframe with the results, with either
every blocks, epochs or periods as rows, depending on the chosen output.</p>

<table>
<tr>
 <td style="text-align: left;">
   <strong>Column</strong> </td><td style="text-align: left;"> <strong>Description</strong> </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>period</code> </td><td style="text-align: left;"> The period number corresponding to the row-number in the trigger file. </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>epoch</code> </td><td style="text-align: left;"> The epoch number, or if <code>period</code> is chosen as output it reflects the number of epochs in the period. </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>block</code> </td><td style="text-align: left;"> The block number, or if <code>period</code> or <code>epoch</code> is chosen as output it reflects the number of blocks in the <code>period</code> or <code>epoch</code>. </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>time_min</code> </td><td style="text-align: left;"> The minimum time value or the <code>period</code>, <code>epoch</code> or <code>block</code>. </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>time_max</code> </td><td style="text-align: left;"> The maximum time value or the <code>period</code>, <code>epoch</code> or <code>block</code>. </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>missing_percent</code> </td><td style="text-align: left;"> The percentage of missing data in the <code>period</code>, <code>epoch</code> or <code>block</code>. </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code style="white-space: pre;">&#8288;*_mean&#8288;</code> </td><td style="text-align: left;"> The mean value of each variable for the <code>period</code>, <code>epoch</code> or <code>block</code>. </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code style="white-space: pre;">&#8288;*_min&#8288;</code> </td><td style="text-align: left;"> The minimum value of each variable for the <code>period</code>, <code>epoch</code> or <code>block</code>. </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code style="white-space: pre;">&#8288;*_max&#8288;</code> </td><td style="text-align: left;"> The maximum value of each variable for the <code>period</code>, <code>epoch</code> or <code>block</code>. </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>*</code> </td><td style="text-align: left;"> The indices in each column. </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Hemodynamic indices</h3>



<h4><code>COest</code> | Estimated cardiac output</h4>

<p><em>Required variables:</em> <code>abp</code>, <code>hr</code>; <em>Required output:</em> <code>-</code>.
</p>
<p>Estimated cardiac output (<code>COest</code>) is calculated by utilizing the method described by Koenig et al. [1]:
</p>
<p style="text-align: center;"><code class="reqn">COest = PP / (SBP+DBP) * HR</code>
</p>

<p>PP: Pulse pressure; SBP: systolic blood pressure; DBP: diastolic blood pressure; HR: heart rate.
</p>



<h4><code>CPPopt</code> | Optimal cerebral perfusion pressure</h4>

<p><em>Required variables:</em> <code>abp</code>, <code>icp</code>; <em>Required output:</em> <code>period</code>.
</p>
<p>Optimal cerebral perfusion pressure (<code>CPPopt</code>) is calculated utilizing the method described by Steiner et al. [2]. The CPPopt return <code>NA</code> if CPPopt is the maximum or minimum CPP investigated. CPPopt is recommended to only be calculated after 'several hours' of recording:
</p>
<p style="text-align: center;"><code class="reqn">CPPopt = 5 mmHg_CPP_interval_with_lowest_mean_PRx ) </code>
</p>

<p>CPP: cerebral perfusion pressure; PRx: Pressure reactivity index.
</p>



<h4><code>CVRi</code> | Cardiovascular resistance index</h4>

<p><em>Required variables:</em> <code>abp</code>, <code>mcav</code>; <em>Required output:</em> <code>-</code>.
</p>
<p>Cardiovascular resistance index (<code>CVRi</code>) is calculated utilizing the method described by Fan et al. [3]:
</p>
<p style="text-align: center;"><code class="reqn">CVRi = mean ABP / mean MCAv </code>
</p>

<p>ABP: arterial blood pressure; MCAv: middle cerebral artery blood velocity.
</p>



<h4><code>Dx</code> | Diastolic flow index</h4>

<p><em>Required variables:</em> <code>cpp</code>/<code>abp</code>, <code>mcav</code>; <em>Required output:</em> <code>epoch</code>, <code>period</code>.
</p>
<p>Diastolic flow index (<code>Dx</code>) is calculated utilizing the method described by Reinhard et al. [4]:
</p>
<p style="text-align: center;"><code class="reqn">Dx = cor( mean CPP / min MCAv ) </code>
</p>

<p style="text-align: center;"><code class="reqn">Dxa = cor( mean ABP / min MCAv ) </code>
</p>

<p>cor: correlation coefficient; CPP: cerebral perfusion pressure; ABP: arterial blood pressure; MCAv: middle cerebral artery blood velocity.
</p>



<h4><code>Mx</code> | Mean flow index</h4>

<p><em>Required variables:</em> <code>cpp</code>/<code>abp</code>, <code>mcav</code>; <em>Required output:</em> <code>epoch</code>, <code>period</code>.
</p>
<p>Mean flow index (<code>Mx</code>) is calculated utilizing the method described by Czosnyka et al. [5]:
</p>
<p style="text-align: center;"><code class="reqn">Mx = cor( mean CPP / mean MCAv ) </code>
</p>

<p style="text-align: center;"><code class="reqn">Mxa = cor( mean ABP / mean MCAv ) </code>
</p>

<p>cor: correlation coefficient; CPP: cerebral perfusion pressure; ABP: arterial blood pressure; MCAv: middle cerebral artery blood velocity.
</p>



<h4><code>PI</code> | Gosling index of pulsatility</h4>

<p><em>Required variables:</em> <code>mcav</code>; <em>Required output:</em> <code>-</code>.
</p>
<p>Gosling index of pulsatility (<code>PI</code>) is calculated utilizing the method described by Michel et al. [6]:
</p>
<p style="text-align: center;"><code class="reqn">PI = (systolic MCAv - diastolic MCAv) / mean MCAv  </code>
</p>

<p>MCAv: middle cerebral artery blood velocity.
</p>



<h4><code>PRx</code> | Pressure reactivity index</h4>

<p><em>Required variables:</em> <code>abp</code>, <code>icp</code>; <em>Required output:</em> <code>epoch</code>, <code>period</code>.
</p>
<p>Pressure reactivity index (<code>PRx</code>) is calculated utilizing the method described by Czosnyka et al. [7]:
</p>
<p style="text-align: center;"><code class="reqn">PRx = cor( mean ABP / mean ICP ) </code>
</p>

<p>cor: correlation coefficient; CPP: cerebral perfusion pressure; ICP: intracranial pressure.
</p>



<h4><code>PWA</code> | Pulse wave amplitude</h4>

<p><em>Required variables:</em> <code>cpp</code>/<code>icp</code>/<code>abp</code>/<code>mcav</code>; <em>Required output:</em> <code>-</code>.
</p>
<p>Pulse wave amplitude (<code>PWA</code>) is calculated utilizing the method described by Norager et al. [8]:
</p>
<p style="text-align: center;"><code class="reqn">PWA = systolic - diastolic </code>
</p>




<h4><code>RI</code> | Pourcelots resistive (resistance) index</h4>

<p><em>Required variables:</em> <code>mcav</code>; <em>Required output:</em> <code>-</code>.
</p>
<p>Pourcelots resistive (resistance) index (<code>RI</code>) is calculated utilizing the method described by Forster et al. [9]:
</p>
<p style="text-align: center;"><code class="reqn">RI = (systolic MCAv - diastolic MCAv) / systolic MCAv  </code>
</p>

<p>MCAv: middle cerebral artery blood velocity.
</p>



<h4><code>Sx</code> | Systolic flow index</h4>

<p><em>Required variables:</em> <code>cpp</code>/<code>abp</code>, <code>mcav</code>; <em>Required output:</em> <code>epoch</code>, <code>period</code>.
</p>
<p>Systolic flow index (<code>Sx</code>) is calculated utilizing the method described by Czosnyka et al. [5]:
</p>
<p style="text-align: center;"><code class="reqn">Sx = cor( mean CPP / systolic MCAv ) </code>
</p>

<p style="text-align: center;"><code class="reqn">Sxa = cor( mean ABP / systolic MCAv ) </code>
</p>

<p>cor: correlation coefficient; CPP: cerebral perfusion pressure; ABP: arterial blood pressure; MCAv: middle cerebral artery blood velocity.
</p>



<h3>References</h3>


<ol>
<li><p> Koenig et al. (2015) Biomed Sci Instrum. 2015;51:85-90. (<a href="https://pubmed.ncbi.nlm.nih.gov/25996703/">PubMed</a>)
</p>
</li>
<li><p> Steiner et al. (2002) Crit Care Med. 2002 Apr;30(4):733-8. (<a href="https://pubmed.ncbi.nlm.nih.gov/11940737/">PubMed</a>)
</p>
</li>
<li><p> Fan et al. (2018) Front Physiol. 2018 Jul 16;9:869. (<a href="https://pubmed.ncbi.nlm.nih.gov/30061839/">PubMed</a>)
</p>
</li>
<li><p> Reinhard et al. (2003) Stroke. 2003 Sep;34(9):2138-44. (<a href="https://pubmed.ncbi.nlm.nih.gov/12920261/">PubMed</a>)
</p>
</li>
<li><p> Czosnyka et al. (1996) Stroke. 1996 Oct;27(10):1829-34. (<a href="https://pubmed.ncbi.nlm.nih.gov/8841340/">PubMed</a>)
</p>
</li>
<li><p> Michel et al. (1998) Ultrasound Med Biol. 1998 May;24(4):597-9. (<a href="https://pubmed.ncbi.nlm.nih.gov/9651969/">PubMed</a>)
</p>
</li>
<li><p> Czosnyka et al. (1997) Neurosurgery. 1997 Jul;41(1):11-7; discussion 17-9. (<a href="https://pubmed.ncbi.nlm.nih.gov/9218290/">PubMed</a>)
</p>
</li>
<li><p> Norager et al. (2020) Acta Neurochir (Wien). 2020 Dec;162(12):2983-2989. (<a href="https://pubmed.ncbi.nlm.nih.gov/32886224/">PubMed</a>)
</p>
</li>
<li><p> Forster et al. (2017) J Paediatr Child Health. 2018 Jan;54(1):61-68. (<a href="https://pubmed.ncbi.nlm.nih.gov/28845537/">PubMed</a>)
</p>
</li></ol>



<h3>Examples</h3>

<pre><code class='language-R'>
data(testdata)
clinmon(df.data10, variables=c('abp','mcav','hr'), freq=10)

</code></pre>

<hr>
<h2 id='df.data10'>Test-data (10 Hz)</h2><span id='topic+df.data10'></span>

<h3>Description</h3>

<p>Recording with four columns: time (<code>t</code>), non-invasive arterial
blood pressure (<code>abp</code>), middle cerebral artery velocity measured
using transcranial Doppler (<code>mcav</code>), and heart rate (<code>hr</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(testdata)
</code></pre>


<h3>Format</h3>

<p>An object of class <code>"dataframe"</code>; an example of the
usage in <code><a href="#topic+clinmon">clinmon</a></code>.
</p>


<h3>Source</h3>

<p><a href="https://github.com/lilleoel/clinmon">GitHub</a>
</p>


<h3>References</h3>

<p>Olsen MH et al. (Unpublished data, 2020) (<a href="https://github.com/lilleoel/clinmon">GitHub</a>)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(testdata)
variables &lt;- c("abp","mcav","hr")
clinmon(df.data10,variables,freq=10)
</code></pre>

<hr>
<h2 id='df.data1000'>Test-data (1000 Hz)</h2><span id='topic+df.data1000'></span>

<h3>Description</h3>

<p>Recording with four columns: time (<code>t</code>), non-invasive arterial
blood pressure (<code>abp</code>), middle cerebral artery velocity measured
using transcranial Doppler (<code>mcav</code>), and heart rate (<code>hr</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(testdata)
</code></pre>


<h3>Format</h3>

<p>An object of class <code>"dataframe"</code>; an example of the
usage in <code><a href="#topic+clinmon">clinmon</a></code>.
</p>


<h3>Source</h3>

<p><a href="https://github.com/lilleoel/clinmon">GitHub</a>
</p>


<h3>References</h3>

<p>Olsen MH et al. (Unpublished data, 2020)
(<a href="https://github.com/lilleoel/clinmon">GitHub</a>)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(testdata)
variables &lt;- c("abp","mcav","hr")
clinmon(df.data1000,variables,fast=50)
</code></pre>

<hr>
<h2 id='df.deleter'>Test-deleter</h2><span id='topic+df.deleter'></span>

<h3>Description</h3>

<p>Deleter dataframe with two columns: start (<code>start</code>) and
end (<code>end</code>) of the deleter-period.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(testdata)
</code></pre>


<h3>Format</h3>

<p>An object of class <code>"dataframe"</code>; an example of the
usage in <code><a href="#topic+clinmon">clinmon</a></code>.
</p>


<h3>Source</h3>

<p><a href="https://github.com/lilleoel/clinmon">GitHub</a>
</p>


<h3>References</h3>

<p>Olsen MH et al. (Unpublished data, 2020) (<a href="https://github.com/lilleoel/clinmon">GitHub</a>)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(testdata)
variables &lt;- c("abp","mcav","hr")
clinmon(df.data1000,variables,deleter=df.deleter,fast=50)
</code></pre>

<hr>
<h2 id='TFA'>Transfer function analysis of dynamic cerebral autoregulation (TFA)</h2><span id='topic+TFA'></span>

<h3>Description</h3>

<p><code>TFA()</code> calculates dynamic cerebral autoregulation trough a transfer function analysis from a <em>continuous</em> recording. This function follows the recommendations from Claassen et al. [1] and mimicks the matlab script created by David Simpsons in 2015 (<a href="http://www.car-net.org/content/resources#tabTools">Matlab TFA function</a>). <code>TFA()</code> also includes the possibility to analyse raw recordings with application of cyclic (beat-to-beat) average with the possiblity of utilizing interpolation. (see <strong>details</strong>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TFA(df, variables,
trigger = NULL, deleter = NULL,
freq = 1000, fast = 50, raw_data = FALSE,
interpolation = 3, output = "table",
vlf = c(0.02,0.07),lf = c(0.07,0.2),
hf = c(0.2,0.5), detrend = FALSE,
spectral_smoothing = 3,
coherence2_thresholds = cbind(c(3:15),
c(0.51,0.40,0.34,0.29,0.25,0.22,0.20,0.18,
0.17,0.15,0.14,0.13,0.12)),
apply_coherence2_threshold = TRUE,
remove_negative_phase = TRUE,
remove_negative_phase_f_cutoff = 0.1,
normalize_ABP = FALSE,
normalize_CBFV = FALSE,
window_type = 'hanning',
window_length = 102.4,
overlap = 59.99,
overlap_adjust = TRUE,
na_as_mean = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TFA_+3A_df">df</code></td>
<td>
<p>Raw <em>continuous</em> recording with numeric data and first column has to be time in seconds. (<code>dataframe</code>)</p>
</td></tr>
<tr><td><code id="TFA_+3A_variables">variables</code></td>
<td>
<p>Definition of the type and order of recorded variables as a list. Middle cerebral artery blood velocity (<code>'mcav'</code>) and arterial blood pressure (<code>'abp'</code>) is currently supported. (<code>list</code>)</p>
</td></tr>
<tr><td><code id="TFA_+3A_trigger">trigger</code></td>
<td>
<p>Trigger with two columns:  first is start, and second is end of period to be analyzed. Every row is a period for analysis. Default is <code>NULL</code>, which results in analysis of the full dataframe.  (<code>dataframe</code>)</p>
</td></tr>
<tr><td><code id="TFA_+3A_deleter">deleter</code></td>
<td>
<p>Deleter with two columns: first is start and second is end of period with artefacts, which need to be deleted. Every row is a period with artefacts. Default is <code>NULL</code>. (<code>dataframe</code>)</p>
</td></tr>
<tr><td><code id="TFA_+3A_freq">freq</code></td>
<td>
<p>Frequency of recorded data, in Hz. Default is <code>1000</code>. (<code>numeric</code>)</p>
</td></tr>
<tr><td><code id="TFA_+3A_fast">fast</code></td>
<td>
<p>Select if you want the data to aggregated resulting in a faster, but perhaps more imprecise run, in Hz. Default is <code>50</code> (<code>numeric</code>)</p>
</td></tr>
<tr><td><code id="TFA_+3A_raw_data">raw_data</code></td>
<td>
<p>Select <code>TRUE</code> if the data is raw and cyclic mean should be calculated. <strong>NB:</strong> this function have not been validated, why validated methods for calculating cyclic mean are preferred. Default is <code>FALSE</code> (<code>boolian</code>)</p>
</td></tr>
<tr><td><code id="TFA_+3A_interpolation">interpolation</code></td>
<td>
<p>Select the number of beats which should be interpolated. Default is up to <code>3</code> beats and <code>0</code> results in no interpolation. (<code>numeric</code>)</p>
</td></tr>
<tr><td><code id="TFA_+3A_output">output</code></td>
<td>
<p>Select what the output should be. <code>'table'</code> results in a dataframe with values for the three frequencies defined by Claassen et al. [1]; <code>'long'</code> results in a dataframe with the results in a long format; <code>'plot'</code> results in a daframe which can help plot gain, phase and coherence; <code>'plot-peak'</code> results in a dataframe, which can be used to validate the cyclic average, and <code>'raw'</code> results in a nested list with results primarily for debugging. Default is <code>'table'</code>. (<code>string</code>)</p>
</td></tr>
<tr><td><code id="TFA_+3A_vlf">vlf</code>, <code id="TFA_+3A_lf">lf</code>, <code id="TFA_+3A_hf">hf</code>, <code id="TFA_+3A_detrend">detrend</code>, <code id="TFA_+3A_spectral_smoothing">spectral_smoothing</code>, <code id="TFA_+3A_coherence2_thresholds">coherence2_thresholds</code>, <code id="TFA_+3A_apply_coherence2_threshold">apply_coherence2_threshold</code>, <code id="TFA_+3A_remove_negative_phase">remove_negative_phase</code>, <code id="TFA_+3A_remove_negative_phase_f_cutoff">remove_negative_phase_f_cutoff</code>, <code id="TFA_+3A_normalize_abp">normalize_ABP</code>, <code id="TFA_+3A_normalize_cbfv">normalize_CBFV</code>, <code id="TFA_+3A_window_type">window_type</code>, <code id="TFA_+3A_window_length">window_length</code>, <code id="TFA_+3A_overlap">overlap</code>, <code id="TFA_+3A_overlap_adjust">overlap_adjust</code>, <code id="TFA_+3A_na_as_mean">na_as_mean</code></td>
<td>
<p>See <strong>TFA-parameters</strong></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Using a <em>continuous</em> raw recording, <code>TFA()</code> calculates dynamic cerebral autoregulation trough a transfer function analysis. This function utilizes the recommendations from Claassen et al [1] and mimicks the matlab script created by David Simpsons in 2015.</p>
<pre>View(data)
</pre>
<table>
<tr>
 <td style="text-align: right;">
   <code>time</code> </td><td style="text-align: right;"> <code>abp</code> </td><td style="text-align: right;"> <code>mcav</code> </td>
</tr>
<tr>
 <td style="text-align: right;">
   <code>7.00</code> </td><td style="text-align: right;"> <code>78</code> </td><td style="text-align: right;"> <code>45</code> </td>
</tr>
<tr>
 <td style="text-align: right;">
   <code>7.01</code> </td><td style="text-align: right;"> <code>78</code> </td><td style="text-align: right;"> <code>46</code> </td>
</tr>
<tr>
 <td style="text-align: right;">
   <code>...</code> </td><td style="text-align: right;"> <code>...</code> </td><td style="text-align: right;"> <code>...</code> </td>
</tr>
<tr>
 <td style="text-align: right;">
   <code>301.82</code> </td><td style="text-align: right;"> <code>82</code> </td><td style="text-align: right;"> <code>70</code> </td>
</tr>
<tr>
 <td style="text-align: right;">
   <code>301.83</code> </td><td style="text-align: right;"> <code>81</code> </td><td style="text-align: right;"> <code>69</code> </td>
</tr>
<tr>
 <td style="text-align: right;">
</td>
</tr>

</table>

<p>To calculate the variables insert the data and select the relevant variables.</p>
<pre>TFA(df=data, variables=c("abp","mcav"))
</pre>
<p>See <strong>Value</strong> for output description.
</p>


<h3>Value</h3>

<p><code>TFA()</code> returns a dataframe depending on the output selected. <code>'table'</code> results in a dataframe with values for the three frequencies defined by Claassen et al. [1]; <code>'long'</code> results in a dataframe with the results in a long format; <code>'plot'</code> results in a daframe which can help plot gain, phase and coherence; <code>'plot-peak'</code> results in a dataframe, which can be used to validate the cyclic average, and <code>'raw'</code> results in a nested list with results primarily for debugging.
</p>
<p>Some generic variables are listed below:
</p>

<ul>
<li> <p><code>abp_power</code> - The blood pressure power measured in mmHg^2.
</p>
</li>
<li> <p><code>cbfv_power</code> - The cerebral blood flow velocity power measured in cm^2\*s^-2
</p>
</li>
<li> <p><code>coherence</code> - Coherence.
</p>
</li>
<li> <p><code>gain_not_normal</code> - Not normalized gain measured in cm\*s^-1\*mmHg^-1.
</p>
</li>
<li> <p><code>gain_normal</code> - Normalized gain measured in %\*mmHg^-1.
</p>
</li>
<li> <p><code>phase</code> - Phase measured in radians.
</p>
</li></ul>



<h4>output = 'table'</h4>

<p>Wide format output table with period, VLF, LF, and HF as columns, and the TFA-variables as rows.</p>

<table>
<tr>
 <td style="text-align: left;">
   <code>period</code> </td><td style="text-align: right;"> <code>variable</code> </td><td style="text-align: right;"> <code>vlf</code> </td><td style="text-align: right;"> <code>lf</code> </td><td style="text-align: right;"> <code>hf</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>1</code> </td><td style="text-align: right;"> <code>abp_power</code> </td><td style="text-align: right;"> <code>6.25</code> </td><td style="text-align: right;"> <code>1.56</code> </td><td style="text-align: right;"> <code>0.21</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>1</code> </td><td style="text-align: right;"> <code>cbfv_power</code> </td><td style="text-align: right;"> <code>3.22</code> </td><td style="text-align: right;"> <code>2.25</code> </td><td style="text-align: right;"> <code>0.30</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>...</code> </td><td style="text-align: right;"> <code>...</code> </td><td style="text-align: right;"> <code>...</code> </td><td style="text-align: right;"> <code>...</code> </td><td style="text-align: right;"> <code>...</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>3</code> </td><td style="text-align: right;"> <code>gain_normal</code> </td><td style="text-align: right;"> <code>1.04</code> </td><td style="text-align: right;"> <code>1.48</code> </td><td style="text-align: right;"> <code>1.85</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>3</code> </td><td style="text-align: right;"> <code>phase</code> </td><td style="text-align: right;"> <code>53.0</code> </td><td style="text-align: right;"> <code>25.4</code> </td><td style="text-align: right;"> <code>9.38</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>




<h4>output = 'long'</h4>

<p>Long format output table which can be manipulated depending on the intended use, with period, interval, variables and values as columns.</p>

<table>
<tr>
 <td style="text-align: right;">
   <code>period</code> </td><td style="text-align: left;"> <code>interval</code> </td><td style="text-align: left;"> <code>variable</code> </td><td style="text-align: right;"> <code>values</code> </td>
</tr>
<tr>
 <td style="text-align: right;">
   <code>1</code> </td><td style="text-align: left;"> <code>hf</code> </td><td style="text-align: left;"> <code>abp_power</code> </td><td style="text-align: right;"> <code>6.25</code> </td>
</tr>
<tr>
 <td style="text-align: right;">
   <code>1</code> </td><td style="text-align: left;"> <code>hf</code> </td><td style="text-align: left;"> <code>cbfv_power</code> </td><td style="text-align: right;"> <code>3.22</code> </td>
</tr>
<tr>
 <td style="text-align: right;">
   <code>...</code> </td><td style="text-align: left;"> <code>...</code> </td><td style="text-align: left;"> <code>...</code> </td><td style="text-align: right;"> <code>...</code> </td>
</tr>
<tr>
 <td style="text-align: right;">
   <code>2</code> </td><td style="text-align: left;"> <code>vlf</code> </td><td style="text-align: left;"> <code>gain_norm</code> </td><td style="text-align: right;"> <code>1.85</code> </td>
</tr>
<tr>
 <td style="text-align: right;">
   <code>2</code> </td><td style="text-align: left;"> <code>vlf</code> </td><td style="text-align: left;"> <code>phase</code> </td><td style="text-align: right;"> <code>9.38</code> </td>
</tr>
<tr>
 <td style="text-align: right;">
</td>
</tr>

</table>




<h4>output = 'plot'</h4>

<p>Plot format output table which can be used to draw figures with gain, phase and coherence depending on frequency.</p>

<table>
<tr>
 <td style="text-align: right;">
   <code>period</code> </td><td style="text-align: right;"> <code>freq</code> </td><td style="text-align: right;"> <code>gain</code> </td><td style="text-align: right;"> <code>phase</code> </td><td style="text-align: right;"> <code>coherence</code> </td>
</tr>
<tr>
 <td style="text-align: right;">
   <code>1</code> </td><td style="text-align: right;"> <code>0.00</code> </td><td style="text-align: right;"> <code>0.16</code> </td><td style="text-align: right;"> <code>0.00</code> </td><td style="text-align: right;"> <code>0.04</code> </td>
</tr>
<tr>
 <td style="text-align: right;">
   <code>1</code> </td><td style="text-align: right;"> <code>0.01</code> </td><td style="text-align: right;"> <code>0.29</code> </td><td style="text-align: right;"> <code>4.22</code> </td><td style="text-align: right;"> <code>0.29</code> </td>
</tr>
<tr>
 <td style="text-align: right;">
   <code>...</code> </td><td style="text-align: right;"> <code>...</code> </td><td style="text-align: right;"> <code>...</code> </td><td style="text-align: right;"> <code>...</code> </td><td style="text-align: right;"> <code>...</code> </td>
</tr>
<tr>
 <td style="text-align: right;">
   <code>2</code> </td><td style="text-align: right;"> <code>1.55</code> </td><td style="text-align: right;"> <code>1.15</code> </td><td style="text-align: right;"> <code>-43.2</code> </td><td style="text-align: right;"> <code>0.64</code> </td>
</tr>
<tr>
 <td style="text-align: right;">
   <code>2</code> </td><td style="text-align: right;"> <code>1.56</code> </td><td style="text-align: right;"> <code>1.16</code> </td><td style="text-align: right;"> <code>-41.1</code> </td><td style="text-align: right;"> <code>0.42</code> </td>
</tr>
<tr>
 <td style="text-align: right;">
</td>
</tr>

</table>




<h3>TFA-paramters</h3>

<p>A series of parameters that control TFA analysis (window-length, frequency bands …). If this is not provided, default values, corresponding to those recommended in the white paper, will be used. These default values are given below for each parameter.
</p>

<ul>
<li> <p><code>vlf</code> Limits of <em>very low frequency</em> band (in Hz). This corresponds to the matematical inclusion of <code style="white-space: pre;">&#8288;[X:Y[&#8288;</code>. Default is <code>c(0.02-0.07)</code>.
</p>
</li>
<li> <p><code>lf</code> Limits of <em>low frequency</em> band (in Hz). This corresponds to the matematical inclusion of <code style="white-space: pre;">&#8288;[X:Y[&#8288;</code>. Default is <code>c(0.07-0.2)</code>.
</p>
</li>
<li> <p><code>hf</code> Limits of <em>high frequency</em> band (in Hz). This corresponds to the matematical inclusion of <code style="white-space: pre;">&#8288;[X:Y[&#8288;</code>. Default is <code>c(0.2-0.5)</code>.
</p>
</li>
<li> <p><code>detrend</code> Linear detrending of data prior to TFA-analysis (detrending is carried out as one continuous trend over the whole length of the recording, not segment-by-segment). Default is <code>FALSE</code>.
</p>
</li>
<li> <p><code>spectral_smoothing</code> The length, in samples, of the triangular spectral smoothing function. Note that this must be an odd number, to ensure that smoothing is symmetrical around the centre frequency. Default is <code>3</code>.
</p>
</li>
<li> <p><code>coherence2_thresholds</code> The critical values (alpha=5%, second column) for coherence for a number of windows (first column, here from 3 to 15). These values were obtained by Monte Carlo simulation, using the default parameter settings for the TFA-analysis (Hanning window, overlap of 50% and 3-point spectral smoothing was assumed). These values should be recalculated for different settings. Note that if <code>overlap_adjust=TRUE</code>, the overlap will vary depending on the length of data. With an overlap of 60% (see below), the critical values increase by between 0.04 (for 3 windows) and 0.02 (for 15 windows). Default is <code style="white-space: pre;">&#8288;cbind(c(3:15),c(0.51,0.40,&#8288;</code> <code style="white-space: pre;">&#8288;0.34,0.29,0.25,0.22,0.20,0.18,0.17,&#8288;</code> <code style="white-space: pre;">&#8288;0.15,0.14,0.13,0.12))&#8288;</code>.
</p>
</li>
<li> <p><code>apply_coherence2_threshold</code> Apply the thresholds given above to the TFA-estimates. All frequencies with magnitude-squared coherence below the threshold value are excluded from averaging when calculating the mean values of gain and phase across the bands. Note that low values of coherence are not excluded in the average of coherence across the bands. Default is <code>TRUE</code>.
</p>
</li>
<li> <p><code>remove_negative_phase</code> Remove (ignore) negative values of phase in averaging across bands. Negative phase values are removed only for frequencies below the frequency given below, when calculating the average phase in bands. Default is <code>TRUE</code>.
</p>
</li>
<li> <p><code>remove_negative_phase_f_cutoff</code> The cut-off frequency below-which negative phase values are neglected (only if <code>remove_negative_phase</code> is <code>TRUE</code>). Default is <code>0.1</code>.
</p>
</li>
<li> <p><code>normalize_ABP</code> Normalize ABP by dividing by the mean and multiplying by 100, to express ABP change in %. Note that mean-values are always removed from ABP prior to analysis. Default is <code>FALSE</code>.
</p>
</li>
<li> <p><code>normalize_CBFV</code> Normalize CBFV by dividing by the mean and multiplying by 100, to express CBFV change in %. Note that the band-average values of gain are always calculated both with and without normalization of CBFV, in accordance with the recommendations. Note also that mean-values are always removed from CBFV prior to analysis. Default is <code>FALSE</code>.
</p>
</li>
<li> <p><code>window_type</code> Chose window <code>'hanning'</code> or <code>'boxcar'</code>. Default is <code>'hanning'</code>.
</p>
</li>
<li> <p><code>window_length</code> Length of the data-window, in seconds. Default is <code>102.4</code>.
</p>
</li>
<li> <p><code>overlap</code> Overlap of the windows, in %. If <code>overlap_adjust</code> is <code>TRUE</code> (see below), then this value may be automatically reduced, to ensure that windows cover the full length of data. Default is <code style="white-space: pre;">&#8288;59.99%&#8288;</code> rather than 60%, so that with data corresponding to 5 windows of 100 s at an overlap of 50%, 5 windows are indeed chosen.
</p>
</li>
<li> <p><code>overlap_adjust</code> Ensure that the full length of data is used (i.e. the last window finishes as near as possible to the end of the recording), by adjusting the overlap up to a maximum value given by params.overlap. Default is <code>TRUE</code>.
</p>
</li>
<li> <p><code>na_as_mean</code> Changes all missing non-interpolated values to the mean value of the corresponding variable. This have not been adressed in the paper by Claassen, and to ensure the dataframes are not 'gathered' this should generate the most stable results. Default is <code>TRUE</code>.
</p>
</li></ul>



<h3>References</h3>


<ol>
<li><p> Claassen et al. (2016) J Cereb Blood Flow Metab. 2016 Apr;36(4):665-80. (<a href="https://pubmed.ncbi.nlm.nih.gov/26782760/">PubMed</a>)
</p>
</li></ol>



<h3>Examples</h3>

<pre><code class='language-R'>df &lt;- data.frame(seq(1, 901, 0.1),
         rnorm(9001), rnorm(9001))
TFA(df, variables=c("abp","mcav"), freq=10)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
