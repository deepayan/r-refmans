<!DOCTYPE html><html lang="en"><head><title>Help for package VDPO</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {VDPO}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#data_generator_vd'><p>Data generator function for the variable domain case</p></a></li>
<li><a href='#ffvd'><p>Defining variable domain functional data terms in vd_fit formulae</p></a></li>
<li><a href='#vd_fit'><p>Estimation of the generalized additive functional regression models for</p>
variable domain functional data</a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Working with and Analyzing Functional Data of Varying Lengths</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Comprehensive set of tools for analyzing and manipulating functional
 data with non-uniform lengths. This package addresses two common scenarios in
 functional data analysis: Variable Domain Data, where the observation domain
 differs across samples, and Partially Observed Data, where observations are
 incomplete over the domain of interest. 'VDPO' enhances the flexibility and
 applicability of functional data analysis in 'R'.
 See Amaro et al. (2024) &lt;<a href="https://doi.org/10.48550%2FarXiv.2401.05839">doi:10.48550/arXiv.2401.05839</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>utils, Matrix, SOP, splines, stats</td>
</tr>
<tr>
<td>Suggests:</td>
<td>ggplot2, knitr, RColorBrewer, rmarkdown, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://pavel-hernadez-amaro.github.io/VDPO/">https://pavel-hernadez-amaro.github.io/VDPO/</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-10-17 17:14:58 UTC; nacho</td>
</tr>
<tr>
<td>Author:</td>
<td>Pavel Hernandez [aut, cre],
  Jose Ignacio Diez [ctr],
  Maria Durban [ctb],
  Maria del Carmen Aguilera-Morillo [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Pavel Hernandez &lt;pavel.amaro96@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-10-21 11:30:26 UTC</td>
</tr>
</table>
<hr>
<h2 id='data_generator_vd'>Data generator function for the variable domain case</h2><span id='topic+data_generator_vd'></span>

<h3>Description</h3>

<p>Generates a variable domain functional regression model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data_generator_vd(
  N = 100,
  J = 100,
  nsims = 1,
  Rsq = 0.95,
  aligned = TRUE,
  multivariate = FALSE,
  beta_index = 1,
  use_x = FALSE,
  use_f = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="data_generator_vd_+3A_n">N</code></td>
<td>
<p>Number of subjects.</p>
</td></tr>
<tr><td><code id="data_generator_vd_+3A_j">J</code></td>
<td>
<p>Number of maximum observations per subject.</p>
</td></tr>
<tr><td><code id="data_generator_vd_+3A_nsims">nsims</code></td>
<td>
<p>Number of simulations per the simulation study.</p>
</td></tr>
<tr><td><code id="data_generator_vd_+3A_rsq">Rsq</code></td>
<td>
<p>Variance of the model.</p>
</td></tr>
<tr><td><code id="data_generator_vd_+3A_aligned">aligned</code></td>
<td>
<p>If the data that will be generated is aligned or not.</p>
</td></tr>
<tr><td><code id="data_generator_vd_+3A_multivariate">multivariate</code></td>
<td>
<p>If TRUE, the data is generated with 2 functional variables.</p>
</td></tr>
<tr><td><code id="data_generator_vd_+3A_beta_index">beta_index</code></td>
<td>
<p>Index for the beta.</p>
</td></tr>
<tr><td><code id="data_generator_vd_+3A_use_x">use_x</code></td>
<td>
<p>If the data is generated with x.</p>
</td></tr>
<tr><td><code id="data_generator_vd_+3A_use_f">use_f</code></td>
<td>
<p>If the data is generated with f.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the following components:
</p>

<ul>
<li><p> y: <code>vector</code> of length N containing the response variable.
</p>
</li>
<li><p> X_s: <code>matrix</code> of non-noisy functional data for the first functional covariate.
</p>
</li>
<li><p> X_se: <code>matrix</code> of noisy functional data for the first functional covariate
</p>
</li>
<li><p> Y_s: <code>matrix</code> of non-noisy functional data for the second functional covariate (if multivariate).
</p>
</li>
<li><p> Y_se: <code>matrix</code> of noisy functional data for the second covariate (if multivariate).
</p>
</li>
<li><p> x1: <code>vector</code> of length N containing the non-functional covariate (if use_x is TRUE).
</p>
</li>
<li><p> x2: <code>vector</code> of length N containing the observed values of the smooth term (if use_f is TRUE).
</p>
</li>
<li><p> smooth_term: <code>vector</code> of length N containing a smooth term (if use_f is TRUE).
</p>
</li>
<li><p> Beta: <code>array</code> containing the true functional coefficients.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'># Basic usage with default parameters
sim_data &lt;- data_generator_vd()

# Generate data with non-aligned domains
non_aligned_data &lt;- data_generator_vd(N = 150, J = 120, aligned = FALSE)

# Generate multivariate functional data
multivariate_data &lt;- data_generator_vd(N = 200, J = 100, multivariate = TRUE)

# Generate data with non-functional covariates and smooth term
complex_data &lt;- data_generator_vd(
  N = 100,
  J = 150,
  use_x = TRUE,
  use_f = TRUE
)

# Generate data with a different beta function and R-squared value
custom_beta_data &lt;- data_generator_vd(
  N = 80,
  J = 80,
  beta_index = 2,
  Rsq = 0.8
)

# Access components of the generated data
y &lt;- sim_data$y # Response variable
X_s &lt;- sim_data$X_s # Noise-free functional covariate
X_se &lt;- sim_data$X_se # Noisy functional covariate

</code></pre>

<hr>
<h2 id='ffvd'>Defining variable domain functional data terms in vd_fit formulae</h2><span id='topic+ffvd'></span>

<h3>Description</h3>

<p>Auxiliary function used to define <code>ffvd</code> terms within <code>vd_fit</code> model formulae.
This term represents a functional predictor where each function is observed over a domain of varying length.
The formulation is <code class="reqn">\frac{1}{T_i} \int _1^{T_i} X_i(t)\beta(t,T_i)dt</code>, where <code class="reqn">X_i(t)</code> is a functional covariate of length <code class="reqn">T_i</code>, and <code class="reqn">\beta(t,T_i)</code> is an unknown bivariate functional coefficient.
The functional basis used to model this term is the B-spline basis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ffvd(X, grid, nbasis = c(30, 50, 30), bdeg = c(3, 3, 3))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ffvd_+3A_x">X</code></td>
<td>
<p>variable domain functional covariate <code>matrix</code>.</p>
</td></tr>
<tr><td><code id="ffvd_+3A_grid">grid</code></td>
<td>
<p>observation points of the variable domain functional covariate.
If not provided, it will be <code>1:ncol(X)</code>.</p>
</td></tr>
<tr><td><code id="ffvd_+3A_nbasis">nbasis</code></td>
<td>
<p>number of bspline basis to be used.</p>
</td></tr>
<tr><td><code id="ffvd_+3A_bdeg">bdeg</code></td>
<td>
<p>degree of the bspline basis used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the function is interpreted in the formula of a <code>VDPO</code> model.
<code>list</code> containing the following elements:
</p>

<ul>
<li><p> An item named <code>B</code> design matrix.
</p>
</li>
<li><p> An item named <code>X_hat</code> smoothed functional covariate.
</p>
</li>
<li><p> An item named <code>L_Phi</code> and <code>B_T</code> 1-dimensional marginal B-spline basis used for the functional coefficient.
</p>
</li>
<li><p> An item named <code>M</code> matrix object indicating the observed domain of the data.
</p>
</li>
<li><p> An item named <code>nbasis</code> number of basis used.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'># Generate sample data
set.seed(123)
data &lt;- data_generator_vd(beta_index = 1, use_x = FALSE, use_f = FALSE)
X &lt;- data$X_se

# Specifying a custom grid
custom_grid &lt;- seq(0, 1, length.out = ncol(X))
ffvd_term_custom_grid &lt;- ffvd(X, grid = custom_grid, nbasis = c(10, 10, 10))

# Customizing the number of basis functions
ffvd_term_custom_basis &lt;- ffvd(X, nbasis = c(10, 10, 10))

# Customizing both basis functions and degrees
ffvd_term_custom &lt;- ffvd(X, nbasis = c(10, 10, 10), bdeg = c(3, 3, 3))

</code></pre>

<hr>
<h2 id='vd_fit'>Estimation of the generalized additive functional regression models for
variable domain functional data</h2><span id='topic+vd_fit'></span>

<h3>Description</h3>

<p>The <code>vd_fit</code> function fits generalized additive functional regression models
for variable domain functional data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vd_fit(formula, data, family = stats::gaussian(), offset = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="vd_fit_+3A_formula">formula</code></td>
<td>
<p>a formula object with at least one <code>ffvd</code> term.</p>
</td></tr>
<tr><td><code id="vd_fit_+3A_data">data</code></td>
<td>
<p>a <code>list</code> object containing the response variable
and the covariates as the components of the list.</p>
</td></tr>
<tr><td><code id="vd_fit_+3A_family">family</code></td>
<td>
<p>a <code>family</code> object specifying the distribution from which the
data originates. The default distribution is <code><a href="stats.html#topic+gaussian">gaussian</a></code>.</p>
</td></tr>
<tr><td><code id="vd_fit_+3A_offset">offset</code></td>
<td>
<p>An offset vector. The default value is <code>NULL</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>vd_fit</code>. It is a <code>list</code> containing the following items:
</p>

<ul>
<li><p> An item named <code>fit</code> of class <code>sop</code>. See <a href="SOP.html#topic+sop.fit">sop.fit</a>.
</p>
</li>
<li><p> An item named <code>Beta</code> which is the estimated functional coefficient.
</p>
</li>
<li><p> An item named <code>theta</code> which is the basis coefficient of <code>Beta</code>.
</p>
</li>
<li><p> An item named <code>covar_theta</code> which is the covariance matrix of <code>theta</code>.
</p>
</li>
<li><p> An item named <code>M</code> which is the number of observations points for each curve.
</p>
</li>
<li><p> An item named <code>ffvd_evals</code> which is the result of the evaluations of the <code>ffvd</code>
terms in the formula.
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+ffvd">ffvd</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># VARIABLE DOMAIN FUNCTIONAL DATA EXAMPLE

# set seed for reproducibility
set.seed(42)

# generate example data
data &lt;- data_generator_vd(
  N = 100,
  J = 100,
  beta_index = 1,
  use_x = TRUE,
  use_f = TRUE,
)

# Define a formula object that specifies the model behavior.
# The formula includes a functional form of the variable 'X_se' using 'ffvd'
# with a non-default number of basis functions ('nbasis' is set to c(10, 10, 10)).
# Additionally, it includes a smooth function 'f' applied to 'x2' with 10 segments ('nseg = 10'),
# a second-order penalty ('pord = 2'), and cubic splines ('degree = 3').
# The model also contains the linear term 'x1'.
formula &lt;- y ~ ffvd(X_se, nbasis = c(10, 10, 10)) + f(x2, nseg = 10, pord = 2, degree = 3) + x1

# We can fit the model using the data and the formula
res &lt;- vd_fit(formula = formula, data = data)

# Some important parameters of the model can be accesed as follows
res$Beta # variable domain functional coefficient
res$fit$fitted.values # estimated response variable

# Also, a summary of the fit can be accesed using the summary function
summary(res)

# And a heatmap for an specific beta can be obtained using the plot function
plot(res, beta_index = 1)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
