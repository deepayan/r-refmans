<!DOCTYPE html><html lang="en"><head><title>Help for package ReIns</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ReIns}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Burr'>
<p>The Burr distribution</p></a></li>
<li><a href='#cEPD'>
<p>EPD estimator for right censored data</p></a></li>
<li><a href='#cExpQQ'>
<p>Exponential quantile plot for right censored data</p></a></li>
<li><a href='#cgenHill'>
<p>Generalised Hill estimator for right censored data</p></a></li>
<li><a href='#cGPDmle'>
<p>GPD-ML estimator for right censored data</p></a></li>
<li><a href='#cHill'>
<p>Hill estimator for right censored data</p></a></li>
<li><a href='#cLognormalQQ'>
<p>Log-normal quantile plot for right censored data</p></a></li>
<li><a href='#cMoment'>
<p>MOM estimator for right censored data</p></a></li>
<li><a href='#cParetoQQ'>
<p>Pareto quantile plot for right censored data</p></a></li>
<li><a href='#cProb'>
<p>Estimator of small exceedance probabilities and large return periods using censored Hill</p></a></li>
<li><a href='#cProbEPD'>
<p>Estimator of small exceedance probabilities and large return periods using censored EPD</p></a></li>
<li><a href='#cProbGH'>
<p>Estimator of small exceedance probabilities and large return periods using censored generalised Hill</p></a></li>
<li><a href='#cProbGPD'>
<p>Estimator of small exceedance probabilities and large return periods using censored GPD-MLE</p></a></li>
<li><a href='#cProbMOM'>
<p>Estimator of small exceedance probabilities and large return periods using censored MOM</p></a></li>
<li><a href='#cQuant'>
<p>Estimator of large quantiles using censored Hill</p></a></li>
<li><a href='#cQuantGH'>
<p>Estimator of large quantiles using censored Hill</p></a></li>
<li><a href='#cQuantGPD'>
<p>Estimator of large quantiles using censored GPD-MLE</p></a></li>
<li><a href='#cQuantMOM'>
<p>Estimator of large quantiles using censored MOM</p></a></li>
<li><a href='#crHill'>
<p>Hill-type estimator for the conditional EVI</p></a></li>
<li><a href='#crParetoQQ'>
<p>Conditional Pareto quantile plot for right censored data</p></a></li>
<li><a href='#crSurv'>
<p>Non-parametric estimator of conditional survival function</p></a></li>
<li><a href='#CTE'>
<p>Conditional Tail Expectation</p></a></li>
<li><a href='#cWeibullQQ'>
<p>Weibull quantile plot for right censored data</p></a></li>
<li><a href='#EPD'>
<p>EPD estimator</p></a></li>
<li><a href='#EPDfit'>
<p>Fit EPD using MLE</p></a></li>
<li><a href='#EVTfit'>
<p>EVT fit</p></a></li>
<li><a href='#ExcessEPD'>
<p>Estimates for excess-loss premiums using EPD estimates</p></a></li>
<li><a href='#ExcessGPD'>
<p>Estimates for excess-loss premiums using GPD-MLE estimates</p></a></li>
<li><a href='#ExcessPareto'>
<p>Estimates for excess-loss premiums using a Pareto model</p></a></li>
<li><a href='#ExcessSplice'>
<p>Estimates for excess-loss premiums using splicing</p></a></li>
<li><a href='#ExpQQ'>
<p>Exponential quantile plot</p></a></li>
<li><a href='#Extended+20Pareto'>
<p>The Extended Pareto Distribution</p></a></li>
<li><a href='#Frechet'>
<p>The Frechet distribution</p></a></li>
<li><a href='#genHill'>
<p>Generalised Hill estimator</p></a></li>
<li><a href='#genQQ'>
<p>Generalised quantile plot</p></a></li>
<li><a href='#GPD'>
<p>The generalised Pareto distribution</p></a></li>
<li><a href='#GPDfit'>
<p>Fit GPD using MLE</p></a></li>
<li><a href='#GPDmle'>
<p>GPD-ML estimator</p></a></li>
<li><a href='#GPDresiduals'>
<p>GPD residual plot</p></a></li>
<li><a href='#Hill'>
<p>Hill estimator</p></a></li>
<li><a href='#Hill.2oQV'>
<p>Bias-reduced MLE (Quantile view)</p></a></li>
<li><a href='#Hill.kopt'>
<p>Select optimal threshold for Hill estimator</p></a></li>
<li><a href='#icHill'>
<p>Hill estimator for interval censored data</p></a></li>
<li><a href='#icParetoQQ'>
<p>Pareto quantile plot for interval censored data</p></a></li>
<li><a href='#KaplanMeier'>
<p>Kaplan-Meier estimator</p></a></li>
<li><a href='#LognormalQQ'>
<p>Log-normal quantile plot</p></a></li>
<li><a href='#LognormalQQ_der'>
<p>Derivative plot of the log-normal QQ-plot</p></a></li>
<li><a href='#LStail'>
<p>Least Squares tail estimator</p></a></li>
<li><a href='#MeanExcess'>
<p>Mean excess function</p></a></li>
<li><a href='#MeanExcess_TB'>
<p>Mean excess function using Turnbull estimator</p></a></li>
<li><a href='#MEfit'>
<p>Mixed Erlang fit</p></a></li>
<li><a href='#Moment'>
<p>Moment estimator</p></a></li>
<li><a href='#norwegianfire'>
<p>Norwegian fire insurance data</p></a></li>
<li><a href='#Pareto'>
<p>The Pareto distribution</p></a></li>
<li><a href='#ParetoQQ'>
<p>Pareto quantile plot</p></a></li>
<li><a href='#ParetoQQ_der'>
<p>Derivative plot of the Pareto QQ-plot</p></a></li>
<li><a href='#pClas'>
<p>Classical estimators for the CDF</p></a></li>
<li><a href='#pEdge'>
<p>Edgeworth approximation</p>
</p></a></li>
<li><a href='#pGC'>
<p>Gram-Charlier approximation</p></a></li>
<li><a href='#Prob'>
<p>Weissman estimator of small exceedance probabilities and large return periods</p></a></li>
<li><a href='#ProbEPD'>
<p>Estimator of small exceedance probabilities and large return periods using EPD</p></a></li>
<li><a href='#ProbGH'>
<p>Estimator of small exceedance probabilities and large return periods using generalised Hill</p></a></li>
<li><a href='#ProbGPD'>
<p>Estimator of small exceedance probabilities and large return periods using GPD-MLE</p></a></li>
<li><a href='#ProbMOM'>
<p>Estimator of small exceedance probabilities and large return periods using MOM</p></a></li>
<li><a href='#ProbReg'>
<p>Estimator of small tail probability in regression</p></a></li>
<li><a href='#Quant'>
<p>Weissman estimator of extreme quantiles</p></a></li>
<li><a href='#Quant.2oQV'>
<p>Second order refined Weissman estimator of extreme quantiles (QV)</p></a></li>
<li><a href='#QuantGH'>
<p>Estimator of extreme quantiles using generalised Hill</p></a></li>
<li><a href='#QuantGPD'>
<p>Estimator of extreme quantiles using GPD-MLE</p></a></li>
<li><a href='#QuantMOM'>
<p>Estimator of extreme quantiles using MOM</p></a></li>
<li><a href='#QuantReg'>
<p>Estimator of extreme quantiles in regression</p></a></li>
<li><a href='#Scale'>
<p>Scale estimator</p></a></li>
<li><a href='#Scale.2o'>
<p>Bias-reduced scale estimator using second order Hill estimator</p></a></li>
<li><a href='#ScaleEPD'>
<p>Bias-reduced scale estimator using EPD estimator</p></a></li>
<li><a href='#ScaleReg'>
<p>Scale estimator in regression</p></a></li>
<li><a href='#secura'>
<p>Secura dataset</p></a></li>
<li><a href='#soa'>
<p>SOA Group Medical Insurance Large Claims Database</p></a></li>
<li><a href='#Splice'>
<p>Spliced distribution</p></a></li>
<li><a href='#SpliceECDF'>
<p>Plot of fitted and empirical survival function</p></a></li>
<li><a href='#SpliceFit'>
<p>Splicing fit</p></a></li>
<li><a href='#SpliceFitGPD'>
<p>Splicing of mixed Erlang and GPD using POT-MLE</p></a></li>
<li><a href='#SpliceFiticPareto'>
<p>Splicing of mixed Erlang and Pareto for interval censored data</p></a></li>
<li><a href='#SpliceFitPareto'>
<p>Splicing of mixed Erlang and Pareto</p></a></li>
<li><a href='#SpliceLL'>
<p>LL-plot with fitted and empirical survival function</p></a></li>
<li><a href='#SpliceLL_TB'>
<p>LL-plot with fitted and Turnbull survival function</p></a></li>
<li><a href='#SplicePP'>
<p>PP-plot with fitted and empirical survival function</p></a></li>
<li><a href='#SplicePP_TB'>
<p>PP-plot with fitted and Turnbull survival function</p></a></li>
<li><a href='#SpliceQQ'>
<p>Splicing quantile plot</p></a></li>
<li><a href='#SpliceQQ_TB'>
<p>Splicing quantile plot using Turnbull estimator</p></a></li>
<li><a href='#SpliceTB'>
<p>Plot of fitted and Turnbull survival function</p></a></li>
<li><a href='#stdf'>
<p>Non-parametric estimators of the STDF</p></a></li>
<li><a href='#tBurr'>
<p>The truncated Burr distribution</p></a></li>
<li><a href='#tExp'>
<p>The truncated exponential distribution</p></a></li>
<li><a href='#tFrechet'>
<p>The truncated Frechet distribution</p></a></li>
<li><a href='#tGPD'>
<p>The truncated generalised Pareto distribution</p></a></li>
<li><a href='#tlnorm'>
<p>The truncated log-normal distribution</p></a></li>
<li><a href='#tPareto'>
<p>The truncated Pareto distribution</p></a></li>
<li><a href='#trDT'>
<p>Truncation odds</p></a></li>
<li><a href='#trDTMLE'>
<p>Truncation odds</p></a></li>
<li><a href='#trEndpoint'>
<p>Estimator of endpoint</p></a></li>
<li><a href='#trEndpointMLE'>
<p>Estimator of endpoint</p></a></li>
<li><a href='#trHill'>
<p>Hill estimator for upper truncated data</p></a></li>
<li><a href='#trMLE'>
<p>MLE estimator for upper truncated data</p></a></li>
<li><a href='#trParetoQQ'>
<p>Truncated Pareto quantile plot</p></a></li>
<li><a href='#trProb'>
<p>Estimator of small exceedance probabilities using truncated Hill</p></a></li>
<li><a href='#trProbMLE'>
<p>Estimator of small exceedance probabilities using truncated MLE</p></a></li>
<li><a href='#trQuant'>
<p>Estimator of large quantiles using truncated Hill</p></a></li>
<li><a href='#trQuantMLE'>
<p>Estimator of large quantiles using truncated MLE</p></a></li>
<li><a href='#trTest'>
<p>Test for truncated Pareto-type tails</p></a></li>
<li><a href='#trTestMLE'>
<p>Test for truncated GPD tails</p></a></li>
<li><a href='#Turnbull'>
<p>Turnbull estimator</p></a></li>
<li><a href='#tWeibull'>
<p>The truncated Weibull distribution</p></a></li>
<li><a href='#VaR'>
<p>VaR of splicing fit</p></a></li>
<li><a href='#WeibullQQ'>
<p>Weibull quantile plot</p></a></li>
<li><a href='#WeibullQQ_der'>
<p>Derivative plot of the Weibull QQ-plot</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Version:</td>
<td>1.0.15</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-11-30</td>
</tr>
<tr>
<td>Title:</td>
<td>Functions from "Reinsurance: Actuarial and Statistical Aspects"</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions from the book "Reinsurance: Actuarial and Statistical Aspects" (2017) by Hansjoerg Albrecher, Jan Beirlant and Jef Teugels <a href="https://www.wiley.com/en-us/Reinsurance%3A+Actuarial+and+Statistical+Aspects-p-9780470772683">https://www.wiley.com/en-us/Reinsurance%3A+Actuarial+and+Statistical+Aspects-p-9780470772683</a>.</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Tom Reynkens &lt;tomreynkens.r@gmail.com&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.4)</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, graphics, methods, survival, utils, parallel, foreach
(&ge; 1.4.1), doParallel (&ge; 1.0.10), Rcpp (&ge; 0.12.12)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, knitr, rmarkdown, interval, Icens</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/TReynkens/ReIns">https://github.com/TReynkens/ReIns</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/TReynkens/ReIns/issues">https://github.com/TReynkens/ReIns/issues</a></td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>ByteCompile:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-11-30 13:02:34 UTC; tom</td>
</tr>
<tr>
<td>Author:</td>
<td>Tom Reynkens <a href="https://orcid.org/0000-0002-5516-5107"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Roel Verbelen <a href="https://orcid.org/0000-0002-2347-9240"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut] (R code for Mixed Erlang distribution),
  Anastasios Bardoutsos [ctb] (Original R code for cEPD estimator),
  Dries Cornilly [ctb] (Original R code for EVT estimators for truncated
    data),
  Yuri Goegebeur [ctb] (Original S-Plus code for basic EVT estimators),
  Klaus Herrmann [ctb] (Original R code for GPD estimator)</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-12-02 09:30:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='Burr'>
The Burr distribution
</h2><span id='topic+dburr'></span><span id='topic+pburr'></span><span id='topic+qburr'></span><span id='topic+rburr'></span>

<h3>Description</h3>

<p>Density, distribution function, quantile function and random generation for the Burr distribution (type XII).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dburr(x, alpha, rho, eta = 1, log = FALSE)
pburr(x, alpha, rho, eta = 1, lower.tail = TRUE, log.p = FALSE)
qburr(p, alpha, rho, eta = 1, lower.tail = TRUE, log.p = FALSE)
rburr(n, alpha, rho, eta = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Burr_+3A_x">x</code></td>
<td>

<p>Vector of quantiles.
</p>
</td></tr>
<tr><td><code id="Burr_+3A_p">p</code></td>
<td>

<p>Vector of probabilities.
</p>
</td></tr>
<tr><td><code id="Burr_+3A_n">n</code></td>
<td>

<p>Number of observations.
</p>
</td></tr>
<tr><td><code id="Burr_+3A_alpha">alpha</code></td>
<td>

<p>The <code class="reqn">\alpha</code> parameter of the Burr distribution, a strictly positive number.
</p>
</td></tr>
<tr><td><code id="Burr_+3A_rho">rho</code></td>
<td>

<p>The <code class="reqn">\rho</code> parameter of the Burr distribution, a strictly negative number.
</p>
</td></tr>
<tr><td><code id="Burr_+3A_eta">eta</code></td>
<td>

<p>The <code class="reqn">\eta</code> parameter of the Burr distribution, a strictly positive number.
The default value is <code>1</code>.
</p>
</td></tr>
<tr><td><code id="Burr_+3A_log">log</code></td>
<td>

<p>Logical indicating if the densities are given as <code class="reqn">\log(f)</code>, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="Burr_+3A_lower.tail">lower.tail</code></td>
<td>

<p>Logical indicating if the probabilities are of the form <code class="reqn">P(X\le x)</code> (<code>TRUE</code>) or <code class="reqn">P(X&gt;x)</code> (<code>FALSE</code>). Default is <code>TRUE.</code>
</p>
</td></tr>
<tr><td><code id="Burr_+3A_log.p">log.p</code></td>
<td>

<p>Logical indicating if the probabilities are given as <code class="reqn">\log(p)</code>, default is <code>FALSE</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Cumulative Distribution Function (CDF) of the Burr distribution is equal to
<code class="reqn">F(x) = 1-((\eta+x^{-\rho\times\alpha})/\eta)^{1/\rho}</code> for all <code class="reqn">x \ge 0</code> and <code class="reqn">F(x)=0</code> otherwise. We need that <code class="reqn">\alpha&gt;0</code>, <code class="reqn">\rho&lt;0</code> and <code class="reqn">\eta&gt;0</code>.
</p>
<p>Beirlant et al. (2004) uses parameters <code class="reqn">\eta, \tau, \lambda</code> which correspond to <code class="reqn">\eta</code>,  <code class="reqn">\tau=-\rho\times\alpha</code> and <code class="reqn">\lambda=-1/\rho</code>.
</p>


<h3>Value</h3>

<p><code>dburr</code> gives the density function evaluated in <code class="reqn">x</code>, <code>pburr</code> the CDF evaluated in <code class="reqn">x</code> and <code>qburr</code> the quantile function evaluated in <code class="reqn">p</code>. The length of the result is equal to the length of <code class="reqn">x</code> or <code class="reqn">p</code>.
</p>
<p><code>rburr</code> returns a random sample of length <code class="reqn">n</code>.
</p>


<h3>Author(s)</h3>

<p>Tom Reynkens.
</p>


<h3>References</h3>

<p>Beirlant J., Goegebeur Y., Segers, J. and Teugels, J. (2004). <em>Statistics of Extremes: Theory and Applications</em>, Wiley Series in Probability, Wiley, Chichester.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ptburr">tBurr</a></code>,  <code><a href="stats.html#topic+Distributions">Distributions</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Plot of the PDF
x &lt;- seq(0, 10, 0.01)
plot(x, dburr(x, alpha=2, rho=-1), xlab="x", ylab="PDF", type="l")

# Plot of the CDF
x &lt;- seq(0, 10, 0.01)
plot(x, pburr(x, alpha=2, rho=-1), xlab="x", ylab="CDF", type="l")

</code></pre>

<hr>
<h2 id='cEPD'>
EPD estimator for right censored data
</h2><span id='topic+cEPD'></span>

<h3>Description</h3>

<p>Computes the EPD estimates adapted for right censored data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cEPD(data, censored, rho = -1, beta = NULL, logk = FALSE, 
     plot = FALSE, add = FALSE, main = "EPD estimates of the EVI", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cEPD_+3A_data">data</code></td>
<td>

<p>Vector of <code class="reqn">n</code> observations. 
</p>
</td></tr>
<tr><td><code id="cEPD_+3A_censored">censored</code></td>
<td>

<p>A logical vector of length <code class="reqn">n</code> indicating if an observation is censored.
</p>
</td></tr>
<tr><td><code id="cEPD_+3A_rho">rho</code></td>
<td>

<p>A parameter for the <code class="reqn">\rho</code>-estimator of Fraga Alves et al. (2003)
when strictly positive or choice(s) for <code class="reqn">\rho</code> if negative. Default is <code>-1</code>.
</p>
</td></tr>
<tr><td><code id="cEPD_+3A_beta">beta</code></td>
<td>

<p>Parameter for EPD (<code class="reqn">\beta=-\rho/\gamma</code>). If <code>NULL</code> (default), <code>beta</code> is estimated by
<code class="reqn">-\rho/H_{k,n}</code> with <code class="reqn">H_{k,n}</code> the Hill estimator.
</p>
</td></tr>
<tr><td><code id="cEPD_+3A_logk">logk</code></td>
<td>

<p>Logical indicating if the estimates are plotted as a function of <code class="reqn">\log(k)</code> (<code>logk=TRUE</code>) or as a function of <code class="reqn">k</code>. Default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="cEPD_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the estimates of <code class="reqn">\gamma</code> should be plotted as a function of <code class="reqn">k</code>, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="cEPD_+3A_add">add</code></td>
<td>

<p>Logical indicating if the estimates of <code class="reqn">\gamma</code> should be added to an existing plot, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="cEPD_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"EPD estimates of the EVI"</code>.
</p>
</td></tr>
<tr><td><code id="cEPD_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>EPD</code> uses <code class="reqn">\tau</code> which is equal to <code class="reqn">-\beta</code>.
</p>
<p>This estimator is only suitable for right censored data.
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>k</code></td>
<td>
<p>Vector of the values of the tail parameter <code class="reqn">k</code>.</p>
</td></tr>
<tr><td><code>gamma1</code></td>
<td>
<p>Vector of the corresponding estimates for the <code class="reqn">\gamma</code> parameter of the EPD.</p>
</td></tr>
<tr><td><code>kappa1</code></td>
<td>
<p>Vector of the corresponding MLE estimates for the <code class="reqn">\kappa</code> parameter of the EPD.</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>Vector of estimates for (or values of) the <code class="reqn">\beta</code> parameter of the EPD.</p>
</td></tr>
<tr><td><code>Delta</code></td>
<td>
<p>Difference between <code>gamma1</code> and the Hill estimator for censored data.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens based on <code>R</code> code from Anastasios Bardoutsos.
</p>


<h3>References</h3>

<p>Beirlant, J., Bardoutsos, A., de Wet, T. and Gijbels, I. (2016). &quot;Bias Reduced Tail Estimation for Censored Pareto Type Distributions.&quot; <em>Statistics &amp; Probability Letters</em>, 109, 78&ndash;88.
</p>
<p>Fraga Alves, M.I. , Gomes, M.I. and de Haan, L. (2003). &quot;A New Class of Semi-parametric Estimators of the Second Order Parameter.&quot; <em>Portugaliae Mathematica</em>, 60, 193&ndash;214.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+EPD">EPD</a></code>, <code><a href="#topic+cProbEPD">cProbEPD</a></code>, <code><a href="#topic+cGPDmle">cGPDmle</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Set seed
set.seed(29072016)

# Pareto random sample
X &lt;- rpareto(500, shape=2)

# Censoring variable
Y &lt;- rpareto(500, shape=1)

# Observed sample
Z &lt;- pmin(X, Y)

# Censoring indicator
censored &lt;- (X&gt;Y)

# EPD estimator adapted for right censoring
cepd &lt;- cEPD(Z, censored=censored, plot=TRUE)
</code></pre>

<hr>
<h2 id='cExpQQ'>
Exponential quantile plot for right censored data
</h2><span id='topic+cExpQQ'></span>

<h3>Description</h3>

<p>Exponential QQ-plot adapted for right censored data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cExpQQ(data, censored, plot = TRUE, main = "Exponential QQ-plot", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cExpQQ_+3A_data">data</code></td>
<td>

<p>Vector of <code class="reqn">n</code> observations. 
</p>
</td></tr>
<tr><td><code id="cExpQQ_+3A_censored">censored</code></td>
<td>

<p>A logical vector of length <code class="reqn">n</code> indicating if an observation is censored.
</p>
</td></tr>
<tr><td><code id="cExpQQ_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the quantiles should be plotted in an exponential QQ-plot, default is <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="cExpQQ_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"Exponential QQ-plot"</code>.
</p>
</td></tr>
<tr><td><code id="cExpQQ_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The exponential QQ-plot adapted for right censoring is given by
</p>
<p style="text-align: center;"><code class="reqn">( -\log(1-F_{km}(Z_{j,n})),  Z_{j,n} )</code>
</p>

<p>for <code class="reqn">j=1,\ldots,n-1,</code>
with <code class="reqn">Z_{i,n}</code> the <code class="reqn">i</code>-th order statistic of the data and <code class="reqn">F_{km}</code> the Kaplan-Meier estimator for the CDF.
Hence, it has the same empirical quantiles as an ordinary exponential QQ-plot but replaces the theoretical quantiles <code class="reqn">-\log(1-j/(n+1))</code> by <code class="reqn">-\log(1-F_{km}(Z_{j,n}))</code>.
</p>
<p>This QQ-plot is only suitable for right censored data.
</p>
<p>In Beirlant et al. (2007), only a Pareto QQ-plot adapted for right-censored data is proposed. This QQ-plot is constructed using the same ideas, but is not described in the paper.
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>eqq.the</code></td>
<td>
<p>Vector of the theoretical quantiles, see Details.</p>
</td></tr>
<tr><td><code>eqq.emp</code></td>
<td>
<p>Vector of the empirical quantiles from the data.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens
</p>


<h3>References</h3>

<p>Beirlant, J., Guillou, A., Dierckx, G. and Fils-Villetard, A. (2007). &quot;Estimation of the Extreme Value Index and Extreme Quantiles Under Random Censoring.&quot; <em>Extremes</em>, 10, 151&ndash;174.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ExpQQ">ExpQQ</a></code>, <code><a href="#topic+cLognormalQQ">cLognormalQQ</a></code>, <code><a href="#topic+cParetoQQ">cParetoQQ</a></code>, <code><a href="#topic+cWeibullQQ">cWeibullQQ</a></code>, <code><a href="#topic+KaplanMeier">KaplanMeier</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Set seed
set.seed(29072016)

# Pareto random sample
X &lt;- rpareto(500, shape=2)

# Censoring variable
Y &lt;- rpareto(500, shape=1)

# Observed sample
Z &lt;- pmin(X, Y)

# Censoring indicator
censored &lt;- (X&gt;Y)

# Exponential QQ-plot adapted for right censoring
cExpQQ(Z, censored=censored)
</code></pre>

<hr>
<h2 id='cgenHill'>
Generalised Hill estimator for right censored data
</h2><span id='topic+cgenHill'></span>

<h3>Description</h3>

<p>Computes the generalised Hill estimates adapted for right censored data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cgenHill(data, censored, logk = FALSE, plot = FALSE, add = FALSE, 
         main = "Generalised Hill estimates of the EVI", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cgenHill_+3A_data">data</code></td>
<td>

<p>Vector of <code class="reqn">n</code> observations. 
</p>
</td></tr>
<tr><td><code id="cgenHill_+3A_censored">censored</code></td>
<td>

<p>A logical vector of length <code class="reqn">n</code> indicating if an observation is censored.
</p>
</td></tr>
<tr><td><code id="cgenHill_+3A_logk">logk</code></td>
<td>

<p>Logical indicating if the estimates are plotted as a function of <code class="reqn">\log(k)</code> (<code>logk=TRUE</code>) or as a function of <code class="reqn">k</code>. Default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="cgenHill_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the estimates of <code class="reqn">\gamma_1</code> should be plotted as a function of <code class="reqn">k</code>, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="cgenHill_+3A_add">add</code></td>
<td>

<p>Logical indicating if the estimates of <code class="reqn">\gamma_1</code> should be added to an existing plot, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="cgenHill_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"Generalised Hill estimates of the EVI"</code>.
</p>
</td></tr>
<tr><td><code id="cgenHill_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The generalised Hill estimator adapted for right censored data is equal to the ordinary generalised Hill estimator divided by the proportion of the <code class="reqn">k</code> largest observations that is non-censored.
</p>
<p>This estimator is only suitable for right censored data.
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>k</code></td>
<td>
<p>Vector of the values of the tail parameter <code class="reqn">k</code>.</p>
</td></tr>
<tr><td><code>gamma1</code></td>
<td>
<p>Vector of the corresponding generalised Hill estimates.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens
</p>


<h3>References</h3>

<p>Einmahl, J.H.J., Fils-Villetard, A. and Guillou, A. (2008). &quot;Statistics of Extremes Under Random Censoring.&quot;
<em>Bernoulli</em>, 14, 207&ndash;227.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+genHill">genHill</a></code>, <code><a href="#topic+cHill">cHill</a></code>, <code><a href="#topic+cProbGH">cProbGH</a></code>, <code><a href="#topic+cQuantGH">cQuantGH</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Set seed
set.seed(29072016)

# Pareto random sample
X &lt;- rpareto(500, shape=2)

# Censoring variable
Y &lt;- rpareto(500, shape=1)

# Observed sample
Z &lt;- pmin(X, Y)

# Censoring indicator
censored &lt;- (X&gt;Y)

# Generalised Hill estimator adapted for right censoring
cghill &lt;- cgenHill(Z, censored=censored, plot=TRUE)
</code></pre>

<hr>
<h2 id='cGPDmle'>
GPD-ML estimator for right censored data
</h2><span id='topic+cGPDmle'></span><span id='topic+cPOT'></span>

<h3>Description</h3>

<p>Computes ML estimates of fitting GPD to peaks over a threshold adapted for right censoring.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cGPDmle(data, censored, start = c(0.1,1), warnings = FALSE, logk = FALSE, 
        plot = FALSE, add = FALSE, main = "POT estimates of the EVI", ...)
      
cPOT(data, censored, start = c(0.1,1), warnings = FALSE, logk = FALSE, 
     plot = FALSE, add = FALSE, main = "POT estimates of the EVI", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cGPDmle_+3A_data">data</code></td>
<td>

<p>Vector of <code class="reqn">n</code> observations. 
</p>
</td></tr>
<tr><td><code id="cGPDmle_+3A_censored">censored</code></td>
<td>

<p>A logical vector of length <code class="reqn">n</code> indicating if an observation is censored.
</p>
</td></tr>
<tr><td><code id="cGPDmle_+3A_start">start</code></td>
<td>

<p>Vector of length 2 containing the starting values for the optimisation. The first element
is the starting value for the estimator of <code class="reqn">\gamma_1</code> and the second element is the starting value for the estimator of <code class="reqn">\sigma_1</code>. Default is <code>c(0.1,1)</code>.
</p>
</td></tr>
<tr><td><code id="cGPDmle_+3A_warnings">warnings</code></td>
<td>

<p>Logical indicating if possible warnings from the optimisation function are shown, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="cGPDmle_+3A_logk">logk</code></td>
<td>

<p>Logical indicating if the estimates are plotted as a function of <code class="reqn">\log(k)</code> (<code>logk=TRUE</code>) or as a function of <code class="reqn">k</code>. Default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="cGPDmle_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the estimates of <code class="reqn">\gamma_1</code> should be plotted as a function of <code class="reqn">k</code>, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="cGPDmle_+3A_add">add</code></td>
<td>

<p>Logical indicating if the estimates of <code class="reqn">\gamma_1</code> should be added to an existing plot, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="cGPDmle_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"POT estimates of the EVI"</code>.
</p>
</td></tr>
<tr><td><code id="cGPDmle_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The GPD-MLE estimator for the EVI adapted for right censored data is equal to the ordinary GPD-MLE estimator for the EVI divided by the proportion of the <code class="reqn">k</code> largest observations that is non-censored. The estimates for <code class="reqn">\sigma</code> are the ordinary GPD-MLE estimates for <code class="reqn">\sigma</code>.
</p>
<p>This estimator is only suitable for right censored data.
</p>
<p><code>cPOT</code> is the same function but with a different name for compatibility with <code><a href="#topic+POT">POT</a></code>.
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>k</code></td>
<td>
<p>Vector of the values of the tail parameter <code class="reqn">k</code>.</p>
</td></tr>
<tr><td><code>gamma1</code></td>
<td>
<p>Vector of the corresponding MLE estimates for the <code class="reqn">\gamma_1</code> parameter of the GPD.</p>
</td></tr>
<tr><td><code>sigma1</code></td>
<td>
<p>Vector of the corresponding MLE estimates for the <code class="reqn">\sigma_1</code> parameter of the GPD.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens
</p>


<h3>References</h3>

<p>Einmahl, J.H.J., Fils-Villetard, A. and Guillou, A. (2008). &quot;Statistics of Extremes Under Random Censoring.&quot;
<em>Bernoulli</em>, 14, 207&ndash;227.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+GPDmle">GPDmle</a></code>, <code><a href="#topic+cProbGPD">cProbGPD</a></code>, <code><a href="#topic+cQuantGPD">cQuantGPD</a></code>, <code><a href="#topic+cEPD">cEPD</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Set seed
set.seed(29072016)

# Pareto random sample
X &lt;- rpareto(500, shape=2)

# Censoring variable
Y &lt;- rpareto(500, shape=1)

# Observed sample
Z &lt;- pmin(X, Y)

# Censoring indicator
censored &lt;- (X&gt;Y)

# GPD-ML estimator adapted for right censoring
cpot &lt;- cGPDmle(Z, censored=censored, plot=TRUE)
</code></pre>

<hr>
<h2 id='cHill'>
Hill estimator for right censored data
</h2><span id='topic+cHill'></span>

<h3>Description</h3>

<p>Computes the Hill estimator for positive extreme value indices, adapted for right censoring, as a function of the tail parameter <code class="reqn">k</code> (Beirlant et al., 2007).
Optionally, these estimates are plotted as a function of <code class="reqn">k</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cHill(data, censored, logk = FALSE, plot = FALSE, add = FALSE, 
      main = "Hill estimates of the EVI", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cHill_+3A_data">data</code></td>
<td>

<p>Vector of <code class="reqn">n</code> observations. 
</p>
</td></tr>
<tr><td><code id="cHill_+3A_censored">censored</code></td>
<td>

<p>A logical vector of length <code class="reqn">n</code> indicating if an observation is censored.
</p>
</td></tr>
<tr><td><code id="cHill_+3A_logk">logk</code></td>
<td>

<p>Logical indicating if the estimates are plotted as a function of <code class="reqn">\log(k)</code> (<code>logk=TRUE</code>) or as a function of <code class="reqn">k</code>. Default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="cHill_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the estimates of <code class="reqn">\gamma_1</code> should be plotted as a function of <code class="reqn">k</code>, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="cHill_+3A_add">add</code></td>
<td>

<p>Logical indicating if the estimates of <code class="reqn">\gamma_1</code> should be added to an existing plot, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="cHill_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"Hill estimates of the EVI"</code>.
</p>
</td></tr>
<tr><td><code id="cHill_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Hill estimator adapted for right censored data is equal to the ordinary Hill estimator <code class="reqn">H_{k,n}</code> divided by the proportion of the <code class="reqn">k</code> largest observations that is non-censored.
</p>
<p>This estimator is only suitable for right censored data, use <code><a href="#topic+icHill">icHill</a></code> for interval censored data.
</p>
<p>See Section 4.3.2 of Albrecher et al. (2017) for more details.
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>k</code></td>
<td>
<p>Vector of the values of the tail parameter <code class="reqn">k</code>.</p>
</td></tr>
<tr><td><code>gamma1</code></td>
<td>
<p>Vector of the corresponding Hill estimates.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens
</p>


<h3>References</h3>

<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>
<p>Beirlant, J., Guillou, A., Dierckx, G. and Fils-Villetard, A. (2007). &quot;Estimation of the Extreme Value Index and Extreme Quantiles Under Random Censoring.&quot; <em>Extremes</em>, 10, 151&ndash;174.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Hill">Hill</a></code>, <code><a href="#topic+icHill">icHill</a></code>, <code><a href="#topic+cParetoQQ">cParetoQQ</a></code>, <code><a href="#topic+cProb">cProb</a></code>, <code><a href="#topic+cQuant">cQuant</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Set seed
set.seed(29072016)

# Pareto random sample
X &lt;- rpareto(500, shape=2)

# Censoring variable
Y &lt;- rpareto(500, shape=1)

# Observed sample
Z &lt;- pmin(X, Y)

# Censoring indicator
censored &lt;- (X&gt;Y)

# Hill estimator adapted for right censoring
chill &lt;- cHill(Z, censored=censored, plot=TRUE)
</code></pre>

<hr>
<h2 id='cLognormalQQ'>
Log-normal quantile plot for right censored data
</h2><span id='topic+cLognormalQQ'></span>

<h3>Description</h3>

<p>Log-normal QQ-plot adapted for right censored data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cLognormalQQ(data, censored, plot = TRUE, main = "Log-normal QQ-plot", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cLognormalQQ_+3A_data">data</code></td>
<td>

<p>Vector of <code class="reqn">n</code> observations. 
</p>
</td></tr>
<tr><td><code id="cLognormalQQ_+3A_censored">censored</code></td>
<td>

<p>A logical vector of length <code class="reqn">n</code> indicating if an observation is censored.
</p>
</td></tr>
<tr><td><code id="cLognormalQQ_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the quantiles should be plotted in a log-normal QQ-plot, default is <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="cLognormalQQ_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"Log-normal QQ-plot"</code>.
</p>
</td></tr>
<tr><td><code id="cLognormalQQ_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The log-normal QQ-plot adapted for right censoring is given by
</p>
<p style="text-align: center;"><code class="reqn">( \Phi^{-1}(F_{km}(Z_{j,n})),  \log(Z_{j,n}) )</code>
</p>

<p>for <code class="reqn">j=1,\ldots,n-1,</code>
with <code class="reqn">Z_{i,n}</code> the <code class="reqn">i</code>-th order statistic of the data, <code class="reqn">\Phi^{-1}</code> the quantile function of the standard normal distribution and <code class="reqn">F_{km}</code> the Kaplan-Meier estimator for the CDF.
Hence, it has the same empirical quantiles as an ordinary log-normal QQ-plot but replaces the theoretical quantiles <code class="reqn"> \Phi^{-1}(j/(n+1))</code> by <code class="reqn">\Phi^{-1}(F_{km}(Z_{j,n}))</code>.
</p>
<p>This QQ-plot is only suitable for right censored data.
</p>
<p>In Beirlant et al. (2007), only a Pareto QQ-plot adapted for right-censored data is proposed. This QQ-plot is constructed using the same ideas, but is not described in the paper.
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>lqq.the</code></td>
<td>
<p>Vector of the theoretical quantiles, see Details.</p>
</td></tr>
<tr><td><code>lqq.emp</code></td>
<td>
<p>Vector of the empirical quantiles from the log-transformed data.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens
</p>


<h3>References</h3>

<p>Beirlant, J., Guillou, A., Dierckx, G. and Fils-Villetard, A. (2007). &quot;Estimation of the Extreme Value Index and Extreme Quantiles Under Random Censoring.&quot; <em>Extremes</em>, 10, 151&ndash;174.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+LognormalQQ">LognormalQQ</a></code>, <code><a href="#topic+cExpQQ">cExpQQ</a></code>, <code><a href="#topic+cParetoQQ">cParetoQQ</a></code>, <code><a href="#topic+cWeibullQQ">cWeibullQQ</a></code>, <code><a href="#topic+KaplanMeier">KaplanMeier</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Set seed
set.seed(29072016)

# Pareto random sample
X &lt;- rpareto(500, shape=2)

# Censoring variable
Y &lt;- rpareto(500, shape=1)

# Observed sample
Z &lt;- pmin(X, Y)

# Censoring indicator
censored &lt;- (X&gt;Y)

# Log-normal QQ-plot adapted for right censoring
cLognormalQQ(Z, censored=censored)
</code></pre>

<hr>
<h2 id='cMoment'>
MOM estimator for right censored data
</h2><span id='topic+cMoment'></span>

<h3>Description</h3>

<p>Computes the Method of Moment estimates adapted for right censored data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cMoment(data, censored, logk = FALSE, plot = FALSE, add = FALSE, 
        main = "Moment estimates of the EVI", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cMoment_+3A_data">data</code></td>
<td>

<p>Vector of <code class="reqn">n</code> observations. 
</p>
</td></tr>
<tr><td><code id="cMoment_+3A_censored">censored</code></td>
<td>

<p>A logical vector of length <code class="reqn">n</code> indicating if an observation is censored.
</p>
</td></tr>
<tr><td><code id="cMoment_+3A_logk">logk</code></td>
<td>

<p>Logical indicating if the estimates are plotted as a function of <code class="reqn">\log(k)</code> (<code>logk=TRUE</code>) or as a function of <code class="reqn">k</code>. Default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="cMoment_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the estimates of <code class="reqn">\gamma_1</code> should be plotted as a function of <code class="reqn">k</code>, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="cMoment_+3A_add">add</code></td>
<td>

<p>Logical indicating if the estimates of <code class="reqn">\gamma_1</code> should be added to an existing plot, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="cMoment_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"Moment estimates of the EVI"</code>.
</p>
</td></tr>
<tr><td><code id="cMoment_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The moment estimator adapted for right censored data is equal to the ordinary moment estimator divided by the proportion of the <code class="reqn">k</code> largest observations that is non-censored.
</p>
<p>This estimator is only suitable for right censored data.
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>k</code></td>
<td>
<p>Vector of the values of the tail parameter <code class="reqn">k</code>.</p>
</td></tr>
<tr><td><code>gamma1</code></td>
<td>
<p>Vector of the corresponding moment estimates.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens
</p>


<h3>References</h3>

<p>Einmahl, J.H.J., Fils-Villetard, A. and Guillou, A. (2008). &quot;Statistics of Extremes Under Random Censoring.&quot;
<em>Bernoulli</em>, 14, 207&ndash;227.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Moment">Moment</a></code>, <code><a href="#topic+cProbMOM">cProbMOM</a></code>, <code><a href="#topic+cQuantMOM">cQuantMOM</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Set seed
set.seed(29072016)

# Pareto random sample
X &lt;- rpareto(500, shape=2)

# Censoring variable
Y &lt;- rpareto(500, shape=1)

# Observed sample
Z &lt;- pmin(X, Y)

# Censoring indicator
censored &lt;- (X&gt;Y)

# Moment estimator adapted for right censoring
cmom &lt;- cMoment(Z, censored=censored, plot=TRUE)
</code></pre>

<hr>
<h2 id='cParetoQQ'>
Pareto quantile plot for right censored data
</h2><span id='topic+cParetoQQ'></span>

<h3>Description</h3>

<p>Pareto QQ-plot adapted for right censored data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cParetoQQ(data, censored, plot = TRUE, main = "Pareto QQ-plot", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cParetoQQ_+3A_data">data</code></td>
<td>

<p>Vector of <code class="reqn">n</code> observations. 
</p>
</td></tr>
<tr><td><code id="cParetoQQ_+3A_censored">censored</code></td>
<td>

<p>A logical vector of length <code class="reqn">n</code> indicating if an observation is censored.
</p>
</td></tr>
<tr><td><code id="cParetoQQ_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the quantiles should be plotted in a Pareto QQ-plot, default is <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="cParetoQQ_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"Pareto QQ-plot"</code>.
</p>
</td></tr>
<tr><td><code id="cParetoQQ_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Pareto QQ-plot adapted for right censoring is given by
</p>
<p style="text-align: center;"><code class="reqn">( -\log(1-F_{km}(Z_{j,n})), \log Z_{j,n} )</code>
</p>

<p>for <code class="reqn">j=1,\ldots,n-1,</code>
with <code class="reqn">Z_{i,n}</code> the <code class="reqn">i</code>-th order statistic of the data and <code class="reqn">F_{km}</code> the Kaplan-Meier estimator for the CDF.
Hence, it has the same empirical quantiles as an ordinary Pareto QQ-plot but replaces the theoretical quantiles <code class="reqn">-\log(1-j/(n+1))</code> by <code class="reqn">-\log(1-F_{km}(Z_{j,n}))</code>.
</p>
<p>This QQ-plot is only suitable for right censored data, use <code><a href="#topic+icParetoQQ">icParetoQQ</a></code> for interval censored data.
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>pqq.the</code></td>
<td>
<p>Vector of the theoretical quantiles, see Details.</p>
</td></tr>
<tr><td><code>pqq.emp</code></td>
<td>
<p>Vector of the empirical quantiles from the log-transformed data.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens
</p>


<h3>References</h3>

<p>Beirlant, J., Guillou, A., Dierckx, G. and Fils-Villetard, A. (2007). &quot;Estimation of the Extreme Value Index and Extreme Quantiles Under Random Censoring.&quot; <em>Extremes</em>, 10, 151&ndash;174.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ParetoQQ">ParetoQQ</a></code>, <code><a href="#topic+icParetoQQ">icParetoQQ</a></code>, <code><a href="#topic+cExpQQ">cExpQQ</a></code>, <code><a href="#topic+cLognormalQQ">cLognormalQQ</a></code>, <code><a href="#topic+cWeibullQQ">cWeibullQQ</a></code>, <code><a href="#topic+cHill">cHill</a></code>, <code><a href="#topic+KaplanMeier">KaplanMeier</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Set seed
set.seed(29072016)

# Pareto random sample
X &lt;- rpareto(500, shape=2)

# Censoring variable
Y &lt;- rpareto(500, shape=1)

# Observed sample
Z &lt;- pmin(X, Y)

# Censoring indicator
censored &lt;- (X&gt;Y)

# Pareto QQ-plot adapted for right censoring
cParetoQQ(Z, censored=censored)
</code></pre>

<hr>
<h2 id='cProb'>
Estimator of small exceedance probabilities and large return periods using censored Hill
</h2><span id='topic+cProb'></span><span id='topic+cReturn'></span>

<h3>Description</h3>

<p>Computes estimates of a small exceedance probability <code class="reqn">P(X&gt;q)</code> or large return period <code class="reqn">1/P(X&gt;q)</code> using the estimates for the EVI obtained from the Hill estimator adapted for right censoring.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cProb(data, censored, gamma1, q, plot = FALSE, add = FALSE, 
      main = "Estimates of small exceedance probability", ...)
      
cReturn(data, censored, gamma1, q, plot = FALSE, add = FALSE, 
        main = "Estimates of large return period", ...)      
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cProb_+3A_data">data</code></td>
<td>

<p>Vector of <code class="reqn">n</code> observations.  
</p>
</td></tr>
<tr><td><code id="cProb_+3A_censored">censored</code></td>
<td>

<p>A logical vector of length <code class="reqn">n</code> indicating if an observation is censored.
</p>
</td></tr>
<tr><td><code id="cProb_+3A_gamma1">gamma1</code></td>
<td>

<p>Vector of <code class="reqn">n-1</code> estimates for the EVI obtained from <code><a href="#topic+cHill">cHill</a></code>.
</p>
</td></tr>
<tr><td><code id="cProb_+3A_q">q</code></td>
<td>

<p>The used large quantile (we estimate <code class="reqn">P(X&gt;q)</code> or <code class="reqn">1/P(X&gt;q)</code> for <code class="reqn">q</code> large).
</p>
</td></tr>
<tr><td><code id="cProb_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the estimates should be plotted as a function of <code class="reqn">k</code>, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="cProb_+3A_add">add</code></td>
<td>

<p>Logical indicating if the estimates should be added to an existing plot, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="cProb_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"Estimates of small exceedance probability"</code> for <code>cProb</code>
and <code>"Estimates of large return period"</code> for <code>cReturn</code>.
</p>
</td></tr>
<tr><td><code id="cProb_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The probability is estimated as
</p>
<p style="text-align: center;"><code class="reqn"> \hat{P}(X&gt;q)=(1-km) \times (q/Z_{n-k,n})^{-1/H_{k,n}^c}</code>
</p>
<p> with <code class="reqn">Z_{i,n}</code> the <code class="reqn">i</code>-th order statistic of the data, <code class="reqn">H_{k,n}^c</code>
the Hill estimator adapted for right censoring and <code class="reqn">km</code> the Kaplan-Meier estimator for the CDF evaluated in <code class="reqn">Z_{n-k,n}</code>.
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>k</code></td>
<td>
<p>Vector of the values of the tail parameter <code class="reqn">k</code>.</p>
</td></tr>
<tr><td><code>P</code></td>
<td>
<p>Vector of the corresponding probability estimates, only returned for <code>cProb</code>.</p>
</td></tr>
<tr><td><code>R</code></td>
<td>
<p>Vector of the corresponding estimates for the return period, only returned for <code>cReturn</code>.</p>
</td></tr>
<tr><td><code>q</code></td>
<td>
<p>The used large quantile.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens
</p>


<h3>References</h3>

<p>Beirlant, J., Guillou, A., Dierckx, G. and Fils-Villetard, A. (2007). &quot;Estimation of the Extreme Value Index and Extreme Quantiles Under Random Censoring.&quot; <em>Extremes</em>, 10, 151&ndash;174.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cHill">cHill</a></code>, <code><a href="#topic+cQuant">cQuant</a></code>, <code><a href="#topic+Prob">Prob</a></code>, <code><a href="#topic+KaplanMeier">KaplanMeier</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Set seed
set.seed(29072016)

# Pareto random sample
X &lt;- rpareto(500, shape=2)

# Censoring variable
Y &lt;- rpareto(500, shape=1)

# Observed sample
Z &lt;- pmin(X, Y)

# Censoring indicator
censored &lt;- (X&gt;Y)

# Hill estimator adapted for right censoring
chill &lt;- cHill(Z, censored=censored, plot=TRUE)

# Small exceedance probability
q &lt;- 10
cProb(Z, censored=censored, gamma1=chill$gamma1, q=q, plot=TRUE)

# Return period
cReturn(Z, censored=censored, gamma1=chill$gamma1, q=q, plot=TRUE)
</code></pre>

<hr>
<h2 id='cProbEPD'>
Estimator of small exceedance probabilities and large return periods using censored EPD
</h2><span id='topic+cProbEPD'></span><span id='topic+cReturnEPD'></span>

<h3>Description</h3>

<p>Computes estimates of a small exceedance probability <code class="reqn">P(X&gt;q)</code> or large return period <code class="reqn">1/P(X&gt;q)</code> using the parameters from the EPD fit adapted for right censoring.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cProbEPD(data, censored, gamma1, kappa1, beta, q, plot = FALSE, add = FALSE,
         main = "Estimates of small exceedance probability", ...)

cReturnEPD(data, censored, gamma1, kappa1, beta, q, plot = FALSE, add = FALSE,
           main = "Estimates of large return period", ...)          
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cProbEPD_+3A_data">data</code></td>
<td>

<p>Vector of <code class="reqn">n</code> observations.  
</p>
</td></tr>
<tr><td><code id="cProbEPD_+3A_censored">censored</code></td>
<td>

<p>A logical vector of length <code class="reqn">n</code> indicating if an observation is censored.
</p>
</td></tr>
<tr><td><code id="cProbEPD_+3A_gamma1">gamma1</code></td>
<td>

<p>Vector of <code class="reqn">n-1</code> estimates for the EVI obtained from <code><a href="#topic+cEPD">cEPD</a></code>.
</p>
</td></tr>
<tr><td><code id="cProbEPD_+3A_kappa1">kappa1</code></td>
<td>

<p>Vector of <code class="reqn">n-1</code> estimates for <code class="reqn">\kappa_1</code> obtained from <code><a href="#topic+cEPD">cEPD</a></code>.
</p>
</td></tr>
<tr><td><code id="cProbEPD_+3A_beta">beta</code></td>
<td>

<p>Vector of <code class="reqn">n-1</code> estimates for <code class="reqn">\beta</code> obtained from <code><a href="#topic+cEPD">cEPD</a></code>.
</p>
</td></tr>
<tr><td><code id="cProbEPD_+3A_q">q</code></td>
<td>

<p>The used large quantile (we estimate <code class="reqn">P(X&gt;q)</code> or <code class="reqn">1/P(X&gt;q)</code> for <code class="reqn">q</code> large).
</p>
</td></tr>
<tr><td><code id="cProbEPD_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the estimates should be plotted as a function of <code class="reqn">k</code>, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="cProbEPD_+3A_add">add</code></td>
<td>

<p>Logical indicating if the estimates should be added to an existing plot, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="cProbEPD_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"Estimates of small exceedance probability"</code> for <code>cProbEPD</code>
and <code>"Estimates of large return period"</code> for <code>cReturnEPD</code>.
</p>
</td></tr>
<tr><td><code id="cProbEPD_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The probability is estimated as </p>
<p style="text-align: center;"><code class="reqn">\hat{P}(X&gt;q)= (1-km) \times (1-F(q))</code>
</p>
<p> with <code class="reqn">F</code>
the CDF of the EPD with estimated parameters <code class="reqn">\hat{\gamma}_1</code>, <code class="reqn">\hat{\kappa}_1</code> and <code class="reqn">\hat{\tau}=-\hat{\beta}</code>
and <code class="reqn">km</code> the Kaplan-Meier estimator for the CDF evaluated in <code class="reqn">Z_{n-k,n}</code> (the <code class="reqn">(k+1)</code>-th largest data point).
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>k</code></td>
<td>
<p>Vector of the values of the tail parameter <code class="reqn">k</code>.</p>
</td></tr>
<tr><td><code>P</code></td>
<td>
<p>Vector of the corresponding probability estimates, only returned for <code>cProbEPD</code>.</p>
</td></tr>
<tr><td><code>R</code></td>
<td>
<p>Vector of the corresponding estimates for the return period, only returned for <code>cReturnEPD</code>.</p>
</td></tr>
<tr><td><code>q</code></td>
<td>
<p>The used large quantile.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens.
</p>


<h3>References</h3>

<p>Beirlant, J., Bardoutsos, A., de Wet, T. and Gijbels, I. (2016). &quot;Bias Reduced Tail Estimation for Censored Pareto Type Distributions.&quot; <em>Statistics &amp; Probability Letters</em>, 109, 78&ndash;88.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cEPD">cEPD</a></code>, <code><a href="#topic+ProbEPD">ProbEPD</a></code>, <code><a href="#topic+Prob">Prob</a></code>, <code><a href="#topic+KaplanMeier">KaplanMeier</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Set seed
set.seed(29072016)

# Pareto random sample
X &lt;- rpareto(500, shape=2)

# Censoring variable
Y &lt;- rpareto(500, shape=1)

# Observed sample
Z &lt;- pmin(X, Y)

# Censoring indicator
censored &lt;- (X&gt;Y)

# EPD estimator adapted for right censoring
cepd &lt;- cEPD(Z, censored=censored, plot=TRUE)

# Small exceedance probability
q &lt;- 10
cProbEPD(Z, censored=censored, gamma1=cepd$gamma1,
        kappa1=cepd$kappa1, beta=cepd$beta, q=q, plot=TRUE)

# Return period
cReturnEPD(Z, censored=censored, gamma1=cepd$gamma1,
        kappa1=cepd$kappa1, beta=cepd$beta, q=q, plot=TRUE)        
</code></pre>

<hr>
<h2 id='cProbGH'>
Estimator of small exceedance probabilities and large return periods using censored generalised Hill
</h2><span id='topic+cProbGH'></span><span id='topic+cReturnGH'></span>

<h3>Description</h3>

<p>Computes estimates of a small exceedance probability <code class="reqn">P(X&gt;q)</code> or large return period <code class="reqn">1/P(X&gt;q)</code> using the estimates for the EVI obtained from the generalised Hill estimator adapted for right censoring.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cProbGH(data, censored, gamma1, q, plot = FALSE, add = FALSE, 
        main = "Estimates of small exceedance probability", ...)

cReturnGH(data, censored, gamma1, q, plot = FALSE, add = FALSE, 
          main = "Estimates of large return period", ...)        
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cProbGH_+3A_data">data</code></td>
<td>

<p>Vector of <code class="reqn">n</code> observations.  
</p>
</td></tr>
<tr><td><code id="cProbGH_+3A_censored">censored</code></td>
<td>

<p>A logical vector of length <code class="reqn">n</code> indicating if an observation is censored.
</p>
</td></tr>
<tr><td><code id="cProbGH_+3A_gamma1">gamma1</code></td>
<td>

<p>Vector of <code class="reqn">n-1</code> estimates for the EVI obtained from <code><a href="#topic+cgenHill">cgenHill</a></code>.
</p>
</td></tr>
<tr><td><code id="cProbGH_+3A_q">q</code></td>
<td>

<p>The used large quantile (we estimate <code class="reqn">P(X&gt;q)</code> or <code class="reqn">1/P(X&gt;q)</code> for <code class="reqn">q</code> large).
</p>
</td></tr>
<tr><td><code id="cProbGH_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the estimates should be plotted as a function of <code class="reqn">k</code>, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="cProbGH_+3A_add">add</code></td>
<td>

<p>Logical indicating if the estimates should be added to an existing plot, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="cProbGH_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"Estimates of small exceedance probability"</code> for <code>cProbGH</code>
and <code>"Estimates of large return period"</code> for <code>cReturnGH</code>.
</p>
</td></tr>
<tr><td><code id="cProbGH_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The probability is estimated as
</p>
<p style="text-align: center;"><code class="reqn"> \hat{P}(X&gt;q)=(1-km) \times (1+ \hat{\gamma}_1/a_{k,n} \times (q-Z_{n-k,n}))^{-1/\hat{\gamma}_1}</code>
</p>
<p> with <code class="reqn">Z_{i,n}</code> the <code class="reqn">i</code>-th order statistic of the data, <code class="reqn">\hat{\gamma}_1</code> the generalised Hill estimator adapted for right censoring and <code class="reqn">km</code> the Kaplan-Meier estimator for the CDF evaluated in <code class="reqn">Z_{n-k,n}</code>. The value <code class="reqn">a</code> is defined as
</p>
<p style="text-align: center;"><code class="reqn">a_{k,n} = Z_{n-k,n} H_{k,n} (1-\min(\hat{\gamma}_1,0)) / \hat{p}_k</code>
</p>
<p> with <code class="reqn">H_{k,n}</code> the ordinary Hill estimator
and <code class="reqn">\hat{p}_k</code> the proportion of the <code class="reqn">k</code> largest observations that is non-censored.
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>k</code></td>
<td>
<p>Vector of the values of the tail parameter <code class="reqn">k</code>.</p>
</td></tr>
<tr><td><code>P</code></td>
<td>
<p>Vector of the corresponding probability estimates, only returned for <code>cProbGH</code>.</p>
</td></tr>
<tr><td><code>R</code></td>
<td>
<p>Vector of the corresponding estimates for the return period, only returned for <code>cReturnGH</code>.</p>
</td></tr>
<tr><td><code>q</code></td>
<td>
<p>The used large quantile.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens
</p>


<h3>References</h3>

<p>Einmahl, J.H.J., Fils-Villetard, A. and Guillou, A. (2008). &quot;Statistics of Extremes Under Random Censoring.&quot;
<em>Bernoulli</em>, 14, 207&ndash;227.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cQuantGH">cQuantGH</a></code>, <code><a href="#topic+cgenHill">cgenHill</a></code>, <code><a href="#topic+ProbGH">ProbGH</a></code>, <code><a href="#topic+cProbMOM">cProbMOM</a></code>, <code><a href="#topic+KaplanMeier">KaplanMeier</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Set seed
set.seed(29072016)

# Pareto random sample
X &lt;- rpareto(500, shape=2)

# Censoring variable
Y &lt;- rpareto(500, shape=1)

# Observed sample
Z &lt;- pmin(X, Y)

# Censoring indicator
censored &lt;- (X&gt;Y)

# Generalised Hill estimator adapted for right censoring
cghill &lt;- cgenHill(Z, censored=censored, plot=TRUE)

# Small exceedance probability
q &lt;- 10
cProbGH(Z, censored=censored, gamma1=cghill$gamma1, q=q, plot=TRUE)

# Return period
cReturnGH(Z, censored=censored, gamma1=cghill$gamma1, q=q, plot=TRUE)
</code></pre>

<hr>
<h2 id='cProbGPD'>
Estimator of small exceedance probabilities and large return periods using censored GPD-MLE
</h2><span id='topic+cProbGPD'></span><span id='topic+cReturnGPD'></span>

<h3>Description</h3>

<p>Computes estimates of a small exceedance probability <code class="reqn">P(X&gt;q)</code> or large return period <code class="reqn">1/P(X&gt;q)</code> using the GPD-ML estimator adapted for right censoring.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cProbGPD(data, censored, gamma1, sigma1, q, plot = FALSE, add = FALSE,
         main = "Estimates of small exceedance probability", ...)

cReturnGPD(data, censored, gamma1, sigma1, q, plot = FALSE, add = FALSE,
           main = "Estimates of large return period", ...)        
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cProbGPD_+3A_data">data</code></td>
<td>

<p>Vector of <code class="reqn">n</code> observations.  
</p>
</td></tr>
<tr><td><code id="cProbGPD_+3A_censored">censored</code></td>
<td>

<p>A logical vector of length <code class="reqn">n</code> indicating if an observation is censored.
</p>
</td></tr>
<tr><td><code id="cProbGPD_+3A_gamma1">gamma1</code></td>
<td>

<p>Vector of <code class="reqn">n-1</code> estimates for the EVI obtained from <code><a href="#topic+cGPDmle">cGPDmle</a></code>.
</p>
</td></tr>  
<tr><td><code id="cProbGPD_+3A_sigma1">sigma1</code></td>
<td>

<p>Vector of <code class="reqn">n-1</code> estimates for <code class="reqn">\sigma_1</code> obtained from <code><a href="#topic+cGPDmle">cGPDmle</a></code>.
</p>
</td></tr>
<tr><td><code id="cProbGPD_+3A_q">q</code></td>
<td>

<p>The used large quantile (we estimate <code class="reqn">P(X&gt;q)</code> or <code class="reqn">1/P(X&gt;q)</code> for <code class="reqn">q</code> large).
</p>
</td></tr>
<tr><td><code id="cProbGPD_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the estimates should be plotted as a function of <code class="reqn">k</code>, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="cProbGPD_+3A_add">add</code></td>
<td>

<p>Logical indicating if the estimates should be added to an existing plot, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="cProbGPD_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"Estimates of small exceedance probability"</code> for <code>cProbGPD</code>
and <code>"Estimates of large return period"</code> for <code>cReturnGPD</code>.
</p>
</td></tr>
<tr><td><code id="cProbGPD_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The probability is estimated as
</p>
<p style="text-align: center;"><code class="reqn"> \hat{P}(X&gt;q)=(1-km) \times (1+ \hat{\gamma}_1/a_{k,n} \times (q-Z_{n-k,n}))^{-1/\hat{\gamma}_1}</code>
</p>
<p> with <code class="reqn">Z_{i,n}</code> the <code class="reqn">i</code>-th order statistic of the data, <code class="reqn">\hat{\gamma}_1</code> the generalised Hill estimator adapted for right censoring and <code class="reqn">km</code> the Kaplan-Meier estimator for the CDF evaluated in <code class="reqn">Z_{n-k,n}</code>. The value <code class="reqn">a</code> is defined as
</p>
<p style="text-align: center;"><code class="reqn">a_{k,n} = \hat{\sigma}_1 / \hat{p}_k</code>
</p>
<p> with <code class="reqn">\hat{\sigma}_1</code> the ML estimate for <code class="reqn">\sigma_1</code>
and <code class="reqn">\hat{p}_k</code> the proportion of the <code class="reqn">k</code> largest observations that is non-censored.
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>k</code></td>
<td>
<p>Vector of the values of the tail parameter <code class="reqn">k</code>.</p>
</td></tr>
<tr><td><code>P</code></td>
<td>
<p>Vector of the corresponding probability estimates, only returned for <code>cProbGPD</code>.</p>
</td></tr>
<tr><td><code>R</code></td>
<td>
<p>Vector of the corresponding estimates for the return period, only returned for <code>cReturnGPD</code>.</p>
</td></tr>
<tr><td><code>q</code></td>
<td>
<p>The used large quantile.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens
</p>


<h3>References</h3>

<p>Einmahl, J.H.J., Fils-Villetard, A. and Guillou, A. (2008). &quot;Statistics of Extremes Under Random Censoring.&quot;
<em>Bernoulli</em>, 14, 207&ndash;227.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cQuantGPD">cQuantGPD</a></code>, <code><a href="#topic+cGPDmle">cGPDmle</a></code>, <code><a href="#topic+ProbGPD">ProbGPD</a></code>, <code><a href="#topic+Prob">Prob</a></code>, <code><a href="#topic+KaplanMeier">KaplanMeier</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Set seed
set.seed(29072016)

# Pareto random sample
X &lt;- rpareto(500, shape=2)

# Censoring variable
Y &lt;- rpareto(500, shape=1)

# Observed sample
Z &lt;- pmin(X, Y)

# Censoring indicator
censored &lt;- (X&gt;Y)

# GPD-MLE estimator adapted for right censoring
cpot &lt;- cGPDmle(Z, censored=censored, plot=TRUE)

# Exceedance probability
q &lt;- 10
cProbGPD(Z, gamma1=cpot$gamma1, sigma1=cpot$sigma1,
         censored=censored, q=q, plot=TRUE)
         
# Return period
cReturnGPD(Z, gamma1=cpot$gamma1, sigma1=cpot$sigma1,
         censored=censored, q=q, plot=TRUE)         
</code></pre>

<hr>
<h2 id='cProbMOM'>
Estimator of small exceedance probabilities and large return periods using censored MOM
</h2><span id='topic+cProbMOM'></span><span id='topic+cReturnMOM'></span>

<h3>Description</h3>

<p>Computes estimates of a small exceedance probability <code class="reqn">P(X&gt;q)</code> or large return period <code class="reqn">1/P(X&gt;q)</code> using the Method of Moments estimates for the EVI adapted for right censoring.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cProbMOM(data, censored, gamma1, q, plot = FALSE, add = FALSE, 
         main = "Estimates of small exceedance probability", ...)

cReturnMOM(data, censored, gamma1, q, plot = FALSE, add = FALSE, 
           main = "Estimates of large return period", ...)        
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cProbMOM_+3A_data">data</code></td>
<td>

<p>Vector of <code class="reqn">n</code> observations.  
</p>
</td></tr>
<tr><td><code id="cProbMOM_+3A_censored">censored</code></td>
<td>

<p>A logical vector of length <code class="reqn">n</code> indicating if an observation is censored.
</p>
</td></tr>
<tr><td><code id="cProbMOM_+3A_gamma1">gamma1</code></td>
<td>

<p>Vector of <code class="reqn">n-1</code> estimates for the EVI obtained from <code><a href="#topic+cMoment">cMoment</a></code>.
</p>
</td></tr>
<tr><td><code id="cProbMOM_+3A_q">q</code></td>
<td>

<p>The used large quantile (we estimate <code class="reqn">P(X&gt;q)</code> or <code class="reqn">1/P(X&gt;q)</code> for <code class="reqn">q</code> large).
</p>
</td></tr>
<tr><td><code id="cProbMOM_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the estimates should be plotted as a function of <code class="reqn">k</code>, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="cProbMOM_+3A_add">add</code></td>
<td>

<p>Logical indicating if the estimates should be added to an existing plot, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="cProbMOM_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"Estimates of small exceedance probability"</code> for <code>cProbMOM</code>
and <code>"Estimates of large return period"</code> for <code>cReturnMOM</code>.
</p>
</td></tr>
<tr><td><code id="cProbMOM_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The probability is estimated as
</p>
<p style="text-align: center;"><code class="reqn"> \hat{P}(X&gt;q)=(1-km) \times (1+ \hat{\gamma}_1/a_{k,n} \times (q-Z_{n-k,n}))^{-1/\hat{\gamma}_1}</code>
</p>
<p> with <code class="reqn">Z_{i,n}</code> the <code class="reqn">i</code>-th order statistic of the data, <code class="reqn">\hat{\gamma}_1</code> the MOM estimator adapted for right censoring and <code class="reqn">km</code> the Kaplan-Meier estimator for the CDF evaluated in <code class="reqn">Z_{n-k,n}</code>. The value <code class="reqn">a</code> is defined as
</p>
<p style="text-align: center;"><code class="reqn">a_{k,n}=  Z_{n-k,n} H_{k,n} (1-\min(\hat{\gamma}_1,0)) /\hat{p}_k</code>
</p>
<p> with <code class="reqn">H_{k,n}</code> the ordinary Hill estimator
and <code class="reqn">\hat{p}_k</code> the proportion of the <code class="reqn">k</code> largest observations that is non-censored.
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>k</code></td>
<td>
<p>Vector of the values of the tail parameter <code class="reqn">k</code>.</p>
</td></tr>
<tr><td><code>P</code></td>
<td>
<p>Vector of the corresponding probability estimates, only returned for <code>cProbMOM</code>.</p>
</td></tr>
<tr><td><code>R</code></td>
<td>
<p>Vector of the corresponding estimates for the return period, only returned for <code>cReturnMOM</code>.</p>
</td></tr>
<tr><td><code>q</code></td>
<td>
<p>The used large quantile.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens
</p>


<h3>References</h3>

<p>Einmahl, J.H.J., Fils-Villetard, A. and Guillou, A. (2008). &quot;Statistics of Extremes Under Random Censoring.&quot;
<em>Bernoulli</em>, 14, 207&ndash;227.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cQuantMOM">cQuantMOM</a></code>, <code><a href="#topic+cMoment">cMoment</a></code>, <code><a href="#topic+ProbMOM">ProbMOM</a></code>, <code><a href="#topic+Prob">Prob</a></code>, <code><a href="#topic+KaplanMeier">KaplanMeier</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Set seed
set.seed(29072016)

# Pareto random sample
X &lt;- rpareto(500, shape=2)

# Censoring variable
Y &lt;- rpareto(500, shape=1)

# Observed sample
Z &lt;- pmin(X, Y)

# Censoring indicator
censored &lt;- (X&gt;Y)

# Moment estimator adapted for right censoring
cmom &lt;- cMoment(Z, censored=censored, plot=TRUE)

# Small exceedance probability
q &lt;- 10
cProbMOM(Z, censored=censored, gamma1=cmom$gamma1, q=q, plot=TRUE)

# Return period
cReturnMOM(Z, censored=censored, gamma1=cmom$gamma1, q=q, plot=TRUE)
</code></pre>

<hr>
<h2 id='cQuant'>
Estimator of large quantiles using censored Hill
</h2><span id='topic+cQuant'></span>

<h3>Description</h3>

<p>Computes estimates of large quantiles <code class="reqn">Q(1-p)</code> using the estimates for the EVI obtained from the Hill estimator adapted for right censoring.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cQuant(data, censored, gamma1, p, plot = FALSE, add = FALSE, 
       main = "Estimates of extreme quantile", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cQuant_+3A_data">data</code></td>
<td>

<p>Vector of <code class="reqn">n</code> observations.  
</p>
</td></tr>
<tr><td><code id="cQuant_+3A_censored">censored</code></td>
<td>

<p>A logical vector of length <code class="reqn">n</code> indicating if an observation is censored.
</p>
</td></tr>
<tr><td><code id="cQuant_+3A_gamma1">gamma1</code></td>
<td>

<p>Vector of <code class="reqn">n-1</code> estimates for the EVI obtained from <code><a href="#topic+cHill">cHill</a></code>.
</p>
</td></tr>
<tr><td><code id="cQuant_+3A_p">p</code></td>
<td>

<p>The exceedance probability of the quantile (we estimate <code class="reqn">Q(1-p)</code> for <code class="reqn">p</code> small).
</p>
</td></tr>
<tr><td><code id="cQuant_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the estimates should be plotted as a function of <code class="reqn">k</code>, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="cQuant_+3A_add">add</code></td>
<td>

<p>Logical indicating if the estimates should be added to an existing plot, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="cQuant_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"Estimates of extreme quantile"</code>.
</p>
</td></tr>
<tr><td><code id="cQuant_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The quantile is estimated as </p>
<p style="text-align: center;"><code class="reqn">\hat{Q}(1-p)=Z_{n-k,n} \times ( (1-km)/p)^{H_{k,n}^c}</code>
</p>
<p> with <code class="reqn">Z_{i,n}</code> the <code class="reqn">i</code>-th order statistic of the data, <code class="reqn">H_{k,n}^c</code>
the Hill estimator adapted for right censoring and <code class="reqn">km</code> the Kaplan-Meier estimator for the CDF evaluated in <code class="reqn">Z_{n-k,n}</code>.
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>k</code></td>
<td>
<p>Vector of the values of the tail parameter <code class="reqn">k</code>.</p>
</td></tr>
<tr><td><code>Q</code></td>
<td>
<p>Vector of the corresponding quantile estimates.</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>The used exceedance probability.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens.
</p>


<h3>References</h3>

<p>Beirlant, J., Guillou, A., Dierckx, G. and Fils-Villetard, A. (2007). &quot;Estimation of the Extreme Value Index and Extreme Quantiles Under Random Censoring.&quot; <em>Extremes</em>, 10, 151&ndash;174.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cHill">cHill</a></code>, <code><a href="#topic+cProb">cProb</a></code>, <code><a href="#topic+Quant">Quant</a></code>, <code><a href="#topic+KaplanMeier">KaplanMeier</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Set seed
set.seed(29072016)

# Pareto random sample
X &lt;- rpareto(500, shape=2)

# Censoring variable
Y &lt;- rpareto(500, shape=1)

# Observed sample
Z &lt;- pmin(X, Y)

# Censoring indicator
censored &lt;- (X&gt;Y)

# Hill estimator adapted for right censoring
chill &lt;- cHill(Z, censored=censored, plot=TRUE)

# Large quantile
p &lt;- 10^(-4)
cQuant(Z, gamma1=chill$gamma, censored=censored, p=p, plot=TRUE)
</code></pre>

<hr>
<h2 id='cQuantGH'>
Estimator of large quantiles using censored Hill
</h2><span id='topic+cQuantGH'></span>

<h3>Description</h3>

<p>Computes estimates of large quantiles <code class="reqn">Q(1-p)</code> using the estimates for the EVI obtained from the generalised Hill estimator adapted for right censoring.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cQuantGH(data, censored, gamma1, p, plot = FALSE, add = FALSE, 
         main = "Estimates of extreme quantile", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cQuantGH_+3A_data">data</code></td>
<td>

<p>Vector of <code class="reqn">n</code> observations.  
</p>
</td></tr>
<tr><td><code id="cQuantGH_+3A_censored">censored</code></td>
<td>

<p>A logical vector of length <code class="reqn">n</code> indicating if an observation is censored.
</p>
</td></tr>
<tr><td><code id="cQuantGH_+3A_gamma1">gamma1</code></td>
<td>

<p>Vector of <code class="reqn">n-1</code> estimates for the EVI obtained from <code><a href="#topic+cgenHill">cgenHill</a></code>.
</p>
</td></tr>
<tr><td><code id="cQuantGH_+3A_p">p</code></td>
<td>

<p>The exceedance probability of the quantile (we estimate <code class="reqn">Q(1-p)</code> for <code class="reqn">p</code> small).
</p>
</td></tr>
<tr><td><code id="cQuantGH_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the estimates should be plotted as a function of <code class="reqn">k</code>, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="cQuantGH_+3A_add">add</code></td>
<td>

<p>Logical indicating if the estimates should be added to an existing plot, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="cQuantGH_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"Estimates of extreme quantile"</code>.
</p>
</td></tr>
<tr><td><code id="cQuantGH_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The quantile is estimated as 
</p>
<p style="text-align: center;"><code class="reqn">\hat{Q}(1-p)= Z_{n-k,n} + a_{k,n} ( ( (1-km)/p)^{\hat{\gamma}_1} -1 ) / \hat{\gamma}_1)</code>
</p>
 
<p>with <code class="reqn">Z_{i,n}</code> the <code class="reqn">i</code>-th order statistic of the data, <code class="reqn">\hat{\gamma}_1</code> the generalised Hill estimator adapted for right censoring and <code class="reqn">km</code> the Kaplan-Meier estimator for the CDF evaluated in <code class="reqn">Z_{n-k,n}</code>. The value <code class="reqn">a</code> is defined as
</p>
<p style="text-align: center;"><code class="reqn">a_{k,n} = Z_{n-k,n} H_{k,n} (1-S_{Z,k,n}) / \hat{p}_k</code>
</p>
<p> with <code class="reqn">H_{k,n}</code> the ordinary Hill estimator
and <code class="reqn">\hat{p}_k</code> the proportion of the <code class="reqn">k</code> largest observations that is non-censored, and
</p>
<p style="text-align: center;"><code class="reqn">S_{Z,k,n} = 1 - (1-M_1^2/M_2)^(-1) / 2</code>
</p>
<p> with </p>
<p style="text-align: center;"><code class="reqn">M_l = =1/k\sum_{j=1}^k (\log X_{n-j+1,n}- \log X_{n-k,n})^l.</code>
</p>



<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>k</code></td>
<td>
<p>Vector of the values of the tail parameter <code class="reqn">k</code>.</p>
</td></tr>
<tr><td><code>Q</code></td>
<td>
<p>Vector of the corresponding quantile estimates.</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>The used exceedance probability.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens
</p>


<h3>References</h3>

<p>Einmahl, J.H.J., Fils-Villetard, A. and Guillou, A. (2008). &quot;Statistics of Extremes Under Random Censoring.&quot;
<em>Bernoulli</em>, 14, 207&ndash;227.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cProbGH">cProbGH</a></code>, <code><a href="#topic+cgenHill">cgenHill</a></code>, <code><a href="#topic+QuantGH">QuantGH</a></code>, <code><a href="#topic+Quant">Quant</a></code>, <code><a href="#topic+KaplanMeier">KaplanMeier</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Set seed
set.seed(29072016)

# Pareto random sample
X &lt;- rpareto(500, shape=2)

# Censoring variable
Y &lt;- rpareto(500, shape=1)

# Observed sample
Z &lt;- pmin(X, Y)

# Censoring indicator
censored &lt;- (X&gt;Y)

# Generalised Hill estimator adapted for right censoring
cghill &lt;- cgenHill(Z, censored=censored, plot=TRUE)

# Large quantile
p &lt;- 10^(-4)
cQuantGH(Z, gamma1=cghill$gamma, censored=censored, p=p, plot=TRUE)
</code></pre>

<hr>
<h2 id='cQuantGPD'>
Estimator of large quantiles using censored GPD-MLE
</h2><span id='topic+cQuantGPD'></span>

<h3>Description</h3>

<p>Computes estimates of large quantiles <code class="reqn">Q(1-p)</code> using the estimates for the EVI obtained from the GPD-ML estimator adapted for right censoring.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cQuantGPD(data, censored, gamma1, sigma1, p, plot = FALSE, add = FALSE, 
          main = "Estimates of extreme quantile", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cQuantGPD_+3A_data">data</code></td>
<td>

<p>Vector of <code class="reqn">n</code> observations.  
</p>
</td></tr>
<tr><td><code id="cQuantGPD_+3A_censored">censored</code></td>
<td>

<p>A logical vector of length <code class="reqn">n</code> indicating if an observation is censored.
</p>
</td></tr>
<tr><td><code id="cQuantGPD_+3A_gamma1">gamma1</code></td>
<td>

<p>Vector of <code class="reqn">n-1</code> estimates for the EVI obtained from <code><a href="#topic+cGPDmle">cGPDmle</a></code>.
</p>
</td></tr>  
<tr><td><code id="cQuantGPD_+3A_sigma1">sigma1</code></td>
<td>

<p>Vector of <code class="reqn">n-1</code> estimates for <code class="reqn">\sigma_1</code> obtained from <code><a href="#topic+cGPDmle">cGPDmle</a></code>.
</p>
</td></tr>
<tr><td><code id="cQuantGPD_+3A_p">p</code></td>
<td>

<p>The exceedance probability of the quantile (we estimate <code class="reqn">Q(1-p)</code> for <code class="reqn">p</code> small).
</p>
</td></tr>
<tr><td><code id="cQuantGPD_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the estimates should be plotted as a function of <code class="reqn">k</code>, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="cQuantGPD_+3A_add">add</code></td>
<td>

<p>Logical indicating if the estimates should be added to an existing plot, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="cQuantGPD_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"Estimates of extreme quantile"</code>.
</p>
</td></tr>
<tr><td><code id="cQuantGPD_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The quantile is estimated as 
</p>
<p style="text-align: center;"><code class="reqn">\hat{Q}(1-p)= Z_{n-k,n} + a_{k,n} ( ( (1-km)/p)^{\hat{\gamma}_1} -1 ) / \hat{\gamma}_1)</code>
</p>
 
<p>ith <code class="reqn">Z_{i,n}</code> the <code class="reqn">i</code>-th order statistic of the data, <code class="reqn">\hat{\gamma}_1</code> the generalised Hill estimator adapted for right censoring and <code class="reqn">km</code> the Kaplan-Meier estimator for the CDF evaluated in <code class="reqn">Z_{n-k,n}</code>. The value <code class="reqn">a</code> is defined as
</p>
<p style="text-align: center;"><code class="reqn">a_{k,n} = \hat{\sigma}_1 / \hat{p}_k</code>
</p>
<p> with <code class="reqn">\hat{\sigma}_1</code> the ML estimate for <code class="reqn">\sigma_1</code>
and <code class="reqn">\hat{p}_k</code> the proportion of the <code class="reqn">k</code> largest observations that is non-censored.
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>k</code></td>
<td>
<p>Vector of the values of the tail parameter <code class="reqn">k</code>.</p>
</td></tr>
<tr><td><code>Q</code></td>
<td>
<p>Vector of the corresponding quantile estimates.</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>The used exceedance probability.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens
</p>


<h3>References</h3>

<p>Einmahl, J.H.J., Fils-Villetard, A. and Guillou, A. (2008). &quot;Statistics of Extremes Under Random Censoring.&quot;
<em>Bernoulli</em>, 14, 207&ndash;227.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cProbGPD">cProbGPD</a></code>, <code><a href="#topic+cGPDmle">cGPDmle</a></code>, <code><a href="#topic+QuantGPD">QuantGPD</a></code>, <code><a href="#topic+Quant">Quant</a></code>, <code><a href="#topic+KaplanMeier">KaplanMeier</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Set seed
set.seed(29072016)

# Pareto random sample
X &lt;- rpareto(500, shape=2)

# Censoring variable
Y &lt;- rpareto(500, shape=1)

# Observed sample
Z &lt;- pmin(X, Y)

# Censoring indicator
censored &lt;- (X&gt;Y)

# GPD-MLE estimator adapted for right censoring
cpot &lt;- cGPDmle(Z, censored=censored, plot=TRUE)

# Large quantile
p &lt;- 10^(-4)
cQuantGPD(Z, gamma1=cpot$gamma1, sigma1=cpot$sigma1,
         censored=censored, p=p, plot=TRUE)
</code></pre>

<hr>
<h2 id='cQuantMOM'>
Estimator of large quantiles using censored MOM
</h2><span id='topic+cQuantMOM'></span>

<h3>Description</h3>

<p>Computes estimates of large quantiles <code class="reqn">Q(1-p)</code> using the estimates for the EVI obtained from the MOM estimator adapted for right censoring.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cQuantMOM(data, censored, gamma1, p, plot = FALSE, add = FALSE,
          main = "Estimates of extreme quantile", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cQuantMOM_+3A_data">data</code></td>
<td>

<p>Vector of <code class="reqn">n</code> observations.  
</p>
</td></tr>
<tr><td><code id="cQuantMOM_+3A_censored">censored</code></td>
<td>

<p>A logical vector of length <code class="reqn">n</code> indicating if an observation is censored.
</p>
</td></tr>
<tr><td><code id="cQuantMOM_+3A_gamma1">gamma1</code></td>
<td>

<p>Vector of <code class="reqn">n-1</code> estimates for the EVI obtained from <code><a href="#topic+cMoment">cMoment</a></code>.
</p>
</td></tr>
<tr><td><code id="cQuantMOM_+3A_p">p</code></td>
<td>

<p>The exceedance probability of the quantile (we estimate <code class="reqn">Q(1-p)</code> for <code class="reqn">p</code> small).
</p>
</td></tr>
<tr><td><code id="cQuantMOM_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the estimates should be plotted as a function of <code class="reqn">k</code>, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="cQuantMOM_+3A_add">add</code></td>
<td>

<p>Logical indicating if the estimates should be added to an existing plot, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="cQuantMOM_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"Estimates of extreme quantile"</code>.
</p>
</td></tr>
<tr><td><code id="cQuantMOM_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The quantile is estimated as 
</p>
<p style="text-align: center;"><code class="reqn">\hat{Q}(1-p)= Z_{n-k,n} + a_{k,n} ( ( (1-km)/p)^{\hat{\gamma}_1} -1 ) / \hat{\gamma}_1)</code>
</p>
 
<p>ith <code class="reqn">Z_{i,n}</code> the <code class="reqn">i</code>-th order statistic of the data, <code class="reqn">\hat{\gamma}_1</code> the MOM estimator adapted for right censoring and <code class="reqn">km</code> the Kaplan-Meier estimator for the CDF evaluated in <code class="reqn">Z_{n-k,n}</code>. The value <code class="reqn">a</code> is defined as
</p>
<p style="text-align: center;"><code class="reqn">a_{k,n} = Z_{n-k,n} H_{k,n} (1-\min(\hat{\gamma}_1,0)) /\hat{p}_k</code>
</p>
<p> with <code class="reqn">H_{k,n}</code> the ordinary Hill estimator
and <code class="reqn">\hat{p}_k</code> the proportion of the <code class="reqn">k</code> largest observations that is non-censored.
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>k</code></td>
<td>
<p>Vector of the values of the tail parameter <code class="reqn">k</code>.</p>
</td></tr>
<tr><td><code>Q</code></td>
<td>
<p>Vector of the corresponding quantile estimates.</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>The used exceedance probability.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens
</p>


<h3>References</h3>

<p>Einmahl, J.H.J., Fils-Villetard, A. and Guillou, A. (2008). &quot;Statistics of Extremes Under Random Censoring.&quot;
<em>Bernoulli</em>, 14, 207&ndash;227.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cProbMOM">cProbMOM</a></code>, <code><a href="#topic+cMoment">cMoment</a></code>, <code><a href="#topic+QuantMOM">QuantMOM</a></code>, <code><a href="#topic+Quant">Quant</a></code>, <code><a href="#topic+KaplanMeier">KaplanMeier</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Set seed
set.seed(29072016)

# Pareto random sample
X &lt;- rpareto(500, shape=2)

# Censoring variable
Y &lt;- rpareto(500, shape=1)

# Observed sample
Z &lt;- pmin(X, Y)

# Censoring indicator
censored &lt;- (X&gt;Y)

# Moment estimator adapted for right censoring
cmom &lt;- cMoment(Z, censored=censored, plot=TRUE)

# Large quantile
p &lt;- 10^(-4)
cQuantMOM(Z, censored=censored, gamma1=cmom$gamma1, p=p, plot=TRUE)
</code></pre>

<hr>
<h2 id='crHill'>
Hill-type estimator for the conditional EVI
</h2><span id='topic+crHill'></span>

<h3>Description</h3>

<p>Hill-type estimator for the conditional Extreme Value Index (EVI) adapted for censored data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crHill(x, Xtilde, Ytilde, censored, h, 
       kernel = c("biweight", "normal", "uniform", "triangular", "epanechnikov"), 
       logk = FALSE, plot = FALSE, add = FALSE, main = "", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="crHill_+3A_x">x</code></td>
<td>

<p>Value of the conditioning variable <code class="reqn">X</code> to estimate the EVI at.
</p>
</td></tr>
<tr><td><code id="crHill_+3A_xtilde">Xtilde</code></td>
<td>

<p>Vector of length <code class="reqn">n</code> containing the censored sample of the conditioning variable <code class="reqn">X</code>.
</p>
</td></tr>
<tr><td><code id="crHill_+3A_ytilde">Ytilde</code></td>
<td>

<p>Vector of length <code class="reqn">n</code> containing the censored sample  of the variable <code class="reqn">Y</code>.
</p>
</td></tr>
<tr><td><code id="crHill_+3A_censored">censored</code></td>
<td>

<p>A logical vector of length <code class="reqn">n</code> indicating if an observation is censored.
</p>
</td></tr>
<tr><td><code id="crHill_+3A_h">h</code></td>
<td>

<p>Bandwidth of the non-parametric estimator.
</p>
</td></tr>
<tr><td><code id="crHill_+3A_kernel">kernel</code></td>
<td>

<p>Kernel of the non-parametric estimator. One of <code>"biweight"</code> (default), <code>"normal"</code>, <code>"uniform"</code>, <code>"triangular"</code> and <code>"epanechnikov"</code>.
</p>
</td></tr>
<tr><td><code id="crHill_+3A_logk">logk</code></td>
<td>

<p>Logical indicating if the Hill-type estimates are plotted as a function of <code class="reqn">\log(k)</code> (<code>logk=TRUE</code>) or as a function of <code class="reqn">k</code>. Default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="crHill_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the estimates should be plotted as a function of <code class="reqn">k</code>, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="crHill_+3A_add">add</code></td>
<td>

<p>Logical indicating if the estimates should be added to an existing plot, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="crHill_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>""</code> (no title).
</p>
</td></tr>
<tr><td><code id="crHill_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a Hill-type estimator of the EVI of <code class="reqn">Y</code> given <code class="reqn">X=x</code>. The estimator uses the censored sample <code class="reqn">(\tilde{X}_i, \tilde{Y}_i)</code>, for <code class="reqn">i=1,\ldots,n</code>, where <code class="reqn">X</code> and <code class="reqn">Y</code> are censored at the same time. We assume that <code class="reqn">Y</code> and the censoring variable are conditionally independent given <code class="reqn">X</code>.
</p>
<p>See Section 4.4.3 in Albrecher et al. (2017) for more details.
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>k</code></td>
<td>
<p>Vector of the values of the tail parameter <code class="reqn">k</code>.</p>
</td></tr>
<tr><td><code>gamma</code></td>
<td>
<p>Vector of the corresponding Hill-type estimates.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens
</p>


<h3>References</h3>

<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+crParetoQQ">crParetoQQ</a></code>, <code><a href="#topic+crSurv">crSurv</a></code>, <code><a href="#topic+cHill">cHill</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Set seed
set.seed(29072016)

# Pareto random sample
Y &lt;- rpareto(200, shape=2)

# Censoring variable
C &lt;- rpareto(200, shape=1)

# Observed (censored) sample of variable Y
Ytilde &lt;- pmin(Y, C)

# Censoring indicator
censored &lt;- (Y&gt;C)

# Conditioning variable
X &lt;- seq(1, 10, length.out=length(Y))

# Observed (censored) sample of conditioning variable
Xtilde &lt;- X
Xtilde[censored] &lt;- X[censored] - runif(sum(censored), 0, 1)


# Conditional Pareto QQ-plot
crParetoQQ(x=1, Xtilde=Xtilde, Ytilde=Ytilde, censored=censored, h=2)

# Plot Hill-type estimates
crHill(x=1, Xtilde, Ytilde, censored, h=2, plot=TRUE)
</code></pre>

<hr>
<h2 id='crParetoQQ'>
Conditional Pareto quantile plot for right censored data
</h2><span id='topic+crParetoQQ'></span>

<h3>Description</h3>

<p>Conditional Pareto QQ-plot adapted for right censored data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crParetoQQ(x, Xtilde, Ytilde, censored, h, 
           kernel = c("biweight", "normal", "uniform", "triangular", "epanechnikov"), 
           plot = TRUE, add = FALSE, main = "Pareto QQ-plot", type = "p", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="crParetoQQ_+3A_x">x</code></td>
<td>

<p>Value of the conditioning variable <code class="reqn">X</code> at which to make the conditional Pareto QQ-plot.
</p>
</td></tr>
<tr><td><code id="crParetoQQ_+3A_xtilde">Xtilde</code></td>
<td>

<p>Vector of length <code class="reqn">n</code> containing the censored sample of the conditioning variable <code class="reqn">X</code>.
</p>
</td></tr>
<tr><td><code id="crParetoQQ_+3A_ytilde">Ytilde</code></td>
<td>

<p>Vector of length <code class="reqn">n</code> containing the censored sample  of the variable <code class="reqn">Y</code>.
</p>
</td></tr>
<tr><td><code id="crParetoQQ_+3A_censored">censored</code></td>
<td>

<p>A logical vector of length <code class="reqn">n</code> indicating if an observation is censored.
</p>
</td></tr>
<tr><td><code id="crParetoQQ_+3A_h">h</code></td>
<td>

<p>Bandwidth of the non-parametric estimator for the conditional survival function (<code><a href="#topic+crSurv">crSurv</a></code>).
</p>
</td></tr>
<tr><td><code id="crParetoQQ_+3A_kernel">kernel</code></td>
<td>

<p>Kernel of the non-parametric estimator for the conditional survival function (<code><a href="#topic+crSurv">crSurv</a></code>). One of <code>"biweight"</code> (default), <code>"normal"</code>, <code>"uniform"</code>, <code>"triangular"</code> and <code>"epanechnikov"</code>.
</p>
</td></tr>
<tr><td><code id="crParetoQQ_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the quantiles should be plotted in a Pareto QQ-plot, default is <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="crParetoQQ_+3A_add">add</code></td>
<td>

<p>Logical indicating if the quantiles should be added to an existing plot, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="crParetoQQ_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"Pareto QQ-plot"</code>.
</p>
</td></tr>
<tr><td><code id="crParetoQQ_+3A_type">type</code></td>
<td>

<p>Type of the plot, default is <code>"p"</code> meaning points are plotted, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
<tr><td><code id="crParetoQQ_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We construct a Pareto QQ-plot for <code class="reqn">Y</code> conditional on <code class="reqn">X=x</code> using the censored sample <code class="reqn">(\tilde{X}_i, \tilde{Y}_i)</code>, for <code class="reqn">i=1,\ldots,n</code>, where <code class="reqn">X</code> and <code class="reqn">Y</code> are censored at the same time. We assume that <code class="reqn">Y</code> and the censoring variable are conditionally independent given <code class="reqn">X</code>.
</p>
<p>The conditional Pareto QQ-plot adapted for right censoring is given by
</p>
<p style="text-align: center;"><code class="reqn">( -\log(1-\hat{F}_{Y|X}(\tilde{Y}_{j,n}|x)), \log \tilde{Y}_{j,n} )</code>
</p>

<p>for <code class="reqn">j=1,\ldots,n-1,</code>
with <code class="reqn">\tilde{Y}_{i,n}</code> the <code class="reqn">i</code>-th order statistic of the censored data and <code class="reqn">\hat{F}_{Y|X}(y|x)</code> the non-parametric estimator for the conditional CDF of Akritas and Van Keilegom (2003), see <code><a href="#topic+crSurv">crSurv</a></code>.
</p>
<p>See Section 4.4.3 in Albrecher et al. (2017) for more details.
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>pqq.the</code></td>
<td>
<p>Vector of the theoretical quantiles, see Details.</p>
</td></tr>
<tr><td><code>pqq.emp</code></td>
<td>
<p>Vector of the empirical quantiles from the log-transformed <code class="reqn">Y</code> data.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens
</p>


<h3>References</h3>

<p>Akritas, M.G. and Van Keilegom, I. (2003). &quot;Estimation of Bivariate and Marginal Distributions
With Censored Data.&quot; <em>Journal of the Royal Statistical Society: Series B</em>, 65, 457&ndash;471.
</p>
<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+crSurv">crSurv</a></code>, <code><a href="#topic+crHill">crHill</a></code>, <code><a href="#topic+cParetoQQ">cParetoQQ</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Set seed
set.seed(29072016)

# Pareto random sample
Y &lt;- rpareto(200, shape=2)

# Censoring variable
C &lt;- rpareto(200, shape=1)

# Observed (censored) sample of variable Y
Ytilde &lt;- pmin(Y, C)

# Censoring indicator
censored &lt;- (Y&gt;C)

# Conditioning variable
X &lt;- seq(1, 10, length.out=length(Y))

# Observed (censored) sample of conditioning variable
Xtilde &lt;- X
Xtilde[censored] &lt;- X[censored] - runif(sum(censored), 0, 1)


# Conditional Pareto QQ-plot
crParetoQQ(x=1, Xtilde=Xtilde, Ytilde=Ytilde, censored=censored, h=2)

# Plot Hill-type estimates
crHill(x=1, Xtilde, Ytilde, censored, h=2, plot=TRUE)
</code></pre>

<hr>
<h2 id='crSurv'>
Non-parametric estimator of conditional survival function
</h2><span id='topic+crSurv'></span>

<h3>Description</h3>

<p>Non-parametric estimator of the conditional survival function of <code class="reqn">Y</code> given <code class="reqn">X</code> for censored data, see Akritas and Van Keilegom (2003).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crSurv(x, y, Xtilde, Ytilde, censored, h, 
       kernel = c("biweight", "normal", "uniform", "triangular", "epanechnikov"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="crSurv_+3A_x">x</code></td>
<td>

<p>The value of the conditioning variable <code class="reqn">X</code> to evaluate the survival function at. <code>x</code> needs to be a single number or a vector with the same length as <code>y</code>.
</p>
</td></tr>
<tr><td><code id="crSurv_+3A_y">y</code></td>
<td>

<p>The value(s) of the variable <code class="reqn">Y</code> to evaluate the survival function at.
</p>
</td></tr>
<tr><td><code id="crSurv_+3A_xtilde">Xtilde</code></td>
<td>

<p>Vector of length <code class="reqn">n</code> containing the censored sample of the conditioning variable <code class="reqn">X</code>.
</p>
</td></tr>
<tr><td><code id="crSurv_+3A_ytilde">Ytilde</code></td>
<td>

<p>Vector of length <code class="reqn">n</code> containing the censored sample  of the variable <code class="reqn">Y</code>.
</p>
</td></tr>
<tr><td><code id="crSurv_+3A_censored">censored</code></td>
<td>

<p>A logical vector of length <code class="reqn">n</code> indicating if an observation is censored.
</p>
</td></tr>
<tr><td><code id="crSurv_+3A_h">h</code></td>
<td>

<p>Bandwidth of the non-parametric estimator.
</p>
</td></tr>
<tr><td><code id="crSurv_+3A_kernel">kernel</code></td>
<td>

<p>Kernel of the non-parametric estimator. One of <code>"biweight"</code> (default), <code>"normal"</code>, <code>"uniform"</code>, <code>"triangular"</code> and <code>"epanechnikov"</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We estimate the conditional survival function </p>
<p style="text-align: center;"><code class="reqn">1-F_{Y|X}(y|x)</code>
</p>
<p> using the censored sample <code class="reqn">(\tilde{X}_i, \tilde{Y}_i)</code>, for <code class="reqn">i=1,\ldots,n</code>, where <code class="reqn">X</code> and <code class="reqn">Y</code> are censored at the same time. We assume that <code class="reqn">Y</code> and the censoring variable are conditionally independent given <code class="reqn">X</code>.
</p>
<p>The estimator is given by
</p>
<p style="text-align: center;"><code class="reqn">1-\hat{F}_{Y|X}(y|x) = \prod_{\tilde{Y}_i \le y} (1-W_{n,i}(x;h_n)/(\sum_{j=1}^nW_{n,j}(x;h_n) I\{\tilde{Y}_j \ge \tilde{Y}_i\}))^{\Delta_i}</code>
</p>

<p>where <code class="reqn">\Delta_i=1</code> when <code class="reqn">(\tilde{X}_i, \tilde{Y}_i)</code> is censored and 0 otherwise. The weights are given by
</p>
<p style="text-align: center;"><code class="reqn">W_{n,i}(x;h_n) = K((x-\tilde{X}_i)/h_n)/\sum_{\Delta_j=1}K((x-\tilde{X}_j)/h_n)</code>
</p>
<p> when <code class="reqn">\Delta_i=1</code> and 0 otherwise.
</p>
<p>See Section 4.4.3 in Albrecher et al. (2017) for more details.
</p>


<h3>Value</h3>

<p>Estimates for <code class="reqn">1-F_{Y|X}(y|x)</code> as described above.
</p>


<h3>Author(s)</h3>

<p>Tom Reynkens
</p>


<h3>References</h3>

<p>Akritas, M.G. and Van Keilegom, I. (2003). &quot;Estimation of Bivariate and Marginal Distributions
With Censored Data.&quot; <em>Journal of the Royal Statistical Society: Series B</em>, 65, 457&ndash;471.
</p>
<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+crParetoQQ">crParetoQQ</a></code>, <code><a href="#topic+crHill">crHill</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Set seed
set.seed(29072016)

# Pareto random sample
Y &lt;- rpareto(200, shape=2)

# Censoring variable
C &lt;- rpareto(200, shape=1)

# Observed (censored) sample of variable Y
Ytilde &lt;- pmin(Y, C)

# Censoring indicator
censored &lt;- (Y&gt;C)

# Conditioning variable
X &lt;- seq(1, 10, length.out=length(Y))

# Observed (censored) sample of conditioning variable
Xtilde &lt;- X
Xtilde[censored] &lt;- X[censored] - runif(sum(censored), 0, 1)

# Plot estimates of the conditional survival function
x &lt;- 5
y &lt;- seq(0, 5, 1/100)
plot(y, crSurv(x, y, Xtilde=Xtilde, Ytilde=Ytilde, censored=censored, h=5), type="l", 
     xlab="y", ylab="Conditional survival function")
</code></pre>

<hr>
<h2 id='CTE'>
Conditional Tail Expectation
</h2><span id='topic+CTE'></span><span id='topic+ES'></span>

<h3>Description</h3>

<p>Compute Conditional Tail Expectation (CTE) <code class="reqn">CTE_{1-p}</code> of the fitted spliced distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CTE(p, splicefit)

ES(p, splicefit)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="CTE_+3A_p">p</code></td>
<td>

<p>The probability associated with the CTE (we estimate  <code class="reqn">CTE_{1-p}</code>).
</p>
</td></tr>
<tr><td><code id="CTE_+3A_splicefit">splicefit</code></td>
<td>

<p>A <code><a href="#topic+SpliceFit">SpliceFit</a></code> object,  e.g. output from <code><a href="#topic+SpliceFitPareto">SpliceFitPareto</a></code>, <code><a href="#topic+SpliceFiticPareto">SpliceFiticPareto</a></code> or <code><a href="#topic+SpliceFitGPD">SpliceFitGPD</a></code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Conditional Tail Expectation is defined as
</p>
<p style="text-align: center;"><code class="reqn">CTE_{1-p} = E(X | X&gt;Q(1-p)) = E(X | X&gt;VaR_{1-p}) = VaR_{1-p} + \Pi(VaR_{1-p})/p,</code>
</p>

<p>where <code class="reqn">\Pi(u)=E((X-u)_+)</code> is the premium of the excess-loss insurance with retention u.
</p>
<p>If the CDF is continuous in <code class="reqn">p</code>, we have <code class="reqn">CTE_{1-p}=TVaR_{1-p}= 1/p \int_0^p VaR_{1-s} ds</code> with
<code class="reqn">TVaR</code> the Tail Value-at-Risk.
</p>
<p>See Reynkens et al. (2017) and Section 4.6 of Albrecher et al. (2017) for more details.
</p>
<p>The <code>ES</code> function is the same function as <code>CTE</code> but is deprecated. 
</p>


<h3>Value</h3>

<p>Vector with the CTE corresponding to each element of <code class="reqn">p</code>.
</p>


<h3>Author(s)</h3>

<p>Tom Reynkens with <code>R</code> code from Roel Verbelen for the mixed Erlang quantiles.
</p>


<h3>References</h3>

<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>
<p>Reynkens, T., Verbelen, R., Beirlant, J. and Antonio, K. (2017). &quot;Modelling Censored Losses Using Splicing:
a Global Fit Strategy With Mixed Erlang and Extreme Value Distributions&quot;. <em>Insurance: Mathematics and Economics</em>, 77, 65&ndash;77.
</p>
<p>Verbelen, R., Gong, L., Antonio, K., Badescu, A. and Lin, S. (2015). &quot;Fitting Mixtures of
Erlangs to Censored and Truncated Data Using the EM Algorithm.&quot; <em>Astin Bulletin</em>, 45, 729&ndash;758
</p>


<h3>See Also</h3>

<p><code><a href="#topic+qSplice">qSplice</a></code>, <code><a href="#topic+ExcessSplice">ExcessSplice</a></code>, <code><a href="#topic+SpliceFit">SpliceFit</a></code>, <code><a href="#topic+SpliceFitPareto">SpliceFitPareto</a></code>, <code><a href="#topic+SpliceFiticPareto">SpliceFiticPareto</a></code>,  <code><a href="#topic+SpliceFitGPD">SpliceFitGPD</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

# Pareto random sample
X &lt;- rpareto(1000, shape = 2)

# Splice ME and Pareto
splicefit &lt;- SpliceFitPareto(X, 0.6)

p &lt;- seq(0.01, 0.99, 0.01)
# Plot of CTE
plot(p, CTE(p, splicefit), type="l", xlab="p", ylab=bquote(CTE[1-p]))

## End(Not run)
</code></pre>

<hr>
<h2 id='cWeibullQQ'>
Weibull quantile plot for right censored data
</h2><span id='topic+cWeibullQQ'></span>

<h3>Description</h3>

<p>Weibull QQ-plot adapted for right censored data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cWeibullQQ(data, censored, plot = TRUE, main = "Weibull QQ-plot", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cWeibullQQ_+3A_data">data</code></td>
<td>

<p>Vector of <code class="reqn">n</code> observations. 
</p>
</td></tr>
<tr><td><code id="cWeibullQQ_+3A_censored">censored</code></td>
<td>

<p>A logical vector of length <code class="reqn">n</code> indicating if an observation is censored.
</p>
</td></tr>
<tr><td><code id="cWeibullQQ_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the quantiles should be plotted in a Weibull QQ-plot, default is <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="cWeibullQQ_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"Weibull QQ-plot"</code>.
</p>
</td></tr>
<tr><td><code id="cWeibullQQ_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Weibull QQ-plot adapted for right censoring is given by
</p>
<p style="text-align: center;"><code class="reqn">( \log(-\log(1-F_{km}(Z_{j,n}))),  \log(Z_{j,n}) )</code>
</p>

<p>for <code class="reqn">j=1,\ldots,n-1,</code>
with <code class="reqn">Z_{i,n}</code> the <code class="reqn">i</code>-th order statistic of the data and <code class="reqn">F_{km}</code> the Kaplan-Meier estimator for the CDF.
Hence, it has the same empirical quantiles as an ordinary Weibull QQ-plot but replaces the theoretical quantiles <code class="reqn"> \log(-\log(1-j/(n+1)))</code> by <code class="reqn">\log(-\log(1-F_{km}(Z_{j,n})))</code>.
</p>
<p>This QQ-plot is only suitable for right censored data.
</p>
<p>In Beirlant et al. (2007), only a Pareto QQ-plot adapted for right-censored data is proposed. This QQ-plot is constructed using the same ideas, but is not described in the paper.
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>wqq.the</code></td>
<td>
<p>Vector of the theoretical quantiles, see Details.</p>
</td></tr>
<tr><td><code>wqq.emp</code></td>
<td>
<p>Vector of the empirical quantiles from the log-transformed data.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens
</p>


<h3>References</h3>

<p>Beirlant, J., Guillou, A., Dierckx, G. and Fils-Villetard, A. (2007). &quot;Estimation of the Extreme Value Index and Extreme Quantiles Under Random Censoring.&quot; <em>Extremes</em>, 10, 151&ndash;174.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+WeibullQQ">WeibullQQ</a></code>, <code><a href="#topic+cExpQQ">cExpQQ</a></code>, <code><a href="#topic+cLognormalQQ">cLognormalQQ</a></code>, <code><a href="#topic+cParetoQQ">cParetoQQ</a></code>, <code><a href="#topic+KaplanMeier">KaplanMeier</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Set seed
set.seed(29072016)

# Pareto random sample
X &lt;- rpareto(500, shape=2)

# Censoring variable
Y &lt;- rpareto(500, shape=1)

# Observed sample
Z &lt;- pmin(X, Y)

# Censoring indicator
censored &lt;- (X&gt;Y)

# Weibull QQ-plot adapted for right censoring
cWeibullQQ(Z, censored=censored)
</code></pre>

<hr>
<h2 id='EPD'>
EPD estimator
</h2><span id='topic+EPD'></span>

<h3>Description</h3>

<p>Fit the Extended Pareto Distribution (GPD) to the exceedances (peaks) over a threshold. Optionally, these estimates are plotted as a function of <code class="reqn">k</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EPD(data, rho = -1, start = NULL, direct = FALSE, warnings = FALSE, 
    logk = FALSE, plot = FALSE, add = FALSE, main = "EPD estimates of the EVI", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="EPD_+3A_data">data</code></td>
<td>

<p>Vector of <code class="reqn">n</code> observations. 
</p>
</td></tr>
<tr><td><code id="EPD_+3A_rho">rho</code></td>
<td>

<p>A parameter for the <code class="reqn">\rho</code>-estimator of Fraga Alves et al. (2003)
when strictly positive or choice(s) for <code class="reqn">\rho</code> if negative. Default is <code>-1</code>.
</p>
</td></tr>
<tr><td><code id="EPD_+3A_start">start</code></td>
<td>

<p>Vector of length 2 containing the starting values for the optimisation. The first element
is the starting value for the estimator of <code class="reqn">\gamma</code> and the second element is the starting value for the estimator of <code class="reqn">\kappa</code>. This argument is only used when <code>direct=TRUE</code>. Default is <code>NULL</code> meaning the initial value for <code class="reqn">\gamma</code> is the Hill estimator and the initial value for <code class="reqn">\kappa</code> is 0.
</p>
</td></tr>
<tr><td><code id="EPD_+3A_direct">direct</code></td>
<td>

<p>Logical indicating if the parameters are obtained by directly maximising the log-likelihood function, see Details. Default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="EPD_+3A_warnings">warnings</code></td>
<td>

<p>Logical indicating if possible warnings from the optimisation function are shown, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="EPD_+3A_logk">logk</code></td>
<td>

<p>Logical indicating if the estimates are plotted as a function of <code class="reqn">\log(k)</code> (<code>logk=TRUE</code>) or as a function of <code class="reqn">k</code>. Default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="EPD_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the estimates of <code class="reqn">\gamma</code> should be plotted as a function of <code class="reqn">k</code>, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="EPD_+3A_add">add</code></td>
<td>

<p>Logical indicating if the estimates of <code class="reqn">\gamma</code> should be added to an existing plot, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="EPD_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"EPD estimates of the EVI"</code>.
</p>
</td></tr>
<tr><td><code id="EPD_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We fit the Extended Pareto distribution to the relative excesses over a threshold (X/u).
The EPD has distribution function <code class="reqn">F(x) = 1-(x(1+\kappa-\kappa x^{\tau}))^{-1/\gamma}</code> 
with <code class="reqn">\tau = \rho/\gamma &lt;0&lt;\gamma</code> and <code class="reqn">\kappa&gt;\max(-1,1/\tau)</code>. 
</p>
<p>The parameters are determined using MLE and there are two possible approaches:
maximise the log-likelihood directly (<code>direct=TRUE</code>) or follow the approach detailed in
Beirlant et al. (2009) (<code>direct=FALSE</code>). The latter approach uses the score functions of the log-likelihood.
</p>
<p>See Section 4.2.1 of Albrecher et al. (2017) for more details.
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>k</code></td>
<td>
<p>Vector of the values of the tail parameter <code class="reqn">k</code>.</p>
</td></tr>
<tr><td><code>gamma</code></td>
<td>
<p>Vector of the corresponding estimates for the <code class="reqn">\gamma</code> parameter of the EPD.</p>
</td></tr>
<tr><td><code>kappa</code></td>
<td>
<p>Vector of the corresponding MLE estimates for the <code class="reqn">\kappa</code> parameter of the EPD.</p>
</td></tr>
<tr><td><code>tau</code></td>
<td>
<p>Vector of the corresponding estimates for the <code class="reqn">\tau</code> parameter of the EPD using Hill estimates and values for <code class="reqn">\rho</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens
</p>


<h3>References</h3>

<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>
<p>Beirlant, J., Joossens, E. and Segers, J. (2009). &quot;Second-Order Refined Peaks-Over-Threshold
Modelling for Heavy-Tailed Distributions.&quot; <em>Journal of Statistical Planning and Inference</em>, 139, 2800&ndash;2815.
</p>
<p>Fraga Alves, M.I. , Gomes, M.I. and de Haan, L. (2003). &quot;A New Class of Semi-parametric Estimators of the Second Order Parameter.&quot; <em>Portugaliae Mathematica</em>, 60, 193&ndash;214.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+GPDmle">GPDmle</a></code>, <code><a href="#topic+ProbEPD">ProbEPD</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(secura)

# EPD estimates for the EVI
epd &lt;- EPD(secura$size, plot=TRUE)

# Compute return periods
ReturnEPD(secura$size, 10^10, gamma=epd$gamma, kappa=epd$kappa, 
          tau=epd$tau, plot=TRUE)
</code></pre>

<hr>
<h2 id='EPDfit'>
Fit EPD using MLE
</h2><span id='topic+EPDfit'></span>

<h3>Description</h3>

<p>Fit the Extended Pareto Distribution (EPD) to data using Maximum Likelihood Estimation (MLE).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EPDfit(data, tau, start = c(0.1, 1), warnings = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="EPDfit_+3A_data">data</code></td>
<td>

<p>Vector of <code class="reqn">n</code> observations. 
</p>
</td></tr>
<tr><td><code id="EPDfit_+3A_tau">tau</code></td>
<td>

<p>Value for the <code class="reqn">\tau</code> parameter of the EPD. 
</p>
</td></tr>
<tr><td><code id="EPDfit_+3A_start">start</code></td>
<td>

<p>Vector of length 2 containing the starting values for the optimisation. The first element
is the starting value for the estimator of <code class="reqn">\gamma</code> and the second element is the starting value for the estimator of <code class="reqn">\kappa</code>. Default is <code>c(0.1,1)</code>.
</p>
</td></tr>
<tr><td><code id="EPDfit_+3A_warnings">warnings</code></td>
<td>

<p>Logical indicating if possible warnings from the optimisation function are shown, default is <code>FALSE</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See Section 4.2.1 of Albrecher et al. (2017) for more details.
</p>


<h3>Value</h3>

<p>A vector with the MLE estimate for the <code class="reqn">\gamma</code> parameter of the EPD as the first component and the MLE estimate for the <code class="reqn">\kappa</code> parameter of the EPD as the second component.
</p>


<h3>Author(s)</h3>

<p>Tom Reynkens
</p>


<h3>References</h3>

<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>
<p>Beirlant, J., Joossens, E. and Segers, J. (2009). &quot;Second-Order Refined Peaks-Over-Threshold
Modelling for Heavy-Tailed Distributions.&quot; <em>Journal of Statistical Planning and Inference</em>, 139, 2800&ndash;2815.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+EPD">EPD</a></code>, <code><a href="#topic+GPDfit">GPDfit</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(soa)

# Look at last 500 observations of SOA data
SOAdata &lt;- sort(soa$size)[length(soa$size)-(0:499)]

# Fit EPD to last 500 observations
res &lt;- EPDfit(SOAdata/sort(soa$size)[500], tau=-1)
</code></pre>

<hr>
<h2 id='EVTfit'>
EVT fit
</h2><span id='topic+EVTfit'></span>

<h3>Description</h3>

<p>Create an S3 object using an EVT (Extreme Value Theory) fit.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EVTfit(gamma, endpoint = NULL, sigma = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="EVTfit_+3A_gamma">gamma</code></td>
<td>

<p>Vector of estimates for <code class="reqn">\gamma</code>.
</p>
</td></tr>
<tr><td><code id="EVTfit_+3A_endpoint">endpoint</code></td>
<td>

<p>Vector of endpoints (with the same length as <code>gamma</code>). When <code>NULL</code> (default), a vector containing <code>Inf</code> for each value of <code>gamma</code> will be used.
</p>
</td></tr>
<tr><td><code id="EVTfit_+3A_sigma">sigma</code></td>
<td>

<p>Vector of scale estimates for the GPD (with the same length as <code>gamma</code>). When <code>NULL</code> (default), not included in the object. 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See Reynkens et al. (2017) and Section 4.3 of Albrecher et al. (2017) for details.
</p>


<h3>Value</h3>

<p>An S3 object containing the above input arguments.
</p>


<h3>Author(s)</h3>

<p>Tom Reynkens
</p>


<h3>References</h3>

<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>
<p>Reynkens, T., Verbelen, R., Beirlant, J. and Antonio, K. (2017). &quot;Modelling Censored Losses Using Splicing:
a Global Fit Strategy With Mixed Erlang and Extreme Value Distributions&quot;. <em>Insurance: Mathematics and Economics</em>, 77, 65&ndash;77.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+SpliceFit">SpliceFit</a></code>, <code><a href="#topic+SpliceFitPareto">SpliceFitPareto</a></code>, <code><a href="#topic+SpliceFiticPareto">SpliceFiticPareto</a></code>, <code><a href="#topic+SpliceFitGPD">SpliceFitGPD</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Create MEfit object
mefit &lt;- MEfit(p=c(0.65,0.35), shape=c(39,58), theta=16.19, M=2)

# Create EVTfit object
evtfit &lt;- EVTfit(gamma=c(0.76,0.64), endpoint=c(39096, Inf))

# Create SpliceFit object
splicefit &lt;- SpliceFit(const=c(0.5,0.996), trunclower=0, t=c(1020,39096), type=c("ME","TPa","Pa"),
                       MEfit=mefit, EVTfit=evtfit)

# Show summary
summary(splicefit)
</code></pre>

<hr>
<h2 id='ExcessEPD'>
Estimates for excess-loss premiums using EPD estimates
</h2><span id='topic+ExcessEPD'></span>

<h3>Description</h3>

<p>Estimate premiums of excess-loss reinsurance with retention <code class="reqn">R</code> and limit <code class="reqn">L</code> using EPD estimates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ExcessEPD(data, gamma, kappa, tau, R, L = Inf, warnings = TRUE, plot = TRUE, add = FALSE, 
          main = "Estimates for premium of excess-loss insurance", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ExcessEPD_+3A_data">data</code></td>
<td>

<p>Vector of <code class="reqn">n</code> observations.  
</p>
</td></tr>
<tr><td><code id="ExcessEPD_+3A_gamma">gamma</code></td>
<td>

<p>Vector of <code class="reqn">n-1</code> estimates for the EVI, obtained from <code><a href="#topic+EPD">EPD</a></code>.
</p>
</td></tr>
<tr><td><code id="ExcessEPD_+3A_kappa">kappa</code></td>
<td>

<p>Vector of <code class="reqn">n-1</code> estimates for <code class="reqn">\kappa</code>, obtained from <code><a href="#topic+EPD">EPD</a></code>.
</p>
</td></tr>
<tr><td><code id="ExcessEPD_+3A_tau">tau</code></td>
<td>

<p>Vector of <code class="reqn">n-1</code> estimates for <code class="reqn">\tau</code>, obtained from <code><a href="#topic+EPD">EPD</a></code>.
</p>
</td></tr>
<tr><td><code id="ExcessEPD_+3A_r">R</code></td>
<td>

<p>The retention level of the (re-)insurance.
</p>
</td></tr>
<tr><td><code id="ExcessEPD_+3A_l">L</code></td>
<td>

<p>The limit of the (re-)insurance, default is <code>Inf</code>.
</p>
</td></tr>
<tr><td><code id="ExcessEPD_+3A_warnings">warnings</code></td>
<td>

<p>Logical indicating if warnings are displayed, default is <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="ExcessEPD_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the estimates should be plotted as a function of <code class="reqn">k</code>, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="ExcessEPD_+3A_add">add</code></td>
<td>

<p>Logical indicating if the estimates should be added to an existing plot, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="ExcessEPD_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"Estimates for premium of excess-loss insurance"</code>.
</p>
</td></tr>
<tr><td><code id="ExcessEPD_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We need that <code class="reqn">u \ge X_{n-k,n}</code>, the <code class="reqn">(k+1)</code>-th largest observation.
If this is not the case, we return <code>NA</code> for the premium. A warning will be issued in
that case if <code>warnings=TRUE</code>.
</p>
<p>The premium for the excess-loss insurance with retention <code class="reqn">R</code> and limit <code class="reqn">L</code> is given by
</p>
<p style="text-align: center;"><code class="reqn">E(\min{(X-R)_+, L}) = \Pi(R) - \Pi(R+L)</code>
</p>

<p>where <code class="reqn">\Pi(u)=E((X-u)_+)=\int_u^{\infty} (1-F(z)) dz</code> is the premium of the excess-loss insurance with retention <code class="reqn">u</code>. When <code class="reqn">L=\infty</code>, the premium is equal to <code class="reqn">\Pi(R)</code>.
</p>
<p>We estimate <code class="reqn">\Pi</code> by
</p>
<p style="text-align: center;"><code class="reqn"> \hat{\Pi}(u) = (k+1)/(n+1) \times (X_{n-k,n})^{1/\hat{\gamma}} \times ((1-\hat{\kappa}/\hat{\gamma})(1/\hat{\gamma}-1)^{-1}u^{1-1/\hat{\gamma}} + 
\hat{\kappa}/(\hat{\gamma}X_{n-k,n}^{\hat{\tau}})(1/\hat{\gamma}-\hat{\tau}-1)^{-1}u^{1+\hat{\tau}-1/\hat{\gamma}})</code>
</p>

<p>with <code class="reqn">\hat{\gamma}, \hat{\kappa}</code> and <code class="reqn">\hat{\tau}</code> the estimates for the parameters of the EPD.
</p>
<p>See Section 4.6 of Albrecher et al. (2017) for more details.
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>k</code></td>
<td>
<p>Vector of the values of the tail parameter <code class="reqn">k</code>.</p>
</td></tr>
<tr><td><code>premium</code></td>
<td>
<p>The corresponding estimates for the premium.</p>
</td></tr>
<tr><td><code>R</code></td>
<td>
<p>The retention level of the (re-)insurance.</p>
</td></tr>
<tr><td><code>L</code></td>
<td>
<p>The limit of the (re-)insurance.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens
</p>


<h3>References</h3>

<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+EPD">EPD</a></code>, <code><a href="#topic+ExcessHill">ExcessHill</a></code>, <code><a href="#topic+ExcessGPD">ExcessGPD</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(secura)

# EPD estimator
epd &lt;- EPD(secura$size)

# Premium of excess-loss insurance with retention R
R &lt;- 10^7
ExcessEPD(secura$size, gamma=epd$gamma, kappa=epd$kappa, tau=epd$tau, R=R, ylim=c(0,2*10^4))
</code></pre>

<hr>
<h2 id='ExcessGPD'>
Estimates for excess-loss premiums using GPD-MLE estimates
</h2><span id='topic+ExcessGPD'></span>

<h3>Description</h3>

<p>Estimate premiums of excess-loss reinsurance with retention <code class="reqn">R</code> and limit <code class="reqn">L</code> using GPD-MLE estimates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ExcessGPD(data, gamma, sigma, R, L = Inf, warnings = TRUE, plot = TRUE, add = FALSE, 
          main = "Estimates for premium of excess-loss insurance", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ExcessGPD_+3A_data">data</code></td>
<td>

<p>Vector of <code class="reqn">n</code> observations.  
</p>
</td></tr>
<tr><td><code id="ExcessGPD_+3A_gamma">gamma</code></td>
<td>

<p>Vector of <code class="reqn">n-1</code> estimates for the EVI obtained from <code><a href="#topic+GPDmle">GPDmle</a></code>.
</p>
</td></tr>  
<tr><td><code id="ExcessGPD_+3A_sigma">sigma</code></td>
<td>

<p>Vector of <code class="reqn">n-1</code> estimates for <code class="reqn">\sigma</code> obtained from <code><a href="#topic+GPDmle">GPDmle</a></code>.
</p>
</td></tr>
<tr><td><code id="ExcessGPD_+3A_r">R</code></td>
<td>

<p>The retention level of the (re-)insurance.
</p>
</td></tr>
<tr><td><code id="ExcessGPD_+3A_l">L</code></td>
<td>

<p>The limit of the (re-)insurance, default is <code>Inf</code>.
</p>
</td></tr>
<tr><td><code id="ExcessGPD_+3A_warnings">warnings</code></td>
<td>

<p>Logical indicating if warnings are displayed, default is <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="ExcessGPD_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the estimates should be plotted as a function of <code class="reqn">k</code>, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="ExcessGPD_+3A_add">add</code></td>
<td>

<p>Logical indicating if the estimates should be added to an existing plot, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="ExcessGPD_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"Estimates for premium of excess-loss insurance"</code>.
</p>
</td></tr>
<tr><td><code id="ExcessGPD_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We need that <code class="reqn">u \ge X_{n-k,n}</code>, the <code class="reqn">(k+1)</code>-th largest observation.
If this is not the case, we return <code>NA</code> for the premium. A warning will be issued in
that case if <code>warnings=TRUE</code>. One should then use global fits: <code><a href="#topic+ExcessSplice">ExcessSplice</a></code>.
</p>
<p>The premium for the excess-loss insurance with retention <code class="reqn">R</code> and limit <code class="reqn">L</code> is given by
</p>
<p style="text-align: center;"><code class="reqn">E(\min{(X-R)_+, L}) = \Pi(R) - \Pi(R+L)</code>
</p>

<p>where <code class="reqn">\Pi(u)=E((X-u)_+)=\int_u^{\infty} (1-F(z)) dz</code> is the premium of the excess-loss insurance with retention <code class="reqn">u</code>. When <code class="reqn">L=\infty</code>, the premium is equal to <code class="reqn">\Pi(R)</code>.
</p>
<p>We estimate <code class="reqn">\Pi</code> by
</p>
<p style="text-align: center;"><code class="reqn"> \hat{\Pi}(u) = (k+1)/(n+1) \times \hat{\sigma}_k/ (1-\hat{\gamma}_k) \times (1+\hat{\gamma}_k/\hat{\sigma}_k (u-X_{n-k,n}))^{1-1/\hat{\gamma}_k},</code>
</p>

<p>with <code class="reqn">\hat{\gamma}_k</code> and <code class="reqn">\hat{\sigma}_k</code> the estimates for the parameters of the GPD.
</p>
<p>See Section 4.6 of Albrecher et al. (2017) for more details.
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>k</code></td>
<td>
<p>Vector of the values of the tail parameter <code class="reqn">k</code>.</p>
</td></tr>
<tr><td><code>premium</code></td>
<td>
<p>The corresponding estimates for the premium.</p>
</td></tr>
<tr><td><code>R</code></td>
<td>
<p>The retention level of the (re-)insurance.</p>
</td></tr>
<tr><td><code>L</code></td>
<td>
<p>The limit of the (re-)insurance.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens
</p>


<h3>References</h3>

<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+GPDmle">GPDmle</a></code>, <code><a href="#topic+ExcessHill">ExcessHill</a></code>, <code><a href="#topic+ExcessEPD">ExcessEPD</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(secura)

# GPDmle estimator
mle &lt;- GPDmle(secura$size)

# Premium of excess-loss insurance with retention R
R &lt;- 10^7
ExcessGPD(secura$size, gamma=mle$gamma, sigma=mle$sigma, R=R, ylim=c(0,2*10^4))
</code></pre>

<hr>
<h2 id='ExcessPareto'>
Estimates for excess-loss premiums using a Pareto model
</h2><span id='topic+ExcessPareto'></span><span id='topic+ExcessHill'></span>

<h3>Description</h3>

<p>Estimate premiums of excess-loss reinsurance with retention <code class="reqn">R</code> and limit <code class="reqn">L</code> using a (truncated) Pareto model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ExcessPareto(data, gamma, R, L = Inf, endpoint = Inf, warnings = TRUE, plot = TRUE, 
        add = FALSE, main = "Estimates for premium of excess-loss insurance", ...)
        
ExcessHill(data, gamma, R, L = Inf, endpoint = Inf, warnings = TRUE, plot = TRUE, 
        add = FALSE, main = "Estimates for premium of excess-loss insurance", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ExcessPareto_+3A_data">data</code></td>
<td>

<p>Vector of <code class="reqn">n</code> observations.  
</p>
</td></tr>
<tr><td><code id="ExcessPareto_+3A_gamma">gamma</code></td>
<td>

<p>Vector of <code class="reqn">n-1</code> estimates for the EVI, obtained from <code><a href="#topic+Hill">Hill</a></code> or <code><a href="#topic+trHill">trHill</a></code>.
</p>
</td></tr>
<tr><td><code id="ExcessPareto_+3A_r">R</code></td>
<td>

<p>The retention level of the (re-)insurance.
</p>
</td></tr>
<tr><td><code id="ExcessPareto_+3A_l">L</code></td>
<td>

<p>The limit of the (re-)insurance, default is <code>Inf</code>.
</p>
</td></tr>
<tr><td><code id="ExcessPareto_+3A_endpoint">endpoint</code></td>
<td>

<p>Endpoint for the truncated Pareto distribution. When <code>Inf</code>, the default, the ordinary Pareto model is used.
</p>
</td></tr>
<tr><td><code id="ExcessPareto_+3A_warnings">warnings</code></td>
<td>

<p>Logical indicating if warnings are displayed, default is <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="ExcessPareto_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the estimates should be plotted as a function of <code class="reqn">k</code>, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="ExcessPareto_+3A_add">add</code></td>
<td>

<p>Logical indicating if the estimates should be added to an existing plot, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="ExcessPareto_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"Estimates for premium of excess-loss insurance"</code>.
</p>
</td></tr>
<tr><td><code id="ExcessPareto_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We need that <code class="reqn">u \ge X_{n-k,n}</code>, the <code class="reqn">(k+1)</code>-th largest observation.
If this is not the case, we return <code>NA</code> for the premium. A warning will be issued in
that case if <code>warnings=TRUE</code>. One should then use global fits: <code><a href="#topic+ExcessSplice">ExcessSplice</a></code>.
</p>
<p>The premium for the excess-loss insurance with retention <code class="reqn">R</code> and limit <code class="reqn">L</code> is given by
</p>
<p style="text-align: center;"><code class="reqn">E(\min{(X-R)_+, L}) = \Pi(R) - \Pi(R+L)</code>
</p>

<p>where <code class="reqn">\Pi(u)=E((X-u)_+)=\int_u^{\infty} (1-F(z)) dz</code> is the premium of the excess-loss insurance with retention <code class="reqn">u</code>. When <code class="reqn">L=\infty</code>, the premium is equal to <code class="reqn">\Pi(R)</code>.
</p>
<p>We estimate <code class="reqn">\Pi</code> (for the untruncated Pareto distribution) by
</p>
<p style="text-align: center;"><code class="reqn"> \hat{\Pi}(u) = (k+1)/(n+1) / (1/H_{k,n}-1) \times (X_{n-k,n}^{1/H_{k,n}} u^{1-1/H_{k,n}}),</code>
</p>

<p>with <code class="reqn">H_{k,n}</code> the Hill estimator.
</p>
<p>The <code>ExcessHill</code> function is the same function but with a different name for compatibility with old versions of the package.
</p>
<p>See Section 4.6 of Albrecher et al. (2017) for more details.
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>k</code></td>
<td>
<p>Vector of the values of the tail parameter <code class="reqn">k</code>.</p>
</td></tr>
<tr><td><code>premium</code></td>
<td>
<p>The corresponding estimates for the premium.</p>
</td></tr>
<tr><td><code>R</code></td>
<td>
<p>The retention level of the (re-)insurance.</p>
</td></tr>
<tr><td><code>L</code></td>
<td>
<p>The limit of the (re-)insurance.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens
</p>


<h3>References</h3>

<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Hill">Hill</a></code>, <code><a href="#topic+ExcessEPD">ExcessEPD</a></code>, <code><a href="#topic+ExcessGPD">ExcessGPD</a></code>, <code><a href="#topic+ExcessSplice">ExcessSplice</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(secura)

# Hill estimator
H &lt;- Hill(secura$size)

# Premium of excess-loss insurance with retention R
R &lt;- 10^7
ExcessPareto(secura$size, H$gamma, R=R)
</code></pre>

<hr>
<h2 id='ExcessSplice'>
Estimates for excess-loss premiums using splicing
</h2><span id='topic+ExcessSplice'></span>

<h3>Description</h3>

<p>Estimate premiums of excess-loss reinsurance with retention <code class="reqn">R</code> and limit <code class="reqn">L</code> using fitted spliced distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ExcessSplice(R, L=Inf, splicefit)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ExcessSplice_+3A_r">R</code></td>
<td>

<p>The retention level of the (re-)insurance or a vector of retention levels for the (re-)insurance.
</p>
</td></tr>
<tr><td><code id="ExcessSplice_+3A_l">L</code></td>
<td>

<p>The limit for the (re-)insurance or a vector of limits for the (re-)insurance, default is <code>Inf</code>.
</p>
</td></tr>
<tr><td><code id="ExcessSplice_+3A_splicefit">splicefit</code></td>
<td>

<p>A <code><a href="#topic+SpliceFit">SpliceFit</a></code> object,  e.g. output from <code><a href="#topic+SpliceFitPareto">SpliceFitPareto</a></code>, <code><a href="#topic+SpliceFiticPareto">SpliceFiticPareto</a></code> or <code><a href="#topic+SpliceFitGPD">SpliceFitGPD</a></code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

 
<p>The premium for the excess-loss insurance with retention <code class="reqn">R</code> and limit <code class="reqn">L</code> is given by
</p>
<p style="text-align: center;"><code class="reqn">E(\min{(X-R)_+, L}) = \Pi(R) - \Pi(R+L)</code>
</p>

<p>where <code class="reqn">\Pi(u)=E((X-u)_+)=\int_u^{\infty} (1-F(z)) dz</code> is the premium of the excess-loss insurance with retention <code class="reqn">u</code>.  When <code class="reqn">L=\infty</code>, the premium is equal to <code class="reqn">\Pi(R)</code>.
</p>
<p>See Reynkens et al. (2017) and Section 4.6 of Albrecher et al. (2017) for more details.
</p>


<h3>Value</h3>

<p>An estimate for the premium is returned (for every value of <code>R</code>).
</p>


<h3>Author(s)</h3>

<p>Tom Reynkens with <code>R</code> code from Roel Verbelen for the estimates for the excess-loss premiums using the mixed Erlang distribution.
</p>


<h3>References</h3>

<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>
<p>Reynkens, T., Verbelen, R., Beirlant, J. and Antonio, K. (2017). &quot;Modelling Censored Losses Using Splicing:
a Global Fit Strategy With Mixed Erlang and Extreme Value Distributions&quot;. <em>Insurance: Mathematics and Economics</em>, 77, 65&ndash;77.
</p>
<p>Verbelen, R., Gong, L., Antonio, K., Badescu, A. and Lin, S. (2015). &quot;Fitting Mixtures of
Erlangs to Censored and Truncated Data Using the EM Algorithm.&quot; <em>Astin Bulletin</em>, 45, 729&ndash;758
</p>


<h3>See Also</h3>

<p><code><a href="#topic+SpliceFit">SpliceFit</a></code>, <code><a href="#topic+SpliceFitPareto">SpliceFitPareto</a></code>, <code><a href="#topic+SpliceFiticPareto">SpliceFiticPareto</a></code>,  <code><a href="#topic+SpliceFitGPD">SpliceFitGPD</a></code>  
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

# Pareto random sample
X &lt;- rpareto(1000, shape = 2)

# Splice ME and Pareto
splicefit &lt;- SpliceFitPareto(X, 0.8)

# Excess-loss premium 
ExcessSplice(R=2, splicefit=splicefit)

## End(Not run)
</code></pre>

<hr>
<h2 id='ExpQQ'>
Exponential quantile plot
</h2><span id='topic+ExpQQ'></span>

<h3>Description</h3>

<p>Computes the empirical quantiles of a data vector and the theoretical quantiles of the standard exponential distribution. These quantiles are then plotted in an exponential QQ-plot with the theoretical quantiles on the <code class="reqn">x</code>-axis and the empirical quantiles on the <code class="reqn">y</code>-axis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ExpQQ(data, plot = TRUE, main = "Exponential QQ-plot", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ExpQQ_+3A_data">data</code></td>
<td>

<p>Vector of <code class="reqn">n</code> observations. 
</p>
</td></tr>
<tr><td><code id="ExpQQ_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the quantiles should be plotted in an Exponential QQ-plot, default is <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="ExpQQ_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"Exponential QQ-plot"</code>.
</p>
</td></tr>
<tr><td><code id="ExpQQ_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The exponential QQ-plot is defined as
</p>
<p style="text-align: center;"><code class="reqn">( -\log(1-i/(n+1)), X_{i,n} )</code>
</p>

<p>for <code class="reqn">i=1,...,n,</code>
with <code class="reqn">X_{i,n}</code> the <code class="reqn">i</code>-th order statistic of the data.
</p>
<p>Note that the mean excess plot is the derivative plot of the Exponential QQ-plot.
</p>
<p>See Section 4.1 of Albrecher et al. (2017) for more details.
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>eqq.the</code></td>
<td>
<p>Vector of the theoretical quantiles from a standard exponential distribution.</p>
</td></tr>
<tr><td><code>eqq.emp</code></td>
<td>
<p>Vector of the empirical quantiles from the data.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens based on <code>S-Plus</code> code from Yuri Goegebeur.
</p>


<h3>References</h3>

<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>
<p>Beirlant J., Goegebeur Y., Segers, J. and Teugels, J. (2004). <em>Statistics of Extremes: Theory and Applications</em>, Wiley Series in Probability, Wiley, Chichester.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MeanExcess">MeanExcess</a></code>, <code><a href="#topic+LognormalQQ">LognormalQQ</a></code>, <code><a href="#topic+ParetoQQ">ParetoQQ</a></code>, <code><a href="#topic+WeibullQQ">WeibullQQ</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(norwegianfire)

# Exponential QQ-plot for Norwegian Fire Insurance data for claims in 1976.
ExpQQ(norwegianfire$size[norwegianfire$year==76])

# Pareto QQ-plot for Norwegian Fire Insurance data for claims in 1976.
ParetoQQ(norwegianfire$size[norwegianfire$year==76])
</code></pre>

<hr>
<h2 id='Extended+20Pareto'>
The Extended Pareto Distribution
</h2><span id='topic+depd'></span><span id='topic+pepd'></span><span id='topic+qepd'></span><span id='topic+repd'></span>

<h3>Description</h3>

<p>Density, distribution function, quantile function and random generation for the Extended Pareto Distribution (EPD).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>depd(x, gamma, kappa, tau = -1, log = FALSE)
pepd(x, gamma, kappa, tau = -1, lower.tail = TRUE, log.p = FALSE)
qepd(p, gamma, kappa, tau = -1, lower.tail = TRUE, log.p = FALSE)
repd(n, gamma, kappa, tau = -1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Extended+2B20Pareto_+3A_x">x</code></td>
<td>

<p>Vector of quantiles.
</p>
</td></tr>
<tr><td><code id="Extended+2B20Pareto_+3A_p">p</code></td>
<td>

<p>Vector of probabilities.
</p>
</td></tr>
<tr><td><code id="Extended+2B20Pareto_+3A_n">n</code></td>
<td>

<p>Number of observations.
</p>
</td></tr>
<tr><td><code id="Extended+2B20Pareto_+3A_gamma">gamma</code></td>
<td>

<p>The <code class="reqn">\gamma</code> parameter of the EPD, a strictly positive number.
</p>
</td></tr>
<tr><td><code id="Extended+2B20Pareto_+3A_kappa">kappa</code></td>
<td>

<p>The <code class="reqn">\kappa</code> parameter of the EPD. It should be larger than <code class="reqn">\max\{-1,1/\tau\}</code>.
</p>
</td></tr>
<tr><td><code id="Extended+2B20Pareto_+3A_tau">tau</code></td>
<td>

<p>The <code class="reqn">\tau</code> parameter of the EPD, a strictly negative number. Default is -1.
</p>
</td></tr>
<tr><td><code id="Extended+2B20Pareto_+3A_log">log</code></td>
<td>

<p>Logical indicating if the densities are given as <code class="reqn">\log(f)</code>, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="Extended+2B20Pareto_+3A_lower.tail">lower.tail</code></td>
<td>

<p>Logical indicating if the probabilities are of the form <code class="reqn">P(X\le x)</code> (<code>TRUE</code>) or <code class="reqn">P(X&gt;x)</code> (<code>FALSE</code>). Default is <code>TRUE.</code>
</p>
</td></tr>
<tr><td><code id="Extended+2B20Pareto_+3A_log.p">log.p</code></td>
<td>

<p>Logical indicating if the probabilities are given as <code class="reqn">\log(p)</code>, default is <code>FALSE</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Cumulative Distribution Function (CDF) of the EPD is equal to
<code class="reqn">F(x) = 1-(x(1+\kappa-\kappa x^{\tau}))^{-1/\gamma}</code> for all <code class="reqn">x &gt; 1</code> and <code class="reqn">F(x)=0</code> otherwise.
</p>
<p>Note that an EPD random variable with <code class="reqn">\tau=-1</code> and <code class="reqn">\kappa=\gamma/\sigma-1</code> is GPD distributed with <code class="reqn">\mu=1</code>, <code class="reqn">\gamma</code> and <code class="reqn">\sigma</code>.
</p>


<h3>Value</h3>

<p><code>depd</code> gives the density function evaluated in <code class="reqn">x</code>, <code>pepd</code> the CDF evaluated in <code class="reqn">x</code> and <code>qepd</code> the quantile function evaluated in <code class="reqn">p</code>. The length of the result is equal to the length of <code class="reqn">x</code> or <code class="reqn">p</code>.
</p>
<p><code>repd</code> returns a random sample of length <code class="reqn">n</code>.
</p>


<h3>Author(s)</h3>

<p>Tom Reynkens.
</p>


<h3>References</h3>

<p>Beirlant, J., Joossens, E. and Segers, J. (2009). &quot;Second-Order Refined Peaks-Over-Threshold
Modelling for Heavy-Tailed Distributions.&quot; <em>Journal of Statistical Planning and Inference</em>, 139, 2800&ndash;2815.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ppareto">Pareto</a></code>, <code><a href="#topic+pgpd">GPD</a></code>, <code><a href="stats.html#topic+Distributions">Distributions</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Plot of the PDF
x &lt;- seq(0, 10, 0.01)
plot(x, depd(x, gamma=1/2, kappa=1, tau=-1), xlab="x", ylab="PDF", type="l")

# Plot of the CDF
x &lt;- seq(0, 10, 0.01)
plot(x, pepd(x, gamma=1/2, kappa=1, tau=-1), xlab="x", ylab="CDF", type="l")
</code></pre>

<hr>
<h2 id='Frechet'>
The Frechet distribution
</h2><span id='topic+dfrechet'></span><span id='topic+pfrechet'></span><span id='topic+qfrechet'></span><span id='topic+rfrechet'></span>

<h3>Description</h3>

<p>Density, distribution function, quantile function and random generation for the Frchet distribution (inverse Weibull distribution).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dfrechet(x, shape, loc = 0, scale = 1, log = FALSE)
pfrechet(x, shape, loc = 0, scale = 1, lower.tail = TRUE, log.p = FALSE)
qfrechet(p, shape, loc = 0, scale = 1, lower.tail = TRUE, log.p = FALSE)
rfrechet(n, shape, loc = 0, scale = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Frechet_+3A_x">x</code></td>
<td>

<p>Vector of quantiles.
</p>
</td></tr>
<tr><td><code id="Frechet_+3A_p">p</code></td>
<td>

<p>Vector of probabilities.
</p>
</td></tr>
<tr><td><code id="Frechet_+3A_n">n</code></td>
<td>

<p>Number of observations.
</p>
</td></tr>
<tr><td><code id="Frechet_+3A_shape">shape</code></td>
<td>

<p>Shape parameter of the Frchet distribution.
</p>
</td></tr>
<tr><td><code id="Frechet_+3A_loc">loc</code></td>
<td>

<p>Location parameter of the Frchet distribution, default is 0.
</p>
</td></tr>
<tr><td><code id="Frechet_+3A_scale">scale</code></td>
<td>

<p>Scale parameter of the Frchet distribution, default is 1.
</p>
</td></tr>
<tr><td><code id="Frechet_+3A_log">log</code></td>
<td>

<p>Logical indicating if the densities are given as <code class="reqn">\log(f)</code>, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="Frechet_+3A_lower.tail">lower.tail</code></td>
<td>

<p>Logical indicating if the probabilities are of the form <code class="reqn">P(X\le x)</code> (<code>TRUE</code>) or <code class="reqn">P(X&gt;x)</code> (<code>FALSE</code>). Default is <code>TRUE.</code>
</p>
</td></tr>
<tr><td><code id="Frechet_+3A_log.p">log.p</code></td>
<td>

<p>Logical indicating if the probabilities are given as <code class="reqn">\log(p)</code>, default is <code>FALSE</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Cumulative Distribution Function (CDF) of the Frchet distribution is equal to
<code class="reqn">F(x) = \exp(-((x-loc)/scale)^{-shape})</code> for all <code class="reqn">x \ge loc</code> and <code class="reqn">F(x)=0</code> otherwise. Both <code>shape</code> and <code>scale</code> need to be strictly positive.
</p>


<h3>Value</h3>

<p><code>dfrechet</code> gives the density function evaluated in <code class="reqn">x</code>, <code>pfrechet</code> the CDF evaluated in <code class="reqn">x</code> and <code>qfrechet</code> the quantile function evaluated in <code class="reqn">p</code>. The length of the result is equal to the length of <code class="reqn">x</code> or <code class="reqn">p</code>.
</p>
<p><code>rfrechet</code> returns a random sample of length <code class="reqn">n</code>.
</p>


<h3>Author(s)</h3>

<p>Tom Reynkens.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ptfrechet">tFrchet</a></code>,  <code><a href="stats.html#topic+Distributions">Distributions</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Plot of the PDF
x &lt;- seq(1,10,0.01)
plot(x, dfrechet(x, shape=2), xlab="x", ylab="PDF", type="l")

# Plot of the CDF
x &lt;- seq(1,10,0.01)
plot(x, pfrechet(x, shape=2), xlab="x", ylab="CDF", type="l")

</code></pre>

<hr>
<h2 id='genHill'>
Generalised Hill estimator
</h2><span id='topic+genHill'></span>

<h3>Description</h3>

<p>Computes the generalised Hill estimator for real extreme value indices as a function of the tail parameter <code class="reqn">k</code>.
Optionally, these estimates are plotted as a function of <code class="reqn">k</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>genHill(data, gamma, logk = FALSE, plot = FALSE, add = FALSE, 
        main = "Generalised Hill estimates of the EVI", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="genHill_+3A_data">data</code></td>
<td>

<p>Vector of <code class="reqn">n</code> observations. 
</p>
</td></tr>
<tr><td><code id="genHill_+3A_gamma">gamma</code></td>
<td>

<p>Vector of <code class="reqn">n-1</code> estimates for the EVI, typically Hill estimates are used.
</p>
</td></tr>
<tr><td><code id="genHill_+3A_logk">logk</code></td>
<td>

<p>Logical indicating if the estimates are plotted as a function of <code class="reqn">\log(k)</code> (<code>logk=TRUE</code>) or as a function of <code class="reqn">k</code>. Default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="genHill_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the estimates should be plotted as a function of <code class="reqn">k</code>, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="genHill_+3A_add">add</code></td>
<td>

<p>Logical indicating if the estimates should be added to an existing plot, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="genHill_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"Generalised Hill estimates of the EVI"</code>.
</p>
</td></tr>
<tr><td><code id="genHill_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The generalised Hill estimator is an estimator for the slope of the <code class="reqn">k</code> last points of the generalised QQ-plot:
</p>
<p style="text-align: center;"><code class="reqn">\hat{\gamma}^{GH}_{k,n}=1/k\sum_{j=1}^k \log UH_{j,n}- \log UH_{k+1,n}</code>
</p>

<p>with <code class="reqn">UH_{j,n}=X_{n-j,n}H_{j,n}</code> the UH scores and <code class="reqn">H_{j,n}</code> the Hill estimates.
This is analogous to the (ordinary) Hill estimator which is the estimator of the slope of the <code class="reqn">k</code> last points of the Pareto QQ-plot when using constrained least squares. 
</p>
<p>See Section 4.2.2 of Albrecher et al. (2017) for more details.
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>k</code></td>
<td>
<p>Vector of the values of the tail parameter <code class="reqn">k</code>.</p>
</td></tr>
<tr><td><code>gamma</code></td>
<td>
<p>Vector of the corresponding generalised Hill estimates.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens based on <code>S-Plus</code> code from Yuri Goegebeur.
</p>


<h3>References</h3>

<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>
<p>Beirlant J., Goegebeur Y., Segers, J. and Teugels, J. (2004). <em>Statistics of Extremes: Theory and Applications</em>, Wiley Series in Probability, Wiley, Chichester.
</p>
<p>Beirlant, J., Vynckier, P. and Teugels, J.L. (1996). &quot;Excess Function and Estimation of the Extreme-value Index&quot;. <em>Bernoulli</em>, 2, 293&ndash;318.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Hill">Hill</a></code>, <code><a href="#topic+genQQ">genQQ</a></code>, <code><a href="#topic+Moment">Moment</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(soa)

# Hill estimator
H &lt;- Hill(soa$size, plot=FALSE)
# Moment estimator
M &lt;- Moment(soa$size)
# Generalised Hill estimator
gH &lt;- genHill(soa$size, gamma=H$gamma)

# Plot estimates
plot(H$k[1:5000], M$gamma[1:5000], xlab="k", ylab=expression(gamma), type="l", ylim=c(0.2,0.5))
lines(H$k[1:5000], gH$gamma[1:5000], lty=2)
legend("topright", c("Moment", "Generalised Hill"), lty=1:2)
</code></pre>

<hr>
<h2 id='genQQ'>
Generalised quantile plot
</h2><span id='topic+genQQ'></span><span id='topic+generalizedQQ'></span>

<h3>Description</h3>

<p>Computes the empirical quantiles of the UH scores of a data vector and the theoretical quantiles of the standard exponential distribution. These quantiles are then plotted in a generalised QQ-plot with the theoretical quantiles on the <code class="reqn">x</code>-axis and the empirical quantiles on the <code class="reqn">y</code>-axis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>genQQ(data, gamma, plot = TRUE, main = "Generalised QQ-plot", ...)

generalizedQQ(data, gamma, plot = TRUE, main = "Generalised QQ-plot", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="genQQ_+3A_data">data</code></td>
<td>

<p>Vector of <code class="reqn">n</code> observations. 
</p>
</td></tr>
<tr><td><code id="genQQ_+3A_gamma">gamma</code></td>
<td>

<p>Vector of <code class="reqn">n-1</code> estimates for the EVI, typically Hill estimates are used.
</p>
</td></tr>
<tr><td><code id="genQQ_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the quantiles should be plotted in a generalised QQ-plot, default is <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="genQQ_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"Generalised QQ-plot"</code>.
</p>
</td></tr>
<tr><td><code id="genQQ_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>generalizedQQ</code> function is the same function but with a different name for compatibility with the old <code>S-Plus</code> code. 
</p>
<p>The UH scores are defined as <code class="reqn">UH_{j,n}=X_{n-j,n}H_{j,n}</code> with <code class="reqn">H_{j,n}</code> the Hill estimates, but other positive estimates for the EVI can also be used. The appropriate positive estimates for the EVI need to be specified in <code>gamma</code>. The generalised QQ-plot then plots
</p>
<p style="text-align: center;"><code class="reqn">(\log((n+1)/(k+1)), \log(X_{n-k,n}H_{k,n}))</code>
</p>

<p>for <code class="reqn">k=1,\ldots,n-1</code>.
</p>
<p>See Section 4.2.2 of Albrecher et al. (2017) for more details.
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>gqq.the</code></td>
<td>
<p>Vector of the theoretical quantiles from a standard exponential distribution.</p>
</td></tr>
<tr><td><code>gqq.emp</code></td>
<td>
<p>Vector of the empirical quantiles from the logarithm of the UH scores.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens based on <code>S-Plus</code> code from Yuri Goegebeur.
</p>


<h3>References</h3>

<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>
<p>Beirlant J., Goegebeur Y., Segers, J. and Teugels, J. (2004). <em>Statistics of Extremes: Theory and Applications</em>, Wiley Series in Probability, Wiley, Chichester.
</p>
<p>Beirlant, J., Vynckier, P. and Teugels, J.L. (1996). &quot;Excess Function and Estimation of the Extreme-value Index.&quot; <em>Bernoulli</em>, 2, 293&ndash;318.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ParetoQQ">ParetoQQ</a></code>, <code><a href="#topic+Hill">Hill</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(soa)

# Compute Hill estimator
H &lt;- Hill(soa$size[1:5000], plot=FALSE)$gamma

# Generalised QQ-plot
genQQ(soa$size[1:5000], gamma=H)
</code></pre>

<hr>
<h2 id='GPD'>
The generalised Pareto distribution
</h2><span id='topic+dgpd'></span><span id='topic+pgpd'></span><span id='topic+qgpd'></span><span id='topic+rgpd'></span>

<h3>Description</h3>

<p>Density, distribution function, quantile function and random generation for the Generalised Pareto Distribution (GPD).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dgpd(x, gamma, mu = 0, sigma, log = FALSE)
pgpd(x, gamma, mu = 0, sigma, lower.tail = TRUE, log.p = FALSE)
qgpd(p, gamma, mu = 0, sigma, lower.tail = TRUE, log.p = FALSE)
rgpd(n, gamma, mu = 0, sigma)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GPD_+3A_x">x</code></td>
<td>

<p>Vector of quantiles.
</p>
</td></tr>
<tr><td><code id="GPD_+3A_p">p</code></td>
<td>

<p>Vector of probabilities.
</p>
</td></tr>
<tr><td><code id="GPD_+3A_n">n</code></td>
<td>

<p>Number of observations.
</p>
</td></tr>
<tr><td><code id="GPD_+3A_gamma">gamma</code></td>
<td>

<p>The <code class="reqn">\gamma</code> parameter of the GPD, a real number.
</p>
</td></tr>
<tr><td><code id="GPD_+3A_mu">mu</code></td>
<td>

<p>The <code class="reqn">\mu</code> parameter of the GPD, a strictly positive number. Default is 0.
</p>
</td></tr>
<tr><td><code id="GPD_+3A_sigma">sigma</code></td>
<td>

<p>The <code class="reqn">\sigma</code> parameter of the GPD, a strictly positive number.
</p>
</td></tr>
<tr><td><code id="GPD_+3A_log">log</code></td>
<td>

<p>Logical indicating if the densities are given as <code class="reqn">\log(f)</code>, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="GPD_+3A_lower.tail">lower.tail</code></td>
<td>

<p>Logical indicating if the probabilities are of the form <code class="reqn">P(X\le x)</code> (<code>TRUE</code>) or <code class="reqn">P(X&gt;x)</code> (<code>FALSE</code>). Default is <code>TRUE.</code>
</p>
</td></tr>
<tr><td><code id="GPD_+3A_log.p">log.p</code></td>
<td>

<p>Logical indicating if the probabilities are given as <code class="reqn">\log(p)</code>, default is <code>FALSE</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Cumulative Distribution Function (CDF) of the GPD for <code class="reqn">\gamma \neq 0</code> is equal to
<code class="reqn">F(x) = 1-(1+\gamma (x-\mu)/\sigma)^{-1/\gamma}</code> for all <code class="reqn">x \ge \mu</code> and <code class="reqn">F(x)=0</code> otherwise.
When <code class="reqn">\gamma=0</code>, the CDF is given by 
<code class="reqn">F(x) = 1-\exp((x-\mu)/\sigma)</code> for all <code class="reqn">x \ge \mu</code> and <code class="reqn">F(x)=0</code> otherwise.
</p>


<h3>Value</h3>

<p><code>dgpd</code> gives the density function evaluated in <code class="reqn">x</code>, <code>pgpd</code> the CDF evaluated in <code class="reqn">x</code> and <code>qgpd</code> the quantile function evaluated in <code class="reqn">p</code>. The length of the result is equal to the length of <code class="reqn">x</code> or <code class="reqn">p</code>.
</p>
<p><code>rgpd</code> returns a random sample of length <code class="reqn">n</code>.
</p>


<h3>Author(s)</h3>

<p>Tom Reynkens.
</p>


<h3>References</h3>

<p>Beirlant J., Goegebeur Y., Segers, J. and Teugels, J. (2004). <em>Statistics of Extremes: Theory and Applications</em>, Wiley Series in Probability, Wiley, Chichester.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ptgpd">tGPD</a></code>, <code><a href="#topic+ppareto">Pareto</a></code>, <code><a href="#topic+pepd">EPD</a></code>, <code><a href="stats.html#topic+Distributions">Distributions</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Plot of the PDF
x &lt;- seq(0, 10, 0.01)
plot(x, dgpd(x, gamma=1/2, sigma=5), xlab="x", ylab="PDF", type="l")

# Plot of the CDF
x &lt;- seq(0, 10, 0.01)
plot(x, pgpd(x, gamma=1/2, sigma=5), xlab="x", ylab="CDF", type="l")
</code></pre>

<hr>
<h2 id='GPDfit'>
Fit GPD using MLE
</h2><span id='topic+GPDfit'></span>

<h3>Description</h3>

<p>Fit the Generalised Pareto Distribution (GPD) to data using Maximum Likelihood Estimation (MLE).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GPDfit(data, start = c(0.1, 1), warnings = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GPDfit_+3A_data">data</code></td>
<td>

<p>Vector of <code class="reqn">n</code> observations. 
</p>
</td></tr>
<tr><td><code id="GPDfit_+3A_start">start</code></td>
<td>

<p>Vector of length 2 containing the starting values for the optimisation. The first element
is the starting value for the estimator of <code class="reqn">\gamma</code> and the second element is the starting value for the estimator of <code class="reqn">\sigma</code>. Default is <code>c(0.1,1)</code>.
</p>
</td></tr>
<tr><td><code id="GPDfit_+3A_warnings">warnings</code></td>
<td>

<p>Logical indicating if possible warnings from the optimisation function are shown, default is <code>FALSE</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See Section 4.2.2 in Albrecher et al. (2017) for more details.
</p>


<h3>Value</h3>

<p>A vector with the MLE estimate for the <code class="reqn">\gamma</code> parameter of the GPD as the first component and the MLE estimate for the <code class="reqn">\sigma</code> parameter of the GPD as the second component.
</p>


<h3>Author(s)</h3>

<p>Tom Reynkens based on <code>S-Plus</code> code from Yuri Goegebeur and <code>R</code> code from Klaus Herrmann.
</p>


<h3>References</h3>

<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>
<p>Beirlant J., Goegebeur Y., Segers, J. and Teugels, J. (2004). <em>Statistics of Extremes: Theory and Applications</em>, Wiley Series in Probability, Wiley, Chichester.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+GPDmle">GPDmle</a></code>, <code><a href="#topic+EPDfit">EPDfit</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(soa)

# Look at last 500 observations of SOA data
SOAdata &lt;- sort(soa$size)[length(soa$size)-(0:499)]

# Fit GPD to last 500 observations
res &lt;- GPDfit(SOAdata-sort(soa$size)[500])
</code></pre>

<hr>
<h2 id='GPDmle'>
GPD-ML estimator
</h2><span id='topic+GPDmle'></span><span id='topic+POT'></span>

<h3>Description</h3>

<p>Fit the Generalised Pareto Distribution (GPD) to the exceedances (peaks) over a threshold using Maximum Likelihood Estimation (MLE). Optionally, these estimates are plotted as a function of <code class="reqn">k</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GPDmle(data, start = c(0.1,1), warnings = FALSE, logk = FALSE, 
       plot = FALSE, add = FALSE, main = "POT estimates of the EVI", ...)

POT(data, start = c(0.1,1), warnings = FALSE, logk = FALSE, 
    plot = FALSE, add = FALSE, main = "POT estimates of the EVI", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GPDmle_+3A_data">data</code></td>
<td>

<p>Vector of <code class="reqn">n</code> observations. 
</p>
</td></tr>
<tr><td><code id="GPDmle_+3A_start">start</code></td>
<td>

<p>Vector of length 2 containing the starting values for the optimisation. The first element
is the starting value for the estimator of <code class="reqn">\gamma</code> and the second element is the starting value for the estimator of <code class="reqn">\sigma</code>. Default is <code>c(0.1,1)</code>.
</p>
</td></tr>
<tr><td><code id="GPDmle_+3A_warnings">warnings</code></td>
<td>

<p>Logical indicating if possible warnings from the optimisation function are shown, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="GPDmle_+3A_logk">logk</code></td>
<td>

<p>Logical indicating if the estimates are plotted as a function of <code class="reqn">\log(k)</code> (<code>logk=TRUE</code>) or as a function of <code class="reqn">k</code>. Default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="GPDmle_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the estimates of <code class="reqn">\gamma</code> should be plotted as a function of <code class="reqn">k</code>, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="GPDmle_+3A_add">add</code></td>
<td>

<p>Logical indicating if the estimates of <code class="reqn">\gamma</code> should be added to an existing plot, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="GPDmle_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"POT estimates of the EVI"</code>.
</p>
</td></tr>
<tr><td><code id="GPDmle_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>POT</code> function is the same function but with a different name for compatibility with the old <code>S-Plus</code> code. 
</p>
<p>For each value of <code>k</code>, we look at the exceedances over the <code class="reqn">(k+1)</code>th largest observation:
<code class="reqn">X_{n-k+j,n}-X_{n-k,n}</code> for <code class="reqn">j=1,...,k</code>, with <code class="reqn">X_{j,n}</code> the <code class="reqn">j</code>th largest observation and <code class="reqn">n</code> the sample size. The GPD is then fitted to these k exceedances using MLE which yields estimates for the parameters of the GPD: <code class="reqn">\gamma</code> and <code class="reqn">\sigma</code>.
</p>
<p>See Section 4.2.2 in Albrecher et al. (2017) for more details.
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>k</code></td>
<td>
<p>Vector of the values of the tail parameter <code class="reqn">k</code>.</p>
</td></tr>
<tr><td><code>gamma</code></td>
<td>
<p>Vector of the corresponding MLE estimates for the <code class="reqn">\gamma</code> parameter of the GPD.</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>Vector of the corresponding MLE estimates for the <code class="reqn">\sigma</code> parameter of the GPD.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens based on <code>S-Plus</code> code from Yuri Goegebeur and <code>R</code> code from Klaus Herrmann.
</p>


<h3>References</h3>

<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>
<p>Beirlant J., Goegebeur Y., Segers, J. and Teugels, J. (2004). <em>Statistics of Extremes: Theory and Applications</em>, Wiley Series in Probability, Wiley, Chichester.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+GPDfit">GPDfit</a></code>, <code><a href="#topic+GPDresiduals">GPDresiduals</a></code>, <code><a href="#topic+EPD">EPD</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(soa)

# Look at last 500 observations of SOA data
SOAdata &lt;- sort(soa$size)[length(soa$size)-(0:499)]

# Plot GPD-ML estimates as a function of k
GPDmle(SOAdata, plot=TRUE)
</code></pre>

<hr>
<h2 id='GPDresiduals'>
GPD residual plot
</h2><span id='topic+GPDresiduals'></span>

<h3>Description</h3>

<p>Residual plot to check GPD fit for peaks over a threshold.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GPDresiduals(data, t, gamma, sigma, plot = TRUE, 
             main = "GPD residual plot", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GPDresiduals_+3A_data">data</code></td>
<td>

<p>Vector of <code class="reqn">n</code> observations. 
</p>
</td></tr>
<tr><td><code id="GPDresiduals_+3A_t">t</code></td>
<td>

<p>The used threshold.
</p>
</td></tr>
<tr><td><code id="GPDresiduals_+3A_gamma">gamma</code></td>
<td>

<p>Estimate for the EVI obtained from <code>GPDmle</code>.
</p>
</td></tr>
<tr><td><code id="GPDresiduals_+3A_sigma">sigma</code></td>
<td>

<p>Estimate for <code class="reqn">\sigma</code> obtained from <code>GPDmle</code>.
</p>
</td></tr>
<tr><td><code id="GPDresiduals_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the residuals should be plotted, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="GPDresiduals_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"GPD residual plot"</code>.
</p>
</td></tr>
<tr><td><code id="GPDresiduals_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Consider the POT values <code class="reqn">Y=X-t</code> and the transformed variable
</p>
<p style="text-align: center;"><code class="reqn">R= 1/\gamma \log(1+\gamma/\sigma Y), </code>
</p>
<p> when <code class="reqn">\gamma \neq 0</code> and
</p>
<p style="text-align: center;"><code class="reqn">R = Y/\sigma,</code>
</p>

<p>otherwise. 
We can assess the goodness-of-fit of the GPD when modelling POT values <code class="reqn">Y=X-t</code> by 
constructing an exponential QQ-plot of the transformed variable <code class="reqn">R</code> since <code class="reqn">R</code> is standard exponentially distributed if <code class="reqn">Y</code> follows the GPD.
</p>
<p>See Section 4.2.2 in Albrecher et al. (2017) for more details.
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>res.the</code></td>
<td>
<p>Vector of the theoretical quantiles from a standard exponential distribution.</p>
</td></tr>
<tr><td><code>res.emp</code></td>
<td>
<p>Vector of the empirical quantiles of <code class="reqn">R</code>, see Details.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens
</p>


<h3>References</h3>

<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+GPDfit">GPDfit</a></code>, <code><a href="#topic+ExpQQ">ExpQQ</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(soa)

# Look at last 500 observations of SOA data
SOAdata &lt;- sort(soa$size)[length(soa$size)-(0:499)]

# Plot POT-MLE estimates as a function of k
pot &lt;- GPDmle(SOAdata, plot=TRUE)

# Residual plot
k &lt;- 200
GPDresiduals(SOAdata, sort(SOAdata)[length(SOAdata)-k], pot$gamma[k], pot$sigma[k])
</code></pre>

<hr>
<h2 id='Hill'>
Hill estimator
</h2><span id='topic+Hill'></span>

<h3>Description</h3>

<p>Computes the Hill estimator for positive extreme value indices (Hill, 1975) as a function of the tail parameter <code class="reqn">k</code>.
Optionally, these estimates are plotted as a function of <code class="reqn">k</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Hill(data, k = TRUE, logk = FALSE, plot = FALSE, add = FALSE, 
     main = "Hill estimates of the EVI", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Hill_+3A_data">data</code></td>
<td>

<p>Vector of <code class="reqn">n</code> observations.  
</p>
</td></tr>
<tr><td><code id="Hill_+3A_k">k</code></td>
<td>

<p>Logical indicating if the Hill estimates are plotted as a function of the tail parameter <code class="reqn">k</code> (<code>k=TRUE</code>) or as a function of <code class="reqn">\log(X_{n-k})</code>. Default is <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="Hill_+3A_logk">logk</code></td>
<td>

<p>Logical indicating if the Hill estimates are plotted as a function of <code class="reqn">\log(k)</code> (<code>logk=TRUE</code>) or as a function of <code class="reqn">k</code> (<code>logk=FALSE</code>) when <code>k=TRUE</code>. Default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="Hill_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the estimates should be plotted as a function of <code class="reqn">k</code>, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="Hill_+3A_add">add</code></td>
<td>

<p>Logical indicating if the estimates should be added to an existing plot, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="Hill_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"Hill estimates of the EVI"</code>.
</p>
</td></tr>
<tr><td><code id="Hill_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Hill estimator can be seen as the estimator of slope in the upper right corner (<code class="reqn">k</code> last points) of the Pareto QQ-plot when using constrained least squares (the regression line has to pass through the point <code class="reqn">(-\log((k+1)/(n+1)),\log X_{n-k})</code>). It is given by
</p>
<p style="text-align: center;"><code class="reqn">H_{k,n}=1/k\sum_{j=1}^k \log X_{n-j+1,n}- \log X_{n-k,n}.</code>
</p>

<p>See Section 4.2.1 of Albrecher et al. (2017) for more details.
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>k</code></td>
<td>
<p>Vector of the values of the tail parameter <code class="reqn">k</code>.</p>
</td></tr>
<tr><td><code>gamma</code></td>
<td>
<p>Vector of the corresponding Hill estimates.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens based on <code>S-Plus</code> code from Yuri Goegebeur.
</p>


<h3>References</h3>

<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>
<p>Beirlant J., Goegebeur Y., Segers, J. and Teugels, J. (2004). <em>Statistics of Extremes: Theory and Applications</em>, Wiley Series in Probability, Wiley, Chichester.
</p>
<p>Hill, B. M. (1975). &quot;A simple general approach to inference about the tail of a
distribution.&quot; <em>Annals of Statistics</em>, 3, 1163&ndash;1173.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ParetoQQ">ParetoQQ</a></code>, <code><a href="#topic+Hill.2oQV">Hill.2oQV</a></code>, <code><a href="#topic+genHill">genHill</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(norwegianfire)

# Plot Hill estimates as a function of k
Hill(norwegianfire$size[norwegianfire$year==76],plot=TRUE)
</code></pre>

<hr>
<h2 id='Hill.2oQV'>
Bias-reduced MLE (Quantile view)
</h2><span id='topic+Hill.2oQV'></span>

<h3>Description</h3>

<p>Computes bias-reduced ML estimates of gamma based on the quantile view.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Hill.2oQV(data, start = c(1,1,1), warnings = FALSE, logk = FALSE, 
          plot = FALSE, add = FALSE, main = "Estimates of the EVI", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Hill.2oQV_+3A_data">data</code></td>
<td>

<p>Vector of <code class="reqn">n</code> observations. 
</p>
</td></tr>
<tr><td><code id="Hill.2oQV_+3A_start">start</code></td>
<td>

<p>A vector of length 3 containing starting values for the first numerical optimisation (see Details). The elements
are the starting values for the estimators of <code class="reqn">\gamma</code>, <code class="reqn">\mu</code> and <code class="reqn">\sigma</code>, respectively. Default is <code>c(1,1,1)</code>.
</p>
</td></tr>
<tr><td><code id="Hill.2oQV_+3A_warnings">warnings</code></td>
<td>

<p>Logical indicating if possible warnings from the optimisation function are shown, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="Hill.2oQV_+3A_logk">logk</code></td>
<td>

<p>Logical indicating if the estimates are plotted as a function of <code class="reqn">\log(k)</code> (<code>logk=TRUE</code>) or as a function of <code class="reqn">k</code>. Default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="Hill.2oQV_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the estimates of <code class="reqn">\gamma</code> should be plotted as a function of <code class="reqn">k</code>, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="Hill.2oQV_+3A_add">add</code></td>
<td>

<p>Logical indicating if the estimates of <code class="reqn">\gamma</code> should be added to an existing plot, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="Hill.2oQV_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"Estimates of the EVI"</code>.
</p>
</td></tr>
<tr><td><code id="Hill.2oQV_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See Section 4.2.1 of Albrecher et al. (2017) for more details.
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>k</code></td>
<td>
<p>Vector of the values of the tail parameter <code class="reqn">k</code>.</p>
</td></tr>
<tr><td><code>gamma</code></td>
<td>
<p>Vector of the ML estimates for the EVI for each value of <code class="reqn">k</code>.</p>
</td></tr>
<tr><td><code>b</code></td>
<td>
<p>Vector of the ML estimates for the parameter <code class="reqn">b</code> in the regression model for each value of <code class="reqn">k</code>.</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>Vector of the ML estimates for the parameter <code class="reqn">\beta</code> in the regression model for each value of <code class="reqn">k</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens based on <code>S-Plus</code> code from Yuri Goegebeur and <code>R</code> code from Klaus Herrmann.
</p>


<h3>References</h3>

<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>
<p>Beirlant J., Dierckx, G., Goegebeur Y. and Matthys, G. (1999). &quot;Tail Index Estimation and an Exponential Regression Model.&quot; <em>Extremes</em>, 2, 177&ndash;200.
</p>
<p>Beirlant J., Goegebeur Y., Segers, J. and Teugels, J. (2004). <em>Statistics of Extremes: Theory and Applications</em>, Wiley Series in Probability, Wiley, Chichester.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(norwegianfire)

# Plot bias-reduced MLE (QV) as a function of k
Hill.2oQV(norwegianfire$size[norwegianfire$year==76],plot=TRUE)
</code></pre>

<hr>
<h2 id='Hill.kopt'>
Select optimal threshold for Hill estimator
</h2><span id='topic+Hill.kopt'></span>

<h3>Description</h3>

<p>Select optimal threshold for the Hill estimator by minimising the Asymptotic Mean Squared Error (AMSE). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Hill.kopt(data, start = c(1, 1, 1), warnings = FALSE, logk = FALSE, 
          plot = FALSE, add = FALSE, main = "AMSE plot", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Hill.kopt_+3A_data">data</code></td>
<td>

<p>Vector of <code class="reqn">n</code> observations. 
</p>
</td></tr>
<tr><td><code id="Hill.kopt_+3A_start">start</code></td>
<td>

<p>A vector of length 3 containing starting values for the first numerical optimisation (see <code><a href="#topic+Hill.2oQV">Hill.2oQV</a></code> for more details). Default is <code>c(1,1,1)</code>.
</p>
</td></tr>
<tr><td><code id="Hill.kopt_+3A_warnings">warnings</code></td>
<td>

<p>Logical indicating if possible warnings from the optimisation function are shown, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="Hill.kopt_+3A_logk">logk</code></td>
<td>

<p>Logical indicating if the AMSE values are plotted as a function of <code class="reqn">\log(k)</code> (<code>logk=TRUE</code>) or as a function of <code class="reqn">k</code>. Default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="Hill.kopt_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the AMSE values should be plotted as a function of <code class="reqn">k</code>, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="Hill.kopt_+3A_add">add</code></td>
<td>

<p>Logical indicating if the optimal value for <code class="reqn">k</code> should be added to an existing plot, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="Hill.kopt_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"AMSE plot"</code>.
</p>
</td></tr>
<tr><td><code id="Hill.kopt_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See Section 4.2.1 of Albrecher et al. (2017) for more details.
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>k</code></td>
<td>
<p>Vector of the values of the tail parameter <code class="reqn">k</code>.</p>
</td></tr>
<tr><td><code>AMSE</code></td>
<td>
<p>Vector of the AMSE values for each value of <code class="reqn">k</code>.</p>
</td></tr>
<tr><td><code>kopt</code></td>
<td>
<p>Optimal value of <code class="reqn">k</code> corresponding to minimal <code class="reqn">AMSE</code> value.</p>
</td></tr>
<tr><td><code>gammaopt</code></td>
<td>
<p>Optimal value of the Hill estimator corresponding to minimal <code class="reqn">AMSE</code> value.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens based on <code>S-Plus</code> code from Yuri Goegebeur.
</p>


<h3>References</h3>

<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>
<p>Beirlant J., Goegebeur Y., Segers, J. and Teugels, J. (2004). <em>Statistics of Extremes: Theory and Applications</em>, Wiley Series in Probability, Wiley, Chichester.
</p>
<p>Beirlant J., Vynckier, P. and Teugels, J. (1996). &quot;Tail Index Estimation, Pareto Quantile Plots, and Regression Diagnostics.&quot; <em>Journal of the American Statistical Association</em>, 91, 1659&ndash;1667.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Hill">Hill</a></code>, <code><a href="#topic+Hill.2oQV">Hill.2oQV</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(norwegianfire)

# Plot Hill estimator as a function of k
Hill(norwegianfire$size[norwegianfire$year==76],plot=TRUE)

# Add optimal value of k
Hill.kopt(norwegianfire$size[norwegianfire$year==76],add=TRUE)
</code></pre>

<hr>
<h2 id='icHill'>
Hill estimator for interval censored data
</h2><span id='topic+icHill'></span>

<h3>Description</h3>

<p>Computes the Hill estimator for positive extreme value indices, adapted for interval censoring, as a function of the tail parameter <code class="reqn">k</code>. Optionally, these estimates are plotted as a function of <code class="reqn">k</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>icHill(L, U, censored, trunclower = 0, truncupper = Inf, 
       logk = FALSE, plot = TRUE, add = FALSE, main = "Hill estimates of the EVI", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="icHill_+3A_l">L</code></td>
<td>

<p>Vector of length <code class="reqn">n</code> with the lower boundaries of the intervals for interval censored data or the observed data for right censored data.
</p>
</td></tr>
<tr><td><code id="icHill_+3A_u">U</code></td>
<td>

<p>Vector of length <code class="reqn">n</code> with the upper boundaries of the intervals.
</p>
</td></tr>
<tr><td><code id="icHill_+3A_censored">censored</code></td>
<td>

<p>A logical vector of length <code class="reqn">n</code> indicating if an observation is censored.
</p>
</td></tr>
<tr><td><code id="icHill_+3A_trunclower">trunclower</code></td>
<td>

<p>Lower truncation point. Default is 0.
</p>
</td></tr>
<tr><td><code id="icHill_+3A_truncupper">truncupper</code></td>
<td>

<p>Upper truncation point. Default is <code>Inf</code> (no upper truncation).
</p>
</td></tr>
<tr><td><code id="icHill_+3A_logk">logk</code></td>
<td>

<p>Logical indicating if the estimates are plotted as a function of <code class="reqn">\log(k)</code> (<code>logk=TRUE</code>) or as a function of <code class="reqn">k</code>. Default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="icHill_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the estimates of <code class="reqn">\gamma</code> should be plotted as a function of <code class="reqn">k</code>, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="icHill_+3A_add">add</code></td>
<td>

<p>Logical indicating if the estimates of <code class="reqn">\gamma</code> should be added to an existing plot, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="icHill_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"Hill estimates of the EVI"</code>.
</p>
</td></tr>
<tr><td><code id="icHill_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This estimator is given by 
</p>
<p style="text-align: center;"><code class="reqn">H^{TB}(x)=(\int_x^{\infty} (1-\hat{F}^{TB}(u))/u du)/(1-\hat{F}^{TB}(x)),</code>
</p>
 
<p>where <code class="reqn">\hat{F}^{TB}</code> is the Turnbull estimator for the CDF.
More specifically, we use the values <code class="reqn">x=\hat{Q}^{TB}(p)</code> for <code class="reqn">p=1/(n+1), \ldots, (n-1)/(n+1)</code> where
<code class="reqn">\hat{Q}^{TB}(p)</code> is the empirical quantile function corresponding to the Turnbull estimator.
We then denote </p>
<p style="text-align: center;"><code class="reqn">H^{TB}_{k,n}=H^{TB}(x_{n-k,n})</code>
</p>
<p> with </p>
<p style="text-align: center;"><code class="reqn">x_{n-k,n}=\hat{Q}^{TB}((n-k)/(n+1))=\hat{Q}^{TB}(1-(k+1)/(n+1)).</code>
</p>

<p>Right censored data should be entered as <code>L=l</code> and <code>U=truncupper</code>, and left censored data should be entered as <code>L=trunclower</code> and <code>U=u</code>. 
</p>
<p>If the <span class="pkg">interval</span> package is installed, the <code><a href="interval.html#topic+icfit">icfit</a></code> function is used to compute the Turnbull estimator. Otherwise, <code><a href="survival.html#topic+survfit.formula">survfit.formula</a></code> from <span class="pkg">survival</span> is used.
</p>
<p>Use <code><a href="#topic+Hill">Hill</a></code> for non-censored data or <code><a href="#topic+cHill">cHill</a></code> for right censored data. 
</p>
<p>See Section 4.3 in Albrecher et al. (2017) for more details.
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>k</code></td>
<td>
<p>Vector of the values of the tail parameter <code class="reqn">k</code>.</p>
</td></tr>
<tr><td><code>gamma</code></td>
<td>
<p>Vector of the corresponding Hill estimates.</p>
</td></tr>
<tr><td><code>X</code></td>
<td>
<p>Vector of thresholds <code class="reqn">x_{n-k,n}</code> used when estimating <code class="reqn">\gamma</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens
</p>


<h3>References</h3>

<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cHill">cHill</a></code>, <code><a href="#topic+Hill">Hill</a></code>, <code><a href="#topic+MeanExcess_TB">MeanExcess_TB</a></code>, <code><a href="#topic+icParetoQQ">icParetoQQ</a></code>, <code><a href="#topic+Turnbull">Turnbull</a></code>, <code><a href="interval.html#topic+icfit">icfit</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Pareto random sample
X &lt;- rpareto(500, shape=2)

# Censoring variable
Y &lt;- rpareto(500, shape=1)

# Observed sample
Z &lt;- pmin(X,Y)

# Censoring indicator
censored &lt;- (X&gt;Y)

# Right boundary
U &lt;- Z
U[censored] &lt;- Inf

# Hill estimator adapted for interval censoring
icHill(Z, U, censored, ylim=c(0,1))

# Hill estimator adapted for right censoring
cHill(Z, censored, lty=2, add=TRUE)

# True value of gamma
abline(h=1/2, lty=3, col="blue")

# Legend
legend("topright", c("icHill", "cHill"), lty=1:2)
</code></pre>

<hr>
<h2 id='icParetoQQ'>
Pareto quantile plot for interval censored data
</h2><span id='topic+icParetoQQ'></span>

<h3>Description</h3>

<p>Pareto QQ-plot adapted for interval censored data using the Turnbull estimator.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>icParetoQQ(L, U = L, censored, trunclower = 0, truncupper = Inf, 
           plot = TRUE, main = "Pareto QQ-plot", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="icParetoQQ_+3A_l">L</code></td>
<td>

<p>Vector of length <code class="reqn">n</code> with the lower boundaries of the intervals for interval censored data or the observed data for right censored data.
</p>
</td></tr>
<tr><td><code id="icParetoQQ_+3A_u">U</code></td>
<td>

<p>Vector of length <code class="reqn">n</code> with the upper boundaries of the intervals.
</p>
</td></tr>
<tr><td><code id="icParetoQQ_+3A_censored">censored</code></td>
<td>

<p>A logical vector of length <code class="reqn">n</code> indicating if an observation is censored.
</p>
</td></tr>
<tr><td><code id="icParetoQQ_+3A_trunclower">trunclower</code></td>
<td>

<p>Lower truncation point. Default is 0.
</p>
</td></tr>
<tr><td><code id="icParetoQQ_+3A_truncupper">truncupper</code></td>
<td>

<p>Upper truncation point. Default is <code>Inf</code> (no upper truncation).
</p>
</td></tr>
<tr><td><code id="icParetoQQ_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the quantiles should be plotted in a Pareto QQ-plot, default is <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="icParetoQQ_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"Pareto QQ-plot"</code>.
</p>
</td></tr>
<tr><td><code id="icParetoQQ_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Pareto QQ-plot adapted for interval censoring is given by
</p>
<p style="text-align: center;"><code class="reqn">( -\log(1-F^{TB}(x_{j,n})), \log x_{j,n} )</code>
</p>

<p>for <code class="reqn">j=1,\ldots,n-1,</code> where <code class="reqn">\hat{F}^{TB}</code> is the Turnbull estimator for the CDF and <code class="reqn">x_{i,n}=\hat{Q}^{TB}(i/(n+1))</code> with <code class="reqn">\hat{Q}^{TB}(p)</code> the empirical quantile function corresponding to the Turnbull estimator.
</p>
<p>Right censored data should be entered as <code>L=l</code> and <code>U=truncupper</code>, and left censored data should be entered as <code>L=trunclower</code> and <code>U=u</code>. 
</p>
<p>If the <span class="pkg">interval</span> package is installed, the <code><a href="interval.html#topic+icfit">icfit</a></code> function is used to compute the Turnbull estimator. Otherwise, <code><a href="survival.html#topic+survfit.formula">survfit.formula</a></code> from <span class="pkg">survival</span> is used.
</p>
<p>Use <code><a href="#topic+ParetoQQ">ParetoQQ</a></code> for non-censored data or <code><a href="#topic+cParetoQQ">cParetoQQ</a></code> for right censored data. 
</p>
<p>See Section 4.3 in Albrecher et al. (2017) for more details.
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>pqq.the</code></td>
<td>
<p>Vector of the theoretical quantiles, see Details.</p>
</td></tr>
<tr><td><code>pqq.emp</code></td>
<td>
<p>Vector of the empirical quantiles from the log-transformed data.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens
</p>


<h3>References</h3>

<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cParetoQQ">cParetoQQ</a></code>, <code><a href="#topic+ParetoQQ">ParetoQQ</a></code>, <code><a href="#topic+icHill">icHill</a></code>, <code><a href="#topic+Turnbull">Turnbull</a></code>, <code><a href="interval.html#topic+icfit">icfit</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Pareto random sample
X &lt;- rpareto(500, shape=2)

# Censoring variable
Y &lt;- rpareto(500, shape=1)

# Observed sample
Z &lt;- pmin(X,Y)

# Censoring indicator
censored &lt;- (X&gt;Y)

# Right boundary
U &lt;- Z
U[censored] &lt;- Inf

# Pareto QQ-plot adapted for interval censoring
icParetoQQ(Z, U, censored)

# Pareto QQ-plot adapted for right censoring
cParetoQQ(Z, censored)
</code></pre>

<hr>
<h2 id='KaplanMeier'>
Kaplan-Meier estimator
</h2><span id='topic+KaplanMeier'></span>

<h3>Description</h3>

<p>Computes the Kaplan-Meier estimator for the survival function of right censored data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>KaplanMeier(x, data, censored, conf.type="plain", conf.int = 0.95)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="KaplanMeier_+3A_x">x</code></td>
<td>

<p>Vector with points to evaluate the estimator in.
</p>
</td></tr>
<tr><td><code id="KaplanMeier_+3A_data">data</code></td>
<td>

<p>Vector of <code class="reqn">n</code> observations. 
</p>
</td></tr>
<tr><td><code id="KaplanMeier_+3A_censored">censored</code></td>
<td>

<p>Vector of <code class="reqn">n</code> logicals indicating if an observation is right censored. 
</p>
</td></tr>
<tr><td><code id="KaplanMeier_+3A_conf.type">conf.type</code></td>
<td>

<p>Type of confidence interval, see <code><a href="survival.html#topic+survfit.formula">survfit.formula</a></code>. Default is <code>"plain"</code>.
</p>
</td></tr>
<tr><td><code id="KaplanMeier_+3A_conf.int">conf.int</code></td>
<td>

<p>Confidence level of the two-sided confidence interval, see <code><a href="survival.html#topic+survfit.formula">survfit.formula</a></code>. Default is <code>0.95</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We consider the random right censoring model where one observes <code class="reqn">Z = \min(X,C)</code>
where <code class="reqn">X</code> is the variable of interest and <code class="reqn">C</code> is the censoring variable.
</p>
<p>This function is merely a wrapper for <code><a href="survival.html#topic+survfit.formula">survfit.formula</a></code> from <span class="pkg">survival</span>.
</p>
<p>This estimator is only suitable for right censored data. When the data are interval censored, one can use the Turnbull estimator implemented in <code><a href="#topic+Turnbull">Turnbull</a></code>.
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>surv</code></td>
<td>
<p>A vector of length <code>length(x)</code> containing the Kaplan-Meier estimator evaluated in the elements of <code>x</code>.</p>
</td></tr>
<tr><td><code>fit</code></td>
<td>
<p>The output from the call to <code><a href="survival.html#topic+survfit.formula">survfit.formula</a></code>, an object of class <code>survfit</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens
</p>


<h3>References</h3>

<p>Kaplan, E. L. and Meier, P. (1958). &quot;Nonparametric Estimation from Incomplete Observations.&quot; <em>Journal of the American Statistical Association</em>, 53, 457&ndash;481.
</p>


<h3>See Also</h3>

<p><code><a href="survival.html#topic+survfit.formula">survfit.formula</a></code>, <code><a href="#topic+Turnbull">Turnbull</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- c(1, 2.5, 3, 4, 5.5, 6, 7.5, 8.25, 9, 10.5)
censored &lt;- c(0, 1, 0, 0, 1, 0, 1, 1, 0, 1)

x &lt;- seq(0, 12, 0.1)

# Kaplan-Meier estimator
plot(x, KaplanMeier(x, data, censored)$surv, type="s", ylab="Kaplan-Meier estimator")
</code></pre>

<hr>
<h2 id='LognormalQQ'>
Log-normal quantile plot 
</h2><span id='topic+LognormalQQ'></span>

<h3>Description</h3>

<p>Computes the empirical quantiles of the log-transform of a data vector and the theoretical quantiles of the standard normal distribution. These quantiles are then plotted in a log-normal QQ-plot with the theoretical quantiles on the <code class="reqn">x</code>-axis and the empirical quantiles on the <code class="reqn">y</code>-axis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LognormalQQ(data, plot = TRUE, main = "Log-normal QQ-plot", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="LognormalQQ_+3A_data">data</code></td>
<td>

<p>Vector of <code class="reqn">n</code> observations. 
</p>
</td></tr>
<tr><td><code id="LognormalQQ_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the quantiles should be plotted in a log-normal QQ-plot, default is <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="LognormalQQ_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"Log-normal QQ-plot"</code>.
</p>
</td></tr>
<tr><td><code id="LognormalQQ_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>By definition, a log-transformed log-normal random variable is normally distributed.
We can thus obtain a log-normal QQ-plot from a normal QQ-plot by replacing the empirical quantiles of the data vector by the empirical quantiles from the log-transformed data. We hence plot
</p>
<p style="text-align: center;"><code class="reqn">(\Phi^{-1}(i/(n+1)), \log(X_{i,n}) )</code>
</p>
<p> for <code class="reqn">i=1,\ldots,n,</code> where <code class="reqn">\Phi</code> is the standard normal CDF.
</p>
<p>See Section 4.1 of Albrecher et al. (2017) for more details.
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>lnqq.the</code></td>
<td>
<p>Vector of the theoretical quantiles from a standard normal distribution.</p>
</td></tr>
<tr><td><code>lnqq.emp</code></td>
<td>
<p>Vector of the empirical quantiles from the log-transformed data.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens.
</p>


<h3>References</h3>

<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>
<p>Beirlant J., Goegebeur Y., Segers, J. and Teugels, J. (2004). <em>Statistics of Extremes: Theory and Applications</em>, Wiley Series in Probability, Wiley, Chichester.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ExpQQ">ExpQQ</a></code>, <code><a href="#topic+ParetoQQ">ParetoQQ</a></code>, <code><a href="#topic+WeibullQQ">WeibullQQ</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(norwegianfire)

# Log-normal QQ-plot for Norwegian Fire Insurance data for claims in 1976.
LognormalQQ(norwegianfire$size[norwegianfire$year==76])


</code></pre>

<hr>
<h2 id='LognormalQQ_der'>
Derivative plot of the log-normal QQ-plot
</h2><span id='topic+LognormalQQ_der'></span>

<h3>Description</h3>

<p>Computes the derivative plot of the log-normal QQ-plot. These values can be plotted as a function of the data or as a function of the tail parameter <code class="reqn">k</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LognormalQQ_der(data, k = FALSE, plot = TRUE, 
                main = "Derivative plot of log-normal QQ-plot", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="LognormalQQ_der_+3A_data">data</code></td>
<td>

<p>Vector of <code class="reqn">n</code> observations. 
</p>
</td></tr>
<tr><td><code id="LognormalQQ_der_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the derivative values should be plotted, default is <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="LognormalQQ_der_+3A_k">k</code></td>
<td>

<p>Logical indicating if the derivative values are plotted as a function of the tail parameter <code class="reqn">k</code> (<code>k=TRUE</code>) or as a function of the logarithm of the data (<code>k=FALSE</code>). Default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="LognormalQQ_der_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"Derivative plot of log-normal QQ-plot"</code>.
</p>
</td></tr>
<tr><td><code id="LognormalQQ_der_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The derivative plot of a log-normal QQ-plot is </p>
<p style="text-align: center;"><code class="reqn">(k, H_{k,n}/N_{k,n})</code>
</p>
<p> or </p>
<p style="text-align: center;"><code class="reqn">(\log X_{n-k,n}, H_{k,n}/N_{k,n})</code>
</p>
<p> with <code class="reqn">H_{k,n}</code> the Hill estimates and </p>
<p style="text-align: center;"><code class="reqn">N_{k,n} = (n+1)/(k+1) \phi(\Phi^{-1}(a)) - \Phi^{-1}(a).</code>
</p>
<p> Here is <code class="reqn">a=1-(k+1)/(n+1)</code>, <code class="reqn">\phi</code> the standard normal PDF and <code class="reqn">\Phi</code> the standard normal CDF.
</p>
<p>See Section 4.1 of Albrecher et al. (2017) for more details.
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>xval</code></td>
<td>
<p>Vector of the x-values of the plot (<code class="reqn">k</code> or <code class="reqn">\log X_{n-k,n}</code>).</p>
</td></tr>
<tr><td><code>yval</code></td>
<td>
<p>Vector of the derivative values.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens.
</p>


<h3>References</h3>

<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+LognormalQQ">LognormalQQ</a></code>, <code><a href="#topic+Hill">Hill</a></code>, <code><a href="#topic+MeanExcess">MeanExcess</a></code>, <code><a href="#topic+ParetoQQ_der">ParetoQQ_der</a></code>, <code><a href="#topic+WeibullQQ_der">WeibullQQ_der</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(norwegianfire)

# Log-normal QQ-plot for Norwegian Fire Insurance data for claims in 1976.
LognormalQQ(norwegianfire$size[norwegianfire$year==76])

# Derivate plot
LognormalQQ_der(norwegianfire$size[norwegianfire$year==76])
</code></pre>

<hr>
<h2 id='LStail'>
Least Squares tail estimator
</h2><span id='topic+LStail'></span><span id='topic+TSfraction'></span>

<h3>Description</h3>

<p>Computes the Least Squares (LS) estimates of the EVI based on the last <code class="reqn">k</code> observations of the generalised QQ-plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LStail(data, rho = -1, lambda = 0.5, logk = FALSE, plot = FALSE, add = FALSE, 
       main = "LS estimates of the EVI", ...)
            
TSfraction(data, rho = -1, lambda = 0.5, logk = FALSE, plot = FALSE, add = FALSE, 
           main = "LS estimates of the EVI", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="LStail_+3A_data">data</code></td>
<td>

<p>Vector of <code class="reqn">n</code> observations. 
</p>
</td></tr>
<tr><td><code id="LStail_+3A_rho">rho</code></td>
<td>

<p>Estimate for <code class="reqn">\rho</code>, or <code>NULL</code> when <code class="reqn">\rho</code> needs to be estimated using the method of Beirlant et al. (2002). Default is <code>-1</code>. 
</p>
</td></tr>
<tr><td><code id="LStail_+3A_lambda">lambda</code></td>
<td>

<p>Parameter used in the method of Beirlant et al. (2002), only used when <code>rho=NULL</code>. Default is <code>0.5</code>.
</p>
</td></tr>
<tr><td><code id="LStail_+3A_logk">logk</code></td>
<td>

<p>Logical indicating if the estimates are plotted as a function of <code class="reqn">\log(k)</code> (<code>logk=TRUE</code>) or as a function of <code class="reqn">k</code>. Default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="LStail_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the estimates of <code class="reqn">\gamma</code> should be plotted as a function of <code class="reqn">k</code>, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="LStail_+3A_add">add</code></td>
<td>

<p>Logical indicating if the estimates of <code class="reqn">\gamma</code> should be added to an existing plot, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="LStail_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"LS estimates of the EVI"</code>.
</p>
</td></tr>
<tr><td><code id="LStail_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We estimate <code class="reqn">\gamma</code> (EVI) and <code class="reqn">b</code> using least squares on the following regression model (Beirlant et al., 2005): <code class="reqn">Z_j = \gamma + b(n/k) (j/k)^{-\rho} + \epsilon_j</code> with <code class="reqn">Z_j = (j+1) \log(UH_{j,n}/UH_{j+1,n})</code> and <code class="reqn">UH_{j,n}=X_{n-j,n}H_{j,n}</code>, where <code class="reqn">H_{j,n}</code> is the Hill estimator with threshold <code class="reqn">X_{n-j,n}</code>.
</p>
<p>See Section 5.8 of Beirlant et al. (2004) for more details.
</p>
<p>The function <code>TSfraction</code> is included for compatibility with the old <code>S-Plus</code> code.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>k</code></td>
<td>
<p>Vector of the values of the tail parameter <code class="reqn">k</code>.</p>
</td></tr>
<tr><td><code>gamma</code></td>
<td>
<p>Vector of the corresponding LS estimates for the EVI.</p>
</td></tr>
<tr><td><code>b</code></td>
<td>
<p>Vector of the corresponding LS estimates for b.</p>
</td></tr>
<tr><td><code>rho</code></td>
<td>
<p>Vector of the estimates for <code class="reqn">\rho</code> when <code>rho=NULL</code> or the given input for <code>rho</code> otherwise.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens based on <code>S-Plus</code> code from Yuri Goegebeur.
</p>


<h3>References</h3>

<p>Beirlant, J., Dierckx, G. and Guillou, A. (2005). &quot;Estimation of the Extreme Value Index and Regression on Generalized Quantile Plots.&quot; <em>Bernoulli</em>, 11, 949&ndash;970.
</p>
<p>Beirlant, J., Dierckx, G., Guillou, A. and Starica, C. (2002). &quot;On Exponential Representations of Log-spacing of Extreme Order Statistics.&quot; <em>Extremes</em>, 5, 157&ndash;180.
</p>
<p>Beirlant J., Goegebeur Y., Segers, J. and Teugels, J. (2004). <em>Statistics of Extremes: Theory and Applications</em>, Wiley Series in Probability, Wiley, Chichester.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+genQQ">genQQ</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(soa)

# LS tail estimator
LStail(soa$size, plot=TRUE, ylim=c(0,0.5))
</code></pre>

<hr>
<h2 id='MeanExcess'>
Mean excess function
</h2><span id='topic+MeanExcess'></span>

<h3>Description</h3>

<p>Computes the mean excess values for a vector of observations. These mean excess values can then be plotted as a function of the data or as a function of the tail parameter <code class="reqn">k</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MeanExcess(data, plot = TRUE, k = FALSE, main = "Mean excess plot", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MeanExcess_+3A_data">data</code></td>
<td>

<p>Vector of <code class="reqn">n</code> observations. 
</p>
</td></tr>
<tr><td><code id="MeanExcess_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the mean excess values should be plotted in a mean excess plot, default is <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="MeanExcess_+3A_k">k</code></td>
<td>

<p>Logical indicating if the mean excess scores are plotted as a function of the tail parameter <code class="reqn">k</code> (<code>k=TRUE</code>) or as a function of the data (<code>k=FALSE</code>). Default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="MeanExcess_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"Mean excess plot"</code>.
</p>
</td></tr>
<tr><td><code id="MeanExcess_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The mean excess plot is </p>
<p style="text-align: center;"><code class="reqn">(k,e_{k,n})</code>
</p>
<p> or </p>
<p style="text-align: center;"><code class="reqn">(X_{n-k,n}, e_{k,n})</code>
</p>

<p>with </p>
<p style="text-align: center;"><code class="reqn">e_{k,n}=1/k\sum_{j=1}^k X_{n-j+1,n}-X_{n-k,n}.</code>
</p>

<p>Note that the mean excess plot is the derivative plot of the Exponential QQ-plot.
</p>
<p>See Section 4.1 of Albrecher et al. (2017) for more details. 
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>k</code></td>
<td>
<p>Vector of the values of the tail parameter <code>k</code>.</p>
</td></tr>
<tr><td><code>X</code></td>
<td>
<p>Vector of the order statistics <code>data[n-k]</code> corresponding to the tail parameters in <code>k</code>.</p>
</td></tr>
<tr><td><code>e</code></td>
<td>
<p>Vector of the mean excess values corresponding to the tail parameters in <code>k</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens based on <code>S-Plus</code> code from Yuri Goegebeur.
</p>


<h3>References</h3>

<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>
<p>Beirlant J., Goegebeur Y., Segers, J. and Teugels, J. (2004). <em>Statistics of Extremes: Theory and Applications</em>, Wiley Series in Probability, Wiley, Chichester.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ExpQQ">ExpQQ</a></code>, <code><a href="#topic+LognormalQQ_der">LognormalQQ_der</a></code>, <code><a href="#topic+ParetoQQ_der">ParetoQQ_der</a></code>, <code><a href="#topic+WeibullQQ_der">WeibullQQ_der</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(norwegianfire)

# Mean excess plots for Norwegian Fire Insurance data for claims in 1976.

# Mean excess values as a function of k
MeanExcess(norwegianfire$size[norwegianfire$year==76], k=TRUE)

# Mean excess values as a function of the data
MeanExcess(norwegianfire$size[norwegianfire$year==76], k=FALSE)

</code></pre>

<hr>
<h2 id='MeanExcess_TB'>
Mean excess function using Turnbull estimator
</h2><span id='topic+MeanExcess_TB'></span>

<h3>Description</h3>

<p>Computes mean excess values using the Turnbull estimator. These mean excess values can then be plotted as a function of the empirical quantiles (computed using the Turnbull estimator) or as a function of the tail parameter <code class="reqn">k</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MeanExcess_TB(L, U = L, censored, trunclower = 0, truncupper = Inf, 
              plot = TRUE, k = FALSE, intervalpkg = TRUE, 
              main = "Mean excess plot", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MeanExcess_TB_+3A_l">L</code></td>
<td>

<p>Vector of length <code class="reqn">n</code> with the lower boundaries of the intervals for interval censored data or the observed data for right censored data.
</p>
</td></tr>
<tr><td><code id="MeanExcess_TB_+3A_u">U</code></td>
<td>

<p>Vector of length <code class="reqn">n</code> with the upper boundaries of the intervals. By default, they are equal to <code>L</code>.
</p>
</td></tr>
<tr><td><code id="MeanExcess_TB_+3A_censored">censored</code></td>
<td>

<p>A logical vector of length <code class="reqn">n</code> indicating if an observation is censored.
</p>
</td></tr>
<tr><td><code id="MeanExcess_TB_+3A_trunclower">trunclower</code></td>
<td>

<p>Lower truncation point, default is 0.
</p>
</td></tr>
<tr><td><code id="MeanExcess_TB_+3A_truncupper">truncupper</code></td>
<td>

<p>Upper truncation point, default is <code>Inf</code>.
</p>
</td></tr>
<tr><td><code id="MeanExcess_TB_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the mean excess values should be plotted in a mean excess plot, default is <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="MeanExcess_TB_+3A_k">k</code></td>
<td>

<p>Logical indicating if the mean excess values are plotted as a function of the tail parameter <code class="reqn">k</code> (<code>k=TRUE</code>) or as a function of the empirical quantiles computed using the Turnbull estimator (<code>k=FALSE</code>). Default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="MeanExcess_TB_+3A_intervalpkg">intervalpkg</code></td>
<td>

<p>Logical indicating if the Turnbull estimator is computed using the implementation in the <span class="pkg">interval</span> package if this package is installed. Default is <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="MeanExcess_TB_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"Mean excess plot"</code>.
</p>
</td></tr>
<tr><td><code id="MeanExcess_TB_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The mean excess values are given by
</p>
<p style="text-align: center;"><code class="reqn">\hat{e}^{TB}(v)=(\int_v^{\infty} 1-\hat{F}^{TB}(u) du)/(1-\hat{F}^{TB}(v))</code>
</p>

<p>where <code class="reqn">\hat{F}^{TB}</code> is the Turnbull estimator for the CDF.
More specifically, we use the values <code class="reqn">v=\hat{Q}^{TB}(p)</code> for <code class="reqn">p=1/(n+1), \ldots, (n-1)/(n+1)</code> where
<code class="reqn">\hat{Q}^{TB}(p)</code> is the empirical quantile function corresponding to the Turnbull estimator.
</p>
<p>Right censored data should be entered as <code>L=l</code> and <code>U=truncupper</code>, and left censored data should be entered as <code>L=trunclower</code> and <code>U=u</code>. 
</p>
<p>If the <span class="pkg">interval</span> package is installed and <code>intervalpkg=TRUE</code>, the <code><a href="interval.html#topic+icfit">icfit</a></code> function is used to compute the Turnbull estimator. Otherwise, <code><a href="survival.html#topic+survfit.formula">survfit.formula</a></code> from <span class="pkg">survival</span> is used.
</p>
<p>Use <code><a href="#topic+MeanExcess">MeanExcess</a></code> for non-censored data. 
</p>
<p>See Section 4.3 in Albrecher et al. (2017) for more details.
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>k</code></td>
<td>
<p>Vector of the values of the tail parameter <code>k</code>.</p>
</td></tr>
<tr><td><code>X</code></td>
<td>
<p>Vector of the empirical quantiles, computed using the Turnbull estimator, corresponding to <code>(n-k)/(n+1)=1-(k+1)/(n+1)</code>.</p>
</td></tr>
<tr><td><code>e</code></td>
<td>
<p>Vector of the mean excess values corresponding to the tail parameters in <code>k</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens
</p>


<h3>References</h3>

<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MeanExcess">MeanExcess</a></code>, <code><a href="#topic+Turnbull">Turnbull</a></code>, <code><a href="interval.html#topic+icfit">icfit</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Pareto random sample
X &lt;- rpareto(500, shape=2)

# Censoring variable
Y &lt;- rpareto(500, shape=1)

# Observed sample
Z &lt;- pmin(X, Y)

# Censoring indicator
censored &lt;- (X&gt;Y)

# Right boundary
U &lt;- Z
U[censored] &lt;- Inf

# Mean excess plot
MeanExcess_TB(Z, U, censored, k=FALSE)
</code></pre>

<hr>
<h2 id='MEfit'>
Mixed Erlang fit
</h2><span id='topic+MEfit'></span>

<h3>Description</h3>

<p>Create an S3 object using a Mixed Erlang (ME) fit.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MEfit(p, shape, theta, M, M_initial = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MEfit_+3A_p">p</code></td>
<td>

<p>Vector of mixing weights, denoted by <code class="reqn">\alpha</code> in Verbelen et al. (2015).
</p>
</td></tr>
<tr><td><code id="MEfit_+3A_shape">shape</code></td>
<td>

<p>Vector of shape parameters <code class="reqn">r</code>.
</p>
</td></tr>
<tr><td><code id="MEfit_+3A_theta">theta</code></td>
<td>

<p>Scale parameter <code class="reqn">\theta</code>.
</p>
</td></tr>
<tr><td><code id="MEfit_+3A_m">M</code></td>
<td>

<p>Number of mixture components.
</p>
</td></tr>
<tr><td><code id="MEfit_+3A_m_initial">M_initial</code></td>
<td>

<p>Initial value provided for <code>M</code>. When <code>NULL</code> (default), not included in the object.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The rate parameter <code class="reqn">\lambda</code> used in Albrecher et al. (2017) is equal to <code class="reqn">1/\theta</code>.
</p>
<p>See Reynkens et al. (2017) and Section 4.3 of Albrecher et al. (2017) for more details
</p>


<h3>Value</h3>

<p>An S3 object which contains the input arguments in a list.
</p>


<h3>Author(s)</h3>

<p>Tom Reynkens
</p>


<h3>References</h3>

<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>
<p>Reynkens, T., Verbelen, R., Beirlant, J. and Antonio, K. (2017). &quot;Modelling Censored Losses Using Splicing:
a Global Fit Strategy With Mixed Erlang and Extreme Value Distributions&quot;. <em>Insurance: Mathematics and Economics</em>, 77, 65&ndash;77.
</p>
<p>Verbelen, R., Gong, L., Antonio, K., Badescu, A. and Lin, S. (2015). &quot;Fitting Mixtures of
Erlangs to Censored and Truncated Data Using the EM Algorithm.&quot; <em>Astin Bulletin</em>, 45, 729&ndash;758
</p>


<h3>See Also</h3>

<p><code><a href="#topic+SpliceFit">SpliceFit</a></code>, <code><a href="#topic+SpliceFitPareto">SpliceFitPareto</a></code>, <code><a href="#topic+SpliceFiticPareto">SpliceFiticPareto</a></code>, <code><a href="#topic+SpliceFitGPD">SpliceFitGPD</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Create MEfit object
mefit &lt;- MEfit(p=c(0.65,0.35), shape=c(39,58), theta=16.19, M=2)

# Create EVTfit object
evtfit &lt;- EVTfit(gamma=c(0.76,0.64), endpoint=c(39096, Inf))

# Create SpliceFit object
splicefit &lt;- SpliceFit(const=c(0.5,0.996), trunclower=0, t=c(1020,39096), type=c("ME","TPa","Pa"),
                       MEfit=mefit, EVTfit=evtfit)

# Show summary
summary(splicefit)
</code></pre>

<hr>
<h2 id='Moment'>
Moment estimator
</h2><span id='topic+Moment'></span>

<h3>Description</h3>

<p>Compute the moment estimates for real extreme value indices as a function of the tail parameter <code class="reqn">k</code>. Optionally, these estimates are plotted as a function of <code class="reqn">k</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Moment(data, logk = FALSE, plot = FALSE, add = FALSE, 
       main = "Moment estimates of the EVI", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Moment_+3A_data">data</code></td>
<td>

<p>Vector of <code class="reqn">n</code> observations. 
</p>
</td></tr>
<tr><td><code id="Moment_+3A_logk">logk</code></td>
<td>

<p>Logical indicating if the estimates are plotted as a function of <code class="reqn">\log(k)</code> (<code>logk=TRUE</code>) or as a function of <code class="reqn">k</code>. Default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="Moment_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the estimates should be plotted as a function of <code class="reqn">k</code>, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="Moment_+3A_add">add</code></td>
<td>

<p>Logical indicating if the estimates should be added to an existing plot, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="Moment_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"Moment estimates of the EVI"</code>.
</p>
</td></tr>
<tr><td><code id="Moment_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The moment estimator for the EVI is introduced by Dekkers et al. (1989) and is a generalisation of the Hill estimator. 
</p>
<p>See Section 4.2.2 of Albrecher et al. (2017) for more details.
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>k</code></td>
<td>
<p>Vector of the values of the tail parameter <code class="reqn">k</code>.</p>
</td></tr>
<tr><td><code>gamma</code></td>
<td>
<p>Vector of the corresponding moment estimates.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens based on <code>S-Plus</code> code from Yuri Goegebeur.
</p>


<h3>References</h3>

<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>
<p>Beirlant J., Goegebeur Y., Segers, J. and Teugels, J. (2004). <em>Statistics of Extremes: Theory and Applications</em>, Wiley Series in Probability, Wiley, Chichester.
</p>
<p>Dekkers, A.L.M, Einmahl, J.H.J. and de Haan, L. (1989). &quot;A Moment Estimator for the Index of an Extreme-value Distribution.&quot; <em>Annals of Statistics</em>, 17, 1833&ndash;1855.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Hill">Hill</a></code>, <code><a href="#topic+genHill">genHill</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(soa)

# Hill estimator
H &lt;- Hill(soa$size, plot=FALSE)
# Moment estimator
M &lt;- Moment(soa$size)
# Generalised Hill estimator
gH &lt;- genHill(soa$size, gamma=H$gamma)

# Plot estimates
plot(H$k[1:5000], M$gamma[1:5000], xlab="k", ylab=expression(gamma), type="l", ylim=c(0.2,0.5))
lines(H$k[1:5000], gH$gamma[1:5000], lty=2)
legend("topright", c("Moment", "Generalised Hill"), lty=1:2)
</code></pre>

<hr>
<h2 id='norwegianfire'>
Norwegian fire insurance data
</h2><span id='topic+norwegianfire'></span>

<h3>Description</h3>

<p>Fire insurance claims for a Norwegian insurance company for the period 1972 to 1992 as studied in Beirlant et al. (1996). <br /> A priority of 500 units was in force.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("norwegianfire")</code></pre>


<h3>Format</h3>

<p>A data frame with 9181 observations on the following 2 variables:
</p>

<dl>
<dt><code>size</code></dt><dd><p>Size of fire insurance claim (in 1000 NOK).</p>
</dd>
<dt><code>year</code></dt><dd><p>Year of claim occurence (expressed as <code class="reqn">yy</code> instead of <code class="reqn">19yy</code>).</p>
</dd>
</dl>



<h3>Source</h3>

<p>Beirlant, J., Teugels, J. L. and Vynckier, P. (1996). <em>Practical Analysis of Extreme Values</em>, Leuven
University Press.
</p>


<h3>References</h3>

<p>Beirlant J., Goegebeur Y., Segers, J. and Teugels, J. (2004). <em>Statistics of Extremes: Theory and Applications</em>, Wiley Series in Probability, Wiley, Chichester.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(norwegianfire)

# Exponential QQ-plot for Norwegian Fire Insurance data for claims in 1976.
ExpQQ(norwegianfire$size[norwegianfire$year==76])

# Pareto QQ-plot for Norwegian Fire Insurance data for claims in 1976.
ParetoQQ(norwegianfire$size[norwegianfire$year==76])
</code></pre>

<hr>
<h2 id='Pareto'>
The Pareto distribution
</h2><span id='topic+dpareto'></span><span id='topic+ppareto'></span><span id='topic+qpareto'></span><span id='topic+rpareto'></span>

<h3>Description</h3>

<p>Density, distribution function, quantile function and random generation for the Pareto distribution (type I).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dpareto(x, shape, scale = 1, log = FALSE)
ppareto(x, shape, scale = 1, lower.tail = TRUE, log.p = FALSE)
qpareto(p, shape, scale = 1, lower.tail = TRUE, log.p = FALSE)
rpareto(n, shape, scale = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Pareto_+3A_x">x</code></td>
<td>

<p>Vector of quantiles.
</p>
</td></tr>
<tr><td><code id="Pareto_+3A_p">p</code></td>
<td>

<p>Vector of probabilities.
</p>
</td></tr>
<tr><td><code id="Pareto_+3A_n">n</code></td>
<td>

<p>Number of observations.
</p>
</td></tr>
<tr><td><code id="Pareto_+3A_shape">shape</code></td>
<td>

<p>The shape parameter of the Pareto distribution, a strictly positive number.
</p>
</td></tr>
<tr><td><code id="Pareto_+3A_scale">scale</code></td>
<td>

<p>The scale parameter of the Pareto distribution, a strictly positive number. Its default value is <code>1</code>.
</p>
</td></tr>
<tr><td><code id="Pareto_+3A_log">log</code></td>
<td>

<p>Logical indicating if the densities are given as <code class="reqn">\log(f)</code>, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="Pareto_+3A_lower.tail">lower.tail</code></td>
<td>

<p>Logical indicating if the probabilities are of the form <code class="reqn">P(X\le x)</code> (<code>TRUE</code>) or <code class="reqn">P(X&gt;x)</code> (<code>FALSE</code>). Default is <code>TRUE.</code>
</p>
</td></tr>
<tr><td><code id="Pareto_+3A_log.p">log.p</code></td>
<td>

<p>Logical indicating if the probabilities are given as <code class="reqn">\log(p)</code>, default is <code>FALSE</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Cumulative Distribution Function (CDF) of the Pareto distribution is equal to
<code class="reqn">F(x) = 1-(x/scale)^{-shape}</code> for all <code class="reqn">x \ge scale</code> and <code class="reqn">F(x)=0</code> otherwise. Both <code>shape</code> and <code>scale</code> need to be strictly positive.
</p>


<h3>Value</h3>

<p><code>dpareto</code> gives the density function evaluated in <code class="reqn">x</code>, <code>ppareto</code> the CDF evaluated in <code class="reqn">x</code> and <code>qpareto</code> the quantile function evaluated in <code class="reqn">p</code>. The length of the result is equal to the length of <code class="reqn">x</code> or <code class="reqn">p</code>.
</p>
<p><code>rpareto</code> returns a random sample of length <code class="reqn">n</code>.
</p>


<h3>Author(s)</h3>

<p>Tom Reynkens.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ptpareto">tPareto</a></code>, <code><a href="#topic+pgpd">GPD</a></code>,  <code><a href="stats.html#topic+Distributions">Distributions</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Plot of the PDF
x &lt;- seq(1, 10, 0.01)
plot(x, dpareto(x, shape=2), xlab="x", ylab="PDF", type="l")

# Plot of the CDF
x &lt;- seq(1, 10, 0.01)
plot(x, ppareto(x, shape=2), xlab="x", ylab="CDF", type="l")

</code></pre>

<hr>
<h2 id='ParetoQQ'>
Pareto quantile plot
</h2><span id='topic+ParetoQQ'></span>

<h3>Description</h3>

<p>Computes the empirical quantiles of the log-transform of a data vector and the theoretical quantiles of the standard exponential distribution. These quantiles are then plotted in a Pareto QQ-plot with the theoretical quantiles on the <code class="reqn">x</code>-axis and the empirical quantiles on the <code class="reqn">y</code>-axis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ParetoQQ(data, plot = TRUE, main = "Pareto QQ-plot", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ParetoQQ_+3A_data">data</code></td>
<td>

<p>Vector of <code class="reqn">n</code> observations. 
</p>
</td></tr>
<tr><td><code id="ParetoQQ_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the quantiles should be plotted in a Pareto QQ-plot, default is <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="ParetoQQ_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"Pareto QQ-plot"</code>.
</p>
</td></tr>
<tr><td><code id="ParetoQQ_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It can be easily seen that a log-transformed Pareto random variable is exponentially distributed.
We can hence obtain a Pareto QQ-plot from an exponential QQ-plot by replacing the empirical quantiles from the data vector by the empirical quantiles from the log-transformed data. We hence plot
</p>
<p style="text-align: center;"><code class="reqn">( -\log(1-i/(n+1)), \log X_{i,n} )</code>
</p>

<p>for <code class="reqn">i=1,...,n,</code>
with <code class="reqn">X_{i,n}</code> the <code class="reqn">i</code>-th order statistic of the data.
</p>
<p>See Section 4.1 of Albrecher et al. (2017) for more details.
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>pqq.the</code></td>
<td>
<p>Vector of the theoretical quantiles from a standard exponential distribution.</p>
</td></tr>
<tr><td><code>pqq.emp</code></td>
<td>
<p>Vector of the empirical quantiles from the log-transformed data.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens based on <code>S-Plus</code> code from Yuri Goegebeur.
</p>


<h3>References</h3>

<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>
<p>Beirlant J., Goegebeur Y., Segers, J. and Teugels, J. (2004). <em>Statistics of Extremes: Theory and Applications</em>, Wiley Series in Probability, Wiley, Chichester.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ParetoQQ_der">ParetoQQ_der</a></code>, <code><a href="#topic+ExpQQ">ExpQQ</a></code>, <code><a href="#topic+genQQ">genQQ</a></code>, <code><a href="#topic+LognormalQQ">LognormalQQ</a></code>, <code><a href="#topic+WeibullQQ">WeibullQQ</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(norwegianfire)

# Exponential QQ-plot for Norwegian Fire Insurance data for claims in 1976.
ExpQQ(norwegianfire$size[norwegianfire$year==76])

# Pareto QQ-plot for Norwegian Fire Insurance data for claims in 1976.
ParetoQQ(norwegianfire$size[norwegianfire$year==76])
</code></pre>

<hr>
<h2 id='ParetoQQ_der'>
Derivative plot of the Pareto QQ-plot
</h2><span id='topic+ParetoQQ_der'></span>

<h3>Description</h3>

<p>Computes the derivative plot of the Pareto QQ-plot. These values can be plotted as a function of the data or as a function of the tail parameter <code class="reqn">k</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ParetoQQ_der(data, k = FALSE, plot = TRUE, 
             main = "Derivative plot of Pareto QQ-plot", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ParetoQQ_der_+3A_data">data</code></td>
<td>

<p>Vector of <code class="reqn">n</code> observations. 
</p>
</td></tr>
<tr><td><code id="ParetoQQ_der_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the derivative values should be plotted, default is <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="ParetoQQ_der_+3A_k">k</code></td>
<td>

<p>Logical indicating if the derivative values are plotted as a function of the tail parameter <code class="reqn">k</code> (<code>k=TRUE</code>) or as a function of the logarithm of the data (<code>k=FALSE</code>). Default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="ParetoQQ_der_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"Derivative plot of Pareto QQ-plot"</code>.
</p>
</td></tr>
<tr><td><code id="ParetoQQ_der_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The derivative plot of a Pareto QQ-plot is </p>
<p style="text-align: center;"><code class="reqn">(k,H_{k,n})</code>
</p>
<p> or </p>
<p style="text-align: center;"><code class="reqn">(\log X_{n-k,n}, H_{k,n})</code>
</p>

<p>with <code class="reqn">H_{k,n}</code> the Hill estimates.
</p>
<p>See Section 4.1 of Albrecher et al. (2017) for more details.
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>xval</code></td>
<td>
<p>Vector of the x-values of the plot (<code class="reqn">k</code> or <code class="reqn">\log X_{n-k,n}</code>).</p>
</td></tr>
<tr><td><code>yval</code></td>
<td>
<p>Vector of the derivative values <code class="reqn">H_{k,n}</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens.
</p>


<h3>References</h3>

<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>
<p>Beirlant J., Goegebeur Y., Segers, J. and Teugels, J. (2004). <em>Statistics of Extremes: Theory and Applications</em>, Wiley Series in Probability, Wiley, Chichester.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ParetoQQ">ParetoQQ</a></code>, <code><a href="#topic+Hill">Hill</a></code>, <code><a href="#topic+MeanExcess">MeanExcess</a></code>, <code><a href="#topic+LognormalQQ_der">LognormalQQ_der</a></code>, <code><a href="#topic+WeibullQQ_der">WeibullQQ_der</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(norwegianfire)

# Pareto QQ-plot for Norwegian Fire Insurance data for claims in 1976.
ParetoQQ(norwegianfire$size[norwegianfire$year==76])

# Derivate plot
ParetoQQ_der(norwegianfire$size[norwegianfire$year==76])
</code></pre>

<hr>
<h2 id='pClas'>
Classical estimators for the CDF
</h2><span id='topic+pClas'></span>

<h3>Description</h3>

<p>Compute approximations of the CDF using the normal approximation,
normal-power approximation, shifted Gamma approximation or normal approximation to the shifted Gamma distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pClas(x, mean = 0, variance = 1, skewness = NULL, 
      method = c("normal", "normal-power", "shifted Gamma", "shifted Gamma normal"), 
      lower.tail = TRUE, log.p = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pClas_+3A_x">x</code></td>
<td>

<p>Vector of points to approximate the CDF in.
</p>
</td></tr>
<tr><td><code id="pClas_+3A_mean">mean</code></td>
<td>

<p>Mean of the distribution, default is 0.
</p>
</td></tr>
<tr><td><code id="pClas_+3A_variance">variance</code></td>
<td>

<p>Variance of the distribution, default is 1.
</p>
</td></tr>
<tr><td><code id="pClas_+3A_skewness">skewness</code></td>
<td>

<p>Skewness coefficient of the distribution, this argument is not used for the normal approximation. Default is <code>NULL</code> meaning no skewness coefficient is provided.
</p>
</td></tr>
<tr><td><code id="pClas_+3A_method">method</code></td>
<td>

<p>Approximation method to use, one of <code>"normal"</code>, <code>"normal-power"</code>, <code>"shifted Gamma"</code> or <code>"shifted Gamma normal"</code>. Default is <code>"normal"</code>.
</p>
</td></tr>
<tr><td><code id="pClas_+3A_lower.tail">lower.tail</code></td>
<td>

<p>Logical indicating if the probabilities are of the form <code class="reqn">P(X\le x)</code> (<code>TRUE</code>) or <code class="reqn">P(X&gt;x)</code> (<code>FALSE</code>). Default is <code>TRUE.</code>
</p>
</td></tr>
<tr><td><code id="pClas_+3A_log.p">log.p</code></td>
<td>

<p>Logical indicating if the probabilities are given as <code class="reqn">\log(p)</code>, default is <code>FALSE</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p> The <em>normal approximation</em> for the CDF of the r.v. <code class="reqn">X</code> is defined as
</p>
<p style="text-align: center;"><code class="reqn">F_X(x) \approx \Phi((x-\mu)/\sigma)</code>
</p>

<p>where <code class="reqn">\mu</code> and <code class="reqn">\sigma^2</code> are the mean and variance of <code class="reqn">X</code>, respectively.
</p>
</li>
<li><p> This approximation can be improved when the skewness parameter  
</p>
<p style="text-align: center;"><code class="reqn">\nu=E((X-\mu)^3)/\sigma^3</code>
</p>

<p>is available. The <em>normal-power approximation</em> of the CDF is then given by
</p>
<p style="text-align: center;"><code class="reqn">F_X(x) \approx \Phi(\sqrt{9/\nu^2 + 6z/\nu+1}-3/\nu)</code>
</p>

<p>for <code class="reqn">z=(x-\mu)/\sigma\ge 1</code> and <code class="reqn">9/\nu^2 + 6z/\nu+1\ge 0</code>.
</p>
</li>
<li><p> The <em>shifted Gamma approximation</em> uses the approximation
</p>
<p style="text-align: center;"><code class="reqn">X \approx \Gamma(4/\nu^2, 2/(\nu\times\sigma)) + \mu -2\sigma/\nu.</code>
</p>

<p>Here, we need that <code class="reqn">\nu&gt;0</code>.
</p>
</li>
<li><p> The <em>normal approximation to the shifted Gamma distribution</em> approximates the CDF of <code class="reqn">X</code> as
</p>
<p style="text-align: center;"><code class="reqn">F_X(x) \approx \Phi(\sqrt{16/\nu^2 + 8z/\nu}-\sqrt{16/\nu^2-1})</code>
</p>

<p>for <code class="reqn">z=(x-\mu)/\sigma\ge 1</code>. We need again that <code class="reqn">\nu&gt;0</code>.
</p>
</li></ul>

<p>See Section 6.2 of Albrecher et al. (2017) for more details.
</p>


<h3>Value</h3>

<p>Vector of estimates for the probabilities <code class="reqn">F(x)=P(X\le x)</code>.
</p>


<h3>Author(s)</h3>

<p>Tom Reynkens
</p>


<h3>References</h3>

<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pEdge">pEdge</a></code>, <code><a href="#topic+pGC">pGC</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Chi-squared sample
X &lt;- rchisq(1000, 2)

x &lt;- seq(0, 10, 0.01)

# Classical approximations
p1 &lt;- pClas(x, mean(X), var(X))
p2 &lt;- pClas(x, mean(X), var(X), mean((X-mean(X))^3)/sd(X)^3, method="normal-power")
p3 &lt;- pClas(x, mean(X), var(X), mean((X-mean(X))^3)/sd(X)^3, method="shifted Gamma")
p4 &lt;- pClas(x, mean(X), var(X), mean((X-mean(X))^3)/sd(X)^3, method="shifted Gamma normal")

# True probabilities
p &lt;- pchisq(x, 2)


# Plot true and estimated probabilities
plot(x, p, type="l", ylab="F(x)", ylim=c(0,1), col="red")
lines(x, p1, lty=2)
lines(x, p2, lty=3, col="green")
lines(x, p3, lty=4)
lines(x, p4, lty=5, col="blue")

legend("bottomright", c("True CDF", "normal approximation", "normal-power approximation",
                        "shifted Gamma approximation", "shifted Gamma normal approximation"), 
      lty=1:5, col=c("red", "black", "green", "black", "blue"), lwd=2)
</code></pre>

<hr>
<h2 id='pEdge'>
Edgeworth approximation
</h2><span id='topic+pEdge'></span>

<h3>Description</h3>

<p>Edgeworth approximation of the CDF using the first four moments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pEdge(x, moments = c(0, 1, 0, 3), raw = TRUE, lower.tail = TRUE, log.p = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pEdge_+3A_x">x</code></td>
<td>

<p>Vector of points to approximate the CDF in.
</p>
</td></tr>
<tr><td><code id="pEdge_+3A_moments">moments</code></td>
<td>

<p>The first four raw moments if <code>raw=TRUE</code>. By default the first four raw moments of the standard normal distribution are used.
When <code>raw=FALSE</code>, the mean <code class="reqn">\mu=E(X)</code>, variance <code class="reqn">\sigma^2=E((X-\mu)^2)</code>, skewness (third standardised moment, <code class="reqn">\nu=E((X-\mu)^3)/\sigma^3</code>) and kurtosis (fourth standardised moment, <code class="reqn">k=E((X-\mu)^4)/\sigma^4</code>).
</p>
</td></tr>
<tr><td><code id="pEdge_+3A_raw">raw</code></td>
<td>

<p>When <code>TRUE</code> (default), the first four raw moments are provided in <code>moments</code>. Otherwise, the mean, variance, skewness and kurtosis are provided in <code>moments</code>. 
</p>
</td></tr>
<tr><td><code id="pEdge_+3A_lower.tail">lower.tail</code></td>
<td>

<p>Logical indicating if the probabilities are of the form <code class="reqn">P(X\le x)</code> (<code>TRUE</code>) or <code class="reqn">P(X&gt;x)</code> (<code>FALSE</code>). Default is <code>TRUE.</code>
</p>
</td></tr>
<tr><td><code id="pEdge_+3A_log.p">log.p</code></td>
<td>

<p>Logical indicating if the probabilities are given as <code class="reqn">\log(p)</code>, default is <code>FALSE</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

 
<p>Denote the standard normal PDF and CDF respectively by <code class="reqn">\phi</code> and <code class="reqn">\Phi</code>.
Let <code class="reqn">\mu</code> be the first moment, <code class="reqn">\sigma^2=E((X-\mu)^2)</code> the variance, <code class="reqn">\mu_3=E((X-\mu)^3)</code> the third central moment and <code class="reqn">\mu_4=E((X-\mu)^4)</code> the fourth central moment of the random variable <code class="reqn">X</code>.
The corresponding cumulants are given by <code class="reqn">\kappa_1=\mu</code>, <code class="reqn">\kappa_2=\sigma^2</code>, <code class="reqn">\kappa_3=\mu_3</code> and <code class="reqn">\kappa_4=\mu_4-3\sigma^4</code>. 
</p>
<p>Now consider the random variable <code class="reqn">Z=(X-\mu)/\sigma</code>, which has cumulants
0, 1, <code class="reqn">\nu=\kappa_3/\sigma^3</code>  and <code class="reqn">k=\kappa_4/\sigma^4=\mu_4/\sigma^4-3</code>.
</p>
<p>The Edgeworth approximation for the CDF of <code class="reqn">X</code> (<code class="reqn">F(x)</code>) is given by
</p>
<p style="text-align: center;"><code class="reqn">\hat{F}_{E}(x) = \Phi(z) + \phi(z) (-\nu/6 h_2(z)- (3k\times h_3(z)+\gamma_3^2h_5(z))/72)</code>
</p>

<p>with <code class="reqn">h_2(z)=z^2-1</code>, <code class="reqn">h_3(z)=z^3-3z</code>, <code class="reqn">h_5(z)=z^5-10z^3+15z</code> and <code class="reqn">z=(x-\mu)/\sigma</code>.
</p>
<p>See Section 6.2 of Albrecher et al. (2017) for more details.
</p>


<h3>Value</h3>

<p>Vector of estimates for the probabilities <code class="reqn">F(x)=P(X\le x)</code>.
</p>


<h3>Author(s)</h3>

<p>Tom Reynkens
</p>


<h3>References</h3>

<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>
<p>Cheah, P.K., Fraser, D.A.S. and Reid, N. (1993). &quot;Some Alternatives to Edgeworth.&quot; <em>The Canadian Journal of Statistics</em>, 21(2), 131&ndash;138.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pGC">pGC</a></code>, <code><a href="#topic+pEdge">pEdge</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Chi-squared sample
X &lt;- rchisq(1000, 2)


x &lt;- seq(0, 10, 0.01)

# Empirical moments
moments = c(mean(X), mean(X^2), mean(X^3), mean(X^4))

# Gram-Charlier approximation
p1 &lt;- pGC(x, moments)

# Edgeworth approximation
p2 &lt;- pEdge(x, moments)

# Normal approximation
p3 &lt;- pClas(x, mean(X), var(X))

# True probabilities
p &lt;- pchisq(x, 2)


# Plot true and estimated probabilities
plot(x, p, type="l", ylab="F(x)", ylim=c(0,1), col="red")
lines(x, p1, lty=2)
lines(x, p2, lty=3)
lines(x, p3, lty=4, col="blue")

legend("bottomright", c("True CDF", "GC approximation", 
                        "Edgeworth approximation", "Normal approximation"), 
       col=c("red", "black", "black", "blue"), lty=1:4, lwd=2)
</code></pre>

<hr>
<h2 id='pGC'>
Gram-Charlier approximation
</h2><span id='topic+pGC'></span>

<h3>Description</h3>

<p>Gram-Charlier approximation of the CDF using the first four moments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pGC(x, moments = c(0, 1, 0, 3), raw = TRUE, lower.tail = TRUE, log.p = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pGC_+3A_x">x</code></td>
<td>

<p>Vector of points to approximate the CDF in.
</p>
</td></tr>
<tr><td><code id="pGC_+3A_moments">moments</code></td>
<td>

<p>The first four raw moments if <code>raw=TRUE</code>. By default the first four raw moments of the standard normal distribution are used.
When <code>raw=FALSE</code>, the mean <code class="reqn">\mu=E(X)</code>, variance <code class="reqn">\sigma^2=E((X-\mu)^2)</code>, skewness (third standardised moment, <code class="reqn">\nu=E((X-\mu)^3)/\sigma^3</code>) and kurtosis (fourth standardised moment, <code class="reqn">k=E((X-\mu)^4)/\sigma^4</code>).
</p>
</td></tr>
<tr><td><code id="pGC_+3A_raw">raw</code></td>
<td>

<p>When <code>TRUE</code> (default), the first four raw moments are provided in <code>moments</code>. Otherwise, the mean, variance, skewness and kurtosis are provided in <code>moments</code>. 
</p>
</td></tr>
<tr><td><code id="pGC_+3A_lower.tail">lower.tail</code></td>
<td>

<p>Logical indicating if the probabilities are of the form <code class="reqn">P(X\le x)</code> (<code>TRUE</code>) or <code class="reqn">P(X&gt;x)</code> (<code>FALSE</code>). Default is <code>TRUE.</code>
</p>
</td></tr>
<tr><td><code id="pGC_+3A_log.p">log.p</code></td>
<td>

<p>Logical indicating if the probabilities are given as <code class="reqn">\log(p)</code>, default is <code>FALSE</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

 
<p>Denote the standard normal PDF and CDF respectively by <code class="reqn">\phi</code> and <code class="reqn">\Phi</code>.
Let <code class="reqn">\mu</code> be the first moment, <code class="reqn">\sigma^2=E((X-\mu)^2)</code> the variance, <code class="reqn">\mu_3=E((X-\mu)^3)</code> the third central moment and <code class="reqn">\mu_4=E((X-\mu)^4)</code> the fourth central moment of the random variable <code class="reqn">X</code>.
The corresponding cumulants are given by <code class="reqn">\kappa_1=\mu</code>, <code class="reqn">\kappa_2=\sigma^2</code>, <code class="reqn">\kappa_3=\mu_3</code> and <code class="reqn">\kappa_4=\mu_4-3\sigma^4</code>. 
</p>
<p>Now consider the random variable <code class="reqn">Z=(X-\mu)/\sigma</code>, which has cumulants
0, 1, <code class="reqn">\nu=\kappa_3/\sigma^3</code>  and <code class="reqn">k=\kappa_4/\sigma^4=\mu_4/\sigma^4-3</code>.
</p>
<p>The Gram-Charlier approximation for the CDF of <code class="reqn">X</code> (<code class="reqn">F(x)</code>) is given by
</p>
<p style="text-align: center;"><code class="reqn">\hat{F}_{GC}(x) = \Phi(z) + \phi(z) (-\nu/6 h_2(z)- k/24h_3(z))</code>
</p>

<p>with <code class="reqn">h_2(z)=z^2-1</code>, <code class="reqn">h_3(z)=z^3-3z</code> and <code class="reqn">z=(x-\mu)/\sigma</code>.
</p>
<p>See Section 6.2 of Albrecher et al. (2017) for more details.
</p>


<h3>Value</h3>

<p>Vector of estimates for the probabilities <code class="reqn">F(x)=P(X\le x)</code>.
</p>


<h3>Author(s)</h3>

<p>Tom Reynkens
</p>


<h3>References</h3>

<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>
<p>Cheah, P.K., Fraser, D.A.S. and Reid, N. (1993). &quot;Some Alternatives to Edgeworth.&quot; <em>The Canadian Journal of Statistics</em>, 21(2), 131&ndash;138.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pEdge">pEdge</a></code>, <code><a href="#topic+pClas">pClas</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Chi-squared sample
X &lt;- rchisq(1000, 2)


x &lt;- seq(0, 10, 0.01)

# Empirical moments
moments = c(mean(X), mean(X^2), mean(X^3), mean(X^4))

# Gram-Charlier approximation
p1 &lt;- pGC(x, moments)

# Edgeworth approximation
p2 &lt;- pEdge(x, moments)

# Normal approximation
p3 &lt;- pClas(x, mean(X), var(X))

# True probabilities
p &lt;- pchisq(x, 2)


# Plot true and estimated probabilities
plot(x, p, type="l", ylab="F(x)", ylim=c(0,1), col="red")
lines(x, p1, lty=2)
lines(x, p2, lty=3)
lines(x, p3, lty=4, col="blue")

legend("bottomright", c("True CDF", "GC approximation", 
                        "Edgeworth approximation", "Normal approximation"), 
       col=c("red", "black", "black", "blue"), lty=1:4, lwd=2)
</code></pre>

<hr>
<h2 id='Prob'>
Weissman estimator of small exceedance probabilities and large return periods
</h2><span id='topic+Prob'></span><span id='topic+Return'></span><span id='topic+Weissman.p'></span><span id='topic+Weissman.r'></span>

<h3>Description</h3>

<p>Compute estimates of a small exceedance probability <code class="reqn">P(X&gt;q)</code> or large return period <code class="reqn">1/P(X&gt;q)</code> using the approach of Weissman (1978).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Prob(data, gamma, q, plot = FALSE, add = FALSE, 
     main = "Estimates of small exceedance probability", ...)
          
Return(data, gamma, q, plot = FALSE, add = FALSE, 
       main = "Estimates of large return period", ...)
        
Weissman.p(data, gamma, q, plot = FALSE, add = FALSE, 
           main = "Estimates of small exceedance probability", ...)
          
Weissman.r(data, gamma, q, plot = FALSE, add = FALSE, 
           main = "Estimates of large return period", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Prob_+3A_data">data</code></td>
<td>

<p>Vector of <code class="reqn">n</code> observations.  
</p>
</td></tr>
<tr><td><code id="Prob_+3A_gamma">gamma</code></td>
<td>

<p>Vector of <code class="reqn">n-1</code> estimates for the EVI, typically Hill estimates are used.
</p>
</td></tr>
<tr><td><code id="Prob_+3A_q">q</code></td>
<td>

<p>The used large quantile (we estimate <code class="reqn">P(X&gt;q)</code> or <code class="reqn">1/P(X&gt;q)</code> for <code class="reqn">q</code> large).
</p>
</td></tr>
<tr><td><code id="Prob_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the estimates should be plotted as a function of <code class="reqn">k</code>, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="Prob_+3A_add">add</code></td>
<td>

<p>Logical indicating if the estimates should be added to an existing plot, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="Prob_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"Estimates of extreme quantile"</code> for <code>Prob</code>
and <code>"Estimates of large return period"</code> for <code>Return</code>.
</p>
</td></tr>
<tr><td><code id="Prob_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See Section 4.2.1 of Albrecher et al. (2017) for more details.
</p>
<p><code>Weissman.p</code> and <code>Weissman.r</code> are the same functions as <code>Prob</code> and <code>Return</code> but with a different name for compatibility with the old <code>S-Plus</code> code. 
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>k</code></td>
<td>
<p>Vector of the values of the tail parameter <code class="reqn">k</code>.</p>
</td></tr>
<tr><td><code>P</code></td>
<td>
<p>Vector of the corresponding probability estimates, only returned for <code>Prob</code>.</p>
</td></tr>
<tr><td><code>R</code></td>
<td>
<p>Vector of the corresponding estimates for the return period, only returned for <code>Return</code>.</p>
</td></tr>
<tr><td><code>q</code></td>
<td>
<p>The used large quantile.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens based on <code>S-Plus</code> code from Yuri Goegebeur.
</p>


<h3>References</h3>

<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>
<p>Beirlant J., Goegebeur Y., Segers, J. and Teugels, J. (2004). <em>Statistics of Extremes: Theory and Applications</em>, Wiley Series in Probability, Wiley, Chichester.
</p>
<p>Weissman, I. (1978). &quot;Estimation of Parameters and Large Quantiles Based on the <em>k</em> Largest Observations.&quot; <em>Journal of the American Statistical Association</em>, 73, 812&ndash;815.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Quant">Quant</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(soa)

# Look at last 500 observations of SOA data
SOAdata &lt;- sort(soa$size)[length(soa$size)-(0:499)]

# Hill estimator
H &lt;- Hill(SOAdata)

# Exceedance probability
q &lt;- 10^6
# Weissman estimator
Prob(SOAdata,gamma=H$gamma,q=q,plot=TRUE)

# Return period
q &lt;- 10^6
# Weissman estimator
Return(SOAdata,gamma=H$gamma,q=q,plot=TRUE)
</code></pre>

<hr>
<h2 id='ProbEPD'>
Estimator of small exceedance probabilities and large return periods using EPD
</h2><span id='topic+ProbEPD'></span><span id='topic+ReturnEPD'></span>

<h3>Description</h3>

<p>Computes estimates of a small exceedance probability <code class="reqn">P(X&gt;q)</code> or large return period <code class="reqn">1/P(X&gt;q)</code> using the parameters from the EPD fit.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
ProbEPD(data, q, gamma, kappa, tau, plot = FALSE, add = FALSE, 
        main = "Estimates of small exceedance probability", ...)

ReturnEPD(data, q, gamma, kappa, tau, plot = FALSE, add = FALSE, 
          main = "Estimates of large return period", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ProbEPD_+3A_data">data</code></td>
<td>

<p>Vector of <code class="reqn">n</code> observations.  
</p>
</td></tr>
<tr><td><code id="ProbEPD_+3A_q">q</code></td>
<td>

<p>The used large quantile (we estimate <code class="reqn">P(X&gt;q)</code> or <code class="reqn">1/P(X&gt;q)</code> for <code class="reqn">q</code> large).
</p>
</td></tr>
<tr><td><code id="ProbEPD_+3A_gamma">gamma</code></td>
<td>

<p>Vector of <code class="reqn">n-1</code> estimates for the EVI obtained from <code><a href="#topic+EPD">EPD</a></code>.
</p>
</td></tr>
<tr><td><code id="ProbEPD_+3A_kappa">kappa</code></td>
<td>

<p>Vector of <code class="reqn">n-1</code> estimates for <code class="reqn">\kappa</code> obtained from <code><a href="#topic+EPD">EPD</a></code>.
</p>
</td></tr>
<tr><td><code id="ProbEPD_+3A_tau">tau</code></td>
<td>

<p>Vector of <code class="reqn">n-1</code> estimates for <code class="reqn">\tau</code> obtained from <code><a href="#topic+EPD">EPD</a></code>.
</p>
</td></tr>
<tr><td><code id="ProbEPD_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the estimates should be plotted as a function of <code class="reqn">k</code>, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="ProbEPD_+3A_add">add</code></td>
<td>

<p>Logical indicating if the estimates should be added to an existing plot, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="ProbEPD_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"Estimates of small exceedance probability"</code> for <code>ProbEPD</code>
and <code>"Estimates of large return period"</code> for <code>ReturnEPD</code>.
</p>
</td></tr>
<tr><td><code id="ProbEPD_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See Section 4.2.1 of Albrecher et al. (2017) for more details.
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>k</code></td>
<td>
<p>Vector of the values of the tail parameter <code class="reqn">k</code>.</p>
</td></tr>
<tr><td><code>P</code></td>
<td>
<p>Vector of the corresponding probability estimates, only returned for <code>ProbEPD</code>.</p>
</td></tr>
<tr><td><code>R</code></td>
<td>
<p>Vector of the corresponding estimates for the return period, only returned for <code>ReturnEPD</code>.</p>
</td></tr>
<tr><td><code>q</code></td>
<td>
<p>The used large quantile.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens
</p>


<h3>References</h3>

<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>
<p>Beirlant, J., Joossens, E. and Segers, J. (2009). &quot;Second-Order Refined Peaks-Over-Threshold
Modelling for Heavy-Tailed Distributions.&quot; <em>Journal of Statistical Planning and Inference</em>, 139, 2800&ndash;2815.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+EPD">EPD</a></code>, <code><a href="#topic+Prob">Prob</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(secura)

# EPD estimates for the EVI
epd &lt;- EPD(secura$size, plot=TRUE)

# Compute exceedance probabilities
q &lt;- 10^7
ProbEPD(secura$size, q=q, gamma=epd$gamma, kappa=epd$kappa, tau=epd$tau, plot=TRUE)

# Compute return periods
ReturnEPD(secura$size, q=q, gamma=epd$gamma, kappa=epd$kappa, tau=epd$tau, 
          plot=TRUE, ylim=c(0,10^4))
</code></pre>

<hr>
<h2 id='ProbGH'>
Estimator of small exceedance probabilities and large return periods using generalised Hill
</h2><span id='topic+ProbGH'></span><span id='topic+ReturnGH'></span>

<h3>Description</h3>

<p>Computes estimates of a small exceedance probability <code class="reqn">P(X&gt;q)</code> or large return period <code class="reqn">1/P(X&gt;q)</code> using the generalised Hill estimates for the EVI.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ProbGH(data, gamma, q, plot = FALSE, add = FALSE, 
       main = "Estimates of small exceedance probability", ...)

ReturnGH(data, gamma, q, plot = FALSE, add = FALSE, 
         main = "Estimates of large return period", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ProbGH_+3A_data">data</code></td>
<td>

<p>Vector of <code class="reqn">n</code> observations.  
</p>
</td></tr>
<tr><td><code id="ProbGH_+3A_gamma">gamma</code></td>
<td>

<p>Vector of <code class="reqn">n-2</code> estimates for the EVI obtained from <code><a href="#topic+genHill">genHill</a></code>.
</p>
</td></tr>
<tr><td><code id="ProbGH_+3A_q">q</code></td>
<td>

<p>The used large quantile (we estimate <code class="reqn">P(X&gt;q)</code> or <code class="reqn">1/P(X&gt;q)</code> for <code class="reqn">q</code> large).
</p>
</td></tr>
<tr><td><code id="ProbGH_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the estimates should be plotted as a function of <code class="reqn">k</code>, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="ProbGH_+3A_add">add</code></td>
<td>

<p>Logical indicating if the estimates should be added to an existing plot, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="ProbGH_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"Estimates of small exceedance probability"</code> for <code>ProbGH</code> and <code>"Estimates of large return period"</code> for <code>ReturnGH</code>.
</p>
</td></tr>
<tr><td><code id="ProbGH_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See Section 4.2.2 of Albrecher et al. (2017) for more details.
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>k</code></td>
<td>
<p>Vector of the values of the tail parameter <code class="reqn">k</code>.</p>
</td></tr>
<tr><td><code>P</code></td>
<td>
<p>Vector of the corresponding probability estimates, only returned for <code>ProbGH</code>.</p>
</td></tr>
<tr><td><code>R</code></td>
<td>
<p>Vector of the corresponding estimates for the return period, only returned for <code>ReturnGH</code>.</p>
</td></tr>
<tr><td><code>q</code></td>
<td>
<p>The used large quantile.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens.
</p>


<h3>References</h3>

<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>
<p>Beirlant J., Goegebeur Y., Segers, J. and Teugels, J. (2004). <em>Statistics of Extremes: Theory and Applications</em>, Wiley Series in Probability, Wiley, Chichester.
</p>
<p>Beirlant, J., Vynckier, P. and Teugels, J.L. (1996). &quot;Excess Function and Estimation of the Extreme-value Index&quot;. <em>Bernoulli</em>, 2, 293&ndash;318.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+QuantGH">QuantGH</a></code>, <code><a href="#topic+genHill">genHill</a></code>, <code><a href="#topic+ProbMOM">ProbMOM</a></code>, <code><a href="#topic+Prob">Prob</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(soa)

# Look at last 500 observations of SOA data
SOAdata &lt;- sort(soa$size)[length(soa$size)-(0:499)]

# Hill estimator
H &lt;- Hill(SOAdata)
# Generalised Hill estimator
gH &lt;- genHill(SOAdata, H$gamma)

# Exceedance probability
q &lt;- 10^7
ProbGH(SOAdata, gamma=gH$gamma, q=q, plot=TRUE)

# Return period
q &lt;- 10^7
ReturnGH(SOAdata, gamma=gH$gamma, q=q, plot=TRUE)
</code></pre>

<hr>
<h2 id='ProbGPD'>
Estimator of small exceedance probabilities and large return periods using GPD-MLE
</h2><span id='topic+ProbGPD'></span><span id='topic+ReturnGPD'></span>

<h3>Description</h3>

<p>Computes estimates of a small exceedance probability <code class="reqn">P(X&gt;q)</code> or large return period <code class="reqn">1/P(X&gt;q)</code> using the GPD fit for the peaks over a threshold.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ProbGPD(data, gamma, sigma, q, plot = FALSE, add = FALSE, 
        main = "Estimates of small exceedance probability", ...)

ReturnGPD(data, gamma, sigma, q, plot = FALSE, add = FALSE, 
          main = "Estimates of large return period", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ProbGPD_+3A_data">data</code></td>
<td>

<p>Vector of <code class="reqn">n</code> observations.  
</p>
</td></tr>
<tr><td><code id="ProbGPD_+3A_gamma">gamma</code></td>
<td>

<p>Vector of <code class="reqn">n-1</code> estimates for the EVI obtained from <code><a href="#topic+GPDmle">GPDmle</a></code>.
</p>
</td></tr>
<tr><td><code id="ProbGPD_+3A_sigma">sigma</code></td>
<td>

<p>Vector of <code class="reqn">n-1</code> estimates for <code class="reqn">\sigma</code> obtained from <code><a href="#topic+GPDmle">GPDmle</a></code>.
</p>
</td></tr>
<tr><td><code id="ProbGPD_+3A_q">q</code></td>
<td>

<p>The used large quantile (we estimate <code class="reqn">P(X&gt;q)</code> or <code class="reqn">1/P(X&gt;q)</code> for <code class="reqn">q</code> large).
</p>
</td></tr>
<tr><td><code id="ProbGPD_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the estimates should be plotted as a function of <code class="reqn">k</code>, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="ProbGPD_+3A_add">add</code></td>
<td>

<p>Logical indicating if the estimates should be added to an existing plot, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="ProbGPD_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"Estimates of small exceedance probability"</code> for <code>ProbGPD</code>
and <code>"Estimates of large return period"</code> for <code>ReturnGPD</code>.
</p>
</td></tr>
<tr><td><code id="ProbGPD_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See Section 4.2.2 in Albrecher et al. (2017) for more details.
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>k</code></td>
<td>
<p>Vector of the values of the tail parameter <code class="reqn">k</code>.</p>
</td></tr>
<tr><td><code>P</code></td>
<td>
<p>Vector of the corresponding probability estimates, only returned for <code>ProbGPD</code>.</p>
</td></tr>
<tr><td><code>R</code></td>
<td>
<p>Vector of the corresponding estimates for the return period, only returned for <code>ReturnGPD</code>.</p>
</td></tr>
<tr><td><code>q</code></td>
<td>
<p>The used large quantile.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens.
</p>


<h3>References</h3>

<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>
<p>Beirlant J., Goegebeur Y., Segers, J. and Teugels, J. (2004). <em>Statistics of Extremes: Theory and Applications</em>, Wiley Series in Probability, Wiley, Chichester.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+QuantGPD">QuantGPD</a></code>, <code><a href="#topic+GPDmle">GPDmle</a></code>, <code><a href="#topic+Prob">Prob</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(soa)

# Look at last 500 observations of SOA data
SOAdata &lt;- sort(soa$size)[length(soa$size)-(0:499)]

# GPD-ML estimator
pot &lt;- GPDmle(SOAdata)

# Exceedance probability
q &lt;- 10^7
ProbGPD(SOAdata, gamma=pot$gamma, sigma=pot$sigma, q=q, plot=TRUE)

# Return period
q &lt;- 10^7
ReturnGPD(SOAdata, gamma=pot$gamma, sigma=pot$sigma, q=q, plot=TRUE)
</code></pre>

<hr>
<h2 id='ProbMOM'>
Estimator of small exceedance probabilities and large return periods using MOM
</h2><span id='topic+ProbMOM'></span><span id='topic+ReturnMOM'></span>

<h3>Description</h3>

<p>Computes estimates of a small exceedance probability <code class="reqn">P(X&gt;q)</code> or large return period <code class="reqn">1/P(X&gt;q)</code> using the Method of Moments estimates for the EVI.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ProbMOM(data, gamma, q, plot = FALSE, add = FALSE, 
        main = "Estimates of small exceedance probability", ...)

ReturnMOM(data, gamma, q, plot = FALSE, add = FALSE, 
          main = "Estimates of large return period", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ProbMOM_+3A_data">data</code></td>
<td>

<p>Vector of <code class="reqn">n</code> observations.  
</p>
</td></tr>
<tr><td><code id="ProbMOM_+3A_gamma">gamma</code></td>
<td>

<p>Vector of <code class="reqn">n-1</code> estimates for the EVI obtained from <code><a href="#topic+Moment">Moment</a></code>.
</p>
</td></tr>
<tr><td><code id="ProbMOM_+3A_q">q</code></td>
<td>

<p>The used large quantile (we estimate <code class="reqn">P(X&gt;q)</code> or <code class="reqn">1/P(X&gt;q)</code> for <code class="reqn">q</code> large).
</p>
</td></tr>
<tr><td><code id="ProbMOM_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the estimates should be plotted as a function of <code class="reqn">k</code>, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="ProbMOM_+3A_add">add</code></td>
<td>

<p>Logical indicating if the estimates should be added to an existing plot, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="ProbMOM_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"Estimates of small exceedance probability"</code> for <code>ProbMOM</code>
and <code>"Estimates of large return period"</code> for <code>ReturnMOM</code>.
</p>
</td></tr>
<tr><td><code id="ProbMOM_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See Section 4.2.2 of Albrecher et al. (2017) for more details.
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>k</code></td>
<td>
<p>Vector of the values of the tail parameter <code class="reqn">k</code>.</p>
</td></tr>
<tr><td><code>P</code></td>
<td>
<p>Vector of the corresponding probability estimates, only returned for <code>ProbMOM</code>.</p>
</td></tr>
<tr><td><code>R</code></td>
<td>
<p>Vector of the corresponding estimates for the return period, only returned for <code>ReturnMOM</code>.</p>
</td></tr>
<tr><td><code>q</code></td>
<td>
<p>The used large quantile.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens.
</p>


<h3>References</h3>

<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>
<p>Beirlant J., Goegebeur Y., Segers, J. and Teugels, J. (2004). <em>Statistics of Extremes: Theory and Applications</em>, Wiley Series in Probability, Wiley, Chichester.
</p>
<p>Dekkers, A.L.M, Einmahl, J.H.J. and de Haan, L. (1989). &quot;A Moment Estimator for the Index of an Extreme-value Distribution.&quot; <em>Annals of Statistics</em>, 17, 1833&ndash;1855.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+QuantMOM">QuantMOM</a></code>, <code><a href="#topic+Moment">Moment</a></code>, <code><a href="#topic+ProbGH">ProbGH</a></code>, <code><a href="#topic+Prob">Prob</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(soa)

# Look at last 500 observations of SOA data
SOAdata &lt;- sort(soa$size)[length(soa$size)-(0:499)]

# MOM estimator
M &lt;- Moment(SOAdata)

# Exceedance probability
q &lt;- 10^7
ProbMOM(SOAdata, gamma=M$gamma, q=q, plot=TRUE)

# Return period
q &lt;- 10^7
ReturnMOM(SOAdata, gamma=M$gamma, q=q, plot=TRUE)
</code></pre>

<hr>
<h2 id='ProbReg'>
Estimator of small tail probability in regression
</h2><span id='topic+ProbReg'></span>

<h3>Description</h3>

<p>Estimator of small tail probability <code class="reqn">1-F_i(q)</code> in the regression case where <code class="reqn">\gamma</code> is constant and the regression modelling is thus only solely placed on the scale parameter.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ProbReg(Z, A, q, plot = FALSE, add = FALSE, 
        main = "Estimates of small exceedance probability", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ProbReg_+3A_z">Z</code></td>
<td>

<p>Vector of <code class="reqn">n</code> observations (from the response variable). 
</p>
</td></tr>
<tr><td><code id="ProbReg_+3A_a">A</code></td>
<td>

<p>Vector of <code class="reqn">n-1</code> estimates for <code class="reqn">A(i/n)</code> obtained from <code><a href="#topic+ScaleReg">ScaleReg</a></code>.
</p>
</td></tr>
<tr><td><code id="ProbReg_+3A_q">q</code></td>
<td>

<p>The used large quantile (we estimate <code class="reqn">P(X_i&gt;q)</code>) for <code class="reqn">q</code> large).
</p>
</td></tr>
<tr><td><code id="ProbReg_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the estimates should be plotted as a function of <code class="reqn">k</code>, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="ProbReg_+3A_add">add</code></td>
<td>

<p>Logical indicating if the estimates should be added to an existing plot, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="ProbReg_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"Estimates of small exceedance probability"</code>.
</p>
</td></tr>
<tr><td><code id="ProbReg_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The estimator is defined as
</p>
<p style="text-align: center;"><code class="reqn">1-\hat{F}_i(q) = \hat{A}(i/n) (k+1)/(n+1) (q/Z_{n-k,n})^{-1/H_{k,n}},</code>
</p>

<p>with <code class="reqn">H_{k,n}</code> the Hill estimator. Here, it is assumed that we have equidistant covariates <code class="reqn">x_i=i/n</code>.
</p>
<p>See Section 4.4.1 in Albrecher et al. (2017) for more details. 
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>k</code></td>
<td>
<p>Vector of the values of the tail parameter <code class="reqn">k</code>.</p>
</td></tr>
<tr><td><code>P</code></td>
<td>
<p>Vector of the corresponding probability estimates.</p>
</td></tr>
<tr><td><code>q</code></td>
<td>
<p>The used large quantile.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens.
</p>


<h3>References</h3>

<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+QuantReg">QuantReg</a></code>, <code><a href="#topic+ScaleReg">ScaleReg</a></code>, <code><a href="#topic+Prob">Prob</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(norwegianfire)

Z &lt;- norwegianfire$size[norwegianfire$year==76]

i &lt;- 100
n &lt;- length(Z)

# Scale estimator in i/n
A &lt;- ScaleReg(i/n, Z, h=0.5, kernel = "epanechnikov")$A

# Small exceedance probability
q &lt;- 10^6
ProbReg(Z, A, q, plot=TRUE)

# Large quantile
p &lt;- 10^(-5)
QuantReg(Z, A, p, plot=TRUE)
</code></pre>

<hr>
<h2 id='Quant'>
Weissman estimator of extreme quantiles
</h2><span id='topic+Quant'></span><span id='topic+Weissman.q'></span>

<h3>Description</h3>

<p>Compute estimates of an extreme quantile <code class="reqn">Q(1-p)</code> using the approach of Weissman (1978).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Quant(data, gamma, p, plot = FALSE, add = FALSE, 
      main = "Estimates of extreme quantile", ...)
            
Weissman.q(data, gamma, p, plot = FALSE, add = FALSE, 
           main = "Estimates of extreme quantile", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Quant_+3A_data">data</code></td>
<td>

<p>Vector of <code class="reqn">n</code> observations.  
</p>
</td></tr>
<tr><td><code id="Quant_+3A_gamma">gamma</code></td>
<td>

<p>Vector of <code class="reqn">n-1</code> estimates for the EVI, typically Hill estimates are used.
</p>
</td></tr>
<tr><td><code id="Quant_+3A_p">p</code></td>
<td>

<p>The exceedance probability of the quantile (we estimate <code class="reqn">Q(1-p)</code> for <code class="reqn">p</code> small).
</p>
</td></tr>
<tr><td><code id="Quant_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the estimates should be plotted as a function of <code class="reqn">k</code>, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="Quant_+3A_add">add</code></td>
<td>

<p>Logical indicating if the estimates as a function of <code class="reqn">k</code> should be added to an existing plot, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="Quant_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"Estimates of extreme quantile"</code>.
</p>
</td></tr>
<tr><td><code id="Quant_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See Section 4.2.1 of Albrecher et al. (2017) for more details.
</p>
<p><code>Weissman.q</code> is the same function but with a different name for compatibility with the old <code>S-Plus</code> code. 
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>k</code></td>
<td>
<p>Vector of the values of the tail parameter <code class="reqn">k</code>.</p>
</td></tr>
<tr><td><code>Q</code></td>
<td>
<p>Vector of the corresponding quantile estimates.</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>The used exceedance probability.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens based on <code>S-Plus</code> code from Yuri Goegebeur.
</p>


<h3>References</h3>

<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>
<p>Beirlant J., Goegebeur Y., Segers, J. and Teugels, J. (2004). <em>Statistics of Extremes: Theory and Applications</em>, Wiley Series in Probability, Wiley, Chichester.
</p>
<p>Weissman, I. (1978). &quot;Estimation of Parameters and Large Quantiles Based on the <em>k</em> Largest Observations.&quot; <em>Journal of the American Statistical Association</em>, 73, 812&ndash;815.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Prob">Prob</a></code>, <code><a href="#topic+Quant.2oQV">Quant.2oQV</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(soa)

# Look at last 500 observations of SOA data
SOAdata &lt;- sort(soa$size)[length(soa$size)-(0:499)]

# Hill estimator
H &lt;- Hill(SOAdata)
# Bias-reduced estimator (QV)
H_QV &lt;- Hill.2oQV(SOAdata)

# Exceedance probability
p &lt;- 10^(-5)
# Weissman estimator
Quant(SOAdata, gamma=H$gamma, p=p, plot=TRUE)

# Second order Weissman estimator (QV)
Quant.2oQV(SOAdata, gamma=H_QV$gamma, beta=H_QV$beta, b=H_QV$b, p=p,
           add=TRUE, lty=2)
</code></pre>

<hr>
<h2 id='Quant.2oQV'>
Second order refined Weissman estimator of extreme quantiles (QV)
</h2><span id='topic+Quant.2oQV'></span><span id='topic+Weissman.q.2oQV'></span>

<h3>Description</h3>

<p>Compute second order refined Weissman estimator of extreme quantiles <code class="reqn">Q(1-p)</code> using the quantile view.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Quant.2oQV(data, gamma, b, beta, p, plot = FALSE, add = FALSE, 
           main = "Estimates of extreme quantile", ...)
                
Weissman.q.2oQV(data, gamma, b, beta, p, plot = FALSE, add = FALSE, 
                main = "Estimates of extreme quantile", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Quant.2oQV_+3A_data">data</code></td>
<td>

<p>Vector of <code class="reqn">n</code> observations.  
</p>
</td></tr>
<tr><td><code id="Quant.2oQV_+3A_gamma">gamma</code></td>
<td>

<p>Vector of <code class="reqn">n-1</code> estimates for the EVI obtained from <code><a href="#topic+Hill.2oQV">Hill.2oQV</a></code>.
</p>
</td></tr>
<tr><td><code id="Quant.2oQV_+3A_b">b</code></td>
<td>

<p>Vector of <code class="reqn">n-1</code> estimates for <code class="reqn">b</code> obtained from <code><a href="#topic+Hill.2oQV">Hill.2oQV</a></code>.
</p>
</td></tr>
<tr><td><code id="Quant.2oQV_+3A_beta">beta</code></td>
<td>

<p>Vector of <code class="reqn">n-1</code> estimates for <code class="reqn">\beta</code> obtained from <code><a href="#topic+Hill.2oQV">Hill.2oQV</a></code>.
</p>
</td></tr>
<tr><td><code id="Quant.2oQV_+3A_p">p</code></td>
<td>

<p>The exceedance probability of the quantile (we estimate <code class="reqn">Q(1-p)</code> for <code class="reqn">p</code> small).
</p>
</td></tr>
<tr><td><code id="Quant.2oQV_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the estimates should be plotted as a function of <code class="reqn">k</code>, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="Quant.2oQV_+3A_add">add</code></td>
<td>

<p>Logical indicating if the estimates should be added to an existing plot, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="Quant.2oQV_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"Estimates of extreme quantile"</code>.
</p>
</td></tr>
<tr><td><code id="Quant.2oQV_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See Section 4.2.1 of Albrecher et al. (2017) for more details.
</p>
<p><code>Weissman.q.2oQV</code> is the same function but with a different name for compatibility with the old <code>S-Plus</code> code. 
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>k</code></td>
<td>
<p>Vector of the values of the tail parameter <code class="reqn">k</code>.</p>
</td></tr>
<tr><td><code>Q</code></td>
<td>
<p>Vector of the corresponding quantile estimates.</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>The used exceedance probability.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens based on <code>S-Plus</code> code from Yuri Goegebeur.
</p>


<h3>References</h3>

<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>
<p>Beirlant J., Goegebeur Y., Segers, J. and Teugels, J. (2004). <em>Statistics of Extremes: Theory and Applications</em>, Wiley Series in Probability, Wiley, Chichester.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Quant">Quant</a></code>, <code><a href="#topic+Hill.2oQV">Hill.2oQV</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(soa)

# Look at last 500 observations of SOA data
SOAdata &lt;- sort(soa$size)[length(soa$size)-(0:499)]

# Hill estimator
H &lt;- Hill(SOAdata)
# Bias-reduced estimator (QV)
H_QV &lt;- Hill.2oQV(SOAdata)

# Exceedance probability
p &lt;- 10^(-5)
# Weissman estimator
Quant(SOAdata, gamma=H$gamma, p=p, plot=TRUE)

# Second order Weissman estimator (QV)
Quant.2oQV(SOAdata, gamma=H_QV$gamma, beta=H_QV$beta, b=H_QV$b, p=p,
           add=TRUE, lty=2)
</code></pre>

<hr>
<h2 id='QuantGH'>
Estimator of extreme quantiles using generalised Hill
</h2><span id='topic+QuantGH'></span>

<h3>Description</h3>

<p>Compute estimates of an extreme quantile <code class="reqn">Q(1-p)</code> using generalised Hill estimates of the EVI.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>QuantGH(data, gamma, p, plot = FALSE, add = FALSE, 
        main = "Estimates of extreme quantile", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="QuantGH_+3A_data">data</code></td>
<td>

<p>Vector of <code class="reqn">n</code> observations.  
</p>
</td></tr>
<tr><td><code id="QuantGH_+3A_gamma">gamma</code></td>
<td>

<p>Vector of <code class="reqn">n-2</code> estimates for the EVI obtained from <code><a href="#topic+genHill">genHill</a></code>.
</p>
</td></tr>
<tr><td><code id="QuantGH_+3A_p">p</code></td>
<td>

<p>The exceedance probability of the quantile (we estimate <code class="reqn">Q(1-p)</code> for <code class="reqn">p</code> small).
</p>
</td></tr>
<tr><td><code id="QuantGH_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the estimates should be plotted as a function of <code class="reqn">k</code>, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="QuantGH_+3A_add">add</code></td>
<td>

<p>Logical indicating if the estimates should be added to an existing plot, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="QuantGH_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"Estimates of extreme quantile"</code>.
</p>
</td></tr>
<tr><td><code id="QuantGH_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See Section 4.2.2 of Albrecher et al. (2017) for more details.
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>k</code></td>
<td>
<p>Vector of the values of the tail parameter <code class="reqn">k</code>.</p>
</td></tr>
<tr><td><code>Q</code></td>
<td>
<p>Vector of the corresponding quantile estimates.</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>The used exceedance probability.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens.
</p>


<h3>References</h3>

<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>
<p>Beirlant J., Goegebeur Y., Segers, J. and Teugels, J. (2004). <em>Statistics of Extremes: Theory and Applications</em>, Wiley Series in Probability, Wiley, Chichester.
</p>
<p>Beirlant, J., Vynckier, P. and Teugels, J.L. (1996). &quot;Excess Function and Estimation of the Extreme-value Index&quot;. <em>Bernoulli</em>, 2, 293&ndash;318.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ProbGH">ProbGH</a></code>, <code><a href="#topic+genHill">genHill</a></code>, <code><a href="#topic+QuantMOM">QuantMOM</a></code>, <code><a href="#topic+Quant">Quant</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(soa)

# Look at last 500 observations of SOA data
SOAdata &lt;- sort(soa$size)[length(soa$size)-(0:499)]

# Hill estimator
H &lt;- Hill(SOAdata)
# Generalised Hill estimator
gH &lt;- genHill(SOAdata, H$gamma)

# Large quantile
p &lt;- 10^(-5)
QuantGH(SOAdata, p=p, gamma=gH$gamma, plot=TRUE)
</code></pre>

<hr>
<h2 id='QuantGPD'>
Estimator of extreme quantiles using GPD-MLE
</h2><span id='topic+QuantGPD'></span>

<h3>Description</h3>

<p>Computes estimates of an extreme quantile <code class="reqn">Q(1-p)</code> using the GPD fit for the peaks over a threshold.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>QuantGPD(data, gamma, sigma, p, plot = FALSE, add = FALSE, 
         main = "Estimates of extreme quantile", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="QuantGPD_+3A_data">data</code></td>
<td>

<p>Vector of <code class="reqn">n</code> observations.  
</p>
</td></tr>
<tr><td><code id="QuantGPD_+3A_gamma">gamma</code></td>
<td>

<p>Vector of <code class="reqn">n-1</code> estimates for the EVI obtained from <code><a href="#topic+GPDmle">GPDmle</a></code>.
</p>
</td></tr>
<tr><td><code id="QuantGPD_+3A_sigma">sigma</code></td>
<td>

<p>Vector of <code class="reqn">n-1</code> estimates for <code class="reqn">\sigma</code> obtained from <code><a href="#topic+GPDmle">GPDmle</a></code>.
</p>
</td></tr>
<tr><td><code id="QuantGPD_+3A_p">p</code></td>
<td>

<p>The exceedance probability of the quantile (we estimate <code class="reqn">Q(1-p)</code> for <code class="reqn">p</code> small).
</p>
</td></tr>
<tr><td><code id="QuantGPD_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the estimates should be plotted as a function of <code class="reqn">k</code>, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="QuantGPD_+3A_add">add</code></td>
<td>

<p>Logical indicating if the estimates should be added to an existing plot, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="QuantGPD_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"Estimates of extreme quantile"</code>.
</p>
</td></tr>
<tr><td><code id="QuantGPD_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See Section 4.2.2 in Albrecher et al. (2017) for more details.
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>k</code></td>
<td>
<p>Vector of the values of the tail parameter <code class="reqn">k</code>.</p>
</td></tr>
<tr><td><code>Q</code></td>
<td>
<p>Vector of the corresponding quantile estimates.</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>The used exceedance probability.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens.
</p>


<h3>References</h3>

<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>
<p>Beirlant J., Goegebeur Y., Segers, J. and Teugels, J. (2004). <em>Statistics of Extremes: Theory and Applications</em>, Wiley Series in Probability, Wiley, Chichester.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ProbGPD">ProbGPD</a></code>, <code><a href="#topic+GPDmle">GPDmle</a></code>, <code><a href="#topic+Quant">Quant</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(soa)

# Look at last 500 observations of SOA data
SOAdata &lt;- sort(soa$size)[length(soa$size)-(0:499)]

# GPD-ML estimator
pot &lt;- GPDmle(SOAdata)

# Large quantile
p &lt;- 10^(-5)
QuantGPD(SOAdata, p=p, gamma=pot$gamma, sigma=pot$sigma, plot=TRUE)
</code></pre>

<hr>
<h2 id='QuantMOM'>
Estimator of extreme quantiles using MOM
</h2><span id='topic+QuantMOM'></span>

<h3>Description</h3>

<p>Compute estimates of an extreme quantile <code class="reqn">Q(1-p)</code> using the Method of Moments estimates of the EVI.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>QuantMOM(data, gamma, p, plot = FALSE, add = FALSE, 
         main = "Estimates of extreme quantile", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="QuantMOM_+3A_data">data</code></td>
<td>

<p>Vector of <code class="reqn">n</code> observations.  
</p>
</td></tr>
<tr><td><code id="QuantMOM_+3A_gamma">gamma</code></td>
<td>

<p>Vector of <code class="reqn">n-1</code> estimates for the EVI obtained from <code><a href="#topic+Moment">Moment</a></code>.
</p>
</td></tr>
<tr><td><code id="QuantMOM_+3A_p">p</code></td>
<td>

<p>The exceedance probability of the quantile (we estimate <code class="reqn">Q(1-p)</code> for <code class="reqn">p</code> small).
</p>
</td></tr>
<tr><td><code id="QuantMOM_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the estimates should be plotted as a function of <code class="reqn">k</code>, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="QuantMOM_+3A_add">add</code></td>
<td>

<p>Logical indicating if the estimates should be added to an existing plot, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="QuantMOM_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"Estimates of extreme quantile"</code>.
</p>
</td></tr>
<tr><td><code id="QuantMOM_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See Section 4.2.2 of Albrecher et al. (2017) for more details.
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>k</code></td>
<td>
<p>Vector of the values of the tail parameter <code class="reqn">k</code>.</p>
</td></tr>
<tr><td><code>Q</code></td>
<td>
<p>Vector of the corresponding quantile estimates.</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>The used exceedance probability.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens.
</p>


<h3>References</h3>

<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>
<p>Beirlant J., Goegebeur Y., Segers, J. and Teugels, J. (2004). <em>Statistics of Extremes: Theory and Applications</em>, Wiley Series in Probability, Wiley, Chichester.
</p>
<p>Dekkers, A.L.M, Einmahl, J.H.J. and de Haan, L. (1989). &quot;A Moment Estimator for the Index of an Extreme-value Distribution.&quot; <em>Annals of Statistics</em>, 17, 1833&ndash;1855.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ProbMOM">ProbMOM</a></code>, <code><a href="#topic+Moment">Moment</a></code>, <code><a href="#topic+QuantGH">QuantGH</a></code>, <code><a href="#topic+Quant">Quant</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(soa)

# Look at last 500 observations of SOA data
SOAdata &lt;- sort(soa$size)[length(soa$size)-(0:499)]

# MOM estimator
M &lt;- Moment(SOAdata)

# Large quantile
p &lt;- 10^(-5)
QuantMOM(SOAdata, p=p, gamma=M$gamma, plot=TRUE)
</code></pre>

<hr>
<h2 id='QuantReg'>
Estimator of extreme quantiles in regression
</h2><span id='topic+QuantReg'></span>

<h3>Description</h3>

<p>Estimator of extreme quantile <code class="reqn">Q_i(1-p)</code> in the regression case where <code class="reqn">\gamma</code> is constant and the regression modelling is thus only solely placed on the scale parameter.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>QuantReg(Z, A, p, plot = FALSE, add = FALSE, 
         main = "Estimates of extreme quantile", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="QuantReg_+3A_z">Z</code></td>
<td>

<p>Vector of <code class="reqn">n</code> observations (from the response variable). 
</p>
</td></tr>
<tr><td><code id="QuantReg_+3A_a">A</code></td>
<td>

<p>Vector of <code class="reqn">n-1</code> estimates for <code class="reqn">A(i/n)</code> obtained from <code><a href="#topic+ScaleReg">ScaleReg</a></code>.
</p>
</td></tr>
<tr><td><code id="QuantReg_+3A_p">p</code></td>
<td>

<p>The exceedance probability of the quantile (we estimate <code class="reqn">Q_i(1-p)</code> for <code class="reqn">p</code> small).
</p>
</td></tr>
<tr><td><code id="QuantReg_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the estimates should be plotted as a function of <code class="reqn">k</code>, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="QuantReg_+3A_add">add</code></td>
<td>

<p>Logical indicating if the estimates should be added to an existing plot, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="QuantReg_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"Estimates of extreme quantile"</code>.
</p>
</td></tr>
<tr><td><code id="QuantReg_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The estimator is defined as
</p>
<p style="text-align: center;"><code class="reqn">\hat{Q}_i(1-p) = Z_{n-k,n} ((k+1)/((n+1)\times p) \hat{A}(i/n))^{H_{k,n}},</code>
</p>

<p>with <code class="reqn">H_{k,n}</code> the Hill estimator. Here, it is assumed that we have equidistant covariates <code class="reqn">x_i=i/n</code>.
</p>
<p>See Section 4.4.1 in Albrecher et al. (2017) for more details. 
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>k</code></td>
<td>
<p>Vector of the values of the tail parameter <code class="reqn">k</code>.</p>
</td></tr>
<tr><td><code>Q</code></td>
<td>
<p>Vector of the corresponding quantile estimates.</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>The used exceedance probability.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens.
</p>


<h3>References</h3>

<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ProbReg">ProbReg</a></code>, <code><a href="#topic+ScaleReg">ScaleReg</a></code>, <code><a href="#topic+Quant">Quant</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(norwegianfire)

Z &lt;- norwegianfire$size[norwegianfire$year==76]

i &lt;- 100
n &lt;- length(Z)

# Scale estimator in i/n
A &lt;- ScaleReg(i/n, Z, h=0.5, kernel = "epanechnikov")$A

# Small exceedance probability
q &lt;- 10^6
ProbReg(Z, A, q, plot=TRUE)

# Large quantile
p &lt;- 10^(-5)
QuantReg(Z, A, p, plot=TRUE)
</code></pre>

<hr>
<h2 id='Scale'>
Scale estimator
</h2><span id='topic+Scale'></span>

<h3>Description</h3>

<p>Computes the estimator for the scale parameter as described in Beirlant et al. (2016).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Scale(data, gamma = NULL, logk = FALSE, plot = FALSE, add = FALSE, 
      main = "Estimates of scale parameter", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Scale_+3A_data">data</code></td>
<td>

<p>Vector of <code class="reqn">n</code> observations. 
</p>
</td></tr>
<tr><td><code id="Scale_+3A_gamma">gamma</code></td>
<td>

<p>Vector of <code class="reqn">n-1</code> estimates for the EVI. When <code>NULL</code> (the default value), Hill estimates are computed.
</p>
</td></tr>
<tr><td><code id="Scale_+3A_logk">logk</code></td>
<td>

<p>Logical indicating if the estimates are plotted as a function of <code class="reqn">\log(k)</code> (<code>logk=TRUE</code>) or as a function of <code class="reqn">k</code>. Default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="Scale_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the estimates should be plotted as a function of <code class="reqn">k</code>, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="Scale_+3A_add">add</code></td>
<td>

<p>Logical indicating if the estimates should be added to an existing plot, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="Scale_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"Estimates of scale parameter"</code>.
</p>
</td></tr>
<tr><td><code id="Scale_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The scale estimates are computed based on the following model for the CDF:
<code class="reqn">1-F(x) = A x^{-1/\gamma}</code>, where <code class="reqn">A:= C^{1/\gamma}</code> is the scale parameter:
</p>
<p style="text-align: center;"><code class="reqn">\hat{A}_{k,n}=(k+1)/(n+1) X_{n-k,n}^{1/H_{k,n}}</code>
</p>

<p>where <code class="reqn">H_{k,n}</code> are the Hill estimates.
</p>
<p>See Section 4.2.1 of Albrecher et al. (2017) for more details.
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>k</code></td>
<td>
<p>Vector of the values of the tail parameter <code class="reqn">k</code>.</p>
</td></tr>
<tr><td><code>A</code></td>
<td>
<p>Vector of the corresponding scale estimates.</p>
</td></tr>
<tr><td><code>C</code></td>
<td>
<p>Vector of the corresponding estimates for <code class="reqn">C</code>, see Details.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens
</p>


<h3>References</h3>

<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>
<p>Beirlant, J., Schoutens, W., De Spiegeleer, J., Reynkens, T. and Herrmann, K. (2016).
&quot;Hunting for Black Swans in the European Banking Sector Using Extreme Value Analysis.&quot;
In: Jan Kallsen and Antonis Papapantoleon (eds.), <em>Advanced Modelling in Mathematical
Finance</em>, Springer International Publishing, Switzerland, pp. 147&ndash;166.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ScaleEPD">ScaleEPD</a></code>, <code><a href="#topic+Scale.2o">Scale.2o</a></code>, <code><a href="#topic+Hill">Hill</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(secura)

# Hill estimator
H &lt;- Hill(secura$size)

# Scale estimator
S &lt;- Scale(secura$size, gamma=H$gamma, plot=FALSE)

# Plot logarithm of scale          
plot(S$k,log(S$A), xlab="k", ylab="log(Scale)", type="l")
</code></pre>

<hr>
<h2 id='Scale.2o'>
Bias-reduced scale estimator using second order Hill estimator
</h2><span id='topic+Scale.2o'></span>

<h3>Description</h3>

<p>Computes the bias-reduced estimator for the scale parameter using the second-order Hill estimator.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Scale.2o(data, gamma, b, beta, logk = FALSE, plot = FALSE, add = FALSE, 
         main = "Estimates of scale parameter", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Scale.2o_+3A_data">data</code></td>
<td>

<p>Vector of <code class="reqn">n</code> observations. 
</p>
</td></tr>
<tr><td><code id="Scale.2o_+3A_gamma">gamma</code></td>
<td>

<p>Vector of <code class="reqn">n-1</code> estimates for the EVI obtained from <code>Hill.2oQV</code>.
</p>
</td></tr>
<tr><td><code id="Scale.2o_+3A_b">b</code></td>
<td>

<p>Vector of <code class="reqn">n-1</code> estimates for <code class="reqn">B</code> obtained from <code>Hill.2oQV</code>.
</p>
</td></tr>
<tr><td><code id="Scale.2o_+3A_beta">beta</code></td>
<td>

<p>Vector of <code class="reqn">n-1</code> estimates for <code class="reqn">\beta</code> obtained from <code>Hill.2oQV</code>.
</p>
</td></tr>
<tr><td><code id="Scale.2o_+3A_logk">logk</code></td>
<td>

<p>Logical indicating if the estimates are plotted as a function of <code class="reqn">\log(k)</code> (<code>logk=TRUE</code>) or as a function of <code class="reqn">k</code>. Default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="Scale.2o_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the estimates should be plotted as a function of <code class="reqn">k</code>, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="Scale.2o_+3A_add">add</code></td>
<td>

<p>Logical indicating if the estimates should be added to an existing plot, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="Scale.2o_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"Estimates of scale parameter"</code>.
</p>
</td></tr>
<tr><td><code id="Scale.2o_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The scale estimates are computed based on the following model for the CDF:
<code class="reqn">1-F(x) = A x^{-1/\gamma} ( 1+ bx^{-\beta}(1+o(1)) )</code>, where <code class="reqn">A:= C^{1/\gamma}</code> is the scale parameter.
</p>
<p>See Section 4.2.1 of Albrecher et al. (2017) for more details.
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>k</code></td>
<td>
<p>Vector of the values of the tail parameter <code class="reqn">k</code>.</p>
</td></tr>
<tr><td><code>A</code></td>
<td>
<p>Vector of the corresponding scale estimates.</p>
</td></tr>
<tr><td><code>C</code></td>
<td>
<p>Vector of the corresponding estimates for <code class="reqn">C</code>, see details.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens
</p>


<h3>References</h3>

<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>
<p>Beirlant, J., Schoutens, W., De Spiegeleer, J., Reynkens, T. and Herrmann, K. (2016).
&quot;Hunting for Black Swans in the European Banking Sector Using Extreme Value Analysis.&quot;
In: Jan Kallsen and Antonis Papapantoleon (eds.), <em>Advanced Modelling in Mathematical
Finance</em>, Springer International Publishing, Switzerland, pp. 147&ndash;166.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Scale">Scale</a></code>, <code><a href="#topic+ScaleEPD">ScaleEPD</a></code>, <code><a href="#topic+Hill.2oQV">Hill.2oQV</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(secura)

# Hill estimator
H &lt;- Hill(secura$size)
# Bias-reduced Hill estimator
H2o &lt;- Hill.2oQV(secura$size)

# Scale estimator
S &lt;- Scale(secura$size, gamma=H$gamma, plot=FALSE)
# Bias-reduced scale estimator
S2o &lt;- Scale.2o(secura$size, gamma=H2o$gamma, b=H2o$b, 
          beta=H2o$beta, plot=FALSE)

# Plot logarithm of scale             
plot(S$k,log(S$A), xlab="k", ylab="log(Scale)", type="l")
lines(S2o$k,log(S2o$A), lty=2)
</code></pre>

<hr>
<h2 id='ScaleEPD'>
Bias-reduced scale estimator using EPD estimator
</h2><span id='topic+ScaleEPD'></span>

<h3>Description</h3>

<p>Computes the bias-reduced estimator for the scale parameter using the EPD estimator (Beirlant et al., 2016).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ScaleEPD(data, gamma, kappa, logk = FALSE, plot = FALSE, add = FALSE, 
         main = "Estimates of scale parameter", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ScaleEPD_+3A_data">data</code></td>
<td>

<p>Vector of <code class="reqn">n</code> observations. 
</p>
</td></tr>
<tr><td><code id="ScaleEPD_+3A_gamma">gamma</code></td>
<td>

<p>Vector of <code class="reqn">n-1</code> estimates for the EVI obtained from <code>EPD</code>.
</p>
</td></tr>
<tr><td><code id="ScaleEPD_+3A_kappa">kappa</code></td>
<td>

<p>Vector of <code class="reqn">n-1</code> estimates for <code class="reqn">\kappa</code> obtained from <code>EPD</code>.
</p>
</td></tr>
<tr><td><code id="ScaleEPD_+3A_logk">logk</code></td>
<td>

<p>Logical indicating if the estimates are plotted as a function of <code class="reqn">\log(k)</code> (<code>logk=TRUE</code>) or as a function of <code class="reqn">k</code>. Default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="ScaleEPD_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the estimates should be plotted as a function of <code class="reqn">k</code>, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="ScaleEPD_+3A_add">add</code></td>
<td>

<p>Logical indicating if the estimates should be added to an existing plot, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="ScaleEPD_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"Estimates of scale parameter"</code>.
</p>
</td></tr>
<tr><td><code id="ScaleEPD_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The scale estimates are computed based on the following model for the CDF:
<code class="reqn">1-F(x) = A x^{-1/\gamma} ( 1+ bx^{-\beta}(1+o(1)) )</code>, where <code class="reqn">A:= C^{1/\gamma}</code> is the scale parameter.
Using the EPD approach we replace <code class="reqn">bx^{-\beta}</code> by <code class="reqn">\kappa/\gamma</code>.
</p>
<p>See Section 4.2.1 of Albrecher et al. (2017) for more details.
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>k</code></td>
<td>
<p>Vector of the values of the tail parameter <code class="reqn">k</code>.</p>
</td></tr>
<tr><td><code>A</code></td>
<td>
<p>Vector of the corresponding scale estimates.</p>
</td></tr>
<tr><td><code>C</code></td>
<td>
<p>Vector of the corresponding estimates for <code class="reqn">C</code>, see details.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens
</p>


<h3>References</h3>

<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>
<p>Beirlant, J., Schoutens, W., De Spiegeleer, J., Reynkens, T. and Herrmann, K. (2016).
&quot;Hunting for Black Swans in the European Banking Sector Using Extreme Value Analysis.&quot;
In: Jan Kallsen and Antonis Papapantoleon (eds.), <em>Advanced Modelling in Mathematical
Finance</em>, Springer International Publishing, Switzerland, pp. 147&ndash;166.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Scale">Scale</a></code>, <code><a href="#topic+Scale.2o">Scale.2o</a></code>, <code><a href="#topic+EPD">EPD</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(secura)

# Hill estimator
H &lt;- Hill(secura$size)
# EPD estimator
epd &lt;- EPD(secura$size)

# Scale estimator
S &lt;- Scale(secura$size, gamma=H$gamma, plot=FALSE)
# Bias-reduced scale estimator
Sepd &lt;- ScaleEPD(secura$size, gamma=epd$gamma, kappa=epd$kappa, plot=FALSE)

# Plot logarithm of scale             
plot(S$k,log(S$A), xlab="k", ylab="log(Scale)", type="l")
lines(Sepd$k,log(Sepd$A), lty=2)
</code></pre>

<hr>
<h2 id='ScaleReg'>
Scale estimator in regression
</h2><span id='topic+ScaleReg'></span>

<h3>Description</h3>

<p>Estimator of the scale parameter in the regression case where <code class="reqn">\gamma</code> is constant and the regression modelling is thus placed solely on the scale parameter.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ScaleReg(s, Z, kernel = c("normal", "uniform", "triangular", "epanechnikov", "biweight"), 
         h, plot = TRUE, add = FALSE, main = "Estimates of scale parameter", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ScaleReg_+3A_s">s</code></td>
<td>

<p>Point to evaluate the scale estimator in.
</p>
</td></tr>
<tr><td><code id="ScaleReg_+3A_z">Z</code></td>
<td>

<p>Vector of <code class="reqn">n</code> observations (from the response variable). 
</p>
</td></tr>
<tr><td><code id="ScaleReg_+3A_kernel">kernel</code></td>
<td>

<p>The kernel used in the estimator. One of <code>"normal"</code> (default), <code>"uniform"</code>, <code>"triangular"</code>, <code>"epanechnikov"</code> and <code>"biweight"</code>.
</p>
</td></tr>
<tr><td><code id="ScaleReg_+3A_h">h</code></td>
<td>

<p>The bandwidth used in the kernel function.
</p>
</td></tr>
<tr><td><code id="ScaleReg_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the estimates should be plotted as a function of <code class="reqn">k</code>, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="ScaleReg_+3A_add">add</code></td>
<td>

<p>Logical indicating if the estimates should be added to an existing plot, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="ScaleReg_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"Estimates of scale parameter"</code>.
</p>
</td></tr>
<tr><td><code id="ScaleReg_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The scale estimator is computed as
</p>
<p style="text-align: center;"><code class="reqn">\hat{A}(s) = 1/(k+1) \sum_{i=1}^n 1_{Z_i&gt;Z_{n-k,n}} K_h(s-i/n)</code>
</p>

<p>with <code class="reqn">K_h(x)=K(x/h)/h,</code> <code class="reqn">K</code> the kernel function and <code class="reqn">h</code> the bandwidth.
Here, it is assumed that we have equidistant covariates <code class="reqn">x_i=i/n</code>.
</p>
<p>See Section 4.4.1 in Albrecher et al. (2017) for more details.
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>k</code></td>
<td>
<p>Vector of the values of the tail parameter <code class="reqn">k</code>.</p>
</td></tr>
<tr><td><code>A</code></td>
<td>
<p>Vector of the corresponding scale estimates.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens
</p>


<h3>References</h3>

<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ProbReg">ProbReg</a></code>, <code><a href="#topic+QuantReg">QuantReg</a></code>, <code><a href="base.html#topic+scale">scale</a></code>, <code><a href="#topic+Hill">Hill</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(norwegianfire)

Z &lt;- norwegianfire$size[norwegianfire$year==76]

i &lt;- 100
n &lt;- length(Z)

# Scale estimator in i/n
A &lt;- ScaleReg(i/n, Z, h=0.5, kernel = "epanechnikov")$A

# Small exceedance probability
q &lt;- 10^6
ProbReg(Z, A, q, plot=TRUE)

# Large quantile
p &lt;- 10^(-5)
QuantReg(Z, A, p, plot=TRUE)
</code></pre>

<hr>
<h2 id='secura'>
Secura dataset
</h2><span id='topic+secura'></span>

<h3>Description</h3>

<p>Automobile claims from 1988 to 2001, gathered from several European insurance companies, exceeding 1 200 000 Euro. Note that the data were, among others, corrected for inflation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("secura")</code></pre>


<h3>Format</h3>

<p>A data frame with 371 observations on the following 2 variables:
</p>

<dl>
<dt><code>year</code></dt><dd><p>Year of claim occurence.</p>
</dd>
<dt><code>size</code></dt><dd><p>Size of automobile insurance claim (in EUR).</p>
</dd>
</dl>



<h3>References</h3>

<p>Beirlant J., Goegebeur Y., Segers, J. and Teugels, J. (2004). <em>Statistics of Extremes: Theory and Applications</em>, Wiley Series in Probability, Wiley, Chichester.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(secura)

# Exponential QQ-plot of Secura data
ExpQQ(secura$size)

# Pareto QQ-plot of Secura data
ParetoQQ(secura$size)

# Mean excess plot of Secura data (function of k)
MeanExcess(secura$size, k=TRUE)

# Mean excess plot of Secura data (function of order statistics)
MeanExcess(secura$size, k=FALSE)
</code></pre>

<hr>
<h2 id='soa'>
SOA Group Medical Insurance Large Claims Database
</h2><span id='topic+soa'></span>

<h3>Description</h3>

<p>The SOA Group Medical Insurance Large Claims Database records, among others, all the claim amounts exceeding 25,000 USD in the year 1991.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("soa")</code></pre>


<h3>Format</h3>

<p>A data frame with 75789 observations on the following variable:
</p>

<dl>
<dt><code>size</code></dt><dd><p>Claim size (in USD).</p>
</dd>
</dl>



<h3>Source</h3>

<p>Grazier, K. L. and G'Sell Associates (1997). <em>Group Medical Insurance Large Claims Database Collection and Analysis</em>. SOA Monograph M-HB97-1, Society of Actuaries, Schaumburg.
</p>
<p>Society of Actuaries, <a href="https://www.soa.org/resources/experience-studies/2000-2004/91-92-group-medical-claims/">https://www.soa.org/resources/experience-studies/2000-2004/91-92-group-medical-claims/</a>.
</p>


<h3>References</h3>

<p>Beirlant J., Goegebeur Y., Segers, J. and Teugels, J. (2004). <em>Statistics of Extremes: Theory and Applications</em>, Wiley Series in Probability, Wiley, Chichester.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(soa)

# Histogram of log-claim amount
hist(log(soa$size),breaks=seq(10,16,0.2),xlab="log(Claim size)")

# Exponential QQ-plot of claim amount
ExpQQ(soa$size)

# Mean excess plot of claim amount (function of k)
MeanExcess(soa$size, k=TRUE)

# Mean excess plot of claim amount (function of order statistics)
MeanExcess(soa$size, k=FALSE)
</code></pre>

<hr>
<h2 id='Splice'>
Spliced distribution
</h2><span id='topic+dSplice'></span><span id='topic+pSplice'></span><span id='topic+qSplice'></span><span id='topic+rSplice'></span>

<h3>Description</h3>

<p>Density, distribution function, quantile function and random generation for the fitted spliced distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dSplice(x, splicefit, log = FALSE)

pSplice(x, splicefit, lower.tail = TRUE, log.p = FALSE)

qSplice(p, splicefit, lower.tail = TRUE, log.p = FALSE)

rSplice(n, splicefit)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Splice_+3A_x">x</code></td>
<td>

<p>Vector of points to evaluate the CDF or PDF in.
</p>
</td></tr>
<tr><td><code id="Splice_+3A_p">p</code></td>
<td>

<p>Vector of probabilities.
</p>
</td></tr>
<tr><td><code id="Splice_+3A_n">n</code></td>
<td>

<p>Number of observations.
</p>
</td></tr>
<tr><td><code id="Splice_+3A_splicefit">splicefit</code></td>
<td>

<p>A <code><a href="#topic+SpliceFit">SpliceFit</a></code> object,  e.g. output from <code><a href="#topic+SpliceFitPareto">SpliceFitPareto</a></code>, <code><a href="#topic+SpliceFiticPareto">SpliceFiticPareto</a></code> or <code><a href="#topic+SpliceFitGPD">SpliceFitGPD</a></code>.
</p>
</td></tr>
<tr><td><code id="Splice_+3A_log">log</code></td>
<td>

<p>Logical indicating if the densities are given as <code class="reqn">\log(f)</code>, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="Splice_+3A_lower.tail">lower.tail</code></td>
<td>

<p>Logical indicating if the probabilities are of the form <code class="reqn">P(X\le x)</code> (<code>TRUE</code>) or <code class="reqn">P(X&gt;x)</code> (<code>FALSE</code>). Default is <code>TRUE.</code>
</p>
</td></tr>
<tr><td><code id="Splice_+3A_log.p">log.p</code></td>
<td>

<p>Logical indicating if the probabilities are given as <code class="reqn">\log(p)</code>, default is <code>FALSE</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

 
<p>See Reynkens et al. (2017) and Section 4.3 in Albrecher et al. (2017) for details.
</p>


<h3>Value</h3>

<p><code>dSplice</code> gives the density function evaluated in <code class="reqn">x</code>, <code>pSplice</code> the CDF evaluated in <code class="reqn">x</code> and <code>qSplice</code> the quantile function evaluated in <code class="reqn">p</code>. The length of the result is equal to the length of <code class="reqn">x</code> or <code class="reqn">p</code>.
</p>
<p><code>rSplice</code> returns a random sample of length <code class="reqn">n</code>.
</p>


<h3>Author(s)</h3>

<p>Tom Reynkens with <code>R</code> code from Roel Verbelen for the mixed Erlang PDF, CDF and quantiles.
</p>


<h3>References</h3>

<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>
<p>Reynkens, T., Verbelen, R., Beirlant, J. and Antonio, K. (2017). &quot;Modelling Censored Losses Using Splicing:
a Global Fit Strategy With Mixed Erlang and Extreme Value Distributions&quot;. <em>Insurance: Mathematics and Economics</em>, 77, 65&ndash;77.
</p>
<p>Verbelen, R., Gong, L., Antonio, K., Badescu, A. and Lin, S. (2015). &quot;Fitting Mixtures of
Erlangs to Censored and Truncated Data Using the EM Algorithm.&quot; <em>Astin Bulletin</em>, 45, 729&ndash;758.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+VaR">VaR</a></code>, <code><a href="#topic+SpliceFit">SpliceFit</a></code>, <code><a href="#topic+SpliceFitPareto">SpliceFitPareto</a></code>, <code><a href="#topic+SpliceFiticPareto">SpliceFiticPareto</a></code>, <code><a href="#topic+SpliceFitGPD">SpliceFitGPD</a></code>,
<code><a href="#topic+SpliceECDF">SpliceECDF</a></code>, <code><a href="#topic+SpliceLL">SpliceLL</a></code>, <code><a href="#topic+SplicePP">SplicePP</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

# Pareto random sample
X &lt;- rpareto(1000, shape = 2)

# Splice ME and Pareto
splicefit &lt;- SpliceFitPareto(X, 0.6)



x &lt;- seq(0, 20, 0.01)

# Plot of spliced CDF
plot(x, pSplice(x, splicefit), type="l", xlab="x", ylab="F(x)")

# Plot of spliced PDF
plot(x, dSplice(x, splicefit), type="l", xlab="x", ylab="f(x)")



p &lt;- seq(0, 1, 0.01)

# Plot of splicing quantiles
plot(p, qSplice(p, splicefit), type="l", xlab="p", ylab="Q(p)")

# Plot of VaR
plot(p, VaR(p, splicefit), type="l", xlab="p", ylab=bquote(VaR[p]))



# Random sample from spliced distribution
x &lt;- rSplice(1000, splicefit)


## End(Not run)
</code></pre>

<hr>
<h2 id='SpliceECDF'>
Plot of fitted and empirical survival function
</h2><span id='topic+SpliceECDF'></span>

<h3>Description</h3>

<p>This function plots the fitted survival function of the spliced distribution together with the
empirical survival function (determined using the Empirical CDF (ECDF)). Moreover, <code class="reqn">100(1-\alpha)\%</code> confidence bands are added.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SpliceECDF(x, X, splicefit, alpha = 0.05, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SpliceECDF_+3A_x">x</code></td>
<td>

<p>Vector of points to plot the functions at.
</p>
</td></tr>
<tr><td><code id="SpliceECDF_+3A_x">X</code></td>
<td>

<p>Data used for fitting the distribution.
</p>
</td></tr>
<tr><td><code id="SpliceECDF_+3A_splicefit">splicefit</code></td>
<td>

<p>A <code><a href="#topic+SpliceFit">SpliceFit</a></code> object, e.g. output from <code><a href="#topic+SpliceFitPareto">SpliceFitPareto</a></code> or <code><a href="#topic+SpliceFitGPD">SpliceFitGPD</a></code>.
</p>
</td></tr>
<tr><td><code id="SpliceECDF_+3A_alpha">alpha</code></td>
<td>

<p><code class="reqn">100(1-\alpha)\%</code> is the confidence level for the confidence bands.  Default is <code class="reqn">\alpha=0.05</code>.
</p>
</td></tr>
<tr><td><code id="SpliceECDF_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Use <code><a href="#topic+SpliceTB">SpliceTB</a></code> for censored data. 
</p>
<p>Confidence bands are determined using the Dvoretzky-Kiefer-Wolfowitz inequality (Massart, 1990).
</p>
<p>See Reynkens et al. (2017) and Section 4.3.1 in Albrecher et al. (2017) for more details.
</p>


<h3>Author(s)</h3>

<p>Tom Reynkens
</p>


<h3>References</h3>

<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>
<p>Massart, P. (1990). The Tight Constant in the Dvoretzky-Kiefer-Wolfowitz Inequality.  <em>Annals of Probability</em>, 18, 1269&ndash;1283.
</p>
<p>Reynkens, T., Verbelen, R., Beirlant, J. and Antonio, K. (2017). &quot;Modelling Censored Losses Using Splicing:
a Global Fit Strategy With Mixed Erlang and Extreme Value Distributions&quot;. <em>Insurance: Mathematics and Economics</em>, 77, 65&ndash;77.
</p>
<p>Verbelen, R., Gong, L., Antonio, K., Badescu, A. and Lin, S. (2015). &quot;Fitting Mixtures of
Erlangs to Censored and Truncated Data Using the EM Algorithm.&quot; <em>Astin Bulletin</em>, 45, 729&ndash;758.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+SpliceTB">SpliceTB</a></code>, <code><a href="#topic+pSplice">pSplice</a></code>, <code><a href="stats.html#topic+ecdf">ecdf</a></code>, <code><a href="#topic+SpliceFitPareto">SpliceFitPareto</a></code>, <code><a href="#topic+SpliceFitGPD">SpliceFitGPD</a></code>, <code><a href="#topic+SpliceLL">SpliceLL</a></code>, <code><a href="#topic+SplicePP">SplicePP</a></code>, <code><a href="#topic+SpliceQQ">SpliceQQ</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

# Pareto random sample
X &lt;- rpareto(1000, shape = 2)

# Splice ME and Pareto
splicefit &lt;- SpliceFitPareto(X, 0.6)



x &lt;- seq(0, 20, 0.01)

# Plot of spliced CDF
plot(x, pSplice(x, splicefit), type="l", xlab="x", ylab="F(x)")

# Plot of spliced PDF
plot(x, dSplice(x, splicefit), type="l", xlab="x", ylab="f(x)")



# Fitted survival function and empirical survival function 
SpliceECDF(x, X, splicefit)

# Log-log plot with empirical survival function and fitted survival function
SpliceLL(x, X, splicefit)

# PP-plot of empirical survival function and fitted survival function
SplicePP(X, splicefit)

# PP-plot of empirical survival function and 
# fitted survival function with log-scales
SplicePP(X, splicefit, log=TRUE)

# Splicing QQ-plot
SpliceQQ(X, splicefit)

## End(Not run)
</code></pre>

<hr>
<h2 id='SpliceFit'>
Splicing fit
</h2><span id='topic+SpliceFit'></span>

<h3>Description</h3>

<p>Create an S3 object using ME-Pa or ME-GPD splicing fit obtained from <code><a href="#topic+SpliceFitPareto">SpliceFitPareto</a></code>, <code><a href="#topic+SpliceFiticPareto">SpliceFiticPareto</a></code> or
<code><a href="#topic+SpliceFitGPD">SpliceFitGPD</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SpliceFit(const, trunclower, t, type, MEfit, EVTfit, loglik = NULL, IC = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SpliceFit_+3A_const">const</code></td>
<td>

<p>Vector of splicing constants or a single splicing constant.
</p>
</td></tr>
<tr><td><code id="SpliceFit_+3A_trunclower">trunclower</code></td>
<td>

<p>Lower truncation point.
</p>
</td></tr>
<tr><td><code id="SpliceFit_+3A_t">t</code></td>
<td>

<p>Vector of splicing points or a single splicing point.
</p>
</td></tr>
<tr><td><code id="SpliceFit_+3A_type">type</code></td>
<td>

<p>Vector of types of the distributions:  <code>"ME"</code> and then for each fitted EVT distribution: <code>"Pa"</code> (Pareto), <code>"TPa"</code> (truncated Pareto) or <code>"GPD"</code> (GPD).
</p>
</td></tr>
<tr><td><code id="SpliceFit_+3A_mefit">MEfit</code></td>
<td>

<p><code><a href="#topic+MEfit">MEfit</a></code> object with details on the mixed Erlang fit.
</p>
</td></tr>
<tr><td><code id="SpliceFit_+3A_evtfit">EVTfit</code></td>
<td>

<p><code><a href="#topic+EVTfit">EVTfit</a></code> object with details on the EVT fit.
</p>
</td></tr>
<tr><td><code id="SpliceFit_+3A_loglik">loglik</code></td>
<td>

<p>Log-likelihood of the fitted model. When <code>NULL</code> (default), not included in the object. 
</p>
</td></tr>
<tr><td><code id="SpliceFit_+3A_ic">IC</code></td>
<td>

<p>Information criteria of the fitted model. When <code>NULL</code> (default), not included in the object. 
This vector should have length 1, 2 or 3 when included.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See Reynkens et al. (2017) and Section 4.3 in Albrecher et al. (2017) for details.
</p>


<h3>Value</h3>

<p>An S3 object containing the above input arguments and values for <code class="reqn">\pi</code>, the splicing weights.
These splicing weights are equal to </p>
<p style="text-align: center;"><code class="reqn">\pi_1=const_1,   \pi_2=const_2-const_1, ...,\pi_{l+1}=1-const_l=1-(\pi_1+...+\pi_l)</code>
</p>
<p> when <code class="reqn">l\ge 2</code> and
</p>
<p style="text-align: center;"><code class="reqn">\pi_1=const_1, \pi_2=1-const_1=1-\pi_1</code>
</p>
<p> when <code class="reqn">l=1</code>, where <code class="reqn">l</code> is the length of <code>const</code>.
</p>
<p>A summary method is available.
</p>


<h3>Author(s)</h3>

<p>Tom Reynkens
</p>


<h3>References</h3>

<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>
<p>Reynkens, T., Verbelen, R., Beirlant, J. and Antonio, K. (2017). &quot;Modelling Censored Losses Using Splicing:
a Global Fit Strategy With Mixed Erlang and Extreme Value Distributions&quot;. <em>Insurance: Mathematics and Economics</em>, 77, 65&ndash;77.
</p>
<p>Verbelen, R., Gong, L., Antonio, K., Badescu, A. and Lin, S. (2015). &quot;Fitting Mixtures of
Erlangs to Censored and Truncated Data Using the EM Algorithm.&quot; <em>Astin Bulletin</em>, 45, 729&ndash;758
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MEfit">MEfit</a></code>, <code><a href="#topic+EVTfit">EVTfit</a></code>, <code><a href="#topic+SpliceFitPareto">SpliceFitPareto</a></code>, <code><a href="#topic+SpliceFiticPareto">SpliceFiticPareto</a></code>, <code><a href="#topic+SpliceFitGPD">SpliceFitGPD</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Create MEfit object
mefit &lt;- MEfit(p=c(0.65,0.35), shape=c(39,58), theta=16.19, M=2)

# Create EVTfit object
evtfit &lt;- EVTfit(gamma=c(0.76,0.64), endpoint=c(39096, Inf))

# Create SpliceFit object
splicefit &lt;- SpliceFit(const=c(0.5,0.996), trunclower=0, t=c(1020,39096), type=c("ME","TPa","Pa"),
                       MEfit=mefit, EVTfit=evtfit)

# Show summary
summary(splicefit)
</code></pre>

<hr>
<h2 id='SpliceFitGPD'>
Splicing of mixed Erlang and GPD using POT-MLE
</h2><span id='topic+SpliceFitGPD'></span>

<h3>Description</h3>

<p>Fit spliced distribution of a mixed Erlang distribution and a Generalised Pareto Distribution (GPD). The parameters of the GPD are determined using the POT-MLE approach. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SpliceFitGPD(X, const = NULL, tsplice = NULL, M = 3, s = 1:10, trunclower = 0, 
             ncores = NULL, criterium = c("BIC","AIC"), reduceM = TRUE,
             eps = 10^(-3), beta_tol = 10^(-5), maxiter = Inf)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SpliceFitGPD_+3A_x">X</code></td>
<td>

<p>Data used for fitting the distribution.
</p>
</td></tr>
<tr><td><code id="SpliceFitGPD_+3A_const">const</code></td>
<td>

<p>The probability of the quantile where the ME distribution will be spliced with the GPD distribution. Default is <code>NULL</code> meaning the input from <code>tsplice</code> is used.
</p>
</td></tr>
<tr><td><code id="SpliceFitGPD_+3A_tsplice">tsplice</code></td>
<td>

<p>The point where the ME distribution will be spliced with the GPD distribution. Default is <code>NULL</code> meaning the input from <code>const</code> is used.
</p>
</td></tr>
<tr><td><code id="SpliceFitGPD_+3A_m">M</code></td>
<td>

<p>Initial number of Erlang mixtures, default is 3. This number can change when determining
an optimal mixed Erlang fit using an information criterion.
</p>
</td></tr>
<tr><td><code id="SpliceFitGPD_+3A_s">s</code></td>
<td>

<p>Vector of spread factors for the EM algorithm, default is <code>1:10</code>. We loop over these factors when determining
an optimal mixed Erlang fit using an information criterion, see Verbelen et al. (2016).
</p>
</td></tr>
<tr><td><code id="SpliceFitGPD_+3A_trunclower">trunclower</code></td>
<td>

<p>Lower truncation point. Default is 0.
</p>
</td></tr>
<tr><td><code id="SpliceFitGPD_+3A_ncores">ncores</code></td>
<td>

<p>Number of cores to use when determining an optimal mixed Erlang fit using an information criterion.
When <code>NULL</code> (default), <code>max(nc-1,1)</code> cores are used where <code>nc</code> is the number of cores as determined by <code><a href="parallel.html#topic+detectCores">detectCores</a></code>.
</p>
</td></tr>
<tr><td><code id="SpliceFitGPD_+3A_criterium">criterium</code></td>
<td>

<p>Information criterion used to select the number of components of the ME fit and <code>s</code>. One of <code>"AIC"</code> and <code>"BIC"</code> (default).
</p>
</td></tr>
<tr><td><code id="SpliceFitGPD_+3A_reducem">reduceM</code></td>
<td>

<p>Logical indicating if M should be reduced based on the information criterion, default is <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="SpliceFitGPD_+3A_eps">eps</code></td>
<td>

<p>Covergence threshold used in the EM algorithm (ME part). Default is <code>10^(-3)</code>.
</p>
</td></tr>
<tr><td><code id="SpliceFitGPD_+3A_beta_tol">beta_tol</code></td>
<td>

<p>Threshold for the mixing weights below which the corresponding shape parameter vector is considered neglectable (ME part). Default is <code>10^(-5)</code>.
</p>
</td></tr>
<tr><td><code id="SpliceFitGPD_+3A_maxiter">maxiter</code></td>
<td>

<p>Maximum number of iterations in a single EM algorithm  execution (ME part). Default is <code>Inf</code> meaning no maximum number of iterations.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See Reynkens et al. (2017), Section 4.3.1 of Albrecher et al. (2017) and Verbelen et al. (2015) for details. The code follows the notation of the latter. Initial values follow from Verbelen et al. (2016).
</p>


<h3>Value</h3>

<p>A <code><a href="#topic+SpliceFit">SpliceFit</a></code> object.
</p>


<h3>Author(s)</h3>

<p>Tom Reynkens with <code>R</code> code from Roel Verbelen for fitting the mixed Erlang distribution.
</p>


<h3>References</h3>

<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>
<p>Reynkens, T., Verbelen, R., Beirlant, J. and Antonio, K. (2017). &quot;Modelling Censored Losses Using Splicing:
a Global Fit Strategy With Mixed Erlang and Extreme Value Distributions&quot;. <em>Insurance: Mathematics and Economics</em>, 77, 65&ndash;77.
</p>
<p>Verbelen, R., Gong, L., Antonio, K., Badescu, A. and Lin, S. (2015). &quot;Fitting Mixtures of
Erlangs to Censored and Truncated Data Using the EM Algorithm.&quot; <em>Astin Bulletin</em>, 45, 729&ndash;758.
</p>
<p>Verbelen, R., Antonio, K. and Claeskens, G. (2016). &quot;Multivariate Mixtures
of Erlangs for Density Estimation Under Censoring.&quot; <em>Lifetime Data Analysis</em>, 22, 429&ndash;455.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+SpliceFitPareto">SpliceFitPareto</a></code>, <code><a href="#topic+SpliceFiticPareto">SpliceFiticPareto</a></code>, <code><a href="#topic+pSplice">Splice</a></code>,
<code><a href="#topic+GPDfit">GPDfit</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

# GPD random sample
X &lt;- rgpd(1000, gamma = 0.5, sigma = 2)

# Splice ME and GPD
splicefit &lt;- SpliceFitGPD(X, 0.6)



x &lt;- seq(0, 20, 0.01)

# Plot of spliced CDF
plot(x, pSplice(x, splicefit), type="l", xlab="x", ylab="F(x)")

# Plot of spliced PDF
plot(x, dSplice(x, splicefit), type="l", xlab="x", ylab="f(x)")



# Fitted survival function and empirical survival function 
SpliceECDF(x, X, splicefit)

# Log-log plot with empirical survival function and fitted survival function
SpliceLL(x, X, splicefit)

# PP-plot of empirical survival function and fitted survival function
SplicePP(X, splicefit)

# PP-plot of empirical survival function and 
# fitted survival function with log-scales
SplicePP(X, splicefit, log=TRUE)

# Splicing QQ-plot
SpliceQQ(X, splicefit)

## End(Not run)
</code></pre>

<hr>
<h2 id='SpliceFiticPareto'>
Splicing of mixed Erlang and Pareto for interval censored data
</h2><span id='topic+SpliceFiticPareto'></span>

<h3>Description</h3>

<p>Fit spliced distribution of a mixed Erlang distribution and a Pareto distribution adapted for interval censoring and truncation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SpliceFiticPareto(L, U, censored, tsplice, M = 3, s = 1:10, trunclower = 0, 
                  truncupper = Inf, ncores = NULL, criterium = c("BIC", "AIC"), 
                  reduceM = TRUE, eps = 10^(-3), beta_tol = 10^(-5), maxiter = Inf, 
                  cpp = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SpliceFiticPareto_+3A_l">L</code></td>
<td>

<p>Vector of length <code class="reqn">n</code> with the lower boundaries of the intervals for interval censored data or the observed data for right censored data.
</p>
</td></tr>
<tr><td><code id="SpliceFiticPareto_+3A_u">U</code></td>
<td>

<p>Vector of length <code class="reqn">n</code> with the upper boundaries of the intervals.
</p>
</td></tr>
<tr><td><code id="SpliceFiticPareto_+3A_censored">censored</code></td>
<td>

<p>A logical vector of length <code class="reqn">n</code> indicating if an observation is censored.
</p>
</td></tr>
<tr><td><code id="SpliceFiticPareto_+3A_tsplice">tsplice</code></td>
<td>

<p>The splicing point <code class="reqn">t</code>.
</p>
</td></tr>
<tr><td><code id="SpliceFiticPareto_+3A_m">M</code></td>
<td>

<p>Initial number of Erlang mixtures, default is 3. This number can change when determining
an optimal mixed Erlang fit using an information criterion.
</p>
</td></tr>
<tr><td><code id="SpliceFiticPareto_+3A_s">s</code></td>
<td>

<p>Vector of spread factors for the EM algorithm, default is <code>1:10</code>. We loop over these factors when determining
an optimal mixed Erlang fit using an information criterion, see Verbelen et al. (2016).
</p>
</td></tr>
<tr><td><code id="SpliceFiticPareto_+3A_trunclower">trunclower</code></td>
<td>

<p>Lower truncation point. Default is 0.
</p>
</td></tr>
<tr><td><code id="SpliceFiticPareto_+3A_truncupper">truncupper</code></td>
<td>

<p>Upper truncation point. Default is <code>Inf</code> (no upper truncation).
</p>
</td></tr>
<tr><td><code id="SpliceFiticPareto_+3A_ncores">ncores</code></td>
<td>

<p>Number of cores to use when determining an optimal mixed Erlang fit using an information criterion.
When <code>NULL</code> (default), <code>max(nc-1,1)</code> cores are used where <code>nc</code> is the number of cores as determined by <code><a href="parallel.html#topic+detectCores">detectCores</a></code>.
</p>
</td></tr>
<tr><td><code id="SpliceFiticPareto_+3A_criterium">criterium</code></td>
<td>

<p>Information criterion used to select the number of components of the ME fit and <code>s</code>. One of <code>"AIC"</code> and <code>"BIC"</code> (default).
</p>
</td></tr>
<tr><td><code id="SpliceFiticPareto_+3A_reducem">reduceM</code></td>
<td>

<p>Logical indicating if M should be reduced based on the information criterion, default is <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="SpliceFiticPareto_+3A_eps">eps</code></td>
<td>

<p>Covergence threshold used in the EM algorithm. Default is <code>10^(-3)</code>.
</p>
</td></tr>
<tr><td><code id="SpliceFiticPareto_+3A_beta_tol">beta_tol</code></td>
<td>

<p>Threshold for the mixing weights below which the corresponding shape parameter vector is considered neglectable (ME part). Default is <code>10^(-5)</code>.
</p>
</td></tr>
<tr><td><code id="SpliceFiticPareto_+3A_maxiter">maxiter</code></td>
<td>

<p>Maximum number of iterations in a single EM algorithm execution. Default is <code>Inf</code> meaning no maximum number of iterations.
</p>
</td></tr>
<tr><td><code id="SpliceFiticPareto_+3A_cpp">cpp</code></td>
<td>

<p>Use <code>C++</code> implementation (<code>cpp=TRUE</code>) or <code>R</code> implementation (<code>cpp=FALSE</code>) of the algorithm. Default is <code>FALSE</code> meaning the plain <code>R</code> implementation is used.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See Reynkens et al. (2017), Section 4.3.2 of Albrecher et al. (2017) and Verbelen et al. (2015) for details. The code follows the notation of the latter. Initial values follow from Verbelen et al. (2016).
</p>
<p>Right censored data should be entered as <code>L=l</code> and <code>U=truncupper</code>, and left censored data should be entered as <code>L=trunclower</code> and <code>U=u</code>. 
</p>


<h3>Value</h3>

<p>A <code><a href="#topic+SpliceFit">SpliceFit</a></code> object.
</p>


<h3>Author(s)</h3>

<p>Tom Reynkens based on <code>R</code> code from Roel Verbelen for fitting the mixed Erlang distribution (without splicing).
</p>


<h3>References</h3>

<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>
<p>Reynkens, T., Verbelen, R., Beirlant, J. and Antonio, K. (2017). &quot;Modelling Censored Losses Using Splicing:
a Global Fit Strategy With Mixed Erlang and Extreme Value Distributions&quot;. <em>Insurance: Mathematics and Economics</em>, 77, 65&ndash;77.
</p>
<p>Verbelen, R., Gong, L., Antonio, K., Badescu, A. and Lin, S. (2015). &quot;Fitting Mixtures of
Erlangs to Censored and Truncated Data Using the EM Algorithm.&quot; <em>Astin Bulletin</em>, 45, 729&ndash;758.
</p>
<p>Verbelen, R., Antonio, K. and Claeskens, G. (2016). &quot;Multivariate Mixtures
of Erlangs for Density Estimation Under Censoring.&quot; <em>Lifetime Data Analysis</em>, 22, 429&ndash;455.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+SpliceFitPareto">SpliceFitPareto</a></code>, <code><a href="#topic+SpliceFitGPD">SpliceFitGPD</a></code>, <code><a href="#topic+pSplice">Splice</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

# Pareto random sample
X &lt;- rpareto(500, shape=2)

# Censoring variable
Y &lt;- rpareto(500, shape=1)

# Observed sample
Z &lt;- pmin(X,Y)

# Censoring indicator
censored &lt;- (X&gt;Y)

# Right boundary
U &lt;- Z
U[censored] &lt;- Inf

# Splice ME and Pareto
splicefit &lt;- SpliceFiticPareto(L=Z, U=U, censored=censored, tsplice=quantile(Z,0.9))



x &lt;- seq(0,20,0.1)

# Plot of spliced CDF
plot(x, pSplice(x, splicefit), type="l", xlab="x", ylab="F(x)")

# Plot of spliced PDF
plot(x, dSplice(x, splicefit), type="l", xlab="x", ylab="f(x)")


# Fitted survival function and Turnbull survival function 
SpliceTB(x, L=Z, U=U, censored=censored, splicefit=splicefit)


# Log-log plot with Turnbull survival function and fitted survival function
SpliceLL_TB(x, L=Z, U=U, censored=censored, splicefit=splicefit)


# PP-plot of Turnbull survival function and fitted survival function
SplicePP_TB(L=Z, U=U, censored=censored, splicefit=splicefit)

# PP-plot of Turnbull survival function and 
# fitted survival function with log-scales
SplicePP_TB(L=Z, U=U, censored=censored, splicefit=splicefit, log=TRUE)

# QQ-plot using Turnbull survival function and fitted survival function
SpliceQQ_TB(L=Z, U=U, censored=censored, splicefit=splicefit)

## End(Not run)
</code></pre>

<hr>
<h2 id='SpliceFitPareto'>
Splicing of mixed Erlang and Pareto
</h2><span id='topic+SpliceFitPareto'></span><span id='topic+SpliceFitHill'></span>

<h3>Description</h3>

<p>Fit spliced distribution of a mixed Erlang distribution and Pareto distribution(s). The shape parameter(s) of the Pareto distribution(s) is determined using the Hill estimator. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SpliceFitPareto(X, const = NULL, tsplice = NULL, M = 3, s = 1:10, trunclower = 0, 
                truncupper = Inf, EVTtruncation = FALSE, ncores = NULL, 
                criterium = c("BIC","AIC"), reduceM = TRUE,
                eps = 10^(-3), beta_tol = 10^(-5), maxiter = Inf)
              
SpliceFitHill(X, const = NULL, tsplice = NULL, M = 3, s = 1:10, trunclower = 0, 
              truncupper = Inf, EVTtruncation = FALSE, ncores = NULL,
              criterium = c("BIC","AIC"), reduceM = TRUE,
              eps = 10^(-3), beta_tol = 10^(-5), maxiter = Inf)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SpliceFitPareto_+3A_x">X</code></td>
<td>

<p>Data used for fitting the distribution.
</p>
</td></tr>
<tr><td><code id="SpliceFitPareto_+3A_const">const</code></td>
<td>

<p>Vector of length <code class="reqn">l</code> containing the probabilities of the quantiles where the distributions will be spliced (splicing points). The ME distribution will be spliced with <code class="reqn">l</code> Pareto distributions. Default is <code>NULL</code> meaning the input from <code>tsplice</code> is used.
</p>
</td></tr>
<tr><td><code id="SpliceFitPareto_+3A_tsplice">tsplice</code></td>
<td>

<p>Vector of length <code class="reqn">l</code> containing the splicing points. The ME distribution will be spliced with <code class="reqn">l</code> Pareto distributions. Default is <code>NULL</code> meaning the input from <code>const</code> is used.
</p>
</td></tr>
<tr><td><code id="SpliceFitPareto_+3A_m">M</code></td>
<td>

<p>Initial number of Erlang mixtures, default is 3. This number can change when determining
an optimal mixed Erlang fit using an information criterion.
</p>
</td></tr>
<tr><td><code id="SpliceFitPareto_+3A_s">s</code></td>
<td>

<p>Vector of spread factors for the EM algorithm, default is <code>1:10</code>. We loop over these factors when determining
an optimal mixed Erlang fit using an information criterion, see Verbelen et al. (2016).
</p>
</td></tr>
<tr><td><code id="SpliceFitPareto_+3A_trunclower">trunclower</code></td>
<td>

<p>Lower truncation point. Default is 0.
</p>
</td></tr>
<tr><td><code id="SpliceFitPareto_+3A_truncupper">truncupper</code></td>
<td>

<p>Upper truncation point. Default is <code>Inf</code> (no upper truncation). When <code>truncupper=Inf</code> and <code>EVTtruncation=TRUE</code>, the truncation point is estimated using the approach of Beirlant et al. (2016).
</p>
</td></tr>
<tr><td><code id="SpliceFitPareto_+3A_evttruncation">EVTtruncation</code></td>
<td>

<p>Logical indicating if the <code class="reqn">l</code>-th Pareto distribution is a truncated Pareto distribution. Default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="SpliceFitPareto_+3A_ncores">ncores</code></td>
<td>

<p>Number of cores to use when determining an optimal mixed Erlang fit using an information criterion.
When <code>NULL</code> (default), <code>max(nc-1,1)</code> cores are used where <code>nc</code> is the number of cores as determined by <code><a href="parallel.html#topic+detectCores">detectCores</a></code>.
</p>
</td></tr>
<tr><td><code id="SpliceFitPareto_+3A_criterium">criterium</code></td>
<td>

<p>Information criterion used to select the number of components of the ME fit and <code>s</code>. One of <code>"AIC"</code> and <code>"BIC"</code> (default).
</p>
</td></tr>
<tr><td><code id="SpliceFitPareto_+3A_reducem">reduceM</code></td>
<td>

<p>Logical indicating if M should be reduced based on the information criterion, default is <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="SpliceFitPareto_+3A_eps">eps</code></td>
<td>

<p>Covergence threshold used in the EM algorithm (ME part). Default is <code>10^(-3)</code>.
</p>
</td></tr>
<tr><td><code id="SpliceFitPareto_+3A_beta_tol">beta_tol</code></td>
<td>

<p>Threshold for the mixing weights below which the corresponding shape parameter vector is considered neglectable (ME part). Default is <code>10^(-5)</code>.
</p>
</td></tr>
<tr><td><code id="SpliceFitPareto_+3A_maxiter">maxiter</code></td>
<td>

<p>Maximum number of iterations in a single EM algorithm execution (ME part). Default is <code>Inf</code> meaning no maximum number of iterations.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See Reynkens et al. (2017), Section 4.3.1 of Albrecher et al. (2017) and Verbelen et al. (2015) for details. The code follows the notation of the latter. Initial values follow from Verbelen et al. (2016).
</p>
<p>The <code>SpliceFitHill</code> function is the same function but with a different name for compatibility with old versions of the package.
</p>
<p>Use <code><a href="#topic+SpliceFiticPareto">SpliceFiticPareto</a></code> when censoring is present.
</p>


<h3>Value</h3>

<p>A <code><a href="#topic+SpliceFit">SpliceFit</a></code> object.
</p>


<h3>Author(s)</h3>

<p>Tom Reynkens with <code>R</code> code from Roel Verbelen for fitting the mixed Erlang distribution.
</p>


<h3>References</h3>

<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>
<p>Beirlant, J., Fraga Alves, M.I. and Gomes, M.I. (2016). &quot;Tail fitting for Truncated and Non-truncated Pareto-type Distributions.&quot; <em>Extremes</em>, 19, 429&ndash;462.
</p>
<p>Reynkens, T., Verbelen, R., Beirlant, J. and Antonio, K. (2017). &quot;Modelling Censored Losses Using Splicing:
a Global Fit Strategy With Mixed Erlang and Extreme Value Distributions&quot;. <em>Insurance: Mathematics and Economics</em>, 77, 65&ndash;77.
</p>
<p>Verbelen, R., Gong, L., Antonio, K., Badescu, A. and Lin, S. (2015). &quot;Fitting Mixtures of
Erlangs to Censored and Truncated Data Using the EM Algorithm.&quot; <em>Astin Bulletin</em>, 45, 729&ndash;758.
</p>
<p>Verbelen, R., Antonio, K. and Claeskens, G. (2016). &quot;Multivariate Mixtures
of Erlangs for Density Estimation Under Censoring.&quot; <em>Lifetime Data Analysis</em>, 22, 429&ndash;455.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+SpliceFiticPareto">SpliceFiticPareto</a></code>, <code><a href="#topic+SpliceFitGPD">SpliceFitGPD</a></code>, <code><a href="#topic+pSplice">Splice</a></code>,
<code><a href="#topic+Hill">Hill</a></code>, <code><a href="#topic+trHill">trHill</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

# Pareto random sample
X &lt;- rpareto(1000, shape = 2)

# Splice ME and Pareto
splicefit &lt;- SpliceFitPareto(X, 0.6)



x &lt;- seq(0, 20, 0.01)

# Plot of spliced CDF
plot(x, pSplice(x, splicefit), type="l", xlab="x", ylab="F(x)")

# Plot of spliced PDF
plot(x, dSplice(x, splicefit), type="l", xlab="x", ylab="f(x)")



# Fitted survival function and empirical survival function 
SpliceECDF(x, X, splicefit)

# Log-log plot with empirical survival function and fitted survival function
SpliceLL(x, X, splicefit)

# PP-plot of empirical survival function and fitted survival function
SplicePP(X, splicefit)

# PP-plot of empirical survival function and 
# fitted survival function with log-scales
SplicePP(X, splicefit, log=TRUE)

# Splicing QQ-plot
SpliceQQ(X, splicefit)

## End(Not run)
</code></pre>

<hr>
<h2 id='SpliceLL'>
LL-plot with fitted and empirical survival function
</h2><span id='topic+SpliceLL'></span>

<h3>Description</h3>

<p>This function plots the logarithm of the empirical survival function (determined using the Empirical CDF (ECDF)) versus the logarithm of the data.
Moreover, the logarithm of the fitted survival function of the spliced distribution is added.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SpliceLL(x = sort(X), X, splicefit, plot = TRUE, main = "Splicing LL-plot", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SpliceLL_+3A_x">x</code></td>
<td>

<p>Vector of points to plot the fitted survival function at. By default we plot it at the data points.
</p>
</td></tr>
<tr><td><code id="SpliceLL_+3A_x">X</code></td>
<td>

<p>Data used for fitting the distribution.
</p>
</td></tr>
<tr><td><code id="SpliceLL_+3A_splicefit">splicefit</code></td>
<td>

<p>A <code><a href="#topic+SpliceFit">SpliceFit</a></code> object, e.g. output from <code><a href="#topic+SpliceFitPareto">SpliceFitPareto</a></code> or <code><a href="#topic+SpliceFitGPD">SpliceFitGPD</a></code>.
</p>
</td></tr>
<tr><td><code id="SpliceLL_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the splicing LL-plot should be made, default is <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="SpliceLL_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"Splicing LL-plot"</code>.
</p>
</td></tr>
<tr><td><code id="SpliceLL_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The LL-plot consists of the points
</p>
<p style="text-align: center;"><code class="reqn">(\log(x_{i,n}), \log(1-\hat{F}(x_{i,n})))</code>
</p>

<p>for <code class="reqn">i=1,\ldots,n</code> with <code class="reqn">n</code> the length of the data, <code class="reqn">x_{i,n}</code> the <code class="reqn">i</code>-th smallest observation
and <code class="reqn">\hat{F}</code> the empirical distribution function.
Then, the line 
</p>
<p style="text-align: center;"><code class="reqn">(\log(x), \log(1-\hat{F}_{spliced}(x))),</code>
</p>

<p>with <code class="reqn">\hat{F}_{spliced}</code> the fitted spliced distribution function, is added.
</p>
<p>Use <code><a href="#topic+SpliceLL_TB">SpliceLL_TB</a></code> for censored data.
</p>
<p>See Reynkens et al. (2017) and Section 4.3.1 in Albrecher et al. (2017) for more details.
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>logX</code></td>
<td>
<p>Vector of the logarithms of the sorted data.</p>
</td></tr>
<tr><td><code>sll.the</code></td>
<td>
<p>Vector of the theoretical log-probabilities <code class="reqn">\log(1-\hat{F}_{spliced}(x))</code>.</p>
</td></tr>
<tr><td><code>logx</code></td>
<td>
<p>Vector of the logarithms of the points to plot the fitted survival function at.</p>
</td></tr>
<tr><td><code>sll.emp</code></td>
<td>
<p>Vector of the empirical log-probabilities <code class="reqn">\log(1-\hat{F}(x_{i,n}))</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens
</p>


<h3>References</h3>

<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>
<p>Reynkens, T., Verbelen, R., Beirlant, J. and Antonio, K. (2017). &quot;Modelling Censored Losses Using Splicing:
a Global Fit Strategy With Mixed Erlang and Extreme Value Distributions&quot;. <em>Insurance: Mathematics and Economics</em>, 77, 65&ndash;77.
</p>
<p>Verbelen, R., Gong, L., Antonio, K., Badescu, A. and Lin, S. (2015). &quot;Fitting Mixtures of
Erlangs to Censored and Truncated Data Using the EM Algorithm.&quot; <em>Astin Bulletin</em>, 45, 729&ndash;758
</p>


<h3>See Also</h3>

<p><code><a href="#topic+SpliceLL_TB">SpliceLL_TB</a></code>, <code><a href="#topic+pSplice">pSplice</a></code>, <code><a href="stats.html#topic+ecdf">ecdf</a></code>, <code><a href="#topic+SpliceFitPareto">SpliceFitPareto</a></code>, <code><a href="#topic+SpliceFitGPD">SpliceFitGPD</a></code>, <code><a href="#topic+SpliceECDF">SpliceECDF</a></code>, <code><a href="#topic+SplicePP">SplicePP</a></code>, <code><a href="#topic+SpliceQQ">SpliceQQ</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

# Pareto random sample
X &lt;- rpareto(1000, shape = 2)

# Splice ME and Pareto
splicefit &lt;- SpliceFitPareto(X, 0.6)



x &lt;- seq(0, 20, 0.01)

# Plot of spliced CDF
plot(x, pSplice(x, splicefit), type="l", xlab="x", ylab="F(x)")

# Plot of spliced PDF
plot(x, dSplice(x, splicefit), type="l", xlab="x", ylab="f(x)")



# Fitted survival function and empirical survival function 
SpliceECDF(x, X, splicefit)

# Log-log plot with empirical survival function and fitted survival function
SpliceLL(x, X, splicefit)

# PP-plot of empirical survival function and fitted survival function
SplicePP(X, splicefit)

# PP-plot of empirical survival function and 
# fitted survival function with log-scales
SplicePP(X, splicefit, log=TRUE)

# Splicing QQ-plot
SpliceQQ(X, splicefit)

## End(Not run)
</code></pre>

<hr>
<h2 id='SpliceLL_TB'>
LL-plot with fitted and Turnbull survival function
</h2><span id='topic+SpliceLL_TB'></span>

<h3>Description</h3>

<p>This function plots the logarithm of the Turnbull survival function (which is suitable for interval censored data) versus the logarithm of the data.
Moreover, the logarithm of the fitted survival function of the spliced distribution is added.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SpliceLL_TB(x = sort(L), L, U = L, censored, splicefit, plot = TRUE,
            main = "Splicing LL-plot", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SpliceLL_TB_+3A_x">x</code></td>
<td>

<p>Vector of points to plot the fitted survival function at. By default we plot it at the points <code>L</code>.
</p>
</td></tr>
<tr><td><code id="SpliceLL_TB_+3A_l">L</code></td>
<td>

<p>Vector of length <code class="reqn">n</code> with the lower boundaries of the intervals for interval censored data or the observed data for right censored data.
</p>
</td></tr>
<tr><td><code id="SpliceLL_TB_+3A_u">U</code></td>
<td>

<p>Vector of length <code class="reqn">n</code> with the upper boundaries of the intervals. By default, they are equal to <code>L</code>.
</p>
</td></tr>
<tr><td><code id="SpliceLL_TB_+3A_censored">censored</code></td>
<td>

<p>A logical vector of length <code class="reqn">n</code> indicating if an observation is censored.
</p>
</td></tr>
<tr><td><code id="SpliceLL_TB_+3A_splicefit">splicefit</code></td>
<td>

<p>A <code><a href="#topic+SpliceFit">SpliceFit</a></code> object, e.g. output from <code><a href="#topic+SpliceFiticPareto">SpliceFiticPareto</a></code>.
</p>
</td></tr>
<tr><td><code id="SpliceLL_TB_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the splicing LL-plot should be made, default is <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="SpliceLL_TB_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"Splicing LL-plot"</code>.
</p>
</td></tr>
<tr><td><code id="SpliceLL_TB_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The LL-plot consists of the points
</p>
<p style="text-align: center;"><code class="reqn">(\log(L_{i,n}), \log(1-\hat{F}^{TB}(L_{i,n})))</code>
</p>

<p>for <code class="reqn">i=1,\ldots,n</code> with <code class="reqn">n</code> the length of the data, <code class="reqn">x_{i,n}</code> the <code class="reqn">i</code>-th smallest observation
and <code class="reqn">\hat{F}^{TB}</code> the Turnbull estimator for the distribution function.
Then, the line 
</p>
<p style="text-align: center;"><code class="reqn">(\log(x), \log(1-\hat{F}_{spliced}(x))),</code>
</p>

<p>with <code class="reqn">\hat{F}_{spliced}</code> the fitted spliced distribution function, is added.
</p>
<p>Right censored data should be entered as <code>L=l</code> and <code>U=truncupper</code>, and left censored data should be entered as <code>L=trunclower</code> and <code>U=u</code>. The limits <code>trunclower</code> and <code>truncupper</code> are obtained from the <code><a href="#topic+SpliceFit">SpliceFit</a></code> object.
</p>
<p>If the <span class="pkg">interval</span> package is installed, the <code><a href="interval.html#topic+icfit">icfit</a></code> function is used to compute the Turnbull estimator. Otherwise, <code><a href="survival.html#topic+survfit.formula">survfit.formula</a></code> from <span class="pkg">survival</span> is used.
</p>
<p>Use <code><a href="#topic+SpliceLL">SpliceLL</a></code> for non-censored data. 
</p>
<p>See Reynkens et al. (2017) and Section 4.3.2 in Albrecher et al. (2017) for more details.
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>logX</code></td>
<td>
<p>Vector of the logarithms of the sorted left boundaries of the intervals.</p>
</td></tr>
<tr><td><code>sll.the</code></td>
<td>
<p>Vector of the theoretical log-probabilities <code class="reqn">\log(1-\hat{F}_{spliced}(x)</code>.</p>
</td></tr>
<tr><td><code>logx</code></td>
<td>
<p>Vector of the logarithms of the points to plot the fitted survival function at.</p>
</td></tr>
<tr><td><code>sll.emp</code></td>
<td>
<p>Vector of the empirical log-probabilities <code class="reqn">\log(1-\hat{F}^{TB}(x_{i,n}))</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens
</p>


<h3>References</h3>

<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>
<p>Reynkens, T., Verbelen, R., Beirlant, J. and Antonio, K. (2017). &quot;Modelling Censored Losses Using Splicing:
a Global Fit Strategy With Mixed Erlang and Extreme Value Distributions&quot;. <em>Insurance: Mathematics and Economics</em>, 77, 65&ndash;77.
</p>
<p>Verbelen, R., Gong, L., Antonio, K., Badescu, A. and Lin, S. (2015). &quot;Fitting Mixtures of
Erlangs to Censored and Truncated Data Using the EM Algorithm.&quot; <em>Astin Bulletin</em>, 45, 729&ndash;758
</p>


<h3>See Also</h3>

<p><code><a href="#topic+SpliceLL">SpliceLL</a></code>, <code><a href="#topic+pSplice">pSplice</a></code>, <code><a href="#topic+Turnbull">Turnbull</a></code>, <code><a href="interval.html#topic+icfit">icfit</a></code>, <code><a href="#topic+SpliceFiticPareto">SpliceFiticPareto</a></code>, <code><a href="#topic+SpliceTB">SpliceTB</a></code>, <code><a href="#topic+SplicePP_TB">SplicePP_TB</a></code>, <code><a href="#topic+SpliceQQ_TB">SpliceQQ_TB</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

# Pareto random sample
X &lt;- rpareto(500, shape=2)

# Censoring variable
Y &lt;- rpareto(500, shape=1)

# Observed sample
Z &lt;- pmin(X,Y)

# Censoring indicator
censored &lt;- (X&gt;Y)

# Right boundary
U &lt;- Z
U[censored] &lt;- Inf

# Splice ME and Pareto
splicefit &lt;- SpliceFiticPareto(L=Z, U=U, censored=censored, tsplice=quantile(Z,0.9))



x &lt;- seq(0,20,0.1)

# Plot of spliced CDF
plot(x, pSplice(x, splicefit), type="l", xlab="x", ylab="F(x)")

# Plot of spliced PDF
plot(x, dSplice(x, splicefit), type="l", xlab="x", ylab="f(x)")


# Fitted survival function and Turnbull survival function 
SpliceTB(x, L=Z, U=U, censored=censored, splicefit=splicefit)


# Log-log plot with Turnbull survival function and fitted survival function
SpliceLL_TB(x, L=Z, U=U, censored=censored, splicefit=splicefit)


# PP-plot of Turnbull survival function and fitted survival function
SplicePP_TB(L=Z, U=U, censored=censored, splicefit=splicefit)

# PP-plot of Turnbull survival function and 
# fitted survival function with log-scales
SplicePP_TB(L=Z, U=U, censored=censored, splicefit=splicefit, log=TRUE)

# QQ-plot using Turnbull survival function and fitted survival function
SpliceQQ_TB(L=Z, U=U, censored=censored, splicefit=splicefit)

## End(Not run)
</code></pre>

<hr>
<h2 id='SplicePP'>
PP-plot with fitted and empirical survival function
</h2><span id='topic+SplicePP'></span>

<h3>Description</h3>

<p>This function plots the fitted survival function of the spliced distribution versus the
empirical survival function (determined using the Empirical CDF (ECDF)). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SplicePP(X, splicefit, x = sort(X), log = FALSE, plot = TRUE, 
         main = "Splicing PP-plot", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SplicePP_+3A_x">X</code></td>
<td>

<p>Data used for fitting the distribution.
</p>
</td></tr>
<tr><td><code id="SplicePP_+3A_splicefit">splicefit</code></td>
<td>

<p>A <code><a href="#topic+SpliceFit">SpliceFit</a></code> object, e.g. output from <code><a href="#topic+SpliceFitPareto">SpliceFitPareto</a></code> or <code><a href="#topic+SpliceFitGPD">SpliceFitGPD</a></code>.
</p>
</td></tr>
<tr><td><code id="SplicePP_+3A_x">x</code></td>
<td>

<p>Vector of points to plot the functions at. By default we plot them at the data points.
</p>
</td></tr>
<tr><td><code id="SplicePP_+3A_log">log</code></td>
<td>

<p>Logical indicating if minus the logarithms of the survival probabilities are plotted versus each other, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="SplicePP_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the splicing PP-plot should be made, default is <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="SplicePP_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"Splicing PP-plot"</code>.
</p>
</td></tr>
<tr><td><code id="SplicePP_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The PP-plot consists of the points
</p>
<p style="text-align: center;"><code class="reqn">(1-\hat{F}(x_{i,n}), 1-\hat{F}_{spliced}(x_{i,n})))</code>
</p>

<p>for <code class="reqn">i=1,\ldots,n</code> with <code class="reqn">n</code> the length of the data, <code class="reqn">x_{i,n}</code> the <code class="reqn">i</code>-th smallest observation,
<code class="reqn">\hat{F}</code> the empirical distribution function and <code class="reqn">\hat{F}_{spliced}</code> the fitted spliced distribution function.
The minus-log version of the PP-plot consists of
</p>
<p style="text-align: center;"><code class="reqn">(-\log(1-\hat{F}(x_{i,n})), -\log(1-\hat{F}_{spliced}(x_{i,n})))).</code>
</p>

<p>Use <code><a href="#topic+SplicePP_TB">SplicePP_TB</a></code> for censored data. 
</p>
<p>See Reynkens et al. (2017) and Section 4.3.1 in Albrecher et al. (2017) for more details.
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>spp.the</code></td>
<td>
<p>Vector of the theoretical probabilities <code class="reqn">1-\hat{F}_{spliced}(x_{i,n})</code> (when <code>log=FALSE</code>) or <code class="reqn">-\log(1-\hat{F}_{spliced}(x_{i,n}))</code> (when <code>log=TRUE</code>).</p>
</td></tr>
<tr><td><code>spp.emp</code></td>
<td>
<p>Vector of the empirical probabilities <code class="reqn">1-\hat{F}(x_{i,n})</code> (when <code>log=FALSE</code>) or <code class="reqn">-\log(1-\hat{F}(x_{i,n}))</code> (when <code>log=TRUE</code>).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens
</p>


<h3>References</h3>

<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>
<p>Reynkens, T., Verbelen, R., Beirlant, J. and Antonio, K. (2017). &quot;Modelling Censored Losses Using Splicing:
a Global Fit Strategy With Mixed Erlang and Extreme Value Distributions&quot;. <em>Insurance: Mathematics and Economics</em>, 77, 65&ndash;77.
</p>
<p>Verbelen, R., Gong, L., Antonio, K., Badescu, A. and Lin, S. (2015). &quot;Fitting Mixtures of
Erlangs to Censored and Truncated Data Using the EM Algorithm.&quot; <em>Astin Bulletin</em>, 45, 729&ndash;758
</p>


<h3>See Also</h3>

<p><code><a href="#topic+SplicePP_TB">SplicePP_TB</a></code>, <code><a href="#topic+pSplice">pSplice</a></code>, <code><a href="stats.html#topic+ecdf">ecdf</a></code>, <code><a href="#topic+SpliceFitPareto">SpliceFitPareto</a></code>, <code><a href="#topic+SpliceFitGPD">SpliceFitGPD</a></code>, <code><a href="#topic+SpliceECDF">SpliceECDF</a></code>, <code><a href="#topic+SpliceLL">SpliceLL</a></code>, <code><a href="#topic+SpliceQQ">SpliceQQ</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

# Pareto random sample
X &lt;- rpareto(1000, shape = 2)

# Splice ME and Pareto
splicefit &lt;- SpliceFitPareto(X, 0.6)



x &lt;- seq(0, 20, 0.01)

# Plot of spliced CDF
plot(x, pSplice(x, splicefit), type="l", xlab="x", ylab="F(x)")

# Plot of spliced PDF
plot(x, dSplice(x, splicefit), type="l", xlab="x", ylab="f(x)")



# Fitted survival function and empirical survival function 
SpliceECDF(x, X, splicefit)

# Log-log plot with empirical survival function and fitted survival function
SpliceLL(x, X, splicefit)

# PP-plot of empirical survival function and fitted survival function
SplicePP(X, splicefit)

# PP-plot of empirical survival function and 
# fitted survival function with log-scales
SplicePP(X, splicefit, log=TRUE)

# Splicing QQ-plot
SpliceQQ(X, splicefit)

## End(Not run)
</code></pre>

<hr>
<h2 id='SplicePP_TB'>
PP-plot with fitted and Turnbull survival function
</h2><span id='topic+SplicePP_TB'></span>

<h3>Description</h3>

<p>This function plots the fitted survival function of the spliced distribution versus the Turnbull survival function (which is suitable for interval censored data). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SplicePP_TB(L, U = L, censored, splicefit, x = NULL, log = FALSE, plot = TRUE,
            main = "Splicing PP-plot", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SplicePP_TB_+3A_l">L</code></td>
<td>

<p>Vector of length <code class="reqn">n</code> with the lower boundaries of the intervals for interval censored data or the observed data for right censored data.
</p>
</td></tr>
<tr><td><code id="SplicePP_TB_+3A_u">U</code></td>
<td>

<p>Vector of length <code class="reqn">n</code> with the upper boundaries of the intervals. By default, they are equal to <code>L</code>.
</p>
</td></tr>
<tr><td><code id="SplicePP_TB_+3A_censored">censored</code></td>
<td>

<p>A logical vector of length <code class="reqn">n</code> indicating if an observation is censored.
</p>
</td></tr>
<tr><td><code id="SplicePP_TB_+3A_splicefit">splicefit</code></td>
<td>

<p>A <code><a href="#topic+SpliceFit">SpliceFit</a></code> object, e.g. output from <code><a href="#topic+SpliceFiticPareto">SpliceFiticPareto</a></code>.
</p>
</td></tr>
<tr><td><code id="SplicePP_TB_+3A_x">x</code></td>
<td>

<p>Vector of points to plot the functions at. When <code>NULL</code>, the default, the empirical quantiles for <code class="reqn">1/(n+1), \ldots, n/(n+1)</code>, obtained using the Turnbull estimator, are used.
</p>
</td></tr>
<tr><td><code id="SplicePP_TB_+3A_log">log</code></td>
<td>

<p>Logical indicating if minus the logarithms of the survival probabilities are plotted versus each other, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="SplicePP_TB_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the splicing PP-plot should be made, default is <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="SplicePP_TB_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"Splicing PP-plot"</code>.
</p>
</td></tr>
<tr><td><code id="SplicePP_TB_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The PP-plot consists of the points
</p>
<p style="text-align: center;"><code class="reqn">(1-\hat{F}^{TB}(x_i), 1-\hat{F}_{spliced}(x_i)))</code>
</p>

<p>for <code class="reqn">i=1,\ldots,n</code> with <code class="reqn">n</code> the length of the data, <code class="reqn">x_i=\hat{Q}^{TB}(p_i)</code> where <code class="reqn">p_i=i/(n+1)</code>, <code class="reqn">\hat{Q}^{TB}</code> is the quantile function obtained using the Turnbull estimator,
<code class="reqn">\hat{F}^{TB}</code> the Turnbull estimator for the distribution function and <code class="reqn">\hat{F}_{spliced}</code> the fitted spliced distribution function.
The minus-log version of the PP-plot consists of
</p>
<p style="text-align: center;"><code class="reqn">(-\log(1-\hat{F}^{TB}(x_i)), -\log(1-\hat{F}_{spliced}(x_i))).</code>
</p>

<p>Right censored data should be entered as <code>L=l</code> and <code>U=truncupper</code>, and left censored data should be entered as <code>L=trunclower</code> and <code>U=u</code>. The limits <code>trunclower</code> and <code>truncupper</code> are obtained from the <code><a href="#topic+SpliceFit">SpliceFit</a></code> object.
</p>
<p>If the <span class="pkg">interval</span> package is installed, the <code><a href="interval.html#topic+icfit">icfit</a></code> function is used to compute the Turnbull estimator. Otherwise, <code><a href="survival.html#topic+survfit.formula">survfit.formula</a></code> from <span class="pkg">survival</span> is used.
</p>
<p>Use <code><a href="#topic+SplicePP">SplicePP</a></code> for non-censored data. 
</p>
<p>See Reynkens et al. (2017) and Section 4.3.2 in Albrecher et al. (2017) for more details.
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>spp.the</code></td>
<td>
<p>Vector of the theoretical probabilities <code class="reqn">1-\hat{F}_{spliced}(x_i)</code> (when <code>log=FALSE</code>) or <code class="reqn">-\log(1-\hat{F}_{spliced}(x_i))</code> (when <code>log=TRUE</code>).</p>
</td></tr>
<tr><td><code>spp.emp</code></td>
<td>
<p>Vector of the empirical probabilities <code class="reqn">1-\hat{F}^{TB}(x_i)</code> (when <code>log=FALSE</code>) or <code class="reqn">-\log(1-\hat{F}^{TB}(x_i))</code> (when <code>log=TRUE</code>).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens
</p>


<h3>References</h3>

<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>
<p>Reynkens, T., Verbelen, R., Beirlant, J. and Antonio, K. (2017). &quot;Modelling Censored Losses Using Splicing:
a Global Fit Strategy With Mixed Erlang and Extreme Value Distributions&quot;. <em>Insurance: Mathematics and Economics</em>, 77, 65&ndash;77.
</p>
<p>Verbelen, R., Gong, L., Antonio, K., Badescu, A. and Lin, S. (2015). &quot;Fitting Mixtures of
Erlangs to Censored and Truncated Data Using the EM Algorithm.&quot; <em>Astin Bulletin</em>, 45, 729&ndash;758
</p>


<h3>See Also</h3>

<p><code><a href="#topic+SplicePP">SplicePP</a></code>, <code><a href="#topic+pSplice">pSplice</a></code>, <code><a href="#topic+Turnbull">Turnbull</a></code>, <code><a href="interval.html#topic+icfit">icfit</a></code>, <code><a href="#topic+SpliceFiticPareto">SpliceFiticPareto</a></code>, <code><a href="#topic+SpliceTB">SpliceTB</a></code>, <code><a href="#topic+SpliceLL_TB">SpliceLL_TB</a></code>, <code><a href="#topic+SpliceQQ_TB">SpliceQQ_TB</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

# Pareto random sample
X &lt;- rpareto(500, shape=2)

# Censoring variable
Y &lt;- rpareto(500, shape=1)

# Observed sample
Z &lt;- pmin(X,Y)

# Censoring indicator
censored &lt;- (X&gt;Y)

# Right boundary
U &lt;- Z
U[censored] &lt;- Inf

# Splice ME and Pareto
splicefit &lt;- SpliceFiticPareto(L=Z, U=U, censored=censored, tsplice=quantile(Z,0.9))



x &lt;- seq(0,20,0.1)

# Plot of spliced CDF
plot(x, pSplice(x, splicefit), type="l", xlab="x", ylab="F(x)")

# Plot of spliced PDF
plot(x, dSplice(x, splicefit), type="l", xlab="x", ylab="f(x)")


# Fitted survival function and Turnbull survival function 
SpliceTB(x, L=Z, U=U, censored=censored, splicefit=splicefit)


# Log-log plot with Turnbull survival function and fitted survival function
SpliceLL_TB(x, L=Z, U=U, censored=censored, splicefit=splicefit)


# PP-plot of Turnbull survival function and fitted survival function
SplicePP_TB(L=Z, U=U, censored=censored, splicefit=splicefit)

# PP-plot of Turnbull survival function and 
# fitted survival function with log-scales
SplicePP_TB(L=Z, U=U, censored=censored, splicefit=splicefit, log=TRUE)

# QQ-plot using Turnbull survival function and fitted survival function
SpliceQQ_TB(L=Z, U=U, censored=censored, splicefit=splicefit)

## End(Not run)
</code></pre>

<hr>
<h2 id='SpliceQQ'>
Splicing quantile plot
</h2><span id='topic+SpliceQQ'></span>

<h3>Description</h3>

<p>Computes the empirical quantiles of a data vector and the theoretical quantiles of the fitted spliced distribution. These quantiles are then plotted in a splicing QQ-plot with the theoretical quantiles on the <code class="reqn">x</code>-axis and the empirical quantiles on the <code class="reqn">y</code>-axis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SpliceQQ(X, splicefit, p = NULL, plot = TRUE, main = "Splicing QQ-plot", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SpliceQQ_+3A_x">X</code></td>
<td>

<p>Vector of <code class="reqn">n</code> observations. 
</p>
</td></tr>
<tr><td><code id="SpliceQQ_+3A_splicefit">splicefit</code></td>
<td>

<p>A <code><a href="#topic+SpliceFit">SpliceFit</a></code> object, e.g. output from <code><a href="#topic+SpliceFitPareto">SpliceFitPareto</a></code> or <code><a href="#topic+SpliceFitGPD">SpliceFitGPD</a></code>.
</p>
</td></tr>
<tr><td><code id="SpliceQQ_+3A_p">p</code></td>
<td>

<p>Vector of probabilities used in the QQ-plot. If <code>NULL</code>, the default, we take <code>p</code> equal to <code>1/(n+1),...,n/(n+1)</code>.
</p>
</td></tr>
<tr><td><code id="SpliceQQ_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the quantiles should be plotted in a splicing QQ-plot, default is <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="SpliceQQ_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"Splicing QQ-plot"</code>.
</p>
</td></tr>
<tr><td><code id="SpliceQQ_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This QQ-plot is given by </p>
<p style="text-align: center;"><code class="reqn">(Q(p_j), \hat{Q}(p_j)),</code>
</p>
<p> for <code class="reqn">j=1,\ldots,n</code> where <code class="reqn">Q</code> is the quantile function of the fitted splicing model and <code class="reqn">\hat{Q}</code> is the empirical quantile function and <code class="reqn">p_j=j/(n+1)</code>. 
</p>
<p>See Reynkens et al. (2017) and Section 4.3.1 in Albrecher et al. (2017) for more details.
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>sqq.the</code></td>
<td>
<p>Vector of the theoretical quantiles of the fitted spliced distribution.</p>
</td></tr>
<tr><td><code>sqq.emp</code></td>
<td>
<p>Vector of the empirical quantiles from the data.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens
</p>


<h3>References</h3>

<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>
<p>Reynkens, T., Verbelen, R., Beirlant, J. and Antonio, K. (2017). &quot;Modelling Censored Losses Using Splicing:
a Global Fit Strategy With Mixed Erlang and Extreme Value Distributions&quot;. <em>Insurance: Mathematics and Economics</em>, 77, 65&ndash;77.
</p>
<p>Verbelen, R., Gong, L., Antonio, K., Badescu, A. and Lin, S. (2015). &quot;Fitting Mixtures of
Erlangs to Censored and Truncated Data Using the EM Algorithm.&quot; <em>Astin Bulletin</em>, 45, 729&ndash;758
</p>


<h3>See Also</h3>

<p><code><a href="#topic+SpliceQQ_TB">SpliceQQ_TB</a></code>, <code><a href="#topic+qSplice">qSplice</a></code>, <code><a href="#topic+SpliceFitPareto">SpliceFitPareto</a></code>, <code><a href="#topic+SpliceFitGPD">SpliceFitGPD</a></code>, <code><a href="#topic+SpliceECDF">SpliceECDF</a></code>, <code><a href="#topic+SpliceLL">SpliceLL</a></code>, <code><a href="#topic+SplicePP">SplicePP</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

# Pareto random sample
X &lt;- rpareto(1000, shape = 2)

# Splice ME and Pareto
splicefit &lt;- SpliceFitPareto(X, 0.6)



x &lt;- seq(0, 20, 0.01)

# Plot of spliced CDF
plot(x, pSplice(x, splicefit), type="l", xlab="x", ylab="F(x)")

# Plot of spliced PDF
plot(x, dSplice(x, splicefit), type="l", xlab="x", ylab="f(x)")



# Fitted survival function and empirical survival function 
SpliceECDF(x, X, splicefit)

# Log-log plot with empirical survival function and fitted survival function
SpliceLL(x, X, splicefit)

# PP-plot of empirical survival function and fitted survival function
SplicePP(X, splicefit)

# PP-plot of empirical survival function and 
# fitted survival function with log-scales
SplicePP(X, splicefit, log=TRUE)

# Splicing QQ-plot
SpliceQQ(X, splicefit)

## End(Not run)
</code></pre>

<hr>
<h2 id='SpliceQQ_TB'>
Splicing quantile plot using Turnbull estimator
</h2><span id='topic+SpliceQQ_TB'></span>

<h3>Description</h3>

<p>This function plots the fitted quantile function of the spliced distribution versus quantiles based on the Turnbull survival function (which is suitable for interval censored data). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SpliceQQ_TB(L, U = L, censored, splicefit, p = NULL,
            plot = TRUE, main = "Splicing QQ-plot", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SpliceQQ_TB_+3A_l">L</code></td>
<td>

<p>Vector of length <code class="reqn">n</code> with the lower boundaries of the intervals for interval censored data or the observed data for right censored data.
</p>
</td></tr>
<tr><td><code id="SpliceQQ_TB_+3A_u">U</code></td>
<td>

<p>Vector of length <code class="reqn">n</code> with the upper boundaries of the intervals. By default, they are equal to <code>L</code>.
</p>
</td></tr>
<tr><td><code id="SpliceQQ_TB_+3A_censored">censored</code></td>
<td>

<p>A logical vector of length <code class="reqn">n</code> indicating if an observation is censored.
</p>
</td></tr>
<tr><td><code id="SpliceQQ_TB_+3A_splicefit">splicefit</code></td>
<td>

<p>A <code><a href="#topic+SpliceFit">SpliceFit</a></code> object, e.g. output from <code><a href="#topic+SpliceFiticPareto">SpliceFiticPareto</a></code>.
</p>
</td></tr>
<tr><td><code id="SpliceQQ_TB_+3A_p">p</code></td>
<td>

<p>Vector of probabilities used in the QQ-plot. If <code>NULL</code>, the default, we take <code>p</code> equal to <code>1/(n+1),...,n/(n+1)</code>.
</p>
</td></tr>
<tr><td><code id="SpliceQQ_TB_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the quantiles should be plotted in a splicing QQ-plot, default is <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="SpliceQQ_TB_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"Splicing QQ-plot"</code>.
</p>
</td></tr>
<tr><td><code id="SpliceQQ_TB_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This QQ-plot is given by </p>
<p style="text-align: center;"><code class="reqn">(Q(p_j), \hat{Q}^{TB}(p_j)),</code>
</p>
<p> for <code class="reqn">j=1,\ldots,n</code> where <code class="reqn">Q</code> is the quantile function of the fitted splicing model, <code class="reqn">\hat{Q}^{TB}</code> the quantile function obtained using the Turnbull estimator and <code class="reqn">p_j=j/(n+1)</code>. 
</p>
<p>If the <span class="pkg">interval</span> package is installed, the <code><a href="interval.html#topic+icfit">icfit</a></code> function is used to compute the Turnbull estimator. Otherwise, <code><a href="survival.html#topic+survfit.formula">survfit.formula</a></code> from <span class="pkg">survival</span> is used.
</p>
<p>Right censored data should be entered as <code>L=l</code> and <code>U=truncupper</code>, and left censored data should be entered as <code>L=trunclower</code> and <code>U=u</code>. The limits <code>trunclower</code> and <code>truncupper</code> are obtained from the <code><a href="#topic+SpliceFit">SpliceFit</a></code> object.
</p>
<p>Use <code><a href="#topic+SpliceQQ">SpliceQQ</a></code> for non-censored data. 
</p>
<p>See Reynkens et al. (2017) and Section 4.3.2 in Albrecher et al. (2017) for more details.
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>sqq.the</code></td>
<td>
<p>Vector of the theoretical quantiles of the fitted spliced distribution.</p>
</td></tr>
<tr><td><code>sqq.emp</code></td>
<td>
<p>Vector of the empirical quantiles from the data (based on the Turnbull estimator).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens
</p>


<h3>References</h3>

<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>
<p>Reynkens, T., Verbelen, R., Beirlant, J. and Antonio, K. (2017). &quot;Modelling Censored Losses Using Splicing:
a Global Fit Strategy With Mixed Erlang and Extreme Value Distributions&quot;. <em>Insurance: Mathematics and Economics</em>, 77, 65&ndash;77.
</p>
<p>Verbelen, R., Gong, L., Antonio, K., Badescu, A. and Lin, S. (2015). &quot;Fitting Mixtures of
Erlangs to Censored and Truncated Data Using the EM Algorithm.&quot; <em>Astin Bulletin</em>, 45, 729&ndash;758
</p>


<h3>See Also</h3>

<p><code><a href="#topic+SpliceQQ">SpliceQQ</a></code>, <code><a href="#topic+qSplice">qSplice</a></code>, <code><a href="#topic+Turnbull">Turnbull</a></code>, <code><a href="interval.html#topic+icfit">icfit</a></code>, <code><a href="#topic+SpliceFiticPareto">SpliceFiticPareto</a></code>, <code><a href="#topic+SpliceTB">SpliceTB</a></code>, <code><a href="#topic+SplicePP_TB">SplicePP_TB</a></code>, <code><a href="#topic+SpliceLL_TB">SpliceLL_TB</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

# Pareto random sample
X &lt;- rpareto(500, shape=2)

# Censoring variable
Y &lt;- rpareto(500, shape=1)

# Observed sample
Z &lt;- pmin(X,Y)

# Censoring indicator
censored &lt;- (X&gt;Y)

# Right boundary
U &lt;- Z
U[censored] &lt;- Inf

# Splice ME and Pareto
splicefit &lt;- SpliceFiticPareto(L=Z, U=U, censored=censored, tsplice=quantile(Z,0.9))



x &lt;- seq(0,20,0.1)

# Plot of spliced CDF
plot(x, pSplice(x, splicefit), type="l", xlab="x", ylab="F(x)")

# Plot of spliced PDF
plot(x, dSplice(x, splicefit), type="l", xlab="x", ylab="f(x)")


# Fitted survival function and Turnbull survival function 
SpliceTB(x, L=Z, U=U, censored=censored, splicefit=splicefit)


# Log-log plot with Turnbull survival function and fitted survival function
SpliceLL_TB(x, L=Z, U=U, censored=censored, splicefit=splicefit)


# PP-plot of Turnbull survival function and fitted survival function
SplicePP_TB(L=Z, U=U, censored=censored, splicefit=splicefit)

# PP-plot of Turnbull survival function and 
# fitted survival function with log-scales
SplicePP_TB(L=Z, U=U, censored=censored, splicefit=splicefit, log=TRUE)

# QQ-plot using Turnbull survival function and fitted survival function
SpliceQQ_TB(L=Z, U=U, censored=censored, splicefit=splicefit)

## End(Not run)
</code></pre>

<hr>
<h2 id='SpliceTB'>
Plot of fitted and Turnbull survival function
</h2><span id='topic+SpliceTB'></span>

<h3>Description</h3>

<p>This function plots the fitted survival function of the spliced distribution together with the
Turnbull survival function (which is suitable for interval censored data). Moreover, <code class="reqn">100(1-\alpha)\%</code> confidence intervals are added.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SpliceTB(x = sort(L), L, U = L, censored, splicefit, alpha = 0.05, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SpliceTB_+3A_x">x</code></td>
<td>

<p>Vector of points to plot the functions at. By default we plot it at the points <code>L</code>.
</p>
</td></tr>
<tr><td><code id="SpliceTB_+3A_l">L</code></td>
<td>

<p>Vector of length <code class="reqn">n</code> with the lower boundaries of the intervals for interval censored data or the observed data for right censored data.
</p>
</td></tr>
<tr><td><code id="SpliceTB_+3A_u">U</code></td>
<td>

<p>Vector of length <code class="reqn">n</code> with the upper boundaries of the intervals. By default, they are equal to <code>L</code>.
</p>
</td></tr>
<tr><td><code id="SpliceTB_+3A_censored">censored</code></td>
<td>

<p>A logical vector of length <code class="reqn">n</code> indicating if an observation is censored.
</p>
</td></tr>
<tr><td><code id="SpliceTB_+3A_splicefit">splicefit</code></td>
<td>

<p>A <code><a href="#topic+SpliceFit">SpliceFit</a></code> object,  e.g. output from <code><a href="#topic+SpliceFiticPareto">SpliceFiticPareto</a></code>.
</p>
</td></tr>
<tr><td><code id="SpliceTB_+3A_alpha">alpha</code></td>
<td>

<p><code class="reqn">100(1-\alpha)\%</code> is the confidence level for the confidence intervals. Default is <code class="reqn">\alpha=0.05</code>.
</p>
</td></tr>
<tr><td><code id="SpliceTB_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Right censored data should be entered as <code>L=l</code> and <code>U=truncupper</code>, and left censored data should be entered as <code>L=trunclower</code> and <code>U=u</code>. The limits <code>trunclower</code> and <code>truncupper</code> are obtained from the <code><a href="#topic+SpliceFit">SpliceFit</a></code> object.
</p>
<p>Use <code><a href="#topic+SpliceECDF">SpliceECDF</a></code> for non-censored data. 
</p>
<p>See Reynkens et al. (2017) and Section 4.3.2 in Albrecher et al. (2017) for more details.
</p>


<h3>Author(s)</h3>

<p>Tom Reynkens
</p>


<h3>References</h3>

<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>
<p>Reynkens, T., Verbelen, R., Beirlant, J. and Antonio, K. (2017). &quot;Modelling Censored Losses Using Splicing:
a Global Fit Strategy With Mixed Erlang and Extreme Value Distributions&quot;. <em>Insurance: Mathematics and Economics</em>, 77, 65&ndash;77.
</p>
<p>Verbelen, R., Gong, L., Antonio, K., Badescu, A. and Lin, S. (2015). &quot;Fitting Mixtures of
Erlangs to Censored and Truncated Data Using the EM Algorithm.&quot; <em>Astin Bulletin</em>, 45, 729&ndash;758
</p>


<h3>See Also</h3>

<p><code><a href="#topic+SpliceECDF">SpliceECDF</a></code>, <code><a href="#topic+pSplice">pSplice</a></code>, <code><a href="#topic+Turnbull">Turnbull</a></code>, <code><a href="#topic+SpliceFiticPareto">SpliceFiticPareto</a></code>, <code><a href="#topic+SpliceLL_TB">SpliceLL_TB</a></code>, <code><a href="#topic+SplicePP_TB">SplicePP_TB</a></code>, <code><a href="#topic+SpliceQQ_TB">SpliceQQ_TB</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

# Pareto random sample
X &lt;- rpareto(500, shape=2)

# Censoring variable
Y &lt;- rpareto(500, shape=1)

# Observed sample
Z &lt;- pmin(X,Y)

# Censoring indicator
censored &lt;- (X&gt;Y)

# Right boundary
U &lt;- Z
U[censored] &lt;- Inf

# Splice ME and Pareto
splicefit &lt;- SpliceFiticPareto(L=Z, U=U, censored=censored, tsplice=quantile(Z,0.9))



x &lt;- seq(0,20,0.1)

# Plot of spliced CDF
plot(x, pSplice(x, splicefit), type="l", xlab="x", ylab="F(x)")

# Plot of spliced PDF
plot(x, dSplice(x, splicefit), type="l", xlab="x", ylab="f(x)")


# Fitted survival function and Turnbull survival function 
SpliceTB(x, L=Z, U=U, censored=censored, splicefit=splicefit)


# Log-log plot with Turnbull survival function and fitted survival function
SpliceLL_TB(x, L=Z, U=U, censored=censored, splicefit=splicefit)


# PP-plot of Turnbull survival function and fitted survival function
SplicePP_TB(L=Z, U=U, censored=censored, splicefit=splicefit)

# PP-plot of Turnbull survival function and 
# fitted survival function with log-scales
SplicePP_TB(L=Z, U=U, censored=censored, splicefit=splicefit, log=TRUE)

# QQ-plot using Turnbull survival function and fitted survival function
SpliceQQ_TB(L=Z, U=U, censored=censored, splicefit=splicefit)

## End(Not run)
</code></pre>

<hr>
<h2 id='stdf'>
Non-parametric estimators of the STDF
</h2><span id='topic+stdf'></span><span id='topic+stdf2'></span>

<h3>Description</h3>

<p>Non-parametric estimators of the stable tail dependence function (STDF): <code class="reqn">\hat{l}_k(x)</code> and <code class="reqn">\tilde{l}_k(x)</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stdf(x, k, X, alpha = 0.5)

stdf2(x, k, X)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="stdf_+3A_x">x</code></td>
<td>

<p>A <code class="reqn">d</code>-dimensional point to estimate the STDF in.
</p>
</td></tr>
<tr><td><code id="stdf_+3A_k">k</code></td>
<td>

<p>Value of the tail index <code class="reqn">k</code>.
</p>
</td></tr>
<tr><td><code id="stdf_+3A_x">X</code></td>
<td>

<p>A data matrix of dimensions <code class="reqn">n</code> by <code class="reqn">d</code> with observations in the rows.
</p>
</td></tr>
<tr><td><code id="stdf_+3A_alpha">alpha</code></td>
<td>

<p>The parameter <code class="reqn">\alpha</code> of the estimator <code class="reqn">\hat{l}_k(x)</code> (<code>stdf</code>), default is 0.5. This argument is not used in <code>stdf2</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The stable tail dependence function in <code class="reqn">x</code> can be estimated by
</p>
<p style="text-align: center;"><code class="reqn"> \hat{l}_k(x) = 1/k \sum_{i=1}^n 1_{\{\exists j\in\{1,\ldots, d\}: \hat{F}_j(X_{i,j})&gt;1-k/n x_j\}}</code>
</p>

<p>with 
</p>
<p style="text-align: center;"><code class="reqn">\hat{F}_j(X_{i,j})=(R_{i,j}-\alpha)/n</code>
</p>

<p>where <code class="reqn">R_{i,j}</code> is the rank of <code class="reqn">X_{i,j}</code> among the <code class="reqn">n</code> observations in the <code class="reqn">j</code>-th dimension:
</p>
<p style="text-align: center;"><code class="reqn">R_{i,j}=\sum_{m=1}^n 1_{\{X_{m,j}\le X_{i,j}\}}.</code>
</p>

<p>This estimator is implemented in <code>stdf</code>.
</p>
<p>The second estimator is given by
</p>
<p style="text-align: center;"><code class="reqn"> \tilde{l}_k(x) = 1/k \sum_{i=1}^n 1_{\{X_{i,1}\ge X^{(1)}_{n-[kx_1]+1,n} or \ldots or X_{i,d}\ge X^{(d)}_{n-[kx_d]+1,n}\}}</code>
</p>

<p>where <code class="reqn">X_{i,n}^{(j)}</code> is the <code class="reqn">i</code>-th smallest observation in the <code class="reqn">j</code>-th dimension.
This estimator is implemented in <code>stdf2</code>.
</p>
<p>See Section 4.5 of Beirlant et al. (2016) for more details.
</p>


<h3>Value</h3>

<p><code>stdf</code> returns the estimate <code class="reqn">\hat{l}_k(x)</code> and <code>stdf2</code> returns the estimate <code class="reqn">\tilde{l}_k(x)</code>.
</p>


<h3>Author(s)</h3>

<p>Tom Reynkens
</p>


<h3>References</h3>

<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>
<p>Beirlant J., Goegebeur Y., Segers, J. and Teugels, J. (2004). <em>Statistics of Extremes: Theory and Applications</em>, Wiley Series in Probability, Wiley, Chichester.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate data matrix
X &lt;- cbind(rpareto(100,2), rpareto(100,3))

# Tail index
k &lt;- 20

# Point to evaluate the STDF in
x &lt;- c(2,3)

# First estimate
stdf(x, k, X)

# Second estimate
stdf2(x, k, X)
</code></pre>

<hr>
<h2 id='tBurr'>
The truncated Burr distribution
</h2><span id='topic+dtburr'></span><span id='topic+ptburr'></span><span id='topic+qtburr'></span><span id='topic+rtburr'></span>

<h3>Description</h3>

<p>Density, distribution function, quantile function and random generation for the truncated Burr distribution (type XII).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dtburr(x, alpha, rho, eta = 1, endpoint = Inf, log = FALSE)
ptburr(x, alpha, rho, eta = 1, endpoint = Inf, lower.tail = TRUE, log.p = FALSE)
qtburr(p, alpha, rho, eta = 1, endpoint = Inf, lower.tail = TRUE, log.p = FALSE)
rtburr(n, alpha, rho, eta = 1, endpoint = Inf)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tBurr_+3A_x">x</code></td>
<td>

<p>Vector of quantiles.
</p>
</td></tr>
<tr><td><code id="tBurr_+3A_p">p</code></td>
<td>

<p>Vector of probabilities.
</p>
</td></tr>
<tr><td><code id="tBurr_+3A_n">n</code></td>
<td>

<p>Number of observations.
</p>
</td></tr>
<tr><td><code id="tBurr_+3A_alpha">alpha</code></td>
<td>

<p>The <code class="reqn">\alpha</code> parameter of the truncated Burr distribution, a strictly positive number.
</p>
</td></tr>
<tr><td><code id="tBurr_+3A_rho">rho</code></td>
<td>

<p>The <code class="reqn">\rho</code> parameter of the truncated Burr distribution, a strictly negative number.
</p>
</td></tr>
<tr><td><code id="tBurr_+3A_eta">eta</code></td>
<td>

<p>The <code class="reqn">\eta</code> parameter of the truncated Burr distribution, a strictly positive number.
The default value is <code>1</code>.
</p>
</td></tr>
<tr><td><code id="tBurr_+3A_endpoint">endpoint</code></td>
<td>

<p>Endpoint of the truncated Burr distribution. The default value is <code>Inf</code> for which the truncated Burr distribution corresponds to the ordinary Burr distribution.
</p>
</td></tr>
<tr><td><code id="tBurr_+3A_log">log</code></td>
<td>

<p>Logical indicating if the densities are given as <code class="reqn">\log(f)</code>, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="tBurr_+3A_lower.tail">lower.tail</code></td>
<td>

<p>Logical indicating if the probabilities are of the form <code class="reqn">P(X\le x)</code> (<code>TRUE</code>) or <code class="reqn">P(X&gt;x)</code> (<code>FALSE</code>). Default is <code>TRUE.</code>
</p>
</td></tr>
<tr><td><code id="tBurr_+3A_log.p">log.p</code></td>
<td>

<p>Logical indicating if the probabilities are given as <code class="reqn">\log(p)</code>, default is <code>FALSE</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Cumulative Distribution Function (CDF) of the truncated Burr distribution is equal to
<code class="reqn">F_T(x) = F(x) / F(T)</code> for <code class="reqn">x \le T</code> where <code class="reqn">F</code> is the CDF of the ordinary Burr distribution and <code class="reqn">T</code> is the endpoint (truncation point) of the truncated Burr distribution.
</p>


<h3>Value</h3>

<p><code>dtburr</code> gives the density function evaluated in <code class="reqn">x</code>, <code>ptburr</code> the CDF evaluated in <code class="reqn">x</code> and <code>qtburr</code> the quantile function evaluated in <code class="reqn">p</code>. The length of the result is equal to the length of <code class="reqn">x</code> or <code class="reqn">p</code>.
</p>
<p><code>rtburr</code> returns a random sample of length <code class="reqn">n</code>.
</p>


<h3>Author(s)</h3>

<p>Tom Reynkens.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pburr">Burr</a></code>,  <code><a href="stats.html#topic+Distributions">Distributions</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Plot of the PDF
x &lt;- seq(0, 10, 0.01)
plot(x, dtburr(x, alpha=2, rho=-1, endpoint=9), xlab="x", ylab="PDF", type="l")

# Plot of the CDF
x &lt;- seq(0, 10, 0.01)
plot(x, ptburr(x, alpha=2, rho=-1, endpoint=9), xlab="x", ylab="CDF", type="l")

</code></pre>

<hr>
<h2 id='tExp'>
The truncated exponential distribution
</h2><span id='topic+dtexp'></span><span id='topic+ptexp'></span><span id='topic+qtexp'></span><span id='topic+rtexp'></span>

<h3>Description</h3>

<p>Density, distribution function, quantile function and random generation for the truncated exponential distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dtexp(x, rate = 1, endpoint = Inf, log = FALSE)
ptexp(x, rate = 1, endpoint = Inf, lower.tail = TRUE, log.p = FALSE)
qtexp(p, rate = 1, endpoint = Inf, lower.tail = TRUE, log.p = FALSE)
rtexp(n, rate = 1, endpoint = Inf)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tExp_+3A_x">x</code></td>
<td>

<p>Vector of quantiles.
</p>
</td></tr>
<tr><td><code id="tExp_+3A_p">p</code></td>
<td>

<p>Vector of probabilities.
</p>
</td></tr>
<tr><td><code id="tExp_+3A_n">n</code></td>
<td>

<p>Number of observations.
</p>
</td></tr>
<tr><td><code id="tExp_+3A_rate">rate</code></td>
<td>

<p>The rate parameter for the exponential distribution, default is 1.
</p>
</td></tr>
<tr><td><code id="tExp_+3A_endpoint">endpoint</code></td>
<td>

<p>Endpoint of the truncated exponential distribution. The default value is <code>Inf</code> for which the truncated exponential distribution corresponds to the ordinary exponential distribution.
</p>
</td></tr>
<tr><td><code id="tExp_+3A_log">log</code></td>
<td>

<p>Logical indicating if the densities are given as <code class="reqn">\log(f)</code>, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="tExp_+3A_lower.tail">lower.tail</code></td>
<td>

<p>Logical indicating if the probabilities are of the form <code class="reqn">P(X\le x)</code> (<code>TRUE</code>) or <code class="reqn">P(X&gt;x)</code> (<code>FALSE</code>). Default is <code>TRUE.</code>
</p>
</td></tr>
<tr><td><code id="tExp_+3A_log.p">log.p</code></td>
<td>

<p>Logical indicating if the probabilities are given as <code class="reqn">\log(p)</code>, default is <code>FALSE</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Cumulative Distribution Function (CDF) of the truncated exponential distribution is equal to
<code class="reqn">F_T(x) = F(x) / F(T)</code> for <code class="reqn">x \le T</code> where <code class="reqn">F</code> is the CDF of the ordinary exponential distribution and <code class="reqn">T</code> is the endpoint (truncation point) of the truncated exponential distribution.
</p>


<h3>Value</h3>

<p><code>dtexp</code> gives the density function evaluated in <code class="reqn">x</code>, <code>ptexp</code> the CDF evaluated in <code class="reqn">x</code> and <code>qtexp</code> the quantile function evaluated in <code class="reqn">p</code>. The length of the result is equal to the length of <code class="reqn">x</code> or <code class="reqn">p</code>.
</p>
<p><code>rtexp</code> returns a random sample of length <code class="reqn">n</code>.
</p>


<h3>Author(s)</h3>

<p>Tom Reynkens.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+Exponential">Exponential</a></code>,  <code><a href="stats.html#topic+Distributions">Distributions</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Plot of the PDF
x &lt;- seq(0, 10, 0.01)
plot(x, dtexp(x, rate = 2, endpoint=5), xlab="x", ylab="PDF", type="l")

# Plot of the CDF
x &lt;- seq(0, 10, 0.01)
plot(x, ptexp(x, rate = 2, endpoint=5), xlab="x", ylab="CDF", type="l")

</code></pre>

<hr>
<h2 id='tFrechet'>
The truncated Frechet distribution
</h2><span id='topic+dtfrechet'></span><span id='topic+ptfrechet'></span><span id='topic+qtfrechet'></span><span id='topic+rtfrechet'></span>

<h3>Description</h3>

<p>Density, distribution function, quantile function and random generation for the truncated Frchet distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dtfrechet(x, shape, loc = 0, scale = 1, endpoint = Inf, log = FALSE)
ptfrechet(x, shape, loc = 0, scale = 1, endpoint = Inf, lower.tail = TRUE, log.p = FALSE)
qtfrechet(p, shape, loc = 0, scale = 1, endpoint = Inf, lower.tail = TRUE, log.p = FALSE)
rtfrechet(n, shape, loc = 0, scale = 1, endpoint = Inf)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tFrechet_+3A_x">x</code></td>
<td>

<p>Vector of quantiles.
</p>
</td></tr>
<tr><td><code id="tFrechet_+3A_p">p</code></td>
<td>

<p>Vector of probabilities.
</p>
</td></tr>
<tr><td><code id="tFrechet_+3A_n">n</code></td>
<td>

<p>Number of observations.
</p>
</td></tr>
<tr><td><code id="tFrechet_+3A_shape">shape</code></td>
<td>

<p>Shape parameter of the Frchet distribution.
</p>
</td></tr>
<tr><td><code id="tFrechet_+3A_loc">loc</code></td>
<td>

<p>Location parameter of the Frchet distribution, default is 0.
</p>
</td></tr>
<tr><td><code id="tFrechet_+3A_scale">scale</code></td>
<td>

<p>Scale parameter of the Frchet distribution, default is 1.
</p>
</td></tr>
<tr><td><code id="tFrechet_+3A_endpoint">endpoint</code></td>
<td>

<p>Endpoint of the truncated Frchet distribution. The default value is <code>Inf</code> for which the truncated Frchet distribution corresponds to the ordinary Frchet distribution.
</p>
</td></tr>
<tr><td><code id="tFrechet_+3A_log">log</code></td>
<td>

<p>Logical indicating if the densities are given as <code class="reqn">\log(f)</code>, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="tFrechet_+3A_lower.tail">lower.tail</code></td>
<td>

<p>Logical indicating if the probabilities are of the form <code class="reqn">P(X\le x)</code> (<code>TRUE</code>) or <code class="reqn">P(X&gt;x)</code> (<code>FALSE</code>). Default is <code>TRUE.</code>
</p>
</td></tr>
<tr><td><code id="tFrechet_+3A_log.p">log.p</code></td>
<td>

<p>Logical indicating if the probabilities are given as <code class="reqn">\log(p)</code>, default is <code>FALSE</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Cumulative Distribution Function (CDF) of the truncated Frchet distribution is equal to
<code class="reqn">F_T(x) = F(x) / F(T)</code> for <code class="reqn">x \le T</code> where <code class="reqn">F</code> is the CDF of an ordinary Frchet distribution and <code class="reqn">T</code> is the endpoint (truncation point) of the truncated Frchet distribution.
</p>


<h3>Value</h3>

<p><code>dtfrechet</code> gives the density function evaluated in <code class="reqn">x</code>, <code>ptfrechet</code> the CDF evaluated in <code class="reqn">x</code> and <code>qtfrechet</code> the quantile function evaluated in <code class="reqn">p</code>. The length of the result is equal to the length of <code class="reqn">x</code> or <code class="reqn">p</code>.
</p>
<p><code>rtfrechet</code> returns a random sample of length <code class="reqn">n</code>.
</p>


<h3>Author(s)</h3>

<p>Tom Reynkens.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pfrechet">Frchet</a></code>,  <code><a href="stats.html#topic+Distributions">Distributions</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Plot of the PDF
x &lt;- seq(1, 10, 0.01)
plot(x, dtfrechet(x, shape=2, endpoint=5), xlab="x", ylab="PDF", type="l")

# Plot of the CDF
x &lt;- seq(1, 10, 0.01)
plot(x, ptfrechet(x, shape=2, endpoint=5), xlab="x", ylab="CDF", type="l")

</code></pre>

<hr>
<h2 id='tGPD'>
The truncated generalised Pareto distribution
</h2><span id='topic+dtgpd'></span><span id='topic+ptgpd'></span><span id='topic+qtgpd'></span><span id='topic+rtgpd'></span>

<h3>Description</h3>

<p>Density, distribution function, quantile function and random generation for the truncated Generalised Pareto Distribution (GPD).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dtgpd(x, gamma, mu = 0, sigma, endpoint = Inf, log = FALSE)
ptgpd(x, gamma, mu = 0, sigma, endpoint = Inf, lower.tail = TRUE, log.p = FALSE)
qtgpd(p, gamma, mu = 0, sigma, endpoint = Inf, lower.tail = TRUE, log.p = FALSE)
rtgpd(n, gamma, mu = 0, sigma, endpoint = Inf)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tGPD_+3A_x">x</code></td>
<td>

<p>Vector of quantiles.
</p>
</td></tr>
<tr><td><code id="tGPD_+3A_p">p</code></td>
<td>

<p>Vector of probabilities.
</p>
</td></tr>
<tr><td><code id="tGPD_+3A_n">n</code></td>
<td>

<p>Number of observations.
</p>
</td></tr>
<tr><td><code id="tGPD_+3A_gamma">gamma</code></td>
<td>

<p>The <code class="reqn">\gamma</code> parameter of the GPD, a real number.
</p>
</td></tr>
<tr><td><code id="tGPD_+3A_mu">mu</code></td>
<td>

<p>The <code class="reqn">\mu</code> parameter of the GPD, a strictly positive number. Default is 0.
</p>
</td></tr>
<tr><td><code id="tGPD_+3A_sigma">sigma</code></td>
<td>

<p>The <code class="reqn">\sigma</code> parameter of the GPD, a strictly positive number.
</p>
</td></tr>
<tr><td><code id="tGPD_+3A_endpoint">endpoint</code></td>
<td>

<p>Endpoint of the truncated GPD. The default value is <code>Inf</code> for which the truncated GPD corresponds to the ordinary GPD.
</p>
</td></tr>
<tr><td><code id="tGPD_+3A_log">log</code></td>
<td>

<p>Logical indicating if the densities are given as <code class="reqn">\log(f)</code>, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="tGPD_+3A_lower.tail">lower.tail</code></td>
<td>

<p>Logical indicating if the probabilities are of the form <code class="reqn">P(X\le x)</code> (<code>TRUE</code>) or <code class="reqn">P(X&gt;x)</code> (<code>FALSE</code>). Default is <code>TRUE.</code>
</p>
</td></tr>
<tr><td><code id="tGPD_+3A_log.p">log.p</code></td>
<td>

<p>Logical indicating if the probabilities are given as <code class="reqn">\log(p)</code>, default is <code>FALSE</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Cumulative Distribution Function (CDF) of the truncated GPD is equal to
<code class="reqn">F_T(x) = F(x) / F(T)</code> for <code class="reqn">x \le T</code> where <code class="reqn">F</code> is the CDF of the ordinary GPD and <code class="reqn">T</code> is the endpoint (truncation point) of the truncated GPD.
</p>


<h3>Value</h3>

<p><code>dtgpd</code> gives the density function evaluated in <code class="reqn">x</code>, <code>ptgpd</code> the CDF evaluated in <code class="reqn">x</code> and <code>qtgpd</code> the quantile function evaluated in <code class="reqn">p</code>. The length of the result is equal to the length of <code class="reqn">x</code> or <code class="reqn">p</code>.
</p>
<p><code>rtgpd</code> returns a random sample of length <code class="reqn">n</code>.
</p>


<h3>Author(s)</h3>

<p>Tom Reynkens
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ptgpd">tGPD</a></code>, <code><a href="#topic+ppareto">Pareto</a></code>, <code><a href="stats.html#topic+Distributions">Distributions</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Plot of the PDF
x &lt;- seq(0, 10, 0.01)
plot(x, dtgpd(x, gamma=1/2, sigma=5, endpoint=8), xlab="x", ylab="PDF", type="l")

# Plot of the CDF
x &lt;- seq(0, 10, 0.01)
plot(x, ptgpd(x, gamma=1/2, sigma=5, endpoint=8), xlab="x", ylab="CDF", type="l")

</code></pre>

<hr>
<h2 id='tlnorm'>
The truncated log-normal distribution
</h2><span id='topic+dtlnorm'></span><span id='topic+ptlnorm'></span><span id='topic+qtlnorm'></span><span id='topic+rtlnorm'></span>

<h3>Description</h3>

<p>Density, distribution function, quantile function and random generation for the truncated log-normal distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dtlnorm(x, meanlog = 0, sdlog = 1, endpoint = Inf, log = FALSE)
ptlnorm(x, meanlog = 0, sdlog = 1, endpoint = Inf, lower.tail = TRUE, log.p = FALSE)
qtlnorm(p, meanlog = 0, sdlog = 1, endpoint = Inf, lower.tail = TRUE, log.p = FALSE)
rtlnorm(n, meanlog = 0, sdlog = 1, endpoint = Inf)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tlnorm_+3A_x">x</code></td>
<td>

<p>Vector of quantiles.
</p>
</td></tr>
<tr><td><code id="tlnorm_+3A_p">p</code></td>
<td>

<p>Vector of probabilities.
</p>
</td></tr>
<tr><td><code id="tlnorm_+3A_n">n</code></td>
<td>

<p>Number of observations.
</p>
</td></tr>
<tr><td><code id="tlnorm_+3A_meanlog">meanlog</code></td>
<td>

<p>Mean of the distribution on the log scale, default is 0.
</p>
</td></tr>
<tr><td><code id="tlnorm_+3A_sdlog">sdlog</code></td>
<td>

<p>Standard deviation of the distribution on the log scale, default is 1.
</p>
</td></tr>
<tr><td><code id="tlnorm_+3A_endpoint">endpoint</code></td>
<td>

<p>Endpoint of the truncated log-normal distribution. The default value is <code>Inf</code> for which the truncated log-normal distribution corresponds to the ordinary log-normal distribution.
</p>
</td></tr>
<tr><td><code id="tlnorm_+3A_log">log</code></td>
<td>

<p>Logical indicating if the densities are given as <code class="reqn">\log(f)</code>, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="tlnorm_+3A_lower.tail">lower.tail</code></td>
<td>

<p>Logical indicating if the probabilities are of the form <code class="reqn">P(X\le x)</code> (<code>TRUE</code>) or <code class="reqn">P(X&gt;x)</code> (<code>FALSE</code>). Default is <code>TRUE.</code>
</p>
</td></tr>
<tr><td><code id="tlnorm_+3A_log.p">log.p</code></td>
<td>

<p>Logical indicating if the probabilities are given as <code class="reqn">\log(p)</code>, default is <code>FALSE</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Cumulative Distribution Function (CDF) of the truncated log-normal distribution is equal to
<code class="reqn">F_T(x) = F(x) / F(T)</code> for <code class="reqn">x \le T</code> where <code class="reqn">F</code> is the CDF of the ordinary log-normal distribution and <code class="reqn">T</code> is the endpoint (truncation point) of the truncated log-normal distribution.
</p>


<h3>Value</h3>

<p><code>dtlnorm</code> gives the density function evaluated in <code class="reqn">x</code>, <code>ptlnorm</code> the CDF evaluated in <code class="reqn">x</code> and <code>qtlnorm</code> the quantile function evaluated in <code class="reqn">p</code>. The length of the result is equal to the length of <code class="reqn">x</code> or <code class="reqn">p</code>.
</p>
<p><code>rtlnorm</code> returns a random sample of length <code class="reqn">n</code>.
</p>


<h3>Author(s)</h3>

<p>Tom Reynkens.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+Lognormal">Lognormal</a></code>,  <code><a href="stats.html#topic+Distributions">Distributions</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Plot of the PDF
x &lt;- seq(0, 10, 0.01)
plot(x, dtlnorm(x, endpoint=9), xlab="x", ylab="PDF", type="l")

# Plot of the CDF
x &lt;- seq(0, 10, 0.01)
plot(x, ptlnorm(x, endpoint=9), xlab="x", ylab="CDF", type="l")

</code></pre>

<hr>
<h2 id='tPareto'>
The truncated Pareto distribution
</h2><span id='topic+dtpareto'></span><span id='topic+ptpareto'></span><span id='topic+qtpareto'></span><span id='topic+rtpareto'></span>

<h3>Description</h3>

<p>Density, distribution function, quantile function and random generation for the truncated Pareto distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dtpareto(x, shape, scale = 1, endpoint = Inf, log = FALSE)
ptpareto(x, shape, scale = 1, endpoint = Inf, lower.tail = TRUE, log.p = FALSE)
qtpareto(p, shape, scale = 1, endpoint = Inf, lower.tail = TRUE, log.p = FALSE)
rtpareto(n, shape, scale = 1, endpoint = Inf)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tPareto_+3A_x">x</code></td>
<td>

<p>Vector of quantiles.
</p>
</td></tr>
<tr><td><code id="tPareto_+3A_p">p</code></td>
<td>

<p>Vector of probabilities.
</p>
</td></tr>
<tr><td><code id="tPareto_+3A_n">n</code></td>
<td>

<p>Number of observations.
</p>
</td></tr>
<tr><td><code id="tPareto_+3A_shape">shape</code></td>
<td>

<p>The shape parameter of the truncated Pareto distribution, a strictly positive number.
</p>
</td></tr>
<tr><td><code id="tPareto_+3A_scale">scale</code></td>
<td>

<p>The scale parameter of the truncated Pareto distribution, a strictly positive number. Its default value is <code>1</code>.
</p>
</td></tr>
<tr><td><code id="tPareto_+3A_endpoint">endpoint</code></td>
<td>

<p>Endpoint of the truncated Pareto distribution. The default value is <code>Inf</code> for which the truncated Pareto distribution corresponds to the ordinary Pareto distribution.
</p>
</td></tr>
<tr><td><code id="tPareto_+3A_log">log</code></td>
<td>

<p>Logical indicating if the densities are given as <code class="reqn">\log(f)</code>, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="tPareto_+3A_lower.tail">lower.tail</code></td>
<td>

<p>Logical indicating if the probabilities are of the form <code class="reqn">P(X\le x)</code> (<code>TRUE</code>) or <code class="reqn">P(X&gt;x)</code> (<code>FALSE</code>). Default is <code>TRUE.</code>
</p>
</td></tr>
<tr><td><code id="tPareto_+3A_log.p">log.p</code></td>
<td>

<p>Logical indicating if the probabilities are given as <code class="reqn">\log(p)</code>, default is <code>FALSE</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Cumulative Distribution Function (CDF) of the truncated Pareto distribution is equal to
<code class="reqn">F_T(x) = F(x) / F(T)</code> for <code class="reqn">x \le T</code> where <code class="reqn">F</code> is the CDF of an ordinary Pareto distribution and <code class="reqn">T</code> is the endpoint (truncation point) of the truncated Pareto distribution.
</p>


<h3>Value</h3>

<p><code>dtpareto</code> gives the density function evaluated in <code class="reqn">x</code>, <code>ptpareto</code> the CDF evaluated in <code class="reqn">x</code> and <code>qtpareto</code> the quantile function evaluated in <code class="reqn">p</code>. The length of the result is equal to the length of <code class="reqn">x</code> or <code class="reqn">p</code>.
</p>
<p><code>rtpareto</code> returns a random sample of length <code class="reqn">n</code>.
</p>


<h3>Author(s)</h3>

<p>Tom Reynkens
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ppareto">Pareto</a></code>, <code><a href="stats.html#topic+Distributions">Distributions</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Plot of the PDF
x = seq(1,10,0.01)
plot(x, dtpareto(x, shape=2, endpoint=10), xlab="x", ylab="PDF", type="l")

# Plot of the CDF
x = seq(1,10,0.01)
plot(x, ptpareto(x, shape=2, endpoint=10), xlab="x", ylab="CDF", type="l")
</code></pre>

<hr>
<h2 id='trDT'>
Truncation odds
</h2><span id='topic+trDT'></span>

<h3>Description</h3>

<p>Estimates of truncation odds of the truncated probability mass under the untruncated distribution using truncated Hill.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trDT(data, r = 1, gamma, plot = FALSE, add = FALSE, main = "Estimates of DT", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="trDT_+3A_data">data</code></td>
<td>

<p>Vector of <code class="reqn">n</code> observations. 
</p>
</td></tr>
<tr><td><code id="trDT_+3A_r">r</code></td>
<td>

<p>Trimming parameter, default is <code>1</code> (no trimming).
</p>
</td></tr>
<tr><td><code id="trDT_+3A_gamma">gamma</code></td>
<td>

<p>Vector of <code class="reqn">n-1</code> estimates for the EVI obtained from <code><a href="#topic+trHill">trHill</a></code>.
</p>
</td></tr>
<tr><td><code id="trDT_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the estimates of <code class="reqn">D_T</code> should be plotted as a function of <code class="reqn">k</code>, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="trDT_+3A_add">add</code></td>
<td>

<p>Logical indicating if the estimates of <code class="reqn">D_T</code> should be added to an existing plot, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="trDT_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"Estimates of DT"</code>.
</p>
</td></tr>
<tr><td><code id="trDT_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The truncation odds is defined as
</p>
<p style="text-align: center;"><code class="reqn">D_T=(1-F(T))/F(T)</code>
</p>
<p> with <code class="reqn">T</code> the upper truncation point and <code class="reqn">F</code> the CDF of the untruncated distribution (e.g. Pareto distribution).
</p>
<p>We estimate this truncation odds as
</p>
<p style="text-align: center;"><code class="reqn">\hat{D}_T=\max\{ (k+1)/(n+1) ( R_{r,k,n}^{1/\gamma_k} - 1/(k+1) ) / (1-R_{r,k,n}^{1/\gamma_k}), 0\}</code>
</p>

<p>with <code class="reqn">R_{r,k,n} = X_{n-k,n} / X_{n-r+1,n}</code>.
</p>
<p>See Beirlant et al. (2016) or Section 4.2.3 of Albrecher et al. (2017) for more details.
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>k</code></td>
<td>
<p>Vector of the values of the tail parameter <code class="reqn">k</code>.</p>
</td></tr>
<tr><td><code>DT</code></td>
<td>
<p>Vector of the corresponding estimates for the truncation odds <code class="reqn">D_T</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens based on <code>R</code> code of Dries Cornilly.
</p>


<h3>References</h3>

<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>
<p>Beirlant, J., Fraga Alves, M.I. and Gomes, M.I. (2016). &quot;Tail fitting for Truncated and Non-truncated Pareto-type Distributions.&quot; <em>Extremes</em>, 19, 429&ndash;462.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+trHill">trHill</a></code>, <code><a href="#topic+trEndpoint">trEndpoint</a></code>, <code><a href="#topic+trQuant">trQuant</a></code>, <code><a href="#topic+trDTMLE">trDTMLE</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Sample from truncated Pareto distribution.
# truncated at 99% quantile
shape &lt;- 2
X &lt;- rtpareto(n=1000, shape=shape, endpoint=qpareto(0.99, shape=shape))

# Truncated Hill estimator
trh &lt;- trHill(X, plot=TRUE, ylim=c(0,2))

# Truncation odds
dt &lt;- trDT(X, gamma=trh$gamma, plot=TRUE, ylim=c(0,0.05))
</code></pre>

<hr>
<h2 id='trDTMLE'>
Truncation odds
</h2><span id='topic+trDTMLE'></span>

<h3>Description</h3>

<p>Estimates of truncation odds of the truncated probability mass under the untruncated distribution using truncated MLE.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trDTMLE(data, gamma, tau, plot = FALSE, add = FALSE, main = "Estimates of DT", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="trDTMLE_+3A_data">data</code></td>
<td>

<p>Vector of <code class="reqn">n</code> observations. 
</p>
</td></tr>
<tr><td><code id="trDTMLE_+3A_gamma">gamma</code></td>
<td>

<p>Vector of <code class="reqn">n-1</code> estimates for the EVI obtained from <code><a href="#topic+trMLE">trMLE</a></code>.
</p>
</td></tr>
<tr><td><code id="trDTMLE_+3A_tau">tau</code></td>
<td>

<p>Vector of <code class="reqn">n-1</code> estimates for the <code class="reqn">\tau</code> obtained from <code><a href="#topic+trMLE">trMLE</a></code>.
</p>
</td></tr>
<tr><td><code id="trDTMLE_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the estimates of <code class="reqn">D_T</code> should be plotted as a function of <code class="reqn">k</code>, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="trDTMLE_+3A_add">add</code></td>
<td>

<p>Logical indicating if the estimates of <code class="reqn">D_T</code> should be added to an existing plot, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="trDTMLE_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"Estimates of DT"</code>.
</p>
</td></tr>
<tr><td><code id="trDTMLE_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The truncation odds is defined as
</p>
<p style="text-align: center;"><code class="reqn">D_T=(1-F(T))/F(T)</code>
</p>
<p> with <code class="reqn">T</code> the upper truncation point and <code class="reqn">F</code> the CDF of the untruncated distribution (e.g. GPD).
</p>
<p>We estimate this truncation odds as
</p>
<p style="text-align: center;"><code class="reqn">\hat{D}_T=\max\{ (k+1)/(n+1) ( (1+\hat{\tau}_k E_{1,k})^{-1/\hat{\xi}_k} - 1/(k+1) ) / (1-(1+\hat{\tau}_k E_{1,k})^{-1/\hat{\xi}_k}), 0\}</code>
</p>

<p>with <code class="reqn">E_{1,k} = X_{n,n}-X_{n-k,n}</code>.
</p>
<p>See Beirlant et al. (2017) for more details.
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>k</code></td>
<td>
<p>Vector of the values of the tail parameter <code class="reqn">k</code>.</p>
</td></tr>
<tr><td><code>DT</code></td>
<td>
<p>Vector of the corresponding estimates for the truncation odds <code class="reqn">D_T</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens.
</p>


<h3>References</h3>

<p>Beirlant, J., Fraga Alves, M. I. and Reynkens, T. (2017). &quot;Fitting Tails Affected by Truncation&quot;. <em>Electronic Journal of Statistics</em>, 11(1), 2026&ndash;2065.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+trMLE">trMLE</a></code>, <code><a href="#topic+trEndpointMLE">trEndpointMLE</a></code>, <code><a href="#topic+trProbMLE">trProbMLE</a></code>, <code><a href="#topic+trQuantMLE">trQuantMLE</a></code>, <code><a href="#topic+trTestMLE">trTestMLE</a></code>, <code><a href="#topic+trDT">trDT</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Sample from GPD truncated at 99% quantile
gamma &lt;- 0.5
sigma &lt;- 1.5
X &lt;- rtgpd(n=250, gamma=gamma, sigma=sigma, endpoint=qgpd(0.99, gamma=gamma, sigma=sigma))

# Truncated ML estimator
trmle &lt;- trMLE(X, plot=TRUE, ylim=c(0,2))

# Truncation odds
dtmle &lt;- trDTMLE(X, gamma=trmle$gamma, tau=trmle$tau, plot=TRUE, ylim=c(0,0.05))
</code></pre>

<hr>
<h2 id='trEndpoint'>
Estimator of endpoint
</h2><span id='topic+trEndpoint'></span>

<h3>Description</h3>

<p>Estimator of endpoint using truncated Hill estimates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trEndpoint(data, r = 1, gamma, plot = FALSE, add = FALSE,
           main = "Estimates of endpoint", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="trEndpoint_+3A_data">data</code></td>
<td>

<p>Vector of <code class="reqn">n</code> observations. 
</p>
</td></tr>
<tr><td><code id="trEndpoint_+3A_r">r</code></td>
<td>

<p>Trimming parameter, default is <code>1</code> (no trimming).
</p>
</td></tr>
<tr><td><code id="trEndpoint_+3A_gamma">gamma</code></td>
<td>

<p>Vector of <code class="reqn">n-1</code> estimates for the EVI obtained from <code><a href="#topic+trHill">trHill</a></code>.
</p>
</td></tr>
<tr><td><code id="trEndpoint_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the estimates of <code class="reqn">T</code> should be plotted as a function of <code class="reqn">k</code>, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="trEndpoint_+3A_add">add</code></td>
<td>

<p>Logical indicating if the estimates of <code class="reqn">T</code> should be added to an existing plot, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="trEndpoint_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"Estimates of endpoint"</code>.
</p>
</td></tr>
<tr><td><code id="trEndpoint_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The endpoint is estimated as
</p>
<p style="text-align: center;"><code class="reqn">\hat{T}_{k,n} = \max\{X_{n-k,n}  ( ((X_{n-k,n}/X_{n,n})^{1/\hat{\gamma}_k} - 1/(k+1)) / (1-1/(k+1)))^{-\hat{\gamma}_k}, X_{n,n}\}</code>
</p>

<p>with <code class="reqn">\hat{\gamma}_k</code> the Hill estimates adapted for truncation.
</p>
<p>See Beirlant et al. (2016) or Section 4.2.3 of Albrecher et al. (2017) for more details.
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>k</code></td>
<td>
<p>Vector of the values of the tail parameter <code class="reqn">k</code>.</p>
</td></tr>
<tr><td><code>Tk</code></td>
<td>
<p>Vector of the corresponding estimates for the endpoint <code class="reqn">T</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens based on <code>R</code> code of Dries Cornilly.
</p>


<h3>References</h3>

<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>
<p>Beirlant, J., Fraga Alves, M.I. and Gomes, M.I. (2016). &quot;Tail fitting for Truncated and Non-truncated Pareto-type Distributions.&quot; <em>Extremes</em>, 19, 429&ndash;462.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+trHill">trHill</a></code>, <code><a href="#topic+trDT">trDT</a></code>, <code><a href="#topic+trEndpointMLE">trEndpointMLE</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Sample from truncated Pareto distribution.
# truncated at 99% quantile
shape &lt;- 2
X &lt;- rtpareto(n=1000, shape=shape, endpoint=qpareto(0.99, shape=shape))

# Truncated Hill estimator
trh &lt;- trHill(X, plot=TRUE, ylim=c(0,2))

# Endpoint
trEndpoint(X, gamma=trh$gamma, plot=TRUE, ylim=c(8,12))
abline(h=qpareto(0.99, shape=shape), lty=2)
</code></pre>

<hr>
<h2 id='trEndpointMLE'>
Estimator of endpoint
</h2><span id='topic+trEndpointMLE'></span>

<h3>Description</h3>

<p>Estimator of endpoint using truncated ML estimates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trEndpointMLE(data, gamma, tau, plot = FALSE, add = FALSE, 
              main = "Estimates of endpoint", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="trEndpointMLE_+3A_data">data</code></td>
<td>

<p>Vector of <code class="reqn">n</code> observations. 
</p>
</td></tr>
<tr><td><code id="trEndpointMLE_+3A_gamma">gamma</code></td>
<td>

<p>Vector of <code class="reqn">n-1</code> estimates for the EVI obtained from <code><a href="#topic+trMLE">trMLE</a></code>.
</p>
</td></tr>
<tr><td><code id="trEndpointMLE_+3A_tau">tau</code></td>
<td>

<p>Vector of <code class="reqn">n-1</code> estimates for the <code class="reqn">\tau</code> obtained from <code><a href="#topic+trMLE">trMLE</a></code>.
</p>
</td></tr>
<tr><td><code id="trEndpointMLE_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the estimates of <code class="reqn">T</code> should be plotted as a function of <code class="reqn">k</code>, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="trEndpointMLE_+3A_add">add</code></td>
<td>

<p>Logical indicating if the estimates of <code class="reqn">T</code> should be added to an existing plot, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="trEndpointMLE_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"Estimates of endpoint"</code>.
</p>
</td></tr>
<tr><td><code id="trEndpointMLE_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The endpoint is estimated as
</p>
<p style="text-align: center;"><code class="reqn">\hat{T}_{k} = X_{n-k,n} + 1/\hat{\tau}_k[( (1-1/k)/((1+ \hat{\tau}_k (X_{n,n}-X_{n-k,n}))^{-1/\hat{\xi}_k}-1/k))^{\hat{\xi}_k} -1]</code>
</p>

<p>with <code class="reqn">\hat{\gamma}_k</code> and <code class="reqn">\hat{\tau}_k</code> the truncated ML estimates for <code class="reqn">\gamma</code> and <code class="reqn">\tau</code>.
</p>
<p>See Beirlant et al. (2017) for more details.
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>k</code></td>
<td>
<p>Vector of the values of the tail parameter <code class="reqn">k</code>.</p>
</td></tr>
<tr><td><code>Tk</code></td>
<td>
<p>Vector of the corresponding estimates for the endpoint <code class="reqn">T</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens.
</p>


<h3>References</h3>

<p>Beirlant, J., Fraga Alves, M. I. and Reynkens, T. (2017). &quot;Fitting Tails Affected by Truncation&quot;. <em>Electronic Journal of Statistics</em>, 11(1), 2026&ndash;2065.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+trMLE">trMLE</a></code>, <code><a href="#topic+trDTMLE">trDTMLE</a></code>, <code><a href="#topic+trProbMLE">trProbMLE</a></code>, <code><a href="#topic+trQuantMLE">trQuantMLE</a></code>, <code><a href="#topic+trTestMLE">trTestMLE</a></code>, <code><a href="#topic+trEndpoint">trEndpoint</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Sample from GPD truncated at 99% quantile
gamma &lt;- 0.5
sigma &lt;- 1.5
X &lt;- rtgpd(n=250, gamma=gamma, sigma=sigma, endpoint=qgpd(0.99, gamma=gamma, sigma=sigma))

# Truncated ML estimator
trmle &lt;- trMLE(X, plot=TRUE, ylim=c(0,2))

# Endpoint
trEndpointMLE(X, gamma=trmle$gamma, tau=trmle$tau, plot=TRUE, ylim=c(0,50))
abline(h=qgpd(0.99, gamma=gamma, sigma=sigma), lty=2)
</code></pre>

<hr>
<h2 id='trHill'>
Hill estimator for upper truncated data
</h2><span id='topic+trHill'></span>

<h3>Description</h3>

<p>Computes the Hill estimator for positive extreme value indices, adapted for upper truncation, as a function of the tail parameter <code class="reqn">k</code> (Aban et al. 2006; Beirlant et al., 2016). Optionally, these estimates are plotted as a function of <code class="reqn">k</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trHill(data, r = 1, tol = 1e-08, maxiter = 100, logk = FALSE,
       plot = FALSE, add = FALSE, main = "Estimates of the EVI", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="trHill_+3A_data">data</code></td>
<td>

<p>Vector of <code class="reqn">n</code> observations. 
</p>
</td></tr>
<tr><td><code id="trHill_+3A_r">r</code></td>
<td>

<p>Trimming parameter, default is <code>1</code> (no trimming).
</p>
</td></tr>
<tr><td><code id="trHill_+3A_tol">tol</code></td>
<td>

<p>Numerical tolerance for stopping criterion used in Newton-Raphson iterations, default is <code>1e-08</code>.
</p>
</td></tr>
<tr><td><code id="trHill_+3A_maxiter">maxiter</code></td>
<td>

<p>Maximum number of Newton-Raphson iterations, default is <code>100</code>.
</p>
</td></tr>
<tr><td><code id="trHill_+3A_logk">logk</code></td>
<td>

<p>Logical indicating if the estimates are plotted as a function of <code class="reqn">\log(k)</code> (<code>logk=TRUE</code>) or as a function of <code class="reqn">k</code>. Default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="trHill_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the estimates of <code class="reqn">\gamma</code> should be plotted as a function of <code class="reqn">k</code>, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="trHill_+3A_add">add</code></td>
<td>

<p>Logical indicating if the estimates of <code class="reqn">\gamma</code> should be added to an existing plot, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="trHill_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"Estimates of the EVI"</code>.
</p>
</td></tr>
<tr><td><code id="trHill_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The truncated Hill estimator is the MLE for <code class="reqn">\gamma</code> under the truncated Pareto distribution.
</p>
<p>To estimate the EVI using the truncated Hill estimator an equation needs to be solved. Beirlant et al. (2016) propose
to use Newton-Raphson iterations to solve this equation. We take the trimmed Hill estimates as starting values for this algorithm. The trimmed Hill estimator is defined as
</p>
<p style="text-align: center;"><code class="reqn">H_{r,k,n} = 1/(k-r+1) \sum_{j=r}^k \log(X_{n-j+1,n})-\log(X_{n-k,n})</code>
</p>
<p>   for <code class="reqn">1 \le r &lt; k &lt; n</code>
and is a basic extension of the Hill estimator for upper truncated data (the ordinary Hill estimator is obtained for <code class="reqn">r=1</code>).
</p>
<p>The equation that needs to be solved is
</p>
<p style="text-align: center;"><code class="reqn">H_{r,k,n} = \gamma + R_{r,k,n}^{1/\gamma} \log(R_{r,k,n}) / (1-R_{r,k,n}^{1/\gamma})</code>
</p>

<p>with <code class="reqn">R_{r,k,n} = X_{n-k,n} / X_{n-r+1,n}</code>.
</p>
<p>See Beirlant et al. (2016) or Section 4.2.3 of Albrecher et al. (2017) for more details.
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>k</code></td>
<td>
<p>Vector of the values of the tail parameter <code class="reqn">k</code>.</p>
</td></tr>
<tr><td><code>gamma</code></td>
<td>
<p>Vector of the corresponding estimates for <code class="reqn">\gamma</code>.</p>
</td></tr>
<tr><td><code>H</code></td>
<td>
<p>Vector of corresponding trimmed Hill estimates.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens based on <code>R</code> code of Dries Cornilly.
</p>


<h3>References</h3>

<p>Aban, I.B., Meerschaert, M.M. and Panorska, A.K. (2006). &quot;Parameter Estimation for the Truncated
Pareto Distribution.&quot; <em>Journal of the American Statistical Association</em>, 101, 270&ndash;277.
</p>
<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>
<p>Beirlant, J., Fraga Alves, M.I. and Gomes, M.I. (2016). &quot;Tail fitting for Truncated and Non-truncated Pareto-type Distributions.&quot; <em>Extremes</em>, 19, 429&ndash;462.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Hill">Hill</a></code>, <code><a href="#topic+trDT">trDT</a></code>, <code><a href="#topic+trEndpoint">trEndpoint</a></code>, <code><a href="#topic+trProb">trProb</a></code>, <code><a href="#topic+trQuant">trQuant</a></code>, <code><a href="#topic+trMLE">trMLE</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Sample from truncated Pareto distribution.
# truncated at 99% quantile
shape &lt;- 2
X &lt;- rtpareto(n=1000, shape=shape, endpoint=qpareto(0.99, shape=shape))

# Truncated Hill estimator
trh &lt;- trHill(X, plot=TRUE, ylim=c(0,2))
</code></pre>

<hr>
<h2 id='trMLE'>
MLE estimator for upper truncated data
</h2><span id='topic+trMLE'></span>

<h3>Description</h3>

<p>Computes the ML estimator for the extreme value index, adapted for upper truncation, as a function of the tail parameter <code class="reqn">k</code> (Beirlant et al., 2017). Optionally, these estimates are plotted as a function of <code class="reqn">k</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trMLE(data, start = c(1, 1), eps = 10^(-10), 
      plot = TRUE, add = FALSE, main = "Estimates for EVI", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="trMLE_+3A_data">data</code></td>
<td>

<p>Vector of <code class="reqn">n</code> observations. 
</p>
</td></tr>
<tr><td><code id="trMLE_+3A_start">start</code></td>
<td>

<p>Starting values for <code class="reqn">\gamma</code> and <code class="reqn">\tau</code> for the numerical optimisation.
</p>
</td></tr>
<tr><td><code id="trMLE_+3A_eps">eps</code></td>
<td>

<p>Numerical tolerance, see Details. By default it is equal to <code>10^(-10)</code>.
</p>
</td></tr>
<tr><td><code id="trMLE_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the estimates of <code class="reqn">\gamma</code> should be plotted as a function of <code class="reqn">k</code>, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="trMLE_+3A_add">add</code></td>
<td>

<p>Logical indicating if the estimates of <code class="reqn">\gamma</code> should be added to an existing plot, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="trMLE_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"Estimates of the EVI"</code>.
</p>
</td></tr>
<tr><td><code id="trMLE_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We compute the MLE for the <code class="reqn">\gamma</code> and <code class="reqn">\sigma</code> parameters of the truncated GPD.
For numerical reasons, we compute the MLE for <code class="reqn">\tau=\gamma/\sigma</code> and transform this estimate to <code class="reqn">\sigma</code>.
</p>
<p>The log-likelihood is given by
</p>
<p style="text-align: center;"><code class="reqn">(k-1) \ln \tau - (k-1) \ln \xi- ( 1 + 1/\xi)\sum_{j=2}^k \ln (1+\tau E_{j,k}) -(k-1) \ln( 1- (1+ \tau E_{1,k})^{-1/\xi})</code>
</p>

<p>with <code class="reqn">E_{j,k} = X_{n-j+1,n}-X_{n-k,n}</code>.
</p>
<p>In order to meet the restrictions <code class="reqn">\sigma=\xi/\tau&gt;0</code> and  <code class="reqn">1+\tau E_{j,k}&gt;0</code> for <code class="reqn">j=1,\ldots,k</code>, we require the estimates of these quantities to be larger than the numerical tolerance value <code>eps</code>.
</p>
<p>See Beirlant et al. (2017) for more details.
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>k</code></td>
<td>
<p>Vector of the values of the tail parameter <code class="reqn">k</code>.</p>
</td></tr>
<tr><td><code>gamma</code></td>
<td>
<p>Vector of the corresponding estimates for <code class="reqn">\gamma</code>.</p>
</td></tr>
<tr><td><code>tau</code></td>
<td>
<p>Vector of the corresponding estimates for <code class="reqn">\tau</code>.</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>Vector of the corresponding estimates for <code class="reqn">\sigma</code>.</p>
</td></tr>
<tr><td><code>conv</code></td>
<td>
<p>Convergence indicator of <code><a href="stats.html#topic+optim">optim</a></code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens.
</p>


<h3>References</h3>

<p>Beirlant, J., Fraga Alves, M. I. and Reynkens, T. (2017). &quot;Fitting Tails Affected by Truncation&quot;. <em>Electronic Journal of Statistics</em>, 11(1), 2026&ndash;2065.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+trDTMLE">trDTMLE</a></code>, <code><a href="#topic+trEndpointMLE">trEndpointMLE</a></code>, <code><a href="#topic+trProbMLE">trProbMLE</a></code>, <code><a href="#topic+trQuantMLE">trQuantMLE</a></code>, <code><a href="#topic+trTestMLE">trTestMLE</a></code>, <code><a href="#topic+trHill">trHill</a></code>, <code><a href="#topic+GPDmle">GPDmle</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Sample from GPD truncated at 99% quantile
gamma &lt;- 0.5
sigma &lt;- 1.5
X &lt;- rtgpd(n=250, gamma=gamma, sigma=sigma, endpoint=qgpd(0.99, gamma=gamma, sigma=sigma))

# Truncated ML estimator
trmle &lt;- trMLE(X, plot=TRUE, ylim=c(0,2))
</code></pre>

<hr>
<h2 id='trParetoQQ'>
Truncated Pareto quantile plot
</h2><span id='topic+trParetoQQ'></span>

<h3>Description</h3>

<p>Extension of the Pareto QQ-plot as described in Beirlant et al. (2016).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trParetoQQ(data, r = 1, DT, kstar = NULL, plot = TRUE, main = "TPa QQ-plot", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="trParetoQQ_+3A_data">data</code></td>
<td>

<p>Vector of <code class="reqn">n</code> observations. 
</p>
</td></tr>
<tr><td><code id="trParetoQQ_+3A_r">r</code></td>
<td>

<p>Trimming parameter, default is <code>1</code> (no trimming).
</p>
</td></tr>
<tr><td><code id="trParetoQQ_+3A_dt">DT</code></td>
<td>

<p>Vector of <code class="reqn">n-1</code> estimates for the truncation odds <code class="reqn">D_T</code> obtained from <code><a href="#topic+trDT">trDT</a></code>.
</p>
</td></tr>
<tr><td><code id="trParetoQQ_+3A_kstar">kstar</code></td>
<td>

<p>Value for <code class="reqn">k</code> used to construct the plot. When <code>NULL</code> (default), a value will be chosen by maximising the
correlation between the empirical and theoretical quantiles (see Details).
</p>
</td></tr>
<tr><td><code id="trParetoQQ_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the quantiles should be plotted in a Pareto QQ-plot, default is <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="trParetoQQ_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"TPa QQ-plot"</code>.
</p>
</td></tr>
<tr><td><code id="trParetoQQ_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Pareto QQ-plot for truncated data plots 
</p>
<p style="text-align: center;"><code class="reqn"> (-\log(\hat{D}_{T,r,k^*,n}+j/(n+1)), \log(X_{n-j+1,n}) )</code>
</p>

<p>for <code class="reqn">j=1,\ldots,n</code>.
</p>
<p>The value for <code class="reqn">k^*</code> can be be given by the user or can be determined automatically.
In the latter case, we use the <code class="reqn">k^*</code> that maximises the absolute value of the correlation between <code class="reqn">-\log(\hat{D}_{T,r,k^*,n}+j/(n+1))</code> and <code class="reqn">\log(X_{n-j+1,n})</code> for <code class="reqn">j=1,\ldots,k</code> and <code class="reqn">k^*&gt;10</code>.
</p>
<p>When taking <code class="reqn">D_T=0</code>, one obtains the ordinary Pareto QQ-plot.
</p>
<p>Note that the definition here differs slightly from the one in Beirlant et al. (2016).
We plot the empirical and theoretical quantiles the other way around and therefore have to add a minus (before the log).
</p>
<p>See Beirlant et al. (2016) for more details.
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>pqq.the</code></td>
<td>
<p>Vector of theoretical quantiles <code class="reqn">-\log(\hat{D}_{T,r,k^*,n}+j/(n+1))</code>, see Details.</p>
</td></tr>
<tr><td><code>pqq.emp</code></td>
<td>
<p>Vector of the empirical quantiles from the log-transformed data.</p>
</td></tr>
<tr><td><code>kstar</code></td>
<td>
<p>Optimal value for <code class="reqn">k</code> or input argument <code>kstar</code>, see Details.</p>
</td></tr>
<tr><td><code>DTstar</code></td>
<td>
<p>Estimate of <code class="reqn">D_T</code> corresponding to <code>kstar</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens.
</p>


<h3>References</h3>

<p>Beirlant, J., Fraga Alves, M.I. and Gomes, M.I. (2016). &quot;Tail fitting for Truncated and Non-truncated Pareto-type Distributions.&quot; <em>Extremes</em>, 19, 429&ndash;462.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ParetoQQ">ParetoQQ</a></code>, <code><a href="#topic+trDT">trDT</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Endpoint of truncated Pareto distribution
endpoint &lt;- qpareto(0.99, shape=2)

# Generate sample from truncated Pareto distribution
X &lt;- rtpareto(1000, shape=2, endpoint=endpoint)

# Ordinary Pareto QQ-plot
ParetoQQ(X)

# Truncated Hill estimates
gamma &lt;- trHill(X)$gamma

# Estimates for truncation odds
dt &lt;- trDT(X, gamma=gamma)$DT

# Truncated Pareto QQ-plot
trParetoQQ(X, DT=dt)
</code></pre>

<hr>
<h2 id='trProb'>
Estimator of small exceedance probabilities using truncated Hill
</h2><span id='topic+trProb'></span>

<h3>Description</h3>

<p>Computes estimates of a small exceedance probability <code class="reqn">P(X&gt;q)</code> using the estimates for the EVI obtained from the Hill estimator adapted for upper truncation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trProb(data, r = 1, gamma, q, warnings = TRUE, plot = FALSE, add = FALSE, 
       main = "Estimates of small exceedance probability", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="trProb_+3A_data">data</code></td>
<td>

<p>Vector of <code class="reqn">n</code> observations. 
</p>
</td></tr>
<tr><td><code id="trProb_+3A_r">r</code></td>
<td>

<p>Trimming parameter, default is <code>1</code> (no trimming).
</p>
</td></tr>
<tr><td><code id="trProb_+3A_gamma">gamma</code></td>
<td>

<p>Vector of <code class="reqn">n-1</code> estimates for the EVI obtained from <code><a href="#topic+trHill">trHill</a></code>.
</p>
</td></tr>
<tr><td><code id="trProb_+3A_q">q</code></td>
<td>

<p>The used large quantile (we estimate <code class="reqn">P(X&gt;q)</code> for <code class="reqn">q</code> large).
</p>
</td></tr>
<tr><td><code id="trProb_+3A_warnings">warnings</code></td>
<td>

<p>Logical indicating if warnings are shown, default is <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="trProb_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the estimates should be plotted as a function of <code class="reqn">k</code>, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="trProb_+3A_add">add</code></td>
<td>

<p>Logical indicating if the estimates should be added to an existing plot, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="trProb_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"Estimates of small exceedance probability"</code>.
</p>
</td></tr>
<tr><td><code id="trProb_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The probability is estimated as
</p>
<p style="text-align: center;"><code class="reqn">\hat{P}(X&gt;q)=(k+1)/(n+1) ( (q/X_{n-k,n})^{-1/\gamma_k} -  R_{r,k,n}^{1/\hat{\gamma}_k} ) / (1- R_{r,k,n}^{1/\hat{\gamma}_k})</code>
</p>

<p>with <code class="reqn">R_{r,k,n} = X_{n-k,n} / X_{n-r+1,n}</code> and <code class="reqn">\hat{\gamma}_k</code> the Hill estimates adapted for truncation.
</p>
<p>See Beirlant et al. (2016) or Section 4.2.3 of Albrecher et al. (2017) for more details.
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>k</code></td>
<td>
<p>Vector of the values of the tail parameter <code class="reqn">k</code>.</p>
</td></tr>
<tr><td><code>P</code></td>
<td>
<p>Vector of the corresponding probability estimates.</p>
</td></tr>
<tr><td><code>q</code></td>
<td>
<p>The used large quantile.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens based on <code>R</code> code of Dries Cornilly.
</p>


<h3>References</h3>

<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>
<p>Beirlant, J., Fraga Alves, M.I. and Gomes, M.I. (2016). &quot;Tail fitting for Truncated and Non-truncated Pareto-type Distributions.&quot; <em>Extremes</em>, 19, 429&ndash;462.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+trHill">trHill</a></code>, <code><a href="#topic+trQuant">trQuant</a></code>, <code><a href="#topic+Prob">Prob</a></code>, <code><a href="#topic+trProbMLE">trProbMLE</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Sample from truncated Pareto distribution.
# truncated at 99% quantile
shape &lt;- 2
X &lt;- rtpareto(n=1000, shape=shape, endpoint=qpareto(0.99, shape=shape))

# Truncated Hill estimator
trh &lt;- trHill(X, plot=TRUE, ylim=c(0,2))

# Small probability
trProb(X, gamma=trh$gamma, q=8, plot=TRUE)
</code></pre>

<hr>
<h2 id='trProbMLE'>
Estimator of small exceedance probabilities using truncated MLE
</h2><span id='topic+trProbMLE'></span>

<h3>Description</h3>

<p>Computes estimates of a small exceedance probability <code class="reqn">P(X&gt;q)</code> using the estimates for the EVI obtained from the ML estimator adapted for upper truncation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trProbMLE(data, gamma, tau, DT, q, plot = FALSE, add = FALSE, 
          main = "Estimates of small exceedance probability", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="trProbMLE_+3A_data">data</code></td>
<td>

<p>Vector of <code class="reqn">n</code> observations. 
</p>
</td></tr>
<tr><td><code id="trProbMLE_+3A_gamma">gamma</code></td>
<td>

<p>Vector of <code class="reqn">n-1</code> estimates for the EVI obtained from <code><a href="#topic+trMLE">trMLE</a></code>.
</p>
</td></tr>
<tr><td><code id="trProbMLE_+3A_tau">tau</code></td>
<td>

<p>Vector of <code class="reqn">n-1</code> estimates for the <code class="reqn">\tau</code> obtained from <code><a href="#topic+trMLE">trMLE</a></code>.
</p>
</td></tr>
<tr><td><code id="trProbMLE_+3A_dt">DT</code></td>
<td>

<p>Vector of <code class="reqn">n-1</code> estimates for the truncation odds obtained from <code><a href="#topic+trDTMLE">trDTMLE</a></code>.
</p>
</td></tr>
<tr><td><code id="trProbMLE_+3A_q">q</code></td>
<td>

<p>The used large quantile (we estimate <code class="reqn">P(X&gt;q)</code> for <code class="reqn">q</code> large).
</p>
</td></tr>
<tr><td><code id="trProbMLE_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the estimates should be plotted as a function of <code class="reqn">k</code>, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="trProbMLE_+3A_add">add</code></td>
<td>

<p>Logical indicating if the estimates should be added to an existing plot, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="trProbMLE_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"Estimates of small exceedance probability"</code>.
</p>
</td></tr>
<tr><td><code id="trProbMLE_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The probability is estimated as
</p>
<p style="text-align: center;"><code class="reqn">\hat{p}_{T,k}(q) = (1+ \hat{D}_{T,k}) (k+1)/(n+1) (1+\hat\tau _k(q-X_{n-k,n}))^{-1/\hat{\xi}_k} -\hat{D}_{T,k}</code>
</p>

<p>with <code class="reqn">\hat{\gamma}_k</code> and  <code class="reqn">\hat{\tau}_k</code> the ML estimates adapted for truncation and <code class="reqn">\hat{D}_T</code> the estimates for the truncation odds.
</p>
<p>See Beirlant et al. (2017) for more details.
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>k</code></td>
<td>
<p>Vector of the values of the tail parameter <code class="reqn">k</code>.</p>
</td></tr>
<tr><td><code>P</code></td>
<td>
<p>Vector of the corresponding probability estimates.</p>
</td></tr>
<tr><td><code>q</code></td>
<td>
<p>The used large quantile.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens.
</p>


<h3>References</h3>

<p>Beirlant, J., Fraga Alves, M. I. and Reynkens, T. (2017). &quot;Fitting Tails Affected by Truncation&quot;. <em>Electronic Journal of Statistics</em>, 11(1), 2026&ndash;2065.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+trMLE">trMLE</a></code>, <code><a href="#topic+trDTMLE">trDTMLE</a></code>, <code><a href="#topic+trQuantMLE">trQuantMLE</a></code>, <code><a href="#topic+trEndpointMLE">trEndpointMLE</a></code>, <code><a href="#topic+trTestMLE">trTestMLE</a></code>, <code><a href="#topic+trProb">trProb</a></code>, <code><a href="#topic+Prob">Prob</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Sample from GPD truncated at 99% quantile
gamma &lt;- 0.5
sigma &lt;- 1.5
X &lt;- rtgpd(n=250, gamma=gamma, sigma=sigma, endpoint=qgpd(0.99, gamma=gamma, sigma=sigma))

# Truncated ML estimator
trmle &lt;- trMLE(X, plot=TRUE, ylim=c(0,2))

# Truncation odds
dtmle &lt;- trDTMLE(X, gamma=trmle$gamma, tau=trmle$tau, plot=FALSE)

# Small exceedance probability
trProbMLE(X, gamma=trmle$gamma, tau=trmle$tau, DT=dtmle$DT, plot=TRUE, q=26, ylim=c(0,0.005))
</code></pre>

<hr>
<h2 id='trQuant'>
Estimator of large quantiles using truncated Hill
</h2><span id='topic+trQuant'></span><span id='topic+trQuantW'></span>

<h3>Description</h3>

<p><code>trQuant</code> computes estimates of large quantiles <code class="reqn">Q(1-p)</code> of the truncated distribution using the estimates for the EVI obtained from the Hill estimator adapted for upper truncation. <code>trQuantW</code> computes estimates of large quantiles <code class="reqn">Q_W(1-p)</code> of the parent distribution <code class="reqn">W</code> which is unobserved.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trQuant(data, r = 1, rough = TRUE, gamma, DT, p, plot = FALSE, add = FALSE, 
        main = "Estimates of extreme quantile", ...)
        
trQuantW(data, gamma, DT, p, plot = FALSE, add = FALSE, 
         main = "Estimates of extreme quantile", ...)        
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="trQuant_+3A_data">data</code></td>
<td>

<p>Vector of <code class="reqn">n</code> observations (truncated data). 
</p>
</td></tr>
<tr><td><code id="trQuant_+3A_r">r</code></td>
<td>

<p>Trimming parameter, default is <code>1</code> (no trimming).
</p>
</td></tr>
<tr><td><code id="trQuant_+3A_rough">rough</code></td>
<td>

<p>Logical indicating if rough truncation is present, default is <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="trQuant_+3A_gamma">gamma</code></td>
<td>

<p>Vector of <code class="reqn">n-1</code> estimates for the EVI obtained from <code><a href="#topic+trHill">trHill</a></code>.
</p>
</td></tr>
<tr><td><code id="trQuant_+3A_dt">DT</code></td>
<td>

<p>Vector of <code class="reqn">n-1</code> estimates for the truncation odds obtained from <code><a href="#topic+trDT">trDT</a></code>.
</p>
</td></tr>
<tr><td><code id="trQuant_+3A_p">p</code></td>
<td>

<p>The exceedance probability of the quantile (we estimate <code class="reqn">Q(1-p)</code> for <code class="reqn">p</code> small).
</p>
</td></tr>
<tr><td><code id="trQuant_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the estimates should be plotted as a function of <code class="reqn">k</code>, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="trQuant_+3A_add">add</code></td>
<td>

<p>Logical indicating if the estimates should be added to an existing plot, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="trQuant_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"Estimates of extreme quantile"</code>.
</p>
</td></tr>
<tr><td><code id="trQuant_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We observe the truncated r.v. <code class="reqn">X=_d W | W&lt;T</code> where <code class="reqn">T</code> is the truncation point and <code class="reqn">W</code> the untruncated r.v.
</p>
<p>Under rough truncation, the quantiles for <code class="reqn">X</code> are estimated using
</p>
<p style="text-align: center;"><code class="reqn">\hat{Q}(1-p)=X_{n-k,n}  ((\hat{D}_T + (k+1)/(n+1))/(\hat{D}_T+p))^{\hat{\gamma}_k},</code>
</p>

<p>with <code class="reqn">\hat{\gamma}_k</code> the Hill estimates adapted for truncation and <code class="reqn">\hat{D}_T</code> the estimates for the truncation odds.
</p>
<p>Under light truncation, the quantiles are estimated using the Weissman estimator with the Hill estimates replaced
by the truncated Hill estimates:
</p>
<p style="text-align: center;"><code class="reqn">\hat{Q}(1-p)=X_{n-k,n}  ((k+1)/((n+1)p))^{\hat{\gamma}_k}.</code>
</p>

<p>To decide between light and rough truncation, one can use the test implemented in <code><a href="#topic+trTest">trTest</a></code>.
</p>
<p>The quantiles for <code class="reqn">W</code> are estimated using
</p>
<p style="text-align: center;"><code class="reqn">\hat{Q}_W(1-p)=X_{n-k,n} ( (\hat{D}_T + (k+1)/(n+1)) / (p(1+\hat{D}_T))^{\hat{\gamma}_k}.</code>
</p>

<p>See Beirlant et al. (2016) or Section 4.2.3 of Albrecher et al. (2017) for more details.
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>k</code></td>
<td>
<p>Vector of the values of the tail parameter <code class="reqn">k</code>.</p>
</td></tr>
<tr><td><code>Q</code></td>
<td>
<p>Vector of the corresponding quantile estimates.</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>The used exceedance probability.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens based on <code>R</code> code of Dries Cornilly.
</p>


<h3>References</h3>

<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>
<p>Beirlant, J., Fraga Alves, M.I. and Gomes, M.I. (2016). &quot;Tail fitting for Truncated and Non-truncated Pareto-type Distributions.&quot; <em>Extremes</em>, 19, 429&ndash;462.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+trHill">trHill</a></code>, <code><a href="#topic+trDT">trDT</a></code>, <code><a href="#topic+trProb">trProb</a></code>, <code><a href="#topic+trEndpoint">trEndpoint</a></code>, <code><a href="#topic+trTest">trTest</a></code>, <code><a href="#topic+Quant">Quant</a></code>, <code><a href="#topic+trQuantMLE">trQuantMLE</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Sample from truncated Pareto distribution.
# truncated at 99% quantile
shape &lt;- 2
X &lt;- rtpareto(n=1000, shape=shape, endpoint=qpareto(0.99, shape=shape))

# Truncated Hill estimator
trh &lt;- trHill(X, plot=TRUE, ylim=c(0,2))

# Truncation odds
dt &lt;- trDT(X, gamma=trh$gamma, plot=TRUE, ylim=c(0,2))

# Large quantile
p &lt;- 10^(-5)
# Truncated distribution
trQuant(X, gamma=trh$gamma, DT=dt$DT, p=p, plot=TRUE)
# Original distribution
trQuantW(X, gamma=trh$gamma, DT=dt$DT, p=p, plot=TRUE, ylim=c(0,1000))

</code></pre>

<hr>
<h2 id='trQuantMLE'>
Estimator of large quantiles using truncated MLE
</h2><span id='topic+trQuantMLE'></span>

<h3>Description</h3>

<p>This function computes estimates of large quantiles <code class="reqn">Q(1-p)</code> of the truncated distribution using the ML estimates adapted for upper truncation. Moreover, estimates of large quantiles <code class="reqn">Q_Y(1-p)</code> of the original distribution <code class="reqn">Y</code>, which is unobserved, are also computed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trQuantMLE(data, gamma, tau, DT, p, Y = FALSE, plot = FALSE, add = FALSE, 
           main = "Estimates of extreme quantile", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="trQuantMLE_+3A_data">data</code></td>
<td>

<p>Vector of <code class="reqn">n</code> observations. 
</p>
</td></tr>
<tr><td><code id="trQuantMLE_+3A_gamma">gamma</code></td>
<td>

<p>Vector of <code class="reqn">n-1</code> estimates for the EVI obtained from <code><a href="#topic+trMLE">trMLE</a></code>.
</p>
</td></tr>
<tr><td><code id="trQuantMLE_+3A_tau">tau</code></td>
<td>

<p>Vector of <code class="reqn">n-1</code> estimates for the <code class="reqn">\tau</code> obtained from <code><a href="#topic+trMLE">trMLE</a></code>.
</p>
</td></tr>
<tr><td><code id="trQuantMLE_+3A_dt">DT</code></td>
<td>

<p>Vector of <code class="reqn">n-1</code> estimates for the truncation odds obtained from <code><a href="#topic+trDTMLE">trDTMLE</a></code>.
</p>
</td></tr>
<tr><td><code id="trQuantMLE_+3A_p">p</code></td>
<td>

<p>The exceedance probability of the quantile (we estimate <code class="reqn">Q(1-p)</code> or <code class="reqn">Q_Y(1-p)</code> for <code class="reqn">p</code> small).
</p>
</td></tr>
<tr><td><code id="trQuantMLE_+3A_y">Y</code></td>
<td>

<p>Logical indicating if quantiles from the truncated distribution (<code class="reqn">Q(1-p)</code>) or from the parent distribution (<code class="reqn">Q_Y(1-p)</code>) are computed. Default is <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="trQuantMLE_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the estimates should be plotted as a function of <code class="reqn">k</code>, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="trQuantMLE_+3A_add">add</code></td>
<td>

<p>Logical indicating if the estimates should be added to an existing plot, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="trQuantMLE_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"Estimates of extreme quantile"</code>.
</p>
</td></tr>
<tr><td><code id="trQuantMLE_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We observe the truncated r.v. <code class="reqn">X=_d Y | Y&lt;T</code> where <code class="reqn">T</code> is the truncation point and <code class="reqn">Y</code> the untruncated r.v.
</p>
<p>Under rough truncation, the quantiles for <code class="reqn">X</code> are estimated using
</p>
<p style="text-align: center;"><code class="reqn">\hat{Q}_{T,k}(1-p) = X_{n-k,n} +1/(\hat{\tau}_k)([(\hat{D}_{T,k} + (k+1)/(n+1))/(\hat{D}_{T,k}+p)]^{\hat{\xi}_k} -1),</code>
</p>

<p>with <code class="reqn">\hat{\gamma}_k</code> and <code class="reqn">\hat{\tau}_k</code> the ML estimates adapted for truncation and <code class="reqn">\hat{D}_T</code> the estimates for the truncation odds.
</p>
<p>The quantiles for <code class="reqn">Y</code> are estimated using
</p>
<p style="text-align: center;"><code class="reqn">\hat{Q}_{Y,k}(1-p)=X_{n-k,n} +1/(\hat{\tau}_k)([(\hat{D}_{T,k} + (k+1)/(n+1))/(p(\hat{D}_{T,k}+1))]^{\hat{\xi}_k} -1).</code>
</p>

<p>See Beirlant et al. (2017) for more details.
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>k</code></td>
<td>
<p>Vector of the values of the tail parameter <code class="reqn">k</code>.</p>
</td></tr>
<tr><td><code>Q</code></td>
<td>
<p>Vector of the corresponding quantile estimates.</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>The used exceedance probability.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens.
</p>


<h3>References</h3>

<p>Beirlant, J., Fraga Alves, M. I. and Reynkens, T. (2017). &quot;Fitting Tails Affected by Truncation&quot;. <em>Electronic Journal of Statistics</em>, 11(1), 2026&ndash;2065.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+trMLE">trMLE</a></code>, <code><a href="#topic+trDTMLE">trDTMLE</a></code>, <code><a href="#topic+trProbMLE">trProbMLE</a></code>, <code><a href="#topic+trEndpointMLE">trEndpointMLE</a></code>, <code><a href="#topic+trTestMLE">trTestMLE</a></code>, <code><a href="#topic+trQuant">trQuant</a></code>, <code><a href="#topic+Quant">Quant</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Sample from GPD truncated at 99% quantile
gamma &lt;- 0.5
sigma &lt;- 1.5
X &lt;- rtgpd(n=250, gamma=gamma, sigma=sigma, endpoint=qgpd(0.99, gamma=gamma, sigma=sigma))

# Truncated ML estimator
trmle &lt;- trMLE(X, plot=TRUE, ylim=c(0,2))

# Truncation odds
dtmle &lt;- trDTMLE(X, gamma=trmle$gamma, tau=trmle$tau, plot=FALSE)

# Large quantile of X
trQuantMLE(X, gamma=trmle$gamma, tau=trmle$tau, DT=dtmle$DT, plot=TRUE, p=0.005, ylim=c(15,30))

# Large quantile of Y
trQuantMLE(X, gamma=trmle$gamma, tau=trmle$tau, DT=dtmle$DT, plot=TRUE, p=0.005, ylim=c(0,300), 
          Y=TRUE)
</code></pre>

<hr>
<h2 id='trTest'>
Test for truncated Pareto-type tails
</h2><span id='topic+trTest'></span>

<h3>Description</h3>

<p>Test between non-truncated Pareto-type tails <em>(light truncation)</em> and truncated Pareto-type tails <em>(rough truncation)</em>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trTest(data, alpha = 0.05, plot = TRUE, main = "Test for truncation", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="trTest_+3A_data">data</code></td>
<td>

<p>Vector of <code class="reqn">n</code> observations. 
</p>
</td></tr>
<tr><td><code id="trTest_+3A_alpha">alpha</code></td>
<td>

<p>The used significance level, default is <code>0.05</code>.
</p>
</td></tr>
<tr><td><code id="trTest_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the P-values should be plotted as a function of <code class="reqn">k</code>, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="trTest_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"Test for truncation"</code>.
</p>
</td></tr>
<tr><td><code id="trTest_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We want to test
<code class="reqn">H_0: X</code> has non-truncated Pareto tails vs.
<code class="reqn">H_1: X</code> has truncated Pareto tails.
Let
</p>
<p style="text-align: center;"><code class="reqn">E_{k,n}(\gamma) = 1/k \sum_{j=1}^k (X_{n-k,n}/X_{n-j+1,n})^{1/\gamma},</code>
</p>

<p>with <code class="reqn">X_{i,n}</code> the <code class="reqn">i</code>-th order statistic.
The test statistic is then
</p>
<p style="text-align: center;"><code class="reqn">T_{k,n}=\sqrt{12k} (E_{k,n}(H_{k,n})-1/2) / (1-E_{k,n}(H_{k,n}))</code>
</p>

<p>which is asymptotically standard normally distributed.
We reject <code class="reqn">H_0</code> on level <code class="reqn">\alpha</code> if 
</p>
<p style="text-align: center;"><code class="reqn">T_{k,n}&lt;-z_{\alpha}</code>
</p>

<p>where <code class="reqn">z_{\alpha}</code> is the <code class="reqn">100(1-\alpha)\%</code> quantile of a standard normal distribution.
The corresponding P-value is thus given by
</p>
<p style="text-align: center;"><code class="reqn">\Phi(T_{k,n})</code>
</p>
<p> with <code class="reqn">\Phi</code> the CDF of a standard normal distribution.
</p>
<p>See Beirlant et al. (2016) or Section 4.2.3 of Albrecher et al. (2017) for more details.
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>k</code></td>
<td>
<p>Vector of the values of the tail parameter <code class="reqn">k</code>.</p>
</td></tr>
<tr><td><code>testVal</code></td>
<td>
<p>Corresponding test values.</p>
</td></tr>
<tr><td><code>critVal</code></td>
<td>
<p>Critical value used for the test, i.e. <code>qnorm(1-alpha/2)</code>.</p>
</td></tr>
<tr><td><code>Pval</code></td>
<td>
<p>Corresponding P-values.</p>
</td></tr>
<tr><td><code>Reject</code></td>
<td>
<p>Logical vector indicating if the null hypothesis is rejected for a certain value of <code>k</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens.
</p>


<h3>References</h3>

<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>
<p>Beirlant, J., Fraga Alves, M.I. and Gomes, M.I. (2016). &quot;Tail fitting for Truncated and Non-truncated Pareto-type Distributions.&quot; <em>Extremes</em>, 19, 429&ndash;462.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+trHill">trHill</a></code>, <code><a href="#topic+trTestMLE">trTestMLE</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Sample from truncated Pareto distribution.
# truncated at 95% quantile
shape &lt;- 2
X &lt;- rtpareto(n=1000, shape=shape, endpoint=qpareto(0.95, shape=shape))

# Test for truncation
trTest(X)


# Sample from truncated Pareto distribution.
# truncated at 99% quantile
shape &lt;- 2
X &lt;- rtpareto(n=1000, shape=shape, endpoint=qpareto(0.99, shape=shape))

# Test for truncation
trTest(X)
</code></pre>

<hr>
<h2 id='trTestMLE'>
Test for truncated GPD tails
</h2><span id='topic+trTestMLE'></span>

<h3>Description</h3>

<p>Test between non-truncated GPD tails <em>(light truncation)</em> and truncated GPD tails <em>(rough truncation)</em>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trTestMLE(data, gamma, tau, alpha = 0.05, plot = TRUE, main = "Test for truncation", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="trTestMLE_+3A_data">data</code></td>
<td>

<p>Vector of <code class="reqn">n</code> observations. 
</p>
</td></tr>
<tr><td><code id="trTestMLE_+3A_gamma">gamma</code></td>
<td>

<p>Vector of <code class="reqn">n-1</code> estimates for the EVI obtained from <code><a href="#topic+trMLE">trMLE</a></code>.
</p>
</td></tr>
<tr><td><code id="trTestMLE_+3A_tau">tau</code></td>
<td>

<p>Vector of <code class="reqn">n-1</code> estimates for the <code class="reqn">\tau</code> obtained from <code><a href="#topic+trMLE">trMLE</a></code>.
</p>
</td></tr>
<tr><td><code id="trTestMLE_+3A_alpha">alpha</code></td>
<td>

<p>The used significance level, default is <code>0.05</code>.
</p>
</td></tr>
<tr><td><code id="trTestMLE_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the P-values should be plotted as a function of <code class="reqn">k</code>, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="trTestMLE_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"Test for truncation"</code>.
</p>
</td></tr>
<tr><td><code id="trTestMLE_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We want to test
<code class="reqn">H_0: X</code> has non-truncated GPD tails vs.
<code class="reqn">H_1: X</code> has truncated GPD tails.
Let <code class="reqn">\hat{\gamma}_k</code> and <code class="reqn">\hat{\tau}_k</code> be the truncated MLE estimates for <code class="reqn">\gamma</code> and <code class="reqn">\tau</code>.
The test statistic is then
</p>
<p style="text-align: center;"><code class="reqn">T_{k,n}=k (1+\hat{\tau} (X_{n,n}-X_{-k,n}) )^{-1/\hat{\xi}_k}</code>
</p>

<p>which is asymptotically standard exponentially distributed.
We reject <code class="reqn">H_0</code> on level <code class="reqn">\alpha</code> if 
<code class="reqn">T_{k,n}&gt;\ln (1/{\alpha)}</code>. The corresponding P-value is given by
<code class="reqn">\exp(-T_{k,n})</code>.
</p>
<p>See Beirlant et al. (2017) for more details.
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>k</code></td>
<td>
<p>Vector of the values of the tail parameter <code class="reqn">k</code>.</p>
</td></tr>
<tr><td><code>testVal</code></td>
<td>
<p>Corresponding test values.</p>
</td></tr>
<tr><td><code>critVal</code></td>
<td>
<p>Critical value used for the test, i.e. <code class="reqn">\ln(1/\alpha)</code>.</p>
</td></tr>
<tr><td><code>Pval</code></td>
<td>
<p>Corresponding P-values.</p>
</td></tr>
<tr><td><code>Reject</code></td>
<td>
<p>Logical vector indicating if the null hypothesis is rejected for a certain value of <code>k</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens.
</p>


<h3>References</h3>

<p>Beirlant, J., Fraga Alves, M. I. and Reynkens, T. (2017). &quot;Fitting Tails Affected by Truncation&quot;. <em>Electronic Journal of Statistics</em>, 11(1), 2026&ndash;2065.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+trMLE">trMLE</a></code>, <code><a href="#topic+trDTMLE">trDTMLE</a></code>, <code><a href="#topic+trProbMLE">trProbMLE</a></code>, <code><a href="#topic+trEndpointMLE">trEndpointMLE</a></code>, <code><a href="#topic+trTestMLE">trTestMLE</a></code>, <code><a href="#topic+trTest">trTest</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Sample from GPD truncated at 99% quantile
gamma &lt;- 0.5
sigma &lt;- 1.5
X &lt;- rtgpd(n=250, gamma=gamma, sigma=sigma, endpoint=qgpd(0.99, gamma=gamma, sigma=sigma))

# Truncated ML estimator
trmle &lt;- trMLE(X, plot=TRUE, ylim=c(0,2))

# Test for truncation
trTestMLE(X, gamma=trmle$gamma, tau=trmle$tau)
</code></pre>

<hr>
<h2 id='Turnbull'>
Turnbull estimator
</h2><span id='topic+Turnbull'></span>

<h3>Description</h3>

<p>Computes the Turnbull estimator for the survival function of interval censored data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Turnbull(x, L, R, censored, trunclower = 0, truncupper = Inf,
         conf.type = "plain", conf.int = 0.95)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Turnbull_+3A_x">x</code></td>
<td>

<p>Vector with points to evaluate the estimator in.
</p>
</td></tr>
<tr><td><code id="Turnbull_+3A_l">L</code></td>
<td>

<p>Vector of length <code class="reqn">n</code> with the lower boundaries of the intervals.
</p>
</td></tr>
<tr><td><code id="Turnbull_+3A_r">R</code></td>
<td>

<p>Vector of length <code class="reqn">n</code> with the upper boundaries of the intervals.
</p>
</td></tr>
<tr><td><code id="Turnbull_+3A_censored">censored</code></td>
<td>

<p>Vector of <code class="reqn">n</code> logicals indicating if an observation is interval censored. 
</p>
</td></tr>
<tr><td><code id="Turnbull_+3A_trunclower">trunclower</code></td>
<td>

<p>Lower truncation point, default is 0.
</p>
</td></tr>
<tr><td><code id="Turnbull_+3A_truncupper">truncupper</code></td>
<td>

<p>Upper truncation point, default is <code>Inf</code>.
</p>
</td></tr>
<tr><td><code id="Turnbull_+3A_conf.type">conf.type</code></td>
<td>

<p>Type of confidence interval, see <code><a href="survival.html#topic+survfit.formula">survfit.formula</a></code>. Default is <code>"plain"</code>.
</p>
</td></tr>
<tr><td><code id="Turnbull_+3A_conf.int">conf.int</code></td>
<td>

<p>Confidence level of the two-sided confidence interval, see <code><a href="survival.html#topic+survfit.formula">survfit.formula</a></code>. Default is <code>0.95</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We consider the random interval censoring model where one observes <code class="reqn">L \le R</code>
and where the variable of interest <code class="reqn">X</code> lies between <code class="reqn">L</code> and <code class="reqn">R</code>.
</p>
<p>Right censored data should be entered as <code>L=l</code> and <code>R=truncupper</code>, and right censored data should be entered as <code>L=trunclower</code> and <code>R=r</code>.
</p>
<p>This function calls <code><a href="survival.html#topic+survfit.formula">survfit.formula</a></code> from <span class="pkg">survival</span>.
</p>
<p>See Section 4.3.2 in Albrecher et al. (2017) for more details.
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>surv</code></td>
<td>
<p>A vector of length <code>length(x)</code> containing the Turnbull estimator evaluated in the elements of <code>x</code>.</p>
</td></tr>
<tr><td><code>fit</code></td>
<td>
<p>The output from the call to <code><a href="survival.html#topic+survfit.formula">survfit.formula</a></code>, an object of class <code>survfit</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens
</p>


<h3>References</h3>

<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>
<p>Turnbull, B. W. (1974). &quot;Nonparametric Estimation of a Survivorship Function with Doubly Censored Data.&quot; <em>Journal of the American Statistical Association</em>, 69, 169&ndash;173.
</p>
<p>Turnbull, B. W. (1976). &quot;The Empirical Distribution Function with Arbitrarily
Grouped, Censored and Truncated Data.&quot; <em>Journal of the Royal Statistical Society: Series B (Methodological)</em>, 38, 290&ndash;295.
</p>


<h3>See Also</h3>

<p><code><a href="survival.html#topic+survfit.formula">survfit.formula</a></code>, <code><a href="#topic+KaplanMeier">KaplanMeier</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>L &lt;- 1:10
R &lt;- c(1, 2.5, 3, 4, 5.5, 6, 7.5, 8.25, 9, 10.5)
censored &lt;- c(0, 1, 0, 0, 1, 0, 1, 1, 0, 1)

x &lt;- seq(0, 12, 0.1)

# Turnbull estimator
plot(x, Turnbull(x, L, R, censored)$cdf, type="s", ylab="Turnbull estimator")
</code></pre>

<hr>
<h2 id='tWeibull'>
The truncated Weibull distribution
</h2><span id='topic+dtweibull'></span><span id='topic+ptweibull'></span><span id='topic+qtweibull'></span><span id='topic+rtweibull'></span>

<h3>Description</h3>

<p>Density, distribution function, quantile function and random generation for the truncated Weibull distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dtweibull(x, shape, scale = 1, endpoint = Inf, log = FALSE)
ptweibull(x, shape, scale = 1, endpoint = Inf, lower.tail = TRUE, log.p = FALSE)
qtweibull(p, shape, scale = 1, endpoint = Inf, lower.tail = TRUE, log.p = FALSE)
rtweibull(n, shape, scale = 1, endpoint = Inf)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tWeibull_+3A_x">x</code></td>
<td>

<p>Vector of quantiles.
</p>
</td></tr>
<tr><td><code id="tWeibull_+3A_p">p</code></td>
<td>

<p>Vector of probabilities.
</p>
</td></tr>
<tr><td><code id="tWeibull_+3A_n">n</code></td>
<td>

<p>Number of observations.
</p>
</td></tr>
<tr><td><code id="tWeibull_+3A_shape">shape</code></td>
<td>

<p>The shape parameter of the Weibull distribution, a strictly positive number.
</p>
</td></tr>
<tr><td><code id="tWeibull_+3A_scale">scale</code></td>
<td>

<p>The scale parameter of the Weibull distribution, a strictly positive number, default is 1.
</p>
</td></tr>
<tr><td><code id="tWeibull_+3A_endpoint">endpoint</code></td>
<td>

<p>Endpoint of the truncated Weibull distribution. The default value is <code>Inf</code> for which the truncated Weibull distribution corresponds to the ordinary Weibull distribution.
</p>
</td></tr>
<tr><td><code id="tWeibull_+3A_log">log</code></td>
<td>

<p>Logical indicating if the densities are given as <code class="reqn">\log(f)</code>, default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="tWeibull_+3A_lower.tail">lower.tail</code></td>
<td>

<p>Logical indicating if the probabilities are of the form <code class="reqn">P(X\le x)</code> (<code>TRUE</code>) or <code class="reqn">P(X&gt;x)</code> (<code>FALSE</code>). Default is <code>TRUE.</code>
</p>
</td></tr>
<tr><td><code id="tWeibull_+3A_log.p">log.p</code></td>
<td>

<p>Logical indicating if the probabilities are given as <code class="reqn">\log(p)</code>, default is <code>FALSE</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Cumulative Distribution Function (CDF) of the truncated Weibull distribution is equal to
<code class="reqn">F_T(x) = F(x) / F(T)</code> for <code class="reqn">x \le T</code> where <code class="reqn">F</code> is the CDF of the ordinary Weibull distribution and <code class="reqn">T</code> is the endpoint (truncation point) of the truncated Weibull distribution.
</p>


<h3>Value</h3>

<p><code>dtweibull</code> gives the density function evaluated in <code class="reqn">x</code>, <code>ptweibull</code> the CDF evaluated in <code class="reqn">x</code> and <code>qtweibull</code> the quantile function evaluated in <code class="reqn">p</code>. The length of the result is equal to the length of <code class="reqn">x</code> or <code class="reqn">p</code>.
</p>
<p><code>rtweibull</code> returns a random sample of length <code class="reqn">n</code>.
</p>


<h3>Author(s)</h3>

<p>Tom Reynkens.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+Weibull">Weibull</a></code>,  <code><a href="stats.html#topic+Distributions">Distributions</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Plot of the PDF
x &lt;- seq(0, 10, 0.01)
plot(x, dtweibull(x, shape=2, scale=0.5, endpoint=1), xlab="x", ylab="PDF", type="l")

# Plot of the CDF
x &lt;- seq(0, 10, 0.01)
plot(x, ptweibull(x, shape=2, scale=0.5, endpoint=1), xlab="x", ylab="CDF", type="l")

</code></pre>

<hr>
<h2 id='VaR'>
VaR of splicing fit
</h2><span id='topic+VaR'></span>

<h3>Description</h3>

<p>Compute Value-at-Risk (<code class="reqn">VaR_{1-p}=Q(1-p)</code>) of the fitted spliced distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>VaR(p, splicefit)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="VaR_+3A_p">p</code></td>
<td>

<p>The exceedance probability (we estimate <code class="reqn">VaR_{1-p}=Q(1-p)</code>).
</p>
</td></tr>
<tr><td><code id="VaR_+3A_splicefit">splicefit</code></td>
<td>

<p>A <code><a href="#topic+SpliceFit">SpliceFit</a></code> object,  e.g. output from <code><a href="#topic+SpliceFitPareto">SpliceFitPareto</a></code>, <code><a href="#topic+SpliceFiticPareto">SpliceFiticPareto</a></code> or <code><a href="#topic+SpliceFitGPD">SpliceFitGPD</a></code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

 
<p>See Reynkens et al. (2017) and Section 4.6 of Albrecher et al. (2017) for details.
</p>
<p>Note that <code>VaR(p, splicefit)</code> corresponds to <code>qSplice(p, splicefit, lower.tail = FALSE)</code>.
</p>


<h3>Value</h3>

<p>Vector of quantiles <code class="reqn">VaR_{1-p}=Q(1-p)</code>.
</p>


<h3>Author(s)</h3>

<p>Tom Reynkens with <code>R</code> code from Roel Verbelen for the mixed Erlang quantiles.
</p>


<h3>References</h3>

<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>
<p>Reynkens, T., Verbelen, R., Beirlant, J. and Antonio, K. (2017). &quot;Modelling Censored Losses Using Splicing:
a Global Fit Strategy With Mixed Erlang and Extreme Value Distributions&quot;. <em>Insurance: Mathematics and Economics</em>, 77, 65&ndash;77.
</p>
<p>Verbelen, R., Gong, L., Antonio, K., Badescu, A. and Lin, S. (2015). &quot;Fitting Mixtures of
Erlangs to Censored and Truncated Data Using the EM Algorithm.&quot; <em>Astin Bulletin</em>, 45, 729&ndash;758
</p>


<h3>See Also</h3>

<p><code><a href="#topic+qSplice">qSplice</a></code>, <code><a href="#topic+CTE">CTE</a></code>, <code><a href="#topic+SpliceFit">SpliceFit</a></code>, <code><a href="#topic+SpliceFitPareto">SpliceFitPareto</a></code>, <code><a href="#topic+SpliceFiticPareto">SpliceFiticPareto</a></code>, <code><a href="#topic+SpliceFitGPD">SpliceFitGPD</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

# Pareto random sample
X &lt;- rpareto(1000, shape = 2)

# Splice ME and Pareto
splicefit &lt;- SpliceFitPareto(X, 0.6)



p &lt;- seq(0,1,0.01)

# Plot of quantiles
plot(p, qSplice(p, splicefit), type="l", xlab="p", ylab="Q(p)")

# Plot of VaR
plot(p, VaR(p, splicefit), type="l", xlab="p", ylab=bquote(VaR[1-p]))

## End(Not run)
</code></pre>

<hr>
<h2 id='WeibullQQ'>
Weibull quantile plot
</h2><span id='topic+WeibullQQ'></span>

<h3>Description</h3>

<p>Computes the empirical quantiles of the log-transform of a data vector and the theoretical quantiles of the standard Weibull distribution. These quantiles are then plotted in a Weibull QQ-plot with the theoretical quantiles on the <code class="reqn">x</code>-axis and the empirical quantiles on the <code class="reqn">y</code>-axis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>WeibullQQ(data, plot = TRUE, main = "Weibull QQ-plot", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="WeibullQQ_+3A_data">data</code></td>
<td>

<p>Vector of <code class="reqn">n</code> observations. 
</p>
</td></tr>
<tr><td><code id="WeibullQQ_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the quantiles should be plotted in a Weibull QQ-plot, default is <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="WeibullQQ_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"Weibull QQ-plot"</code>.
</p>
</td></tr>
<tr><td><code id="WeibullQQ_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Weibull QQ-plot is given by
</p>
<p style="text-align: center;"><code class="reqn">(\log(-\log(1-i/(n+1))),\log X_{i,n})</code>
</p>

<p>for <code class="reqn">i=1,...,n,</code> with <code class="reqn">X_{i,n}</code> the <code class="reqn">i</code>-th order statistic of the data.
</p>
<p>See Section 4.1 of Albrecher et al. (2017) for more details.
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>wqq.the</code></td>
<td>
<p>Vector of the theoretical quantiles from a standard Weibull distribution.</p>
</td></tr>
<tr><td><code>wqq.emp</code></td>
<td>
<p>Vector of the empirical quantiles from the log-transformed data.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens.
</p>


<h3>References</h3>

<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+WeibullQQ_der">WeibullQQ_der</a></code>, <code><a href="#topic+ExpQQ">ExpQQ</a></code>, <code><a href="#topic+LognormalQQ">LognormalQQ</a></code>, <code><a href="#topic+ParetoQQ">ParetoQQ</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(norwegianfire)

# Weibull QQ-plot for Norwegian Fire Insurance data for claims in 1976.
WeibullQQ(norwegianfire$size[norwegianfire$year==76])

# Derivative of Weibull QQ-plot for Norwegian Fire Insurance data for claims in 1976.
WeibullQQ_der(norwegianfire$size[norwegianfire$year==76])
</code></pre>

<hr>
<h2 id='WeibullQQ_der'>
Derivative plot of the Weibull QQ-plot
</h2><span id='topic+WeibullQQ_der'></span>

<h3>Description</h3>

<p>Computes the derivative plot of the Weibull QQ-plot. These values can be plotted as a function of the data or as a function of the tail parameter <code class="reqn">k</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>WeibullQQ_der(data, k = FALSE, plot = TRUE, 
              main = "Derivative plot of Weibull QQ-plot", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="WeibullQQ_der_+3A_data">data</code></td>
<td>

<p>Vector of <code class="reqn">n</code> observations. 
</p>
</td></tr>
<tr><td><code id="WeibullQQ_der_+3A_plot">plot</code></td>
<td>

<p>Logical indicating if the derivative values should be plotted, default is <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="WeibullQQ_der_+3A_k">k</code></td>
<td>

<p>Logical indicating if the derivative values are plotted as a function of the tail parameter <code class="reqn">k</code> (<code>k=TRUE</code>) or as a function of the logarithm of the data (<code>k=FALSE</code>). Default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="WeibullQQ_der_+3A_main">main</code></td>
<td>

<p>Title for the plot, default is <code>"Derivative plot of Weibull QQ-plot"</code>.
</p>
</td></tr>
<tr><td><code id="WeibullQQ_der_+3A_...">...</code></td>
<td>

<p>Additional arguments for the <code>plot</code> function, see <code><a href="graphics.html#topic+plot.default">plot</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The derivative plot of a Weibull QQ-plot is </p>
<p style="text-align: center;"><code class="reqn">(k, H_{k,n}/W_{k,n})</code>
</p>
<p> or </p>
<p style="text-align: center;"><code class="reqn">(\log X_{n-k,n}, H_{k,n}/W_{k,n})</code>
</p>

<p>with <code class="reqn">H_{k,n}</code> the Hill estimates and
</p>
<p style="text-align: center;"><code class="reqn">W_{k,n}=1/k\sum_{j=1}^k \log(\log((n+1)/j))  -  \log(\log((n+1)/(k+1))).</code>
</p>

<p>See Section 4.1 of Albrecher et al. (2017) for more details.
</p>


<h3>Value</h3>

<p>A list with following components:
</p>
<table role = "presentation">
<tr><td><code>xval</code></td>
<td>
<p>Vector of the x-values of the plot (<code class="reqn">k</code> or <code class="reqn">\log X_{n-k,n}</code>).</p>
</td></tr>
<tr><td><code>yval</code></td>
<td>
<p>Vector of the derivative values.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tom Reynkens.
</p>


<h3>References</h3>

<p>Albrecher, H., Beirlant, J. and Teugels, J. (2017). <em>Reinsurance: Actuarial and Statistical Aspects</em>, Wiley, Chichester.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+WeibullQQ">WeibullQQ</a></code>, <code><a href="#topic+Hill">Hill</a></code>, <code><a href="#topic+MeanExcess">MeanExcess</a></code>, <code><a href="#topic+LognormalQQ_der">LognormalQQ_der</a></code>, <code><a href="#topic+ParetoQQ_der">ParetoQQ_der</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(norwegianfire)

# Weibull QQ-plot for Norwegian Fire Insurance data for claims in 1976.
WeibullQQ(norwegianfire$size[norwegianfire$year==76])

# Derivative of Weibull QQ-plot for Norwegian Fire Insurance data for claims in 1976.
WeibullQQ_der(norwegianfire$size[norwegianfire$year==76])
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
