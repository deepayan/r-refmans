<!DOCTYPE html><html><head><title>Help for package proclhmm</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {proclhmm}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#proclhmm-package'><p>proclhmm: Latent Hidden Markov Models for Response Process Data</p></a></li>
<li><a href='#compute_P1_lhmm'><p>Compute LHMM probabilities from parameters</p></a></li>
<li><a href='#compute_paras_hmm'><p>Compute probabilities from logit scale parameters in HMM</p></a></li>
<li><a href='#compute_PQ_lhmm'><p>Compute LHMM probabilities from parameters</p></a></li>
<li><a href='#compute_theta'><p>Estimate latent traits in LHMM</p></a></li>
<li><a href='#find_state_seq'><p>Viterbi algorithm for HMM</p></a></li>
<li><a href='#hmm'><p>MMLE of HMM</p></a></li>
<li><a href='#lhmm'><p>MMLE of LHMM</p></a></li>
<li><a href='#proclhmm'><p>proclhmm: Latent Hidden Markov Models for Response Process Data</p></a></li>
<li><a href='#sim_hmm'><p>Simulating action sequences using HMM</p></a></li>
<li><a href='#sim_hmm_paras'><p>generate HMM parameters</p></a></li>
<li><a href='#sim_lhmm'><p>Simulating action sequences using LHMM</p></a></li>
<li><a href='#sim_lhmm_paras'><p>generate LHMM parameters</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Latent Hidden Markov Models for Response Process Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Xueying Tang &lt;xueyingtang1989@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides functions for simulating from and fitting the latent hidden
    Markov models for response process data (Tang, 2024) &lt;<a href="https://doi.org/10.1007%2Fs11336-023-09938-1">doi:10.1007/s11336-023-09938-1</a>&gt;. 
    It also includes functions for simulating from and fitting ordinary hidden Markov models.</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/xytangtang/proclhmm/issues">https://github.com/xytangtang/proclhmm/issues</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 1.0.8.3), statmod (&ge; 1.4.36)</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-06-05 04:15:23 UTC; xytang</td>
</tr>
<tr>
<td>Author:</td>
<td>Xueying Tang [aut, cre, cph]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-06-05 19:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='proclhmm-package'>proclhmm: Latent Hidden Markov Models for Response Process Data</h2><span id='topic+proclhmm-package'></span>

<h3>Description</h3>

<p>Provides functions for simulating from and fitting the latent hidden Markov models for response process data (Tang, 2024) doi: <a href="https://doi.org/10.1007/s11336-023-09938-1">10.1007/s11336-023-09938-1</a>. It also includes functions for simulating from and fitting ordinary hidden Markov models.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Xueying Tang <a href="mailto:xueyingtang1989@gmail.com">xueyingtang1989@gmail.com</a> [copyright holder]
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li><p> Report bugs at <a href="https://github.com/xytangtang/proclhmm/issues">https://github.com/xytangtang/proclhmm/issues</a>
</p>
</li></ul>


<hr>
<h2 id='compute_P1_lhmm'>Compute LHMM probabilities from parameters</h2><span id='topic+compute_P1_lhmm'></span>

<h3>Description</h3>

<p>Compute initial state probability from LHMM parameters;
currently, the initial state probability does not depend on latent traits
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_P1_lhmm(para_P1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compute_P1_lhmm_+3A_para_p1">para_P1</code></td>
<td>
<p>a vector of length <code>K-1</code>. parameters of initial state probability vector</p>
</td></tr>
</table>


<h3>Value</h3>

<p>initial state probability vector of length <code>K</code>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+compute_PQ_lhmm">compute_PQ_lhmm</a></code> for state-transition and state-action
probabilities of LHMM, <code><a href="#topic+compute_paras_hmm">compute_paras_hmm</a></code> for computing
probabilities in HMM.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>paras &lt;- sim_lhmm_paras(5, 2)
P1 &lt;- compute_P1_lhmm(paras$para_P1)

</code></pre>

<hr>
<h2 id='compute_paras_hmm'>Compute probabilities from logit scale parameters in HMM</h2><span id='topic+compute_paras_hmm'></span>

<h3>Description</h3>

<p>Compute probabilities from logit scale parameters in HMM
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_paras_hmm(para_P, para_Q, para_P1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compute_paras_hmm_+3A_para_p">para_P</code></td>
<td>
<p><code>K</code> by <code>K-1</code> matrix. parameters of state-transition probability matrix</p>
</td></tr>
<tr><td><code id="compute_paras_hmm_+3A_para_q">para_Q</code></td>
<td>
<p><code>K</code> by <code>N-1</code> matrix. parameters of state-action (emission) probability matrix</p>
</td></tr>
<tr><td><code id="compute_paras_hmm_+3A_para_p1">para_P1</code></td>
<td>
<p><code>K-1</code> vector. parameters of initial state probability distribution</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of three elements:
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>P</code> </td><td style="text-align: left;"> <code>K</code> by <code>K</code> state-transition probability matrix </td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>Q</code> </td><td style="text-align: left;"> <code>K</code> by <code>N</code> state-action (emission) probability matrix </td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>P1</code> </td><td style="text-align: left;"> initial state probability vector of length <code>K</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>See Also</h3>

<p><code><a href="#topic+compute_PQ_lhmm">compute_PQ_lhmm</a></code>, <code><a href="#topic+compute_P1_lhmm">compute_P1_lhmm</a></code> for computing probabilities in LHMM
</p>


<h3>Examples</h3>

<pre><code class='language-R'>paras &lt;- sim_hmm_paras(5, 2, return_prob=FALSE)
prob_paras &lt;- compute_paras_hmm(paras$para_P, paras$para_Q, paras$para_P1)

</code></pre>

<hr>
<h2 id='compute_PQ_lhmm'>Compute LHMM probabilities from parameters</h2><span id='topic+compute_PQ_lhmm'></span>

<h3>Description</h3>

<p>Compute state-transition and state-action (emission) probability matrices
from LHMM parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_PQ_lhmm(theta, para_a, para_b, para_alpha, para_beta)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compute_PQ_lhmm_+3A_theta">theta</code></td>
<td>
<p>latent trait</p>
</td></tr>
<tr><td><code id="compute_PQ_lhmm_+3A_para_a">para_a</code></td>
<td>
<p><code>K</code> by <code>K-1</code> matrix. discrimination parameters of state transition probability matrix</p>
</td></tr>
<tr><td><code id="compute_PQ_lhmm_+3A_para_b">para_b</code></td>
<td>
<p><code>K</code> by <code>K-1</code> matrix. location parameters of state transition probability matrix</p>
</td></tr>
<tr><td><code id="compute_PQ_lhmm_+3A_para_alpha">para_alpha</code></td>
<td>
<p><code>K</code> by <code>N-1</code> matrix. discrimination parameters of state-action (emission) probability matrix</p>
</td></tr>
<tr><td><code id="compute_PQ_lhmm_+3A_para_beta">para_beta</code></td>
<td>
<p><code>K</code> by <code>N-1</code> matrix. location parameters of state-action (emission) probability matrix</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of two elements
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>P</code> </td><td style="text-align: left;"> <code>K</code> by <code>K</code> state-transition probability matrix </td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>Q</code> </td><td style="text-align: left;"> <code>K</code> by <code>N</code> state-action probability matrix </td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>See Also</h3>

<p><code><a href="#topic+compute_P1_lhmm">compute_P1_lhmm</a></code> for initial state probabilities of
LHMM, <code><a href="#topic+compute_paras_hmm">compute_paras_hmm</a></code> for computing probabilities in HMM.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>paras &lt;- sim_lhmm_paras(5, 2)
prob_paras &lt;- compute_PQ_lhmm(1.5, paras$para_a, paras$para_b, paras$para_alpha, paras$para_beta)

</code></pre>

<hr>
<h2 id='compute_theta'>Estimate latent traits in LHMM</h2><span id='topic+compute_theta'></span>

<h3>Description</h3>

<p>Compute MAP estimates of latent traits given LHMM parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_theta(int_seqs, para_a, para_b, para_alpha, para_beta, para_P1, n_pts)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compute_theta_+3A_int_seqs">int_seqs</code></td>
<td>
<p>a list of <code>n</code> action sequences where actions are coded as integers 0, ..., N-1</p>
</td></tr>
<tr><td><code id="compute_theta_+3A_para_a">para_a</code></td>
<td>
<p><code>K</code> by <code>K-1</code> matrix. discrimination parameters of state transition probability matrix</p>
</td></tr>
<tr><td><code id="compute_theta_+3A_para_b">para_b</code></td>
<td>
<p><code>K</code> by <code>K-1</code> matrix. location parameters of state transition probability matrix</p>
</td></tr>
<tr><td><code id="compute_theta_+3A_para_alpha">para_alpha</code></td>
<td>
<p><code>K</code> by <code>N-1</code> matrix. discrimination parameters of state-action (emission) probability matrix</p>
</td></tr>
<tr><td><code id="compute_theta_+3A_para_beta">para_beta</code></td>
<td>
<p><code>K</code> by <code>N-1</code> matrix. location parameters of state-action (emission) probability matrix</p>
</td></tr>
<tr><td><code id="compute_theta_+3A_para_p1">para_P1</code></td>
<td>
<p>a vector of length <code>K-1</code>. parameters of initial state probability vector</p>
</td></tr>
<tr><td><code id="compute_theta_+3A_n_pts">n_pts</code></td>
<td>
<p>number of quadrature points</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector of length <code>n</code>. Estimated latent traits.
</p>

<hr>
<h2 id='find_state_seq'>Viterbi algorithm for HMM</h2><span id='topic+find_state_seq'></span>

<h3>Description</h3>

<p>Find the most likely hidden state sequence of an observed sequence under HMM
</p>


<h3>Usage</h3>

<pre><code class='language-R'>find_state_seq(seq, P1, P, Q)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="find_state_seq_+3A_seq">seq</code></td>
<td>
<p>An action sequence coded in integers</p>
</td></tr>
<tr><td><code id="find_state_seq_+3A_p1">P1</code></td>
<td>
<p>initial state probability vector of length <code>K</code></p>
</td></tr>
<tr><td><code id="find_state_seq_+3A_p">P</code></td>
<td>
<p><code>K</code> by <code>K</code> state transition probability matrix</p>
</td></tr>
<tr><td><code id="find_state_seq_+3A_q">Q</code></td>
<td>
<p><code>K</code> by <code>N</code> state-action (emission) probability matrix</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a hidden state sequence coded in integers
</p>

<hr>
<h2 id='hmm'>MMLE of HMM</h2><span id='topic+hmm'></span>

<h3>Description</h3>

<p>Maximum marginalized likelihood estimation of HMM.
Optimization is performed through <code><a href="stats.html#topic+optim">optim</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hmm(action_seqs, K, paras, verbose = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hmm_+3A_action_seqs">action_seqs</code></td>
<td>
<p>a list of <code>n</code> action sequences</p>
</td></tr>
<tr><td><code id="hmm_+3A_k">K</code></td>
<td>
<p>number of hidden states</p>
</td></tr>
<tr><td><code id="hmm_+3A_paras">paras</code></td>
<td>
<p>a list of elements named <code>para_P1</code>, <code>para_P</code>, and <code>para_Q</code>,
providing initial values of model parameters</p>
</td></tr>
<tr><td><code id="hmm_+3A_verbose">verbose</code></td>
<td>
<p>logical. If <code>TRUE</code>, progress messages are printed.</p>
</td></tr>
<tr><td><code id="hmm_+3A_...">...</code></td>
<td>
<p>additional arguments passed to <code><a href="stats.html#topic+optim">optim</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list containing the following elements
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>seqs</code> </td><td style="text-align: left;"> action sequences coded in integers </td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>K</code> </td><td style="text-align: left;"> number of hidden states </td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>N</code> </td><td style="text-align: left;"> number of distinct actions </td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>paras_init</code> </td><td style="text-align: left;"> a list containing initial values of parameters </td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>paras_est</code> </td><td style="text-align: left;"> a list containing parameter estimates </td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>init_mllh</code> </td><td style="text-align: left;"> initial value of the marginalized likelihood function </td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>opt_mllh</code> </td><td style="text-align: left;"> maximized marginalized likelihood function </td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>opt_res</code> </td><td style="text-align: left;"> object returned by <code><a href="stats.html#topic+optim">optim</a></code> </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Examples</h3>

<pre><code class='language-R'># generate data
paras_true &lt;- sim_hmm_paras(5, 2)
sim_data &lt;- sim_hmm(20, paras_true, 4, 10)
# randomly generate initial values of parameters
paras_init &lt;- sim_hmm_paras(5, 2, return_prob=FALSE)
# fit hmm
hmm_res &lt;- hmm(sim_data$seqs, 2, paras_init)

</code></pre>

<hr>
<h2 id='lhmm'>MMLE of LHMM</h2><span id='topic+lhmm'></span>

<h3>Description</h3>

<p>Maximum marginalized likelihood estimation of LHMM.
Marginalization over latent trait is computed numerically using Guassian-Hermite quadratures from <code><a href="statmod.html#topic+statmod">statmod</a></code>.
Optimization is performed through <code><a href="stats.html#topic+optim">optim</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lhmm(action_seqs, K, paras, n_pts = 100, verbose = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lhmm_+3A_action_seqs">action_seqs</code></td>
<td>
<p>a list of <code>n</code> action sequences</p>
</td></tr>
<tr><td><code id="lhmm_+3A_k">K</code></td>
<td>
<p>number of hidden states</p>
</td></tr>
<tr><td><code id="lhmm_+3A_paras">paras</code></td>
<td>
<p>a list of elements named <code>para_a</code>, <code>para_b</code>, <code>para_alpha</code>, <code>para_beta</code>, and <code>para_P1</code>,
providing initial values of model parameters</p>
</td></tr>
<tr><td><code id="lhmm_+3A_n_pts">n_pts</code></td>
<td>
<p>number of quadrature points</p>
</td></tr>
<tr><td><code id="lhmm_+3A_verbose">verbose</code></td>
<td>
<p>logical. If <code>TRUE</code>, progress messages are printed.</p>
</td></tr>
<tr><td><code id="lhmm_+3A_...">...</code></td>
<td>
<p>additional arguments passed to <code><a href="stats.html#topic+optim">optim</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the following elements
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>seqs</code> </td><td style="text-align: left;"> action sequences coded in integers </td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>K</code> </td><td style="text-align: left;"> number of hidden states </td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>N</code> </td><td style="text-align: left;"> number of distinct actions </td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>paras_init</code> </td><td style="text-align: left;"> a list containing initial values of parameters </td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>paras_est</code> </td><td style="text-align: left;"> a list containing parameter estimates </td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>theta_est</code> </td><td style="text-align: left;"> a vector of length <code>n</code>. estimated latent traits </td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>init_mllh</code> </td><td style="text-align: left;"> initial value of the marginalized likelihood function </td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>opt_mllh</code> </td><td style="text-align: left;"> maximized marginalized likelihood function </td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>opt_res</code> </td><td style="text-align: left;"> object returned by <code><a href="stats.html#topic+optim">optim</a></code> </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Examples</h3>

<pre><code class='language-R'># generate data
paras_true &lt;- sim_lhmm_paras(5, 2)
sim_data &lt;- sim_lhmm(10, paras_true, 3, 5)
# randomly initialize parameters
paras_init &lt;- sim_lhmm_paras(5, 2)
# fit model
lhmm_res &lt;- lhmm(sim_data$seqs, 2, paras_init)

</code></pre>

<hr>
<h2 id='proclhmm'>proclhmm: Latent Hidden Markov Models for Response Process Data</h2><span id='topic+proclhmm'></span>

<h3>Description</h3>

<p>This package provides functions for simulating from and fitting the latent hidden
Markov models for response process data (Tang, 2024).
It also includes functions for simulating from and fitting ordinary hidden Markov models.
</p>


<h3>Data Simulation Functions</h3>


<ul>
<li> <p><code><a href="#topic+sim_hmm_paras">sim_hmm_paras</a></code> generates parameters of HMM
</p>
</li>
<li> <p><code><a href="#topic+sim_hmm">sim_hmm</a></code> generates actions sequences from HMM.
</p>
</li>
<li> <p><code><a href="#topic+sim_lhmm_paras">sim_lhmm_paras</a></code> generates parameters of LHMM
</p>
</li>
<li> <p><code><a href="#topic+sim_lhmm">sim_lhmm</a></code> generates actions sequences from LHMM.
</p>
</li></ul>



<h3>Model Fitting Functions</h3>


<ul>
<li> <p><code><a href="#topic+hmm">hmm</a></code> fits HMM models. Parameters are estimated
through marginalized maximum likelihood estimation.
</p>
</li>
<li> <p><code><a href="#topic+lhmm">lhmm</a></code> fits LHMM models. Parameters are estimated
through marginalized maximum likelihood estimation.
</p>
</li>
<li> <p><code><a href="#topic+compute_theta">compute_theta</a></code> compute MAP estimates of latent traits in LHMM.
</p>
</li>
<li> <p><code><a href="#topic+find_state_seq">find_state_seq</a></code> compute the most likely hidden state sequence.
</p>
</li></ul>



<h3>Acknowledgment</h3>

<p>The development of this package is supported by National Science Foundation
grant DMS-2310664.
</p>


<h3>References</h3>

<p>Tang, X. (2024) Latent Hidden Markov Models for Response Process Data. Psychometrika 89, 205-240. doi: <a href="https://doi.org/10.1007/s11336-023-09938-1">10.1007/s11336-023-09938-1</a>
</p>

<hr>
<h2 id='sim_hmm'>Simulating action sequences using HMM</h2><span id='topic+sim_hmm'></span>

<h3>Description</h3>

<p><code>sim_hmm</code> generate <code>n</code> action sequences from HMM based on given parameters.
The lengths of the generated sequences are simulated from a Poission distribution with
mean <code>mean_len</code> and at least <code>min_len</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim_hmm(n, paras, min_len, mean_len, return_state = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim_hmm_+3A_n">n</code></td>
<td>
<p>number of action sequences to be generated</p>
</td></tr>
<tr><td><code id="sim_hmm_+3A_paras">paras</code></td>
<td>
<p>a list containing specified HMM parameters: state-transition probability matrix (<code>P</code>),
state-action probability matrix (<code>Q</code>), and initial state probability (<code>P1</code>).</p>
</td></tr>
<tr><td><code id="sim_hmm_+3A_min_len">min_len</code></td>
<td>
<p>minimum length of generated sequences</p>
</td></tr>
<tr><td><code id="sim_hmm_+3A_mean_len">mean_len</code></td>
<td>
<p>mean length of generated sequences</p>
</td></tr>
<tr><td><code id="sim_hmm_+3A_return_state">return_state</code></td>
<td>
<p>logical. Whether generated hidden state sequences should be returned or not.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>sim_hmm</code> returns a list of <code>n</code> generated action sequences if <code>return_state = FALSE</code>.
If <code>return_state = TRUE</code>, it returns a list of two lists, <code>seqs</code> and <code>state_seqs</code>. <code>seqs</code> gives
the generated action sequences. <code>state_seqs</code> gives the corresponding hidden state sequences.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>paras &lt;- sim_hmm_paras(5,2)
sim_data &lt;- sim_hmm(20, paras, 3, 10)

</code></pre>

<hr>
<h2 id='sim_hmm_paras'>generate HMM parameters</h2><span id='topic+sim_hmm_paras'></span>

<h3>Description</h3>

<p><code>sim_hmm_paras</code> generates logit scale parameters of HMM with <code>K</code> hidden states and
<code>N</code> distinct actions from Uniform(-0.5, 0.5).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim_hmm_paras(N, K, return_prob = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim_hmm_paras_+3A_n">N</code></td>
<td>
<p>number of distinct actions</p>
</td></tr>
<tr><td><code id="sim_hmm_paras_+3A_k">K</code></td>
<td>
<p>number of hidden states</p>
</td></tr>
<tr><td><code id="sim_hmm_paras_+3A_return_prob">return_prob</code></td>
<td>
<p>logical. indicates to return parameters in probability scale (<code>TRUE</code>, default) or logit scale.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of three elements.
If <code>return_prob = TRUE</code>, the element names are <code>P1</code>, <code>P</code>, and <code>Q</code>.
If <code>return_prob = FALSE</code>, the element names are <code>para_P1</code>, <code>para_P</code>, and <code>oara_Q</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># generate probability parameters
set.seed(12345)
paras1 &lt;- sim_hmm_paras(5, 2)
names(paras1)

# generate parameters in the logit scale
set.seed(12345)
paras2 &lt;- sim_hmm_paras(5, 2, return_prob = FALSE)
names(paras2)

paras1$P1
paras2$para_P1

# logit scale parameters can be transformed to probability parameters
all.equal(compute_paras_hmm(paras2$para_P, paras2$para_Q, paras2$para_P1), paras1)

</code></pre>

<hr>
<h2 id='sim_lhmm'>Simulating action sequences using LHMM</h2><span id='topic+sim_lhmm'></span>

<h3>Description</h3>

<p><code>sim_lhmm</code> generate <code>n</code> action sequences from LHMM based on given parameters.
The lengths of the generated sequences are simulated from a Poission distribution with
mean <code>mean_len</code> and at least <code>min_len</code>. The latent trait is generated from standard
normal.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim_lhmm(n, paras, min_len, mean_len, return_state = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim_lhmm_+3A_n">n</code></td>
<td>
<p>number of action sequences to be generated</p>
</td></tr>
<tr><td><code id="sim_lhmm_+3A_paras">paras</code></td>
<td>
<p>a list containing specified LHMM parameters: <code>para_a</code>, <code>para_b</code>, <code>para_alpha</code>,
<code>para_beta</code>, and <code>para_P1</code>.</p>
</td></tr>
<tr><td><code id="sim_lhmm_+3A_min_len">min_len</code></td>
<td>
<p>minimum length of generated sequences</p>
</td></tr>
<tr><td><code id="sim_lhmm_+3A_mean_len">mean_len</code></td>
<td>
<p>mean length of generated sequences</p>
</td></tr>
<tr><td><code id="sim_lhmm_+3A_return_state">return_state</code></td>
<td>
<p>logical. Whether generated hidden state sequences should be returned or not.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If <code>return_state = TRUE</code>, <code>sim_hmm</code> returns a list of three elements
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>seqs</code> </td><td style="text-align: left;"> a list of <code>n</code> generated action sequences </td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>theta</code> </td><td style="text-align: left;"> latent traits as a vector of length <code>n</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>state_seqs</code> </td><td style="text-align: left;"> a list of <code>n</code> hidden state sequences
</td>
</tr>

</table>

<p>If <code>return_state = FALSE</code>, the returned list only contains <code>seqs</code> and <code>theta</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>paras &lt;- sim_lhmm_paras(5,2)
sim_data &lt;- sim_lhmm(20, paras, 4, 10)

</code></pre>

<hr>
<h2 id='sim_lhmm_paras'>generate LHMM parameters</h2><span id='topic+sim_lhmm_paras'></span>

<h3>Description</h3>

<p><code>sim_hmm_paras</code> generates the parameters of LHMM with <code>K</code> hidden states
and <code>N</code> distinct actions from Uniform(-0.5, 0.5).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim_lhmm_paras(N, K)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim_lhmm_paras_+3A_n">N</code></td>
<td>
<p>number of distinct actions</p>
</td></tr>
<tr><td><code id="sim_lhmm_paras_+3A_k">K</code></td>
<td>
<p>number of hidden states</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of five elements, <code>para_a</code>, <code>para_b</code>, <code>para_alpha</code>, <code>para_beta</code>, and <code>para_P1</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>paras &lt;- sim_lhmm_paras(5, 2)
paras

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
