<!DOCTYPE html><html><head><title>Help for package fipp</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {fipp}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#dbnb'><p>Probability density function of the BNB distribution</p></a></li>
<li><a href='#fipp'><p>Moments of symmetric additive functional computed over the induced prior</p>
partitions (static/dynamic MFMs and DPM)</a></li>
<li><a href='#nClusters'><p>Prior pmf of the number of data clusters for three model types (static/dynamic</p>
MFMs and DPM)</a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Induced Priors in Bayesian Mixture Models</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Computes implicitly induced quantities from prior/hyperparameter    
    specifications of three Mixtures of Finite Mixtures models: Dirichlet 
    Process Mixtures (DPMs; Escobar and West (1995) 
    &lt;<a href="https://doi.org/10.1080%2F01621459.1995.10476550">doi:10.1080/01621459.1995.10476550</a>&gt;), Static Mixtures of Finite Mixtures 
    (Static MFMs; Miller and Harrison (2018) 
    &lt;<a href="https://doi.org/10.1080%2F01621459.2016.1255636">doi:10.1080/01621459.2016.1255636</a>&gt;), and Dynamic Mixtures of Finite 
    Mixtures (Dynamic MFMs; Frühwirth-Schnatter, Malsiner-Walli and Grün (2020)
    &lt;<a href="https://doi.org/10.48550/arXiv.2005.09918">doi:10.48550/arXiv.2005.09918</a>&gt;). For methodological details, please refer to 
    Greve, Grün, Malsiner-Walli and Frühwirth-Schnatter (2020)
    &lt;<a href="https://doi.org/10.48550/arXiv.2012.12337">doi:10.48550/arXiv.2012.12337</a>&gt;) as well as the package vignette.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp, stats, matrixStats</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-02-07 20:49:26 UTC; jan</td>
</tr>
<tr>
<td>Author:</td>
<td>Jan Greve [aut, cre],
  Bettina Grün <a href="https://orcid.org/0000-0001-7265-4773"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb],
  Gertraud Malsiner-Walli
    <a href="https://orcid.org/0000-0002-1213-4749"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [ctb],
  Sylvia Frühwirth-Schnatter
    <a href="https://orcid.org/0000-0003-0516-5552"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jan Greve &lt;jan.greve@wu.ac.at&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-02-11 10:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='dbnb'>Probability density function of the BNB distribution</h2><span id='topic+dbnb'></span>

<h3>Description</h3>

<p>Evaluates the probability density function of the
beta-negative-binomial (BNB) distribution with a mean parameter and
two shape parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dbnb(x, mu, a, b, log = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dbnb_+3A_x">x</code></td>
<td>
<p>vector of quantiles.</p>
</td></tr>
<tr><td><code id="dbnb_+3A_mu">mu</code></td>
<td>
<p>mean parameter.</p>
</td></tr>
<tr><td><code id="dbnb_+3A_a">a</code></td>
<td>
<p>1st shape parameter.</p>
</td></tr>
<tr><td><code id="dbnb_+3A_b">b</code></td>
<td>
<p>2nd shape parameter.</p>
</td></tr>
<tr><td><code id="dbnb_+3A_log">log</code></td>
<td>
<p>logical; if TRUE, density values p are given as log(p).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The BNB distribution has density
</p>
<p style="text-align: center;"><code class="reqn">
  f(x) = \frac{\Gamma(\mu + x) B(\mu + a, x + b)}{\Gamma(\mu) \Gamma(x + 1) B(a, b)},
</code>
</p>

<p>where <code class="reqn">\mu</code> is the mean parameter and <code class="reqn">a</code> and <code class="reqn">b</code> are the first and
second shape parameter.
</p>


<h3>Value</h3>

<p>Numeric vector of density values.
</p>


<h3>References</h3>

<p>Frühwirth-Schnatter, S., Malsiner-Walli, G., and Grün, B. (2020)
Generalized mixtures of finite mixtures and telescoping sampling
<a href="https://arxiv.org/abs/2005.09918">https://arxiv.org/abs/2005.09918</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Similar to other d+DISTRIBUTION_NAME functions such as dnorm, it
## evaluates the density of a distribution (in this case the BNB distri)
## at point x
##
## Let's try with the density of x = 1 for BNB(1,4,3)
x &lt;- 1
dbnb(x, mu = 1, a = 4, b = 3)

## The primary use of this function is in the closures returned from
## fipp() or nCluststers() as a prior on K-1
pmf &lt;- nClusters(Kplus = 1:15, N = 100, type = "static",
gamma = 1, maxK = 150)

## Now evaluate above when K-1 ~ BNB(1,4,3)
pmf(priorK = dbnb, priorKparams = list(mu = 1, a = 4, b = 3))

## Compare the result with the case when K-1 ~ Pois(1)
pmf(priorK = dpois, priorKparams = list(lambda = 1))

## Although both BNB(1,4,3) and Pois(1) have 1 as their mean, the former
## has a fatter rhs tail. We see that it is reflected in the induced prior 
## on K+ as well

</code></pre>

<hr>
<h2 id='fipp'>Moments of symmetric additive functional computed over the induced prior
partitions (static/dynamic MFMs and DPM)</h2><span id='topic+fipp'></span>

<h3>Description</h3>

<p><code>fipp</code> is a closure which returns a function that computes moments of a
user-specified functional over the induced prior partitions. Required
arguments are: prior distribution of the number of mixture components and its
parameters (see examples for details). Optional arguments are: the number of
moments to be evaluated (currently only up to 2 are implemented) and whether
the mean/variance or 1st/2nd moments should be printed out as a result of
computing the first two moments (default is set to print out mean/variance).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fipp(
  lfunc,
  Kplus,
  N,
  type = c("DPM", "static", "dynamic"),
  alpha = NULL,
  gamma = NULL,
  maxK = NULL,
  log = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fipp_+3A_lfunc">lfunc</code></td>
<td>
<p>a logged version of the additive symmetric functional intended
to compute over the prior partition. The function should only accept one
argument N_j (= number of observations in each partition).</p>
</td></tr>
<tr><td><code id="fipp_+3A_kplus">Kplus</code></td>
<td>
<p>a numeric value that represents the number of filled clusters in
data</p>
</td></tr>
<tr><td><code id="fipp_+3A_n">N</code></td>
<td>
<p>the number of observation in data</p>
</td></tr>
<tr><td><code id="fipp_+3A_type">type</code></td>
<td>
<p>the type of model considered. Three models (static/dynamic MFMs
and DPM) are supported.</p>
</td></tr>
<tr><td><code id="fipp_+3A_alpha">alpha</code>, <code id="fipp_+3A_gamma">gamma</code></td>
<td>
<p>hyperparameters for the Dirichlet prior. For static MFM,
gamma should be specified, while alpha should be specified for all other
models (that is, for dynamic MFM and DPM).</p>
</td></tr>
<tr><td><code id="fipp_+3A_maxk">maxK</code></td>
<td>
<p>the maximum number of K (= the number of mixture components)
considered. Only needed for static/dynamic MFMs.</p>
</td></tr>
<tr><td><code id="fipp_+3A_log">log</code></td>
<td>
<p>logical, indicating whether the probability should be logged or
not</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>fipp</code> returns a function which takes two required arguments
(required only for static/dynamic MFMs) and 2 optional arguments:
</p>
 <dl>
<dt>priorK</dt><dd><p>a function with support on the positive integers.
The function serves as a prior of K (default = NULL which is for DPM).</p>
</dd>
<dt>priorKparams</dt><dd><p>a named list of prior parameters for the function
supplied in argument <code>priorK</code> (default = NULL which is for
DPM).</p>
</dd><dt>order</dt><dd><p>maximum number of moments to be evaluated by the
function (default = 2)</p>
</dd><dt>replace2ndwvar</dt><dd><p>replace 2nd moment with
variance (default = TRUE)</p>
</dd></dl>



<h3>References</h3>

<p>Greve, J., Grün, B., Malsiner-Walli, G., and Frühwirth-Schnatter, S. (2020)
Spying on the Prior of the Number of Data Clusters and the Partition Distribution in Bayesian Cluster Analysis.
<a href="https://arxiv.org/abs/2012.12337">https://arxiv.org/abs/2012.12337</a>
</p>
<p>Escobar, M. D., and West, M. (1995) Bayesian Density Estimation and Inference Using Mixtures.
<em>Journal of the American Statistical Association</em> <b>90</b> (430), Taylor &amp; Francis: 577-–88.
<a href="https://www.tandfonline.com/doi/abs/10.1080/01621459.1995.10476550">https://www.tandfonline.com/doi/abs/10.1080/01621459.1995.10476550</a>
</p>
<p>Miller, J. W., and Harrison, M. T. (2018) Mixture Models with a Prior on the Number of Components.
<em>Journal of the American Statistical Association</em> <b>113</b> (521), Taylor &amp; Francis: 340-–56.
<a href="https://www.tandfonline.com/doi/full/10.1080/01621459.2016.1255636">https://www.tandfonline.com/doi/full/10.1080/01621459.2016.1255636</a>
</p>
<p>Frühwirth-Schnatter, S., Malsiner-Walli, G., and Grün, B. (2020)
Generalized mixtures of finite mixtures and telescoping sampling <a href="https://arxiv.org/abs/2005.09918">https://arxiv.org/abs/2005.09918</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Determine mean/variance of the number of singleton clusters for dynamic 
## MFM model conditional on K+ = 5, alpha = 1 with a sample size N = 100.
## We assume that K will be smaller than 30 by setting maxK = 30, please
## increase this value for more realistic analysis.
## 
## First create the function singletons():
singletons &lt;- fipp(lfunc = function(n) log(n==1), Kplus = 5, N = 100,
  type = "dynamic", alpha = 1, maxK = 30)

## Then evaluate it using a Geom(0.1) prior:
singletons(dgeom, list(prob = 0.1))

## Try a different prior, the Poisson prior Pois(1):
singletons(dpois, list(lambda = 1))

## If mean is the only thing you are interested in, try the following:
singletons(dpois, list(lambda = 1), order = 1)

## Also, if you want 1st/2nd moments instead of mean/variance, try:
singletons(dpois, list(lambda = 1), replace2ndwvar = FALSE)

</code></pre>

<hr>
<h2 id='nClusters'>Prior pmf of the number of data clusters for three model types (static/dynamic
MFMs and DPM)</h2><span id='topic+nClusters'></span>

<h3>Description</h3>

<p><code>nClusters</code> is a closure that returns a function which computes a table
of probability masses for specified K+s. Arguments needed for the returned
function to evaluate are: prior distribution of the number of mixture
components and its parameters (see examples for details).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nClusters(
  Kplus,
  N,
  type = c("DPM", "static", "dynamic"),
  alpha = NULL,
  gamma = NULL,
  maxK = NULL,
  log = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nClusters_+3A_kplus">Kplus</code></td>
<td>
<p>a numeric value or vector. All values must be positive integers
(that is 1,2,...). It specifies the range of the number of data clusters
the user wants to evaluate the prior probabilities on.</p>
</td></tr>
<tr><td><code id="nClusters_+3A_n">N</code></td>
<td>
<p>the number of observations in data</p>
</td></tr>
<tr><td><code id="nClusters_+3A_type">type</code></td>
<td>
<p>the type of model considered. Three models (static/dynamic MFMs
and DPM) are supported.</p>
</td></tr>
<tr><td><code id="nClusters_+3A_alpha">alpha</code>, <code id="nClusters_+3A_gamma">gamma</code></td>
<td>
<p>hyperparameters for the symmetric Dirichlet prior. For
static MFM, gamma should be specified, while alpha should be specified for
all other models (that is, dynamic MFM and DPM).</p>
</td></tr>
<tr><td><code id="nClusters_+3A_maxk">maxK</code></td>
<td>
<p>the maximum number of K (= the number of mixture components)
considered. Only needed for static/dynamic MFMs.</p>
</td></tr>
<tr><td><code id="nClusters_+3A_log">log</code></td>
<td>
<p>logical, indicating whether the returned probability should be
logged or not</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>nClusters</code> returns a function which takes two arguments:
</p>
 <dl>
<dt>priorK</dt><dd><p>a function with support on the positive integers.
The function serves as a prior on K (default = NULL which is for the DPM).</p>
</dd>
<dt>priorKparams</dt><dd><p>a named list of prior parameters for the function
supplied in argument <code>priorK</code> (default = NULL which is for the
DPM).</p>
</dd></dl>



<h3>References</h3>

<p>Greve, J., Grün, B., Malsiner-Walli, G., and Frühwirth-Schnatter, S. (2020)
Spying on the Prior of the Number of Data Clusters and the Partition Distribution in Bayesian Cluster Analysis.
<a href="https://arxiv.org/abs/2012.12337">https://arxiv.org/abs/2012.12337</a>
</p>
<p>Escobar, M. D., and West, M. (1995) Bayesian Density Estimation and Inference Using Mixtures.
<em>Journal of the American Statistical Association</em> <b>90</b> (430), Taylor &amp; Francis: 577-–88.
<a href="https://www.tandfonline.com/doi/abs/10.1080/01621459.1995.10476550">https://www.tandfonline.com/doi/abs/10.1080/01621459.1995.10476550</a>
</p>
<p>Miller, J. W., and Harrison, M. T. (2018) Mixture Models with a Prior on the Number of Components.
<em>Journal of the American Statistical Association</em> <b>113</b> (521), Taylor &amp; Francis: 340-–56.
<a href="https://www.tandfonline.com/doi/full/10.1080/01621459.2016.1255636">https://www.tandfonline.com/doi/full/10.1080/01621459.2016.1255636</a>
</p>
<p>Frühwirth-Schnatter, S., Malsiner-Walli, G., and Grün, B. (2020)
Generalized mixtures of finite mixtures and telescoping sampling <a href="https://arxiv.org/abs/2005.09918">https://arxiv.org/abs/2005.09918</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## first, create the function pmf() for the dynamic MFM
## with N = 100, K+ evaluated between 1 and 15 with alpha = 1,
## we assume that K will be smaller than 30 by setting maxK  = 30,
## please increase this value for more realistic analysis.
pmf &lt;- nClusters(Kplus = 1:15, N = 100, type = "dynamic",
alpha = 1, maxK = 30)

## then, specifiy the prior for K so that the pmf can be evaluated
## between K+ = 1 and K+ = 15
pmf(dgeom, list(prob = 0.1))

## we can also compare this result with a different prior setting
pmf(dpois, list(lambda = 1))

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
