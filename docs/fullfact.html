<!DOCTYPE html><html><head><title>Help for package fullfact</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {fullfact}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#barMANA'><p>Bargraph of confidence intervals</p></a></li>
<li><a href='#boxMANA'><p>Boxplot of resampled results</p></a></li>
<li><a href='#buildBinary'><p>Convert to a binary data frame</p></a></li>
<li><a href='#buildMulti'><p>Convert to a multinomial frame</p></a></li>
<li><a href='#chinook_bootL'><p>Chinook salmon length, bootstrap calculations</p></a></li>
<li><a href='#chinook_bootS'><p>Chinook salmon survival, bootstrap data</p></a></li>
<li><a href='#chinook_jackL'><p>Chinook salmon length, jackknife data</p></a></li>
<li><a href='#chinook_jackS'><p>Chinook salmon survival, jackknife data</p></a></li>
<li><a href='#chinook_length'><p>Chinook salmon length, raw data</p></a></li>
<li><a href='#chinook_resampL'><p>Chinook salmon length, bootstrap resampled</p></a></li>
<li><a href='#chinook_resampS'><p>Chinook salmon survival, bootstrap resampled</p></a></li>
<li><a href='#chinook_survival'><p>Chinook salmon survival, raw data</p></a></li>
<li><a href='#ciJack'><p>Jackknife confidence intervals</p></a></li>
<li><a href='#ciJack2'><p>Jackknife confidence intervals 2</p></a></li>
<li><a href='#ciJack3'><p>Jackknife confidence intervals 3</p></a></li>
<li><a href='#ciMANA'><p>Bootstrap confidence intervals</p></a></li>
<li><a href='#ciMANA2'><p>Bootstrap confidence intervals 2</p></a></li>
<li><a href='#ciMANA3'><p>Bootstrap confidence intervals 3</p></a></li>
<li><a href='#fullfact-internal'><p>Internal fullfact functions</p></a></li>
<li><a href='#fullfact-package'>
<p>Full Factorial Breeding Analysis</p></a></li>
<li><a href='#JackGlmer'><p>Jackknife components for non-normal data</p></a></li>
<li><a href='#JackGlmer2'><p>Jackknife components for non-normal data 2</p></a></li>
<li><a href='#JackGlmer3'><p>Jackknife components for non-normal data 3</p></a></li>
<li><a href='#JackLmer'><p>Jackknife components for normal data</p></a></li>
<li><a href='#JackLmer2'><p>Jackknife components for normal data 2</p></a></li>
<li><a href='#JackLmer3'><p>Jackknife components for normal data 3</p></a></li>
<li><a href='#observGlmer'><p>Variance components for non-normal data</p></a></li>
<li><a href='#observGlmer2'><p>Variance components for non-normal data 2</p></a></li>
<li><a href='#observGlmer3'><p>Variance components for non-normal data 3</p></a></li>
<li><a href='#observLmer'><p>Variance components for normal data</p></a></li>
<li><a href='#observLmer2'><p>Variance components for normal data 2</p></a></li>
<li><a href='#observLmer3'><p>Variance components for normal data 3</p></a></li>
<li><a href='#powerGlmer'><p>Power analysis for non-normal data</p></a></li>
<li><a href='#powerGlmer2'><p>Power analysis for non-normal data 2</p></a></li>
<li><a href='#powerGlmer3'><p>Power analysis for non-normal data 3</p></a></li>
<li><a href='#powerLmer'><p>Power analysis for normal data</p></a></li>
<li><a href='#powerLmer2'><p>Power analysis for normal data 2</p></a></li>
<li><a href='#powerLmer3'><p>Power analysis for normal data 3</p></a></li>
<li><a href='#resampFamily'><p>Bootstrap resample within families</p></a></li>
<li><a href='#resampGlmer'><p>Bootstrap components for non-normal data</p></a></li>
<li><a href='#resampGlmer2'><p>Bootstrap components for non-normal data 2</p></a></li>
<li><a href='#resampGlmer3'><p>Bootstrap components for non-normal data 3</p></a></li>
<li><a href='#resampLmer'><p>Bootstrap components for normal data</p></a></li>
<li><a href='#resampLmer2'><p>Bootstrap components for normal data 2</p></a></li>
<li><a href='#resampLmer3'><p>Bootstrap components for normal data 3</p></a></li>
<li><a href='#resampRepli'><p>Bootstrap resample within replicates</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Full Factorial Breeding Analysis</td>
</tr>
<tr>
<td>Version:</td>
<td>1.5.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-02-04</td>
</tr>
<tr>
<td>Author:</td>
<td>Aimee Lee Houde [aut, cre], Trevor Pitcher [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Aimee Lee Houde &lt;aimee.lee.houde@gmail.com&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6)</td>
</tr>
<tr>
<td>Imports:</td>
<td>lme4, afex</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>Description:</td>
<td>We facilitate the analysis of full factorial mating designs with mixed-effects models. The package contains six vignettes containing detailed examples.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-04 23:49:47 UTC; Aimee Lee</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-05 00:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='barMANA'>Bargraph of confidence intervals</h2><span id='topic+barMANA'></span>

<h3>Description</h3>

<p>A simple bargraph function for confidence intervals of additive genetic, non-additive
genetic, and maternal variance components. Also, plots the median for the bootstrap
resampling method or mean of the pseudo-values for the jackknife resampling method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>barMANA(ci_dat, type = "perc", bar_len = 0.1, ymax = NULL, ymin = NULL, yunit = NULL,
leg = "topright", cex_ylab = 1, cex_yaxis = 1, cex_names = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="barMANA_+3A_ci_dat">ci_dat</code></td>
<td>
<p>Data frame of a confidence interval function.</p>
</td></tr>
<tr><td><code id="barMANA_+3A_type">type</code></td>
<td>

<p>Default is &quot;perc&quot; for percentage values of variance components. Other option is &quot;raw&quot;
for raw values of variance components.
</p>
</td></tr>
<tr><td><code id="barMANA_+3A_bar_len">bar_len</code></td>
<td>
<p>Length of error bar in inches.</p>
</td></tr>
<tr><td><code id="barMANA_+3A_ymax">ymax</code></td>
<td>
<p>Maximum value of the y-axis.</p>
</td></tr>
<tr><td><code id="barMANA_+3A_ymin">ymin</code></td>
<td>
<p>Minimum value of the y-axis.</p>
</td></tr>
<tr><td><code id="barMANA_+3A_yunit">yunit</code></td>
<td>
<p>Unit increment of the y-axis.</p>
</td></tr>
<tr><td><code id="barMANA_+3A_leg">leg</code></td>
<td>
<p>Position of the simple legend.</p>
</td></tr>
<tr><td><code id="barMANA_+3A_cex_ylab">cex_ylab</code></td>
<td>
<p>Magnification of the y-axis label.</p>
</td></tr>
<tr><td><code id="barMANA_+3A_cex_yaxis">cex_yaxis</code></td>
<td>
<p>Magnification of the y-axis units.</p>
</td></tr>
<tr><td><code id="barMANA_+3A_cex_names">cex_names</code></td>
<td>
<p>Optional magnification of trait labels.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Plots a bargraph with the median or mean as the top of the shaded bar and error bars covering the
range of the confidence interval. Uses an object produced by any of the bootstrap resampling CI
functions, i.e. <em>ciMANA</em>, <em>ciMANA2</em>, and <em>ciMANA3</em> or jackknife resampling functions,
i.e. <em>ciJack</em>, <em>ciJack2</em>, and <em>ciJack3</em>. The median is plotted for bootstrap
resampling and the mean of pseudo-value for jackknife resampling. Produces a simple legend.
The function can plot several bar graphs grouped by <em>label</em> to visualize several
phenotypic traits.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
##Import jackknife resampling results
data(chinook_jackL) #Chinook salmon length
length_ci&lt;- ciJack(comp=chinook_jackL,full=c(0,0.7192,0.2030,1.0404))
barMANA(ci_dat=length_ci)  #default plot
barMANA(ci_dat=length_ci,bar_len=0.3,yunit=20,ymax=100,cex_ylab=1.3) 

##Group length and survival together in the same plot
data(chinook_bootS) #Chinook salmon survival (bootstrap resampling)
length_ci&lt;- ciJack(comp=chinook_jackL,full=c(0,0.7192,0.2030,1.0404),trait="length")
survival_ci&lt;- ciMANA(comp=chinook_bootS,trait="survival")
colnames(length_ci$raw)[3]&lt;- "median"; colnames(length_ci$percentage)[3]&lt;- "median"
comb_bar&lt;- list(raw=rbind(length_ci$raw,survival_ci$raw),
percentage=rbind(length_ci$percentage,survival_ci$percentage))
#
barMANA(ci_dat=comb_bar) #default plot
barMANA(ci_dat=comb_bar,bar_len=0.3,yunit=20,ymax=100,cex_ylab=1.3)
</code></pre>

<hr>
<h2 id='boxMANA'>Boxplot of resampled results</h2><span id='topic+boxMANA'></span>

<h3>Description</h3>

<p>A simple boxplot function for bootstrap and jackknife resampled results of additive
genetic, non-additive genetic, and maternal variance components.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>boxMANA(comp, type = "perc", ymax = NULL, ymin = NULL, yunit = NULL, leg = "topright",
cex_ylab = 1, cex_yaxis = 1, cex_names = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="boxMANA_+3A_comp">comp</code></td>
<td>
<p>Data frame of bootstrap or jackknife resampling results.</p>
</td></tr>
<tr><td><code id="boxMANA_+3A_type">type</code></td>
<td>

<p>Default is &quot;perc&quot; for percentage values of variance components. Other option is &quot;raw&quot;
for raw values of variance components.
</p>
</td></tr>
<tr><td><code id="boxMANA_+3A_ymax">ymax</code></td>
<td>
<p>Maximum value of the y-axis.</p>
</td></tr>
<tr><td><code id="boxMANA_+3A_ymin">ymin</code></td>
<td>
<p>Minimum value of the y-axis.</p>
</td></tr>
<tr><td><code id="boxMANA_+3A_yunit">yunit</code></td>
<td>
<p>Unit increment of the y-axis.</p>
</td></tr>
<tr><td><code id="boxMANA_+3A_leg">leg</code></td>
<td>
<p>Position of the simple legend.</p>
</td></tr>
<tr><td><code id="boxMANA_+3A_cex_ylab">cex_ylab</code></td>
<td>
<p>Magnification of the y-axis label.</p>
</td></tr>
<tr><td><code id="boxMANA_+3A_cex_yaxis">cex_yaxis</code></td>
<td>
<p>Magnification of the y-axis units.</p>
</td></tr>
<tr><td><code id="boxMANA_+3A_cex_names">cex_names</code></td>
<td>
<p>Optional magnification of trait labels.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Plots an R boxplot. Uses an object produced by any of the bootstrap resampling
functions, i.e. <em>resampLmer</em>, <em>resampLmer2</em>, <em>resampLmer3</em>,
<em>resampGlmer</em>, <em>resampGlmer2</em>, and <em>resampGlmer3</em>. Or any of the
jackknife resampling functions, i.e. <em>JackLmer</em>, <em>JackLmer2</em>,
<em>JackLmer3</em>, <em>JackGlmer</em>, <em>JackGlmer2</em>, and <em>JackGlmer3</em>.
Produces a simple legend.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
##Import bootstrap resampled data model results
data(chinook_bootL) #Chinook salmon length
boxMANA(comp=chinook_bootL) #Default plot
boxMANA(comp=chinook_bootL,yunit=20,ymax=100,cex_ylab=1.3,leg="topleft")

##Group length and survival together in the same plot
data(chinook_bootS) #Chinook salmon survival
chinook_bootL$trait&lt;- "length"; chinook_bootS$trait&lt;- "survival"
comb_boot&lt;- rbind(chinook_bootL[,-2],chinook_bootS) #remove 'tray'
comb_boot$trait&lt;- as.factor(comb_boot$trait)
#
boxMANA(comp=comb_boot) #Default plot
boxMANA(comp=comb_boot,yunit=20,ymax=100,cex_ylab=1.3)
</code></pre>

<hr>
<h2 id='buildBinary'>Convert to a binary data frame</h2><span id='topic+buildBinary'></span>

<h3>Description</h3>

<p>Assign a binary number (i.e. '0' or '1') to two columns containing the number of offspring.
Copy information by the number of times equal to the number of offspring.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>buildBinary(dat, copy, one, zero)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="buildBinary_+3A_dat">dat</code></td>
<td>
<p>Data frame to convert.</p>
</td></tr>
<tr><td><code id="buildBinary_+3A_copy">copy</code></td>
<td>
<p>Column numbers to copy.</p>
</td></tr>
<tr><td><code id="buildBinary_+3A_one">one</code></td>
<td>
<p>Column name of counts to assign a '1' value.</p>
</td></tr>
<tr><td><code id="buildBinary_+3A_zero">zero</code></td>
<td>
<p>Column name of counts to assign a '0' value.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Replicate-level data should be converted to the individual-level to not underestimate phenotypic variance,
which can influence genetic and maternal estimates (see Puurtinen et al. 2009).
</p>


<h3>Value</h3>

<p>A converted data frame with a number of row matching the total number of individuals.
</p>


<h3>References</h3>

<p>Puurtinen M, Ketola T, Kotiaho JS. 2009. The good-genes and compatible-genes benefits of mate choice.
The American Naturalist 174(5): 741-752. DOI: 10.1086/606024
</p>


<h3>See Also</h3>

<p><code><a href="#topic+buildMulti">buildMulti</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(chinook_survival)
chinook_survival2&lt;- buildBinary(dat=chinook_survival,copy=c(1:6,9),one="alive",zero="dead")
</code></pre>

<hr>
<h2 id='buildMulti'>Convert to a multinomial frame</h2><span id='topic+buildMulti'></span>

<h3>Description</h3>

<p>Assign multiple numbers to multiple columns containing the number of offspring.
Copy information by the number of times equal to the number of offspring.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>buildMulti(dat, copy, multi)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="buildMulti_+3A_dat">dat</code></td>
<td>
<p>Data frame to convert.</p>
</td></tr>
<tr><td><code id="buildMulti_+3A_copy">copy</code></td>
<td>
<p>Column numbers to copy.</p>
</td></tr>
<tr><td><code id="buildMulti_+3A_multi">multi</code></td>
<td>
<p>A list containing the numbers to assign and matching column names,
e.g. list(c(2,0,1),c(&quot;two&quot;,&quot;zero&quot;,&quot;one&quot;)).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Replicate-level data should be converted to the individual-level to not underestimate phenotypic variance,
which can influence genetic and maternal estimates (see Puurtinen et al. 2009).
</p>


<h3>Value</h3>

<p>A converted data frame with a number of row matching the total number of individuals.
</p>


<h3>References</h3>

<p>Puurtinen M, Ketola T, Kotiaho JS. 2009. The good-genes and compatible-genes benefits of mate choice.
The American Naturalist 174(5): 741-752. DOI: 10.1086/606024
</p>


<h3>See Also</h3>

<p><code><a href="#topic+buildBinary">buildBinary</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(chinook_survival)
chinook_survival$total&lt;- chinook_survival$alive + chinook_survival$dead #create total column
chinook_survival3&lt;- buildMulti(dat=chinook_survival,copy=c(1:6,9),multi=list(c(2,1,0),
c("total","alive","dead")))
</code></pre>

<hr>
<h2 id='chinook_bootL'>Chinook salmon length, bootstrap calculations</h2><span id='topic+chinook_bootL'></span>

<h3>Description</h3>

<p>Bootstrap resampled Chinook salmon fork length (mm) at hatch with the amount of
additive genetic, non-additive genetic, and maternal variance calculations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("chinook_bootL")</code></pre>


<h3>Format</h3>

<p>A data frame with 1000 observations on the following 9 variables.
</p>

<dl>
<dt><code>dam.sire</code>,</dt><dd><p>a numeric vector.</p>
</dd>
<dt><code>tray</code>,</dt><dd><p>a numeric vector.</p>
</dd>
<dt><code>sire</code>,</dt><dd><p>a numeric vector.</p>
</dd>
<dt><code>dam</code>,</dt><dd><p>a numeric vector.</p>
</dd>
<dt><code>Residual</code>,</dt><dd><p>a numeric vector.</p>
</dd>
<dt><code>Total</code>,</dt><dd><p>a numeric vector.</p>
</dd>
<dt><code>additive</code>,</dt><dd><p>a numeric vector.</p>
</dd>
<dt><code>maternal</code>,</dt><dd><p>a numeric vector.</p>
</dd>
<dt><code>nonadd</code>,</dt><dd><p>a numeric vector.</p>
</dd>
</dl>



<h3>Details</h3>

<p>Also includes the calculations for the amount of variance explained by position (tray), dam by sire,
sire, dam, residual,and total.
</p>


<h3>Source</h3>

<p>http://link.springer.com.proxy1.lib.uwo.ca/article/10.1007
</p>


<h3>References</h3>

<p>Pitcher TE, Neff BD. 2007. Genetic quality and offspring performance in Chinook salmon:
implications for supportive breeding. Conservation Genetics 8(3):607-616.
DOI: 10.1007/s10592-006-9204-z
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(chinook_bootL)
## Extract bootstrap confidence interval
ciMANA(comp=chinook_bootL)
</code></pre>

<hr>
<h2 id='chinook_bootS'>Chinook salmon survival, bootstrap data</h2><span id='topic+chinook_bootS'></span>

<h3>Description</h3>

<p>Bootstrap resampled Chinook salmon binary survival to hatch (1 is alive, 0 is dead)
with the amount of additive genetic, non-additive genetic, and maternal variance calculations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("chinook_bootS")</code></pre>


<h3>Format</h3>

<p>A data frame with 1000 observations on the following 8 variables.
</p>

<dl>
<dt><code>dam.sire</code>,</dt><dd><p>a numeric vector.</p>
</dd>
<dt><code>sire</code>,</dt><dd><p>a numeric vector.</p>
</dd>
<dt><code>dam</code>,</dt><dd><p>a numeric vector.</p>
</dd>
<dt><code>Residual</code>,</dt><dd><p>a numeric vector.</p>
</dd>
<dt><code>Total</code>,</dt><dd><p>a numeric vector.</p>
</dd>
<dt><code>additive</code>,</dt><dd><p>a numeric vector.</p>
</dd>
<dt><code>maternal</code>,</dt><dd><p>a numeric vector.</p>
</dd>
<dt><code>nonadd</code>,</dt><dd><p>a numeric vector.</p>
</dd>
</dl>



<h3>Details</h3>

<p>Also includes the calculations for the amount of variance explained by dam by sire, sire, dam,
residual, and total.
</p>


<h3>Source</h3>

<p>http://link.springer.com.proxy1.lib.uwo.ca/article/10.1007
</p>


<h3>References</h3>

<p>Pitcher TE, Neff BD. 2007. Genetic quality and offspring performance in Chinook salmon:
implications for supportive breeding. Conservation Genetics 8(3):607-616.
DOI: 10.1007/s10592-006-9204-z
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(chinook_bootS)
## Extract bootstrap confidence interval
ciMANA(comp=chinook_bootS)
</code></pre>

<hr>
<h2 id='chinook_jackL'>Chinook salmon length, jackknife data</h2><span id='topic+chinook_jackL'></span>

<h3>Description</h3>

<p>Jackknife resampled Chinook salmon fork length (mm) at hatch with the amount of additive genetic,
non-additive genetic, and maternal variance calculations. Jackknife resampling was leave-out-one.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("chinook_jackL")</code></pre>


<h3>Format</h3>

<p>A data frame with 1210 observations on the following 9 variables.
</p>

<dl>
<dt><code>dam.sire</code>,</dt><dd><p>a numeric vector.</p>
</dd>
<dt><code>tray</code>,</dt><dd><p>a numeric vector.</p>
</dd>
<dt><code>sire</code>,</dt><dd><p>a numeric vector.</p>
</dd>
<dt><code>dam</code>,</dt><dd><p>a numeric vector.</p>
</dd>
<dt><code>Residual</code>,</dt><dd><p>a numeric vector.</p>
</dd>
<dt><code>Total</code>,</dt><dd><p>a numeric vector.</p>
</dd>
<dt><code>additive</code>,</dt><dd><p>a numeric vector.</p>
</dd>
<dt><code>nonadd</code>,</dt><dd><p>a numeric vector.</p>
</dd>
<dt><code>maternal</code>,</dt><dd><p>a numeric vector.</p>
</dd>
</dl>



<h3>Details</h3>

<p>Also includes the calculations for the amount of variance explained by position (tray), dam by sire,
sire, dam, residual, and total.
</p>


<h3>Source</h3>

<p>http://link.springer.com.proxy1.lib.uwo.ca/article/10.1007
</p>


<h3>References</h3>

<p>Pitcher TE, Neff BD. 2007. Genetic quality and offspring performance in Chinook salmon:
implications for supportive breeding. Conservation Genetics 8(3):607-616.
DOI: 10.1007/s10592-006-9204-z
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(chinook_jackL)
## Extract jackknifed confidence interval
ciJack(comp=chinook_jackL,full=c(0,0.7192,0.2030,1.0404))
</code></pre>

<hr>
<h2 id='chinook_jackS'>Chinook salmon survival, jackknife data</h2><span id='topic+chinook_jackS'></span>

<h3>Description</h3>

<p>Jackknife resampled Chinook salmon survival with the amount of additive genetic,
non-additive genetic, and maternal variance calculations. Jackknife resampling was leave-out-30.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("chinook_jackS")</code></pre>


<h3>Format</h3>

<p>A data frame with 1210 observations on the following 9 variables.
</p>

<dl>
<dt><code>dam.sire</code>,</dt><dd><p>a numeric vector.</p>
</dd>
<dt><code>sire</code>,</dt><dd><p>a numeric vector.</p>
</dd>
<dt><code>dam</code>,</dt><dd><p>a numeric vector.</p>
</dd>
<dt><code>Residual</code>,</dt><dd><p>a numeric vector.</p>
</dd>
<dt><code>Total</code>,</dt><dd><p>a numeric vector.</p>
</dd>
<dt><code>additive</code>,</dt><dd><p>a numeric vector.</p>
</dd>
<dt><code>nonadd</code>,</dt><dd><p>a numeric vector.</p>
</dd>
<dt><code>maternal</code>,</dt><dd><p>a numeric vector.</p>
</dd>
</dl>



<h3>Details</h3>

<p>Also includes the calculations for the amount of variance explained by dam by sire,
sire, dam, residual, and total.
</p>


<h3>Source</h3>

<p>http://link.springer.com.proxy1.lib.uwo.ca/article/10.1007
</p>


<h3>References</h3>

<p>Pitcher TE, Neff BD. 2007. Genetic quality and offspring performance in Chinook salmon:
implications for supportive breeding. Conservation Genetics 8(3):607-616.
DOI: 10.1007/s10592-006-9204-z
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(chinook_jackS)
## Extract jackknifed confidence interval
ciJack(comp=chinook_jackS,full=c(0.6655,0.6692,0.6266,4.4166))
</code></pre>

<hr>
<h2 id='chinook_length'>Chinook salmon length, raw data</h2><span id='topic+chinook_length'></span>

<h3>Description</h3>

<p>Raw Chinook salmon fork length (mm) at hatch for offspring produced using an 11 x 11 full
factorial breeding design.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("chinook_length")</code></pre>


<h3>Format</h3>

<p>A data frame with 1210 observations on the following 8 variables.
</p>

<dl>
<dt><code>family</code>,</dt><dd><p>a factor with levels: <code>f1</code> <code>f10</code> <code>f100</code> <code>f101</code> <code>f102</code> <code>f103</code> <code>f104</code> <code>f105</code> <code>f106</code> <code>f107</code> <code>f108</code> <code>f109</code> <code>f11</code> <code>f110</code> <code>f111</code> <code>f112</code> <code>f113</code> <code>f114</code> <code>f115</code> <code>f116</code> <code>f117</code> <code>f118</code> <code>f119</code> <code>f12</code> <code>f120</code> <code>f121</code> <code>f13</code> <code>f14</code> <code>f15</code> <code>f16</code> <code>f17</code> <code>f18</code> <code>f19</code> <code>f2</code> <code>f20</code> <code>f21</code> <code>f22</code> <code>f23</code> <code>f24</code> <code>f25</code> <code>f26</code> <code>f27</code> <code>f28</code> <code>f29</code> <code>f3</code> <code>f30</code> <code>f31</code> <code>f32</code> <code>f33</code> <code>f34</code> <code>f35</code> <code>f36</code> <code>f37</code> <code>f38</code> <code>f39</code> <code>f4</code> <code>f40</code> <code>f41</code> <code>f42</code> <code>f43</code> <code>f44</code> <code>f45</code> <code>f46</code> <code>f47</code> <code>f48</code> <code>f49</code> <code>f5</code> <code>f50</code> <code>f51</code> <code>f52</code> <code>f53</code> <code>f54</code> <code>f55</code> <code>f56</code> <code>f57</code> <code>f58</code> <code>f59</code> <code>f6</code> <code>f60</code> <code>f61</code> <code>f62</code> <code>f63</code> <code>f64</code> <code>f65</code> <code>f66</code> <code>f67</code> <code>f68</code> <code>f69</code> <code>f7</code> <code>f70</code> <code>f71</code> <code>f72</code> <code>f73</code> <code>f74</code> <code>f75</code> <code>f76</code> <code>f77</code> <code>f78</code> <code>f79</code> <code>f8</code> <code>f80</code> <code>f81</code> <code>f82</code> <code>f83</code> <code>f84</code> <code>f85</code> <code>f86</code> <code>f87</code> <code>f88</code> <code>f89</code> <code>f9</code> <code>f90</code> <code>f91</code> <code>f92</code> <code>f93</code> <code>f94</code> <code>f95</code> <code>f96</code> <code>f97</code> <code>f98</code> <code>f99</code></p>
</dd>
<dt><code>repli</code>,</dt><dd><p>a factor with levels: <code>r1</code> <code>r2</code></p>
</dd>
<dt><code>dam</code>,</dt><dd><p>a factor with levels: <code>d1</code> <code>d10</code> <code>d11</code> <code>d2</code> <code>d3</code> <code>d4</code> <code>d5</code> <code>d6</code> <code>d7</code> <code>d8</code> <code>d9</code></p>
</dd>
<dt><code>sire</code>,</dt><dd><p>a factor with levels: <code>s1</code> <code>s10</code> <code>s11</code> <code>s2</code> <code>s3</code> <code>s4</code> <code>s5</code> <code>s6</code> <code>s7</code> <code>s8</code> <code>s9</code></p>
</dd>
<dt><code>tray</code>,</dt><dd><p>a factor with levels: <code>t1</code> <code>t10</code> <code>t11</code> <code>t12</code> <code>t13</code> <code>t14</code> <code>t15</code> <code>t16</code> <code>t2</code> <code>t3</code> <code>t4</code> <code>t5</code> <code>t6</code> <code>t7</code> <code>t8</code> <code>t9</code></p>
</dd>
<dt><code>cell</code>,</dt><dd><p>a factor with levels: <code>1A</code> <code>1B</code> <code>1C</code> <code>1D</code> <code>2A</code> <code>2B</code> <code>2C</code> <code>2D</code> <code>3A</code> <code>3B</code> <code>3C</code> <code>3D</code> <code>4A</code> <code>4B</code> <code>4C</code> <code>4D</code></p>
</dd>
<dt><code>length</code>,</dt><dd><p>a numeric vector.</p>
</dd>
<dt><code>egg_size</code>,</dt><dd><p>a numeric vector.</p>
</dd>
</dl>



<h3>Details</h3>

<p>Also includes family identity, family replicate, incubator position (tray and cell),
and average female egg size (mm) information.
</p>


<h3>Source</h3>

<p>http://link.springer.com.proxy1.lib.uwo.ca/article/10.1007
</p>


<h3>References</h3>

<p>Pitcher TE, Neff BD. 2007. Genetic quality and offspring performance in Chinook salmon:
implications for supportive breeding. Conservation Genetics 8(3):607-616.
DOI: 10.1007/s10592-006-9204-z
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(chinook_length)
## Standard additive genetic, non-additive genetic, and maternal variance analysis
length_mod1&lt;- observLmer(observ=chinook_length,dam="dam",sire="sire",response="length")
length_mod1
</code></pre>

<hr>
<h2 id='chinook_resampL'>Chinook salmon length, bootstrap resampled</h2><span id='topic+chinook_resampL'></span>

<h3>Description</h3>

<p>Bootstrap resampled Chinook salmon fork length (mm) at hatch. Number of iterations was 5.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("chinook_resampL")</code></pre>


<h3>Format</h3>

<p>A data frame with 1210 observations on the following 30 variables.
</p>

<dl>
<dt><code>dam1</code>,</dt><dd><p>a numeric vector</p>
</dd>
<dt><code>sire1</code>,</dt><dd><p>a numeric vector</p>
</dd>
<dt><code>tray1</code>,</dt><dd><p>a numeric vector</p>
</dd>
<dt><code>cell1</code>,</dt><dd><p>a numeric vector</p>
</dd>
<dt><code>length1</code>,</dt><dd><p>a numeric vector</p>
</dd>
<dt><code>egg_size1</code>,</dt><dd><p>a numeric vector</p>
</dd>
<dt><code>dam2</code>,</dt><dd><p>a numeric vector</p>
</dd>
<dt><code>sire2</code>,</dt><dd><p>a numeric vector</p>
</dd>
<dt><code>tray2</code>,</dt><dd><p>a numeric vector</p>
</dd>
<dt><code>cell2</code>,</dt><dd><p>a numeric vector</p>
</dd>
<dt><code>length2</code>,</dt><dd><p>a numeric vector</p>
</dd>
<dt><code>egg_size2</code>,</dt><dd><p>a numeric vector</p>
</dd>
<dt><code>dam3</code>,</dt><dd><p>a numeric vector</p>
</dd>
<dt><code>sire3</code>,</dt><dd><p>a numeric vector</p>
</dd>
<dt><code>tray3</code>,</dt><dd><p>a numeric vector</p>
</dd>
<dt><code>cell3</code>,</dt><dd><p>a numeric vector</p>
</dd>
<dt><code>length3</code>,</dt><dd><p>a numeric vector</p>
</dd>
<dt><code>egg_size3</code>,</dt><dd><p>a numeric vector</p>
</dd>
<dt><code>dam4</code>,</dt><dd><p>a numeric vector</p>
</dd>
<dt><code>sire4</code>,</dt><dd><p>a numeric vector</p>
</dd>
<dt><code>tray4</code>,</dt><dd><p>a numeric vector</p>
</dd>
<dt><code>cell4</code>,</dt><dd><p>a numeric vector</p>
</dd>
<dt><code>length4</code>,</dt><dd><p>a numeric vector</p>
</dd>
<dt><code>egg_size4</code>,</dt><dd><p>a numeric vector</p>
</dd>
<dt><code>dam5</code>,</dt><dd><p>a numeric vector</p>
</dd>
<dt><code>sire5</code>,</dt><dd><p>a numeric vector</p>
</dd>
<dt><code>tray5</code>,</dt><dd><p>a numeric vector</p>
</dd>
<dt><code>cell5</code>,</dt><dd><p>a numeric vector</p>
</dd>
<dt><code>length5</code>,</dt><dd><p>a numeric vector</p>
</dd>
<dt><code>egg_size5</code>,</dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>Source</h3>

<p>Pitcher TE, Neff BD. 2007. Genetic quality and offspring performance in Chinook salmon:
implications for supportive breeding. Conservation Genetics 8(3):607-616.
DOI: 10.1007/s10592-006-9204-z
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(chinook_resampL)
#the five models
length_rcomp1&lt;- resampLmer(resamp=chinook_resampL,dam="dam",sire="sire",response="length",
start=1,end=5)  #full analysis should use 1,000 models
</code></pre>

<hr>
<h2 id='chinook_resampS'>Chinook salmon survival, bootstrap resampled</h2><span id='topic+chinook_resampS'></span>

<h3>Description</h3>

<p>Bootstrap resampled Chinook salmon binary survival to hatch (1 is alive, 0 is dead).
Number of iterations was 5.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("chinook_resampS")</code></pre>


<h3>Format</h3>

<p>A data frame with 36300 observations on the following 30 variables.
</p>

<dl>
<dt><code>status1</code>,</dt><dd><p>a numeric vector</p>
</dd>
<dt><code>dam1</code>,</dt><dd><p>a numeric vector</p>
</dd>
<dt><code>sire1</code>,</dt><dd><p>a numeric vector</p>
</dd>
<dt><code>tray1</code>,</dt><dd><p>a numeric vector</p>
</dd>
<dt><code>cell1</code>,</dt><dd><p>a numeric vector</p>
</dd>
<dt><code>egg_size1</code>,</dt><dd><p>a numeric vector</p>
</dd>
<dt><code>status2</code>,</dt><dd><p>a numeric vector</p>
</dd>
<dt><code>dam2</code>,</dt><dd><p>a numeric vector</p>
</dd>
<dt><code>sire2</code>,</dt><dd><p>a numeric vector</p>
</dd>
<dt><code>tray2</code>,</dt><dd><p>a numeric vector</p>
</dd>
<dt><code>cell2</code>,</dt><dd><p>a numeric vector</p>
</dd>
<dt><code>egg_size2</code>,</dt><dd><p>a numeric vector</p>
</dd>
<dt><code>status3</code>,</dt><dd><p>a numeric vector</p>
</dd>
<dt><code>dam3</code>,</dt><dd><p>a numeric vector</p>
</dd>
<dt><code>sire3</code>,</dt><dd><p>a numeric vector</p>
</dd>
<dt><code>tray3</code>,</dt><dd><p>a numeric vector</p>
</dd>
<dt><code>cell3</code>,</dt><dd><p>a numeric vector</p>
</dd>
<dt><code>egg_size3</code>,</dt><dd><p>a numeric vector</p>
</dd>
<dt><code>status4</code>,</dt><dd><p>a numeric vector</p>
</dd>
<dt><code>dam4</code>,</dt><dd><p>a numeric vector</p>
</dd>
<dt><code>sire4</code>,</dt><dd><p>a numeric vector</p>
</dd>
<dt><code>tray4</code>,</dt><dd><p>a numeric vector</p>
</dd>
<dt><code>cell4</code>,</dt><dd><p>a numeric vector</p>
</dd>
<dt><code>egg_size4</code>,</dt><dd><p>a numeric vector</p>
</dd>
<dt><code>status5</code>,</dt><dd><p>a numeric vector</p>
</dd>
<dt><code>dam5</code>,</dt><dd><p>a numeric vector</p>
</dd>
<dt><code>sire5</code>,</dt><dd><p>a numeric vector</p>
</dd>
<dt><code>tray5</code>,</dt><dd><p>a numeric vector</p>
</dd>
<dt><code>cell5</code>,</dt><dd><p>a numeric vector</p>
</dd>
<dt><code>egg_size5</code>,</dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>Source</h3>

<p>Pitcher TE, Neff BD. 2007. Genetic quality and offspring performance in Chinook salmon:
implications for supportive breeding. Conservation Genetics 8(3):607-616.
DOI: 10.1007/s10592-006-9204-z
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(chinook_resampS)
## Not run: survival_rcomp&lt;- resampGlmer(resamp=chinook_resampS,dam="dam",sire="sire",
response="status",fam_link=binomial(link="logit"),start=1,end=1000)
## End(Not run)
</code></pre>

<hr>
<h2 id='chinook_survival'>Chinook salmon survival, raw data</h2><span id='topic+chinook_survival'></span>

<h3>Description</h3>

<p>Raw Chinook salmon numbers alive and dead to hatching of offspring produced using
an 11 x 11 full factorial breeding design.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("chinook_survival")</code></pre>


<h3>Format</h3>

<p>A data frame with 242 observations on the following 9 variables.
</p>

<dl>
<dt><code>family</code>,</dt><dd><p>a factor with levels: <code>f1</code> <code>f10</code> <code>f100</code> <code>f101</code> <code>f102</code> <code>f103</code> <code>f104</code> <code>f105</code> <code>f106</code> <code>f107</code> <code>f108</code> <code>f109</code> <code>f11</code> <code>f110</code> <code>f111</code> <code>f112</code> <code>f113</code> <code>f114</code> <code>f115</code> <code>f116</code> <code>f117</code> <code>f118</code> <code>f119</code> <code>f12</code> <code>f120</code> <code>f121</code> <code>f13</code> <code>f14</code> <code>f15</code> <code>f16</code> <code>f17</code> <code>f18</code> <code>f19</code> <code>f2</code> <code>f20</code> <code>f21</code> <code>f22</code> <code>f23</code> <code>f24</code> <code>f25</code> <code>f26</code> <code>f27</code> <code>f28</code> <code>f29</code> <code>f3</code> <code>f30</code> <code>f31</code> <code>f32</code> <code>f33</code> <code>f34</code> <code>f35</code> <code>f36</code> <code>f37</code> <code>f38</code> <code>f39</code> <code>f4</code> <code>f40</code> <code>f41</code> <code>f42</code> <code>f43</code> <code>f44</code> <code>f45</code> <code>f46</code> <code>f47</code> <code>f48</code> <code>f49</code> <code>f5</code> <code>f50</code> <code>f51</code> <code>f52</code> <code>f53</code> <code>f54</code> <code>f55</code> <code>f56</code> <code>f57</code> <code>f58</code> <code>f59</code> <code>f6</code> <code>f60</code> <code>f61</code> <code>f62</code> <code>f63</code> <code>f64</code> <code>f65</code> <code>f66</code> <code>f67</code> <code>f68</code> <code>f69</code> <code>f7</code> <code>f70</code> <code>f71</code> <code>f72</code> <code>f73</code> <code>f74</code> <code>f75</code> <code>f76</code> <code>f77</code> <code>f78</code> <code>f79</code> <code>f8</code> <code>f80</code> <code>f81</code> <code>f82</code> <code>f83</code> <code>f84</code> <code>f85</code> <code>f86</code> <code>f87</code> <code>f88</code> <code>f89</code> <code>f9</code> <code>f90</code> <code>f91</code> <code>f92</code> <code>f93</code> <code>f94</code> <code>f95</code> <code>f96</code> <code>f97</code> <code>f98</code> <code>f99</code></p>
</dd>
<dt><code>repli</code>,</dt><dd><p>a factor with levels: <code>r1</code> <code>r2</code></p>
</dd>
<dt><code>dam</code>,</dt><dd><p>a factor with levels: <code>d1</code> <code>d10</code> <code>d11</code> <code>d2</code> <code>d3</code> <code>d4</code> <code>d5</code> <code>d6</code> <code>d7</code> <code>d8</code> <code>d9</code></p>
</dd>
<dt><code>sire</code>,</dt><dd><p>a factor with levels: <code>s1</code> <code>s10</code> <code>s11</code> <code>s2</code> <code>s3</code> <code>s4</code> <code>s5</code> <code>s6</code> <code>s7</code> <code>s8</code> <code>s9</code></p>
</dd>
<dt><code>tray</code>,</dt><dd><p>a factor with levels: <code>t1</code> <code>t10</code> <code>t11</code> <code>t12</code> <code>t13</code> <code>t14</code> <code>t15</code> <code>t16</code> <code>t2</code> <code>t3</code> <code>t4</code> <code>t5</code> <code>t6</code> <code>t7</code> <code>t8</code> <code>t9</code></p>
</dd>
<dt><code>cell</code>,</dt><dd><p>a factor with levels: <code>1A</code> <code>1B</code> <code>1C</code> <code>1D</code> <code>2A</code> <code>2B</code> <code>2C</code> <code>2D</code> <code>3A</code> <code>3B</code> <code>3C</code> <code>3D</code> <code>4A</code> <code>4B</code> <code>4C</code> <code>4D</code></p>
</dd>
<dt><code>alive</code>,</dt><dd><p>a numeric vector.</p>
</dd>
<dt><code>dead</code>,</dt><dd><p>a numeric vector.</p>
</dd>
<dt><code>egg_size</code>,</dt><dd><p>a numeric vector.</p>
</dd>
</dl>



<h3>Details</h3>

<p>Also includes family identity, family replicate, incubator position (tray and cell),
and average female egg size (mm) information.
</p>


<h3>Source</h3>

<p>http://link.springer.com.proxy1.lib.uwo.ca/article/10.1007
</p>


<h3>References</h3>

<p>Pitcher TE, Neff BD. 2007. Genetic quality and offspring performance in Chinook salmon:
implications for supportive breeding. Conservation Genetics 8(3):607-616.
DOI: 10.1007/s10592-006-9204-z
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(chinook_survival)
## Convert replicate-level recorded data to individual-level (binary) data
chinook_survival2&lt;- buildBinary(dat=chinook_survival,copy=c(2:6,9),one="alive",zero="dead")

## Standard additive genetic, non-additive genetic, and maternal variance analysis
## Not run: survival_mod1&lt;- observGlmer(observ=chinook_survival2,dam="dam",sire="sire",
response="status",fam_link=binomial(link="logit"))
survival_mod1
## End(Not run)
</code></pre>

<hr>
<h2 id='ciJack'>Jackknife confidence intervals</h2><span id='topic+ciJack'></span>

<h3>Description</h3>

<p>Extracts jackknife confidence intervals for additive genetic, non-additive genetic, and maternal
variance components.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ciJack(comp, full, level = 95, rnd_r = 3, rnd_p = 1, trait = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ciJack_+3A_comp">comp</code></td>
<td>
<p>Data frame of jackknife resampling results.</p>
</td></tr>
<tr><td><code id="ciJack_+3A_full">full</code></td>
<td>

<p>A vector of raw observed additive, non-additive, maternal, and total variance component values
for from the full observed data set, i.e. c(additive, non-additive, maternal, total).
</p>
</td></tr>
<tr><td><code id="ciJack_+3A_level">level</code></td>
<td>
<p>Confidence level, as a percentage. Default is 95.</p>
</td></tr>
<tr><td><code id="ciJack_+3A_rnd_r">rnd_r</code></td>
<td>
<p>Number of decimal places to round the confidence interval of raw values.</p>
</td></tr>
<tr><td><code id="ciJack_+3A_rnd_p">rnd_p</code></td>
<td>
<p>Number of decimal places to round the confidence interval of percentage values.</p>
</td></tr>
<tr><td><code id="ciJack_+3A_trait">trait</code></td>
<td>
<p>Optional label for the phenotypic trait.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Used for jackknife resampling results produced using <em>JackLmer</em> for normal data or
<em>JackGlmer</em> for non-normal data.
Jackknife confidence intervals, using pseudo-values are described by Efron and Tibshirani (1993).
The standard errors are calculated from the pseudo-values and the Student's <em>t</em> distribution is used
to provide the lower and upper confidence values. For delete-<em>d</em> jackknife resampling,
<em>M</em> degrees of freedom are used for producing the confidence interval (Martin et al. 2004):
<em>M = N / d</em>, where <em>N</em> is the total number of observations and d is the number of
deleted observations. That is, <em>M</em> is the number of row in the jackknife resampling results.
Large values of <em>M</em>, such as 1,000, can translate to the delete-d jackknife resampling
method approaching bootstrap resampling expectations (Efron &amp; Tibshirani 1993).
</p>


<h3>Value</h3>

<p>Prints a data frame containing the lower, median, and upper values of the jackknife confidence
interval for additive genetic, non-additive genetic, and maternal variance components.
Values are presented as raw and percentages of the total variance value within each row.
</p>


<h3>References</h3>

<p>Efron B, Tibshirani R. 1993. An introduction to the Bootstrap. Chapman and Hall, New York.
</p>
<p>Martin, H., Westad, F. &amp; Martens, H. (2004). Imporved Jackknife Variance Estimates of Bilinear
Model Parameters. COMPSTAT 2004 &ndash; Proceedings in Computational Statistics 16th Symposium Held
in Prague, Czech Republic, 2004 (ed J. Antoch), pp. 261-275. Physica-Verlag HD, Heidelberg.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+ciJack2">ciJack2</a></code>, <code><a href="#topic+ciJack3">ciJack3</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(chinook_jackL) #Chinook salmon offspring length, delete-one jackknife
ciJack(chinook_jackL,c(0,0.7192,0.2030,1.0404))
</code></pre>

<hr>
<h2 id='ciJack2'>Jackknife confidence intervals 2</h2><span id='topic+ciJack2'></span>

<h3>Description</h3>

<p>Extracts jackknife confidence intervals for additive genetic, non-additive genetic, and maternal
variance components. Also extracts intervals for optional position and block variance components.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ciJack2(comp, full, level = 95, rnd_r = 3, rnd_p = 1, position = NULL, block = NULL,
trait = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ciJack2_+3A_comp">comp</code></td>
<td>
<p>Data frame of jackknife resampling results.</p>
</td></tr>
<tr><td><code id="ciJack2_+3A_full">full</code></td>
<td>

<p>A vector of raw observed additive, non-additive, maternal, and total variance component values
for from the full observed data set, i.e. c(additive, non-additive, maternal, total, position/block).
If there is a position and a block c(..., total, position, block).
</p>
</td></tr>
<tr><td><code id="ciJack2_+3A_level">level</code></td>
<td>
<p>Confidence level, as a percentage. Default is 95.</p>
</td></tr>
<tr><td><code id="ciJack2_+3A_rnd_r">rnd_r</code></td>
<td>
<p>Number of decimal places to round the confidence interval of raw values.</p>
</td></tr>
<tr><td><code id="ciJack2_+3A_rnd_p">rnd_p</code></td>
<td>
<p>Number of decimal places to round the confidence interval of percentage values.</p>
</td></tr>
<tr><td><code id="ciJack2_+3A_position">position</code></td>
<td>
<p>Optional column name containing position factor information.</p>
</td></tr>
<tr><td><code id="ciJack2_+3A_block">block</code></td>
<td>
<p>Optional column name containing block factor information.</p>
</td></tr>
<tr><td><code id="ciJack2_+3A_trait">trait</code></td>
<td>
<p>Optional label for the phenotypic trait.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Used for jackknife resampling results produced using <em>JackLmer2</em> for normal data or
<em>JackGlmer2</em> for non-normal data.
Jackknife confidence intervals, using pseudo-values are described by Efron and Tibshirani (1993).
The standard errors are calculated from the pseudo-values and the Student's <em>t</em> distribution is used
to provide the lower and upper confidence values. For delete-<em>d</em> jackknife resampling,
<em>M</em> degrees of freedom are used for producing the confidence interval (Martin et al. 2004):
<em>M = N / d</em>, where <em>N</em> is the total number of observations and d is the number of
deleted observations. That is, <em>M</em> is the number of row in the jackknife resampling results.
Large values of <em>M</em>, such as 1,000, can translate to the delete-d jackknife resampling
method approaching bootstrap resampling expectations (Efron &amp; Tibshirani 1993).
</p>


<h3>Value</h3>

<p>Prints a data frame containing the lower, median, and upper values of the jackknife confidence
interval for additive genetic, non-additive genetic, maternal variance components, and optional
position and/or block variance components. Values are presented as raw and percentages
of the total variance value within each row.
</p>


<h3>References</h3>

<p>Efron B, Tibshirani R. 1993. An introduction to the Bootstrap. Chapman and Hall, New York.
</p>
<p>Martin, H., Westad, F. &amp; Martens, H. (2004). Imporved Jackknife Variance Estimates of Bilinear
Model Parameters. COMPSTAT 2004 &ndash; Proceedings in Computational Statistics 16th Symposium Held
in Prague, Czech Republic, 2004 (ed J. Antoch), pp. 261-275. Physica-Verlag HD, Heidelberg.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+ciJack">ciJack</a></code>, <code><a href="#topic+ciJack3">ciJack3</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(chinook_jackL) #Chinook salmon offspring length, delete-one jackknife
ciJack2(chinook_jackL,position="tray",c(0,0.7192,0.2030,1.0404,0.1077))
</code></pre>

<hr>
<h2 id='ciJack3'>Jackknife confidence intervals 3</h2><span id='topic+ciJack3'></span>

<h3>Description</h3>

<p>Extracts jackknife confidence intervals for additive genetic, non-additive genetic, and maternal
variance components. Also extracts intervals for additional fixed and/or random effects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ciJack3(comp, full, remain = NULL, level = 95, rnd_r = 3, rnd_p = 1, trait = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ciJack3_+3A_comp">comp</code></td>
<td>
<p>Data frame of jackknife resampling results</p>
</td></tr>
<tr><td><code id="ciJack3_+3A_full">full</code></td>
<td>

<p>A vector of raw observed additive, non-additive, maternal, and total variance component values
for from the full observed data set, i.e. c(additive, non-additive, maternal, total). Followed by
any other components in the order of the vector <em>remain</em>,
i.e. c(additive, non-additive, maternal, total, component1, component2, etc.).
</p>
</td></tr>
<tr><td><code id="ciJack3_+3A_remain">remain</code></td>
<td>
<p>Vector of column names for additional effects</p>
</td></tr>
<tr><td><code id="ciJack3_+3A_level">level</code></td>
<td>
<p>Confidence level, as a percentage. Default is 95.</p>
</td></tr>
<tr><td><code id="ciJack3_+3A_rnd_r">rnd_r</code></td>
<td>
<p>Number of decimal places to round the confidence interval of raw values.</p>
</td></tr>
<tr><td><code id="ciJack3_+3A_rnd_p">rnd_p</code></td>
<td>
<p>Number of decimal places to round the confidence interval of percentage values.</p>
</td></tr>
<tr><td><code id="ciJack3_+3A_trait">trait</code></td>
<td>
<p>Optional label for the phenotypic trait.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Used for jackknife resampling results produced using <em>JackLmer3</em> for normal data or
<em>JackGlmer3</em> for non-normal data.
Jackknife confidence intervals, using pseudo-values are described by Efron and Tibshirani (1993).
The standard errors are calculated from the pseudo-values and the Student's <em>t</em> distribution is used
to provide the lower and upper confidence values. For delete-<em>d</em> jackknife resampling,
<em>M</em> degrees of freedom are used for producing the confidence interval (Martin et al. 2004):
<em>M = N / d</em>, where <em>N</em> is the total number of observations and d is the number of
deleted observations. That is, <em>M</em> is the number of row in the jackknife resampling results.
Large values of <em>M</em>, such as 1,000, can translate to the delete-d jackknife resampling
method approaching bootstrap resampling expectations (Efron &amp; Tibshirani 1993).
</p>


<h3>Value</h3>

<p>Prints a data frame containing the lower, median, and upper values of the jackknife confidence
interval for additive genetic, non-additive genetic, maternal variance components, and any
additional fixed effect and/or random effect variance components. Values are presented as raw and
percentages of the total variance value within each row.
</p>


<h3>References</h3>

<p>Efron B, Tibshirani R. 1993. An introduction to the Bootstrap. Chapman and Hall, New York.
</p>
<p>Martin, H., Westad, F. &amp; Martens, H. (2004). Imporved Jackknife Variance Estimates of Bilinear
Model Parameters. COMPSTAT 2004 &ndash; Proceedings in Computational Statistics 16th Symposium Held
in Prague, Czech Republic, 2004 (ed J. Antoch), pp. 261-275. Physica-Verlag HD, Heidelberg.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+ciJack">ciJack</a></code>, <code><a href="#topic+ciJack2">ciJack2</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(chinook_jackL) #Chinook salmon offspring length, delete-one jackknife
ciJack3(chinook_jackL,remain=c("tray","Residual"),c(0,0.7192,0.2030,1.0404,0.1077,0.5499))
</code></pre>

<hr>
<h2 id='ciMANA'>Bootstrap confidence intervals</h2><span id='topic+ciMANA'></span>

<h3>Description</h3>

<p>Extracts bootstrap-<em>t</em> confidence intervals for additive genetic, non-additive genetic, and maternal
variance components.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ciMANA(comp, level = 95, rnd_r = 3, rnd_p = 1, bias = NULL, accel = NULL, trait = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ciMANA_+3A_comp">comp</code></td>
<td>
<p>Data frame of bootstrap resampling results.</p>
</td></tr>
<tr><td><code id="ciMANA_+3A_level">level</code></td>
<td>
<p>Confidence level, as a percentage. Default is 95.</p>
</td></tr>
<tr><td><code id="ciMANA_+3A_rnd_r">rnd_r</code></td>
<td>
<p>Number of decimal places to round the confidence interval of raw values.</p>
</td></tr>
<tr><td><code id="ciMANA_+3A_rnd_p">rnd_p</code></td>
<td>
<p>Number of decimal places to round the confidence interval of percentage values.</p>
</td></tr>
<tr><td><code id="ciMANA_+3A_bias">bias</code></td>
<td>

<p>Optional vector of raw observed additive, non-additive, and maternal, variance component values
for bias correction, i.e. c(additive, non-additive, maternal).
</p>
</td></tr>
<tr><td><code id="ciMANA_+3A_accel">accel</code></td>
<td>
<p>Optional data frame of jackknifed data model results for acceleration correction.</p>
</td></tr>
<tr><td><code id="ciMANA_+3A_trait">trait</code></td>
<td>
<p>Optional label for the phenotypic trait.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Used for bootstrap resampling results produced using <em>resampLmer</em> for normal data or
<em>resampGlmer</em> for non-normal data.
Bootstrap-<em>t</em> confidence intervals, including bias and acceleration correction methods are
described by Efron and Tibshirani (1993).
Jackknife data model results for acceleration correction can be produced using <em>JackLmer</em>,
for normal data or <em>JackGlmer</em> for non-normal data.
The 'bias fail' warning is if the bias calculation is Inf or -Inf, e.g. <em>bias</em> contains
a zero value, so the uncorrected confidence interval is displayed.
</p>


<h3>Value</h3>

<p>Prints a data frame containing the lower, median, and upper values of the bootstrap-<em>t</em> confidence
interval for additive genetic, non-additive genetic, and maternal variance components.
Values are presented as raw and percentages of the total variance value within each row.
</p>


<h3>References</h3>

<p>Efron B, Tibshirani R. 1993. An introduction to the Bootstrap. Chapman and Hall, New York.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+ciMANA2">ciMANA2</a></code>, <code><a href="#topic+ciMANA3">ciMANA3</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
#Import bootstrap resampled data model results
data(chinook_bootL) #Chinook salmon offspring length

#Extract un-corrected confidence interval
ciMANA(comp=chinook_bootL)

#Extract bias corrected confidence interval
ciMANA(comp=chinook_bootL,bias=c(0,0.7192,0.2030))
#see details for 'bias' fail

#Extract bias and accelerated corrected confidence interval
#Import jackknife resampled data model results
data(chinook_jackL)
#
ciMANA(comp=chinook_bootL,bias=c(0,0.7192,0.2030),accel=chinook_jackL)
#see details for 'bias' fail
</code></pre>

<hr>
<h2 id='ciMANA2'>Bootstrap confidence intervals 2</h2><span id='topic+ciMANA2'></span>

<h3>Description</h3>

<p>Extracts bootstrap-<em>t</em> confidence intervals for additive genetic, non-additive genetic, and maternal
variance components. Also extracts intervals for optional position and block variance components.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ciMANA2(comp, level = 95, rnd_r = 3, rnd_p = 1, position = NULL, block = NULL,
bias = NULL, accel = NULL, trait = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ciMANA2_+3A_comp">comp</code></td>
<td>
<p>Data frame of bootstrap resampling results.</p>
</td></tr>
<tr><td><code id="ciMANA2_+3A_level">level</code></td>
<td>
<p>Confidence level, as a percentage. Default is 95.</p>
</td></tr>
<tr><td><code id="ciMANA2_+3A_rnd_r">rnd_r</code></td>
<td>
<p>Number of decimal places to round the confidence interval of raw values.</p>
</td></tr>
<tr><td><code id="ciMANA2_+3A_rnd_p">rnd_p</code></td>
<td>
<p>Number of decimal places to round the confidence interval of percentage values.</p>
</td></tr>
<tr><td><code id="ciMANA2_+3A_position">position</code></td>
<td>
<p>Optional column name containing position factor information.</p>
</td></tr>
<tr><td><code id="ciMANA2_+3A_block">block</code></td>
<td>
<p>Optional column name containing block factor information.</p>
</td></tr>
<tr><td><code id="ciMANA2_+3A_bias">bias</code></td>
<td>

<p>Optional vector of raw observed additive, non-additive, maternal, position and/or block
variance component values for bias correction, i.e. c(additive, non-additive, maternal, position/block).
If there is a position and a block c(..., maternal, position, block).
</p>
</td></tr>
<tr><td><code id="ciMANA2_+3A_accel">accel</code></td>
<td>
<p>Optional data frame of jackknifed data model results for acceleration correction.</p>
</td></tr>
<tr><td><code id="ciMANA2_+3A_trait">trait</code></td>
<td>
<p>Optional label for the phenotypic trait.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Used for bootstrap resampling results produced using <em>resampLmer2</em> for normal data or
<em>resampGlmer2</em> for non-normal data.
Bootstrap-<em>t</em> confidence intervals, including bias and acceleration correction methods are
described by Efron and Tibshirani (1993).
Jackknife data model results for acceleration correction can be produced using <em>JackLmer2</em>,
for normal data or <em>JackGlmer2</em> for non-normal data.
The 'bias fail' warning is if the bias calculation is Inf or -Inf, e.g. <em>bias</em> contains
a zero value, so the uncorrected confidence interval is displayed.
</p>


<h3>Value</h3>

<p>Prints a data frame containing the lower, median, and upper values of the bootstrap-<em>t</em> confidence
interval for additive genetic, non-additive genetic, maternal, and optional position and/or block
variance components. Values are presented as raw and percentages of the total variance value
within each row.
</p>


<h3>References</h3>

<p>Efron B, Tibshirani R. 1993. An introduction to the Bootstrap. Chapman and Hall, New York.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+ciMANA">ciMANA</a></code>, <code><a href="#topic+ciMANA3">ciMANA3</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
#Import bootstrap resampled data model results
data(chinook_bootL) #Chinook salmon offspring length

#Extract un-corrected confidence interval
ciMANA2(comp=chinook_bootL,position="tray")

#Extract bias corrected confidence interval
ciMANA2(comp=chinook_bootL,position="tray",bias=c(0,0.7192,0.2030,0.1077))
#see details for 'bias' fail

#Extract bias and accelerated corrected confidence interval
#Import jackknife resampled data model results
data(chinook_jackL)
#
ciMANA2(comp=chinook_bootL,position="tray",
bias=c(0,0.7192,0.2030,0.1077),accel=chinook_jackL)
#see details for 'bias' fail
</code></pre>

<hr>
<h2 id='ciMANA3'>Bootstrap confidence intervals 3</h2><span id='topic+ciMANA3'></span>

<h3>Description</h3>

<p>Extracts bootstrap-<em>t</em> confidence intervals for additive genetic, non-additive genetic, and maternal
variance components. Also extracts intervals for additional fixed and/or random effects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ciMANA3(comp, level = 95, rnd_r = 3, rnd_p = 1, bias = NULL, accel = NULL,
remain = NULL, trait = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ciMANA3_+3A_comp">comp</code></td>
<td>
<p>Data frame of bootstrap resampling results.</p>
</td></tr>
<tr><td><code id="ciMANA3_+3A_level">level</code></td>
<td>
<p>Confidence level, as a percentage. Default is 95.</p>
</td></tr>
<tr><td><code id="ciMANA3_+3A_rnd_r">rnd_r</code></td>
<td>
<p>Number of decimal places to round the confidence interval of raw values.</p>
</td></tr>
<tr><td><code id="ciMANA3_+3A_rnd_p">rnd_p</code></td>
<td>
<p>Number of decimal places to round the confidence interval of percentage values.</p>
</td></tr>
<tr><td><code id="ciMANA3_+3A_bias">bias</code></td>
<td>

<p>Optional vector of raw observed additive, non-additive, and maternal variance components
for bias correction. Followed by any other components in the order of the vector <em>remain</em>,
i.e. c(additive, non-additive, maternal, component1, component2, etc.).
</p>
</td></tr>
<tr><td><code id="ciMANA3_+3A_accel">accel</code></td>
<td>
<p>Optional data frame of jackknifed data model results for acceleration correction.</p>
</td></tr>
<tr><td><code id="ciMANA3_+3A_remain">remain</code></td>
<td>
<p>Vector of column names for additional effects.</p>
</td></tr>
<tr><td><code id="ciMANA3_+3A_trait">trait</code></td>
<td>
<p>Optional label for the phenotypic trait.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Used for bootstrap resampling results produced using <em>resampLmer3</em> for normal data or
<em>resampGlmer3</em> for non-normal data.
Bootstrap-<em>t</em> confidence intervals, including bias and acceleration correction methods are
described by Efron and Tibshirani (1993).
Jackknife data model results for acceleration correction can be produced using <em>JackLmer3</em>,
for normal data or <em>JackGlmer3</em> for non-normal data.
The 'bias fail' warning is if the bias calculation is Inf or -Inf, e.g. <em>bias</em> contains
a zero value, so the uncorrected confidence interval is displayed.
</p>


<h3>Value</h3>

<p>Prints a data frame containing the lower, median, and upper values of the bootstrap-<em>t</em> confidence
interval for additive genetic, non-additive genetic, maternal, and any additional fixed effect
and/or random effect variance components. Values are presented as raw and percentages of the total variance
value within each row.
</p>


<h3>References</h3>

<p>Efron B, Tibshirani R. 1993. An introduction to the Bootstrap. Chapman and Hall, New York.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+ciMANA">ciMANA</a></code>, <code><a href="#topic+ciMANA2">ciMANA2</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
#Import bootstrap resampled data model results
data(chinook_bootL) #Chinook salmon offspring length

#Extract un-corrected confidence interval
ciMANA3(comp=chinook_bootL,remain=c("tray","Residual"))

#Extract bias corrected confidence interval
ciMANA3(comp=chinook_bootL,remain=c("tray","Residual"),
bias=c(0,0.7192,0.2030,0.1077,0.5499))
#see details for 'bias' fail

#Extract bias and accelerated corrected confidence interval
#Import jackknife resampled data model results
data(chinook_jackL)
#
ciMANA3(comp=chinook_bootL,remain=c("tray","Residual"),
bias=c(0,0.7192,0.2030,0.1077,0.5499),accel=chinook_jackL)
</code></pre>

<hr>
<h2 id='fullfact-internal'>Internal fullfact functions</h2><span id='topic+randLmer'></span><span id='topic+randGlmer'></span><span id='topic+fixedLmer'></span><span id='topic+fixedGlmer'></span>

<h3>Description</h3>

<p>Internal fullfact functions.</p>


<h3>Details</h3>

<p>These are not to be called by the user.</p>

<hr>
<h2 id='fullfact-package'>
Full Factorial Breeding Analysis
</h2><span id='topic+fullfact-package'></span><span id='topic+fullfact'></span>

<h3>Description</h3>

<p>Full factorial breeding designs are useful for quantifying the amount of additive
genetic, nonadditive genetic, and maternal variance that explain phenotypic
traits. Such variance estimates are important for examining evolutionary potential.
Traditionally, full factorial mating designs have been analyzed using a two-
way analysis of variance, which may produce negative variance values and is
not suited for unbalanced designs. Mixed-effects models do not produce negative
variance values and are suited for unbalanced designs. However, extracting
the variance components, calculating significance values, and estimating confidence
intervals and/or power values for the components are not straightforward
using traditional analytic methods.
</p>
<p>In this package we address these issues and facilitate the analysis of full factorial mating
designs with mixed-effects models. The observed data functions extract the variance explained
by random and fixed effects and provide their significance. We then calculate
the additive genetic, nonadditive genetic, and maternal variance components
explaining the phenotype. In particular, we integrate nonnormal error structures for estimating
these components for nonnormal data types. The resampled data functions are used to produce
bootstrap confidence intervals, which can then be plotted using a simple function.
This package will facilitate the analyses of full factorial mating designs in R, especially
for the analysis of binary, proportion, and/or count data types and for the ability to incorporate
additional random and fixed effects and power analyses.
</p>
<p>The package contains six vignettes containing detailed examples: browseVignettes(package=&quot;fullfact&quot;). 
</p>
<p>The paper associated with the package including worked examples is:
Houde ALS, Pitcher TE. 2016. fullfact: an R package for the analysis of genetic and maternal variance components
from full factorial mating designs. Ecology and evolution 6 (6), 1656-1665. doi: 10.1002/ece3.1943.
</p>


<h3>Details</h3>

<p>The DESCRIPTION file:
</p>

<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> fullfact</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Title: </td><td style="text-align: left;"> Full Factorial Breeding Analysis</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.5.2</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2024-02-04</td>
</tr>
<tr>
 <td style="text-align: left;">
Author: </td><td style="text-align: left;"> Aimee Lee Houde [aut, cre], Trevor Pitcher [aut]</td>
</tr>
<tr>
 <td style="text-align: left;">
Maintainer: </td><td style="text-align: left;"> Aimee Lee Houde &lt;aimee.lee.houde@gmail.com&gt;</td>
</tr>
<tr>
 <td style="text-align: left;">
Depends: </td><td style="text-align: left;"> R (&gt;= 3.6)</td>
</tr>
<tr>
 <td style="text-align: left;">
Imports: </td><td style="text-align: left;"> lme4, afex</td>
</tr>
<tr>
 <td style="text-align: left;">
VignetteBuilder: </td><td style="text-align: left;"> knitr</td>
</tr>
<tr>
 <td style="text-align: left;">
Suggests: </td><td style="text-align: left;"> knitr, rmarkdown</td>
</tr>
<tr>
 <td style="text-align: left;">
Description: </td><td style="text-align: left;"> We facilitate the analysis of full factorial mating designs with mixed-effects models. The package contains six vignettes containing detailed examples.</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;=2)</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>


<p>Index of help topics:
</p>
<pre>
JackGlmer               Jackknife components for non-normal data
JackGlmer2              Jackknife components for non-normal data 2
JackGlmer3              Jackknife components for non-normal data 3
JackLmer                Jackknife components for normal data
JackLmer2               Jackknife components for normal data 2
JackLmer3               Jackknife components for normal data 3
barMANA                 Bargraph of confidence intervals
boxMANA                 Boxplot of resampled results
buildBinary             Convert to a binary data frame
buildMulti              Convert to a multinomial frame
chinook_bootL           Chinook salmon length, bootstrap calculations
chinook_bootS           Chinook salmon survival, bootstrap data
chinook_jackL           Chinook salmon length, jackknife data
chinook_jackS           Chinook salmon survival, jackknife data
chinook_length          Chinook salmon length, raw data
chinook_resampL         Chinook salmon length, bootstrap resampled
chinook_resampS         Chinook salmon survival, bootstrap resampled
chinook_survival        Chinook salmon survival, raw data
ciJack                  Jackknife confidence intervals
ciJack2                 Jackknife confidence intervals 2
ciJack3                 Jackknife confidence intervals 3
ciMANA                  Bootstrap confidence intervals
ciMANA2                 Bootstrap confidence intervals 2
ciMANA3                 Bootstrap confidence intervals 3
fullfact-package        Full Factorial Breeding Analysis
observGlmer             Variance components for non-normal data
observGlmer2            Variance components for non-normal data 2
observGlmer3            Variance components for non-normal data 3
observLmer              Variance components for normal data
observLmer2             Variance components for normal data 2
observLmer3             Variance components for normal data 3
powerGlmer              Power analysis for non-normal data
powerGlmer2             Power analysis for non-normal data 2
powerGlmer3             Power analysis for non-normal data 3
powerLmer               Power analysis for normal data
powerLmer2              Power analysis for normal data 2
powerLmer3              Power analysis for normal data 3
resampFamily            Bootstrap resample within families
resampGlmer             Bootstrap components for non-normal data
resampGlmer2            Bootstrap components for non-normal data 2
resampGlmer3            Bootstrap components for non-normal data 3
resampLmer              Bootstrap components for normal data
resampLmer2             Bootstrap components for normal data 2
resampLmer3             Bootstrap components for normal data 3
resampRepli             Bootstrap resample within replicates
</pre>


<h3>Author(s)</h3>

<p>Aimee Lee Houde [aut, cre], Trevor Pitcher [aut]
</p>
<p>Maintainer: Aimee Lee Houde &lt;aimee.lee.houde@gmail.com&gt;
</p>


<h3>References</h3>

<p>Traditional full factorial breeding design analysis:
</p>
<p>Lynch M, Walsh B. 1998. Genetics and Analysis of Quantitative Traits. Sinauer Associates, Massachusetts.
</p>
<p>Residual variance component values for generalized linear mixed-effects models:
</p>
<p>Nakagawa S, Schielzeth H. 2010. Repeatability for Gaussian and non-Gaussian data: a practical guide for biologists.
Biological Reviews 85(4): 935-956. DOI: 10.1111/j.1469-185X.2010.00141.x
</p>
<p>Fixed effect variance component values for mixed-effects models:
</p>
<p>Nakagawa S, Schielzeth H. 2013. A general and simple method for obtaining R2 from generalized linear mixed-effects models.
Methods in Ecology and Evolution 4(2): 133-142. DOI: 10.1111/j.2041-210x.2012.00261.x
</p>
<p>Confidence intervals (bootstrap resampling, bias and acceleration correction, jackknife resampling):
</p>
<p>Efron B, Tibshirani R. 1993. An introduction to the Bootstrap. Chapman and Hall, New York.
</p>
<p>Martin, H., Westad, F. &amp; Martens, H. (2004). Imporved Jackknife Variance Estimates of Bilinear
Model Parameters. COMPSTAT 2004 &ndash; Proceedings in Computational Statistics 16th Symposium Held
in Prague, Czech Republic, 2004 (ed J. Antoch), pp. 261-275. Physica-Verlag HD, Heidelberg.
</p>
<p>Data sources:
</p>
<p>Pitcher TE, Neff BD. 2007. Genetic quality and offspring performance in Chinook salmon: implications for supportive breeding.
Conservation Genetics 8(3):607-616. DOI: 10.1007/s10592-006-9204-z
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(chinook_length) #Chinook salmon offspring length

## Standard additive genetic, non-additive genetic, and maternal variance analysis

length_mod1&lt;- observLmer(observ=chinook_length,dam="dam",sire="sire",response="length")
length_mod1

## Confidence intervals

##Bootstrap resampling of data: replicates within family
## Not run: resampRepli(dat=chinook_length,copy=c(3:8),family="family",replicate="repli",
iter=1000)
## End(Not run)
#saves the files in working directory: one for each replicate and
#one final (combined) file "resamp_datR.csv"

##Import file
#length_datR&lt;- read.csv("resamp_datR.csv")
data(chinook_resampL) #same as length_datR, 5 iterations

##Models for the resampled data: standard analysis
## Not run: length_rcomp&lt;- resampLmer(resamp=length_datR,dam="dam",sire="sire",
response="length",start=1,end=1000)
## End(Not run)

## 1. Uncorrected Bootstrap 95% confidence interval

#ciMANA(comp=length_rcomp)
data(chinook_bootL)  #similar to length_rcomp, but 1,000 models
ciMANA(comp=chinook_bootL)

## 2. Bias and accelerated corrected Bootstrap 95% confidence interval

##Jackknife resampling of data, delete-one: for acceleration estimate
## Not run: length_jack&lt;- JackLmer(observ=chinook_length,dam="dam",sire="sire",
response="length")
## End(Not run)

#ciMANA(comp=length_rcomp,bias=c(0,0.7192,0.2030),accel=length_jack)
data(chinook_jackL)  #similar to length_jack, but all observations
ciMANA(comp=chinook_bootL,bias=c(0,0.7192,0.2030),accel=chinook_jackL)

##3. Jackknife 95% confidence interval

#ciJack(comp=length_jack,full=c(0,0.7192,0.2030,1.0404))
ciJack(comp=chinook_jackL,full=c(0,0.7192,0.2030,1.0404))
</code></pre>

<hr>
<h2 id='JackGlmer'>Jackknife components for non-normal data</h2><span id='topic+JackGlmer'></span>

<h3>Description</h3>

<p>Extracts additive genetic, non-additive genetic, and maternal variance components
from a linear mixed-effect model using the <em>lmer</em> function of the <em>lme4</em> package.
Model random effects are dam, sire, and dam by sire.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>JackGlmer(observ, dam, sire, response, fam_link, quasi = F, size = 1, first = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="JackGlmer_+3A_observ">observ</code></td>
<td>
<p>Data frame of observed data.</p>
</td></tr>
<tr><td><code id="JackGlmer_+3A_dam">dam</code></td>
<td>
<p>Column name containing dam (female) parent identity information.</p>
</td></tr>
<tr><td><code id="JackGlmer_+3A_sire">sire</code></td>
<td>
<p>Column name containing sire (male) parent identity information.</p>
</td></tr>
<tr><td><code id="JackGlmer_+3A_response">response</code></td>
<td>
<p>Column name containing the offspring (response) phenotype values.</p>
</td></tr>
<tr><td><code id="JackGlmer_+3A_fam_link">fam_link</code></td>
<td>

<p>The family and link in family(link) format. Supported options are binomial(link=&quot;logit&quot;), binomial(link=&quot;probit&quot;), poisson(link=&quot;log&quot;), and poisson(link=&quot;sqrt&quot;).
</p>
</td></tr>
<tr><td><code id="JackGlmer_+3A_quasi">quasi</code></td>
<td>
<p>Incorporate overdispersion or quasi-error structure.</p>
</td></tr>
<tr><td><code id="JackGlmer_+3A_size">size</code></td>
<td>
<p>Default is 1 for delete-one jackknife resampling. If <em>size</em> &gt; 1,
delete-<em>d</em> jackknife resampling occurs removing a block d equal to <em>size</em>.</p>
</td></tr>
<tr><td><code id="JackGlmer_+3A_first">first</code></td>
<td>

<p>Number of initial sub-samples to run. Useful for examing if there is variation among
sub-samples before jackknife resampling the entire data set. There can be little variation for
delete-one jackknife resampling with large data sets, and delete-<em>d</em> jackknife resampling
should be considered.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Uses delete-one jackknife resampling (Efron &amp; Tibshirani 1993, p. 141-145). For the option of
delete-<em>d</em> jackknife resampling, the rows of the observed data frame are shuffled and a block of
observations of size <em>d</em> is deleted sequentially.
Laplace approximation parameter estimation is used, which is a true likelihood method (Bolker et al. 2009).
For the overdispersion option, an observation-level random effect is added to the model (Atkins et al. 2013).
Extracts the dam, sire, dam, and dam by sire variance components.
The residual variance component for the <em>fam_links</em> are described by Nakagawa and Schielzeth (2010, 2013).
Calculates the total variance component. Calculates the additive genetic, non-additive genetic, and
maternal variance components (see Lynch and Walsh 1998, p. 603).
</p>


<h3>Value</h3>

<p>A data frame with columns containing the raw variance components for dam, sire, dam by sire,
residual, total, additive genetic, non-additive genetic, and maternal. The number of rows
in the data frame matches the total number of observations (<em>N</em>) for delete-one jackknife
resampling or <em>M</em> groups for delete-<em>d</em> jackknife resampling to the lowest integer.
Each row represents a deleted single observation or deleted <em>d</em> observations group.
</p>


<h3>Note</h3>

<p>The Laplace approximation is used because there were fewer disadvantages relative to penalized
quasi-likelihood and Gauss-Hermite quadrature parameter estimation (Bolker et al. 2009).
That is, penalized quasi-likelihood is not recommended for count responses with means less than 5 and
binary responses with less than 5 successes per group. Gauss-Hermite quadrature is not recommended for
more than two or three random effects because of the rapidly declining analytical speed with the
increasing number of random effects.
</p>


<h3>References</h3>

<p>Atkins DC, Baldwin SA, Zheng C, Gallop RJ, Neighbors C. 2013. A tutorial on count regression and
zero-altered count models for longitudinal substance use data.
Psychology of Addictive Behaviors 27(1): 166-177. DOI: 10.1037/a0029508
</p>
<p>Bolker BM, Brooks ME, Clark CJ, Geange SW, Poulsen JR, Stevens MHH, White J-SS. 2009.
Generalized linear mixed models: a practical guide for ecology and evolution.
Trends in Ecology and Evolution 24(3): 127-135. DOI: 10.1016/j.tree.2008.10.008
</p>
<p>Efron B, Tibshirani R. 1993. An introduction to the Bootstrap. Chapman and Hall, New York.
</p>
<p>Lynch M, Walsh B. 1998. Genetics and Analysis of Quantitative Traits. Sinauer Associates, Massachusetts.
</p>
<p>Nakagawa S, Schielzeth H. 2010. Repeatability for Gaussian and non-Gaussian data: a practical guide for biologists.
Biological Reviews 85(4): 935-956. DOI: 10.1111/j.1469-185X.2010.00141.x
</p>
<p>Nakagawa S, Schielzeth H. 2013. A general and simple method for obtaining R2 from generalized linear mixed-effects models.
Methods in Ecology and Evolution 4(2): 133-142. DOI: 10.1111/j.2041-210x.2012.00261.x
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+JackGlmer2">JackGlmer2</a></code>, <code><a href="#topic+JackGlmer3">JackGlmer3</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(chinook_survival) #Chinook salmon offspring survival
## Convert replicate-level recorded data to individual-level (binary) data
chinook_survival2&lt;- buildBinary(dat=chinook_survival,copy=c(1:6,9),one="alive",zero="dead")

#Delete-one
## Not run: survival_jack1&lt;- JackGlmer(observ=chinook_survival2,dam="dam",sire="sire",
response="status",fam_link=binomial(link="logit"))
## End(Not run)

#Delete-d, d=30
## Not run: survival_jack1.2&lt;- JackGlmer(observ=chinook_survival2,dam="dam",sire="sire",
response="status",fam_link=binomial(link="logit"),size=30)
## End(Not run)
</code></pre>

<hr>
<h2 id='JackGlmer2'>Jackknife components for non-normal data 2</h2><span id='topic+JackGlmer2'></span>

<h3>Description</h3>

<p>Extracts additive genetic, non-additive genetic, and maternal variance components
from a linear mixed-effect model using the <em>lmer</em> function of the <em>lme4</em> package.
Model random effects are dam, sire, and dam by sire.
Options to include one random position and/or one random block effect(s).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>JackGlmer2(observ, dam, sire, response, fam_link, position = NULL, block = NULL,
quasi = F, size = 1, first = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="JackGlmer2_+3A_observ">observ</code></td>
<td>
<p>Data frame of observed data.</p>
</td></tr>
<tr><td><code id="JackGlmer2_+3A_dam">dam</code></td>
<td>
<p>Column name containing dam (female) parent identity information.</p>
</td></tr>
<tr><td><code id="JackGlmer2_+3A_sire">sire</code></td>
<td>
<p>Column name containing sire (male) parent identity information.</p>
</td></tr>
<tr><td><code id="JackGlmer2_+3A_response">response</code></td>
<td>
<p>Column name containing the offspring (response) phenotype values</p>
</td></tr></table>
<p>.
</p>
<table>
<tr><td><code id="JackGlmer2_+3A_fam_link">fam_link</code></td>
<td>

<p>The family and link in family(link) format. Supported options are binomial(link=&quot;logit&quot;), binomial(link=&quot;probit&quot;), poisson(link=&quot;log&quot;), and poisson(link=&quot;sqrt&quot;).
</p>
</td></tr>
<tr><td><code id="JackGlmer2_+3A_position">position</code></td>
<td>
<p>Optional column name containing position factor information.</p>
</td></tr>
<tr><td><code id="JackGlmer2_+3A_block">block</code></td>
<td>
<p>Optional column name containing block factor information.</p>
</td></tr>
<tr><td><code id="JackGlmer2_+3A_quasi">quasi</code></td>
<td>
<p>Incorporate overdispersion or quasi-error structure.</p>
</td></tr>
<tr><td><code id="JackGlmer2_+3A_size">size</code></td>
<td>
<p>Default is 1 for delete-one jackknife resampling. If <em>size</em> &gt; 1,
delete-<em>d</em> jackknife resampling occurs removing a block d equal to <em>size</em>.</p>
</td></tr>
<tr><td><code id="JackGlmer2_+3A_first">first</code></td>
<td>

<p>Number of initial sub-samples to run. Useful for examing if there is variation among
sub-samples before jackknife resampling the entire data set. There can be little variation for
delete-one jackknife resampling with large data sets, and delete-<em>d</em> jackknife resampling
should be considered.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Uses delete-one jackknife resampling (Efron &amp; Tibshirani 1993, p. 141-145). For the option of
delete-<em>d</em> jackknife resampling, the rows of the observed data frame are shuffled and a block of
observations of size <em>d</em> is deleted sequentially.
Laplace approximation parameter estimation is used, which is a true likelihood method (Bolker et al. 2009).
For the overdispersion option, an observation-level random effect is added to the model (Atkins et al. 2013).
Extracts the dam, sire, dam, and dam by sire variance components.
Extracts optional position and block variance components.
The residual variance component for the <em>fam_links</em> are described by Nakagawa and Schielzeth (2010, 2013).
Calculates the total variance component. Calculates the additive genetic, non-additive genetic, and
maternal variance components (see Lynch and Walsh 1998, p. 603).
</p>


<h3>Value</h3>

<p>A data frame with columns containing the raw variance components for dam, sire, dam by sire,
residual, total, additive genetic, non-additive genetic, and maternal. Also columns containing
the raw variance components for the options of position and/or block. The number of rows
in the data frame matches the total number of observations (<em>N</em>) for delete-one jackknife
resampling or <em>M</em> groups for delete-<em>d</em> jackknife resampling to the lowest integer.
Each row represents a deleted single observation or deleted <em>d</em> observations group.
</p>


<h3>Note</h3>

<p>The Laplace approximation is used because there were fewer disadvantages relative to penalized
quasi-likelihood and Gauss-Hermite quadrature parameter estimation (Bolker et al. 2009).
That is, penalized quasi-likelihood is not recommended for count responses with means less than 5 and
binary responses with less than 5 successes per group. Gauss-Hermite quadrature is not recommended for
more than two or three random effects because of the rapidly declining analytical speed with the
increasing number of random effects.
</p>


<h3>References</h3>

<p>Atkins DC, Baldwin SA, Zheng C, Gallop RJ, Neighbors C. 2013. A tutorial on count regression and
zero-altered count models for longitudinal substance use data.
Psychology of Addictive Behaviors 27(1): 166-177. DOI: 10.1037/a0029508
</p>
<p>Bolker BM, Brooks ME, Clark CJ, Geange SW, Poulsen JR, Stevens MHH, White J-SS. 2009.
Generalized linear mixed models: a practical guide for ecology and evolution.
Trends in Ecology and Evolution 24(3): 127-135. DOI: 10.1016/j.tree.2008.10.008
</p>
<p>Efron B, Tibshirani R. 1993. An introduction to the Bootstrap. Chapman and Hall, New York.
</p>
<p>Lynch M, Walsh B. 1998. Genetics and Analysis of Quantitative Traits. Sinauer Associates, Massachusetts.
</p>
<p>Nakagawa S, Schielzeth H. 2010. Repeatability for Gaussian and non-Gaussian data: a practical guide for biologists.
Biological Reviews 85(4): 935-956. DOI: 10.1111/j.1469-185X.2010.00141.x
</p>
<p>Nakagawa S, Schielzeth H. 2013. A general and simple method for obtaining R2 from generalized linear mixed-effects models.
Methods in Ecology and Evolution 4(2): 133-142. DOI: 10.1111/j.2041-210x.2012.00261.x
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+JackGlmer">JackGlmer</a></code>, <code><a href="#topic+JackGlmer3">JackGlmer3</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(chinook_survival) #Chinook salmon offspring survival
## Convert replicate-level recorded data to individual-level (binary) data
chinook_survival2&lt;- buildBinary(dat=chinook_survival,copy=c(1:6,9),one="alive",zero="dead")

#Delete-one
## Not run: survival_jack2&lt;- JackGlmer2(observ=chinook_survival2,dam="dam",sire="sire",
response="status",fam_link=binomial(link="logit"),position="tray")
## End(Not run)

#Delete-d, d=30
## Not run: survival_jack2.2&lt;- JackGlmer2(observ=chinook_survival2,dam="dam",sire="sire",
response="status",fam_link=binomial(link="logit"),position="tray",size=30)
## End(Not run)
</code></pre>

<hr>
<h2 id='JackGlmer3'>Jackknife components for non-normal data 3</h2><span id='topic+JackGlmer3'></span>

<h3>Description</h3>

<p>Extracts additive genetic, non-additive genetic, and maternal variance components
from a linear mixed-effect model using the <em>lmer</em> function of the <em>lme4</em> package.
Model random effects are dam, sire, dam by sire, and any additional fixed and/or random effects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>JackGlmer3(observ, dam, sire, response, fam_link, remain, quasi = F, size = 1,
first = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="JackGlmer3_+3A_observ">observ</code></td>
<td>
<p>Data frame of observed data.</p>
</td></tr>
<tr><td><code id="JackGlmer3_+3A_dam">dam</code></td>
<td>
<p>Column name containing dam (female) parent identity information.</p>
</td></tr>
<tr><td><code id="JackGlmer3_+3A_sire">sire</code></td>
<td>
<p>Column name containing sire (male) parent identity information.</p>
</td></tr>
<tr><td><code id="JackGlmer3_+3A_response">response</code></td>
<td>
<p>Column name containing the offspring (response) phenotype values.</p>
</td></tr>
<tr><td><code id="JackGlmer3_+3A_fam_link">fam_link</code></td>
<td>

<p>The family and link in family(link) format. Supported options are binomial(link=&quot;logit&quot;), binomial(link=&quot;probit&quot;), poisson(link=&quot;log&quot;), and poisson(link=&quot;sqrt&quot;).
</p>
</td></tr>
<tr><td><code id="JackGlmer3_+3A_remain">remain</code></td>
<td>
<p>Remaining formula using <em>lme4</em> package formula.</p>
</td></tr>
<tr><td><code id="JackGlmer3_+3A_quasi">quasi</code></td>
<td>
<p>Incorporate overdispersion or quasi-error structure.</p>
</td></tr>
<tr><td><code id="JackGlmer3_+3A_size">size</code></td>
<td>
<p>Default is 1 for delete-one jackknife resampling. If <em>size</em> &gt; 1,
delete-<em>d</em> jackknife resampling occurs removing a block d equal to <em>size</em>.</p>
</td></tr>
<tr><td><code id="JackGlmer3_+3A_first">first</code></td>
<td>

<p>Number of initial sub-samples to run. Useful for examing if there is variation among
sub-samples before jackknife resampling the entire data set. There can be little variation for
delete-one jackknife resampling with large data sets, and delete-<em>d</em> jackknife resampling
should be considered.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Uses delete-one jackknife resampling (Efron &amp; Tibshirani 1993, p. 141-145). For the option of
delete-<em>d</em> jackknife resampling, the rows of the observed data frame are shuffled and a block of
observations of size <em>d</em> is deleted sequentially.
Laplace approximation parameter estimation is used, which is a true likelihood method (Bolker et al. 2009).
For the overdispersion option, an observation-level random effect is added to the model (Atkins et al. 2013).
Extracts the dam, sire, dam, and dam by sire variance components.
Extracts any additional fixed effect and random effect variance components. The fixed-effect variance
component is as a single group using the method described by Nakagawa and Schielzeth (2013).
The residual variance component for the <em>fam_links</em> are described by Nakagawa and Schielzeth (2010, 2013).
Calculates the total variance component. Calculates the additive genetic, non-additive genetic, and
maternal variance components (see Lynch and Walsh 1998, p. 603).
</p>


<h3>Value</h3>

<p>A data frame with columns containing the raw variance components for dam, sire, dam by sire,
residual, total, additive genetic, non-additive genetic, and maternal. Also columns containing
the raw variance components for remaining formula components. The number of rows
in the data frame matches the total number of observations (<em>N</em>) for delete-one jackknife
resampling or <em>M</em> groups for delete-<em>d</em> jackknife resampling to the lowest integer.
Each row represents a deleted single observation or deleted <em>d</em> observations group.
</p>


<h3>Note</h3>

<p>The Laplace approximation is used because there were fewer disadvantages relative to penalized
quasi-likelihood and Gauss-Hermite quadrature parameter estimation (Bolker et al. 2009).
That is, penalized quasi-likelihood is not recommended for count responses with means less than 5 and
binary responses with less than 5 successes per group. Gauss-Hermite quadrature is not recommended for
more than two or three random effects because of the rapidly declining analytical speed with the
increasing number of random effects.
</p>


<h3>References</h3>

<p>Atkins DC, Baldwin SA, Zheng C, Gallop RJ, Neighbors C. 2013. A tutorial on count regression and
zero-altered count models for longitudinal substance use data.
Psychology of Addictive Behaviors 27(1): 166-177. DOI: 10.1037/a0029508
</p>
<p>Bolker BM, Brooks ME, Clark CJ, Geange SW, Poulsen JR, Stevens MHH, White J-SS. 2009.
Generalized linear mixed models: a practical guide for ecology and evolution.
Trends in Ecology and Evolution 24(3): 127-135. DOI: 10.1016/j.tree.2008.10.008
</p>
<p>Efron B, Tibshirani R. 1993. An introduction to the Bootstrap. Chapman and Hall, New York.
</p>
<p>Lynch M, Walsh B. 1998. Genetics and Analysis of Quantitative Traits. Sinauer Associates, Massachusetts.
</p>
<p>Nakagawa S, Schielzeth H. 2010. Repeatability for Gaussian and non-Gaussian data: a practical guide for biologists.
Biological Reviews 85(4): 935-956. DOI: 10.1111/j.1469-185X.2010.00141.x
</p>
<p>Nakagawa S, Schielzeth H. 2013. A general and simple method for obtaining R2 from generalized linear mixed-effects models.
Methods in Ecology and Evolution 4(2): 133-142. DOI: 10.1111/j.2041-210x.2012.00261.x
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+JackGlmer">JackGlmer</a></code>, <code><a href="#topic+JackGlmer2">JackGlmer2</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(chinook_survival) #Chinook salmon offspring survival
## Convert replicate-level recorded data to individual-level (binary) data
chinook_survival2&lt;- buildBinary(dat=chinook_survival,copy=c(1:6,9),one="alive",zero="dead")

#Delete-one
## Not run: survival_jack3&lt;- JackGlmer3(observ=chinook_survival2,dam="dam",sire="sire",
response="status",fam_link=binomial(link="logit""),remain="egg_size + (1|tray)")
## End(Not run)

#Delete-d, d=30
## Not run: survival_jack3.2&lt;- JackGlmer3(observ=chinook_survival2,dam="dam",sire="sire",
response="status",fam_link=binomial(link="logit""),remain="egg_size + (1|tray)",size=30)
## End(Not run)
</code></pre>

<hr>
<h2 id='JackLmer'>Jackknife components for normal data</h2><span id='topic+JackLmer'></span>

<h3>Description</h3>

<p>Extracts additive genetic, non-additive genetic, and maternal variance components
from a linear mixed-effect model using the <em>lmer</em> function of the <em>lme4</em> package.
Model random effects are dam, sire, and dam by sire.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>JackLmer(observ, dam, sire, response, ml = F, size = 1, first = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="JackLmer_+3A_observ">observ</code></td>
<td>
<p>Data frame of observed data.</p>
</td></tr>
<tr><td><code id="JackLmer_+3A_dam">dam</code></td>
<td>
<p>Column name containing dam (female) parent identity information.</p>
</td></tr>
<tr><td><code id="JackLmer_+3A_sire">sire</code></td>
<td>
<p>Column name containing sire (male) parent identity information.</p>
</td></tr>
<tr><td><code id="JackLmer_+3A_response">response</code></td>
<td>
<p>Column name containing the offspring (response) phenotype values.</p>
</td></tr>
<tr><td><code id="JackLmer_+3A_ml">ml</code></td>
<td>
<p>Default is FALSE for restricted maximum likelihood. Change to TRUE for maximum likelihood.</p>
</td></tr>
<tr><td><code id="JackLmer_+3A_size">size</code></td>
<td>
<p>Default is 1 for delete-one jackknife resampling. If <em>size</em> &gt; 1,
delete-<em>d</em> jackknife resampling occurs removing a block d equal to <em>size</em>.</p>
</td></tr>
<tr><td><code id="JackLmer_+3A_first">first</code></td>
<td>

<p>Number of initial sub-samples to run. Useful for examing if there is variation among
sub-samples before jackknife resampling the entire data set. There can be little variation for
delete-one jackknife resampling with large data sets, and delete-<em>d</em> jackknife resampling
should be considered.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Uses delete-one jackknife resampling (Efron &amp; Tibshirani 1993, p. 141-145). For the option of
delete-<em>d</em> jackknife resampling, the rows of the observed data frame are shuffled and a block of
observations of size <em>d</em> is deleted sequentially.
Extracts the dam, sire, dam, dam by sire, and residual variance components.
Calculates the total variance component. Calculates the additive genetic, non-additive genetic, and
maternal variance components (see Lynch and Walsh 1998, p. 603).
</p>


<h3>Value</h3>

<p>A data frame with columns containing the raw variance components for dam, sire, dam by sire,
residual, total, additive genetic, non-additive genetic, and maternal. The number of rows
in the data frame matches the total number of observations (<em>N</em>) for delete-one jackknife
resampling or <em>M</em> groups for delete-<em>d</em> jackknife resampling to the lowest integer.
Each row represents a deleted single observation or deleted <em>d</em> observations group.
</p>


<h3>Note</h3>

<p>Maximum likelihood (ML) estimates the parameters that maximize the likelihood of the observed data
and has the advantage of using all the data and accounting for non-independence (Lynch and Walsh 1998,
p. 779; Bolker et al. 2009). On the other hand, ML has the disadvantage of assuming that all fixed
effects are known without error, producing a downward bias in the estimation of the residual variance
component. This bias can be large if there are lots of fixed effects, especially if sample sizes are
small. Restricted maximum likelihood (REML) has the advantage of not assuming the fixed effects are
known and averages over the uncertainty, so there can be less bias in the estimation of the residual
variance component. However, REML only maximizes a portion of the likelihood to estimate the effect
parameters, but is the preferred method for analyzing large data sets with complex structure.
</p>


<h3>References</h3>

<p>Efron B, Tibshirani R. 1993. An introduction to the Bootstrap. Chapman and Hall, New York.
</p>
<p>Lynch M, Walsh B. 1998. Genetics and Analysis of Quantitative Traits. Sinauer Associates, Massachusetts.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+JackLmer2">JackLmer2</a></code>, <code><a href="#topic+JackLmer3">JackLmer3</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(chinook_length) #Chinook salmon offspring length

#Delete-one
#length_jack1&lt;- JackLmer(observ=chinook_length,dam="dam",sire="sire",response="length")
length_jack1&lt;- JackLmer(observ=chinook_length,dam="dam",sire="sire",response="length",
first=2) #first 2

#Delete-d, d=5
#length_jackD&lt;- JackLmer(observ=chinook_length,dam="dam",sire="sire",response="length",
#size=5)
length_jackD&lt;- JackLmer(observ=chinook_length,dam="dam",sire="sire",response="length",
size=5,first=2) #first 2
</code></pre>

<hr>
<h2 id='JackLmer2'>Jackknife components for normal data 2</h2><span id='topic+JackLmer2'></span>

<h3>Description</h3>

<p>Extracts additive genetic, non-additive genetic, and maternal variance components
from a linear mixed-effect model using the <em>lmer</em> function of the <em>lme4</em> package.
Model random effects are dam, sire, and dam by sire.
Options to include one random position and/or one random block effect(s).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>JackLmer2(observ, dam, sire, response, position = NULL, block = NULL, ml = F, size = 1,
first = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="JackLmer2_+3A_observ">observ</code></td>
<td>
<p>Data frame of observed data.</p>
</td></tr>
<tr><td><code id="JackLmer2_+3A_dam">dam</code></td>
<td>
<p>Column name containing dam (female) parent identity information.</p>
</td></tr>
<tr><td><code id="JackLmer2_+3A_sire">sire</code></td>
<td>
<p>Column name containing sire (male) parent identity information.</p>
</td></tr>
<tr><td><code id="JackLmer2_+3A_response">response</code></td>
<td>
<p>Column name containing the offspring (response) phenotype values.</p>
</td></tr>
<tr><td><code id="JackLmer2_+3A_position">position</code></td>
<td>
<p>Optional column name containing position factor information.</p>
</td></tr>
<tr><td><code id="JackLmer2_+3A_block">block</code></td>
<td>
<p>Optional column name containing block factor information.</p>
</td></tr>
<tr><td><code id="JackLmer2_+3A_ml">ml</code></td>
<td>
<p>Default is FALSE for restricted maximum likelihood. Change to TRUE for maximum likelihood.</p>
</td></tr>
<tr><td><code id="JackLmer2_+3A_size">size</code></td>
<td>
<p>Default is 1 for delete-one jackknife resampling. If <em>size</em> &gt; 1,
delete-<em>d</em> jackknife resampling occurs removing a block d equal to <em>size</em>.</p>
</td></tr>
<tr><td><code id="JackLmer2_+3A_first">first</code></td>
<td>

<p>Number of initial sub-samples to run. Useful for examing if there is variation among
sub-samples before jackknife resampling the entire data set. There can be little variation for
delete-one jackknife resampling with large data sets, and delete-<em>d</em> jackknife resampling
should be considered.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Uses delete-one jackknife resampling (Efron &amp; Tibshirani 1993, p. 141-145). For the option of
delete-<em>d</em> jackknife resampling, the rows of the observed data frame are shuffled and a block of
observations of size <em>d</em> is deleted sequentially.
Extracts the dam, sire, dam, dam by sire, and residual variance components.
Extracts optional position and block variance components.
Calculates the total variance component. Calculates the additive genetic, non-additive genetic, and
maternal variance components (see Lynch and Walsh 1998, p. 603).
</p>


<h3>Value</h3>

<p>A data frame with columns containing the raw variance components for dam, sire, dam by sire,
residual, total, additive genetic, non-additive genetic, and maternal. Also columns containing
the raw variance components for the options of position and/or block. The number of rows
in the data frame matches the total number of observations (<em>N</em>) for delete-one jackknife
resampling or <em>M</em> groups for delete-<em>d</em> jackknife resampling to the lowest integer.
Each row represents a deleted single observation or deleted <em>d</em> observations group.
</p>


<h3>Note</h3>

<p>Maximum likelihood (ML) estimates the parameters that maximize the likelihood of the observed data
and has the advantage of using all the data and accounting for non-independence (Lynch and Walsh 1998,
p. 779; Bolker et al. 2009). On the other hand, ML has the disadvantage of assuming that all fixed
effects are known without error, producing a downward bias in the estimation of the residual variance
component. This bias can be large if there are lots of fixed effects, especially if sample sizes are
small. Restricted maximum likelihood (REML) has the advantage of not assuming the fixed effects are
known and averages over the uncertainty, so there can be less bias in the estimation of the residual
variance component. However, REML only maximizes a portion of the likelihood to estimate the effect
parameters, but is the preferred method for analyzing large data sets with complex structure.
</p>


<h3>References</h3>

<p>Efron B, Tibshirani R. 1993. An introduction to the Bootstrap. Chapman and Hall, New York.
</p>
<p>Lynch M, Walsh B. 1998. Genetics and Analysis of Quantitative Traits. Sinauer Associates, Massachusetts.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+JackLmer">JackLmer</a></code>, <code><a href="#topic+JackLmer3">JackLmer3</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(chinook_length) #Chinook salmon offspring length

#Delete-one
#length_jack2&lt;- JackLmer2(observ=chinook_length,dam="dam",sire="sire",response="length",
#position="tray")
length_jack2&lt;- JackLmer2(observ=chinook_length,dam="dam",sire="sire",response="length",
position="tray",first=2) #first 2

#Delete-d, d=5
#length_jack2.2&lt;- JackLmer2(observ=chinook_length,dam="dam",sire="sire",response="length",
#position="tray",size=5)
length_jack2.2&lt;- JackLmer2(observ=chinook_length,dam="dam",sire="sire",response="length",
position="tray",size=5,first=2) #first 2
</code></pre>

<hr>
<h2 id='JackLmer3'>Jackknife components for normal data 3</h2><span id='topic+JackLmer3'></span>

<h3>Description</h3>

<p>Extracts additive genetic, non-additive genetic, and maternal variance components
from a linear mixed-effect model using the <em>lmer</em> function of the <em>lme4</em> package.
Model random effects are dam, sire, dam by sire, and any additional fixed and/or random effects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>JackLmer3(observ, dam, sire, response, remain, ml = F, size = 1, first = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="JackLmer3_+3A_observ">observ</code></td>
<td>
<p>Data frame of observed data</p>
</td></tr>
<tr><td><code id="JackLmer3_+3A_dam">dam</code></td>
<td>
<p>Column name containing dam (female) parent identity information.</p>
</td></tr>
<tr><td><code id="JackLmer3_+3A_sire">sire</code></td>
<td>
<p>Column name containing sire (male) parent identity information.</p>
</td></tr>
<tr><td><code id="JackLmer3_+3A_response">response</code></td>
<td>
<p>Column name containing the offspring (response) phenotype values.</p>
</td></tr>
<tr><td><code id="JackLmer3_+3A_remain">remain</code></td>
<td>
<p>Remaining formula using <em>lme4</em> package format.</p>
</td></tr>
<tr><td><code id="JackLmer3_+3A_ml">ml</code></td>
<td>
<p>Default is FALSE for restricted maximum likelihood. Change to TRUE for maximum likelihood.</p>
</td></tr>
<tr><td><code id="JackLmer3_+3A_size">size</code></td>
<td>
<p>Default is 1 for delete-one jackknife resampling. If <em>size</em> &gt; 1,
delete-<em>d</em> jackknife resampling occurs removing a block d equal to <em>size</em>.</p>
</td></tr>
<tr><td><code id="JackLmer3_+3A_first">first</code></td>
<td>

<p>Number of initial sub-samples to run. Useful for examing if there is variation among
sub-samples before jackknife resampling the entire data set. There can be little variation for
delete-one jackknife resampling with large data sets, and delete-<em>d</em> jackknife resampling
should be considered.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Uses delete-one jackknife resampling (Efron &amp; Tibshirani 1993, p. 141-145). For the option of
delete-<em>d</em> jackknife resampling, the rows of the observed data frame are shuffled and a block of
observations of size <em>d</em> is deleted sequentially.
Extracts the dam, sire, dam, dam by sire, and residual variance components.
Extracts any additional fixed effect and random effect variance components. The fixed-effect variance
component is as a single group using the method described by Nakagawa and Schielzeth (2013).
Calculates the total variance component. Calculates the additive genetic, non-additive genetic, and
maternal variance components (see Lynch and Walsh 1998, p. 603).
</p>


<h3>Value</h3>

<p>A data frame with columns containing the raw variance components for dam, sire, dam by sire,
residual, total, additive genetic, non-additive genetic, and maternal. Also columns containing
the raw variance components for remaining formula components. The number of rows
in the data frame matches the total number of observations (<em>N</em>) for delete-one jackknife
resampling or <em>M</em> groups for delete-<em>d</em> jackknife resampling to the lowest integer.
Each row represents a deleted single observation or deleted <em>d</em> observations group.
</p>


<h3>Note</h3>

<p>Maximum likelihood (ML) estimates the parameters that maximize the likelihood of the observed data
and has the advantage of using all the data and accounting for non-independence (Lynch and Walsh 1998,
p. 779; Bolker et al. 2009). On the other hand, ML has the disadvantage of assuming that all fixed
effects are known without error, producing a downward bias in the estimation of the residual variance
component. This bias can be large if there are lots of fixed effects, especially if sample sizes are
small. Restricted maximum likelihood (REML) has the advantage of not assuming the fixed effects are
known and averages over the uncertainty, so there can be less bias in the estimation of the residual
variance component. However, REML only maximizes a portion of the likelihood to estimate the effect
parameters, but is the preferred method for analyzing large data sets with complex structure.
</p>


<h3>References</h3>

<p>Efron B, Tibshirani R. 1993. An introduction to the Bootstrap. Chapman and Hall, New York.
</p>
<p>Lynch M, Walsh B. 1998. Genetics and Analysis of Quantitative Traits. Sinauer Associates, Massachusetts.
</p>
<p>Nakagawa S, Schielzeth H. 2013. A general and simple method for obtaining R2 from generalized linear
mixed-effects models. Methods in Ecology and Evolution 4(2): 133-142.
DOI: 10.1111/j.2041-210x.2012.00261.x
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+JackLmer">JackLmer</a></code>, <code><a href="#topic+JackLmer2">JackLmer2</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(chinook_length) #Chinook salmon offspring length

#Delete-one
#length_jack3&lt;- JackLmer3(observ=chinook_length,dam="dam",sire="sire",response="length",
#remain="egg_size + (1|tray)")
length_jack3&lt;- JackLmer3(observ=chinook_length,dam="dam",sire="sire",response="length",
remain="egg_size + (1|tray)",first=2) #first 2

#Delete-d, d=5
#length_jack3.2&lt;- JackLmer3(observ=chinook_length,dam="dam",sire="sire",response="length",
#remain="egg_size + (1|tray)",size=5)
length_jack3.2&lt;- JackLmer3(observ=chinook_length,dam="dam",sire="sire",response="length",
remain="egg_size + (1|tray)",size=5,first=2) #first 2
</code></pre>

<hr>
<h2 id='observGlmer'>Variance components for non-normal data</h2><span id='topic+observGlmer'></span>

<h3>Description</h3>

<p>Extracts additive genetic, non-additive genetic, and maternal variance components
from a generalized linear mixed-effect model using the <em>glmer</em> function of the <em>lme4</em> package.
Model random effects are dam, sire, and dam by sire.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>observGlmer(observ, dam, sire, response, fam_link, quasi = F)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="observGlmer_+3A_observ">observ</code></td>
<td>
<p>Data frame of observed data.</p>
</td></tr>
<tr><td><code id="observGlmer_+3A_dam">dam</code></td>
<td>
<p>Column name containing dam (female) parent identity information.</p>
</td></tr>
<tr><td><code id="observGlmer_+3A_sire">sire</code></td>
<td>
<p>Column name containing sire (male) parent identity information.</p>
</td></tr>
<tr><td><code id="observGlmer_+3A_response">response</code></td>
<td>
<p>Column name containing the offspring (response) phenotype values.</p>
</td></tr>
<tr><td><code id="observGlmer_+3A_fam_link">fam_link</code></td>
<td>

<p>The family and link in family(link) format. Supported options are binomial(link=&quot;logit&quot;), binomial(link=&quot;probit&quot;), poisson(link=&quot;log&quot;), and poisson(link=&quot;sqrt&quot;).
</p>
</td></tr>
<tr><td><code id="observGlmer_+3A_quasi">quasi</code></td>
<td>
<p>Incorporate overdispersion or quasi-error structure.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Laplace approximation parameter estimation is used, which is a true likelihood method (Bolker et al. 2009).
For the overdispersion option, an observation-level random effect is added to the model (Atkins et al. 2013).
Extracts the dam, sire, dam, and dam by sire variance components.
The residual variance component for the <em>fam_links</em> are described by Nakagawa and Schielzeth (2010, 2013).
Calculates the total variance component. Calculates the additive genetic, non-additive genetic, and
maternal variance components (see Lynch and Walsh 1998, p. 603).
Significance values for the random effects are determined using likelihood ratio tests (Bolker et al. 2009).
</p>


<h3>Value</h3>

<p>A list object containing the raw variance components, the variance components as a percentage
of the total variance component. Also, contains the difference in AIC and BIC, and likelihood ratio
test Chi-square and p-value for all random effects.
</p>


<h3>Note</h3>

<p>The Laplace approximation is used because there were fewer disadvantages relative to penalized
quasi-likelihood and Gauss-Hermite quadrature parameter estimation (Bolker et al. 2009).
That is, penalized quasi-likelihood is not recommended for count responses with means less than 5 and
binary responses with less than 5 successes per group. Gauss-Hermite quadrature is not recommended for
more than two or three random effects because of the rapidly declining analytical speed with the
increasing number of random effects.
</p>


<h3>References</h3>

<p>Atkins DC, Baldwin SA, Zheng C, Gallop RJ, Neighbors C. 2013. A tutorial on count regression and
zero-altered count models for longitudinal substance use data.
Psychology of Addictive Behaviors 27(1): 166-177. DOI: 10.1037/a0029508
</p>
<p>Bolker BM, Brooks ME, Clark CJ, Geange SW, Poulsen JR, Stevens MHH, White J-SS. 2009.
Generalized linear mixed models: a practical guide for ecology and evolution.
Trends in Ecology and Evolution 24(3): 127-135. DOI: 10.1016/j.tree.2008.10.008
</p>
<p>Lynch M, Walsh B. 1998. Genetics and Analysis of Quantitative Traits. Sinauer Associates, Massachusetts.
</p>
<p>Nakagawa S, Schielzeth H. 2010. Repeatability for Gaussian and non-Gaussian data: a practical guide for biologists.
Biological Reviews 85(4): 935-956. DOI: 10.1111/j.1469-185X.2010.00141.x
</p>
<p>Nakagawa S, Schielzeth H. 2013. A general and simple method for obtaining R2 from generalized linear mixed-effects models.
Methods in Ecology and Evolution 4(2): 133-142. DOI: 10.1111/j.2041-210x.2012.00261.x
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+observGlmer2">observGlmer2</a></code>, <code><a href="#topic+observGlmer3">observGlmer3</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(chinook_survival) #Chinook salmon offspring survival
## Convert replicate-level recorded data to individual-level (binary) data
chinook_survival2&lt;- buildBinary(dat=chinook_survival,copy=c(2:6,9),one="alive",zero="dead")
#
## Not run: survival_mod1&lt;- observGlmer(observ=chinook_survival2,dam="dam",sire="sire",
response="status",fam_link=binomial(link="logit"))  #a few minutes
survival_mod1
## End(Not run)
</code></pre>

<hr>
<h2 id='observGlmer2'>Variance components for non-normal data 2</h2><span id='topic+observGlmer2'></span>

<h3>Description</h3>

<p>Extracts additive genetic, non-additive genetic, and maternal variance components
from a generalized linear mixed-effect model using the <em>glmer</em> function of the <em>lme4</em> package.
Model random effects are dam, sire, and dam by sire.
Options to include one random position and/or one random block effect(s).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>observGlmer2(observ, dam, sire, response, fam_link, position = NULL, block = NULL,
quasi = F)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="observGlmer2_+3A_observ">observ</code></td>
<td>
<p>Data frame of observed data.</p>
</td></tr>
<tr><td><code id="observGlmer2_+3A_dam">dam</code></td>
<td>
<p>Column name containing dam (female) parent identity information.</p>
</td></tr>
<tr><td><code id="observGlmer2_+3A_sire">sire</code></td>
<td>
<p>Column name containing sire (male) parent identity information.</p>
</td></tr>
<tr><td><code id="observGlmer2_+3A_response">response</code></td>
<td>
<p>Column name containing the offspring (response) phenotype values.</p>
</td></tr>
<tr><td><code id="observGlmer2_+3A_fam_link">fam_link</code></td>
<td>

<p>The family and link in family(link) format. Supported options are binomial(link=&quot;logit&quot;), binomial(link=&quot;probit&quot;), poisson(link=&quot;log&quot;), and poisson(link=&quot;sqrt&quot;).
</p>
</td></tr>
<tr><td><code id="observGlmer2_+3A_position">position</code></td>
<td>
<p>Optional column name containing position factor information.</p>
</td></tr>
<tr><td><code id="observGlmer2_+3A_block">block</code></td>
<td>
<p>Optional column name containing block factor information.</p>
</td></tr>
<tr><td><code id="observGlmer2_+3A_quasi">quasi</code></td>
<td>
<p>Incorporate overdispersion or quasi-error structure.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Laplace approximation parameter estimation is used, which is a true likelihood method (Bolker et al. 2009).
For the overdispersion option, an observation-level random effect is added to the model (Atkins et al. 2013).
Extracts the dam, sire, dam, and dam by sire variance components.
Extracts optional position and block variance components.
The residual variance component for the <em>fam_links</em> are described by Nakagawa and Schielzeth (2010, 2013).
Calculates the total variance component. Calculates the additive genetic, non-additive genetic, and
maternal variance components (see Lynch and Walsh 1998, p. 603).
Significance values for the random effects are determined using likelihood ratio tests (Bolker et al. 2009).
</p>


<h3>Value</h3>

<p>A list object containing the raw variance components, the variance components as a percentage
of the total variance component. Also, contains the difference in AIC and BIC, and likelihood ratio
test Chi-square and p-value for all random effects.
</p>


<h3>Note</h3>

<p>The Laplace approximation is used because there were fewer disadvantages relative to penalized
quasi-likelihood and Gauss-Hermite quadrature parameter estimation (Bolker et al. 2009).
That is, penalized quasi-likelihood is not recommended for count responses with means less than 5 and
binary responses with less than 5 successes per group. Gauss-Hermite quadrature is not recommended for
more than two or three random effects because of the rapidly declining analytical speed with the
increasing number of random effects.
</p>


<h3>References</h3>

<p>Atkins DC, Baldwin SA, Zheng C, Gallop RJ, Neighbors C. 2013. A tutorial on count regression and
zero-altered count models for longitudinal substance use data.
Psychology of Addictive Behaviors 27(1): 166-177. DOI: 10.1037/a0029508
</p>
<p>Bolker BM, Brooks ME, Clark CJ, Geange SW, Poulsen JR, Stevens MHH, White J-SS. 2009.
Generalized linear mixed models: a practical guide for ecology and evolution.
Trends in Ecology and Evolution 24(3): 127-135. DOI: 10.1016/j.tree.2008.10.008
</p>
<p>Lynch M, Walsh B. 1998. Genetics and Analysis of Quantitative Traits. Sinauer Associates, Massachusetts.
</p>
<p>Nakagawa S, Schielzeth H. 2010. Repeatability for Gaussian and non-Gaussian data: a practical guide for biologists.
Biological Reviews 85(4): 935-956. DOI: 10.1111/j.1469-185X.2010.00141.x
</p>
<p>Nakagawa S, Schielzeth H. 2013. A general and simple method for obtaining R2 from generalized linear mixed-effects models.
Methods in Ecology and Evolution 4(2): 133-142. DOI: 10.1111/j.2041-210x.2012.00261.x
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+observGlmer">observGlmer</a></code>, <code><a href="#topic+observGlmer3">observGlmer3</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(chinook_survival) #Chinook salmon offspring survival
## Convert replicate-level recorded data to individual-level (binary) data
chinook_survival2&lt;- buildBinary(dat=chinook_survival,copy=c(2:6,9),one="alive",zero="dead")
#
## Not run: survival_mod2&lt;- observGlmer2(observ=chinook_survival2,dam="dam",sire="sire",
response="status",fam_link=binomial(link="logit"),position="tray")  #a few minutes
survival_mod2
## End(Not run)
</code></pre>

<hr>
<h2 id='observGlmer3'>Variance components for non-normal data 3</h2><span id='topic+observGlmer3'></span>

<h3>Description</h3>

<p>Extracts additive genetic, non-additive genetic, and maternal variance components
from a generalized linear mixed-effect model using the <em>glmer</em> function of the <em>lme4</em> package.
Model random effects are dam, sire, dam by sire, and any additional fixed and/or random effects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>observGlmer3(observ, dam, sire, response, fam_link, remain, quasi = F, iter = 1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="observGlmer3_+3A_observ">observ</code></td>
<td>
<p>Data frame of observed data.</p>
</td></tr>
<tr><td><code id="observGlmer3_+3A_dam">dam</code></td>
<td>
<p>Column name containing dam (female) parent identity information.</p>
</td></tr>
<tr><td><code id="observGlmer3_+3A_sire">sire</code></td>
<td>
<p>Column name containing sire (male) parent identity information.</p>
</td></tr>
<tr><td><code id="observGlmer3_+3A_response">response</code></td>
<td>
<p>Column name containing the offspring (response) phenotype values.</p>
</td></tr>
<tr><td><code id="observGlmer3_+3A_fam_link">fam_link</code></td>
<td>

<p>The family and link in family(link) format. Supported options are binomial(link=&quot;logit&quot;), binomial(link=&quot;probit&quot;), poisson(link=&quot;log&quot;), and poisson(link=&quot;sqrt&quot;).
</p>
</td></tr>
<tr><td><code id="observGlmer3_+3A_remain">remain</code></td>
<td>
<p>Remaining formula using <em>lme4</em> package format.</p>
</td></tr>
<tr><td><code id="observGlmer3_+3A_quasi">quasi</code></td>
<td>
<p>Incorporate overdispersion or quasi-error structure.</p>
</td></tr>
<tr><td><code id="observGlmer3_+3A_iter">iter</code></td>
<td>
<p>Number of iterations for computing the parametric bootstrap significance value
for any fixed effects.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Laplace approximation parameter estimation is used, which is a true likelihood method (Bolker et al. 2009).
For the overdispersion option, an observation-level random effect is added to the model (Atkins et al. 2013).
Extracts the dam, sire, dam, and dam by sire variance components.
Extracts any additional fixed effect and random effect variance components. The fixed-effect variance
component is as a single group using the method described by Nakagawa and Schielzeth (2013).
The residual variance component for the <em>fam_links</em> are described by Nakagawa and Schielzeth (2010, 2013).
Calculates the total variance component. Calculates the additive genetic, non-additive genetic, and
maternal variance components (see Lynch and Walsh 1998, p. 603).
Significance values for the random effects are determined using likelihood ratio tests (Bolker et al. 2009).
Significance values for any fixed effects are determined using likelihood ratio tests and a parametric
bootstrap method (Bolker et al. 2009) from the <em>mixed</em> function of the <em>afex</em> package.
</p>


<h3>Value</h3>

<p>A list object containing the raw variance components, the variance components as a percentage
of the total variance component. Contains the difference in AIC and BIC, likelihood ratio
test Chi-square and p-value for random and/or fixed effects. Also contains the parametric
bootstrap Chi-square and p-value for any fixed effects.
</p>


<h3>Note</h3>

<p>The Laplace approximation is used because there were fewer disadvantages relative to penalized
quasi-likelihood and Gauss-Hermite quadrature parameter estimation (Bolker et al. 2009).
That is, penalized quasi-likelihood is not recommended for count responses with means less than 5 and
binary responses with less than 5 successes per group. Gauss-Hermite quadrature is not recommended for
more than two or three random effects because of the rapidly declining analytical speed with the
increasing number of random effects.
</p>


<h3>References</h3>

<p>Atkins DC, Baldwin SA, Zheng C, Gallop RJ, Neighbors C. 2013. A tutorial on count regression and
zero-altered count models for longitudinal substance use data.
Psychology of Addictive Behaviors 27(1): 166-177. DOI: 10.1037/a0029508
</p>
<p>Bolker BM, Brooks ME, Clark CJ, Geange SW, Poulsen JR, Stevens MHH, White J-SS. 2009.
Generalized linear mixed models: a practical guide for ecology and evolution.
Trends in Ecology and Evolution 24(3): 127-135. DOI: 10.1016/j.tree.2008.10.008
</p>
<p>Lynch M, Walsh B. 1998. Genetics and Analysis of Quantitative Traits. Sinauer Associates, Massachusetts.
</p>
<p>Nakagawa S, Schielzeth H. 2010. Repeatability for Gaussian and non-Gaussian data: a practical guide for biologists.
Biological Reviews 85(4): 935-956. DOI: 10.1111/j.1469-185X.2010.00141.x
</p>
<p>Nakagawa S, Schielzeth H. 2013. A general and simple method for obtaining R2 from generalized linear mixed-effects models.
Methods in Ecology and Evolution 4(2): 133-142. DOI: 10.1111/j.2041-210x.2012.00261.x
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+observGlmer">observGlmer</a></code>, <code><a href="#topic+observGlmer2">observGlmer2</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(chinook_survival) #Chinook salmon offspring survival
## Convert replicate-level recorded data to individual-level (binary) data
chinook_survival2&lt;- buildBinary(dat=chinook_survival,copy=c(2:6,9),one="alive",zero="dead")
#just a few iterations for the p-value of fixed effect
## Not run: survival_mod3&lt;- observGlmer3(observ=chinook_survival2,dam="dam",sire="sire",
response="status",fam_link=binomial(link="logit"),remain="egg_size + (1|tray)",iter=5)
survival_mod3
## End(Not run)
</code></pre>

<hr>
<h2 id='observLmer'>Variance components for normal data</h2><span id='topic+observLmer'></span>

<h3>Description</h3>

<p>Extracts additive genetic, non-additive genetic, and maternal variance components
from a linear mixed-effect model using the <em>lmer</em> function of the <em>lme4</em> package.
Model random effects are dam, sire, and dam by sire.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>observLmer(observ, dam, sire, response, ml = F)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="observLmer_+3A_observ">observ</code></td>
<td>
<p>Data frame of observed data.</p>
</td></tr>
<tr><td><code id="observLmer_+3A_dam">dam</code></td>
<td>
<p>Column name containing dam (female) parent identity information.</p>
</td></tr>
<tr><td><code id="observLmer_+3A_sire">sire</code></td>
<td>
<p>Column name containing sire (male) parent identity information.</p>
</td></tr>
<tr><td><code id="observLmer_+3A_response">response</code></td>
<td>
<p>Column name containing the offspring (response) phenotype values.</p>
</td></tr>
<tr><td><code id="observLmer_+3A_ml">ml</code></td>
<td>
<p>Default is FALSE for restricted maximum likelihood. Change to TRUE for maximum likelihood.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Extracts the dam, sire, dam, dam by sire, and residual variance components.
Calculates the total variance component. Calculates the additive genetic, non-additive genetic, and
maternal variance components (see Lynch and Walsh 1998, p. 603).
Significance values for the random effects are determined using likelihood ratio tests (Bolker et al. 2009).
</p>


<h3>Value</h3>

<p>A list object containing the raw variance components, the variance components as a percentage
of the total variance component. Also, contains the difference in AIC and BIC, and likelihood ratio
test Chi-square and p-value for all random effects.
</p>


<h3>Note</h3>

<p>Maximum likelihood (ML) estimates the parameters that maximize the likelihood of the observed data
and has the advantage of using all the data and accounting for non-independence (Lynch and Walsh 1998,
p. 779; Bolker et al. 2009). On the other hand, ML has the disadvantage of assuming that all fixed
effects are known without error, producing a downward bias in the estimation of the residual variance
component. This bias can be large if there are lots of fixed effects, especially if sample sizes are
small. Restricted maximum likelihood (REML) has the advantage of not assuming the fixed effects are
known and averages over the uncertainty, so there can be less bias in the estimation of the residual
variance component. However, REML only maximizes a portion of the likelihood to estimate the effect
parameters, but is the preferred method for analyzing large data sets with complex structure.
</p>


<h3>References</h3>

<p>Bolker BM, Brooks ME, Clark CJ, Geange SW, Poulsen JR, Stevens MHH, White J-SS. 2009.
Generalized linear mixed models: a practical guide for ecology and evolution.
Trends in Ecology and Evolution 24(3): 127-135. DOI: 10.1016/j.tree.2008.10.008
</p>
<p>Lynch M, Walsh B. 1998. Genetics and Analysis of Quantitative Traits. Sinauer Associates, Massachusetts.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+observLmer2">observLmer2</a></code>, <code><a href="#topic+observLmer3">observLmer3</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(chinook_length) #Chinook salmon offspring length
length_mod1&lt;- observLmer(observ=chinook_length,dam="dam",sire="sire",response="length")
length_mod1
</code></pre>

<hr>
<h2 id='observLmer2'>Variance components for normal data 2</h2><span id='topic+observLmer2'></span>

<h3>Description</h3>

<p>Extracts additive genetic, non-additive genetic, and maternal variance components
from a linear mixed-effect model using the <em>lmer</em> function of the <em>lme4</em> package.
Model random effects are dam, sire, and dam by sire.
Options to include one random position and/or one random block effect(s).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>observLmer2(observ, dam, sire, response, position = NULL, block = NULL, ml = F)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="observLmer2_+3A_observ">observ</code></td>
<td>
<p>Data frame of observed data.</p>
</td></tr>
<tr><td><code id="observLmer2_+3A_dam">dam</code></td>
<td>
<p>Column name containing dam (female) parent identity information.</p>
</td></tr>
<tr><td><code id="observLmer2_+3A_sire">sire</code></td>
<td>
<p>Column name containing sire (male) parent identity information.</p>
</td></tr>
<tr><td><code id="observLmer2_+3A_response">response</code></td>
<td>
<p>Column name containing the offspring (response) phenotype values.</p>
</td></tr>
<tr><td><code id="observLmer2_+3A_position">position</code></td>
<td>
<p>Optional column name containing position factor information.</p>
</td></tr>
<tr><td><code id="observLmer2_+3A_block">block</code></td>
<td>
<p>Optional column name containing block factor information.</p>
</td></tr>
<tr><td><code id="observLmer2_+3A_ml">ml</code></td>
<td>
<p>Default is FALSE for restricted maximum likelihood. Change to TRUE for maximum likelihood.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Extracts the dam, sire, dam, dam by sire, and residual variance components.
Extracts optional position and block variance components.
Calculates the total variance component. Calculates the additive genetic, non-additive genetic, and
maternal variance components (see Lynch and Walsh 1998, p. 603).
Significance values for the random effects are determined using likelihood ratio tests (Bolker et al. 2009).
</p>


<h3>Value</h3>

<p>A list object containing the raw variance components, the variance components as a percentage
of the total variance component. Also, contains the difference in AIC and BIC, and likelihood ratio
test Chi-square and p-value for all random effects.
</p>


<h3>Note</h3>

<p>Maximum likelihood (ML) estimates the parameters that maximize the likelihood of the observed data
and has the advantage of using all the data and accounting for non-independence (Lynch and Walsh 1998,
p. 779; Bolker et al. 2009). On the other hand, ML has the disadvantage of assuming that all fixed
effects are known without error, producing a downward bias in the estimation of the residual variance
component. This bias can be large if there are lots of fixed effects, especially if sample sizes are
small. Restricted maximum likelihood (REML) has the advantage of not assuming the fixed effects are
known and averages over the uncertainty, so there can be less bias in the estimation of the residual
variance component. However, REML only maximizes a portion of the likelihood to estimate the effect
parameters, but is the preferred method for analyzing large data sets with complex structure.
</p>


<h3>References</h3>

<p>Bolker BM, Brooks ME, Clark CJ, Geange SW, Poulsen JR, Stevens MHH, White J-SS. 2009.
Generalized linear mixed models: a practical guide for ecology and evolution.
Trends in Ecology and Evolution 24(3): 127-135. DOI: 10.1016/j.tree.2008.10.008
</p>
<p>Lynch M, Walsh B. 1998. Genetics and Analysis of Quantitative Traits. Sinauer Associates, Massachusetts.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+observLmer">observLmer</a></code>, <code><a href="#topic+observLmer3">observLmer3</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(chinook_length) #Chinook salmon offspring length
length_mod2&lt;- observLmer2(observ=chinook_length,dam="dam",sire="sire",response="length",
position="tray")
length_mod2
</code></pre>

<hr>
<h2 id='observLmer3'>Variance components for normal data 3</h2><span id='topic+observLmer3'></span>

<h3>Description</h3>

<p>Extracts additive genetic, non-additive genetic, and maternal variance components
from a linear mixed-effect model using the <em>lmer</em> function of the <em>lme4</em> package.
Model random effects are dam, sire, dam by sire, and any additional fixed and/or random effects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>observLmer3(observ, dam, sire, response, remain, ml = F, iter = 1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="observLmer3_+3A_observ">observ</code></td>
<td>
<p>Data frame of observed data.</p>
</td></tr>
<tr><td><code id="observLmer3_+3A_dam">dam</code></td>
<td>
<p>Column name containing dam (female) parent identity information.</p>
</td></tr>
<tr><td><code id="observLmer3_+3A_sire">sire</code></td>
<td>
<p>Column name containing sire (male) parent identity information.</p>
</td></tr>
<tr><td><code id="observLmer3_+3A_response">response</code></td>
<td>
<p>Column name containing the offspring (response) phenotype values.</p>
</td></tr>
<tr><td><code id="observLmer3_+3A_remain">remain</code></td>
<td>
<p>Remaining formula using <em>lme4</em> package format.</p>
</td></tr>
<tr><td><code id="observLmer3_+3A_ml">ml</code></td>
<td>
<p>Default is FALSE for restricted maximum likelihood. Change to TRUE for maximum likelihood.</p>
</td></tr>
<tr><td><code id="observLmer3_+3A_iter">iter</code></td>
<td>
<p>Number of iterations for computing the parametric bootstrap significance value
for any fixed effects.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Extracts the dam, sire, dam, dam by sire, and residual variance components.
Extracts any additional fixed effect and random effect variance components. The fixed-effect variance
component is as a single group using the method described by Nakagawa and Schielzeth (2013).
Calculates the total variance component. Calculates the additive genetic, non-additive genetic, and
maternal variance components (see Lynch and Walsh 1998, p. 603).
Significance values for the random effects are determined using likelihood ratio tests (Bolker et al. 2009).
Significance values for any fixed effects are determined using likelihood ratio tests and a parametric
bootstrap method (Bolker et al. 2009) from the <em>mixed</em> function of the <em>afex</em> package.
</p>


<h3>Value</h3>

<p>A list object containing the raw variance components, the variance components as a percentage
of the total variance component. Contains the difference in AIC and BIC, likelihood ratio
test Chi-square and p-value for random and/or fixed effects. Also contains the parametric
bootstrap Chi-square and p-value for any fixed effects.
</p>


<h3>Note</h3>

<p>Maximum likelihood (ML) estimates the parameters that maximize the likelihood of the observed data
and has the advantage of using all the data and accounting for non-independence (Lynch and Walsh 1998,
p. 779; Bolker et al. 2009). On the other hand, ML has the disadvantage of assuming that all fixed
effects are known without error, producing a downward bias in the estimation of the residual variance
component. This bias can be large if there are lots of fixed effects, especially if sample sizes are
small. Restricted maximum likelihood (REML) has the advantage of not assuming the fixed effects are
known and averages over the uncertainty, so there can be less bias in the estimation of the residual
variance component. However, REML only maximizes a portion of the likelihood to estimate the effect
parameters, but is the preferred method for analyzing large data sets with complex structure.
</p>


<h3>References</h3>

<p>Bolker BM, Brooks ME, Clark CJ, Geange SW, Poulsen JR, Stevens MHH, White J-SS. 2009.
Generalized linear mixed models: a practical guide for ecology and evolution.
Trends in Ecology and Evolution 24(3): 127-135. DOI: 10.1016/j.tree.2008.10.008
</p>
<p>Lynch M, Walsh B. 1998. Genetics and Analysis of Quantitative Traits. Sinauer Associates, Massachusetts.
</p>
<p>Nakagawa S, Schielzeth H. 2013. A general and simple method for obtaining R2 from generalized linear
mixed-effects models. Methods in Ecology and Evolution 4(2): 133-142.
DOI: 10.1111/j.2041-210x.2012.00261.x
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+observLmer">observLmer</a></code>, <code><a href="#topic+observLmer2">observLmer2</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(chinook_length) #Chinook salmon offspring length
#just a few iterations for the p-value of fixed effect
length_mod3&lt;- observLmer3(observ=chinook_length,dam="dam",sire="sire",response="length",
remain="egg_size + (1|tray)",iter=5)
length_mod3
</code></pre>

<hr>
<h2 id='powerGlmer'>Power analysis for non-normal data</h2><span id='topic+powerGlmer'></span>

<h3>Description</h3>

<p>Extracts the power values of dam, sire, and dam by sire variance components from a
generalized linear mixed-effect model using the <em>glmer</em> function of the
<em>lme4</em> package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>powerGlmer(varcomp, nval, fam_link, alpha = 0.05, nsim = 100, poisLog = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="powerGlmer_+3A_varcomp">varcomp</code></td>
<td>
<p>Vector of known dam, sire, and dam by sire variance components, i.e. c(dam, sire, dam x sire).</p>
</td></tr>
<tr><td><code id="powerGlmer_+3A_nval">nval</code></td>
<td>
<p>Vector of known dam, sire, and offspring per family sample sizes, i.e. c(dam, sire, offspring).</p>
</td></tr>
<tr><td><code id="powerGlmer_+3A_fam_link">fam_link</code></td>
<td>
<p>The family and link in family(link) format. Supported options are binomial(link=&quot;logit&quot;), binomial(link=&quot;probit&quot;), poisson(link=&quot;log&quot;), and poisson(link=&quot;sqrt&quot;).</p>
</td></tr>
<tr><td><code id="powerGlmer_+3A_alpha">alpha</code></td>
<td>
<p>Statistical significance value. Default is 0.05.</p>
</td></tr>
<tr><td><code id="powerGlmer_+3A_nsim">nsim</code></td>
<td>
<p>Number of simulations. Default is 100.</p>
</td></tr>
<tr><td><code id="powerGlmer_+3A_poislog">poisLog</code></td>
<td>
<p>The residual variance component value if using poisson(link=&quot;log&quot;).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Extracts the dam, sire, dam, and dam by sire power values.
The residual variance component for the <em>fam_links</em> are described by Nakagawa and Schielzeth (2010, 2013).
Power values are calculated by stochastically simulation data and then calculating the proportion of
significance values less than <em>alpha</em> for each component (Bolker 2008).
Significance values for the random effects are determined using likelihood ratio tests (Bolker et al. 2009).
</p>


<h3>Value</h3>

<p>Prints a data frame with the sample sizes, variance component inputs, variance component outputs, and power values.
</p>


<h3>Note</h3>

<p>The Laplace approximation is used because there were fewer disadvantages relative to penalized
quasi-likelihood and Gauss-Hermite quadrature parameter estimation (Bolker et al. 2009).
That is, penalized quasi-likelihood is not recommended for count responses with means less than 5 and
binary responses with less than 5 successes per group. Gauss-Hermite quadrature is not recommended for
more than two or three random effects because of the rapidly declining analytical speed with the
increasing number of random effects.
</p>


<h3>References</h3>

<p>Bolker BM. 2008. Ecological models and data in R. Princeton University Press, New Jersey.
</p>
<p>Bolker BM, Brooks ME, Clark CJ, Geange SW, Poulsen JR, Stevens MHH, White J-SS. 2009.
Generalized linear mixed models: a practical guide for ecology and evolution.
Trends in Ecology and Evolution 24(3): 127-135. DOI: 10.1016/j.tree.2008.10.008
</p>
<p>Lynch M, Walsh B. 1998. Genetics and Analysis of Quantitative Traits. Sinauer Associates, Massachusetts.
</p>
<p>Nakagawa S, Schielzeth H. 2010. Repeatability for Gaussian and non-Gaussian data: a practical guide for biologists.
Biological Reviews 85(4): 935-956. DOI: 10.1111/j.1469-185X.2010.00141.x
</p>
<p>Nakagawa S, Schielzeth H. 2013. A general and simple method for obtaining R2 from generalized linear mixed-effects models.
Methods in Ecology and Evolution 4(2): 133-142. DOI: 10.1111/j.2041-210x.2012.00261.x
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+powerGlmer2">powerGlmer2</a></code>, <code><a href="#topic+powerGlmer3">powerGlmer3</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>#100 simulations
## Not run: powerGlmer(varcomp=c(0.7930,0.1664,0.1673),nval=c(11,11,300),
fam_link=binomial(link="logit))
## End(Not run)
</code></pre>

<hr>
<h2 id='powerGlmer2'>Power analysis for non-normal data 2</h2><span id='topic+powerGlmer2'></span>

<h3>Description</h3>

<p>Extracts the power values of dam, sire, and dam by sire variance components from a
generalized linear mixed-effect model using the <em>glmer</em> function of the <em>lme4</em>
package. Options to include one random position and/or one random block effect(s).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>powerGlmer2(varcomp, nval, fam_link, alpha = 0.05, nsim = 100, position = NULL,
block = NULL, poisLog = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="powerGlmer2_+3A_varcomp">varcomp</code></td>
<td>
<p>Vector of known dam, sire, dam by sire, and position and/or
block variance components, i.e. c(dam, sire, dam x sire, position/block). If there is a
position and a block c(..., dam x sire, position, block).</p>
</td></tr>
<tr><td><code id="powerGlmer2_+3A_nval">nval</code></td>
<td>
<p>Vector of known dam, sire, offspring per family, and offspring per position or number of blocks
sample sizes, i.e. c(dam, sire, offspring, position/block). If there is a position and a
block c(..., offspring, position, block).</p>
</td></tr>
<tr><td><code id="powerGlmer2_+3A_fam_link">fam_link</code></td>
<td>
<p>The family and link in family(link) format. Supported options are binomial(link=&quot;logit&quot;), binomial(link=&quot;probit&quot;), poisson(link=&quot;log&quot;), and poisson(link=&quot;sqrt&quot;).</p>
</td></tr>
<tr><td><code id="powerGlmer2_+3A_alpha">alpha</code></td>
<td>
<p>Statistical significance value. Default is 0.05.</p>
</td></tr>
<tr><td><code id="powerGlmer2_+3A_nsim">nsim</code></td>
<td>
<p>Number of simulations. Default is 100.</p>
</td></tr>
<tr><td><code id="powerGlmer2_+3A_position">position</code></td>
<td>
<p>Optional number of positions.</p>
</td></tr>
<tr><td><code id="powerGlmer2_+3A_block">block</code></td>
<td>
<p>Optional vector of dams and sires per block, e.g. c(2,2).</p>
</td></tr>
<tr><td><code id="powerGlmer2_+3A_poislog">poisLog</code></td>
<td>
<p>The residual variance component value if using poisson(link=&quot;log&quot;).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Extracts the dam, sire, dam, dam by sire, and position and/or block power values.
The residual variance component for the <em>fam_links</em> are described by Nakagawa and Schielzeth (2010, 2013).
Power values are calculated by stochastically simulation data and then calculating the proportion of
significance values less than <em>alpha</em> for each component (Bolker 2008).
Significance values for the random effects are determined using likelihood ratio tests (Bolker et al. 2009).
</p>


<h3>Value</h3>

<p>Prints a data frame with the sample sizes, variance component inputs, variance component outputs, and power values.
</p>


<h3>Note</h3>

<p>The Laplace approximation is used because there were fewer disadvantages relative to penalized
quasi-likelihood and Gauss-Hermite quadrature parameter estimation (Bolker et al. 2009).
That is, penalized quasi-likelihood is not recommended for count responses with means less than 5 and
binary responses with less than 5 successes per group. Gauss-Hermite quadrature is not recommended for
more than two or three random effects because of the rapidly declining analytical speed with the
increasing number of random effects.
</p>


<h3>References</h3>

<p>Bolker BM. 2008. Ecological models and data in R. Princeton University Press, New Jersey.
</p>
<p>Bolker BM, Brooks ME, Clark CJ, Geange SW, Poulsen JR, Stevens MHH, White J-SS. 2009.
Generalized linear mixed models: a practical guide for ecology and evolution.
Trends in Ecology and Evolution 24(3): 127-135. DOI: 10.1016/j.tree.2008.10.008
</p>
<p>Lynch M, Walsh B. 1998. Genetics and Analysis of Quantitative Traits. Sinauer Associates, Massachusetts.
</p>
<p>Nakagawa S, Schielzeth H. 2010. Repeatability for Gaussian and non-Gaussian data: a practical guide for biologists.
Biological Reviews 85(4): 935-956. DOI: 10.1111/j.1469-185X.2010.00141.x
</p>
<p>Nakagawa S, Schielzeth H. 2013. A general and simple method for obtaining R2 from generalized linear mixed-effects models.
Methods in Ecology and Evolution 4(2): 133-142. DOI: 10.1111/j.2041-210x.2012.00261.x
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+powerGlmer">powerGlmer</a></code>, <code><a href="#topic+powerGlmer3">powerGlmer3</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>#100 simulations
## Not run: powerGlmer2(varcomp=c(0.7880,0.1667,0.1671,0.0037),nval=c(11,11,300,3300),
position=11,fam_link=binomial(link="logit")) 
## End(Not run)
</code></pre>

<hr>
<h2 id='powerGlmer3'>Power analysis for non-normal data 3</h2><span id='topic+powerGlmer3'></span>

<h3>Description</h3>

<p>Extracts the power values of dam, sire, and dam by sire variance components from a
generalized linear mixed-effect model using the <em>glmer</em> function of the
<em>lme4</em> package. Model can include additional fixed and/or random effects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>powerGlmer3(var_rand, n_rand, design, remain, fam_link, var_fix = NULL, n_fix = NULL,
 alpha = 0.05, nsim = 100, poisLog = NULL, ftest = "LR", iter = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="powerGlmer3_+3A_var_rand">var_rand</code></td>
<td>
<p>Vector of known dam, sire, dam by sire, and remaining random
variance components, i.e. c(dam,sire, dam by sire, rand1, rand2, etc.).</p>
</td></tr>
<tr><td><code id="powerGlmer3_+3A_n_rand">n_rand</code></td>
<td>
<p>Vector of known dam, sire, family, and remaining random sample sizes,
i.e. c(dam, sire, family, rand1, rand2,etc.).</p>
</td></tr>
<tr><td><code id="powerGlmer3_+3A_design">design</code></td>
<td>
<p>A data frame of the experimental design, using only integers. First
three columns must contain and be named &quot;dam&quot;, &quot;sire&quot;, &quot;family&quot;. Remaining columns are
the random effects followed by the fixed effects. Continuous fixed effects are a column
containing the values 1:nrow(design).</p>
</td></tr>
<tr><td><code id="powerGlmer3_+3A_remain">remain</code></td>
<td>
<p>Remaining formula using <em>lme4</em> package format. Must be random effects
followed by fixed effects. No interactions or random slopes; formulate as intercepts in design.</p>
</td></tr>
<tr><td><code id="powerGlmer3_+3A_fam_link">fam_link</code></td>
<td>
<p>The family and link in family(link) format. Supported options are binomial(link=&quot;logit&quot;), binomial(link=&quot;probit&quot;), poisson(link=&quot;log&quot;), and poisson(link=&quot;sqrt&quot;).</p>
</td></tr>
<tr><td><code id="powerGlmer3_+3A_var_fix">var_fix</code></td>
<td>
<p>Vector of known fixed variance components, i.e. c(fix1, fix2, etc.).
Continous fixed random values are sorted to match column values.</p>
</td></tr>
<tr><td><code id="powerGlmer3_+3A_n_fix">n_fix</code></td>
<td>
<p>Vector of known fixed sample sizes, i.e. c(fix1, fix2, etc.). Continuous fixed
effects must have a sample size of 1.</p>
</td></tr>
<tr><td><code id="powerGlmer3_+3A_alpha">alpha</code></td>
<td>
<p>Statistical significance value. Default is 0.05.</p>
</td></tr>
<tr><td><code id="powerGlmer3_+3A_nsim">nsim</code></td>
<td>
<p>Number of simulations. Default is 100.</p>
</td></tr>
<tr><td><code id="powerGlmer3_+3A_poislog">poisLog</code></td>
<td>
<p>The residual variance component value if using poisson(link=&quot;log&quot;).</p>
</td></tr>
<tr><td><code id="powerGlmer3_+3A_ftest">ftest</code></td>
<td>
<p>Default is &quot;LR&quot; for likelihood ratio test for fixed effects. Option &quot;PB&quot; is for parametric
bootstrap.</p>
</td></tr>
<tr><td><code id="powerGlmer3_+3A_iter">iter</code></td>
<td>
<p>Number of iterations for computing the parametric bootstrap significance value
for any fixed effects.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Extracts the dam, sire, dam, dam by sire, and any remaining random and fixed effects power values.
The residual variance component for the <em>fam_links</em> are described by Nakagawa and Schielzeth (2010, 2013).
Power values are calculated by stochastically simulation data and then calculating the proportion of
significance values less than <em>alpha</em> for each component (Bolker 2008).
Significance values for the random effects are determined using likelihood ratio tests (Bolker et al. 2009).
Significance values for any fixed effects are determined using likelihood ratio tests or parametric
bootstrap method (Bolker et al. 2009) from the <em>mixed</em> function of the <em>afex</em> package.
</p>


<h3>Value</h3>

<p>Prints a data frame with the sample sizes, variance component inputs, variance component outputs, and power values.
</p>


<h3>Note</h3>

<p>The Laplace approximation is used because there were fewer disadvantages relative to penalized
quasi-likelihood and Gauss-Hermite quadrature parameter estimation (Bolker et al. 2009).
That is, penalized quasi-likelihood is not recommended for count responses with means less than 5 and
binary responses with less than 5 successes per group. Gauss-Hermite quadrature is not recommended for
more than two or three random effects because of the rapidly declining analytical speed with the
increasing number of random effects.
</p>


<h3>References</h3>

<p>Bolker BM. 2008. Ecological models and data in R. Princeton University Press, New Jersey.
</p>
<p>Bolker BM, Brooks ME, Clark CJ, Geange SW, Poulsen JR, Stevens MHH, White J-SS. 2009.
Generalized linear mixed models: a practical guide for ecology and evolution.
Trends in Ecology and Evolution 24(3): 127-135. DOI: 10.1016/j.tree.2008.10.008
</p>
<p>Lynch M, Walsh B. 1998. Genetics and Analysis of Quantitative Traits. Sinauer Associates, Massachusetts.
</p>
<p>Nakagawa S, Schielzeth H. 2010. Repeatability for Gaussian and non-Gaussian data: a practical guide for biologists.
Biological Reviews 85(4): 935-956. DOI: 10.1111/j.1469-185X.2010.00141.x
</p>
<p>Nakagawa S, Schielzeth H. 2013. A general and simple method for obtaining R2 from generalized linear mixed-effects models.
Methods in Ecology and Evolution 4(2): 133-142. DOI: 10.1111/j.2041-210x.2012.00261.x
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+powerGlmer">powerGlmer</a></code>, <code><a href="#topic+powerGlmer2">powerGlmer2</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>##design object: 2 remaining random effects and 1 continous fixed effect
block=c(2,2); blocN=4; position=16; posN=20; offN=20
dam0&lt;- stack(as.data.frame(matrix(1:(block[1]*blocN),ncol=blocN,nrow=block[1])))
sire0&lt;- stack(as.data.frame(matrix(1:(block[2]*blocN),ncol=blocN,nrow=block[2])))
observ0&lt;- merge(dam0,sire0, by="ind")
levels(observ0[,1])&lt;- 1:blocN; colnames(observ0)&lt;- c("block","dam","sire")
observ0$family&lt;- 1:nrow(observ0)  #add family
#expand for offspring, observ0 x offN
observ1&lt;- do.call("rbind", replicate(offN,observ0,simplify=FALSE))
observ1$position&lt;- rep(1:position,each=posN)
observ1$position&lt;- sample(observ1$position,nrow(observ1)) #shuffle
desn&lt;- observ1[,c(2,3,4,5,1)];rm(observ0,observ1) #dam,sire,family,position,block
desn$egg_size&lt;- 1:nrow(desn)

#100 simulations
## Not run: powerGlmer3(var_rand=c(1,0.15,0.11,0.5,0.3),n_rand=c(8,8,16,16,4),
fam_link=binomial(link="logit"),var_fix=0.1,n_fix=1,design=desn,
remain="(1|position)+(1|block)+egg_size") 
## End(Not run)
</code></pre>

<hr>
<h2 id='powerLmer'>Power analysis for normal data</h2><span id='topic+powerLmer'></span>

<h3>Description</h3>

<p>Extracts the power values of dam, sire, and dam by sire variance components from a
linear mixed-effect model using the <em>lmer</em> function of the <em>lme4</em> package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>powerLmer(varcomp, nval, alpha = 0.05, nsim = 100, ml = F)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="powerLmer_+3A_varcomp">varcomp</code></td>
<td>
<p>Vector of known dam, sire, dam by sire, and residual variance components, i.e. c(dam, sire, dam x sire, residual).</p>
</td></tr>
<tr><td><code id="powerLmer_+3A_nval">nval</code></td>
<td>
<p>Vector of known dam, sire, and offspring per family sample sizes, i.e. c(dam, sire, offspring).</p>
</td></tr>
<tr><td><code id="powerLmer_+3A_alpha">alpha</code></td>
<td>
<p>Statistical significance value. Default is 0.05.</p>
</td></tr>
<tr><td><code id="powerLmer_+3A_nsim">nsim</code></td>
<td>
<p>Number of simulations. Default is 100.</p>
</td></tr>
<tr><td><code id="powerLmer_+3A_ml">ml</code></td>
<td>
<p>Default is FALSE for restricted maximum likelihood. Change to TRUE for maximum likelihood.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Extracts the dam, sire, dam, and dam by sire power values.
Power values are calculated by stochastically simulation data and then calculating the proportion of
significance values less than <em>alpha</em> for each component (Bolker 2008).
Significance values for the random effects are determined using likelihood ratio tests (Bolker et al. 2009).
</p>


<h3>Value</h3>

<p>Prints a data frame with the sample sizes, variance component inputs, variance component outputs, and power values.
</p>


<h3>Note</h3>

<p>Maximum likelihood (ML) estimates the parameters that maximize the likelihood of the observed data
and has the advantage of using all the data and accounting for non-independence (Lynch and Walsh 1998,
p. 779; Bolker et al. 2009). On the other hand, ML has the disadvantage of assuming that all fixed
effects are known without error, producing a downward bias in the estimation of the residual variance
component. This bias can be large if there are lots of fixed effects, especially if sample sizes are
small. Restricted maximum likelihood (REML) has the advantage of not assuming the fixed effects are
known and averages over the uncertainty, so there can be less bias in the estimation of the residual
variance component. However, REML only maximizes a portion of the likelihood to estimate the effect
parameters, but is the preferred method for analyzing large data sets with complex structure.
</p>


<h3>References</h3>

<p>Bolker BM. 2008. Ecological models and data in R. Princeton University Press, New Jersey.
</p>
<p>Bolker BM, Brooks ME, Clark CJ, Geange SW, Poulsen JR, Stevens MHH, White J-SS. 2009.
Generalized linear mixed models: a practical guide for ecology and evolution.
Trends in Ecology and Evolution 24(3): 127-135. DOI: 10.1016/j.tree.2008.10.008
</p>
<p>Lynch M, Walsh B. 1998. Genetics and Analysis of Quantitative Traits. Sinauer Associates, Massachusetts.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+powerLmer2">powerLmer2</a></code>, <code><a href="#topic+powerLmer3">powerLmer3</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>#100 simulations
#powerLmer(varcomp=c(0.1900,0,0.1719,0.6315),nval=c(11,11,10))
#
#5 simulations
powerLmer(varcomp=c(0.1900,0,0.1719,0.6315),nval=c(11,11,10),nsim=5)
</code></pre>

<hr>
<h2 id='powerLmer2'>Power analysis for normal data 2</h2><span id='topic+powerLmer2'></span>

<h3>Description</h3>

<p>Extracts the power values of dam, sire, and dam by sire variance components from a
linear mixed-effect model using the <em>lmer</em> function of the <em>lme4</em> package.
Options to include one random position and/or one random block effect(s).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>powerLmer2(varcomp, nval, alpha = 0.05, nsim = 100, position = NULL, block = NULL,
ml = F)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="powerLmer2_+3A_varcomp">varcomp</code></td>
<td>
<p>Vector of known dam, sire, dam by sire, residual, and position and/or
block variance components, i.e. c(dam, sire, dam x sire, residual, position/block). If there is a
position and a block c(..., residual, position, block).</p>
</td></tr>
<tr><td><code id="powerLmer2_+3A_nval">nval</code></td>
<td>
<p>Vector of known dam, sire, offspring per family, and offspring per position or number of blocks
sample sizes, i.e. c(dam, sire, offspring, position/block). If there is a position and a
block c(..., offspring, position, block).</p>
</td></tr>
<tr><td><code id="powerLmer2_+3A_alpha">alpha</code></td>
<td>
<p>Statistical significance value. Default is 0.05.</p>
</td></tr>
<tr><td><code id="powerLmer2_+3A_nsim">nsim</code></td>
<td>
<p>Number of simulations. Default is 100.</p>
</td></tr>
<tr><td><code id="powerLmer2_+3A_position">position</code></td>
<td>
<p>Optional number of positions.</p>
</td></tr>
<tr><td><code id="powerLmer2_+3A_block">block</code></td>
<td>
<p>Optional vector of dams and sires per block, e.g. c(2,2).</p>
</td></tr>
<tr><td><code id="powerLmer2_+3A_ml">ml</code></td>
<td>
<p>Default is FALSE for restricted maximum likelihood. Change to TRUE for maximum likelihood.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Extracts the dam, sire, dam, dam by sire, and position and/or block power values.
Power values are calculated by stochastically simulation data and then calculating the proportion of
significance values less than <em>alpha</em> for each component (Bolker 2008).
Significance values for the random effects are determined using likelihood ratio tests (Bolker et al. 2009).
</p>


<h3>Value</h3>

<p>Prints a data frame with the sample sizes, variance component inputs, variance component outputs, and power values.
</p>


<h3>Note</h3>

<p>Maximum likelihood (ML) estimates the parameters that maximize the likelihood of the observed data
and has the advantage of using all the data and accounting for non-independence (Lynch and Walsh 1998,
p. 779; Bolker et al. 2009). On the other hand, ML has the disadvantage of assuming that all fixed
effects are known without error, producing a downward bias in the estimation of the residual variance
component. This bias can be large if there are lots of fixed effects, especially if sample sizes are
small. Restricted maximum likelihood (REML) has the advantage of not assuming the fixed effects are
known and averages over the uncertainty, so there can be less bias in the estimation of the residual
variance component. However, REML only maximizes a portion of the likelihood to estimate the effect
parameters, but is the preferred method for analyzing large data sets with complex structure.
</p>


<h3>References</h3>

<p>Bolker BM. 2008. Ecological models and data in R. Princeton University Press, New Jersey.
</p>
<p>Bolker BM, Brooks ME, Clark CJ, Geange SW, Poulsen JR, Stevens MHH, White J-SS. 2009.
Generalized linear mixed models: a practical guide for ecology and evolution.
Trends in Ecology and Evolution 24(3): 127-135. DOI: 10.1016/j.tree.2008.10.008
</p>
<p>Lynch M, Walsh B. 1998. Genetics and Analysis of Quantitative Traits. Sinauer Associates, Massachusetts.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+powerLmer">powerLmer</a></code>, <code><a href="#topic+powerLmer3">powerLmer3</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>#100 simulations
#position only, e.g. 8 tanks
## Not run: powerLmer2(varcomp=c(0.2030,0,0.1798,0.5499,0.1077),nval=c(8,8,20,160),position=8)
#block only, e.g. four 2 x 2
## Not run: powerLmer2(varcomp=c(0.2030,0,0.1798,0.5499,0.1077),nval=c(8,8,20,4),block=c(2,2))
#position and block
## Not run: powerLmer2(varcomp=c(0.2030,0,0.1798,0.5499,0.1077,0.1077),nval=c(8,8,20,40,4),
position=8,block=c(2,2))
## End(Not run)
</code></pre>

<hr>
<h2 id='powerLmer3'>Power analysis for normal data 3</h2><span id='topic+powerLmer3'></span>

<h3>Description</h3>

<p>Extracts the power values of dam, sire, and dam by sire variance components from a
linear mixed-effect model using the <em>lmer</em> function of the <em>lme4</em> package.
Model can include additional fixed and/or random effects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>powerLmer3(var_rand, n_rand, design, remain, var_fix = NULL, n_fix = NULL,
alpha = 0.05, nsim = 100, ml = F, ftest = "LR", iter = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="powerLmer3_+3A_var_rand">var_rand</code></td>
<td>
<p>Vector of known dam, sire, dam by sire, residual, and remaining random
variance components, i.e. c(dam, sire, dam x sire, residual, rand1, rand2, etc.).</p>
</td></tr>
<tr><td><code id="powerLmer3_+3A_n_rand">n_rand</code></td>
<td>
<p>Vector of known dam, sire, family, and remaining random sample sizes,
i.e. c(dam, sire, family, rand1, rand2, etc.).</p>
</td></tr>
<tr><td><code id="powerLmer3_+3A_design">design</code></td>
<td>
<p>A data frame of the experimental design, using only integers. First
three columns must contain and be named &quot;dam&quot;, &quot;sire&quot;, &quot;family&quot;. Remaining columns are
the random effects followed by the fixed effects. Continuous fixed effects are a column
containing the values 1:nrow(design).</p>
</td></tr>
<tr><td><code id="powerLmer3_+3A_remain">remain</code></td>
<td>
<p>Remaining formula using <em>lme4</em> package format. Must be random effects
followed by fixed effects. No interactions or random slopes; formulate as intercepts in design.</p>
</td></tr>
<tr><td><code id="powerLmer3_+3A_var_fix">var_fix</code></td>
<td>
<p>Vector of known fixed variance components, i.e. c(fix1, fix2, etc.).
Continous fixed random values are sorted to match column values.</p>
</td></tr>
<tr><td><code id="powerLmer3_+3A_n_fix">n_fix</code></td>
<td>
<p>Vector of known fixed sample sizes, i.e. c(fix1, fix2, etc.). Continuous fixed
effects must have a sample size of 1.</p>
</td></tr>
<tr><td><code id="powerLmer3_+3A_alpha">alpha</code></td>
<td>
<p>Statistical significance value. Default is 0.05.</p>
</td></tr>
<tr><td><code id="powerLmer3_+3A_nsim">nsim</code></td>
<td>
<p>Number of simulations. Default is 100.</p>
</td></tr>
<tr><td><code id="powerLmer3_+3A_ml">ml</code></td>
<td>
<p>Default is FALSE for restricted maximum likelihood. Change to TRUE for maximum likelihood.</p>
</td></tr>
<tr><td><code id="powerLmer3_+3A_ftest">ftest</code></td>
<td>
<p>Default is &quot;LR&quot; for likelihood ratio test for fixed effects. Option &quot;PB&quot; is for parametric
bootstrap.</p>
</td></tr>
<tr><td><code id="powerLmer3_+3A_iter">iter</code></td>
<td>
<p>Number of iterations for computing the parametric bootstrap significance value
for any fixed effects.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Extracts the dam, sire, dam, dam by sire, and any remaining random and fixed effects power values.
Power values are calculated by stochastically simulation data and then calculating the proportion of
significance values less than <em>alpha</em> for each component (Bolker 2008).
Significance values for the random effects are determined using likelihood ratio tests (Bolker et al. 2009).
Significance values for any fixed effects are determined using likelihood ratio tests or parametric
bootstrap method (Bolker et al. 2009) from the <em>mixed</em> function of the <em>afex</em> package.
</p>


<h3>Value</h3>

<p>Prints a data frame with the sample sizes, variance component inputs, variance component outputs, and power values.
</p>


<h3>Note</h3>

<p>Maximum likelihood (ML) estimates the parameters that maximize the likelihood of the observed data
and has the advantage of using all the data and accounting for non-independence (Lynch and Walsh 1998,
p. 779; Bolker et al. 2009). On the other hand, ML has the disadvantage of assuming that all fixed
effects are known without error, producing a downward bias in the estimation of the residual variance
component. This bias can be large if there are lots of fixed effects, especially if sample sizes are
small. Restricted maximum likelihood (REML) has the advantage of not assuming the fixed effects are
known and averages over the uncertainty, so there can be less bias in the estimation of the residual
variance component. However, REML only maximizes a portion of the likelihood to estimate the effect
parameters, but is the preferred method for analyzing large data sets with complex structure.
</p>


<h3>References</h3>

<p>Bolker BM. 2008. Ecological models and data in R. Princeton University Press, New Jersey.
</p>
<p>Bolker BM, Brooks ME, Clark CJ, Geange SW, Poulsen JR, Stevens MHH, White J-SS. 2009.
Generalized linear mixed models: a practical guide for ecology and evolution.
Trends in Ecology and Evolution 24(3): 127-135. DOI: 10.1016/j.tree.2008.10.008
</p>
<p>Lynch M, Walsh B. 1998. Genetics and Analysis of Quantitative Traits. Sinauer Associates, Massachusetts.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+powerLmer">powerLmer</a></code>, <code><a href="#topic+powerLmer2">powerLmer2</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>##design object: 2 remaining random effects and 1 continous fixed effect
block=c(2,2); blocN=4; position=16; posN=20; offN=20
dam0&lt;- stack(as.data.frame(matrix(1:(block[1]*blocN),ncol=blocN,nrow=block[1])))
sire0&lt;- stack(as.data.frame(matrix(1:(block[2]*blocN),ncol=blocN,nrow=block[2])))
observ0&lt;- merge(dam0,sire0, by="ind")
levels(observ0[,1])&lt;- 1:blocN; colnames(observ0)&lt;- c("block","dam","sire")
observ0$family&lt;- 1:nrow(observ0)  #add family
#expand for offspring, observ0 x offN
observ1&lt;- do.call("rbind", replicate(offN,observ0,simplify=FALSE))
observ1$position&lt;- rep(1:position,each=posN)
observ1$position&lt;- sample(observ1$position,nrow(observ1)) #shuffle
desn&lt;- observ1[,c(2,3,4,5,1)];rm(observ0,observ1) #dam,sire,family,position,block
desn$egg_size&lt;- 1:nrow(desn)

#100 simulations
## Not run: powerLmer3(var_rand=c(0.19,0.03,0.02,0.51,0.1,0.05),n_rand=c(8,8,16,16,4),
var_fix=0.1,n_fix=1,design=desn,remain="(1|position)+ (1|block)+ egg_size") 
## End(Not run)
</code></pre>

<hr>
<h2 id='resampFamily'>Bootstrap resample within families</h2><span id='topic+resampFamily'></span>

<h3>Description</h3>

<p>Bootstrap resample observations grouped by family identities for a specified number of iterations to create
a resampled data set.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>resampFamily(dat, copy, family, iter)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="resampFamily_+3A_dat">dat</code></td>
<td>
<p>Data frame observed data to resample.</p>
</td></tr>
<tr><td><code id="resampFamily_+3A_copy">copy</code></td>
<td>
<p>Column numbers to copy.</p>
</td></tr>
<tr><td><code id="resampFamily_+3A_family">family</code></td>
<td>
<p>Column name containing family identity information.</p>
</td></tr>
<tr><td><code id="resampFamily_+3A_iter">iter</code></td>
<td>
<p>Number of iterations for resampling.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The resampled data can be used for producing bootstrap confidence intervals.
</p>


<h3>Value</h3>

<p>Because of the large file sizes that can be produced, the resampling of each family X is saved separately
as a common separated (X_resampF.csv) file in the working directory. These files are merged to create the
final resampled data set (resamp_datF.csv).
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+resampRepli">resampRepli</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(chinook_length) #Chinook salmon offspring length
#resampFamily(dat=chinook_length,copy=c(3:8),family="family",iter=1000)
#example with a couple iterations
#resampFamily(dat=chinook_length,copy=c(3:8),family="family",iter=2)
</code></pre>

<hr>
<h2 id='resampGlmer'>Bootstrap components for non-normal data</h2><span id='topic+resampGlmer'></span>

<h3>Description</h3>

<p>Extracts additive genetic, non-additive genetic, and maternal variance components
from a generalized linear mixed-effect model using the <em>glmer</em> function of the <em>lme4</em> package.
Model random effects are dam, sire, and dam by sire.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>resampGlmer(resamp, dam, sire, response, fam_link, start, end, quasi = F)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="resampGlmer_+3A_resamp">resamp</code></td>
<td>
<p>Data frame of bootstrap resampled data.</p>
</td></tr>
<tr><td><code id="resampGlmer_+3A_dam">dam</code></td>
<td>
<p>Column name containing dam (female) parent identity information.</p>
</td></tr>
<tr><td><code id="resampGlmer_+3A_sire">sire</code></td>
<td>
<p>Column name containing sire (male) parent identity information.</p>
</td></tr>
<tr><td><code id="resampGlmer_+3A_response">response</code></td>
<td>
<p>Column name containing the offspring (response) phenotype values.</p>
</td></tr>
<tr><td><code id="resampGlmer_+3A_fam_link">fam_link</code></td>
<td>

<p>The family and link in family(link) format. Supported options are binomial(link=&quot;logit&quot;), binomial(link=&quot;probit&quot;), poisson(link=&quot;log&quot;), and poisson(link=&quot;sqrt&quot;).
</p>
</td></tr>
<tr><td><code id="resampGlmer_+3A_start">start</code></td>
<td>
<p>Starting model number.</p>
</td></tr>
<tr><td><code id="resampGlmer_+3A_end">end</code></td>
<td>
<p>Ending model number.</p>
</td></tr>
<tr><td><code id="resampGlmer_+3A_quasi">quasi</code></td>
<td>
<p>Incorporate overdispersion or quasi-error structure.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Used for bootstrap resampled data set produced using <em>resampRepli</em> or <em>resampFamily</em>.
Laplace approximation parameter estimation is used, which is a true likelihood method (Bolker et al. 2009).
For the overdispersion option, an observation-level random effect is added to the model (Atkins et al. 2013).
Extracts the dam, sire, dam, and dam by sire variance components.
The residual variance component for the <em>fam_links</em> are described by Nakagawa and Schielzeth (2010, 2013).
Calculates the total variance component. Calculates the additive genetic, non-additive genetic, and
maternal variance components (see Lynch and Walsh 1998, p. 603).
</p>


<h3>Value</h3>

<p>A data frame with columns containing the raw variance components for dam, sire, dam by sire,
residual, total, additive genetic, non-additive genetic, and maternal. The number of rows in the
data frame matches the number of iterations in the resampled data set and each row represents a
model number.
</p>


<h3>Note</h3>

<p>The Laplace approximation is used because there were fewer disadvantages relative to penalized
quasi-likelihood and Gauss-Hermite quadrature parameter estimation (Bolker et al. 2009).
That is, penalized quasi-likelihood is not recommended for count responses with means less than 5 and
binary responses with less than 5 successes per group. Gauss-Hermite quadrature is not recommended for
more than two or three random effects because of the rapidly declining analytical speed with the
increasing number of random effects.
</p>


<h3>References</h3>

<p>Atkins DC, Baldwin SA, Zheng C, Gallop RJ, Neighbors C. 2013. A tutorial on count regression and
zero-altered count models for longitudinal substance use data.
Psychology of Addictive Behaviors 27(1): 166-177. DOI: 10.1037/a0029508
</p>
<p>Bolker BM, Brooks ME, Clark CJ, Geange SW, Poulsen JR, Stevens MHH, White J-SS. 2009.
Generalized linear mixed models: a practical guide for ecology and evolution.
Trends in Ecology and Evolution 24(3): 127-135. DOI: 10.1016/j.tree.2008.10.008
</p>
<p>Lynch M, Walsh B. 1998. Genetics and Analysis of Quantitative Traits. Sinauer Associates, Massachusetts.
</p>
<p>Nakagawa S, Schielzeth H. 2010. Repeatability for Gaussian and non-Gaussian data: a practical guide for biologists.
Biological Reviews 85(4): 935-956. DOI: 10.1111/j.1469-185X.2010.00141.x
</p>
<p>Nakagawa S, Schielzeth H. 2013. A general and simple method for obtaining R2 from generalized linear mixed-effects models.
Methods in Ecology and Evolution 4(2): 133-142. DOI: 10.1111/j.2041-210x.2012.00261.x
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+resampGlmer2">resampGlmer2</a></code>, <code><a href="#topic+resampGlmer3">resampGlmer3</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(chinook_resampS) #5 iterations

#survival_rcomp&lt;- resampGlmer(resamp=survival_datR,dam="dam",sire="sire",
#response="status",fam_link=binomial(link="logit"),start=1,end=1000)
## Not run: survival_rcomp&lt;- resampGlmer(resamp=chinook_resampS,dam="dam",sire="sire",
response="status",fam_link=binomial(link="logit"),start=1,end=5) 
## End(Not run)
</code></pre>

<hr>
<h2 id='resampGlmer2'>Bootstrap components for non-normal data 2</h2><span id='topic+resampGlmer2'></span>

<h3>Description</h3>

<p>Extracts additive genetic, non-additive genetic, and maternal variance components
from a generalized linear mixed-effect model using the <em>glmer</em> function of the <em>lme4</em> package.
Model random effects are dam, sire, and dam by sire.
Options to include one random position and/or one random block effect(s).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>resampGlmer2(resamp, dam, sire, response, fam_link, start, end, position = NULL,
block = NULL, quasi = F)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="resampGlmer2_+3A_resamp">resamp</code></td>
<td>
<p>Data frame of bootstrap resampled data.</p>
</td></tr>
<tr><td><code id="resampGlmer2_+3A_dam">dam</code></td>
<td>
<p>Column name containing dam (female) parent identity information.</p>
</td></tr>
<tr><td><code id="resampGlmer2_+3A_sire">sire</code></td>
<td>
<p>Column name containing sire (male) parent identity information.</p>
</td></tr>
<tr><td><code id="resampGlmer2_+3A_response">response</code></td>
<td>
<p>Column name containing the offspring (response) phenotype values.</p>
</td></tr>
<tr><td><code id="resampGlmer2_+3A_fam_link">fam_link</code></td>
<td>

<p>The family and link in family(link) format. Supported options are binomial(link=&quot;logit&quot;), binomial(link=&quot;probit&quot;), poisson(link=&quot;log&quot;), and poisson(link=&quot;sqrt&quot;).
</p>
</td></tr>
<tr><td><code id="resampGlmer2_+3A_start">start</code></td>
<td>
<p>Starting model number.</p>
</td></tr>
<tr><td><code id="resampGlmer2_+3A_end">end</code></td>
<td>
<p>Ending model number.</p>
</td></tr>
<tr><td><code id="resampGlmer2_+3A_position">position</code></td>
<td>
<p>Optional column name containing position factor information.</p>
</td></tr>
<tr><td><code id="resampGlmer2_+3A_block">block</code></td>
<td>
<p>Optional column name containing block factor information.</p>
</td></tr>
<tr><td><code id="resampGlmer2_+3A_quasi">quasi</code></td>
<td>
<p>Incorporate overdispersion or quasi-error structure.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Used for bootstrap resampled data set produced using <em>resampRepli</em> or <em>resampFamily</em>.
Laplace approximation parameter estimation is used, which is a true likelihood method (Bolker et al. 2009).
For the overdispersion option, an observation-level random effect is added to the model (Atkins et al. 2013).
Extracts the dam, sire, dam, and dam by sire variance components.
Extracts optional position and block variance components.
The residual variance component for the <em>fam_links</em> are described by Nakagawa and Schielzeth (2010, 2013).
Calculates the total variance component. Calculates the additive genetic, non-additive genetic, and
maternal variance components (see Lynch and Walsh 1998, p. 603).
</p>


<h3>Value</h3>

<p>A data frame with columns containing the raw variance components for dam, sire, dam by sire,
residual, total, additive genetic, non-additive genetic, and maternal. Also columns containing
the raw variance components for the options of position and/or block. The number of rows in the
data frame matches the number of iterations in the resampled data set and each row represents a
model number.
</p>


<h3>Note</h3>

<p>The Laplace approximation is used because there were fewer disadvantages relative to penalized
quasi-likelihood and Gauss-Hermite quadrature parameter estimation (Bolker et al. 2009).
That is, penalized quasi-likelihood is not recommended for count responses with means less than 5 and
binary responses with less than 5 successes per group. Gauss-Hermite quadrature is not recommended for
more than two or three random effects because of the rapidly declining analytical speed with the
increasing number of random effects.
</p>


<h3>References</h3>

<p>Atkins DC, Baldwin SA, Zheng C, Gallop RJ, Neighbors C. 2013. A tutorial on count regression and
zero-altered count models for longitudinal substance use data.
Psychology of Addictive Behaviors 27(1): 166-177. DOI: 10.1037/a0029508
</p>
<p>Bolker BM, Brooks ME, Clark CJ, Geange SW, Poulsen JR, Stevens MHH, White J-SS. 2009.
Generalized linear mixed models: a practical guide for ecology and evolution.
Trends in Ecology and Evolution 24(3): 127-135. DOI: 10.1016/j.tree.2008.10.008
</p>
<p>Lynch M, Walsh B. 1998. Genetics and Analysis of Quantitative Traits. Sinauer Associates, Massachusetts.
</p>
<p>Nakagawa S, Schielzeth H. 2010. Repeatability for Gaussian and non-Gaussian data: a practical guide for biologists.
Biological Reviews 85(4): 935-956. DOI: 10.1111/j.1469-185X.2010.00141.x
</p>
<p>Nakagawa S, Schielzeth H. 2013. A general and simple method for obtaining R2 from generalized linear mixed-effects models.
Methods in Ecology and Evolution 4(2): 133-142. DOI: 10.1111/j.2041-210x.2012.00261.x
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+resampGlmer">resampGlmer</a></code>, <code><a href="#topic+resampGlmer3">resampGlmer3</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(chinook_resampS) #5 iterations

#survival_rcomp2&lt;- resampGlmer2(resamp=survival_datR,dam="dam",sire="sire",
#response="status",fam_link=binomial(link="logit"),position="tray",start=1,end=1000)
## Not run: survival_rcomp2&lt;- resampGlmer2(resamp=chinook_resampS,dam="dam",sire="sire",
response="status",fam_link=binomial(link="logit"),position="tray",start=1,end=5)
## End(Not run)
</code></pre>

<hr>
<h2 id='resampGlmer3'>Bootstrap components for non-normal data 3</h2><span id='topic+resampGlmer3'></span>

<h3>Description</h3>

<p>Extracts additive genetic, non-additive genetic, and maternal variance components
from a generalized linear mixed-effect model using the <em>glmer</em> function of the <em>lme4</em> package.
Model random effects are dam, sire, dam by sire, and any additional fixed and/or random effects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>resampGlmer3(resamp, dam, sire, response, fam_link, start, end, remain, quasi = F)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="resampGlmer3_+3A_resamp">resamp</code></td>
<td>
<p>Data frame of bootstrap resampled data.</p>
</td></tr>
<tr><td><code id="resampGlmer3_+3A_dam">dam</code></td>
<td>
<p>Column name containing dam (female) parent identity information.</p>
</td></tr>
<tr><td><code id="resampGlmer3_+3A_sire">sire</code></td>
<td>
<p>Column name containing sire (male) parent identity information.</p>
</td></tr>
<tr><td><code id="resampGlmer3_+3A_response">response</code></td>
<td>
<p>Column name containing the offspring (response) phenotype values.</p>
</td></tr>
<tr><td><code id="resampGlmer3_+3A_fam_link">fam_link</code></td>
<td>

<p>The family and link in family(link) format. Supported options are binomial(link=&quot;logit&quot;), binomial(link=&quot;probit&quot;), poisson(link=&quot;log&quot;), and poisson(link=&quot;sqrt&quot;).
</p>
</td></tr>
<tr><td><code id="resampGlmer3_+3A_start">start</code></td>
<td>
<p>Starting model number.</p>
</td></tr>
<tr><td><code id="resampGlmer3_+3A_end">end</code></td>
<td>
<p>Ending model number.</p>
</td></tr>
<tr><td><code id="resampGlmer3_+3A_remain">remain</code></td>
<td>

<p>Remaining formula using <em>lme4</em> package format with # sign (see column names),
e.g. fixed# + (1|random#).
</p>
</td></tr>
<tr><td><code id="resampGlmer3_+3A_quasi">quasi</code></td>
<td>
<p>Incorporate overdispersion or quasi-error structure.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Used for bootstrap resampled data set produced using <em>resampRepli</em> or <em>resampFamily</em>.
Laplace approximation parameter estimation is used, which is a true likelihood method (Bolker et al. 2009).
For the overdispersion option, an observation-level random effect is added to the model (Atkins et al. 2013).
Extracts the dam, sire, dam, and dam by sire variance components.
Extracts any additional fixed effect and random effect variance components. The fixed-effect variance
component is as a single group using the method described by Nakagawa and Schielzeth (2013).
The residual variance component for the <em>fam_links</em> are described by Nakagawa and Schielzeth (2010, 2013).
Calculates the total variance component. Calculates the additive genetic, non-additive genetic, and
maternal variance components (see Lynch and Walsh 1998, p. 603).
</p>


<h3>Value</h3>

<p>A data frame with columns containing the raw variance components for dam, sire, dam by sire,
residual, total, additive genetic, non-additive genetic, and maternal. Also columns containing
the raw variance components for remaining formula components. The number of rows in the
data frame matches the number of iterations in the resampled data set and each row represents a
model number.
</p>


<h3>Note</h3>

<p>The Laplace approximation is used because there were fewer disadvantages relative to penalized
quasi-likelihood and Gauss-Hermite quadrature parameter estimation (Bolker et al. 2009).
That is, penalized quasi-likelihood is not recommended for count responses with means less than 5 and
binary responses with less than 5 successes per group. Gauss-Hermite quadrature is not recommended for
more than two or three random effects because of the rapidly declining analytical speed with the
increasing number of random effects.
</p>


<h3>References</h3>

<p>Atkins DC, Baldwin SA, Zheng C, Gallop RJ, Neighbors C. 2013. A tutorial on count regression and
zero-altered count models for longitudinal substance use data.
Psychology of Addictive Behaviors 27(1): 166-177. DOI: 10.1037/a0029508
</p>
<p>Bolker BM, Brooks ME, Clark CJ, Geange SW, Poulsen JR, Stevens MHH, White J-SS. 2009.
Generalized linear mixed models: a practical guide for ecology and evolution.
Trends in Ecology and Evolution 24(3): 127-135. DOI: 10.1016/j.tree.2008.10.008
</p>
<p>Lynch M, Walsh B. 1998. Genetics and Analysis of Quantitative Traits. Sinauer Associates, Massachusetts.
</p>
<p>Nakagawa S, Schielzeth H. 2010. Repeatability for Gaussian and non-Gaussian data: a practical guide for biologists.
Biological Reviews 85(4): 935-956. DOI: 10.1111/j.1469-185X.2010.00141.x
</p>
<p>Nakagawa S, Schielzeth H. 2013. A general and simple method for obtaining R2 from generalized linear mixed-effects models.
Methods in Ecology and Evolution 4(2): 133-142. DOI: 10.1111/j.2041-210x.2012.00261.x
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+resampGlmer">resampGlmer</a></code>, <code><a href="#topic+resampGlmer2">resampGlmer2</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(chinook_resampS) #5 iterations

#survival_rcomp3&lt;- resampGlmer3(resamp=survival_datR,dam="dam",sire="sire",
#response="status",fam_link=binomial(link="logit"),remain="egg_size# + (1|tray#)",
#start=1,end=1000)
## Not run: survival_rcomp3&lt;- resampGlmer3(resamp=survival_datR,dam="dam",sire="sire",
response="status",fam_link=binomial(link="logit"),remain="egg_size# + (1|tray#)",
start=1,end=5)
## End(Not run)
</code></pre>

<hr>
<h2 id='resampLmer'>Bootstrap components for normal data</h2><span id='topic+resampLmer'></span>

<h3>Description</h3>

<p>Extracts additive genetic, non-additive genetic, and maternal variance components
from a linear mixed-effect model using the <em>lmer</em> function of the <em>lme4</em> package.
Model random effects are dam, sire, and dam by sire.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>resampLmer(resamp, dam, sire, response, start, end, ml = F)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="resampLmer_+3A_resamp">resamp</code></td>
<td>
<p>Data frame of bootstrap resampled data.</p>
</td></tr>
<tr><td><code id="resampLmer_+3A_dam">dam</code></td>
<td>
<p>Column name containing dam (female) parent identity information.</p>
</td></tr>
<tr><td><code id="resampLmer_+3A_sire">sire</code></td>
<td>
<p>Column name containing sire (male) parent identity information.</p>
</td></tr>
<tr><td><code id="resampLmer_+3A_response">response</code></td>
<td>
<p>Column name containing the offspring (response) phenotype values.</p>
</td></tr>
<tr><td><code id="resampLmer_+3A_start">start</code></td>
<td>
<p>Starting model number.</p>
</td></tr>
<tr><td><code id="resampLmer_+3A_end">end</code></td>
<td>
<p>Ending model number.</p>
</td></tr>
<tr><td><code id="resampLmer_+3A_ml">ml</code></td>
<td>
<p>Default is FALSE for restricted maximum likelihood. Change to TRUE for maximum likelihood.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Used for bootstrap resampled data set produced using <em>resampRepli</em> or <em>resampFamily</em>.
Extracts the dam, sire, dam, dam by sire, and residual variance components.
Calculates the total variance component. Calculates the additive genetic, non-additive genetic, and
maternal variance components (see Lynch and Walsh 1998, p. 603).
</p>


<h3>Value</h3>

<p>A data frame with columns containing the raw variance components for dam, sire, dam by sire,
residual, total, additive genetic, non-additive genetic, and maternal. The number of rows in the
data frame matches the number of iterations in the resampled data set and each row represents a
model number.
</p>


<h3>Note</h3>

<p>Maximum likelihood (ML) estimates the parameters that maximize the likelihood of the observed data
and has the advantage of using all the data and accounting for non-independence (Lynch and Walsh 1998,
p. 779; Bolker et al. 2009). On the other hand, ML has the disadvantage of assuming that all fixed
effects are known without error, producing a downward bias in the estimation of the residual variance
component. This bias can be large if there are lots of fixed effects, especially if sample sizes are
small. Restricted maximum likelihood (REML) has the advantage of not assuming the fixed effects are
known and averages over the uncertainty, so there can be less bias in the estimation of the residual
variance component. However, REML only maximizes a portion of the likelihood to estimate the effect
parameters, but is the preferred method for analyzing large data sets with complex structure.
</p>


<h3>References</h3>

<p>Bolker BM, Brooks ME, Clark CJ, Geange SW, Poulsen JR, Stevens MHH, White J-SS. 2009.
Generalized linear mixed models: a practical guide for ecology and evolution.
Trends in Ecology and Evolution 24(3): 127-135. DOI: 10.1016/j.tree.2008.10.008
</p>
<p>Lynch M, Walsh B. 1998. Genetics and Analysis of Quantitative Traits. Sinauer Associates, Massachusetts.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+resampLmer2">resampLmer2</a></code>, <code><a href="#topic+resampLmer3">resampLmer3</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(chinook_resampL) #5 iterations

#length_rcomp1&lt;- resampLmer(resamp=length_datR,dam="dam",sire="sire",response="length",
#start=1,end=1000)
length_rcomp1&lt;- resampLmer(resamp=chinook_resampL,dam="dam",sire="sire",response="length",
start=1,end=5)
</code></pre>

<hr>
<h2 id='resampLmer2'>Bootstrap components for normal data 2</h2><span id='topic+resampLmer2'></span>

<h3>Description</h3>

<p>Extracts additive genetic, non-additive genetic, and maternal variance components
from a linear mixed-effect model using the <em>lmer</em> function of the <em>lme4</em> package.
Model random effects are dam, sire, and dam by sire.
Options to include one random position and/or one random block effect(s).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>resampLmer2(resamp, dam, sire, response, start, end, position = NULL, block = NULL,
ml = F)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="resampLmer2_+3A_resamp">resamp</code></td>
<td>
<p>Data frame of bootstrap resampled data.</p>
</td></tr>
<tr><td><code id="resampLmer2_+3A_dam">dam</code></td>
<td>
<p>Column name containing dam (female) parent identity information.</p>
</td></tr>
<tr><td><code id="resampLmer2_+3A_sire">sire</code></td>
<td>
<p>Column name containing sire (male) parent identity information.</p>
</td></tr>
<tr><td><code id="resampLmer2_+3A_response">response</code></td>
<td>
<p>Column name containing the offspring (response) phenotype values.</p>
</td></tr>
<tr><td><code id="resampLmer2_+3A_start">start</code></td>
<td>
<p>Starting model number.</p>
</td></tr>
<tr><td><code id="resampLmer2_+3A_end">end</code></td>
<td>
<p>Ending model number.</p>
</td></tr>
<tr><td><code id="resampLmer2_+3A_position">position</code></td>
<td>
<p>Optional column name containing position factor information.</p>
</td></tr>
<tr><td><code id="resampLmer2_+3A_block">block</code></td>
<td>
<p>Optional column name containing block factor information.</p>
</td></tr>
<tr><td><code id="resampLmer2_+3A_ml">ml</code></td>
<td>
<p>Default is FALSE for restricted maximum likelihood. Change to TRUE for maximum likelihood.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Used for bootstrap resampled data set produced using <em>resampRepli</em> or <em>resampFamily</em>.
Extracts the dam, sire, dam, dam by sire, and residual variance components.
Extracts optional position and block variance components.
Calculates the total variance component. Calculates the additive genetic, non-additive genetic, and
maternal variance components (see Lynch and Walsh 1998, p. 603).
</p>


<h3>Value</h3>

<p>A data frame with columns containing the raw variance components for dam, sire, dam by sire,
residual, total, additive genetic, non-additive genetic, and maternal. Also columns containing
the raw variance components for the options of position and/or block. The number of rows in the
data frame matches the number of iterations in the resampled data set and each row represents a
model number.
</p>


<h3>Note</h3>

<p>Maximum likelihood (ML) estimates the parameters that maximize the likelihood of the observed data
and has the advantage of using all the data and accounting for non-independence (Lynch and Walsh 1998,
p. 779; Bolker et al. 2009). On the other hand, ML has the disadvantage of assuming that all fixed
effects are known without error, producing a downward bias in the estimation of the residual variance
component. This bias can be large if there are lots of fixed effects, especially if sample sizes are
small. Restricted maximum likelihood (REML) has the advantage of not assuming the fixed effects are
known and averages over the uncertainty, so there can be less bias in the estimation of the residual
variance component. However, REML only maximizes a portion of the likelihood to estimate the effect
parameters, but is the preferred method for analyzing large data sets with complex structure.
</p>


<h3>References</h3>

<p>Bolker BM, Brooks ME, Clark CJ, Geange SW, Poulsen JR, Stevens MHH, White J-SS. 2009.
Generalized linear mixed models: a practical guide for ecology and evolution.
Trends in Ecology and Evolution 24(3): 127-135. DOI: 10.1016/j.tree.2008.10.008
</p>
<p>Lynch M, Walsh B. 1998. Genetics and Analysis of Quantitative Traits. Sinauer Associates, Massachusetts.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+resampLmer">resampLmer</a></code>, <code><a href="#topic+resampLmer3">resampLmer3</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(chinook_resampL) #5 iterations

#length_rcomp2&lt;- resampLmer2(resamp=length_datR,dam="dam",sire="sire",response="length",
#start=1,end=1000,position="tray")
length_rcomp2&lt;- resampLmer2(resamp=chinook_resampL,dam="dam",sire="sire",response="length",
start=1,end=5,position="tray")
</code></pre>

<hr>
<h2 id='resampLmer3'>Bootstrap components for normal data 3</h2><span id='topic+resampLmer3'></span>

<h3>Description</h3>

<p>Extracts additive genetic, non-additive genetic, and maternal variance components
from a linear mixed-effect model using the <em>lmer</em> function of the <em>lme4</em> package.
Model random effects are dam, sire, dam by sire, and any additional fixed and/or random effects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>resampLmer3(resamp, dam, sire, response, start, end, remain, ml = F)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="resampLmer3_+3A_resamp">resamp</code></td>
<td>
<p>Data frame of bootstrap resampled data.</p>
</td></tr>
<tr><td><code id="resampLmer3_+3A_dam">dam</code></td>
<td>
<p>Column name containing dam (female) parent identity information.</p>
</td></tr>
<tr><td><code id="resampLmer3_+3A_sire">sire</code></td>
<td>
<p>Column name containing sire (male) parent identity information.</p>
</td></tr>
<tr><td><code id="resampLmer3_+3A_response">response</code></td>
<td>
<p>Column name containing the offspring (response) phenotype values.</p>
</td></tr>
<tr><td><code id="resampLmer3_+3A_start">start</code></td>
<td>
<p>Starting model number.</p>
</td></tr>
<tr><td><code id="resampLmer3_+3A_end">end</code></td>
<td>
<p>Ending model number.</p>
</td></tr>
<tr><td><code id="resampLmer3_+3A_remain">remain</code></td>
<td>

<p>Remaining formula using <em>lme4</em> package format with # sign (see column names),
e.g. fixed# + (1|random#).
</p>
</td></tr>
<tr><td><code id="resampLmer3_+3A_ml">ml</code></td>
<td>
<p>Default is FALSE for restricted maximum likelihood. Change to TRUE for maximum likelihood.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Used for bootstrap resampled data set produced using <em>resampRepli</em> or <em>resampFamily</em>.
Extracts the dam, sire, dam, dam by sire, and residual variance components.
Extracts any additional fixed effect and random effect variance components. The fixed-effect variance
component is as a single group using the method described by Nakagawa and Schielzeth (2013).
Calculates the total variance component. Calculates the additive genetic, non-additive genetic, and
maternal variance components (see Lynch and Walsh 1998, p. 603).
</p>


<h3>Value</h3>

<p>A data frame with columns containing the raw variance components for dam, sire, dam by sire,
residual, total, additive genetic, non-additive genetic, and maternal. Also columns containing
the raw variance components for remaining formula components. The number of rows in the
data frame matches the number of iterations in the resampled data set and each row represents a
model number.
</p>


<h3>Note</h3>

<p>Maximum likelihood (ML) estimates the parameters that maximize the likelihood of the observed data
and has the advantage of using all the data and accounting for non-independence (Lynch and Walsh 1998,
p. 779; Bolker et al. 2009). On the other hand, ML has the disadvantage of assuming that all fixed
effects are known without error, producing a downward bias in the estimation of the residual variance
component. This bias can be large if there are lots of fixed effects, especially if sample sizes are
small. Restricted maximum likelihood (REML) has the advantage of not assuming the fixed effects are
known and averages over the uncertainty, so there can be less bias in the estimation of the residual
variance component. However, REML only maximizes a portion of the likelihood to estimate the effect
parameters, but is the preferred method for analyzing large data sets with complex structure.
</p>


<h3>References</h3>

<p>Bolker BM, Brooks ME, Clark CJ, Geange SW, Poulsen JR, Stevens MHH, White J-SS. 2009.
Generalized linear mixed models: a practical guide for ecology and evolution.
Trends in Ecology and Evolution 24(3): 127-135. DOI: 10.1016/j.tree.2008.10.008
</p>
<p>Lynch M, Walsh B. 1998. Genetics and Analysis of Quantitative Traits. Sinauer Associates, Massachusetts.
</p>
<p>Nakagawa S, Schielzeth H. 2013. A general and simple method for obtaining R2 from generalized linear
mixed-effects models. Methods in Ecology and Evolution 4(2): 133-142.
DOI: 10.1111/j.2041-210x.2012.00261.x
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+resampLmer">resampLmer</a></code>, <code><a href="#topic+resampLmer2">resampLmer2</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(chinook_resampL)

#length_rcomp3&lt;- resampLmer3(resamp=length_datR,dam="dam",sire="sire",response="length",
#start=1,end=1000,remain="egg_size# + (1|tray#)")
length_rcomp3&lt;- resampLmer3(resamp=chinook_resampL,dam="dam",sire="sire",response="length",
start=1,end=5,remain="egg_size# + (1|tray#)")
</code></pre>

<hr>
<h2 id='resampRepli'>Bootstrap resample within replicates</h2><span id='topic+resampRepli'></span>

<h3>Description</h3>

<p>Bootstrap resample observations grouped by replicate identities within family identities for a specified number
of iterations to create a resampled data set.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>resampRepli(dat, copy, family, replicate, iter)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="resampRepli_+3A_dat">dat</code></td>
<td>
<p>Data frame observed data to resample.</p>
</td></tr>
<tr><td><code id="resampRepli_+3A_copy">copy</code></td>
<td>
<p>Column numbers to copy.</p>
</td></tr>
<tr><td><code id="resampRepli_+3A_family">family</code></td>
<td>
<p>Column name containing family identity information.</p>
</td></tr>
<tr><td><code id="resampRepli_+3A_replicate">replicate</code></td>
<td>
<p>Column name containing replicate identity information.</p>
</td></tr>
<tr><td><code id="resampRepli_+3A_iter">iter</code></td>
<td>
<p>Number of iterations for resampling.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The resampled data can be used for producing bootstrap confidence intervals.
</p>


<h3>Value</h3>

<p>Because of the large file sizes that can be produced, the resampling of each replicate Y per family X is
saved separately as a common separated (X_Y_resampR.csv) file in the working directory. These files
are merged to create the final resampled data set (resamp_datR.csv).
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+resampFamily">resampFamily</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(chinook_length) #Chinook salmon offspring length
#resampRepli(dat=chinook_length,copy=c(3:8),family="family",replicate="repli",iter=1000)
#example with a couple iterations
#resampRepli(dat=chinook_length,copy=c(3:8),family="family",replicate="repli",iter=2)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
