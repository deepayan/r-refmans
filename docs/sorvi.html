<!DOCTYPE html><html><head><title>Help for package sorvi</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {sorvi}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#cran_downloads'><p>Get CRAN download statistics</p></a></li>
<li><a href='#get_ifpi_charts'><p>Get IFPI Finland music consumption statistics</p></a></li>
<li><a href='#get_municipalities'><p>Select Municipalities by Year</p></a></li>
<li><a href='#gh_issue_stats'><p>GitHub issues statistics</p></a></li>
<li><a href='#kunnat1865_2021'><p>Municipality dataset</p></a></li>
<li><a href='#load_sorvi_data'><p>Supporting Data</p></a></li>
<li><a href='#polygons1909_2009'><p>Municipality geometries</p></a></li>
<li><a href='#sorvi-package'><p>Algorithmic Tools for Open Data in Finland</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Functions for Finnish Open Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.8.21</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-08-21</td>
</tr>
<tr>
<td>MailingList:</td>
<td>rOpenGov &lt;ropengov-forum@googlegroups.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Misc support functions for rOpenGov and open data downloads.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/BSD-2-Clause">BSD_2_clause</a> + file LICENSE</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/ropengov/sorvi/issues">https://github.com/ropengov/sorvi/issues</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/ropengov/sorvi">https://github.com/ropengov/sorvi</a>,
<a href="https://CRAN.R-project.org/package=sorvi">https://CRAN.R-project.org/package=sorvi</a>,
<a href="https://ropengov.github.io/sorvi/">https://ropengov.github.io/sorvi/</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>dlstats, dplyr, ggplot2, gh, tidyr, purrr, rlang, utils,
rvest, xml2, lubridate, checkmate, magrittr, sf</td>
</tr>
<tr>
<td>Suggests:</td>
<td>gridExtra, RColorBrewer, knitr, rmarkdown, Cairo</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-22 13:36:44 UTC; xxx</td>
</tr>
<tr>
<td>Author:</td>
<td>Leo Lahti <a href="https://orcid.org/0000-0001-5537-637X"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre],
  Juuso Parkkinen [aut],
  Joona Lehtomaki [aut],
  Pyry Kantanen <a href="https://orcid.org/0000-0003-2853-2765"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Leo Lahti &lt;leo.lahti@iki.fi&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-22 15:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='cran_downloads'>Get CRAN download statistics</h2><span id='topic+cran_downloads'></span>

<h3>Description</h3>

<p>Produces a tibble or a visualization of package download statistics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cran_downloads(
  pkgs = "all",
  output = "tibble",
  sum = "by_month",
  plot.scale = 11,
  use.cache = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cran_downloads_+3A_pkgs">pkgs</code></td>
<td>
<p>Package name(s). Default is &quot;all&quot;, which prints statistics for
all rOpenGov packages. You can also input 1 or more package names as a 
vector.</p>
</td></tr>
<tr><td><code id="cran_downloads_+3A_output">output</code></td>
<td>
<p>&quot;tibble&quot; (default) or &quot;plot&quot;. With sum &quot;by_month&quot; and
&quot;by_year&quot; &quot;plot&quot; outputs a line chart, with &quot;total&quot; it outputs a
bar chart.</p>
</td></tr>
<tr><td><code id="cran_downloads_+3A_sum">sum</code></td>
<td>
<p>&quot;by_month&quot; (default), &quot;by_year&quot; or &quot;total&quot;</p>
</td></tr>
<tr><td><code id="cran_downloads_+3A_plot.scale">plot.scale</code></td>
<td>
<p>integer, default is 11. Smaller numbers decrease the size of
plot elements, larger numbers make them larger.</p>
</td></tr>
<tr><td><code id="cran_downloads_+3A_use.cache">use.cache</code></td>
<td>
<p>Cache downloaded statistics. Default is TRUE</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is intended for easy retrieval and visualization of rOpenGov 
package download statistics from CRAN. It is an evolution of an R script
by antagomir. As such it retains some features that were present in
the original R script and were deemed useful for rOpenGov's internal use.
This function may or may not be useful in other instances.
</p>


<h3>Value</h3>

<p>tibble or a ggplot2 line chart or a bar chart
</p>


<h3>Author(s)</h3>

<p>Leo Lahti, Pyry Kantanen &lt;pyry.kantanen@gmail.com&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
df &lt;- cran_downloads(pkgs = "eurostat", sum = "total", use.cache = FALSE)
kable(df)

## Compare two packages
p1 &lt;- cran_downloads(pkgs = "eurostat", sum = "by_year", output = "plot")
p2 &lt;- cran_downloads(pkgs = "osmar", sum = "by_year", output = "plot")
gridExtra::grid.arrange(p1, p2, nrow = 2)

## End(Not run)

</code></pre>

<hr>
<h2 id='get_ifpi_charts'>Get IFPI Finland music consumption statistics</h2><span id='topic+get_ifpi_charts'></span>

<h3>Description</h3>

<p>Download chart position data from ifpi.fi
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_ifpi_charts(channel = "radio", year = NA, week = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_ifpi_charts_+3A_channel">channel</code></td>
<td>
<p>Options: &quot;radio&quot;, &quot;albumit&quot;, &quot;singlet&quot;, &quot;fyysiset-albumit&quot;</p>
</td></tr>
<tr><td><code id="get_ifpi_charts_+3A_year">year</code></td>
<td>
<p>year as numeric. Default is NA, returning charts from current 
year. Charts are available from 2014 onwards.</p>
</td></tr>
<tr><td><code id="get_ifpi_charts_+3A_week">week</code></td>
<td>
<p>week as numeric. Default is NA, returning most last possible 
charts. Week cannot be the current week.
Please note that number of weeks differ between years. 
For simplicity's sake valid weeks are set to be between 1 and 53. 
Use e.g. 'lubridate::isoweek' to check how many weeks a given year has.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Web scraping function that is inspired by Sauravkaushik8 Kaushik's
blog post &quot;Beginner's Guide on Web Scraping in R&quot; on analyticsvidhya.com. 
Downloads chart data from Musiikkituottajat - IFPI Finland ry website.
Please note that this function works only with IFPI Finland website!
</p>
<p>The output has the following columns:
</p>

<ul>
<li><p>rank: Rank on chart
</p>
</li>
<li><p>artist: Artist name
</p>
</li>
<li><p>song_title: Song title
</p>
</li>
<li><p>rank_last_week: Rank on chart on the previous week. RE if the song has
re-entered the chart
</p>
</li>
<li><p>chart_woc: Weeks on chart
</p>
</li>
<li><p>week: Week number of observation
</p>
</li>
<li><p>year: Year of observation
</p>
</li></ul>



<h3>Value</h3>

<p>tibble
</p>


<h3>Author(s)</h3>

<p>Pyry Kantanen &lt;pyry.kantanen@gmail.com&gt;
</p>


<h3>See Also</h3>

<p>Original tutorial in <a href="https://www.analyticsvidhya.com/blog/2017/03/beginners-guide-on-web-scraping-in-r-using-rvest-with-hands-on-knowledge/">https://www.analyticsvidhya.com/blog/2017/03/beginners-guide-on-web-scraping-in-r-using-rvest-with-hands-on-knowledge/</a>
</p>

<hr>
<h2 id='get_municipalities'>Select Municipalities by Year</h2><span id='topic+get_municipalities'></span>

<h3>Description</h3>

<p>From a larger dataset containing historical municipalities, 
pick a certain year and return an output that contains the most recent 
information on each municipality.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_municipalities(year = 2002, type = "data.frame")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_municipalities_+3A_year">year</code></td>
<td>
<p>a year between 1865-2020</p>
</td></tr>
<tr><td><code id="get_municipalities_+3A_type">type</code></td>
<td>
<p>either &quot;data.frame&quot; or &quot;sf&quot;</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See dataset &quot;kunnat1865_2021&quot;
</p>


<h3>Value</h3>

<p>a data.frame or sf object
</p>


<h3>Author(s)</h3>

<p>Pyry Kantanen
</p>


<h3>Source</h3>

<p>Data attribution: FinnONTO Consortium: <a href="https://seco.cs.aalto.fi/projects/finnonto/">https://seco.cs.aalto.fi/projects/finnonto/</a>
</p>

<hr>
<h2 id='gh_issue_stats'>GitHub issues statistics</h2><span id='topic+gh_issue_stats'></span>

<h3>Description</h3>

<p>Get statistics about GitHub issues from GitHub API.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gh_issue_stats(
  owner = "ropengov",
  repo = "geofi",
  issue.type = NA,
  time.from = NA,
  time.to = NA
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gh_issue_stats_+3A_owner">owner</code></td>
<td>
<p>Repository owner / organization. Default is &quot;ropengov&quot;</p>
</td></tr>
<tr><td><code id="gh_issue_stats_+3A_repo">repo</code></td>
<td>
<p>Repository name. Default is &quot;geofi&quot;</p>
</td></tr>
<tr><td><code id="gh_issue_stats_+3A_issue.type">issue.type</code></td>
<td>
<p>Type of issues printed: &quot;issue&quot;, &quot;PR&quot; or NA printing all 
(default).</p>
</td></tr>
<tr><td><code id="gh_issue_stats_+3A_time.from">time.from</code></td>
<td>
<p>Start date in ISO 8601 format: YYYY-MM-DDTHH:MM:SSZ.
Default is &quot;2010-09-01T00:00:00Z&quot;.</p>
</td></tr>
<tr><td><code id="gh_issue_stats_+3A_time.to">time.to</code></td>
<td>
<p>End date in ISO 8601 format: YYYY-MM-DDTHH:MM:SSZ. Default
is <code>Sys.time()</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is intended for easy information retrieval about rOpenGov 
package issues and pull requests. More specifically, this function returns
a tibble containing information on issue id, title, status (open or closed),
number of comments, who opened it, when it was created, what was the openers
status (rOpenGov organization member, package contributor or a regular user 
who opened e.g. a bug issue) and what is the type of the issue. 
</p>
<p>GitHub Issues API handles Pull Requests and Issues similarly and therefore 
this function returns both types by default. Different types of issues 
can be filtered by using the issue.type parameter.
</p>
<p>Kudos for this function go to Jennifer Bryan. The changes made here are
mostly related to adding additional fields (opener_type, issue_type) to
the output tibble and writing a function around these original contributions.
The scope of this function is to mainly help rOpenGov team analyze the type
of user feedback we get via GitHub issues and therefore the scope of this
function is very limited.
</p>


<h3>Value</h3>

<p>tibble
</p>


<h3>Author(s)</h3>

<p>Original scripts by Jennifer Bryan (jennybc), function by Pyry Kantanen &lt;pyry.kantanen@gmail.com&gt;
</p>


<h3>See Also</h3>

<p>GitHub Issues API documentation: 
<a href="https://docs.github.com/en/rest/reference/issues">https://docs.github.com/en/rest/reference/issues</a>
</p>
<p>Original &quot;analyze GitHub stuff with R&quot; repository:
<a href="https://github.com/jennybc/analyze-github-stuff-with-r">https://github.com/jennybc/analyze-github-stuff-with-r</a>
</p>

<hr>
<h2 id='kunnat1865_2021'>Municipality dataset</h2><span id='topic+kunnat1865_2021'></span>

<h3>Description</h3>

<p>A dataset containing information about each instance of individual 
municipalities.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kunnat1865_2021
</code></pre>


<h3>Format</h3>

<p>A simple feature with 1337 rows and 10 variables:
</p>

<dl>
<dt>x</dt><dd><p>Universal Resource Identifier (URI) for each municipality instance in time. For example: http://www.yso.fi/onto/sapo/Maalahti(1908-1972)</p>
</dd>
<dt>kunta_nro</dt><dd><p>Municipality code, a unique number assigned for each municipality that stays the same as long as the municipality exists. For example: &quot;475&quot;</p>
</dd>
<dt>kunta_name_fi</dt><dd><p>The official name of the municipality in Finnish. For example: Maalahti</p>
</dd>
<dt>kunta_name_fi</dt><dd><p>The official name of the municipality in Swedish. For example: Malax</p>
</dd>
<dt>startyear</dt><dd><p>Start year of the municipality instance, e.g. founding year. For example: 1865</p>
</dd>
<dt>endyear</dt><dd><p>End year of the municipality instance, can be NA if still valid. For example: 1972</p>
</dd>
<dt>area</dt><dd><p>Area of the municipality, in square kilometers. For example 185.00</p>
</dd>
<dt>muutos_kuvaus</dt><dd><p>A description of the change that occurred at the beginning of this specific instance. For example: &quot;Ahlainen erotettiin Ulvilasta 1908&quot;</p>
</dd>
<dt>muutos_tyyppi</dt><dd><p>Type of the change. For example: &quot;Jakaantuminen&quot;</p>
</dd>
<dt>muutos_tunniste</dt><dd><p>Identifiers for the changes that have happened, which can be used to link past and future instances of municipalities together. For example: &quot;Jakaantuminen1534, Jakaantuminen2&quot;</p>
</dd>
</dl>



<h3>Details</h3>

<p>Most of the Finnish municipalities were formed after 1865
decree on municipal governance in the country <a href="https://fi.wikisource.org/wiki/Asetus_kunnallishallituksesta_maalla_1865">Asetus kunnallishallituksesta maalla 1865</a>
but the dataset contains some municipalities that were allegedly formed even
before that. There are two instances of &quot;illegal municipalities&quot; (Mustio and 
Rutakko) that were not recognized as actual municipalities but functioned 
as such in late 1800s and early 1900s.
</p>


<h3>Source</h3>

<p>Raw data downloaded from ONKI.fi website on 04 Aug 2022: <a href="http://onki.fi/en/browser/overview/sapo">http://onki.fi/en/browser/overview/sapo</a>
Data attribution: FinnONTO Consortium: <a href="https://seco.cs.aalto.fi/projects/finnonto/">https://seco.cs.aalto.fi/projects/finnonto/</a>
</p>
<p>Information on abolished municipalities and municipality name changes from Statistics Finland website: <a href="https://www2.stat.fi/en/luokitukset/tupa/">Municipalities and regional divisions based on municipalities in files and classification publications</a>
</p>

<hr>
<h2 id='load_sorvi_data'>Supporting Data</h2><span id='topic+load_sorvi_data'></span>

<h3>Description</h3>

<p>Load custom data sets.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>load_sorvi_data(data.id, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="load_sorvi_data_+3A_data.id">data.id</code></td>
<td>
<p>data ID to download (see details)</p>
</td></tr>
<tr><td><code id="load_sorvi_data_+3A_verbose">verbose</code></td>
<td>
<p>verbose</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The following data sets are available:
</p>

<ul>
<li><p>translation_provincesTranslation of Finnish province (maakunta) names (Finnish, English).
</p>
</li></ul>



<h3>Value</h3>

<p>Data set. The format depends on the data.
</p>


<h3>Author(s)</h3>

<p>Leo Lahti <a href="mailto:leo.lahti@iki.fi">leo.lahti@iki.fi</a>
</p>


<h3>References</h3>

<p>See citation(&quot;sorvi&quot;)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>translations &lt;- load_sorvi_data("translation_provinces")
</code></pre>

<hr>
<h2 id='polygons1909_2009'>Municipality geometries</h2><span id='topic+polygons1909_2009'></span>

<h3>Description</h3>

<p>A simple feature containing the URIs, municipality codes and geometries of 
municipalities in time. The starting point and end point of each municipality
can be determined by combining polygons1909_2009 with another dataset that
contains such information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>polygons1909_2009
</code></pre>


<h3>Format</h3>

<p>A simple feature with 860 rows and 3 variables:
</p>

<dl>
<dt>x</dt><dd><p>Universal Resource Identifier (URI) for each municipality instance in time. For example: http://www.yso.fi/onto/sapo/Maalahti(1908-1972)</p>
</dd>
<dt>kunta_nro</dt><dd><p>Municipality code, a unique 3-digit code (001-999) assigned for each municipality that stays the same as long as the municipality exists. For example: &quot;475&quot;</p>
</dd>
<dt>geometry</dt><dd><p>A single list column with geometries</p>
</dd>
</dl>



<h3>Source</h3>

<p>Original data downloaded from ONKI.fi website on 04 Aug 2022: <a href="http://onki.fi/en/browser/overview/sapo">http://onki.fi/en/browser/overview/sapo</a>
Data attribution: FinnONTO Consortium: <a href="https://seco.cs.aalto.fi/projects/finnonto/">https://seco.cs.aalto.fi/projects/finnonto/</a>
</p>

<hr>
<h2 id='sorvi-package'>Algorithmic Tools for Open Data in Finland</h2><span id='topic+sorvi-package'></span><span id='topic+sorvi'></span>

<h3>Description</h3>

<p>The sorvi package hosts various functions that are mainly helpful in rOpenGov 
package maintenance, package authoring and drawing graphs for presentations. 
Additionally it has some functions that do not (yet) have their own package
but are useful in some contexts.
</p>


<h3>Author(s)</h3>

<p>Leo Lahti, Juuso Parkkinen, Jussi Paananen, Joona Lehtomaki, Einari Happonen, Juuso Haapanen, and Pyry Kantanen <a href="mailto:louhos@googlegroups.com">louhos@googlegroups.com</a>
</p>


<h3>References</h3>

<p>See citation(&quot;sorvi&quot;)
<a href="https://github.com/rOpenGov/sorvi">https://github.com/rOpenGov/sorvi</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(sorvi)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
