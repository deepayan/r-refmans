<!DOCTYPE html><html><head><title>Help for package TPmsm</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {TPmsm}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#TPmsm-package'><p>Estimation of Transition Probabilities in Multistate Models</p></a></li>
<li><a href='#as.data.frame.survTP'><p>as.data.frame method for a survTP object</p></a></li>
<li><a href='#bladderTP'><p>Bladder cancer recurrences</p></a></li>
<li><a href='#colonTP'><p>Chemotherapy for Stage B/C colon cancer</p></a></li>
<li><a href='#contour.TPCmsm'><p>contour method for a TPCmsm object</p></a></li>
<li><a href='#corrTP'><p>Correlation between two gap times</p></a></li>
<li><a href='#dgpTP'><p>Generates bivariate survival data</p></a></li>
<li><a href='#heartTP'><p>More Stanford heart transplant data</p></a></li>
<li><a href='#image.TPCmsm'><p>image method for a TPCmsm object</p></a></li>
<li><a href='#lines.TPCmsm'><p>lines method for a TPCmsm object</p></a></li>
<li><a href='#lines.TPmsm'><p>lines method for a TPmsm object</p></a></li>
<li><a href='#plot.TPCmsm'><p>plot method for a TPCmsm object</p></a></li>
<li><a href='#plot.TPmsm'><p>plot method for a TPmsm object</p></a></li>
<li><a href='#setPackageSeedTP'><p>Set the initial package seed</p></a></li>
<li><a href='#setSeedTP'><p>Save and restore RNG stream seeds</p></a></li>
<li><a href='#setThreadsTP'><p>Set the number of threads</p></a></li>
<li><a href='#survTP'><p>Create a survTP object</p></a></li>
<li><a href='#TPmsmOut'><p>Convert a data.frame in the <span class="pkg">TPmsm</span> format to other formats</p></a></li>
<li><a href='#transAJ'><p>Aalen-Johansen transition probabilities</p></a></li>
<li><a href='#transIPCW'><p>Inverse probability censoring weighted transition probabilities</p></a></li>
<li><a href='#transKMPW'><p>Presmoothed Kaplan-Meier weighted transition probabilities</p></a></li>
<li><a href='#transKMW'><p>Kaplan-Meier weighted transition probabilities</p></a></li>
<li><a href='#transLIN'><p>LIN based transition probabilities</p></a></li>
<li><a href='#transLS'><p>Location-Scale transition probabilities</p></a></li>
<li><a href='#transPAJ'><p>Presmoothed Aalen-Johansen transition probabilities</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2.12</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-12-07</td>
</tr>
<tr>
<td>Title:</td>
<td>Estimation of Transition Probabilities in Multistate Models</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.1.0), graphics, grDevices, KernSmooth</td>
</tr>
<tr>
<td>Enhances:</td>
<td>etm, p3state.msm</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimation of transition probabilities for the
	illness-death model and or the three-state progressive model.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/arturstat/TPmsm">https://github.com/arturstat/TPmsm</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/arturstat/TPmsm/issues">https://github.com/arturstat/TPmsm/issues</a></td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-12-07 20:31:56 UTC; User</td>
</tr>
<tr>
<td>Author:</td>
<td>Artur Araujo <a href="https://orcid.org/0000-0003-1419-4208"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Javier Roca-Pardinas
    <a href="https://orcid.org/0000-0003-3107-4515"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Luis Meira-Machado
    <a href="https://orcid.org/0000-0002-8577-7665"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Artur Araujo &lt;artur.stat@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-12-07 21:40:08 UTC</td>
</tr>
</table>
<hr>
<h2 id='TPmsm-package'>Estimation of Transition Probabilities in Multistate Models</h2><span id='topic+TPmsm-package'></span>

<h3>Description</h3>

<p>The <span class="pkg">TPmsm</span> software contains functions that compute estimates for the transition probabilities in the
illness-death model and or the three-state progressive model. This package implements seven different estimators.
Being five of them non-parametric and two of them semi-parametric (PAJ and KMPW). The implemented estimators are the
Aalen-Johansen estimator (AJ), Presmoothed Aalen-Johansen estimator (PAJ), Kaplan-Meier Weighted estimator (KMW),
Presmoothed Kalpan-Meier Weighted estimator (KMPW), Inverse Probability Censoring estimator (IPCW),
Lin estimator (LIN) and Location-Scale estimator (LS). The Inverse Probability Censoring (IPCW) and Lin (LIN)
estimators also permit to compute transition probabilities conditioned on a single covariate. Bootstrap confidence
bands can be computed for each of the mentioned estimators. Several graphical plots of the transition probabilities
with or without confidence bands can be drawn. To aid in the study of the statistical properties of the implemented
estimators, functions to generate pseudo-random data for some well-known multivariate distributions were implemented.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
		Package: </td><td style="text-align: left;"> TPmsm</td>
</tr>
<tr>
 <td style="text-align: left;">
		Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
		Version: </td><td style="text-align: left;"> 1.2.12</td>
</tr>
<tr>
 <td style="text-align: left;">
		Date: </td><td style="text-align: left;"> 2023-12-07</td>
</tr>
<tr>
 <td style="text-align: left;">
		License: </td><td style="text-align: left;"> GPL-3</td>
</tr>
<tr>
 <td style="text-align: left;">
		LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
		LazyData: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
	</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Artur Araújo, Javier Roca-Pardiñas <a href="mailto:roca@uvigo.es">roca@uvigo.es</a><br />
and Luís Meira-Machado <a href="mailto:lmachado@math.uminho.pt">lmachado@math.uminho.pt</a><br />
Maintainer: Artur Araújo <a href="mailto:artur.stat@gmail.com">artur.stat@gmail.com</a>
</p>


<h3>References</h3>

<p>Aalen O. O., Johansen S. (1978). An Empirical Transition Matrix for Nonhomogeneous Markov Chains Based on Censored Observations. <em>Scandinavian Journal of Statistics</em>, <b>5</b>(3), 141-150. <a href="https://www.jstor.org/stable/4615704">https://www.jstor.org/stable/4615704</a>
</p>
<p>Allignol A., Schumacher M., Beyersmann J. (2011). Empirical Transition Matrix of Multi-State Models: The etm Package. <em>Journal of Statistical Software</em>, <b>38</b>(4), 1-15. <a href="https://doi.org/10.18637/jss.v038.i04">doi:10.18637/jss.v038.i04</a>
</p>
<p>Amorim A. P., de Uña-Álvarez J., Meira Machado L. F. (2011). Presmoothing the transition probabilities in the illness-death model. <em>Statistics and Probability Letters</em>, <b>81</b>(7), 797-806. <a href="https://doi.org/10.1016/j.spl.2011.02.017">doi:10.1016/j.spl.2011.02.017</a>
</p>
<p>Araújo A, Meira-Machado L, Roca-Pardiñas J (2014). TPmsm: Estimation of the Transition Probabilities in
3-State Models. <em>Journal of Statistical Software</em>, <b>62</b>(4), 1-29. <a href="https://doi.org/10.18637/jss.v062.i04">doi:10.18637/jss.v062.i04</a>
</p>
<p>Crowley J., Hu M. (1977). Covariance analysis of heart transplant survival data. <em>Journal of the American Statistical Association</em>, <b>72</b>(357), 27-36. <a href="https://doi.org/10.2307/2286902">doi:10.2307/2286902</a>
</p>
<p>Davison, A. C., Hinkley, D. V. (1997). <em>Bootstrap Methods and their Application</em>, Chapter 5, Cambridge University Press.
</p>
<p>Devroye L. (1986). <em>Non-Uniform Random Variate Generation</em>, New York: Springer-Verlag.
</p>
<p>Johnson M. E. (1987). <em>Multivariate Statistical Simulation</em>, John Wiley and Sons.
</p>
<p>Johnson N., Kotz S. (1972). <em>Distributions in statistics: continuous multivariate distributions</em>, John Wiley and Sons.
</p>
<p>Karl A. T., Eubank R., Milovanovic J., Reiser M., Young D. (2014). Using RngStreams for parallel random number generation in C++ and R. <em>Computational Statistics</em>, <b>29</b>(5), 1301-1320. <a href="https://doi.org/10.1007/s00180-014-0492-3">doi:10.1007/s00180-014-0492-3</a>
</p>
<p>Laurie J. A., Moertel C. G., Fleming T. R., Wieand H. S., Leigh J. E., Rubin J., McCormack G. W., Gerstner J. B., Krook J. E., Malliard J. (1989). Surgical adjuvant therapy of large-bowel carcinoma: An evaluation of levamisole and the combination of levamisole and fluorouracil: The North Central Cancer Treatment Group and the Mayo Clinic. <em>Journal of Clinical Oncology</em>, <b>7</b>(10), 1447-1456. <a href="https://doi.org/10.1200/JCO.1989.7.10.1447">doi:10.1200/JCO.1989.7.10.1447</a>
</p>
<p>L'Ecuyer, P. (1999). Good parameters and implementations for combined multiple recursive random number generators. <em>Operations Research</em>, <b>47</b>(1), 159–-164. <a href="https://doi.org/10.1287/opre.47.1.159">doi:10.1287/opre.47.1.159</a>
</p>
<p>L’Ecuyer P., Simard R., Chen E. J., Kelton W. D. (2002). An object-oriented random-number package with many long streams and substreams. <em>Operations Research</em>, <b>50</b>(6), 1073–-1075. <a href="https://doi.org/10.1287/opre.50.6.1073.358">doi:10.1287/opre.50.6.1073.358</a>
</p>
<p>Lin D. Y. (1994). Cox regression analysis of multivariate failure time data: the marginal approach. <em>Statistics in Medicine</em>, <b>13</b>(21), 2233-2247. <a href="https://doi.org/10.1002/sim.4780132105">doi:10.1002/sim.4780132105</a>
</p>
<p>Lu J., Bhattacharya G. (1990). Some new constructions of bivariate weibull models. <em>Annals of Institute of Statistical Mathematics</em>, <b>42</b>(3), 543-559. <a href="https://doi.org/10.1007/BF00049307">doi:10.1007/BF00049307</a>
</p>
<p>Meira Machado L. F., de Uña-Álvarez J., Cadarso-Suárez C. (2006). Nonparametric estimation of transition probabilities in a non-Markov illness-death model. <em>Lifetime Data Anal</em>, <b>12</b>(3), 325-344. <a href="https://doi.org/10.1007/s10985-006-9009-x">doi:10.1007/s10985-006-9009-x</a>
</p>
<p>Meira-Machado L., de Uña-Álvarez J., Datta S. (2011). Conditional Transition Probabilities in a non-Markov Illness-death Model. Discussion Papers in Statistics and Operations Research n 11/03. Department of Statistics and Operations Research, University of Vigo (ISSN: 1888-5756, Deposito Legal VG 1402-2007). <a href="https://depc05.webs.uvigo.es/reports/12_05.pdf">https://depc05.webs.uvigo.es/reports/12_05.pdf</a>
</p>
<p>Meira-Machado L., Faria S. (2014). A simulation study comparing modeling approaches in an illness-death multi-state model. <em>Communications in Statistics - Simulation and Computation</em>, <b>43</b>(5), 929-946. <a href="https://doi.org/10.1080/03610918.2012.718841">doi:10.1080/03610918.2012.718841</a>
</p>
<p>Meira-Machado L., Roca-Pardiñas J. (2011). p3state.msm: Analyzing Survival Data from an Illness-Death Model. <em>Journal of Statistical Software</em>, <b>38</b>(3), 1-18. <a href="https://doi.org/10.18637/jss.v038.i03">doi:10.18637/jss.v038.i03</a>
</p>
<p>Meira-Machado L., Roca-Pardiñas J., Van Keilegom I., Cadarso-Suárez C. (2013). Bandwidth Selection for the Estimation of Transition Probabilities in the Location-Scale Progressive Three-State Model. <em>Computational Statistics</em>, <b>28</b>(5), 2185-2210. <a href="https://doi.org/10.1007/s00180-013-0402-0">doi:10.1007/s00180-013-0402-0</a>
</p>
<p>Meira-Machado L., Roca-Pardiñas J., Van Keilegom I. Cadarso-Suárez C. (2010). Estimation of transition probabilities in a non-Markov model with successive survival times. <a href="https://sites.uclouvain.be/IAP-Stat-Phase-V-VI/ISBApub/dp2010/DP1053.pdf">https://sites.uclouvain.be/IAP-Stat-Phase-V-VI/ISBApub/dp2010/DP1053.pdf</a>
</p>
<p>Meira-Machado, L., Sestelo M. (2019). Estimation in the progressive illness-death model: a nonexhaustive
review. <em>Biometrical Journal</em>, <b>61</b>(2), 245–263. <a href="https://doi.org/10.1002/bimj.201700200">doi:10.1002/bimj.201700200</a>
</p>
<p>Moertel C. G., Fleming T. R., MacDonald J. S., Haller D. G., Laurie J. A., Goodman P.J., Ungerleider J.S., Emerson W.A., Tormey D.C., Glick J.H., Veeder M.H., Maillard J.A. (1990). Levamisole and fluorouracil for adjuvant therapy of resected colon carcinoma. <em>New England Journal of Medicine</em>, <b>322</b>(6), 352-358. <a href="https://doi.org/10.1056/NEJM199002083220602">doi:10.1056/NEJM199002083220602</a>
</p>
<p>Moertel C. G., Fleming T. R., MacDonald J. S., Haller D. G., Laurie J. A., Tangen C. M., Ungerleider J. S., Emerson W. A., Tormey D. C., Glick J. H., Veeder M. H., Maillard J. A. (1995). Fluorouracil plus Levamisole as an effective adjuvant therapy after resection of stage II colon carcinoma: a final report. <em>Annals of Internal Medicine</em>, <b>122</b>(5), 321-326. <a href="https://doi.org/10.7326/0003-4819-122-5-199503010-00001">doi:10.7326/0003-4819-122-5-199503010-00001</a>
</p>
<p>Moreira A., de Uña-Álvarez J., Meira-Machado L. (2011). Presmoothing the Aalen-Johansen estimator of transition probabilities. Discussion Papers in Statistics and Operation Research n 11/03. Department of Statistics and Operations Research, University of Vigo (ISSN: 1888-5756, Deposito Legal VG 1402-2007). <a href="https://depc05.webs.uvigo.es/reports/11_03.pdf">https://depc05.webs.uvigo.es/reports/11_03.pdf</a>
</p>
<p>Van Keilegom I., de Uña-Álvarez J., Meira-Machado L. (2011). Nonparametric location-scale models for successive survival times under dependent censoring. <em>Journal of Statistical Planning and Inference</em>, <b>141</b>(3), 1118-1131. <a href="https://doi.org/10.1016/j.jspi.2010.09.010">doi:10.1016/j.jspi.2010.09.010</a>
</p>
<p>Wei L. J., Lin D. Y., Weissfeld L. (1989). Regression analysis of multivariate incomplete failure time data by modeling marginal distributions. <em>Journal of the American Statistical Association</em>, <b>84</b>(408), 1065-1073. <a href="https://doi.org/10.2307/2290084">doi:10.2307/2290084</a>
</p>

<hr>
<h2 id='as.data.frame.survTP'>as.data.frame method for a survTP object</h2><span id='topic+as.data.frame.survTP'></span>

<h3>Description</h3>

<p>as.data.frame method for an object of class &lsquo;survTP&rsquo;.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'survTP'
as.data.frame(x, ..., package="TPmsm")</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.data.frame.survTP_+3A_x">x</code></td>
<td>
<p>An object of class &lsquo;survTP&rsquo;.</p>
</td></tr>
<tr><td><code id="as.data.frame.survTP_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to or from method.</p>
</td></tr>
<tr><td><code id="as.data.frame.survTP_+3A_package">package</code></td>
<td>
<p>The format of the data.frame.
Possible options are &ldquo;TPmsm&rdquo;, &ldquo;p3state.msm&rdquo; and &ldquo;etm&rdquo;.
Defaults to &ldquo;TPmsm&rdquo;.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame in the format specified by argument <code>package</code>.</p>


<h3>Author(s)</h3>

<p>Artur Araújo, Javier Roca-Pardiñas and Luís Meira-Machado</p>


<h3>References</h3>

<p>Allignol A., Schumacher M., Beyersmann J. (2011). Empirical Transition Matrix of Multi-State Models: The etm Package. <em>Journal of Statistical Software</em>, <b>38</b>(4), 1-15. <a href="https://doi.org/10.18637/jss.v038.i04">doi:10.18637/jss.v038.i04</a>
</p>
<p>Araújo A, Meira-Machado L, Roca-Pardiñas J (2014). TPmsm: Estimation of the Transition Probabilities in
3-State Models. <em>Journal of Statistical Software</em>, <b>62</b>(4), 1-29. <a href="https://doi.org/10.18637/jss.v062.i04">doi:10.18637/jss.v062.i04</a>
</p>
<p>Meira-Machado L., Roca-Pardiñas J. (2011). p3state.msm: Analyzing Survival Data from an Illness-Death Model. <em>Journal of Statistical Software</em>, <b>38</b>(3), 1-18. <a href="https://doi.org/10.18637/jss.v038.i03">doi:10.18637/jss.v038.i03</a>
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+as.data.frame">as.data.frame</a></code>,
<code><a href="#topic+survTP">survTP</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Set the number of threads
nth &lt;- setThreadsTP(2);

# Example for the "TPmsm" format
weiTP &lt;- dgpTP(n=100, corr=1, dist="weibull", dist.par=c(2, 7, 2, 7),
model.cens="exponential", cens.par = 6, state2.prob=0.6);
weidata &lt;- as.data.frame(weiTP);
head(weidata);

# Example for the "etm" format
expTP &lt;- dgpTP(n=100, corr=1, dist="exponential", dist.par=c(1, 1),
model.cens="uniform", cens.par=3, state2.prob=0.5);
expdata &lt;- as.data.frame(expTP, package="etm");
head(expdata);

# Restore the number of threads
setThreadsTP(nth);
</code></pre>

<hr>
<h2 id='bladderTP'>Bladder cancer recurrences</h2><span id='topic+bladderTP'></span>

<h3>Description</h3>

<p>This contains the bladder cancer recurrences data in a different format.
In this study, patients had superficial bladder tumors that were removed by transurethral resection.
Many patients had multiple recurrences (up to a maximum of 9) of tumors during the study,
and new tumors were removed at each visit. Only the first two recurrence times (in months) are considered.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(bladderTP)</code></pre>


<h3>Format</h3>

<p>A data frame with 85 observations on the following 4 variables.
</p>

<dl>
<dt><code>time1</code></dt><dd><p>Time until first recurrence/censoring time.</p>
</dd>
<dt><code>event1</code></dt><dd><p>First recurrence indicator.</p>
</dd>
<dt><code>Stime</code></dt><dd><p>Time until second recurrence/censoring time, i.e. the total time of the process.</p>
</dd>
<dt><code>event</code></dt><dd><p>First or second recurrence indicator, i.e. the censoring indicator of the total time.</p>
</dd>
</dl>



<h3>References</h3>

<p>Wei L. J., Lin D. Y., Weissfeld L. (1989). Regression analysis of multivariate incomplete failure time data by modeling marginal distributions. <em>Journal of the American Statistical Association</em>, <b>84</b>(408), 1065-1073. <a href="https://doi.org/10.2307/2290084">doi:10.2307/2290084</a>
</p>

<hr>
<h2 id='colonTP'>Chemotherapy for Stage B/C colon cancer</h2><span id='topic+colonTP'></span>

<h3>Description</h3>

<p>These are data from one of the first successful trials of
adjuvant chemotherapy for colon cancer. Levamisole is a low-toxicity
compound previously used to treat worm infestations in animals; 5-FU
is a moderately toxic (as these things go) chemotherapy agent.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(colonTP)</code></pre>


<h3>Format</h3>

<p>A data frame with 929 observations on the following 15 variables.
</p>

<dl>
<dt><code>time1</code></dt><dd><p>Time to recurrence/censoring/death, whichever occurs first.</p>
</dd>
<dt><code>event1</code></dt><dd><p>Recurrence/censoring/death indicator (recurrence/dead=1, alive=0).</p>
</dd>
<dt><code>Stime</code></dt><dd><p>Time to death/censoring.</p>
</dd>
<dt><code>event</code></dt><dd><p>Censoring indicator (dead=1, alive=0).</p>
</dd>
<dt><code>rx</code></dt><dd><p>Treatment - Obs(ervation), Lev(amisole), Lev(amisole)+5-FU.</p>
</dd>
<dt><code>sex</code></dt><dd><p>1=male.</p>
</dd>
<dt><code>age</code></dt><dd><p>Age in years.</p>
</dd>
<dt><code>obstruct</code></dt><dd><p>Obstruction of colon by tumour.</p>
</dd>
<dt><code>perfor</code></dt><dd><p>Perforation of colon.</p>
</dd>
<dt><code>adhere</code></dt><dd><p>Adherence to nearby organs.</p>
</dd>
<dt><code>nodes</code></dt><dd><p>Number of lymph nodes with detectable cancer.</p>
</dd>
<dt><code>differ</code></dt><dd><p>Differentiation of tumour (1=well, 2=moderate, 3=poor).</p>
</dd>
<dt><code>extent</code></dt><dd><p>Extent of local spread (1=submucosa, 2=muscle, 3=serosa, 4=contiguous structures).</p>
</dd>
<dt><code>surg</code></dt><dd><p>Time from surgery to registration (0=short, 1=long).</p>
</dd>
<dt><code>node4</code></dt><dd><p>More than 4 positive lymph nodes.</p>
</dd>
</dl>



<h3>Note</h3>

<p>The study is originally described in Laurie (1989).
The main report is found in Moertel (1990).  This data set is closest
to that of the final report in Moertel (1991).
A version of the data with less follow-up time was used in the
paper by Lin (1994).
</p>


<h3>References</h3>

<p>Laurie J. A., Moertel C. G., Fleming T. R., Wieand H. S., Leigh J. E., Rubin J., McCormack G. W., Gerstner J. B., Krook J. E., Malliard J. (1989). Surgical adjuvant therapy of large-bowel carcinoma: An evaluation of levamisole and the combination of levamisole and fluorouracil: The North Central Cancer Treatment Group and the Mayo Clinic. <em>Journal of Clinical Oncology</em>, <b>7</b>(10), 1447-1456. <a href="https://doi.org/10.1200/JCO.1989.7.10.1447">doi:10.1200/JCO.1989.7.10.1447</a>
</p>
<p>Lin D. Y. (1994). Cox regression analysis of multivariate failure time data: the marginal approach. <em>Statistics in Medicine</em>, <b>13</b>(21), 2233-2247. <a href="https://doi.org/10.1002/sim.4780132105">doi:10.1002/sim.4780132105</a>
</p>
<p>Moertel C. G., Fleming T. R., MacDonald J. S., Haller D. G., Laurie J. A., Goodman P.J., Ungerleider J.S., Emerson W.A., Tormey D.C., Glick J.H., Veeder M.H., Maillard J.A. (1990). Levamisole and fluorouracil for adjuvant therapy of resected colon carcinoma. <em>New England Journal of Medicine</em>, <b>322</b>(6), 352-358. <a href="https://doi.org/10.1056/NEJM199002083220602">doi:10.1056/NEJM199002083220602</a>
</p>
<p>Moertel C. G., Fleming T. R., MacDonald J. S., Haller D. G., Laurie J. A., Tangen C. M., Ungerleider J. S., Emerson W. A., Tormey D. C., Glick J. H., Veeder M. H., Maillard J. A. (1995). Fluorouracil plus Levamisole as an effective adjuvant therapy after resection of stage II colon carcinoma: a final report. <em>Annals of Internal Medicine</em>, <b>122</b>(5), 321-326. <a href="https://doi.org/10.7326/0003-4819-122-5-199503010-00001">doi:10.7326/0003-4819-122-5-199503010-00001</a>
</p>

<hr>
<h2 id='contour.TPCmsm'>contour method for a TPCmsm object</h2><span id='topic+contour.TPCmsm'></span>

<h3>Description</h3>

<p>contour method for an object of class &lsquo;TPCmsm&rsquo;.
Creates a contour plot of the transition probabilities.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'TPCmsm'
contour(x, contour.type="tc", tr.choice, nlevels=20, levels=pretty(zlim, nlevels),
xlim, ylim, zlim=c(0, 1), col=grey(0.4), xlab, ylab, main="", sub="",
add=FALSE, las=1, conf.int=FALSE, legend=TRUE, curvlab, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="contour.TPCmsm_+3A_x">x</code></td>
<td>
<p>An object of class &lsquo;TPCmsm&rsquo;.</p>
</td></tr>
<tr><td><code id="contour.TPCmsm_+3A_contour.type">contour.type</code></td>
<td>
<p>A character string specifying the type of contour.
If &ldquo;tc&rdquo; the contour with time in the x axis, covariate in the y axis and transition probability in the z axis is drawn.
If &ldquo;ct&rdquo; the contour with covariate in the x axis, time in the y axis and transition probability in the z axis is drawn.
Defaults to &ldquo;tc&rdquo;.
</p>
</td></tr>
<tr><td><code id="contour.TPCmsm_+3A_tr.choice">tr.choice</code></td>
<td>
<p>Character vector of the form &lsquo;c(&ldquo;from to&rdquo;, &ldquo;from to&rdquo;)&rsquo;
specifying which transitions should be plotted.
Default, all the transition probabilities are plotted.
</p>
</td></tr>
<tr><td><code id="contour.TPCmsm_+3A_nlevels">nlevels</code></td>
<td>
<p>The number of levels to divide the range of z. Defaults to 20 levels.</p>
</td></tr>
<tr><td><code id="contour.TPCmsm_+3A_levels">levels</code></td>
<td>
<p>Numeric vector of levels at which to draw contour lines.
Defaults to <code>pretty(zlim, nlevels)</code>.
</p>
</td></tr>
<tr><td><code id="contour.TPCmsm_+3A_xlim">xlim</code></td>
<td>
<p>Limits of x-axis for the plot.</p>
</td></tr>
<tr><td><code id="contour.TPCmsm_+3A_ylim">ylim</code></td>
<td>
<p>Limits of y-axis for the plot.</p>
</td></tr>
<tr><td><code id="contour.TPCmsm_+3A_zlim">zlim</code></td>
<td>
<p>Limits of z-axis for the plot. Defaults to <code>c(0, 1)</code>.</p>
</td></tr>
<tr><td><code id="contour.TPCmsm_+3A_col">col</code></td>
<td>
<p>Color for the lines drawn. Defaults to <code>grey(0.4)</code>.</p>
</td></tr>
<tr><td><code id="contour.TPCmsm_+3A_xlab">xlab</code></td>
<td>
<p>x-axis label. If <code>contour.type="tc"</code> defaults to &ldquo;Time&rdquo;.
If <code>contour.type="ct"</code> defaults to &ldquo;Covariate&rdquo;.
</p>
</td></tr>
<tr><td><code id="contour.TPCmsm_+3A_ylab">ylab</code></td>
<td>
<p>y-axis label. If <code>contour.type="tc"</code> defaults to &ldquo;Covariate&rdquo;.
If <code>contour.type="ct"</code> defaults to &ldquo;Time&rdquo;.
</p>
</td></tr>
<tr><td><code id="contour.TPCmsm_+3A_main">main</code></td>
<td>
<p>The main title for the plot. By default no main title is added.</p>
</td></tr>
<tr><td><code id="contour.TPCmsm_+3A_sub">sub</code></td>
<td>
<p>A sub title for the plot. By default no sub title is added.</p>
</td></tr>
<tr><td><code id="contour.TPCmsm_+3A_add">add</code></td>
<td>
<p>logical. If TRUE, add to a current plot.</p>
</td></tr>
<tr><td><code id="contour.TPCmsm_+3A_las">las</code></td>
<td>
<p>The style of labeling to be used. The default is to use horizontal labeling.</p>
</td></tr>
<tr><td><code id="contour.TPCmsm_+3A_conf.int">conf.int</code></td>
<td>
<p>Logical. Whether to display contour plots of confidence regions. Default is FALSE.</p>
</td></tr>
<tr><td><code id="contour.TPCmsm_+3A_legend">legend</code></td>
<td>
<p>A logical specifying if a legend should be added.</p>
</td></tr>
<tr><td><code id="contour.TPCmsm_+3A_curvlab">curvlab</code></td>
<td>
<p>A character or expression vector to appear in the legend.
Default is the name of the transitions.
</p>
</td></tr>
<tr><td><code id="contour.TPCmsm_+3A_...">...</code></td>
<td>
<p>Further arguments for contour.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No value is returned.
</p>


<h3>Note</h3>

<p>The device is divided by the number of transitions specified by argument <code>tr.choice</code>.
Being the number of columns equal to the number of transitions.
If argument <code>conf.int=TRUE</code> the device is further divided to make room for the confidence regions.
In this case two rows are added, one for each side of the confidence region.
So if <code>conf.int=TRUE</code> the center row provides the contour of the estimates.
The upper row provides the upper side of the confidence region.
And the lower row provides the lower side of the confidence region.
</p>


<h3>Author(s)</h3>

<p>Artur Araújo, Javier Roca-Pardiñas and Luís Meira-Machado</p>


<h3>References</h3>

<p>Araújo A, Meira-Machado L, Roca-Pardiñas J (2014). TPmsm: Estimation of the Transition Probabilities in
3-State Models. <em>Journal of Statistical Software</em>, <b>62</b>(4), 1-29. <a href="https://doi.org/10.18637/jss.v062.i04">doi:10.18637/jss.v062.i04</a>
</p>
<p>Meira-Machado L., de Uña-Álvarez J., Datta S. (2011). Conditional Transition Probabilities in a non-Markov Illness-death Model. Discussion Papers in Statistics and Operations Research n 11/03. Department of Statistics and Operations Research, University of Vigo (ISSN: 1888-5756, Deposito Legal VG 1402-2007). <a href="https://depc05.webs.uvigo.es/reports/12_05.pdf">https://depc05.webs.uvigo.es/reports/12_05.pdf</a>
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+contour">contour</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Set the number of threads
nth &lt;- setThreadsTP(2);

# Create survTP object
data(colonTP);
colonTP_obj &lt;- with( colonTP, survTP(time1, event1, Stime, event, age=age) );

# Compute IPCW conditional transition probabilities without confidence band
TPCmsm_obj &lt;- transIPCW(colonTP_obj, s=57, t=310, x=0);

# Plot contour with Time in the x-axis
contour(TPCmsm_obj, contour.type="tc", tr.choice=c("1 1", "1 2", "2 2"), ylab="Age");

# Plot contour with Time in the y-axis
contour(TPCmsm_obj, contour.type="ct", tr.choice=c("1 1", "1 2", "1 3"), xlab="Age");

# Restore the number of threads
setThreadsTP(nth);
</code></pre>

<hr>
<h2 id='corrTP'>Correlation between two gap times</h2><span id='topic+corrTP'></span>

<h3>Description</h3>

<p>Provides the correlation between the bivariate times for some copula distributions.</p>


<h3>Usage</h3>

<pre><code class='language-R'>corrTP(dist, corr, dist.par)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="corrTP_+3A_dist">dist</code></td>
<td>
<p>The distribution. Possible bivariate distributions are &ldquo;exponential&rdquo; and &ldquo;weibull&rdquo;.</p>
</td></tr>
<tr><td><code id="corrTP_+3A_corr">corr</code></td>
<td>
<p>Correlation parameter.
Possible values for the bivariate exponential distribution are between -1 and 1 (0 for independency).
Any value between 0 (not included) and 1 (1 for independency) is accepted for the bivariate Weibull distribution.
</p>
</td></tr>
<tr><td><code id="corrTP_+3A_dist.par">dist.par</code></td>
<td>
<p>Vector of parameters for the allowed distributions.
Two (scale) parameters for the bivariate exponential distribution and four (2 location parameters and 2 scale parameters)
for the bivariate Weibull distribution. See details below.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The bivariate exponential distribution, also known as Farlie-Gumbel-Morgenstern distribution is given by
</p>
<p style="text-align: center;"><code class="reqn">F(x,y)=F_1(x)F_2(y)[1+\alpha(1-F_1(x))(1-F_2(y))]</code>
</p>

<p>for <code class="reqn">x\ge0</code> and <code class="reqn">y\ge0</code>. Where the marginal distribution functions <code class="reqn">F_1</code> and <code class="reqn">F_2</code> are exponential with scale parameters <code class="reqn">\theta_1</code> and <code class="reqn">\theta_2</code> and correlation parameter <code class="reqn">\alpha</code>, <code class="reqn">-1 \le \alpha \le 1</code>. <br />
</p>
<p>The bivariate Weibull distribution with two-parameter marginal distributions. It's survival function is given by
</p>
<p style="text-align: center;"><code class="reqn">S(x,y)=P(X&gt;x,Y&gt;y)=e^{-[(\frac{x}{\theta_1})^\frac{\beta_1}{\delta}+(\frac{y}{\theta_2})^\frac{\beta_2}{\delta}]^\delta}</code>
</p>

<p>Where <code class="reqn">0 &lt; \delta \le 1</code> and each marginal distribution has shape parameter <code class="reqn">\beta_i</code> and a scale parameter <code class="reqn">\theta_i</code>, <code class="reqn">i = 1, 2</code>.
</p>


<h3>Author(s)</h3>

<p>Artur Araújo, Javier Roca-Pardiñas and Luís Meira-Machado</p>


<h3>References</h3>

<p>Araújo A, Meira-Machado L, Roca-Pardiñas J (2014). TPmsm: Estimation of the Transition Probabilities in
3-State Models. <em>Journal of Statistical Software</em>, <b>62</b>(4), 1-29. <a href="https://doi.org/10.18637/jss.v062.i04">doi:10.18637/jss.v062.i04</a>
</p>
<p>Johnson N., Kotz S. (1972). <em>Distributions in statistics: continuous multivariate distributions</em>, John Wiley and Sons.
</p>
<p>Lu J., Bhattacharya G. (1990). Some new constructions of bivariate weibull models. <em>Annals of Institute of Statistical Mathematics</em>, <b>42</b>(3), 543-559. <a href="https://doi.org/10.1007/BF00049307">doi:10.1007/BF00049307</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dgpTP">dgpTP</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example for the bivariate Weibull distribution
corrTP( dist = "weibull", corr = 0.5, dist.par = c(2, 7, 2, 7) );

# Example for the bivariate Exponential distribution
corrTP( dist = "exponential", corr = 1, dist.par = c(1, 1) );
</code></pre>

<hr>
<h2 id='dgpTP'>Generates bivariate survival data</h2><span id='topic+dgpTP'></span>

<h3>Description</h3>

<p>Generates bivariate censored gap times from some known copula functions.</p>


<h3>Usage</h3>

<pre><code class='language-R'>dgpTP(n, corr, dist, dist.par, model.cens, cens.par, state2.prob)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dgpTP_+3A_n">n</code></td>
<td>
<p>Sample size.</p>
</td></tr>
<tr><td><code id="dgpTP_+3A_corr">corr</code></td>
<td>
<p>Correlation parameter.
Possible values for the bivariate exponential distribution are between -1 and 1 (0 for independency).
Any value between 0 (not included) and 1 (1 for independency) is accepted for the bivariate Weibull distribution.
</p>
</td></tr>
<tr><td><code id="dgpTP_+3A_dist">dist</code></td>
<td>
<p>Distribution. Possible bivariate distributions are &ldquo;exponential&rdquo; and &ldquo;weibull&rdquo;.</p>
</td></tr>
<tr><td><code id="dgpTP_+3A_dist.par">dist.par</code></td>
<td>
<p>Vector of parameters for the allowed distributions.
Two (scale) parameters for the bivariate exponential distribution and four (2 location parameters and 2 scale parameters)
for the bivariate Weibull distribution. See details below.
</p>
</td></tr>
<tr><td><code id="dgpTP_+3A_model.cens">model.cens</code></td>
<td>
<p>Model for censorship. Possible values are &ldquo;uniform&rdquo; and &ldquo;exponential&rdquo;.</p>
</td></tr>
<tr><td><code id="dgpTP_+3A_cens.par">cens.par</code></td>
<td>
<p>Parameter for the censorship distribution.
For censure model equal to &ldquo;exponential&rdquo; the argument <code>cens.par</code> must be greater than 0.
For censure model equal to &ldquo;uniform&rdquo; the argument must be greater or equal than 0.
</p>
</td></tr>
<tr><td><code id="dgpTP_+3A_state2.prob">state2.prob</code></td>
<td>
<p>The proportion of individuals that enter state 2.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The bivariate exponential distribution, also known as Farlie-Gumbel-Morgenstern distribution is given by
</p>
<p style="text-align: center;"><code class="reqn">F(x,y)=F_1(x)F_2(y)[1+\alpha(1-F_1(x))(1-F_2(y))]</code>
</p>

<p>for <code class="reqn">x\ge0</code> and <code class="reqn">y\ge0</code>. Where the marginal distribution functions <code class="reqn">F_1</code> and <code class="reqn">F_2</code> are exponential with scale parameters <code class="reqn">\theta_1</code> and <code class="reqn">\theta_2</code> and correlation parameter <code class="reqn">\alpha</code>, <code class="reqn">-1 \le \alpha \le 1</code>. <br />
</p>
<p>The bivariate Weibull distribution with two-parameter marginal distributions. It's survival function is given by
</p>
<p style="text-align: center;"><code class="reqn">S(x,y)=P(X&gt;x,Y&gt;y)=e^{-[(\frac{x}{\theta_1})^\frac{\beta_1}{\delta}+(\frac{y}{\theta_2})^\frac{\beta_2}{\delta}]^\delta}</code>
</p>

<p>Where <code class="reqn">0 &lt; \delta \le 1</code> and each marginal distribution has shape parameter <code class="reqn">\beta_i</code> and a scale parameter <code class="reqn">\theta_i</code>, <code class="reqn">i = 1, 2</code>.
</p>


<h3>Value</h3>

<p>An object of class &lsquo;survTP&rsquo;.</p>


<h3>Author(s)</h3>

<p>Artur Araújo, Javier Roca-Pardiñas and Luís Meira-Machado</p>


<h3>References</h3>

<p>Araújo A, Meira-Machado L, Roca-Pardiñas J (2014). TPmsm: Estimation of the Transition Probabilities in
3-State Models. <em>Journal of Statistical Software</em>, <b>62</b>(4), 1-29. <a href="https://doi.org/10.18637/jss.v062.i04">doi:10.18637/jss.v062.i04</a>
</p>
<p>Devroye L. (1986). <em>Non-Uniform Random Variate Generation</em>, New York: Springer-Verlag.
</p>
<p>Johnson M. E. (1987). <em>Multivariate Statistical Simulation</em>, John Wiley and Sons.
</p>
<p>Johnson N., Kotz S. (1972). <em>Distributions in statistics: continuous multivariate distributions</em>, John Wiley and Sons.
</p>
<p>Lu J., Bhattacharya G. (1990). Some new constructions of bivariate weibull models. <em>Annals of Institute of Statistical Mathematics</em>, <b>42</b>(3), 543-559. <a href="https://doi.org/10.1007/BF00049307">doi:10.1007/BF00049307</a>
</p>
<p>Meira-Machado L., Faria S. (2014). A simulation study comparing modeling approaches in an illness-death multi-state model. <em>Communications in Statistics - Simulation and Computation</em>, <b>43</b>(5), 929-946. <a href="https://doi.org/10.1080/03610918.2012.718841">doi:10.1080/03610918.2012.718841</a>
</p>
<p>Meira-Machado, L., Sestelo M. (2019). Estimation in the progressive illness-death model: a nonexhaustive
review. <em>Biometrical Journal</em>, <b>61</b>(2), 245–263. <a href="https://doi.org/10.1002/bimj.201700200">doi:10.1002/bimj.201700200</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+corrTP">corrTP</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Set the number of threads
nth &lt;- setThreadsTP(2);

# Example for the bivariate Exponential distribution
dgpTP(n=100, corr=1, dist="exponential", dist.par=c(1, 1),
model.cens="uniform", cens.par=3, state2.prob=0.5);

# Example for the bivariate Weibull distribution
dgpTP(n=100, corr=1, dist="weibull", dist.par=c(2, 7, 2, 7),
model.cens="exponential", cens.par = 6, state2.prob=0.6);

# Restore the number of threads
setThreadsTP(nth);
</code></pre>

<hr>
<h2 id='heartTP'>More Stanford heart transplant data</h2><span id='topic+heartTP'></span>

<h3>Description</h3>

<p>This contains the Stanford heart transplant data in a different format.
The main data set is in (<code><a href="survival.html#topic+heart">heart</a></code>).
Survival of patients on the waiting list for the Stanford heart transplant program.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(heartTP)</code></pre>


<h3>Format</h3>

<p>A data frame with 103 observations on the following 7 variables.
</p>

<dl>
<dt><code>time1</code></dt><dd><p>Time to transplant/censoring/death, whichever occurs first.</p>
</dd>
<dt><code>event1</code></dt><dd><p>Transplant/censoring/death indicator (transplanted/dead=1, alive=0).</p>
</dd>
<dt><code>Stime</code></dt><dd><p>Time to death/censoring.</p>
</dd>
<dt><code>event</code></dt><dd><p>Censoring indicator (dead=1, alive=0).</p>
</dd>
<dt><code>age</code></dt><dd><p>age-48 years.</p>
</dd>
<dt><code>year</code></dt><dd><p>Year of acceptance; in years after 1 Nov 1967.</p>
</dd>
<dt><code>surgery</code></dt><dd><p>Prior bypass surgery; 1=yes.</p>
</dd>
</dl>



<h3>References</h3>

<p>Crowley J., Hu M. (1977). Covariance analysis of heart transplant survival data. <em>Journal of the American Statistical Association</em>, <b>72</b>(357), 27-36. <a href="https://doi.org/10.2307/2286902">doi:10.2307/2286902</a>
</p>

<hr>
<h2 id='image.TPCmsm'>image method for a TPCmsm object</h2><span id='topic+image.TPCmsm'></span>

<h3>Description</h3>

<p>image method for an object of class &lsquo;TPCmsm&rsquo;.
Creates a grid of colored or gray-scale rectangles with colors corresponding to the values of the transition probabilities.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'TPCmsm'
image(x, image.type="tc", tr.choice, xlim, ylim, zlim=c(0, 1), col, xlab, ylab,
main, sub, key.title, key.axes, las=1, conf.int=FALSE, legend=TRUE, curvlab,
contour=TRUE, nlevels=20, levels=pretty(zlim, nlevels), ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="image.TPCmsm_+3A_x">x</code></td>
<td>
<p>An object of class &lsquo;TPCmsm&rsquo;.</p>
</td></tr>
<tr><td><code id="image.TPCmsm_+3A_image.type">image.type</code></td>
<td>
<p>A character string specifying the type of image.
If &ldquo;tc&rdquo; the image with time in the x axis, covariate in the y axis and transition probability in the z axis is drawn.
If &ldquo;ct&rdquo; the image with covariate in the x axis, time in the y axis and transition probability in the z axis is drawn.
Defaults to &ldquo;tc&rdquo;.
</p>
</td></tr>
<tr><td><code id="image.TPCmsm_+3A_tr.choice">tr.choice</code></td>
<td>
<p>Character vector of the form &lsquo;c(&ldquo;from to&rdquo;, &ldquo;from to&rdquo;)&rsquo;
specifying which transitions should be plotted.
Default, all the transition probabilities are plotted.
</p>
</td></tr>
<tr><td><code id="image.TPCmsm_+3A_xlim">xlim</code></td>
<td>
<p>Limits of x-axis for the plot.</p>
</td></tr>
<tr><td><code id="image.TPCmsm_+3A_ylim">ylim</code></td>
<td>
<p>Limits of y-axis for the plot.</p>
</td></tr>
<tr><td><code id="image.TPCmsm_+3A_zlim">zlim</code></td>
<td>
<p>Limits of z-axis for the plot. Defaults to <code>c(0, 1)</code>.</p>
</td></tr>
<tr><td><code id="image.TPCmsm_+3A_col">col</code></td>
<td>
<p>Vector of colour. Defaults to <code>heat.colors(nlevels)[nlevels:1]</code>.</p>
</td></tr>
<tr><td><code id="image.TPCmsm_+3A_xlab">xlab</code></td>
<td>
<p>x-axis label. If <code>image.type="tc"</code> defaults to &ldquo;Time&rdquo;.
If <code>image.type="ct"</code> defaults to &ldquo;Covariate&rdquo;.
</p>
</td></tr>
<tr><td><code id="image.TPCmsm_+3A_ylab">ylab</code></td>
<td>
<p>y-axis label. If <code>image.type="tc"</code> defaults to &ldquo;Covariate&rdquo;.
If <code>image.type="ct"</code> defaults to &ldquo;Time&rdquo;.
</p>
</td></tr>
<tr><td><code id="image.TPCmsm_+3A_main">main</code></td>
<td>
<p>The main title for the plot. By default no main title is added.</p>
</td></tr>
<tr><td><code id="image.TPCmsm_+3A_sub">sub</code></td>
<td>
<p>A sub title for the plot. By default no sub title is added.</p>
</td></tr>
<tr><td><code id="image.TPCmsm_+3A_key.title">key.title</code></td>
<td>
<p>Statements which add titles for the plot key.</p>
</td></tr>
<tr><td><code id="image.TPCmsm_+3A_key.axes">key.axes</code></td>
<td>
<p>Statements which draw axes on the plot key. This overrides the default axis.</p>
</td></tr>
<tr><td><code id="image.TPCmsm_+3A_las">las</code></td>
<td>
<p>The style of labeling to be used. The default is to use horizontal labeling.</p>
</td></tr>
<tr><td><code id="image.TPCmsm_+3A_conf.int">conf.int</code></td>
<td>
<p>Logical. Whether to display images of confidence regions. Default is FALSE.</p>
</td></tr>
<tr><td><code id="image.TPCmsm_+3A_legend">legend</code></td>
<td>
<p>A logical specifying if a legend should be added.</p>
</td></tr>
<tr><td><code id="image.TPCmsm_+3A_curvlab">curvlab</code></td>
<td>
<p>A character or expression vector to appear in the legend.
Default is the name of the transitions.
</p>
</td></tr>
<tr><td><code id="image.TPCmsm_+3A_contour">contour</code></td>
<td>
<p>If <code>TRUE</code> contour lines are added to the image. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="image.TPCmsm_+3A_nlevels">nlevels</code></td>
<td>
<p>The number of levels to divide the range of z. Defaults to 20 levels.</p>
</td></tr>
<tr><td><code id="image.TPCmsm_+3A_levels">levels</code></td>
<td>
<p>Numeric vector of levels at which to draw contour lines.
Defaults to <code>pretty(zlim, nlevels)</code>.
The breaks of image are set equal to levels.
</p>
</td></tr>
<tr><td><code id="image.TPCmsm_+3A_...">...</code></td>
<td>
<p>Further arguments for image.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No value is returned.
</p>


<h3>Note</h3>

<p>The device is divided by the number of transitions specified by argument <code>tr.choice</code>.
Being the number of columns equal to the number of transitions.
If argument <code>conf.int=TRUE</code> the device is further divided to make room for the confidence regions.
In this case two rows are added, one for each side of the confidence region.
So if <code>conf.int=TRUE</code> the center row provides the image of the estimates.
The upper row provides the upper side of the confidence region.
And the lower row provides the lower side of the confidence region.
</p>


<h3>Author(s)</h3>

<p>Artur Araújo, Javier Roca-Pardiñas and Luís Meira-Machado</p>


<h3>References</h3>

<p>Araújo A, Meira-Machado L, Roca-Pardiñas J (2014). TPmsm: Estimation of the Transition Probabilities in
3-State Models. <em>Journal of Statistical Software</em>, <b>62</b>(4), 1-29. <a href="https://doi.org/10.18637/jss.v062.i04">doi:10.18637/jss.v062.i04</a>
</p>
<p>Meira-Machado L., de Uña-Álvarez J., Datta S. (2011). Conditional Transition Probabilities in a non-Markov Illness-death Model. Discussion Papers in Statistics and Operation Research n 11/03. Department of Statistics and Operations Research, University of Vigo (ISSN: 1888-5756, Deposito Legal VG 1402-2007). <a href="https://depc05.webs.uvigo.es/reports/12_05.pdf">https://depc05.webs.uvigo.es/reports/12_05.pdf</a>
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+contour">contour</a></code>,
<code><a href="Matrix.html#topic+image">image</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Set the number of threads
nth &lt;- setThreadsTP(2);

# Create survTP object
data(heartTP);
heartTP_obj &lt;- with( heartTP, survTP(time1, event1, Stime, event, age=age) );

# Compute LIN conditional transition probabilities with confidence band
TPCmsm_obj &lt;- transLIN(heartTP_obj, s=57, t=310, x=0, conf=TRUE, n.boot=100,
method.boot="basic");

# Plot image with Time in the x-axis
image(TPCmsm_obj, image.type="tc", tr.choice=c("1 1", "1 2", "2 2"),
conf.int=TRUE, ylab="Age");

# Plot image with Time in the y-axis
image(TPCmsm_obj, image.type="ct", tr.choice=c("1 1", "1 2", "1 3"),
conf.int=TRUE, xlab="Age");

# Restore the number of threads
setThreadsTP(nth);
</code></pre>

<hr>
<h2 id='lines.TPCmsm'>lines method for a TPCmsm object</h2><span id='topic+lines.TPCmsm'></span>

<h3>Description</h3>

<p>lines method for an object of class &lsquo;TPCmsm&rsquo;.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'TPCmsm'
lines(x, plot.type="t", tr.choice, col, lty, conf.int=FALSE,
ci.col, ci.lty, legend=FALSE, legend.pos, curvlab, legend.bty="n", ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lines.TPCmsm_+3A_x">x</code></td>
<td>
<p>An object of class &lsquo;TPCmsm&rsquo;.</p>
</td></tr>
<tr><td><code id="lines.TPCmsm_+3A_plot.type">plot.type</code></td>
<td>
<p>A character string specifying the type of plot.
If &ldquo;t&rdquo; the scatterplot of transition probability versus time is plotted.
If &ldquo;c&rdquo; the scatterplot of transition probability versus covariate is plotted.
</p>
</td></tr>
<tr><td><code id="lines.TPCmsm_+3A_tr.choice">tr.choice</code></td>
<td>
<p>Character vector of the form &lsquo;c(&ldquo;from to&rdquo;, &ldquo;from to&rdquo;)&rsquo;
specifying which transitions should be plotted.
Default, all the transition probabilities are plotted.
</p>
</td></tr>
<tr><td><code id="lines.TPCmsm_+3A_col">col</code></td>
<td>
<p>Vector of colour.</p>
</td></tr>
<tr><td><code id="lines.TPCmsm_+3A_lty">lty</code></td>
<td>
<p>Vector of line type. Default is 1:number of transitions.</p>
</td></tr>
<tr><td><code id="lines.TPCmsm_+3A_conf.int">conf.int</code></td>
<td>
<p>Logical. Whether to display pointwise confidence bands. Default is FALSE.</p>
</td></tr>
<tr><td><code id="lines.TPCmsm_+3A_ci.col">ci.col</code></td>
<td>
<p>Colour of the confidence bands. Default is <code>col</code>.</p>
</td></tr>
<tr><td><code id="lines.TPCmsm_+3A_ci.lty">ci.lty</code></td>
<td>
<p>Line type of the confidence bands. Default is 3.</p>
</td></tr>
<tr><td><code id="lines.TPCmsm_+3A_legend">legend</code></td>
<td>
<p>A logical specifying if a legend should be added.</p>
</td></tr>
<tr><td><code id="lines.TPCmsm_+3A_legend.pos">legend.pos</code></td>
<td>
<p>A vector giving the legend's position.
See <code><a href="graphics.html#topic+legend">legend</a></code> for further details.
</p>
</td></tr>
<tr><td><code id="lines.TPCmsm_+3A_curvlab">curvlab</code></td>
<td>
<p>A character or expression vector to appear in the legend.
Default is the name of the transitions.
</p>
</td></tr>
<tr><td><code id="lines.TPCmsm_+3A_legend.bty">legend.bty</code></td>
<td>
<p>Box type for the legend. By default no box is drawn.</p>
</td></tr>
<tr><td><code id="lines.TPCmsm_+3A_...">...</code></td>
<td>
<p>Further arguments for lines.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No value is returned.
</p>


<h3>Author(s)</h3>

<p>Artur Araújo, Javier Roca-Pardiñas and Luís Meira-Machado</p>


<h3>References</h3>

<p>Araújo A, Meira-Machado L, Roca-Pardiñas J (2014). TPmsm: Estimation of the Transition Probabilities in
3-State Models. <em>Journal of Statistical Software</em>, <b>62</b>(4), 1-29. <a href="https://doi.org/10.18637/jss.v062.i04">doi:10.18637/jss.v062.i04</a>
</p>
<p>Meira-Machado L., de Uña-Álvarez J., Datta S. (2011). Conditional Transition Probabilities in a non-Markov Illness-death Model. Discussion Papers in Statistics and Operation Research n 11/03. Department of Statistics and Operations Research, University of Vigo (ISSN: 1888-5756, Deposito Legal VG 1402-2007). <a href="https://depc05.webs.uvigo.es/reports/12_05.pdf">https://depc05.webs.uvigo.es/reports/12_05.pdf</a>
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+legend">legend</a></code>,
<code><a href="graphics.html#topic+lines">lines</a></code>,
<code><a href="graphics.html#topic+plot.default">plot.default</a></code>,
<code><a href="#topic+plot.TPCmsm">plot.TPCmsm</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Set the number of threads
nth &lt;- setThreadsTP(2);

# Create survTP object
data(heartTP);
heartTP_obj &lt;- with( heartTP, survTP(time1, event1, Stime, event, age=age) );

# Compute IPCW1 conditional transition probabilities without confidence band
TPC_IPCW1 &lt;- transIPCW(heartTP_obj, s=57, t=310, x=15, conf=FALSE, method.est=1);

# Compute IPCW2 conditional transition probabilities without confidence band
TPC_IPCW2 &lt;- transIPCW(heartTP_obj, s=57, t=310, x=15, conf=FALSE, method.est=2);

# Compute LIN conditional transition probabilities without confidence band
TPC_LIN &lt;- transLIN(heartTP_obj, s=57, t=310, x=15, conf=FALSE);

# Build covariate plots
tr.choice &lt;- dimnames(TPC_LIN$est)[[3]];
par.orig &lt;- par( c("mfrow", "cex") );
par( mfrow=c(2,3) );
for ( i in seq_len( length(tr.choice) ) ) {
	plot(TPC_IPCW1, plot.type="c", tr.choice=tr.choice[i], legend=FALSE,
	main=tr.choice[i], col=1, lty=1, xlab="", ylab="");
	lines(TPC_IPCW2, plot.type="c", tr.choice=tr.choice[i], legend=FALSE, col=2, lty=1);
	lines(TPC_LIN, plot.type="c", tr.choice=tr.choice[i], legend=FALSE, col=3, lty=1);
}
plot.new();
legend(x="center", legend=c("IPCW1", "IPCW2", "LIN"), col=1:3, lty=1, bty="n", cex=1.5);
par(mfrow=c(1, 1), cex=1.2);
title(xlab="Age", ylab="Transition probability", line=3);
par(par.orig);

# Restore the number of threads
setThreadsTP(nth);
</code></pre>

<hr>
<h2 id='lines.TPmsm'>lines method for a TPmsm object</h2><span id='topic+lines.TPmsm'></span>

<h3>Description</h3>

<p>lines method for an object of class &lsquo;TPmsm&rsquo;.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'TPmsm'
lines(x, tr.choice, col, lty, conf.int=FALSE, ci.col, ci.lty,
legend=FALSE, legend.pos, curvlab, legend.bty="n", ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lines.TPmsm_+3A_x">x</code></td>
<td>
<p>An object of class &lsquo;TPmsm&rsquo;.</p>
</td></tr>
<tr><td><code id="lines.TPmsm_+3A_tr.choice">tr.choice</code></td>
<td>
<p>Character vector of the form &lsquo;c(&ldquo;from to&rdquo;, &ldquo;from to&rdquo;)&rsquo;
specifying which transitions should be plotted.
Default, all the transition probabilities are plotted.
</p>
</td></tr>
<tr><td><code id="lines.TPmsm_+3A_col">col</code></td>
<td>
<p>Vector of colour. Default is black.</p>
</td></tr>
<tr><td><code id="lines.TPmsm_+3A_lty">lty</code></td>
<td>
<p>Vector of line type. Default is 1:number of transitions.</p>
</td></tr>
<tr><td><code id="lines.TPmsm_+3A_conf.int">conf.int</code></td>
<td>
<p>Logical. Whether to display pointwise confidence bands. Default is FALSE.</p>
</td></tr>
<tr><td><code id="lines.TPmsm_+3A_ci.col">ci.col</code></td>
<td>
<p>Colour of the confidence bands. Default is <code>col</code>.</p>
</td></tr>
<tr><td><code id="lines.TPmsm_+3A_ci.lty">ci.lty</code></td>
<td>
<p>Line type of the confidence bands. Default is 3.</p>
</td></tr>
<tr><td><code id="lines.TPmsm_+3A_legend">legend</code></td>
<td>
<p>A logical specifying if a legend should be added.</p>
</td></tr>
<tr><td><code id="lines.TPmsm_+3A_legend.pos">legend.pos</code></td>
<td>
<p>A vector giving the legend's position.
See <code><a href="graphics.html#topic+legend">legend</a></code> for further details.
</p>
</td></tr>
<tr><td><code id="lines.TPmsm_+3A_curvlab">curvlab</code></td>
<td>
<p>A character or expression vector to appear in the legend.
Default is the name of the transitions.
</p>
</td></tr>
<tr><td><code id="lines.TPmsm_+3A_legend.bty">legend.bty</code></td>
<td>
<p>Box type for the legend. By default no box is drawn.</p>
</td></tr>
<tr><td><code id="lines.TPmsm_+3A_...">...</code></td>
<td>
<p>Further arguments for lines.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No value is returned.
</p>


<h3>Author(s)</h3>

<p>Artur Araújo, Javier Roca-Pardiñas and Luís Meira-Machado</p>


<h3>References</h3>

<p>Araújo A, Meira-Machado L, Roca-Pardiñas J (2014). TPmsm: Estimation of the Transition Probabilities in
3-State Models. <em>Journal of Statistical Software</em>, <b>62</b>(4), 1-29. <a href="https://doi.org/10.18637/jss.v062.i04">doi:10.18637/jss.v062.i04</a>
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+legend">legend</a></code>,
<code><a href="graphics.html#topic+lines">lines</a></code>,
<code><a href="graphics.html#topic+plot.default">plot.default</a></code>,
<code><a href="#topic+plot.TPmsm">plot.TPmsm</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Set the number of threads
nth &lt;- setThreadsTP(2);

# Create survTP object
data(bladderTP);
bladderTP_obj &lt;- with( bladderTP, survTP(time1, event1, Stime, event) );

# Compute transition probabilities without confidence band
KMW &lt;- transKMW(object=bladderTP_obj, s=5, t=59, conf=FALSE, method.est=1);
KMPW &lt;- transKMPW(object=bladderTP_obj, s=5, t=59, conf=FALSE, method.est=1);
AJ &lt;- transAJ(object=bladderTP_obj, s=5, t=59, conf=FALSE);
PAJ &lt;- transPAJ(object=bladderTP_obj, s=5, t=59, conf=FALSE);
LIN &lt;- transLIN(object=bladderTP_obj, s=5, t=59, conf=FALSE);
LS &lt;- transLS(object=bladderTP_obj, s=5, t=59, h=c(0.25, 2.5),
nh=25, ncv=50, conf=FALSE);

# Plot '1 2' KMW transition probability estimate
par( mfrow=c(1, 1) );
plot(KMW, tr.choice="1 2", ylab="P12(5, Time)", xlab="Time",
col=1, lty=1, legend=FALSE);

# Add other '1 2' transition probability estimates
lines(KMPW, tr.choice="1 2", col=2, lty=1);
lines(AJ, tr.choice="1 2", col=3, lty=1);
lines(PAJ, tr.choice="1 2", col=4, lty=1);
lines(LIN, tr.choice="1 2", col=5, lty=1);
lines(LS, tr.choice="1 2", col=6, lty=1);

# Add legend
legend(x="topleft", legend=c("KMW", "KMPW", "AJ", "PAJ", "LIN", "LS"),
col=1:6, lty=1, bty="n");

# Plot all the transitions
tr.choice &lt;- colnames(KMW$est);
par.orig &lt;- par( c("mfrow", "cex") );
par( mfrow=c(2, 3) );
for ( i in seq_len( length(tr.choice) ) ) {
	plot(KMW, tr.choice=tr.choice[i], col=1, lty=1, legend=FALSE,
	main=tr.choice[i], xlab="", ylab="");
	lines(KMPW, tr.choice=tr.choice[i], col=2, lty=1);
	lines(AJ, tr.choice=tr.choice[i], col=3, lty=1);
	lines(PAJ, tr.choice=tr.choice[i], col=4, lty=1);
	lines(LIN, tr.choice=tr.choice[i], col=5, lty=1);
	lines(LS, tr.choice=tr.choice[i], col=6, lty=1);
}
plot.new();
legend(x="center", legend=c("KMW", "KMPW", "AJ", "PAJ", "LIN", "LS"),
col=1:6, lty=1, bty="n", cex=1.5);
par(mfrow=c(1, 1), cex=1.2);
title(xlab="Time", ylab="Transition probability", line=3);
par(par.orig);

# Restore the number of threads
setThreadsTP(nth);
</code></pre>

<hr>
<h2 id='plot.TPCmsm'>plot method for a TPCmsm object</h2><span id='topic+plot.TPCmsm'></span>

<h3>Description</h3>

<p>plot method for an object of class &lsquo;TPCmsm&rsquo;.
It draws the estimated transition probabilities in a basic scatterplot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'TPCmsm'
plot(x, plot.type="t", tr.choice, xlab, ylab, col, lty, xlim, ylim,
conf.int=FALSE, ci.col, ci.lty, legend=TRUE, legend.pos, curvlab,
legend.bty="n", ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.TPCmsm_+3A_x">x</code></td>
<td>
<p>An object of class &lsquo;TPCmsm&rsquo;.</p>
</td></tr>
<tr><td><code id="plot.TPCmsm_+3A_plot.type">plot.type</code></td>
<td>
<p>A character string specifying the type of plot.
If &ldquo;t&rdquo; the scatterplot of transition probability versus time is plotted.
If &ldquo;c&rdquo; the scatterplot of transition probability versus covariate is plotted.
</p>
</td></tr>
<tr><td><code id="plot.TPCmsm_+3A_tr.choice">tr.choice</code></td>
<td>
<p>Character vector of the form &lsquo;c(&ldquo;from to&rdquo;, &ldquo;from to&rdquo;)&rsquo;
specifying which transitions should be plotted.
Default, all the transition probabilities are plotted.
</p>
</td></tr>
<tr><td><code id="plot.TPCmsm_+3A_xlab">xlab</code></td>
<td>
<p>x-axis label.</p>
</td></tr>
<tr><td><code id="plot.TPCmsm_+3A_ylab">ylab</code></td>
<td>
<p>y-axis label.</p>
</td></tr>
<tr><td><code id="plot.TPCmsm_+3A_col">col</code></td>
<td>
<p>Vector of colour.</p>
</td></tr>
<tr><td><code id="plot.TPCmsm_+3A_lty">lty</code></td>
<td>
<p>Vector of line type. Default is 1:number of transitions.</p>
</td></tr>
<tr><td><code id="plot.TPCmsm_+3A_xlim">xlim</code></td>
<td>
<p>Limits of x-axis for the plot.</p>
</td></tr>
<tr><td><code id="plot.TPCmsm_+3A_ylim">ylim</code></td>
<td>
<p>Limits of y-axis for the plot.</p>
</td></tr>
<tr><td><code id="plot.TPCmsm_+3A_conf.int">conf.int</code></td>
<td>
<p>Logical. Whether to display pointwise confidence bands. Default is FALSE.</p>
</td></tr>
<tr><td><code id="plot.TPCmsm_+3A_ci.col">ci.col</code></td>
<td>
<p>Colour of the confidence bands. Default is <code>col</code>.</p>
</td></tr>
<tr><td><code id="plot.TPCmsm_+3A_ci.lty">ci.lty</code></td>
<td>
<p>Line type of the confidence bands. Default is 3.</p>
</td></tr>
<tr><td><code id="plot.TPCmsm_+3A_legend">legend</code></td>
<td>
<p>A logical specifying if a legend should be added.</p>
</td></tr>
<tr><td><code id="plot.TPCmsm_+3A_legend.pos">legend.pos</code></td>
<td>
<p>A vector giving the legend's position.
See <code><a href="graphics.html#topic+legend">legend</a></code> for further details.
</p>
</td></tr>
<tr><td><code id="plot.TPCmsm_+3A_curvlab">curvlab</code></td>
<td>
<p>A character or expression vector to appear in the legend.
Default is the name of the transitions.
</p>
</td></tr>
<tr><td><code id="plot.TPCmsm_+3A_legend.bty">legend.bty</code></td>
<td>
<p>Box type for the legend. By default no box is drawn.</p>
</td></tr>
<tr><td><code id="plot.TPCmsm_+3A_...">...</code></td>
<td>
<p>Further arguments for plot.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No value is returned.
</p>


<h3>Author(s)</h3>

<p>Artur Araújo, Javier Roca-Pardiñas and Luís Meira-Machado</p>


<h3>References</h3>

<p>Araújo A, Meira-Machado L, Roca-Pardiñas J (2014). TPmsm: Estimation of the Transition Probabilities in
3-State Models. <em>Journal of Statistical Software</em>, <b>62</b>(4), 1-29. <a href="https://doi.org/10.18637/jss.v062.i04">doi:10.18637/jss.v062.i04</a>
</p>
<p>Meira-Machado L., de Uña-Álvarez J., Datta S. (2011). Conditional Transition Probabilities in a non-Markov Illness-death Model. Discussion Papers in Statistics and Operation Research n 11/03. Department of Statistics and Operations Research, University of Vigo (ISSN: 1888-5756, Deposito Legal VG 1402-2007). <a href="https://depc05.webs.uvigo.es/reports/12_05.pdf">https://depc05.webs.uvigo.es/reports/12_05.pdf</a>
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+legend">legend</a></code>,
<code><a href="graphics.html#topic+plot.default">plot.default</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Set the number of threads
nth &lt;- setThreadsTP(2);

# Create survTP object
data(heartTP);
heartTP_obj &lt;- with( heartTP, survTP(time1, event1, Stime, event, age=age) );

# Compute IPCW conditional transition probabilities with confidence band
TPCmsm_obj &lt;- transIPCW(heartTP_obj, s=57, t=310, x=c(0, 15), conf=TRUE, n.boot=100,
method.boot="percentile", method.est=2);

# Build time plots
tr.choice &lt;- dimnames(TPCmsm_obj$est)[[3]];
par.orig &lt;- par( c("mfrow", "cex") );
par( mfrow=c(2,3) );
for ( i in seq_len( length(tr.choice) ) ) {
	plot( TPCmsm_obj, plot.type="t", tr.choice=tr.choice[i], conf.int=TRUE, legend=TRUE,
	main=tr.choice[i], col=seq_len( length(TPCmsm_obj$x) ), lty=1, xlab="", ylab="",
	curvlab=c("Age = 0", "Age = 15") );
}
par(mfrow=c(1, 1), cex=1.2);
title(xlab="Time", ylab="Transition probability", line=3);
par(par.orig);

# Build covariate plots without colors and without confidence band
plot(TPCmsm_obj, plot.type="c", xlab="Age");

# Build covariate plots with colors and without confidence band
plot(TPCmsm_obj, plot.type="c", col=seq_len(5), lty=1, xlab="Age");

# Build covariate plots with confidence band
tr.choice &lt;- dimnames(TPCmsm_obj$est)[[3]];
par.orig &lt;- par( c("mfrow", "cex") );
par( mfrow=c(2,3) );
for ( i in seq_len( length(tr.choice) ) ) {
	plot(TPCmsm_obj, plot.type="c", tr.choice=tr.choice[i], conf.int=TRUE, legend=FALSE,
	main=tr.choice[i], xlab="", ylab="");
}
par(mfrow=c(1, 1), cex=1.2);
title( xlab="Age", ylab=paste("P(", TPCmsm_obj$s, ", ", TPCmsm_obj$t, " | Age)", sep=""), line=3);
par(par.orig);

# Restore the number of threads
setThreadsTP(nth);
</code></pre>

<hr>
<h2 id='plot.TPmsm'>plot method for a TPmsm object</h2><span id='topic+plot.TPmsm'></span>

<h3>Description</h3>

<p>plot method for an object of class &lsquo;TPmsm&rsquo;.
It draws the estimated transition probabilities in a basic scatterplot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'TPmsm'
plot(x, tr.choice, xlab = "Time", ylab="Transition probability",
col, lty, xlim, ylim, conf.int=FALSE, ci.col, ci.lty,
legend=TRUE, legend.pos, curvlab, legend.bty="n", ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.TPmsm_+3A_x">x</code></td>
<td>
<p>An object of class &lsquo;TPmsm&rsquo;.</p>
</td></tr>
<tr><td><code id="plot.TPmsm_+3A_tr.choice">tr.choice</code></td>
<td>
<p>Character vector of the form &lsquo;c(&ldquo;from to&rdquo;, &ldquo;from to&rdquo;)&rsquo;
specifying which transitions should be plotted.
Default, all the transition probabilities are plotted.
</p>
</td></tr>
<tr><td><code id="plot.TPmsm_+3A_xlab">xlab</code></td>
<td>
<p>x-axis label. Default is &ldquo;Time&rdquo;.</p>
</td></tr>
<tr><td><code id="plot.TPmsm_+3A_ylab">ylab</code></td>
<td>
<p>y-axis label. Default is &ldquo;Transition probability&rdquo;.</p>
</td></tr>
<tr><td><code id="plot.TPmsm_+3A_col">col</code></td>
<td>
<p>Vector of colour. Default is black.</p>
</td></tr>
<tr><td><code id="plot.TPmsm_+3A_lty">lty</code></td>
<td>
<p>Vector of line type. Default is 1:number of transitions.</p>
</td></tr>
<tr><td><code id="plot.TPmsm_+3A_xlim">xlim</code></td>
<td>
<p>Limits of x-axis for the plot.</p>
</td></tr>
<tr><td><code id="plot.TPmsm_+3A_ylim">ylim</code></td>
<td>
<p>Limits of y-axis for the plot.</p>
</td></tr>
<tr><td><code id="plot.TPmsm_+3A_conf.int">conf.int</code></td>
<td>
<p>Logical. Whether to display pointwise confidence bands. Default is FALSE.</p>
</td></tr>
<tr><td><code id="plot.TPmsm_+3A_ci.col">ci.col</code></td>
<td>
<p>Colour of the confidence bands. Default is <code>col</code>.</p>
</td></tr>
<tr><td><code id="plot.TPmsm_+3A_ci.lty">ci.lty</code></td>
<td>
<p>Line type of the confidence bands. Default is 3.</p>
</td></tr>
<tr><td><code id="plot.TPmsm_+3A_legend">legend</code></td>
<td>
<p>A logical specifying if a legend should be added.</p>
</td></tr>
<tr><td><code id="plot.TPmsm_+3A_legend.pos">legend.pos</code></td>
<td>
<p>A vector giving the legend's position.
See <code><a href="graphics.html#topic+legend">legend</a></code> for further details.
</p>
</td></tr>
<tr><td><code id="plot.TPmsm_+3A_curvlab">curvlab</code></td>
<td>
<p>A character or expression vector to appear in the legend.
Default is the name of the transitions.
</p>
</td></tr>
<tr><td><code id="plot.TPmsm_+3A_legend.bty">legend.bty</code></td>
<td>
<p>Box type for the legend. By default no box is drawn.</p>
</td></tr>
<tr><td><code id="plot.TPmsm_+3A_...">...</code></td>
<td>
<p>Further arguments for plot.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No value is returned.
</p>


<h3>Author(s)</h3>

<p>Artur Araújo, Javier Roca-Pardiñas and Luís Meira-Machado</p>


<h3>References</h3>

<p>Araújo A, Meira-Machado L, Roca-Pardiñas J (2014). TPmsm: Estimation of the Transition Probabilities in
3-State Models. <em>Journal of Statistical Software</em>, <b>62</b>(4), 1-29. <a href="https://doi.org/10.18637/jss.v062.i04">doi:10.18637/jss.v062.i04</a>
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+legend">legend</a></code>,
<code><a href="graphics.html#topic+plot.default">plot.default</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Set the number of threads
nth &lt;- setThreadsTP(2);

# Create survTP object
data(bladderTP);
bladderTP_obj &lt;- with( bladderTP, survTP(time1, event1, Stime, event) );

# Compute KMW transition probabilities with confidence band
TPmsm_obj &lt;- transKMW(object=bladderTP_obj, s=5, t=59, conf=TRUE, conf.level=0.95,
method.boot="basic", method.est=2);

# Plot all the transitions without confidence band
plot(TPmsm_obj, conf.int=FALSE, col=seq_len(5), lty=1);

# Plot all the transitions with confidence band
tr.choice &lt;- colnames(TPmsm_obj$est);
par.orig &lt;- par( c("mfrow", "cex") );
par( mfrow=c(2,3) );
for ( i in seq_len( length(tr.choice) ) ) {
	plot(TPmsm_obj, tr.choice=tr.choice[i], conf.int=TRUE, legend=FALSE, main=tr.choice[i],
	xlab="", ylab="");
}
par(mfrow=c(1, 1), cex=1.2);
title(xlab="Time", ylab="Transition probability", line=3);
par(par.orig);

# Restore the number of threads
setThreadsTP(nth);
</code></pre>

<hr>
<h2 id='setPackageSeedTP'>Set the initial package seed</h2><span id='topic+setPackageSeedTP'></span>

<h3>Description</h3>

<p>The random number generator (RNG) with multiple independent streams developed by
L'Ecuyer et al. (2002) is used for parallel computation of uniform pseudorandom numbers.
Package <span class="pkg">TPmsm</span> makes extensive use of uniform pseudorandom numbers,
particularly for the bootstrapping statistical techniques and for
the generation of univariate and multivariate pseudorandom data.
This function defines the seed for the creation of RNG streams.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setPackageSeedTP(seed=12345)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="setPackageSeedTP_+3A_seed">seed</code></td>
<td>
<p>A vector of one to six integers.
Defaults to <code>rep(x=12345, times=6)</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the user defines a vector with length lower than six
as seed, then the seed is internally defined as a vector
of length six with the first elements equal to the user
defined values, and the leaving elements equal to <code>12345</code>.
If a vector with more than six elements is provided as seed,
then only the first six elements are used.
</p>


<h3>Value</h3>

<p>Invisibly returns NULL.</p>


<h3>Note</h3>

<p>When package <span class="pkg">TPmsm</span> loads, an initial set of RNG streams
is created, one stream for each thread available for parallel
computation. The initial set of RNG streams is created from the
package seed <code>c(12345, 12345, 12345, 12345, 12345, 12345)</code>.
Every time this function is called, the old set of RNG streams
is deleted, and a new set of RNG streams is created from the
user defined package seed. After the creation of each new RNG stream,
the internally stored package seed changes. So each RNG stream is
created from a different package seed, and yields different sets of
pseudorandom numbers.
</p>


<h3>Author(s)</h3>

<p>Artur Araújo, Javier Roca-Pardiñas and Luís Meira-Machado</p>


<h3>References</h3>

<p>Araújo A, Meira-Machado L, Roca-Pardiñas J (2014). TPmsm: Estimation of the Transition Probabilities in
3-State Models. <em>Journal of Statistical Software</em>, <b>62</b>(4), 1-29. <a href="https://doi.org/10.18637/jss.v062.i04">doi:10.18637/jss.v062.i04</a>
</p>
<p>Karl A. T., Eubank R., Milovanovic J., Reiser M., Young D. (2014). Using RngStreams for parallel random number generation in C++ and R. <em>Computational Statistics</em>, <b>29</b>(5), 1301-1320. <a href="https://doi.org/10.1007/s00180-014-0492-3">doi:10.1007/s00180-014-0492-3</a>
</p>
<p>L'Ecuyer, P. (1999). Good parameters and implementations for combined multiple recursive random number generators. <em>Operations Research</em>, <b>47</b>(1), 159–-164. <a href="https://doi.org/10.1287/opre.47.1.159">doi:10.1287/opre.47.1.159</a>
</p>
<p>L’Ecuyer P., Simard R., Chen E. J., Kelton W. D. (2002). An object-oriented random-number package with many long streams and substreams. <em>Operations Research</em>, <b>50</b>(6), 1073–-1075. <a href="https://doi.org/10.1287/opre.50.6.1073.358">doi:10.1287/opre.50.6.1073.358</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+setSeedTP">setSeedTP</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Set the number of threads
nth &lt;- setThreadsTP(2);

# Define package seed
seed &lt;- rep(x=1, times=6);

# Set package seed
setPackageSeedTP(seed);

# Create survTP object
data(heartTP);
heartTP_obj &lt;- with( heartTP, survTP(time1, event1, Stime, event) );

# Compute transition probabilities with confidence band
TPmsm0 &lt;- transAJ(object=heartTP_obj, s=33, t=412, conf=TRUE,
conf.level=0.9, method.boot="percentile");

# Compute transition probabilities with confidence band
TPmsm1 &lt;- transAJ(object=heartTP_obj, s=33, t=412, conf=TRUE,
conf.level=0.9, method.boot="percentile");

# The objects should be different
all.equal(TPmsm0, TPmsm1);

# Set package seed
setPackageSeedTP(seed);

# Compute transition probabilities with confidence band
TPmsm2 &lt;- transAJ(object=heartTP_obj, s=33, t=412, conf=TRUE,
conf.level=0.9, method.boot="percentile");

# Both objects were computed from the same seed and should be equal
all.equal(TPmsm0, TPmsm2);

# Restore the number of threads
setThreadsTP(nth);
</code></pre>

<hr>
<h2 id='setSeedTP'>Save and restore RNG stream seeds</h2><span id='topic+setSeedTP'></span>

<h3>Description</h3>

<p>The random number generator (RNG) with multiple independent streams developed by
L'Ecuyer et al. (2002) is used for parallel computation of uniform pseudorandom numbers.
Package <span class="pkg">TPmsm</span> makes extensive use of uniform pseudorandom numbers,
particularly for the bootstrapping statistical techniques and for
the generation of univariate and multivariate pseudorandom data.
This function permits saving and restoring the seed of each individual RNG stream.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setSeedTP(x)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="setSeedTP_+3A_x">x</code></td>
<td>
<p>either a NULL object or an object of class &lsquo;TPmsmSeed&rsquo;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>An object of class &lsquo;TPmsmSeed&rsquo; can be obtained by a previous
call to function <code>setSeedTP</code>, usually <code>setSeedTP(NULL)</code> or <code>setSeedTP()</code>.
The object can be saved and used as input on a later call to function <code>setSeedTP</code>
effectively restoring the seed of each individual RNG stream.
An object of class &lsquo;TPmsmSeed&rsquo; can be manipulated or defined with arbitrary seeds,
however such procedure is not recommended. It is strongly recommended to input
objects of class &lsquo;TPmsmSeed&rsquo; obtained from previous calls to function <code>setSeedTP</code>.
A seed of choice can be defined by calling function <code><a href="#topic+setPackageSeedTP">setPackageSeedTP</a></code>.
</p>


<h3>Value</h3>

<p>Invisibly returns an object of class &lsquo;TPmsmSeed&rsquo;.
&lsquo;TPmsmSeed&rsquo; objects are implemented as a list of RNG stream seeds.
</p>


<h3>Note</h3>

<p>Unlike function <code><a href="#topic+setPackageSeedTP">setPackageSeedTP</a></code> this function doesn't
recreate the RNG streams each time it is called.
</p>


<h3>Author(s)</h3>

<p>Artur Araújo, Javier Roca-Pardiñas and Luís Meira-Machado</p>


<h3>References</h3>

<p>Araújo A, Meira-Machado L, Roca-Pardiñas J (2014). TPmsm: Estimation of the Transition Probabilities in
3-State Models. <em>Journal of Statistical Software</em>, <b>62</b>(4), 1-29. <a href="https://doi.org/10.18637/jss.v062.i04">doi:10.18637/jss.v062.i04</a>
</p>
<p>Karl A. T., Eubank R., Milovanovic J., Reiser M., Young D. (2014). Using RngStreams for parallel random number generation in C++ and R. <em>Computational Statistics</em>, <b>29</b>(5), 1301-1320. <a href="https://doi.org/10.1007/s00180-014-0492-3">doi:10.1007/s00180-014-0492-3</a>
</p>
<p>L'Ecuyer, P. (1999). Good parameters and implementations for combined multiple recursive random number generators. <em>Operations Research</em>, <b>47</b>(1), 159–-164. <a href="https://doi.org/10.1287/opre.47.1.159">doi:10.1287/opre.47.1.159</a>
</p>
<p>L’Ecuyer P., Simard R., Chen E. J., Kelton W. D. (2002). An object-oriented random-number package with many long streams and substreams. <em>Operations Research</em>, <b>50</b>(6), 1073–-1075. <a href="https://doi.org/10.1287/opre.50.6.1073.358">doi:10.1287/opre.50.6.1073.358</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+setPackageSeedTP">setPackageSeedTP</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Set the number of threads
nth &lt;- setThreadsTP(2);

# Generate bivariate survival data
survTP0 &lt;- dgpTP(n=100, corr=1, dist="weibull", dist.par=c(2, 7, 2, 7),
model.cens="exponential", cens.par = 6, state2.prob=0.6);

# Save seed
seed &lt;- setSeedTP();

# Generate bivariate survival data
survTP1 &lt;- dgpTP(n=100, corr=1, dist="weibull", dist.par=c(2, 7, 2, 7),
model.cens="exponential", cens.par = 6, state2.prob=0.6);

# The objects should be different
all.equal(survTP0, survTP1);

# Restore seed
setSeedTP(seed);

# Generate bivariate survival data
survTP2 &lt;- dgpTP(n=100, corr=1, dist="weibull", dist.par=c(2, 7, 2, 7),
model.cens="exponential", cens.par = 6, state2.prob=0.6);

# Both objects were computed from the same seed and should be equal
all.equal(survTP1, survTP2);

# Restore the number of threads
setThreadsTP(nth);
</code></pre>

<hr>
<h2 id='setThreadsTP'>Set the number of threads</h2><span id='topic+setThreadsTP'></span>

<h3>Description</h3>

<p>Specifies the number of threads used by default in parallel sections.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setThreadsTP(num_threads=NULL)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="setThreadsTP_+3A_num_threads">num_threads</code></td>
<td>
<p>the number of threads to use.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>num_threads</code> is greater than the number of processors/cores
then the number of processors/cores is used. If package <span class="pkg">TPmsm</span>
was compiled without OpenMP support then this function returns <code>1</code>
regardless of the number of processors/cores available.
If <code>num_threads=NULL</code> the number of threads is not defined.
This is useful when the current number of threads is desired
without defining a new thread number.
</p>


<h3>Value</h3>

<p>Invisibly returns the previous number of threads.</p>


<h3>Note</h3>

<p>The given thread number is stored in a global variable. This global variable
is then passed to the num_threads clause defined on all parallel sections of
underlying C code. By specifying the number of threads in this way instead of
specifying with a call to omp_set_num_threads we are certain that there is
no interference with the R process. Every time this function is called the
RNG streams are recreated. For more details see <code><a href="#topic+setPackageSeedTP">setPackageSeedTP</a></code>.
</p>


<h3>Author(s)</h3>

<p>Artur Araújo, Javier Roca-Pardiñas and Luís Meira-Machado</p>


<h3>References</h3>

<p>Araújo A, Meira-Machado L, Roca-Pardiñas J (2014). TPmsm: Estimation of the Transition Probabilities in
3-State Models. <em>Journal of Statistical Software</em>, <b>62</b>(4), 1-29. <a href="https://doi.org/10.18637/jss.v062.i04">doi:10.18637/jss.v062.i04</a>
</p>
<p>OpenMP Architecture Review Board, OpenMP Application Program Interface Version 3.0, May 2008, p110. <a href="https://www.openmp.org/wp-content/uploads/spec30.pdf">https://www.openmp.org/wp-content/uploads/spec30.pdf</a>
</p>
<p>&ldquo;Runtime Library Routines&rdquo;, Summary of OpenMP 3.0 C/C++ Syntax, p5. <a href="https://www.openmp.org/wp-content/uploads/OpenMP3.0-SummarySpec.pdf">https://www.openmp.org/wp-content/uploads/OpenMP3.0-SummarySpec.pdf</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Set the number of threads
nth &lt;- setThreadsTP(2);

# Restore the number of threads
setThreadsTP(nth);
</code></pre>

<hr>
<h2 id='survTP'>Create a survTP object</h2><span id='topic+survTP'></span><span id='topic+is.survTP'></span>

<h3>Description</h3>

<p>Creates a &lsquo;survTP&rsquo; object, usually used as input to other functions.</p>


<h3>Usage</h3>

<pre><code class='language-R'>	survTP(time1, event1, Stime, event, ...)
	is.survTP(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="survTP_+3A_time1">time1</code></td>
<td>
<p>Time of the transition into state 2, state 3 or censoring time.</p>
</td></tr>
<tr><td><code id="survTP_+3A_event1">event1</code></td>
<td>
<p>Indicator of transition into state 2 or state 3; 0 if the transition time is censored and 1 otherwise.</p>
</td></tr>
<tr><td><code id="survTP_+3A_stime">Stime</code></td>
<td>
<p>The total time of the process.</p>
</td></tr>
<tr><td><code id="survTP_+3A_event">event</code></td>
<td>
<p>Censoring indicator of the total time of the process; 0 if the total time is censored and 1 otherwise.</p>
</td></tr>
<tr><td><code id="survTP_+3A_...">...</code></td>
<td>
<p>Any number of covariates can be specified.</p>
</td></tr>
<tr><td><code id="survTP_+3A_x">x</code></td>
<td>
<p>Any R object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class &lsquo;survTP&rsquo;.
</p>
<p>&lsquo;survTP&rsquo; objects are implemented as a single element list </p>
<table>
<tr><td><code>data</code></td>
<td>
<p>a data.frame
with <code>time1</code>, <code>event1</code>, <code>Stime</code>, <code>event</code> and covariates as columns.</p>
</td></tr>
</table>
<p>In the case of <code>is.survTP</code>, a logical value <code>TRUE</code> if <code>x</code>
inherits from class &lsquo;survTP&rsquo;, otherwise <code>FALSE</code>.
</p>


<h3>Author(s)</h3>

<p>Artur Araújo, Javier Roca-Pardiñas and Luís Meira-Machado</p>


<h3>References</h3>

<p>Araújo A, Meira-Machado L, Roca-Pardiñas J (2014). TPmsm: Estimation of the Transition Probabilities in
3-State Models. <em>Journal of Statistical Software</em>, <b>62</b>(4), 1-29. <a href="https://doi.org/10.18637/jss.v062.i04">doi:10.18637/jss.v062.i04</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(bladderTP);
bladderTP_obj &lt;- with( bladderTP, survTP(time1, event1, Stime, event) );
#or
bladderTP_obj &lt;- survTP(bladderTP$time1, bladderTP$event1, bladderTP$Stime,
bladderTP$event);
data(heartTP);
heartTP_obj &lt;- with( heartTP, survTP(time1, event1, Stime, event, age=age) );
#or
heartTP_obj &lt;- survTP(heartTP$time1, heartTP$event1, heartTP$Stime,
heartTP$event, age=heartTP$age);
</code></pre>

<hr>
<h2 id='TPmsmOut'>Convert a data.frame in the <span class="pkg">TPmsm</span> format to other formats</h2><span id='topic+TPmsmOut'></span>

<h3>Description</h3>

<p>Converts a data.frame in the <span class="pkg">TPmsm</span> format to formats supported by external packages.</p>


<h3>Usage</h3>

<pre><code class='language-R'>TPmsmOut(data, names, package="p3state.msm")</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TPmsmOut_+3A_data">data</code></td>
<td>
<p>A data.frame in the <span class="pkg">TPmsm</span> format.</p>
</td></tr>
<tr><td><code id="TPmsmOut_+3A_names">names</code></td>
<td>
<p>A character vector of lenght 4,
indicating the variable names equivalent to variable names
&ldquo;time1&rdquo;, &ldquo;event1&rdquo;, &ldquo;Stime&rdquo;, &ldquo;event&rdquo;
in the <span class="pkg">TPmsm</span> format, in this order.
</p>
</td></tr>
<tr><td><code id="TPmsmOut_+3A_package">package</code></td>
<td>
<p>The format of the data.frame.
Possible options are &ldquo;p3state.msm&rdquo; and &ldquo;etm&rdquo;.
Defaults to &ldquo;p3state.msm&rdquo;.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame in the format specified by argument <code>package</code>.</p>


<h3>Author(s)</h3>

<p>Artur Araújo, Javier Roca-Pardiñas and Luís Meira-Machado</p>


<h3>References</h3>

<p>Allignol A., Schumacher M., Beyersmann J. (2011). Empirical Transition Matrix of Multi-State Models: The etm Package. <em>Journal of Statistical Software</em>, <b>38</b>(4), 1-15. <a href="https://doi.org/10.18637/jss.v038.i04">doi:10.18637/jss.v038.i04</a>
</p>
<p>Araújo A, Meira-Machado L, Roca-Pardiñas J (2014). TPmsm: Estimation of the Transition Probabilities in
3-State Models. <em>Journal of Statistical Software</em>, <b>62</b>(4), 1-29. <a href="https://doi.org/10.18637/jss.v062.i04">doi:10.18637/jss.v062.i04</a>
</p>
<p>Meira-Machado L., Roca-Pardiñas J. (2011). p3state.msm: Analyzing Survival Data from an Illness-Death Model. <em>Journal of Statistical Software</em>, <b>38</b>(3), 1-18. <a href="https://doi.org/10.18637/jss.v038.i03">doi:10.18637/jss.v038.i03</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+as.data.frame.survTP">as.data.frame.survTP</a></code>,
<code><a href="#topic+survTP">survTP</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(heartTP);
heartP3 &lt;- TPmsmOut( heartTP, c("time1", "event1", "Stime", "event") );
head(heartP3);
</code></pre>

<hr>
<h2 id='transAJ'>Aalen-Johansen transition probabilities</h2><span id='topic+transAJ'></span>

<h3>Description</h3>

<p>Provides estimates for the transition probabilities based on the Aalen-Johansen estimator, AJ.</p>


<h3>Usage</h3>

<pre><code class='language-R'>transAJ(object, s, t, state.names=c("1", "2", "3"), conf=FALSE, n.boot=1000,
conf.level=0.95, method.boot="percentile")</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="transAJ_+3A_object">object</code></td>
<td>
<p>An object of class &lsquo;survTP&rsquo;.</p>
</td></tr>
<tr><td><code id="transAJ_+3A_s">s</code></td>
<td>
<p>The first time for obtaining estimates for the transition probabilities.
If missing, 0 will be used.
</p>
</td></tr>
<tr><td><code id="transAJ_+3A_t">t</code></td>
<td>
<p>The second time for obtaining estimates for the transition probabilities.
If missing, the maximum of <code>Stime</code> will be used.
</p>
</td></tr>
<tr><td><code id="transAJ_+3A_state.names">state.names</code></td>
<td>
<p>A vector of characters giving the state names.</p>
</td></tr>
<tr><td><code id="transAJ_+3A_conf">conf</code></td>
<td>
<p>Provides pointwise confidence bands. Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="transAJ_+3A_n.boot">n.boot</code></td>
<td>
<p>The number of bootstrap samples. Defaults to 1000 samples.</p>
</td></tr>
<tr><td><code id="transAJ_+3A_conf.level">conf.level</code></td>
<td>
<p>Level of confidence. Defaults to 0.95 (corresponding to 95%).</p>
</td></tr>
<tr><td><code id="transAJ_+3A_method.boot">method.boot</code></td>
<td>
<p>The method used to compute bootstrap confidence bands.
Possible options are &ldquo;percentile&rdquo; and &ldquo;basic&rdquo;.
Defaults to &ldquo;percentile&rdquo;.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class &lsquo;TPmsm&rsquo;. There are methods for <code>contour</code>, <code>image</code>, <code>print</code> and <code>plot</code>.
&lsquo;TPmsm&rsquo; objects are implemented as a list with elements:
</p>
<table>
<tr><td><code>method</code></td>
<td>
<p>A string indicating the type of estimator used in the computation.</p>
</td></tr>
<tr><td><code>est</code></td>
<td>
<p>A matrix with transition probability estimates. The rows being the event times and the columns the 5 possible transitions.</p>
</td></tr>
<tr><td><code>inf</code></td>
<td>
<p>A matrix with the lower transition probabilities of the confidence band. The rows being the event times and the columns the 5 possible transitions.</p>
</td></tr>
<tr><td><code>sup</code></td>
<td>
<p>A matrix with the upper transition probabilities of the confidence band. The rows being the event times and the columns the 5 possible transitions.</p>
</td></tr>
<tr><td><code>time</code></td>
<td>
<p>Vector of times where the transition probabilities are computed.</p>
</td></tr>
<tr><td><code>s</code></td>
<td>
<p>Start of the time interval.</p>
</td></tr>
<tr><td><code>t</code></td>
<td>
<p>End of the time interval.</p>
</td></tr>
<tr><td><code>h</code></td>
<td>
<p>The bandwidth used. If the estimator doesn't require a bandwidth, it's set to <code>NULL</code>.</p>
</td></tr>
<tr><td><code>state.names</code></td>
<td>
<p>A vector of characters giving the states names.</p>
</td></tr>
<tr><td><code>n.boot</code></td>
<td>
<p>Number of bootstrap samples used in the computation of the confidence band.</p>
</td></tr>
<tr><td><code>conf.level</code></td>
<td>
<p>Level of confidence used to compute the confidence band.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Artur Araújo, Javier Roca-Pardiñas and Luís Meira-Machado</p>


<h3>References</h3>

<p>Aalen O. O., Johansen S. (1978) An Empirical Transition Matrix for Nonhomogeneous Markov Chains Based on Censored Observations. <em>Scandinavian Journal of Statistics</em> <b>5</b>(3), 141&ndash;150. <a href="https://www.jstor.org/stable/4615704">https://www.jstor.org/stable/4615704</a>
</p>
<p>Araújo A, Meira-Machado L, Roca-Pardiñas J (2014) TPmsm: Estimation of the Transition Probabilities in
3-State Models. <em>Journal of Statistical Software</em>, <b>62</b>(4), 1&ndash;29. <a href="https://doi.org/10.18637/jss.v062.i04">doi:10.18637/jss.v062.i04</a>
</p>
<p>Davison A. C., Hinkley D. V. (1997) <em>Bootstrap Methods and their Application</em> Chapter 5, Cambridge University Press.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+transIPCW">transIPCW</a></code>,
<code><a href="#topic+transKMPW">transKMPW</a></code>,
<code><a href="#topic+transKMW">transKMW</a></code>,
<code><a href="#topic+transLIN">transLIN</a></code>,
<code><a href="#topic+transLS">transLS</a></code>,
<code><a href="#topic+transPAJ">transPAJ</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Set the number of threads
nth &lt;- setThreadsTP(2);

# Create survTP object
data(heartTP);
heartTP_obj &lt;- with( heartTP, survTP(time1, event1, Stime, event) );

# Compute transition probabilities
transAJ(object=heartTP_obj, s=33, t=412);

# Compute transition probabilities with confidence band
transAJ(object=heartTP_obj, s=33, t=412, conf=TRUE, conf.level=0.9,
method.boot="percentile");

# Restore the number of threads
setThreadsTP(nth);
</code></pre>

<hr>
<h2 id='transIPCW'>Inverse probability censoring weighted transition probabilities</h2><span id='topic+transIPCW'></span>

<h3>Description</h3>

<p>Provides estimates for the transition probabilities based on inverse probability censoring weighted estimators, IPCW.</p>


<h3>Usage</h3>

<pre><code class='language-R'>transIPCW(object, s, t, x, bw="dpik", window="normal", method.weights="NW",
state.names=c("1", "2", "3"), conf=FALSE, n.boot=1000, conf.level=0.95,
method.boot="percentile", method.est=1, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="transIPCW_+3A_object">object</code></td>
<td>
<p>An object of class &lsquo;survTP&rsquo;.</p>
</td></tr>
<tr><td><code id="transIPCW_+3A_s">s</code></td>
<td>
<p>The first time for obtaining estimates for the transition probabilities.
If missing, 0 will be used.
</p>
</td></tr>
<tr><td><code id="transIPCW_+3A_t">t</code></td>
<td>
<p>The second time for obtaining estimates for the transition probabilities.
If missing, the maximum of <code>Stime</code> will be used.
</p>
</td></tr>
<tr><td><code id="transIPCW_+3A_x">x</code></td>
<td>
<p>Covariate values for obtaining estimates for the conditional transition probabilities.
If missing, unconditioned transition probabilities will be computed.
</p>
</td></tr>
<tr><td><code id="transIPCW_+3A_bw">bw</code></td>
<td>
<p>A character string indicating a function to compute a kernel density bandwidth.
Defaults to &ldquo;dpik&rdquo; from package <span class="pkg">KernSmooth</span>.
Alternatively a single numeric value can be specified.
</p>
</td></tr>
<tr><td><code id="transIPCW_+3A_window">window</code></td>
<td>
<p>A character string specifying the desired kernel.
See details below for possible options.
Defaults to &ldquo;normal&rdquo; where the gaussian density kernel will be used.
</p>
</td></tr>
<tr><td><code id="transIPCW_+3A_method.weights">method.weights</code></td>
<td>
<p>A character string specifying the desired weights method.
Possible options are &ldquo;NW&rdquo; for the Nadaraya-Watson weights
and &ldquo;LL&rdquo; for local linear weights. Defaults to &ldquo;NW&rdquo;.
</p>
</td></tr>
<tr><td><code id="transIPCW_+3A_state.names">state.names</code></td>
<td>
<p>A vector of characters giving the state names.</p>
</td></tr>
<tr><td><code id="transIPCW_+3A_conf">conf</code></td>
<td>
<p>Provides pointwise confidence bands. Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="transIPCW_+3A_n.boot">n.boot</code></td>
<td>
<p>The number of bootstrap samples. Defaults to 1000 samples.</p>
</td></tr>
<tr><td><code id="transIPCW_+3A_conf.level">conf.level</code></td>
<td>
<p>Level of confidence. Defaults to 0.95 (corresponding to 95%).</p>
</td></tr>
<tr><td><code id="transIPCW_+3A_method.boot">method.boot</code></td>
<td>
<p>The method used to compute bootstrap confidence bands.
Possible options are &ldquo;percentile&rdquo; and &ldquo;basic&rdquo;.
Defaults to &ldquo;percentile&rdquo;.
</p>
</td></tr>
<tr><td><code id="transIPCW_+3A_method.est">method.est</code></td>
<td>
<p>The method used to compute the estimate. Possible options are 1 or 2.</p>
</td></tr>
<tr><td><code id="transIPCW_+3A_...">...</code></td>
<td>
<p>Further arguments.
Typically these arguments are passed to the function specified by argument <code>bw</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>bw="dpik"</code> then possible options for argument <code>window</code> are &ldquo;normal&rdquo;, &ldquo;box&rdquo;, &ldquo;epanech&rdquo;, &ldquo;biweight&rdquo; or &ldquo;triweight&rdquo;.
When argument <code>bw</code> is numeric then argument <code>window</code> accepts the same options as when <code>bw="dpik"</code> plus one of &ldquo;tricube&rdquo;, &ldquo;triangular&rdquo; or &ldquo;cosine&rdquo;.<br /><br />
If <code>method.est=1</code> then <code class="reqn">p_{11}(s,t|X)</code>, <code class="reqn">p_{12}(s,t|X)</code> and <code class="reqn">p_{22}(s,t|X)</code> are estimated according to the following expressions:<br /><br />
<code class="reqn">p_{11}(s,t|X)=\frac{1-P(Z \leq t|X)}{1-P(Z \leq s|X)}</code>,<br /><br />
<code class="reqn">p_{12}(s,t|X)=\frac{P(Z \leq t|X)-P(Z \leq s|X)-P(s&lt;Z \leq t, T \leq t|X)}{1-P(Z \leq s|X)}</code>,<br /><br />
<code class="reqn">p_{22}(s,t|X) =\frac{P(Z \leq s|X)-P(Z \leq s,T \leq t|X)}{P(Z \leq s|X)-P(T \leq s|X)}</code>.<br /><br />
Then, <code class="reqn">p_{13}(s,t|X)=1-p_{11}(s,t|X)-p_{12}(s,t|X)</code> and <code class="reqn">p_{23}(s,t|X)=1-p_{22}(s,t|X)</code>.<br /><br />
If <code>method.est=2</code> then <code class="reqn">p_{11}(s,t|X)</code>, <code class="reqn">p_{12}(s,t|X)</code> and <code class="reqn">p_{22}(s,t|X)</code> are estimated according to the following expressions:<br /><br />
<code class="reqn">p_{11}(s,t|X)=\frac{P(Z&gt;t|X)}{P(Z&gt;s|X)}</code>,<br /><br />
<code class="reqn">p_{12}(s,t|X)=\frac{P(s&lt;Z \leq t,T&gt;t|X)}{P(Z&gt;s|X)}</code>,<br /><br />
<code class="reqn">p_{22}(s,t|X) =\frac{P(Z \leq s,T&gt;t|X)}{P(Z \leq s, T&gt;s|X)}</code>.<br /><br />
Then, <code class="reqn">p_{13}(s,t|X)=1-p_{11}(s,t|X)-p_{12}(s,t|X)</code> and <code class="reqn">p_{23}(s,t|X)=1-p_{22}(s,t|X)</code>.<br /><br />
</p>


<h3>Value</h3>

<p>If argument <code>x</code> is missing or if argument <code>object</code> doesn't contain a covariate,
an object of class &lsquo;TPmsm&rsquo; is returned. There are methods for <code>contour</code>, <code>image</code>, <code>print</code> and <code>plot</code>.
&lsquo;TPmsm&rsquo; objects are implemented as a list with elements:
</p>
<table>
<tr><td><code>method</code></td>
<td>
<p>A string indicating the type of estimator used in the computation.</p>
</td></tr>
<tr><td><code>est</code></td>
<td>
<p>A matrix with transition probability estimates. The rows being the event times and the columns the 5 possible transitions.</p>
</td></tr>
<tr><td><code>inf</code></td>
<td>
<p>A matrix with the lower transition probabilities of the confidence band. The rows being the event times and the columns the 5 possible transitions.</p>
</td></tr>
<tr><td><code>sup</code></td>
<td>
<p>A matrix with the upper transition probabilities of the confidence band. The rows being the event times and the columns the 5 possible transitions.</p>
</td></tr>
<tr><td><code>time</code></td>
<td>
<p>Vector of times where the transition probabilities are computed.</p>
</td></tr>
<tr><td><code>s</code></td>
<td>
<p>Start of the time interval.</p>
</td></tr>
<tr><td><code>t</code></td>
<td>
<p>End of the time interval.</p>
</td></tr>
<tr><td><code>h</code></td>
<td>
<p>The bandwidth used. If the estimator doesn't require a bandwidth, it's set to <code>NULL</code>.</p>
</td></tr>
<tr><td><code>state.names</code></td>
<td>
<p>A vector of characters giving the states names.</p>
</td></tr>
<tr><td><code>n.boot</code></td>
<td>
<p>Number of bootstrap samples used in the computation of the confidence band.</p>
</td></tr>
<tr><td><code>conf.level</code></td>
<td>
<p>Level of confidence used to compute the confidence band.</p>
</td></tr>
</table>
<p>If argument <code>x</code> is specified and argument <code>object</code> contains a covariate,
an object of class &lsquo;TPCmsm&rsquo; is returned. There are methods for <code>print</code> and <code>plot</code>.
&lsquo;TPCmsm&rsquo; objects are implemented as a list with elements:
</p>
<table>
<tr><td><code>method</code></td>
<td>
<p>A string indicating the type of estimator used in the computation.</p>
</td></tr>
<tr><td><code>est</code></td>
<td>
<p>A 3 dimensional array with transition probability estimates. The first dimension being the event times, the second the covariate values and the last one the 5 possible transitions.</p>
</td></tr>
<tr><td><code>inf</code></td>
<td>
<p>A 3 dimensional array with the lower transition probabilities of the confidence band. The first dimension being the event times, the second the covariate values and the last one the 5 possible transitions.</p>
</td></tr>
<tr><td><code>sup</code></td>
<td>
<p>A 3 dimensional array with the upper transition probabilities of the confidence band. The first dimension being the event times, the second the covariate values and the last one the 5 possible transitions.</p>
</td></tr>
<tr><td><code>time</code></td>
<td>
<p>Vector of times where the transition probabilities are computed.</p>
</td></tr>
<tr><td><code>covariate</code></td>
<td>
<p>Vector of covariate values where the conditional transition probabilities are computed.</p>
</td></tr>
<tr><td><code>s</code></td>
<td>
<p>Start of the time interval.</p>
</td></tr>
<tr><td><code>t</code></td>
<td>
<p>End of the time interval.</p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p>Additional covariate values where the conditional transition probabilities are computed, which may or may not be present in the sample.</p>
</td></tr>
<tr><td><code>h</code></td>
<td>
<p>The bandwidth used.</p>
</td></tr>
<tr><td><code>state.names</code></td>
<td>
<p>A vector of characters giving the states names.</p>
</td></tr>
<tr><td><code>n.boot</code></td>
<td>
<p>Number of bootstrap samples used in the computation of the confidence band.</p>
</td></tr>
<tr><td><code>conf.level</code></td>
<td>
<p>Level of confidence used to compute the confidence band.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Artur Araújo, Javier Roca-Pardiñas and Luís Meira-Machado</p>


<h3>References</h3>

<p>Araújo A, Meira-Machado L, Roca-Pardiñas J (2014). TPmsm: Estimation of the Transition Probabilities in
3-State Models. <em>Journal of Statistical Software</em>, <b>62</b>(4), 1-29. <a href="https://doi.org/10.18637/jss.v062.i04">doi:10.18637/jss.v062.i04</a>
</p>
<p>Meira-Machado L., de Uña-Álvarez J., Datta S. (2011). Conditional Transition Probabilities in a non-Markov Illness-death Model. Discussion Papers in Statistics and Operation Research n 11/03. Department of Statistics and Operations Research, University of Vigo (ISSN: 1888-5756, Deposito Legal VG 1402-2007). <a href="https://depc05.webs.uvigo.es/reports/12_05.pdf">https://depc05.webs.uvigo.es/reports/12_05.pdf</a>
</p>
<p>Meira Machado L. F., de Uña-Álvarez J., Cadarso-Suárez C. (2006). Nonparametric estimation of transition probabilities in a non-Markov illness-death model. <em>Lifetime Data Anal</em>, <b>12</b>(3), 325-344. <a href="https://doi.org/10.1007/s10985-006-9009-x">doi:10.1007/s10985-006-9009-x</a>
</p>
<p>Davison, A. C., Hinkley, D. V. (1997). <em>Bootstrap Methods and their Application</em>, Chapter 5, Cambridge University Press.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+transAJ">transAJ</a></code>,
<code><a href="#topic+transKMPW">transKMPW</a></code>,
<code><a href="#topic+transKMW">transKMW</a></code>,
<code><a href="#topic+transLIN">transLIN</a></code>,
<code><a href="#topic+transLS">transLS</a></code>,
<code><a href="#topic+transPAJ">transPAJ</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Set the number of threads
nth &lt;- setThreadsTP(2);

# Create survTP object with age as covariate
data(heartTP);
heartTP_obj &lt;- with( heartTP, survTP(time1, event1, Stime, event, age=age) );

# Compute unconditioned transition probabilities
transIPCW(object=heartTP_obj, s=33, t=412);

# Compute unconditioned transition probabilities with confidence band
transIPCW(object=heartTP_obj, s=33, t=412, conf=TRUE, conf.level=0.9,
method.boot="basic", method.est=2);

# Compute conditional transition probabilities
transIPCW(object=heartTP_obj, s=33, t=412, x=0);

# Compute conditional transition probabilities with confidence band
transIPCW(object=heartTP_obj, s=33, t=412, x=0, conf=TRUE, conf.level=0.95,
n.boot=100, method.boot="percentile", method.est=2);

# Restore the number of threads
setThreadsTP(nth);
</code></pre>

<hr>
<h2 id='transKMPW'>Presmoothed Kaplan-Meier weighted transition probabilities</h2><span id='topic+transKMPW'></span>

<h3>Description</h3>

<p>Provides estimates for the transition probabilities based on presmoothed Kaplan-Meier weighted estimators, KMPW.</p>


<h3>Usage</h3>

<pre><code class='language-R'>transKMPW(object, s, t, state.names=c("1", "2", "3"), conf=FALSE, n.boot=1000,
conf.level=0.95, method.boot="percentile", method.est=3)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="transKMPW_+3A_object">object</code></td>
<td>
<p>An object of class &lsquo;survTP&rsquo;.</p>
</td></tr>
<tr><td><code id="transKMPW_+3A_s">s</code></td>
<td>
<p>The first time for obtaining estimates for the transition probabilities.
If missing, 0 will be used.
</p>
</td></tr>
<tr><td><code id="transKMPW_+3A_t">t</code></td>
<td>
<p>The second time for obtaining estimates for the transition probabilities.
If missing, the maximum of <code>Stime</code> will be used.
</p>
</td></tr>
<tr><td><code id="transKMPW_+3A_state.names">state.names</code></td>
<td>
<p>A vector of characters giving the state names.</p>
</td></tr>
<tr><td><code id="transKMPW_+3A_conf">conf</code></td>
<td>
<p>Provides pointwise confidence bands. Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="transKMPW_+3A_n.boot">n.boot</code></td>
<td>
<p>The number of bootstrap samples. Defaults to 1000 samples.</p>
</td></tr>
<tr><td><code id="transKMPW_+3A_conf.level">conf.level</code></td>
<td>
<p>Level of confidence. Defaults to 0.95 (corresponding to 95%).</p>
</td></tr>
<tr><td><code id="transKMPW_+3A_method.boot">method.boot</code></td>
<td>
<p>The method used to compute bootstrap confidence bands.
Possible options are &ldquo;percentile&rdquo; and &ldquo;basic&rdquo;.
Defaults to &ldquo;percentile&rdquo;.
</p>
</td></tr>
<tr><td><code id="transKMPW_+3A_method.est">method.est</code></td>
<td>
<p>The method used to compute the estimate. Possible options are 1, 2, 3 or 4.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>method.est=1</code> then <code class="reqn">p_{11}(s,t)</code>, <code class="reqn">p_{12}(s,t)</code> and <code class="reqn">p_{22}(s,t)</code> are estimated according to the following expressions:<br /><br />
<code class="reqn">p_{11}(s,t)=\frac{1-P(Z \leq t)}{1-P(Z \leq s)}</code>,<br /><br />
<code class="reqn">p_{12}(s,t)=\frac{P(Z \leq t)-P(Z \leq s)-P(s&lt;Z \leq t, T \leq t)}{1-P(Z \leq s)}</code>,<br /><br />
<code class="reqn">p_{22}(s,t) =\frac{P(Z \leq s)-P(Z \leq s,T \leq t)}{P(Z \leq s)-P(T \leq s)}</code>.<br /><br />
Then, <code class="reqn">p_{13}(s,t)=1-p_{11}(s,t)-p_{12}(s,t)</code> and <code class="reqn">p_{23}(s,t)=1-p_{22}(s,t)</code>.<br /><br />
If <code>method.est=2</code> then <code class="reqn">p_{11}(s,t)</code>, <code class="reqn">p_{12}(s,t)</code> and <code class="reqn">p_{22}(s,t)</code> are estimated according to the following expressions:<br /><br />
<code class="reqn">p_{11}(s,t)=\frac{P(Z&gt;t)}{P(Z&gt;s)}</code>,<br /><br />
<code class="reqn">p_{12}(s,t)=\frac{P(s&lt;Z \leq t,T&gt;t)}{P(Z&gt;s)}</code>,<br /><br />
<code class="reqn">p_{22}(s,t) =\frac{P(Z \leq s,T&gt;t)}{P(Z \leq s,T&gt;s)}</code>.<br /><br />
Then, <code class="reqn">p_{13}(s,t)=1-p_{11}(s,t)-p_{12}(s,t)</code> and <code class="reqn">p_{23}(s,t)=1-p_{22}(s,t)</code>.<br /><br />
If <code>method.est=3</code> then <code class="reqn">p_{11}(s,t)</code>, <code class="reqn">p_{13}(s,t)</code> and <code class="reqn">p_{23}(s,t)</code> are estimated according to the following expressions:<br /><br />
<code class="reqn">p_{11}(s,t)=\frac{1-P(Z \leq t)}{1-P(Z \leq s)}</code>,<br /><br />
<code class="reqn">p_{13}(s,t)=\frac{P(Z&gt;s,T \leq t)}{1-P(Z \leq s)}</code>,<br /><br />
<code class="reqn">p_{23}(s,t) =\frac{P(Z \leq s,s&lt;T \leq t)}{P(Z \leq s)-P(T \leq s)}</code>.<br /><br />
Then, <code class="reqn">p_{12}(s,t)=1-p_{11}(s,t)-p_{13}(s,t)</code> and <code class="reqn">p_{22}(s,t)=1-p_{23}(s,t)</code>.<br /><br />
If <code>method.est=4</code> then <code class="reqn">p_{11}(s,t)</code>, <code class="reqn">p_{13}(s,t)</code> and <code class="reqn">p_{23}(s,t)</code> are estimated according to the following expressions:<br /><br />
<code class="reqn">p_{11}(s,t)=\frac{P(Z&gt;t)}{P(Z&gt;s)}</code>,<br /><br />
<code class="reqn">p_{13}(s,t)=\frac{P(Z&gt;s,T \leq t)}{P(Z&gt;s)}</code>,<br /><br />
<code class="reqn">p_{23}(s,t) =\frac{P(Z \leq s,s&lt;T \leq t)}{P(Z \leq s,T&gt;s)}</code>.<br /><br />
Then, <code class="reqn">p_{12}(s,t)=1-p_{11}(s,t)-p_{13}(s,t)</code> and <code class="reqn">p_{22}(s,t)=1-p_{23}(s,t)</code>.
</p>


<h3>Value</h3>

<p>An object of class &lsquo;TPmsm&rsquo;. There are methods for <code>contour</code>, <code>image</code>, <code>print</code> and <code>plot</code>.
&lsquo;TPmsm&rsquo; objects are implemented as a list with elements:
</p>
<table>
<tr><td><code>method</code></td>
<td>
<p>A string indicating the type of estimator used in the computation.</p>
</td></tr>
<tr><td><code>est</code></td>
<td>
<p>A matrix with transition probability estimates. The rows being the event times and the columns the 5 possible transitions.</p>
</td></tr>
<tr><td><code>inf</code></td>
<td>
<p>A matrix with the lower transition probabilities of the confidence band. The rows being the event times and the columns the 5 possible transitions.</p>
</td></tr>
<tr><td><code>sup</code></td>
<td>
<p>A matrix with the upper transition probabilities of the confidence band. The rows being the event times and the columns the 5 possible transitions.</p>
</td></tr>
<tr><td><code>time</code></td>
<td>
<p>Vector of times where the transition probabilities are computed.</p>
</td></tr>
<tr><td><code>s</code></td>
<td>
<p>Start of the time interval.</p>
</td></tr>
<tr><td><code>t</code></td>
<td>
<p>End of the time interval.</p>
</td></tr>
<tr><td><code>h</code></td>
<td>
<p>The bandwidth used. If the estimator doesn't require a bandwidth, it's set to <code>NULL</code>.</p>
</td></tr>
<tr><td><code>state.names</code></td>
<td>
<p>A vector of characters giving the states names.</p>
</td></tr>
<tr><td><code>n.boot</code></td>
<td>
<p>Number of bootstrap samples used in the computation of the confidence band.</p>
</td></tr>
<tr><td><code>conf.level</code></td>
<td>
<p>Level of confidence used to compute the confidence band.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Artur Araújo, Javier Roca-Pardiñas and Luís Meira-Machado</p>


<h3>References</h3>

<p>Amorim A. P., de Uña-Álvarez J., Meira Machado L. F. (2011). Presmoothing the transition probabilities in the illness-death model. <em>Statistics and Probability Letters</em>, <b>81</b>(7), 797-806. <a href="https://doi.org/10.1016/j.spl.2011.02.017">doi:10.1016/j.spl.2011.02.017</a>
</p>
<p>Araújo A, Meira-Machado L, Roca-Pardiñas J (2014). TPmsm: Estimation of the Transition Probabilities in
3-State Models. <em>Journal of Statistical Software</em>, <b>62</b>(4), 1-29. <a href="https://doi.org/10.18637/jss.v062.i04">doi:10.18637/jss.v062.i04</a>
</p>
<p>Davison, A. C., Hinkley, D. V. (1997). <em>Bootstrap Methods and their Application</em>, Chapter 5, Cambridge University Press.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+transAJ">transAJ</a></code>,
<code><a href="#topic+transIPCW">transIPCW</a></code>,
<code><a href="#topic+transKMW">transKMW</a></code>,
<code><a href="#topic+transLIN">transLIN</a></code>,
<code><a href="#topic+transLS">transLS</a></code>,
<code><a href="#topic+transPAJ">transPAJ</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Set the number of threads
nth &lt;- setThreadsTP(2);

# Create survTP object
data(heartTP);
heartTP_obj &lt;- with( heartTP, survTP(time1, event1, Stime, event) );

# Compute transition probabilities
transKMPW(object=heartTP_obj, s=33, t=412);

# Compute transition probabilities with confidence band
transKMPW(object=heartTP_obj, s=33, t=412, conf=TRUE, conf.level=0.9,
method.boot="percentile", method.est=4);

# Restore the number of threads
setThreadsTP(nth);
</code></pre>

<hr>
<h2 id='transKMW'>Kaplan-Meier weighted transition probabilities</h2><span id='topic+transKMW'></span>

<h3>Description</h3>

<p>Provides estimates for the transition probabilities based on Kaplan-Meier weighted estimators, KMW.</p>


<h3>Usage</h3>

<pre><code class='language-R'>transKMW(object, s, t, state.names=c("1", "2", "3"), conf=FALSE, n.boot=1000,
conf.level=0.95, method.boot="percentile", method.est=3)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="transKMW_+3A_object">object</code></td>
<td>
<p>An object of class &lsquo;survTP&rsquo;.</p>
</td></tr>
<tr><td><code id="transKMW_+3A_s">s</code></td>
<td>
<p>The first time for obtaining estimates for the transition probabilities.
If missing, 0 will be used.
</p>
</td></tr>
<tr><td><code id="transKMW_+3A_t">t</code></td>
<td>
<p>The second time for obtaining estimates for the transition probabilities.
If missing, the maximum of <code>Stime</code> will be used.
</p>
</td></tr>
<tr><td><code id="transKMW_+3A_state.names">state.names</code></td>
<td>
<p>A vector of characters giving the state names.</p>
</td></tr>
<tr><td><code id="transKMW_+3A_conf">conf</code></td>
<td>
<p>Provides pointwise confidence bands. Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="transKMW_+3A_n.boot">n.boot</code></td>
<td>
<p>The number of bootstrap samples. Defaults to 1000 samples.</p>
</td></tr>
<tr><td><code id="transKMW_+3A_conf.level">conf.level</code></td>
<td>
<p>Level of confidence. Defaults to 0.95 (corresponding to 95%).</p>
</td></tr>
<tr><td><code id="transKMW_+3A_method.boot">method.boot</code></td>
<td>
<p>The method used to compute bootstrap confidence bands.
Possible options are &ldquo;percentile&rdquo; and &ldquo;basic&rdquo;.
Defaults to &ldquo;percentile&rdquo;.
</p>
</td></tr>
<tr><td><code id="transKMW_+3A_method.est">method.est</code></td>
<td>
<p>The method used to compute the estimate. Possible options are 1, 2, 3 or 4.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>method.est=1</code> then <code class="reqn">p_{11}(s,t)</code>, <code class="reqn">p_{12}(s,t)</code> and <code class="reqn">p_{22}(s,t)</code> are estimated according to the following expressions:<br /><br />
<code class="reqn">p_{11}(s,t)=\frac{1-P(Z \leq t)}{1-P(Z \leq s)}</code>,<br /><br />
<code class="reqn">p_{12}(s,t)=\frac{P(Z \leq t)-P(Z \leq s)-P(s&lt;Z \leq t, T \leq t)}{1-P(Z \leq s)}</code>,<br /><br />
<code class="reqn">p_{22}(s,t) =\frac{P(Z \leq s)-P(Z \leq s,T \leq t)}{P(Z \leq s)-P(T \leq s)}</code>.<br /><br />
Then, <code class="reqn">p_{13}(s,t)=1-p_{11}(s,t)-p_{12}(s,t)</code> and <code class="reqn">p_{23}(s,t)=1-p_{22}(s,t)</code>.<br /><br />
If <code>method.est=2</code> then <code class="reqn">p_{11}(s,t)</code>, <code class="reqn">p_{12}(s,t)</code> and <code class="reqn">p_{22}(s,t)</code> are estimated according to the following expressions:<br /><br />
<code class="reqn">p_{11}(s,t)=\frac{P(Z&gt;t)}{P(Z&gt;s)}</code>,<br /><br />
<code class="reqn">p_{12}(s,t)=\frac{P(s&lt;Z \leq t,T&gt;t)}{P(Z&gt;s)}</code>,<br /><br />
<code class="reqn">p_{22}(s,t) =\frac{P(Z \leq s,T&gt;t)}{P(Z \leq s,T&gt;s)}</code>.<br /><br />
Then, <code class="reqn">p_{13}(s,t)=1-p_{11}(s,t)-p_{12}(s,t)</code> and <code class="reqn">p_{23}(s,t)=1-p_{22}(s,t)</code>.<br /><br />
If <code>method.est=3</code> then <code class="reqn">p_{11}(s,t)</code>, <code class="reqn">p_{13}(s,t)</code> and <code class="reqn">p_{23}(s,t)</code> are estimated according to the following expressions:<br /><br />
<code class="reqn">p_{11}(s,t)=\frac{1-P(Z \leq t)}{1-P(Z \leq s)}</code>,<br /><br />
<code class="reqn">p_{13}(s,t)=\frac{P(Z&gt;s,T \leq t)}{1-P(Z \leq s)}</code>,<br /><br />
<code class="reqn">p_{23}(s,t) =\frac{P(Z \leq s,s&lt;T \leq t)}{P(Z \leq s)-P(T \leq s)}</code>.<br /><br />
Then, <code class="reqn">p_{12}(s,t)=1-p_{11}(s,t)-p_{13}(s,t)</code> and <code class="reqn">p_{22}(s,t)=1-p_{23}(s,t)</code>.<br /><br />
If <code>method.est=4</code> then <code class="reqn">p_{11}(s,t)</code>, <code class="reqn">p_{13}(s,t)</code> and <code class="reqn">p_{23}(s,t)</code> are estimated according to the following expressions:<br /><br />
<code class="reqn">p_{11}(s,t)=\frac{P(Z&gt;t)}{P(Z&gt;s)}</code>,<br /><br />
<code class="reqn">p_{13}(s,t)=\frac{P(Z&gt;s,T \leq t)}{P(Z&gt;s)}</code>,<br /><br />
<code class="reqn">p_{23}(s,t) =\frac{P(Z \leq s,s&lt;T \leq t)}{P(Z \leq s,T&gt;s)}</code>.<br /><br />
Then, <code class="reqn">p_{12}(s,t)=1-p_{11}(s,t)-p_{13}(s,t)</code> and <code class="reqn">p_{22}(s,t)=1-p_{23}(s,t)</code>.
</p>


<h3>Value</h3>

<p>An object of class &lsquo;TPmsm&rsquo;. There are methods for <code>contour</code>, <code>image</code>, <code>print</code> and <code>plot</code>.
&lsquo;TPmsm&rsquo; objects are implemented as a list with elements:
</p>
<table>
<tr><td><code>method</code></td>
<td>
<p>A string indicating the type of estimator used in the computation.</p>
</td></tr>
<tr><td><code>est</code></td>
<td>
<p>A matrix with transition probability estimates. The rows being the event times and the columns the 5 possible transitions.</p>
</td></tr>
<tr><td><code>inf</code></td>
<td>
<p>A matrix with the lower transition probabilities of the confidence band. The rows being the event times and the columns the 5 possible transitions.</p>
</td></tr>
<tr><td><code>sup</code></td>
<td>
<p>A matrix with the upper transition probabilities of the confidence band. The rows being the event times and the columns the 5 possible transitions.</p>
</td></tr>
<tr><td><code>time</code></td>
<td>
<p>Vector of times where the transition probabilities are computed.</p>
</td></tr>
<tr><td><code>s</code></td>
<td>
<p>Start of the time interval.</p>
</td></tr>
<tr><td><code>t</code></td>
<td>
<p>End of the time interval.</p>
</td></tr>
<tr><td><code>h</code></td>
<td>
<p>The bandwidth used. If the estimator doesn't require a bandwidth, it's set to <code>NULL</code>.</p>
</td></tr>
<tr><td><code>state.names</code></td>
<td>
<p>A vector of characters giving the states names.</p>
</td></tr>
<tr><td><code>n.boot</code></td>
<td>
<p>Number of bootstrap samples used in the computation of the confidence band.</p>
</td></tr>
<tr><td><code>conf.level</code></td>
<td>
<p>Level of confidence used to compute the confidence band.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Artur Araújo, Javier Roca-Pardiñas and Luís Meira-Machado</p>


<h3>References</h3>

<p>Araújo A, Meira-Machado L, Roca-Pardiñas J (2014). TPmsm: Estimation of the Transition Probabilities in
3-State Models. <em>Journal of Statistical Software</em>, <b>62</b>(4), 1-29. <a href="https://doi.org/10.18637/jss.v062.i04">doi:10.18637/jss.v062.i04</a>
</p>
<p>Meira Machado L. F., de Uña-Álvarez J., Cadarso-Suárez C. (2006). Nonparametric estimation of transition probabilities in a non-Markov illness-death model. <em>Lifetime Data Anal</em>, <b>12</b>(3), 325-344. <a href="https://doi.org/10.1007/s10985-006-9009-x">doi:10.1007/s10985-006-9009-x</a>
</p>
<p>Davison, A. C., Hinkley, D. V. (1997). <em>Bootstrap Methods and their Application</em>, Chapter 5, Cambridge University Press.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+transAJ">transAJ</a></code>,
<code><a href="#topic+transIPCW">transIPCW</a></code>,
<code><a href="#topic+transKMPW">transKMPW</a></code>,
<code><a href="#topic+transLIN">transLIN</a></code>,
<code><a href="#topic+transLS">transLS</a></code>,
<code><a href="#topic+transPAJ">transPAJ</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Set the number of threads
nth &lt;- setThreadsTP(2);

# Create survTP object
data(heartTP);
heartTP_obj &lt;- with( heartTP, survTP(time1, event1, Stime, event) );

# Compute transition probabilities
transKMW(object=heartTP_obj, s=33, t=412);

# Compute transition probabilities with confidence band
transKMW(object=heartTP_obj, s=33, t=412, conf=TRUE, conf.level=0.9,
method.boot="basic", method.est=2);

# Restore the number of threads
setThreadsTP(nth);
</code></pre>

<hr>
<h2 id='transLIN'>LIN based transition probabilities</h2><span id='topic+transLIN'></span>

<h3>Description</h3>

<p>Provides estimates for the transition probabilities based on LIN estimators, LIN.</p>


<h3>Usage</h3>

<pre><code class='language-R'>transLIN(object, s, t, x, bw="dpik", window="normal", method.weights="NW",
state.names=c("1", "2", "3"), conf=FALSE, n.boot=1000, conf.level=0.95,
method.boot="percentile", ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="transLIN_+3A_object">object</code></td>
<td>
<p>An object of class &lsquo;survTP&rsquo;.</p>
</td></tr>
<tr><td><code id="transLIN_+3A_s">s</code></td>
<td>
<p>The first time for obtaining estimates for the transition probabilities.
If missing, 0 will be used.
</p>
</td></tr>
<tr><td><code id="transLIN_+3A_t">t</code></td>
<td>
<p>The second time for obtaining estimates for the transition probabilities.
If missing, the maximum of <code>Stime</code> will be used.
</p>
</td></tr>
<tr><td><code id="transLIN_+3A_x">x</code></td>
<td>
<p>Covariate values for obtaining estimates for the conditional transition probabilities.
If missing, unconditioned transition probabilities will be computed.
</p>
</td></tr>
<tr><td><code id="transLIN_+3A_bw">bw</code></td>
<td>
<p>A character string indicating a function to compute a kernel density bandwidth.
Defaults to &ldquo;dpik&rdquo; from package <span class="pkg">KernSmooth</span>.
Alternatively a single numeric value can be specified.
</p>
</td></tr>
<tr><td><code id="transLIN_+3A_window">window</code></td>
<td>
<p>A character string specifying the desired kernel.
See details below for possible options.
Defaults to &ldquo;normal&rdquo; where the gaussian density kernel will be used.
</p>
</td></tr>
<tr><td><code id="transLIN_+3A_method.weights">method.weights</code></td>
<td>
<p>A character string specifying the desired weights method.
Possible options are &ldquo;NW&rdquo; for the Nadaraya-Watson weights
and &ldquo;LL&rdquo; for local linear weights. Defaults to &ldquo;NW&rdquo;.
</p>
</td></tr>
<tr><td><code id="transLIN_+3A_state.names">state.names</code></td>
<td>
<p>A vector of characters giving the state names.</p>
</td></tr>
<tr><td><code id="transLIN_+3A_conf">conf</code></td>
<td>
<p>Provides pointwise confidence bands. Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="transLIN_+3A_n.boot">n.boot</code></td>
<td>
<p>The number of bootstrap samples. Defaults to 1000 samples.</p>
</td></tr>
<tr><td><code id="transLIN_+3A_conf.level">conf.level</code></td>
<td>
<p>Level of confidence. Defaults to 0.95 (corresponding to 95%).</p>
</td></tr>
<tr><td><code id="transLIN_+3A_method.boot">method.boot</code></td>
<td>
<p>The method used to compute bootstrap confidence bands.
Possible options are &ldquo;percentile&rdquo; and &ldquo;basic&rdquo;.
Defaults to &ldquo;percentile&rdquo;.
</p>
</td></tr>
<tr><td><code id="transLIN_+3A_...">...</code></td>
<td>
<p>Further arguments.
Typically these arguments are passed to the function specified by argument <code>bw</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>bw="dpik"</code> then possible options for argument <code>window</code> are &ldquo;normal&rdquo;, &ldquo;box&rdquo;, &ldquo;epanech&rdquo;, &ldquo;biweight&rdquo; or &ldquo;triweight&rdquo;.
When argument <code>bw</code> is numeric then argument <code>window</code> accepts the same options as when <code>bw="dpik"</code> plus one of &ldquo;tricube&rdquo;, &ldquo;triangular&rdquo; or &ldquo;cosine&rdquo;.
</p>


<h3>Value</h3>

<p>If argument <code>x</code> is missing or if argument <code>object</code> doesn't contain a covariate,
an object of class &lsquo;TPmsm&rsquo; is returned. There are methods for <code>contour</code>, <code>image</code>, <code>print</code> and <code>plot</code>.
&lsquo;TPmsm&rsquo; objects are implemented as a list with elements:
</p>
<table>
<tr><td><code>method</code></td>
<td>
<p>A string indicating the type of estimator used in the computation.</p>
</td></tr>
<tr><td><code>est</code></td>
<td>
<p>A matrix with transition probability estimates. The rows being the event times and the columns the 5 possible transitions.</p>
</td></tr>
<tr><td><code>inf</code></td>
<td>
<p>A matrix with the lower transition probabilities of the confidence band. The rows being the event times and the columns the 5 possible transitions.</p>
</td></tr>
<tr><td><code>sup</code></td>
<td>
<p>A matrix with the upper transition probabilities of the confidence band. The rows being the event times and the columns the 5 possible transitions.</p>
</td></tr>
<tr><td><code>time</code></td>
<td>
<p>Vector of times where the transition probabilities are computed.</p>
</td></tr>
<tr><td><code>s</code></td>
<td>
<p>Start of the time interval.</p>
</td></tr>
<tr><td><code>t</code></td>
<td>
<p>End of the time interval.</p>
</td></tr>
<tr><td><code>h</code></td>
<td>
<p>The bandwidth used. If the estimator doesn't require a bandwidth, it's set to <code>NULL</code>.</p>
</td></tr>
<tr><td><code>state.names</code></td>
<td>
<p>A vector of characters giving the states names.</p>
</td></tr>
<tr><td><code>n.boot</code></td>
<td>
<p>Number of bootstrap samples used in the computation of the confidence band.</p>
</td></tr>
<tr><td><code>conf.level</code></td>
<td>
<p>Level of confidence used to compute the confidence band.</p>
</td></tr>
</table>
<p>If argument <code>x</code> is specified and argument <code>object</code> contains a covariate,
an object of class &lsquo;TPCmsm&rsquo; is returned. There are methods for <code>print</code> and <code>plot</code>.
&lsquo;TPCmsm&rsquo; objects are implemented as a list with elements:
</p>
<table>
<tr><td><code>method</code></td>
<td>
<p>A string indicating the type of estimator used in the computation.</p>
</td></tr>
<tr><td><code>est</code></td>
<td>
<p>A 3 dimensional array with transition probability estimates. The first dimension being the event times, the second the covariate values and the last one the 5 possible transitions.</p>
</td></tr>
<tr><td><code>inf</code></td>
<td>
<p>A 3 dimensional array with the lower transition probabilities of the confidence band. The first dimension being the event times, the second the covariate values and the last one the 5 possible transitions.</p>
</td></tr>
<tr><td><code>sup</code></td>
<td>
<p>A 3 dimensional array with the upper transition probabilities of the confidence band. The first dimension being the event times, the second the covariate values and the last one the 5 possible transitions.</p>
</td></tr>
<tr><td><code>time</code></td>
<td>
<p>Vector of times where the transition probabilities are computed.</p>
</td></tr>
<tr><td><code>covariate</code></td>
<td>
<p>Vector of covariate values where the conditional transition probabilities are computed.</p>
</td></tr>
<tr><td><code>s</code></td>
<td>
<p>Start of the time interval.</p>
</td></tr>
<tr><td><code>t</code></td>
<td>
<p>End of the time interval.</p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p>Additional covariate values where the conditional transition probabilities are computed, which may or may not be present in the sample.</p>
</td></tr>
<tr><td><code>h</code></td>
<td>
<p>The bandwidth used.</p>
</td></tr>
<tr><td><code>state.names</code></td>
<td>
<p>A vector of characters giving the states names.</p>
</td></tr>
<tr><td><code>n.boot</code></td>
<td>
<p>Number of bootstrap samples used in the computation of the confidence band.</p>
</td></tr>
<tr><td><code>conf.level</code></td>
<td>
<p>Level of confidence used to compute the confidence band.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Artur Araújo, Javier Roca-Pardiñas and Luís Meira-Machado</p>


<h3>References</h3>

<p>Araújo A, Meira-Machado L, Roca-Pardiñas J (2014). TPmsm: Estimation of the Transition Probabilities in
3-State Models. <em>Journal of Statistical Software</em>, <b>62</b>(4), 1-29. <a href="https://doi.org/10.18637/jss.v062.i04">doi:10.18637/jss.v062.i04</a>
</p>
<p>Meira-Machado L., de Uña-Álvarez J., Datta S. (2011). Conditional Transition Probabilities in a non-Markov Illness-death Model. Discussion Papers in Statistics and Operation Research n 11/03. Department of Statistics and Operations Research, University of Vigo (ISSN: 1888-5756, Deposito Legal VG 1402-2007). <a href="https://depc05.webs.uvigo.es/reports/12_05.pdf">https://depc05.webs.uvigo.es/reports/12_05.pdf</a>
</p>
<p>Meira Machado L. F., de Uña-Álvarez J., Cadarso-Suárez C. (2006). Nonparametric estimation of transition probabilities in a non-Markov illness-death model. <em>Lifetime Data Anal</em>, <b>12</b>(3), 325-344. <a href="https://doi.org/10.1007/s10985-006-9009-x">doi:10.1007/s10985-006-9009-x</a>
</p>
<p>Davison, A. C., Hinkley, D. V. (1997). <em>Bootstrap Methods and their Application</em>, Chapter 5, Cambridge University Press.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+transAJ">transAJ</a></code>,
<code><a href="#topic+transIPCW">transIPCW</a></code>,
<code><a href="#topic+transKMPW">transKMPW</a></code>,
<code><a href="#topic+transKMW">transKMW</a></code>,
<code><a href="#topic+transLS">transLS</a></code>,
<code><a href="#topic+transPAJ">transPAJ</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Set the number of threads
nth &lt;- setThreadsTP(2);

# Create survTP object with age as covariate
data(heartTP);
heartTP_obj &lt;- with( heartTP, survTP(time1, event1, Stime, event, age=age) );

# Compute unconditioned transition probabilities
transLIN(object=heartTP_obj, s=33, t=412);

# Compute unconditioned transition probabilities with confidence band
transLIN(object=heartTP_obj, s=33, t=412, conf=TRUE, conf.level=0.9,
method.boot="basic");

# Compute conditional transition probabilities
transLIN(object=heartTP_obj, s=33, t=412, x=0);

# Compute conditional transition probabilities with confidence band
transLIN(object=heartTP_obj, s=33, t=412, x=0, conf=TRUE, conf.level=0.95,
n.boot=100, method.boot="percentile");

# Restore the number of threads
setThreadsTP(nth);
</code></pre>

<hr>
<h2 id='transLS'>Location-Scale transition probabilities</h2><span id='topic+transLS'></span>

<h3>Description</h3>

<p>Provides estimates for the transition probabilities based on the Location-Scale estimator, LS.</p>


<h3>Usage</h3>

<pre><code class='language-R'>transLS(object, s, t, h, nh=40, ncv=10, window="normal", state.names=c("1", "2", "3"),
conf=FALSE, n.boot=1000, conf.level=0.95, method.boot="percentile", boot.cv=FALSE,
cv.full=TRUE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="transLS_+3A_object">object</code></td>
<td>
<p>An object of class &lsquo;survTP&rsquo;.</p>
</td></tr>
<tr><td><code id="transLS_+3A_s">s</code></td>
<td>
<p>The first time for obtaining estimates for the transition probabilities.
If missing, 0 will be used.
</p>
</td></tr>
<tr><td><code id="transLS_+3A_t">t</code></td>
<td>
<p>The second time for obtaining estimates for the transition probabilities.
If missing, the maximum of <code>Stime</code> will be used.
</p>
</td></tr>
<tr><td><code id="transLS_+3A_h">h</code></td>
<td>
<p>A vector with 1 up to 4 values, indicating the minimum and maximum bandwidths to test by cross-validation.</p>
</td></tr>
<tr><td><code id="transLS_+3A_nh">nh</code></td>
<td>
<p>The number of bandwidth values to test by cross-validation. Defaults to 40.</p>
</td></tr>
<tr><td><code id="transLS_+3A_ncv">ncv</code></td>
<td>
<p>The number of cross-validation samples. Defaults to 10.</p>
</td></tr>
<tr><td><code id="transLS_+3A_window">window</code></td>
<td>
<p>A character string specifying the desired kernel. Possible options are
&ldquo;normal&rdquo;, &ldquo;epanech&rdquo;, &ldquo;biweight&rdquo;, &ldquo;triweight&rdquo;, &ldquo;box&rdquo;, &ldquo;tricube&rdquo;, &ldquo;triangular&rdquo; or &ldquo;cosine&rdquo;.
Defaults to &ldquo;normal&rdquo; where the gaussian density kernel will be used.
</p>
</td></tr>
<tr><td><code id="transLS_+3A_state.names">state.names</code></td>
<td>
<p>A vector of characters giving the state names.</p>
</td></tr>
<tr><td><code id="transLS_+3A_conf">conf</code></td>
<td>
<p>Provides pointwise confidence bands. Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="transLS_+3A_n.boot">n.boot</code></td>
<td>
<p>The number of bootstrap samples. Defaults to 1000 samples.</p>
</td></tr>
<tr><td><code id="transLS_+3A_conf.level">conf.level</code></td>
<td>
<p>Level of confidence. Defaults to 0.95 (corresponding to 95%).</p>
</td></tr>
<tr><td><code id="transLS_+3A_method.boot">method.boot</code></td>
<td>
<p>The method used to compute bootstrap confidence bands.
Possible options are &ldquo;percentile&rdquo; and &ldquo;basic&rdquo;.
Defaults to &ldquo;percentile&rdquo;.
</p>
</td></tr>
<tr><td><code id="transLS_+3A_boot.cv">boot.cv</code></td>
<td>
<p>If <code>TRUE</code> the bandwidth is computed by cross-validation for each bootstrap sample.
If <code>FALSE</code> the bandwidth used to compute the estimates is used to compute each bootstrap estimate.
Defaults to <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="transLS_+3A_cv.full">cv.full</code></td>
<td>
<p>If <code>TRUE</code> the bandwidth is computed by cross-validation for both the location and scale functions.
If <code>FALSE</code> the bandwidth is computed by cross-validation only for the location function.
And the bandwidth for the scale function is taken to be equal to the location one. Defaults to <code>TRUE</code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class &lsquo;TPmsm&rsquo;. There are methods for <code>contour</code>, <code>image</code>, <code>print</code> and <code>plot</code>.
&lsquo;TPmsm&rsquo; objects are implemented as a list with elements:
</p>
<table>
<tr><td><code>method</code></td>
<td>
<p>A string indicating the type of estimator used in the computation.</p>
</td></tr>
<tr><td><code>est</code></td>
<td>
<p>A matrix with transition probability estimates. The rows being the event times and the columns the 5 possible transitions.</p>
</td></tr>
<tr><td><code>inf</code></td>
<td>
<p>A matrix with the lower transition probabilities of the confidence band. The rows being the event times and the columns the 5 possible transitions.</p>
</td></tr>
<tr><td><code>sup</code></td>
<td>
<p>A matrix with the upper transition probabilities of the confidence band. The rows being the event times and the columns the 5 possible transitions.</p>
</td></tr>
<tr><td><code>time</code></td>
<td>
<p>Vector of times where the transition probabilities are computed.</p>
</td></tr>
<tr><td><code>s</code></td>
<td>
<p>Start of the time interval.</p>
</td></tr>
<tr><td><code>t</code></td>
<td>
<p>End of the time interval.</p>
</td></tr>
<tr><td><code>h</code></td>
<td>
<p>The bandwidth used. If the estimator doesn't require a bandwidth, it's set to <code>NULL</code>.</p>
</td></tr>
<tr><td><code>state.names</code></td>
<td>
<p>A vector of characters giving the states names.</p>
</td></tr>
<tr><td><code>n.boot</code></td>
<td>
<p>Number of bootstrap samples used in the computation of the confidence band.</p>
</td></tr>
<tr><td><code>conf.level</code></td>
<td>
<p>Level of confidence used to compute the confidence band.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Artur Araújo, Javier Roca-Pardiñas and Luís Meira-Machado</p>


<h3>References</h3>

<p>Araújo A, Meira-Machado L, Roca-Pardiñas J (2014). TPmsm: Estimation of the Transition Probabilities in
3-State Models. <em>Journal of Statistical Software</em>, <b>62</b>(4), 1-29. <a href="https://doi.org/10.18637/jss.v062.i04">doi:10.18637/jss.v062.i04</a>
</p>
<p>Meira-Machado L., Roca-Pardiñas J., Van Keilegom I., Cadarso-Suárez C. (2013). Bandwidth Selection for the Estimation of Transition Probabilities in the Location-Scale Progressive Three-State Model. <em>Computational Statistics</em>, <b>28</b>(5), 2185-2210. <a href="https://doi.org/10.1007/s00180-013-0402-0">doi:10.1007/s00180-013-0402-0</a>
</p>
<p>Meira-Machado L., Roca-Pardiñas J., Van Keilegom I., Cadarso-Suárez C. (2010). Estimation of transition probabilities in a non-Markov model with successive survival times. <a href="https://sites.uclouvain.be/IAP-Stat-Phase-V-VI/ISBApub/dp2010/DP1053.pdf">https://sites.uclouvain.be/IAP-Stat-Phase-V-VI/ISBApub/dp2010/DP1053.pdf</a>
</p>
<p>Van Keilegom I., de Uña-Álvarez J., Meira-Machado L. (2011). Nonparametric location-scale models for successive survival times under dependent censoring. <em>Journal of Statistical Planning and Inference</em>, <b>141</b>(3), 1118-1131. <a href="https://doi.org/10.1016/j.jspi.2010.09.010">doi:10.1016/j.jspi.2010.09.010</a>
</p>
<p>Davison, A. C., Hinkley, D. V. (1997). <em>Bootstrap Methods and their Application</em>, Chapter 5, Cambridge University Press.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+transAJ">transAJ</a></code>,
<code><a href="#topic+transIPCW">transIPCW</a></code>,
<code><a href="#topic+transKMPW">transKMPW</a></code>,
<code><a href="#topic+transKMW">transKMW</a></code>,
<code><a href="#topic+transLIN">transLIN</a></code>,
<code><a href="#topic+transPAJ">transPAJ</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Set the number of threads
nth &lt;- setThreadsTP(2);

# Create survTP object
data(bladderTP);
bladderTP_obj &lt;- with( bladderTP, survTP(time1, event1, Stime, event) );

# Compute transition probabilities
LS0 &lt;- transLS(object=bladderTP_obj, s=5, t=59, h=c(0.25, 2.5), nh=25, ncv=50, conf=FALSE);
print(LS0);

# Compute transition probabilities with confidence band
h &lt;- with( LS0, c( rep(h[1], 2), rep(h[2], 2) ) );
transLS(object=bladderTP_obj, s=5, t=59, h=h, conf=TRUE,
conf.level=0.95, method.boot="percentile", boot.cv=FALSE);

# Restore the number of threads
setThreadsTP(nth);
</code></pre>

<hr>
<h2 id='transPAJ'>Presmoothed Aalen-Johansen transition probabilities</h2><span id='topic+transPAJ'></span>

<h3>Description</h3>

<p>Provides estimates for the transition probabilities based on the presmoothed Aalen-Johansen estimator, PAJ.</p>


<h3>Usage</h3>

<pre><code class='language-R'>transPAJ(object, s, t, state.names=c("1", "2", "3"), conf=FALSE, n.boot=1000,
conf.level=0.95, method.boot="percentile")</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="transPAJ_+3A_object">object</code></td>
<td>
<p>An object of class &lsquo;survTP&rsquo;.</p>
</td></tr>
<tr><td><code id="transPAJ_+3A_s">s</code></td>
<td>
<p>The first time for obtaining estimates for the transition probabilities.
If missing, 0 will be used.
</p>
</td></tr>
<tr><td><code id="transPAJ_+3A_t">t</code></td>
<td>
<p>The second time for obtaining estimates for the transition probabilities.
If missing, the maximum of <code>Stime</code> will be used.
</p>
</td></tr>
<tr><td><code id="transPAJ_+3A_state.names">state.names</code></td>
<td>
<p>A vector of characters giving the state names.</p>
</td></tr>
<tr><td><code id="transPAJ_+3A_conf">conf</code></td>
<td>
<p>Provides pointwise confidence bands. Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="transPAJ_+3A_n.boot">n.boot</code></td>
<td>
<p>The number of bootstrap samples. Defaults to 1000 samples.</p>
</td></tr>
<tr><td><code id="transPAJ_+3A_conf.level">conf.level</code></td>
<td>
<p>Level of confidence. Defaults to 0.95 (corresponding to 95%).</p>
</td></tr>
<tr><td><code id="transPAJ_+3A_method.boot">method.boot</code></td>
<td>
<p>The method used to compute bootstrap confidence bands.
Possible options are &ldquo;percentile&rdquo; and &ldquo;basic&rdquo;.
Defaults to &ldquo;percentile&rdquo;.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class &lsquo;TPmsm&rsquo;. There are methods for <code>contour</code>, <code>image</code>, <code>print</code> and <code>plot</code>.
&lsquo;TPmsm&rsquo; objects are implemented as a list with elements:
</p>
<table>
<tr><td><code>method</code></td>
<td>
<p>A string indicating the type of estimator used in the computation.</p>
</td></tr>
<tr><td><code>est</code></td>
<td>
<p>A matrix with transition probability estimates. The rows being the event times and the columns the 5 possible transitions.</p>
</td></tr>
<tr><td><code>inf</code></td>
<td>
<p>A matrix with the lower transition probabilities of the confidence band. The rows being the event times and the columns the 5 possible transitions.</p>
</td></tr>
<tr><td><code>sup</code></td>
<td>
<p>A matrix with the upper transition probabilities of the confidence band. The rows being the event times and the columns the 5 possible transitions.</p>
</td></tr>
<tr><td><code>time</code></td>
<td>
<p>Vector of times where the transition probabilities are computed.</p>
</td></tr>
<tr><td><code>s</code></td>
<td>
<p>Start of the time interval.</p>
</td></tr>
<tr><td><code>t</code></td>
<td>
<p>End of the time interval.</p>
</td></tr>
<tr><td><code>h</code></td>
<td>
<p>The bandwidth used. If the estimator doesn't require a bandwidth, it's set to <code>NULL</code>.</p>
</td></tr>
<tr><td><code>state.names</code></td>
<td>
<p>A vector of characters giving the states names.</p>
</td></tr>
<tr><td><code>n.boot</code></td>
<td>
<p>Number of bootstrap samples used in the computation of the confidence band.</p>
</td></tr>
<tr><td><code>conf.level</code></td>
<td>
<p>Level of confidence used to compute the confidence band.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Artur Araújo, Javier Roca-Pardiñas and Luís Meira-Machado</p>


<h3>References</h3>

<p>Araújo A, Meira-Machado L, Roca-Pardiñas J (2014). TPmsm: Estimation of the Transition Probabilities in
3-State Models. <em>Journal of Statistical Software</em>, <b>62</b>(4), 1-29. <a href="https://doi.org/10.18637/jss.v062.i04">doi:10.18637/jss.v062.i04</a>
</p>
<p>Moreira A., de Uña-Álvarez J. and Meira-Machado L. (2011). Presmoothing the Aalen-Johansen estimator of transition probabilities. Discussion Papers in Statistics and Operation Research n 11/03. Department of Statistics and Operations Research, University of Vigo (ISSN: 1888-5756, Deposito Legal VG 1402-2007). <a href="https://depc05.webs.uvigo.es/reports/11_03.pdf">https://depc05.webs.uvigo.es/reports/11_03.pdf</a>
</p>
<p>Davison A. C., Hinkley D. V. (1997). <em>Bootstrap Methods and their Application</em>, Chapter 5, Cambridge University Press.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+transAJ">transAJ</a></code>,
<code><a href="#topic+transIPCW">transIPCW</a></code>,
<code><a href="#topic+transKMPW">transKMPW</a></code>,
<code><a href="#topic+transKMW">transKMW</a></code>,
<code><a href="#topic+transLIN">transLIN</a></code>,
<code><a href="#topic+transLS">transLS</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Set the number of threads
nth &lt;- setThreadsTP(2);

# Create survTP object
data(heartTP);
heartTP_obj &lt;- with( heartTP, survTP(time1, event1, Stime, event) );

# Compute transition probabilities
transPAJ(object=heartTP_obj, s=33, t=412);

# Compute transition probabilities with confidence band
transPAJ(object=heartTP_obj, s=33, t=412, conf=TRUE, conf.level=0.9,
method.boot="percentile");

# Restore the number of threads
setThreadsTP(nth);
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
