<!DOCTYPE html><html><head><title>Help for package AeRobiology</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {AeRobiology}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#AeRobiology'><p><code>AeRobiology</code> package</p></a></li>
<li><a href='#analyse_trend'><p>Calculating and Plotting Trends of Pollen Data (summary plot).</p></a></li>
<li><a href='#calculate_ps'><p>Estimation of the Main Parameters of the Pollen Season</p></a></li>
<li><a href='#credits'><p>A view of the creators</p></a></li>
<li><a href='#interpollen'><p>Interpolation of Missing Data in a Pollen Database by Different Methods</p></a></li>
<li><a href='#iplot_abundance'><p>Plot of the Relative Abundance of the Pollen Types</p></a></li>
<li><a href='#iplot_pheno'><p>Phenological Plot</p></a></li>
<li><a href='#iplot_pollen'><p>Interactive Plotting Pollen Data (one season).</p></a></li>
<li><a href='#iplot_years'><p>Interactive Plotting Pollen Data (one pollen type).</p></a></li>
<li><a href='#ma'><p>Moving Average Calculator</p></a></li>
<li><a href='#munich_pollen'><p>Pollen data of Munich (2010_2015)</p></a></li>
<li><a href='#plot_heathour'><p>Plotting hourly patterns with heatplot</p></a></li>
<li><a href='#plot_hour'><p>Plotting hourly patterns</p></a></li>
<li><a href='#plot_normsummary'><p>Plotting the Amplitude of Several Pollen Seasons.</p></a></li>
<li><a href='#plot_ps'><p>Pollen Season Plot</p></a></li>
<li><a href='#plot_summary'><p>Plotting Several Pollen Seasons.</p></a></li>
<li><a href='#plot_trend'><p>Calculating and Plotting Trends of Pollen Data.</p></a></li>
<li><a href='#pollen_calendar'><p>Pollen Calendar by Different Methods from a Historical Pollen Database</p></a></li>
<li><a href='#POMO_pollen'><p>3-hourly pollen data of Munich and Viechtach (2018), obtained automatically by BAA500</p></a></li>
<li><a href='#quality_control'><p>Quality Control of a Pollen Database</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>A Computational Tool for Aerobiological Data</td>
</tr>
<tr>
<td>Version:</td>
<td>2.0.1</td>
</tr>
<tr>
<td>Author:</td>
<td>Jesus Rojo &lt;Jesus.Rojo@uclm.es&gt;, Antonio Picornell &lt;picornell@uma.es&gt;, Jose Oteros &lt;OterosJose@gmail.com&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>"Jose Oteros" &lt;OterosJose@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Different tools for managing databases of airborne particles, elaborating the main calculations and visualization of results. In a first step, data are checked using tools for quality control and all missing gaps are completed. Then, the main parameters of the pollen season are calculated and represented graphically. Multiple graphical tools are available: pollen calendars, phenological plots, time series, tendencies, interactive plots, abundance plots...</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr, writexl, ggvis, lubridate, plotly, ggplot2, tidyr,
circular, scales, grDevices, zoo, grid, data.table</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.1</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-05-06 10:15:59 UTC; MSI</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-06-03 06:20:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='AeRobiology'><code>AeRobiology</code> package</h2><span id='topic+AeRobiology'></span><span id='topic+AeRobiology-package'></span>

<h3>Description</h3>

<p>AeRobiology computational tool
</p>

<hr>
<h2 id='analyse_trend'>Calculating and Plotting Trends of Pollen Data (summary plot).</h2><span id='topic+analyse_trend'></span>

<h3>Description</h3>

<p>Function to calculate the main seasonal indexes of the pollen season (<em>Start Date</em>, <em>Peak Date</em>, <em>End Date</em> and <em>Pollen Integral</em>). Trends analysis of the parameters over the seasons. Summary dot plot showing the distribution of the main seasonal indexes over the years.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>analyse_trend(data, interpolation = TRUE, int.method = "lineal",
  export.plot = TRUE, export.format = "pdf", export.result = TRUE,
  method = "percentage", quantil = 0.75, significant = 0.05,
  split = TRUE, result = "table", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="analyse_trend_+3A_data">data</code></td>
<td>
<p>A <code>data.frame</code> object. This <code>data.frame</code> should include a first column in format <code>Date</code> and the rest of columns in format <code>numeric</code> belonging to each pollen type by column.</p>
</td></tr>
<tr><td><code id="analyse_trend_+3A_interpolation">interpolation</code></td>
<td>
<p>A <code>logical</code> value specifying if the visualization shows the gaps in the inputs data (<code>interpolation = FALSE</code>) or if an interpolation method is used for filling the gaps (<code>interpolation = TRUE</code>). By default, <code>interpolation = TRUE</code>.</p>
</td></tr>
<tr><td><code id="analyse_trend_+3A_int.method">int.method</code></td>
<td>
<p>A <code>character</code> string with the name of the interpolation method to be used. The implemented methods that may be used are: <code>"lineal"</code>, <code>"movingmean"</code>, <code>"tseries"</code> or <code>"spline"</code>. By default, <code>int.method = "lineal"</code>.</p>
</td></tr>
<tr><td><code id="analyse_trend_+3A_export.plot">export.plot</code></td>
<td>
<p>A <code>logical</code> value specifying if a plot will be exported or not. If <code>FALSE</code> graphical results will only be displayed in the active graphics window. If <code>TRUE</code> graphical results will be displayed in the active graphics window and also one pdf/png file will be saved within the <em>plot_AeRobiology</em> directory automatically created in the working directory. By default, <code>export.plot = TRUE</code>.</p>
</td></tr>
<tr><td><code id="analyse_trend_+3A_export.format">export.format</code></td>
<td>
<p>A <code>character</code> string specifying the format selected to save the plot. The implemented formats that may be used are: <code>"pdf"</code> or <code>"png"</code>. By default, <code>export.format = "pdf"</code>.</p>
</td></tr>
<tr><td><code id="analyse_trend_+3A_export.result">export.result</code></td>
<td>
<p>A <code>logical</code> value. If <code>export.result = TRUE</code>, a table is exported with the extension <em>.xlsx</em>, in the directory <em>table_AeRobiology</em>. This table has the information about the <code>slope</code> <em>&quot;beta coefficient of a lineal model using as predictor the year and as dependent variable one of the main pollen season indexes&quot;</em>. The information is referred to the main pollen season indexes: <em>Start Date</em>, <em>Peak Date</em>, <em>End Date</em> and <em>Pollen Integral</em>.</p>
</td></tr>
<tr><td><code id="analyse_trend_+3A_method">method</code></td>
<td>
<p>A <code>character</code> string specifying the method applied to calculate the pollen season and the main seasonal parameters. The implemented methods that can be used are: <code>"percentage"</code>, <code>"logistic"</code>, <code>"moving"</code>, <code>"clinical"</code> or <code>"grains"</code>. By default, <code>method = "percentage"</code> (<code>perc = 95</code>%). A more detailed information about the different methods for defining the pollen season may be consulted in the function <code><a href="#topic+calculate_ps">calculate_ps</a></code>.</p>
</td></tr>
<tr><td><code id="analyse_trend_+3A_quantil">quantil</code></td>
<td>
<p>A <code>numeric</code> value (between 0 and 1) indicating the quantile of data to be displayed in the graphical output of the function. <code>quantil = 1</code> would show all the values, however a lower quantile will exclude the most extreme values of the sample. To split the parameters using a different sampling units (e.g. dates and pollen concentrations) can be used low vs high values of <code>quantil</code> argument (e.g. 0.5 vs 1). Also can be used an extra argument: <code>split</code>. By default, <code>quantil = 0.75</code>. <code>quantil</code> argument can only be applyed when <code>split = FALSE</code>.</p>
</td></tr>
<tr><td><code id="analyse_trend_+3A_significant">significant</code></td>
<td>
<p>A <code>numeric</code> value indicating the significant level to be considered in the linear trends analysis. This <em>p</em> level is displayed in the graphical output of the function. By default, <code>significant = 0.05</code>.</p>
</td></tr>
<tr><td><code id="analyse_trend_+3A_split">split</code></td>
<td>
<p>A <code>logical</code> argument. If <code>split = TRUE</code>, the plot is separated in two according to the nature of the variables (i.e. dates or pollen concentrations). By default, <code>split = TRUE</code>.</p>
</td></tr>
<tr><td><code id="analyse_trend_+3A_result">result</code></td>
<td>
<p>A <code>character</code> object with the definition of the object to be produced by the function. If <code>result == "plot"</code>, the function returns a list of objects of class <span class="pkg">ggplot2</span>; if <code>result == "table"</code>, the function returns a <span class="pkg">data.frame</span>. By default, <code>result = "table"</code>.</p>
</td></tr>
<tr><td><code id="analyse_trend_+3A_...">...</code></td>
<td>
<p>Additional arguments for the function <code><a href="#topic+calculate_ps">calculate_ps</a></code> are also accepted.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function allows to study time series trends of the pollen season. Even though the package was originally designed to treat aeropalynological data, it can be used to study many other atmospheric components (e.g., bacteria in the air, fungi, insects ...) <em>(Buters et al., 2018; Oteros et al., 2019)</em>. The study of trends in pollen time series is a common approach to study the impact of climate change or other environmental factors on vegetation (Galan et al., 2016; Garcia_Mozo et al., 2016;  Recio et al., 2018). This tool can also be useful for studying trends in other fields (Oteros et al., 2015).
</p>


<h3>Value</h3>

<p>If <code>result == "plot"</code>, the function returns a list of objects of class <span class="pkg">ggplot2</span>; if <code>result == "table"</code>, the function returns a <span class="pkg">data.frame</span> with the hourly patterns.
The plot is of the class <span class="pkg">ggplot2</span> or a list of plots of the class <span class="pkg">ggplot2</span> (depending on the argument <code>split</code>). This is a combined dot plot showing the trends (<em>slope</em> and <em>p</em> value) of the main seasonal features.<br />
The object of the class <code>data.frame</code> has the information about the <code>slope</code> <em>(beta coefficient of a lineal model using as predictor the year and as dependent variable one of the main pollen season indexes)</em>. The information is referred to the main pollen season indexes: <em>Start Date</em>, <em>Peak Date</em>, <em>End Date</em> and <em>Pollen Integral</em>.
</p>


<h3>References</h3>

<p>Buters, J. T. M., Antunes, C., Galveias, A., Bergmann, K. C., Thibaudon, M., Galan, C., ... &amp; Oteros, J. (2018). Pollen and spore monitoring in the world. <em>Clinical and translational allergy</em>, 8(1), 9.
</p>
<p>Galan, C., Alcazar, P., Oteros, J., Garcia_Mozo, H., Aira, M. J., Belmonte, J., ... &amp; Perez_Badia, R. (2016). Airborne pollen trends in the Iberian Peninsula. <em>Science of the Total Environment</em>, 550, 53_59.
</p>
<p>Garcia_Mozo, H., Oteros, J. A., &amp; Galan, C. (2016). Impact of land cover changes and climate on the main airborne pollen types in Southern Spain. <em>Science of the Total Environment</em>, 548, 221_228.
</p>
<p>Oteros, J., Garcia_Mozo, H., Botey, R., Mestre, A., &amp; Galan, C. (2015). Variations in cereal crop phenology in Spain over the last twenty_six years (1986_2012). <em>Climatic Change</em>, 130(4), 545_558.
</p>
<p>Oteros, J., Bartusel, E., Alessandrini, F., Nunez, A., Moreno, D. A., Behrendt, H., ... &amp; Buters, J. (2019). Artemisia pollen is the main vector for airborne endotoxin. <em>Journal of Allergy and Clinical Immunology</em>.
</p>
<p>Recio, M., Picornell, A., Trigo, M. M., Gharbi, D., Garcia_Sanchez, J., &amp; Cabezudo, B. (2018). Intensity and temporality of airborne Quercus pollen in the southwest Mediterranean area: Correlation with meteorological and phenoclimatic variables, trends and possible adaptation to climate change. <em>Agricultural and Forest Meteorology</em>, 250, 308_318.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+calculate_ps">calculate_ps</a></code>; <code><a href="#topic+plot_trend">plot_trend</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("munich_pollen")
analyse_trend(munich_pollen, interpolation = FALSE, export.result = FALSE, export.plot = FALSE)
</code></pre>

<hr>
<h2 id='calculate_ps'>Estimation of the Main Parameters of the Pollen Season</h2><span id='topic+calculate_ps'></span>

<h3>Description</h3>

<p>Function to calculate the main parameters of the pollen season with regard to phenology and pollen intensity from a historical database of several pollen types. The function can use the most common methods in the definition of the pollen season.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculate_ps(data, method = "percentage", th.day = 100, perc = 95,
  def.season = "natural", reduction = FALSE, red.level = 0.9,
  derivative = 5, man = 11, th.ma = 5, n.clinical = 5,
  window.clinical = 7, window.grains = 5, th.pollen = 10,
  th.sum = 100, type = "none", interpolation = TRUE,
  int.method = "lineal", maxdays = 30, result = "table",
  plot = TRUE, export.plot = FALSE, export.result = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calculate_ps_+3A_data">data</code></td>
<td>
<p>A <code>data.frame</code> object including the general database where calculation of the pollen season must be applied. This <code>data.frame</code> must include a first column in <code>Date</code> format and the rest of columns in <code>numeric</code> format belonging to each pollen type by column.</p>
</td></tr>
<tr><td><code id="calculate_ps_+3A_method">method</code></td>
<td>
<p>A <code>character</code> string specifying the method applied to calculate the pollen season and the main parameters. The implemented methods that can be used are: <code>"percentage"</code>, <code>"logistic"</code>, <code>"moving"</code>, <code>"clinical"</code> or <code>"grains"</code>. A more detailed information about the different methods for defining the pollen season may be consulted in <strong>Details</strong>.</p>
</td></tr>
<tr><td><code id="calculate_ps_+3A_th.day">th.day</code></td>
<td>
<p>A <code>numeric</code> value. The number of days whose pollen concentration is bigger than this threshold is calculated for each year and pollen type. This value will be obtained in the results of the function. The <code>th.day</code> argument will be <code>100</code> by default.</p>
</td></tr>
<tr><td><code id="calculate_ps_+3A_perc">perc</code></td>
<td>
<p>A <code>numeric</code> value ranging <code>0_100</code>. This argument is valid only for <code>method = "percentage"</code>. This value represents the percentage of the total annual pollen included in the pollen season, removing <code>(100_perc)/2%</code> of the total pollen before and after of the pollen season. The <code>perc</code> argument will be <code>95</code> by default.</p>
</td></tr>
<tr><td><code id="calculate_ps_+3A_def.season">def.season</code></td>
<td>
<p>A <code>character</code> string specifying the method for selecting the best annual period to calculate the pollen season. The pollen seasons may occur within the natural year between two years. The implemented options that can be used are: <code>"natural"</code>, <code>"interannual"</code> or <code>"peak"</code>. The <code>def.season</code> argument will be <code>"natural"</code> by default. A more detailed information about the different methods for selecting the best annual period to calculate the pollen season may be consulted in <strong>Details</strong>.</p>
</td></tr>
<tr><td><code id="calculate_ps_+3A_reduction">reduction</code></td>
<td>
<p>A <code>logical</code> value. This argument is valid only for the <code>"logistic"</code> method. If <code>FALSE</code> the reduction of the pollen data is not applicable. If <code>TRUE</code> a reduction of the peaks above a certain level (<code>red.level</code> argument) will be carried out before the definition of the pollen season. The <code>reduction</code> argument will be <code>FALSE</code> by default. A more detailed information about the reduction process may be consulted in <strong>Details</strong>.</p>
</td></tr>
<tr><td><code id="calculate_ps_+3A_red.level">red.level</code></td>
<td>
<p>A <code>numeric</code> value ranging <code>0_1</code> specifying the percentile used as level to reduce the peaks of the pollen series before the definition of the pollen season. This argument is valid only for the <code>"logistic"</code> method. The <code>red.level</code> argument will be <code>0.90</code> by default, specifying the percentile 90.</p>
</td></tr>
<tr><td><code id="calculate_ps_+3A_derivative">derivative</code></td>
<td>
<p>A <code>numeric</code> (<code>integer</code>) value belonging to options of <code>4</code>, <code>5</code> or <code>6</code> specifying the derivative that will be applied to calculate the asymptotes which determines the pollen season using the <code>"logistic"</code> method. This argument is valid only for the <code>"logistic"</code> method. The <code>derivative</code> argument will be <code>5</code> by default. More information may be consulted in <strong>Details</strong>.</p>
</td></tr>
<tr><td><code id="calculate_ps_+3A_man">man</code></td>
<td>
<p>A <code>numeric</code> (<code>integer</code>) value specifying the order of the moving average applied to calculate the pollen season using the <code>"moving"</code> method. This argument is valid only for the <code>"moving"</code> method. The <code>man</code> argument will be <code>11</code> by default.</p>
</td></tr>
<tr><td><code id="calculate_ps_+3A_th.ma">th.ma</code></td>
<td>
<p>A <code>numeric</code> value specifying the threshold used for the <code>"moving"</code> method for defining the beginning and the end of the pollen season. This argument is valid only for the <code>"moving"</code> method. The <code>th.ma</code> argument will be <code>5</code> by default.</p>
</td></tr>
<tr><td><code id="calculate_ps_+3A_n.clinical">n.clinical</code></td>
<td>
<p>A <code>numeric</code> (<code>integer</code>) value specifying the number of days which must exceed a given threshold (<code>th.pollen</code> argument) for defining the beginning and the end of the pollen season. This argument is valid only for the <code>"clinical"</code> method. The <code>n.clinical</code> argument will be <code>5</code> by default.</p>
</td></tr>
<tr><td><code id="calculate_ps_+3A_window.clinical">window.clinical</code></td>
<td>
<p>A <code>numeric</code> (<code>integer</code>) value specifying the time window during which the conditions must be evaluated for defining the beginning and the end of the pollen season using the <code>"clinical"</code> method. This argument is valid only for the <code>"clinical"</code> method. The <code>window.clinical</code> argument will be <code>7</code> by default.</p>
</td></tr>
<tr><td><code id="calculate_ps_+3A_window.grains">window.grains</code></td>
<td>
<p>A <code>numeric</code> (<code>integer</code>) value specifying the time window during which the conditions must be evaluated for defining the beginning and the end of the pollen season using the <code>"grains"</code> method. This argument is valid only for the <code>"grains"</code> method. The <code>window.grains</code> argument will be <code>5</code> by default.</p>
</td></tr>
<tr><td><code id="calculate_ps_+3A_th.pollen">th.pollen</code></td>
<td>
<p>A <code>numeric</code> value specifying the threshold that must be exceeded during a given number of days (<code>n.clinical</code> or <code>window.grains</code> arguments) for defining the beginning and the end of the pollen season using the <code>"clinical"</code> or <code>"grains"</code> methods. This argument is valid only for the <code>"clinical"</code> or <code>"grains"</code> methods. The <code>th.pollen</code> argument will be <code>10</code> by default.</p>
</td></tr>
<tr><td><code id="calculate_ps_+3A_th.sum">th.sum</code></td>
<td>
<p>A <code>numeric</code> value specifying the pollen threshold that must be exceeded by the sum of daily pollen during a given number of days (<code>n.clinical</code> argument) exceeding a given daily threshold (<code>th.pollen</code> argument) for defining the beginning and the end of the pollen season using the <code>"clinical"</code> method. This argument is valid only for the <code>"clinical"</code> method. The <code>th.sum</code> argument will be <code>100</code> by default.</p>
</td></tr>
<tr><td><code id="calculate_ps_+3A_type">type</code></td>
<td>
<p>A <code>character</code> string specifying the parameters considered according to a specific pollen type for calculating the pollen season using the <code>"clinical"</code> method. The implemented pollen types that may be used are: <code>"birch"</code>, <code>"grasses"</code>, <code>"cypress"</code>, <code>"olive"</code> or <code>"ragweed"</code>. As result for selecting any of these pollen types the parameters <code>n.clinical</code>, <code>window.clinical</code>, <code>th.pollen</code> and <code>th.sum</code> will be automatically adjusted for the <code>"clinical"</code> method. If no pollen types are specified (<code>type = "none"</code>), these parameters will be considered by the user. This argument is valid only for the <code>"clinical"</code> method. The <code>type</code> argument will be <code>"none"</code> by default.</p>
</td></tr>
<tr><td><code id="calculate_ps_+3A_interpolation">interpolation</code></td>
<td>
<p>A <code>logical</code> value. If <code>FALSE</code> the interpolation of the pollen data is not applicable. If <code>TRUE</code> an interpolation of the pollen series will be applied to complete the gaps with no data before the calculation of the pollen season. The <code>interpolation</code> argument will be <code>TRUE</code> by default. A more detailed information about the interpolation method may be consulted in <strong>Details</strong>.</p>
</td></tr>
<tr><td><code id="calculate_ps_+3A_int.method">int.method</code></td>
<td>
<p>A <code>character</code> string specifying the method selected to apply the interpolation method in order to complete the pollen series. The implemented methods that may be used are: <code>"lineal"</code>, <code>"movingmean"</code>, <code>"spline"</code> or <code>"tseries"</code>. The <code>int.method</code> argument will be <code>"lineal"</code> by default.</p>
</td></tr>
<tr><td><code id="calculate_ps_+3A_maxdays">maxdays</code></td>
<td>
<p>A <code>numeric</code> (<code>integer</code> value) specifying the maximum number of consecutive days with missing data that the algorithm is going to interpolate. If the gap is bigger than the argument value, the gap will not be interpolated. Not valid with <code>int.method = "tseries"</code>. The <code>maxdays</code> argument will be <code>30</code> by default.</p>
</td></tr>
<tr><td><code id="calculate_ps_+3A_result">result</code></td>
<td>
<p>A <code>character</code> string specifying the output for the function. The implemented outputs that may be obtained are: <code>"table"</code> and <code>"list"</code>. The argument <code>result</code> will be <code>"table"</code> by default.</p>
</td></tr>
<tr><td><code id="calculate_ps_+3A_plot">plot</code></td>
<td>
<p>A <code>logical</code> value specifying if a set of plots based on the definition of the pollen season will be shown in the plot history or not. If <code>FALSE</code> graphical results will not be shown. If <code>TRUE</code> a set of plots will be shown in the plot history. The <code>plot</code> argument will be <code>TRUE</code> by default.</p>
</td></tr>
<tr><td><code id="calculate_ps_+3A_export.plot">export.plot</code></td>
<td>
<p>A <code>logical</code> value specifying if a set of plots based on the definition of the pollen season will be saved in the workspace. If <code>TRUE</code> a <em>pdf</em> file for each pollen type showing graphically the definition of the pollen season for each studied year will be saved within the <em>plot_AeRobiology</em> directory created in the working directory. The <code>plot</code> argument will be <code>FALSE</code> by default.</p>
</td></tr>
<tr><td><code id="calculate_ps_+3A_export.result">export.result</code></td>
<td>
<p>A <code>logical</code> value specifying if a excel file including all parameters for the definition of the pollen season saved in the working directoty will be required or not. If <code>FALSE</code> the results will not exported. If <code>TRUE</code> the results will be exported as <em>xlsx</em> file including all parameters calculated from the definition of the pollen season within the <em>table_AeRobiology</em> directory created in the working directory. The <code>export.result</code> argument will be <code>FALSE</code> by default.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function allows to calculate the pollen season using five different methods which are described below. After calculating the start_date, end_date and peak_date for the pollen season all rest of parameters have been calculated as detailed in <strong>Value</strong> section.
</p>

<ul>
<li> <p><code>"percentage"</code> method. This is a commonly used method for defining the pollen season based on the elimination of a certain percentage in the beginning and the end of the pollen season <em>(Nilsson and Persson, 1981; Andersen, 1991)</em>. For example if the pollen season is based on the 95% of the total annual pollen (<code>"perc" = 95</code>), the start_date of the pollen season is marked as the day in which 2.5% of the total pollen is registered and the end_date of the pollen season is marked as the day in which 97.5% of the total pollen is registered.
</p>
</li>
<li> <p><code>"logistic"</code> method. This method was developed by <em>Ribeiro et al. (2007)</em> and modified by <em>Cunha et al. (2015)</em>. It is based on fitting annually a non_linear logistic regression model to the daily accumulated curve for each pollen type. This logistic function and the different derivatives were considered to calculate the start_date and end_date of the pollen season, based on the asymptotes when pollen amounts are stabilized on the beginning and the end of the accumulated curve. For more information about the method to see <em>Ribeiro et al. (2007)</em> and <em>Cunha et al. (2015)</em>. Three different derivatives may be used (<code>derivative</code> argument) <code>4</code>, <code>5</code> or <code>6</code> that represent from higher to lower restrictive criterion for defining the pollen season. This method may be complemented with an optional method for reduction the peaks values (<code>reduction = TRUE</code>), thus avoiding the effect of the great influence of extreme peaks. In this sense, peaks values will be cut below a certain level that the user may select based on a percentile analysis of peaks. For example, <code>red.level = 0.90</code> will cut all peaks above the percentile <code>90</code>.
</p>
</li>
<li> <p><code>"moving"</code> method. This method is proposed the first time by the authors of this package. The definition of the pollen season is based on the application of a moving average to the pollen series in order to obtain the general seasonality of the pollen curve avoiding the great variability of the daily fluctuations. Thus, the start_date and the end_date will be established when the curve of the moving average reaches a given pollen threshold (<code>th.ma</code> argument). Also the order of the moving average may be customized by the user (<code>man</code> argument). By default, <code>man</code> = 11 and <code>th.ma</code> = 5.
</p>
</li>
<li> <p><code>"clinical"</code> method. This method was proposed by <em>Pfaar et al. (2017)</em>. It is based on the expert consensus in relation to pollen exposure and the relationship with allergic symptoms derived of the literature. Different periods may be defined by this method: the pollen season, the high pollen season and the high pollen days. The start_date and end_date of the pollen season were defined as a certain number of days (<code>n.clinical</code> argument) within a time window period (<code>window.clinical</code> argument) exceeding a certain pollen threshold (<code>th.pollen</code> argument) which summation is above a certain pollen sum (<code>th.sum</code> argument). All these parameters are established for each pollen type according to <em>Pfaar et al. (2017)</em> and using the <code>type</code> argument these parameters may be automatically adjusted for the specific pollen types (<code>"birch"</code>, <code>"grasses"</code>, <code>"cypress"</code>, <code>"olive"</code> or <code>"ragweed"</code>). Furthermore, the user may change all parameters to do a customized definition of the pollen season. The start_date and end_date of the high pollen season were defined as three consecutive days exceeding a certain pollen threshold (<code>th.day</code> argument). The number of high pollen days will also be calculated exceeding this pollen threshold (<code>th.day</code>). For more information about the method to see <em>Pfaar et al. (2017)</em>.
</p>
</li>
<li> <p><code>"grains"</code> method. This method was proposed by <em>Galan et al. (2001)</em> originally in olive pollen but after also applied in other pollen types. The start_date and end_date of the pollen season were defined as a certain number of days (<code>window.grains</code> argument) exceeding a certain pollen threshold (<code>th.pollen</code> argument). For more information about the method to see <em>Galan et al. (2001)</em>.
</p>
</li></ul>

<p>The pollen season of the species may occur during the natural year (Calendar year: from 1. January to 31. December) or the start_date and the end_date of the pollen season may happen in two different natural years (or calendar years). This consideration has been taken into account and in this package different method for defining the period for calculating the pollen season have been implemented. In this sense, the <code>def.season</code> argument has been incorporated in three options:
</p>

<ul>
<li> <p><code>"natural"</code>: considering the pollination year as natural year from 1st January to 31th December for defining the start_dates and end_dates of the pollen season for each pollen types.
</p>
</li>
<li> <p><code>"interannual"</code>: considering the pollination year from 1st June to 31th May for defining the start_dates and end_dates of the pollen season for each pollen types.
</p>
</li>
<li> <p><code>"peak"</code>: considering a customized pollination year for each pollen types calculated as 6 previous months and 6 later months from the average peak_date.
</p>
</li></ul>

<p>Pollen time series frequently have different gaps with no data and this fact could be a problem for the calculation of specific methods for defining the pollen season even providing incorrect results. In this sense by default a linear interpolation will be carried out to complete these gaps before to define the pollen season (<code>interpolation = TRUE</code>). Additionally, the users may select other interpolation methods using the <code>int.method</code> argument, as <code>"lineal"</code>, <code>"movingmean"</code>, <code>"spline"</code> or <code>"tseries"</code>. For more information to see the <code><a href="#topic+interpollen">interpollen</a></code> function.
</p>


<h3>Value</h3>

<p>This function returns different results:<br />
<code>data.frame</code> when <code>result = "table"</code> including the main parameters of the pollen season with regard to phenology and pollen intensity as:
</p>

<ul>
<li> <p><strong>type</strong>: pollen type
</p>
</li>
<li> <p><strong>seasons</strong>: year of the beginning of the season
</p>
</li>
<li> <p><strong>st.dt</strong>: start_date (date)
</p>
</li>
<li> <p><strong>st.jd</strong>: start_date (day of the year)
</p>
</li>
<li> <p><strong>en.dt</strong>: end_date (date)
</p>
</li>
<li> <p><strong>en.jd</strong>: end_date (day of the year)
</p>
</li>
<li> <p><strong>ln.ps</strong>: length of the season
</p>
</li>
<li> <p><strong>sm.tt</strong>: total sum
</p>
</li>
<li> <p><strong>sm.ps</strong>: pollen integral
</p>
</li>
<li> <p><strong>pk.val</strong>: peak value
</p>
</li>
<li> <p><strong>pk.dt</strong>: peak_date (date)
</p>
</li>
<li> <p><strong>pk.jd</strong>: peak_date (day of year)
</p>
</li>
<li> <p><strong>ln.prpk</strong>: length of the pre_peak period
</p>
</li>
<li> <p><strong>sm.prpk</strong>: pollen integral of the pre_peak period
</p>
</li>
<li> <p><strong>ln.pspk</strong>: length of the post_peak period
</p>
</li>
<li> <p><strong>sm.pspk</strong>: pollen integral of the post_peak period
</p>
</li>
<li> <p><strong>daysth</strong>: number of days with more than 100 pollen grains
</p>
</li>
<li> <p><strong>st.dt.hs</strong>: start_date of the High pollen season (date, only for clinical method)
</p>
</li>
<li> <p><strong>st.jd.hs</strong>: start_date of the High pollen season (day of the year, only for clinical method)
</p>
</li>
<li> <p><strong>en.dt.hs</strong>: end_date of the High pollen season (date, only for clinical method)
</p>
</li>
<li> <p><strong>en.jd.hs</strong>: end_date of the High pollen season (day of the year, only for clinical method)
</p>
</li></ul>

<p><code>list</code> when <code>result = "list"</code> including the main parameters of the pollen season, one pollen type by element
<code>plots</code> when <code>plot = TRUE</code> showing graphically the definition of the pollen season for each studied year in the plot history.
If <code>export.result = TRUE</code> this <code>data.frame</code> will also be exported as <em>xlsx</em> file within the <em>table_AeRobiology</em> directory created in the working directory. If <code>export.result = FALSE</code> the results will also be showed as list object named <code>list.ps</code>. <br />
If <code>export.plot = TRUE</code> a <em>pdf</em> file for each pollen type showing graphically the definition of the pollen season for each studied year will be saved within the <em>plot_AeRobiology</em> directory created in the working directory.
</p>


<h3>References</h3>

<p>Andersen, T.B., 1991. A model to predict the beginning of the pollen season. <em>Grana</em>, 30(1), pp.269_275.
</p>
<p>Cunha, M., Ribeiro, H., Costa, P. and Abreu, I., 2015. A comparative study of vineyard phenology and pollen metrics extracted from airborne pollen time series. <em>Aerobiologia</em>, 31(1), pp.45_56.
</p>
<p>Galan, C., Garcia_Mozo, H., Carinanos, P., Alcazar, P. and Dominguez_Vilches, E., 2001. The role of temperature in the onset of the <em>Olea europaea</em> L. pollen season in southwestern Spain. <em>International Journal of Biometeorology</em>, 45(1), pp.8_12.
</p>
<p>Nilsson, S. and Persson, S., 1981. Tree pollen spectra in the Stockholm region (Sweden), 1973_1980. <em>Grana</em>, 20(3), pp.179_182.
</p>
<p>Pfaar, O., Bastl, K., Berger, U., Buters, J., Calderon, M.A., Clot, B., Darsow, U., Demoly, P., Durham, S.R., Galan, C., Gehrig, R., Gerth van Wijk, R., Jacobsen, L., Klimek, L., Sofiev, M., Thibaudon, M. and Bergmann, K.C., 2017. Defining pollen exposure times for clinical trials of allergen immunotherapy for pollen_induced rhinoconjunctivitis_an EAACI position paper. <em>Allergy</em>, 72(5), pp.713_722.
</p>
<p>Ribeiro, H., Cunha, M. and Abreu, I., 2007. Definition of main pollen season using logistic model. <em>Annals of Agricultural and Environmental Medicine</em>, 14(2), pp.259_264.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+interpollen">interpollen</a></code>, <code><a href="#topic+plot_ps">plot_ps</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("munich_pollen")
calculate_ps(munich_pollen, plot = TRUE, result = "table")
</code></pre>

<hr>
<h2 id='credits'>A view of the creators</h2><span id='topic+credits'></span>

<h3>Description</h3>

<p>Credits
</p>


<h3>Usage</h3>

<pre><code class='language-R'>credits()
</code></pre>

<hr>
<h2 id='interpollen'>Interpolation of Missing Data in a Pollen Database by Different Methods</h2><span id='topic+interpollen'></span>

<h3>Description</h3>

<p>Function to simultaneously replace all missing data of an historical database of several pollen types by using different methods of interpolation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>interpollen(data, method = "lineal", maxdays = 30, plot = TRUE,
  factor = 2, ndays = 3, spar = 0.5, data2 = NULL, data3 = NULL,
  data4 = NULL, data5 = NULL, mincorr = 0.6, result = "wide")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="interpollen_+3A_data">data</code></td>
<td>
<p>A <code>data.frame</code> object including the general database where interpollation must be performed. This <code>data.frame</code> must include a first column in <code>Date</code> format and the rest of columns in <code>numeric</code> format. Each column must contain information of one pollen type. It is not necessary to insert missing gaps; the function will automatically detect them.</p>
</td></tr>
<tr><td><code id="interpollen_+3A_method">method</code></td>
<td>
<p>A <code>character</code> string specifying the method applied to calculate and generate the pollen missing data. The implemented methods that can be used are: <code>"lineal"</code>, <code>"movingmean"</code>, <code>"spline"</code>, <code>"tseries"</code> or <code>"neighbour"</code>. A more detailed information about the different methods may be consulted in Details. The <code>method</code> argument will be <code>"lineal"</code> by default.</p>
</td></tr>
<tr><td><code id="interpollen_+3A_maxdays">maxdays</code></td>
<td>
<p>A <code>numeric (interger)</code> value specifying the maximum number of consecutive days with missing data that the algorithm is going to interpolate. If the gap is bigger than the argument value, the gap will not be interpolated. Not valid with <code>"tseries"</code> method. The <code>maxdays</code> argument will be <code>30</code> by default.</p>
</td></tr>
<tr><td><code id="interpollen_+3A_plot">plot</code></td>
<td>
<p>A <code>logical</code> argument. If <code>TRUE</code>, graphical previews of the input database will be plot at the end of the interpolation process. All the interpolated gaps will be marked in red. The <code>plot</code> argument will be <code>TRUE</code> by default.</p>
</td></tr>
<tr><td><code id="interpollen_+3A_factor">factor</code></td>
<td>
<p>A <code>numeric (interger)</code> value bigger than <code>1</code>. Only valid if the <code>"movingmean"</code> method is chosen. The argument specifies the factor which will multiply the gap size to stablish the range of the moving mean that will fulfill the gap. A more detailed information about the selection of the factor may be consulted in Details. The argument <code>factor</code> will be <code>1</code> by default.</p>
</td></tr>
<tr><td><code id="interpollen_+3A_ndays">ndays</code></td>
<td>
<p>A <code>numeric (interger)</code> value bigger than <code>1</code>. Only valid if the <code>"spline"</code> method is chosen. Specifies the number of days beyond each side of the gap which are used to perform the spline regression. The argument <code>ndays</code> will be <code>3</code> by default.</p>
</td></tr>
<tr><td><code id="interpollen_+3A_spar">spar</code></td>
<td>
<p>A <code>numeric (double)</code> value ranging <code>0_1</code> specifying the degree of smoothness of the spline regression adjustment. As smooth as the adjustment is, more data are considered as outliers for the spline regression. Only valid if the <code>"spline"</code> method is chosen. The argument <code>"spar"</code> will be <code>0.5</code> by default.</p>
</td></tr>
<tr><td><code id="interpollen_+3A_data2">data2</code>, <code id="interpollen_+3A_data3">data3</code>, <code id="interpollen_+3A_data4">data4</code>, <code id="interpollen_+3A_data5">data5</code></td>
<td>
<p>A <code>data.frame</code> object (each one) including database of a neighbour pollen station which will be used to interpolate missing data in the target station. Only valid if the &quot;neighbour&quot; method is chosen. This <code>data.frame</code> must include a first column in <code>Date</code> format and the rest of columns in <code>numeric</code> format belonging to each pollen type by column. It is not necessary to insert the missing gaps; the function will automatically detect them. The arguments will be <code>NULL</code> by default.</p>
</td></tr>
<tr><td><code id="interpollen_+3A_mincorr">mincorr</code></td>
<td>
<p>A <code>numeric (double)</code> value ranging <code>0_1</code>. It specifies the minimal correlation coefficient (Spearman correlations) that neighbour stations must have with the target station to be taken into account for the interpolation. Only valid if the <code>"neighbour"</code> method is chosen. The argument <code>"mincorr"</code> will be <code>0.6</code> by default.</p>
</td></tr>
<tr><td><code id="interpollen_+3A_result">result</code></td>
<td>
<p>A <code>character</code> string specifying the format of the resulting <code>data.frame</code>. Only <code>"wide"</code> or <code>"long"</code>. The <code>result</code> argument will be <code>"wide"</code> by default.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function allows to interpolate missing data in a pollen database using 4 different methods which are described below. Interpolation for each pollen type will be automatically done for gaps smaller than the <code>"maxdays"</code> argument. <br />
</p>

<ul>
<li> <p><code>"lineal"</code> method. The interpolation will be carried out by tracing a straight line between the gap extremes.
</p>
</li>
<li> <p><code>"movingmean"</code> method. It calculates the moving mean of the pollen daily concentrations with a window size of the gap size multiplicated by the <code>factor</code> argument and replace the missing data with the moving mean for these days. It is a dynamic function and for each gap of the database, the window size of the moving mean changes depending of each gap size.
</p>
</li>
<li> <p><code>"spline"</code> method. The interpolation will be carried out by performing a spline regression with the previous and following days to the gap. The number of days of each side of the gap that will be taken into account for calculating the spline regression are specified by <code>ndays</code> argument. The smoothness of the adjustment of the spline regression can be specified by the <code>spar</code> argument.
</p>
</li>
<li> <p><code>"tseries"</code> method. The interpolation will be carried out by analysing the time series of pollen database. It performs a seasonal_trend decomposition based on LOESS (Cleveland et al., 1990). The seasonality of the historical database is extracted and used to predict the missing data by performing a linear regression with the target year.
</p>
</li>
<li> <p><code>"neighbour"</code> method. Other near stations provided by the user are used to interpolate the missing data of the target station. First of all, a Spearman correlation is performed between the target station and the neighbour stations to discard the neighbour stations with a correlation coefficient smaller than <code>mincorr</code> value. For each gap, a linear regression is performed between the neighbour stations and the target stations to determine the equation which converts the pollen concentrations of the neighbour stations into the pollen concentration of the target station. Only neighbour stations without any missing data during the gap period are taken into account for each gap.
</p>
</li></ul>



<h3>Value</h3>

<p>This function returns different results:
</p>

<ul>
<li><p> If <code>result = "wide"</code>, returns a <code>data.frame</code> including the original data and completed with the interpolated data.
</p>
</li>
<li><p> If <code>result = "long"</code>, returns a <code>data.frame</code> containing your data in long format (the first column for date, the second for pollen type, the third for concentration and an additional fourth column with <code>1</code> if this data has been interpolated or <code>0</code> if not).
</p>
</li>
<li><p> If <code>plot = TRUE</code>, plots for each year and pollen type with daily values are represented in the active graphic window. Interpolated values are marked in red. If <code>method</code> argument is <code>"tseries"</code>, the seasonality is also represented in grey.
</p>
</li></ul>



<h3>References</h3>

<p>Cleveland RB, Cleveland WS, McRae JE, Terpenning I (1990) STL: a seasonal_trend decomposition procedure based on loess. J Off Stat 6(1):3_33.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ma">ma</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("munich_pollen")
interpollen(munich_pollen, method = "lineal", plot = FALSE)
</code></pre>

<hr>
<h2 id='iplot_abundance'>Plot of the Relative Abundance of the Pollen Types</h2><span id='topic+iplot_abundance'></span>

<h3>Description</h3>

<p>Generates a barplot based on the relative abundance (as percentage) in the air of the pollen types with respect to the total amounts
</p>


<h3>Usage</h3>

<pre><code class='language-R'>iplot_abundance(data, n.types = 15, y.start = NULL, y.end = NULL,
  interpolation = TRUE, int.method = "lineal", col.bar = "#E69F00",
  type.plot = "static", result = "plot", export.plot = FALSE,
  export.format = "pdf", exclude = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="iplot_abundance_+3A_data">data</code></td>
<td>
<p>A <code>data.frame</code> object including the general database where calculation of the pollen season must be applied. This <code>data.frame</code> must include a first column in <code>Date</code> format and the rest of columns in <code>numeric</code> format belonging to each pollen type by column.</p>
</td></tr>
<tr><td><code id="iplot_abundance_+3A_n.types">n.types</code></td>
<td>
<p>A <code>numeric</code> (<code>integer</code>) value specifying the number of the most abundant pollen types that must be represented in the plot of the relative abundance. A more detailed information about the selection of the considered pollen types may be consulted in <strong>Details</strong>. The <code>n.types</code> argument will be <code>15</code> types by default.</p>
</td></tr>
<tr><td><code id="iplot_abundance_+3A_y.start">y.start</code>, <code id="iplot_abundance_+3A_y.end">y.end</code></td>
<td>
<p>A <code>numeric</code> (<code>integer</code>) value specifying the period selected to calculate relative abundances of the pollen types (<code>start year _ end year</code>). If <code>y.start</code> and <code>y.end</code> are not specified (<code>NULL</code>), the entire database will be used to generate the pollen calendar. The <code>y.start</code> and <code>y.end</code> arguments will be <code>NULL</code> by default.</p>
</td></tr>
<tr><td><code id="iplot_abundance_+3A_interpolation">interpolation</code></td>
<td>
<p>A <code>logical</code> value. If <code>FALSE</code> the interpolation of the pollen data is not applicable. If <code>TRUE</code> an interpolation of the pollen series will be applied to complete the gaps with no data before the calculation of the pollen season. The <code>interpolation</code> argument will be <code>TRUE</code> by default. A more detailed information about the interpolation method may be consulted in <strong>Details</strong>.</p>
</td></tr>
<tr><td><code id="iplot_abundance_+3A_int.method">int.method</code></td>
<td>
<p>A <code>character</code> string specifying the method selected to apply the interpolation method in order to complete the pollen series. The implemented methods that may be used are: <code>"lineal"</code>, <code>"movingmean"</code>, <code>"spline"</code> or <code>"tseries"</code>. The <code>int.method</code> argument will be <code>"lineal"</code> by default.</p>
</td></tr>
<tr><td><code id="iplot_abundance_+3A_col.bar">col.bar</code></td>
<td>
<p>A <code>character</code> string specifying the color of the bars to generate the graph showing the relative abundances of the pollen types. The <code>color</code> argument will be <code>#E69F00</code> by default, but any color may be selected.</p>
</td></tr>
<tr><td><code id="iplot_abundance_+3A_type.plot">type.plot</code></td>
<td>
<p>A <code>character</code> string specifying the type of plot selected to show the plot showing the relative abundance of the pollen types. The implemented types that may be used are: <code>static</code> generates a static <strong>ggplot</strong> object and <code>dynamic</code> generates a dynamic <strong>plotly</strong> object.</p>
</td></tr>
<tr><td><code id="iplot_abundance_+3A_result">result</code></td>
<td>
<p>A <code>character</code> string specifying the output for the function. The implemented outputs that may be obtained are: <code>"plot"</code> and <code>"table"</code>. The argument <code>result</code> will be <code>"plot"</code> by default.</p>
</td></tr>
<tr><td><code id="iplot_abundance_+3A_export.plot">export.plot</code></td>
<td>
<p>A <code>logical</code> value specifying if a plot saved in the working directory will be required or not. If <code>FALSE</code> graphical results will only be displayed in the active graphics window. If <code>TRUE</code> graphical results will be displayed in the active graphics window and also a <em>pdf</em> or <em>png</em> file (according to the <code>export.format</code> argument) will be saved within the <em>plot_AeRobiology</em> directory automatically created in the working directory. This argument is applicable only for <code>"static"</code> plots. The <code>export.plot</code> will be <code>FALSE</code> by default.</p>
</td></tr>
<tr><td><code id="iplot_abundance_+3A_export.format">export.format</code></td>
<td>
<p>A <code>character</code> string specifying the format selected to save the plot showing the relative abundance of the pollen types. The implemented formats that may be used are: <code>"pdf"</code> and <code>"png"</code>. This argument is applicable only for <code>"static"</code> plots. The <code>export.format</code> will be <code>"pdf"</code> by default.</p>
</td></tr>
<tr><td><code id="iplot_abundance_+3A_exclude">exclude</code></td>
<td>
<p>A <code>character</code> string vector with the names of the pollen types to be excluded from the plot.</p>
</td></tr>
<tr><td><code id="iplot_abundance_+3A_...">...</code></td>
<td>
<p>Other additional arguments may be used to customize the exportation of the plots using <code>"pdf"</code> or <code>"png"</code> files and therefore arguments from <code><a href="grDevices.html#topic+pdf">pdf</a></code> and <code><a href="grDevices.html#topic+png">png</a></code> functions (<span class="pkg">grDevices</span> package) may be implemented. For example, for <em>pdf</em> files the user may custom the arguments: <code>width</code>, <code>height</code>, <code>family</code>, <code>title</code>, <code>fonts</code>, <code>paper</code>, <code>bg</code>, <code>fg</code>, <code>pointsize...</code>; and for <em>png</em> files the user may custom the arguments: <code>width</code>, <code>height</code>, <code>units</code>, <code>pointsize</code>, <code>bg</code>, <code>res...</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function allows to calculate the relative abundance of the pollen types in the air from a database and to display a barplot with the percentage representation of the main pollen types as the graph reported by <em>Rojo et al. (2016)</em>. This plot will be generated only for the specified number of the most abundant pollen types using the <code>n.types</code> argument by the user.<br />
<br />
Pollen time series frequently have different gaps with no data and this fact could be a problem for the calculation of specific methods for defining the pollen season even providing incorrect results. In this sense by default a linear interpolation will be carried out to complete these gaps before to define the pollen season (<code>interpolation = TRUE</code>). Additionally, the users may select other interpolation methods using the <code>int.method</code> argument, as <code>"lineal"</code>, <code>"movingmean"</code>, <code>"spline"</code> or <code>"tseries"</code>. For more information to see the <code><a href="#topic+interpollen">interpollen</a></code> function.
</p>


<h3>Value</h3>

<p>This function returns different results:<br />
<br />
<code>plot</code> in the active graphics window displaying the pollen calendar generated by the user when <code>result = "plot"</code>. This <code>plot</code> may be included in an object by assignment operators.<br />
<br />
<code>data.frame</code> including the yearly average pollen amounts for each pollen types used to generate the pollen of the relative abundance when <code>result = "table"</code>. This <code>data.frame</code> will be included in an object named <code>annual.sum.data</code>.<br />
<br />
If <code>export.plot = FALSE</code> graphical results will only be displayed in the active graphics window as <strong>ggplot</strong> graph. Additional characteristics may be incorporated to the plot by <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> syntax (see <span class="pkg">ggplot2</span> package).<br />
<br />
If <code>export.plot = TRUE</code> and <code>export.format = pdf</code> a <em>pdf</em> file with the plot will be saved within the <em>plot_AeRobiology</em> directory created in the working directory. This option is applicable only for <code>"static"</code> plots. Additional characteristics may be incorporated to the exportation as <em>pdf</em> file (see <span class="pkg">grDevices</span> package).<br />
<br />
If <code>export.plot = TRUE</code> and <code>export.format = png</code> a <em>png</em> file with the plot will be saved within the <em>plot_AeRobiology</em> directory created in the working directory. This option is applicable only for <code>"static"</code> plots. Additional characteristics may be incorporated to the exportation as <em>png</em> file (see <span class="pkg">grDevices</span> package).<br />
<br />
If <code>type.plot = dynamic</code> graphical results will be displayed in the active Viewer window as <strong>plotly</strong> graph. Additional characteristics may be incorporated to the plot by <code><a href="plotly.html#topic+plotly">plotly</a></code> syntax (see <span class="pkg">plotly</span> package).
</p>


<h3>References</h3>

<p>Rojo, J., Rapp, A., Lara, B., Sabariego, S., Fernandez_Gonzalez, F. and Perez_Badia, R., 2016. Characterisation of the airborne pollen spectrum in Guadalajara (central Spain) and estimation of the potential allergy risk. <em>Environmental Monitoring and Assessment</em>, 188(3), p.130.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+interpollen">interpollen</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("munich_pollen")
iplot_abundance (munich_pollen, interpolation = FALSE, export.plot = FALSE)
</code></pre>

<hr>
<h2 id='iplot_pheno'>Phenological Plot</h2><span id='topic+iplot_pheno'></span>

<h3>Description</h3>

<p>Generates a boxplot based on phenological parameters (start_dates and end_dates) that are calculated by the estimation of the main parameters of the pollen season
</p>


<h3>Usage</h3>

<pre><code class='language-R'>iplot_pheno(data, method = "percentage", n.types = 15, th.day = 100,
  perc = 95, def.season = "natural", reduction = FALSE,
  red.level = 0.9, derivative = 5, man = 11, th.ma = 5,
  n.clinical = 5, window.clinical = 7, window.grains = 5,
  th.pollen = 10, th.sum = 100, type = "none",
  interpolation = TRUE, int.method = "lineal", type.plot = "static",
  export.plot = FALSE, export.format = "pdf", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="iplot_pheno_+3A_data">data</code></td>
<td>
<p>A <code>data.frame</code> object including the general database where calculation of the pollen season must be applied in order to generate the phenological plot based on the start_dates and end_dates. This <code>data.frame</code> must include a first column in <code>Date</code> format and the rest of columns in <code>numeric</code> format belonging to each pollen type by column.</p>
</td></tr>
<tr><td><code id="iplot_pheno_+3A_method">method</code></td>
<td>
<p>A <code>character</code> string specifying the method applied to calculate the pollen season and the main parameters. The implemented methods that can be used are: <code>"percentage"</code>, <code>"logistic"</code>, <code>"moving"</code>, <code>"clinical"</code> or <code>"grains"</code>. A more detailed information about the different methods for defining the pollen season may be consulted in <code><a href="#topic+calculate_ps">calculate_ps</a></code> function.</p>
</td></tr>
<tr><td><code id="iplot_pheno_+3A_n.types">n.types</code></td>
<td>
<p>A <code>numeric</code> (<code>integer</code>) value specifying the number of the most abundant pollen types that must be represented in the pollen calendar. A more detailed information about the selection of the considered pollen types may be consulted in <strong>Details</strong>. The <code>n.types</code> argument will be <code>15</code> types by default.</p>
</td></tr>
<tr><td><code id="iplot_pheno_+3A_th.day">th.day</code></td>
<td>
<p>A <code>numeric</code> value in order to calculate the number of days when this level is exceeded for each year and each pollen type. This value will be obtained in the results of the function. The <code>th.day</code> argument will be <code>100</code> by default.</p>
</td></tr>
<tr><td><code id="iplot_pheno_+3A_perc">perc</code></td>
<td>
<p>A <code>numeric</code> value ranging <code>0_100</code>. This argument is valid only for <code>method = "percentage"</code>. This value represents the percentage of the total annual pollen included in the pollen season, removing <code>(100_perc)/2%</code> of the total pollen before and after of the pollen season. The <code>perc</code> argument will be <code>95</code> by default.</p>
</td></tr>
<tr><td><code id="iplot_pheno_+3A_def.season">def.season</code></td>
<td>
<p>A <code>character</code> string specifying the method for selecting the best annual period to calculate the pollen season. The pollen seasons may occur within the natural year or otherwise may occur between two years which determines the best annual period considered. The implemented options that can be used are: <code>"natural"</code>, <code>"interannual"</code> or <code>"peak"</code>. The <code>def.season</code> argument will be <code>"natural"</code> by default. A more detailed information about the different methods for selecting the best annual period to calculate the pollen season may be consulted in <code><a href="#topic+calculate_ps">calculate_ps</a></code> function.</p>
</td></tr>
<tr><td><code id="iplot_pheno_+3A_reduction">reduction</code></td>
<td>
<p>A <code>logical</code> value. This argument is valid only for the <code>"logistic"</code> method. If <code>FALSE</code> the reduction of the pollen data is not applicable. If <code>TRUE</code> a reduction of the peaks above a certain level (<code>red.level</code> argument) will be carried out before the definition of the pollen season. The <code>reduction</code> argument will be <code>FALSE</code> by default. A more detailed information about the reduction process may be consulted in <code><a href="#topic+calculate_ps">calculate_ps</a></code> function.</p>
</td></tr>
<tr><td><code id="iplot_pheno_+3A_red.level">red.level</code></td>
<td>
<p>A <code>numeric</code> value ranging <code>0_1</code> specifying the percentile used as level to reduce the peaks of the pollen series before the definition of the pollen season. This argument is valid only for the <code>"logistic"</code> method. The <code>red.level</code> argument will be <code>0.90</code> by default, specifying the percentile 90.</p>
</td></tr>
<tr><td><code id="iplot_pheno_+3A_derivative">derivative</code></td>
<td>
<p>A <code>numeric</code> (<code>integer</code>) value belonging to options of <code>4</code>, <code>5</code> or <code>6</code> specifying the derivative that will be applied to calculate the asymptotes which determines the pollen season using the <code>"logistic"</code> method. This argument is valid only for the <code>"logistic"</code> method. The <code>derivative</code> argument will be <code>5</code> by default.</p>
</td></tr>
<tr><td><code id="iplot_pheno_+3A_man">man</code></td>
<td>
<p>A <code>numeric</code> (<code>integer</code>) value specifying the order of the moving average applied to calculate the pollen season using the <code>"moving"</code> method. This argument is valid only for the <code>"moving"</code> method. The <code>man</code> argument will be <code>11</code> by default.</p>
</td></tr>
<tr><td><code id="iplot_pheno_+3A_th.ma">th.ma</code></td>
<td>
<p>A <code>numeric</code> value specifying the threshold used for the <code>"moving"</code> method for defining the beginning and the end of the pollen season. This argument is valid only for the <code>"moving"</code> method. The <code>th.ma</code> argument will be <code>5</code> by default.</p>
</td></tr>
<tr><td><code id="iplot_pheno_+3A_n.clinical">n.clinical</code></td>
<td>
<p>A <code>numeric</code> (<code>integer</code>) value specifying the number of days which must exceed a given threshold (<code>th.pollen</code> argument) for defining the beginning and the end of the pollen season. This argument is valid only for the <code>"clinical"</code> method. The <code>n.clinical</code> argument will be <code>5</code> by default.</p>
</td></tr>
<tr><td><code id="iplot_pheno_+3A_window.clinical">window.clinical</code></td>
<td>
<p>A <code>numeric</code> (<code>integer</code>) value specifying the time window during which the conditions must be evaluated for defining the beginning and the end of the pollen season using the <code>"clinical"</code> method. This argument is valid only for the <code>"clinical"</code> method. The <code>window.clinical</code> argument will be <code>7</code> by default.</p>
</td></tr>
<tr><td><code id="iplot_pheno_+3A_window.grains">window.grains</code></td>
<td>
<p>A <code>numeric</code> (<code>integer</code>) value specifying the time window during which the conditions must be evaluated for defining the beginning and the end of the pollen season using the <code>"grains"</code> method. This argument is valid only for the <code>"grains"</code> method. The <code>window.grains</code> argument will be <code>5</code> by default.</p>
</td></tr>
<tr><td><code id="iplot_pheno_+3A_th.pollen">th.pollen</code></td>
<td>
<p>A <code>numeric</code> value specifying the threshold that must be exceeded during a given number of days (<code>n.clinical</code> or <code>window.grains</code> arguments) for defining the beginning and the end of the pollen season using the <code>"clinical"</code> or <code>"grains"</code> methods. This argument is valid only for the <code>"clinical"</code> or <code>"grains"</code> methods. The <code>th.pollen</code> argument will be <code>10</code> by default.</p>
</td></tr>
<tr><td><code id="iplot_pheno_+3A_th.sum">th.sum</code></td>
<td>
<p>A <code>numeric</code> value specifying the pollen threshold that must be exceeded by the sum of daily pollen during a given number of days (<code>n.clinical</code> argument) exceeding a given daily threshold (<code>th.pollen</code> argument) for defining the beginning and the end of the pollen season using the <code>"clinical"</code> method. This argument is valid only for the <code>"clinical"</code> method. The <code>th.sum</code> argument will be <code>100</code> by default.</p>
</td></tr>
<tr><td><code id="iplot_pheno_+3A_type">type</code></td>
<td>
<p>A <code>character</code> string specifying the parameters considered according to a specific pollen type for calculating the pollen season using the <code>"clinical"</code> method. The implemented pollen types that may be used are: <code>"birch"</code>, <code>"grasses"</code>, <code>"cypress"</code>, <code>"olive"</code> or <code>"ragweed"</code>. As result for selecting any of these pollen types the parameters <code>n.clinical</code>, <code>window.clinical</code>, <code>th.pollen</code> and <code>th.sum</code> will be automatically adjusted for the <code>"clinical"</code> method. If no pollen types are specified (<code>type = "none"</code>), these parameters will be considered by the user. This argument is valid only for the <code>"clinical"</code> method. The <code>type</code> argument will be <code>"none"</code> by default.</p>
</td></tr>
<tr><td><code id="iplot_pheno_+3A_interpolation">interpolation</code></td>
<td>
<p>A <code>logical</code> value. If <code>FALSE</code> the interpolation of the pollen data is not applicable. If <code>TRUE</code> an interpolation of the pollen series will be applied to complete the gaps with no data before the calculation of the pollen season. The <code>interpolation</code> argument will be <code>TRUE</code> by default. A more detailed information about the interpolation method may be consulted in <strong>Details</strong>.</p>
</td></tr>
<tr><td><code id="iplot_pheno_+3A_int.method">int.method</code></td>
<td>
<p>A <code>character</code> string specifying the method selected to apply the interpolation method in order to complete the pollen series. The implemented methods that may be used are: <code>"lineal"</code>, <code>"movingmean"</code>, <code>"spline"</code> or <code>"tseries"</code>. The <code>int.method</code> argument will be <code>"lineal"</code> by default.</p>
</td></tr>
<tr><td><code id="iplot_pheno_+3A_type.plot">type.plot</code></td>
<td>
<p>A <code>character</code> string specifying the type of plot selected to show the phenological plot. The implemented types that may be used are: <code>"static"</code> generates a static <strong>ggplot</strong> object and <code>"dynamic"</code> generates a dynamic <strong>plotly</strong> object.</p>
</td></tr>
<tr><td><code id="iplot_pheno_+3A_export.plot">export.plot</code></td>
<td>
<p>A <code>logical</code> value specifying if a phenological plot saved in the working directory will be required or not. If <code>FALSE</code> graphical results will only be displayed in the active graphics window. If <code>TRUE</code> graphical results will be displayed in the active graphics window and also a <em>pdf</em> or <em>png</em> file (according to the <code>export.format</code> argument) will be saved within the <em>plot_AeRobiology</em> directory automatically created in the working directory. This argument is applicable only for <code>"static"</code> plots. The <code>export.plot</code> will be <code>FALSE</code> by default.</p>
</td></tr>
<tr><td><code id="iplot_pheno_+3A_export.format">export.format</code></td>
<td>
<p>A <code>character</code> string specifying the format selected to save the phenological plot. The implemented formats that may be used are: <code>"pdf"</code> and <code>"png"</code>. This argument is applicable only for <code>"static"</code> plots. The <code>export.format</code> will be <code>"pdf"</code> by default.</p>
</td></tr>
<tr><td><code id="iplot_pheno_+3A_...">...</code></td>
<td>
<p>Other additional arguments may be used to customize the exportation of the plots using <em>pdf</em> or <em>png</em> files and therefore arguments from <code><a href="grDevices.html#topic+pdf">pdf</a></code> and <code><a href="grDevices.html#topic+png">png</a></code> functions (<span class="pkg">grDevices</span> package) may be implemented. For example, for <em>pdf</em> files the user may custom the arguments: <code>width</code>, <code>height</code>, <code>family</code>, <code>title</code>, <code>fonts</code>, <code>paper</code>, <code>bg</code>, <code>fg</code>, <code>pointsize...</code>; and for <em>png</em> files the user may custom the arguments: <code>width</code>, <code>height</code>, <code>units</code>, <code>pointsize</code>, <code>bg</code>, <code>res...</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function allows to calculate the pollen season using five different methods which are described in <code><a href="#topic+calculate_ps">calculate_ps</a></code> function. After calculating the start_date and end_date for each pollen type and each year a phenological plot will be generated using the boxplot approach where axis x represents the time (Day of the Year) and axis y includes the considered pollen types. The phenological plot will be generated only for the specified number of the most abundant pollen types using the <code>n.types</code> argument by the user. The implemented methods for defining the pollen season includes the most commonly used methodologies (<em>Nilsson and Persson, 1981</em>; <em>Andersen, 1991</em>; <em>Galan et al., 2001</em>; <em>Ribeiro et al., 2007</em>; <em>Cunha et al., 2015</em>, <em>Pfaar et al., 2017</em>) and a new implemented method (see <code><a href="#topic+calculate_ps">calculate_ps</a></code> function).<br />
Pollen time series frequently have different gaps with no data and this fact could be a problem for the calculation of specific methods for defining the pollen season even providing incorrect results. In this sense by default a linear interpolation will be carried out to complete these gaps before to define the pollen season (<code>interpolation = TRUE</code>). Additionally, the users may select other interpolation methods using the <code>int.method</code> argument, as <code>"lineal"</code>, <code>"movingmean"</code>, <code>"spline"</code> or <code>"tseries"</code>. For more information to see the <code><a href="#topic+interpollen">interpollen</a></code> function.
</p>


<h3>Value</h3>

<p>This function returns different results:<br />
If <code>export.plot = FALSE</code> graphical results will only be displayed in the active graphics window as <strong>ggplot</strong> graph. Additional characteristics may be incorporated to the plot by <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> syntax (see <span class="pkg">ggplot2</span> package).<br />
If <code>export.plot = TRUE</code> and <code>export.format = pdf</code> a <em>pdf</em> file of the phenological plot will be saved within the <em>plot_AeRobiology</em> directory created in the working directory. This option is applicable only for <code>"static"</code> plots. Additional characteristics may be incorporated to the exportation as <em>pdf</em> file (see <span class="pkg">grDevices</span> package).<br />
If <code>export.plot = TRUE</code> and <code>export.format = png</code> a <em>png</em> file of the phenological plot will be saved within the <em>plot_AeRobiology</em> directory created in the working directory. This option is applicable only for <code>"static"</code> plots. Additional characteristics may be incorporated to the exportation <em>png</em> file (see <span class="pkg">grDevices</span> package).<br />
If <code>type.plot = dynamic</code> graphical results will be displayed in the active Viewer window as <strong>plotly</strong> graph. Additional characteristics may be incorporated to the plot <code><a href="plotly.html#topic+plotly">plotly</a></code> syntax (see <span class="pkg">plotly</span> package).
</p>


<h3>References</h3>

<p>Andersen, T.B., 1991. A model to predict the beginning of the pollen season. <em>Grana</em>, 30(1), pp.269_275.
</p>
<p>Cunha, M., Ribeiro, H., Costa, P. and Abreu, I., 2015. A comparative study of vineyard phenology and pollen metrics extracted from airborne pollen time series. <em>Aerobiologia</em>, 31(1), pp.45_56.
</p>
<p>Galan, C., Garcia_Mozo, H., Carinanos, P., Alcazar, P. and Dominguez_Vilches, E., 2001. The role of temperature in the onset of the <em>Olea europaea</em> L. pollen season in southwestern Spain. <em>International Journal of Biometeorology</em>, 45(1), pp.8_12.
</p>
<p>Nilsson, S. and Persson, S., 1981. Tree pollen spectra in the Stockholm region (Sweden), 1973_1980. <em>Grana</em>, 20(3), pp.179_182.
</p>
<p>Pfaar, O., Bastl, K., Berger, U., Buters, J., Calderon, M.A., Clot, B., Darsow, U., Demoly, P., Durham, S.R., Galan, C., Gehrig, R., Gerth van Wijk, R., Jacobsen, L., Klimek, L., Sofiev, M., Thibaudon, M. and Bergmann, K.C., 2017. Defining pollen exposure times for clinical trials of allergen immunotherapy for pollen_induced rhinoconjunctivitis_an EAACI position paper. <em>Allergy</em>, 72(5), pp.713_722.
</p>
<p>Ribeiro, H., Cunha, M. and Abreu, I., 2007. Definition of main pollen season using logistic model. <em>Annals of Agricultural and Environmental Medicine</em>, 14(2), pp.259_264.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+calculate_ps">calculate_ps</a></code>, <code><a href="#topic+interpollen">interpollen</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("munich_pollen")
iplot_pheno (munich_pollen, interpolation = FALSE)
</code></pre>

<hr>
<h2 id='iplot_pollen'>Interactive Plotting Pollen Data (one season).</h2><span id='topic+iplot_pollen'></span>

<h3>Description</h3>

<p>Function to plot the pollen data during one season. The plots are fully interactive.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>iplot_pollen(data, year)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="iplot_pollen_+3A_data">data</code></td>
<td>
<p>A <code>data.frame</code> object. This <code>data.frame</code> should include a first column in format <code>Date</code> and the rest of columns in format <code>numeric</code> belonging to each pollen type by column.</p>
</td></tr>
<tr><td><code id="iplot_pollen_+3A_year">year</code></td>
<td>
<p>An <code>integer</code> value specifying the year to display. This is a mandatory argument.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An interactive plot of the class <span class="pkg">ggvis</span>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+iplot_years">iplot_years</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("munich_pollen")
iplot_pollen(data = munich_pollen, year = 2012)
</code></pre>

<hr>
<h2 id='iplot_years'>Interactive Plotting Pollen Data (one pollen type).</h2><span id='topic+iplot_years'></span>

<h3>Description</h3>

<p>Function to plot the pollen data of a pollen type during several seasons. The plots are fully interactive.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>iplot_years(data, pollen)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="iplot_years_+3A_data">data</code></td>
<td>
<p>A <code>data.frame</code> object. This <code>data.frame</code> should include a first column in format <code>Date</code> and the rest of columns in format <code>numeric</code> belonging to each pollen type by column.</p>
</td></tr>
<tr><td><code id="iplot_years_+3A_pollen">pollen</code></td>
<td>
<p>A <code>character</code> string with the name of the particle to show. This <code>character</code> must match with the name of a column in the input database. This is a mandatory argument.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An interactive plot of the class <span class="pkg">ggvis</span>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+iplot_pollen">iplot_pollen</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("munich_pollen")
iplot_years(data = munich_pollen, pollen = "Betula")
</code></pre>

<hr>
<h2 id='ma'>Moving Average Calculator</h2><span id='topic+ma'></span>

<h3>Description</h3>

<p>Function to calculate the moving average of a given numeric vector. The order of the moving average may be customized by the user (<code>man</code> argument).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ma(data, man = 10, warnings = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ma_+3A_data">data</code></td>
<td>
<p>A <code>numeric</code> vector (e.g. a <code>numeric</code> column of a <code>dataframe</code>).</p>
</td></tr>
<tr><td><code id="ma_+3A_man">man</code></td>
<td>
<p>An <code>integer</code> value specifying the order of the moving average applied to the data. By default, <code>man = 10</code>.</p>
</td></tr>
<tr><td><code id="ma_+3A_warnings">warnings</code></td>
<td>
<p>A <code>logical</code> value specifying the show of warning messages. By default, <code>warnings = FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function returns a vector with the moving average of the input data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("munich_pollen")
ma(data = munich_pollen$Betula, man = 10, warnings = FALSE)
</code></pre>

<hr>
<h2 id='munich_pollen'>Pollen data of Munich (2010_2015)</h2><span id='topic+munich_pollen'></span>

<h3>Description</h3>

<p>A dataset containing information of daily concentrations of pollen in the atmosphere of Munich during the years 2010_2015. Pollen types included: <em>&quot;Alnus&quot;</em>, <em>&quot;Betula&quot;</em>, <em>&quot;Taxus&quot;</em>, <em>&quot;Fraxinus&quot;</em>, <em>&quot;Poaceae&quot;</em>, <em>&quot;Quercus&quot;</em>, <em>&quot;Ulmus&quot;</em> and <em>&quot;Urtica&quot;</em>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>munich_pollen
</code></pre>


<h3>Format</h3>

<p>Time series of daily pollen concentrations expressed as pollen grains / m3 of air.</p>


<h3>Details</h3>

<p>Data were obtained at Munich (Zentrum Allergie und Umwelt, ZAUM) using a Hirst_type volumetric pollen trap (Hirst, 1952) following the standard methodology (VDI4252_4_2016). Some gaps have been added to test some functions of the package (e.g. <code><a href="#topic+quality_control">quality_control</a></code>, <code><a href="#topic+interpollen">interpollen</a></code>).
</p>
<p>The data were obtained by the research team of Prof. Jeroen Buters (Christine Weil &amp; Ingrid Weichenmeier). We specially acknowledge this team and the Zentrum Allergie und Umwelt (ZAUM, directed by Prof. Carsten B. Schmidt_Weber) for their support.
</p>


<h3>Source</h3>

<p><a href="https://www.zaum-online.de/">https://www.zaum-online.de/</a>
</p>


<h3>References</h3>

<p>Hirst, J.M., 1952. AN AUTOMATIC VOLUMETRIC SPORE TRAP. Ann. Appl. Biol. 39, 257_265.
</p>
<p>VDI 4252_4. (2016). Bioaerosole und biologische Agenzien_Ermittlung von Pollen und Sporen in der Aussenluft unterVerwendung  einer volumetrischen  Methode  fuer  einMessnetz zu allergologischen Zwecken. VDI_Richtlinie4252 Blatt 4, Entwurf. VDI/DIN_Handbuch Reinhaltungder Luft, Band 1a: Beuth, Berlin
</p>

<hr>
<h2 id='plot_heathour'>Plotting hourly patterns with heatplot</h2><span id='topic+plot_heathour'></span>

<h3>Description</h3>

<p>Function to plot pollen data expressed in concentrations with time resolution higher than 1 day (e.g. hourly, bi-hourly concentrations). As heatplot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_heathour(data, locations = FALSE, low.col = "blue",
  mid.col = "white", high.col = "red")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_heathour_+3A_data">data</code></td>
<td>
<p>A <code>data.frame</code> object with the structure <code>long</code>. Where the first two columns are <code>factors</code> indicating the <code>pollen</code> and the <code>location</code>. The 3 and 4 columns are <code>POSIXct</code>, showing the hour. Where the third column is the beguinning of the concentration <code>from</code> and the fourth column is the end time of the concentrtion data <code>to</code>. The fifth column shows the concentrations of the different pollen types as <code>numeric</code>. Please see the example 3-hourly data from the automatic pollen monitor BAA500 from Munich and Viechtach in Bavaria (Germany) <code>data("POMO_pollen")</code>, supplied by ePIN Network supported by the Bavarian Government.</p>
</td></tr>
<tr><td><code id="plot_heathour_+3A_locations">locations</code></td>
<td>
<p>A <code>logical</code> object with the specification if the different locations will be displayed in the plot. Argument only used when <code>result == "plot"</code>. By default, <code>locations = FALSE</code>.</p>
</td></tr>
<tr><td><code id="plot_heathour_+3A_low.col">low.col</code></td>
<td>
<p>A <code>character</code> object with the specification of the color of the lowest value for the scale. By default, <code>low.col = "blue"</code>.</p>
</td></tr>
<tr><td><code id="plot_heathour_+3A_mid.col">mid.col</code></td>
<td>
<p>A <code>character</code> object with the specification of the color of the medium value for the scale. By default, <code>mid.col = "white"</code>.</p>
</td></tr>
<tr><td><code id="plot_heathour_+3A_high.col">high.col</code></td>
<td>
<p>A <code>character</code> object with the specification object with the specification of the color of the highest value for the scale. By default, <code>high.col = "red"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns an object or a list of objects of class <span class="pkg">ggplot2</span>.
</p>


<h3>References</h3>

<p>Oteros, J., Pusch, G., Weichenmeier, I., Heimann, U., Mueller, R., Roeseler, S., ... &amp; Buters, J. T. (2015). Automatic and online pollen monitoring. <em>International archives of allergy and immunology</em>, 167(3), 158-166.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("POMO_pollen")
plot_heathour(POMO_pollen)
</code></pre>

<hr>
<h2 id='plot_hour'>Plotting hourly patterns</h2><span id='topic+plot_hour'></span>

<h3>Description</h3>

<p>Function to plot pollen data expressed in concentrations with time resolution higher than 1 day (e.g. hourly, bi-hourly concentrations).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_hour(data, result = "plot", locations = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_hour_+3A_data">data</code></td>
<td>
<p>A <code>data.frame</code> object with the structure <code>long</code>. Where the first two columns are <code>factors</code> indicating the <code>pollen</code> and the <code>location</code>. The 3 and 4 columns are <code>POSIXct</code>, showing the hour. Where the third column is the beguinning of the concentration <code>from</code> and the fourth column is the end time of the concentrtion data <code>to</code>. The fifth column shows the concentrations of the different pollen types as <code>numeric</code>. Please see the example 3-hourly data from the automatic pollen monitor BAA500 from Munich and Viechtach in Bavaria (Germany) <code>data("POMO_pollen")</code>, supplied by ePIN Network supported by the Bavarian Government.</p>
</td></tr>
<tr><td><code id="plot_hour_+3A_result">result</code></td>
<td>
<p>A <code>character</code> object with the definition of the object to be produced by the function. If <code>result == "plot"</code>, the function returns a list of objects of class <span class="pkg">ggplot2</span>; if <code>result == "table"</code>, the function returns a <span class="pkg">data.frame</span> with the hourly patterns. By default, <code>result = "plot"</code>.</p>
</td></tr>
<tr><td><code id="plot_hour_+3A_locations">locations</code></td>
<td>
<p>A <code>logical</code> object with the specification if the different locations will be displayed in the plot. Argument only used when <code>result == "plot"</code>. By default, <code>locations = FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If <code>result == "plot"</code>, the function returns a list of objects of class <span class="pkg">ggplot2</span>; if <code>result == "table"</code>, the function returns a <span class="pkg">data.frame</span> with the hourly patterns.
</p>


<h3>References</h3>

<p>Oteros, J., Pusch, G., Weichenmeier, I., Heimann, U., Mueller, R., Roeseler, S., ... &amp; Buters, J. T. (2015). Automatic and online pollen monitoring. <em>International archives of allergy and immunology</em>, 167(3), 158-166.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("POMO_pollen")
plot_hour(POMO_pollen, result="plot", locations = FALSE)
plot_hour(POMO_pollen, result="plot", locations = TRUE)
</code></pre>

<hr>
<h2 id='plot_normsummary'>Plotting the Amplitude of Several Pollen Seasons.</h2><span id='topic+plot_normsummary'></span>

<h3>Description</h3>

<p>Function to plot the pollen data amplitude during several seasons: daily average pollen concentration over the study period, maximum pollen concentration of each day over the study period and minimum pollen concentration of each day value over the study period. It is possible to plot the relative abundance per day and smoothing the pollen season by calculating a moving average.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_normsummary(data, pollen, mave = 1, normalized = FALSE,
  interpolation = TRUE, int.method = "lineal", export.plot = FALSE,
  export.format = "pdf", color.plot = "orange2",
  axisname = "Pollen grains / m3", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_normsummary_+3A_data">data</code></td>
<td>
<p>A <code>data.frame</code> object. This <code>data.frame</code> should include a first column in format <code>Date</code> and the rest of columns in format <code>numeric</code> belonging to each pollen type by column.</p>
</td></tr>
<tr><td><code id="plot_normsummary_+3A_pollen">pollen</code></td>
<td>
<p>A <code>character</code> string with the name of the particle to show. This <code>character</code> must match with the name of a column in the input database. This is a mandatory argument.</p>
</td></tr>
<tr><td><code id="plot_normsummary_+3A_mave">mave</code></td>
<td>
<p>An <code>integer</code> value specifying the order of the moving average applied to the data. By default, <code>mave = 1</code>.</p>
</td></tr>
<tr><td><code id="plot_normsummary_+3A_normalized">normalized</code></td>
<td>
<p>A <code>logical</code> value specifying if the visualization shows real pollen data (<code>normalized = FALSE</code>) or the percentage of every day over the whole pollen season (<code>normalized = TRUE</code>). By default, <code>normalized = FALSE</code>.</p>
</td></tr>
<tr><td><code id="plot_normsummary_+3A_interpolation">interpolation</code></td>
<td>
<p>A <code>logical</code> value specifying if the visualization shows the gaps in the inputs data (<code>interpolation = FALSE</code>) or if an interpolation method is used for filling the gaps (<code>interpolation = TRUE</code>). By default, <code>interpolation = TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot_normsummary_+3A_int.method">int.method</code></td>
<td>
<p>A <code>character</code> string with the name of the interpolation method to be used. The implemented methods that may be used are: <code>"lineal"</code>, <code>"movingmean"</code>, <code>"tseries"</code> or <code>"spline"</code>. By default, <code>int.method = "lineal"</code>.</p>
</td></tr>
<tr><td><code id="plot_normsummary_+3A_export.plot">export.plot</code></td>
<td>
<p>A <code>logical</code> value specifying if a plot will be exported or not. If <code>FALSE</code> graphical results will only be displayed in the active graphics window. If <code>TRUE</code> graphical results will be displayed in the active graphics window and also one pdf/png file will be saved within the <em>plot_AeRobiology</em> directory automatically created in the working directory. By default, <code>export.plot = FALSE</code>.</p>
</td></tr>
<tr><td><code id="plot_normsummary_+3A_export.format">export.format</code></td>
<td>
<p>A <code>character</code> string specifying the format selected to save the plot. The implemented formats that may be used are: <code>"pdf"</code> or <code>"png"</code>. By default, <code>export.format = "pdf"</code>.</p>
</td></tr>
<tr><td><code id="plot_normsummary_+3A_color.plot">color.plot</code></td>
<td>
<p>A <code>character</code> string. The argument defines the color to fill the plot. Will be <code>"orange2"</code> by default.</p>
</td></tr>
<tr><td><code id="plot_normsummary_+3A_axisname">axisname</code></td>
<td>
<p>A <code>character</code> string specifying the title of the y axis. By default, <code>axisname =  "Pollen grains / m3"</code>.</p>
</td></tr>
<tr><td><code id="plot_normsummary_+3A_...">...</code></td>
<td>
<p>Other additional arguments may be used to customize the exportation of the plots using <code>"pdf"</code> or <code>"png"</code> files and therefore arguments from functions <code><a href="grDevices.html#topic+pdf">pdf</a></code> and  <code><a href="grDevices.html#topic+png">png</a></code> may be implemented. For example, for pdf files the user may custom the arguments: width, height, family, title, fonts, paper, bg, fg, pointsize...; and for png files the user may custom the arguments: width, height, units, pointsize, bg, res...</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function returns plot of class <span class="pkg">ggplot2</span>. User are able to customize the output as a <span class="pkg">ggplot2</span> object.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+calculate_ps">calculate_ps</a></code>; <code><a href="#topic+plot_summary">plot_summary</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("munich_pollen")
plot_normsummary(munich_pollen, pollen = "Betula", interpolation = FALSE, export.plot = FALSE)
</code></pre>

<hr>
<h2 id='plot_ps'>Pollen Season Plot</h2><span id='topic+plot_ps'></span>

<h3>Description</h3>

<p>Function to plot the main pollen season of a single pollen type.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_ps(data, pollen.type = NULL, year = NULL, days = 30,
  fill.col = "turquoise4", int.method = "lineal",
  axisname = expression(paste("Pollen grains / m"^"3")), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_ps_+3A_data">data</code></td>
<td>
<p>A <code>data.frame</code> object including the general database where interpollation must be performed. This <code>data.frame</code> must include a first column in <code>Date</code> format and the rest of columns in <code>numeric</code> format. Each column must contain information of one pollen type. It is not necessary to insert missing gaps; the function will automatically detect them.</p>
</td></tr>
<tr><td><code id="plot_ps_+3A_pollen.type">pollen.type</code></td>
<td>
<p>A <code>character</code> string specifying the name of the pollen type which will be plotted. The name must be exactly the same that appears in the column name. Mandatory argument with no default.</p>
</td></tr>
<tr><td><code id="plot_ps_+3A_year">year</code></td>
<td>
<p>A <code>numeric (interger)</code> value specifying the season to be plotted. The season does not necessary fit a natural year. See <code><a href="#topic+calculate_ps">calculate_ps</a></code> for more details. Mandatory argument with no default.</p>
</td></tr>
<tr><td><code id="plot_ps_+3A_days">days</code></td>
<td>
<p>A <code>numeric (interger)</code> specifying the number of days beyond each side of the main pollen season that will be represented. The <code>days</code> argument will be <code>30</code> by default.</p>
</td></tr>
<tr><td><code id="plot_ps_+3A_fill.col">fill.col</code></td>
<td>
<p>A <code>character</code> string specifying the name of the color to fill the main pollen season (Galan et al., 2017) in the plot. See <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> function for more details. The <code>fill.col</code> argument will be <code>"turquoise4"</code> by default.</p>
</td></tr>
<tr><td><code id="plot_ps_+3A_int.method">int.method</code></td>
<td>
<p>A <code>character</code> string specifying the method selected to apply the interpolation method in order to complete the pollen series. The implemented methods that may be used are: <code>"lineal"</code>,  <code>"movingmean"</code>, <code>"spline"</code> or  <code>"tseries"</code>. See <code><a href="#topic+interpollen">interpollen</a></code> function for more details. The <code>int.method</code> argument will be <code>"lineal"</code> by default.</p>
</td></tr>
<tr><td><code id="plot_ps_+3A_axisname">axisname</code></td>
<td>
<p>A <code>character</code> string or an expression specifying the y axis title of the plot. The <code>axisname</code> argument will be <code>expression(paste("Pollen grains / m" ^ "3"))</code> by default.</p>
</td></tr>
<tr><td><code id="plot_ps_+3A_...">...</code></td>
<td>
<p>Other arguments passed on to the pollen season calculation as specified in <code><a href="#topic+calculate_ps">calculate_ps</a></code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>plot_ps</code> function is designed to easily plot the main pollen season (Galan et al., 2017). The pre_peak period and the post_peak period are marked with different color intensity in the graph. The user must choose a single pollen type and season to plot.
</p>


<h3>Value</h3>

<p>The function returns an object of class <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> with a graphical representation of the main pollen season of the selected pollen type. The pre_peak and post_peak periods are marked with different color intensity.
</p>


<h3>References</h3>

<p>Galan, C., Ariatti, A., Bonini, M., Clot, B., Crouzy, B., Dahl, A., Fernandez_Gonzalez, D., Frenguelli, G., Gehrig, R., Isard, S., Levetin, E., Li, D.W., Mandrioli, P., Rogers, C.A., Thibaudon, M., Sauliene, I., Skjoth, C., Smith, M., Sofiev, M., 2017. Recommended terminology for aerobiological studies. Aerobiologia (Bologna). 293_295.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+calculate_ps">calculate_ps</a></code>, <code><a href="#topic+interpollen">interpollen</a></code>, <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("munich_pollen")
plot_ps(munich_pollen, year = 2013, pollen.type = "Betula")
</code></pre>

<hr>
<h2 id='plot_summary'>Plotting Several Pollen Seasons.</h2><span id='topic+plot_summary'></span>

<h3>Description</h3>

<p>Function to plot the pollen data during several seasons. Also plots the averaged pollen season over the study period. It is possible to plot the relative abundance per day and smoothing the pollen season by calculating a moving average.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_summary(data, pollen, mave = 1, normalized = FALSE,
  interpolation = TRUE, int.method = "lineal", export.plot = FALSE,
  export.format = "pdf", axisname = "Pollen grains / m3", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_summary_+3A_data">data</code></td>
<td>
<p>A <code>data.frame</code> object. This <code>data.frame</code> should include a first column in format <code>Date</code> and the rest of columns in format <code>numeric</code> belonging to each pollen type by column.</p>
</td></tr>
<tr><td><code id="plot_summary_+3A_pollen">pollen</code></td>
<td>
<p>A <code>character</code> string with the name of the particle to show. This <code>character</code> must match with the name of a column in the input database. This is a mandatory argument.</p>
</td></tr>
<tr><td><code id="plot_summary_+3A_mave">mave</code></td>
<td>
<p>An <code>integer</code> value specifying the order of the moving average applied to the data. By default, <code>mave = 1</code>.</p>
</td></tr>
<tr><td><code id="plot_summary_+3A_normalized">normalized</code></td>
<td>
<p>A <code>logical</code> value specifying if the visualization shows real pollen data (<code>normalized = FALSE</code>) or the percentage of every day over the whole pollen season (<code>normalized = TRUE</code>). By default, <code>normalized = FALSE</code>.</p>
</td></tr>
<tr><td><code id="plot_summary_+3A_interpolation">interpolation</code></td>
<td>
<p>A <code>logical</code> value specifying if the visualization shows the gaps in the inputs data (<code>interpolation = FALSE</code>) or if an interpolation method is used for filling the gaps (<code>interpolation = TRUE</code>). By default, <code>interpolation = TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot_summary_+3A_int.method">int.method</code></td>
<td>
<p>A <code>character</code> string with the name of the interpolation method to be used. The implemented methods that may be used are: <code>"lineal"</code>, <code>"movingmean"</code>, <code>"tseries"</code> or <code>"spline"</code>. By default, <code>int.method = "lineal"</code>.</p>
</td></tr>
<tr><td><code id="plot_summary_+3A_export.plot">export.plot</code></td>
<td>
<p>A <code>logical</code> value specifying if a plot will be exported or not. If <code>FALSE</code> graphical results will only be displayed in the active graphics window. If <code>TRUE</code> graphical results will be displayed in the active graphics window and also one pdf/png file will be saved within the <em>plot_AeRobiology</em> directory automatically created in the working directory. By default, <code>export.plot = FALSE</code>.</p>
</td></tr>
<tr><td><code id="plot_summary_+3A_export.format">export.format</code></td>
<td>
<p>A <code>character</code> string specifying the format selected to save the plot. The implemented formats that may be used are: <code>"pdf"</code> or <code>"png"</code>. By default, <code>export.format = "pdf"</code>.</p>
</td></tr>
<tr><td><code id="plot_summary_+3A_axisname">axisname</code></td>
<td>
<p>A <code>character</code> string specifying the title of the y axis. By default, <code>axisname =  "Pollen grains / m3"</code>.</p>
</td></tr>
<tr><td><code id="plot_summary_+3A_...">...</code></td>
<td>
<p>Other additional arguments may be used to customize the exportation of the plots using <code>"pdf"</code> or <code>"png"</code> files and therefore arguments from functions <code><a href="grDevices.html#topic+pdf">pdf</a></code> and <code><a href="grDevices.html#topic+png">png</a></code> may be implemented. For example, for pdf files the user may custom the arguments: width, height, family, title, fonts, paper, bg, fg, pointsize...; and for png files the user may custom the arguments: width, height, units, pointsize, bg, res...</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function allows to summarize the pollen season by a simple plot. Even though the package was originally designed to treat aeropalynological data, it can be used to study many other atmospheric components (e.g., bacteria in the air, fungi, insects ...) <em>(Buters et al., 2018; Oteros et al., 2019)</em>.
</p>


<h3>Value</h3>

<p>This function returns plot of class <span class="pkg">ggplot2</span>. User are able to customize the output as a <span class="pkg">ggplot2</span> object.
</p>


<h3>References</h3>

<p>Buters, J. T. M., Antunes, C., Galveias, A., Bergmann, K. C., Thibaudon, M., Galan, C. &amp; Oteros, J. (2018). Pollen and spore monitoring in the world. <em>Clinical and translational allergy</em>, 8(1), 9.
</p>
<p>Oteros, J., Bartusel, E., Alessandrini, F., Nunez, A., Moreno, D. A., Behrendt, H., ... &amp; Buters, J. (2019). Artemisia pollen is the main vector for airborne endotoxin. <em>Journal of Allergy and Clinical Immunology</em>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+calculate_ps">calculate_ps</a></code>; <code><a href="#topic+plot_normsummary">plot_normsummary</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> data("munich_pollen")
 plot_summary(munich_pollen, pollen = "Betula", export.plot = FALSE, interpolation = FALSE)
</code></pre>

<hr>
<h2 id='plot_trend'>Calculating and Plotting Trends of Pollen Data.</h2><span id='topic+plot_trend'></span>

<h3>Description</h3>

<p>Function to calculate the main seasonal indexes of the pollen season (<em>Start Date</em>, <em>Peak Date</em>, <em>End Date</em> and <em>Pollen Integral</em>). Trends analysis of the parameters over the seasons. Plots showing the distribution of the main seasonal indexes over the years.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_trend(data, interpolation = TRUE, int.method = "lineal",
  export.plot = TRUE, export.format = "pdf", export.result = TRUE,
  method = "percentage", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_trend_+3A_data">data</code></td>
<td>
<p>A <code>data.frame</code> object. This <code>data.frame</code> should include a first column in format <code>Date</code> and the rest of columns in format <code>numeric</code> belonging to each pollen type by column.</p>
</td></tr>
<tr><td><code id="plot_trend_+3A_interpolation">interpolation</code></td>
<td>
<p>A <code>logical</code> value specifying if the visualization shows the gaps in the inputs data (<code>interpolation = FALSE</code>) or if an interpolation method is used for filling the gaps (<code>interpolation = TRUE</code>). By default, <code>interpolation = TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot_trend_+3A_int.method">int.method</code></td>
<td>
<p>A <code>character</code> string with the name of the interpolation method to be used. The implemented methods that may be used are: <code>"lineal"</code>, <code>"movingmean"</code>, <code>"tseries"</code> or <code>"spline"</code>. By default, <code>int.method = "lineal"</code>.</p>
</td></tr>
<tr><td><code id="plot_trend_+3A_export.plot">export.plot</code></td>
<td>
<p>A <code>logical</code> value specifying if a plot will be exported or not. If <code>FALSE</code> graphical results will only be displayed in the active graphics window. If <code>TRUE</code> graphical results will be displayed in the active graphics window and also one pdf/png file will be saved within the <em>plot_AeRobiology</em> directory automatically created in the working directory. By default, <code>export.plot = TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot_trend_+3A_export.format">export.format</code></td>
<td>
<p>A <code>character</code> string specifying the format selected to save the plot. The implemented formats that may be used are: <code>"pdf"</code> or <code>"png"</code>. By default, <code>export.format = "pdf"</code>.</p>
</td></tr>
<tr><td><code id="plot_trend_+3A_export.result">export.result</code></td>
<td>
<p>A <code>logical</code> value. If <code>export.result = TRUE</code>, a table is exported with the extension <em>.xlsx</em>, in the directory <em>table_AeRobiology</em>. This table has the information about the <code>slope</code> <em>&quot;beta coefficient of a lineal model using as predictor the year and as dependent variable one of the main pollen season indexes&quot;</em>. The information is referred to the main pollen season indexes: <em>Start Date</em>, <em>Peak Date</em>, <em>End Date</em> and <em>Pollen Integral</em>.</p>
</td></tr>
<tr><td><code id="plot_trend_+3A_method">method</code></td>
<td>
<p>A <code>character</code> string specifying the method applied to calculate the pollen season and the main seasonal parameters. The implemented methods that can be used are: <code>"percentage"</code>, <code>"logistic"</code>, <code>"moving"</code>, <code>"clinical"</code> or <code>"grains"</code>. By default, <code>method = "percentage"</code> (<code>perc = 95</code>%). A more detailed information about the different methods for defining the pollen season may be consulted in the function <code><a href="#topic+calculate_ps">calculate_ps</a></code>.</p>
</td></tr>
<tr><td><code id="plot_trend_+3A_...">...</code></td>
<td>
<p>Additional arguments for the function <code><a href="#topic+calculate_ps">calculate_ps</a></code> are also accepted.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function returns several plots in the directory <em>plot_AeRobiology/trend_plots</em> with the extension <em>.pdf</em> or <em>.png</em>.Also produces an object of the class <code>data.frame</code> and export a table with the extension <em>.xlsx</em>, in the directory <em>table_AeRobiology</em>.<br />
These tables have the information about the <code>slope</code> <em>(beta coefficient of a lineal model using as predictor the year and as dependent variable one of the main pollen season indexes)</em>. The information is referred to the main pollen season indexes: <em>Start Date</em>, <em>Peak Date</em>, <em>End Date</em> and <em>Pollen Integral</em>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+calculate_ps">calculate_ps</a></code>; <code><a href="#topic+analyse_trend">analyse_trend</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> data("munich_pollen")
 plot_trend(munich_pollen, interpolation = FALSE, export.plot = FALSE, export.result = TRUE)
</code></pre>

<hr>
<h2 id='pollen_calendar'>Pollen Calendar by Different Methods from a Historical Pollen Database</h2><span id='topic+pollen_calendar'></span>

<h3>Description</h3>

<p>Function to calculate the pollen calendar from a historical database of several pollen types and using the most commonly used methods in the generation of the pollen calendars in the aerobiology field.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pollen_calendar(data, method = "heatplot", n.types = 15,
  start.month = 1, y.start = NULL, y.end = NULL, perc1 = 80,
  perc2 = 99, th.pollen = 1, average.method = "avg_before",
  period = "daily", method.classes = "exponential", n.classes = 5,
  classes = c(25, 50, 100, 300), color = "green",
  interpolation = TRUE, int.method = "lineal", na.remove = TRUE,
  result = "plot", export.plot = FALSE, export.format = "pdf",
  legendname = "Pollen grains / m3", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pollen_calendar_+3A_data">data</code></td>
<td>
<p>A <code>data.frame</code> object including the general database where calculation of the pollen calendar must be applied. This <code>data.frame</code> must include a first column in <code>Date</code> format and the rest of columns in <code>numeric</code> format belonging to each pollen type by column.</p>
</td></tr>
<tr><td><code id="pollen_calendar_+3A_method">method</code></td>
<td>
<p>A <code>character</code> string specifying the method applied to calculate and generate the pollen calendar. The implemented methods that can be used are: <code>"heatplot"</code>, <code>"violinplot"</code> or <code>"phenological"</code>. A more detailed information about the different methods for defining the pollen season may be consulted in <strong>Details</strong>. The <code>method</code> argument will be <code>heatplot</code> by default.</p>
</td></tr>
<tr><td><code id="pollen_calendar_+3A_n.types">n.types</code></td>
<td>
<p>A <code>numeric</code> (<code>integer</code>) value specifying the number of the most abundant pollen types that must be represented in the pollen calendar. A more detailed information about the selection of the considered pollen types may be consulted in <strong>Details</strong>. The <code>n.types</code> argument will be <code>15</code> types by default.</p>
</td></tr>
<tr><td><code id="pollen_calendar_+3A_start.month">start.month</code></td>
<td>
<p>A <code>numeric</code> (<code>integer</code>) value ranging <code>1_12</code> specifying the number of the month (January_December) when the beginning of the pollen calendar must be considered. This argument is only applicable for the <code>"heatplot"</code> method with <code>"daily"</code> period, for the <code>"phenological"</code> method with <code>"avg_before"</code> <code>average.method</code>, and for the <code>"violinplot"</code> method, and the rest of methods only may be generated from the January (<code>start.month = 1</code>). The <code>start.month</code> argument will be <code>1</code> (month of January) by default.</p>
</td></tr>
<tr><td><code id="pollen_calendar_+3A_y.start">y.start</code>, <code id="pollen_calendar_+3A_y.end">y.end</code></td>
<td>
<p>A <code>numeric</code> (<code>integer</code>) value specifying the period selected to calculate the pollen calendar (start year _ end year). If <code>y.start</code> and <code>y.end</code> are not specified (<code>NULL</code>), the entire database will be used to generate the pollen calendar. The <code>y.start</code> and <code>y.end</code> arguments will be <code>NULL</code> by default.</p>
</td></tr>
<tr><td><code id="pollen_calendar_+3A_perc1">perc1</code>, <code id="pollen_calendar_+3A_perc2">perc2</code></td>
<td>
<p>A <code>numeric</code> value ranging <code>0_100</code>. These arguments are valid only for the <code>"phenological"</code> method. These values represent the percentage of the total annual pollen included in the pollen season, removing <code>(100_percentage)/2%</code> of the total pollen before and after of the pollen season. Two percentages must be specified because of the definition of the &quot;main pollination period&quot; (<code>perc1</code>) and &quot;early/late pollination&quot; (<code>perc2</code>) based on the <code>"phenological"</code> method proposed by <em>Werchan et al. (2018)</em>. The <code>perc1</code> argument will be <code>80</code> and <code>perc2</code> argument will be <code>99</code> by default. A more detailed information about the <code>phenological</code> method to generate the pollen calendar may be consulted in <strong>Details</strong>.</p>
</td></tr>
<tr><td><code id="pollen_calendar_+3A_th.pollen">th.pollen</code></td>
<td>
<p>A <code>numeric</code> value specifying the minimum threshold of the average pollen concentration which will be used to generate the pollen calendar. Days below this threshold will not be considered. For the <code>"phenological"</code> method this value limits the &quot;possible occurrence&quot; period as proposed by <em>Werchan et al. (2018)</em>. The <code>th.pollen</code> argument will be <code>1</code> by default. A more detailed information about the methods to generate the pollen calendar may be consulted in <em>Details</em>.</p>
</td></tr>
<tr><td><code id="pollen_calendar_+3A_average.method">average.method</code></td>
<td>
<p>A <code>character</code> string specifying the moment of the application of the average. This argument is valid only for the <code>"phenological"</code> method. The implemented methods that can be used are: <code>"avg_before"</code> or <code>"avg_after"</code>. <code>"avg_before"</code> produces the average to the daily concentrations and then pollen season are calculated for all pollen types, this method is recommended as it is a more concordant method with respect to the rest of implemented methods. Otherwise, <code>"avg_after"</code> determines the pollen season for all years and all pollen types, and then a circular average is calculated for the start_dates and end_dates. The <code>average.method</code> argument will be <code>"avg_before"</code> by default.</p>
</td></tr>
<tr><td><code id="pollen_calendar_+3A_period">period</code></td>
<td>
<p>A <code>character</code> string specifying the interval time considered to generate the pollen calendar. This argument is valid only for the <code>"heatplot"</code> method. The implemented periods that can be used are: <code>"daily"</code> or <code>"weekly"</code>. <code>"daily"</code> selection produces a pollen calendar using daily averages during the year and <code>"weekly"</code> selection produces a pollen calendar using weekly averages during the year. The <code>period</code> argument will be <code>"daily"</code> by default.</p>
</td></tr>
<tr><td><code id="pollen_calendar_+3A_method.classes">method.classes</code></td>
<td>
<p>A  <code>character</code> string specifying the method to define the classes used for classifying the average pollen concentrations to generate the pollen calendar. This argument is valid only for the  <code>"heatplot"</code> method. The implemented methods for defining classes are:  <code>"exponential"</code> and  <code>"custom"</code>. The  <code>method.classes</code> argument will be  <code>"exponential"</code> by default. A more detailed information about the methods to classify the average pollen concentrations to generate the pollen calendar may be consulted in <strong>Details</strong>.</p>
</td></tr>
<tr><td><code id="pollen_calendar_+3A_n.classes">n.classes</code></td>
<td>
<p>A <code>numeric</code> (<code>integer</code>) value specifying the number of classes that will be used for classifying the average pollen concentrations to generate the pollen calendar. This argument is valid only for the <code>"heatplot"</code> method and the classification by <code>method.classes = "custom"</code>. The <code>n.classes</code> argument will be <code>5</code> by default. A more detailed information about the methods to classify the average pollen concentrations to generate the pollen calendar may be consulted in <strong>Details</strong>.</p>
</td></tr>
<tr><td><code id="pollen_calendar_+3A_classes">classes</code></td>
<td>
<p>A <code>numeric</code> vector specifying the threshold established to define the different classes that will be used for classifying the average pollen concentrations to generate the pollen calendar. This argument is valid only for the <code>"heatplot"</code> method and the classification by <code>method.classes = "custom"</code>. The <code>classes</code> argument will be <code>c(25, 50, 100, 300)</code> by default. The number of specified classes must be equal to <code>n.classes _ 1</code> because of the maximum threshold will be automatically specified by the maximum value. A more detailed information about the methods to classify the average pollen concentrations to generate the pollen calendar may be consulted in <strong>Details</strong>.</p>
</td></tr>
<tr><td><code id="pollen_calendar_+3A_color">color</code></td>
<td>
<p>A <code>character</code> string specifying the color to generate the graph showing the pollen calendar. This argument is valid only for the <code>"heatplot"</code> method. The implemented color palettes to generate the pollen calendar are: <code>"green"</code>, <code>"red"</code>, <code>"blue"</code>, <code>"purple"</code> or <code>"black"</code>. The <code>color</code> argument will be <code>"green"</code> by default.</p>
</td></tr>
<tr><td><code id="pollen_calendar_+3A_interpolation">interpolation</code></td>
<td>
<p>A <code>logical</code> value. If <code>FALSE</code> the interpolation of the pollen data is not applicable. If <code>TRUE</code> an interpolation of the pollen series will be applied to complete the gaps before the calculation of the pollen calendar. The <code>interpolation</code> argument will be <code>TRUE</code> by default. A more detailed information about the interpolation method may be consulted in <strong>Details</strong>.</p>
</td></tr>
<tr><td><code id="pollen_calendar_+3A_int.method">int.method</code></td>
<td>
<p>A <code>character</code> string specifying the method selected to apply the interpolation method in order to complete the pollen series. The implemented methods that may be used are: <code>"lineal"</code>, <code>"movingmean"</code>, <code>"spline"</code> or <code>"tseries"</code>. The <code>int.method</code> argument will be <code>"lineal"</code> by default.</p>
</td></tr>
<tr><td><code id="pollen_calendar_+3A_na.remove">na.remove</code></td>
<td>
<p>A <code>logical</code> value specifying if <code>na</code> values must be remove for the pollen calendar or not. <code>n.remove = TRUE</code> by default.</p>
</td></tr>
<tr><td><code id="pollen_calendar_+3A_result">result</code></td>
<td>
<p>A <code>character</code> string specifying the output for the function. The implemented outputs that may be obtained are: <code>"plot"</code> and <code>"table"</code>. The argument <code>result</code> will be <code>"plot"</code> by default.</p>
</td></tr>
<tr><td><code id="pollen_calendar_+3A_export.plot">export.plot</code></td>
<td>
<p>A <code>logical</code> value specifying if a plot with the pollen calendar saved in the working directory will be required or not. If <code>FALSE</code> graphical results will only be displayed in the active graphics window. If <code>TRUE</code> graphical results will be displayed in the active graphics window and also a <em>pdf</em> file will be saved within the <em>plot_AeRobiology</em> directory automatically created in the working directory. The <code>export.plot</code> will be <code>FALSE</code> by default.</p>
</td></tr>
<tr><td><code id="pollen_calendar_+3A_export.format">export.format</code></td>
<td>
<p>A <code>character</code> string specifying the format selected to save the pollen calendar plot. The implemented formats that may be used are: <code>"pdf"</code> and <code>"png"</code>. The <code>export.format</code> will be <code>"pdf"</code> by default.</p>
</td></tr>
<tr><td><code id="pollen_calendar_+3A_legendname">legendname</code></td>
<td>
<p>A <code>character</code> string specifying the title of the legend. By default is <code>"Pollen / m3"</code>.</p>
</td></tr>
<tr><td><code id="pollen_calendar_+3A_...">...</code></td>
<td>
<p>Other additional arguments may be used to customize the exportation of the plots using <code>"pdf"</code> or <code>"png"</code> files and therefore arguments from <em>pdf</em> and <em>png</em> functions (<span class="pkg">grDevices</span> package) may be implemented. For example, for <em>pdf</em> files the user may custom the arguments: <code>width</code>, <code>height</code>, <code>family</code>, <code>title</code>, <code>fonts</code>, <code>paper</code>, <code>bg</code>, <code>fg</code>, <code>pointsize...</code>; and for <em>png</em> files the user may custom the arguments: <code>width</code>, <code>height</code>, <code>units</code>, <code>pointsize</code>, <code>bg</code>, <code>res...</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function allows to calculate and generate the pollen calendar using three different methods which are described below. The pollen calendar will be calculated and generated only for the period specified by the user using the <code>y.start</code> and <code>y.end</code> arguments, and for the specified number of the most abundant pollen types using the <code>n.types</code> argument by the user. The most abundant pollen types will be selected according to the highest average annual amounts of pollen registered by the pollen types during the considered period.
</p>

<ul>
<li> <p><code>"heatplot"</code> method. This pollen calendar is constructed based on the daily or weekly average of pollen concentrations, depending of the preferences of the user that may select <code>"daily"</code> or <code>"weekly"</code> as <code>period</code> argument. Then, these averages may be classified in different categories following different methods selected by the user according to the <code>method.classes</code> argument. If <code>method.classes = "exponential"</code> the user will apply the classification based on exponential classes proposed by <em>Stix and Ferreti (1974)</em>, which has been commonly used in aerobiology for the generation of pollen calendars. The classification based on exponential method considers 11 classes (<code>1_2, 3_5, 6_11, 12_24, 25_49, 50_99, 100_199, 200_399, 400_799, 800_1600, &gt;1600</code>). An example of this pollen calendar may be consulted in <em>Rojo et al. (2016)</em>. This method to design pollen calendars is an adaptation from the pollen calendar proposed by <em>Spieksma (1991)</em> who considered 10_day periods instead of daily or weekly periods. Otherwise, if <code>method.classes  = "custom"</code> the user may customize the classification according to the number of classes selected (<code>n.classes</code> argument) and the thresholds of the pollen concentrations used to define the classes (<code>classes</code> argument). Average values below the level of the <code>th.pollen</code> argument will be removed from the pollen calendar.
</p>
</li>
<li> <p><code>"phenological"</code> method. This pollen calendar is based on phenological definition of the pollen season and adapted from the methodology proposed by <em>Werchan et al. (2018)</em>. After to obtain daily average pollen concentrations for the most abundant pollen types different pollination periods were calculated using the daily averages. The main pollination period was calculated based on the percentage defined by <code>perc1</code> argument (selected by the user, 80% by default) of the annual total pollen. For example, if <code>perc1 = 80</code> the beginning of the high season was marked when 10% of the annual value was reached and the end was selected when 90% was reached. In the case of the early/late pollination a total of the percentage defined by <code>perc2</code> argument (selected by the user, 99% by default) of the annual total pollen will be registered during this period. For this kind of pollen calendar the <code>th.pollen</code> argument will define the &quot;possible occurrence&quot; period as adapted by <em>Werchan et al. (2018)</em>, considering the entire period between the first and the last day when this pollen level is reached. In an alternative way the average may be carried out after to define the pollen seasons using <code>method_average = "avg_after"</code> (instead of <code>"avg_before"</code> by default). <code>"avg_after"</code> determines the pollen season for all years and all pollen types, and then an average for circular data is calculated from the start_dates and end_dates.
</p>
</li>
<li> <p><code>"violinplot"</code> method. This pollen calendar is based on the pollen intensity and adapted from the pollen calendar published by <em>ORourke (1990)</em>. In first time the daily averages of the pollen concentrations are calculated and then these averages are represented using the <em>violin plot</em> graph. The shape of the <em>violin plot</em> display the pollen intensity of the pollen types in a relative way i.e. the values will be calculated as relative measurements regarding to the most abundant pollen type in annual amounts. Therefore, this pollen calendar shows a relative comparison between the pollen intensity of the pollen types but without scales and units. Average values below the level of the <code>th.pollen</code> argument will be removed from the pollen calendar.
</p>
</li></ul>

<p>Pollen time series frequently have different gaps with no data and this fact could be a problem for the calculation of specific methods for defining the pollen season even providing incorrect results. In this sense by default a linear interpolation will be carried out to complete these gaps before to generate the pollen calendar. For more information to see the <code><a href="#topic+interpollen">interpollen</a></code> function.
</p>


<h3>Value</h3>

<p>This function returns different results:<br />
<code>plot</code> in the active graphics window displaying the pollen calendar generated by the user when <code>result = "plot"</code>. This plot may be included in an object by assignment operators.<br />
<code>data.frame</code> including the daily or weekly average pollen concentrations (according to the selection of the user) used to generate the pollen calendar. This <code>data.frame</code> will be returned when <code>result = "table"</code>.<br />
If <code>export.plot = TRUE</code> this plot displaying the pollen calendar will also be exported as file within the <em>Plot_AeRobiology</em>&quot; directory created in the working directory.<br />
If <code>export.plot = TRUE</code> and <code>export.format = pdf</code> a <em>pdf</em> file of the pollen calendar will be saved within the <em>plot_AeRobiology</em> directory created in the working directory. Additional characteristics may be incorporated to the exportation as <em>pdf</em> file (see <span class="pkg">grDevices</span> package)<br />
If <code>export.plot = TRUE</code> and <code>export.format = png</code> a <em>png</em> file of the pollen calendar will be saved within the <em>plot_AeRobiology</em> directory created in the working directory. Additional characteristics may be incorporated to the exportation as <em>png</em> file (see <span class="pkg">grDevices</span> package).
</p>


<h3>References</h3>

<p>ORourke, M.K., 1990. Comparative pollen calendars from Tucson, Arizona: Durhamvs. Burkard samplers. <em>Aerobiologia</em>, 6(2), p.136_140.
</p>
<p>Rojo, J., Rapp, A., Lara, B., Sabariego, S., Fernandez_Gonzalez, F. and Perez_Badia, R., 2016. Characterisation of the airborne pollen spectrum in Guadalajara (central Spain) and estimation of the potential allergy risk. <em>Environmental Monitoring and Assessment</em>, 188(3), p.130.
</p>
<p>Spieksma, F.T.M., 1991. <em>Regional European pollen calendars. Allergenic pollen and pollinosis in Europe</em>, pp.49_65.
</p>
<p>Stix, E. and Ferretti, M.L., 1974. <em>Pollen calendars of three locations in Western Germany. Atlas European des Pollens Allergisants</em>, pp.85_94.
</p>
<p>Werchan, M., Werchan, B. and Bergmann, K.C., 2018. German pollen calendar 4.0_update based on 2011_2016 pollen data. <em>Allergo Journal International</em>, 27, pp.69_71.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+interpollen">interpollen</a></code>, <code><a href="#topic+calculate_ps">calculate_ps</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("munich_pollen")
pollen_calendar(munich_pollen, method = "heatplot", interplation = FALSE)
</code></pre>

<hr>
<h2 id='POMO_pollen'>3-hourly pollen data of Munich and Viechtach (2018), obtained automatically by BAA500</h2><span id='topic+POMO_pollen'></span>

<h3>Description</h3>

<p>A dataset containing information of 3-hourly concentrations of pollen in the atmosphere of Munich (DEBIED) and Viechtach (DEVIEC) during the year 2018. Pollen types included: <em>&quot;Poaceae&quot;</em> and <em>&quot;Pinus&quot;</em>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>POMO_pollen
</code></pre>


<h3>Format</h3>

<p>Time series of 3-hours pollen concentrations expressed as pollen grains / m3 of air.</p>


<h3>Details</h3>

<p>Data were obtained by the automatic pollen monitor BAA500 from Munich and Viechtach in Bavaria (Germany) <code>data("POMO_pollen")</code>, supplied by the public ePIN Network supported by the Bavarian Government. The ePIN Network was built by Das Bayerische Landesamt fr Gesundheit und Lebensmittelsicherheit (LGL) in collaboration with Zentrum Allergie und Umwelt (ZAUM).
</p>


<h3>Source</h3>

<p><a href="https://www.lgl.bayern.de/">https://www.lgl.bayern.de/</a>
</p>
<p><a href="https://www.zaum-online.de/">https://www.zaum-online.de/</a>
</p>


<h3>References</h3>

<p>Oteros, J., et al., ... &amp; Buters, J. T. (2019). Building an automatic Pollen Monitoring Network (ePIN): Selection of optimal sites by clustering pollen stations.
</p>
<p>Oteros, J., Pusch, G., Weichenmeier, I., Heimann, U., Mueller, R., Roeseler, S., ... &amp; Buters, J. T. (2015). Automatic and online pollen monitoring.
</p>
<p>Hirst, J.M., 1952. AN AUTOMATIC VOLUMETRIC SPORE TRAP. Ann. Appl. Biol. 39, 257_265.
</p>
<p>VDI 4252_4. (2016). Bioaerosole und biologische Agenzien_Ermittlung von Pollen und Sporen in der Aussenluft unterVerwendung  einer volumetrischen  Methode  fuer  einMessnetz zu allergologischen Zwecken. VDI_Richtlinie4252 Blatt 4, Entwurf. VDI/DIN_Handbuch Reinhaltungder Luft, Band 1a: Beuth, Berlin
</p>

<hr>
<h2 id='quality_control'>Quality Control of a Pollen Database</h2><span id='topic+quality_control'></span>

<h3>Description</h3>

<p>Function to check the quality of an historical database of several pollen types.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>quality_control(data, int.window = 2, perc.miss = 20,
  ps.method = "percentage", result = "plot", th.day = 100,
  perc = 95, def.season = "natural", reduction = FALSE,
  red.level = 0.9, derivative = 5, man = 11, th.ma = 5,
  n.clinical = 5, window.clinical = 7, window.grains = 5,
  th.pollen = 10, th.sum = 100, type = "none",
  int.method = "lineal", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="quality_control_+3A_data">data</code></td>
<td>
<p>A <code>data.frame</code> object including the general database where quality must be checked. This data.frame must include a first column in <code>Date</code> format and the rest of columns in <code>numeric</code> format belonging to each pollen type by column. It is not necessary to insert the missing gaps; the function will automatically detect them.</p>
</td></tr>
<tr><td><code id="quality_control_+3A_int.window">int.window</code></td>
<td>
<p>A  <code>numeric (interger)</code>value bigger or equal to <code>1</code>. The argument specifies the number of days of each side of the start, peak or end date of the main pollen season which will be checked during the quality control. If any of these days has been interpolated, the current season will not pass the quality control. The <code>int.window</code> argument will be <code>2</code> by default.</p>
</td></tr>
<tr><td><code id="quality_control_+3A_perc.miss">perc.miss</code></td>
<td>
<p>A <code>numeric (interger)</code> value between <code>0</code> and <code>100</code>. The argument specifies the maximal percentage of interpolated days which is allowed inside the main pollen season to pass the quality control. The <code>perc.miss</code> argument will be <code>20</code> by default.</p>
</td></tr>
<tr><td><code id="quality_control_+3A_ps.method">ps.method</code></td>
<td>
<p>A <code>character</code> string specifying the method applied to calculate the pollen season and the main parameters. The implemented methods that can be used are: <code>"percentage"</code>, <code>"logistic"</code>, <code>"moving"</code>, <code>"clinical"</code> or <code>"grains"</code>. A more detailed information about the different methods for defining the pollen season may be consulted in <code><a href="#topic+calculate_ps">calculate_ps</a></code> function. The <code>ps.method</code> argument will be <code>"percentage"</code> by default.</p>
</td></tr>
<tr><td><code id="quality_control_+3A_result">result</code></td>
<td>
<p>A <code>character</code> string specifying the format of the results. Only <code>"plot"</code> or <code>"table"</code> available. If <code>"plot"</code>, graphical resume of the quality control will be plotted. If <code>"table"</code>, a <code>data.frame</code> will be created indicating the filters passed by each pollen type and season. Consult 'Return' for more information .The <code>result</code> argument will be <code>"plot"</code> by default.</p>
</td></tr>
<tr><td><code id="quality_control_+3A_th.day">th.day</code></td>
<td>
<p>See <code><a href="#topic+calculate_ps">calculate_ps</a></code> for more details.</p>
</td></tr>
<tr><td><code id="quality_control_+3A_perc">perc</code></td>
<td>
<p>See <code><a href="#topic+calculate_ps">calculate_ps</a></code> for more details.</p>
</td></tr>
<tr><td><code id="quality_control_+3A_def.season">def.season</code></td>
<td>
<p>See <code><a href="#topic+calculate_ps">calculate_ps</a></code> for more details.</p>
</td></tr>
<tr><td><code id="quality_control_+3A_reduction">reduction</code></td>
<td>
<p>See <code><a href="#topic+calculate_ps">calculate_ps</a></code> for more details.</p>
</td></tr>
<tr><td><code id="quality_control_+3A_red.level">red.level</code></td>
<td>
<p>See <code><a href="#topic+calculate_ps">calculate_ps</a></code> for more details.</p>
</td></tr>
<tr><td><code id="quality_control_+3A_derivative">derivative</code></td>
<td>
<p>See <code><a href="#topic+calculate_ps">calculate_ps</a></code> for more details.</p>
</td></tr>
<tr><td><code id="quality_control_+3A_man">man</code></td>
<td>
<p>See <code><a href="#topic+calculate_ps">calculate_ps</a></code> for more details.</p>
</td></tr>
<tr><td><code id="quality_control_+3A_th.ma">th.ma</code></td>
<td>
<p>See <code><a href="#topic+calculate_ps">calculate_ps</a></code> for more details.</p>
</td></tr>
<tr><td><code id="quality_control_+3A_n.clinical">n.clinical</code></td>
<td>
<p>See <code><a href="#topic+calculate_ps">calculate_ps</a></code> for more details.</p>
</td></tr>
<tr><td><code id="quality_control_+3A_window.clinical">window.clinical</code></td>
<td>
<p>See <code><a href="#topic+calculate_ps">calculate_ps</a></code> for more details.</p>
</td></tr>
<tr><td><code id="quality_control_+3A_window.grains">window.grains</code></td>
<td>
<p>See <code><a href="#topic+calculate_ps">calculate_ps</a></code> for more details.</p>
</td></tr>
<tr><td><code id="quality_control_+3A_th.pollen">th.pollen</code></td>
<td>
<p>See <code><a href="#topic+calculate_ps">calculate_ps</a></code> for more details.</p>
</td></tr>
<tr><td><code id="quality_control_+3A_th.sum">th.sum</code></td>
<td>
<p>See <code><a href="#topic+calculate_ps">calculate_ps</a></code> for more details.</p>
</td></tr>
<tr><td><code id="quality_control_+3A_type">type</code></td>
<td>
<p>See <code><a href="#topic+calculate_ps">calculate_ps</a></code> for more details.</p>
</td></tr>
<tr><td><code id="quality_control_+3A_int.method">int.method</code></td>
<td>
<p>See <code><a href="#topic+calculate_ps">calculate_ps</a></code> for more details.</p>
</td></tr>
<tr><td><code id="quality_control_+3A_...">...</code></td>
<td>
<p>Other arguments passed on to the pollen season calculation as specified in <code><a href="#topic+calculate_ps">calculate_ps</a></code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Quality control is a relevant topic for aerobiology (Oteros et al., 2013). This function is another approach to improve the quality control management in the field. <br /><code>quality_control</code> function checks the quality of the pollen data of each pollen type and season. The filters applied by the function are: <br />
</p>

<ul>
<li><p> If the main pollen season (Galan et al., 2017) cannot be calculated according to <code><a href="#topic+calculate_ps">calculate_ps</a></code> function minimal requirements (lack of data for these pollen type and year). Filter named <code>"Complete"</code> in the <code>"quality_control"</code> <code>data.frame</code>.
</p>
</li>
<li><p> If the start, end or peak date of the main pollen season has been interpolated or a day near to it (number of days specified by <code>int.window</code> argument). If a day near to these dates is missing, the selected date could not be the right one. Filters named <code>"Start"</code>, <code>"Peak"</code> and <code>"End"</code> in the <code>"quality_control"</code> <code>data.frame</code>.
</p>
</li>
<li><p> The percentage of missing data inside the main pollen season. It calculates the number of days which have been interpolated by the algorithm and their percentage inside the main pollen season. If a high percentage of the main pollen season has been interpolated, the information of these season could not be reliable. Filter named <code>"Comp.MPS"</code> in the <code>"quality_control"</code> <code>data.frame</code>.
</p>
</li></ul>



<h3>Value</h3>

<p>This function can return different results: <br />
</p>

<ul>
<li><p> If <code>result = "plot"</code>: Graphical resume of the Quality Control results showing the seasons of each pollen type and their quality (the risk assumed if they are included in further studies). The legend indicates the number of filter that have been unsuccessfully passed for each case. Object of class <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code>. For graphical customization, see <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> function.
</p>
</li>
<li><p> If <code>result = "table"</code>: <code>data.frame</code> with <code>logical</code> values for each pollen type and season. If <code>TRUE</code>, the filter has been successfully passed for this case. If FALSE, this case does not fit the minimal requirements of this filter.
</p>
</li></ul>



<h3>References</h3>

<p>Galan, C., Ariatti, A., Bonini, M., Clot, B., Crouzy, B., Dahl, A., Fernandez_Gonzalez, D., Frenguelli, G., Gehrig, R., Isard, S., Levetin, E., Li, D.W., Mandrioli, P., Rogers, C.A., Thibaudon, M., Sauliene, I., Skjoth, C., Smith, M., Sofiev, M., 2017. Recommended terminology for aerobiological studies. Aerobiologia (Bologna). 293_295.
</p>
<p>Oteros, J., Galan, C., Alcazar, P., &amp; Dominguez_Vilches, E. (2013). Quality control in bio_monitoring networks, Spanish Aerobiology Network. Science of the Total Environment, 443, 559_565.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+calculate_ps">calculate_ps</a></code>, <code><a href="#topic+interpollen">interpollen</a></code>, <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code>, <code><a href="ggplot2.html#topic+ggsave">ggsave</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("munich_pollen")
quality_control(munich_pollen[,c(1:4)])
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
