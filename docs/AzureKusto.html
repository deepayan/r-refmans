<!DOCTYPE html><html><head><title>Help for package AzureKusto</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {AzureKusto}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#add_op_join'><p>Append a join operation to the tbl_kusto object's ops list</p></a></li>
<li><a href='#add_op_set_op'><p>Append a set operation to the tbl_kusto object's ops list</p></a></li>
<li><a href='#add_op_single'><p>Append an operation representing a single-table verb to the tbl_kusto object's ops list</p></a></li>
<li><a href='#az_kusto'><p>Kusto/Azure Data Explorer cluster resource class</p></a></li>
<li><a href='#az_kusto_database'><p>Kusto/Azure Data Explorer database resource class</p></a></li>
<li><a href='#AzureKusto'><p>DBI interface: connect to a Kusto cluster</p></a></li>
<li><a href='#AzureKustoConnection-class'><p>Kusto DBI connection class</p></a></li>
<li><a href='#AzureKustoDriver-class'><p>Kusto DBI driver class</p></a></li>
<li><a href='#AzureKustoResult-class'><p>Kusto DBI result class</p></a></li>
<li><a href='#base_agg'><p>Aggregation function translations</p></a></li>
<li><a href='#base_scalar'><p>Scalar operator translations (infix and prefix)</p></a></li>
<li><a href='#base_window'><p>Window function translations</p></a></li>
<li><a href='#build_kql'><p>Build a KQL string.</p></a></li>
<li><a href='#collect.tbl_kusto'><p>Compile the preceding dplyr operations into a kusto query, execute it on the remote server,</p>
and return the result as a tibble.</a></li>
<li><a href='#compute.tbl_kusto'><p>Execute the query, store the results in a table, and return a reference to the new table</p></a></li>
<li><a href='#copy_to.kusto_database_endpoint'><p>This function uploads a local data frame into a remote data source, creating the table definition as needed.</p>
If the table exists, it will append the data to the existing table. If not, it will create a new table.</a></li>
<li><a href='#create_kusto_cluster'><p>Create Kusto/Azure Data Explorer cluster</p></a></li>
<li><a href='#dbGetQuery+2CAzureKustoConnection+2Ccharacter-method'><p>DBI methods for Kusto queries and commands</p></a></li>
<li><a href='#dbReadTable+2CAzureKustoConnection+2Ccharacter-method'><p>DBI methods for Kusto table management</p></a></li>
<li><a href='#delete_kusto_cluster'><p>Delete Kusto/Azure Data Explorer cluster</p></a></li>
<li><a href='#escape'><p>Escape/quote a string.</p></a></li>
<li><a href='#export'><p>Execute the Kusto query and export the result to Azure Storage.</p></a></li>
<li><a href='#flatten_query'><p>Walks the tree of ops and builds a stack.</p></a></li>
<li><a href='#get_kusto_cluster'><p>Get existing Kusto/Azure Data Explorer cluster</p></a></li>
<li><a href='#get_kusto_token'><p>Manage AAD authentication tokens for Kusto clusters</p></a></li>
<li><a href='#ident'><p>Flag a character string as a Kusto identifier</p></a></li>
<li><a href='#ident_q'><p>Pass an already-escaped string to Kusto</p></a></li>
<li><a href='#ingest_local'><p>Ingestion functions for Kusto</p></a></li>
<li><a href='#inner_join.tbl_kusto_abstract'><p>Join methods for Kusto tables</p></a></li>
<li><a href='#is_kusto_database'><p>Information functions</p></a></li>
<li><a href='#kql'><p>Tag character strings as Kusto Query Language. Assumes the string is valid and properly escaped.</p></a></li>
<li><a href='#kql_aggregate'><p>Return a function representing a KQL aggregation function</p></a></li>
<li><a href='#kql_build'><p>Build the tbl object into a data structure representing a Kusto query</p></a></li>
<li><a href='#kql_build.op_mutate'><p>dplyr's mutate verb can include aggregations, but Kusto's extend verb cannot.</p>
If the mutate contains no aggregations, then it can emit an extend clause.
If the mutate contains an aggregation and the tbl is ungrouped,
then it must emit a summarize clause grouped by all variables.
If the mutate contains an aggregation and the tbl is grouped,
then it must join to a subquery containing the summarize clause.</a></li>
<li><a href='#kql_escape_ident'><p>Escape a Kusto identifier with [' ']</p></a></li>
<li><a href='#kql_escape_ident_q'><p>Pass through an already-escaped Kusto identifier</p></a></li>
<li><a href='#kql_escape_logical'><p>Escape a Kusto logical value.</p>
Converts TRUE/FALSE to true / false</a></li>
<li><a href='#kql_escape_string'><p>Escape a Kusto string by single-quoting</p></a></li>
<li><a href='#kql_infix'><p>Return a function representing a scalar KQL infix operator</p></a></li>
<li><a href='#kql_prefix'><p>Return a function representing a scalar KQL prefix function</p></a></li>
<li><a href='#kql_quote'><p>Helper function for quoting kql elements.</p></a></li>
<li><a href='#kql_render'><p>Render a set of operations on a tbl_kusto_abstract to a Kusto query</p></a></li>
<li><a href='#kql_translate_env'><p>Build a kql_variant class out of the environments holding scalar and aggregation</p>
function definitions</a></li>
<li><a href='#kql_translator'><p>Builds an environment from a list of R -&gt; Kusto query language translation pairs.</p></a></li>
<li><a href='#kql_window'><p>Return a function representing a KQL window function</p></a></li>
<li><a href='#kusto_database_endpoint'><p>Endpoints for communicating with a Kusto database</p></a></li>
<li><a href='#kusto_export_cmd'><p>Execute the query, store the results in a table, and return a reference to the new table</p>
Run a Kusto query and export results to Azure Storage in Parquet or CSV
format.</a></li>
<li><a href='#kusto-DBI'><p>DBI interface to Kusto</p></a></li>
<li><a href='#nest.tbl_kusto_abstract'><p>Nest method for Kusto tables</p></a></li>
<li><a href='#op_base'><p>The &quot;base case&quot; operation representing the tbl itself and its column variables</p></a></li>
<li><a href='#op_double'><p>A double-table verb, e.g. joins, setops</p></a></li>
<li><a href='#op_grps'><p>Look up the applicable grouping variables for an operation</p>
based on the data source and preceding sequence of operations</a></li>
<li><a href='#op_single'><p>A class representing a single-table verb</p></a></li>
<li><a href='#op_vars'><p>Look up the applicable variables in scope for a given operation</p>
based on the data source and preceding sequence of operations</a></li>
<li><a href='#partial_eval'><p>Partially evaluate an expression.</p></a></li>
<li><a href='#reexports'><p>Objects exported from other packages</p></a></li>
<li><a href='#run_query'><p>Run a query or command against a Kusto database</p></a></li>
<li><a href='#show_query.tbl_kusto_abstract'><p>Translate a sequence of dplyr operations on a tbl into a Kusto query string.</p></a></li>
<li><a href='#summarise.tbl_kusto_abstract'><p>Summarise method for Kusto tables</p></a></li>
<li><a href='#tbl_kusto'><p>A tbl object representing a table in a Kusto database.</p></a></li>
<li><a href='#tbl_kusto_abstract'><p>Create a local lazy tbl</p></a></li>
<li><a href='#translate_kql'><p>Translate R expressions into Kusto Query Language equivalents.</p></a></li>
<li><a href='#unnest.tbl_kusto_abstract'><p>Unnest method for Kusto tables</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Interface to 'Kusto'/'Azure Data Explorer'</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.3</td>
</tr>
<tr>
<td>Description:</td>
<td>An interface to 'Azure Data Explorer', also known as 'Kusto', a fast, distributed data exploration service from Microsoft: <a href="https://azure.microsoft.com/en-us/products/data-explorer/">https://azure.microsoft.com/en-us/products/data-explorer/</a>. Includes 'DBI' and 'dplyr' interfaces, with the latter modelled after the 'dbplyr' package, whereby queries are translated from R into the native 'KQL' query language and executed lazily. On the admin side, the package extends the object framework provided by 'AzureRMR' to support creation and deletion of databases, and management of database principals. Part of the 'AzureR' family of packages.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/Azure/AzureKusto">https://github.com/Azure/AzureKusto</a>
<a href="https://github.com/Azure/AzureR">https://github.com/Azure/AzureR</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/Azure/AzureKusto/issues">https://github.com/Azure/AzureKusto/issues</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.3)</td>
</tr>
<tr>
<td>Imports:</td>
<td>rlang, methods, utils, httr (&ge; 1.3), jsonlite, R6, openssl,
AzureAuth, AzureRMR (&ge; 2.0.0), tibble, dplyr, tidyr,
tidyselect (&ge; 0.2.4), DBI (&ge; 1.0.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>bit64, knitr, testthat, AzureGraph, AzureStor (&ge; 2.0.0),
rmarkdown</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-10-11 18:42:27 UTC; alex</td>
</tr>
<tr>
<td>Author:</td>
<td>Hong Ooi [aut],
  Alex Kyllo [aut, cre],
  dbplyr development team [cph] (Original framework for dplyr/database
    interface),
  Microsoft [cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Alex Kyllo &lt;jekyllo@microsoft.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-10-12 09:40:19 UTC</td>
</tr>
</table>
<hr>
<h2 id='add_op_join'>Append a join operation to the tbl_kusto object's ops list</h2><span id='topic+add_op_join'></span>

<h3>Description</h3>

<p>Append a join operation to the tbl_kusto object's ops list
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_op_join(
  type,
  x,
  y,
  by = NULL,
  suffix = NULL,
  .strategy = NULL,
  .shufflekeys = NULL,
  .num_partitions = NULL,
  .remote = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add_op_join_+3A_type">type</code></td>
<td>
<p>The name of the join type,
one of: inner_join, left_join, right_join, full_join, semi_join, anti_join</p>
</td></tr>
<tr><td><code id="add_op_join_+3A_x">x</code></td>
<td>
<p>The &quot;left&quot; tbl</p>
</td></tr>
<tr><td><code id="add_op_join_+3A_y">y</code></td>
<td>
<p>The &quot;right&quot; tbl</p>
</td></tr>
<tr><td><code id="add_op_join_+3A_by">by</code></td>
<td>
<p>A vector of column names; keys by which tbl x and tbl y will be joined</p>
</td></tr>
<tr><td><code id="add_op_join_+3A_suffix">suffix</code></td>
<td>
<p>A vector of strings that will be appended to the names of non-join key columns that exist in both tbl x and tbl y to distinguish them by source tbl.</p>
</td></tr>
<tr><td><code id="add_op_join_+3A_.strategy">.strategy</code></td>
<td>
<p>A strategy hint to provide to Kusto.</p>
</td></tr>
<tr><td><code id="add_op_join_+3A_.shufflekeys">.shufflekeys</code></td>
<td>
<p>A character vector of column names to shuffle on, if <code>.strategy = "shuffle"</code>.</p>
</td></tr>
<tr><td><code id="add_op_join_+3A_.num_partitions">.num_partitions</code></td>
<td>
<p>The number of partitions for a shuffle query.</p>
</td></tr>
<tr><td><code id="add_op_join_+3A_.remote">.remote</code></td>
<td>
<p>A strategy hint to provide to Kusto for cross-cluster joins.</p>
</td></tr>
</table>

<hr>
<h2 id='add_op_set_op'>Append a set operation to the tbl_kusto object's ops list</h2><span id='topic+add_op_set_op'></span>

<h3>Description</h3>

<p>Append a set operation to the tbl_kusto object's ops list
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_op_set_op(x, y, type)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add_op_set_op_+3A_x">x</code></td>
<td>
<p>The &quot;left&quot; tbl</p>
</td></tr>
<tr><td><code id="add_op_set_op_+3A_y">y</code></td>
<td>
<p>The &quot;right&quot; tbl</p>
</td></tr>
<tr><td><code id="add_op_set_op_+3A_type">type</code></td>
<td>
<p>The type of set operation to perform, currently only supports union_all</p>
</td></tr>
</table>

<hr>
<h2 id='add_op_single'>Append an operation representing a single-table verb to the tbl_kusto object's ops list</h2><span id='topic+add_op_single'></span>

<h3>Description</h3>

<p>Append an operation representing a single-table verb to the tbl_kusto object's ops list
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_op_single(name, .data, dots = list(), args = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add_op_single_+3A_name">name</code></td>
<td>
<p>The name of the operation, e.g. 'select', 'filter'</p>
</td></tr>
<tr><td><code id="add_op_single_+3A_.data">.data</code></td>
<td>
<p>The tbl_kusto object to append the operation to</p>
</td></tr>
<tr><td><code id="add_op_single_+3A_dots">dots</code></td>
<td>
<p>The expressions passed as arguments to the operation verb</p>
</td></tr>
<tr><td><code id="add_op_single_+3A_args">args</code></td>
<td>
<p>Other non-expression arguments passed to the operation verb</p>
</td></tr>
</table>

<hr>
<h2 id='az_kusto'>Kusto/Azure Data Explorer cluster resource class</h2><span id='topic+az_kusto'></span><span id='topic+create_database'></span><span id='topic+get_database'></span><span id='topic+delete_database'></span><span id='topic+list_databases'></span>

<h3>Description</h3>

<p>Class representing a Kusto cluster, exposing methods for working with it.
</p>


<h3>Methods</h3>

<p>The following methods are available, in addition to those provided by the <a href="AzureRMR.html#topic+az_resource">AzureRMR::az_resource</a> class:
</p>

<ul>
<li> <p><code>new(...)</code>: Initialize a new storage object. See 'Initialization'.
</p>
</li>
<li> <p><code>start()</code>: Start the cluster.
</p>
</li>
<li> <p><code>stop()</code>: Stop the cluster.
</p>
</li>
<li> <p><code>create_database(...)</code>: Create a new Kusto database. See <code>Databases</code> below.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;get_database(database))&#8288;</code>: Get an existing database.
</p>
</li>
<li> <p><code>delete_database(database, confirm=TRUE)</code>: Delete a database, by default asking for confirmation first.
</p>
</li>
<li> <p><code>list_databases()</code>: List all databases in this cluster.
</p>
</li>
<li> <p><code>get_default_tenant()</code>: Retrieve the default tenant to authenticate with this cluster.
</p>
</li>
<li> <p><code>get_query_token(tenant, ...)</code>: Obtain an authentication token from Azure Active Directory for this cluster's query endpoint. Accepts further arguments that will be passed to <a href="#topic+get_kusto_token">get_kusto_token</a>.
</p>
</li>
<li> <p><code>get_ingestion_token(tenant, ...)</code>: Obtain an authentication token for this cluster's ingestion endpoint. Accepts further arguments that will be passed to <a href="#topic+get_kusto_token">get_kusto_token</a>.
</p>
</li></ul>



<h3>Initialization</h3>

<p>Initializing a new object of this class can either retrieve an existing Kusto cluster, or create a new cluster on the host. Generally, the best way to initialize an object is via the <code>get_kusto_cluster</code> and <code>create_kusto_cluster</code> methods of the <a href="AzureRMR.html#topic+az_resource_group">az_resource_group</a> class, which handle the details automatically.
</p>


<h3>Databases</h3>

<p>A Kusto cluster can have several databases, which are represented in AzureKusto via <a href="#topic+az_kusto_database">az_kusto_database</a> R6 objects. The <code>az_kusto</code> class provides the <code>create_database</code>, <code>get_database</code>, <code>delete_database</code> and <code>list_databases</code> methods for creating, deleting and retrieving databases. It's recommended to use these methods rather than calling <code>az_kusto_database$new()</code> directly.
</p>
<p><code>create_database</code> takes the following arguments. It returns an object of class <a href="#topic+az_kusto_database">az_kusto_database</a>
</p>

<ul>
<li> <p><code>database</code>: The name of the database to create.
</p>
</li>
<li> <p><code>retention_period</code>: The retention period of the database, after which data will be soft-deleted.
</p>
</li>
<li> <p><code>cache_period</code>: The cache period of the database, the length of time for which queries will be cached.
</p>
</li></ul>

<p><code>get_database</code> takes a single argument <code>database</code>, the name of the database to retrieve, and returns an object of class <code>az_kusto_database</code>. <code>delete_database</code> takes the name of the database to delete and returns NULL on a successful deletion. <code>list_databases</code> takes no arguments and returns a list of <code>az_kusto_database</code> objects, one for each database in the cluster.
</p>


<h3>See Also</h3>

<p><a href="#topic+az_kusto_database">az_kusto_database</a>, <a href="#topic+kusto_database_endpoint">kusto_database_endpoint</a>,
<a href="#topic+create_kusto_cluster">create_kusto_cluster</a>, <a href="#topic+get_kusto_cluster">get_kusto_cluster</a>, <a href="#topic+delete_kusto_cluster">delete_kusto_cluster</a>,
<a href="#topic+get_kusto_token">get_kusto_token</a>
</p>
<p><a href="https://learn.microsoft.com/en-us/azure/data-explorer/">Kusto/Azure Data Explorer documentation</a>,
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

# recommended way of retrieving a resource: via a resource group object
kus &lt;- resgroup$get_kusto_cluster("mykusto")

# list databases
kust$list_databases()

# create a new database with a retention period of 6 months
kust$create_database("newdb", retention_period=180)

# get the default authentication tenant
kus$get_default_tenant()

# generate an authentication token
kust$get_aad_token()


## End(Not run)
</code></pre>

<hr>
<h2 id='az_kusto_database'>Kusto/Azure Data Explorer database resource class</h2><span id='topic+az_kusto_database'></span>

<h3>Description</h3>

<p>Class representing a Kusto database, exposing methods for working with it.
</p>


<h3>Methods</h3>

<p>The following methods are available, in addition to those provided by the <a href="AzureRMR.html#topic+az_resource">AzureRMR::az_resource</a> class:
</p>

<ul>
<li> <p><code>new(...)</code>: Initialize a new storage object. See 'Initialization'.
</p>
</li>
<li> <p><code>add_principals(...)</code>: Add new database principals. See <code>Principals</code> below.
</p>
</li>
<li> <p><code>remove_principals(...)</code>: Remove database principals.
</p>
</li>
<li> <p><code>list_principals()</code>: Retrieve all database principals, as a data frame.
</p>
</li>
<li> <p><code>get_query_endpoint()</code>: Get a query endpoint object for interacting with the database.
</p>
</li>
<li> <p><code>get_ingestion_endpoint()</code>: Get an ingestion endpoint object for interacting with the database.
</p>
</li></ul>



<h3>Initialization</h3>

<p>Initializing a new object of this class can either retrieve an existing Kusto database, or create a new database on the server. Generally, the best way to initialize an object is via the <code>get_database</code>, <code>list_databases()</code> and <code>create_database</code> methods of the <a href="#topic+az_kusto">az_kusto</a> class, which handle the details automatically.
</p>


<h3>Principals</h3>

<p>This class provides methods for managing the principals of a database.
</p>
<p><code>add_principal</code> takes the following arguments. It returns a data frame with one row per principal, containing the details for each principal.
</p>

<ul>
<li> <p><code>name</code>: The name of the principal to create.
</p>
</li>
<li> <p><code>role</code>: The role of the principal, for example &quot;Admin&quot; or &quot;User&quot;.
</p>
</li>
<li> <p><code>type</code>: The type of principal, either &quot;User&quot; or &quot;App&quot;.
</p>
</li>
<li> <p><code>fqn</code>: The fully qualified name of the principal, for example &quot;aaduser=username@mydomain&quot; for an Azure Active Directory account. If supplied, the other details will be obtained from this.
</p>
</li>
<li> <p><code>email</code>: For a user principal, the email address.
</p>
</li>
<li> <p><code>app_id</code>: For an application principal, the ID.
</p>
</li></ul>

<p><code>remove_principal</code> removes a principal. It takes the same arguments as <code>add_principal</code>; if the supplied details do not match the actual details for the principal, it is not removed.
</p>


<h3>See Also</h3>

<p><a href="#topic+az_kusto">az_kusto</a>, <a href="#topic+kusto_database_endpoint">kusto_database_endpoint</a>,
<a href="#topic+create_database">create_database</a>, <a href="#topic+get_database">get_database</a>, <a href="#topic+delete_database">delete_database</a>
</p>
<p><a href="https://learn.microsoft.com/en-us/azure/data-explorer/">Kusto/Azure Data Explorer documentation</a>,
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

# recommended way of retrieving a resource: via a resource group object
db &lt;- resgroup$
    get_kusto_cluster("mykusto")$
    get_database("mydatabase")

# list principals
db$list_principals()

# add a new principal
db$add_principal("New User", role="User", fqn="aaduser=username@mydomain")

# get the endpoint
db$get_database_endpoint(use_integer64=FALSE)


## End(Not run)
</code></pre>

<hr>
<h2 id='AzureKusto'>DBI interface: connect to a Kusto cluster</h2><span id='topic+AzureKusto'></span><span id='topic+dbConnect+2CAzureKustoDriver-method'></span><span id='topic+AzureKusto-connection'></span><span id='topic+dbCanConnect+2CAzureKustoDriver-method'></span><span id='topic+dbDisconnect+2CAzureKustoDriver-method'></span>

<h3>Description</h3>

<p>Functions to connect to a Kusto cluster.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AzureKusto()

## S4 method for signature 'AzureKustoDriver'
dbConnect(drv, ..., bigint = c("numeric", "integer64"))

## S4 method for signature 'AzureKustoDriver'
dbCanConnect(drv, ...)

## S4 method for signature 'AzureKustoDriver'
dbDisconnect(conn, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="AzureKusto_+3A_drv">drv</code></td>
<td>
<p>An AzureKusto DBI driver object, instantiated with <code>AzureKusto()</code>.</p>
</td></tr>
<tr><td><code id="AzureKusto_+3A_...">...</code></td>
<td>
<p>Authentication arguments supplied to <code>kusto_database_endpoint</code>.</p>
</td></tr>
<tr><td><code id="AzureKusto_+3A_bigint">bigint</code></td>
<td>
<p>How to treat Kusto long integer columns. By default, they will be converted to R numeric variables. If this is &quot;integer64&quot;, they will be converted to <code>integer64</code> variables using the bit64 package.</p>
</td></tr>
<tr><td><code id="AzureKusto_+3A_conn">conn</code></td>
<td>
<p>For <code>dbDisconnect</code>, an AzureKustoConnection object obtained with <code>dbConnect</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Kusto is connectionless, so <code>dbConnect</code> simply wraps a database endpoint object, generated with <code>kusto_database_endpoint(...)</code>. The endpoint itself can be accessed via the <code style="white-space: pre;">&#8288;@endpoint&#8288;</code> slot. Similarly, <code>dbDisconnect</code> always returns TRUE.
</p>
<p><code>dbCanConnect</code> attempts to detect whether querying the database with the given information and credentials will be successful. The result may not be accurate; essentially all it does is check that its arguments are valid Kusto properties. Ultimately the best way to tell if querying will work is to try it.
</p>


<h3>Value</h3>

<p>For <code>dbConnect</code>, an object of class AzureKustoConnection.
</p>
<p>For <code>dbCanConnect</code>, TRUE if authenticating with the Kusto server succeeded with the given arguments, and FALSE otherwise.
</p>
<p>For <code>dbDisconnect</code>, always TRUE, invisibly.
</p>


<h3>See Also</h3>

<p><a href="#topic+kusto-DBI">kusto-DBI</a>, <a href="DBI.html#topic+dbReadTable">dbReadTable</a>, <a href="DBI.html#topic+dbWriteTable">dbWriteTable</a>, <a href="DBI.html#topic+dbGetQuery">dbGetQuery</a>, <a href="DBI.html#topic+dbSendStatement">dbSendStatement</a>, <a href="#topic+kusto_database_endpoint">kusto_database_endpoint</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
db &lt;- DBI::dbConnect(AzureKusto(),
    server="https://mycluster.westus.kusto.windows.net", database="database", tenantid="contoso")

DBI::dbDisconnect(db)

# no authentication credentials: returns FALSE
DBI::dbCanConnect(AzureKusto(),
    server="https://mycluster.westus.kusto.windows.net")


## End(Not run)
</code></pre>

<hr>
<h2 id='AzureKustoConnection-class'>Kusto DBI connection class</h2><span id='topic+AzureKustoConnection-class'></span>

<h3>Description</h3>

<p>Kusto DBI connection class
</p>

<hr>
<h2 id='AzureKustoDriver-class'>Kusto DBI driver class</h2><span id='topic+AzureKustoDriver-class'></span>

<h3>Description</h3>

<p>Kusto DBI driver class
</p>

<hr>
<h2 id='AzureKustoResult-class'>Kusto DBI result class</h2><span id='topic+AzureKustoResult-class'></span>

<h3>Description</h3>

<p>Kusto DBI result class
</p>

<hr>
<h2 id='base_agg'>Aggregation function translations</h2><span id='topic+base_agg'></span>

<h3>Description</h3>

<p>Aggregation function translations
</p>


<h3>Usage</h3>

<pre><code class='language-R'>base_agg
</code></pre>


<h3>Format</h3>

<p>An object of class <code>environment</code> of length 7.
</p>

<hr>
<h2 id='base_scalar'>Scalar operator translations (infix and prefix)</h2><span id='topic+base_scalar'></span>

<h3>Description</h3>

<p>Scalar operator translations (infix and prefix)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>base_scalar
</code></pre>


<h3>Format</h3>

<p>An object of class <code>environment</code> of length 79.
</p>

<hr>
<h2 id='base_window'>Window function translations</h2><span id='topic+base_window'></span>

<h3>Description</h3>

<p>Window function translations
</p>


<h3>Usage</h3>

<pre><code class='language-R'>base_window
</code></pre>


<h3>Format</h3>

<p>An object of class <code>environment</code> of length 1.
</p>

<hr>
<h2 id='build_kql'>Build a KQL string.</h2><span id='topic+build_kql'></span>

<h3>Description</h3>

<p>Build a KQL string.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>build_kql(..., .env = parent.frame())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="build_kql_+3A_...">...</code></td>
<td>
<p>input to convert to KQL. Use <code><a href="#topic+kql">kql()</a></code> to preserve
user input as is (dangerous), and <code><a href="#topic+ident">ident()</a></code> to label user
input as kql identifiers (safe)</p>
</td></tr>
<tr><td><code id="build_kql_+3A_.env">.env</code></td>
<td>
<p>the environment in which to evaluate the arguments. Should not
be needed in typical use.</p>
</td></tr>
</table>

<hr>
<h2 id='collect.tbl_kusto'>Compile the preceding dplyr operations into a kusto query, execute it on the remote server,
and return the result as a tibble.</h2><span id='topic+collect.tbl_kusto'></span>

<h3>Description</h3>

<p>Compile the preceding dplyr operations into a kusto query, execute it on the remote server,
and return the result as a tibble.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'tbl_kusto'
collect(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="collect.tbl_kusto_+3A_x">x</code></td>
<td>
<p>An instance of class tbl_kusto representing a Kusto table</p>
</td></tr>
<tr><td><code id="collect.tbl_kusto_+3A_...">...</code></td>
<td>
<p>needed for agreement with generic. Not otherwise used.</p>
</td></tr>
</table>

<hr>
<h2 id='compute.tbl_kusto'>Execute the query, store the results in a table, and return a reference to the new table</h2><span id='topic+compute.tbl_kusto'></span>

<h3>Description</h3>

<p>Execute the query, store the results in a table, and return a reference to the new table
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'tbl_kusto'
compute(x, ..., name = generate_table_name())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compute.tbl_kusto_+3A_x">x</code></td>
<td>
<p>An instance of class tbl_kusto representing a Kusto table</p>
</td></tr>
<tr><td><code id="compute.tbl_kusto_+3A_...">...</code></td>
<td>
<p>other parameters passed to the query</p>
</td></tr>
<tr><td><code id="compute.tbl_kusto_+3A_name">name</code></td>
<td>
<p>The name for the Kusto table to be created.
If name is omitted, the table will be named Rtbl_ + 8 random lowercase letters</p>
</td></tr>
</table>

<hr>
<h2 id='copy_to.kusto_database_endpoint'>This function uploads a local data frame into a remote data source, creating the table definition as needed.
If the table exists, it will append the data to the existing table. If not, it will create a new table.</h2><span id='topic+copy_to.kusto_database_endpoint'></span>

<h3>Description</h3>

<p>This function uploads a local data frame into a remote data source, creating the table definition as needed.
If the table exists, it will append the data to the existing table. If not, it will create a new table.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'kusto_database_endpoint'
copy_to(
  dest,
  df,
  name = deparse(substitute(df)),
  overwrite = FALSE,
  method = "inline",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="copy_to.kusto_database_endpoint_+3A_dest">dest</code></td>
<td>
<p>remote data source</p>
</td></tr>
<tr><td><code id="copy_to.kusto_database_endpoint_+3A_df">df</code></td>
<td>
<p>local data frame</p>
</td></tr>
<tr><td><code id="copy_to.kusto_database_endpoint_+3A_name">name</code></td>
<td>
<p>Name for new remote table</p>
</td></tr>
<tr><td><code id="copy_to.kusto_database_endpoint_+3A_overwrite">overwrite</code></td>
<td>
<p>If <code>TRUE</code>, will overwrite an existing table with
name <code>name</code>. If <code>FALSE</code>, will throw an error if <code>name</code> already
exists.</p>
</td></tr>
<tr><td><code id="copy_to.kusto_database_endpoint_+3A_method">method</code></td>
<td>
<p>For local ingestion, the method to use. &quot;inline&quot;, &quot;streaming&quot;, or &quot;indirect&quot;.</p>
</td></tr>
<tr><td><code id="copy_to.kusto_database_endpoint_+3A_...">...</code></td>
<td>
<p>other parameters passed to the query</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="dplyr.html#topic+collect">collect()</a></code> for the opposite action; downloading remote data into a local tbl.
</p>

<hr>
<h2 id='create_kusto_cluster'>Create Kusto/Azure Data Explorer cluster</h2><span id='topic+create_kusto_cluster'></span><span id='topic+create_azure_data_explorer'></span>

<h3>Description</h3>

<p>Method for the <a href="AzureRMR.html#topic+az_resource_group">AzureRMR::az_resource_group</a> class.
</p>


<h3>Usage</h3>

<div class="sourceCode"><pre>create_kusto_cluster(name, location,
                     node_size="D14_v2", ...)
</pre></div>


<h3>Arguments</h3>


<ul>
<li> <p><code>name</code>: The name of the cluster.
</p>
</li>
<li> <p><code>location</code>: The location/region in which to create the account. Defaults to the resource group location.
</p>
</li>
<li> <p><code>node_size</code>: The capacity of the nodes in each of the cluster. Defaults to &quot;D14_v2&quot;, which should be available in all regions. The availability of other sizes depends on the region the cluster is created in.
</p>
</li>
<li><p> ... Other named arguments to pass to the <a href="#topic+az_kusto">az_kusto</a> initialization function.
</p>
</li></ul>



<h3>Details</h3>

<p>This method deploys a new Kusto cluster resource, with parameters given by the arguments.
</p>


<h3>Value</h3>

<p>An object of class <code>az_kusto</code> representing the created cluster.
</p>


<h3>See Also</h3>

<p><a href="#topic+get_kusto_cluster">get_kusto_cluster</a>, <a href="#topic+delete_kusto_cluster">delete_kusto_cluster</a>, <a href="#topic+az_kusto">az_kusto</a>
</p>
<p><a href="https://learn.microsoft.com/en-us/azure/data-explorer/">Kusto/Azure Data Explorer documentation</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

rg &lt;- AzureRMR::get_azure_login("myaadtenant")$
    get_subscription("subscription_id")$
    get_resource_group("rgname")

# create a new Kusto cluster
rg$create_kusto_cluster("mykusto", node_size="L16")


## End(Not run)
</code></pre>

<hr>
<h2 id='dbGetQuery+2CAzureKustoConnection+2Ccharacter-method'>DBI methods for Kusto queries and commands</h2><span id='topic+dbGetQuery+2CAzureKustoConnection+2Ccharacter-method'></span><span id='topic+dbSendQuery+2CAzureKustoConnection-method'></span><span id='topic+dbFetch+2CAzureKustoResult-method'></span><span id='topic+dbSendStatement+2CAzureKustoConnection+2Ccharacter-method'></span><span id='topic+dbExecute+2CAzureKustoConnection+2Ccharacter-method'></span><span id='topic+dbListFields+2CAzureKustoConnection+2Ccharacter-method'></span><span id='topic+dbColumnInfo+2CAzureKustoResult-method'></span>

<h3>Description</h3>

<p>DBI methods for Kusto queries and commands
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'AzureKustoConnection,character'
dbGetQuery(conn, statement, ...)

## S4 method for signature 'AzureKustoConnection'
dbSendQuery(conn, statement, ...)

## S4 method for signature 'AzureKustoResult'
dbFetch(res, n = -1, ...)

## S4 method for signature 'AzureKustoConnection,character'
dbSendStatement(conn, statement, ...)

## S4 method for signature 'AzureKustoConnection,character'
dbExecute(conn, statement, ...)

## S4 method for signature 'AzureKustoConnection,character'
dbListFields(conn, name, ...)

## S4 method for signature 'AzureKustoResult'
dbColumnInfo(res, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dbGetQuery+2B2CAzureKustoConnection+2B2Ccharacter-method_+3A_conn">conn</code></td>
<td>
<p>An AzureKustoConnection object.</p>
</td></tr>
<tr><td><code id="dbGetQuery+2B2CAzureKustoConnection+2B2Ccharacter-method_+3A_statement">statement</code></td>
<td>
<p>A string containing a Kusto query or control command.</p>
</td></tr>
<tr><td><code id="dbGetQuery+2B2CAzureKustoConnection+2B2Ccharacter-method_+3A_...">...</code></td>
<td>
<p>Further arguments passed to <code>run_query</code>.</p>
</td></tr>
<tr><td><code id="dbGetQuery+2B2CAzureKustoConnection+2B2Ccharacter-method_+3A_res">res</code></td>
<td>
<p>An AzureKustoResult resultset object</p>
</td></tr>
<tr><td><code id="dbGetQuery+2B2CAzureKustoConnection+2B2Ccharacter-method_+3A_n">n</code></td>
<td>
<p>The number of rows to return. Not used.</p>
</td></tr>
<tr><td><code id="dbGetQuery+2B2CAzureKustoConnection+2B2Ccharacter-method_+3A_name">name</code></td>
<td>
<p>For <code>dbListFields</code>, a table name.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These are the basic DBI functions to query the database. Note that Kusto only supports synchronous queries and commands; in particular, <code>dbSendQuery</code> and <code>dbSendStatement</code> will wait for the query or statement to complete, rather than returning immediately.
</p>
<p><code>dbSendStatement</code> and <code>dbExecute</code> are meant for running Kusto control commands, and will throw an error if passed a regular query. <code>dbExecute</code> also returns the entire result of running the command, rather than simply a row count.
</p>


<h3>See Also</h3>

<p><a href="DBI.html#topic+dbConnect">dbConnect</a>, <a href="DBI.html#topic+dbReadTable">dbReadTable</a>, <a href="DBI.html#topic+dbWriteTable">dbWriteTable</a>, <a href="#topic+run_query">run_query</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

db &lt;- DBI::dbConnect(AzureKusto(),
    server="https://mycluster.location.kusto.windows.net", database="database"...)

DBI::dbGetQuery(db, "iris | count")
DBI::dbListFields(db, "iris")

# does the same thing as dbGetQuery, but returns an AzureKustoResult object
res &lt;- DBI::dbSendQuery(db, "iris | count")
DBI::dbFetch(res)
DBI::dbColumnInfo(res)

DBI::dbExecute(db, ".show tables")

# does the same thing as dbExecute, but returns an AzureKustoResult object
res &lt;- DBI::dbSendStatement(db, ".show tables")
DBI::dbFetch(res)


## End(Not run)
</code></pre>

<hr>
<h2 id='dbReadTable+2CAzureKustoConnection+2Ccharacter-method'>DBI methods for Kusto table management</h2><span id='topic+dbReadTable+2CAzureKustoConnection+2Ccharacter-method'></span><span id='topic+dbWriteTable+2CAzureKustoConnection+2CANY-method'></span><span id='topic+dbCreateTable+2CAzureKustoConnection-method'></span><span id='topic+dbRemoveTable+2CAzureKustoConnection+2CANY-method'></span><span id='topic+dbListTables+2CAzureKustoConnection-method'></span><span id='topic+dbExistsTable+2CAzureKustoConnection+2CANY-method'></span>

<h3>Description</h3>

<p>DBI methods for Kusto table management
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'AzureKustoConnection,character'
dbReadTable(conn, name, ...)

## S4 method for signature 'AzureKustoConnection,ANY'
dbWriteTable(conn, name, value, method, ...)

## S4 method for signature 'AzureKustoConnection'
dbCreateTable(conn, name, fields, ..., row.names = NULL, temporary = FALSE)

## S4 method for signature 'AzureKustoConnection,ANY'
dbRemoveTable(conn, name, ...)

## S4 method for signature 'AzureKustoConnection'
dbListTables(conn, ...)

## S4 method for signature 'AzureKustoConnection,ANY'
dbExistsTable(conn, name, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dbReadTable+2B2CAzureKustoConnection+2B2Ccharacter-method_+3A_conn">conn</code></td>
<td>
<p>An AzureKustoConnection object.</p>
</td></tr>
<tr><td><code id="dbReadTable+2B2CAzureKustoConnection+2B2Ccharacter-method_+3A_name">name</code></td>
<td>
<p>A string containing a table name.</p>
</td></tr>
<tr><td><code id="dbReadTable+2B2CAzureKustoConnection+2B2Ccharacter-method_+3A_...">...</code></td>
<td>
<p>Further arguments passed to <code>run_query</code>.</p>
</td></tr>
<tr><td><code id="dbReadTable+2B2CAzureKustoConnection+2B2Ccharacter-method_+3A_value">value</code></td>
<td>
<p>For <code>dbWriteTable</code>, a data frame to be written to a Kusto table.</p>
</td></tr>
<tr><td><code id="dbReadTable+2B2CAzureKustoConnection+2B2Ccharacter-method_+3A_method">method</code></td>
<td>
<p>For <code>dbWriteTable</code>, the ingestion method to use to write the table. See <a href="#topic+ingest_local">ingest_local</a>.</p>
</td></tr>
<tr><td><code id="dbReadTable+2B2CAzureKustoConnection+2B2Ccharacter-method_+3A_fields">fields</code></td>
<td>
<p>For <code>dbCreateTable</code>, the table specification: either a named character vector, or a data frame of sample values.</p>
</td></tr>
<tr><td><code id="dbReadTable+2B2CAzureKustoConnection+2B2Ccharacter-method_+3A_row.names">row.names</code></td>
<td>
<p>For <code>dbCreateTable</code>, the row names. Not used.</p>
</td></tr>
<tr><td><code id="dbReadTable+2B2CAzureKustoConnection+2B2Ccharacter-method_+3A_temporary">temporary</code></td>
<td>
<p>For <code>dbCreateTable</code>, whether to create a temporary table. Must be <code>FALSE</code> for Kusto.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions read, write, create and delete a table, list the tables in a Kusto database, and check for table existence. With the exception of <code>dbWriteTable</code>, they ultimately call <code>run_query</code> which does the actual work of communicating with the Kusto server. <code>dbWriteTable</code> calls <code>ingest_local</code> to write the data to the server; note that it only supports ingesting a local data frame, as per the DBI spec.
</p>
<p>Kusto does not have the concept of temporary tables, so calling <code>dbCreateTable</code> with <code>temporary</code> set to anything other than <code>FALSE</code> will generate an error.
</p>
<p><code>dbReadTable</code> and <code>dbWriteTable</code> are likely to be of limited use in practical scenarios, since Kusto tables tend to be much larger than available memory.
</p>


<h3>Value</h3>

<p>For <code>dbReadTable</code>, an in-memory data frame containing the table.
</p>


<h3>See Also</h3>

<p><a href="#topic+AzureKusto-connection">AzureKusto-connection</a>, <a href="DBI.html#topic+dbConnect">dbConnect</a>, <a href="#topic+run_query">run_query</a>, <a href="#topic+ingest_local">ingest_local</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
db &lt;- DBI::dbConnect(AzureKusto(),
    server="https://mycluster.location.kusto.windows.net", database="database"...)

DBI::dbListTables(db)

if(!DBI::dbExistsTable(db, "mtcars"))
    DBI::dbCreateTable(db, "mtcars")

DBI::dbWriteTable(db, "mtcars", mtcars, method="inline")

DBI::dbReadTable(db, "mtcars")

DBI::dbRemoveTable(db, "mtcars")


## End(Not run)
</code></pre>

<hr>
<h2 id='delete_kusto_cluster'>Delete Kusto/Azure Data Explorer cluster</h2><span id='topic+delete_kusto_cluster'></span><span id='topic+delete_kusto_cluster+2C'></span><span id='topic+delete_azure_data_explorer'></span>

<h3>Description</h3>

<p>Method for the <a href="AzureRMR.html#topic+az_resource_group">AzureRMR::az_resource_group</a> class.
</p>


<h3>Usage</h3>

<div class="sourceCode"><pre>delete_kusto_cluster(name, confirm=TRUE, wait=FALSE)
</pre></div>


<h3>Arguments</h3>


<ul>
<li> <p><code>name</code>: The name of the cluster.
</p>
</li>
<li> <p><code>confirm</code>: Whether to ask for confirmation before deleting.
</p>
</li>
<li> <p><code>wait</code>: Whether to wait until the deletion is complete.
</p>
</li></ul>



<h3>Value</h3>

<p>NULL on successful deletion.
</p>


<h3>See Also</h3>

<p><a href="#topic+create_kusto_cluster">create_kusto_cluster</a>, <a href="#topic+get_kusto_cluster">get_kusto_cluster</a>, <a href="#topic+az_kusto">az_kusto</a>
</p>
<p><a href="https://learn.microsoft.com/en-us/azure/data-explorer/">Kusto/Azure Data Explorer documentation</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

rg &lt;- AzureRMR::az_rm$
    new(tenant="myaadtenant.onmicrosoft.com", app="app_id", password="password")$
    get_subscription("subscription_id")$
    get_resource_group("rgname")

# delete a Kusto cluster
rg$delete_kusto_cluster("mycluster")


## End(Not run)
</code></pre>

<hr>
<h2 id='escape'>Escape/quote a string.</h2><span id='topic+escape'></span><span id='topic+kql_vector'></span>

<h3>Description</h3>

<p>Escape/quote a string.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>escape(x, parens = NA, collapse = " ")

kql_vector(x, parens = NA, collapse = " ")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="escape_+3A_x">x</code></td>
<td>
<p>An object to escape. Existing kql vectors will be left as is,
character vectors are escaped with single quotes, numeric vectors have
trailing <code>.0</code> added if they're whole numbers, identifiers are
escaped with double quotes.</p>
</td></tr>
<tr><td><code id="escape_+3A_parens">parens</code>, <code id="escape_+3A_collapse">collapse</code></td>
<td>
<p>Controls behaviour when multiple values are supplied.
<code>parens</code> should be a logical flag, or if <code>NA</code>, will wrap in
parens if length &gt; 1.
</p>
<p>Default behaviour: lists are always wrapped in parens and separated by
commas, identifiers are separated by commas and never wrapped,
atomic vectors are separated by spaces and wrapped in parens if needed.</p>
</td></tr>
</table>

<hr>
<h2 id='export'>Execute the Kusto query and export the result to Azure Storage.</h2><span id='topic+export'></span><span id='topic+export.kusto_database_endpoint'></span><span id='topic+export.tbl_kusto'></span>

<h3>Description</h3>

<p>Execute the Kusto query and export the result to Azure Storage.
</p>
<p>Execute the Kusto query and export the result to Azure Storage.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>export(
  tbl,
  storage_uri,
  query = NULL,
  name_prefix = "export",
  key = "impersonate",
  format = "parquet",
  distributed = FALSE,
  ...
)

## S3 method for class 'kusto_database_endpoint'
export(
  tbl,
  storage_uri,
  query = NULL,
  name_prefix = "export",
  key = "impersonate",
  format = "parquet",
  distributed = FALSE,
  ...
)

## S3 method for class 'tbl_kusto'
export(
  tbl,
  storage_uri,
  query = NULL,
  name_prefix = "export",
  key = "impersonate",
  format = "parquet",
  distributed = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="export_+3A_tbl">tbl</code></td>
<td>
<p>A Kusto database endpoint object, as returned by <code>kusto_database_endpoint</code>.</p>
</td></tr>
<tr><td><code id="export_+3A_storage_uri">storage_uri</code></td>
<td>
<p>The Azure Storage URI to export files to.</p>
</td></tr>
<tr><td><code id="export_+3A_query">query</code></td>
<td>
<p>A Kusto query string</p>
</td></tr>
<tr><td><code id="export_+3A_name_prefix">name_prefix</code></td>
<td>
<p>The filename prefix to use for exported files.</p>
</td></tr>
<tr><td><code id="export_+3A_key">key</code></td>
<td>
<p>default &quot;impersonate&quot; which uses the account signed into Kusto to
authenticate to Azure Storage. An Azure Storage account key.</p>
</td></tr>
<tr><td><code id="export_+3A_format">format</code></td>
<td>
<p>Options are &quot;parquet&quot;, &quot;csv&quot;, &quot;tsv&quot;, &quot;json&quot;</p>
</td></tr>
<tr><td><code id="export_+3A_distributed">distributed</code></td>
<td>
<p>logical, indicates whether Kusto should distributed the
export job to multiple nodes, in which case multiple files will be written
to storage concurrently.</p>
</td></tr>
<tr><td><code id="export_+3A_...">...</code></td>
<td>
<p>needed for agreement with generic. Not otherwise used.</p>
</td></tr>
</table>

<hr>
<h2 id='flatten_query'>Walks the tree of ops and builds a stack.</h2><span id='topic+flatten_query'></span>

<h3>Description</h3>

<p>Walks the tree of ops and builds a stack.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>flatten_query(op, ops = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="flatten_query_+3A_op">op</code></td>
<td>
<p>the current operation</p>
</td></tr>
<tr><td><code id="flatten_query_+3A_ops">ops</code></td>
<td>
<p>the stack of operations to append to, recursively</p>
</td></tr>
</table>

<hr>
<h2 id='get_kusto_cluster'>Get existing Kusto/Azure Data Explorer cluster</h2><span id='topic+get_kusto_cluster'></span><span id='topic+get_azure_data_explorer'></span>

<h3>Description</h3>

<p>Method for the <a href="AzureRMR.html#topic+az_resource_group">AzureRMR::az_resource_group</a> class.
</p>


<h3>Usage</h3>

<div class="sourceCode"><pre>get_kusto_cluster(name, location,
                     node_size="D14_v2")
</pre></div>


<h3>Arguments</h3>


<ul>
<li> <p><code>name</code>: The name of the cluster.
</p>
</li></ul>



<h3>Details</h3>

<p>This method retrieves an existing Kusto cluster resource.
</p>


<h3>Value</h3>

<p>An object of class <code>az_kusto</code> representing the created cluster.
</p>


<h3>See Also</h3>

<p><a href="#topic+create_kusto_cluster">create_kusto_cluster</a>, <a href="#topic+delete_kusto_cluster">delete_kusto_cluster</a>, <a href="#topic+az_kusto">az_kusto</a>
</p>
<p><a href="https://learn.microsoft.com/en-us/azure/data-explorer/">Kusto/Azure Data Explorer documentation</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

rg &lt;- AzureRMR::get_azure_login("myaadtenant")$
    get_subscription("subscription_id")$
    get_resource_group("rgname")

# get a Kusto cluster
rg$get_kusto_cluster("mykusto")


## End(Not run)
</code></pre>

<hr>
<h2 id='get_kusto_token'>Manage AAD authentication tokens for Kusto clusters</h2><span id='topic+get_kusto_token'></span><span id='topic+delete_kusto_token'></span><span id='topic+list_kusto_tokens'></span>

<h3>Description</h3>

<p>Manage AAD authentication tokens for Kusto clusters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_kusto_token(
  server = NULL,
  clustername,
  location = NULL,
  tenant = NULL,
  app = .kusto_app_id,
  auth_type = NULL,
  version = 2,
  ...
)

delete_kusto_token(
  server = NULL,
  clustername,
  location = NULL,
  tenant = NULL,
  app = .kusto_app_id,
  auth_type = NULL,
  version = 2,
  ...,
  hash = NULL,
  confirm = TRUE
)

list_kusto_tokens()
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_kusto_token_+3A_server">server</code></td>
<td>
<p>The URI of your Kusto cluster. If not supplied, it is obtained from the <code>clustername</code> and <code>location</code> arguments.</p>
</td></tr>
<tr><td><code id="get_kusto_token_+3A_clustername">clustername</code></td>
<td>
<p>The cluster name.</p>
</td></tr>
<tr><td><code id="get_kusto_token_+3A_location">location</code></td>
<td>
<p>The cluster location. Leave this blank for a Microsoft-internal Kusto cluster like &quot;help&quot;.</p>
</td></tr>
<tr><td><code id="get_kusto_token_+3A_tenant">tenant</code></td>
<td>
<p>Your Azure Active Directory (AAD) tenant. Can be a GUID, a name (&quot;myaadtenant&quot;) or a fully qualified domain name (&quot;myaadtenant.com&quot;).</p>
</td></tr>
<tr><td><code id="get_kusto_token_+3A_app">app</code></td>
<td>
<p>The ID of the Azure Active Directory app/service principal to authenticate with. Defaults to the ID of the KustoClient app.</p>
</td></tr>
<tr><td><code id="get_kusto_token_+3A_auth_type">auth_type</code></td>
<td>
<p>The authentication method to use. Can be one of &quot;authorization_code&quot;, &quot;device_code&quot;, &quot;client_credentials&quot; or &quot;resource_owner&quot;. The default is to pick one based on the other arguments.</p>
</td></tr>
<tr><td><code id="get_kusto_token_+3A_version">version</code></td>
<td>
<p>The AAD version to use. There should be no reason to change this from the default value of 2.</p>
</td></tr>
<tr><td><code id="get_kusto_token_+3A_...">...</code></td>
<td>
<p>Other arguments to pass to <a href="AzureAuth.html#topic+get_azure_token">AzureAuth::get_azure_token</a>.</p>
</td></tr>
<tr><td><code id="get_kusto_token_+3A_hash">hash</code></td>
<td>
<p>For <code>delete_kusto_token</code>, the MD5 hash of the token. This is used to identify the token if provided.</p>
</td></tr>
<tr><td><code id="get_kusto_token_+3A_confirm">confirm</code></td>
<td>
<p>For <code>delete_kusto_token</code>, whether to ask for confirmation before deleting the token.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>get_kusto_token</code> returns an authentication token for the given cluster, caching its value on disk. <code>delete_kusto_token</code> deletes a cached token, and <code>list_kusto_tokens</code> lists all cached tokens.
</p>
<p>By default, authentication tokens will be obtained using the main KustoClient Active Directory app. This app can be used to authenticate with any Kusto cluster (assuming, of course, you have the proper credentials).
</p>


<h3>Value</h3>

<p><code>get_kusto_token</code> returns an object of class AzureAuth::AzureToken representing the authentication token, while <code>list_kusto_tokens</code> returns a list of such objects. <code>delete_azure_token</code> returns NULL on a successful delete.
</p>


<h3>See Also</h3>

<p><a href="#topic+kusto_database_endpoint">kusto_database_endpoint</a>, <a href="AzureAuth.html#topic+get_azure_token">AzureAuth::get_azure_token</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

get_kusto_token("https://myclust.australiaeast.kusto.windows.net")
get_kusto_token(clustername="myclust", location="australiaeast")

# authenticate using client_credentials method: see ?AzureAuth::get_azure_token
get_kusto_token("https://myclust.australiaeast.kusto.windows.net",
                tenant="mytenant", app="myapp", password="password")


## End(Not run)
</code></pre>

<hr>
<h2 id='ident'>Flag a character string as a Kusto identifier</h2><span id='topic+ident'></span>

<h3>Description</h3>

<p>Flag a character string as a Kusto identifier
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ident(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ident_+3A_...">...</code></td>
<td>
<p>character strings to flag as Kusto identifiers</p>
</td></tr>
</table>

<hr>
<h2 id='ident_q'>Pass an already-escaped string to Kusto</h2><span id='topic+ident_q'></span>

<h3>Description</h3>

<p>Pass an already-escaped string to Kusto
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ident_q(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ident_q_+3A_...">...</code></td>
<td>
<p>character strings to treat as already-escaped identifiers</p>
</td></tr>
</table>

<hr>
<h2 id='ingest_local'>Ingestion functions for Kusto</h2><span id='topic+ingest_local'></span><span id='topic+ingest_url'></span><span id='topic+ingest_blob'></span><span id='topic+ingest_adls2'></span><span id='topic+ingest_adls1'></span>

<h3>Description</h3>

<p>Ingestion functions for Kusto
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ingest_local(
  database,
  src,
  dest_table,
  method = NULL,
  staging_container = NULL,
  ingestion_token = database$token,
  http_status_handler = "stop",
  ...
)

ingest_url(database, src, dest_table, async = FALSE, ...)

ingest_blob(
  database,
  src,
  dest_table,
  async = FALSE,
  key = NULL,
  token = NULL,
  sas = NULL,
  ...
)

ingest_adls2(
  database,
  src,
  dest_table,
  async = FALSE,
  key = NULL,
  token = NULL,
  sas = NULL,
  ...
)

ingest_adls1(
  database,
  src,
  dest_table,
  async = FALSE,
  key = NULL,
  token = NULL,
  sas = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ingest_local_+3A_database">database</code></td>
<td>
<p>A Kusto database endpoint object, created with <a href="#topic+kusto_database_endpoint">kusto_database_endpoint</a>.</p>
</td></tr>
<tr><td><code id="ingest_local_+3A_src">src</code></td>
<td>
<p>The source data. This can be either a data frame, local filename, or URL.</p>
</td></tr>
<tr><td><code id="ingest_local_+3A_dest_table">dest_table</code></td>
<td>
<p>The name of the destination table.</p>
</td></tr>
<tr><td><code id="ingest_local_+3A_method">method</code></td>
<td>
<p>For local ingestion, the method to use. See 'Details' below.</p>
</td></tr>
<tr><td><code id="ingest_local_+3A_staging_container">staging_container</code></td>
<td>
<p>For local ingestion, an Azure storage container to use for staging the dataset. This can be an object of class either <a href="AzureStor.html#topic+blob_container">AzureStor::blob_container</a> or <a href="AzureStor.html#topic+adls_filesystem">AzureStor::adls_filesystem</a>. Only used if <code>method="indirect"</code>.</p>
</td></tr>
<tr><td><code id="ingest_local_+3A_ingestion_token">ingestion_token</code></td>
<td>
<p>For local ingestion, an Azure Active Directory authentication token for the cluster ingestion endpoint. Only used if <code>method="streaming"</code>.</p>
</td></tr>
<tr><td><code id="ingest_local_+3A_http_status_handler">http_status_handler</code></td>
<td>
<p>For local ingestion, how to handle HTTP conditions &gt;= 300. Defaults to &quot;stop&quot;; alternatives are &quot;warn&quot;, &quot;message&quot; and &quot;pass&quot;. The last option will pass through the raw response object from the server unchanged, regardless of the status code. This is mostly useful for debugging purposes, or if you want to see what the Kusto REST API does. Only used if <code>method="streaming"</code>.</p>
</td></tr>
<tr><td><code id="ingest_local_+3A_...">...</code></td>
<td>
<p>Named arguments to be treated as ingestion parameters.</p>
</td></tr>
<tr><td><code id="ingest_local_+3A_async">async</code></td>
<td>
<p>For the URL ingestion functions, whether to do the ingestion asychronously. If TRUE, the function will return immediately while the server handles the operation in the background.</p>
</td></tr>
<tr><td><code id="ingest_local_+3A_key">key</code>, <code id="ingest_local_+3A_token">token</code>, <code id="ingest_local_+3A_sas">sas</code></td>
<td>
<p>Authentication arguments for the Azure storage ingestion methods. If multiple arguments are supplied, a key takes priority over a token, which takes priority over a SAS. Note that these arguments are for authenticating with the Azure <em>storage account</em>, as opposed to Kusto itself.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>There are up to 3 possible ways to ingest a local dataset, specified by the <code>method</code> argument.
</p>

<ul>
<li> <p><code>method="indirect"</code>: The data is uploaded to blob storage, and then ingested from there. This is the default if the AzureStor package is present.
</p>
</li>
<li> <p><code>method="streaming"</code>: The data is uploaded to the cluster ingestion endpoint. This is the default if the AzureStor package is not present, however be aware that currently (as of February 2019) streaming ingestion is in beta and has to be enabled for a cluster by filing a support ticket.
</p>
</li>
<li> <p><code>method="inline"</code>: The data is embedded into the command text itself. This is only recommended for testing purposes, or small datasets.
</p>
</li></ul>

<p>Note that the destination table must be created ahead of time for the ingestion to proceed.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

# ingesting from local:

# ingest via Azure storage
cont &lt;- AzureStor::storage_container("https://mystorage.blob.core.windows.net/container",
    sas="mysas")
ingest_local(db, "file.csv", "table",
    method="indirect", storage_container=cont)

ingest_local(db, "file.csv", "table", method="streaming")

# ingest by inlining data into query
ingest_inline(db, "file.csv", "table", method="inline")

# ingesting online data:

# a public dataset: Microsoft web data from UCI machine learning repository
ingest_url(db,
    "https://archive.ics.uci.edu/ml/machine-learning-databases/anonymous/anonymous-msweb.data",
    "table")

# from blob storage:
ingest_blob(db,
    "https://mystorage.blob.core.windows.net/container/myblob",
    "table",
    sas="mysas")

# from ADLSGen2:
token &lt;- AzureRMR::get_azure_token("https://storage.azure.com", "mytenant", "myapp", "password")
ingest_blob(db,
    "abfss://filesystem@myadls2.dfs.core.windows.net/data/myfile",
    "table",
    token=token)


## End(Not run)
</code></pre>

<hr>
<h2 id='inner_join.tbl_kusto_abstract'>Join methods for Kusto tables</h2><span id='topic+inner_join.tbl_kusto_abstract'></span><span id='topic+inner_join'></span><span id='topic+left_join'></span><span id='topic+right_join'></span><span id='topic+full_join'></span><span id='topic+semi_join'></span><span id='topic+anti_join'></span><span id='topic+left_join.tbl_kusto_abstract'></span><span id='topic+right_join.tbl_kusto_abstract'></span><span id='topic+full_join.tbl_kusto_abstract'></span><span id='topic+semi_join.tbl_kusto_abstract'></span><span id='topic+anti_join.tbl_kusto_abstract'></span>

<h3>Description</h3>

<p>These methods are the same as other joining methods, with the exception of the <code>.strategy</code>, <code>.shufflekeys</code> and <code>.num_partitions</code> optional arguments. They provide hints to the Kusto engine on how to execute the join, and can sometimes be useful to speed up a query. See the Kusto documentation for more details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'tbl_kusto_abstract'
inner_join(
  x,
  y,
  by = NULL,
  copy = NULL,
  suffix = c(".x", ".y"),
  ...,
  keep = NULL,
  .strategy = NULL,
  .shufflekeys = NULL,
  .num_partitions = NULL,
  .remote = NULL
)

## S3 method for class 'tbl_kusto_abstract'
left_join(
  x,
  y,
  by = NULL,
  copy = NULL,
  suffix = c(".x", ".y"),
  ...,
  keep = NULL,
  .strategy = NULL,
  .shufflekeys = NULL,
  .num_partitions = NULL,
  .remote = NULL
)

## S3 method for class 'tbl_kusto_abstract'
right_join(
  x,
  y,
  by = NULL,
  copy = NULL,
  suffix = c(".x", ".y"),
  ...,
  keep = NULL,
  .strategy = NULL,
  .shufflekeys = NULL,
  .num_partitions = NULL,
  .remote = NULL
)

## S3 method for class 'tbl_kusto_abstract'
full_join(
  x,
  y,
  by = NULL,
  copy = NULL,
  suffix = c(".x", ".y"),
  ...,
  keep = NULL,
  .strategy = NULL,
  .shufflekeys = NULL,
  .num_partitions = NULL,
  .remote = NULL
)

## S3 method for class 'tbl_kusto_abstract'
semi_join(
  x,
  y,
  by = NULL,
  copy = NULL,
  ...,
  suffix = c(".x", ".y"),
  .strategy = NULL,
  .shufflekeys = NULL,
  .num_partitions = NULL,
  .remote = NULL
)

## S3 method for class 'tbl_kusto_abstract'
anti_join(
  x,
  y,
  by = NULL,
  copy = NULL,
  suffix = c(".x", ".y"),
  .strategy = NULL,
  .shufflekeys = NULL,
  .num_partitions = NULL,
  .remote = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="inner_join.tbl_kusto_abstract_+3A_x">x</code>, <code id="inner_join.tbl_kusto_abstract_+3A_y">y</code></td>
<td>
<p>Kusto tbls.</p>
</td></tr>
<tr><td><code id="inner_join.tbl_kusto_abstract_+3A_by">by</code></td>
<td>
<p>The columns to join on.</p>
</td></tr>
<tr><td><code id="inner_join.tbl_kusto_abstract_+3A_copy">copy</code></td>
<td>
<p>Needed for agreement with generic. Not otherwise used.</p>
</td></tr>
<tr><td><code id="inner_join.tbl_kusto_abstract_+3A_suffix">suffix</code></td>
<td>
<p>The suffixes to use for deduplicating column names.</p>
</td></tr>
<tr><td><code id="inner_join.tbl_kusto_abstract_+3A_...">...</code></td>
<td>
<p>Other arguments passed to lower-level functions.</p>
</td></tr>
<tr><td><code id="inner_join.tbl_kusto_abstract_+3A_keep">keep</code></td>
<td>
<p>Needed for agreement with generic. Not otherwise used. Kusto retains keys from both sides of joins.</p>
</td></tr>
<tr><td><code id="inner_join.tbl_kusto_abstract_+3A_.strategy">.strategy</code></td>
<td>
<p>A join strategy hint to pass to Kusto. Currently the values supported are &quot;shuffle&quot; and &quot;broadcast&quot;.</p>
</td></tr>
<tr><td><code id="inner_join.tbl_kusto_abstract_+3A_.shufflekeys">.shufflekeys</code></td>
<td>
<p>A character vector of column names to use as shuffle keys.</p>
</td></tr>
<tr><td><code id="inner_join.tbl_kusto_abstract_+3A_.num_partitions">.num_partitions</code></td>
<td>
<p>The number of partitions for a shuffle query.</p>
</td></tr>
<tr><td><code id="inner_join.tbl_kusto_abstract_+3A_.remote">.remote</code></td>
<td>
<p>A join strategy hint to use for cross-cluster joins. Can be &quot;left&quot;, &quot;right&quot;, &quot;local&quot; or &quot;auto&quot; (the default).</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><a href="dplyr.html#topic+mutate-joins">dplyr::join</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

tbl1 &lt;- tbl_kusto(db, "table1")
tbl2 &lt;- tbl_kusto(db, "table2")

# standard dplyr syntax:
left_join(tbl1, tbl2)

# Kusto extensions:
left_join(tbl1, tbl2, .strategy = "broadcast") # a broadcast join

left_join(tbl1, tbl2, .shufflekeys = c("var1", "var2")) # shuffle join with shuffle keys

left_join(tbl1, tbl2, .num_partitions = 5) # no. of partitions for a shuffle join

## End(Not run)

</code></pre>

<hr>
<h2 id='is_kusto_database'>Information functions</h2><span id='topic+is_kusto_database'></span><span id='topic+is_kusto_cluster'></span>

<h3>Description</h3>

<p>These functions test whether an object is of the given class.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is_kusto_database(x)

is_kusto_cluster(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is_kusto_database_+3A_x">x</code></td>
<td>
<p>An R object.</p>
</td></tr>
</table>

<hr>
<h2 id='kql'>Tag character strings as Kusto Query Language. Assumes the string is valid and properly escaped.</h2><span id='topic+kql'></span>

<h3>Description</h3>

<p>Tag character strings as Kusto Query Language. Assumes the string is valid and properly escaped.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kql(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kql_+3A_...">...</code></td>
<td>
<p>character strings to tag as KQL</p>
</td></tr>
</table>

<hr>
<h2 id='kql_aggregate'>Return a function representing a KQL aggregation function</h2><span id='topic+kql_aggregate'></span>

<h3>Description</h3>

<p>Return a function representing a KQL aggregation function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kql_aggregate(f)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kql_aggregate_+3A_f">f</code></td>
<td>
<p>Name of the Kusto aggregation function</p>
</td></tr>
</table>

<hr>
<h2 id='kql_build'>Build the tbl object into a data structure representing a Kusto query</h2><span id='topic+kql_build'></span>

<h3>Description</h3>

<p>Build the tbl object into a data structure representing a Kusto query
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kql_build(op)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kql_build_+3A_op">op</code></td>
<td>
<p>A nested sequence of query operations, i.e. tbl_kusto$ops</p>
</td></tr>
</table>

<hr>
<h2 id='kql_build.op_mutate'>dplyr's mutate verb can include aggregations, but Kusto's extend verb cannot.
If the mutate contains no aggregations, then it can emit an extend clause.
If the mutate contains an aggregation and the tbl is ungrouped,
then it must emit a summarize clause grouped by all variables.
If the mutate contains an aggregation and the tbl is grouped,
then it must join to a subquery containing the summarize clause.</h2><span id='topic+kql_build.op_mutate'></span>

<h3>Description</h3>

<p>dplyr's mutate verb can include aggregations, but Kusto's extend verb cannot.
If the mutate contains no aggregations, then it can emit an extend clause.
If the mutate contains an aggregation and the tbl is ungrouped,
then it must emit a summarize clause grouped by all variables.
If the mutate contains an aggregation and the tbl is grouped,
then it must join to a subquery containing the summarize clause.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'op_mutate'
kql_build(op, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kql_build.op_mutate_+3A_op">op</code></td>
<td>
<p>A nested sequence of query operations, i.e. tbl_kusto$ops</p>
</td></tr>
<tr><td><code id="kql_build.op_mutate_+3A_...">...</code></td>
<td>
<p>Needed for agreement with generic. Not otherwise used.</p>
</td></tr>
</table>

<hr>
<h2 id='kql_escape_ident'>Escape a Kusto identifier with [' ']</h2><span id='topic+kql_escape_ident'></span>

<h3>Description</h3>

<p>Escape a Kusto identifier with [' ']
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kql_escape_ident(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kql_escape_ident_+3A_x">x</code></td>
<td>
<p>An identifier to escape</p>
</td></tr>
</table>

<hr>
<h2 id='kql_escape_ident_q'>Pass through an already-escaped Kusto identifier</h2><span id='topic+kql_escape_ident_q'></span>

<h3>Description</h3>

<p>Pass through an already-escaped Kusto identifier
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kql_escape_ident_q(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kql_escape_ident_q_+3A_x">x</code></td>
<td>
<p>An identifier to pass through</p>
</td></tr>
</table>

<hr>
<h2 id='kql_escape_logical'>Escape a Kusto logical value.
Converts TRUE/FALSE to true / false</h2><span id='topic+kql_escape_logical'></span>

<h3>Description</h3>

<p>Escape a Kusto logical value.
Converts TRUE/FALSE to true / false
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kql_escape_logical(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kql_escape_logical_+3A_x">x</code></td>
<td>
<p>A logical value to escape</p>
</td></tr>
</table>

<hr>
<h2 id='kql_escape_string'>Escape a Kusto string by single-quoting</h2><span id='topic+kql_escape_string'></span>

<h3>Description</h3>

<p>Escape a Kusto string by single-quoting
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kql_escape_string(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kql_escape_string_+3A_x">x</code></td>
<td>
<p>A string to escape</p>
</td></tr>
</table>

<hr>
<h2 id='kql_infix'>Return a function representing a scalar KQL infix operator</h2><span id='topic+kql_infix'></span>

<h3>Description</h3>

<p>Return a function representing a scalar KQL infix operator
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kql_infix(f)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kql_infix_+3A_f">f</code></td>
<td>
<p>Name of a Kusto infix operator / function</p>
</td></tr>
</table>

<hr>
<h2 id='kql_prefix'>Return a function representing a scalar KQL prefix function</h2><span id='topic+kql_prefix'></span>

<h3>Description</h3>

<p>Return a function representing a scalar KQL prefix function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kql_prefix(f, n = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kql_prefix_+3A_f">f</code></td>
<td>
<p>Name of a Kusto infix function</p>
</td></tr>
<tr><td><code id="kql_prefix_+3A_n">n</code></td>
<td>
<p>Number of arguments accepted by the Kusto prefix function</p>
</td></tr>
</table>

<hr>
<h2 id='kql_quote'>Helper function for quoting kql elements.</h2><span id='topic+kql_quote'></span>

<h3>Description</h3>

<p>If the quote character is present in the string, it will be doubled.
<code>NA</code>s will be replaced with NULL.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kql_quote(x, quote)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kql_quote_+3A_x">x</code></td>
<td>
<p>Character vector to escape.</p>
</td></tr>
<tr><td><code id="kql_quote_+3A_quote">quote</code></td>
<td>
<p>Single quoting character.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>kql_quote("abc", "'")
kql_quote("I've had a good day", "'")
kql_quote(c("abc", NA), "'")
</code></pre>

<hr>
<h2 id='kql_render'>Render a set of operations on a tbl_kusto_abstract to a Kusto query</h2><span id='topic+kql_render'></span>

<h3>Description</h3>

<p>Render a set of operations on a tbl_kusto_abstract to a Kusto query
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kql_render(query, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kql_render_+3A_query">query</code></td>
<td>
<p>The tbl_kusto instance with a sequence of operations in $ops</p>
</td></tr>
<tr><td><code id="kql_render_+3A_...">...</code></td>
<td>
<p>needed for agreement with generic. Not otherwise used.</p>
</td></tr>
</table>

<hr>
<h2 id='kql_translate_env'>Build a kql_variant class out of the environments holding scalar and aggregation
function definitions</h2><span id='topic+kql_translate_env'></span>

<h3>Description</h3>

<p>Build a kql_variant class out of the environments holding scalar and aggregation
function definitions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kql_translate_env()
</code></pre>

<hr>
<h2 id='kql_translator'>Builds an environment from a list of R -&gt; Kusto query language translation pairs.</h2><span id='topic+kql_translator'></span>

<h3>Description</h3>

<p>Builds an environment from a list of R -&gt; Kusto query language translation pairs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kql_translator(..., .funs = list(), .parent = new.env(parent = emptyenv()))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kql_translator_+3A_...">...</code></td>
<td>
<p>Pairs of R call = Kusto call translations as individual arguments</p>
</td></tr>
<tr><td><code id="kql_translator_+3A_.funs">.funs</code></td>
<td>
<p>Parse of R call = Kusto call translations in list format</p>
</td></tr>
<tr><td><code id="kql_translator_+3A_.parent">.parent</code></td>
<td>
<p>A parent environment to attach this env onto</p>
</td></tr>
</table>

<hr>
<h2 id='kql_window'>Return a function representing a KQL window function</h2><span id='topic+kql_window'></span>

<h3>Description</h3>

<p>Return a function representing a KQL window function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kql_window(f)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kql_window_+3A_f">f</code></td>
<td>
<p>Name of the Kusto aggregation function</p>
</td></tr>
</table>

<hr>
<h2 id='kusto_database_endpoint'>Endpoints for communicating with a Kusto database</h2><span id='topic+kusto_database_endpoint'></span>

<h3>Description</h3>

<p>Endpoints for communicating with a Kusto database
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kusto_database_endpoint(
  ...,
  .connection_string = NULL,
  .query_token = NULL,
  .use_integer64 = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kusto_database_endpoint_+3A_...">...</code></td>
<td>
<p>Named arguments which are the properties for the endpoint object. See 'Details' below for the properties that AzureKusto recognises.</p>
</td></tr>
<tr><td><code id="kusto_database_endpoint_+3A_.connection_string">.connection_string</code></td>
<td>
<p>An alternative way of specifying the properties, as a database connection string. Properties supplied here override those in <code>...</code> if they overlap.</p>
</td></tr>
<tr><td><code id="kusto_database_endpoint_+3A_.query_token">.query_token</code></td>
<td>
<p>Optionally, an Azure Active Directory (AAD) token to authenticate with. If this is supplied, it overrides other tokens specified in <code>...</code> or in the connection string.</p>
</td></tr>
<tr><td><code id="kusto_database_endpoint_+3A_.use_integer64">.use_integer64</code></td>
<td>
<p>For <code>kusto_database_endpoint</code>, whether to convert columns with Kusto <code>long</code> datatype into 64-bit integers in R, using the bit64 package. If FALSE, represent them as numeric instead.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a list of properties recognised by <code>kusto_database_endpoint</code>, and their alternate names. Property names not in this list will generate an error. Note that not all properties that are recognised are currently supported by AzureKusto.
</p>
<p>General properties:
</p>

<ul>
<li><p> server: The URI of the server, usually of the form 'https://clustername.location.kusto.windows.net'.
</p>

<ul>
<li><p> addr, address, network address, datasource, host
</p>
</li></ul>

</li>
<li><p> database: The database.
</p>

<ul>
<li><p> initialcatalog, dbname
</p>
</li></ul>

</li>
<li><p> tenantid: The AAD tenant name or ID to authenticate with.
</p>

<ul>
<li><p> authority
</p>
</li></ul>

</li>
<li><p> appclientid: The AAD app/service principal ID
</p>

<ul>
<li><p> applicationclientid
</p>
</li></ul>

</li>
<li><p> traceclientversion: The client version for tracing.
</p>
</li>
<li><p> queryconsistency: The level of query consistency. Defaults to &quot;weakconsistency&quot;.
</p>
</li>
<li><p> response_dynamic_serialization: How to serialize dynamic responses.
</p>
</li>
<li><p> response_dynamic_serialization_2: How to serialize dynamic responses.
</p>
</li></ul>

<p>User authentication properties:
</p>

<ul>
<li><p> password
</p>
</li></ul>


<ul>
<li><p> user: The user name.
</p>

<ul>
<li><p> uid, userid
</p>
</li></ul>

</li>
<li><p> traceusername: The user name for tracing.
</p>
</li>
<li><p> usertoken: The AAD token for user authentication.
</p>
</li>
<li> 

<ul>
<li><p> usertoken, usrtoken
</p>
</li></ul>

</li>
<li><p> fed: Logical, whether federated authentication is enabled. Currently unsupported; if this is TRUE, <code>kusto_database_endpoint</code> will print a warning and ignore it.
</p>

<ul>
<li><p> federated security, federated, aadfed, aadfederatedsecurity
</p>
</li></ul>

</li></ul>

<p>App authentication properties:
</p>

<ul>
<li><p> appkey: The secret key for the app.
</p>

<ul>
<li><p> applicationkey
</p>
</li></ul>

</li>
<li><p> traceappname: The AAD app for tracing.
</p>
</li>
<li><p> apptoken: The AAD token for app authentication.
</p>

<ul>
<li><p> apptoken, applicationtoken
</p>
</li></ul>

</li></ul>

<p>Currently, AzureKusto only supports authentication via Azure Active Directory. Authenticating with DSTS is planned for the future.
</p>
<p>The way <code>kusto_database_endpoint</code> obtains an AAD token is as follows.
</p>

<ol>
<li><p> If the <code>.query_token</code> argument is supplied, use it.
</p>
</li>
<li><p> Otherwise, if the <code>usertoken</code> property is supplied, use it.
</p>
</li>
<li><p> Otherwise, if the <code>apptoken</code> property is supplied, use it.
</p>
</li>
<li><p> Otherwise, if the <code>appclientid</code> property is supplied, use it to obtain a token:
</p>

<ul>
<li><p> With the <code>user</code> and <code>pwd</code> properties if available
</p>
</li>
<li><p> Or with the <code>appkey</code> property if available
</p>
</li>
<li><p> Otherwise do an interactive authentication and ask for the user credentials
</p>
</li></ul>

</li>
<li><p> Otherwise, if no <code>appclientid</code> property is supplied, authenticate with the KustoClient app:
</p>

<ul>
<li><p> With the <code>user</code> and <code>pwd</code> properties if available
</p>
</li>
<li><p> Otherwise do an interactive authentication and ask for the user credentials using a device code
</p>
</li></ul>

</li></ol>



<h3>Value</h3>

<p>An object of class <code>kusto_database_endpoint</code>.
</p>


<h3>See Also</h3>

<p><a href="#topic+run_query">run_query</a>, <a href="#topic+az_kusto_database">az_kusto_database</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

kusto_database_endpoint(server="myclust.australiaeast.kusto.windows.net", database="db1")

# supplying a token obtained previously
token &lt;- get_kusto_token("myclust.australiaeast.kusto.windows.net")
kusto_database_endpoint(server="myclust.australiaeast.kusto.windows.net", database="db1",
                        .query_token=token)


## End(Not run)
</code></pre>

<hr>
<h2 id='kusto_export_cmd'>Execute the query, store the results in a table, and return a reference to the new table
Run a Kusto query and export results to Azure Storage in Parquet or CSV
format.</h2><span id='topic+kusto_export_cmd'></span>

<h3>Description</h3>

<p>Execute the query, store the results in a table, and return a reference to the new table
Run a Kusto query and export results to Azure Storage in Parquet or CSV
format.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kusto_export_cmd(query, storage_uri, name_prefix, key, format, distributed)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kusto_export_cmd_+3A_query">query</code></td>
<td>
<p>The text of the Kusto query to run</p>
</td></tr>
<tr><td><code id="kusto_export_cmd_+3A_storage_uri">storage_uri</code></td>
<td>
<p>The URI of the blob storage container to export to</p>
</td></tr>
<tr><td><code id="kusto_export_cmd_+3A_name_prefix">name_prefix</code></td>
<td>
<p>The filename prefix for each exported file</p>
</td></tr>
<tr><td><code id="kusto_export_cmd_+3A_key">key</code></td>
<td>
<p>The account key for the storage container.
uses the identity that is signed into Kusto to authenticate to Azure Storage.</p>
</td></tr>
<tr><td><code id="kusto_export_cmd_+3A_format">format</code></td>
<td>
<p>Options are &quot;parquet&quot;, &quot;csv&quot;, &quot;tsv&quot;, &quot;json&quot;</p>
</td></tr>
<tr><td><code id="kusto_export_cmd_+3A_distributed">distributed</code></td>
<td>
<p>logical, indicates whether Kusto should distributed the
export job to multiple nodes, in which case multiple files will be written
to storage concurrently.</p>
</td></tr>
</table>

<hr>
<h2 id='kusto-DBI'>DBI interface to Kusto</h2><span id='topic+kusto-DBI'></span><span id='topic+kusto_dbi'></span><span id='topic+AzureKusto_dbi'></span>

<h3>Description</h3>

<p>AzureKusto implements a subset of the DBI specification for interfacing with databases in R. The following methods are supported:
</p>

<ul>
<li><p> Connections: <a href="DBI.html#topic+dbConnect">dbConnect</a>, <a href="DBI.html#topic+dbDisconnect">dbDisconnect</a>, <a href="DBI.html#topic+dbCanConnect">dbCanConnect</a>
</p>
</li>
<li><p> Table management: <a href="DBI.html#topic+dbExistsTable">dbExistsTable</a>, <a href="DBI.html#topic+dbCreateTable">dbCreateTable</a>, <a href="DBI.html#topic+dbRemoveTable">dbRemoveTable</a>, <a href="DBI.html#topic+dbReadTable">dbReadTable</a>, <a href="DBI.html#topic+dbWriteTable">dbWriteTable</a>
</p>
</li>
<li><p> Querying: <a href="DBI.html#topic+dbGetQuery">dbGetQuery</a>, <a href="DBI.html#topic+dbSendQuery">dbSendQuery</a>, <a href="DBI.html#topic+dbFetch">dbFetch</a>, <a href="DBI.html#topic+dbSendStatement">dbSendStatement</a>, <a href="DBI.html#topic+dbExecute">dbExecute</a>, <a href="DBI.html#topic+dbListFields">dbListFields</a>, <a href="DBI.html#topic+dbColumnInfo">dbColumnInfo</a>
</p>
</li></ul>



<h3>Details</h3>

<p>Kusto is quite different to the SQL databases that DBI targets, which affects the behaviour of certain DBI methods and renders other moot.
</p>

<ul>
<li><p> Kusto is connectionless. <code>dbConnect</code> simply wraps a database endpoint object, created with <a href="#topic+kusto_database_endpoint">kusto_database_endpoint</a>. Similarly, <code>dbDisconnect</code> always returns TRUE. <code>dbCanConnect</code> attempts to check if querying the database will succeed, but this may not be accurate.
</p>
</li>
<li><p> Temporary tables are not a Kusto concept, so <code style="white-space: pre;">&#8288;dbCreateTable(*, temporary=TRUE)&#8288;</code> will throw an error.
</p>
</li>
<li><p> It only supports synchronous queries, with a default timeout of 4 minutes. <code>dbSendQuery</code> and <code>dbSendStatement</code> will wait for the query to execute, rather than returning immediately. The object returned contains the full result of the query, which <code>dbFetch</code> extracts.
</p>
</li>
<li><p> The Kusto Query Language (KQL) is not SQL, and so higher-level SQL methods are not implemented.
</p>
</li></ul>


<hr>
<h2 id='nest.tbl_kusto_abstract'>Nest method for Kusto tables</h2><span id='topic+nest.tbl_kusto_abstract'></span>

<h3>Description</h3>

<p>This method collapses a column into a list
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'tbl_kusto_abstract'
nest(.data, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nest.tbl_kusto_abstract_+3A_.data">.data</code></td>
<td>
<p>A kusto tbl.</p>
</td></tr>
<tr><td><code id="nest.tbl_kusto_abstract_+3A_...">...</code></td>
<td>
<p>Specification of columns to nest. Translates to summarize make_list() in Kusto.</p>
</td></tr>
</table>

<hr>
<h2 id='op_base'>The &quot;base case&quot; operation representing the tbl itself and its column variables</h2><span id='topic+op_base'></span>

<h3>Description</h3>

<p>The &quot;base case&quot; operation representing the tbl itself and its column variables
</p>


<h3>Usage</h3>

<pre><code class='language-R'>op_base(x, vars, class = character())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="op_base_+3A_x">x</code></td>
<td>
<p>A tbl object</p>
</td></tr>
<tr><td><code id="op_base_+3A_vars">vars</code></td>
<td>
<p>A vector of column variables in the tbl</p>
</td></tr>
<tr><td><code id="op_base_+3A_class">class</code></td>
<td>
<p>The class that op_base should inherit from, default is character()</p>
</td></tr>
</table>

<hr>
<h2 id='op_double'>A double-table verb, e.g. joins, setops</h2><span id='topic+op_double'></span>

<h3>Description</h3>

<p>A double-table verb, e.g. joins, setops
</p>


<h3>Usage</h3>

<pre><code class='language-R'>op_double(name, x, y, args = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="op_double_+3A_name">name</code></td>
<td>
<p>The name of the operation, e.g. 'left_join', 'union_all'</p>
</td></tr>
<tr><td><code id="op_double_+3A_x">x</code></td>
<td>
<p>The &quot;left&quot; tbl</p>
</td></tr>
<tr><td><code id="op_double_+3A_y">y</code></td>
<td>
<p>The &quot;right&quot; tbl</p>
</td></tr>
<tr><td><code id="op_double_+3A_args">args</code></td>
<td>
<p>Other arguments passed to the operation verb</p>
</td></tr>
</table>

<hr>
<h2 id='op_grps'>Look up the applicable grouping variables for an operation
based on the data source and preceding sequence of operations</h2><span id='topic+op_grps'></span>

<h3>Description</h3>

<p>Look up the applicable grouping variables for an operation
based on the data source and preceding sequence of operations
</p>


<h3>Usage</h3>

<pre><code class='language-R'>op_grps(op)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="op_grps_+3A_op">op</code></td>
<td>
<p>An operation instance</p>
</td></tr>
</table>

<hr>
<h2 id='op_single'>A class representing a single-table verb</h2><span id='topic+op_single'></span>

<h3>Description</h3>

<p>A class representing a single-table verb
</p>


<h3>Usage</h3>

<pre><code class='language-R'>op_single(name, x, dots = list(), args = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="op_single_+3A_name">name</code></td>
<td>
<p>the name of the operation verb, e.g. &quot;select&quot;, &quot;filter&quot;</p>
</td></tr>
<tr><td><code id="op_single_+3A_x">x</code></td>
<td>
<p>the tbl object</p>
</td></tr>
<tr><td><code id="op_single_+3A_dots">dots</code></td>
<td>
<p>expressions passed to the operation verb function</p>
</td></tr>
<tr><td><code id="op_single_+3A_args">args</code></td>
<td>
<p>other arguments passed to the operation verb function</p>
</td></tr>
</table>

<hr>
<h2 id='op_vars'>Look up the applicable variables in scope for a given operation
based on the data source and preceding sequence of operations</h2><span id='topic+op_vars'></span>

<h3>Description</h3>

<p>Look up the applicable variables in scope for a given operation
based on the data source and preceding sequence of operations
</p>


<h3>Usage</h3>

<pre><code class='language-R'>op_vars(op)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="op_vars_+3A_op">op</code></td>
<td>
<p>An operation instance</p>
</td></tr>
</table>

<hr>
<h2 id='partial_eval'>Partially evaluate an expression.</h2><span id='topic+partial_eval'></span>

<h3>Description</h3>

<p>This function partially evaluates an expression, using information from
the tbl to determine whether names refer to local expressions
or remote variables. This simplifies translation because expressions
don't need to carry around their environment - all relevant information
is incorporated into the expression.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>partial_eval(call, vars = character(), env = caller_env())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="partial_eval_+3A_call">call</code></td>
<td>
<p>an unevaluated expression, as produced by <code><a href="base.html#topic+quote">quote()</a></code></p>
</td></tr>
<tr><td><code id="partial_eval_+3A_vars">vars</code></td>
<td>
<p>character vector of variable names.</p>
</td></tr>
<tr><td><code id="partial_eval_+3A_env">env</code></td>
<td>
<p>environment in which to search for local values</p>
</td></tr>
</table>


<h3>Symbol substitution</h3>

<p><code>partial_eval()</code> needs to guess if you're referring to a variable on the
server (remote), or in the current environment (local).
</p>
<p>You can override the guesses using <code>local()</code> and <code>remote()</code> to force
computation, or by using the <code>.data</code> and <code>.env</code> pronouns of tidy evaluation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>vars &lt;- c("year", "id")
partial_eval(quote(year &gt; 1980), vars = vars)

ids &lt;- c("ansonca01", "forceda01", "mathebo01")
partial_eval(quote(id %in% ids), vars = vars)

# cf.
partial_eval(quote(id == .data$ids), vars = vars)

# You can use local() or .env to disambiguate between local and remote
# variables: otherwise remote is always preferred
year &lt;- 1980
partial_eval(quote(year &gt; year), vars = vars)
partial_eval(quote(year &gt; local(year)), vars = vars)
partial_eval(quote(year &gt; .env$year), vars = vars)

# Functions are always assumed to be remote. Use local to force evaluation
# in R.
f &lt;- function(x) x + 1
partial_eval(quote(year &gt; f(1980)), vars = vars)
partial_eval(quote(year &gt; local(f(1980))), vars = vars)
</code></pre>

<hr>
<h2 id='reexports'>Objects exported from other packages</h2><span id='topic+reexports'></span><span id='topic+filter'></span><span id='topic+intersect'></span><span id='topic+setdiff'></span><span id='topic+setequal'></span><span id='topic+union'></span>

<h3>Description</h3>

<p>These objects are imported from other packages. Follow the links
below to see their documentation.
</p>

<dl>
<dt>dplyr</dt><dd><p><code><a href="dplyr.html#topic+filter">filter</a></code>, <code><a href="dplyr.html#topic+setops">intersect</a></code>, <code><a href="dplyr.html#topic+setops">setdiff</a></code>, <code><a href="dplyr.html#topic+setops">setequal</a></code>, <code><a href="dplyr.html#topic+setops">union</a></code></p>
</dd>
</dl>

<hr>
<h2 id='run_query'>Run a query or command against a Kusto database</h2><span id='topic+run_query'></span>

<h3>Description</h3>

<p>Run a query or command against a Kusto database
</p>


<h3>Usage</h3>

<pre><code class='language-R'>run_query(database, qry_cmd, ..., .http_status_handler = "stop")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="run_query_+3A_database">database</code></td>
<td>
<p>A Kusto database endpoint object, as returned by <code>kusto_database_endpoint</code>.</p>
</td></tr>
<tr><td><code id="run_query_+3A_qry_cmd">qry_cmd</code></td>
<td>
<p>A string containing the query or command. In KQL, a database management command is a statement that starts with a &quot;.&quot;</p>
</td></tr>
<tr><td><code id="run_query_+3A_...">...</code></td>
<td>
<p>Named arguments to be used as parameters for a parameterized query. These are ignored for database management commands.</p>
</td></tr>
<tr><td><code id="run_query_+3A_.http_status_handler">.http_status_handler</code></td>
<td>
<p>The function to use to handle HTTP status codes. The default &quot;stop&quot; will throw an R error via <code>httr::stop_for_status</code> if the status code is not less than 300; other possibilities are &quot;warn&quot;, &quot;message&quot; and &quot;pass&quot;. The last option will pass through the raw response object from the server unchanged, regardless of the status code. This is mostly useful for debugging purposes, or if you want to see what the Kusto REST API does.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is the workhorse of the AzureKusto package. It communicates with the Kusto server and returns the query or command results, as data frames.
</p>


<h3>See Also</h3>

<p><a href="#topic+kusto_database_endpoint">kusto_database_endpoint</a>, <a href="#topic+ingest_local">ingest_local</a>, <a href="#topic+ingest_url">ingest_url</a>, <a href="#topic+ingest_blob">ingest_blob</a>, <a href="#topic+ingest_adls2">ingest_adls2</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

endp &lt;- kusto_database_endpoint(server="myclust.australiaeast.kusto.windows.net", database="db1")

# a command
run_query(endp, ".show table iris")

# a query
run_query(endp, "iris | count")


## End(Not run)
</code></pre>

<hr>
<h2 id='show_query.tbl_kusto_abstract'>Translate a sequence of dplyr operations on a tbl into a Kusto query string.</h2><span id='topic+show_query.tbl_kusto_abstract'></span>

<h3>Description</h3>

<p>Translate a sequence of dplyr operations on a tbl into a Kusto query string.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'tbl_kusto_abstract'
show_query(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="show_query.tbl_kusto_abstract_+3A_x">x</code></td>
<td>
<p>A tbl_kusto or tbl_kusto_abstract instance</p>
</td></tr>
<tr><td><code id="show_query.tbl_kusto_abstract_+3A_...">...</code></td>
<td>
<p>needed for agreement with generic. Not otherwise used.</p>
</td></tr>
</table>

<hr>
<h2 id='summarise.tbl_kusto_abstract'>Summarise method for Kusto tables</h2><span id='topic+summarise.tbl_kusto_abstract'></span>

<h3>Description</h3>

<p>This method is the same as other summarise methods, with the exception of the <code>.strategy</code>, <code>.shufflekeys</code> and <code>.num_partitions</code> optional arguments. They provide hints to the Kusto engine on how to execute the summarisation, and can sometimes be useful to speed up a query. See the Kusto documentation for more details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'tbl_kusto_abstract'
summarise(
  .data,
  ...,
  .strategy = NULL,
  .shufflekeys = NULL,
  .num_partitions = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summarise.tbl_kusto_abstract_+3A_.data">.data</code></td>
<td>
<p>A Kusto tbl.</p>
</td></tr>
<tr><td><code id="summarise.tbl_kusto_abstract_+3A_...">...</code></td>
<td>
<p>Summarise expressions.</p>
</td></tr>
<tr><td><code id="summarise.tbl_kusto_abstract_+3A_.strategy">.strategy</code></td>
<td>
<p>A summarise strategy to pass to Kusto. Currently the only value supported is &quot;shuffle&quot;.</p>
</td></tr>
<tr><td><code id="summarise.tbl_kusto_abstract_+3A_.shufflekeys">.shufflekeys</code></td>
<td>
<p>A character vector of column names to use as shuffle keys.</p>
</td></tr>
<tr><td><code id="summarise.tbl_kusto_abstract_+3A_.num_partitions">.num_partitions</code></td>
<td>
<p>The number of partitions for a shuffle query.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><a href="dplyr.html#topic+summarise">dplyr::summarise</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

tbl1 &lt;- tbl_kusto(db, "table1")

## standard dplyr syntax:
summarise(tbl1, mx = mean(x))

## Kusto extensions:
summarise(tbl1, mx = mean(x), .strategy = "broadcast") # a broadcast summarise

summarise(tbl1, mx = mean(x), .shufflekeys = c("var1", "var2")) # a shuffle summarise with keys

summarise(tbl1, mx = mean(x), .num_partitions = 5) # no. of partitions for a shuffle summarise

## End(Not run)

</code></pre>

<hr>
<h2 id='tbl_kusto'>A tbl object representing a table in a Kusto database.</h2><span id='topic+tbl_kusto'></span>

<h3>Description</h3>

<p>A tbl object representing a table in a Kusto database.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tbl_kusto(kusto_database, table_name, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tbl_kusto_+3A_kusto_database">kusto_database</code></td>
<td>
<p>An instance of kusto_database_endpoint that this table should be queried from</p>
</td></tr>
<tr><td><code id="tbl_kusto_+3A_table_name">table_name</code></td>
<td>
<p>The name of the table in the Kusto database</p>
</td></tr>
<tr><td><code id="tbl_kusto_+3A_...">...</code></td>
<td>
<p>parameters to pass in case the Kusto source table is a parameterized function.</p>
</td></tr>
</table>

<hr>
<h2 id='tbl_kusto_abstract'>Create a local lazy tbl</h2><span id='topic+tbl_kusto_abstract'></span>

<h3>Description</h3>

<p>Useful for testing KQL generation without a remote connection.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tbl_kusto_abstract(df, table_name, ...)
</code></pre>


<h3>Examples</h3>

<pre><code class='language-R'>library(dplyr)
df &lt;- data.frame(x = 1, y = 2)

df &lt;- tbl_kusto_abstract(df, "table1")
df %&gt;%
    summarise(x = sd(x)) %&gt;%
    show_query()
</code></pre>

<hr>
<h2 id='translate_kql'>Translate R expressions into Kusto Query Language equivalents.</h2><span id='topic+translate_kql'></span>

<h3>Description</h3>

<p>Translate R expressions into Kusto Query Language equivalents.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>translate_kql(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="translate_kql_+3A_...">...</code></td>
<td>
<p>Expressions to translate.</p>
</td></tr>
</table>

<hr>
<h2 id='unnest.tbl_kusto_abstract'>Unnest method for Kusto tables</h2><span id='topic+unnest.tbl_kusto_abstract'></span>

<h3>Description</h3>

<p>This method takes a list column and expands it so that each element of the list gets its own row.
unnest() translates to Kusto's mv-expand operator.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'tbl_kusto_abstract'
unnest(
  data,
  cols,
  ...,
  keep_empty = FALSE,
  ptype = NULL,
  names_sep = NULL,
  names_repair = NULL,
  .drop = NULL,
  .id = NULL,
  .sep = NULL,
  .preserve = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="unnest.tbl_kusto_abstract_+3A_data">data</code></td>
<td>
<p>A Kusto tbl.</p>
</td></tr>
<tr><td><code id="unnest.tbl_kusto_abstract_+3A_cols">cols</code></td>
<td>
<p>Specification of columns to unnest.</p>
</td></tr>
<tr><td><code id="unnest.tbl_kusto_abstract_+3A_...">...</code></td>
<td>
<p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt='[Deprecated]' /></a>:
previously you could write <code>df %&gt;% unnest(x, y, z)</code>.
Convert to <code>df %&gt;% unnest(c(x, y, z))</code>. If you previously created a new
variable in <code>unnest()</code> you'll now need to do it explicitly with <code>mutate()</code>.
Convert <code>df %&gt;% unnest(y = fun(x, y, z))</code>
to <code>df %&gt;% mutate(y = fun(x, y, z)) %&gt;% unnest(y)</code>.</p>
</td></tr>
<tr><td><code id="unnest.tbl_kusto_abstract_+3A_keep_empty">keep_empty</code></td>
<td>
<p>Needed for agreement with generic. Not otherwise used. Kusto does not keep empty rows.</p>
</td></tr>
<tr><td><code id="unnest.tbl_kusto_abstract_+3A_ptype">ptype</code></td>
<td>
<p>Needed for agreement with generic. Not otherwise used.</p>
</td></tr>
<tr><td><code id="unnest.tbl_kusto_abstract_+3A_names_sep">names_sep</code></td>
<td>
<p>Needed for agreement with generic. Not otherwise used.</p>
</td></tr>
<tr><td><code id="unnest.tbl_kusto_abstract_+3A_names_repair">names_repair</code></td>
<td>
<p>Needed for agreement with generic. Not otherwise used.</p>
</td></tr>
<tr><td><code id="unnest.tbl_kusto_abstract_+3A_.drop">.drop</code></td>
<td>
<p>Needed for agreement with generic. Not otherwise used.</p>
</td></tr>
<tr><td><code id="unnest.tbl_kusto_abstract_+3A_.id">.id</code></td>
<td>
<p>Data frame identifier - if supplied, will create a new column with name .id, giving a unique identifier. This is most useful if the list column is named.</p>
</td></tr>
<tr><td><code id="unnest.tbl_kusto_abstract_+3A_.sep">.sep</code></td>
<td>
<p>Needed for agreement with generic. Not otherwise used.</p>
</td></tr>
<tr><td><code id="unnest.tbl_kusto_abstract_+3A_.preserve">.preserve</code></td>
<td>
<p>Needed for agreement with generic. Not otherwise used.</p>
</td></tr>
</table>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
