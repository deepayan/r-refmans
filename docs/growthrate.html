<!DOCTYPE html><html><head><title>Help for package growthrate</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {growthrate}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#growthrate-package'>
<p>Recovery of gradients from sparsely observed functional data</p></a></li>
<li><a href='#cv.growth'>
<p>cross validation error</p></a></li>
<li><a href='#diffquo'>
<p>converts height data into difference quotients</p></a></li>
<li><a href='#growth'><p>recovery of growth velocities</p></a></li>
<li><a href='#height_data'>
<p>height data</p></a></li>
<li><a href='#Khatf'>
<p>posterior covariance kernel</p></a></li>
<li><a href='#new.growth'>
<p>recovery of growth velocity for a new subject</p></a></li>
<li><a href='#posteriordistribcurve'>
<p>posterior mean</p></a></li>
<li><a href='#posteriorobs'>
<p>posterior mean and covariance at observation times</p></a></li>
<li><a href='#priormeanobs'>
<p>prior mean</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Version:</td>
<td>1.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2014-08-13</td>
</tr>
<tr>
<td>Title:</td>
<td>Bayesian reconstruction of growth velocity</td>
</tr>
<tr>
<td>Author:</td>
<td>Sara Lopez-Pintado and Ian W. McKeague</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Ian W. McKeague &lt;im2131@columbia.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>A nonparametric empirical Bayes method for recovering
        gradients (or growth velocities) from observations of smooth
        functions (e.g., growth curves) at isolated time points.</td>
</tr>
<tr>
<td>Depends:</td>
<td>Matrix, clime, mvtnorm</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> | file LICENSE</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2014-08-13 16:43:59 UTC; iwm</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2014-08-13 18:59:22</td>
</tr>
</table>
<hr>
<h2 id='growthrate-package'>
Recovery of gradients from sparsely observed functional data
</h2><span id='topic+growthrate-package'></span>

<h3>Description</h3>

<p>A nonparametric empirical Bayes method for recovering gradients (or growth velocities) from observations of smooth functions (e.g., growth curves) at isolated time points.
</p>


<h3>References</h3>

<p>Lopez-Pintado, S. and McKeague, I. W. (2013).
<em>Recovering gradients from sparsely observed functional
data.</em> Biometrics 69, 396-404 (2013).
http://www.columbia.edu/~im2131/ps/growthrate-package-reference.pdf
</p>

<hr>
<h2 id='cv.growth'>
cross validation error 
</h2><span id='topic+cv.growth'></span>

<h3>Description</h3>

<p>Computes the cross validation error resulting from the removal of the data at a given interior observation time as a function of the infinitessimal standard deviation <code>sigma</code> on a grid of <code>k</code> equispaced values in the interval [<code>a</code>, <code>b</code>].
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	cv.growth(data, tobs, d, K, a, b, r) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cv.growth_+3A_data">data</code></td>
<td>

<p>Input matrix of size N (subjects) times n (observation times). Each column  contains the heights (of all subjects) at a given observation time, each row contains the heights (at the observation times) for a given subject.
</p>
</td></tr>
<tr><td><code id="cv.growth_+3A_tobs">tobs</code></td>
<td>

<p>Row vector of n observation times (in increasing order, same for each subject).
</p>
</td></tr>
<tr><td><code id="cv.growth_+3A_d">d</code></td>
<td>

<p>Number of points on the fine time-grid (between the first and last observation times in <code>tobs</code>) at which the posterior means and covariances are computed.
</p>
</td></tr>
<tr><td><code id="cv.growth_+3A_k">K</code></td>
<td>

<p>Number of points on the grid for <code>sigma</code>.
</p>
</td></tr>
<tr><td><code id="cv.growth_+3A_a">a</code></td>
<td>

<p>Minimum value for <code>sigma</code> (positive).
</p>
</td></tr>
<tr><td><code id="cv.growth_+3A_b">b</code></td>
<td>

<p>Maximum value for <code>sigma</code> (strictly larger than <code>a</code>).
</p>
</td></tr>
<tr><td><code id="cv.growth_+3A_r">r</code></td>
<td>

<p>Index of the interior observation time in <code>tobs</code> removed in the cross-validation.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The data for the <code>r</code>th observation time (for a given <code class="reqn">1 &lt;</code> <code>r</code> <code class="reqn">&lt; n</code>) are removed and the mean squared error of the reconstructed data at that time point computed over the grid for <code>sigma</code>.  
</p>


<h3>Value</h3>

<table>
<tr><td><code>sigmavec</code></td>
<td>

<p><code>K</code>-vector of <code>sigma</code>-values considered in the cross validation.
</p>
</td></tr>
<tr><td><code>CVer</code></td>
<td>

<p>Cross validation error at each value of <code>sigma</code> in <code>sigmavec</code>.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sara Lopez-Pintado and Ian W. McKeague
</p>
<p>Maintainer:  Ian W. McKeague &lt;im2131@columbia.edu&gt;
</p>


<h3>References</h3>

<p>Lopez-Pintado, S. and McKeague, I. W. (2013).
<em>Recovering gradients from sparsely observed functional
data.</em> Biometrics 69, 396-404 (2013).
http://www.columbia.edu/~im2131/ps/growthrate-package-reference.pdf
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
    ## example using the height data provided in the package
    ## there are 7 observation times (age in years):
    ## WARNING: cv.growth is time-consuming. This example uses only part of the data.
    data(height_data);
    ht = height_data[1:100,];
    tobs=c(0,1/3,2/3,1,3,4,7);
    cvg=cv.growth(ht, tobs, 100, 21, 1, 5, 2);

    ## Plot of the cross validation error as a function of sigma:
    plot(cvg$sigmavec, cvg$CVer, xlab="Sigma", ylab="Cross validation error");

    ## Value of sigma that minimizes the cross validation error:
    sigmaopt=cvg$sigmavec[which(cvg$CVer==min(cvg$CVer))]; 	

## End(Not run)
</code></pre>

<hr>
<h2 id='diffquo'>
converts height data into difference quotients
</h2><span id='topic+diffquo'></span>

<h3>Description</h3>

<p>Internal function. Calculates the crude one-sided difference quotients and the second-order difference quotients based on the height data and the observed time points.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	diffquo(data, tobs) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="diffquo_+3A_data">data</code></td>
<td>

<p>As in <code>growth</code>.
</p>
</td></tr>
<tr><td><code id="diffquo_+3A_tobs">tobs</code></td>
<td>

<p>As in <code>growth</code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>YI</code></td>
<td>

<p>An N times (n-1) matrix with rows given by the values of the one-sided difference quotients <code class="reqn">y_i, i=1\ldots, n-1</code> for the N subjects.
</p>
</td></tr>
<tr><td><code>Xtilda</code></td>
<td>

<p>An n by N matrix with columns given by the values of the second-order difference quotients <b>y</b> for the N subjects.
</p>
</td></tr>
</table>

<hr>
<h2 id='growth'>recovery of growth velocities 
</h2><span id='topic+growth'></span>

<h3>Description</h3>

<p>Computes the mean function and covariance kernel (over a fine grid of equispaced time points) of the posterior growth velocity  for each subject, based on growth data (e.g., heights) at fixed observation times.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	growth(data, tobs, sigma, d)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="growth_+3A_data">data</code></td>
<td>

<p>Input matrix of size N (subjects) times n (observation times). Each column  contains the heights (of all subjects) at a given observation time, each row contains the heights (at the observation times) for a given subject.
</p>
</td></tr>
<tr><td><code id="growth_+3A_tobs">tobs</code></td>
<td>

<p>Row vector of n observation times (in increasing order, same for each subject).
</p>
</td></tr>
<tr><td><code id="growth_+3A_sigma">sigma</code></td>
<td>

<p>A positive scalar representing the infinitessimal standard deviation of the tied-down Brownian motion in the prior. Can be selected by cross-validation.
</p>
</td></tr>
<tr><td><code id="growth_+3A_d">d</code></td>
<td>

<p>Number of time points on the fine grid.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Bayesian reconstruction implemented here uses a prior growth velocity model that is specified by a general multivariate normal distribution at the n fixed observation times, and a tied-down Brownian motion (having  infinitessimal standard deviation specified by <code>sigma</code>) between the observation times.
</p>
<p>The prior mean and prior precision matrix at the observation times are estimated using the data on N subjects. Clime (constrained L1 minimization) provides the estimate of the prior precision matrix, with the clime constraint parameter lambda selected by 5-fold cross validation using the likelihood loss function.
</p>


<h3>Value</h3>

<table>
<tr><td><code>muhatcurve</code></td>
<td>

<p>Posterior means of the growth velocities (for each subject) on the fine grid <code>tgrid</code>.  An N (subjects) times <code>d</code> matrix.
</p>
</td></tr>
<tr><td><code>Khat</code></td>
<td>

<p>Posterior covariance kernel of the growth velocities on the fine grid <code>tgrid</code>. A <code>d</code> times <code>d</code> matrix (the same for every subject).
</p>
</td></tr>
<tr><td><code>tgrid</code></td>
<td>

<p>The fine grid of <code>d</code> equispaced-time points (between the first and last observation times in <code>tobs</code>) at which the posterior means and covariances are computed.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sara Lopez-Pintado and Ian W. McKeague
</p>
<p>Maintainer:  Ian W. McKeague &lt;im2131@columbia.edu&gt;
</p>


<h3>References</h3>

<p>Lopez-Pintado, S. and McKeague, I. W. (2013).
<em>Recovering gradients from sparsely observed functional
data.</em> Biometrics 69, 396-404 (2013).
http://www.columbia.edu/~im2131/ps/growthrate-package-reference.pdf
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## example using the height data provided in the package
## there are 7 observation times (age in years):
	data(height_data);
	tobs=c(0,1/3,2/3,1,3,4,7);
	d=200;
	sigma=1;
	g=growth(height_data,tobs,sigma,d);

## Plot of the posterior mean and credible interval for a specific individual
	indiv=1;
## posterior standard deviation (same for all subjects):
	postsd=sqrt(diag(g$Khat));
	plot(g$tgrid,g$muhatcurve[indiv,],type='l',
			xlab="Age (years)",ylab="Growth velocity (cms/year)");
	lines(g$tgrid,g$muhatcurve[indiv,]);
	lines(g$tgrid,g$muhatcurve[indiv,]+2*postsd,lty=2);
	lines(g$tgrid,g$muhatcurve[indiv,]-2*postsd,lty=2);

## Plot of a draw from the posterior growth velocity for a specific individual:
	draw=rmvnorm(n=1, mean=g$muhatcurve[indiv,], sigma=g$Khat, method="chol");
	plot(g$tgrid,draw,type='l',xlab="Age (years)",ylab="Growth
	velocity (cms/year)");

## End(Not run)
</code></pre>

<hr>
<h2 id='height_data'>
height data 
</h2><span id='topic+height_data'></span>

<h3>Description</h3>

<p>The heights of 532 girls at birth, four, eight, and twelve months, and three, four, and seven years of age.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	data(height_data)
</code></pre>


<h3>Format</h3>

<p>A matrix with 532 observations on 7 variables (height at each age).
</p>


<h3>References</h3>

<p>Lopez-Pintado, S. and McKeague, I. W. (2013).
<em>Recovering gradients from sparsely observed functional
data.</em> Biometrics 69, 396-404 (2013).
http://www.columbia.edu/~im2131/ps/growthrate-package-reference.pdf
</p>


<h3>Examples</h3>

<pre><code class='language-R'>	data(height_data)
</code></pre>

<hr>
<h2 id='Khatf'>
posterior covariance kernel
</h2><span id='topic+Khatf'></span>

<h3>Description</h3>

<p>Internal function. Finds the posterior covariance kernel on the fine grid <code>tgrid</code> (same for every subject); see Section 2 of the referenced article for further details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	Khatf(tgrid, tobs, sigma, Sigmahat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Khatf_+3A_tgrid">tgrid</code></td>
<td>

<p>The fine grid of <code>d</code> equispaced-time points (between the first and last observation times in <code>tobs</code>) at which the posterior means and covariances are computed.
</p>
</td></tr>
<tr><td><code id="Khatf_+3A_tobs">tobs</code></td>
<td>

<p>Row vector of n observation times (in increasing order, same for each subject).
</p>
</td></tr>
<tr><td><code id="Khatf_+3A_sigma">sigma</code></td>
<td>

<p>Infinitessimal standard deviation of the tied-down Brownian motion in the prior.
</p>
</td></tr>
<tr><td><code id="Khatf_+3A_sigmahat">Sigmahat</code></td>
<td>

<p>Posterior covariance at the observation times <code>tobs</code> (same for every subject).
</p>
</td></tr>
</table>

<hr>
<h2 id='new.growth'>
recovery of growth velocity for a new subject
</h2><span id='topic+new.growth'></span>

<h3>Description</h3>

<p>Computes the posterior mean and covariance kernel for a new subject having data at observation times <code>newtobs</code> different from <code>tobs</code> (apart from the first and the last). <code>growth</code> needs to be run first.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	new.growth(newdata, newtobs, sigma, d, muhatcurve, Khat, tgrid) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="new.growth_+3A_newdata">newdata</code></td>
<td>

<p>Row vector of p heights for the new subject.
</p>
</td></tr>
<tr><td><code id="new.growth_+3A_newtobs">newtobs</code></td>
<td>

<p>Row vector of p observation times for the new subject (in increasing order; must include the first and last time points in <code>tobs</code>).
</p>
</td></tr>
<tr><td><code id="new.growth_+3A_sigma">sigma</code></td>
<td>

<p>Infinitessimal standard deviation of the Brownian motion prior (same as in <code>growth</code>).
</p>
</td></tr>
<tr><td><code id="new.growth_+3A_d">d</code></td>
<td>

<p>Number of time points on the fine grid.
</p>
</td></tr>
<tr><td><code id="new.growth_+3A_muhatcurve">muhatcurve</code></td>
<td>

<p>Output from <code>growth</code>.
</p>
</td></tr>
<tr><td><code id="new.growth_+3A_khat">Khat</code></td>
<td>

<p>Output from <code>growth</code>.
</p>
</td></tr>
<tr><td><code id="new.growth_+3A_tgrid">tgrid</code></td>
<td>

<p>The fine grid (output from <code>growth</code>).
</p>
</td></tr>	
</table>


<h3>Value</h3>

<table>
<tr><td><code>muhatcurvenew</code></td>
<td>

<p>Posterior mean (on  <code>tgrid</code>) for the new subject. 
</p>
</td></tr>
<tr><td><code>Khatnew</code></td>
<td>

<p>Posterior covariance kernel (on <code>tgrid</code>) for the new subject.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sara Lopez-Pintado and Ian W. McKeague
</p>
<p>Maintainer:  Ian W. McKeague &lt;im2131@columbia.edu&gt;
</p>


<h3>References</h3>

<p>Lopez-Pintado, S. and McKeague, I. W. (2013).
<em>Recovering gradients from sparsely observed functional
data.</em> Biometrics 69, 396-404 (2013).
http://www.columbia.edu/~im2131/ps/growthrate-package-reference.pdf
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## example using the height data provided in the package 
##    (after first running growth to obtain the output g):
## suppose a new subject has 5 observation times (including 0 and 7)
	data(height_data);
	tobs=c(0,1/3,2/3,1,3,4,7);
	d=200;
	sigma=1;
	g=growth(height_data,tobs,sigma,d);

	newtobs=c(0, 2, 3, 5, 7);
	newdata=t(as.vector(c(50,70,87,100,115)));
	ng=new.growth(newdata,newtobs,sigma,d,g$muhatcurve,g$Khat,g$tgrid);

## plot of the posterior mean growth velocity for the new subject:
	plot(g$tgrid,ng$muhatcurvenew,xlab="Age (years)",ylab="Growth
	velocity (cms/year)");

## End(Not run)
</code></pre>

<hr>
<h2 id='posteriordistribcurve'>
posterior mean
</h2><span id='topic+posteriordistribcurve'></span>

<h3>Description</h3>

<p>Internal function. Finds the posterior mean on the fine grid  <code>tgrid</code> for every subject.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	posteriordistribcurve(muhatmatrix, Sigmahat, sigma, tobs, d, YI)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="posteriordistribcurve_+3A_muhatmatrix">muhatmatrix</code></td>
<td>

<p>Posterior mean at the observation times <code>tobs</code> obtained from <code>posteriorobs</code>.
</p>
</td></tr>
<tr><td><code id="posteriordistribcurve_+3A_sigmahat">Sigmahat</code></td>
<td>

<p>Posterior covariance at the observation times <code>tobs</code> obtained from <code>posteriorobs</code>.
</p>
</td></tr>
<tr><td><code id="posteriordistribcurve_+3A_sigma">sigma</code></td>
<td>

<p>Infinitessimal standard deviation of the tied-down Brownian motion in the prior.
</p>
</td></tr>
<tr><td><code id="posteriordistribcurve_+3A_tobs">tobs</code></td>
<td>

<p>Row vector of n observation times (in increasing order, same for each subject).
</p>
</td></tr>
<tr><td><code id="posteriordistribcurve_+3A_d">d</code></td>
<td>

<p>Number of time points on the fine grid.
</p>
</td></tr>
<tr><td><code id="posteriordistribcurve_+3A_yi">YI</code></td>
<td>

<p>An N times (n-1) matrix with rows given by the values of <code class="reqn">y_i, i=1\ldots, n-1</code> for the N subjects.
</p>
</td></tr>
</table>

<hr>
<h2 id='posteriorobs'>
posterior mean and covariance at observation times
</h2><span id='topic+posteriorobs'></span>

<h3>Description</h3>

<p>Internal function. Finds the posterior mean and covariance at the observation times <code>tobs</code>, for every subject; see Section 2 of the referenced article for further details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	posteriorobs(Sigma0inv, sigma, muprior, Xtilda, tobs, YI)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="posteriorobs_+3A_sigma0inv">Sigma0inv</code></td>
<td>

<p>Prior precision matrix at the observation times <code>tobs</code>.
</p>
</td></tr>
<tr><td><code id="posteriorobs_+3A_sigma">sigma</code></td>
<td>

<p>Infinitessimal standard deviation of the tied-down Brownian motion in the prior. 
</p>
</td></tr>
<tr><td><code id="posteriorobs_+3A_muprior">muprior</code></td>
<td>

<p>Prior mean at the observation times <code>tobs</code>.
</p>
</td></tr>
<tr><td><code id="posteriorobs_+3A_xtilda">Xtilda</code></td>
<td>

<p>An n by N matrix with columns given by the values of <b>y</b> for the N subjects.
</p>
</td></tr>
<tr><td><code id="posteriorobs_+3A_tobs">tobs</code></td>
<td>

<p>Row vector of n observation times (in increasing order, same for each subject).
</p>
</td></tr>
<tr><td><code id="posteriorobs_+3A_yi">YI</code></td>
<td>

<p>An N times (n-1) matrix with rows given by the values of <code class="reqn">y_i, i=1\ldots, n-1</code> for the N subjects.
</p>
</td></tr>
</table>

<hr>
<h2 id='priormeanobs'>
prior mean
</h2><span id='topic+priormeanobs'></span>

<h3>Description</h3>

<p>Internal function. Finds the sample mean of the n-vector <b>y</b> for use in specifying the prior mean <code class="reqn">{\boldsymbol\mu}_0</code>; see Section 2 of the referenced article for further details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	priormeanobs(YI, tobs)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="priormeanobs_+3A_yi">YI</code></td>
<td>

<p>The N times (n-1) matrix with rows being the values of <code class="reqn">y_i, i=1\ldots, n-1</code> for the N subjects
</p>
</td></tr>
<tr><td><code id="priormeanobs_+3A_tobs">tobs</code></td>
<td>

<p>Row vector of n observation times (in increasing order, same for each subject).
</p>
</td></tr>
</table>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
