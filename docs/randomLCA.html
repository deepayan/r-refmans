<!DOCTYPE html><html><head><title>Help for package randomLCA</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {randomLCA}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#AIC'><p>AIC for randomLCA object</p></a></li>
<li><a href='#AIC3'><p>AIC with 3 penalty for randomLCA object</p></a></li>
<li><a href='#BIC'><p>BIC for randomLCA object</p></a></li>
<li><a href='#calcCond2Prob'><p>Calculate Conditional Outcome Probabilities for 2 Level Models</p></a></li>
<li><a href='#calcCondProb'><p>Calculate Conditional Outcome Probabilities</p></a></li>
<li><a href='#calcMargProb'><p>Calculates Marginal Outcome Probabilities</p></a></li>
<li><a href='#classProbs'>
<p>Determines class probabilities for fitted model</p></a></li>
<li><a href='#dentistry'><p>Dental X-ray data</p></a></li>
<li><a href='#fitted'><p>fitted values</p></a></li>
<li><a href='#genderrole'><p>Gender Role Opinion Items</p></a></li>
<li><a href='#hivtests'><p>HIV testing data</p></a></li>
<li><a href='#logLik'><p>log Likelikelihood for randomLCA object</p></a></li>
<li><a href='#maxPostClass'>
<p>Determines class with maximum posterior class probability for each observation</p></a></li>
<li><a href='#myocardial'><p>Myocardial Infarction (MI)</p></a></li>
<li><a href='#outcomeProbs'><p>Extract outcome probabilities for randomLCA object</p></a></li>
<li><a href='#pap'><p>Positive Action program implementation</p></a></li>
<li><a href='#plot'><p>Plot a randomLCA object</p></a></li>
<li><a href='#postClassProbs'>
<p>Determines posterior class probabilities for fitted model</p></a></li>
<li><a href='#print.randomLCA'><p>print for randomLCA object</p></a></li>
<li><a href='#randomLCA'><p>Fits a Latent Class Model including a Random Effect</p></a></li>
<li><a href='#ranef'><p>Extract random effects from a randomLCA object</p></a></li>
<li><a href='#refit'><p>Refit an randomLCA object</p></a></li>
<li><a href='#simulate'><p>Simulate</p></a></li>
<li><a href='#summary.randomLCA'><p>Summary for randomLCA object</p></a></li>
<li><a href='#symptoms'><p>Symptoms data</p></a></li>
<li><a href='#uterinecarcinoma'><p>Uterine Carcinoma Data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Random Effects Latent Class Analysis</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1-3</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-06-20</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Ken Beath &lt;ken@kjbeath.com.au&gt;</td>
</tr>
<tr>
<td>Contact:</td>
<td>Ken Beath &lt;ken@kjbeath.com.au&gt;</td>
</tr>
<tr>
<td>Author:</td>
<td>Ken Beath [aut, cre]</td>
</tr>
<tr>
<td>Description:</td>
<td>Fits standard and random effects latent class models. The single level random effects model is described in Qu et al &lt;<a href="https://doi.org/10.2307%2F2533043">doi:10.2307/2533043</a>&gt; and the two level random effects model in Beath and Heller &lt;<a href="https://doi.org/10.1177%2F1471082X0800900302">doi:10.1177/1471082X0800900302</a>&gt;. Examples are given for their use in diagnostic testing.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R(&ge; 3.2.0), lattice</td>
</tr>
<tr>
<td>Suggests:</td>
<td>R.rsp</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>R.rsp</td>
</tr>
<tr>
<td>Imports:</td>
<td>boot, fastGHQuad, Matrix, Rfast, parallel, doParallel, doRNG,
foreach</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-06-22 09:25:46 UTC; kjbeath1</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-06-22 13:22:35 UTC</td>
</tr>
</table>
<hr>
<h2 id='AIC'>AIC for randomLCA object</h2><span id='topic+AIC.randomLCA'></span>

<h3>Description</h3>

<p>Returns AIC for a randomLCA object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'randomLCA'
AIC(object, ..., k = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="AIC_+3A_object">object</code></td>
<td>
<p>randomLCA object</p>
</td></tr>
<tr><td><code id="AIC_+3A_...">...</code></td>
<td>
<p> additional argument; currently none is used. </p>
</td></tr>
<tr><td><code id="AIC_+3A_k">k</code></td>
<td>
<p>penalty per parameter</p>
</td></tr>
</table>


<h3>Value</h3>

<p>AIC
</p>


<h3>Author(s)</h3>

<p>Ken Beath</p>


<h3>Examples</h3>

<pre><code class='language-R'>
pap.lca2 &lt;- randomLCA(pap[, 1:10], freq = pap$Freq, nclass = 2, cores = 1)
print(AIC(pap.lca2))

</code></pre>

<hr>
<h2 id='AIC3'>AIC with 3 penalty for randomLCA object</h2><span id='topic+AIC3'></span>

<h3>Description</h3>

<p>Returns AIC with penalty 3 for a randomLCA object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AIC3(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="AIC3_+3A_object">object</code></td>
<td>
<p>randomLCA object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>AIC3.
</p>


<h3>Author(s)</h3>

<p>Ken Beath</p>


<h3>Examples</h3>

<pre><code class='language-R'>
pap.lca2 &lt;- randomLCA(pap[, 1:10], freq = pap$Freq, nclass = 2, cores = 1)
print(AIC3(pap.lca2))

</code></pre>

<hr>
<h2 id='BIC'>BIC for randomLCA object</h2><span id='topic+BIC.randomLCA'></span>

<h3>Description</h3>

<p>Returns BIC for a randomLCA object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'randomLCA'
BIC(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BIC_+3A_object">object</code></td>
<td>
<p>randomLCA object</p>
</td></tr>
<tr><td><code id="BIC_+3A_...">...</code></td>
<td>
<p> additional argument; currently none is used. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>BIC
</p>


<h3>Author(s)</h3>

<p>Ken Beath</p>


<h3>Examples</h3>

<pre><code class='language-R'>
pap.lca2 &lt;- randomLCA(pap[, 1:10], freq = pap$Freq, nclass = 2, cores = 1)
print(BIC(pap.lca2))

</code></pre>

<hr>
<h2 id='calcCond2Prob'>Calculate Conditional Outcome Probabilities for 2 Level Models</h2><span id='topic+calcCond2Prob'></span>

<h3>Description</h3>

<p>The conditional probabilities are obtained integrating over the period random effect.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calcCond2Prob(object, conditionalp = 0.5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calcCond2Prob_+3A_object">object</code></td>
<td>
<p>RandomLCA object</p>
</td></tr>
<tr><td><code id="calcCond2Prob_+3A_conditionalp">conditionalp</code></td>
<td>
<p>the percentiles for the random effect</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a data frame containing class, block, outcome, outcomep (outcome probability) and perc (percentiles of the random effect) if conditionalp is specified.  For example a conditionalp of 0.5 is the 50th percentile or the median corresponding to a random effect of zero. 0.025 and 0.975 correspond to the 2.5th and 97.5th percential, so the region between them if 95% of the variation in the data.
</p>


<h3>Author(s)</h3>

<p>Ken Beath <a href="mailto:kenbeath@mq.edu.au">kenbeath@mq.edu.au</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
symptoms.lca2random2 &lt;- randomLCA(symptoms[, 1:16], freq = symptoms$Freq, 
	random = TRUE, level2 = TRUE, nclass = 2, level2size = 4, constload = FALSE, cores = 1)
print(calcCond2Prob(symptoms.lca2random2))

</code></pre>

<hr>
<h2 id='calcCondProb'>Calculate Conditional Outcome Probabilities </h2><span id='topic+calcCondProb'></span>

<h3>Description</h3>

<p>Calculates the conditional outcome probabilities for random effects models or for standard latent class returns the outcome probabilities. For random effects, the outcome probabilities may be calculated for various percentiles of the random effect.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calcCondProb(object, conditionalp = 0.5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calcCondProb_+3A_object">object</code></td>
<td>
<p>RandomLCA object</p>
</td></tr>
<tr><td><code id="calcCondProb_+3A_conditionalp">conditionalp</code></td>
<td>
<p>the percentiles for the random effect</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a data frame containing class, block, outcome, outcomep (outcome probability) and perc (percentiles of the random effect) if conditionalp is specified. For example a conditionalp of 0.5 is the 50th percentile or the median corresponding to a random effect of zero. 0.025 and 0.975 correspond to the 2.5th and 97.5th percential, so the region between them if 95% of the variation in the data.
</p>


<h3>Author(s)</h3>

<p>Ken Beath <a href="mailto:ken.beath@mq.edu.au">ken.beath@mq.edu.au</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
dentistry.lcarandom &lt;- randomLCA(dentistry[, 1:5], freq = dentistry$freq, 
	random = TRUE, probit = TRUE, cores = 1)
print(calcCondProb(dentistry.lcarandom))

</code></pre>

<hr>
<h2 id='calcMargProb'>Calculates Marginal Outcome Probabilities</h2><span id='topic+calcMargProb'></span>

<h3>Description</h3>

<p>Calculates the marginal outcome probabilities for a random effects latent class model, by integrating the outcome probability over the random effect. This is performed using Gauss-Hermite quadrature with the number of quadrature points specified for the model fitting.</p>


<h3>Usage</h3>

<pre><code class='language-R'>calcMargProb(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calcMargProb_+3A_object">object</code></td>
<td>
<p>randomLCA object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a data frame containing class, block, outcome, outcomep (outcome probability).
</p>


<h3>Author(s)</h3>

<p>Ken Beath</p>


<h3>Examples</h3>

<pre><code class='language-R'>
dentistry.lcarandom &lt;- randomLCA(dentistry[, 1:5], freq = dentistry$freq, 
	random = TRUE, probit = TRUE, cores = 1)
print(calcMargProb(dentistry.lcarandom))

</code></pre>

<hr>
<h2 id='classProbs'>
Determines class probabilities for fitted model
</h2><span id='topic+classProbs'></span>

<h3>Description</h3>

<p>The class probabililities for the model are returned.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>classProbs(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="classProbs_+3A_object">object</code></td>
<td>
<p>randomLCA object</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Simply extracts the corresponding variable from the randomLCA object.
</p>


<h3>Value</h3>

<p>A vector of class probabilities for each class.
</p>


<h3>Author(s)</h3>

<p>Ken Beath</p>


<h3>Examples</h3>

<pre><code class='language-R'>
pap.lca2 &lt;- randomLCA(pap[, 1:10], freq = pap$Freq, nclass = 2, cores = 1)
print(classProbs(pap.lca2))

</code></pre>

<hr>
<h2 id='dentistry'>Dental X-ray data</h2><span id='topic+dentistry'></span>

<h3>Description</h3>

<p>Six dentists evaluated dental x-rays for incipient caries in Handelman et al (1986), data consistss of 5 of the dentists analysed by Espeland and Handelman (1989) using a latent class model. Further analysis incorprating a random effects latent class model by Qu et al (1996), and by Albert and Dodd (2004)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dentistry</code></pre>


<h3>Format</h3>

<p>A data frame with 32 observations on the following 6 variables.
</p>

<dl>
<dt><code>V1</code></dt><dd><p>Dentist 1</p>
</dd>
<dt><code>V2</code></dt><dd><p>Dentist 2</p>
</dd>
<dt><code>V3</code></dt><dd><p>Dentist 3</p>
</dd>
<dt><code>V4</code></dt><dd><p>Dentist 4</p>
</dd>
<dt><code>V5</code></dt><dd><p>Dentist 5</p>
</dd>
<dt><code>freq</code></dt><dd><p>Number of subjects</p>
</dd>
</dl>



<h3>Source</h3>

<p>Espeland and Handelman (1989)
</p>


<h3>References</h3>

<p>Handelman, S.L., Leverett, D.H., Espeland, M.A. and Curzon, J.A. (1986) Clinical radiographic evaluation of sealed carious and sound tooth surfaces. <em>Journal of the American Dental Association</em>, <b>113</b>, 751&ndash;754.
</p>
<p>Espeland, M.A. and Handelman, S.L. (1989) Using latent class models to characterize and assess relative error in discrete distributions. <em>Biometrics</em>, <b>45</b>, 587&ndash;599.
</p>
<p>Qu, Y., Tan, M. and Kutner, M.H. (1996) Random effects models in latent class analysis for evaluating accuracy of diagnostic tests. <em>Biometrics</em>, <b>52</b>, 797&ndash;810.
</p>
<p>Albert P.S. and Dodd, L.E. (2004) A cautionary note on the robustness of Latent Class Models for estimating diagnostic error without a gold standard. <em>Biometrics</em>, <b>60</b>, 427&ndash;435.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# fit LCR model from Qu et al (1996)
dentistry.lca &lt;- randomLCA(dentistry[, 1:5], freq = dentistry$freq, cores = 1)
# start with constant laoding
dentistry.lcarandom &lt;- randomLCA(dentistry[, 1:5], freq = dentistry$freq, 
	random = TRUE, probit = TRUE, cores = 1)
# allow loading to vary by dentist
dentistry.lcarandomunequal &lt;- randomLCA(dentistry[, 1:5], freq = dentistry$freq, 
	random = TRUE, constload = FALSE, probit = TRUE, cores = 1)

</code></pre>

<hr>
<h2 id='fitted'>fitted values</h2><span id='topic+fitted.randomLCA'></span>

<h3>Description</h3>

<p>Extract fitted values for randomLCA object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'randomLCA'
fitted(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitted_+3A_object">object</code></td>
<td>
<p>randomLCA object</p>
</td></tr>
<tr><td><code id="fitted_+3A_...">...</code></td>
<td>
<p> additional argument; currently none is used. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame. The first columns of the data frame correspond to the patterns, followed by the frequency of each pattern, and then the fitted number for each pattern.
</p>


<h3>Author(s)</h3>

<p>Ken Beath <a href="mailto:ken.beath@mq.edu.au">ken.beath@mq.edu.au</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
dentistry.lcarandom &lt;- randomLCA(dentistry[, 1:5], freq = dentistry$freq, 
	random = TRUE, probit = TRUE, cores = 1)
print(fitted(dentistry.lcarandom))

</code></pre>

<hr>
<h2 id='genderrole'>Gender Role Opinion Items</h2><span id='topic+genderrole'></span>

<h3>Description</h3>

<p>Opinions collected on gender roles in a study by Felling et al (1987). This was originally published in Heinen (1996) and subsequently in  Galindo Garre and Vermunt (2006).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>genderrole</code></pre>


<h3>Format</h3>

<p>A data frame with 16 observations on the following 5 variables.
</p>

<dl>
<dt><code>Q1</code></dt><dd><p>Women's liberation sets women against men.</p>
</dd>
<dt><code>Q2</code></dt><dd><p>It's better for a wife not to have a job because that always poses problems in the household, especially if there are children.</p>
</dd>
<dt><code>Q3</code></dt><dd><p>The most natural situation occurs when the man is the breadwinner and the woman runs the household and takes care of the children.</p>
</dd>
<dt><code>Q4</code></dt><dd><p>It isn't really as important for a girl to get a good education as it is for a boy.</p>
</dd>
<dt><code>Q5</code></dt><dd><p>A woman is better suited to raise small children than a man.</p>
</dd>
<dt><code>Freq</code></dt><dd><p>Number of subjects</p>
</dd>
</dl>



<h3>Source</h3>

<p>Galindo Garre and Vermunt (2006)
</p>


<h3>References</h3>

<p>Felling, A., Peters, J., and Schreuder, O. (1987) Religion in Dutch society 85: Documentation of a national survey on religious and secular attitudes in 1985. Amsterdam: Steinmetz Archive.
</p>
<p>Galindo Garre, F. and Vermunt, J.K. (2006) Avoiding boundary estimates in latent class analysis by Bayesian posterior mode estimation. <em>Behaviormetrika</em>, <b>33</b>, 43&ndash;59.
</p>
<p>Heinen, T. (1996) Latent Class and Discrete Latent Trait Models: Similarities and Differences. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# standard latent class
genderrole.lca1 &lt;- randomLCA(genderrole[, 1:5], freq = genderrole$Freq, nclass = 1, cores = 1)
genderrole.lca2 &lt;- randomLCA(genderrole[, 1:5], freq = genderrole$Freq, cores = 1)
genderrole.lca3 &lt;- randomLCA(genderrole[, 1:5], freq = genderrole$Freq, nclass = 3, cores = 1)
# repeat with random effect with constant loading
# increase quadrature points and/or use higher penalty to obtain
# convergence
genderrole.lca1random &lt;- randomLCA(genderrole[, 1:5], freq = genderrole$Freq, 
	nclass = 1, random = TRUE, cores = 1)
genderrole.lca2random &lt;- randomLCA(genderrole[, 1:5], freq = genderrole$Freq, 
	random = TRUE, penalty = 0.1, quadpoints = 61, cores = 1)
genderrole.lca3random &lt;- randomLCA(genderrole[, 1:5], freq = genderrole$Freq, 
	nclass = 3, random = TRUE, penalty = 0.1, quadpoints = 61, cores = 1)
# improved BIC for 1 class random
print(c(BIC(genderrole.lca1), BIC(genderrole.lca2), BIC(genderrole.lca3)))
print(c(BIC(genderrole.lca1random), BIC(genderrole.lca2random), 
	BIC(genderrole.lca3random)))
# can also repeat fits without constant loading to give mixture of IRT models
genderrole.lca1random2 &lt;- randomLCA(genderrole[, 1:5], freq = genderrole$Freq, 
	nclass = 1, random = TRUE, constload = FALSE, cores = 1)
genderrole.lca2random2 &lt;- randomLCA(genderrole[, 1:5], freq = genderrole$Freq, 
	random = TRUE, constload = FALSE, quadpoints = 61, penalty = 0.1, cores = 1)
genderrole.lca3random2 &lt;- randomLCA(genderrole[, 1:5], freq = genderrole$Freq, 
	nclass = 3, random = TRUE, constload = FALSE, quadpoints = 61, penalty = 0.1, cores = 1)
# no improvement in fit
print(c(BIC(genderrole.lca1random2), BIC(genderrole.lca2random2), 
	BIC(genderrole.lca3random2)))

</code></pre>

<hr>
<h2 id='hivtests'>HIV testing data</h2><span id='topic+hivtests'></span>

<h3>Description</h3>

<p>Serum samples are tested for HIV by 4 different biossays in Alvord et al (1988) and sensitivity and specificity determined using latent class analysis. Qu et al (1996) repeat the analysis using a model incorporating a random effect.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hivtests</code></pre>


<h3>Format</h3>

<p>A data frame with 16 observations on the following 5 variables.
</p>

<dl>
<dt><code>V1</code></dt><dd><p>Test 1</p>
</dd>
<dt><code>V2</code></dt><dd><p>Test 2</p>
</dd>
<dt><code>V3</code></dt><dd><p>Test 3</p>
</dd>
<dt><code>V4</code></dt><dd><p>Test 4</p>
</dd>
<dt><code>freq</code></dt><dd><p>Number of subjects</p>
</dd>
</dl>



<h3>Source</h3>

<p>Qu, Tan and Kutner (1989)
</p>


<h3>References</h3>

<p>Alvord, W.G., Drummond, J.E., Arthur, L.O., Goedert, J.J., Levine, P.H., Murphy, E.L., Weiss, S.H., and Blattner, W.A. (1988) A method for predicting individual HIV infection status in the absence of clinical information. <em>AIDS Research and Human Retroviruses</em>, <b>4</b>, 295&ndash;304.
</p>
<p>Qu, Y., Tan, M. and Kutner, M.H. (1996) Random effects models in latent
class analysis for evaluating accuracy of diagnostic tests.
<em>Biometrics</em>, <b>52</b>, 797&ndash;810.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# fit standard latent class
hivtests.lca2 &lt;- randomLCA(hivtests[, 1:4], freq = hivtests$freq, cores = 1)
# with random effect and constant loading
hivtests.lca2random &lt;- randomLCA(hivtests[, 1:4], freq = hivtests$freq, random = TRUE,
    quadpoints = 101, penalty = 1.0, cores = 1)
# with random effect and variable loading
# for this model there are 13 parameters fitted to 16 observations, so model is fairly unstable
hivtests.lca2random2 &lt;- randomLCA(hivtests[, 1:4], freq = hivtests$freq, random = TRUE, 
    constload = FALSE, quadpoints = 101, penalty = 1.0, cores = 1)
# BIC shows best model is random effects with constant loading
print(c(BIC(hivtests.lca2), BIC(hivtests.lca2random), BIC(hivtests.lca2random2)))
</code></pre>

<hr>
<h2 id='logLik'>log Likelikelihood for randomLCA object</h2><span id='topic+logLik.randomLCA'></span>

<h3>Description</h3>

<p>Returns log Likelihood for a randomLCA object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'randomLCA'
logLik(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logLik_+3A_object">object</code></td>
<td>
<p>randomLCA object</p>
</td></tr>
<tr><td><code id="logLik_+3A_...">...</code></td>
<td>
<p> additional argument; currently none is used. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>The loglikelihood.
</p>


<h3>Author(s)</h3>

<p>Ken Beath</p>


<h3>Examples</h3>

<pre><code class='language-R'>
pap.lca2 &lt;- randomLCA(pap[, 1:10], freq = pap$Freq, nclass = 2, cores = 1)
print(logLik(pap.lca2))

</code></pre>

<hr>
<h2 id='maxPostClass'>
Determines class with maximum posterior class probability for each observation
</h2><span id='topic+maxPostClass'></span><span id='topic+maxPostClass.randomLCA'></span>

<h3>Description</h3>

<p>For each observation the posterior class probability is determined for each class, and then the class with the maximum posterior class probability is returned.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>maxPostClass(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="maxPostClass_+3A_object">object</code></td>
<td>
<p>randomLCA object</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Returns the class with the maximum posterior class probability for each observation.
</p>


<h3>Value</h3>

<p>A data frame. The first columns of the data frame correspond to the patterns, followed by the frequency of each pattern, and then the class with the maximum posterior class probability. The returned result is for the summarised data. If raw data is used, that is no frequencies, and it is required to calculated the posterior class probability for each observation then it is simply required to merge the maximum class with the raw data, possibly removing any variable &quot;Freq&quot; in the raw data. 
</p>


<h3>Author(s)</h3>

<p>Ken Beath</p>


<h3>Examples</h3>

<pre><code class='language-R'>
pap.lca2 &lt;- randomLCA(pap[, 1:10], freq = pap$Freq, nclass = 2, cores = 1)
maxClass.lca2 &lt;- maxPostClass(pap.lca2)
names(maxClass.lca2)[length(names(maxClass.lca2))] &lt;- "maxProb.lca2"

pap.lca3 &lt;- randomLCA(pap[, 1:10], freq = pap$Freq, nclass = 3, cores = 1)
maxClass.lca3 &lt;- maxPostClass(pap.lca3)
names(maxClass.lca3)[length(names(maxClass.lca3))] &lt;- "maxProb.lca3"

maxClass &lt;- merge(maxClass.lca2, maxClass.lca3)
# aggregate because there is more than one record for each combination
# shows the relationship between the 2 and 3 class models
print(aggregate(maxClass$Freq, list(maxProb2 = maxClass$maxProb.lca2, 
    maxProb3 = maxClass$maxProb.lca3), sum))

</code></pre>

<hr>
<h2 id='myocardial'>Myocardial Infarction (MI)</h2><span id='topic+myocardial'></span>

<h3>Description</h3>

<p>Four tests were performed on hospital patients to determine if a myocardial infarction had occurred. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>myocardial</code></pre>


<h3>Format</h3>

<p>A data frame with 32 observations on the following 6 variables.
</p>

<dl>
<dt><code>Q.wave</code></dt><dd><p>result from ECG test</p>
</dd>
<dt><code>History</code></dt><dd><p>clinical history</p>
</dd>
<dt><code>LDH</code></dt><dd><p>flipped, enzyme related to tissue breakdown</p>
</dd>
<dt><code>CPK</code></dt><dd><p>high, creatine kinase or creatine phosphokinase, related to muscle damage</p>
</dd>
<dt><code>freq</code></dt><dd><p>Number of subjects</p>
</dd>
</dl>



<h3>Source</h3>

<p>Rindskopf and Rindskopf (1986)
</p>


<h3>References</h3>

<p>Galen, R.S. and Gambino, S.R. (1975) Beyond Normality: The Predictive Value and Efficiency of Medical Diagnosis. Wiley:New York.
</p>
<p>Rindskopf, D. and Rindskopf, W. (1986) The Value of Latent Class Analysis in Medical Diagnosis. <em>Statistics in Medicine</em>, <b>5</b>, 21&ndash;27.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# fit 2 class model from Rindskopf and Rindskopf (1986)
myocardial.lca2 &lt;- randomLCA(myocardial[, 1:4], freq = myocardial$freq, cores = 1)

</code></pre>

<hr>
<h2 id='outcomeProbs'>Extract outcome probabilities for randomLCA object</h2><span id='topic+outcomeProbs'></span><span id='topic+outcomeProbs.randomLCA'></span>

<h3>Description</h3>

<p>Extract outcome probabilities and confidence intervals for a randomLCA object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'randomLCA'
outcomeProbs(object, level = 0.95, boot=FALSE, type="perc", R=999,
    scale=c("prob","raw"), cores = max(detectCores() %/% 2, 1), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="outcomeProbs_+3A_object">object</code></td>
<td>
<p>randomLCA object</p>
</td></tr>
<tr><td><code id="outcomeProbs_+3A_level">level</code></td>
<td>
<p>confidence interval</p>
</td></tr>
<tr><td><code id="outcomeProbs_+3A_boot">boot</code></td>
<td>
<p>use parametric bootstrap to obtain confidence interval</p>
</td></tr>
<tr><td><code id="outcomeProbs_+3A_type">type</code></td>
<td>
<p>type of bootstrap confidence intervals to use, with &quot;perc&quot; or &quot;norm&quot; valid, see boot.ci for description.</p>
</td></tr>
<tr><td><code id="outcomeProbs_+3A_r">R</code></td>
<td>
<p>replications for parametric bootstrap</p>
</td></tr>
<tr><td><code id="outcomeProbs_+3A_scale">scale</code></td>
<td>
<p>either &quot;prob&quot; where probabilities are returned, the default, or &quot;raw&quot; where the probabilities are returned on the logit or probit scale, depending on which scale was selected in the textttrandomLCA function</p>
</td></tr>
<tr><td><code id="outcomeProbs_+3A_cores">cores</code></td>
<td>
<p>number of cores to use when bootstrapping, shuld be at least 1 less than available cores</p>
</td></tr>
<tr><td><code id="outcomeProbs_+3A_...">...</code></td>
<td>
<p>additional argument; currently none is used. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Confidence intervals are calculated based on asymptotic normality of the estimates transformed by either the inverse of the probit or logistic, or using parametric bootstrap. The asymptotic confidence intervals are currently only available for models without random effects. For the confidence intervals obtained from the parametric bootstrap, the bootstrap is performed on the data that has been transformed to the logit or probit scale, as appropriate.
</p>


<h3>Value</h3>

<p>Data frame consisting of outcome probabilities and confidence intervals. One for each class.
</p>


<h3>Author(s)</h3>

<p>Ken Beath</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# standard latent class with 2 classes
dentistry.lca2 &lt;- randomLCA(dentistry[, 1:5], freq = dentistry$freq, nclass = 2, cores = 1)
print(outcomeProbs(dentistry.lca2))
# print on the default logit scale
print(outcomeProbs(dentistry.lca2, scale = "raw"))
# convert back to probabilities
print(1.0/(1.0+exp(-outcomeProbs(dentistry.lca2, scale = "raw")[[1]])))
print(1.0/(1.0+exp(-outcomeProbs(dentistry.lca2, scale = "raw")[[2]])))

</code></pre>

<hr>
<h2 id='pap'>Positive Action program implementation</h2><span id='topic+pap'></span>

<h3>Description</h3>

<p>The Positive Action program is a series of interventions designed to reduce negative behaviours in elementary-school students. In a study in Hawaii (Beets et al, 2006) information was recorded from students in the treatment group about whether the various parts of the program were implemented. While it is useful to describe the proportion of students experiencing implementation of each part of the program, latent class analysis will reveal if there are specific patterns to the implementation of the program (Alcock, 2008). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pap</code></pre>


<h3>Format</h3>

<p>A data frame with 606 observations summarising the answers for 1566 students on the following 11 variables. For each variable the data has been dichotomized so that a 0 represents no implementation and a 1 represents some implementation. 
</p>

<dl>
<dt><code>Q1</code></dt><dd><p>you receive stickers from your teacher for doing positive actions?</p>
</dd>
<dt><code>Q2</code></dt><dd><p>you receive a word of the week card from your teacher?</p>
</dd>
<dt><code>Q3</code></dt><dd><p>you put notes in an icu box?</p>
</dd>
<dt><code>Q4</code></dt><dd><p>your teacher read notes about you from the icu box?</p>
</dd>
<dt><code>Q5</code></dt><dd><p>your teacher read your notes from the icu box?</p>
</dd>
<dt><code>Q6</code></dt><dd><p>your class receive a token for meeting your classroom goals?</p>
</dd>
<dt><code>Q7</code></dt><dd><p>you participate in a positive action assembly?</p>
</dd>
<dt><code>Q8</code></dt><dd><p>your class receive a balloon in an assembly for achieving their classroom goals?</p>
</dd>
<dt><code>Q9</code></dt><dd><p>your class participate in whole school positive action celebrations?</p>
</dd>
<dt><code>Q10</code></dt><dd><p>most weeks were you taught a positive action lesson?</p>
</dd>
<dt><code>Freq</code></dt><dd><p>Number of subjects</p>
</dd>
</dl>



<h3>Source</h3>

<p>Alcock (2008)
</p>


<h3>References</h3>

<p>Alcock, A. (2008). Latent Class Analysis (LCA) and Latent Profile Analysis (LPA). Retrieved from http://people.oregonstate.edu/~acock/growth/Mplus files/Latent Class Analysis Presentation.doc
</p>
<p>Beets, M. W., Flay, B. R., Vuchinich, S., Snyder, F. J., Acock, A., Li, K. K., Durlak, J. (2009). Use of a social and character development program to prevent substance use, violent behaviors, and sexual activity among elementary-school students in Hawaii. American Journal of Public Health, 99(8), 1438-1445
</p>


<h3>Examples</h3>

<pre><code class='language-R'># standard latent class
pap.lca1 &lt;- randomLCA(pap[, 1:10], freq = pap$Freq, nclass = 1, cores = 1)
pap.lca2 &lt;- randomLCA(pap[, 1:10], freq = pap$Freq, nclass = 2, cores = 1)

# standard latent class
pap.lca3 &lt;- randomLCA(pap[, 1:10], freq = pap$Freq, nclass = 3, cores = 1)
pap.lca4 &lt;- randomLCA(pap[, 1:10], freq = pap$Freq, nclass = 4, cores = 1)
pap.lca5 &lt;- randomLCA(pap[, 1:10], freq = pap$Freq, nclass = 5, cores = 1)

# repeat with random effect with constant loading
# once BIC increases fitting further models is unnecessary
pap.lca1random &lt;- randomLCA(pap[, 1:10], 
          freq = pap$Freq, nclass = 1, random = TRUE, cores = 1)
pap.lca2random &lt;- randomLCA(pap[, 1:10], 
          freq = pap$Freq, nclass = 2, random = TRUE, cores = 1)
pap.lca3random &lt;- randomLCA(pap[, 1:10], 
          freq = pap$Freq, nclass = 3, random = TRUE, cores = 1)
# can also repeat fits without constant loading to give mixture of IRT models
pap.lca1random2 &lt;- randomLCA(pap[, 1:10], 
          freq = pap$Freq, nclass = 1, random = TRUE, constload = FALSE, cores = 1)

pap.lca2random2 &lt;- randomLCA(pap[, 1:10], 
          freq = pap$Freq, nclass = 2, random = TRUE, constload = FALSE, cores = 1)

pap.lca3random2 &lt;- randomLCA(pap[, 1:10], 
          freq = pap$Freq, nclass = 3, random = TRUE, constload = FALSE, cores = 1)

# produce table of BIC values
# shows 4 class best of standard latent class
# but 2 class latent class with constant loading has better BIC
pap.bic &lt;- data.frame(bic = c(BIC(pap.lca1), BIC(pap.lca2), BIC(pap.lca3), 
    BIC(pap.lca4), BIC(pap.lca5)), bic2 = c(BIC(pap.lca1random),
    BIC(pap.lca2random), BIC(pap.lca3random), NA, NA), bic3 = c(BIC(pap.lca1random2),
    BIC(pap.lca2random2), BIC(pap.lca3random2), NA, NA))
print(pap.bic)
# plot 4 class standard
plot(pap.lca4, type = "b")
# plot 2 class standard
plot(pap.lca2random, type = "b")

</code></pre>

<hr>
<h2 id='plot'>Plot a randomLCA object</h2><span id='topic+plot.randomLCA'></span>

<h3>Description</h3>

<p>Plots the outcome probabilities for a randomLCA object, for random effects objects this can be either marginal or conditional or both. For a 2 level random effects model conditional2 will condition on the subject random effect and integrate over the period random effects. Note that plot is based on the xyplot function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'randomLCA'
plot(x, ... , graphtype = ifelse(x$random, "marginal", "conditional"), 
     conditionalp = 0.5, classhorizontal = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_+3A_x">x</code></td>
<td>
<p>randomLCA object</p>
</td></tr>
<tr><td><code id="plot_+3A_graphtype">graphtype</code></td>
<td>
<p>Type of graph</p>
</td></tr>
<tr><td><code id="plot_+3A_conditionalp">conditionalp</code></td>
<td>
<p>For a conditional graph the percentile corresponding to the random effect at which the outcome probability is to be calculated</p>
</td></tr>
<tr><td><code id="plot_+3A_classhorizontal">classhorizontal</code></td>
<td>
<p>classes to be plotted across the page</p>
</td></tr>
<tr><td><code id="plot_+3A_...">...</code></td>
<td>
<p>additional parameters to xyplot</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ken Beath <a href="mailto:ken.beath@mq.edu.au">ken.beath@mq.edu.au</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+calcCondProb">calcCondProb</a></code>, <code><a href="#topic+calcMargProb">calcMargProb</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
# standard latent class with 2 classes
uterinecarcinoma.lca2 &lt;- randomLCA(uterinecarcinoma[, 1:7], freq = uterinecarcinoma$freq, cores = 1)
plot(uterinecarcinoma.lca2)
uterinecarcinoma.lcarandom2 &lt;- randomLCA(uterinecarcinoma[, 1:7], 
  freq = uterinecarcinoma$freq, random = TRUE, probit = TRUE, quadpoints = 61, cores = 1)
# default for random effects models is marginal
plot(uterinecarcinoma.lcarandom2)
# default for random effects models conditional is p = 0.5 i.e. median
plot(uterinecarcinoma.lcarandom2, graphtype = "conditional")
# look at variability by plotting conditional probabilities at 0.05, 0.5 and 0.95
plot(uterinecarcinoma.lcarandom2, graphtype = "conditional", conditionalp = c(0.05, 0.5, 0.95))

</code></pre>

<hr>
<h2 id='postClassProbs'>
Determines posterior class probabilities for fitted model
</h2><span id='topic+postClassProbs'></span><span id='topic+postClassProbs.randomLCA'></span>

<h3>Description</h3>

<p>The posterior class probabililities for each observed pattern and class is determined. These are returned as a data frame together with the patterns for each observation. If class = 0 is requested then all classes are returned, otherwise only the selected class.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>postClassProbs(object, class = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="postClassProbs_+3A_object">object</code></td>
<td>
<p>randomLCA object</p>
</td></tr>
<tr><td><code id="postClassProbs_+3A_class">class</code></td>
<td>
<p>class to be returned. Zero returns all classes.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Extracts the corresponding data from the randomLCA object.
</p>


<h3>Value</h3>

<p>A data frame. The first columns of the data frame correspond to the patterns, followed by the frequency of each pattern, and then the posterior class probabilities for either the selected class or for all classes. The returned result is for the summarised data. If raw data is used, that is no frequencies, and it is required to calculated the posterior class probability for each observation then it is simply required to merge the class probabilities with the raw data, possibly removing any variable &quot;freq&quot; in the raw data. 
</p>


<h3>Author(s)</h3>

<p>Ken Beath</p>


<h3>Examples</h3>

<pre><code class='language-R'>
pap.lca2 &lt;- randomLCA(pap[, 1:10], freq = pap$Freq, nclass = 2, cores = 1)
print(postClassProbs(pap.lca2))

</code></pre>

<hr>
<h2 id='print.randomLCA'>print for randomLCA object</h2><span id='topic+print.randomLCA'></span>

<h3>Description</h3>

<p>Prints a randomLCA object. Prints summary.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'randomLCA'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.randomLCA_+3A_x">x</code></td>
<td>
<p>randomLCA object</p>
</td></tr>
<tr><td><code id="print.randomLCA_+3A_...">...</code></td>
<td>
<p> additional argument; currently none is used. </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ken Beath</p>


<h3>Examples</h3>

<pre><code class='language-R'>
pap.lca1 &lt;- randomLCA(pap[, 1:10], freq = pap$Freq, nclass = 1, cores = 1)
pap.lca1
# or
print(pap.lca1)

</code></pre>

<hr>
<h2 id='randomLCA'>Fits a Latent Class Model including a Random Effect</h2><span id='topic+randomLCA'></span>

<h3>Description</h3>

<p>Fit latent class models, which may include a random effect.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>randomLCA(patterns, freq = NULL, nclass = 2, calcSE = TRUE, notrials = 20, 
  random = FALSE, byclass = FALSE, quadpoints = 21, constload = TRUE,
  blocksize = dim(patterns)[2], level2 = FALSE, probit = FALSE,
  level2size = blocksize, qniterations = 5, penalty = 0.01, EMtol = 1.0e-5,
  verbose = FALSE, seed = as.integer(runif(1, 0, .Machine$integer.max)),
  cores =  max(detectCores() %/% 2, 1))</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="randomLCA_+3A_patterns">patterns</code></td>
<td>
<p>Data frame or matrix of 0 and 1 defining the outcome patterns. May also include missing values, with randomLCA using maximum likelihood to fit the models using all available data.</p>
</td></tr>
<tr><td><code id="randomLCA_+3A_freq">freq</code></td>
<td>
<p>Frequency for each outcome pattern, if missing this is calculated from the patterns, and the patterns are summarised to remove duplicate values.</p>
</td></tr>
<tr><td><code id="randomLCA_+3A_nclass">nclass</code></td>
<td>
<p>Number of classes to be fitted</p>
</td></tr>
<tr><td><code id="randomLCA_+3A_calcse">calcSE</code></td>
<td>
<p>Calculate standard errors for parameters. Useful for bootstrapping.</p>
</td></tr>
<tr><td><code id="randomLCA_+3A_notrials">notrials</code></td>
<td>
<p>For a standard latent class model, the number of random starting values used</p>
</td></tr>
<tr><td><code id="randomLCA_+3A_random">random</code></td>
<td>
<p>Include random effect?</p>
</td></tr>
<tr><td><code id="randomLCA_+3A_byclass">byclass</code></td>
<td>
<p>Vary random effect loading(s) by class?</p>
</td></tr>
<tr><td><code id="randomLCA_+3A_quadpoints">quadpoints</code></td>
<td>
<p>Number of quadrature points for adaptive quadrature</p>
</td></tr>
<tr><td><code id="randomLCA_+3A_constload">constload</code></td>
<td>
<p>Outcome loadings are constant for random effects model?</p>
</td></tr>
<tr><td><code id="randomLCA_+3A_blocksize">blocksize</code></td>
<td>
<p>Where a random effects (single level) model is broken into blocks, that is the loadings are repeated, this defines the size of the blocks</p>
</td></tr>
<tr><td><code id="randomLCA_+3A_probit">probit</code></td>
<td>
<p>Probit model for random effect?</p>
</td></tr>
<tr><td><code id="randomLCA_+3A_level2">level2</code></td>
<td>
<p>Fit 2 level random effects model (further details to follow)?</p>
</td></tr>
<tr><td><code id="randomLCA_+3A_level2size">level2size</code></td>
<td>
<p>Size of level 2 blocks if fitting 2 level models</p>
</td></tr>
<tr><td><code id="randomLCA_+3A_qniterations">qniterations</code></td>
<td>
<p>Number of Quasi-Newton iterations within each EM/adaptive cycle. Decrease if there is a failure to converge</p>
</td></tr>
<tr><td><code id="randomLCA_+3A_penalty">penalty</code></td>
<td>
<p>penalty applied to likelihood for outcome probabilities. Shrinks outcome probabilities in slightly and can prevent extreme values. Setting penalty to 0 will produce an unpenalized fit.</p>
</td></tr>
<tr><td><code id="randomLCA_+3A_emtol">EMtol</code></td>
<td>
<p>convergence tolerance for EM algorithm for fixed effect latent class</p>
</td></tr>
<tr><td><code id="randomLCA_+3A_verbose">verbose</code></td>
<td>
<p>Prints fit progress if true</p>
</td></tr>
<tr><td><code id="randomLCA_+3A_seed">seed</code></td>
<td>
<p>Initial random seed for generating starting values. This can be set to guarantee that the fit is the same each time, including the order of the classes.</p>
</td></tr>
<tr><td><code id="randomLCA_+3A_cores">cores</code></td>
<td>
<p>Number of cores to be used for parallel evaluation of starting values</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The structure of the patterns is assumed to be a number of blocks of different outcomes each of level2size, allowing outcomes to be repeated. Each outcome is assumed to have it's own loading.
An example is the width of the patterns is n and the level2size is n, resulting in n outcomes and therefore n loadings. Alternatively if the level2size is 1, then there are n repeats of the same outcome (but with different probabilities) with the same loading. In practice they may not be the same type of outcome, but usually will be.
</p>
<p>The algorithm used is EM for the standard latent class and adaptive (in the sense of moving the location of the quadrature points) Gauss-Hermite quadrature for the random effects models. The number of quadrature points defaults to 21.
</p>


<h3>Value</h3>

<p>randomLCA object
This contains
</p>
<table>
<tr><td><code>fit</code></td>
<td>
<p>Fit object from optim</p>
</td></tr>
<tr><td><code>nclass</code></td>
<td>
<p>Number of classes</p>
</td></tr>
<tr><td><code>classp</code></td>
<td>
<p>Class probabilities</p>
</td></tr>
<tr><td><code>outcomep</code></td>
<td>
<p>Outcome probability</p>
</td></tr>
<tr><td><code>lambdacoef</code></td>
<td>
<p>Loadings</p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p>Standard errors corresponding to results returned by optim</p>
</td></tr>
<tr><td><code>np</code></td>
<td>
<p>Number of parameters</p>
</td></tr>
<tr><td><code>nobs</code></td>
<td>
<p>Number of observations in total</p>
</td></tr>
<tr><td><code>logLik</code></td>
<td>
<p>log likelihood for fitted model</p>
</td></tr>
<tr><td><code>penlogLik</code></td>
<td>
<p>Penalised log likelihood for fitted model</p>
</td></tr>
<tr><td><code>observed</code></td>
<td>
<p>Observed numbers corresponding to each pattern</p>
</td></tr>
<tr><td><code>fitted</code></td>
<td>
<p>Fitted number corresponding to each pattern</p>
</td></tr>
<tr><td><code>deviance</code></td>
<td>
<p>Deviance</p>
</td></tr>
<tr><td><code>classprob</code></td>
<td>
<p>Posterior class probability for each pattern</p>
</td></tr>
<tr><td><code>bics</code></td>
<td>
<p>BIC obtained for each trial when fitting initial latent class models</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>call to randomLCA</p>
</td></tr>
<tr><td><code>random</code></td>
<td>
<p>random parameter to randomLCA</p>
</td></tr>
<tr><td><code>constload</code></td>
<td>
<p>constload parameter to randomLCA</p>
</td></tr>
<tr><td><code>level2</code></td>
<td>
<p>level2 parameter to randomLCA</p>
</td></tr>
<tr><td><code>level2size</code></td>
<td>
<p>level2size parameter to randomLCA</p>
</td></tr>
<tr><td><code>byclass</code></td>
<td>
<p>byclass parameter to randomLCA</p>
</td></tr>
<tr><td><code>probit</code></td>
<td>
<p>probit parameter to randomLCA</p>
</td></tr>
<tr><td><code>quadpoints</code></td>
<td>
<p>quadpoints parameter to randomLCA</p>
</td></tr>
<tr><td><code>blocksize</code></td>
<td>
<p>blocksize parameter to randomLCA</p>
</td></tr>
<tr><td><code>freq</code></td>
<td>
<p>frequency of each pattern</p>
</td></tr>
<tr><td><code>qniterations</code></td>
<td>
<p>qniterations parameter to randomLCA</p>
</td></tr>
<tr><td><code>penalty</code></td>
<td>
<p>penalty parameter to randomLCA</p>
</td></tr>
</table>


<h3>Note</h3>

<p>In the returned object there a fields for patterns and frequencies. If frequencies are not supplied then the patterns and frequencies are constructed. If frequencies are supplied then zero rows are removed. When frequencies are supplied it is assumed that the data has been simplified. The returned fitted, posterior class probabilities etc, all correspond to the simplified patterns, not to the original data.
</p>


<h3>Author(s)</h3>

<p>Ken Beath</p>


<h3>References</h3>

<p>Beath KJ (2017). randomLCA: An R Package for Latent Class with Random Effects Analysis. Journal of Statistical Software, 81(13), pp. 1-25. <a href="https://doi.org/10.18637/jss.v081.i13">doi:10.18637/jss.v081.i13</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>
# standard latent class with 2 classes
dentistry.lca2 &lt;- randomLCA(dentistry[, 1:5], freq = dentistry$freq, nclass = 2, cores = 1)
# random effects model with constant random effect loading
dentistry.lca2random &lt;- randomLCA(dentistry[, 1:5], freq = dentistry$freq, 
	nclass = 2, random = TRUE, constload = TRUE, probit = TRUE, cores = 1)
# allow loading to vary by dentist
# this is the 2LCR model from Qu et al (1996)
dentistry.lca2random1 &lt;- randomLCA(dentistry[, 1:5], freq = dentistry$freq, 
	nclass = 2, random = TRUE, constload = FALSE, probit = TRUE, cores = 1)

</code></pre>

<hr>
<h2 id='ranef'>Extract random effects from a randomLCA object</h2><span id='topic+ranef'></span><span id='topic+ranef.randomLCA'></span>

<h3>Description</h3>

<p>Extracts the Empirical Bayes estimates of the random effects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'randomLCA'
ranef(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ranef_+3A_object">object</code></td>
<td>
<p>randomLCA object with a random effect</p>
</td></tr>
<tr><td><code id="ranef_+3A_...">...</code></td>
<td>
<p> additional argument; currently none is used. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix with the first column containing the random effects and the second column the standard error of the random effects. 
</p>


<h3>Author(s)</h3>

<p>Ken Beath</p>


<h3>Examples</h3>

<pre><code class='language-R'>
pap.lca2random &lt;- randomLCA(pap[, 1:10], freq = pap$Freq, random = TRUE, nclass = 2, cores = 1)
print(ranef(pap.lca2random))

</code></pre>

<hr>
<h2 id='refit'>Refit an randomLCA object</h2><span id='topic+refit'></span><span id='topic+refit.randomLCA'></span>

<h3>Description</h3>

<p>Refits an randomLCA object using new data. This is useful when fitting simulated data, for example using a bootstrap. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'randomLCA'
refit(object, newpatterns, newfreq, useinit = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="refit_+3A_object">object</code></td>
<td>
<p>randomLCA object</p>
</td></tr>
<tr><td><code id="refit_+3A_newpatterns">newpatterns</code></td>
<td>
<p>the new patterns that are to be fitted using the existing model</p>
</td></tr>
<tr><td><code id="refit_+3A_newfreq">newfreq</code></td>
<td>
<p>the frequencies corresponding to the patterns if required</p>
</td></tr>
<tr><td><code id="refit_+3A_useinit">useinit</code></td>
<td>
<p>use initial values from randomLCA object</p>
</td></tr>
<tr><td><code id="refit_+3A_...">...</code></td>
<td>
<p> additional argument; currently none is used. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The useunit parameter determines whether the parameter estimates from the supplied model are used as initial values or whether the complete model fitting process is repeated. If the initial values are used then fitting will be faster, and the fitted classes will be similar to those in the original model. If the data was not generated from the original model there is an increased risk that the fit will not find the global maxima. For this reason when performing a bootstrap Likelihood ratio test it is better to use useinit = FALSE. However when using useinit = FALSE there may be label switching, where the estimated classes are similar, but in a different order. Unless the estimated parameters are assigned to the correct classes this will invalidate the results of a parametric bootstrap for parameter confidence intervals.
</p>


<h3>Value</h3>

<p>The fitted model to the new data.
</p>


<h3>Author(s)</h3>

<p>Ken Beath</p>


<h3>Examples</h3>

<pre><code class='language-R'>
myocardial.lca1 &lt;- randomLCA(myocardial[, 1:4], freq = myocardial$freq, nclass = 1, cores = 1)
myocardial.lca2 &lt;- randomLCA(myocardial[, 1:4], freq = myocardial$freq, cores = 1)
# calculate observed lrt
obslrt &lt;- 2*(logLik(myocardial.lca2)-logLik(myocardial.lca1))

print(obslrt)

nsims &lt;- 999
# generate the simulations
thesims &lt;- simulate(myocardial.lca1, nsims)
# for each simulation determin lrt
simlrt &lt;- rep(NA, nsims)
for (isim in 1:nsims) {
  submodel &lt;- refit(myocardial.lca1, newpatterns = thesims[[isim]])
  fullmodel &lt;- refit(myocardial.lca2, newpatterns = thesims[[isim]])
  simlrt[isim] &lt;- 2*(logLik(fullmodel)-logLik(submodel))
  print(c(isim, simlrt[isim]))
}
# calculate p value as proportion of simulated lrt greater than observed, 
# corrected by adding one to numerator and denominator
print((sum(simlrt &gt;= obslrt)+1)/(nsims+1))

</code></pre>

<hr>
<h2 id='simulate'>Simulate</h2><span id='topic+simulate.randomLCA'></span>

<h3>Description</h3>

<p>Simulate data from a fitted randomLCA model</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'randomLCA'
simulate(object, nsim, seed, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simulate_+3A_object">object</code></td>
<td>
<p>randomLCA object</p>
</td></tr>
<tr><td><code id="simulate_+3A_nsim">nsim</code></td>
<td>
<p>number of data sets to be simulated</p>
</td></tr>
<tr><td><code id="simulate_+3A_seed">seed</code></td>
<td>
<p>random seed</p>
</td></tr>
<tr><td><code id="simulate_+3A_...">...</code></td>
<td>
<p>additional optional arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generates random data from the supplied object.
</p>


<h3>Value</h3>

<p>A simulated data frame or a list of simulated data frames.
</p>


<h3>Author(s)</h3>

<p>Ken Beath</p>


<h3>Examples</h3>

<pre><code class='language-R'>
myocardial.lca1 &lt;- randomLCA(myocardial[, 1:4], freq = myocardial$freq, nclass = 1, cores = 1)
myocardial.lca2 &lt;- randomLCA(myocardial[, 1:4], freq = myocardial$freq, cores = 1)
# calculate observed lrt
obslrt &lt;- 2*(logLik(myocardial.lca2)-logLik(myocardial.lca1))

print(obslrt)

nsims &lt;- 999
# generate the simulations
thesims &lt;- simulate(myocardial.lca1, nsims)
# for each simulation determin lrt
simlrt &lt;- rep(NA, nsims)
for (isim in 1:nsims) {
  submodel &lt;- refit(myocardial.lca1, newpatterns = thesims[[isim]])
  fullmodel &lt;- refit(myocardial.lca2, newpatterns = thesims[[isim]])
  simlrt[isim] &lt;- 2*(logLik(fullmodel)-logLik(submodel))
  print(c(isim, simlrt[isim]))
}
# calculate p value as proportion of simulated lrt greater than observed, 
# corrected by adding one to numerator and denominator
print((sum(simlrt &gt;= obslrt)+1)/(nsims+1))
</code></pre>

<hr>
<h2 id='summary.randomLCA'>Summary for randomLCA object</h2><span id='topic+summary.randomLCA'></span>

<h3>Description</h3>

<p>Summarises the fit of a randomLCA object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'randomLCA'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.randomLCA_+3A_object">object</code></td>
<td>
<p>randomLCA object</p>
</td></tr>
<tr><td><code id="summary.randomLCA_+3A_...">...</code></td>
<td>
<p> additional argument; currently none is used. </p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>logLik</code></td>
<td>
<p>Log Likelihood</p>
</td></tr>
<tr><td><code>AIC</code></td>
<td>
<p>AIC</p>
</td></tr>
<tr><td><code>BIC</code></td>
<td>
<p>BIC</p>
</td></tr>
<tr><td><code>AIC3</code></td>
<td>
<p>AIC with penalty of 3</p>
</td></tr>
<tr><td><code>nclass</code></td>
<td>
<p>no of classes</p>
</td></tr>
<tr><td><code>probit</code></td>
<td>
<p>link is probit</p>
</td></tr>
<tr><td><code>classp</code></td>
<td>
<p>class probabilities</p>
</td></tr>
<tr><td><code>outcomep</code></td>
<td>
<p>outcome probabilities (conditional)</p>
</td></tr>
<tr><td><code>margoutcomep</code></td>
<td>
<p>outcome probabilities (marginal), if model contains random effects</p>
</td></tr>
<tr><td><code>random</code></td>
<td>
<p>model includes random effects</p>
</td></tr>
<tr><td><code>level2</code></td>
<td>
<p>model has 2 level hierarchy</p>
</td></tr>
<tr><td><code>constload</code></td>
<td>
<p>loadings are constant by outcome</p>
</td></tr>
<tr><td><code>byclass</code></td>
<td>
<p>lambda and tau vary by class</p>
</td></tr>
<tr><td><code>lambdacoef</code></td>
<td>
<p>lambda coefficients</p>
</td></tr>
<tr><td><code>taucoef</code></td>
<td>
<p>tau coefficients</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ken Beath</p>


<h3>Examples</h3>

<pre><code class='language-R'>
pap.lca1 &lt;- randomLCA(pap[, 1:10], freq = pap$Freq, nclass = 1, cores = 1)
summary(pap.lca1)

</code></pre>

<hr>
<h2 id='symptoms'>Symptoms data</h2><span id='topic+symptoms'></span>

<h3>Description</h3>

<p>This is the data for Beath and Heller (2009).
</p>
<p>Allergy and respiratory symptoms for infants 0 to 2 years in six month periods. Outcome is presence or absence of symptom in the six months. Original data was collected at Visits 1-7 over the 2 year period which were summarised to six month periods.
</p>
<p>Note that these models can be slow to fit, with the &quot;symptoms.lca2random2&quot; model taking about 1-2 hours. 
</p>
<p>Thanks to the investigators of the CAPS study for making the data available.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>symptoms</code></pre>


<h3>Format</h3>

<p>A data frame with 444 observations on the following 17 variables.
</p>

<dl>
<dt><code>Nightcough.13</code></dt><dd><p>Night cough in visits 1-3</p>
</dd>
<dt><code>Wheeze.13</code></dt><dd><p>Wheeze in visits 1-3</p>
</dd>
<dt><code>Itchyrash.13</code></dt><dd><p>Itchy rash in visits 1-3</p>
</dd>
<dt><code>FlexDerma.13</code></dt><dd><p>Flexural Dermatitis in visits 1-3</p>
</dd>
<dt><code>Nightcough.45</code></dt><dd><p>Night cough in visits 1-3</p>
</dd>
<dt><code>Wheeze.45</code></dt><dd><p>Wheeze in visits 4-5</p>
</dd>
<dt><code>Itchyrash.45</code></dt><dd><p>Itchy rash in visits 4-5</p>
</dd>
<dt><code>FlexDerma.45</code></dt><dd><p>Flexural Dermatitis in visits 4-5</p>
</dd>
<dt><code>Nightcough.6</code></dt><dd><p>Night cough in visit 6</p>
</dd>
<dt><code>Wheeze.6</code></dt><dd><p>Wheeze in visit 6</p>
</dd>
<dt><code>Itchyrash.6</code></dt><dd><p>Itchy rash in visit 6</p>
</dd>
<dt><code>FlexDerma.6</code></dt><dd><p>Flexural Dermatitis in visits 1-3</p>
</dd>
<dt><code>Nightcough.7</code></dt><dd><p>Night cough in visit 7</p>
</dd>
<dt><code>Wheeze.7</code></dt><dd><p>Wheeze in visit 7</p>
</dd>
<dt><code>Itchyrash.7</code></dt><dd><p>Itchy rash in visit 7</p>
</dd>
<dt><code>FlexDerma.7</code></dt><dd><p>Flexural Dermatitis in visit 7</p>
</dd>
<dt><code>Freq</code></dt><dd><p>Number of subjects</p>
</dd>
</dl>



<h3>Source</h3>

<p>Mihrshai et al (2001)
</p>


<h3>References</h3>

<p>Mihrshahi, S., Peat, J.K., Webb, K., Tovey, R.E., Marks, G.B., Mellis, C.M. and Leeder S.R. (2001) The Childhood Asthma Prevention Study (CAPS): Design and research protocol of a randomized trial for the primary prevention of asthma. Control led Clinical Trials, <b>22</b>:333&ndash;354.
</p>
<p>Beath, K.J. and Heller, G.Z. (2009) Latent trajectory modelling of multivariate binary data. Statistical Modelling, <b>9(3)</b>:199&ndash;213.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
symptoms.lca2 &lt;- randomLCA(symptoms[, 1:16], freq = symptoms$Freq, nclass = 2,
  cores = 1)
symptoms.lca2random &lt;- randomLCA(symptoms[, 1:16], freq = symptoms$Freq, 
	random = TRUE, nclass = 2, blocksize = 4, constload = FALSE, cores = 1)
symptoms.lca2random2 &lt;- randomLCA(symptoms[, 1:16], freq = symptoms$Freq, 
	random = TRUE, level2 = TRUE, nclass = 2, level2size = 4, constload = FALSE,
	penalty = 0.1, cores = 1)

</code></pre>

<hr>
<h2 id='uterinecarcinoma'>Uterine Carcinoma Data</h2><span id='topic+uterinecarcinoma'></span>

<h3>Description</h3>

<p>Classification of 118 histology samples by 118 pathologists. Original classification in Holmquist et al (1967) was to one of five categories, this has been reduced to two. Analysed by a number of authors, with a random effects model in Qu et al (1996).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>uterinecarcinoma</code></pre>


<h3>Format</h3>

<p>A data frame with 20 observations on the following 8 variables.
</p>

<dl>
<dt><code>V1</code></dt><dd><p>Pathologist 1</p>
</dd>
<dt><code>V2</code></dt><dd><p>Pathologist 2</p>
</dd>
<dt><code>V3</code></dt><dd><p>Pathologist 3</p>
</dd>
<dt><code>V4</code></dt><dd><p>Pathologist 4</p>
</dd>
<dt><code>V5</code></dt><dd><p>Pathologist 5</p>
</dd>
<dt><code>V6</code></dt><dd><p>Pathologist 6</p>
</dd>
<dt><code>V7</code></dt><dd><p>Pathologist 7</p>
</dd>
<dt><code>freq</code></dt><dd><p>Number of observed pattern</p>
</dd>
</dl>



<h3>Source</h3>

<p>Qu et al (1996)
</p>


<h3>References</h3>

<p>Holmquist, N.D., McMahan, C.A., and Williams, O.D. (1967) Variability in classification of carcinoma in situ of the uterine cervix. <em>Archives of Pathology</em>, <b>84</b>, 344&ndash;345.
</p>
<p>Qu, Y., Tan, M. and Kutner, M.H. (1996) Random effects models in latent class analysis for evaluating accuracy of diagnostic tests. <em>Biometrics</em>, <b>52</b>, 797&ndash;810.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
uterinecarcinoma.lcarandom2 &lt;- randomLCA(uterinecarcinoma[, 1:7], 
  freq = uterinecarcinoma$freq, random = TRUE, probit = TRUE, quadpoints = 61, cores = 1)
# LCR1 model of Que et al. This is fairly unstable and 
# is also slow and doesn't improve the model fit
uterinecarcinoma.lcarandom2by &lt;- randomLCA(uterinecarcinoma[, 1:7], freq = uterinecarcinoma$freq, 
	byclass = TRUE, random = TRUE, probit = TRUE, quadpoints = 71, cores = 1)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
