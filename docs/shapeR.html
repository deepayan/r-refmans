<!DOCTYPE html><html lang="en"><head><title>Help for package shapeR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {shapeR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#cluster.plot'><p>Plot data clusters</p></a></li>
<li><a href='#detect.outline'><p>Detect otolith outline</p></a></li>
<li><a href='#enrich.master.list'><p>Link information in the info.file to the coefficients obtained from the otolith images</p></a></li>
<li><a href='#estimate.outline.reconstruction'><p>Estimate the outline reconstruction based on Fourier/wavelet compared to the outlines that have not been transformed</p></a></li>
<li><a href='#FISH'><p>An example data file</p></a></li>
<li><a href='#generateShapeCoefficients'><p>Get wavelet/Fourier coefficients and basic shape variables</p></a></li>
<li><a href='#getFourier'><p>Get Fourier coefficients, filtered according to filter</p></a></li>
<li><a href='#getMasterlist'><p>Get filtered master.list values</p></a></li>
<li><a href='#getMeasurements'><p>Get simple shape variables, filtered according to filter</p></a></li>
<li><a href='#getStdFourier'><p>Get standardized Fourier coefficients, filtered according to filter</p></a></li>
<li><a href='#getStdMeasurements'><p>Get simple shape variables after standardization, filtered according to filter</p></a></li>
<li><a href='#getStdWavelet'><p>Get standardized wavelet coefficients, filtered according to filter</p></a></li>
<li><a href='#getWavelet'><p>Get wavelet coefficients, filtered according to filter</p></a></li>
<li><a href='#outline.reconstruction.plot'><p>Plot outline reconstruction</p></a></li>
<li><a href='#plotFourier'><p>Mean and standard deviation of the Fourier coefficients</p></a></li>
<li><a href='#plotFourierShape'><p>Mean otolith shape based on Fourier reconstruction</p></a></li>
<li><a href='#plotWavelet'><p>Mean and standard deviation of the wavelet coefficients</p></a></li>
<li><a href='#plotWaveletShape'><p>Mean otolith shape based on wavelet reconstruction</p></a></li>
<li><a href='#read.master.list'><p>Read updated master list</p></a></li>
<li><a href='#remove.outline'><p>Remove otolith outline</p></a></li>
<li><a href='#setFilter'><p>Set a filter to analyze the shape data</p></a></li>
<li><a href='#shape'><p>An example shapeR instance including 160 images.</p></a></li>
<li><a href='#shapeR'><p>shapeR</p></a></li>
<li><a href='#show+2CshapeR-method'><p>Show a shapeR object</p></a></li>
<li><a href='#show.original.with.outline'><p>Show the extracted outline on top of the original image</p></a></li>
<li><a href='#smoothout'><p>Contour smoothing</p></a></li>
<li><a href='#stdCoefs'><p>Standardize coefficients</p></a></li>
<li><a href='#write.image.with.outline'><p>Write outlines on top of the original images for quality checking</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Collection and Analysis of Otolith Shape Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0-1</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-11-21</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Lisa Anne Libungan &lt;lisa.libungan@gmail.com&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.2)</td>
</tr>
<tr>
<td>Imports:</td>
<td>plotrix, jpeg, pixmap, wavethresh, methods, vegan, MASS</td>
</tr>
<tr>
<td>Description:</td>
<td>Studies otolith shape variation among fish populations.
  Otoliths are calcified structures found in the inner ear of teleost fish and their shape has
  been known to vary among several fish populations and stocks, making them very useful in taxonomy,
  species identification and to study geographic variations. The package extends previously described
  software used for otolith shape analysis by allowing the user to automatically extract closed
  contour outlines from a large number of images, perform smoothing to eliminate pixel noise described in Haines and Crampton (2000) &lt;<a href="https://doi.org/10.1111%2F1475-4983.00148">doi:10.1111/1475-4983.00148</a>&gt;,
  choose from conducting either a Fourier or wavelet see Gen√ßay et al (2001) &lt;<a href="https://doi.org/10.1016%2FS0378-4371%2800%2900463-5">doi:10.1016/S0378-4371(00)00463-5</a>&gt; transform to the outlines and visualize
  the mean shape. The output of the package are independent Fourier or wavelet coefficients
  which can be directly imported into a wide range of statistical packages in R. The package
  might prove useful in studies of any two dimensional objects.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/lisalibungan/shapeR">https://github.com/lisalibungan/shapeR</a>,
<a href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0121102">https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0121102</a></td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-11-21 18:54:49 UTC; lisa</td>
</tr>
<tr>
<td>Author:</td>
<td>Lisa Anne Libungan [aut, cre],
  Snaebjorn Palsson [aut, ths]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-11-21 22:30:04 UTC</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
</table>
<hr>
<h2 id='cluster.plot'>Plot data clusters</h2><span id='topic+cluster.plot'></span>

<h3>Description</h3>

<p>Plots data clusters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cluster.plot( ddata, classes, main="", col.stock=NULL,
              plotCI = FALSE, conf.level = 0.68, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cluster.plot_+3A_ddata">ddata</code></td>
<td>
<p>Matrix of points</p>
</td></tr>
<tr><td><code id="cluster.plot_+3A_classes">classes</code></td>
<td>
<p>A factor including the cluster values</p>
</td></tr>
<tr><td><code id="cluster.plot_+3A_main">main</code></td>
<td>
<p>Title for the plot</p>
</td></tr>
<tr><td><code id="cluster.plot_+3A_col.stock">col.stock</code></td>
<td>
<p>Colors for the plotted classes</p>
</td></tr>
<tr><td><code id="cluster.plot_+3A_plotci">plotCI</code></td>
<td>
<p>Plot means with confidence intervals</p>
</td></tr>
<tr><td><code id="cluster.plot_+3A_conf.level">conf.level</code></td>
<td>
<p>The confidence interval for the standard error of the mean</p>
</td></tr>
<tr><td><code id="cluster.plot_+3A_...">...</code></td>
<td>
<p>Additional parameters to be passed to 'plot' or 'ldahist' if one dimension</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None
</p>


<h3>Author(s)</h3>

<p>Lisa Anne Libungan
</p>


<h3>References</h3>

<p>Oksanen, J., Blanchet, F.G., Kindt, R., Legendre, P., Minchin, P.R., O'Hara, R.B., Simpson, G.L., Solymos, P., Stevens, M.H.H. and Wagner, H. (2013). <code><a href="vegan.html#topic+vegan">vegan</a></code>: Community Ecology Package. R package version 2.0-10.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(shape)
library(vegan)
cap.res = capscale(getStdWavelet(shape) ~ getMasterlist(shape)$pop)

eig=eigenvals(cap.res,constrained=TRUE)
eig.ratio = eig/sum(eig)

cluster.plot(scores(cap.res)$sites[,1:2],getMasterlist(shape)$pop
,plotCI=TRUE
,xlab=paste("CAP1 (",round(eig.ratio[1]*100,1),"%)",sep="")
,ylab=paste("CAP2 (",round(eig.ratio[2]*100,1),"%)",sep="")
,main="Canonical clustering"
)

</code></pre>

<hr>
<h2 id='detect.outline'>Detect otolith outline</h2><span id='topic+detect.outline'></span>

<h3>Description</h3>

<p>Determine the outline of otolith images in jpeg format which have been stored in the <code>Fixed</code> folder.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>detect.outline(object, threshold=0.2, mouse.click=FALSE,
           display.images=FALSE, write.outline.w.org=FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="detect.outline_+3A_object">object</code></td>
<td>
<p><code><a href="#topic+shapeR-class">shapeR</a></code> object</p>
</td></tr>
<tr><td><code id="detect.outline_+3A_threshold">threshold</code></td>
<td>
<p>Grayscale threshold. Value between 0 and 1.</p>
</td></tr>
<tr><td><code id="detect.outline_+3A_mouse.click">mouse.click</code></td>
<td>
<p>If TRUE, the user clicks where the starting point for the otolith contour extraction algorithm should start. Default is the center of the image. Could be good to set as TRUE if the otolith detection produces an error.</p>
</td></tr>
<tr><td><code id="detect.outline_+3A_display.images">display.images</code></td>
<td>
<p>If TRUE, each image is displayed and the user can visualize how the outline is captured</p>
</td></tr>
<tr><td><code id="detect.outline_+3A_write.outline.w.org">write.outline.w.org</code></td>
<td>
<p>If TRUE, the outline is written on top of the original image using the function <code><a href="#topic+write.image.with.outline">write.image.with.outline</a></code>, and can be seen in the <code>Original_with_outline</code> folder</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Based on the Conte function (Claude 2008)
</p>


<h3>Value</h3>

<p>A <code><a href="#topic+shapeR-class">shapeR</a></code> object with otolith outlines in the slot outline.list
</p>


<h3>Author(s)</h3>

<p>Lisa Anne Libungan &amp; Snaebjorn Palsson
</p>


<h3>References</h3>

<p>Claude, J. (2008). Morphometrics with R. Springer. 316 p.
</p>
<p>Urbanek, S. (2014). <code><a href="grDevices.html#topic+jpeg">jpeg</a></code>: Read and write JPEG images. R package  version 0.1-8.
</p>
<p>Bivand, R., Leisch, F. &amp; Maechler, M. (2011) <code><a href="pixmap.html#topic+pixmap">pixmap</a></code>: Bitmap Images (&rdquo;Pixel Maps&rdquo;). R package version 0.4-11.
</p>
<p>Libungan LA and Palsson S (2015) ShapeR: An R Package to Study Otolith Shape Variation among Fish Populations. PLoS ONE 10(3): e0121102. <a href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0121102">https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0121102</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
#Use test data from Libungan and Palsson (2015):
shape = shapeR("ShapeAnalysis/","FISH.csv")
shape = detect.outline(shape, threshold=0.2,write.outline.w.org = TRUE)
## End(Not run)
</code></pre>

<hr>
<h2 id='enrich.master.list'>Link information in the info.file to the coefficients obtained from the otolith images</h2><span id='topic+enrich.master.list'></span>

<h3>Description</h3>

<p>Link the original info file to the otolith coefficients
</p>


<h3>Usage</h3>

<pre><code class='language-R'>enrich.master.list(object, folder_name = "folder", pic_name = "picname",
                   calibration = "cal", include.wavelet = TRUE, include.fourier = TRUE,
                   n.wavelet.levels = 5, n.fourier.freq = 12,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="enrich.master.list_+3A_object">object</code></td>
<td>
<p>A <code><a href="#topic+shapeR-class">shapeR</a></code> object</p>
</td></tr>
<tr><td><code id="enrich.master.list_+3A_folder_name">folder_name</code></td>
<td>
<p>Should contain the first letters of the area and the serie or station number of the sample, for example: &quot;IC&quot;</p>
</td></tr>
<tr><td><code id="enrich.master.list_+3A_pic_name">pic_name</code></td>
<td>
<p>Should contain the serie number of a given sample and fish number, for example &quot;403_2&quot; (not including the .jpg extension)</p>
</td></tr>
<tr><td><code id="enrich.master.list_+3A_calibration">calibration</code></td>
<td>
<p>The name of the column where the pixels to measurement calibration is located</p>
</td></tr>
<tr><td><code id="enrich.master.list_+3A_include.wavelet">include.wavelet</code></td>
<td>
<p>If TRUE, the wavelet coefficient are included in the master.list</p>
</td></tr>
<tr><td><code id="enrich.master.list_+3A_include.fourier">include.fourier</code></td>
<td>
<p>If TRUE then the Normalized Elliptic Fourier coefficients are included in the master.list</p>
</td></tr>
<tr><td><code id="enrich.master.list_+3A_n.wavelet.levels">n.wavelet.levels</code></td>
<td>
<p>Integer saying how many levels of wavelet levels should be included</p>
</td></tr>
<tr><td><code id="enrich.master.list_+3A_n.fourier.freq">n.fourier.freq</code></td>
<td>
<p>Integer saying how many Fourier frequency levels should be included</p>
</td></tr>
<tr><td><code id="enrich.master.list_+3A_...">...</code></td>
<td>
<p>Additional parameter for <code>read.csv</code> for reading the info.file</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="#topic+shapeR-class">shapeR</a></code> object with values in slots:
</p>

<ul>
<li><p> wavelet.coef
</p>
</li>
<li><p> fourier.coef
</p>
</li>
<li><p> shape
</p>
</li>
<li><p> filter
</p>
</li>
<li><p> master.list
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Lisa Anne Libungan
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(shape)
shape = generateShapeCoefficients(shape)

shape = enrich.master.list(shape)

</code></pre>

<hr>
<h2 id='estimate.outline.reconstruction'>Estimate the outline reconstruction based on Fourier/wavelet compared to the outlines that have not been transformed</h2><span id='topic+estimate.outline.reconstruction'></span>

<h3>Description</h3>

<p>Estimate outline reconstruction using a different number of coefficients of wavelet and Fourier compared to the original otolith
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estimate.outline.reconstruction(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="estimate.outline.reconstruction_+3A_object">object</code></td>
<td>
<p><code><a href="#topic+shapeR-class">shapeR</a></code> object</p>
</td></tr>
<tr><td><code id="estimate.outline.reconstruction_+3A_...">...</code></td>
<td>
<p>Additional parameters to be passed to 'plot' and 'points'</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing values
</p>

<ul>
<li><p> w.dev.m a list for number of coefficients for mean error of wavelet reconstruction
</p>
</li>
<li><p> w.dev.sd a list for number of coefficients for standard deviation of wavelet reconstruction
</p>
</li>
<li><p> f.power.total Fourier power for number of Fourier harmonics
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Lisa Anne Libungan
</p>


<h3>References</h3>

<p>Claude, J. (2008) Morphometrics with R. Springer. 316 p.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(shape)
estimate.outline.reconstruction(shape)
## End(Not run)

</code></pre>

<hr>
<h2 id='FISH'>An example data file</h2><span id='topic+FISH'></span>

<h3>Description</h3>

<p>The file's columns are:
</p>

<ul>
<li><p> country
</p>
</li>
<li><p> station
</p>
</li>
<li><p> pop
</p>
</li>
<li><p> stockID
</p>
</li>
<li><p> day
</p>
</li>
<li><p> month
</p>
</li>
<li><p> year
</p>
</li>
<li><p> lat
</p>
</li>
<li><p> lon
</p>
</li>
<li><p> fishno
</p>
</li>
<li><p> length_cm
</p>
</li>
<li><p> weight_g
</p>
</li>
<li><p> age
</p>
</li>
<li><p> sex
</p>
</li>
<li><p> maturity
</p>
</li>
<li><p> folder
</p>
</li>
<li><p> picname
</p>
</li>
<li><p> cal
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>data(FISH)
</code></pre>


<h3>Format</h3>

<p>An example data file
</p>


<h3>Source</h3>

<p><a href="https://github.com/lisalibungan/shapeR">https://github.com/lisalibungan/shapeR</a>
</p>

<hr>
<h2 id='generateShapeCoefficients'>Get wavelet/Fourier coefficients and basic shape variables</h2><span id='topic+generateShapeCoefficients'></span>

<h3>Description</h3>

<p>Generates shape variables based on Fourier/wavelet reconstruction. Wavelet coefficients for wavelet. Basic shape parameters are also collected (area, length, width, perimeter).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>generateShapeCoefficients(object,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="generateShapeCoefficients_+3A_object">object</code></td>
<td>
<p><code><a href="#topic+shapeR-class">shapeR</a></code> object</p>
</td></tr>
<tr><td><code id="generateShapeCoefficients_+3A_...">...</code></td>
<td>
<p>Additional parameters to be passed to the <code><a href="wavethresh.html#topic+wd">wd</a></code> function of the <code><a href="wavethresh.html#topic+wavethresh">wavethresh</a></code> package for the wavelet decomposition of the otolith outlines</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="#topic+shapeR-class">shapeR</a></code> object with values in slots:
</p>

<ul>
<li><p> wavelet.coef.raw
</p>
</li>
<li><p> fourier.coef.raw
</p>
</li>
<li><p> shape.coef.raw
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Lisa Anne Libungan &amp; Snaebjorn Palsson
</p>


<h3>References</h3>

<p>Nason, G. (2012). <code><a href="wavethresh.html#topic+wavethresh">wavethresh</a></code>: Wavelets statistics and transforms. R package, version 4.5.
</p>
<p>Claude, J. (2008). Morphometrics with R. Springer. 316 p.
</p>


<h3>See Also</h3>

<p><code><a href="wavethresh.html#topic+wavethresh">wavethresh</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(shape)
shape = generateShapeCoefficients(shape)
</code></pre>

<hr>
<h2 id='getFourier'>Get Fourier coefficients, filtered according to filter</h2><span id='topic+getFourier'></span>

<h3>Description</h3>

<p>Returns the Fourier coefficients determined in <code><a href="#topic+stdCoefs">stdCoefs</a></code>.
Returns only values as set in <code><a href="#topic+setFilter">setFilter</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getFourier(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getFourier_+3A_object">object</code></td>
<td>
<p><code><a href="#topic+shapeR-class">shapeR</a></code> object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The Fourier coefficients for all fish as determined by <code><a href="#topic+setFilter">setFilter</a></code>
</p>


<h3>Author(s)</h3>

<p>Lisa Anne Libungan
</p>

<hr>
<h2 id='getMasterlist'>Get filtered master.list values</h2><span id='topic+getMasterlist'></span>

<h3>Description</h3>

<p>Returns selected values from <code>master.list</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getMasterlist(object, useFilter = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getMasterlist_+3A_object">object</code></td>
<td>
<p><code><a href="#topic+shapeR-class">shapeR</a></code> object</p>
</td></tr>
<tr><td><code id="getMasterlist_+3A_usefilter">useFilter</code></td>
<td>
<p>If TRUE, the master.list values are filtered by the slot <code>filter</code>. FALSE = no filtering.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The <code>master.list</code> is filtered by the slot <code>filter</code> if the <code>useFilter</code> is TRUE, else no filtering is done.
</p>


<h3>Author(s)</h3>

<p>Lisa Anne Libungan
</p>

<hr>
<h2 id='getMeasurements'>Get simple shape variables, filtered according to filter</h2><span id='topic+getMeasurements'></span>

<h3>Description</h3>

<p>Returns shape variables length, width, perimeter and area determined in <code><a href="#topic+generateShapeCoefficients">generateShapeCoefficients</a></code>.
Returns only values as set in the slot <code>filter</code>.
These variables can only be obtained if the calibration measurements in pixels have been registered in the csv data file in a column labelled 'cal' (see example data file). To get the calibration measurements, use a image manipulation program and measure 1mm on the calibration measurement stick (that was taken for that particular dataset) and register how many pixels 1mm is into the column 'cal'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getMeasurements(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getMeasurements_+3A_object">object</code></td>
<td>
<p><code><a href="#topic+shapeR-class">shapeR</a></code> object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with all valid fish as determined by the slot <code>filter</code> and with columns:
</p>

<ul>
<li><p> otolith.area
</p>
</li>
<li><p> otolith.length
</p>
</li>
<li><p> otolith.width
</p>
</li>
<li><p> otolith.perimeter
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Lisa Anne Libungan
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(shape)
# Calculate the mean otolith area for each fish population
# The results are in square mm since the calibration ('cal') column
# in the data file is in pixels (1 mm/pixel).
tapply(getMeasurements(shape)$otolith.area, getMasterlist(shape)$pop,mean)
</code></pre>

<hr>
<h2 id='getStdFourier'>Get standardized Fourier coefficients, filtered according to filter</h2><span id='topic+getStdFourier'></span>

<h3>Description</h3>

<p>Returns the standardized Fourier coefficients determined in  <code><a href="#topic+stdCoefs">stdCoefs</a></code>.
Returns only values as set in the slot <code>filter</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getStdFourier(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getStdFourier_+3A_object">object</code></td>
<td>
<p><code><a href="#topic+shapeR-class">shapeR</a></code> object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The standardized Fourier coefficients for all valid fish as determined by the slot <code>filter</code>
</p>


<h3>Author(s)</h3>

<p>Lisa Anne Libungan
</p>

<hr>
<h2 id='getStdMeasurements'>Get simple shape variables after standardization, filtered according to filter</h2><span id='topic+getStdMeasurements'></span>

<h3>Description</h3>

<p>Returns the simple shape variables determined in <code>stdCoefs</code>.
Returns only values as set in the slot <code>filter</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getStdMeasurements(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getStdMeasurements_+3A_object">object</code></td>
<td>
<p><code><a href="#topic+shapeR-class">shapeR</a></code> object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with all valid fish as determined by the slot <code>filter</code>. Returns only variables that have not been removed after standardization.
</p>


<h3>Author(s)</h3>

<p>Lisa Anne Libungan
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(shape)
#Calculate the mean standardized otolith length for each fish population
tapply(getStdMeasurements(shape)$otolith.length,
getMasterlist(shape)$pop,mean)
</code></pre>

<hr>
<h2 id='getStdWavelet'>Get standardized wavelet coefficients, filtered according to filter</h2><span id='topic+getStdWavelet'></span>

<h3>Description</h3>

<p>Returns the standardized wavelet coefficients determined in  <code>stdCoefs</code>.
Returns only values as set in the slot <code>filter</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getStdWavelet(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getStdWavelet_+3A_object">object</code></td>
<td>
<p><code><a href="#topic+shapeR-class">shapeR</a></code> object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The standardized wavelet coefficients for all valid fish as determined by the slot <code>filter</code>
</p>


<h3>Author(s)</h3>

<p>Lisa Anne Libungan
</p>

<hr>
<h2 id='getWavelet'>Get wavelet coefficients, filtered according to filter</h2><span id='topic+getWavelet'></span>

<h3>Description</h3>

<p>Returns the wavelet coefficients determined in <code><a href="#topic+generateShapeCoefficients">generateShapeCoefficients</a></code>.
Returns only values as set in the slot <code>filter</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getWavelet(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getWavelet_+3A_object">object</code></td>
<td>
<p><code><a href="#topic+shapeR-class">shapeR</a></code> object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The wavelet coefficients for all valid fish as determined by the slot <code>filter</code>
</p>


<h3>Author(s)</h3>

<p>Lisa Anne Libungan
</p>

<hr>
<h2 id='outline.reconstruction.plot'>Plot outline reconstruction</h2><span id='topic+outline.reconstruction.plot'></span>

<h3>Description</h3>

<p>Show graphs of the reconstruction using different number of levels of wavelet reconstruction and Fourier power using different number of Fourier harmonics.
Uses the output from <a href="#topic+estimate.outline.reconstruction">estimate.outline.reconstruction</a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>outline.reconstruction.plot(outline.rec.list,ref.w.level=5,
                            ref.f.harmonics=12,max.num.harmonics=32,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="outline.reconstruction.plot_+3A_outline.rec.list">outline.rec.list</code></td>
<td>
<p>The output from <a href="#topic+estimate.outline.reconstruction">estimate.outline.reconstruction</a></p>
</td></tr>
<tr><td><code id="outline.reconstruction.plot_+3A_ref.w.level">ref.w.level</code></td>
<td>
<p>Reference level for graphical purposes. The default is 5 as is the default of <a href="#topic+shapeR-class">shapeR</a>.</p>
</td></tr>
<tr><td><code id="outline.reconstruction.plot_+3A_ref.f.harmonics">ref.f.harmonics</code></td>
<td>
<p>Reference Fourier harmonize. The default is 12 as is the default in <a href="#topic+shapeR-class">shapeR</a>.</p>
</td></tr>
<tr><td><code id="outline.reconstruction.plot_+3A_max.num.harmonics">max.num.harmonics</code></td>
<td>
<p>Maxinum number of Fourier harmonics to be shown</p>
</td></tr>
<tr><td><code id="outline.reconstruction.plot_+3A_...">...</code></td>
<td>
<p>Additional parameters to be passed to 'plot'</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None
</p>


<h3>Author(s)</h3>

<p>Lisa Anne Libungan
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: data(shape)
est.list = estimate.outline.reconstruction(shape)
outline.reconstruction.plot(est.list,panel.first = grid())
## End(Not run)
</code></pre>

<hr>
<h2 id='plotFourier'>Mean and standard deviation of the Fourier coefficients</h2><span id='topic+plotFourier'></span>

<h3>Description</h3>

<p>The mean and standard deviation of the Fourier coefficients
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotFourier(object, coef.index=NULL,class.name=NULL,useStdcoef=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotFourier_+3A_object">object</code></td>
<td>
<p><code><a href="#topic+shapeR-class">shapeR</a></code> object</p>
</td></tr>
<tr><td><code id="plotFourier_+3A_coef.index">coef.index</code></td>
<td>
<p>An index vector for which fourier coefficents to be shown. Default is <code>NULL</code> and all coefficients are shown.</p>
</td></tr>
<tr><td><code id="plotFourier_+3A_class.name">class.name</code></td>
<td>
<p>Column name in master list for partitioning the data into groups and showing the ratio of variance among to the sum of variance among and variance within.</p>
</td></tr>
<tr><td><code id="plotFourier_+3A_usestdcoef">useStdcoef</code></td>
<td>
<p>Boolean saying if to use the standardized coefficients or not</p>
</td></tr>
<tr><td><code id="plotFourier_+3A_...">...</code></td>
<td>
<p>Additional parameters to be passed to 'plot'</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None
</p>


<h3>Author(s)</h3>

<p>Lisa Anne Libungan
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(shape)
shape = stdCoefs(shape,classes="pop","length_cm")
plotFourier(shape,class.name= "pop",useStdcoef=TRUE)
</code></pre>

<hr>
<h2 id='plotFourierShape'>Mean otolith shape based on Fourier reconstruction</h2><span id='topic+plotFourierShape'></span>

<h3>Description</h3>

<p>A function for showing the mean otolith shape based on Fourier reconstruction
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotFourierShape(object, class.name, show.angle = FALSE,lty=1:5,col=1:6, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotFourierShape_+3A_object">object</code></td>
<td>
<p>A <code><a href="#topic+shapeR-class">shapeR</a></code> object</p>
</td></tr>
<tr><td><code id="plotFourierShape_+3A_class.name">class.name</code></td>
<td>
<p>A string as the column name in the master list</p>
</td></tr>
<tr><td><code id="plotFourierShape_+3A_show.angle">show.angle</code></td>
<td>
<p>If TRUE angles are shown on the plot</p>
</td></tr>
<tr><td><code id="plotFourierShape_+3A_lty">lty</code>, <code id="plotFourierShape_+3A_col">col</code></td>
<td>
<p>Vector of line types and colors. Values are used cyclically.</p>
</td></tr>
<tr><td><code id="plotFourierShape_+3A_...">...</code></td>
<td>
<p>Additional parameters to be passed to 'plot'</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None
</p>


<h3>Author(s)</h3>

<p>Lisa Anne Libungan
</p>


<h3>References</h3>

<p>Libungan LA and Palsson S (2015) ShapeR: An R Package to Study Otolith Shape Variation among Fish Populations. PLoS ONE 10(3): e0121102. <a href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0121102">https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0121102</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(shape)
plotFourierShape(shape, "pop",show.angle = TRUE,lwd=2,lty=1)
</code></pre>

<hr>
<h2 id='plotWavelet'>Mean and standard deviation of the wavelet coefficients</h2><span id='topic+plotWavelet'></span>

<h3>Description</h3>

<p>The mean and standard deviation of tdhe wavelet coefficients
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotWavelet(object, level, start.angle = 0, class.name=NULL,useStdcoef=FALSE,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotWavelet_+3A_object">object</code></td>
<td>
<p>A <code><a href="#topic+shapeR-class">shapeR</a></code> object</p>
</td></tr>
<tr><td><code id="plotWavelet_+3A_level">level</code></td>
<td>
<p>The wavelet level to be shown</p>
</td></tr>
<tr><td><code id="plotWavelet_+3A_start.angle">start.angle</code></td>
<td>
<p>The angle in degrees, the x-axis should start on</p>
</td></tr>
<tr><td><code id="plotWavelet_+3A_class.name">class.name</code></td>
<td>
<p>Column name in master list for partitioning the data into groups and showing the ratio of variation among groups.</p>
</td></tr>
<tr><td><code id="plotWavelet_+3A_usestdcoef">useStdcoef</code></td>
<td>
<p>Choose &quot;TRUE&quot; or &quot;FALSE&quot; if coefficients should be standardized or not</p>
</td></tr>
<tr><td><code id="plotWavelet_+3A_...">...</code></td>
<td>
<p>Additional parameters to be passed to 'plot'</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None
</p>


<h3>Author(s)</h3>

<p>Lisa Anne Libungan
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(shape)
shape = stdCoefs(shape,classes="pop","length_cm")
plotWavelet(shape,level=5,class.name= "pop",useStdcoef=TRUE)
</code></pre>

<hr>
<h2 id='plotWaveletShape'>Mean otolith shape based on wavelet reconstruction</h2><span id='topic+plotWaveletShape'></span>

<h3>Description</h3>

<p>A function for showing the mean otolith shape based on wavelet reconstruction
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotWaveletShape(object, class.name,show.angle=FALSE,lty=1:5,col=1:6,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotWaveletShape_+3A_object">object</code></td>
<td>
<p>A <code><a href="#topic+shapeR-class">shapeR</a></code> object</p>
</td></tr>
<tr><td><code id="plotWaveletShape_+3A_class.name">class.name</code></td>
<td>
<p>A string as the column name in the master list</p>
</td></tr>
<tr><td><code id="plotWaveletShape_+3A_show.angle">show.angle</code></td>
<td>
<p>If TRUE angles are shown on the plot</p>
</td></tr>
<tr><td><code id="plotWaveletShape_+3A_lty">lty</code>, <code id="plotWaveletShape_+3A_col">col</code></td>
<td>
<p>Vector of line types and colors. Values are used cyclically.</p>
</td></tr>
<tr><td><code id="plotWaveletShape_+3A_...">...</code></td>
<td>
<p>Additional parameters to be passed to 'plot'</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None
</p>


<h3>Author(s)</h3>

<p>Lisa Anne Libungan
</p>


<h3>References</h3>

<p>Nason, G. (2012) <code><a href="wavethresh.html#topic+wavethresh">wavethresh</a></code>: Wavelets statistics and transforms, version 4.5. R package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(shape)
plotWaveletShape(shape, "pop",show.angle = TRUE,lwd=2,lty=1)
</code></pre>

<hr>
<h2 id='read.master.list'>Read updated master list</h2><span id='topic+read.master.list'></span>

<h3>Description</h3>

<p>Reads an updated master list. This is important to run if you want to ensure that a updated master list is used in the analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read.master.list(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="read.master.list_+3A_object">object</code></td>
<td>
<p>A <code><a href="#topic+shapeR-class">shapeR</a></code> object</p>
</td></tr>
<tr><td><code id="read.master.list_+3A_...">...</code></td>
<td>
<p>Additional parameter for <code>read.csv</code> for reading the info.file</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code><a href="#topic+shapeR-class">shapeR</a></code> object with values in slots:
</p>

<ul>
<li><p> master.list.org
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Lisa Anne Libungan
</p>

<hr>
<h2 id='remove.outline'>Remove otolith outline</h2><span id='topic+remove.outline'></span>

<h3>Description</h3>

<p>A function for removing an otolith outline from the file 'outline.list'. Typically done if the image is of bad quality and needs to be enhanced in a image processing software
</p>


<h3>Usage</h3>

<pre><code class='language-R'>remove.outline(object, folder = "", fname = "")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="remove.outline_+3A_object">object</code></td>
<td>
<p>A <code><a href="#topic+shapeR-class">shapeR</a></code> object</p>
</td></tr>
<tr><td><code id="remove.outline_+3A_folder">folder</code></td>
<td>
<p>The folder name where the outline that needs to be removed is stored</p>
</td></tr>
<tr><td><code id="remove.outline_+3A_fname">fname</code></td>
<td>
<p>The file name of the outline to be removed</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code><a href="#topic+shapeR-class">shapeR</a></code> object
</p>


<h3>Author(s)</h3>

<p>Lisa Anne Libungan
</p>


<h3>References</h3>

<p>Libungan LA and Palsson S (2015) ShapeR: An R Package to Study Otolith Shape Variation among Fish Populations. PLoS ONE 10(3): e0121102. <a href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0121102">https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0121102</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
#Use test data from example in Libungan and Palsson (2015):
shape = shapeR("ShapeAnalysis/","FISH.csv")
shape = detect.outline(shape)
#If otolith outline in folder IC named 403_1 needs to be removed
shape = remove.outline(shape, "IC", "403_1")
## End(Not run)
</code></pre>

<hr>
<h2 id='setFilter'>Set a filter to analyze the shape data</h2><span id='topic+setFilter'></span>

<h3>Description</h3>

<p>Sets a filter on <code>master.list</code>. Here it is possible to filter the <code>master.list</code> by specific ages, maturity stages, areas, etc.
If no value is set, all data with shape parameters are used
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setFilter(object, filter)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="setFilter_+3A_object">object</code></td>
<td>
<p>A <code><a href="#topic+shapeR-class">shapeR</a></code> object</p>
</td></tr>
<tr><td><code id="setFilter_+3A_filter">filter</code></td>
<td>
<p>A vector restricting the new filter value. Only otoliths having shape parameters are selected.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="#topic+shapeR-class">shapeR</a></code> object with the slot <code>filter</code> set.
</p>


<h3>Author(s)</h3>

<p>Lisa Anne Libungan
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(shape)
#Filter only Icelandic and Norwegian samples
shape = setFilter(shape,
getMasterlist(shape, useFilter = FALSE)$pop %in% c("NO","IC"))
table(getMasterlist(shape)$pop)
#Reset filter
shape = setFilter(shape)
table(getMasterlist(shape)$pop)
</code></pre>

<hr>
<h2 id='shape'>An example shapeR instance including 160 images.</h2><span id='topic+shape'></span>

<h3>Description</h3>

<p>The shape coefficients have been generated.
The wavelet coefficients have been standardized using pop and length_cm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(shape)
</code></pre>


<h3>Format</h3>

<p>A shapeR class including 160 images
</p>


<h3>Details</h3>

<p>The class slot's are as follows:
</p>

<ul>
<li><p> project.path. A path as &quot;ShapeAnalysis/&quot;
</p>
</li>
<li><p> info.file. A file as FISH.csv. The information is stored in the data frame master.list
</p>
</li>
<li><p> outline.list. A list with three elements (IC, NO, SC) which give a list of the otolith outlines
</p>
</li>
<li><p> filter. A logical vector showing which elements of the master list have valid otoliths
</p>
</li>
<li><p> fourier.coef. A matrix of the Normalized Elliptic Fourier coefficients
</p>
</li>
<li><p> wavelet.coef. A matrix of the wavelet coefficients
</p>
</li>
<li><p> shape. A matrix of shape variables after scaling according to calibration otolith.area, otolith.length, otolith.width, otolith.perimeter.
</p>
</li>
<li><p> fourier.coef.std. A matrix which will contain standardized Fourier coefficients
</p>
</li>
<li><p> wavelet.coef.std. A matrix which will contain standardized wavelet coefficients
</p>
</li>
<li><p> shape.coef.raw. A matrix of shape variables before scaling according to calibration otolith.area, otolith.length, otolith.width, otolith.perimeter.
</p>
</li>
<li><p> master.list. The contents of the info.file
</p>
</li></ul>



<h3>Source</h3>

<p><a href="https://github.com/lisalibungan/shapeR">https://github.com/lisalibungan/shapeR</a>
</p>

<hr>
<h2 id='shapeR'>shapeR</h2><span id='topic+shapeR'></span><span id='topic+shapeR-class'></span>

<h3>Description</h3>

<p>Collection and analysis of otolith shape data
</p>
<p>a shapeR class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>shapeR(project.path, info.file, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="shapeR_+3A_project.path">project.path</code></td>
<td>
<p>The base project path where the images are stored</p>
</td></tr>
<tr><td><code id="shapeR_+3A_info.file">info.file</code></td>
<td>
<p>The information file which store the information on the fish and otoliths. This is the base for the master.list</p>
</td></tr>
<tr><td><code id="shapeR_+3A_...">...</code></td>
<td>
<p>Additional parameters to be passed to 'read.csv' for reading the info.file</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code><a href="#topic+shapeR-class">shapeR</a></code> object
</p>


<h3>Slots</h3>


<dl>
<dt><code>project.path</code></dt><dd><p>Path to the project where the images are stored</p>
</dd>
<dt><code>info.file</code></dt><dd><p>Info file containing fish and otolith information</p>
</dd>
<dt><code>master.list.org</code></dt><dd><p>The contents of the <code>info.file</code></p>
</dd>
<dt><code>master.list</code></dt><dd><p>The contents of the <code>info.file</code> with added shape parameters and descriptors</p>
</dd>
<dt><code>outline.list.org</code></dt><dd><p>A list of all the original otolith outlines</p>
</dd>
<dt><code>outline.list</code></dt><dd><p>A list of all the otolith outlines. It returns a list of smoothed if contour smoothing (using<code>smoothout</code>) has been conducted.</p>
</dd>
<dt><code>filter</code></dt><dd><p>A logical vector selecting the otoliths used for analysis</p>
</dd>
<dt><code>wavelet.coef.raw</code></dt><dd><p>The wavelet coefficients for all the otolith outlines</p>
</dd>
<dt><code>wavelet.coef</code></dt><dd><p>The wavelet coefficients after aligning with the <code>info.file</code>. The data is generated when <a href="#topic+enrich.master.list">enrich.master.list</a> is run</p>
</dd>
<dt><code>wavelet.coef.std</code></dt><dd><p>The standardized wavelet coefficients. The data is generated when <a href="#topic+stdCoefs">stdCoefs</a> is run</p>
</dd>
<dt><code>wavelet.coef.std.removed</code></dt><dd><p>The index of the removed wavelet coefficients after standardization. The data is generated when <a href="#topic+stdCoefs">stdCoefs</a> is run</p>
</dd>
<dt><code>fourier.coef.raw</code></dt><dd><p>The Fourier coefficients for all the otolith outlines</p>
</dd>
<dt><code>fourier.coef</code></dt><dd><p>The Fourier coefficients for after aligning with the info file. The data is generated when <a href="#topic+enrich.master.list">enrich.master.list</a> is run</p>
</dd>
<dt><code>fourier.coef.std</code></dt><dd><p>The standardized Fourier coefficients. The data is generated when <a href="#topic+stdCoefs">stdCoefs</a> is run</p>
</dd>
<dt><code>fourier.coef.std.removed</code></dt><dd><p>The index of the removed Fourier coefficents after standardization. The data is generated when <a href="#topic+stdCoefs">stdCoefs</a> is run</p>
</dd>
<dt><code>shape.coef.raw</code></dt><dd><p>The uncalibrated shape measurements for all the otoliths. The shape parameters are: otolith.area, otolith.length, otolith.width, otolith.perimeter</p>
</dd>
<dt><code>shape.coef</code></dt><dd><p>The shape measurements for after aligning with the info file. The shape parameters have been calibrated using the calibration parameter as registered in the datafile as the column 'cal'.</p>
</dd>
<dt><code>shape.std</code></dt><dd><p>The standardized shape measurements. The data is generated when <a href="#topic+stdCoefs">stdCoefs</a> is run</p>
</dd>
<dt><code>shape.std.removed</code></dt><dd><p>The index of the removed shape measurements after standardization. The data is generated when <a href="#topic+stdCoefs">stdCoefs</a> is run</p>
</dd>
</dl>


<h3>Author(s)</h3>

<p>Lisa Anne Libungan &amp; Snaebjorn Palsson
</p>


<h3>References</h3>

<p>Libungan LA and Palsson S (2015) ShapeR: An R Package to Study Otolith Shape Variation among Fish Populations. PLoS ONE 10(3): e0121102. <a href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0121102">https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0121102</a>
</p>


<h3>See Also</h3>

<p><a href="https://github.com/lisalibungan/shapeR">https://github.com/lisalibungan/shapeR</a>
</p>
<p><code><a href="#topic+plotWavelet">plotWavelet</a></code>
</p>
<p><code><a href="#topic+plotFourier">plotFourier</a></code>
</p>
<p><code><a href="#topic+plotWaveletShape">plotWaveletShape</a></code>
</p>
<p><code><a href="#topic+plotFourierShape">plotFourierShape</a></code>
</p>
<p><code><a href="vegan.html#topic+capscale">capscale</a></code>
</p>
<p><code><a href="#topic+cluster.plot">cluster.plot</a></code>
</p>
<p><code><a href="#topic+setFilter">setFilter</a></code>
</p>
<p><code><a href="MASS.html#topic+lda">lda</a></code>
</p>
<p><code><a href="#topic+detect.outline">detect.outline</a></code>
</p>
<p><code><a href="#topic+generateShapeCoefficients">generateShapeCoefficients</a></code>
</p>
<p><code><a href="#topic+enrich.master.list">enrich.master.list</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 

# This example has two sections: (1) Demonstration of how a shapeR object
# is analyzed and (2) How to create a shapeR object from an archive of
# image files.

#-----------------------------------------
# Section 1: Analyzing a shapeR object

data(shape)

#Standardize coefficients
shape = stdCoefs(shape,"pop","length_cm")

#Visualize Wavelet and Fourier coefficients
plotWavelet(shape,level=5,class.name= "pop",useStdcoef=TRUE)
plotFourier(shape,class.name= "pop",useStdcoef=TRUE)

#Examine the mean shapes
plotWaveletShape(shape, "pop",show.angle = TRUE,lwd=2,lty=1)
plotFourierShape(shape, "pop",show.angle = TRUE,lwd=2,lty=1)

#Canonical analysis
library(vegan)
cap.res = capscale(getStdWavelet(shape) ~ getMasterlist(shape)$pop)
anova(cap.res)

#Visualize the canonical scores
eig=eigenvals(cap.res,constrained=TRUE)
eig.ratio = eig/sum(eig)

cluster.plot(scores(cap.res)$sites[,1:2],getMasterlist(shape)$pop
,plotCI=TRUE
,xlab=paste("CAP1 (",round(eig.ratio[1]*100,1),"%)",sep="")
,ylab=paste("CAP2 (",round(eig.ratio[2]*100,1),"%)",sep="")
,main="Canonical clustering"
)

#Only analyze Icelandic and Norwegian samples
shape = setFilter(shape, getMasterlist(shape, useFilter = FALSE)$pop %in% c("NO","IC"))

#Classifier on standardized wavelet
lda.res.w = lda(getStdWavelet(shape),getMasterlist(shape)$pop,CV=TRUE)
ct.w = table(getMasterlist(shape)$pop,lda.res.w$class)

diag(prop.table(ct.w, 1))

# Total percent correct
sum(diag(prop.table(ct.w)))

cap.res = capscale(getStdWavelet(shape) ~ getMasterlist(shape)$pop)
anova(cap.res)

#Classifier on canoncial values
lda.res.w = lda(scores(cap.res)$sites,getMasterlist(shape)$pop,CV=TRUE)
ct.w = table(getMasterlist(shape)$pop,lda.res.w$class)

diag(prop.table(ct.w, 1))

# Total percent correct
sum(diag(prop.table(ct.w)))

#-----------------------------------------
# Section 2: Creating a shapeR object from image files

# The following example requires the user to download an archive of JPEG
# files from https://github.com/lisalibungan/shapeR/
# place the ShapeAnalysis directory inside the working directory.

shape = shapeR("~/ShapeAnalysis/","FISH.csv")
shape = detect.outline(shape,write.outline.w.org = TRUE)

shape = generateShapeCoefficients(shape)
shape = enrich.master.list(shape)

## End(Not run)
</code></pre>

<hr>
<h2 id='show+2CshapeR-method'>Show a shapeR object</h2><span id='topic+show+2CshapeR-method'></span>

<h3>Description</h3>

<p>Show the project.path and info.file, the number of outlines that have been read and which fundamental methods have been run.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'shapeR'
show(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="show+2B2CshapeR-method_+3A_object">object</code></td>
<td>
<p>a shapeR oject</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None
</p>

<hr>
<h2 id='show.original.with.outline'>Show the extracted outline on top of the original image</h2><span id='topic+show.original.with.outline'></span>

<h3>Description</h3>

<p>A function which displayes the outlines which were extracted from the image in the &quot;Fixed&quot; folder on top of the corresponding image in the &quot;Original&quot; folder.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>show.original.with.outline(object, folder, fname)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="show.original.with.outline_+3A_object">object</code></td>
<td>
<p>A <code><a href="#topic+shapeR-class">shapeR</a></code> object</p>
</td></tr>
<tr><td><code id="show.original.with.outline_+3A_folder">folder</code></td>
<td>
<p>The folder name where the image is stored</p>
</td></tr>
<tr><td><code id="show.original.with.outline_+3A_fname">fname</code></td>
<td>
<p>Image file name. Not including the extension &quot;.jpg&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None
</p>


<h3>Author(s)</h3>

<p>Lisa Anne Libungan
</p>


<h3>References</h3>

<p>Libungan LA and Palsson S (2015) ShapeR: An R Package to Study Otolith Shape Variation among Fish Populations. PLoS ONE 10(3): e0121102. <a href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0121102">https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0121102</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
#Follow the example in Libungan and Palsson (2015) and run the following lines:
show.original.with.outline(shape,"IC","403_2")
## End(Not run)
</code></pre>

<hr>
<h2 id='smoothout'>Contour smoothing</h2><span id='topic+smoothout'></span>

<h3>Description</h3>

<p>Remove high frequency pixel noise around the otolith outline
</p>


<h3>Usage</h3>

<pre><code class='language-R'>smoothout(object, n)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="smoothout_+3A_object">object</code></td>
<td>
<p>A <code><a href="#topic+shapeR-class">shapeR</a></code> object</p>
</td></tr>
<tr><td><code id="smoothout_+3A_n">n</code></td>
<td>
<p>The number of iterations. The default value is 100.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="#topic+shapeR-class">shapeR</a></code> object with smoothed otolith outlines in the slot outline.list
</p>


<h3>Author(s)</h3>

<p>Lisa Anne Libungan
</p>


<h3>References</h3>

<p>Haines, A.J., Crampton, J.S. (2000). Improvements to the method of Fourier shape analysis as applied in morphometric studies. Palaeontology 43: 765-783.
</p>
<p>Claude, J. (2008) Morphometrics with R. Springer. 316 p.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

data(shape)
shape = smoothout(shape,n=100)

# Plot smoothed outline on top of original outline for comparison
outline.org=shape@outline.list.org[["IC"]][["403_2"]]
outline=shape@outline.list[["IC"]][["403_2"]]
plot(outline.org$X,outline.org$Y,type='l',xlab="",ylab="",lwd=2,axes=FALSE)
lines(outline$X,outline$Y,col="red",lwd=2)
legend("bottomleft",c('Original','Smoothed'),lty=1,col=c('black','red'),lwd=2)

</code></pre>

<hr>
<h2 id='stdCoefs'>Standardize coefficients</h2><span id='topic+stdCoefs'></span>

<h3>Description</h3>

<p>Function to standardized the wavelet and Fourier coefficients for a specific parameter such as the fish length.
For each country/population a regression coefficient is calculated as a function of fish length.
If the slope is significantly different from zero, a correction is made according to Lleonart et al 2000.
First ANCOVA is performed: variable ~ pop*length_cm, following a method by Longmore et al 2010.
If there is a significant interaction between population and length_cm, then the coefficients are not used and automatically discarded. If there is no interaction, the
coefficients are kept and standardized with regards to fish length.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stdCoefs(object, classes=NA, std.by, std.type = "mean", p.crit = 0.05,bonferroni= FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="stdCoefs_+3A_object">object</code></td>
<td>
<p>A <code><a href="#topic+shapeR-class">shapeR</a></code> object</p>
</td></tr>
<tr><td><code id="stdCoefs_+3A_classes">classes</code></td>
<td>
<p>The classes to be grouped for standardization. Should be the same as used for the statistical tests</p>
</td></tr>
<tr><td><code id="stdCoefs_+3A_std.by">std.by</code></td>
<td>
<p>The parameter to be used for standardization. Typically the length of the fish from the master.list.</p>
</td></tr>
<tr><td><code id="stdCoefs_+3A_std.type">std.type</code></td>
<td>
<p>The tuning of the standardization. The standardization can be sensitive to what value all the fishes are standardized to. Possible values are:
</p>

<ul>
<li><p> min Standardized as the minimum value of std.by
</p>
</li>
<li><p> mean Standardized as the mean value of std.by
</p>
</li>
<li><p> max Standardized as the maximum value of std.by
</p>
</li></ul>
</td></tr>
<tr><td><code id="stdCoefs_+3A_p.crit">p.crit</code></td>
<td>
<p>An argument used to select the threshold critera for omitting coefficients which show interaction with fish length. If p.crit = 0.05, all coefficients which have p&lt;0.05 are omitted. If p.crit = 0.01, only coefficients with p&lt;0.01 are omitted.</p>
</td></tr>
<tr><td><code id="stdCoefs_+3A_bonferroni">bonferroni</code></td>
<td>
<p>A logical parameter for performing Bonferroni for multiple testing</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="#topic+shapeR-class">shapeR</a></code> object with standardized shape coefficients in the slot shape.std
</p>


<h3>Author(s)</h3>

<p>Lisa Anne Libungan
</p>


<h3>References</h3>

<p>Lleonart, J., Salat, J. &amp; Torres, G.J. (2000) Removing allometric effects of body size in morphological analysis. Journal of Theoretical Biology, 205, 85-93.
</p>
<p>Longmore, C., Fogarty, K., Neat, F., Brophy, D., Trueman, C., Milton, A. &amp; Mariani, S. (2010) A comparison of otolith microchemistry and otolith shape analysis for the study of spatial variation in a deep-sea teleost, <em>Coryphaenoides rupestris</em>. Environmental Biology of Fishes, 89, 591-605.
</p>
<p>Reist, J.D. (1985) An Empirical-Evaluation of Several Univariate Methods That Adjust for Size Variation in Morphometric Data. Canadian Journal of Zoology-Revue Canadienne De Zoologie, 63, 1429-1439.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(shape)
shape = stdCoefs(shape,classes="pop","length_cm")
</code></pre>

<hr>
<h2 id='write.image.with.outline'>Write outlines on top of the original images for quality checking</h2><span id='topic+write.image.with.outline'></span>

<h3>Description</h3>

<p>A function which writes the outlines which were extracted from the images in the folder &quot;Fixed&quot; on top of the corresponding images in the &quot;Original&quot; folder. Viewing the resulted images in the folder &quot;Original_with_outlines&quot; is a good quality check to ensure the correct outline has been extracted. If the outline is not correct, then the image can be fixed in an image software, such as GIMP (www.gimp.org), placed in the &quot;Fixed&quot; folder and then the <code>detect.outline</code> step is repeated.
The function <code><a href="#topic+detect.outline">detect.outline</a></code> calls this function if the parameter <code>write.outline.w.org</code> is set to <code>TRUE</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write.image.with.outline(object, folder = NA, fname = NA, doProgress = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="write.image.with.outline_+3A_object">object</code></td>
<td>
<p>A <code><a href="#topic+shapeR-class">shapeR</a></code> object</p>
</td></tr>
<tr><td><code id="write.image.with.outline_+3A_folder">folder</code></td>
<td>
<p>The folder name where the image is stored</p>
</td></tr>
<tr><td><code id="write.image.with.outline_+3A_fname">fname</code></td>
<td>
<p>Image file name. Not including the extension &quot;.jpg&quot;</p>
</td></tr>
<tr><td><code id="write.image.with.outline_+3A_doprogress">doProgress</code></td>
<td>
<p>If TRUE, a progressbar is shown</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None
</p>


<h3>Author(s)</h3>

<p>Lisa Anne Libungan
</p>


<h3>References</h3>

<p>Libungan LA and Palsson S (2015) ShapeR: An R Package to Study Otolith Shape Variation among Fish Populations. PLoS ONE 10(3): e0121102. <a href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0121102">https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0121102</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
#Use test data from Libungan and Palsson (2015) and run the following lines:
shape = shapeR("ShapeAnalysis/","FISH.csv")
shape = detect.outline(shape,write.outline.w.org = FALSE)
write.image.with.outline(shape)
## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
