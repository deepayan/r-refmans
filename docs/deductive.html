<!DOCTYPE html><html lang="en"><head><title>Help for package deductive</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {deductive}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#deductive'><p>Deductive Data Correction and Imputation</p></a></li>
<li><a href='#correct_typos'><p>Correct typos in restricted numeric data</p></a></li>
<li><a href='#impute_lr'><p>Impute values derived from linear (in)equality restrictions.</p></a></li>
<li><a href='#tree'><p>Solve an optimization problem using a tree algorithm as described in Scholtus (2009)</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Maintainer:</td>
<td>Mark van der Loo &lt;mark.vanderloo@gmail.com&gt;</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Title:</td>
<td>Data Correction and Imputation Using Deductive Methods</td>
</tr>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>Description:</td>
<td>Attempt to repair inconsistencies and missing values in
        data records by using information from valid values and
        validation rules restricting the data.</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.1</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.2.0)</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/data-cleaning/deductive">https://github.com/data-cleaning/deductive</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/data-cleaning/deductive/issues">https://github.com/data-cleaning/deductive/issues</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>methods, lintools, validate, stringdist</td>
</tr>
<tr>
<td>Suggests:</td>
<td>tinytest (&ge; 0.9.5)</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-02-06 09:22:19 UTC; mark</td>
</tr>
<tr>
<td>Author:</td>
<td>Mark van der Loo <a href="https://orcid.org/0000-0002-9807-4686"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [cre, aut],
  Edwin de Jonge <a href="https://orcid.org/0000-0002-6580-4718"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Reijer Idema [ctb]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-02-06 09:40:01 UTC</td>
</tr>
</table>
<hr>
<h2 id='deductive'>Deductive Data Correction and Imputation</h2><span id='topic+deductive'></span><span id='topic+deductive-package'></span>

<h3>Description</h3>

<p>Use data validation restrictions to estimate missing values
or trace and repair certain errors.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Mark van der Loo <a href="mailto:mark.vanderloo@gmail.com">mark.vanderloo@gmail.com</a> (<a href="https://orcid.org/0000-0002-9807-4686">ORCID</a>)
</p>
<p>Authors:
</p>

<ul>
<li><p> Edwin de Jonge (<a href="https://orcid.org/0000-0002-6580-4718">ORCID</a>)
</p>
</li></ul>

<p>Other contributors:
</p>

<ul>
<li><p> Reijer Idema [contributor]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/data-cleaning/deductive">https://github.com/data-cleaning/deductive</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/data-cleaning/deductive/issues">https://github.com/data-cleaning/deductive/issues</a>
</p>
</li></ul>


<hr>
<h2 id='correct_typos'>Correct typos in restricted numeric data</h2><span id='topic+correct_typos'></span><span id='topic+correct_typos+2Cdata.frame+2Cvalidator-method'></span>

<h3>Description</h3>

<p>Attempt to fix violations of linear (in)equality restrictions imposed on a
record by replacing values with values that differ from the original values
by typographical errors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>correct_typos(dat, x, ...)

## S4 method for signature 'data.frame,validator'
correct_typos(dat, x, fixate = NULL, eps = 1e-08, maxdist = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="correct_typos_+3A_dat">dat</code></td>
<td>
<p>An R object holding numeric (integer) data.</p>
</td></tr>
<tr><td><code id="correct_typos_+3A_x">x</code></td>
<td>
<p>An R object holding linear data validation rules</p>
</td></tr>
<tr><td><code id="correct_typos_+3A_...">...</code></td>
<td>
<p>Options to be passed to <code><a href="stringdist.html#topic+stringdist">stringdist</a></code>
which is used to determine the typographic distance between the original
value and candidate solutions. By default, the optimal string alignment distance
is used, with all weights equal to one.</p>
</td></tr>
<tr><td><code id="correct_typos_+3A_fixate">fixate</code></td>
<td>
<p><code>[character]</code> vector of variable names that may not be changed</p>
</td></tr>
<tr><td><code id="correct_typos_+3A_eps">eps</code></td>
<td>
<p><code>[numeric]</code> maximum roundoff error</p>
</td></tr>
<tr><td><code id="correct_typos_+3A_maxdist">maxdist</code></td>
<td>
<p><code>[numeric]</code> maximum allowd typographical distance</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>dat</code>, with values corrected.
</p>


<h3>Details</h3>

<p>The algorithm works by proposing candidate replacement values and checking
whether they are likely to be the result of a typographical error. A value is
accepted as a solution when it resolves at least one equality violation. An
equality restriction <code>a.x=b</code> is considered satisfied when
<code>abs(a.x-b)&lt;eps</code>. Setting <code>eps</code> to one or two units of measurement
allows for robust typographical error detection in the presence of 
roundoff-errors.
</p>
<p>The algorithm is meant to be used on numeric data representing integers.
</p>


<h3>References</h3>


<ul>
<li><p>The first version of the algorithm was described by S. Scholtus (2009). Automatic
correction of simple typing errors in numerical data with balance edits. Statistics 
Netherlands, Discussion Paper <a href="https://www.cbs.nl/nl-nl/achtergrond/2009/48/automatic-correction-of-simple-typing-errors-in-numerical-data-with-balance-edits">09046</a>

</p>
</li>
<li><p>The generalized version of this algorithm that is implemented for this package is
described in M. van der Loo, E. de Jonge and S. Scholtus (2011). Correction of rounding, typing and sign errors with the deducorrect package.
Statistics Netherlands, Discussion Paper <a href="https://www.cbs.nl/nl-nl/achtergrond/2011/51/deductive-imputation-with-the-deducorrect-package">2011019</a>

</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>library(validate)

# example from section 4 in Scholtus (2009)

v &lt;-validate::validator( 
   x1 + x2 == x3
 , x2 == x4
 , x5 + x6 + x7 == x8
 , x3 + x8 == x9
 , x9 - x10 == x11
 )
 

dat &lt;- read.csv(textConnection(
"x1, x2 , x3  , x4 , x5 , x6, x7, x8 , x9   , x10 , x11
1452, 116, 1568, 116, 323, 76, 12, 411,  1979, 1842, 137
1452, 116, 1568, 161, 323, 76, 12, 411,  1979, 1842, 137
1452, 116, 1568, 161, 323, 76, 12, 411, 19979, 1842, 137
1452, 116, 1568, 161,   0,  0,  0, 411, 19979, 1842, 137
1452, 116, 1568, 161, 323, 76, 12,   0, 19979, 1842, 137"
))
cor &lt;- correct_typos(dat,v)
dat - cor




</code></pre>

<hr>
<h2 id='impute_lr'>Impute values derived from linear (in)equality restrictions.</h2><span id='topic+impute_lr'></span><span id='topic+impute_lr+2Cdata.frame+2Cvalidator-method'></span>

<h3>Description</h3>

<p>Partially filled records <code class="reqn">\boldsymbol{x}</code> under linear (in)equality
restrictions may reveal unique imputation solutions when the system
of linear inequalities is reduced by substituting observed values.
This function applies a number of fast heuristic methods before
deriving all variable ranges and unique values using Fourier-Motzkin
elimination.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>impute_lr(dat, x, ...)

## S4 method for signature 'data.frame,validator'
impute_lr(dat, x, methods = c("zeros", "piv", "implied"), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="impute_lr_+3A_dat">dat</code></td>
<td>
<p>an R object carrying data</p>
</td></tr>
<tr><td><code id="impute_lr_+3A_x">x</code></td>
<td>
<p>an R object carrying validation rules</p>
</td></tr>
<tr><td><code id="impute_lr_+3A_...">...</code></td>
<td>
<p>arguments to be passed to other methods.</p>
</td></tr>
<tr><td><code id="impute_lr_+3A_methods">methods</code></td>
<td>
<p>What methods to use. Add 'fm' to also compute variable ranges
using fourier-motzkin elimination (can be slow and may use a lot of memory).</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The Fourier-Motzkin elimination method can use large amounts of memory and
may be slow. When memory allocation fails for a ceratian record, the method
is skipped for that record with a message. This means that there may be
unique values to be derived but it is too computationally costly on the
current hardware.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
v &lt;- validate::validator(y ==2,y + z ==3, x +y &lt;= 0)
dat &lt;- data.frame(x=NA_real_,y=NA_real_,z=NA_real_)
impute_lr(dat,v)

</code></pre>

<hr>
<h2 id='tree'>Solve an optimization problem using a tree algorithm as described in Scholtus (2009)</h2><span id='topic+tree'></span>

<h3>Description</h3>

<p>Solve an optimization problem using a tree algorithm as described in Scholtus (2009)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tree(B, kappa, delta = as.logical(rep(NA, ncol(B))), sol = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tree_+3A_b">B</code></td>
<td>
<p>binary matrix with suggested corrections per violated edit</p>
</td></tr>
<tr><td><code id="tree_+3A_kappa">kappa</code></td>
<td>
<p>frequency of suggested corrections</p>
</td></tr>
<tr><td><code id="tree_+3A_delta">delta</code></td>
<td>
<p><code>logical</code> vector with partial solution (starts with NA)</p>
</td></tr>
<tr><td><code id="tree_+3A_sol">sol</code></td>
<td>
<p>current best solution. (starts with null)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>sol
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
