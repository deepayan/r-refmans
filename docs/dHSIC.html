<!DOCTYPE html><html><head><title>Help for package dHSIC</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {dHSIC}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#dHSIC-package'><p>Independence Testing via Hilbert Schmidt Independence Criterion</p></a></li>
<li><a href='#dhsic'><p>d-variable Hilbert Schmidt independence criterion - dHSIC</p></a></li>
<li><a href='#dhsic.test'><p>Independence test based on dHSIC</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Independence Testing via Hilbert Schmidt Independence Criterion</td>
</tr>
<tr>
<td>Version:</td>
<td>2.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-01-04</td>
</tr>
<tr>
<td>Author:</td>
<td>Niklas Pfister and Jonas Peters</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Niklas Pfister &lt;pfister@stat.math.ethz.ch&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Contains an implementation of the
	     d-variable Hilbert Schmidt independence criterion
	     and several hypothesis tests based on it, as described
	     in Pfister et al. (2017) &lt;<a href="https://doi.org/10.1111%2Frssb.12235">doi:10.1111/rssb.12235</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 0.12.18)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-01-04 08:58:38 UTC; pfisteni</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-01-04 13:50:19 UTC</td>
</tr>
</table>
<hr>
<h2 id='dHSIC-package'>Independence Testing via Hilbert Schmidt Independence Criterion</h2><span id='topic+dHSIC-package'></span><span id='topic+dHSIC'></span>

<h3>Description</h3>

<p>Contains an implementation of the
d-variable Hilbert Schmidt independence criterion
and several hypothesis tests based on it, as described
in Pfister et al. (2017) &lt;doi:10.1111/rssb.12235&gt;.</p>


<h3>Details</h3>

<p>The DESCRIPTION file:
</p>

<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> dHSIC</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Title: </td><td style="text-align: left;"> Independence Testing via Hilbert Schmidt Independence Criterion</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 2.1</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2019-01-04</td>
</tr>
<tr>
 <td style="text-align: left;">
Author: </td><td style="text-align: left;"> Niklas Pfister and Jonas Peters</td>
</tr>
<tr>
 <td style="text-align: left;">
Maintainer: </td><td style="text-align: left;"> Niklas Pfister &lt;pfister@stat.math.ethz.ch&gt;</td>
</tr>
<tr>
 <td style="text-align: left;">
Description: </td><td style="text-align: left;"> Contains an implementation of the
	     d-variable Hilbert Schmidt independence criterion
	     and several hypothesis tests based on it, as described
	     in Pfister et al. (2017) &lt;doi:10.1111/rssb.12235&gt;.</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-3</td>
</tr>
<tr>
 <td style="text-align: left;">
Imports: </td><td style="text-align: left;"> Rcpp (&gt;= 0.12.18)</td>
</tr>
<tr>
 <td style="text-align: left;">
LinkingTo: </td><td style="text-align: left;"> Rcpp</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Index of help topics:
</p>
<pre>
dHSIC-package           Independence Testing via Hilbert Schmidt
                        Independence Criterion
dhsic                   d-variable Hilbert Schmidt independence
                        criterion - dHSIC
dhsic.test              Independence test based on dHSIC
</pre>


<h3>Author(s)</h3>

<p>Niklas Pfister and Jonas Peters
</p>
<p>Maintainer: Niklas Pfister &lt;pfister@stat.math.ethz.ch&gt;
</p>


<h3>References</h3>

<p>Gretton, A., K. Fukumizu, C. H. Teo, L. Song, B. Sch\&quot;olkopf and
A. J. Smola (2007). A kernel statistical test of independence. In
Advances in Neural Information Processing Systems (pp. 585-592).
</p>
<p>Pfister, N., P. B\&quot;uhlmann, B. Sch\&quot;olkopf and J. Peters (2017).
Kernel-based Tests for Joint Independence. To appear in the
Journal of the Royal Statistical Society, Series B.
</p>

<hr>
<h2 id='dhsic'>d-variable Hilbert Schmidt independence criterion - dHSIC</h2><span id='topic+dhsic'></span>

<h3>Description</h3>

<p>The d-variable Hilbert Schmidt independence criterion (dHSIC) is
a non-parametric measure of dependence between an arbitrary number of
variables. In the large sample limit the value of dHSIC is 0 if the
variables are jointly independent and positive if there is a
dependence. It is therefore able to detect any type of dependence
given a sufficient amount of data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dhsic(X, Y, K, kernel = "gaussian", bandwidth = 1, matrix.input = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dhsic_+3A_x">X</code></td>
<td>

<p>either a list of at least two numeric matrices or a single numeric
matrix. The rows of a matrix correspond to the observations of a
variable. It is always required that there are an equal number of
observations for all variables (i.e. all matrices have to have the
same number of rows). If <code>X</code> is a single numeric matrix than
one has to specify the second variable as <code>Y</code> or set
<code>matrix.input</code> to &quot;TRUE&quot;. See below for more details.
</p>
</td></tr>
<tr><td><code id="dhsic_+3A_y">Y</code></td>
<td>

<p>a numeric matrix if <code>X</code> is also a numeric
matrix and omitted if <code>X</code> is a list.
</p>
</td></tr>
<tr><td><code id="dhsic_+3A_k">K</code></td>
<td>

<p>a list of the gram matrices corresponding to each variable. If
<code>K</code> specified the other inputs will have no effect on the
computations.
</p>
</td></tr>
<tr><td><code id="dhsic_+3A_kernel">kernel</code></td>
<td>

<p>a vector of character strings specifying the kernels for each
variable. There exist two pre-defined kernels: &quot;gaussian&quot; (Gaussian kernel
with median heuristic as bandwidth) and &quot;discrete&quot; (discrete
kernel). User defined kernels can also be used by passing the
function name as a string, which will then be matched using
<code><a href="base.html#topic+match.fun">match.fun</a></code>. If the length of <code>kernel</code> is
smaller than the number of variables the kernel specified in
<code>kernel[1]</code> will be used for all variables.
</p>
</td></tr>
<tr><td><code id="dhsic_+3A_bandwidth">bandwidth</code></td>
<td>

<p>a numeric value specifying the size of the bandwidth used for the
Gaussian kernel. Only used if kernel=&quot;gaussian.fixed&quot;.
</p>
</td></tr>
<tr><td><code id="dhsic_+3A_matrix.input">matrix.input</code></td>
<td>

<p>a boolean. If <code>matrix.input</code> is &quot;TRUE&quot; the input <code>X</code> is
assumed to be a matrix in which the columns correspond to the variables.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The d-variable Hilbert Schmidt independence criterion is a direct
extension of the standard Hilbert Schmidt independence criterion
(HSIC) from two variables to an arbitrary number of
variables. It is 0 if and only if all the variables are jointly
independent. This function computes an estimator of dHSIC, which
converges to the actual dHSIC in the large sample limit. It is
therefore possible to detect any type of dependence in the large
sample limit.
</p>
<p>If <code>X</code> is a list with d matrices, the function computes dHSIC for
the corresponding d random vectors. If <code>X</code> is a
matrix and <code>matrix.input</code> is &quot;TRUE&quot; the functions dHSIC for the
columns of <code>X</code>. If <code>X</code> is a matrix and <code>matrix.input</code>
is &quot;FALSE&quot; then <code>Y</code> needs to be a matrix, too; in this case, the
function computes the dHSIC (HSIC) for the corresponding two random vectors.
</p>
<p>For more details see the references.
</p>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr><td><code>dHSIC</code></td>
<td>
<p>the value of the empirical estimator of dHSIC</p>
</td></tr>
<tr><td><code>time</code></td>
<td>
<p>numeric vector containing computation times. <code>time[1]</code>
is time to compute Gram matrix and <code>time[2]</code> is time to compute
dHSIC.</p>
</td></tr>
<tr><td><code>bandwidth</code></td>
<td>
<p>bandwidth used during computations. Only relevant if
Gaussian kernel was used.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Niklas Pfister and Jonas Peters
</p>


<h3>References</h3>

<p>Gretton, A., K. Fukumizu, C. H. Teo, L. Song, B. Sch\&quot;olkopf and
A. J. Smola (2007). A kernel statistical test of independence. In
Advances in Neural Information Processing Systems (pp. 585-592).
</p>
<p>Pfister, N., P. B\&quot;uhlmann, B. Sch\&quot;olkopf and J. Peters (2017).
Kernel-based Tests for Joint Independence. To appear in the
Journal of the Royal Statistical Society, Series B.
</p>


<h3>See Also</h3>

<p>In order to perform hypothesis tests based on dHSIC use the function <code><a href="#topic+dhsic.test">dhsic.test</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### Three different input methods
set.seed(0)
x &lt;- matrix(rnorm(200),ncol=2)
y &lt;- matrix(rbinom(100,30,0.1),ncol=1)
# compute dHSIC of x and y (x is taken as a single variable)
dhsic(list(x,y),kernel=c("gaussian","discrete"))$dHSIC
dhsic(x,y,kernel=c("gaussian","discrete"))$dHSIC
# compute dHSIC of x[,1], x[,2] and y
dhsic(cbind(x,y),kernel=c("gaussian","discrete"), matrix.input=TRUE)$dHSIC

### Using a user-defined kernel (here: sigmoid kernel)
set.seed(0)
x &lt;- matrix(rnorm(500),ncol=1)
y &lt;- x^2+0.02*matrix(rnorm(500),ncol=1)
sigmoid &lt;- function(x_1,x_2){
  return(tanh(sum(x_1*x_2)))
}
dhsic(x,y,kernel="sigmoid")$dHSIC

</code></pre>

<hr>
<h2 id='dhsic.test'>Independence test based on dHSIC</h2><span id='topic+dhsic.test'></span>

<h3>Description</h3>

<p>Hypothesis test for finding statistically significant evidence of
dependence between several variables. Uses the d-variable Hilbert
Schmidt independence criterion (dHSIC) as measure of dependence.
Several types of hypothesis tests are included. The null
hypothesis (H_0) is that all variables are jointly independent.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dhsic.test(X, Y, K, alpha = 0.05, method = "permutation",
            kernel = "gaussian", B = 1000, pairwise = FALSE,
            bandwidth = 1, matrix.input = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dhsic.test_+3A_x">X</code></td>
<td>

<p>either a list of at least two numeric matrices or a single numeric
matrix. The rows of a matrix correspond to the observations of a
variable. It is always required that there are an equal number of
observations for all variables (i.e. all matrices have to have the
same number of rows). If <code>X</code> is a single numeric matrix than
one has to specify the second variable as <code>Y</code> or set
<code>matrix.input</code> to &quot;TRUE&quot;. See below for more details.
</p>
</td></tr>
<tr><td><code id="dhsic.test_+3A_y">Y</code></td>
<td>

<p>a numeric matrix if <code>X</code> is also a numeric
matrix and omitted if <code>X</code> is a list.
</p>
</td></tr>
<tr><td><code id="dhsic.test_+3A_k">K</code></td>
<td>

<p>a list of the gram matrices corresponding to each variable. If
<code>K</code> the following inputs <code>X</code>, <code>Y</code>, <code>kernel</code>,
<code>pairwise</code>, <code>bandwidth</code> and <code>matrix.input</code> will be
ignored.
</p>
</td></tr>
<tr><td><code id="dhsic.test_+3A_alpha">alpha</code></td>
<td>

<p>a numeric value in (0,1) specifying the confidence level of the
hypothesis test.
</p>
</td></tr>
<tr><td><code id="dhsic.test_+3A_method">method</code></td>
<td>

<p>a character string specifying the type of hypothesis test used. The
available options are: &quot;gamma&quot; (gamma approximation based
test), &quot;permutation&quot; (permutation test (slow)), &quot;bootstrap&quot; (bootstrap
test (slow)) and &quot;eigenvalue&quot; (eigenvalue based test).
</p>
</td></tr>
<tr><td><code id="dhsic.test_+3A_kernel">kernel</code></td>
<td>

<p>a vector of character strings specifying the kernels for each
variable. There exist two pre-defined kernels: &quot;gaussian&quot; (Gaussian kernel
with median heuristic as bandwidth) and &quot;discrete&quot; (discrete
kernel). User defined kernels can also be used by passing the
function name as a string, which will then be matched using
<code><a href="base.html#topic+match.fun">match.fun</a></code>. If the length of <code>kernel</code> is
smaller than the number of variables the kernel specified in
<code>kernel[1]</code> will be used for all variables.
</p>
</td></tr>
<tr><td><code id="dhsic.test_+3A_b">B</code></td>
<td>

<p>an integer value specifying the number of Monte-Carlo iterations
made in the permutation and bootstrap test. Only relevant if
<code>method</code> is set to &quot;permutation&quot; or to &quot;bootstrap&quot;.
</p>
</td></tr>
<tr><td><code id="dhsic.test_+3A_pairwise">pairwise</code></td>
<td>

<p>a logical value indicating whether one should use HSIC with pairwise
comparisons instead of dHSIC. Can only be true if there are more than
two variables.
</p>
</td></tr>
<tr><td><code id="dhsic.test_+3A_bandwidth">bandwidth</code></td>
<td>

<p>a numeric value specifying the size of the bandwidth used for the
Gaussian kernel. Only used if kernel=&quot;gaussian.fixed&quot;.
</p>
</td></tr>
<tr><td><code id="dhsic.test_+3A_matrix.input">matrix.input</code></td>
<td>

<p>a boolean. If <code>matrix.input</code> is &quot;TRUE&quot; the input <code>X</code> is
assumed to be a matrix in which the columns correspond to the variables.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The d-variable Hilbert Schmidt independence criterion is a direct
extension of the standard Hilbert Schmidt independence criterion
(HSIC) from two variables to an arbitrary number of
variables. It is 0 if and only if the variables are jointly independent.
</p>
<p>4 different statistical hypothesis tests are implemented all with null hypothesis
(H_0: <code>X[[1]]</code>,...,<code>X[[d]]</code> are jointly independent) and alternative hypothesis
(H_A: <code>X[[1]]</code>,...,<code>X[[d]]</code> are not jointly independent): 
1. Permutation test for dHSIC: exact level, slow
2. Bootstrap test for dHSIC: pointwise asymptotic level and pointwise
consistent, slow
3. Gamma approximation based test for dHSIC: only approximate, fast
4. Eigenvalue based test for dHSIC: pointwise asymptotic level and pointwise
consistent, medium
</p>
<p>The null hypothesis is rejected if <code>statistic</code> is strictly
greater than <code>crit.value</code>.
</p>
<p>If <code>X</code> is a list with d matrices, the function tests for joint
independence of the corresponding d random vectors. If <code>X</code> is a
matrix and <code>matrix.input</code> is &quot;TRUE&quot; the functions tests the
independence between the columns of <code>X</code>. If <code>X</code> is a matrix
and <code>matrix.input</code> is &quot;FALSE&quot; then <code>Y</code> needs to be a matrix,
too; in this case, the function tests the (pairwise) independence
between the corresponding two random vectors.
</p>
<p>For more details see the references.
</p>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr><td><code>statistic</code></td>
<td>
<p>the value of the test statistic</p>
</td></tr>
<tr><td><code>crit.value</code></td>
<td>
<p>critical value of the hypothesis test. The null
hypothesis (H_0: joint independence) is rejected if <code>statistic</code>
is greater than <code>crit.value</code>.</p>
</td></tr> 
<tr><td><code>p.value</code></td>
<td>
<p>p-value of the hypothesis test, i.e. the probability that
a random version of the test statistic is greater than
<code>statistic</code> under the calculated null 
hypothesis (H_0: joint independence) based on the data.</p>
</td></tr>
<tr><td><code>time</code></td>
<td>
<p>numeric vector containing computation times. <code>time[1]</code> is time
to compute Gram matrix, <code>time[2]</code> is time to compute dHSIC and
<code>time[3]</code> is the time to compute <code>crit.value</code> and
<code>p.value.</code></p>
</td></tr>
<tr><td><code>bandwidth</code></td>
<td>
<p>bandwidth used during the computation. Only relevant if
Gaussian kernel was used.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Niklas Pfister and Jonas Peters
</p>


<h3>References</h3>

<p>Gretton, A., K. Fukumizu, C. H. Teo, L. Song, B. Sch\&quot;olkopf and
A. J. Smola (2007). A kernel statistical test of independence. In
Advances in Neural Information Processing Systems (pp. 585-592).
</p>
<p>Pfister, N., P. B\&quot;uhlmann, B. Sch\&quot;olkopf and J. Peters (2017).
Kernel-based Tests for Joint Independence. To appear in the
Journal of the Royal Statistical Society, Series B.
</p>


<h3>See Also</h3>

<p>In order to only compute the test statistic without p-values, use the
function <code><a href="#topic+dhsic">dhsic</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### pairwise independent but not jointly independent (pairwise HSIC vs dHSIC)
set.seed(0)
x &lt;- matrix(rbinom(100,1,0.5),ncol=1)
y &lt;- matrix(rbinom(100,1,0.5),ncol=1)
z &lt;- matrix(as.numeric((x+y)==1)+rnorm(100),ncol=1)
X &lt;- list(x,y,z)

dhsic.test(X, method="permutation",
           kernel=c("discrete", "discrete", "gaussian"),
           pairwise=TRUE, B=1000)$p.value
dhsic.test(X, method="permutation",
           kernel=c("discrete", "discrete", "gaussian"),
           pairwise=FALSE, B=1000)$p.value

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
