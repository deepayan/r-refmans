<!DOCTYPE html><html><head><title>Help for package GWEX</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {GWEX}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#agg.matrix'><p>agg.matrix</p></a></li>
<li><a href='#autocor.emp.int'><p>autocor.emp.int</p></a></li>
<li><a href='#cor.emp.int'><p>cor.emp.int</p></a></li>
<li><a href='#cor.emp.occ'><p>cor.emp.occ</p></a></li>
<li><a href='#cor.obs.occ'><p>cor.obs.occ</p></a></li>
<li><a href='#dailyPrecipGWEX'><p>daily observations of precipitation data</p></a></li>
<li><a href='#dailyTemperGWEX'><p>daily observations of temperature data</p></a></li>
<li><a href='#disag.3D.to.1D'><p>disag.3D.to.1D</p></a></li>
<li><a href='#dist.functions.EGPD.GI'><p>dEGPD.GI, pEGPD.GI, qEGPD.GI, rEGPD.GI</p></a></li>
<li><a href='#dry.day.frequency'><p>dry.day.frequency</p></a></li>
<li><a href='#EGPD.GI.fit.PWM'><p>EGPD.GI.fit.PWM</p></a></li>
<li><a href='#EGPD.GI.fPWM'><p>EGPD.GI.fPWM</p></a></li>
<li><a href='#find.autocor'><p>find.autocor</p></a></li>
<li><a href='#find.omega'><p>find.omega</p></a></li>
<li><a href='#find.zeta'><p>find.zeta</p></a></li>
<li><a href='#fit.copula.amount'><p>fit.copula.amount</p></a></li>
<li><a href='#fit.GWex.prec'><p>fit.GWex.prec</p></a></li>
<li><a href='#fit.MAR1.amount'><p>fit.MAR1.amount</p></a></li>
<li><a href='#fit.margin.cdf'><p>fit.margin.cdf</p></a></li>
<li><a href='#fitGwexModel'><p>fitGwexModel: fit a GWex model to observations.</p></a></li>
<li><a href='#functions.EGPD.GI'><p>EGPD.pGI, EGPD.dGI, EGPD.qGI</p></a></li>
<li><a href='#get.df.Student'><p>get.df.Student</p></a></li>
<li><a href='#get.emp.cdf.matrix'><p>get.df.Student</p></a></li>
<li><a href='#get.list.month'><p>get.list.month</p></a></li>
<li><a href='#get.list.season'><p>get.list.season</p></a></li>
<li><a href='#get.listOption'><p>get.listOption</p></a></li>
<li><a href='#get.M0'><p>get.M0</p></a></li>
<li><a href='#get.mat.omega'><p>get.mat.omega</p></a></li>
<li><a href='#get.period.fitting.month'><p>get.period.fitting.month</p></a></li>
<li><a href='#get.vec.autocor'><p>get.vec.autocor</p></a></li>
<li><a href='#getGwexFitPrec'><p>getGwexFitPrec</p></a></li>
<li><a href='#Gwex-class'><p>Class Gwex</p></a></li>
<li><a href='#GwexFit-class'><p>Class GwexFit</p></a></li>
<li><a href='#GwexObs'><p>Constructor</p></a></li>
<li><a href='#GwexObs-class'><p>Class <code>GwexObs</code></p></a></li>
<li><a href='#GwexSim-class'><p>Defines a <code>GwexSim</code> object which is a <code>Gwex</code> object containing 'sim', an array containing the simulations, and 'dates', a vector of dates.</p>
See simGwexModel for some examples.</a></li>
<li><a href='#infer.autocor.amount'><p>infer.autocor.amount</p></a></li>
<li><a href='#infer.dep.amount'><p>infer.dep.amount</p></a></li>
<li><a href='#infer.mat.omega'><p>infer.mat.omega</p></a></li>
<li><a href='#joint.proba.occ'><p>joint.proba.occ</p></a></li>
<li><a href='#lagTransProbaMatrix'><p>lagTransProbaMatrix</p></a></li>
<li><a href='#lagTransProbaVector'><p>lagTransProbaVector</p></a></li>
<li><a href='#mask.GWex.Yt'><p>mask.GWex.Yt</p></a></li>
<li><a href='#modify.cor.matrix'><p>modify.cor.matrix</p></a></li>
<li><a href='#month2season'><p>month2season</p></a></li>
<li><a href='#print,Gwex-method'><p>print-methods: Create a method to print Gwex objects.</p></a></li>
<li><a href='#PWM.EGPD.GI'><p>EGPD.GI.mu0, EGPD.GI.mu1, EGPD.GI.mu2</p></a></li>
<li><a href='#QtransMat2Array'><p>QtransMat2Array</p></a></li>
<li><a href='#show,Gwex-method'><p>show-methods: Create a method to show Gwex objects.</p></a></li>
<li><a href='#sim.GWex.occ'><p>sim.GWex.occ</p></a></li>
<li><a href='#sim.GWex.prec.1it'><p>sim.GWex.prec.1it</p></a></li>
<li><a href='#sim.GWex.Yt'><p>sim.GWex.Yt</p></a></li>
<li><a href='#sim.GWex.Yt.Pr'><p>sim.GWex.Yt.Pr</p></a></li>
<li><a href='#sim.GWex.Yt.Pr.get.param'><p>sim.GWex.Yt.Pr.get.param</p></a></li>
<li><a href='#sim.Zt.MAR'><p>sim.Zt.MAR</p></a></li>
<li><a href='#sim.Zt.Spatial'><p>sim.Zt.Spatial</p></a></li>
<li><a href='#simGwexModel'><p>simGwexModel</p></a></li>
<li><a href='#simPrecipOcc'><p>simPrecipOcc</p></a></li>
<li><a href='#unif.to.prec'><p>unif.to.prec</p></a></li>
<li><a href='#wet.day.frequency'><p>wet.day.frequency</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-02-02</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Title:</td>
<td>Multi-Site Stochastic Models for Daily Precipitation and
Temperature</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.3</td>
</tr>
<tr>
<td>Author:</td>
<td>Guillaume Evin [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Guillaume Evin &lt;guillaume.evin@inrae.fr&gt;</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 1.0.11), EnvStats, MASS, mvtnorm, nleqslv, fGarch,
parallel, abind, foreach, doParallel, Renext, lmomco, methods,
stats</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>Description:</td>
<td>Application of multi-site models for daily precipitation and temperature data. 
  This package is designed for an application to 105 precipitation and 26 temperature gauges located in Switzerland.
  It applies fitting procedures and provides weather generators described in the following references:
  - Evin, G., A.-C. Favre, and B. Hingray. (2018) &lt;<a href="https://doi.org/10.5194%2Fhess-22-655-2018">doi:10.5194/hess-22-655-2018</a>&gt;.
  - Evin, G., A.-C. Favre, and B. Hingray. (2018) &lt;<a href="https://doi.org/10.1007%2Fs00704-018-2404-x">doi:10.1007/s00704-018-2404-x</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-02 08:47:58 UTC; eving</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-02 09:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='agg.matrix'>agg.matrix</h2><span id='topic+agg.matrix'></span>

<h3>Description</h3>

<p>Simple accumulation of a matrix of precipitation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>agg.matrix(mat, k, average = F)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="agg.matrix_+3A_mat">mat</code></td>
<td>
<p>matrix nDates x nStations to be aggregated</p>
</td></tr>
<tr><td><code id="agg.matrix_+3A_k">k</code></td>
<td>
<p>number of days for the accumulation</p>
</td></tr>
<tr><td><code id="agg.matrix_+3A_average">average</code></td>
<td>
<p>logical: should we average over the different periods (default=F)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>aggregated matrix
</p>


<h3>Author(s)</h3>

<p>Guillaume Evin
</p>

<hr>
<h2 id='autocor.emp.int'>autocor.emp.int</h2><span id='topic+autocor.emp.int'></span>

<h3>Description</h3>

<p>Finds empirical autocorrelations (lag-1) between intensities corresponding
to a degree of autocorrelation of an AR(1) process
</p>


<h3>Usage</h3>

<pre><code class='language-R'>autocor.emp.int(rho, nChainFit, Xt, parMargin, typeMargin)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="autocor.emp.int_+3A_rho">rho</code></td>
<td>
<p>autocorrelation of the AR(1) process</p>
</td></tr>
<tr><td><code id="autocor.emp.int_+3A_nchainfit">nChainFit</code></td>
<td>
<p>number of simulated variates</p>
</td></tr>
<tr><td><code id="autocor.emp.int_+3A_xt">Xt</code></td>
<td>
<p>simulated occurrences, nChainFit x 2 matrix</p>
</td></tr>
<tr><td><code id="autocor.emp.int_+3A_parmargin">parMargin</code></td>
<td>
<p>parameters of the margins 2 x 3</p>
</td></tr>
<tr><td><code id="autocor.emp.int_+3A_typemargin">typeMargin</code></td>
<td>
<p>type of marginal distribution: 'EGPD' or 'mixExp'</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>scalar</code></td>
<td>
<p>correlation between simulated intensities</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Guillaume Evin
</p>

<hr>
<h2 id='cor.emp.int'>cor.emp.int</h2><span id='topic+cor.emp.int'></span>

<h3>Description</h3>

<p>Finds observed correlations between intensities corresponding
to a degree of correlation of Gaussian multivariate random numbers
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cor.emp.int(zeta, nChainFit, Xt, parMargin, typeMargin)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cor.emp.int_+3A_zeta">zeta</code></td>
<td>
<p>correlation of Gaussian multivariates</p>
</td></tr>
<tr><td><code id="cor.emp.int_+3A_nchainfit">nChainFit</code></td>
<td>
<p>number of simulated variates</p>
</td></tr>
<tr><td><code id="cor.emp.int_+3A_xt">Xt</code></td>
<td>
<p>simulated occurrences, n x 2 matrix</p>
</td></tr>
<tr><td><code id="cor.emp.int_+3A_parmargin">parMargin</code></td>
<td>
<p>parameters of the margins 2 x 3</p>
</td></tr>
<tr><td><code id="cor.emp.int_+3A_typemargin">typeMargin</code></td>
<td>
<p>type of marginal distribution: 'EGPD' or 'mixExp'</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>scalar</code></td>
<td>
<p>correlation between simulated intensities</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Guillaume Evin
</p>

<hr>
<h2 id='cor.emp.occ'>cor.emp.occ</h2><span id='topic+cor.emp.occ'></span>

<h3>Description</h3>

<p>Finds observed correlations between occurrences corresponding
to a degree of correlation of Gaussian multivariate random numbers
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cor.emp.occ(w, Qtrans.mat, mat.comb, nLag, nChainFit, myseed = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cor.emp.occ_+3A_w">w</code></td>
<td>
<p>correlation of Gaussian multivariates</p>
</td></tr>
<tr><td><code id="cor.emp.occ_+3A_qtrans.mat">Qtrans.mat</code></td>
<td>
<p>transition probabilities, 2 x ncomb matrix</p>
</td></tr>
<tr><td><code id="cor.emp.occ_+3A_mat.comb">mat.comb</code></td>
<td>
<p>matrix of logical: ncomb x nlag</p>
</td></tr>
<tr><td><code id="cor.emp.occ_+3A_nlag">nLag</code></td>
<td>
<p>order of the Markov chain</p>
</td></tr>
<tr><td><code id="cor.emp.occ_+3A_nchainfit">nChainFit</code></td>
<td>
<p>number of simulated variates</p>
</td></tr>
<tr><td><code id="cor.emp.occ_+3A_myseed">myseed</code></td>
<td>
<p>seed of random variates</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>scalar</code></td>
<td>
<p>correlation between occurrences</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Guillaume Evin
</p>

<hr>
<h2 id='cor.obs.occ'>cor.obs.occ</h2><span id='topic+cor.obs.occ'></span>

<h3>Description</h3>

<p>provide observed correlations between occurrences for all pairs of stations
see Mhanna et al. (2012)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cor.obs.occ(pi00, pi0, pi1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cor.obs.occ_+3A_pi00">pi00</code></td>
<td>
<p>joint probability of having dry states</p>
</td></tr>
<tr><td><code id="cor.obs.occ_+3A_pi0">pi0</code></td>
<td>
<p>probability of having a dry state</p>
</td></tr>
<tr><td><code id="cor.obs.occ_+3A_pi1">pi1</code></td>
<td>
<p>probability of having a wet state</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>scalar</code></td>
<td>
<p>matrix of observed correlations</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Guillaume Evin
</p>


<h3>References</h3>

<p>Mhanna, Muamaraldin, and Willy Bauwens. “A Stochastic Space-Time Model 
for the Generation of Daily Rainfall in the Gaza Strip.” International Journal of 
Climatology 32, no. 7 (June 15, 2012): 1098–1112. doi:10.1002/joc.2305.
</p>

<hr>
<h2 id='dailyPrecipGWEX'>daily observations of precipitation data</h2><span id='topic+dailyPrecipGWEX'></span>

<h3>Description</h3>

<p>Example of daily observations of precipitation (mm) for three fictive stations, for a period of ten years.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(dailyPrecipGWEX)
</code></pre>


<h3>Format</h3>

<p>matrix of Observed precipitation: 3652 days x 3 stations
</p>


<h3>Author(s)</h3>

<p>Guillaume Evin <a href="mailto:guillaume.evin@irstea.fr">guillaume.evin@irstea.fr</a>
</p>


<h3>References</h3>

<p>Evin, G., A.-C. Favre, and B. Hingray. 2018. “Stochastic Generation of Multi-Site Daily Precipitation Focusing on Extreme Events&quot;.
Hydrol. Earth Syst. Sci. 22 (1): 655–672.
</p>

<hr>
<h2 id='dailyTemperGWEX'>daily observations of temperature data</h2><span id='topic+dailyTemperGWEX'></span>

<h3>Description</h3>

<p>Example of daily observations of temperature (mm) for three fictive stations, for a period of ten years.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(dailyTemperGWEX)
</code></pre>


<h3>Format</h3>

<p>matrix of Observed temperature: 3652 days x 3 stations
</p>


<h3>Author(s)</h3>

<p>Guillaume Evin <a href="mailto:guillaume.evin@irstea.fr">guillaume.evin@irstea.fr</a>
</p>


<h3>References</h3>

<p>Evin G., A.C. Favre, and B. Hingray. 2018. Stochastic Generators of Multi Site Daily Temperature:
Comparison of Performances in Various Applications. Theoretical and Applied Climatology.
</p>

<hr>
<h2 id='disag.3D.to.1D'>disag.3D.to.1D</h2><span id='topic+disag.3D.to.1D'></span>

<h3>Description</h3>

<p>disag.3D.to.1D
</p>


<h3>Usage</h3>

<pre><code class='language-R'>disag.3D.to.1D(Yobs, YObsAgg, mObsAgg, YSimAgg, mSimAgg, prob.class)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="disag.3D.to.1D_+3A_yobs">Yobs</code></td>
<td>
<p>matrix of observed intensities at 24h: (nTobs*3) x nStation</p>
</td></tr>
<tr><td><code id="disag.3D.to.1D_+3A_yobsagg">YObsAgg</code></td>
<td>
<p>matrix of observed 3-day intensities: nTobs x nStation</p>
</td></tr>
<tr><td><code id="disag.3D.to.1D_+3A_mobsagg">mObsAgg</code></td>
<td>
<p>vector of season corresponding to YobsAgg</p>
</td></tr>
<tr><td><code id="disag.3D.to.1D_+3A_ysimagg">YSimAgg</code></td>
<td>
<p>matrix of simulated intensities per 3-day period: nTsim x nStation</p>
</td></tr>
<tr><td><code id="disag.3D.to.1D_+3A_msimagg">mSimAgg</code></td>
<td>
<p>vector of season corresponding to the period simulated</p>
</td></tr>
<tr><td><code id="disag.3D.to.1D_+3A_prob.class">prob.class</code></td>
<td>
<p>vector of probabilities indicating class of &quot;similar&quot; mean intensities</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>list</code></td>
<td>
<p>Ysim matrix of disagregated daily precipitation, codeDisag matrix of disagregation codes</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Guillaume Evin
</p>

<hr>
<h2 id='dist.functions.EGPD.GI'>dEGPD.GI, pEGPD.GI, qEGPD.GI, rEGPD.GI</h2><span id='topic+dist.functions.EGPD.GI'></span><span id='topic+dEGPD.GI'></span><span id='topic+pEGPD.GI'></span><span id='topic+qEGPD.GI'></span><span id='topic+rEGPD.GI'></span>

<h3>Description</h3>

<p>Density function, distribution function, quantile function, random generation
for the unified EGPD distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dEGPD.GI(x, kappa, sig, xi)

pEGPD.GI(x, kappa, sig, xi)

qEGPD.GI(p, kappa, sig, xi)

rEGPD.GI(n, kappa, sig, xi)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dist.functions.EGPD.GI_+3A_x">x</code></td>
<td>
<p>Vector of quantiles</p>
</td></tr>
<tr><td><code id="dist.functions.EGPD.GI_+3A_kappa">kappa</code></td>
<td>
<p>transformation parameter greater than 0</p>
</td></tr>
<tr><td><code id="dist.functions.EGPD.GI_+3A_sig">sig</code></td>
<td>
<p>Scale parameter</p>
</td></tr>
<tr><td><code id="dist.functions.EGPD.GI_+3A_xi">xi</code></td>
<td>
<p>Shape parameter</p>
</td></tr>
<tr><td><code id="dist.functions.EGPD.GI_+3A_p">p</code></td>
<td>
<p>Vector of probabilities</p>
</td></tr>
<tr><td><code id="dist.functions.EGPD.GI_+3A_n">n</code></td>
<td>
<p>Number of observations</p>
</td></tr>
</table>


<h3>Value</h3>

<p>dEGPD.GI gives the density function, pEGPD.GI gives the distribution function, 
qEGPD.GI gives the quantile function, and rEGPD.GI generates random deviates.
</p>


<h3>Author(s)</h3>

<p>Guillaume Evin
</p>

<hr>
<h2 id='dry.day.frequency'>dry.day.frequency</h2><span id='topic+dry.day.frequency'></span>

<h3>Description</h3>

<p>Estimate the dry day frequency (proportion of dry days) for all stations
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dry.day.frequency(mat.prec, th)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dry.day.frequency_+3A_mat.prec">mat.prec</code></td>
<td>
<p>matrix of precipitation (possibly for one month/period)</p>
</td></tr>
<tr><td><code id="dry.day.frequency_+3A_th">th</code></td>
<td>
<p>threshold above which we consider that a day is wet (e.g. 0.2 mm)</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>vector of numeric</code></td>
<td>
<p>dry day frequencies</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Guillaume Evin
</p>

<hr>
<h2 id='EGPD.GI.fit.PWM'>EGPD.GI.fit.PWM</h2><span id='topic+EGPD.GI.fit.PWM'></span>

<h3>Description</h3>

<p>Parameter estimation of the unified EGPD distribution with the PWM method.
Numerical solver of the system of nonlinear equations
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EGPD.GI.fit.PWM(x, xi = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="EGPD.GI.fit.PWM_+3A_x">x</code></td>
<td>
<p>vector of parameters kappa,sig</p>
</td></tr>
<tr><td><code id="EGPD.GI.fit.PWM_+3A_xi">xi</code></td>
<td>
<p>shape parameter</p>
</td></tr>
</table>


<h3>Value</h3>

<p>estimated parameters kappa, sig, xi
</p>


<h3>Author(s)</h3>

<p>Guillaume Evin
</p>

<hr>
<h2 id='EGPD.GI.fPWM'>EGPD.GI.fPWM</h2><span id='topic+EGPD.GI.fPWM'></span>

<h3>Description</h3>

<p>Parameter estimation of the unified EGPD distribution with the PWM method.
Set of equations which have to be equal to zero
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EGPD.GI.fPWM(par, pwm, xi)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="EGPD.GI.fPWM_+3A_par">par</code></td>
<td>
<p>vector of parameters kappa,sig,xi</p>
</td></tr>
<tr><td><code id="EGPD.GI.fPWM_+3A_pwm">pwm</code></td>
<td>
<p>set of probability weighted moments of order 0, 1 and 2</p>
</td></tr>
<tr><td><code id="EGPD.GI.fPWM_+3A_xi">xi</code></td>
<td>
<p>shape parameter</p>
</td></tr>
</table>


<h3>Value</h3>

<p>differences between expected and target weighted moments
</p>


<h3>Author(s)</h3>

<p>Guillaume Evin
</p>

<hr>
<h2 id='find.autocor'>find.autocor</h2><span id='topic+find.autocor'></span>

<h3>Description</h3>

<p>finds the autocorrelation leading to observed autocorrelation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>find.autocor(autocor.emp, nChainFit, Xt, parMargin, typeMargin)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="find.autocor_+3A_autocor.emp">autocor.emp</code></td>
<td>
<p>target correlation between intensities</p>
</td></tr>
<tr><td><code id="find.autocor_+3A_nchainfit">nChainFit</code></td>
<td>
<p>number of simulations</p>
</td></tr>
<tr><td><code id="find.autocor_+3A_xt">Xt</code></td>
<td>
<p>simulated occurrences, nChainFit x 2 matrix</p>
</td></tr>
<tr><td><code id="find.autocor_+3A_parmargin">parMargin</code></td>
<td>
<p>parameters of the margins 2 x 3</p>
</td></tr>
<tr><td><code id="find.autocor_+3A_typemargin">typeMargin</code></td>
<td>
<p>type of marginal distribution: 'EGPD' or 'mixExp'</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>scalar</code></td>
<td>
<p>needed correlation</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Guillaume Evin
</p>

<hr>
<h2 id='find.omega'>find.omega</h2><span id='topic+find.omega'></span>

<h3>Description</h3>

<p>finds the correlation between normal variates leading to correlation between occurrences
</p>


<h3>Usage</h3>

<pre><code class='language-R'>find.omega(rho.emp, Qtrans.mat, mat.comb, nLag, nChainFit)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="find.omega_+3A_rho.emp">rho.emp</code></td>
<td>
<p>target correlation between occurences</p>
</td></tr>
<tr><td><code id="find.omega_+3A_qtrans.mat">Qtrans.mat</code></td>
<td>
<p>transition probabilities, 2 x ncomb matrix</p>
</td></tr>
<tr><td><code id="find.omega_+3A_mat.comb">mat.comb</code></td>
<td>
<p>matrix of logical: ncomb x nlag</p>
</td></tr>
<tr><td><code id="find.omega_+3A_nlag">nLag</code></td>
<td>
<p>order of the Markov chain</p>
</td></tr>
<tr><td><code id="find.omega_+3A_nchainfit">nChainFit</code></td>
<td>
<p>length of the simulated chains used during the fitting</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>scalar</code></td>
<td>
<p>needed correlation</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Guillaume Evin
</p>

<hr>
<h2 id='find.zeta'>find.zeta</h2><span id='topic+find.zeta'></span>

<h3>Description</h3>

<p>finds the correlation between normal variates leading to correlation between intensities
</p>


<h3>Usage</h3>

<pre><code class='language-R'>find.zeta(eta.emp, nChainFit, Xt, parMargin, typeMargin)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="find.zeta_+3A_eta.emp">eta.emp</code></td>
<td>
<p>target correlation between intensities</p>
</td></tr>
<tr><td><code id="find.zeta_+3A_nchainfit">nChainFit</code></td>
<td>
<p>number of simulations</p>
</td></tr>
<tr><td><code id="find.zeta_+3A_xt">Xt</code></td>
<td>
<p>simulated occurrences, n x 2 matrix</p>
</td></tr>
<tr><td><code id="find.zeta_+3A_parmargin">parMargin</code></td>
<td>
<p>parameters of the margins 2 x 3</p>
</td></tr>
<tr><td><code id="find.zeta_+3A_typemargin">typeMargin</code></td>
<td>
<p>type of marginal distribution: 'EGPD' or 'mixExp'</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>scalar</code></td>
<td>
<p>needed correlation</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Guillaume Evin
</p>

<hr>
<h2 id='fit.copula.amount'>fit.copula.amount</h2><span id='topic+fit.copula.amount'></span>

<h3>Description</h3>

<p>estimate parameters which control the spatial dependence between intensities using a copula
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit.copula.amount(P.mat, isPeriod, th, copulaInt, M0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit.copula.amount_+3A_p.mat">P.mat</code></td>
<td>
<p>precipitation matrix</p>
</td></tr>
<tr><td><code id="fit.copula.amount_+3A_isperiod">isPeriod</code></td>
<td>
<p>vector of logical n x 1 indicating the days concerned by a 3-month period</p>
</td></tr>
<tr><td><code id="fit.copula.amount_+3A_th">th</code></td>
<td>
<p>threshold above which we consider that a day is wet (e.g. 0.2 mm)</p>
</td></tr>
<tr><td><code id="fit.copula.amount_+3A_copulaint">copulaInt</code></td>
<td>
<p>type of dependence between inter-site amounts: 'Gaussian' or 'Student'</p>
</td></tr>
<tr><td><code id="fit.copula.amount_+3A_m0">M0</code></td>
<td>
<p>covariance matrix of gaussianized prec. amounts for all pairs of stations</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>list</code></td>
<td>
<p>list of estimates (e.g., M0, dfStudent)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Guillaume Evin
</p>

<hr>
<h2 id='fit.GWex.prec'>fit.GWex.prec</h2><span id='topic+fit.GWex.prec'></span>

<h3>Description</h3>

<p>estimate all the parameters for the G-Wex model of precipitation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit.GWex.prec(objGwexObs, parMargin, listOption = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit.GWex.prec_+3A_objgwexobs">objGwexObs</code></td>
<td>
<p>object of class <code><a href="#topic+GwexObs-class">GwexObs</a></code></p>
</td></tr>
<tr><td><code id="fit.GWex.prec_+3A_parmargin">parMargin</code></td>
<td>
<p>if not NULL, list where each element parMargin[[iM]] 
corresponds to a month iM=1...12 and contains a matrix nStation x 3 of estimated parameters
of the marginal distributions (EGPD or mixture of exponentials)</p>
</td></tr>
<tr><td><code id="fit.GWex.prec_+3A_listoption">listOption</code></td>
<td>
<p>list with the following fields:
</p>

<ul>
<li> <p><strong>th</strong>: threshold value in mm above which precipitation observations are considered to be non-zero (=0.2 by default)
</p>
</li>
<li> <p><strong>nLag</strong>: order of he Markov chain for the transitions between dry and wet states (=2 by default)
</p>
</li>
<li> <p><strong>typeMargin</strong>: 'EGPD' (Extended GPD) or 'mixExp' (Mixture of Exponentials). 'EGPD' by default
</p>
</li>
<li> <p><strong>copulaInt</strong>: 'Gaussian' or 'Student': type of dependence for amounts (='Student' by default)
</p>
</li>
<li> <p><strong>isMAR</strong>: logical value, do we apply a Autoregressive Multivariate Autoregressive model (order 1) =TRUE by default
</p>
</li>
<li> <p><strong>is3Damount</strong>: logical value, do we apply the model on 3D-amount. =FALSE by default
</p>
</li>
<li> <p><strong>nChainFit</strong>: integer, length of the runs used during the fitting procedure. =100000 by default
</p>
</li>
<li> <p><strong>nCluster</strong>: integer, number of clusters which can be used for the parallel computation
</p>
</li></ul>
</td></tr>
</table>


<h3>Value</h3>

<p>a list containing the list of options <code>listOption</code> and the list of estimated parameters <code>listPar</code>. 
The parameters of the occurrence process are contained in <code>parOcc</code> and the parameters related to the  precipitation 
amounts are contained in <code>parInt</code>. Each type of parameter is a list containing the estimates for each month. In <code>parOcc</code>, we find:
</p>

<ul>
<li> <p><strong>p01</strong>: For each station, the probability of transition from a dry state to a wet state.
</p>
</li>
<li> <p><strong>p11</strong>: For each station, the probability of staying in a wet state.
</p>
</li>
<li> <p><strong>list.pr.state</strong>: For each station, the probabilities of transitions for a Markov chain with lag <code>p</code>.
</p>
</li>
<li> <p><strong>list.mat.omega</strong>: The spatial correlation matrix of occurrences <code class="reqn">\Omega</code> (see Evin et al., 2018).</p>
</li></ul>

<p>In <code>parInt</code>, we have:
</p>

<ul>
<li> <p><strong>parMargin</strong>: list of matrices nStation x nPar of parameters for the marginal distributions (one element per Class).
</p>
</li>
<li> <p><strong>cor.int</strong>: Matrices nStation x nStation <code class="reqn">M_0</code>, <code class="reqn">A</code>, <code class="reqn">\Omega_Z</code> representing 
the spatial and temporal correlations between all the stations (see Evin et al., 2018). For the 
Student copula, <code>dfStudent</code> indicates the <code class="reqn">\nu</code> parameter.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Guillaume Evin
</p>


<h3>References</h3>

<p>Evin, G., A.-C. Favre, and B. Hingray. 2018. 'Stochastic Generation of Multi-Site 
Daily Precipitation Focusing on Extreme Events.' Hydrol. Earth Syst. Sci.
22 (1): 655-672. doi.org/10.5194/hess-22-655-2018.
</p>

<hr>
<h2 id='fit.MAR1.amount'>fit.MAR1.amount</h2><span id='topic+fit.MAR1.amount'></span>

<h3>Description</h3>

<p>estimate parameters which control the dependence between intensities with a
MAR(1) process
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit.MAR1.amount(P.mat, isPeriod, th, copulaInt, M0, A)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit.MAR1.amount_+3A_p.mat">P.mat</code></td>
<td>
<p>precipitation matrix</p>
</td></tr>
<tr><td><code id="fit.MAR1.amount_+3A_isperiod">isPeriod</code></td>
<td>
<p>vector of logical n x 1 indicating the days concerned by a 3-month period</p>
</td></tr>
<tr><td><code id="fit.MAR1.amount_+3A_th">th</code></td>
<td>
<p>threshold above which we consider that a day is wet (e.g. 0.2 mm)</p>
</td></tr>
<tr><td><code id="fit.MAR1.amount_+3A_copulaint">copulaInt</code></td>
<td>
<p>type of dependance between inter-site amounts: 'Gaussian' or 'Student'</p>
</td></tr>
<tr><td><code id="fit.MAR1.amount_+3A_m0">M0</code></td>
<td>
<p>covariance matrix of gaussianized prec. amounts for all pairs of stations</p>
</td></tr>
<tr><td><code id="fit.MAR1.amount_+3A_a">A</code></td>
<td>
<p>Matrix containing the autocorrelation (temporal) correlations</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list with the following items
</p>

<ul>
<li> <p><strong>M0</strong> covariance matrix of gaussianized prec. amounts for all pairs of stations
</p>
</li>
<li> <p><strong>A</strong> omega correlations for all pairs of stations
</p>
</li>
<li> <p><strong>covZ</strong> covariance matrix of the MAR(1) process
</p>
</li>
<li> <p><strong>sdZ</strong> standard deviation of the diagonal elements
</p>
</li>
<li> <p><strong>corZ</strong> correlation matrix of the MAR(1) process
</p>
</li>
<li> <p><strong>dfStudent</strong> degrees of freedom for the Student copula if CopulaInt is equal to &quot;Student&quot;
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Guillaume Evin
</p>


<h3>References</h3>

<p>Matalas, N. C. 1967. “Mathematical Assessment of Synthetic Hydrology.” Water Resources 
Research 3 (4): 937–45. https://doi.org/10.1029/WR003i004p00937.
</p>
<p>Bárdossy, A., and G. G. S. Pegram. 2009. “Copula Based Multisite Model for Daily 
Precipitation Simulation.” Hydrology and Earth System Sciences 13 (12): 2299–2314. https://doi.org/10.5194/hess-13-2299-2009.
</p>

<hr>
<h2 id='fit.margin.cdf'>fit.margin.cdf</h2><span id='topic+fit.margin.cdf'></span>

<h3>Description</h3>

<p>estimate parameters which control the marginal distribution of precipitation amounts
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit.margin.cdf(P.mat, isPeriod, th, type = c("EGPD", "mixExp"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit.margin.cdf_+3A_p.mat">P.mat</code></td>
<td>
<p>precipitation matrix</p>
</td></tr>
<tr><td><code id="fit.margin.cdf_+3A_isperiod">isPeriod</code></td>
<td>
<p>vector of logical n x 1 indicating the days concerned by a 3-month period</p>
</td></tr>
<tr><td><code id="fit.margin.cdf_+3A_th">th</code></td>
<td>
<p>threshold above which we consider that a day is wet (e.g. 0.2 mm)</p>
</td></tr>
<tr><td><code id="fit.margin.cdf_+3A_type">type</code></td>
<td>
<p>distribution: 'EGPD' or 'mixExp'</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>matrix</code></td>
<td>
<p>matrix of estimates p x 3</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Guillaume Evin
</p>

<hr>
<h2 id='fitGwexModel'>fitGwexModel: fit a GWex model to observations.</h2><span id='topic+fitGwexModel'></span>

<h3>Description</h3>

<p>fitGwexModel: fit a GWex model to observations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitGwexModel(objGwexObs, parMargin = NULL, listOption = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitGwexModel_+3A_objgwexobs">objGwexObs</code></td>
<td>
<p>an object of class <code><a href="#topic+GwexObs-class">GwexObs</a></code></p>
</td></tr>
<tr><td><code id="fitGwexModel_+3A_parmargin">parMargin</code></td>
<td>
<p>(not required for temperature) list parMargin where
and each element corresponds to a month (1...12) and contains a 
matrix nStation x 3 of pre-estimated parameters of the marginal distributions
(EGPD or Mixture of Exponentials)</p>
</td></tr>
<tr><td><code id="fitGwexModel_+3A_listoption">listOption</code></td>
<td>
<p>for precipitation, a list with the following fields:
</p>

<ul>
<li> <p><strong>th</strong>: threshold value in mm above which precipitation observations are considered to be non-zero (=0.2 by default)
</p>
</li>
<li> <p><strong>nLag</strong>: order of the Markov chain for the transitions between dry and wet states (=2 by default)
</p>
</li>
<li> <p><strong>typeMargin</strong>: 'EGPD' (Extended GPD) or 'mixExp' (Mixture of Exponentials). 'mixExp' by default
</p>
</li>
<li> <p><strong>copulaInt</strong>: 'Gaussian' or 'Student': type of dependence for amounts (='Gaussian' by default)
</p>
</li>
<li> <p><strong>isMAR</strong>: logical value, do we apply a Autoregressive Multivariate Autoregressive model (order 1) = FALSE by default
</p>
</li>
<li> <p><strong>is3Damount</strong>: logical value, do we apply the model on 3D-amount. =FALSE by default
</p>
</li>
<li> <p><strong>nChainFit</strong>: integer, length of the runs which are generated during the fitting procedure. =100000 by default
</p>
</li>
<li> <p><strong>nCluster</strong>: integer, number of clusters which can be used for the parallel computation
</p>
</li></ul>

<p>and for temperature, a list with the following fields:
</p>

<ul>
<li> <p><strong>hasTrend</strong>: logical value, do we fit a linear trend for the long-term change, =FALSE by default
</p>
</li>
<li> <p><strong>objGwexPrec</strong>: object of class <code><a href="#topic+GwexObs-class">GwexObs</a></code> containing precipitation observations. If provided, we assume 
that temperature must be modelled and simulated according to the precipitation states 'dry' and 'wet'. For each state, a seasonal cycle is fitted (mean and sd).
</p>
</li>
<li> <p><strong>typeMargin</strong>: 'SGED' (default) or 'Gaussian': type of marginal distribution.
</p>
</li>
<li> <p><strong>depStation</strong>: 'MAR1' (default) or 'Gaussian': MAR1 (Multivariate Autoregressive model order 1) for the spatial and temporal dependence or 'Gaussian' 
for the spatial dependence only.
</p>
</li></ul>
</td></tr>
</table>


<h3>Value</h3>

<p>Return an object of class <code><a href="#topic+GwexFit-class">GwexFit</a></code> with:
</p>

<ul>
<li> <p><strong>p</strong>: The number of station,
</p>
</li>
<li> <p><strong>version</strong>: package version,
</p>
</li>
<li> <p><strong>variable</strong>: the type of variable,
</p>
</li>
<li> <p><strong>fit</strong>: a list containing the list of options <code>listOption</code>
and the list of estimated parameters <code>listPar</code>.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Guillaume Evin
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Format dates corresponding to daily observations of precipitation and temperature
vecDates = seq(from=as.Date("01/01/2005",format="%d/%m/%Y"),
to=as.Date("31/12/2014",format="%d/%m/%Y"),by='day')

###############################################################
#               FIT THE PRECIPITATION MODEL
###############################################################

# Format observations: create a Gwex object for one station only to show a quick
# example. The syntax is similar for multi-site applications.
myObsPrec = GwexObs(variable='Prec',date=vecDates,obs=dailyPrecipGWEX[,1,drop=FALSE])

# Fit precipitation model with a threshold of 0.5 mm to distinguish wet and dry 
# states (th) and keep default options otherwise, e.g. a Gaussian
# copula for the spatial dependence (copulaInt) and a mixExp distribution for 
# marginal intensities ('typeMargin')
myParPrec = fitGwexModel(myObsPrec,listOption=list(th=0.5))
myParPrec # print object

###############################################################
#     FIT THE TEMPERATURE MODEL, COND. TO PRECIPITATION
###############################################################
# Format observations: create a G-Wex object
myObsTemp = GwexObs(variable='Temp',date=vecDates,obs=dailyTemperGWEX)

# Fit temperature model with a long-term linear trend ('hasTrend'), Gaussian margins 
# ('typeMargin') and Gaussian spatial dependence ('depStation')
myParTemp = fitGwexModel(myObsTemp,listOption=list(hasTrend=TRUE,typeMargin='Gaussian',
depStation='Gaussian'))
myParTemp # print object
</code></pre>

<hr>
<h2 id='functions.EGPD.GI'>EGPD.pGI, EGPD.dGI, EGPD.qGI</h2><span id='topic+functions.EGPD.GI'></span><span id='topic+EGPD.pGI'></span><span id='topic+EGPD.dGI'></span><span id='topic+EGPD.qGI'></span>

<h3>Description</h3>

<p>First parametric family for G(v) = v^kappa: distribution, density and quantile function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EGPD.pGI(v, kappa)

EGPD.dGI(v, kappa)

EGPD.qGI(p, kappa)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="functions.EGPD.GI_+3A_v">v</code></td>
<td>
<p>probability</p>
</td></tr>
<tr><td><code id="functions.EGPD.GI_+3A_kappa">kappa</code></td>
<td>
<p>transformation parameter greater than 0</p>
</td></tr>
<tr><td><code id="functions.EGPD.GI_+3A_p">p</code></td>
<td>
<p>probability</p>
</td></tr>
</table>


<h3>Value</h3>

<p>distribution, density and quantile of EGPD
</p>


<h3>Author(s)</h3>

<p>Guillaume Evin
</p>

<hr>
<h2 id='get.df.Student'>get.df.Student</h2><span id='topic+get.df.Student'></span>

<h3>Description</h3>

<p>Estimates the nu parameter (degrees of freedom) of the multivariate Student
distribution when the correlation matrix Sig is given
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.df.Student(P, Sig, max.df = 20)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get.df.Student_+3A_p">P</code></td>
<td>
<p>matrix of non-zero precipitation (zero precipitation are set to NA)</p>
</td></tr>
<tr><td><code id="get.df.Student_+3A_sig">Sig</code></td>
<td>
<p>correlation matrix</p>
</td></tr>
<tr><td><code id="get.df.Student_+3A_max.df">max.df</code></td>
<td>
<p>maximum degrees of freedom tested (default=20)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>nu estimate
</p>


<h3>Author(s)</h3>

<p>Guillaume Evin
</p>


<h3>References</h3>

<p>McNeil et al. (2005) &quot;Quantitative Risk Management&quot;
</p>

<hr>
<h2 id='get.emp.cdf.matrix'>get.df.Student</h2><span id='topic+get.emp.cdf.matrix'></span>

<h3>Description</h3>

<p>get the cdf values (empirical distribution) of positive precipitation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.emp.cdf.matrix(X)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get.emp.cdf.matrix_+3A_x">X</code></td>
<td>
<p>matrix of positive precipitation</p>
</td></tr>
</table>


<h3>Value</h3>

<p>matrix with cdf values (NA if zero precipitation)
</p>


<h3>Author(s)</h3>

<p>Guillaume Evin
</p>

<hr>
<h2 id='get.list.month'>get.list.month</h2><span id='topic+get.list.month'></span>

<h3>Description</h3>

<p>return a vector of 3-char tags of the 12 months
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.list.month()
</code></pre>

<hr>
<h2 id='get.list.season'>get.list.season</h2><span id='topic+get.list.season'></span>

<h3>Description</h3>

<p>get the vector of the four seasons c('DJF','MAM','JJA','SON')
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.list.season()
</code></pre>


<h3>Author(s)</h3>

<p>Guillaume Evin
</p>

<hr>
<h2 id='get.listOption'>get.listOption</h2><span id='topic+get.listOption'></span>

<h3>Description</h3>

<p>get default options and check values proposed by the user
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.listOption(listOption)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get.listOption_+3A_listoption">listOption</code></td>
<td>
<p>list containing fields corr. to the different options. Can be NULL if no options are set</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>listOption</code></td>
<td>
<p>list of options</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Guillaume Evin
</p>

<hr>
<h2 id='get.M0'>get.M0</h2><span id='topic+get.M0'></span>

<h3>Description</h3>

<p>find matrix of correlations leading to estimates cor between intensities
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.M0(
  cor.obs,
  infer.mat.omega.out,
  nLag,
  parMargin,
  typeMargin,
  nChainFit,
  isParallel
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get.M0_+3A_cor.obs">cor.obs</code></td>
<td>
<p>matrix p x p of observed correlations between intensities for all pairs of stations</p>
</td></tr>
<tr><td><code id="get.M0_+3A_infer.mat.omega.out">infer.mat.omega.out</code></td>
<td>
<p>output of <code><a href="#topic+infer.mat.omega">infer.mat.omega</a></code></p>
</td></tr>
<tr><td><code id="get.M0_+3A_nlag">nLag</code></td>
<td>
<p>order of the Markov chain</p>
</td></tr>
<tr><td><code id="get.M0_+3A_parmargin">parMargin</code></td>
<td>
<p>parameters of the margins p x 3</p>
</td></tr>
<tr><td><code id="get.M0_+3A_typemargin">typeMargin</code></td>
<td>
<p>type of marginal distribution: 'EGPD' or 'mixExp'</p>
</td></tr>
<tr><td><code id="get.M0_+3A_nchainfit">nChainFit</code></td>
<td>
<p>integer indicating the length of simulated chains</p>
</td></tr>
<tr><td><code id="get.M0_+3A_isparallel">isParallel</code></td>
<td>
<p>logical: indicate computation in parallel or not (easier for debugging)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list with two items
</p>

<ul>
<li> <p><strong>Xt</strong> long simulation of the wet/dry states according to the model
</p>
</li>
<li> <p><strong>M0</strong> covariance matrix of gaussianized prec. amounts for all pairs of stations
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Guillaume Evin
</p>

<hr>
<h2 id='get.mat.omega'>get.mat.omega</h2><span id='topic+get.mat.omega'></span>

<h3>Description</h3>

<p>find omega correlation leading to estimates cor between occurrences
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.mat.omega(cor.obs, Qtrans.mat, mat.comb, nLag, nChainFit, isParallel)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get.mat.omega_+3A_cor.obs">cor.obs</code></td>
<td>
<p>matrix p x p of observed correlations between occurrences for all pairs of stations</p>
</td></tr>
<tr><td><code id="get.mat.omega_+3A_qtrans.mat">Qtrans.mat</code></td>
<td>
<p>transition probabilities, 2 x ncomb matrix</p>
</td></tr>
<tr><td><code id="get.mat.omega_+3A_mat.comb">mat.comb</code></td>
<td>
<p>matrix of logical: ncomb x nlag</p>
</td></tr>
<tr><td><code id="get.mat.omega_+3A_nlag">nLag</code></td>
<td>
<p>order of the Markov chain</p>
</td></tr>
<tr><td><code id="get.mat.omega_+3A_nchainfit">nChainFit</code></td>
<td>
<p>length of the simulated chains used during the fitting</p>
</td></tr>
<tr><td><code id="get.mat.omega_+3A_isparallel">isParallel</code></td>
<td>
<p>logical: indicate computation in parallel or not (easier for debugging)</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>matrix</code></td>
<td>
<p>omega correlations for all pairs of stations</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Guillaume Evin
</p>

<hr>
<h2 id='get.period.fitting.month'>get.period.fitting.month</h2><span id='topic+get.period.fitting.month'></span>

<h3>Description</h3>

<p>get.period.fitting.month
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.period.fitting.month(m.char)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get.period.fitting.month_+3A_m.char">m.char</code></td>
<td>
<p>3-letter name of a month (e.g. 'JAN')
</p>
<p>return the 3 indices corresponding to the 3-month period of a month ('JAN')</p>
</td></tr>
</table>

<hr>
<h2 id='get.vec.autocor'>get.vec.autocor</h2><span id='topic+get.vec.autocor'></span>

<h3>Description</h3>

<p>find rho autocorrelation leading to empirical estimates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.vec.autocor(vec.ar1.obs, Xt, parMargin, typeMargin, nChainFit, isParallel)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get.vec.autocor_+3A_vec.ar1.obs">vec.ar1.obs</code></td>
<td>
<p>vector of observed autocorrelations for all stations</p>
</td></tr>
<tr><td><code id="get.vec.autocor_+3A_xt">Xt</code></td>
<td>
<p>simulated occurrences given model parameters of wet/dry states</p>
</td></tr>
<tr><td><code id="get.vec.autocor_+3A_parmargin">parMargin</code></td>
<td>
<p>parameters of the margins p x 3</p>
</td></tr>
<tr><td><code id="get.vec.autocor_+3A_typemargin">typeMargin</code></td>
<td>
<p>type of marginal distribution: 'EGPD' or 'mixExp'</p>
</td></tr>
<tr><td><code id="get.vec.autocor_+3A_nchainfit">nChainFit</code></td>
<td>
<p>integer indicating the length of the simulated chains</p>
</td></tr>
<tr><td><code id="get.vec.autocor_+3A_isparallel">isParallel</code></td>
<td>
<p>logical: indicate computation in parallel or not (easier for debugging)</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>vector</code></td>
<td>
<p>vector of rho parameters to simulate the MAR process</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Guillaume Evin
</p>

<hr>
<h2 id='getGwexFitPrec'>getGwexFitPrec</h2><span id='topic+getGwexFitPrec'></span>

<h3>Description</h3>

<p>get object GwexFit derived from the parameters replicated for each month
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getGwexFitPrec(
  listOption = NULL,
  p,
  condProbaWDstates,
  parMargin,
  vec.ar1 = NULL,
  M0 = NULL,
  mat.omega = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getGwexFitPrec_+3A_listoption">listOption</code></td>
<td>
<p>list of options (see <code><a href="#topic+fitGwexModel">fitGwexModel</a></code>)</p>
</td></tr>
<tr><td><code id="getGwexFitPrec_+3A_p">p</code></td>
<td>
<p>number of stations</p>
</td></tr>
<tr><td><code id="getGwexFitPrec_+3A_condprobawdstates">condProbaWDstates</code></td>
<td>
<p>vector of length nLag^2 of transition probabilities
corresponding to the nlag possible transitions between dry/wet states
<code>expand.grid(lapply(numeric(nLag), function(x) c(F,T)))</code></p>
</td></tr>
<tr><td><code id="getGwexFitPrec_+3A_parmargin">parMargin</code></td>
<td>
<p>parameters of the margins: vector of length 3</p>
</td></tr>
<tr><td><code id="getGwexFitPrec_+3A_vec.ar1">vec.ar1</code></td>
<td>
<p>vector of observed autocorrelations for all stations</p>
</td></tr>
<tr><td><code id="getGwexFitPrec_+3A_m0">M0</code></td>
<td>
<p><strong>M0</strong>: covariance matrix of gaussianized prec. amounts for all pairs of stations</p>
</td></tr>
<tr><td><code id="getGwexFitPrec_+3A_mat.omega">mat.omega</code></td>
<td>
<p><strong>mat.omega</strong>: The spatial correlation matrix of occurrences <code class="reqn">\Omega</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Return an object of class <code><a href="#topic+GwexFit-class">GwexFit</a></code> with:
</p>

<ul>
<li> <p><strong>p</strong>: The number of station,
</p>
</li>
<li> <p><strong>version</strong>: package version,
</p>
</li>
<li> <p><strong>variable</strong>: the type of variable,
</p>
</li>
<li> <p><strong>fit</strong>: a list containing the list of options <code>listOption</code>
and the list of estimated parameters <code>listPar</code>.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>exFitGwexPrec = getGwexFitPrec(p=2,condProbaWDstates=c(0.7,0.3,0.2,0.1),
parMargin=c(0.5,0.1,0.4),vec.ar1=rep(0.7,2),M0=rbind(c(1,0.6),c(0.6,1)),
mat.omega=rbind(c(1,0.8),c(0.8,1)))
</code></pre>

<hr>
<h2 id='Gwex-class'>Class Gwex</h2><span id='topic+Gwex-class'></span>

<h3>Description</h3>

<p>Defines a generic <code><a href="#topic+Gwex-class">Gwex</a></code> object.
GWex objects contain two slots:
- the version ('vX.X.X')
- the type of variable ('Prec' or 'Temp')
</p>


<h3>Author(s)</h3>

<p>Guillaume Evin
</p>

<hr>
<h2 id='GwexFit-class'>Class GwexFit</h2><span id='topic+GwexFit-class'></span>

<h3>Description</h3>

<p>Defines a <code><a href="#topic+GwexFit-class">GwexFit</a></code> object which is a <code><a href="#topic+Gwex-class">Gwex</a></code> object containing 'fit', a list containing the fitted parameters, and 'p', the number of stations.
See <a href="#topic+fitGwexModel">fitGwexModel</a> for some examples.
</p>


<h3>Author(s)</h3>

<p>Guillaume Evin
</p>

<hr>
<h2 id='GwexObs'>Constructor</h2><span id='topic+GwexObs'></span>

<h3>Description</h3>

<p>Constructor of class [<code><a href="#topic+GwexObs-class">GwexObs</a></code>]
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GwexObs(variable, date, obs)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GwexObs_+3A_variable">variable</code></td>
<td>
<p>'Prec' or 'Temp'</p>
</td></tr>
<tr><td><code id="GwexObs_+3A_date">date</code></td>
<td>
<p>vector of class 'Date'</p>
</td></tr>
<tr><td><code id="GwexObs_+3A_obs">obs</code></td>
<td>
<p>matrix nTime x nStations of observations</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class [<code><a href="#topic+GwexObs-class">GwexObs</a></code>]
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Format dates corresponding to daily observations of precipitation and temperature
vecDates = seq(from=as.Date("01/01/2005",format="%d/%m/%Y"),
to=as.Date("31/12/2014",format="%d/%m/%Y"),by='day')

# build GwexObs object with precipitation data
myObsPrec = GwexObs(variable='Prec',date=vecDates,obs=dailyPrecipGWEX)

# print GwexObs object
myObsPrec 

# build GwexObs object with temperature data
myObsTemp = GwexObs(variable='Temp',date=vecDates,obs=dailyTemperGWEX)

# print GwexObs object
myObsTemp
</code></pre>

<hr>
<h2 id='GwexObs-class'>Class <code><a href="#topic+GwexObs-class">GwexObs</a></code></h2><span id='topic+GwexObs-class'></span>

<h3>Description</h3>

<p>Defines a <code><a href="#topic+GwexObs-class">GwexObs</a></code> object which is a <code><a href="#topic+Gwex-class">Gwex</a></code> object containing dates and a matrix of observations.
</p>


<h3>Author(s)</h3>

<p>Guillaume Evin
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Format dates corresponding to daily observations of precipitation and temperature
vecDates = seq(from=as.Date("01/01/2005",format="%d/%m/%Y"),
to=as.Date("31/12/2014",format="%d/%m/%Y"),by='day')

# build GwexObs object with precipitation data
myObsPrec = GwexObs(variable='Prec',date=vecDates,obs=dailyPrecipGWEX)

# print GwexObs object
myObsPrec 

# build GwexObs object with temperature data
myObsTemp = GwexObs(variable='Temp',date=vecDates,obs=dailyTemperGWEX)

# print GwexObs object
myObsTemp
</code></pre>

<hr>
<h2 id='GwexSim-class'>Defines a <code><a href="#topic+GwexSim-class">GwexSim</a></code> object which is a <code><a href="#topic+Gwex-class">Gwex</a></code> object containing 'sim', an array containing the simulations, and 'dates', a vector of dates.
See <a href="#topic+simGwexModel">simGwexModel</a> for some examples.</h2><span id='topic+GwexSim-class'></span>

<h3>Description</h3>

<p>Defines a <code><a href="#topic+GwexSim-class">GwexSim</a></code> object which is a <code><a href="#topic+Gwex-class">Gwex</a></code> object containing 'sim', an array containing the simulations, and 'dates', a vector of dates.
See <a href="#topic+simGwexModel">simGwexModel</a> for some examples.
</p>


<h3>Author(s)</h3>

<p>Guillaume Evin
</p>

<hr>
<h2 id='infer.autocor.amount'>infer.autocor.amount</h2><span id='topic+infer.autocor.amount'></span>

<h3>Description</h3>

<p>special case of <code><a href="#topic+infer.dep.amount">infer.dep.amount</a></code> where there is only one station
</p>


<h3>Usage</h3>

<pre><code class='language-R'>infer.autocor.amount(
  P.mat,
  pr.state,
  isPeriod,
  nLag,
  th,
  parMargin,
  typeMargin,
  nChainFit,
  isMAR,
  isParallel
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="infer.autocor.amount_+3A_p.mat">P.mat</code></td>
<td>
<p>precipitation matrix</p>
</td></tr>
<tr><td><code id="infer.autocor.amount_+3A_pr.state">pr.state</code></td>
<td>
<p>probabilities of transitions for a Markov chain with lag <code>p</code>.</p>
</td></tr>
<tr><td><code id="infer.autocor.amount_+3A_isperiod">isPeriod</code></td>
<td>
<p>vector of logical n x 1 indicating the days concerned by a 3-month period</p>
</td></tr>
<tr><td><code id="infer.autocor.amount_+3A_nlag">nLag</code></td>
<td>
<p>order of he Markov chain for the transitions between dry and wet states (=2 by default)</p>
</td></tr>
<tr><td><code id="infer.autocor.amount_+3A_th">th</code></td>
<td>
<p>threshold above which we consider that a day is wet (e.g. 0.2 mm)</p>
</td></tr>
<tr><td><code id="infer.autocor.amount_+3A_parmargin">parMargin</code></td>
<td>
<p>parameters of the margins 2 x 3</p>
</td></tr>
<tr><td><code id="infer.autocor.amount_+3A_typemargin">typeMargin</code></td>
<td>
<p>'EGPD' (Extended GPD) or 'mixExp' (Mixture of Exponentials). 'EGPD' by default</p>
</td></tr>
<tr><td><code id="infer.autocor.amount_+3A_nchainfit">nChainFit</code></td>
<td>
<p>integer, length of the runs used during the fitting procedure. =100000 by default</p>
</td></tr>
<tr><td><code id="infer.autocor.amount_+3A_ismar">isMAR</code></td>
<td>
<p>logical value, do we apply a Autoregressive Multivariate Autoregressive model (order 1) =TRUE by default</p>
</td></tr>
<tr><td><code id="infer.autocor.amount_+3A_isparallel">isParallel</code></td>
<td>
<p>logical: indicate computation in parallel or not (easier for debugging)</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>list</code></td>
<td>
<p>list of estimates (e.g., M0, dfStudent)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Guillaume Evin
</p>

<hr>
<h2 id='infer.dep.amount'>infer.dep.amount</h2><span id='topic+infer.dep.amount'></span>

<h3>Description</h3>

<p>estimate parameters which control the spatial dependence between intensities using a copula
</p>


<h3>Usage</h3>

<pre><code class='language-R'>infer.dep.amount(
  P.mat,
  isPeriod,
  infer.mat.omega.out,
  nLag,
  th,
  parMargin,
  typeMargin,
  nChainFit,
  isMAR,
  copulaInt,
  isParallel
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="infer.dep.amount_+3A_p.mat">P.mat</code></td>
<td>
<p>precipitation matrix</p>
</td></tr>
<tr><td><code id="infer.dep.amount_+3A_isperiod">isPeriod</code></td>
<td>
<p>vector of logical n x 1 indicating the days concerned by a 3-month period</p>
</td></tr>
<tr><td><code id="infer.dep.amount_+3A_infer.mat.omega.out">infer.mat.omega.out</code></td>
<td>
<p>output of <code><a href="#topic+infer.mat.omega">infer.mat.omega</a></code></p>
</td></tr>
<tr><td><code id="infer.dep.amount_+3A_nlag">nLag</code></td>
<td>
<p>order of he Markov chain for the transitions between dry and wet states (=2 by default)</p>
</td></tr>
<tr><td><code id="infer.dep.amount_+3A_th">th</code></td>
<td>
<p>threshold above which we consider that a day is wet (e.g. 0.2 mm)</p>
</td></tr>
<tr><td><code id="infer.dep.amount_+3A_parmargin">parMargin</code></td>
<td>
<p>parameters of the margins 2 x 3</p>
</td></tr>
<tr><td><code id="infer.dep.amount_+3A_typemargin">typeMargin</code></td>
<td>
<p>'EGPD' (Extended GPD) or 'mixExp' (Mixture of Exponentials). 'EGPD' by default</p>
</td></tr>
<tr><td><code id="infer.dep.amount_+3A_nchainfit">nChainFit</code></td>
<td>
<p>integer, length of the runs used during the fitting procedure. =100000 by default</p>
</td></tr>
<tr><td><code id="infer.dep.amount_+3A_ismar">isMAR</code></td>
<td>
<p>logical value, do we apply a Autoregressive Multivariate Autoregressive model (order 1) =TRUE by default</p>
</td></tr>
<tr><td><code id="infer.dep.amount_+3A_copulaint">copulaInt</code></td>
<td>
<p>'Gaussian' or 'Student': type of dependence for amounts (='Student' by default)</p>
</td></tr>
<tr><td><code id="infer.dep.amount_+3A_isparallel">isParallel</code></td>
<td>
<p>logical: indicate computation in parallel or not (easier for debugging)</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>list</code></td>
<td>
<p>list of estimates (e.g., M0, dfStudent)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Guillaume Evin
</p>

<hr>
<h2 id='infer.mat.omega'>infer.mat.omega</h2><span id='topic+infer.mat.omega'></span>

<h3>Description</h3>

<p>find omega correlation leading to estimates cor between occurrences
</p>


<h3>Usage</h3>

<pre><code class='language-R'>infer.mat.omega(P.mat, isPeriod, th, nLag, pr.state, nChainFit, isParallel)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="infer.mat.omega_+3A_p.mat">P.mat</code></td>
<td>
<p>matrix of precipitation n x p</p>
</td></tr>
<tr><td><code id="infer.mat.omega_+3A_isperiod">isPeriod</code></td>
<td>
<p>vector of logical n x 1 indicating the days concerned by a 3-month period</p>
</td></tr>
<tr><td><code id="infer.mat.omega_+3A_th">th</code></td>
<td>
<p>threshold above which we consider that a day is wet (e.g. 0.2 mm)</p>
</td></tr>
<tr><td><code id="infer.mat.omega_+3A_nlag">nLag</code></td>
<td>
<p>order of the Markov chain</p>
</td></tr>
<tr><td><code id="infer.mat.omega_+3A_pr.state">pr.state</code></td>
<td>
<p>output of function <code><a href="#topic+lagTransProbaMatrix">lagTransProbaMatrix</a></code></p>
</td></tr>
<tr><td><code id="infer.mat.omega_+3A_nchainfit">nChainFit</code></td>
<td>
<p>length of the simulated chains used during the fitting</p>
</td></tr>
<tr><td><code id="infer.mat.omega_+3A_isparallel">isParallel</code></td>
<td>
<p>logical: indicate computation in parallel or not (easier for debugging)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with different objects 
</p>

<ul>
<li> <p><strong>Qtrans.mat</strong>: matrix nStation x n.comb of transition probabilites
</p>
</li>
<li> <p><strong>mat.comb</strong>: matrix of possible combination n.comb x nLag
</p>
</li>
<li> <p><strong>mat.omega</strong>: The spatial correlation matrix of occurrences <code class="reqn">\Omega</code> (see Evin et al., 2018).
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Guillaume Evin
</p>

<hr>
<h2 id='joint.proba.occ'>joint.proba.occ</h2><span id='topic+joint.proba.occ'></span>

<h3>Description</h3>

<p>joint probabilities of occurrences for all pairs of stations
</p>


<h3>Usage</h3>

<pre><code class='language-R'>joint.proba.occ(P, th)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="joint.proba.occ_+3A_p">P</code></td>
<td>
<p>matrix of precipitation</p>
</td></tr>
<tr><td><code id="joint.proba.occ_+3A_th">th</code></td>
<td>
<p>threshold above which we consider that a day is wet (e.g. 0.2 mm)</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>list</code></td>
<td>
<p>list of joint probabilities</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Guillaume Evin
</p>

<hr>
<h2 id='lagTransProbaMatrix'>lagTransProbaMatrix</h2><span id='topic+lagTransProbaMatrix'></span>

<h3>Description</h3>

<p>Estimate the transition probabilities between wet and dry states, for nlag previous days,
for all stations
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lagTransProbaMatrix(mat.prec, isPeriod, th, nlag)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lagTransProbaMatrix_+3A_mat.prec">mat.prec</code></td>
<td>
<p>matrix of precipitation</p>
</td></tr>
<tr><td><code id="lagTransProbaMatrix_+3A_isperiod">isPeriod</code></td>
<td>
<p>vector of logical n x 1 indicating the days concerned by a 3-month period</p>
</td></tr>
<tr><td><code id="lagTransProbaMatrix_+3A_th">th</code></td>
<td>
<p>threshold above which we consider that a day is wet (e.g. 0.2 mm)</p>
</td></tr>
<tr><td><code id="lagTransProbaMatrix_+3A_nlag">nlag</code></td>
<td>
<p>number of lag days</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>list</code></td>
<td>
<p>list with one item per station, where each item is a
matrix nLag^2 x (nLag+1) of transition probability between dry/wet state.
The first nLag columns indicate the wet/dry states for the previous nLag days</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Guillaume Evin
</p>

<hr>
<h2 id='lagTransProbaVector'>lagTransProbaVector</h2><span id='topic+lagTransProbaVector'></span>

<h3>Description</h3>

<p>Estimate the transition probabilities between wet and dry states, for nlag previous days,
for one station
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lagTransProbaVector(vec.prec, isPeriod, th, nlag)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lagTransProbaVector_+3A_vec.prec">vec.prec</code></td>
<td>
<p>vector nx1 of precipitation for one station</p>
</td></tr>
<tr><td><code id="lagTransProbaVector_+3A_isperiod">isPeriod</code></td>
<td>
<p>vector of logical n x 1 indicating the days concerned by a 3-month period</p>
</td></tr>
<tr><td><code id="lagTransProbaVector_+3A_th">th</code></td>
<td>
<p>threshold above which we consider that a day is wet (e.g. 0.2 mm)</p>
</td></tr>
<tr><td><code id="lagTransProbaVector_+3A_nlag">nlag</code></td>
<td>
<p>number of lag days</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>matrix</code></td>
<td>
<p>matrix nLag^2 x (nLag+1) of transition probability between dry/wet state.
The first nLag columns indicate the wet/dry states for the previous nLag days</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Guillaume Evin
</p>

<hr>
<h2 id='mask.GWex.Yt'>mask.GWex.Yt</h2><span id='topic+mask.GWex.Yt'></span>

<h3>Description</h3>

<p>Mask intensities where there is no occurrence
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mask.GWex.Yt(Xt, Yt)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mask.GWex.Yt_+3A_xt">Xt</code></td>
<td>
<p>simulated occurrences</p>
</td></tr>
<tr><td><code id="mask.GWex.Yt_+3A_yt">Yt</code></td>
<td>
<p>simulated intensities</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>matrix</code></td>
<td>
<p>matrix n x p of simulated precipitations</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Guillaume Evin
</p>

<hr>
<h2 id='modify.cor.matrix'>modify.cor.matrix</h2><span id='topic+modify.cor.matrix'></span>

<h3>Description</h3>

<p>Modify a non-positive definite correlation matrix in order to have a positive 
definite matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>modify.cor.matrix(cor.matrix)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="modify.cor.matrix_+3A_cor.matrix">cor.matrix</code></td>
<td>
<p>possibly non-positive definite correlation matrix</p>
</td></tr>
</table>


<h3>Value</h3>

<p>positive definite correlation matrix
</p>


<h3>Author(s)</h3>

<p>Guillaume Evin
</p>


<h3>References</h3>

<p>Rousseeuw, P. J. and G. Molenberghs. 1993. Transformation of non positive semidefinite
correlation matrices. Communications in Statistics: Theory and Methods 22(4):965-984.
</p>
<p>Rebonato, R., &amp; Jackel, P. (2000). The most general methodology to create a valid 
correlation matrix for risk management and option pricing purposes. J. Risk, 2(2), 17-26.
</p>

<hr>
<h2 id='month2season'>month2season</h2><span id='topic+month2season'></span>

<h3>Description</h3>

<p>transform vector of months to seasons
</p>


<h3>Usage</h3>

<pre><code class='language-R'>month2season(vecMonth)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="month2season_+3A_vecmonth">vecMonth</code></td>
<td>
<p>a vector of months given as integers 1:12</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Guillaume Evin
</p>

<hr>
<h2 id='print+2CGwex-method'>print-methods: Create a method to print Gwex objects.</h2><span id='topic+print+2CGwex-method'></span><span id='topic+print+2CGwexObs-method'></span><span id='topic+print+2CGwexFit-method'></span><span id='topic+print+2CGwexSim-method'></span>

<h3>Description</h3>

<p>print-methods: Create a method to print Gwex objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'Gwex'
print(x)

## S4 method for signature 'GwexObs'
print(x)

## S4 method for signature 'GwexFit'
print(x)

## S4 method for signature 'GwexSim'
print(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print+2B2CGwex-method_+3A_x">x</code></td>
<td>
<p><code><a href="#topic+Gwex-class">Gwex</a></code> object</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># Format dates corresponding to daily observations of precipitation and temperature
vecDates = seq(from=as.Date("01/01/2005",format="%d/%m/%Y"),
to=as.Date("31/12/2014",format="%d/%m/%Y"),by='day')

# build GwexObs object with temperature data
myObsTemp = GwexObs(variable='Temp',date=vecDates,obs=dailyTemperGWEX)

# print GwexObs object
myObsTemp
</code></pre>

<hr>
<h2 id='PWM.EGPD.GI'>EGPD.GI.mu0, EGPD.GI.mu1, EGPD.GI.mu2</h2><span id='topic+PWM.EGPD.GI'></span><span id='topic+EGPD.GI.mu0'></span><span id='topic+EGPD.GI.mu1'></span><span id='topic+EGPD.GI.mu2'></span>

<h3>Description</h3>

<p>Probability Weighted Moments of order 0, 1 and 2 of the unified EGPD distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EGPD.GI.mu0(kappa, sig, xi)

EGPD.GI.mu1(kappa, sig, xi)

EGPD.GI.mu2(kappa, sig, xi)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PWM.EGPD.GI_+3A_kappa">kappa</code></td>
<td>
<p>transformation parameter greater than 0</p>
</td></tr>
<tr><td><code id="PWM.EGPD.GI_+3A_sig">sig</code></td>
<td>
<p>Scale parameter</p>
</td></tr>
<tr><td><code id="PWM.EGPD.GI_+3A_xi">xi</code></td>
<td>
<p>Shape parameter</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Probability Weighted Moments
</p>


<h3>Author(s)</h3>

<p>Guillaume Evin
</p>

<hr>
<h2 id='QtransMat2Array'>QtransMat2Array</h2><span id='topic+QtransMat2Array'></span>

<h3>Description</h3>

<p>reshape Qtrans.mat to an array
</p>


<h3>Usage</h3>

<pre><code class='language-R'>QtransMat2Array(n, p, Qtrans.mat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="QtransMat2Array_+3A_n">n</code></td>
<td>
<p>matrix of precipitation</p>
</td></tr>
<tr><td><code id="QtransMat2Array_+3A_p">p</code></td>
<td>
<p>number of stations</p>
</td></tr>
<tr><td><code id="QtransMat2Array_+3A_qtrans.mat">Qtrans.mat</code></td>
<td>
<p>transition probabilities, 2 x ncomb matrix</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>array</code></td>
<td>
<p>array of transition probabilities with dimension n x p x n.comb</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Guillaume Evin
</p>

<hr>
<h2 id='show+2CGwex-method'>show-methods: Create a method to show Gwex objects.</h2><span id='topic+show+2CGwex-method'></span><span id='topic+show+2CGwexObs-method'></span><span id='topic+show+2CGwexFit-method'></span><span id='topic+show+2CGwexSim-method'></span>

<h3>Description</h3>

<p>show-methods: Create a method to show Gwex objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'Gwex'
show(object)

## S4 method for signature 'GwexObs'
show(object)

## S4 method for signature 'GwexFit'
show(object)

## S4 method for signature 'GwexSim'
show(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="show+2B2CGwex-method_+3A_object">object</code></td>
<td>
<p><code><a href="#topic+Gwex-class">Gwex</a></code> object</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># Format dates corresponding to daily observations of precipitation and temperature
vecDates = seq(from=as.Date("01/01/2005",format="%d/%m/%Y"),
to=as.Date("31/12/2014",format="%d/%m/%Y"),by='day')

# build GwexObs object with temperature data
myObsTemp = GwexObs(variable='Temp',date=vecDates,obs=dailyTemperGWEX)

# show GwexObs object
myObsTemp
</code></pre>

<hr>
<h2 id='sim.GWex.occ'>sim.GWex.occ</h2><span id='topic+sim.GWex.occ'></span>

<h3>Description</h3>

<p>generate boolean variates which describe the dependence
between intersite occurrence correlations and wet/dry persistence
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim.GWex.occ(objGwexFit, vecMonth)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim.GWex.occ_+3A_objgwexfit">objGwexFit</code></td>
<td>
<p>object of class GwexFit</p>
</td></tr>
<tr><td><code id="sim.GWex.occ_+3A_vecmonth">vecMonth</code></td>
<td>
<p>vector n x 1 of integers indicating the months</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>matrix of logical</code></td>
<td>
<p>occurrences simulated</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Guillaume Evin
</p>

<hr>
<h2 id='sim.GWex.prec.1it'>sim.GWex.prec.1it</h2><span id='topic+sim.GWex.prec.1it'></span>

<h3>Description</h3>

<p>Simulate one scenario of precipitation from the GWex model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim.GWex.prec.1it(objGwexFit, vecDates, myseed, objGwexObs, prob.class)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim.GWex.prec.1it_+3A_objgwexfit">objGwexFit</code></td>
<td>
<p>object of class GwexFit</p>
</td></tr>
<tr><td><code id="sim.GWex.prec.1it_+3A_vecdates">vecDates</code></td>
<td>
<p>vector of continuous dates</p>
</td></tr>
<tr><td><code id="sim.GWex.prec.1it_+3A_myseed">myseed</code></td>
<td>
<p>seed of the random generation, to be fixed if the results need to be replicated</p>
</td></tr>
<tr><td><code id="sim.GWex.prec.1it_+3A_objgwexobs">objGwexObs</code></td>
<td>
<p>optional: necessary if we need observations to simulate (e.g. disaggregation of 3-day periods)</p>
</td></tr>
<tr><td><code id="sim.GWex.prec.1it_+3A_prob.class">prob.class</code></td>
<td>
<p>vector of probabilities indicating class of &quot;similar&quot; mean intensities</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>matrix</code></td>
<td>
<p>Precipitation simulated for the dates contained in vec.Dates at the different stations</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Guillaume Evin
</p>

<hr>
<h2 id='sim.GWex.Yt'>sim.GWex.Yt</h2><span id='topic+sim.GWex.Yt'></span>

<h3>Description</h3>

<p>Inverse PIT: from the probability space to the precipitation
space
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim.GWex.Yt(objGwexFit, vecMonth, Yt.Pr)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim.GWex.Yt_+3A_objgwexfit">objGwexFit</code></td>
<td>
<p>object of class GwexFit</p>
</td></tr>
<tr><td><code id="sim.GWex.Yt_+3A_vecmonth">vecMonth</code></td>
<td>
<p>vector of integer indicating the months</p>
</td></tr>
<tr><td><code id="sim.GWex.Yt_+3A_yt.pr">Yt.Pr</code></td>
<td>
<p>uniform variates describing dependence between inter-site amounts</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>matrix</code></td>
<td>
<p>matrix n x p of simulated non-zero precipitation intensities</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Guillaume Evin
</p>

<hr>
<h2 id='sim.GWex.Yt.Pr'>sim.GWex.Yt.Pr</h2><span id='topic+sim.GWex.Yt.Pr'></span>

<h3>Description</h3>

<p>generate uniform variates which describe the dependence between intersite amount
correlations
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim.GWex.Yt.Pr(objGwexFit, vecMonth)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim.GWex.Yt.Pr_+3A_objgwexfit">objGwexFit</code></td>
<td>
<p>object of class GwexFit</p>
</td></tr>
<tr><td><code id="sim.GWex.Yt.Pr_+3A_vecmonth">vecMonth</code></td>
<td>
<p>vector n x 1 of integer indicating the months</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>matrix</code></td>
<td>
<p>matrix n x p of uniform dependent variates</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Guillaume Evin
</p>

<hr>
<h2 id='sim.GWex.Yt.Pr.get.param'>sim.GWex.Yt.Pr.get.param</h2><span id='topic+sim.GWex.Yt.Pr.get.param'></span>

<h3>Description</h3>

<p>get relevant parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim.GWex.Yt.Pr.get.param(objGwexFit, iM)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim.GWex.Yt.Pr.get.param_+3A_objgwexfit">objGwexFit</code></td>
<td>
<p>object of class GwexFit</p>
</td></tr>
<tr><td><code id="sim.GWex.Yt.Pr.get.param_+3A_im">iM</code></td>
<td>
<p>integer indicating the month</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>list</code></td>
<td>
<p>list of parameters</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Guillaume Evin
</p>

<hr>
<h2 id='sim.Zt.MAR'>sim.Zt.MAR</h2><span id='topic+sim.Zt.MAR'></span>

<h3>Description</h3>

<p>generate gaussian variates which describe the spatial and temporal dependence
between the sites (MAR(1) process)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim.Zt.MAR(PAR, copulaInt, Zprev, p)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim.Zt.MAR_+3A_par">PAR</code></td>
<td>
<p>parameters for this class</p>
</td></tr>
<tr><td><code id="sim.Zt.MAR_+3A_copulaint">copulaInt</code></td>
<td>
<p>'Gaussian' or 'Student'</p>
</td></tr>
<tr><td><code id="sim.Zt.MAR_+3A_zprev">Zprev</code></td>
<td>
<p>previous Gaussian variate</p>
</td></tr>
<tr><td><code id="sim.Zt.MAR_+3A_p">p</code></td>
<td>
<p>number of stations</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>matrix</code></td>
<td>
<p>matrix n x p of uniform dependent variates</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Guillaume Evin
</p>

<hr>
<h2 id='sim.Zt.Spatial'>sim.Zt.Spatial</h2><span id='topic+sim.Zt.Spatial'></span>

<h3>Description</h3>

<p>generate gaussian variates which describe the spatial dependence between the sites
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim.Zt.Spatial(PAR, copulaInt, p)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim.Zt.Spatial_+3A_par">PAR</code></td>
<td>
<p>parameters for a class</p>
</td></tr>
<tr><td><code id="sim.Zt.Spatial_+3A_copulaint">copulaInt</code></td>
<td>
<p>'Gaussian' or 'Student'</p>
</td></tr>
<tr><td><code id="sim.Zt.Spatial_+3A_p">p</code></td>
<td>
<p>number of stations</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>matrix</code></td>
<td>
<p>matrix n x p of uniform dependent variates</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Guillaume Evin
</p>

<hr>
<h2 id='simGwexModel'>simGwexModel</h2><span id='topic+simGwexModel'></span>

<h3>Description</h3>

<p>Simulate from a GWex model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simGwexModel(
  objGwexFit,
  nb.rep = 10,
  d.start = as.Date("01011900", "%d%m%Y"),
  d.end = as.Date("31121999", "%d%m%Y"),
  objGwexObs = NULL,
  prob.class = c(0.5, 0.75, 0.9, 0.99),
  objGwexSim = NULL,
  nCluster = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simGwexModel_+3A_objgwexfit">objGwexFit</code></td>
<td>
<p>an object of class <code><a href="#topic+GwexFit-class">GwexFit</a></code></p>
</td></tr>
<tr><td><code id="simGwexModel_+3A_nb.rep">nb.rep</code></td>
<td>
<p>number of repetitions of scenarios</p>
</td></tr>
<tr><td><code id="simGwexModel_+3A_d.start">d.start</code></td>
<td>
<p>a starting date for the simulation</p>
</td></tr>
<tr><td><code id="simGwexModel_+3A_d.end">d.end</code></td>
<td>
<p>an ending date for the simulation</p>
</td></tr>
<tr><td><code id="simGwexModel_+3A_objgwexobs">objGwexObs</code></td>
<td>
<p>optional: an object of class <code><a href="#topic+GwexObs-class">GwexObs</a></code> if we need the observations to simulate (disaggregation prec 3D -&gt; 1D)</p>
</td></tr>
<tr><td><code id="simGwexModel_+3A_prob.class">prob.class</code></td>
<td>
<p>vector of probabilities indicating class of &quot;similar&quot; mean intensities</p>
</td></tr>
<tr><td><code id="simGwexModel_+3A_objgwexsim">objGwexSim</code></td>
<td>
<p>optional: an object of class <code><a href="#topic+GwexSim-class">GwexSim</a></code> if we need simulations to simulate (temp conditional to prec)</p>
</td></tr>
<tr><td><code id="simGwexModel_+3A_ncluster">nCluster</code></td>
<td>
<p>optional, number of clusters which can be used for the parallel computation</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>GwexSim</code></td>
<td>
<p>an object of class <code><a href="#topic+GwexSim-class">GwexSim</a></code>. Contains sim (3D-array with the simulations) and a vector of dates</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Guillaume Evin
</p>


<h3>Examples</h3>

<pre><code class='language-R'># vector of dates
vecDates = seq(from=as.Date("01/01/2005",format="%d/%m/%Y"),
to=as.Date("31/12/2014",format="%d/%m/%Y"),by='day')

###############################################################
#               FIT AND SIMULATE FROM THE PRECIPITATION MODEL
###############################################################
# Format observations: create a G-Wex object
myObsPrec = GwexObs(variable='Prec',date=vecDates,obs=dailyPrecipGWEX[,1,drop=FALSE])

# Fit GWEX precipitation model, default options except for the threshold th
myParPrec = fitGwexModel(myObsPrec,listOption=list(th=0.5)) # fit model

# Generate 2 scenarios for one year, using the 'GwexFit' object
mySimPrec = simGwexModel(objGwexFit=myParPrec, nb.rep=2, d.start=vecDates[1],
d.end=vecDates[10])
mySimPrec # print object

###############################################################
#     FIT AND SIMULATE FROM THE TEMPERATURE MODEL
###############################################################
# Format observations: create a G-Wex object
myObsTemp = GwexObs(variable='Temp',date=vecDates,obs=dailyTemperGWEX)

# Fit GWEX temperature model
myParTemp = fitGwexModel(myObsTemp,listOption=list(hasTrend=TRUE,typeMargin='Gaussian',
depStation='Gaussian'))

# Generate 2 scenarios for one year, using an existing 'GwexFit' object
mySimTemp = simGwexModel(objGwexFit=myParTemp, nb.rep=2, d.start=vecDates[1], 
                          d.end=vecDates[365],objGwexObs=myObsPrec)
mySimTemp # print object
</code></pre>

<hr>
<h2 id='simPrecipOcc'>simPrecipOcc</h2><span id='topic+simPrecipOcc'></span>

<h3>Description</h3>

<p>find matrix of correlations leading to estimates cor between intensities
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simPrecipOcc(nLag, n, pr)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simPrecipOcc_+3A_nlag">nLag</code></td>
<td>
<p>order of the Markov chain</p>
</td></tr>
<tr><td><code id="simPrecipOcc_+3A_n">n</code></td>
<td>
<p>integer indicating the length of simulated chains</p>
</td></tr>
<tr><td><code id="simPrecipOcc_+3A_pr">pr</code></td>
<td>
<p>vector of probabilies corr. to the conditional transition probabilities</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector Xt of length n with values 0/1 corr. to dry/wet states
</p>


<h3>Author(s)</h3>

<p>Guillaume Evin
</p>

<hr>
<h2 id='unif.to.prec'>unif.to.prec</h2><span id='topic+unif.to.prec'></span>

<h3>Description</h3>

<p>from uniform variates to precipitation variates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>unif.to.prec(pI, typeMargin, U)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="unif.to.prec_+3A_pi">pI</code></td>
<td>
<p>vector of three parameters of the marginal distributions</p>
</td></tr>
<tr><td><code id="unif.to.prec_+3A_typemargin">typeMargin</code></td>
<td>
<p>type of marginal distribution: 'EGPD' or 'mixExp'</p>
</td></tr>
<tr><td><code id="unif.to.prec_+3A_u">U</code></td>
<td>
<p>vector of uniform variates</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>matrix</code></td>
<td>
<p>matrix of estimates p x 3</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Guillaume Evin
</p>

<hr>
<h2 id='wet.day.frequency'>wet.day.frequency</h2><span id='topic+wet.day.frequency'></span>

<h3>Description</h3>

<p>Estimate the wet day frequency (proportion of wet days) for all stations
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wet.day.frequency(mat.prec, th)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wet.day.frequency_+3A_mat.prec">mat.prec</code></td>
<td>
<p>matrix of precipitation (possibly for one month/period)</p>
</td></tr>
<tr><td><code id="wet.day.frequency_+3A_th">th</code></td>
<td>
<p>threshold above which we consider that a day is wet (e.g. 0.2 mm)</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>vector of numeric</code></td>
<td>
<p>wet day frequencies</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Guillaume Evin
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
