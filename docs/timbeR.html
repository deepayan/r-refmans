<!DOCTYPE html><html lang="en"><head><title>Help for package timbeR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {timbeR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#+25+26gt+3B+25'><p>Pipe operator</p></a></li>
<li><a href='#bi_di'><p>Estimate the diameter at a given height based on a fitted Bi (2000) taper equation.</p></a></li>
<li><a href='#bi_hi'><p>Estimate the height at which a given diameter occurs in a tree, based on a fitted Bi (2000) taper equation.</p></a></li>
<li><a href='#bi_logs'><p>Simulate log extraction using a Bi (2000) variable-form taper equation that describes the taper of the tree.</p></a></li>
<li><a href='#bi_logs_plot'><p>Visualize the simulation of log cutting along the stem using a Bi (2000) variable-form taper equation.</p></a></li>
<li><a href='#bi_vol'><p>Estimate the total or partial volume of the tree, based on a fitted Bi (2000) taper function.</p></a></li>
<li><a href='#kozak_di'><p>Estimate the diameter at a given height based on a fitted Kozak (2004) taper equation.</p></a></li>
<li><a href='#kozak_hi'><p>Estimate the height at which a given diameter occurs in a tree, based on a fitted Kozak (2004) taper equation.</p></a></li>
<li><a href='#kozak_logs'><p>Simulate log extraction using a Kozak (2004) variable-form taper equation that describes the taper of the tree.</p></a></li>
<li><a href='#kozak_logs_plot'><p>Visualize the simulation of log cutting along the stem using a Kozak (2004) variable-form taper equation.</p></a></li>
<li><a href='#kozak_vol'><p>Estimate the total or partial volume of the tree, based on a fitted Kozak (2004) taper function.</p></a></li>
<li><a href='#poly5_di'><p>Estimate the diameter at a given height based on a 5th degree polynomial function.</p></a></li>
<li><a href='#poly5_hi'><p>Estimate the height at which a given diameter occurs in a tree, based on a 5th degree polynomial function.</p></a></li>
<li><a href='#poly5_logs'><p>Simulate log extraction using a 5th degree polynomial that describes the taper of the tree.</p></a></li>
<li><a href='#poly5_logs_plot'><p>Visualize the simulation of log cutting along the stem using a 5th degree polynomial that describes the tree taper.</p></a></li>
<li><a href='#poly5_vol'><p>Estimate the total or partial volume of the tree, based on a 5th degree polynomial function that describes the taper of the tree.</p></a></li>
<li><a href='#select_and_remove'><p>Remove unwanted data by selecting it</p></a></li>
<li><a href='#taper_bi'><p>Bi (2004) Taper Function.</p></a></li>
<li><a href='#taper_kozak'><p>Kozak (2004) Taper Function.</p></a></li>
<li><a href='#tree_scaling'><p>Tree scaling example data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Calculate Wood Volumes from Taper Functions</td>
</tr>
<tr>
<td>Version:</td>
<td>2.0.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions for estimation of wood volumes, number of logs, diameters along the stem and heights at which certain diameters occur, based on taper functions and other parameters. References: McTague, J. P., &amp; Weiskittel, A. (2021). &lt;<a href="https://doi.org/10.1139%2Fcjfr-2020-0326">doi:10.1139/cjfr-2020-0326</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R(&ge; 3.3)</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr, ggplot2, cowplot, tidyr, tibble, magrittr, miniUI,
shiny</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>Suggests:</td>
<td>rmarkdown, knitr, minpack.lm, purrr</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-04-06 15:03:32 UTC; sergio.costa</td>
</tr>
<tr>
<td>Author:</td>
<td>Sergio Costa <a href="https://orcid.org/0000-0001-5432-317X"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre, cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Sergio Costa &lt;sergio.vscf@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-04-11 14:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='+25+26gt+3B+25'>Pipe operator</h2><span id='topic++25+3E+25'></span>

<h3>Description</h3>

<p>See <code>magrittr::<a href="magrittr.html#topic+pipe">%&gt;%</a></code> for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lhs %&gt;% rhs
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_lhs">lhs</code></td>
<td>
<p>A value or the magrittr placeholder.</p>
</td></tr>
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_rhs">rhs</code></td>
<td>
<p>A function call using the magrittr semantics.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The result of calling <code>rhs(lhs)</code>.
</p>

<hr>
<h2 id='bi_di'>Estimate the diameter at a given height based on a fitted Bi (2000) taper equation.</h2><span id='topic+bi_di'></span>

<h3>Description</h3>

<p>Estimates the diameter at a given height of a tree from the diameter at breast height, total height and the coefficients of the Bi taper function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bi_di(dbh, h, hi, coef)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bi_di_+3A_dbh">dbh</code></td>
<td>
<p>tree diameter at breast height, in centimeters.</p>
</td></tr>
<tr><td><code id="bi_di_+3A_h">h</code></td>
<td>
<p>total tree height, in meters.</p>
</td></tr>
<tr><td><code id="bi_di_+3A_hi">hi</code></td>
<td>
<p>height at which the diameter will be calculated, in meters.</p>
</td></tr>
<tr><td><code id="bi_di_+3A_coef">coef</code></td>
<td>
<p>numerical vector containing seven coefficients of the Bi taper function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>the Bi (2000) variable-form taper function is represented mathematically by the following expression
</p>
<p>di ~ dbh * (log(sin((pi/2) * (hi/h)))/(log(sin((pi/2) * (1.3/h)))))^(b0 + b1 * sin((pi/2) * (hi/h)) + b2 * cos((3 * pi/2) * (hi/h)) + b3 * (sin((pi/2) * (hi/h))/(hi/h)) + b4 * dbh + b5 * (hi/h) * dbh^0.5 + b6 * (hi/h) * h^0.5)
</p>


<h3>Value</h3>

<p>a numeric value indicating the diameter at the given height.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(dplyr)
library(minpack.lm)
library(timbeR)

tree_scaling &lt;- tree_scaling %&gt;%
mutate(did = di/dbh,
       hih = hi/h)

bi &lt;-  nlsLM(di ~ taper_bi(dbh, h, hih, b0, b1, b2, b3, b4, b5, b6),
data=tree_scaling,
start=list(b0=1.8,b1=-0.2,b2=-0.04,b3=-0.9,b4=-0.0006,b5=0.07,b6=-.14))

coef_bi &lt;- coef(bi)

dbh &lt;- 25
h &lt;- 20
hi &lt;- 15

bi_di(dbh, h, hi, coef_bi)

</code></pre>

<hr>
<h2 id='bi_hi'>Estimate the height at which a given diameter occurs in a tree, based on a fitted Bi (2000) taper equation.</h2><span id='topic+bi_hi'></span>

<h3>Description</h3>

<p>Estimates the height at which a given diameter occurs in a tree, from the diameter at breast height, total height and coefficients of the Bi taper function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bi_hi(dbh, h, di, coef)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bi_hi_+3A_dbh">dbh</code></td>
<td>
<p>tree diameter at breast height, in centimeters.</p>
</td></tr>
<tr><td><code id="bi_hi_+3A_h">h</code></td>
<td>
<p>total tree height, in meters.</p>
</td></tr>
<tr><td><code id="bi_hi_+3A_di">di</code></td>
<td>
<p>diameter whose height of occurrence will be estimated, in centimeters.</p>
</td></tr>
<tr><td><code id="bi_hi_+3A_coef">coef</code></td>
<td>
<p>numerical vector containing seven coefficients of the Bi taper equation</p>
</td></tr>
</table>


<h3>Details</h3>

<p>the Bi (2000) variable-form taper function is represented mathematically by the following expression
</p>
<p>di ~ dbh * (log(sin((pi/2) * (hi/h)))/(log(sin((pi/2) * (1.3/h)))))^(b0 + b1 * sin((pi/2) * (hi/h)) + b2 * cos((3 * pi/2) * (hi/h)) + b3 * (sin((pi/2) * (hi/h))/(hi/h)) + b4 * dbh + b5 * (hi/h) * dbh^0.5 + b6 * (hi/h) * h^0.5)
</p>


<h3>Value</h3>

<p>a numeric value indicating the height at which the given diameter occurs.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(dplyr)
library(minpack.lm)
library(timbeR)

tree_scaling &lt;- tree_scaling %&gt;%
mutate(did = di/dbh,
       hih = hi/h)

bi &lt;-  nlsLM(di ~ taper_bi(dbh, h, hih, b0, b1, b2, b3, b4, b5, b6),
data=tree_scaling,
start=list(b0=1.8,b1=-0.2,b2=-0.04,b3=-0.9,b4=-0.0006,b5=0.07,b6=-.14))

coef_bi &lt;- coef(bi)

dbh &lt;- 25
h &lt;- 20
di &lt;- 5

bi_hi(dbh, h, di, coef_bi)

</code></pre>

<hr>
<h2 id='bi_logs'>Simulate log extraction using a Bi (2000) variable-form taper equation that describes the taper of the tree.</h2><span id='topic+bi_logs'></span>

<h3>Description</h3>

<p>Simulate the extraction of logs from a tree from its measurements, taper function (Bi (2000) variable-form taper equation ), trunk quality characteristics and harvest parameters such as stump height and assortments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bi_logs(
  dbh,
  h,
  coef,
  assortments,
  stump_height,
  downgrade,
  broken,
  defect_height,
  eliminate,
  total_volume,
  only_vol
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bi_logs_+3A_dbh">dbh</code></td>
<td>
<p>tree diameter at breast height, in centimeters.</p>
</td></tr>
<tr><td><code id="bi_logs_+3A_h">h</code></td>
<td>
<p>total tree height, in meters.</p>
</td></tr>
<tr><td><code id="bi_logs_+3A_coef">coef</code></td>
<td>
<p>numerical vector containing seven coefficients of the Bi taper equation.</p>
</td></tr>
<tr><td><code id="bi_logs_+3A_assortments">assortments</code></td>
<td>
<p>a data.frame with five columns and n rows, where n is the number of different wood assortments to be obtained from the tree stem. The first column must contain the names of the assortments, the second, numerical, contains the minimum diameters at the small end of the logs, in centimeters. The third column, numerical, contains the minimum lengths of the logs, in meters. The fourth column, numerical, contains the maximum lengths of the logs, in meters. The fifth column, numerical, contains the values in centimeters referring to the loss of wood due to cutting logs. The algorithm prioritizes the extraction of assortments along the stem in the order presented in the data.frame, starting from the first line, to the last.</p>
</td></tr>
<tr><td><code id="bi_logs_+3A_stump_height">stump_height</code></td>
<td>
<p>tree cutting height, in meters. Default is 0.</p>
</td></tr>
<tr><td><code id="bi_logs_+3A_downgrade">downgrade</code></td>
<td>
<p>if TRUE, the algorithm,from the defect_height onwards, simulates log extraction only for the last assortment in the assortments data.frame. Default is FALSE.</p>
</td></tr>
<tr><td><code id="bi_logs_+3A_broken">broken</code></td>
<td>
<p>if TRUE, the algorithm will simulate the extraction of logs only up to the defect_height. Default is FALSE.</p>
</td></tr>
<tr><td><code id="bi_logs_+3A_defect_height">defect_height</code></td>
<td>
<p>the height, in meters, from which the logs will be downgraded (if downgrade is TRUE) or log extraction simulation will be stopped (if broken is TRUE). Default is 0 for downgrade = TRUE (the whole tree is downgraded) and h * 0.5 for broken = TRUE (the tree is broken from half its original/estimated total height).</p>
</td></tr>
<tr><td><code id="bi_logs_+3A_eliminate">eliminate</code></td>
<td>
<p>if TRUE, the algorithm does not get logs for any assortment present in the assortments table. All will be zero. Default is FALSE.</p>
</td></tr>
<tr><td><code id="bi_logs_+3A_total_volume">total_volume</code></td>
<td>
<p>if TRUE, it adds an additional column to the results data.frame with the estimate of the total volume of the tree, from the ground height to h if broken argument is FALSE, or to defect_height if broken is TRUE. Default is FALSE.</p>
</td></tr>
<tr><td><code id="bi_logs_+3A_only_vol">only_vol</code></td>
<td>
<p>if TRUE returns only volumes (does not return the number of logs). Default is FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>when the <code>broken</code> and <code>downgrade</code> arguments are set to TRUE, the <code>defect_height</code> value is considered as the break height of the tree, and the entire tree is downgraded.
</p>


<h3>Value</h3>

<p>a list of two data.frames, the first (volumes) with the calculated volumes per assortment, and the second (logs) with the number of logs per assortment.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(dplyr)
library(minpack.lm)
library(timbeR)

tree_scaling &lt;- tree_scaling %&gt;%
mutate(did = di/dbh,
       hih = hi/h)

bi &lt;-  nlsLM(di ~ taper_bi(dbh, h, hih, b0, b1, b2, b3, b4, b5, b6),
data=tree_scaling,
start=list(b0=1.8,b1=-0.2,b2=-0.04,b3=-0.9,b4=-0.0006,b5=0.07,b6=-.14))

coef_bi &lt;- coef(bi)

dbh &lt;- 25
h &lt;- 20

assortments &lt;- data.frame(
  NAME = c('15-25','4-15'),
  SED = c(15,4),
  MINLENGTH = c(2.65,2),
  MAXLENGTH = c(2.65,4.2),
  LOSS = c(5,5)
)

bi_logs(dbh, h, coef_bi, assortments)

</code></pre>

<hr>
<h2 id='bi_logs_plot'>Visualize the simulation of log cutting along the stem using a Bi (2000) variable-form taper equation.</h2><span id='topic+bi_logs_plot'></span>

<h3>Description</h3>

<p>Plot the shape of the tree and visualize the extracted logs based on the tree measurements, assortments data.frame, and the Bi (2000) variable-form taper equation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bi_logs_plot(
  dbh,
  h,
  coef,
  assortments,
  stump_height,
  downgrade,
  broken,
  defect_height,
  lang
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bi_logs_plot_+3A_dbh">dbh</code></td>
<td>
<p>tree diameter at breast height, in centimeters.</p>
</td></tr>
<tr><td><code id="bi_logs_plot_+3A_h">h</code></td>
<td>
<p>total tree height, in meters.</p>
</td></tr>
<tr><td><code id="bi_logs_plot_+3A_coef">coef</code></td>
<td>
<p>numerical vector containing seven coefficients of the Bi variable-form taper equation.</p>
</td></tr>
<tr><td><code id="bi_logs_plot_+3A_assortments">assortments</code></td>
<td>
<p>a data.frame with five columns and n rows, where n is the number of different wood assortments to be obtained from the tree stem. The first column must contain the names of the assortments, the second, numerical, contains the minimum diameters at the small end of the logs, in centimeters. The third column, numerical, contains the minimum lengths of the logs, in meters. The fourth column, numerical, contains the maximum lengths of the logs, in meters. The fifth column, numerical, contains the values in centimeters referring to the loss of wood due to cutting logs. The algorithm prioritizes the extraction of assortments along the stem in the order presented in the data.frame, starting from the first line, to the last.</p>
</td></tr>
<tr><td><code id="bi_logs_plot_+3A_stump_height">stump_height</code></td>
<td>
<p>tree cutting height, in meters. Default is 0.</p>
</td></tr>
<tr><td><code id="bi_logs_plot_+3A_downgrade">downgrade</code></td>
<td>
<p>if TRUE, the algorithm,from the defect_height onwards, simulates log extraction only for the last assortment in the assortments data.frame. Default is FALSE.</p>
</td></tr>
<tr><td><code id="bi_logs_plot_+3A_broken">broken</code></td>
<td>
<p>if TRUE, the algorithm will simulate the extraction of logs only up to the defect_height. Default is FALSE.</p>
</td></tr>
<tr><td><code id="bi_logs_plot_+3A_defect_height">defect_height</code></td>
<td>
<p>the height, in meters, from which the logs will be downgraded (if downgrade is TRUE) or log extraction simulation will be stopped (if broken is TRUE). Default is h * 0.5.</p>
</td></tr>
<tr><td><code id="bi_logs_plot_+3A_lang">lang</code></td>
<td>
<p>language in which plot labels will be displayed. Current options are 'en' and 'pt-BR'. Default is 'en'.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>check the <code>bi_logs</code> function help for more details.
</p>


<h3>Value</h3>

<p>a ggplot object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(dplyr)
library(minpack.lm)
library(timbeR)

tree_scaling &lt;- tree_scaling %&gt;%
mutate(did = di/dbh,
       hih = hi/h)

bi &lt;-  nlsLM(di ~ taper_bi(dbh, h, hih, b0, b1, b2, b3, b4, b5, b6),
data=tree_scaling,
start=list(b0=1.8,b1=-0.2,b2=-0.04,b3=-0.9,b4=-0.0006,b5=0.07,b6=-.14))

coef_bi &lt;- coef(bi)

dbh &lt;- 25
h &lt;- 20

assortments &lt;- data.frame(
  NAME = c('15-25','4-15'),
  SED = c(15,4),
  MINLENGTH = c(2.65,2),
  MAXLENGTH = c(2.65,4.2),
  LOSS = c(5,5)
)

bi_logs_plot(dbh, h, coef_bi, assortments)

</code></pre>

<hr>
<h2 id='bi_vol'>Estimate the total or partial volume of the tree, based on a fitted Bi (2000) taper function.</h2><span id='topic+bi_vol'></span>

<h3>Description</h3>

<p>Estimates the total or partial volume of the tree from the diameter at breast height, total height, initial section height, final section height and coefficients of the Bi (2000) taper equation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bi_vol(dbh, h, coef, hi, h0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bi_vol_+3A_dbh">dbh</code></td>
<td>
<p>tree diameter at breast height, in centimeters.</p>
</td></tr>
<tr><td><code id="bi_vol_+3A_h">h</code></td>
<td>
<p>total tree height, in meters.</p>
</td></tr>
<tr><td><code id="bi_vol_+3A_coef">coef</code></td>
<td>
<p>numerical vector containing seven coefficients of the Bi taper equation.</p>
</td></tr>
<tr><td><code id="bi_vol_+3A_hi">hi</code></td>
<td>
<p>final height of the tree section whose volume will be calculated, in meters. Default is the total tree height (h).</p>
</td></tr>
<tr><td><code id="bi_vol_+3A_h0">h0</code></td>
<td>
<p>initial height of the tree section whose volume will be calculated, in meters. Default is 0 (ground height).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>the Bi (2000) variable-form taper function is represented mathematically by the following expression
</p>
<p>di ~ dbh * (log(sin((pi/2) * (hi/h)))/(log(sin((pi/2) * (1.3/h)))))^(b0 + b1 * sin((pi/2) * (hi/h)) + b2 * cos((3 * pi/2) * (hi/h)) + b3 * (sin((pi/2) * (hi/h))/(hi/h)) + b4 * dbh + b5 * (hi/h) * dbh^0.5 + b6 * (hi/h) * h^0.5)
</p>


<h3>Value</h3>

<p>a numeric value indicating the total or partial volume of the tree.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(dplyr)
library(minpack.lm)
library(timbeR)

tree_scaling &lt;- tree_scaling %&gt;%
mutate(did = di/dbh,
       hih = hi/h)

bi &lt;-  nlsLM(di ~ taper_bi(dbh, h, hih, b0, b1, b2, b3, b4, b5, b6),
data=tree_scaling,
start=list(b0=1.8,b1=-0.2,b2=-0.04,b3=-0.9,b4=-0.0006,b5=0.07,b6=-.14))

coef_bi &lt;- coef(bi)

dbh &lt;- 25
h &lt;- 20

bi_vol(dbh, h, coef_bi)

hi = 15
h0 = .2

bi_vol(dbh, h, coef_bi, hi, h0)

</code></pre>

<hr>
<h2 id='kozak_di'>Estimate the diameter at a given height based on a fitted Kozak (2004) taper equation.</h2><span id='topic+kozak_di'></span>

<h3>Description</h3>

<p>Estimates the diameter at a given height of a tree from the diameter at breast height, total height and the coefficients of the Kozak (2004) taper function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kozak_di(dbh, h, hi, coef, p)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="kozak_di_+3A_dbh">dbh</code></td>
<td>
<p>tree diameter at breast height, in centimeters.</p>
</td></tr>
<tr><td><code id="kozak_di_+3A_h">h</code></td>
<td>
<p>total tree height, in meters.</p>
</td></tr>
<tr><td><code id="kozak_di_+3A_hi">hi</code></td>
<td>
<p>height at which the diameter will be calculated, in meters.</p>
</td></tr>
<tr><td><code id="kozak_di_+3A_coef">coef</code></td>
<td>
<p>numerical vector containing nine coefficients of the Kozak taper function.</p>
</td></tr>
<tr><td><code id="kozak_di_+3A_p">p</code></td>
<td>
<p>numerical value representing the first inflection point calculated in the segmented model of Max and Burkhart (1976).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>the Kozak (2004) variable-form taper function is represented mathematically by the following expression
</p>
<p>di ~b0*(dbh^b1)<em>(h^b2)</em>((1-(hi/h)^(1/4))/(1-(p^(1/3))))^(b3*(hi/h)^4+b4*(1/exp(dbh/h))+b5*((1-(hi/h)^(1/4))/(1-(p^(1/3))))^0.1+b6*(1/dbh)+b7*(h^(1-(hi/h)^(1/3)))+b8*((1-(hi/h)^(1/4))/(1-(p^(1/3)))))
</p>


<h3>Value</h3>

<p>a numeric value indicating the diameter at the given height.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(dplyr)
library(minpack.lm)
library(timbeR)

tree_scaling &lt;- tree_scaling %&gt;%
mutate(did = di/dbh,
       hih = hi/h)

kozak &lt;- nlsLM(di ~ taper_kozak(dbh, h, hih, b0, b1, b2, b3, b4, b5, b6, b7, b8, p),
               start=list(b0=1.00,b1=.97,b2=.03,b3=.49,b4=-
                            0.87,b5=0.50,b6=3.88,b7=0.03,b8=-0.19, p = .1),
               data = tree_scaling,
               control = nls.lm.control(maxiter = 1000, maxfev = 2000)
)

coef_kozak &lt;- coef(kozak)[-10]
p_kozak &lt;- coef(kozak)[10]

h &lt;- 20
dbh &lt;- 25
di &lt;- 5

kozak_di(dbh, h, di, coef_kozak, p_kozak)

</code></pre>

<hr>
<h2 id='kozak_hi'>Estimate the height at which a given diameter occurs in a tree, based on a fitted Kozak (2004) taper equation.</h2><span id='topic+kozak_hi'></span>

<h3>Description</h3>

<p>Estimates the height at which a given diameter occurs in a tree, from the diameter at breast height, total height and coefficients of the Kozak (2004) taper function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kozak_hi(dbh, h, di, coef, p)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="kozak_hi_+3A_dbh">dbh</code></td>
<td>
<p>tree diameter at breast height, in centimeters.</p>
</td></tr>
<tr><td><code id="kozak_hi_+3A_h">h</code></td>
<td>
<p>total tree height, in meters.</p>
</td></tr>
<tr><td><code id="kozak_hi_+3A_di">di</code></td>
<td>
<p>diameter whose height of occurrence will be estimated, in centimeters.</p>
</td></tr>
<tr><td><code id="kozak_hi_+3A_coef">coef</code></td>
<td>
<p>numerical vector containing nine coefficients of the Kozak taper equation</p>
</td></tr>
<tr><td><code id="kozak_hi_+3A_p">p</code></td>
<td>
<p>numerical value representing the first inflection point calculated in the segmented model of Max and Burkhart (1976).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>the Kozak (2004) variable-form taper function is represented mathematically by the following expression
</p>
<p>di ~b0*(dbh^b1)<em>(h^b2)</em>((1-(hi/h)^(1/4))/(1-(p^(1/3))))^(b3*(hi/h)^4+b4*(1/exp(dbh/h))+b5*((1-(hi/h)^(1/4))/(1-(p^(1/3))))^0.1+b6*(1/dbh)+b7*(h^(1-(hi/h)^(1/3)))+b8*((1-(hi/h)^(1/4))/(1-(p^(1/3)))))
</p>


<h3>Value</h3>

<p>as numeric value indicating the height at which the given diameter occurs.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(dplyr)
library(minpack.lm)
library(timbeR)

tree_scaling &lt;- tree_scaling %&gt;%
mutate(did = di/dbh,
       hih = hi/h)

kozak &lt;- nlsLM(di ~ taper_kozak(dbh, h, hih, b0, b1, b2, b3, b4, b5, b6, b7, b8, p),
               start=list(b0=1.00,b1=.97,b2=.03,b3=.49,b4=-
                            0.87,b5=0.50,b6=3.88,b7=0.03,b8=-0.19, p = .1),
               data = tree_scaling,
               control = nls.lm.control(maxiter = 1000, maxfev = 2000)
)

coef_kozak &lt;- coef(kozak)[-10]
p_kozak &lt;- coef(kozak)[10]

h &lt;- 20
dbh &lt;- 25
hi &lt;- 15

kozak_hi(dbh, h, hi, coef_kozak, p_kozak)

</code></pre>

<hr>
<h2 id='kozak_logs'>Simulate log extraction using a Kozak (2004) variable-form taper equation that describes the taper of the tree.</h2><span id='topic+kozak_logs'></span>

<h3>Description</h3>

<p>Simulate the extraction of logs from a tree from its measurements, taper function (Kozak (2004) variable-form taper equation ), trunk quality characteristics and harvest parameters such as stump height and assortments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kozak_logs(
  dbh,
  h,
  coef,
  p,
  assortments,
  stump_height,
  downgrade,
  broken,
  defect_height,
  eliminate,
  total_volume,
  only_vol
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="kozak_logs_+3A_dbh">dbh</code></td>
<td>
<p>tree diameter at breast height, in centimeters.</p>
</td></tr>
<tr><td><code id="kozak_logs_+3A_h">h</code></td>
<td>
<p>total tree height, in meters.</p>
</td></tr>
<tr><td><code id="kozak_logs_+3A_coef">coef</code></td>
<td>
<p>numerical vector containing nine coefficients of the Kozak taper equation.</p>
</td></tr>
<tr><td><code id="kozak_logs_+3A_p">p</code></td>
<td>
<p>numerical value representing the first inflection point calculated in the segmented model of Max and Burkhart (1976).</p>
</td></tr>
<tr><td><code id="kozak_logs_+3A_assortments">assortments</code></td>
<td>
<p>a data.frame with five columns and n rows, where n is the number of different wood assortments to be obtained from the tree stem. The first column must contain the names of the assortments, the second, numerical, contains the minimum diameters at the small end of the logs, in centimeters. The third column, numerical, contains the minimum lengths of the logs, in meters. The fourth column, numerical, contains the maximum lengths of the logs, in meters. The fifth column, numerical, contains the values in centimeters referring to the loss of wood due to cutting logs. The algorithm prioritizes the extraction of assortments along the stem in the order presented in the data.frame, starting from the first line, to the last.</p>
</td></tr>
<tr><td><code id="kozak_logs_+3A_stump_height">stump_height</code></td>
<td>
<p>tree cutting height, in meters. Default is 0.</p>
</td></tr>
<tr><td><code id="kozak_logs_+3A_downgrade">downgrade</code></td>
<td>
<p>if TRUE, the algorithm,from the defect_height onwards, simulates log extraction only for the last assortment in the assortments data.frame. Default is FALSE.</p>
</td></tr>
<tr><td><code id="kozak_logs_+3A_broken">broken</code></td>
<td>
<p>if TRUE, the algorithm will simulate the extraction of logs only up to the defect_height. Default is FALSE.</p>
</td></tr>
<tr><td><code id="kozak_logs_+3A_defect_height">defect_height</code></td>
<td>
<p>the height, in meters, from which the logs will be downgraded (if downgrade is TRUE) or log extraction simulation will be stopped (if broken is TRUE). Default is 0 for downgrade = TRUE (the whole tree is downgraded) and h * 0.5 for broken = TRUE (the tree is broken from half its original/estimated total height).</p>
</td></tr>
<tr><td><code id="kozak_logs_+3A_eliminate">eliminate</code></td>
<td>
<p>if TRUE, the algorithm does not get logs for any assortment present in the assortments table. All will be zero. Default is FALSE.</p>
</td></tr>
<tr><td><code id="kozak_logs_+3A_total_volume">total_volume</code></td>
<td>
<p>if TRUE, it adds an additional column to the results data.frame with the estimate of the total volume of the tree, from the ground height to h if broken argument is FALSE, or to defect_height if broken is TRUE. Default is FALSE.</p>
</td></tr>
<tr><td><code id="kozak_logs_+3A_only_vol">only_vol</code></td>
<td>
<p>if TRUE returns only volumes (does not return the number of logs). Default is FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>when the <code>broken</code> and <code>downgrade</code> arguments are set to TRUE, the <code>defect_height</code> value is considered as the break height of the tree, and the entire tree is downgraded.
</p>


<h3>Value</h3>

<p>a list of two data.frames, the first (volumes) with the calculated volumes per assortment, and the second (logs) with the number of logs per assortment.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(dplyr)
library(minpack.lm)
library(timbeR)

tree_scaling &lt;- tree_scaling %&gt;%
mutate(did = di/dbh,
       hih = hi/h)

kozak &lt;- nlsLM(di ~ taper_kozak(dbh, h, hih, b0, b1, b2, b3, b4, b5, b6, b7, b8, p),
               start=list(b0=1.00,b1=.97,b2=.03,b3=.49,b4=-
                            0.87,b5=0.50,b6=3.88,b7=0.03,b8=-0.19, p = .1),
               data = tree_scaling,
               control = nls.lm.control(maxiter = 1000, maxfev = 2000)
)

coef_kozak &lt;- coef(kozak)[-10]
p_kozak &lt;- coef(kozak)[10]

h &lt;- 20
dbh &lt;- 25

assortments &lt;- data.frame(
  NAME = c('15-25','4-15'),
  SED = c(15,4),
  MINLENGTH = c(2.65,2),
  MAXLENGTH = c(2.65,4.2),
  LOSS = c(5,5)
)

kozak_logs(dbh, h, coef_kozak, p_kozak, assortments)

</code></pre>

<hr>
<h2 id='kozak_logs_plot'>Visualize the simulation of log cutting along the stem using a Kozak (2004) variable-form taper equation.</h2><span id='topic+kozak_logs_plot'></span>

<h3>Description</h3>

<p>Plot the shape of the tree and visualize the extracted logs based on the tree measurements, assortments data.frame, and the Kozak (2004) variable-form taper equation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kozak_logs_plot(
  dbh,
  h,
  coef,
  p,
  assortments,
  stump_height,
  downgrade,
  broken,
  defect_height,
  lang
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="kozak_logs_plot_+3A_dbh">dbh</code></td>
<td>
<p>tree diameter at breast height, in centimeters.</p>
</td></tr>
<tr><td><code id="kozak_logs_plot_+3A_h">h</code></td>
<td>
<p>total tree height, in meters.</p>
</td></tr>
<tr><td><code id="kozak_logs_plot_+3A_coef">coef</code></td>
<td>
<p>numerical vector containing seven coefficients of the Kozak variable-form taper equation.</p>
</td></tr>
<tr><td><code id="kozak_logs_plot_+3A_p">p</code></td>
<td>
<p>numerical value representing the first inflection point calculated in the segmented model of Max and Burkhart (1976).</p>
</td></tr>
<tr><td><code id="kozak_logs_plot_+3A_assortments">assortments</code></td>
<td>
<p>a data.frame with five columns and n rows, where n is the number of different wood assortments to be obtained from the tree stem. The first column must contain the names of the assortments, the second, numerical, contains the minimum diameters at the small end of the logs, in centimeters. The third column, numerical, contains the minimum lengths of the logs, in meters. The fourth column, numerical, contains the maximum lengths of the logs, in meters. The fifth column, numerical, contains the values in centimeters referring to the loss of wood due to cutting logs. The algorithm prioritizes the extraction of assortments along the stem in the order presented in the data.frame, starting from the first line, to the last.</p>
</td></tr>
<tr><td><code id="kozak_logs_plot_+3A_stump_height">stump_height</code></td>
<td>
<p>tree cutting height, in meters. Default is 0.</p>
</td></tr>
<tr><td><code id="kozak_logs_plot_+3A_downgrade">downgrade</code></td>
<td>
<p>if TRUE, the algorithm,from the defect_height onwards, simulates log extraction only for the last assortment in the assortments data.frame. Default is FALSE.</p>
</td></tr>
<tr><td><code id="kozak_logs_plot_+3A_broken">broken</code></td>
<td>
<p>if TRUE, the algorithm will simulate the extraction of logs only up to the defect_height. Default is FALSE.</p>
</td></tr>
<tr><td><code id="kozak_logs_plot_+3A_defect_height">defect_height</code></td>
<td>
<p>the height, in meters, from which the logs will be downgraded (if downgrade is TRUE) or log extraction simulation will be stopped (if broken is TRUE). Default is h * 0.5.</p>
</td></tr>
<tr><td><code id="kozak_logs_plot_+3A_lang">lang</code></td>
<td>
<p>language in which plot labels will be displayed. Current options are 'en' and 'pt-BR'. Default is 'en'.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>check the <code>kozak_logs</code> function help for more details.
</p>


<h3>Value</h3>

<p>a ggplot object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(dplyr)
library(minpack.lm)
library(timbeR)

tree_scaling &lt;- tree_scaling %&gt;%
mutate(did = di/dbh,
       hih = hi/h)

kozak &lt;- nlsLM(di ~ taper_kozak(dbh, h, hih, b0, b1, b2, b3, b4, b5, b6, b7, b8, p),
               start=list(b0=1.00,b1=.97,b2=.03,b3=.49,b4=-
                            0.87,b5=0.50,b6=3.88,b7=0.03,b8=-0.19, p = .1),
               data = tree_scaling,
               control = nls.lm.control(maxiter = 1000, maxfev = 2000)
)

coef_kozak &lt;- coef(kozak)[-10]
p_kozak &lt;- coef(kozak)[10]

h &lt;- 20
dbh &lt;- 25

assortments &lt;- data.frame(
  NAME = c('15-25','4-15'),
  SED = c(15,4),
  MINLENGTH = c(2.65,2),
  MAXLENGTH = c(2.65,4.2),
  LOSS = c(5,5)
)

kozak_logs(dbh, h, coef_kozak, p_kozak, assortments)

</code></pre>

<hr>
<h2 id='kozak_vol'>Estimate the total or partial volume of the tree, based on a fitted Kozak (2004) taper function.</h2><span id='topic+kozak_vol'></span>

<h3>Description</h3>

<p>Estimates the total or partial volume of the tree from the diameter at breast height, total height, initial section height, final section height and coefficients of the Kozak (2004) taper equation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kozak_vol(dbh, h, coef, p, hi, h0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="kozak_vol_+3A_dbh">dbh</code></td>
<td>
<p>tree diameter at breast height, in centimeters.</p>
</td></tr>
<tr><td><code id="kozak_vol_+3A_h">h</code></td>
<td>
<p>total tree height, in meters.</p>
</td></tr>
<tr><td><code id="kozak_vol_+3A_coef">coef</code></td>
<td>
<p>numerical vector containing eight coefficients of the Kozak taper equation.</p>
</td></tr>
<tr><td><code id="kozak_vol_+3A_p">p</code></td>
<td>
<p>numerical value representing the first inflection point calculated in the segmented model of Max and Burkhart (1976).</p>
</td></tr>
<tr><td><code id="kozak_vol_+3A_hi">hi</code></td>
<td>
<p>final height of the tree section whose volume will be calculated, in meters. Default is the total tree height (h).</p>
</td></tr>
<tr><td><code id="kozak_vol_+3A_h0">h0</code></td>
<td>
<p>initial height of the tree section whose volume will be calculated, in meters. Default is 0 (ground height).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>the Kozak (2004) variable-form taper function is represented mathematically by the following expression
</p>
<p>di ~ b0*(dbh^b1)<em>(h^b2)</em>((1-(hi/h)^(1/4))/(1-(p^(1/3))))^(b3*(hi/h)^4+b4*(1/exp(dbh/h))+b5*((1-(hi/h)^(1/4))/(1-(p^(1/3))))^0.1+b6*(1/dbh)+b7*(h^(1-(hi/h)^(1/3)))+b8*((1-(hi/h)^(1/4))/(1-(p^(1/3)))))
</p>


<h3>Value</h3>

<p>a numeric value indicating the total or partial volume of the tree.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(dplyr)
library(minpack.lm)
library(timbeR)

tree_scaling &lt;- tree_scaling %&gt;%
mutate(did = di/dbh,
       hih = hi/h)

kozak &lt;- nlsLM(di ~ taper_kozak(dbh, h, hih, b0, b1, b2, b3, b4, b5, b6, b7, b8, p),
               start=list(b0=1.00,b1=.97,b2=.03,b3=.49,b4=-
                            0.87,b5=0.50,b6=3.88,b7=0.03,b8=-0.19, p = .1),
               data = tree_scaling,
               control = nls.lm.control(maxiter = 1000, maxfev = 2000)
)

coef_kozak &lt;- coef(kozak)[-10]
p_kozak &lt;- coef(kozak)[10]

h &lt;- 20
dbh &lt;- 25
di &lt;- 5

kozak_vol(dbh, h, coef_kozak, p_kozak)

hi = 15
h0 = .2

kozak_vol(dbh, h, coef_kozak, p_kozak, hi, h0)

</code></pre>

<hr>
<h2 id='poly5_di'>Estimate the diameter at a given height based on a 5th degree polynomial function.</h2><span id='topic+poly5_di'></span>

<h3>Description</h3>

<p>Estimates the diameter at a given height of a tree from the diameter at breast height, total height and the coefficients of the 5th degree polynomial function that describes the tree's taper.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>poly5_di(dbh, h, hi, coef)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="poly5_di_+3A_dbh">dbh</code></td>
<td>
<p>tree diameter at breast height, in centimeters.</p>
</td></tr>
<tr><td><code id="poly5_di_+3A_h">h</code></td>
<td>
<p>total tree height, in meters.</p>
</td></tr>
<tr><td><code id="poly5_di_+3A_hi">hi</code></td>
<td>
<p>height at which the diameter will be calculated, in meters.</p>
</td></tr>
<tr><td><code id="poly5_di_+3A_coef">coef</code></td>
<td>
<p>numerical vector containing six coefficients of the 5th degree polynomial function that describes the tree's taper.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a numeric value indicating the diameter at the given height.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(dplyr)
library(minpack.lm)
library(timbeR)

tree_scaling &lt;- tree_scaling %&gt;%
mutate(did = di/dbh,
       hih = hi/h)

poli5 &lt;- lm(did~hih+I(hih^2)+I(hih^3)+I(hih^4)+I(hih^5),tree_scaling)

coef_poli &lt;- coef(poli5)

dbh &lt;- 25
h &lt;- 20
di &lt;- 5

poly5_di(dbh, h, di, coef_poli)

</code></pre>

<hr>
<h2 id='poly5_hi'>Estimate the height at which a given diameter occurs in a tree, based on a 5th degree polynomial function.</h2><span id='topic+poly5_hi'></span>

<h3>Description</h3>

<p>Estimates the height at which a given diameter occurs in a tree, from the diameter at breast height, total height and coefficients of the 5th degree polynomial function that describes the tree's taper.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>poly5_hi(dbh, h, di, coef)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="poly5_hi_+3A_dbh">dbh</code></td>
<td>
<p>tree diameter at breast height, in centimeters.</p>
</td></tr>
<tr><td><code id="poly5_hi_+3A_h">h</code></td>
<td>
<p>total tree height, in meters.</p>
</td></tr>
<tr><td><code id="poly5_hi_+3A_di">di</code></td>
<td>
<p>diameter whose height of occurrence will be estimated, in centimeters.</p>
</td></tr>
<tr><td><code id="poly5_hi_+3A_coef">coef</code></td>
<td>
<p>numerical vector containing six coefficients of the 5th degree polynomial function that describes the tree's taper.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>as numeric value indicating the height at which the given diameter occurs.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(dplyr)
library(minpack.lm)
library(timbeR)

tree_scaling &lt;- tree_scaling %&gt;%
mutate(did = di/dbh,
       hih = hi/h)

poli5 &lt;- lm(did~hih+I(hih^2)+I(hih^3)+I(hih^4)+I(hih^5),tree_scaling)

coef_poli &lt;- coef(poli5)

dbh &lt;- 25
h &lt;- 20
hi &lt;- 15

poly5_hi(dbh, h, hi, coef_poli)

</code></pre>

<hr>
<h2 id='poly5_logs'>Simulate log extraction using a 5th degree polynomial that describes the taper of the tree.</h2><span id='topic+poly5_logs'></span>

<h3>Description</h3>

<p>Simulate the extraction of logs from a tree from its measurements, taper function (5th degree polynomial), trunk quality characteristics and harvest parameters such as stump height and assortments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>poly5_logs(
  dbh,
  h,
  coef,
  assortments,
  stump_height,
  downgrade,
  broken,
  defect_height,
  eliminate,
  total_volume,
  only_vol
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="poly5_logs_+3A_dbh">dbh</code></td>
<td>
<p>tree diameter at breast height, in centimeters.</p>
</td></tr>
<tr><td><code id="poly5_logs_+3A_h">h</code></td>
<td>
<p>total tree height, in meters.</p>
</td></tr>
<tr><td><code id="poly5_logs_+3A_coef">coef</code></td>
<td>
<p>numerical vector containing six coefficients of the 5th degree polynomial function that describes the tree's taper.</p>
</td></tr>
<tr><td><code id="poly5_logs_+3A_assortments">assortments</code></td>
<td>
<p>a data.frame with five columns and n rows, where n is the number of different wood assortments to be obtained from the tree stem. The first column must contain the names of the assortments, the second, numerical, contains the minimum diameters at the small end of the logs, in centimeters. The third column, numerical, contains the minimum lengths of the logs, in meters. The fourth column, numerical, contains the maximum lengths of the logs, in meters. The fifth column, numerical, contains the values in centimeters referring to the loss of wood due to cutting logs. The algorithm prioritizes the extraction of assortments along the stem in the order presented in the data.frame, starting from the first line, to the last.</p>
</td></tr>
<tr><td><code id="poly5_logs_+3A_stump_height">stump_height</code></td>
<td>
<p>tree cutting height, in meters. Default is 0.</p>
</td></tr>
<tr><td><code id="poly5_logs_+3A_downgrade">downgrade</code></td>
<td>
<p>if TRUE, the algorithm,from the defect_height onwards, simulates log extraction only for the last assortment in the assortments data.frame. Default is FALSE.</p>
</td></tr>
<tr><td><code id="poly5_logs_+3A_broken">broken</code></td>
<td>
<p>if TRUE, the algorithm will simulate the extraction of logs only up to the defect_height. Default is FALSE.</p>
</td></tr>
<tr><td><code id="poly5_logs_+3A_defect_height">defect_height</code></td>
<td>
<p>the height, in meters, from which the logs will be downgraded (if downgrade is TRUE) or log extraction simulation will be stopped (if broken is TRUE). Default is 0 for downgrade = TRUE (the whole tree is downgraded) and h * 0.5 for broken = TRUE (the tree is broken from half its original/estimated total height).</p>
</td></tr>
<tr><td><code id="poly5_logs_+3A_eliminate">eliminate</code></td>
<td>
<p>if TRUE, the algorithm does not get logs for any assortment present in the assortments table. All will be zero. Default is FALSE.</p>
</td></tr>
<tr><td><code id="poly5_logs_+3A_total_volume">total_volume</code></td>
<td>
<p>if TRUE, it adds an additional column to the results data.frame with the estimate of the total volume of the tree, from the ground height to h if broken argument is FALSE, or to defect_height if broken is TRUE. Default is FALSE.</p>
</td></tr>
<tr><td><code id="poly5_logs_+3A_only_vol">only_vol</code></td>
<td>
<p>if TRUE returns only volumes (does not return the number of logs). Default is FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>when the <code>broken</code> and <code>downgrade</code> arguments are set to TRUE, the <code>defect_height</code> value is considered as the break height of the tree, and the entire tree is downgraded.
</p>


<h3>Value</h3>

<p>a list of two data.frames, the first (volumes) with the calculated volumes per assortment, and the second (logs) with the number of logs per assortment.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(dplyr)
library(minpack.lm)
library(timbeR)

tree_scaling &lt;- tree_scaling %&gt;%
mutate(did = di/dbh,
       hih = hi/h)

poli5 &lt;- lm(did~hih+I(hih^2)+I(hih^3)+I(hih^4)+I(hih^5),tree_scaling)

coef_poli &lt;- coef(poli5)

dbh &lt;- 25
h &lt;- 20

assortments &lt;- data.frame(
  NAME = c('15-25','4-15'),
  SED = c(15,4),
  MINLENGTH = c(2.65,2),
  MAXLENGTH = c(2.65,4.2),
  LOSS = c(5,5)
)

poly5_logs(dbh, h, coef_poli, assortments)

</code></pre>

<hr>
<h2 id='poly5_logs_plot'>Visualize the simulation of log cutting along the stem using a 5th degree polynomial that describes the tree taper.</h2><span id='topic+poly5_logs_plot'></span>

<h3>Description</h3>

<p>Plot the shape of the tree and visualize the extracted logs based on the tree measurements, assortments data.frame, and the 5th degree polynomial function that describes the tree's taper.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>poly5_logs_plot(
  dbh,
  h,
  coef,
  assortments,
  stump_height,
  downgrade,
  broken,
  defect_height,
  lang
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="poly5_logs_plot_+3A_dbh">dbh</code></td>
<td>
<p>tree diameter at breast height, in centimeters.</p>
</td></tr>
<tr><td><code id="poly5_logs_plot_+3A_h">h</code></td>
<td>
<p>total tree height, in meters.</p>
</td></tr>
<tr><td><code id="poly5_logs_plot_+3A_coef">coef</code></td>
<td>
<p>numerical vector containing six coefficients of the 5th degree polynomial function that describes the tree's taper.</p>
</td></tr>
<tr><td><code id="poly5_logs_plot_+3A_assortments">assortments</code></td>
<td>
<p>a data.frame with five columns and n rows, where n is the number of different wood assortments to be obtained from the tree stem. The first column must contain the names of the assortments, the second, numerical, contains the minimum diameters at the small end of the logs, in centimeters. The third column, numerical, contains the minimum lengths of the logs, in meters. The fourth column, numerical, contains the maximum lengths of the logs, in meters. The fifth column, numerical, contains the values in centimeters referring to the loss of wood due to cutting logs. The algorithm prioritizes the extraction of assortments along the stem in the order presented in the data.frame, starting from the first line, to the last.</p>
</td></tr>
<tr><td><code id="poly5_logs_plot_+3A_stump_height">stump_height</code></td>
<td>
<p>tree cutting height, in meters. Default is 0.</p>
</td></tr>
<tr><td><code id="poly5_logs_plot_+3A_downgrade">downgrade</code></td>
<td>
<p>if TRUE, the algorithm,from the defect_height onwards, simulates log extraction only for the last assortment in the assortments data.frame. Default is FALSE.</p>
</td></tr>
<tr><td><code id="poly5_logs_plot_+3A_broken">broken</code></td>
<td>
<p>if TRUE, the algorithm will simulate the extraction of logs only up to the defect_height. Default is FALSE.</p>
</td></tr>
<tr><td><code id="poly5_logs_plot_+3A_defect_height">defect_height</code></td>
<td>
<p>the height, in meters, from which the logs will be downgraded (if downgrade is TRUE) or log extraction simulation will be stopped (if broken is TRUE). Default is h * 0.5.</p>
</td></tr>
<tr><td><code id="poly5_logs_plot_+3A_lang">lang</code></td>
<td>
<p>language in which plot labels will be displayed. Current options are 'en' and 'pt-BR'. Default is 'en'.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>check the <code>poly5_logs</code> function help for more details.
</p>


<h3>Value</h3>

<p>a ggplot object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(dplyr)
library(minpack.lm)
library(timbeR)

tree_scaling &lt;- tree_scaling %&gt;%
mutate(did = di/dbh,
       hih = hi/h)

poli5 &lt;- lm(did~hih+I(hih^2)+I(hih^3)+I(hih^4)+I(hih^5),tree_scaling)

coef_poli &lt;- coef(poli5)

dbh &lt;- 25
h &lt;- 20

assortments &lt;- data.frame(
  NAME = c('15-25','4-15'),
  SED = c(15,4),
  MINLENGTH = c(2.65,2),
  MAXLENGTH = c(2.65,4.2),
  LOSS = c(5,5)
)

poly5_logs_plot(dbh, h, coef_poli, assortments)

</code></pre>

<hr>
<h2 id='poly5_vol'>Estimate the total or partial volume of the tree, based on a 5th degree polynomial function that describes the taper of the tree.</h2><span id='topic+poly5_vol'></span>

<h3>Description</h3>

<p>Estimates the total or partial volume of the tree from the diameter at breast height, total height, initial section height, final section height and coefficients of the 5th degree polynomial function that describes the tree's taper.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>poly5_vol(dbh, h, coef, hi, h0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="poly5_vol_+3A_dbh">dbh</code></td>
<td>
<p>tree diameter at breast height, in centimeters.</p>
</td></tr>
<tr><td><code id="poly5_vol_+3A_h">h</code></td>
<td>
<p>total tree height, in meters.</p>
</td></tr>
<tr><td><code id="poly5_vol_+3A_coef">coef</code></td>
<td>
<p>numerical vector containing six coefficients of the 5th degree polynomial function that describes the tree's taper.</p>
</td></tr>
<tr><td><code id="poly5_vol_+3A_hi">hi</code></td>
<td>
<p>final height of the tree section whose volume will be calculated, in meters. Default is the total tree height (h).</p>
</td></tr>
<tr><td><code id="poly5_vol_+3A_h0">h0</code></td>
<td>
<p>initial height of the tree section whose volume will be calculated, in meters. Default is 0 (ground height).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a numeric value indicating the total or partial volume of the tree.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(dplyr)
library(minpack.lm)
library(timbeR)

tree_scaling &lt;- tree_scaling %&gt;%
mutate(did = di/dbh,
       hih = hi/h)

poli5 &lt;- lm(did~hih+I(hih^2)+I(hih^3)+I(hih^4)+I(hih^5),tree_scaling)

coef_poli &lt;- coef(poli5)

dbh &lt;- 25
h &lt;- 20

poly5_vol(dbh, h, coef_poli)

hi = 15
h0 = .2

poly5_vol(dbh, h, coef_poli, hi, h0)

</code></pre>

<hr>
<h2 id='select_and_remove'>Remove unwanted data by selecting it</h2><span id='topic+select_and_remove'></span>

<h3>Description</h3>

<p>Delete unwanted records from the dataset (e.g. outliers) by selecting them in a scatter plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>select_and_remove(data, xvar, yvar)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="select_and_remove_+3A_data">data</code></td>
<td>
<p>a data.frame.</p>
</td></tr>
<tr><td><code id="select_and_remove_+3A_xvar">xvar</code></td>
<td>
<p>quoted name of the variable to be displayed in the x axis.</p>
</td></tr>
<tr><td><code id="select_and_remove_+3A_yvar">yvar</code></td>
<td>
<p>quoted name of the variable to be displayed in the y axis.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the data.frame given to the <code>data</code> argument, without the selected points.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
library(dplyr)
library(timbeR)

tree_scaling &lt;- tree_scaling %&gt;%
mutate(did = di/dbh,
       hih = hi/h) %&gt;%
select_and_remove(., 'hih', 'did')

## End(Not run)

</code></pre>

<hr>
<h2 id='taper_bi'>Bi (2004) Taper Function.</h2><span id='topic+taper_bi'></span>

<h3>Description</h3>

<p>Bi (2004) Taper Function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>taper_bi(dbh, h, hih, b0, b1, b2, b3, b4, b5, b6)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="taper_bi_+3A_dbh">dbh</code></td>
<td>
<p>tree diameter at breast height, in centimeters.</p>
</td></tr>
<tr><td><code id="taper_bi_+3A_h">h</code></td>
<td>
<p>total tree height, in meters.</p>
</td></tr>
<tr><td><code id="taper_bi_+3A_hih">hih</code></td>
<td>
<p>ratio between the height of the section (hi) and the total height (h) .</p>
</td></tr>
<tr><td><code id="taper_bi_+3A_b0">b0</code>, <code id="taper_bi_+3A_b1">b1</code>, <code id="taper_bi_+3A_b2">b2</code>, <code id="taper_bi_+3A_b3">b3</code>, <code id="taper_bi_+3A_b4">b4</code>, <code id="taper_bi_+3A_b5">b5</code>, <code id="taper_bi_+3A_b6">b6</code></td>
<td>
<p>model parameters.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a numeric value indicating the diameter at the section.
</p>


<h3>References</h3>

<p>Bi, H. (2000). Trigonometric variable-form taper equations for Australian eucalypts. Forest Science, 46(3), 397-409.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(dplyr)
library(minpack.lm)
library(timbeR)

tree_scaling &lt;- tree_scaling %&gt;%
mutate(did = di/dbh,
       hih = hi/h)

bi &lt;-  nlsLM(di ~ taper_bi(dbh, h, hih, b0, b1, b2, b3, b4, b5, b6),
data=tree_scaling,
start=list(b0=1.8,b1=-0.2,b2=-0.04,b3=-0.9,b4=-0.0006,b5=0.07,b6=-.14))

</code></pre>

<hr>
<h2 id='taper_kozak'>Kozak (2004) Taper Function.</h2><span id='topic+taper_kozak'></span>

<h3>Description</h3>

<p>Kozak (2004) Taper Function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>taper_kozak(dbh, h, hih, b0, b1, b2, b3, b4, b5, b6, b7, b8, p)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="taper_kozak_+3A_dbh">dbh</code></td>
<td>
<p>tree diameter at breast height, in centimeters.</p>
</td></tr>
<tr><td><code id="taper_kozak_+3A_h">h</code></td>
<td>
<p>total tree height, in meters.</p>
</td></tr>
<tr><td><code id="taper_kozak_+3A_hih">hih</code></td>
<td>
<p>ratio between the height of the section (hi) and the total height (h) .</p>
</td></tr>
<tr><td><code id="taper_kozak_+3A_b0">b0</code>, <code id="taper_kozak_+3A_b1">b1</code>, <code id="taper_kozak_+3A_b2">b2</code>, <code id="taper_kozak_+3A_b3">b3</code>, <code id="taper_kozak_+3A_b4">b4</code>, <code id="taper_kozak_+3A_b5">b5</code>, <code id="taper_kozak_+3A_b6">b6</code>, <code id="taper_kozak_+3A_b7">b7</code>, <code id="taper_kozak_+3A_b8">b8</code></td>
<td>
<p>model parameters.</p>
</td></tr>
<tr><td><code id="taper_kozak_+3A_p">p</code></td>
<td>
<p>numerical value representing the first inflection point calculated in the segmented model of Max and Burkhart (1976).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a numeric value indicating the diameter at the section.
</p>


<h3>References</h3>

<p>Kozak, A. (2004). My last words on taper equations. The Forestry Chronicle, 80(4), 507-515.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(dplyr)
library(minpack.lm)
library(timbeR)

tree_scaling &lt;- tree_scaling %&gt;%
mutate(did = di/dbh,
       hih = hi/h)

kozak &lt;-  nlsLM(di ~ taper_kozak(dbh, h, hih, b0, b1, b2, b3, b4, b5, b6, b7, b8, p),
data=tree_scaling,
start=list(b0=1.00,b1=.97,b2=.03,b3=.49,b4=-0.87,b5=0.50,b6=3.88,b7=0.03,b8=-0.19,p =.1))

</code></pre>

<hr>
<h2 id='tree_scaling'>Tree scaling example data</h2><span id='topic+tree_scaling'></span>

<h3>Description</h3>

<p>Diameter (cm) and height (m) measurements along the bole of 8 Pinus taeda trees.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(tree_scaling)
</code></pre>


<h3>Format</h3>

<p>A data frame with 136 rows and 5 variables:
</p>

<dl>
<dt>tree_id</dt><dd><p>tree unique id</p>
</dd>
<dt>dbh</dt><dd><p>diameter at breast height, in centimeters</p>
</dd>
<dt>h</dt><dd><p>total tree height, in meters</p>
</dd>
<dt>hi</dt><dd><p>tree section height, in meters</p>
</dd>
<dt>di</dt><dd><p>diameter at the tree section, in centimeters</p>
</dd>
</dl>


</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
