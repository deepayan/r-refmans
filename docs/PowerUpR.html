<!DOCTYPE html><html><head><title>Help for package PowerUpR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {PowerUpR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bcra3r2'><p>Three-Level Blocked Cluster-level Random Assignment Design, Treatment at Level 2</p></a></li>
<li><a href='#bcra4r2'><p>Four-Level Blocked Cluster-level Random Assignment Design, Treatment at Level 2</p></a></li>
<li><a href='#bcra4r3'><p>Four-Level Blocked Cluster-level Random Assignment Design, Treatment at Level 3</p></a></li>
<li><a href='#bira2'><p>Two-Level Blocked Individual-level Random Assignment Design</p></a></li>
<li><a href='#bira3'><p>Three-Level Blocked Individual-level Random Assignment Design</p></a></li>
<li><a href='#bira4'><p>Four-Level Blocked Individual-level Random Assignment Design</p></a></li>
<li><a href='#conversion'><p>Object Conversion</p></a></li>
<li><a href='#cra2'><p>Two-level Cluster-randomized Trials to Detect Main, Moderation and Mediation Effects</p></a></li>
<li><a href='#cra3'><p>Three-level Cluster-randomized Trials to Detect Main, Moderation, and Mediation Effects</p></a></li>
<li><a href='#cra4'><p>Four-Level Cluster-randomized Trial</p></a></li>
<li><a href='#ira'><p>Individual-level Random Assignment Designs</p></a></li>
<li><a href='#med_pn'><p>Partially Nested Designs Probing Multilevel Mediation</p></a></li>
<li><a href='#plots'><p>Plots</p></a></li>
<li><a href='#PowerUpR-package'><p>Power Analysis Tools for Multilevel Randomized Experiments</p></a></li>
<li><a href='#replication'><p>Unambiguous Test of Replication for Ensemble of Studies</p></a></li>
<li><a href='#t1t2.error'><p>Plots Type I and Type II Error Rates</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Power Analysis Tools for Multilevel Randomized Experiments</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-10-24</td>
</tr>
<tr>
<td>Description:</td>
<td>
 Includes tools to calculate statistical power, minimum detectable effect size (MDES), MDES difference (MDESD), and minimum required sample size for various multilevel randomized experiments (MRE) with continuous outcomes.
 Accomodates 14 types of MRE designs to detect main treatment effect, seven types of MRE designs to detect moderated treatment effect (2-1-1, 2-1-2, 2-2-1, 2-2-2, 3-3-1, 3-3-2, and 3-3-3 designs; &lt;total.lev&gt; - &lt;trt.lev&gt; - &lt;mod.lev&gt;),
 five types of MRE designs to detect mediated treatment effects (2-1-1, 2-2-1, 3-1-1, 3-2-1, and 3-3-1 designs; &lt;trt.lev&gt; - &lt;med.lev&gt; - &lt;out.lev&gt;), four types of partially nested (PN) design to detect main treatment effect,
 and three types of PN designs to detect mediated treatment effects (2/1, 3/1, 3/2; &lt;trt.arm.lev&gt; / &lt;ctrl.arm.lev&gt;). 
 See 'PowerUp!' Excel series at <a href="https://www.causalevaluation.org/">https://www.causalevaluation.org/</a>. </td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Author:</td>
<td>Metin Bulus [aut, cre],
  Nianbo Dong [aut],
  Benjamin Kelcey [aut],
  Jessaca Spybrook [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Metin Bulus &lt;bulusmetin@gmail.com&gt;</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-10-25 12:22:47 UTC; LENOVO</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-10-25 16:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='bcra3r2'>Three-Level Blocked Cluster-level Random Assignment Design, Treatment at Level 2</h2><span id='topic+bcra3r2'></span><span id='topic+bcra3r2_pn'></span><span id='topic+mdes.bcra3r2'></span><span id='topic+power.bcra3r2'></span><span id='topic+mrss.bcra3r2'></span><span id='topic+mdes.bcra3r2_pn'></span><span id='topic+power.bcra3r2_pn'></span><span id='topic+mrss.bcra3r2_pn'></span>

<h3>Description</h3>

<p>For three-level cluster-randomized block designs (treatment at level 2, with random effects across level 3 blocks), use <code>mdes.bcra3r2()</code> to calculate the minimum detectable effect size, <code>power.bcra3r2()</code> to calculate the statistical power, and <code>mrss.bcra3r2()</code> to calculate the minimum required sample size.
</p>
<p>For partially nested blocked cluster randomized trials (interventions clusters in treatment groups) use <code>mdes.bcra3r2_pn()</code> to calculate the minimum detectable effect size, <code>power.bcra3r2_pn()</code> to calculate the statistical power, and <code>mrss.bcra3r2_pn()</code> to calculate the minimum required sample size (number of blocks).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mdes.bcra3r2(power=.80, alpha=.05, two.tailed=TRUE,
             rho2, rho3, esv3=NULL, omega3=esv3/rho3,
             p=.50, g3=0, r21=0, r22=0, r2t3=0,
             n, J, K)

power.bcra3r2(es=.25, alpha=.05, two.tailed=TRUE,
              rho2, rho3, esv3=NULL, omega3=esv3/rho3,
              p=.50, g3=0, r21=0, r22=0, r2t3=0,
              n, J, K)

mrss.bcra3r2(es=.25, power=.80, alpha=.05, two.tailed=TRUE,
             n, J, K0=10, tol=.10,
             rho2, rho3, esv3=NULL, omega3=esv3/rho3,
             p=.50, g3=0, r21=0, r22=0, r2t3=0)

mdes.bcra3r2_pn(power=.80, alpha=.05, two.tailed=TRUE, df=NULL,
                rho3_trt=.10, omega3=.50, rho2_trt=.20, rho_ic=0,
                p=.50, r21=0, g3=0, n, J, K, ic_size=1)

power.bcra3r2_pn(es=.25,alpha=.05, two.tailed=TRUE, df=NULL,
                 rho3_trt=.10, omega3=.50, rho2_trt=.20, rho_ic=0,
                 p=.50, r21=0, g3=0, n, J, K, ic_size=1)

mrss.bcra3r2_pn(es=.25, power=.80, alpha=.05, two.tailed=TRUE, z.test=FALSE,
                rho3_trt=.10, omega3 = .50, rho2_trt=.20, rho_ic=0,
                p=.50, r21=0, g3=0, n, J, ic_size=1, K0=10, tol=.10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bcra3r2_+3A_power">power</code></td>
<td>
<p>statistical power <code class="reqn">(1-\beta)</code>.</p>
</td></tr>
<tr><td><code id="bcra3r2_+3A_es">es</code></td>
<td>
<p>effect size.</p>
</td></tr>
<tr><td><code id="bcra3r2_+3A_alpha">alpha</code></td>
<td>
<p>probability of type I error.</p>
</td></tr>
<tr><td><code id="bcra3r2_+3A_two.tailed">two.tailed</code></td>
<td>
<p>logical; <code>TRUE</code> for two-tailed hypothesis testing, <code>FALSE</code> for one-tailed hypothesis testing.</p>
</td></tr>
<tr><td><code id="bcra3r2_+3A_df">df</code></td>
<td>
<p>degrees of freedom.</p>
</td></tr>
<tr><td><code id="bcra3r2_+3A_rho_ic">rho_ic</code></td>
<td>
<p>proportion of variance in the outcome that is between intervention clusters.</p>
</td></tr>
<tr><td><code id="bcra3r2_+3A_rho2_trt">rho2_trt</code></td>
<td>
<p>proportion of variance in the outcome (for treatment group) that is between level 2 units.</p>
</td></tr>
<tr><td><code id="bcra3r2_+3A_rho3_trt">rho3_trt</code></td>
<td>
<p>proportion of variance in the outcome (for treatment group) that is between level 3 units.</p>
</td></tr>
<tr><td><code id="bcra3r2_+3A_rho2">rho2</code></td>
<td>
<p>proportion of variance in the outcome between level 2 units (unconditional ICC2).</p>
</td></tr>
<tr><td><code id="bcra3r2_+3A_rho3">rho3</code></td>
<td>
<p>proportion of variance in the outcome between level 3 units (unconditional ICC3).</p>
</td></tr>
<tr><td><code id="bcra3r2_+3A_esv3">esv3</code></td>
<td>
<p>effect size variability as the ratio of the treatment effect variance between level 3 units to the total variance in the outcome (level 1 + level 2 + level 3). <code>esv</code> also works. Ignored when <code>omega3</code> is specified.</p>
</td></tr>
<tr><td><code id="bcra3r2_+3A_omega3">omega3</code></td>
<td>
<p>treatment effect heterogeneity as ratio of treatment effect variance among level 3 units to the residual variance at level 3.</p>
</td></tr>
<tr><td><code id="bcra3r2_+3A_p">p</code></td>
<td>
<p>average proportion of level 2 units randomly assigned to treatment within level 3 units.</p>
</td></tr>
<tr><td><code id="bcra3r2_+3A_g3">g3</code></td>
<td>
<p>number of covariates at level 3.</p>
</td></tr>
<tr><td><code id="bcra3r2_+3A_r21">r21</code></td>
<td>
<p>proportion of level 1 variance in the outcome explained by level 1 covariates (applies to all levels in partially nested designs).</p>
</td></tr>
<tr><td><code id="bcra3r2_+3A_r22">r22</code></td>
<td>
<p>proportion of level 2 variance in the outcome explained by level 2 covariates.</p>
</td></tr>
<tr><td><code id="bcra3r2_+3A_r2t3">r2t3</code></td>
<td>
<p>proportion of treatment effect variance among level 3 units explained by level 3 covariates.</p>
</td></tr>
<tr><td><code id="bcra3r2_+3A_ic_size">ic_size</code></td>
<td>
<p>sample size for each intervention cluster.</p>
</td></tr>
<tr><td><code id="bcra3r2_+3A_n">n</code></td>
<td>
<p>harmonic mean of level 1 units across level 2 units (or simple average).</p>
</td></tr>
<tr><td><code id="bcra3r2_+3A_j">J</code></td>
<td>
<p>harmonic mean of level 2 units across level 3 units (or simple average).</p>
</td></tr>
<tr><td><code id="bcra3r2_+3A_k">K</code></td>
<td>
<p>number of level 3 units.</p>
</td></tr>
<tr><td><code id="bcra3r2_+3A_k0">K0</code></td>
<td>
<p>starting value for <code>K</code>.</p>
</td></tr>
<tr><td><code id="bcra3r2_+3A_tol">tol</code></td>
<td>
<p>tolerance to end iterative process for finding <code>K</code>.</p>
</td></tr>
<tr><td><code id="bcra3r2_+3A_z.test">z.test</code></td>
<td>
<p>logical; <code>TRUE</code> for z-test.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>fun</code></td>
<td>
<p>function name.</p>
</td></tr>
<tr><td><code>parms</code></td>
<td>
<p>list of parameters used in power calculation.</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>degrees of freedom.</p>
</td></tr>
<tr><td><code>ncp</code></td>
<td>
<p>noncentrality parameter.</p>
</td></tr>
<tr><td><code>power</code></td>
<td>
<p>statistical power <code class="reqn">(1-\beta)</code>.</p>
</td></tr>
<tr><td><code>mdes</code></td>
<td>
<p>minimum detectable effect size.</p>
</td></tr>
<tr><td><code>K</code></td>
<td>
<p>number of level 3 units.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Dong, N., &amp; Maynard, R. (2013). PowerUp!: A tool for calculating minimum detectable effect sizes and minimum required sample sizes for experimental and quasi-experimental design studies. <em>Journal of Research on Educational Effectiveness</em>, <em>6</em>(1), 24-67. doi: <a href="https://doi.org/10.1080/19345747.2012.673143">10.1080/19345747.2012.673143</a>
</p>
<p>Lohr, S., Schochet, P. Z., &amp; Sanders, E. (2014). Partially Nested Randomized Controlled Trials in Education Research: A Guide to Design and Analysis. NCER 2014-2000. National Center for Education Research. <a href="https://ies.ed.gov/ncer/pubs/20142000/pdf/20142000.pdf">https://ies.ed.gov/ncer/pubs/20142000/pdf/20142000.pdf</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># cross-checks
mdes.bcra3r2(rho3=.13, rho2=.10, omega3=.4,
             n=10, J=6, K=24)
power.bcra3r2(es = .246, rho3=.13, rho2=.10, omega3=.4,
              n=10, J=6, K=24)
mrss.bcra3r2(es = .246, rho3=.13, rho2=.10, omega3=.4,
             n=10, J=6)

# cross-checks
mdes.bcra3r2_pn(rho3_trt=.10, omega3=.50,
                rho2_trt=.15, rho_ic=.20,
                n=40, J=60, K=6, ic_size=10)
power.bcra3r2_pn(es=.399, rho3_trt=.10, omega3=.50,
                rho2_trt=.15, rho_ic=.20,
                n=40, J=60, K=6, ic_size=10)
mrss.bcra3r2_pn(es=.399, rho3_trt=.10, omega3=.50,
                 rho2_trt=.15, rho_ic=.20,
                 n=40, J=60, ic_size=10)
</code></pre>

<hr>
<h2 id='bcra4r2'>Four-Level Blocked Cluster-level Random Assignment Design, Treatment at Level 2</h2><span id='topic+bcra4r2'></span><span id='topic+mdes.bcra4r2'></span><span id='topic+power.bcra4r2'></span><span id='topic+mrss.bcra4r2'></span>

<h3>Description</h3>

<p>For four-level cluster-randomized block designs (treatment at level 2, with random effects across level 3 and 4 blocks), use <code>mdes.bcra4r2()</code> to calculate the minimum detectable effect size, <code>power.bcra4r2()</code> to calculate the statistical power, and <code>mrss.bcra4r2()</code> to calculate the minimum required sample size.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mdes.bcra4r2(power=.80, alpha=.05, two.tailed=TRUE,
             rho2, rho3, rho4, esv3=NULL, esv4=NULL,
             omega3=esv3/rho3, omega4=esv4/rho4,
             p=.50, r21=0, r22=0, r2t3=0, r2t4=0, g4=0,
             n, J, K, L)

power.bcra4r2(es=.25, alpha=.05, two.tailed=TRUE,
              rho2, rho3, rho4, esv3=NULL, esv4=NULL,
              omega3=esv3/rho3, omega4=esv4/rho4,
              p=.50, r21=0, r22=0, r2t3=0, r2t4=0, g4=0,
              n, J, K, L)

mrss.bcra4r2(es=.25, power=.80, alpha=.05, two.tailed=TRUE,
             n, J, K, L0=10, tol=.10,
             rho2, rho3, rho4, esv3=NULL, esv4=NULL,
             omega3=esv3/rho3, omega4=esv4/rho4,
             p=.50, r21=0, r22=0, r2t3=0, r2t4=0, g4=0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bcra4r2_+3A_power">power</code></td>
<td>
<p>statistical power <code class="reqn">(1-\beta)</code>.</p>
</td></tr>
<tr><td><code id="bcra4r2_+3A_es">es</code></td>
<td>
<p>effect size.</p>
</td></tr>
<tr><td><code id="bcra4r2_+3A_alpha">alpha</code></td>
<td>
<p>probability of type I error.</p>
</td></tr>
<tr><td><code id="bcra4r2_+3A_two.tailed">two.tailed</code></td>
<td>
<p>logical; <code>TRUE</code> for two-tailed hypothesis testing, <code>FALSE</code> for one-tailed hypothesis testing.</p>
</td></tr>
<tr><td><code id="bcra4r2_+3A_rho2">rho2</code></td>
<td>
<p>proportion of variance in the outcome between level 2 units (unconditional ICC2).</p>
</td></tr>
<tr><td><code id="bcra4r2_+3A_rho3">rho3</code></td>
<td>
<p>proportion of variance in the outcome between level 3 units (unconditional ICC3).</p>
</td></tr>
<tr><td><code id="bcra4r2_+3A_rho4">rho4</code></td>
<td>
<p>proportion of variance in the outcome between level 4 units (unconditional ICC4).</p>
</td></tr>
<tr><td><code id="bcra4r2_+3A_esv3">esv3</code></td>
<td>
<p>effect size variability as the ratio of the treatment effect variance between level 3 units to the total variance in the outcome (level 1 + level 2 + level 3 + level 4). Ignored when <code>omega3</code> is specified.</p>
</td></tr>
<tr><td><code id="bcra4r2_+3A_esv4">esv4</code></td>
<td>
<p>effect size variability as the ratio of the treatment effect variance between level 4 units to the total variance in the outcome (level 1 + level 2 + level 3 + level 4). Ignored when <code>omega4</code> is specified.</p>
</td></tr>
<tr><td><code id="bcra4r2_+3A_omega3">omega3</code></td>
<td>
<p>treatment effect heterogeneity as ratio of treatment effect variance among level 3 units to the residual variance at level 3.</p>
</td></tr>
<tr><td><code id="bcra4r2_+3A_omega4">omega4</code></td>
<td>
<p>treatment effect heterogeneity as ratio of treatment effect variance among level 4 units to the residual variance at level 4.</p>
</td></tr>
<tr><td><code id="bcra4r2_+3A_p">p</code></td>
<td>
<p>average proportion of level 2 units randomly assigned to treatment within level 3 units.</p>
</td></tr>
<tr><td><code id="bcra4r2_+3A_g4">g4</code></td>
<td>
<p>number of covariates at level 4.</p>
</td></tr>
<tr><td><code id="bcra4r2_+3A_r21">r21</code></td>
<td>
<p>proportion of level 1 variance in the outcome explained by level 1 covariates.</p>
</td></tr>
<tr><td><code id="bcra4r2_+3A_r22">r22</code></td>
<td>
<p>proportion of level 2 variance in the outcome explained by level 2 covariates.</p>
</td></tr>
<tr><td><code id="bcra4r2_+3A_r2t3">r2t3</code></td>
<td>
<p>proportion of treatment effect variance among level 3 units explained by level 3 covariates.</p>
</td></tr>
<tr><td><code id="bcra4r2_+3A_r2t4">r2t4</code></td>
<td>
<p>proportion of treatment effect variance among level 4 units explained by level 4 covariates.</p>
</td></tr>
<tr><td><code id="bcra4r2_+3A_n">n</code></td>
<td>
<p>harmonic mean of level 1 units across level 2 units (or simple average).</p>
</td></tr>
<tr><td><code id="bcra4r2_+3A_j">J</code></td>
<td>
<p>harmonic mean of level 2 units across level 3 units (or simple average).</p>
</td></tr>
<tr><td><code id="bcra4r2_+3A_k">K</code></td>
<td>
<p>harmonic mean of level 3 units across level 4 units (or simple average).</p>
</td></tr>
<tr><td><code id="bcra4r2_+3A_l">L</code></td>
<td>
<p>number of level 4 units.</p>
</td></tr>
<tr><td><code id="bcra4r2_+3A_l0">L0</code></td>
<td>
<p>starting value for <code>L</code>.</p>
</td></tr>
<tr><td><code id="bcra4r2_+3A_tol">tol</code></td>
<td>
<p>tolerance to end iterative process for finding <code>L</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>fun</code></td>
<td>
<p>function name.</p>
</td></tr>
<tr><td><code>parms</code></td>
<td>
<p>list of parameters used in power calculation.</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>degrees of freedom.</p>
</td></tr>
<tr><td><code>ncp</code></td>
<td>
<p>noncentrality parameter.</p>
</td></tr>
<tr><td><code>power</code></td>
<td>
<p>statistical power <code class="reqn">(1-\beta)</code>.</p>
</td></tr>
<tr><td><code>mdes</code></td>
<td>
<p>minimum detectable effect size.</p>
</td></tr>
<tr><td><code>L</code></td>
<td>
<p>number of level 4 units.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># cross-checks
mdes.bcra4r2(rho4=.05, rho3=.15, rho2=.15,
             omega4=.50, omega3=.50, n=10, J=4, K=4, L=20)
power.bcra4r2(es = .206, rho4=.05, rho3=.15, rho2=.15,
              omega4=.50, omega3=.50, n=10, J=4, K=4, L=20)
mrss.bcra4r2(es = .206, rho4=.05, rho3=.15, rho2=.15,
             omega4=.50, omega3=.50, n=10, J=4, K=4)
</code></pre>

<hr>
<h2 id='bcra4r3'>Four-Level Blocked Cluster-level Random Assignment Design, Treatment at Level 3</h2><span id='topic+bcra4r3'></span><span id='topic+mdes.bcra4r3'></span><span id='topic+power.bcra4r3'></span><span id='topic+mrss.bcra4r3'></span>

<h3>Description</h3>

<p>For four-level cluster-randomized block designs (treatment at level 3, with random effects across level 4 blocks), use <code>mdes.bcra4r3()</code> to calculate the minimum detectable effect size, <code>power.bcra4r3()</code> to calculate the statistical power, and <code>mrss.bcra4r3()</code> to calculate the minimum required sample size.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mdes.bcra4r3(power=.80, alpha=.05, two.tailed=TRUE,
             rho2, rho3, rho4, esv4=NULL, omega4=esv4/rho4,
             p=.50, r21=0, r22=0, r23=0, r2t4=0, g4=0,
             n, J, K, L)

power.bcra4r3(es=.25, alpha=.05, two.tailed=TRUE,
              rho2, rho3, rho4, esv4=NULL, omega4=esv4/rho4,
              p=.50, r21=0, r22=0, r23=0, r2t4=0, g4=0,
              n, J, K, L)

mrss.bcra4r3(es=.25, power=.80, alpha=.05, two.tailed=TRUE,
             n, J, K, L0=10, tol=.10,
             rho2, rho3, rho4, esv4=NULL, omega4=esv4/rho4,
             p=.50, r21=0, r22=0, r23=0, r2t4=0, g4=0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bcra4r3_+3A_power">power</code></td>
<td>
<p>statistical power <code class="reqn">(1-\beta)</code>.</p>
</td></tr>
<tr><td><code id="bcra4r3_+3A_es">es</code></td>
<td>
<p>effect size.</p>
</td></tr>
<tr><td><code id="bcra4r3_+3A_alpha">alpha</code></td>
<td>
<p>probability of type I error.</p>
</td></tr>
<tr><td><code id="bcra4r3_+3A_two.tailed">two.tailed</code></td>
<td>
<p>logical; <code>TRUE</code> for two-tailed hypothesis testing, <code>FALSE</code> for one-tailed hypothesis testing. </p>
</td></tr>
<tr><td><code id="bcra4r3_+3A_rho2">rho2</code></td>
<td>
<p>proportion of variance in the outcome between level 2 units (unconditional ICC2).</p>
</td></tr>
<tr><td><code id="bcra4r3_+3A_rho3">rho3</code></td>
<td>
<p>proportion of variance in the outcome between level 3 units (unconditional ICC3).</p>
</td></tr>
<tr><td><code id="bcra4r3_+3A_rho4">rho4</code></td>
<td>
<p>proportion of variance in the outcome between level 4 units (unconditional ICC4).</p>
</td></tr>
<tr><td><code id="bcra4r3_+3A_esv4">esv4</code></td>
<td>
<p>effect size variability as the ratio of the treatment effect variance between level 4 units to the total variance in the outcome (level 1 + level 2 + level 3 + level 4). <code>esv</code> also works. Ignored when <code>omega4</code> is specified.</p>
</td></tr>
<tr><td><code id="bcra4r3_+3A_omega4">omega4</code></td>
<td>
<p>treatment effect heterogeneity as ratio of treatment effect variance among level 4 units to the residual variance at level 4.</p>
</td></tr>
<tr><td><code id="bcra4r3_+3A_p">p</code></td>
<td>
<p>average proportion of level 3 units randomly assigned to treatment within level 4 units.</p>
</td></tr>
<tr><td><code id="bcra4r3_+3A_g4">g4</code></td>
<td>
<p>number of covariates at level 4.</p>
</td></tr>
<tr><td><code id="bcra4r3_+3A_r21">r21</code></td>
<td>
<p>proportion of level 1 variance in the outcome explained by level 1 covariates.</p>
</td></tr>
<tr><td><code id="bcra4r3_+3A_r22">r22</code></td>
<td>
<p>proportion of level 2 variance in the outcome explained by level 2 covariates.</p>
</td></tr>
<tr><td><code id="bcra4r3_+3A_r23">r23</code></td>
<td>
<p>proportion of level 3 variance in the outcome explained by level 3 covariates.</p>
</td></tr>
<tr><td><code id="bcra4r3_+3A_r2t4">r2t4</code></td>
<td>
<p>proportion of treatment effect variance among level 4 units explained by level 4 covariates.</p>
</td></tr>
<tr><td><code id="bcra4r3_+3A_n">n</code></td>
<td>
<p>harmonic mean of level 1 units across level 2 units (or simple average).</p>
</td></tr>
<tr><td><code id="bcra4r3_+3A_j">J</code></td>
<td>
<p>harmonic mean of level 2 units across level 3 units (or simple average).</p>
</td></tr>
<tr><td><code id="bcra4r3_+3A_k">K</code></td>
<td>
<p>harmonic mean of level 3 units across level 4 units (or simple average).</p>
</td></tr>
<tr><td><code id="bcra4r3_+3A_l">L</code></td>
<td>
<p>number of level 4 units.</p>
</td></tr>
<tr><td><code id="bcra4r3_+3A_l0">L0</code></td>
<td>
<p>starting value for <code>L</code>.</p>
</td></tr>
<tr><td><code id="bcra4r3_+3A_tol">tol</code></td>
<td>
<p>tolerance to end iterative process for finding <code>L</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>fun</code></td>
<td>
<p>function name.</p>
</td></tr>
<tr><td><code>parms</code></td>
<td>
<p>list of parameters used in power calculation.</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>degrees of freedom.</p>
</td></tr>
<tr><td><code>ncp</code></td>
<td>
<p>noncentrality parameter.</p>
</td></tr>
<tr><td><code>power</code></td>
<td>
<p>statistical power <code class="reqn">(1-\beta)</code>.</p>
</td></tr>
<tr><td><code>mdes</code></td>
<td>
<p>minimum detectable effect size.</p>
</td></tr>
<tr><td><code>L</code></td>
<td>
<p>number of level 4 units.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># cross-checks
mdes.bcra4r3(rho4=.05, rho3=.15, rho2=.15,
             omega4=.50, n=10, J=4, K=4, L=20)
power.bcra4r3(es = .316, rho4=.05, rho3=.15, rho2=.15,
              omega4=.50, n=10, J=4, K=4, L=20)
mrss.bcra4r3(es = .316, rho4=.05, rho3=.15, rho2=.15,
             omega4=.50, n=10, J=4, K=4)
</code></pre>

<hr>
<h2 id='bira2'>Two-Level Blocked Individual-level Random Assignment Design</h2><span id='topic+bira2'></span><span id='topic+bira2r1'></span><span id='topic+bira2_pn'></span><span id='topic+mdes.bira2'></span><span id='topic+power.bira2'></span><span id='topic+mrss.bira2'></span><span id='topic+mdes.mod211'></span><span id='topic+mdesd.mod211'></span><span id='topic+power.mod211'></span><span id='topic+mrss.mod211'></span><span id='topic+mdes.mod212'></span><span id='topic+mdesd.mod212'></span><span id='topic+power.mod212'></span><span id='topic+mrss.mod212'></span><span id='topic+mdes.bira2r1'></span><span id='topic+power.bira2r1'></span><span id='topic+mrss.bira2r1'></span><span id='topic+mdes.bira2_pn'></span><span id='topic+power.bira2_pn'></span><span id='topic+mrss.bira2_pn'></span>

<h3>Description</h3>

<p>For two-level randomized block designs (treatment at level 1, with random effects across level 2 blocks), use <code>mdes.bira2()</code> to calculate the minimum detectable effect size, <code>power.bira2()</code> to calculate the statistical power, and <code>mrss.bira2()</code> to calculate the minimum required sample size (number of blocks).
</p>
<p>For treatment effect moderated by level 1 moderator use <code>power.mod211()</code>, <code>mdesd.mod211()</code>, and <code>mrss.mod211()</code> functions. For treatment effect moderated by level 2 moderator, use <code>power.mod212()</code>, <code>mdesd.mod212()</code>, and <code>mrss.mod212()</code> functions.
</p>
<p>For partially nested blocked individual-level random assignment designs (blocked randomized controlled trial with intervention clusters) use <code>mdes.bira2_pn()</code> to calculate the minimum detectable effect size, <code>power.bira2_pn()</code> to calculate the statistical power, and <code>mrss.bira2_pn()</code> to calculate the minimum required sample size (number of blocks).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mdes.bira2(power=.80, alpha=.05, two.tailed=TRUE,
           rel1=1, rho2, esv2=NULL, omega2=esv2/rho2,
           g2=0, r21=0, r2t2=0, p=.50, n, J)

power.bira2(es=.25, alpha=.05, two.tailed=TRUE,
            rel1=1, rho2, esv2=NULL, omega2=esv2/rho2,
            g2=0, r21=0, r2t2=0, p=.50, n, J)

mrss.bira2(es=.25, power=.80, alpha=.05, two.tailed=TRUE,
           rel1=1, rho2, esv2=NULL, omega2=esv2/rho2,
           r21=0, r2t2=0, J0=10, tol=.10, g2=0, p=.50, n)

power.mod211(es=.25, alpha=.05, two.tailed=TRUE,
             rho2, omega2tm, r21=0,
             p=.50, q=NULL, n, J)

mdesd.mod211(power=.80, alpha=.05, two.tailed=TRUE,
             rho2, omega2tm, g1=0, r21=0,
             p=.50, q=NULL, n, J)

mrss.mod211(es=.25, power=.80, alpha=.05, two.tailed=TRUE,
            n, J0=10, tol=.10, rho2, omega2tm, r21=0,
            p=.50, q=NULL)

power.mod212(es=.25, alpha=.05, two.tailed=TRUE,
             rho2, omega2t, r21=0,
             p=.50, q=NULL, n, J)

mdesd.mod212(power=.80, alpha=.05, two.tailed=TRUE,
             rho2, omega2t, g1=0, r21=0,
             p=.50, q=NULL, n, J)

mrss.mod212(es=.25, power=.80, alpha=.05, two.tailed=TRUE,
            n, J0=10, tol=.10, rho2, omega2t, r21=0,
            p=.50, q=NULL)

mdes.bira2_pn(power=.80, alpha=.05, two.tailed=TRUE, df=NULL,
              rho2_trt=.20, omega2=.50, rho_ic=0,
              p=.50, g2=0, r21=0, n, J, ic_size=1)

power.bira2_pn(es=.25,alpha=.05, two.tailed=TRUE, df=NULL,
               rho2_trt=.20, omega2=.50, rho_ic=0,
               p=.50, g2=0, r21=0, n, J, ic_size=1)

mrss.bira2_pn(es=.25, power=.80, alpha=.05, two.tailed=TRUE,
              z.test=FALSE, rho2_trt=.20, omega2=.50, rho_ic=0,
              p=.50, g2=0, r21=0, n, ic_size=1, J0=10, tol=.10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bira2_+3A_power">power</code></td>
<td>
<p>statistical power <code class="reqn">(1-\beta)</code>.</p>
</td></tr>
<tr><td><code id="bira2_+3A_es">es</code></td>
<td>
<p>effect size.</p>
</td></tr>
<tr><td><code id="bira2_+3A_alpha">alpha</code></td>
<td>
<p>probability of type I error.</p>
</td></tr>
<tr><td><code id="bira2_+3A_two.tailed">two.tailed</code></td>
<td>
<p>logical; <code>TRUE</code> for two-tailed hypothesis testing, <code>FALSE</code> for one-tailed hypothesis testing. </p>
</td></tr>
<tr><td><code id="bira2_+3A_df">df</code></td>
<td>
<p>degrees of freedom.</p>
</td></tr>
<tr><td><code id="bira2_+3A_rho_ic">rho_ic</code></td>
<td>
<p>proportion of variance in the outcome (for treatment group) that is between intervention clusters.</p>
</td></tr>
<tr><td><code id="bira2_+3A_rho2_trt">rho2_trt</code></td>
<td>
<p>proportion of variance in the outcome (for treatment group) that is between level 2 units.</p>
</td></tr>
<tr><td><code id="bira2_+3A_rel1">rel1</code></td>
<td>
<p>level 1 outcome reliability coefficient (see Cox \&amp; Kelcey, 2019, p. 23).</p>
</td></tr>
<tr><td><code id="bira2_+3A_rho2">rho2</code></td>
<td>
<p>proportion of variance in the outcome between level 2 units (unconditional ICC2). <code>rho</code> also works.</p>
</td></tr>
<tr><td><code id="bira2_+3A_esv2">esv2</code></td>
<td>
<p>effect size variability as the ratio of the treatment effect variance between level 2 units to the total variance in the outcome (level 1 + level 2). <code>esv</code> also works. Ignored when <code>omega2</code> is specified.</p>
</td></tr>
<tr><td><code id="bira2_+3A_omega2">omega2</code></td>
<td>
<p>treatment effect heterogeneity as the ratio of the treatment effect variance between level 2 units to the unconditional level 2 residual variance. <code>omega</code> also works.</p>
</td></tr>
<tr><td><code id="bira2_+3A_omega2t">omega2t</code></td>
<td>
<p>standardized treatment effect variability across sites in the model that is not conditional on Level 2 moderator (ratio of the treatment effect variance between level 2 units to the total variance in the outcome.)</p>
</td></tr>
<tr><td><code id="bira2_+3A_omega2tm">omega2tm</code></td>
<td>
<p>standardized effect variability of the moderation across sites (ratio of the moderated treatment effect variance between level 2 units to the total variance in the outcome.)</p>
</td></tr>
<tr><td><code id="bira2_+3A_p">p</code></td>
<td>
<p>average proportion of level 1 units randomly assigned to treatment within level 2 units.</p>
</td></tr>
<tr><td><code id="bira2_+3A_q">q</code></td>
<td>
<p>proportion of level 1 (on average) or level 2 units in the moderator subgroup.</p>
</td></tr>
<tr><td><code id="bira2_+3A_g1">g1</code></td>
<td>
<p>number of covariates at level 1.</p>
</td></tr>
<tr><td><code id="bira2_+3A_g2">g2</code></td>
<td>
<p>number of covariates at level 2.</p>
</td></tr>
<tr><td><code id="bira2_+3A_r21">r21</code></td>
<td>
<p>proportion of level 1 variance in the outcome explained by level 1 covariates (applies to all levels in partially nested designs).</p>
</td></tr>
<tr><td><code id="bira2_+3A_r2t2">r2t2</code></td>
<td>
<p>proportion of treatment effect variance among level 2 units explained by level 2 covariates.</p>
</td></tr>
<tr><td><code id="bira2_+3A_n">n</code></td>
<td>
<p>level 1 sample size per block (average or harmonic mean).</p>
</td></tr>
<tr><td><code id="bira2_+3A_j">J</code></td>
<td>
<p>number of blocks.</p>
</td></tr>
<tr><td><code id="bira2_+3A_ic_size">ic_size</code></td>
<td>
<p>sample size for each intervention cluster.</p>
</td></tr>
<tr><td><code id="bira2_+3A_j0">J0</code></td>
<td>
<p>starting value for <code>J</code>.</p>
</td></tr>
<tr><td><code id="bira2_+3A_tol">tol</code></td>
<td>
<p>tolerance to end iterative process for finding <code>J</code>.</p>
</td></tr>
<tr><td><code id="bira2_+3A_z.test">z.test</code></td>
<td>
<p>logical; <code>TRUE</code> for z-test.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>fun</code></td>
<td>
<p>function name.</p>
</td></tr>
<tr><td><code>parms</code></td>
<td>
<p>list of parameters used in power calculation.</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>degrees of freedom.</p>
</td></tr>
<tr><td><code>ncp</code></td>
<td>
<p>noncentrality parameter.</p>
</td></tr>
<tr><td><code>power</code></td>
<td>
<p>statistical power <code class="reqn">(1-\beta)</code>.</p>
</td></tr>
<tr><td><code>mdes</code></td>
<td>
<p>minimum detectable effect size.</p>
</td></tr>
<tr><td><code>J</code></td>
<td>
<p>number of level 2 units.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Cox, K., \&amp; Kelcey, B. (2019). Optimal design of cluster-and multisite-randomized studies using fallible outcome measures. Evaluation Review, 43(3-4), 189-225. doi: <a href="https://doi.org/10.1177/0193841X19870878">10.1177/0193841X19870878</a>
</p>
<p>Dong, N., Kelcey, B., \&amp; Spybrook, J. (2020). Design considerations in multisite randomized trials probing moderated treatment effects. <em>Journal of Educational and Behavioral Statistics.</em> Advance online publication. doi: <a href="https://doi.org/10.3102/1076998620961492">10.3102/1076998620961492</a>
</p>
<p>Dong, N., \&amp; Maynard, R. (2013). PowerUp!: A tool for calculating minimum detectable effect sizes and minimum required sample sizes for experimental and quasi-experimental design studies. <em>Journal of Research on Educational Effectiveness</em>, <em>6</em>(1), 24-67. doi: <a href="https://doi.org/10.1080/19345747.2012.673143">10.1080/19345747.2012.673143</a>
</p>
<p>Lohr, S., Schochet, P. Z., \&amp; Sanders, E. (2014). Partially nested randomized controlled trials in education research: A guide to design and analysis. NCER 2014-2000. National Center for Education Research. <a href="https://ies.ed.gov/ncer/pubs/20142000/pdf/20142000.pdf">https://ies.ed.gov/ncer/pubs/20142000/pdf/20142000.pdf</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># cross-checks
mdes.bira2(rho2=.17, omega2=.50, n=15, J=20)
power.bira2(es=.366, rho2=.17, omega2=.50, n=15, J=20)
mrss.bira2(es=.366, rho2=.17, omega2=.50, n=15)

# cross-checks
power.mod211(es=.248, rho2=.247, omega2tm=.148, r21=.493, n=20, J=35)
mdes.mod211(power=.853, rho2=.247, omega2tm=.148, r21=.493, n=20, J=35)
mrss.mod211(es=.248, power = .853, rho2=.247, omega2tm=.148, r21=.493, n=20)

# cross-checks
power.mod212(es=.248, rho2=.247, omega2t=.148, r21=.493, n=20, J=20)
mdes.mod212(power=.739, rho2=.247, omega2t=.148, r21=.493, n=20, J=20)
mrss.mod212(es=.248, power=.739, rho2=.247, omega2t=.148, r21=.493, n=20)

# cross-checks
mdes.bira2_pn(n=20, J=15, rho_ic=.10, ic_size=5)
power.bira2_pn(es=.357, n=20, J=15, rho_ic=.10, ic_size=5)
mrss.bira2_pn(es=.357, n=20, rho_ic=.10, ic_size=5)
</code></pre>

<hr>
<h2 id='bira3'>Three-Level Blocked Individual-level Random Assignment Design</h2><span id='topic+bira3'></span><span id='topic+bira3r1'></span><span id='topic+mdes.bira3'></span><span id='topic+power.bira3'></span><span id='topic+mrss.bira3'></span><span id='topic+mdes.bira3r1'></span><span id='topic+power.bira3r1'></span><span id='topic+mrss.bira3r1'></span>

<h3>Description</h3>

<p>For three-level randomized block designs (treatment at level 1, with random effects across level 2 and 3 blocks), use <code>mdes.bira3()</code> to calculate the minimum detectable effect size, <code>power.bira3()</code> to calculate the statistical power, and <code>mrss.bira3()</code> to calculate the minimum required sample size.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mdes.bira3(power=.80, alpha=.05, two.tailed=TRUE,
           rho2, rho3, esv2=NULL, esv3=NULL,
           omega2=esv2/rho2, omega3=esv3/rho3,
           p=.50, r21=0, r2t2=0, r2t3=0, g3=0,
           n, J, K)

power.bira3(es=.25, alpha=.05, two.tailed=TRUE,
            rho2, rho3, esv2=NULL, esv3=NULL,
            omega2=esv2/rho2, omega3=esv3/rho3,
            p=.50, r21=0, r2t2=0, r2t3=0, g3=0,
            n, J, K)

mrss.bira3(es=.25, power=.80, alpha=.05, two.tailed=TRUE,
           n, J, K0=10, tol=.10,
           rho2, rho3, esv2=NULL, esv3=NULL,
           omega2=esv2/rho2, omega3=esv3/rho3,
           p=.50, r21=0, r2t2=0, r2t3=0, g3=0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bira3_+3A_power">power</code></td>
<td>
<p>statistical power <code class="reqn">(1-\beta)</code>.</p>
</td></tr>
<tr><td><code id="bira3_+3A_es">es</code></td>
<td>
<p>effect size.</p>
</td></tr>
<tr><td><code id="bira3_+3A_alpha">alpha</code></td>
<td>
<p>probability of type I error.</p>
</td></tr>
<tr><td><code id="bira3_+3A_two.tailed">two.tailed</code></td>
<td>
<p>logical; <code>TRUE</code> for two-tailed hypothesis testing, <code>FALSE</code> for one-tailed hypothesis testing. </p>
</td></tr>
<tr><td><code id="bira3_+3A_rho2">rho2</code></td>
<td>
<p>proportion of variance in the outcome between level 2 units (unconditional ICC2).</p>
</td></tr>
<tr><td><code id="bira3_+3A_rho3">rho3</code></td>
<td>
<p>proportion of variance in the outcome between level 3 units (unconditional ICC3).</p>
</td></tr>
<tr><td><code id="bira3_+3A_esv2">esv2</code></td>
<td>
<p>effect size variability as the ratio of the treatment effect variance between level 2 units to the total variance in the outcome (level 1 + level 2 + level 3). Ignored when <code>omega2</code> is specified.</p>
</td></tr>
<tr><td><code id="bira3_+3A_esv3">esv3</code></td>
<td>
<p>effect size variability as the ratio of the treatment effect variance between level 3 units to the total variance in the outcome (level 1 + level 2 + level 3). Ignored when <code>omega3</code> is specified.</p>
</td></tr>
<tr><td><code id="bira3_+3A_omega2">omega2</code></td>
<td>
<p>treatment effect heterogeneity as ratio of treatment effect variance among level 2 units to the residual variance at level 2.</p>
</td></tr>
<tr><td><code id="bira3_+3A_omega3">omega3</code></td>
<td>
<p>treatment effect heterogeneity as ratio of treatment effect variance among level 3 units to the residual variance at level 3.</p>
</td></tr>
<tr><td><code id="bira3_+3A_p">p</code></td>
<td>
<p>average proportion of level 1 units randomly assigned to treatment within level 2 units.</p>
</td></tr>
<tr><td><code id="bira3_+3A_g3">g3</code></td>
<td>
<p>number of covariates at level 3.</p>
</td></tr>
<tr><td><code id="bira3_+3A_r21">r21</code></td>
<td>
<p>proportion of level 1 variance in the outcome explained by level 1 covariates.</p>
</td></tr>
<tr><td><code id="bira3_+3A_r2t2">r2t2</code></td>
<td>
<p>proportion of treatment effect variance among level 2 units explained by level 2 covariates.</p>
</td></tr>
<tr><td><code id="bira3_+3A_r2t3">r2t3</code></td>
<td>
<p>proportion of treatment effect variance among level 3 units explained by level 3 covariates.</p>
</td></tr>
<tr><td><code id="bira3_+3A_n">n</code></td>
<td>
<p>harmonic mean of level 1 units across level 2 units (or simple average).</p>
</td></tr>
<tr><td><code id="bira3_+3A_j">J</code></td>
<td>
<p>harmonic mean of level 2 units across level 3 units (or simple average).</p>
</td></tr>
<tr><td><code id="bira3_+3A_k">K</code></td>
<td>
<p>number of level 3 units.</p>
</td></tr>
<tr><td><code id="bira3_+3A_k0">K0</code></td>
<td>
<p>starting value for <code>K</code>.</p>
</td></tr>
<tr><td><code id="bira3_+3A_tol">tol</code></td>
<td>
<p>tolerance to end iterative process for finding <code>K</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>fun</code></td>
<td>
<p>function name.</p>
</td></tr>
<tr><td><code>parms</code></td>
<td>
<p>list of parameters used in power calculation.</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>degrees of freedom.</p>
</td></tr>
<tr><td><code>ncp</code></td>
<td>
<p>noncentrality parameter.</p>
</td></tr>
<tr><td><code>power</code></td>
<td>
<p>statistical power <code class="reqn">(1-\beta)</code>.</p>
</td></tr>
<tr><td><code>mdes</code></td>
<td>
<p>minimum detectable effect size.</p>
</td></tr>
<tr><td><code>K</code></td>
<td>
<p>number of level 3 units.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># cross-checks
mdes.bira3(rho3=.20, rho2=.15,
           omega3=.10, omega2=.10,
           n=69, J=10, K=100)
power.bira3(es = .045, rho3=.20, rho2=.15,
            omega3=.10, omega2=.10,
            n=69, J=10, K=100)
mrss.bira3(es = .045, rho3=.20, rho2=.15,
           omega3=.10, omega2=.10,
           n=69, J=10)
</code></pre>

<hr>
<h2 id='bira4'>Four-Level Blocked Individual-level Random Assignment Design</h2><span id='topic+bira4'></span><span id='topic+bira4r1'></span><span id='topic+mdes.bira4'></span><span id='topic+power.bira4'></span><span id='topic+mrss.bira4'></span><span id='topic+mdes.bira4r1'></span><span id='topic+power.bira4r1'></span><span id='topic+mrss.bira4r1'></span>

<h3>Description</h3>

<p>For four-level randomized block designs (treatment at level 1, random effects across level 2, 3 and 4), use <code>mdes.bira4()</code> to calculate the minimum detectable effect size, <code>power.bira4()</code> to calculate the statistical power, and <code>mrss.bira4r1()</code> to calculate the minimum required sample size.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mdes.bira4(power=.80, alpha=.05, two.tailed=TRUE,
           rho2, rho3, rho4, esv2=NULL, esv3=NULL, esv4=NULL,
           omega2=esv2/rho2, omega3=esv3/rho3, omega4=esv4/rho4,
           p=.50, r21=0, r2t2=0, r2t3=0, r2t4=0, g4=0,
           n, J, K, L)

power.bira4(es=.25, alpha=.05, two.tailed=TRUE,
            rho2, rho3, rho4, esv2=NULL, esv3=NULL, esv4=NULL,
            omega2=esv2/rho2, omega3=esv3/rho3, omega4=esv4/rho4,
            p=.50, r21=0, r2t2=0, r2t3=0, r2t4=0, g4=0,
            n, J, K, L)

mrss.bira4(es=.25, power=.80, alpha=.05, two.tailed=TRUE,
           n, J, K, L0=10, tol=.10,
           rho2, rho3, rho4, esv2=NULL, esv3=NULL, esv4=NULL,
           omega2=esv2/rho2, omega3=esv3/rho3, omega4=esv4/rho4,
           p=.50, r21=0, r2t2=0, r2t3=0, r2t4=0, g4=0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bira4_+3A_power">power</code></td>
<td>
<p>statistical power <code class="reqn">(1-\beta)</code>.</p>
</td></tr>
<tr><td><code id="bira4_+3A_es">es</code></td>
<td>
<p>effect size.</p>
</td></tr>
<tr><td><code id="bira4_+3A_alpha">alpha</code></td>
<td>
<p>probability of type I error.</p>
</td></tr>
<tr><td><code id="bira4_+3A_two.tailed">two.tailed</code></td>
<td>
<p>logical; <code>TRUE</code> for two-tailed hypothesis testing, <code>FALSE</code> for one-tailed hypothesis testing. </p>
</td></tr>
<tr><td><code id="bira4_+3A_rho2">rho2</code></td>
<td>
<p>proportion of variance in the outcome between level 2 units (unconditional ICC2).</p>
</td></tr>
<tr><td><code id="bira4_+3A_rho3">rho3</code></td>
<td>
<p>proportion of variance in the outcome between level 3 units (unconditional ICC3).</p>
</td></tr>
<tr><td><code id="bira4_+3A_rho4">rho4</code></td>
<td>
<p>proportion of variance in the outcome between level 4 units (unconditional ICC4).</p>
</td></tr>
<tr><td><code id="bira4_+3A_esv2">esv2</code></td>
<td>
<p>effect size variability as the ratio of the treatment effect variance between level 2 units to the total variance in the outcome (level 1 + level 2 + level 3 + level 4). Ignored when <code>omega2</code> is specified.</p>
</td></tr>
<tr><td><code id="bira4_+3A_esv3">esv3</code></td>
<td>
<p>effect size variability as the ratio of the treatment effect variance between level 3 units to the total variance in the outcome (level 1 + level 2 + level 3 + level 4). Ignored when <code>omega3</code> is specified.</p>
</td></tr>
<tr><td><code id="bira4_+3A_esv4">esv4</code></td>
<td>
<p>effect size variability as the ratio of the treatment effect variance between level 4 units to the total variance in the outcome (level 1 + level 2 + level 3 + level 4). Ignored when <code>omega4</code> is specified.</p>
</td></tr>
<tr><td><code id="bira4_+3A_omega2">omega2</code></td>
<td>
<p>treatment effect heterogeneity as ratio of treatment effect variance among level 2 units to the residual variance at level 2.</p>
</td></tr>
<tr><td><code id="bira4_+3A_omega3">omega3</code></td>
<td>
<p>treatment effect heterogeneity as ratio of treatment effect variance among level 3 units to the residual variance at level 3.</p>
</td></tr>
<tr><td><code id="bira4_+3A_omega4">omega4</code></td>
<td>
<p>treatment effect heterogeneity as ratio of treatment effect variance among level 4 units to the residual variance at level 4.</p>
</td></tr>
<tr><td><code id="bira4_+3A_p">p</code></td>
<td>
<p>average proportion of level 1 units randomly assigned to treatment within level 2 units.</p>
</td></tr>
<tr><td><code id="bira4_+3A_g4">g4</code></td>
<td>
<p>number of covariates at level 4.</p>
</td></tr>
<tr><td><code id="bira4_+3A_r21">r21</code></td>
<td>
<p>proportion of level 1 variance in the outcome explained by level 1 covariates.</p>
</td></tr>
<tr><td><code id="bira4_+3A_r2t2">r2t2</code></td>
<td>
<p>proportion of treatment effect variance among level 2 units explained by level 2 covariates.</p>
</td></tr>
<tr><td><code id="bira4_+3A_r2t3">r2t3</code></td>
<td>
<p>proportion of treatment effect variance among level 3 units explained by level 3 covariates.</p>
</td></tr>
<tr><td><code id="bira4_+3A_r2t4">r2t4</code></td>
<td>
<p>proportion of treatment effect variance among level 4 units explained by level 4 covariates.</p>
</td></tr>
<tr><td><code id="bira4_+3A_n">n</code></td>
<td>
<p>harmonic mean of level 1 units across level 2 units (or simple average).</p>
</td></tr>
<tr><td><code id="bira4_+3A_j">J</code></td>
<td>
<p>harmonic mean of level 2 units across level 3 units (or simple average).</p>
</td></tr>
<tr><td><code id="bira4_+3A_k">K</code></td>
<td>
<p>harmonic mean of level 3 units across level 4 units (or simple average).</p>
</td></tr>
<tr><td><code id="bira4_+3A_l">L</code></td>
<td>
<p>number of level 4 units.</p>
</td></tr>
<tr><td><code id="bira4_+3A_l0">L0</code></td>
<td>
<p>starting value for <code>L</code>.</p>
</td></tr>
<tr><td><code id="bira4_+3A_tol">tol</code></td>
<td>
<p>tolerance to end iterative process for finding <code>L</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>fun</code></td>
<td>
<p>function name.</p>
</td></tr>
<tr><td><code>parms</code></td>
<td>
<p>list of parameters used in power calculation.</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>degrees of freedom.</p>
</td></tr>
<tr><td><code>ncp</code></td>
<td>
<p>noncentrality parameter.</p>
</td></tr>
<tr><td><code>power</code></td>
<td>
<p>statistical power <code class="reqn">(1-\beta)</code>.</p>
</td></tr>
<tr><td><code>mdes</code></td>
<td>
<p>minimum detectable effect size.</p>
</td></tr>
<tr><td><code>L</code></td>
<td>
<p>number of level 4 units.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># cross-checks
mdes.bira4(rho4=.05, rho3=.15, rho2=.15,
           omega4=.50, omega3=.50, omega2=.50,
           n=10, J=4, K=4, L=27)
power.bira4(es = 0.142, rho4=.05, rho3=.15, rho2=.15,
            omega4=.50, omega3=.50, omega2=.50,
            n=10, J=4, K=4, L=27)
mrss.bira4(es = 0.142, rho4=.05, rho3=.15, rho2=.15,
           omega4=.50, omega3=.50, omega2=.50,
           n=10, J=4, K=4)
</code></pre>

<hr>
<h2 id='conversion'>Object Conversion</h2><span id='topic+mrss.to.mdes'></span><span id='topic+mrss.to.power'></span><span id='topic+power.to.mdes'></span><span id='topic+mdes.to.power'></span><span id='topic+mdes.to.pctl'></span>

<h3>Description</h3>

<p>Use <code>mrss.to.mdes()</code> to convert an object returned from MRSS functions into an object returned from MDES functions, <code>mrss.to.power()</code> to convert an object returned from MRSS functions into an object returned from power functions, <code>power.to.mdes()</code> to convert an object returned from power functions into an object returned from MDES functions, <code>mdes.to.power()</code> to convert an object returned from MDES functions into an object returned from power functions, and <code>mdes.to.pctl()</code> to convert effect sizes or an object returned from MDES functions into percentiles.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  mrss.to.mdes(object)
  mrss.to.power(object)
  power.to.mdes(object)
  mdes.to.power(object)
  mdes.to.pctl(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="conversion_+3A_object">object</code></td>
<td>
<p>an object returned from one of the functions in <span class="pkg">PowerUpR</span> package.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>design1 &lt;- power.bira2(es=.15, rho2=.35, omega2=.10, n=83, J=10)
design2 &lt;- power.to.mdes(design1)
mdes.to.pctl(design2)
</code></pre>

<hr>
<h2 id='cra2'>Two-level Cluster-randomized Trials to Detect Main, Moderation and Mediation Effects</h2><span id='topic+cra2'></span><span id='topic+cra2r2'></span><span id='topic+cra2_pn'></span><span id='topic+bcra3f2'></span><span id='topic+mdes.cra2'></span><span id='topic+power.cra2'></span><span id='topic+mrss.cra2'></span><span id='topic+mdes.cra2r2'></span><span id='topic+mdes.mod221'></span><span id='topic+mdes.mod222'></span><span id='topic+mdesd.mod221'></span><span id='topic+mdesd.mod222'></span><span id='topic+power.cra2r2'></span><span id='topic+power.mod221'></span><span id='topic+power.mod222'></span><span id='topic+power.med211'></span><span id='topic+power.med221'></span><span id='topic+mrss.cra2r2'></span><span id='topic+mrss.mod221'></span><span id='topic+mrss.mod222'></span><span id='topic+mdes.bcra3f2'></span><span id='topic+power.bcra3f2'></span><span id='topic+mrss.bcra3f2'></span><span id='topic+mdes.cra2_pn'></span><span id='topic+power.cra2_pn'></span><span id='topic+mrss.cra2_pn'></span>

<h3>Description</h3>

<p>For main treatment effects, use <code>mdes.cra2()</code> to calculate the minimum detectable effect size, <code>power.cra2()</code> to calculate the statistical power, <code>mrss.cra2()</code> to calculate the minimum required sample size (number of clusters).
</p>
<p>For moderator at level 1, use <code>mdesd.mod221()</code> to calculate the minimum detectable effect size, <code>power.mod221()</code> to calculate the statistical power, <code>mrss.mod221()</code> to calculate the minimum required sample size (number of clusters).
</p>
<p>For moderator at level 2, use <code>mdesd.mod222()</code> to calculate the minimum detectable effect size, <code>power.mod222()</code> to calculate the statistical power, <code>mrss.mod222()</code> to calculate the minimum required sample size (number of clusters).
</p>
<p>For mediator at level 1 and level 2, use <code>power.med211()</code> to calculate the statistical power for the 2-1-1 mediation, and <code>power.med221()</code> for the 2-2-1 mediation.
</p>
<p>For cluster-randomized block designs (treatment at level 2, with fixed effects across level 3 blocks), use <code>mdes.bcra3f2()</code> to calculate the minimum detectable effect size, <code>power.bcra3f2()</code> to calculate the statistical power, and <code>mrss.bcra3f2()</code> to calculate the minimum required sample size (number of clusters per block).
</p>
<p>For partially nested cluster randomized trials (interventions clusters in treatment groups) use <code>mdes.cra2_pn()</code> to calculate the minimum detectable effect size, <code>power.cra2_pn()</code> to calculate the statistical power, and <code>mrss.cra2_pn()</code> to calculate the minimum required sample size (number of schools).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mdes.cra2(power=.80, alpha=.05, two.tailed=TRUE,
          rel1 = 1, rho2, p=.50, g2=0, r21=0, r22=0,
          n, J)

mdesd.mod221(power=.80, alpha=.05, two.tailed=TRUE,
            rho2, omegam2, r21=0, r2m2=0,
            p=.50, q=NULL, n, J)

mdesd.mod222(power=.80, alpha=.05, two.tailed=TRUE,
            rho2, r22=0,
            p=.50, q=NULL, n, J)

power.cra2(es=.25, alpha=.05, two.tailed=TRUE,
           rel1 = 1, rho2, g2=0, p=.50, r21=0, r22=0,
           n, J)

power.mod221(es=.25, alpha=.05, two.tailed=TRUE,
             rho2, omegam2, r21=0, r2m2=0,
             p=.50, q=NULL, n, J)

power.mod222(es=.25, alpha=.05, two.tailed=TRUE,
             rho2, r22=0,
             p=.50, q=NULL, n, J)

power.med211(esa, esb1, esB, escp, two.tailed = TRUE, alpha = .05,
             mc = FALSE, nsims = 1000, ndraws = 1000,
             rhom2, rho2, r21, r22, r2m1, r2m2,
             p, n, J)

power.med221(esa, esb, escp, two.tailed = TRUE, alpha = .05,
             mc = FALSE, nsims = 1000, ndraws = 1000,
             rho2, r22, r21, r2m2,
             p = .50, n, J)

mrss.cra2(es=.25, power=.80, alpha=.05, two.tailed=TRUE,
          n, J0=10, tol=.10, rel1 = 1,
          rho2, g2=0, p=.50, r21=0, r22=0)

mrss.mod221(es=.25, power=.80, alpha=.05, two.tailed=TRUE,
            n, J0=10, tol=.10, rho2, omegam2, r21=0, r2m2=0,
            p=.50, q=NULL)

mrss.mod222(es=.25, power=.80, alpha=.05, two.tailed=TRUE,
            n, J0=10, tol=.10, rho2, r22=0,
            p=.50, q=NULL)

mdes.bcra3f2(power=.80, alpha=.05, two.tailed=TRUE,
             rho2, p=.50, g2=0, r21=0, r22=0,
             n, J, K)

power.bcra3f2(es=.25, alpha=.05, two.tailed=TRUE,
              rho2, p=.50, g2=0, r21=0, r22=0,
              n, J, K)

mrss.bcra3f2(es=.25, power=.80, alpha=.05, two.tailed=TRUE,
             n, K, J0=10, tol=.10,
             rho2, p=.50, g2=0, r21=0, r22=0)

mdes.cra2_pn(power=.80, alpha=.05, two.tailed=TRUE, df=NULL,
             rho2_trt=.20, rho_ic=0, p=.50,
             r21=0, n, J, ic_size=1)

power.cra2_pn(es=.25,alpha=.05, two.tailed=TRUE, df=NULL,
              rho2_trt=.20, rho_ic=0, p=.50,
              r21=0, n, J, ic_size=1)

mrss.cra2_pn(es=.25, power=.80, alpha=.05, two.tailed=TRUE,
             z.test=FALSE, rho2_trt=.20, rho_ic=0, p=.50,
             r21=0, n, ic_size=1, J0=10, tol=.10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cra2_+3A_power">power</code></td>
<td>
<p>statistical power <code class="reqn">(1-\beta)</code></p>
</td></tr>
<tr><td><code id="cra2_+3A_es">es</code>, <code id="cra2_+3A_esa">esa</code>, <code id="cra2_+3A_esb">esb</code>, <code id="cra2_+3A_esb1">esb1</code>, <code id="cra2_+3A_esb">esB</code>, <code id="cra2_+3A_escp">escp</code></td>
<td>
<p>effect size for main/moderator effects, or for path coefficients a (treatment - mediator), b (level 2 mediator - outcome), b1 (level 1 mediator - outcome), B (overall mediator - outcome) or cp (direct treatment - outcome) in the mediation model.</p>
</td></tr>
<tr><td><code id="cra2_+3A_alpha">alpha</code></td>
<td>
<p>probability of type I error.</p>
</td></tr>
<tr><td><code id="cra2_+3A_two.tailed">two.tailed</code></td>
<td>
<p>logical; <code>FALSE</code> for one-tailed hypothesis testing.</p>
</td></tr>
<tr><td><code id="cra2_+3A_df">df</code></td>
<td>
<p>degrees of freedom.</p>
</td></tr>
<tr><td><code id="cra2_+3A_rho_ic">rho_ic</code></td>
<td>
<p>proportion of variance in the outcome that is between intervention clusters.</p>
</td></tr>
<tr><td><code id="cra2_+3A_rho2_trt">rho2_trt</code></td>
<td>
<p>proportion of variance in the outcome (for treatment group) that is between level 2 units.</p>
</td></tr>
<tr><td><code id="cra2_+3A_rel1">rel1</code></td>
<td>
<p>level 1 outcome reliability coefficient (Cox \&amp; Kelcey, 2019b).</p>
</td></tr>
<tr><td><code id="cra2_+3A_rho2">rho2</code></td>
<td>
<p>proportion of variance in the outcome between level 2 units (unconditional ICC2). <code>rho</code> also works.</p>
</td></tr>
<tr><td><code id="cra2_+3A_rhom2">rhom2</code></td>
<td>
<p>proportion of variance in the mediator between level 2 units.</p>
</td></tr>
<tr><td><code id="cra2_+3A_omegam2">omegam2</code></td>
<td>
<p>ratio of the unconditional variance in the moderator effect that is between level 2 units to the residual variance between level 2 units in the null model.</p>
</td></tr>
<tr><td><code id="cra2_+3A_p">p</code></td>
<td>
<p>proportion of level 2 units randomly assigned to treatment.</p>
</td></tr>
<tr><td><code id="cra2_+3A_q">q</code></td>
<td>
<p>proportion of level 1 or level 2 units in the moderator subgroup.</p>
</td></tr>
<tr><td><code id="cra2_+3A_g2">g2</code></td>
<td>
<p>number of covariates at level 2.</p>
</td></tr>
<tr><td><code id="cra2_+3A_r21">r21</code></td>
<td>
<p>proportion of level 1 variance in the outcome explained by level 1 covariates (applies to all levels in partially nested designs).</p>
</td></tr>
<tr><td><code id="cra2_+3A_r22">r22</code></td>
<td>
<p>proportion of level 2 variance in the outcome explained by level 2 covariates.</p>
</td></tr>
<tr><td><code id="cra2_+3A_r2m1">r2m1</code></td>
<td>
<p>proportion of mediator variance at level 1 explained by level 1 covariates.</p>
</td></tr>
<tr><td><code id="cra2_+3A_r2m2">r2m2</code></td>
<td>
<p>proportion of variance in the moderator effect that is explained by level 2 predictors. For the mediation model, proportion of variance in the mediator explained by level 2 predictors.</p>
</td></tr>
<tr><td><code id="cra2_+3A_n">n</code></td>
<td>
<p>harmonic mean of level 1 units across level 2 units (or simple average).</p>
</td></tr>
<tr><td><code id="cra2_+3A_j">J</code></td>
<td>
<p>level 2 sample size.</p>
</td></tr>
<tr><td><code id="cra2_+3A_k">K</code></td>
<td>
<p>number of level 3 units (blocks).</p>
</td></tr>
<tr><td><code id="cra2_+3A_ic_size">ic_size</code></td>
<td>
<p>sample size for each intervention cluster.</p>
</td></tr>
<tr><td><code id="cra2_+3A_j0">J0</code></td>
<td>
<p>starting value for <code>J</code>.</p>
</td></tr>
<tr><td><code id="cra2_+3A_tol">tol</code></td>
<td>
<p>tolerance to end iterative process for finding <code>J</code>.</p>
</td></tr>
<tr><td><code id="cra2_+3A_z.test">z.test</code></td>
<td>
<p>logical; <code>TRUE</code> for z-test.</p>
</td></tr>
<tr><td><code id="cra2_+3A_mc">mc</code></td>
<td>
<p>logical; <code>TRUE</code> for monte carlo simulation based power.</p>
</td></tr>
<tr><td><code id="cra2_+3A_nsims">nsims</code></td>
<td>
<p>number of replications, if <code>mc = TRUE</code>.</p>
</td></tr>
<tr><td><code id="cra2_+3A_ndraws">ndraws</code></td>
<td>
<p>number of draws from the distribution of the path coefficients for each replication, if <code>mc = TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>fun</code></td>
<td>
<p>function name.</p>
</td></tr>
<tr><td><code>parms</code></td>
<td>
<p>list of parameters used in power calculation.</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>degrees of freedom.</p>
</td></tr>
<tr><td><code>ncp</code></td>
<td>
<p>noncentrality parameter.</p>
</td></tr>
<tr><td><code>power</code></td>
<td>
<p>statistical power <code class="reqn">(1-\beta)</code>.</p>
</td></tr>
<tr><td><code>mdes</code></td>
<td>
<p>minimum detectable effect size.</p>
</td></tr>
<tr><td><code>J</code></td>
<td>
<p>number of level 2 units.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Cox, K., \&amp; Kelcey, B. (2019a). Optimal sample allocation in group-randomized mediation studies with a group-level mediator. <em>The Journal of Experimental Education</em>, <em>87</em>(4), 616-640. doi: <a href="https://doi.org/10.1080/00220973.2018.1496060">10.1080/00220973.2018.1496060</a>
</p>
<p>Cox, K., \&amp; Kelcey, B. (2019b). Optimal design of cluster-and multisite-randomized studies using fallible outcome measures. <em>Evaluation Review</em>,  <em>43</em>(3-4), 189-225. doi: <a href="https://doi.org/10.1177/0193841X19870878">10.1177/0193841X19870878</a>
</p>
<p>Dong, N., Spybrook J., Kelcey, B., \&amp; Bulus, M.  (2021). Power analyses for moderator effects with (non)random slopes in cluster randomized trials. <em>Methodology</em>, <em>17</em>(2), 92-110. doi: <a href="https://doi.org/10.5964/meth.4003">10.5964/meth.4003</a>
</p>
<p>Kelcey, B., Dong, N., Spybrook, J., \&amp; Cox, K. (2017). Statistical power for causally defined indirect effects in group-randomized trials with individual-level mediators. <em>Journal of Educational and Behavioral Statistics</em>, <em>42</em>(5), 499-530. doi: <a href="https://doi.org/10.3102/1076998617695506">10.3102/1076998617695506</a>
</p>
<p>Kelcey, B., Dong, N., Spybrook, J., \&amp; Shen, Z. (2017). Experimental power for indirect effects in group-randomized studies with group-level mediators. <em>Multivariate behavioral research</em>, <em>52</em>(6), 699-719. doi: <a href="https://doi.org/10.1080/00273171.2017.1356212">10.1080/00273171.2017.1356212</a>
</p>
<p>Kelcey, B., \&amp; Shen, Z. (2020). Strategies for efficient experimental design in studies probing 2-1-1 mediation. <em>The Journal of Experimental Education</em>, <em>88</em>(2), 311-334. doi: <a href="https://doi.org/10.1080/00220973.2018.1533796">10.1080/00220973.2018.1533796</a>
</p>
<p>Kelcey, B., Spybrook, J., \&amp; Dong, N. (2019). Sample size planning for cluster-randomized interventions probing multilevel mediation. <em>Prevention Science</em>, <em>20</em>(3), 407-418. doi: <a href="https://doi.org/10.1007/s11121-018-0921-6">10.1007/s11121-018-0921-6</a>
</p>
<p>Spybrook, J., Kelcey, B., \&amp; Dong, N. (2016). Power for detecting treatment by moderator effects in two-and three-level cluster randomized trials. <em>Journal of Educational and Behavioral Statistics</em>, <em>41</em>(6), 605-627. doi: <a href="https://doi.org/10.3102/1076998616655442">10.3102/1076998616655442</a>
</p>
<p>Dong, N., \&amp; Maynard, R. (2013). PowerUp!: A tool for calculating minimum detectable effect sizes and minimum required sample sizes for experimental and quasi-experimental design studies. <em>Journal of Research on Educational Effectiveness</em>, <em>6</em>(1), 24-67. doi: <a href="https://doi.org/10.1080/19345747.2012.673143">10.1080/19345747.2012.673143</a>
</p>
<p>Lohr, S., Schochet, P. Z., \&amp; Sanders, E. (2014). Partially nested randomized controlled trials in education research: A guide to design and analysis. NCER 2014-2000. National Center for Education Research. <a href="https://ies.ed.gov/ncer/pubs/20142000/pdf/20142000.pdf">https://ies.ed.gov/ncer/pubs/20142000/pdf/20142000.pdf</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># cross-checks for the main effect
mdes.cra2(rho2=.17, n=15, J=20)
power.cra2(es=.629, rho2=.17, n=15, J=20)
mrss.cra2(es=.629, rho2=.17, n=15)

# cross-checks for the randomly varying cont. L1 moderator effect
mdesd.mod221(rho2=.17, omegam2=.10, n=15, J=20)
power.mod221(es=.3563, rho2=.17, omegam2 =.10, n=15, J=20)
mrss.mod221(es=.3563, rho2=.17, omegam2 =.10, n=15)

# cross-checks for the non-randomly varying cont. L1 moderator effect
mdesd.mod221(rho2=.17, omegam2=0, n=15, J=20)
power.mod221(es=0.2957, rho2=.17, omegam2 =0, n=15, J=20)
mrss.mod221(es=0.2957, rho2=.17, omegam2 =0, n=15)

# cross-checks for the randomly varying bin. L1 moderator effect
mdesd.mod221(rho2=.17, omegam2=.10, q=.50, n=15, J=20)
power.mod221(es=.647, rho2=.17, omegam2 =.10, q=.50, n=15, J=20)
mrss.mod221(es=.647, rho2=.17, omegam2 =.10, q=.50, n=15)

# cross-checks for the non-randomly varying bin. L1 moderator effect
mdesd.mod221(rho2=.17, omegam2=0, q=.50, n=15, J=20)
power.mod221(es=0.5915, rho2=.17, omegam2 =0, q=.50, n=15, J=20)
mrss.mod221(es=0.5915, rho2=.17, omegam2 =0, q=.50, n=15)

# cross-checks for the cont. L2 moderator effect
mdesd.mod222(rho2=.17, n=15, J=100)
power.mod222(es=0.2757, rho2=.17, n=15, J=100)
mrss.mod222(es=0.2757, rho2=.17, n=15)

# cross-checks for the bin. L2 moderator effect
mdesd.mod222(rho2=.17, q=.50, n=15, J=100)
power.mod222(es=0.5514, rho2=.17, q=.50, n=15, J=100)
mrss.mod222(es=0.5514, rho2=.17, q=.50, n=15)

# 2-2-1 mediation
power.med221(esa=0.6596, esb=0.1891, escp=.1,
             rho2=.15, r22=.52, r21=.40, r2m2=.50,
             n=100, J=40, p=.5)

# 2-1-1 mediation
power.med211(esa=0.4135, esb1=0.0670, esB=0.3595, escp=.1,
            rhom2=.3, rho2=.3, r22=.6, r21=.6, r2m2=.6, r2m1=.6,
            n=30, J=80, p=.1)

# cross-checks for cluster-randomized block design
# treatment at level 2, with fixed effects across level 3 blocks
mdes.bcra3f2(rho2=.10, n=20, J=44, K=5)
power.bcra3f2(es = .145, rho2=.10, n=20, J=44, K=5)
mrss.bcra3f2(es = .145, rho2=.10, n=20, K=5)

# cross-checks for partially nested cluster-randomized trial
mdes.cra2_pn(n=40, J=70, rho2_trt=.15, rho_ic=.10, ic_size=10)
power.cra2_pn(es=.305, n=40, J=70, rho2_trt=.15, rho_ic=.10, ic_size=10)
mrss.cra2_pn(es=.305, n=40, rho2_trt=.15, rho_ic=.10, ic_size=10)
</code></pre>

<hr>
<h2 id='cra3'>Three-level Cluster-randomized Trials to Detect Main, Moderation, and Mediation Effects</h2><span id='topic+cra3'></span><span id='topic+cra3r3'></span><span id='topic+bcra4f3'></span><span id='topic+mdes.cra3'></span><span id='topic+power.cra3'></span><span id='topic+mrss.cra3'></span><span id='topic+mdes.bcra4f3'></span><span id='topic+power.bcra4f3'></span><span id='topic+mrss.bcra4f3'></span><span id='topic+mdes.cra3r3'></span><span id='topic+mdes.mod331'></span><span id='topic+mdes.mod332'></span><span id='topic+mdes.mod333'></span><span id='topic+mdesd.mod331'></span><span id='topic+mdesd.mod332'></span><span id='topic+mdesd.mod333'></span><span id='topic+power.cra3r3'></span><span id='topic+power.mod331'></span><span id='topic+power.mod332'></span><span id='topic+power.mod333'></span><span id='topic+power.med331'></span><span id='topic+power.med321'></span><span id='topic+power.med311'></span><span id='topic+mrss.cra3r3'></span><span id='topic+mrss.mod331'></span><span id='topic+mrss.mod332'></span><span id='topic+mrss.mod333'></span><span id='topic+mdes.bcra4f3'></span><span id='topic+power.bcra4f3'></span><span id='topic+mrss.bcra4f3'></span>

<h3>Description</h3>

<p>For main treatment effects, use <code>mdes.cra3()</code> to calculate the minimum detectable effect size, <code>power.cra3()</code> to calculate the statistical power, <code>mrss.cra3()</code> to calculate the minimum required sample size (number of clusters).
</p>
<p>For moderator at level 1, use <code>mdesd.mod331()</code> to calculate the minimum detectable effect size, <code>power.mod331()</code> to calculate the statistical power, <code>mrss.mod331()</code> to calculate the minimum required sample size (number of clusters).
</p>
<p>For moderator at level 2, use <code>mdesd.mod332()</code> to calculate the minimum detectable effect size, <code>power.mod332()</code> to calculate the statistical power, <code>mrss.mod332()</code> to calculate the minimum required sample size (number of clusters).
</p>
<p>For moderator at level 3, use <code>mdesd.mod333()</code> to calculate the minimum detectable effect size, <code>power.mod333()</code> to calculate the statistical power, <code>mrss.mod333()</code> to calculate the minimum required sample size (number of clusters).
</p>
<p>For mediator at level 3, use <code>power.med331()</code>, for mediator at level 2, use <code>power.med321()</code>, for mediator at level 1, use <code>power.med311()</code> to calculate the statistical power.
</p>
<p>For cluster-randomized block designs (treatment at level 3, with fixed effects across level 4 blocks), use <code>mdes.bcra4f3()</code> to calculate the minimum detectable effect size, <code>power.bcra4f3()</code> to calculate the statistical power, and <code>mrss.bcra4f3()</code> to calculate the minimum required sample size (number of clusters per block).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mdes.cra3(power=.80, alpha=.05, two.tailed=TRUE,
          rho2, rho3, p=.50, g3=0, r21=0, r22=0, r23=0,
          n, J, K)

mdesd.mod331(power=.80, alpha=.05, two.tailed=TRUE,
            rho2, rho3, omegam2, omegam3,
            r21=0, r2m3=0,
            p=.50, q=NULL, n, J, K)

mdesd.mod332(power=.80, alpha=.05, two.tailed=TRUE,
            rho2, rho3, omegam3, r21=0, r22=0, r2m3=0,
            p=.50, q=NULL, n, J, K)

mdesd.mod333(power=.80, alpha=.05, two.tailed=TRUE,
            rho2, rho3, r21=0, r22=0, r23=0,
            p=.50, q=NULL, n, J, K)

power.cra3(es=.25, alpha=.05, two.tailed=TRUE,
           rho2, rho3, g3=0, r21=0, r22=0, r23=0,
           p=.50, n, J, K)

power.mod331(es=.25, alpha=.05, two.tailed=TRUE,
             rho2, rho3, omegam2, omegam3,
             r21=0, r2m3=0,
             p=.50, q=NULL, n, J, K)

power.mod332(es=.25, alpha=.05, two.tailed=TRUE,
             rho2, rho3, omegam3, r21=0, r22=0, r2m3=0,
             p=.50, q=NULL, n, J, K)

power.mod333(es=.25, alpha=.05, two.tailed=TRUE,
             rho2, rho3, r21=0, r22=0, r23=0,
             p=.50, q=NULL, n, J, K)

power.med331(esa, esB, two.tailed=TRUE, alpha=.05,
             mc=TRUE, nsims=1000, ndraws=1000,
             rho2, rho3, gm3=4, r2m3=0, r21=0, r22=0,
             g3=5, r23=0, p=.50, n, J, K)

power.med321(esa, esB, two.tailed=TRUE, alpha=.05,
             mc=TRUE, nsims=1000, ndraws=1000,
             rhom3, rho2, rho3, r2m2=0,
             gm3=4, r2m3=0, r21=0, r22=0, g3=5, r23=0,
             p=.50, n, J, K)

power.med311(esa, esB, two.tailed=TRUE, alpha=.05,
             mc=TRUE, nsims=1000, ndraws=1000,
             rhom2, rhom3, rho2, rho3,
             r2m1=0, r2m2=0, gm3=4, r2m3=0,
             r21=0, r22=0, g3=5, r23=0,
             p=.50, n, J, K)

mrss.cra3(es=.25, power=.80, alpha=.05, two.tailed=TRUE,
          n, J, K0=10, tol=.10,
          rho2, rho3, p=.50, g3=0, r21=0, r22=0, r23=0)

mrss.mod331(es=.25, power=.80, alpha=.05, two.tailed=TRUE,
            rho2, rho3, omegam2, omegam3,
            r21=0, r2m3=0,
            p=.50, q=NULL, n, J, K0=10, tol=.10)

mrss.mod332(es=.25, power=.80, alpha=.05, two.tailed=TRUE,
            rho2, rho3, omegam3, r21=0, r22=0, r2m3=0,
            p=.50, q=NULL, n, J, K0=10, tol=.10)

mrss.mod333(es=.25, power=.80, alpha=.05, two.tailed=TRUE,
            rho2, rho3, r21=0, r22=0, r23=0,
            p=.50, q=NULL, n, J, K0=10, tol=.10)

mdes.bcra4f3(power=.80, alpha=.05, two.tailed=TRUE,
             rho2, rho3, p=.50, r21=0, r22=0, r23=0, g3=0,
             n, J, K, L)

power.bcra4f3(es=.25, alpha=.05, two.tailed=TRUE,
              rho2, rho3, p=.50, r21=0, r22=0, r23=0, g3=0,
              n, J, K, L)

mrss.bcra4f3(es=.25, power=.80, alpha=.05, two.tailed=TRUE,
             n, J, L, K0=10, tol=.10,
             rho2, rho3, p=.50, g3=0, r21=0, r22=0, r23=0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cra3_+3A_power">power</code></td>
<td>
<p>statistical power <code class="reqn">(1-\beta)</code>.</p>
</td></tr>
<tr><td><code id="cra3_+3A_es">es</code>, <code id="cra3_+3A_esa">esa</code>, <code id="cra3_+3A_esb">esB</code></td>
<td>
<p>effect size for main/moderator effects, or for path coefficients a (treatment - mediator), or B (overall mediator - outcome) in the mediation model.</p>
</td></tr>
<tr><td><code id="cra3_+3A_alpha">alpha</code></td>
<td>
<p>probability of type I error.</p>
</td></tr>
<tr><td><code id="cra3_+3A_two.tailed">two.tailed</code></td>
<td>
<p>logical; <code>TRUE</code> for two-tailed hypothesis testing, <code>FALSE</code> for one-tailed hypothesis testing. </p>
</td></tr>
<tr><td><code id="cra3_+3A_rho2">rho2</code></td>
<td>
<p>proportion of variance in the outcome between level 2 units (unconditional ICC2).</p>
</td></tr>
<tr><td><code id="cra3_+3A_rho3">rho3</code></td>
<td>
<p>proportion of variance in the outcome between level 3 units (unconditional ICC3).</p>
</td></tr>
<tr><td><code id="cra3_+3A_rhom2">rhom2</code></td>
<td>
<p>proportion of variance in the mediator between level 2 units.</p>
</td></tr>
<tr><td><code id="cra3_+3A_rhom3">rhom3</code></td>
<td>
<p>proportion of variance in the mediator between level 3 units.</p>
</td></tr>
<tr><td><code id="cra3_+3A_omegam2">omegam2</code></td>
<td>
<p>ratio of the unconditional variance in the moderator effect that is between level 2 units to the residual variance between level 2 units in the null model.</p>
</td></tr>
<tr><td><code id="cra3_+3A_omegam3">omegam3</code></td>
<td>
<p>ratio of the unconditional variance in the moderator effect that is between level 3 units to the residual variance between level 3 units in the null model.</p>
</td></tr>
<tr><td><code id="cra3_+3A_p">p</code></td>
<td>
<p>proportion of level 3 units randomly assigned to treatment.</p>
</td></tr>
<tr><td><code id="cra3_+3A_q">q</code></td>
<td>
<p>proportion of level 1, level 2, or level 3 units in the moderator subgroup.</p>
</td></tr>
<tr><td><code id="cra3_+3A_g3">g3</code></td>
<td>
<p>number of covariates at level 3.</p>
</td></tr>
<tr><td><code id="cra3_+3A_gm3">gm3</code></td>
<td>
<p>number of covariates at level 3 for the mediation model.</p>
</td></tr>
<tr><td><code id="cra3_+3A_r21">r21</code></td>
<td>
<p>proportion of level 1 variance in the outcome explained by level 1 covariates.</p>
</td></tr>
<tr><td><code id="cra3_+3A_r22">r22</code></td>
<td>
<p>proportion of level 2 variance in the outcome explained by level 2 covariates.</p>
</td></tr>
<tr><td><code id="cra3_+3A_r23">r23</code></td>
<td>
<p>proportion of level 3 variance in the outcome explained by level 3 covariates.</p>
</td></tr>
<tr><td><code id="cra3_+3A_r2m1">r2m1</code></td>
<td>
<p>proportion of mediator variance at level 1 explained by level 1 predictors.</p>
</td></tr>
<tr><td><code id="cra3_+3A_r2m2">r2m2</code></td>
<td>
<p>proportion of variance in the mediator explained by level 2 predictors.</p>
</td></tr>
<tr><td><code id="cra3_+3A_r2m3">r2m3</code></td>
<td>
<p>proportion of variance in the moderator effect that is explained by level 3 predictors. For the mediation model, proportion of variance in the mediator explained by level 3 predictors.</p>
</td></tr>
<tr><td><code id="cra3_+3A_n">n</code></td>
<td>
<p>harmonic mean of level 1 units across level 2 units (or simple average).</p>
</td></tr>
<tr><td><code id="cra3_+3A_j">J</code></td>
<td>
<p>harmonic mean of level 2 units across level 3 units (or simple average).</p>
</td></tr>
<tr><td><code id="cra3_+3A_k">K</code></td>
<td>
<p>level 3 sample size.</p>
</td></tr>
<tr><td><code id="cra3_+3A_l">L</code></td>
<td>
<p>level 4 sample size (blocks).</p>
</td></tr>
<tr><td><code id="cra3_+3A_k0">K0</code></td>
<td>
<p>starting value for <code>K</code>.</p>
</td></tr>
<tr><td><code id="cra3_+3A_tol">tol</code></td>
<td>
<p>tolerance to end iterative process for finding <code>K</code>.</p>
</td></tr>
<tr><td><code id="cra3_+3A_mc">mc</code></td>
<td>
<p>logical; <code>TRUE</code> for monte carlo simulation based power.</p>
</td></tr>
<tr><td><code id="cra3_+3A_nsims">nsims</code></td>
<td>
<p>number of replications, if <code>mc = TRUE</code>.</p>
</td></tr>
<tr><td><code id="cra3_+3A_ndraws">ndraws</code></td>
<td>
<p>number of draws from the distribution of the path coefficients for each replication, if <code>mc = TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>fun</code></td>
<td>
<p>function name.</p>
</td></tr>
<tr><td><code>parms</code></td>
<td>
<p>list of parameters used in power calculation.</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>degrees of freedom.</p>
</td></tr>
<tr><td><code>ncp</code></td>
<td>
<p>noncentrality parameter.</p>
</td></tr>
<tr><td><code>power</code></td>
<td>
<p>statistical power <code class="reqn">(1-\beta)</code>.</p>
</td></tr>
<tr><td><code>mdes</code></td>
<td>
<p>minimum detectable effect size.</p>
</td></tr>
<tr><td><code>K</code></td>
<td>
<p>number of level 3 units.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Spybrook, J., Kelcey, B., \&amp; Dong, N. (2016). Power for detecting treatment by moderator effects in two-and three-level cluster randomized trials. <em>Journal of Educational and Behavioral Statistics</em>, <em>41</em>(6), 605-627. doi: <a href="https://doi.org/10.3102/1076998616655442">10.3102/1076998616655442</a>
</p>
<p>Dong, N., Kelcey, B., \&amp; Spybrook, J. (2018). Power analyses for moderator effects in three-level cluster randomized trials. <em>The Journal of Experimental Education</em>, <em>86</em>(3), 489-514. doi: <a href="https://doi.org/10.1080/00220973.2017.1315714">10.1080/00220973.2017.1315714</a>
</p>
<p>Dong, N., \&amp; Maynard, R. (2013). PowerUp!: A tool for calculating minimum detectable effect sizes and minimum required sample sizes for experimental and quasi-experimental design studies. <em>Journal of Research on Educational Effectiveness</em>, <em>6</em>(1), 24-67. doi: <a href="https://doi.org/10.1080/19345747.2012.673143">10.1080/19345747.2012.673143</a>
</p>
<p>Kelcey, B., Xie, Y., Spybrook, J., \&amp; Dong, N. (2020). Power and sample size determination for multilevel mediation in three-Level cluster-randomized trials. <em>Multivariate Behavioral Research</em>. Advance online publication. doi: <a href="https://doi.org/10.1080/00273171.2020.1738910">10.1080/00273171.2020.1738910</a>
</p>
<p>Kelcey, B., Spybrook, J., Dong, N., \&amp; Bai, F. (2020). Cross-level mediation in school-randomized studies of teacher development: Experimental design and power.  <em>Journal of Research on Educational Effectiveness</em>. Advance online publication. doi: <a href="https://doi.org/10.1080/19345747.2020.1726540">10.1080/19345747.2020.1726540</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># cross-checks for the main effect
mdes.cra3(rho3=.06, rho2=.17, n=15, J=3, K=60)
power.cra3(es=.269, rho3=.06, rho2=.17, n=15, J=3, K=60)
mrss.cra3(es=.269, rho3=.06, rho2=.17, n=15, J=3)

# cross-checks for the randomly varying cont. L1 moderator effect
mdesd.mod331(power=.80, alpha=.05, two.tailed=TRUE,
            rho2=.17, rho3=.06, omegam2=.10, omegam3=.10,
            q=NULL, n=15, J=3, K=60)
power.mod331(es=0.1248, alpha=.05, two.tailed=TRUE,
            rho2=.17, rho3=.06, omegam2=.10, omegam3=.10,
            q=NULL, n=15, J=3, K=60)
mrss.mod331(es=0.1248, alpha=.05, two.tailed=TRUE,
            rho2=.17, rho3=.06, omegam2=.10, omegam3=.10,
            q=NULL, n=15, J=3)

# cross-checks for the non-randomly varying cont. L1 moderator effect
mdesd.mod331(power=.80, alpha=.05, two.tailed=TRUE,
            rho2=.17, rho3=.06, omegam2=0, omegam3=0,
            q=NULL, n=15, J=3, K=60)
power.mod331(es=.0946, alpha=.05, two.tailed=TRUE,
            rho2=.17, rho3=.06, omegam2=0, omegam3=0,
            q=NULL, n=15, J=3, K=60)
mrss.mod331(es=.0946, alpha=.05, two.tailed=TRUE,
            rho2=.17, rho3=.06, omegam2=0, omegam3=0,
            q=NULL, n=15, J=3)

# cross-checks for the randomly varying bin. L1 moderator effect
mdesd.mod331(power=.80, alpha=.05, two.tailed=TRUE,
            rho2=.17, rho3=.06, omegam2=.10, omegam3=.10,
            q=.50, n=15, J=3, K=60)
power.mod331(es=.2082, alpha=.05, two.tailed=TRUE,
            rho2=.17, rho3=.06, omegam2=.10, omegam3=.10,
            q=.50, n=15, J=3, K=60)
mrss.mod331(es=.2082, alpha=.05, two.tailed=TRUE,
            rho2=.17, rho3=.06, omegam2=.10, omegam3=.10,
            q=.50, n=15, J=3)

# cross-checks for the non-randomly varying bin. L1 moderator effect
mdesd.mod331(power=.80, alpha=.05, two.tailed=TRUE,
            rho2=.17, rho3=.06, omegam2=0, omegam3=0,
            q=.50, n=15, J=3, K=60)
power.mod331(es=.1893, alpha=.05, two.tailed=TRUE,
            rho2=.17, rho3=.06, omegam2=0, omegam3=0,
            q=.50, n=15, J=3, K=60)
mrss.mod331(es=.1893, alpha=.05, two.tailed=TRUE,
            rho2=.17, rho3=.06, omegam2=0, omegam3=0,
            q=.50, n=15, J=3)

# cross-checks for the randomly varying bin. L2 moderator effect
mdesd.mod332(rho3=.1, rho2=.1, omegam3=.05,
             q=.5, r21=.30, r22=.4, r2m3=0, n=20, J=4, K=60)
power.mod332(es=.2244, rho3=.1, rho2=.1, omegam3=.05,
             q=.5, r21=.30, r22=.4, r2m3=0, n=20, J=4, K=60)
mrss.mod332(es=.2244, rho3=.1, rho2=.1, omegam3=.05,
            q=.5, r21=.30, r22=.4, r2m3=0, n=20, J=4)

# cross-checks for the randomly varying cont. L2 moderator effect
mdesd.mod332(rho3=.1, rho2=.1, omegam3=.05,
            r21=.30, r22=.4, r2m3=0, n=20, J=4, K=60)
power.mod332(es=.1209, rho3=.1, rho2=.1, omegam3=.05,
            r21=.30, r22=.4, r2m3=0, n=20, J=4, K=60)
mrss.mod332(es=.1209, rho3=.1, rho2=.1, omegam3=.05,
            r21=.30, r22=.4, r2m3=0, n=20, J=4)

# cross-checks for the non-randomly varying bin. L2 moderator effect
mdesd.mod332(rho3=.1, rho2=.1, omegam3=0,
            q=.5, r21=.30, r22=.4, r2m3=0, n=20, J=4, K=60)
power.mod332(es=.2157, rho3=.1, rho2=.1, omegam3=0,
            q=.5, r21=.30, r22=.4, r2m3=0, n=20, J=4, K=60)
mrss.mod332(es=.2157, rho3=.1, rho2=.1, omegam3=0,
            q=.5, r21=.30, r22=.4, r2m3=0, n=20, J=4, K=60)

# cross-checks for the non-randomly varying cont. L2 moderator effect
mdesd.mod332(rho3=.1, rho2=.1, omegam3=0,
            r21=.30, r22=.4, r2m3=0, n=20, J=4, K=60)
power.mod332(es=.1079, rho3=.1, rho2=.1, omegam3=0,
             r21=.30, r22=.4, r2m3=0, n=20, J=4, K=60)
mrss.mod332(es=.1079, rho3=.1, rho2=.1, omegam3=0,
             r21=.30, r22=.4, r2m3=0, n=20, J=4, K=60)

# cross-checks for the randomly varying bin. L3 moderator effect
mdesd.mod333(rho3=.1, rho2=.1, q=.5,
            r21=.3, r22=.4, r23=.5, n=20, J=4, K=60)
power.mod333(es=.4128, rho3=.1, rho2=.1, q=.5,
             r21=.3, r22=.4, r23=.5, n=20, J=4, K=60)
mrss.mod333(es=.4128, rho3=.1, rho2=.1, q=.5,
             r21=.3, r22=.4, r23=.5, n=20, J=4, K=60)

# cross-checks for the randomly varying cont. L3 moderator effect
mdesd.mod333(rho3=.1, rho2=.1,
             r21=.3, r22=.4, r23=.5, n=20, J=4, K=60)
power.mod333(es=.2064, rho3=.1, rho2=.1,
             r21=.3, r22=.4, r23=.5, n=20, J=4, K=60)
mrss.mod333(es=.2064, rho3=.1, rho2=.1,
             r21=.3, r22=.4, r23=.5, n=20, J=4, K=60)

# 3-3-1 mediation
power.med331(esa= .50, esB = .30, rho2 = .15, rho3 = .15,
             r21 = .20, r22 = .20, g3 = 4,
             n = 20, J = 4, K = 80, p = .5)

# 3-2-1 mediation
power.med321(esa= .51, esB = .30, rhom3 = 0.27, rho2 = .15, rho3 = .19,
             r2m2 = .07, gm3 = 4, r2m3 = .16,
             r21 = .02, r22 = .41, g3 = 5, r23 = .38,
             p = .50, n = 20, J = 4, K = 60)

# 3-1-1 mediation
power.med311(esa= .49 , esB = .30,
             rhom2 = .05, rhom3 = .26, rho2 = .15, rho3 = .20,
             r2m1 = .10, r2m2 = .07, r2m3 = .17,
             r21 = .02, r22 = .41, r23 = .38,
             p = .50, n = 20, J = 4, K = 30)

# cross-checks for cluster-randomized block design
# treatment at level 3, with fixed effects across level 4 blocks
mdes.bcra4f3(rho3=.15, rho2=.15,
             n=10, J=4, K=23, L=15)
power.bcra4f3(es=0.137, rho3=.15, rho2=.15,
              n=10, J=4, K=33, L=15)
mrss.bcra4f3(es=0.137, rho3=.15, rho2=.15,
             n=10, J=4, L=15)
</code></pre>

<hr>
<h2 id='cra4'>Four-Level Cluster-randomized Trial</h2><span id='topic+cra4'></span><span id='topic+cra4r4'></span><span id='topic+mdes.cra4'></span><span id='topic+power.cra4'></span><span id='topic+mrss.cra4'></span><span id='topic+mdes.cra4r4'></span><span id='topic+power.cra4r4'></span><span id='topic+mrss.cra4r4'></span>

<h3>Description</h3>

<p>For main treatment effects, use <code>mdes.cra4()</code> calculate the minimum detectable effect size, <code>power.cra4()</code> to calculate the statistical power, and <code>mrss.cra4()</code> to calculate the minimum required sample size.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mdes.cra4(power=.80, alpha=.05, two.tailed=TRUE,
          rho2, rho3, rho4, p=.50, r21=0, r22=0, r23=0, r24=0, g4=0,
          n, J, K, L)

power.cra4(es=.25, alpha=.05, two.tailed=TRUE,
           rho2, rho3, rho4, p=.50, r21=0, r22=0, r23=0, r24=0, g4=0,
           n, J, K, L)

mrss.cra4(es=.25, power=.80, alpha=.05, two.tailed=TRUE,
          n, J, K, L0=10, tol=.10,
          rho2, rho3, rho4, p=.50,
          r21=0, r22=0, r23=0, r24=0, g4=0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cra4_+3A_power">power</code></td>
<td>
<p>statistical power <code class="reqn">(1-\beta)</code>.</p>
</td></tr>
<tr><td><code id="cra4_+3A_es">es</code></td>
<td>
<p>effect size.</p>
</td></tr>
<tr><td><code id="cra4_+3A_alpha">alpha</code></td>
<td>
<p>probability of type I error.</p>
</td></tr>
<tr><td><code id="cra4_+3A_two.tailed">two.tailed</code></td>
<td>
<p>logical; <code>TRUE</code> for two-tailed hypothesis testing, <code>FALSE</code> for one-tailed hypothesis testing. </p>
</td></tr>
<tr><td><code id="cra4_+3A_rho2">rho2</code></td>
<td>
<p>proportion of variance in the outcome between level 2 units (unconditional ICC2).</p>
</td></tr>
<tr><td><code id="cra4_+3A_rho3">rho3</code></td>
<td>
<p>proportion of variance in the outcome between level 3 units (unconditional ICC3).</p>
</td></tr>
<tr><td><code id="cra4_+3A_rho4">rho4</code></td>
<td>
<p>proportion of variance in the outcome between level 4 units (unconditional ICC4).</p>
</td></tr>
<tr><td><code id="cra4_+3A_p">p</code></td>
<td>
<p>proportion of level 4 units randomly assigned to treatment.</p>
</td></tr>
<tr><td><code id="cra4_+3A_g4">g4</code></td>
<td>
<p>number of covariates at level 4.</p>
</td></tr>
<tr><td><code id="cra4_+3A_r21">r21</code></td>
<td>
<p>proportion of level 1 variance in the outcome explained by level 1 covariates.</p>
</td></tr>
<tr><td><code id="cra4_+3A_r22">r22</code></td>
<td>
<p>proportion of level 2 variance in the outcome explained by level 2 covariates.</p>
</td></tr>
<tr><td><code id="cra4_+3A_r23">r23</code></td>
<td>
<p>proportion of level 3 variance in the outcome explained by level 3 covariates.</p>
</td></tr>
<tr><td><code id="cra4_+3A_r24">r24</code></td>
<td>
<p>proportion of level 4 variance in the outcome explained by level 4 covariates.</p>
</td></tr>
<tr><td><code id="cra4_+3A_n">n</code></td>
<td>
<p>harmonic mean of level 1 units across level 2 units (or simple average).</p>
</td></tr>
<tr><td><code id="cra4_+3A_j">J</code></td>
<td>
<p>harmonic mean of level 2 units across level 3 units (or simple average).</p>
</td></tr>
<tr><td><code id="cra4_+3A_k">K</code></td>
<td>
<p>harmonic mean of level 3 units across level 4 units (or simple average).</p>
</td></tr>
<tr><td><code id="cra4_+3A_l">L</code></td>
<td>
<p>number of level 4 units.</p>
</td></tr>
<tr><td><code id="cra4_+3A_l0">L0</code></td>
<td>
<p>starting value for <code>L</code>.</p>
</td></tr>
<tr><td><code id="cra4_+3A_tol">tol</code></td>
<td>
<p>tolerance to end iterative process for finding <code>L</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>fun</code></td>
<td>
<p>function name.</p>
</td></tr>
<tr><td><code>parms</code></td>
<td>
<p>list of parameters used in power calculation.</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>degrees of freedom.</p>
</td></tr>
<tr><td><code>ncp</code></td>
<td>
<p>noncentrality parameter.</p>
</td></tr>
<tr><td><code>power</code></td>
<td>
<p>statistical power <code class="reqn">(1-\beta)</code>.</p>
</td></tr>
<tr><td><code>mdes</code></td>
<td>
<p>minimum detectable effect size.</p>
</td></tr>
<tr><td><code>L</code></td>
<td>
<p>number of level 4 units.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># cross-checks
mdes.cra4(rho4=.05, rho3=.05, rho2=.10,
          n=10, J=2, K=3, L=20)
power.cra4(es = .412, rho4=.05, rho3=.05, rho2=.10,
           n=10, J=2, K=3, L=20)
mrss.cra4(es = .412, rho4=.05, rho3=.05, rho2=.10,
          n=10, J=2, K=3)
</code></pre>

<hr>
<h2 id='ira'>Individual-level Random Assignment Designs</h2><span id='topic+ira'></span><span id='topic+ira_pn'></span><span id='topic+ira1r1'></span><span id='topic+bira2f1'></span><span id='topic+bira2c1'></span><span id='topic+mdes.ira'></span><span id='topic+power.ira'></span><span id='topic+mrss.ira'></span><span id='topic+mdes.ira1r1'></span><span id='topic+power.ira1r1'></span><span id='topic+mrss.ira1r1'></span><span id='topic+mdes.bira2f1'></span><span id='topic+power.bira2f1'></span><span id='topic+mrss.bira2f1'></span><span id='topic+mdes.bira2c1'></span><span id='topic+power.bira2c1'></span><span id='topic+mrss.bira2c1'></span><span id='topic+mdes.ira_pn'></span><span id='topic+power.ira_pn'></span><span id='topic+mrss.ira_pn'></span>

<h3>Description</h3>

<p>For an individual-level random assignment design (simple randomized controlled trial) use <code>mdes.ira()</code> to calculate the minimum detectable effect size, <code>power.ira()</code> to calculate the statistical power, and <code>mrss.ira()</code> to calculate the minimum required sample size (number of subjects).
</p>
<p>If fixed block effects exist (randomized block designs), that is, treatment effect varies from one block to another but it is not random, use <code>mdes.bira2f1()</code> to calculate the minimum detectable effect size, <code>power.bira2f1()</code> to calculate the statistical power, and <code>mrss.bira2f1()</code> to calculate the minimum required sample size (number of subjects per block).
</p>
<p>If block effect is constant, that is, treatment effect does not change from one block to another, use <code>mdes.bira2c1()</code> to calculate the minimum detectable effect size, <code>power.bira2c1()</code> to calculate the statistical power, and <code>mrss.bira2c1()</code> to calculate the minimum required sample size (number of subjects per block).
</p>
<p>For partially nested individual-level random assignment designs (simple randomized controlled trial with intervention clusters) use <code>mdes.ira_pn()</code> to calculate the minimum detectable effect size, <code>power.ira_pn()</code> to calculate the statistical power, and <code>mrss.ira_pn()</code> to calculate the minimum required sample size (number of subjects).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mdes.ira(power=.80, alpha=.05, two.tailed=TRUE,
         p=.50, g1=0, r21=0, n)

power.ira(es=.25, alpha=.05, two.tailed=TRUE,
          p=.50, g1=0, r21=0, n)

mrss.ira(es=.25, power=.80, alpha=.05, two.tailed=TRUE,
         n0=10, tol=.10,
         p=.50, g1=0, r21=0)

mdes.bira2f1(power=.80, alpha=.05, two.tailed=TRUE,
             p=.50, g1=0, r21=0, n, J)

power.bira2f1(es=.25, alpha=.05, two.tailed=TRUE,
              p=.50, g1=0, r21=0, n, J)

mrss.bira2f1(es=.25, power=.80, alpha=.05, two.tailed=TRUE,
             J, n0=10, tol=.10,
             p=.50, g1=0, r21=0)

mdes.bira2c1(power=.80, alpha=.05, two.tailed=TRUE,
             p=.50, g1=0, r21=0,
             n, J)

power.bira2c1(es=.25, alpha=.05, two.tailed=TRUE,
              p=.50, g1=0, r21=0,
              n, J)

mrss.bira2c1(es=.25, power=.80, alpha=.05, two.tailed=TRUE,
             J, n0=10, tol=.10,
             p=.50, g1=0, r21=0)

mdes.ira_pn(power=.80, alpha=.05, two.tailed=TRUE,
            df=NULL, ratio_tc_var=1,
            rho_ic=.20, p=.50, r21=0, n, ic_size=1)

power.ira_pn(es=.25,alpha=.05, two.tailed=TRUE,
             df=NULL, ratio_tc_var=1,
             rho_ic=.20, p=.50, r21=0, n, ic_size=1)

mrss.ira_pn(es=.25, power=.80, alpha=.05, two.tailed=TRUE,
            ratio_tc_var=1, z.test=FALSE,
            rho_ic=.20, p=.50, r21=0, ic_size=1, n0=500, tol=.10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ira_+3A_power">power</code></td>
<td>
<p>statistical power <code class="reqn">(1-\beta)</code>.</p>
</td></tr>
<tr><td><code id="ira_+3A_es">es</code></td>
<td>
<p>effect size.</p>
</td></tr>
<tr><td><code id="ira_+3A_alpha">alpha</code></td>
<td>
<p>probability of type I error.</p>
</td></tr>
<tr><td><code id="ira_+3A_two.tailed">two.tailed</code></td>
<td>
<p>logical; <code>TRUE</code> for two-tailed hypothesis testing, <code>FALSE</code> for one-tailed hypothesis testing.</p>
</td></tr>
<tr><td><code id="ira_+3A_df">df</code></td>
<td>
<p>degrees of freedom.</p>
</td></tr>
<tr><td><code id="ira_+3A_ratio_tc_var">ratio_tc_var</code></td>
<td>
<p>ratio of the treatment group variance to the control group variance (needed for Satterthwaite approximation to df). Ignored when <code>df</code> argument is specified.</p>
</td></tr>
<tr><td><code id="ira_+3A_rho_ic">rho_ic</code></td>
<td>
<p>proportion of variance in the outcome (for treatment group) that is between intervention clusters.</p>
</td></tr>
<tr><td><code id="ira_+3A_p">p</code></td>
<td>
<p>proportion of units randomly assigned to the treatment condition.</p>
</td></tr>
<tr><td><code id="ira_+3A_g1">g1</code></td>
<td>
<p>number of covariates. <code>g</code> also works.</p>
</td></tr>
<tr><td><code id="ira_+3A_r21">r21</code></td>
<td>
<p>proportion of variance in the outcome explained by covariates (and fixed blocks if exists). <code>r2</code> also works.</p>
</td></tr>
<tr><td><code id="ira_+3A_n">n</code></td>
<td>
<p>sample size (number of subjects per block, if exist, calculated using simple average or harmonic mean). For partially nested design <code>n</code> is total number of subjects (in all intervention clusters and control group).</p>
</td></tr>
<tr><td><code id="ira_+3A_j">J</code></td>
<td>
<p>level 2 sample size (number of blocks).</p>
</td></tr>
<tr><td><code id="ira_+3A_ic_size">ic_size</code></td>
<td>
<p>sample size in each intervention cluster on average.</p>
</td></tr>
<tr><td><code id="ira_+3A_n0">n0</code></td>
<td>
<p>starting value for <code>n</code>.</p>
</td></tr>
<tr><td><code id="ira_+3A_tol">tol</code></td>
<td>
<p>tolerance to end iterative process for finding <code>n</code> or <code>J.</code></p>
</td></tr>
<tr><td><code id="ira_+3A_z.test">z.test</code></td>
<td>
<p>logical; <code>TRUE</code> for z-test.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>fun</code></td>
<td>
<p>function name.</p>
</td></tr>
<tr><td><code>parms</code></td>
<td>
<p>list of parameters used in power calculation.</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>degrees of freedom.</p>
</td></tr>
<tr><td><code>ncp</code></td>
<td>
<p>noncentrality parameter.</p>
</td></tr>
<tr><td><code>power</code></td>
<td>
<p>statistical power <code class="reqn">(1-\beta)</code>.</p>
</td></tr>
<tr><td><code>mdes</code></td>
<td>
<p>minimum detectable effect size.</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>sample size (number of subjects).</p>
</td></tr>
</table>


<h3>References</h3>

<p>Dong, N., &amp; Maynard, R. (2013). PowerUp!: A tool for calculating minimum detectable effect sizes and minimum required sample sizes for experimental and quasi-experimental design studies. <em>Journal of Research on Educational Effectiveness</em>, <em>6</em>(1), 24-67. doi: <a href="https://doi.org/10.1080/19345747.2012.673143">10.1080/19345747.2012.673143</a>
</p>
<p>Lohr, S., Schochet, P. Z., &amp; Sanders, E. (2014). Partially Nested Randomized Controlled Trials in Education Research: A Guide to Design and Analysis. NCER 2014-2000. National Center for Education Research. <a href="https://ies.ed.gov/ncer/pubs/20142000/pdf/20142000.pdf">https://ies.ed.gov/ncer/pubs/20142000/pdf/20142000.pdf</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># cross-checks
mdes.ira(n=250)
power.ira(es=.356, n=250)
mrss.ira(es=.356)

# cross-checks
mdes.bira2c1(n=15, J=20)
power.bira2c1(es=.325, n=15, J=20)
mrss.bira2c1(es=.325, J=20)

# cross-checks
mdes.bira2f1(n=15, J=20)
power.bira2f1(es=.325, n=15, J=20)
mrss.bira2f1(es=.325, J=20)

# cross-checks
mdes.ira_pn(n=250)
power.ira_pn(es=.377, n=250)
mrss.ira_pn(es=.377, n=250)
</code></pre>

<hr>
<h2 id='med_pn'>Partially Nested Designs Probing Multilevel Mediation</h2><span id='topic+med_pn'></span><span id='topic+med_pn21'></span><span id='topic+med_pn31'></span><span id='topic+med_pn32'></span><span id='topic+power.med_pn21'></span><span id='topic+power.med_pn31'></span><span id='topic+power.med_pn32'></span>

<h3>Description</h3>

<p>Two/One partially nested design occurs when subjects are recruited into groups for the treatment condition, but the remaining participants (or waiting list) are left for the control group (without any intervention clusters). If the interest is to design a sufficiently powered study to detect mediation effect in Two/One design, use <code>power.med_pn21()</code>.
</p>
<p>Three/One partially nested design occurs when subjects are recruited into groups, and a number of groups are guided by the same leader for the treatment condition, but the remaining participants (or waiting list) are left for the control group (without any intervention clusters). If the interest is to design a sufficiently powered study to detect mediation effect in Three/One design, use <code>power.med_pn31()</code>.
</p>
<p>Three/Two partially nested design occurs when subjects are recruited into groups, and a number of groups are guided by the same leader for the treatment condition, however, separate from Two/One and Three/One designs, the remaining participants are nested within providers in the control group (without any intervention clusters, but with nested structure). If the interest is to design a sufficiently powered study to detect mediation effect in Three/Two design, use <code>power.med_pn31()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>power.med_pn21(esa = .50, esB = .50, esb1 = .10,
               two.tailed = TRUE, alpha = .05,
               mc = TRUE, nsims = 1000, ndraws = 1000,
               rhom_trt = .20, rho_trt = .20,
               r2m1_ctrl = .20, r2m1_trt = .20, r2m2_trt = .20,
               r2y1z_trt = 0, r2y2z_trt = 0,
               r2y1_trt = NULL, r2y2_trt = NULL,
               g1_ctrl = 0, n_ctrl =  20,
               g2_trt = 0, n_trt = 30, J_trt = 20)

power.med_pn31(esa = .50, esB = .50, esb1 = .10,  esb2 = .10,
               two.tailed = TRUE, alpha = .05,
               mc = TRUE, nsims = 1000, ndraws = 1000,
               rhom3_trt = .20, rhom2_trt = .20,
               rho3_trt = .20, rho2_trt = .20,
               r2m1_ctrl = .20, r2m1_trt = .20, r2m2_trt = .20, r2m3_trt = .20,
               r2y1z_trt = 0, r2y2z_trt = 0, r2y3z_trt = 0,
               r2y1_trt = NULL, r2y2_trt = NULL, r2y3_trt = NULL,
               g1_ctrl = 0, n_ctrl =  20,
               g3_trt = 0, n_trt = 30, J_trt = 20, K_trt = 20)

power.med_pn32(esa = .50, esB = .50, esb1 = .10,  esb2 = .10,
               two.tailed = TRUE, alpha = .05,
               mc = TRUE, nsims = 1000, ndraws = 1000,
               rhom2_ctrl = .20, rhom3_trt = .20, rhom2_trt = .20,
               rho3_trt = .20, rho2_trt = .20,
               r2m1_ctrl = .20, r2m2_ctrl = .20,
               r2m1_trt = .20, r2m2_trt = .20, r2m3_trt = .20,
               r2y1z_trt = 0, r2y2z_trt = 0, r2y3z_trt = 0,
               r2y1_trt = NULL, r2y2_trt = NULL, r2y3_trt = NULL,
               g2_ctrl = 0, n_ctrl = 30, J_ctrl = 20,
               g3_trt = 0, n_trt =  20, J_trt = 20,  K_trt = 20)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="med_pn_+3A_esa">esa</code></td>
<td>
<p>Standardized mean difference in mediator values between treatment and control groups (esa = esa_trt - esa_ctrl).</p>
</td></tr>
<tr><td><code id="med_pn_+3A_esb">esB</code></td>
<td>
<p>Standardized regression coefficient for mediator - outcome path, capturing level 1 and level 2 (between intervention clusters) effects (esB = esb1 + esb2 for Two/One design, or esB = esb1 + esb2 + esb3 for Three/One or Three/Two designs).</p>
</td></tr>
<tr><td><code id="med_pn_+3A_esb1">esb1</code></td>
<td>
<p>Standardized regression coefficient for mediator - outcome path at level 1 in the treatment group (within first intervention clusters).</p>
</td></tr>
<tr><td><code id="med_pn_+3A_esb2">esb2</code></td>
<td>
<p>Standardized regression coefficient for aggregate mediator - outcome path at level 2 in the treatment group (between first intervention clusters).</p>
</td></tr>
<tr><td><code id="med_pn_+3A_alpha">alpha</code></td>
<td>
<p>probability of type I error.</p>
</td></tr>
<tr><td><code id="med_pn_+3A_two.tailed">two.tailed</code></td>
<td>
<p>logical; <code>TRUE</code> for two-tailed hypothesis testing, <code>FALSE</code> for one-tailed hypothesis testing.</p>
</td></tr>
<tr><td><code id="med_pn_+3A_rhom2_ctrl">rhom2_ctrl</code></td>
<td>
<p>Proportion of unconditional mediator variance between level 2 units (intervention clusters) in the control group.</p>
</td></tr>
<tr><td><code id="med_pn_+3A_rhom3_trt">rhom3_trt</code></td>
<td>
<p>Proportion of unconditional mediator variance between level 3 units (second intervention clusters) in the treatment group.</p>
</td></tr>
<tr><td><code id="med_pn_+3A_rhom2_trt">rhom2_trt</code></td>
<td>
<p>Proportion of unconditional mediator variance between level 2 units (first intervention clusters) in the treatment group.</p>
</td></tr>
<tr><td><code id="med_pn_+3A_rhom_trt">rhom_trt</code></td>
<td>
<p>Proportion of unconditional mediator variance between level 2 units (intervention clusters) in the treatment group.</p>
</td></tr>
<tr><td><code id="med_pn_+3A_rho3_trt">rho3_trt</code></td>
<td>
<p>Proportion of unconditional outcome variance between level 3 units (second intervention clusters) in the treatment group.</p>
</td></tr>
<tr><td><code id="med_pn_+3A_rho2_trt">rho2_trt</code></td>
<td>
<p>Proportion of unconditional outcome variance between level 2 units (first intervention clusters) in the treatment group.</p>
</td></tr>
<tr><td><code id="med_pn_+3A_rho_trt">rho_trt</code></td>
<td>
<p>Proportion of unconditional outcome variance between level 2 units (intervention clusters) in the control group.</p>
</td></tr>
<tr><td><code id="med_pn_+3A_r2m1_ctrl">r2m1_ctrl</code></td>
<td>
<p>Proportion of variance in the mediator explained by level 1 covariates in the control group.</p>
</td></tr>
<tr><td><code id="med_pn_+3A_r2m2_ctrl">r2m2_ctrl</code></td>
<td>
<p>Proportion of variance in the aggregate mediator explained by level 2 covariates in the control group.</p>
</td></tr>
<tr><td><code id="med_pn_+3A_r2m1_trt">r2m1_trt</code></td>
<td>
<p>Proportion of variance in the level 1 mediator explained by level 1 covariates in the treatment group</p>
</td></tr>
<tr><td><code id="med_pn_+3A_r2m2_trt">r2m2_trt</code></td>
<td>
<p>Proportion of variance in the aggregate mediator (at level 2) explained by level 2 covariates in the treatment group.</p>
</td></tr>
<tr><td><code id="med_pn_+3A_r2m3_trt">r2m3_trt</code></td>
<td>
<p>Proportion of variance in the aggregate mediator (at level 3) explained by level 3 covariates in the treatment group.</p>
</td></tr>
<tr><td><code id="med_pn_+3A_r2y1z_trt">r2y1z_trt</code></td>
<td>
<p>Proportion of variance in the level 1 outcome explained by level 1 covariates in the treatment group.</p>
</td></tr>
<tr><td><code id="med_pn_+3A_r2y2z_trt">r2y2z_trt</code></td>
<td>
<p>Proportion of variance in the aggregate outcome (at level 2) explained by level 2 covariates in the treatment group.</p>
</td></tr>
<tr><td><code id="med_pn_+3A_r2y3z_trt">r2y3z_trt</code></td>
<td>
<p>Proportion of variance in the aggregate outcome (at level 3) explained by level 3 covariates in the treatment group.</p>
</td></tr>
<tr><td><code id="med_pn_+3A_r2y1_trt">r2y1_trt</code></td>
<td>
<p>Proportion of variance in the level 1 outcome explained by level 1 predictors (including mediator) in the treatment group.</p>
</td></tr>
<tr><td><code id="med_pn_+3A_r2y2_trt">r2y2_trt</code></td>
<td>
<p>Proportion of variance in the aggregate outcome (level 2) explained by level 2 predictors (including aggregate mediator) in the treatment group.</p>
</td></tr>
<tr><td><code id="med_pn_+3A_r2y3_trt">r2y3_trt</code></td>
<td>
<p>Proportion of variance in the aggregate outcome (level 3) explained by level 3 predictors (including aggregate mediator) in the treatment group.</p>
</td></tr>
<tr><td><code id="med_pn_+3A_g1_ctrl">g1_ctrl</code></td>
<td>
<p>Number of covariates introduced at level 1 in the control group.</p>
</td></tr>
<tr><td><code id="med_pn_+3A_g2_ctrl">g2_ctrl</code></td>
<td>
<p>Number of covariates introduced at level 2 (intervention clusters) in the control group.</p>
</td></tr>
<tr><td><code id="med_pn_+3A_n_ctrl">n_ctrl</code></td>
<td>
<p>Total number of subjects for two/one mediation. Number of subjects per level 2 unit (intervention cluster) in the control group for Three/One and Three/Two mediation.</p>
</td></tr>
<tr><td><code id="med_pn_+3A_j_ctrl">J_ctrl</code></td>
<td>
<p>Number of level 2 units (intervention clusters) in the control group.</p>
</td></tr>
<tr><td><code id="med_pn_+3A_g2_trt">g2_trt</code></td>
<td>
<p>Number of covariates introduced at level 2 (intervention clusters) in the treatment group.</p>
</td></tr>
<tr><td><code id="med_pn_+3A_g3_trt">g3_trt</code></td>
<td>
<p>Number of covariates introduced at level 3 (second intervention clusters) in the treatment group.</p>
</td></tr>
<tr><td><code id="med_pn_+3A_n_trt">n_trt</code></td>
<td>
<p>Number of subjects per level 2 unit (first intervention cluster).</p>
</td></tr>
<tr><td><code id="med_pn_+3A_j_trt">J_trt</code></td>
<td>
<p>Number of level 2 units per level 3 unit (second intervention cluster.)</p>
</td></tr>
<tr><td><code id="med_pn_+3A_k_trt">K_trt</code></td>
<td>
<p>Number of level 3 units (second intervention clusters).</p>
</td></tr>
<tr><td><code id="med_pn_+3A_mc">mc</code></td>
<td>
<p>logical; <code>TRUE</code> for monte carlo simulation based power.</p>
</td></tr>
<tr><td><code id="med_pn_+3A_nsims">nsims</code></td>
<td>
<p>number of replications, if <code>mc = TRUE</code>.</p>
</td></tr>
<tr><td><code id="med_pn_+3A_ndraws">ndraws</code></td>
<td>
<p>number of draws from the distribution of the path coefficients for each replication, if <code>mc = TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>fun</code></td>
<td>
<p>function name.</p>
</td></tr>
<tr><td><code>parms</code></td>
<td>
<p>list of parameters used in power calculation.</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>degrees of freedom.</p>
</td></tr>
<tr><td><code>ncp</code></td>
<td>
<p>noncentrality parameter.</p>
</td></tr>
<tr><td><code>power</code></td>
<td>
<p>statistical power <code class="reqn">(1-\beta)</code>.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Kelcey, B., Bai, F., \&amp; Xie, Y. (2020). Statistical power in partially nested designs probing multilevel mediation. <em>Psychotherapy Research</em>. Advance online publication. doi: <a href="https://doi.org/10.1080/10503307.2020.1717012">10.1080/10503307.2020.1717012</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Two/One partially nested design
power.med_pn21(esa = .40, esB = .40, esb1 = .40,
               two.tailed = TRUE, alpha = .05,
               rhom_trt = .20, rho_trt = .20,
               r2m1_ctrl = .60, r2m1_trt = .60, r2m2_trt = .60,
               r2y1_trt = .50, r2y2_trt = .50,
               n_ctrl = 50, n_trt =  6, J_trt = 50)

# Three/One partially nested design
power.med_pn31(esa = .50, esB = .50, esb1 = .10, esb2 = .10,
               rhom3_trt = .10, rhom2_trt = .20, rho3_trt = .10, rho2_trt = .20,
               r2m1_ctrl = .20, r2m1_trt = .20, r2m2_trt = .20, r2m3_trt = .20,
               r2y1_trt = .20, r2y2_trt = .20, r2y3_trt = .20,
               n_ctrl = 60, n_trt =  20, J_trt = 10, K_trt = 60)

# Three/Two partially nested design
power.med_pn32(esa = .50, esB = .50, esb1 = .10, esb2 = .10,
               rhom2_ctrl = .20, rhom3_trt = .10, rhom2_trt = .20,
               rho3_trt = .10, rho2_trt = .20,
               r2m1_ctrl = .20, r2m2_ctrl = .20,
               r2m1_trt = .20, r2m2_trt = .20, r2m3_trt = .20,
               r2y1_trt = .20, r2y2_trt = .20, r2y3_trt = .20,
               n_ctrl = 24, n_trt =  24, J_trt = 12, J_ctrl = 60, K_trt = 60)
</code></pre>

<hr>
<h2 id='plots'>Plots</h2><span id='topic+plot.power'></span><span id='topic+plot.mdes'></span><span id='topic+plot.mrss'></span>

<h3>Description</h3>

<p>Plots statistical power, minimum detectable effect size (MDES), or MDES difference (MDESD) curves with (1-<code class="reqn">\alpha</code>)x100 % confidence interval.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ## S3 method for class 'power'
plot(x, ypar = "power",  xpar = NULL,
          xlim = NULL, ylim = NULL,
          xlab = NULL, ylab = NULL,
          main = NULL, sub = NULL,
          locate = FALSE, ...)

  ## S3 method for class 'mdes'
plot(x, ypar = "power",  xpar = NULL,
          xlim = NULL, ylim = NULL,
          xlab = NULL, ylab = NULL,
          main = NULL, sub = NULL,
          locate = FALSE, ...)

  ## S3 method for class 'mrss'
plot(x, ypar = "power",  xpar = NULL,
          xlim = NULL, ylim = NULL,
          xlab = NULL, ylab = NULL,
          main = NULL, sub = NULL,
          locate = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plots_+3A_x">x</code></td>
<td>
<p>an object returned from one of the <code>PowerUpR</code> functions.</p>
</td></tr>
<tr><td><code id="plots_+3A_ypar">ypar</code></td>
<td>
<p>character; <code>"mdes"</code> or  <code>"power"</code> on <code>y</code> axis .</p>
</td></tr>
<tr><td><code id="plots_+3A_xpar">xpar</code></td>
<td>
<p>character; one of the sample sizes on <code>x</code> axis.</p>
</td></tr>
<tr><td><code id="plots_+3A_xlim">xlim</code></td>
<td>
<p>limits for <code>xpar</code>.</p>
</td></tr>
<tr><td><code id="plots_+3A_ylim">ylim</code></td>
<td>
<p>limits for <code>ypar</code>.</p>
</td></tr>
<tr><td><code id="plots_+3A_xlab">xlab</code></td>
<td>
<p><code>x</code> axis label (ignored for objects returned from <code>power.med211()</code>, <code>power.med221()</code>, and <code>power.med321()</code> functions).</p>
</td></tr>
<tr><td><code id="plots_+3A_ylab">ylab</code></td>
<td>
<p><code>y</code> axis label (ignored for objects returned from <code>power.med211()</code>, <code>power.med221()</code>, and <code>power.med321()</code> functions).</p>
</td></tr>
<tr><td><code id="plots_+3A_main">main</code></td>
<td>
<p>title for the plot (ignored for objects returned from <code>power.med221()</code> and <code>power.med211()</code> functions).</p>
</td></tr>
<tr><td><code id="plots_+3A_sub">sub</code></td>
<td>
<p>subtitle for the plot (ignored for objects returned from <code>power.med221()</code> and <code>power.med211()</code> functions).</p>
</td></tr>
<tr><td><code id="plots_+3A_locate">locate</code></td>
<td>
<p>logical; <code>TRUE</code> locates parameter values for design <code>x</code> on the plot.</p>
</td></tr>
<tr><td><code id="plots_+3A_...">...</code></td>
<td>
<p>other graphical parameters to pass to <code>plot.new()</code>.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>design1 &lt;- mdes.cra3(rho3=.06, rho2=.17, n=15, J=3, K=60)
plot(design1, ypar = "mdes", xpar = "K", xlim = c(30, 100))
plot(design1, ypar = "power", xpar = "K", xlim = c(30, 100))

design2 &lt;- power.cra3(es=.269, rho3=.06, rho2=.17, n=15, J=3, K=60)
plot(design2, ypar = "mdes", xpar = "K", xlim = c(30, 100))
plot(design2, ypar = "power", xpar = "K", xlim = c(30, 100))
</code></pre>

<hr>
<h2 id='PowerUpR-package'>Power Analysis Tools for Multilevel Randomized Experiments</h2><span id='topic+PowerUpR'></span><span id='topic+PowerUpR-package'></span>

<h3>Description</h3>

<p><em>PowerUp!</em> series consist of three excel-based applications to design various multilevel randomized experiments to detect main treatment effects, and to design two- and three-level cluster-randomized trials (CRTs) to detect multilevel moderation and mediation. For more information please refer to <a href="https://www.causalevaluation.org/">https://www.causalevaluation.org/</a>.
</p>

<hr>
<h2 id='replication'>Unambiguous Test of Replication for Ensemble of Studies</h2><span id='topic+rep'></span><span id='topic+mdh'></span><span id='topic+power.rep'></span><span id='topic+mdh.rep'></span><span id='topic+mrns.rep'></span><span id='topic+replication'></span>

<h3>Description</h3>

<p>Use <code>power.rep()</code> for the statistical power, <code>mdh.rep()</code> for the minimum detectable heterogeneity, and <code>mrns.rep()</code> for the minimum required number of studies. Functions implement methods designed to conduct unambiguous test of replication for ensemble of studies (Hedges &amp; Schauer, 2019). <code>mdh</code> argument is the effect heterogeneity above and beyond sampling variability. An <code>mdh = 0</code> specification means effects are same across subgroups or moderator levels in the population. Effects will vary from each other solely due to sampling error. In this case, with large samples, heterogeneity detected after ensample of studies are conducted will be equal to unity.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>power.rep(k = 2L, mdh = 1/4, mdh.null = 0, alpha = .05)

mdh.rep(k = 2L, mdh.max = 15, alpha = .05, power = 0.80,
        mdh.null = 0, step = .001, plot = FALSE)

mrns.rep(power = .80, mdh = 1/4, mdh.null = 0, alpha = .05,
         tol = .001)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="replication_+3A_k">k</code></td>
<td>
<p>number of replications.</p>
</td></tr>
<tr><td><code id="replication_+3A_power">power</code></td>
<td>
<p>statistical power <code class="reqn">(1-\beta)</code>.</p>
</td></tr>
<tr><td><code id="replication_+3A_alpha">alpha</code></td>
<td>
<p>probability of type I error.</p>
</td></tr>
<tr><td><code id="replication_+3A_mdh">mdh</code></td>
<td>
<p>minimum detectable heterogeneity (MDH).</p>
</td></tr>
<tr><td><code id="replication_+3A_mdh.null">mdh.null</code></td>
<td>
<p>MDH for null hypothesis.</p>
</td></tr>
<tr><td><code id="replication_+3A_mdh.max">mdh.max</code></td>
<td>
<p>maximum of possible MDH values for grid search.</p>
</td></tr>
<tr><td><code id="replication_+3A_step">step</code></td>
<td>
<p>step size to generate possible MDH values.</p>
</td></tr>
<tr><td><code id="replication_+3A_plot">plot</code></td>
<td>
<p>logical; if TRUE plots MDH - power curve.</p>
</td></tr>
<tr><td><code id="replication_+3A_tol">tol</code></td>
<td>
<p>tolerance to end iterative process for finding <code>k</code></p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>fun</code></td>
<td>
<p>function name.</p>
</td></tr>
<tr><td><code>parms</code></td>
<td>
<p>list of parameters used in the calculation.</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>degrees of freedom.</p>
</td></tr>
<tr><td><code>power</code></td>
<td>
<p>statistical power <code class="reqn">(1-\beta)</code>.</p>
</td></tr>
<tr><td><code>mdh</code></td>
<td>
<p>minimum detectable heterogeneity (MDH).</p>
</td></tr>
<tr><td><code>k</code></td>
<td>
<p>minimum required number of studies.</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>degrees of freedom.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Hedges, L. V., &amp; Schauer, J. (2019). Statistical analyses for studying replication: Meta-analytic perspectives. Psychological Methods, 24(5), 557-570. http://dx.doi.org/10.1037/met0000189
</p>


<h3>Examples</h3>

<pre><code class='language-R'># cross-checks
power.rep(k = 20L, mdh = 0.50)
mdh.rep(k = 20L, power = .39)
mrns.rep(power = .39, mdh = .50)
</code></pre>

<hr>
<h2 id='t1t2.error'>Plots Type I and Type II Error Rates</h2><span id='topic+t1t2.error'></span>

<h3>Description</h3>

<p><code>t1t2.error</code> plots Type I (<code class="reqn">\alpha</code>) and Type II (<code class="reqn">\beta</code>) error rates using central and
noncentral <code>t</code> distributions for any objects returned from one of the <code>PowerUpR</code> functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  t1t2.error(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="t1t2.error_+3A_object">object</code></td>
<td>
<p>an object returned from one of the <code>PowerUpR</code> functions.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>  ## Not run: 

    design1 &lt;- mdes.bira2(rho2=.35, omega2=.10,
                            n=83, J=480)
    t1t2.error(design1)

  
## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
