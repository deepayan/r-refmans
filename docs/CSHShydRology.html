<!DOCTYPE html><html><head><title>Help for package CSHShydRology</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {CSHShydRology}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Basic_data_manipulation_functions'><p>Basic data manipulation functions</p></a></li>
<li><a href='#CAN01AD002'><p>Streamflow data</p></a></li>
<li><a href='#CAN05AA008'><p>CAN05AA008</p></a></li>
<li><a href='#ch_axis_doy'><p>Generates the x axis beginning on specified day of year</p></a></li>
<li><a href='#ch_binned_MannWhitney'><p>Compares two time periods of data using Mann-Whitney test</p></a></li>
<li><a href='#ch_booth_plot'><p>Create Booth plot of peaks over a threshold</p></a></li>
<li><a href='#ch_catchment_hyps'><p>Catchment hypsometry</p></a></li>
<li><a href='#ch_checkcatchment'><p>Check Catchments</p></a></li>
<li><a href='#ch_checkchannels'><p>Check Channels</p></a></li>
<li><a href='#ch_circ_mean_reg'><p>Calculates the circular mean, median, and regularity</p></a></li>
<li><a href='#ch_clear_wd'><p>Clear Working Directory</p></a></li>
<li><a href='#ch_col_gradient'><p>Creates a colour gradient</p></a></li>
<li><a href='#ch_col_transparent'><p>Add Transparency to plot colours</p></a></li>
<li><a href='#ch_color_gradient'><p>ch_color_gradient</p></a></li>
<li><a href='#ch_contours'><p>Create Contours</p></a></li>
<li><a href='#ch_create_wd'><p>Create working directory</p></a></li>
<li><a href='#ch_cut_block'><p>Extracts a specified time period from a longer record</p></a></li>
<li><a href='#ch_date_subset'><p>Subsets dates by string</p></a></li>
<li><a href='#ch_decades_plot'><p>Plots output from ch_binned_MannWhitney for decades</p></a></li>
<li><a href='#ch_doys'><p>Days of year and water year</p></a></li>
<li><a href='#ch_fdcurve'><p>Plot Flow Duration Curve</p></a></li>
<li><a href='#ch_flow_raster'><p>Raster plot of daily streamflows</p></a></li>
<li><a href='#ch_flow_raster_qa'><p>Raster plot of daily streamflows with WSC quality flags</p></a></li>
<li><a href='#ch_flow_raster_trend'><p>Raster plot and simple trends of observed streamflows by periods</p></a></li>
<li><a href='#ch_get_ECDE_metadata'><p>Reads Environment Canada Date Explorer (ECDE) meta data file</p></a></li>
<li><a href='#ch_get_map_base'><p>ch_get_map_base</p></a></li>
<li><a href='#ch_get_peaks'><p>Extracts peak flows over a threshold</p></a></li>
<li><a href='#ch_get_url_data'><p>Gets remote data sets</p></a></li>
<li><a href='#ch_get_wscstation'><p>Reads station information from a data file produced by ECDE</p></a></li>
<li><a href='#ch_hydrograph_plot'><p>Hydrograph plot</p></a></li>
<li><a href='#ch_map_plot_data'><p>Generate a map for a defined area</p></a></li>
<li><a href='#ch_polar_plot'><p>Polar plot of daily streamflows</p></a></li>
<li><a href='#ch_polar_plot_peaks'><p>Polar / circular plots of peak flows</p></a></li>
<li><a href='#ch_polar_plot_prep'><p>Creates a data structure to be passed to <code>ch_polar_plot</code></p></a></li>
<li><a href='#ch_qa_hydrograph'><p>Plots a hydrograph with the data quality symbols and returns a report on qa symbols and missing data.</p></a></li>
<li><a href='#ch_read_AHCCD_daily'><p>Reads AHCCD daily file</p></a></li>
<li><a href='#ch_read_AHCCD_monthly'><p>Reads AHCCD monthly file</p></a></li>
<li><a href='#ch_read_ECDE_flows'><p>Reads a file of WSC daily flows from ECDataExplorer (ECDE)</p></a></li>
<li><a href='#ch_regime_plot'><p>Plots the regime of daily streamflows using quantiles</p></a></li>
<li><a href='#ch_rfa_distseason'><p>Distance in seasonal space</p></a></li>
<li><a href='#ch_rfa_extractamax'><p>Extracts the annual maxima of a daily time series</p></a></li>
<li><a href='#ch_rfa_julianplot'><p>Circular plotting by day of year</p></a></li>
<li><a href='#ch_rfa_seasonstat'><p>Seasonal statistics for flood peaks</p></a></li>
<li><a href='#ch_sh_get_amax'><p>Extracts annual maximum values from ECDE dataframe.</p></a></li>
<li><a href='#ch_slice'><p>Converts doy or dwy into a factor that is used to bin data</p></a></li>
<li><a href='#ch_stack_EC'><p>Stacks EC values</p></a></li>
<li><a href='#ch_sub_set_Years'><p>Helper function for selecting points for an axis</p></a></li>
<li><a href='#ch_test_url_file'><p>Tests url to see if it will work</p></a></li>
<li><a href='#ch_tidyhydat_ECDE'><p>Converts a tidyhydat daily flow data tibble to ECDE format</p></a></li>
<li><a href='#ch_tidyhydat_ECDE_meta'><p>Creates an ECDE-like dataframe of metadata from <span class="pkg">tidyhydat</span></p></a></li>
<li><a href='#ch_tr_sign'><p>ch_tr_sign</p></a></li>
<li><a href='#ch_tr_signif'><p>ch_tr_signif()</p></a></li>
<li><a href='#ch_volcano_pourpoints'><p>Creates a sample file of pour points</p></a></li>
<li><a href='#ch_volcano_raster'><p>Create Test Raster</p></a></li>
<li><a href='#ch_wbt_catchment'><p>Delineate catchment boundaries</p></a></li>
<li><a href='#ch_wbt_catchment_onestep'><p>Delineates a catchment in a single step</p></a></li>
<li><a href='#ch_wbt_channels'><p>Generate stream network</p></a></li>
<li><a href='#ch_wbt_check_whitebox'><p>Checks for WhiteboxTools executable</p></a></li>
<li><a href='#ch_wbt_filenames'><p>Creates names for Whitebox function input and output files</p></a></li>
<li><a href='#ch_wbt_flow_accumulation'><p>Creates flow accumulation grid file</p></a></li>
<li><a href='#ch_wbt_flow_direction'><p>Creates flow direction grid file</p></a></li>
<li><a href='#ch_wbt_pourpoints'><p>Snap pour points to channels</p></a></li>
<li><a href='#ch_wbt_removesinks'><p>Removes sinks from a DEM</p></a></li>
<li><a href='#ch_wtr_yr'><p>Designation of the water year</p></a></li>
<li><a href='#CSHShydRology-package'><p>Functions for Canadian hydrological analyses</p></a></li>
<li><a href='#flowAtlantic'><p>Annual maxima from sites in the Atlantic region of Canada</p></a></li>
<li><a href='#HYDAT_list'><p>List of Water Survey of Canada hydrometic stations.</p></a></li>
<li><a href='#Spatial_hydrology_functions'><p>Spatial Hydrology functions</p></a></li>
<li><a href='#StatisticalHydrology-functions'><p>Statistical analysis functions</p></a></li>
<li><a href='#Visualization-functions'><p>Visualization functions</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Canadian Hydrological Analyses</td>
</tr>
<tr>
<td>Version:</td>
<td>1.4.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-03-06</td>
</tr>
<tr>
<td>Author:</td>
<td>Kevin Shook [cre, aut],
  Paul Whitfield [aut],
  Robert Chlumsky [aut],
  Daniel Moore [aut],
  Martin Durocher [aut],
  Matthew Lemieux [ctb],
  Jason Chiang [ctb],
  Joel Trubilowicz [ctb],
  SJ Kim [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Kevin Shook &lt;kevin.shook@usask.ca&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>A collection of user-submitted functions to aid in the analysis of hydrological data, particularly for users in Canada. The functions focus on the use of Canadian data sets, and are suited to Canadian hydrology, such as the important cold region hydrological processes and will work with Canadian hydrological models. The functions are grouped into several themes, currently including Statistical hydrology, Basic data manipulations, Visualization, and Spatial hydrology. Functions developed by the Floodnet project are also included. CSHShydRology has been developed with the assistance of the Canadian Society for Hydrological Sciences (CSHS) which is an affiliated society of the Canadian Water Resources Association (CWRA). As of version 1.2.6, functions now fail gracefully when attempting to download data from a url which is unavailable.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/AGPL-3">AGPL-3</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/CSHS-hydRology/CSHShydRology">https://github.com/CSHS-hydRology/CSHShydRology</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>fields, Kendall, lubridate, plotrix, timeDate, stringr,
ggplot2, ggspatial, stats, raster, sf, dplyr, magrittr, httr,
tidyhydat, whitebox, datasets, circular, OpenStreetMap,
rnaturalearth</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, testthat, rmarkdown, readr</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-03-06 17:05:37 UTC; kevin</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-03-06 22:30:15 UTC</td>
</tr>
</table>
<hr>
<h2 id='Basic_data_manipulation_functions'>Basic data manipulation functions</h2><span id='topic+Basic_data_manipulation_functions'></span>

<h3>Description</h3>

<p>These functions read in or convert values among formats
</p>

<dl>
<dt>ch_read_ECDE_flows</dt><dd><p>Reads a file of WSC daily flows from ECDataExplorer</p>
</dd>
<dt>ch_get_ECDE_metadata</dt><dd><p>Reads station meta data from ECDataExplorer</p>
</dd>
<dt>ch_get_wscstation</dt><dd><p>Reads station information from a data file produced by ECDE</p>
</dd>
<dt>ch_read_AHCCD_daily</dt><dd><p>Reads file of daily AHCCD values</p>
</dd>
<dt>ch_read_AHCCD_monthly</dt><dd><p>Reads file of monthly AHCCD values</p>
</dd>
<dt>ch_tidyhydat_ECDE</dt><dd><p>Reads flows using <span class="pkg">tidyhydat</span> and converts to ECDE format</p>
</dd>
<dt>ch_tidyhydat_ECDE_meta</dt><dd><p>Reads station meta data using <span class="pkg">tidyhydat</span> and converts to ECDE-like format</p>
</dd>
</dl>


<hr>
<h2 id='CAN01AD002'>Streamflow data</h2><span id='topic+CAN01AD002'></span>

<h3>Description</h3>

<p>Daily river discharge for the station 01AD002 on
St. John River at Fort Kent, New Brunswick.
Data ranges from 1926 to 2014, for basin area of 14700 sq km.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CAN01AD002
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 32234 rows and 2 columns.
</p>


<h3>Author(s)</h3>

<p>Martin Durocher
</p>


<h3>Source</h3>

<p><a href="https://wateroffice.ec.gc.ca/">https://wateroffice.ec.gc.ca/</a>
</p>

<hr>
<h2 id='CAN05AA008'>CAN05AA008</h2><span id='topic+CAN05AA008'></span>

<h3>Description</h3>

<p>A dataframe of Water Survey of Canada (WSC) daily flows for station 05AA008, CROWSNEST RIVER AT FRANK Alberta. Drainage area 403 km2.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CAN05AA008
</code></pre>


<h3>Format</h3>

<p>A dateframe with 25252 rows and 5 columns spanning the period 1910-2013.
</p>


<h3>Details</h3>

<p>Variables: 
</p>

<dl>
<dt>ID</dt><dd><p>StationID</p>
</dd>
<dt>PARAM</dt><dd><p>Parameter 1=Flow, 2=Level</p>
</dd>
<dt>Date</dt><dd><p><span class="rlang"><b>R</b></span> date</p>
</dd>
<dt>Flow</dt><dd><p>Daily flow in  m<code class="reqn">^3</code>/s</p>
</dd>
<dt>SYM</dt><dd><p>Water Survey FLags A, B, D, E </p>
</dd>
</dl>



<h3>Source</h3>

<p>Water Survey of Canada
</p>

<hr>
<h2 id='ch_axis_doy'>Generates the x axis beginning on specified day of year</h2><span id='topic+ch_axis_doy'></span>

<h3>Description</h3>

<p>Generates an axis for day of year or day of water year; used by 
<code>ch_regime_plot</code>. Obtaining the day of water year needs to be done separately.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ch_axis_doy(wyear = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ch_axis_doy_+3A_wyear">wyear</code></td>
<td>
<p>Month of beginning of water year, <code>wyear = 1</code> (the default) for 
calendar year, <code>wyear = 10</code> to start October 1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Plots a water year axis on a standard R plot
</p>


<h3>Author(s)</h3>

<p>Paul Whitfield
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ch_regime_plot">ch_regime_plot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>a &lt;- seq(1, 365)
b &lt;- runif(365)
plot(a, b,  type = "p", xlab = "", xaxt = "n")
ch_axis_doy(wyear = 10) # starts in October
</code></pre>

<hr>
<h2 id='ch_binned_MannWhitney'>Compares two time periods of data using Mann-Whitney test</h2><span id='topic+ch_binned_MannWhitney'></span>

<h3>Description</h3>

<p>Compares two time periods of data using the Mann-Whitney test. 
Data are binned based upon a bin size, and data are extracted for two time periods 
and tests for change between two such periods
result can be passed to <code>ch_polar_plot</code> or <code>ch_decades_plot</code> 
for visualization.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ch_binned_MannWhitney(
  DF,
  step,
  range1,
  range2,
  ptest = 0.05,
  variable = "discharge",
  metadata = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ch_binned_MannWhitney_+3A_df">DF</code></td>
<td>
<p>A data frame of hydrometric data from <code>ch_read_ECDE_flows</code></p>
</td></tr>
<tr><td><code id="ch_binned_MannWhitney_+3A_step">step</code></td>
<td>
<p>An integer indicating the degree of smoothing eg. 1, 5, 11.</p>
</td></tr>
<tr><td><code id="ch_binned_MannWhitney_+3A_range1">range1</code></td>
<td>
<p>The first and last year of first period, as <code>c(first,last)</code></p>
</td></tr>
<tr><td><code id="ch_binned_MannWhitney_+3A_range2">range2</code></td>
<td>
<p>The first and last year of second period, as <code>c(first,last)</code></p>
</td></tr>
<tr><td><code id="ch_binned_MannWhitney_+3A_ptest">ptest</code></td>
<td>
<p>The significance level default is <code>0.05</code>.</p>
</td></tr>
<tr><td><code id="ch_binned_MannWhitney_+3A_variable">variable</code></td>
<td>
<p>Name of variable. Default is <span class="option">discharge</span></p>
</td></tr>
<tr><td><code id="ch_binned_MannWhitney_+3A_metadata">metadata</code></td>
<td>
<p>dataframe of station metadata, default is HYDAT_list</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list containing:
</p>
<table>
<tr><td><code>StationID</code></td>
<td>
<p>ID of station</p>
</td></tr>
<tr><td><code>Station_lname</code></td>
<td>
<p>Name of station</p>
</td></tr>
<tr><td><code>bin_width</code></td>
<td>
<p>Smoothing time step</p>
</td></tr>
<tr><td><code>range1</code></td>
<td>
<p>First range of years</p>
</td></tr>
<tr><td><code>range2</code></td>
<td>
<p>Second range of years</p>
</td></tr>
<tr><td><code>p_used</code></td>
<td>
<p>p_value</p>
</td></tr>
<tr><td><code>fail</code></td>
<td>
<p>TRUE if test failed due to missing values</p>
</td></tr>
<tr><td><code>bin_method</code></td>
<td>
<p>method used for binning</p>
</td></tr>
<tr><td><code>test_method</code></td>
<td>
<p>Mann-Whitney U-statistic</p>
</td></tr>
<tr><td><code>series</code></td>
<td>
<p>a data frame containing:</p>
</td></tr>
<tr><td><code>period</code></td>
<td>
<p>period numbers i.e. 1:365/step</p>
</td></tr>
<tr><td><code>period1</code></td>
<td>
<p>median values for each bin in period 1</p>
</td></tr>
<tr><td><code>period2</code></td>
<td>
<p>median values for each bin in period 2</p>
</td></tr>
<tr><td><code>mwu</code></td>
<td>
<p>Mann-Whitney U-statistic for each bin between the two periods</p>
</td></tr>
<tr><td><code>prob</code></td>
<td>
<p>probability of U-statistic for each period</p>
</td></tr>
<tr><td><code>code</code></td>
<td>
<p>significance codes for each bin</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Paul Whitfield
</p>


<h3>References</h3>

<p>Whitfield, P.H., Cannon, A.J., 2000. Recent variations in climate and 
hydrology in Canada. Canadian Water Resources Journal 25: 19-65.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ch_polar_plot">ch_polar_plot</a></code> <code><a href="#topic+ch_polar_plot_prep">ch_polar_plot_prep</a></code> 
<code><a href="#topic+ch_decades_plot">ch_decades_plot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(HYDAT_list)
data(CAN05AA008)
# first example fails due to missing data in both periods
range1 &lt;- c(1960,1969)
range2 &lt;- c(1990,1999)
b_MW &lt;- ch_binned_MannWhitney(CAN05AA008, step = 5, range1, range2, ptest = 0.05)

range1 &lt;- c(1970,1979)
range2 &lt;- c(1990,1999)
b_MW &lt;- ch_binned_MannWhitney(CAN05AA008, step = 5, range1, range2, ptest = 0.05)

</code></pre>

<hr>
<h2 id='ch_booth_plot'>Create Booth plot of peaks over a threshold</h2><span id='topic+ch_booth_plot'></span>

<h3>Description</h3>

<p>A Booth plot is a plot of peaks over threshold flood events with duration on the horizontal and
either magnitude (default) or volume on the vertical axis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ch_booth_plot(events, threshold, title, type = "mag", colour1 = 1, colour2 = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ch_booth_plot_+3A_events">events</code></td>
<td>
<p>A data frame of POT events from the function <code>ch_get_peaks</code></p>
</td></tr>
<tr><td><code id="ch_booth_plot_+3A_threshold">threshold</code></td>
<td>
<p>The threshold used by <code>ch_get_peaks</code></p>
</td></tr>
<tr><td><code id="ch_booth_plot_+3A_title">title</code></td>
<td>
<p>Plot title</p>
</td></tr>
<tr><td><code id="ch_booth_plot_+3A_type">type</code></td>
<td>
<p>The plot type, either <span class="option">mag</span> (magnitude, the default) or <span class="option">vol</span> (volume)</p>
</td></tr>
<tr><td><code id="ch_booth_plot_+3A_colour1">colour1</code></td>
<td>
<p>A vector of length 12 with line colours of rings or symbols. Defaults to those used by Booth.</p>
</td></tr>
<tr><td><code id="ch_booth_plot_+3A_colour2">colour2</code></td>
<td>
<p>A vector of length 12 with fill colours of rings or symbols. Defaults to those used by Booth.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No value is returned; a standard <span class="rlang"><b>R</b></span> graphic is created.
</p>


<h3>Author(s)</h3>

<p>Paul Whitfield
</p>


<h3>References</h3>

<p>Booth, E.G., Mount, J.F., Viers, J.H. 2006. Hydrologic Variability of the Cosumnes River Floodplain.
San Francisco Estuary &amp; Watershed Science 4:21.
</p>
<p>Whitfield, P.H., and J.W. Pomeroy. 2016. Changes to flood peaks of a mountain river: implications
for analysis of the 2013 flood in the Upper Bow River, Canada. Hydrological Processes 30:4657-73. doi:
10.1002/hyp.10957.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ch_get_peaks">ch_get_peaks</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>threshold &lt;- 0.1 * max(CAN05AA008$Flow)  # arbitrary threshold
peaks &lt;- ch_get_peaks(CAN05AA008, threshold)
events &lt;- peaks$POTevents
ch_booth_plot(events, threshold, title = "05AA008", type='mag')
ch_booth_plot(events, threshold, title = "05AA008", type='vol')
</code></pre>

<hr>
<h2 id='ch_catchment_hyps'>Catchment hypsometry</h2><span id='topic+ch_catchment_hyps'></span>

<h3>Description</h3>

<p>Finds the hypsometric curve, which is the total fraction of
the area below vs. elevation, for a given basin.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ch_catchment_hyps(
  catchment,
  dem,
  z_levels = NULL,
  n_levels = 10,
  zmin = NULL,
  zmax = NULL,
  quantiles = NULL,
  hypso_plot = FALSE,
  z_units = "m",
  col = "red",
  type = "o",
  xlab = "Fraction of catchment below given elevation",
  ylab = paste0("Elevation (", z_units, ")"),
  add_grid = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ch_catchment_hyps_+3A_catchment">catchment</code></td>
<td>
<p>A <span class="pkg">sf</span> object containing the catchment divide.</p>
</td></tr>
<tr><td><code id="ch_catchment_hyps_+3A_dem">dem</code></td>
<td>
<p>A <span class="pkg">raster</span> object of the Digital Elevation Model.</p>
</td></tr>
<tr><td><code id="ch_catchment_hyps_+3A_z_levels">z_levels</code></td>
<td>
<p>Vector of elevation levels for the hypsometry. If specified, 
then no other elevation parameters are required. Default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="ch_catchment_hyps_+3A_n_levels">n_levels</code></td>
<td>
<p>If specified, sets number of elevation intervals. 
Can be used with <code>zmin</code> and <code>zmax</code>. Default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="ch_catchment_hyps_+3A_zmin">zmin</code></td>
<td>
<p>Minimum elevation for hypsometry. If not specified, minimum
catchment elevation is used. Default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="ch_catchment_hyps_+3A_zmax">zmax</code></td>
<td>
<p>Maximum elevation for hypsometry. If not specified, maximum
catchment elevation is used. Default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="ch_catchment_hyps_+3A_quantiles">quantiles</code></td>
<td>
<p>Vector of elevation quantiles. Default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="ch_catchment_hyps_+3A_hypso_plot">hypso_plot</code></td>
<td>
<p>if <code>TRUE</code> the hypsometric curve is plotted. Default is
<code>NULL</code>.</p>
</td></tr>
<tr><td><code id="ch_catchment_hyps_+3A_z_units">z_units</code></td>
<td>
<p>Elevation units for plot. Default is <span class="option">m</span>.</p>
</td></tr>
<tr><td><code id="ch_catchment_hyps_+3A_col">col</code></td>
<td>
<p>Colour for plot. Default is <span class="option">red</span>.</p>
</td></tr>
<tr><td><code id="ch_catchment_hyps_+3A_type">type</code></td>
<td>
<p>Type of plot. Defailt is <span class="option">o</span> (lines with overplotted
points).</p>
</td></tr>
<tr><td><code id="ch_catchment_hyps_+3A_xlab">xlab</code></td>
<td>
<p>Plot x-axis label.</p>
</td></tr>
<tr><td><code id="ch_catchment_hyps_+3A_ylab">ylab</code></td>
<td>
<p>Plot y-axis label.</p>
</td></tr>
<tr><td><code id="ch_catchment_hyps_+3A_add_grid">add_grid</code></td>
<td>
<p>If <code>TRUE</code>, a grid is added to the plot. Default is 
<code>FALSE</code></p>
</td></tr>
<tr><td><code id="ch_catchment_hyps_+3A_...">...</code></td>
<td>
<p>Other parameters for the graph</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The elevations may be passed as a vector of elevations, or of elevation quantiles, or as minimum
and maximum elevations and the number of elevation intervals. A plot of the 
curve may also be created.
</p>


<h3>Value</h3>

<p>Returns a data frame of elevations and catchment fractions below.
</p>


<h3>Author(s)</h3>

<p>Dan Moore
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Note: example not tested automatically as it is very slow to execute due to the downloading
library(raster)
library(magrittr)
# change the following line to specify a directory to hold the data
dir_name &lt;- tempdir(check = FALSE)
# create directory to store data sets
if (!dir.exists(dir_name)) {
  dir.create(dir_name, recursive = TRUE)
}
# get 25-m dem
dem_fn &lt;- file.path(dir_name, "gs_dem25.tif")
dem_url &lt;- "https://zenodo.org/record/4781469/files/gs_dem25.tif"
dem_upc &lt;- ch_get_url_data(dem_url, dem_fn)
dem_upc

# get catchment boundaries
cb_fn &lt;- file.path(dir_name, "gs_catchments.GeoJSON")
cb_url &lt;- "https://zenodo.org/record/4781469/files/gs_catchments.GeoJSON"
cb &lt;- ch_get_url_data(cb_url, cb_fn)

# quick check plot - all catchments
raster::plot(dem_upc)
plot(cb, add = TRUE, col = NA)

# subset 240 catchment
cb_240 &lt;- cb %&gt;% dplyr::filter(wsc_name == "240")
plot(cb_240, col = NA)

## test function 

# test different combinations of arguments
ch_catchment_hyps(cb_240, dem_upc, quantiles = seq(0, 1, 0.1))
ch_catchment_hyps(cb_240, dem_upc, z_levels = seq(1600, 2050, 50))
ch_catchment_hyps(cb_240, dem_upc, n_levels = 6)
ch_catchment_hyps(cb_240, dem_upc)
ch_catchment_hyps(cb_240, dem_upc, zmin = 1600, zmax = 2050)
ch_catchment_hyps(cb_240, dem_upc, zmin = 1600, zmax = 2050, n_levels = 6)

# generate a graph
ch_catchment_hyps(cb_240, dem_upc, hypso_plot = TRUE)
ch_catchment_hyps(cb_240, dem_upc, hypso_plot = TRUE, 
              col = "blue", type = "l", ylim = c(1500, 2200))
ch_catchment_hyps(cb_240, dem_upc, hypso_plot = TRUE, 
              add_grid = TRUE, quantiles = seq(0, 1, 0.1))
ch_catchment_hyps(cb_240, dem_upc, hypso_plot = TRUE,
              ylab = expression("z ("*10^{-3} ~ "km)"))

# extract specific quantiles (e.g., median and 90%)
ch_catchment_hyps(cb_240, dem_upc, quantiles = c(0.5,0.9))

</code></pre>

<hr>
<h2 id='ch_checkcatchment'>Check Catchments</h2><span id='topic+ch_checkcatchment'></span>

<h3>Description</h3>

<p>Generates a simple map to allow a visual assessment of the catchment 
boundaries relative to the elevation contours.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ch_checkcatchment(
  dem,
  catchment,
  outlet,
  outlet_label = NULL,
  main_label = "",
  bbox_type = "catchment",
  channel_vec = NULL,
  cb_colour = "red",
  pp_colour = "red",
  channel_colour = "blue",
  contour_colour = "grey",
  plot_na = TRUE,
  plot_scale = TRUE,
  na_location = "tr",
  scale_location = "bl"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ch_checkcatchment_+3A_dem">dem</code></td>
<td>
<p>raster DEM that catchments were generated from.</p>
</td></tr>
<tr><td><code id="ch_checkcatchment_+3A_catchment">catchment</code></td>
<td>
<p>Catchment polygon (sf object).</p>
</td></tr>
<tr><td><code id="ch_checkcatchment_+3A_outlet">outlet</code></td>
<td>
<p>Location of catchment outlet (sf object).</p>
</td></tr>
<tr><td><code id="ch_checkcatchment_+3A_outlet_label">outlet_label</code></td>
<td>
<p>Character label for outlet.</p>
</td></tr>
<tr><td><code id="ch_checkcatchment_+3A_main_label">main_label</code></td>
<td>
<p>Main label for catchment plot.</p>
</td></tr>
<tr><td><code id="ch_checkcatchment_+3A_bbox_type">bbox_type</code></td>
<td>
<p>type of bounding box. If <span class="option">catchment</span>, then
the contours are bounded by the catchment, otherwise they are plotted 
to the extent of the DEM</p>
</td></tr>
<tr><td><code id="ch_checkcatchment_+3A_channel_vec">channel_vec</code></td>
<td>
<p>Vectors of the channels will be plotted if specified.</p>
</td></tr>
<tr><td><code id="ch_checkcatchment_+3A_cb_colour">cb_colour</code></td>
<td>
<p>Colour for catchment outline. Default is &quot;red&quot;.</p>
</td></tr>
<tr><td><code id="ch_checkcatchment_+3A_pp_colour">pp_colour</code></td>
<td>
<p>Colour for catchment pour points. Default is &quot;red&quot;.</p>
</td></tr>
<tr><td><code id="ch_checkcatchment_+3A_channel_colour">channel_colour</code></td>
<td>
<p>Colour for channel. Default is &quot;blue&quot;.</p>
</td></tr>
<tr><td><code id="ch_checkcatchment_+3A_contour_colour">contour_colour</code></td>
<td>
<p>Colour for contours Default is &quot;grey&quot;.</p>
</td></tr>
<tr><td><code id="ch_checkcatchment_+3A_plot_na">plot_na</code></td>
<td>
<p>If <code>TRUE</code> (the default) a north arrow is added to the plot.</p>
</td></tr>
<tr><td><code id="ch_checkcatchment_+3A_plot_scale">plot_scale</code></td>
<td>
<p>If <code>TRUE</code> (the default) a scale bar is added to the plot.</p>
</td></tr>
<tr><td><code id="ch_checkcatchment_+3A_na_location">na_location</code></td>
<td>
<p>Location for the north arrow. Default is <span class="option">tr</span>, i.e. top-right.</p>
</td></tr>
<tr><td><code id="ch_checkcatchment_+3A_scale_location">scale_location</code></td>
<td>
<p>Location for the scale bar. Default is <span class="option">bl</span>, i.e. bottom-left.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Also generates a table summarizing the catchments, 
including the coordinates of the outlet point and the catchment area.
</p>


<h3>Value</h3>

<p><code>TRUE</code>. A map of the catchments is also plotted and 
the catchment parameters are printed.
</p>


<h3>Author(s)</h3>

<p>Dan Moore and Kevin Shook
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ch_checkchannels">ch_checkchannels</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Only proceed if Whitebox executable is installed
library(whitebox)
if (check_whitebox_binary()){
  library(raster)
  test_raster &lt;- ch_volcano_raster()
  dem_raster_file &lt;- tempfile(fileext = ".tif")
  no_sink_raster_file &lt;- tempfile("no_sinks", fileext = ".tif")

  # write test raster to file
  writeRaster(test_raster, dem_raster_file, format = "GTiff")

  # remove sinks
  removed_sinks &lt;- ch_wbt_removesinks(dem_raster_file, no_sink_raster_file, 
  method = "fill")

  # get flow accumulations
  flow_acc_file &lt;- tempfile("flow_acc", fileext = ".tif")
  flow_acc &lt;- ch_wbt_flow_accumulation(no_sink_raster_file, flow_acc_file)

  # get pour points
  pourpoint_file &lt;- tempfile("volcano_pourpoints", fileext = ".shp")
  pourpoints &lt;- ch_volcano_pourpoints(pourpoint_file)
  snapped_pourpoint_file &lt;- tempfile("snapped_pourpoints", fileext = ".shp")
  snapped_pourpoints &lt;- ch_wbt_pourpoints(pourpoints, flow_acc_file, pourpoint_file,
  snapped_pourpoint_file, snap_dist = 10)

# get flow directions
  flow_dir_file &lt;- tempfile("flow_dir", fileext = ".tif")
  flow_dir &lt;- ch_wbt_flow_direction(no_sink_raster_file, flow_dir_file)
  fn_catchment_ras &lt;- tempfile("catchment", fileext = ".tif")
  fn_catchment_vec &lt;- tempfile("catchment", fileext = ".shp")
  catchments &lt;- ch_wbt_catchment(snapped_pourpoint_file, flow_dir_file, 
  fn_catchment_ras, fn_catchment_vec)

# check results
  ch_checkcatchment(test_raster, catchments, snapped_pourpoints)
} else {
  message("Examples not run as Whitebox executable not found")
}
</code></pre>

<hr>
<h2 id='ch_checkchannels'>Check Channels</h2><span id='topic+ch_checkchannels'></span>

<h3>Description</h3>

<p>Generates a map of the generated channel network layer.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ch_checkchannels(
  dem,
  channels,
  outlet = NULL,
  main_label = "",
  channel_colour = "blue",
  pp_colour = "red",
  contour_colour = "grey"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ch_checkchannels_+3A_dem">dem</code></td>
<td>
<p>raster DEM that catchments were generated from</p>
</td></tr>
<tr><td><code id="ch_checkchannels_+3A_channels">channels</code></td>
<td>
<p>channel polyline (or channels list from <code>ch_wbt_channels</code>) (sf object)</p>
</td></tr>
<tr><td><code id="ch_checkchannels_+3A_outlet">outlet</code></td>
<td>
<p>location of catchment outlet (sf object)</p>
</td></tr>
<tr><td><code id="ch_checkchannels_+3A_main_label">main_label</code></td>
<td>
<p>Main label for channel plot.</p>
</td></tr>
<tr><td><code id="ch_checkchannels_+3A_channel_colour">channel_colour</code></td>
<td>
<p>Colour for channel. Default is &quot;blue&quot;.</p>
</td></tr>
<tr><td><code id="ch_checkchannels_+3A_pp_colour">pp_colour</code></td>
<td>
<p>Colour for catchment pour points. Default is &quot;red&quot;.</p>
</td></tr>
<tr><td><code id="ch_checkchannels_+3A_contour_colour">contour_colour</code></td>
<td>
<p>Colour for contours Default is &quot;grey&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generates a simple map of the drainage network plotted over the contours to allow a visual assessment.
</p>


<h3>Value</h3>

<table>
<tr><td><code>check_map</code></td>
<td>
<p>a <span class="pkg">ggplot</span> object of a map with channel layer</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Dan Moore
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ch_checkcatchment">ch_checkcatchment</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Only proceed if Whitebox executable is installed
library(whitebox)
if (check_whitebox_binary()){
  library(raster)
  test_raster &lt;- ch_volcano_raster()
  dem_raster_file &lt;- tempfile(fileext = c(".tif"))
  no_sink_raster_file &lt;- tempfile("no_sinks", fileext = c(".tif"))

  # write test raster to file
  writeRaster(test_raster, dem_raster_file, format = "GTiff")

  # remove sinks
  removed_sinks &lt;- ch_wbt_removesinks(dem_raster_file, no_sink_raster_file, method = "fill")

  # get flow accumulations
  flow_acc_file &lt;- tempfile("flow_acc", fileext = c(".tif"))
  flow_acc &lt;- ch_wbt_flow_accumulation(no_sink_raster_file, flow_acc_file)

  # get flow directions
  flow_dir_file &lt;- tempfile("flow_dir", fileext = c(".tif"))
  flow_dir &lt;- ch_wbt_flow_direction(no_sink_raster_file, flow_dir_file)
  channel_raster_file &lt;- tempfile("channels", fileext = c(".tif"))
  channel_vector_file &lt;- tempfile("channels", fileext = c(".shp"))
  channels &lt;- ch_wbt_channels(flow_acc_file, flow_dir_file, channel_raster_file,
  channel_vector_file, 1)

  # get pour points
  pourpoint_file &lt;- tempfile("volcano_pourpoints", fileext = ".shp")
  pourpoints &lt;- ch_volcano_pourpoints(pourpoint_file)
  snapped_pourpoint_file &lt;- tempfile("snapped_pourpoints", fileext = ".shp")
  snapped_pourpoints &lt;- ch_wbt_pourpoints(pourpoints, flow_acc_file, pourpoint_file,
  snapped_pourpoint_file, snap_dist = 10)
  ch_checkchannels(test_raster, channels, snapped_pourpoints)
} else {
  message("Examples not run as Whitebox executable not found")
}
</code></pre>

<hr>
<h2 id='ch_circ_mean_reg'>Calculates the circular mean, median, and regularity</h2><span id='topic+ch_circ_mean_reg'></span>

<h3>Description</h3>

<p>Calculate the circular mean, median, and regularity using a year of 365 days.
Days of year are converted to degrees
internally, results are returned as positive days of year
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ch_circ_mean_reg(dataframe)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ch_circ_mean_reg_+3A_dataframe">dataframe</code></td>
<td>
<p>a dataframe of day year of event; can be amax or pot.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list of the following statistics
</p>
<table>
<tr><td><code>n</code></td>
<td>
<p>number of samples</p>
</td></tr>
<tr><td><code>mean</code></td>
<td>
<p>circular mean of array</p>
</td></tr>
<tr><td><code>median</code></td>
<td>
<p>circular median of array</p>
</td></tr>
<tr><td><code>rho</code></td>
<td>
<p>regularity or mean resultant length</p>
</td></tr>
</table>


<h3>References</h3>

<p>Pewsey, A., M. Neuhauser, and G. D. Ruxton. 2014. Circular Statistics in R, 
192 pp., Oxford University Press.
Whitfield, P. H. 2018. Clustering of seasonal events: A simulation study using 
circular methods. Communications in Statistics - Simulation and Computation 47(10): 3008-3030.
Burn, D. H., and P. H. Whitfield. 2021*. Changes in the timing of flood events resulting 
from climate change.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ch_sh_get_amax">ch_sh_get_amax</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(CAN05AA008)
am &lt;- ch_sh_get_amax(CAN05AA008)
m_r &lt;- ch_circ_mean_reg(am)
</code></pre>

<hr>
<h2 id='ch_clear_wd'>Clear Working Directory</h2><span id='topic+ch_clear_wd'></span>

<h3>Description</h3>

<p>Empties and removes a working directory.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ch_clear_wd(wd, do_check = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ch_clear_wd_+3A_wd">wd</code></td>
<td>
<p>working directory file path</p>
</td></tr>
<tr><td><code id="ch_clear_wd_+3A_do_check">do_check</code></td>
<td>
<p>If <code>TRUE</code>, the default, the user is asked to confirm the
deletion of the working directory. If <code>TRUE</code>, the directory is deleted
without confirmation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The data for raster layers read in as Whitebox
files are held on disk rather than in memory
</p>


<h3>Value</h3>

<table>
<tr><td><code>result</code></td>
<td>
<p>returns TRUE upon successful execution</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Dan Moore
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ch_create_wd">ch_create_wd</a></code> to create working directory
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# not tested as deleting all files in the directory cannot be tested in CRAN

# create an empty working directory
my_wd &lt;- tempdir()
ch_create_wd(my_wd) # confirm creation

# clear the working directory
ch_clear_wd(my_wd)


</code></pre>

<hr>
<h2 id='ch_col_gradient'>Creates a colour gradient</h2><span id='topic+ch_col_gradient'></span>

<h3>Description</h3>

<p>Creates a colour gradient for plotting.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ch_col_gradient(
  x,
  colors = c("darkred", "red", "white", "blue", "darkblue"),
  colsteps = 100,
  climits = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ch_col_gradient_+3A_x">x</code></td>
<td>
<p>Vector of values used for gradient.</p>
</td></tr>
<tr><td><code id="ch_col_gradient_+3A_colors">colors</code></td>
<td>
<p>Vector of colours to form a gradient. Default is <code>`c("darkred", "red","white","blue", "darkblue")`</code>.</p>
</td></tr>
<tr><td><code id="ch_col_gradient_+3A_colsteps">colsteps</code></td>
<td>
<p>The number of steps in the gradient. Default is <code>100</code>.</p>
</td></tr>
<tr><td><code id="ch_col_gradient_+3A_climits">climits</code></td>
<td>
<p>Sets specific limits for common scaling.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>res</code></td>
<td>
<p>returned array of colour codes</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>modified by Paul Whitfield
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plot(rnorm(20),col='black')

# create a red blue colour gradient for plotting
mycol &lt;- ch_col_gradient(rnorm(20), colsteps = 100)

# plot more random points in transparent blue colour
points(rnorm(20), col = mycol)
</code></pre>

<hr>
<h2 id='ch_col_transparent'>Add Transparency to plot colours</h2><span id='topic+ch_col_transparent'></span>

<h3>Description</h3>

<p>Adds transparency to a colour based on an integer between 0 and 255,
with  0 being fully transparent and 255 being opaque. Based on function 
<code>rvn_col_transparent</code> in package <span class="pkg">RavenR</span>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ch_col_transparent(colour, trans)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ch_col_transparent_+3A_colour">colour</code></td>
<td>
<p>colour that is to be made transparent, or an array of colours</p>
</td></tr>
<tr><td><code id="ch_col_transparent_+3A_trans">trans</code></td>
<td>
<p>an integer (or array of integers) describing the degree of 
transparency, 0 to 255. Must be the same length as colour. Values &lt; 10 (very transparent),
values &gt; 200 (solid colour).</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>res</code></td>
<td>
<p>returned updated colour code with transparency</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Rob Chlumsky; Paul Whitfield
</p>


<h3>See Also</h3>

<p>See original code on post in Stack Overflow
<a href="http://stackoverflow.com/questions/12995683/any-way-to-make-plot-points-in-scatterplot-more-transparent-in-rmaking">
plot points transparent in R</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 # plot randomly distributed data
plot(rnorm(20), col='black')

# create a transparent blue colour for plotting
mycol &lt;- ch_col_transparent('blue', 100)

# plot more random points in transparent blue colour
points(rnorm(20),col = mycol)

 # plot randomly distributed data
plot(rnorm(20), col = 'blue')

# create two transparent colour for plotting
mycol &lt;- ch_col_transparent(c('green',"red"), c(100, 200))

# plot more random points in transparent colours
points(rnorm(20), col = mycol[2])


</code></pre>

<hr>
<h2 id='ch_color_gradient'>ch_color_gradient</h2><span id='topic+ch_color_gradient'></span>

<h3>Description</h3>

<p>set colour gradient
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ch_color_gradient(
  x,
  colors = c("darkred", "red", "white", "green", "darkgreen"),
  colsteps = 100,
  climits = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ch_color_gradient_+3A_x">x</code></td>
<td>
<p>array of variable</p>
</td></tr>
<tr><td><code id="ch_color_gradient_+3A_colors">colors</code></td>
<td>
<p>an array of colours to form the desired gradient. Default is 
(&quot;darkred&quot;, &quot;red&quot;, &quot;white&quot;, &quot;green&quot;, &quot;darkgreen&quot;)</p>
</td></tr>
<tr><td><code id="ch_color_gradient_+3A_colsteps">colsteps</code></td>
<td>
<p>number of steps to be used in gradient, default is 100.</p>
</td></tr>
<tr><td><code id="ch_color_gradient_+3A_climits">climits</code></td>
<td>
<p>provide specific limits for common scaling</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector of colors
</p>


<h3>Author(s)</h3>

<p>Paul Whitfield
</p>


<h3>Examples</h3>

<pre><code class='language-R'>cxin &lt;- c(0, 1, 1, 3, 4, 5, 10)
cxout &lt;- ch_color_gradient(cxin)
#[1] "#8B0000" "#B50000" "#B50000" "#FF2B2B" "#FF9292"
#[6] "#FFF9F9" "#006400"
</code></pre>

<hr>
<h2 id='ch_contours'>Create Contours</h2><span id='topic+ch_contours'></span>

<h3>Description</h3>

<p>Creates contour lines from a DEM.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ch_contours(dem, zmin = NULL, zmax = NULL, n_levels = 10, z_levels = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ch_contours_+3A_dem">dem</code></td>
<td>
<p>Raster object of your dem in the desired projection (note: should have had sinks removed).</p>
</td></tr>
<tr><td><code id="ch_contours_+3A_zmin">zmin</code></td>
<td>
<p>Minimum elevation value for contours. If not specified, minimum value <span class="option">dem</span> is used.</p>
</td></tr>
<tr><td><code id="ch_contours_+3A_zmax">zmax</code></td>
<td>
<p>Maximum elevation value for contours. If not specified, maximum value <span class="option">dem</span> is used.</p>
</td></tr>
<tr><td><code id="ch_contours_+3A_n_levels">n_levels</code></td>
<td>
<p>Number of contour lines. Default is 10.</p>
</td></tr>
<tr><td><code id="ch_contours_+3A_z_levels">z_levels</code></td>
<td>
<p>Levels at which to plot contours. If specified, overrides <span class="option">zmin</span>, <span class="option">zmax</span> and
<span class="option">n_levels</span>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generates contour lines from a DEM, which are returned as an <span class="pkg">sf</span> object. 
The user can either provide a vector of elevation values by specifying the <code>z_levels</code> argument, 
or by supplying the minimum and maximum elevations (<code>zmin</code> and <code>zmax</code>) 
and the number of contour lines (<code>n_levels</code>).
</p>


<h3>Value</h3>

<table>
<tr><td><code>contours_sf</code></td>
<td>
<p>sf object containing contours</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Dan Moore
</p>


<h3>Examples</h3>

<pre><code class='language-R'># use volcano DEM
dem &lt;- ch_volcano_raster()
# generate contours
contours &lt;- ch_contours(dem)

# plot contours map
plot(contours)

</code></pre>

<hr>
<h2 id='ch_create_wd'>Create working directory</h2><span id='topic+ch_create_wd'></span>

<h3>Description</h3>

<p>Creates a working directory.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ch_create_wd(wd)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ch_create_wd_+3A_wd">wd</code></td>
<td>
<p>name of a directory in which to store files created by WhiteboxTools functions</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>TRUE</code></td>
<td>
<p>returns <code>TRUE</code> upon successful execution</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Dan Moore
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ch_clear_wd">ch_clear_wd</a></code> to clear the working directory
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# not tested automatically as will return a warning
ch_create_wd(tempdir())

</code></pre>

<hr>
<h2 id='ch_cut_block'>Extracts a specified time period from a longer record</h2><span id='topic+ch_cut_block'></span>

<h3>Description</h3>

<p>The function could also be used to get the same period of time from several station for comparison.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ch_cut_block(DF, st_date, end_date)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ch_cut_block_+3A_df">DF</code></td>
<td>
<p>A daily streamflow data frame as from <code>ch_read_ECDE_flows</code></p>
</td></tr>
<tr><td><code id="ch_cut_block_+3A_st_date">st_date</code></td>
<td>
<p>starting date format is %Y/%m/%d</p>
</td></tr>
<tr><td><code id="ch_cut_block_+3A_end_date">end_date</code></td>
<td>
<p>ending date format is %Y/%m/%d</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a portion of the original dataframe.
</p>


<h3>Author(s)</h3>

<p>Paul Whitfield
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(CAN05AA008)
subset &lt;- ch_cut_block(CAN05AA008,"2000/01/01", "2010/12/31")
</code></pre>

<hr>
<h2 id='ch_date_subset'>Subsets dates by string</h2><span id='topic+ch_date_subset'></span>

<h3>Description</h3>

<p>Subsets a data frame by an specified date range, provided as
a string by the <code>prd</code> argument. This function is meant to emulate the subsetting
capability of the <span class="pkg">xts</span> package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ch_date_subset(df, prd)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ch_date_subset_+3A_df">df</code></td>
<td>
<p>data frame of time series data; includes a variable called <code>Date</code></p>
</td></tr>
<tr><td><code id="ch_date_subset_+3A_prd">prd</code></td>
<td>
<p>date range as string formatted as <span class="option">YYYY-MM-DD/YYYY-MM-DD</span></p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>df</code></td>
<td>
<p>subsetted data frame</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Robert Chlumsky
</p>


<h3>Examples</h3>

<pre><code class='language-R'>{
dd &lt;- seq.Date(as.Date("2010-10-01"), as.Date("2013-09-30"), by = 1)
x &lt;- rnorm(length(dd))
y &lt;- abs(rnorm(length(dd)))*2
df &lt;- data.frame("Date" = dd,x,y)
prd &lt;- "2011-10-01/2012-09-30"
summary(ch_date_subset(df,prd))}

</code></pre>

<hr>
<h2 id='ch_decades_plot'>Plots output from ch_binned_MannWhitney for decades</h2><span id='topic+ch_decades_plot'></span>

<h3>Description</h3>

<p>Creates a simple plot comparing two decades from the 
output of <code>ch_binned_MannWhitney</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ch_decades_plot(mplot)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ch_decades_plot_+3A_mplot">mplot</code></td>
<td>
<p>List output by the function <code>ch_binned_MannWhitney</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A standard <span class="rlang"><b>R</b></span> graphic is created.
</p>


<h3>Author(s)</h3>

<p>Paul Whitfield
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ch_decades_plot">ch_decades_plot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>range1 &lt;- c(1970, 1979)
range2 &lt;- c(1990, 1999)
b_MW &lt;- ch_binned_MannWhitney(CAN05AA008, step = 5, range1, range2, ptest = 0.05)
ch_decades_plot(b_MW)
</code></pre>

<hr>
<h2 id='ch_doys'>Days of year and water year</h2><span id='topic+ch_doys'></span>

<h3>Description</h3>

<p>Converts an array of dates into a dataframe with date, year, month, doy,
wyear, dowy. 
</p>
<p>The day of water year is computed from the first of the specified water year month.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ch_doys(Date, water_yr = 10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ch_doys_+3A_date">Date</code></td>
<td>
<p>an array of <span class="rlang"><b>R</b></span> dates, as produced by <code>as.Date()</code></p>
</td></tr>
<tr><td><code id="ch_doys_+3A_water_yr">water_yr</code></td>
<td>
<p>the month starting the water year, default is 10 (October). If
a value of <code>1</code> is specified, the <code>10</code> will be used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Converts a date array into a data frame with years, wateryears, and days of year and of water year.
</p>


<h3>Value</h3>

<p>Returns a dataframe with date information:
</p>
<table>
<tr><td><code>Date</code></td>
<td>
<p>in Date format</p>
</td></tr>
<tr><td><code>year</code></td>
<td>
<p>numeric calendar year</p>
</td></tr>
<tr><td><code>month</code></td>
<td>
<p>number calendar month</p>
</td></tr>
<tr><td><code>doy</code></td>
<td>
<p>numeric day of year</p>
</td></tr>
<tr><td><code>wyear</code></td>
<td>
<p>numeric water year starting on day 1 of selected month</p>
</td></tr>
<tr><td><code>dwy</code></td>
<td>
<p>numeric day of water year</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Paul Whitfield, Kevin Shook
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dd &lt;- seq.Date(as.Date("2010-01-01"), as.Date("2018-01-01"),by = 1)
output &lt;- ch_doys(dd, water_yr=10)
head(output)

</code></pre>

<hr>
<h2 id='ch_fdcurve'>Plot Flow Duration Curve</h2><span id='topic+ch_fdcurve'></span>

<h3>Description</h3>

<p>A flow duration curve is a plot of flow magnitude against exceedance probability. 
The plot may contain the Gustard Curves (default) or they can be omitted. The default is for curves to be 
plotted against probability, but an option is to plot against the normalized exceedance probability. 
In that case, the x axis represents a normal distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ch_fdcurve(DF, normal = FALSE, gust = TRUE, metadata = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ch_fdcurve_+3A_df">DF</code></td>
<td>
<p>a dataframe of daily flows from <code>ch_read_ECDE_flows</code></p>
</td></tr>
<tr><td><code id="ch_fdcurve_+3A_normal">normal</code></td>
<td>
<p>If <code>normal = TRUE</code> then exceedance probability is normalized. Default is FALSE.</p>
</td></tr>
<tr><td><code id="ch_fdcurve_+3A_gust">gust</code></td>
<td>
<p>If <code>TRUE</code> (the default), adds the curves from Gustard et al. 1992 are added.</p>
</td></tr>
<tr><td><code id="ch_fdcurve_+3A_metadata">metadata</code></td>
<td>
<p>dataframe of metadata, defaults to HYDAT_list.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Create a Flow Duration Curve based upon Observations.
</p>


<h3>Value</h3>

<p>Plots the flow duration curve and returns a data frame containing:
</p>
<table>
<tr><td><code>exceedance probability</code></td>
<td>
<p>probability</p>
</td></tr>
<tr><td><code>flow</code></td>
<td>
<p>d=flow values</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Paul Whitfield
</p>


<h3>References</h3>

<p>Gustard, A., A. Bullock, and J.M. Dixon. 1992. Low flow estimation in the United Kingdom. 
Institute of Hydrology, 292. Wallingford: Institute of Hydrology.
</p>
<p>Vogel, R.M., and N.M. Fennessy. 1994. Flow-duration curves. I: New Interpretation and 
confidence intervals. Journal of Water Resources Planning and Management ASCE 120:485-504.
</p>
<p>Vogel, R.M., and N.M. Fennessy. 1995. Flow duration curves II: A review of applications 
in water resources planning. Water Resources Bulletin 31:1030-9.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(HYDAT_list)
data(CAN05AA008)
# plot with Gustard 1992 curves
test &lt;- ch_fdcurve(CAN05AA008, normal = FALSE, gust = TRUE)
# plot with normalized exceedance probability
test &lt;- ch_fdcurve(CAN05AA008, normal = TRUE, gust = FALSE)

</code></pre>

<hr>
<h2 id='ch_flow_raster'>Raster plot of daily streamflows</h2><span id='topic+ch_flow_raster'></span>

<h3>Description</h3>

<p>Produces a raster plot: years by day of year, showing magnitude of flow. 
This produces a plot showing the flow data in colours, showing different context than in
a hydrograph. High flows are in warm colours.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ch_flow_raster(
  DF,
  rastercolours = c("lightblue", "cyan", "blue", "slateblue", "orange", "red"),
  metadata = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ch_flow_raster_+3A_df">DF</code></td>
<td>
<p>A data frame of daily flow data as read by <code>ch_read_ECDE_flows</code>.</p>
</td></tr>
<tr><td><code id="ch_flow_raster_+3A_rastercolours">rastercolours</code></td>
<td>
<p>A vector of colours used for flow magnitudes (default <code>c("lightblue","cyan", "blue", "slateblue", "orange", "red")</code>).</p>
</td></tr>
<tr><td><code id="ch_flow_raster_+3A_metadata">metadata</code></td>
<td>
<p>A dataframe of station metadata, defaults to <code>HYDAT_list</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No value is returned; a standard R graphic is created.
</p>


<h3>Author(s)</h3>

<p>Paul Whitfield
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ch_read_ECDE_flows">ch_read_ECDE_flows</a></code>
</p>
<p><code><a href="#topic+ch_flow_raster_trend">ch_flow_raster_trend</a></code> <code><a href="#topic+ch_flow_raster_qa">ch_flow_raster_qa</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ch_flow_raster(CAN05AA008)

</code></pre>

<hr>
<h2 id='ch_flow_raster_qa'>Raster plot of daily streamflows with WSC quality flags</h2><span id='topic+ch_flow_raster_qa'></span>

<h3>Description</h3>

<p>Raster plot with WSC quality flags. 
This produces a plot showing the flow data in grayscale 
overlain by the Water Survey of Canada quality flags.  Colours are consistent with 
ECDataExplorer. Raster layout lets the use see the flags in a different context than in 
a hydrograph.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ch_flow_raster_qa(DF, metadata = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ch_flow_raster_qa_+3A_df">DF</code></td>
<td>
<p>dataframe of daily streamflow read by ch_read_ECDE_flows</p>
</td></tr>
<tr><td><code id="ch_flow_raster_qa_+3A_metadata">metadata</code></td>
<td>
<p>dataframe of metadata or defaults to &quot;HYDAT_list&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Produces a raster plot: years against day of year, showing the data flags:
</p>
<table>
<tr><td><code>A</code></td>
<td>
<p>(Partial)  in green</p>
</td></tr>
<tr><td><code>B</code></td>
<td>
<p>(Backwater) in cyan</p>
</td></tr>
<tr><td><code>D</code></td>
<td>
<p>(Dry) in yellow</p>
</td></tr>
<tr><td><code>E</code></td>
<td>
<p>(Estimated) in red</p>
</td></tr>
</table>
<p>Returns <code>TRUE</code> if executed properly; a standard R graphic is created.
</p>


<h3>Author(s)</h3>

<p>Paul Whitfield
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ch_read_ECDE_flows">ch_read_ECDE_flows</a></code>
</p>
<p><code><a href="#topic+ch_flow_raster_trend">ch_flow_raster_trend</a></code> <code><a href="#topic+ch_flow_raster">ch_flow_raster</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(HYDAT_list)
data(CAN05AA008)
qaplot &lt;- ch_flow_raster_qa(CAN05AA008)

</code></pre>

<hr>
<h2 id='ch_flow_raster_trend'>Raster plot and simple trends of observed streamflows by periods</h2><span id='topic+ch_flow_raster_trend'></span>

<h3>Description</h3>

<p>Creates a raster plot plus trend plots for day of year, 
which are binned by a number of days (step),
and the max, min, and median annual discharge across years. The plot contains four panels based upon binned data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ch_flow_raster_trend(
  DF,
  step = 5,
  missing = FALSE,
  metadata = NULL,
  colours = c("lightblue", "cyan", "blue", "slateblue", "darkblue", "red")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ch_flow_raster_trend_+3A_df">DF</code></td>
<td>
<p>- dataframe of daily flow data as read by ch_read_ECDE_flows</p>
</td></tr>
<tr><td><code id="ch_flow_raster_trend_+3A_step">step</code></td>
<td>
<p>- a number indicating the degree of smoothing eg. 1, 5, 11.</p>
</td></tr>
<tr><td><code id="ch_flow_raster_trend_+3A_missing">missing</code></td>
<td>
<p>If <code>FALSE</code> years with missing data are excluded. 
If <code>TRUE</code> partial years are included.</p>
</td></tr>
<tr><td><code id="ch_flow_raster_trend_+3A_metadata">metadata</code></td>
<td>
<p>a dataframe of station metadata, default is HYDAT_list.</p>
</td></tr>
<tr><td><code id="ch_flow_raster_trend_+3A_colours">colours</code></td>
<td>
<p>A vector of colours used for the raster plot. 
The default is <code>c("lightblue","cyan", "blue", "slateblue", 
"darkblue", "red")</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The four plots are: (1) The maximum,minimum,and median flow with a trend test for each 
period: red arrows indicate decreases, blue arrows indicate increases.
(2) The scale bar for the colours used in the raster plot,
(3) The raster plot with a colour for each period and each year where data exist, and
(4) A time series plot of the minimum, median, and maximum annual bin values.
If there is no trend (p &gt; 0.05) the points are black. Decreasing trends are in red, increasing trends are in blue.
</p>


<h3>Value</h3>

<p>Returns a list containing:
</p>
<table>
<tr><td><code>stationID</code></td>
<td>
<p>Station ID eg. 05BB001</p>
</td></tr>
<tr><td><code>missing</code></td>
<td>
<p>How missing values were used FALSE = used, TRUE = removed</p>
</td></tr>
<tr><td><code>step</code></td>
<td>
<p>number of days in a bin</p>
</td></tr>
<tr><td><code>periods</code></td>
<td>
<p>number of periods in a year</p>
</td></tr>
<tr><td><code>period</code></td>
<td>
<p>period numbers i.e. 1:365/step</p>
</td></tr>
<tr><td><code>bins</code></td>
<td>
<p>values for each period in each year</p>
</td></tr>
<tr><td><code>med_period</code></td>
<td>
<p>median for each period</p>
</td></tr>
<tr><td><code>max_period</code></td>
<td>
<p>maximum for each period</p>
</td></tr>
<tr><td><code>min_period</code></td>
<td>
<p>minimum for each period</p>
</td></tr>
<tr><td><code>tau_period</code></td>
<td>
<p>Kendalls Tau for each period</p>
</td></tr>
<tr><td><code>prob_period</code></td>
<td>
<p>probability of Tau for each period</p>
</td></tr>
<tr><td><code>year</code></td>
<td>
<p>years spanning the data</p>
</td></tr>
<tr><td><code>median_year</code></td>
<td>
<p>median bin for each year</p>
</td></tr>
<tr><td><code>max_year</code></td>
<td>
<p>maximum bin for each year</p>
</td></tr>
<tr><td><code>min_year</code></td>
<td>
<p>minimum bin for each year</p>
</td></tr>
<tr><td><code>tau_median_year</code></td>
<td>
<p>value of tau and probability for annual median</p>
</td></tr>
<tr><td><code>tau_maximum_year</code></td>
<td>
<p>value of tau and probability for annual maximum</p>
</td></tr>
<tr><td><code>tau_minimum_year</code></td>
<td>
<p>value of tau and probability for annual minimum</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Paul Whitfield
</p>


<h3>References</h3>

<p>Whitfield, P. H., Kraaijenbrink, P. D. A., Shook, K. R., and Pomeroy, J. W. 2021.
The Spatial Extent of Hydrological and Landscape Changes across the Mountains and Prairies 
of Canada in the Mackenzie and Nelson River Basins Based on data from a Warm Season Time Window, 
Hydrology and Earth Systems Sciences 25: 2513-2541.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ch_flow_raster">ch_flow_raster</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> data(CAN05AA008)
 mplot &lt;- ch_flow_raster_trend(CAN05AA008, step=5)

</code></pre>

<hr>
<h2 id='ch_get_ECDE_metadata'>Reads Environment Canada Date Explorer (ECDE) meta data file</h2><span id='topic+ch_get_ECDE_metadata'></span>

<h3>Description</h3>

<p>Reads the file that is generated from ECDE 'save favourite stations' to capture the ECDE metadata. 
The dataframe returned contains 20 fields from ECDE.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ch_get_ECDE_metadata(filename, writefile = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ch_get_ECDE_metadata_+3A_filename">filename</code></td>
<td>
<p>The name of the ECDE file, <span class="option">FavHydatStations.tb0</span>.</p>
</td></tr>
<tr><td><code id="ch_get_ECDE_metadata_+3A_writefile">writefile</code></td>
<td>
<p>Default is <code>NULL</code>, but if it is a filename e.g. <span class="option">filename.csv</span> 
then the dataframe is saved to a csv file.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a dataframe consisting of:
</p>
<table>
<tr><td><code>Station</code></td>
<td>
<p>StationID</p>
</td></tr>
<tr><td><code>StationName</code></td>
<td>
<p>Station Name</p>
</td></tr>
<tr><td><code>HYDStatus</code></td>
<td>
<p>Active or Discontinued</p>
</td></tr>
<tr><td><code>Prov</code></td>
<td>
<p>Province</p>
</td></tr>
<tr><td><code>Latitude</code></td>
<td>
</td></tr>
<tr><td><code>Longitude</code></td>
<td>
</td></tr>
<tr><td><code>DrainageArea</code></td>
<td>
<p>km<code class="reqn">^2</code></p>
</td></tr>
<tr><td><code>Years</code></td>
<td>
<p>Number of years with data</p>
</td></tr>
<tr><td><code>From</code></td>
<td>
<p>Start Year</p>
</td></tr>
<tr><td><code>To</code></td>
<td>
<p>End Year</p>
</td></tr>
<tr><td><code>Reg.</code></td>
<td>
<p>Regulated?</p>
</td></tr> 
<tr><td><code>Flow</code></td>
<td>
<p>If TRUE/Yes flow data exists</p>
</td></tr>
<tr><td><code>Level</code></td>
<td>
<p>If TRUE/Yes level data exists</p>
</td></tr>
<tr><td><code>Sed</code></td>
<td>
<p>If TRUE/Yes sediment data exists</p>
</td></tr>
<tr><td><code>OperSched</code></td>
<td>
<p>Operations current - Continuous or Seasonal</p>
</td></tr>
<tr><td><code>RealTime</code></td>
<td>
<p>If TRUE/Yes real time data is available</p>
</td></tr>
<tr><td><code>RHBN</code></td>
<td>
<p>If TRUE/Yes the stations is in the reference hydrologic basin network</p>
</td></tr>
<tr><td><code>Region</code></td>
<td>
<p>Name of regional office operating station</p>
</td></tr>
<tr><td><code>Datum</code></td>
<td>
<p>Elevation datum</p>
</td></tr>
<tr><td><code>Operator</code></td>
<td>
<p>Operator or provider of the data</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Paul Whitfield &lt;paul.h.whitfield@gmail.com&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Don't run this example as it requires an ECDE file
filename &lt;- "FavHydatStations.tb0"        # dummy file name (not supplied)
meta0 &lt;- ch_get_ECDE_metadata(filename)
meta1 &lt;- ch_get_ECDE_metadata(filename, writefile="study52_metadata.csv")

## End(Not run)
</code></pre>

<hr>
<h2 id='ch_get_map_base'>ch_get_map_base</h2><span id='topic+ch_get_map_base'></span>

<h3>Description</h3>

<p>Prepares for mapping by acquiring the base map and ancillary data: 
boundaries and rivers.  The maps are obtained using OpenStreetMap::openmap which 
originally accessed the following map types:
&quot;osm&quot;, &quot;osm-bw&quot;, &quot;maptoolkit-topo&quot;, &quot;waze&quot;, &quot;bing&quot;, &quot;stamen-toner&quot;, 
&quot;stamen-terrain&quot;, &quot;stamen-watercolor&quot;, &quot;osm-german&quot;, &quot;osm-wanderreitkarte&quot;, 
&quot;mapbox&quot;, &quot;esri&quot;, &quot;esri-topo&quot;, &quot;nps&quot;, &quot;apple-iphoto&quot;, &quot;skobbler&quot;, 
&quot;hillshade&quot;, &quot;opencyclemap&quot;, &quot;osm-transport&quot;, &quot;osm-public-transport&quot;, 
&quot;osm-bbike&quot;, &quot;osm-bbike-german&quot;.
</p>
<p>In April 2022 access all of these failed, limiting the available 
maps to: one of &quot;osm&quot;, &quot;bing&quot;, &quot;stamen-toner&quot;,
&quot;stamen-terrain&quot;, &quot;stamen-watercolor&quot;, &quot;apple-iphoto&quot;, &quot;opencyclemap&quot;,
&quot;osm-transport&quot;, &quot;osm-public-transport&quot;.
</p>
<p>In January 2023, ne_download failed as it produced an incorrect url.
</p>
<p>Access to &quot;nps&quot; [default] was added as a work around until OpenstreetMap is updated.
</p>
<p>&quot;nps&quot;: This layer presents the U.S. National Park Service (NPS) Natural Earth 
physical map at 1.24km per pixel for the world and 500m for the coterminous 
United States.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ch_get_map_base(
  maplat,
  maplong,
  map_proj = NA,
  map_directory = ".",
  map_type = "nps"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ch_get_map_base_+3A_maplat">maplat</code></td>
<td>
<p>vector of latitudes (2)</p>
</td></tr>
<tr><td><code id="ch_get_map_base_+3A_maplong">maplong</code></td>
<td>
<p>vector of longitudes (2)</p>
</td></tr>
<tr><td><code id="ch_get_map_base_+3A_map_proj">map_proj</code></td>
<td>
<p>map projection currently NA/&quot;latlong&quot; or &quot;albers&quot;/&quot;equalarea&quot;</p>
</td></tr>
<tr><td><code id="ch_get_map_base_+3A_map_directory">map_directory</code></td>
<td>
<p>directory where map data will be stored; will be 
created if it does not exist.</p>
</td></tr>
<tr><td><code id="ch_get_map_base_+3A_map_type">map_type</code></td>
<td>
<p>map type: select one of  <span class="option">osm</span>,  <span class="option">bing</span>,
<span class="option">stamen-toner</span>, <span class="option">stamen-terrain</span>, <span class="option">stamen-watercolor</span>,
<span class="option">apple-iphoto</span>, <span class="option">opencyclemap</span>, <span class="option">osm-transport</span>,
<span class="option">osm-public-transport</span>, <span class="option">nps [default]</span>,</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list containing:
</p>

<dl>
<dt>map_d</dt><dd><p>map data directory</p>
</dd>
<dt>plines10</dt><dd><p>provincial and state boundaries</p>
</dd>
<dt>rlines10</dt><dd><p>rivers and lakes</p>
</dd>
<dt>map_proj</dt><dd><p>projection used</p>
</dd>
<dt>latitude</dt><dd><p>bottom and top latitudes</p>
</dd>
<dt>longitude</dt><dd><p>east and west longitudes</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Paul Whitfield
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Note: example not tested automatically as it is very slow to execute due to the downloading
latitude &lt;- c(48.0,  61.0)
longitude &lt;- c(-110.0, -128.5)
mapdir &lt;- tempdir()
# get map data
m_map &lt;- ch_get_map_base(latitude,longitude, 
                     map_proj = "Albers", 
                     map_directory = mapdir, 
                     map_type = "nps")
                      
</code></pre>

<hr>
<h2 id='ch_get_peaks'>Extracts peak flows over a threshold</h2><span id='topic+ch_get_peaks'></span>

<h3>Description</h3>

<p>This function is development code being shared as is. It is expected that the user will be interested in the
data frame returned for POT analysis and for plotting (i.e. ch_booth_plot).
</p>
<p>This function retrieves peaks greater than or equal to the prescribed threshold.  It returns a data frame of peak characteristics
suitable for subsequent analysis.
</p>
<p>The portion under development is returns a list of the flows during an event with the values of the four
preceding days and three subsequent days. If the peak is a single point the fragment is nine points long; if the events is longer 
the fragment contains all days above the threshold and eight additional days.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ch_get_peaks(dataframe, threshold)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ch_get_peaks_+3A_dataframe">dataframe</code></td>
<td>
<p>a data frame of streamflow data containing columns named <span class="option">Date</span> and <span class="option">Flow</span></p>
</td></tr>
<tr><td><code id="ch_get_peaks_+3A_threshold">threshold</code></td>
<td>
<p>a value for the threshold. Values above the threshold are tested for peaks.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list containing:
</p>
<table>
<tr><td><code>POTevents</code></td>
<td>
<p>a dataframe contining details of the events</p>
</td></tr>
<tr><td><code>events</code></td>
<td>
<p>a vector with the value 0 when the flow is below the threshold and 1 when above.</p>
</td></tr>
<tr><td><code>event_num</code></td>
<td>
<p>a vector with the value 0 when the flow is below a threshold or the index of the events when the threshold was exceeded. i.e. 1,2,3, etc</p>
</td></tr>
<tr><td><code>st_date</code></td>
<td>
<p>start date of events</p>
</td></tr>
<tr><td><code>case</code></td>
<td>
<p>a list of the daily flows in each individual event (see details for more information)</p>
</td></tr>
</table>
<p>The <code>POTevents</code> data frame contains five columns: 
</p>
<table>
<tr><td><code>st_date</code></td>
<td>
<p>starting date of event</p>
</td></tr>
<tr><td><code>max_date</code></td>
<td>
<p>date of maximum in the event</p>
</td></tr>
<tr><td><code>max</code></td>
<td>
<p>maximum discharge during event</p>
</td></tr>
<tr><td><code>volume</code></td>
<td>
<p>flow volume during the event</p>
</td></tr>
<tr><td><code>duration</code></td>
<td>
<p>length of the event in days</p>
</td></tr>
</table>
<p>The <code>case</code> list contains the flows during an event and also for four preceding and subsequent days. Each event will have
a length between nine to n days in length. Note: in rare cases where the event is in progress when data becomes available the 
event might be shorter than nine days long.
</p>


<h3>Author(s)</h3>

<p>Paul Whitfield
</p>


<h3>References</h3>

<p>Burn, D.H., Whitfield, P.H., Sharif, M., 2016. Identification of changes in floods and flood regimes
in Canada using a peaks over threshold approach. Hydrological Processes, 39: 3303-3314. DOI:10.1002/hyp.10861
</p>
<p>Whitfield, P.H., and J.W. Pomeroy. 2016. Changes to flood peaks of a mountain river: implications
for analysis of the 2013 flood in the Upper Bow River, Canada. Hydrological Processes 30:4657-73. doi:
10.1002/hyp.10957.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ch_booth_plot">ch_booth_plot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>CAN05AA008 &lt;- CAN05AA008
threshold &lt;- 0.5*max(CAN05AA008$Flow)  # arbitrary threshold
my_peaks &lt;- ch_get_peaks(CAN05AA008, threshold)
str(my_peaks)
</code></pre>

<hr>
<h2 id='ch_get_url_data'>Gets remote data sets</h2><span id='topic+ch_get_url_data'></span>

<h3>Description</h3>

<p>Accesses data sets, via a url the first time,
saves them locally, then accesses them locally after the first time the script is executed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ch_get_url_data(gd_url, gd_filename, quiet = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ch_get_url_data_+3A_gd_url">gd_url</code></td>
<td>
<p>url for accessing data set</p>
</td></tr>
<tr><td><code id="ch_get_url_data_+3A_gd_filename">gd_filename</code></td>
<td>
<p>name of file on local drive, including full path</p>
</td></tr>
<tr><td><code id="ch_get_url_data_+3A_quiet">quiet</code></td>
<td>
<p>Optional. If <code>FALSE</code> (the default) error/warning messages are printed if the data cannot be found.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a data frame (from a .csv file), a <code>raster</code> object (from a .tif file), 
or an <code>sf</code> object (from a GeoJSON file).
</p>


<h3>Author(s)</h3>

<p>Dan Moore
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Example not tested automatically as multiple large data files are downloaded which is slow

# Tested using files in the Upper Penticton Creek
# zenodo repository https://zenodo.org/record/4781469
library(ggplot2)
library(raster)

# create directory to store data sets
dir_name &lt;- tempdir(check = FALSE)
if (!dir.exists(dir_name)) {
  dir.create(dir_name)
}
 
# test with soil moisture data in csv format
sm_fn &lt;- file.path(dir_name, "sm_data.csv")
sm_url &lt;- "https://zenodo.org/record/4781469/files/sm_data.csv"
sm_data &lt;- ch_get_url_data(sm_url, sm_fn)
head(sm_data)

# test with tif/tiff file containing a dem
ra_fn &lt;- file.path(dir_name, "gs_dem25.tif")
ra_url &lt;- "https://zenodo.org/record/4781469/files/gs_dem25.tif"
ra_data &lt;- ch_get_url_data(ra_url, ra_fn)
plot(ra_data)

# test with GeoJSON
gs_fn &lt;- file.path(dir_name, "gs_soilmaps.GeoJSON")
gs_url &lt;- "https://zenodo.org/record/4781469/files/gs_soilmaps.GeoJSON"
gs_data &lt;- ch_get_url_data(gs_url, gs_fn)

ggplot(gs_data) +
  geom_sf(aes(fill = new_key)) +
  labs(fill = "Soil class",
       x = "UTM Easting (m)",
       y = "UTM Northing (m)") +
  coord_sf(datum = 32611) +
  theme_bw()

</code></pre>

<hr>
<h2 id='ch_get_wscstation'>Reads station information from a data file produced by ECDE</h2><span id='topic+ch_get_wscstation'></span>

<h3>Description</h3>

<p>Retrieves station information for an individual Water Survey of Canada site, based on stationID; 
adds a text string at position 21 that combines key elements for a title.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ch_get_wscstation(stnID, metadata = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ch_get_wscstation_+3A_stnid">stnID</code></td>
<td>
<p>A Water Survey of Canada station number</p>
</td></tr>
<tr><td><code id="ch_get_wscstation_+3A_metadata">metadata</code></td>
<td>
<p>a data frame of station information from ECDataExplorer. The data frame <span class="option">HYDAT_list</span> is supplied with this package.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a line from a data frame with 21 variables
</p>
<table>
<tr><td><code>Station</code></td>
<td>
<p>StationID</p>
</td></tr>
<tr><td><code>StationName</code></td>
<td>
<p>Station Name</p>
</td></tr>
<tr><td><code>HYDStatus</code></td>
<td>
<p>Active or Discontinued</p>
</td></tr>
<tr><td><code>Prov</code></td>
<td>
<p>Province</p>
</td></tr>
<tr><td><code>Latitude</code></td>
<td>
</td></tr>
<tr><td><code>Longitude</code></td>
<td>
</td></tr>
<tr><td><code>DrainageArea</code></td>
<td>
<p>Area in km<code class="reqn">^2</code></p>
</td></tr>
<tr><td><code>Years</code></td>
<td>
<p># of years with data</p>
</td></tr>
<tr><td><code>From</code></td>
<td>
<p>Start Year</p>
</td></tr>
<tr><td><code>To</code></td>
<td>
<p>End Year</p>
</td></tr>
<tr><td><code>Reg.</code></td>
<td>
<p>Regulated or natural</p>
</td></tr>
<tr><td><code>Flow</code></td>
<td>
<p>if TRUE/Yes flow data is available</p>
</td></tr>
<tr><td><code>Level</code></td>
<td>
<p>if TRUE/Yes water level data is available</p>
</td></tr>
<tr><td><code>Sed</code></td>
<td>
<p>if TRUE/Yes sediment data is available</p>
</td></tr>
<tr><td><code>OperSched</code></td>
<td>
<p>Current operation schedule- Continuous or Seasonal</p>
</td></tr>
<tr><td><code>RealTime</code></td>
<td>
<p>if TRUE/Yes real itme data exists</p>
</td></tr>
<tr><td><code>RHBN</code></td>
<td>
<p>if TRUE/Yes is in the reference hydrologic basin network</p>
</td></tr>
<tr><td><code>Region</code></td>
<td>
<p>WSC Region</p>
</td></tr>
<tr><td><code>Datum</code></td>
<td>
<p>Datum used</p>
</td></tr>
<tr><td><code>Operator</code></td>
<td>
<p>Agency responsible for collecting data</p>
</td></tr>
<tr><td><code>Station_lname</code></td>
<td>
<p>Added field combining StationID, StationName, Province and if station is RHBN an * is added</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Paul Whitfield
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("HYDAT_list")
s_info &lt;- ch_get_wscstation("05BB001", metadata = HYDAT_list)
title &lt;- s_info[21]
print(title)

</code></pre>

<hr>
<h2 id='ch_hydrograph_plot'>Hydrograph plot</h2><span id='topic+ch_hydrograph_plot'></span>

<h3>Description</h3>

<p>Creates a hydrograph plot for simulated, observed, and inflow
hydrograph series, including precipitation if provided. The secondary y axis 
will be used to plot the precip time series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ch_hydrograph_plot(
  flows = NULL,
  precip = NULL,
  prd = NULL,
  winter_shading = FALSE,
  winter_colour = "cyan",
  range_mult_flow = NULL,
  range_mult_precip = 1.5,
  flow_labels = NULL,
  ylabel = NULL,
  precip_label = "Precipitation [mm]",
  leg_pos = NULL,
  leg_box = NULL,
  zero_axis = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ch_hydrograph_plot_+3A_flows">flows</code></td>
<td>
<p>data frame of flows to plot</p>
</td></tr>
<tr><td><code id="ch_hydrograph_plot_+3A_precip">precip</code></td>
<td>
<p>data frame of precipitation values to plot</p>
</td></tr>
<tr><td><code id="ch_hydrograph_plot_+3A_prd">prd</code></td>
<td>
<p>period to use in plotting</p>
</td></tr>
<tr><td><code id="ch_hydrograph_plot_+3A_winter_shading">winter_shading</code></td>
<td>
<p>optionally adds a transparent cyan shading for the
December 1st to March 31st period in each year that is plotted. Default is
<code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="ch_hydrograph_plot_+3A_winter_colour">winter_colour</code></td>
<td>
<p>colour to use in winter shading polygons</p>
</td></tr>
<tr><td><code id="ch_hydrograph_plot_+3A_range_mult_flow">range_mult_flow</code></td>
<td>
<p>range multiplier for max value in hydrograph. This is 
useful in preventing overlap if precip is also plotted. This value should not 
be less than 1.0, otherwise the values will be
cutoff in the plot.</p>
</td></tr>
<tr><td><code id="ch_hydrograph_plot_+3A_range_mult_precip">range_mult_precip</code></td>
<td>
<p>range multiplier for max value in precipitation plot (default 1.5)</p>
</td></tr>
<tr><td><code id="ch_hydrograph_plot_+3A_flow_labels">flow_labels</code></td>
<td>
<p>string vector of labels for flow values</p>
</td></tr>
<tr><td><code id="ch_hydrograph_plot_+3A_ylabel">ylabel</code></td>
<td>
<p>text label for y-axis of the plot (default 'Flow [m^3/s]')</p>
</td></tr>
<tr><td><code id="ch_hydrograph_plot_+3A_precip_label">precip_label</code></td>
<td>
<p>text label for precipitation y-axis (default 'Precipitation [mm]')</p>
</td></tr>
<tr><td><code id="ch_hydrograph_plot_+3A_leg_pos">leg_pos</code></td>
<td>
<p>string specifying legend placement on plot e.g. <span class="option">topleft</span>,
<span class="option">right</span>, etc., and is consistent with the legend function options. If <code>NULL</code>, 
the function will place the legend left, if precip added, on the topleft
otherwise).</p>
</td></tr>
<tr><td><code id="ch_hydrograph_plot_+3A_leg_box">leg_box</code></td>
<td>
<p>boolean on whether to put legend in an opaque white box
or not. If <code>NULL</code> (the default), the function will automatically not use a white box
and leave the background of the legend transparent.</p>
</td></tr>
<tr><td><code id="ch_hydrograph_plot_+3A_zero_axis">zero_axis</code></td>
<td>
<p>fixes the y axis to start exactly at zero (default <code>TRUE</code>). 
By default, R will plot the values with a
small buffer for presentation. Be warned that if this option is set to
TRUE, the minimum value is set to zero without checking if any flow values
are less than zero. This option should not be used for reservoir stage plotting, since
most reservoir stage is typically reported as an elevation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Assumes that the supplied time series have the same length and
duration in time. If this is not true, then the defined period or period
calculated from the first available flow series will be used to determine
the plotting limits in time. The supplied time series should be in <span class="pkg">xts</span> format.
Note that a plot title is purposely omitted in order to allow the automatic
generation of plot titles.
</p>


<h3>Value</h3>

<p>Returns <code>TRUE</code> if the function is executed properly.
</p>


<h3>Author(s)</h3>

<p>Robert Chlumsky
</p>


<h3>Examples</h3>

<pre><code class='language-R'># example with synthetic random data
dd &lt;- seq.Date(as.Date("2010-10-01"), as.Date("2013-09-30"),by = 1)
x &lt;- abs(rnorm(length(dd)))
y &lt;- abs(rnorm(length(dd))) * x
df &lt;- data.frame("Date" = dd, x, y)
myprd &lt;- "2011-10-01/2012-09-30"

precip &lt;- data.frame("Date" = dd," precip" = abs(rnorm(length(dd))) * 10)

# basic hydrograph plot
ch_hydrograph_plot(flows = df, winter_shading = FALSE)

# with different labels and winter shading
ch_hydrograph_plot(flows = df, winter_shading = TRUE,
 flow_labels = c("simulated", "observed"))

# add precipitation, increase the plot ranges to separate flows and precip, and add a legend box
ch_hydrograph_plot(flows = df, precip = precip, range_mult_flow = 1.7, 
range_mult_precip = 2, leg_box = TRUE)

</code></pre>

<hr>
<h2 id='ch_map_plot_data'>Generate a map for a defined area</h2><span id='topic+ch_map_plot_data'></span>

<h3>Description</h3>

<p>Generates a map for a defined area. Options to plot station 
locations, magnitudes, trends etc.  Watershed boundaries and add user 
defined labels. See article in CWRA &quot;Water News&quot; Spring 2023. 
The elements are added to the map in an order that puts the symbols on top.
Large basins, WSC basins, rivers, Provinces, then data symbols.  Labels are 
added last.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ch_map_plot_data(
  map_data,
  locations = NULL,
  lo_pch = 19,
  lo_col = "black",
  lo_bg = "white",
  lo_cex = 0.8,
  lo_text = "Station",
  lo_title = "Location",
  lb_basins = NULL,
  lb_border = "darkred",
  lb_lwd = 2,
  lb_clip = TRUE,
  sb_basins = NULL,
  sb_border = "darkred",
  sb_lwd = 1,
  sb_clip = FALSE,
  trends = NULL,
  tr_pch = c(25, 20, 24),
  tr_col = c("red", "black", "darkblue"),
  tr_cex = c(0.5, 1, 0),
  tr_p = 0.05,
  tr_ltext = c("Significant Increase", "Increase", "No Change", "Decrease",
    "Significant Decrease"),
  tr_lsz = c(1, 0.4, 0.4, 0.4, 1),
  var = NULL,
  vr_pch = 22,
  vr_cex = 2,
  vr_text = NA,
  vr_range = c(0, 1),
  vr_colors = c("darkred", "red", "white", "green", "darkgreen"),
  sc_var = NULL,
  sc_pch = 20,
  sc_range = c(0, 1),
  sc_text = "",
  sc_color = "magenta",
  rivers = TRUE,
  boundaries = TRUE,
  plabels = TRUE,
  pl_cex = 1,
  legend = FALSE,
  le_text = NA,
  x_labels = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ch_map_plot_data_+3A_map_data">map_data</code></td>
<td>
<p>a list produced by the function ch_get_map_base()</p>
</td></tr>
<tr><td><code id="ch_map_plot_data_+3A_locations">locations</code></td>
<td>
<p>a dataframe with longitude, latitude. a third column may contain indexes of symbol types.</p>
</td></tr>
<tr><td><code id="ch_map_plot_data_+3A_lo_pch">lo_pch</code></td>
<td>
<p>plotting symbols: default is lo_pch=c(19,19)</p>
</td></tr>
<tr><td><code id="ch_map_plot_data_+3A_lo_col">lo_col</code></td>
<td>
<p>plotting symbol colours: default is lo_col= c(&quot;black&quot;,&quot;black&quot;)</p>
</td></tr>
<tr><td><code id="ch_map_plot_data_+3A_lo_bg">lo_bg</code></td>
<td>
<p>plotting symbol background (20-24) default is &quot;white&quot;</p>
</td></tr>
<tr><td><code id="ch_map_plot_data_+3A_lo_cex">lo_cex</code></td>
<td>
<p>plot symbol size default is 0.8</p>
</td></tr>
<tr><td><code id="ch_map_plot_data_+3A_lo_text">lo_text</code></td>
<td>
<p>legend title text, default is &quot;Station&quot;</p>
</td></tr>
<tr><td><code id="ch_map_plot_data_+3A_lo_title">lo_title</code></td>
<td>
<p>names for different items in legend, default is &quot;Location&quot;
</p>
<p># adding large basin boundaries</p>
</td></tr>
<tr><td><code id="ch_map_plot_data_+3A_lb_basins">lb_basins</code></td>
<td>
<p>a list with basin shapefiles</p>
</td></tr>
<tr><td><code id="ch_map_plot_data_+3A_lb_border">lb_border</code></td>
<td>
<p>colour for watershed boundaries: default is &quot;darkred&quot;</p>
</td></tr>
<tr><td><code id="ch_map_plot_data_+3A_lb_lwd">lb_lwd</code></td>
<td>
<p>width of watershed boundary</p>
</td></tr>
<tr><td><code id="ch_map_plot_data_+3A_lb_clip">lb_clip</code></td>
<td>
<p>clip basins at map edge, default is TRUE
</p>
<p># adding WSC basin boundaries</p>
</td></tr>
<tr><td><code id="ch_map_plot_data_+3A_sb_basins">sb_basins</code></td>
<td>
<p>a list with basin shapefiles</p>
</td></tr>
<tr><td><code id="ch_map_plot_data_+3A_sb_border">sb_border</code></td>
<td>
<p>colour for watershed boundaries: default is &quot;darkred&quot;</p>
</td></tr>
<tr><td><code id="ch_map_plot_data_+3A_sb_lwd">sb_lwd</code></td>
<td>
<p>width of watershed boundary</p>
</td></tr>
<tr><td><code id="ch_map_plot_data_+3A_sb_clip">sb_clip</code></td>
<td>
<p>clip basins at map edge, default is FALSE
</p>
<p># adding trends</p>
</td></tr>
<tr><td><code id="ch_map_plot_data_+3A_trends">trends</code></td>
<td>
<p>a dataframe with four columns (Longitude, Latitude, trend, and pvalue) the trend and pvalue 
are in original units such as slope and probability.  These are converted to indexes (1, 2, 3) decreasing, no trend, 
increasing and (1, 2) not significant and significant</p>
</td></tr>
<tr><td><code id="ch_map_plot_data_+3A_tr_pch">tr_pch</code></td>
<td>
<p>plotting symbols: default is tr_pch = c(25, 20, 24)</p>
</td></tr>
<tr><td><code id="ch_map_plot_data_+3A_tr_col">tr_col</code></td>
<td>
<p>plotting symbol colours: default is tr_col = c(&quot;red&quot;,&quot;black&quot;,&quot;darkblue&quot;)</p>
</td></tr>
<tr><td><code id="ch_map_plot_data_+3A_tr_cex">tr_cex</code></td>
<td>
<p>plotting symbol size for non-significant and significant:default is tr_cex = c(0.50, 1.0, 0.0</p>
</td></tr>
<tr><td><code id="ch_map_plot_data_+3A_tr_p">tr_p</code></td>
<td>
<p>trend significance level: default is tr_p = 0.05
</p>
<p># adding variable with colour gradient</p>
</td></tr>
<tr><td><code id="ch_map_plot_data_+3A_tr_ltext">tr_ltext</code></td>
<td>
<p>text for legend</p>
</td></tr>
<tr><td><code id="ch_map_plot_data_+3A_tr_lsz">tr_lsz</code></td>
<td>
<p>symbol sizes for trends default is c(1,0.40, 0.40, 0.40, 1)</p>
</td></tr>
<tr><td><code id="ch_map_plot_data_+3A_var">var</code></td>
<td>
<p>a dataframe with three columns (Longitude, Latitude, value)</p>
</td></tr>
<tr><td><code id="ch_map_plot_data_+3A_vr_pch">vr_pch</code></td>
<td>
<p>a symbol to plot: default is vr_pch = 22</p>
</td></tr>
<tr><td><code id="ch_map_plot_data_+3A_vr_cex">vr_cex</code></td>
<td>
<p>size for plot symbol: default is vr_cex = 2.0</p>
</td></tr>
<tr><td><code id="ch_map_plot_data_+3A_vr_text">vr_text</code></td>
<td>
<p>a label to include in the legend</p>
</td></tr>
<tr><td><code id="ch_map_plot_data_+3A_vr_range">vr_range</code></td>
<td>
<p>set ranges for color gradient  default is (0, 1)</p>
</td></tr>
<tr><td><code id="ch_map_plot_data_+3A_vr_colors">vr_colors</code></td>
<td>
<p>colours for gradient default is (&quot;darkred&quot;, &quot;red&quot;,&quot;white&quot;,&quot;green&quot;, &quot;darkgreen&quot;)
</p>
<p># adding variable with symbol diameter</p>
</td></tr>
<tr><td><code id="ch_map_plot_data_+3A_sc_var">sc_var</code></td>
<td>
<p>a dataframe with three columns (Longitude, Latitude, value)</p>
</td></tr>
<tr><td><code id="ch_map_plot_data_+3A_sc_pch">sc_pch</code></td>
<td>
<p>a symbol to plot: default is vr_pch = 20</p>
</td></tr>
<tr><td><code id="ch_map_plot_data_+3A_sc_range">sc_range</code></td>
<td>
<p>set ranges for color gradient default is (0, 1) if not scaled against largest</p>
</td></tr>
<tr><td><code id="ch_map_plot_data_+3A_sc_text">sc_text</code></td>
<td>
<p>a label to include in the legend  default is &quot;&quot;</p>
</td></tr>
<tr><td><code id="ch_map_plot_data_+3A_sc_color">sc_color</code></td>
<td>
<p>symbol colour default is &quot;magenta&quot;
</p>
<p># adding rivers</p>
</td></tr>
<tr><td><code id="ch_map_plot_data_+3A_rivers">rivers</code></td>
<td>
<p>plot rivers in blue: default is TRUE</p>
</td></tr>
<tr><td><code id="ch_map_plot_data_+3A_boundaries">boundaries</code></td>
<td>
<p>plot provincial boundaries: default is TRUE
</p>
<p># adding provincial boundaries</p>
</td></tr>
<tr><td><code id="ch_map_plot_data_+3A_plabels">plabels</code></td>
<td>
<p>add the names of provinces: default is TRUE</p>
</td></tr>
<tr><td><code id="ch_map_plot_data_+3A_pl_cex">pl_cex</code></td>
<td>
<p>adjusts size of provincial labels: default is 1.0</p>
</td></tr>
<tr><td><code id="ch_map_plot_data_+3A_legend">legend</code></td>
<td>
<p>add a legend to the plot: default is FALSE</p>
</td></tr>
<tr><td><code id="ch_map_plot_data_+3A_le_text">le_text</code></td>
<td>
<p>legend categories: default is NA.</p>
</td></tr>
<tr><td><code id="ch_map_plot_data_+3A_x_labels">x_labels</code></td>
<td>
<p>a dataframe with seven columns (long, lat, pos, cex, font, col, text). Each row provides details for a single label : default is NA</p>
</td></tr>
<tr><td><code id="ch_map_plot_data_+3A_...">...</code></td>
<td>
<p>Other mapping parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Produces a map on an output device.
</p>


<h3>Author(s)</h3>

<p>Paul Whitfield
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Note: example not tested automatically as it is very slow to execute due to the downloading
# get base map
latitude &lt;- c(48.0,  61.0)
longitude &lt;- c(-110.0, -128.5)
mapdir &lt;- tempdir()
# get map data
m_map &lt;- ch_get_map_base(latitude,longitude, 
                     map_proj = "Albers", 
                     map_directory = mapdir, 
                     map_type = "nps")
# add symbols
stations &lt;- HYDAT_list
stations &lt;- stations[,c("Longitude", "Latitude")]
stations &lt;- na.omit(stations)
ch_map_plot_data(m_map, sc_var = stations, sc_text = "Years")
                    
</code></pre>

<hr>
<h2 id='ch_polar_plot'>Polar plot of daily streamflows</h2><span id='topic+ch_polar_plot'></span>

<h3>Description</h3>

<p>Produces a polar plot similar to that used in <cite>Whitfield and Cannon, 2000</cite>. It uses output 
from the function <code><a href="#topic+ch_binned_MannWhitney">ch_binned_MannWhitney</a></code> or a data structure created using 
the function <code><a href="#topic+ch_polar_plot_prep">ch_polar_plot_prep</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ch_polar_plot(
  bmw,
  lcol1 = c("black", "gray50"),
  lcol2 = c("black", "gray50"),
  lfill = c("yellow", "green"),
  lsig = c("red", "blue")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ch_polar_plot_+3A_bmw">bmw</code></td>
<td>
<p>output from <code><a href="#topic+ch_binned_MannWhitney">ch_binned_MannWhitney</a></code></p>
</td></tr>
<tr><td><code id="ch_polar_plot_+3A_lcol1">lcol1</code></td>
<td>
<p>line colour, default is <code>c("black","gray50")</code></p>
</td></tr>
<tr><td><code id="ch_polar_plot_+3A_lcol2">lcol2</code></td>
<td>
<p>point colour, default is <code>c("black","gray50")</code></p>
</td></tr>
<tr><td><code id="ch_polar_plot_+3A_lfill">lfill</code></td>
<td>
<p>fill colour, default is <code>c("yellow","green")</code></p>
</td></tr>
<tr><td><code id="ch_polar_plot_+3A_lsig">lsig</code></td>
<td>
<p>significance symbol colour, default is <code>c("red","blue")</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>No value is returned; a standard <span class="rlang"><b>R</b></span> graphic is created.
</p>


<h3>Author(s)</h3>

<p>Paul Whitfield
</p>


<h3>References</h3>

<p>Whitfield, P.H. and A.J. Cannon. 2000. Polar plotting of seasonal hydrologic
and climatic data. Northwest Science 74: 76-80.
</p>
<p>Whitfield, P.H., Cannon, A.J., 2000. Recent variations in climate and hydrology
in Canada. Canadian Water Resources Journal 25: 19-65.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ch_binned_MannWhitney">ch_binned_MannWhitney</a></code> <code><a href="#topic+ch_polar_plot_prep">ch_polar_plot_prep</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>range1 &lt;- c(1970,1979)
range2 &lt;- c(1990,1999)
b_MW &lt;- ch_binned_MannWhitney(CAN05AA008, step = 5, range1, range2, 
ptest &lt;- 0.05)
ch_polar_plot(b_MW)
</code></pre>

<hr>
<h2 id='ch_polar_plot_peaks'>Polar / circular plots of peak flows</h2><span id='topic+ch_polar_plot_peaks'></span>

<h3>Description</h3>

<p>Polar / circular plots of peak flows.  
Creates a polar plot of flow peaks in one of several different forms.  
Basic plot has shading for nival and pluvial centroids.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ch_polar_plot_peaks(
  title = NA,
  direction = NULL,
  regularity = NULL,
  days = NULL,
  shading = FALSE,
  shade = 35,
  pt_col = "darkblue",
  in_pch = NULL,
  in_cex = NULL,
  in_col = NULL,
  in_detail = NULL,
  labels = NULL,
  label_pos = NULL,
  out_pch = 16,
  out_cex = 0.8,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ch_polar_plot_peaks_+3A_title">title</code></td>
<td>
<p>a title to be added to the plot</p>
</td></tr>
<tr><td><code id="ch_polar_plot_peaks_+3A_direction">direction</code></td>
<td>
<p>a value or array of mean/median direction, circular mean or 
median of points from ch_circ_mean_reg (optional)</p>
</td></tr>
<tr><td><code id="ch_polar_plot_peaks_+3A_regularity">regularity</code></td>
<td>
<p>a value or array of regularity from ch_circ_mean_reg (optional).</p>
</td></tr>
<tr><td><code id="ch_polar_plot_peaks_+3A_days">days</code></td>
<td>
<p>an array of days of year to be plotted on perimeter (optional).</p>
</td></tr>
<tr><td><code id="ch_polar_plot_peaks_+3A_shading">shading</code></td>
<td>
<p>if  <code>TRUE</code> adds shading and labels for nival and pluvial regimes default = <code>FALSE</code></p>
</td></tr>
<tr><td><code id="ch_polar_plot_peaks_+3A_shade">shade</code></td>
<td>
<p>percentage of shading, default is 35.</p>
</td></tr>
<tr><td><code id="ch_polar_plot_peaks_+3A_pt_col">pt_col</code></td>
<td>
<p>colour used for points for events. default = &quot;darkblue&quot;. If pt_col is an array it is used to colour 
the individual points of days</p>
</td></tr>
<tr><td><code id="ch_polar_plot_peaks_+3A_in_pch">in_pch</code></td>
<td>
<p>a value or an array of symbols to be used for centroids.  To be in color, 
must be one of 21 to 25 to get a symbol with border, elsewise a red symbol is plotted.</p>
</td></tr>
<tr><td><code id="ch_polar_plot_peaks_+3A_in_cex">in_cex</code></td>
<td>
<p>an array of symbol sizes</p>
</td></tr>
<tr><td><code id="ch_polar_plot_peaks_+3A_in_col">in_col</code></td>
<td>
<p>an array of colors, either numbers or names to apply to centroid points (optional, 
default is &quot;red&quot;)</p>
</td></tr>
<tr><td><code id="ch_polar_plot_peaks_+3A_in_detail">in_detail</code></td>
<td>
<p>an array of indices indicating symbol [1] shape, [2] colour, [3] background, 
and [4]size</p>
</td></tr>
<tr><td><code id="ch_polar_plot_peaks_+3A_labels">labels</code></td>
<td>
<p>an array of labels to be placed beside points with direction and regularity (optional)</p>
</td></tr>
<tr><td><code id="ch_polar_plot_peaks_+3A_label_pos">label_pos</code></td>
<td>
<p>an array of positions indicating when label be placed (1, 2, 3, or 4 - below, left, 
above, right)(optional - default is below)</p>
</td></tr>
<tr><td><code id="ch_polar_plot_peaks_+3A_out_pch">out_pch</code></td>
<td>
<p>symbols for points on outside of circle</p>
</td></tr>
<tr><td><code id="ch_polar_plot_peaks_+3A_out_cex">out_cex</code></td>
<td>
<p>point size for symbol</p>
</td></tr>
<tr><td><code id="ch_polar_plot_peaks_+3A_...">...</code></td>
<td>
<p>other plot options</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Creates a circular plot of peak flows.
</p>


<h3>Note</h3>

<p>points inside the plot
</p>
<p>in_pch, in_col, and in_cex will normally be of the same length and that would 
be the maximum index of in_detail
</p>
<p>points on the outside
</p>


<h3>Author(s)</h3>

<p>Paul Whitfield
</p>


<h3>References</h3>

<p>Pewsey, A., M. Neuhauser, and G. D. Ruxton. 2014. Circular Statistics in R, 
192 pp., Oxford University Press.
</p>
<p>Whitfield, P. H. 2018. Clustering of seasonal events: A simulation study using 
circular methods. Communications in Statistics - Simulation and Computation 47(10): 3008-3030.
</p>
<p>Burn, D. H., and P. H. Whitfield. 2023. Changes in the timing of flood events resulting 
from climate change. Journal of Hydrology.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># base plot
ch_polar_plot_peaks() 

#base plot with area shading
ch_polar_plot_peaks(shading = TRUE)

# plot of annual maximum series
data(CAN05AA008)
am &lt;- ch_sh_get_amax(CAN05AA008)
ch_polar_plot_peaks(days = am$doy, title = "05AA008")

#remove partial years
am &lt;-am[am$days &gt;= 365,]
ch_polar_plot_peaks(days = am$doy, title = "05AA008")

#plot the centroid
m_r &lt;- ch_circ_mean_reg(am)
ch_polar_plot_peaks(direction = m_r$mean, regularity = m_r$regularity, title = "05AA008")

# plot peaks and centroid
ch_polar_plot_peaks(days = am$doy, direction = m_r$mean, regularity = m_r$regularity, 
title = "05AA008")
</code></pre>

<hr>
<h2 id='ch_polar_plot_prep'>Creates a data structure to be passed to <code>ch_polar_plot</code></h2><span id='topic+ch_polar_plot_prep'></span>

<h3>Description</h3>

<p>Could be used to move data from a different type of analysis different to 
the <code><a href="#topic+ch_binned_MannWhitney">ch_binned_MannWhitney</a></code> function which uses flows. The two series need to be of the 
same length and their length is related to the step size. For examples, 
for five day periods there will be 73 periods.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ch_polar_plot_prep(
  station,
  plot_title,
  step,
  x0,
  x1,
  stat,
  prob,
  test_s,
  variable = "discharge",
  bin_method = "unstated",
  test_method = "unstated",
  lline1 = "Period 1",
  lline2 = "Period 2",
  pvalue = 0.05
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ch_polar_plot_prep_+3A_station">station</code></td>
<td>
<p>Typically a station number</p>
</td></tr>
<tr><td><code id="ch_polar_plot_prep_+3A_plot_title">plot_title</code></td>
<td>
<p>Polar plot title - usually a station name</p>
</td></tr>
<tr><td><code id="ch_polar_plot_prep_+3A_step">step</code></td>
<td>
<p>The number of days binned</p>
</td></tr>
<tr><td><code id="ch_polar_plot_prep_+3A_x0">x0</code></td>
<td>
<p>Time series of length n for a single seasonal cycle</p>
</td></tr>
<tr><td><code id="ch_polar_plot_prep_+3A_x1">x1</code></td>
<td>
<p>Time series of length n for a single seasonal cycle</p>
</td></tr>
<tr><td><code id="ch_polar_plot_prep_+3A_stat">stat</code></td>
<td>
<p>Time series of length n for statistical test value for each bin</p>
</td></tr>
<tr><td><code id="ch_polar_plot_prep_+3A_prob">prob</code></td>
<td>
<p>Time series of length n of probability of test value</p>
</td></tr>
<tr><td><code id="ch_polar_plot_prep_+3A_test_s">test_s</code></td>
<td>
<p>Vector with values of -1, 0, 1 for significance, -1 negative, 
1 positive, 0 not significant</p>
</td></tr>
<tr><td><code id="ch_polar_plot_prep_+3A_variable">variable</code></td>
<td>
<p>Name of variable plotted. Default is <span class="option">discharge</span></p>
</td></tr>
<tr><td><code id="ch_polar_plot_prep_+3A_bin_method">bin_method</code></td>
<td>
<p>Default is <span class="option">unstated</span></p>
</td></tr>
<tr><td><code id="ch_polar_plot_prep_+3A_test_method">test_method</code></td>
<td>
<p>Default is <span class="option">unstated</span></p>
</td></tr>
<tr><td><code id="ch_polar_plot_prep_+3A_lline1">lline1</code></td>
<td>
<p>Names of first period, default is <span class="option">Period 1</span></p>
</td></tr>
<tr><td><code id="ch_polar_plot_prep_+3A_lline2">lline2</code></td>
<td>
<p>Names of second period, default is <span class="option">Period 2</span></p>
</td></tr>
<tr><td><code id="ch_polar_plot_prep_+3A_pvalue">pvalue</code></td>
<td>
<p>Value of p used. Default is 0.05</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list containing:
</p>
<table>
<tr><td><code>StationID</code></td>
<td>
<p>ID of station</p>
</td></tr>
<tr><td><code>Station_lname</code></td>
<td>
<p>Name of station</p>
</td></tr>
<tr><td><code>variable</code></td>
<td>
<p>Name of variable</p>
</td></tr>
<tr><td><code>bin_width</code></td>
<td>
<p>Smoothing time step in days</p>
</td></tr>
<tr><td><code>range1</code></td>
<td>
<p>First range of years</p>
</td></tr>
<tr><td><code>range2</code></td>
<td>
<p>Second range of years</p>
</td></tr>
<tr><td><code>p_used</code></td>
<td>
<p>p_value</p>
</td></tr>
<tr><td><code>fail</code></td>
<td>
<p>TRUE if test failed due to missing values</p>
</td></tr>
<tr><td><code>bin_method</code></td>
<td>
<p>Method used for binning</p>
</td></tr>
<tr><td><code>test_method</code></td>
<td>
<p>Mann-Whitney U</p>
</td></tr>
<tr><td><code>series</code></td>
<td>
<p>A data frame containing six columns</p>
</td></tr>
</table>
<p>The <code>series</code> data frame contains 
</p>
<table>
<tr><td><code>period</code></td>
<td>
<p>period numbers i.e. 1:365/step</p>
</td></tr>
<tr><td><code>period1</code></td>
<td>
<p>median values for each bin in period 1</p>
</td></tr>
<tr><td><code>period2</code></td>
<td>
<p>median values for each bin in period 2</p>
</td></tr>
<tr><td><code>mwu</code></td>
<td>
<p>Mann Whitney U-statistic for each bin between the two periods</p>
</td></tr>
<tr><td><code>prob</code></td>
<td>
<p>probability of U for each period</p>
</td></tr>
<tr><td><code>code</code></td>
<td>
<p>significance codes for each bin</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Paul Whitfield
</p>


<h3>References</h3>

<p>Whitfield, P.H. and A.J. Cannon. 2000. Polar plotting of seasonal hydrologic
and climatic data. Northwest Science 74: 76-80.
</p>
<p>Whitfield, P.H., Cannon, A.J., 2000. Recent variations in climate and hydrology
in Canada. Canadian Water Resources Journal 25: 19-65.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ch_binned_MannWhitney">ch_binned_MannWhitney</a></code> <code><a href="#topic+ch_polar_plot">ch_polar_plot</a></code>
</p>

<hr>
<h2 id='ch_qa_hydrograph'>Plots a hydrograph with the data quality symbols and returns a report on qa symbols and missing data.</h2><span id='topic+ch_qa_hydrograph'></span>

<h3>Description</h3>

<p>Plots a hydrograph of a WSC daily data file read from from ECDataExplorer (ECDE). 
The hydrograph shows individual days with data quality symbols [SYM] 
in colour and counts cases of each and reports them in the legend. The colours and symbols 
are those produced by ECDataExplorer. 
</p>
<p>There is an option is to provide start and end dates to show 
only part of the time period for which data exists and the plot is annotated to indicate this. 
Counts of missing observations is also provided in the legend.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ch_qa_hydrograph(
  DF,
  st_date = NULL,
  end_date = NULL,
  cts = TRUE,
  rescale = FALSE,
  sym_col = c("black", "green", "cyan", "yellow", "red", "white"),
  metadata = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ch_qa_hydrograph_+3A_df">DF</code></td>
<td>
<p>Data frame retrieved from ECDataExplorer as returned by the function 
<code>ch_read_ECDE_flows</code>.</p>
</td></tr>
<tr><td><code id="ch_qa_hydrograph_+3A_st_date">st_date</code></td>
<td>
<p>Optional start date in the form <span class="option">yyyy-mm-dd</span>. Default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="ch_qa_hydrograph_+3A_end_date">end_date</code></td>
<td>
<p>Optional end date in the form <span class="option">yyyy-mm-dd</span>. Default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="ch_qa_hydrograph_+3A_cts">cts</code></td>
<td>
<p>If <code>TRUE</code> (the default) shows the counts of SYM in the legend. If <code>FALSE</code> 
the counts are omitted as in ECDE.</p>
</td></tr>
<tr><td><code id="ch_qa_hydrograph_+3A_rescale">rescale</code></td>
<td>
<p>If <code>FALSE</code> (the default), the y-axis scaling is determined by the time 
period. If <code>TRUE</code> then determined by the whole dataset.</p>
</td></tr>
<tr><td><code id="ch_qa_hydrograph_+3A_sym_col">sym_col</code></td>
<td>
<p>Colours used for SYM; default is those used in ECDE (&quot;black&quot;,
&quot;green&quot;, &quot;cyan&quot;,&quot;yellow&quot;, &quot;red&quot;, &quot;white&quot;).  The final &quot;white&quot; can be changed to highlight
missing data points.</p>
</td></tr>
<tr><td><code id="ch_qa_hydrograph_+3A_metadata">metadata</code></td>
<td>
<p>a dataframe of station metadata, default is <code>HYDAT_list</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Produces a plot and returns a list that contains:
</p>
<table>
<tr><td><code>station name or title used</code></td>
<td>
</td></tr>
<tr><td><code>st_date</code></td>
<td>
<p>starting date</p>
</td></tr>
<tr><td><code>end_date</code></td>
<td>
<p>ending data</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>the number of data points</p>
</td></tr>
<tr><td><code>sym_count</code></td>
<td>
<p>summary of the SYM counts</p>
</td></tr>
<tr><td><code>missing</code></td>
<td>
<p>number of missing data</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Paul Whitfield
</p>


<h3>Examples</h3>

<pre><code class='language-R'>m_test &lt;- ch_qa_hydrograph(CAN05AA008)
m_test &lt;- ch_qa_hydrograph(CAN05AA008, st_date="1980-01-01", end_date="1999-12-31")
</code></pre>

<hr>
<h2 id='ch_read_AHCCD_daily'>Reads AHCCD daily file</h2><span id='topic+ch_read_AHCCD_daily'></span>

<h3>Description</h3>

<p>This program reads an Adjusted and Homogenized Canadian Climate Data (AHCCD) of daily 
precipitation or temperatures. The values are arranged as
month x day, which makes them difficult to read using standard <span class="rlang"><b>R</b></span> functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ch_read_AHCCD_daily(daily_file)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ch_read_AHCCD_daily_+3A_daily_file">daily_file</code></td>
<td>
<p>Required. Name of the file to be read.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If successful, returns the values in a data frame, consisting of the date, 
the value and the data code.
</p>


<h3>Author(s)</h3>

<p>Kevin Shook
</p>


<h3>References</h3>

<p>Daily AHCCD data are available from <a href="http://crd-data-donnees-rdc.ec.gc.ca/CDAS/products/EC_data/AHCCD_daily/">http://crd-data-donnees-rdc.ec.gc.ca/CDAS/products/EC_data/AHCCD_daily/</a>. 
Any use of the data must cite 
<cite>Mekis, E and L.A. Vincent, 2011: An overview of the second generation 
adjusted daily precipitation dataset for trend analysis in Canada. 
Atmosphere-Ocean, 49 (2), 163-177.</cite>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ch_read_AHCCD_monthly">ch_read_AHCCD_monthly</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Don't run this example as it requires a file, and use of the dummy
# file will cause an error message

stoon_daily_tmax &lt;- ch_read_AHCCD_daily("dx40657120.txt")
## End(Not run)
</code></pre>

<hr>
<h2 id='ch_read_AHCCD_monthly'>Reads AHCCD monthly file</h2><span id='topic+ch_read_AHCCD_monthly'></span>

<h3>Description</h3>

<p>This program reads an Adjusted and Homogenized Canadian Climate Data (AHCCD) data of 
precipitation or temperatures. The values are arranged as year x month, 
which makes them difficult to read using standard <span class="rlang"><b>R</b></span> functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ch_read_AHCCD_monthly(monthly_file = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ch_read_AHCCD_monthly_+3A_monthly_file">monthly_file</code></td>
<td>
<p>Required. Name of the file to be read.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If successful, returns the values in a dataframe, consisting of the <code>year</code>,
the <code>month</code>, the value and the data <code>code</code>.
</p>


<h3>Author(s)</h3>

<p>Kevin Shook
</p>


<h3>References</h3>

<p>Any use of the data must cite <cite>Mekis, E and L.A. Vincent, 2011: An overview of 
the second generation adjusted daily temperature and precipitation dataset for trend analysis in Canada. 
Atmosphere-Ocean, 49 (2), 163-177.</cite>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ch_read_AHCCD_daily">ch_read_AHCCD_daily</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Don't run these examples as use of the dummy
# files will cause error messages

Stoon_monthly_precip &lt;- ch_read_AHCCD_monthly("mt4057120.txt")
NB_monthly_tmean &lt;- ch_read_AHCCD_monthly("mm4045695.txt") 
## End(Not run)
</code></pre>

<hr>
<h2 id='ch_read_ECDE_flows'>Reads a file of WSC daily flows from ECDataExplorer (ECDE)</h2><span id='topic+ch_read_ECDE_flows'></span>

<h3>Description</h3>

<p>Reads in a file WSC daily flows as returned from the Windows program ECDataExplorer, converts the Date,
and omits the last 3 lines as these contain the data disclaimer and not data. The function
can read values from a url.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ch_read_ECDE_flows(filename)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ch_read_ECDE_flows_+3A_filename">filename</code></td>
<td>
<p>Datafile retrieved from ECDataExplorer.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a dataframe with the last three rows removed:
</p>
<table>
<tr><td><code>ID</code></td>
<td>
<p>stationID</p>
</td></tr>
<tr><td><code>PARAM</code></td>
<td>
<p>Parameter 1 for Flow 2 for Level</p>
</td></tr>
<tr><td><code>Date</code></td>
<td>
<p>original charater string converted to date format</p>
</td></tr>
<tr><td><code>Flow</code></td>
<td>
<p>Daily mean flow m<code class="reqn">^3</code>/sec</p>
</td></tr>
<tr><td><code>SYM</code></td>
<td>
<p>Quality flag</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Paul Whitfield
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Not run as requires a file returned by the Windows program ECDataExplorer
# Using a dummy file name as an example
mfile &lt;- "04JD005_Daily_Flow_ts.csv"
mdata &lt;- ch_read_ECDE_flows(mfile)
## End(Not run)


# Not tested automatically as it is slow to read from a url
url1 &lt;- "https://zenodo.org/record/7007830/files/08NL007_Daily_Flow_ts.csv"
values &lt;- ch_read_ECDE_flows(url1)


</code></pre>

<hr>
<h2 id='ch_regime_plot'>Plots the regime of daily streamflows using quantiles</h2><span id='topic+ch_regime_plot'></span>

<h3>Description</h3>

<p>Produces a regime hydrograph similar to that in the reference. It shows the flow quantiles for each
day of the year and the maximum and minimum. Parameters can be set to change colours and set the y-scale
to allow plots of same scale to be produced.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ch_regime_plot(
  DF,
  wyear = 1,
  colour = TRUE,
  mx = 1,
  metadata = NULL,
  quant = c(0.95, 0.9, 0.75, 0.5, 0.25, 0.1, 0.05)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ch_regime_plot_+3A_df">DF</code></td>
<td>
<p>data frame of daily flow data</p>
</td></tr>
<tr><td><code id="ch_regime_plot_+3A_wyear">wyear</code></td>
<td>
<p>set <code>wyear = 10</code> for October, <code>water year = 1</code> for calendar year, can be any month</p>
</td></tr>
<tr><td><code id="ch_regime_plot_+3A_colour">colour</code></td>
<td>
<p>if <code>TRUE</code> plot is in colour, if <code>FALSE</code> plot is grayscale.</p>
</td></tr>
<tr><td><code id="ch_regime_plot_+3A_mx">mx</code></td>
<td>
<p>set the maximum y value; if = 1 then maximum value of the flows is used to set</p>
</td></tr>
<tr><td><code id="ch_regime_plot_+3A_metadata">metadata</code></td>
<td>
<p>a data frame of metadata, defaults to HYDAT_list.
the y-axis value. The value of <code>mx</code> can be specified to produce a series of plots with the 
same scale.</p>
</td></tr>
<tr><td><code id="ch_regime_plot_+3A_quant">quant</code></td>
<td>
<p>quantiles; default is <code>quant = c(0.95,0.9,0.75,0.5,0.25,0.1,0.05)</code>. 
Can be changed but the length must be 7 and the 4th value must be 0.5 (median)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No value is returned; a standard <span class="rlang"><b>R</b></span> graphic is created.
</p>


<h3>Author(s)</h3>

<p>Paul Whitfield
</p>


<h3>References</h3>

<p>MacCulloch, G. and P. H. Whitfield (2012). Towards a Stream Classification System 
for the Canadian Prairie Provinces. Canadian Water Resources Journal 37: 311-332.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(CAN05AA008)
ch_regime_plot(CAN05AA008, colour = TRUE, wyear = 1)

</code></pre>

<hr>
<h2 id='ch_rfa_distseason'>Distance in seasonal space</h2><span id='topic+ch_rfa_distseason'></span><span id='topic+ch_rfa_distseason.numeric'></span><span id='topic+ch_rfa_distseason.data.frame'></span><span id='topic+ch_rfa_distseason.formula'></span>

<h3>Description</h3>

<p>Calculates a matrix of distances between points in the seasonal 
space that characterizes timing and regularity.
It is equivalent to Euclidean distance applied to regularity (radius)
and timing (angle) separately.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ch_rfa_distseason(x, ...)

## S3 method for class 'numeric'
ch_rfa_distseason(x, a, w = 1/pi, ...)

## S3 method for class 'data.frame'
ch_rfa_distseason(x, w = 1/pi, ...)

## S3 method for class 'formula'
ch_rfa_distseason(form, x, w = 1/pi, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ch_rfa_distseason_+3A_x">x</code>, <code id="ch_rfa_distseason_+3A_a">a</code></td>
<td>
<p>Coordinates in the seasonal space. 
Can be a data.frame or vectors with radius <code>x</code> and angle <code>a</code>.</p>
</td></tr>
<tr><td><code id="ch_rfa_distseason_+3A_...">...</code></td>
<td>
<p>Other parameters.</p>
</td></tr>
<tr><td><code id="ch_rfa_distseason_+3A_w">w</code></td>
<td>
<p>Weight to favor angle over radius. 
By default it is 1/pi, which bring angle in the interval [0,1].</p>
</td></tr>
<tr><td><code id="ch_rfa_distseason_+3A_form">form</code></td>
<td>
<p>Formula and dataset providing the coordinates of the
seasonal space. Must be of the form <code>radius ~ angle</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a matrix of distances between points in the seasonal 
space that characterizes timing and regularity.
</p>


<h3>Author(s)</h3>

<p>Martin Durocher
</p>


<h3>References</h3>

<p>Durocher, M., Burn, D. H., &amp; Ashkar, F. (2019). Comparison of estimation
methods for a nonstationary index-flood model in flood frequency
analysis using peaks over threshold. https://doi.org/10.31223/osf.io/rnepc
</p>


<h3>See Also</h3>

<p><a href="#topic+ch_rfa_seasonstat">ch_rfa_seasonstat</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
scoord &lt;- data.frame(radius = runif(5), 
                     angle = runif(5,0,2*pi))

ch_rfa_distseason(radius ~ angle , scoord)


</code></pre>

<hr>
<h2 id='ch_rfa_extractamax'>Extracts the annual maxima of a daily time series</h2><span id='topic+ch_rfa_extractamax'></span><span id='topic+ch_rfa_extractamax.formula'></span><span id='topic+ch_rfa_extractamax.default'></span>

<h3>Description</h3>

<p>Extracts the annual maxima of a daily time series
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ch_rfa_extractamax(x, ...)

## S3 method for class 'formula'
ch_rfa_extractamax(form, x, tol = 0, ...)

## Default S3 method:
ch_rfa_extractamax(x, tol = 0, nlab = "n", ylab = "yy", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ch_rfa_extractamax_+3A_x">x</code></td>
<td>
<p>Data. If no formula is passed, the first column must be the
value and the second the date.</p>
</td></tr>
<tr><td><code id="ch_rfa_extractamax_+3A_...">...</code></td>
<td>
<p>Other parameters.</p>
</td></tr>
<tr><td><code id="ch_rfa_extractamax_+3A_form">form</code></td>
<td>
<p>Formula of the form <code>value ~ date</code> that specifies the
variable from which the annual maximums are extracted and a date variable.</p>
</td></tr>
<tr><td><code id="ch_rfa_extractamax_+3A_tol">tol</code></td>
<td>
<p>Filter the years having less than <code>tol</code> days.</p>
</td></tr>
<tr><td><code id="ch_rfa_extractamax_+3A_nlab">nlab</code>, <code id="ch_rfa_extractamax_+3A_ylab">ylab</code></td>
<td>
<p>Names for the added columns representing respectively 
the number of yearly observations and the year. 
If set to <code>NULL</code> the given column is not added.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a data frame containing the annual (Monthly) maxima,
the date and the number of observations during the year.
</p>


<h3>Author(s)</h3>

<p>Martin Durocher
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
out &lt;- ch_rfa_extractamax(flow ~ date, CAN01AD002, tol = 350)
head(out)

</code></pre>

<hr>
<h2 id='ch_rfa_julianplot'>Circular plotting by day of year</h2><span id='topic+ch_rfa_julianplot'></span>

<h3>Description</h3>

<p>Create axis for plotting circular statistics in a unitary circle.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ch_rfa_julianplot(
  rose.col = "gray40",
  rose.lwd = 1.5,
  rose.cex = 1.5,
  rose.radius = seq(0.25, 1, 0.25),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ch_rfa_julianplot_+3A_rose.col">rose.col</code>, <code id="ch_rfa_julianplot_+3A_rose.lwd">rose.lwd</code>, <code id="ch_rfa_julianplot_+3A_rose.cex">rose.cex</code></td>
<td>
<p>Properties of the polar axes.</p>
</td></tr>
<tr><td><code id="ch_rfa_julianplot_+3A_rose.radius">rose.radius</code></td>
<td>
<p>Vector of the position of the circular axis.</p>
</td></tr>
<tr><td><code id="ch_rfa_julianplot_+3A_...">...</code></td>
<td>
<p>Other parameter passed to <a href="graphics.html#topic+points">points</a>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a empty rose plot by day of year
</p>


<h3>Author(s)</h3>

<p>Martin Durocher
</p>


<h3>See Also</h3>

<p><a href="#topic+ch_rfa_seasonstat">ch_rfa_seasonstat</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(flowAtlantic)

ss &lt;- ch_rfa_seasonstat(date ~ id, flowAtlantic$ams)

ch_rfa_julianplot()
points(y ~ x, ss, pch = 16, col = cut(ss[,'radius'], c(0,.5,.75,1)))

</code></pre>

<hr>
<h2 id='ch_rfa_seasonstat'>Seasonal statistics for flood peaks</h2><span id='topic+ch_rfa_seasonstat'></span><span id='topic+ch_rfa_seasonstat.data.frame'></span><span id='topic+ch_rfa_seasonstat.formula'></span>

<h3>Description</h3>

<p>Return the circular or seasonal statistics of flood peaks.
The angle represents the mean timing of the floods and the radius its
regularity. For example, a radius of one represents perfect regularity. 
Can perform the analyses on multiple sites.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ch_rfa_seasonstat(x, ...)

## S3 method for class 'data.frame'
ch_rfa_seasonstat(x, ...)

## S3 method for class 'formula'
ch_rfa_seasonstat(form, x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ch_rfa_seasonstat_+3A_x">x</code></td>
<td>
<p>Data. If data.frame with two columns, they must be respectively 
the date and a site variable.</p>
</td></tr>
<tr><td><code id="ch_rfa_seasonstat_+3A_...">...</code></td>
<td>
<p>Other parameters.</p>
</td></tr>
<tr><td><code id="ch_rfa_seasonstat_+3A_form">form</code></td>
<td>
<p>Formula that specifies the date and site variable. Must be of the
form <code>date ~ site</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the circular or seasonal statistics of flood peaks.
</p>


<h3>Author(s)</h3>

<p>Martin Durocher
</p>


<h3>References</h3>

<p>Burn, D.H. (1997). Catchment similarity for regional flood frequency analysis
using seasonality measures. Journal of Hydrology 202, 212-230.
https://doi.org/10.1016/S0022-1694(97)00068-1
</p>


<h3>See Also</h3>

<p><a href="#topic+ch_rfa_distseason">ch_rfa_distseason</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
dt &lt;- ch_rfa_extractamax(flow~date, CAN01AD002)$date

ch_rfa_seasonstat(dt)

## Illustration of the analysis of multiple sites

F0 &lt;- function(ii) data.frame(site = ii, dt = sample(dt, replace = TRUE))
x &lt;- lapply(1:10, F0)
x &lt;- do.call(rbind, x)
           
st &lt;- ch_rfa_seasonstat(dt ~ site, x)

ch_rfa_julianplot()
points(y ~ x, st, col = 2, pch = 16)

</code></pre>

<hr>
<h2 id='ch_sh_get_amax'>Extracts annual maximum values from ECDE dataframe.</h2><span id='topic+ch_sh_get_amax'></span>

<h3>Description</h3>

<p>Extracts annual maximum values, the date of occurrence, the day of year, and the completeness 
from ECDE dataframe. Uses functions from timeDate ( <code>as.timeDate</code>, <code>dayOfYear</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ch_sh_get_amax(df)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ch_sh_get_amax_+3A_df">df</code></td>
<td>
<p>A dataframe of daily streamflow data from ECDE</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a dataframe with the following variables  
</p>
<table>
<tr><td><code>year</code></td>
<td>
</td></tr>
<tr><td><code>annual maximum</code></td>
<td>
</td></tr>
<tr><td><code>date of annual maximum</code></td>
<td>
</td></tr>
<tr><td><code>day of year of annual maximum</code></td>
<td>
</td></tr>
<tr><td><code>days</code></td>
<td>
<p>number of days with observations</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Paul Whitfield
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ch_read_ECDE_flows">ch_read_ECDE_flows</a></code>  <code><a href="#topic+ch_circ_mean_reg">ch_circ_mean_reg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(CAN05AA008)
amax &lt;- ch_sh_get_amax(CAN05AA008)
str(amax)
</code></pre>

<hr>
<h2 id='ch_slice'>Converts doy or dwy into a factor that is used to bin data</h2><span id='topic+ch_slice'></span>

<h3>Description</h3>

<p>Converts a series of a variable such as day of year into numbered bins. 
Whenever the number of bins does not divide in 365 evenly a 
message showing the number of bins created and the number of days 
added to the last bin is provided. 
</p>
<p>Simply put, <code>ch_slice</code> is used to convert doy into a 
factor which is a number of bins per year. A year can be converted into any 
number of bins; slice does it based upon a number of days. So when you send it 
an array of doy it slices that into bins of the desired width. For example, 
if the step is 5. They 365/5 gives 73 bins and because of leap years there might 
be one extra day added every four years to the final bin.
</p>
<p>To illustrate for a bin of 5 days:
doy:
1  2  3  4  5  6  7  8  9 10 11  12
Bin:
1  1  1  1  1  2  2  2  2  2  3   3
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ch_slice(doy, step)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ch_slice_+3A_doy">doy</code></td>
<td>
<p>A vector of the day of calendar year for the dataset</p>
</td></tr>
<tr><td><code id="ch_slice_+3A_step">step</code></td>
<td>
<p>Width of bin in days</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a vector of bin numbers that is used as a factor for each day 
in the dataset and provides a message indicating the handling of partial bins
</p>


<h3>Author(s)</h3>

<p>Paul Whitfield, Kevin Shook
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ch_binned_MannWhitney">ch_binned_MannWhitney</a></code> <code><a href="#topic+ch_flow_raster_trend">ch_flow_raster_trend</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>doy &lt;- c(1:365)
# first 30 days are 1, 31-60 are 2 etc
dice &lt;- ch_slice(doy, 30)
plot(doy, dice)
</code></pre>

<hr>
<h2 id='ch_stack_EC'>Stacks EC values</h2><span id='topic+ch_stack_EC'></span>

<h3>Description</h3>

<p>Converts data frames of Environment Canada year x month or 
month x day data to vectors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ch_stack_EC(data_values = NULL, data_codes = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ch_stack_EC_+3A_data_values">data_values</code></td>
<td>
<p>Required. Data frame of year x month or month x day values.</p>
</td></tr>
<tr><td><code id="ch_stack_EC_+3A_data_codes">data_codes</code></td>
<td>
<p>Required. Data frame of year x month or month x day data codes.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a data frame with two columns: the data values, and the data codes.
</p>


<h3>Author(s)</h3>

<p>Kevin Shook
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Do not run as the function requires a data frame of EC data and
# the dummy variable will cause an error message
df &lt;- ch_stack_EC(data_values, data_codes)

## End(Not run)

</code></pre>

<hr>
<h2 id='ch_sub_set_Years'>Helper function for selecting points for an axis</h2><span id='topic+ch_sub_set_Years'></span>

<h3>Description</h3>

<p>Sub-samples a vector every n places. Many times there are so many 
years the labels on the plot overlap. <code>ch_sub_set_years</code> returns the position and label 
for the subset. The function can be used on any type of simple array.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ch_sub_set_Years(years, n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ch_sub_set_Years_+3A_years">years</code></td>
<td>
<p>a vector of years</p>
</td></tr>
<tr><td><code id="ch_sub_set_Years_+3A_n">n</code></td>
<td>
<p>sample size</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list containing:
</p>
<table>
<tr><td><code>position</code></td>
<td>
<p>array of axis positions</p>
</td></tr>
<tr><td><code>label</code></td>
<td>
<p>array of labels</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Paul Whitfield
</p>


<h3>Examples</h3>

<pre><code class='language-R'>myears &lt;- c(1900:2045)
myears &lt;- ch_sub_set_Years(myears, 20)
myears

a &lt;- LETTERS
my_alpha &lt;- ch_sub_set_Years(a, 5)
my_alpha
</code></pre>

<hr>
<h2 id='ch_test_url_file'>Tests url to see if it will work</h2><span id='topic+ch_test_url_file'></span>

<h3>Description</h3>

<p>Tests url to see if it will work
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ch_test_url_file(url, quiet = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ch_test_url_file_+3A_url">url</code></td>
<td>
<p>Required. URL to be checked</p>
</td></tr>
<tr><td><code id="ch_test_url_file_+3A_quiet">quiet</code></td>
<td>
<p>Optional. If <code>FALSE</code> (the default) messages are printed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns <span class="option">error</span> if there was an error, <span class="option">warning</span> if there was a
warning. Otherwise, returns <span class="option">OK</span>. Strings are returned instead of logical values
to simplify checking result in calling function.
</p>


<h3>Author(s)</h3>

<p>Kevin Shook
</p>


<h3>See Also</h3>

<p>See original code on post in Stack Overflow
<a href="https://stackoverflow.com/questions/12193779/how-to-write-trycatch-in-r">
How to write trycatch in R</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Not tested automatically as can be very slow
test_url &lt;- "https://zenodo.org/record/4781469/files/sm_data.csv"
ch_test_url_file(test_url, quiet = TRUE)


</code></pre>

<hr>
<h2 id='ch_tidyhydat_ECDE'>Converts a tidyhydat daily flow data tibble to ECDE format</h2><span id='topic+ch_tidyhydat_ECDE'></span>

<h3>Description</h3>

<p>Accessing daily flow data using <span class="pkg">tidyhydat</span> is quick and efficient. However, it 
sometimes conflicts with other functions as <span class="pkg">tidyhydat</span> changes variable names and some default 
entries. This function converts a tibble obtained from a <span class="pkg">tidyhydat</span> tibble to a dataframe 
with standard Environment and Climate Change Canada Data Explorer (ECDE) names.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ch_tidyhydat_ECDE(data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ch_tidyhydat_ECDE_+3A_data">data</code></td>
<td>
<p>Tibble of daily flows retrieved using <span class="pkg">tidyhydat</span> function <code>hy_daily_flows</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe or a list of flows with formats consistent with datafiles read using <code>ch_read_ECDE_flows</code>:
</p>
<table>
<tr><td><code>ID</code></td>
<td>
<p>stationID</p>
</td></tr>
<tr><td><code>PARAM</code></td>
<td>
<p>Parameter 1 for Flow 2 for Level</p>
</td></tr>
<tr><td><code>Date</code></td>
<td>
<p>Original charater string converted to date format</p>
</td></tr>
<tr><td><code>Flow</code></td>
<td>
<p>Daily mean flow m<code class="reqn">^3</code>/sec</p>
</td></tr>
<tr><td><code>SYM</code></td>
<td>
<p>Quality flag</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Paul Whitfield
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ch_tidyhydat_ECDE_meta">ch_tidyhydat_ECDE_meta</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># This example uses the built-in test database, by setting the hydat_path parameter
# You will want to use it with your actual HYDAT database
library(tidyhydat)
# check for existence of test database
test_db &lt;- hy_test_db()
if (file.exists(test_db)) {
  hydat_path = hy_set_default_db(test_db)
  mdata &lt;- hy_daily_flows(station_number=c("05AA008"))
  m_data &lt;- ch_tidyhydat_ECDE(mdata)

  mdata &lt;- hy_daily_flows(station_number=c("05AA008", "08MF005", "05HD008")) 
  mnew &lt;- ch_tidyhydat_ECDE(mdata)
  str(mnew[[1]])
  str(mnew[[2]])
  str(mnew[[3]]) 
# note the order is in increasing alphabetical order
hy_set_default_db(NULL)    # Reset HYDAT database
}
</code></pre>

<hr>
<h2 id='ch_tidyhydat_ECDE_meta'>Creates an ECDE-like dataframe of metadata from <span class="pkg">tidyhydat</span></h2><span id='topic+ch_tidyhydat_ECDE_meta'></span>

<h3>Description</h3>

<p>Extracts tombstone (meta) data for stations from <span class="pkg">tidyhydat</span> in a 
format similar to that used by the Environment Canada Data Explorer (ECDE). The 
default does not capture all the fields in ECDE, which includes the most recent status 
of many fields such as operating schedule. Returning these values slows the function,
particularly when all WSC stations are selected.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ch_tidyhydat_ECDE_meta(stations, all_ECDE = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ch_tidyhydat_ECDE_meta_+3A_stations">stations</code></td>
<td>
<p>A vector of WSC station IDs, i.e. <code>c("05BB001", "05BB003", "05BB004", 
"05BB005")</code>. If <code>stations = "all"</code> then values are returned for all stations. Note
that you should ensure that that the <span class="pkg">tidyhydat</span> database is up to date, if you
select  <code>stations = "all"</code>, so that the most recent set of stations is used.</p>
</td></tr>
<tr><td><code id="ch_tidyhydat_ECDE_meta_+3A_all_ecde">all_ECDE</code></td>
<td>
<p>Should all ECDE values be returned? If <code>FALSE</code> the default, then
values of <code>Flow</code>, <code>Level</code>, <code>Sed</code>, <code>OperSched</code>, <code>Region</code>, <code>Datum</code>, and
<code>Operator</code> are omitted or will differ from the ECDE values. If <code>all_ECDE = TRUE</code>,
then the function will return values identical to ECDE. Note that setting 
<code>all_ECDE = TRUE</code> will result in very long execution times, as it is necessary
to extract many daily values for each station to determine the values of 
<code>Flow</code>, <code>Level</code>, <code>Sed</code>, and <code>OperSched</code> to determine the
final values.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list with three items:
</p>

<ul>
<li> <p><code>meta</code> - a dataframe of metadata from <span class="pkg">tidyhydat</span> in ECDE form (not all ECDE fields are reproduced in this summary)
</p>
</li>
<li> <p><code>H_version</code> - version information, and 
</p>
</li>
<li> <p><code>th_meta</code> - a dataframe with all <span class="pkg">tidyhdat</span> fields including:
</p>

<ul>
<li> <p>Station - StationID
</p>
</li>
<li> <p>StationName - Station Name
</p>
</li>
<li> <p>HYDStatus - Active or Discontinued
</p>
</li>
<li> <p>Prov - Province
</p>
</li>
<li> <p>Latitude
</p>
</li>
<li> <p>Longitude
</p>
</li>
<li> <p>DrainageArea - km<code class="reqn">^2</code>
</p>
</li>
<li> <p>Years - number of years with data
</p>
</li>
<li> <p>From - Start Year
</p>
</li>
<li> <p>To - End Year
</p>
</li>
<li> <p>Reg. - Regulated?
</p>
</li>
<li> <p>Flow - not captured (differs from ECDE), unless <code>all_ECDE = TRUE</code>
</p>
</li>
<li> <p>Level - not captured (differs from ECDE), unless <code>all_ECDE = TRUE</code>
</p>
</li>
<li> <p>Sed - not captured (differs from ECDE), unless <code>all_ECDE = TRUE</code>
</p>
</li>
<li> <p>OperSched - not captured (differs from ECDE), unless <code>all_ECDE = TRUE</code>
</p>
</li>
<li> <p>RealTime - if TRUE/Yes
</p>
</li>
<li> <p>RHBN - if TRUE/Yes is in the reference hydrologic basin network
</p>
</li>
<li> <p>Region - number of region instead of name (differs from ECDE), unless <code>all_ECDE = TRUE</code>
</p>
</li>
<li> <p>Datum - reference number (differs from ECDE), unless <code>all_ECDE = TRUE</code>
</p>
</li>
<li> <p>Operator - reference number (differs from ECDE), unless <code>all_ECDE = TRUE</code>
</p>
</li></ul>

</li></ul>



<h3>Author(s)</h3>

<p>Paul Whitfield, Kevin Shook
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ch_get_ECDE_metadata">ch_get_ECDE_metadata</a></code> <code><a href="#topic+ch_tidyhydat_ECDE">ch_tidyhydat_ECDE</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># This example uses the built-in test database, by setting the hydat_path parameter
# You will want to use it with your actual HYDAT database
library(tidyhydat)
# check for existence of test database
test_db &lt;- hy_test_db()
if (file.exists(test_db)) {
  stations &lt;- c("05AA008", "08MF005", "05HD008")
  hy_set_default_db(test_db)
  result &lt;- ch_tidyhydat_ECDE_meta(stations)
  metadata &lt;- result[[1]]
  version &lt;- result[[2]]
  hy_set_default_db(NULL)    # Reset HYDAT database
}
## Not run: 
# This example is not run, as it will take several hours to execute and will
# return many warnings for stations having no data. Note that it is using the actual
# HYDAT database, which must have been installed previously
# This use of the function is intended for the package maintainers to 
# update the HYDAT_list data frame
result &lt;- ch_tidyhydat_ECDE_meta("all", TRUE)
HYDAT_list &lt;- result$meta

## End(Not run)

</code></pre>

<hr>
<h2 id='ch_tr_sign'>ch_tr_sign</h2><span id='topic+ch_tr_sign'></span>

<h3>Description</h3>

<p>Converts MK (or other) slopes to integers 1-2-3 (negative, 
none, positive). These indices can be used to indicate trend direction.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ch_tr_sign(x, offset = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ch_tr_sign_+3A_x">x</code></td>
<td>
<p>an array of slopes</p>
</td></tr>
<tr><td><code id="ch_tr_sign_+3A_offset">offset</code></td>
<td>
<p>the amount of shift to make values positive integers, default is 2.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>x an array of indices 1, 2, 3
</p>


<h3>Author(s)</h3>

<p>Paul Whitfield
</p>


<h3>Examples</h3>

<pre><code class='language-R'> mkin &lt;- c( -0.23, 0.34, 0.0, .033, -0.55)
 mkout &lt;- ch_tr_sign(mkin)
 # 1 3 2 3 1
</code></pre>

<hr>
<h2 id='ch_tr_signif'>ch_tr_signif()</h2><span id='topic+ch_tr_signif'></span>

<h3>Description</h3>

<p>Convert pvalues to integers 1 for NS and 2 for significant 
using a pvalue that can be set (default is 0.05)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ch_tr_signif(x, pvalue = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ch_tr_signif_+3A_x">x</code></td>
<td>
<p>an array of pvalues from statistical test</p>
</td></tr>
<tr><td><code id="ch_tr_signif_+3A_pvalue">pvalue</code></td>
<td>
<p>critical value, default is 0.05</p>
</td></tr>
</table>


<h3>Value</h3>

<p>x an array of indices 1 and 2, where 1 is NS and 2 is significant
</p>


<h3>Author(s)</h3>

<p>Paul Whitfield
</p>


<h3>Examples</h3>

<pre><code class='language-R'> sin &lt;- c( -0.052, 0.34, 0.012, -.033, -0.55)
 sout &lt;- ch_tr_signif(sin)
 # 1 1 2 2 1
</code></pre>

<hr>
<h2 id='ch_volcano_pourpoints'>Creates a sample file of pour points</h2><span id='topic+ch_volcano_pourpoints'></span>

<h3>Description</h3>

<p>Creates a file of pour points for the <code>volcano</code> DEM. The 
pour points define the outlets of sub-basins. These pour points are used
by examples within other functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ch_volcano_pourpoints(pp_shp)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ch_volcano_pourpoints_+3A_pp_shp">pp_shp</code></td>
<td>
<p>Name for shapefile to hold pour points</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns an <span class="pkg">sf</span> object containing 2 pour points for the 
<code>volcano</code> DEM. The pour points are also written to the specified file.
</p>


<h3>Author(s)</h3>

<p>Dan Moore and Kevin Shook
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ch_volcano_raster">ch_volcano_raster</a></code> <code><a href="#topic+ch_wbt_pourpoints">ch_wbt_pourpoints</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pourpoint_file &lt;- tempfile("volcano_pourpoints", fileext = c(".shp"))
pourpoints &lt;- ch_volcano_pourpoints(pourpoint_file)
plot(pourpoints)
</code></pre>

<hr>
<h2 id='ch_volcano_raster'>Create Test Raster</h2><span id='topic+ch_volcano_raster'></span>

<h3>Description</h3>

<p>Creates a <span class="pkg">raster</span> object of land surface elevations, as
used to test/demonstrate many functions requiring a digital elevation model 
(DEM).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ch_volcano_raster()
</code></pre>


<h3>Details</h3>

<p>No arguments are required as the DEM is created from the <span class="pkg">base</span> 
<code>volcano</code> matrix of elevations.
</p>


<h3>Value</h3>

<p>Returns a raster object of land surface elevations.
</p>


<h3>Author(s)</h3>

<p>Dan Moore and Kevin Shook
</p>


<h3>Examples</h3>

<pre><code class='language-R'>test_raster &lt;- ch_volcano_raster()

</code></pre>

<hr>
<h2 id='ch_wbt_catchment'>Delineate catchment boundaries</h2><span id='topic+ch_wbt_catchment'></span>

<h3>Description</h3>

<p>Delineate catchment boundaries
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ch_wbt_catchment(
  fn_pp_snap,
  fn_flowdir,
  fn_catchment_ras,
  fn_catchment_vec,
  return_vector = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ch_wbt_catchment_+3A_fn_pp_snap">fn_pp_snap</code></td>
<td>
<p>Name of file containing snapped pour points</p>
</td></tr>
<tr><td><code id="ch_wbt_catchment_+3A_fn_flowdir">fn_flowdir</code></td>
<td>
<p>Name of file containing flow accumulations.</p>
</td></tr>
<tr><td><code id="ch_wbt_catchment_+3A_fn_catchment_ras">fn_catchment_ras</code></td>
<td>
<p>Raster file to contain delineated catchment.</p>
</td></tr>
<tr><td><code id="ch_wbt_catchment_+3A_fn_catchment_vec">fn_catchment_vec</code></td>
<td>
<p>Vector file to contain delineated catchment.</p>
</td></tr>
<tr><td><code id="ch_wbt_catchment_+3A_return_vector">return_vector</code></td>
<td>
<p>If <code>TRUE</code> (the default) a vector of the catchment will be returned.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If <code>return_vector == TRUE</code> a vector of the catchment is returned. Otherwise
nothing is returned.
</p>


<h3>Author(s)</h3>

<p>Dan Moore and Kevin Shook
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ch_wbt_catchment_onestep">ch_wbt_catchment_onestep</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Only proceed if Whitebox executable is installed
library(whitebox)
if (check_whitebox_binary()){
  library(raster)
  test_raster &lt;- ch_volcano_raster()
  dem_raster_file &lt;- tempfile(fileext = ".tif")
  no_sink_raster_file &lt;- tempfile("no_sinks", fileext = ".tif")

  # write test raster to file
  writeRaster(test_raster, dem_raster_file, format = "GTiff")

  # remove sinks
  removed_sinks &lt;- ch_wbt_removesinks(dem_raster_file, no_sink_raster_file, method = "fill")

  # get flow accumulations
  flow_acc_file &lt;- tempfile("flow_acc", fileext = ".tif")
  flow_acc &lt;- ch_wbt_flow_accumulation(no_sink_raster_file, flow_acc_file)

  # get pour points
  pourpoint_file &lt;- tempfile("volcano_pourpoints", fileext = ".shp")
  pourpoints &lt;- ch_volcano_pourpoints(pourpoint_file)
  snapped_pourpoint_file &lt;- tempfile("snapped_pourpoints", fileext = ".shp")
  snapped_pourpoints &lt;- ch_wbt_pourpoints(pourpoints, flow_acc_file, pourpoint_file,
  snapped_pourpoint_file, snap_dist = 10)

  # get flow directions
  flow_dir_file &lt;- tempfile("flow_dir", fileext = ".tif")
  flow_dir &lt;- ch_wbt_flow_direction(no_sink_raster_file, flow_dir_file)
  fn_catchment_ras &lt;- tempfile("catchment", fileext = ".tif")
  fn_catchment_vec &lt;- tempfile("catchment", fileext = ".shp")
  catchments &lt;- ch_wbt_catchment(snapped_pourpoint_file, flow_dir_file, 
  fn_catchment_ras, fn_catchment_vec)
} else {
  message("Examples not run as Whitebox executable not found")
}
</code></pre>

<hr>
<h2 id='ch_wbt_catchment_onestep'>Delineates a catchment in a single step</h2><span id='topic+ch_wbt_catchment_onestep'></span>

<h3>Description</h3>

<p>Calls all of the <code>ch_wbt</code> and other functions required to do the sub-tasks
required to delineate a catchment. The names of files to be created
are taken from the list created by the function <code>ch_wbt_filenames</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ch_wbt_catchment_onestep(
  wd,
  in_dem,
  pp_sf,
  sink_method = "breach_leastcost",
  dist = NULL,
  check_catchment = TRUE,
  threshold = NULL,
  snap_dist = NULL,
  cb_colour = "red",
  pp_colour = "red",
  channel_colour = "blue",
  contour_colour = "grey",
  plot_na = TRUE,
  plot_scale = TRUE,
  na_location = "tr",
  scale_location = "bl",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ch_wbt_catchment_onestep_+3A_wd">wd</code></td>
<td>
<p>Name of working directory.</p>
</td></tr>
<tr><td><code id="ch_wbt_catchment_onestep_+3A_in_dem">in_dem</code></td>
<td>
<p>File name for original DEM.</p>
</td></tr>
<tr><td><code id="ch_wbt_catchment_onestep_+3A_pp_sf">pp_sf</code></td>
<td>
<p>Vector containing pour points.</p>
</td></tr>
<tr><td><code id="ch_wbt_catchment_onestep_+3A_sink_method">sink_method</code></td>
<td>
<p>Method for sink removal as used by <code>ch_wbt_removesinks</code>.</p>
</td></tr>
<tr><td><code id="ch_wbt_catchment_onestep_+3A_dist">dist</code></td>
<td>
<p>Maximum search distance for breach paths in cells. Required if <code>sink_method = "breach_leastcost"</code>.</p>
</td></tr>
<tr><td><code id="ch_wbt_catchment_onestep_+3A_check_catchment">check_catchment</code></td>
<td>
<p>If <code>TRUE</code> (the default) <code>ch_checkcatchment</code> will be called
after the catchment is created.</p>
</td></tr>
<tr><td><code id="ch_wbt_catchment_onestep_+3A_threshold">threshold</code></td>
<td>
<p>Threshold for channel initiation.</p>
</td></tr>
<tr><td><code id="ch_wbt_catchment_onestep_+3A_snap_dist">snap_dist</code></td>
<td>
<p>Maximum pour point snap distance in map units.</p>
</td></tr>
<tr><td><code id="ch_wbt_catchment_onestep_+3A_cb_colour">cb_colour</code></td>
<td>
<p>Colour for catchment outline. Default is &quot;red&quot;.</p>
</td></tr>
<tr><td><code id="ch_wbt_catchment_onestep_+3A_pp_colour">pp_colour</code></td>
<td>
<p>Colour for catchment pour points. Default is &quot;red&quot;.</p>
</td></tr>
<tr><td><code id="ch_wbt_catchment_onestep_+3A_channel_colour">channel_colour</code></td>
<td>
<p>Colour for channel. Default is &quot;blue&quot;.</p>
</td></tr>
<tr><td><code id="ch_wbt_catchment_onestep_+3A_contour_colour">contour_colour</code></td>
<td>
<p>Colour for contours Default is &quot;grey&quot;.</p>
</td></tr>
<tr><td><code id="ch_wbt_catchment_onestep_+3A_plot_na">plot_na</code></td>
<td>
<p>If <code>TRUE</code> (the default) a north arrow is added to the plot.</p>
</td></tr>
<tr><td><code id="ch_wbt_catchment_onestep_+3A_plot_scale">plot_scale</code></td>
<td>
<p>If <code>TRUE</code> (the default) a scale bar is added to the plot.</p>
</td></tr>
<tr><td><code id="ch_wbt_catchment_onestep_+3A_na_location">na_location</code></td>
<td>
<p>Location for the north arrow. Default is <span class="option">tr</span>, i.e. top-right.</p>
</td></tr>
<tr><td><code id="ch_wbt_catchment_onestep_+3A_scale_location">scale_location</code></td>
<td>
<p>Location for the scale bar. Default is <span class="option">bl</span>, i.e. bottom-left.</p>
</td></tr>
<tr><td><code id="ch_wbt_catchment_onestep_+3A_...">...</code></td>
<td>
<p>Extra parameters for <code>ch_wbt_removesinks</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns an <span class="pkg">sp</span> object of the delineated catchment.
</p>


<h3>Author(s)</h3>

<p>Dan Moore and Kevin Shook
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ch_wbt_filenames">ch_wbt_filenames</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Only proceed if Whitebox executable is installed
library(whitebox)
if (check_whitebox_binary()){
  library(raster)
  test_raster &lt;- ch_volcano_raster()
  dem_raster_file &lt;- tempfile(fileext = c(".tif"))
  # write test raster to file
  writeRaster(test_raster, dem_raster_file, format = "GTiff")
  wd &lt;- tempdir()
  pourpoint_file &lt;- tempfile("volcano_pourpoints", fileext = ".shp")
  pourpoints &lt;- ch_volcano_pourpoints(pourpoint_file)
  catchment &lt;- ch_wbt_catchment_onestep(wd = wd, in_dem = dem_raster_file, 
  pp_sf = pourpoints, sink_method = "fill", threshold = 1, snap_dist = 10)
} else {
  message("Examples not run as Whitebox executable not found")
}
</code></pre>

<hr>
<h2 id='ch_wbt_channels'>Generate stream network</h2><span id='topic+ch_wbt_channels'></span>

<h3>Description</h3>

<p>Generate stream network
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ch_wbt_channels(
  fn_flowacc,
  fn_flowdir,
  fn_channel_ras,
  fn_channel_vec,
  threshold = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ch_wbt_channels_+3A_fn_flowacc">fn_flowacc</code></td>
<td>
<p>File name for flow accumulation grid.</p>
</td></tr>
<tr><td><code id="ch_wbt_channels_+3A_fn_flowdir">fn_flowdir</code></td>
<td>
<p>File name for flow direction grid.</p>
</td></tr>
<tr><td><code id="ch_wbt_channels_+3A_fn_channel_ras">fn_channel_ras</code></td>
<td>
<p>File name for raster version of channel network.</p>
</td></tr>
<tr><td><code id="ch_wbt_channels_+3A_fn_channel_vec">fn_channel_vec</code></td>
<td>
<p>File name for vector version of channel networks.</p>
</td></tr>
<tr><td><code id="ch_wbt_channels_+3A_threshold">threshold</code></td>
<td>
<p>Threshold for channel initiation.</p>
</td></tr>
<tr><td><code id="ch_wbt_channels_+3A_...">...</code></td>
<td>
<p>Other parameters for <span class="pkg">whitebox</span> function <code>wbt_extract_streams</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a <span class="pkg">sf</span> vector object of the stream channels.
</p>


<h3>Author(s)</h3>

<p>Dan Moore
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Only proceed if Whitebox executable is installed
library(whitebox)
if (check_whitebox_binary()){
  library(raster)
  test_raster &lt;- ch_volcano_raster()
  dem_raster_file &lt;- tempfile(fileext = c(".tif"))
  no_sink_raster_file &lt;- tempfile("no_sinks", fileext = c(".tif"))

  # write test raster to file
  writeRaster(test_raster, dem_raster_file, format = "GTiff")

  # remove sinks
  removed_sinks &lt;- ch_wbt_removesinks(dem_raster_file, no_sink_raster_file, method = "fill")

  # get flow accumulations
  flow_acc_file &lt;- tempfile("flow_acc", fileext = c(".tif"))
  flow_acc &lt;- ch_wbt_flow_accumulation(no_sink_raster_file, flow_acc_file)

  # get flow directions
  flow_dir_file &lt;- tempfile("flow_dir", fileext = c(".tif"))
  flow_dir &lt;- ch_wbt_flow_direction(no_sink_raster_file, flow_dir_file)
  channel_raster_file &lt;- tempfile("channels", fileext = c(".tif"))
  channel_vector_file &lt;- tempfile("channels", fileext = c(".shp"))
  channels &lt;- ch_wbt_channels(flow_acc_file, flow_dir_file, channel_raster_file,
  channel_vector_file, 1)
  plot(channels)
} else {
  message("Examples not run as Whitebox executable not found")
}
</code></pre>

<hr>
<h2 id='ch_wbt_check_whitebox'>Checks for WhiteboxTools executable</h2><span id='topic+ch_wbt_check_whitebox'></span>

<h3>Description</h3>

<p>Checks for WhiteboxTools executable
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ch_wbt_check_whitebox()
</code></pre>


<h3>Value</h3>

<p>If <code>WhiteboxTools</code> cannot be found, a message explaining what to do is displayed.
</p>


<h3>Author(s)</h3>

<p>Kevin Shook
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Only proceed if Whitebox executable is installed
library(whitebox)
if (check_whitebox_binary()){
  ch_wbt_check_whitebox()
} else {
  message("Example not run as Whitebox executable not found")
}
</code></pre>

<hr>
<h2 id='ch_wbt_filenames'>Creates names for Whitebox function input and output files</h2><span id='topic+ch_wbt_filenames'></span>

<h3>Description</h3>

<p>Creates a list of the files used for inputs and outputs by the
Whitebox functions. This function needs to be called before calling any of the other
Whitebox (i.e. those prefixed by <code>cd_wbt</code>) functions. If the file names are not specified, default names will 
be used. All raster files are TIFF (.tif), all vector files are shapefiles (.shp).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ch_wbt_filenames(
  wd = NULL,
  fn_dem = "dem.tif",
  fn_dem_fsc = "dem_fsc.tif",
  fn_dem_ns = "dem_ns.tif",
  fn_flowacc = "flow_acc.tif",
  fn_flowdir = "flow_dir.tif",
  fn_channel_ras = "channel.tif",
  fn_channel_vec = "channel.shp",
  fn_catchment_ras = "catchment.tif",
  fn_catchment_vec = "catchment.shp",
  fn_pp = "pp.shp",
  fn_pp_snap = "pp_snap.shp"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ch_wbt_filenames_+3A_wd">wd</code></td>
<td>
<p>Required. Name of working directory.</p>
</td></tr>
<tr><td><code id="ch_wbt_filenames_+3A_fn_dem">fn_dem</code></td>
<td>
<p>File name of input DEM. Default is <span class="option">dem.tif</span>.</p>
</td></tr>
<tr><td><code id="ch_wbt_filenames_+3A_fn_dem_fsc">fn_dem_fsc</code></td>
<td>
<p>File name for dem after filling single-cell pits. Default is <span class="option">dem_fsc.tif</span>.</p>
</td></tr>
<tr><td><code id="ch_wbt_filenames_+3A_fn_dem_ns">fn_dem_ns</code></td>
<td>
<p>File name for dem removing sinks. Default is <span class="option">dem_ns.tif</span>.</p>
</td></tr>
<tr><td><code id="ch_wbt_filenames_+3A_fn_flowacc">fn_flowacc</code></td>
<td>
<p>File name for DEM flow accumulation grid Default is <span class="option">flow_acc.tif</span>.</p>
</td></tr>
<tr><td><code id="ch_wbt_filenames_+3A_fn_flowdir">fn_flowdir</code></td>
<td>
<p>File name for DEM flow direction grid. Default is <span class="option">flow_dir.tif</span>.</p>
</td></tr>
<tr><td><code id="ch_wbt_filenames_+3A_fn_channel_ras">fn_channel_ras</code></td>
<td>
<p>File name for raster version of channel network. Default is <span class="option">channel.tif</span>.</p>
</td></tr>
<tr><td><code id="ch_wbt_filenames_+3A_fn_channel_vec">fn_channel_vec</code></td>
<td>
<p>File name for vector version of channel networks. Default is <span class="option">channel.shp</span>.</p>
</td></tr>
<tr><td><code id="ch_wbt_filenames_+3A_fn_catchment_ras">fn_catchment_ras</code></td>
<td>
<p>File name for raster version of catchment. Default is <span class="option">catchment.tif</span>.</p>
</td></tr>
<tr><td><code id="ch_wbt_filenames_+3A_fn_catchment_vec">fn_catchment_vec</code></td>
<td>
<p>File name for vector version of catchment. Default is <span class="option">catchment.shp</span>.</p>
</td></tr>
<tr><td><code id="ch_wbt_filenames_+3A_fn_pp">fn_pp</code></td>
<td>
<p>File name for pour points (input). Vector file. Default is <span class="option">pp.shp</span>.</p>
</td></tr>
<tr><td><code id="ch_wbt_filenames_+3A_fn_pp_snap">fn_pp_snap</code></td>
<td>
<p>File name for pour points after snapping to channel network. Vector file. Default is <span class="option">pp.shp</span>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list of the input and output file names
</p>


<h3>Author(s)</h3>

<p>Dan Moore
</p>


<h3>Examples</h3>

<pre><code class='language-R'>wbt_file_names &lt;- ch_wbt_filenames(getwd())

</code></pre>

<hr>
<h2 id='ch_wbt_flow_accumulation'>Creates flow accumulation grid file</h2><span id='topic+ch_wbt_flow_accumulation'></span>

<h3>Description</h3>

<p>Creates flow accumulation grid file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ch_wbt_flow_accumulation(fn_dem_ns, fn_flowacc, return_raster = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ch_wbt_flow_accumulation_+3A_fn_dem_ns">fn_dem_ns</code></td>
<td>
<p>File name of dem with sinks removed.</p>
</td></tr>
<tr><td><code id="ch_wbt_flow_accumulation_+3A_fn_flowacc">fn_flowacc</code></td>
<td>
<p>File name for flow accumulation grid to be created.</p>
</td></tr>
<tr><td><code id="ch_wbt_flow_accumulation_+3A_return_raster">return_raster</code></td>
<td>
<p>If <code>TRUE</code> (the default), the flow accumulation
grid will be returned as a raster object, in addition to being written to
<span class="option">fn_flowacc</span>. If <code>FALSE</code>, the output file will still be created
but a <code>NULL</code> value is returned.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If <code>return_raster = TRUE</code>, the flow accumulation
grid will be returned as a raster object, otherwise <code>NULL</code> is returned.
</p>


<h3>Author(s)</h3>

<p>Dan Moore
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Only proceed if Whitebox executable is installed
library(whitebox)
if (check_whitebox_binary()){
  library(raster)
  test_raster &lt;- ch_volcano_raster()
  dem_raster_file &lt;- tempfile(fileext = c(".tif"))
  no_sink_raster_file &lt;- tempfile("no_sinks", fileext = c(".tif"))

  # write test raster to file
  writeRaster(test_raster, dem_raster_file, format = "GTiff")

  # remove sinks
  removed_sinks &lt;- ch_wbt_removesinks(dem_raster_file, no_sink_raster_file, method = "fill")

  # get flow accumulations
  flow_acc_file &lt;- tempfile("flow_acc", fileext = c(".tif"))
  flow_acc &lt;- ch_wbt_flow_accumulation(no_sink_raster_file, flow_acc_file)
  plot(flow_acc)
} else {
  message("Examples not run as Whitebox executable not found")
}
</code></pre>

<hr>
<h2 id='ch_wbt_flow_direction'>Creates flow direction grid file</h2><span id='topic+ch_wbt_flow_direction'></span>

<h3>Description</h3>

<p>Creates flow direction grid file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ch_wbt_flow_direction(fn_dem_ns, fn_flowdir, return_raster = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ch_wbt_flow_direction_+3A_fn_dem_ns">fn_dem_ns</code></td>
<td>
<p>File name of dem with sinks removed.</p>
</td></tr>
<tr><td><code id="ch_wbt_flow_direction_+3A_fn_flowdir">fn_flowdir</code></td>
<td>
<p>File name for flow direction grid to be created.</p>
</td></tr>
<tr><td><code id="ch_wbt_flow_direction_+3A_return_raster">return_raster</code></td>
<td>
<p>Should a raster object be returned?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If <code>return_raster = TRUE</code> (the default), the flow direction
grid will be returned as a raster object, in addition to being written to
<span class="option">fn_flowdir</span>. If <code>return_raster = FALSE</code>, the output file will still be created
but a <code>NULL</code> value is returned.
</p>


<h3>Author(s)</h3>

<p>Dan Moore
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Only proceed if Whitebox executable is installed
library(whitebox)
if (check_whitebox_binary()){
  library(raster)
  test_raster &lt;- ch_volcano_raster()
  dem_raster_file &lt;- tempfile(fileext = c(".tif"))
  no_sink_raster_file &lt;- tempfile("no_sinks", fileext = c(".tif"))

  # write test raster to file
  writeRaster(test_raster, dem_raster_file, format = "GTiff")

  # remove sinks
  removed_sinks &lt;- ch_wbt_removesinks(dem_raster_file, no_sink_raster_file, method = "fill")

  # get flow directions
  flow_dir_file &lt;- tempfile("flow_dir", fileext = c(".tif"))
  flow_dir &lt;- ch_wbt_flow_direction(no_sink_raster_file, flow_dir_file)
  plot(flow_dir)
} else {
  message("Examples not run as Whitebox executable not found")
}
</code></pre>

<hr>
<h2 id='ch_wbt_pourpoints'>Snap pour points to channels</h2><span id='topic+ch_wbt_pourpoints'></span>

<h3>Description</h3>

<p>Pour points describe the outlets of sub-basins within a DEM. To use
the pour points to delineate catchments, they must align with the drainage
network. This function snaps (forces the locations) of pour points to the
channels.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ch_wbt_pourpoints(
  pp_sf = NULL,
  fn_flowacc,
  fn_pp,
  fn_pp_snap,
  check_crs = TRUE,
  snap_dist = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ch_wbt_pourpoints_+3A_pp_sf">pp_sf</code></td>
<td>
<p><span class="pkg">sf</span> object containing pour points. These must be supplied by the user. See
the code in <code><a href="#topic+ch_volcano_pourpoints">ch_volcano_pourpoints</a></code> for an example of creating the object.</p>
</td></tr>
<tr><td><code id="ch_wbt_pourpoints_+3A_fn_flowacc">fn_flowacc</code></td>
<td>
<p>Name of file containing flow accumulations.</p>
</td></tr>
<tr><td><code id="ch_wbt_pourpoints_+3A_fn_pp">fn_pp</code></td>
<td>
<p>File name to create un-snapped pour points.</p>
</td></tr>
<tr><td><code id="ch_wbt_pourpoints_+3A_fn_pp_snap">fn_pp_snap</code></td>
<td>
<p>File name for snapped pour points.</p>
</td></tr>
<tr><td><code id="ch_wbt_pourpoints_+3A_check_crs">check_crs</code></td>
<td>
<p>If <code>TRUE</code> the projections of the pour points and flow
accumulation files will be checked to ensure they are identical.</p>
</td></tr>
<tr><td><code id="ch_wbt_pourpoints_+3A_snap_dist">snap_dist</code></td>
<td>
<p>Maximum snap distance in map units.</p>
</td></tr>
<tr><td><code id="ch_wbt_pourpoints_+3A_...">...</code></td>
<td>
<p>Additional parameters for <span class="pkg">whitebox</span> function <code>wbt_snap_pour_points</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a <span class="pkg">sf</span> object of the specified pour points snapped to the
channel network.
</p>


<h3>Author(s)</h3>

<p>Dan Moore
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ch_volcano_pourpoints">ch_volcano_pourpoints</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Only proceed if Whitebox executable is installed
library(whitebox)
if (check_whitebox_binary()){
  library(raster)
  test_raster &lt;- ch_volcano_raster()
  dem_raster_file &lt;- tempfile(fileext = c(".tif"))
  no_sink_raster_file &lt;- tempfile("no_sinks", fileext = c(".tif"))

  # write test raster to file
  writeRaster(test_raster, dem_raster_file, format = "GTiff")

  # remove sinks
  removed_sinks &lt;- ch_wbt_removesinks(dem_raster_file, no_sink_raster_file, method = "fill")

  # get flow accumulations
  flow_acc_file &lt;- tempfile("flow_acc", fileext = c(".tif"))
  flow_acc &lt;- ch_wbt_flow_accumulation(no_sink_raster_file, flow_acc_file)

  # get pour points
  pourpoint_file &lt;- tempfile("volcano_pourpoints", fileext = c(".shp"))
  pourpoints &lt;- ch_volcano_pourpoints(pourpoint_file)
  snapped_pourpoint_file &lt;- tempfile("snapped_pourpoints", fileext = c(".shp"))
  snapped_pourpoints &lt;- ch_wbt_pourpoints(pourpoints, flow_acc_file, pourpoint_file,
  snapped_pourpoint_file, snap_dist = 10)
} else {
  message("Examples not run as Whitebox executable not found")
}
</code></pre>

<hr>
<h2 id='ch_wbt_removesinks'>Removes sinks from a DEM</h2><span id='topic+ch_wbt_removesinks'></span>

<h3>Description</h3>

<p>Sinks are removed from a DEM using one of several methods. The raster file
types supported are listed in <code><a href="#topic+Spatial_hydrology_functions">Spatial_hydrology_functions</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ch_wbt_removesinks(
  in_dem,
  out_dem,
  method = "breach_leastcost",
  dist = NULL,
  fn_dem_fsc = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ch_wbt_removesinks_+3A_in_dem">in_dem</code></td>
<td>
<p>File path for original dem. Required.</p>
</td></tr>
<tr><td><code id="ch_wbt_removesinks_+3A_out_dem">out_dem</code></td>
<td>
<p>File path for dem after removing sinks.</p>
</td></tr>
<tr><td><code id="ch_wbt_removesinks_+3A_method">method</code></td>
<td>
<p>Method for removing sinks. Default method is <span class="option">breach_leastcost</span>. Other methods include
<span class="option">breach</span>, <span class="option">fill</span>, <span class="option">fill_pd</span> (Planchon and Darboux), and <span class="option">fill_wl</span> (Wang and Liu).</p>
</td></tr>
<tr><td><code id="ch_wbt_removesinks_+3A_dist">dist</code></td>
<td>
<p>Maximum search distance for breach paths in cells. Required if <code>method = "breach_leastcost"</code>.</p>
</td></tr>
<tr><td><code id="ch_wbt_removesinks_+3A_fn_dem_fsc">fn_dem_fsc</code></td>
<td>
<p>File path for dem after removing single-cell pits.</p>
</td></tr>
<tr><td><code id="ch_wbt_removesinks_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to functions to remove sinks.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a raster object containing the processed dem.
</p>


<h3>Author(s)</h3>

<p>Dan Moore
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Only proceed if Whitebox executable is installed
library(whitebox)
if (check_whitebox_binary()){
  library(raster)
  test_raster &lt;- ch_volcano_raster()
  dem_raster_file &lt;- tempfile(fileext = c(".tif"))
  no_sink_raster_file &lt;- tempfile("no_sinks", fileext = c(".tif"))

  # write test raster to file
  writeRaster(test_raster, dem_raster_file, format = "GTiff")

  # remove sinks
  removed_sinks &lt;- ch_wbt_removesinks(dem_raster_file, no_sink_raster_file, method = "fill")
} else {
  message("Examples not run as Whitebox executable not found")
}
</code></pre>

<hr>
<h2 id='ch_wtr_yr'>Designation of the water year</h2><span id='topic+ch_wtr_yr'></span>

<h3>Description</h3>

<p>Display water year
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ch_wtr_yr(dates, start_month = 10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ch_wtr_yr_+3A_dates">dates</code></td>
<td>
<p>A vector of dates with actual year</p>
</td></tr>
<tr><td><code id="ch_wtr_yr_+3A_start_month">start_month</code></td>
<td>
<p>Month in which the year starts (defaults to October)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Year starting in start_month
</p>


<h3>Source</h3>

<p>http://stackoverflow.com/questions/27626533/r-create-function-to-add-water-year-column
</p>


<h3>Examples</h3>

<pre><code class='language-R'>date &lt;- seq(as.Date("1910/1/1"), as.Date("1912/1/1"), "days")
wtr_yr_date &lt;- ch_wtr_yr(dates=date, start_month=10)
df &lt;- data.frame(wtr_yr_date, date)
</code></pre>

<hr>
<h2 id='CSHShydRology-package'>Functions for Canadian hydrological analyses</h2><span id='topic+CSHShydRology-package'></span>

<h3>Description</h3>

<p><span class="pkg">CSHShydRology</span> is intended for the use of hydrologists, particularly those in Canada. It will contain functions
which focus on the use of Canadian data sets, such as those from Environment Canada. The package will also contain functions which
are suited to Canadian hydrology, such as the important cold-region hydrological processes. <span class="pkg">CSHShydRology</span> will also contain
functions which work with Canadian hydrological models, such as Raven, CRHM, Watflood, and MESH.
</p>
<p>This packages has been developed with the assistance of the Canadian Society for Hydrological Sciences (CSHS) <a href="https://cshs.cwra.org/en">https://cshs.cwra.org/en</a>
which is an affiliated society of the Canadian Water Resources Association (CWRA) <a href="https://cwra.org/">https://cwra.org/</a>.
</p>
<p>The <span class="pkg">CSHShydRology</span> will contain functions grouped into several themes, including:
</p>

<dl>
<dt>Statistical hydrology</dt><dd><p>trend detection, data screening, frequency analysis, regionalization</p>
</dd>
<dt>Basic data manipulations</dt><dd><p>input/conversion/adapter functions, missing data infilling</p>
</dd>
<dt>Visualization</dt><dd><p>data visualization, standardized plotting functions</p>
</dd>
<dt>Spatial hydrology</dt><dd><p>basin delineation, landscape data analysis, working with GIS</p>
</dd>
<dt>Streamflow measurement analysis</dt><dd><p>rating curve analysis, velocity profiles, naturalization</p>
</dd>
<dt>Network design/analysis</dt><dd><p>homogeneity assessment</p>
</dd>
<dt>Ecohydrology</dt><dd><p>fisheries and ecological analysis</p>
</dd>
<dt>Wrappers/unwrappers</dt><dd><p>between other packages and <span class="pkg">CSHShydRology</span></p>
</dd>
</dl>



<h3>References</h3>

<p>To cite <span class="pkg">CSHShydRology</span> in publications, use the command <code>citation("CSHShydRology")</code> 
to get the current version of this citation.<br />
</p>

<hr>
<h2 id='flowAtlantic'>Annual maxima from sites in the Atlantic region of Canada</h2><span id='topic+flowAtlantic'></span>

<h3>Description</h3>

<p>Contains the annual maxima of 45 hydrometric stations found in the
region '01' of Water Survey of Canada.
In additional to the annual maxima, the output list includes catchment
descriptors (longitude, latitude, basin area, mean annual precipitation)
and the geographical distance between each station.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>flowAtlantic
</code></pre>


<h3>Format</h3>

<p>An object of class <code>list</code> of length 2.
</p>


<h3>Author(s)</h3>

<p>Martin Durocher
</p>


<h3>Source</h3>

<p><a href="https://wateroffice.ec.gc.ca/">https://wateroffice.ec.gc.ca/</a>
</p>

<hr>
<h2 id='HYDAT_list'>List of Water Survey of Canada hydrometic stations.</h2><span id='topic+HYDAT_list'></span>

<h3>Description</h3>

<p>A dataframe of station information, as extracted from HYDAT using ECDataExplorer.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>HYDAT_list
</code></pre>


<h3>Format</h3>

<p>A dateframe with a row for each station and 20 columns.
</p>


<h3>Details</h3>

<p>Variables: 
</p>

<dl>
<dt>Station</dt><dd><p>StationID</p>
</dd>
<dt>StationName</dt><dd><p>Station Name</p>
</dd>
<dt>HYDStatus</dt><dd><p>Active or Discontinued</p>
</dd>
<dt>Prov</dt><dd><p>Province</p>
</dd>
<dt>Latitude</dt><dd></dd>
<dt>Longitude</dt><dd></dd>
<dt>DrainageArea</dt><dd><p>km<code class="reqn">^2</code></p>
</dd>
<dt>Years</dt><dd><p>Number of years with data</p>
</dd>
<dt>From</dt><dd><p>Start Year</p>
</dd>
<dt>To</dt><dd><p>End Year</p>
</dd>
<dt>Reg.</dt><dd><p>Regulated</p>
</dd>
<dt>Flow</dt><dd><p>If TRUE/Yes</p>
</dd>
<dt>Level</dt><dd><p>If TRUE/Yes</p>
</dd>
<dt>Sed</dt><dd><p>If TRUE/Yes</p>
</dd>
<dt>OperSched</dt><dd><p>Continuous or Seasonal</p>
</dd>
<dt>RealTime</dt><dd><p>If TRUE/Yes</p>
</dd>
<dt>RHBN</dt><dd><p>If TRUE/Yes the station is in the reference hydrologic basin network</p>
</dd>
<dt>Region</dt><dd><p>ECCC Region</p>
</dd>
<dt>Datum</dt><dd><p>Reference datum</p>
</dd>
<dt>Operator</dt><dd><p>Operator</p>
</dd>
</dl>



<h3>Source</h3>

<p>Water Survey of Canada
</p>

<hr>
<h2 id='Spatial_hydrology_functions'>Spatial Hydrology functions</h2><span id='topic+Spatial_hydrology_functions'></span>

<h3>Description</h3>

<p>These functions perform spatial analyses important in hydrology. All
of the functions with the prefix <code>ch_wbt</code> require the installation of the
package <span class="pkg">Whitebox</span>. The functions include:
</p>

<dl>
<dt>ch_wbt_removesinks</dt><dd><p>Removes sinks from a DEM by deepening drainage network</p>
</dd>
<dt>ch_wbt_fillsinks</dt><dd><p>Removes sinks from a DEM by filling them</p>
</dd>
<dt>ch_wbt_catchment</dt><dd><p>Generates catchment boundaries for a conditioned DEM based on specified points of interest</p>
</dd>
<dt>ch_wbt_channels</dt><dd><p>Generates a drainage network from DEM</p>
</dd>
<dt>ch_wbt_flow_accumulation</dt><dd><p>Accumulates flows downstream in a cathcment</p>
</dd>
<dt>ch_wbt_flow_direction</dt><dd><p>Calculated flow directions for each cell in DEM</p>
</dd>
<dt>ch_wbt_pourpoints</dt><dd><p>Snaps pour points to channel</p>
</dd>
<dt>ch_wbt_catchment_onestep</dt><dd><p>Performs all catchment delineations in a single function</p>
</dd>
<dt>ch_contours</dt><dd><p>Creates contour lines from DEM</p>
</dd>
<dt>ch_checkcatchment</dt><dd><p>Provides a simple map to check the outputs from ch_saga_catchment</p>
</dd>
<dt>ch_checkchannels</dt><dd><p>Provides a simple map to check the outputs from ch_saga_channels</p>
</dd>
<dt>ch_volcano_raster</dt><dd><p>Returns a raster object of land surface elevations</p>
</dd>
</dl>

<p>The <span class="pkg">Whitebox</span> functions support the following file types for raster data:
</p>

<dl>
<dt>type</dt><dd><p>extension</p>
</dd>
<dt>GeoTIFF</dt><dd><p>*.tif, *.tiff</p>
</dd>
<dt>Big GeoTIFF</dt><dd><p>*.tif, *.tiff</p>
</dd>
<dt>Esri ASCII</dt><dd><p>*.txt, *.asc</p>
</dd>
<dt>Esri BIL</dt><dd><p>*.flt, *.hdr</p>
</dd>
<dt>GRASS ASCII</dt><dd><p>*.txt, *.asc</p>
</dd>
<dt>Idrisi</dt><dd><p>*.rdc, *.rst</p>
</dd>
<dt>SAGA Binary</dt><dd><p>*.sdat, *.sgrd</p>
</dd>
<dt>Surfer ASCII</dt><dd><p>*.grd</p>
</dd>
<dt>Surfer Binary</dt><dd><p>*.grd</p>
</dd>
<dt>Whitebox</dt><dd><p>*.tas, *.dep</p>
</dd>
</dl>


<hr>
<h2 id='StatisticalHydrology-functions'>Statistical analysis functions</h2><span id='topic+StatisticalHydrology-functions'></span>

<h3>Description</h3>

<p>These functions perform statistical analyses
</p>

<dl>
<dt>ch_binned_MannWhitney</dt><dd><p> Compares two time periods of data using Mann-Whitney test</p>
</dd>
<dt>ch_fdcurve</dt><dd><p>Finds flow exceedence probabilities</p>
</dd>
<dt>ch_get_peaks</dt><dd><p>Finds peak flows over a specified threshold</p>
</dd>
</dl>


<hr>
<h2 id='Visualization-functions'>Visualization functions</h2><span id='topic+Visualization-functions'></span>

<h3>Description</h3>

<p>These functions are primarily intended for graphing, although
some analyses may also be done.
</p>

<dl>
<dt>ch_booth_plot</dt><dd><p>Plot of peaks over a threshold</p>
</dd>
<dt>ch_flow_raster</dt><dd><p>Raster plot of streamflows</p>
</dd>
<dt>ch_flow_raster_qa</dt><dd><p>Raster plot of streamflows with WSC quality flags</p>
</dd>
<dt>ch_flow_raster_trend</dt><dd><p>Raster plot and simple trends of observed streamflows</p>
</dd>
<dt>ch_hydrograph_plot</dt><dd><p>Plots hydrographs and/or precipitation</p>
</dd>
<dt>ch_polar_plot</dt><dd><p>Polar plot of daily streamflows</p>
</dd>
<dt>ch_regime_plot</dt><dd><p>Plots the regime of daily streamflows</p>
</dd>
</dl>


</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
