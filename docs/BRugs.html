<!DOCTYPE html><html><head><title>Help for package BRugs</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {BRugs}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bgrPoint'><p>Internal functions (to support plotting the Gelman-Rubin convergence statistic)</p></a></li>
<li><a href='#BRugs'><p>Introduction to BRugs</p></a></li>
<li><a href='#BRugsFit'><p>BRugs' meta function</p></a></li>
<li><a href='#buffer'><p>Reading OpenBUGS buffer file</p></a></li>
<li><a href='#bugsData'><p>Writing input for OpenBUGS</p></a></li>
<li><a href='#bugsInits'><p>Writing input for OpenBUGS</p></a></li>
<li><a href='#buildMCMC'><p>Generating mcmc.list objects for package coda</p></a></li>
<li><a href='#dic'><p>DIC</p></a></li>
<li><a href='#dimensions'><p>Dimension of BUGS variables</p></a></li>
<li><a href='#getChain'><p>Current chain to be initialized</p></a></li>
<li><a href='#getNumChains'><p>Number of chains</p></a></li>
<li><a href='#help.WinBUGS'><p>WinBUGS documentation</p></a></li>
<li><a href='#infoMemory'><p>Show memory usage</p></a></li>
<li><a href='#infoModules'><p>Loaded modules</p></a></li>
<li><a href='#infoNode'><p>Node information</p></a></li>
<li><a href='#infoUpdaters'><p>Information on MCMC updaters</p></a></li>
<li><a href='#loadOpenBUGS'><p>Load OpenBUGS from given directory</p></a></li>
<li><a href='#modelAdaptivePhase'><p>Getting length of adaptive phase</p></a></li>
<li><a href='#modelCheck'><p>Checking the model file</p></a></li>
<li><a href='#modelCompile'><p>Compiling the model</p></a></li>
<li><a href='#modelData'><p>Loading the data</p></a></li>
<li><a href='#modelFactory'><p>Enable and disable factories to create updaters</p></a></li>
<li><a href='#modelGenInits'><p>Generating initial values</p></a></li>
<li><a href='#modelInits'><p>Loading initial values</p></a></li>
<li><a href='#modelIteration'><p>Returns number of iterations</p></a></li>
<li><a href='#modelNames'><p>Get variable names in model</p></a></li>
<li><a href='#modelPrecision'><p>Setting precision for prec figures</p></a></li>
<li><a href='#modelRN'><p>State of Random Number Generator</p></a></li>
<li><a href='#modelSaveState'><p>Save the model's current state</p></a></li>
<li><a href='#modelSetAP'><p>Changing settings of updating algorithms</p></a></li>
<li><a href='#modelSetWD'><p>Set working directory</p></a></li>
<li><a href='#modelUpdate'><p>Updating the model</p></a></li>
<li><a href='#plotAutoC'><p>Plot autocorrelation function for a scalar variable</p></a></li>
<li><a href='#plotBgr'><p>Plot the Gelman-Rubin convergence statistic for a scalar variable</p></a></li>
<li><a href='#plotDensity'><p>Plot density estimate or histogram of a scalar variable</p></a></li>
<li><a href='#plotHistory'><p>Trace of a scalar variable</p></a></li>
<li><a href='#ranks'><p>Calculation of ranks</p></a></li>
<li><a href='#rats'><p>ratsdata example</p></a></li>
<li><a href='#samplesAutoC'><p>Plot autocorrelation function</p></a></li>
<li><a href='#samplesBgr'><p>Plot the Gelman-Rubin convergence statistic</p></a></li>
<li><a href='#samplesClear'><p>Clear recorded values</p></a></li>
<li><a href='#samplesCoda'><p>Writing files in CODA format</p></a></li>
<li><a href='#samplesCorrel'><p>Correlation</p></a></li>
<li><a href='#samplesDensity'><p>Plot density estimate or histogram</p></a></li>
<li><a href='#samplesGet'><p>Get settings used for calculations</p></a></li>
<li><a href='#samplesHistory'><p>Trace of a variable</p></a></li>
<li><a href='#samplesMonitors'><p>Names of monitored scalar variables</p></a></li>
<li><a href='#samplesSample'><p>Stored values</p></a></li>
<li><a href='#samplesSet'><p>Start recording</p></a></li>
<li><a href='#samplesSetting'><p>Change settings used for calculations</p></a></li>
<li><a href='#samplesSize'><p>Size of the stored sample</p></a></li>
<li><a href='#samplesStats'><p>Calculate summary statistics</p></a></li>
<li><a href='#setValues'><p>Setting current values</p></a></li>
<li><a href='#summary'><p>Summary of MCMC simulation</p></a></li>
<li><a href='#write.datafile'><p>Write data for OpenBUGS - intended for internal use only</p></a></li>
<li><a href='#writeModel'><p>Creating an OpenBUGS model file</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Interface to the 'OpenBUGS' MCMC Software</td>
</tr>
<tr>
<td>Version:</td>
<td>0.9-2.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2017-06-26</td>
</tr>
<tr>
<td>Author:</td>
<td>OpenBUGS was developed by Andrew Thomas, Dave Lunn, David Spiegelhalter and Nicky Best.  R interface developed by Uwe Ligges, Sibylle Sturtz, Andrew Gelman, Gregor Gorjanc and Chris Jackson.  Linux port and most recent developments by Chris Jackson.</td>
</tr>
<tr>
<td>Description:</td>
<td>Fully-interactive R interface to the 'OpenBUGS' software for Bayesian analysis using MCMC sampling.  Runs natively and stably in 32-bit R under Windows.  Versions running on x86Linux and on 64-bit R under Windows are in "beta" status and less efficient.</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Uwe Ligges &lt;ligges@statistik.tu-dortmund.de&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.3.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>utils, coda, grDevices, graphics, stats</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>OpenBUGS (&gt;= 3.2.2), hence Windows or x86 Linux</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-12 09:05:37 UTC; ripley</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-25 11:12:54 UTC</td>
</tr>
</table>
<hr>
<h2 id='bgrPoint'>Internal functions (to support plotting the Gelman-Rubin convergence statistic)</h2><span id='topic+bgrGrid'></span><span id='topic+bgrPoint'></span>

<h3>Description</h3>

<p>These functions are for internal use only. 
They support <code><a href="#topic+samplesBgr">samplesBgr</a></code> and <code><a href="#topic+plotBgr">plotBgr</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bgrGrid(node, bins = 50)
bgrPoint(sample)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bgrPoint_+3A_node">node</code></td>
<td>
<p>Character vector of length 1, name of a variable in the model.</p>
</td></tr>
<tr><td><code id="bgrPoint_+3A_bins">bins</code></td>
<td>
<p>Blocksize</p>
</td></tr>
<tr><td><code id="bgrPoint_+3A_sample">sample</code></td>
<td>
<p>Monitored sample from multiple chains to calculate the
convergence statistic for.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Intended for internal use only.</p>


<h3>See Also</h3>

<p><code><a href="#topic+samplesBgr">samplesBgr</a></code>, <code><a href="#topic+BRugs">BRugs</a></code>, <code><a href="#topic+help.WinBUGS">help.WinBUGS</a></code></p>

<hr>
<h2 id='BRugs'>Introduction to BRugs</h2><span id='topic+BRugs'></span><span id='topic+help.BRugs'></span>

<h3>Description</h3>

<p>This manual describes how to use the BRugs software</p>


<h3>Usage</h3>

<pre><code class='language-R'>help.BRugs(browser = getOption("browser"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BRugs_+3A_browser">browser</code></td>
<td>
<p>the name of the program to be used as hypertext browser.
It should be in the PATH, or a full path specified.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>BRugs is a collection of R functions that
allow users to analyze graphical models using MCMC techniques. Most of the R functions in BRugs provide a
interface to the BRugs dynamic link library (shared object file). The BRugs dynamic link library is able to make
use of many of the WinBUGS components, in particular those components concerned with graphical models and MCMC
simulation. BRugs lacks the GUI interface of WinBUGS but is able to use R to create graphical displays of the
MCMC simulation. BRugs uses the same model specification language as WinBUGS and the same format for data and
initial values. However BRugs always uses plain text files for input inplace of WinBUGS compound documents. The
BRugs functions can be split into two groups: those associated with setting up and simulating the graphical model
and those associated with making statistical inference. In general the R functions in BRugs correspond to the
command buttons and text entry fields in the menus of WinBUGS. Each WinBUGS text entry field splits into two
R functions, one to set the quantity and the other to get the value of the quantity.
</p>
<p>Andrew Gelman suggests to use the function <code>bugs</code> in the <span class="pkg">R2WinBUGS</span> package
with argument <code>program="openbugs"</code> as a wrapper.
</p>


<h3>Permission and Disclaimer</h3>

<p>BRugs is released under the GNU GENERAL PUBLIC LICENSE.
For details type <code>help.BRugs()</code>.
</p>
<p>More informally, potential users are reminded to be extremely careful if using this program for serious
statistical analysis. We have tested the program on quite a wide set of examples, but be particularly careful
with types of model that are currently not featured. If there is a problem, BRugs might just crash, which is not
very good, but it might well carry on and produce answers that are wrong, which is even worse. Please let us know
of any successes or failures.
</p>
<p>If BRugs does cause R to crash, it is advised to run the model from
within the Windows interface to OpenBUGS.  This should give a &quot;Trap&quot;
window, which indicates an internal problem with OpenBUGS.
</p>


<p>for suggestions for how to interpret these problematic error
messages.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+help.WinBUGS">help.WinBUGS</a></code> (which currently is called from <code>help.BRugs</code>) and the meta function <code><a href="#topic+BRugsFit">BRugsFit</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
###    Step by step example:    ###
library("BRugs") # loading BRugs

## Prepare the example files in a temporary directory
exfiles &lt;- dir(options()$OpenBUGSExamples, pattern="^Rats.*txt$", full.names=TRUE)
ok &lt;- file.copy(exfiles, tempdir())

## Now setting the working directory to the temporary one:
oldwd &lt;- setwd(tempdir())

## some usual steps (like clicking in WinBUGS):
modelCheck("Ratsmodel.txt")          # check model file
modelData("Ratsdata.txt")            # read data file
modelCompile(numChains=2)            # compile model with 2 chains
modelInits(rep("Ratsinits.txt", 2))  # read init data file
modelUpdate(1000)                    # burn in
samplesSet(c("alpha0", "alpha"))     # alpha0 and alpha should be monitored
modelUpdate(1000)                    # 1000 more iterations ....

samplesStats("*")                    # the summarized results

## some plots
samplesHistory("*", mfrow = c(4, 2)) # plot the chain,
samplesDensity("alpha")              # plot the densities,
samplesBgr("alpha[1:6]")             # plot the bgr statistics, and
samplesAutoC("alpha[1:6]", 1)        # plot autocorrelations of 1st chain

## switch back to the previous working directory:
setwd(oldwd)

## Not run: 
# Getting more (online-)help:
help.BRugs()

## End(Not run)</code></pre>

<hr>
<h2 id='BRugsFit'>BRugs' meta function</h2><span id='topic+BRugsFit'></span>

<h3>Description</h3>

<p>This function takes model, data and starting values as input and automatically runs a simulation in BRugs.</p>


<h3>Usage</h3>

<pre><code class='language-R'>BRugsFit(modelFile, data, inits, numChains = 3, parametersToSave,
    nBurnin = 1000, nIter = 1000, nThin = 1, coda = FALSE,
    DIC = TRUE, working.directory = NULL, digits = 5, seed=NULL,
    BRugsVerbose = getOption("BRugsVerbose"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BRugsFit_+3A_modelfile">modelFile</code></td>
<td>
<p>File containing the model written in OpenBUGS code,
an R function that contains a BUGS model that is written to a temporary model file (see <code><a href="base.html#topic+tempfile">tempfile</a></code>) using <code><a href="#topic+writeModel">writeModel</a></code>.</p>
</td></tr>
<tr><td><code id="BRugsFit_+3A_data">data</code></td>
<td>
<p>Either a named list (names corresponding to variable names in the <code>modelFile</code>)
of the data for the OpenBUGS model, <em>or</em>
a vector or list of the names of the data objects used by the model.
In these cases data are written into a file &lsquo;<span class="file">data.txt</span>&rsquo; into the temporary directory of the current R session.
</p>
<p>If a filename of an existing file is given, data are read from that file.</p>
</td></tr>
<tr><td><code id="BRugsFit_+3A_inits">inits</code></td>
<td>
<p>A list with <code>numChains</code> elements; each element of the list is
itself a list of starting values for the OpenBUGS model, <em>or</em>
a function creating (possibly random) initial values.
In these cases inits are written into files &lsquo;<span class="file">inits1.txt</span>&rsquo;, ..., &lsquo;<span class="file">initsN.txt</span>&rsquo; into the temporary directory of the current R session.
</p>
<p>If a vector of filenames of existing files is given, inits are read from those files.
Alternatively, if <code>inits</code> is not specified, initial values are generated by OpenBUGS.</p>
</td></tr>
<tr><td><code id="BRugsFit_+3A_numchains">numChains</code></td>
<td>
<p>Number of Markov chains (default: 3).</p>
</td></tr>
<tr><td><code id="BRugsFit_+3A_parameterstosave">parametersToSave</code></td>
<td>
<p>Character vector of the names of the parameters to save which should be monitored.</p>
</td></tr>
<tr><td><code id="BRugsFit_+3A_nburnin">nBurnin</code></td>
<td>
<p>Length of burn in (before <code>nIter</code> iterations start).</p>
</td></tr>
<tr><td><code id="BRugsFit_+3A_niter">nIter</code></td>
<td>
<p>Number of iterations (without burn in).</p>
</td></tr>
<tr><td><code id="BRugsFit_+3A_nthin">nThin</code></td>
<td>
<p>Every <code>nThin</code>-th iteration of each chain is stored.</p>
</td></tr>
<tr><td><code id="BRugsFit_+3A_coda">coda</code></td>
<td>
<p>Determines the output format: if <code>FALSE</code> (default), a list containing sample and DIC statistics is returned.
If <code>TRUE</code>, an <code><a href="coda.html#topic+mcmc.list">mcmc.list</a></code> object as known from the <span class="pkg">coda</span> package is returned.</p>
</td></tr>
<tr><td><code id="BRugsFit_+3A_dic">DIC</code></td>
<td>
<p>Logical, whether to calculate and return the DIC.</p>
</td></tr>
<tr><td><code id="BRugsFit_+3A_working.directory">working.directory</code></td>
<td>
<p>Sets working directory during execution of this function;
<code>data</code>, <code>inits</code> and other files are written to / read from this directory if no other directory
is explicitly given in those arguments.
If <code>NULL</code>, the current working directory is chosen.</p>
</td></tr>
<tr><td><code id="BRugsFit_+3A_digits">digits</code></td>
<td>
<p>Number of significant digits used for OpenBUGS input, see <code><a href="base.html#topic+formatC">formatC</a></code>.</p>
</td></tr>
<tr><td><code id="BRugsFit_+3A_seed">seed</code></td>
<td>
<p>Integer value from 1 to 14 defining the state of the random number
generator - default is to not specify the state (see <code><a href="#topic+modelSetRN">modelSetRN</a></code>).</p>
</td></tr>
<tr><td><code id="BRugsFit_+3A_brugsverbose">BRugsVerbose</code></td>
<td>
<p>Logical, whether BRugs is supposed to be verbose.
This can be controlled for the whole BRugs package by by the option &lsquo;BRugsVerbose&rsquo; (see <code><a href="base.html#topic+options">options</a></code>)
which is set to <code>TRUE</code> by default.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If <code>coda</code> is set to <kbd>TRUE</kbd>, an <code><a href="coda.html#topic+mcmc.list">mcmc.list</a></code> object as known from the <span class="pkg">coda</span> package is returned,
otherwise a list containg components
</p>
<table>
<tr><td><code>Stats</code></td>
<td>
<p>A data frame containing sample statistics. See <code><a href="#topic+samplesStats">samplesStats</a></code>.</p>
</td></tr>
<tr><td><code>DIC</code></td>
<td>
<p>The DIC statistics, if <code>DIC=TRUE</code>, else <code>NULL</code>. See <code><a href="#topic+dicStats">dicStats</a></code>.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+BRugs">BRugs</a></code>, <code><a href="#topic+help.WinBUGS">help.WinBUGS</a></code>.
Andrew Gelman proposes some <code>print</code> and <code>plot</code> methods that can be accessed by the
<code>openbugs</code> (and <code>bugs</code>) and <code>as.bugs.array</code> functions in the CRAN package <span class="pkg">R2WinBUGS</span>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Prepare the example files in a temporary directory
exfiles &lt;- dir(options()$OpenBUGSExamples, pattern="^Rats.*txt$", full.names=TRUE)
ok &lt;- file.copy(exfiles, tempdir())
BRugsFit(data = "Ratsdata.txt", inits = "Ratsinits.txt",
    para = c("alpha", "beta"), modelFile = "Ratsmodel.txt",
    numChains = 1,
    working.directory = tempdir())

</code></pre>

<hr>
<h2 id='buffer'>Reading OpenBUGS buffer file</h2><span id='topic+buffer'></span>

<h3>Description</h3>

<p>Reads OpenBUGS buffer file, internally used for intefacing to OpenBUGS.</p>


<h3>Usage</h3>

<pre><code class='language-R'>buffer()
</code></pre>


<h3>Value</h3>

<p>Prints the buffer, returns nothing.</p>


<h3>See Also</h3>

<p><code><a href="#topic+BRugs">BRugs</a></code>, <code><a href="#topic+help.WinBUGS">help.WinBUGS</a></code></p>

<hr>
<h2 id='bugsData'>Writing input for OpenBUGS</h2><span id='topic+bugsData'></span>

<h3>Description</h3>

<p>Write data file for OpenBUGS.</p>


<h3>Usage</h3>

<pre><code class='language-R'>bugsData(data, fileName = file.path(tempdir(), "data.txt"),
         format="E", digits = 5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bugsData_+3A_data">data</code></td>
<td>
<p>Either a named list (names corresponding to variable names in the model file)
of the data for the OpenBUGS model, <em>or</em>
a vector or list of the names of the data objects used by the model</p>
</td></tr>
<tr><td><code id="bugsData_+3A_filename">fileName</code></td>
<td>
<p>The filename, defaults to &lsquo;<span class="file">data.txt</span>&rsquo; in the temporary directory of the current R session</p>
</td></tr>
<tr><td><code id="bugsData_+3A_format">format</code></td>
<td>
<p>String to pass to
<code><a href="base.html#topic+formatC">formatC</a></code> which controls formatting of numbers. The default <code>"E"</code> formats all numbers in
scientific notation.  The alternative <code>"fg"</code> uses a standard format,
which is more readable but less safe for extreme numbers.  </p>
</td></tr>
<tr><td><code id="bugsData_+3A_digits">digits</code></td>
<td>
<p>Number of significant digits used for OpenBUGS input,
see <code><a href="base.html#topic+formatC">formatC</a></code>.  This may need to be adjusted from the
default of 5, for example when writing large integers.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Invisibly returns the <code>fileName</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+BRugs">BRugs</a></code></p>

<hr>
<h2 id='bugsInits'>Writing input for OpenBUGS</h2><span id='topic+bugsInits'></span>

<h3>Description</h3>

<p>Write files containing initial values.</p>


<h3>Usage</h3>

<pre><code class='language-R'>bugsInits(inits, numChains = 1, fileName, format="E", digits = 5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bugsInits_+3A_inits">inits</code></td>
<td>
<p>a list with <code>n.chains</code> elements; each element of the list is
itself a list of starting values for the OpenBUGS model, <em>or</em>
a function creating (possibly random) initial values</p>
</td></tr>
<tr><td><code id="bugsInits_+3A_numchains">numChains</code></td>
<td>
<p>number of Markov chains</p>
</td></tr>
<tr><td><code id="bugsInits_+3A_filename">fileName</code></td>
<td>
<p>the filename(s), one for each chain.
Defaults to &lsquo;<span class="file">inits1.txt</span>&rsquo;, ..., &lsquo;<span class="file">initsN.txt</span>&rsquo; in the temporary directory of the current R session.</p>
</td></tr>
<tr><td><code id="bugsInits_+3A_format">format</code></td>
<td>
<p>String to pass to
<code><a href="base.html#topic+formatC">formatC</a></code> which controls formatting of numbers. The default <code>"E"</code> formats all numbers in
scientific notation.  The alternative <code>"fg"</code> uses a standard format.  </p>
</td></tr>
<tr><td><code id="bugsInits_+3A_digits">digits</code></td>
<td>
<p>number of significant digits used for OpenBUGS input, see <code><a href="base.html#topic+formatC">formatC</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Invisibly returns the <code>fileName</code>(s).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+BRugs">BRugs</a></code></p>

<hr>
<h2 id='buildMCMC'>Generating mcmc.list objects for package coda</h2><span id='topic+buildMCMC'></span>

<h3>Description</h3>

<p>This functions reads samples from OpenBUGS and converts the results into an object of class mcmc.list
that can directly be used by package coda for further analysis.</p>


<h3>Usage</h3>

<pre><code class='language-R'>buildMCMC(node, beg = samplesGetBeg(), end = samplesGetEnd(), 
    firstChain = samplesGetFirstChain(), 
    lastChain = samplesGetLastChain(), thin = samplesGetThin())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="buildMCMC_+3A_node">node</code></td>
<td>
<p>Character vector of length 1, name of a variable in the model.</p>
</td></tr>
<tr><td><code id="buildMCMC_+3A_beg">beg</code>, <code id="buildMCMC_+3A_end">end</code></td>
<td>
<p>Arguments to select a slice of monitored values corresponding to iterations <code>beg:end</code>.</p>
</td></tr>
<tr><td><code id="buildMCMC_+3A_firstchain">firstChain</code>, <code id="buildMCMC_+3A_lastchain">lastChain</code></td>
<td>
<p>Arguments to select a sub group of chains.</p>
</td></tr>
<tr><td><code id="buildMCMC_+3A_thin">thin</code></td>
<td>
<p>To only use every <code>thin</code>-th value of the stored sample.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the variable of interest is an array, slices of the array can be selected using the notation 
<code>variable[lower0:upper0, lower1:upper1, ...]</code>. 
A star &lsquo;<code>*</code>&rsquo; can be entered as shorthand for all the stored samples.
</p>
<p>If the arguments are left at their defaults the whole sample for all chains will be used for calculation.</p>


<h3>Value</h3>

<p>An object of class <code><a href="coda.html#topic+mcmc.list">mcmc.list</a></code> which is a list containing <code><a href="coda.html#topic+mcmc">mcmc</a></code> objects.
</p>


<h3>See Also</h3>

<p><code><a href="coda.html#topic+mcmc.list">mcmc.list</a></code>, <code><a href="coda.html#topic+mcmc">mcmc</a></code>, <code><a href="#topic+BRugs">BRugs</a></code>, <code><a href="#topic+help.WinBUGS">help.WinBUGS</a></code></p>

<hr>
<h2 id='dic'>DIC</h2><span id='topic+dicStats'></span><span id='topic+dicSet'></span><span id='topic+dicClear'></span>

<h3>Description</h3>

<p>These functions are used to evaluate the Deviance Information Criterion.</p>


<h3>Usage</h3>

<pre><code class='language-R'>dicSet()
dicStats()
dicClear()
</code></pre>


<h3>Details</h3>

<p>These functions are used to evaluate the Deviance Information Criterion (DIC; Spiegelhalter et al., 2002) 
and related statistics - these can be used to assess model complexity and compare different models. 
Most of the examples packaged with OpenBUGS contain an example of their usage.
</p>
<p>It is important to note that DIC assumes the posterior mean to be a good estimate of the stochastic parameters. 
If this is not so, say because of extreme skewness or even bimodality, 
then DIC may not be appropriate. 
There are also circumstances, such as with mixture models, 
in which OpenBUGS will not permit the calculation of DIC and so the menu option is greyed out. 
Please see <code><a href="#topic+help.WinBUGS">help.WinBUGS</a></code> for restrictions.
</p>


<h3>Value</h3>

<p><code>dicStats</code> returns a data frame with columns:
</p>
<table>
<tr><td><code>Dbar</code></td>
<td>
<p>The posterior mean of the deviance, which is exactly the same as if the node 
&lsquo;deviance&rsquo; had been monitored. This deviance is defined as -2 * log(likelihood): 
&lsquo;likelihood&rsquo; is defined as p(y | theta), where y comprises all stochastic nodes given values (i.e. data), 
and theta comprises the stochastic parents of y - &lsquo;stochastic parents&rsquo; are the stochastic nodes 
upon which the distribution of y depends, when collapsing over all logical relationships.</p>
</td></tr>
<tr><td><code>Dhat</code></td>
<td>
<p>A point estimate of the deviance (-2 * log(likelihood)) obtained by substituting in the 
posterior means theta.bar of theta: thus Dhat = -2 * log(p(y | theta.bar)).</p>
</td></tr>
<tr><td><code>pD</code></td>
<td>
<p>The effective number of parameters is given by pD = Dbar - Dhat. 
Thus pD is the posterior mean of the deviance minus the deviance of the posterior means.</p>
</td></tr>
<tr><td><code>DIC</code></td>
<td>
<p>The Deviance Information Criterion is given by DIC = Dbar + pD = Dhat + 2 * pD. 
The model with the smallest DIC is estimated to be the model that would best predict a replicate 
dataset of the same structure as that currently observed.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Users should ensure their simulation has converged before using these functions.
If the MCMC simulation has an adaptive phase it will not be possible to make inference 
using values sampled before the end of this phase.</p>


<h3>References</h3>

  
<p>Spiegelhalter, D.J., Best, N.G., Carlin B.P., and van der Linde, A. (2002):
Bayesian measures of model complexity and fit (with discussion). <em>J. Roy. Statist. Soc. B.</em> 64, 583-640.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+BRugs">BRugs</a></code>, <code><a href="#topic+help.WinBUGS">help.WinBUGS</a></code></p>

<hr>
<h2 id='dimensions'>Dimension of BUGS variables </h2><span id='topic+dimensions'></span>

<h3>Description</h3>

<p>This function is intended for internal use only.</p>


<h3>Usage</h3>

<pre><code class='language-R'>dimensions(node)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dimensions_+3A_node">node</code></td>
<td>
<p>Character vector of length 1, name of a variable in the model.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Dimension of BUGS variable specified by <code>node</code>, if it is a non-scalar one, else NULL.</p>


<h3>See Also</h3>

<p><code><a href="#topic+BRugs">BRugs</a></code>, <code><a href="#topic+help.WinBUGS">help.WinBUGS</a></code></p>

<hr>
<h2 id='getChain'>Current chain to be initialized</h2><span id='topic+getChain'></span>

<h3>Description</h3>

<p>This function is intended for internal use only.</p>


<h3>Usage</h3>

<pre><code class='language-R'>getChain()
</code></pre>


<h3>Value</h3>

<p>Number of the chain to be initialized next.</p>


<h3>See Also</h3>

<p><code><a href="#topic+BRugs">BRugs</a></code>, <code><a href="#topic+help.WinBUGS">help.WinBUGS</a></code></p>

<hr>
<h2 id='getNumChains'>Number of chains</h2><span id='topic+getNumChains'></span>

<h3>Description</h3>

<p>This function returns the number of chains being simulated.</p>


<h3>Usage</h3>

<pre><code class='language-R'>getNumChains()
</code></pre>


<h3>Value</h3>

<p>Returns the number of chains from the current simulation.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+BRugs">BRugs</a></code>, <code><a href="#topic+help.WinBUGS">help.WinBUGS</a></code></p>

<hr>
<h2 id='help.WinBUGS'>WinBUGS documentation</h2><span id='topic+help.WinBUGS'></span>

<h3>Description</h3>

<p>Function that open the html version of the OpenBUGS manual</p>


<h3>Usage</h3>

<pre><code class='language-R'>    help.WinBUGS(browser = getOption("browser"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="help.WinBUGS_+3A_browser">browser</code></td>
<td>
<p>the name of the program to be used as hypertext browser. It should be in the PATH, or a full path specified.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Not yet available in S-PLUS.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+help.BRugs">help.BRugs</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
help.WinBUGS() 

## End(Not run)
</code></pre>

<hr>
<h2 id='infoMemory'>Show memory usage</h2><span id='topic+infoMemory'></span>

<h3>Description</h3>

<p>Shows the amount of memory allocated to OpenBUGS</p>


<h3>Usage</h3>

<pre><code class='language-R'>infoMemory()
</code></pre>


<h3>Value</h3>

<p>Amount of memory allocated to OpenBUGS, in bytes.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+BRugs">BRugs</a></code>, <code><a href="#topic+help.WinBUGS">help.WinBUGS</a></code></p>

<hr>
<h2 id='infoModules'>Loaded modules</h2><span id='topic+infoModules'></span>

<h3>Description</h3>

<p>Displays all the modules (dynamic link libraries) in use.</p>


<h3>Usage</h3>

<pre><code class='language-R'>infoModules()
</code></pre>


<h3>Value</h3>

<p>Dataframe containing information on all the modules (dynamic link libraries) in use.</p>


<h3>See Also</h3>

<p><code><a href="#topic+BRugs">BRugs</a></code>, <code><a href="#topic+help.WinBUGS">help.WinBUGS</a></code></p>

<hr>
<h2 id='infoNode'>Node information</h2><span id='topic+infoNodeValues'></span><span id='topic+infoNodeMethods'></span><span id='topic+infoNodeTypes'></span>

<h3>Description</h3>

<p>List current values, data types and samplers corresponding to a variable.</p>


<h3>Usage</h3>

<pre><code class='language-R'>infoNodeValues(nodeLabel)
infoNodeMethods(nodeLabel)
infoNodeTypes(nodeLabel)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="infoNode_+3A_nodelabel">nodeLabel</code></td>
<td>
<p>Character vector of length 1, name of a variable in the model.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>infoNodeValues</code> returns a vector of the current (last sampled)
values of a variable.
</p>
<p><code>infoNodeMethods</code> returns a data frame listing the method used
internally by OpenBUGS to sample values from the full conditional
distribution of the node. 
</p>
<p><code>infoNodeTypes</code> returns a data frame listing the OpenBUGS data
type which represents each node internally. For example, stochastic
nodes with normal priors are of type <code>GraphNormal.StdNode</code>. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+setValues">setValues</a></code>, <code><a href="#topic+BRugs">BRugs</a></code>, <code><a href="#topic+help.WinBUGS">help.WinBUGS</a></code></p>

<hr>
<h2 id='infoUpdaters'>Information on MCMC updaters</h2><span id='topic+infoUpdatersbyName'></span><span id='topic+infoUpdatersbyDepth'></span>

<h3>Description</h3>

<p>List the MCMC sampling algorithms in use by the current model.</p>


<h3>Usage</h3>

<pre><code class='language-R'>infoUpdatersbyName()
infoUpdatersbyDepth()
</code></pre>


<h3>Value</h3>

<p>A data frame listing the MCMC updating algorithms chosen for each
stochastic node in the model after the model has been compiled.
</p>
<p>For block updating algorithms, the first component in the block is
shown followed by the other components of the block in angle brackets.
For vector nodes, only the first element is shown.
</p>
<p><code>infoUpdatersbyName</code> sorts the nodes alphabetically.
</p>
<p><code>infoUpdatersbyDepth</code> sorts the nodes in their reverse topological
order in the graphical model. Nodes which are forward sampled have a
negative depth.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+infoNodeMethods">infoNodeMethods</a></code>,<code><a href="#topic+BRugs">BRugs</a></code>,
<code><a href="#topic+help.WinBUGS">help.WinBUGS</a></code></p>

<hr>
<h2 id='loadOpenBUGS'>Load OpenBUGS from given directory</h2><span id='topic+loadOpenBUGS'></span>

<h3>Description</h3>

<p>Load OpenBUGS from given directory. Only available on Windows.</p>


<h3>Usage</h3>

<pre><code class='language-R'>loadOpenBUGS(dir)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="loadOpenBUGS_+3A_dir">dir</code></td>
<td>
<p>Directory where OpenBUGS is installed</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Only available on Windows. Valid OpenBUGS installations should always be
detected by the configure script on Linux.
</p>

<hr>
<h2 id='modelAdaptivePhase'>Getting length of adaptive phase</h2><span id='topic+modelAdaptivePhase'></span>

<h3>Description</h3>

<p>This function returns the length of the adaptive phase of the simulation. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>modelAdaptivePhase()
</code></pre>


<h3>Value</h3>

<p>This function returns the length of the adaptive phase of the simulation. 
This is only known after the simulation has finished adapting. 
If this function is called while the simulation is still adapting <code>MAX(INTEGER)</code> is returned. 
If the simulation does not have an adaptive phase then zero is returned.
</p>


<h3>Note</h3>

<p>This function can be executed once the model has been compiled and initialized.
</p>
<p>If an attempt is made to execute this function in an inappropriate context the generic error message 
&lsquo;command is not allowed (greyed out)&rsquo; is displayed. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+BRugs">BRugs</a></code>, <code><a href="#topic+help.WinBUGS">help.WinBUGS</a></code></p>

<hr>
<h2 id='modelCheck'>Checking the model file</h2><span id='topic+modelCheck'></span>

<h3>Description</h3>

<p>This function parses a BUGS language description of the statistical model.</p>


<h3>Usage</h3>

<pre><code class='language-R'>modelCheck(fileName)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="modelCheck_+3A_filename">fileName</code></td>
<td>
<p>file containing the BUGS language description of the statistical model.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If a syntax error is detected the position of the error and a description of the error is printed, 
otherwise the &lsquo;model is syntaxicaly correct&rsquo; message is displayed.
</p>


<h3>Note</h3>

<p>If an attempt is made to execute this function in an inappropriate context the generic error message 
&lsquo;command is not allowed (greyed out)&rsquo; is displayed. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+BRugs">BRugs</a></code>, <code><a href="#topic+help.WinBUGS">help.WinBUGS</a></code></p>

<hr>
<h2 id='modelCompile'>Compiling the model</h2><span id='topic+modelCompile'></span>

<h3>Description</h3>

<p>This function builds the data structures needed to carry out MCMC sampling.</p>


<h3>Usage</h3>

<pre><code class='language-R'>modelCompile(numChains = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="modelCompile_+3A_numchains">numChains</code></td>
<td>
<p>Simulation is carried out for <code>numChains</code> chains.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The model is checked for completeness and consistency with the data. 
A node called &lsquo;deviance&rsquo; is automatically created which calculates 
minus twice the log-likelihood at each iteration, up to a constant. 
This node can be used like any other node in the graphical model.
</p>


<h3>Value</h3>

<p>When the model has been successfully compiled, &lsquo;model compiled&rsquo; message should be printed.
</p>


<h3>Note</h3>

<p>This command becomes active once the model has been successfully checked (see <code><a href="#topic+modelCheck">modelCheck</a></code>).
</p>
<p>If an attempt is made to execute this function in an inappropriate context the generic error message 
&lsquo;command is not allowed (greyed out)&rsquo; is displayed. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+BRugs">BRugs</a></code>, <code><a href="#topic+help.WinBUGS">help.WinBUGS</a></code></p>

<hr>
<h2 id='modelData'>Loading the data</h2><span id='topic+modelData'></span>

<h3>Description</h3>

<p>This function loads data into the statistical model.</p>


<h3>Usage</h3>

<pre><code class='language-R'>modelData(fileName = "data.txt")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="modelData_+3A_filename">fileName</code></td>
<td>
<p>Filename(s) of file(s) containing the data in OpenBUGS format.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If any syntax errors or data inconsistencies are detected an error message is displayed. 
Corrections can be made to the data without returning to the &lsquo;check model&rsquo; stage. 
When the data have been loaded successfully the message &lsquo;data loaded&rsquo; should appear.
</p>


<h3>Note</h3>

<p>This function can be executed once a model has been successfully checked (see <code><a href="#topic+modelCheck">modelCheck</a></code>), 
it can no longer be executed once the model has been successfully compiled.
</p>
<p>If an attempt is made to execute this function in an inappropriate context the generic error message 
&lsquo;command is not allowed (greyed out)&rsquo; is displayed. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+BRugs">BRugs</a></code>, <code><a href="#topic+help.WinBUGS">help.WinBUGS</a></code></p>

<hr>
<h2 id='modelFactory'>Enable and disable factories to create updaters</h2><span id='topic+modelEnable'></span><span id='topic+modelDisable'></span>

<h3>Description</h3>

<p>These functions enable and disable factories that create
updaters. Currently only supported on Windows, not Linux.
Linux support should be available in the next OpenBUGS release after
version 3.2.1.</p>


<h3>Usage</h3>

<pre><code class='language-R'>modelEnable(factory)
modelDisable(factory)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="modelFactory_+3A_factory">factory</code></td>
<td>
<p>Character (length 1) name of the factory to be
disabled/enabled, for example <code>"conjugate gamma"</code>.
</p>

<p>for more information.  A list of the currently-used updaters
in a compiled model is given by <code><a href="#topic+infoUpdatersbyName">infoUpdatersbyName</a></code> or
<code><a href="#topic+infoUpdatersbyDepth">infoUpdatersbyDepth</a></code>.
</p>
<p>After enabling or disabling an updater, the model must be compiled
or re-compiled.
</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+BRugs">BRugs</a></code>, <code><a href="#topic+help.WinBUGS">help.WinBUGS</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
modelDisable("conjugate gamma")

## End(Not run)</code></pre>

<hr>
<h2 id='modelGenInits'>Generating initial values</h2><span id='topic+modelGenInits'></span>

<h3>Description</h3>

<p>This function attempts to generate initial values by sampling either from the prior or 
from an approximation to the prior. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>modelGenInits()
</code></pre>


<h3>Details</h3>

<p>In the case of discrete variables a check is made that a configuration of zero probability is not generated. 
This function will generate extreme values if any of the priors are very vague. 
</p>


<h3>Value</h3>

<p>If the function is successful the message &lsquo;initial values generated: model initialized&rsquo;
is displayed otherwise the message &lsquo;could not generate initial values&rsquo; is displayed.
</p>


<h3>Note</h3>

<p>This function can be executed once the model has been successfully compiled (<code><a href="#topic+modelCompile">modelCompile</a></code>), 
and can no longer be executed once the model has been initialized.
</p>
<p>If an attempt is made to execute this function in an inappropriate context the generic error message 
&lsquo;command is not allowed (greyed out)&rsquo; is displayed. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+BRugs">BRugs</a></code>, <code><a href="#topic+help.WinBUGS">help.WinBUGS</a></code></p>

<hr>
<h2 id='modelInits'>Loading initial values</h2><span id='topic+modelInits'></span>

<h3>Description</h3>

<p>This function loads initial values for the MCMC simulation.</p>


<h3>Usage</h3>

<pre><code class='language-R'>modelInits(fileName, chainNum = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="modelInits_+3A_filename">fileName</code></td>
<td>
<p>Character vector of filenames containing the initial values in OpenBUGS format.</p>
</td></tr>
<tr><td><code id="modelInits_+3A_chainnum">chainNum</code></td>
<td>
<p>The initial values will be loaded for the chain number <code>chainNum</code>. 
By default <code>chainNum</code> is one the first time <code>modelInits</code> is executed and incremented 
by one after each call modula the number of chains <code>numChains</code> being simulated (and restarts at 1 after that).
If <code>fileName</code> is a vector, <code>chainNum</code> is increased automatically by default after processing each file.
If there is more than one file containing initial values for one chain, either set <code>chainNum</code>
explicitly, or wait until cycle restarts at chain 1.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function checks that initial values are in the form of an appropriate R object or rectangular array 
and that they are consistent with any previously loaded data. 
If some of the elements in an array are known (say because they are constraints in a parameterisation), 
those elements should be specified as missing (NA) in the initial values file.
</p>
<p>Generally it is recommended to load initial values for all fixed effect nodes 
(founder nodes with no parents) for all chains, initial values for random effects can be 
generated using the <code><a href="#topic+modelGenInits">modelGenInits</a></code> function.
</p>


<h3>Value</h3>

<p>Any syntax errors or inconsistencies in the initial value are displayed.
If, after loading the initial values, the model is fully initialized 
this will be reported by displaying the message &lsquo;model initialized&rsquo;. 
Otherwise the message &lsquo;initial values loaded but this or another chain contain uninitialized variables&rsquo; will be displayed. 
The second message can have several meanings:
</p>
<table>
<tr><td><code>a)</code></td>
<td>
<p>If only one chain is simulated it means that the chain contains some nodes that have not been initialized yet.</p>
</td></tr>
<tr><td><code>b)</code></td>
<td>
<p>If several chains are to be simulated it could mean (a) or that no initial values have been loaded for one of the chains.</p>
</td></tr>
</table>
<p>In either case further initial values can be loaded, or <code><a href="#topic+modelGenInits">modelGenInits</a></code>
can be executed to try and generate initial values for all the uninitialized nodes in all the simulated chains.
</p>


<h3>Note</h3>

<p>This function can be executed once the model has been successfully compiled.
It can still be executed once MCMC sampling has been started having the effect 
of starting the sampler out on a new trajectory. 
</p>
<p>If an attempt is made to execute this function in an inappropriate context the generic error message 
&lsquo;command is not allowed (greyed out)&rsquo; is displayed. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+BRugs">BRugs</a></code>, <code><a href="#topic+help.WinBUGS">help.WinBUGS</a></code></p>

<hr>
<h2 id='modelIteration'>Returns number of iterations</h2><span id='topic+modelIteration'></span>

<h3>Description</h3>

<p>This function returns the total number of iterations carried out divided by thin.</p>


<h3>Usage</h3>

<pre><code class='language-R'>modelIteration()
</code></pre>


<h3>Value</h3>

<p>This function returns the total number of iterations carried out divided by thin.
</p>


<h3>Note</h3>

<p>This function can be executed once the model has been compiled and initialized.
</p>
<p>If an attempt is made to execute this function in an inappropriate context the generic error message 
&lsquo;command is not allowed (greyed out)&rsquo; is displayed. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+BRugs">BRugs</a></code>, <code><a href="#topic+help.WinBUGS">help.WinBUGS</a></code></p>

<hr>
<h2 id='modelNames'>Get variable names in model</h2><span id='topic+modelNames'></span>

<h3>Description</h3>

<p>This function returns the names of variables contained in the current model.</p>


<h3>Usage</h3>

<pre><code class='language-R'>modelNames()
</code></pre>


<h3>Value</h3>

<p>Character vector of names of variables contained in the current model.</p>


<h3>See Also</h3>

<p><code><a href="#topic+BRugs">BRugs</a></code>, <code><a href="#topic+help.WinBUGS">help.WinBUGS</a></code></p>

<hr>
<h2 id='modelPrecision'>Setting precision for prec figures</h2><span id='topic+modelPrecision'></span>

<h3>Description</h3>

<p>This function sets the precision to which results are displayed to prec figures.</p>


<h3>Usage</h3>

<pre><code class='language-R'>modelPrecision(prec)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="modelPrecision_+3A_prec">prec</code></td>
<td>
<p>precision used in the figures</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It does not affect the precision of any calculations!</p>


<h3>See Also</h3>

<p><code><a href="#topic+BRugs">BRugs</a></code>, <code><a href="#topic+help.WinBUGS">help.WinBUGS</a></code></p>

<hr>
<h2 id='modelRN'>State of Random Number Generator</h2><span id='topic+modelSetRN'></span>

<h3>Description</h3>

<p>Set the starting state of the random number generator.</p>


<h3>Usage</h3>

<pre><code class='language-R'>modelSetRN(state)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="modelRN_+3A_state">state</code></td>
<td>
<p>An integer from 1 to 14. The internal state of the OpenBUGS random number generator can be set to one of 14 predefined states. Each predefined state is <code class="reqn">10^12</code> draws apart to avoid overlap in random number sequences.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Warning: <code>modelSetRN</code> must not be used before
<code><a href="#topic+modelCompile">modelCompile</a></code> has been executed successfully!
The state can be changed after initial values are generated
but before updates have been performed, however,  this is not recommended.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+BRugs">BRugs</a></code>, <code><a href="#topic+help.WinBUGS">help.WinBUGS</a></code></p>

<hr>
<h2 id='modelSaveState'>Save the model's current state</h2><span id='topic+modelSaveState'></span>

<h3>Description</h3>

<p>This function saves the sate of each chain in OpenBUGS model</p>


<h3>Usage</h3>

<pre><code class='language-R'>modelSaveState(stem)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="modelSaveState_+3A_stem">stem</code></td>
<td>
<p>The filestem of the files to be generated.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Example for argument <code>stem</code>: 
If <code>stem = "c:/myFolder/stem"</code>, the resulting files 
are called &lsquo;<span class="file">stem1.txt</span>&rsquo;, ..., &lsquo;<span class="file">stemN.txt</span>&rsquo;. 
They are written into the <code>tempdir()</code> 
and copied to the path &lsquo;<span class="file">&quot;c:/myFolder&quot;</span>&rsquo;.
</p>


<h3>Note</h3>

<p>This function can be executed once a model has been successfully checked (see <code><a href="#topic+modelCheck">modelCheck</a></code>).
</p>
<p>If an attempt is made to execute this function in an inappropriate context the generic error message 
&lsquo;command is not allowed (greyed out)&rsquo; is displayed. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+BRugs">BRugs</a></code>, <code><a href="#topic+help.WinBUGS">help.WinBUGS</a></code></p>

<hr>
<h2 id='modelSetAP'>Changing settings of updating algorithms</h2><span id='topic+modelSetAP'></span><span id='topic+modelSetIts'></span><span id='topic+modelSetOR'></span>

<h3>Description</h3>

<p>These functions change adaptive phase, iterations, and
overRelaxation settings. Currently only supported on Windows, not Linux.</p>


<h3>Usage</h3>

<pre><code class='language-R'>modelSetAP(factoryName, adaptivePhase)
modelSetIts(factoryName, iterations)
modelSetOR(factoryName, overRelaxation)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="modelSetAP_+3A_factoryname">factoryName</code></td>
<td>
<p>String defining which particular MCMC updating algorithm is to be tuned.
Technically this string is the type name of the factory object used to create the updater,
for example &lsquo;UpdaterMetnormal.Factory&rsquo; for the random walk Metropolis sampler.</p>
</td></tr>
<tr><td><code id="modelSetAP_+3A_adaptivephase">adaptivePhase</code></td>
<td>
<p>length of the updater's adaptive phase</p>
</td></tr>
<tr><td><code id="modelSetAP_+3A_iterations">iterations</code></td>
<td>
<p>number of times an iterative algorithm is run before a failure is reported</p>
</td></tr>
<tr><td><code id="modelSetAP_+3A_overrelaxation">overRelaxation</code></td>
<td>
<p>amount of over relaxation the updater uses</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Once a model has been compiled, the various updating algorithms required in order to perform the MCMC
simulation may be &lsquo;tuned&rsquo; somewhat via these three functions.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+BRugs">BRugs</a></code>, <code><a href="#topic+help.WinBUGS">help.WinBUGS</a></code></p>

<hr>
<h2 id='modelSetWD'>Set working directory</h2><span id='topic+modelSetWD'></span>

<h3>Description</h3>

<p>Change the working directory</p>


<h3>Usage</h3>

<pre><code class='language-R'>modelSetWD(dir)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="modelSetWD_+3A_dir">dir</code></td>
<td>
<p>Directory to change to. A character string</p>
</td></tr> 
</table>


<h3>Details</h3>

<p>Simply an alias for <code><a href="base.html#topic+setwd">setwd</a></code> from base R, provided
to mimic the OpenBUGS script function <code>modelSetWD</code>. 
</p>

<hr>
<h2 id='modelUpdate'>Updating the model</h2><span id='topic+modelUpdate'></span>

<h3>Description</h3>

<p>This function updates the model.</p>


<h3>Usage</h3>

<pre><code class='language-R'>modelUpdate(numUpdates, thin = 1, overRelax = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="modelUpdate_+3A_numupdates">numUpdates</code></td>
<td>
<p>This function updates the model by carrying out <code>thin * numUpdates</code> MCMC iterations for each chain.</p>
</td></tr>
<tr><td><code id="modelUpdate_+3A_thin">thin</code></td>
<td>
<p>The samples from every k<em>th</em> iteration will be used for inference, where k is the value of <code>thin</code>. 
Setting <code>thin &gt; 1</code> can help to reduce the autocorrelation in the sample, 
but there is no real advantage in thinning except to reduce storage requirements. </p>
</td></tr>
<tr><td><code id="modelUpdate_+3A_overrelax">overRelax</code></td>
<td>
<p>If <code>overRelax</code> is <code>TRUE</code> an over-relaxed form of MCMC (Neal, 1998) 
which will be executed where possible. 
This generates multiple samples at each iteration and then selects one that is 
negatively correlated with the current value. 
The time per iteration will be increased, but the within-chain correlations should be 
reduced and hence fewer iterations may be necessary. 
However, this method is not always effective and should be used with caution. 
The auto-correlation function may be used to check whether the mixing of the chain is improved.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>This function can be executed once the model has been compiled and initialized.
</p>
<p>If an attempt is made to execute this function in an inappropriate context the generic error message 
&lsquo;command is not allowed (greyed out)&rsquo; is displayed. 
</p>


<h3>References</h3>

<p>Neal, R. (1998): Suppressing random walks in Markov chain Monte Carlo using ordered over-relaxation. 
In M.I. Jordan (Ed.): <em>Learning in Graphical Models</em>, Kluwer
Academic Publishers, Dordrecht, 205-230.
<a href="https://glizen.com/radfordneal/publications.html">https://glizen.com/radfordneal/publications.html</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+BRugs">BRugs</a></code>, <code><a href="#topic+help.WinBUGS">help.WinBUGS</a></code></p>

<hr>
<h2 id='plotAutoC'>Plot autocorrelation function for a scalar variable</h2><span id='topic+plotAutoC'></span>

<h3>Description</h3>

<p>This function plots the autocorrelation function of a scalar variable.</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotAutoC(node, plot = TRUE, 
    colour = c("red", "blue", "green", "yellow", "black"), 
    lwd = 5, main = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotAutoC_+3A_node">node</code></td>
<td>
<p>Character, name of a scalar variable in the model.</p>
</td></tr>
<tr><td><code id="plotAutoC_+3A_plot">plot</code></td>
<td>
<p>Logical, whether to plot the ACF or only return the values. If <code>TRUE</code>, values are returned invisibly.</p>
</td></tr>
<tr><td><code id="plotAutoC_+3A_colour">colour</code></td>
<td>
<p>Colours used to represent different chains.</p>
</td></tr>
<tr><td><code id="plotAutoC_+3A_lwd">lwd</code>, <code id="plotAutoC_+3A_main">main</code></td>
<td>
<p>graphical parameters, see <code><a href="graphics.html#topic+plot.default">plot.default</a></code></p>
</td></tr>  
<tr><td><code id="plotAutoC_+3A_...">...</code></td>
<td>
<p>Further graphical parameters as in <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>  
</table>


<h3>Details</h3>

<p>Acts on a scalar variable. See the wrapper function <code><a href="#topic+samplesAutoC">samplesAutoC</a></code> for more details.</p>


<h3>Value</h3>

<p>An <code><a href="stats.html#topic+acf">acf</a></code> object. See <code><a href="stats.html#topic+acf">acf</a></code> for details.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+samplesAutoC">samplesAutoC</a></code>, <code><a href="stats.html#topic+acf">acf</a></code>, <code><a href="#topic+BRugs">BRugs</a></code>, <code><a href="#topic+help.WinBUGS">help.WinBUGS</a></code></p>

<hr>
<h2 id='plotBgr'>Plot the Gelman-Rubin convergence statistic for a scalar variable</h2><span id='topic+plotBgr'></span>

<h3>Description</h3>

<p>This function calculates and plots the Gelman-Rubin convergence statistic for a scalar variable, 
as modified by Brooks and Gelman (1998).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotBgr(node, plot = TRUE, main = NULL, xlab = "iteration", 
    ylab = "bgr", col = c("red", "blue", "green"), bins = 50, 
    ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotBgr_+3A_node">node</code></td>
<td>
<p>Character, name of a scalar variable in the model.</p>
</td></tr>
<tr><td><code id="plotBgr_+3A_plot">plot</code></td>
<td>
<p>Logical, whether to plot the BGR statistics or only return the values. 
If <code>TRUE</code>, values are returned invisibly.</p>
</td></tr>
<tr><td><code id="plotBgr_+3A_main">main</code>, <code id="plotBgr_+3A_xlab">xlab</code>, <code id="plotBgr_+3A_ylab">ylab</code></td>
<td>
<p>annotation, see <code><a href="graphics.html#topic+plot.default">plot.default</a></code></p>
</td></tr>
<tr><td><code id="plotBgr_+3A_col">col</code></td>
<td>
<p>Colours, see Details Section in <code><a href="#topic+samplesBgr">samplesBgr</a></code>.</p>
</td></tr>
<tr><td><code id="plotBgr_+3A_bins">bins</code></td>
<td>
<p>Number of blocks</p>
</td></tr>
<tr><td><code id="plotBgr_+3A_...">...</code></td>
<td>
<p>Further graphical parameters as in <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Acts on a scalar variable. See the wrapper function <code><a href="#topic+samplesBgr">samplesBgr</a></code> for more details.</p>


<h3>Value</h3>

<p>Data frame with elements 
</p>
<table>
<tr><td><code>Iteration</code></td>
<td>
<p>end iteration of corresponding bin</p>
</td></tr>
<tr><td><code>pooledChain80pct)</code></td>
<td>
<p>80pct interval (normalized) of pooled chains</p>
</td></tr>
<tr><td><code>withinChain80pct</code></td>
<td>
<p>80pct interval (normalized) of mean within chain</p>
</td></tr>
<tr><td><code>bgrRatio</code></td>
<td>
<p>BGR ratio</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+samplesBgr">samplesBgr</a></code>, <code><a href="#topic+BRugs">BRugs</a></code>, <code><a href="#topic+help.WinBUGS">help.WinBUGS</a></code></p>

<hr>
<h2 id='plotDensity'>Plot density estimate or histogram of a scalar variable</h2><span id='topic+plotDensity'></span>

<h3>Description</h3>

<p>This function plots a smoothed kernel density estimate for a scalar variable if it is continuous
or a histogram if it is discrete.</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotDensity(node, plot=TRUE, main = NULL, xlab = "" , ylab = "", col = "red",
             ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotDensity_+3A_node">node</code></td>
<td>
<p>Character, name of a scalar variable in the model.</p>
</td></tr>
<tr><td><code id="plotDensity_+3A_plot">plot</code></td>
<td>
<p>Logical, whether to plot the trace or only return density estimates.
If <code>TRUE</code>, density estimates are returned invisibly.</p>
</td></tr>
<tr><td><code id="plotDensity_+3A_main">main</code>, <code id="plotDensity_+3A_xlab">xlab</code>, <code id="plotDensity_+3A_ylab">ylab</code>, <code id="plotDensity_+3A_col">col</code></td>
<td>
<p>graphical parameters, see <code><a href="graphics.html#topic+plot.default">plot.default</a></code></p>
</td></tr>
<tr><td><code id="plotDensity_+3A_...">...</code></td>
<td>
<p>Further graphical parameters as in <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Acts on a scalar variable. See the wrapper function <code><a href="#topic+samplesDensity">samplesDensity</a></code> for more details.</p>


<h3>See Also</h3>

<p><code><a href="#topic+samplesDensity">samplesDensity</a></code>, <code><a href="#topic+BRugs">BRugs</a></code>, <code><a href="#topic+help.WinBUGS">help.WinBUGS</a></code></p>

<hr>
<h2 id='plotHistory'>Trace of a scalar variable</h2><span id='topic+plotHistory'></span>

<h3>Description</h3>

<p>This function returns and plots a complete trace for a scalar variable.</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotHistory(node, plot = TRUE, 
    colour = c("red", "blue", "green", "yellow", "black"), 
    main = NULL, xlab = "iteration", ylab = "", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotHistory_+3A_node">node</code></td>
<td>
<p>Character, name of a scalar variable in the model.</p>
</td></tr>
<tr><td><code id="plotHistory_+3A_plot">plot</code></td>
<td>
<p>Logical, whether to plot the trace or only return the values. 
If <code>TRUE</code>, values are returned invisibly.</p>
</td></tr>
<tr><td><code id="plotHistory_+3A_colour">colour</code></td>
<td>
<p>Colours used to represent different chains.</p>
</td></tr>
<tr><td><code id="plotHistory_+3A_main">main</code>, <code id="plotHistory_+3A_xlab">xlab</code>, <code id="plotHistory_+3A_ylab">ylab</code></td>
<td>
<p>graphical parameters, see <code><a href="graphics.html#topic+plot.default">plot.default</a></code></p>
</td></tr>  
<tr><td><code id="plotHistory_+3A_...">...</code></td>
<td>
<p>Further graphical parameters as in <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>  
</table>


<h3>Details</h3>

<p>Acts on a scalar variable. See the wrapper function <code><a href="#topic+samplesHistory">samplesHistory</a></code> for more details.</p>


<h3>Value</h3>

<p>A matrix containing samples of <code>node</code>, each row corresponds to one chain.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+samplesHistory">samplesHistory</a></code>, <code><a href="#topic+BRugs">BRugs</a></code>, <code><a href="#topic+help.WinBUGS">help.WinBUGS</a></code></p>

<hr>
<h2 id='ranks'>Calculation of ranks</h2><span id='topic+ranksSet'></span><span id='topic+ranksStats'></span><span id='topic+ranksClear'></span>

<h3>Description</h3>

<p>These functions are used to calculate ranks of vector valued quantities in the model.</p>


<h3>Usage</h3>

<pre><code class='language-R'>ranksSet(node)
ranksStats(node)
ranksClear(node)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ranks_+3A_node">node</code></td>
<td>
<p>Character, name of a vector (one dimensional array) variable in the model.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>ranksSet</code> creates a monitor that starts building running histograms to represent 
the rank of each component of <code>node</code>. 
An amount of storage proportional to the square of the number of components of <code>node</code> is allocated. 
Even for large numbers of components this can require less storage than calculating the ranks 
explicitly in the model specification and storing their samples, and it is also much quicker.
</p>
<p><code>ranksStats</code> displays summarises of the distribution of the ranks of each component of <code>node</code>.
</p>
<p><code>ranksClear</code> removes the monitor calculating running histograms for <code>node</code>.
</p>


<h3>Value</h3>

<p><code>ranksStats</code> returns a data frame with columns:
</p>
<table>
<tr><td><code>val2.5pc</code></td>
<td>
<p>0.025 quantiles</p>
</td></tr>
<tr><td><code>median</code></td>
<td>
<p>medians</p>
</td></tr>
<tr><td><code>val97.5pc</code></td>
<td>
<p>0.975 quantiles</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Users should ensure their simulation has converged before using these functions. 
Note that if the MCMC simulation has an adaptive phase it will not be possible to make 
inference using values sampled before the end of this phase.</p>


<h3>See Also</h3>

<p><code><a href="#topic+BRugs">BRugs</a></code>, <code><a href="#topic+help.WinBUGS">help.WinBUGS</a></code></p>

<hr>
<h2 id='rats'>ratsdata example</h2><span id='topic+ratsdata'></span><span id='topic+ratsinits'></span>

<h3>Description</h3>

<p>ratsdata example</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ratsdata)
data(ratsinits)</code></pre>


<h3>Format</h3>

<p>The list <code>ratsdata</code> contains data originally taken from section 6 of Gelfand and Smith (1990).
</p>


<h3>Source</h3>

<p>A. Gelfand and A. Smith (1990): Sampling-based Approaches to Calculating Marginal Densities.
<em>Journal of the American Statistical Association</em>, 85, 398-409.
</p>

<hr>
<h2 id='samplesAutoC'>Plot autocorrelation function</h2><span id='topic+samplesAutoC'></span>

<h3>Description</h3>

<p>This function calculates and plots the autocorrelation function of a variable.</p>


<h3>Usage</h3>

<pre><code class='language-R'>samplesAutoC(node, chain, beg = samplesGetBeg(), 
    end = samplesGetEnd(), thin = samplesGetThin(), plot = TRUE,
    mfrow = c(3, 2), ask = NULL, ann = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="samplesAutoC_+3A_node">node</code></td>
<td>
<p>Character vector of length 1, name of a variable in the model.</p>
</td></tr>
<tr><td><code id="samplesAutoC_+3A_chain">chain</code></td>
<td>
<p>Selects a chain to plot autocorrelation function for.</p>
</td></tr>
<tr><td><code id="samplesAutoC_+3A_beg">beg</code>, <code id="samplesAutoC_+3A_end">end</code></td>
<td>
<p>Arguments to select a slice of monitored values corresponding to iterations <code>beg:end</code>.</p>
</td></tr>
<tr><td><code id="samplesAutoC_+3A_thin">thin</code></td>
<td>
<p>To only use every <code>thin</code>-th value of the stored sample for statistics.</p>
</td></tr>
<tr><td><code id="samplesAutoC_+3A_plot">plot</code></td>
<td>
<p>Logical, whether to plot the ACF or only return the values. If <code>TRUE</code>, values are returned invisibly.</p>
</td></tr>
<tr><td><code id="samplesAutoC_+3A_mfrow">mfrow</code>, <code id="samplesAutoC_+3A_ask">ask</code>, <code id="samplesAutoC_+3A_ann">ann</code></td>
<td>
<p>Graphical parameters, see <code><a href="graphics.html#topic+par">par</a></code> for details.
<code>ask</code> defaults to <code>TRUE</code> unless it is plotting into an already opened non-interactive device.  
The <code>ann</code> parameter is not available in S-PLUS, and will be ignored if it is set.</p>
</td></tr>
<tr><td><code id="samplesAutoC_+3A_...">...</code></td>
<td>
<p>Further graphical parameters as in <code><a href="graphics.html#topic+par">par</a></code> may also be passed as arguments
to <code><a href="#topic+plotAutoC">plotAutoC</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the variable of interest is an array, slices of the array can be selected using the notation 
<code>variable[lower0:upper0, lower1:upper1, ...]</code>. 
A star &lsquo;<code>*</code>&rsquo; can be entered as shorthand for all the stored samples.
</p>
<p>If the arguments are left at their defaults the whole sample for all chains will be used for calculation.</p>


<h3>Value</h3>

<p>A list containing <code><a href="stats.html#topic+acf">acf</a></code> objects - one for each scalar variable contained in 
argument <code>node</code>. See <code><a href="stats.html#topic+acf">acf</a></code> for details on the list elements.
</p>


<h3>Note</h3>

<p>If the MCMC simulation has an adaptive phase it will not be possible to make inference using values 
sampled before the end of this phase.</p>


<h3>See Also</h3>

<p><code><a href="#topic+plotAutoC">plotAutoC</a></code>, <code><a href="stats.html#topic+acf">acf</a></code>, <code><a href="#topic+BRugs">BRugs</a></code>, <code><a href="#topic+help.WinBUGS">help.WinBUGS</a></code></p>

<hr>
<h2 id='samplesBgr'>Plot the Gelman-Rubin convergence statistic</h2><span id='topic+samplesBgr'></span>

<h3>Description</h3>

<p>This function calculates and plots the Gelman-Rubin convergence statistic, 
as modified by Brooks and Gelman (1998).</p>


<h3>Usage</h3>

<pre><code class='language-R'>samplesBgr(node, beg = samplesGetBeg(), end = samplesGetEnd(), 
    firstChain = samplesGetFirstChain(), 
    lastChain = samplesGetLastChain(), thin = samplesGetThin(),
    bins = 50, plot = TRUE, mfrow = c(3, 2), ask = NULL, 
    ann = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="samplesBgr_+3A_node">node</code></td>
<td>
<p>Character vector of length 1, name of a variable in the model.</p>
</td></tr>
<tr><td><code id="samplesBgr_+3A_beg">beg</code>, <code id="samplesBgr_+3A_end">end</code></td>
<td>
<p>Arguments to select a slice of monitored values corresponding to iterations <code>beg:end</code>.</p>
</td></tr>
<tr><td><code id="samplesBgr_+3A_firstchain">firstChain</code>, <code id="samplesBgr_+3A_lastchain">lastChain</code></td>
<td>
<p>Arguments to select a sub group of chains to calculate 
the Gelman-Rubin convergence statistics for. Number of chains must be larger than one.</p>
</td></tr>
<tr><td><code id="samplesBgr_+3A_thin">thin</code></td>
<td>
<p>Only use every <code>thin</code>-th value of the stored sample for statistics.</p>
</td></tr>
<tr><td><code id="samplesBgr_+3A_bins">bins</code></td>
<td>
<p>Number of blocks</p>
</td></tr>
<tr><td><code id="samplesBgr_+3A_plot">plot</code></td>
<td>
<p>Logical, whether to plot the BGR statistics or only return the values. 
If <code>TRUE</code>, values are returned invisibly.</p>
</td></tr>
<tr><td><code id="samplesBgr_+3A_mfrow">mfrow</code>, <code id="samplesBgr_+3A_ask">ask</code>, <code id="samplesBgr_+3A_ann">ann</code></td>
<td>
<p>Graphical parameters, see <code><a href="graphics.html#topic+par">par</a></code> for details.
<code>ask</code> defaults to <code>TRUE</code> unless it is plotting into an already opened non-interactive device.
The <code>ann</code> parameter is not available in S-PLUS, and will be ignored if it is set.</p>
</td></tr>
<tr><td><code id="samplesBgr_+3A_...">...</code></td>
<td>
<p>Further graphical parameters as in <code><a href="graphics.html#topic+par">par</a></code> may also be passed as arguments 
to <code><a href="#topic+plotBgr">plotBgr</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The width of the central 80% interval of the pooled runs is green, 
the average width of the 80% intervals within the individual runs is blue, 
and their ratio <code class="reqn">R (= pooled / within)</code> is red.
For plotting purposes the pooled and within interval widths are normalised to have an overall maximum of one. 
The statistics are calculated in bins of length 50: 
<code class="reqn">R</code> would generally be expected to be greater than 1 if the starting values are suitably over-dispersed. 
Brooks and Gelman (1998) emphasise that one should be concerned both with convergence of <code class="reqn">R</code> to 1, 
and with convergence of both the pooled and within interval widths to stability.
</p>
<p>If the variable of interest is an array, slices of the array can be selected using the notation 
<code>variable[lower0:upper0, lower1:upper1, ...]</code>. 
A star &lsquo;<code>*</code>&rsquo; can be entered as shorthand for all the stored samples.
</p>
<p>If the arguments are left at their defaults the whole sample for all chains will be used for calculation.</p>


<h3>Value</h3>

<p>A list containing data frames - one for each scalar variable contained in 
argument <code>node</code>. Each data frames contains elements
</p>
<table>
<tr><td><code>Iteration</code></td>
<td>
<p>end iteration of corresponding bin</p>
</td></tr>
<tr><td><code>pooledChain80pct)</code></td>
<td>
<p>80pct interval (normalized) of pooled chains</p>
</td></tr>
<tr><td><code>withinChain80pct</code></td>
<td>
<p>80pct interval (normalized) of mean within chain</p>
</td></tr>
<tr><td><code>bgrRatio</code></td>
<td>
<p>BGR ratio</p>
</td></tr>
</table>


<h3>Note</h3>

<p>If the MCMC simulation has an adaptive phase it will not be possible to make inference using values 
sampled before the end of this phase.</p>


<h3>References</h3>

<p>Brooks, S.P. and Gelman A. (1998):
Alternative Methods for Monitoring Convergence of Iterative Simulations. 
<em>Journal of Computational and Graphical Statistics</em>, 7, 434-455.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plotBgr">plotBgr</a></code>, <code><a href="#topic+BRugs">BRugs</a></code>, <code><a href="#topic+help.WinBUGS">help.WinBUGS</a></code></p>

<hr>
<h2 id='samplesClear'>Clear recorded values</h2><span id='topic+samplesClear'></span>

<h3>Description</h3>

<p>This function is used to remove the stored values of a variable.</p>


<h3>Usage</h3>

<pre><code class='language-R'>samplesClear(node)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="samplesClear_+3A_node">node</code></td>
<td>
<p>Character vector of length 1, name of a variable in the model.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the variable of interest is an array, slices of the array can be selected using the notation 
<code>variable[lower0:upper0, lower1:upper1, ...]</code>. 
A star &lsquo;<code>*</code>&rsquo; can be entered as shorthand for all the stored samples.</p>


<h3>See Also</h3>

<p><code><a href="#topic+BRugs">BRugs</a></code>, <code><a href="#topic+help.WinBUGS">help.WinBUGS</a></code></p>

<hr>
<h2 id='samplesCoda'>Writing files in CODA format</h2><span id='topic+samplesCoda'></span>

<h3>Description</h3>

<p>This function writes files in CODA format to be processed or imported, e.g, by some other software.</p>


<h3>Usage</h3>

<pre><code class='language-R'>samplesCoda(node, stem, beg = samplesGetBeg(), 
    end = samplesGetEnd(), firstChain = samplesGetFirstChain(), 
    lastChain = samplesGetLastChain(), thin = samplesGetThin())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="samplesCoda_+3A_node">node</code></td>
<td>
<p>Character vector of length 1, name of a variable in the model.</p>
</td></tr>
<tr><td><code id="samplesCoda_+3A_stem">stem</code></td>
<td>
<p>The filestem of the CODA files to be generated. See details.</p>
</td></tr>
<tr><td><code id="samplesCoda_+3A_beg">beg</code>, <code id="samplesCoda_+3A_end">end</code></td>
<td>
<p>Arguments to select a slice of monitored values corresponding to iterations <code>beg:end</code>.</p>
</td></tr>
<tr><td><code id="samplesCoda_+3A_firstchain">firstChain</code>, <code id="samplesCoda_+3A_lastchain">lastChain</code></td>
<td>
<p>Arguments to select a sub group of chains.</p>
</td></tr>
<tr><td><code id="samplesCoda_+3A_thin">thin</code></td>
<td>
<p>to only use every <code>thin</code>-th value of the stored sample.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Example for argument <code>stem</code>: 
If <code>stem = "c:/myFolder/foo"</code>, the resulting files 
are called &lsquo;<span class="file">fooCODAchain1.txt</span>&rsquo;, ..., &lsquo;<span class="file">fooCODAchainN.txt</span>&rsquo;, and 
&lsquo;<span class="file">fooCODAindex.txt</span>&rsquo;. They are written into the <code>tempdir()</code> 
and copied to the path &lsquo;<span class="file">&quot;c:/myFolder&quot;</span>&rsquo;.
</p>
<p>If the variable of interest is an array, slices of the array can be selected using the notation 
<code>variable[lower0:upper0, lower1:upper1, ...]</code>. 
</p>
<p>If the arguments are left at their defaults the whole sample for all chains will be used for output.</p>


<h3>Value</h3>

<p>Prints &lsquo;CODA files written&rsquo;.
</p>


<h3>Note</h3>

<p>If the MCMC simulation has an adaptive phase it will not be possible to make inference using values 
sampled before the end of this phase.</p>


<h3>See Also</h3>

<p><code><a href="#topic+BRugs">BRugs</a></code>, <code><a href="#topic+help.WinBUGS">help.WinBUGS</a></code></p>

<hr>
<h2 id='samplesCorrel'>Correlation</h2><span id='topic+samplesCorrel'></span>

<h3>Description</h3>

<p>This function calculates the correlation matrix between two vectors of variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>samplesCorrel(node0, node1, beg = samplesGetBeg(), 
    end = samplesGetEnd(), firstChain = samplesGetFirstChain(), 
    lastChain = samplesGetLastChain(), thin = samplesGetThin())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="samplesCorrel_+3A_node0">node0</code>, <code id="samplesCorrel_+3A_node1">node1</code></td>
<td>
<p>Character vectors of length 1, name of variables in the model.</p>
</td></tr>
<tr><td><code id="samplesCorrel_+3A_beg">beg</code>, <code id="samplesCorrel_+3A_end">end</code></td>
<td>
<p>Arguments to select a slice of monitored values corresponding to iterations <code>beg:end</code>.</p>
</td></tr>
<tr><td><code id="samplesCorrel_+3A_firstchain">firstChain</code>, <code id="samplesCorrel_+3A_lastchain">lastChain</code></td>
<td>
<p>Arguments to select a sub group of chains to calculate correlation(s) for.</p>
</td></tr>
<tr><td><code id="samplesCorrel_+3A_thin">thin</code></td>
<td>
<p>to only use every <code>thin</code>-th value of the stored sample for statistics.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the variable of interest is an array, slices of the array can be selected using the notation 
<code>variable[lower0:upper0, lower1:upper1, ...]</code>. 
</p>
<p>If the arguments are left at their defaults the whole sample for all chains will be used for calculation.</p>


<h3>Value</h3>

<p>Correlation matrix.
</p>


<h3>Note</h3>

<p>If the MCMC simulation has an adaptive phase it will not be possible to make inference using values 
sampled before the end of this phase.</p>


<h3>See Also</h3>

<p><code><a href="#topic+BRugs">BRugs</a></code>, <code><a href="#topic+help.WinBUGS">help.WinBUGS</a></code></p>

<hr>
<h2 id='samplesDensity'>Plot density estimate or histogram</h2><span id='topic+samplesDensity'></span>

<h3>Description</h3>

<p>This function plots a smoothed kernel density estimate for a variable if it is continuous
or a histogram if it is discrete.</p>


<h3>Usage</h3>

<pre><code class='language-R'>samplesDensity(node, beg = samplesGetBeg(), end = samplesGetEnd(),
    firstChain = samplesGetFirstChain(),
    lastChain = samplesGetLastChain(), thin = samplesGetThin(),
    plot = TRUE, mfrow = c(3, 2), ask = NULL, ann = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="samplesDensity_+3A_node">node</code></td>
<td>
<p>Character vector of length 1, name of a variable in the model.</p>
</td></tr>
<tr><td><code id="samplesDensity_+3A_beg">beg</code>, <code id="samplesDensity_+3A_end">end</code></td>
<td>
<p>Arguments to select a slice of monitored values corresponding to iterations <code>beg:end</code>.</p>
</td></tr>
<tr><td><code id="samplesDensity_+3A_firstchain">firstChain</code>, <code id="samplesDensity_+3A_lastchain">lastChain</code></td>
<td>
<p>Arguments to select a sub group of chains to plot density estimate or histogram for.</p>
</td></tr>
<tr><td><code id="samplesDensity_+3A_thin">thin</code></td>
<td>
<p>to only use every <code>thin</code>-th value of the stored sample for statistics.</p>
</td></tr>
<tr><td><code id="samplesDensity_+3A_plot">plot</code></td>
<td>
<p>Logical, whether to plot the trace or only return density estimates.
If <code>TRUE</code>, density estimates are returned invisibly.</p>
</td></tr>
<tr><td><code id="samplesDensity_+3A_mfrow">mfrow</code>, <code id="samplesDensity_+3A_ask">ask</code>, <code id="samplesDensity_+3A_ann">ann</code></td>
<td>
<p>Graphical parameters, see <code><a href="graphics.html#topic+par">par</a></code> for details.
<code>ask</code> defaults to <code>TRUE</code> unless it is plotting into an already opened non-interactive device.
The <code>ann</code> parameter is not available in S-PLUS, and will be ignored if it is set.</p>
</td></tr>
<tr><td><code id="samplesDensity_+3A_...">...</code></td>
<td>
<p>Further graphical parameters as in <code><a href="graphics.html#topic+par">par</a></code> may also be passed as arguments
to <code><a href="#topic+plotDensity">plotDensity</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the variable of interest is an array, slices of the array can be selected using the notation
<code>variable[lower0:upper0, lower1:upper1, ...]</code>.
A star &lsquo;<code>*</code>&rsquo; can be entered as shorthand for all the stored samples.
</p>
<p>If the arguments are left at their defaults the whole sample for all chains will be used for calculation.</p>


<h3>Note</h3>

<p>If the MCMC simulation has an adaptive phase it will not be possible to make inference using values
sampled before the end of this phase.</p>


<h3>See Also</h3>

<p><code><a href="#topic+BRugs">BRugs</a></code>, <code><a href="#topic+help.WinBUGS">help.WinBUGS</a></code></p>

<hr>
<h2 id='samplesGet'>Get settings used for calculations</h2><span id='topic+samplesGetBeg'></span><span id='topic+samplesGetEnd'></span><span id='topic+samplesGetThin'></span><span id='topic+samplesGetLastChain'></span><span id='topic+samplesGetFirstChain'></span>

<h3>Description</h3>

<p>These low level functions can be used to get information on settings of begin, end, and thinning of chains,
as well as the number of the first/last chain of the stored sample.</p>


<h3>Usage</h3>

<pre><code class='language-R'>samplesGetBeg()
samplesGetEnd()
samplesGetThin()
samplesGetFirstChain()
samplesGetLastChain()
</code></pre>


<h3>Value</h3>

<p><code>samplesGetBeg</code> returns the first iteration of the stored sample used for calculating statistics.
</p>
<p><code>samplesGetEnd</code> returns the last iteration of the stored sample used for calculating statistics to end.
</p>
<p><code>samplesGetThin</code> returns the thin parameter, see <code><a href="#topic+samplesSetThin">samplesSetThin</a></code>.
</p>
<p><code>samplesGetFirstChain</code> returns the number of the first chain of the stored sample used for calculating statistics.
</p>
<p><code>samplesGetLastChain</code> returns the number of the last chain of the stored sample used for calculating statistics.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+samplesSetBeg">samplesSetBeg</a></code>, <code><a href="#topic+BRugs">BRugs</a></code>, <code><a href="#topic+help.WinBUGS">help.WinBUGS</a></code></p>

<hr>
<h2 id='samplesHistory'>Trace of a variable</h2><span id='topic+samplesHistory'></span>

<h3>Description</h3>

<p>This function returns and plots a complete trace for a variable.</p>


<h3>Usage</h3>

<pre><code class='language-R'>samplesHistory(node, beg = samplesGetBeg(), end = samplesGetEnd(), 
    firstChain = samplesGetFirstChain(), 
    lastChain = samplesGetLastChain(), thin = samplesGetThin(),
    plot = TRUE, mfrow = c(3, 1), ask = NULL, ann = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="samplesHistory_+3A_node">node</code></td>
<td>
<p>Character vector of length 1, name of a variable in the model.</p>
</td></tr>
<tr><td><code id="samplesHistory_+3A_beg">beg</code>, <code id="samplesHistory_+3A_end">end</code></td>
<td>
<p>Arguments to select a slice of monitored values corresponding to iterations <code>beg:end</code>.</p>
</td></tr>
<tr><td><code id="samplesHistory_+3A_firstchain">firstChain</code>, <code id="samplesHistory_+3A_lastchain">lastChain</code></td>
<td>
<p>Arguments to select a sub group of chains to plot the trace for.</p>
</td></tr>
<tr><td><code id="samplesHistory_+3A_thin">thin</code></td>
<td>
<p>to only use every <code>thin</code>-th value of the stored sample for statistics.</p>
</td></tr>
<tr><td><code id="samplesHistory_+3A_plot">plot</code></td>
<td>
<p>Logical, whether to plot the trace or only return the values. 
If <code>TRUE</code>, values are returned invisibly.</p>
</td></tr> 
<tr><td><code id="samplesHistory_+3A_mfrow">mfrow</code>, <code id="samplesHistory_+3A_ask">ask</code>, <code id="samplesHistory_+3A_ann">ann</code></td>
<td>
<p>Graphical parameters, see <code><a href="graphics.html#topic+par">par</a></code> for details.
<code>ask</code> defaults to <code>TRUE</code> unless it is plotting into an already opened non-interactive device.
The <code>ann</code> parameter is not available in S-PLUS, and will be ignored if it is set.</p>
</td></tr>
<tr><td><code id="samplesHistory_+3A_...">...</code></td>
<td>
<p>Further graphical parameters as in <code><a href="graphics.html#topic+par">par</a></code> may also be passed as arguments
to <code><a href="#topic+plotHistory">plotHistory</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the variable of interest is an array, slices of the array can be selected using the notation 
<code>variable[lower0:upper0, lower1:upper1, ...]</code>. 
A star &lsquo;<code>*</code>&rsquo; can be entered as shorthand for all the stored samples.
</p>
<p>If the arguments are left at their defaults the whole sample for all chains will be used for calculation.</p>


<h3>Value</h3>

<p>A list containing matrices - one for each scalar variable contained in 
argument <code>node</code>. Each row of a matrix corresponds to one chain.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plotHistory">plotHistory</a></code>, <code><a href="#topic+BRugs">BRugs</a></code>, <code><a href="#topic+help.WinBUGS">help.WinBUGS</a></code></p>

<hr>
<h2 id='samplesMonitors'>Names of monitored scalar variables</h2><span id='topic+samplesMonitors'></span>

<h3>Description</h3>

<p>This function returns names of monitored scalar variables.</p>


<h3>Usage</h3>

<pre><code class='language-R'>samplesMonitors(node)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="samplesMonitors_+3A_node">node</code></td>
<td>
<p>Character vector of length 1, name of a variable in the model, or simply &lsquo;<code>*</code>&rsquo;.
<code>node</code> can be a vector quantity with sub ranges given to indices (e.g. <code>samplesMonitors("node[3:5]")</code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of names that are monitored.
If sampling a vector of parameters of <code>node</code>, all elements are printed, e.g.:
<code>"node[beg]", ..., "node[end]"</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+BRugs">BRugs</a></code>, <code><a href="#topic+help.WinBUGS">help.WinBUGS</a></code></p>

<hr>
<h2 id='samplesSample'>Stored values</h2><span id='topic+samplesSample'></span>

<h3>Description</h3>

<p>This function returns an array of stored values.</p>


<h3>Usage</h3>

<pre><code class='language-R'>samplesSample(node)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="samplesSample_+3A_node">node</code></td>
<td>
<p>Character vector of length 1, name of a variable in the model.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Values of the stored sample.
</p>


<h3>Note</h3>

<p>If sampling a vector of parameters, the function must be called for each parameter separately 
such as <code>samplesSample("node[1]")</code>.
</p>
<p>To get samples from more than only one scalar node, see <code><a href="#topic+samplesHistory">samplesHistory</a></code> with argument <code>plot=FALSE</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+BRugs">BRugs</a></code>, <code><a href="#topic+help.WinBUGS">help.WinBUGS</a></code></p>

<hr>
<h2 id='samplesSet'>Start recording</h2><span id='topic+samplesSet'></span>

<h3>Description</h3>

<p>This function is used to start recording a chain of values for particular variables.</p>


<h3>Usage</h3>

<pre><code class='language-R'>samplesSet(node)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="samplesSet_+3A_node">node</code></td>
<td>
<p>Character vector of names of variables in the model.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>WinBUGS generally automatically sets up a logical node to measure a quantity known as deviance; 
this may be accessed, in the same way as any other variable of interest, by typing its name, i.e. &ldquo;deviance&rdquo;</p>


<h3>See Also</h3>

<p><code><a href="#topic+BRugs">BRugs</a></code>, <code><a href="#topic+help.WinBUGS">help.WinBUGS</a></code></p>

<hr>
<h2 id='samplesSetting'>Change settings used for calculations</h2><span id='topic+samplesSetBeg'></span><span id='topic+samplesSetEnd'></span><span id='topic+samplesSetThin'></span><span id='topic+samplesSetLastChain'></span><span id='topic+samplesSetFirstChain'></span>

<h3>Description</h3>

<p>These low level functions can be used to set begin, end, and thinning of chains 
as well as the first/last chain of the stored sample.</p>


<h3>Usage</h3>

<pre><code class='language-R'>samplesSetBeg(begIt)
samplesSetEnd(endIt)
samplesSetThin(thin)
samplesSetFirstChain(first)
samplesSetLastChain(last)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="samplesSetting_+3A_begit">begIt</code></td>
<td>
<p>First iteration of the stored sample used for calculating statistics.</p>
</td></tr>
<tr><td><code id="samplesSetting_+3A_endit">endIt</code></td>
<td>
<p>Last iteration of the stored sample used for calculating statistics.</p>
</td></tr>
<tr><td><code id="samplesSetting_+3A_thin">thin</code></td>
<td>
<p>Every <code>thin</code>-th iteration of each chain is used to contribute to the statistics being calculated.</p>
</td></tr>
<tr><td><code id="samplesSetting_+3A_first">first</code>, <code id="samplesSetting_+3A_last">last</code></td>
<td>
<p>First/last chain of the stored sample used for calculating statistics.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>samplesSetBeg</code> sets the first iteration of the stored sample used for calculating statistics to <code>begIt</code>.
</p>
<p><code>samplesSetEnd</code> sets the last iteration of the stored sample used for calculating statistics to <code>endIt</code>.
</p>
<p><code>samplesSetThin</code> sets the numerical field used to select every <code>thin</code>-th iteration of 
each chain to contribute to the statistics being calculated. 
</p>
<p><code>samplesSetFirstChain</code> is used to set the first chain of the stored sample used for 
calculating statistics to be <code>first</code>.
</p>
<p><code>samplesSetLastChain</code> is used to set the last chain of the stored sample used for calculating 
statistics to be <code>last</code>.
</p>


<h3>Note</h3>

<p>Note the difference between this and the thinning facility of the update function: 
when thinning via the update function we are permanently discarding samples as the MCMC simulation runs, 
whereas here we have already generated (and stored) a suitable number of (posterior) samples and 
may wish to discard some of them only temporarily. 
Thus, setting <code>thin &gt; 1</code> here will not have any impact on the storage (memory) requirements; 
if you wish to reduce the number of samples actually stored (to free-up memory) you should thin via the update function.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+BRugs">BRugs</a></code>, <code><a href="#topic+help.WinBUGS">help.WinBUGS</a></code></p>

<hr>
<h2 id='samplesSize'>Size of the stored sample</h2><span id='topic+samplesSize'></span>

<h3>Description</h3>

<p>This function returns the size of the stored sample.</p>


<h3>Usage</h3>

<pre><code class='language-R'>samplesSize(node)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="samplesSize_+3A_node">node</code></td>
<td>
<p>Character vector of length 1, name of a variable in the model.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Size of the stored sample. If no samples exist, -1 will be returned.
</p>


<h3>Note</h3>

<p>If sampling a vector of parameters, the function must be called for each parameter separately 
such as <code>samplesSize(node[1])</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+BRugs">BRugs</a></code>, <code><a href="#topic+help.WinBUGS">help.WinBUGS</a></code></p>

<hr>
<h2 id='samplesStats'>Calculate summary statistics</h2><span id='topic+samplesStats'></span>

<h3>Description</h3>

<p>This function produces summary statistics for a variable, 
pooling over the chains selected.</p>


<h3>Usage</h3>

<pre><code class='language-R'>samplesStats(node, beg = samplesGetBeg(), end = samplesGetEnd(), 
    firstChain = samplesGetFirstChain(), 
    lastChain = samplesGetLastChain(), thin = samplesGetThin())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="samplesStats_+3A_node">node</code></td>
<td>
<p>Character vector containing names of variables in the model.</p>
</td></tr>
<tr><td><code id="samplesStats_+3A_beg">beg</code>, <code id="samplesStats_+3A_end">end</code></td>
<td>
<p>Arguments to select a slice of monitored values corresponding to iterations <code>beg:end</code>.</p>
</td></tr>
<tr><td><code id="samplesStats_+3A_firstchain">firstChain</code>, <code id="samplesStats_+3A_lastchain">lastChain</code></td>
<td>
<p>Arguments to select a sub group of chains to calculate summary statistics for.</p>
</td></tr>
<tr><td><code id="samplesStats_+3A_thin">thin</code></td>
<td>
<p>to only use every <code>thin</code>-th value of the stored sample for statistics.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the variable of interest is an array, slices of the array can be selected using the notation 
<code>variable[lower0:upper0, lower1:upper1, ...]</code>. 
A star &lsquo;<code>*</code>&rsquo; can be entered as shorthand for all the stored samples.
</p>
<p>If the arguments are left at their defaults the whole sample for all chains will be used for calculation.</p>


<h3>Value</h3>

<p><code>samples.stats</code> returns a data frame with columns:
</p>
<table>
<tr><td><code>mean</code></td>
<td>
<p>means</p>
</td></tr>
<tr><td><code>sd</code></td>
<td>
<p>standard deviations</p>
</td></tr>
<tr><td><code>MC_error</code></td>
<td>
<p>Estimate of <code class="reqn">s/\sqrt(N)</code>,
the Monte Carlo standard error of the mean. 
The batch means method outlined by Roberts (1996; p.50) is used to estimate <code class="reqn">s</code>.</p>
</td></tr>
<tr><td><code>val2.5pc</code></td>
<td>
<p>0.025 quantiles</p>
</td></tr>
<tr><td><code>median</code></td>
<td>
<p>medians</p>
</td></tr>
<tr><td><code>val97.5pc</code></td>
<td>
<p>0.975 quantiles</p>
</td></tr>
<tr><td><code>start</code></td>
<td>
<p><code>beg</code> + 1</p>
</td></tr>
<tr><td><code>sample</code></td>
<td>
<p>sample sizes</p>
</td></tr>
</table>


<h3>Note</h3>

<p>If the MCMC simulation has an adaptive phase it will not be possible to make inference using values 
sampled before the end of this phase.</p>


<h3>References</h3>

<p>Roberts, G.O. (1996): Markov Chain Concepts Related to Sampling Algorithms. 
In: W.R. Gilks, S. Richardson and D.J. Spiegelhalter (Eds.):
<em>Markov Chain Monte Carlo in Practice</em>. Chapman and Hall, London, UK.</p>


<h3>See Also</h3>

<p><code><a href="#topic+BRugs">BRugs</a></code>, <code><a href="#topic+help.WinBUGS">help.WinBUGS</a></code></p>

<hr>
<h2 id='setValues'>Setting current values</h2><span id='topic+setValues'></span>

<h3>Description</h3>

<p>This function sets the current values of a variable for future
iterations. Only stochastic nodes can be set using this facility, and
logical nodes are then updated if necessary. </p>


<h3>Usage</h3>

<pre><code class='language-R'>setValues(nodeLabel, values)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="setValues_+3A_nodelabel">nodeLabel</code></td>
<td>
<p>Character vector of length 1, name of a node in the model.</p>
</td></tr>
<tr><td><code id="setValues_+3A_values">values</code></td>
<td>
<p>The values to be set, generated, e.g., by <code><a href="#topic+infoNodeValues">infoNodeValues</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Current values of a node can be stored to be used later as initial values.
</p>


<h3>Value</h3>

<p>The number of values set.</p>


<h3>See Also</h3>

<p><code><a href="#topic+infoNodeValues">infoNodeValues</a></code>, <code><a href="#topic+BRugs">BRugs</a></code>, <code><a href="#topic+help.WinBUGS">help.WinBUGS</a></code></p>

<hr>
<h2 id='summary'>Summary of MCMC simulation</h2><span id='topic+summarySet'></span><span id='topic+summaryClear'></span><span id='topic+summaryStats'></span>

<h3>Description</h3>

<p>These functions are used to calculate running means, standard deviations and quantiles.</p>


<h3>Usage</h3>

<pre><code class='language-R'>summarySet(node)
summaryStats(node)
summaryClear(node)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary_+3A_node">node</code></td>
<td>
<p>Character vector containing names of a variables in the model.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>summarySet</code> creates monitor(s) that starts recording the running totals for <code>node</code>.
</p>
<p><code>summaryStats</code> displays the running means, standard deviations, 
and 2.5%, 50% (median) and 97.5% quantiles for <code>node</code>. 
Note that these running quantiles are calculated via an approximate algorithm
and should therefore be used with caution.
</p>
<p><code>summaryClear</code> removes the monitor(s) calculating running totals for <code>node</code>.
</p>
<p>These functions are less powerful and general than the samples functions (e.g., see <code><a href="#topic+samplesSet">samplesSet</a></code>),
but they also require much less storage (an important consideration when many variables and/or long runs are of interest).</p>


<h3>Value</h3>

<p><code>summaryStats</code> returns a data frame with columns:
</p>
<table>
<tr><td><code>mean</code></td>
<td>
<p>means</p>
</td></tr>
<tr><td><code>sd</code></td>
<td>
<p>standard deviations</p>
</td></tr>
<tr><td><code>val2.5pc</code></td>
<td>
<p>0.025 quantiles</p>
</td></tr>
<tr><td><code>median</code></td>
<td>
<p>medians</p>
</td></tr>
<tr><td><code>val97.5pc</code></td>
<td>
<p>0.975 quantiles</p>
</td></tr>
<tr><td><code>sample</code></td>
<td>
<p>sample sizes</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Users should ensure their simulation has converged before using these functions. 
Note that if the MCMC simulation has an adaptive phase it will not be possible to make 
inference using values sampled before the end of this phase.</p>


<h3>See Also</h3>

<p><code><a href="#topic+BRugs">BRugs</a></code>, <code><a href="#topic+help.WinBUGS">help.WinBUGS</a></code></p>

<hr>
<h2 id='write.datafile'>Write data for OpenBUGS - intended for internal use only</h2><span id='topic+write.datafile'></span><span id='topic+formatdata'></span>

<h3>Description</h3>

<p>Write data in files that can be read by OpenBUGS - intended for internal use only</p>


<h3>Usage</h3>

<pre><code class='language-R'>write.datafile(datalist, towhere, fill = TRUE)
formatdata(datalist)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="write.datafile_+3A_datalist">datalist</code></td>
<td>
<p>a <em>list</em> to be written into an appropriate structure</p>
</td></tr>
<tr><td><code id="write.datafile_+3A_towhere">towhere</code></td>
<td>
<p>the name of the file which the data are to be written to</p>
</td></tr>
<tr><td><code id="write.datafile_+3A_fill">fill</code></td>
<td>
<p>see <code><a href="base.html#topic+cat">cat</a></code>, defaults to <code>TRUE</code></p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>datalist.tofile</code></td>
<td>
<p>A structure appropriate to be read in by OpenBUGS.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>The main functions to be called by the user are <code><a href="#topic+bugsData">bugsData</a></code> and <code><a href="#topic+bugsInits">bugsInits</a></code>.</p>

<hr>
<h2 id='writeModel'>Creating an OpenBUGS model file</h2><span id='topic+writeModel'></span>

<h3>Description</h3>

<p>Convert R function to an OpenBUGS model file</p>


<h3>Usage</h3>

<pre><code class='language-R'>writeModel(model, con = "model.txt", digits = 5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="writeModel_+3A_model">model</code></td>
<td>
<p>R function containing the BUGS model in the BUGS model language, for minor differences see Section Details.</p>
</td></tr>
<tr><td><code id="writeModel_+3A_con">con</code></td>
<td>
<p>passed to <code>link{writeLines}</code> which actually writes the model file</p>
</td></tr>
<tr><td><code id="writeModel_+3A_digits">digits</code></td>
<td>
<p>number of significant digits used for <span class="pkg">BUGS</span>
input, see <code><a href="base.html#topic+formatC">formatC</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The fact that bugs models follow closely to S (R) syntax is used.
It should be possible to write most BUGS models as R functions.
</p>
<p>As a difference, BUGS syntax allows truncation specification like this:
<code>dnorm(...) I(...)</code>
but this is illegal in R. To overcome this incompatibility, use <code>%_%</code> before <code>I(...)</code>:
<code>dnorm(...) %_% I(...)</code>.
The dummy operator <code>%_%</code> will be removed before the BUGS code is saved.
</p>


<h3>Value</h3>

<p>Nothing, but as a side effect, the model file is written.
</p>


<h3>Author(s)</h3>

<p>original idea by Jouni Kerman, modified by Uwe Ligges</p>


<h3>See Also</h3>

<p><code><a href="#topic+modelCheck">modelCheck</a></code>, <code><a href="#topic+BRugs">BRugs</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Same "ratsmodel" that is used in the examples in ?BRugs and ?BRugsFit:
ratsmodel &lt;- function(){
    for(i in 1:N){
        for(j in 1:T){
            Y[i, j] ~ dnorm(mu[i, j],tau.c)
            mu[i, j] &lt;- alpha[i] + beta[i] * (x[j] - xbar)
        }
        alpha[i] ~ dnorm(alpha.c, alpha.tau)
        beta[i] ~ dnorm(beta.c, beta.tau)
    }
    tau.c ~ dgamma(0.001, 0.001)
    sigma &lt;- 1 / sqrt(tau.c)
    alpha.c ~ dnorm(0.0, 1.0E-6)        
    alpha.tau ~ dgamma(0.001, 0.001)
    beta.c ~ dnorm(0.0, 1.0E-6)
    beta.tau ~ dgamma(0.001, 0.001)
    alpha0 &lt;- alpha.c - xbar * beta.c       
}

## some temporary filename:
filename &lt;- file.path(tempdir(), "ratsmodel.txt")
## write model file:
writeModel(ratsmodel, filename)
## and let's take a look:
file.show(filename)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
