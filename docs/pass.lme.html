<!DOCTYPE html><html><head><title>Help for package pass.lme</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {pass.lme}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#lme.Lb.dist.theta'><p>Calculate mean and variance  <br /></p>
for linear combination of the  <br />
Best Linear Unbiased Estimator (BLUE) <br />
for Linear Mixed Effect (LME) Model</a></li>
<li><a href='#pass.lme.CLb.test'><p>Calculate Power or Sample Size required <br /></p>
for Contrasts of linear combinations <br />
of fixed effect parameters <br />
in Linear Mixed Effect (LME) Model</a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Power and Sample Size for Linear Mixed Effect Models</td>
</tr>
<tr>
<td>Version:</td>
<td>0.9.0</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.2.5)</td>
</tr>
<tr>
<td>Author:</td>
<td>Marco Chak Yan YU</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Marco Chak Yan YU &lt;marcocyyu@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Power and sample size calculation for testing fixed effect coefficients in multilevel linear mixed effect models with one or more than one independent populations. Laird, Nan M. and Ware, James H. (1982) &lt;<a href="https://doi.org/10.2307%2F2529876">doi:10.2307/2529876</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-08-20 08:34:36 UTC; marco</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-08-20 15:50:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='lme.Lb.dist.theta'>Calculate mean and variance  <br />
for linear combination of the  <br />
Best Linear Unbiased Estimator (BLUE) <br />
for Linear Mixed Effect (LME) Model</h2><span id='topic+lme.Lb.dist.theta'></span>

<h3>Description</h3>

<p>Consider the following model: <br /> <br />
Y=XB+Zu+e, u~N(0,D), e~N(0,R) <br />
Yi~N(XBi,Vi), Vi=Zi*D*Zi'+Ri, <br /> <br />
for each independent observation i <br /> <br /> <br />
estimate of fixed effect coefficient B, denoted by b: <br /> <br />
b=inv(sum(Xi'*inv(Vi)*Xi))*(sum(Xi'*inv(Vi)*Yi)) <br /> <br /> <br />
variance of b: <br /> <br />
var(b)=Vb/n=inv(sum(Xi'*inv(Vi)*Xi)) <br /> <br />
where Vb=inv(Xi'*inv(Vi)*Xi) <br /> <br /> <br />
distribution of any linear combinations L of b is given by: <br /> <br />
Lb~N(mu,Sigma/n) <br /> <br />
where mu = LB, Sigma = L*Vb*L' <br /> <br /> <br />
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lme.Lb.dist.theta(B, D, R, X, Z, m = NULL, L)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lme.Lb.dist.theta_+3A_b">B</code></td>
<td>
<p>fixed effect beta in px1 matrix</p>
</td></tr>
<tr><td><code id="lme.Lb.dist.theta_+3A_d">D</code></td>
<td>
<p>list of qxq random effect variance matrix;
where the first element corresponding to the highest-level effect,
the last element corresponding to the level 1 effect <br /> <br /></p>
</td></tr>
<tr><td><code id="lme.Lb.dist.theta_+3A_r">R</code></td>
<td>
<p>residual variance <br /> <br /></p>
</td></tr>
<tr><td><code id="lme.Lb.dist.theta_+3A_x">X</code></td>
<td>
<p>nxp matrix representing the covariates for the fixed effects <br /> <br /></p>
</td></tr>
<tr><td><code id="lme.Lb.dist.theta_+3A_z">Z</code></td>
<td>
<p>nxq matrix representing the covariates for each level of random effects <br /> <br /></p>
</td></tr>
<tr><td><code id="lme.Lb.dist.theta_+3A_m">m</code></td>
<td>
<p>vector of repeated measures from the highest to lowest level
(level 1 effects are addressed by Z and X and no need to be specified) <br /> <br /></p>
</td></tr>
<tr><td><code id="lme.Lb.dist.theta_+3A_l">L</code></td>
<td>
<p>lxp matrix, representing l-linear-combinations of beta interested, <br />
if L is not defined, it will be auto-created to select the last coefficient <br /> <br /></p>
</td></tr>
</table>


<h3>Details</h3>

<p><a href="https://drive.google.com/open?id=1MQvzp9na-Zm9mFT5jC1I_3U0JHEFky_k">Technical note</a>
</p>


<h3>Value</h3>

<p>theta:  parameters (mu and Sigma) of the normal distribution for Lb
</p>


<h3>Note</h3>

<p>License: GPL-3
</p>


<h3>Author(s)</h3>

<p>Marco Chak Yan YU <br />
Maintainer: Marco Chak Yan YU &lt;marcocyyu@gmail.com&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pass.lme.CLb.test">pass.lme.CLb.test</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Example 1
# calc BLUE for 1-level LME model,
# with covariates X, Z: (1,t), t=1,2,3
# for both fixed and random effects,
# with fixed effect coefficients B: (100,-0.5),
# random effect variance D: (2 1;1 2),
# residual variance R: 0.2
B &lt;- matrix(c(100,-0.5),2,1)
D &lt;- matrix(c(2,1,1,2),2,2)
R &lt;- 0.2
X &lt;- cbind(rep(1,3),1:3)
Z &lt;- X
lme.Lb.dist.theta(B,D,R,X,Z)

#Example 2
# calc BLUE for 3-levels LME model,
# with level 1 same as the above example
# with 3 repeated-measures in level 2
# and 5 repeated-measures in the highest level,
# assuming random effect variance for level 2 = (3 1;1 3),
# and random effect variance for highest level = (5 1;1 5)
D &lt;- list(matrix(c(2,1,1,2),2,2),matrix(c(3,1,1,3),2,2), matrix(c(5,1,1,5),2,2))
lme.Lb.dist.theta(B,D,R,X,Z,m=c(5,3))
</code></pre>

<hr>
<h2 id='pass.lme.CLb.test'>Calculate Power or Sample Size required <br />
for Contrasts of linear combinations <br />
of fixed effect parameters <br />
in Linear Mixed Effect (LME) Model</h2><span id='topic+pass.lme.CLb.test'></span>

<h3>Description</h3>

<p>Interested parameters/linear combinations LB from more than one
independent populations can be aggregrate togeter by
appending mu vertically and Sigma/n diagonally <br /> <br />
Consider Lb~N(MU,SIGMA) as the aggregrated estimates<br />
Any comparison of interested parameters can be formulated by
multiplying a contrast matrix C on LB and set <br /> <br />
H0: C*LB=d for any vector of value d to be tested <br /> <br />
We then have <br /> <br />
C*Lb~N(C*MU,C*SIGMA*C') <br /> <br />
and <br /> <br />
(C*Lb-d)'*inv(C*SIGMA*C')*(C*Lb-d)~chisq(q,lambda) <br /> <br />
where degree of freedom q=rank(C*SIGMA*C'), <br />
non-centrality parameter lambda=(C*LB-d)'*inv(C*SIGMA*C')*(C*LB-d) <br /> <br /> <br />
Power of the test H0 is given by 1-beta=P(chisq(q,lambda)&gt;qchisq(1-alpha,lambda)) <br />
Required sample size for desired power can be obtained by bisection method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pass.lme.CLb.test(thetas, C = NULL, d = NULL, alpha = 0.05,
  power = NULL, n = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pass.lme.CLb.test_+3A_thetas">thetas</code></td>
<td>
<p>list of theta (LB and VLb), can be different for each group <br /> <br /></p>
</td></tr>
<tr><td><code id="pass.lme.CLb.test_+3A_c">C</code></td>
<td>
<p>Contrast of Matrix <br /> <br /></p>
</td></tr>
<tr><td><code id="pass.lme.CLb.test_+3A_d">d</code></td>
<td>
<p>Value vector to be tested for all contrast <br /> <br /></p>
</td></tr>
<tr><td><code id="pass.lme.CLb.test_+3A_alpha">alpha</code></td>
<td>
<p>significant level <br /> <br /></p>
</td></tr>
<tr><td><code id="pass.lme.CLb.test_+3A_power">power</code></td>
<td>
<p>desired power for sample size calculation <br /> <br /></p>
</td></tr>
<tr><td><code id="pass.lme.CLb.test_+3A_n">n</code></td>
<td>
<p>sample size for power calculation / <br />
or sample size ratio with power for sample size calculation
(NULL for balanced design) <br /> <br /></p>
</td></tr>
</table>


<h3>Details</h3>

<p><a href="https://drive.google.com/open?id=1MQvzp9na-Zm9mFT5jC1I_3U0JHEFky_k">Technical note</a>
</p>


<h3>Value</h3>

<p>solved.power  given sample size n, this gives the power for testing H0 <br />
solved.n      given the desired power, this gives the sample size for H0 <br />
</p>


<h3>Note</h3>

<p>License: GPL-3
</p>


<h3>Author(s)</h3>

<p>Marco Chak Yan YU <br />
Maintainer: Marco Chak Yan YU &lt;marcocyyu@gmail.com&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lme.Lb.dist.theta">lme.Lb.dist.theta</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Example 1 (test fixed effect coefficient 2=0) with power of 80%
# for 1-level LME model, with covariates X, Z: (1,t), t=1,2,3
# for both fixed and random effects, with fixed effect coefficients B: (100,-0.5),
# random effect variance D: (2 1;1 2), residual variance R: 0.2
B &lt;- matrix(c(100,-0.5),2,1)
D &lt;- matrix(c(2,1,1,2),2,2)
R &lt;- 0.2
X &lt;- cbind(rep(1,3),1:3)
Z &lt;- X
theta &lt;- lme.Lb.dist.theta(B,D,R,X,Z)
pass.lme.CLb.test(list(theta),alpha=0.05,power=0.8)
pass.lme.CLb.test(list(theta),alpha=0.05,n=66)

#Example 2 (compare two fixed effect coefficient 2) with power of 80%
# Consider above model as a control group model,
# with an independent treatment group with model same as the control
# except a different fixed effect coefficient 2 for treatment
# = fixed effect coefficient 2 for control x 0.7
theta2 &lt;- theta
theta2$mu &lt;- theta$mu *0.7
C &lt;- matrix(c(1,-1),1,2)
pass.lme.CLb.test(list(theta,theta2),C,alpha=0.05,power=0.8)
pass.lme.CLb.test(list(theta,theta2),C,alpha=0.05,n=1468)

#Example 3 (compare two fixed effect coefficient 2) with power of 80%
# with sample size ratio, control:treatment = 1:2
pass.lme.CLb.test(list(theta,theta2),C,alpha=0.05,power=0.8,n=c(1,2))
pass.lme.CLb.test(list(theta,theta2),C,alpha=0.05,n=c(1101,2202))

#Example 4 (repeated-measures ANOVA for comparing 3 group means) with power of 80%
# for 1-level LME model with mean for group 1, 2 and 3 are 100, 99, 102, respectively,
# each subject to be measured 2 times, with within-subject variance = 15, residual variance = 10
B &lt;- 100
D &lt;- 15
R &lt;- 10
X &lt;- matrix(1,2,1)
Z &lt;- X
theta &lt;- lme.Lb.dist.theta(B,D,R,X,Z)
theta2 &lt;- theta
theta3 &lt;- theta
theta2$mu &lt;- 99
theta3$mu &lt;- 102
C &lt;- rbind(c(1,-1,0),c(1,0,-1))
pass.lme.CLb.test(list(theta,theta2,theta3),C,alpha=0.05,power=0.8)
pass.lme.CLb.test(list(theta,theta2,theta3),C,alpha=0.05,n=41)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
