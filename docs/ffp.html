<!DOCTYPE html><html><head><title>Help for package ffp</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ffp}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#autoplot.ffp'><p>Inspection of a <code>ffp</code> object with ggplot2</p></a></li>
<li><a href='#bind_probs'><p>Stack Flexible Probabilities</p></a></li>
<li><a href='#bind_views'><p>Stack Different Views</p></a></li>
<li><a href='#bootstrap_scenarios'><p>Flexible Probabilities Driven Bootstrap</p></a></li>
<li><a href='#check_input'><p>Internal function used to check the validity of inputs.</p></a></li>
<li><a href='#crisp'><p>Full Information by Market Conditioning</p></a></li>
<li><a href='#db'><p>Dataset used in Historical Scenarios with Fully Flexible Probabilities</p>
(<code>matrix</code> format).</a></li>
<li><a href='#db_tbl'><p>Dataset used in Historical Scenarios with Fully Flexible Probabilities</p>
(<code>tibble</code> format).</a></li>
<li><a href='#double_decay'><p>Flexible Probabilities using Partial Information</p></a></li>
<li><a href='#DoubleDecay'><p>Double-Decay Covariance Matrix</p></a></li>
<li><a href='#empirical_stats'><p>Summary Statistics for Empirical Distributions</p></a></li>
<li><a href='#ens'><p>Effective Number of Scenarios</p></a></li>
<li><a href='#entropy_pooling'><p>Numerical Entropy Minimization</p></a></li>
<li><a href='#exp_decay'><p>Full Information by Exponential Decay</p></a></li>
<li><a href='#ffp'><p>Manipulate the <code>ffp</code> Class</p></a></li>
<li><a href='#ffp_moments'><p>Moments with Flexible Probabilities</p></a></li>
<li><a href='#ffp-vctrs'><p>Internal vctrs methods</p></a></li>
<li><a href='#fit_to_moments'><p>Double-Decay Covariance Matrix by Entropy-Pooling</p></a></li>
<li><a href='#half_life'><p>Half-Life Calculation</p></a></li>
<li><a href='#kernel_entropy'><p>Partial Information Kernel-Damping</p></a></li>
<li><a href='#kernel_normal'><p>Full Information by Kernel-Damping</p></a></li>
<li><a href='#least_info_kernel'><p>Least Information Kernel-Smoothing</p></a></li>
<li><a href='#relative_entropy'><p>Relative Entropy</p></a></li>
<li><a href='#scenario_density'><p>Plot Scenarios</p></a></li>
<li><a href='#view_on_copula'><p>Views on Copulas</p></a></li>
<li><a href='#view_on_correlation'><p>Views on Correlation Structure</p></a></li>
<li><a href='#view_on_covariance'><p>Views on Covariance Matrix</p></a></li>
<li><a href='#view_on_joint_distribution'><p>Views on Joint Distribution</p></a></li>
<li><a href='#view_on_marginal_distribution'><p>Views on Marginal Distribution</p></a></li>
<li><a href='#view_on_mean'><p>Views on Expected Returns</p></a></li>
<li><a href='#view_on_rank'><p>Views on Relative Performance</p></a></li>
<li><a href='#view_on_volatility'><p>Views on Volatility</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Fully Flexible Probabilities for Stress Testing and Portfolio
Construction</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.2</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements numerical entropy-pooling for portfolio construction and 
    scenario analysis as described in Meucci, Attilio (2008) and Meucci, Attilio (2010) 
    &lt;<a href="https://doi.org/10.2139%2Fssrn.1696802">doi:10.2139/ssrn.1696802</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/Reckziegel/FFP">https://github.com/Reckziegel/FFP</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/Reckziegel/FFP/issues">https://github.com/Reckziegel/FFP/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Imports:</td>
<td>assertthat (&ge; 0.2.1), dplyr (&ge; 1.0.10), forcats (&ge; 0.5.2),
ggdist (&ge; 3.2.0), ggplot2 (&ge; 3.3.6), lubridate (&ge; 1.8.0),
magrittr (&ge; 2.0.3), methods, mvtnorm (&ge; 1.1-3), purrr (&ge;
0.3.4), rlang (&ge; 1.0.6), scales (&ge; 1.2.1), stringr (&ge;
1.4.1), stats, tibble (&ge; 3.1.8), tidyr (&ge; 1.2.1), vctrs (&ge;
0.4.1), nloptr (&ge; 2.0.3), crayon, NlcOptim (&ge; 0.6)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>copula, covr, ghyp, knitr (&ge; 1.40), markdown, rmarkdown,
roxygen2, spelling, testthat (&ge; 3.1.4), xts (&ge; 0.12.1)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-09-29 13:29:47 UTC; USUARIO</td>
</tr>
<tr>
<td>Author:</td>
<td>Bernardo Reckziegel [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Bernardo Reckziegel &lt;bernardo_cse@hotmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-09-29 15:10:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='autoplot.ffp'>Inspection of a <code>ffp</code> object with ggplot2</h2><span id='topic+autoplot.ffp'></span><span id='topic+plot.ffp'></span>

<h3>Description</h3>

<p>Extends the <code>autoplot</code> method for the <code>ffp</code> class.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ffp'
autoplot(object, color = TRUE, ...)

## S3 method for class 'ffp'
plot(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="autoplot.ffp_+3A_object">object</code></td>
<td>
<p>An objected of the <code>ffp</code> class.</p>
</td></tr>
<tr><td><code id="autoplot.ffp_+3A_color">color</code></td>
<td>
<p>A <code>logical</code> flag indicating whether (or not) the <code>color</code> argument
should be added to the <code>ggplot2</code> aesthetics.</p>
</td></tr>
<tr><td><code id="autoplot.ffp_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to <code>autoplot</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>ggplot2</code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ggplot2)

x &lt;- exp_decay(EuStockMarkets, 0.001)
y &lt;- exp_decay(EuStockMarkets, 0.01)

autoplot(x) +
  scale_color_viridis_c()
autoplot(y) +
  scale_color_viridis_c()
</code></pre>

<hr>
<h2 id='bind_probs'>Stack Flexible Probabilities</h2><span id='topic+bind_probs'></span>

<h3>Description</h3>

<p>This function mimics <code>dplyr</code> <code><a href="dplyr.html#topic+bind">bind</a></code>. It's useful if you
have different <code>ffp</code> objects and want to stack them in the <code>tidy</code> (long) format.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bind_probs(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bind_probs_+3A_...">...</code></td>
<td>
<p><code>ffp</code> objects to combine.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tidy <code>tibble</code>.
</p>
<p>The output adds two new columns:
</p>

<ul>
<li> <p><code>rowid</code> (an <code>integer</code>) with the row number of each realization;
</p>
</li>
<li> <p><code>key</code> (a <code>factor</code>) that keeps track of the <code>ffp</code> inputs as separated objects.
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+crisp">crisp</a></code> <code><a href="#topic+exp_decay">exp_decay</a></code> <code><a href="#topic+kernel_normal">kernel_normal</a></code>
<code><a href="#topic+kernel_entropy">kernel_entropy</a></code> <code><a href="#topic+double_decay">double_decay</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ggplot2)
library(dplyr, warn.conflicts = FALSE)

x &lt;- exp_decay(EuStockMarkets, lambda = 0.001)
y &lt;- exp_decay(EuStockMarkets, lambda = 0.002)

bind_probs(x, y)

bind_probs(x, y) %&gt;%
  ggplot(aes(x = rowid, y = probs, color = fn)) +
  geom_line() +
  scale_color_viridis_d() +
  theme(legend.position="bottom")
</code></pre>

<hr>
<h2 id='bind_views'>Stack Different Views</h2><span id='topic+bind_views'></span>

<h3>Description</h3>

<p>Bind views for entropy programming.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bind_views(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bind_views_+3A_...">...</code></td>
<td>
<p>Objects of the class <code>ffp_views</code> to combine.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>list</code> of the <code>view</code> class.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ggplot2)

# Invariant
ret &lt;- diff(log(EuStockMarkets))
n   &lt;- nrow(ret)

# Prior probabilities (usually equal weight scheme)
prior &lt;- rep(1 / n, n)

# Prior belief for expected returns (here is 0% for each asset)
view_mean &lt;- view_on_mean(x = ret, mean = rep(0, 4))

#' view on volatility
vol &lt;- apply(ret, 2, stats::sd) * 1.1 # volatility 10% higher than average
view_volatility &lt;- view_on_volatility(x = ret, vol = vol)

views_comb &lt;- bind_views(view_mean, view_volatility)
views_comb

ep &lt;- entropy_pooling(p      = prior,
                      Aeq    = views_comb$Aeq,
                      beq    = views_comb$beq,
                      A      = views_comb$A,
                      b      = views_comb$b,
                      solver = "nlminb")
autoplot(ep)
</code></pre>

<hr>
<h2 id='bootstrap_scenarios'>Flexible Probabilities Driven Bootstrap</h2><span id='topic+bootstrap_scenarios'></span><span id='topic+bootstrap_scenarios.numeric'></span><span id='topic+bootstrap_scenarios.matrix'></span><span id='topic+bootstrap_scenarios.ts'></span><span id='topic+bootstrap_scenarios.xts'></span><span id='topic+bootstrap_scenarios.tbl'></span><span id='topic+bootstrap_scenarios.data.frame'></span>

<h3>Description</h3>

<p>Resamples historical scenarios with flexible probabilities.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bootstrap_scenarios(x, p, n)

## S3 method for class 'numeric'
bootstrap_scenarios(x, p, n)

## S3 method for class 'matrix'
bootstrap_scenarios(x, p, n)

## S3 method for class 'ts'
bootstrap_scenarios(x, p, n)

## S3 method for class 'xts'
bootstrap_scenarios(x, p, n)

## S3 method for class 'tbl'
bootstrap_scenarios(x, p, n)

## S3 method for class 'data.frame'
bootstrap_scenarios(x, p, n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bootstrap_scenarios_+3A_x">x</code></td>
<td>
<p>A time series defining the scenario-probability distribution.</p>
</td></tr>
<tr><td><code id="bootstrap_scenarios_+3A_p">p</code></td>
<td>
<p>An object of the <code>ffp</code> class.</p>
</td></tr>
<tr><td><code id="bootstrap_scenarios_+3A_n">n</code></td>
<td>
<p>An <code>integer</code> scalar with the number of scenarios to be generated.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The argument <code>x</code> is supposed to have the same size of <code>p</code>.
</p>


<h3>Value</h3>

<p>A <code>tibble</code> with the number of rows equal to <code>n</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)
ret &lt;- diff(log(EuStockMarkets))
ew  &lt;- rep(1 / nrow(ret), nrow(ret))

bootstrap_scenarios(x = ret, p = as_ffp(ew), n = 10)
</code></pre>

<hr>
<h2 id='check_input'>Internal function used to check the validity of inputs.</h2><span id='topic+check_input'></span><span id='topic+check_input.default'></span><span id='topic+check_input.numeric'></span><span id='topic+check_input.double'></span><span id='topic+check_input.matrix'></span><span id='topic+check_input.xts'></span><span id='topic+check_input.tbl_df'></span>

<h3>Description</h3>

<p>Internal function used to check the validity of inputs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_input(x)

## Default S3 method:
check_input(x)

## S3 method for class 'numeric'
check_input(x)

## S3 method for class 'double'
check_input(x)

## S3 method for class 'matrix'
check_input(x)

## S3 method for class 'xts'
check_input(x)

## S3 method for class 'tbl_df'
check_input(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_input_+3A_x">x</code></td>
<td>
<p>Any object passed to other functions in the package.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix
</p>

<hr>
<h2 id='crisp'>Full Information by Market Conditioning</h2><span id='topic+crisp'></span><span id='topic+crisp.default'></span><span id='topic+crisp.numeric'></span><span id='topic+crisp.matrix'></span><span id='topic+crisp.ts'></span><span id='topic+crisp.xts'></span><span id='topic+crisp.data.frame'></span><span id='topic+crisp.tbl_df'></span>

<h3>Description</h3>

<p>Give full weight to occurrences that satisfies a logical condition.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crisp(x, lgl)

## Default S3 method:
crisp(x, lgl)

## S3 method for class 'numeric'
crisp(x, lgl)

## S3 method for class 'matrix'
crisp(x, lgl)

## S3 method for class 'ts'
crisp(x, lgl)

## S3 method for class 'xts'
crisp(x, lgl)

## S3 method for class 'data.frame'
crisp(x, lgl)

## S3 method for class 'tbl_df'
crisp(x, lgl)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="crisp_+3A_x">x</code></td>
<td>
<p>An univariate or a multivariate distribution.</p>
</td></tr>
<tr><td><code id="crisp_+3A_lgl">lgl</code></td>
<td>
<p>A <code>logical</code> vector with TRUE's and FALSE's indicating which scenarios should considered.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numerical vector of class <code>ffp</code> with the new
probabilities distribution.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+exp_decay">exp_decay</a></code> <code><a href="#topic+kernel_normal">kernel_normal</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ggplot2)
# invariance (stationarity)
ret &lt;- diff(log(EuStockMarkets))

# full weight on scenarios where CAC returns were above 2%
market_condition &lt;- crisp(x = ret, ret[ , 3] &gt; 0.02)
market_condition

autoplot(market_condition) +
  scale_color_viridis_c()
</code></pre>

<hr>
<h2 id='db'>Dataset used in Historical Scenarios with Fully Flexible Probabilities
(<code>matrix</code> format).</h2><span id='topic+db'></span>

<h3>Description</h3>

<p>Dataset used in Historical Scenarios with Fully Flexible Probabilities
(<code>matrix</code> format).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>db
</code></pre>


<h3>Format</h3>

<p>An object of class <code>matrix</code> (inherits from <code>array</code>) with 1083 rows and 9 columns.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+db_tbl">db_tbl</a></code>
</p>

<hr>
<h2 id='db_tbl'>Dataset used in Historical Scenarios with Fully Flexible Probabilities
(<code>tibble</code> format).</h2><span id='topic+db_tbl'></span>

<h3>Description</h3>

<p>Dataset used in Historical Scenarios with Fully Flexible Probabilities
(<code>tibble</code> format).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>db_tbl
</code></pre>


<h3>Format</h3>

<p>An object of class <code>tbl_df</code> (inherits from <code>tbl</code>, <code>data.frame</code>) with 1083 rows and 9 columns.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+db">db</a></code>
</p>

<hr>
<h2 id='double_decay'>Flexible Probabilities using Partial Information</h2><span id='topic+double_decay'></span><span id='topic+double_decay.default'></span><span id='topic+double_decay.numeric'></span><span id='topic+double_decay.matrix'></span><span id='topic+double_decay.ts'></span><span id='topic+double_decay.xts'></span><span id='topic+double_decay.tbl'></span><span id='topic+double_decay.data.frame'></span>

<h3>Description</h3>

<p>Match different decay-factors on the covariance matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>double_decay(x, slow, fast)

## Default S3 method:
double_decay(x, slow, fast)

## S3 method for class 'numeric'
double_decay(x, slow, fast)

## S3 method for class 'matrix'
double_decay(x, slow, fast)

## S3 method for class 'ts'
double_decay(x, slow, fast)

## S3 method for class 'xts'
double_decay(x, slow, fast)

## S3 method for class 'tbl'
double_decay(x, slow, fast)

## S3 method for class 'data.frame'
double_decay(x, slow, fast)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="double_decay_+3A_x">x</code></td>
<td>
<p>An univariate or a multivariate distribution.</p>
</td></tr>
<tr><td><code id="double_decay_+3A_slow">slow</code></td>
<td>
<p>A <code>double</code> with the long half-life (slow decay) for the correlation
matrix.</p>
</td></tr>
<tr><td><code id="double_decay_+3A_fast">fast</code></td>
<td>
<p>A <code>double</code> with the short-life (high decay) for the volatility.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numerical vector of class <code>ffp</code> with the new
probabilities distribution.
</p>


<h3>References</h3>

<p>De Santis, G., R. Litterman, A. Vesval, and K. Winkelmann, 2003,
Covariance matrix estimation, Modern investment management: an equilibrium
approach, Wiley.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+kernel_entropy">kernel_entropy</a></code> <code><a href="#topic+half_life">half_life</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  library(ggplot2)

  slow &lt;- 0.0055
  fast &lt;- 0.0166
  ret &lt;- diff(log(EuStockMarkets))

  dd &lt;- double_decay(ret, slow, fast)
  dd

  autoplot(dd) +
    scale_color_viridis_c()

</code></pre>

<hr>
<h2 id='DoubleDecay'>Double-Decay Covariance Matrix</h2><span id='topic+DoubleDecay'></span>

<h3>Description</h3>

<p>This function computes the covariance matrix using two different decay factors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DoubleDecay(x, decay_low, decay_high)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DoubleDecay_+3A_x">x</code></td>
<td>
<p>A set of relevant risk drivers.</p>
</td></tr>
<tr><td><code id="DoubleDecay_+3A_decay_low">decay_low</code></td>
<td>
<p>A <code>numeric</code> value with the low decay (long half-life).</p>
</td></tr>
<tr><td><code id="DoubleDecay_+3A_decay_high">decay_high</code></td>
<td>
<p>A <code>numeric</code> value with the high decay (short half-life).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A common practice is to estimate the covariance of the risk drivers using a high
decay (short half-life) for the volatilities and a low decay (long half-life)
for the correlations.
</p>


<h3>Value</h3>

<p>A <code>list</code> with the posterior mean ans sigma.
</p>

<hr>
<h2 id='empirical_stats'>Summary Statistics for Empirical Distributions</h2><span id='topic+empirical_stats'></span><span id='topic+empirical_stats.default'></span><span id='topic+empirical_stats.numeric'></span><span id='topic+empirical_stats.matrix'></span><span id='topic+empirical_stats.xts'></span><span id='topic+empirical_stats.ts'></span><span id='topic+empirical_stats.data.frame'></span><span id='topic+empirical_stats.tbl_df'></span>

<h3>Description</h3>

<p>Computes the mean, standard deviation, skewness, kurtosis, Value-at-Risk (VaR) and
Conditional Value-at-Risk CVaR) under flexible probabilities.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>empirical_stats(x, p, level = 0.01)

## Default S3 method:
empirical_stats(x, p, level = 0.01)

## S3 method for class 'numeric'
empirical_stats(x, p, level = 0.01)

## S3 method for class 'matrix'
empirical_stats(x, p, level = 0.01)

## S3 method for class 'xts'
empirical_stats(x, p, level = 0.01)

## S3 method for class 'ts'
empirical_stats(x, p, level = 0.01)

## S3 method for class 'data.frame'
empirical_stats(x, p, level = 0.01)

## S3 method for class 'tbl_df'
empirical_stats(x, p, level = 0.01)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="empirical_stats_+3A_x">x</code></td>
<td>
<p>A time series defining the scenario-probability distribution.</p>
</td></tr>
<tr><td><code id="empirical_stats_+3A_p">p</code></td>
<td>
<p>An object of the <code>ffp</code> class.</p>
</td></tr>
<tr><td><code id="empirical_stats_+3A_level">level</code></td>
<td>
<p>A number with the desired probability level. The default is
<code>level = 0.01</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The data in <code>x</code> and <code>p</code> are expected to have the same number of rows
(size).
</p>


<h3>Value</h3>

<p>A tidy <code>tibble</code> with 3 columns:
</p>

<ul>
<li><p> stat: a column with <code>Mu</code>, <code>Std</code>, <code>Skew</code>, <code>Kurt</code>, <code>VaR</code> and <code>CVaR</code>.
</p>
</li>
<li><p> name: the asset names.
</p>
</li>
<li><p> value: the computed value for each statistic.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>library(dplyr, warn.conflicts = FALSE)
library(ggplot2)

ret &lt;- diff(log(EuStockMarkets))

# with equal weights (standard scenario)
ew  &lt;- rep(1 / nrow(ret), nrow(ret))
empirical_stats(x = ret, p = as_ffp(ew)) %&gt;%
  ggplot(aes(x = name, y = value)) +
  geom_col() +
  facet_wrap(~stat, scales = "free") +
  labs(x = NULL, y = NULL)

# with ffp
exp_smooth &lt;- exp_decay(ret, 0.015)
empirical_stats(ret, exp_smooth) %&gt;%
  ggplot(aes(x = name, y = value)) +
  geom_col() +
  facet_wrap(~stat, scales = "free") +
  labs(x = NULL, y = NULL)
</code></pre>

<hr>
<h2 id='ens'>Effective Number of Scenarios</h2><span id='topic+ens'></span>

<h3>Description</h3>

<p>Shows how many scenarios are effectively been considered when using flexible
probabilities.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ens(p)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ens_+3A_p">p</code></td>
<td>
<p>An object of the <code>ffp</code> class.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A single <code>double</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)
p &lt;- exp_decay(stats::rnorm(100), 0.01)

# ens is smaller than 100
ens(p)
</code></pre>

<hr>
<h2 id='entropy_pooling'>Numerical Entropy Minimization</h2><span id='topic+entropy_pooling'></span>

<h3>Description</h3>

<p>This function solves the entropy minimization problem with equality and inequality
constraints. The solution is a vector of posterior probabilities that distorts
the least the prior (equal-weights probabilities) given the constraints (views on
the market).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>entropy_pooling(
  p,
  A = NULL,
  b = NULL,
  Aeq = NULL,
  beq = NULL,
  solver = c("nlminb", "solnl", "nloptr"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="entropy_pooling_+3A_p">p</code></td>
<td>
<p>A vector of prior probabilities.</p>
</td></tr>
<tr><td><code id="entropy_pooling_+3A_a">A</code></td>
<td>
<p>The linear inequality constraint (left-hand side).</p>
</td></tr>
<tr><td><code id="entropy_pooling_+3A_b">b</code></td>
<td>
<p>The linear inequality constraint (right-hand side).</p>
</td></tr>
<tr><td><code id="entropy_pooling_+3A_aeq">Aeq</code></td>
<td>
<p>The linear equality constraint (left-hand side).</p>
</td></tr>
<tr><td><code id="entropy_pooling_+3A_beq">beq</code></td>
<td>
<p>The linear equality constraint (right-hand side).</p>
</td></tr>
<tr><td><code id="entropy_pooling_+3A_solver">solver</code></td>
<td>
<p>A <code>character</code>. One of: &quot;nlminb&quot;, &quot;solnl&quot; or &quot;nloptr&quot;.</p>
</td></tr>
<tr><td><code id="entropy_pooling_+3A_...">...</code></td>
<td>
<p>Further arguments passed to one of the solvers.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When imposing views constraints there is no need to specify the non-negativity
constraint for probabilities, which is done automatically by <code>entropy_pooling</code>.
</p>
<p>For the arguments accepted in <code>...</code>, please see the documentation of
<code><a href="stats.html#topic+nlminb">nlminb</a></code>, <code><a href="NlcOptim.html#topic+solnl">solnl</a></code>, <code><a href="nloptr.html#topic+nloptr">nloptr</a></code>
and the examples bellow.
</p>


<h3>Value</h3>

<p>A vector of posterior probabilities.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># setup
ret &lt;- diff(log(EuStockMarkets))
n   &lt;- nrow(ret)

# View on expected returns (here is 2% for each asset)
mean &lt;- rep(0.02, 4)

# Prior probabilities (usually equal weight scheme)
prior &lt;- rep(1 / n, n)

# View
views &lt;- view_on_mean(x = ret, mean = mean)

# Optimization
ep &lt;- entropy_pooling(
 p      = prior,
 Aeq    = views$Aeq,
 beq    = views$beq,
 solver = "nlminb"
)
ep

### Using the ... argument to control the optimization parameters

# nlminb
ep &lt;- entropy_pooling(
 p      = prior,
 Aeq    = views$Aeq,
 beq    = views$beq,
 solver = "nlminb",
 control = list(
     eval.max = 1000,
     iter.max = 1000,
     trace    = TRUE
   )
)
ep

# nloptr
ep &lt;- entropy_pooling(
 p      = prior,
 Aeq    = views$Aeq,
 beq    = views$beq,
 solver = "nloptr",
 control = list(
     xtol_rel = 1e-10,
     maxeval  = 1000,
     check_derivatives = TRUE
   )
)
ep
</code></pre>

<hr>
<h2 id='exp_decay'>Full Information by Exponential Decay</h2><span id='topic+exp_decay'></span><span id='topic+exp_decay.default'></span><span id='topic+exp_decay.numeric'></span><span id='topic+exp_decay.matrix'></span><span id='topic+exp_decay.ts'></span><span id='topic+exp_decay.xts'></span><span id='topic+exp_decay.data.frame'></span><span id='topic+exp_decay.tbl'></span>

<h3>Description</h3>

<p>Exponential smoothing twists probabilities by giving relatively more weight
to recent observations at an exponential rate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>exp_decay(x, lambda)

## Default S3 method:
exp_decay(x, lambda)

## S3 method for class 'numeric'
exp_decay(x, lambda)

## S3 method for class 'matrix'
exp_decay(x, lambda)

## S3 method for class 'ts'
exp_decay(x, lambda)

## S3 method for class 'xts'
exp_decay(x, lambda)

## S3 method for class 'data.frame'
exp_decay(x, lambda)

## S3 method for class 'tbl'
exp_decay(x, lambda)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="exp_decay_+3A_x">x</code></td>
<td>
<p>An univariate or a multivariate distribution.</p>
</td></tr>
<tr><td><code id="exp_decay_+3A_lambda">lambda</code></td>
<td>
<p>A <code>double</code> for the decay parameter.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The half-life is linked with the lambda parameter as follows:
</p>

<ul>
<li> <p><code>HL = log(2) / lambda</code>.
</p>
</li></ul>

<p>For example: log(2) / 0.0166 is approximately 42. So, a parameter <code>lambda</code> of 0.0166
can be associated with a half-life of two-months (21 * 2).
</p>


<h3>Value</h3>

<p>A numerical vector of class <code>ffp</code> with the new
probabilities distribution.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+crisp">crisp</a></code> <code><a href="#topic+kernel_normal">kernel_normal</a></code> <code><a href="#topic+half_life">half_life</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ggplot2)

# long half_life
long_hl &lt;- exp_decay(EuStockMarkets, 0.001)
long_hl
autoplot(long_hl) +
  scale_color_viridis_c()

# short half_life
short_hl &lt;- exp_decay(EuStockMarkets, 0.015)
short_hl
autoplot(short_hl) +
  scale_color_viridis_c()
</code></pre>

<hr>
<h2 id='ffp'>Manipulate the <code>ffp</code> Class</h2><span id='topic+ffp'></span><span id='topic+is_ffp'></span><span id='topic+as_ffp'></span><span id='topic+as_ffp.default'></span><span id='topic+as_ffp.integer'></span>

<h3>Description</h3>

<p>Helpers and Constructors from <code>ffp</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ffp(x = double(), ...)

is_ffp(x)

as_ffp(x)

## Default S3 method:
as_ffp(x)

## S3 method for class 'integer'
as_ffp(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ffp_+3A_x">x</code></td>
<td>

<ul>
<li><p> For <code>ffp()</code>: A numeric vector.
</p>
</li>
<li><p> For <code>is_ffp()</code>: An object to be tested.
</p>
</li>
<li><p> For <code>as_ffp()</code>: An object to convert to <code>ffp</code>.
</p>
</li></ul>
</td></tr>
<tr><td><code id="ffp_+3A_...">...</code></td>
<td>
<p>Additional attributes to be passed to <code>ffp</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>ffp</code> class is designed to interact with doubles,
but the output of <code>c(ffp, double)</code> or <code>c(double, ffp)</code> will always return
a <code>double</code> (not an <code>ffp</code> object), since there is no way to guarantee the
interaction between a numeric vector and a probability will also be a probability.
</p>


<h3>Value</h3>


<ul>
<li> <p><code>ffp()</code> and <code>as_ffp()</code> return an S3 vector of class <code>ffp</code>
(built upon <code>double</code>'s);
</p>
</li>
<li> <p><code>is_ffp()</code> returns a <code>logical</code> object.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)
p &lt;- runif(5)
p &lt;- p / sum(p)

is_ffp(p)
as_ffp(p)
</code></pre>

<hr>
<h2 id='ffp_moments'>Moments with Flexible Probabilities</h2><span id='topic+ffp_moments'></span><span id='topic+ffp_moments.default'></span><span id='topic+ffp_moments.numeric'></span><span id='topic+ffp_moments.matrix'></span><span id='topic+ffp_moments.xts'></span><span id='topic+ffp_moments.data.frame'></span><span id='topic+ffp_moments.tbl_df'></span>

<h3>Description</h3>

<p>Computes the location and dispersion statistics under flexible probabilities.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ffp_moments(x, p = NULL)

## Default S3 method:
ffp_moments(x, p = NULL)

## S3 method for class 'numeric'
ffp_moments(x, p = NULL)

## S3 method for class 'matrix'
ffp_moments(x, p = NULL)

## S3 method for class 'xts'
ffp_moments(x, p = NULL)

## S3 method for class 'data.frame'
ffp_moments(x, p = NULL)

## S3 method for class 'tbl_df'
ffp_moments(x, p = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ffp_moments_+3A_x">x</code></td>
<td>
<p>A tabular (non-tidy) data structure.</p>
</td></tr>
<tr><td><code id="ffp_moments_+3A_p">p</code></td>
<td>
<p>An object of the <code>ffp</code> class.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>list</code> with 2 elements: <code>mu</code> and <code>sigma</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- matrix(diff(log(EuStockMarkets)), ncol = 4)
colnames(x) &lt;- colnames(EuStockMarkets)
p &lt;- stats::runif(nrow(x))
p &lt;- p / sum(p)

ffp_moments(x = x, p = p)

# compare with the standard approach
colMeans(x)
cov(x)
</code></pre>

<hr>
<h2 id='ffp-vctrs'>Internal vctrs methods</h2><span id='topic+ffp-vctrs'></span><span id='topic+new_ffp'></span><span id='topic+vec_ptype_abbr.ffp'></span><span id='topic+vec_ptype2.ffp.ffp'></span><span id='topic+vec_ptype2.ffp.double'></span><span id='topic+vec_ptype2.double.ffp'></span><span id='topic+vec_cast.ffp.ffp'></span><span id='topic+vec_cast.ffp.double'></span><span id='topic+vec_cast.double.ffp'></span><span id='topic+obj_print_data.ffp'></span><span id='topic+vec_math.ffp'></span><span id='topic+vec_arith.ffp'></span>

<h3>Description</h3>

<p>Internal vctrs methods
</p>


<h3>Usage</h3>

<pre><code class='language-R'>new_ffp(x = double(), ...)

## S3 method for class 'ffp'
vec_ptype_abbr(x, ...)

## S3 method for class 'ffp.ffp'
vec_ptype2(x, y, ...)

## S3 method for class 'ffp.double'
vec_ptype2(x, y, ...)

## S3 method for class 'double.ffp'
vec_ptype2(x, y, ...)

## S3 method for class 'ffp.ffp'
vec_cast(x, to, ...)

## S3 method for class 'ffp.double'
vec_cast(x, to, ...)

## S3 method for class 'double.ffp'
vec_cast(x, to, ...)

## S3 method for class 'ffp'
obj_print_data(x, ...)

## S3 method for class 'ffp'
vec_math(.fn, .x, ...)

## S3 method for class 'ffp'
vec_arith(op, x, y, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ffp-vctrs_+3A_x">x</code></td>
<td>
<p>A numeric vector.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for side effects.
</p>

<hr>
<h2 id='fit_to_moments'>Double-Decay Covariance Matrix by Entropy-Pooling</h2><span id='topic+fit_to_moments'></span>

<h3>Description</h3>

<p>Internal function that computes the flexible probabilities given by
double-decay covariance matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_to_moments(X, m, S)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit_to_moments_+3A_x">X</code></td>
<td>
<p>A <code>matrix</code> of size <code>TxN</code> with relevant the risk drivers.</p>
</td></tr>
<tr><td><code id="fit_to_moments_+3A_m">m</code></td>
<td>
<p>A <code>matrix</code> of size <code>Nx1</code> given by <code>Double_Decay</code>
with risk drivers location.</p>
</td></tr>
<tr><td><code id="fit_to_moments_+3A_s">S</code></td>
<td>
<p>A <code>matrix</code> of size <code>NxN</code> given by <code>Double_Decay</code>
with the dispersion matrix of the risk drivers.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>matrix</code> vector with the posterior probabilities.
</p>

<hr>
<h2 id='half_life'>Half-Life Calculation</h2><span id='topic+half_life'></span>

<h3>Description</h3>

<p>Compute the implied half-life of a decay parameter.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>half_life(lambda)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="half_life_+3A_lambda">lambda</code></td>
<td>
<p>A number.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A single number with the half-life in days.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+exp_decay">exp_decay</a></code> <code><a href="#topic+double_decay">double_decay</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>half_life(0.0166)
half_life(0.01)
</code></pre>

<hr>
<h2 id='kernel_entropy'>Partial Information Kernel-Damping</h2><span id='topic+kernel_entropy'></span><span id='topic+kernel_entropy.default'></span><span id='topic+kernel_entropy.numeric'></span><span id='topic+kernel_entropy.matrix'></span><span id='topic+kernel_entropy.ts'></span><span id='topic+kernel_entropy.xts'></span><span id='topic+kernel_entropy.tbl_df'></span><span id='topic+kernel_entropy.data.frame'></span>

<h3>Description</h3>

<p>Find the probability distribution that can
constrain the first two moments while imposing the minimal structure in the data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kernel_entropy(x, mean, sigma = NULL)

## Default S3 method:
kernel_entropy(x, mean, sigma = NULL)

## S3 method for class 'numeric'
kernel_entropy(x, mean, sigma = NULL)

## S3 method for class 'matrix'
kernel_entropy(x, mean, sigma = NULL)

## S3 method for class 'ts'
kernel_entropy(x, mean, sigma = NULL)

## S3 method for class 'xts'
kernel_entropy(x, mean, sigma = NULL)

## S3 method for class 'tbl_df'
kernel_entropy(x, mean, sigma = NULL)

## S3 method for class 'data.frame'
kernel_entropy(x, mean, sigma = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kernel_entropy_+3A_x">x</code></td>
<td>
<p>An univariate or a multivariate distribution.</p>
</td></tr>
<tr><td><code id="kernel_entropy_+3A_mean">mean</code></td>
<td>
<p>A numeric vector in which the kernel should be centered.</p>
</td></tr>
<tr><td><code id="kernel_entropy_+3A_sigma">sigma</code></td>
<td>
<p>The uncertainty (volatility) around the mean. When <code>NULL</code>, only the mean is constrained.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numerical vector of class <code>ffp</code> with the new
probabilities distribution.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+double_decay">double_decay</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ggplot2)

ret &lt;- diff(log(EuStockMarkets[ , 1]))
mean &lt;- -0.01 # scenarios around -1%
sigma &lt;- var(diff(ret))

ke &lt;- kernel_entropy(ret, mean, sigma)
ke

autoplot(ke) +
  scale_color_viridis_c()
</code></pre>

<hr>
<h2 id='kernel_normal'>Full Information by Kernel-Damping</h2><span id='topic+kernel_normal'></span><span id='topic+kernel_normal.default'></span><span id='topic+kernel_normal.numeric'></span><span id='topic+kernel_normal.matrix'></span><span id='topic+kernel_normal.ts'></span><span id='topic+kernel_normal.xts'></span><span id='topic+kernel_normal.tbl_df'></span><span id='topic+kernel_normal.data.frame'></span>

<h3>Description</h3>

<p>Historical realizations receive a weight proportional to
their distance from a target mean.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kernel_normal(x, mean, sigma)

## Default S3 method:
kernel_normal(x, mean, sigma)

## S3 method for class 'numeric'
kernel_normal(x, mean, sigma)

## S3 method for class 'matrix'
kernel_normal(x, mean, sigma)

## S3 method for class 'ts'
kernel_normal(x, mean, sigma)

## S3 method for class 'xts'
kernel_normal(x, mean, sigma)

## S3 method for class 'tbl_df'
kernel_normal(x, mean, sigma)

## S3 method for class 'data.frame'
kernel_normal(x, mean, sigma)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kernel_normal_+3A_x">x</code></td>
<td>
<p>An univariate or a multivariate distribution.</p>
</td></tr>
<tr><td><code id="kernel_normal_+3A_mean">mean</code></td>
<td>
<p>A numeric vector in which the kernel should be centered.</p>
</td></tr>
<tr><td><code id="kernel_normal_+3A_sigma">sigma</code></td>
<td>
<p>The uncertainty (volatility) around the mean.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numerical vector of class <code>ffp</code> with the new
probabilities distribution.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+crisp">crisp</a></code> <code><a href="#topic+exp_decay">exp_decay</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ggplot2)

ret &lt;- diff(log(EuStockMarkets[ , 1]))
mean &lt;- -0.01 # scenarios around -1%
sigma &lt;- var(diff(ret))

kn &lt;- kernel_normal(ret, mean, sigma)
kn

autoplot(kn) +
  scale_color_viridis_c()

# A larger sigma spreads out the distribution
sigma &lt;- var(diff(ret)) / 0.05
kn &lt;- kernel_normal(ret, mean, sigma)

autoplot(kn) +
  scale_color_viridis_c()
</code></pre>

<hr>
<h2 id='least_info_kernel'>Least Information Kernel-Smoothing</h2><span id='topic+least_info_kernel'></span>

<h3>Description</h3>

<p>This is an internal function that uses the kernel-smoothing approach to compute
the posterior probabilities that satisfies some macroeconomic statement.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>least_info_kernel(Y, y, h2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="least_info_kernel_+3A_y">Y</code></td>
<td>
<p>A <code>matrix</code> with the macroeconomic indicators.</p>
</td></tr>
<tr><td><code id="least_info_kernel_+3A_y">y</code></td>
<td>
<p>A <code>numeric</code> scalar with the target to which <code>Y</code> is expected
to be near by.</p>
</td></tr>
<tr><td><code id="least_info_kernel_+3A_h2">h2</code></td>
<td>
<p>A <code>matrix</code> with the covariance of the <code>Y</code> factor.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector with the new probability distribution.
</p>

<hr>
<h2 id='relative_entropy'>Relative Entropy</h2><span id='topic+relative_entropy'></span>

<h3>Description</h3>

<p>Computes the relative entropy of two distributions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>relative_entropy(prior, posterior)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="relative_entropy_+3A_prior">prior</code></td>
<td>
<p>A prior probability distribution.</p>
</td></tr>
<tr><td><code id="relative_entropy_+3A_posterior">posterior</code></td>
<td>
<p>A posterior probability distribution.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>double</code> with the relative entropy.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(222)

prior &lt;- rep(1 / 100, 100)

posterior &lt;- runif(100)
posterior &lt;- posterior / sum(posterior)

relative_entropy(prior, posterior)
</code></pre>

<hr>
<h2 id='scenario_density'>Plot Scenarios</h2><span id='topic+scenario_density'></span><span id='topic+scenario_histogram'></span>

<h3>Description</h3>

<p>This functions are designed to make it easier to visualize the impact of a
<em>View</em> in the P&amp;L distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scenario_density(x, p, n = 10000)

scenario_histogram(x, p, n = 10000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="scenario_density_+3A_x">x</code></td>
<td>
<p>An univariate marginal distribution.</p>
</td></tr>
<tr><td><code id="scenario_density_+3A_p">p</code></td>
<td>
<p>A probability from the <code>ffp</code> class.</p>
</td></tr>
<tr><td><code id="scenario_density_+3A_n">n</code></td>
<td>
<p>An <code>integer</code> scalar with the number of scenarios to be generated.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To generate a scenario-distribution the margins are bootstrapped using
<code><a href="#topic+bootstrap_scenarios">bootstrap_scenarios</a></code>. The number of resamples can be controlled
with the <code>n</code> argument (default is <code>n = 10000</code>).
</p>


<h3>Value</h3>

<p>A <code>ggplot2</code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- diff(log(EuStockMarkets))[, 1]
p &lt;- exp_decay(x, 0.005)

scenario_density(x, p, 500)

scenario_histogram(x, p, 500)
</code></pre>

<hr>
<h2 id='view_on_copula'>Views on Copulas</h2><span id='topic+view_on_copula'></span><span id='topic+view_on_copula.default'></span><span id='topic+view_on_copula.matrix'></span><span id='topic+view_on_copula.xts'></span><span id='topic+view_on_copula.tbl_df'></span>

<h3>Description</h3>

<p>Helper to construct constraints on copulas for entropy programming.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>view_on_copula(x, simul, p)

## Default S3 method:
view_on_copula(x, simul, p)

## S3 method for class 'matrix'
view_on_copula(x, simul, p)

## S3 method for class 'xts'
view_on_copula(x, simul, p)

## S3 method for class 'tbl_df'
view_on_copula(x, simul, p)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="view_on_copula_+3A_x">x</code></td>
<td>
<p>A multivariate copula.</p>
</td></tr>
<tr><td><code id="view_on_copula_+3A_simul">simul</code></td>
<td>
<p>A simulated target copula.</p>
</td></tr>
<tr><td><code id="view_on_copula_+3A_p">p</code></td>
<td>
<p>An object of the <code>ffp</code> class.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>list</code> of the <code>view</code> class.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  set.seed(1)
  library(ggplot2)

  # Invariants
  ret &lt;- diff(log(EuStockMarkets))
  u &lt;- apply(ret, 2, stats::pnorm) # assuming normal copula
  n &lt;- nrow(u)

  #' Prior probability distribution
  prior &lt;- rep(1 / n, n)

  # Simulated marginals
  simul_marg &lt;- bootstrap_scenarios(ret, as_ffp(prior), as.double(n))

  # Copulas derived from the simulated margins
  simul_cop &lt;- apply(simul_marg, 2, stats::pnorm) # assuming normal copula

  views &lt;- view_on_copula(x = u, simul = simul_cop, p = prior)
  views

  ep &lt;- entropy_pooling(p = prior, Aeq = views$Aeq, beq = views$beq, solver = "nloptr")
  autoplot(ep)

</code></pre>

<hr>
<h2 id='view_on_correlation'>Views on Correlation Structure</h2><span id='topic+view_on_correlation'></span><span id='topic+view_on_correlation.default'></span><span id='topic+view_on_correlation.matrix'></span><span id='topic+view_on_correlation.xts'></span><span id='topic+view_on_correlation.tbl_df'></span>

<h3>Description</h3>

<p>Helper to construct views  on the correlation matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>view_on_correlation(x, cor)

## Default S3 method:
view_on_correlation(x, cor)

## S3 method for class 'matrix'
view_on_correlation(x, cor)

## S3 method for class 'xts'
view_on_correlation(x, cor)

## S3 method for class 'tbl_df'
view_on_correlation(x, cor)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="view_on_correlation_+3A_x">x</code></td>
<td>
<p>An univariate or a multivariate distribution.</p>
</td></tr>
<tr><td><code id="view_on_correlation_+3A_cor">cor</code></td>
<td>
<p>A <code>matrix</code> for the target correlation structure of
the series in <code>x</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>list</code> of the <code>view</code> class.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ggplot2)

# Invariant
ret &lt;- diff(log(EuStockMarkets))

# Assume that a panic event throws all correlations to the roof!
co &lt;- matrix(0.95, 4, 4)
diag(co) &lt;- 1
co

# Prior probability (usually the equal-weight setting)
prior &lt;- rep(1 / nrow(ret), nrow(ret))

# View
views &lt;- view_on_correlation(x = ret, cor = co)
views

# Optimization
ep &lt;- entropy_pooling(p = prior, Aeq = views$Aeq, beq = views$beq, solver = "nlminb")
autoplot(ep)

# prior correlation structure
stats::cor(ret)

# posterior correlation structure matches the initial view very closely
stats::cov2cor(ffp_moments(x = ret, p = ep)$sigma)
</code></pre>

<hr>
<h2 id='view_on_covariance'>Views on Covariance Matrix</h2><span id='topic+view_on_covariance'></span><span id='topic+view_on_covariance.default'></span><span id='topic+view_on_covariance.matrix'></span><span id='topic+view_on_covariance.xts'></span><span id='topic+view_on_covariance.tbl_df'></span>

<h3>Description</h3>

<p>Helper to construct views on variance-covariance matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>view_on_covariance(x, mean, sigma)

## Default S3 method:
view_on_covariance(x, mean, sigma)

## S3 method for class 'matrix'
view_on_covariance(x, mean, sigma)

## S3 method for class 'xts'
view_on_covariance(x, mean, sigma)

## S3 method for class 'tbl_df'
view_on_covariance(x, mean, sigma)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="view_on_covariance_+3A_x">x</code></td>
<td>
<p>An univariate or a multivariate distribution.</p>
</td></tr>
<tr><td><code id="view_on_covariance_+3A_mean">mean</code></td>
<td>
<p>A <code>double</code> for the location parameter of the series in <code>x</code>.</p>
</td></tr>
<tr><td><code id="view_on_covariance_+3A_sigma">sigma</code></td>
<td>
<p>A <code>matrix</code> for the target variance-covariance parameter
of the series in <code>x</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>list</code> of the <code>view</code> class.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ggplot2)

# Invariant (stationarity)
ret &lt;- diff(log(EuStockMarkets))

# Expectations for location and dispersion parameters
mean &lt;- colMeans(ret) # No active expectations for returns
cor &lt;- matrix(0, ncol = 4, nrow = 4) # diagonal covariance matrix
diag(cor) &lt;- 1                       # diagonal covariance matrix
sds &lt;- apply(ret, 2, sd)             # diagonal covariance matrix
covs &lt;- diag(sds) %*% cor %*% diag(sds) ## diagonal covariance matrix

# prior probabilities (usually equal weight scheme)
prior &lt;- rep(1 / nrow(ret), nrow(ret))

# Views
views &lt;- view_on_covariance(x = ret, mean = mean, sigma = covs)
views

# Optimization
ep &lt;- entropy_pooling(p = prior, Aeq = views$Aeq, beq = views$beq, solver = "nlminb")
autoplot(ep)

# original covariance matrix
stats::cov(ret)

# Posterior covariance matrix
ffp_moments(x = ret, p = ep)$sigma
</code></pre>

<hr>
<h2 id='view_on_joint_distribution'>Views on Joint Distribution</h2><span id='topic+view_on_joint_distribution'></span><span id='topic+view_on_joint_distribution.default'></span><span id='topic+view_on_joint_distribution.matrix'></span><span id='topic+view_on_joint_distribution.xts'></span><span id='topic+view_on_joint_distribution.tbl_df'></span>

<h3>Description</h3>

<p>Helper to construct constraints on the entire distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>view_on_joint_distribution(x, simul, p)

## Default S3 method:
view_on_joint_distribution(x, simul, p)

## S3 method for class 'matrix'
view_on_joint_distribution(x, simul, p)

## S3 method for class 'xts'
view_on_joint_distribution(x, simul, p)

## S3 method for class 'tbl_df'
view_on_joint_distribution(x, simul, p)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="view_on_joint_distribution_+3A_x">x</code></td>
<td>
<p>An univariate or a multivariate distribution.</p>
</td></tr>
<tr><td><code id="view_on_joint_distribution_+3A_simul">simul</code></td>
<td>
<p>An univariate or multivariate simulated panel.</p>
</td></tr>
<tr><td><code id="view_on_joint_distribution_+3A_p">p</code></td>
<td>
<p>An object of the <code>ffp</code> class.</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li> <p><code>simul</code> must have the same number of columns than <code>x</code>
</p>
</li>
<li> <p><code>p</code> should have the same number of rows that <code>simul</code>.
</p>
</li></ul>



<h3>Value</h3>

<p>A <code>list</code> of the <code>view</code> class.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1)
library(ggplot2)

# Invariants
ret &lt;- diff(log(EuStockMarkets))
n &lt;- nrow(ret)

#' Prior probability distribution
prior &lt;- rep(1 / n, n)

# Simulated marginals
simul &lt;- bootstrap_scenarios(ret, as_ffp(prior), as.double(n))

views &lt;- view_on_joint_distribution(x = ret, simul = simul, p = prior)
views

ep &lt;- entropy_pooling(p = prior, Aeq = views$Aeq, beq = views$beq, solver = "nlminb")
autoplot(ep)

# location matches
colMeans(simul)
ffp_moments(x = ret, p = ep)$mu

# dispersion matches
cov(simul)
ffp_moments(x = ret, p = ep)$sigma
</code></pre>

<hr>
<h2 id='view_on_marginal_distribution'>Views on Marginal Distribution</h2><span id='topic+view_on_marginal_distribution'></span><span id='topic+view_on_marginal_distribution.default'></span><span id='topic+view_on_marginal_distribution.matrix'></span><span id='topic+view_on_marginal_distribution.xts'></span><span id='topic+view_on_marginal_distribution.tbl_df'></span>

<h3>Description</h3>

<p>Helper to construct constraints on the marginal distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>view_on_marginal_distribution(x, simul, p)

## Default S3 method:
view_on_marginal_distribution(x, simul, p)

## S3 method for class 'matrix'
view_on_marginal_distribution(x, simul, p)

## S3 method for class 'xts'
view_on_marginal_distribution(x, simul, p)

## S3 method for class 'tbl_df'
view_on_marginal_distribution(x, simul, p)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="view_on_marginal_distribution_+3A_x">x</code></td>
<td>
<p>An univariate or a multivariate distribution.</p>
</td></tr>
<tr><td><code id="view_on_marginal_distribution_+3A_simul">simul</code></td>
<td>
<p>An univariate or multivariate simulated panel.</p>
</td></tr>
<tr><td><code id="view_on_marginal_distribution_+3A_p">p</code></td>
<td>
<p>An object of the <code>ffp</code> class.</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li> <p><code>simul</code> must have the same number of columns than <code>x</code>
</p>
</li>
<li> <p><code>p</code> should have the same number of rows that <code>simul</code>.
</p>
</li></ul>



<h3>Value</h3>

<p>A <code>list</code> of the <code>view</code> class.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1)
library(ggplot2)

# Invariants
ret &lt;- diff(log(EuStockMarkets))
n &lt;- nrow(ret)

#' Prior probability distribution
prior &lt;- rep(1 / n, n)

# Simulated marginals
simul &lt;- bootstrap_scenarios(ret, as_ffp(prior), as.double(n))

views &lt;- view_on_marginal_distribution(x = ret, simul = simul, p = prior)
views

ep &lt;- entropy_pooling(p = prior, Aeq = views$Aeq, beq = views$beq, solver = "nlminb")
autoplot(ep)

# location matches
colMeans(simul)
ffp_moments(x = ret, p = ep)$mu

# dispersion matches
cov(simul)
ffp_moments(x = ret, p = ep)$sigma
</code></pre>

<hr>
<h2 id='view_on_mean'>Views on Expected Returns</h2><span id='topic+view_on_mean'></span><span id='topic+view_on_mean.default'></span><span id='topic+view_on_mean.matrix'></span><span id='topic+view_on_mean.xts'></span><span id='topic+view_on_mean.tbl_df'></span>

<h3>Description</h3>

<p>Helper to construct views on expected returns.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>view_on_mean(x, mean)

## Default S3 method:
view_on_mean(x, mean)

## S3 method for class 'matrix'
view_on_mean(x, mean)

## S3 method for class 'xts'
view_on_mean(x, mean)

## S3 method for class 'tbl_df'
view_on_mean(x, mean)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="view_on_mean_+3A_x">x</code></td>
<td>
<p>An univariate or a multivariate distribution.</p>
</td></tr>
<tr><td><code id="view_on_mean_+3A_mean">mean</code></td>
<td>
<p>A <code>double</code> for the target location parameter of the series in <code>x</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>list</code> of the <code>view</code> class.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ggplot2)

# Invariant
ret &lt;- diff(log(EuStockMarkets))
n   &lt;- nrow(ret)

# View on expected returns (here is 2% for each asset)
mean &lt;- rep(0.02, 4)

# Prior probabilities (usually equal weight scheme)
prior &lt;- rep(1 / n, n)

# View
views &lt;- view_on_mean(x = ret, mean = mean)
views

# Optimization
ep &lt;- entropy_pooling(p = prior, Aeq = views$Aeq, beq = views$beq, solver = "nlminb")
autoplot(ep)

# Probabilities are twisted in such a way that the posterior
# `mu` match's exactly with previously stated beliefs
ffp_moments(x = ret, p = ep)$mu
</code></pre>

<hr>
<h2 id='view_on_rank'>Views on Relative Performance</h2><span id='topic+view_on_rank'></span><span id='topic+view_on_rank.default'></span><span id='topic+view_on_rank.matrix'></span><span id='topic+view_on_rank.xts'></span><span id='topic+view_on_rank.tbl_df'></span>

<h3>Description</h3>

<p>Helper to construct views on relative performance of assets.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>view_on_rank(x, rank)

## Default S3 method:
view_on_rank(x, rank)

## S3 method for class 'matrix'
view_on_rank(x, rank)

## S3 method for class 'xts'
view_on_rank(x, rank)

## S3 method for class 'tbl_df'
view_on_rank(x, rank)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="view_on_rank_+3A_x">x</code></td>
<td>
<p>An univariate or a multivariate distribution.</p>
</td></tr>
<tr><td><code id="view_on_rank_+3A_rank">rank</code></td>
<td>
<p>A <code>integer</code> with the assets rank (from the worst to the best
performer).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>rank = c(2, 1)</code> it is implied that asset in the first column will outperform
the asset in the second column. For longer vectors the interpretation
is the same: assets on the right will outperform assets on the left.
</p>


<h3>Value</h3>

<p>A <code>list</code> of the <code>view</code> class.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ggplot2)

# Invariants
x &lt;- diff(log(EuStockMarkets))
prior &lt;- rep(1 / nrow(x), nrow(x))

# asset in the first col will outperform the asset in the second col (DAX will
# outperform SMI).
views &lt;- view_on_rank(x = x, rank = c(2, 1))
views

ep &lt;- entropy_pooling(p = prior, A = views$A, b = views$b, solver = "nloptr")
autoplot(ep)

# Prior Returns (SMI &gt; DAX)
colMeans(x)[1:2]

# Posterior Returns (DAX &gt; SMI)
ffp_moments(x, ep)$mu[1:2]
</code></pre>

<hr>
<h2 id='view_on_volatility'>Views on Volatility</h2><span id='topic+view_on_volatility'></span><span id='topic+view_on_volatility.default'></span><span id='topic+view_on_volatility.matrix'></span><span id='topic+view_on_volatility.xts'></span><span id='topic+view_on_volatility.tbl_df'></span>

<h3>Description</h3>

<p>Helper to construct views on volatility.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>view_on_volatility(x, vol)

## Default S3 method:
view_on_volatility(x, vol)

## S3 method for class 'matrix'
view_on_volatility(x, vol)

## S3 method for class 'xts'
view_on_volatility(x, vol)

## S3 method for class 'tbl_df'
view_on_volatility(x, vol)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="view_on_volatility_+3A_x">x</code></td>
<td>
<p>An univariate or a multivariate distribution.</p>
</td></tr>
<tr><td><code id="view_on_volatility_+3A_vol">vol</code></td>
<td>
<p>A <code>double</code> for the target volatility structure
of the series in <code>x</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>list</code> of the <code>view</code> class.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ggplot2)

# Invariant
ret &lt;- diff(log(EuStockMarkets))
n   &lt;- nrow(ret)

# Expected a volatility 30% higher than historical average
vol &lt;- apply(ret, 2, stats::sd) * 1.3

# Prior Probabilities
prior &lt;- rep(1 / n, n)

# Views
views &lt;- view_on_volatility(x = ret, vol = vol)
views

# Optimization
ep &lt;- entropy_pooling(p = prior, Aeq = views$Aeq, beq = views$beq, solver = "nlminb")
autoplot(ep)

# Desired volatility
vol

# Posterior volatility matches very closely with the desired volatility
sqrt(diag(ffp_moments(x = ret, p = ep)$sigma))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
