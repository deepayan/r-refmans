<!DOCTYPE html><html lang="en"><head><title>Help for package rTableICC</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {rTableICC}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#rTableICC-package'>
<p>Random Generation of R x C and  2 x 2 x K Contingency Tables</p></a></li>
<li><a href='#print.rTableICC'>
<p>Print Summary of Data Generation Process and Generated Data</p></a></li>
<li><a href='#rDiscrete'>
<p>Generate a Random Data from Discrete Probability Function</p></a></li>
<li><a href='#rTable.2x2xK'>
<p>Randomly Generate 2x2xK Contingency Tables</p></a></li>
<li><a href='#rTable.RxC'>
<p>Randomly Generate R x C Contingency Tables</p></a></li>
<li><a href='#rTableICC-internal'>
<p>Functions for internal use only</p></a></li>
<li><a href='#rTableICC.2x2xK'>
<p>Randomly Generate 2x2xK Contingency Tables over Intraclass-Correlated Individuals</p></a></li>
<li><a href='#rTableICC.RxC'>
<p>Randomly Generate RxC Contingency Tables over Intraclass-Correlated Individuals</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Random Generation of Contingency Tables</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.9</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-08-21</td>
</tr>
<tr>
<td>Author:</td>
<td>Haydar Demirhan</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Haydar Demirhan &lt;haydar.demirhan@rmit.edu.au&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Contains functions for random generation of R x C and 2 x 2 x K contingency tables. In addition to the generation of contingency tables over predetermined intraclass-correlated clusters, it is possible to generate contingency tables without intraclass correlations under product multinomial, multinomial, and Poisson sampling plans. It also consists of a function for generation of random data from a given discrete probability distribution function. See Demirhan (2016) <a href="https://journal.r-project.org/archive/2016-1/demirhan.pdf">https://journal.r-project.org/archive/2016-1/demirhan.pdf</a> for more information.</td>
</tr>
<tr>
<td>Depends:</td>
<td>partitions, aster, stats</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-21 05:18:14 UTC; haydardemirhan</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-21 06:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='rTableICC-package'>
Random Generation of R x C and  2 x 2 x K Contingency Tables
</h2><span id='topic+rTableICC-package'></span>

<h3>Description</h3>

<p>Contains functions for random generation of R x C and 2 x 2 x K contingency tables. In addition to the generation of contingency tables over predetermined intraclass-correlated clusters, it is possible to generate contingency tables without intraclass correlations under product multinomial, multinomial, and Poisson sampling plans. It also consists of a function for generation of random data from a given discrete probability distribution function (Demirhan, 2016).
</p>


<h3>Details</h3>

<p>To generate 2 x 2 x K and R x C contingency tables with intraclass-correlated observations under product multinomial, multinomial or Poisson sampling plans, respectively use <code>rTableICC.2x2xK</code> and <code>rTableICC.RxC</code> functions. 
</p>
<p>To generate 2 x 2 x K and R x C contingency tables without intraclass-correlated observations product multinomial, multinomial or Poisson sampling plans, respectively use <code>rTable.2x2xK</code> and <code>rTable.RxC</code> functions.  
</p>
<p>To generate random data from an empirical probability function, use <code>rDiscrete</code> function.
</p>


<h3>Author(s)</h3>

<p>Haydar Demirhan
</p>
<p>Maintainer: Haydar Demirhan &lt;haydar.demirhan@rmit.edu.au&gt;
</p>


<h3>References</h3>

<p>Agresti A. (2002) <em>Categorical Data Analysis</em>, Wiley, New York.
</p>
<p>Altham, P.M. (1976) Discrete variable analysis for individuals grouped into families, <em>Biometrika</em> <b>63</b>, 263&ndash;269.
</p>
<p>Nandram, B. and Choi, J.W. (2006) Bayesian analysis of a two-way categorical table incorporating intraclass correlation,
<em>Journal of Statistical Computation and Simulation</em> <b>76</b>, 233&ndash;249.
</p>
<p>Demirhan, H. (2016) rTableICC: An R package for random generation of 2x2xK and RxC contingency tables, <em>The R Journal</em> <b>8</b>, 1, 48&ndash;63.
</p>
<p>Demirhan, H. (2013) Bayesian estimation of log odds ratios over two-way contingency tables with intraclass-correlated cells, <em>Journal of Applied Statistics</em> <b>40</b>, 2303&ndash;2316.
</p>
<p>Demirhan, H. and Hamurkaroglu, C. (2008) Bayesian estimation of log odds ratios from RxC and 2 x 2 x K contingency tables, <em>Statistica Neerlandica</em> <b>62</b>, 405&ndash;424.
</p>
<p>Kroese D.P., Taimre T., Botev Z.I. (2011) <em>Handbook of Monte Carlo Methods</em>, Wiley, New York. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rTableICC.2x2xK">rTableICC.2x2xK</a></code>, <code><a href="#topic+rTableICC.RxC">rTableICC.RxC</a></code>, <code><a href="#topic+rTable.2x2xK">rTable.2x2xK</a></code>, <code><a href="#topic+rTable.RxC">rTable.RxC</a></code>, <code><a href="#topic+rDiscrete">rDiscrete</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# --- For more examples, please refer to specific functions ---

# --- Generate a random value from given probability function ---
p = c(0.23,0.11,0.05,0.03,0.31,0.03,0.22,0.02)
rDiscrete(n=2,pf=p)

# --- Generate a 2x2x4 contingency table under multinomial sampling plan with ICCs ---
num.centers=4                                # Number of centers
max.cluster.size=9                           # Maximum allowed cluster size
num.cluster=95                               # Total number of clusters under each  
                                             #  center is equal across the centers 
ICCs=array(0.1,dim=max.cluster.size)         # Assign equal ICCs for this exmaple
ICCs[1]=0                                    # Assign zero ICC to clusters with 
                                             #  one individual 
sampl="Multinomial"                          # Generate table under multinomial 
                                             #  sampling plan
num.obs=900                                  # Number of observations to be generated
cell.prob=array(0.0625,dim=c(num.centers,4)) # Cell probabilities sum up to one 

x=rTableICC.2x2xK(p=cell.prob,theta=ICCs,M=num.cluster,sampling=sampl,
                   N=num.obs,print.regular=TRUE,print.raw=FALSE)
print(x)       

# --- Generate a 2x3 contingency table under product multinomial sampling plan  ---
# --- with fixed row margins with ICCs                                          ---
max.cluster.size=9                           # Maximum allowed cluster size
num.cluster=12                               # Total number of clusters 
ICCs=array(0.1,dim=max.cluster.size)         # Assign equal ICCs for this exmaple
ICCs[1]=0                                    # Assign zero ICC to clusters with 
                                             #  one individual 
sampl="Product"                              # Generate table under product 
                                             #  multinomial sampling plan
row=c(12,12)                                 # Fixed row margins
cell.prob=array(0,dim=c(2,3))                # Cell probabilities sum up to one 
cell.prob[1,1:2]=0.2
cell.prob[1,3]=0.1
cell.prob[2,1:2]=0.1
cell.prob[2,3]=0.3                           # Marginal and cell probabilities 
                                             #  should match to each other

y=rTableICC.RxC(p=cell.prob,theta=ICCs,row.margins=row,M=num.cluster,
                 sampling=sampl,print.regular=TRUE,print.raw=FALSE)
print(y)

# --- Generate a 2x2x8 contingency table under Poisson sampling plan without ICC ---
num.centers=8                               # Number of centers
sampl="Poisson"                             # Generate table under Poisson 
                                            #  sampling plan
cell.mean=array(3,dim=c(2,2,num.centers))   # Enter mean number of individuals 
                                            #  in each cell

z=rTable.2x2xK(sampling=sampl,lambda=cell.mean)
print(z)

# --- Generate a 5x7 contingency table under multinomial sampling plan without ICC ---
num.row=5                                   # Number of rows
num.col=7                                   # Number of columns
sampl="Multinomial"                         # Generate table under multinomial 
                                            #  sampling plan
cell.prob=array(1/35,dim=c(num.row,num.col))# Enter cell probabilities in RxC 
                                            #  format 
num.obs=124                                 # Number of observations

u=rTable.RxC(p=cell.prob,sampling=sampl,N=num.obs)
print(u)

</code></pre>

<hr>
<h2 id='print.rTableICC'>
Print Summary of Data Generation Process and Generated Data
</h2><span id='topic+print.rTableICC'></span>

<h3>Description</h3>

<p>Prints summary information on data generation process and generated data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rTableICC'
print(x,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.rTableICC_+3A_x">x</code></td>
<td>

<p>an object including information and random table to be printed.
</p>
</td></tr>
<tr><td><code id="print.rTableICC_+3A_...">...</code></td>
<td>

<p>other arguments.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Haydar Demirhan
</p>
<p>Maintainer: Haydar Demirhan &lt;haydar.demirhan@rmit.edu.au&gt;
</p>

<hr>
<h2 id='rDiscrete'>
Generate a Random Data from Discrete Probability Function
</h2><span id='topic+rDiscrete'></span>

<h3>Description</h3>

<p>Generates random data from a given empirical probability function. It also returns cumulative distribution function corresponding to the entered probability function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rDiscrete(n = 1, pf)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rDiscrete_+3A_n">n</code></td>
<td>

<p>number of observations.
</p>
</td></tr>
<tr><td><code id="rDiscrete_+3A_pf">pf</code></td>
<td>

<p>empirical probability function.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>pf</code> is an array of any dimensionality with all elements sum up to one. If its dimension is greater than one, it is transformed to a row vector column-by-column. 
</p>


<h3>Value</h3>

<p>A list including 
</p>
<table role = "presentation">
<tr><td><code>rdiscrete</code></td>
<td>
<p>an <code class="reqn">nx1</code> vector that gives generated random data.</p>
</td></tr>
<tr><td><code>cdf</code></td>
<td>
<p>a vector including cumulative distribution function.</p>
</td></tr> 
</table>


<h3>Author(s)</h3>

<p>Haydar Demirhan
</p>
<p>Maintainer: Haydar Demirhan &lt;haydar.demirhan@rmit.edu.au&gt;
</p>


<h3>References</h3>

<p>Kroese D.P., Taimre T., Botev Z.I. (2011) <em>Handbook of Monte Carlo Methods</em>, Wiley, New York. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>p = c(0.23,0.11,0.05,0.03,0.31,0.03,0.22,0.02)
rDiscrete(n=2,pf=p)

# pf would be entered as a matrix:

p = matrix(c(0.23,0.11,0.05,0.03,0.31,0.03,0.22,0.02), nrow=2, ncol=4, byrow = TRUE) 
rDiscrete(n=2,pf=p)

p = matrix(c(0.23,0.11,0.05,0.03,0.31,0.03,0.22,0.02), nrow=4, ncol=2, byrow = TRUE) 
rDiscrete(n=2,pf=p)

# or pf would be entered as a three dimensional array:

p = array(c(0.23,0.11,0.05,0.03,0.31,0.03,0.22,0.02), dim=c(2,2,2))
rDiscrete(n=2,pf=p)
</code></pre>

<hr>
<h2 id='rTable.2x2xK'>
Randomly Generate 2x2xK Contingency Tables
</h2><span id='topic+rTable.2x2xK'></span>

<h3>Description</h3>

<p>A generic function that generates 2 x 2 x K contingency tables under product multinomial, multinomial or Poisson sampling plans.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rTable.2x2xK(p,sampling="Multinomial",N,K=NULL,lambda=NULL,print.raw=FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rTable.2x2xK_+3A_p">p</code></td>
<td>

<p>A finite  <code class="reqn">2\times 2\times K</code> matrix of cell probabilities.
</p>
</td></tr>
<tr><td><code id="rTable.2x2xK_+3A_sampling">sampling</code></td>
<td>

<p>Sampling plan. It takes 'Product' for product multinomial sampling, 'Multinomial' for multinomial sampling, and 'Poisson' for Poisson sampling plans.
</p>
</td></tr> 
<tr><td><code id="rTable.2x2xK_+3A_n">N</code></td>
<td>

<p>Total number of individuals to be generated under product multinomial or multinomial sampling plans. It is a vector of positive integers containing total number of observations in each center under product multinomial sampling plan, a positive integer of total sample size under all centers under multinomial sampling plan, and not required under Poisson sampling plan. If <code>N</code> is not a positive integer, its converted to do so.
</p>
</td></tr>  
<tr><td><code id="rTable.2x2xK_+3A_k">K</code></td>
<td>

<p>Number of centers. It must be supplied if a scalar is entered as the value of <code>lambda</code>.
</p>
</td></tr>  
<tr><td><code id="rTable.2x2xK_+3A_lambda">lambda</code></td>
<td>

<p>Mean number of individuals in each cell of table. It is either a <code class="reqn">2\times 2\times K</code> positive matrix or a positive scalar under Poisson sampling plan and not required for both multinomial and product multinomial sampling plans. If a positive scalar is entered, mean number of individuals in each cell will be equal to each other.
</p>
</td></tr>    
<tr><td><code id="rTable.2x2xK_+3A_print.raw">print.raw</code></td>
<td>

<p>If <code>TRUE</code>, generated raw data is printed on the screen.
</p>
</td></tr>   
</table>


<h3>Details</h3>

<p>To generate random tables under multinomial sampling plan, multinomial distribution with entered cell probabilities and total number of observations is directly used.
</p>
<p>To generate random tables under product multinomial sampling plan, center totals must be entered by <code>N</code>. It is not possible to fix any dimension of 2x2 table under each center. Suppose that center totals are denoted by <code class="reqn">n_{ij+}</code>, where <code class="reqn">i,j=1,2</code>. Then with the counts satisfying <code class="reqn">\sum_{ij}n_{ijk}=n_{ij+}</code>, we have the following multinomial form that <code>rTable.RxC</code> uses (Agresti, 2002):
</p>
<p style="text-align: center;"><code class="reqn">
      \frac{n_{ij+}!}{\prod_{ij}n_{ijk}!}\prod_{ij}p_{ij|k}^{n_{ijk}},
      </code>
</p>
 
<p>where <code class="reqn">k=1,\dots,K</code>, <code class="reqn">n_{ijk}</code> is the count of cell <code class="reqn">(i,j,k)</code>, and given that an individual is in <code class="reqn">k</code>th center, <code class="reqn">p_{ij|k}</code> is the conditional probability of being the cell <code class="reqn">(i,j)</code> of 2x2 table. This multinomial form is used to generate data under each center.
</p>
<p>To generate random tables under Poisson sampling plan, Poisson distribution with entered mean cell counts is directly used.
</p>


<h3>Value</h3>

<p>A list with the following elements:
</p>
<table role = "presentation">
<tr><td><code>rTable</code></td>
<td>
<p>A <code class="reqn">2\times 2\times K</code> dimensional array including generated 2 x 2 x K contingency table.</p>
</td></tr>
<tr><td><code>rTable.raw</code></td>
<td>
<p>Generated table in a <code class="reqn">N\times 3</code> dimensional matrix in raw data format. First columns represent 2x2 table and the third is for center.</p>
</td></tr>
<tr><td><code>N</code></td>
<td>
<p>Total number of generated individuals.</p>
</td></tr>
<tr><td><code>sampling</code></td>
<td>
<p>Used sampling plan in data generation.</p>
</td></tr>
<tr><td><code>K</code></td>
<td>
<p>Number of centers.</p>
</td></tr>
<tr><td><code>ICC</code></td>
<td>
<p>Returns <code>FALSE</code> to indicate the data is generated without intraclass-correlated clusters.</p>
</td></tr>
<tr><td><code>structure</code></td>
<td>
<p>Returns &quot;2 x 2 x K&quot; to indicate structure of generated table is &quot;2 x 2 x K.&quot;</p>
</td></tr>
<tr><td><code>print.raw</code></td>
<td>
<p><code>TRUE</code> if generated table will be printed in raw data format.</p>
</td></tr>
<tr><td><code>print.regular</code></td>
<td>
<p><code>TRUE</code> if generated table will be printed in the format determined by <code>structure</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Haydar Demirhan
</p>
<p>Maintainer: Haydar Demirhan &lt;haydar.demirhan@rmit.edu.au&gt;
</p>


<h3>References</h3>

<p>Agresti A. (2002) <em>Categorical Data Analysis</em>, Wiley, New York.
</p>
<p>Demirhan, H. and Hamurkaroglu, C. (2008) Bayesian estimation of log odds ratios from RxC and 2 x 2 x K contingency tables, <em>Statistica Neerlandica</em> <b>62</b>, 405-424.
</p>
<p>Kroese D.P., Taimre T., Botev Z.I. (2011) <em>Handbook of Monte Carlo Methods</em>, Wiley, New York. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'># --- Generate a 2x2x8 contingency table under multinomial sampling plan ---
num.centers=8                                   # Number of centers
sampl="Multinomial"                             # Generate table under multinomial 
                                                #  sampling plan
cell.prob=array(0.03125,dim=c(2,2,num.centers)) # Enter cell probabilities in 2x2xK format 
num.obs=124                                     # Number of observations

x=rTable.2x2xK(p=cell.prob,sampling=sampl,N=num.obs)
print(x)

# --- Generate a 2x2x8 contingency table under product multinomial sampling plan ---
sampl="Product"                                 # Generate table under product 
                                                #  multinomial sampling plan
center.margins=array(10,num.centers)            # Enter center margins 

y=rTable.2x2xK(p=cell.prob,sampling=sampl,N=center.margins)
print(y)

# --- Generate a 2x2x8 contingency table under Poisson sampling plan ---
num.centers=3
sampl="Poisson"                                 # Generate table under Poisson 
                                                #  sampling plan
cell.mean=array(3,dim=c(2,2,num.centers))       # Enter mean number of individuals 
                                                #  in each cell

z=rTable.2x2xK(sampling=sampl,lambda=cell.mean)
print(z)
</code></pre>

<hr>
<h2 id='rTable.RxC'>
Randomly Generate R x C Contingency Tables
</h2><span id='topic+rTable.RxC'></span>

<h3>Description</h3>

<p>A generic function that generates an RxC contingency table under product multinomial, multinomial, or Poisson sampling plans.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rTable.RxC(p,row.margins=NULL,col.margins=NULL,sampling="Multinomial",N,
            lambda=NULL,print.raw=FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rTable.RxC_+3A_p">p</code></td>
<td>

<p>A finite <code class="reqn">R\times C</code> matrix of cell probabilities. It is not required under Poisson sampling plan.
</p>
</td></tr>
<tr><td><code id="rTable.RxC_+3A_row.margins">row.margins</code></td>
<td>

<p>Includes fixed row margins under product multinomial sampling plan and not required for both multinomial and Poisson sampling plans. 
</p>
</td></tr>
<tr><td><code id="rTable.RxC_+3A_col.margins">col.margins</code></td>
<td>

<p>Includes fixed column margins under product multinomial sampling plan and not required for both multinomial and Poisson sampling plans.
</p>
</td></tr>  
<tr><td><code id="rTable.RxC_+3A_sampling">sampling</code></td>
<td>

<p>Sampling plan. It takes 'Product' for product multinomial sampling, 'Multinomial' for multinomial sampling, and 'Poisson' for Poisson sampling plans.
</p>
</td></tr> 
<tr><td><code id="rTable.RxC_+3A_n">N</code></td>
<td>

<p>Total number of individuals to be generated under product multinomial or multinomial sampling plans. It is a positive integer of total sample size under all centers for multinomial sampling plan and not required for both product multinomial and Poisson sampling plans. If <code>N</code> is not a positive integer, its converted to do so.
</p>
</td></tr>
<tr><td><code id="rTable.RxC_+3A_lambda">lambda</code></td>
<td>

<p>Mean number of individuals in each cell of table. It is either a <code class="reqn">R\times C</code> positive matrix or a positive scalar under Poisson sampling plan and not required for both multinomial and product multinomial sampling plans. If a positive scalar is entered, mean number of individuals in each cell will be equal to each other.
</p>
</td></tr>   
<tr><td><code id="rTable.RxC_+3A_print.raw">print.raw</code></td>
<td>

<p>If <code>TRUE</code>, generated raw data is printed on the screen.
</p>
</td></tr> 
</table>


<h3>Details</h3>

<p>To generate random tables under multinomial sampling plan, multinomial distribution with entered cell probabilities and total number of observations is directly used.
</p>
<p>To generate random tables under product multinomial sampling plan, at least one of <code>row.margins</code> or <code>col.margins</code> must be entered. Because both cell probabilities and fixed row or column margins are entered at the same time, margin probabilities calculated over fixed margins and entered <code class="reqn">R\times C</code> matrix of cell probabilities must be equal to each other. Suppose that row totals are fixed and <code class="reqn">n_{i+}</code> denote fixed row margins. Then with the counts satisfying <code class="reqn">\sum_{j}n_{ij}=n_{i+}</code>, we have the following multinomial form that <code>rTable.RxC</code> uses (Agresti, 2002):
</p>
<p style="text-align: center;"><code class="reqn">
      \frac{n_{i+}!}{\prod_{j}n_{ij}!}\prod_{j}p_{j|i}^{n_{ij}},
      </code>
</p>
 
<p>where <code class="reqn">j=1,\dots,C</code>, <code class="reqn">n_{ij}</code> is the count of cell <code class="reqn">(i,j)</code>, and given that an individual is in <code class="reqn">i</code>th row, <code class="reqn">p_{j|i}</code> is the conditional probability of being in <code class="reqn">j</code>th column of table. This multinomial form is used to generate data under each row margin. When column totals are fixed the same manner as the case of fixed row totals is followed.
</p>
<p>To generate random tables under Poisson sampling plan, Poisson distribution with entered mean cell counts is directly used.
</p>


<h3>Value</h3>

<p>A list with the following elements:
</p>
<table role = "presentation">
<tr><td><code>rTable</code></td>
<td>
<p>An <code class="reqn">R\times C</code> dimensional matrix including generated R x C contingency table.</p>
</td></tr>
<tr><td><code>rTable.raw</code></td>
<td>
<p>Generated table in a <code class="reqn">N\times 2</code> dimensional matrix in raw data format. Columns represent row and column numbers where each individual falls.</p>
</td></tr>
<tr><td><code>N</code></td>
<td>
<p>Total number of generated individuals.</p>
</td></tr>
<tr><td><code>sampling</code></td>
<td>
<p>Used sampling plan in data generation.</p>
</td></tr>
<tr><td><code>R</code></td>
<td>
<p>Number of rows.</p>
</td></tr>
<tr><td><code>C</code></td>
<td>
<p>Number of columns.</p>
</td></tr>
<tr><td><code>ICC</code></td>
<td>
<p>Returns <code>FALSE</code> to indicate the data is generated without intraclass-correlated clusters.</p>
</td></tr>
<tr><td><code>structure</code></td>
<td>
<p>Returns &quot;R x C&quot; to indicate structure of generated table is &quot;R x C.&quot;</p>
</td></tr>
<tr><td><code>print.raw</code></td>
<td>
<p><code>TRUE</code> if generated table will be printed in raw data format.</p>
</td></tr>
<tr><td><code>print.regular</code></td>
<td>
<p><code>TRUE</code> if generated table will be printed in the format determined by <code>structure</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Haydar Demirhan
</p>
<p>Maintainer: Haydar Demirhan &lt;haydar.demirhan@rmit.edu.au&gt;
</p>


<h3>References</h3>

<p>Agresti A. (2002) <em>Categorical Data Analysis</em>, Wiley, New York.
</p>
<p>Demirhan, H. and Hamurkaroglu, C. (2008) Bayesian estimation of log odds ratios from RxC and 2 x 2 x K contingency tables, <em>Statistica Neerlandica</em> <b>62</b>, 405-424.
</p>
<p>Kroese D.P., Taimre T., Botev Z.I. (2011) <em>Handbook of Monte Carlo Methods</em>, Wiley, New York. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'># --- Generate a 5x7 contingency table under multinomial sampling plan ---
num.row=5                                       # Number of rows
num.col=7                                       # Number of columns
sampl="Multinomial"                             # Generate table under 
                                                #  multinomial sampling plan
cell.prob=array(1/35,dim=c(num.row,num.col))    # Enter cell probabilities 
                                                #  in RxC format 
num.obs=124                                     # Number of observations

x=rTable.RxC(p=cell.prob,sampling=sampl,N=num.obs)
print(x)

# --- Generate a 3x3 contingency table under product multinomial sampling plan  ---
# --- with fixed row margins                                                    ---
num.row=3                                       # Number of rows
num.col=3                                       # Number of columns
row=c(32,12,11)                                 # Fixed row counts
sampl="Product"                                 # Generate table under product 
                                                #  multinomial sampling plan
cell.prob=array(0,dim=c(num.row,num.col))       # Enter cell probabilities in RxC format 
cell.prob[1,1]=0.12
cell.prob[1,2]=0.24
cell.prob[1,3]=32/55-0.36
cell.prob[2,1]=0.07
cell.prob[2,2]=0.1
cell.prob[2,3]=12/55-0.17
cell.prob[3,1]=0.05
cell.prob[3,2]=0.10
cell.prob[3,3]=11/55-0.15                       # Marginal and cell probabilities  
                                                #  should be equal to each other

y1=rTable.RxC(p=cell.prob,sampling=sampl,row.margins=row)
print(y1)

# --- Generate a 3x3 contingency table under product multinomial sampling plan ---
# --- with fixed row margins                                                   ---
num.row=3                                       # Number of rows
num.col=3                                       # Number of columns
col=c(5,5,10)                                   # Fixed row counts
sampl="Product"                                 # Generate table under product 
                                                #  multinomial sampling plan
cell.prob=array(0,dim=c(num.row,num.col))       # Enter cell probabilities in RxC format 
cell.prob[1,1]=0.1
cell.prob[1,2]=0.1
cell.prob[1,3]=0.05
cell.prob[2,1]=0.05
cell.prob[2,2]=0.1
cell.prob[2,3]=0.1
cell.prob[3,1]=0.3
cell.prob[3,2]=0.1
cell.prob[3,3]=0.1                             # Marginal and cell probabilities 
                                               #  should be equal to each other

y2=rTable.RxC(p=cell.prob,sampling=sampl,col.margins=col)
print(y2)

# --- Generate a 6x4 contingency table under Poisson sampling plan ---
num.row=6                                       # Number of rows
num.col=4                                       # Number of columns
sampl="Poisson"                                 # Generate table under Poisson 
                                                #  sampling plan
cell.mean=array(3,dim=c(6,4))                   # Enter mean number of individuals 
                                                #  in each cell

z=rTable.RxC(lambda=cell.mean,sampling=sampl)
print(z)

</code></pre>

<hr>
<h2 id='rTableICC-internal'>
Functions for internal use only
</h2><span id='topic+rTableICC.2x2xK.default'></span><span id='topic+rTableICC.RxC.default'></span><span id='topic+rTable.2x2xK.default'></span><span id='topic+rTable.RxC.default'></span><span id='topic+rtableICC.2x2xK.main'></span><span id='topic+rtableICC.RxC.main'></span><span id='topic+rtable.2x2xK.main'></span><span id='topic+rtable.RxC.main'></span><span id='topic+rtableICC.RxC.engine'></span><span id='topic+check'></span>

<h3>Description</h3>

<p>Contains functions desinged for internal use only. Functions including &quot;default&quot; in name makes basic checks using <code>check</code> function, and then call main function. Those including &quot;main&quot; in name carries on main processes to generate random tables. <code>rtableICC.RxC.engine</code> is the function multiply called by <code>rTable.RxC.main</code>.
</p>


<h3>Author(s)</h3>

<p>Haydar Demirhan
</p>
<p>Maintainer: Haydar Demirhan &lt;haydar.demirhan@rmit.edu.au&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rTableICC.2x2xK">rTableICC.2x2xK</a></code>, <code><a href="#topic+rTableICC.RxC">rTableICC.RxC</a></code>, <code><a href="#topic+rTable.2x2xK">rTable.2x2xK</a></code>, <code><a href="#topic+rTable.RxC">rTable.RxC</a></code>, <code><a href="#topic+rDiscrete">rDiscrete</a></code>
</p>

<hr>
<h2 id='rTableICC.2x2xK'>
Randomly Generate 2x2xK Contingency Tables over Intraclass-Correlated Individuals
</h2><span id='topic+rTableICC.2x2xK'></span>

<h3>Description</h3>

<p>A generic function that generates 2 x 2 x K contingency tables over intraclass-correlated cells under product multinomial, multinomial or Poisson sampling plans. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rTableICC.2x2xK(p,theta,M,sampling="Multinomial",N=0,lambda=NULL,zero.clusters=FALSE,
                 print.regular=TRUE,print.raw=FALSE)

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rTableICC.2x2xK_+3A_p">p</code></td>
<td>

<p>A finite matrix of cell probabilities. Dimension of <code>p</code> is <code class="reqn">K\times 4</code>, where 2x2 tables under each of K centers is expanded to a vector of 4 elements. Elements in each row of <code>p</code> should correspond to the cells (1,1), (1,2), (2,1), and (2,2), respectively. 
</p>
</td></tr>
<tr><td><code id="rTableICC.2x2xK_+3A_theta">theta</code></td>
<td>

<p>A finite and positive valued <code class="reqn">(T-1)\times 1</code> vector of predetermined ICCs, where <code class="reqn">T</code> is the maximum number of individuals allowed in each cluster. The first element of <code>theta</code> represents the ICC for clusters of size 2. 
</p>
</td></tr>
<tr><td><code id="rTableICC.2x2xK_+3A_m">M</code></td>
<td>

<p>The total number of clusters under each center. If number of clusters under each center is unbalanced, <code class="reqn">M</code> would be a <code class="reqn">K\times 1</code> vector.
</p>
</td></tr>
<tr><td><code id="rTableICC.2x2xK_+3A_sampling">sampling</code></td>
<td>

<p>Sampling plan. It takes 'Product' for product multinomial sampling, 'Multinomial' for multinomial sampling, and 'Poisson' for Poisson sampling plans.
</p>
</td></tr>  
<tr><td><code id="rTableICC.2x2xK_+3A_n">N</code></td>
<td>

<p>Total number of individuals to be generated under product multinomial or multinomial sampling plans. It is a vector of positive integers containing total number of observations in each center under product multinomial sampling plan, a positive integer of total sample size under all centers under multinomial sampling plan, and not required under Poisson sampling plan. If <code>N</code> is not a positive integer, it is converted to do so.
</p>
</td></tr> 
<tr><td><code id="rTableICC.2x2xK_+3A_lambda">lambda</code></td>
<td>

<p>Mean number of individuals in each cluster. It is either a <code class="reqn">K\times 1</code> positive vector or a positive scalar under Poisson sampling plan and not required for both multinomial and product multinomial sampling plans. If a positive scalar is entered, mean number of individuals in each cluster under all centers will be equal to each other. If a vector is entered, mean number of individuals in each cluster under each center will be equal to each other.
</p>
</td></tr>    
<tr><td><code id="rTableICC.2x2xK_+3A_zero.clusters">zero.clusters</code></td>
<td>

<p>If <code>TRUE</code>, generation of clusters with no individuals are allowed. Otherwise, each cluster has at least one individual. 
</p>
</td></tr>  
<tr><td><code id="rTableICC.2x2xK_+3A_print.regular">print.regular</code></td>
<td>

<p>If <code>TRUE</code>, generated random table is printed in 2x2xK format. Otherwise, generated random table is printed in two dimensional format. 
</p>
</td></tr>  
<tr><td><code id="rTableICC.2x2xK_+3A_print.raw">print.raw</code></td>
<td>

<p>If <code>TRUE</code>, generated raw data is printed on the screen.
</p>
</td></tr>     
</table>


<h3>Details</h3>

<p>To generate random tables under multinomial sampling plan, first total sample size is distributed to clusters with equal probabilities using the code <code>rmultinom(1, N, rep(1/M,M))</code>. Then, for each center, the package <code>partitions</code> is utilized to distribute individuals across cells of 2 x 2 tables under the pre-determined intraclass correlations. Let <code class="reqn">n</code> and <code class="reqn">m</code> be integer to be partitioned (cluster size) and order of partition, respectively. If there is more than one individual (<code class="reqn">n&gt;1</code>) in a cluster, all possible compositions of order <code class="reqn">RC</code> of cluster size <code class="reqn">n</code> into at most <code class="reqn">m</code> parts are generated by using <code>compositions</code> function. This provides all possible distributions of individuals in the cluster of interest into 2 x 2 table of interest. If all individuals are at the same cell, the following equation is used to calculate the probability that all individuals in the <code class="reqn">i</code>th cluster fall in the same cell of a contingency table of interest:
</p>
<p style="text-align: center;"><code class="reqn">
      \theta_{t}p_{ij}+(1-\theta_{t})(p_{ij})^{t},
</code>
</p>
 
<p>where <code class="reqn">i,j=1,2</code>, <code class="reqn">0\le\theta\le 1</code>, <code class="reqn">\theta_{t}</code> is the intraclass correlation for clusters of size <code class="reqn">t</code> for <code class="reqn">t=2,\dots,T</code>, and <code class="reqn">\theta_{1}=0</code>. Otherwise, the probability that the individuals are in different but specified cells is calculated as follows:
</p>
<p style="text-align: center;"><code class="reqn">
      (1-\theta_{t})\prod_{ij}(p_{ij})^{n_{rij}},
</code>
</p>

<p>where <code class="reqn">n_{rij}</code> be the number of individuals from <code class="reqn">r</code>th cluster falling in the <code class="reqn">i</code>th row and <code class="reqn">j</code>th column of the considered 2 x 2 table (Altham, 1976; Nandram and Choi, 2006; Demirhan, 2013). This provides probability of each possible distribution. Then, calculated probabilities are normalized and the function <code>rDiscrete</code> is utilized to randomly select one of the generated compositions. By this way, a realization is obtained for each cluster having more than one individual. If there is only one individual in a cluster, a realization is obtained by assigning the individual to cells according to the entered cell probabilities using the function <code>rDiscrete</code>. The resulting random 2x2 table under one of <code class="reqn">K</code> centers is constructed by combining these realizations. This process is repeated for all of <code class="reqn">K</code> centers.
</p>
<p>To generate random tables under product multinomial sampling plan, center margins must be entered by <code>N</code>. Because both cell probabilities and fixed center margins are entered at the same time, margin probabilities calculated over the number of individuals in each center and entered <code class="reqn">K\times 4</code> matrix of cell probabilities must be equal to each other. To ensure intraclass correlations, the same manner as multinomial sampling plan is applied to each center. Suppose that center totals are denoted by <code class="reqn">n_{ij+}</code>, where <code class="reqn">i,j=1,2</code>. Then with the counts satisfying <code class="reqn">\sum_{ij}n_{ijk}=n_{ij+}</code>, we have the following multinomial form that <code>rTableICC.2x2xK</code> uses (Agresti, 2002):
</p>
<p style="text-align: center;"><code class="reqn">
      \frac{n_{ij+}!}{\prod_{ij}n_{ijk}!}\prod_{ij}p_{ij|k}^{n_{ijk}},
      </code>
</p>
 
<p>where <code class="reqn">k=1,\dots,K</code>, <code class="reqn">n_{ijk}</code> is the count of cell <code class="reqn">(i,j,k)</code>, and given that an individual is in <code class="reqn">k</code>th center, <code class="reqn">p_{ij|k}</code> is the conditional probability of being in the cell <code class="reqn">(i,j)</code> of 2 x 2 table. This multinomial form is used to generate data under each center. 
</p>
<p>To generate random tables under Poisson sampling plan, the same manner as multinomial sampling plan is taken except cluster sizes are generated from Poisson distribution with entered mean cluster counts and total sample size is calculated over the generated cluster sizes. If zero sized clusters are not allowed, truncated Poisson distribution is used to generate cluster counts.
</p>
<p>Because total sample size is randomly distributed into the clusters, it is coincidentally possible to have clusters with more individuals than the allowed maximum cluster size. In this case, the following error message is generated: 
</p>
<p><code>Maximum number of individuals in one of the clusters is 14, which is greater than maximum allowed cluster size. (1) Re-run the function,
(2) increase maximum allowed cluster size by increasing the number of elements of theta, (3) increase total number of clusters, or (4) decrease total number of individuals!</code> 
</p>
<p>and execution is stopped.  
</p>


<h3>Value</h3>

<p>Let <code class="reqn">C</code> be the set of clusters in which all individuals fall in a single cell of the contingency table and <code class="reqn">C'</code> be the complement of <code class="reqn">C</code>,  <code class="reqn">K</code> be the number of centers, and <code class="reqn">T</code> be the maximum cluster size.
</p>
<p>A list with the following elements is generated:
</p>
<table role = "presentation">
<tr><td><code>g.t</code></td>
<td>
<p>A <code class="reqn">2K\times 2\times (T-1)</code> dimensional array including the number of clusters of size <code class="reqn">t</code> in <code class="reqn">C'</code> of size <code class="reqn">t</code> with all individuals in cell <code class="reqn">(i,j)</code>, where <code class="reqn">i,j=1,2</code> and <code class="reqn">t=2,\dots,T</code>.</p>
</td></tr>
<tr><td><code>g.tilde</code></td>
<td>
<p>A <code class="reqn">(T-1)\times 1</code> dimensional vector including the number of clusters of size <code class="reqn">t</code> in <code class="reqn">C'</code>, where <code class="reqn">t=2,\dots,T</code>.</p>
</td></tr>
<tr><td><code>rTable</code></td>
<td>
<p>A <code class="reqn">K\times (2*2)</code> dimensional matrix including generated 2 x 2 contingency table under each center in its each row.</p>
</td></tr>
<tr><td><code>rTable.raw</code></td>
<td>
<p>Generated table in a <code class="reqn">N\times 2K\times 2</code> dimensional array in raw data format.</p>
</td></tr>
<tr><td><code>rTable.regular</code></td>
<td>
<p>Generated table in a <code class="reqn">2\times 2\times K</code> dimensional array.</p>
</td></tr>
<tr><td><code>N</code></td>
<td>
<p>Total number of generated individuals.</p>
</td></tr>
<tr><td><code>cluster.size</code></td>
<td>
<p>Size of each generated cluster.</p>
</td></tr>
<tr><td><code>sampling</code></td>
<td>
<p>Used sampling plan in data generation.</p>
</td></tr>
<tr><td><code>M</code></td>
<td>
<p>Total number of clusters under each center.</p>
</td></tr>
<tr><td><code>K</code></td>
<td>
<p>Number of centers.</p>
</td></tr>
<tr><td><code>T</code></td>
<td>
<p>Maximum allowed cluster size.</p>
</td></tr>
<tr><td><code>ICC</code></td>
<td>
<p>Returns <code>TRUE</code> to indicate the data is generated under intraclass-correlated clusters.</p>
</td></tr>
<tr><td><code>structure</code></td>
<td>
<p>Returns &quot;2 x 2 x K&quot; to indicate structure of generated table is &quot;2 x 2 x K.&quot;</p>
</td></tr>
<tr><td><code>print.raw</code></td>
<td>
<p><code>TRUE</code> if generated table will be printed in raw data format.</p>
</td></tr>
<tr><td><code>print.regular</code></td>
<td>
<p><code>TRUE</code> if generated table will be printed in the format determined by <code>structure</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Haydar Demirhan
</p>
<p>Maintainer: Haydar Demirhan &lt;haydar.demirhan@rmit.edu.au&gt;
</p>


<h3>References</h3>

<p>Agresti A. (2002) <em>Categorical Data Analysis</em>, Wiley, New York.
</p>
<p>Altham, P.M. (1976) Discrete variable analysis for individuals grouped into families, <em>Biometrika</em> <b>63</b>, 263&ndash;269.
</p>
<p>Nandram, B. and Choi, J.W. (2006) Bayesian analysis of a two-way categorical table incorporating intraclass correlation,
<em>Journal of Statistical Computation and Simulation</em> <b>76</b>, 233&ndash;249.
</p>
<p>Demirhan, H. (2013) Bayesian estimation of log odds ratios over two-way contingency tables with intraclass-correlated cells, <em>Journal of Applied Statistics</em> <b>40</b>, 2303&ndash;2316.
</p>
<p>Demirhan, H. and Hamurkaroglu, C. (2008) Bayesian estimation of log odds ratios from RxC and 2x2xK contingency tables, <em>Statistica Neerlandica</em> <b>62</b>, 405&ndash;424.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# --- Generate a 2x2x4 contingency table under multinomial sampling plan ---
num.centers=4                                # Number of centers
max.cluster.size=9                           # Maximum allowed cluster size
num.cluster=95                               # Total number of clusters under 
                                             #  centers each center is equal across the  
ICCs=array(0.1,dim=max.cluster.size)         # Assign equal ICCs for this exmaple
ICCs[1]=0                                    # Assign zero ICC to clusters with 
                                             #  one individual 
sampl="Multinomial"                          # Generate table under multinomial 
                                             #  sampling plan
num.obs=900                                  # Number of observations to be 
                                             #  generated
cell.prob=array(0.0625,dim=c(num.centers,4)) # Cell probabilities sum up to one 

zeros=FALSE                                  # Do not allow zero sized clusters

x=rTableICC.2x2xK(p=cell.prob,theta=ICCs,M=num.cluster,sampling=sampl,zero.clusters=zeros,
                   N=num.obs,print.regular=TRUE,print.raw=FALSE)
print(x)                          

# --- Generate a 2x2x4 contingency table under product multinomial sampling plan ---

sampl="Product"                              # Generate table under product 
                                             #  multinomial sampling plan
num.obs=c(200,200,200,200)                   # Number of observations to be generated 
                                             #  under each center
cell.prob=array(0.0625,dim=c(num.centers,4)) # Cell probabilities sum up to one 
zeros=FALSE                                  # Do not allow zero sized clusters

y=rTableICC.2x2xK(p=cell.prob,theta=ICCs,M=num.cluster,sampling=sampl,
                  zero.clusters=zeros,N=num.obs,print.regular=TRUE,print.raw=FALSE)
print(y)

# --- Generate a 2x2x4 contingency table under Poisson sampling plan ---

sampl="Poisson"                              # Generate table under Poisson 
                                             #  sampling plan
cell.mean=2                                  # Assign equal mean number of 
                                             #  individual to all cells
cell.prob=array(0.0625,dim=c(num.centers,4)) # Cell probabilities sum up 
                                             #  to one 

z1=rTableICC.2x2xK(p=cell.prob,lambda=cell.mean,theta=ICCs,M=num.cluster,
                    sampling=sampl,N=num.obs,print.regular=TRUE,print.raw=FALSE)
print(z1)

cell.mean=c(2,3,3,2)                         # Assign equal mean number of individual 
                                             #  to cells under each center
max.cluster.size=19                          # Maximum allowed cluster size
ICCs=array(0.1,dim=max.cluster.size)         # Assign equal ICCs for this exmaple
ICCs[1]=0                                    # Assign zero ICC to clusters with one 
                                             #  individual

z2=rTableICC.2x2xK(p=cell.prob,lambda=cell.mean,theta=ICCs,M=num.cluster,
                    sampling=sampl,N=num.obs,print.regular=TRUE,print.raw=FALSE)
print(z2)
</code></pre>

<hr>
<h2 id='rTableICC.RxC'>
Randomly Generate RxC Contingency Tables over Intraclass-Correlated Individuals
</h2><span id='topic+rTableICC.RxC'></span>

<h3>Description</h3>

<p>A generic function that generates R x C contingency tables over intraclass-correlated cells under product multinomial, multinomial or Poisson sampling plans. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rTableICC.RxC(p=NULL,theta,M,row.margins=NULL,col.margins=NULL,sampling="Multinomial",
               N=1,lambda=NULL,zero.clusters=FALSE,print.regular=TRUE,print.raw=FALSE)

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rTableICC.RxC_+3A_p">p</code></td>
<td>

<p>A finite <code class="reqn">R\times C</code> matrix of cell probabilities.
</p>
</td></tr>
<tr><td><code id="rTableICC.RxC_+3A_theta">theta</code></td>
<td>

<p>A finite and positive valued <code class="reqn">(T-1)\times 1</code> vector of predetermined ICCs, where <code class="reqn">T</code> is the maximum number of individuals allowed in each cluster. The first element of <code>theta</code> represents the ICC for clusters of size 2. 
</p>
</td></tr>
<tr><td><code id="rTableICC.RxC_+3A_m">M</code></td>
<td>

<p>The total number of clusters under each factor. It must be a positive scalar under multinomial and Poisson sampling plans and can be a vector of length equal to that of number of rows or columns under product multinomial sampling plan. If it is a scalar, number of clusters under levels of fixed margin is assigned equal.
</p>
</td></tr>  
<tr><td><code id="rTableICC.RxC_+3A_row.margins">row.margins</code></td>
<td>

<p>Includes fixed row margins under product multinomial sampling plan and not required for both multinomial and Poisson sampling plans. 
</p>
</td></tr>    
<tr><td><code id="rTableICC.RxC_+3A_col.margins">col.margins</code></td>
<td>

<p>Includes fixed column margins under product multinomial sampling plan and not required for both multinomial and Poisson sampling plans.
</p>
</td></tr>  
<tr><td><code id="rTableICC.RxC_+3A_sampling">sampling</code></td>
<td>

<p>Sampling plan. It takes 'Product' for product multinomial sampling, 'Multinomial' for multinomial sampling, and 'Poisson' for Poisson sampling plans.
</p>
</td></tr>  
<tr><td><code id="rTableICC.RxC_+3A_n">N</code></td>
<td>

<p>Total number of individuals to be generated under product multinomial or multinomial sampling plans. It is a positive integer of total sample size under multinomial sampling plan and not required under both product multinomial and Poisson sampling plans. If <code>N</code> is not a positive integer, it is converted to do so.
</p>
</td></tr>  
<tr><td><code id="rTableICC.RxC_+3A_lambda">lambda</code></td>
<td>

<p>Mean number of individuals in each cell of table. It is an <code class="reqn">R\times C</code> positive matrix under Poisson sampling plan and not required for both multinomial and product multinomial sampling plans.
</p>
</td></tr>  
<tr><td><code id="rTableICC.RxC_+3A_zero.clusters">zero.clusters</code></td>
<td>

<p>If <code>TRUE</code>, generation of clusters with no individuals are allowed. Otherwise, each cluster has at least one individual. 
</p>
</td></tr>
<tr><td><code id="rTableICC.RxC_+3A_print.regular">print.regular</code></td>
<td>

<p>If <code>TRUE</code>, generated random table is printed in <code class="reqn">2\times 2\times K</code> format. Otherwise, generated random table is printed in two dimensional format. 
</p>
</td></tr>  
<tr><td><code id="rTableICC.RxC_+3A_print.raw">print.raw</code></td>
<td>

<p>If <code>TRUE</code>, generated raw data is printed on the screen.
</p>
</td></tr>   
</table>


<h3>Details</h3>

<p>To generate random tables under multinomial sampling plan, first total sample size is distributed to clusters with equal probabilities using the code <code>rmultinom(1, N, rep(1/M,M))</code>. Then the package <code>partitions</code> is utilized to distribute individuals across cells under the pre-determined intraclass correlations. Let <code class="reqn">n</code> and <code class="reqn">m</code> be integer to be partitioned (cluster size) and order of partition, respectively. If there is more than one individual (<code class="reqn">n&gt;1</code>) in a cluster, all possible compositions of order <code class="reqn">RC</code> of cluster size <code class="reqn">n</code> into at most <code class="reqn">m</code> parts are generated by using <code>compositions</code> function. This provides all possible distributions of individuals in the cluster of interest into <code class="reqn">RC</code> cells. If all individuals are at the same cell, the following equation is used to calculate the probability that all individuals in the <code class="reqn">i</code>th cluster fall in the same cell of a contingency table of interest:
</p>
<p style="text-align: center;"><code class="reqn">
      \theta_{t}p_{ij}+(1-\theta_{t})(p_{ij})^{t},
</code>
</p>
 
<p>where <code class="reqn">i=1,\dots,R</code>, <code class="reqn">j=1,\dots,C</code>, <code class="reqn">0\le\theta\le 1</code>, <code class="reqn">\theta_{t}</code> is the intraclass correlation for clusters of size <code class="reqn">t</code> for <code class="reqn">t=2,\dots,T</code>, and <code class="reqn">\theta_{1}=0</code>. Otherwise, the probability that the individuals are in different but specified cells is calculated as follows:
</p>
<p style="text-align: center;"><code class="reqn">
      (1-\theta_{t})\prod_{ij}(p_{ij})^{n_{kij}},
</code>
</p>

<p>where <code class="reqn">n_{kij}</code> be the number of individuals from <code class="reqn">k</code>th cluster falling in the <code class="reqn">i</code>th row and <code class="reqn">j</code>th column of the considered RxC table (Altham, 1976; Nandram and Choi, 2006; Demirhan, 2013). This provides probability of each possible distribution. Then, calculated probabilities are normalized and the function <code>rDiscrete</code> is utilized to randomly select one of the generated compositions. By this way, a realization is obtained for each cluster having more than one individual. If there is only one individual in a cluster, a realization is obtained by assigning the individual to cells according to the entered cell probabilities using the function <code>rDiscrete</code>. The resulting random RxC table is constructed by combining these realizations. 
</p>
<p>To generate random tables under product multinomial sampling plan, at least one of <code>row.margins</code> or <code>col.margins</code> must be entered. Because both cell probabilities and fixed row or column margins are entered at the same time, margin probabilities calculated over fixed margins and entered <code class="reqn">R\times C</code> matrix of cell probabilities must be equal to each other. To ensure intraclass correlations, the same manner as multinomial sampling plan is applied to the fixed margin. Suppose that row totals are fixed and <code class="reqn">n_{i+}</code> denotes fixed row margins. Then with the counts satisfying <code class="reqn">\sum_{j}n_{ij}=n_{i+}</code>, we have the following multinomial form that <code>rTableICC.RxC</code> uses (Agresti, 2002):
</p>
<p style="text-align: center;"><code class="reqn">
      \frac{n_{i+}!}{\prod_{j}n_{ij}!}\prod_{j}p_{j|i}^{n_{ij}},
      </code>
</p>
 
<p>where <code class="reqn">j=1,\dots,C</code>, <code class="reqn">n_{ij}</code> is the count of cell <code class="reqn">(i,j)</code>, and given that an individual is in <code class="reqn">i</code>th row, <code class="reqn">p_{j|i}</code> is the conditional probability of being in the <code class="reqn">j</code>th column of table. This multinomial form is used to generate data under each row margin. When column totals are fixed the same manner as the case of fixed row totals is followed.
</p>
<p>To generate random tables under Poisson sampling plan, the same manner as multinomial sampling plan is taken except cell counts are generated from Poisson distribution with entered mean cell counts and total sample size is calculated over the generated cell counts. If zero sized clusters are not allowed, truncated Poisson distribution is used to generate cluster counts.
</p>
<p>Because total sample size is randomly distributed into the clusters, it is coincidentally possible to have clusters with more individuals than the allowed maximum cluster size. In this case, the following error message is generated: 
</p>
<p><code>Maximum number of individuals in one of the clusters is 14, which is greater than maximum allowed cluster size. (1) Re-run the function,
(2) increase maximum allowed cluster size by increasing the number of elements of theta, (3) increase total number of clusters, or (4) decrease total number of individuals!</code> 
</p>
<p>and execution is stopped.  
</p>


<h3>Value</h3>

<p>Let <code class="reqn">C</code> be the set of clusters in which all individuals fall in a single cell of the contingency table and <code class="reqn">C'</code> be the complement of <code class="reqn">C</code>,  <code class="reqn">K</code> be the number of centers, and <code class="reqn">T</code> be the maximum cluster size.
</p>
<p>A list with the following elements is generated:
</p>
<table role = "presentation">
<tr><td><code>g.t</code></td>
<td>
<p>A <code class="reqn">R\times C\times (T-1)</code> dimensional array including the number of clusters of size t in <code class="reqn">C'</code> of size <code class="reqn">t</code> with all individuals in cell <code class="reqn">(i,j)</code>, where <code class="reqn">i=1,\dots,R</code>, <code class="reqn">j=1,\dots,C</code>, and <code class="reqn">t=2,\dots,T</code>.</p>
</td></tr>
<tr><td><code>g.tilde</code></td>
<td>
<p>A <code class="reqn">(T-1)\times 1</code> dimensional vector including the number of clusters of size <code class="reqn">t</code> in <code class="reqn">C'</code>, where <code class="reqn">t=2,\dots,T</code>.</p>
</td></tr>
<tr><td><code>rTable</code></td>
<td>
<p>A <code class="reqn">RC\times 1</code> dimensional vector including generated RxC contingency table in a row.</p>
</td></tr>
<tr><td><code>rTable.raw</code></td>
<td>
<p>Generated table in a <code class="reqn">R\times C\times N</code> dimensional array in raw data format.</p>
</td></tr>
<tr><td><code>rTable.regular</code></td>
<td>
<p>Generated table in an <code class="reqn">R\times C</code> dimensional matrix.</p>
</td></tr>
<tr><td><code>N</code></td>
<td>
<p>Total number of generated individuals.</p>
</td></tr>
<tr><td><code>cluster.size</code></td>
<td>
<p>Size of each generated cluster.</p>
</td></tr>
<tr><td><code>sampling</code></td>
<td>
<p>Used sampling plan in data generation.</p>
</td></tr>
<tr><td><code>M</code></td>
<td>
<p>Total number of clusters.</p>
</td></tr>
<tr><td><code>R</code></td>
<td>
<p>Number of rows.</p>
</td></tr>
<tr><td><code>C</code></td>
<td>
<p>Number of columns.</p>
</td></tr>
<tr><td><code>T</code></td>
<td>
<p>Maximum allowed cluster size.</p>
</td></tr>
<tr><td><code>ICC</code></td>
<td>
<p>Returns <code>TRUE</code> to indicate the data is generated under intraclass-correlated clusters.</p>
</td></tr>
<tr><td><code>structure</code></td>
<td>
<p>Returns &quot;R x C&quot; to indicate structure of generated table is &quot;R x C.&quot;</p>
</td></tr>
<tr><td><code>print.raw</code></td>
<td>
<p><code>TRUE</code> if generated table will be printed in raw data format.</p>
</td></tr>
<tr><td><code>print.regular</code></td>
<td>
<p><code>TRUE</code> if generated table will be printed in the format determined by <code>structure</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Haydar Demirhan
</p>
<p>Maintainer: Haydar Demirhan &lt;haydar.demirhan@rmit.edu.au&gt;
</p>


<h3>References</h3>

<p>Agresti A. (2002) <em>Categorical Data Analysis</em>, Wiley, New York.
</p>
<p>Altham, P.M. (1976) Discrete variable analysis for individuals grouped into families, <em>Biometrika</em> <b>63</b>, 263&ndash;269.
</p>
<p>Nandram, B. and Choi, J.W. (2006) Bayesian analysis of a two-way categorical table incorporating intraclass correlation,
<em>Journal of Statistical Computation and Simulation</em> <b>76</b>, 233&ndash;249.
</p>
<p>Demirhan, H. (2013) Bayesian estimation of log odds ratios over two-way contingency tables with intraclass-correlated cells, <em>Journal of Applied Statistics</em> <b>40</b>, 2303&ndash;2316.
</p>
<p>Demirhan, H. and Hamurkaroglu, C. (2008) Bayesian estimation of log odds ratios from RxC and 2 x 2 x K contingency tables, <em>Statistica Neerlandica</em> <b>62</b>, 405&ndash;424.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># --- Generate a 2x3 contingency table under multinomial sampling plan ---
max.cluster.size=9                          # Maximum allowed cluster size
num.cluster=12                              # Total number of clusters 
ICCs=array(0.1,dim=max.cluster.size)        # Assign equal ICCs for this exmaple
ICCs[1]=0                                   # Assign zero ICC to clusters with 
                                            #  one individual 
sampl="Multinomial"                         # Generate table under multinomial 
                                            #  sampling plan
num.obs=24                                  # Number of observations to be 
                                            #  generated
cell.prob=array(1/6,dim=c(2,3))             # Cell probabilities sum up to one 
zeros=FALSE                                 # Do not allow zero sized clusters

x=rTableICC.RxC(p=cell.prob,theta=ICCs,M=num.cluster,sampling=sampl,
                 N=num.obs,zero.clusters=zeros,print.regular=TRUE,
                 print.raw=FALSE)
print(x) 

# --- Generate a 2x3 contingency table under product multinomial sampling plan ---
# --- with fixed row margins                                                   ---
sampl="Product"                             # Generate table under product 
                                            #  multinomial sampling plan
row=c(12,12)                                # Fixed row margins
cell.prob=array(0,dim=c(2,3))               # Cell probabilities sum up to one 
cell.prob[1,1:2]=0.2
cell.prob[1,3]=0.1
cell.prob[2,1:2]=0.1
cell.prob[2,3]=0.3                          # Marginal and cell probabilities 
                                            #  should be equal to each other

y1=rTableICC.RxC(p=cell.prob,theta=ICCs,row.margins=row,M=num.cluster,
                  sampling=sampl,print.regular=TRUE,print.raw=FALSE)
print(y1)

# --- Generate a 3x2 contingency table under product multinomial sampling plan ---
# --- with fixed cloumn margins                                                ---
col=c(12,12) 
cell.prob=array(0,dim=c(3,2))               # Cell probabilities sum up to one 
cell.prob[1:2,1]=0.2
cell.prob[1,2]=0.1
cell.prob[2,2]=0.1
cell.prob[3,1]=0.1
cell.prob[3,2]=0.3  

y2=rTableICC.RxC(p=cell.prob,theta=ICCs,col.margins=col,M=num.cluster,
                  sampling=sampl,print.regular=TRUE,print.raw=FALSE)
print(y2)

# --- Generate a 4x3 contingency table under Poisson sampling plan ---
sampl="Poisson"                             # Generate table under product 
                                            #  multinomial sampling plan
cell.prob=array(1/12,dim=c(4,3))            # Cell probabilities sum up to one 
cell.mean=array(4,dim=c(4,3))               # Define mean number of individuals 
                                            #  in each cell
max.cluster.size=19                         # Maximum allowed cluster size
ICCs=array(0.1,dim=max.cluster.size)        # Assign equal ICCs for this exmaple
ICCs[1]=0  

z=rTableICC.RxC(p=cell.prob,lambda=cell.mean,theta=ICCs,row.margins=row,
                 M=num.cluster,sampling=sampl,print.regular=TRUE,print.raw=FALSE)
print(z)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
