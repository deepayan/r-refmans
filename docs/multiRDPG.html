<!DOCTYPE html><html><head><title>Help for package multiRDPG</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {multiRDPG}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#aplusfun'><p>Calculates positive semi-definite part of a matrix</p></a></li>
<li><a href='#calculateLRstat'><p><code>calculateLRstat</code> calculates the likelihood ratio statistic</p></a></li>
<li><a href='#calculateobjfun'><p><code>calculateobjfun</code> calculates the objective function</p></a></li>
<li><a href='#multiRDPG'><p>Fitting Multiple Random Dot Product Graphs</p></a></li>
<li><a href='#multiRDPG_test'><p>Performs test based on Multiple Random Dot Product Graph</p></a></li>
<li><a href='#nullestimation'><p><code>nullestimation</code> calculates the estimation under the null hypothesis</p></a></li>
<li><a href='#plot.multiRDPGfit'><p>Plots object from <code>multiRDPG</code></p></a></li>
<li><a href='#plot.multiRDPGtest'><p>Plots object from <code>multiRDPG_test</code></p></a></li>
<li><a href='#print.multiRDPGfit'><p>Print object from <code>multiRDPG</code></p></a></li>
<li><a href='#print.multiRDPGtest'><p>Print object from <code>multiRDPG_test</code></p></a></li>
<li><a href='#swapA'><p><code>swapA</code> swaps the elements of A at random</p></a></li>
<li><a href='#updateL'><p><code>updateL</code> updates all Lambda</p></a></li>
<li><a href='#updateU'><p><code>updateU</code> calculates the U update</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>1.0.1</td>
</tr>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Multiple Random Dot Product Graphs</td>
</tr>
<tr>
<td>Description:</td>
<td>Fits the Multiple Random Dot Product Graph Model and performs a test
	 for whether two networks come from the same distribution. Both methods are 
	 proposed in Nielsen, A.M., Witten, D., (2018) "The Multiple Random Dot Product Graph
	 Model", arXiv preprint &lt;<a href="https://arxiv.org/abs/1811.12172">arXiv:1811.12172</a>&gt; (Submitted to Journal of Computational
	 and Graphical Statistics).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.0.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-11-30 16:37:58 UTC; agni</td>
</tr>
<tr>
<td>Author:</td>
<td>Agnes Martine Nielsen [aut, cre],
  Daniela Witten [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Agnes Martine Nielsen &lt;agni@dtu.dk&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-12-09 13:40:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='aplusfun'>Calculates positive semi-definite part of a matrix</h2><span id='topic+aplusfun'></span>

<h3>Description</h3>

<p><code>aplusfun</code> calculates the positive semidefinite part of a matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aplusfun(Amat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aplusfun_+3A_amat">Amat</code></td>
<td>
<p>A symmetric matrix</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns positive semidefinite part of Amat
</p>


<h3>Author(s)</h3>

<p>Agnes Martine Nielsen (agni@dtu.dk)
</p>

<hr>
<h2 id='calculateLRstat'><code>calculateLRstat</code> calculates the likelihood ratio statistic</h2><span id='topic+calculateLRstat'></span>

<h3>Description</h3>

<p><code>calculateLRstat</code> calculates the likelihood ratio statistic
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculateLRstat(A, null, alt)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calculateLRstat_+3A_a">A</code></td>
<td>
<p>List of symmetric A matrices</p>
</td></tr>
<tr><td><code id="calculateLRstat_+3A_null">null</code></td>
<td>
<p>Model fitted under the null</p>
</td></tr>
<tr><td><code id="calculateLRstat_+3A_alt">alt</code></td>
<td>
<p>Model fitted under the alternative</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Value of the likelihood ratio statistic
</p>


<h3>Author(s)</h3>

<p>Agnes Martine Nielsen (agni@dtu.dk)
</p>

<hr>
<h2 id='calculateobjfun'><code>calculateobjfun</code> calculates the objective function</h2><span id='topic+calculateobjfun'></span>

<h3>Description</h3>

<p><code>calculateobjfun</code> calculates the objective function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculateobjfun(Aplus, Lambda, U)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calculateobjfun_+3A_aplus">Aplus</code></td>
<td>
<p>List of positive semi definite part of A matrices</p>
</td></tr>
<tr><td><code id="calculateobjfun_+3A_lambda">Lambda</code></td>
<td>
<p>List of Lambdas</p>
</td></tr>
<tr><td><code id="calculateobjfun_+3A_u">U</code></td>
<td>
<p>U matrix that contains the othogonal vectors</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the value of the objective function, sum(||Aplus-U Lambda U^T||_F^2)
</p>


<h3>Author(s)</h3>

<p>Agnes Martine Nielsen (agni@dtu.dk)
</p>

<hr>
<h2 id='multiRDPG'>Fitting Multiple Random Dot Product Graphs</h2><span id='topic+multiRDPG'></span>

<h3>Description</h3>

<p><code>multiRDPG</code> is used to fit Multiple Random Dot Product Graphs from a set of adjacency matrices.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multiRDPG(A, d, maxiter = 100, tol = 1e-06)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="multiRDPG_+3A_a">A</code></td>
<td>
<p>List of adjacency matrices representing graphs. Each matrix must be symmetric. All matrices of the same size n x n.</p>
</td></tr>
<tr><td><code id="multiRDPG_+3A_d">d</code></td>
<td>
<p>Dimension of latent space. d&lt;= n.</p>
</td></tr>
<tr><td><code id="multiRDPG_+3A_maxiter">maxiter</code></td>
<td>
<p>Maximal number of iterations. Default is 100.</p>
</td></tr>
<tr><td><code id="multiRDPG_+3A_tol">tol</code></td>
<td>
<p>Tolerance for update of the objective function. Default is 1e-6.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list of the following:<br />
</p>

<table>
<tr>
 <td style="text-align: left;">
            <code>U</code>         </td><td style="text-align: left;"> Matrix of the joint vectors. n x d. </td>
</tr>
<tr>
 <td style="text-align: left;">
            <code>Lambda</code>    </td><td style="text-align: left;"> List of diagonal matrices. One for each graph. d x d.</td>
</tr>
<tr>
 <td style="text-align: left;">
            <code>Converged</code> </td><td style="text-align: left;"> Represent of the algorithm converged. 1 if converged, 0 if not.</td>
</tr>
<tr>
 <td style="text-align: left;">
            <code>iter</code>      </td><td style="text-align: left;"> Number of iterations </td>
</tr>
<tr>
 <td style="text-align: left;">
            <code>maxiter</code>   </td><td style="text-align: left;"> Maximal number of iterations.Default is 100.</td>
</tr>
<tr>
 <td style="text-align: left;">
            <code>objfun</code>    </td><td style="text-align: left;"> Value of the objective function. sum_k ||A^k - U Lambda U^T||_F^2
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Agnes Martine Nielsen (agni@dtu.dk)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+multiRDPG_test">multiRDPG_test</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#simulate data
U &lt;- matrix(0, nrow=20, ncol=3)
U[,1] &lt;- 1/sqrt(20)
U[,2] &lt;- rep(c(1,-1), 10)/sqrt(20)
U[,3] &lt;- rep(c(1,1,-1,-1), 5)/sqrt(20)

L&lt;-list(diag(c(11,6,2)),diag(c(15,4,1)))
A &lt;- list()
for(i in 1:2){
  P &lt;- U%*%L[[i]]%*%t(U)
  A[[i]] &lt;-apply(P,c(1,2),function(x){rbinom(1,1,x)})
  A[[i]][lower.tri(A[[i]])]&lt;-t(A[[i]])[lower.tri(A[[i]])]
}

#fit model
multiRDPG(A,3)


</code></pre>

<hr>
<h2 id='multiRDPG_test'>Performs test based on Multiple Random Dot Product Graph</h2><span id='topic+multiRDPG_test'></span>

<h3>Description</h3>

<p><code>multiRDPG_test</code> calculates the likelihood ratio test for whether a set of graphs
comes from the same disribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multiRDPG_test(A, d, maxiter = 100, tol = 1e-06, B = 1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="multiRDPG_test_+3A_a">A</code></td>
<td>
<p>List of symmetric A matrices</p>
</td></tr>
<tr><td><code id="multiRDPG_test_+3A_d">d</code></td>
<td>
<p>Dimension of the latent space</p>
</td></tr>
<tr><td><code id="multiRDPG_test_+3A_maxiter">maxiter</code></td>
<td>
<p>Maximum number of iterations in the fit of multiRDPG. Default is 100.</p>
</td></tr>
<tr><td><code id="multiRDPG_test_+3A_tol">tol</code></td>
<td>
<p>Tolerance for the step in the objective function in multiRDPG. Default is 1e-6.</p>
</td></tr>
<tr><td><code id="multiRDPG_test_+3A_b">B</code></td>
<td>
<p>Number of permutation iterations. Default is 1000.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list of the following elements:
</p>

<table>
<tr>
 <td style="text-align: left;">
           <code>pvalue</code>     </td><td style="text-align: left;"> Estimated p-values </td>
</tr>
<tr>
 <td style="text-align: left;">
           <code>Tval</code>       </td><td style="text-align: left;"> Value of the test statistic </td>
</tr>
<tr>
 <td style="text-align: left;">
           <code>Tstar</code>      </td><td style="text-align: left;"> Vector of the test statistic for each permutation iteration </td>
</tr>
<tr>
 <td style="text-align: left;">
           <code>nullmodel</code>  </td><td style="text-align: left;"> Model fit under the null </td>
</tr>
<tr>
 <td style="text-align: left;">
           <code>altmodel</code>   </td><td style="text-align: left;"> Modelfit under the alternative
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Agnes Martine Nielsen (agni@dtu.dk)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+multiRDPG">multiRDPG</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#simulate data
U &lt;- matrix(0, nrow=20, ncol=3)
U[,1] &lt;- 1/sqrt(20)
U[,2] &lt;- rep(c(1,-1), 10)/sqrt(20)
U[,3] &lt;- rep(c(1,1,-1,-1), 5)/sqrt(20)

L&lt;-list(diag(c(11,6,2)),diag(c(15,4,1)))
A &lt;- list()
for(i in 1:2){
  P &lt;- U%*%L[[i]]%*%t(U)
  A[[i]] &lt;-apply(P,c(1,2),function(x){rbinom(1,1,x)})
  A[[i]][lower.tri(A[[i]])]&lt;-t(A[[i]])[lower.tri(A[[i]])]
}

#perform test
multiRDPG_test(A,3,B=100)


</code></pre>

<hr>
<h2 id='nullestimation'><code>nullestimation</code> calculates the estimation under the null hypothesis</h2><span id='topic+nullestimation'></span>

<h3>Description</h3>

<p><code>nullestimation</code> calculates the estimation under the null hypothesis
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nullestimation(A, d)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nullestimation_+3A_a">A</code></td>
<td>
<p>List of symmetric A matrices</p>
</td></tr>
<tr><td><code id="nullestimation_+3A_d">d</code></td>
<td>
<p>Dimension of the latent space</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list of the following<br />
</p>

<table>
<tr>
 <td style="text-align: left;">
          <code>U</code>        </td><td style="text-align: left;"> The common latent space vectors. U in R^n x d</td>
</tr>
<tr>
 <td style="text-align: left;">
          <code>Lambda</code>   </td><td style="text-align: left;"> List of Lambdas. Each is a positive diagonal matrix of size d x d.
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Agnes Martine Nielsen (agni@dtu.dk)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+multiRDPG">multiRDPG</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#simulate data
U &lt;- matrix(0, nrow=20, ncol=3)
U[,1] &lt;- 1/sqrt(20)
U[,2] &lt;- rep(c(1,-1), 10)/sqrt(20)
U[,3] &lt;- rep(c(1,1,-1,-1), 5)/sqrt(20)

L&lt;-list(diag(c(11,6,2)),diag(c(15,4,1)))
A &lt;- list()
for(i in 1:2){
  P &lt;- U%*%L[[i]]%*%t(U)
  A[[i]] &lt;-apply(P,c(1,2),function(x){rbinom(1,1,x)})
  A[[i]][lower.tri(A[[i]])]&lt;-t(A[[i]])[lower.tri(A[[i]])]
}

#fit model
nullestimation(A,3)


</code></pre>

<hr>
<h2 id='plot.multiRDPGfit'>Plots object from <code>multiRDPG</code></h2><span id='topic+plot.multiRDPGfit'></span>

<h3>Description</h3>

<p>Plots object from <code>multiRDPG</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'multiRDPGfit'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.multiRDPGfit_+3A_x">x</code></td>
<td>
<p>multiRDPGfit object from function <code>multiRDPG</code></p>
</td></tr>
<tr><td><code id="plot.multiRDPGfit_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Agnes Martine Nielsen (agni@dtu.dk)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+multiRDPG">multiRDPG</a></code>
</p>

<hr>
<h2 id='plot.multiRDPGtest'>Plots object from <code>multiRDPG_test</code></h2><span id='topic+plot.multiRDPGtest'></span>

<h3>Description</h3>

<p>Plots histogram of permutation test statistics and indicates test statistic value with red line.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'multiRDPGtest'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.multiRDPGtest_+3A_x">x</code></td>
<td>
<p>multiRDPGtest object from function <code>multiRDPG_test</code></p>
</td></tr>
<tr><td><code id="plot.multiRDPGtest_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Red line indicates the value of the test statistics with a red line.
</p>


<h3>Author(s)</h3>

<p>Agnes Martine Nielsen (agni@dtu.dk)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+multiRDPG_test">multiRDPG_test</a></code>
</p>

<hr>
<h2 id='print.multiRDPGfit'>Print object from <code>multiRDPG</code></h2><span id='topic+print.multiRDPGfit'></span>

<h3>Description</h3>

<p>Print object from <code>multiRDPG</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'multiRDPGfit'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.multiRDPGfit_+3A_x">x</code></td>
<td>
<p>multiRDPGfit object from function <code>multiRDPG</code></p>
</td></tr>
<tr><td><code id="print.multiRDPGfit_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Agnes Martine Nielsen (agni@dtu.dk)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+multiRDPG">multiRDPG</a></code>
</p>

<hr>
<h2 id='print.multiRDPGtest'>Print object from <code>multiRDPG_test</code></h2><span id='topic+print.multiRDPGtest'></span>

<h3>Description</h3>

<p>Print object from <code>multiRDPG_test</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'multiRDPGtest'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.multiRDPGtest_+3A_x">x</code></td>
<td>
<p>multiRDPGtest object from function <code>multiRDPG_test</code></p>
</td></tr>
<tr><td><code id="print.multiRDPGtest_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Agnes Martine Nielsen (agni@dtu.dk)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+multiRDPG_test">multiRDPG_test</a></code>
</p>

<hr>
<h2 id='swapA'><code>swapA</code> swaps the elements of A at random</h2><span id='topic+swapA'></span>

<h3>Description</h3>

<p><code>swapA</code> swaps the elements of A at random
</p>


<h3>Usage</h3>

<pre><code class='language-R'>swapA(A)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="swapA_+3A_a">A</code></td>
<td>
<p>List of symmetric A matrices</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns list of matrices with elements swapped
</p>


<h3>Author(s)</h3>

<p>Agnes Martine Nielsen (agni@dtu.dk)
</p>

<hr>
<h2 id='updateL'><code>updateL</code> updates all Lambda</h2><span id='topic+updateL'></span>

<h3>Description</h3>

<p><code>updateL</code> updates all Lambda
</p>


<h3>Usage</h3>

<pre><code class='language-R'>updateL(Aplus, U, d)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="updateL_+3A_aplus">Aplus</code></td>
<td>
<p>List of positive definite parts of A</p>
</td></tr>
<tr><td><code id="updateL_+3A_u">U</code></td>
<td>
<p>Current U matrix</p>
</td></tr>
<tr><td><code id="updateL_+3A_d">d</code></td>
<td>
<p>Dimension of latent space</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns list of updated Lambdas
</p>


<h3>Author(s)</h3>

<p>Agnes Martine Nielsen (agni@dtu.dk)
</p>

<hr>
<h2 id='updateU'><code>updateU</code> calculates the U update</h2><span id='topic+updateU'></span>

<h3>Description</h3>

<p><code>updateU</code> calculates the U update
</p>


<h3>Usage</h3>

<pre><code class='language-R'>updateU(AA, Lambda, Uold)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="updateU_+3A_aa">AA</code></td>
<td>
<p>All Aplus matrices column binded</p>
</td></tr>
<tr><td><code id="updateU_+3A_lambda">Lambda</code></td>
<td>
<p>List of Lambdas</p>
</td></tr>
<tr><td><code id="updateU_+3A_uold">Uold</code></td>
<td>
<p>U found in past iteration</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns updated U
</p>


<h3>Author(s)</h3>

<p>Agnes Martine Nielsen (agni@dtu.dk)
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
