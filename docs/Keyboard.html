<!DOCTYPE html><html><head><title>Help for package Keyboard</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {Keyboard}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#decision.finding'><p>Return Dose Escalation or De-escalation Decision Given Number of Toxicity and Responses</p></a></li>
<li><a href='#example.kb'><p>Illustration of the Keyboard Design (Single-agent)</p></a></li>
<li><a href='#get.boundary.comb.kb'><p>Dose Escalation or De-escalation Boundaries for Drug-combination Trials</p></a></li>
<li><a href='#get.boundary.kb'><p>Dose Escalation or De-escalation Boundaries for Single-agent Trials</p></a></li>
<li><a href='#get.decision.obd.kb'><p>Boundary Table and Decision Matrix for Phase I/II Trials.</p></a></li>
<li><a href='#get.decision.obd2.kb'><p>Automatic Boundary and Decision Tables for Phase I/II Trials.</p></a></li>
<li><a href='#get.oc.comb.kb'><p>Operating Characteristics for Drug-combination Trials</p></a></li>
<li><a href='#get.oc.kb'><p>Operating Characteristics for Single-agent Trials</p></a></li>
<li><a href='#get.oc.obd.kb'><p>Generate Operating Characteristics to Find the Optimal Biological Dose</p></a></li>
<li><a href='#get.oc.obd2.kb'><p>Generate Operating Characteristics for OBD Finding Automaticallly</p></a></li>
<li><a href='#next.comb.kb'><p>Find the Next Dose Combination</p></a></li>
<li><a href='#plot_kb'><p>Plot Objects Generated by the Keyboard Design Package</p></a></li>
<li><a href='#select.mtd.comb.kb'><p>Maximum Tolerated Dose (MTD) Selection for Drug-combination Trials</p></a></li>
<li><a href='#select.mtd.kb'><p>Maximum Tolerated Dose (MTD) Selection for Single-agent Trials</p></a></li>
<li><a href='#select.obd.kb'><p>Select the Optimal Biological Dose (OBD) for Single-agent Phase I/II Trials</p></a></li>
<li><a href='#summary_kb'><p>Summarize Objects Generated by the Keyboard Design Package</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Bayesian Designs for Early Phase Clinical Trials</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.3</td>
</tr>
<tr>
<td>Author:</td>
<td>Xiaomeng Yuan, Chen Li, Hongying Sun, Li Tang and Haitao Pan</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Xiaomeng Yuan &lt;xiaomeng.yuan@stjude.org&gt;</td>
</tr>
<tr>
<td>Imports:</td>
<td>Iso, ggplot2</td>
</tr>
<tr>
<td>Description:</td>
<td>We developed a package 'Keyboard' for designing single-agent, drug-combination, or phase I/II dose-finding clinical trials. The 'Keyboard' designs are novel early phase trial designs that can be implemented simply and transparently, similar to the 3+3 design, but yield excellent performance, comparable to those of more-complicated, model-based designs (Yan F, Mandrekar SJ, Yuan Y (2017) &lt;<a href="https://doi.org/10.1158%2F1078-0432.CCR-17-0220">doi:10.1158/1078-0432.CCR-17-0220</a>&gt;, Li DH, Whitmore JB, Guo W, Ji Y. (2017) &lt;<a href="https://doi.org/10.1158%2F1078-0432.CCR-16-1125">doi:10.1158/1078-0432.CCR-16-1125</a>&gt;,  Liu S, Johnson VE (2016) &lt;<a href="https://doi.org/10.1093%2Fbiostatistics%2Fkxv040">doi:10.1093/biostatistics/kxv040</a>&gt;, Zhou Y, Lee JJ, Yuan Y (2019) &lt;<a href="https://doi.org/10.1002%2Fsim.8475">doi:10.1002/sim.8475</a>&gt;, Pan H, Lin R, Yuan Y (2020) &lt;<a href="https://doi.org/10.1016%2Fj.cct.2020.105972">doi:10.1016/j.cct.2020.105972</a>&gt;). The 'Keyboard' package provides tools for designing, conducting, and analyzing single-agent, drug-combination, and phase I/II dose-finding clinical trials. For more details about how to use this packge, please refer to Li C, Sun H, Cheng C, Tang L, and Pan H. (2022) "A software tool for both the maximum tolerated dose and the optimal biological dose finding trials in early phase designs". Manuscript submitted for publication.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.4.0), Rcpp (&ge; 0.12.0), methods</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-08-10 20:42:37 UTC; xyuan86</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-08-11 10:10:17 UTC</td>
</tr>
</table>
<hr>
<h2 id='decision.finding'>Return Dose Escalation or De-escalation Decision Given Number of Toxicity and Responses</h2><span id='topic+decision.finding'></span>

<h3>Description</h3>

<p>This function returns the decision given the decision table, the total number of patients, the number of patients who experienced toxicity and the number of responses.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>decision.finding(out.matrix, n, t, r)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="decision.finding_+3A_out.matrix">out.matrix</code></td>
<td>
<p>A decision matrix.</p>
</td></tr>
<tr><td><code id="decision.finding_+3A_n">n</code></td>
<td>
<p>The number of enrolled subjects.</p>
</td></tr>
<tr><td><code id="decision.finding_+3A_t">t</code></td>
<td>
<p>The number of subjects experienced dose limiting toxicities (DLT).</p>
</td></tr>
<tr><td><code id="decision.finding_+3A_r">r</code></td>
<td>
<p>The number of responses.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>decision.finding()</code> is a helper function to <code>get.decision.obd.kb()</code>  and <code>get.decision.obd2.kb()</code>. <code>decision.finding()</code> returns the decision given the decision table, the total number of patients, the number of patients who experienced toxicity and the number of responses. If the number of subjects enrolled is n, then the number of possible combination for subjects who experienced toxicity and efficacy is (n+1) x (n+1).  For n = 30, the number of entries is 961. Finding the decision given a scenario is tedious.  <code>decision.finding()</code> resolves this challenge by helping users to obtain the decision easily with the input of the decision table (output from <code>get.decision.obd.kb()</code>  and <code>get.decision.obd2.kb()</code>), the total number of patients, the number of patients who experienced toxicity and the number of responses.
</p>


<h3>Value</h3>

<p>The function <code>decision.finding()</code> returns the decision.
</p>


<h3>Author(s)</h3>

<p>Xiaomeng Yuan, Chen Li, Hongying Sun, Li Tang and Haitao Pan
</p>


<h3>Examples</h3>

<pre><code class='language-R'> output.matrix &lt;- get.decision.obd.kb( toxicity.low = 0.15,
                 toxicity.moderate= 0.25,
                 toxicity.high = 0.35,
                 efficacy.low = 0.25,
                 efficacy.moderate = 0.45,
                 efficacy.high = 0.65,
                 target.toxicity=0.20,
                 target.efficacy=0.40,
                 cohortsize=3, ncohort=10)$decision.matrix
decision &lt;- decision.finding (out.matrix=output.matrix, n=6, t=1, r=3)
decision
</code></pre>

<hr>
<h2 id='example.kb'>Illustration of the Keyboard Design (Single-agent)</h2><span id='topic+example.kb'></span>

<h3>Description</h3>

<p>This function serves solely as an example to illustrate how the
Keyboard design determines dosing decisions when conducting a single-agent
trial.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>example.kb(center, half_width, s1, s2, a, b)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="example.kb_+3A_center">center</code></td>
<td>
<p>The center of the target key (between 0 and 1).</p>
</td></tr>
<tr><td><code id="example.kb_+3A_half_width">half_width</code></td>
<td>
<p>The width, or tolerable deviation, to each side of the
center (half of the target key's width).</p>
</td></tr>
<tr><td><code id="example.kb_+3A_s1">s1</code></td>
<td>
<p>The lower boundary of the strongest key.</p>
</td></tr>
<tr><td><code id="example.kb_+3A_s2">s2</code></td>
<td>
<p>The upper boundary of the strongest key.</p>
</td></tr>
<tr><td><code id="example.kb_+3A_a">a</code></td>
<td>
<p>The alpha parameter of the beta distribution.</p>
</td></tr>
<tr><td><code id="example.kb_+3A_b">b</code></td>
<td>
<p>The beta parameter of the beta distribution.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It is straightforward to visualize how the Keyboard design determines whether to
stay at the current dose, escalate, or de-escalate. The &quot;target key&quot; (shown in blue) is
the proper dosing interval determined for the trial by the investigators.
The &quot;strongest key&quot; (in red) is the interval with the highest posterior
probability (given the dosage data observed thus far) of the current dose's
true DLT rate. If the strongest key is to the left of the
target key, then we escalate the dose; if the strongest key is to the
right  of the target key, then we de-escalate the dose; and if the strongest
key is the target key, then we retain the current dose. Thus, posterior
probabilities are what directs dosage. Graphically, the strongest key is the
one with the largest area under the posterior distribution curve of the DLT
rate of the current dose.
</p>


<h3>Value</h3>

<p>A dose decision plot with the posterior distribution of the DLT rate
of the current dose and the positions of the target and the strongest keys.
</p>


<h3>Author(s)</h3>

<p>Xiaomeng Yuan, Chen Li, Hongying Sun, Li Tang and Haitao Pan
</p>


<h3>References</h3>

<p>Yan F, Mandrekar SJ, Yuan Y. Keyboard: A Novel Bayesian Toxicity Probability
Interval Design for Phase I Clinical Trials.
<em>Clinical Cancer Research</em>. 2017; 23:3994-4003.
http://clincancerres.aacrjournals.org/content/23/15/3994.full-text.pdf
</p>
<p>Pan H, Lin R, Yuan Y. Keyboard design for phase I drug-combination trials.
<em>Contemporary Clinical Trials</em>. 2020.
https://doi.org/10.1016/j.cct.2020.105972
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Clear all plots before switching between graphical parameters
opar &lt;- par(no.readonly = TRUE)
on.exit(par(opar))
par(mfrow = c(3, 1)) # for many plots in the same screen
par(mar = c(5, 5, 2, 2)) # for only one plot per page

example.kb(center = 0.19, half_width = 0.03, s1 = 0.4, s2 = 0.46, a = 3, b = 4) # de-escalation
example.kb(center = 0.19, half_width = 0.03, s1 = 0.04, s2 = 0.1, a = 2, b = 12) # escalation
example.kb(center = 0.19, half_width = 0.03, s1 = 0.16, s2 = 0.22, a = 2, b = 5) # stay
</code></pre>

<hr>
<h2 id='get.boundary.comb.kb'>Dose Escalation or De-escalation Boundaries for Drug-combination Trials</h2><span id='topic+get.boundary.comb.kb'></span>

<h3>Description</h3>

<p>This function generates the optimal dose escalation or de-escalation boundaries when
conducting a drug-combination trial with the Keyboard design.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.boundary.comb.kb(
  target,
  ncohort,
  cohortsize,
  n.earlystop = 100,
  marginL = 0.05,
  marginR = 0.05,
  cutoff.eli = 0.95,
  offset = 0.05,
  extrasafe = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get.boundary.comb.kb_+3A_target">target</code></td>
<td>
<p>The target dose-limiting toxicity (DLT) rate.</p>
</td></tr>
<tr><td><code id="get.boundary.comb.kb_+3A_ncohort">ncohort</code></td>
<td>
<p>A scalar specifying the total number of cohorts in the trial.</p>
</td></tr>
<tr><td><code id="get.boundary.comb.kb_+3A_cohortsize">cohortsize</code></td>
<td>
<p>The number of patients in the cohort.</p>
</td></tr>
<tr><td><code id="get.boundary.comb.kb_+3A_n.earlystop">n.earlystop</code></td>
<td>
<p>The early stopping parameter. If the number of patients treated at
the current dose reaches <code>n.earlystop</code>, then stop the trial
and select the MTD based on the observed data. The default
value is 100.</p>
</td></tr>
<tr><td><code id="get.boundary.comb.kb_+3A_marginl">marginL</code></td>
<td>
<p>The difference between the target and the lower bound of the
&quot;target key&quot; (proper dosing interval) to be defined.<br />
The default is 0.05.</p>
</td></tr>
<tr><td><code id="get.boundary.comb.kb_+3A_marginr">marginR</code></td>
<td>
<p>The difference between the target and the upper bound of the
&quot;target key&quot; (proper dosing interval) to be defined.<br />
The default is 0.05.</p>
</td></tr>
<tr><td><code id="get.boundary.comb.kb_+3A_cutoff.eli">cutoff.eli</code></td>
<td>
<p>The cutoff to eliminate an overly toxic dose and all
higher doses for safety.<br />
The recommended value is 0.95.</p>
</td></tr>
<tr><td><code id="get.boundary.comb.kb_+3A_offset">offset</code></td>
<td>
<p>A small positive number (between 0 and 0.5) to control how strict
the stopping rule is when <code>extrasafe=TRUE</code>. A larger value leads
to a stricter stopping rule. The default value is 0.05.</p>
</td></tr>
<tr><td><code id="get.boundary.comb.kb_+3A_extrasafe">extrasafe</code></td>
<td>
<p>Set <code>extrasafe=TRUE</code> to impose a stricter stopping rule for extra safety, expressed as the stopping boundary value in the result.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Keyboard design relies on the posterior distribution of the toxicity
probability to guide dosage. To determine whether to escalate or de-escalate the dose, given the observed data at the current dose, we first identify an
interval that has the highest posterior probability, referred to as
the &quot;strongest key&quot;. This key represents where the true dose-limiting
toxicity (DLT) rate of the current dose is most likely located. If the
strongest key is to the left of the &quot;target key&quot;, then we escalate
the dose because the data suggest that the current
dose is likely to underdose patients; if the strongest key is
to the right of the target key, then we de-escalate the dose
because the observed data suggest that the current dose is likely to overdose the patients; and
if the strongest key is the target key, then we retain the current dose because
the observed data support that the current dose is most likely to be in the
proper dosing interval.
Graphically, the strongest key is the one with the largest area under the
posterior distribution curve of the DLT rate of the current dose.
</p>
<p><img src="../help/figures/Keyboard.jpg" alt="Keyboard.jpg" />
</p>
<p>An attractive feature of the Keyboard design is that its dose escalation and
de-escalation rules can be tabulated before the onset of the trial. Thus,
when conducting the trial, no calculation or model fitting is needed, and we
need to count only the number of DLTs observed at the current dose;
the decision to escalate or de-escalate the dose is based on the pre-tabulated
decision rules.
</p>
<p>Given all observed data, we use matrix isotonic regression to obtain an
estimate of the toxicity rate of the combination of dose level j of drug A
and dose level k of drug B and  to  select as the MTD  the combination with the
toxicity estimate that is closest to the target. When there are ties, we
randomly choose one as the MTD.
</p>
<p>For patient safety, we apply the following Bayesian overdose control rule
after each cohort:
if at least 3 patients have been treated at the given dose and
the observed data indicate that the probability of the current combination dose's toxicity rate being above the target toxicity rate is more
than 95%,  then we exclude this dose and beyond to avoid
exposing future patients to these overly toxic doses. The probability
threshold can be specified with <code>cutoff.eli</code>. If the lowest dose
combination (1, 1) is overly toxic, then the trial terminates early, and no dose
is selected as the MTD.
</p>


<h3>Value</h3>

<p>The function returns a matrix, including the dose escalation, de-escalation, and elimination boundaries.
</p>


<h3>Note</h3>

<p>In most clinical applications, the target DLT rate is often a rough
guess, but finding a dose level with a DLT rate reasonably close to the
target rate (which ideally would be the MTD) is what interests the
investigator.
</p>


<h3>References</h3>

<p>Yan F, Mandrekar SJ, Yuan Y. Keyboard: A Novel Bayesian Toxicity Probability
Interval Design for Phase I Clinical Trials.
<em>Clinical Cancer Research</em>. 2017; 23:3994-4003.
http://clincancerres.aacrjournals.org/content/23/15/3994.full-text.pdf
</p>
<p>Pan H, Lin R, Yuan Y. Keyboard design for phase I drug-combination trials.
<em>Contemporary Clinical Trials</em>. 2020.
https://doi.org/10.1016/j.cct.2020.105972
</p>


<h3>See Also</h3>

<p>Other drug-combination functions: 
<code><a href="#topic+get.oc.comb.kb">get.oc.comb.kb</a>()</code>,
<code><a href="#topic+next.comb.kb">next.comb.kb</a>()</code>,
<code><a href="#topic+select.mtd.comb.kb">select.mtd.comb.kb</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### Drug-combination trial ###

bound &lt;- get.boundary.comb.kb(target=0.3, ncohort=10, cohortsize=3)
print(bound)
</code></pre>

<hr>
<h2 id='get.boundary.kb'>Dose Escalation or De-escalation Boundaries for Single-agent Trials</h2><span id='topic+get.boundary.kb'></span>

<h3>Description</h3>

<p>This function generates the optimal dose escalation or de-escalation boundaries when
conducting a single-agent trial with the Keyboard design.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.boundary.kb(
  target,
  ncohort,
  cohortsize,
  marginL = 0.05,
  marginR = 0.05,
  cutoff.eli = 0.95,
  n.earlystop = 100,
  extrasafe = FALSE,
  offset = 0.05
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get.boundary.kb_+3A_target">target</code></td>
<td>
<p>The target dose-limiting toxicity (DLT) rate.</p>
</td></tr>
<tr><td><code id="get.boundary.kb_+3A_ncohort">ncohort</code></td>
<td>
<p>The total number of cohorts.</p>
</td></tr>
<tr><td><code id="get.boundary.kb_+3A_cohortsize">cohortsize</code></td>
<td>
<p>The number of patients in the cohort.</p>
</td></tr>
<tr><td><code id="get.boundary.kb_+3A_marginl">marginL</code></td>
<td>
<p>The difference between the target and the lower bound of the
&quot;target key&quot; (proper dosing interval) to be defined.<br />
The default is 0.05.</p>
</td></tr>
<tr><td><code id="get.boundary.kb_+3A_marginr">marginR</code></td>
<td>
<p>The difference between the target and the upper bound of the
&quot;target key&quot; (proper dosing interval) to be defined.<br />
The default is 0.05.</p>
</td></tr>
<tr><td><code id="get.boundary.kb_+3A_cutoff.eli">cutoff.eli</code></td>
<td>
<p>The cutoff value to eliminate an overly toxic dose and all
higher doses for safety.<br />
The recommended value is 0.95.</p>
</td></tr>
<tr><td><code id="get.boundary.kb_+3A_n.earlystop">n.earlystop</code></td>
<td>
<p>The early stopping parameter. If the number of patients treated at
the current dose reaches <code>n.earlystop</code>, then stop the trial
and select the MTD based on the observed data. The default
value is 100.</p>
</td></tr>
<tr><td><code id="get.boundary.kb_+3A_extrasafe">extrasafe</code></td>
<td>
<p>Set <code>extrasafe=TRUE</code> to impose a stricter stopping rule for extra safety, expressed as the stopping boundary value in the result.</p>
</td></tr>
<tr><td><code id="get.boundary.kb_+3A_offset">offset</code></td>
<td>
<p>A small positive number (between 0 and 0.5) to control how strict
the stopping rule is when <code>extrasafe=TRUE</code>. A larger value leads
to a stricter stopping rule. The default value is 0.05.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Keyboard design relies on the posterior distribution of the toxicity
probability to guide dosage. To make a decision of dose escalation or
de-escalation, given the observed data at the current dose, we first identify an
interval that has the highest posterior probability, referred to as
the &quot;strongest key&quot;. This key represents where the true dose-limiting
toxicity (DLT) rate of the current dose is most likely located. If the
strongest key is to the left  of the &quot;target key&quot;, then we escalate
the dose because the data suggest that the current
dose is most likely too low; if the strongest key is
to the right of the target key, then we de-escalate the dose
because the observed data suggest that the current dose is likely too high; and
if the strongest key is the target key, then we retain the current dose because
the observed data support the notion that the current dose is most likely to be in the
proper dosing interval.
Graphically, the strongest key is the one with the largest area under the
posterior distribution curve of the DLT rate of the current dose.
</p>
<p><img src="../help/figures/Keyboard.jpg" alt="Keyboard.jpg" />
</p>
<p>An attractive feature of the Keyboard design is that its dose escalation and
de-escalation rules can be tabulated before the onset of the trial. Thus,
when conducting the trial, no calculation or model fitting is needed, and we
need to count only the number of DLTs observed at the current dose;
the decision to escalate or de-escalate the dose is based on the pre-tabulated
decision rules.
</p>
<p>Given all observed data, the Keyboard design uses isotonic regression to obtain an efficient statistical estimate of
the maximum tolerated dose (MTD) by utilizing the fact that toxicity
presumably increases with the dose.
</p>
<p>For patient safety, we apply the following Bayesian overdose control rule
after each cohort:
if at least 3 patients have been treated at the given dose and
the observed data indicate that the probability of the current dose's toxicity rate being above the target toxicity rate is more
than 95%, then we stop the trial to avoid
exposing future patients to these overly toxic doses. The probability
threshold can be specified with <code>cutoff.eli</code>. When a dose is
eliminated, the design recommends the next lower dose for treating the next cohort of patients. If the lowest dose is overly toxic, then the trial terminates early and no dose is selected as the MTD.
</p>


<h3>Value</h3>

<p>The function returns a matrix, which includes the dose escalation,
de-escalation, and elimination boundaries.
</p>


<h3>Note</h3>

<p>In most clinical applications, the target DLT rate is often a rough
guess, but finding a dose level with a DLT rate reasonably close to the
target rate (which ideally would be the MTD) is of interest.
</p>


<h3>References</h3>

<p>Yan F, Mandrekar SJ, Yuan Y. Keyboard: A Novel Bayesian Toxicity Probability
Interval Design for Phase I Clinical Trials.
<em>Clinical Cancer Research</em>. 2017; 23:3994-4003.
http://clincancerres.aacrjournals.org/content/23/15/3994.full-text.pdf
</p>


<h3>See Also</h3>

<p>Other single-agent functions: 
<code><a href="#topic+get.oc.kb">get.oc.kb</a>()</code>,
<code><a href="#topic+select.mtd.kb">select.mtd.kb</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### Single-agent trial ###

bound &lt;- get.boundary.kb(target=0.3, ncohort=10, cohortsize=3)
print(bound)
</code></pre>

<hr>
<h2 id='get.decision.obd.kb'>Boundary Table and Decision Matrix for Phase I/II Trials.</h2><span id='topic+get.decision.obd.kb'></span>

<h3>Description</h3>

<p>This function generates a boundary table and decision matrix for single-agent phase I/II trials using Keyboard design.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.decision.obd.kb(
  toxicity.low,
  toxicity.moderate,
  toxicity.high,
  efficacy.low,
  efficacy.moderate,
  efficacy.high,
  target.toxicity,
  target.efficacy,
  cohortsize,
  ncohort,
  cutoff.eli.toxicity = 0.95,
  cutoff.eli.efficacy = 0.3
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get.decision.obd.kb_+3A_toxicity.low">toxicity.low</code></td>
<td>
<p>The upper boundary for the low toxicity interval.</p>
</td></tr>
<tr><td><code id="get.decision.obd.kb_+3A_toxicity.moderate">toxicity.moderate</code></td>
<td>
<p>The upper boundary for the moderate toxicity interval.</p>
</td></tr>
<tr><td><code id="get.decision.obd.kb_+3A_toxicity.high">toxicity.high</code></td>
<td>
<p>The upper boundary for the high toxicity interval.</p>
</td></tr>
<tr><td><code id="get.decision.obd.kb_+3A_efficacy.low">efficacy.low</code></td>
<td>
<p>The upper boundary for the low efficacy interval.</p>
</td></tr>
<tr><td><code id="get.decision.obd.kb_+3A_efficacy.moderate">efficacy.moderate</code></td>
<td>
<p>The upper boundary for the moderate efficacy interval.</p>
</td></tr>
<tr><td><code id="get.decision.obd.kb_+3A_efficacy.high">efficacy.high</code></td>
<td>
<p>The upper boundary for the high efficacy interval.</p>
</td></tr>
<tr><td><code id="get.decision.obd.kb_+3A_target.toxicity">target.toxicity</code></td>
<td>
<p>The target DLT rate.</p>
</td></tr>
<tr><td><code id="get.decision.obd.kb_+3A_target.efficacy">target.efficacy</code></td>
<td>
<p>The target efficacy rate.</p>
</td></tr>
<tr><td><code id="get.decision.obd.kb_+3A_cohortsize">cohortsize</code></td>
<td>
<p>The number of patients in the cohort.</p>
</td></tr>
<tr><td><code id="get.decision.obd.kb_+3A_ncohort">ncohort</code></td>
<td>
<p>The total number of cohorts.</p>
</td></tr>
<tr><td><code id="get.decision.obd.kb_+3A_cutoff.eli.toxicity">cutoff.eli.toxicity</code></td>
<td>
<p>The cutoff value to eliminate a dose with an unacceptably high toxicity for safety. The default value is 0.95.</p>
</td></tr>
<tr><td><code id="get.decision.obd.kb_+3A_cutoff.eli.efficacy">cutoff.eli.efficacy</code></td>
<td>
<p>The cutoff value to eliminate a dose with unacceptably low efficacy. The default value is 0.3.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Keyboard design relies on the posterior distribution of the toxicity and efficacy to guide dosage transition. To determine whether to escalate or de-escalate the dose
given the observed data at the current dose and a boundary table by investigators, we identify the
interval that has the highest joint unit probability mass, which we refer to as the winner key. The decision corresponding to the winner key is the decision for dose assignment.
</p>
<p>The prespecified boundary table is determined by the investigators.  The four subintervals for toxicity are  low, moderate, high, and unacceptable.  Generating these four intervals requires three investigators-provided boundaries, which can be specified as follows: <br />
</p>

<ol>
<li><p> The low interval for toxicity is (0, toxicity.low); toxicity.low is the upper boundary for the low toxicity interval, which can be specified by using the argument <code>toxicity.low</code>.
</p>
</li>
<li><p> The moderate interval for toxicity is (toxicity.low, toxicity.moderate); toxicity.low is the upper boundary for the low toxicity interval, which can be specified by using the argument <code>toxicity.low</code> and toxicity.moderate is the upper boundary for the moderate toxicity interval, which can be specified by using the argument <code>toxicity.moderate</code>.
</p>
</li>
<li><p> The high interval for toxicity is (toxicity.moderate, toxicity.high); toxicity.moderate is the upper boundary for the moderate toxicity interval, which can be specified by using the argument <code>toxicity.moderate</code> and toxicity.high is the upper boundary for the high toxicity interval, which can be specified by using the argument <code>toxicity.high</code>.
</p>
</li>
<li><p> The unacceptable interval for toxicity is (toxicity.high, 1); toxicity.high is the upper boundary for the high toxicity interval, which can be specified by using the argument <code>toxicity.high</code>.
</p>
</li></ol>

<p>Similarly, there are four subintervals for efficacy as follows:<br />
</p>

<ol>
<li><p> The low interval for efficacy is (0, efficacy.low); efficacy.low the upper boundary for the low efficacy interval, which can be specified by using the argument <code>efficacy.low</code>.
</p>
</li>
<li><p> The moderate interval for efficacy is (efficacy.low, efficacy.moderate); efficacy.low is the upper boundary for the low efficacy interval, which can be specified by using the argument <code>efficacy.low</code> and efficacy.moderate is the upper boundary for the moderate efficacy interval, which can be specified by using the argument <code>efficacy.moderate</code>.
</p>
</li>
<li><p> The high interval for efficacy is (efficacy.moderate, efficacy.high); efficacy.moderate is the upper boundary for the moderate efficacy interval, which can be specified by using the argument <code>efficacy.moderate</code> and efficacy.high is the upper boundary for the high efficacy interval, which can be specified by using the argument <code>efficacy.high</code>.
</p>
</li>
<li><p> The superb interval for efficacy is (efficacy.high, 1); efficacy.high is the upper boundary for the high efficacy interval, which can be specified by using the argument <code>efficacy.high</code>.
</p>
</li></ol>

<p>One could suppose that there are d doses in the trial and the current dose is i. Define the number of patients as <code class="reqn">n_i</code>, the number of patients who experienced toxicity as <code class="reqn">x_i</code> and the number of responses as <code class="reqn">y_i</code>.  The trial data can be represented as follows:
</p>
<p style="text-align: center;"><code class="reqn">D= (n_i, x_i, y_i), i = 1, ..., d</code>
</p>

<p>Assuming that the toxicity probability is <code class="reqn">p_i</code> and the efficacy probability is <code class="reqn">q_i</code> at dose level i, the probability unit intervals for toxicity and efficacy can be partitioned in to subintervals (a, b) and (c,d). (a, b)  is the subinterval for toxicity probability, and (c, d) is the subinterval for efficacy probability. (a, b) x (c,d) is one combination interval.  There are 16 combination intervals in total given the 4 subintervals for toxicity rate and the 4 subintervals for efficacy intervals.  Investigators would then be required to provide 16 decisions that correspond to these 16 combination intervals. Decision &quot;D&quot; denotes de-escalation, so the next cohort of patients will be treated at the next lower dose level.  Decision &quot;E&quot; denotes escalation, so the next cohort of patients will be treated at the next higher dose level.  Decision &quot;S&quot; denotes stay, so the next cohort of patients will be treated at the current dose level. The following is an example of a prespecified boundary table with a target toxicity rate of 0.2 and a target efficacy rate of 0.4:
</p>

<table>
<tr>
 <td style="text-align: right;">
       </td><td style="text-align: right;">   </td><td style="text-align: right;"> Efficacy.low </td><td style="text-align: right;"> Efficacy.moderate </td><td style="text-align: right;"> Efficacy.high </td><td style="text-align: right;"> Efficacy.superb </td>
</tr>
<tr>
 <td style="text-align: right;">
       </td><td style="text-align: right;">   </td><td style="text-align: right;">  (0,0.25) </td><td style="text-align: right;">  (0.25,0.45) </td><td style="text-align: right;"> (0.45,0.65) </td><td style="text-align: right;"> (0.65,1) </td>
</tr>
<tr>
 <td style="text-align: right;">
  Toxicity.low </td><td style="text-align: right;">  (0,0.15)</td><td style="text-align: right;">  E</td><td style="text-align: right;">  E</td><td style="text-align: right;">  E </td><td style="text-align: right;">  E</td>
</tr>
<tr>
 <td style="text-align: right;">
  Toxicity.moderate </td><td style="text-align: right;">  (0.15,0.25)</td><td style="text-align: right;">  E</td><td style="text-align: right;">  E</td><td style="text-align: right;">  E </td><td style="text-align: right;">  S</td>
</tr>
<tr>
 <td style="text-align: right;">
  Toxicity. high </td><td style="text-align: right;">  (0.25,0.35)</td><td style="text-align: right;">  D</td><td style="text-align: right;">  S</td><td style="text-align: right;">  S </td><td style="text-align: right;">  S</td>
</tr>
<tr>
 <td style="text-align: right;">
  Toxicity. unaccpetable </td><td style="text-align: right;">  (0.35,1.0)</td><td style="text-align: right;">  D</td><td style="text-align: right;">  D</td><td style="text-align: right;">  D </td><td style="text-align: right;"> D</td>
</tr>
<tr>
 <td style="text-align: right;">
</td>
</tr>

</table>

<p>For example, the combination interval (0.25,0.35) x (0,0.25) corresponds to decision &quot;D&quot;. Therefore the next cohort of patients will be treated at the next lower level if the observed toxicity rate of the current dose falls in (0.25,0.35)  and the observed efficacy rate falls in (0,0.25).
</p>
<p>Bayesian rule is used to calculate the joint unit probability mass (JUPM) for the toxicity and efficacy combination intervals. For a given combination interval, JUPM is calculated as follows:
</p>
<p style="text-align: center;"><code class="reqn">JUPM_{(a,b)}^{(c,d)} =Pr{p_j \in (a,b), q_j \in (c,d) | D} / (b-a)*(d-c) </code>
</p>

<p><code class="reqn">Pr{p_j \in (a,b), q_j \in (c,d) | D} </code> is the posterior probability of <code class="reqn">p_i</code> and <code class="reqn">q_i</code> falling in the subinterval (a,b) and (c,d).  Assume the priors for both <code class="reqn">p_i</code> and <code class="reqn">q_i</code> follow independent beta distributions <code class="reqn">beta(\alpha_p,\beta_p)</code> and <code class="reqn">beta(\alpha_q,\beta_q)</code> independently. The posterior distributions for <code class="reqn">p_i</code> and <code class="reqn">q_i</code> are <code class="reqn">beta(\alpha_p + x_i,\beta_p + n_i - x_i)</code> and <code class="reqn">beta(\alpha_q + y_i,\beta_q + n_i - y_i)</code>. Using these posterior distributions, calculate the JUPM for all 16 combination intervals and find the winning combination interval (a*,b*) and (c*,d*) with the largest JUPM. The decision that corresponds with this winning combination interval is used to treat the next cohort of patients.
</p>
<p>Two dose exclusion rules are applied in the trial design: safety rule and futility rule.
Safety rule:
if at least 3 patients have been treated at a given dose and  the observed data indicate that the probability of  the current dose's toxicity rate exceeding the target toxicity rate is more
than 95%, then we eliminate the current dose and any higher doses from the trial to avoid
exposing future patients to unacceptably toxic doses. The probability
threshold can be specified with <code>cutoff.eli.toxicity</code>. When a dose is
eliminated, the design recommends the next lower dose for treating the next cohort of
patients. If the lowest dose is unacceptably toxic, then the trial terminates early and
no dose is selected as the OBD. This corresponds to a dose assignment of &quot;DUT&quot;, which means to de-escalate due to unacceptable high toxicity and exclude the current dose and any dose higher than this dose from the trial.
</p>
<p>Futility rule:
if at least 3 patients have been treated at a given dose and
the observed data indicate that the probability of the current dose's efficacy rate exceeding the target efficacy rate is less than 30%,  then we eliminate this dose from the trial to avoid
exposing future patients to these futile doses. The probability
threshold can be specified with <code>cutoff.eli.efficacy</code>.  This corresponds to two possible dose assignments: &quot;EUE&quot; and &quot;DUE&quot;, which both exclude the current dose from the trial. &quot;EUE&quot; denotes escalation due to unacceptable low efficacy;  &quot;DUE&quot; denotes de-escalation due to unacceptable low efficacy.
</p>
<p>An attractive feature of the Keyboard design is that its dose escalation and
de-escalation rule can be tabulated before implementing the trial. Thus,
when conducting the trial, no real-time calculation or model fitting is needed, and we
need to count only the number of patients, the number of DLTs, and the number of responses observed at the current dose and
the decision to escalate or des-escalate the dose based on the pre-tabulated
decision rules.
</p>


<h3>Value</h3>

<p><code>get.decision.obd.kb()</code> returns a prespecified boundary table and a dose assignment decision matrix:
</p>

<ol>
<li><p> Prespecified boundary table (<code>$boundary.table</code>)
</p>
</li>
<li><p> Decision matrix (<code>$decision.matrix</code>)
</p>
</li></ol>



<h3>Note</h3>

<p>This method is adopted from Li et al (2017)
</p>


<h3>Author(s)</h3>

<p>Xiaomeng Yuan, Chen Li, Hongying Sun, Li Tang and Haitao Pan
</p>


<h3>References</h3>

<p>Li DH, Whitmore JB, Guo W, Ji Y. Toxicity and efficacy probability interval design for phase I adoptive cell therapy dose-finding clinical trials.
<em>Clinical Cancer Research</em>. 2017; 23:13-20.
https://clincancerres.aacrjournals.org/content/23/1/13.long
</p>


<h3>See Also</h3>

<p>Other single-agent phase I/II functions: 
<code><a href="#topic+get.decision.obd2.kb">get.decision.obd2.kb</a>()</code>,
<code><a href="#topic+get.oc.obd.kb">get.oc.obd.kb</a>()</code>,
<code><a href="#topic+get.oc.obd2.kb">get.oc.obd2.kb</a>()</code>,
<code><a href="#topic+select.obd.kb">select.obd.kb</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 toxicity.low &lt;- 0.15
 toxicity.moderate &lt;- 0.25
 toxicity.high &lt;- 0.35
 efficacy.low &lt;- 0.25
 efficacy.moderate &lt;- 0.45
 efficacy.high &lt;- 0.65
 target.toxicity &lt;- 0.20
 target.efficacy &lt;- 0.40
 cohortsize &lt;- 3
 ncohort &lt;- 10

 decision.obd &lt;- get.decision.obd.kb( toxicity.low = toxicity.low,
                 toxicity.moderate= toxicity.moderate,
                 toxicity.high = toxicity.high,
                 efficacy.low = efficacy.low,
                 efficacy.moderate = efficacy.moderate,
                 efficacy.high = efficacy.high,
                 target.toxicity=target.toxicity,
                 target.efficacy=target.efficacy,
                 cohortsize=cohortsize, ncohort=ncohort)
 print(decision.obd)


</code></pre>

<hr>
<h2 id='get.decision.obd2.kb'>Automatic Boundary and Decision Tables for Phase I/II Trials.</h2><span id='topic+get.decision.obd2.kb'></span>

<h3>Description</h3>

<p>This function automatically generates a boundary table and a decision table for single-agent Phase I/II trials using Keyboard design.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.decision.obd2.kb(
  target.toxicity,
  target.efficacy,
  cohortsize,
  ncohort,
  cutoff.eli.toxicity = 0.95,
  cutoff.eli.efficacy = 0.3,
  decision = c("E", "E", "S", "S", "S", "S", "D", "D", "D")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get.decision.obd2.kb_+3A_target.toxicity">target.toxicity</code></td>
<td>
<p>The target toxicity rate.</p>
</td></tr>
<tr><td><code id="get.decision.obd2.kb_+3A_target.efficacy">target.efficacy</code></td>
<td>
<p>The target efficacy rate.</p>
</td></tr>
<tr><td><code id="get.decision.obd2.kb_+3A_cohortsize">cohortsize</code></td>
<td>
<p>The number of patients in the cohort.</p>
</td></tr>
<tr><td><code id="get.decision.obd2.kb_+3A_ncohort">ncohort</code></td>
<td>
<p>The total number of cohorts.</p>
</td></tr>
<tr><td><code id="get.decision.obd2.kb_+3A_cutoff.eli.toxicity">cutoff.eli.toxicity</code></td>
<td>
<p>The cutoff value to eliminate a dose with unacceptable high toxicity for safety. The default value is 0.95.</p>
</td></tr>
<tr><td><code id="get.decision.obd2.kb_+3A_cutoff.eli.efficacy">cutoff.eli.efficacy</code></td>
<td>
<p>The cutoff value to eliminate a dose with unacceptable low efficacy. The default value is 0.3.</p>
</td></tr>
<tr><td><code id="get.decision.obd2.kb_+3A_decision">decision</code></td>
<td>
<p>The pre-specified decision matrix for the 9 combination intervals: (low toxicity, low efficacy),(low toxicity, moderate efficacy),(low toxicity, high efficacy), (moderate toxicity, low efficacy),(moderate toxicity, moderate efficacy),(moderate toxicity, high efficacy),(high toxicity, low efficacy),(high toxicity, moderate efficacy),(high toxicity, high efficacy)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Keyboard design utilizes the posterior distributions of the toxicity and efficacy to guide dosage transition. To determine whether to escalate or de-escalate given the observed data at the current dose, we must generate a boundary table and a decision matrix. The boundary table requires a lower boundary and an upper boundary for both toxicity and efficacy and a decision matrix, which provides dose escalation or de-escalation suggestions.
</p>
<p>A Bayesian toxicity probability interval design from Yuan's group is used to determine the lower and upper boundaries for toxicity  based on the target toxicity rate.
</p>
<p>The boundaries for efficacy are calculated based on the efficacy failure rate, which is <code class="reqn">1-target.efficacy</code>.  The efficacy failure rate is defined as 1 - target.efficacy and  treated similarly to toxicity. The lower and upper boundaries for efficacy failure are determined using a Bayesian toxicity probability interval design.  To compute the lower and upper boundaries for efficacy, we use the following:
</p>
<p style="text-align: center;"><code class="reqn">efficacy.lower.boundary = 1 - efficacy.failure.upper.boundary</code>
</p>

<p style="text-align: center;"><code class="reqn">efficacy.upper.boundary = 1 - efficacy.failure.lower.boundary</code>
</p>

<p>There are 3 subintervals for toxicity:
</p>

<ol>
<li><p> The low interval for toxicity is (0, toxicity.lower.boundary).
</p>
</li>
<li><p> The moderate interval for toxicity is (toxicity.lower.boundary, toxicity.upper.boundary).
</p>
</li>
<li><p> The high interval for toxicity is (toxicity.upper.boundary, 1).
</p>
</li></ol>

<p>There are 3 subintervals for efficacy:
</p>

<ol>
<li><p> The low interval for efficacy is (0, efficacy.lower.boundary).
</p>
</li>
<li><p> The moderate interval for efficacy is (efficacy.lower.boundary, efficacy.upper.boundary).
</p>
</li>
<li><p> The high interval for efficacy is (efficacy.upper.boundary, 1).
</p>
</li></ol>

<p>Assuming that the toxicity probability is <code class="reqn">p_i</code> and the efficacy probability is <code class="reqn">q_i</code> at dose level i, the probability unit intervals for toxicity and efficacy can be partitioned in to subintervals (a, b) and (c,d). (a, b)  is a subinterval for toxicity probability and (c, d) is a subinterval for efficacy probability. (a, b) x (c,d) is a combination interval. 3 toxicity intervals and 3 efficacy intervals result in 9 combination intervals. Besides the target toxicity rate and the target efficacy rate, a matrix is required that contains 9 decisions for these 9 combination intervals ordered as ((low toxicity, low efficacy),(low toxicity, moderate efficacy),(low toxicity, high efficacy), (moderate toxicity, low efficacy),(moderate toxicity, moderate efficacy),(moderate toxicity, high efficacy),(high toxicity, low efficacy),(high toxicity, moderate efficacy),(high toxicity, high efficacy)).  Possible decisions are &quot;E&quot;, &quot;D&quot;,&quot;S&quot;. Decision &quot;D&quot; denotes de-escalation, so the next cohort of patients will be treated at the next lower dose level.  Decision &quot;E&quot; denotes escalation, so the next cohort of patients will be treated at the next higher dose level.  Decision &quot;S&quot; denotes stay, so the next cohort of patients will be treated at the current dose level.
</p>
<p>Shown here is an example of boundary tables designed using this method with a target toxicity rate of 0.2 and a target efficacy rate of 0.4:
</p>

<table>
<tr>
 <td style="text-align: right;">
       </td><td style="text-align: right;">   </td><td style="text-align: right;"> Efficacy.low </td><td style="text-align: right;"> Efficacy.moderate </td><td style="text-align: right;"> Efficacy.high  </td>
</tr>
<tr>
 <td style="text-align: right;">
       </td><td style="text-align: right;">   </td><td style="text-align: right;">  (0,0.27) </td><td style="text-align: right;">  (0.27,0.52) </td><td style="text-align: right;"> (0.52,1) </td>
</tr>
<tr>
 <td style="text-align: right;">
  Toxicity.low </td><td style="text-align: right;">  (0,0.16)</td><td style="text-align: right;">  E</td><td style="text-align: right;">  E</td><td style="text-align: right;">  S </td>
</tr>
<tr>
 <td style="text-align: right;">
  Toxicity.moderate </td><td style="text-align: right;">  (0.16,0.24)</td><td style="text-align: right;">  S</td><td style="text-align: right;">  S </td><td style="text-align: right;"> S  </td>
</tr>
<tr>
 <td style="text-align: right;">
  Toxicity. high </td><td style="text-align: right;">  (0.24,1)</td><td style="text-align: right;">  D</td><td style="text-align: right;">  D</td><td style="text-align: right;">  D </td>
</tr>
<tr>
 <td style="text-align: right;">
</td>
</tr>

</table>

<p>For example, the interval combination (0, 0.16) x (0.27,0.52) corresponds to a decision &quot;S&quot;. This means that the next cohort of patients will be treated at the current dose level if the observed toxicity rate of current dose falls in (0, 0.16)  and the observed efficacy rate falls in (0.27,0.52) .
</p>
<p>Suppose that there are d doses in the trial and that the current dose is i. Define the number of patients as <code class="reqn">n_i</code>, the number of patients who experienced toxicity as <code class="reqn">x_i</code> and the number of responses as <code class="reqn">y_i</code>.  The trial data can be shown as follows:
</p>
<p style="text-align: center;"><code class="reqn">D= {(n_i, x_i, y_i), i = 1, ..., d}</code>
</p>

<p>Bayesian rule is used to calculate the joint unit probability mass (JUPM) for the toxicity and efficacy combination intervals. For a given combination interval, JUPM is calculated as follows:
</p>
<p style="text-align: center;"><code class="reqn">JUPM_{(a,b)}^{(c,d)} =Pr{p_j \in (a,b), q_j \in (c,d) | D} / (b-a)*(d-c) </code>
</p>

<p><code class="reqn">Pr{p_j \in (a,b), q_j \in (c,d) | D} </code> are the posterior probabilities of <code class="reqn">p_i</code> and <code class="reqn">q_i</code> falling in the subinterval (a,b) and (c,d).  Assume the prior for both <code class="reqn">p_i</code> and <code class="reqn">q_i</code> follows independent beta distributions <code class="reqn">beta(\alpha_p,\beta_p)</code> and <code class="reqn">beta(\alpha_q,\beta_q)</code> respectively. The posterior distributions for <code class="reqn">p_i</code> and <code class="reqn">q_i</code> are <code class="reqn">beta(\alpha_p + x_i,\beta_p + n_i - x_i)</code> and <code class="reqn">beta(\alpha_q + y_i,\beta_q + n_i - y_i)</code>. Using these posterior distributions, calculate the JUPM for all  16 combination intervals and find the winning combination interval (a*,b*) and (c*,d*), which achieves the largest JUPM. The decision that corresponds to this winning combination interval is used to treat the next cohort of patients.
</p>
<p>Two dose exclusion rules are applied in the trial design: safety rule and futility rule.
Safety rule:
if at least 3 patients have been treated at a given dose and given
the observed data indicate that the probability of the toxicity rate of
the current dose exceeding the target toxicity rate is more
than 95%, we eliminate the current and any higher dose from the trial to prevent
exposing future patients to with unacceptable high toxicity. The probability
threshold can be specified with <code>cutoff.eli.toxicity</code>. When a dose is
eliminated, the design recommends the next lower dose for treating the next cohort of
patients. If the lowest dose is overly toxic, then the trial terminates early and
no dose is selected as the OBD. This corresponds to a dose assignment of &quot;DUT&quot;, which means de-escalation due to unacceptable high toxicity and excluding the current dose and any dose higher than this dose from the trial.
</p>
<p>Futility rule:
if at least 3 patients have been treated at a given dose and
the observed data indicate that the probability of the  current dose's efficacy rate  exceeding the target efficacy rate is less than 30%, then we eliminate this dose from the trial  to avoid
exposing future patients to these futile doses. The probability
threshold can be specified with <code>cutoff.eli.efficacy</code>.  This corresponds to two possible dose assignments: &quot;EUE&quot; and &quot;DUE&quot;, both excluding this dose from the trial. &quot;EUE&quot; denotes escalation due to unacceptable low efficacy and &quot;DUE&quot; denotes de-escalation due to unacceptable low efficacy.
</p>
<p>An attractive feature of the Keyboard design is that its dose escalation and
de-escalation rule can be tabulated before implementing the trial. Thus,
when conducting the trial, no real-time calculation or model fitting is needed, and one
needs to count only the number of patients, the number of DLTs, and the number of responses observed at the current dose and the desicion to escalate or de-escalate is  based on the pre-tabulated
decision rules.
</p>


<h3>Value</h3>

<p><code>get.decision.obd2.kb()</code> returns a prespecified boundary table and a dose assignment decision table:
</p>

<ol>
<li><p> Boundary table (<code>$boundary.table</code>)
</p>
</li>
<li><p> Decision matrix (<code>$decision.matrix</code>)
</p>
</li></ol>



<h3>Author(s)</h3>

<p>Xiaomeng Yuan, Chen Li, Hongying Sun, Li Tang and Haitao Pan
</p>


<h3>References</h3>

<p>Liu S. and Yuan, Y.  Bayesian Optimal Interval Designs for Phase I Clinical Trials, <em>Journal of the Royal Statistical Society: Series C</em>. 2015; 64, 507-523.
</p>
<p>Yuan Y., Hess K.R., Hilsenbeck S.G. and Gilbert M.R.  Bayesian Optimal Interval Design: A Simple and Well-performing Design for Phase I Oncology Trials. <em>Clinical Cancer Research</em>. 2016; 22, 4291-4301.
</p>
<p>Li DH, Whitmore JB, Guo W, Ji Y.  Toxicity and efficacy probability interval design for phase I adoptive cell therapy dose-finding clinical trials.
<em>Clinical Cancer Research</em>. 2017; 23:13-20.
https://clincancerres.aacrjournals.org/content/23/1/13.long
</p>


<h3>See Also</h3>

<p>Other single-agent phase I/II functions: 
<code><a href="#topic+get.decision.obd.kb">get.decision.obd.kb</a>()</code>,
<code><a href="#topic+get.oc.obd.kb">get.oc.obd.kb</a>()</code>,
<code><a href="#topic+get.oc.obd2.kb">get.oc.obd2.kb</a>()</code>,
<code><a href="#topic+select.obd.kb">select.obd.kb</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
decision.obd2.kb &lt;- get.decision.obd2.kb(target.toxicity=0.2,
           target.efficacy=0.4, cohortsize=3, ncohort=10)
 print(decision.obd2.kb)

</code></pre>

<hr>
<h2 id='get.oc.comb.kb'>Operating Characteristics for Drug-combination Trials</h2><span id='topic+get.oc.comb.kb'></span>

<h3>Description</h3>

<p>This function generates the operating characteristics of the Keyboard design for
drug-combination trials.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.oc.comb.kb(
  target,
  p.true,
  ncohort,
  cohortsize,
  n.earlystop = 100,
  marginL = 0.05,
  marginR = 0.05,
  startdose = c(1, 1),
  cutoff.eli = 0.95,
  extrasafe = FALSE,
  offset = 0.05,
  ntrial = 1000
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get.oc.comb.kb_+3A_target">target</code></td>
<td>
<p>The target dose-limiting toxicity (DLT) rate.</p>
</td></tr>
<tr><td><code id="get.oc.comb.kb_+3A_p.true">p.true</code></td>
<td>
<p>A <code>J*K</code> matrix <code>(J&lt;=K)</code> containing the true toxicity
probabilities of combinations with <code>J</code> dose levels of
agent A and <code>K</code> dose levels of agent B.</p>
</td></tr>
<tr><td><code id="get.oc.comb.kb_+3A_ncohort">ncohort</code></td>
<td>
<p>A scalar specifying the total number of cohorts in the trial.</p>
</td></tr>
<tr><td><code id="get.oc.comb.kb_+3A_cohortsize">cohortsize</code></td>
<td>
<p>The number of patients in the cohort.</p>
</td></tr>
<tr><td><code id="get.oc.comb.kb_+3A_n.earlystop">n.earlystop</code></td>
<td>
<p>The early stopping parameter. If the number of patients
treated at the current dose reaches <code>n.earlystop</code>,
then we stop the trial and select the MTD based on the observed
data.<br />
The default value is 100.</p>
</td></tr>
<tr><td><code id="get.oc.comb.kb_+3A_marginl">marginL</code></td>
<td>
<p>The difference between the target and the lower bound of the
&quot;target key&quot; (proper dosing interval) to be defined.<br />
The default is 0.05.</p>
</td></tr>
<tr><td><code id="get.oc.comb.kb_+3A_marginr">marginR</code></td>
<td>
<p>The difference between the target and the upper bound of the
&quot;target key&quot; (proper dosing interval) to be defined.<br />
The default is 0.05.</p>
</td></tr>
<tr><td><code id="get.oc.comb.kb_+3A_startdose">startdose</code></td>
<td>
<p>The starting dose combination level for the
drug-combination trial.<br />
The default is c(1, 1).</p>
</td></tr>
<tr><td><code id="get.oc.comb.kb_+3A_cutoff.eli">cutoff.eli</code></td>
<td>
<p>The cutoff value to eliminate an overly toxic dose and all
higher doses for safety.<br />
The default value is 0.95.</p>
</td></tr>
<tr><td><code id="get.oc.comb.kb_+3A_extrasafe">extrasafe</code></td>
<td>
<p>Set <code>extrasafe=TRUE</code> to impose a stricter
stopping rule.<br />
The default is FALSE.</p>
</td></tr>
<tr><td><code id="get.oc.comb.kb_+3A_offset">offset</code></td>
<td>
<p>A small positive number (between 0 and 0.5) to control how
strict the stopping rule is when <code>extrasafe=TRUE</code>. A
larger value leads to a stricter stopping rule.<br />
The default value is 0.05.</p>
</td></tr>
<tr><td><code id="get.oc.comb.kb_+3A_ntrial">ntrial</code></td>
<td>
<p>The total number of trials to be simulated. <br />
The default value is 1000.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns the operating characteristics of the Keyboard
combination design as a list: <br />
</p>

<ol>
<li><p> the true toxicity probability at each dose level (<code>$p.true</code>),<br />
</p>
</li>
<li><p> the selection percentage at each dose level (<code>$selpercent</code>),<br />
</p>
</li>
<li><p> the percentage of correct selection (<code>$pcs</code>),<br />
</p>
</li>
<li><p> the number of patients treated at each dose level (<code>$nptsdose</code>),<br />
</p>
</li>
<li><p> the number of toxicities observed at each dose level (<code>$ntoxdose</code>),<br />
</p>
</li>
<li><p> the total number of toxicities observed in the trial (<code>$totaltox</code>),<br />
</p>
</li>
<li><p> the total number of patients in the trial (<code>$totaln</code>),<br />
</p>
</li>
<li><p> the total percentage of patients treated at the MTD (<code>$npercent</code>).
</p>
</li></ol>



<h3>Uses</h3>

<p>This function uses <code><a href="#topic+get.boundary.comb.kb">get.boundary.comb.kb</a></code>
</p>


<h3>Author(s)</h3>

<p>Xiaomeng Yuan, Chen Li, Hongying Sun, Li Tang and Haitao Pan
</p>


<h3>References</h3>

<p>Yan F, Mandrekar SJ, Yuan Y. Keyboard: A Novel Bayesian Toxicity Probability
Interval Design for Phase I Clinical Trials.
<em>Clinical Cancer Research</em>. 2017; 23:3994-4003.
http://clincancerres.aacrjournals.org/content/23/15/3994.full-text.pdf
</p>
<p>Pan H, Lin R, Yuan Y. Keyboard design for phase I drug-combination trials.
<em>Contemporary Clinical Trials</em>. 2020.
https://doi.org/10.1016/j.cct.2020.105972
</p>


<h3>See Also</h3>

<p>Other drug-combination functions: 
<code><a href="#topic+get.boundary.comb.kb">get.boundary.comb.kb</a>()</code>,
<code><a href="#topic+next.comb.kb">next.comb.kb</a>()</code>,
<code><a href="#topic+select.mtd.comb.kb">select.mtd.comb.kb</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### Drug-combination trial ###

p.true &lt;- matrix(c(0.01, 0.03, 0.10, 0.20, 0.30,
                   0.03, 0.05, 0.15, 0.30, 0.60,
                   0.08, 0.10, 0.30, 0.60, 0.75), byrow=TRUE, ncol=5)

oc.comb &lt;- get.oc.comb.kb(target=0.3, p.true=p.true, ncohort=20, cohortsize=3,
                          n.earlystop=12, startdose=c(1, 1), ntrial=100)

</code></pre>

<hr>
<h2 id='get.oc.kb'>Operating Characteristics for Single-agent Trials</h2><span id='topic+get.oc.kb'></span>

<h3>Description</h3>

<p>This function generates the operating characteristics of the Keyboard design for
single-agent trials.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.oc.kb(
  target,
  p.true,
  ncohort,
  cohortsize,
  n.earlystop = 100,
  startdose = 1,
  marginL = 0.05,
  marginR = 0.05,
  cutoff.eli = 0.95,
  extrasafe = FALSE,
  offset = 0.05,
  ntrial = 1000
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get.oc.kb_+3A_target">target</code></td>
<td>
<p>The target dose-limiting toxicity (DLT) rate.</p>
</td></tr>
<tr><td><code id="get.oc.kb_+3A_p.true">p.true</code></td>
<td>
<p>A vector containing the true toxicity probabilities of the
investigational dose levels.</p>
</td></tr>
<tr><td><code id="get.oc.kb_+3A_ncohort">ncohort</code></td>
<td>
<p>A scalar specifying the total number of cohorts in the trial.</p>
</td></tr>
<tr><td><code id="get.oc.kb_+3A_cohortsize">cohortsize</code></td>
<td>
<p>The number of patients in the cohort.<br />
The default is 1.</p>
</td></tr>
<tr><td><code id="get.oc.kb_+3A_n.earlystop">n.earlystop</code></td>
<td>
<p>The early stopping parameter. If the number of patients
treated at the current dose reaches <code>n.earlystop</code>, then
stop the trial and select the MTD based on the observed
data.<br />
The default value is 100.</p>
</td></tr>
<tr><td><code id="get.oc.kb_+3A_startdose">startdose</code></td>
<td>
<p>The starting dose level for the trial.<br />
The default is 1.</p>
</td></tr>
<tr><td><code id="get.oc.kb_+3A_marginl">marginL</code></td>
<td>
<p>The difference between the target and the lower limit of the
&quot;target key&quot; (proper dosing interval) to be defined.<br />
The default is 0.05.</p>
</td></tr>
<tr><td><code id="get.oc.kb_+3A_marginr">marginR</code></td>
<td>
<p>The difference between the target and the upper limit of the
&quot;target key&quot; (proper dosing interval) to be defined.<br />
The default is 0.05.</p>
</td></tr>
<tr><td><code id="get.oc.kb_+3A_cutoff.eli">cutoff.eli</code></td>
<td>
<p>The cutoff value to eliminate an overly toxic dose and all
higher doses for safety.<br />
The default value is 0.95.</p>
</td></tr>
<tr><td><code id="get.oc.kb_+3A_extrasafe">extrasafe</code></td>
<td>
<p>Set <code>extrasafe=TRUE</code> to impose a stricter
stopping rule.<br />
The default is FALSE.</p>
</td></tr>
<tr><td><code id="get.oc.kb_+3A_offset">offset</code></td>
<td>
<p>A small positive number (between 0 and 0.5) to control how
strict the stopping rule is when <code>extrasafe=TRUE</code>. A
larger value leads to a stricter stopping rule.<br />
The default value of 0.05 generally works well.</p>
</td></tr>
<tr><td><code id="get.oc.kb_+3A_ntrial">ntrial</code></td>
<td>
<p>The total number of trials to be simulated. <br />
The default value is 1000.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The operating characteristics of the Keyboard design are generated by
simulating trials under the pre-specified true toxicity probabilities of the
investigational doses.
</p>
<p>The Keyboard design defines a series of equal-width dosing intervals (or
&quot;keys&quot;) to present the potential locations of the true toxicity of a dose
and guide the dose escalation or de-escalation between cohorts of patients.
The Keyboard design starts by specifying a proper dosing interval, referred
to as the &quot;target key&quot;, based on which it forms a series of equally wide
keys that span the remainder of the range from 0 to 1.
</p>
<p>The Keyboard design relies on the posterior distribution of the toxicity
probability to guide dosage. To make the decision of dose escalation or
de-escalation, given the observed data at the current dose, we identify the
key that has the highest posterior probability, referred to as the
&quot;strongest key&quot;. This key represents where the true dose-limiting toxicity
(DLT) rate of the current dose is most likely located. If the strongest key
is to the  left of the target key, then we escalate the dose because
the data suggest that the current dose is most
likely to underdose; if the strongest key is  to the
right of the target key, then we de-escalate the dose because the observed data
suggest that the current dose is likely to overdose; and if the strongest
key is the target key, then we retain the current dose because the observed data
support the notion that the current dose is most likely to be in the proper dosing
interval.
Graphically, the strongest key is the one with the largest area under the
posterior distribution curve of the DLT rate of the current dose.
</p>
<p>An attractive feature of the Keyboard design is that its dose escalation and
de-escalation rule can be tabulated before the onset of the trial. Thus,
when conducting the trial, no calculation or model fitting is needed, and we
need to count only the number of DLTs observed at the current dose;
the decision to escalate or de-escalate the dose is based on the pre-tabulated
decision rules.
</p>
<p>Given all observed data, the Keyboard design uses an isotonic regression to obtain an efficient statistical estimate of
the maximum tolerated dose (MTD) by utilizing the fact that toxicity
presumably increases with the dose.
</p>
<p>For patient safety, the following dose-elimination rule is evaluated after
each cohort:
if at least 3 patients have been treated at the given dose and
the observed data indicate that there is more than a 95% chance that the
current dose is above the maximum tolerated dose (MTD), then we eliminate this dose and beyond from the trial to prevent exposing future patients to these
overly toxic doses. The probability threshold for elimination can be
specified with <code>cutoff.eli</code>. When a dose is eliminated, the design
recommends the next lower dose for treating the next patient.
</p>
<p>The Keyboard design has two built-in stopping rules:<br />
(1) stop the trial if the lowest dose is eliminated due to toxicity, and no
dose should be selected as the MTD; and <br />
(2) stop the trial and select the MTD if the number of patients treated at
the current dose reaches <code>n.earlystop</code>.
</p>
<p>The first stopping rule is a safety rule to protect patients from being exposed to overly toxic doses. The rationale for the second stopping
rule is that when enough (i.e., <code>n.earlystop</code>)
patients are assigned to a dose, then the dose-finding algorithm has
approximately converged. Thus, we can stop the trial early and select the
MTD to minimize the sample size and  the trial duration.
</p>
<p>For some applications, investigators may prefer a stricter stopping rule
than rule (1) for extra safety when the lowest dose is overly toxic.
This can be achieved by setting <code>extrasafe=TRUE</code>, which imposes the
following, stricter, safety stopping rule:<br />
Stop the trial if <br />
(i) the number of patients treated at the lowest dose <code class="reqn">\ge 3</code>, and <br />
(ii) </p>
<p style="text-align: center;"><code class="reqn">Pr((toxicity rate of the lowest dose &gt; target) | data)
           &gt; cutoff.eli - offset</code>
</p>

<p>As a tradeoff, the strong stopping rule will decrease the MTD selection
percentage when the lowest dose is the true MTD.
</p>


<h3>Value</h3>

<p>The function returns the operating characteristics of the Keyboard
design (single-agent) as a list, which includes: <br />
</p>

<ol>
<li><p> the selection percentage at each dose level (<code>$selpercent</code>),<br />
</p>
</li>
<li><p> the average number of patients treated at each dose level (<code>$npatients</code>),<br />
</p>
</li>
<li><p> the average number of toxicities observed at each dose level (<code>$ntox</code>),<br />
</p>
</li>
<li><p> the average number of toxicities (<code>$totaltox</code>),<br />
</p>
</li>
<li><p> the average number of patients (<code>$totaln</code>),<br />
</p>
</li>
<li><p> the percentage of early stopping due to toxicity without selecting the MTD (<code>$percentstop</code>),<br />
</p>
</li>
<li><p> the risk of overdosing 60% or more of patients (<code>$overdose60</code>),<br />
</p>
</li>
<li><p> the risk of overdosing 80% or more of patients (<code>$overdose80</code>),<br />
</p>
</li>
<li><p> a data.frame object containing simulation parameters, such as <code>target, p.true,</code> etc. (<code>$simu.setup</code>).
</p>
</li></ol>



<h3>Uses</h3>

<p>This function uses <code><a href="#topic+get.boundary.kb">get.boundary.kb</a></code> and
<code><a href="#topic+select.mtd.kb">select.mtd.kb</a></code>.
</p>


<h3>Author(s)</h3>

<p>Xiaomeng Yuan, Chen Li, Hongying Sun, Li Tang and Haitao Pan
</p>


<h3>References</h3>

<p>Yan F, Mandrekar SJ, Yuan Y. Keyboard: A Novel Bayesian Toxicity Probability
Interval Design for Phase I Clinical Trials.
<em>Clinical Cancer Research</em>. 2017; 23:3994-4003.
http://clincancerres.aacrjournals.org/content/23/15/3994.full-text.pdf
</p>


<h3>See Also</h3>

<p>Other single-agent functions: 
<code><a href="#topic+get.boundary.kb">get.boundary.kb</a>()</code>,
<code><a href="#topic+select.mtd.kb">select.mtd.kb</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
### Single-agent trial ###

oc &lt;- get.oc.kb(target=0.3, p.true=c(0.05, 0.15, 0.3, 0.45, 0.6),
                ncohort=20, cohortsize=3, ntrial=1000)

oc



</code></pre>

<hr>
<h2 id='get.oc.obd.kb'>Generate Operating Characteristics to Find the Optimal Biological Dose</h2><span id='topic+get.oc.obd.kb'></span>

<h3>Description</h3>

<p>This function generates operating characteristics to find the  optimal biological dose (OBD).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.oc.obd.kb(
  toxicity.low,
  toxicity.moderate,
  toxicity.high,
  efficacy.low,
  efficacy.moderate,
  efficacy.high,
  target.toxicity,
  target.efficacy,
  ncohort = 10,
  cohortsize = 3,
  n.early = 100,
  startdose = 1,
  p.true,
  q.true,
  ntrial = 1000,
  seed = 6,
  p1 = 0.15,
  p2 = 0.4,
  q1 = 0.3,
  q2 = 0.6,
  cutoff.eli.toxicity = 0.95,
  cutoff.eli.efficacy = 0.3,
  w1.toxicity = 0.33,
  w2.toxicity = 1.09,
  indicator = target.toxicity
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get.oc.obd.kb_+3A_toxicity.low">toxicity.low</code></td>
<td>
<p>The upper boundary for the low toxicity interval.</p>
</td></tr>
<tr><td><code id="get.oc.obd.kb_+3A_toxicity.moderate">toxicity.moderate</code></td>
<td>
<p>The upper boundary for the moderate toxicity interval.</p>
</td></tr>
<tr><td><code id="get.oc.obd.kb_+3A_toxicity.high">toxicity.high</code></td>
<td>
<p>The upper boundary for the high toxicity interval.</p>
</td></tr>
<tr><td><code id="get.oc.obd.kb_+3A_efficacy.low">efficacy.low</code></td>
<td>
<p>The upper boundary for the low efficacy interval.</p>
</td></tr>
<tr><td><code id="get.oc.obd.kb_+3A_efficacy.moderate">efficacy.moderate</code></td>
<td>
<p>The upper boundary for the moderate efficacy interval.</p>
</td></tr>
<tr><td><code id="get.oc.obd.kb_+3A_efficacy.high">efficacy.high</code></td>
<td>
<p>The upper boundary for the high efficacy interval.</p>
</td></tr>
<tr><td><code id="get.oc.obd.kb_+3A_target.toxicity">target.toxicity</code></td>
<td>
<p>The target DLT rate.</p>
</td></tr>
<tr><td><code id="get.oc.obd.kb_+3A_target.efficacy">target.efficacy</code></td>
<td>
<p>The target efficacy rate.</p>
</td></tr>
<tr><td><code id="get.oc.obd.kb_+3A_ncohort">ncohort</code></td>
<td>
<p>The total number of cohorts.</p>
</td></tr>
<tr><td><code id="get.oc.obd.kb_+3A_cohortsize">cohortsize</code></td>
<td>
<p>The number of patients in the cohort.</p>
</td></tr>
<tr><td><code id="get.oc.obd.kb_+3A_n.early">n.early</code></td>
<td>
<p>The early stopping parameter. If the number of patients treated at
the current dose reaches <code>n.early</code>, then we stop the trial
and select the optimal biological dose (OBD) based on the observed data. The default value is 100.</p>
</td></tr>
<tr><td><code id="get.oc.obd.kb_+3A_startdose">startdose</code></td>
<td>
<p>The starting dose level.</p>
</td></tr>
<tr><td><code id="get.oc.obd.kb_+3A_p.true">p.true</code></td>
<td>
<p>A vector containing the true toxicity probabilities of the
investigational dose levels.</p>
</td></tr>
<tr><td><code id="get.oc.obd.kb_+3A_q.true">q.true</code></td>
<td>
<p>A vector containing the true efficacy probabilities of the
investigational dose levels.</p>
</td></tr>
<tr><td><code id="get.oc.obd.kb_+3A_ntrial">ntrial</code></td>
<td>
<p>The total number of trials to be simulated.</p>
</td></tr>
<tr><td><code id="get.oc.obd.kb_+3A_seed">seed</code></td>
<td>
<p>The random seed for simulation.</p>
</td></tr>
<tr><td><code id="get.oc.obd.kb_+3A_p1">p1</code></td>
<td>
<p>The cutoff lower limit for safety utility function 1, described in the Details section.</p>
</td></tr>
<tr><td><code id="get.oc.obd.kb_+3A_p2">p2</code></td>
<td>
<p>The cutoff upper limit for safety utility function 1, described in the Details section.</p>
</td></tr>
<tr><td><code id="get.oc.obd.kb_+3A_q1">q1</code></td>
<td>
<p>The cutoff lower limit for efficacy utility function 1, described in the Details section.</p>
</td></tr>
<tr><td><code id="get.oc.obd.kb_+3A_q2">q2</code></td>
<td>
<p>The cutoff upper limit for efficacy utility function 1, described in the Details section.</p>
</td></tr>
<tr><td><code id="get.oc.obd.kb_+3A_cutoff.eli.toxicity">cutoff.eli.toxicity</code></td>
<td>
<p>The cutoff value to eliminate a dose with unacceptable high toxicity for safety. The default value is 0.95.</p>
</td></tr>
<tr><td><code id="get.oc.obd.kb_+3A_cutoff.eli.efficacy">cutoff.eli.efficacy</code></td>
<td>
<p>The cutoff value for the futility rule, the acceptable lowest efficacy. The default value is 0.30.</p>
</td></tr>
<tr><td><code id="get.oc.obd.kb_+3A_w1.toxicity">w1.toxicity</code></td>
<td>
<p>The weight for toxicity utility function 2 and 3,described in the Details section.</p>
</td></tr>
<tr><td><code id="get.oc.obd.kb_+3A_w2.toxicity">w2.toxicity</code></td>
<td>
<p>The weight for toxicity utility function 3, described in the Details section.</p>
</td></tr>
<tr><td><code id="get.oc.obd.kb_+3A_indicator">indicator</code></td>
<td>
<p>The indicator cutoff value for utility function 3, described in the Details section.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Large trials are simulated to characterize the operating characteristics of the Keyboard design under the prespecified true toxicity probabilities and true efficacy probabilities of the investigational doses. The dose assignment follows the rules described in the function <code>get.decision.obd.kb()</code>.
</p>
<p>The following stopping rules are built in the Keyboard design:
</p>

<ol>
<li><p> Stop the trial if the lowest dose is eliminated from the trial due to high unacceptable toxicity.
</p>
</li>
<li><p> Stop the trial if the number of patients treated at the current dose exceeds <code>n.earlystop</code>.
</p>
</li></ol>



<h3>Value</h3>

<p><code>get.oc.obd.kb()</code> returns the operating characteristics of the Keyboard design as a list, including:<br />
</p>

<ol>
<li><p> the selection percentage at each dose level using utility function 1 (<code>$selpercent1</code>), <br />
</p>
</li>
<li><p> the selection percentage at each dose level using utility function 2 (<code>$selpercent2</code>), <br />
</p>
</li>
<li><p> the selection percentage at each dose level using utility function 3 (<code>$selpercent3</code>), <br />
</p>
</li>
<li><p> the number of patients treated at each dose level (<code>$npatients</code>), <br />
</p>
</li>
<li><p> the number of dose-limiting toxicities (DLTs) observed at each dose level (<code>$ntox</code>), <br />
</p>
</li>
<li><p> the number of responses observed at each dose level (<code>$neff</code>), <br />
</p>
</li>
<li><p> the average number of DLTs (<code>$totaltox</code>), <br />
</p>
</li>
<li><p> the average number of responses (<code>$totaleff</code>), <br />
</p>
</li>
<li><p> the average number of patients (<code>$totaln</code>), <br />
</p>
</li>
<li><p> the percentage of early stopping without selecting the OBD using utility function 1 (<code>$percentstop1</code>), <br />
</p>
</li>
<li><p> the percentage of early stopping without selecting the OBD using utility function 2 (<code>$percentstop2</code>), <br />
</p>
</li>
<li><p> the percentage of early stopping without selecting the OBD using utility function 3 (<code>$percentstop3</code>), <br />
</p>
</li>
<li><p> data.frame (<code>$simu.setup</code>) containing simulation parameters, such as target, p.true, etc.
</p>
</li></ol>



<h3>Author(s)</h3>

<p>Xiaomeng Yuan, Chen Li, Hongying Sun, Li Tang and Haitao Pan
</p>


<h3>References</h3>

<p>Li DH, Whitmore JB, Guo W, Ji Y.  Toxicity and efficacy probability interval design for phase I adoptive cell therapy dose-finding clinical trials.
<em>Clinical Cancer Research</em>. 2017; 23:13-20.
https://clincancerres.aacrjournals.org/content/23/1/13.long
</p>
<p>Liu S, Johnson VE.  A robust Bayesian dose-finding design for phase I/II clinical trials. <em>Biostatistics</em>. 2016; 17(2):249-63.
https://academic.oup.com/biostatistics/article/17/2/249/1744018
</p>
<p>Zhou Y, Lee JJ, Yuan Y.  A utility-based Bayesian optimal interval (U-BOIN) phase I/II design to identify the optimal biological dose for targeted and immune therapies. <em>Statistics in Medicine</em>. 2019; 38:S5299-5316.
https://onlinelibrary.wiley.com/doi/epdf/10.1002/sim.8361
</p>


<h3>See Also</h3>

<p>Other single-agent phase I/II functions: 
<code><a href="#topic+get.decision.obd.kb">get.decision.obd.kb</a>()</code>,
<code><a href="#topic+get.decision.obd2.kb">get.decision.obd2.kb</a>()</code>,
<code><a href="#topic+get.oc.obd2.kb">get.oc.obd2.kb</a>()</code>,
<code><a href="#topic+select.obd.kb">select.obd.kb</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
toxicity.low &lt;- 0.15
toxicity.moderate &lt;- 0.25
toxicity.high &lt;- 0.35
efficacy.low &lt;- 0.25
efficacy.moderate &lt;- 0.45
efficacy.high &lt;- 0.65
target.toxicity &lt;- 0.30
target.efficacy &lt;- 0.40
p.true &lt;-c(0.08,0.30,0.60,0.80)
q.true &lt;- c(0.25,0.40,0.25,0.50)
oc.obd.kb &lt;- get.oc.obd.kb(toxicity.low = toxicity.low,
             toxicity.moderate= toxicity.moderate,
             toxicity.high = toxicity.high,
             efficacy.low = efficacy.low,
             efficacy.moderate = efficacy.moderate,
             efficacy.high = efficacy.high,
             target.toxicity=target.toxicity,
             target.efficacy= target.efficacy,
             p.true= p.true, q.true= q.true)
oc.obd.kb
summary_kb(oc.obd.kb)
plot_kb(oc.obd.kb)
plot_kb(oc.obd.kb$selpercent1)
plot_kb(oc.obd.kb$selpercent2)
plot_kb(oc.obd.kb$selpercent3)
plot_kb(oc.obd.kb$npatients)
plot_kb(oc.obd.kb$ntox)
plot_kb(oc.obd.kb$neff)

</code></pre>

<hr>
<h2 id='get.oc.obd2.kb'>Generate Operating Characteristics for OBD Finding Automaticallly</h2><span id='topic+get.oc.obd2.kb'></span>

<h3>Description</h3>

<p>This function reports operating characteristics for optimal biological dose (OBD) finding automatically.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.oc.obd2.kb(
  target.toxicity,
  target.efficacy,
  ncohort = 10,
  cohortsize = 3,
  n.early = 100,
  startdose = 1,
  p.true,
  q.true,
  ntrial = 1000,
  seed = 6,
  p1 = 0.15,
  p2 = 0.4,
  q1 = 0.3,
  q2 = 0.6,
  cutoff.eli.toxicity = 0.95,
  cutoff.eli.efficacy = 0.3,
  w1.toxicity = 0.33,
  w2.toxicity = 1.09,
  indicator = target.toxicity
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get.oc.obd2.kb_+3A_target.toxicity">target.toxicity</code></td>
<td>
<p>The target DLT rate.</p>
</td></tr>
<tr><td><code id="get.oc.obd2.kb_+3A_target.efficacy">target.efficacy</code></td>
<td>
<p>The target efficacy rate.</p>
</td></tr>
<tr><td><code id="get.oc.obd2.kb_+3A_ncohort">ncohort</code></td>
<td>
<p>The total number of cohorts.</p>
</td></tr>
<tr><td><code id="get.oc.obd2.kb_+3A_cohortsize">cohortsize</code></td>
<td>
<p>The number of patients in the cohort.</p>
</td></tr>
<tr><td><code id="get.oc.obd2.kb_+3A_n.early">n.early</code></td>
<td>
<p>The early stopping parameter. If the number of patients treated at
the current dose reaches <code>n.early</code>, then we stop the trial
and select the optimal biological dose (OBD) based on the observed data. The default value is 100.</p>
</td></tr>
<tr><td><code id="get.oc.obd2.kb_+3A_startdose">startdose</code></td>
<td>
<p>The starting dose level.</p>
</td></tr>
<tr><td><code id="get.oc.obd2.kb_+3A_p.true">p.true</code></td>
<td>
<p>A vector containing the true toxicity probabilities of the
investigational dose levels.</p>
</td></tr>
<tr><td><code id="get.oc.obd2.kb_+3A_q.true">q.true</code></td>
<td>
<p>A vector containing the true efficacy  probabilities of the
investigational dose levels.</p>
</td></tr>
<tr><td><code id="get.oc.obd2.kb_+3A_ntrial">ntrial</code></td>
<td>
<p>The total number of trials to be simulated.</p>
</td></tr>
<tr><td><code id="get.oc.obd2.kb_+3A_seed">seed</code></td>
<td>
<p>The random seed for simulation.</p>
</td></tr>
<tr><td><code id="get.oc.obd2.kb_+3A_p1">p1</code></td>
<td>
<p>The cutoff lower limit for safety utility function 1, described in the Details section.</p>
</td></tr>
<tr><td><code id="get.oc.obd2.kb_+3A_p2">p2</code></td>
<td>
<p>The cutoff upper limit for safety utility function 1, described in the Details section.</p>
</td></tr>
<tr><td><code id="get.oc.obd2.kb_+3A_q1">q1</code></td>
<td>
<p>The cutoff lower limit for efficacy utility function 1, described in the Details section.</p>
</td></tr>
<tr><td><code id="get.oc.obd2.kb_+3A_q2">q2</code></td>
<td>
<p>The cutoff upper limit for efficacy utility function 1, described in the Details section.</p>
</td></tr>
<tr><td><code id="get.oc.obd2.kb_+3A_cutoff.eli.toxicity">cutoff.eli.toxicity</code></td>
<td>
<p>The cutoff to eliminate a dose with unacceptable high toxicity for safety.
The recommended value is 0.95.</p>
</td></tr>
<tr><td><code id="get.oc.obd2.kb_+3A_cutoff.eli.efficacy">cutoff.eli.efficacy</code></td>
<td>
<p>The cutoff for the futility rule, the acceptable lowest efficacy.
The recommended value is 0.30.</p>
</td></tr>
<tr><td><code id="get.oc.obd2.kb_+3A_w1.toxicity">w1.toxicity</code></td>
<td>
<p>The weight for toxicity utility function 2 and 3, described in the Details section.</p>
</td></tr>
<tr><td><code id="get.oc.obd2.kb_+3A_w2.toxicity">w2.toxicity</code></td>
<td>
<p>The weight for toxicity utility function 3, described in the Details section.</p>
</td></tr>
<tr><td><code id="get.oc.obd2.kb_+3A_indicator">indicator</code></td>
<td>
<p>The indicator cutoff for utility function 3, described in the Details section.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A large number of  trials are simulated to characterize the operating characteristics of the Keyboard design under the prespecified true toxicity probabilities and true efficacy probabilities of the investigational doses.  The dose assignment follows the rules described in the function <code>get.decision.obd.kb()</code>.
</p>
<p>The following stopping rules are built in the Keyboard design:
</p>

<ol>
<li><p> Stop the trial if the lowest dose is eliminated from the trial due to high unacceptable toxicity.
</p>
</li>
<li><p> Stop the trial if the number of patients treated at current dose is larger than or equal to <code>n.earlystop</code>.
</p>
</li></ol>



<h3>Value</h3>

<p><code>get.oc.obd2.kb()</code> returns the operating characteristics of the Keyboard design as a list, including:<br />
</p>

<ol>
<li><p> the selection percentage at each dose level using utility function 1 (<code>$selpercent1</code>), <br />
</p>
</li>
<li><p> the selection percentage at each dose level using utility function 2 (<code>$selpercent2</code>), <br />
</p>
</li>
<li><p> the selection percentage at each dose level using utility function 3 (<code>$selpercent3</code>), <br />
</p>
</li>
<li><p> the number of patients treated at each dose level (<code>$npatients</code>), <br />
</p>
</li>
<li><p> the number of dose-limiting toxicities (DLTs) observed at each dose level (<code>$ntox</code>), <br />
</p>
</li>
<li><p> the number of responses observed at each dose level (<code>$neff</code>), <br />
</p>
</li>
<li><p> the average number of DLTs (<code>$totaltox</code>), <br />
</p>
</li>
<li><p> the average number of responses (<code>$totaleff</code>), <br />
</p>
</li>
<li><p> the average number of patients (<code>$totaln</code>), <br />
</p>
</li>
<li><p> the percentage of early stopping without selecting the OBD using utility function 1 (<code>$percentstop1</code>), <br />
</p>
</li>
<li><p> the percentage of early stopping without selecting the OBD using utility function 2 (<code>$percentstop2</code>), <br />
</p>
</li>
<li><p> the percentage of early stopping without selecting the OBD using utility function 3 (<code>$percentstop3</code>), <br />
</p>
</li>
<li><p> data.frame (<code>$simu.setup</code>) containing simulation parameters, such as target, p.true, etc.
</p>
</li></ol>



<h3>Author(s)</h3>

<p>Xiaomeng Yuan, Chen Li, Hongying Sun, Li Tang and Haitao Pan
</p>


<h3>References</h3>

<p>Li DH, Whitmore JB, Guo W, Ji Y.  Toxicity and efficacy probability interval design for phase I adoptive cell therapy dose-finding clinical trials.
<em>Clinical Cancer Research</em>. 2017; 23:13-20.
https://clincancerres.aacrjournals.org/content/23/1/13.long
</p>
<p>Liu S, Johnson VE.  A robust Bayesian dose-finding design for phase I/II clinical trials. <em>Biostatistics</em>. 2016; 17(2):249-63.
https://academic.oup.com/biostatistics/article/17/2/249/1744018
</p>
<p>Zhou Y, Lee JJ, Yuan Y.  A utility-based Bayesian optimal interval (U-BOIN) phase I/II design to identify the optimal biological dose for targeted and immune therapies. <em>Statistics in Medicine</em>. 2019; 38:S5299-5316.
https://onlinelibrary.wiley.com/doi/epdf/10.1002/sim.8361
</p>


<h3>See Also</h3>

<p>Other single-agent phase I/II functions: 
<code><a href="#topic+get.decision.obd.kb">get.decision.obd.kb</a>()</code>,
<code><a href="#topic+get.decision.obd2.kb">get.decision.obd2.kb</a>()</code>,
<code><a href="#topic+get.oc.obd.kb">get.oc.obd.kb</a>()</code>,
<code><a href="#topic+select.obd.kb">select.obd.kb</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
target.toxicity &lt;- 0.30
target.efficacy &lt;- 0.40
p.true &lt;-c(0.08,0.30,0.60,0.80)
q.true &lt;- c(0.25,0.40,0.25,0.50)
oc.obd2.kb &lt;- get.oc.obd2.kb(target.toxicity=target.toxicity,
              target.efficacy= target.efficacy, ncohort=20,
              cohortsize= 3,  p.true= p.true, q.true= q.true)
oc.obd2.kb
summary_kb(oc.obd2.kb)
plot_kb(oc.obd2.kb)
plot_kb(oc.obd2.kb$selpercent1)
plot_kb(oc.obd2.kb$selpercent2)
plot_kb(oc.obd2.kb$selpercent3)
plot_kb(oc.obd2.kb$npatients)
plot_kb(oc.obd2.kb$ntox)
plot_kb(oc.obd2.kb$neff)


</code></pre>

<hr>
<h2 id='next.comb.kb'>Find the Next Dose Combination</h2><span id='topic+next.comb.kb'></span>

<h3>Description</h3>

<p>This function determines the dose combination for the next cohort of patients in
drug-combination trials.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>next.comb.kb(
  target,
  npts,
  ntox,
  dose.curr,
  n.earlystop = 100,
  marginL = 0.05,
  marginR = 0.05,
  cutoff.eli = 0.95,
  extrasafe = FALSE,
  offset = 0.05
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="next.comb.kb_+3A_target">target</code></td>
<td>
<p>The target dose-limiting toxicity (DLT) rate.</p>
</td></tr>
<tr><td><code id="next.comb.kb_+3A_npts">npts</code></td>
<td>
<p>A <code>J*K</code> matrix <code>(J&lt;=K)</code> containing the number of
patients treated at each dose combination.</p>
</td></tr>
<tr><td><code id="next.comb.kb_+3A_ntox">ntox</code></td>
<td>
<p>A <code>J*K</code> matrix <code>(J&lt;=K)</code> containing the number of
patients who experienced a dose-limiting toxicity at each dose
combination.</p>
</td></tr>
<tr><td><code id="next.comb.kb_+3A_dose.curr">dose.curr</code></td>
<td>
<p>The current dose combination, i.e., the dose combination that was used to treat the most recently enrolled cohort of patients.</p>
</td></tr>
<tr><td><code id="next.comb.kb_+3A_n.earlystop">n.earlystop</code></td>
<td>
<p>The early stopping parameter. If the number of patients
treated at the current dose reaches <code>n.earlystop</code>, then we
stop the trial and select the MTD based on the observed
data.<br />
The default value is 100.</p>
</td></tr>
<tr><td><code id="next.comb.kb_+3A_marginl">marginL</code></td>
<td>
<p>The difference between the target and the lower limit of the
&quot;target key&quot; (proper dosing interval) to be defined.<br />
The default is 0.05.</p>
</td></tr>
<tr><td><code id="next.comb.kb_+3A_marginr">marginR</code></td>
<td>
<p>The difference between the target and the upper limit of the
&quot;target key&quot; (proper dosing interval) to be defined.<br />
The default is 0.05.</p>
</td></tr>
<tr><td><code id="next.comb.kb_+3A_cutoff.eli">cutoff.eli</code></td>
<td>
<p>The cutoff value to eliminate an overly toxic dose and all
higher doses for safety.<br />
The default value is 0.95.</p>
</td></tr>
<tr><td><code id="next.comb.kb_+3A_extrasafe">extrasafe</code></td>
<td>
<p>Set <code>extrasafe=TRUE</code> to impose a stricter
stopping rule.<br />
The default is FALSE.</p>
</td></tr>
<tr><td><code id="next.comb.kb_+3A_offset">offset</code></td>
<td>
<p>A small positive number (between 0 and 0.5) to control how
strict the stopping rule is when <code>extrasafe=TRUE</code>. A
larger value leads to a stricter stopping rule.<br />
The default value is 0.05.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given the observed data thus far, this function determines the dose
combination for treating the next cohort of new patients. The observed data
are as follows: the number of patients treated at each dose combination (<code>npts</code>), the number of patients who experienced dose-limiting toxicities (DLTs)
at each dose combination (<code>ntox</code>) and the level of the current
dose (<code>dose.curr</code>). The number of patients for doses that have not been used in the trial is zero.
</p>


<h3>Value</h3>

<p>This function returns the recommended dose for treating the next
cohort of patients (<code>$next_dc</code>).
</p>


<h3>Uses</h3>

<p>This function uses <code><a href="#topic+get.boundary.comb.kb">get.boundary.comb.kb</a></code>.
</p>


<h3>Author(s)</h3>

<p>Xiaomeng Yuan, Chen Li, Hongying Sun, Li Tang and Haitao Pan
</p>


<h3>References</h3>

<p>Yan F, Mandrekar SJ, Yuan Y. Keyboard: A Novel Bayesian Toxicity Probability
Interval Design for Phase I Clinical Trials.
<em>Clinical Cancer Research</em>. 2017; 23:3994-4003.
http://clincancerres.aacrjournals.org/content/23/15/3994.full-text.pdf
</p>
<p>Pan H, Lin R, Yuan Y. Keyboard design for phase I drug-combination trials.
<em>Contemporary Clinical Trials</em>. 2020.
https://doi.org/10.1016/j.cct.2020.105972
</p>


<h3>See Also</h3>

<p>Other drug-combination functions: 
<code><a href="#topic+get.boundary.comb.kb">get.boundary.comb.kb</a>()</code>,
<code><a href="#topic+get.oc.comb.kb">get.oc.comb.kb</a>()</code>,
<code><a href="#topic+select.mtd.comb.kb">select.mtd.comb.kb</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### Drug-combination trial ###

n &lt;- matrix(c(3, 0, 0, 0, 0,
              7, 6, 0, 0, 0,
              0, 0, 0, 0, 0), ncol=5, byrow=TRUE)
y &lt;- matrix(c(0, 0, 0, 0, 0,
              1, 1, 0, 0, 0,
              0, 0, 0, 0, 0), ncol=5, byrow=TRUE)

nxt.comb &lt;- next.comb.kb(target=0.3, npts=n, ntox=y, dose.curr=c(2, 2))
summary_kb(nxt.comb)

</code></pre>

<hr>
<h2 id='plot_kb'>Plot Objects Generated by the Keyboard Design Package</h2><span id='topic+plot_kb'></span>

<h3>Description</h3>

<p>This function plots the objects returned by the other functions in the Keyboard package. <br /><br />
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_kb(x, ..., name = deparse(substitute(x)))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_kb_+3A_x">x</code></td>
<td>
<p>The object (returned by another function) to be plotted.</p>
</td></tr>
<tr><td><code id="plot_kb_+3A_...">...</code></td>
<td>
<p>Ignored arguments.</p>
</td></tr>
<tr><td><code id="plot_kb_+3A_name">name</code></td>
<td>
<p>The name of the object to be plotted.<br />
(Users should not input this parameter).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>(1) For get.oc.kb() and get.oc.comb.kb(), the operating characteristics of
the Keyboard design, which include: <br />
(i) the overall dose selection percentage of the simulations generated, <br />
(ii) the number of patients treated at each dose, and <br />
(iii) the toxicities presented at each dose. <br /><br />
(2) For get.oc.obd.kb() and get.oc.obd2.kb(), the operating characteristics of the Keyboard design for phase I/II, which includes: <br />
(i) the overall dose selection percentage of the simulations generated, <br />
(ii) the number of patients treated at each dose,  <br />
(iii) the toxicities presented at each dose, and <br />
(iv) the efficacies presented at each dose. <br /><br />
(3) For select.mtd.kb() and select.mtd.comb.kb(): an infographic showing the
estimates of the toxicity probability for each dose, with corresponding
95% credible intervals.
</p>


<h3>Value</h3>

<p>This function returns a figure.
</p>


<h3>Author(s)</h3>

<p>Xiaomeng Yuan, Chen Li, Hongying Sun, Li Tang and Haitao Pan
</p>


<h3>See Also</h3>

<p><code><a href="#topic+summary_kb">summary_kb</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
### Single-agent trial ###

## Get the operating characteristics for a Keyboard single-agent trial
oc &lt;- get.oc.kb(target=0.3, p.true=c(0.05, 0.15, 0.3, 0.45, 0.6),
                ncohort=10, cohortsize=3, ntrial=1000)
summary_kb(oc)

plot_kb(oc)
plot_kb(oc$selpercent)
plot_kb(oc$npatients)
plot_kb(oc$ntox)

## Select the MTD based on a trial's data
n &lt;- c(3, 3, 15, 9, 0)
y &lt;- c(0, 0, 4, 4, 0)
selmtd &lt;- select.mtd.kb(target=0.3, npts=n, ntox=y)
summary_kb(selmtd)

plot_kb(selmtd)


### Drug-combination trial ###

## Get the operating characteristics for a Keyboard drug-combination trial
p.true &lt;- matrix(c(0.01, 0.03, 0.10, 0.20, 0.30,
                   0.03, 0.05, 0.15, 0.30, 0.60,
                   0.08, 0.10, 0.30, 0.60, 0.75), byrow=TRUE, ncol=5)
oc.comb &lt;- get.oc.comb.kb(target=0.3, p.true=p.true, ncohort=20,
 cohortsize=3, n.earlystop=12, startdose=c(1, 1), ntrial=100)
summary_kb(oc.comb)

plot_kb(oc.comb) # use previous plot or next plot button to switch plots
plot_kb(oc.comb$selpercent)
plot_kb(oc.comb$nptsdose)
plot_kb(oc.comb$ntoxdose)

## Select the MTD based on a trial's data
n &lt;- matrix(c(3, 5, 0, 0, 0,
              7, 6, 15, 0, 0,
              0, 0, 4, 0, 0), ncol=5, byrow=TRUE)
y &lt;- matrix(c(0, 1, 0, 0, 0,
              1, 1, 4, 0, 0,
              0, 0, 2, 0, 0), ncol=5, byrow=TRUE)
sel.comb &lt;- select.mtd.comb.kb(target=0.3, npts=n, ntox=y)
summary_kb(sel.comb)

plot_kb(sel.comb)

### oc.obd.kb
toxicity.low &lt;- 0.15
toxicity.moderate &lt;- 0.33
toxicity.high &lt;- 0.40
efficacy.low &lt;- 0.20
efficacy.moderate &lt;- 0.40
efficacy.high &lt;- 0.60
target.toxicity &lt;- 0.30
target.efficacy &lt;- 0.40
p.true &lt;-c(0.08,0.30,0.60,0.80)
q.true &lt;- c(0.25,0.40,0.25,0.50)
oc.obd.kb &lt;- get.oc.obd.kb(toxicity.low = toxicity.low,
             toxicity.moderate= toxicity.moderate,
             toxicity.high = toxicity.high,
             efficacy.low = efficacy.low,
             efficacy.moderate = efficacy.moderate,
             efficacy.high = efficacy.high,
             target.toxicity=target.toxicity,
             target.efficacy= target.efficacy,
             p.true= p.true, q.true= q.true)
summary_kb(oc.obd.kb)
plot_kb(oc.obd.kb)
plot_kb(oc.obd.kb$selpercent1)
plot_kb(oc.obd.kb$selpercent2)
plot_kb(oc.obd.kb$selpercent3)
plot_kb(oc.obd.kb$npatients)
plot_kb(oc.obd.kb$ntox)
plot_kb(oc.obd.kb$neff)

</code></pre>

<hr>
<h2 id='select.mtd.comb.kb'>Maximum Tolerated Dose (MTD) Selection for Drug-combination Trials</h2><span id='topic+select.mtd.comb.kb'></span>

<h3>Description</h3>

<p>This function selects the maximum tolerated dose (MTD) after the drug-combination trial is
completed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>select.mtd.comb.kb(
  target,
  npts,
  ntox,
  cutoff.eli = 0.95,
  extrasafe = FALSE,
  offset = 0.05
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="select.mtd.comb.kb_+3A_target">target</code></td>
<td>
<p>The target dose-limiting toxicity (DLT) rate.</p>
</td></tr>
<tr><td><code id="select.mtd.comb.kb_+3A_npts">npts</code></td>
<td>
<p>A <code>J*K</code> matrix <code>(J&lt;=K)</code> containing the number of
patients treated at each dose combination.</p>
</td></tr>
<tr><td><code id="select.mtd.comb.kb_+3A_ntox">ntox</code></td>
<td>
<p>A <code>J*K</code> matrix <code>(J&lt;=K)</code> containing the number of
patients who experienced a dose-limiting toxicity at each dose
combination.</p>
</td></tr>
<tr><td><code id="select.mtd.comb.kb_+3A_cutoff.eli">cutoff.eli</code></td>
<td>
<p>The cutoff value to eliminate an overly toxic dose and all
higher doses for safety.<br />
The default value is 0.95.</p>
</td></tr>
<tr><td><code id="select.mtd.comb.kb_+3A_extrasafe">extrasafe</code></td>
<td>
<p>Set <code>extrasafe=TRUE</code> to impose a stricter
stopping rule.<br />
The default is FALSE.</p>
</td></tr>
<tr><td><code id="select.mtd.comb.kb_+3A_offset">offset</code></td>
<td>
<p>A small positive number (between 0 and 0.5) to control how
strict the stopping rule is when <code>extrasafe=TRUE</code>. A
larger value leads to a stricter stopping rule.<br />
The default value is 0.05.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Keyboard design starts by specifying a target toxicity interval
(referred to as the &quot;target key&quot;) such that any dose with a toxicity
probability within that interval can be practically viewed as the MTD.
Based on this interval's width, the Keyboard design forms a series of
equally wide keys that span the rest of the range from 0 to 1.
</p>
<p>Given all the observed data once the trial is completed, this function
selects the MTD based on matrix isotonic estimates of the toxicity
probability of each dose combination, selecting the dose whose estimate is
closest to the target. When there are ties, one is randomly chosen.
These (matrix) isotonic estimates are obtained with
<code><a href="Iso.html#topic+biviso">biviso</a></code>.
</p>
<p>For patient safety, the following dose elimination rule is evaluated after
each cohort:
if at least 3 patients have been treated at the given dose and the
observed data indicate that there is more than a 95% chance that the current
dose is above the MTD, then we eliminate this dose and beyond from the trial to
prevent exposing future patients to these overly toxic doses. The
probability threshold for elimination can be specified with
<code>cutoff.eli</code>. When a dose is eliminated, the design recommends the next
lower dose for treating the next patient. If the lowest dose combination
(1, 1) is overly toxic, then the trial terminates early and no dose is selected
as the MTD.
</p>
<p>For some applications, investigators may prefer a stricter stopping rule
for extra safety when the lowest dose is overly toxic. This can be achieved
by setting <code>extrasafe=TRUE</code>, which imposes the following stricter
safety stopping rule:<br />
Stop the trial if <br />
(i) the number of patients treated at the lowest dose <code class="reqn">\ge 3</code>, and <br />
(ii) </p>
<p style="text-align: center;"><code class="reqn">Pr[(toxicity rate of the lowest dose &gt; target) | data)]
           &gt; cutoff.eli - offset</code>
</p>

<p>As a tradeoff, the strong stopping rule will decrease the MTD selection
percentage when the lowest dose is the true MTD.
</p>


<h3>Value</h3>

<p>The function returns a list with: <br />
</p>

<ol>
<li><p> the target toxicity probability (<code>$target</code>),<br />
</p>
</li>
<li><p> the selected MTD (<code>$MTD</code>),<br />
</p>
</li>
<li><p> a matrix with the isotonic estimates of the DLT probability at each
dose (<code>$p_est</code>).
</p>
</li></ol>



<h3>Uses</h3>

<p>This function uses <code><a href="Iso.html#topic+biviso">biviso</a></code>.
</p>


<h3>Note</h3>

<p>The MTD selection and dose escalation/de-escalation rules are two
independent components of the trial design. When appropriate, another dose
selection procedure (e.g., one based on a fitted logistic model) can be used
to select the MTD after completing the trial using the Keyboard design.
</p>


<h3>Author(s)</h3>

<p>Xiaomeng Yuan, Chen Li, Hongying Sun, Li Tang and Haitao Pan
</p>


<h3>References</h3>

<p>Yan F, Mandrekar SJ, Yuan Y. Keyboard: A Novel Bayesian Toxicity Probability
Interval Design for Phase I Clinical Trials.
<em>Clinical Cancer Research</em>. 2017; 23:3994-4003.
http://clincancerres.aacrjournals.org/content/23/15/3994.full-text.pdf
</p>
<p>Pan H, Lin R, Yuan Y. Keyboard design for phase I drug-combination trials.
<em>Contemporary Clinical Trials</em>. 2020.
https://doi.org/10.1016/j.cct.2020.105972
</p>


<h3>See Also</h3>

<p>Other drug-combination functions: 
<code><a href="#topic+get.boundary.comb.kb">get.boundary.comb.kb</a>()</code>,
<code><a href="#topic+get.oc.comb.kb">get.oc.comb.kb</a>()</code>,
<code><a href="#topic+next.comb.kb">next.comb.kb</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### Drug-combination trial ###

## Select the MTD based on the data from a 3 x 5 combination trial
n &lt;- matrix(c(3, 5, 0, 0, 0,
              7, 6, 15, 0, 0,
              0, 0, 4, 0, 0), ncol=5, byrow=TRUE)
y &lt;- matrix(c(0, 1, 0, 0, 0,
              1, 1, 4, 0, 0,
              0, 0, 2, 0, 0), ncol=5, byrow=TRUE)

sel.comb &lt;- select.mtd.comb.kb(target=0.3, npts=n, ntox=y)

summary_kb(sel.comb)
plot_kb(sel.comb)

</code></pre>

<hr>
<h2 id='select.mtd.kb'>Maximum Tolerated Dose (MTD) Selection for Single-agent Trials</h2><span id='topic+select.mtd.kb'></span>

<h3>Description</h3>

<p>This function selects the maximum tolerated dose (MTD) after the single-agent trial is
completed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>select.mtd.kb(
  target,
  npts,
  ntox,
  cutoff.eli = 0.95,
  extrasafe = FALSE,
  offset = 0.05
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="select.mtd.kb_+3A_target">target</code></td>
<td>
<p>The target dose-limiting toxicity (DLT) rate.</p>
</td></tr>
<tr><td><code id="select.mtd.kb_+3A_npts">npts</code></td>
<td>
<p>A vector containing the number of patients treated at each dose level.</p>
</td></tr>
<tr><td><code id="select.mtd.kb_+3A_ntox">ntox</code></td>
<td>
<p>A vector containing the number of patients at each dose level who experienced a DLT at each dose level.</p>
</td></tr>
<tr><td><code id="select.mtd.kb_+3A_cutoff.eli">cutoff.eli</code></td>
<td>
<p>The cutoff to eliminate an overly toxic dose and all
higher doses for safety.<br />
The default value is 0.95.</p>
</td></tr>
<tr><td><code id="select.mtd.kb_+3A_extrasafe">extrasafe</code></td>
<td>
<p>Set <code>extrasafe=TRUE</code> to impose a stricter
stopping rule.<br />
The default is FALSE.</p>
</td></tr>
<tr><td><code id="select.mtd.kb_+3A_offset">offset</code></td>
<td>
<p>A small positive number (between 0 and 0.5) to control how
strict the stopping rule is when <code>extrasafe=TRUE</code>. A
larger value leads to a stricter stopping rule.<br />
The default value is 0.05.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Keyboard design starts by specifying a target toxicity interval
(referred to as the &quot;target key&quot;) such that any dose with a toxicity
probability within that interval can be practically viewed as the MTD.
Based on this interval's width, the Keyboard design forms a series of
equally wide keys that span the rest of range from 0 to 1.
</p>
<p>This function selects the MTD based on isotonic estimates of toxicity
probabilities, selecting dose level <code class="reqn">j*</code> for which the isotonic estimate
of the DLT rate is closest to the target. If there are ties, then we select from
the ties the highest dose level when the estimate of the DLT rate is smaller
than the target, or the lowest dose level when the estimate of the DLT rate
is greater than the target. The isotonic estimates are obtained by applying the
pooled-adjacent-violators algorithm (PAVA) [Barlow, 1972].
</p>
<p>For some applications, investigators may prefer a stricter stopping rule
to ensure the lowest dose is not overly toxic. This can be achieved
by setting <code>extrasafe=TRUE</code>, which imposes the following stricter
safety stopping rule:<br />
Stop the trial if <br />
(i) the number of patients treated at the lowest dose <code class="reqn">\ge 3</code>, and <br />
(ii) </p>
<p style="text-align: center;"><code class="reqn">Pr((toxicity rate of the lowest dose &gt; target) | data)
           &gt; cutoff.eli - offset</code>
</p>

<p>As a tradeoff, the strong stopping rule will decrease the MTD selection
percentage when the lowest dose actually is the MTD.
</p>


<h3>Value</h3>

<p>The function returns a list with: <br />
</p>

<ol>
<li><p> the target toxicity probability (<code>$target</code>),<br />
</p>
</li>
<li><p> the selected MTD (<code>$MTD</code>),<br />
</p>
</li>
<li><p> the isotonic estimates of the DLT probability at each dose and corresponding <code>95%</code> credible interval (<code>$p_est</code>),<br />
</p>
</li>
<li><p> the probability of overdosing defined as<br />
<code class="reqn">Pr(toxicity &gt; target | data)</code> (<code>$p_overdose</code>).
</p>
</li></ol>



<h3>Note</h3>

<p>The MTD selection and dose escalation/de-escalation rules are two
independent components of the trial design. When appropriate, another dose
selection procedure (e.g., one based on a fitted logistic model) can be used
to select the MTD after completing the trial using the Keyboard design.
</p>


<h3>Author(s)</h3>

<p>Xiaomeng Yuan, Chen Li, Hongying Sun, Li Tang and Haitao Pan
</p>


<h3>References</h3>

<p>Yan F, Mandrekar SJ, Yuan Y. Keyboard: A Novel Bayesian Toxicity Probability
Interval Design for Phase I Clinical Trials.
<em>Clinical Cancer Research</em>. 2017; 23:3994-4003.
http://clincancerres.aacrjournals.org/content/23/15/3994.full-text.pdf
</p>


<h3>See Also</h3>

<p>Other single-agent functions: 
<code><a href="#topic+get.boundary.kb">get.boundary.kb</a>()</code>,
<code><a href="#topic+get.oc.kb">get.oc.kb</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### Single-agent trial ###

n &lt;- c(3, 3, 15, 9, 0)
y &lt;- c(0, 0, 4, 4, 0)

selmtd &lt;- select.mtd.kb(target=0.3, npts=n, ntox=y)

selmtd

</code></pre>

<hr>
<h2 id='select.obd.kb'>Select the Optimal Biological Dose (OBD) for Single-agent Phase I/II Trials</h2><span id='topic+select.obd.kb'></span>

<h3>Description</h3>

<p>This function selects the optimal biological dose (OBD) at the end of a single-agent phase I/II trial.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>select.obd.kb(
  target.toxicity,
  target.efficacy,
  npts,
  ntox,
  neff,
  p1 = 0.15,
  p2 = 0.4,
  q1 = 0.3,
  q2 = 0.6,
  cutoff.eli.toxicity = 0.95,
  cutoff.eli.efficacy = 0.3,
  w1.toxicity = 0.33,
  w2.toxicity = 1.09,
  indicator = target.toxicity
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="select.obd.kb_+3A_target.toxicity">target.toxicity</code></td>
<td>
<p>The target dose-limiting toxicity (DLT) rate.</p>
</td></tr>
<tr><td><code id="select.obd.kb_+3A_target.efficacy">target.efficacy</code></td>
<td>
<p>The target efficacy rate.</p>
</td></tr>
<tr><td><code id="select.obd.kb_+3A_npts">npts</code></td>
<td>
<p>The vector containing the total number of patients treated at each dose level.</p>
</td></tr>
<tr><td><code id="select.obd.kb_+3A_ntox">ntox</code></td>
<td>
<p>The vector containing the number of subjects who experienced toxicities at each dose level.</p>
</td></tr>
<tr><td><code id="select.obd.kb_+3A_neff">neff</code></td>
<td>
<p>The vector containing the number of subjects who experienced efficacies at each dose level.</p>
</td></tr>
<tr><td><code id="select.obd.kb_+3A_p1">p1</code></td>
<td>
<p>The cutoff lower limit for safety utility function 1, described in the Details section.</p>
</td></tr>
<tr><td><code id="select.obd.kb_+3A_p2">p2</code></td>
<td>
<p>The cutoff upper limit for safety utility function 1, described in the Details section.</p>
</td></tr>
<tr><td><code id="select.obd.kb_+3A_q1">q1</code></td>
<td>
<p>The cutoff lower limit for efficacy utility function 1, described in the Details section.</p>
</td></tr>
<tr><td><code id="select.obd.kb_+3A_q2">q2</code></td>
<td>
<p>The cutoff upper limit for efficacy utility function 1, described in the Details section.</p>
</td></tr>
<tr><td><code id="select.obd.kb_+3A_cutoff.eli.toxicity">cutoff.eli.toxicity</code></td>
<td>
<p>The cutoff value to eliminate a dose with unacceptable high toxicity for safety.
The default value is 0.95.</p>
</td></tr>
<tr><td><code id="select.obd.kb_+3A_cutoff.eli.efficacy">cutoff.eli.efficacy</code></td>
<td>
<p>The cutoff value for futility rule, the acceptable lowest efficacy.
The default value is 0.3.</p>
</td></tr>
<tr><td><code id="select.obd.kb_+3A_w1.toxicity">w1.toxicity</code></td>
<td>
<p>The weight for toxicity utility function 2 and 3, described in the Details section.</p>
</td></tr>
<tr><td><code id="select.obd.kb_+3A_w2.toxicity">w2.toxicity</code></td>
<td>
<p>The weight for toxicity utility function 3, described in the Details section.</p>
</td></tr>
<tr><td><code id="select.obd.kb_+3A_indicator">indicator</code></td>
<td>
<p>The indicator cutoff value for utility function 3, described in the Details section.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>select.obd.kb()</code> selects the OBD that is the most desirable based on benefit-risk tradeoff considering both toxicity and efficacy outcomes.  A utility score is used to quantify the desirability of all admissible doses. Calculation of utility scores requires the posterior probabilities for toxicity <code class="reqn">p_i</code> and efficacy <code class="reqn">q_i</code>, which can be computed by using <code class="reqn">beta(\alpha_p + x_i,\beta_p + n_i - x_i)</code> and <code class="reqn">beta(\alpha_q + y_i,\beta_q + n_i - y_i) </code> assuming that the prior for both <code class="reqn">p_i</code> and <code class="reqn">q_i</code> follows independent beta distributions <code class="reqn">beta(\alpha_p,\beta_p)</code> and <code class="reqn">beta(\alpha_q,\beta_q)</code>. Three criteria are used to calculate the desirability in this function.
</p>
<p>The first criterion relies on a utility function for toxicity <code class="reqn">f_1(p)</code>, where p denotes the toxicity rate, and on a utility function for efficacy <code class="reqn">f_2(q)</code>, where q denotes the efficacy rate. <code class="reqn">f_1(p)</code> is 1 if <code class="reqn">p \in [0, p1)</code>; <code class="reqn">f_1(p)</code> is 0 if <code class="reqn">p \in [p2, 1]</code>; <code class="reqn">f_1(p)</code> is <code class="reqn">1- (p-p1)/(p2-p1)</code> if <code class="reqn">p \in [p1, p2)</code>. <code class="reqn">f_2(p)</code> is 1 if <code class="reqn">p \in (0, p1)</code>. Here, p1 is the cutoff lower limit and p2 is the cutoff upper limit for safety utility function 1<code class="reqn">f_1(p)</code>.
</p>
<p>Similarly, <code class="reqn">f_2(q)</code> is 1 if <code class="reqn">p \in [0, q1)</code>; <code class="reqn">f_2(q)</code> is 0 if <code class="reqn">p \in [q2, 1]</code>; <code class="reqn">f_2(q)</code> is <code class="reqn">1- (p-q1)/(q2-q1)</code> if <code class="reqn">p \in [q1, q2)</code>. <code class="reqn">f_2(p)</code> is 1 if <code class="reqn">p \in (0, q1)</code>. Here, q1 is the cutoff lower limit and q2 is the cutoff upper limit for safety utility function <code class="reqn">f_2(q)</code>.
</p>
<p>The utility score that quantifies benefit-risk tradeoff at the current dose i is calculated as follows:
</p>
<p style="text-align: center;"><code class="reqn"> U(p_i, q_i) =f_1(p) * f_2(q) </code>
</p>

<p>The second criterion depends on a marginal toxicity probability <code class="reqn">\pi_{T,i} = beta(\alpha_p + x_i,\beta_p + n_i - x_i) </code> and a marginal efficacy probability <code class="reqn">\pi_{E,i} = beta(\alpha_q + y_i,\beta_q + n_i - y_i) </code>.  Then the utility score is calculated as follows:
</p>
<p style="text-align: center;"><code class="reqn">U_i= \pi_{E,i} - w_1*\pi_{T,i} </code>
</p>

<p>The third criterion also depends on a marginal toxicity probability <code class="reqn">\pi_{T,i} = beta(\alpha_p + x_i,\beta_p + n_i - x_i) </code> and a marginal efficacy probability <code class="reqn">\pi_{E,i} = beta(\alpha_q + y_i,\beta_q + n_i - y_i) </code>, but it has an additional penalty when the posterior toxicity probability is high by using an indicator function.  Then utility score using this function is calculated as follows:
</p>
<p style="text-align: center;"><code class="reqn">U_j= \pi_{E,i} - w_1*\pi_{T,i}-w_2*\pi_{T,i}*I(\pi_{T,i}&gt;\rho)</code>
</p>

<p>Here, the recommended <code class="reqn">\rho</code> is the target toxicity rate.
</p>
<p>Once the utility score is computed for all the doses, the optimal biological dose is calculated as follows:
</p>
<p style="text-align: center;"><code class="reqn"> d = argmax_i[ U(p_i, q_i) | D]</code>
</p>



<h3>Value</h3>

<p><code>select.obd.kb()</code> returns the selected dose: <br />
</p>

<ol>
<li><p> Selected OBD level using utility function 1 (<code>$obd1</code>), as described in the Details section. <br />
</p>
</li>
<li><p> Selected OBD level using utility function 2 (<code>$obd2</code>), as described in the Details section.  <br />
</p>
</li>
<li><p> Selected OBD level using utility function 3 (<code>$obd3</code>), as described in the Details section.
</p>
</li></ol>



<h3>Author(s)</h3>

<p>Xiaomeng Yuan, Chen Li, Hongying Sun, Li Tang and Haitao Pan
</p>


<h3>References</h3>

<p>Li DH, Whitmore JB, Guo W, Ji Y.  Toxicity and efficacy probability interval design for phase I adoptive cell therapy dose-finding clinical trials.
<em>Clinical Cancer Research</em>. 2017; 23:13-20.
https://clincancerres.aacrjournals.org/content/23/1/13.long
</p>
<p>Liu S, Johnson VE.  A robust Bayesian dose-finding design for phase I/II clinical trials. <em>Biostatistics</em>. 2016; 17(2):249-63.
https://academic.oup.com/biostatistics/article/17/2/249/1744018
</p>
<p>Zhou Y, Lee JJ, Yuan Y. A utility-based Bayesian optimal interval (U-BOIN) phase I/II design to identify the optimal biological dose for targeted and immune therapies.
<em>Statistics in Medicine</em>. 2019; 38:S5299-5316.
https://onlinelibrary.wiley.com/doi/epdf/10.1002/sim.8361
</p>


<h3>See Also</h3>

<p>Other single-agent phase I/II functions: 
<code><a href="#topic+get.decision.obd.kb">get.decision.obd.kb</a>()</code>,
<code><a href="#topic+get.decision.obd2.kb">get.decision.obd2.kb</a>()</code>,
<code><a href="#topic+get.oc.obd.kb">get.oc.obd.kb</a>()</code>,
<code><a href="#topic+get.oc.obd2.kb">get.oc.obd2.kb</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
target.toxicity&lt;-0.3
target.efficacy&lt;-0.4
npts &lt;- c(3,6,12,3,3)
ntox &lt;-  c(1,2,4,2,3)
neff &lt;-  c(0,0,5,1,1)
obd &lt;- select.obd.kb (target.toxicity=target.toxicity,
       target.efficacy= target.efficacy, npts = npts,
       ntox = ntox, neff =  neff)
print(obd)


</code></pre>

<hr>
<h2 id='summary_kb'>Summarize Objects Generated by the Keyboard Design Package</h2><span id='topic+summary_kb'></span>

<h3>Description</h3>

<p>This function generates a descriptive summary for objects returned by other functions.<br />
</p>


<h3>Usage</h3>

<pre><code class='language-R'>summary_kb(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary_kb_+3A_object">object</code></td>
<td>
<p>The object (returned by another function) to be described.</p>
</td></tr>
<tr><td><code id="summary_kb_+3A_...">...</code></td>
<td>
<p>Ignored arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Unpacks objects returned by other functions with descriptions of
their results. The following functions are supported:<br />
(1) get.oc.kb(), get.oc.comb.kb(), get.oc.obd.kb(), and get.oc.obd2.kb(), which yield the operating
characteristics of trials simulated using the Keyboard design.<br />
(2) select.mtd.kb() and select.mtd.comb.kb(), which yield the MTD and other
statistics.<br />
(3) next.comb.kb(), which indicates the dose combination to administer to
the next cohort. <br />
(4) select.obd.kb(), which yields the OBD.
</p>


<h3>Value</h3>

<p>This function helps users to interpret the objects returned by other
Keyboard package functions.
</p>


<h3>Author(s)</h3>

<p>Xiaomeng Yuan, Chen Li, Hongying Sun, Li Tang and Haitao Pan
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot_kb">plot_kb</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
### Single-agent trial ###

## Summarize the object returned by get.oc.kb()
oc.single &lt;- get.oc.kb(target=0.3, p.true=c(0.05, 0.15, 0.3, 0.45, 0.6),
                       ncohort=10, cohortsize=3, ntrial=1000)
summary_kb(oc.single)


## Summarize the object returned by select.mtd.kb()
n &lt;- c(3, 3, 15, 9, 0)
y &lt;- c(0, 0, 4, 4, 0)
sel.single &lt;- select.mtd.kb(target=0.3, npts=n, ntox=y)
summary_kb(sel.single)



## Summarize the object returned by select.mtd.comb.kb()
n &lt;- matrix(c(6, 3, 0, 0,
              6, 24, 9, 0,
              0, 0, 0, 0), ncol=4, byrow=TRUE)
y &lt;- matrix(c(0, 0, 0, 0,
              1, 5, 4, 0,
              0, 0, 0, 0), ncol=4, byrow=TRUE)
sel.comb &lt;- select.mtd.comb.kb(target=0.25, npts=n, ntox=y)
summary_kb(sel.comb)


## Summarize the object returned by next.comb.kb()
n &lt;- matrix(c(3, 0, 0, 0,
              0, 0, 0, 0,
              0, 0, 0, 0), ncol=4, byrow=TRUE)
y &lt;- matrix(c(0, 0, 0, 0,
              0, 0, 0, 0,
              0, 0, 0, 0), ncol=4, byrow=TRUE)
nxt.comb &lt;- next.comb.kb(target=0.25, npts=n, ntox=y, dose.curr=c(1, 1))
summary_kb(nxt.comb)

## get.oc.obd
toxicity.low &lt;- 0.15
toxicity.moderate &lt;- 0.25
toxicity.high &lt;- 0.35
efficacy.low &lt;- 0.25
efficacy.moderate &lt;- 0.45
efficacy.high &lt;- 0.65
target.toxicity&lt;-0.20
target.efficacy&lt;-0.40
p.true &lt;-c(0.08,0.20,0.60,0.80)
q.true &lt;- c(0.25,0.40,0.25,0.50)
oc.obd.kb &lt;- get.oc.obd.kb(toxicity.low = toxicity.low,
             toxicity.moderate= toxicity.moderate,
             toxicity.high = toxicity.high,
             efficacy.low = efficacy.low,
             efficacy.moderate = efficacy.moderate,
             efficacy.high = efficacy.high,
             target.toxicity=target.toxicity,
             target.efficacy= target.efficacy,
             p.true= p.true, q.true= q.true)
summary_kb(oc.obd.kb)

## OBD selection
target.toxicity&lt;-0.3
target.efficacy&lt;-0.4
npts &lt;- c(3,6,12,3,3)
ntox &lt;-  c(1,2,4,2,3)
neff &lt;-  c(0,0,5,1,1)
obd &lt;- select.obd.kb (target.toxicity=target.toxicity,
       target.efficacy= target.efficacy, npts = npts,
       ntox = ntox, neff =  neff)
summary_kb(obd)


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
