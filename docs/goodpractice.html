<!DOCTYPE html><html><head><title>Help for package goodpractice</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {goodpractice}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#all_checks'><p>List the names of all checks</p></a></li>
<li><a href='#checks'><p>List all checks performed</p></a></li>
<li><a href='#customization'><p>Defining custom preparations and checks</p></a></li>
<li><a href='#default_r_file_pattern'><p>Default pattern for R files</p></a></li>
<li><a href='#export_json'><p>Export failed checks to JSON</p></a></li>
<li><a href='#failed_checks'><p>Names of the failed checks</p></a></li>
<li><a href='#failed_positions'><p>Positions of check failures in the source code</p></a></li>
<li><a href='#get_marker'><p>Get a marker from the positions of a check</p></a></li>
<li><a href='#goodpractice-package'><p>goodpractice: Advice on R Package Building</p></a></li>
<li><a href='#gp'><p>Run good practice checks</p></a></li>
<li><a href='#make_rcmd_check'><p>Wrapper on make_check, specific to R CMD check</p></a></li>
<li><a href='#package_collate'><p><code>Collate</code> field from <code>DESCRIPTION</code></p></a></li>
<li><a href='#prep_expressions'><p>Extract all closures from a package</p></a></li>
<li><a href='#print.goodPractice'><p>Print goodpractice results</p></a></li>
<li><a href='#r_package_files'><p>Get all source files of a package, in the right order</p></a></li>
<li><a href='#results'><p>Return all check results in a data frame</p></a></li>
<li><a href='#seq_linter'><p>Find dangerous 1:x expressions</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Advice on R Package Building</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.4</td>
</tr>
<tr>
<td>Description:</td>
<td>Give advice about good practices when building R packages.
    Advice includes functions and syntax to avoid, package structure, code
    complexity, code formatting, etc.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/mangothecat/goodpractice">https://github.com/mangothecat/goodpractice</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/mangothecat/goodpractice/issues">https://github.com/mangothecat/goodpractice/issues</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>clisymbols, covr, crayon, cyclocomp (&ge; 1.1.0), desc,
jsonlite, lintr (&ge; 3.0.0), praise, rcmdcheck, rstudioapi,
tools, utils, whoami, withr, xml2, xmlparsedata (&ge; 1.0.1)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Collate:</td>
<td>'api.R' 'customization.R' 'lists.R' 'chk_covr.R'
'chk_cyclocomp.R' 'chk_description.R' 'chk_lintr.R'
'chk_namespace.R' 'chk_rcmdcheck.R' 'chk_tnf.R' 'gp.R'
'my_linters.R' 'package.R' 'prep_covr.R' 'prep_cyclocomp.R'
'prep_description.R' 'prep_expressions.R' 'prep_lintr.R'
'prep_namespace.R' 'prep_rcmdcheck.R' 'print.R'
'rstudio_markers.R' 'utils.R'</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-08-30 16:06:25 UTC; ana.simmons</td>
</tr>
<tr>
<td>Author:</td>
<td>Ascent Digital Services UK Limited [cph] (MangoTheCat),
  Karina Marks [aut, cre] (KarinaMarks),
  Daniel de Bortoli [aut] (ddbortoli),
  Gabor Csardi [aut],
  Hannah Frick [aut],
  Owen Jones [aut] (owenjonesuob),
  Hannah Alexander [aut],
  Ana Simmons [ctb] (anasimmons),
  Fabian Scheipl [ctb] (fabian-s)</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Karina Marks &lt;karina.marks@ascent.io&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-08-30 19:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='all_checks'>List the names of all checks</h2><span id='topic+all_checks'></span>

<h3>Description</h3>

<p>List the names of all checks
</p>


<h3>Usage</h3>

<pre><code class='language-R'>all_checks()
</code></pre>


<h3>Value</h3>

<p>Character vector of checks
</p>

<hr>
<h2 id='checks'>List all checks performed</h2><span id='topic+checks'></span>

<h3>Description</h3>

<p>List all checks performed
</p>


<h3>Usage</h3>

<pre><code class='language-R'>checks(gp)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="checks_+3A_gp">gp</code></td>
<td>
<p><code><a href="#topic+gp">gp</a></code> output.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Character vector of check names.
</p>


<h3>See Also</h3>

<p>Other API: 
<code><a href="#topic+failed_checks">failed_checks</a>()</code>,
<code><a href="#topic+results">results</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>path &lt;- system.file("bad1", package = "goodpractice")
# run a subset of all checks available
g &lt;- gp(path, checks = all_checks()[3:16])
checks(g)
</code></pre>

<hr>
<h2 id='customization'>Defining custom preparations and checks</h2><span id='topic+customization'></span><span id='topic+make_prep'></span><span id='topic+make_check'></span>

<h3>Description</h3>

<p>Defining custom preparations and checks
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_prep(name, func)

make_check(description, check, gp, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="customization_+3A_name">name</code></td>
<td>
<p>Name of the preparation function.</p>
</td></tr>
<tr><td><code id="customization_+3A_func">func</code></td>
<td>
<p>A function that takes two arguments:
The <code>path</code> to the root directory of the package, and a logical
argument: <code>quiet</code>. If <code>quiet</code> is true, the preparation function
may print out diagnostic messages. The output of this function will be
saved as the &quot; <code>name</code>&quot; entry of <code>state</code>, i.e. of the input for
the  <code>check</code>-functions (see example).</p>
</td></tr>
<tr><td><code id="customization_+3A_description">description</code></td>
<td>
<p>A description of the check.</p>
</td></tr>
<tr><td><code id="customization_+3A_check">check</code></td>
<td>
<p>A function that takes the <code>state</code> as an argument.</p>
</td></tr>
<tr><td><code id="customization_+3A_gp">gp</code></td>
<td>
<p>A short description of what is good practice.</p>
</td></tr>
<tr><td><code id="customization_+3A_...">...</code></td>
<td>
<p>Further arguments. Most important: A <code>preps</code> argument that
contains the names of all the preparation functions required for the check.</p>
</td></tr>
</table>


<h3>Functions</h3>


<ul>
<li> <p><code>make_prep</code>: Create a preparation function
</p>
</li>
<li> <p><code>make_check</code>: Create a check function
</p>
</li></ul>


<h3>Examples</h3>

<pre><code class='language-R'># make a preparation function
url_prep &lt;- make_prep(
  name = "desc", 
  func = function(path, quiet) desc::description$new(path)
)
# and the corresponding check function
url_chk &lt;- make_check(
  description = "URL field in DESCRIPTION",
  tags = character(),
  preps = "desc",
  gp = "have a URL field in DESCRIPTION",
  check = function(state) state$desc$has_fields("URL")
)
# use together in gp():
# (note that you have to list the name of your custom check in
# the checks-argument as well....)
bad1 &lt;- system.file("bad1", package = "goodpractice")
res &lt;- gp(bad1, checks = c("url", "no_description_depends"),
          extra_preps = list("desc" = url_prep),
          extra_checks = list("url" = url_chk))
</code></pre>

<hr>
<h2 id='default_r_file_pattern'>Default pattern for R files</h2><span id='topic+default_r_file_pattern'></span>

<h3>Description</h3>

<p>Default pattern for R files
</p>


<h3>Usage</h3>

<pre><code class='language-R'>default_r_file_pattern()
</code></pre>


<h3>Value</h3>

<p>Regular expression.
</p>

<hr>
<h2 id='export_json'>Export failed checks to JSON</h2><span id='topic+export_json'></span>

<h3>Description</h3>

<p>Export failed checks to JSON
</p>


<h3>Usage</h3>

<pre><code class='language-R'>export_json(gp, file, pretty = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="export_json_+3A_gp">gp</code></td>
<td>
<p><code><a href="#topic+gp">gp</a></code> output.</p>
</td></tr>
<tr><td><code id="export_json_+3A_file">file</code></td>
<td>
<p>Output connection or file.</p>
</td></tr>
<tr><td><code id="export_json_+3A_pretty">pretty</code></td>
<td>
<p>Whether to pretty-print the JSON.</p>
</td></tr>
</table>

<hr>
<h2 id='failed_checks'>Names of the failed checks</h2><span id='topic+failed_checks'></span>

<h3>Description</h3>

<p>Names of the failed checks
</p>


<h3>Usage</h3>

<pre><code class='language-R'>failed_checks(gp)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="failed_checks_+3A_gp">gp</code></td>
<td>
<p><code><a href="#topic+gp">gp</a></code> output.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Names of the failed checks.
</p>


<h3>See Also</h3>

<p>Other API: 
<code><a href="#topic+checks">checks</a>()</code>,
<code><a href="#topic+results">results</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>path &lt;- system.file("bad1", package = "goodpractice")
# run a subset of all checks available
g &lt;- gp(path, checks = all_checks()[3:16])
failed_checks(g)
</code></pre>

<hr>
<h2 id='failed_positions'>Positions of check failures in the source code</h2><span id='topic+failed_positions'></span>

<h3>Description</h3>

<p>Note that not all checks refer to the source code.
For these the result will be <code>NULL</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>failed_positions(gp)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="failed_positions_+3A_gp">gp</code></td>
<td>
<p><code><a href="#topic+gp">gp</a></code> output.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the ones that do, the results is a list, one for each failure.
Since the same check can fail multiple times. A single failure
is a list with entries: <code>filename</code>, <code>line_number</code>,
<code>column_number</code>, <code>ranges</code>. <code>ranges</code> is a list of
pairs of start and end positions for each line involved in the
check.
</p>


<h3>Value</h3>

<p>A list of lists of positions. See details below.
</p>

<hr>
<h2 id='get_marker'>Get a marker from the positions of a check</h2><span id='topic+get_marker'></span>

<h3>Description</h3>

<p>Get a marker from the positions of a check
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_marker(gp, check)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_marker_+3A_gp">gp</code></td>
<td>
<p><code>gp()</code> output</p>
</td></tr>
<tr><td><code id="get_marker_+3A_check">check</code></td>
<td>
<p>name of the check to extract</p>
</td></tr>
</table>

<hr>
<h2 id='goodpractice-package'>goodpractice: Advice on R Package Building</h2>

<h3>Description</h3>

<p>Give advice about good practices when building R packages. Advice includes
functions and syntax to avoid, package structure, code complexity, code
formatting, etc.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Karina Marks <a href="mailto:karina.marks@ascent.io">karina.marks@ascent.io</a> (KarinaMarks)
</p>
<p>Authors:
</p>

<ul>
<li><p> Daniel de Bortoli (ddbortoli)
</p>
</li>
<li><p> Gabor Csardi <a href="mailto:csardi.gabor@gmail.com">csardi.gabor@gmail.com</a>
</p>
</li>
<li><p> Hannah Frick <a href="mailto:hannah.frick@gmail.com">hannah.frick@gmail.com</a>
</p>
</li>
<li><p> Owen Jones <a href="mailto:owenjonesuob@gmail.com">owenjonesuob@gmail.com</a> (owenjonesuob)
</p>
</li>
<li><p> Hannah Alexander <a href="mailto:halexander@mango-solutions.com">halexander@mango-solutions.com</a>
</p>
</li></ul>

<p>Other contributors:
</p>

<ul>
<li><p> Ascent Digital Services UK Limited (MangoTheCat) [copyright holder]
</p>
</li>
<li><p> Ana Simmons <a href="mailto:ana.simmons@ascent.io">ana.simmons@ascent.io</a> (anasimmons) [contributor]
</p>
</li>
<li><p> Fabian Scheipl (fabian-s) [contributor]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/mangothecat/goodpractice">https://github.com/mangothecat/goodpractice</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/mangothecat/goodpractice/issues">https://github.com/mangothecat/goodpractice/issues</a>
</p>
</li></ul>


<hr>
<h2 id='gp'>Run good practice checks</h2><span id='topic+gp'></span><span id='topic+goodpractice'></span>

<h3>Description</h3>

<p>To see the results, just print it to the screen.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gp(
  path = ".",
  checks = all_checks(),
  extra_preps = NULL,
  extra_checks = NULL,
  quiet = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gp_+3A_path">path</code></td>
<td>
<p>Path to a package root.</p>
</td></tr>
<tr><td><code id="gp_+3A_checks">checks</code></td>
<td>
<p>Character vector, the checks to run. Defaults to
all checks. Use <code><a href="#topic+all_checks">all_checks</a></code> to list all checks.</p>
</td></tr>
<tr><td><code id="gp_+3A_extra_preps">extra_preps</code></td>
<td>
<p>Custom preparation functions. See
<code><a href="#topic+make_prep">make_prep</a></code> on creating preparation functions.</p>
</td></tr>
<tr><td><code id="gp_+3A_extra_checks">extra_checks</code></td>
<td>
<p>Custom checks. See <code><a href="#topic+make_check">make_check</a></code> on
creating checks.</p>
</td></tr>
<tr><td><code id="gp_+3A_quiet">quiet</code></td>
<td>
<p>Whether to suppress output from the preparation
functions. Note that not all preparation functions produce output,
even if this option is set to <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A goodpractice object that you can query
with a simple API. See <code><a href="#topic+results">results</a></code> to start.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>path &lt;- system.file("bad1", package = "goodpractice")
# run a subset of all checks available
g &lt;- gp(path, checks = all_checks()[3:16])
g
</code></pre>

<hr>
<h2 id='make_rcmd_check'>Wrapper on make_check, specific to R CMD check</h2><span id='topic+make_rcmd_check'></span>

<h3>Description</h3>

<p>Wrapper on make_check, specific to R CMD check
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_rcmd_check(
  description,
  pattern,
  gp = NULL,
  type = c("warnings", "notes", "errors"),
  tags = NULL,
  preps = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="make_rcmd_check_+3A_description">description</code></td>
<td>
<p>A description of the check.</p>
</td></tr>
<tr><td><code id="make_rcmd_check_+3A_pattern">pattern</code></td>
<td>
<p>The text pattern identifying the check.</p>
</td></tr>
<tr><td><code id="make_rcmd_check_+3A_type">type</code></td>
<td>
<p>Type of notification, one of &quot;warnings&quot;, &quot;notes&quot; or &quot;errors&quot;.</p>
</td></tr>
<tr><td><code id="make_rcmd_check_+3A_tags">tags</code></td>
<td>
<p>Tags to be passed on to make_check.</p>
</td></tr>
<tr><td><code id="make_rcmd_check_+3A_preps">preps</code></td>
<td>
<p>Preps to be passed on to make_check.</p>
</td></tr>
<tr><td><code id="make_rcmd_check_+3A_...">...</code></td>
<td>
<p>Currently not supported.</p>
</td></tr>
</table>

<hr>
<h2 id='package_collate'><code>Collate</code> field from <code>DESCRIPTION</code></h2><span id='topic+package_collate'></span>

<h3>Description</h3>

<p><code>NULL</code> is returned if there is no such field.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>package_collate(path = ".")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="package_collate_+3A_path">path</code></td>
<td>
<p>Path to the package root.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Character scalar or <code>NULL</code>.
</p>

<hr>
<h2 id='prep_expressions'>Extract all closures from a package</h2><span id='topic+prep_expressions'></span>

<h3>Description</h3>

<p>The package must be extracted into the working directory, as usual.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prep_expressions(state, version = NULL, quiet)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prep_expressions_+3A_state">state</code></td>
<td>
<p>GP state.</p>
</td></tr>
<tr><td><code id="prep_expressions_+3A_version">version</code></td>
<td>
<p>Currently ignored.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We can use lintr to extract the functions, but need to use
our own code (based on similar code in functionMap) to
get the right collation order.
</p>


<h3>Value</h3>

<p>The modified state, with the closures in a named list.
</p>

<hr>
<h2 id='print.goodPractice'>Print goodpractice results</h2><span id='topic+print.goodPractice'></span>

<h3>Description</h3>

<p>Print goodpractice results
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'goodPractice'
print(x, positions_limit = 5, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.goodPractice_+3A_x">x</code></td>
<td>
<p>Object of class <code>goodPractice</code>, as returned by <code><a href="#topic+gp">gp()</a></code>.</p>
</td></tr>
<tr><td><code id="print.goodPractice_+3A_positions_limit">positions_limit</code></td>
<td>
<p>How many positions to print at most.</p>
</td></tr>
<tr><td><code id="print.goodPractice_+3A_...">...</code></td>
<td>
<p>Unused, for compatibility with <code><a href="base.html#topic+print">base::print()</a></code> generic method.</p>
</td></tr>
</table>

<hr>
<h2 id='r_package_files'>Get all source files of a package, in the right order</h2><span id='topic+r_package_files'></span>

<h3>Description</h3>

<p>It uses the <code>Collate</code> entry in the <code>DESCRIPTION</code> file,
if there is one. Otherwise the order is alphabetical.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>r_package_files(path)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="r_package_files_+3A_path">path</code></td>
<td>
<p>Path to the root of the R package.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character vector of (relative) file
names in the current collation order.
</p>

<hr>
<h2 id='results'>Return all check results in a data frame</h2><span id='topic+results'></span>

<h3>Description</h3>

<p>Return all check results in a data frame
</p>


<h3>Usage</h3>

<pre><code class='language-R'>results(gp)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="results_+3A_gp">gp</code></td>
<td>
<p><code><a href="#topic+gp">gp</a></code> output.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame, with columns:
</p>
<table>
<tr><td><code>check</code></td>
<td>
<p>The name of the check.</p>
</td></tr>
<tr><td><code>result</code></td>
<td>
<p>Logical, whether it has failed or not.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other API: 
<code><a href="#topic+checks">checks</a>()</code>,
<code><a href="#topic+failed_checks">failed_checks</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>path &lt;- system.file("bad1", package = "goodpractice")
# run a subset of all checks available
g &lt;- gp(path, checks = all_checks()[3:16])
results(g)
</code></pre>

<hr>
<h2 id='seq_linter'>Find dangerous 1:x expressions</h2><span id='topic+seq_linter'></span>

<h3>Description</h3>

<p>Find occurrences of <code>1:length(x)</code>, <code>1:nrow(x)</code>,
<code>1:ncol(x)</code>, <code>1:NROW(x)</code>, <code>1:NCOL(x)</code> where
<code>x</code> is an R expression.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>seq_linter()
</code></pre>


<h3>Value</h3>

<p>Lint object.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
