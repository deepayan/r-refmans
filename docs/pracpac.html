<!DOCTYPE html><html lang="en"><head><title>Help for package pracpac</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {pracpac}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#pracpac-package'><p>pracpac: Practical 'R' Packaging in 'Docker'</p></a></li>
<li><a href='#+25+26gt+3B+25'><p>Pipe operator</p></a></li>
<li><a href='#add_assets'><p>Add assets for the specified use case</p></a></li>
<li><a href='#add_dockerfile'><p>Add a Dockerfile to the docker directory</p></a></li>
<li><a href='#build_image'><p>Build a Docker image</p></a></li>
<li><a href='#build_pkg'><p>Build a package tar.gz</p></a></li>
<li><a href='#create_docker_dir'><p>Create Docker directory</p></a></li>
<li><a href='#handle_use_case'><p>Handle the use case</p></a></li>
<li><a href='#pkg_info'><p>Get information about the current package</p></a></li>
<li><a href='#pkg_root'><p>Find package root</p></a></li>
<li><a href='#renv_deps'><p>Get dependencies using renv</p></a></li>
<li><a href='#use_docker'><p>Use docker packaging tools</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Practical 'R' Packaging in 'Docker'</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Streamline the creation of 'Docker' images with 'R' packages and dependencies embedded. The 'pracpac' package provides a 'usethis'-like interface to creating Dockerfiles with dependencies managed by 'renv'. The 'pracpac' functionality is described in Nagraj and Turner (2023) &lt;<a href="https://doi.org/10.48550%2FarXiv.2303.07876">doi:10.48550/arXiv.2303.07876</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Imports:</td>
<td>magrittr, glue, fs, rprojroot, renv, pkgbuild</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>rmarkdown, knitr, testthat (&ge; 3.0.0), withr</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://signaturescience.github.io/pracpac/">https://signaturescience.github.io/pracpac/</a>,
<a href="https://github.com/signaturescience/pracpac/">https://github.com/signaturescience/pracpac/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/signaturescience/pracpac/issues">https://github.com/signaturescience/pracpac/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-06-17 00:03:12 UTC; vpnagraj</td>
</tr>
<tr>
<td>Author:</td>
<td>Stephen Turner <a href="https://orcid.org/0000-0001-9140-9028"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  VP Nagraj <a href="https://orcid.org/0000-0003-0060-566X"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [cre,
    aut],
  Signature Science, LLC. [cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>VP Nagraj &lt;nagraj@nagraj.net&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-06-18 22:40:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='pracpac-package'>pracpac: Practical 'R' Packaging in 'Docker'</h2><span id='topic+pracpac'></span><span id='topic+pracpac-package'></span>

<h3>Description</h3>

<p><img src="../help/figures/logo.png" style='float: right' alt='logo' width='120' />
</p>
<p>Streamline the creation of 'Docker' images with 'R' packages and dependencies embedded. The 'pracpac' package provides a 'usethis'-like interface to creating Dockerfiles with dependencies managed by 'renv'. The 'pracpac' functionality is described in Nagraj and Turner (2023) doi: <a href="https://doi.org/10.48550/arXiv.2303.07876">10.48550/arXiv.2303.07876</a>.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: VP Nagraj <a href="mailto:nagraj@nagraj.net">nagraj@nagraj.net</a> (<a href="https://orcid.org/0000-0003-0060-566X">ORCID</a>)
</p>
<p>Authors:
</p>

<ul>
<li><p> Stephen Turner (<a href="https://orcid.org/0000-0001-9140-9028">ORCID</a>)
</p>
</li></ul>

<p>Other contributors:
</p>

<ul>
<li><p> Signature Science, LLC. [copyright holder]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://signaturescience.github.io/pracpac/">https://signaturescience.github.io/pracpac/</a>
</p>
</li>
<li> <p><a href="https://github.com/signaturescience/pracpac/">https://github.com/signaturescience/pracpac/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/signaturescience/pracpac/issues">https://github.com/signaturescience/pracpac/issues</a>
</p>
</li></ul>


<hr>
<h2 id='+25+26gt+3B+25'>Pipe operator</h2><span id='topic++25+3E+25'></span>

<h3>Description</h3>

<p>See <code>magrittr::<a href="magrittr.html#topic+pipe">%&gt;%</a></code> for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lhs %&gt;% rhs
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_lhs">lhs</code></td>
<td>
<p>A value or the magrittr placeholder.</p>
</td></tr>
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_rhs">rhs</code></td>
<td>
<p>A function call using the magrittr semantics.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The result of calling <code>rhs(lhs)</code>.
</p>

<hr>
<h2 id='add_assets'>Add assets for the specified use case</h2><span id='topic+add_assets'></span>

<h3>Description</h3>

<p>Add template assets for the use case specified in <a href="#topic+add_dockerfile">add_dockerfile</a> or <a href="#topic+use_docker">use_docker</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_assets(
  pkg_path = ".",
  img_path = NULL,
  use_case = "default",
  overwrite = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="add_assets_+3A_pkg_path">pkg_path</code></td>
<td>
<p>Path to the package directory. Default is <code>"."</code> for the current working directory, which assumes developer is working in R package root. However, this can be set to another path as needed.</p>
</td></tr>
<tr><td><code id="add_assets_+3A_img_path">img_path</code></td>
<td>
<p>Path to the write the docker image definition contents. The default <code>NULL</code> will use <code style="white-space: pre;">&#8288;docker/&#8288;</code> as a subdirectory of the <code>pkg_path</code>.</p>
</td></tr>
<tr><td><code id="add_assets_+3A_use_case">use_case</code></td>
<td>
<p>Name of the use case. Defaults to <code>"default"</code>, which only uses the base boilerplate.</p>
</td></tr>
<tr><td><code id="add_assets_+3A_overwrite">overwrite</code></td>
<td>
<p>Logical; should existing assets should be overwritten? Default is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Example #1: the <code>"shiny"</code> use case requires than an <code>app.R</code> file moved into
<code style="white-space: pre;">&#8288;/srv/shiny-server/&#8288;</code> in the container image. Using <code>add_assets(use_case="shiny")</code>
(or when using the <code>"shiny"</code> use case in <a href="#topic+add_dockerfile">add_dockerfile</a> or <a href="#topic+use_docker">use_docker</a>)
will create a placeholder <code>assets/app.R</code> in the <code style="white-space: pre;">&#8288;docker/&#8288;</code> directory. The
Dockerfile for the <code>"shiny"</code> use case will place <code style="white-space: pre;">&#8288;COPY assets/app.R/srv/shiny-server&#8288;</code> into the Dockerfile.
</p>
<p>Example #2: the <code>"pipeline"</code> use case creates boilerplate for moving pre- and
post-processing R and shell scripts into the container at
<code>add_assets(use_case="pipeline")</code> (or when using the <code>"pipeline"</code> use case in
<a href="#topic+add_dockerfile">add_dockerfile</a> or <a href="#topic+use_docker">use_docker</a>) will create a placeholder <code>assets/pre.R</code>,
<code>assets/post.R</code>, and <code>assets/run.sh</code> into the <code>docker/assets</code> directory. The
Dockerfile for the <code>"pipeline"</code> use case will place <code style="white-space: pre;">&#8288;COPY assets/run.sh /run.sh&#8288;</code> into the Dockerfile.
</p>
<p>This function is run as part of <a href="#topic+use_docker">use_docker</a> but can be used on its own.
</p>
<p>See <code>vignette("use-cases", package="pracpac")</code> for details on use cases.
</p>


<h3>Value</h3>

<p>Invisibly returns assets per <a href="#topic+handle_use_case">handle_use_case</a>. Called primarily for its side effects.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

# Specify path to example package source and copy to tempdir()
# Note that in practice you do not need to copy to a tempdir()
# And in fact it may be easiest to use pracpac relative to your package directory root
ex_pkg_src &lt;- system.file("hellow", package = "pracpac", mustWork = TRUE)
file.copy(from = ex_pkg_src, to = tempdir(), recursive = TRUE)

# Add assets for shiny use case
add_assets(pkg_path = file.path(tempdir(), "hellow"), use_case="shiny")
# Add assets for pipeline use case
add_assets(pkg_path = file.path(tempdir(), "hellow"), use_case="pipeline")

## End(Not run)
</code></pre>

<hr>
<h2 id='add_dockerfile'>Add a Dockerfile to the docker directory</h2><span id='topic+add_dockerfile'></span>

<h3>Description</h3>

<p>Adds a Dockerfile to the docker directory created by <a href="#topic+create_docker_dir">create_docker_dir</a>.
Allows for specification of several preset use cases, whether or not use use
renv to manage dependencies, and optional overriding the base image.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_dockerfile(
  pkg_path = ".",
  img_path = NULL,
  use_renv = TRUE,
  use_case = "default",
  base_image = NULL,
  repos = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="add_dockerfile_+3A_pkg_path">pkg_path</code></td>
<td>
<p>Path to the package directory. Default is <code>"."</code> for the current working directory, which assumes developer is working in R package root. However, this can be set to another path as needed.</p>
</td></tr>
<tr><td><code id="add_dockerfile_+3A_img_path">img_path</code></td>
<td>
<p>Path to the write the docker image definition contents. The default <code>NULL</code> will use <code style="white-space: pre;">&#8288;docker/&#8288;</code> as a subdirectory of the <code>pkg_path</code>.</p>
</td></tr>
<tr><td><code id="add_dockerfile_+3A_use_renv">use_renv</code></td>
<td>
<p>Logical; use renv? Defaults to <code>TRUE</code>. If <code>FALSE</code>, package dependencies are scraped from the <code>DESCRIPTION</code> file and the most recent versions will be installed in the image.</p>
</td></tr>
<tr><td><code id="add_dockerfile_+3A_use_case">use_case</code></td>
<td>
<p>Name of the use case. Defaults to <code>"default"</code>, which only uses the base boilerplate. See <code>vignette("use-cases", package="pracpac")</code> for other use cases (e.g., <code>shiny</code>, <code>rstudio</code>, <code>pipeline</code>).</p>
</td></tr>
<tr><td><code id="add_dockerfile_+3A_base_image">base_image</code></td>
<td>
<p>Name of the base image to start <code>FROM</code>. Default is <code>NULL</code> and the base image will be derived based on <code>use_case.</code> Optionally override this by setting the name of the base image (including tag if desired).</p>
</td></tr>
<tr><td><code id="add_dockerfile_+3A_repos">repos</code></td>
<td>
<p>Option to override the repos used for installing packages with <code>renv</code> by passing name of repository. Only used if <code>use_renv = TRUE</code>. Default is <code>NULL</code> meaning that the repos specified in <code>renv</code> lockfile will remain as-is and not be overridden.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is run as part of <a href="#topic+use_docker">use_docker</a> but can be used on its own.
</p>
<p>See <code>vignette("use-cases", package="pracpac")</code> for details on use cases.
</p>


<h3>Value</h3>

<p>Invisibly returns a list of package info returned by <a href="#topic+pkg_info">pkg_info</a>. Primarily called for side-effect to create Dockerfile.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

# Specify path to example package source and copy to tempdir()
# Note that in practice you do not need to copy to a tempdir()
# And in fact it may be easiest to use pracpac relative to your package directory root
ex_pkg_src &lt;- system.file("hellow", package = "pracpac", mustWork = TRUE)
file.copy(from = ex_pkg_src, to = tempdir(), recursive = TRUE)

# Default: FROM rocker/r-ver:latest with no additional template
# By default add_dockerfile requires you either to specify use_renv = FALSE
# Or run renv_deps() prior to add_dockerfile()
# The use_docker() wrapper runs these sequentially, and is recommended for most usage
add_dockerfile(pkg_path = file.path(tempdir(), "hellow"), use_renv = FALSE)
# Specify tidyverse base image
renv_deps(pkg_path = file.path(tempdir(), "hellow"))
add_dockerfile(pkg_path = file.path(tempdir(), "hellow"), base_image="rocker/tidyverse:4.2.2")
# Specify different default repo
add_dockerfile(pkg_path = file.path(tempdir(), "hellow"), repos="https://cran.wustl.edu/")
# RStudio template
add_dockerfile(pkg_path = file.path(tempdir(), "hellow"), use_case="rstudio")
# Shiny template
add_dockerfile(pkg_path = file.path(tempdir(), "hellow"), use_case = "shiny")
# Pipeline template
add_dockerfile(pkg_path = file.path(tempdir(), "hellow"), use_case="pipeline")

## End(Not run)
</code></pre>

<hr>
<h2 id='build_image'>Build a Docker image</h2><span id='topic+build_image'></span>

<h3>Description</h3>

<p>Builds a Docker image created by <a href="#topic+use_docker">use_docker</a> or <a href="#topic+add_dockerfile">add_dockerfile</a>. This function is run as part of <a href="#topic+use_docker">use_docker</a> when <code>build = TRUE</code> is set, but can be used on its own.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>build_image(
  pkg_path = ".",
  img_path = NULL,
  cache = TRUE,
  tag = NULL,
  build = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="build_image_+3A_pkg_path">pkg_path</code></td>
<td>
<p>Path to the package directory. Default is <code>"."</code> for the current working directory, which assumes developer is working in R package root. However, this can be set to another path as needed.</p>
</td></tr>
<tr><td><code id="build_image_+3A_img_path">img_path</code></td>
<td>
<p>Path to the write the docker image definition contents. The default <code>NULL</code> will use <code style="white-space: pre;">&#8288;docker/&#8288;</code> as a subdirectory of the <code>pkg_path</code>.</p>
</td></tr>
<tr><td><code id="build_image_+3A_cache">cache</code></td>
<td>
<p>Logical; should caching be used? Default <code>TRUE</code>. Set to <code>FALSE</code> to use <code>--no-cache</code> in <code style="white-space: pre;">&#8288;docker build&#8288;</code>.</p>
</td></tr>
<tr><td><code id="build_image_+3A_tag">tag</code></td>
<td>
<p>Image tag to use; default is <code>NULL</code> and the image will be tagged with package name version from <a href="#topic+pkg_info">pkg_info</a>.</p>
</td></tr>
<tr><td><code id="build_image_+3A_build">build</code></td>
<td>
<p>Logical as to whether or not the image should be built. Default is <code>TRUE</code>, and if <code>FALSE</code> the <code style="white-space: pre;">&#8288;docker build&#8288;</code> command will be messaged.  Setting <code>build=FALSE</code> could be useful if additional <code style="white-space: pre;">&#8288;docker build&#8288;</code> options or different tags are desired. In either case the <code style="white-space: pre;">&#8288;docker build&#8288;</code> command will be returned invisibly.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Invisibly returns the <code style="white-space: pre;">&#8288;docker build&#8288;</code> command. Primarily called for its side effects, which runs the <code style="white-space: pre;">&#8288;docker build&#8288;</code> as a system command.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Specify path to example package source and copy to tempdir()
# Note that in practice you do not need to copy to a tempdir()
# And in fact it may be easiest to use pracpac relative to your package directory root
ex_pkg_src &lt;- system.file("hellow", package = "pracpac", mustWork = TRUE)
file.copy(from = ex_pkg_src, to = tempdir(), recursive = TRUE)

# Run use_docker to create Docker directory and assets for the example package
use_docker(pkg_path = file.path(tempdir(), "hellow"))

# Build the image
build_image(pkg_path = file.path(tempdir(), "hellow"))
# Or construct the image build command without building
build_cmd &lt;- build_image(pkg_path = file.path(tempdir(), "hellow"), build=FALSE)
build_cmd

## End(Not run)
</code></pre>

<hr>
<h2 id='build_pkg'>Build a package tar.gz</h2><span id='topic+build_pkg'></span>

<h3>Description</h3>

<p>Builds a package source tar.gz using <a href="pkgbuild.html#topic+build">pkgbuild::build</a> and moves it into a user-specified location (default <code style="white-space: pre;">&#8288;docker/&#8288;</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>build_pkg(pkg_path = ".", img_path = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="build_pkg_+3A_pkg_path">pkg_path</code></td>
<td>
<p>Path to the package directory. Default is <code>"."</code> for the current working directory, which assumes developer is working in R package root. However, this can be set to another path as needed.</p>
</td></tr>
<tr><td><code id="build_pkg_+3A_img_path">img_path</code></td>
<td>
<p>Path to the write the docker image definition contents. The default <code>NULL</code> will use <code style="white-space: pre;">&#8288;docker/&#8288;</code> as a subdirectory of the <code>pkg_path</code>.</p>
</td></tr>
<tr><td><code id="build_pkg_+3A_...">...</code></td>
<td>
<p>Additional optional arguments passed to <a href="pkgbuild.html#topic+build">pkgbuild::build</a>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Invisibly returns a list of package info returned by <a href="#topic+pkg_info">pkg_info</a>, tar.gz source and destination file paths.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Specify path to example package source and copy to tempdir()
# Note that in practice you do not need to copy to a tempdir()
# And in fact it may be easiest to use pracpac relative to your package directory root
ex_pkg_src &lt;- system.file("hellow", package = "pracpac", mustWork = TRUE)
file.copy(from = ex_pkg_src, to = tempdir(), recursive = TRUE)

# Build the example package from tempdir()
build_pkg(pkg = file.path(tempdir(), "hellow"))

## End(Not run)
</code></pre>

<hr>
<h2 id='create_docker_dir'>Create Docker directory</h2><span id='topic+create_docker_dir'></span>

<h3>Description</h3>

<p>Creates a <code style="white-space: pre;">&#8288;docker/&#8288;</code> directory for a given package. By default, assumes that <code style="white-space: pre;">&#8288;docker/&#8288;</code> should be a subdirectory of the specified package path.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_docker_dir(pkg_path = ".", img_path = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="create_docker_dir_+3A_pkg_path">pkg_path</code></td>
<td>
<p>Path to the package directory. Default is <code>"."</code> for the current working directory, which assumes developer is working in R package root. However, this can be set to another path as needed.</p>
</td></tr>
<tr><td><code id="create_docker_dir_+3A_img_path">img_path</code></td>
<td>
<p>Path to the write the docker image definition contents. The default <code>NULL</code> will use <code style="white-space: pre;">&#8288;docker/&#8288;</code> as a subdirectory of the <code>pkg_path</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is run as part of <a href="#topic+use_docker">use_docker</a> but can be used on its own.
</p>


<h3>Value</h3>

<p>Invisibly returns a list of package info returned by <a href="#topic+pkg_info">pkg_info</a>. Primarily called for side-effect to create docker directory.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Specify path to example package source and copy to tempdir()
# Note that in practice you do not need to copy to a tempdir()
# And in fact it may be easiest to use pracpac relative to your package directory root
ex_pkg_src &lt;- system.file("hellow", package = "pracpac", mustWork = TRUE)
file.copy(from = ex_pkg_src, to = tempdir(), recursive = TRUE)

# Assuming default behavior then docker/ will be created under source root
create_docker_dir(pkg_path = file.path(tempdir(), "hellow"))

# Alternatively you can specify another directory above, below, or beside package source
create_docker_dir(pkg_path = file.path(tempdir(), "hellow"), img_path = file.path(tempdir(), "img"))

## End(Not run)

</code></pre>

<hr>
<h2 id='handle_use_case'>Handle the use case</h2><span id='topic+handle_use_case'></span>

<h3>Description</h3>

<p>This unexported helper function internally handles the provided use case.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>handle_use_case(use_case)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="handle_use_case_+3A_use_case">use_case</code></td>
<td>
<p>The specified use case.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of parsed information for the use case including, the name of the use case, path to Dockerfile template, base image, and path to assets (delimited by <code style="white-space: pre;">&#8288;;&#8288;</code> if there are multiple and <code>NA</code> if there are none).
</p>

<hr>
<h2 id='pkg_info'>Get information about the current package</h2><span id='topic+pkg_info'></span>

<h3>Description</h3>

<p>Returns information about the current package in a list which can be passed to other functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pkg_info(pkg_path = ".", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pkg_info_+3A_pkg_path">pkg_path</code></td>
<td>
<p>Path to the package directory. Default is <code>"."</code> for the current working directory, which assumes developer is working in R package root. However, this can be set to another path as needed.</p>
</td></tr>
<tr><td><code id="pkg_info_+3A_...">...</code></td>
<td>
<p>Arguments passed to <a href="rprojroot.html#topic+find_root_file">rprojroot::find_package_root_file</a>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of information about the package.
</p>

<ul>
<li> <p><code>pkgroot</code>: Root directory of the package.
</p>
</li>
<li> <p><code>pkgdeps</code>: Package dependencies from <code>Imports</code> in the <code>DESCRIPTION</code>.
</p>
</li>
<li> <p><code>descfile</code>: File path to the <code>DESCRIPTION</code> file.
</p>
</li>
<li> <p><code>pkgname</code>: Package name.
</p>
</li>
<li> <p><code>pkgver</code>: Package version.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Specify path to example package source and copy to tempdir()
# Note that in practice you do not need to copy to a tempdir()
# And in fact it may be easiest to use pracpac relative to your package directory root
ex_pkg_src &lt;- system.file("hellow", package = "pracpac", mustWork = TRUE)
file.copy(from = ex_pkg_src, to = tempdir(), recursive = TRUE)

# This will succeed if this is a package
pkg_info(pkg_path = file.path(tempdir(), "hellow"))
# This will fail if this is not a package location
pkg_info(pkg_path = tempdir())

## End(Not run)
</code></pre>

<hr>
<h2 id='pkg_root'>Find package root</h2><span id='topic+pkg_root'></span>

<h3>Description</h3>

<p>Unexported helper to find the root of the R package. Returns an error if the path specified is not an R package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pkg_root(pkg_path = ".", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pkg_root_+3A_pkg_path">pkg_path</code></td>
<td>
<p>Path to the package directory. Default is <code>"."</code> for the current working directory, which assumes developer is working in R package root. However, this can be set to another path as needed.</p>
</td></tr>
<tr><td><code id="pkg_root_+3A_...">...</code></td>
<td>
<p>Arguments passed to <a href="rprojroot.html#topic+find_root_file">rprojroot::find_package_root_file</a>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A file path of the package root. If no package is found at the root then the function will <code>stop</code> with an error message.
</p>

<hr>
<h2 id='renv_deps'>Get dependencies using renv</h2><span id='topic+renv_deps'></span>

<h3>Description</h3>

<p>Get dependencies using renv. This function will inspect your package specified
at <code>pkg_path</code> (default is current working directory, <code>.</code>), and create an renv lock file (<code>renv.lock</code>) in
the <code style="white-space: pre;">&#8288;docker/&#8288;</code> directory. More information about the <code>renv</code> implementation is provided in the Details section.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>renv_deps(
  pkg_path = ".",
  img_path = NULL,
  other_packages = NULL,
  overwrite = TRUE,
  consent_renv = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="renv_deps_+3A_pkg_path">pkg_path</code></td>
<td>
<p>Path to the package directory. Default is <code>"."</code> for the current working directory, which assumes developer is working in R package root. However, this can be set to another path as needed.</p>
</td></tr>
<tr><td><code id="renv_deps_+3A_img_path">img_path</code></td>
<td>
<p>Path to the write the docker image definition contents. The default <code>NULL</code> will use <code style="white-space: pre;">&#8288;docker/&#8288;</code> as a subdirectory of the <code>pkg_path</code>.</p>
</td></tr>
<tr><td><code id="renv_deps_+3A_other_packages">other_packages</code></td>
<td>
<p>Vector of other packages to be included in <code>renv</code> lock file; default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="renv_deps_+3A_overwrite">overwrite</code></td>
<td>
<p>Logical; should an existing lock file should be overwritten? Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="renv_deps_+3A_consent_renv">consent_renv</code></td>
<td>
<p>Logical; give renv consent in this session with <code>options(renv.consent = TRUE)</code>? Default is <code>TRUE</code>. See <a href="renv.html#topic+consent">renv::consent</a> for details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>renv.lock</code> file will capture all your package's dependencies (and all
their dependencies) at the current version installed on your system at the
time this function is run. When using the default <code>use_renv=TRUE</code> in
<a href="#topic+use_docker">use_docker</a> or <a href="#topic+add_dockerfile">add_dockerfile</a>, the resulting <code>Dockerfile</code> will install
packages from this <code>renv.lock</code> file using <a href="renv.html#topic+restore">renv::restore</a>. This ensures that
versions of dependencies in the image mirror what is installed on your system
at the time of image creation, rather than potentially newer versions on package repositories like
CRAN or Bioconductor, which may come with breaking changes that you are unaware of at the
time of package development.
</p>
<p>If there are additional R packages that may be useful for the Docker image you plan to build (but may not be captured under your package dependencies), then you can add these packages to the <code>renv</code> procedure with the &quot;other_packages&quot; argument.
</p>
<p>This function is run as part of <a href="#topic+use_docker">use_docker</a> but can be used on its own.
</p>


<h3>Value</h3>

<p>Invisibly returns a list of package info returned by <a href="#topic+pkg_info">pkg_info</a>. Primarily called for side effect. Writes an <code>renv</code> lock file to the docker/ directory.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Specify path to example package source and copy to tempdir()
# Note that in practice you do not need to copy to a tempdir()
# And in fact it may be easiest to use pracpac relative to your package directory root
ex_pkg_src &lt;- system.file("hellow", package = "pracpac", mustWork = TRUE)
file.copy(from = ex_pkg_src, to = tempdir(), recursive = TRUE)

# Run using defaults; only gets current package dependencies
renv_deps(pkg_path = file.path(tempdir(), "hellow"))
# Add additional packages not explicitly required by your package
renv_deps(pkg_path = file.path(tempdir(), "hellow"), other_packages=c("shiny", "knitr"))

## End(Not run)
</code></pre>

<hr>
<h2 id='use_docker'>Use docker packaging tools</h2><span id='topic+use_docker'></span>

<h3>Description</h3>

<p>Wrapper function around other <code>pracpac</code> functions. See help for the functions linked below for detail on individual functions.
All arguments to <code>use_docker()</code> are passed to downstream functions. <code>use_docker()</code> will sequentially run:
</p>

<ol>
<li> <p><a href="#topic+pkg_info">pkg_info</a> to get information about the current R package.
</p>
</li>
<li> <p><a href="#topic+create_docker_dir">create_docker_dir</a> to create the <code style="white-space: pre;">&#8288;docker/&#8288;</code> directory in the specified location, if it doesn't already exist.
</p>
</li>
<li> <p><a href="#topic+renv_deps">renv_deps</a> (if <code>use_renv=TRUE</code>, the default) to capture package dependencies with renv and create an <code>renv.lock</code> file
</p>
</li>
<li> <p><a href="#topic+add_dockerfile">add_dockerfile</a> to create a Dockerfile using template specified by <code>use_case</code>
</p>
</li>
<li> <p><a href="#topic+add_assets">add_assets</a> depending on the <code>use_case</code>
</p>
</li>
<li> <p><a href="#topic+build_pkg">build_pkg</a> to build the current R package source .tar.gz, and place it into the <code style="white-space: pre;">&#8288;docker/&#8288;</code> directory
</p>
</li>
<li> <p><a href="#topic+build_image">build_image</a> optional, default <code>FALSE</code>; if TRUE, will build the Docker image.
</p>
</li></ol>

<p>The default <code>build=FALSE</code> means that everything up to <code>build_image()</code> is run,
but the image is not actually built. Instead, <code>use_docker()</code> will message the
<code style="white-space: pre;">&#8288;docker build&#8288;</code> command, and return that string in <code style="white-space: pre;">&#8288;$buildcmd&#8288;</code> in the
invisibly returned output.
</p>
<p>See <code>vignette("use-cases", package="pracpac")</code> for details on use cases.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>use_docker(
  pkg_path = ".",
  img_path = NULL,
  use_renv = TRUE,
  use_case = "default",
  base_image = NULL,
  other_packages = NULL,
  build = FALSE,
  repos = NULL,
  overwrite_assets = TRUE,
  overwrite_renv = TRUE,
  consent_renv = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="use_docker_+3A_pkg_path">pkg_path</code></td>
<td>
<p>Path to the package directory. Default is <code>"."</code> for the current working directory, which assumes developer is working in R package root. However, this can be set to another path as needed.</p>
</td></tr>
<tr><td><code id="use_docker_+3A_img_path">img_path</code></td>
<td>
<p>Path to the write the docker image definition contents. The default <code>NULL</code> will use <code style="white-space: pre;">&#8288;docker/&#8288;</code> as a subdirectory of the <code>pkg_path</code>.</p>
</td></tr>
<tr><td><code id="use_docker_+3A_use_renv">use_renv</code></td>
<td>
<p>Logical; use renv? Defaults to <code>TRUE</code>. If <code>FALSE</code>, package dependencies are scraped from the <code>DESCRIPTION</code> file without version information.</p>
</td></tr>
<tr><td><code id="use_docker_+3A_use_case">use_case</code></td>
<td>
<p>Name of the use case. Defaults to <code>"default"</code>, which only uses the base boilerplate.</p>
</td></tr>
<tr><td><code id="use_docker_+3A_base_image">base_image</code></td>
<td>
<p>Name of the base image to start <code>FROM</code>. Default is <code>NULL</code> and the base image will be derived based on <code>use_case</code>. Optionally override this by setting the name of the base image (including tag if desired).</p>
</td></tr>
<tr><td><code id="use_docker_+3A_other_packages">other_packages</code></td>
<td>
<p>Vector of other packages to be included in <code>renv</code> lock file; default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="use_docker_+3A_build">build</code></td>
<td>
<p>Logical as to whether or not the image should be built. Default is <code>TRUE</code>, and if <code>FALSE</code> the <code style="white-space: pre;">&#8288;docker build&#8288;</code> command will be messaged.  Setting <code>build=FALSE</code> could be useful if additional <code style="white-space: pre;">&#8288;docker build&#8288;</code> options or different tags are desired. In either case the <code style="white-space: pre;">&#8288;docker build&#8288;</code> command will be returned invisibly.</p>
</td></tr>
<tr><td><code id="use_docker_+3A_repos">repos</code></td>
<td>
<p>Option to override the repos used for installing packages with <code>renv</code> by passing name of repository. Only used if <code>use_renv = TRUE</code>. Default is <code>NULL</code> meaning that the repos specified in <code>renv</code> lockfile will remain as-is and not be overridden.</p>
</td></tr>
<tr><td><code id="use_docker_+3A_overwrite_assets">overwrite_assets</code></td>
<td>
<p>Logical; should existing asset files should be overwritten? Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="use_docker_+3A_overwrite_renv">overwrite_renv</code></td>
<td>
<p>Logical; should an existing lock file should be overwritten? Default is <code>TRUE</code>; ignored if <code>use_renv = TRUE</code>.</p>
</td></tr>
<tr><td><code id="use_docker_+3A_consent_renv">consent_renv</code></td>
<td>
<p>Logical; give renv consent in this session with <code>options(renv.consent = TRUE)</code>? Default is <code>TRUE</code>. See <a href="renv.html#topic+consent">renv::consent</a> for details.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Invisibly returns a list with information about the package (<code style="white-space: pre;">&#8288;$info&#8288;</code>) and
the <code style="white-space: pre;">&#8288;docker build&#8288;</code> command (<code style="white-space: pre;">&#8288;$buildcmd&#8288;</code>). Primarily called for side effect.
Creates <code style="white-space: pre;">&#8288;docker/&#8288;</code> directory, identifies renv dependencies and creates lock
file (if <code>use_renv = TRUE</code>), writes Dockerfile, builds package tar.gz,
moves all relevant assets to the <code style="white-space: pre;">&#8288;docker/&#8288;</code> directory, and builds Docker
image (if <code>build = TRUE</code>).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

# Specify path to example package source and copy to tempdir()
# Note that in practice you do not need to copy to a tempdir()
# And in fact it may be easiest to use pracpac relative to your package directory root
ex_pkg_src &lt;- system.file("hellow", package = "pracpac", mustWork = TRUE)
file.copy(from = ex_pkg_src, to = tempdir(), recursive = TRUE)

# Run use_docker to create Docker directory and assets for the example package
use_docker(pkg_path = file.path(tempdir(), "hellow"))
# To not use renv
use_docker(pkg_path = file.path(tempdir(), "hellow"), use_renv=FALSE)
# To specify a use case
use_docker(pkg_path = file.path(tempdir(), "hellow"), use_case="pipeline")
# To overwrite the default base image
use_docker(pkg_path = file.path(tempdir(), "hellow"), base_image="alpine:latest")

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
