<!DOCTYPE html><html><head><title>Help for package lqr</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {lqr}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ais'><p>Australian institute of sport data</p></a></li>
<li><a href='#best.lqr'>
<p>Best Fit in Robust Linear Quantile Regression</p></a></li>
<li><a href='#cens.lqr'>
<p>Skew-t quantile regression for censored and missing data</p></a></li>
<li><a href='#dist.Truncated'><p>Truncated Distributions</p></a></li>
<li><a href='#Egig'><p>Moments of the Generalized Inverse Gaussian Distribution</p></a></li>
<li><a href='#Log.best.lqr'>
<p>Best Fit in Robust Logistic Linear Quantile Regression</p></a></li>
<li><a href='#Log.lqr'>
<p>Robust Logistic Linear Quantile Regression</p></a></li>
<li><a href='#lqr'>
<p>Robust Linear Quantile Regression</p></a></li>
<li><a href='#lqr-package'>
<p>Robust Linear Quantile Regression</p></a></li>
<li><a href='#resistance'><p>Tumor-cell resistance to death</p></a></li>
<li><a href='#SKD'><p>Skew Family Distributions</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Robust Linear Quantile Regression</td>
</tr>
<tr>
<td>Version:</td>
<td>5.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-08-13</td>
</tr>
<tr>
<td>Author:</td>
<td>Christian E. Galarza &lt;chedgala@espol.edu.ec&gt;, Luis Benites &lt;lbenitess@pucp.edu.pe&gt;, Marcelo Bourguignon &lt;m.p.bourguignon@gmail.com&gt;, Victor H. Lachos &lt;hlachos@uconn.edu&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Christian E. Galarza &lt;cgalarza88@gmail.com&gt;</td>
</tr>
<tr>
<td>Imports:</td>
<td>graphics, stats, spatstat.geom, numDeriv, MomTrunc, quantreg,
MASS</td>
</tr>
<tr>
<td>Suggests:</td>
<td>ald</td>
</tr>
<tr>
<td>Description:</td>
<td>It fits a robust linear quantile regression model using a new family of zero-quantile distributions for the error term. Missing values and censored observations can be handled as well. This family of distribution includes skewed versions of the Normal, Student's t, Laplace, Slash and Contaminated Normal distribution. It also performs logistic quantile regression for bounded responses as shown in Galarza et.al.(2020) &lt;<a href="https://doi.org/10.1007%2Fs13571-020-00231-0">doi:10.1007/s13571-020-00231-0</a>&gt;. It provides estimates and full inference. It also provides envelopes plots for assessing the fit and confidences bands when several quantiles are provided simultaneously.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-08-13 15:12:42 UTC; cgala</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-08-15 08:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='ais'>Australian institute of sport data</h2><span id='topic+ais'></span>

<h3>Description</h3>

<p>Data on 102 male and 100 female athletes collected at the Australian
Institute of Sport.
</p>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>Sex</dt><dd>
<p>(0 = male or 1 = female)
</p>
</dd>
<dt>Ht</dt><dd>
<p>height (cm)
</p>
</dd>
<dt>Wt</dt><dd>
<p>weight (kg)
</p>
</dd>
<dt>LBM</dt><dd>
<p>lean body mass
</p>
</dd>
<dt>RCC</dt><dd>
<p>red cell count
</p>
</dd>
<dt>WCC</dt><dd>
<p>white cell count
</p>
</dd>
<dt>Hc</dt><dd>
<p>Hematocrit
</p>
</dd>
<dt>Hg</dt><dd>
<p>Hemoglobin
</p>
</dd>
<dt>Ferr</dt><dd>
<p>plasma ferritin concentration
</p>
</dd>
<dt>BMI</dt><dd>
<p>body mass index, weight/(height)**2
</p>
</dd>
<dt>SSF</dt><dd>
<p>sum of skin folds
</p>
</dd>
<dt>Bfat</dt><dd>
<p>Percent body fat
</p>
</dd>
<dt>Label</dt><dd>
<p>Case Labels
</p>
</dd>
<dt>Sport</dt><dd>
<p>Sport
</p>
</dd>
</dl>



<h3>References</h3>

<p>S. Weisberg (2005).  <em>Applied Linear Regression</em>, 3rd edition.  New York:
Wiley, Section 6.4</p>

<hr>
<h2 id='best.lqr'>
Best Fit in Robust Linear Quantile Regression
</h2><span id='topic+best.lqr'></span>

<h3>Description</h3>

<p>It finds the best fit distribution in robust linear quantile regression model. It adjusts the Normal, Student's t, Laplace, Slash and Contaminated Normal models. It shows a summary table with the likelihood-based criterion, envelopes plots and the histogram of the residuals with fitted densities for all models. Estimates and full inference are provided for the best model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>best.lqr(formula,data = NULL,subset = NULL,
              p = 0.5, precision = 10^-6,
              criterion = "AIC")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="best.lqr_+3A_formula">formula</code></td>
<td>

<p>an object of class &quot;formula&quot; (or one that can be coerced to that class): a symbolic description of the model to be fitted.
</p>
</td></tr>
<tr><td><code id="best.lqr_+3A_data">data</code></td>
<td>

<p>an optional data frame, list or environment (or object coercible by <code>as.data.frame</code> to a data frame) containing the variables in the model. If not found in <code>data</code>, the variables are taken from <code>environment(formula)</code>.
</p>
</td></tr>
<tr><td><code id="best.lqr_+3A_subset">subset</code></td>
<td>

<p>an optional string specifying a subset of observations to be used in the fitting process. Be aware of the use of double quotes in a proper way when necessary, e.g., in <code>"(sex=='F')"</code>.
</p>
</td></tr>  
<tr><td><code id="best.lqr_+3A_p">p</code></td>
<td>

<p>An unique quantile or a set of quantiles related to the quantile regression.
</p>
</td></tr>
<tr><td><code id="best.lqr_+3A_precision">precision</code></td>
<td>

<p>The convergence maximum error permitted. By default is 10^-6.
</p>
</td></tr>
<tr><td><code id="best.lqr_+3A_criterion">criterion</code></td>
<td>

<p>Likelihood-based criterion to be used for choosen the best model. It could be <code>AIC</code>, <code>BIC</code>, <code>HQ</code> or <code>loglik</code> (log-likelihood). By default <code>AIC</code> criterion will be used.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>best.fit()</code> function finds the best model only for one quantile. For fitting a grid of quantiles <code>lqr()</code> might be used but the distribution must be provided.
</p>


<h3>Value</h3>

<p>For the best model:
</p>
<table>
<tr><td><code>iter</code></td>
<td>
<p>number of iterations.</p>
</td></tr>
<tr><td><code>criteria</code></td>
<td>
<p>attained criteria value.</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>fixed effects estimates.</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>scale parameter estimate for the error term.</p>
</td></tr>
<tr><td><code>nu</code></td>
<td>
<p>Estimate of <code>nu</code> parameter detailed above.</p>
</td></tr>
<tr><td><code>gamma</code></td>
<td>
<p>Estimate of <code>gamma</code> parameter detailed above.</p>
</td></tr>
<tr><td><code>SE</code></td>
<td>
<p>Standard Error estimates.</p>
</td></tr>
<tr><td><code>table</code></td>
<td>
<p>Table containing the inference for the fixed effects parameters.</p>
</td></tr>
<tr><td><code>loglik</code></td>
<td>
<p>Log-likelihood value.</p>
</td></tr>
<tr><td><code>AIC</code></td>
<td>
<p>Akaike information criterion.</p>
</td></tr>
<tr><td><code>BIC</code></td>
<td>
<p>Bayesian information criterion.</p>
</td></tr>
<tr><td><code>HQ</code></td>
<td>
<p>Hannan-Quinn information criterion.</p>
</td></tr>
<tr><td><code>fitted.values</code></td>
<td>
<p>vector containing the fitted values.</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>vector containing the residuals.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Christian E. Galarza &lt;<a href="mailto:cgalarza88@gmail.com">cgalarza88@gmail.com</a>&gt;, Luis Benites &lt;<a href="mailto:lsanchez@ime.usp.br">lsanchez@ime.usp.br</a>&gt; and
Victor H. Lachos &lt;<a href="mailto:hlachos@ime.unicamp.br">hlachos@ime.unicamp.br</a>&gt;
</p>
<p>Maintainer: Christian E. Galarza &lt;<a href="mailto:cgalarza88@gmail.com">cgalarza88@gmail.com</a>&gt;
</p>


<h3>References</h3>

<p>Galarza, C., Lachos, V. H., Cabral, C. R. B., &amp; Castro, C. L. (2017). Robust quantile regression using a generalized class of skewed distributions. Stat,
6(1), 113-130.
</p>
<p>Wichitaksorn, N., Choy, S. T., &amp; Gerlach, R. (2014). A generalized class of skew distributions and associated robust quantile regression models. Canadian Journal of Statistics, 42(4), 579-596.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lqr">lqr</a></code>,<code><a href="#topic+Log.lqr">Log.lqr</a></code>,<code><a href="#topic+Log.best.lqr">Log.best.lqr</a></code>,<code><a href="#topic+dSKD">dSKD</a></code>

</p>


<h3>Examples</h3>

<pre><code class='language-R'>

data(crabs,package = "MASS")

#Finding the best model for the 3rd quartile based on BIC
best.lqr(BD~FL,data = crabs, p = 0.75, criterion = "BIC")
 
</code></pre>

<hr>
<h2 id='cens.lqr'>
Skew-t quantile regression for censored and missing data
</h2><span id='topic+cens.lqr'></span>

<h3>Description</h3>

<p>It fits a linear quantile regression model where the error term is considered to follow an SKT skew-t distribution, that is, the one proposed by Wichitaksorn et.al. (2014). Additionally, the model is capable to deal with missing and interval-censored data at the same time. Degrees of freedom can be either estimated or supplied by the user. It offers estimates and full inference. It also provides envelopes plots and likelihood-based criteria for assessing the fit, as well as fitted and imputed values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cens.lqr(y,x,cc,LL,UL,p=0.5,nu=NULL,precision=1e-06,envelope=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cens.lqr_+3A_y">y</code></td>
<td>

<p>the response vector of dimension <code class="reqn">n</code> where <code class="reqn">n</code> is the total of observations. It may contain both missing and censored values represented by <code>NaN</code>s.
</p>
</td></tr>
<tr><td><code id="cens.lqr_+3A_x">x</code></td>
<td>

<p>design matrix for the fixed effects of dimension <code class="reqn">N x d</code> where <code class="reqn">d</code> represents the number of fixed effects including the intercept, if considered.
</p>
</td></tr>
<tr><td><code id="cens.lqr_+3A_cc">cc</code></td>
<td>

<p>vector of censoring/missing indicators. For each observation it takes 0 if non-censored/missing, 1 if censored/missing.
</p>
</td></tr>
<tr><td><code id="cens.lqr_+3A_ll">LL</code></td>
<td>

<p>the vector of lower limits of dimension <code class="reqn">n</code>x<code class="reqn">1</code>. See details section.
</p>
</td></tr>
<tr><td><code id="cens.lqr_+3A_ul">UL</code></td>
<td>

<p>the vector of upper limits of dimension <code class="reqn">n</code>x<code class="reqn">1</code>. See details section.
</p>
</td></tr>
<tr><td><code id="cens.lqr_+3A_p">p</code></td>
<td>

<p>An unique quantile of interest to fit the quantile regression.
</p>
</td></tr>
<tr><td><code id="cens.lqr_+3A_nu">nu</code></td>
<td>

<p>It represents the degrees of freedom of the skew-t distribution. When is not provided, we use the MLE.
</p>
</td></tr>
<tr><td><code id="cens.lqr_+3A_precision">precision</code></td>
<td>

<p>The convergence maximum error permitted. By default is 10^-6.
</p>
</td></tr>
<tr><td><code id="cens.lqr_+3A_envelope">envelope</code></td>
<td>

<p>if <code>TRUE</code>, it will show a confidence envelope for a curve based on bootstrap replicates.
it is <code>FALSE</code> by default.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Missing or censored values in the response can be represented imputed as <code>NaN</code>s, since the algorithm only uses the information provided in the lower and upper limits LL and UL. The indicator vector <code>cc</code> must take the value of 1 for these observations.
</p>
<p>*Censored and missing data*
</p>
<p>If all lower limits are <code>-Inf</code>, we will be dealing with left-censored data.
Besides, if all upper limits are <code>Inf</code>, this is the case of right-censored data. Interval-censoring is considered when both limits are finites. If some observation is missing, we have not information at all, so both limits must be infinites.
</p>
<p>Combinations of all cases above are permitted, that is, we may have left-censored, right-censored, interval-censored and missing data at the same time.
</p>


<h3>Value</h3>

<table>
<tr><td><code>iter</code></td>
<td>
<p>number of iterations.</p>
</td></tr>
<tr><td><code>criteria</code></td>
<td>
<p>attained criteria value.</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>fixed effects estimates.</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>scale parameter estimate for the error term.</p>
</td></tr>
<tr><td><code>nu</code></td>
<td>
<p>Estimate of <code>nu</code> parameter detailed above.</p>
</td></tr>
<tr><td><code>SE</code></td>
<td>
<p>Standard Error estimates.</p>
</td></tr>
<tr><td><code>table</code></td>
<td>
<p>Table containing the inference for the fixed effects parameters.</p>
</td></tr>
<tr><td><code>loglik</code></td>
<td>
<p>Log-likelihood value.</p>
</td></tr>
<tr><td><code>AIC</code></td>
<td>
<p>Akaike information criterion.</p>
</td></tr>
<tr><td><code>BIC</code></td>
<td>
<p>Bayesian information criterion.</p>
</td></tr>
<tr><td><code>HQ</code></td>
<td>
<p>Hannan-Quinn information criterion.</p>
</td></tr>
<tr><td><code>fitted.values</code></td>
<td>
<p>vector containing the fitted values.</p>
</td></tr>
<tr><td><code>imputed.values</code></td>
<td>
<p>vector containing the imputed values for censored/missing observations.</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>vector containing the residuals.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Christian E. Galarza &lt;<a href="mailto:chedgala@espol.edu.ec">chedgala@espol.edu.ec</a>&gt;, Marcelo Bourguignon &lt;<a href="mailto:m.p.bourguignon@gmail.com">m.p.bourguignon@gmail.com</a>&gt; and
Victor H. Lachos &lt;<a href="mailto:hlachos@ime.unicamp.br">hlachos@ime.unicamp.br</a>&gt;
</p>
<p>Maintainer: Christian E. Galarza &lt;<a href="mailto:chedgala@espol.edu.ec">chedgala@espol.edu.ec</a>&gt;
</p>


<h3>References</h3>

<p>Galarza, C., Lachos, V. H. &amp; Bourguignon M. (2021). A skew-t quantile regression for censored and missing data. Stat.doi: <a href="https://doi.org/10.1002/sta4.379">10.1002/sta4.379</a>.
</p>
<p>Galarza, C., Lachos, V. H., Cabral, C. R. B., &amp; Castro, C. L. (2017). Robust quantile regression using a generalized class of skewed distributions. Stat,
6(1), 113-130.
</p>
<p>Wichitaksorn, N., Choy, S. B., &amp; Gerlach, R. (2014). A generalized class of skew distributions and associated robust quantile regression models. Canadian Journal of Statistics, 42(4), 579-596.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lqr">lqr</a></code>,<code><a href="#topic+best.lqr">best.lqr</a></code>,<code><a href="#topic+Log.lqr">Log.lqr</a></code>,
<code><a href="#topic+Log.best.lqr">Log.best.lqr</a></code>,<code><a href="#topic+dSKD">dSKD</a></code>

</p>


<h3>Examples</h3>

<pre><code class='language-R'>
##Load the data
data(ais)
attach(ais)

##Setting
y&lt;-BMI
x&lt;-cbind(1,LBM,Sex)

cc = rep(0,length(y))
LL = UL = rep(NA,length(y))

#Generating a 5% of interval-censored values
ind = sample(x = c(0,1),size = length(y),
replace = TRUE,prob = c(0.95,0.05))
ind1 = (ind == 1)

cc[ind1] = 1
LL[ind1] = y[ind1] - 10
UL[ind1] = y[ind1] + 10
y[ind1] = NA #deleting data

#Fitting the model

# A median regression with unknown degrees of freedom
out = cens.lqr(y,x,cc,LL,UL,p=0.5,nu = NULL,precision = 1e-6,envelope = TRUE)

# A first quartile regression with 10 degrees of freedom
out = cens.lqr(y,x,cc,LL,UL,p=0.25,nu = 10,precision = 1e-6,envelope = TRUE)

</code></pre>

<hr>
<h2 id='dist.Truncated'>Truncated Distributions</h2><span id='topic+dtrunc'></span><span id='topic+extrunc'></span><span id='topic+ptrunc'></span><span id='topic+qtrunc'></span><span id='topic+rtrunc'></span><span id='topic+vartrunc'></span>

<h3>Description</h3>

<p>Density, distribution function, quantile function and random
generation for truncated distributions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dtrunc(x, spec, a=-Inf, b=Inf, log=FALSE, ...)
extrunc(spec, a=-Inf, b=Inf, ...)
ptrunc(x, spec, a=-Inf, b=Inf, ...)
qtrunc(p, spec, a=-Inf, b=Inf, ...)
rtrunc(n, spec, a=-Inf, b=Inf, ...)
vartrunc(spec, a=-Inf, b=Inf, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dist.Truncated_+3A_n">n</code></td>
<td>
<p>This is a the number of random draws for <code>rtrunc</code>.</p>
</td></tr>
<tr><td><code id="dist.Truncated_+3A_p">p</code></td>
<td>
<p>This is a vector of probabilities.</p>
</td></tr>
<tr><td><code id="dist.Truncated_+3A_x">x</code></td>
<td>
<p>This is a vector to be evaluated.</p>
</td></tr>
<tr><td><code id="dist.Truncated_+3A_spec">spec</code></td>
<td>
<p>The base name of a probability distribution is
specified here. For example, to estimate the density of a
truncated normal distribution, enter <code>norm</code>.</p>
</td></tr>
<tr><td><code id="dist.Truncated_+3A_a">a</code></td>
<td>
<p>This is the lower bound of truncation, which defaults
to negative infinity.</p>
</td></tr>
<tr><td><code id="dist.Truncated_+3A_b">b</code></td>
<td>
<p>This is the upper bound of truncation, which defaults
to infinity.</p>
</td></tr>
<tr><td><code id="dist.Truncated_+3A_log">log</code></td>
<td>
<p>Logical. If <code>log=TRUE</code>, then the logarithm of the
density is returned.</p>
</td></tr>
<tr><td><code id="dist.Truncated_+3A_...">...</code></td>
<td>
<p>Additional arguments to pass.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A truncated distribution is a conditional distribution that results
from a priori restricting the domain of some other probability
distribution. More than merely preventing values outside of truncated
bounds, a proper truncated distribution integrates to one within the
truncated bounds. In contrast to a truncated distribution, a
censored distribution occurs when the probability distribution is
still allowed outside of a pre-specified range. Here, distributions
are truncated to the interval <code class="reqn">[a,b]</code>, such as <code class="reqn">p(\theta) \in
  [a,b]</code>.
</p>
<p>The R code of Nadarajah and Kotz (2006) has been modified to work with
log-densities. This code was also available in the (extinct) package LaplacesDemon.
</p>


<h3>Value</h3>

<p><code>dtrunc</code> gives the density,
<code>extrunc</code> gives the expectation,
<code>ptrunc</code> gives the distribution function,
<code>qtrunc</code> gives the quantile function,
<code>rtrunc</code> generates random deviates, and
<code>vartrunc</code> gives the variance of the truncated distribution.
</p>


<h3>References</h3>

<p>Nadarajah, S. and Kotz, S. (2006). &quot;R Programs for Computing Truncated
Distributions&quot;. <em>Journal of Statistical Software</em>, 16,
Code Snippet 2, p. 1&ndash;8.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lqr">lqr</a></code>,
<code><a href="#topic+SKD">SKD</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- seq(-0.5, 0.5, by = 0.1)
y &lt;- dtrunc(x, "norm", a=-0.5, b=0.5, mean=0, sd=2)
</code></pre>

<hr>
<h2 id='Egig'>Moments of the Generalized Inverse Gaussian Distribution</h2><span id='topic+Egig'></span>

<h3>Description</h3>

<p>Expected value of X, log(X), 1/X and variance for the generalized
inverse gaussian distribution. This function has been recycled from the ghyp R package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Egig(lambda, chi, psi, func = c("x", "logx", "1/x", "var"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Egig_+3A_lambda">lambda</code></td>
<td>
<p>A shape and scale and parameter.</p>
</td></tr>
<tr><td><code id="Egig_+3A_chi">chi</code>, <code id="Egig_+3A_psi">psi</code></td>
<td>
<p>Shape and scale parameters. Must be positive.</p>
</td></tr>
<tr><td><code id="Egig_+3A_func">func</code></td>
<td>
<p>The transformation function when computing the expected value.
<code>x</code> is the expected value (default), <code>log x</code> returns the
expected value of the logarithm of <code>x</code>, <code>1/x</code> returns the
expected value of the inverse of <code>x</code> and <code>var</code> returns the
variance.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>Egig</code> with <code>func = "log x"</code> uses
<code><a href="numDeriv.html#topic+grad">grad</a></code> from the <span class="rlang"><b>R</b></span> package <em>numDeriv</em>. See
the package vignette for details regarding the expectation of GIG
random variables.
</p>


<h3>Value</h3>

<p><code>Egig</code> gives the expected value
of either <code>x</code>, <code>1/x</code>, <code>log(x)</code> or the variance if <code>func</code> equals <code>var</code>.
</p>


<h3>Author(s)</h3>

<p>David Luethi and Ester Pantaleo</p>


<h3>References</h3>

<p>Dagpunar, J.S. (1989). <em>An easily implemented generalised inverse
Gaussian generator.</em> Commun. Statist. -Simula., <b>18</b>, 703&ndash;710.
</p>
<p>Michael, J. R, Schucany, W. R, Haas, R, W. (1976).  <em>Generating
random variates using transformations with multiple roots</em>, The
American Statistican, <b>30</b>, 88&ndash;90.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+best.lqr">best.lqr</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>Egig(lambda = 10, chi = 1, psi = 1, func = "x")
Egig(lambda = 10, chi = 1, psi = 1, func = "var")
Egig(lambda = 10, chi = 1, psi = 1, func = "1/x")
</code></pre>

<hr>
<h2 id='Log.best.lqr'>
Best Fit in Robust Logistic Linear Quantile Regression
</h2><span id='topic+Log.best.lqr'></span>

<h3>Description</h3>

<p>It performs the logistic transformation in Galarza et.al.(2020) (see references) for estimating quantiles for a bounded response. Once the response is transformed, it uses the <code>best.lqr</code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Log.best.lqr(formula,data = NULL,subset = NULL,
                        p=0.5,a=0,b=1,
                        epsilon = 0.001,precision = 10^-6,
                        criterion = "AIC")
</code></pre>


<h3>Arguments</h3>

<p>We will detail first the only three arguments that differ from <code>best.lqr</code> function.
</p>
<table>
<tr><td><code id="Log.best.lqr_+3A_a">a</code></td>
<td>

<p>lower bound for the response (default = 0)
</p>
</td></tr>
<tr><td><code id="Log.best.lqr_+3A_b">b</code></td>
<td>

<p>upper bound for the response (default = 1)
</p>
</td></tr>
<tr><td><code id="Log.best.lqr_+3A_epsilon">epsilon</code></td>
<td>

<p>a small quantity <code class="reqn">\epsilon&gt;0</code> that ensures that the logistic transform is defined for all values of the response.
</p>
</td></tr>
<tr><td><code id="Log.best.lqr_+3A_formula">formula</code></td>
<td>

<p>an object of class &quot;formula&quot; (or one that can be coerced to that class): a symbolic description of the model to be fitted.
</p>
</td></tr>
<tr><td><code id="Log.best.lqr_+3A_data">data</code></td>
<td>

<p>an optional data frame, list or environment (or object coercible by <code>as.data.frame</code> to a data frame) containing the variables in the model. If not found in <code>data</code>, the variables are taken from <code>environment(formula)</code>.
</p>
</td></tr>
<tr><td><code id="Log.best.lqr_+3A_subset">subset</code></td>
<td>

<p>an optional string specifying a subset of observations to be used in the fitting process. Be aware of the use of double quotes in a proper way when necessary, e.g., in <code>"(sex=='F')"</code>.
</p>
</td></tr>  
<tr><td><code id="Log.best.lqr_+3A_p">p</code></td>
<td>

<p>An unique quantile or a set of quantiles related to the quantile regression.
</p>
</td></tr>
<tr><td><code id="Log.best.lqr_+3A_precision">precision</code></td>
<td>

<p>The convergence maximum error permitted. By default is 10^-6.
</p>
</td></tr>
<tr><td><code id="Log.best.lqr_+3A_criterion">criterion</code></td>
<td>

<p>Likelihood-based criterion to be used for choosen the best model. It could be <code>AIC</code>, <code>BIC</code>, <code>HQ</code> or <code>loglik</code> (log-likelihood). By default <code>AIC</code> criterion will be used.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We follow the transformation in Bottai et.al. (2009) defined as
</p>
<p style="text-align: center;"><code class="reqn">h(y)=logit(y)=log(\frac{y-a}{b-y})</code>
</p>

<p>that implies
</p>
<p style="text-align: center;"><code class="reqn">Q_{y}(p)=\frac{b\,exp(X\beta) + a}{1 + exp(X\beta)}</code>
</p>

<p>where <code class="reqn">Q_{y}(p)</code> represents the conditional quantile of the response. Once estimates for the regression coefficients <code class="reqn">\beta_p</code> are obtained, inference on <code class="reqn">Q_{y}(p)</code> can then be made through the inverse transform above. This equation (as function) is provided in the output. See example.
</p>
<p>The interpretation of the regression coefficients is analogous to the interpretation of the coefficients of a logistic regression
for binary outcomes.
</p>
<p>For example, let <code class="reqn">x_1</code> be the gender (male = 0, female=1). Then <code class="reqn">exp(\beta_{0.5,1})</code> represents the odds ratio of median score in males vs females, where the odds are
defined using the score instead of a probability, <code class="reqn">(y-a)/(b-y)</code>. When the covariate is continous, the respective <code class="reqn">\beta</code> coeficient can be interpretated as the increment (or decrement) over the log(odd ratio) when the covariate increases one unit.
</p>


<h3>Value</h3>

<p>For the best model:
</p>
<table>
<tr><td><code>iter</code></td>
<td>
<p>number of iterations.</p>
</td></tr>
<tr><td><code>criteria</code></td>
<td>
<p>attained criteria value.</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>fixed effects estimates.</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>scale parameter estimate for the error term.</p>
</td></tr>
<tr><td><code>nu</code></td>
<td>
<p>Estimate of <code>nu</code> parameter detailed above.</p>
</td></tr>
<tr><td><code>gamma</code></td>
<td>
<p>Estimate of <code>gamma</code> parameter detailed above.</p>
</td></tr>
<tr><td><code>SE</code></td>
<td>
<p>Standard Error estimates.</p>
</td></tr>
<tr><td><code>table</code></td>
<td>
<p>Table containing the inference for the fixed effects parameters.</p>
</td></tr>
<tr><td><code>loglik</code></td>
<td>
<p>Log-likelihood value.</p>
</td></tr>
<tr><td><code>AIC</code></td>
<td>
<p>Akaike information criterion.</p>
</td></tr>
<tr><td><code>BIC</code></td>
<td>
<p>Bayesian information criterion.</p>
</td></tr>
<tr><td><code>HQ</code></td>
<td>
<p>Hannan-Quinn information criterion.</p>
</td></tr>
<tr><td><code>fitted.values</code></td>
<td>
<p>vector containing the fitted values.</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>vector containing the residuals.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>When a grid of quantiles is provided, a graphical summary with point estimates and Confidence Intervals for model parameters is shown. Also, the result will be a list of the same dimension where each element corresponds to each quantile as detailed above.
</p>


<h3>Author(s)</h3>

<p>Christian E. Galarza &lt;<a href="mailto:cgalarza88@gmail.com">cgalarza88@gmail.com</a>&gt;, Luis Benites &lt;<a href="mailto:lsanchez@ime.usp.br">lsanchez@ime.usp.br</a>&gt; and
Victor H. Lachos &lt;<a href="mailto:hlachos@ime.unicamp.br">hlachos@ime.unicamp.br</a>&gt;
</p>
<p>Maintainer: Christian E. Galarza &lt;<a href="mailto:cgalarza88@gmail.com">cgalarza88@gmail.com</a>&gt;
</p>


<h3>References</h3>

<p>Galarza, C.M., Zhang P. and Lachos, V.H. (2020). Logistic Quantile Regression for Bounded Outcomes Using
a Family of Heavy-Tailed Distributions. Sankhya B: The Indian Journal of Statistics. doi: <a href="https://doi.org/10.1007/s13571-020-00231-0">10.1007/s13571-020-00231-0</a>
</p>
<p>Galarza, C., Lachos, V. H., Cabral, C. R. B., &amp; Castro, C. L. (2017). Robust quantile regression using a generalized class of skewed distributions. Stat, 6(1), 113-130.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Log.lqr">Log.lqr</a></code>,<code><a href="#topic+best.lqr">best.lqr</a></code>,<code><a href="#topic+dSKD">dSKD</a></code>

</p>


<h3>Examples</h3>

<pre><code class='language-R'>

##Load the data
data(resistance)
attach(resistance)

#EXAMPLE 1.1

#Comparing the resistence to death of two types of tumor-cells.
#The response is a score in [0,4].

boxplot(score~type)

#Median logistic quantile regression (Best fit distribution)
res = Log.best.lqr(formula = score~type,data = resistance,a=0,b=4)

# The odds ratio of median score in type B vs type A
exp(res$beta[2])

#Proving that exp(res$beta[2])  is approx median odd ratio
medA  = median(score[type=="A"])
medB  = median(score[type=="B"])
rateA = (medA - 0)/(4 - medA)
rateB = (medB - 0)/(4 - medB)
odd   = rateB/rateA

round(c(exp(res$beta[2]),odd),3) #best fit

#EXAMPLE 1.2
############

#Comparing the resistence to death depending of dose.

#descriptive
plot(dose,score,ylim=c(0,4),col="dark gray");abline(h=c(0,4),lty=2)
dosecat&lt;-cut(dose, 6, ordered = TRUE)
boxplot(score~dosecat,ylim=c(0,4))
abline(h=c(0,4),lty=2)

#(Non logistic) Best quantile regression for quantiles
# 0.05, 0.50 and 0.95
p05 = best.lqr(score~poly(dose,3),data = resistance,p = 0.05)
p50 = best.lqr(score~poly(dose,3),data = resistance,p = 0.50)
p95 = best.lqr(score~poly(dose,3),data = resistance,p = 0.95)
res3  = list(p05,p50,p95)

plot(dose,score,ylim=c(-1,5),col="gray");abline(h=c(0,4),lty=2)
lines(sort(dose), p05$fitted.values[order(dose)], col='red', type='l')
lines(sort(dose), p50$fitted.values[order(dose)], col='blue', type='l')
lines(sort(dose), p95$fitted.values[order(dose)], col='red', type='l')

#Using logistic quantile regression for obtaining predictions inside bounds

logp05 = Log.best.lqr(score~poly(dose,3),data = resistance,p = 0.05,b = 4) #a = 0 by default
logp50 = Log.best.lqr(score~poly(dose,3),data = resistance,p = 0.50,b = 4)
logp95 = Log.best.lqr(score~poly(dose,3),data = resistance,p = 0.95,b = 4)
res4  = list(logp05,logp50,logp95)

#No more prediction curves out-of-bounds
plot(dose,score,ylim=c(-1,5),col="gray");abline(h=c(0,4),lty=2)
lines(sort(dose), logp05$fitted.values[order(dose)], col='red', type='l')
lines(sort(dose), logp50$fitted.values[order(dose)], col='blue', type='l')
lines(sort(dose), logp95$fitted.values[order(dose)], col='red', type='l')


</code></pre>

<hr>
<h2 id='Log.lqr'>
Robust Logistic Linear Quantile Regression
</h2><span id='topic+Log.lqr'></span>

<h3>Description</h3>

<p>It performs the logistic transformation in Galarza et.al.(2020) (see references) for estimating quantiles for a bounded response. Once the response is transformed, it uses the <code>lqr</code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Log.lqr(formula,data = NULL,subset = NULL,
                   p=0.5,a=0,b=1,
                   dist = "normal",
                   nu=NULL,
                   gamma=NULL,
                   precision = 10^-6,
                   epsilon = 0.001,
                   CI=0.95,
                   silent = FALSE)
</code></pre>


<h3>Arguments</h3>

<p>We will detail first the only three arguments that differ from <code>lqr</code> function.
</p>
<table>
<tr><td><code id="Log.lqr_+3A_a">a</code></td>
<td>

<p>lower bound for the response (default = 0)
</p>
</td></tr>
<tr><td><code id="Log.lqr_+3A_b">b</code></td>
<td>

<p>upper bound for the response (default = 1)
</p>
</td></tr>
<tr><td><code id="Log.lqr_+3A_epsilon">epsilon</code></td>
<td>

<p>a small quantity <code class="reqn">\epsilon&gt;0</code> that ensures that the logistic transform is defined for all values of the response.
</p>
</td></tr>
<tr><td><code id="Log.lqr_+3A_formula">formula</code></td>
<td>

<p>an object of class &quot;formula&quot; (or one that can be coerced to that class): a symbolic description of the model to be fitted.
</p>
</td></tr>
<tr><td><code id="Log.lqr_+3A_data">data</code></td>
<td>

<p>an optional data frame, list or environment (or object coercible by <code>as.data.frame</code> to a data frame) containing the variables in the model. If not found in <code>data</code>, the variables are taken from <code>environment(formula)</code>.
</p>
</td></tr>
<tr><td><code id="Log.lqr_+3A_subset">subset</code></td>
<td>

<p>an optional string specifying a subset of observations to be used in the fitting process. Be aware of the use of double quotes in a proper way when necessary, e.g., in <code>"(sex=='F')"</code>.
</p>
</td></tr>  
<tr><td><code id="Log.lqr_+3A_p">p</code></td>
<td>

<p>An unique quantile or a set of quantiles related to the quantile regression.
</p>
</td></tr>
<tr><td><code id="Log.lqr_+3A_dist">dist</code></td>
<td>

<p>represents the distribution to be used for the error term. The values are <code>normal</code> for Normal distribution, <code>t</code> for Student's t distribution, <code>laplace</code> for Laplace distribution, <code>slash</code> for Slash distribution and <code>cont</code> for the Contaminated normal distribution.
</p>
</td></tr>
<tr><td><code id="Log.lqr_+3A_nu">nu</code></td>
<td>

<p>It represents the degrees of freedom when <code>dist = t</code>. For the Slash distribution (<code>dist = slash</code>) it is a shape parameter <code class="reqn">\nu&gt;0</code>. For the Contaminated Normal distribution, <code class="reqn">\nu</code> is the parameter that represents the percentage of outliers. When is not provided, we use the MLE.
</p>
</td></tr>
<tr><td><code id="Log.lqr_+3A_gamma">gamma</code></td>
<td>

<p>It represents a scale factor for the contaminated normal distribution. When is not provided, we use the MLE.
</p>
</td></tr>
<tr><td><code id="Log.lqr_+3A_precision">precision</code></td>
<td>

<p>The convergence maximum error permitted. By default is 10^-6.
</p>
</td></tr>
<tr><td><code id="Log.lqr_+3A_ci">CI</code></td>
<td>

<p>Confidence to be used for the Confidence Interval when a grid of quantiles is provided. Default = 0.95.
</p>
</td></tr>
<tr><td><code id="Log.lqr_+3A_silent">silent</code></td>
<td>

<p>if <code>FALSE</code> (by default), the function prints some output.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We follow the transformation in Bottai et.al. (2009) defined as
</p>
<p style="text-align: center;"><code class="reqn">h(y)=logit(y)=log(\frac{y-a}{b-y})</code>
</p>

<p>that implies
</p>
<p style="text-align: center;"><code class="reqn">Q_{y}(p)=\frac{b\,exp(X\beta) + a}{1 + exp(X\beta)}</code>
</p>

<p>where <code class="reqn">Q_{y}(p)</code> represents the conditional quantile of the response. Once estimates for the regression coefficients <code class="reqn">\beta_p</code> are obtained, inference on <code class="reqn">Q_{y}(p)</code> can then be made through the inverse transform above. This equation (as function) is provided in the output. See example.
</p>
<p>The interpretation of the regression coefficients is analogous to the interpretation of the coefficients of a logistic regression for binary outcomes.
</p>
<p>For example, let <code class="reqn">x_1</code> be the gender (male = 0, female=1). Then <code class="reqn">exp(\beta_{0.5,1})</code> represents the odds ratio of median score in males vs females, where the odds are defined using the score instead of a probability, <code class="reqn">(y-a)/(b-y)</code>. When the covariate is continous, the respective <code class="reqn">\beta</code> coeficient can be interpretated as the increment (or decrement) over the log(odd ratio) when the covariate increases one unit.
</p>


<h3>Value</h3>

<table>
<tr><td><code>iter</code></td>
<td>
<p>number of iterations.</p>
</td></tr>
<tr><td><code>criteria</code></td>
<td>
<p>attained criteria value.</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>fixed effects estimates.</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>scale parameter estimate for the error term.</p>
</td></tr>
<tr><td><code>nu</code></td>
<td>
<p>Estimate of <code>nu</code> parameter detailed above.</p>
</td></tr>
<tr><td><code>gamma</code></td>
<td>
<p>Estimate of <code>gamma</code> parameter detailed above.</p>
</td></tr>
<tr><td><code>SE</code></td>
<td>
<p>Standard Error estimates.</p>
</td></tr>
<tr><td><code>table</code></td>
<td>
<p>Table containing the inference for the fixed effects parameters.</p>
</td></tr>
<tr><td><code>loglik</code></td>
<td>
<p>Log-likelihood value.</p>
</td></tr>
<tr><td><code>AIC</code></td>
<td>
<p>Akaike information criterion.</p>
</td></tr>
<tr><td><code>BIC</code></td>
<td>
<p>Bayesian information criterion.</p>
</td></tr>
<tr><td><code>HQ</code></td>
<td>
<p>Hannan-Quinn information criterion.</p>
</td></tr>
<tr><td><code>fitted.values</code></td>
<td>
<p>vector containing the fitted values.</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>vector containing the residuals.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>When a grid of quantiles is provided, a graphical summary with point estimates and Confidence Intervals for model parameters is shown. Also, the result will be a list of the same dimension where each element corresponds to each quantile as detailed above.
</p>


<h3>Author(s)</h3>

<p>Christian E. Galarza &lt;<a href="mailto:cgalarza88@gmail.com">cgalarza88@gmail.com</a>&gt;, Luis Benites &lt;<a href="mailto:lsanchez@ime.usp.br">lsanchez@ime.usp.br</a>&gt; and
Victor H. Lachos &lt;<a href="mailto:hlachos@ime.unicamp.br">hlachos@ime.unicamp.br</a>&gt;
</p>
<p>Maintainer: Christian E. Galarza &lt;<a href="mailto:cgalarza88@gmail.com">cgalarza88@gmail.com</a>&gt;
</p>


<h3>References</h3>

<p>Galarza, C.M., Zhang P. and Lachos, V.H. (2020). Logistic Quantile Regression for Bounded Outcomes Using
a Family of Heavy-Tailed Distributions. Sankhya B: The Indian Journal of Statistics. doi: <a href="https://doi.org/10.1007/s13571-020-00231-0">10.1007/s13571-020-00231-0</a>
</p>
<p>Galarza, C., Lachos, V. H., Cabral, C. R. B., &amp; Castro, C. L. (2017). Robust quantile regression using a generalized class of skewed distributions. Stat, 6(1), 113-130.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Log.best.lqr">Log.best.lqr</a></code>,<code><a href="#topic+best.lqr">best.lqr</a></code>,<code><a href="#topic+dSKD">dSKD</a></code>

</p>


<h3>Examples</h3>

<pre><code class='language-R'>

##Load the data
data(resistance)
attach(resistance)

#EXAMPLE 1.1

#Comparing the resistence to death of two types of tumor-cells.
#The response is a score in [0,4].

boxplot(score~type,ylab="score",xlab="type")

#Student't median logistic quantile regression
res = Log.lqr(score~type,data = resistance,a=0,b=4,dist="t")

# The odds ratio of median score in type B vs type A
exp(res$beta[2])

#Proving that exp(res$beta[2])  is approx median odd ratio
medA  = median(score[type=="A"])
medB  = median(score[type=="B"])
rateA = (medA - 0)/(4 - medA)
rateB = (medB - 0)/(4 - medB)
odd   = rateB/rateA

round(c(exp(res$beta[2]),odd),3)


#EXAMPLE 1.2
############

#Comparing the resistence to death depending of dose.

#descriptive
plot(dose,score,ylim=c(0,4),col="dark gray");abline(h=c(0,4),lty=2)
dosecat&lt;-cut(dose, 6, ordered = TRUE)
boxplot(score~dosecat,ylim=c(0,4))
abline(h=c(0,4),lty=2)

#(Non logistic) Best quantile regression for quantiles
# 0.05, 0.50 and 0.95
p05 = best.lqr(score~poly(dose,3),data = resistance,p = 0.05)
p50 = best.lqr(score~poly(dose,3),data = resistance,p = 0.50)
p95 = best.lqr(score~poly(dose,3),data = resistance,p = 0.95)
res3  = list(p05,p50,p95)

plot(dose,score,ylim=c(-1,5),col="gray");abline(h=c(0,4),lty=2)
lines(sort(dose), p05$fitted.values[order(dose)], col='red', type='l')
lines(sort(dose), p50$fitted.values[order(dose)], col='blue', type='l')
lines(sort(dose), p95$fitted.values[order(dose)], col='red', type='l')

#Using Student's t logistic quantile regression for obtaining preditypeBions inside bounds

logp05 = Log.lqr(score~poly(dose,3),data = resistance,p = 0.05,b = 4,dist = "t") #a = 0 by default
logp50 = Log.lqr(score~poly(dose,3),data = resistance,p = 0.50,b = 4,dist = "t")
logp95 = Log.lqr(score~poly(dose,3),data = resistance,p = 0.95,b = 4,dist = "t")
res4  = list(logp05,logp50,logp95)

#No more predited curves out-of-bounds
plot(dose,score,ylim=c(-1,5),col="gray");abline(h=c(0,4),lty=2)
lines(sort(dose), logp05$fitted.values[order(dose)], col='red', type='l')
lines(sort(dose), logp50$fitted.values[order(dose)], col='blue', type='l')
lines(sort(dose), logp95$fitted.values[order(dose)], col='red', type='l')

#EXAMPLE 1.3
############

#A full model using dose and type for a grid of quantiles

res5 = Log.lqr(formula = score ~ poly(dose,3)*type,data = resistance,
               a = 0,b = 4,
               p = seq(from = 0.05,to = 0.95,by = 0.05),dist = "t",
               silent = TRUE)

#A nice plot

if(TRUE){
  par(mfrow=c(1,2))
  typeB = (resistance$type == "B")
  
  plot(dose,score,
       ylim=c(0,4),
       col=c(8*typeB + 1*!typeB),main="Type A")
  abline(h=c(0,4),lty=2)
  
  lines(sort(dose[!typeB]),
        res5[[2]]$fitted.values[!typeB][order(dose[!typeB])],
        col='red')
  
  lines(sort(dose[!typeB]),
        res5[[5]]$fitted.values[!typeB][order(dose[!typeB])],
        col='green')
  
  lines(sort(dose[!typeB]),
        res5[[10]]$fitted.values[!typeB][order(dose[!typeB])],
        col='blue',lwd=2)
  
  lines(sort(dose[!typeB]),
        res5[[15]]$fitted.values[!typeB][order(dose[!typeB])],
        col='green')
  
  lines(sort(dose[!typeB]),
        res5[[18]]$fitted.values[!typeB][order(dose[!typeB])],
        col='red')
  
  plot(dose,score,
       ylim=c(0,4),
       col=c(1*typeB + 8*!typeB),main="Type B")
  abline(h=c(0,4),lty=2)
  
  lines(sort(dose[typeB]),
        res5[[2]]$fitted.values[typeB][order(dose[typeB])],
        col='red')
  
  lines(sort(dose[typeB]),
        res5[[5]]$fitted.values[typeB][order(dose[typeB])],
        col='green')
  
  lines(sort(dose[typeB]),
        res5[[10]]$fitted.values[typeB][order(dose[typeB])],
        col='blue',lwd=2)
  
  lines(sort(dose[typeB]),
        res5[[15]]$fitted.values[typeB][order(dose[typeB])],
        col='green')
  
  lines(sort(dose[typeB]),
        res5[[18]]$fitted.values[typeB][order(dose[typeB])],
        col='red')
}

</code></pre>

<hr>
<h2 id='lqr'>
Robust Linear Quantile Regression
</h2><span id='topic+lqr'></span>

<h3>Description</h3>

<p>It fits a robust linear quantile regression model using a new family of zero-quantile distributions for the error term. This family of distribution includes skewed versions of the Normal, Student's t, Laplace, Slash and Contaminated Normal distribution. It provides estimates and full inference. It also provides envelopes plots for assessing the fit and confidences bands when several quantiles are provided simultaneously.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lqr(formula,data = NULL,subset = NULL,
               p=0.5,dist = "normal",
               nu=NULL,gamma=NULL,
               precision = 10^-6,envelope=FALSE,
               CI=0.95,silent = FALSE
)

#lqr(y~x, data, p = 0.5, dist = "normal")
#lqr(y~x, data, p = 0.5, dist = "t")
#lqr(y~x, data, p = 0.5, dist = "laplace")
#lqr(y~x, data, p = 0.5, dist = "slash")
#lqr(y~x, data, p = 0.5, dist = "cont")

#lqr(y~x, p = c(0.25,0.50,0.75), dist = "normal")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lqr_+3A_formula">formula</code></td>
<td>

<p>an object of class &quot;formula&quot; (or one that can be coerced to that class): a symbolic description of the model to be fitted.
</p>
</td></tr>
<tr><td><code id="lqr_+3A_data">data</code></td>
<td>

<p>an optional data frame, list or environment (or object coercible by <code>as.data.frame</code> to a data frame) containing the variables in the model. If not found in <code>data</code>, the variables are taken from <code>environment(formula)</code>.
</p>
</td></tr>
<tr><td><code id="lqr_+3A_subset">subset</code></td>
<td>

<p>an optional string specifying a subset of observations to be used in the fitting process. Be aware of the use of double quotes in a proper way when necessary, e.g., in <code>"(sex=='F')"</code>.
</p>
</td></tr>  
<tr><td><code id="lqr_+3A_p">p</code></td>
<td>

<p>An unique quantile or a set of quantiles related to the quantile regression.
</p>
</td></tr>
<tr><td><code id="lqr_+3A_dist">dist</code></td>
<td>

<p>represents the distribution to be used for the error term. The values are <code>normal</code> for Normal distribution, <code>t</code> for Student's t distribution, <code>laplace</code> for Laplace distribution, <code>slash</code> for Slash distribution and <code>cont</code> for the Contaminated normal distribution.
</p>
</td></tr>
<tr><td><code id="lqr_+3A_nu">nu</code></td>
<td>

<p>It represents the degrees of freedom when <code>dist = t</code>. For the Slash distribution (<code>dist = slash</code>) it is a shape parameter <code class="reqn">\nu&gt;0</code>. For the Contaminated Normal distribution, <code class="reqn">\nu</code> is the parameter that represents the percentage of outliers. When is not provided, we use the MLE.
</p>
</td></tr>
<tr><td><code id="lqr_+3A_gamma">gamma</code></td>
<td>

<p>It represents a scale factor for the contaminated normal distribution. When is not provided, we use the MLE.
</p>
</td></tr>
<tr><td><code id="lqr_+3A_precision">precision</code></td>
<td>

<p>The convergence maximum error permitted. By default is 10^-6.
</p>
</td></tr>
<tr><td><code id="lqr_+3A_envelope">envelope</code></td>
<td>

<p>if <code>TRUE</code>, it will show a confidence envelope for a curve based on bootstrap replicates.
By default it is <code>TRUE</code> when just one quantile is provided.
If a grid of quantiles is provided it will be <code>FALSE</code> by default.
</p>
</td></tr>
<tr><td><code id="lqr_+3A_ci">CI</code></td>
<td>

<p>Confidence to be used for the Confidence Interval when a grid of quantiles is provided. Default = 0.95.
</p>
</td></tr>
<tr><td><code id="lqr_+3A_silent">silent</code></td>
<td>

<p>if <code>FALSE</code> (by default), the function prints some output.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When a grid of quantiles is provided, a graphical summary with point estimates and Confidence Intervals for model parameters is shown.
</p>


<h3>Value</h3>

<table>
<tr><td><code>iter</code></td>
<td>
<p>number of iterations.</p>
</td></tr>
<tr><td><code>criteria</code></td>
<td>
<p>attained criteria value.</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>fixed effects estimates.</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>scale parameter estimate for the error term.</p>
</td></tr>
<tr><td><code>nu</code></td>
<td>
<p>Estimate of <code>nu</code> parameter detailed above.</p>
</td></tr>
<tr><td><code>gamma</code></td>
<td>
<p>Estimate of <code>gamma</code> parameter detailed above.</p>
</td></tr>
<tr><td><code>SE</code></td>
<td>
<p>Standard Error estimates.</p>
</td></tr>
<tr><td><code>table</code></td>
<td>
<p>Table containing the inference for the fixed effects parameters.</p>
</td></tr>
<tr><td><code>loglik</code></td>
<td>
<p>Log-likelihood value.</p>
</td></tr>
<tr><td><code>AIC</code></td>
<td>
<p>Akaike information criterion.</p>
</td></tr>
<tr><td><code>BIC</code></td>
<td>
<p>Bayesian information criterion.</p>
</td></tr>
<tr><td><code>HQ</code></td>
<td>
<p>Hannan-Quinn information criterion.</p>
</td></tr>
<tr><td><code>fitted.values</code></td>
<td>
<p>vector containing the fitted values.</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>vector containing the residuals.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>If a grid of quantiles is provided, the result will be a list of the same dimension where each element corresponds to each quantile as detailed above.
</p>


<h3>Author(s)</h3>

<p>Christian E. Galarza &lt;<a href="mailto:cgalarza88@gmail.com">cgalarza88@gmail.com</a>&gt;, Luis Benites &lt;<a href="mailto:lsanchez@ime.usp.br">lsanchez@ime.usp.br</a>&gt; and
Victor H. Lachos &lt;<a href="mailto:hlachos@ime.unicamp.br">hlachos@ime.unicamp.br</a>&gt;
</p>
<p>Maintainer: Christian E. Galarza &lt;<a href="mailto:cgalarza88@gmail.com">cgalarza88@gmail.com</a>&gt;
</p>


<h3>References</h3>

<p>Galarza, C., Lachos, V. H., Cabral, C. R. B., &amp; Castro, C. L. (2017). Robust quantile regression using a generalized class of skewed distributions. Stat,
6(1), 113-130.
</p>
<p>Wichitaksorn, N., Choy, S. T., &amp; Gerlach, R. (2014). A generalized class of skew distributions and associated robust quantile regression models. Canadian Journal of Statistics, 42(4), 579-596.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cens.lqr">cens.lqr</a></code>,<code><a href="#topic+best.lqr">best.lqr</a></code>,<code><a href="#topic+Log.lqr">Log.lqr</a></code>,
<code><a href="#topic+Log.best.lqr">Log.best.lqr</a></code>,<code><a href="#topic+dSKD">dSKD</a></code>

</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#Example 1

##Load the data
data(ais)
attach(ais)

## Fitting a median regression with Normal errors (by default)

modelF = lqr(BMI~LBM,data = ais,subset = "(Sex==1)")
modelM = lqr(BMI~LBM,data = ais,subset = "(Sex==0)")

plot(LBM,BMI,col=Sex*2+1,
     xlab="Lean Body Mass",
     ylab="Body4 Mass Index",
     main="Quantile Regression")

abline(a = modelF$beta[1],b = modelF$beta[2],lwd=2,col=3)
abline(a = modelM$beta[1],b = modelM$beta[2],lwd=2,col=1)
legend(x = "topleft",legend = c("Male","Female"),lwd = 2,col = c(1,3))

#COMPARING SOME MODELS for median regression
modelN  = lqr(BMI~LBM,dist = "normal")
modelT  = lqr(BMI~LBM,dist = "t")
modelL  = lqr(BMI~LBM,dist = "laplace")

#Comparing AIC criteria
modelN$AIC;modelT$AIC;modelL$AIC

#This could be automatically done using best.lqr()
best.model = best.lqr(BMI~LBM,data = ais,
                      p = 0.75, #third quartile
                      criterion = "AIC")

#Let's use a grid of quantiles (no output)
modelfull = lqr(BMI~LBM,data = ais,
                p = seq(from = 0.10,to = 0.90,by = 0.05),
                dist = "normal",silent = TRUE)

#Plotting quantiles 0.10,0.25,0.50,0.75 and 0.90

if(TRUE){
  plot(LBM,BMI,xlab = "Lean Body Mass"
       ,ylab = "Body Mass Index", main = "Quantile Regression",pch=16)
  
  colvec = c(2,2,3,3,4)
  imodel = c(1,17,4,14,9)
  for(i in 1:5){
    abline(a = modelfull[[imodel[i]]]$beta[1],
           b = modelfull[[imodel[i]]]$beta[2],
           lwd=2,col=colvec[i])  
  }
  legend(x = "topleft",
         legend = rev(c("0.10","0.25","0.50","0.75","0.90")),
         lwd = 2,col = c(2,3,4,3,2))
}

#Example 2
##Load the data

data(crabs,package = "MASS")
attach(crabs)

## Fitting a median regression with Normal errors (by default) #Note the double quotes
crabsF = lqr(BD~FL,data = crabs,subset = "(sex=='F')")
crabsM = lqr(BD~FL,data = crabs,subset = "(sex=='M')")

if(TRUE){
  plot(FL,BD,col=as.numeric(sex)+1,
       xlab="Frontal lobe size",ylab="Body depth",main="Quantile Regression")
  abline(a = crabsF$beta[1],b = crabsF$beta[2],lwd=2,col=2)
  abline(a = crabsM$beta[1],b = crabsM$beta[2],lwd=2,col=3)
  legend(x = "topleft",legend = c("Male","Female"),
         lwd = 2,col = c(3,2))
}

#Median regression for different distributions

modelN  = lqr(BD~FL,dist = "normal")
modelT  = lqr(BD~FL,dist = "t")
modelL  = lqr(BD~FL,dist = "laplace")
modelS  = lqr(BD~FL,dist = "slash")
modelC  = lqr(BD~FL,dist = "cont" )

#Comparing AIC criterias
modelN$AIC;modelT$AIC;modelL$AIC;modelS$AIC;modelC$AIC

# best model based on BIC
best.lqr(BD~FL,criterion = "BIC")

#Let's use a grid of quantiles for the Student's t distribution
modelfull = lqr(BD~FL,data = crabs,
                p = seq(from = 0.10,to = 0.90,by = 0.05),
                dist = "t") # silent = FALSE

#Plotting quantiles 0.10,0.25,0.50,0.75 and 0.90
if(TRUE){
  plot(FL,BD,xlab = "Frontal lobe size"
       ,ylab = "Body depth", main = "Quantile Regression",pch=16)
  colvec = c(2,2,3,3,4)
  imodel = c(1,17,4,14,9)
  for(i in 1:5){
    abline(a = modelfull[[imodel[i]]]$beta[1],
           b = modelfull[[imodel[i]]]$beta[2],
           lwd=2,col=colvec[i])  
  }
  legend(x = "topleft",
         legend = rev(c("0.10","0.25","0.50","0.75","0.90")),
         lwd = 2,col = c(2,3,4,3,2))
}

</code></pre>

<hr>
<h2 id='lqr-package'>
Robust Linear Quantile Regression
</h2><span id='topic+lqr-package'></span><span id='topic+lqr-package'></span>

<h3>Description</h3>

<p>It fits a robust linear quantile regression model using a new family of zero-quantile distributions for the error term. This family of distribution includes skewed versions of the Normal, Student's t, Laplace, Slash and Contaminated Normal distribution. It provides estimates and full inference. It also provides envelopes plots for assessing the fit and confidences bands when several quantiles are provided simultaneously. Details of its first version can be found below.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> lqr</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.0</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2015-10-29</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;=2)</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Christian E. Galarza &lt;<a href="mailto:cgalarza88@gmail.com">cgalarza88@gmail.com</a>&gt;, Luis Benites &lt;<a href="mailto:lsanchez@ime.usp.br">lsanchez@ime.usp.br</a>&gt; and 
Victor H. Lachos &lt;<a href="mailto:hlachos@ime.unicamp.br">hlachos@ime.unicamp.br</a>&gt;
</p>
<p>Maintainer: Christian E. Galarza &lt;<a href="mailto:cgalarza88@gmail.com">cgalarza88@gmail.com</a>&gt;
</p>


<h3>References</h3>

<p>Galarza, C., Lachos, V. H. &amp; Bourguignon M. (2021). A skew-t quantile regression for censored and missing data. Stat.&lt;doi:10.1002/sta4.379&gt;.
</p>
<p>Galarza C.E., Lachos V.H. &amp; Panpan Z. (2020) Logistic quantile regression for bounded outcomes using a family of heavy-tailed distributions. Sankhya B. &lt;doi:10.1007/s13571-020-00231-0&gt;.
</p>
<p>Galarza, C., Lachos, V. H., Cabral, C. R. B., &amp; Castro, C. L. (2017). Robust quantile regression using a generalized class of skewed distributions. Stat,
6(1), 113-130.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+SKD">SKD</a></code>,<code><a href="#topic+Log.best.lqr">Log.best.lqr</a></code>,
<code><a href="#topic+Log.lqr">Log.lqr</a></code>,<code><a href="#topic+best.lqr">best.lqr</a></code>,<code><a href="#topic+lqr">lqr</a></code>,
<code><a href="#topic+ais">ais</a></code>


</p>

<hr>
<h2 id='resistance'>Tumor-cell resistance to death</h2><span id='topic+resistance'></span>

<h3>Description</h3>

<p>Artificial dataset. The experiment consists in measure the resistance to death of two types of tumor-cells over different doses of a experimental drug. The data was created considering a null intercept and a cubic polinomial for the dose.
</p>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>dose</dt><dd>
<p>Quantity of dose of an experimental drug.
</p>
</dd>
<dt>type</dt><dd>
<p>Type of tumor-cell. Type A and B.
</p>
</dd>
<dt>score</dt><dd>
<p>Bounded response between 0 and 4.
</p>
</dd>
</dl>



<h3>Details</h3>

<p>This dataset was generated in order to be fitted with a logistic quantile regression since the response is bounded.
</p>

<hr>
<h2 id='SKD'>Skew Family Distributions
</h2><span id='topic+SKD'></span><span id='topic+dSKD'></span><span id='topic+pSKD'></span><span id='topic+qSKD'></span><span id='topic+rSKD'></span>

<h3>Description</h3>

<p>Density, distribution function, quantile function and random generation for a Skew Family Distribution useful for quantile regression. This family of distribution includes skewed versions of the Normal, Student's t, Laplace, Slash and Contaminated Normal distribution, all with location parameter equal to <code>mu</code>, scale parameter <code>sigma</code> and skewness parameter <code>p</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dSKD(y, mu = 0, sigma = 1, p = 0.5, dist = "normal", nu = "", gamma = "")
pSKD(q, mu = 0, sigma = 1, p = 0.5, dist = "normal", nu = "", gamma = "",
lower.tail = TRUE)
qSKD(prob, mu = 0, sigma = 1, p = 0.5, dist = "normal", nu = "", gamma = "",
lower.tail = TRUE)
rSKD(n, mu = 0, sigma = 1, p = 0.5, dist = "normal", nu = "", gamma = "")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SKD_+3A_y">y</code>, <code id="SKD_+3A_q">q</code></td>
<td>

<p>vector of quantiles.
</p>
</td></tr>
<tr><td><code id="SKD_+3A_prob">prob</code></td>
<td>

<p>vector of probabilities.
</p>
</td></tr>
<tr><td><code id="SKD_+3A_n">n</code></td>
<td>

<p>number of observations.
</p>
</td></tr>
<tr><td><code id="SKD_+3A_mu">mu</code></td>
<td>

<p>location parameter.
</p>
</td></tr>
<tr><td><code id="SKD_+3A_sigma">sigma</code></td>
<td>

<p>scale parameter.
</p>
</td></tr>
<tr><td><code id="SKD_+3A_p">p</code></td>
<td>

<p>skewness parameter.
</p>
</td></tr>
<tr><td><code id="SKD_+3A_dist">dist</code></td>
<td>

<p>represents the distribution to be used for the error term. The values are <code>normal</code> for Normal distribution, <code>t</code> for Student's t distribution, <code>laplace</code> for Laplace distribution, <code>slash</code> for Slash distribution and <code>cont</code> for the Contaminated normal distribution.
</p>
</td></tr>
<tr><td><code id="SKD_+3A_nu">nu</code></td>
<td>

<p>It represents the degrees of freedom when <code>dist = t</code>. For the Slash distribution (<code>dist = slash</code>) it is a shape parameter <code class="reqn">\nu&gt;0</code>. For the Contaminated Normal distribution, <code class="reqn">\nu</code> is the parameter that represents the percentage of outliers. When is not provided, we use the MLE.
</p>
</td></tr>
<tr><td><code id="SKD_+3A_gamma">gamma</code></td>
<td>

<p>It represents a scale factor for the contaminated normal distribution. When is not provided, we use the MLE.
</p>
</td></tr>
<tr><td><code id="SKD_+3A_lower.tail">lower.tail</code></td>
<td>

<p>logical; if TRUE (default), probabilities are P[X <code class="reqn">\le</code> x] otherwise, P[X &gt; x].
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>mu</code>, <code>sigma</code>, <code>p</code> or <code>dist</code> are not specified they assume the default values of 0, 1, 0.5 and <code>normal</code>, respectively, belonging to the Symmetric Standard Normal Distribution denoted by <code class="reqn">SKN(0,1,0.5)</code>.
</p>
<p>The scale parameter <code>sigma</code> must be positive and non zero. The skew parameter <code>p</code> must be between zero and one (0&lt;<code>p</code>&lt;1).
</p>
<p>This family of distributions generalize the skew distributions in Wichitaksorn et.al. (2014) as an scale mixture of skew normal distribution. Also the Three-Parameter Asymmetric Laplace Distribution defined in Koenker and Machado (1999) is a special case.
</p>


<h3>Value</h3>

<p><code>dSKD</code> gives the density, <code>pSKD</code> gives the distribution function, <code>qSKD</code> gives the quantile function, and <code>rSKD</code> generates a random sample.
</p>
<p>The length of the result is determined by n for <code>rSKD</code>, and is the maximum of the lengths of the numerical arguments for the other functions <code>dSKD</code>, <code>pSKD</code> and <code>qSKD</code>.
</p>


<h3>Note</h3>

<p>The numerical arguments other than <code>n</code> are recycled to the length of the result.
</p>


<h3>Author(s)</h3>

<p>Christian E. Galarza &lt;<a href="mailto:cgalarza88@gmail.com">cgalarza88@gmail.com</a>&gt;, Luis Benites &lt;<a href="mailto:lsanchez@ime.usp.br">lsanchez@ime.usp.br</a>&gt; and
Victor H. Lachos &lt;<a href="mailto:hlachos@ime.unicamp.br">hlachos@ime.unicamp.br</a>&gt;
</p>
<p>Maintainer: Christian E. Galarza &lt;<a href="mailto:cgalarza88@gmail.com">cgalarza88@gmail.com</a>&gt;
</p>


<h3>References</h3>

<p>Galarza, C., Lachos, V. H., Cabral, C. R. B., &amp; Castro, C. L. (2017). Robust quantile regression using a generalized class of skewed distributions. Stat,
6(1), 113-130.
</p>
<p>Wichitaksorn, N., Choy, S. T., &amp; Gerlach, R. (2014). A generalized class of skew distributions and associated robust quantile regression models. Canadian Journal of Statistics, 42(4), 579-596.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lqr">lqr</a></code>,<code><a href="#topic+ais">ais</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Let's plot (Normal Vs. Student-t's with 4 df)
##Density
sseq = seq(15,65,length.out = 1000)
dens = dSKD(y=sseq,mu=50,sigma=3,p=0.75)
plot(sseq,dens,type="l",lwd=2,col="red",xlab="x",ylab="f(x)", main="Normal Vs. t(4) densities")
dens2 = dSKD(y=sseq,mu=50,sigma=3,p=0.75,dist="t",nu=4)
lines(sseq,dens2,type="l",lwd=2,col="blue",lty=2)

## Distribution Function
df = pSKD(q=sseq,mu=50,sigma=3,p=0.75,dist = "laplace")
plot(sseq,df,type="l",lwd=2,col="blue",xlab="x",ylab="F(x)", main="Laplace Distribution function")
abline(h=1,lty=2)

##Inverse Distribution Function
prob = seq(0.001,0.999,length.out = 1000)
idf = qSKD(prob=prob,mu=50,sigma=3,p=0.25,dist="cont",nu=0.3,gamma=0.1) # 1 min appox
plot(prob,idf,type="l",lwd=2,col="gray30",xlab="x",ylab=expression(F^{-1}~(x)))
title(main="Skew Cont. Normal Inverse Distribution function")
abline(v=c(0,1),lty=2)

#Random Sample Histogram
sample = rSKD(n=20000,mu=50,sigma=3,p=0.2,dist="slash",nu=3)
seqq2 = seq(25,100,length.out = 1000)
dens3 = dSKD(y=seqq2,mu=50,sigma=3,p=0.2,dist="slash",nu=3)
hist(sample,breaks = 70,freq = FALSE,ylim=c(0,1.05*max(dens3,na.rm = TRUE)),main="")
title(main="Histogram and True density")
lines(seqq2,dens3,col="blue",lwd=2)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
