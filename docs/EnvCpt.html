<!DOCTYPE html><html><head><title>Help for package EnvCpt</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {EnvCpt}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#AIC.envcpt'>
<p>Computes the AIC/BIC measure for output from the envcpt function.</p></a></li>
<li><a href='#AICweights'>
<p>Computes the AIC weights for output from the envcpt function.</p></a></li>
<li><a href='#envcpt'>
<p>Assesses whether an environmental time series contains trend, autocorrelation and/or changes</p></a></li>
<li><a href='#EnvCpt-package'>
<p>Detection of Structural Changes in Climate and Environment Time Series</p></a></li>
<li><a href='#plot.envcpt'>
<p>Plots optionally either (&quot;fit&quot;) the data and fits from each of the 8 models or (&quot;aic&quot;) the aic for each of the 8 models.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Detection of Structural Changes in Climate and Environment Time
Series</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-03-29</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Rebecca Killick &lt;r.killick@lancs.ac.uk&gt;</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/rkillick/EnvCpt/">https://github.com/rkillick/EnvCpt/</a></td>
</tr>
<tr>
<td>Description:</td>
<td>Tools for automatic model selection and diagnostics for Climate and Environmental data.  In particular the envcpt() function does automatic model selection between a variety of trend, changepoint and autocorrelation models.  The envcpt() function should be your first port of call.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R(&ge; 3.3), changepoint(&ge; 2.2.2), grDevices, MASS, methods,
stats, utils, zoo</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL]</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-03-29 10:43:08 UTC; killick</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Author:</td>
<td>Rebecca Killick [aut, cre],
  Claudie Beaulieu [aut],
  Simon Taylor [aut],
  Harjit Hullait [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-03-29 12:32:16 UTC</td>
</tr>
</table>
<hr>
<h2 id='AIC.envcpt'>
Computes the AIC/BIC measure for output from the envcpt function.
</h2><span id='topic+AIC.envcpt'></span><span id='topic+BIC.envcpt'></span>

<h3>Description</h3>

<p>Uses the likelihood and number of parameters from the output of the <code>envcpt</code> function and calculates the AIC/BIC measure for each model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'envcpt'
AIC(object,...,k=2)
## S3 method for class 'envcpt'
BIC(object,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="AIC.envcpt_+3A_object">object</code></td>
<td>

<p>A list produced as output from the <code>envcpt</code> function.  In essence any list where the first element contains a matrix whose first row is twice the negative log-likelihood and second row is the number of parameters.  Columns are different models to compare.
</p>
</td></tr>
<tr><td><code id="AIC.envcpt_+3A_...">...</code></td>
<td>
<p>Used to pass the length of the data to the BIC function as argument <code>n</code>.</p>
</td></tr>
<tr><td><code id="AIC.envcpt_+3A_k">k</code></td>
<td>
<p>numeric, the penalty per parameter to be used: the default <code>k=2</code> is the classical AIC. The value log(n) is hard coded into BIC.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calculates the AIC defined as -2*&lt;log-likelihood&gt; + 2*&lt;number of parameters&gt; or the BIC as -2*&lt;log-likelihood&gt; + log(n)*&lt;number of parameters&gt;.  When comparing models the smaller the AIC/BIC the better the fit.
</p>


<h3>Value</h3>

<p>Vector of AIC/BIC values the same length as the number of columns in the first entry to the input list (length 12 if output from envcpt is used).  The column names from the envcpt output are preserved to give clear indication on models.
</p>


<h3>Author(s)</h3>

<p>Simon Taylor and Rebecca Killick
</p>


<h3>See Also</h3>

<p><code><a href="#topic+envcpt">envcpt</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
set.seed(1)
x=c(rnorm(100,0,1),rnorm(100,5,1))
out=envcpt(x) # run all models with default values
out[[1]] # first row is twice the negative log-likelihood for each model
         # second row is the number of parameters
AIC(out) # returns AIC for each model.
which.min(AIC(out)) # gives meancpt (model 2) as the best model fit.
out$meancpt # gives the model fit for the meancpt model.
AICweights(out) # gives the AIC weights for each model
BIC(out) # returns the BIC for each model.
which.min(BIC(out)) # gives meancpt (model 2) as the best model fit too.
plot(out,type='fit') # plots the fits
plot(out,type="aic") # plots the aic values
plot(out,type="bic") # plots the bic values

set.seed(10)
x=c(0.01*(1:100),1.5-0.02*((101:250)-101))+rnorm(250,0,0.2)
out=envcpt(x,minseglen=10) # run all models with a minimum of 10 observations between changes
AIC(out) # returns the AIC for each model
which.min(AIC(out)) # gives trendcpt (model 8) as the best model fit.
out$trendcpt # gives the model fit for the trendcpt model.
AICweights(out) # gives the AIC weights for each model
BIC(out) # returns the BIC for each model.
which.min(BIC(out)) # gives trendcpt (model 8) as the best model fit too.
plot(out,type='fit') # plots the fits
plot(out,type="aic") # plots the aic values
plot(out,type="bic") # plots the bic values

set.seed(100)
x=arima.sim(model=list(ar=c(0.7,0.2)),n=500)+0.01*(1:500)
out=envcpt(x,models=c(3:6,9:12)) # runs a subset of models (those with AR components) 
AIC(out) # returns the AIC for each model
which.min(AIC(out)) # gives trendar2 (model 10) as the best model fit.
out$trendar2 # gives the model fit for the trendar2 model. Notice that the trend is tiny but does 
# produce a significantly better fit than the meanar2 model.
AICweights(out) # gives the AIC weights for each model
BIC(out) # returns the BIC for each model.
which.min(BIC(out)) # best fit is trendar2 (model 10) again.
plot(out,type='fit') # plots the fits
plot(out,type="aic") # plots the aic values
plot(out,type="bic") # plots the bic values

## End(Not run)
</code></pre>

<hr>
<h2 id='AICweights'>
Computes the AIC weights for output from the envcpt function.
</h2><span id='topic+AICweights.envcpt'></span><span id='topic+AICweights'></span>

<h3>Description</h3>

<p>Uses the likelihood and number of parameters from the output of the <code>envcpt</code> function and calculates the AICweights for each model fitted relative to the model with the minimum AIC.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'envcpt'
AICweights(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="AICweights_+3A_object">object</code></td>
<td>

<p>A list produced as output from the <code>envcpt</code> function.  In essence any list where the first element contains a matrix whose first row is twice the negative log-likelihood and second row is the number of parameters.  Columns are different models to compare.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calculates the AICweights defined as </p>
<p style="text-align: center;"><code class="reqn">w_i=\frac{\exp{-0.5 \Delta_i}}{\sum_r{\exp{-0.5\Delta_r}}}</code>
</p>
<p> where the summation over <code class="reqn">r</code> is across all models considered and <code class="reqn">\Delta_i</code> is the difference between the AIC value for model <code class="reqn">i</code> and the best model.
</p>


<h3>Value</h3>

<p>Vector of AICweights the same length as the number of columns in the first entry to the input list (length 12 if output from envcpt where all models are considered).  The column names from the envcpt output are preserved to give clear indication on models.
</p>


<h3>Author(s)</h3>

<p>Rebecca Killick
</p>


<h3>See Also</h3>

<p><code><a href="#topic+envcpt">envcpt</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
set.seed(1)
x=c(rnorm(100,0,1),rnorm(100,5,1))
out=envcpt(x) # run all models with default values
out[[1]] # first row is twice the negative log-likelihood for each model
         # second row is the number of parameters
AIC(out) # returns AIC for each model.
which.min(AIC(out)) # gives meancpt (model 2) as the best model fit.
out$meancpt # gives the model fit for the meancpt model.
AICweights(out) # gives the AIC weights for each model
BIC(out) # returns the BIC for each model.
which.min(BIC(out)) # gives meancpt (model 2) as the best model fit too.
plot(out,type='fit') # plots the fits
plot(out,type="aic") # plots the aic values
plot(out,type="bic") # plots the bic values

set.seed(10)
x=c(0.01*(1:100),1.5-0.02*((101:250)-101))+rnorm(250,0,0.2)
out=envcpt(x,minseglen=10) # run all models with a minimum of 10 observations between changes
AIC(out) # returns the AIC for each model
which.min(AIC(out)) # gives trendcpt (model 8) as the best model fit.
out$trendcpt # gives the model fit for the trendcpt model.
AICweights(out) # gives the AIC weights for each model
BIC(out) # returns the BIC for each model.
which.min(BIC(out)) # gives trendcpt (model 8) as the best model fit too.
plot(out,type='fit') # plots the fits
plot(out,type="aic") # plots the aic values
plot(out,type="bic") # plots the bic values

set.seed(100)
x=arima.sim(model=list(ar=c(0.7,0.2)),n=500)+0.01*(1:500)
out=envcpt(x,models=c(3:6,9:12)) # runs a subset of models (those with AR components) 
AIC(out) # returns the AIC for each model
which.min(AIC(out)) # gives trendar2 (model 10) as the best model fit.
out$trendar2 # gives the model fit for the trendar2 model. Notice that the trend is tiny but does 
# produce a significantly better fit than the meanar2 model.
AICweights(out) # gives the AIC weights for each model
BIC(out) # returns the BIC for each model.
which.min(BIC(out)) # best fit is trendar2 (model 10) again.
plot(out,type='fit') # plots the fits
plot(out,type="aic") # plots the aic values
plot(out,type="bic") # plots the bic values

## End(Not run)
</code></pre>

<hr>
<h2 id='envcpt'>
Assesses whether an environmental time series contains trend, autocorrelation and/or changes
</h2><span id='topic+envcpt'></span>

<h3>Description</h3>

<p>Evaluates up to 12 different models (see details) and returns the model fits as well as a summary of the likelihood for each model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>envcpt(data,models=c("mean","meancpt","meanar1","meanar2","meanar1cpt","meanar2cpt",
"trend","trendcpt","trendar1","trendar2","trendar1cpt","trendar2cpt"),minseglen=5,...,
verbose=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="envcpt_+3A_data">data</code></td>
<td>

<p>A vector or ts object containing the data to fit the models to.
</p>
</td></tr>
<tr><td><code id="envcpt_+3A_models">models</code></td>
<td>
<p>A vector containing the subset of models to fit, defaults to all available models.  This can either be named (as in the default) or numbered (1:12), see details or defaults for number-model pairings.</p>
</td></tr>
<tr><td><code id="envcpt_+3A_minseglen">minseglen</code></td>
<td>

<p>Positive integer giving the minimum segment length (no. of observations between changes) for the changepoint models, default is the minimum allowed by theory (for the largest model).
</p>
</td></tr>
<tr><td><code id="envcpt_+3A_...">...</code></td>
<td>

<p>Additional arguments to pass to the changepoint functions, if none are specified defaults with PELT multiple changepoint algorithm are used. See <code><a href="changepoint.html#topic+cpt.meanvar">cpt.meanvar</a></code> for options.
</p>
</td></tr>
<tr><td><code id="envcpt_+3A_verbose">verbose</code></td>
<td>

<p>If TRUE (default), prints to the console an progress bar indicating progression through the fit of the up to 12 models.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is used to automatically fit up to 12 different models all with Normal distribution for errors:
1. A constant mean and variance (using <code><a href="MASS.html#topic+fitdistr">fitdistr</a></code>)
2. A piecewise constant mean and variance (using <code><a href="changepoint.html#topic+cpt.meanvar">cpt.meanvar</a></code>)
3. A constant mean with AR (1) errors (using <code><a href="stats.html#topic+arima">arima</a></code>)
4. A constant mean with AR (2) errors (using <code><a href="stats.html#topic+arima">arima</a></code>)
5. A piecewise constant mean with AR(1) errors (using <code>cpt.reg</code> in this package - not exported)
6. A piecewise constant mean with AR(2) errors (using <code>cpt.reg</code> in this package - not exported)
7. A linear trend over time (using <code><a href="stats.html#topic+lm">lm</a></code>)
8. A piecewise linear trend over time (using <code>cpt.reg</code> in this package - not exported)
9. A linear trend over time with AR(1) errors (using <code><a href="stats.html#topic+lm">lm</a></code>)
10. A linear trend over time with AR(2) errors (using <code><a href="stats.html#topic+lm">lm</a></code>)
11. A piecewise linear trend over time with AR(1) errors (using <code>cpt.reg</code> in this package - not exported)
12. A piecewise linear trend over time with AR(2) errors (using <code>cpt.reg</code> in this package - not exported)
The default values for each function are used, except for the changepoint functions where multiple changes are identified and thus the PELT algorithm is used (see references or changepoint package for details).
</p>


<h3>Value</h3>

<p><code>envcpt</code> outputs a list of 13 elements.  The first element is a 2x8 matrix where the first row contains the likelihood for each model fit and the second row contains the number of parameters fit in each model.  The 12 columns are for the 12 different models in the order above (headings given).  If any element is NA then either there was an error fitting this type of model (typically the AR models and this implies nonstationarity) or the model was not specified in the <code>models</code> argument.
</p>
<p>Elements 2-13 of the list are the fits for each individual model, these are the direct output from the respective functions so see the individual functions for formats.  The first model fit is in element 2 and the twelth model fit is in element 13, but are named for convenience.
</p>


<h3>Author(s)</h3>

<p>Rebecca Killick
</p>


<h3>References</h3>

<p>EnvCpt Algorithm: Beaulieu, C, Killick, R (2018+) Distinguishing trends and shifts from memory in climate data. 
</p>
<p>PELT Algorithm: Killick R, Fearnhead P, Eckley IA (2012) Optimal detection of changepoints with a linear computational cost, <em>JASA</em> <b>107(500)</b>, 1590&ndash;1598
</p>
<p>MBIC: Zhang, N. R. and Siegmund, D. O. (2007) A Modified Bayes Information Criterion with Applications to the Analysis of Comparative Genomic Hybridization Data. <em>Biometrics</em> <b>63</b>, 22-32.
</p>


<h3>See Also</h3>

<p><code><a href="changepoint.html#topic+cpt.meanvar">cpt.meanvar</a></code>,<code><a href="changepoint.html#topic+plot-methods">plot-methods</a></code>,<code>cpt</code>, <code><a href="#topic+plot.envcpt">plot.envcpt</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
set.seed(1)
x=c(rnorm(100,0,1),rnorm(100,5,1))
out=envcpt(x) # run all models with default values
out[[1]] # first row is twice the negative log-likelihood for each model
         # second row is the number of parameters
AIC(out) # returns AIC for each model.
which.min(AIC(out)) # gives meancpt (model 2) as the best model fit.
out$meancpt # gives the model fit for the meancpt model.
AICweights(out) # gives the AIC weights for each model
BIC(out) # returns the BIC for each model.
which.min(BIC(out)) # gives meancpt (model 2) as the best model fit too.
plot(out,type='fit') # plots the fits
plot(out,type="aic") # plots the aic values
plot(out,type="bic") # plots the bic values

set.seed(10)
x=c(0.01*(1:100),1.5-0.02*((101:250)-101))+rnorm(250,0,0.2)
out=envcpt(x,minseglen=10) # run all models with a minimum of 10 observations between changes
AIC(out) # returns the AIC for each model
which.min(AIC(out)) # gives trendcpt (model 8) as the best model fit.
out$trendcpt # gives the model fit for the trendcpt model.
AICweights(out) # gives the AIC weights for each model
BIC(out) # returns the BIC for each model.
which.min(BIC(out)) # gives trendcpt (model 8) as the best model fit too.
plot(out,type='fit') # plots the fits
plot(out,type="aic") # plots the aic values
plot(out,type="bic") # plots the bic values

set.seed(100)
x=arima.sim(model=list(ar=c(0.7,0.2)),n=500)+0.01*(1:500)
out=envcpt(x,models=c(3:6,9:12)) # runs a subset of models (those with AR components) 
AIC(out) # returns the AIC for each model
which.min(AIC(out)) # gives trendar2 (model 10) as the best model fit.
out$trendar2 # gives the model fit for the trendar2 model. Notice that the trend is tiny but does 
# produce a significantly better fit than the meanar2 model.
AICweights(out) # gives the AIC weights for each model
BIC(out) # returns the BIC for each model.
which.min(BIC(out)) # best fit is trendar2 (model 10) again.
plot(out,type='fit') # plots the fits
plot(out,type="aic") # plots the aic values
plot(out,type="bic") # plots the bic values

## End(Not run)
</code></pre>

<hr>
<h2 id='EnvCpt-package'>
Detection of Structural Changes in Climate and Environment Time Series
</h2><span id='topic+EnvCpt-package'></span><span id='topic+EnvCpt'></span>

<h3>Description</h3>

<p>Tools for automatic model selection and diagnostics for Climate and Environmental data.  In particular the <code>envcpt()</code> function does automatic model selection between a variety of trend, changepoint and autocorrelation models.  The <code>envcpt()</code> function should be your first port of call.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> EnvCpt</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.1.3 </td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2021-03-29</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Rebecca Killick &lt;r.killick@lancs.ac.uk&gt;, Claudie Beaulieu &lt;c.beaulieu@soton.ac.uk&gt;, Simon Taylor &lt;s.taylor2@lancs.ac.uk&gt;, Harjit Hullait &lt;h.hullait@lancs.ac.uk&gt;.
</p>
<p>Maintainer: Rebecca Killick &lt;r.killick@lancs.ac.uk&gt;
</p>


<h3>References</h3>

<p>EnvCpt Algorithm: Beaulieu, C, Killick, R (2018+) Distinguishing trends and shifts from memory in climate data. 
</p>
<p>PELT Algorithm: Killick R, Fearnhead P, Eckley IA (2012) Optimal detection of changepoints with a linear computational cost, <em>JASA</em> <b>107(500)</b>, 1590&ndash;1598
</p>


<h3>See Also</h3>

<p><code><a href="#topic+envcpt">envcpt</a></code>,<code><a href="#topic+AIC.envcpt">AIC.envcpt</a></code>,<code><a href="#topic+plot.envcpt">plot.envcpt</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
set.seed(1)
x=c(rnorm(100,0,1),rnorm(100,5,1))
out=envcpt(x) # run all models with default values
out[[1]] # first row is twice the negative log-likelihood for each model
         # second row is the number of parameters
AIC(out) # returns AIC for each model.
which.min(AIC(out)) # gives meancpt (model 2) as the best model fit.
out$meancpt # gives the model fit for the meancpt model.
AICweights(out) # gives the AIC weights for each model
BIC(out) # returns the BIC for each model.
which.min(BIC(out)) # gives meancpt (model 2) as the best model fit too.
plot(out,type='fit') # plots the fits
plot(out,type="aic") # plots the aic values
plot(out,type="bic") # plots the bic values

set.seed(10)
x=c(0.01*(1:100),1.5-0.02*((101:250)-101))+rnorm(250,0,0.2)
out=envcpt(x,minseglen=10) # run all models with a minimum of 10 observations between changes
AIC(out) # returns the AIC for each model
which.min(AIC(out)) # gives trendcpt (model 8) as the best model fit.
out$trendcpt # gives the model fit for the trendcpt model.
AICweights(out) # gives the AIC weights for each model
BIC(out) # returns the BIC for each model.
which.min(BIC(out)) # gives trendcpt (model 8) as the best model fit too.
plot(out,type='fit') # plots the fits
plot(out,type="aic") # plots the aic values
plot(out,type="bic") # plots the bic values

set.seed(100)
x=arima.sim(model=list(ar=c(0.7,0.2)),n=500)+0.01*(1:500)
out=envcpt(x,models=c(3:6,9:12)) # runs a subset of models (those with AR components) 
AIC(out) # returns the AIC for each model
which.min(AIC(out)) # gives trendar2 (model 10) as the best model fit.
out$trendar2 # gives the model fit for the trendar2 model. Notice that the trend is tiny but does 
# produce a significantly better fit than the meanar2 model.
AICweights(out) # gives the AIC weights for each model
BIC(out) # returns the BIC for each model.
which.min(BIC(out)) # best fit is trendar2 (model 10) again.
plot(out,type='fit') # plots the fits
plot(out,type="aic") # plots the aic values
plot(out,type="bic") # plots the bic values

## End(Not run)
</code></pre>

<hr>
<h2 id='plot.envcpt'>
Plots optionally either (&quot;fit&quot;) the data and fits from each of the 8 models or (&quot;aic&quot;) the aic for each of the 8 models.
</h2><span id='topic+plot.envcpt'></span>

<h3>Description</h3>

<p>Uses the output of the <code>envcpt</code> function and plots optionally (&quot;fit&quot;) the original data and the fit from each of the 8 models or (&quot;aic&quot;) the aic for each of the 8 models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'envcpt'
plot(x,type=c('fit','bic','aic'),lwd=3,colors=rainbow(12),...,data=NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.envcpt_+3A_x">x</code></td>
<td>

<p>A list produced as output from the <code>envcpt</code> function.  In essence a list with the named elements: &quot;mean&quot;,&quot;meancpt&quot;,&quot;meanar1&quot;,&quot;meanar2&quot;,&quot;meanar1cpt&quot;,&quot;meanar2cpt&quot;,&quot;trend&quot;,&quot;trendcpt&quot;,&quot;trendar1&quot;,&quot;trendar2&quot;,&quot;trendar1cpt&quot;,&quot;trendar2cpt&quot; where each element is the output from the appropriate function call.
</p>
</td></tr>
<tr><td><code id="plot.envcpt_+3A_type">type</code></td>
<td>
<p>character vector. <code>fit</code> returns a plot of the data and fitted models. <code>aic</code> returns a bar chart of the aic values for each of the 8 models</p>
</td></tr>
<tr><td><code id="plot.envcpt_+3A_lwd">lwd</code></td>
<td>
<p>Line width graphical parameter, see <code><a href="graphics.html#topic+par">par</a></code> for further details.</p>
</td></tr>
<tr><td><code id="plot.envcpt_+3A_colors">colors</code></td>
<td>
<p>colors for the individual models to be passed to the plotting functions.  Note that this must be of length 12 regardless of how many models were evaluated.  Color validity is checked using col2rgb.</p>
</td></tr>
<tr><td><code id="plot.envcpt_+3A_...">...</code></td>
<td>
<p>Extra graphical parameters, passed to the original plot and the individual calls to <code>lines</code> or <code>barchar</code>.</p>
</td></tr>
<tr><td><code id="plot.envcpt_+3A_data">data</code></td>
<td>
<p>This argument is only required when <code>x</code> doesn't contain any fits that provide the data which is required for the &quot;fit&quot; <code>type</code> option.  Default is NA as most of the time this is likely not required.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>type="fit"</code>, the function plots the data at the bottom and stacks the different fits for the 8 models from the <code><a href="#topic+envcpt">envcpt</a></code> function on top.  No scale is given as all data and fits are scaled to be in (0,1).  This is designed as an initial visualization tool for the fits only.
If <code>type="aic"</code> the function uses the <code><a href="#topic+AIC.envcpt">AIC.envcpt</a></code> function to calculate the AIC values for the <code>envcpt</code> output <code>x</code>.  Then barcharts the AIC values in the same order as the <code>type="fit"</code> option.  The minimum AIC is the preferred model and this is highlight by a solid block.  This is designed as an initial visualization tool for the AIC values only.
If <code>type="bic"</code> the function uses the <code><a href="#topic+BIC.envcpt">BIC.envcpt</a></code> function to calculate the BIC values for the <code>envcpt</code> output <code>x</code>.  Then barcharts the BIC values in the same order as the <code>type="fit"</code> option.  The minimum BIC is the preferred model and this is highlight by a solid block.  This is designed as an initial visualization tool for the BIC values only.
</p>
<p>For ease of use, if &quot;colours&quot; is specified instead of (or in addition to) colors then this will take precedence.
</p>


<h3>Value</h3>

<p>Returns the printed graphic to the active device.
</p>


<h3>Author(s)</h3>

<p>Rebecca Killick &amp; Claudie Beaulieu.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+envcpt">envcpt</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
set.seed(1)
x=c(rnorm(100,0,1),rnorm(100,5,1))
out=envcpt(x) # run all models with default values
out[[1]] # first row is twice the negative log-likelihood for each model
         # second row is the number of parameters
AIC(out) # returns AIC for each model.
which.min(AIC(out)) # gives meancpt (model 2) as the best model fit.
out$meancpt # gives the model fit for the meancpt model.
AICweights(out) # gives the AIC weights for each model
BIC(out) # returns the BIC for each model.
which.min(BIC(out)) # gives meancpt (model 2) as the best model fit too.
plot(out,type='fit') # plots the fits
plot(out,type="aic") # plots the aic values
plot(out,type="bic") # plots the bic values

set.seed(10)
x=c(0.01*(1:100),1.5-0.02*((101:250)-101))+rnorm(250,0,0.2)
out=envcpt(x,minseglen=10) # run all models with a minimum of 10 observations between changes
AIC(out) # returns the AIC for each model
which.min(AIC(out)) # gives trendcpt (model 8) as the best model fit.
out$trendcpt # gives the model fit for the trendcpt model.
AICweights(out) # gives the AIC weights for each model
BIC(out) # returns the BIC for each model.
which.min(BIC(out)) # gives trendcpt (model 8) as the best model fit too.
plot(out,type='fit') # plots the fits
plot(out,type="aic") # plots the aic values
plot(out,type="bic") # plots the bic values

set.seed(100)
x=arima.sim(model=list(ar=c(0.7,0.2)),n=500)+0.01*(1:500)
out=envcpt(x,models=c(3:6,9:12)) # runs a subset of models (those with AR components) 
AIC(out) # returns the AIC for each model
which.min(AIC(out)) # gives trendar2 (model 10) as the best model fit.
out$trendar2 # gives the model fit for the trendar2 model. Notice that the trend is tiny but does 
# produce a significantly better fit than the meanar2 model.
AICweights(out) # gives the AIC weights for each model
BIC(out) # returns the BIC for each model.
which.min(BIC(out)) # best fit is trendar2 (model 10) again.
plot(out,type='fit') # plots the fits
plot(out,type="aic") # plots the aic values
plot(out,type="bic") # plots the bic values

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
