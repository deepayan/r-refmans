<!DOCTYPE html><html><head><title>Help for package hydropeak</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {hydropeak}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#all_metrics'><p>Event Based Fluctuation Flow Parameters</p></a></li>
<li><a href='#amp'><p>AMP - Amplitude (Metric 1)</p></a></li>
<li><a href='#change_points'><p>Change Points</p></a></li>
<li><a href='#dur'><p>DUR - Duration (Metric 4)</p></a></li>
<li><a href='#event_type'><p>Event Type</p></a></li>
<li><a href='#Events'><p>Events</p></a></li>
<li><a href='#flow'><p>'flow' S3 Class for Flow Rate Time Series</p></a></li>
<li><a href='#get_events'><p>Flow Fluctuation Events and Metrics</p></a></li>
<li><a href='#get_events_dir'><p>Flow Fluctuation Events and Metrics from Input Directory</p></a></li>
<li><a href='#get_events_file'><p>Flow Fluctuation Events and Metrics from Input File</p></a></li>
<li><a href='#mafr'><p>MAFR - Maximum Flow Fluctuation Rate (Metric 2)</p></a></li>
<li><a href='#mefr'><p>MEFR - Mean Flow Fluctuation Rate (Metric 3)</p></a></li>
<li><a href='#Q'><p>Flow Fluctuations Q</p></a></li>
<li><a href='#ratio'><p>RATIO - Flow Ratio (Metric 5)</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Detect and Characterize Sub-Daily Flow Fluctuations</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.2</td>
</tr>
<tr>
<td>Description:</td>
<td>An important environmental impact on running water ecosystems 
    is caused by hydropeaking - the discontinuous release of turbine water 
    because of peaks of energy demand. An event-based algorithm is implemented 
    to detect flow fluctuations referring to increase events (IC) and decrease 
    events (DC). For each event, a set of parameters related to the fluctuation 
    intensity is calculated. The framework is introduced in Greimel et al. (2016) 
    "A method to detect and characterize sub-daily flow fluctuations" 
    &lt;<a href="https://doi.org/10.1002%2Fhyp.10773">doi:10.1002/hyp.10773</a>&gt; and can be used to identify different fluctuation 
    types according to the potential source: e.g., sub-daily flow fluctuations 
    caused by hydropeaking, rainfall, or snow and glacier melt.
    This is a companion to the package 'hydroroute', which is used to detect and 
    follow hydropower plant-specific hydropeaking waves at the sub-catchment 
    scale and to describe how hydropeaking flow parameters change along the
    longitudinal flow path as proposed and validated in Greimel et al. (2022).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.1.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>rmarkdown, knitr, testthat (&ge; 3.0.0), data.table</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Imports:</td>
<td>utils, parallel</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-11-13 20:27:01 UTC; gruen</td>
</tr>
<tr>
<td>Author:</td>
<td>Bettina Grün <a href="https://orcid.org/0000-0001-7265-4773"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [cre, ctb],
  Julia Haider [aut],
  Franz Greimel <a href="https://orcid.org/0000-0002-8000-1227"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Bettina Grün &lt;Bettina.Gruen@R-project.org&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-11-16 03:50:15 UTC</td>
</tr>
</table>
<hr>
<h2 id='all_metrics'>Event Based Fluctuation Flow Parameters</h2><span id='topic+all_metrics'></span>

<h3>Description</h3>

<p>Given an event with equal flow trend, all metrics implemented in
the package <span class="pkg">hydropeak</span> are computed and combined to a data frame.
It includes also an identifier of the gauging station provided by the user
and the starting time of the event.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>all_metrics(x, id, event_type)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="all_metrics_+3A_x">x</code></td>
<td>
<p>Data frame (time series) from an event with equal flow trend. The
data frame must contain a date-time column (<code>Time</code>) and a flow rate
column (<code>Q</code>) and must be in a compatible format
(see <code><a href="#topic+flow">flow()</a></code>).</p>
</td></tr>
<tr><td><code id="all_metrics_+3A_id">id</code></td>
<td>
<p>Character string which refers to the identifier of the gauging
station (in Austria: HZBCODE).</p>
</td></tr>
<tr><td><code id="all_metrics_+3A_event_type">event_type</code></td>
<td>
<p>Numeric value which indicates the event type. By using
<code><a href="#topic+get_events">get_events()</a></code>, this is internally computed.
If metrics for a single event
have to be computed individually, the event type has to be provided as an
argument or can be computed with <code><a href="#topic+event_type">event_type()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame including all computed metrics, IDs of gauging stations,
event type (see <code><a href="#topic+event_type">event_type()</a></code> for an overview of
possible event types), and starting time of an event <code>x</code>.
Included metrics are <code><a href="#topic+amp">amp()</a></code>, <code><a href="#topic+mafr">mafr()</a></code>,
<code><a href="#topic+mefr">mefr()</a></code>, <code><a href="#topic+dur">dur()</a></code>, <code><a href="#topic+ratio">ratio()</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Q)
# decreasing event:
Q4 &lt;- flow(Q[3:4, ])
all_metrics(Q4, id = Q$ID[1], event_type = 4)
all_metrics(Q4, id = Q$ID[1], event_type = event_type(Q4))

# increasing event:
Q2 &lt;- flow(Q[486:487, ])
all_metrics(Q2, id = Q$ID[1], event_type = 2)
all_metrics(Q2, id = Q$ID[1], event_type = event_type(Q2))

# constant event (at beginning or after NA event):
Q0 &lt;- flow(Q[1:3, ])
all_metrics(Q0, id = Q$ID[1], event_type = 0)
all_metrics(Q0, id = Q$ID[1], event_type = event_type(Q0))
</code></pre>

<hr>
<h2 id='amp'>AMP - Amplitude (Metric 1)</h2><span id='topic+amp'></span>

<h3>Description</h3>

<p>The amplitude (AMP, unit: <code class="reqn">m^3/s</code>) of an event is defined as
the difference between the flow maximum (<code class="reqn">Q_{max}</code>) and the
flow minimum (<code class="reqn">Q_{min}</code>).
Given an event with equal flow trend, the amplitude is computed and returned.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>amp(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="amp_+3A_x">x</code></td>
<td>
<p>Data frame (time series) from an event with equal flow trend. The
data frame must contain a date-time column (<code>Time</code>) and a flow rate
column (<code>Q</code>) and must be in a compatible format
(see <code><a href="#topic+flow">flow()</a></code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a positive numeric value which is the difference of
<code>max(x$Q)</code> and <code>min(x$Q)</code> of an event. If a data frame containing
<code>NA</code> flow rates (<code>Q</code>) is given, <code>NA</code> is returned.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Q)
Q &lt;- flow(Q[3:4, ])
amp(Q)
</code></pre>

<hr>
<h2 id='change_points'>Change Points</h2><span id='topic+change_points'></span>

<h3>Description</h3>

<p>Calculates flow (Q) differences of consecutive time steps and
discriminates between time steps with increasing (IC: <code class="reqn">Q_{ts1} &lt; Q_{ts2}</code>)
and decreasing (DC: <code class="reqn">Q_{ts1} &gt; Q_{ts2}</code>) flow. The differences are
transformed to 1 or -1 if the number is positive or negative, respectively.
Then the lengths of runs of equal values are computed to determine the
change point indices in the input data frame. <code>NA</code> in Q values is
replaced with 0 and treated as an equal trend.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>change_points(x, rownames = FALSE, omit.constant = TRUE, omit.na = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="change_points_+3A_x">x</code></td>
<td>
<p>Data frame (time series) of stage measurements. Data frame must contain
a date-time column (<code>Time</code>) and a flow rate column (<code>Q</code>) and must
be in a compatible format. (see <code><a href="#topic+flow">flow()</a></code>).</p>
</td></tr>
<tr><td><code id="change_points_+3A_rownames">rownames</code></td>
<td>
<p>A logical. If <code>FALSE</code> (default) indices are used to
determine change points, otherwise row names. <code>rownames = TRUE</code> is
important for data with different IDs.</p>
</td></tr>
<tr><td><code id="change_points_+3A_omit.constant">omit.constant</code></td>
<td>
<p>A logical. If <code>FALSE</code> (default) it does not return
events with constant measurements. Otherwise these events are included.</p>
</td></tr>
<tr><td><code id="change_points_+3A_omit.na">omit.na</code></td>
<td>
<p>A logical. If <code>FALSE</code> (default) it does not return missing
value events. Otherwise these events are included.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame which contains change point indices in the input data frame.
These are the indices where an event starts and ends, and a column which
indicates the event (-1 = decreasing (DC), 1 = increasing (IC)).
</p>

<hr>
<h2 id='dur'>DUR - Duration (Metric 4)</h2><span id='topic+dur'></span>

<h3>Description</h3>

<p>The duration of an event is specified as the number of consecutive
time steps with equal flow trend.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dur(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dur_+3A_x">x</code></td>
<td>
<p>Data frame (time series) from an event with equal flow trend. The
data frame must contain a date-time column (<code>Time</code>) and a flow rate
column (<code>Q</code>) and must be in a compatible format.
(see <code><a href="#topic+flow">flow()</a></code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns an integer value which is the number of consecutive time steps.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Q)
Q &lt;- flow(Q[3:4, ])
dur(Q)
</code></pre>

<hr>
<h2 id='event_type'>Event Type</h2><span id='topic+event_type'></span>

<h3>Description</h3>

<p>Given a data frame (time series) of equal flow (Q) trend, it is
determined whether the flow is increasing or decreasing, constant or if
missing values occur. It returns a numeric value which indicates the event
type. As the event type is already determined when the change points are
computed, this function is mainly used for demonstration purpose or if
metrics should be computed individually.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>event_type(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="event_type_+3A_x">x</code></td>
<td>
<p>Data frame (time series) from an event with equal flow trend. Data
frame must contain a date-time column (<code>Time</code>) and a flow rate column
(<code>Q</code>) and must be in a compatible format. (see <code><a href="#topic+flow">flow()</a></code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns an numeric value which indicates the event type.
Event types are defined as follows:
</p>

<ul>
<li><p> 0: Constant event after NA event or constant event as first event in time series
</p>
</li>
<li><p> 1: Constant event after DC
</p>
</li>
<li><p> 2: Increasing event (IC)
</p>
</li>
<li><p> 3: Constant event after IC
</p>
</li>
<li><p> 4: Decreasing event (DC)
</p>
</li>
<li><p> 5: NA event
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>data(Q)
# decreasing event
Q4 &lt;- flow(Q[3:4, ])
event_type(Q4)

# increasing event
Q2 &lt;- flow(Q[486:487, ])
event_type(Q2)

</code></pre>

<hr>
<h2 id='Events'>Events</h2><span id='topic+Events'></span>

<h3>Description</h3>

<p>A complementary dataset to the flow fluctuation dataset <a href="#topic+Q">Q</a>. It contains
the events and metrics such as computed by <code><a href="#topic+get_events">get_events()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Events
</code></pre>


<h3>Format</h3>

<p>A data frame with 165 rows and 8 variables:
</p>

<dl>
<dt>ID</dt><dd><p>Character string which refers to the identifier of the gauging station
(in Austria: HZBCODE)</p>
</dd>
<dt>EVENT_TYPE</dt><dd><p>Event types are defined as follows:
</p>

<ul>
<li><p> 0: Constant event after NA event or constant event as first event
in time series
</p>
</li>
<li><p> 1: Constant event after DC
</p>
</li>
<li><p> 2: Increasing event (IC)
</p>
</li>
<li><p> 3: Constant event after IC
</p>
</li>
<li><p> 4: Decreasing event (DC)
</p>
</li>
<li><p> 5: NA event</p>
</li></ul>
</dd>
<dt>Time</dt><dd><p>Date-time of event starting point</p>
</dd>
<dt>AMP</dt><dd><p>Amplitude (<code><a href="#topic+amp">amp()</a></code>)</p>
</dd>
<dt>MAFR</dt><dd><p>Maximum flow fluctuation rate (<code><a href="#topic+mafr">mafr()</a></code>)</p>
</dd>
<dt>MEFR</dt><dd><p>Mean flow fluctuation rate (<code><a href="#topic+mefr">mefr()</a></code>)</p>
</dd>
<dt>DUR</dt><dd><p>Duration (<code><a href="#topic+dur">dur()</a></code>)</p>
</dd>
<dt>RATIO</dt><dd><p>Flow ratio (<code><a href="#topic+ratio">ratio()</a></code>)</p>
</dd>
</dl>


<hr>
<h2 id='flow'>'flow' S3 Class for Flow Rate Time Series</h2><span id='topic+flow'></span><span id='topic+validate_flow'></span>

<h3>Description</h3>

<p>The function <code>flow()</code> creates a flow rate time series object
which is formatted to be compatible with the functions in the <span class="pkg">hydropeak</span>
package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>flow(
  x,
  format = "%d.%m.%Y %H:%M",
  tz = "Etc/GMT-1",
  cols = c(1, 2, 3),
  steplength = 15,
  full = TRUE
)

validate_flow(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="flow_+3A_x">x</code></td>
<td>
<p>Data frame which contains at least a column with an ID of the gauging
station, a column with date-time values in character representation and a
column with flow rates</p>
</td></tr>
<tr><td><code id="flow_+3A_format">format</code></td>
<td>
<p>Character string giving the date-time format of the date-time
column in the input data frame  (default: <code>dd.mm.YYYY HH:MM</code>)</p>
</td></tr>
<tr><td><code id="flow_+3A_tz">tz</code></td>
<td>
<p>Character string specifying the time zone to be used for the conversion
(default: <code>Etc/GMT-1</code>).</p>
</td></tr>
<tr><td><code id="flow_+3A_cols">cols</code></td>
<td>
<p>Integer vector specifying column indices in the input data frame
which contain gauging station ID, date-time and flow rate to be renamed.
The default indices are 1 (ID), 2 (date-time) and 3 (flow rate, Q).</p>
</td></tr>
<tr><td><code id="flow_+3A_steplength">steplength</code></td>
<td>
<p>Numeric value which specifies the distance between (equispaced)
time steps in minutes. (default: <code>15</code>, which refers to 15 minutes).
Non-equispaced time steps are not supported and missing time steps are
imputed if argument <code>full</code> is set to <code>TRUE</code> (default), Q values
are assumed to be <code>NA</code>.</p>
</td></tr>
<tr><td><code id="flow_+3A_full">full</code></td>
<td>
<p>A logical. If <code>TRUE</code> (default) imputes missing time step values
so the time series is complete. Imputed Q values are set to NA. It should
only be set to <code>FALSE</code>, if it is known, that the time series is complete.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a <code>flow</code> object which inherits from data frame (time series).
It contains at least a gauging station ID column (<code>ID</code>) converted to
character values, a date-time column (<code>Time</code>) converted to class &quot;POSIXlt&quot;
(see <code><a href="base.html#topic+strptime">base::strptime()</a></code>) and a flow rate column
(<code>Q</code>), which is converted to numeric values. The <code>flow()</code> object
ensures that input flow fluctuation time series data can be processed with
the functions in the <span class="pkg">hydropeak</span> package. Therefore, it is mandatory
to provide the correct indices (see argument <code>cols</code>) and the correct
date-time format (see argument <code>format</code>) of the input data frame.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Q)
Q &lt;- flow(Q)
</code></pre>

<hr>
<h2 id='get_events'>Flow Fluctuation Events and Metrics</h2><span id='topic+get_events'></span>

<h3>Description</h3>

<p>Given a data frame (time series) of stage measurements, all
increase (IC) and decrease (DC) events are determined and all metrics
implemented in the package <span class="pkg">hydropeak</span>
(see <code><a href="#topic+all_metrics">all_metrics()</a></code>) are computed and combined
to a data frame. Optionally, NA events and constant events can be included.
NA events occur due to missing stage measurement values. The beginning
of NA events refers to the last measurement with a non-missing Q value.
Constant events are events where the Q values stay constant over time.
An event is uniquely identifiable through the combination of the event starting
time (<code>Time</code>) and the gauging station identifier (<code>ID</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_events(x, mc.cores = 2L, omit.constant = TRUE, omit.na = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_events_+3A_x">x</code></td>
<td>
<p>Data frame (time series) of stage measurements which contains at
least a column with ID of the gauging station (default: column index 1)
column with date-time values (default: columns index 2) in character
representation and a column with flow rates (default: column index 3).
If the column indices differ from <code>c(1, 2, 3)</code>, they have to be
specified as <code>...</code> argument in the format <code>c(i, j, k)</code>.</p>
</td></tr>
<tr><td><code id="get_events_+3A_mc.cores">mc.cores</code></td>
<td>
<p>Number of cores to use with
<code><a href="parallel.html#topic+mclapply">parallel::mclapply()</a></code>. On Windows, this
will be set to 1.</p>
</td></tr>
<tr><td><code id="get_events_+3A_omit.constant">omit.constant</code></td>
<td>
<p>A logical. If <code>FALSE</code> (default) it does not return
events with constant measurements. Otherwise these events are included.</p>
</td></tr>
<tr><td><code id="get_events_+3A_omit.na">omit.na</code></td>
<td>
<p>A logical. If <code>FALSE</code> (default) it does not return missing
value events. Otherwise these events are included.</p>
</td></tr>
<tr><td><code id="get_events_+3A_...">...</code></td>
<td>
<p>Arguments to be passed to <code><a href="#topic+flow">flow()</a></code> to specify
the date-time format in the input data (default: <code>dd.mm.YYYY HH:MM</code>),
the time zone used for the conversion (default: <code>Etc/GMT-1</code>) and the
column indices in the input data, which contain date-time values and flow
rate values. The default indices are 1 (ID), 2 (date-time) and 3 (flow rate,
Q), i.e. <code>cols = c(1, 2, 3)</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame which contains for every event in a given time series all
metrics (<code><a href="#topic+all_metrics">all_metrics()</a></code>), gauging station ID,
event type, and starting time of an event.
Included metrics are <code><a href="#topic+amp">amp()</a></code>, <code><a href="#topic+mafr">mafr()</a></code>,
<code><a href="#topic+mefr">mefr()</a></code>, <code><a href="#topic+dur">dur()</a></code>,
<code><a href="#topic+ratio">ratio()</a></code>. These metrics are only computed for
increasing (IC) and decreasing (DC) events. For all other events the
values are set to 0 except for flow ratio that is set to 1.
Event types are defined as follows:
</p>

<ul>
<li><p> 0: Constant event after NA event or constant event as first event in time series
</p>
</li>
<li><p> 1: Constant event after DC
</p>
</li>
<li><p> 2: Increasing event (IC)
</p>
</li>
<li><p> 3: Constant event after IC
</p>
</li>
<li><p> 4: Decreasing event (DC)
</p>
</li>
<li><p> 5: NA event
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'># Data with multiple events and different stations
data(Q)
get_events(Q)

# including constant events
get_events(Q, omit.constant = FALSE)
</code></pre>

<hr>
<h2 id='get_events_dir'>Flow Fluctuation Events and Metrics from Input Directory</h2><span id='topic+get_events_dir'></span>

<h3>Description</h3>

<p>Given a directory path it calls
<code><a href="#topic+get_events">get_events_file()</a></code> for each file in the directory,
recursively. The resulting events are split into separate files for each
gauging station ID (<code>ID</code>) and <code>Event_Type</code> and are written to
the given output directory.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_events_dir(
  Q_dir,
  inputsep = ";",
  inputdec = ".",
  outdir = file.path(tempdir(), "Events"),
  mc.cores = 2L,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_events_dir_+3A_q_dir">Q_dir</code></td>
<td>
<p>A character string containing the path name where the input data
are located.</p>
</td></tr>
<tr><td><code id="get_events_dir_+3A_inputsep">inputsep</code></td>
<td>
<p>Field separator character string for input data.</p>
</td></tr>
<tr><td><code id="get_events_dir_+3A_inputdec">inputdec</code></td>
<td>
<p>Character string for decimal points in input data.</p>
</td></tr>
<tr><td><code id="get_events_dir_+3A_outdir">outdir</code></td>
<td>
<p>A character string naming a directory where the output file(s)
should be written to.</p>
</td></tr>
<tr><td><code id="get_events_dir_+3A_mc.cores">mc.cores</code></td>
<td>
<p>Number of cores to use with
<code><a href="parallel.html#topic+mclapply">parallel::mclapply()</a></code>. On Windows, this
will be set to 1.</p>
</td></tr>
<tr><td><code id="get_events_dir_+3A_...">...</code></td>
<td>
<p>Arguments to be passed to <code><a href="#topic+get_events_file">get_events_file()</a></code>
and further to  <code><a href="#topic+get_events">get_events()</a></code>  and <code><a href="#topic+flow">flow()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for side effects.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Q_dir &lt;- "./inst/extdata"
get_events_dir(Q_dir, inputsep = ",", inputdec = ".")
</code></pre>

<hr>
<h2 id='get_events_file'>Flow Fluctuation Events and Metrics from Input File</h2><span id='topic+get_events_file'></span>

<h3>Description</h3>

<p>Given a file path it reads a data frame (time series) of stage
measurements and calls <code><a href="#topic+get_events">get_events()</a></code>.
The resulting events can be optionally written to a single file or to
separate files for each gauging station ID (<code>ID</code>) and <code>Event_Type</code>.
Files which produce errors return <code>NULL</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_events_file(
  Q_file,
  inputsep = ";",
  inputdec = ".",
  save = FALSE,
  split = TRUE,
  outdir = file.path(tempdir(), "Events"),
  mc.cores = 2L,
  return = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_events_file_+3A_q_file">Q_file</code></td>
<td>
<p>A character string containing the name of the file which the data
are to be read from with <code><a href="utils.html#topic+read.csv">utils::read.csv()</a></code>.</p>
</td></tr>
<tr><td><code id="get_events_file_+3A_inputsep">inputsep</code></td>
<td>
<p>Field separator character string for input data.</p>
</td></tr>
<tr><td><code id="get_events_file_+3A_inputdec">inputdec</code></td>
<td>
<p>Character string for decimal points in input data.</p>
</td></tr>
<tr><td><code id="get_events_file_+3A_save">save</code></td>
<td>
<p>A logical. If <code>FALSE</code> (default) events (results from
<code><a href="#topic+get_events">get_events()</a></code>) are not written to file(s),
otherwise events are written to <code>outdir</code>.</p>
</td></tr>
<tr><td><code id="get_events_file_+3A_split">split</code></td>
<td>
<p>A logical. If <code>TRUE</code> (default) output files are separated by
their gauging station ID (<code>ID</code>) and by <code>Event_Type</code>, otherwise
all events are written to a single file.</p>
</td></tr>
<tr><td><code id="get_events_file_+3A_outdir">outdir</code></td>
<td>
<p>A character string naming a directory where the output file(s)
should be written to.</p>
</td></tr>
<tr><td><code id="get_events_file_+3A_mc.cores">mc.cores</code></td>
<td>
<p>Number of cores to use with
<code><a href="parallel.html#topic+mclapply">parallel::mclapply()</a></code>. On Windows, this
will be set to 1.</p>
</td></tr>
<tr><td><code id="get_events_file_+3A_return">return</code></td>
<td>
<p>A logical. If <code>TRUE</code> (default) it returns the resulting
data frame or list of data frames. Otherwise it returns <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="get_events_file_+3A_...">...</code></td>
<td>
<p>Arguments to be passed to <code><a href="#topic+get_events">get_events()</a></code>
and further to <code><a href="#topic+flow">flow()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame which contains for every increase or decrease event in a
given time series all metrics (<code><a href="#topic+all_metrics">all_metrics()</a></code>),
gauging station ID, event type, and starting time of an event.
Included metrics are <code><a href="#topic+amp">amp()</a></code>, <code><a href="#topic+mafr">mafr()</a></code>,
<code><a href="#topic+mefr">mefr()</a></code>, <code><a href="#topic+dur">dur()</a></code>, <code><a href="#topic+ratio">ratio()</a></code>.
The returned data frame is not split. Returns <code>NULL</code>, if argument
<code>return</code> is set to <code>FALSE</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Q_file &lt;- system.file("extdata", "Q.csv", package = "hydropeak")
# save to tempdir()
events &lt;- get_events_file(Q_file, inputsep = ",", inputdec = ".",
save = TRUE, split = TRUE, return = TRUE)
</code></pre>

<hr>
<h2 id='mafr'>MAFR - Maximum Flow Fluctuation Rate (Metric 2)</h2><span id='topic+mafr'></span>

<h3>Description</h3>

<p>The maximum flow fluctuation rate (MAFR, unit: <code class="reqn">m^3/s</code>)
represents the highest absolute flow change of two consecutive time steps
within an event. Given an event with equal flow trend, the maximum flow
fluctuation rate is computed and returned.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mafr(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mafr_+3A_x">x</code></td>
<td>
<p>Data frame (time series) from an event with equal flow trend. The
data frame must contain a date-time column (<code>Time</code>) and a flow rate
column (<code>Q</code>) and must be in a compatible format
(see <code><a href="#topic+flow">flow()</a></code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a numeric value which is the maximum (absolute) flow
fluctuation rate. If a data frame containing <code>NA</code> flow rates (<code>Q</code>)
is given, <code>NA</code> is returned.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Q)
Q &lt;- flow(Q[3:4, ])
mafr(Q)
</code></pre>

<hr>
<h2 id='mefr'>MEFR - Mean Flow Fluctuation Rate (Metric 3)</h2><span id='topic+mefr'></span>

<h3>Description</h3>

<p>The mean flow fluctuation rate (MEFR, unit: <code class="reqn">m^3/s^2</code>) is
calculated by the event amplitude divided by the number of time steps
(duration) within an event. Given an event with equal flow trend, amplitude
and duration are computed. From these metrics the mean flow fluctuation
rate is calculated and returned.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mefr(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mefr_+3A_x">x</code></td>
<td>
<p>Data frame (time series) from an event with equal flow trend. The
data frame must contain a date-time column (<code>Time</code>) and a flow rate
column (<code>Q</code>) and must be in a compatible format.
(see <code><a href="#topic+flow">flow()</a></code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a numeric value which is the mean flow fluctuation rate computed
by the event amplitude <code><a href="#topic+amp">amp()</a></code> divided by the number of
time steps <code><a href="#topic+dur">dur()</a></code>. If a data frame containing <code>NA</code>
flow rates (<code>Q</code>) is given, <code>NA</code> is returned.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Q)
Q &lt;- flow(Q[3:4, ])
mefr(Q)
</code></pre>

<hr>
<h2 id='Q'>Flow Fluctuations Q</h2><span id='topic+Q'></span>

<h3>Description</h3>

<p>A dataset containing sub-daily flow fluctuations of five consecutive days from
two different gauging stations. One time step is 15 minutes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Q
</code></pre>


<h3>Format</h3>

<p>A data frame with 960 rows and 3 variables:
</p>

<dl>
<dt>ID</dt><dd><p>Character string which refers to the identifier of the gauging station
(in Austria: HZBCODE)</p>
</dd>
<dt>Time</dt><dd><p>Character string with date-time information of stage measurements
which needs to be converted to a compatible format (see <code><a href="#topic+flow">flow()</a></code>)</p>
</dd>
<dt>Q</dt><dd><p>Flow, stage measurements in <code class="reqn">m^3/s</code></p>
</dd>
</dl>


<hr>
<h2 id='ratio'>RATIO - Flow Ratio (Metric 5)</h2><span id='topic+ratio'></span>

<h3>Description</h3>

<p>The metric flow ratio (RATIO) is defined as the flow maximum
divided by the flow minimum, <code class="reqn">\frac{Q_{max}}{Q_{min}}</code>.
Given an event with equal flow trend, the flow ratio is computed and returned.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ratio(x, event_type)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ratio_+3A_x">x</code></td>
<td>
<p>Data frame (time series) from an event with equal flow trend. The
data frame must contain a date-time column (<code>Time</code>) and a flow rate
column (<code>Q</code>) and must be in a compatible format.
(see <code><a href="#topic+flow">flow()</a></code>).</p>
</td></tr>
<tr><td><code id="ratio_+3A_event_type">event_type</code></td>
<td>
<p>Numeric value which specifies the event type. See
<code><a href="#topic+get_events">get_events()</a></code> for an overview of the event types.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a numeric value which is the flow ratio computed by
<code>max(x$Q)</code> divided by <code>min(x$Q)</code>. If a data frame containing
<code>NA</code> flow rates (<code>Q</code>) is given, <code>NA</code> is returned.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Q)
Q &lt;- flow(Q[3:4, ])
ratio(Q, event_type(Q))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
