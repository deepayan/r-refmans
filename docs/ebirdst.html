<!DOCTYPE html><html><head><title>Help for package ebirdst</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ebirdst}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ebirdst-package'><p><code>ebirdst</code>: Tools to Load, Map, Plot, and Analyze eBird Status and Trends</p>
Data Products</a></li>
<li><a href='#%&gt;%'><p>Pipe operator</p></a></li>
<li><a href='#abundance_palette-deprecated'><p>eBird Status and Trends color palettes for mapping</p></a></li>
<li><a href='#assign_to_grid'><p>Assign points to a spacetime grid</p></a></li>
<li><a href='#calculate_mcc_f1'><p>Calculate MCC and F1 score</p></a></li>
<li><a href='#date_to_st_week'><p>Get the Status and Trends week that a date falls into</p></a></li>
<li><a href='#ebirdst_data_dir'><p>Path to eBird Status and Trends data download directory</p></a></li>
<li><a href='#ebirdst_download_status'><p>Download eBird Status Data Products</p></a></li>
<li><a href='#ebirdst_download_trends'><p>Download eBird Trends Data Products</p></a></li>
<li><a href='#ebirdst_palettes'><p>eBird Status and Trends color palettes for mapping</p></a></li>
<li><a href='#ebirdst_predictor_descriptions'><p>eBird Status and Trends predictors descriptions</p></a></li>
<li><a href='#ebirdst_predictors'><p>eBird Status and Trends predictor variables</p></a></li>
<li><a href='#ebirdst_runs'><p>Data frame of species with eBird Status and Trends Data Products</p></a></li>
<li><a href='#ebirdst_version'><p>eBird Status and Trends Data Products version</p></a></li>
<li><a href='#ebirdst-defunct'><p>Defunct functions in package <span class="pkg">ebirdst</span>.</p></a></li>
<li><a href='#ebirdst-deprecated'><p>Deprecated functions in package <span class="pkg">ebirdst</span>.</p></a></li>
<li><a href='#get_species'><p>Get eBird species code for a set of species</p></a></li>
<li><a href='#get_species_path'><p>Get the path to the data package for a given species</p></a></li>
<li><a href='#grid_sample'><p>Spatiotemporal grid sampling of observation data</p></a></li>
<li><a href='#load_config'><p>Load eBird Status Data Products configuration file</p></a></li>
<li><a href='#load_fac_map_parameters'><p>Load full annual cycle map parameters</p></a></li>
<li><a href='#load_pi'><p>Load predictor importance (PI) rasters</p></a></li>
<li><a href='#load_ppm'><p>Load predictive performance metric (PPM) rasters</p></a></li>
<li><a href='#load_ranges'><p>Load seasonal eBird Status and Trends range polygons</p></a></li>
<li><a href='#load_raster'><p>Load eBird Status Data Products raster data</p></a></li>
<li><a href='#load_regional_stats'><p>Load regional summary statistics</p></a></li>
<li><a href='#load_trends'><p>Load eBird Trends estimates for a set of species</p></a></li>
<li><a href='#rasterize_trends'><p>Convert eBird Trends Data Products to raster format</p></a></li>
<li><a href='#set_ebirdst_access_key'><p>Store the eBird Status and Trends access key</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Access and Analyze eBird Status and Trends Data Products</td>
</tr>
<tr>
<td>Version:</td>
<td>3.2022.3</td>
</tr>
<tr>
<td>Description:</td>
<td>Tools for accessing and analyzing eBird Status and
    Trends Data Products
    (<a href="https://science.ebird.org/en/status-and-trends">https://science.ebird.org/en/status-and-trends</a>). eBird
    (<a href="https://ebird.org/home">https://ebird.org/home</a>) is a global database of bird observations
    collected by member of the public. eBird Status and Trends uses these
    data to model global bird distributions, abundances, and population trends 
    at a high spatial and temporal resolution.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://ebird.github.io/ebirdst/">https://ebird.github.io/ebirdst/</a>, <a href="https://github.com/ebird/ebirdst">https://github.com/ebird/ebirdst</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/ebird/ebirdst/issues">https://github.com/ebird/ebirdst/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>arrow, dplyr (&ge; 1.0.0), grDevices, jsonlite, magrittr,
RColorBrewer, rlang, sf (&ge; 1.0-0), stats, stringr, terra (&ge;
1.6-3), tools, utils, viridisLite</td>
</tr>
<tr>
<td>Suggests:</td>
<td>fields, ggplot2, knitr, PresenceAbsence, rmarkdown,
rnaturalearth, testthat, withr</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-03-05 16:43:44 UTC; mes335</td>
</tr>
<tr>
<td>Author:</td>
<td>Matthew Strimas-Mackey
    <a href="https://orcid.org/0000-0001-8929-7776"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre],
  Shawn Ligocki [aut],
  Tom Auer <a href="https://orcid.org/0000-0001-8619-7147"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Daniel Fink <a href="https://orcid.org/0000-0002-8368-1248"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Cornell Lab of Ornithology [cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Matthew Strimas-Mackey &lt;mes335@cornell.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-03-05 17:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='ebirdst-package'><code>ebirdst</code>: Tools to Load, Map, Plot, and Analyze eBird Status and Trends
Data Products</h2><span id='topic+ebirdst'></span><span id='topic+ebirdst-package'></span>

<h3>Description</h3>

<p>Tools to load, map, plot, and analyze <a href="https://science.ebird.org/status-and-trends">eBird Status and Trends</a> data products
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Matthew Strimas-Mackey <a href="mailto:mes335@cornell.edu">mes335@cornell.edu</a> (<a href="https://orcid.org/0000-0001-8929-7776">ORCID</a>)
</p>
<p>Authors:
</p>

<ul>
<li><p> Shawn Ligocki <a href="mailto:sligocki@cornell.edu">sligocki@cornell.edu</a>
</p>
</li>
<li><p> Tom Auer <a href="mailto:mta45@cornell.edu">mta45@cornell.edu</a> (<a href="https://orcid.org/0000-0001-8619-7147">ORCID</a>)
</p>
</li>
<li><p> Daniel Fink <a href="mailto:df36@cornell.edu">df36@cornell.edu</a> (<a href="https://orcid.org/0000-0002-8368-1248">ORCID</a>)
</p>
</li></ul>

<p>Other contributors:
</p>

<ul>
<li><p> Cornell Lab of Ornithology [copyright holder]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://ebird.github.io/ebirdst/">https://ebird.github.io/ebirdst/</a>
</p>
</li>
<li> <p><a href="https://github.com/ebird/ebirdst">https://github.com/ebird/ebirdst</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/ebird/ebirdst/issues">https://github.com/ebird/ebirdst/issues</a>
</p>
</li></ul>


<hr>
<h2 id='+25+26gt+3B+25'>Pipe operator</h2><span id='topic++25+3E+25'></span>

<h3>Description</h3>

<p>See <code>magrittr::<a href="magrittr.html#topic+pipe">%&gt;%</a></code> for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lhs %&gt;% rhs
</code></pre>

<hr>
<h2 id='abundance_palette-deprecated'>eBird Status and Trends color palettes for mapping</h2><span id='topic+abundance_palette-deprecated'></span>

<h3>Description</h3>

<p>This deprecated function has been replaced by <code><a href="#topic+ebirdst_palettes">ebirdst_palettes</a></code>.
Both functions generate color palettes used for the eBird Status and Trends
relative abundance maps.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>abundance_palette(n,
                        season = c("weekly", "breeding",
                                   "nonbreeding",
                                   "migration",
                                   "prebreeding_migration",
                                   "postbreeding_migration",
                                   "year_round"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="abundance_palette-deprecated_+3A_n">n</code></td>
<td>
<p>integer; the number of colors to be in the palette.</p>
</td></tr>
<tr><td><code id="abundance_palette-deprecated_+3A_season">season</code></td>
<td>
<p>character; the season to generate colors for or &quot;weekly&quot; to
get the color palette used in the weekly abundance animations.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character vector of hex color codes.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ebirdst_palettes">ebirdst_palettes</a></code> <code><a href="#topic+ebirdst-deprecated">ebirdst-deprecated</a></code>
</p>

<hr>
<h2 id='assign_to_grid'>Assign points to a spacetime grid</h2><span id='topic+assign_to_grid'></span>

<h3>Description</h3>

<p>Given a set of points in space and (optionally) time, define a regular grid
with given dimensions, and return the grid cell index for each point.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>assign_to_grid(
  points,
  coords = NULL,
  is_lonlat = FALSE,
  res,
  jitter_grid = TRUE,
  grid_definition = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="assign_to_grid_+3A_points">points</code></td>
<td>
<p>data frame; points with spatial coordinates <code>x</code> and <code>y</code>, and an
optional time coordinate <code>t</code>.</p>
</td></tr>
<tr><td><code id="assign_to_grid_+3A_coords">coords</code></td>
<td>
<p>character; names of the spatial and temporal coordinates in the
input dataframe. Only provide these names if you want to overwrite the
default coordinate names: <code>c("x", "y", "t")</code> or <code>c("longitude", "latitude", "t")</code> if <code>is_lonlat = TRUE</code>.</p>
</td></tr>
<tr><td><code id="assign_to_grid_+3A_is_lonlat">is_lonlat</code></td>
<td>
<p>logical; if the points are in unprojected, lon-lat
coordinates. In this case, the input data frame should have columns
<code>"longitude"</code> and <code>"latitude"</code> and the points will be projected to an equal
area Eckert IV CRS prior to grid assignment.</p>
</td></tr>
<tr><td><code id="assign_to_grid_+3A_res">res</code></td>
<td>
<p>numeric; resolution of the grid in the <code>x</code>, <code>y</code>, and <code>t</code>
dimensions, respectively. If only 2 dimensions are provided, a space only
grid will be generated. The units of <code>res</code> are the same as the coordinates
in the input data unless <code>is_lonlat</code> is true in which case the <code>x</code> and <code>y</code>
resolution should be provided in meters.</p>
</td></tr>
<tr><td><code id="assign_to_grid_+3A_jitter_grid">jitter_grid</code></td>
<td>
<p>logical; whether to jitter the location of the origin of
the grid to introduce some randomness.</p>
</td></tr>
<tr><td><code id="assign_to_grid_+3A_grid_definition">grid_definition</code></td>
<td>
<p>list; object defining the grid via the <code>origin</code> and
<code>resolution</code> components. To assign multiple sets of points to exactly the
same grid, <code><a href="#topic+assign_to_grid">assign_to_grid()</a></code> returns a data frame with a <code>grid_definition</code>
attribute that can be passed to subsequent calls to <code><a href="#topic+assign_to_grid">assign_to_grid()</a></code>.
<code>res</code> and <code>jitter</code> are ignored if <code>grid_definition</code> is provided.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame with the indices of the space-only and spacetime grid
cells. This data frame will have a <code>grid_definition</code> attribute that can be
used to reconstruct the grid.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1)

# generate some example points
points_xyt &lt;- data.frame(x = runif(100), y = runif(100), t = rnorm(100))
# assign to grid
cells &lt;- assign_to_grid(points_xyt, res = c(0.1, 0.1, 0.5))

# assign a second set of points to the same grid
assign_to_grid(points_xyt, grid_definition = attr(cells, "grid_definition"))

# assign lon-lat points to a 10km space-only grid
points_ll &lt;- data.frame(longitude = runif(100, min = -180, max = 180),
                        latitude = runif(100, min = -90, max = 90))
assign_to_grid(points_ll, res = c(10000, 10000), is_lonlat = TRUE)

# overwrite default coordinate names, 5km by 1 week grid
points_names &lt;- data.frame(lon = runif(100, min = -180, max = 180),
                           lat = runif(100, min = -90, max = 90),
                           day = sample.int(365, size = 100))
assign_to_grid(points_names,
               res = c(5000, 5000, 7),
               coords = c("lon", "lat", "day"),
               is_lonlat = TRUE)
</code></pre>

<hr>
<h2 id='calculate_mcc_f1'>Calculate MCC and F1 score</h2><span id='topic+calculate_mcc_f1'></span>

<h3>Description</h3>

<p>Given binary observed and predicted response, estimate Matthews correlation
coefficient (MCC) and the F1 score.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculate_mcc_f1(observed, predicted)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calculate_mcc_f1_+3A_observed">observed</code></td>
<td>
<p>logical or 0/1; the observed binary response.</p>
</td></tr>
<tr><td><code id="calculate_mcc_f1_+3A_predicted">predicted</code></td>
<td>
<p>logical or 0/1; the predicted binary response. This will typically
need to be generated by applying a threshold to the continuous predicted
response.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with two elements: <code>mcc</code> and <code>f1</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>obs &lt;- c(rep(1L, 1000L), rep(0L, 10000L))
pred &lt;- c(rbeta(300L, 12, 2), rbeta(700L, 3, 4), rbeta(10000L, 2, 3))
calculate_mcc_f1(obs &gt; 0, pred &gt; 0.5)
</code></pre>

<hr>
<h2 id='date_to_st_week'>Get the Status and Trends week that a date falls into</h2><span id='topic+date_to_st_week'></span>

<h3>Description</h3>

<p>Get the Status and Trends week that a date falls into
</p>


<h3>Usage</h3>

<pre><code class='language-R'>date_to_st_week(dates, version = 2022)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="date_to_st_week_+3A_dates">dates</code></td>
<td>
<p>a vector of dates.</p>
</td></tr>
<tr><td><code id="date_to_st_week_+3A_version">version</code></td>
<td>
<p>One of <code>2021</code> for the date scheme used for the 2021 and prior
data releases or <code>2022</code> for the date scheme used in the 2022 and subsequent
releases.  Default is <code>2022</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An integer vector of weeks numbers from 1-52.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d &lt;- as.Date(c("2016-04-08", "2018-12-31", "2014-01-01", "2018-09-04"))
date_to_st_week(d)
</code></pre>

<hr>
<h2 id='ebirdst_data_dir'>Path to eBird Status and Trends data download directory</h2><span id='topic+ebirdst_data_dir'></span>

<h3>Description</h3>

<p>Identify and return the path to the default download directory for eBird
Status and Trends data products. This directory can be defined by setting the
environment variable <code>EBIRDST_DATA_DIR</code>, otherwise the directory returned by
<code>tools::R_user_dir("ebirdst", which = "data")</code> will be used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ebirdst_data_dir()
</code></pre>


<h3>Value</h3>

<p>The path to the data download directory.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ebirdst_data_dir()
</code></pre>

<hr>
<h2 id='ebirdst_download_status'>Download eBird Status Data Products</h2><span id='topic+ebirdst_download_status'></span>

<h3>Description</h3>

<p>Download eBird Status Data Products for a single species, or for an example
species. Downloading Status and Trends data requires an access key, consult
<code><a href="#topic+set_ebirdst_access_key">set_ebirdst_access_key()</a></code> for instructions on how to obtain and store this
key. The example data consist of the results for Yellow-bellied Sapsucker
subset to Michigan and are much smaller than the full dataset, making these
data quicker to download and process. Only the low resolution (27 km) data
are available for the example data. In addition, the example data are
accessible without an access key.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ebirdst_download_status(
  species,
  path = ebirdst_data_dir(),
  download_abundance = TRUE,
  download_occurrence = FALSE,
  download_count = FALSE,
  download_ranges = FALSE,
  download_regional = FALSE,
  download_pis = FALSE,
  download_ppms = FALSE,
  download_all = FALSE,
  pattern = NULL,
  dry_run = FALSE,
  force = FALSE,
  show_progress = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ebirdst_download_status_+3A_species">species</code></td>
<td>
<p>character; a single species given as a scientific name, common
name or six-letter species code (e.g. &quot;woothr&quot;). The full list of valid
species is in the <a href="#topic+ebirdst_runs">ebirdst_runs</a> data frame included in this package. To
download the example dataset, use <code>"yebsap-example"</code>.</p>
</td></tr>
<tr><td><code id="ebirdst_download_status_+3A_path">path</code></td>
<td>
<p>character; directory to download the data to. All downloaded
files will be placed in a sub-directory of this directory named for the
data version year, e.g. &quot;2020&quot; for the 2020 Status Data Products. Each
species' data package will then appear in a directory named with the eBird
species code. Defaults to a persistent data directory, which can be found
by calling <code>ebirdst_data_dir()</code>.</p>
</td></tr>
<tr><td><code id="ebirdst_download_status_+3A_download_abundance">download_abundance</code></td>
<td>
<p>whether to download estimates of abundance and
proportion of population.</p>
</td></tr>
<tr><td><code id="ebirdst_download_status_+3A_download_occurrence">download_occurrence</code></td>
<td>
<p>logical; whether to download estimates of
occurrence.</p>
</td></tr>
<tr><td><code id="ebirdst_download_status_+3A_download_count">download_count</code></td>
<td>
<p>logical; whether to download estimates of count.</p>
</td></tr>
<tr><td><code id="ebirdst_download_status_+3A_download_ranges">download_ranges</code></td>
<td>
<p>logical; whether to download the range polygons.</p>
</td></tr>
<tr><td><code id="ebirdst_download_status_+3A_download_regional">download_regional</code></td>
<td>
<p>logical; whether to download the regional summary
stats, e.g. percent of population in regions.</p>
</td></tr>
<tr><td><code id="ebirdst_download_status_+3A_download_pis">download_pis</code></td>
<td>
<p>logical; whether to download spatial estimates of
predictor importance.</p>
</td></tr>
<tr><td><code id="ebirdst_download_status_+3A_download_ppms">download_ppms</code></td>
<td>
<p>logical; whether to download spatial predictive
performance metrics.</p>
</td></tr>
<tr><td><code id="ebirdst_download_status_+3A_download_all">download_all</code></td>
<td>
<p>logical; download all files in the data package.
Equivalent to setting all the <code>download_</code> arguments to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="ebirdst_download_status_+3A_pattern">pattern</code></td>
<td>
<p>character; regular expression pattern to supply to
<a href="stringr.html#topic+str_detect">str_detect()</a> to filter files to download. This
filter will be applied in addition to any of the <code>download_</code> arguments.
Note that some files are mandatory and will always be downloaded.</p>
</td></tr>
<tr><td><code id="ebirdst_download_status_+3A_dry_run">dry_run</code></td>
<td>
<p>logical; whether to do a dry run, just listing files that will
be downloaded. This can be useful when testing the use of <code>pattern</code> to
filter the files to download.</p>
</td></tr>
<tr><td><code id="ebirdst_download_status_+3A_force">force</code></td>
<td>
<p>logical; if the data have already been downloaded, should a
fresh copy be downloaded anyway.</p>
</td></tr>
<tr><td><code id="ebirdst_download_status_+3A_show_progress">show_progress</code></td>
<td>
<p>logical; whether to print download progress information.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The complete data package for each species contains a large number
of files, all of which are cataloged in the vignettes. Most users will only
require a small subset of these files, so by default this function only
downloads the most commonly used files: GeoTIFFs providing estimate of
relative abundance and proportion of population. For those interested in
additional data products, the arguments starting with <code>download_</code> control
the download of these other products. The <code>pattern</code> argument provides even
finer grained control over what gets downloaded.
</p>


<h3>Value</h3>

<p>Path to the folder containing the downloaded data package for the
given species. If <code>dry_run = TRUE</code> a list of files to download will be
returned.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# download the example data
ebirdst_download_status("yebsap-example")

# download the data package for wood thrush
ebirdst_download_status("woothr")

# use pattern to only download low resolution (27 km) geotiff data
# dry_run can be used to see what files will be downloaded
ebirdst_download_status("lobcur", pattern = "_27km_", dry_run = TRUE)
# use pattern to only download high resolution (3 km) weekly abundance data
ebirdst_download_status("lobcur", pattern = "abundance_median_3km",
                        dry_run = TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='ebirdst_download_trends'>Download eBird Trends Data Products</h2><span id='topic+ebirdst_download_trends'></span>

<h3>Description</h3>

<p>Download eBird Trends Data Products for set of species, or for an example
species. Downloading Status and Trends data requires an access key, consult
<code><a href="#topic+set_ebirdst_access_key">set_ebirdst_access_key()</a></code> for instructions on how to obtain and store this
key. The example data consist of the results for Yellow-bellied Sapsucker
subset to Michigan and are much smaller than the full dataset, making these
data quicker to download and process. The example data are accessible without
an access key.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ebirdst_download_trends(
  species,
  path = ebirdst_data_dir(),
  force = FALSE,
  show_progress = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ebirdst_download_trends_+3A_species">species</code></td>
<td>
<p>character; one or more species given as scientific names,
common names or six-letter species codes (e.g. &quot;woothr&quot;). The full list of
valid species can be viewed in the <a href="#topic+ebirdst_runs">ebirdst_runs</a> data frame included in
this package; species with trends estimates are indicated by the
<code>has_trends</code> column. To access the example dataset, use &quot;yebsap-example&quot;.</p>
</td></tr>
<tr><td><code id="ebirdst_download_trends_+3A_path">path</code></td>
<td>
<p>character; directory to download the data to. All downloaded
files will be placed in a sub-directory of this directory named for the
data version year, e.g. &quot;2020&quot; for the 2020 Status Data Products. Each
species' data package will then appear in a directory named with the eBird
species code. Defaults to a persistent data directory, which can be found
by calling <code>ebirdst_data_dir()</code>.</p>
</td></tr>
<tr><td><code id="ebirdst_download_trends_+3A_force">force</code></td>
<td>
<p>logical; if the data have already been downloaded, should a
fresh copy be downloaded anyway.</p>
</td></tr>
<tr><td><code id="ebirdst_download_trends_+3A_show_progress">show_progress</code></td>
<td>
<p>logical; whether to print download progress information.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Character vector of paths to the folders containing the downloaded
data packages for the given species. The trends data will be in the
<code style="white-space: pre;">&#8288;trends/&#8288;</code> subdirectory.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# download the example data
ebirdst_download_trends("yebsap-example")

# download the data package for wood thrush
ebirdst_download_trends("woothr")

# multiple species can be downloaded at once
ebirdst_download_trends(c("Sage Thrasher", "Abert's Towhee"))

## End(Not run)
</code></pre>

<hr>
<h2 id='ebirdst_palettes'>eBird Status and Trends color palettes for mapping</h2><span id='topic+ebirdst_palettes'></span>

<h3>Description</h3>

<p>Generate the color palettes used for the eBird Status and Trends relative
abundance and trends maps.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ebirdst_palettes(
  n,
  type = c("weekly", "breeding", "nonbreeding", "migration", "prebreeding_migration",
    "postbreeding_migration", "year_round", "trends")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ebirdst_palettes_+3A_n">n</code></td>
<td>
<p>integer; the number of colors to be in the palette.</p>
</td></tr>
<tr><td><code id="ebirdst_palettes_+3A_type">type</code></td>
<td>
<p>character; the type of color palette: &quot;weekly&quot; for the weekly
relative abundance, &quot;trends&quot; for trends color palett, and a season name for
the seasonal relative abundance. Note that for trends a diverging palette
is returned, while all other palettes are sequential.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character vector of hex color codes.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># breeding season color palette
ebirdst_palettes(10, type = "breeding")
</code></pre>

<hr>
<h2 id='ebirdst_predictor_descriptions'>eBird Status and Trends predictors descriptions</h2><span id='topic+ebirdst_predictor_descriptions'></span>

<h3>Description</h3>

<p>Details on the eBird Status and Trends predictor variables or, for variables
all derived from the same dataset, details on the dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ebirdst_predictor_descriptions
</code></pre>


<h3>Format</h3>

<p>A data frame with 37 rows and 4 columns
</p>

<ul>
<li> <p><code>dataset</code>: dataset name.
</p>
</li>
<li> <p><code>predictor</code>: predictor name or, if multiple variables are derived from
this dataset, the pattern used to generate the names.
</p>
</li>
<li> <p><code>description</code>: detailed description of the dataset or variable.
</p>
</li>
<li> <p><code>reference</code>: a reference to consult for further information on the dataset.
</p>
</li></ul>


<hr>
<h2 id='ebirdst_predictors'>eBird Status and Trends predictor variables</h2><span id='topic+ebirdst_predictors'></span>

<h3>Description</h3>

<p>A data frame of the predictors used in the eBird Status and Trends models.
These include effort variables (e.g. distance traveled, number of observers,
etc.) in addition to variables describing the environment (e.g. elevation,
land cover, water cover, etc.). The environmental variables are derived by
summarizing remotely sensed datasets (described in
<a href="#topic+ebirdst_predictor_descriptions">ebirdst_predictor_descriptions</a>) over a 3 km diameter neighborhood around
each checklist. For categorical datasets, two variables are generated for
each class describing the percent cover (<code>pland</code>) and edge density (<code>ed</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ebirdst_predictors
</code></pre>


<h3>Format</h3>

<p>A data frame with 150 rows and 4 columns:
</p>

<ul>
<li> <p><code>predictor</code>: predictor name.
</p>
</li>
<li> <p><code>dataset</code>: dataset name, which can be cross referenced in
<a href="#topic+ebirdst_predictor_descriptions">ebirdst_predictor_descriptions</a> for further details.
</p>
</li>
<li> <p><code>class</code>: class number or name for categorical variables.
</p>
</li>
<li> <p><code>label</code>: descriptive labels for each predictor variable.
</p>
</li></ul>


<hr>
<h2 id='ebirdst_runs'>Data frame of species with eBird Status and Trends Data Products</h2><span id='topic+ebirdst_runs'></span>

<h3>Description</h3>

<p>A dataset listing the species for which eBird Status and Trends Data Products
are available, with additional information relevant to both the Status and
Trends results for each species.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ebirdst_runs
</code></pre>


<h3>Format</h3>

<p>A data frame with 27 variables:
</p>

<ul>
<li> <p><code>species_code</code>: alphanumeric eBird species code uniquely identifying the
species
</p>
</li>
<li> <p><code>scientific_name</code>: scientific name.
</p>
</li>
<li> <p><code>common_name</code>: English common name.
</p>
</li>
<li> <p><code>is_resident</code>: classifies this species a resident or a migrant.
</p>
</li>
<li> <p><code>breeding_quality</code>: breeding season quality.
</p>
</li>
<li> <p><code>breeding_start</code>: breeding season start date.
</p>
</li>
<li> <p><code>breeding_end</code>: breeding season start date.
</p>
</li>
<li> <p><code>nonbreeding_quality</code>: non-breeding season quality.
</p>
</li>
<li> <p><code>nonbreeding_start</code>: non-breeding season start date.
</p>
</li>
<li> <p><code>nonbreeding_end</code>: non-breeding season start date.
</p>
</li>
<li> <p><code>postbreeding_migration_quality</code>: post-breeding season quality.
</p>
</li>
<li> <p><code>postbreeding_migration_start</code>: post-breeding season start date.
</p>
</li>
<li> <p><code>postbreeding_migration_end</code>: post-breeding season start date.
</p>
</li>
<li> <p><code>prebreeding_migration_quality</code>: pre-breeding season quality.
</p>
</li>
<li> <p><code>prebreeding_migration_start</code>: pre-breeding season start date.
</p>
</li>
<li> <p><code>prebreeding_migration_end</code>: pre-breeding season start date.
</p>
</li>
<li> <p><code>resident_quality</code>: resident quality.
</p>
</li>
<li> <p><code>resident_start</code>: for resident species, the year-round start date.
</p>
</li>
<li> <p><code>resident_end</code>: for resident species, the year-round end date.
</p>
</li>
<li> <p><code>has_trends</code>: whether or not this species has trends estimates.
</p>
</li>
<li> <p><code>trends_season</code>: season that the trend was estimated for: breeding,
nonbreeding, or resident.
</p>
</li>
<li> <p><code>trends_region</code>: the geographic region that the trend model was run for.
Note that broadly distributed species (e.g. Barn Swallow) will only have
trend estimates for a regional subset of their full range.
</p>
</li>
<li> <p><code>trends_start_year</code>: start year of the trend time period.
</p>
</li>
<li> <p><code>trends_end_year</code>: end year of the trend time period.
</p>
</li>
<li> <p><code>trends_start_date</code>: start date (<code>MM-DD</code> format) of the season for which the trend was estimated.
</p>
</li>
<li> <p><code>trends_end_date</code>: end date (<code>MM-DD</code> format) of the season for which the trend was estimated.
</p>
</li>
<li> <p><code>rsquared</code>: R-squared value comparing the actual and estimated trends from the simulations.
</p>
</li>
<li> <p><code>beta0</code>: the intercept of a linear model fitting actual vs. estimated
trends.
(<code>actual ~ estimated</code>) for the simulations. Positive values of <code>beta0</code>
indicate that the models are systematically <em>underestimating</em> the simulated
trend for this species.
</p>
</li></ul>



<h3>Details</h3>

<p>For the Status Data Products, the dates defining the boundaries of the
seasons are provided in additional to a quality rating from 0-3 for each
season. These dates and quality ratings are assigned through a process of
<a href="https://science.ebird.org/status-and-trends/faq#seasons">expert review</a>.
expert review. Note that missing dates imply that a season failed expert
review for that species within that season.
</p>
<p>Trends Data Products are only available for a subset of species, indicated by
the <code>has_trends</code> variable, and for each species the trends is estimated for a
single season. The two predictive performance metrics (<code>rsquared</code> and
<code>beta0</code>) are based on a comparison of actual and estimated percent per year
trends for a suite of simulations (see Fink et al. 2023 for further details).
The trends regions are defined as follows:
</p>

<ul>
<li> <p><code>aus_nz</code>: Australia and New Zealand
</p>
</li>
<li> <p><code>iberia</code>: Spain and Portugal
</p>
</li>
<li> <p><code>india_se_asia</code>: India, Nepal, Bhutan, Sri Lanka, Thailand, Cambodia,
Malaysia, Brunei, Singapore, and Philippines
</p>
</li>
<li> <p><code>japan</code>: Japan
</p>
</li>
<li> <p><code>north_america</code>: North America including Mexico, Central America, and the
Caribbean, but excluding Nunavut, North West Territories, and Hawaii
</p>
</li>
<li> <p><code>south_africa</code>: South Africa, Lesotho, and Eswatini
</p>
</li>
<li> <p><code>south_america</code>: Colombia, Ecuador, Peru, Chile, Argentina, and Uruguay
</p>
</li>
<li> <p><code>taiwan</code>: Taiwan
</p>
</li>
<li> <p><code>turkey_plus</code>: Turkey, Cyprus, Israel, Palestine, Greece, Armenia, and
Georgia
</p>
</li></ul>


<hr>
<h2 id='ebirdst_version'>eBird Status and Trends Data Products version</h2><span id='topic+ebirdst_version'></span>

<h3>Description</h3>

<p>Identify the version of the eBird Status and Trends Data Products that this
version of the R package works with. Versions are defined by the year that
all model estimates are made for. In addition, the release data and end date
for access of this version of the data are provided. Note that after the
given access end data you will no longer be able to download this version of
the data and will be required to update the R package and transition to using
a newer data version.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ebirdst_version()
</code></pre>


<h3>Value</h3>

<p>A list with three components: <code>version_year</code> is the year the model
estimates are made for in this version of the data, <code>release_year</code> is the
year this version of the data were released, and <code>access_end_date</code> is the
last date that users will be able to download this version of the data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ebirdst_version()
</code></pre>

<hr>
<h2 id='ebirdst-defunct'>Defunct functions in package <span class="pkg">ebirdst</span>.</h2><span id='topic+ebirdst-defunct'></span><span id='topic+ebirdst_download'></span><span id='topic+ebirdst_extent'></span><span id='topic+ebirdst_habitat'></span><span id='topic+ebirdst_ppms'></span><span id='topic+ebirdst_ppms_ts'></span><span id='topic+ebirdst_subset'></span><span id='topic+load_pds'></span><span id='topic+load_pis'></span><span id='topic+load_predictions'></span><span id='topic+parse_raster_dates'></span><span id='topic+load_stixels'></span><span id='topic+project_extent'></span><span id='topic+plot_pds'></span><span id='topic+plot_pis'></span><span id='topic+stixelize'></span>

<h3>Description</h3>

<p>The functions listed below are defunct and no longer supported.
Calling them will result in an error.
</p>
<p>When possible alternative functions are suggested.
</p>
<p>Many of them supported stixles which were infrequently used and were
dropped from <span class="pkg">ebirdst</span> with the 2022 data release.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ebirdst_download(
  species,
  path = ebirdst_data_dir(),
  tifs_only = TRUE,
  force = FALSE,
  show_progress = TRUE,
  pattern = NULL,
  dry_run = FALSE
)

ebirdst_extent(x, t, ...)

ebirdst_habitat(path, ext, data = NULL, stationary_associations = FALSE)

ebirdst_ppms(path, ext, es_cutoff, pat_cutoff)

ebirdst_ppms_ts(ath, ext, summarize_by = c("weeks", "months"), ...)

ebirdst_subset(x, crs)

load_pds(path, ext, model = c("occurrence", "count"), return_sf = FALSE)

load_pis(path, ext, model = c("occurrence", "count"), return_sf = FALSE)

load_predictions(path, return_sf = FALSE)

parse_raster_dates(x)

load_stixels(path, ext, return_sf = FALSE)

project_extent(x, crs)

plot_pds(path, ext, summarize_by = c("weeks", "months"), ...)

plot_pis(
  pis,
  ext,
  by_cover_class = TRUE,
  n_top_pred = 15,
  pretty_names = TRUE,
  plot = TRUE
)

stixelize(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ebirdst-defunct_+3A_...">...</code></td>
<td>
<p>All arguments are now ignored.</p>
</td></tr>
</table>

<hr>
<h2 id='ebirdst-deprecated'>Deprecated functions in package <span class="pkg">ebirdst</span>.</h2><span id='topic+ebirdst-deprecated'></span><span id='topic+abundance_palette'></span>

<h3>Description</h3>

<p>The functions listed below are deprecated and support for them
will eventually be dropped.
Help pages for deprecated functions are
available at <code>help("&lt;function&gt;-deprecated")</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>abundance_palette(
  n,
  season = c("weekly", "breeding", "nonbreeding", "migration", "prebreeding_migration",
    "postbreeding_migration", "year_round")
)
</code></pre>


<h3><code>abundance_palette</code></h3>

<p>For <code>abundance_palette</code>, use <code><a href="#topic+ebirdst_palettes">ebirdst_palettes</a></code>
</p>

<hr>
<h2 id='get_species'>Get eBird species code for a set of species</h2><span id='topic+get_species'></span>

<h3>Description</h3>

<p>Give a vector of species codes, common names, and/or scientific names, return
a vector of 6-letter eBird species codes. This function will only look up
codes for species for which eBird Status and Trends results exist.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_species(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_species_+3A_x">x</code></td>
<td>
<p>character; vector of species codes, common names, and/or scientific
names.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character vector of eBird species codes.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>get_species(c("Black-capped Chickadee", "Poecile gambeli", "carchi"))
</code></pre>

<hr>
<h2 id='get_species_path'>Get the path to the data package for a given species</h2><span id='topic+get_species_path'></span>

<h3>Description</h3>

<p>This helper function can be used to get the path to a data package for a
given species.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_species_path(species, path = ebirdst_data_dir(), check_downloaded = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_species_path_+3A_species">species</code></td>
<td>
<p>character; a single species given as a scientific name, common
name or six-letter species code (e.g. &quot;woothr&quot;). The full list of valid
species is in the <a href="#topic+ebirdst_runs">ebirdst_runs</a> data frame included in this package. To
download the example dataset, use <code>"yebsap-example"</code>.</p>
</td></tr>
<tr><td><code id="get_species_path_+3A_path">path</code></td>
<td>
<p>character; directory to download the data to. All downloaded
files will be placed in a sub-directory of this directory named for the
data version year, e.g. &quot;2020&quot; for the 2020 Status Data Products. Each
species' data package will then appear in a directory named with the eBird
species code. Defaults to a persistent data directory, which can be found
by calling <code>ebirdst_data_dir()</code>.</p>
</td></tr>
<tr><td><code id="get_species_path_+3A_check_downloaded">check_downloaded</code></td>
<td>
<p>logical; raise an error if no data have been
downloaded for this species.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The path to the data package directory.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# get the path
path &lt;- get_species_path("yebsap-example")

# get the path to the full data package for yellow-bellied sapsucker
# common name, scientific name, or species code can be used
path &lt;- get_species_path("Yellow-bellied Sapsucker")
path &lt;- get_species_path("Sphyrapicus varius")
path &lt;- get_species_path("yebsap")

## End(Not run)
</code></pre>

<hr>
<h2 id='grid_sample'>Spatiotemporal grid sampling of observation data</h2><span id='topic+grid_sample'></span><span id='topic+grid_sample_stratified'></span>

<h3>Description</h3>

<p>Sample observation data on a spacetime grid to reduce spatiotemporal bias.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>grid_sample(
  x,
  coords = c("longitude", "latitude", "day_of_year"),
  is_lonlat = TRUE,
  res = c(3000, 3000, 7),
  jitter_grid = TRUE,
  sample_size_per_cell = 1,
  cell_sample_prop = 0.75,
  keep_cell_id = FALSE,
  grid_definition = NULL
)

grid_sample_stratified(
  x,
  coords = c("longitude", "latitude", "day_of_year"),
  is_lonlat = TRUE,
  unified_grid = FALSE,
  keep_cell_id = FALSE,
  by_year = TRUE,
  case_control = TRUE,
  obs_column = "obs",
  sample_by = NULL,
  min_detection_probability = 0,
  maximum_ss = NULL,
  jitter_columns = NULL,
  jitter_sd = 0.1,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="grid_sample_+3A_x">x</code></td>
<td>
<p>data frame; observations to sample, including at least the columns
defining the location in space and time. Additional columns can be included
such as features that will later be used in model training.</p>
</td></tr>
<tr><td><code id="grid_sample_+3A_coords">coords</code></td>
<td>
<p>character; names of the spatial and temporal coordinates. By
default the spatial spatial coordinates should be <code>longitude</code> and
<code>latitude</code>, and temporal coordinate should be <code>day_of_year</code>.</p>
</td></tr>
<tr><td><code id="grid_sample_+3A_is_lonlat">is_lonlat</code></td>
<td>
<p>logical; if the points are in unprojected, lon-lat
coordinates. In this case, the points will be projected to an equal area
Eckert IV CRS prior to grid assignment.</p>
</td></tr>
<tr><td><code id="grid_sample_+3A_res">res</code></td>
<td>
<p>numeric; resolution of the spatiotemporal grid in the x, y, and
time dimensions. Unprojected locations are projected to an equal area
coordinate system prior to sampling, and resolution should therefore be
provided in units of meters. The temporal resolution should be in the
native units of the time coordinate in the input data frame, typically it
will be a number of days.</p>
</td></tr>
<tr><td><code id="grid_sample_+3A_jitter_grid">jitter_grid</code></td>
<td>
<p>logical; whether to jitter the location of the origin of
the grid to introduce some randomness.</p>
</td></tr>
<tr><td><code id="grid_sample_+3A_sample_size_per_cell">sample_size_per_cell</code></td>
<td>
<p>integer; number of observations to sample from
each grid cell.</p>
</td></tr>
<tr><td><code id="grid_sample_+3A_cell_sample_prop">cell_sample_prop</code></td>
<td>
<p>proportion <code style="white-space: pre;">&#8288;(0-1]&#8288;</code>; if less than 1, only this
proportion of cells will be randomly selected for sampling.</p>
</td></tr>
<tr><td><code id="grid_sample_+3A_keep_cell_id">keep_cell_id</code></td>
<td>
<p>logical; whether to retain a unique cell identifier,
stored in column named <code>.cell_id</code>.</p>
</td></tr>
<tr><td><code id="grid_sample_+3A_grid_definition">grid_definition</code></td>
<td>
<p>list defining the spatiotemporal sampling grid as
returned by <code><a href="#topic+assign_to_grid">assign_to_grid()</a></code> in the form of an attribute of the returned
data frame.</p>
</td></tr>
<tr><td><code id="grid_sample_+3A_unified_grid">unified_grid</code></td>
<td>
<p>logical; whether a single, unified spatiotemporal
sampling grid should be defined and used for all observations in <code>x</code> or a
different grid should be used for each stratum.</p>
</td></tr>
<tr><td><code id="grid_sample_+3A_by_year">by_year</code></td>
<td>
<p>logical; whether the sampling should be done by year, i.e.
sampling N observations per grid cell per year, rather than across years,
i.e. N observations per grid cell regardless of year. If using sampling by
year, the input data frame <code>x</code> must have a <code>year</code> column.</p>
</td></tr>
<tr><td><code id="grid_sample_+3A_case_control">case_control</code></td>
<td>
<p>logical; whether to apply case control sampling whereby
presence and absence are sampled independently.</p>
</td></tr>
<tr><td><code id="grid_sample_+3A_obs_column">obs_column</code></td>
<td>
<p>character; if <code>case_control = TRUE</code>, this is the name of
the column in <code>x</code> that defines detection (<code>obs_column &gt; 0</code>) and
non-detection (<code>obs_column == 0</code>).</p>
</td></tr>
<tr><td><code id="grid_sample_+3A_sample_by">sample_by</code></td>
<td>
<p>character; additional columns in <code>x</code> to stratify sampling
by. For example, if a landscape has many small islands (defined by an
<code>island</code> variable) and we wish to sample from each independently, use
<code>sample_by = "island"</code>.</p>
</td></tr>
<tr><td><code id="grid_sample_+3A_min_detection_probability">min_detection_probability</code></td>
<td>
<p>proportion <code style="white-space: pre;">&#8288;[0-1)&#8288;</code>; the minimum detection
probability in the final dataset. If <code>case_control = TRUE</code>, and the
proportion of detections in the grid sampled dataset is below this level,
then additional detections will be added via grid sampling the detections
from the input dataset until at least this proportion of detections appears
in the final dataset. This will typically result in duplication of some
observations in the final dataset. To turn this off this feature use
<code>min_detection_probability = 0</code>.</p>
</td></tr>
<tr><td><code id="grid_sample_+3A_maximum_ss">maximum_ss</code></td>
<td>
<p>integer; the maximum sample size in the final dataset. If
the grid sampling yields more than this number of observations,
<code>maximum_ss</code> observations will be selected randomly from the full set. Note
that this subsampling will be performed in such a way that all levels of
each strata will have at least one observation within the final dataset,
and therefore it is not truly randomly sampling.</p>
</td></tr>
<tr><td><code id="grid_sample_+3A_jitter_columns">jitter_columns</code></td>
<td>
<p>character; if detections are oversampled to achieve the
minimum detection probability, some observations will be duplicated, and it
can be desirable to slightly &quot;jitter&quot; the values of model training features
for these duplicated observations. This argument defines the column names
in <code>x</code> that will be jittered.</p>
</td></tr>
<tr><td><code id="grid_sample_+3A_jitter_sd">jitter_sd</code></td>
<td>
<p>numeric; strength of the jittering in units of standard
deviations, see <code>jitter_columns</code>.</p>
</td></tr>
<tr><td><code id="grid_sample_+3A_...">...</code></td>
<td>
<p>additional arguments defining the spatiotemporal grid; passed to
<code><a href="#topic+grid_sample">grid_sample()</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code><a href="#topic+grid_sample_stratified">grid_sample_stratified()</a></code> performs stratified case control sampling,
independently sampling from strata defined by, for example, year and
detection/non-detection. Within each stratum, <code><a href="#topic+grid_sample">grid_sample()</a></code> is used to
sample the observations on a spatiotemporal grid. In addition, if case
control sampling is turned on, the detections are oversampled to increase the
frequecy of detections in the dataset.
</p>
<p>The sampling grid is defined, and assignment of locations to cells occurs, in
<code><a href="#topic+assign_to_grid">assign_to_grid()</a></code>. Consult the help for that function for further details on
how the grid is generated and locations are assigned. Note that by providing
2-element vectors to both <code>coords</code> and <code>res</code> the time component of the grid
can be ignored and spatial-only subsampling is performed.
</p>


<h3>Value</h3>

<p>A data frame of the spatiotemporally sampled data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1)

# generate some example observations
n_obs &lt;- 10000
checklists &lt;- data.frame(longitude = rnorm(n_obs, sd = 0.1),
                         latitude = rnorm(n_obs, sd = 0.1),
                         day_of_year = sample.int(28, n_obs, replace = TRUE),
                         year = NA_integer_,
                         obs = rpois(n_obs, lambda = 0.1),
                         forest_cover = runif(n_obs),
                         island = as.integer(runif(n_obs) &gt; 0.95))
# add a year column, giving more data to recent years
checklists$year &lt;- sample(seq(2016, 2020), size = n_obs, replace = TRUE,
                          prob = seq(0.3, 0.7, length.out = 5))
# create several rare islands
checklists$island[sample.int(nrow(checklists), 9)] &lt;- 2:10

# basic spatiotemporal grid sampling
sampled &lt;- grid_sample(checklists)

# plot original data and grid sampled data
par(mar = c(0, 0, 0, 0))
plot(checklists[, c("longitude", "latitude")],
     pch = 19, cex = 0.3, col = "#00000033",
     axes = FALSE)
points(sampled[, c("longitude", "latitude")],
       pch = 19, cex = 0.3, col = "red")

# case control sampling stratified by year and island
# return a maximum of 1000 checklists
sampled_cc &lt;- grid_sample_stratified(checklists, sample_by = "island",
                                     maximum_ss = 1000)

# case control sampling increases the prevalence of detections
mean(checklists$obs &gt; 0)
mean(sampled$obs &gt; 0)
mean(sampled_cc$obs &gt; 0)

# stratifying by island ensures all levels are retained, even rare ones
table(checklists$island)
# normal grid sampling loses rare island levels
table(sampled$island)
# stratified grid sampling retain at least one observation from each level
table(sampled_cc$island)
</code></pre>

<hr>
<h2 id='load_config'>Load eBird Status Data Products configuration file</h2><span id='topic+load_config'></span>

<h3>Description</h3>

<p>Load the configuration file for an eBird Status run. This configuration file
is mostly for internal use and contains a variety of parameters used in the
modeling process.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>load_config(species, path = ebirdst_data_dir())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="load_config_+3A_species">species</code></td>
<td>
<p>character; the species to load data for, given as a scientific
name, common name or six-letter species code (e.g. &quot;woothr&quot;). The full list
of valid species is in the <a href="#topic+ebirdst_runs">ebirdst_runs</a> data frame included in this
package. To download the example dataset, use <code>"yebsap-example"</code>.</p>
</td></tr>
<tr><td><code id="load_config_+3A_path">path</code></td>
<td>
<p>character; directory to download the data to. All downloaded
files will be placed in a sub-directory of this directory named for the
data version year, e.g. &quot;2020&quot; for the 2020 Status Data Products. Each
species' data package will then appear in a directory named with the eBird
species code. Defaults to a persistent data directory, which can be found
by calling <code>ebirdst_data_dir()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the run configuration parameters.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# download example data if hasn't already been downloaded
ebirdst_download_status("yebsap-example")

# load configuration parameters
p &lt;- load_config("yebsap-example")

## End(Not run)
</code></pre>

<hr>
<h2 id='load_fac_map_parameters'>Load full annual cycle map parameters</h2><span id='topic+load_fac_map_parameters'></span>

<h3>Description</h3>

<p>Get the map parameters used on the eBird Status and Trends website to
optimally display the full annual cycle data. This includes bins for the
abundance data, a projection, and an extent to map. The extent is the spatial
extent of non-zero data across the full annual cycle and the projection is
optimized for this extent.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>load_fac_map_parameters(species, path = ebirdst_data_dir())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="load_fac_map_parameters_+3A_species">species</code></td>
<td>
<p>character; the species to load data for, given as a scientific
name, common name or six-letter species code (e.g. &quot;woothr&quot;). The full list
of valid species is in the <a href="#topic+ebirdst_runs">ebirdst_runs</a> data frame included in this
package. To download the example dataset, use <code>"yebsap-example"</code>.</p>
</td></tr>
<tr><td><code id="load_fac_map_parameters_+3A_path">path</code></td>
<td>
<p>character; directory to download the data to. All downloaded
files will be placed in a sub-directory of this directory named for the
data version year, e.g. &quot;2020&quot; for the 2020 Status Data Products. Each
species' data package will then appear in a directory named with the eBird
species code. Defaults to a persistent data directory, which can be found
by calling <code>ebirdst_data_dir()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing elements:
</p>

<ul>
<li> <p><code>custom_projection</code>: a custom projection optimized for the given species'
full annual cycle
</p>
</li>
<li> <p><code>fa_extent</code>: a <a href="terra.html#topic+ext">SpatExtent</a> object storing the spatial
extent of non-zero
data for the given species in the custom projection
</p>
</li>
<li> <p><code>res</code>: a numeric vector with 2 elements giving the target resolution of
raster in the custom projection
</p>
</li>
<li> <p><code>fa_extent_sinu</code>: the extent in sinusoidal projection
</p>
</li>
<li> <p><code>weekly_bins</code>/<code>weekly_labels</code>: weekly abundance bins and labels for the
full annual cycle
</p>
</li>
<li> <p><code>seasonal_bins</code>/'seasonal_labels: seasonal abundance bins and labels for
the full annual cycle
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# download example data if hasn't already been downloaded
ebirdst_download_status("yebsap-example")

# load configuration parameters
load_fac_map_parameters(path)

## End(Not run)
</code></pre>

<hr>
<h2 id='load_pi'>Load predictor importance (PI) rasters</h2><span id='topic+load_pi'></span><span id='topic+list_available_pis'></span>

<h3>Description</h3>

<p>The eBird Status models estimate the relative importance of each
environmental predictor used in the model. These predictor importance (PI)
data are converted to ranks (with a rank of 1 being the most important)
relative to the full suite of environmental predictors. The ranks are
summarized to a 27 km resolution raster grid for each predictor, where the
cell values are the average across all models in the ensemble contributing to
that cell. These data are available in raster format provided <code>download_pis = TRUE</code> was used when calling <code><a href="#topic+ebirdst_download_status">ebirdst_download_status()</a></code>. PI estimates are
available separately for both the occurrence and count sub-model and only the
30 most important predictors are distributed. Use <code><a href="#topic+list_available_pis">list_available_pis()</a></code> to
see which predictors have PI data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>load_pi(
  species,
  predictor,
  response = c("occurrence", "count"),
  path = ebirdst_data_dir()
)

list_available_pis(species, path = ebirdst_data_dir())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="load_pi_+3A_species">species</code></td>
<td>
<p>character; the species to load data for, given as a scientific
name, common name or six-letter species code (e.g. &quot;woothr&quot;). The full list
of valid species is in the <a href="#topic+ebirdst_runs">ebirdst_runs</a> data frame included in this
package. To download the example dataset, use <code>"yebsap-example"</code>.</p>
</td></tr>
<tr><td><code id="load_pi_+3A_predictor">predictor</code></td>
<td>
<p>character; the predictor that the PI data should be loaded
for. The list of predictors that PI data are available for varies by
species, use <code><a href="#topic+list_available_pis">list_available_pis()</a></code> to get the list for a given species.</p>
</td></tr>
<tr><td><code id="load_pi_+3A_response">response</code></td>
<td>
<p>character; the model (occurrence or count) that the PI
data should be loaded for.</p>
</td></tr>
<tr><td><code id="load_pi_+3A_path">path</code></td>
<td>
<p>character; directory to download the data to. All downloaded
files will be placed in a sub-directory of this directory named for the
data version year, e.g. &quot;2020&quot; for the 2020 Status Data Products. Each
species' data package will then appear in a directory named with the eBird
species code. Defaults to a persistent data directory, which can be found
by calling <code>ebirdst_data_dir()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <a href="terra.html#topic+SpatRaster-class">SpatRaster</a> object with the PI ranks for the
given predictor. For migrants, the estimates are weekly and the raster will
have 52 layers, where the layer names are the dates (<code>MM-DD</code> format) of the
midpoint of each week. For residents, a single year round layer is
returned.
</p>
<p><code><a href="#topic+list_available_pis">list_available_pis()</a></code> returns a data frame listing the top 30 predictors for
which PI rasters can be loaded. In addition to the predictor names, the mean
range-wide rank (<code>rangewide_rank</code>) is given as well as the integer rank
(<code>rank</code>) relative to the other 29 predictors.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>list_available_pis()</code>: list the predictors that have PI information for this
species.
</p>
</li></ul>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# download example data if hasn't already been downloaded
ebirdst_download_status("yebsap-example", download_pis = TRUE)

# identify the top predictor
top_preds &lt;- list_available_pis("yebsap-example")
print(top_preds[1, ])

# load predictor importance raster of top predictor for occurrence
load_pi("yebsap-example", top_preds$predictor[1])

## End(Not run)
</code></pre>

<hr>
<h2 id='load_ppm'>Load predictive performance metric (PPM) rasters</h2><span id='topic+load_ppm'></span>

<h3>Description</h3>

<p>eBird Status models are evaluated against a test set of eBird data not used
during model training and a suite of predictive performance metrics (PPMs)
are calculated. The PPMs for each base model are summarized to a 27 km
resolution raster grid, where the cell values are the average across all
models in the ensemble contributing to that cell. These data are available in
raster format provided <code>download_ppms = TRUE</code> was used when calling
<code><a href="#topic+ebirdst_download_status">ebirdst_download_status()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>load_ppm(
  species,
  ppm = c("binary_f1", "binary_pr_auc", "occ_bernoulli_dev", "count_spearman",
    "log_count_pearson", "abd_poisson_dev", "abd_spearman", "log_abd_pearson"),
  path = ebirdst_data_dir()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="load_ppm_+3A_species">species</code></td>
<td>
<p>character; the species to load data for, given as a scientific
name, common name or six-letter species code (e.g. &quot;woothr&quot;). The full list
of valid species is in the <a href="#topic+ebirdst_runs">ebirdst_runs</a> data frame included in this
package. To download the example dataset, use <code>"yebsap-example"</code>.</p>
</td></tr>
<tr><td><code id="load_ppm_+3A_ppm">ppm</code></td>
<td>
<p>character; the name of a single metric to load data for. See
Details for definitions of each metric.</p>
</td></tr>
<tr><td><code id="load_ppm_+3A_path">path</code></td>
<td>
<p>character; directory to download the data to. All downloaded
files will be placed in a sub-directory of this directory named for the
data version year, e.g. &quot;2020&quot; for the 2020 Status Data Products. Each
species' data package will then appear in a directory named with the eBird
species code. Defaults to a persistent data directory, which can be found
by calling <code>ebirdst_data_dir()</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Eight predictive performance metrics are provided:
</p>

<ul>
<li> <p><code>binary_f1</code>: F1-score comparing the model predictions converted to binary
with the observed detection/non-detection for the test checklists.
</p>
</li>
<li> <p><code>binary_pr_auc</code>: the area on the precision-recall curve generated by
comparing the model predictions converted to binary with the observed
detection/non-detection for the test checklists.
</p>
</li>
<li> <p><code>occ_bernoulli_dev</code>: Bernoulli deviance comparing the predicted occurrence
with the observed detection/non-detection for the test checklists.
</p>
</li>
<li> <p><code>count_spearman</code>: Spearman's rank correlation coefficient comparing the
predicted count with the observed count for the subset of test checklists
on which the species was detected.
</p>
</li>
<li> <p><code>log_count_pearson</code>: Pearson correlation coefficient comparing the
logarithm of the predicted count with the logarithm of the observed count
for the subset of test checklists on which the species was detected.
</p>
</li>
<li> <p><code>abd_poisson_dev</code>: Poisson deviance comparing the predicted relative
abundance with the observed count for the full set of test checklists.
</p>
</li>
<li> <p><code>abd_spearman</code>: Spearman's rank  correlation coefficient comparing the
predicted relative abundance with the observed count for the full set of
test checklists.
</p>
</li>
<li> <p><code>log_abd_pearson</code>: Pearson correlation coefficient comparing the logarithm
of the predicted relative abundance with the logarithm of the observed
count for the full set of test checklists.
</p>
</li></ul>



<h3>Value</h3>

<p>A <a href="terra.html#topic+SpatRaster-class">SpatRaster</a> object with the PPM data. For
migrants, rasters are weekly with  52 layers, where the layer names are the
dates (<code>MM-DD</code> format) of the midpoint of each week. For residents, a
single year round layer is returned.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# download example data if hasn't already been downloaded
ebirdst_download_status("yebsap-example", download_ppms = TRUE)

# load area under the precision-recall curve PPM raster
load_ppm("yebsap-example", ppm = "binary_pr_auc")

## End(Not run)
</code></pre>

<hr>
<h2 id='load_ranges'>Load seasonal eBird Status and Trends range polygons</h2><span id='topic+load_ranges'></span>

<h3>Description</h3>

<p>Range polygons are defined as the boundaries of non-zero seasonal relative
abundance estimates, which are then (optionally) smoothed to produce more
aesthetically pleasing polygons using the <code>smoothr</code> package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>load_ranges(
  species,
  resolution = c("9km", "27km"),
  smoothed = TRUE,
  path = ebirdst_data_dir()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="load_ranges_+3A_species">species</code></td>
<td>
<p>character; the species to load data for, given as a scientific
name, common name or six-letter species code (e.g. &quot;woothr&quot;). The full list
of valid species is in the <a href="#topic+ebirdst_runs">ebirdst_runs</a> data frame included in this
package. To download the example dataset, use <code>"yebsap-example"</code>.</p>
</td></tr>
<tr><td><code id="load_ranges_+3A_resolution">resolution</code></td>
<td>
<p>character; the raster resolution from which the range
polygons were derived.</p>
</td></tr>
<tr><td><code id="load_ranges_+3A_smoothed">smoothed</code></td>
<td>
<p>logical; whether smoothed or unsmoothed ranges should be
loaded.</p>
</td></tr>
<tr><td><code id="load_ranges_+3A_path">path</code></td>
<td>
<p>character; directory to download the data to. All downloaded
files will be placed in a sub-directory of this directory named for the
data version year, e.g. &quot;2020&quot; for the 2020 Status Data Products. Each
species' data package will then appear in a directory named with the eBird
species code. Defaults to a persistent data directory, which can be found
by calling <code>ebirdst_data_dir()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An <code>sf</code> update containing the seasonal range boundaries, with each
season provided as a different feature.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# download example data if hasn't already been downloaded
ebirdst_download_status("yebsap-example")

# load smoothed ranges
# note that only 27 km data are provided for the example data
ranges &lt;- load_ranges("yebsap-example", resolution = "27km")

## End(Not run)
</code></pre>

<hr>
<h2 id='load_raster'>Load eBird Status Data Products raster data</h2><span id='topic+load_raster'></span>

<h3>Description</h3>

<p>Each of the eBird Status raster products is packaged as a GeoTIFF file
representing predictions on a regular grid. The core products are occurrence,
count, relative abundance, and proportion of population. This function loads
one of the available data products into R as a
<a href="terra.html#topic+SpatRaster-class">SpatRaster</a> object. Note that data must be download using
<code><a href="#topic+ebirdst_download_status">ebirdst_download_status()</a></code> prior to loading it using this function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>load_raster(
  species,
  product = c("abundance", "count", "occurrence", "proportion-population"),
  period = c("weekly", "seasonal", "full-year"),
  metric = NULL,
  resolution = c("3km", "9km", "27km"),
  path = ebirdst_data_dir()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="load_raster_+3A_species">species</code></td>
<td>
<p>character; the species to load data for, given as a scientific
name, common name or six-letter species code (e.g. &quot;woothr&quot;). The full list
of valid species is in the <a href="#topic+ebirdst_runs">ebirdst_runs</a> data frame included in this
package. To download the example dataset, use <code>"yebsap-example"</code>.</p>
</td></tr>
<tr><td><code id="load_raster_+3A_product">product</code></td>
<td>
<p>character; eBird Status raster product to load: occurrence,
count, relative abundance, or proportion of population. See Details for a
detailed explanation of each of these products.</p>
</td></tr>
<tr><td><code id="load_raster_+3A_period">period</code></td>
<td>
<p>character; temporal period of the estimation. The eBird Status
models make predictions for each week of the year; however, as a
convenience, data are also provided summarized at the seasonal or annual
(&quot;full-year&quot;) level.</p>
</td></tr>
<tr><td><code id="load_raster_+3A_metric">metric</code></td>
<td>
<p>character; by default, the weekly products provide estimates of
the median value (<code>metric = "median"</code>) and the summarized products are the
cell-wise mean across the weeks within the season (<code>metric = "mean"</code>).
However, additional variants exist for some of the products. For the weekly
relative abundance, confidence intervals are provided: specify <code>metric = "lower"</code> to get the 10th quantile or <code>metric = "upper"</code> to get the 90th
quantile. For the seasonal and annual products, the cell-wise maximum
values across weeks can be obtained with <code>metric = "max"</code>.</p>
</td></tr>
<tr><td><code id="load_raster_+3A_resolution">resolution</code></td>
<td>
<p>character; the resolution of the raster data to load. The
default is to load the native 3 km resolution data; however, for some
applications 9 km or 27 km data may be suitable.</p>
</td></tr>
<tr><td><code id="load_raster_+3A_path">path</code></td>
<td>
<p>character; directory to download the data to. All downloaded
files will be placed in a sub-directory of this directory named for the
data version year, e.g. &quot;2020&quot; for the 2020 Status Data Products. Each
species' data package will then appear in a directory named with the eBird
species code. Defaults to a persistent data directory, which can be found
by calling <code>ebirdst_data_dir()</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The core eBird Status data products provide weekly estimates across
a regular spatial grid. They are packaged as rasters with 52 layers, each
corresponding to estimates for a week of the year, and we refer to them as
&quot;cubes&quot; (e.g. the &quot;relative abundance cube&quot;). All estimates are the median
expected value for a standard 2 km, 1 hour eBird Traveling Count by an
expert eBird observer at the optimal time of day and for optimal weather
conditions to observe the given species. These products are:
</p>

<ul>
<li> <p><code>occurrence</code>: the expected probability (0-1) of occurrence of a species.
</p>
</li>
<li> <p><code>count</code>: the expected count of a species, conditional on its occurrence at
the given location.
</p>
</li>
<li> <p><code>abundance</code>: the expected relative abundance of a species, computed as the
product of the probability of occurrence and the count conditional on
occurrence.
</p>
</li>
<li> <p><code>proportion-population</code>: the proportion of the total relative abundance
within each cell. This is a derived product calculated by dividing each cell
value in the relative abundance raster by the total abundance summed across
all cells.
</p>
</li></ul>

<p>In addition to these weekly data cubes, this function provides access to data
summarized over different periods. Seasonal cubes are produced by taking the
cell-wise mean or max across the weeks within each season. The boundary dates
for each season are species specific and are available in <code>ebirdst_runs</code>, and
if a season failed review no associated layer will be included in the cube.
In addition, full-year summaries provide the mean or max across all weeks of
the year that fall within a season that passed review. Note that this is not
necessarily all 52 weeks of the year. For example, if the estimates for the
non-breeding season failed expert review for a given species, the full-year
summary for that species will not include the weeks that would fall within
the non-breeding season.
</p>


<h3>Value</h3>

<p>For the weekly cubes, a <a href="terra.html#topic+SpatRaster-class">SpatRaster</a> with 52
layers for the given product, where the layer names are the dates
(<code>YYYY-MM-DD</code> format) of the midpoint of each week. Seasonal cubes will
have up to four layers named with the corresponding season. The full-year
products will have a single layer.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# download example data if hasn't already been downloaded
ebirdst_download("yebsap-example")

# weekly relative abundance
# note that only 27 km data are available for the example data
abd_weekly &lt;- load_raster("yebsap-example", "abundance", resolution = "27km")

# the weeks for each layer are stored in the layer names
names(abd_weekly)
# they can be converted to date objects with as.Date
as.Date(names(abd_weekly))

# max seasonal abundance
abd_seasonal &lt;- load_raster("yebsap-example", "abundance",
                            period = "seasonal", metric = "max",
                            resolution = "27km")
# available seasons in stack
names(abd_seasonal)
# subset to just breeding season abundance
abd_seasonal[["breeding"]]

## End(Not run)
</code></pre>

<hr>
<h2 id='load_regional_stats'>Load regional summary statistics</h2><span id='topic+load_regional_stats'></span>

<h3>Description</h3>

<p>Load seasonal summary statistics for regions consisting of countries and
states/provinces.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>load_regional_stats(species, path = ebirdst_data_dir())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="load_regional_stats_+3A_species">species</code></td>
<td>
<p>character; the species to load data for, given as a scientific
name, common name or six-letter species code (e.g. &quot;woothr&quot;). The full list
of valid species is in the <a href="#topic+ebirdst_runs">ebirdst_runs</a> data frame included in this
package. To download the example dataset, use <code>"yebsap-example"</code>.</p>
</td></tr>
<tr><td><code id="load_regional_stats_+3A_path">path</code></td>
<td>
<p>character; directory to download the data to. All downloaded
files will be placed in a sub-directory of this directory named for the
data version year, e.g. &quot;2020&quot; for the 2020 Status Data Products. Each
species' data package will then appear in a directory named with the eBird
species code. Defaults to a persistent data directory, which can be found
by calling <code>ebirdst_data_dir()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame containing regional summary statistics with columns:
</p>

<ul>
<li> <p><code>species_code</code>: alphanumeric eBird species code.
</p>
</li>
<li> <p><code>region_type</code>: <code>country</code> for countries or <code>state</code> for states, provinces,
or other sub-national regions.
</p>
</li>
<li> <p><code>region_code</code>: alphanumeric code for the region.
</p>
</li>
<li> <p><code>region_name</code>: English name of the region.
</p>
</li>
<li> <p><code>season</code>: name of the season that the summary statistics were calculated
for.
</p>
</li>
<li> <p><code>abundance_mean</code>: mean relative abundance in the region.
</p>
</li>
<li> <p><code>total_pop_percent</code>: proportion of the seasonal modeled population
falling within the region.
</p>
</li>
<li> <p><code>range_percent_occupied</code>: the proportion of the region occupied by the
species during the given season.
</p>
</li>
<li> <p><code>range_total_percent</code>: the proportion of the species seasonal range
falling within the region.
</p>
</li>
<li> <p><code>range_days_occupation</code>: number of days of the season that the region was
occupied by this species.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# download example data if hasn't already been downloaded
ebirdst_download_status("yebsap-example")

# load configuration parameters
regional &lt;- load_regional_stats("yebsap-example")

## End(Not run)
</code></pre>

<hr>
<h2 id='load_trends'>Load eBird Trends estimates for a set of species</h2><span id='topic+load_trends'></span>

<h3>Description</h3>

<p>Load the relative abundance trend estimates for a single species or a set of
species. Trends are estimated on a 27 km by 27 km grid for a single season
per species (breeding, non-breeding, or resident).  Note that data must be
download using <code><a href="#topic+ebirdst_download_trends">ebirdst_download_trends()</a></code> prior to loading it using this
function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>load_trends(species, fold_estimates = FALSE, path = ebirdst_data_dir())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="load_trends_+3A_species">species</code></td>
<td>
<p>character; one or more species given as scientific names,
common names or six-letter species codes (e.g. &quot;woothr&quot;). The full list of
valid species can be viewed in the <a href="#topic+ebirdst_runs">ebirdst_runs</a> data frame included in
this package; species with trends estimates are indicated by the
<code>has_trends</code> column. To access the example dataset, use &quot;yebsap-example&quot;.</p>
</td></tr>
<tr><td><code id="load_trends_+3A_fold_estimates">fold_estimates</code></td>
<td>
<p>logical; by default, the trends summarized across the
100-fold ensemble are returned; however, by setting <code>fold_estimates = TRUE</code>
the individual fold-level estimates are returned.</p>
</td></tr>
<tr><td><code id="load_trends_+3A_path">path</code></td>
<td>
<p>character; directory to download the data to. All downloaded
files will be placed in a sub-directory of this directory named for the
data version year, e.g. &quot;2020&quot; for the 2020 Status Data Products. Each
species' data package will then appear in a directory named with the eBird
species code. Defaults to a persistent data directory, which can be found
by calling <code>ebirdst_data_dir()</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The trends in relative abundance are estimated using a double machine
learning model. To quantify uncertainty, an ensemble of 100 estimates is made
at each location, each based on a random subsample of eBird data. The
estimated trend is the median across the ensemble, and the 80% confidence
intervals are the lower 10th and upper 90th percentiles across the ensemble.
To access estimates from the individual folds making up the ensemble use
<code>fold_estimates = TRUE</code>. These fold-level estimates can be used to quantify
uncertainty, for example, when calculating the trend for a given region. For
further details on the methodology used to estimate trends consult Fink et
al. 2023.
</p>


<h3>Value</h3>

<p>A data frame containing the trends estimates for a set of species.
The following columns are included:
</p>

<ul>
<li> <p><code>species_code</code>: the alphanumeric eBird species code uniquely identifying
the species.
</p>
</li>
<li> <p><code>season</code>:  season that the trend was estimated for: breeding,
nonbreeding, or resident.
</p>
</li>
<li> <p><code>start_year/end_year</code>: the start and end years of the trend time period.
</p>
</li>
<li> <p><code>start_date/end_date</code>: the start and end dates (<code>MM-DD</code> format) of the
season for which the trend was estimated.
</p>
</li>
<li> <p><code>srd_id</code>: unique integer identifier for the grid cell.
</p>
</li>
<li> <p><code>longitude/latitude</code>: longitude and latitude of the grid cell center.
</p>
</li>
<li> <p><code>abd</code>: relative abundance estimate for the middle of the trend time
period (e.g. 2014 for a 2007-2021 trend).
</p>
</li>
<li> <p><code>abd_ppy</code>: the median estimated percent per year change in relative
abundance.
</p>
</li>
<li> <p><code>abd_ppy_lower/abd_ppy_upper</code>: the 80% confidence interval for the
estimated percent per year change in relative abundance.
</p>
</li>
<li> <p><code>abd_ppy_nonzero</code>: a logical (TRUE/FALSE) value indicating if the 80%
confidence limits overlap zero (FALSE) or don't overlap zero (TRUE)
</p>
</li>
<li> <p><code>abd_trend</code>: the median estimated cumulative change in relative
abundance over the trend time period.
</p>
</li>
<li> <p><code>abd_trend_lower/abd_trend_upper</code>: the 80% confidence interval for the
estimated cumulative change in relative abundance over the trend time
period.
</p>
</li></ul>

<p>If <code>fold_estimates = TRUE</code>, a data frame of fold-level trend estimates is
returned with the following columns:
</p>

<ul>
<li> <p><code>species_code</code>: the alphanumeric eBird species code uniquely identifying
the species.
</p>
</li>
<li> <p><code>season</code>:  season that the trend was estimated for: breeding,
nonbreeding, or resident.
</p>
</li>
<li> <p><code>srd_id</code>: unique integer identifier for the grid cell.
</p>
</li>
<li> <p><code>abd</code>: relative abundance estimate for the middle of the trend time
period (e.g. 2014 for a 2007-2021 trend).
</p>
</li>
<li> <p><code>abd_ppy</code>: the estimated percent per year change in relative abundance.
</p>
</li></ul>



<h3>References</h3>

<p>Fink, D., Johnston, A., Strimas-Mackey, M., Auer, T., Hochachka, W. M.,
Ligocki, S., Oldham Jaromczyk, L., Robinson, O., Wood, C., Kelling, S., &amp;
Rodewald, A. D. (2023). A Double machine learning trend model for citizen
science data. Methods in Ecology and Evolution, 00, 114.
https://doi.org/10.1111/2041-210X.14186
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# download example trends data if it hasn't already been downloaded
ebirdst_download_trends("yebsap-example")

# load trends
trends &lt;- load_trends("yebsap-example")

# load fold-level estimates
trends_folds &lt;- load_trends("yebsap-example", fold_estimates = TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='rasterize_trends'>Convert eBird Trends Data Products to raster format</h2><span id='topic+rasterize_trends'></span>

<h3>Description</h3>

<p>The eBird trends data are stored in a tabular format, where each row gives
the trend estimate for a single cell in a 27 km x 27 km equal area grid. For
many applications, an explicitly spatial format is more useful. This function
uses the cell center coordinates to convert the tabular trend estimates to
raster format in <code>terra</code> <a href="terra.html#topic+SpatRaster-class">SpatRaster</a> format.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rasterize_trends(
  trends,
  layers = c("abd_ppy", "abd_ppy_lower", "abd_ppy_upper"),
  trim = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rasterize_trends_+3A_trends">trends</code></td>
<td>
<p>data frame; trends data for a single species as returned by
<code><a href="#topic+load_trends">load_trends()</a></code>.</p>
</td></tr>
<tr><td><code id="rasterize_trends_+3A_layers">layers</code></td>
<td>
<p>character; column names in the trends data frame to rasterize.
These columns will become layers in the raster that is created.</p>
</td></tr>
<tr><td><code id="rasterize_trends_+3A_trim">trim</code></td>
<td>
<p>logical; flag indicating if the returned raster should be trimmed
to remove outer rows and columns that are NA. If <code>trim = FALSE</code> the
returned raster will have a global extent, which can be useful if rasters
will be combined across species with different ranges.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <a href="terra.html#topic+SpatRaster-class">SpatRaster</a> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# download example trends data if it hasn't already been downloaded
ebirdst_download_trends("yebsap-example")

# load trends
trends &lt;- load_trends("yebsap-example")

# rasterize percent per year trend
rasterize_trends(trends, "abd_ppy")

## End(Not run)
</code></pre>

<hr>
<h2 id='set_ebirdst_access_key'>Store the eBird Status and Trends access key</h2><span id='topic+set_ebirdst_access_key'></span>

<h3>Description</h3>

<p>Accessing eBird Status and Trends data requires an access key, which can be
obtained by visiting https://ebird.org/st/request. This key must be stored as
the environment variable <code>EBIRDST_KEY</code> in order for
<code><a href="#topic+ebirdst_download_status">ebirdst_download_status()</a></code> and <code><a href="#topic+ebirdst_download_trends">ebirdst_download_trends()</a></code> to use it. The
easiest approach is to store the key in your <code>.Renviron</code> file so it can
always be accessed in your R sessions. Use this function to set <code>EBIRDST_KEY</code>
in your <code>.Renviron</code> file provided that it is located in the standard location
in your home directory. It is also possible to manually edit the <code>.Renviron</code>
file. <strong>The access key is specific to you and should never be shared or made
publicly accessible.</strong>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>set_ebirdst_access_key(key, overwrite = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="set_ebirdst_access_key_+3A_key">key</code></td>
<td>
<p>character; API key obtained by filling out the form at
https://ebird.org/st/request.</p>
</td></tr>
<tr><td><code id="set_ebirdst_access_key_+3A_overwrite">overwrite</code></td>
<td>
<p>logical; should the existing <code>EBIRDST_KEY</code> be overwritten if
it has already been set in .Renviron.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Edits .Renviron, then returns the path to this file invisibly.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# save the api key, replace XXXXXX with your actual key
set_ebirdst_access_key("XXXXXX")

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
