<!DOCTYPE html><html lang="en"><head><title>Help for package ACEt</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ACEt}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ACEt-package'>
<p>Estimating Age Modification Effect on Genetic and Environmental Variance Components in Twin Models</p></a></li>
<li><a href='#acetp_mcmc'>
<p>Compute CIs for the ACE(t)-p model</p></a></li>
<li><a href='#AtCtEt'>
<p>Fitting the ACE(t) model</p></a></li>
<li><a href='#AtCtEtp'>
<p>Fitting the ACE(t)-p model</p></a></li>
<li><a href='#AtDtEt'>
<p>Fitting the ADE(t) model</p></a></li>
<li><a href='#data_ace'>
<p>Example data for the ACEt models</p></a></li>
<li><a href='#plot_acet'>
<p>Plot variance curves for various ACE(t) or ACE(t)-p models with 95% CIs</p></a></li>
<li><a href='#test_acetp'>
<p>Hypothesis testing of the ACE(t)-p models</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Estimating Dynamic Heritability and Twin Model Comparison</td>
</tr>
<tr>
<td>Version:</td>
<td>1.9.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-05-22</td>
</tr>
<tr>
<td>Author:</td>
<td>Liang He</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Liang He &lt;hyx520101@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Twin models that are able to estimate the dynamic behaviour of the variance components in the classical twin models with respect to age using B-splines and P-splines.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.1)</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 0.11.1), splines, MASS, methods</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>BH, RcppArmadillo, Rcpp</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr (&ge; 1.12.1), rmarkdown (&ge; 0.9.5)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-05-23 09:21:35 UTC; helia</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-05-23 10:42:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='ACEt-package'>
Estimating Age Modification Effect on Genetic and Environmental Variance Components in Twin Models
</h2><span id='topic+ACEt-package'></span><span id='topic+ACEt'></span>

<h3>Description</h3>

<p>The package implements two novel twin models that are able to estimate dynamic behaviour of the variance components in the classical twin models with respect to age or other covariates such as calendar year. 
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> ACEt</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.8.2</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2022-09-23</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Liang He
</p>
<p>Maintainer: Liang He &lt;lianghe@health.sdu.dk&gt;
</p>


<h3>References</h3>

<p>He, L., Sillanpää, M.J., Silventoinen, K., Kaprio, J. and Pitkäniemi, J., 2016. Estimating Modifying Effect of Age on Genetic and Environmental Variance Components in Twin Models. Genetics, 202(4), pp.1313-1328.
</p>
<p>He, L., Pitkäniemi, J., Silventoinen, K. and Sillanpää, M.J., 2017. ACEt: An R package for estimating dynamic heritability and comparing twin models. Behavior Genetics, 47(6), pp.620-641.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# data(data_ace)

# AtCtEt(data_ace$mz, data_ace$dz, mod=c('d','d','c'), knot_a = 5, knot_c = 4)
# AtCtEtp(data_ace$mz, data_ace$dz, knot_a = 6, mod=c('d','l','c'))

</code></pre>

<hr>
<h2 id='acetp_mcmc'>
Compute CIs for the ACE(t)-p model
</h2><span id='topic+acetp_mcmc'></span>

<h3>Description</h3>

<p>Compute the posterior mean and CIs for the ACE(t)-p model using the MCMC methods
</p>


<h3>Usage</h3>

<pre><code class='language-R'>acetp_mcmc(acetp, iter_num = 10000, sd = 0.1, burnin = 1000)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="acetp_mcmc_+3A_acetp">acetp</code></td>
<td>

<p>An object from the 'AtCtEtp' function.
</p>
</td></tr>
<tr><td><code id="acetp_mcmc_+3A_iter_num">iter_num</code></td>
<td>

<p>The number of the iterations in the MCMC procedure.
</p>
</td></tr>
<tr><td><code id="acetp_mcmc_+3A_sd">sd</code></td>
<td>

<p>The standard error of the normal proposal distribution in the MCMC algorithm. The default value is 0.1.
</p>
</td></tr>
<tr><td><code id="acetp_mcmc_+3A_burnin">burnin</code></td>
<td>

<p>The number of burn-in, which must be smaller than the number of iteration.
</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>beta_a_mc</code></td>
<td>
<p>The estimates of the spline coefficients for the A component based on the posterior mean from the MCMC method.</p>
</td></tr>
<tr><td><code>beta_c_mc</code></td>
<td>
<p>The estimates of the spline coefficients for the C component based on the posterior mean from the MCMC method.</p>
</td></tr>
<tr><td><code>beta_e_mc</code></td>
<td>
<p>The estimates of the spline coefficients for the E component based on the posterior mean from the MCMC method.</p>
</td></tr>
<tr><td><code>cov_mc</code></td>
<td>
<p>The posterior covariance matrix of the estimates of the spline coefficients.</p>
</td></tr>
<tr><td><code>knots_a</code></td>
<td>
<p>A vector of the knot positions for the A component.</p>
</td></tr>
<tr><td><code>knots_c</code></td>
<td>
<p>A vector of the knot positions for the C component.</p>
</td></tr>
<tr><td><code>knots_e</code></td>
<td>
<p>A vector of the knot positions for the E component.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Liang He
</p>


<h3>References</h3>

<p>He, L., Sillanpää, M.J., Silventoinen, K., Kaprio, J. and Pitkäniemi, J., 2016. Estimating Modifying Effect of Age on Genetic and Environmental Variance Components in Twin Models. Genetics, 202(4), pp.1313-1328.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# data(data_ace)

# result &lt;- AtCtEp(data_ace$mz, data_ace$dz, knot_a = 7, knot_c = 7)
# result_mc &lt;- acetp_mcmc(result, iter_num=10000, burnin = 500)

</code></pre>

<hr>
<h2 id='AtCtEt'>
Fitting the ACE(t) model  
</h2><span id='topic+AtCtEt'></span>

<h3>Description</h3>

<p>The ACE(t) model with the A, C and E variance components as functions with respect to age modelled by B-splines.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AtCtEt(data_m, data_d, mod = c('d','d','d'), knot_a = 5, knot_c = 5, knot_e = 5, 
loc = c('e','e','e'), boot=FALSE, num_b = 100, init = rep(0,3), robust = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AtCtEt_+3A_data_m">data_m</code></td>
<td>

<p>An <code class="reqn">N_m</code> x 3 data matrix for MZ twins. <code class="reqn">N_m</code> is the number of MZ twin pairs. The first two columns are centered trait values (i.e. the mean should be zero) and the third column is age (or other covariates). 
</p>
</td></tr>
<tr><td><code id="AtCtEt_+3A_data_d">data_d</code></td>
<td>

<p>An <code class="reqn">N_d</code> x 3 data matrix for DZ twins. <code class="reqn">N_d</code> is the number of DZ twin pairs. The first two columns are centered trait values (i.e. the mean should be zero) and the third column is age (or other covariates). 
</p>
</td></tr>
<tr><td><code id="AtCtEt_+3A_mod">mod</code></td>
<td>

<p>A character vector of length 3. Each element specifies the function for the A, C or E component respectively. The A and C components can be 'd'(dynamic), 'c'(constant) or 'n'(NA). The E component can only be 'd' or 'c'. Thus, <code class="reqn">model=c('c','c','c')</code> is corresponding to the classical ACE model.
</p>
</td></tr>
<tr><td><code id="AtCtEt_+3A_knot_a">knot_a</code></td>
<td>

<p>The number of interior knots of the B-spline for the A component, which must be no less than 3. The default value is 5. 
</p>
</td></tr>
<tr><td><code id="AtCtEt_+3A_knot_c">knot_c</code></td>
<td>

<p>The number of interior knots of the B-spline for the C component, which must be no less than 3. The default value is 5.
</p>
</td></tr>
<tr><td><code id="AtCtEt_+3A_knot_e">knot_e</code></td>
<td>

<p>The number of interior knots of the B-spline for the E component, which must be no less than 3. The default value is 5.
</p>
</td></tr>
<tr><td><code id="AtCtEt_+3A_loc">loc</code></td>
<td>

<p>A 1x3 character vector indicating how to place knots for each component: evenly (&quot;e&quot;) or quantile-based (&quot;q&quot;). The default value is &quot;e&quot;.
</p>
</td></tr>
<tr><td><code id="AtCtEt_+3A_boot">boot</code></td>
<td>

<p>A logical indicator of whether to use the bootstrap method to calculate the confidence interval. The default is FALSE. 
</p>
</td></tr>
<tr><td><code id="AtCtEt_+3A_num_b">num_b</code></td>
<td>

<p>The number of replicates when the bootstrap method is used (i.e. <code class="reqn">boot=TRUE</code>). The default value is 100.
</p>
</td></tr>
<tr><td><code id="AtCtEt_+3A_init">init</code></td>
<td>

<p>A 3x1 vector of the initial values for the optimization. The default values are 1.
</p>
</td></tr>
<tr><td><code id="AtCtEt_+3A_robust">robust</code></td>
<td>

<p>An integer indicating the number of different initial values that the function will randomly generate and try in the optimization. The default value is 0.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the variance is close to the boundary (0), it is better to use the bootstrap method to get the CIs.  
The optimization algorithm may sometimes end up with a local minimum. It is recommended to try different random initial values by setting 'robust'.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>n_beta_a</code></td>
<td>
<p>The number of spline coefficients for the A component.</p>
</td></tr>
<tr><td><code>n_beta_c</code></td>
<td>
<p>The number of spline coefficients for the C component.</p>
</td></tr>
<tr><td><code>n_beta_e</code></td>
<td>
<p>The number of spline coefficients for the E component.</p>
</td></tr>
<tr><td><code>beta_a</code></td>
<td>
<p>The estimated spline coefficients (if the model parameter is 'd') or variance (if the model parameter is 'c') of the A component.</p>
</td></tr>
<tr><td><code>beta_c</code></td>
<td>
<p>The estimated spline coefficients (if the model parameter is 'd') or variance (if the model parameter is 'c') of the C component.</p>
</td></tr>
<tr><td><code>beta_e</code></td>
<td>
<p>The estimated spline coefficients (if the model parameter is 'd') or variance (if the model parameter is 'c') of the E component.</p>
</td></tr>
<tr><td><code>hessian_ap</code></td>
<td>
<p>The approximate numerical observed information matrix from the quasi-Newton algorithm.</p>
</td></tr>
<tr><td><code>hessian</code></td>
<td>
<p>The expected information matrix calculated analytically.</p>
</td></tr>
<tr><td><code>con</code></td>
<td>
<p>An indicator of convergence of the optimization algorithm. An integer code 0 indicates successful completion. See 'optim' for more details.</p>
</td></tr>
<tr><td><code>lik</code></td>
<td>
<p>The minus log-likelihood.</p>
</td></tr>
<tr><td><code>knots_a</code></td>
<td>
<p>A vector of the knot positions for the A component.</p>
</td></tr>
<tr><td><code>knots_c</code></td>
<td>
<p>A vector of the knot positions for the C component.</p>
</td></tr>
<tr><td><code>knots_e</code></td>
<td>
<p>A vector of the knot positions for the E component.</p>
</td></tr>
<tr><td><code>boot</code></td>
<td>
<p>A list containing pointwise CIs estimated from the bootstrap method when <code class="reqn">boot=TRUE</code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Liang He
</p>


<h3>References</h3>

<p>He, L., Sillanpää, M.J., Silventoinen, K., Kaprio, J. and Pitkäniemi, J., 2016. Estimating Modifying Effect of Age on Genetic and Environmental Variance Components in Twin Models. Genetics, 202(4), pp.1313-1328.
</p>
<p>He, L., Pitkäniemi, J., Silventoinen, K. and Sillanpää, M.J., 2017. ACEt: An R package for estimating dynamic heritability and comparing twin models. Behavior Genetics, 47(6), pp.620-641.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(data_ace)

result &lt;- AtCtEt(data_ace$mz, data_ace$dz, mod=c('d','d','c'))

</code></pre>

<hr>
<h2 id='AtCtEtp'>
Fitting the ACE(t)-p model 
</h2><span id='topic+AtCtEtp'></span>

<h3>Description</h3>

<p>The ACE(t)-p model with the A, C and E variance components as functions with respect to age modelled by P-splines.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AtCtEtp(data_m, data_d, knot_a = 8, knot_c = 8, knot_e = 8, eps = 0.1, 
mod=c('d','d','d'), robust = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AtCtEtp_+3A_data_m">data_m</code></td>
<td>

<p>An <code class="reqn">N_m</code> x 3 data matrix for MZ twins. <code class="reqn">N_m</code> is the number of MZ twin pairs. The first two columns are centered trait values (i.e. the mean should be zero) and the third column is age (or other covariates). 
</p>
</td></tr>
<tr><td><code id="AtCtEtp_+3A_data_d">data_d</code></td>
<td>

<p>An <code class="reqn">N_d</code> x 3 data matrix for DZ twins. <code class="reqn">N_d</code> is the number of DZ twin pairs. The first two columns are centered trait values (i.e. the mean should be zero) and the third column is age (or other covariates). 
</p>
</td></tr>
<tr><td><code id="AtCtEtp_+3A_knot_a">knot_a</code></td>
<td>

<p>The number of interior knots of the B-spline for the A component. The default value is 8.
</p>
</td></tr>
<tr><td><code id="AtCtEtp_+3A_knot_c">knot_c</code></td>
<td>

<p>The number of interior knots of the B-spline for the C component. The default value is 8.
</p>
</td></tr>
<tr><td><code id="AtCtEtp_+3A_knot_e">knot_e</code></td>
<td>

<p>The number of interior knots of the B-spline for the E component. The default value is 8.
</p>
</td></tr>
<tr><td><code id="AtCtEtp_+3A_eps">eps</code></td>
<td>

<p>Tolerance for convergence of the EM algorithm iterations. The default value is 0.1.
</p>
</td></tr>
<tr><td><code id="AtCtEtp_+3A_mod">mod</code></td>
<td>

<p>A character vector of length 3. Each element specifies the function for the A, C or E component respectively. The components can be 'd'(dynamic), 'c'(constant) or 'l'(linear). The default is c('d','d','d').
</p>
</td></tr>
<tr><td><code id="AtCtEtp_+3A_robust">robust</code></td>
<td>

<p>An integer indicating the number of different initial values that the function will randomly generate and try in the optimization. The default value is 0.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When the 'mod' argument for a component is 'd'(dynamic), the corresponding 'beta' is the spline coefficients.   
When the 'mod' argument for a component is 'l'(linear), the corresponding 'beta' is a vector of two values, the exponential of which (exp(beta)) are the variances at the minimum and maximum age (or other covariates) provided in the data.     
When the 'mod' argument for a component is 'c'(constant), the corresponding 'beta' has only one value and exp(beta) is the variance.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>var_b_a</code></td>
<td>
<p>The estimated variance for the penalized coefficient for the A components.</p>
</td></tr>
<tr><td><code>var_b_c</code></td>
<td>
<p>The estimated variance for the penalized coefficient for the C components.</p>
</td></tr>
<tr><td><code>var_b_e</code></td>
<td>
<p>The estimated variance for the penalized coefficient for the E components.</p>
</td></tr>
<tr><td><code>beta_a</code></td>
<td>
<p>The estimated spline coefficients of the A component. See 'details' for more information.</p>
</td></tr>
<tr><td><code>beta_c</code></td>
<td>
<p>The estimated spline coefficients of the C component. See 'details' for more information.</p>
</td></tr>
<tr><td><code>beta_e</code></td>
<td>
<p>The estimated spline coefficients of the E component. See 'details' for more information.</p>
</td></tr>
<tr><td><code>con</code></td>
<td>
<p>An indicator of convergence of the optimization algorithm. An integer code 0 indicates successful completion. See 'optim' for more details.</p>
</td></tr>
<tr><td><code>lik</code></td>
<td>
<p>The minus log marginal likelihood.</p>
</td></tr>
<tr><td><code>knot_a</code></td>
<td>
<p>A vector of the knot positions for the A component.</p>
</td></tr>
<tr><td><code>knot_c</code></td>
<td>
<p>A vector of the knot positions for the C component.</p>
</td></tr>
<tr><td><code>knot_e</code></td>
<td>
<p>A vector of the knot positions for the E component.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Liang He
</p>


<h3>References</h3>

<p>He, L., Sillanpää, M.J., Silventoinen, K., Kaprio, J. and Pitkäniemi, J., 2016. Estimating Modifying Effect of Age on Genetic and Environmental Variance Components in Twin Models. Genetics, 202(4), pp.1313-1328.
</p>
<p>He, L., Pitkäniemi, J., Silventoinen, K. and Sillanpää, M.J., 2017. ACEt: An R package for estimating dynamic heritability and comparing twin models. Behavior Genetics, 47(6), pp.620-641.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># data(data_ace)

# result &lt;- AtCtEtp(data_ace$mz, data_ace$dz, knot_e = 7, knot_c = 5, mod=c('d','d','d'))
</code></pre>

<hr>
<h2 id='AtDtEt'>
Fitting the ADE(t) model  
</h2><span id='topic+AtDtEt'></span>

<h3>Description</h3>

<p>The ADE(t) model with the A, D and E variance components as functions with respect to age modelled by B-splines.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AtDtEt(data_m, data_d, mod = c('d','d','d'), knot_a = 5, knot_d = 5, knot_e = 5, 
loc = c('e','e','e'), boot=FALSE, num_b = 100, init = rep(0,3), robust = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AtDtEt_+3A_data_m">data_m</code></td>
<td>

<p>An <code class="reqn">N_m</code> x 3 data matrix for MZ twins. <code class="reqn">N_m</code> is the number of MZ twin pairs. The first two columns are centered trait values (i.e. the mean should be zero) and the third column is age (or other covariates). 
</p>
</td></tr>
<tr><td><code id="AtDtEt_+3A_data_d">data_d</code></td>
<td>

<p>An <code class="reqn">N_d</code> x 3 data matrix for DZ twins. <code class="reqn">N_d</code> is the number of DZ twin pairs. The first two columns are centered trait values (i.e. the mean should be zero) and the third column is age (or other covariates). 
</p>
</td></tr>
<tr><td><code id="AtDtEt_+3A_mod">mod</code></td>
<td>

<p>A character vector of length 3. Each element specifies the function for the A, D or E component respectively. The A and D components can be 'd'(dynamic), 'c'(constant) or 'n'(NA). The E component can only be 'd' or 'c'. Thus, <code class="reqn">model=c('c','c','c')</code> is corresponding to the classical ADE model.
</p>
</td></tr>
<tr><td><code id="AtDtEt_+3A_knot_a">knot_a</code></td>
<td>

<p>The number of interior knots of the B-spline for the A component, which must be no less than 3. The default value is 5. 
</p>
</td></tr>
<tr><td><code id="AtDtEt_+3A_knot_d">knot_d</code></td>
<td>

<p>The number of interior knots of the B-spline for the D component, which must be no less than 3. The default value is 5.
</p>
</td></tr>
<tr><td><code id="AtDtEt_+3A_knot_e">knot_e</code></td>
<td>

<p>The number of interior knots of the B-spline for the E component, which must be no less than 3. The default value is 5.
</p>
</td></tr>
<tr><td><code id="AtDtEt_+3A_loc">loc</code></td>
<td>

<p>A 1x3 character vector indicating how to place knots for each component: evenly (&quot;e&quot;) or quantile-based (&quot;q&quot;). The default value is &quot;e&quot;.
</p>
</td></tr>
<tr><td><code id="AtDtEt_+3A_boot">boot</code></td>
<td>

<p>A logical indicator of whether to use the bootstrap method to calculate the confidence interval. The default is FALSE. 
</p>
</td></tr>
<tr><td><code id="AtDtEt_+3A_num_b">num_b</code></td>
<td>

<p>The number of replicates when the bootstrap method is used (i.e. <code class="reqn">boot=TRUE</code>). The default value is 100.
</p>
</td></tr>
<tr><td><code id="AtDtEt_+3A_init">init</code></td>
<td>

<p>A 3x1 vector of the initial values for the optimization. The default values are 1.
</p>
</td></tr>
<tr><td><code id="AtDtEt_+3A_robust">robust</code></td>
<td>

<p>An integer indicating the number of different initial values that the function will randomly generate and try in the optimization. The default value is 0.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the variance is close to the boundary (0), it is better to use the bootstrap method to get the CIs.  
The optimization algorithm may sometimes end up with a local minimum. It is recommended to try different random initial values by setting 'robust'.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>n_beta_a</code></td>
<td>
<p>The number of spline coefficients for the A component.</p>
</td></tr>
<tr><td><code>n_beta_d</code></td>
<td>
<p>The number of spline coefficients for the D component.</p>
</td></tr>
<tr><td><code>n_beta_e</code></td>
<td>
<p>The number of spline coefficients for the E component.</p>
</td></tr>
<tr><td><code>beta_a</code></td>
<td>
<p>The estimated spline coefficients (if the model parameter is 'd') or variance (if the model parameter is 'c') of the A component.</p>
</td></tr>
<tr><td><code>beta_d</code></td>
<td>
<p>The estimated spline coefficients (if the model parameter is 'd') or variance (if the model parameter is 'c') of the D component.</p>
</td></tr>
<tr><td><code>beta_e</code></td>
<td>
<p>The estimated spline coefficients (if the model parameter is 'd') or variance (if the model parameter is 'c') of the E component.</p>
</td></tr>
<tr><td><code>hessian_ap</code></td>
<td>
<p>The approximate numerical observed information matrix from the quasi-Newton algorithm.</p>
</td></tr>
<tr><td><code>hessian</code></td>
<td>
<p>The expected information matrix calculated analytically.</p>
</td></tr>
<tr><td><code>con</code></td>
<td>
<p>An indicator of convergence of the optimization algorithm. An integer code 0 indicates successful completion. See 'optim' for more details.</p>
</td></tr>
<tr><td><code>lik</code></td>
<td>
<p>The minus log-likelihood.</p>
</td></tr>
<tr><td><code>knots_a</code></td>
<td>
<p>A vector of the knot positions for the A component.</p>
</td></tr>
<tr><td><code>knots_d</code></td>
<td>
<p>A vector of the knot positions for the D component.</p>
</td></tr>
<tr><td><code>knots_e</code></td>
<td>
<p>A vector of the knot positions for the E component.</p>
</td></tr>
<tr><td><code>boot</code></td>
<td>
<p>A list containing pointwise CIs estimated from the bootstrap method when <code class="reqn">boot=TRUE</code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Liang He
</p>


<h3>References</h3>

<p>He, L., Sillanpää, M.J., Silventoinen, K., Kaprio, J. and Pitkäniemi, J., 2016. Estimating Modifying Effect of Age on Genetic and Environmental Variance Components in Twin Models. Genetics, 202(4), pp.1313-1328.
</p>
<p>He, L., Pitkäniemi, J., Silventoinen, K. and Sillanpää, M.J., 2017. ACEt: An R package for estimating dynamic heritability and comparing twin models. Behavior Genetics, 47(6), pp.620-641.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(data_ace)

result &lt;- AtDtEt(data_ace$mz, data_ace$dz, mod=c('d','d','c'))

</code></pre>

<hr>
<h2 id='data_ace'>
Example data for the ACEt models
</h2><span id='topic+data_ace'></span>

<h3>Description</h3>

<p>This is an example dataset consisting of traits and ages for MZ and DZ twins.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(data_ace)</code></pre>


<h3>Format</h3>

<p>The format is:
mz: a matrix of simulated data for MZ twins.
dz: a matrix of simulated data for DZ twins.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(data_ace)
</code></pre>

<hr>
<h2 id='plot_acet'>
Plot variance curves for various ACE(t) or ACE(t)-p models with 95% CIs 
</h2><span id='topic+plot_acet'></span>

<h3>Description</h3>

<p>Plot variance curves or a heritability curve (with 95% CIs) of the A, C and E components with respect to age modelled by B-splines or P-splines.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_acet(acet, boot = FALSE, heri = FALSE, xlab, ylab, main, col, legend = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_acet_+3A_acet">acet</code></td>
<td>

<p>An object obtained from the B-splines or P-splines functions. For the P-splines functions, an object from the MCMC method must be used.
</p>
</td></tr>
<tr><td><code id="plot_acet_+3A_boot">boot</code></td>
<td>

<p>An logical  indicator of whether the confidence bands estimated from the bootstrap method are plotted. The default is FALSE. Only available for the AtCtEt model.
</p>
</td></tr>
<tr><td><code id="plot_acet_+3A_heri">heri</code></td>
<td>

<p>A logical indicator of whether to plot the dynamic heritability curve. The default is FALSE.
</p>
</td></tr>
<tr><td><code id="plot_acet_+3A_xlab">xlab</code></td>
<td>

<p>The 'xlab' argument in the plot funciton. The default is 'Age'.
</p>
</td></tr>
<tr><td><code id="plot_acet_+3A_ylab">ylab</code></td>
<td>

<p>The 'ylab' argument in the plot funciton. The default is 'Variance'.
</p>
</td></tr>
<tr><td><code id="plot_acet_+3A_main">main</code></td>
<td>

<p>The 'main' argument in the plot funciton. The default is 'Variance curves of the A, C, and E components' for variances and 'Dynamic heritability' for heritability.
</p>
</td></tr>
<tr><td><code id="plot_acet_+3A_col">col</code></td>
<td>

<p>The 'col' argument in the plot funciton.
</p>
</td></tr>
<tr><td><code id="plot_acet_+3A_legend">legend</code></td>
<td>

<p>An logical indicator of whether the default legend is plotted.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Liang He
</p>


<h3>References</h3>

<p>He, L., Sillanpää, M.J., Silventoinen, K., Kaprio, J. and Pitkäniemi, J., 2016. Estimating Modifying Effect of Age on Genetic and Environmental Variance Components in Twin Models. Genetics, 202(4), pp.1313-1328.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# data(data_ace)
# result &lt;- AtCtEtp(data_ace$mz, data_ace$dz, knot_a = 5, knot_c = 4)
# result_mc &lt;- acetp_mcmc(result, iter_num=10000, burnin = 500)
# plot_acet(result_mc)

# result &lt;- AtCtEt(data_ace$mz, data_ace$dz, mod=c('d','c','c'), knot_a = 9)
# plot_acet(result)
</code></pre>

<hr>
<h2 id='test_acetp'>
Hypothesis testing of the ACE(t)-p models 
</h2><span id='topic+test_acetp'></span>

<h3>Description</h3>

<p>Comparison of different ACE(t)-p models to test a linear or a constant variance component.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>test_acetp(acetp, comp, sim = 100, robust = 0, pe = TRUE, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="test_acetp_+3A_acetp">acetp</code></td>
<td>

<p>An object from the AtCtEtp function. 
</p>
</td></tr>
<tr><td><code id="test_acetp_+3A_comp">comp</code></td>
<td>

<p>The component for which linearity or constancy is tested. This component must be specified as splines or linear in the AtCtEtp function. 
</p>
</td></tr>
<tr><td><code id="test_acetp_+3A_sim">sim</code></td>
<td>

<p>The number of the bootstrap resampling for approximating the null distribution when testing linearity.
</p>
</td></tr>
<tr><td><code id="test_acetp_+3A_robust">robust</code></td>
<td>

<p>An integer indicating the number of different initial values that the function will randomly generate and try in the optimization. The default value is 0.
</p>
</td></tr>
<tr><td><code id="test_acetp_+3A_pe">pe</code></td>
<td>

<p>A logical argument indicating whether to use penalized spline model to test linearity. The default value is TRUE.
</p>
</td></tr>
<tr><td><code id="test_acetp_+3A_verbose">verbose</code></td>
<td>

<p>A logical argument indicating whether to print testing information and results. The default value is TRUE.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When pe=TRUE, the linearity is tested under a p-spline framework in which an LRT is performed. Otherwise, a <code class="reqn">\chi^2</code> test is performed for linearity under a spline framework without penalty on smoothness.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>p</code></td>
<td>
<p>The p-value for the test.</p>
</td></tr>
<tr><td><code>llr</code></td>
<td>
<p>The LRT statistic for testing linearity.</p>
</td></tr>
<tr><td><code>llr_sim</code></td>
<td>
<p>The simulated null distribution of the LRT statistic for testing linearity.</p>
</td></tr>
<tr><td><code>chisq</code></td>
<td>
<p>The chisq statistic for testing a constant or linearity.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Liang He
</p>


<h3>References</h3>

<p>He, L., Sillanpää, M.J., Silventoinen, K., Kaprio, J. and Pitkäniemi, J., 2016. Estimating Modifying Effect of Age on Genetic and Environmental Variance Components in Twin Models. Genetics, 202(4), pp.1313-1328.
</p>
<p>He, L., Pitkäniemi, J., Silventoinen, K. and Sillanpää, M.J., 2017. ACEt: An R package for estimating dynamic heritability and comparing twin models. Behavior Genetics, 47(6), pp.620-641.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># data(data_ace)

# result &lt;- AtCtEtp(data_ace$mz, data_ace$dz, knot_e = 7, knot_c = 5, mod=c('d','d','l'))
# re &lt;- test_acetp(result, comp='e')
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
