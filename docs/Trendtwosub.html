<!DOCTYPE html><html><head><title>Help for package Trendtwosub</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {Trendtwosub}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#chi.stat'><p>chi.stat function</p></a></li>
<li><a href='#freq.less'><p>List of functions</p>
freq.less function</a></li>
<li><a href='#gen.decision'><p>gen.decision function</p>
This function compares frequency comparison counts of subsamples from two independent samples, and calculates a simulated p-value with a novel bootstrap method proposed in the reference paper.</a></li>
<li><a href='#multi.freq'><p>multi.freq function</p></a></li>
<li><a href='#pow.ana.gen.decision'><p>pow.ana.gen.decision function</p></a></li>
<li><a href='#seedwt.multi.subsample'><p>seedwt.multi.subsample dataset</p></a></li>
<li><a href='#simu.ustat.pattern'><p>simu.ustat.pattern function</p></a></li>
<li><a href='#sub.test'><p>sub.test function</p>
This function calculates the simulated p-value of comparing the trend in subsamples from two independent samples.</a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Two Sample Order Free Trend Nonparametric Inference</td>
</tr>
<tr>
<td>Version:</td>
<td>0.0.2</td>
</tr>
<tr>
<td>Description:</td>
<td>Non-parametric trend comparison of two independent samples with sequential subsamples. For more details, please refer to Wang, Stapleton, and Chen (2018) &lt;<a href="https://doi.org/10.1080%2F00949655.2018.1482492">doi:10.1080/00949655.2018.1482492</a>&gt;. </td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Imports:</td>
<td>magrittr,stats,usethis</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-02-03 14:37:34 UTC; yishiwang</td>
</tr>
<tr>
<td>Author:</td>
<td>Yishi Wang Developer [aut, cre],
  Matthew Villanueva Developer [aut],
  Ann Stapleton Developer [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Yishi Wang Developer &lt;wangy@uncw.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-02-08 18:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='chi.stat'>chi.stat function</h2><span id='topic+chi.stat'></span>

<h3>Description</h3>

<p>This function calculates the $M$ statistics value as defined in the reference paper.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chi.stat(ftab)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="chi.stat_+3A_ftab">ftab</code></td>
<td>
<p>it is a matrix with dimension 2 by <code class="reqn">K</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code class="reqn">M</code> statistics is defined as: </p>
<p style="text-align: center;"><code class="reqn">M=\sum_{l=1}^{K}\left(\frac{(O_{x,l}-E_{x,l})^2}{E_{x,l}}+\frac{(O_{x,l}-E_{x,l})^2}{\left(n_ln_{l+1}-E_{x,l}\right)}\right)+\sum_{l=1}^{K}\left(\frac{(O_{y,l}-E_{y,l})^2}{E_{y,l}}+\frac{(O_{y,l}-E_{y,l})^2}{\left(m_lm_{l+1}-E_{y,l}\right)}\right).</code>
</p>



<h3>Value</h3>

<p>chi.val, a chisuqre type of statistics value
</p>


<h3>References</h3>

<p>Wang, Y., Stapleton, A. E., &amp; Chen, C. (2018). Two-sample nonparametric stochastic order inference with an application in plant physiology. Journal of Statistical Computation and Simulation, 88(14), 2668-2683.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>chi.stat(ftab=rbind(c(20,10,20),c(15,15,20)))
</code></pre>

<hr>
<h2 id='freq.less'>List of functions
freq.less function</h2><span id='topic+freq.less'></span>

<h3>Description</h3>

<p>This function finds the sum of counts that the x-sample observations is greater than or less than the ones from the y-sample.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>freq.less(x, y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="freq.less_+3A_x">x</code>, <code id="freq.less_+3A_y">y</code></td>
<td>
<p>x and y are numerical vectors of different subsamples. The length of the two vectors can vary.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When there is a tie between any pair of observations, 0.5 is added to the count. Missing value is allowed. Missing value is only added to the calculation when it is compared with another missing value from the other subsample.
</p>


<h3>Value</h3>

<p>Two values are returned: less.count and more.count. The first one is the total count that the observations in x-sample is less than the ones from the y-sample, and the second output is the total count that the observations in x-sample is more than the ones from the y-sample. When there is a tie, 0.5 is added to the count, instead of 1 or 0.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>freq.less(x=c(1,2,4,9,0,0,NA),y=c(1,4,9,NA))
</code></pre>

<hr>
<h2 id='gen.decision'>gen.decision function
This function compares frequency comparison counts of subsamples from two independent samples, and calculates a simulated p-value with a novel bootstrap method proposed in the reference paper.</h2><span id='topic+gen.decision'></span>

<h3>Description</h3>

<p>gen.decision function
This function compares frequency comparison counts of subsamples from two independent samples, and calculates a simulated p-value with a novel bootstrap method proposed in the reference paper.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gen.decision(est.prob, effn.subsam1, effn.subsam2, fn.rep = 10^3,
  alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gen.decision_+3A_est.prob">est.prob</code></td>
<td>
<p>a matrix of two rows, with each row represents the the sequential comparison results of subsamples from a sample.</p>
</td></tr>
<tr><td><code id="gen.decision_+3A_effn.subsam1">effn.subsam1</code></td>
<td>
<p>the subsample sizes from sample 1.</p>
</td></tr>
<tr><td><code id="gen.decision_+3A_effn.subsam2">effn.subsam2</code></td>
<td>
<p>the subsample sizes from sample 2.</p>
</td></tr>
<tr><td><code id="gen.decision_+3A_fn.rep">fn.rep</code></td>
<td>
<p>the total number of replications.</p>
</td></tr>
<tr><td><code id="gen.decision_+3A_alpha">alpha</code></td>
<td>
<p>the size of type I error.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The dimensions of est.prob, effn.subsam1 and effn.subsam2 need to match. For example, the first two entries of the first two rows from est.prob are pf comparison results from subsample1 and subsample2 of sample1. Thus the sum of the two entries is the product of the two subsample sizes.
</p>


<h3>Value</h3>

<p>critical.value the critical value of the test based on the alpha level provided
</p>
<p>chi-stat the chisqure type test statistics value from the sample provided.
</p>
<p>pvalue the simulated p-value.
</p>


<h3>References</h3>

<p>Wang, Y., Stapleton, A. E., &amp; Chen, C. (2018). Two-sample nonparametric stochastic order inference with an application in plant physiology. Journal of Statistical Computation and Simulation, 88(14), 2668-2683.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>freq.mat&lt;-rbind(c(20,5,10,15,20,5),c(15,10,15,10,20,5));
n.sam1&lt;-rep(5,4);n.sam2&lt;-rep(5,4); n.rep=1000;
gen.decision(freq.mat,n.sam1,n.sam2,n.rep);
### This command will replicate the first p-value in Table 4 of the reference paper.
freq.mat&lt;-rbind(c(40,10,20,30,40,10),c(30,20,30,20,40,10));
n.sam1&lt;-c(5,10,5,10);n.sam2&lt;-c(10,5,10,5); n.rep=1000;
gen.decision(freq.mat,n.sam1,n.sam2,n.rep)
### This command will replicate the second p-value in Table 4 of the reference paper.
</code></pre>

<hr>
<h2 id='multi.freq'>multi.freq function</h2><span id='topic+multi.freq'></span>

<h3>Description</h3>

<p>This function find trend in a sample by comparing neighboring subsamples. The subsamples are stored in a list in R.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multi.freq(fsam)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="multi.freq_+3A_fsam">fsam</code></td>
<td>
<p>a list in R. The order of the vectors in the list follows the order of the subsamples.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The first vector of data in the list will be compared with the second vector in the list by using function freq.less. Then the second vector will be compared with the 3rd vector if there is one. The statistics collected are based on computing: </p>
<p style="text-align: center;"><code class="reqn">\frac{1}{n_ln_{l+1}}\sum_{i=1}^{n_l}\sum_{j=1}^{n_{l+1}}1(x_{li}&lt;x_{(l+1)j})</code>
</p>



<h3>Value</h3>

<p>count.vec it is a collection of a sequence less.count, more.count based on freq.less function.
</p>


<h3>References</h3>

<p>Wang, Y., Stapleton, A. E., &amp; Chen, C. (2018). Two-sample nonparametric stochastic order inference with an application in plant physiology. Journal of Statistical Computation and Simulation, 88(14), 2668-2683.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x1=c(1,2,4,9,0,0,NA);x2=c(1,4,9,NA);x3=c(2,5,10);
sam=list(x1,x2,x3); #
multi.freq(sam);
</code></pre>

<hr>
<h2 id='pow.ana.gen.decision'>pow.ana.gen.decision function</h2><span id='topic+pow.ana.gen.decision'></span>

<h3>Description</h3>

<p>This function evaluates the type I error of the proposed test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pow.ana.gen.decision(mean.prob1, mean.prob2, effn.subsam1, effn.subsam2,
  N.rep = 10^1, boot.rep = 10^1, rseed = 1234, alpha.level = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pow.ana.gen.decision_+3A_mean.prob1">mean.prob1</code></td>
<td>
<p>the probability that observations of a subsample is less than the ones from another subsample, in sample #1.</p>
</td></tr>
<tr><td><code id="pow.ana.gen.decision_+3A_mean.prob2">mean.prob2</code></td>
<td>
<p>the probability that observations of a subsample is less than the ones from another subsample, in sample #2.</p>
</td></tr>
<tr><td><code id="pow.ana.gen.decision_+3A_effn.subsam1">effn.subsam1</code></td>
<td>
<p>the subsample sizes from sample 1.</p>
</td></tr>
<tr><td><code id="pow.ana.gen.decision_+3A_effn.subsam2">effn.subsam2</code></td>
<td>
<p>the subsample sizes from sample 2.</p>
</td></tr>
<tr><td><code id="pow.ana.gen.decision_+3A_n.rep">N.rep</code></td>
<td>
<p>the total number of bootstrap repetitions needed for calculating type I errors.</p>
</td></tr>
<tr><td><code id="pow.ana.gen.decision_+3A_boot.rep">boot.rep</code></td>
<td>
<p>the number of repetitions needed to calculated simulated p-value,</p>
</td></tr>
<tr><td><code id="pow.ana.gen.decision_+3A_rseed">rseed</code></td>
<td>
<p>a random seed.</p>
</td></tr>
<tr><td><code id="pow.ana.gen.decision_+3A_alpha.level">alpha.level</code></td>
<td>
<p>the type I error level that will be assessed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the simulated type I error.
</p>


<h3>References</h3>

<p>Wang, Y., Stapleton, A. E., &amp; Chen, C. (2018). Two-sample nonparametric stochastic order inference with an application in plant physiology. Journal of Statistical Computation and Simulation, 88(14), 2668-2683.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>prob.vec&lt;-c(.4,.2,.3,.6);
sub.sizes1&lt;-c(2,4,3,5,3);sub.sizes2&lt;-c(6,3,2,4,2)
pow.ana.gen.decision(prob.vec,prob.vec,sub.sizes1, sub.sizes1)
pow.ana.gen.decision(prob.vec,prob.vec,sub.sizes1, sub.sizes1,alpha.level=0.1)
</code></pre>

<hr>
<h2 id='seedwt.multi.subsample'>seedwt.multi.subsample dataset</h2><span id='topic+seedwt.multi.subsample'></span>

<h3>Description</h3>

<p>seedwt.multi.subsample dataset
</p>


<h3>Usage</h3>

<pre><code class='language-R'>seedwt.multi.subsample
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 2916 rows and 10 columns.</p>


<h3>Details</h3>

<p>multiple maize inbreds were exposed to all combinations of the following stressors: drought, nitrogen, and density stress. Plants were grown in an experimental plot divided into eight sections, and each of the sections received a combination of between zero and three of the stresses previously mentioned, so that all possible stress combinations were included. More details about the experiment can be found in the references
</p>


<h3>References</h3>

<p>Wang, Y., Stapleton, A. E., &amp; Chen, C. (2018). Two-sample nonparametric stochastic order inference with an application in plant physiology. Journal of Statistical Computation and Simulation, 88(14), 2668-2683.
</p>
<p>Stutts, L., Wang, Y., &amp; Stapleton, A. E. (2018). Plant growth regulators ameliorate or exacerbate abiotic, biotic and combined stress interaction effects on Zea mays kernel weight with inbred-specific patterns. Environmental and experimental botany, 147, 179-188.
</p>

<hr>
<h2 id='simu.ustat.pattern'>simu.ustat.pattern function</h2><span id='topic+simu.ustat.pattern'></span>

<h3>Description</h3>

<p>This function create two independent subsamples of various subsample sizes, with a given probability vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simu.ustat.pattern(mean.prob.vec, effn.subs, n.rep = 10^2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simu.ustat.pattern_+3A_mean.prob.vec">mean.prob.vec</code></td>
<td>
<p>a vector of length 2. Its first element represents the probability that a random observation from one subsample is less than the the one from another subsample..</p>
</td></tr>
<tr><td><code id="simu.ustat.pattern_+3A_effn.subs">effn.subs</code></td>
<td>
<p>a vector contains two subsample sizes.</p>
</td></tr>
<tr><td><code id="simu.ustat.pattern_+3A_n.rep">n.rep</code></td>
<td>
<p>the total number of repetition.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>each subsample is generated from a normal distribution, with an average generated from the mean.prob.vec.
</p>


<h3>Value</h3>

<p>simu.tab a list of length n.rep. Each element of the list is a 2 by 2 matrix, showing the comparison results from function multi.freq.
</p>


<h3>References</h3>

<p>Wang, Y., Stapleton, A. E., &amp; Chen, C. (2018). Two-sample nonparametric stochastic order inference with an application in plant physiology. Journal of Statistical Computation and Simulation, 88(14), 2668-2683.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>simu.ustat.pattern(c(0.8,0.2),c(5,8),n.rep=100)
</code></pre>

<hr>
<h2 id='sub.test'>sub.test function
This function calculates the simulated p-value of comparing the trend in subsamples from two independent samples.</h2><span id='topic+sub.test'></span>

<h3>Description</h3>

<p>sub.test function
This function calculates the simulated p-value of comparing the trend in subsamples from two independent samples.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sub.test(sam1, sam2, fn.rep2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sub.test_+3A_sam1">sam1</code></td>
<td>
<p>the first sample.</p>
</td></tr>
<tr><td><code id="sub.test_+3A_sam2">sam2</code></td>
<td>
<p>the second sample</p>
</td></tr>
<tr><td><code id="sub.test_+3A_fn.rep2">fn.rep2</code></td>
<td>
<p>the total number of bootstrap repetitions needed for calculating the simulated p-value.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>critical.value the critical value of the test based on the alpha level provided
</p>
<p>chi-stat the chisqure type test statistics value from the sample provided.
</p>
<p>pvalue the simulated p-value.
</p>


<h3>References</h3>

<p>Wang, Y., Stapleton, A. E., &amp; Chen, C. (2018). Two-sample nonparametric stochastic order inference with an application in plant physiology. Journal of Statistical Computation and Simulation, 88(14), 2668-2683.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>attach(seedwt.multi.subsample)
Lev.TN&lt;-levels(TreatmentName);
Lev.Line&lt;-levels(Line);
n&lt;-dim(seedwt.multi.subsample)[1];
level.show=c(1:8);fn.rep3=10^2;
line.name&lt;-Lev.Line[1]; t1.name&lt;-Lev.TN[1];t2.name&lt;-Lev.TN[3];
### To compare the GA treatment and the PACGA treatment from line B73
par(mfrow=c(1,2))
idx&lt;-subset((TreatmentName==t1.name)*(Line==line.name)*(1:n),Env %in% level.show)
idx2&lt;-subset((TreatmentName==t2.name)*(Line==line.name)*(1:n),Env %in% level.show)
boxplot(seedwt[idx]~Env[idx],xlab="ENV levels",ylab=paste('seedwt from',t1.name),
         ylim=c(0,12),cex.lab=1.5,cex.axis=1.8);
boxplot(seedwt[idx2]~Env[idx2], xlab="ENV levels",ylab=paste('seedwt from',t2.name),
         cex.lab=1.5,cex.axis=1.8);
mtext( paste ("Line Name:",line.name), side = 3,outer = TRUE, cex = 2.2,line = -3)
temp.sw1&lt;-seedwt[idx];lab&lt;-Env[idx]; uni.lab&lt;-unique(lab)
sam.1&lt;-lapply(1:length(uni.lab), function(x) temp.sw1[lab==uni.lab[x]])
temp.sw2&lt;-seedwt[idx2];lab2&lt;-Env[idx2]; uni.lab2&lt;-unique(lab2)
sam.2&lt;-lapply(1:length(uni.lab2), function(x) temp.sw2[lab2==uni.lab2[x]])
print(paste("working with line ",line.name,'and treatment',t1.name ,'vs',t2.name ))
resu&lt;-sub.test(sam.1,sam.2,fn.rep2=fn.rep3);
dev.off()
## This will show a similar result as the first experiment of section 5 in the paper.
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
