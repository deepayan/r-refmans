<!DOCTYPE html><html><head><title>Help for package DIRECT</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {DIRECT}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#DIRECT'>
<p>Bayesian Clustering with the Dirichlet-Process Prior</p></a></li>
<li><a href='#DIRECT-package'><p>Bayesian Clustering of Multivariate Data with the Dirichlet-Process Prior</p></a></li>
<li><a href='#Dirichlet'>
<p>The Dirichlet Distribution</p></a></li>
<li><a href='#DPMCMC'>
<p>Dirichlet Process-Based Markov Chain Monte Carlo (MCMC) Sampler for Mixture Model-Based Clustering</p></a></li>
<li><a href='#MVNorm'>
<p>The Multivariate Normal Distribution</p></a></li>
<li><a href='#outputData'>
<p>Writing Simulation Parameters and Data to Files</p></a></li>
<li><a href='#plotClustersMean'>
<p>Plotting Clustered Mean Vectors</p></a></li>
<li><a href='#plotClustersPCA'>
<p>PCA Plot for Posterior Allocation Probability Matrix</p></a></li>
<li><a href='#plotClustersSD'>
<p>Plotting Posterior Estimates of Cluster-Specific Random Effects</p></a></li>
<li><a href='#plotSimulation'>
<p>Plotting Data Simulated Under A Random-Effects Mixture Model</p></a></li>
<li><a href='#relabel'>
<p>A Relabel Algorithm</p></a></li>
<li><a href='#resampleClusterProb'>
<p>Resampling to Estimate Posterior Allocation Probability Matrix</p></a></li>
<li><a href='#simuDataREM'>
<p>Data Simulation Under the Random-Effects Mixture Model</p></a></li>
<li><a href='#summaryDIRECT'>
<p>Processing Posterior Estimates for Clustering Under DIRECT</p></a></li>
<li><a href='#tc.data'>
<p>Time-Course Microarray Gene Expression Data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Bayesian Clustering of Multivariate Data Under the
Dirichlet-Process Prior</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-08-30</td>
</tr>
<tr>
<td>Author:</td>
<td>Audrey Qiuyan Fu, Steven Russell, Sarah J. Bray and Simon Tavare</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Audrey Q. Fu &lt;audreyqyfu@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>A Bayesian clustering method for replicated time series or replicated measurements from multiple experimental conditions, e.g., time-course gene expression data.  It estimates the number of clusters directly from the data using a Dirichlet-process prior.  See Fu, A. Q., Russell, S., Bray, S. and Tavare, S. (2013) Bayesian clustering of replicated time-course gene expression data with weak signals. The Annals of Applied Statistics. 7(3) 1334-1361. &lt;<a href="https://doi.org/10.1214%2F13-AOAS650">doi:10.1214/13-AOAS650</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-09-07 21:51:36 UTC; audreyq.fu</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-09-07 22:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='DIRECT'>
Bayesian Clustering with the Dirichlet-Process Prior
</h2><span id='topic+DIRECT'></span><span id='topic+direct'></span>

<h3>Description</h3>

<p>A Bayesian clustering method for multivariate data, e.g., replicated time-course microarray gene expression data.  This method uses a mixture random-effects model that decomposes the total variability in the data into within-cluster variability, variability across experimental conditions (e.g., time points), and variability in replicates (i.e., residual variability).  It also uses a Dirichlet-process prior to induce a distribution on the number of clusters as well as clustering.  Metropolis-Hastings Markov chain Monte Carlo procedures are used for parameter estimation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DIRECT (data, data.name = "Output", 
        SKIP = 0, nTime, times = 1:nTime, 
        c.curr, 
        uWICluster = 1, uTSampling = 1, uResidual = 1, 
        meanVec = rep(0, nTime), meanMT1 = 0, sdMT1 = 0.2, 
        meanMTProc = 0, sdMTProc = 0.5, uSDT1 = 0.2, uSDProc = 1, 
        shapeBetaProc = 0.5, rateBetaProc = 0.5, 
        PAR.INIT = TRUE, 
        sdWICluster.curr = 0.5, sdTSampling.curr = 0.5, 
        sdResidual.curr = 0.5, alpha.curr = 0.01, 
        alpha.prior.shape = 0.01, alpha.prior.rate = 1, 
        WICluster.prop.sd = 0.2, TSampling.prop.sd = 0.2, 
        Residual.prop.sd = 0.2, alpha.prop.sd = 0.2, 
        nIter, burn.in, step.size, nRepeat = 1, nResample, 
        seed.value, 
        RNORM.METHOD = c("chol", "eigen", "svd"), 
        SAMPLE.C = c("FRBT", "Neal"), 
        PRIOR.MODEL = c("none", "OU", "BM", "BMdrift"), 
        ALPHA.METHOD = c("Gibbs", "MH"), 
        RELABEL.THRESHOLD = 0.01, 
        OUTPUT.CLUST.SIZE = FALSE, PRINT = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DIRECT_+3A_data">data</code></td>
<td>

<p>An <code class="reqn">N \times JR</code> matrix of continuous values, or a data frame containing such a matrix.  <code class="reqn">N</code> is the number if items, <code class="reqn">J</code> the number of time points (or experimental conditions) and <code class="reqn">R</code> the number of replicates.  Each row contains values for Replicates 1 through <code class="reqn">R</code> under Condition 1, values for Replicates 1 through <code class="reqn">R</code> under Condition 2, and so on.
</p>
</td></tr>
<tr><td><code id="DIRECT_+3A_data.name">data.name</code></td>
<td>

<p>A character string used as the prefix of output files.  
</p>
</td></tr>
<tr><td><code id="DIRECT_+3A_skip">SKIP</code></td>
<td>

<p>Number of columns in <code>data</code> to be skipped when processing the data.
</p>
</td></tr>
<tr><td><code id="DIRECT_+3A_ntime">nTime</code></td>
<td>

<p>Number of time points (or experimental conditions).
</p>
</td></tr>
<tr><td><code id="DIRECT_+3A_times">times</code></td>
<td>

<p>An integer vector of length <code>nTime</code>, indicating times (or experimental conditions).
</p>
</td></tr>
<tr><td><code id="DIRECT_+3A_c.curr">c.curr</code></td>
<td>

<p>An integer vector of length <code class="reqn">N</code>, indicating initial cluster assignments for items 1 through <code class="reqn">N</code>.  
</p>
</td></tr>
<tr><td><code id="DIRECT_+3A_uwicluster">uWICluster</code></td>
<td>

<p>Upper bound of the uniform prior assigned to the standard deviation of within-cluster variability.  The lower bound of the uniform prior is 0.
</p>
</td></tr>
<tr><td><code id="DIRECT_+3A_utsampling">uTSampling</code></td>
<td>

<p>Upper bound of the uniform prior assigned to the standard deviation of variability due to sampling across time points (or experimental conditions).  The lower bound of the uniform prior is 0.
</p>
</td></tr>
<tr><td><code id="DIRECT_+3A_uresidual">uResidual</code></td>
<td>

<p>Upper bound of the uniform prior assigned to the standard deviation of residual variability (i.e., variability across replicates).  The lower bound of the uniform prior is 0.
</p>
</td></tr>
<tr><td><code id="DIRECT_+3A_meanvec">meanVec</code></td>
<td>

<p>Prior mean vector of length <code>nTime</code>.  Required if <code>PRIOR.MODEL="none"</code>.
</p>
</td></tr>
<tr><td><code id="DIRECT_+3A_meanmt1">meanMT1</code></td>
<td>

<p>Prior mean (scalar) of the mean at the first time point.  Required if <code>PRIOR.MODEL</code> is one of the stochastic processes (&quot;OU&quot;, &quot;BM&quot; and &quot;BMdrift&quot;).
</p>
</td></tr>
<tr><td><code id="DIRECT_+3A_sdmt1">sdMT1</code></td>
<td>

<p>A positive scalar.  Prior standard deviation (scalar) of the mean at the first time point.  Required if <code>PRIOR.MODEL</code> is one of the stochastic processes (&quot;OU&quot;, &quot;BM&quot; and &quot;BMdrift&quot;).
</p>
</td></tr>
<tr><td><code id="DIRECT_+3A_meanmtproc">meanMTProc</code></td>
<td>

<p>Prior mean (scalar) of the mean across time points.  Required if <code>PRIOR.MODEL</code> is one of the stochastic processes (&quot;OU&quot;, &quot;BM&quot; and &quot;BMdrift&quot;).  Set to 0 if <code>PRIOR.MODEL="BM"</code>.
</p>
</td></tr>
<tr><td><code id="DIRECT_+3A_sdmtproc">sdMTProc</code></td>
<td>

<p>A positive scalar.  Prior standard deviation (scalar) of the mean across time points.  Required if <code>PRIOR.MODEL</code> is one of the stochastic processes (&quot;OU&quot;, &quot;BM&quot; and &quot;BMdrift&quot;).
</p>
</td></tr>
<tr><td><code id="DIRECT_+3A_usdt1">uSDT1</code></td>
<td>

<p>The upper bound of the uniform prior assigned to the standard deviation at the first time point.  The lower bound of the uniform prior is 0.  Required if <code>PRIOR.MODEL</code> is one of the stochastic processes (&quot;OU&quot;, &quot;BM&quot; and &quot;BMdrift&quot;).  
</p>
</td></tr>
<tr><td><code id="DIRECT_+3A_usdproc">uSDProc</code></td>
<td>

<p>The upper bound of the uniform prior assigned to the standard deviation across time points.  The lower bound of the uniform prior is 0.  Required if <code>PRIOR.MODEL</code> is one of the stochastic processes (&quot;OU&quot;, &quot;BM&quot; and &quot;BMdrift&quot;).  
</p>
</td></tr>
<tr><td><code id="DIRECT_+3A_shapebetaproc">shapeBetaProc</code></td>
<td>

<p>A positive scalar.  The shape parameter in the beta prior for the mean-reverting rate in an Ornstein-Uhlenbeck process.  Required if <code>PRIOR.MODEL="OU"</code>.
</p>
</td></tr>
<tr><td><code id="DIRECT_+3A_ratebetaproc">rateBetaProc</code></td>
<td>

<p>A positive scalar.  The rate parameter in the beta prior for the mean-reverting rate in an Ornstein-Uhlenbeck process.  Required if <code>PRIOR.MODEL="OU"</code>.
</p>
</td></tr>
<tr><td><code id="DIRECT_+3A_par.init">PAR.INIT</code></td>
<td>

<p>Logical value.  Generate initial values for the standard deviations of the three types of variability if TRUE.  Use the input values otherwise.
</p>
</td></tr>
<tr><td><code id="DIRECT_+3A_sdwicluster.curr">sdWICluster.curr</code></td>
<td>

<p>A positive scalar.  Initial value of the standard deviation of the within-cluster variability.  Ignored if <code>PAR.INIT=TRUE</code>.
</p>
</td></tr>
<tr><td><code id="DIRECT_+3A_sdtsampling.curr">sdTSampling.curr</code></td>
<td>

<p>A positive scalar.  Initial value of the standard deviation of the variability across time points.  Ignored if <code>PAR.INIT=TRUE</code>.
</p>
</td></tr>
<tr><td><code id="DIRECT_+3A_sdresidual.curr">sdResidual.curr</code></td>
<td>

<p>A positive scalar.  Initial value of the standard deviation of the residual variability (i.e., variability across replicates).  Ignored if <code>PAR.INIT=TRUE</code>.
</p>
</td></tr>
<tr><td><code id="DIRECT_+3A_alpha.curr">alpha.curr</code></td>
<td>

<p>A positive scalar.  Initial value of <code class="reqn">\alpha</code>, the concentration parameter of the Dirichlet-process prior.
</p>
</td></tr>
<tr><td><code id="DIRECT_+3A_alpha.prior.shape">alpha.prior.shape</code></td>
<td>

<p>A positive scalar.  The shape parameter in the beta prior for <code class="reqn">\alpha</code>, the concentration parameter of the Dirichlet-process prior.
</p>
</td></tr>
<tr><td><code id="DIRECT_+3A_alpha.prior.rate">alpha.prior.rate</code></td>
<td>

<p>A positive scalar.  The rate parameter in the beta prior for <code class="reqn">\alpha</code>, the concentration parameter of the Dirichlet-process prior.
</p>
</td></tr>
<tr><td><code id="DIRECT_+3A_wicluster.prop.sd">WICluster.prop.sd</code></td>
<td>

<p>A positive scalar.  The standard deviation in the proposal distribution (normal) for the standard deviation of the within-cluster variability.
</p>
</td></tr>
<tr><td><code id="DIRECT_+3A_tsampling.prop.sd">TSampling.prop.sd</code></td>
<td>

<p>A positive scalar.  The standard deviation in the proposal distribution (normal) for the standard deviation of the variability across time points.
</p>
</td></tr>
<tr><td><code id="DIRECT_+3A_residual.prop.sd">Residual.prop.sd</code></td>
<td>

<p>A positive scalar.  The standard deviation in the proposal distribution (normal) for the standard deviation of the residual variability (i.e., variability across replicates).
</p>
</td></tr>
<tr><td><code id="DIRECT_+3A_alpha.prop.sd">alpha.prop.sd</code></td>
<td>

<p>A positive scalar.  The standard deviation in the proposal distribution (normal) for <code class="reqn">\alpha</code>, the concentration parameter of the Dirichlet-process prior.  Ignored if <code>ALPHA.METHOD="Gibbs"</code>.
</p>
</td></tr>
<tr><td><code id="DIRECT_+3A_niter">nIter</code></td>
<td>

<p>The number of MCMC iterations.
</p>
</td></tr>
<tr><td><code id="DIRECT_+3A_burn.in">burn.in</code></td>
<td>

<p>A value in (0,1) indicating the percentage of the MCMC iterations to be used as burn-in and be discarded in posterior inference.
</p>
</td></tr>
<tr><td><code id="DIRECT_+3A_step.size">step.size</code></td>
<td>

<p>An integer indicating the number of MCMC iterations to be skipped between two recorded MCMC samples.
</p>
</td></tr>
<tr><td><code id="DIRECT_+3A_nrepeat">nRepeat</code></td>
<td>

<p>An integer <code class="reqn">\geq 1</code> indicating the number of times to update the cluster memberships for all items.  Useful only when <code>SAMPLE.C="Neal"</code>.
</p>
</td></tr>
<tr><td><code id="DIRECT_+3A_nresample">nResample</code></td>
<td>

<p>An integer <code class="reqn">\geq 1</code> indicating the number of resamples to draw to estimate the posterior mixing proportions.  
</p>
</td></tr>
<tr><td><code id="DIRECT_+3A_seed.value">seed.value</code></td>
<td>

<p>A positive value used in random number generation.
</p>
</td></tr>
<tr><td><code id="DIRECT_+3A_rnorm.method">RNORM.METHOD</code></td>
<td>

<p>Method to compute the determinant of the covariance matrix in the calculation of the multivariate normal density.  Required.  Method choices are: &quot;chol&quot; for Choleski decomposition, &quot;eigen&quot; for eigenvalue decomposition, and &quot;svd&quot; for singular value decomposition.
</p>
</td></tr>
<tr><td><code id="DIRECT_+3A_sample.c">SAMPLE.C</code></td>
<td>

<p>Method to update cluster memberships.  Required.  Method choices are: &quot;FRBT&quot; for the Metropolis-Hastings sampler based on a discrete uniform proposal distribution developed in Fu, Russell, Bray and Tavare, and &quot;Neal&quot; for the Metropolis-Hastings sampler developed in Neal (2000).
</p>
</td></tr>
<tr><td><code id="DIRECT_+3A_prior.model">PRIOR.MODEL</code></td>
<td>

<p>Model to generate realizations of the mean vector of a mixture component.  Required.  Choices are: &quot;none&quot; for not assuming a stochastic process and using a zero vector, &quot;OU&quot; for an Ornstein-Uhlenbeck process (a.k.a. the mean-reverting process), &quot;BM&quot; for a Brown motion (without drift), and &quot;BMdrift&quot; for a Brownian motion with drift.
</p>
</td></tr>
<tr><td><code id="DIRECT_+3A_alpha.method">ALPHA.METHOD</code></td>
<td>

<p>Method to update <code class="reqn">\alpha</code>, the concentration parameter of the Dirichlet-process prior.  Required.  Choices are: &quot;Gibbs&quot; for a Gibbs sampler developed in Escobar and West (1995), and &quot;MH&quot; for a Metropolis-Hastings sampler.
</p>
</td></tr>
<tr><td><code id="DIRECT_+3A_relabel.threshold">RELABEL.THRESHOLD</code></td>
<td>

<p>A positive scalar.  Used to determine whether the optimization in the relabeling algorithm has converged.  
</p>
</td></tr>
<tr><td><code id="DIRECT_+3A_output.clust.size">OUTPUT.CLUST.SIZE</code></td>
<td>

<p>If TRUE, output cluster sizes in MCMC iterations into an external file *_mcmc_size.out.
</p>
</td></tr>
<tr><td><code id="DIRECT_+3A_print">PRINT</code></td>
<td>

<p>If TRUE, print intermediate values during an MCMC run onto the screen.  Used for debugging with small data sets.  
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>DIRECT is a mixture model-based clustering method.  It consists of two major steps: 
</p>

<ol>
<li><p> MCMC sampling.  DIRECT generates MCMC samples of assignments to mixture components (number of components implicitly generated; written into external file *_mcmc_cs.out) and component-specific parameters (written into external file *_mcmc_pars.out), which include mean vectors and standard deviations of three types of variability.  
</p>
</li>
<li><p> Posterior inference, which further consists of two steps: 
</p>

<ol>
<li><p> Resampling: DIRECT estimates posterior allocation probability matrix (written into external file *_mcmc_probs.out).
</p>
</li>
<li><p> Relabeling: DIRECT deals with label-switching by estimating optimal labels of mixture components (written into external file *_mcmc_perms.out), implementing 
Algorithm 2 in Stephens (2000).
</p>
</li></ol>

</li></ol>

<p>The arguments required to set up a DIRECT run can be divided into five categories: 
</p>

<ol>
<li><p> Data-related, such as <code>data</code>, <code>times</code> and so on.
</p>
</li>
<li><p> Initial values of parameters, including <code>c.curr</code>, <code>sdWICluster.curr</code>, <code>sdTSampling.curr</code>, <code>sdResidual.curr</code> and <code>alpha.curr</code>.
</p>
</li>
<li><p> Values used to specify prior distributions, such as <code>uWICluster</code>, <code>meanMT1</code>, <code>rateBetaProc</code>, <code>alpha.prior.shape</code> and so on.
</p>
</li>
<li><p> Standard deviation used in the proposal distributions for parameters of interest.  A normal distribution whose mean is the current value and whose standard deviation is user-specified is used as the proposal.  Reflection is used if the proposal is outside the range (e.g., (0,1)) for the parameter.
</p>
</li>
<li><p> Miscellaneous arguments for MCMC configuration, for model choices and for output choices.
</p>
</li></ol>

<p>The user may set up multiple runs with different initial values or values in the prior distributions, and compare the clustering results to check whether the MCMC run has mixed well and whether the inference is sensitive to initial values or priors.  If the data are informative enough, initial values and priors should lead to consistent clustering results.
</p>


<h3>Value</h3>

<p>At least four files are generated during a DIRECT run and placed under the current working directory:
</p>

<ol>
<li><p> *_mcmc_cs.out: Generated from MCMC sampling.  Each row contains an MCMC sample of assignments of items to mixture components, or cluster memberships if a component is defined as a cluster, as well as <code class="reqn">\alpha</code>, the concentration parameter in the Dirichlet-process prior.
</p>
</li>
<li><p> *_mcmc_pars.out: Generated from MCMC sampling.  Each row contains an MCMC sample of parameters specific to a mixture component.  Multiple rows may come from the same MCMC iteration.
</p>
</li>
<li><p> *_mcmc_probs.out: Generated from resampling in posterior inference.  File contains a matrix of <code class="reqn">HN \times K</code>, which is <code class="reqn">H</code> posterior allocation probability matrices stacked up, each matrix of <code class="reqn">N \times K</code>, where <code class="reqn">H</code> is the number of recorded MCMC samples, <code class="reqn">N</code> the number of items and <code class="reqn">K</code> the inferred number of mixture components.
</p>
</li>
<li><p> *_mcmc_perms.out: Generated from relabeling in posterior inference.  Each row contains an inferred permutation (relabel) of labels of mixture components.
</p>
</li></ol>

<p>If argument <code>OUTPUT.CLUST.SIZE=TRUE</code>, the fifth file *_mcmc_size.out is also generated, which contains the cluster sizes of each recorded MCMC sample.
</p>


<h3>Note</h3>

<p><code>DIRECT</code> calls the following functions adapted or directly taken from other R packages: <code><a href="#topic+dMVNorm">dMVNorm</a></code>, <code><a href="#topic+rMVNorm">rMVNorm</a></code> and <code><a href="#topic+rDirichlet">rDirichlet</a></code>.  See documentation of each function for more information.
</p>


<h3>Author(s)</h3>

<p>Audrey Q. Fu
</p>


<h3>References</h3>

<p>Escobar, M. D. and West, M. (1995) Bayesian density estimation and inference using mixtures. Journal of the American Statistical Association, 90: 577-588. 
</p>
<p>Fu, A. Q., Russell, S., Bray, S. and Tavare, S. (2013) Bayesian clustering of replicated time-course gene expression data with weak signals. The Annals of Applied Statistics. 7(3) 1334-1361.
</p>
<p>Stephens, M. (2000) Dealing with label switching in mixture models. Journal of the Royal Statistical Society, Series B, 62: 795-809.
</p>
<p>Neal, R. M. (2000) Markov chain sampling methods for Dirichlet process mixture models. Journal of Computational and Graphical Statistics, 9: 249-265. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DPMCMC">DPMCMC</a></code> for the MCMC sampler under the Dirichlet-process prior.
</p>
<p><code><a href="#topic+resampleClusterProb">resampleClusterProb</a></code> for resampling of posterior allocation probability matrix in posterior inference.
</p>
<p><code><a href="#topic+relabel">relabel</a></code> for relabeling in posterior inference.
</p>
<p><code><a href="#topic+summaryDIRECT">summaryDIRECT</a></code> for processing MCMC estimates for clustering.
</p>
<p><code><a href="#topic+simuDataREM">simuDataREM</a></code> for simulating data under the mixture random-effects model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Load replicated time-course gene expression data
# Use only first 50 genes for test run
data (tc.data)
data = tc.data[1:50,]
times = c(0,5,10,15,20,25,30,35,40,50,60,70,80,90,100,110,120,150)
nGene = nrow (data)
nTime=length (times)
SKIP = 2

# Initial values and MCMC specs
c.curr = rep (1, nGene)    # start with a single cluster
alpha.curr = 0.01

alpha.prior.shape = 1/nGene
alpha.prior.rate = 1

SAMPLE.C.METHOD="FRBT"    # method for sampling cluster memberships
PRIOR.MODEL = "OU"       # prior model for generating mean vector
ALPHA.METHOD = "MH"      # method for sampling concentration parameter
RELABEL.THRESHOLD=0.01   # stopping criterion used in relabeling algorithm

nIter=10
burn.in=0
step.size=1
nResample=2
seed.value = 12

data.name="tmp"          # prefix of output files

# Run DIRECT
# This is a short run that takes less than a minute
# All output files will be under current working directory
DIRECT (data=data, data.name=data.name, SKIP=SKIP, nTime=nTime, times=times, 
    c.curr=c.curr, PAR.INIT=TRUE, alpha.curr=alpha.curr, 
    alpha.prior.shape=alpha.prior.shape, 
    alpha.prior.rate=alpha.prior.rate, 
    nIter=nIter, burn.in=burn.in, step.size=step.size, 
    nResample=nResample, seed.value=seed.value, 
    RNORM.METHOD="svd", SAMPLE.C=SAMPLE.C.METHOD, 
    PRIOR.MODEL=PRIOR.MODEL, ALPHA.METHOD=ALPHA.METHOD, 
    RELABEL.THRESHOLD=RELABEL.THRESHOLD)

# Process MCMC samples from DIRECT
data.name="tmp"          # prefix of output files
tmp.summary = summaryDIRECT (data.name)

# Plot clustering results
#
# If the plots do not display well
# use pdf() to generate the plots in an external pdf
#
# Clustered mean profiles
plotClustersMean (data, tmp.summary, SKIP=2, times=times)
#
# To use pdf(), run the following lines in R
# &gt; pdf ("plot_means.pdf")
# &gt; plotClustersMean (data, tmp.summary, SKIP=2, times=times)
# &gt; dev.off()
#
par (mfrow=c(1,1))
# Posterior estimates of standard deviations 
# of three types of variability in each cluster
plotClustersSD (tmp.summary, nTime=18)
# PCA plot of the posterior allocation probability matrix
plotClustersPCA (data$GeneName, tmp.summary)

## End(Not run)
</code></pre>

<hr>
<h2 id='DIRECT-package'>Bayesian Clustering of Multivariate Data with the Dirichlet-Process Prior</h2><span id='topic+DIRECT-package'></span>

<h3>Description</h3>

<p>This package implements the Bayesian clustering method in Fu et al. (2013).  It also contains a simulation function to generate data under the random-effects mixture model presented in this paper, as well as summary and plotting functions to process MCMC samples and display the clustering results.  Replicated time-course microarray gene expression data analyzed in this paper are in <code>tc.data</code>.</p>


<h3>Details</h3>

<p>This package three sets of functions.
</p>

<ul>
<li><p> Functions <code><a href="#topic+DIRECT">DIRECT</a></code> and others for clustering data.  They estimate the number of clusters and infers the partition for multivariate data, e.g., replicated time-course microarray gene expression data.  The clustering method involves a random-effects mixture model that decomposes the total variability in the data into within-cluster variability, variability across experimental conditions (e.g., time points), and variability in replicates (i.e., residual variability).  The clustering method uses a Dirichlet-process prior to induce a distribution on the number of clusters as well as clustering.  It uses Metropolis-Hastings Markov chain Monte Carlo for parameter estimation.  To estimate the posterior allocation probability matrix while dealing with the label-switching problem, there is a two-step posterior inference procedure involving resampling and relabeling.
</p>
</li>
<li><p> Functions for processing MCMC samples and plotting the clustering results.
</p>
</li>
<li><p> Functions for simulating data under the random-effects mixture model.
</p>
</li></ul>

<p>See <code><a href="#topic+DIRECT">DIRECT</a></code> for details on using the function for clustering.
</p>
<p>See <code><a href="#topic+summaryDIRECT">summaryDIRECT</a></code>, which points to other related plotting functions, for details on how to process MCMC samples and display clustering results.
</p>
<p>See <code><a href="#topic+simuDataREM">simuDataREM</a></code>, which points to other related functions, for simulating data under the random-effects mixture model.
</p>


<h3>Author(s)</h3>

<p>Audrey Qiuyan Fu
</p>
<p>Maintainer: Audrey Q. Fu &lt;audreyqyfu@gmail.com&gt;
</p>


<h3>References</h3>

<p>Fu, A. Q., Russell, S., Bray, S. and Tavare, S. (2013) Bayesian clustering of replicated time-course gene expression data with weak signals. The Annals of Applied Statistics. 7(3) 1334-1361.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DIRECT">DIRECT</a></code> for the clustering method.
</p>
<p><code><a href="#topic+summaryDIRECT">summaryDIRECT</a></code> for processing MCMC estimates for clustering.
</p>
<p><code><a href="#topic+simuDataREM">simuDataREM</a></code> for simulating data under the mixture random-effects model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## See examples in DIRECT and simuDataREM.
</code></pre>

<hr>
<h2 id='Dirichlet'>
The Dirichlet Distribution
</h2><span id='topic+rDirichlet'></span><span id='topic+dDirichlet'></span>

<h3>Description</h3>

<p>Functions to compute the density of a Dirichlet distribution and to generate random realizations from such a distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dDirichlet (x, alpha, log=FALSE)
rDirichlet (n, alpha)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Dirichlet_+3A_alpha">alpha</code></td>
<td>

<p>Shape parameter vector.  
</p>
</td></tr>
<tr><td><code id="Dirichlet_+3A_x">x</code></td>
<td>

<p>Vector of the same length as <code>alpha</code>.
</p>
</td></tr>
<tr><td><code id="Dirichlet_+3A_n">n</code></td>
<td>

<p>Number of realizations (vectors) to generate.
</p>
</td></tr>
<tr><td><code id="Dirichlet_+3A_log">log</code></td>
<td>

<p>Logical value.  TRUE if computing the log density.  Default is FALSE.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>rDirichlet</code> returns a vector of the same length as <code>alpha</code> if <code>n</code>=1, or a matrix with each row being an independent realization otherwise.
</p>


<h3>Author(s)</h3>

<p>Audrey Q. Fu coded <code>dDirichlet</code>.  
</p>
<p>The code for <code>rDirichlet</code> is taken from a similar function in R package <code>gregmisc</code> by Gregory R. Warnes. His code was based on code posted by Ben Bolker to R-News on 15 Dec 2000.  See documentation in gregmisc for further information.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- rDirichlet (5, rep (0.5, 3))
dDirichlet (x[1, ], rep (0.5, 3))
</code></pre>

<hr>
<h2 id='DPMCMC'>
Dirichlet Process-Based Markov Chain Monte Carlo (MCMC) Sampler for Mixture Model-Based Clustering
</h2><span id='topic+DPMCMC'></span>

<h3>Description</h3>

<p>The MCMC sampler for <code><a href="#topic+DIRECT">DIRECT</a></code>.  In each MCMC iteration, the function updates cluster memberships for all items, allowing for changes in the number of clusters (mixture components).  This update implements a Metropolis-Hastings (MH) sampler developed in Fu et al. (2013), and an MH sampler developed in Neal (2000).  It also updates parameters specific to each mixture components via MH sampling.  Parameters of interest include the mean vector and standard deviations of the three types of variability.  Additionally, it updates <code class="reqn">\alpha</code>, the concentration parameter in the Dirichlet-process prior, allowing for Gibbs (Escobar and West, 1995) and MH sampling.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DPMCMC(file.mcmc.cs, file.mcmc.pars, file.mcmc.probs, file.size, 
       data, SKIP, nTime, times, c.curr, par.prior, 
       PAR.INIT = FALSE, 
       sdWICluster.curr = 0.5, sdTSampling.curr = 0.5, 
       sdResidual.curr = 0.5, alpha.curr, 
       alpha.prior.shape, alpha.prior.rate, sd.prop, 
       nIter, burn.in, step.size, nRepeat = 1, nResample, seed.value, 
       RNORM.METHOD = c("chol", "eigen", "svd"), 
       SAMPLE.C = c("FRBT", "Neal"), 
       PRIOR.MODEL = c("none", "OU", "BM", "BMdrift"), 
       ALPHA.METHOD = c("Gibbs", "MH"), 
       OUTPUT.CLUST.SIZE = FALSE, PRINT = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DPMCMC_+3A_file.mcmc.cs">file.mcmc.cs</code></td>
<td>

<p>A character string in quotation marks indicating the output filename for cluster memberships and <code class="reqn">\alpha</code>.
</p>
</td></tr>
<tr><td><code id="DPMCMC_+3A_file.mcmc.pars">file.mcmc.pars</code></td>
<td>

<p>A character string in quotation marks indicating the output filename for MCMC samples of parameters specific to mixture components.
</p>
</td></tr>
<tr><td><code id="DPMCMC_+3A_file.mcmc.probs">file.mcmc.probs</code></td>
<td>

<p>A character string in quotation marks indicating the output filename for posterior allocation probability matrices from the resampling step.
</p>
</td></tr>
<tr><td><code id="DPMCMC_+3A_file.size">file.size</code></td>
<td>

<p>A character string in quotation marks indicating the output filename for cluster sizes.
</p>
</td></tr>
<tr><td><code id="DPMCMC_+3A_data">data</code></td>
<td>

<p>An <code class="reqn">N \times JR</code> matrix of continuous values, or a data frame containing such a matrix.  <code class="reqn">N</code> is the number if items, <code class="reqn">J</code> the number of time points (or experimental conditions) and <code class="reqn">R</code> the number of replicates.  Each row contains values for Replicates 1 through <code class="reqn">R</code> under Condition 1, values for Replicates 1 through <code class="reqn">R</code> under Condition 2, and so on.
</p>
</td></tr>
<tr><td><code id="DPMCMC_+3A_skip">SKIP</code></td>
<td>

<p>Number of columns in <code>data</code> to be skipped when processing the data.
</p>
</td></tr>
<tr><td><code id="DPMCMC_+3A_ntime">nTime</code></td>
<td>

<p>Number of time points (or experimental conditions).
</p>
</td></tr>
<tr><td><code id="DPMCMC_+3A_times">times</code></td>
<td>

<p>An integer vector of length <code>nTime</code>, indicating times (or experimental conditions).
</p>
</td></tr>
<tr><td><code id="DPMCMC_+3A_c.curr">c.curr</code></td>
<td>

<p>An integer vector of length <code class="reqn">N</code>, indicating initial cluster assignments for items 1 through <code class="reqn">N</code>.  
</p>
</td></tr>
<tr><td><code id="DPMCMC_+3A_par.prior">par.prior</code></td>
<td>

<p>A list that contains parameters of the prior distributions.  It has the following format: <code>par.prior = list (uWICluster=???, uTSampling=???, uResidual=???, mean=???, meanMT1=???, sdMT1=???, meanMTProc=???, sdMTProc=???, uSDT1=???, uSDProc=???, shapeBetaProc=???, rateBetaProc=???)</code>.  See <code><a href="#topic+DIRECT">DIRECT</a></code> for possible values of the list components.
</p>
</td></tr>
<tr><td><code id="DPMCMC_+3A_par.init">PAR.INIT</code></td>
<td>

<p>Logical value.  Generate initial values for the standard deviations of the three types of variability if TRUE.  Use the input values otherwise.
</p>
</td></tr>
<tr><td><code id="DPMCMC_+3A_sdwicluster.curr">sdWICluster.curr</code></td>
<td>

<p>A positive scalar.  Initial value of the standard deviation of the within-cluster variability.  Ignored if <code>PAR.INIT=TRUE</code>.
</p>
</td></tr>
<tr><td><code id="DPMCMC_+3A_sdtsampling.curr">sdTSampling.curr</code></td>
<td>

<p>A positive scalar.  Initial value of the standard deviation of the variability across time points.  Ignored if <code>PAR.INIT=TRUE</code>.
</p>
</td></tr>
<tr><td><code id="DPMCMC_+3A_sdresidual.curr">sdResidual.curr</code></td>
<td>

<p>A positive scalar.  Initial value of the standard deviation of the residual variability (i.e., variability across replicates).  Ignored if <code>PAR.INIT=TRUE</code>.
</p>
</td></tr>
<tr><td><code id="DPMCMC_+3A_alpha.curr">alpha.curr</code></td>
<td>

<p>A positive scalar.  Initial value of <code class="reqn">\alpha</code>, the concentration parameter of the Dirichlet-process prior.
</p>
</td></tr>
<tr><td><code id="DPMCMC_+3A_alpha.prior.shape">alpha.prior.shape</code></td>
<td>

<p>A positive scalar.  The shape parameter in the beta prior for <code class="reqn">\alpha</code>, the concentration parameter of the Dirichlet-process prior.
</p>
</td></tr>
<tr><td><code id="DPMCMC_+3A_alpha.prior.rate">alpha.prior.rate</code></td>
<td>

<p>A positive scalar.  The rate parameter in the beta prior for <code class="reqn">\alpha</code>, the concentration parameter of the Dirichlet-process prior.
</p>
</td></tr>
<tr><td><code id="DPMCMC_+3A_sd.prop">sd.prop</code></td>
<td>

<p>A list that contains standard deviations in the proposal distributions for some key parameters.  It has the following format: <code>sd.prop=list (WICluster=???, TSampling=???, Residual=???, alpha=???)</code>.  ??? needs to be filled in with positive values.  See <code><a href="#topic+DIRECT">DIRECT</a></code>.
</p>
</td></tr>
<tr><td><code id="DPMCMC_+3A_niter">nIter</code></td>
<td>

<p>The number of MCMC iterations.
</p>
</td></tr>
<tr><td><code id="DPMCMC_+3A_burn.in">burn.in</code></td>
<td>

<p>A value in (0,1) indicating the percentage of the MCMC iterations to be used as burn-in and be discarded in posterior inference.
</p>
</td></tr>
<tr><td><code id="DPMCMC_+3A_step.size">step.size</code></td>
<td>

<p>An integer indicating the number of MCMC iterations to be skipped between two recorded MCMC samples.
</p>
</td></tr>
<tr><td><code id="DPMCMC_+3A_nrepeat">nRepeat</code></td>
<td>

<p>An integer <code class="reqn">\geq 1</code> indicating the number of times to update the cluster memberships for all items.  Useful only when <code>SAMPLE.C="Neal"</code>.
</p>
</td></tr>
<tr><td><code id="DPMCMC_+3A_nresample">nResample</code></td>
<td>

<p>An integer <code class="reqn">\geq 1</code> indicating the number of resamples to draw to estimate the posterior mixing proportions.  
</p>
</td></tr>
<tr><td><code id="DPMCMC_+3A_seed.value">seed.value</code></td>
<td>

<p>A positive value used in random number generation.
</p>
</td></tr>
<tr><td><code id="DPMCMC_+3A_rnorm.method">RNORM.METHOD</code></td>
<td>

<p>Method to compute the determinant of the covariance matrix in the calculation of the multivariate normal density.  Required.  Method choices are: &quot;chol&quot; for Choleski decomposition, &quot;eigen&quot; for eigenvalue decomposition, and &quot;svd&quot; for singular value decomposition.
</p>
</td></tr>
<tr><td><code id="DPMCMC_+3A_sample.c">SAMPLE.C</code></td>
<td>

<p>Method to update cluster memberships.  Required.  Method choices are: &quot;FRBT&quot; for the Metropolis-Hastings sampler based on a discrete uniform proposal distribution developed in Fu, Russell, Bray and Tavare, and &quot;Neal&quot; for the Metropolis-Hastings sampler developed in Neal (2000).
</p>
</td></tr>
<tr><td><code id="DPMCMC_+3A_prior.model">PRIOR.MODEL</code></td>
<td>

<p>Model to generate realizations of the mean vector of a mixture component.  Required.  Choices are: &quot;none&quot; for not assuming a stochastic process and using a zero vector, &quot;OU&quot; for an Ornstein-Uhlenbeck process (a.k.a. the mean-reverting process), &quot;BM&quot; for a Brown motion (without drift), and &quot;BMdrift&quot; for a Brownian motion with drift.
</p>
</td></tr>
<tr><td><code id="DPMCMC_+3A_alpha.method">ALPHA.METHOD</code></td>
<td>

<p>Method to update <code class="reqn">\alpha</code>, the concentration parameter of the Dirichlet-process prior.  Required.  Choices are: &quot;Gibbs&quot; for a Gibbs sampler developed in Escobar and West (1995), and &quot;MH&quot; for a Metropolis-Hastings sampler.
</p>
</td></tr>
<tr><td><code id="DPMCMC_+3A_output.clust.size">OUTPUT.CLUST.SIZE</code></td>
<td>

<p>If TRUE, output cluster sizes in MCMC iterations into an external file *_mcmc_size.out.
</p>
</td></tr>
<tr><td><code id="DPMCMC_+3A_print">PRINT</code></td>
<td>

<p>If TRUE, print intermediate values during an MCMC run onto the screen.  Used for debugging for small data sets.  
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The MCMC sampling step in <code><a href="#topic+DIRECT">DIRECT</a></code> is accomplished with <code>DPMCMC</code>.  <code>DPMCMC</code> generates MCMC samples of assignments to mixture components (number of components implicitly generated; written into external file *_mcmc_cs.out) and component-specific parameters (written into external file *_mcmc_pars.out), which include mean vectors and standard deviations of three types of variability.  
</p>


<h3>Value</h3>

<p>At least two files are generated by <code>DPMCMC</code> and placed under the current working directory:
</p>

<ol>
<li><p> *_mcmc_cs.out: Generated from MCMC sampling.  Each row contains an MCMC sample of assignments of items to mixture components, or cluster memberships if a component is defined as a cluster, as well as <code class="reqn">\alpha</code>, the concentration parameter in the Dirichlet-process prior.
</p>
</li>
<li><p> *_mcmc_pars.out: Generated from MCMC sampling.  Each row contains an MCMC sample of parameters specific to a mixture component.  Multiple rows may come from the same MCMC iteration.
</p>
</li></ol>

<p>If argument <code>OUTPUT.CLUST.SIZE=TRUE</code>, an additional file *_mcmc_size.out is also generated, which contains the cluster sizes of each recorded MCMC sample.
</p>


<h3>Author(s)</h3>

<p>Audrey Q. Fu
</p>


<h3>References</h3>

<p>Escobar, M. D. and West, M. (1995) Bayesian density estimation and inference using mixtures. Journal of the American Statistical Association, 90: 577-588. 
</p>
<p>Fu, A. Q., Russell, S., Bray, S. and Tavare, S. (2013) Bayesian clustering of replicated time-course gene expression data with weak signals. The Annals of Applied Statistics. 7(3) 1334-1361.
</p>
<p>Neal, R. M. (2000) Markov chain sampling methods for Dirichlet process mixture models. Journal of Computational and Graphical Statistics, 9: 249-265. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DIRECT">DIRECT</a></code>, which calls <code>DPMCMC</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## See example in DIRECT.
</code></pre>

<hr>
<h2 id='MVNorm'>
The Multivariate Normal Distribution
</h2><span id='topic+rMVNorm'></span><span id='topic+dMVNorm'></span>

<h3>Description</h3>

<p>Functions to compute the density of a multivariate normal distribution and to generate random realizations from such a distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dMVNorm (x, mean, sigma, log = FALSE)
rMVNorm (n, mean = rep(0, nrow(sigma)), sigma = diag(length(mean)),
         method=c("eigen", "svd", "chol"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MVNorm_+3A_x">x</code></td>
<td>
<p>Vector or matrix of quantiles. If <code>x</code> is a matrix, each
row is taken to be a quantile.</p>
</td></tr>
<tr><td><code id="MVNorm_+3A_n">n</code></td>
<td>
<p>Number of realizations.</p>
</td></tr>
<tr><td><code id="MVNorm_+3A_mean">mean</code></td>
<td>
<p>Mean vector, default is <code>rep(0, length = ncol(x))</code>.</p>
</td></tr>
<tr><td><code id="MVNorm_+3A_sigma">sigma</code></td>
<td>
<p>Covariance matrix, default is <code>diag(ncol(x))</code>.</p>
</td></tr>
<tr><td><code id="MVNorm_+3A_log">log</code></td>
<td>
<p>Logical; if <code>TRUE</code>, densities are log-transformed.</p>
</td></tr>
<tr><td><code id="MVNorm_+3A_method">method</code></td>
<td>
<p>Matrix decomposition used to determine the matrix root of
<code>sigma</code>, possible methods are eigenvalue decomposition
(<code>"eigen"</code>, default), singular value decomposition
(<code>"svd"</code>), and Cholesky decomposition (<code>"chol"</code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>rMVNorm</code> returns a vector of the same length as <code>mean</code> if <code>n</code>=1, or a matrix with each row being an independent realization otherwise.
</p>


<h3>Author(s)</h3>

<p>The code for both functions is taken from similar functions written by Friedrich Leisch and Fabian Scheipl in R package <code>mvtnorm</code>.  Audrey Q. Fu modified <code>dMVNorm</code> to use a different method to compute the matrix determinants.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
x &lt;- rMVNorm (10, mean=rep(0,3), method="svd")
dMVNorm (x, mean=rep(0,3), log=TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='outputData'>
Writing Simulation Parameters and Data to Files
</h2><span id='topic+outputData'></span>

<h3>Description</h3>

<p>Write simulation parameters and simulated data to files with user-specified filenames.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>outputData(datafilename, parfilename, meanfilename, 
    simudata, pars, nitem, ntime, nrep)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="outputData_+3A_datafilename">datafilename</code></td>
<td>

<p>Name of text file containing simulated data.
</p>
</td></tr>
<tr><td><code id="outputData_+3A_parfilename">parfilename</code></td>
<td>

<p>Name of text file containing simulation parameters, which include number of items, number of time points, number of replicates, true cluster-specific mean vectors, true standard deviations of three types of variability (random effects).
</p>
</td></tr>
<tr><td><code id="outputData_+3A_meanfilename">meanfilename</code></td>
<td>

<p>Name of text file containing sample means (averaged over replicates) of simulated data.
</p>
</td></tr>
<tr><td><code id="outputData_+3A_simudata">simudata</code></td>
<td>

<p>List produced by <code><a href="#topic+simuDataREM">simuDataREM</a></code>.  Contains simulated data.
</p>
</td></tr>
<tr><td><code id="outputData_+3A_pars">pars</code></td>
<td>

<p>Matrix of simulation parameters.  Same object as <code>pars.mtx</code> in <code><a href="#topic+simuDataREM">simuDataREM</a></code>.
</p>
</td></tr>
<tr><td><code id="outputData_+3A_nitem">nitem</code></td>
<td>

<p>Number of items.
</p>
</td></tr>
<tr><td><code id="outputData_+3A_ntime">ntime</code></td>
<td>

<p>Number of time points.
</p>
</td></tr>
<tr><td><code id="outputData_+3A_nrep">nrep</code></td>
<td>

<p>Number of replicates.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Three files are generated and placed under the current working directory or directories specified in filenames:
</p>

<ul>
<li><p> Complete simulated data: Matrix of <code>nitem</code> by <code>ntime</code>*<code>nrep</code>+1.  The first column contains the true cluster labels.  In the rest of the columns, data are stored as Replicates 1 through <code>nrep</code> at Time 1, Replicates 1 through <code>nrep</code> at Time 2, ..., Replicates 1 through <code>nrep</code> at Time <code>ntime</code>.
</p>
</li>
<li><p> Simulated mean data: Matrix of <code>nitem</code> by <code>ntime</code>.  Each row contains the sample means at Times 1 through <code>ntime</code>.
</p>
</li>
<li><p> Simulation parameters: 
</p>

<ul>
<li><p> First row: <code>nitem</code>.
</p>
</li>
<li><p> Second row: <code>ntime</code>.
</p>
</li>
<li><p> Third row: <code>nrep</code>.
</p>
</li>
<li><p> Rest of file: Matrix.  Each row corresponds to a cluster, and contains cluster label, true mean vector of length <code>ntime</code>, standard deviations of within-cluster variability, variability across time points and residual variability.
</p>
</li></ul>

</li></ul>



<h3>Author(s)</h3>

<p>Audrey Q. Fu
</p>


<h3>References</h3>

<p>Fu, A. Q., Russell, S., Bray, S. and Tavare, S. (2013) Bayesian clustering of replicated time-course gene expression data with weak signals. The Annals of Applied Statistics. 7(3) 1334-1361.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+simuDataREM">simuDataREM</a></code> for simulating data.
</p>
<p><code><a href="#topic+plotSimulation">plotSimulation</a></code> for plotting simulated data.
</p>
<p><code><a href="#topic+DIRECT">DIRECT</a></code> for clustering the data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## See example for simuDataREM.
</code></pre>

<hr>
<h2 id='plotClustersMean'>
Plotting Clustered Mean Vectors
</h2><span id='topic+plotClustersMean'></span>

<h3>Description</h3>

<p>Function <code>plotClustersMean</code> produces a plot of multiple panels.  Each panel displays for a inferred cluster the mean vectors of items allocated to this cluster, as well as the inferred cluster mean vector.  See figures in Fu, Russell, Bray and Tavare.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotClustersMean(data, data.summary, 
    SKIP, nTime = length(times), times = 1:nTime, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotClustersMean_+3A_data">data</code></td>
<td>

<p>An <code class="reqn">N \times JR</code> matrix of continuous values, or a data frame containing such a matrix.  <code class="reqn">N</code> is the number if items, <code class="reqn">J</code> the number of time points (or experimental conditions) and <code class="reqn">R</code> the number of replicates.  Each row contains values for Replicates 1 through <code class="reqn">R</code> under Condition 1, values for Replicates 1 through <code class="reqn">R</code> under Condition 2, and so on.
</p>
</td></tr>
<tr><td><code id="plotClustersMean_+3A_data.summary">data.summary</code></td>
<td>

<p>The list generated from <code><a href="#topic+summaryDIRECT">summaryDIRECT</a></code> that contains processed posterior estimates.
</p>
</td></tr>
<tr><td><code id="plotClustersMean_+3A_skip">SKIP</code></td>
<td>

<p>Number of columns in <code>data</code> to be skipped when processing the data.
</p>
</td></tr>
<tr><td><code id="plotClustersMean_+3A_ntime">nTime</code></td>
<td>

<p>Number of time points (or experimental conditions).
</p>
</td></tr>
<tr><td><code id="plotClustersMean_+3A_times">times</code></td>
<td>

<p>An integer vector of length <code>nTime</code>, indicating times (or experimental conditions).
</p>
</td></tr>
<tr><td><code id="plotClustersMean_+3A_...">...</code></td>
<td>

<p>Additional arguments for <code>plot</code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None.
</p>


<h3>Author(s)</h3>

<p>Audrey Q. Fu
</p>


<h3>References</h3>

<p>Fu, A. Q., Russell, S., Bray, S. and Tavare, S. (2013) Bayesian clustering of replicated time-course gene expression data with weak signals. The Annals of Applied Statistics. 7(3) 1334-1361.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+summaryDIRECT">summaryDIRECT</a></code> for processing MCMC estimates for clustering and generating the list <code>data.summary</code> used here.
</p>
<p><code><a href="#topic+plotClustersPCA">plotClustersPCA</a></code>, <code><a href="#topic+plotClustersSD">plotClustersSD</a></code>, <code><a href="#topic+plotSimulation">plotSimulation</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## See example in DIRECT.
</code></pre>

<hr>
<h2 id='plotClustersPCA'>
PCA Plot for Posterior Allocation Probability Matrix
</h2><span id='topic+plotClustersPCA'></span>

<h3>Description</h3>

<p>Function <code>plotClustersPCA</code> generates a Principal Components Analysis (PCA) plot for the posterior mean estimate of allocation probability matrix.  The first two principal components are used.  See figures in Fu, Russell, Bray and Tavare.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotClustersPCA(item.names, data.summary, 
    PCA.label.adj = -0.01, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotClustersPCA_+3A_item.names">item.names</code></td>
<td>

<p>A vector of character strings, indicating how each item should be labeled in the PCA plot.
</p>
</td></tr>
<tr><td><code id="plotClustersPCA_+3A_data.summary">data.summary</code></td>
<td>

<p>The list generated from <code><a href="#topic+summaryDIRECT">summaryDIRECT</a></code> that contains processed posterior estimates.
</p>
</td></tr>
<tr><td><code id="plotClustersPCA_+3A_pca.label.adj">PCA.label.adj</code></td>
<td>

<p>A scalar to be added to the coordinates of <code>item.names</code> for better display.
</p>
</td></tr>
<tr><td><code id="plotClustersPCA_+3A_...">...</code></td>
<td>

<p>Additional arguments for <code>plot</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The PCA plot produced here displays the uncertainty in the inferred clustering.  Each inferred cluster is shown with a distinct color.  The closer two clusters are in the PCA plot, the higher the level of uncertainty in inferring these two clusters.
</p>


<h3>Value</h3>

<p>None.
</p>


<h3>Author(s)</h3>

<p>Audrey Q. Fu
</p>


<h3>References</h3>

<p>Fu, A. Q., Russell, S., Bray, S. and Tavare, S. (2013) Bayesian clustering of replicated time-course gene expression data with weak signals. The Annals of Applied Statistics. 7(3) 1334-1361.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+summaryDIRECT">summaryDIRECT</a></code> for processing MCMC estimates for clustering and generating the list <code>data.summary</code> used here.
</p>
<p><code><a href="#topic+plotClustersMean">plotClustersMean</a></code>, <code><a href="#topic+plotClustersSD">plotClustersSD</a></code>, <code><a href="#topic+plotSimulation">plotSimulation</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## See example in DIRECT.
</code></pre>

<hr>
<h2 id='plotClustersSD'>
Plotting Posterior Estimates of Cluster-Specific Random Effects 
</h2><span id='topic+plotClustersSD'></span>

<h3>Description</h3>

<p>Function <code>plotClustersSD</code> displays in a single plot the posterior estimates of cluster-specific standard deviations of the three types of variability (random effects) under the DIRECT model.  See figures in Fu et al. (2013).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotClustersSD(data.summary, nTime, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotClustersSD_+3A_data.summary">data.summary</code></td>
<td>

<p>The list generated from <code><a href="#topic+summaryDIRECT">summaryDIRECT</a></code> that contains processed posterior estimates.
</p>
</td></tr>
<tr><td><code id="plotClustersSD_+3A_ntime">nTime</code></td>
<td>

<p>Number of time points (or experimental conditions).
</p>
</td></tr>
<tr><td><code id="plotClustersSD_+3A_...">...</code></td>
<td>

<p>Additional arguments for <code>plot</code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None.
</p>


<h3>Author(s)</h3>

<p>Audrey Q. Fu
</p>


<h3>References</h3>

<p>Fu, A. Q., Russell, S., Bray, S. and Tavare, S. (2013) Bayesian clustering of replicated time-course gene expression data with weak signals. The Annals of Applied Statistics. 7(3) 1334-1361.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+summaryDIRECT">summaryDIRECT</a></code> for processing MCMC estimates for clustering and generating the list <code>data.summary</code> used here.
</p>
<p><code><a href="#topic+plotClustersPCA">plotClustersPCA</a></code>, <code><a href="#topic+plotClustersPCA">plotClustersPCA</a></code>, <code><a href="#topic+plotSimulation">plotSimulation</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## See example in DIRECT.
</code></pre>

<hr>
<h2 id='plotSimulation'>
Plotting Data Simulated Under A Random-Effects Mixture Model</h2><span id='topic+plotSimulation'></span>

<h3>Description</h3>

<p>Function <code>plotSimulation</code> displays sample means of data simulated under a random-effects mixture model.  Each plot  corresponds to a cluster.  May need to partition the plotting area to display all in one plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotSimulation(simudata, times = 1:ntime, nsize, 
    ntime = length(times), nrep, skip = 0, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotSimulation_+3A_simudata">simudata</code></td>
<td>

<p>List produced by <code><a href="#topic+simuDataREM">simuDataREM</a></code>.  Contains simulated data.
</p>
</td></tr>
<tr><td><code id="plotSimulation_+3A_times">times</code></td>
<td>

<p>Vector of length <code>ntime</code> indicating at which time points data are simulated.
</p>
</td></tr>
<tr><td><code id="plotSimulation_+3A_nsize">nsize</code></td>
<td>

<p>An integer vector containing sizes of simulated clusters.
</p>
</td></tr>
<tr><td><code id="plotSimulation_+3A_ntime">ntime</code></td>
<td>

<p>Number of time points.
</p>
</td></tr>
<tr><td><code id="plotSimulation_+3A_nrep">nrep</code></td>
<td>

<p>Number of replicates.
</p>
</td></tr>
<tr><td><code id="plotSimulation_+3A_skip">skip</code></td>
<td>

<p>Not for use.
</p>
</td></tr>
<tr><td><code id="plotSimulation_+3A_...">...</code></td>
<td>

<p>Addition arguments for <code>plot</code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None.
</p>


<h3>Author(s)</h3>

<p>Audrey Q. Fu
</p>


<h3>References</h3>

<p>Fu, A. Q., Russell, S., Bray, S. and Tavare, S. (2013) Bayesian clustering of replicated time-course gene expression data with weak signals. The Annals of Applied Statistics. 7(3) 1334-1361.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+simuDataREM">simuDataREM</a></code> for simulating data.
</p>
<p><code><a href="#topic+outputData">outputData</a></code> for writing simulated data and parameter values used in simulation into external files.
</p>
<p><code><a href="#topic+DIRECT">DIRECT</a></code> for clustering the data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## See example for simuDataREM.
</code></pre>

<hr>
<h2 id='relabel'>
A Relabel Algorithm 
</h2><span id='topic+relabel'></span>

<h3>Description</h3>

<p>Function <code>relabel</code> implements Algorithm 2 in Matthew Stephens (2000) JRSSB for the posterior allocation probability matrix, minimizing the Kullback-Leibler distance.  Step 2 in this algorithm is solved using the Hungarian (Munkres) algorithm to the assignment problem.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>relabel(probs.mcmc, nIter, nItem, nClust, 
    RELABEL.THRESHOLD, PRINT = 0, PACKAGE="DIRECT")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="relabel_+3A_probs.mcmc">probs.mcmc</code></td>
<td>

<p>A <code>nItem</code>*<code>nIter</code>-by-<code>nClust</code> matrix of samples of the posterior allocation probability matrix stored in file *_mcmc_probs.out generated by <code><a href="#topic+resampleClusterProb">resampleClusterProb</a></code>.
</p>
</td></tr>
<tr><td><code id="relabel_+3A_niter">nIter</code></td>
<td>

<p>Number of stored MCMC samples.
</p>
</td></tr>
<tr><td><code id="relabel_+3A_nitem">nItem</code></td>
<td>

<p>Number of items.
</p>
</td></tr>
<tr><td><code id="relabel_+3A_nclust">nClust</code></td>
<td>

<p>Number of inferred clusters.
</p>
</td></tr>
<tr><td><code id="relabel_+3A_relabel.threshold">RELABEL.THRESHOLD</code></td>
<td>

<p>A positive scalar.  Used to determine whether the optimization in the relabeling algorithm has converged.  
</p>
</td></tr>
<tr><td><code id="relabel_+3A_print">PRINT</code></td>
<td>

<p>If TRUE, print intermediate values onto the screen.  Used for debugging with small data sets.  
</p>
</td></tr>
<tr><td><code id="relabel_+3A_package">PACKAGE</code></td>
<td>

<p>Not for use.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Permuted labels for each store MCMC sample are written to file *_mcmc_perms.out, in which each row contains an inferred permutation (relabel) of labels of mixture components.
</p>


<h3>Note</h3>

<p>This function calls a routine written in C, where implementation of Munkres algorithm is adapted from the C code by Dariush Lotfi (June 2008; web download).
</p>


<h3>Author(s)</h3>

<p>Audrey Q. Fu
</p>


<h3>References</h3>

<p>Fu, A. Q., Russell, S., Bray, S. and Tavare, S. (2013) Bayesian clustering of replicated time-course gene expression data with weak signals. The Annals of Applied Statistics. 7(3) 1334-1361.
</p>
<p>Stephens, M. (2000) Dealing with label switching in mixture models. Journal of the Royal Statistical Society, Series B, 62: 795-809.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DIRECT">DIRECT</a></code> for the complete method.
</p>
<p><code><a href="#topic+DPMCMC">DPMCMC</a></code> for the MCMC sampler under the Dirichlet-process prior.
</p>
<p><code><a href="#topic+resampleClusterProb">resampleClusterProb</a></code> for resampling of posterior allocation probability matrix in posterior inference.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## See example for DIRECT.
</code></pre>

<hr>
<h2 id='resampleClusterProb'>
Resampling to Estimate Posterior Allocation Probability Matrix 
</h2><span id='topic+resampleClusterProb'></span>

<h3>Description</h3>

<p>The resampling method as part of the posterior inference under <code><a href="#topic+DIRECT">DIRECT</a></code>.  It uses stored MCMC samples to generate realizations of the allocation probability matrix, and writes the realizations to a user-specified external file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>resampleClusterProb(file.out, ts, nitem, ntime, nrep, 
    pars.mcmc, cs.mcmc, alpha.mcmc, nstart, nres)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="resampleClusterProb_+3A_file.out">file.out</code></td>
<td>

<p>Name of file containing samples of posterior allocation probability matrix.
</p>
</td></tr>
<tr><td><code id="resampleClusterProb_+3A_ts">ts</code></td>
<td>

<p>A <code>nitem</code>-by-<code>ntime</code>-by-<code>nrep</code> array of data.
</p>
</td></tr>
<tr><td><code id="resampleClusterProb_+3A_nitem">nitem</code></td>
<td>

<p>Number of items.
</p>
</td></tr>
<tr><td><code id="resampleClusterProb_+3A_ntime">ntime</code></td>
<td>

<p>Number of time points.
</p>
</td></tr>
<tr><td><code id="resampleClusterProb_+3A_nrep">nrep</code></td>
<td>

<p>Number of replicates.
</p>
</td></tr>
<tr><td><code id="resampleClusterProb_+3A_pars.mcmc">pars.mcmc</code></td>
<td>

<p>A matrix or data frame of MCMC samples of mean vectors and random effects stored in file *_mcmc_pars.out, one of the output files from <code><a href="#topic+DPMCMC">DPMCMC</a></code>.
</p>
</td></tr>
<tr><td><code id="resampleClusterProb_+3A_cs.mcmc">cs.mcmc</code></td>
<td>

<p>A matrix or data frame of MCMC samples of assignments of mixture components stored in file *_mcmc_cs.out, one of the output files from <code><a href="#topic+DPMCMC">DPMCMC</a></code>.
</p>
</td></tr>
<tr><td><code id="resampleClusterProb_+3A_alpha.mcmc">alpha.mcmc</code></td>
<td>

<p>A vector of MCMC samples of <code class="reqn">\alpha</code>, the concentration parameter in the Dirichlet-process prior, stored in the last column of file *_mcmc_cs.out, one of the output files from <code><a href="#topic+DPMCMC">DPMCMC</a></code>.
</p>
</td></tr>
<tr><td><code id="resampleClusterProb_+3A_nstart">nstart</code></td>
<td>

<p>Starting from which recorded MCMC sample.
</p>
</td></tr>
<tr><td><code id="resampleClusterProb_+3A_nres">nres</code></td>
<td>

<p>How many times to draw resamples?  Multiple samples are averaged.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Samples of the allocation probability matrix are written to file *_mcmc_probs.out.  This file contains a large matrix of <code class="reqn">HN \times K</code>, which is <code class="reqn">H</code> posterior allocation probability matrices stacked up, each individual matrix of <code class="reqn">N \times K</code>, where <code class="reqn">H</code> is the number of recorded MCMC samples, <code class="reqn">N</code> the number of items and <code class="reqn">K</code> the inferred number of mixture components.</p>


<h3>Note</h3>

<p><code>resampleClusterProb</code> calls the following functions adapted or directly taken from existing R functions:
</p>

<ul>
<li> <p><code>dMVNorm</code> is adapted from <code>dmvnorm</code> by Friedrich Leisch and Fabian Scheipl in package <code>mvtnorm</code>.
</p>
</li>
<li> <p><code>rMVNorm</code> is adapted from <code>rmvnorm</code> by Friedrich Leisch and Fabian Scheipl in package <code>mvtnorm</code>.
</p>
</li>
<li> <p><code>rDirichlet</code> is taken from <code>rdirichlet</code> by Gregory R. Warnes, Ben Bolker and Ian Wilson in package <code>gregmisc</code>.
</p>
</li>
<li> <p><code>dDirichlet</code> is based on <code>ddirichlet</code> by Gregory R. Warnes, Ben Bolker and Ian Wilson in package <code>gregmisc</code>.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Audrey Q. Fu
</p>


<h3>References</h3>

<p>Fu, A. Q., Russell, S., Bray, S. and Tavare, S. (2013) Bayesian clustering of replicated time-course gene expression data with weak signals. The Annals of Applied Statistics. 7(3) 1334-1361.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DIRECT">DIRECT</a></code> for the complete method.
</p>
<p><code><a href="#topic+DPMCMC">DPMCMC</a></code> for the MCMC sampler under the Dirichlet-process prior.
</p>
<p><code><a href="#topic+relabel">relabel</a></code> for relabeling in posterior inference.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## See example for DIRECT.
</code></pre>

<hr>
<h2 id='simuDataREM'>
Data Simulation Under the Random-Effects Mixture Model
</h2><span id='topic+simuDataREM'></span>

<h3>Description</h3>

<p>Function <code>simuDataREM</code> simulates data under the Ornstein-Uhlenbeck (OU) (or Brownian Motion; BM) process-based random-effects mixture (REM) model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simuDataREM(pars.mtx, dt, T, ntime, nrep, nsize, times, 
    method = c("eigen", "svd", "chol"), model = c("OU", "BM"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simuDataREM_+3A_pars.mtx">pars.mtx</code></td>
<td>

<p>A <code class="reqn">K \times 8</code> matrix, where <code class="reqn">K</code> is the number of clusters.  Each row contains 8 parameters: standard deviation of within-cluster variability, of variability across time points, and of replicates, respectively; mean and standard deviation for the value at the first time point; the overall mean, standard deviation and mean-reverting rate of the OU process.
</p>
</td></tr>
<tr><td><code id="simuDataREM_+3A_dt">dt</code></td>
<td>

<p>Increment in times.
</p>
</td></tr>
<tr><td><code id="simuDataREM_+3A_t">T</code></td>
<td>

<p>Maximum time.
</p>
</td></tr>
<tr><td><code id="simuDataREM_+3A_ntime">ntime</code></td>
<td>

<p>Number of time points to simulate data for.  Needs to be same as the length of vector <code>times</code>.
</p>
</td></tr>
<tr><td><code id="simuDataREM_+3A_nrep">nrep</code></td>
<td>

<p>Number of replicates.
</p>
</td></tr>
<tr><td><code id="simuDataREM_+3A_nsize">nsize</code></td>
<td>

<p>An integer vector containing sizes of simulated clusters.
</p>
</td></tr>
<tr><td><code id="simuDataREM_+3A_times">times</code></td>
<td>

<p>Vector of length <code>ntime</code> indicating at which time points to simulate data.
</p>
</td></tr>
<tr><td><code id="simuDataREM_+3A_method">method</code></td>
<td>

<p>Method to compute the determinant of the covariance matrix in the calculation of the multivariate normal density.  Required.  Method choices are: &quot;chol&quot; for Choleski decomposition, &quot;eigen&quot; for eigenvalue decomposition, and &quot;svd&quot; for singular value decomposition.
</p>
</td></tr>
<tr><td><code id="simuDataREM_+3A_model">model</code></td>
<td>

<p>Model to generate realizations of the mean vector of a mixture component.  Required.  Choices are: &quot;OU&quot; for an Ornstein-Uhlenbeck process (a.k.a. the mean-reverting process) and &quot;BM&quot; for a Brown motion (without drift).
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>means</code></td>
<td>

<p>A matrix of <code>ntime</code> columns.  The number of rows is the same as that of <code>pars.mtx</code>, which is the number of clusters.  Each row contains the true mean vector of the corresponding cluster.
</p>
</td></tr>
<tr><td><code>data</code></td>
<td>

<p>A matrix of <code class="reqn">N</code> rows and <code>ntime</code>*<code>nrep</code>+1 columns, where <code class="reqn">N</code> is the sum of cluster sizes <code>nsize</code>.  The first column contains the true cluster membership of the corresponding item.  The rest of the columns in each row is formatted as follows: values for replicate 1 through <code>nrep</code> at time 1; values for replicate 1 through <code>nrep</code> at time 2, ...
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Audrey Q. Fu
</p>


<h3>References</h3>

<p>Fu, A. Q., Russell, S., Bray, S. and Tavare, S. (2013) Bayesian clustering of replicated time-course gene expression data with weak signals. The Annals of Applied Statistics. 7(3) 1334-1361.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plotSimulation">plotSimulation</a></code> for plotting simulated data.
</p>
<p><code><a href="#topic+outputData">outputData</a></code> for writing simulated data and parameter values used in simulation into external files.
</p>
<p><code><a href="#topic+DIRECT">DIRECT</a></code> for clustering the data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Simulate replicated time-course gene expression profiles
# from OU processes

# Simulation parameters
times = c(0,5,10,15,20,25,30,35,40,50,60,70,80,90,100,110,120,150)
ntime=length (times)
nrep=4

nclust = 6
npars = 8
pars.mtx = matrix (0, nrow=nclust, ncol=npars)
# late weak upregulation or downregulation
pars.mtx[1,] = c(0.05, 0.1, 0.5, 0, 0.16, 0.1, 0.4, 0.05)		
# repression
pars.mtx[2,] = c(0.05, 0.1, 0.5, 1, 0.16, -1.0, 0.1, 0.05)	        
# early strong upregulation
pars.mtx[3,] = c(0.05, 0.5, 0.2, 0, 0.16, 2.5, 0.4, 0.15)	        
# strong repression
pars.mtx[4,] = c(0.05, 0.5, 0.2, 1, 0.16, -1.5, 0.4, 0.1)	        
# low upregulation
pars.mtx[5,] = c(0.05, 0.3, 0.3, -0.5, 0.16, 0.5, 0.2, 0.08)		
# late strong upregulation
pars.mtx[6,] = c(0.05, 0.3, 0.3, -0.5, 0.16, 0.1, 1, 0.1)	        

nsize = rep(40, nclust)

# Generate data
simudata = simuDataREM (pars=pars.mtx, dt=1, T=150, 
    ntime=ntime, nrep=nrep, nsize=nsize, times=times, method="svd", model="OU")

# Display simulated data
plotSimulation (simudata, times=times, 
    nsize=nsize, nrep=nrep, lty=1, ylim=c(-4,4), type="l", col="black")

# Write simulation parameters and simulated data
# to external files
outputData (datafilename= "simu_test.dat", parfilename= "simu_test.par", 
    meanfilename= "simu_test_mean.dat", simudata=simudata, pars=pars.mtx, 
    nitem=sum(nsize), ntime=ntime, nrep=nrep)

## End(Not run)
</code></pre>

<hr>
<h2 id='summaryDIRECT'>
Processing Posterior Estimates for Clustering Under DIRECT
</h2><span id='topic+summaryDIRECT'></span>

<h3>Description</h3>

<p>Function <code>summaryDIRECT</code> processes posterior estimates in the output files from <code><a href="#topic+DIRECT">DIRECT</a></code> for clustering and parameter estimation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>summaryDIRECT(data.name, PERM.ADJUST = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summaryDIRECT_+3A_data.name">data.name</code></td>
<td>

<p>A character string indicating the prefix of output files.  
</p>
</td></tr>
<tr><td><code id="summaryDIRECT_+3A_perm.adjust">PERM.ADJUST</code></td>
<td>

<p>If TRUE, add 1 to labels of mixture components such that the labels start from 1 instead of 0.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Output files from <code><a href="#topic+DIRECT">DIRECT</a></code> include MCMC samples before relabeling and permuted labels of mixture components after relabeling.  Function <code>summaryDIRECT</code> uses permuted labels stored in output file *_mcmc_perms.out to reorganize the MCMC samples stored in other output files *_mcmc_cs.out, *_mcmc_pars.out and *_mcmc_probs.out.  It defines each mixture component as a cluster.
</p>


<h3>Value</h3>

<p>A list with components:
</p>
<table>
<tr><td><code>nitem</code></td>
<td>

<p>The number of items in the data.
</p>
</td></tr>
<tr><td><code>nclust</code></td>
<td>

<p>The number of inferred clusters.
</p>
</td></tr>
<tr><td><code>top.clust.alloc</code></td>
<td>

<p>A vector of length <code>nitem</code>, each component being the maximum posterior probability of allocating the corresponding item to a cluster.
</p>
</td></tr>
<tr><td><code>cluster.sizes</code></td>
<td>

<p>Vector of cluster sizes.
</p>
</td></tr>
<tr><td><code>top.clust.labels</code></td>
<td>

<p>An integer vector of labels of inferred clusters.  The integers are not necessarily consecutive; that is, an inferred mixture component that is associated with items at small posterior allocation probabilities is dropped from the final list of cluster labels.
</p>
</td></tr>
<tr><td><code>top2allocations</code></td>
<td>

<p>A data frame containing &quot;first&quot;, the most likely allocation; &quot;second&quot;, the second most likely allocation; &quot;prob1&quot;, the posterior allocation probability associated with &quot;first&quot;; and &quot;prob2&quot;, the posterior allocation probability associated with &quot;second&quot;.
</p>
</td></tr>
<tr><td><code>post.alloc.probs</code></td>
<td>

<p>A <code>nitem</code>-by-<code>nclust</code> matrix of mean posterior allocation probability matrix.
</p>
</td></tr>
<tr><td><code>post.clust.pars.mean</code></td>
<td>

<p>A matrix of <code>nclust</code> rows.  Each row, corresponding to an inferred cluster, contains the posterior mean estimates of cluster-specific parameters.
</p>
</td></tr>
<tr><td><code>post.clust.pars.median</code></td>
<td>

<p>A matrix of <code>nclust</code> rows.  Each row, corresponding to an inferred cluster, contains the posterior median estimates of cluster-specific parameters.
</p>
</td></tr>
<tr><td><code>misc</code></td>
<td>
<p>A list containing two components:
</p>

<ul>
<li> <p><code>post.pars.mean</code>: Matrix each row of which contains the posterior mean estimates of parameters for a mixture component.
</p>
</li>
<li> <p><code>post.pars.median</code>: Matrix each row of which contains the posterior median estimates of parameters for a mixture component. 
</p>
</li></ul>

</td></tr>
</table>


<h3>Author(s)</h3>

<p>Audrey Q. Fu
</p>


<h3>References</h3>

<p>Fu, A. Q., Russell, S., Bray, S. and Tavare, S. (2013) Bayesian clustering of replicated time-course gene expression data with weak signals. The Annals of Applied Statistics. 7(3) 1334-1361.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DIRECT">DIRECT</a></code> for what output files are produced.
</p>
<p><code><a href="#topic+simuDataREM">simuDataREM</a></code> for simulating data under the mixture random-effects model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## See example in DIRECT.
</code></pre>

<hr>
<h2 id='tc.data'>
Time-Course Microarray Gene Expression Data
</h2><span id='topic+tc.data'></span>

<h3>Description</h3>

<p>This data set contains quantile-normalized microarray gene expression measurements of 163 genes from four replicates at 18 time points.  These data are part of the time-course experiment performed on Drosophila with a 5-min pulse of Notch activation (Housden et al. 2013).  The experiment was carried out by Sarah Bray, Ben Housden, Alena Krejci and Bettina Fischer; see details in Housden et al. (2013).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(tc.data)</code></pre>


<h3>Format</h3>

<p>A data frame with 163 observations on the 74 variables.  The first two variables are <code>GeneID</code> and <code>GeneName</code>.
</p>
<p>Other variables are log2 fold change of treated cells over control cells for 4 biological replicates at 18 time points.  They are organized as follows: values for replicates 1 through 4 at time 1; values for replicates 1 through 4 at time 2; and so on.
</p>


<h3>Details</h3>

<p>The 18 time points are (in min):
</p>
<p>0,5,10,15,20,25,30,35,40,50,60,70,80,90,100,110,120,150.
</p>
<p>Microarray data have been cleaned and normalized.  Missing values are imputed.  See supplementary material for Fu, Russell, Bray and Tavare for detail on data pre-processing and missing value imputation.
</p>


<h3>References</h3>

<p>Fu, A. Q., Russell, S., Bray, S. and Tavare, S. (2013) Bayesian clustering of replicated time-course gene expression data with weak signals.  The Annals of Applied Statistics. 7(3) 1334-1361.  
</p>
<p>Housden, B. E., Fu, A. Q., Krejci, A., Bernard, F., Fischer, B., Tavare, S., Russell, S. and Bray, S. J. (2013)  Transcriptional dynamics elicited by a short pulse of Notch activation involves feed-forward regulation by E(spl)/Hes genes. PLoS Genetics 9 1 e1003162.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Compute mean profiles for genes
# and plot the means as a heatmap with the color scale on the side

library (fields)	# to use function image.plot

data (tc.data)
times = c(0,5,10,15,20,25,30,35,40,50,60,70,80,90,100,110,120,150)

# Organize data into array of nGene-by-nTime-by-nRep
SKIP=2
nTime=length (times)
nGene = nrow (tc.data)
nRep = (ncol (tc.data) - SKIP) / nTime

ts = array (0, dim = c(nGene, nTime, nRep))
for (r in 1:nRep) {
    ts[,,r] = as.matrix (tc.data[,SKIP + (0:(nTime-1))*nRep + r])
}

# Compute mean profile for each gene
ts.mean = apply (ts, c(1,2), mean)

# Plot heatmap for mean profiles
image.plot (1:nGene, times, as.matrix(ts.mean), 
    xlab="gene", ylab="time (min)", 
    cex=1.5, cex.axis = 1.6, cex.lab = 1.6, 
    legend.shrink=1, legend.width=2, col=topo.colors(8))

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
