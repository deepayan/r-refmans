<!DOCTYPE html><html><head><title>Help for package argosfilter</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {argosfilter}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bearing'><p>Bearing between geographical locations</p></a></li>
<li><a href='#dist.next'>
<p>Internal function for package argosfilter</p></a></li>
<li><a href='#dist.prev'>
<p>Internal function for package argosfilter</p></a></li>
<li><a href='#distance'>
<p>Great circle distance between geographical coordinates</p></a></li>
<li><a href='#distance_m'>
<p>Internal function for package argosfilter</p></a></li>
<li><a href='#internal.angles'>
<p>Internal function for package argosfilter</p></a></li>
<li><a href='#radian'><p>Degrees to radians</p></a></li>
<li><a href='#sdafilter'><p>Filter Argos locations</p></a></li>
<li><a href='#seal'><p>Satellite tracking data from a ringed seal</p></a></li>
<li><a href='#vmask'><p>Filter locations for speed</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>0.70</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-09-12</td>
</tr>
<tr>
<td>Title:</td>
<td>Argos Locations Filter</td>
</tr>
<tr>
<td>Author:</td>
<td>Carla Freitas [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Carla Freitas &lt;carla.freitas.brandt@hi.no&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Filters animal satellite tracking data obtained from the Argos system(<a href="https://www.argos-system.org/">https://www.argos-system.org/</a>), following the algorithm described in Freitas et al (2008) &lt;<a href="https://doi.org/10.1111%2Fj.1748-7692.2007.00180.x">doi:10.1111/j.1748-7692.2007.00180.x</a>&gt;. It is especially indicated for telemetry studies of marine animals, where Argos locations are predominantly of low-quality.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-09-12 14:26:08 UTC; a22070</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-09-13 11:10:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='bearing'>Bearing between geographical locations</h2><span id='topic+bearing'></span><span id='topic+bearingTrack'></span>

<h3>Description</h3>

<p>Function <code>bearing</code> calculates the bearing, in degrees, between two geographical locations.
Function <code>bearingTrack</code> calculates the bearing between a sequence of locations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bearing(lat1, lat2, lon1, lon2)
bearingTrack(lat, lon)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bearing_+3A_lat1">lat1</code></td>
<td>
<p>latitude of the first location, in decimal degrees</p>
</td></tr>
<tr><td><code id="bearing_+3A_lat2">lat2</code></td>
<td>
<p>latitude of the second location, in decimal degrees</p>
</td></tr>
<tr><td><code id="bearing_+3A_lon1">lon1</code></td>
<td>
<p>longitude of the first location, in decimal degrees</p>
</td></tr>
<tr><td><code id="bearing_+3A_lon2">lon2</code></td>
<td>
<p>longitude of the second location, in decimal degrees</p>
</td></tr>
<tr><td><code id="bearing_+3A_lat">lat</code></td>
<td>
<p>vector of latitudes, in decimal degrees</p>
</td></tr>
<tr><td><code id="bearing_+3A_lon">lon</code></td>
<td>
<p>vector of longitudes, in decimal degrees</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Bearings are calculated using spherical trigonometry. Formulas are given in
Zwillinger (2003).
</p>


<h3>Value</h3>

<p><code>bearing</code> returns the bearing, in degrees, between the first location and
the second location. 0 is North. <code>bearingTrack</code> returns a vector of bearings between the sequence 
of locations.
</p>


<h3>Author(s)</h3>

<p>Carla Freitas</p>


<h3>References</h3>

<p>Zwillinger D. (2003) <em>Standard Mathematical Tables and Formulae</em>, 31st edition. 
Chapman &amp; Hall/CRC, Boca Raton, FL.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+distance">distance</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'># Bearing between two geographical locations:
lat1&lt;-rnorm(1,80)
lat2&lt;-rnorm(1,80)
lon1&lt;-rnorm(1,20)
lon2&lt;-rnorm(1,20)
bearing(lat1,lat2,lon1,lon2)

# Bearing between a sequence of 10 geographical locations:
lat&lt;-rnorm(10,80)
lon&lt;-rnorm(10,20)
bearingTrack(lat,lon)
</code></pre>

<hr>
<h2 id='dist.next'>
Internal function for package argosfilter
</h2><span id='topic+dist.next'></span>

<h3>Description</h3>

<p>Internal function for package <code>argosfilter</code>
</p>


<h3>Details</h3>

<p>This function is not to be called by the user.
</p>


<h3>Value</h3>

<p>No return value
</p>

<hr>
<h2 id='dist.prev'>
Internal function for package argosfilter
</h2><span id='topic+dist.prev'></span>

<h3>Description</h3>

<p>Internal function for package <code>argosfilter</code>
</p>


<h3>Details</h3>

<p>This function is not to be called by the user.
</p>


<h3>Value</h3>

<p>No return value
</p>

<hr>
<h2 id='distance'>
Great circle distance between geographical coordinates
</h2><span id='topic+distance'></span><span id='topic+distanceTrack'></span>

<h3>Description</h3>

<p>Function <code>distance</code> calculates the distance, in km, between two geographical locations
following the great circle route.
Function <code>distanceTrack</code> calculates the distance, in km, between a sequence of locations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>distance(lat1, lat2, lon1, lon2)
distanceTrack(lat,lon)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="distance_+3A_lat1">lat1</code></td>
<td>
<p> latitude of the first location, in decimal degrees</p>
</td></tr>
<tr><td><code id="distance_+3A_lat2">lat2</code></td>
<td>
<p> latitude of the second location, in decimal degrees</p>
</td></tr>
<tr><td><code id="distance_+3A_lon1">lon1</code></td>
<td>
<p> longitude of the first location, in decimal degrees</p>
</td></tr>
<tr><td><code id="distance_+3A_lon2">lon2</code></td>
<td>
<p> longitude of the second location, in decimal degrees</p>
</td></tr>
<tr><td><code id="distance_+3A_lat">lat</code></td>
<td>
<p>vector of latitudes, in decimal degrees</p>
</td></tr>
<tr><td><code id="distance_+3A_lon">lon</code></td>
<td>
<p>vector of longitudes, in decimal degrees</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Distances are calculated using spherical trigonometry. See details on formulae in Zwillinger (2003).
</p>


<h3>Value</h3>

<p><code>distance</code> returns the distance between the two locations. 
<code>distanceTrack</code> returns a vector of distances between the sequence of locations.
In both cases, distances are given in km.
</p>


<h3>Author(s)</h3>

<p>Carla Freitas</p>


<h3>References</h3>

<p>Zwillinger D. (2003) <em>Standard Mathematical Tables and Formulae</em>, 31st edition. 
Chapman &amp; Hall/CRC, Boca Raton, FL.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bearing">bearing</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'># Distance between two geographical locations
lat1&lt;-rnorm(1,80)
lon1&lt;-rnorm(1,20)
lat2&lt;-rnorm(1,80)
lon2&lt;-rnorm(1,20)
distance(lat1,lat2,lon1,lon2)

# Distance between a sequence of 10 geographical locations:
lat&lt;-rnorm(10,80)
lon&lt;-rnorm(10,20)
distanceTrack(lat,lon)
</code></pre>

<hr>
<h2 id='distance_m'>
Internal function for package argosfilter
</h2><span id='topic+distance_m'></span>

<h3>Description</h3>

<p>Internal function for package <code>argosfilter</code>
</p>


<h3>Details</h3>

<p>This function is not to be called by the user.
</p>


<h3>Value</h3>

<p>No return value
</p>

<hr>
<h2 id='internal.angles'>
Internal function for package argosfilter
</h2><span id='topic+internal.angles'></span>

<h3>Description</h3>

<p>Internal function for package <code>argosfilter</code>
</p>


<h3>Details</h3>

<p>This function is not to be called by the user.
</p>


<h3>Value</h3>

<p>No return value
</p>

<hr>
<h2 id='radian'>Degrees to radians</h2><span id='topic+radian'></span>

<h3>Description</h3>

<p>Converts degrees to radians</p>


<h3>Usage</h3>

<pre><code class='language-R'>radian(degree)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="radian_+3A_degree">degree</code></td>
<td>
<p>vector of values in degrees</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a vector of values in radians.
</p>


<h3>Author(s)</h3>

<p>Carla Freitas</p>


<h3>Examples</h3>

<pre><code class='language-R'># Convert latitudes and longitudes from decimal degrees to radians
lat&lt;-rnorm(10,80)
lon&lt;-rnorm(10,20)
lat_rad&lt;-radian(lat)
lon_rad&lt;-radian(lon)
</code></pre>

<hr>
<h2 id='sdafilter'>Filter Argos locations</h2><span id='topic+sdafilter'></span>

<h3>Description</h3>

<p>This function filters location data obtained from Argos, using the Freitas et al. (2008) algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sdafilter(lat, lon, dtime, lc, vmax = 2, ang = c(15, 25), distlim = c(2500, 5000))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sdafilter_+3A_lat">lat</code></td>
<td>
<p> a numeric vector of latitudes, in decimal degrees</p>
</td></tr>
<tr><td><code id="sdafilter_+3A_lon">lon</code></td>
<td>
<p> a numeric vector of longitudes, in decimal degrees</p>
</td></tr>
<tr><td><code id="sdafilter_+3A_dtime">dtime</code></td>
<td>
<p> a vector of class POSIXct with date and time for each location</p>
</td></tr>
<tr><td><code id="sdafilter_+3A_lc">lc</code></td>
<td>
<p> a numeric or character vector of Argos location classes. Argos locations Z can be entered as &quot;Z&quot;, &quot;z&quot; or -9</p>
</td></tr>
<tr><td><code id="sdafilter_+3A_vmax">vmax</code></td>
<td>
<p> speed threshold, in m/s. Default is 2 m/s</p>
</td></tr>
<tr><td><code id="sdafilter_+3A_ang">ang</code></td>
<td>
<p> angles of the spikes to be removed. Default is c(15,25). No spikes are removed if <code>ang</code>=-1</p>
</td></tr>
<tr><td><code id="sdafilter_+3A_distlim">distlim</code></td>
<td>
<p> lengths of the above spikes, in meters. Default is c(2500,5000)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Locations are filtered using the algorithm described in Freitas et al. (2008).
The algorithm first removes all locations with location class Z (-9), which are
the points for which the location process failed. Then all locations requiring
unrealistic swimming speeds are removed, using the MacConnell et al. (1992) algorithm,
unless the point is located at less than 5 km from the previous location. This procedure enables retaining
good quality locations for which high swimming speeds result from location being taken
very close to each other in time. The default maximum speed threshold is 2 m/s. 
The last step is optional, and enables to remove
unlikely spikes from the animal's path. The angles of the spikes should be specified
in <code>ang</code>, and their respective length in <code>distlim</code>. The default
is c(15,25) for <code>ang</code> and c(2500,5000) for <code>distlim</code>, meaning that all spikes
with angles smaller than 15 and 25 degrees will be removed if their extension is higher than
2500 m and 5000 m respectively. No spikes are removed if <code>ang</code>=-1. <code>ang</code>
and <code>distlim</code> vectors must have the same length.
</p>


<h3>Value</h3>

<p>Returns a vector with the following elements: <code>"removed"</code> (location removed by the filter),
<code>"not"</code> (location not removed) and <code>"end_location"</code> (location at the end
of the track where the algorithm could not be applied).
</p>


<h3>Author(s)</h3>

<p>Carla Freitas, with contributions from Anne Goarant and Catriona MacLeod</p>


<h3>References</h3>

<p>Freitas, C., Lydersen, C., Ims, R.A., Fedak, M.A. and Kovacs, K.M. (2008) A simple new 
algorithm to filter marine mammal Argos locations <em>Marine Mammal Science</em> 24:315-325.
</p>
<p>McConnell, B.J., Chambers, C. and Fedak, M.A. (1992) Foraging ecology of southern
elephant seals in relation to the bathymetry and productivity of the Southern Ocean.
<em>Antarctic Science</em> 4:393-398.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+vmask">vmask</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(seal)
lat&lt;-seal$lat
lon&lt;-seal$lon
dtime&lt;-seal$dtime
lc&lt;-seal$lc

# plot unfiltered data
plot(lon,lat,col="lightgrey",type="l",xlim=c(5,18),
ylim=c(77.1,79.1),xlab="Longitude",ylab="Latitude")

# filter by speed only
mfilter&lt;-vmask(lat,lon,dtime,2)
mfilter[1:10]
lines(lon[which(mfilter=="not")],lat[which(mfilter=="not")],col="red")

# filter data using sdafilter
cfilter&lt;-sdafilter(lat, lon, dtime, lc)
cfilter[1:20]
lines(lon[which(cfilter=="not")],lat[which(cfilter=="not")],col="blue")

# check number of locations (by location class) removed by each filter
table(lc,mfilter)
table(lc,cfilter)

</code></pre>

<hr>
<h2 id='seal'>Satellite tracking data from a ringed seal</h2><span id='topic+seal'></span>

<h3>Description</h3>

<p>Satellite tracking data from a ringed seal tagged in Svalbard, Norway.
Data were provided by C. Lydersen and K. M. Kovacs (Norwegian Polar Institute).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(seal)</code></pre>


<h3>Format</h3>

<p>A data frame with 1561 observations on the following 4 variables.
</p>

<dl>
<dt><code>dtime</code></dt><dd><p>a vector of class POSIXt with date and time for each location</p>
</dd>
<dt><code>lat</code></dt><dd><p>a numeric vector with latitudes, in decimal degrees</p>
</dd>
<dt><code>lon</code></dt><dd><p>a numeric vector with longitudes, in decimal degrees</p>
</dd>
<dt><code>lc</code></dt><dd><p>a numeric vector with location classes LC (-9 refers to LC Z, -2 to LC B and -1 to LC A)</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(seal)
lat&lt;-seal$lat
lon&lt;-seal$lon
# plot unfiltered data
plot(lon,lat)
</code></pre>

<hr>
<h2 id='vmask'>Filter locations for speed</h2><span id='topic+vmask'></span>

<h3>Description</h3>

<p>This function filters location data obtained from Argos, using the 
MacConnell al. (1992) algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vmask(lat, lon, dtime, vmax)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vmask_+3A_lat">lat</code></td>
<td>
<p>a numeric vector of latitudes, in decimal degrees</p>
</td></tr>
<tr><td><code id="vmask_+3A_lon">lon</code></td>
<td>
<p>a numeric vector of longitudes, in decimal degrees</p>
</td></tr>
<tr><td><code id="vmask_+3A_dtime">dtime</code></td>
<td>
<p>a vector of class POSIXct with date and time for each location</p>
</td></tr>
<tr><td><code id="vmask_+3A_vmax">vmax</code></td>
<td>
<p>speed threshold, in m/s</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Locations are filtered using the algorithm described in MacConnell et al. (1992).
Since this algorithm calculates for each location the root mean square (rms) of the speeds
to the previous, 2nd previous, next and 2nd next location, high swimming speeds can be
obtained for points that are adjacent to outlier locations. Therefore, when the algorithm is applied 
to a set of locations, only the peaks in rms (that are above the maximum speed) are removed. 
Other locations are not removed even if above the speed limit. rms is then recalculated n times
until all locations are below the speed threshold.
</p>


<h3>Value</h3>

<p>Returns a vector with the following elements: <code>"removed"</code> (location removed by the filter),
<code>"not"</code> (location not removed) and <code>"end_location"</code> (location at the end
of the track where the algorithm could not be applied).
</p>


<h3>Author(s)</h3>

<p>Carla Freitas</p>


<h3>References</h3>

<p>McConnell, B.J., Chambers, C. and Fedak, M.A. (1992) Foraging ecology of southern
elephant seals in relation to the bathymetry and productivity of the Southern Ocean.
<em>Antarctic Science</em> 4:393-398.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sdafilter">sdafilter</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(seal)
lat&lt;-seal$lat
lon&lt;-seal$lon
dtime&lt;-seal$dtime
lc&lt;-seal$lc

# filter by speed
mfilter&lt;-vmask(lat,lon,dtime,2)

# plot unfiltered (grey) and filtered data (green)
plot(lon,lat,col="lightgrey",type="l",xlim=c(5,18), 
ylim=c(77.1,79.1),xlab="Longitude",ylab="Latitude")
lines(lon[which(mfilter=="not")],lat[which(mfilter=="not")],col="darkgreen")
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
