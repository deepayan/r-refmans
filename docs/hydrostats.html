<!DOCTYPE html><html><head><title>Help for package hydrostats</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {hydrostats}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Acheron'><p>Acheron River flow data</p></a></li>
<li><a href='#ann.cv'>
<p>Calculate interannual coefficient of variation</p></a></li>
<li><a href='#baseflows'>
<p>Measures of central tendency and baseflow via the Lynne-Hollick (LH) baseflow filter</p></a></li>
<li><a href='#Colwells'>
<p>Colwells indices</p></a></li>
<li><a href='#Cooper'>
<p>Cooper Creek flow data</p></a></li>
<li><a href='#CTF'>
<p>Cease-to-flow (CTF) spell statistics</p></a></li>
<li><a href='#daily.cv'>
<p>Calculate daily cofficient of variation</p></a></li>
<li><a href='#day.dist'>
<p>Calculate average timing of events (doy)</p></a></li>
<li><a href='#flood.length.max'>
<p>Calculates the maximum flood length in a time series.</p></a></li>
<li><a href='#four.digit.year'>
<p>Correct conversion of years to four digit format</p></a></li>
<li><a href='#get.days'>
<p>Function to determine the number of days 365 or 366 in a given year.</p></a></li>
<li><a href='#high.spell.lengths'>
<p>Calculate the length of all high flow spells</p></a></li>
<li><a href='#high.spells'>
<p>Calculates high flow spell statistics</p></a></li>
<li><a href='#hydro.year'>
<p>Determine hydrologic year for the purposes of deriving spell characteristics</p></a></li>
<li><a href='#hydrostats'>
<p>calculate hydrologic statistics</p></a></li>
<li><a href='#low.spell.lengths'>
<p>Calculate the length of all low flow spells</p></a></li>
<li><a href='#low.spells'>
<p>Calculate low flow spell statistics</p></a></li>
<li><a href='#monthly.cv'>
<p>Calculate monthly coefficient of variation</p></a></li>
<li><a href='#partial.series'>
<p>Partial and annual exceedence series.</p></a></li>
<li><a href='#recode'><p>recode</p></a></li>
<li><a href='#seasonality'>
<p>Calculate seasonality of discharge</p></a></li>
<li><a href='#ts.format'>
<p>Format dates as POSIXct</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Hydrologic Indices for Daily Time Series Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.9</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-05-31</td>
</tr>
<tr>
<td>Author:</td>
<td>Nick Bond</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Nick Bond &lt;n.bond@latrobe.edu.au&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Calculates a suite of hydrologic indices for daily time series data that are widely used in hydrology and stream ecology.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/nickbond/hydrostats">https://github.com/nickbond/hydrostats</a></td>
</tr>
<tr>
<td>Suggests:</td>
<td>dplyr, plyr</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, utils, graphics</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-05-31 23:55:40 UTC; nbond</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-06-01 02:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='Acheron'>Acheron River flow data</h2><span id='topic+Acheron'></span>

<h3>Description</h3>

<p>Daily discharge time series in megalitres per day (ML/day) for the Acheron River @ Taggerty (Gauge No. 405209), Victoria, Australia, from 1971-2000.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Acheron)
</code></pre>


<h3>Format</h3>

<p>A data frame with 10944 observations (from 1971-2000) on 2 variables.
</p>
<p>[,'Date'] date (format dd/mm/yy)
[,'Q'] discharge (ML/day)  
</p>


<h3>Source</h3>

<p>Data provided  by the State of Victoria, Department of Environment and Primary Industries, under Creative Commons Licence 3.0.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Acheron)
Acheron&lt;-ts.format(Acheron)
plot(Acheron[,"Date"],Acheron[,"Q"],type="l", xlab="Date",ylab="Discharge (ML/day)")


</code></pre>

<hr>
<h2 id='ann.cv'>
Calculate interannual coefficient of variation</h2><span id='topic+ann.cv'></span>

<h3>Description</h3>

<p>This function takes a daily time series and returns the coefficient of variation of mean annual flow expressed as a percentage. 
</p>
<p>i.e. (sd/mean)*100
</p>
<p>Missing values are ignored.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ann.cv(flow.ts)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ann.cv_+3A_flow.ts">flow.ts</code></td>
<td>
<p>Dataframe with date and discharge data in columns named &quot;Date&quot; and &quot;Q&quot; respectively. Date must be in POSIX format (see ts.format). Missing values are ignored.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe with one column (ann.cv).
</p>


<h3>Author(s)</h3>

<p>Nick Bond &lt;n.bond@latrobe.edu.au&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Cooper)
cooper&lt;-ts.format(Cooper)
ann.cv(Cooper)

</code></pre>

<hr>
<h2 id='baseflows'>
Measures of central tendency and baseflow via the Lynne-Hollick (LH) baseflow filter
</h2><span id='topic+baseflows'></span>

<h3>Description</h3>

<p>Calculate measure of central tendency and baseflow indices using the Lynne-Hollick filter
</p>


<h3>Usage</h3>

<pre><code class='language-R'>baseflows(flow.ts, a, n.reflected = 30, ts = "mean")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="baseflows_+3A_flow.ts">flow.ts</code></td>
<td>

<p>Dataframe with date and discharge data in columns named &quot;Date&quot; and &quot;Q&quot; respectively. Date must be in POSIX format (see ts.format). Missing values are ignored.
</p>
</td></tr>
<tr><td><code id="baseflows_+3A_a">a</code></td>
<td>

<p>The alpha value used in the Lynne-Hollick filter for digital baseflow separation. Default value is 0.975  
</p>
</td></tr>
<tr><td><code id="baseflows_+3A_n.reflected">n.reflected</code></td>
<td>

<p>The number of days that are reflected at the start and end of the series to provide a burn in for the digital filter. Default value is 30. (See Ladson et al. 2013).
</p>
</td></tr>
<tr><td><code id="baseflows_+3A_ts">ts</code></td>
<td>

<p>ts=&quot;mean&quot; returns means for the entire time series <br />
ts=&quot;annual&quot; returns annual averages. Note this function does not currently use hydrologic years even when defined<br />
ts=&quot;daily&quot; returns complete series</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Technically the LH filter cannot be calculated where there are missing data. Here the function removes missing values and is applied to a concatenated version of the time series. Missing dates are reinserted after the filter has been applied for the purpose of returning annual or daily series. The function further reports the number of missing values leaving the user to decide on the reliability of the baseflow estimates.
</p>


<h3>Value</h3>

<p>A dataframe. See below for details. The original dataframe with appended columns &quot;bf&quot; and &quot;bfi&quot;. See ts=&quot;annual&quot; for details.
</p>
<p>ts=&quot;mean&quot; 
</p>
<table>
<tr><td><code>n.years</code></td>
<td>
<p>The number of years of record in the series</p>
</td></tr>
<tr><td><code>prop.obs</code></td>
<td>
<p>proportion of non-missing observations</p>
</td></tr>
<tr><td><code>MDF</code></td>
<td>
<p>mean daily flow</p>
</td></tr>
<tr><td><code>Q50</code></td>
<td>
<p>median daily flow</p>
</td></tr>
<tr><td><code>mean.bf</code></td>
<td>
<p>mean baseflow volume</p>
</td></tr>
<tr><td><code>mean.bfi</code></td>
<td>
<p>mean baseflow index</p>
</td></tr>
</table>
<p>ts=&quot;annual&quot;
</p>
<table>
<tr><td><code>year</code></td>
<td>
<p>the record year</p>
</td></tr>
<tr><td><code>no.obs</code></td>
<td>
<p>no of observations in each year</p>
</td></tr>
<tr><td><code>Q</code></td>
<td>
<p>mean daily flow in each year</p>
</td></tr>
<tr><td><code>bf</code></td>
<td>
<p>mean baseflow volume in each year</p>
</td></tr>
<tr><td><code>bfi</code></td>
<td>
<p>baseflow index for each year</p>
</td></tr>
</table>
<p>ts=&quot;daily&quot;
</p>
<table>
<tr><td><code>bf</code></td>
<td>
<p>baseflow index for each observation</p>
</td></tr>
<tr><td><code>bfi</code></td>
<td>
<p>baseflow index associated with each observation</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Nick Bond &lt;n.bond@latrobe.edu.au&gt;
</p>


<h3>References</h3>

<p>Ladson, A. R., R. Brown, B. Neal and R. Nathan (2013) A standard approach to baseflow separation using the Lyne and Hollick filter. Australian Journal of Water Resources 17(1): 173-18
</p>
<p>Lynne, V., Hollick, M. (1979) Stochastic time-variable rainfall-runoff modelling. In: pp. 89-93 Institute of Engineers Australia National Conference. Perth.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Acheron)
Acheron&lt;-ts.format(Acheron)

baseflows(Acheron,a=0.975, ts="mean")
baseflows(Acheron,a=0.975, ts="annual")
head(baseflows(Acheron,a=0.975, ts="daily"))


</code></pre>

<hr>
<h2 id='Colwells'>
Colwells indices </h2><span id='topic+Colwells'></span>

<h3>Description</h3>

<p>Calculates Colwell's (1974), which provide a measure of the seasonal predictability of environmental phenomena. Defined in terms of Predictability (P), Constancy (C) and Contingency (M). For detailed information on the calculation and description of Colwell's indices refer to (Colwell, 1974).</p>


<h3>Usage</h3>

<pre><code class='language-R'>Colwells(flow.ts, fn = "mean",
boundaries = "transform", s = 11,
base.binning = 2, from = 0.5, by = 0.25, base.entropy=2, indices.only=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Colwells_+3A_flow.ts">flow.ts</code></td>
<td>

<p>Dataframe with date and discharge data in columns named &quot;Date&quot; and &quot;Q&quot; respectively. Date must be in POSIX format (see ts.format). Missing values are ignored.
</p>
</td></tr>
<tr><td><code id="Colwells_+3A_fn">fn</code></td>
<td>

<p>The function used to summarise daily data (default mean) and for scaling break points when binning data. Can also use median, min, max.</p>
</td></tr>
<tr><td><code id="Colwells_+3A_boundaries">boundaries</code></td>
<td>

<p>The method used to define break points when binning data.
</p>
<p>boundaries=&quot;equal&quot;  splits the data into s equal sized bins
</p>
<p>boundaries=&quot;transform&quot; (default) first applies a log10(x+1) transformation and then splits the data into s equal size bins
</p>
<p>boundaries=&quot;log_class_size&quot;  generates breaks based on logarithmic scale (default base 2) with a roughly equal number of bins above and below 1
</p>
<p>boundaries=&quot;weighted_log_class_size&quot; generates breaks based on logarithmic scale (default base 2) * mean (or other summary statistic) of the variable. A roughly equal number of bins occur above and below the mean (or other summary statistic)
</p>
<p>boundaries=&quot;Gan&quot; creates bins that match those of Gan et al. (1991). Requires: from (default 0.25), by (default 0.25) and s (number of bins)
</p>
</td></tr>
<tr><td><code id="Colwells_+3A_s">s</code></td>
<td>

<p>The number of classes the flow data is broken into (default 11)
</p>
</td></tr>
<tr><td><code id="Colwells_+3A_base.binning">base.binning</code></td>
<td>

<p>The base integer for defining classes when using the &quot;log_class_size&quot; or &quot;weighted_log_class_size&quot; boundaries
</p>
</td></tr>
<tr><td><code id="Colwells_+3A_from">from</code></td>
<td>

<p>The lowest break point for defining classes when using the &quot;Gan&quot; boundaries (default 0.25)
</p>
</td></tr>
<tr><td><code id="Colwells_+3A_by">by</code></td>
<td>

<p>The bin width when using the &quot;Gan&quot; boundaries (default 0.25)
</p>
</td></tr>
<tr><td><code id="Colwells_+3A_base.entropy">base.entropy</code></td>
<td>

<p>The base integer used for the entropy calculations (default=2)
</p>
</td></tr>
<tr><td><code id="Colwells_+3A_indices.only">indices.only</code></td>
<td>

<p>Logical. If FALSE (default), the function returns a list of length 3, including the breaks, a table of frequencies, and Colwell's indices. If TRUE, the function returns just a dataframe of indices, useful for combining output with that from other functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Predictability measures how tightly an event is linked to a season; Constancy measures how uniformly the event occurs through all seasons, and Contingency measures the repeatability of season patterns. Predictability is the sum of Constancy and Contingency, and reflects the likelihood of being able to predict a flow occurrence. It is maximized when the flow is constant throughout the year (Constancy Maximised), or if the pattern of high or low flow occurrence is repeated across all years (Contingency maximized).
</p>


<h3>Value</h3>

<p>A list or dataframe (see above).
</p>
<table>
<tr><td><code>breaks</code></td>
<td>
<p>shows the break points used between classes. Not returned for all boundary options. The upper and lower classes are always open even if -Inf/Inf are not shown.</p>
</td></tr>
<tr><td><code>flow.table</code></td>
<td>
<p>Table showing the number of times the monthly flows fall into each flow class in each month. Useful for examining the results of different binning techniques.</p>
</td></tr>
<tr><td><code>P</code></td>
<td>
<p>Predictability</p>
</td></tr>
<tr><td><code>C</code></td>
<td>
<p>Constancy</p>
</td></tr>
<tr><td><code>M</code></td>
<td>
<p>Contingency</p>
</td></tr>
<tr><td><code>CP</code></td>
<td>
<p>C/P</p>
</td></tr>
<tr><td><code>MP</code></td>
<td>
<p>M/P</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Nick Bond &lt;n.bond@latrobe.edu.au&gt;
</p>


<h3>References</h3>

<p>Colwell, R.K. 1974. Predictability, constancy, and contingency of periodic phenomena. Ecology 55(5): 1148-53.
</p>
<p>Gan, K.C., McMahon, T.A., and Finlayson, B.L. 1991. Analysis of periodicity in streamflow and rainfall data by Colwell's indices. Journal of Hydrology 123(1-2): 105-18.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Cooper)
Cooper&lt;-ts.format(Cooper)

Colwells(Cooper, s=5)
Colwells(Cooper, boundaries="equal", s=11)
Colwells(Cooper, boundaries="log_class_size", s=11)
Colwells(Cooper, boundaries="weighted_log_class_size", s=11)

Colwells(Cooper, boundaries="Gan", from=1,by=1, s=4)
Colwells(Cooper, boundaries="Gan", from=0.25,by=0.25, s=9)

Colwells(Cooper, boundaries="Gan", from=0.25,by=0.25, s=9, indices.only=TRUE)


require(plyr)
data(Acheron)
Acheron&lt;-ts.format(Acheron)
flow.ts&lt;-rbind(data.frame(River="Acheron", Acheron), data.frame(River="Cooper", Cooper))

ddply(flow.ts, .(River), function(x)
Colwells(x, boundaries="weighted_log_class_size", s=11, indices.only=TRUE))
</code></pre>

<hr>
<h2 id='Cooper'>
Cooper Creek flow data
</h2><span id='topic+Cooper'></span>

<h3>Description</h3>

<p>Daily discharge time series in megalitres per day (ML/day) for Coopers Creek @ Currareva (Gauge No. 003101), Qld, Australia, from 1967-1987.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Cooper)
</code></pre>


<h3>Format</h3>

<p>A data frame with 7670 observations (from 1967-1987) on 2 variables.
</p>
<p>[,'Date'] date (format dd/mm/yy)
[,'Q'] discharge (ML/day)  
</p>


<h3>Source</h3>

<p>Data provided by the State of Queensland, Department of Natural Resources and Mines, under creative commons licence agreement. Details available at http://watermonitoring.dnrm.qld.gov.au/wini/copyright.htm  
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Cooper)
Cooper&lt;-ts.format(Cooper)
plot(Cooper[, "Date"],Cooper[, "Q"],type="l", xlab="Date",ylab="Discharge (ML/day)")


</code></pre>

<hr>
<h2 id='CTF'>
Cease-to-flow (CTF) spell statistics
</h2><span id='topic+CTF'></span>

<h3>Description</h3>

<p>Calculates summary statistics describing cease-to-flow spell characteristics.</p>


<h3>Usage</h3>

<pre><code class='language-R'>CTF(flow.ts, threshold = 0.1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CTF_+3A_flow.ts">flow.ts</code></td>
<td>

<p>Dataframe with date and discharge data in columns named &quot;Date&quot; and &quot;Q&quot; respectively. Date must be in POSIX format (see ts.format).</p>
</td></tr>
<tr><td><code id="CTF_+3A_threshold">threshold</code></td>
<td>

<p>values below this threshold (default 0.1) are treated as zero for the purpose of defining cease to flow spells to account for the fact that cease to flow levels are poorly defined for many gauging sites.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe with 5 columns (see below).
</p>
<table>
<tr><td><code>p.CTF</code></td>
<td>
<p>Proportion time cease to flows occur</p>
</td></tr>
<tr><td><code>avg.CTF</code></td>
<td>
<p>Average cease-to-flow spell duration</p>
</td></tr>
<tr><td><code>med.CTF</code></td>
<td>
<p>Median cease-to-flow spell duration</p>
</td></tr>
<tr><td><code>min.CTF</code></td>
<td>
<p>Minimum cease-to-flow spell duration</p>
</td></tr>
<tr><td><code>max.CTF</code></td>
<td>
<p>Maximum cease-to-flow spell duration</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Nick Bond &lt;n.bond@latrobe.edu.au&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Cooper)
Cooper&lt;-ts.format(Cooper)

CTF(Cooper)
CTF(Cooper, threshold=0)

</code></pre>

<hr>
<h2 id='daily.cv'>
Calculate daily cofficient of variation
</h2><span id='topic+daily.cv'></span>

<h3>Description</h3>

<p>This function takes a daily time series and returns the coefficient of variation of daily flows expressed as a percentage. 
</p>
<p>i.e. (sd/mean)*100
</p>
<p>Missing values are ignored.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>daily.cv(flow.ts)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="daily.cv_+3A_flow.ts">flow.ts</code></td>
<td>
<p>Dataframe with date and discharge data in columns named &quot;Date&quot; and &quot;Q&quot; respectively. Date must be in POSIX format (see ts.format)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe with one column (daily.cv).
</p>


<h3>Author(s)</h3>

<p>Nick Bond &lt;n.bond@latrobe.edu.au&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Cooper)
Cooper&lt;-ts.format(Cooper)

daily.cv(Cooper)

</code></pre>

<hr>
<h2 id='day.dist'>
Calculate average timing of events (doy)
</h2><span id='topic+day.dist'></span>

<h3>Description</h3>

<p>Calculates the mean and standard deviation of the timing of annual events. Given a dataframe consisting of years in column one and a day of year (0-365 [366 for leap years]) in column two, day.dist returns the mean day of the year (doy) and standard deviation of days around the mean. 
</p>
<p>Circular statistics are used to account for the proximity of days close to the start and the end of the year (i.e. numbers close to 0 and 365), which would notionally have a mean of approximiately 182 (see Bayliss and Jones (1993)). The mean that is returned can be interpreted as a calendar day, and data that are strongly directional will have a standard deviation close to zero.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>day.dist(Dates, days, years)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="day.dist_+3A_dates">Dates</code></td>
<td>

<p>A vector of POSIX dates from which days and years are extracted. If Dates are not provided, days and years must be </p>
</td></tr>
<tr><td><code id="day.dist_+3A_days">days</code></td>
<td>

<p>A vector of days in numeric format. Not required if POSIXct dates are provided</p>
</td></tr>
<tr><td><code id="day.dist_+3A_years">years</code></td>
<td>

<p>A vector of years in numeric format. Not required if POSIXct dates are provided</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe with two columns.
</p>
<table>
<tr><td><code>mean.doy</code></td>
<td>
<p>mean day of year events occur on</p>
</td></tr>
<tr><td><code>sd.doy</code></td>
<td>
<p>standard deviation indicating the spread of event timing</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Nick Bond &lt;n.bond@latrobe.edu.au&gt;
</p>


<h3>References</h3>

<p>Bayliss, A. C., Jones, R. C. (1993) Peaks-over-threshold flood database: Summary statistics and seasonality. Institute of Hydrology. Wallingford, UK.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>days&lt;-c(366,1,365,1,366)
years&lt;-c("1968","1975","1983","1990","2004")
day.dist(days=days, years=years)

days&lt;-c(170,180,1,365,170)
day.dist(days=days, years=years)

dates&lt;-c("1968-06-18", "1975-06-29", "1983-01-01", "1990-12-31", "2004-06-18")
dates&lt;-as.POSIXct(dates, format = "%Y-%m-%d", tz="")
day.dist(Dates=dates)

</code></pre>

<hr>
<h2 id='flood.length.max'>
Calculates the maximum flood length in a time series. 
</h2><span id='topic+flood.length.max'></span>

<h3>Description</h3>

<p>Calculates the maximum flood length above a user defined threshold in a time series. Used with ddply (from the plyr package) it can be used to return a vector of maximum flood lengths for multiple gauges or for multiple years (see examples). Alternatively, the function <code><a href="#topic+high.spell.lengths">high.spell.lengths</a></code> can be used to return the length of all events above a threshold.</p>


<h3>Usage</h3>

<pre><code class='language-R'>flood.length.max(flow.ts, threshold, ind.days = 5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="flood.length.max_+3A_flow.ts">flow.ts</code></td>
<td>

<p>Dataframe with date and discharge data in columns named &quot;Date&quot; and &quot;Q&quot; respectively. Date must be in POSIX format (see ts.format)
</p>
</td></tr>
<tr><td><code id="flood.length.max_+3A_threshold">threshold</code></td>
<td>

<p>A user supplied threshold for defining spells. This would typically be derived from hydraulic models or similar knowledge pertaining to a gauge site</p>
</td></tr>
<tr><td><code id="flood.length.max_+3A_ind.days">ind.days</code></td>
<td>

<p>Periods between spells of less than ind.days (default 5) are considered to be 'in spell' for the purpose of further calculations. A value of 0 means spells 1 day apart are considered indpedendent</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe with one column (flood.length.max).
</p>


<h3>Author(s)</h3>

<p>Nick Bond &lt;n.bond@latrobe.edu.au&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(Cooper)
Cooper&lt;-ts.format(Cooper)

flood.length.max(Cooper, threshold = 50000, ind.days = 5)

# Return annual maximum flood length based on calendar year using ddply (from plyr package) 
require(plyr)
Cooper$Year=format(Cooper$Date, format="%Y")
ddply(Cooper, .(Year), flood.length.max, threshold = 50000)

require(dplyr)
Cooper %&gt;%
dplyr::group_by(Year) %&gt;%
dplyr::do(flood.length.max(., threshold = 50000))


# Based on hydrologic year.
Cooper&lt;-hydro.year(Cooper)
plyr::ddply(Cooper, .(Year), flood.length.max, threshold = 50000)

</code></pre>

<hr>
<h2 id='four.digit.year'>
Correct conversion of years to four digit format</h2><span id='topic+four.digit.year'></span>

<h3>Description</h3>

<p>Converts from two to four digit representation of years correcting the century for years earlier than that specified. Addresses the fact that under POSIX specifications, values 00 to 68 are prefixed by 20 and 69 to 99 by 19 when converting from two digit years, which can affectlonger time series and older data sets. </p>


<h3>Usage</h3>

<pre><code class='language-R'>four.digit.year(x, year=1968)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="four.digit.year_+3A_x">x</code></td>
<td>

<p>A vector of POSIXct dates, presumably with some years (often those earlier than 1969) assigned to the wrong century.</p>
</td></tr>
<tr><td><code id="four.digit.year_+3A_year">year</code></td>
<td>

<p>The year (in four digit format) indicating the cutoff for setting the century to 1900's or 2000's.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of same length as input with years in four digit format.
</p>


<h3>Author(s)</h3>

<p>Nick Bond &lt;n.bond@latrobe.edu.au&gt;
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+strptime">strptime</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- as.POSIXct(c("01/01/43","01/01/68","01/01/69","01/01/99","01/01/04"), format="%d/%m/%y")
x
four.digit.year(x, year=1968)
four.digit.year(x, year=1942)
</code></pre>

<hr>
<h2 id='get.days'>
Function to determine the number of days 365 or 366 in a given year.
</h2><span id='topic+get.days'></span>

<h3>Description</h3>

<p>A helper function for circular statistic functions. Determines the number of days in any given year (i.e. 365 or 366)</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.days(year)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get.days_+3A_year">year</code></td>
<td>

<p>A vector of years in numeric format</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector containing the number of days in each year in the input vector
</p>


<h3>Author(s)</h3>

<p>Nick Bond &lt;n.bond@latrobe.edu.au&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>years&lt;-c("1968","1975","1983","1990","2004")
get.days(years)

</code></pre>

<hr>
<h2 id='high.spell.lengths'>
Calculate the length of all high flow spells
</h2><span id='topic+high.spell.lengths'></span>

<h3>Description</h3>

<p>Returns the length (and start date) of all flow spells above (or below) a given percentile or user defined threshold. 
</p>
<p>Independence criteria allow short periods below the spell threshold to be ignored and flows below a threshold (e.g. zero flows) can be ignored when calculating percentile flows (useful in ephemeral rivers).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>high.spell.lengths(flow.ts, quant = 0.9, threshold,
ind.days = 5, ignore.zeros = T, ctf.threshold = 0.1, inter.flood=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="high.spell.lengths_+3A_flow.ts">flow.ts</code></td>
<td>

<p>Dataframe with date and discharge data in columns named &quot;Date&quot; and &quot;Q&quot; respectively. Date must be in POSIX format (see ts.format).
</p>
</td></tr>
<tr><td><code id="high.spell.lengths_+3A_quant">quant</code></td>
<td>

<p>Percentile/quantile to use for defining event magnitude (default 0.9). A value of 0.9 is the upper 90th percentile (i.e. a volume exceeded 10% of the time).</p>
</td></tr>
<tr><td><code id="high.spell.lengths_+3A_threshold">threshold</code></td>
<td>

<p>A user supplied threshold for defining spells. This would typically be derived from hydraulic models or similar knowledge pertaining to a gauge site.
</p>
</td></tr>
<tr><td><code id="high.spell.lengths_+3A_ind.days">ind.days</code></td>
<td>

<p>Periods between spells of less than ind.days (default 5) are considered to be 'in spell' for the purpose of further calculations. A value of 0 means spells 1 day apart are considered indpedendent.</p>
</td></tr>
<tr><td><code id="high.spell.lengths_+3A_ignore.zeros">ignore.zeros</code></td>
<td>

<p>logical. If TRUE, days below a user defined cease-to-flow threshold (default 0.1) will be excluded when estimating the spell threshold for a given percentile. This is primarily of interest in highly ephemeral rivers, where flow may only occur for a small fraction of the time. In such cases, the inclusion of zeros will skew estimates of high flow events downwards, which may be undesirable.</p>
</td></tr>
<tr><td><code id="high.spell.lengths_+3A_ctf.threshold">ctf.threshold</code></td>
<td>

<p>values below this threshold are treated as zero for the purpose of percentile based calculations (see ignore zeros).</p>
</td></tr>
<tr><td><code id="high.spell.lengths_+3A_inter.flood">inter.flood</code></td>
<td>

<p>logical. If TRUE, the function returns the spell lengths and start dates for periods below (rather than above) the defined threshold.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a dataframe of spell lengths and their associated starting dates.
</p>
<p>Note that spells will always end at NAs.
</p>


<h3>Author(s)</h3>

<p>Nick Bond &lt;n.bond@latrobe.edu.au&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Cooper)
Cooper&lt;-ts.format(Cooper)

high.spell.lengths(Cooper, threshold=50000)

</code></pre>

<hr>
<h2 id='high.spells'>
Calculates high flow spell statistics
</h2><span id='topic+high.spells'></span>

<h3>Description</h3>

<p>Calculates a suite of statistics describing flood characteristics, such as the timing, frequency and duration of events. The event threshold can be defined as a flow quantile (e.g. upper 90th percentile [default]) or a specific threshold volume (e.g. ML/day).
</p>
<p>For the purpose of deriving annual flood statistics, the function can also be applied based on the hydrologic year. This is advisable where the high flow season spans years, such that prolonged spells may span years. Setting the parameter hydro.year=TRUE uses the hydro.year function to determine the appropriate hydrologic year for each record, which is then used for deriving annual spell characteristics.
</p>
<p>It is possible for there to be multiple days with the same annual maximum flow value (although less likely than for low flows). In estimating the average timing (and sd of timing) of minimum flows, the function calculates the average day of year (DOY) of minimum flows in each year first, before calculating the average across years. Circular functions are used to address the proximity between days toward the beginning and end of the year.
</p>
<p>Missing values are allowed for convenience (NA's are removed and the time-series is concatenated before functions are applied), but may lead to biased results. For the purpose of the annual statistics years with fewer than 350 days of available record are ignored.
</p>
<p>When used with ddply to compute outputs for multiple gauges or time periods simultaneously, results, icluding graphs are produced for each factor level, including graphs. Note the funtion will return warnings if annual stats are calculated when year is used as a factor.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>high.spells(flow.ts, quant = 0.9, threshold = NULL,
ind.days = 5, duration = TRUE, volume = TRUE, plot = TRUE, ignore.zeros = FALSE,
ctf.threshold = 0.1, ann.stats = TRUE, ann.stats.only = FALSE, inter.flood = FALSE, 
hydro.year=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="high.spells_+3A_flow.ts">flow.ts</code></td>
<td>
<p>Dataframe with date and discharge data in columns named &quot;Date&quot; and &quot;Q&quot; respectively. Date must be in POSIX format (see ts.format).
</p>
<p>If a third column exists then this is assumed to provide a vector of years for the purpose of calculating annual spell statistics based on a predetermined hydrologic year.
</p>
</td></tr>
<tr><td><code id="high.spells_+3A_quant">quant</code></td>
<td>
<p>Percentile/quantile to use for defining event magnitude (default 0.9). A value of 0.9 is the upper 90th percentile (i.e. a volume exceeded 10% of the time), and corresponds to Q90.
</p>
</td></tr>
<tr><td><code id="high.spells_+3A_threshold">threshold</code></td>
<td>

<p>A user supplied threshold for defining spells. This would typically be derived from hydraulic models or similar knowledge pertaining to a gauge site.
</p>
</td></tr>
<tr><td><code id="high.spells_+3A_ind.days">ind.days</code></td>
<td>

<p>Periods between spells of less than ind.days (default 5) are considered to be 'in spell' for the purpose of further calculations. A value of 0 means spells 1 day apart are considered indpedendent.</p>
</td></tr>
<tr><td><code id="high.spells_+3A_duration">duration</code></td>
<td>

<p>logical. Should statistics describing spell duration be returned?</p>
</td></tr>
<tr><td><code id="high.spells_+3A_volume">volume</code></td>
<td>

<p>logical. Should statistics describing spell volumes be returned? Note that for days considered 'in-spell', the returned values have the threshold volume subtracted first, and hence reflect the amount of water that was flowing past the gauge above threshold. This is most useful in water planning scenarios.</p>
</td></tr>
<tr><td><code id="high.spells_+3A_plot">plot</code></td>
<td>

<p>logical. Should the time-series be plotted? Data points considered 'within spell' are identifed using red circles and the threshold is identified with a horizontal line.</p>
</td></tr>
<tr><td><code id="high.spells_+3A_ignore.zeros">ignore.zeros</code></td>
<td>

<p>logical. If TRUE, days below a user defined cease-to-flow threshold (default 0.1) will be excluded when estimating the spell threshold for a given percentile. This is primarily of interest in highly ephemeral rivers, where flow may only occur for a small fraction of the time. In such cases, the inclusion of zeros will skew estimates of high flow events downwards, which may be undesirable.
</p>
</td></tr>
<tr><td><code id="high.spells_+3A_ctf.threshold">ctf.threshold</code></td>
<td>

<p>values below this threshold are treated as zero for the purpose of percentile based calculations (see ignore zeros).
</p>
</td></tr>
<tr><td><code id="high.spells_+3A_ann.stats">ann.stats</code></td>
<td>

<p>logical. If TRUE, the function returns results describing the annual maximum series (i.e. that describing the characteristics of the largest flood event in each year of the time-series). The duration of each annual high.spell is defined as the number of days above the smallest annual maximum for the largest (and longest) high.spell event in each year.
</p>
</td></tr>
<tr><td><code id="high.spells_+3A_ann.stats.only">ann.stats.only</code></td>
<td>

<p>logical. If TRUE, statistics describing the annual series only are returned. </p>
</td></tr>
<tr><td><code id="high.spells_+3A_inter.flood">inter.flood</code></td>
<td>

<p>logical. If TRUE, statistics describing inter-flood spell characteristics are reported.</p>
</td></tr>
<tr><td><code id="high.spells_+3A_hydro.year">hydro.year</code></td>
<td>

<p>logical. If TRUE, each record is first assigned to a hydrologic year based on the timing of minimum flows. See <code><a href="#topic+hydro.year">hydro.year</a></code> for further details.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe with the following columns.
</p>
<p>flood indices
</p>
<table>
<tr><td><code>high.spell.threshold</code></td>
<td>
<p>The high spell threshold applied in the analysis)</p>
</td></tr>
<tr><td><code>n.events</code></td>
<td>
<p>The number of events in the series greater than or equal to the high.spell.threshold</p>
</td></tr>
<tr><td><code>spell.freq</code></td>
<td>
<p>The frequency of spell events (no. per year)</p>
</td></tr>
<tr><td><code>ari</code></td>
<td>
<p>Average Recurrence Interval of events in years (1/spell.freq)</p>
</td></tr>
<tr><td><code>min.high.spell.dur</code></td>
<td>
<p>Minimum duration of spell events</p>
</td></tr>
<tr><td><code>avg.high.spell.dur</code></td>
<td>
<p>Average duration of spell events</p>
</td></tr>
<tr><td><code>med.high.spell.dur</code></td>
<td>
<p>Median duration of spell events</p>
</td></tr>
<tr><td><code>max.high.spell.dur</code></td>
<td>
<p>Maximum duration of spell events</p>
</td></tr>
<tr><td><code>avg.spell.volume</code></td>
<td>
<p>Average spell volume (volumes above the threshold only)</p>
</td></tr>
<tr><td><code>avg.spell.peak</code></td>
<td>
<p>Average spell peak</p>
</td></tr>
<tr><td><code>sd.spell.peak</code></td>
<td>
<p>Standard deviation of spell speaks</p>
</td></tr>
<tr><td><code>avg.rise</code></td>
<td>
<p>Average absolute rate of daily rise during spell events</p>
</td></tr>
<tr><td><code>avg.fall</code></td>
<td>
<p>Average absolute rate of daily fall during spell events</p>
</td></tr>
</table>
<p>interflood indices
</p>
<table>
<tr><td><code>average.interval</code></td>
<td>
<p>The average time between spells (years)</p>
</td></tr>
<tr><td><code>min.interval</code></td>
<td>
<p>The mininum time between spells (years)</p>
</td></tr>
<tr><td><code>max.interval</code></td>
<td>
<p>The maximum time between spells (years)</p>
</td></tr>
</table>
<p>Annual flood statistics
</p>
<table>
<tr><td><code>avg.max.ann</code></td>
<td>
<p>The average annual maximum flow</p>
</td></tr>
<tr><td><code>cv.max.ann</code></td>
<td>
<p>The coefficient of variation of annual maximum flows</p>
</td></tr>
<tr><td><code>flood.skewness</code></td>
<td>
<p>The average annual maximum / mean daily flow</p>
</td></tr>
<tr><td><code>ann.max.timing</code></td>
<td>
<p>The average day of the year (0-366) on which maximum flows occur</p>
</td></tr>
<tr><td><code>ann.max.timing.sd</code></td>
<td>
<p>circular standard deviation of the average timing of annual maximum flows</p>
</td></tr>
<tr><td><code>ann.max.min.dur</code></td>
<td>
<p>Minimum duration of the annual maximum spells (always equal to 1)</p>
</td></tr>
<tr><td><code>ann.max.avg.dur</code></td>
<td>
<p>Average duration of the annual maximum spells</p>
</td></tr>
<tr><td><code>ann.max.max.dur</code></td>
<td>
<p>Maximum duration of the annual maximum spells</p>
</td></tr>
<tr><td><code>ann.max.cv.dur</code></td>
<td>
<p>The coefficient of variation of the duration of annual maximum spells</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Nick Bond &lt;n.bond@latrobe.edu.au&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(Cooper)
Cooper&lt;-ts.format(Cooper)

high.spells(Cooper, quant=0.9)

high.spells(Cooper, quant=0.9, ann.stats=FALSE, plot=FALSE)

high.spells(Cooper, quant=0.9, ann.stats=FALSE, ignore.zeros=TRUE)

high.spells(Cooper, quant=0.9, ann.stats=FALSE, ignore.zeros=TRUE, hydro.year=TRUE)

require(plyr)
Cooper$year&lt;-strftime(Cooper$Date, format="%Y")
ddply(Cooper, .(year), function(x) high.spells(x, ann.stats=FALSE))

Cooper$time.period &lt;- ifelse(Cooper$year&lt;1980,"pre_1980","post_1980")

ddply(Cooper, .(time.period), function(x) high.spells(x, ann.stats=FALSE))

</code></pre>

<hr>
<h2 id='hydro.year'>
Determine hydrologic year for the purposes of deriving spell characteristics
</h2><span id='topic+hydro.year'></span>

<h3>Description</h3>

<p>Defines a hydrologic year to minimise the risk that defined spells are interrupted by transitions between calendar years. The function can be called by several other functions in the hydrostats package (e.g. <code><a href="#topic+high.spells">high.spells</a></code>, <code><a href="#topic+low.spells">low.spells</a></code>, <code><a href="#topic+high.spell.lengths">high.spell.lengths</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hydro.year(flow.ts, hydro.year = "hydro", year.only=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hydro.year_+3A_flow.ts">flow.ts</code></td>
<td>

<p>Dataframe with date and discharge data in columns named &quot;Date&quot; and &quot;Q&quot; respectively. Date must be in POSIX format (see ts.format).</p>
</td></tr>
<tr><td><code id="hydro.year_+3A_hydro.year">hydro.year</code></td>
<td>

<p>hydro.year=&quot;hydro&quot; calculates the hydrologic year and returns a dataframe with an additional column indiating the hydrologic year to which each observation belongs. The hydrologic year is defined as starting in the first month of the average driest 6 month period across all years. This maximises the likelihood that low-flow and high-flow spells will be contained within a rolling 12 month period.
</p>
<p>Other options may be added in the future.
</p>
</td></tr>
<tr><td><code id="hydro.year_+3A_year.only">year.only</code></td>
<td>

<p>logical. If FALSE (default), a column indicating the hydrologic year of each record is added to the original data.frame. If TRUE, a vector indicating the hydrologic year of each record is returned. 
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If year.only=FALSE (default), the function returns the original dataframe with an added column &quot;hydro.year&quot; indicating the hydrologic year to which each case belongs. Otherwise, if year.only=TRUE, a vector of hydrologic years is returned.
</p>


<h3>Author(s)</h3>

<p>Nick Bond &lt;n.bond@latrobe.edu.au&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+high.spells">high.spells</a></code>, <code><a href="#topic+low.spells">low.spells</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Cooper)
Cooper&lt;-ts.format(Cooper)

head(hydro.year(Cooper))
head(hydro.year(Cooper, year.only=TRUE))
</code></pre>

<hr>
<h2 id='hydrostats'>
calculate hydrologic statistics
</h2><span id='topic+hydrostats'></span><span id='topic+hydrostats'></span>

<h3>Description</h3>

<p>Calculate a range of hydrologic statistics based on daily time series data and which are widely used in hydrology and ecological applications.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> hydrostats</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 0.2.4</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2015-10-16</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;= 2) </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Data must be provided as a dataframe in which the date is in POSIXct format. The function <code><a href="#topic+ts.format">ts.format</a></code> can be used to specify the Date and discharge columns (named Date and Q respectively) in a dataframe, and convert dates to POSIXct format. The date and discharge data must be in columns labelled &quot;Date&quot; and &quot;Q&quot; for the functions to work.
</p>
<p>Includes several sample datasets.<br />
data(Cooper) - Flow data for Coopers Creek, Australia. Gauge 003101@Currareva <br />
data(Acheron) - Flow data for Acheron River, Australia, Gauge 405209@Taggerty
</p>


<h3>Author(s)</h3>

<p>Nick Bond
Maintainer: Nick Bond &lt;n.bond@latrobe.edu.au&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Acheron)
Acheron&lt;-ts.format(Acheron)
with(Acheron, plot(Q~Date))

high.spell.lengths(Acheron, threshold=50000)


</code></pre>

<hr>
<h2 id='low.spell.lengths'>
Calculate the length of all low flow spells
</h2><span id='topic+low.spell.lengths'></span>

<h3>Description</h3>

<p>Returns the length (and start date) of all flow spells above (or below) a given percentile or user defined threshold. 
</p>
<p>Independence criteria allow short periods below the spell threshold to be ignored and flows below a threshold (e.g. zero flows) can be ignored when calculating percentile flows (useful in ephemeral rivers).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>low.spell.lengths(flow.ts, quant = 0.1, threshold,
ind.days = 5, ignore.zeros = F, ctf.threshold = 0.1, inter.spell=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="low.spell.lengths_+3A_flow.ts">flow.ts</code></td>
<td>

<p>Dataframe with date and discharge data in columns named &quot;Date&quot; and &quot;Q&quot; respectively. Date must be in POSIX format (see ts.format).
</p>
</td></tr>
<tr><td><code id="low.spell.lengths_+3A_quant">quant</code></td>
<td>

<p>Percentile/quantile to use for defining event magnitude (default 0.9). A value of 0.9 is the upper 90th percentile (i.e. a volume exceeded 10% of the time).</p>
</td></tr>
<tr><td><code id="low.spell.lengths_+3A_threshold">threshold</code></td>
<td>

<p>A user supplied threshold for defining spells. This would typically be derived from hydraulic models or similar knowledge pertaining to a gauge site.
</p>
</td></tr>
<tr><td><code id="low.spell.lengths_+3A_ind.days">ind.days</code></td>
<td>

<p>Periods between spells of less than ind.days (default 5) are considered to be 'in spell' for the purpose of further calculations. A value of 0 means spells 1 day apart are considered indpedendent.</p>
</td></tr>
<tr><td><code id="low.spell.lengths_+3A_ignore.zeros">ignore.zeros</code></td>
<td>

<p>logical. If TRUE, days below a user defined cease-to-flow threshold (default 0.1) will be excluded when estimating the spell threshold for a given percentile. This is primarily of interest in highly ephemeral rivers, where flow may only occur for a small fraction of the time. In such cases, the inclusion of zeros will skew estimates of low flow events downwards, which may be undesirable.</p>
</td></tr>
<tr><td><code id="low.spell.lengths_+3A_ctf.threshold">ctf.threshold</code></td>
<td>

<p>values below this threshold are treated as zero for the purpose of percentile based calculations (see ignore zeros).</p>
</td></tr>
<tr><td><code id="low.spell.lengths_+3A_inter.spell">inter.spell</code></td>
<td>

<p>logical. If TRUE, the function returns the spell lengths and start dates for periods above (rather than below) the defined threshold.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a dataframe of spell lengths and their associated starting dates.
</p>
<p>Note that spells will always end at NAs.
</p>


<h3>Author(s)</h3>

<p>Nick Bond &lt;n.bond@latrobe.edu.au&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Cooper)
Cooper&lt;-ts.format(Cooper)

low.spell.lengths(Cooper, threshold=50000)

</code></pre>

<hr>
<h2 id='low.spells'>
Calculate low flow spell statistics
</h2><span id='topic+low.spells'></span>

<h3>Description</h3>

<p>Calculates a suite of statistics describing low-flow spell characteristics, such as the timing, frequency and duration of events below a threshold. The event threshold can be defined as a flow quantile (e.g. the 10th  percentile, which is flows exceeded 90% of the time, corresponding to Q10) or a specific threshold volume (e.g. ML/day).
</p>
<p>For the purpose of deriving annual low-flow spell statistics, the function can also be applied based on the hydrologic year. This is advisable where the low flow season spans calendar years, such that prolonged spells may be split at the transition from one calendar year to the next. This first requires the time series be processed using the hydro.year function. This adds an additional column indicating the hydrologic year to which each row belongs, which is used for deriving annual spell characteristics.
</p>
<p>It is possible for there to be multiple days with the same low flow value (especially zero flows). In estimating the average timing (and sd of timing) of minimum flows, the function calculates the average DOY (day of year) of minimum flows in each year first, before calculating the average across years. Circular functions are used to address the proximity between days toward the beginning and end of the year.
</p>
<p>Missing values are allowed for convenience (NA's are removed and the time-series is concatenated before functions are applied), but of course may lead to biased results. For the purpose of the annual statistics years with fewer than 350 days of available record are ignored.
</p>
<p>When used with ddply to compute outputs for multiple gauges or time periods simultaneously, results, icluding graphs are produced for each factor level, including graphs. Note however that the funtion will return warnings if annual stats are calculated when year is used as a factor.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>low.spells(flow.ts, quant = 0.1, threshold=NULL, 
duration = T, volume = T, plot = T, ann.stats = T, ann.stats.only = F, 
hydro.year=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="low.spells_+3A_flow.ts">flow.ts</code></td>
<td>

<p>Dataframe with date and discharge data in columns named &quot;Date&quot; and &quot;Q&quot; respectively. Date must be in POSIX format (see ts.format). 
</p>
<p>If a third column exists then this is assumed to provide a vector of years for the purpose of calculating annual spell statistics based on a predetermined hydrologic year.</p>
</td></tr>
<tr><td><code id="low.spells_+3A_quant">quant</code></td>
<td>

<p>Percentile/quantile to use for defining event magnitude (default 0.1). A value of 0.1 is the lower 10th percentile (i.e. a volume exceeded 90% of the time).</p>
</td></tr>
<tr><td><code id="low.spells_+3A_threshold">threshold</code></td>
<td>

<p>A user supplied threshold for defining spells. This would typically be derived from hydraulic models or similar knowledge pertaining to a gauge site.
</p>
</td></tr>
<tr><td><code id="low.spells_+3A_duration">duration</code></td>
<td>

<p>logical. Should statistics describing spell duration be returned?</p>
</td></tr>
<tr><td><code id="low.spells_+3A_volume">volume</code></td>
<td>

<p>logical. Should statistics describing spell volumes be returned?</p>
</td></tr>
<tr><td><code id="low.spells_+3A_plot">plot</code></td>
<td>

<p>logical. Should the time-series be plotted? Data points considered 'within spell' are identifed using red circles and the threshold is identified with a horizontal line.</p>
</td></tr>
<tr><td><code id="low.spells_+3A_ann.stats">ann.stats</code></td>
<td>

<p>logical. If TRUE, the function returns results describing the annual series (i.e. the characteristics of the spells associated with the lowest annual daily flow). The duration of each annual low spell is defined as the number of days below the smallest annual minimum for the lowest (and longest) low flow event in each year.</p>
</td></tr>
<tr><td><code id="low.spells_+3A_ann.stats.only">ann.stats.only</code></td>
<td>

<p>logical. If TRUE, statistics describing the annual series only are returned.</p>
</td></tr>
<tr><td><code id="low.spells_+3A_hydro.year">hydro.year</code></td>
<td>

<p>logical. If TRUE, each record is first assigned to a hydrologic year based on the timing of minimum flows. See <code><a href="#topic+hydro.year">hydro.year</a></code> for further details.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe with the following columns.
</p>
<p>low flow indices
</p>
<table>
<tr><td><code>low.spell.threshold</code></td>
<td>
<p>The low spell threshold applied in the analysis</p>
</td></tr>
<tr><td><code>min.low.spell.duration</code></td>
<td>
<p>Minimum duration of spell events</p>
</td></tr>
<tr><td><code>avg.low.spell.duration</code></td>
<td>
<p>Average duration of spell events</p>
</td></tr>
<tr><td><code>med.low.spell.duration</code></td>
<td>
<p>Median duration of spell events</p>
</td></tr>
<tr><td><code>max.low.duration</code></td>
<td>
<p>Maximum duration of spell events</p>
</td></tr>
<tr><td><code>low.spell.freq</code></td>
<td>
<p>The frequency of spell events (no. per year)</p>
</td></tr>
</table>
<p>Annual low flow statistics
</p>
<table>
<tr><td><code>avg.min.ann</code></td>
<td>
<p>The average annual minimum flow</p>
</td></tr>
<tr><td><code>cv.min.ann</code></td>
<td>
<p>The coefficient of variation of annual minimum flows</p>
</td></tr>
<tr><td><code>ann.min.timing</code></td>
<td>
<p>The average day of the year (0-366) on which the minimum flow(s) occur.</p>
</td></tr>
<tr><td><code>ann.min.timing.sd</code></td>
<td>
<p>circular standard deviation of the average timing of annual minimum flows</p>
</td></tr>
<tr><td><code>ann.min.min.dur</code></td>
<td>
<p>Minimum duration of the annual maximum spells (always equal to 1)</p>
</td></tr>
<tr><td><code>ann.min.avg.dur</code></td>
<td>
<p>Average duration of the annual maximum spells</p>
</td></tr>
<tr><td><code>ann.min.max.dur</code></td>
<td>
<p>Maximum duration of the annual maximum spells</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Nick Bond &lt;n.bond@latrobe.edu.au&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(Cooper)
Cooper&lt;-ts.format(Cooper)

low.spells(Cooper, quant=0.1)

low.spells(Cooper, quant=0.1, hydro.year=TRUE)

#generate results for each year
Cooper$year&lt;-strftime(Cooper$Date, format="%Y")

require(plyr)
ddply(Cooper, .(year), function(x) low.spells(x, threshold=20, ann.stats=FALSE))

#generate seperate results prior to 1980.
Cooper$time.period&lt;-ifelse(Cooper$year&lt;1980,"pre_1980","post_1980")
ddply(Cooper, .(time.period), function(x) low.spells(x, threshold=20, ann.stats=FALSE))

</code></pre>

<hr>
<h2 id='monthly.cv'>
Calculate monthly coefficient of variation
</h2><span id='topic+monthly.cv'></span>

<h3>Description</h3>

<p>This function takes a daily time series and returns the coefficient of variation of mean monthly flow expressed as a percentage.</p>


<h3>Usage</h3>

<pre><code class='language-R'>monthly.cv(flow.ts)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="monthly.cv_+3A_flow.ts">flow.ts</code></td>
<td>
<p>Dataframe with date and discharge data in columns named &quot;Date&quot; and &quot;Q&quot; respectively. Date must be in POSIX format (see ts.format). Missing values are ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a dataframe with 1 column (monthly.cv)
</p>


<h3>Author(s)</h3>

<p>Nick Bond &lt;n.bond@latrobe.edu.au&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Cooper)
Cooper&lt;-ts.format(Cooper)
ann.cv(Cooper)
</code></pre>

<hr>
<h2 id='partial.series'>
Partial and annual exceedence series.
</h2><span id='topic+partial.series'></span>

<h3>Description</h3>

<p>Returns a partial or annual exceedence series (ari=1) based on a user defined recurrence interval (ari).
</p>
<p>For analyses based on a defined threshold (rather than recurrence interval) use <code><a href="#topic+high.spells">high.spells</a></code> instead.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>partial.series(flow.ts, ari = 2, ind.days = 7, duration = T, plot = F, volume = T, 
series = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="partial.series_+3A_flow.ts">flow.ts</code></td>
<td>
<p>Dataframe with date and discharge data in columns named &quot;Date&quot; and &quot;Q&quot; respectively. Date must be in POSIX format (see ts.format)
</p>
</td></tr>
<tr><td><code id="partial.series_+3A_ari">ari</code></td>
<td>

<p>The desired average return interval. As a partial series, an ari of 1 will return statistics for the n largest floods in n years of record (also referred to as the annual exceedence series).  The annual maximum series can be derived from high.spells with annual.stats=T</p>
</td></tr>
<tr><td><code id="partial.series_+3A_ind.days">ind.days</code></td>
<td>

<p>Spells of less than ind.days (default 7) are considered to be non-independent, and only the larger of the two spells is included in the results. This behaviour differs from high.spells, where periods below the determined spell threshold of less than the independence period are infilled for the purposes of determining spell duration. This behaviour may change in the future</p>
</td></tr>
<tr><td><code id="partial.series_+3A_duration">duration</code></td>
<td>

<p>logical. If TRUE (default), statistics describing the duration of events are returned</p>
</td></tr>
<tr><td><code id="partial.series_+3A_plot">plot</code></td>
<td>

<p>logical. If TRUE a plot is returned showing the events included in the partial series</p>
</td></tr>
<tr><td><code id="partial.series_+3A_volume">volume</code></td>
<td>

<p>logical. If TRUE, statistics are returned describing the volume of spells (above the spell threshold)</p>
</td></tr>
<tr><td><code id="partial.series_+3A_series">series</code></td>
<td>

<p>logical. If TRUE, the partial series is returned. If FALSE (default), only the indices describing the partial series are returned</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list or dataframe dependening on whether series = TRUE. If TRUE, a list is returned (see below). If FALSE a dataframe is returned with all indices but without the actual partial series (p.series).
</p>
<p>Indices
</p>
<table>
<tr><td><code>p.series</code></td>
<td>
<p>A dataframe containing an ordered partial series<br /> showing the timing and peak magnitude of events</p>
</td></tr></table>
<p>.
</p>
<table>
<tr><td><code>n.years</code></td>
<td>
<p>Number of (almost) complete years in the series. Years with fewer than 350 non-missing values are ignored</p>
</td></tr></table>
<p>.
</p>
<table>
<tr><td><code>n.events</code></td>
<td>
<p>Number of events in the partial series</p>
</td></tr></table>

<table>
<tr><td><code>flow.threshold</code></td>
<td>
<p>the peak volume of the smallest event include in the series</p>
</td></tr></table>

<table>
<tr><td><code>avg.duration</code></td>
<td>
<p>the average duration of events in the series</p>
</td></tr></table>

<table>
<tr><td><code>max.duration</code></td>
<td>
<p>the maximum duration of events in the series</p>
</td></tr></table>

<table>
<tr><td><code>med.spell.volume</code></td>
<td>
<p>the median volume (above the threshold) of events in the series</p>
</td></tr></table>



<h3>Author(s)</h3>

<p>Nick Bond &lt;n.bond@latrobe.edu.au&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Cooper)
Cooper&lt;-ts.format(Cooper)

partial.series(Cooper,ari=2)
partial.series(Cooper, ari=5, plot=TRUE, ind.days=2)
partial.series(Cooper, ari=5, plot=TRUE, ind.days=10)
</code></pre>

<hr>
<h2 id='recode'>recode</h2><span id='topic+recode'></span>

<h3>Description</h3>

<p>Recodes values in a vector based on original and new values provided as two vectors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>recode(x, oldvalue, newvalue)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="recode_+3A_x">x</code></td>
<td>

<p>A vector with values to be replaced.</p>
</td></tr>
<tr><td><code id="recode_+3A_oldvalue">oldvalue</code></td>
<td>

<p>A vector of original values to be recoded.
</p>
</td></tr>
<tr><td><code id="recode_+3A_newvalue">newvalue</code></td>
<td>

<p>A vector of replacement values of the same length as oldvalue.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of same length as input.
</p>


<h3>Author(s)</h3>

<p>Nick Bond &lt;n.bond@latrobe.edu.au&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x&lt;-seq(1:10)
recode(x, c(1,5,10), c(-1,-5,-10))
</code></pre>

<hr>
<h2 id='seasonality'>
Calculate seasonality of discharge
</h2><span id='topic+seasonality'></span>

<h3>Description</h3>

<p>Returns statistics decribing seasonal variation in runoff. </p>


<h3>Usage</h3>

<pre><code class='language-R'>seasonality(flow.ts, monthly.range = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="seasonality_+3A_flow.ts">flow.ts</code></td>
<td>

<p>Dataframe with date and discharge data in columns named &quot;Date&quot; and &quot;Q&quot; respectively. Date must be in POSIX format (see ts.format). Missing values are ignored.
</p>
</td></tr>
<tr><td><code id="seasonality_+3A_monthly.range">monthly.range</code></td>
<td>

<p>logical. If FALSE (default), the function returns the percentage of runoff occurring during the average driest 6 month period (as defined across all years). If true, additional statistics describing cumulative average monthly flows, the range between the runoff in the wettest and driest months, and the average number of months between the wettest and driest periods of runoff.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If monthly.range=FALSE (default) the function returns a dataframe with one column with the percentage of annual runoff delivered during the average driest 6 month period.
</p>
<p>If monthly.range=TRUE, the function returns a list with the following elements:
</p>
<table>
<tr><td><code>seasonality</code></td>
<td>
<p>The percentage of annual runoff delivered during the driest 6 months</p>
</td></tr>
<tr><td><code>monthly.means</code></td>
<td>
<p>Average flow in each month of the year</p>
</td></tr>
<tr><td><code>avg.ann.month.range</code></td>
<td>
<p>Average difference between the monthly minimum and maximum</p>
</td></tr>
<tr><td><code>max.min.time.dif</code></td>
<td>
<p>Average number of months between the highest and lowest monthly runoff</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Nick Bond &lt;n.bond@latrobe.edu.au&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(Cooper)
Cooper&lt;-ts.format(Cooper)

seasonality(Cooper, monthly.range=TRUE)

</code></pre>

<hr>
<h2 id='ts.format'>
Format dates as POSIXct
</h2><span id='topic+ts.format'></span>

<h3>Description</h3>

<p>Converts dates from class character (format dd/mm/yyyy or other as specified) into class POSIXct and renames columns for use with other functions in the hydrostats package.</p>


<h3>Usage</h3>

<pre><code class='language-R'>ts.format(x, format="%d/%m/%Y", cols=c(1,2))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ts.format_+3A_x">x</code></td>
<td>

<p>Dataframe including date and discharge data. Dates are assumed to be of class character (see format). The columns containing date and discharge data are required (defaults to renaming columns 1 and 2 to Date and Q respectively if no other columns are specified (see cols)).</p>
</td></tr>
<tr><td><code id="ts.format_+3A_format">format</code></td>
<td>

<p>Format of dates in existing data frame.</p>
</td></tr>
<tr><td><code id="ts.format_+3A_cols">cols</code></td>
<td>

<p>A vector of column indices for the date and discharge data. Used to rename columns.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Default assumes the date is of class character and in the first column, with discharge in the second column of the data frame. These columns can be specified if the defaults are not appropriate. The date and discharge columns are renamed to 'Date' and 'Q' respectively. For more flexibility in formatting dates/times see the lubridate package.</p>


<h3>Value</h3>

<p>A dataframe with the dates formatted as POSIXct and named columns Date and Q.  
</p>


<h3>Author(s)</h3>

<p>Nick Bond &lt;n.bond@latrobe.edu.au&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Cooper)
Cooper&lt;-ts.format(Cooper)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
