<!DOCTYPE html><html lang="en-US"><head><title>Help for package nosoi</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {nosoi}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#add_node_tip'><p>Add one tip</p></a></li>
<li><a href='#applyFunctionToHosts'><p>Apply a function to table.host</p></a></li>
<li><a href='#CoreSanityChecks'><p>Checks if the simulator can start</p></a></li>
<li><a href='#cumulativeInfected'><p>Cumulative number of infected hosts at time t</p></a></li>
<li><a href='#drawBernouilli'><p>Draw newly infected</p></a></li>
<li><a href='#dualContinuous'><p>Dual-host pathogen in structured (continuous) hosts populations</p></a></li>
<li><a href='#dualDiscrete'><p>Dual-host pathogen in structured (discrete) hosts populations</p></a></li>
<li><a href='#dualNone'><p>Dual-host pathogen in homogeneous hosts populations</p></a></li>
<li><a href='#endMessage'><p>End message</p></a></li>
<li><a href='#FunctionSanityChecks'><p>Checks if a function is properly formatted</p></a></li>
<li><a href='#get_node'><p>Get Node</p></a></li>
<li><a href='#get_other_count'><p>Get host count from table</p></a></li>
<li><a href='#get_position'><p>Get Position on branch</p></a></li>
<li><a href='#get_state'><p>Get State at sampling time</p></a></li>
<li><a href='#getCumulative'><p>Gets the cumulative number of infected hosts for the full length of the simulation</p></a></li>
<li><a href='#getDynamic'><p>Gets the current number of infected hosts for the full length of the simulation</p></a></li>
<li><a href='#getExitingMoving'><p>Get Exiting or Moving individuals</p></a></li>
<li><a href='#getHostData'><p>Extracts specific data from a <code>nosoiSim</code> object</p></a></li>
<li><a href='#getPositionInfected'><p>get Position Infected</p></a></li>
<li><a href='#getR0'><p>Gets R0 from a <code>nosoi</code> simulation</p></a></li>
<li><a href='#getTableHosts'><p>Extracts <code>table.hosts</code> from a <code>nosoiSim</code> object</p></a></li>
<li><a href='#getTableState'><p>Extracts <code>table.state</code> from a <code>nosoiSim</code> object</p></a></li>
<li><a href='#getTransmissionTree'><p>Gets the full transmission tree (phylogenetic tree-like) from a <code>nosoi</code> simulation</p></a></li>
<li><a href='#iniTable'><p>Generates initial table to start the simulation (internal function)</p></a></li>
<li><a href='#iniTableState'><p>Generates initial movement table to start the simulation (internal function)</p></a></li>
<li><a href='#keep.tip.treedata'><p>Keep tips</p></a></li>
<li><a href='#keepState'><p>Should we build the table.host table</p></a></li>
<li><a href='#makeMoves'><p>Make Move function</p></a></li>
<li><a href='#MatrixSanityChecks'><p>Checks if the matrix is properly formatted</p></a></li>
<li><a href='#meetTransmit'><p>Meet Transmit function</p></a></li>
<li><a href='#merge_host_tables'><p>Merge Population Data</p></a></li>
<li><a href='#moveFunction.continuous'><p>Make Continuous Move function</p></a></li>
<li><a href='#moveFunction.discrete'><p>Make Discrete Move function</p></a></li>
<li><a href='#moveRotateContinuous'><p>Rotates movement in 2D space</p></a></li>
<li><a href='#newLine'><p>Creates a new line to be added to the table when new host is infected (internal function)</p></a></li>
<li><a href='#newLineState'><p>Creates a new line to be added to the movement table when hosts moves (internal function)</p></a></li>
<li><a href='#nosoiSim'><p>Top-level function to use <code>nosoi</code>.</p></a></li>
<li><a href='#nosoiSimConstructor'><p>nosoiSim Constructor</p></a></li>
<li><a href='#nosoiSimOneConstructor'><p>nosoiSimOne Constructor</p></a></li>
<li><a href='#nosoiSummary'><p>Summarizes the epidemiological features of a <code>nosoi</code> simulation</p></a></li>
<li><a href='#numberInfected'><p>Number of active infected hosts at time t</p></a></li>
<li><a href='#numberInfectedBGW'><p>Number of infected hosts at time t (BGW)</p></a></li>
<li><a href='#numberInfectedStates'><p>Number of active infected hosts at time t</p></a></li>
<li><a href='#paramConstructor'><p>Param concatenator</p></a></li>
<li><a href='#parseFunction'><p>Parse function for later use</p></a></li>
<li><a href='#progressMessage'><p>Progress bar</p></a></li>
<li><a href='#RasterSanityChecks'><p>Checks if the raster is properly formatted</p></a></li>
<li><a href='#sampleTransmissionTree'><p>Sample the transmission tree (phylogenetic tree-like)</p></a></li>
<li><a href='#sampleTransmissionTreeFromExiting'><p>Sample the transmission tree (phylogenetic tree-like) among the exited hosts</p></a></li>
<li><a href='#singleContinuous'><p>Single-host pathogen in a structured (continuous) host population</p></a></li>
<li><a href='#singleDiscrete'><p>Single-host pathogen in a structured (discrete) host population</p></a></li>
<li><a href='#singleNone'><p>Single-host pathogen in a homogeneous host population</p></a></li>
<li><a href='#updateHostCount'><p>Summarise position of hosts in a discrete or discretized (raster) space</p></a></li>
<li><a href='#updateTableState'><p>Update table state with exiting individuals</p></a></li>
<li><a href='#writeInfected'><p>Write newly infected function</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>A Forward Agent-Based Transmission Chain Simulator</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.2</td>
</tr>
<tr>
<td>Description:</td>
<td>The aim of 'nosoi' (pronounced no.si) is to provide a flexible agent-based stochastic transmission chain/epidemic simulator (Lequime et al. Methods in Ecology and Evolution 11:1002-1007). It is named after the daimones of plague, sickness and disease that escaped Pandora's jar in the Greek mythology. 'nosoi' is able to take into account the influence of multiple variable on the transmission process (e.g. dual-host systems (such as arboviruses), within-host viral dynamics, transportation, population structure), alone or taken together, to create complex but relatively intuitive epidemiological simulations.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/slequime/nosoi">https://github.com/slequime/nosoi</a>,
<a href="https://slequime.github.io/nosoi/">https://slequime.github.io/nosoi/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/slequime/nosoi/issues">https://github.com/slequime/nosoi/issues</a></td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Depends:</td>
<td>data.table (&ge; 1.12.0), R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats (&ge; 3.5.2), methods (&ge; 3.5.2), raster (&ge; 2.8-19)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 2.1.0), knitr, rmarkdown, igraph, ggplot2,
ggnetwork, intergraph, viridis, gifski, png, gganimate, ape (&ge;
5.3), tidytree (&ge; 0.3.3), treeio (&ge; 1.14.0), ggtree (&ge;
2.4.0), magrittr (&ge; 1.5), dplyr (&ge; 0.8.0), covr</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-09 12:29:40 UTC; slequime</td>
</tr>
<tr>
<td>Author:</td>
<td>Sebastian Lequime <a href="https://orcid.org/0000-0002-3140-0651"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Paul Bastide <a href="https://orcid.org/0000-0002-8084-9893"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Simon Dellicour <a href="https://orcid.org/0000-0001-9558-1052"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Philippe Lemey <a href="https://orcid.org/0000-0003-2826-5353"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Guy Baele <a href="https://orcid.org/0000-0002-1915-7732"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Thijs Janzen <a href="https://orcid.org/0000-0002-4162-1140"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Sebastian Lequime &lt;sebastian.lequime@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-09 12:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='add_node_tip'>Add one tip</h2><span id='topic+add_node_tip'></span>

<h3>Description</h3>

<p>Add a tip to the transmission tree corresponding to the sampled individual.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_node_tip(tree, host, time, label, state)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="add_node_tip_+3A_tree">tree</code></td>
<td>
<p>transmission tree of class <code>treedata</code>, result of <code><a href="#topic+getTransmissionTree">getTransmissionTree</a></code></p>
</td></tr>
<tr><td><code id="add_node_tip_+3A_host">host</code></td>
<td>
<p>ID of the host</p>
</td></tr>
<tr><td><code id="add_node_tip_+3A_time">time</code></td>
<td>
<p>time of the sampling event</p>
</td></tr>
<tr><td><code id="add_node_tip_+3A_label">label</code></td>
<td>
<p>label of the new tip to be added</p>
</td></tr>
<tr><td><code id="add_node_tip_+3A_state">state</code></td>
<td>
<p>state of the sampled individual</p>
</td></tr>
</table>


<h3>Value</h3>

<p>modified tree, with on extra tip of length zero at the right place of the tree
</p>

<hr>
<h2 id='applyFunctionToHosts'>Apply a function to table.host</h2><span id='topic+applyFunctionToHosts'></span>

<h3>Description</h3>

<p>Return a vector of the results of the function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>applyFunctionToHosts(res, pres.time, pasedFunction, active.hosts)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="applyFunctionToHosts_+3A_res">res</code></td>
<td>
<p>an object of class <code>nosoiSimOne</code>.</p>
</td></tr>
<tr><td><code id="applyFunctionToHosts_+3A_pres.time">pres.time</code></td>
<td>
<p>current time</p>
</td></tr>
<tr><td><code id="applyFunctionToHosts_+3A_pasedfunction">pasedFunction</code></td>
<td>
<p>parsed exit/moving function</p>
</td></tr>
<tr><td><code id="applyFunctionToHosts_+3A_active.hosts">active.hosts</code></td>
<td>
<p>a boolean vector of active hosts</p>
</td></tr>
</table>


<h3>Value</h3>

<p>result vector
</p>

<hr>
<h2 id='CoreSanityChecks'>Checks if the simulator can start</h2><span id='topic+CoreSanityChecks'></span>

<h3>Description</h3>

<p>Checks if the simulator can start: did the user provide a length, a maximum number of infected individuals and a number of &quot;seeding&quot; individuals?
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CoreSanityChecks(length.sim, max.infected, init.individuals)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="CoreSanityChecks_+3A_length.sim">length.sim</code></td>
<td>
<p>specifies the length (in unit of time) over which the simulation should be run.</p>
</td></tr>
<tr><td><code id="CoreSanityChecks_+3A_max.infected">max.infected</code></td>
<td>
<p>specifies the maximum number of hosts that can be infected in the simulation.</p>
</td></tr>
<tr><td><code id="CoreSanityChecks_+3A_init.individuals">init.individuals</code></td>
<td>
<p>number of initially infected individuals.</p>
</td></tr>
</table>

<hr>
<h2 id='cumulativeInfected'>Cumulative number of infected hosts at time t</h2><span id='topic+cumulativeInfected'></span>

<h3>Description</h3>

<p>For a given time t, this function returns the cumulative number of infected units since the start of the simulation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cumulativeInfected(table.nosoi, t)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cumulativeInfected_+3A_table.nosoi">table.nosoi</code></td>
<td>
<p>result of function <code><a href="#topic+nosoiSim">nosoiSim</a></code></p>
</td></tr>
<tr><td><code id="cumulativeInfected_+3A_t">t</code></td>
<td>
<p>time (integer)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Number of infected units at time t
</p>


<h3>See Also</h3>

<p><code><a href="#topic+nosoiSim">nosoiSim</a></code>
</p>

<hr>
<h2 id='drawBernouilli'>Draw newly infected</h2><span id='topic+drawBernouilli'></span>

<h3>Description</h3>

<p>For each encounter, simulate whether a new individual is infected.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>drawBernouilli(p)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="drawBernouilli_+3A_p">p</code></td>
<td>
<p>vector of size K, giving the probability that each encounter
leads to an infection.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Boolean vector giving the newly infected individuals.
</p>

<hr>
<h2 id='dualContinuous'>Dual-host pathogen in structured (continuous) hosts populations</h2><span id='topic+dualContinuous'></span>

<h3>Description</h3>

<p>This function runs a dual-host transmission chain simulation, with structured hosts populations (such as spatial features) in a shared continuous space.
The simulation stops either at the end of given time (specified by length.sim) or when the number of hosts infected threshold (max.infected)
is passed. The movement of hosts on the continuous space map is a random walk (Brownian motion) that can be modified towards a biased random walk where hosts tend to be attracted to higher values of the environmental variable defined by the raster.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dualContinuous(
  length.sim,
  max.infected.A,
  max.infected.B,
  init.individuals.A,
  init.individuals.B,
  init.structure.A,
  init.structure.B,
  structure.raster.A,
  structure.raster.B,
  pExit.A,
  param.pExit.A,
  timeDep.pExit.A = FALSE,
  diff.pExit.A = FALSE,
  hostCount.pExit.A = FALSE,
  pMove.A,
  param.pMove.A,
  timeDep.pMove.A = FALSE,
  diff.pMove.A = FALSE,
  hostCount.pMove.A = FALSE,
  sdMove.A,
  param.sdMove.A,
  diff.sdMove.A = FALSE,
  timeDep.sdMove.A = FALSE,
  hostCount.sdMove.A = FALSE,
  attracted.by.raster.A = FALSE,
  nContact.A,
  param.nContact.A,
  timeDep.nContact.A = FALSE,
  diff.nContact.A = FALSE,
  hostCount.nContact.A = FALSE,
  pTrans.A,
  param.pTrans.A,
  timeDep.pTrans.A = FALSE,
  diff.pTrans.A = FALSE,
  hostCount.pTrans.A = FALSE,
  prefix.host.A = "H",
  pExit.B,
  param.pExit.B,
  timeDep.pExit.B = FALSE,
  diff.pExit.B = FALSE,
  hostCount.pExit.B = FALSE,
  pMove.B,
  param.pMove.B,
  timeDep.pMove.B = FALSE,
  diff.pMove.B = FALSE,
  hostCount.pMove.B = FALSE,
  sdMove.B,
  param.sdMove.B,
  diff.sdMove.B = FALSE,
  timeDep.sdMove.B = FALSE,
  hostCount.sdMove.B = FALSE,
  attracted.by.raster.B = FALSE,
  nContact.B,
  param.nContact.B,
  timeDep.nContact.B = FALSE,
  diff.nContact.B = FALSE,
  hostCount.nContact.B = FALSE,
  pTrans.B,
  param.pTrans.B,
  timeDep.pTrans.B = FALSE,
  diff.pTrans.B = FALSE,
  hostCount.pTrans.B = FALSE,
  prefix.host.B = "V",
  print.progress = TRUE,
  print.step = 10
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dualContinuous_+3A_length.sim">length.sim</code></td>
<td>
<p>specifies the length (in unit of time) over which the simulation should be run.</p>
</td></tr>
<tr><td><code id="dualContinuous_+3A_max.infected.a">max.infected.A</code></td>
<td>
<p>specifies the maximum number of individual hosts A that can be infected in the simulation.</p>
</td></tr>
<tr><td><code id="dualContinuous_+3A_max.infected.b">max.infected.B</code></td>
<td>
<p>specifies the maximum number of individual hosts B that can be infected in the simulation.</p>
</td></tr>
<tr><td><code id="dualContinuous_+3A_init.individuals.a">init.individuals.A</code></td>
<td>
<p>number of initially infected individuals (hosts A).</p>
</td></tr>
<tr><td><code id="dualContinuous_+3A_init.individuals.b">init.individuals.B</code></td>
<td>
<p>number of initially infected individuals (hosts B).</p>
</td></tr>
<tr><td><code id="dualContinuous_+3A_init.structure.a">init.structure.A</code></td>
<td>
<p>in which location the initially infected host-A individuals are located. A vector of coordinates in the same coordinate space as the raster (NA if init.individual.A is 0).</p>
</td></tr>
<tr><td><code id="dualContinuous_+3A_init.structure.b">init.structure.B</code></td>
<td>
<p>in which location the initially infected host-B individuals are located. A vector of coordinates in the same coordinate space as the raster (NA if init.individual.B is 0).</p>
</td></tr>
<tr><td><code id="dualContinuous_+3A_structure.raster.a">structure.raster.A</code></td>
<td>
<p>raster object defining the environmental variable for host-type A.</p>
</td></tr>
<tr><td><code id="dualContinuous_+3A_structure.raster.b">structure.raster.B</code></td>
<td>
<p>raster object defining the environmental variable for host B.</p>
</td></tr>
<tr><td><code id="dualContinuous_+3A_pexit.a">pExit.A</code></td>
<td>
<p>function that gives the probability to exit the simulation for an infected host A (either moving out, dying, etc.).</p>
</td></tr>
<tr><td><code id="dualContinuous_+3A_param.pexit.a">param.pExit.A</code></td>
<td>
<p>parameter names (list of functions) for the pExit for host-type A.</p>
</td></tr>
<tr><td><code id="dualContinuous_+3A_timedep.pexit.a">timeDep.pExit.A</code></td>
<td>
<p>is pExit of host-type A dependent on the absolute time of the simulation (TRUE/FALSE)?</p>
</td></tr>
<tr><td><code id="dualContinuous_+3A_diff.pexit.a">diff.pExit.A</code></td>
<td>
<p>does pExit of host-type A depend on the environmental variable (set by the raster) (TRUE/FALSE).</p>
</td></tr>
<tr><td><code id="dualContinuous_+3A_hostcount.pexit.a">hostCount.pExit.A</code></td>
<td>
<p>does pExit of host-type A vary with the host count (of either host-type A or B) in each raster cell? (TRUE/FALSE); if TRUE, diff.pExit.A should be TRUE.</p>
</td></tr>
<tr><td><code id="dualContinuous_+3A_pmove.a">pMove.A</code></td>
<td>
<p>function that gives the probability of a host moving as a function of time for host-type A.</p>
</td></tr>
<tr><td><code id="dualContinuous_+3A_param.pmove.a">param.pMove.A</code></td>
<td>
<p>parameter names (list of functions) for the pMove for host-type A.</p>
</td></tr>
<tr><td><code id="dualContinuous_+3A_timedep.pmove.a">timeDep.pMove.A</code></td>
<td>
<p>is pMove of host-type A dependent on the absolute time of the simulation (TRUE/FALSE)?</p>
</td></tr>
<tr><td><code id="dualContinuous_+3A_diff.pmove.a">diff.pMove.A</code></td>
<td>
<p>does pMove of host-type A depend on the environmental variable (set by the raster) (TRUE/FALSE).A.</p>
</td></tr>
<tr><td><code id="dualContinuous_+3A_hostcount.pmove.a">hostCount.pMove.A</code></td>
<td>
<p>does pMove of host-type A vary with the host count (of either host-type A or B) in each raster cell? (TRUE/FALSE); if TRUE, diff.pMove.A should be TRUE.</p>
</td></tr>
<tr><td><code id="dualContinuous_+3A_sdmove.a">sdMove.A</code></td>
<td>
<p>function that gives the distance traveled for host-type A (based on coordinates); output is the standard deviation value for the Brownian motion.</p>
</td></tr>
<tr><td><code id="dualContinuous_+3A_param.sdmove.a">param.sdMove.A</code></td>
<td>
<p>parameter names (list of functions) for sdMove for host-type A.</p>
</td></tr>
<tr><td><code id="dualContinuous_+3A_diff.sdmove.a">diff.sdMove.A</code></td>
<td>
<p>does sdMove of host-type A depend on the environmental variable (set by the raster) (TRUE/FALSE).</p>
</td></tr>
<tr><td><code id="dualContinuous_+3A_timedep.sdmove.a">timeDep.sdMove.A</code></td>
<td>
<p>is sdMove of host-type A dependent on the absolute time of the simulation (TRUE/FALSE) ?</p>
</td></tr>
<tr><td><code id="dualContinuous_+3A_hostcount.sdmove.a">hostCount.sdMove.A</code></td>
<td>
<p>does sdMove varies with the host count (of either host-type A or B) in each raster cell? (TRUE/FALSE); diff.sdMove.A should be TRUE.</p>
</td></tr>
<tr><td><code id="dualContinuous_+3A_attracted.by.raster.a">attracted.by.raster.A</code></td>
<td>
<p>should the host-type A be attracted by higher values in the environmental raster? (TRUE/FALSE).</p>
</td></tr>
<tr><td><code id="dualContinuous_+3A_ncontact.a">nContact.A</code></td>
<td>
<p>function that gives the number of potential transmission events per unit of time for host-type A.</p>
</td></tr>
<tr><td><code id="dualContinuous_+3A_param.ncontact.a">param.nContact.A</code></td>
<td>
<p>parameter names (list of functions) for param.nContact for host-type A.</p>
</td></tr>
<tr><td><code id="dualContinuous_+3A_timedep.ncontact.a">timeDep.nContact.A</code></td>
<td>
<p>is nContact of host-type A dependent on the absolute time of the simulation (TRUE/FALSE)?</p>
</td></tr>
<tr><td><code id="dualContinuous_+3A_diff.ncontact.a">diff.nContact.A</code></td>
<td>
<p>does nContact of host-type A depend on the environmental variable (set by the raster) (TRUE/FALSE).</p>
</td></tr>
<tr><td><code id="dualContinuous_+3A_hostcount.ncontact.a">hostCount.nContact.A</code></td>
<td>
<p>does nContact vary with the host count (of either host-type A or B) in each raster cell?? (TRUE/FALSE); diff.nContact.A should be TRUE.</p>
</td></tr>
<tr><td><code id="dualContinuous_+3A_ptrans.a">pTrans.A</code></td>
<td>
<p>function that gives the probability of transmit a pathogen as a function of time since infection for host A.</p>
</td></tr>
<tr><td><code id="dualContinuous_+3A_param.ptrans.a">param.pTrans.A</code></td>
<td>
<p>parameter names (list of functions) for the pExit  for host A.</p>
</td></tr>
<tr><td><code id="dualContinuous_+3A_timedep.ptrans.a">timeDep.pTrans.A</code></td>
<td>
<p>is pTrans of host-type A dependent on the absolute time of the simulation (TRUE/FALSE)?</p>
</td></tr>
<tr><td><code id="dualContinuous_+3A_diff.ptrans.a">diff.pTrans.A</code></td>
<td>
<p>does pTrans of host-type A depend on the environmental variable (set by the raster) (TRUE/FALSE).</p>
</td></tr>
<tr><td><code id="dualContinuous_+3A_hostcount.ptrans.a">hostCount.pTrans.A</code></td>
<td>
<p>does pTrans vary with the host count (of either host-type A or B) in each raster cell? (TRUE/FALSE); diff.pTrans.A should be TRUE.</p>
</td></tr>
<tr><td><code id="dualContinuous_+3A_prefix.host.a">prefix.host.A</code></td>
<td>
<p>character(s) to be used as a prefix for the host A identification number.</p>
</td></tr>
<tr><td><code id="dualContinuous_+3A_pexit.b">pExit.B</code></td>
<td>
<p>function that gives the probability to exit the simulation for an infected host B (either moving out, dying, etc.).</p>
</td></tr>
<tr><td><code id="dualContinuous_+3A_param.pexit.b">param.pExit.B</code></td>
<td>
<p>parameter names (list of functions) for the pExit for host-type B.</p>
</td></tr>
<tr><td><code id="dualContinuous_+3A_timedep.pexit.b">timeDep.pExit.B</code></td>
<td>
<p>is pExit of host-type B dependent on the absolute time of the simulation (TRUE/FALSE)?</p>
</td></tr>
<tr><td><code id="dualContinuous_+3A_diff.pexit.b">diff.pExit.B</code></td>
<td>
<p>does pExit of host-type B depend on the environmental variable (set by the raster) (TRUE/FALSE).</p>
</td></tr>
<tr><td><code id="dualContinuous_+3A_hostcount.pexit.b">hostCount.pExit.B</code></td>
<td>
<p>does pExit of host-type B vary with the host count (of either host-type A or B) in each raster cell? (TRUE/FALSE); if TRUE, diff.pExit.B should be TRUE.</p>
</td></tr>
<tr><td><code id="dualContinuous_+3A_pmove.b">pMove.B</code></td>
<td>
<p>function that gives the probability of a host moving as a function of time for host-type B.</p>
</td></tr>
<tr><td><code id="dualContinuous_+3A_param.pmove.b">param.pMove.B</code></td>
<td>
<p>parameter names (list of functions) for the pMove for host-type B.</p>
</td></tr>
<tr><td><code id="dualContinuous_+3A_timedep.pmove.b">timeDep.pMove.B</code></td>
<td>
<p>is sdMove of host-type B dependent on the absolute time of the simulation (TRUE/FALSE) for host-type B.</p>
</td></tr>
<tr><td><code id="dualContinuous_+3A_diff.pmove.b">diff.pMove.B</code></td>
<td>
<p>does pMove of host-type B depend on the environmental variable (set by the raster) (TRUE/FALSE).</p>
</td></tr>
<tr><td><code id="dualContinuous_+3A_hostcount.pmove.b">hostCount.pMove.B</code></td>
<td>
<p>does pMove of host-type B vary with the host count (of either host-type A or B) in each raster cell? (TRUE/FALSE); if TRUE, diff.pMove.B should be TRUE.</p>
</td></tr>
<tr><td><code id="dualContinuous_+3A_sdmove.b">sdMove.B</code></td>
<td>
<p>function that gives the distance traveled for host-type B (based on coordinates); output is the standard deviation value for the Brownian motion.</p>
</td></tr>
<tr><td><code id="dualContinuous_+3A_param.sdmove.b">param.sdMove.B</code></td>
<td>
<p>parameter names (list of functions) for sdMove for host-type B.</p>
</td></tr>
<tr><td><code id="dualContinuous_+3A_diff.sdmove.b">diff.sdMove.B</code></td>
<td>
<p>does sdMove of host-type B depend on the environmental variable (set by the raster) (TRUE/FALSE).</p>
</td></tr>
<tr><td><code id="dualContinuous_+3A_timedep.sdmove.b">timeDep.sdMove.B</code></td>
<td>
<p>is sdMove of host-type B dependent on the absolute time of the simulation (TRUE/FALSE) ?</p>
</td></tr>
<tr><td><code id="dualContinuous_+3A_hostcount.sdmove.b">hostCount.sdMove.B</code></td>
<td>
<p>does sdMove of host-type B vary with the host count (of either host-type A or B) in each raster cell? (TRUE/FALSE); if TRUE, diff.sdMove.B should be TRUE.</p>
</td></tr>
<tr><td><code id="dualContinuous_+3A_attracted.by.raster.b">attracted.by.raster.B</code></td>
<td>
<p>should the host-type B be attracted by higher values in the environmental raster? (TRUE/FALSE)</p>
</td></tr>
<tr><td><code id="dualContinuous_+3A_ncontact.b">nContact.B</code></td>
<td>
<p>function that gives the number of potential transmission events per unit of time for host B.</p>
</td></tr>
<tr><td><code id="dualContinuous_+3A_param.ncontact.b">param.nContact.B</code></td>
<td>
<p>parameter names (list of functions) for param.nContact for host-type B.</p>
</td></tr>
<tr><td><code id="dualContinuous_+3A_timedep.ncontact.b">timeDep.nContact.B</code></td>
<td>
<p>is nContact of host-type B dependent on the absolute time of the simulation (TRUE/FALSE)?</p>
</td></tr>
<tr><td><code id="dualContinuous_+3A_diff.ncontact.b">diff.nContact.B</code></td>
<td>
<p>does nContact of host-type B depend on the environmental variable (set by the raster) (TRUE/FALSE).</p>
</td></tr>
<tr><td><code id="dualContinuous_+3A_hostcount.ncontact.b">hostCount.nContact.B</code></td>
<td>
<p>does nContact of host-type B vary with the host count (of either host-type A or B) in each raster cell? (TRUE/FALSE); if TRUE, diff.nContact.B should be TRUE.</p>
</td></tr>
<tr><td><code id="dualContinuous_+3A_ptrans.b">pTrans.B</code></td>
<td>
<p>function that gives the probability of transmit a pathogen as a function of time since infection for host B.</p>
</td></tr>
<tr><td><code id="dualContinuous_+3A_param.ptrans.b">param.pTrans.B</code></td>
<td>
<p>parameter names (list of functions) for the pExit for host-type B.</p>
</td></tr>
<tr><td><code id="dualContinuous_+3A_timedep.ptrans.b">timeDep.pTrans.B</code></td>
<td>
<p>is pTrans of host-type B dependent on the absolute time of the simulation (TRUE/FALSE)?</p>
</td></tr>
<tr><td><code id="dualContinuous_+3A_diff.ptrans.b">diff.pTrans.B</code></td>
<td>
<p>does pTrans of host-type B depend on the environmental variable (set by the raster) (TRUE/FALSE).</p>
</td></tr>
<tr><td><code id="dualContinuous_+3A_hostcount.ptrans.b">hostCount.pTrans.B</code></td>
<td>
<p>does pTrans of host-type B vary with the host count (of either host-type A or B) in each raster cell? (TRUE/FALSE); if TRUE, diff.pTrans.B should be TRUE.</p>
</td></tr>
<tr><td><code id="dualContinuous_+3A_prefix.host.b">prefix.host.B</code></td>
<td>
<p>character(s) to be used as a prefix for the host B identification number.</p>
</td></tr>
<tr><td><code id="dualContinuous_+3A_print.progress">print.progress</code></td>
<td>
<p>if TRUE, displays a progress bar (current time/length.sim).</p>
</td></tr>
<tr><td><code id="dualContinuous_+3A_print.step">print.step</code></td>
<td>
<p>print.progress is TRUE, step with which the progress message will be printed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>pExit</code> and <code>pTrans</code> functions should return a single probability (a number between 0 and 1), and <code>nContact</code> a positive natural number (positive integer) or 0.
</p>
<p>The <code>param</code> arguments should be a list of functions or NA. Each item name in the parameter list should have the same name as the argument in the corresponding function.
</p>
<p>The use of <code>timeDep</code> (switch to <code>TRUE</code>) makes the corresponding function use the argument <code>prestime</code> (for &quot;present time&quot;).
</p>


<h3>Value</h3>

<p>An object of class <code><a href="#topic+nosoiSim">nosoiSim</a></code>, containing all results of the simulation.
</p>


<h3>Raster</h3>

<p>The structure raster(s) provided provided should of class <code>raster</code>. High values of the environmental variable can attract hosts if <code>attracted.by.raster</code> is TRUE. Raster have to share the same space (i.e. also the same cell size and ID).
</p>


<h3>Order of Arguments</h3>

<p>The user specified function's arguments should follow this order: <code>t</code> (mandatory), <code>prestime</code> (optional, only if timeDep is TRUE),
<code>current.env.value</code> (optional, only if diff is TRUE), <code>host.count.A</code> or <code>host.count.B</code> (optional, only if hostCount is TRUE) and <code>parameters</code> specified in the list.
</p>


<h3>Structure Parameters</h3>

<p>The <code>pMove</code> function should return a single probability (a number between 0 and 1), and <code>sdMove</code> a real number (keep in mind this number is related to your coordinate space).
</p>
<p>The use of <code>diff</code> (switch to <code>TRUE</code>) makes the corresponding function use the argument <code>current.env.value</code> (for &quot;current environmental value&quot;).
</p>
<p>The use of <code>hostCount</code> (switch to <code>TRUE</code>) makes the corresponding function use the argument <code>host.count</code>.
</p>


<h3>Suffixes</h3>

<p>The suffix <code>.A</code> or <code>.B</code> specifies if the considered function or parameter concerns host type A or B.
</p>


<h3>See Also</h3>

<p>For simulations with a discrete structure, see <code><a href="#topic+dualDiscrete">dualDiscrete</a></code>. For simulations without any structures, see <code><a href="#topic+dualNone">dualNone</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(raster)

#Generating a raster for the movement
set.seed(860)

test.raster &lt;- raster(nrows=100, ncols=100, xmn=-50, xmx=50, ymn=-50,ymx=50)
test.raster[] &lt;- runif(10000, -80, 180)
test.raster &lt;- focal(focal(test.raster, w=matrix(1, 5, 5), mean), w=matrix(1, 5, 5), mean)

t_incub_fct &lt;- function(x){rnorm(x,mean = 5,sd=1)}
p_max_fct &lt;- function(x){rbeta(x,shape1 = 5,shape2=2)}
p_Move_fct  &lt;- function(t){return(0.1)}

sdMove_fct = function(t,current.env.value){return(100/(current.env.value+1))}

p_Exit_fct  &lt;- function(t){return(0.08)}

proba &lt;- function(t,p_max,t_incub){
 if(t &lt;= t_incub){p=0}
 if(t &gt;= t_incub){p=p_max}
 return(p)
}

time_contact = function(t){round(rnorm(1, 3, 1), 0)}

start.pos &lt;- c(0,0)

set.seed(805)
test.nosoi &lt;- nosoiSim(type="dual", popStructure="continuous",
                      length.sim=200,
                      max.infected.A=500,
                      max.infected.B=500,
                      init.individuals.A=1,
                      init.individuals.B=0,
                      init.structure.A=start.pos,
                      init.structure.B=NA,
                      structure.raster.A=test.raster,
                      structure.raster.B=test.raster,
                      pExit.A=p_Exit_fct,
                      param.pExit.A=NA,
                      timeDep.pExit.A=FALSE,
                      diff.pExit.A=FALSE,
                      pMove.A=p_Move_fct,
                      param.pMove.A=NA,
                      timeDep.pMove.A=FALSE,
                      diff.pMove.A=FALSE,
                      diff.sdMove.A=TRUE,
                      sdMove.A=sdMove_fct,
                      param.sdMove.A=NA,
                      attracted.by.raster.A=TRUE,
                      nContact.A=time_contact,
                      param.nContact.A=NA,
                      timeDep.nContact.A=FALSE,
                      diff.nContact.A=FALSE,
                      pTrans.A=proba,
                      param.pTrans.A=list(p_max=p_max_fct,
                                          t_incub=t_incub_fct),
                      timeDep.pTrans.A=FALSE,
                      diff.pTrans.A=FALSE,
                      prefix.host.A="H",
                      pExit.B=p_Exit_fct,
                      param.pExit.B=NA,
                      timeDep.pExit.B=FALSE,
                      diff.pExit.B=FALSE,
                      pMove.B=p_Move_fct,
                      param.pMove.B=NA,
                      timeDep.pMove.B=FALSE,
                      diff.pMove.B=FALSE,
                      diff.sdMove.B=TRUE,
                      sdMove.B=sdMove_fct,
                      param.sdMove.B=NA,
                      attracted.by.raster.B=TRUE,
                      nContact.B=time_contact,
                      param.nContact.B=NA,
                      timeDep.nContact.B=FALSE,
                      diff.nContact.B=FALSE,
                      pTrans.B=proba,
                      param.pTrans.B=list(p_max=p_max_fct,
                                          t_incub=t_incub_fct),
                      timeDep.pTrans.B=FALSE,
                      diff.pTrans.B=FALSE,
                      prefix.host.B="V")
test.nosoi


</code></pre>

<hr>
<h2 id='dualDiscrete'>Dual-host pathogen in structured (discrete) hosts populations</h2><span id='topic+dualDiscrete'></span>

<h3>Description</h3>

<p>This function, that can be wrapped within <code><a href="#topic+nosoiSim">nosoiSim</a></code>, runs a dual-host transmission chain simulation, with discrete hosts populations structures (e.g. spatial, socio-economic, etc.). The simulation stops either at
the end of given time (specified by <code>length.sim</code>) or when the number of hosts infected threshold (<code>max.infected</code>) is crossed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dualDiscrete(
  length.sim,
  max.infected.A,
  max.infected.B,
  init.individuals.A,
  init.individuals.B,
  init.structure.A,
  init.structure.B,
  structure.matrix.A,
  structure.matrix.B,
  pExit.A,
  param.pExit.A,
  timeDep.pExit.A = FALSE,
  diff.pExit.A = FALSE,
  hostCount.pExit.A = FALSE,
  pMove.A,
  param.pMove.A,
  timeDep.pMove.A = FALSE,
  diff.pMove.A = FALSE,
  hostCount.pMove.A = FALSE,
  nContact.A,
  param.nContact.A,
  timeDep.nContact.A = FALSE,
  diff.nContact.A = FALSE,
  hostCount.nContact.A = FALSE,
  pTrans.A,
  param.pTrans.A,
  timeDep.pTrans.A = FALSE,
  diff.pTrans.A = FALSE,
  hostCount.pTrans.A = FALSE,
  prefix.host.A = "H",
  pExit.B,
  param.pExit.B,
  timeDep.pExit.B = FALSE,
  diff.pExit.B = FALSE,
  hostCount.pExit.B = FALSE,
  pMove.B,
  param.pMove.B,
  timeDep.pMove.B = FALSE,
  diff.pMove.B = FALSE,
  hostCount.pMove.B = FALSE,
  nContact.B,
  param.nContact.B,
  timeDep.nContact.B = FALSE,
  diff.nContact.B = FALSE,
  hostCount.nContact.B = FALSE,
  pTrans.B,
  param.pTrans.B,
  timeDep.pTrans.B = FALSE,
  diff.pTrans.B = FALSE,
  hostCount.pTrans.B = FALSE,
  prefix.host.B = "V",
  print.progress = TRUE,
  print.step = 10
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dualDiscrete_+3A_length.sim">length.sim</code></td>
<td>
<p>specifies the length (in unit of time) over which the simulation should be run.</p>
</td></tr>
<tr><td><code id="dualDiscrete_+3A_max.infected.a">max.infected.A</code></td>
<td>
<p>specifies the maximum number of individual hosts A that can be infected in the simulation.</p>
</td></tr>
<tr><td><code id="dualDiscrete_+3A_max.infected.b">max.infected.B</code></td>
<td>
<p>specifies the maximum number of individual hosts B that can be infected in the simulation.</p>
</td></tr>
<tr><td><code id="dualDiscrete_+3A_init.individuals.a">init.individuals.A</code></td>
<td>
<p>number of initially infected individuals (hosts A).</p>
</td></tr>
<tr><td><code id="dualDiscrete_+3A_init.individuals.b">init.individuals.B</code></td>
<td>
<p>number of initially infected individuals (hosts B).</p>
</td></tr>
<tr><td><code id="dualDiscrete_+3A_init.structure.a">init.structure.A</code></td>
<td>
<p>in which state (e.g. location) the initially infected individuals of host-type A are located (<code>NA</code> if init.individual.A is 0)?</p>
</td></tr>
<tr><td><code id="dualDiscrete_+3A_init.structure.b">init.structure.B</code></td>
<td>
<p>in which state (e.g. location) the initially infected individuals of host-type B are located (<code>NA</code> if init.individual.B is 0)?</p>
</td></tr>
<tr><td><code id="dualDiscrete_+3A_structure.matrix.a">structure.matrix.A</code></td>
<td>
<p>transition matrix (probabilities) to go from location A (row) to B (column) for host-type A.</p>
</td></tr>
<tr><td><code id="dualDiscrete_+3A_structure.matrix.b">structure.matrix.B</code></td>
<td>
<p>transition matrix (probabilities) to go from location A (row) to B (column) for host-type B.</p>
</td></tr>
<tr><td><code id="dualDiscrete_+3A_pexit.a">pExit.A</code></td>
<td>
<p>function that gives the probability to exit the simulation for an infected host A (either moving out, dying, etc.).</p>
</td></tr>
<tr><td><code id="dualDiscrete_+3A_param.pexit.a">param.pExit.A</code></td>
<td>
<p>parameter names (list of functions) for the pExit for host-type A.</p>
</td></tr>
<tr><td><code id="dualDiscrete_+3A_timedep.pexit.a">timeDep.pExit.A</code></td>
<td>
<p>is pExit of host-type A dependent on the absolute time of the simulation (TRUE/FALSE)?</p>
</td></tr>
<tr><td><code id="dualDiscrete_+3A_diff.pexit.a">diff.pExit.A</code></td>
<td>
<p>is pExit of host-type A different between states of the structured population (TRUE/FALSE)?</p>
</td></tr>
<tr><td><code id="dualDiscrete_+3A_hostcount.pexit.a">hostCount.pExit.A</code></td>
<td>
<p>does pExit of host-type A vary with the host count (of either host-type A or B) in the state? (TRUE/FALSE); diff.pExit.A should be TRUE.</p>
</td></tr>
<tr><td><code id="dualDiscrete_+3A_pmove.a">pMove.A</code></td>
<td>
<p>function that gives the probability of a host moving as a function of time for host-type A.</p>
</td></tr>
<tr><td><code id="dualDiscrete_+3A_param.pmove.a">param.pMove.A</code></td>
<td>
<p>parameter names (list of functions) for the pMove for host-type A.</p>
</td></tr>
<tr><td><code id="dualDiscrete_+3A_timedep.pmove.a">timeDep.pMove.A</code></td>
<td>
<p>is pMove of host-type A dependent on the absolute time of the simulation (TRUE/FALSE)?</p>
</td></tr>
<tr><td><code id="dualDiscrete_+3A_diff.pmove.a">diff.pMove.A</code></td>
<td>
<p>is pMove of host-type A different between states of the structured population (TRUE/FALSE)?</p>
</td></tr>
<tr><td><code id="dualDiscrete_+3A_hostcount.pmove.a">hostCount.pMove.A</code></td>
<td>
<p>does pMove of host-type A vary with the host count (of either host A or B) in the state? (TRUE/FALSE); diff.pMove.A should be TRUE.</p>
</td></tr>
<tr><td><code id="dualDiscrete_+3A_ncontact.a">nContact.A</code></td>
<td>
<p>function that gives the number of potential transmission events per unit of time for host-type A.</p>
</td></tr>
<tr><td><code id="dualDiscrete_+3A_param.ncontact.a">param.nContact.A</code></td>
<td>
<p>parameter names (list of functions) for param.nContact for host-type A.</p>
</td></tr>
<tr><td><code id="dualDiscrete_+3A_timedep.ncontact.a">timeDep.nContact.A</code></td>
<td>
<p>is nContact of host-type A dependent on the absolute time of the simulation (TRUE/FALSE)?</p>
</td></tr>
<tr><td><code id="dualDiscrete_+3A_diff.ncontact.a">diff.nContact.A</code></td>
<td>
<p>is nContact of host-type A different between states of the structured population (TRUE/FALSE)?</p>
</td></tr>
<tr><td><code id="dualDiscrete_+3A_hostcount.ncontact.a">hostCount.nContact.A</code></td>
<td>
<p>does nContact of host-type A vary with the host count (of either host A or B) in the state? (TRUE/FALSE); diff.nContact.A should be TRUE.</p>
</td></tr>
<tr><td><code id="dualDiscrete_+3A_ptrans.a">pTrans.A</code></td>
<td>
<p>function that gives the probability of transmit a pathogen as a function of time since infection for host A.</p>
</td></tr>
<tr><td><code id="dualDiscrete_+3A_param.ptrans.a">param.pTrans.A</code></td>
<td>
<p>parameter names (list of functions) for the pExit  for host A.</p>
</td></tr>
<tr><td><code id="dualDiscrete_+3A_timedep.ptrans.a">timeDep.pTrans.A</code></td>
<td>
<p>is pTrans of host-type A dependent on the absolute time of the simulation (TRUE/FALSE)?</p>
</td></tr>
<tr><td><code id="dualDiscrete_+3A_diff.ptrans.a">diff.pTrans.A</code></td>
<td>
<p>is pTrans of host-type A different between states of the structured population (TRUE/FALSE)?</p>
</td></tr>
<tr><td><code id="dualDiscrete_+3A_hostcount.ptrans.a">hostCount.pTrans.A</code></td>
<td>
<p>does pTrans of host-type A vary with the host count (of either host A or B) in the state? (TRUE/FALSE); diff.pTrans.A should be TRUE.</p>
</td></tr>
<tr><td><code id="dualDiscrete_+3A_prefix.host.a">prefix.host.A</code></td>
<td>
<p>character(s) to be used as a prefix for the host A identification number.</p>
</td></tr>
<tr><td><code id="dualDiscrete_+3A_pexit.b">pExit.B</code></td>
<td>
<p>function that gives the probability to exit the simulation for an infected host B (either moving out, dying, etc.).</p>
</td></tr>
<tr><td><code id="dualDiscrete_+3A_param.pexit.b">param.pExit.B</code></td>
<td>
<p>parameter names (list of functions) for the pExit for host-type B.</p>
</td></tr>
<tr><td><code id="dualDiscrete_+3A_timedep.pexit.b">timeDep.pExit.B</code></td>
<td>
<p>is pExit of host-type B dependent on the absolute time of the simulation (TRUE/FALSE)?</p>
</td></tr>
<tr><td><code id="dualDiscrete_+3A_diff.pexit.b">diff.pExit.B</code></td>
<td>
<p>is pExit of host-type B different between states of the structured population (TRUE/FALSE)?</p>
</td></tr>
<tr><td><code id="dualDiscrete_+3A_hostcount.pexit.b">hostCount.pExit.B</code></td>
<td>
<p>does pExit of host-type B vary with the host count (of either host A or B) in the state? (TRUE/FALSE); diff.pExit.B should be TRUE.</p>
</td></tr>
<tr><td><code id="dualDiscrete_+3A_pmove.b">pMove.B</code></td>
<td>
<p>function that gives the probability of a host moving as a function of time for host-type B.</p>
</td></tr>
<tr><td><code id="dualDiscrete_+3A_param.pmove.b">param.pMove.B</code></td>
<td>
<p>parameter names (list of functions) for the pMove for host-type B.</p>
</td></tr>
<tr><td><code id="dualDiscrete_+3A_timedep.pmove.b">timeDep.pMove.B</code></td>
<td>
<p>is sdMove of host-type B dependent on the absolute time of the simulation (TRUE/FALSE) for host-type B.</p>
</td></tr>
<tr><td><code id="dualDiscrete_+3A_diff.pmove.b">diff.pMove.B</code></td>
<td>
<p>is pMove of host-type B different between states of the structured population (TRUE/FALSE)?</p>
</td></tr>
<tr><td><code id="dualDiscrete_+3A_hostcount.pmove.b">hostCount.pMove.B</code></td>
<td>
<p>does pMove of host-type B vary with the host count (of either host A or B) in the state? (TRUE/FALSE); diff.pMove.B should be TRUE.</p>
</td></tr>
<tr><td><code id="dualDiscrete_+3A_ncontact.b">nContact.B</code></td>
<td>
<p>function that gives the number of potential transmission events per unit of time for host B.</p>
</td></tr>
<tr><td><code id="dualDiscrete_+3A_param.ncontact.b">param.nContact.B</code></td>
<td>
<p>parameter names (list of functions) for param.nContact for host-type B.</p>
</td></tr>
<tr><td><code id="dualDiscrete_+3A_timedep.ncontact.b">timeDep.nContact.B</code></td>
<td>
<p>is nContact of host-type B dependent on the absolute time of the simulation (TRUE/FALSE)?</p>
</td></tr>
<tr><td><code id="dualDiscrete_+3A_diff.ncontact.b">diff.nContact.B</code></td>
<td>
<p>is nContact of host-type B different between states of the structured population (TRUE/FALSE)?</p>
</td></tr>
<tr><td><code id="dualDiscrete_+3A_hostcount.ncontact.b">hostCount.nContact.B</code></td>
<td>
<p>does nContact of host-type B vary with the host count (of either host A or B) in the state? (TRUE/FALSE); diff.nContact.B should be TRUE.</p>
</td></tr>
<tr><td><code id="dualDiscrete_+3A_ptrans.b">pTrans.B</code></td>
<td>
<p>function that gives the probability of transmit a pathogen as a function of time since infection for host B.</p>
</td></tr>
<tr><td><code id="dualDiscrete_+3A_param.ptrans.b">param.pTrans.B</code></td>
<td>
<p>parameter names (list of functions) for the pExit for host-type B.</p>
</td></tr>
<tr><td><code id="dualDiscrete_+3A_timedep.ptrans.b">timeDep.pTrans.B</code></td>
<td>
<p>is pTrans of host-type B dependent on the absolute time of the simulation (TRUE/FALSE)?</p>
</td></tr>
<tr><td><code id="dualDiscrete_+3A_diff.ptrans.b">diff.pTrans.B</code></td>
<td>
<p>is pTrans host-type B different between states of the structured population (TRUE/FALSE)?</p>
</td></tr>
<tr><td><code id="dualDiscrete_+3A_hostcount.ptrans.b">hostCount.pTrans.B</code></td>
<td>
<p>does pTrans of host-type B vary with the host count (of either host A or B) in the state? (TRUE/FALSE); diff.pTrans.B should be TRUE.</p>
</td></tr>
<tr><td><code id="dualDiscrete_+3A_prefix.host.b">prefix.host.B</code></td>
<td>
<p>character(s) to be used as a prefix for the host B identification number.</p>
</td></tr>
<tr><td><code id="dualDiscrete_+3A_print.progress">print.progress</code></td>
<td>
<p>if TRUE, displays a progress bar (current time/length.sim).</p>
</td></tr>
<tr><td><code id="dualDiscrete_+3A_print.step">print.step</code></td>
<td>
<p>print.progress is TRUE, step with which the progress message will be printed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>pExit</code> and <code>pTrans</code> functions should return a single probability (a number between 0 and 1), and <code>nContact</code> a positive natural number (positive integer) or 0.
</p>
<p>The <code>param</code> arguments should be a list of functions or NA. Each item name in the parameter list should have the same name as the argument in the corresponding function.
</p>
<p>The use of <code>timeDep</code> (switch to <code>TRUE</code>) makes the corresponding function use the argument <code>prestime</code> (for &quot;present time&quot;).
</p>


<h3>Value</h3>

<p>An object of class <code><a href="#topic+nosoiSim">nosoiSim</a></code>, containing all results of the simulation.
</p>


<h3>Structure Matrix</h3>

<p>The structure/transition matrix provided provided should of class <code>matrix</code>, with the same number of rows and columns, rows representing departure state and column the arrival state. All rows should add to 1. Probability values can be different for hosts A and B (so two different matrices), but the name of the column and the rows should be shared.
</p>


<h3>Order of Arguments</h3>

<p>The user specified function's arguments should follow this order: <code>t</code> (mandatory), <code>prestime</code> (optional, only if timeDep is TRUE),
<code>current.in</code> (optional, only if diff is TRUE), <code>host.count.A</code> or <code>host.count.B</code> (optional, only if hostCount is TRUE) and <code>parameters</code> specified in the list.
</p>


<h3>Structure Parameters</h3>

<p>The <code>pMove</code> function should return a single probability (a number between 0 and 1).
</p>
<p>The use of <code>diff</code> (switch to <code>TRUE</code>) makes the corresponding function use the argument <code>current.in</code> (for &quot;currently in&quot;). Your function should in that case give a result for every possible discrete state.
</p>
<p>The use of <code>hostCount</code> (switch to <code>TRUE</code>) makes the corresponding function use the argument <code>host.count</code>.
</p>


<h3>Suffixes</h3>

<p>The suffix <code>.A</code> or <code>.B</code> specifies if the considered function or parameter concerns host type A or B.
</p>


<h3>See Also</h3>

<p>For simulations with a structure in continuous space, see <code><a href="#topic+dualContinuous">dualContinuous</a></code>. For simulations without any structures, see <code><a href="#topic+dualNone">dualNone</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#Host A
t_infectA_fct &lt;- function(x){rnorm(x,mean = 12,sd=3)}
pTrans_hostA &lt;- function(t,t_infectA){
 if(t/t_infectA &lt;= 1){p=sin(pi*t/t_infectA)}
 if(t/t_infectA &gt; 1){p=0}
 return(p)
}

p_Move_fctA  &lt;- function(t){return(0.1)}

p_Exit_fctA  &lt;- function(t,t_infectA){
 if(t/t_infectA &lt;= 1){p=0}
 if(t/t_infectA &gt; 1){p=1}
 return(p)
}

time_contact_A = function(t){sample(c(0,1,2),1,prob=c(0.2,0.4,0.4))}

t_incub_fct_B &lt;- function(x){rnorm(x,mean = 5,sd=1)}
p_max_fct_B &lt;- function(x){rbeta(x,shape1 = 5,shape2=2)}

p_Exit_fct_B  &lt;- function(t,current.in){
 if(current.in=="A"){return(0.1)}
 if(current.in=="B"){return(0.2)}
 if(current.in=="C"){return(1)}}

pTrans_hostB &lt;- function(t,p_max,t_incub){
 if(t &lt;= t_incub){p=0}
 if(t &gt;= t_incub){p=p_max}
 return(p)
}

time_contact_B = function(t){round(rnorm(1, 3, 1), 0)}

transition.matrix = matrix(c(0,0.2,0.4,0.5,0,0.6,0.5,0.8,0),
                          nrow = 3, ncol = 3,
                          dimnames=list(c("A","B","C"),c("A","B","C")))

set.seed(6262)
test.nosoi &lt;- nosoiSim(type="dual", popStructure="discrete",
                      length.sim=40,
                      max.infected.A=100,
                      max.infected.B=200,
                      init.individuals.A=1,
                      init.individuals.B=0,
                      init.structure.A="A",
                      init.structure.B=NA,
                      structure.matrix.A=transition.matrix,
                      structure.matrix.B=transition.matrix,
                      pExit.A = p_Exit_fctA,
                      param.pExit.A = list(t_infectA = t_infectA_fct),
                      pMove.A=p_Move_fctA,
                      param.pMove.A=NA,
                      timeDep.pMove.A=FALSE,
                      diff.pMove.A=FALSE,
                      timeDep.pExit.A=FALSE,
                      nContact.A = time_contact_A,
                      param.nContact.A = NA,
                      timeDep.nContact.A=FALSE,
                      pTrans.A = pTrans_hostA,
                      param.pTrans.A = list(t_infectA=t_infectA_fct),
                      timeDep.pTrans.A=FALSE,
                      prefix.host.A="H",
                      pExit.B = p_Exit_fct_B,
                      param.pExit.B = NA,
                      timeDep.pExit.B=FALSE,
                      diff.pExit.B=TRUE,
                      pMove.B=NA,
                      param.pMove.B=NA,
                      timeDep.pMove.B=FALSE,
                      diff.pMove.B=FALSE,
                      nContact.B = time_contact_B,
                      param.nContact.B = NA,
                      timeDep.nContact.B=FALSE,
                      pTrans.B = pTrans_hostB,
                      param.pTrans.B = list(p_max=p_max_fct_B,
                                            t_incub=t_incub_fct_B),
                      timeDep.pTrans.B=FALSE,
                      prefix.host.B="V")

test.nosoi

</code></pre>

<hr>
<h2 id='dualNone'>Dual-host pathogen in homogeneous hosts populations</h2><span id='topic+dualNone'></span>

<h3>Description</h3>

<p>This function, that can be wrapped within <code><a href="#topic+nosoiSim">nosoiSim</a></code>, runs a dual-host transmission chain simulation, without any structure features in both hosts populations. The simulation stops either at
the end of given time (specified by <code>length.sim</code>) or when the number of hosts infected threshold (<code>max.infected</code>) is crossed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dualNone(
  length.sim,
  max.infected.A,
  max.infected.B,
  init.individuals.A,
  init.individuals.B,
  pExit.A,
  param.pExit.A,
  timeDep.pExit.A = FALSE,
  nContact.A,
  param.nContact.A,
  timeDep.nContact.A = FALSE,
  pTrans.A,
  param.pTrans.A,
  timeDep.pTrans.A = FALSE,
  prefix.host.A = "H",
  pExit.B,
  param.pExit.B,
  timeDep.pExit.B = FALSE,
  nContact.B,
  param.nContact.B,
  timeDep.nContact.B = FALSE,
  pTrans.B,
  param.pTrans.B,
  timeDep.pTrans.B = FALSE,
  prefix.host.B = "V",
  print.progress = TRUE,
  print.step = 10
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dualNone_+3A_length.sim">length.sim</code></td>
<td>
<p>specifies the length (in unit of time) over which the simulation should be run.</p>
</td></tr>
<tr><td><code id="dualNone_+3A_max.infected.a">max.infected.A</code></td>
<td>
<p>specifies the maximum number of individual hosts A that can be infected in the simulation.</p>
</td></tr>
<tr><td><code id="dualNone_+3A_max.infected.b">max.infected.B</code></td>
<td>
<p>specifies the maximum number of individual hosts B that can be infected in the simulation.</p>
</td></tr>
<tr><td><code id="dualNone_+3A_init.individuals.a">init.individuals.A</code></td>
<td>
<p>number of initially infected individuals (hosts A).</p>
</td></tr>
<tr><td><code id="dualNone_+3A_init.individuals.b">init.individuals.B</code></td>
<td>
<p>number of initially infected individuals (hosts B).</p>
</td></tr>
<tr><td><code id="dualNone_+3A_pexit.a">pExit.A</code></td>
<td>
<p>function that gives the probability to exit the simulation for an infected host A (either moving out, dying, etc.).</p>
</td></tr>
<tr><td><code id="dualNone_+3A_param.pexit.a">param.pExit.A</code></td>
<td>
<p>parameter names (list of functions) for the pExit for host-type A.</p>
</td></tr>
<tr><td><code id="dualNone_+3A_timedep.pexit.a">timeDep.pExit.A</code></td>
<td>
<p>is pExit of host-type A dependent on the absolute time of the simulation (TRUE/FALSE)?</p>
</td></tr>
<tr><td><code id="dualNone_+3A_ncontact.a">nContact.A</code></td>
<td>
<p>function that gives the number of potential transmission events per unit of time for host-type A.</p>
</td></tr>
<tr><td><code id="dualNone_+3A_param.ncontact.a">param.nContact.A</code></td>
<td>
<p>parameter names (list of functions) for param.nContact for host-type A.</p>
</td></tr>
<tr><td><code id="dualNone_+3A_timedep.ncontact.a">timeDep.nContact.A</code></td>
<td>
<p>is nContact of host-type A dependent on the absolute time of the simulation (TRUE/FALSE)?</p>
</td></tr>
<tr><td><code id="dualNone_+3A_ptrans.a">pTrans.A</code></td>
<td>
<p>function that gives the probability of transmit a pathogen as a function of time since infection for host A.</p>
</td></tr>
<tr><td><code id="dualNone_+3A_param.ptrans.a">param.pTrans.A</code></td>
<td>
<p>parameter names (list of functions) for the pExit  for host A.</p>
</td></tr>
<tr><td><code id="dualNone_+3A_timedep.ptrans.a">timeDep.pTrans.A</code></td>
<td>
<p>is pTrans of host-type A dependent on the absolute time of the simulation (TRUE/FALSE)?</p>
</td></tr>
<tr><td><code id="dualNone_+3A_prefix.host.a">prefix.host.A</code></td>
<td>
<p>character(s) to be used as a prefix for the host A identification number.</p>
</td></tr>
<tr><td><code id="dualNone_+3A_pexit.b">pExit.B</code></td>
<td>
<p>function that gives the probability to exit the simulation for an infected host B (either moving out, dying, etc.).</p>
</td></tr>
<tr><td><code id="dualNone_+3A_param.pexit.b">param.pExit.B</code></td>
<td>
<p>parameter names (list of functions) for the pExit for host-type B.</p>
</td></tr>
<tr><td><code id="dualNone_+3A_timedep.pexit.b">timeDep.pExit.B</code></td>
<td>
<p>is pExit of host-type B dependent on the absolute time of the simulation (TRUE/FALSE)?</p>
</td></tr>
<tr><td><code id="dualNone_+3A_ncontact.b">nContact.B</code></td>
<td>
<p>function that gives the number of potential transmission events per unit of time for host B.</p>
</td></tr>
<tr><td><code id="dualNone_+3A_param.ncontact.b">param.nContact.B</code></td>
<td>
<p>parameter names (list of functions) for param.nContact for host-type B.</p>
</td></tr>
<tr><td><code id="dualNone_+3A_timedep.ncontact.b">timeDep.nContact.B</code></td>
<td>
<p>is nContact of host-type B dependent on the absolute time of the simulation (TRUE/FALSE)?</p>
</td></tr>
<tr><td><code id="dualNone_+3A_ptrans.b">pTrans.B</code></td>
<td>
<p>function that gives the probability of transmit a pathogen as a function of time since infection for host B.</p>
</td></tr>
<tr><td><code id="dualNone_+3A_param.ptrans.b">param.pTrans.B</code></td>
<td>
<p>parameter names (list of functions) for the pExit for host-type B.</p>
</td></tr>
<tr><td><code id="dualNone_+3A_timedep.ptrans.b">timeDep.pTrans.B</code></td>
<td>
<p>is pTrans of host-type B dependent on the absolute time of the simulation (TRUE/FALSE)?</p>
</td></tr>
<tr><td><code id="dualNone_+3A_prefix.host.b">prefix.host.B</code></td>
<td>
<p>character(s) to be used as a prefix for the host B identification number.</p>
</td></tr>
<tr><td><code id="dualNone_+3A_print.progress">print.progress</code></td>
<td>
<p>if TRUE, displays a progress bar (current time/length.sim).</p>
</td></tr>
<tr><td><code id="dualNone_+3A_print.step">print.step</code></td>
<td>
<p>print.progress is TRUE, step with which the progress message will be printed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>pExit</code> and <code>pTrans</code> functions should return a single probability (a number between 0 and 1), and <code>nContact</code> a positive natural number (positive integer) or 0.
</p>
<p>The <code>param</code> arguments should be a list of functions or NA. Each item name in the parameter list should have the same name as the argument in the corresponding function.
</p>
<p>The use of <code>timeDep</code> (switch to <code>TRUE</code>) makes the corresponding function use the argument <code>prestime</code> (for &quot;present time&quot;).
</p>


<h3>Value</h3>

<p>An object of class <code><a href="#topic+nosoiSim">nosoiSim</a></code>, containing all results of the simulation.
</p>


<h3>Suffixes</h3>

<p>The suffix <code>.A</code> or <code>.B</code> specifies if the considered function or parameter concerns host type A or B.
</p>


<h3>Order of Arguments</h3>

<p>The user specified function's arguments should follow this order: <code>t</code> (mandatory), <code>prestime</code> (optional, only if timeDep is TRUE), <code>parameters</code> specified in the list.
</p>


<h3>See Also</h3>

<p>For simulations with a discrete structured host population, see <code><a href="#topic+dualDiscrete">dualDiscrete</a></code>. For simulations with a structured population in continuous space, <code><a href="#topic+dualContinuous">dualContinuous</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 #Host A
t_infectA_fct &lt;- function(x){rnorm(x,mean = 12,sd=3)}
pTrans_hostA &lt;- function(t,t_infectA){
  if(t/t_infectA &lt;= 1){p=sin(pi*t/t_infectA)}
  if(t/t_infectA &gt; 1){p=0}
  return(p)
}

p_Exit_fctA  &lt;- function(t,t_infectA){
  if(t/t_infectA &lt;= 1){p=0}
  if(t/t_infectA &gt; 1){p=1}
  return(p)
}

time_contact_A = function(t){sample(c(0,1,2),1,prob=c(0.2,0.4,0.4))}

#Host B
t_incub_fct_B &lt;- function(x){rnorm(x,mean = 5,sd=1)}
p_max_fct_B &lt;- function(x){rbeta(x,shape1 = 5,shape2=2)}

p_Exit_fct_B  &lt;- function(t,prestime){(sin(prestime/12)+1)/5}

pTrans_hostB &lt;- function(t,p_max,t_incub){
  if(t &lt;= t_incub){p=0}
  if(t &gt;= t_incub){p=p_max}
  return(p)
}

time_contact_B = function(t){round(rnorm(1, 3, 1), 0)}

set.seed(90)
test.nosoi &lt;- nosoiSim(type="dual", popStructure="none",
                       length.sim=40,
                       max.infected.A=100,
                       max.infected.B=200,
                       init.individuals.A=1,
                       init.individuals.B=0,
                       pExit.A = p_Exit_fctA,
                       param.pExit.A = list(t_infectA = t_infectA_fct),
                       timeDep.pExit.A=FALSE,
                       nContact.A = time_contact_A,
                       param.nContact.A = NA,
                       timeDep.nContact.A=FALSE,
                       pTrans.A = pTrans_hostA,
                       param.pTrans.A = list(t_infectA=t_infectA_fct),
                                             timeDep.pTrans.A=FALSE,
                       prefix.host.A="H",
                       pExit.B = p_Exit_fct_B,
                       param.pExit.B = NA,
                       timeDep.pExit.B=TRUE,
                       nContact.B = time_contact_B,
                       param.nContact.B = NA,
                       timeDep.nContact.B=FALSE,
                       pTrans.B = pTrans_hostB,
                       param.pTrans.B = list(p_max=p_max_fct_B,
                                            t_incub=t_incub_fct_B),
                       timeDep.pTrans.B=FALSE,
                       prefix.host.B="V")

test.nosoi


</code></pre>

<hr>
<h2 id='endMessage'>End message</h2><span id='topic+endMessage'></span>

<h3>Description</h3>

<p>Message that ends the simulation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>endMessage(Host.count.A, Host.count.B = NULL, pres.time, type = "single")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="endMessage_+3A_host.count.a">Host.count.A</code></td>
<td>
<p>number of infected hosts (host A)</p>
</td></tr>
<tr><td><code id="endMessage_+3A_host.count.b">Host.count.B</code></td>
<td>
<p>number of infected hosts (host B)</p>
</td></tr>
<tr><td><code id="endMessage_+3A_pres.time">pres.time</code></td>
<td>
<p>current time of the simulation</p>
</td></tr>
<tr><td><code id="endMessage_+3A_type">type</code></td>
<td>
<p>either single/dual host</p>
</td></tr>
</table>

<hr>
<h2 id='FunctionSanityChecks'>Checks if a function is properly formatted</h2><span id='topic+FunctionSanityChecks'></span>

<h3>Description</h3>

<p>Checks if the function is properly formatted given the user's input and nosoi's requirements.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FunctionSanityChecks(
  pFunc,
  name,
  param.pFunc,
  timeDep,
  diff,
  hostCount,
  continuous,
  stateNames
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FunctionSanityChecks_+3A_pfunc">pFunc</code></td>
<td>
<p>a function</p>
</td></tr>
<tr><td><code id="FunctionSanityChecks_+3A_name">name</code></td>
<td>
<p>the name of the function</p>
</td></tr>
<tr><td><code id="FunctionSanityChecks_+3A_param.pfunc">param.pFunc</code></td>
<td>
<p>a named list of arguments</p>
</td></tr>
<tr><td><code id="FunctionSanityChecks_+3A_timedep">timeDep</code></td>
<td>
<p>is the function differential according to absolute time? (TRUE/FALSE)</p>
</td></tr>
<tr><td><code id="FunctionSanityChecks_+3A_diff">diff</code></td>
<td>
<p>is the function differential according to state/env.variable? (TRUE/FALSE)</p>
</td></tr>
<tr><td><code id="FunctionSanityChecks_+3A_hostcount">hostCount</code></td>
<td>
<p>is the function differential according to host count? (TRUE/FALSE)</p>
</td></tr>
<tr><td><code id="FunctionSanityChecks_+3A_continuous">continuous</code></td>
<td>
<p>is the function to be used in a continuous space? (TRUE/FALSE)</p>
</td></tr>
<tr><td><code id="FunctionSanityChecks_+3A_statenames">stateNames</code></td>
<td>
<p>name of the states (vector) in case of discrete structure.</p>
</td></tr>
</table>

<hr>
<h2 id='get_node'>Get Node</h2><span id='topic+get_node'></span>

<h3>Description</h3>

<p>Find the node descending from the branch where the host lies at a given
time on the transmission tree.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_node(tdata, host, time)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_node_+3A_tdata">tdata</code></td>
<td>
<p>a tibble extracted from a <code>treedata</code> object.</p>
</td></tr>
<tr><td><code id="get_node_+3A_host">host</code></td>
<td>
<p>host id</p>
</td></tr>
<tr><td><code id="get_node_+3A_time">time</code></td>
<td>
<p>time at which to sample the host</p>
</td></tr>
</table>


<h3>Value</h3>

<p>number of the node in the transmission tree descending from the
host at given time.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_position">get_position</a></code>
</p>

<hr>
<h2 id='get_other_count'>Get host count from table</h2><span id='topic+get_other_count'></span>

<h3>Description</h3>

<p>Returns the host count for a table and a state
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_other_count(table_hosts, name_cur, active_hosts, name_count, cur)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_other_count_+3A_table_hosts">table_hosts</code></td>
<td>
<p>a table.hosts</p>
</td></tr>
<tr><td><code id="get_other_count_+3A_name_cur">name_cur</code></td>
<td>
<p>name of the cell, one of &quot;current.in&quot; or &quot;current.cell.raster&quot;</p>
</td></tr>
<tr><td><code id="get_other_count_+3A_active_hosts">active_hosts</code></td>
<td>
<p>a boolean vector of active hosts</p>
</td></tr>
<tr><td><code id="get_other_count_+3A_name_count">name_count</code></td>
<td>
<p>name of the count, one of &quot;host.count.A&quot; or &quot;host.count.B&quot;</p>
</td></tr>
<tr><td><code id="get_other_count_+3A_cur">cur</code></td>
<td>
<p>a data.table with the state</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data.table containing state.ID (col1) and count (col2)
</p>

<hr>
<h2 id='get_position'>Get Position on branch</h2><span id='topic+get_position'></span>

<h3>Description</h3>

<p>Find the position on the branch above the node of the times sample.
Warning: The node needs to be extracted with <code><a href="#topic+get_node">get_node</a></code>.
Result of this function is to be used in <code><a href="ape.html#topic+bind.tree">bind.tree</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_position(tdata, node, time)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_position_+3A_tdata">tdata</code></td>
<td>
<p>a tibble extracted from a <code>treedata</code> object.</p>
</td></tr>
<tr><td><code id="get_position_+3A_node">node</code></td>
<td>
<p>node below the sampling event</p>
</td></tr>
<tr><td><code id="get_position_+3A_time">time</code></td>
<td>
<p>time of the sampling event</p>
</td></tr>
</table>


<h3>Value</h3>

<p>time between the node and the sampling event.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_node">get_node</a></code>
</p>

<hr>
<h2 id='get_state'>Get State at sampling time</h2><span id='topic+get_state'></span>

<h3>Description</h3>

<p>Find the state of the host at the sampling time
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_state(table.state, host, time, total.time)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_state_+3A_table.state">table.state</code></td>
<td>
<p>data.table of hosts movement, extracted from a <code>nosoi</code> object</p>
</td></tr>
<tr><td><code id="get_state_+3A_host">host</code></td>
<td>
<p>ID of the host</p>
</td></tr>
<tr><td><code id="get_state_+3A_time">time</code></td>
<td>
<p>time of the sampling event</p>
</td></tr>
<tr><td><code id="get_state_+3A_total.time">total.time</code></td>
<td>
<p>total time of the epidemics, extracted from the <code>nosoi</code> object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>state of the host
</p>

<hr>
<h2 id='getCumulative'>Gets the cumulative number of infected hosts for the full length of the simulation</h2><span id='topic+getCumulative'></span>

<h3>Description</h3>

<p>This function computes from the output of a <code>nosoiSim</code> simulation the cumulative count of infected hosts at each time step of the simulation. The output is a <code><a href="data.table.html#topic+data.table">data.table</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getCumulative(nosoi.output)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getCumulative_+3A_nosoi.output">nosoi.output</code></td>
<td>
<p>Output of a nosoi simulation (object of class <code><a href="#topic+nosoiSim">nosoiSim</a></code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The output is a <code><a href="data.table.html#topic+data.table">data.table</a></code> with the following structure:
</p>

<dl>
<dt>t</dt><dd><p>Time-step (integer).</p>
</dd>
<dt>Count</dt><dd><p>Cumulative number of infected hosts at given time-step.</p>
</dd>
<dt>type</dt><dd><p>Host-type, identified by its user-defined prefix.</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+summary.nosoiSim">summary.nosoiSim</a></code>
</p>

<hr>
<h2 id='getDynamic'>Gets the current number of infected hosts for the full length of the simulation</h2><span id='topic+getDynamic'></span>

<h3>Description</h3>

<p>This function computes from the output of a <code>nosoiSim</code> simulation the dynamic count of infected hosts at each time step (and each state if discrete structure) of the simulation. The output is a <code><a href="data.table.html#topic+data.table">data.table</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getDynamic(nosoi.output)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getDynamic_+3A_nosoi.output">nosoi.output</code></td>
<td>
<p>Output of a nosoi simulation (object of class <code><a href="#topic+nosoiSim">nosoiSim</a></code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The output is a <code><a href="data.table.html#topic+data.table">data.table</a></code> with the following structure:
</p>

<dl>
<dt>state</dt><dd><p>(only when discrete structure) Given state</p>
</dd>
<dt>Count</dt><dd><p>Current number of infected hosts at given time-step.</p>
</dd>
<dt>type</dt><dd><p>Host-type, identified by its user-defined prefix.</p>
</dd>
<dt>t</dt><dd><p>Time-step (integer).</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+summary.nosoiSim">summary.nosoiSim</a></code>
</p>

<hr>
<h2 id='getExitingMoving'>Get Exiting or Moving individuals</h2><span id='topic+getExitingMoving'></span>

<h3>Description</h3>

<p>Return a vector of exiting individuals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getExitingMoving(res, pres.time, pasedFunction)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getExitingMoving_+3A_res">res</code></td>
<td>
<p>an object of class <code>nosoiSimOne</code>.</p>
</td></tr>
<tr><td><code id="getExitingMoving_+3A_pres.time">pres.time</code></td>
<td>
<p>current time</p>
</td></tr>
<tr><td><code id="getExitingMoving_+3A_pasedfunction">pasedFunction</code></td>
<td>
<p>parsed exit/moving function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Boolean vector
</p>

<hr>
<h2 id='getHostData'>Extracts specific data from a <code>nosoiSim</code> object</h2><span id='topic+getHostData'></span>

<h3>Description</h3>

<p>This function extracts data user-defined data (i.e. <code>table.hosts</code>, <code>N.infected</code>, <code>table.state</code> or <code>popStructure</code>) from a <code><a href="#topic+nosoiSim">nosoiSim</a></code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getHostData(
  nosoi.output,
  what = c("table.hosts", "N.infected", "table.state", "popStructure"),
  pop = "A"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getHostData_+3A_nosoi.output">nosoi.output</code></td>
<td>
<p>an object of class <code>nosoiSim</code></p>
</td></tr>
<tr><td><code id="getHostData_+3A_what">what</code></td>
<td>
<p>the data to get, among <code>table.hosts</code>, <code>N.infected</code>, <code>table.state</code> or <code>popStructure</code>.</p>
</td></tr>
<tr><td><code id="getHostData_+3A_pop">pop</code></td>
<td>
<p>the population to be extracted (one of &quot;A&quot; or &quot;B&quot;)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a <code><a href="data.table.html#topic+data.table">data.table</a></code> with the requested data.
</p>


<h3>See Also</h3>

<p>To directly extract <code>table.hosts</code> or <code>table.state</code>, you can also use <code><a href="#topic+getTableHosts">getTableHosts</a></code> and <code><a href="#topic+getTableState">getTableState</a></code> respectively.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
t_incub_fct &lt;- function(x){rnorm(x,mean = 5,sd=1)}
p_max_fct &lt;- function(x){rbeta(x,shape1 = 5,shape2=2)}
p_Exit_fct  &lt;- function(t){return(0.08)}

proba &lt;- function(t,p_max,t_incub){
  if(t &lt;= t_incub){p=0}
  if(t &gt;= t_incub){p=p_max}
  return(p)
}

time_contact &lt;- function(t){round(rnorm(1, 3, 1), 0)}

test.nosoi &lt;- nosoiSim(type="single", popStructure="none",
                       length=40,
                       max.infected=100,
                       init.individuals=1,
                       nContact=time_contact,
                       param.nContact=NA,
                       pTrans = proba,
                       param.pTrans = list(p_max=p_max_fct,
                                           t_incub=t_incub_fct),
                       pExit=p_Exit_fct,
                       param.pExit=NA)


data.extracted &lt;- getHostData(test.nosoi, "table.hosts", "A")

</code></pre>

<hr>
<h2 id='getPositionInfected'>get Position Infected</h2><span id='topic+getPositionInfected'></span>

<h3>Description</h3>

<p>Return the relevant position of the infected individual.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getPositionInfected(nosoiSim, df.meetTransmit, i)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getPositionInfected_+3A_nosoisim">nosoiSim</code></td>
<td>
<p>an object of class <code>nosoiSim</code>.</p>
</td></tr>
<tr><td><code id="getPositionInfected_+3A_df.meettransmit">df.meetTransmit</code></td>
<td>
<p>current data.table for transmission</p>
</td></tr>
<tr><td><code id="getPositionInfected_+3A_i">i</code></td>
<td>
<p>individual</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of positions
</p>

<hr>
<h2 id='getR0'>Gets R0 from a <code>nosoi</code> simulation</h2><span id='topic+getR0'></span>

<h3>Description</h3>

<p>Gets an estimate of secondary cases (what R0 usually tries to estimate) and its distribution from the output of a <code>nosoiSim</code> simulation. The actual calculation is based on inactive hosts at the end of the simulation to avoid bias introduced by hosts that have not finished their transmission potential.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getR0(nosoi.output)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getR0_+3A_nosoi.output">nosoi.output</code></td>
<td>
<p>Output of a nosoi simulation (object of class <code><a href="#topic+nosoiSim">nosoiSim</a></code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Current getR0 (after and including version 1.1.0) is a corrected version. In previous versions (prior to 1.1.0), the output included in its computation hosts that should not have been counted (still active).
</p>


<h3>Value</h3>

<p>A list with the following items:
</p>

<dl>
<dt>N.inactive</dt><dd><p>Number of inactive hosts at the end of the simulation.</p>
</dd>
<dt>R0.mean</dt><dd><p>Mean R0 based on the distribution (see below).</p>
</dd>
<dt>R0.dist</dt><dd><p>Distribution for each host of the secondary cases it generated (in case of dual-hosts, then the secondary cases of the same host-type).</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+summary.nosoiSim">summary.nosoiSim</a></code>
</p>

<hr>
<h2 id='getTableHosts'>Extracts <code>table.hosts</code> from a <code>nosoiSim</code> object</h2><span id='topic+getTableHosts'></span>

<h3>Description</h3>

<p>This function extracts the <code>table.hosts</code> for the request host-type from a <code><a href="#topic+nosoiSim">nosoiSim</a></code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getTableHosts(nosoi.output, pop = "A")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getTableHosts_+3A_nosoi.output">nosoi.output</code></td>
<td>
<p>an object of class <code><a href="#topic+nosoiSim">nosoiSim</a></code></p>
</td></tr>
<tr><td><code id="getTableHosts_+3A_pop">pop</code></td>
<td>
<p>the host-type to be extracted (either &quot;A&quot; or &quot;B&quot;, if not dual-host, then &quot;A&quot;)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a <code><a href="data.table.html#topic+data.table">data.table</a></code> with the requested data. The <code>table.hosts</code> (class <code><a href="data.table.html#topic+data.table">data.table</a></code>) contains informations about each host that has been simulated (one row is one host).
The structure of the table is the following:
</p>

<dl>
<dt>hosts.ID</dt><dd><p>Unique identifier for the host, based on user-defined prefix and an integer.</p>
</dd>
<dt>inf.by</dt><dd><p>Unique identifier for the host that infected the current one.</p>
</dd>
<dt>inf.in</dt><dd><p>(only if structure is present) State or coordinates (in that case inf.in.x and inf.in.y) in which the host was infected.</p>
</dd>
<dt>current.in</dt><dd><p>(only if structure is present) State or coordinates (in that case current.in.x and current.in.y) in which the host is at the end of the simulation.</p>
</dd>
<dt>current.env.value</dt><dd><p>(only if continuous structure is present) Environmental value (raster cell value) in which the host is at the end of the simulation.</p>
</dd>
<dt>current.cell.raster</dt><dd><p>(only if continuous structure is present) Raster cell numeric ID in which the host is at the end of the simulation.</p>
</dd>
<dt>host.count</dt><dd><p>(only if structure is present) Host count in the current state or raster cell (beware, updated only if used).</p>
</dd>
<dt>inf.time</dt><dd><p>When did the host enter the simulation (infection time).</p>
</dd>
<dt>out.time</dt><dd><p>When did the host exit the simulation (NA if still active).</p>
</dd>
<dt>active</dt><dd><p>Is the host still active at the end of the simulation (TRUE for YES, FALSE for NO)?</p>
</dd>
<dt>parameters</dt><dd><p>The remaining columns are the sampled values for the individual-based parameters (if any) specified by the user.</p>
</dd>
</dl>


<hr>
<h2 id='getTableState'>Extracts <code>table.state</code> from a <code>nosoiSim</code> object</h2><span id='topic+getTableState'></span>

<h3>Description</h3>

<p>This function extracts the <code>table.state</code> for the request host-type from a <code><a href="#topic+nosoiSim">nosoiSim</a></code> object. <code>table.state</code> is present only if there is any structure (discrete or continuous) used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getTableState(nosoi.output, pop = "A")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getTableState_+3A_nosoi.output">nosoi.output</code></td>
<td>
<p>an object of class <code><a href="#topic+nosoiSim">nosoiSim</a></code></p>
</td></tr>
<tr><td><code id="getTableState_+3A_pop">pop</code></td>
<td>
<p>the host-type to be extracted (either &quot;A&quot; or &quot;B&quot;, if not dual-host, then &quot;A&quot;)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a <code><a href="data.table.html#topic+data.table">data.table</a></code> with the requested data. The <code>table.state</code> (class <code><a href="data.table.html#topic+data.table">data.table</a></code>) contains informations the location of each host during time (one row is one host at one location).
The structure of the table is the following:
</p>

<dl>
<dt>hosts.ID</dt><dd><p>Unique identifier for the host, based on user-defined prefix and an integer.</p>
</dd>
<dt>state</dt><dd><p>State or coordinates (in that case state.x and state.y) in which the host is during that time interval.</p>
</dd>
<dt>current.env.value</dt><dd><p>(only if continuous structure is present) Environmental value (raster cell value) in which the host is at the end of the simulation.</p>
</dd>
<dt>current.cell.raster</dt><dd><p>(only if continuous structure is present) Raster cell numeric ID in which the host is at the end of the simulation.</p>
</dd>
<dt>time.from</dt><dd><p>Time-step at which the host moved to the location.</p>
</dd>
<dt>time.to</dt><dd><p>Time-step at which the host exited the location (either by exiting the simulation or moving somewhere else).</p>
</dd>
</dl>


<hr>
<h2 id='getTransmissionTree'>Gets the full transmission tree (phylogenetic tree-like) from a <code>nosoi</code> simulation</h2><span id='topic+getTransmissionTree'></span>

<h3>Description</h3>

<p>From a <code>nosoi</code> simulated epidemics, this function extracts the full transmission tree in a form mimicking a phylogenetic tree.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getTransmissionTree(nosoiInf)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getTransmissionTree_+3A_nosoiinf">nosoiInf</code></td>
<td>
<p>an object of class <code><a href="#topic+nosoiSim">nosoiSim</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function uses packages <span class="pkg">tidytree</span> and <span class="pkg">treeio</span>,
that rely on <code><a href="ape.html#topic+ape-package">ape</a></code>.
</p>


<h3>Value</h3>

<p>A tree of class <code><a href="tidytree.html#topic+treedata-class">treedata</a></code>, containing a
phylogenetic tree based on the transmission chain and the mapped data at all the nodes.
</p>


<h3>See Also</h3>

<p>For exporting the annotated tree to other software packages, see functions
in <span class="pkg">treeio</span> (e.g. <code><a href="treeio.html#topic+write.beast">write.beast</a></code>).
</p>
<p>To sub-sample this tree, see functions <code><a href="#topic+sampleTransmissionTree">sampleTransmissionTree</a></code> and <code><a href="#topic+sampleTransmissionTreeFromExiting">sampleTransmissionTreeFromExiting</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
t_incub_fct &lt;- function(x){rnorm(x,mean = 5,sd=1)}
p_max_fct &lt;- function(x){rbeta(x,shape1 = 5,shape2=2)}
p_Exit_fct  &lt;- function(t){return(0.08)}
p_Move_fct  &lt;- function(t){return(0.1)}

proba &lt;- function(t,p_max,t_incub){
  if(t &lt;= t_incub){p=0}
  if(t &gt;= t_incub){p=p_max}
  return(p)
}

time_contact = function(t){round(rnorm(1, 3, 1), 0)}

transition.matrix = matrix(c(0, 0.2, 0.4, 0.5, 0, 0.6, 0.5, 0.8, 0),
                           nrow = 3, ncol = 3,
                           dimnames = list(c("A", "B", "C"), c("A", "B", "C")))

set.seed(805)
test.nosoi &lt;- nosoiSim(type="single", popStructure="discrete",
                        length=20,
                        max.infected=100,
                        init.individuals=1,
                        init.structure="A",
                        structure.matrix=transition.matrix,
                        pMove=p_Move_fct,
                        param.pMove=NA,
                        nContact=time_contact,
                        param.nContact=NA,
                        pTrans = proba,
                        param.pTrans = list(p_max=p_max_fct,
                                            t_incub=t_incub_fct),
                        pExit=p_Exit_fct,
                        param.pExit=NA
)

## Make sure all needed packages are here
if (requireNamespace("ape", quietly = TRUE) &amp;&amp;
    requireNamespace("tidytree", quietly = TRUE) &amp;&amp;
    requireNamespace("treeio", quietly = TRUE)) {
  library(ape)
  library(tidytree)
  library(treeio)

  #' ## Full transmission tree
  ttreedata &lt;- getTransmissionTree(test.nosoi)
  plot(ttreedata@phylo)

  ## Sampling "non dead" individuals
  hID &lt;- c("H-1", "H-7", "H-15", "H-100")
  samples &lt;- data.table(hosts = hID,
                        times = c(5.2, 9.3, 10.2, 16),
                        labels = paste0(hID, "-s"))

  sampledTree &lt;- sampleTransmissionTree(test.nosoi, ttreedata, samples)
  plot(sampledTree@phylo)

  ## Sampling "dead" individuals
  sampledDeadTree &lt;- sampleTransmissionTreeFromExiting(ttreedata, hID)
  plot(sampledDeadTree@phylo)
  }


</code></pre>

<hr>
<h2 id='iniTable'>Generates initial table to start the simulation (internal function)</h2><span id='topic+iniTable'></span>

<h3>Description</h3>

<p>This function creates the initial table for the host.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>iniTable(
  init.individuals,
  init.structure,
  prefix.host,
  ParamHost,
  current.environmental.value = NULL,
  current.cell.number.raster = NULL,
  current.count.A = integer(0),
  current.count.B = integer(0)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="iniTable_+3A_init.individuals">init.individuals</code></td>
<td>
<p>number of initially infected individuals (i.e. number of lines at time 0).</p>
</td></tr>
<tr><td><code id="iniTable_+3A_init.structure">init.structure</code></td>
<td>
<p>State (or coordinates) of the initially infected individuals.</p>
</td></tr>
<tr><td><code id="iniTable_+3A_prefix.host">prefix.host</code></td>
<td>
<p>character(s) to be used as a prefix for the hosts identification number.</p>
</td></tr>
<tr><td><code id="iniTable_+3A_paramhost">ParamHost</code></td>
<td>
<p>list of individual based parameters.</p>
</td></tr>
<tr><td><code id="iniTable_+3A_current.environmental.value">current.environmental.value</code></td>
<td>
<p>current value of the environmental  variable provided by the raster according to its position in init.structure.</p>
</td></tr>
<tr><td><code id="iniTable_+3A_current.cell.number.raster">current.cell.number.raster</code></td>
<td>
<p>unique number of the raster cell where the host is</p>
</td></tr>
<tr><td><code id="iniTable_+3A_current.count.a">current.count.A</code></td>
<td>
<p>current count of host A</p>
</td></tr>
<tr><td><code id="iniTable_+3A_current.count.b">current.count.B</code></td>
<td>
<p>current count of host B</p>
</td></tr>
</table>

<hr>
<h2 id='iniTableState'>Generates initial movement table to start the simulation (internal function)</h2><span id='topic+iniTableState'></span>

<h3>Description</h3>

<p>This function creates the initial table for the host, with 5+number of parameters of the transmission probability function parameters, and init.individuals row(s).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>iniTableState(
  init.individuals,
  init.structure,
  prefix.host,
  current.environmental.value = NULL,
  current.cell.number.raster = NA
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="iniTableState_+3A_init.individuals">init.individuals</code></td>
<td>
<p>number of initially infected individuals (i.e. number of lines at time 0).</p>
</td></tr>
<tr><td><code id="iniTableState_+3A_init.structure">init.structure</code></td>
<td>
<p>State of the initially infected individuals.</p>
</td></tr>
<tr><td><code id="iniTableState_+3A_prefix.host">prefix.host</code></td>
<td>
<p>character(s) to be used as a prefix for the hosts identification number.</p>
</td></tr>
<tr><td><code id="iniTableState_+3A_current.environmental.value">current.environmental.value</code></td>
<td>
<p>current value of the environmental  variable provided by the raster according to its position in init.structure.</p>
</td></tr>
<tr><td><code id="iniTableState_+3A_current.cell.number.raster">current.cell.number.raster</code></td>
<td>
<p>unique number of the raster cell where the host is</p>
</td></tr>
</table>

<hr>
<h2 id='keep.tip.treedata'>Keep tips</h2><span id='topic+keep.tip.treedata'></span>

<h3>Description</h3>

<p>Keep the tips in the list. See <code><a href="ape.html#topic+drop.tip">keep.tip</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>keep.tip.treedata(tree, tip)
</code></pre>

<hr>
<h2 id='keepState'>Should we build the table.host table</h2><span id='topic+keepState'></span>

<h3>Description</h3>

<p>Should we build the table.host table
</p>


<h3>Usage</h3>

<pre><code class='language-R'>keepState(nosoiSim)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="keepState_+3A_nosoisim">nosoiSim</code></td>
<td>
<p>an object of class <code>nosoiSim</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>boolean
</p>

<hr>
<h2 id='makeMoves'>Make Move function</h2><span id='topic+makeMoves'></span>

<h3>Description</h3>

<p>Makes the move.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>makeMoves(
  res,
  pres.time,
  moving.full,
  structure.matrix = NA,
  sdMoveParsed = NA,
  structure.raster = NA,
  attracted.by.raster = NA,
  max.raster = NA
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="makeMoves_+3A_res">res</code></td>
<td>
<p>an object of class <code>nosoiSimOne</code>.</p>
</td></tr>
<tr><td><code id="makeMoves_+3A_pres.time">pres.time</code></td>
<td>
<p>current time</p>
</td></tr>
<tr><td><code id="makeMoves_+3A_structure.matrix">structure.matrix</code></td>
<td>
<p>transition matrix (probabilities) to go from location A (row) to B (column)</p>
</td></tr>
<tr><td><code id="makeMoves_+3A_structure.raster">structure.raster</code></td>
<td>
<p>raster object defining the environmental variable.</p>
</td></tr>
<tr><td><code id="makeMoves_+3A_attracted.by.raster">attracted.by.raster</code></td>
<td>
<p>should the hosts be attracted by higher values in the environmental raster? (TRUE/FALSE).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The modified object res
</p>

<hr>
<h2 id='MatrixSanityChecks'>Checks if the matrix is properly formatted</h2><span id='topic+MatrixSanityChecks'></span>

<h3>Description</h3>

<p>Checks if the transition matrix is properly formatted given the user's input and nosoi's requirements.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MatrixSanityChecks(structure.matrix, init.structure, none.at.start = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MatrixSanityChecks_+3A_structure.matrix">structure.matrix</code></td>
<td>
<p>transition matrix (probabilities) to go from location A (row) to B (column)</p>
</td></tr>
<tr><td><code id="MatrixSanityChecks_+3A_init.structure">init.structure</code></td>
<td>
<p>which state (i.e. location) the initially infected individuals are located.</p>
</td></tr>
</table>

<hr>
<h2 id='meetTransmit'>Meet Transmit function</h2><span id='topic+meetTransmit'></span>

<h3>Description</h3>

<p>Perform the tasks related to meeting and transmission events.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>meetTransmit(res, pres.time, positions, nContactParsed, pTransParsed)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="meetTransmit_+3A_res">res</code></td>
<td>
<p>an object of class <code>nosoiSimOne</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A table with active transmission events
</p>

<hr>
<h2 id='merge_host_tables'>Merge Population Data</h2><span id='topic+merge_host_tables'></span><span id='topic+merge_state_tables'></span>

<h3>Description</h3>

<p>Utility function to get merged hosts data if dual.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>merge_host_tables(nosoiInf)

merge_state_tables(nosoiInf)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="merge_host_tables_+3A_nosoiinf">nosoiInf</code></td>
<td>
<p>an object of class <code><a href="#topic+nosoiSim">nosoiSim</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>the merged 'table.hosts' or 'table.state' of the two populations.
</p>

<hr>
<h2 id='moveFunction.continuous'>Make Continuous Move function</h2><span id='topic+moveFunction.continuous'></span>

<h3>Description</h3>

<p>Makes the continuous move.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>moveFunction.continuous(
  res,
  pres.time,
  moving.full,
  sdMoveParsed,
  structure.raster,
  attracted.by.raster,
  max.raster,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="moveFunction.continuous_+3A_res">res</code></td>
<td>
<p>an object of class <code>nosoiSimOne</code>.</p>
</td></tr>
<tr><td><code id="moveFunction.continuous_+3A_pres.time">pres.time</code></td>
<td>
<p>current time</p>
</td></tr>
<tr><td><code id="moveFunction.continuous_+3A_structure.raster">structure.raster</code></td>
<td>
<p>raster object defining the environmental variable.</p>
</td></tr>
<tr><td><code id="moveFunction.continuous_+3A_attracted.by.raster">attracted.by.raster</code></td>
<td>
<p>should the hosts be attracted by higher values in the environmental raster? (TRUE/FALSE).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The modified object res
</p>

<hr>
<h2 id='moveFunction.discrete'>Make Discrete Move function</h2><span id='topic+moveFunction.discrete'></span>

<h3>Description</h3>

<p>Makes the discrete move.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>moveFunction.discrete(res, pres.time, moving.full, structure.matrix, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="moveFunction.discrete_+3A_res">res</code></td>
<td>
<p>an object of class <code>nosoiSimOne</code>.</p>
</td></tr>
<tr><td><code id="moveFunction.discrete_+3A_pres.time">pres.time</code></td>
<td>
<p>current time</p>
</td></tr>
<tr><td><code id="moveFunction.discrete_+3A_structure.matrix">structure.matrix</code></td>
<td>
<p>transition matrix (probabilities) to go from location A (row) to B (column)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The modified object res
</p>

<hr>
<h2 id='moveRotateContinuous'>Rotates movement in 2D space</h2><span id='topic+moveRotateContinuous'></span>

<h3>Description</h3>

<p>Rotates movement in 2D space
</p>


<h3>Usage</h3>

<pre><code class='language-R'>moveRotateContinuous(pt1, dX, dY, angle)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="moveRotateContinuous_+3A_pt1">pt1</code></td>
<td>
<p>current position (x,y)</p>
</td></tr>
<tr><td><code id="moveRotateContinuous_+3A_dx">dX</code></td>
<td>
<p>movement in X dim</p>
</td></tr>
<tr><td><code id="moveRotateContinuous_+3A_dy">dY</code></td>
<td>
<p>movement in Y space</p>
</td></tr>
<tr><td><code id="moveRotateContinuous_+3A_angle">angle</code></td>
<td>
<p>angle</p>
</td></tr>
</table>

<hr>
<h2 id='newLine'>Creates a new line to be added to the table when new host is infected (internal function)</h2><span id='topic+newLine'></span>

<h3>Description</h3>

<p>This function creates a new line for the table.
The lines are to be bounded with <code><a href="data.table.html#topic+rbindlist">rbindlist</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>newLine(
  hosts.ID,
  infected.by,
  infected.in,
  time.is,
  ParamHost,
  current.environmental.value = NULL,
  current.cell.number.raster = NULL,
  current.count.A = integer(0),
  current.count.B = integer(0)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="newLine_+3A_hosts.id">hosts.ID</code></td>
<td>
<p>unique ID for the new host</p>
</td></tr>
<tr><td><code id="newLine_+3A_infected.by">infected.by</code></td>
<td>
<p>unique ID of host that transmits to the new one</p>
</td></tr>
<tr><td><code id="newLine_+3A_infected.in">infected.in</code></td>
<td>
<p>state in which the host was infected</p>
</td></tr>
<tr><td><code id="newLine_+3A_time.is">time.is</code></td>
<td>
<p>time in the simulation, when the infection takes place</p>
</td></tr>
<tr><td><code id="newLine_+3A_paramhost">ParamHost</code></td>
<td>
<p>list of individual based parameters.</p>
</td></tr>
<tr><td><code id="newLine_+3A_current.environmental.value">current.environmental.value</code></td>
<td>
<p>current environmental value</p>
</td></tr>
<tr><td><code id="newLine_+3A_current.cell.number.raster">current.cell.number.raster</code></td>
<td>
<p>unique number of the raster cell where the host is</p>
</td></tr>
<tr><td><code id="newLine_+3A_current.count.a">current.count.A</code></td>
<td>
<p>current count of host A</p>
</td></tr>
<tr><td><code id="newLine_+3A_current.count.b">current.count.B</code></td>
<td>
<p>current count of host B</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list with the new line to add.
</p>

<hr>
<h2 id='newLineState'>Creates a new line to be added to the movement table when hosts moves (internal function)</h2><span id='topic+newLineState'></span>

<h3>Description</h3>

<p>This function creates a new line for the table,
The lines are to be bounded with <code><a href="data.table.html#topic+rbindlist">rbindlist</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>newLineState(
  hosts.ID,
  state.pres,
  time.is,
  current.environmental.value = NA,
  current.cell.number.raster = NA
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="newLineState_+3A_hosts.id">hosts.ID</code></td>
<td>
<p>unique ID for the new host</p>
</td></tr>
<tr><td><code id="newLineState_+3A_state.pres">state.pres</code></td>
<td>
<p>state in which host currently is</p>
</td></tr>
<tr><td><code id="newLineState_+3A_time.is">time.is</code></td>
<td>
<p>time in the simulation, when the infection takes place</p>
</td></tr>
<tr><td><code id="newLineState_+3A_current.environmental.value">current.environmental.value</code></td>
<td>
<p>current value of environmental  variable (from raster) according to coordinates in current.in.</p>
</td></tr>
<tr><td><code id="newLineState_+3A_current.cell.number.raster">current.cell.number.raster</code></td>
<td>
<p>unique number of the raster cell where the host is</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list with the new line to add.
</p>

<hr>
<h2 id='nosoiSim'>Top-level function to use <code>nosoi</code>.</h2><span id='topic+nosoiSim'></span>

<h3>Description</h3>

<p>This function determines which general settings the user wants to use for his simulation. All other arguments are passed down to the chosen simulator itself, such as <code><a href="#topic+singleNone">singleNone</a></code>, <code><a href="#topic+singleDiscrete">singleDiscrete</a></code>, <code><a href="#topic+singleContinuous">singleContinuous</a></code>, <code><a href="#topic+dualNone">dualNone</a></code>, <code><a href="#topic+dualDiscrete">dualDiscrete</a></code> or <code><a href="#topic+dualContinuous">dualContinuous</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nosoiSim(type = "single", popStructure = "none", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nosoiSim_+3A_type">type</code></td>
<td>
<p>specifies which type of pathogen we are interested in, either &quot;single&quot; or &quot;dual&quot;-host (e.g. arboviruses).</p>
</td></tr>
<tr><td><code id="nosoiSim_+3A_popstructure">popStructure</code></td>
<td>
<p>specifies if the population in which the transmission is to occur is structured (&quot;none&quot;, &quot;discrete&quot; or &quot;continuous&quot;).</p>
</td></tr>
<tr><td><code id="nosoiSim_+3A_...">...</code></td>
<td>
<p>arguments to be passed on to the chosen simulator itself, such as <code><a href="#topic+singleNone">singleNone</a></code>, <code><a href="#topic+singleDiscrete">singleDiscrete</a></code>, <code><a href="#topic+singleContinuous">singleContinuous</a></code>, <code><a href="#topic+dualNone">dualNone</a></code>, <code><a href="#topic+dualDiscrete">dualDiscrete</a></code> or <code><a href="#topic+dualContinuous">dualContinuous</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>nosoiSim</code>, containing all results of the simulation. Class <code>nosoiSim</code> object have the following slots:
</p>

<dl>
<dt>total.time</dt><dd><p>Number of time steps the simulation ran (integer).</p>
</dd>
<dt>type</dt><dd><p>String giving the simulation type (&quot;single&quot; or &quot;dual&quot; host).</p>
</dd>
<dt>host.info.A: object of class <code>nosoiSimOne</code></dt><dd>

<dl>
<dt>N.infected</dt><dd><p>Number of infected hosts (integer).</p>
</dd>
<dt>table.hosts</dt><dd><p>Table containing the results of the simulation  (see <code><a href="#topic+getTableHosts">getTableHosts</a></code> for more details on the table).</p>
</dd>
<dt>table.state</dt><dd><p>Table containing the results of the simulation, focusing on the movement history of each host (see <code><a href="#topic+getTableState">getTableState</a></code> for more details on the table).</p>
</dd>
<dt>prefix.host</dt><dd><p>String containing the prefix used to name hosts (character string).</p>
</dd>
<dt>popStructure</dt><dd><p>String giving the population structure (one of &quot;none&quot;, &quot;discrete&quot; or &quot;continuous&quot;).</p>
</dd>
</dl>
</dd>
<dt>host.info.B: object of class <code>nosoiSimOne</code></dt><dd>
<p>Same structure as <code>host.info.A</code>, but for host B (if it exists).
</p>
</dd>
</dl>



<h3>See Also</h3>


<dl>
<dt>Individual simulation functions:</dt><dd>
<p><code><a href="#topic+singleNone">singleNone</a></code>, <code><a href="#topic+singleDiscrete">singleDiscrete</a></code>,
<code><a href="#topic+singleContinuous">singleContinuous</a></code>, <code><a href="#topic+dualNone">dualNone</a></code>,
<code><a href="#topic+dualDiscrete">dualDiscrete</a></code> and <code><a href="#topic+dualContinuous">dualContinuous</a></code>.
</p>
</dd>
<dt>Functions to extract the results:</dt><dd>
<p><code><a href="#topic+getTableHosts">getTableHosts</a></code>, <code><a href="#topic+getTableState">getTableState</a></code>
</p>
</dd>
<dt>Summary statistics functions:</dt><dd>
<p><code><a href="#topic+nosoiSummary">nosoiSummary</a></code>,
<code><a href="#topic+getCumulative">getCumulative</a></code>, <code><a href="#topic+getDynamic">getDynamic</a></code>, <code><a href="#topic+getR0">getR0</a></code>
</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>
t_incub_fct &lt;- function(x){rnorm(x,mean = 5,sd=1)}
p_max_fct &lt;- function(x){rbeta(x,shape1 = 5,shape2=2)}
p_Exit_fct  &lt;- function(t){return(0.08)}

proba &lt;- function(t,p_max,t_incub){
 if(t &lt;= t_incub){p=0}
 if(t &gt;= t_incub){p=p_max}
 return(p)
}

time_contact = function(t){round(rnorm(1, 3, 1), 0)}

test.nosoi &lt;- nosoiSim(type="single", popStructure="none",
                      length=40,
                      max.infected=100,
                      init.individuals=1,
                      nContact=time_contact,
                      param.nContact=NA,
                      pTrans = proba,
                      param.pTrans = list(p_max=p_max_fct,
                                          t_incub=t_incub_fct),
                      pExit=p_Exit_fct,
                      param.pExit=NA)
test.nosoi


</code></pre>

<hr>
<h2 id='nosoiSimConstructor'>nosoiSim Constructor</h2><span id='topic+nosoiSimConstructor'></span>

<h3>Description</h3>

<p>Creates a <code>nosoiSim</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nosoiSimConstructor(
  total.time,
  type = c("single", "dual"),
  pop.A,
  pop.B = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nosoiSimConstructor_+3A_total.time">total.time</code></td>
<td>
<p>total time of the simulation</p>
</td></tr>
<tr><td><code id="nosoiSimConstructor_+3A_type">type</code></td>
<td>
<p>population structure (one of &quot;single or &quot;dual)</p>
</td></tr>
<tr><td><code id="nosoiSimConstructor_+3A_pop.a">pop.A</code></td>
<td>
<p>an object of class <code>nosoiSimOne</code> for population A</p>
</td></tr>
<tr><td><code id="nosoiSimConstructor_+3A_pop.b">pop.B</code></td>
<td>
<p>an object of class <code>nosoiSimOne</code> for population B</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>nosoiSim</code>
</p>

<hr>
<h2 id='nosoiSimOneConstructor'>nosoiSimOne Constructor</h2><span id='topic+nosoiSimOneConstructor'></span>

<h3>Description</h3>

<p>Creates a <code>nosoiSimOne</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nosoiSimOneConstructor(
  N.infected,
  table.hosts,
  table.state,
  prefix.host,
  popStructure = c("none", "discrete", "continuous")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nosoiSimOneConstructor_+3A_n.infected">N.infected</code></td>
<td>
<p>number of infected hosts</p>
</td></tr>
<tr><td><code id="nosoiSimOneConstructor_+3A_table.hosts">table.hosts</code></td>
<td>
<p>data.table of hosts</p>
</td></tr>
<tr><td><code id="nosoiSimOneConstructor_+3A_table.state">table.state</code></td>
<td>
<p>data.table of hosts movement</p>
</td></tr>
<tr><td><code id="nosoiSimOneConstructor_+3A_popstructure">popStructure</code></td>
<td>
<p>geographical structure (one of &quot;none, &quot;discrete&quot; or &quot;continuous&quot;)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>nosoiSimOne</code>
</p>

<hr>
<h2 id='nosoiSummary'>Summarizes the epidemiological features of a <code>nosoi</code> simulation</h2><span id='topic+nosoiSummary'></span><span id='topic+summary.nosoiSim'></span>

<h3>Description</h3>

<p>This function provides summary information about the simulation (number of infected hosts, R0, etc.) as a list.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nosoiSummary(object)

## S3 method for class 'nosoiSim'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nosoiSummary_+3A_object">object</code></td>
<td>
<p>Output of a nosoi simulation (object of class <code><a href="#topic+nosoiSim">nosoiSim</a></code>).</p>
</td></tr>
<tr><td><code id="nosoiSummary_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>All computed data is provided in a list:
</p>

<dl>
<dt>R0</dt><dd><p>Provides a sublist with number of inactive hosts at the end of the simulation <code>N.inactive</code>, mean R0 <code>R0.mean</code>, and R0 distribution <code>R0.dist</code>. For more details, see <code><a href="#topic+getR0">getR0</a></code>.</p>
</dd>
<dt>dynamics</dt><dd><p><code><a href="data.table.html#topic+data.table">data.table</a></code> with the count of currently infected (i.e. active) hosts at each time step of the simulation (by state if the simulation was in a discrete structured host population). For more details, see <code><a href="#topic+getDynamic">getDynamic</a></code>.</p>
</dd>
<dt>cumulative</dt><dd><p><code><a href="data.table.html#topic+data.table">data.table</a></code> with the cumulative count of infected hosts at each time step of the simulation. For more details, see <code><a href="#topic+getCumulative">getCumulative</a></code>.</p>
</dd>
</dl>



<h3>See Also</h3>

<p>You can directly compute each elements of the list without using the summarise function. See <code><a href="#topic+getR0">getR0</a></code>, <code><a href="#topic+getDynamic">getDynamic</a></code> and <code><a href="#topic+getCumulative">getCumulative</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
t_incub_fct &lt;- function(x){rnorm(x,mean = 5,sd=1)}
p_max_fct &lt;- function(x){rbeta(x,shape1 = 5,shape2=2)}
p_Exit_fct  &lt;- function(t){return(0.08)}

proba &lt;- function(t,p_max,t_incub){
 if(t &lt;= t_incub){p=0}
 if(t &gt;= t_incub){p=p_max}
 return(p)
}

time_contact &lt;- function(t){round(rnorm(1, 3, 1), 0)}

test.nosoi &lt;- nosoiSim(type="single", popStructure="none",
                      length=40,
                      max.infected=100,
                      init.individuals=1,
                      nContact=time_contact,
                      param.nContact=NA,
                      pTrans = proba,
                      param.pTrans = list(p_max=p_max_fct,
                                          t_incub=t_incub_fct),
                      pExit=p_Exit_fct,
                      param.pExit=NA)


nosoiSummary(test.nosoi)


</code></pre>

<hr>
<h2 id='numberInfected'>Number of active infected hosts at time t</h2><span id='topic+numberInfected'></span>

<h3>Description</h3>

<p>For a given time t, this function returns the number of infected active units.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>numberInfected(table.hosts, t)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="numberInfected_+3A_table.hosts">table.hosts</code></td>
<td>
<p>host table, result of function <code><a href="#topic+nosoiSim">nosoiSim</a></code></p>
</td></tr>
<tr><td><code id="numberInfected_+3A_t">t</code></td>
<td>
<p>time (integer)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Number of infected units at time t
</p>


<h3>See Also</h3>

<p><code><a href="#topic+nosoiSim">nosoiSim</a></code>
</p>

<hr>
<h2 id='numberInfectedBGW'>Number of infected hosts at time t (BGW)</h2><span id='topic+numberInfectedBGW'></span>

<h3>Description</h3>

<p>For a given time t, this function returns the number of infected active units.
The difference with <code><a href="#topic+numberInfected">numberInfected</a></code> is that it counts an &quot;out&quot;
individual as still there, but with no children.
This is for comparison with the BGW process, should be internal only.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>numberInfectedBGW(table.nosoi, t)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="numberInfectedBGW_+3A_table.nosoi">table.nosoi</code></td>
<td>
<p>result of function <code><a href="#topic+nosoiSim">nosoiSim</a></code></p>
</td></tr>
<tr><td><code id="numberInfectedBGW_+3A_t">t</code></td>
<td>
<p>time (integer)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Number of infected units at time t
</p>


<h3>See Also</h3>

<p><code><a href="#topic+nosoiSim">nosoiSim</a></code>
</p>

<hr>
<h2 id='numberInfectedStates'>Number of active infected hosts at time t</h2><span id='topic+numberInfectedStates'></span>

<h3>Description</h3>

<p>For a given time t, this function returns the number of infected active units.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>numberInfectedStates(table.states, t)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="numberInfectedStates_+3A_table.states">table.states</code></td>
<td>
<p>state table, result of function <code><a href="#topic+nosoiSim">nosoiSim</a></code></p>
</td></tr>
<tr><td><code id="numberInfectedStates_+3A_t">t</code></td>
<td>
<p>time (integer)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Number of infected units at time t
</p>


<h3>See Also</h3>

<p><code><a href="#topic+nosoiSim">nosoiSim</a></code>
</p>

<hr>
<h2 id='paramConstructor'>Param concatenator</h2><span id='topic+paramConstructor'></span>

<h3>Description</h3>

<p>Creates a <code>ParamHost</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>paramConstructor(
  param.pExit,
  param.pMove,
  param.nContact,
  param.pTrans,
  param.sdMove
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="paramConstructor_+3A_param.pexit">param.pExit</code></td>
<td>
<p>parameter names (list of functions) for the pExit.</p>
</td></tr>
<tr><td><code id="paramConstructor_+3A_param.pmove">param.pMove</code></td>
<td>
<p>parameter names (list of functions) for the pMove.</p>
</td></tr>
<tr><td><code id="paramConstructor_+3A_param.ncontact">param.nContact</code></td>
<td>
<p>parameter names (list of functions) for param.nContact.</p>
</td></tr>
<tr><td><code id="paramConstructor_+3A_param.ptrans">param.pTrans</code></td>
<td>
<p>parameter names (list of functions) for the pExit.</p>
</td></tr>
<tr><td><code id="paramConstructor_+3A_param.sdmove">param.sdMove</code></td>
<td>
<p>parameter names (list of functions) for sdMove.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>ParamHost</code>
</p>

<hr>
<h2 id='parseFunction'>Parse function for later use</h2><span id='topic+parseFunction'></span>

<h3>Description</h3>

<p>Parse a user-provided function to get the vectorized version.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>parseFunction(
  pFunc,
  param.pFunc,
  name,
  diff = FALSE,
  timeDep = FALSE,
  hostCount = FALSE,
  continuous = FALSE,
  stateNames = NA
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="parseFunction_+3A_pfunc">pFunc</code></td>
<td>
<p>a function</p>
</td></tr>
<tr><td><code id="parseFunction_+3A_param.pfunc">param.pFunc</code></td>
<td>
<p>a named list of arguments</p>
</td></tr>
<tr><td><code id="parseFunction_+3A_name">name</code></td>
<td>
<p>the name of the function</p>
</td></tr>
<tr><td><code id="parseFunction_+3A_diff">diff</code></td>
<td>
<p>is the function differential according to state/env.variable? (TRUE/FALSE)</p>
</td></tr>
<tr><td><code id="parseFunction_+3A_timedep">timeDep</code></td>
<td>
<p>is the function differential according to absolute time? (TRUE/FALSE)</p>
</td></tr>
<tr><td><code id="parseFunction_+3A_hostcount">hostCount</code></td>
<td>
<p>is the function differential according to host count? (TRUE/FALSE)</p>
</td></tr>
<tr><td><code id="parseFunction_+3A_continuous">continuous</code></td>
<td>
<p>is the function to be used in a continuous space? (TRUE/FALSE)</p>
</td></tr>
<tr><td><code id="parseFunction_+3A_statenames">stateNames</code></td>
<td>
<p>name of the states (vector) in case of discrete structure.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of parsed quantities:
</p>

<ul>
<li><p> &quot;vect&quot; Vectorized version of the function.
</p>
</li>
<li><p> &quot;vectArgs&quot; Vector of arguments for the vectorized function.
</p>
</li></ul>


<hr>
<h2 id='progressMessage'>Progress bar</h2><span id='topic+progressMessage'></span>

<h3>Description</h3>

<p>Echos the state of the simulation at any given time step provided by the user.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>progressMessage(
  Host.count.A,
  Host.count.B = NULL,
  pres.time,
  print.step,
  length.sim,
  max.infected.A,
  max.infected.B = NULL,
  type = "single"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="progressMessage_+3A_host.count.a">Host.count.A</code></td>
<td>
<p>number of infected hosts of host A.</p>
</td></tr>
<tr><td><code id="progressMessage_+3A_host.count.b">Host.count.B</code></td>
<td>
<p>number of infected hosts of host B.</p>
</td></tr>
<tr><td><code id="progressMessage_+3A_pres.time">pres.time</code></td>
<td>
<p>current time of the simulation</p>
</td></tr>
<tr><td><code id="progressMessage_+3A_print.step">print.step</code></td>
<td>
<p>if print.progress is TRUE, step with which the progress message will be printed.</p>
</td></tr>
<tr><td><code id="progressMessage_+3A_length.sim">length.sim</code></td>
<td>
<p>the length (in unit of time) over which the simulation should be run.</p>
</td></tr>
<tr><td><code id="progressMessage_+3A_max.infected.a">max.infected.A</code></td>
<td>
<p>the maximum number of hosts that can be infected in the simulation for host A.</p>
</td></tr>
<tr><td><code id="progressMessage_+3A_max.infected.b">max.infected.B</code></td>
<td>
<p>the maximum number of hosts that can be infected in the simulation for host B.</p>
</td></tr>
<tr><td><code id="progressMessage_+3A_type">type</code></td>
<td>
<p>either single/dual host</p>
</td></tr>
</table>

<hr>
<h2 id='RasterSanityChecks'>Checks if the raster is properly formatted</h2><span id='topic+RasterSanityChecks'></span>

<h3>Description</h3>

<p>Checks if the environmental raster is properly formatted given the user's input and nosoi's requirements.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RasterSanityChecks(structure.raster, init.structure, none.at.start = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="RasterSanityChecks_+3A_structure.raster">structure.raster</code></td>
<td>
<p>raster object defining the environmental variable.</p>
</td></tr>
<tr><td><code id="RasterSanityChecks_+3A_init.structure">init.structure</code></td>
<td>
<p>which state (i.e. location) the initially infected individuals are located.</p>
</td></tr>
</table>

<hr>
<h2 id='sampleTransmissionTree'>Sample the transmission tree (phylogenetic tree-like)</h2><span id='topic+sampleTransmissionTree'></span>

<h3>Description</h3>

<p>Sample a full transmission tree. This function allows for sampling multiple
times on the same lineage. When this happens, the sampled ancestor is
a tip with length zero.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sampleTransmissionTree(nosoiInf, tree, samples)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sampleTransmissionTree_+3A_nosoiinf">nosoiInf</code></td>
<td>
<p>an object of class <code><a href="#topic+nosoiSim">nosoiSim</a></code></p>
</td></tr>
<tr><td><code id="sampleTransmissionTree_+3A_tree">tree</code></td>
<td>
<p>a <code><a href="tidytree.html#topic+treedata">treedata</a></code> object created by function <code><a href="#topic+getTransmissionTree">getTransmissionTree</a></code></p>
</td></tr>
<tr><td><code id="sampleTransmissionTree_+3A_samples">samples</code></td>
<td>
<p>a <code><a href="data.table.html#topic+data.table">data.table</a></code> object with the following entries:
</p>

<dl>
<dt>hosts</dt><dd><p>Host ID of the individuals to be sampled</p>
</dd>
<dt>times</dt><dd><p>Times at which each host is sampled</p>
</dd>
<dt>labels</dt><dd><p>label for the corresponding tip in the tree</p>
</dd>
</dl>
</td></tr>
</table>


<h3>Details</h3>

<p>The tree needs to be produced by function <code><a href="#topic+getTransmissionTree">getTransmissionTree</a></code>
applied on the same <code>nosoiSim</code> object.
</p>


<h3>Value</h3>

<p>A tree of class <code><a href="tidytree.html#topic+treedata-class">treedata</a></code>, containing a
phylogenetic tree based on the transmission chain and the mapped data at all the nodes.
</p>


<h3>See Also</h3>

<p>For exporting the annotated tree to other software packages, see functions
in <span class="pkg">treeio</span> (e.g. <code><a href="treeio.html#topic+write.beast">write.beast</a></code>).
</p>
<p>To get the full transmission matrix, see <code><a href="#topic+getTransmissionTree">getTransmissionTree</a></code>.
</p>
<p>For sampling only dead individuals, see <code><a href="#topic+sampleTransmissionTreeFromExiting">sampleTransmissionTreeFromExiting</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
t_incub_fct &lt;- function(x){rnorm(x,mean = 5,sd=1)}
p_max_fct &lt;- function(x){rbeta(x,shape1 = 5,shape2=2)}
p_Exit_fct  &lt;- function(t){return(0.08)}
p_Move_fct  &lt;- function(t){return(0.1)}

proba &lt;- function(t,p_max,t_incub){
  if(t &lt;= t_incub){p=0}
  if(t &gt;= t_incub){p=p_max}
  return(p)
}

time_contact = function(t){round(rnorm(1, 3, 1), 0)}

transition.matrix = matrix(c(0, 0.2, 0.4, 0.5, 0, 0.6, 0.5, 0.8, 0),
                           nrow = 3, ncol = 3,
                           dimnames = list(c("A", "B", "C"), c("A", "B", "C")))

set.seed(805)
test.nosoi &lt;- nosoiSim(type="single", popStructure="discrete",
                        length=20,
                        max.infected=100,
                        init.individuals=1,
                        init.structure="A",
                        structure.matrix=transition.matrix,
                        pMove=p_Move_fct,
                        param.pMove=NA,
                        nContact=time_contact,
                        param.nContact=NA,
                        pTrans = proba,
                        param.pTrans = list(p_max=p_max_fct,
                                            t_incub=t_incub_fct),
                        pExit=p_Exit_fct,
                        param.pExit=NA
)

## Make sure all needed packages are here
if (requireNamespace("ape", quietly = TRUE) &amp;&amp;
    requireNamespace("tidytree", quietly = TRUE) &amp;&amp;
    requireNamespace("treeio", quietly = TRUE)) {
  library(ape)
  library(tidytree)
  library(treeio)

  #' ## Full transmission tree
  ttreedata &lt;- getTransmissionTree(test.nosoi)
  plot(ttreedata@phylo)

  ## Sampling "non dead" individuals
  hID &lt;- c("H-1", "H-7", "H-15", "H-100")
  samples &lt;- data.table(hosts = hID,
                        times = c(5.2, 9.3, 10.2, 16),
                        labels = paste0(hID, "-s"))

  sampledTree &lt;- sampleTransmissionTree(test.nosoi, ttreedata, samples)
  plot(sampledTree@phylo)

  ## Sampling "dead" individuals
  sampledDeadTree &lt;- sampleTransmissionTreeFromExiting(ttreedata, hID)
  plot(sampledDeadTree@phylo)
  }


</code></pre>

<hr>
<h2 id='sampleTransmissionTreeFromExiting'>Sample the transmission tree (phylogenetic tree-like) among the exited hosts</h2><span id='topic+sampleTransmissionTreeFromExiting'></span>

<h3>Description</h3>

<p>Sample a full transmission tree. This function allows for sampling only exited (i.e. inactive)
individuals (e.g. when the sampling procedure is destructive or cuts the hosts from the population).
Beware because it does not influence the epidemiological process, it only means that the host
has been sampled when exiting the simulation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sampleTransmissionTreeFromExiting(tree, hosts)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sampleTransmissionTreeFromExiting_+3A_tree">tree</code></td>
<td>
<p>a <code><a href="tidytree.html#topic+treedata-class">treedata</a></code> object created by function <code><a href="#topic+getTransmissionTree">getTransmissionTree</a></code></p>
</td></tr>
<tr><td><code id="sampleTransmissionTreeFromExiting_+3A_hosts">hosts</code></td>
<td>
<p>a vector of dead hosts to sample</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The tree needs to be produced by function <code><a href="#topic+getTransmissionTree">getTransmissionTree</a></code>
applied on the same <code>nosoiSim</code> object.
</p>


<h3>Value</h3>

<p>A tree of class <code><a href="tidytree.html#topic+treedata-class">treedata</a></code>, containing a
phylogenetic tree based on the transmission chain and the mapped data at all the nodes.
</p>


<h3>See Also</h3>

<p>For exporting the annotated tree to other software packages, see functions
in <span class="pkg">treeio</span> (e.g. <code><a href="treeio.html#topic+write.beast">write.beast</a></code>).
</p>
<p>To get the full transmission matrix, see <code><a href="#topic+getTransmissionTree">getTransmissionTree</a></code>.
</p>
<p>For sampling among non-dead individuals, see <code><a href="#topic+sampleTransmissionTree">sampleTransmissionTree</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
t_incub_fct &lt;- function(x){rnorm(x,mean = 5,sd=1)}
p_max_fct &lt;- function(x){rbeta(x,shape1 = 5,shape2=2)}
p_Exit_fct  &lt;- function(t){return(0.08)}
p_Move_fct  &lt;- function(t){return(0.1)}

proba &lt;- function(t,p_max,t_incub){
  if(t &lt;= t_incub){p=0}
  if(t &gt;= t_incub){p=p_max}
  return(p)
}

time_contact = function(t){round(rnorm(1, 3, 1), 0)}

transition.matrix = matrix(c(0, 0.2, 0.4, 0.5, 0, 0.6, 0.5, 0.8, 0),
                           nrow = 3, ncol = 3,
                           dimnames = list(c("A", "B", "C"), c("A", "B", "C")))

set.seed(805)
test.nosoi &lt;- nosoiSim(type="single", popStructure="discrete",
                        length=20,
                        max.infected=100,
                        init.individuals=1,
                        init.structure="A",
                        structure.matrix=transition.matrix,
                        pMove=p_Move_fct,
                        param.pMove=NA,
                        nContact=time_contact,
                        param.nContact=NA,
                        pTrans = proba,
                        param.pTrans = list(p_max=p_max_fct,
                                            t_incub=t_incub_fct),
                        pExit=p_Exit_fct,
                        param.pExit=NA
)

## Make sure all needed packages are here
if (requireNamespace("ape", quietly = TRUE) &amp;&amp;
    requireNamespace("tidytree", quietly = TRUE) &amp;&amp;
    requireNamespace("treeio", quietly = TRUE)) {
  library(ape)
  library(tidytree)
  library(treeio)

  #' ## Full transmission tree
  ttreedata &lt;- getTransmissionTree(test.nosoi)
  plot(ttreedata@phylo)

  ## Sampling "non dead" individuals
  hID &lt;- c("H-1", "H-7", "H-15", "H-100")
  samples &lt;- data.table(hosts = hID,
                        times = c(5.2, 9.3, 10.2, 16),
                        labels = paste0(hID, "-s"))

  sampledTree &lt;- sampleTransmissionTree(test.nosoi, ttreedata, samples)
  plot(sampledTree@phylo)

  ## Sampling "dead" individuals
  sampledDeadTree &lt;- sampleTransmissionTreeFromExiting(ttreedata, hID)
  plot(sampledDeadTree@phylo)
  }


</code></pre>

<hr>
<h2 id='singleContinuous'>Single-host pathogen in a structured (continuous) host population</h2><span id='topic+singleContinuous'></span>

<h3>Description</h3>

<p>This function runs a single-host transmission chain simulation, with a structured host population (such as spatial features) in a continuous space.
The simulation stops either at the end of given time (specified by length.sim) or when the number of hosts infected threshold (max.infected)
is passed. The movement of hosts on the continuous space map is a random walk (Brownian motion) that can be modified towards a biased random walk where hosts tend to be attracted to higher values of the environmental variable defined by the raster.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>singleContinuous(
  length.sim,
  max.infected,
  init.individuals,
  init.structure,
  structure.raster,
  diff.pExit = FALSE,
  timeDep.pExit = FALSE,
  hostCount.pExit = FALSE,
  pExit,
  param.pExit,
  diff.pMove = FALSE,
  timeDep.pMove = FALSE,
  hostCount.pMove = FALSE,
  pMove,
  param.pMove,
  diff.sdMove = FALSE,
  timeDep.sdMove = FALSE,
  hostCount.sdMove = FALSE,
  sdMove,
  param.sdMove,
  attracted.by.raster = FALSE,
  diff.nContact = FALSE,
  timeDep.nContact = FALSE,
  hostCount.nContact = FALSE,
  nContact,
  param.nContact,
  diff.pTrans = FALSE,
  timeDep.pTrans = FALSE,
  hostCount.pTrans = FALSE,
  pTrans,
  param.pTrans,
  prefix.host = "H",
  print.progress = TRUE,
  print.step = 10
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="singleContinuous_+3A_length.sim">length.sim</code></td>
<td>
<p>specifies the length (in unit of time) over which the simulation should be run.</p>
</td></tr>
<tr><td><code id="singleContinuous_+3A_max.infected">max.infected</code></td>
<td>
<p>specifies the maximum number of hosts that can be infected in the simulation.</p>
</td></tr>
<tr><td><code id="singleContinuous_+3A_init.individuals">init.individuals</code></td>
<td>
<p>number of initially infected individuals.</p>
</td></tr>
<tr><td><code id="singleContinuous_+3A_init.structure">init.structure</code></td>
<td>
<p>in which location the initially infected individuals are located. A vector of coordinates in the same coordinate space as the raster.</p>
</td></tr>
<tr><td><code id="singleContinuous_+3A_structure.raster">structure.raster</code></td>
<td>
<p>raster object defining the environmental variable.</p>
</td></tr>
<tr><td><code id="singleContinuous_+3A_diff.pexit">diff.pExit</code></td>
<td>
<p>does pExit depend on the environmental variable (set by the raster) (TRUE/FALSE).</p>
</td></tr>
<tr><td><code id="singleContinuous_+3A_timedep.pexit">timeDep.pExit</code></td>
<td>
<p>is pExit dependent on the absolute time of the simulation? (TRUE/FALSE)</p>
</td></tr>
<tr><td><code id="singleContinuous_+3A_hostcount.pexit">hostCount.pExit</code></td>
<td>
<p>does pExit vary with the host count in each raster cell? (TRUE/FALSE); if TRUE, diff.pExit should be TRUE.</p>
</td></tr>
<tr><td><code id="singleContinuous_+3A_pexit">pExit</code></td>
<td>
<p>function that gives the probability to exit the simulation for an infected host (either moving out, dying, etc.).</p>
</td></tr>
<tr><td><code id="singleContinuous_+3A_param.pexit">param.pExit</code></td>
<td>
<p>parameter names (list of functions) for the pExit.</p>
</td></tr>
<tr><td><code id="singleContinuous_+3A_diff.pmove">diff.pMove</code></td>
<td>
<p>does pMove depend on the environmental variable (set by the raster) (TRUE/FALSE).</p>
</td></tr>
<tr><td><code id="singleContinuous_+3A_timedep.pmove">timeDep.pMove</code></td>
<td>
<p>does pMove depend on the absolute time of the simulation (TRUE/FALSE).</p>
</td></tr>
<tr><td><code id="singleContinuous_+3A_hostcount.pmove">hostCount.pMove</code></td>
<td>
<p>does pMove vary with the host count in each raster cell? (TRUE/FALSE); if TRUE, diff.pMove should also be TRUE.</p>
</td></tr>
<tr><td><code id="singleContinuous_+3A_pmove">pMove</code></td>
<td>
<p>function that gives the probability of a host moving as a function of time.</p>
</td></tr>
<tr><td><code id="singleContinuous_+3A_param.pmove">param.pMove</code></td>
<td>
<p>parameter names (list of functions) for the pMove.</p>
</td></tr>
<tr><td><code id="singleContinuous_+3A_diff.sdmove">diff.sdMove</code></td>
<td>
<p>does sdMove depend on the environmental variable (set by the raster) (TRUE/FALSE).</p>
</td></tr>
<tr><td><code id="singleContinuous_+3A_timedep.sdmove">timeDep.sdMove</code></td>
<td>
<p>does sdMove depend on the absolute time of the simulation (TRUE/FALSE).</p>
</td></tr>
<tr><td><code id="singleContinuous_+3A_hostcount.sdmove">hostCount.sdMove</code></td>
<td>
<p>does sdMove vary with the host count in each raster cell? (TRUE/FALSE); if TRUE, diff.sdMove should be TRUE.</p>
</td></tr>
<tr><td><code id="singleContinuous_+3A_sdmove">sdMove</code></td>
<td>
<p>function that gives the distance traveled (based on coordinates); output is the standard deviation value for the Brownian motion.</p>
</td></tr>
<tr><td><code id="singleContinuous_+3A_param.sdmove">param.sdMove</code></td>
<td>
<p>parameter names (list of functions) for sdMove.</p>
</td></tr>
<tr><td><code id="singleContinuous_+3A_attracted.by.raster">attracted.by.raster</code></td>
<td>
<p>should the hosts be attracted by higher values in the environmental raster? (TRUE/FALSE).</p>
</td></tr>
<tr><td><code id="singleContinuous_+3A_diff.ncontact">diff.nContact</code></td>
<td>
<p>does nContact depend on the environmental variable (set by the raster) (TRUE/FALSE).</p>
</td></tr>
<tr><td><code id="singleContinuous_+3A_timedep.ncontact">timeDep.nContact</code></td>
<td>
<p>is nContact dependent on the absolute time of the simulation? (TRUE/FALSE)</p>
</td></tr>
<tr><td><code id="singleContinuous_+3A_hostcount.ncontact">hostCount.nContact</code></td>
<td>
<p>does nContact vary with the host count in each raster cell? (TRUE/FALSE); if TRUE, diff.nContact should be TRUE.</p>
</td></tr>
<tr><td><code id="singleContinuous_+3A_ncontact">nContact</code></td>
<td>
<p>function that gives the number of potential transmission events per unit of time.</p>
</td></tr>
<tr><td><code id="singleContinuous_+3A_param.ncontact">param.nContact</code></td>
<td>
<p>parameter names (list of functions) for param.nContact.</p>
</td></tr>
<tr><td><code id="singleContinuous_+3A_diff.ptrans">diff.pTrans</code></td>
<td>
<p>does pTrans depend on the environmental variable (set by the raster) (TRUE/FALSE).</p>
</td></tr>
<tr><td><code id="singleContinuous_+3A_timedep.ptrans">timeDep.pTrans</code></td>
<td>
<p>is pTrans dependent on the absolute time of the simulation? (TRUE/FALSE)</p>
</td></tr>
<tr><td><code id="singleContinuous_+3A_hostcount.ptrans">hostCount.pTrans</code></td>
<td>
<p>does pTrans vary with the host count in each raster cell? (TRUE/FALSE); if TRUE, diff.pTrans should be TRUE.</p>
</td></tr>
<tr><td><code id="singleContinuous_+3A_ptrans">pTrans</code></td>
<td>
<p>function that gives the probability of transmit a pathogen as a function of time since infection.</p>
</td></tr>
<tr><td><code id="singleContinuous_+3A_param.ptrans">param.pTrans</code></td>
<td>
<p>parameter names (list of functions) for the pExit.</p>
</td></tr>
<tr><td><code id="singleContinuous_+3A_prefix.host">prefix.host</code></td>
<td>
<p>character(s) to be used as a prefix for the hosts identification number.</p>
</td></tr>
<tr><td><code id="singleContinuous_+3A_print.progress">print.progress</code></td>
<td>
<p>if TRUE, displays a progress bar (current time/length.sim).</p>
</td></tr>
<tr><td><code id="singleContinuous_+3A_print.step">print.step</code></td>
<td>
<p>print.progress is TRUE, step with which the progress message will be printed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>pExit</code> and <code>pTrans</code> functions should return a single probability (a number between 0 and 1), and <code>nContact</code> a positive natural number (positive integer) or 0.
</p>
<p>The <code>param</code> arguments should be a list of functions or NA. Each item name in the parameter list should have the same name as the argument in the corresponding function.
</p>
<p>The use of <code>timeDep</code> (switch to <code>TRUE</code>) makes the corresponding function use the argument <code>prestime</code> (for &quot;present time&quot;).
</p>


<h3>Value</h3>

<p>An object of class <code><a href="#topic+nosoiSim">nosoiSim</a></code>, containing all results of the simulation.
</p>


<h3>Raster</h3>

<p>The structure raster provided provided should of class <code>raster</code>. High values of the environmental variable can attract hosts if <code>attracted.by.raster</code> is TRUE.
</p>


<h3>Structure Parameters</h3>

<p>The <code>pMove</code> function should return a single probability (a number between 0 and 1), and <code>sdMove</code> a real number (keep in mind this number is related to your coordinate space).
</p>
<p>The use of <code>diff</code> (switch to <code>TRUE</code>) makes the corresponding function use the argument <code>current.env.value</code> (for &quot;current environmental value&quot;).
</p>
<p>The use of <code>hostCount</code> (switch to <code>TRUE</code>) makes the corresponding function use the argument <code>host.count</code>.
</p>


<h3>Order of Arguments</h3>

<p>The user specified function's arguments should follow this order: <code>t</code> (mandatory), <code>prestime</code> (optional, only if timeDep is TRUE),
<code>current.env.value</code> (optional, only if diff is TRUE), <code>host.count</code> (optional, only if hostCount is TRUE) and <code>parameters</code> specified in the list.
</p>


<h3>See Also</h3>

<p>For simulations with a discrete structure, see <code><a href="#topic+singleDiscrete">singleDiscrete</a></code>. For simulations without any structures, see <code><a href="#topic+singleNone">singleNone</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(raster)
#Generating a raster for the movement
set.seed(860)

test.raster &lt;- raster(nrows=100, ncols=100, xmn=-50, xmx=50, ymn=-50,ymx=50)
test.raster[] &lt;- runif(10000, -80, 180)
test.raster &lt;- focal(focal(test.raster, w=matrix(1, 5, 5), mean), w=matrix(1, 5, 5), mean)
plot(test.raster)

t_incub_fct &lt;- function(x){rnorm(x,mean = 5,sd=1)}
p_max_fct &lt;- function(x){rbeta(x,shape1 = 5,shape2=2)}
p_Move_fct  &lt;- function(t){return(0.1)}

sdMove_fct = function(t,current.env.value){return(100/(current.env.value+1))}

p_Exit_fct  &lt;- function(t){return(0.08)}

proba &lt;- function(t,p_max,t_incub){
  if(t &lt;= t_incub){p=0}
  if(t &gt;= t_incub){p=p_max}
  return(p)
}

time_contact = function(t){round(rnorm(1, 3, 1), 0)}

start.pos &lt;- c(0,0)

test.nosoiA &lt;- nosoiSim(type="single", popStructure="continuous",
                   length=200,
                   max.infected=500,
                   init.individuals=1,
                   init.structure=start.pos,
                   structure.raster=test.raster,
                   pMove=p_Move_fct,
                   param.pMove=NA,
                   diff.sdMove=TRUE,
                   sdMove=sdMove_fct,
                   param.sdMove=NA,
                   attracted.by.raster=TRUE,
                   nContact=time_contact,
                   param.nContact=NA,
                   pTrans = proba,
                   param.pTrans = list(p_max=p_max_fct,
                                       t_incub=t_incub_fct),
                   pExit=p_Exit_fct,
                   param.pExit=NA)

</code></pre>

<hr>
<h2 id='singleDiscrete'>Single-host pathogen in a structured (discrete) host population</h2><span id='topic+singleDiscrete'></span>

<h3>Description</h3>

<p>This function, that can be wrapped within <code><a href="#topic+nosoiSim">nosoiSim</a></code>, runs a single-host transmission chain simulation, with a discrete host population structure (e.g. spatial, socio-economic, etc.). The simulation stops either at
the end of given time (specified by <code>length.sim</code>) or when the number of hosts infected threshold (<code>max.infected</code>) is crossed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>singleDiscrete(
  length.sim,
  max.infected,
  init.individuals,
  init.structure,
  structure.matrix,
  diff.pExit = FALSE,
  timeDep.pExit = FALSE,
  hostCount.pExit = FALSE,
  pExit,
  param.pExit,
  diff.pMove = FALSE,
  timeDep.pMove = FALSE,
  hostCount.pMove = FALSE,
  pMove,
  param.pMove,
  diff.nContact = FALSE,
  timeDep.nContact = FALSE,
  hostCount.nContact = FALSE,
  nContact,
  param.nContact,
  diff.pTrans = FALSE,
  timeDep.pTrans = FALSE,
  hostCount.pTrans = FALSE,
  pTrans,
  param.pTrans,
  prefix.host = "H",
  print.progress = TRUE,
  print.step = 10
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="singleDiscrete_+3A_length.sim">length.sim</code></td>
<td>
<p>specifies the length (in unit of time) over which the simulation should be run.</p>
</td></tr>
<tr><td><code id="singleDiscrete_+3A_max.infected">max.infected</code></td>
<td>
<p>specifies the maximum number of hosts that can be infected in the simulation.</p>
</td></tr>
<tr><td><code id="singleDiscrete_+3A_init.individuals">init.individuals</code></td>
<td>
<p>number of initially infected individuals.</p>
</td></tr>
<tr><td><code id="singleDiscrete_+3A_init.structure">init.structure</code></td>
<td>
<p>in which state (e.g. location) the initially infected individuals are located.</p>
</td></tr>
<tr><td><code id="singleDiscrete_+3A_structure.matrix">structure.matrix</code></td>
<td>
<p>transition matrix (probabilities) to go from location A (row) to B (column)</p>
</td></tr>
<tr><td><code id="singleDiscrete_+3A_diff.pexit">diff.pExit</code></td>
<td>
<p>is pExit different between states of the structured population (TRUE/FALSE)</p>
</td></tr>
<tr><td><code id="singleDiscrete_+3A_timedep.pexit">timeDep.pExit</code></td>
<td>
<p>is pExit dependent on the absolute time of the simulation? (TRUE/FALSE)</p>
</td></tr>
<tr><td><code id="singleDiscrete_+3A_hostcount.pexit">hostCount.pExit</code></td>
<td>
<p>does pExit varies with the host count in the state? (TRUE/FALSE); diff.pExit should be TRUE.</p>
</td></tr>
<tr><td><code id="singleDiscrete_+3A_pexit">pExit</code></td>
<td>
<p>function that gives the probability to exit the simulation for an infected host (either moving out, dying, etc.).</p>
</td></tr>
<tr><td><code id="singleDiscrete_+3A_param.pexit">param.pExit</code></td>
<td>
<p>parameter names (list of functions) for the pExit.</p>
</td></tr>
<tr><td><code id="singleDiscrete_+3A_diff.pmove">diff.pMove</code></td>
<td>
<p>is pMove different between states of the structured population (TRUE/FALSE)</p>
</td></tr>
<tr><td><code id="singleDiscrete_+3A_timedep.pmove">timeDep.pMove</code></td>
<td>
<p>is pMove dependent on the absolute time of the simulation (TRUE/FALSE)</p>
</td></tr>
<tr><td><code id="singleDiscrete_+3A_hostcount.pmove">hostCount.pMove</code></td>
<td>
<p>does pMove varies with the host count in the state? (TRUE/FALSE); diff.pMove should be TRUE.</p>
</td></tr>
<tr><td><code id="singleDiscrete_+3A_pmove">pMove</code></td>
<td>
<p>function that gives the probability of a host moving as a function of time.</p>
</td></tr>
<tr><td><code id="singleDiscrete_+3A_param.pmove">param.pMove</code></td>
<td>
<p>parameter names (list of functions) for the pMove.</p>
</td></tr>
<tr><td><code id="singleDiscrete_+3A_diff.ncontact">diff.nContact</code></td>
<td>
<p>is nContact different between states of the structured population (TRUE/FALSE)</p>
</td></tr>
<tr><td><code id="singleDiscrete_+3A_timedep.ncontact">timeDep.nContact</code></td>
<td>
<p>is nContact dependent on the absolute time of the simulation? (TRUE/FALSE)</p>
</td></tr>
<tr><td><code id="singleDiscrete_+3A_hostcount.ncontact">hostCount.nContact</code></td>
<td>
<p>does nContact varies with the host count in the state? (TRUE/FALSE); diff.nContact should be TRUE.</p>
</td></tr>
<tr><td><code id="singleDiscrete_+3A_ncontact">nContact</code></td>
<td>
<p>function that gives the number of potential transmission events per unit of time.</p>
</td></tr>
<tr><td><code id="singleDiscrete_+3A_param.ncontact">param.nContact</code></td>
<td>
<p>parameter names (list of functions) for param.nContact.</p>
</td></tr>
<tr><td><code id="singleDiscrete_+3A_diff.ptrans">diff.pTrans</code></td>
<td>
<p>is pTrans different between states of the structured population (TRUE/FALSE)</p>
</td></tr>
<tr><td><code id="singleDiscrete_+3A_timedep.ptrans">timeDep.pTrans</code></td>
<td>
<p>is pTrans dependent on the absolute time of the simulation? (TRUE/FALSE)</p>
</td></tr>
<tr><td><code id="singleDiscrete_+3A_hostcount.ptrans">hostCount.pTrans</code></td>
<td>
<p>does pTrans varies with the host count in the state? (TRUE/FALSE); diff.pTrans should be TRUE.</p>
</td></tr>
<tr><td><code id="singleDiscrete_+3A_ptrans">pTrans</code></td>
<td>
<p>function that gives the probability of transmit a pathogen as a function of time since infection.</p>
</td></tr>
<tr><td><code id="singleDiscrete_+3A_param.ptrans">param.pTrans</code></td>
<td>
<p>parameter names (list of functions) for the pExit.</p>
</td></tr>
<tr><td><code id="singleDiscrete_+3A_prefix.host">prefix.host</code></td>
<td>
<p>character(s) to be used as a prefix for the hosts identification number.</p>
</td></tr>
<tr><td><code id="singleDiscrete_+3A_print.progress">print.progress</code></td>
<td>
<p>if TRUE, displays a progress bar (current time/length.sim).</p>
</td></tr>
<tr><td><code id="singleDiscrete_+3A_print.step">print.step</code></td>
<td>
<p>print.progress is TRUE, step with which the progress message will be printed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>pExit</code> and <code>pTrans</code> functions should return a single probability (a number between 0 and 1), and <code>nContact</code> a positive natural number (positive integer) or 0.
</p>
<p>The <code>param</code> arguments should be a list of functions or NA. Each item name in the parameter list should have the same name as the argument in the corresponding function.
</p>
<p>The use of <code>timeDep</code> (switch to <code>TRUE</code>) makes the corresponding function use the argument <code>prestime</code> (for &quot;present time&quot;).
</p>


<h3>Value</h3>

<p>An object of class <code><a href="#topic+nosoiSim">nosoiSim</a></code>, containing all results of the simulation.
</p>


<h3>Structure Matrix</h3>

<p>The structure matrix provided provided should of class <code>matrix</code>, with the same number of rows and columns, rows representing departure state and column the arrival state. All rows should add to 1.
</p>


<h3>Structure Parameters</h3>

<p>The <code>pMove</code> function should return a single probability (a number between 0 and 1).
</p>
<p>The use of <code>diff</code> (switch to <code>TRUE</code>) makes the corresponding function use the argument <code>current.in</code> (for &quot;currently in&quot;). Your function should in that case give a result for every possible discrete state.
</p>
<p>The use of <code>hostCount</code> (switch to <code>TRUE</code>) makes the corresponding function use the argument <code>host.count</code>.
</p>


<h3>Order of Arguments</h3>

<p>The user specified function's arguments should follow this order: <code>t</code> (mandatory), <code>prestime</code> (optional, only if timeDep is TRUE),
<code>current.in</code> (optional, only if diff is TRUE), <code>host.count</code> (optional, only if hostCount is TRUE) and <code>parameters</code> specified in the list.
</p>


<h3>See Also</h3>

<p>For simulations with a structure in continuous space, see <code><a href="#topic+singleContinuous">singleContinuous</a></code>. For simulations without any structures, see <code><a href="#topic+singleNone">singleNone</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
t_incub_fct &lt;- function(x){rnorm(x,mean = 5,sd=1)}
p_max_fct &lt;- function(x){rbeta(x,shape1 = 5,shape2=2)}
p_Exit_fct  &lt;- function(t){return(0.08)}
p_Move_fct  &lt;- function(t){return(0.1)}

proba &lt;- function(t,p_max,t_incub){
 if(t &lt;= t_incub){p=0}
 if(t &gt;= t_incub){p=p_max}
 return(p)
}

time_contact = function(t){round(rnorm(1, 3, 1), 0)}

transition.matrix = matrix(c(0,0.2,0.4,0.5,0,0.6,0.5,0.8,0),
                           nrow = 3, ncol = 3,
                           dimnames=list(c("A","B","C"),c("A","B","C")))

set.seed(805)
test.nosoiA &lt;- nosoiSim(type="single", popStructure="discrete",
                       length=20,
                       max.infected=100,
                       init.individuals=1,
                       init.structure="A",
                       structure.matrix=transition.matrix,
                       pMove=p_Move_fct,
                       param.pMove=NA,
                       nContact=time_contact,
                       param.nContact=NA,
                       pTrans = proba,
                       param.pTrans = list(p_max=p_max_fct,
                                           t_incub=t_incub_fct),
                      pExit=p_Exit_fct,
                      param.pExit=NA)

</code></pre>

<hr>
<h2 id='singleNone'>Single-host pathogen in a homogeneous host population</h2><span id='topic+singleNone'></span>

<h3>Description</h3>

<p>This function, that can be wrapped within <code><a href="#topic+nosoiSim">nosoiSim</a></code>, runs a single-host transmission chain simulation, without any structure features in the host population. The simulation stops either at
the end of given time (specified by <code>length.sim</code>) or when the number of hosts infected threshold (<code>max.infected</code>) is crossed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>singleNone(
  length.sim,
  max.infected,
  init.individuals,
  pExit,
  param.pExit,
  timeDep.pExit = FALSE,
  nContact,
  param.nContact,
  timeDep.nContact = FALSE,
  pTrans,
  param.pTrans,
  timeDep.pTrans = FALSE,
  prefix.host = "H",
  print.progress = TRUE,
  print.step = 10
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="singleNone_+3A_length.sim">length.sim</code></td>
<td>
<p>specifies the length (in unit of time) over which the simulation should be run.</p>
</td></tr>
<tr><td><code id="singleNone_+3A_max.infected">max.infected</code></td>
<td>
<p>specifies the maximum number of hosts that can be infected in the simulation.</p>
</td></tr>
<tr><td><code id="singleNone_+3A_init.individuals">init.individuals</code></td>
<td>
<p>number of initially infected individuals.</p>
</td></tr>
<tr><td><code id="singleNone_+3A_pexit">pExit</code></td>
<td>
<p>function that gives the probability to exit the simulation for an infected host (either moving out, dying, etc.).</p>
</td></tr>
<tr><td><code id="singleNone_+3A_param.pexit">param.pExit</code></td>
<td>
<p>parameter names (list of functions) for the pExit.</p>
</td></tr>
<tr><td><code id="singleNone_+3A_timedep.pexit">timeDep.pExit</code></td>
<td>
<p>is pExit dependent on the absolute time of the simulation? (TRUE/FALSE)</p>
</td></tr>
<tr><td><code id="singleNone_+3A_ncontact">nContact</code></td>
<td>
<p>function that gives the number of potential transmission events per unit of time.</p>
</td></tr>
<tr><td><code id="singleNone_+3A_param.ncontact">param.nContact</code></td>
<td>
<p>parameter names (list of functions) for param.nContact.</p>
</td></tr>
<tr><td><code id="singleNone_+3A_timedep.ncontact">timeDep.nContact</code></td>
<td>
<p>is nContact dependent on the absolute time of the simulation? (TRUE/FALSE)</p>
</td></tr>
<tr><td><code id="singleNone_+3A_ptrans">pTrans</code></td>
<td>
<p>function that gives the probability of transmit a pathogen as a function of time since infection.</p>
</td></tr>
<tr><td><code id="singleNone_+3A_param.ptrans">param.pTrans</code></td>
<td>
<p>parameter names (list of functions) for the pExit.</p>
</td></tr>
<tr><td><code id="singleNone_+3A_timedep.ptrans">timeDep.pTrans</code></td>
<td>
<p>is pTrans dependent on the absolute time of the simulation? (TRUE/FALSE)</p>
</td></tr>
<tr><td><code id="singleNone_+3A_prefix.host">prefix.host</code></td>
<td>
<p>character(s) to be used as a prefix for the hosts identification number.</p>
</td></tr>
<tr><td><code id="singleNone_+3A_print.progress">print.progress</code></td>
<td>
<p>if TRUE, displays a progress bar (current time/length.sim).</p>
</td></tr>
<tr><td><code id="singleNone_+3A_print.step">print.step</code></td>
<td>
<p>print.progress is TRUE, step with which the progress message will be printed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>pExit</code> and <code>pTrans</code> functions should return a single probability (a number between 0 and 1), and <code>nContact</code> a positive natural number (positive integer) or 0.
</p>
<p>The <code>param</code> arguments should be a list of functions or NA. Each item name in the parameter list should have the same name as the argument in the corresponding function.
</p>
<p>The use of <code>timeDep</code> (switch to <code>TRUE</code>) makes the corresponding function use the argument <code>prestime</code> (for &quot;present time&quot;).
</p>


<h3>Value</h3>

<p>An object of class <code><a href="#topic+nosoiSim">nosoiSim</a></code>, containing all results of the simulation.
</p>


<h3>Order of Arguments</h3>

<p>The user specified function's arguments should follow this order: <code>t</code> (mandatory), <code>prestime</code> (optional, only if timeDep is TRUE), <code>parameters</code> specified in the list.
</p>


<h3>See Also</h3>

<p>For simulations with a discrete structured host population, see <code><a href="#topic+singleDiscrete">singleDiscrete</a></code>. For simulations with a structured population in continuous space, <code><a href="#topic+singleContinuous">singleContinuous</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
t_incub_fct &lt;- function(x){rnorm(x,mean = 5,sd=1)}
p_max_fct &lt;- function(x){rbeta(x,shape1 = 5,shape2=2)}
p_Exit_fct  &lt;- function(t){return(0.08)}

proba &lt;- function(t,p_max,t_incub){
 if(t &lt;= t_incub){p=0}
 if(t &gt;= t_incub){p=p_max}
 return(p)
}

time_contact &lt;- function(t){round(rnorm(1, 3, 1), 0)}

test.nosoi &lt;- nosoiSim(type="single", popStructure="none",
                      length=40,
                      max.infected=100,
                      init.individuals=1,
                      nContact=time_contact,
                      param.nContact=NA,
                      pTrans = proba,
                      param.pTrans = list(p_max=p_max_fct,
                                          t_incub=t_incub_fct),
                      pExit=p_Exit_fct,
                      param.pExit=NA)

test.nosoi

</code></pre>

<hr>
<h2 id='updateHostCount'>Summarise position of hosts in a discrete or discretized (raster) space</h2><span id='topic+updateHostCount'></span>

<h3>Description</h3>

<p>Returns a table of the number of hosts per discrete or discretized (raster cells) states.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>updateHostCount(res, res.B = NULL, type)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="updateHostCount_+3A_res">res</code></td>
<td>
<p>an object of class <code>nosoiSimOne</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data.table containing state.ID (col1) and count (col2)
</p>

<hr>
<h2 id='updateTableState'>Update table state with exiting individuals</h2><span id='topic+updateTableState'></span>

<h3>Description</h3>

<p>Return a vector of exiting individuals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>updateTableState(res, exiting, pres.time)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="updateTableState_+3A_res">res</code></td>
<td>
<p>an object of class <code>nosoiSimOne</code>.</p>
</td></tr>
<tr><td><code id="updateTableState_+3A_exiting">exiting</code></td>
<td>
<p>a vector (TRUE/FALSE) of exiting individuals</p>
</td></tr>
<tr><td><code id="updateTableState_+3A_pres.time">pres.time</code></td>
<td>
<p>current time</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>nosoiSim</code> object
</p>

<hr>
<h2 id='writeInfected'>Write newly infected function</h2><span id='topic+writeInfected'></span>

<h3>Description</h3>

<p>Perform the tasks related to creating new lines of hosts in relevant tables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>writeInfected(df.meetTransmit, res, pres.time, ParamHost)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="writeInfected_+3A_df.meettransmit">df.meetTransmit</code></td>
<td>
<p>table with active transmission events, coming from <code>meetTransmit</code></p>
</td></tr>
<tr><td><code id="writeInfected_+3A_res">res</code></td>
<td>
<p>an object of class <code>nosoiSimOne</code>.</p>
</td></tr>
<tr><td><code id="writeInfected_+3A_paramhost">ParamHost</code></td>
<td>
<p>list of individual based parameters.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The modified object res
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
