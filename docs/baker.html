<!DOCTYPE html><html><head><title>Help for package baker</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {baker}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#add_meas_BrS_case_Nest_Slice'><p>add likelihood for a BrS measurement slice among cases (conditional dependence)</p></a></li>
<li><a href='#add_meas_BrS_case_Nest_Slice_jags'><p>add likelihood for a BrS measurement slice among cases (conditional dependence)</p></a></li>
<li><a href='#add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags'><p>add likelihood component for a BrS measurement slice among cases</p></a></li>
<li><a href='#add_meas_BrS_case_NoNest_reg_Slice_jags'><p>add likelihood component for a BrS measurement slice among cases</p></a></li>
<li><a href='#add_meas_BrS_case_NoNest_Slice'><p>add a likelihood component for a BrS measurement slice among cases (conditional independence)</p></a></li>
<li><a href='#add_meas_BrS_case_NoNest_Slice_jags'><p>add a likelihood component for a BrS measurement slice among cases (conditional independence)</p></a></li>
<li><a href='#add_meas_BrS_ctrl_Nest_Slice'><p>add likelihood for a BrS measurement slice among controls (conditional independence)</p></a></li>
<li><a href='#add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags'><p>add a likelihood component for a BrS measurement slice among controls</p></a></li>
<li><a href='#add_meas_BrS_ctrl_NoNest_reg_Slice_jags'><p>add a likelihood component for a BrS measurement slice among controls</p></a></li>
<li><a href='#add_meas_BrS_ctrl_NoNest_Slice'><p>add a likelihood component for a BrS measurement slice among controls (conditional independence)</p></a></li>
<li><a href='#add_meas_BrS_param_Nest_reg_Slice_jags'><p>add parameters for a BrS measurement slice among cases and controls</p></a></li>
<li><a href='#add_meas_BrS_param_Nest_Slice'><p>add parameters for a BrS measurement slice among cases and controls (conditional dependence)</p></a></li>
<li><a href='#add_meas_BrS_param_Nest_Slice_jags'><p>add parameters for a BrS measurement slice among cases and controls (conditional dependence)</p></a></li>
<li><a href='#add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags'><p>add parameters for a BrS measurement slice among cases and controls</p></a></li>
<li><a href='#add_meas_BrS_param_NoNest_reg_Slice_jags'><p>add parameters for a BrS measurement slice among cases and controls</p></a></li>
<li><a href='#add_meas_BrS_param_NoNest_Slice'><p>add parameters for a BrS measurement slice among cases and controls (conditional independence)</p></a></li>
<li><a href='#add_meas_BrS_param_NoNest_Slice_jags'><p>add parameters for a BrS measurement slice among cases and controls (conditional independence)</p></a></li>
<li><a href='#add_meas_BrS_subclass_Nest_Slice'><p>add subclass indicators for a BrS measurement slice among cases and controls (conditional independence)</p></a></li>
<li><a href='#add_meas_SS_case'><p>add likelihood for a SS measurement slice among cases (conditional independence)</p></a></li>
<li><a href='#add_meas_SS_param'><p>add parameters for a SS measurement slice among cases (conditional independence)</p></a></li>
<li><a href='#as.matrix_or_vec'><p>convert one column data frame to a vector</p></a></li>
<li><a href='#assign_model'><p>Interpret the specified model structure</p></a></li>
<li><a href='#baker'><p>baker: <strong>B</strong>ayesian <strong>A</strong>nalytic <strong>K</strong>it for</p>
<strong>E</strong>tiology <strong>R</strong>esearch</a></li>
<li><a href='#beta_parms_from_quantiles'><p>Pick parameters in the Beta distribution to match the specified range</p></a></li>
<li><a href='#beta_plot'><p>Plot beta density</p></a></li>
<li><a href='#bin2dec'><p>Convert a 0/1 binary-coded sequence into decimal digits</p></a></li>
<li><a href='#check_dir_create'><p>check existence and create folder if non-existent</p></a></li>
<li><a href='#clean_combine_subsites'><p>Combine subsites in raw PERCH data set</p></a></li>
<li><a href='#clean_perch_data'><p>Clean PERCH data</p></a></li>
<li><a href='#combine_data_nplcm'><p>combine multiple data_nplcm (useful when simulating data from regression models)</p></a></li>
<li><a href='#compute_logOR_single_cause'><p>Calculate marginal log odds ratios</p></a></li>
<li><a href='#compute_marg_PR_nested_reg'><p>compute positive rates for nested model with subclass mixing weights that are the same across</p>
<code>Jcause</code> classes for each person (people may have different weights.)</a></li>
<li><a href='#compute_marg_PR_nested_reg_array'><p>compute positive rates for nested model with subclass mixing weights that are the same across</p>
<code>Jcause</code> classes for each person (people may have different weights.)</a></li>
<li><a href='#create_bugs_regressor_Eti'><p>create regressor summation equation used in regression for etiology</p></a></li>
<li><a href='#create_bugs_regressor_FPR'><p>create regressor summation equation used in regression for FPR</p></a></li>
<li><a href='#data_nplcm_noreg'><p>Simulated dataset that is structured in the format necessary for an <code>nplcm()</code> without regression</p></a></li>
<li><a href='#data_nplcm_reg_nest'><p>Simulated dataset that is structured in the format necessary for an <code>nplcm()</code> with regression</p></a></li>
<li><a href='#delete_start_with'><p>Deletes a pattern from the start of a string, or each of a vector of strings.</p></a></li>
<li><a href='#dm_Rdate_Eti'><p>Make etiology design matrix for dates with R format.</p></a></li>
<li><a href='#dm_Rdate_FPR'><p>Make FPR design matrix for dates with R format.</p></a></li>
<li><a href='#expit'><p>expit function</p></a></li>
<li><a href='#extract_data_raw'><p>Import Raw PERCH Data</p>
</p>
<p><code>extract_data_raw</code> imports and converts the raw data to analyzable format</p></a></li>
<li><a href='#get_coverage'><p>Obtain coverage status from a result folder</p></a></li>
<li><a href='#get_direct_bias'><p>Obtain direct bias that measure the discrepancy of a posterior</p>
distribution of pie and a true pie.</a></li>
<li><a href='#get_fitted_mean_nested'><p>get fitted mean for nested model with subclass mixing weights that are the same among cases</p></a></li>
<li><a href='#get_fitted_mean_no_nested'><p>get model fitted mean for conditional independence model</p></a></li>
<li><a href='#get_individual_data'><p>get individual data</p></a></li>
<li><a href='#get_individual_prediction'><p>get individual prediction (Bayesian posterior)</p></a></li>
<li><a href='#get_latent_seq'><p>get index of latent status</p></a></li>
<li><a href='#get_marginal_rates_nested'><p>get marginal TPR and FPR for nested model</p></a></li>
<li><a href='#get_marginal_rates_no_nested'><p>get marginal TPR and FPR for no nested model</p></a></li>
<li><a href='#get_metric'><p>Obtain Integrated Squared Aitchison Distance, Squared Bias and Variance (both on</p>
Central Log-Ratio transformed scale) that measure the discrepancy of a posterior
distribution of pie and a true pie.</a></li>
<li><a href='#get_pEti_samp'><p>get etiology samples by names (no regression)</p></a></li>
<li><a href='#get_plot_num'><p>get the plotting positions (numeric) for the fitted means; 3 positions for each cell</p></a></li>
<li><a href='#get_plot_pos'><p>get a list of measurement index where to look for data</p></a></li>
<li><a href='#get_postsd'><p>Obtain posterior standard deviation from a result folder</p></a></li>
<li><a href='#get_top_pattern'><p>get top patterns from a slice of bronze-standard measurement</p></a></li>
<li><a href='#H'><p>Shannon entropy for multivariate discrete data</p></a></li>
<li><a href='#has_non_basis'><p>test if a formula has terms not created by [s_date_Eti() or <code>s_date_FPR()</code></p></a></li>
<li><a href='#I2symb'><p>Convert 0/1 coding to pathogen/combinations</p></a></li>
<li><a href='#Imat2cat'><p>Convert a matrix of binary indicators to categorical variables</p></a></li>
<li><a href='#init_latent_jags_multipleSS'><p>Initialize individual latent status (for <code>JAGS</code>)</p></a></li>
<li><a href='#insert_bugfile_chunk_noreg_etiology'><p>insert distribution for latent status code chunk into .bug file</p></a></li>
<li><a href='#insert_bugfile_chunk_noreg_meas'><p>Insert measurement likelihood (without regression) code chunks into .bug model file</p></a></li>
<li><a href='#insert_bugfile_chunk_reg_discrete_predictor_etiology'><p>insert etiology regression for latent status code chunk into .bug file; discrete predictors</p></a></li>
<li><a href='#insert_bugfile_chunk_reg_discrete_predictor_nonest_meas'><p>Insert measurement likelihood (with regression; discrete) code chunks into .bug model file</p></a></li>
<li><a href='#insert_bugfile_chunk_reg_etiology'><p>insert etiology regression for latent status code chunk into .bug file</p></a></li>
<li><a href='#insert_bugfile_chunk_reg_nest_meas'><p>Insert measurement likelihood (nested model+regression) code chunks into .bug model file</p></a></li>
<li><a href='#insert_bugfile_chunk_reg_nonest_meas'><p>Insert measurement likelihood (with regression) code chunks into .bug model file</p></a></li>
<li><a href='#is_discrete'><p>Check if covariates are discrete</p></a></li>
<li><a href='#is_intercept_only'><p>check if the formula is intercept only</p></a></li>
<li><a href='#is_jags_folder'><p>See if a result folder is obtained by JAGS</p></a></li>
<li><a href='#is_length_all_one'><p>check if a list has elements all of length one</p></a></li>
<li><a href='#is.error'><p>Test for 'try-error' class</p></a></li>
<li><a href='#jags2_baker'><p>Run <code>JAGS</code> from R</p></a></li>
<li><a href='#line2user'><p>convert line to user coordinates</p></a></li>
<li><a href='#loadOneName'><p>load an object from .RDATA file</p></a></li>
<li><a href='#logit'><p>logit function</p></a></li>
<li><a href='#logOR'><p>calculate pairwise log odds ratios</p></a></li>
<li><a href='#logsumexp'><p>log sum exp trick</p></a></li>
<li><a href='#lookup_quality'><p>Get position to store in data_nplcm$Mobs:</p></a></li>
<li><a href='#make_filename'><p>Create new file name</p></a></li>
<li><a href='#make_foldername'><p>Create new folder name</p></a></li>
<li><a href='#make_list'><p>Takes any number of R objects as arguments and returns a list whose names are</p>
derived from the names of the R objects.</a></li>
<li><a href='#make_meas_object'><p>Make measurement slice</p></a></li>
<li><a href='#make_numbered_list'><p>Make a list with numbered names</p></a></li>
<li><a href='#make_template'><p>make a mapping template for model fitting</p></a></li>
<li><a href='#marg_H'><p>Shannon entropy for binary data</p></a></li>
<li><a href='#match_cause'><p>Match latent causes that might have the same combo but</p>
different specifications</a></li>
<li><a href='#merge_lists'><p>For a list of many sublists each of which has matrices as its member,</p>
we combine across the many sublists to produce a final list</a></li>
<li><a href='#my_reorder'><p>Reorder the measurement dimensions to match the order for display</p></a></li>
<li><a href='#NA2dot'><p>convert 'NA' to '.'</p></a></li>
<li><a href='#nplcm'><p>Fit nested partially-latent class models (highest-level wrapper function)</p></a></li>
<li><a href='#nplcm_fit_NoReg'><p>Fit nested partially-latent class model (low-level)</p></a></li>
<li><a href='#nplcm_fit_Reg_discrete_predictor_NoNest'><p>Fit nested partially-latent class model with regression (low-level)</p></a></li>
<li><a href='#nplcm_fit_Reg_Nest'><p>Fit nested partially-latent class model with regression (low-level)</p></a></li>
<li><a href='#nplcm_fit_Reg_NoNest'><p>Fit nested partially-latent class model with regression (low-level)</p></a></li>
<li><a href='#nplcm_read_folder'><p>Read data and other model information from a folder that stores model results.</p></a></li>
<li><a href='#null_as_zero'><p>Convert <code>NULL</code> to zero.</p></a></li>
<li><a href='#order_post_eti'><p>order latent status by posterior mean</p></a></li>
<li><a href='#overall_uniform'><p>specify overall uniform (symmetric Dirichlet distribution) for etiology prior</p></a></li>
<li><a href='#parse_nplcm_reg'><p>parse regression components (either false positive rate or etiology regression)</p>
for fitting npLCM; Only use this when formula is not <code>NULL</code>.</a></li>
<li><a href='#pathogen_category_perch'><p>pathogens and their categories in PERCH study (virus or bacteria)</p></a></li>
<li><a href='#pathogen_category_simulation'><p>Hypothetical pathogens and their categories (virus or bacteria)</p></a></li>
<li><a href='#plot_BrS_panel'><p>Plot bronze-standard (BrS) panel</p></a></li>
<li><a href='#plot_case_study'><p>visualize the PERCH etiology regression with a continuous covariate</p></a></li>
<li><a href='#plot_check_common_pattern'><p>Posterior predictive checking for the nested partially class models -</p>
frequent patterns in the BrS data. (for multiple folders)</a></li>
<li><a href='#plot_check_pairwise_SLORD'><p>Posterior predictive checking for nested partially latent class models -</p>
pairwise log odds ratio (only for bronze-standard data)</a></li>
<li><a href='#plot_etiology_regression'><p>visualize the etiology regression with a continuous covariate</p></a></li>
<li><a href='#plot_etiology_strat'><p>visualize the etiology estimates for each discrete levels</p></a></li>
<li><a href='#plot_leftmost'><p>plotting the labels on the left margin for panels plot</p></a></li>
<li><a href='#plot_logORmat'><p>Visualize pairwise log odds ratios (LOR) for data that are available in</p>
both cases and controls</a></li>
<li><a href='#plot_panels'><p>Plot three-panel figures for nested partially-latent model results</p></a></li>
<li><a href='#plot_pie_panel'><p>Plot etiology (pie) panel</p></a></li>
<li><a href='#plot_SS_panel'><p>Plot silver-standard (SS) panel</p></a></li>
<li><a href='#plot_subwt_regression'><p>visualize the subclass weight regression with a continuous covariate</p></a></li>
<li><a href='#plot.nplcm'><p><code>plot.nplcm</code> plot the results from <code>nplcm()</code>.</p></a></li>
<li><a href='#print.nplcm'><p><code>print.nplcm</code> summarizes the results from <code>nplcm()</code>.</p></a></li>
<li><a href='#print.summary.nplcm.no_reg'><p>Compact printing of <code>nplcm()</code> model fits</p></a></li>
<li><a href='#print.summary.nplcm.reg_nest'><p>Compact printing of <code>nplcm()</code> model fits</p></a></li>
<li><a href='#print.summary.nplcm.reg_nest_strat'><p>Compact printing of <code>nplcm()</code> model fits</p></a></li>
<li><a href='#print.summary.nplcm.reg_nonest'><p>Compact printing of <code>nplcm()</code> model fits</p></a></li>
<li><a href='#print.summary.nplcm.reg_nonest_strat'><p>Compact printing of <code>nplcm()</code> model fits</p></a></li>
<li><a href='#read_meas_object'><p>Read measurement slices</p></a></li>
<li><a href='#rvbern'><p>Sample a vector of Bernoulli variables.</p></a></li>
<li><a href='#s_date_Eti'><p>Make Etiology design matrix for dates with R format.</p></a></li>
<li><a href='#s_date_FPR'><p>Make false positive rate (FPR) design matrix for dates with R format.</p></a></li>
<li><a href='#set_prior_tpr_BrS_NoNest'><p>Set true positive rate (TPR) prior ranges for bronze-standard (BrS) data</p></a></li>
<li><a href='#set_prior_tpr_SS'><p>Set true positive rate (TPR) prior ranges for silver-standard data.</p></a></li>
<li><a href='#set_strat'><p>Stratification setup by covariates</p></a></li>
<li><a href='#show_dep'><p>Show function dependencies</p></a></li>
<li><a href='#show_individual'><p>get an individual's data from the output of <code>clean_perch_data()</code></p></a></li>
<li><a href='#simulate_brs'><p>Simulate Bronze-Standard (BrS) Data</p></a></li>
<li><a href='#simulate_latent'><p>Simulate Latent Status:</p></a></li>
<li><a href='#simulate_nplcm'><p>Simulate data from nested partially-latent class model (npLCM) family</p></a></li>
<li><a href='#simulate_ss'><p>Simulate Silver-Standard (SS) Data</p></a></li>
<li><a href='#softmax'><p>softmax</p></a></li>
<li><a href='#subset_data_nplcm_by_index'><p>subset data from the output of <code>clean_perch_data()</code></p></a></li>
<li><a href='#summarize_BrS'><p>summarize bronze-standard data</p></a></li>
<li><a href='#summarize_SS'><p>silver-standard data summary</p></a></li>
<li><a href='#summary.nplcm'><p><code>summary.nplcm</code> summarizes the results from <code>nplcm()</code>.</p></a></li>
<li><a href='#sym_diff_month'><p>get symmetric difference of months from two vector of R-format dates</p></a></li>
<li><a href='#symb2I'><p>Convert names of pathogen/combinations into 0/1 coding</p></a></li>
<li><a href='#tsb'><p>generate stick-breaking prior (truncated) from a vector of random probabilities</p></a></li>
<li><a href='#unfactor'><p>Convert factor to numeric without losing information on the label</p></a></li>
<li><a href='#unique_cause'><p>get unique causes, regardless of the actual order in combo</p></a></li>
<li><a href='#unique_month'><p>Get unique month from Date</p></a></li>
<li><a href='#visualize_case_control_matrix'><p>Visualize matrix for a quantity measured on cases and controls (a single number)</p></a></li>
<li><a href='#visualize_season'><p>visualize trend of pathogen observation rate for NPPCR data (both cases and controls)</p></a></li>
<li><a href='#write_model_NoReg'><p>Write .bug model file for model without regression</p></a></li>
<li><a href='#write_model_Reg_discrete_predictor_NoNest'><p>Write .bug model file for regression model without nested subclasses</p></a></li>
<li><a href='#write_model_Reg_Nest'><p>Write <code>.bug</code> model file for regression model WITH nested subclasses</p></a></li>
<li><a href='#write_model_Reg_NoNest'><p>Write .bug model file for regression model without nested subclasses</p></a></li>
<li><a href='#write.model'><p>function to write bugs model (copied from R2WinBUGS)</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>"Nested Partially Latent Class Models"</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-01-29</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides functions to specify, fit and visualize
    nested partially-latent class models (
    Wu, Deloria-Knoll, Hammitt, and Zeger (2016) &lt;<a href="https://doi.org/10.1111%2Frssc.12101">doi:10.1111/rssc.12101</a>&gt;; 
    Wu, Deloria-Knoll, and Zeger (2017) &lt;<a href="https://doi.org/10.1093%2Fbiostatistics%2Fkxw037">doi:10.1093/biostatistics/kxw037</a>&gt;;
    Wu and Chen (2021) &lt;<a href="https://doi.org/10.1002%2Fsim.8804">doi:10.1002/sim.8804</a>&gt;) for 
    inference of population disease etiology and individual diagnosis. In the motivating
    Pneumonia Etiology Research for Child Health (PERCH) study, because both quantities
    of interest sum to one hundred percent, the PERCH scientists frequently refer to
    them as population etiology pie and individual etiology pie, hence the name of the package.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R(&ge; 4.3.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>rjags(&ge; 4-6), R2jags(&ge; 0.5), lubridate(&ge; 1.3), binom(&ge;
1.1), coda(&ge; 0.16), robCompositions(&ge; 2.0.3), ggplot2(&ge;
1.0), ggpubr(&ge; 0.4.0), gridExtra(&ge; 2.0), reshape2(&ge; 1.4),
mgcv(&ge; 1.8-6), mvbutils(&ge; 2.7.4.1), shinyFiles(&ge; 0.6),
shinydashboard(&ge; 0.5.1), stats, utils, abind</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>JAGS (&gt;= 4.3.2) (http://mcmc-jags.sourceforge.net)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>spelling, knitr, testthat, rmarkdown, covr, knitcitations, sf</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/zhenkewu/baker">https://github.com/zhenkewu/baker</a>, <a href="https://zhenkewu.com/baker/">https://zhenkewu.com/baker/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/zhenkewu/baker/issues">https://github.com/zhenkewu/baker/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-01-29 20:36:47 UTC; zhenkewu</td>
</tr>
<tr>
<td>Author:</td>
<td>Zhenke Wu <a href="https://orcid.org/0000-0001-7582-669X"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [cre,
    aut, cph],
  Scott Zeger <a href="https://orcid.org/0000-0001-8907-1603"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  John Muschelli <a href="https://orcid.org/0000-0001-6469-1750"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb],
  Irena Chen <a href="https://orcid.org/0000-0002-9366-8506"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Zhenke Wu &lt;zhenkewu@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-01-30 08:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='add_meas_BrS_case_Nest_Slice'>add likelihood for a BrS measurement slice among cases (conditional dependence)</h2><span id='topic+add_meas_BrS_case_Nest_Slice'></span>

<h3>Description</h3>

<p>add likelihood for a BrS measurement slice among cases (conditional dependence)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_meas_BrS_case_Nest_Slice(s, Mobs, cause_list, ppd = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add_meas_BrS_case_Nest_Slice_+3A_s">s</code></td>
<td>
<p>the slice</p>
</td></tr>
<tr><td><code id="add_meas_BrS_case_Nest_Slice_+3A_mobs">Mobs</code></td>
<td>
<p>See <code>data_nplcm</code> described in <code><a href="#topic+nplcm">nplcm()</a></code></p>
</td></tr>
<tr><td><code id="add_meas_BrS_case_Nest_Slice_+3A_cause_list">cause_list</code></td>
<td>
<p>the list of causes in <code>data_nplcm</code> described in <code><a href="#topic+nplcm">nplcm()</a></code></p>
</td></tr>
<tr><td><code id="add_meas_BrS_case_Nest_Slice_+3A_ppd">ppd</code></td>
<td>
<p>Default is NULL; Set to TRUE for enabling posterior predictive checking.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of two elements: the first is <code>plug</code>, the .bug code; the second is <code>parameters</code>
that stores model parameters introduced by this plugged measurement slice
</p>


<h3>See Also</h3>

<p>Other likelihood specification functions: 
<code><a href="#topic+add_meas_BrS_case_Nest_Slice_jags">add_meas_BrS_case_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice_jags">add_meas_BrS_case_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice">add_meas_BrS_case_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_Slice_jags">add_meas_BrS_case_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_Nest_Slice">add_meas_BrS_ctrl_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_Slice">add_meas_BrS_ctrl_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice_jags">add_meas_BrS_param_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice">add_meas_BrS_param_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_reg_Slice_jags">add_meas_BrS_param_Nest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice_jags">add_meas_BrS_param_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice">add_meas_BrS_param_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_Slice_jags">add_meas_BrS_param_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_subclass_Nest_Slice">add_meas_BrS_subclass_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_SS_case">add_meas_SS_case</a>()</code>,
<code><a href="#topic+add_meas_SS_param">add_meas_SS_param</a>()</code>
</p>
<p>Other plug-and-play functions: 
<code><a href="#topic+add_meas_BrS_case_Nest_Slice_jags">add_meas_BrS_case_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice_jags">add_meas_BrS_case_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice">add_meas_BrS_case_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_Slice_jags">add_meas_BrS_case_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_Nest_Slice">add_meas_BrS_ctrl_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_Slice">add_meas_BrS_ctrl_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice_jags">add_meas_BrS_param_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice">add_meas_BrS_param_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_reg_Slice_jags">add_meas_BrS_param_Nest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice_jags">add_meas_BrS_param_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice">add_meas_BrS_param_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_Slice_jags">add_meas_BrS_param_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_subclass_Nest_Slice">add_meas_BrS_subclass_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_SS_case">add_meas_SS_case</a>()</code>,
<code><a href="#topic+add_meas_SS_param">add_meas_SS_param</a>()</code>
</p>

<hr>
<h2 id='add_meas_BrS_case_Nest_Slice_jags'>add likelihood for a BrS measurement slice among cases (conditional dependence)</h2><span id='topic+add_meas_BrS_case_Nest_Slice_jags'></span>

<h3>Description</h3>

<p>add likelihood for a BrS measurement slice among cases (conditional dependence)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_meas_BrS_case_Nest_Slice_jags(s, Mobs, cause_list, ppd = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add_meas_BrS_case_Nest_Slice_jags_+3A_s">s</code></td>
<td>
<p>the slice</p>
</td></tr>
<tr><td><code id="add_meas_BrS_case_Nest_Slice_jags_+3A_mobs">Mobs</code></td>
<td>
<p>See <code>data_nplcm</code> described in <code><a href="#topic+nplcm">nplcm()</a></code></p>
</td></tr>
<tr><td><code id="add_meas_BrS_case_Nest_Slice_jags_+3A_cause_list">cause_list</code></td>
<td>
<p>the list of causes in <code>data_nplcm</code> described in <code><a href="#topic+nplcm">nplcm()</a></code></p>
</td></tr>
<tr><td><code id="add_meas_BrS_case_Nest_Slice_jags_+3A_ppd">ppd</code></td>
<td>
<p>Default is NULL; Set to TRUE for enabling posterior predictive checking.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of two elements: the first is <code>plug</code>, the <code>.bug</code> code;
the second is <code>parameters</code>
that stores model parameters introduced by this plugged measurement slice
</p>


<h3>See Also</h3>

<p>Other likelihood specification functions: 
<code><a href="#topic+add_meas_BrS_case_Nest_Slice">add_meas_BrS_case_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice_jags">add_meas_BrS_case_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice">add_meas_BrS_case_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_Slice_jags">add_meas_BrS_case_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_Nest_Slice">add_meas_BrS_ctrl_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_Slice">add_meas_BrS_ctrl_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice_jags">add_meas_BrS_param_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice">add_meas_BrS_param_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_reg_Slice_jags">add_meas_BrS_param_Nest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice_jags">add_meas_BrS_param_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice">add_meas_BrS_param_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_Slice_jags">add_meas_BrS_param_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_subclass_Nest_Slice">add_meas_BrS_subclass_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_SS_case">add_meas_SS_case</a>()</code>,
<code><a href="#topic+add_meas_SS_param">add_meas_SS_param</a>()</code>
</p>
<p>Other plug-and-play functions: 
<code><a href="#topic+add_meas_BrS_case_Nest_Slice">add_meas_BrS_case_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice_jags">add_meas_BrS_case_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice">add_meas_BrS_case_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_Slice_jags">add_meas_BrS_case_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_Nest_Slice">add_meas_BrS_ctrl_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_Slice">add_meas_BrS_ctrl_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice_jags">add_meas_BrS_param_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice">add_meas_BrS_param_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_reg_Slice_jags">add_meas_BrS_param_Nest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice_jags">add_meas_BrS_param_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice">add_meas_BrS_param_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_Slice_jags">add_meas_BrS_param_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_subclass_Nest_Slice">add_meas_BrS_subclass_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_SS_case">add_meas_SS_case</a>()</code>,
<code><a href="#topic+add_meas_SS_param">add_meas_SS_param</a>()</code>
</p>

<hr>
<h2 id='add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags'>add likelihood component for a BrS measurement slice among cases</h2><span id='topic+add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags'></span>

<h3>Description</h3>

<p>regression model with no nested subclasses; discrete predictors
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags(
  s,
  Mobs,
  prior,
  cause_list,
  ppd = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags_+3A_s">s</code></td>
<td>
<p>the slice</p>
</td></tr>
<tr><td><code id="add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags_+3A_mobs">Mobs</code></td>
<td>
<p>See <code>data_nplcm</code> described in <code><a href="#topic+nplcm">nplcm()</a></code></p>
</td></tr>
<tr><td><code id="add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags_+3A_prior">prior</code></td>
<td>
<p>Prior specifications.</p>
</td></tr>
<tr><td><code id="add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags_+3A_cause_list">cause_list</code></td>
<td>
<p>the list of causes in <code>data_nplcm</code> described in <code><a href="#topic+nplcm">nplcm()</a></code></p>
</td></tr>
<tr><td><code id="add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags_+3A_ppd">ppd</code></td>
<td>
<p>Default is NULL; Set to TRUE for enabling posterior predictive checking.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of two elements: the first is <code>plug</code>, the .bug code;
the second is <code>parameters</code> that stores model parameters introduced by this
plugged measurement slice
</p>


<h3>See Also</h3>

<p>Other likelihood specification functions: 
<code><a href="#topic+add_meas_BrS_case_Nest_Slice_jags">add_meas_BrS_case_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_Nest_Slice">add_meas_BrS_case_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice_jags">add_meas_BrS_case_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice">add_meas_BrS_case_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_Slice_jags">add_meas_BrS_case_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_Nest_Slice">add_meas_BrS_ctrl_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_Slice">add_meas_BrS_ctrl_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice_jags">add_meas_BrS_param_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice">add_meas_BrS_param_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_reg_Slice_jags">add_meas_BrS_param_Nest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice_jags">add_meas_BrS_param_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice">add_meas_BrS_param_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_Slice_jags">add_meas_BrS_param_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_subclass_Nest_Slice">add_meas_BrS_subclass_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_SS_case">add_meas_SS_case</a>()</code>,
<code><a href="#topic+add_meas_SS_param">add_meas_SS_param</a>()</code>
</p>
<p>Other plug-and-play functions: 
<code><a href="#topic+add_meas_BrS_case_Nest_Slice_jags">add_meas_BrS_case_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_Nest_Slice">add_meas_BrS_case_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice_jags">add_meas_BrS_case_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice">add_meas_BrS_case_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_Slice_jags">add_meas_BrS_case_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_Nest_Slice">add_meas_BrS_ctrl_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_Slice">add_meas_BrS_ctrl_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice_jags">add_meas_BrS_param_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice">add_meas_BrS_param_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_reg_Slice_jags">add_meas_BrS_param_Nest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice_jags">add_meas_BrS_param_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice">add_meas_BrS_param_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_Slice_jags">add_meas_BrS_param_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_subclass_Nest_Slice">add_meas_BrS_subclass_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_SS_case">add_meas_SS_case</a>()</code>,
<code><a href="#topic+add_meas_SS_param">add_meas_SS_param</a>()</code>
</p>

<hr>
<h2 id='add_meas_BrS_case_NoNest_reg_Slice_jags'>add likelihood component for a BrS measurement slice among cases</h2><span id='topic+add_meas_BrS_case_NoNest_reg_Slice_jags'></span>

<h3>Description</h3>

<p>regression model with no nested subclasses
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_meas_BrS_case_NoNest_reg_Slice_jags(s, Mobs, prior, cause_list, ppd = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add_meas_BrS_case_NoNest_reg_Slice_jags_+3A_s">s</code></td>
<td>
<p>the slice</p>
</td></tr>
<tr><td><code id="add_meas_BrS_case_NoNest_reg_Slice_jags_+3A_mobs">Mobs</code></td>
<td>
<p>See <code>data_nplcm</code> described in <code><a href="#topic+nplcm">nplcm()</a></code></p>
</td></tr>
<tr><td><code id="add_meas_BrS_case_NoNest_reg_Slice_jags_+3A_prior">prior</code></td>
<td>
<p>Prior specifications.</p>
</td></tr>
<tr><td><code id="add_meas_BrS_case_NoNest_reg_Slice_jags_+3A_cause_list">cause_list</code></td>
<td>
<p>the list of causes in <code>data_nplcm</code> described in <code><a href="#topic+nplcm">nplcm()</a></code></p>
</td></tr>
<tr><td><code id="add_meas_BrS_case_NoNest_reg_Slice_jags_+3A_ppd">ppd</code></td>
<td>
<p>Default is NULL; Set to TRUE for enabling posterior predictive checking.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of two elements: the first is <code>plug</code>, the .bug code;
the second is <code>parameters</code> that stores model parameters introduced by this
plugged measurement slice
</p>


<h3>See Also</h3>

<p>Other likelihood specification functions: 
<code><a href="#topic+add_meas_BrS_case_Nest_Slice_jags">add_meas_BrS_case_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_Nest_Slice">add_meas_BrS_case_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice_jags">add_meas_BrS_case_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice">add_meas_BrS_case_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_Nest_Slice">add_meas_BrS_ctrl_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_Slice">add_meas_BrS_ctrl_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice_jags">add_meas_BrS_param_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice">add_meas_BrS_param_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_reg_Slice_jags">add_meas_BrS_param_Nest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice_jags">add_meas_BrS_param_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice">add_meas_BrS_param_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_Slice_jags">add_meas_BrS_param_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_subclass_Nest_Slice">add_meas_BrS_subclass_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_SS_case">add_meas_SS_case</a>()</code>,
<code><a href="#topic+add_meas_SS_param">add_meas_SS_param</a>()</code>
</p>
<p>Other plug-and-play functions: 
<code><a href="#topic+add_meas_BrS_case_Nest_Slice_jags">add_meas_BrS_case_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_Nest_Slice">add_meas_BrS_case_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice_jags">add_meas_BrS_case_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice">add_meas_BrS_case_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_Nest_Slice">add_meas_BrS_ctrl_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_Slice">add_meas_BrS_ctrl_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice_jags">add_meas_BrS_param_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice">add_meas_BrS_param_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_reg_Slice_jags">add_meas_BrS_param_Nest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice_jags">add_meas_BrS_param_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice">add_meas_BrS_param_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_Slice_jags">add_meas_BrS_param_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_subclass_Nest_Slice">add_meas_BrS_subclass_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_SS_case">add_meas_SS_case</a>()</code>,
<code><a href="#topic+add_meas_SS_param">add_meas_SS_param</a>()</code>
</p>

<hr>
<h2 id='add_meas_BrS_case_NoNest_Slice'>add a likelihood component for a BrS measurement slice among cases (conditional independence)</h2><span id='topic+add_meas_BrS_case_NoNest_Slice'></span>

<h3>Description</h3>

<p>add a likelihood component for a BrS measurement slice among cases (conditional independence)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_meas_BrS_case_NoNest_Slice(s, Mobs, cause_list, ppd = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add_meas_BrS_case_NoNest_Slice_+3A_s">s</code></td>
<td>
<p>the slice</p>
</td></tr>
<tr><td><code id="add_meas_BrS_case_NoNest_Slice_+3A_mobs">Mobs</code></td>
<td>
<p>See <code>data_nplcm</code> described in <code><a href="#topic+nplcm">nplcm()</a></code></p>
</td></tr>
<tr><td><code id="add_meas_BrS_case_NoNest_Slice_+3A_cause_list">cause_list</code></td>
<td>
<p>the list of causes in <code>data_nplcm</code> described in <code><a href="#topic+nplcm">nplcm()</a></code></p>
</td></tr>
<tr><td><code id="add_meas_BrS_case_NoNest_Slice_+3A_ppd">ppd</code></td>
<td>
<p>Default is NULL; Set to TRUE for enabling posterior predictive checking.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of two elements: the first is <code>plug</code>, the .bug code;
the second is <code>parameters</code> that stores model parameters introduced by this
plugged measurement slice
</p>


<h3>See Also</h3>

<p>Other likelihood specification functions: 
<code><a href="#topic+add_meas_BrS_case_Nest_Slice_jags">add_meas_BrS_case_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_Nest_Slice">add_meas_BrS_case_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice_jags">add_meas_BrS_case_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_Slice_jags">add_meas_BrS_case_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_Nest_Slice">add_meas_BrS_ctrl_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_Slice">add_meas_BrS_ctrl_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice_jags">add_meas_BrS_param_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice">add_meas_BrS_param_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_reg_Slice_jags">add_meas_BrS_param_Nest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice_jags">add_meas_BrS_param_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice">add_meas_BrS_param_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_Slice_jags">add_meas_BrS_param_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_subclass_Nest_Slice">add_meas_BrS_subclass_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_SS_case">add_meas_SS_case</a>()</code>,
<code><a href="#topic+add_meas_SS_param">add_meas_SS_param</a>()</code>
</p>
<p>Other plug-and-play functions: 
<code><a href="#topic+add_meas_BrS_case_Nest_Slice_jags">add_meas_BrS_case_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_Nest_Slice">add_meas_BrS_case_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice_jags">add_meas_BrS_case_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_Slice_jags">add_meas_BrS_case_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_Nest_Slice">add_meas_BrS_ctrl_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_Slice">add_meas_BrS_ctrl_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice_jags">add_meas_BrS_param_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice">add_meas_BrS_param_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_reg_Slice_jags">add_meas_BrS_param_Nest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice_jags">add_meas_BrS_param_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice">add_meas_BrS_param_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_Slice_jags">add_meas_BrS_param_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_subclass_Nest_Slice">add_meas_BrS_subclass_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_SS_case">add_meas_SS_case</a>()</code>,
<code><a href="#topic+add_meas_SS_param">add_meas_SS_param</a>()</code>
</p>

<hr>
<h2 id='add_meas_BrS_case_NoNest_Slice_jags'>add a likelihood component for a BrS measurement slice among cases (conditional independence)</h2><span id='topic+add_meas_BrS_case_NoNest_Slice_jags'></span>

<h3>Description</h3>

<p>add a likelihood component for a BrS measurement slice among cases (conditional independence)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_meas_BrS_case_NoNest_Slice_jags(s, Mobs, prior, cause_list, ppd = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add_meas_BrS_case_NoNest_Slice_jags_+3A_s">s</code></td>
<td>
<p>the slice</p>
</td></tr>
<tr><td><code id="add_meas_BrS_case_NoNest_Slice_jags_+3A_mobs">Mobs</code></td>
<td>
<p>See <code>data_nplcm</code> described in <code><a href="#topic+nplcm">nplcm()</a></code></p>
</td></tr>
<tr><td><code id="add_meas_BrS_case_NoNest_Slice_jags_+3A_prior">prior</code></td>
<td>
<p>Prior specifications.</p>
</td></tr>
<tr><td><code id="add_meas_BrS_case_NoNest_Slice_jags_+3A_cause_list">cause_list</code></td>
<td>
<p>the list of causes in <code>data_nplcm</code> described in <code><a href="#topic+nplcm">nplcm()</a></code></p>
</td></tr>
<tr><td><code id="add_meas_BrS_case_NoNest_Slice_jags_+3A_ppd">ppd</code></td>
<td>
<p>Default is NULL; Set to TRUE for enabling posterior predictive checking.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of two elements: the first is <code>plug</code>, the .bug code;
the second is <code>parameters</code> that stores model parameters introduced by this
plugged measurement slice
</p>


<h3>See Also</h3>

<p>Other likelihood specification functions: 
<code><a href="#topic+add_meas_BrS_case_Nest_Slice_jags">add_meas_BrS_case_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_Nest_Slice">add_meas_BrS_case_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice">add_meas_BrS_case_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_Slice_jags">add_meas_BrS_case_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_Nest_Slice">add_meas_BrS_ctrl_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_Slice">add_meas_BrS_ctrl_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice_jags">add_meas_BrS_param_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice">add_meas_BrS_param_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_reg_Slice_jags">add_meas_BrS_param_Nest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice_jags">add_meas_BrS_param_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice">add_meas_BrS_param_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_Slice_jags">add_meas_BrS_param_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_subclass_Nest_Slice">add_meas_BrS_subclass_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_SS_case">add_meas_SS_case</a>()</code>,
<code><a href="#topic+add_meas_SS_param">add_meas_SS_param</a>()</code>
</p>
<p>Other plug-and-play functions: 
<code><a href="#topic+add_meas_BrS_case_Nest_Slice_jags">add_meas_BrS_case_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_Nest_Slice">add_meas_BrS_case_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice">add_meas_BrS_case_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_Slice_jags">add_meas_BrS_case_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_Nest_Slice">add_meas_BrS_ctrl_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_Slice">add_meas_BrS_ctrl_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice_jags">add_meas_BrS_param_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice">add_meas_BrS_param_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_reg_Slice_jags">add_meas_BrS_param_Nest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice_jags">add_meas_BrS_param_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice">add_meas_BrS_param_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_Slice_jags">add_meas_BrS_param_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_subclass_Nest_Slice">add_meas_BrS_subclass_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_SS_case">add_meas_SS_case</a>()</code>,
<code><a href="#topic+add_meas_SS_param">add_meas_SS_param</a>()</code>
</p>

<hr>
<h2 id='add_meas_BrS_ctrl_Nest_Slice'>add likelihood for a BrS measurement slice among controls (conditional independence)</h2><span id='topic+add_meas_BrS_ctrl_Nest_Slice'></span>

<h3>Description</h3>

<p>add likelihood for a BrS measurement slice among controls (conditional independence)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_meas_BrS_ctrl_Nest_Slice(s, Mobs, cause_list, ppd = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add_meas_BrS_ctrl_Nest_Slice_+3A_s">s</code></td>
<td>
<p>the slice</p>
</td></tr>
<tr><td><code id="add_meas_BrS_ctrl_Nest_Slice_+3A_mobs">Mobs</code></td>
<td>
<p>See <code>data_nplcm</code> described in <code><a href="#topic+nplcm">nplcm()</a></code></p>
</td></tr>
<tr><td><code id="add_meas_BrS_ctrl_Nest_Slice_+3A_cause_list">cause_list</code></td>
<td>
<p>the list of causes in <code>data_nplcm</code> described in <code><a href="#topic+nplcm">nplcm()</a></code></p>
</td></tr>
<tr><td><code id="add_meas_BrS_ctrl_Nest_Slice_+3A_ppd">ppd</code></td>
<td>
<p>Default is NULL; Set to TRUE for enabling posterior predictive checking.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of two elements: the first is <code>plug</code>, the .bug code; the second is <code>parameters</code>
that stores model parameters introduced by this plugged measurement slice
</p>


<h3>See Also</h3>

<p>Other likelihood specification functions: 
<code><a href="#topic+add_meas_BrS_case_Nest_Slice_jags">add_meas_BrS_case_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_Nest_Slice">add_meas_BrS_case_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice_jags">add_meas_BrS_case_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice">add_meas_BrS_case_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_Slice_jags">add_meas_BrS_case_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_Slice">add_meas_BrS_ctrl_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice_jags">add_meas_BrS_param_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice">add_meas_BrS_param_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_reg_Slice_jags">add_meas_BrS_param_Nest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice_jags">add_meas_BrS_param_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice">add_meas_BrS_param_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_Slice_jags">add_meas_BrS_param_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_subclass_Nest_Slice">add_meas_BrS_subclass_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_SS_case">add_meas_SS_case</a>()</code>,
<code><a href="#topic+add_meas_SS_param">add_meas_SS_param</a>()</code>
</p>
<p>Other plug-and-play functions: 
<code><a href="#topic+add_meas_BrS_case_Nest_Slice_jags">add_meas_BrS_case_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_Nest_Slice">add_meas_BrS_case_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice_jags">add_meas_BrS_case_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice">add_meas_BrS_case_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_Slice_jags">add_meas_BrS_case_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_Slice">add_meas_BrS_ctrl_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice_jags">add_meas_BrS_param_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice">add_meas_BrS_param_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_reg_Slice_jags">add_meas_BrS_param_Nest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice_jags">add_meas_BrS_param_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice">add_meas_BrS_param_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_Slice_jags">add_meas_BrS_param_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_subclass_Nest_Slice">add_meas_BrS_subclass_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_SS_case">add_meas_SS_case</a>()</code>,
<code><a href="#topic+add_meas_SS_param">add_meas_SS_param</a>()</code>
</p>

<hr>
<h2 id='add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags'>add a likelihood component for a BrS measurement slice among controls</h2><span id='topic+add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags'></span>

<h3>Description</h3>

<p>regression model without nested subclasses; discrete
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags(
  s,
  Mobs,
  cause_list,
  ppd = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags_+3A_s">s</code></td>
<td>
<p>the slice</p>
</td></tr>
<tr><td><code id="add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags_+3A_mobs">Mobs</code></td>
<td>
<p>See <code>data_nplcm</code> described in <code><a href="#topic+nplcm">nplcm()</a></code></p>
</td></tr>
<tr><td><code id="add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags_+3A_cause_list">cause_list</code></td>
<td>
<p>the list of causes in <code>data_nplcm</code> described in <code><a href="#topic+nplcm">nplcm()</a></code></p>
</td></tr>
<tr><td><code id="add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags_+3A_ppd">ppd</code></td>
<td>
<p>Default is NULL; Set to TRUE for enabling posterior predictive checking.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of two elements: the first is <code>plug</code>, the .bug code; the second is <code>parameters</code>
that stores model parameters introduced by this plugged measurement slice
</p>


<h3>See Also</h3>

<p>Other likelihood specification functions: 
<code><a href="#topic+add_meas_BrS_case_Nest_Slice_jags">add_meas_BrS_case_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_Nest_Slice">add_meas_BrS_case_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice_jags">add_meas_BrS_case_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice">add_meas_BrS_case_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_Slice_jags">add_meas_BrS_case_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_Nest_Slice">add_meas_BrS_ctrl_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_Slice">add_meas_BrS_ctrl_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice_jags">add_meas_BrS_param_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice">add_meas_BrS_param_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_reg_Slice_jags">add_meas_BrS_param_Nest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice_jags">add_meas_BrS_param_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice">add_meas_BrS_param_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_Slice_jags">add_meas_BrS_param_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_subclass_Nest_Slice">add_meas_BrS_subclass_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_SS_case">add_meas_SS_case</a>()</code>,
<code><a href="#topic+add_meas_SS_param">add_meas_SS_param</a>()</code>
</p>
<p>Other plug-and-play functions: 
<code><a href="#topic+add_meas_BrS_case_Nest_Slice_jags">add_meas_BrS_case_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_Nest_Slice">add_meas_BrS_case_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice_jags">add_meas_BrS_case_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice">add_meas_BrS_case_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_Slice_jags">add_meas_BrS_case_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_Nest_Slice">add_meas_BrS_ctrl_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_Slice">add_meas_BrS_ctrl_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice_jags">add_meas_BrS_param_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice">add_meas_BrS_param_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_reg_Slice_jags">add_meas_BrS_param_Nest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice_jags">add_meas_BrS_param_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice">add_meas_BrS_param_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_Slice_jags">add_meas_BrS_param_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_subclass_Nest_Slice">add_meas_BrS_subclass_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_SS_case">add_meas_SS_case</a>()</code>,
<code><a href="#topic+add_meas_SS_param">add_meas_SS_param</a>()</code>
</p>

<hr>
<h2 id='add_meas_BrS_ctrl_NoNest_reg_Slice_jags'>add a likelihood component for a BrS measurement slice among controls</h2><span id='topic+add_meas_BrS_ctrl_NoNest_reg_Slice_jags'></span>

<h3>Description</h3>

<p>regression model without nested subclasses
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_meas_BrS_ctrl_NoNest_reg_Slice_jags(s, Mobs, cause_list, ppd = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add_meas_BrS_ctrl_NoNest_reg_Slice_jags_+3A_s">s</code></td>
<td>
<p>the slice</p>
</td></tr>
<tr><td><code id="add_meas_BrS_ctrl_NoNest_reg_Slice_jags_+3A_mobs">Mobs</code></td>
<td>
<p>See <code>data_nplcm</code> described in <code><a href="#topic+nplcm">nplcm()</a></code></p>
</td></tr>
<tr><td><code id="add_meas_BrS_ctrl_NoNest_reg_Slice_jags_+3A_cause_list">cause_list</code></td>
<td>
<p>the list of causes in <code>data_nplcm</code> described in <code><a href="#topic+nplcm">nplcm()</a></code></p>
</td></tr>
<tr><td><code id="add_meas_BrS_ctrl_NoNest_reg_Slice_jags_+3A_ppd">ppd</code></td>
<td>
<p>Default is NULL; Set to TRUE for enabling posterior predictive checking.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of two elements: the first is <code>plug</code>, the .bug code; the second is <code>parameters</code>
that stores model parameters introduced by this plugged measurement slice
</p>


<h3>See Also</h3>

<p>Other likelihood specification functions: 
<code><a href="#topic+add_meas_BrS_case_Nest_Slice_jags">add_meas_BrS_case_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_Nest_Slice">add_meas_BrS_case_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice_jags">add_meas_BrS_case_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice">add_meas_BrS_case_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_Slice_jags">add_meas_BrS_case_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_Nest_Slice">add_meas_BrS_ctrl_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_Slice">add_meas_BrS_ctrl_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice_jags">add_meas_BrS_param_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice">add_meas_BrS_param_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_reg_Slice_jags">add_meas_BrS_param_Nest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice_jags">add_meas_BrS_param_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice">add_meas_BrS_param_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_Slice_jags">add_meas_BrS_param_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_subclass_Nest_Slice">add_meas_BrS_subclass_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_SS_case">add_meas_SS_case</a>()</code>,
<code><a href="#topic+add_meas_SS_param">add_meas_SS_param</a>()</code>
</p>
<p>Other plug-and-play functions: 
<code><a href="#topic+add_meas_BrS_case_Nest_Slice_jags">add_meas_BrS_case_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_Nest_Slice">add_meas_BrS_case_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice_jags">add_meas_BrS_case_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice">add_meas_BrS_case_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_Slice_jags">add_meas_BrS_case_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_Nest_Slice">add_meas_BrS_ctrl_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_Slice">add_meas_BrS_ctrl_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice_jags">add_meas_BrS_param_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice">add_meas_BrS_param_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_reg_Slice_jags">add_meas_BrS_param_Nest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice_jags">add_meas_BrS_param_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice">add_meas_BrS_param_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_Slice_jags">add_meas_BrS_param_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_subclass_Nest_Slice">add_meas_BrS_subclass_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_SS_case">add_meas_SS_case</a>()</code>,
<code><a href="#topic+add_meas_SS_param">add_meas_SS_param</a>()</code>
</p>

<hr>
<h2 id='add_meas_BrS_ctrl_NoNest_Slice'>add a likelihood component for a BrS measurement slice among controls (conditional independence)</h2><span id='topic+add_meas_BrS_ctrl_NoNest_Slice'></span>

<h3>Description</h3>

<p>add a likelihood component for a BrS measurement slice among controls (conditional independence)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_meas_BrS_ctrl_NoNest_Slice(s, Mobs, cause_list, ppd = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add_meas_BrS_ctrl_NoNest_Slice_+3A_s">s</code></td>
<td>
<p>the slice</p>
</td></tr>
<tr><td><code id="add_meas_BrS_ctrl_NoNest_Slice_+3A_mobs">Mobs</code></td>
<td>
<p>See <code>data_nplcm</code> described in <code><a href="#topic+nplcm">nplcm()</a></code></p>
</td></tr>
<tr><td><code id="add_meas_BrS_ctrl_NoNest_Slice_+3A_cause_list">cause_list</code></td>
<td>
<p>the list of causes in <code>data_nplcm</code> described in <code><a href="#topic+nplcm">nplcm()</a></code></p>
</td></tr>
<tr><td><code id="add_meas_BrS_ctrl_NoNest_Slice_+3A_ppd">ppd</code></td>
<td>
<p>Default is NULL; Set to TRUE for enabling posterior predictive checking.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of two elements: the first is <code>plug</code>, the .bug code; the second is <code>parameters</code>
that stores model parameters introduced by this plugged measurement slice
</p>


<h3>See Also</h3>

<p>Other likelihood specification functions: 
<code><a href="#topic+add_meas_BrS_case_Nest_Slice_jags">add_meas_BrS_case_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_Nest_Slice">add_meas_BrS_case_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice_jags">add_meas_BrS_case_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice">add_meas_BrS_case_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_Slice_jags">add_meas_BrS_case_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_Nest_Slice">add_meas_BrS_ctrl_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice_jags">add_meas_BrS_param_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice">add_meas_BrS_param_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_reg_Slice_jags">add_meas_BrS_param_Nest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice_jags">add_meas_BrS_param_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice">add_meas_BrS_param_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_Slice_jags">add_meas_BrS_param_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_subclass_Nest_Slice">add_meas_BrS_subclass_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_SS_case">add_meas_SS_case</a>()</code>,
<code><a href="#topic+add_meas_SS_param">add_meas_SS_param</a>()</code>
</p>
<p>Other plug-and-play functions: 
<code><a href="#topic+add_meas_BrS_case_Nest_Slice_jags">add_meas_BrS_case_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_Nest_Slice">add_meas_BrS_case_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice_jags">add_meas_BrS_case_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice">add_meas_BrS_case_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_Slice_jags">add_meas_BrS_case_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_Nest_Slice">add_meas_BrS_ctrl_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice_jags">add_meas_BrS_param_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice">add_meas_BrS_param_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_reg_Slice_jags">add_meas_BrS_param_Nest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice_jags">add_meas_BrS_param_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice">add_meas_BrS_param_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_Slice_jags">add_meas_BrS_param_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_subclass_Nest_Slice">add_meas_BrS_subclass_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_SS_case">add_meas_SS_case</a>()</code>,
<code><a href="#topic+add_meas_SS_param">add_meas_SS_param</a>()</code>
</p>

<hr>
<h2 id='add_meas_BrS_param_Nest_reg_Slice_jags'>add parameters for a BrS measurement slice among cases and controls</h2><span id='topic+add_meas_BrS_param_Nest_reg_Slice_jags'></span>

<h3>Description</h3>

<p>regression model with nested subclasses; called by <a href="#topic+insert_bugfile_chunk_reg_nest_meas">insert_bugfile_chunk_reg_nest_meas</a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_meas_BrS_param_Nest_reg_Slice_jags(
  s,
  Mobs,
  prior,
  cause_list,
  FPR_formula = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add_meas_BrS_param_Nest_reg_Slice_jags_+3A_s">s</code></td>
<td>
<p>the slice</p>
</td></tr>
<tr><td><code id="add_meas_BrS_param_Nest_reg_Slice_jags_+3A_mobs">Mobs</code></td>
<td>
<p>See <code>data_nplcm</code> described in <code><a href="#topic+nplcm">nplcm()</a></code></p>
</td></tr>
<tr><td><code id="add_meas_BrS_param_Nest_reg_Slice_jags_+3A_prior">prior</code></td>
<td>
<p>Prior specifications.</p>
</td></tr>
<tr><td><code id="add_meas_BrS_param_Nest_reg_Slice_jags_+3A_cause_list">cause_list</code></td>
<td>
<p>the list of causes in <code>data_nplcm</code> described in <code><a href="#topic+nplcm">nplcm()</a></code></p>
</td></tr>
<tr><td><code id="add_meas_BrS_param_Nest_reg_Slice_jags_+3A_fpr_formula">FPR_formula</code></td>
<td>
<p>False positive regression formula for slice s of BrS data.
Check <code>model_options$likelihood$FPR_formula[[s]]</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of two elements: the first is <code>plug</code>, the .bug code;
the second is <code>parameters</code> that stores model parameters introduced by
this plugged measurement slice
</p>


<h3>See Also</h3>

<p>Other likelihood specification functions: 
<code><a href="#topic+add_meas_BrS_case_Nest_Slice_jags">add_meas_BrS_case_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_Nest_Slice">add_meas_BrS_case_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice_jags">add_meas_BrS_case_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice">add_meas_BrS_case_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_Slice_jags">add_meas_BrS_case_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_Nest_Slice">add_meas_BrS_ctrl_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_Slice">add_meas_BrS_ctrl_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice_jags">add_meas_BrS_param_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice">add_meas_BrS_param_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice_jags">add_meas_BrS_param_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice">add_meas_BrS_param_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_Slice_jags">add_meas_BrS_param_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_subclass_Nest_Slice">add_meas_BrS_subclass_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_SS_case">add_meas_SS_case</a>()</code>,
<code><a href="#topic+add_meas_SS_param">add_meas_SS_param</a>()</code>
</p>
<p>Other plug-and-play functions: 
<code><a href="#topic+add_meas_BrS_case_Nest_Slice_jags">add_meas_BrS_case_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_Nest_Slice">add_meas_BrS_case_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice_jags">add_meas_BrS_case_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice">add_meas_BrS_case_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_Slice_jags">add_meas_BrS_case_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_Nest_Slice">add_meas_BrS_ctrl_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_Slice">add_meas_BrS_ctrl_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice_jags">add_meas_BrS_param_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice">add_meas_BrS_param_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice_jags">add_meas_BrS_param_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice">add_meas_BrS_param_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_Slice_jags">add_meas_BrS_param_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_subclass_Nest_Slice">add_meas_BrS_subclass_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_SS_case">add_meas_SS_case</a>()</code>,
<code><a href="#topic+add_meas_SS_param">add_meas_SS_param</a>()</code>
</p>

<hr>
<h2 id='add_meas_BrS_param_Nest_Slice'>add parameters for a BrS measurement slice among cases and controls (conditional dependence)</h2><span id='topic+add_meas_BrS_param_Nest_Slice'></span>

<h3>Description</h3>

<p>add parameters for a BrS measurement slice among cases and controls (conditional dependence)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_meas_BrS_param_Nest_Slice(s, Mobs, cause_list)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add_meas_BrS_param_Nest_Slice_+3A_s">s</code></td>
<td>
<p>the slice</p>
</td></tr>
<tr><td><code id="add_meas_BrS_param_Nest_Slice_+3A_mobs">Mobs</code></td>
<td>
<p>See <code>data_nplcm</code> described in <code><a href="#topic+nplcm">nplcm()</a></code></p>
</td></tr>
<tr><td><code id="add_meas_BrS_param_Nest_Slice_+3A_cause_list">cause_list</code></td>
<td>
<p>the list of causes in <code>data_nplcm</code> described in <code><a href="#topic+nplcm">nplcm()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of two elements: the first is <code>plug</code>, the .bug code; the second is <code>parameters</code>
that stores model parameters introduced by this plugged measurement slice
</p>


<h3>See Also</h3>

<p>Other likelihood specification functions: 
<code><a href="#topic+add_meas_BrS_case_Nest_Slice_jags">add_meas_BrS_case_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_Nest_Slice">add_meas_BrS_case_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice_jags">add_meas_BrS_case_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice">add_meas_BrS_case_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_Slice_jags">add_meas_BrS_case_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_Nest_Slice">add_meas_BrS_ctrl_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_Slice">add_meas_BrS_ctrl_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice_jags">add_meas_BrS_param_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_reg_Slice_jags">add_meas_BrS_param_Nest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice_jags">add_meas_BrS_param_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice">add_meas_BrS_param_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_Slice_jags">add_meas_BrS_param_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_subclass_Nest_Slice">add_meas_BrS_subclass_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_SS_case">add_meas_SS_case</a>()</code>,
<code><a href="#topic+add_meas_SS_param">add_meas_SS_param</a>()</code>
</p>
<p>Other plug-and-play functions: 
<code><a href="#topic+add_meas_BrS_case_Nest_Slice_jags">add_meas_BrS_case_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_Nest_Slice">add_meas_BrS_case_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice_jags">add_meas_BrS_case_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice">add_meas_BrS_case_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_Slice_jags">add_meas_BrS_case_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_Nest_Slice">add_meas_BrS_ctrl_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_Slice">add_meas_BrS_ctrl_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice_jags">add_meas_BrS_param_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_reg_Slice_jags">add_meas_BrS_param_Nest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice_jags">add_meas_BrS_param_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice">add_meas_BrS_param_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_Slice_jags">add_meas_BrS_param_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_subclass_Nest_Slice">add_meas_BrS_subclass_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_SS_case">add_meas_SS_case</a>()</code>,
<code><a href="#topic+add_meas_SS_param">add_meas_SS_param</a>()</code>
</p>

<hr>
<h2 id='add_meas_BrS_param_Nest_Slice_jags'>add parameters for a BrS measurement slice among cases and controls (conditional dependence)</h2><span id='topic+add_meas_BrS_param_Nest_Slice_jags'></span>

<h3>Description</h3>

<p>add parameters for a BrS measurement slice among cases and controls (conditional dependence)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_meas_BrS_param_Nest_Slice_jags(s, Mobs, cause_list)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add_meas_BrS_param_Nest_Slice_jags_+3A_s">s</code></td>
<td>
<p>the slice</p>
</td></tr>
<tr><td><code id="add_meas_BrS_param_Nest_Slice_jags_+3A_mobs">Mobs</code></td>
<td>
<p>See <code>data_nplcm</code> described in <code><a href="#topic+nplcm">nplcm()</a></code></p>
</td></tr>
<tr><td><code id="add_meas_BrS_param_Nest_Slice_jags_+3A_cause_list">cause_list</code></td>
<td>
<p>the list of causes in <code>data_nplcm</code> described in <code><a href="#topic+nplcm">nplcm()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of two elements: the first is <code>plug</code>, the .bug code; the second is <code>parameters</code>
that stores model parameters introduced by this plugged measurement slice
</p>


<h3>See Also</h3>

<p>Other likelihood specification functions: 
<code><a href="#topic+add_meas_BrS_case_Nest_Slice_jags">add_meas_BrS_case_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_Nest_Slice">add_meas_BrS_case_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice_jags">add_meas_BrS_case_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice">add_meas_BrS_case_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_Slice_jags">add_meas_BrS_case_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_Nest_Slice">add_meas_BrS_ctrl_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_Slice">add_meas_BrS_ctrl_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice">add_meas_BrS_param_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_reg_Slice_jags">add_meas_BrS_param_Nest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice_jags">add_meas_BrS_param_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice">add_meas_BrS_param_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_Slice_jags">add_meas_BrS_param_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_subclass_Nest_Slice">add_meas_BrS_subclass_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_SS_case">add_meas_SS_case</a>()</code>,
<code><a href="#topic+add_meas_SS_param">add_meas_SS_param</a>()</code>
</p>
<p>Other plug-and-play functions: 
<code><a href="#topic+add_meas_BrS_case_Nest_Slice_jags">add_meas_BrS_case_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_Nest_Slice">add_meas_BrS_case_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice_jags">add_meas_BrS_case_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice">add_meas_BrS_case_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_Slice_jags">add_meas_BrS_case_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_Nest_Slice">add_meas_BrS_ctrl_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_Slice">add_meas_BrS_ctrl_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice">add_meas_BrS_param_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_reg_Slice_jags">add_meas_BrS_param_Nest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice_jags">add_meas_BrS_param_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice">add_meas_BrS_param_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_Slice_jags">add_meas_BrS_param_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_subclass_Nest_Slice">add_meas_BrS_subclass_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_SS_case">add_meas_SS_case</a>()</code>,
<code><a href="#topic+add_meas_SS_param">add_meas_SS_param</a>()</code>
</p>

<hr>
<h2 id='add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags'>add parameters for a BrS measurement slice among cases and controls</h2><span id='topic+add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags'></span>

<h3>Description</h3>

<p>regression model with no nested subclasses; discrete
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags(
  s,
  Mobs,
  prior,
  cause_list
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags_+3A_s">s</code></td>
<td>
<p>the slice</p>
</td></tr>
<tr><td><code id="add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags_+3A_mobs">Mobs</code></td>
<td>
<p>See <code>data_nplcm</code> described in <code><a href="#topic+nplcm">nplcm()</a></code></p>
</td></tr>
<tr><td><code id="add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags_+3A_prior">prior</code></td>
<td>
<p>Prior specifications.</p>
</td></tr>
<tr><td><code id="add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags_+3A_cause_list">cause_list</code></td>
<td>
<p>the list of causes in <code>data_nplcm</code> described in <code><a href="#topic+nplcm">nplcm()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of two elements: the first is <code>plug</code>, the .bug code; the second is <code>parameters</code>
that stores model parameters introduced by this plugged measurement slice
</p>


<h3>See Also</h3>

<p>Other likelihood specification functions: 
<code><a href="#topic+add_meas_BrS_case_Nest_Slice_jags">add_meas_BrS_case_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_Nest_Slice">add_meas_BrS_case_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice_jags">add_meas_BrS_case_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice">add_meas_BrS_case_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_Slice_jags">add_meas_BrS_case_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_Nest_Slice">add_meas_BrS_ctrl_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_Slice">add_meas_BrS_ctrl_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice_jags">add_meas_BrS_param_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice">add_meas_BrS_param_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_reg_Slice_jags">add_meas_BrS_param_Nest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice_jags">add_meas_BrS_param_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice">add_meas_BrS_param_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_Slice_jags">add_meas_BrS_param_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_subclass_Nest_Slice">add_meas_BrS_subclass_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_SS_case">add_meas_SS_case</a>()</code>,
<code><a href="#topic+add_meas_SS_param">add_meas_SS_param</a>()</code>
</p>
<p>Other plug-and-play functions: 
<code><a href="#topic+add_meas_BrS_case_Nest_Slice_jags">add_meas_BrS_case_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_Nest_Slice">add_meas_BrS_case_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice_jags">add_meas_BrS_case_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice">add_meas_BrS_case_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_Slice_jags">add_meas_BrS_case_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_Nest_Slice">add_meas_BrS_ctrl_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_Slice">add_meas_BrS_ctrl_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice_jags">add_meas_BrS_param_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice">add_meas_BrS_param_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_reg_Slice_jags">add_meas_BrS_param_Nest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice_jags">add_meas_BrS_param_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice">add_meas_BrS_param_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_Slice_jags">add_meas_BrS_param_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_subclass_Nest_Slice">add_meas_BrS_subclass_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_SS_case">add_meas_SS_case</a>()</code>,
<code><a href="#topic+add_meas_SS_param">add_meas_SS_param</a>()</code>
</p>

<hr>
<h2 id='add_meas_BrS_param_NoNest_reg_Slice_jags'>add parameters for a BrS measurement slice among cases and controls</h2><span id='topic+add_meas_BrS_param_NoNest_reg_Slice_jags'></span>

<h3>Description</h3>

<p>regression model with no nested subclasses
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_meas_BrS_param_NoNest_reg_Slice_jags(
  s,
  Mobs,
  prior,
  cause_list,
  FPR_formula
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add_meas_BrS_param_NoNest_reg_Slice_jags_+3A_s">s</code></td>
<td>
<p>the slice</p>
</td></tr>
<tr><td><code id="add_meas_BrS_param_NoNest_reg_Slice_jags_+3A_mobs">Mobs</code></td>
<td>
<p>See <code>data_nplcm</code> described in <code><a href="#topic+nplcm">nplcm()</a></code></p>
</td></tr>
<tr><td><code id="add_meas_BrS_param_NoNest_reg_Slice_jags_+3A_prior">prior</code></td>
<td>
<p>Prior specifications.</p>
</td></tr>
<tr><td><code id="add_meas_BrS_param_NoNest_reg_Slice_jags_+3A_cause_list">cause_list</code></td>
<td>
<p>the list of causes in <code>data_nplcm</code> described in <code><a href="#topic+nplcm">nplcm()</a></code></p>
</td></tr>
<tr><td><code id="add_meas_BrS_param_NoNest_reg_Slice_jags_+3A_fpr_formula">FPR_formula</code></td>
<td>
<p>False positive regression formula for slice s of BrS data.
Check <code>model_options$likelihood$FPR_formula[[s]]</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of two elements: the first is <code>plug</code>, the .bug code; the second is <code>parameters</code>
that stores model parameters introduced by this plugged measurement slice
</p>


<h3>See Also</h3>

<p>Other likelihood specification functions: 
<code><a href="#topic+add_meas_BrS_case_Nest_Slice_jags">add_meas_BrS_case_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_Nest_Slice">add_meas_BrS_case_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice_jags">add_meas_BrS_case_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice">add_meas_BrS_case_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_Slice_jags">add_meas_BrS_case_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_Nest_Slice">add_meas_BrS_ctrl_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_Slice">add_meas_BrS_ctrl_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice_jags">add_meas_BrS_param_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice">add_meas_BrS_param_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_reg_Slice_jags">add_meas_BrS_param_Nest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice_jags">add_meas_BrS_param_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice">add_meas_BrS_param_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_subclass_Nest_Slice">add_meas_BrS_subclass_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_SS_case">add_meas_SS_case</a>()</code>,
<code><a href="#topic+add_meas_SS_param">add_meas_SS_param</a>()</code>
</p>
<p>Other plug-and-play functions: 
<code><a href="#topic+add_meas_BrS_case_Nest_Slice_jags">add_meas_BrS_case_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_Nest_Slice">add_meas_BrS_case_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice_jags">add_meas_BrS_case_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice">add_meas_BrS_case_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_Slice_jags">add_meas_BrS_case_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_Nest_Slice">add_meas_BrS_ctrl_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_Slice">add_meas_BrS_ctrl_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice_jags">add_meas_BrS_param_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice">add_meas_BrS_param_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_reg_Slice_jags">add_meas_BrS_param_Nest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice_jags">add_meas_BrS_param_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice">add_meas_BrS_param_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_subclass_Nest_Slice">add_meas_BrS_subclass_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_SS_case">add_meas_SS_case</a>()</code>,
<code><a href="#topic+add_meas_SS_param">add_meas_SS_param</a>()</code>
</p>

<hr>
<h2 id='add_meas_BrS_param_NoNest_Slice'>add parameters for a BrS measurement slice among cases and controls (conditional independence)</h2><span id='topic+add_meas_BrS_param_NoNest_Slice'></span>

<h3>Description</h3>

<p>add parameters for a BrS measurement slice among cases and controls (conditional independence)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_meas_BrS_param_NoNest_Slice(s, Mobs, cause_list)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add_meas_BrS_param_NoNest_Slice_+3A_s">s</code></td>
<td>
<p>the slice</p>
</td></tr>
<tr><td><code id="add_meas_BrS_param_NoNest_Slice_+3A_mobs">Mobs</code></td>
<td>
<p>See <code>data_nplcm</code> described in <code><a href="#topic+nplcm">nplcm()</a></code></p>
</td></tr>
<tr><td><code id="add_meas_BrS_param_NoNest_Slice_+3A_cause_list">cause_list</code></td>
<td>
<p>the list of causes in <code>data_nplcm</code> described in <code><a href="#topic+nplcm">nplcm()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of two elements: the first is <code>plug</code>, the .bug code; the second is <code>parameters</code>
that stores model parameters introduced by this plugged measurement slice
</p>


<h3>See Also</h3>

<p>Other likelihood specification functions: 
<code><a href="#topic+add_meas_BrS_case_Nest_Slice_jags">add_meas_BrS_case_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_Nest_Slice">add_meas_BrS_case_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice_jags">add_meas_BrS_case_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice">add_meas_BrS_case_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_Slice_jags">add_meas_BrS_case_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_Nest_Slice">add_meas_BrS_ctrl_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_Slice">add_meas_BrS_ctrl_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice_jags">add_meas_BrS_param_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice">add_meas_BrS_param_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_reg_Slice_jags">add_meas_BrS_param_Nest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice_jags">add_meas_BrS_param_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_Slice_jags">add_meas_BrS_param_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_subclass_Nest_Slice">add_meas_BrS_subclass_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_SS_case">add_meas_SS_case</a>()</code>,
<code><a href="#topic+add_meas_SS_param">add_meas_SS_param</a>()</code>
</p>
<p>Other plug-and-play functions: 
<code><a href="#topic+add_meas_BrS_case_Nest_Slice_jags">add_meas_BrS_case_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_Nest_Slice">add_meas_BrS_case_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice_jags">add_meas_BrS_case_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice">add_meas_BrS_case_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_Slice_jags">add_meas_BrS_case_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_Nest_Slice">add_meas_BrS_ctrl_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_Slice">add_meas_BrS_ctrl_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice_jags">add_meas_BrS_param_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice">add_meas_BrS_param_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_reg_Slice_jags">add_meas_BrS_param_Nest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice_jags">add_meas_BrS_param_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_Slice_jags">add_meas_BrS_param_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_subclass_Nest_Slice">add_meas_BrS_subclass_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_SS_case">add_meas_SS_case</a>()</code>,
<code><a href="#topic+add_meas_SS_param">add_meas_SS_param</a>()</code>
</p>

<hr>
<h2 id='add_meas_BrS_param_NoNest_Slice_jags'>add parameters for a BrS measurement slice among cases and controls (conditional independence)</h2><span id='topic+add_meas_BrS_param_NoNest_Slice_jags'></span>

<h3>Description</h3>

<p>add parameters for a BrS measurement slice among cases and controls (conditional independence)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_meas_BrS_param_NoNest_Slice_jags(s, Mobs, prior, cause_list)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add_meas_BrS_param_NoNest_Slice_jags_+3A_s">s</code></td>
<td>
<p>the slice</p>
</td></tr>
<tr><td><code id="add_meas_BrS_param_NoNest_Slice_jags_+3A_mobs">Mobs</code></td>
<td>
<p>See <code>data_nplcm</code> described in <code><a href="#topic+nplcm">nplcm()</a></code></p>
</td></tr>
<tr><td><code id="add_meas_BrS_param_NoNest_Slice_jags_+3A_prior">prior</code></td>
<td>
<p>Prior specifications.</p>
</td></tr>
<tr><td><code id="add_meas_BrS_param_NoNest_Slice_jags_+3A_cause_list">cause_list</code></td>
<td>
<p>the list of causes in <code>data_nplcm</code> described in <code><a href="#topic+nplcm">nplcm()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of two elements: the first is <code>plug</code>, the .bug code; the second is <code>parameters</code>
that stores model parameters introduced by this plugged measurement slice
</p>


<h3>See Also</h3>

<p>Other likelihood specification functions: 
<code><a href="#topic+add_meas_BrS_case_Nest_Slice_jags">add_meas_BrS_case_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_Nest_Slice">add_meas_BrS_case_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice_jags">add_meas_BrS_case_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice">add_meas_BrS_case_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_Slice_jags">add_meas_BrS_case_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_Nest_Slice">add_meas_BrS_ctrl_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_Slice">add_meas_BrS_ctrl_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice_jags">add_meas_BrS_param_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice">add_meas_BrS_param_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_reg_Slice_jags">add_meas_BrS_param_Nest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice">add_meas_BrS_param_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_Slice_jags">add_meas_BrS_param_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_subclass_Nest_Slice">add_meas_BrS_subclass_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_SS_case">add_meas_SS_case</a>()</code>,
<code><a href="#topic+add_meas_SS_param">add_meas_SS_param</a>()</code>
</p>
<p>Other plug-and-play functions: 
<code><a href="#topic+add_meas_BrS_case_Nest_Slice_jags">add_meas_BrS_case_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_Nest_Slice">add_meas_BrS_case_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice_jags">add_meas_BrS_case_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice">add_meas_BrS_case_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_Slice_jags">add_meas_BrS_case_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_Nest_Slice">add_meas_BrS_ctrl_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_Slice">add_meas_BrS_ctrl_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice_jags">add_meas_BrS_param_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice">add_meas_BrS_param_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_reg_Slice_jags">add_meas_BrS_param_Nest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice">add_meas_BrS_param_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_Slice_jags">add_meas_BrS_param_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_subclass_Nest_Slice">add_meas_BrS_subclass_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_SS_case">add_meas_SS_case</a>()</code>,
<code><a href="#topic+add_meas_SS_param">add_meas_SS_param</a>()</code>
</p>

<hr>
<h2 id='add_meas_BrS_subclass_Nest_Slice'>add subclass indicators for a BrS measurement slice among cases and controls (conditional independence)</h2><span id='topic+add_meas_BrS_subclass_Nest_Slice'></span>

<h3>Description</h3>

<p>add subclass indicators for a BrS measurement slice among cases and controls (conditional independence)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_meas_BrS_subclass_Nest_Slice(s, Mobs, cause_list, ppd = NULL, reg = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add_meas_BrS_subclass_Nest_Slice_+3A_s">s</code></td>
<td>
<p>the slice</p>
</td></tr>
<tr><td><code id="add_meas_BrS_subclass_Nest_Slice_+3A_mobs">Mobs</code></td>
<td>
<p>See <code>data_nplcm</code> described in <code><a href="#topic+nplcm">nplcm()</a></code></p>
</td></tr>
<tr><td><code id="add_meas_BrS_subclass_Nest_Slice_+3A_cause_list">cause_list</code></td>
<td>
<p>the list of causes in <code>data_nplcm</code> described in <code><a href="#topic+nplcm">nplcm()</a></code></p>
</td></tr>
<tr><td><code id="add_meas_BrS_subclass_Nest_Slice_+3A_ppd">ppd</code></td>
<td>
<p>Default is NULL; Set to TRUE for enabling posterior predictive checking.</p>
</td></tr>
<tr><td><code id="add_meas_BrS_subclass_Nest_Slice_+3A_reg">reg</code></td>
<td>
<p>Default is NULL; set to TRUE if doing regression (double index of subclass weights: subject and subclass)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of two elements: the first is <code>plug</code>, the .bug code; the second is <code>parameters</code>
that stores model parameters introduced by this plugged measurement slice
</p>


<h3>See Also</h3>

<p>Other likelihood specification functions: 
<code><a href="#topic+add_meas_BrS_case_Nest_Slice_jags">add_meas_BrS_case_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_Nest_Slice">add_meas_BrS_case_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice_jags">add_meas_BrS_case_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice">add_meas_BrS_case_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_Slice_jags">add_meas_BrS_case_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_Nest_Slice">add_meas_BrS_ctrl_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_Slice">add_meas_BrS_ctrl_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice_jags">add_meas_BrS_param_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice">add_meas_BrS_param_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_reg_Slice_jags">add_meas_BrS_param_Nest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice_jags">add_meas_BrS_param_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice">add_meas_BrS_param_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_Slice_jags">add_meas_BrS_param_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_SS_case">add_meas_SS_case</a>()</code>,
<code><a href="#topic+add_meas_SS_param">add_meas_SS_param</a>()</code>
</p>
<p>Other plug-and-play functions: 
<code><a href="#topic+add_meas_BrS_case_Nest_Slice_jags">add_meas_BrS_case_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_Nest_Slice">add_meas_BrS_case_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice_jags">add_meas_BrS_case_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice">add_meas_BrS_case_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_Slice_jags">add_meas_BrS_case_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_Nest_Slice">add_meas_BrS_ctrl_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_Slice">add_meas_BrS_ctrl_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice_jags">add_meas_BrS_param_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice">add_meas_BrS_param_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_reg_Slice_jags">add_meas_BrS_param_Nest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice_jags">add_meas_BrS_param_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice">add_meas_BrS_param_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_Slice_jags">add_meas_BrS_param_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_SS_case">add_meas_SS_case</a>()</code>,
<code><a href="#topic+add_meas_SS_param">add_meas_SS_param</a>()</code>
</p>

<hr>
<h2 id='add_meas_SS_case'>add likelihood for a SS measurement slice among cases (conditional independence)</h2><span id='topic+add_meas_SS_case'></span>

<h3>Description</h3>

<p>add likelihood for a SS measurement slice among cases (conditional independence)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_meas_SS_case(nslice, Mobs, prior, cause_list)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add_meas_SS_case_+3A_nslice">nslice</code></td>
<td>
<p>the total number of SS measurement slices</p>
</td></tr>
<tr><td><code id="add_meas_SS_case_+3A_mobs">Mobs</code></td>
<td>
<p>see <code>data_nplcm</code> described in <code><a href="#topic+nplcm">nplcm()</a></code></p>
</td></tr>
<tr><td><code id="add_meas_SS_case_+3A_prior">prior</code></td>
<td>
<p>see <code>model_options</code> described in <code><a href="#topic+nplcm">nplcm()</a></code></p>
</td></tr>
<tr><td><code id="add_meas_SS_case_+3A_cause_list">cause_list</code></td>
<td>
<p>the list of causes in <code>model_options</code> described in <code><a href="#topic+nplcm">nplcm()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of two elements: the first is <code>plug</code>, the .bug code; the second is <code>parameters</code>
that stores model parameters introduced by this plugged measurement slice
</p>


<h3>See Also</h3>

<p>Other likelihood specification functions: 
<code><a href="#topic+add_meas_BrS_case_Nest_Slice_jags">add_meas_BrS_case_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_Nest_Slice">add_meas_BrS_case_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice_jags">add_meas_BrS_case_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice">add_meas_BrS_case_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_Slice_jags">add_meas_BrS_case_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_Nest_Slice">add_meas_BrS_ctrl_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_Slice">add_meas_BrS_ctrl_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice_jags">add_meas_BrS_param_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice">add_meas_BrS_param_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_reg_Slice_jags">add_meas_BrS_param_Nest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice_jags">add_meas_BrS_param_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice">add_meas_BrS_param_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_Slice_jags">add_meas_BrS_param_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_subclass_Nest_Slice">add_meas_BrS_subclass_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_SS_param">add_meas_SS_param</a>()</code>
</p>
<p>Other plug-and-play functions: 
<code><a href="#topic+add_meas_BrS_case_Nest_Slice_jags">add_meas_BrS_case_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_Nest_Slice">add_meas_BrS_case_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice_jags">add_meas_BrS_case_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice">add_meas_BrS_case_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_Slice_jags">add_meas_BrS_case_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_Nest_Slice">add_meas_BrS_ctrl_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_Slice">add_meas_BrS_ctrl_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice_jags">add_meas_BrS_param_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice">add_meas_BrS_param_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_reg_Slice_jags">add_meas_BrS_param_Nest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice_jags">add_meas_BrS_param_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice">add_meas_BrS_param_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_Slice_jags">add_meas_BrS_param_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_subclass_Nest_Slice">add_meas_BrS_subclass_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_SS_param">add_meas_SS_param</a>()</code>
</p>

<hr>
<h2 id='add_meas_SS_param'>add parameters for a SS measurement slice among cases (conditional independence)</h2><span id='topic+add_meas_SS_param'></span>

<h3>Description</h3>

<p>add parameters for a SS measurement slice among cases (conditional independence)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_meas_SS_param(nslice, Mobs, prior, cause_list)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add_meas_SS_param_+3A_nslice">nslice</code></td>
<td>
<p>the total number of SS measurement slices</p>
</td></tr>
<tr><td><code id="add_meas_SS_param_+3A_mobs">Mobs</code></td>
<td>
<p>see <code>data_nplcm</code> described in <code><a href="#topic+nplcm">nplcm()</a></code></p>
</td></tr>
<tr><td><code id="add_meas_SS_param_+3A_prior">prior</code></td>
<td>
<p>see <code>model_options</code> described in <code><a href="#topic+nplcm">nplcm()</a></code></p>
</td></tr>
<tr><td><code id="add_meas_SS_param_+3A_cause_list">cause_list</code></td>
<td>
<p>the list of causes in <code>model_options</code> described in <code><a href="#topic+nplcm">nplcm()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of two elements: the first is <code>plug</code>, the .bug code; the second is <code>parameters</code>
that stores model parameters introduced by this plugged measurement slice
</p>


<h3>See Also</h3>

<p>Other likelihood specification functions: 
<code><a href="#topic+add_meas_BrS_case_Nest_Slice_jags">add_meas_BrS_case_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_Nest_Slice">add_meas_BrS_case_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice_jags">add_meas_BrS_case_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice">add_meas_BrS_case_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_Slice_jags">add_meas_BrS_case_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_Nest_Slice">add_meas_BrS_ctrl_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_Slice">add_meas_BrS_ctrl_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice_jags">add_meas_BrS_param_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice">add_meas_BrS_param_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_reg_Slice_jags">add_meas_BrS_param_Nest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice_jags">add_meas_BrS_param_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice">add_meas_BrS_param_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_Slice_jags">add_meas_BrS_param_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_subclass_Nest_Slice">add_meas_BrS_subclass_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_SS_case">add_meas_SS_case</a>()</code>
</p>
<p>Other plug-and-play functions: 
<code><a href="#topic+add_meas_BrS_case_Nest_Slice_jags">add_meas_BrS_case_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_Nest_Slice">add_meas_BrS_case_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice_jags">add_meas_BrS_case_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_Slice">add_meas_BrS_case_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_Slice_jags">add_meas_BrS_case_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_Nest_Slice">add_meas_BrS_ctrl_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_Slice">add_meas_BrS_ctrl_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice_jags">add_meas_BrS_param_Nest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_Slice">add_meas_BrS_param_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_Nest_reg_Slice_jags">add_meas_BrS_param_Nest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice_jags">add_meas_BrS_param_NoNest_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_Slice">add_meas_BrS_param_NoNest_Slice</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_Slice_jags">add_meas_BrS_param_NoNest_reg_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags">add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags</a>()</code>,
<code><a href="#topic+add_meas_BrS_subclass_Nest_Slice">add_meas_BrS_subclass_Nest_Slice</a>()</code>,
<code><a href="#topic+add_meas_SS_case">add_meas_SS_case</a>()</code>
</p>

<hr>
<h2 id='as.matrix_or_vec'>convert one column data frame to a vector</h2><span id='topic+as.matrix_or_vec'></span>

<h3>Description</h3>

<p>convert one column data frame to a vector
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.matrix_or_vec(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.matrix_or_vec_+3A_x">x</code></td>
<td>
<p>an one-column data.frame</p>
</td></tr>
</table>


<h3>Details</h3>

<p>JAGS cannot accept a data frame with one column; This function
converts it to a vector, which JAGS will allow.
</p>


<h3>Value</h3>

<p>a vector
</p>

<hr>
<h2 id='assign_model'>Interpret the specified model structure</h2><span id='topic+assign_model'></span>

<h3>Description</h3>

<p><code>assign_model</code> translates options specified by a user (e.g., in
<code>model_options</code>) into information that can be understood by <code>baker</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>assign_model(model_options, data_nplcm, silent = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="assign_model_+3A_model_options">model_options</code></td>
<td>
<p>See <code><a href="#topic+nplcm">nplcm()</a></code> function.</p>
</td></tr>
<tr><td><code id="assign_model_+3A_data_nplcm">data_nplcm</code></td>
<td>
<p>Data. See <code><a href="#topic+nplcm">nplcm()</a></code> function for data structure.</p>
</td></tr>
<tr><td><code id="assign_model_+3A_silent">silent</code></td>
<td>
<p>Default is <code>TRUE</code> for no messages; <code>FALSE</code> otherwise.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>assign_model</code> will be modified to check if data are conformable
to specified model.
</p>


<h3>Value</h3>

<p>A list of model specifications:
</p>

<ul>
<li> <p><code>num_slice</code> A vector counting the No. of measurement slices for each
level of measurement quality (e.g., MBS, MSS, MGS representing
Bronze-Standard Measurements - case-control,
Silver-Standard Measurements and Gold-Standard
Measurements - case-only);
</p>
</li>
<li> <p><code>nested</code> Local dependence specification for modeling bronze-standard
data. <code>TRUE</code> for nested models (conditional dependence given disease class);
<code>FALSE</code> for non-nested models (conditional independence given disease class).
One for each BrS slice.
</p>
</li>
<li> <p><code>regression</code>
</p>

<ul>
<li> <p><code>do_reg_Eti</code> <code>TRUE</code> for doing etiology regression.
It means let the etiology fractions vary with explanatory variables.
<code>FALSE</code> otherwise;
</p>
</li>
<li> <p><code>do_reg_FPR</code> A vector whose names represent the slices
of bronze-standard data. For each slice of BrS measurements,
<code>TRUE</code> does false positive rate regression. It means the false
positive rates, estimatable from controls, can vary with
covariates; <code>FALSE</code> otherwise.
</p>
</li>
<li> <p><code>is_discrete_predictor</code> A list of names &quot;Eti&quot;, and
the names for every slice of bronze-standard data. <code>TRUE</code>
if all predictors are discrete; <code>FALSE</code> otherwise.
</p>
</li></ul>

</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>cause_list &lt;- c(LETTERS[1:6]) 
J.BrS &lt;- 6
model_options_no_reg &lt;- list(
likelihood   = list(
  cause_list = cause_list,
  k_subclass = 2,
  Eti_formula = ~-1, 
  # no covariate for the etiology regression
  FPR_formula = list(
    MBS1 =   ~-1)    
    # no covariate for the subclass weight regression
),
use_measurements = c("BrS"), 
# use bronze-standard data only for model estimation.
prior= list(
  Eti_prior = overall_uniform(1,cause_list), 
  # Dirichlet(1,...,1) prior for the etiology.
  TPR_prior  = list(BrS = list(
    info  = "informative", # informative prior for TPRs
    input = "match_range", 
    # specify the informative prior for TPRs by specifying a plausible range.
    val = list(MBS1 = list(up =  list(rep(0.99,J.BrS)), 
    # upper ranges: matched to 97.5% quantile of a Beta prior
                           low = list(rep(0.55,J.BrS))))
                           # lower ranges: matched to 2.5% quantile of a Beta prior
  )
  )
)
)     
data("data_nplcm_noreg")

assign_model(model_options_no_reg,data_nplcm_noreg)

</code></pre>

<hr>
<h2 id='baker'>baker: <strong>B</strong>ayesian <strong>A</strong>nalytic <strong>K</strong>it for
<strong>E</strong>tiology <strong>R</strong>esearch</h2><span id='topic+baker'></span>

<h3>Description</h3>

<p><code>baker</code> is designed for disease etiology studies from case-control data
with multiple sources of measurements with potential errors. If you are
interested in estimating the population etiology pie (a vector of fractions
that sum to one), and the probability of each cause for a particular
individual case, try <code>baker</code>.
</p>


<h3>Details</h3>

<p><code>baker</code> implements hierarchical Bayesian models to infer disease etiology
for multivariate binary data. We created <code>baker</code> to catalyze effective
communications between analysts and practicing clinicians that are vital to
the success of etiology studies. The <code>baker</code> package offers
modules to
</p>

<ul>
<li><p> Import and tidy the
PERCH data (the study that motivates the creation of this package),
</p>
</li>
<li><p> Transform, explore the data,
</p>
</li>
<li><p> Specify, automatically generate the model files, and fit the models (npLCM),
</p>
</li>
<li><p> Store and visualize posterior summaries for communicating scientific
findings, and
</p>
</li>
<li><p> Check and compare the fitted models.
</p>
</li></ul>

<p><code>baker</code> has implemented models for dependent
measurements given disease status, regression analyses of etiology,
multiple imperfect measurements, different priors for true positive rates
among cases with differential measurement characteristics, and
multiple-pathogen etiology. Scientists in Pneumonia Etiology Research for
Child Health (PERCH) study usually refer to the etiology distribution
as &quot;population etiology pie&quot; and &quot;individual etiology pie&quot; for their
compositional nature, hence the name of the package (baking the pie).
</p>


<h3>Value</h3>

<p>No returned value; documentation purpose only.
</p>


<h3>baker functions</h3>

<p><code><a href="#topic+nplcm">nplcm()</a></code>
</p>


<h3>See Also</h3>


<ul>
<li> <p><a href="https://github.com/zhenkewu/baker">https://github.com/zhenkewu/baker</a> for the source code
and system/software requirements to use <code>baker</code> for your data.
</p>
</li></ul>


<hr>
<h2 id='beta_parms_from_quantiles'>Pick parameters in the Beta distribution to match the specified range</h2><span id='topic+beta_parms_from_quantiles'></span>

<h3>Description</h3>

<p><code>beta_parms_from_quantiles</code> produces prior Beta parameters for
the true positive rates (TPR)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>beta_parms_from_quantiles(
  q,
  p = c(0.025, 0.975),
  precision = 0.001,
  derivative.epsilon = 0.001,
  start.with.normal.approx = TRUE,
  start = c(1, 1),
  plot = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="beta_parms_from_quantiles_+3A_q">q</code></td>
<td>
<p>A vector of lower and upper bounds, in which Beta distribution
will have quantiles specified by <code>p</code>. For example, <code>q=c(0.5,0.99)</code></p>
</td></tr>
<tr><td><code id="beta_parms_from_quantiles_+3A_p">p</code></td>
<td>
<p>The lower and upper quantiles of the range one wants to specify.</p>
</td></tr>
<tr><td><code id="beta_parms_from_quantiles_+3A_precision">precision</code></td>
<td>
<p>Approximation precisions.</p>
</td></tr>
<tr><td><code id="beta_parms_from_quantiles_+3A_derivative.epsilon">derivative.epsilon</code></td>
<td>
<p>Precision of calculating derivative.</p>
</td></tr>
<tr><td><code id="beta_parms_from_quantiles_+3A_start.with.normal.approx">start.with.normal.approx</code></td>
<td>
<p>Default is <code>TRUE</code>, for normal approximation.</p>
</td></tr>
<tr><td><code id="beta_parms_from_quantiles_+3A_start">start</code></td>
<td>
<p>Starting values of beta parameters.</p>
</td></tr>
<tr><td><code id="beta_parms_from_quantiles_+3A_plot">plot</code></td>
<td>
<p>Default is <code>FALSE</code> to suppress plotting of the beta density,
otherwise, set to <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the selected Beta parameters <code>a</code>, and <code>b</code>.
Other elements of the list include some details about the computations involved
in finding <code>a</code> and <code>b</code>.
</p>


<h3>References</h3>

<p><a href="http://www.medicine.mcgill.ca/epidemiology/Joseph/PBelisle/BetaParmsFromQuantiles.html">http://www.medicine.mcgill.ca/epidemiology/Joseph/PBelisle/BetaParmsFromQuantiles.html</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
beta_parms_from_quantiles(c(0.5,0.99))

</code></pre>

<hr>
<h2 id='beta_plot'>Plot beta density</h2><span id='topic+beta_plot'></span>

<h3>Description</h3>

<p>Plot beta density
</p>


<h3>Usage</h3>

<pre><code class='language-R'>beta_plot(a, b)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="beta_plot_+3A_a">a</code></td>
<td>
<p>The first parameter</p>
</td></tr>
<tr><td><code id="beta_plot_+3A_b">b</code></td>
<td>
<p>The second parameter</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None
</p>


<h3>Examples</h3>

<pre><code class='language-R'> 
beta_plot(2,2)
</code></pre>

<hr>
<h2 id='bin2dec'>Convert a 0/1 binary-coded sequence into decimal digits</h2><span id='topic+bin2dec'></span>

<h3>Description</h3>

<p>Useful when try to list all the binary patterns. One can group the binary
sequences according to their equivalent decimal values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bin2dec(binary_vector)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bin2dec_+3A_binary_vector">binary_vector</code></td>
<td>
<p>a binary number</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a decimal number
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
bin2dec(c(1,0,1))

</code></pre>

<hr>
<h2 id='check_dir_create'>check existence and create folder if non-existent</h2><span id='topic+check_dir_create'></span>

<h3>Description</h3>

<p>check existence and create folder if non-existent
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_dir_create(path)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_dir_create_+3A_path">path</code></td>
<td>
<p>Folder path to check and create if not there.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the same returned values for <code><a href="base.html#topic+dir.create">dir.create()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
check_dir_create(tempdir())

</code></pre>

<hr>
<h2 id='clean_combine_subsites'>Combine subsites in raw PERCH data set</h2><span id='topic+clean_combine_subsites'></span>

<h3>Description</h3>

<p>In the Actual PERCH data set, a study site may have multiple subsites.
<code>clean_combine_subsites</code> combines all the study subjects from the same site.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clean_combine_subsites(raw_meas_dir, subsites_list, newsites_vec)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="clean_combine_subsites_+3A_raw_meas_dir">raw_meas_dir</code></td>
<td>
<p>The file path to the raw data file (.csv)</p>
</td></tr>
<tr><td><code id="clean_combine_subsites_+3A_subsites_list">subsites_list</code></td>
<td>
<p>The list of subsite group names. Each group is a vector of
subsites to be combined</p>
</td></tr>
<tr><td><code id="clean_combine_subsites_+3A_newsites_vec">newsites_vec</code></td>
<td>
<p>A vector of new site names. It has the same length as
<code>"subsites_list"</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with combined sites
</p>

<hr>
<h2 id='clean_perch_data'>Clean PERCH data</h2><span id='topic+clean_perch_data'></span>

<h3>Description</h3>

<p><code>clean_perch_data</code> transforms a raw data table (row for subjects, column
for variables - named as <code>{pathogen name}_{specimen}{test}</code> for lab tests
or other covariates) into a list. It is designed for PERCH data format.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clean_perch_data(clean_options)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="clean_perch_data_+3A_clean_options">clean_options</code></td>
<td>
<p>The list of options for cleaning PERCH data.
Its elements are defined as follows:
</p>

<dl>
<dt><code>raw_meas_dir</code></dt><dd><p>: The file path to the raw data;</p>
</dd>
<dt><code>case_def</code></dt><dd><p>: Variable name in raw data for <strong>case</strong> definition;</p>
</dd>
<dt><code>case_def_val</code></dt><dd><p>: The value for <strong>case</strong> definition;</p>
</dd>
<dt><code>ctrl_def</code></dt><dd><p>: Variable name in raw data for <strong>control</strong> definition;</p>
</dd>
<dt><code>ctrl_def_val</code></dt><dd><p>: The value for <strong>control</strong> definition;</p>
</dd>
<dt><code>X_strat</code></dt><dd><p>: A vector of variable names for stratifying the data
to perform SEPARATE analyses;</p>
</dd>
<dt><code>X_strat_val</code></dt><dd><p>: A list of values for <code>X_strat</code>. The output
data only have individuals with <code>identical(X_strat,X_strat_val)==TRUE</code>.
To perform analysis on a single site, say <code>"02GAM"</code>, use <code>X_strat="newSITE"</code> and
<code>X_strat_val=list("02GAM")</code>;</p>
</dd>
<dt><code>BrS_objects</code></dt><dd><p>: A list of BrS objects built by <code><a href="#topic+make_meas_object">make_meas_object()</a></code>;</p>
</dd>
<dt><code>SS_objects</code></dt><dd><p>: A list of SS objects built by <code><a href="#topic+make_meas_object">make_meas_object()</a></code>;</p>
</dd>
<dt><code>X_extra</code></dt><dd><p>: A vector of covariate names for regression
or visualization;</p>
</dd>
<dt><code>patho_taxo_dir</code></dt><dd><p>: The file path to the pathogen category or taxonomy
information (.csv). The information should be as complete as possible for a particular
analysis. If not, the pathogen without taxonomy information could not be
assigned to bacterial or viral groups (see <code>plot_group_etiology()</code>);
See <code>assign_taxo_cause_list()</code> that requires this taxonomy information.</p>
</dd></dl>
<p>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A List: <code>list(Mobs,Y,X)</code>
</p>

<ul>
<li> <p><code>Mobs</code> A list of bronze- (<code>MBS</code>), silver- (<code>MSS</code>),
and gold-standard (<code>MGS</code>, if available) measurements. See the formats
of these measurements in <code><a href="#topic+extract_data_raw">extract_data_raw()</a></code>.
</p>
</li>
<li> <p><code>Y</code> 1 for case; 0 for control;
</p>
</li>
<li> <p><code>X</code> Data frame of covariates for cases and controls. The covariate
names are specified in <code>X_extra</code>;
</p>
</li></ul>

<p>This function does not re-order pathogens that only have silver-standard data.
</p>


<h3>See Also</h3>

<p><a href="#topic+make_meas_object">make_meas_object</a> for wrapping information about a particular
type of measurement; <a href="#topic+extract_data_raw">extract_data_raw</a> for reading raw data table
and organizing them into <code>data_nplcm</code> format. Also see <a href="#topic+clean_combine_subsites">clean_combine_subsites</a>
for combining subsites and <a href="lubridate.html#topic+parse_date_time">parse_date_time</a> for parsing date.
</p>

<hr>
<h2 id='combine_data_nplcm'>combine multiple data_nplcm (useful when simulating data from regression models)</h2><span id='topic+combine_data_nplcm'></span>

<h3>Description</h3>

<p>combine multiple data_nplcm (useful when simulating data from regression models)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>combine_data_nplcm(data_nplcm_list)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="combine_data_nplcm_+3A_data_nplcm_list">data_nplcm_list</code></td>
<td>
<p>a list of data_nplcm in <code><a href="#topic+nplcm">nplcm()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list with each element resulting from row binding of each
corresponding element in the input <code>data_nplcm_list</code>.
</p>


<h3>See Also</h3>

<p>Other data operation functions: 
<code><a href="#topic+merge_lists">merge_lists</a>()</code>,
<code><a href="#topic+subset_data_nplcm_by_index">subset_data_nplcm_by_index</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
N=100
Y = rep(c(1,0),times=50) # simulate two cases and two controls.
out_list &lt;- vector("list",length=N)
J = 3                          # number of causes
cause_list = c(LETTERS[1:J])   # cause list
K = 2                          # number of subclasses
lambda = c(.8,.2)                # subclass weights for control group
eta = c(.9,.1)                   # subclass weights for case group

for (i in 1:N){
  #setup parameters for the present individual:
  set_parameter &lt;- list(
    cause_list      = cause_list,
    etiology        = c(0.5,0.2,0.3), # only meaningful for cases
    pathogen_BrS    = LETTERS[1:J],
    pathogen_SS     = LETTERS[1:2],
    meas_nm         = list(MBS = c("MBS1"),MSS=c("MSS1")),
    Lambda          = lambda,         # for BrS
    Eta             = t(replicate(J,eta)),  # case subclass weight for BrS
    PsiBS           = cbind(c(0.15,0.3,0.35),
                            c(0.25,0.2,0.15)), # FPR
    PsiSS           = cbind(rep(0,J),rep(0,J)),
    ThetaBS         = cbind(c(0.95,0.9,0.85),    # TPR
                            c(0.95,0.9,0.85)),
    ThetaSS         = cbind(c(0.25,0.10),
                            c(0.25,0.10)),
    Nd      =     1,
    Nu      =     1
  )
  simu_out   &lt;- simulate_nplcm(set_parameter)
  out &lt;- simu_out$data_nplcm
  out_list[[i]] &lt;- out
}

# extract cases and controls and combine all the data into one:
data_nplcm_list &lt;- lapply(1:N, function(s) subset_data_nplcm_by_index(out_list[[s]],2-Y[s]))
data_nplcm_unordered      &lt;- combine_data_nplcm(data_nplcm_list)

</code></pre>

<hr>
<h2 id='compute_logOR_single_cause'>Calculate marginal log odds ratios</h2><span id='topic+compute_logOR_single_cause'></span>

<h3>Description</h3>

<p>This only works for single-agent causes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_logOR_single_cause(set_parameter)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compute_logOR_single_cause_+3A_set_parameter">set_parameter</code></td>
<td>
<p>True model parameters in an npLCM specification:
</p>

<dl>
<dt><code>cause_list</code></dt><dd><p> a vector of disease class names among cases (since
the causes could be multi-agent (e.g., multiple pathogens may cause an individual case's
pneumonia), so its length could be longer than the total number of unique
causative agents)</p>
</dd>
<dt><code>etiology</code></dt><dd><p> a vector of proportions that sum to 100 percent</p>
</dd>
<dt><code>pathogen_BrS</code></dt><dd><p> a vector of putative causative agents' names measured in bronze-standard (BrS) data.
This function simulates only one slice defined by <code style="white-space: pre;">&#8288;specimen``test``pathogen&#8288;</code></p>
</dd>
<dt><code>pathogen_SS</code></dt><dd><p> a vector of pathogen names measured in silver-standard (SS) data.</p>
</dd>
<dt><code>meas_nm</code></dt><dd><p> a list of <code style="white-space: pre;">&#8288;specimen``test&#8288;</code> names e.g., <code>list(MBS = c("NPPCR"),MSS="BCX")</code>
for nasopharyngeal (NP) specimen tested by polymerase chain reaction (PCR) - <code>NPPCR</code> and
blood (B) tested by culture (Cx) - <code>BCX</code></p>
</dd>
<dt><code>Lambda</code></dt><dd><p> controls' subclass weights <code class="reqn">\nu_1, \nu_2, \ldots, \nu_K</code>
a vector of <code>K</code> probabilities that sum to 1.</p>
</dd>
<dt><code>Eta</code></dt><dd><p>    a matrix of dimension <code>length(cause_list)</code> by <code>K</code>;
each row represents a disease class (among cases); the values in that row
are subclass weights <code class="reqn">\eta_1, \eta_2, \ldots, \eta_K</code> for that disease class,
so needs to sum to one. In Wu et al. 2016 (JRSS-C), the subclass weights are the same across disease
classes across rows. But when simulating data, one can specify rows with distinct
subclass weights - it is a matter whether we can recover these parameters (possible when
some cases' true disease classes are observed)</p>
</dd>
<dt><code>PsiBS/PsiSS</code></dt><dd><p> False positive rates for Bronze-Standard data and
for Silver-Standard data. For example, the rows of <code>PsiBS</code> correspond to the dimension of the particular
slice of BrS measures, e.g., <code>10</code> for 10 causative agents measured by NPPCR; the
columns correspond to <code>K</code> subclasses; generically, the dimension is <code>J</code> by <code>K</code>
<code>PsiSS</code> is supposed to be a vector of all zeros (perfect specificity in silver-standard measures).</p>
</dd>
<dt><code>ThetaBS/ThetaSS</code></dt><dd><p>  True positive rates <code class="reqn">\Theta</code> for Bronze-Standard data and
for Silver-Standard data. Dimension is <code>J</code> by <code>K</code> (can contain <code>NA</code> if the total number of
causative agents measured by BrS or SS exceeds the measured causative agents in SS. For example,
in PERCH study, nasopharyngeal polymerase chain reaction (NPPCR; bronze-standard) may target 30 distinct pathogens, but blood culture (BCX; silver-standard) may only target a subset of the 30,
so we have to specify <code>NA</code> in <code>ThetaSS</code>for those pathogens not targeted by BCX).</p>
</dd>
<dt><code>Nu</code></dt><dd><p> the number of control subjects</p>
</dd>
<dt><code>Nd</code></dt><dd><p> the number of case subjects</p>
</dd>
</dl>
</td></tr>
</table>


<h3>Value</h3>

<p>a matrix of log odds ratio.
See the example for a figure showing pairwise odds ratios for cases (upper right, solid lines)
and controls (lower left, broken lines) as the first subclass weight increases
from 0 to 1. Pairwise independence is represented by the dotted horizontal lines
for reference.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>K.true  &lt;- 2   # no. of latent subclasses in actual simulation. 
               # If eta = c(1,0), effectively, it is K.true=1
J       &lt;- 5   # no. of pathogens.
N       &lt;- 500 # no. of cases/controls.

col_seq_cause &lt;-  c("#DB9D85","#A2B367","#47BEA2",
"#70B3DA","#CD99D8")#colorspace::rainbow_hcl(5, start = 30, end = 300)

subclass_mix_seq &lt;- seq(0,1,by=0.05)
res      &lt;- array(NA,c(J,J,length(subclass_mix_seq)))
res_cond &lt;- array(NA,c(J,J,length(subclass_mix_seq),J))

it &lt;- layout(matrix(1:J^2,nrow=J,ncol=J,byrow=TRUE),
            heights = rep(3,J),
            widths  = rep(3,J)) 

oldpar &lt;- par(oma=c(8,10,8,3));  

pch_seq_cause &lt;- LETTERS[1:J]
lty_seq_cause &lt;- 1+(1:J)
pch_pos_seq   &lt;- c(0.01); gap = 0.15
adj_seq &lt;- c(0.15,0.5,0.85) # for roman numerals:
cex1       &lt;- 2
cex_label1 &lt;- 1
cex2       &lt;- 2
cex_label2 &lt;- 2
cex_margin_marks &lt;- 2

for (scn in c(1,2,3)){
 for (iter in seq_along(subclass_mix_seq)){
   curr_mix &lt;- subclass_mix_seq[iter]
   lambda &lt;- c(curr_mix,1-curr_mix)
   eta    &lt;- c(curr_mix,1-curr_mix) 
   # if it is c(1,0),then it is conditional independence model, and
   # only the first column of parameters in PsiBS, ThetaBS matter!
   
   seed_start &lt;- 20150923
   
   # set fixed simulation sequence:
   set.seed(seed_start)
   
   if (scn == 3){
     ThetaBS_withNA &lt;- cbind(c(0.95,0.9,0.1,0.5,0.5),
                             c(0.95,0.1,0.9,0.5,0.5))
     PsiBS_withNA   &lt;- cbind(c(0.4,0.4,0.05,0.2,0.2),
                             c(0.05,0.05,0.4,0.05,0.05))
   }
   
   if (scn == 2){
     ThetaBS_withNA &lt;- cbind(c(0.95,0.5,0.5,0.5,0.5),
                             c(0.95,0.5,0.5,0.5,0.5))
     PsiBS_withNA   &lt;- cbind(c(0.4,0.4,0.05,0.2,0.2),
                             c(0.05,0.05,0.4,0.05,0.05))
   }
   
   if (scn == 1){
     ThetaBS_withNA &lt;- cbind(c(0.95,0.5,0.5,0.5,0.5),
                             c(0.95,0.5,0.5,0.5,0.5))
     PsiBS_withNA   &lt;- cbind(c(0.3,0.3,0.15,0.2,0.2),
                             c(0.15,0.15,0.3,0.05,0.05))
   }
   
   # the following paramter names are set using names in the 'baker' package:
   set_parameter0 &lt;- list(
     cause_list      = c(LETTERS[1:J]),
     etiology        = c(0.5,0.2,0.15,0.1,0.05), #same length as cause_list
     #etiology        = rep(0.2,J), #same length as cause_list
     pathogen_BrS    = LETTERS[1:J],
     meas_nm         = list(MBS = c("MBS1")),
     Lambda          = lambda,              #ctrl mix
     Eta             = t(replicate(J,eta)), #case mix, row number equal to Jcause.
     PsiBS           = PsiBS_withNA,
     ThetaBS         = ThetaBS_withNA,
     Nu      =     N, # control size.
     Nd      =     N  # case size.
   )
   
   res[,,iter] &lt;- round(compute_logOR_single_cause(set_parameter0),2)
   
   for (pick in 1:J){
     set_parameter &lt;- set_parameter0
     set_parameter$ThetaBS &lt;- set_parameter0$PsiBS
     set_parameter$ThetaBS[pick,] &lt;- set_parameter0$ThetaBS[pick,]
     set_parameter$etiology &lt;- rep(0,J); set_parameter$etiology[pick] &lt;- 1
     res_cond[,,iter,pick] &lt;- round(compute_logOR_single_cause(set_parameter),2)
   }
 }
 
 ind &lt;- sapply(c(0,0.5,1),function(x) which(subclass_mix_seq==x))
 logOR_lim &lt;- c(-2.15,2.15)
 col_seq &lt;- c("dodgerblue2","orange")
 logOR_seq &lt;- log(c(0.25,0.5,1,2,4))
 pick_one &lt;- 3

 print(paste0("==Shading pairs of ",pch_seq_cause[pick_one]," and others.==="))
 for (j in 1:J){
   for (l in 1:J){
     
     par(mar=c(0,0,0,0)); 
     if (j==J){
       par(mar=c(0,0,0,0))
     }
     if (l%%J==0){
       par(mar=c(0,0,0,1)) 
     }
     if (l%%J==1){
       par(mar=c(0,1,0,0))
     }
     if (!(j==l)){
       plot(res[j,l,],type="l",xlab="",ylab="",
            ylim=logOR_lim, lwd=5,
            xaxt="n",
            yaxt="n",
            col=col_seq[1+(l&gt;j)],
            #lty=c(2,1)[1+(l&gt;j)],
            lty=1,
            bty="n"
       )
       box(col="lightgray")
       abline(h=0,col="lightgray",lwd=3,lty=3)
       
       if (j&lt;l){
         matplot(res_cond[j,l,,],type="l",add=TRUE,pch=LETTERS[1:J],lwd=2,lty=2,
                 col=col_seq_cause)
       }
       lab_ord &lt;- c(j,l); if (j&gt;l){lab_ord &lt;- rev(lab_ord)}
       mtext(paste0("(",set_parameter$pathogen_BrS[lab_ord[1]],",", 
                    set_parameter$pathogen_BrS[lab_ord[2]],")"), 
             side=3, adj=0.1,line=-2)
       
       if (l%%J==1){
         axis(2,at = logOR_seq, 
              labels = round(exp(logOR_seq),1),
              las=2,cex.axis=cex1)
       }
       
       if (l%%J==0){
         axis(4,at = logOR_seq, 
              labels = round(exp(logOR_seq),1),
              las=2,cex.axis=cex1)
       }
       
       if (j==J){
         axis(1,at=seq_along(subclass_mix_seq)[ind],
         labels=rep("",length(ind)),cex.axis = cex1,las=1)
         axis(1,at=seq_along(subclass_mix_seq)[ind]+c(1,rep(0,length(ind)-2),-1),
         labels=subclass_mix_seq[ind],cex.axis = cex1,las=1,tick=FALSE)
       }
       if (j==1){
         axis(3,at=seq_along(subclass_mix_seq)[ind],
         labels=rep("",length(ind)),cex.axis = cex1,las=1)
         axis(3,at=seq_along(subclass_mix_seq)[ind]+c(1,rep(0,length(ind)-2),-1),
         labels=subclass_mix_seq[ind],cex.axis = cex1,las=1,tick=FALSE)
       }
       if (j==5 &amp; l==1){
         mtext(expression(atop("Odds Ratio","(log-scale)")), side = 2, line = 4, 
               cex=cex_label1, las=2)
       }
       if (j==5){
         mtext(expression(lambda[o]),side=1,line=4,cex=cex_label1)
       }
       
       if ((j&lt;l) &amp;&amp; (l==pick_one | j==pick_one )){
         # add shading cells for oen picked pathogen among cases:
         color &lt;- rgb(190, 190, 190, alpha=80, maxColorValue=255)
         rect(par("usr")[1], par("usr")[3], par("usr")[2], 
              par("usr")[4], density = 100, col = color)
         
         matplot(res_cond[j,l,,],type="l",add=TRUE,lwd=2,col=col_seq_cause,lty=lty_seq_cause)
         for (ell in 1:J){
           where_add_letter &lt;- quantile(seq_along(subclass_mix_seq),pch_pos_seq+gap*ell)
           points(where_add_letter, res_cond[j,l,where_add_letter,ell], pch=pch_seq_cause[ell])
         }
         mtext(paste0("(",set_parameter$pathogen_BrS[lab_ord[1]],",", 
                      set_parameter$pathogen_BrS[lab_ord[2]],")"), 
               side=3, adj=0.1,line=-2)
       }
       
     }else{
       
       plot(1, type="n", axes=FALSE, xlab="", ylab="", bty="n",
            xlim=c(0,1),ylim=c(0,1))
       
       
       if (j==3){
         text(labels=expression(CASES%up%""),x=.7,
              y=0.55,srt=-49,col=col_seq[2],cex=1.8,adj=0.5,font=4)
         text(labels=expression(CONTROLS%down%""),x=.42,
              y=0.38,srt=-49,col=col_seq[1],cex=1.8,adj=0.5,font=4)
       }
       if (j!=1 &amp; j!=J){
         dg &lt;- par("usr") 
         segments(dg[1],dg[4],dg[2],dg[3], col='lightgray',lwd=3)
       }
       if (j==J){
         legend("top",LETTERS[1:J],lty=2,col=col_seq_cause,cex = 1.5,lwd=2,
                bty="n",horiz=FALSE)
       }
     }
   }
 }
}
par(oldpar)

</code></pre>

<hr>
<h2 id='compute_marg_PR_nested_reg'>compute positive rates for nested model with subclass mixing weights that are the same across
<code>Jcause</code> classes for each person (people may have different weights.)</h2><span id='topic+compute_marg_PR_nested_reg'></span>

<h3>Description</h3>

<p>The array version of this function (<a href="#topic+compute_marg_PR_nested_reg_array">compute_marg_PR_nested_reg_array</a>) is used in <a href="#topic+plot_etiology_regression">plot_etiology_regression</a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_marg_PR_nested_reg(ThetaBS, PsiBS, pEti_mat, subwt_mat, case, template)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compute_marg_PR_nested_reg_+3A_thetabs">ThetaBS</code></td>
<td>
<p>True positive rates for <code>JBrS</code> measures (rows) among <code>K</code> subclasses (columns)</p>
</td></tr>
<tr><td><code id="compute_marg_PR_nested_reg_+3A_psibs">PsiBS</code></td>
<td>
<p>False positive rates; dimension same as above</p>
</td></tr>
<tr><td><code id="compute_marg_PR_nested_reg_+3A_peti_mat">pEti_mat</code></td>
<td>
<p>a matrix of etiology pies for <code>N</code> subjects (rows) and <code>Jcause</code> causes (columns)
rows sum to ones.</p>
</td></tr>
<tr><td><code id="compute_marg_PR_nested_reg_+3A_subwt_mat">subwt_mat</code></td>
<td>
<p>a matrix of subclass weights for cases and controls. <code>N</code> by <code>K</code>. Rows sum
to ones.</p>
</td></tr>
<tr><td><code id="compute_marg_PR_nested_reg_+3A_case">case</code></td>
<td>
<p>a N-vector of <code>1</code>s (cases) and <code>0</code>s (controls)</p>
</td></tr>
<tr><td><code id="compute_marg_PR_nested_reg_+3A_template">template</code></td>
<td>
<p>a binary matrix with <code>Jcause+1</code> rows (<code>Jcause</code> classes of cases and <code>1</code> class of controls)
and <code>JBrS</code> columns for the Bronze-standard measurement (say, pick one type/slice).
The ones in each row indicate the measurements that will show up more frequently in cases given the cause.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a matrix of values between <code>0</code> and <code>1</code> (need not to have row sums of ones);
of dimension (number of subjects, dimension of the bronze-standard measurement slice).
</p>

<hr>
<h2 id='compute_marg_PR_nested_reg_array'>compute positive rates for nested model with subclass mixing weights that are the same across
<code>Jcause</code> classes for each person (people may have different weights.)</h2><span id='topic+compute_marg_PR_nested_reg_array'></span>

<h3>Description</h3>

<p>This is an array-version of <a href="#topic+compute_marg_PR_nested_reg">compute_marg_PR_nested_reg</a>. This is used in <a href="#topic+plot_etiology_regression">plot_etiology_regression</a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_marg_PR_nested_reg_array(
  ThetaBS_array,
  PsiBS_array,
  pEti_mat_array,
  subwt_mat_array,
  case,
  template
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compute_marg_PR_nested_reg_array_+3A_thetabs_array">ThetaBS_array</code></td>
<td>
<p>An array of: True positive rates for JBrS measures (rows) among K subclasses (columns)</p>
</td></tr>
<tr><td><code id="compute_marg_PR_nested_reg_array_+3A_psibs_array">PsiBS_array</code></td>
<td>
<p>An array of: False positive rates; dimension same as above</p>
</td></tr>
<tr><td><code id="compute_marg_PR_nested_reg_array_+3A_peti_mat_array">pEti_mat_array</code></td>
<td>
<p>An array of: a matrix of etiology pies for N subjects (rows) and Jcause causes (columns)
rows sum to ones.</p>
</td></tr>
<tr><td><code id="compute_marg_PR_nested_reg_array_+3A_subwt_mat_array">subwt_mat_array</code></td>
<td>
<p>An array of: a matrix of subclass weights for cases and controls. N by K. Rows sum
to ones.</p>
</td></tr>
<tr><td><code id="compute_marg_PR_nested_reg_array_+3A_case">case</code></td>
<td>
<p>a N-vector of 1s (cases) and 0s (controls)</p>
</td></tr>
<tr><td><code id="compute_marg_PR_nested_reg_array_+3A_template">template</code></td>
<td>
<p>a binary matrix with Jcause+1 rows (Jcause classes of cases and 1 class of controls)
and JBrS columns for the Bronze-standard measurement (say, pick one type/slice).
The ones in each row indicate the measurements that will show up more frequently in cases given the cause.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An array of: a matrix of values between 0 and 1 (need not to have row sums of ones); of dimension (number of subjects, dimension of the bronze-standard
measurement slice).
</p>

<hr>
<h2 id='create_bugs_regressor_Eti'>create regressor summation equation used in regression for etiology</h2><span id='topic+create_bugs_regressor_Eti'></span>

<h3>Description</h3>

<p><code>create_bugs_regressor_Eti</code> creates linear product of coefficients
and a row of design matrix used in regression
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_bugs_regressor_Eti(
  n,
  dm_nm = "dm_Eti",
  b_nm = "betaEti",
  ind_nm = "j",
  sub_ind_nm = "k"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create_bugs_regressor_Eti_+3A_n">n</code></td>
<td>
<p>the length of coefficients</p>
</td></tr>
<tr><td><code id="create_bugs_regressor_Eti_+3A_dm_nm">dm_nm</code></td>
<td>
<p>name of design matrix; default <code>"dm_Eti"</code></p>
</td></tr>
<tr><td><code id="create_bugs_regressor_Eti_+3A_b_nm">b_nm</code></td>
<td>
<p>name of the coefficients; default <code>"betaEti"</code></p>
</td></tr>
<tr><td><code id="create_bugs_regressor_Eti_+3A_ind_nm">ind_nm</code></td>
<td>
<p>name of the coefficient iterator; default <code>"j"</code></p>
</td></tr>
<tr><td><code id="create_bugs_regressor_Eti_+3A_sub_ind_nm">sub_ind_nm</code></td>
<td>
<p>name of the subject iterator; default <code>"k"</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a character string with linear product form
</p>

<hr>
<h2 id='create_bugs_regressor_FPR'>create regressor summation equation used in regression for FPR</h2><span id='topic+create_bugs_regressor_FPR'></span>

<h3>Description</h3>

<p><code>create_bugs_regressor_FPR</code> creates linear product of coefficients
and a row of design matrix used in regression
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_bugs_regressor_FPR(
  n,
  dm_nm = "dm_FPR",
  b_nm = "b",
  ind_nm = "j",
  sub_ind_nm = "k"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create_bugs_regressor_FPR_+3A_n">n</code></td>
<td>
<p>the length of coefficients</p>
</td></tr>
<tr><td><code id="create_bugs_regressor_FPR_+3A_dm_nm">dm_nm</code></td>
<td>
<p>name of design matrix; default <code>"dm_FPR"</code></p>
</td></tr>
<tr><td><code id="create_bugs_regressor_FPR_+3A_b_nm">b_nm</code></td>
<td>
<p>name of the coefficients; default <code>"b"</code></p>
</td></tr>
<tr><td><code id="create_bugs_regressor_FPR_+3A_ind_nm">ind_nm</code></td>
<td>
<p>name of the coefficient iterator; default <code>"j"</code></p>
</td></tr>
<tr><td><code id="create_bugs_regressor_FPR_+3A_sub_ind_nm">sub_ind_nm</code></td>
<td>
<p>name of the subject iterator; default <code>"k"</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a character string with linear product form
</p>

<hr>
<h2 id='data_nplcm_noreg'>Simulated dataset that is structured in the format necessary for an <code><a href="#topic+nplcm">nplcm()</a></code> without regression</h2><span id='topic+data_nplcm_noreg'></span>

<h3>Description</h3>

<p>Data set for illustrating regression functionalities
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("data_nplcm_noreg")
</code></pre>


<h3>Format</h3>

<p>A list containing three items
</p>

<dl>
<dt>Mobs</dt><dd><p>BrS level measurements: N = 600 (half cases and half controls);
one slice of BrS measurements (6 dimensional, A-F); one slice of SS measurements (2 dimensional,
A and B)</p>
</dd>
<dt>Y</dt><dd><p>case-control status</p>
</dd>
</dl>



<h3>Value</h3>

<p>No returned value; just loading data into the working space.
</p>

<hr>
<h2 id='data_nplcm_reg_nest'>Simulated dataset that is structured in the format necessary for an <code><a href="#topic+nplcm">nplcm()</a></code> with regression</h2><span id='topic+data_nplcm_reg_nest'></span>

<h3>Description</h3>

<p>Data set for illustrating regression functionalities
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("data_nplcm_reg_nest")
</code></pre>


<h3>Format</h3>

<p>A list containing three items
</p>

<dl>
<dt>Mobs</dt><dd><p>BrS level measurements: N = 1,200 (half cases and half controls);
one slice of BrS measurements (6 dimensional, A-F); one slice of SS measurements (2 dimensional,
A and B)</p>
</dd>
<dt>Y</dt><dd><p>case-control status</p>
</dd>
<dt>X</dt><dd><p>matrix of covariates (N by 4); columns: SITE (1 and 2, each with 600 subjects),
DATE (index from 1:300), std_date (standardized DATE), ENRLDATE (actual dates)</p>
</dd>
</dl>



<h3>Value</h3>

<p>No returned value; just loading data into the working space.
</p>

<hr>
<h2 id='delete_start_with'>Deletes a pattern from the start of a string, or each of a vector of strings.</h2><span id='topic+delete_start_with'></span>

<h3>Description</h3>

<p><code>delete_start_with</code> is used for clean the column names in raw data.
For example, R adds &quot;X&quot; at the start of variable names. This function deletes
&quot;X_&quot;s from the column names. This can happen if the raw data have column
names such as &quot;<code style="white-space: pre;">&#8288;_CASE_ABX&#8288;</code>&quot;. Check <code><a href="#topic+clean_perch_data">clean_perch_data()</a></code> for
its actual usage.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>delete_start_with(s, vec)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="delete_start_with_+3A_s">s</code></td>
<td>
<p>the pattern (a single string) to be deleted from the start.</p>
</td></tr>
<tr><td><code id="delete_start_with_+3A_vec">vec</code></td>
<td>
<p>a vector of strings with unwanted starting strings (specified by <code>s</code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>string(s) with deleted patterns from the start.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>delete_start_with("X_",c("X_hello"))
delete_start_with("X_",c("X_hello","hello2"))
delete_start_with("X_",c("X_hello","hello2","X_hello3"))

</code></pre>

<hr>
<h2 id='dm_Rdate_Eti'>Make etiology design matrix for dates with R format.</h2><span id='topic+dm_Rdate_Eti'></span>

<h3>Description</h3>

<p><code>dm_Rdate_Eti</code> creates design matrices for etiology regressions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dm_Rdate_Eti(Rdate, Y, num_knots_Eti, basis_Eti = "ncs")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dm_Rdate_Eti_+3A_rdate">Rdate</code></td>
<td>
<p>a vector of dates of R format</p>
</td></tr>
<tr><td><code id="dm_Rdate_Eti_+3A_y">Y</code></td>
<td>
<p>binary case/control status; 1 for case; 0 for controls</p>
</td></tr>
<tr><td><code id="dm_Rdate_Eti_+3A_num_knots_eti">num_knots_Eti</code></td>
<td>
<p>number of knots for etiology regression</p>
</td></tr>
<tr><td><code id="dm_Rdate_Eti_+3A_basis_eti">basis_Eti</code></td>
<td>
<p>the type of basis functions to use for etiology regression. It can be &quot;ncs&quot; (natural
cubic splines) or &quot;tprs&quot; (thin-plate regression splines). Default is &quot;ncs&quot;. &quot;tprs&quot;
will be implemented later.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It is used in <code>model_options$likeihood$Eti_formula</code>. For example, one can specify
it as: <br />
<br />
<code>~ AGECAT+HIV+dm_Rdate_Eti(ENRLDATE,Y,5)</code> <br />
<br />
to call an etiology regression with intercept, main effects for 'AGECAT' and 'HIV', and
natural cubic spline bases for 'ENRLDATE' using 5 knots defined as 5 equal-probability-spaced
sample quantiles.
</p>


<h3>Value</h3>

<p>Design matrix for etiology regression:
</p>

<ul>
<li> <p><code>Z_Eti</code> transformed design matrix for etiology regression
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+nplcm">nplcm()</a></code>
</p>

<hr>
<h2 id='dm_Rdate_FPR'>Make FPR design matrix for dates with R format.</h2><span id='topic+dm_Rdate_FPR'></span>

<h3>Description</h3>

<p><code>dm_Rdate_FPR</code> creates design matrices for false positive rate regressions;
can also be used to standardize dates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dm_Rdate_FPR(Rdate, Y, effect = "fixed", num_knots_FPR = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dm_Rdate_FPR_+3A_rdate">Rdate</code></td>
<td>
<p>a vector of dates of R format</p>
</td></tr>
<tr><td><code id="dm_Rdate_FPR_+3A_y">Y</code></td>
<td>
<p>binary case/control status; 1 for case; 0 for controls</p>
</td></tr>
<tr><td><code id="dm_Rdate_FPR_+3A_effect">effect</code></td>
<td>
<p>The design matrix for &quot;random&quot; or &quot;fixed&quot; effect; Default
is &quot;fixed&quot;. When specified as &quot;fixed&quot;, it produces standardized R-format dates
using control's mean and standard deviation; When specified as &quot;random&quot;, it produces
<code>num_knots_FPR</code> columns of design matrix for thin-plate regression splines (TPRS) fitting.
One needs both &quot;fixed&quot; and &quot;random&quot; in a FPR regression formula in <code>model_options</code>
to enable TPRS fitting. For example, <code>model_options$likelihood$FPR_formula</code> can be <br />
<br />
<code>~ AGECAT+HIV+dm_Rdate_FPR(ENRLDATE,Y,"fixed")+dm_Rdate_FPR(ENRLDATE,Y,"random",10)</code><br />
<br />
means FPR regression with intercept, main effects for 'AGECAT' and 'HIV', and TPRS
bases for 'ENRLDATE' using 10 knots placed at 10 equal-probability-spaced sample quantiles.</p>
</td></tr>
<tr><td><code id="dm_Rdate_FPR_+3A_num_knots_fpr">num_knots_FPR</code></td>
<td>
<p>number of knots for FPR regression; default is <code>NULL</code>
to accommodate fixed effect specification.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Design matrix for FPR regression:
</p>

<ul>
<li> <p><code>Z_FPR_ctrl</code> transformed design matrix for FPR regression for controls
</p>
</li>
<li> <p><code>Z_FPR_case</code> transformed design matrix for borrowing FPR
regression from controls to cases. It is obtained using control-standardization,
and square-root the following matrix (<code class="reqn">\Omega</code>]) with (<code class="reqn">j_1</code>,<code class="reqn">j_2</code>) element being
</p>
<p style="text-align: center;"><code class="reqn">\Omega_{j_1j_2}=\|knots_{j_1}-knots_{j_2}\|^3</code>
</p>
<p>.
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+nplcm">nplcm()</a></code>
</p>

<hr>
<h2 id='expit'>expit function</h2><span id='topic+expit'></span>

<h3>Description</h3>

<p>expit function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expit(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="expit_+3A_x">x</code></td>
<td>
<p>A real number</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a Probability between 0 and 1
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
expit(-0.1)

</code></pre>

<hr>
<h2 id='extract_data_raw'>Import Raw PERCH Data
<code>extract_data_raw</code> imports and converts the raw data to analyzable format</h2><span id='topic+extract_data_raw'></span>

<h3>Description</h3>

<p>Import Raw PERCH Data
</p>
<p><code>extract_data_raw</code> imports and converts the raw data to analyzable format
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_data_raw(
  dat_prepared,
  strat_nm,
  strat_val,
  meas_object,
  extra_covariates = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extract_data_raw_+3A_dat_prepared">dat_prepared</code></td>
<td>
<p>The data set prepared in <code>clean_perch_data</code>.</p>
</td></tr>
<tr><td><code id="extract_data_raw_+3A_strat_nm">strat_nm</code></td>
<td>
<p>The vector of covariate names to separately extract data.
For example, in PERCH data cleaning, <code>X = c("newSITE","CASECONT")</code>.</p>
</td></tr>
<tr><td><code id="extract_data_raw_+3A_strat_val">strat_val</code></td>
<td>
<p>The list of covariate values to stratify data.
Each element corresponds to elements in <code>X</code>. For example, in PERCH
data cleaning, <code>Xval = list("02GAM","1")</code>.</p>
</td></tr>
<tr><td><code id="extract_data_raw_+3A_meas_object">meas_object</code></td>
<td>
<p>A list of bronze-standard or silver-standard measurement
objects made by function <code><a href="#topic+make_meas_object">make_meas_object()</a></code>.</p>
</td></tr>
<tr><td><code id="extract_data_raw_+3A_extra_covariates">extra_covariates</code></td>
<td>
<p>The vector of covariate name for regression purposes.
The default is NULL, which means not reading in any covariate.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of data.
</p>

<dl>
<dt>Mobs</dt><dd>

<dl>
<dt>MBS</dt><dd><p> A list of Bronze-Standard (BrS) measurements.
The names of the list take the form of <code>specimen</code>_<code>test</code>.
Each element of the list is a data frame. The rows of the data frame
are for subjects; the columns are for measured pathogens.</p>
</dd>
<dt>MSS</dt><dd><p> A list of Silver-Standard (SS) measurements.
The formats are the same as <code>MBS</code> above.</p>
</dd>
<dt>MGS</dt><dd><p> A list of Gold-Standard (GS) measurements.
It equals <code>NULL</code> if no GS data exist.</p>
</dd>
</dl>

</dd>
<dt>X</dt><dd><p> A data frame with columns specified by <code>extra_covariates</code>.</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+clean_perch_data">clean_perch_data()</a></code>
</p>
<p>Other raw data importing functions: 
<code><a href="#topic+read_meas_object">read_meas_object</a>()</code>
</p>

<hr>
<h2 id='get_coverage'>Obtain coverage status from a result folder</h2><span id='topic+get_coverage'></span>

<h3>Description</h3>

<p>Obtain coverage status from a result folder
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_coverage(DIR_NPLCM, truth)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_coverage_+3A_dir_nplcm">DIR_NPLCM</code></td>
<td>
<p>Path to where Bayesian results are stored</p>
</td></tr>
<tr><td><code id="get_coverage_+3A_truth">truth</code></td>
<td>
<p>True etiologic fraction vector (must sum to 1)  used to generate data.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A logic vector of length as <code>truth</code>. 1 for covered; 0 for not.
</p>

<hr>
<h2 id='get_direct_bias'>Obtain direct bias that measure the discrepancy of a posterior
distribution of pie and a true pie.</h2><span id='topic+get_direct_bias'></span>

<h3>Description</h3>

<p>Obtain direct bias that measure the discrepancy of a posterior
distribution of pie and a true pie.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_direct_bias(DIR_list, truth = NULL, silent = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_direct_bias_+3A_dir_list">DIR_list</code></td>
<td>
<p>The list of  where Bayesian results are stored</p>
</td></tr>
<tr><td><code id="get_direct_bias_+3A_truth">truth</code></td>
<td>
<p>True etiologic fraction vector (must sum to 1)  used to generate data;
Default is <code>NULL</code>. If a vector is supplied, then only the first path in <code>DIR_LIST</code>
is used.</p>
</td></tr>
<tr><td><code id="get_direct_bias_+3A_silent">silent</code></td>
<td>
<p>Default is FALSE. To suppress printing messages, set to TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of length two. <code>diff</code> is the direct differences;
<code>prb</code> is the percent relative bias.
</p>

<hr>
<h2 id='get_fitted_mean_nested'>get fitted mean for nested model with subclass mixing weights that are the same among cases</h2><span id='topic+get_fitted_mean_nested'></span>

<h3>Description</h3>

<p>get fitted mean for nested model with subclass mixing weights that are the same among cases
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_fitted_mean_nested(
  slice,
  res_nplcm,
  model_options,
  data_nplcm,
  clean_options
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_fitted_mean_nested_+3A_slice">slice</code></td>
<td>
<p>the slice of BrS data that are modeled</p>
</td></tr>
<tr><td><code id="get_fitted_mean_nested_+3A_res_nplcm">res_nplcm</code></td>
<td>
<p>matrix of MCMC samples</p>
</td></tr>
<tr><td><code id="get_fitted_mean_nested_+3A_model_options">model_options</code></td>
<td>
<p>see <code><a href="#topic+nplcm">nplcm()</a></code></p>
</td></tr>
<tr><td><code id="get_fitted_mean_nested_+3A_data_nplcm">data_nplcm</code></td>
<td>
<p>see <code><a href="#topic+nplcm">nplcm()</a></code></p>
</td></tr>
<tr><td><code id="get_fitted_mean_nested_+3A_clean_options">clean_options</code></td>
<td>
<p>see <code><a href="#topic+clean_perch_data">clean_perch_data()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a matrix of no. of rows equal to retained MCMC samples, no. of columns
equal to the no. of measurement dimensions within a slice.
</p>

<hr>
<h2 id='get_fitted_mean_no_nested'>get model fitted mean for conditional independence model</h2><span id='topic+get_fitted_mean_no_nested'></span>

<h3>Description</h3>

<p>get model fitted mean for conditional independence model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_fitted_mean_no_nested(
  slice,
  res_nplcm,
  model_options,
  data_nplcm,
  clean_options
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_fitted_mean_no_nested_+3A_slice">slice</code></td>
<td>
<p>the slice of BrS data that are modeled</p>
</td></tr>
<tr><td><code id="get_fitted_mean_no_nested_+3A_res_nplcm">res_nplcm</code></td>
<td>
<p>matrix of MCMC samples</p>
</td></tr>
<tr><td><code id="get_fitted_mean_no_nested_+3A_model_options">model_options</code></td>
<td>
<p>see <code><a href="#topic+nplcm">nplcm()</a></code></p>
</td></tr>
<tr><td><code id="get_fitted_mean_no_nested_+3A_data_nplcm">data_nplcm</code></td>
<td>
<p>see <code><a href="#topic+nplcm">nplcm()</a></code></p>
</td></tr>
<tr><td><code id="get_fitted_mean_no_nested_+3A_clean_options">clean_options</code></td>
<td>
<p>see <code><a href="#topic+clean_perch_data">clean_perch_data()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list with model fitted means
</p>

<hr>
<h2 id='get_individual_data'>get individual data</h2><span id='topic+get_individual_data'></span>

<h3>Description</h3>

<p>get individual data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_individual_data(i, data_nplcm)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_individual_data_+3A_i">i</code></td>
<td>
<p>index of individual as appeared in <code>data_nplcm</code></p>
</td></tr>
<tr><td><code id="get_individual_data_+3A_data_nplcm">data_nplcm</code></td>
<td>
<p>the data for nplcm; see <code><a href="#topic+nplcm">nplcm()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of the same structure as <code>data_nplcm</code>; just with one row of values
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(data_nplcm_noreg)
get_individual_data(2,data_nplcm_noreg)

</code></pre>

<hr>
<h2 id='get_individual_prediction'>get individual prediction (Bayesian posterior)</h2><span id='topic+get_individual_prediction'></span>

<h3>Description</h3>

<p>must set <code>individual.pred = TRUE</code> in MCMC options (see the example of this
function)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_individual_prediction(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_individual_prediction_+3A_x">x</code></td>
<td>
<p>an <code>nplcm</code> object; it contains the file path <code>DIR_NPLCM</code>
to where the model results and specifications are stored. The function
first reads a list from this folder by <code><a href="#topic+nplcm_read_folder">nplcm_read_folder()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a matrix of individual predictions; rows for cases, columns for causes
specified in <code>model_options$likelihood$cause_list</code>; See <code><a href="#topic+nplcm">nplcm()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(data_nplcm_noreg)
cause_list &lt;- LETTERS[1:6]
J.BrS      &lt;- 6
model_options_no_reg &lt;- list(
  likelihood   = list(
    cause_list = cause_list,
    k_subclass = 2,
    Eti_formula = ~-1, # no covariate for the etiology regression
    FPR_formula = list(
      MBS1 =   ~-1)    # no covariate for the subclass weight regression
  ),
  use_measurements = c("BrS"), 
  # use bronze-standard data only for model estimation.
  prior= list(
    Eti_prior = overall_uniform(1,cause_list), 
    # Dirichlet(1,...,1) prior for the etiology.
    TPR_prior  = list(BrS = list(
      info  = "informative", # informative prior for TPRs
      input = "match_range", 
      # specify the informative prior for TPRs by specifying a plausible range.
      val = list(MBS1 = list(up =  list(rep(0.99,J.BrS)), 
                             # upper ranges: matched to 97.5% quantile of a Beta prior
                             low = list(rep(0.55,J.BrS))))
      # lower ranges: matched to 2.5% quantile of a Beta prior
    )
    )
  )
)     


set.seed(1)
# include stratification information in file name:
thedir    &lt;- paste0(tempdir(),"_no_reg")

# create folders to store the model results 
dir.create(thedir, showWarnings = FALSE)
result_folder_no_reg &lt;- file.path(thedir,paste("results",collapse="_"))
thedir &lt;- result_folder_no_reg
dir.create(thedir, showWarnings = FALSE)

# options for MCMC chains:
mcmc_options_no_reg &lt;- list(
  debugstatus = TRUE,
  n.chains = 1,
  n.itermcmc = as.integer(200), 
  n.burnin = as.integer(100), 
  n.thin = 1,
  individual.pred = TRUE, # &lt;- must set to TRUE! 
  ppd = FALSE,
  result.folder = thedir,
  bugsmodel.dir = thedir
)

BrS_object_1 &lt;- make_meas_object(patho = LETTERS[1:6], 
                                 specimen = "MBS", test = "1", 
                                 quality = "BrS", cause_list = cause_list)
clean_options &lt;- list(BrS_objects = make_list(BrS_object_1))
# place the nplcm data and cleaning options into the results folder
dput(data_nplcm_noreg,file.path(thedir,"data_nplcm.txt")) 
dput(clean_options, file.path(thedir, "data_clean_options.txt"))

rjags::load.module("glm")

fitted_nplcm_noreg &lt;- nplcm(data_nplcm_noreg,model_options_no_reg,mcmc_options_no_reg)
image(get_individual_prediction(fitted_nplcm_noreg))




</code></pre>

<hr>
<h2 id='get_latent_seq'>get index of latent status</h2><span id='topic+get_latent_seq'></span>

<h3>Description</h3>

<p>get index of latent status
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_latent_seq(cause_list, ord, select_latent = NULL, exact = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_latent_seq_+3A_cause_list">cause_list</code></td>
<td>
<p>see mode_options in <code><a href="#topic+nplcm">nplcm()</a></code></p>
</td></tr>
<tr><td><code id="get_latent_seq_+3A_ord">ord</code></td>
<td>
<p>order of cause_list according to posterior mean</p>
</td></tr>
<tr><td><code id="get_latent_seq_+3A_select_latent">select_latent</code></td>
<td>
<p>Default is NULL</p>
</td></tr>
<tr><td><code id="get_latent_seq_+3A_exact">exact</code></td>
<td>
<p>Default is TRUE</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector of indices
</p>

<hr>
<h2 id='get_marginal_rates_nested'>get marginal TPR and FPR for nested model</h2><span id='topic+get_marginal_rates_nested'></span>

<h3>Description</h3>

<p>get marginal TPR and FPR for nested model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_marginal_rates_nested(slice, res_nplcm, model_options, data_nplcm)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_marginal_rates_nested_+3A_slice">slice</code></td>
<td>
<p>the slice of BrS data that are modeled</p>
</td></tr>
<tr><td><code id="get_marginal_rates_nested_+3A_res_nplcm">res_nplcm</code></td>
<td>
<p>matrix of MCMC samples</p>
</td></tr>
<tr><td><code id="get_marginal_rates_nested_+3A_model_options">model_options</code></td>
<td>
<p>see <code><a href="#topic+nplcm">nplcm()</a></code></p>
</td></tr>
<tr><td><code id="get_marginal_rates_nested_+3A_data_nplcm">data_nplcm</code></td>
<td>
<p>see <code><a href="#topic+nplcm">nplcm()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a matrix of no. of rows equal to retained MCMC samples, no. of columns
equal to the no. of measurement dimensions within a slice.
</p>

<hr>
<h2 id='get_marginal_rates_no_nested'>get marginal TPR and FPR for no nested model</h2><span id='topic+get_marginal_rates_no_nested'></span>

<h3>Description</h3>

<p>get marginal TPR and FPR for no nested model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_marginal_rates_no_nested(slice, res_nplcm, model_options, data_nplcm)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_marginal_rates_no_nested_+3A_slice">slice</code></td>
<td>
<p>the slice of BrS data that are modeled</p>
</td></tr>
<tr><td><code id="get_marginal_rates_no_nested_+3A_res_nplcm">res_nplcm</code></td>
<td>
<p>matrix of MCMC samples</p>
</td></tr>
<tr><td><code id="get_marginal_rates_no_nested_+3A_model_options">model_options</code></td>
<td>
<p>see <code><a href="#topic+nplcm">nplcm()</a></code></p>
</td></tr>
<tr><td><code id="get_marginal_rates_no_nested_+3A_data_nplcm">data_nplcm</code></td>
<td>
<p>see <code><a href="#topic+nplcm">nplcm()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a matrix of no. of rows equal to retained MCMC samples, no. of columns
equal to the no. of measurement dimensions within a slice.
</p>

<hr>
<h2 id='get_metric'>Obtain Integrated Squared Aitchison Distance, Squared Bias and Variance (both on
Central Log-Ratio transformed scale) that measure the discrepancy of a posterior
distribution of pie and a true pie.</h2><span id='topic+get_metric'></span>

<h3>Description</h3>

<p>The result is equivalent to Euclidean-type calculation after the
compositional vector (e.g., etiologic fraction) is centered-log-ratio (CLRB) transformed.
For simulation only.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_metric(DIR_NPLCM, truth)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_metric_+3A_dir_nplcm">DIR_NPLCM</code></td>
<td>
<p>File path where Bayesian results are stored</p>
</td></tr>
<tr><td><code id="get_metric_+3A_truth">truth</code></td>
<td>
<p>True etiologic fraction vector (must sum to 1)
used to generate data</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector of (Integrated Squared Aitchison Distance (ISAD), bias-squared, variance, truth)
</p>

<hr>
<h2 id='get_pEti_samp'>get etiology samples by names (no regression)</h2><span id='topic+get_pEti_samp'></span>

<h3>Description</h3>

<p>get etiology samples by names (no regression)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_pEti_samp(res_nplcm, model_options)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_pEti_samp_+3A_res_nplcm">res_nplcm</code></td>
<td>
<p>result from model fits</p>
</td></tr>
<tr><td><code id="get_pEti_samp_+3A_model_options">model_options</code></td>
<td>
<p>model specification</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list:
</p>

<p><code>pEti_mat</code>: a matrix of posterior samples (iteration by cause); overall etiology
<code>latent_nm</code>: a vector of character strings representing the names of the causes

</p>

<hr>
<h2 id='get_plot_num'>get the plotting positions (numeric) for the fitted means; 3 positions for each cell</h2><span id='topic+get_plot_num'></span>

<h3>Description</h3>

<p>get the plotting positions (numeric) for the fitted means; 3 positions for each cell
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_plot_num(e, height)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_plot_num_+3A_e">e</code></td>
<td>
<p>Integer index from 1 to length(cause_list)</p>
</td></tr>
<tr><td><code id="get_plot_num_+3A_height">height</code></td>
<td>
<p>the total number of causes</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a triple with numerical plotting positions
</p>

<hr>
<h2 id='get_plot_pos'>get a list of measurement index where to look for data</h2><span id='topic+get_plot_pos'></span>

<h3>Description</h3>

<p>get a list of measurement index where to look for data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_plot_pos(template)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_plot_pos_+3A_template">template</code></td>
<td>
<p>See <code><a href="#topic+nplcm">nplcm()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of index vectors
</p>

<hr>
<h2 id='get_postsd'>Obtain posterior standard deviation from a result folder</h2><span id='topic+get_postsd'></span>

<h3>Description</h3>

<p>Obtain posterior standard deviation from a result folder
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_postsd(DIR_NPLCM)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_postsd_+3A_dir_nplcm">DIR_NPLCM</code></td>
<td>
<p>Path to where Bayesian results are stored</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector of positive numbers
</p>

<hr>
<h2 id='get_top_pattern'>get top patterns from a slice of bronze-standard measurement</h2><span id='topic+get_top_pattern'></span>

<h3>Description</h3>

<p>get top patterns from a slice of bronze-standard measurement
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_top_pattern(BrS_dat, Y, case_status, n_pat, exclude_missing = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_top_pattern_+3A_brs_dat">BrS_dat</code></td>
<td>
<p>bronze-standard data, which is usually <code>data_nplcm$Mobs$MBS[[1]]</code></p>
</td></tr>
<tr><td><code id="get_top_pattern_+3A_y">Y</code></td>
<td>
<p>A vector of case/control status: 1 for case; 0 for control</p>
</td></tr>
<tr><td><code id="get_top_pattern_+3A_case_status">case_status</code></td>
<td>
<p>1 for case; 0 for controls</p>
</td></tr>
<tr><td><code id="get_top_pattern_+3A_n_pat">n_pat</code></td>
<td>
<p>the number of top patterns one wants to show</p>
</td></tr>
<tr><td><code id="get_top_pattern_+3A_exclude_missing">exclude_missing</code></td>
<td>
<p>DEFAULT is TRUE for excluding any individual with missing measurements.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of results: <code>obs_pat</code> - observed rates;
<code>pattern_names</code>; <code>exist_other</code> - if
actual no. of patterns is larger than <code>n_pat</code>; <code>N</code>- No. of individuals
with <code>Y = case_status</code>.
</p>


<h3>See Also</h3>

<p>Other exploratory data analysis functions: 
<code><a href="#topic+plot_logORmat">plot_logORmat</a>()</code>,
<code><a href="#topic+show_individual">show_individual</a>()</code>,
<code><a href="#topic+summarize_BrS">summarize_BrS</a>()</code>,
<code><a href="#topic+summarize_SS">summarize_SS</a>()</code>,
<code><a href="#topic+visualize_season">visualize_season</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(data_nplcm_noreg)
get_top_pattern(data_nplcm_noreg$Mobs$MBS[[1]],data_nplcm_noreg$Y,1,5,FALSE)

data(data_nplcm_noreg)
get_top_pattern(data_nplcm_noreg$Mobs$MBS$MBS1,data_nplcm_noreg$Y,case_status=1,n_pat=5)


</code></pre>

<hr>
<h2 id='H'>Shannon entropy for multivariate discrete data</h2><span id='topic+H'></span>

<h3>Description</h3>

<p>Shannon entropy for multivariate discrete data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>H(px)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="H_+3A_px">px</code></td>
<td>
<p>a vector of positive numbers sum to 1</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a non-negative number
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
H(c(0.5,0.3,0.2))

</code></pre>

<hr>
<h2 id='has_non_basis'>test if a formula has terms not created by [s_date_Eti() or <code><a href="#topic+s_date_FPR">s_date_FPR()</a></code></h2><span id='topic+has_non_basis'></span>

<h3>Description</h3>

<p>test if a formula has terms not created by [s_date_Eti() or <code><a href="#topic+s_date_FPR">s_date_FPR()</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>has_non_basis(form)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="has_non_basis_+3A_form">form</code></td>
<td>
<p>a formula</p>
</td></tr>
</table>


<h3>Value</h3>

<p>logical <code>TRUE</code> (if having terms not created by [s_date_Eti() or <code><a href="#topic+s_date_FPR">s_date_FPR()</a></code>);
<code>FALSE</code> otherwise.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>form1 &lt;- as.formula(~ -1+s_date_FPR(DATE,Y,basis = "ps",10) + as.factor(SITE))
form2 &lt;- as.formula(~ -1+s_date_FPR(DATE,Y,basis = "ps",10))
form3 &lt;- as.formula(~ s_date_FPR(DATE,Y,basis = "ps",10))

has_non_basis(form1)
has_non_basis(form2)
has_non_basis(form3)

</code></pre>

<hr>
<h2 id='I2symb'>Convert 0/1 coding to pathogen/combinations</h2><span id='topic+I2symb'></span>

<h3>Description</h3>

<p>Reverse to <code><a href="#topic+symb2I">symb2I()</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>I2symb(binary_code, pathogen_list)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="I2symb_+3A_binary_code">binary_code</code></td>
<td>
<p>Binary indicators for pathogens</p>
</td></tr>
<tr><td><code id="I2symb_+3A_pathogen_list">pathogen_list</code></td>
<td>
<p>The complete list of pathogen names</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The name of pathogen or pathogen combination indicated by &quot;code&quot;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>I2symb("001",c("A","B","C"))
I2symb("000",c("A","B","C"))

</code></pre>

<hr>
<h2 id='Imat2cat'>Convert a matrix of binary indicators to categorical variables</h2><span id='topic+Imat2cat'></span>

<h3>Description</h3>

<p>Convert a matrix of binary indicators to categorical variables
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Imat2cat(binary_mat, cause_list, pathogen_list)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Imat2cat_+3A_binary_mat">binary_mat</code></td>
<td>
<p>The matrix of binary indicators. Rows for subjects, columns for pathogens in the <code>"pathogen.list"</code></p>
</td></tr>
<tr><td><code id="Imat2cat_+3A_cause_list">cause_list</code></td>
<td>
<p>The list of causes</p>
</td></tr>
<tr><td><code id="Imat2cat_+3A_pathogen_list">pathogen_list</code></td>
<td>
<p>The complete list of pathogen names</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of categorical variables. Its length equals the length of <code>"allowed.list"</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
Imat2cat(rbind(diag(3),c(1,1,0),c(0,0,0)),c("A","B","C","A+B","NoA"),c("A","B","C"))
</code></pre>

<hr>
<h2 id='init_latent_jags_multipleSS'>Initialize individual latent status (for <code>JAGS</code>)</h2><span id='topic+init_latent_jags_multipleSS'></span>

<h3>Description</h3>

<p>Initialize individual latent status (for <code>JAGS</code>)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>init_latent_jags_multipleSS(
  MSS_list,
  cause_list,
  patho = unlist(lapply(MSS_list, colnames))
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="init_latent_jags_multipleSS_+3A_mss_list">MSS_list</code></td>
<td>
<p>A list of silver-standard measurement data, possibly with more than one
slices; see <code>data_nplcm</code> argument in <code><a href="#topic+nplcm">nplcm()</a></code></p>
</td></tr>
<tr><td><code id="init_latent_jags_multipleSS_+3A_cause_list">cause_list</code></td>
<td>
<p>See <code>model_options</code> arguments in <code><a href="#topic+nplcm">nplcm()</a></code></p>
</td></tr>
<tr><td><code id="init_latent_jags_multipleSS_+3A_patho">patho</code></td>
<td>
<p>A vector of measured pathogen name for <code>MSS</code>;
default is <code>colnames(MSS)</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>In <code>JAGS</code> 3.4.0, if an initial value contradicts the probabilistic specification, e.g.
<code>MSS_1[i,j] ~ dbern(mu_ss_1[i,j])</code>, where <code>MSS_1[i,j]=1</code> but <code>mu_ss_1[i,j]=0</code>,
then <code>JAGS</code> cannot understand it. In PERCH application, this is most likely used when the specificity of the
silver-standard data is <code>1</code>. Note: this is not a problem in <code>WinBUGS</code>.
</p>


<h3>Value</h3>

<p>a list of numbers, indicating categories of individual latent causes.
</p>

<hr>
<h2 id='insert_bugfile_chunk_noreg_etiology'>insert distribution for latent status code chunk into .bug file</h2><span id='topic+insert_bugfile_chunk_noreg_etiology'></span>

<h3>Description</h3>

<p>insert distribution for latent status code chunk into .bug file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>insert_bugfile_chunk_noreg_etiology(ppd = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="insert_bugfile_chunk_noreg_etiology_+3A_ppd">ppd</code></td>
<td>
<p>Default is NULL; set to TRUE for posterior predictive checking</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a long character string to be inserted into .bug model file
as distribution specification for latent status
</p>

<hr>
<h2 id='insert_bugfile_chunk_noreg_meas'>Insert measurement likelihood (without regression) code chunks into .bug model file</h2><span id='topic+insert_bugfile_chunk_noreg_meas'></span>

<h3>Description</h3>

<p>Insert measurement likelihood (without regression) code chunks into .bug model file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>insert_bugfile_chunk_noreg_meas(
  k_subclass,
  Mobs,
  prior,
  cause_list,
  use_measurements = "BrS",
  ppd = NULL,
  use_jags = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="insert_bugfile_chunk_noreg_meas_+3A_k_subclass">k_subclass</code></td>
<td>
<p>the number of subclasses for the slices that require
conditional dependence modeling (only applicable to BrS data); its length is
of the same value as the number of BrS slices.</p>
</td></tr>
<tr><td><code id="insert_bugfile_chunk_noreg_meas_+3A_mobs">Mobs</code></td>
<td>
<p>measurement data in the form of <code>data_nplcm</code></p>
</td></tr>
<tr><td><code id="insert_bugfile_chunk_noreg_meas_+3A_prior">prior</code></td>
<td>
<p>prior specification from <code>model_options</code></p>
</td></tr>
<tr><td><code id="insert_bugfile_chunk_noreg_meas_+3A_cause_list">cause_list</code></td>
<td>
<p>a list of latent status names (crucial for building templates;
see <code><a href="#topic+make_template">make_template()</a></code>)</p>
</td></tr>
<tr><td><code id="insert_bugfile_chunk_noreg_meas_+3A_use_measurements">use_measurements</code></td>
<td>
<p>&quot;BrS&quot;, or &quot;SS&quot;</p>
</td></tr>
<tr><td><code id="insert_bugfile_chunk_noreg_meas_+3A_ppd">ppd</code></td>
<td>
<p>Default is NULL; set to TRUE for posterior predictive checking</p>
</td></tr>
<tr><td><code id="insert_bugfile_chunk_noreg_meas_+3A_use_jags">use_jags</code></td>
<td>
<p>Default is FALSE; set to TRUE if want to use JAGS for model fitting.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a long character string to be inserted into .bug model file as measurement
likelihood
</p>


<h3>See Also</h3>

<p>It is used in <a href="#topic+write_model_NoReg">write_model_NoReg</a> for constructing a .bug file along with
specification of latent status distribution (<a href="#topic+insert_bugfile_chunk_noreg_etiology">insert_bugfile_chunk_noreg_etiology</a>)
</p>

<hr>
<h2 id='insert_bugfile_chunk_reg_discrete_predictor_etiology'>insert etiology regression for latent status code chunk into .bug file; discrete predictors</h2><span id='topic+insert_bugfile_chunk_reg_discrete_predictor_etiology'></span>

<h3>Description</h3>

<p>insert etiology regression for latent status code chunk into .bug file; discrete predictors
</p>


<h3>Usage</h3>

<pre><code class='language-R'>insert_bugfile_chunk_reg_discrete_predictor_etiology(Jcause, ppd = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="insert_bugfile_chunk_reg_discrete_predictor_etiology_+3A_jcause">Jcause</code></td>
<td>
<p>The number of distinct causes, i.e., categories of latent health
status; equals <code>length(model_options$likelihood$cause_list)</code>.</p>
</td></tr>
<tr><td><code id="insert_bugfile_chunk_reg_discrete_predictor_etiology_+3A_ppd">ppd</code></td>
<td>
<p>Default is NULL; set to TRUE for posterior predictive checking</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a long character string to be inserted into .bug model file
as distribution specification for latent status
</p>

<hr>
<h2 id='insert_bugfile_chunk_reg_discrete_predictor_nonest_meas'>Insert measurement likelihood (with regression; discrete) code chunks into .bug model file</h2><span id='topic+insert_bugfile_chunk_reg_discrete_predictor_nonest_meas'></span>

<h3>Description</h3>

<p>Insert measurement likelihood (with regression; discrete) code chunks into .bug model file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>insert_bugfile_chunk_reg_discrete_predictor_nonest_meas(
  Mobs,
  prior,
  cause_list,
  use_measurements = "BrS",
  ppd = NULL,
  use_jags = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="insert_bugfile_chunk_reg_discrete_predictor_nonest_meas_+3A_mobs">Mobs</code></td>
<td>
<p>Measurement data in the form of <code>data_nplcm</code></p>
</td></tr>
<tr><td><code id="insert_bugfile_chunk_reg_discrete_predictor_nonest_meas_+3A_prior">prior</code></td>
<td>
<p>Prior specification from <code>model_options</code></p>
</td></tr>
<tr><td><code id="insert_bugfile_chunk_reg_discrete_predictor_nonest_meas_+3A_cause_list">cause_list</code></td>
<td>
<p>A list of latent status names (crucial for building templates;
see <code><a href="#topic+make_template">make_template()</a></code>)</p>
</td></tr>
<tr><td><code id="insert_bugfile_chunk_reg_discrete_predictor_nonest_meas_+3A_use_measurements">use_measurements</code></td>
<td>
<p>&quot;BrS&quot;, or &quot;SS&quot;</p>
</td></tr>
<tr><td><code id="insert_bugfile_chunk_reg_discrete_predictor_nonest_meas_+3A_ppd">ppd</code></td>
<td>
<p>Default is NULL; set to TRUE for posterior predictive checking</p>
</td></tr>
<tr><td><code id="insert_bugfile_chunk_reg_discrete_predictor_nonest_meas_+3A_use_jags">use_jags</code></td>
<td>
<p>Default is FALSE; set to TRUE if want to use JAGS for model fitting.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A long character string to be inserted into .bug model file as measurement
likelihood
</p>


<h3>See Also</h3>

<p>It is used in <a href="#topic+write_model_Reg_NoNest">write_model_Reg_NoNest</a> for constructing a .bug file along with
specification of latent status regression (<a href="#topic+insert_bugfile_chunk_reg_etiology">insert_bugfile_chunk_reg_etiology</a>)
</p>

<hr>
<h2 id='insert_bugfile_chunk_reg_etiology'>insert etiology regression for latent status code chunk into .bug file</h2><span id='topic+insert_bugfile_chunk_reg_etiology'></span>

<h3>Description</h3>

<p>insert etiology regression for latent status code chunk into .bug file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>insert_bugfile_chunk_reg_etiology(Eti_formula, Jcause, ppd = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="insert_bugfile_chunk_reg_etiology_+3A_eti_formula">Eti_formula</code></td>
<td>
<p>Etiology regression formula; Check <code>model_options$likelihood$Eti_formula</code>.</p>
</td></tr>
<tr><td><code id="insert_bugfile_chunk_reg_etiology_+3A_jcause">Jcause</code></td>
<td>
<p>The number of distinct causes, i.e., categories of latent health
status; equals <code>length(model_options$likelihood$cause_list)</code>.</p>
</td></tr>
<tr><td><code id="insert_bugfile_chunk_reg_etiology_+3A_ppd">ppd</code></td>
<td>
<p>Default is NULL; set to TRUE for posterior predictive checking</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a long character string to be inserted into .bug model file
as distribution specification for latent status
</p>

<hr>
<h2 id='insert_bugfile_chunk_reg_nest_meas'>Insert measurement likelihood (nested model+regression) code chunks into .bug model file</h2><span id='topic+insert_bugfile_chunk_reg_nest_meas'></span>

<h3>Description</h3>

<p>Insert measurement likelihood (nested model+regression) code chunks into .bug model file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>insert_bugfile_chunk_reg_nest_meas(
  Mobs,
  prior,
  cause_list,
  FPR_formula,
  use_measurements = "BrS",
  ppd = NULL,
  use_jags = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="insert_bugfile_chunk_reg_nest_meas_+3A_mobs">Mobs</code></td>
<td>
<p>Measurement data in the form of <code>data_nplcm</code></p>
</td></tr>
<tr><td><code id="insert_bugfile_chunk_reg_nest_meas_+3A_prior">prior</code></td>
<td>
<p>Prior specification from <code>model_options</code></p>
</td></tr>
<tr><td><code id="insert_bugfile_chunk_reg_nest_meas_+3A_cause_list">cause_list</code></td>
<td>
<p>A list of latent status names (crucial for building templates;
see <code><a href="#topic+make_template">make_template()</a></code>)</p>
</td></tr>
<tr><td><code id="insert_bugfile_chunk_reg_nest_meas_+3A_fpr_formula">FPR_formula</code></td>
<td>
<p>A list of FPR regression formula; check <code>model_options$likelihood$FPR_formula</code></p>
</td></tr>
<tr><td><code id="insert_bugfile_chunk_reg_nest_meas_+3A_use_measurements">use_measurements</code></td>
<td>
<p>&quot;BrS&quot;, or &quot;SS&quot;</p>
</td></tr>
<tr><td><code id="insert_bugfile_chunk_reg_nest_meas_+3A_ppd">ppd</code></td>
<td>
<p>Default is NULL; set to TRUE for posterior predictive checking</p>
</td></tr>
<tr><td><code id="insert_bugfile_chunk_reg_nest_meas_+3A_use_jags">use_jags</code></td>
<td>
<p>Default is FALSE; set to TRUE if want to use JAGS for model fitting.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A long character string to be inserted into .bug model file as measurement
likelihood
</p>


<h3>See Also</h3>

<p>Called by <a href="#topic+write_model_Reg_NoNest">write_model_Reg_NoNest</a> for constructing a <code>.bug</code> file.
This is usually called along with specification of latent status regression
(<a href="#topic+insert_bugfile_chunk_reg_etiology">insert_bugfile_chunk_reg_etiology</a>).
</p>

<hr>
<h2 id='insert_bugfile_chunk_reg_nonest_meas'>Insert measurement likelihood (with regression) code chunks into .bug model file</h2><span id='topic+insert_bugfile_chunk_reg_nonest_meas'></span>

<h3>Description</h3>

<p>Insert measurement likelihood (with regression) code chunks into .bug model file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>insert_bugfile_chunk_reg_nonest_meas(
  Mobs,
  prior,
  cause_list,
  FPR_formula,
  use_measurements = "BrS",
  ppd = NULL,
  use_jags = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="insert_bugfile_chunk_reg_nonest_meas_+3A_mobs">Mobs</code></td>
<td>
<p>Measurement data in the form of <code>data_nplcm</code></p>
</td></tr>
<tr><td><code id="insert_bugfile_chunk_reg_nonest_meas_+3A_prior">prior</code></td>
<td>
<p>Prior specification from <code>model_options</code></p>
</td></tr>
<tr><td><code id="insert_bugfile_chunk_reg_nonest_meas_+3A_cause_list">cause_list</code></td>
<td>
<p>A list of latent status names (crucial for building templates;
see <code><a href="#topic+make_template">make_template()</a></code>)</p>
</td></tr>
<tr><td><code id="insert_bugfile_chunk_reg_nonest_meas_+3A_fpr_formula">FPR_formula</code></td>
<td>
<p>A list of FPR regression formula; check <code>model_options$likelihood$FPR_formula</code></p>
</td></tr>
<tr><td><code id="insert_bugfile_chunk_reg_nonest_meas_+3A_use_measurements">use_measurements</code></td>
<td>
<p>&quot;BrS&quot;, or &quot;SS&quot;</p>
</td></tr>
<tr><td><code id="insert_bugfile_chunk_reg_nonest_meas_+3A_ppd">ppd</code></td>
<td>
<p>Default is NULL; set to TRUE for posterior predictive checking</p>
</td></tr>
<tr><td><code id="insert_bugfile_chunk_reg_nonest_meas_+3A_use_jags">use_jags</code></td>
<td>
<p>Default is FALSE; set to TRUE if want to use JAGS for model fitting.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A long character string to be inserted into .bug model file as measurement
likelihood
</p>


<h3>See Also</h3>

<p>It is used in <a href="#topic+write_model_Reg_NoNest">write_model_Reg_NoNest</a> for constructing a .bug file along with
specification of latent status regression (<a href="#topic+insert_bugfile_chunk_reg_etiology">insert_bugfile_chunk_reg_etiology</a>)
</p>

<hr>
<h2 id='is_discrete'>Check if covariates are discrete</h2><span id='topic+is_discrete'></span>

<h3>Description</h3>

<p><code>is_discrete</code> checks if the specified covariates could be regarded as discrete
variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is_discrete(X, X_reg)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is_discrete_+3A_x">X</code></td>
<td>
<p>A data frame of covariates</p>
</td></tr>
<tr><td><code id="is_discrete_+3A_x_reg">X_reg</code></td>
<td>
<p>The vector of covariates that will stratify the analyses. These
variables have to be categorical. Or a formula (can be tested by <code>is.formula</code> in <code>plyr</code>),
e.g., <code>~as.factor(SITE8) + as.factor(AGECAT &gt; 1)</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that this function should be used with caution. It used
</p>
<p style="text-align: center;"><code class="reqn">nrow(X)/nrow(unique(X[,X_reg,drop=FALSE]))&gt;10</code>
</p>
<p> as an <em>ad hoc</em> criterion.
It is not the same as <code>is.discrete()</code> in <code>plyr</code>
</p>


<h3>Value</h3>

<p><code>TRUE</code> for all being discrete; <code>FALSE</code> otherwise.
</p>

<hr>
<h2 id='is_intercept_only'>check if the formula is intercept only</h2><span id='topic+is_intercept_only'></span>

<h3>Description</h3>

<p>outputs logical values for a formula; to identify intercept-only formula.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is_intercept_only(form)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is_intercept_only_+3A_form">form</code></td>
<td>
<p>Regression formula</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>TRUE</code> for intercept-only; <code>FALSE</code> otherwise
</p>

<hr>
<h2 id='is_jags_folder'>See if a result folder is obtained by JAGS</h2><span id='topic+is_jags_folder'></span>

<h3>Description</h3>

<p>See if a result folder is obtained by JAGS
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is_jags_folder(DIR_NPLCM)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is_jags_folder_+3A_dir_nplcm">DIR_NPLCM</code></td>
<td>
<p>directory to the folder with results.
&quot;mcmc_options.txt&quot; must be in the folder.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>TRUE for from JAGS; FALSE otherwise.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
is_jags_folder(tempdir()) # just an illustration.

</code></pre>

<hr>
<h2 id='is_length_all_one'>check if a list has elements all of length one</h2><span id='topic+is_length_all_one'></span>

<h3>Description</h3>

<p>check if a list has elements all of length one
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is_length_all_one(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is_length_all_one_+3A_x">x</code></td>
<td>
<p>a list</p>
</td></tr>
</table>


<h3>Value</h3>

<p>TRUE or FALSE
</p>


<h3>Examples</h3>

<pre><code class='language-R'>l = list(a = 5, b = 1:2)
is_length_all_one(l) # FALSE
l = list(a = 5, b = 1)
is_length_all_one(l) # TRUE
</code></pre>

<hr>
<h2 id='is.error'>Test for 'try-error' class</h2><span id='topic+is.error'></span>

<h3>Description</h3>

<p>Test for 'try-error' class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.error(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is.error_+3A_x">x</code></td>
<td>
<p>An object to be test if it is &quot;try-error&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Logical. <code>TRUE</code> for &quot;try-error&quot;; <code>FALSE</code> otherwise
</p>


<h3>References</h3>

<p><a href="http://adv-r.had.co.nz/Exceptions-Debugging.html">http://adv-r.had.co.nz/Exceptions-Debugging.html</a>
</p>

<hr>
<h2 id='jags2_baker'>Run <code>JAGS</code> from R</h2><span id='topic+jags2_baker'></span>

<h3>Description</h3>

<p>The jags function takes data and starting values as input.
It automatically writes a jags script, calls the model, and saves the
simulations for easy access in R. Check the R2jags::jags2 for details about
the argument.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>jags2_baker(
  data,
  inits,
  parameters.to.save,
  model.file = "model.bug",
  n.chains = 3,
  n.iter = 2000,
  n.burnin = floor(n.iter/2),
  n.thin = max(1, floor((n.iter - n.burnin)/1000)),
  DIC = TRUE,
  jags.path = "",
  working.directory = NULL,
  clearWD = TRUE,
  refresh = n.iter/50
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="jags2_baker_+3A_data">data</code></td>
<td>
<p>(1) a vector or list of the names of the data objects used by
the model, (2) a (named) list of the data objects themselves, or
(3) the name of a &quot;dump&quot; format file containing the data objects,
which must end in &quot;.txt&quot;, see example below for details.</p>
</td></tr>
<tr><td><code id="jags2_baker_+3A_inits">inits</code></td>
<td>
<p>a list with <code>n.chains</code> elements; each element of the
list is itself a list of starting values for the <code>BUGS</code> model,
<em>or</em> a function creating (possibly random) initial values. If inits is
<code>NULL</code>, <code>JAGS</code> will generate initial values for parameters.</p>
</td></tr>
<tr><td><code id="jags2_baker_+3A_parameters.to.save">parameters.to.save</code></td>
<td>
<p>character vector of the names of the
parameters to save which should be monitored.</p>
</td></tr>
<tr><td><code id="jags2_baker_+3A_model.file">model.file</code></td>
<td>
<p>file containing the model written in <code>BUGS</code>
code. Alternatively, as in <span class="pkg">R2WinBUGS</span>, <code>model.file</code> can be an R
function that contains a <code>BUGS</code> model that is written to a
temporary model file (see <code><a href="base.html#topic+tempfile">tempfile</a></code>) using <code><a href="#topic+write.model">write.model</a></code></p>
</td></tr>
<tr><td><code id="jags2_baker_+3A_n.chains">n.chains</code></td>
<td>
<p>number of Markov chains (default: 3)</p>
</td></tr>
<tr><td><code id="jags2_baker_+3A_n.iter">n.iter</code></td>
<td>
<p>number of total iterations per chain (including burn in;
default: 2000)</p>
</td></tr>
<tr><td><code id="jags2_baker_+3A_n.burnin">n.burnin</code></td>
<td>
<p>length of burn in, i.e. number of iterations to
discard at the beginning. Default is <code>n.iter/2</code>, that is,
discarding the first half of the simulations. If n.burnin is 0,
<code>jags()</code> will run 100 iterations for adaption.</p>
</td></tr>
<tr><td><code id="jags2_baker_+3A_n.thin">n.thin</code></td>
<td>
<p>thinning rate. Must be a positive integer.  Set
<code>n.thin</code> &gt; 1 to save memory and computation time if
<code>n.iter</code> is large.  Default is <code>max(1, floor(n.chains *
    (n.iter-n.burnin) / 1000))</code> which will only thin if there are at
least 2000 simulations.</p>
</td></tr>
<tr><td><code id="jags2_baker_+3A_dic">DIC</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), compute deviance, pD,
and DIC. The rule <code>pD=var(deviance) / 2</code> is used.</p>
</td></tr>
<tr><td><code id="jags2_baker_+3A_jags.path">jags.path</code></td>
<td>
<p>directory that contains the <code>JAGS</code> executable.
The default is &ldquo;&rdquo;.  </p>
</td></tr>
<tr><td><code id="jags2_baker_+3A_working.directory">working.directory</code></td>
<td>
<p>sets working directory during execution of
this function; This should be the directory where model file is.</p>
</td></tr>
<tr><td><code id="jags2_baker_+3A_clearwd">clearWD</code></td>
<td>
<p>indicating whether the files &lsquo;<span class="file">data.txt</span>&rsquo;,
&lsquo;<span class="file">inits[1:n.chains].txt</span>&rsquo;, &lsquo;<span class="file">codaIndex.txt</span>&rsquo;, &lsquo;<span class="file">jagsscript.txt</span>&rsquo;,
and &lsquo;<span class="file">CODAchain[1:nchains].txt</span>&rsquo; should be removed after <code>jags</code> has
finished, default=TRUE.</p>
</td></tr>
<tr><td><code id="jags2_baker_+3A_refresh">refresh</code></td>
<td>
<p>refresh frequency for progress bar, default is <code>n.iter/50</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>This modifies the jags2 function in R2jags package.
</p>


<h3>Value</h3>

<p>Same as <code><a href="R2jags.html#topic+jags">R2jags::jags()</a></code>
</p>


<h3>See Also</h3>

<p><code><a href="R2jags.html#topic+jags">R2jags::jags()</a></code>
</p>

<hr>
<h2 id='line2user'>convert line to user coordinates</h2><span id='topic+line2user'></span>

<h3>Description</h3>

<p>Here's a version that works with log-scale and linear scale axes.
The trick is to express line locations in npc coordinates rather than user coordinates,
since the latter are of course not linear when axes are on log scales.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>line2user(line, side)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="line2user_+3A_line">line</code></td>
<td>
<p>integer</p>
</td></tr>
<tr><td><code id="line2user_+3A_side">side</code></td>
<td>
<p>integer; 1-4</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>par('cin')[2] * par('cex') * par('lheight')</code> returns the current line height
in inches, which we convert to user coordinates by multiplying by
<code>diff(grconvertX(0:1, 'inches', 'user'))</code>, the length of an inch in user
coordinates (horizontally, in this case - if interested in the vertical
height of a line in user coords we would use
<code style="white-space: pre;">&#8288;diff(grconvertY(0:1, 'inches', 'user')))&#8288;</code>.
</p>


<h3>Value</h3>

<p>a numeric vector of the same length as <code>line</code>;
the values represent the coordinates in the current plot
and are converted from <code>line</code>.
</p>


<h3>References</h3>

<p><a href="https://stackoverflow.com/questions/29125019/get-margin-line-locations-mgp-in-user-coordinates">https://stackoverflow.com/questions/29125019/get-margin-line-locations-mgp-in-user-coordinates</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

setup_plot &lt;- function(log = "") {
  oldpar &lt;- par(mar = c(2, 10, 2, 2), oma = rep(2, 4))
  plot.new()
  plot.window(xlim = c(1, 10), ylim = c(1, 10), log = log)
  box(which = "plot", lwd = 2, col = "gray40")
  box(which = "figure", lwd = 2, col = "darkred")
  box(which = "outer", lwd = 2, col = "darkgreen")
  text(x = 0.5, y = 0.5, 
       labels = "Plot Region", 
       col = "gray40", font = 2)
  mtext(side = 3, text = "Figure region", line = 0.5, col = "darkred", font = 2)
  mtext(side = 3, text = "Device region", line = 2.5, col = "darkgreen", font = 2)
  for (i in 0:9) {
    mtext(side = 2, col = "darkred", text = paste0("Line", i), line = i)
  }
  par(oldpar)
}
# And here are a couple of examples, applied to your setup_plot with mar=c(5, 5, 5, 5):
setup_plot()
axis(1, line=5)
axis(2, line=5)
abline(h=line2user(0:4, 1), lty=3, xpd=TRUE)
abline(v=line2user(0:4, 2), lty=3, xpd=TRUE)
abline(h=line2user(0:4, 3), lty=3, xpd=TRUE)
abline(v=line2user(0:4, 4), lty=3, xpd=TRUE)

setup_plot(log='x')
axis(1, line=5)
axis(2, line=5)
abline(h=line2user(0:4, 1), lty=3, xpd=TRUE)
abline(v=line2user(0:4, 2), lty=3, xpd=TRUE)
abline(h=line2user(0:4, 3), lty=3, xpd=TRUE)
abline(v=line2user(0:4, 4), lty=3, xpd=TRUE)


setup_plot(log='y')
axis(1, line=5)
axis(2, line=5)
abline(h=line2user(0:4, 1), lty=3, xpd=TRUE)
abline(v=line2user(0:4, 2), lty=3, xpd=TRUE)
abline(h=line2user(0:4, 3), lty=3, xpd=TRUE)
abline(v=line2user(0:4, 4), lty=3, xpd=TRUE)

setup_plot(log='xy')
axis(1, line=5)
axis(2, line=5)
abline(h=line2user(0:4, 1), lty=3, xpd=TRUE)
abline(v=line2user(0:4, 2), lty=3, xpd=TRUE)
abline(h=line2user(0:4, 3), lty=3, xpd=TRUE)
abline(v=line2user(0:4, 4), lty=3, xpd=TRUE)

</code></pre>

<hr>
<h2 id='loadOneName'>load an object from .RDATA file</h2><span id='topic+loadOneName'></span>

<h3>Description</h3>

<p>load an object from .RDATA file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loadOneName(objName, file, envir = parent.frame(), assign.on.exit = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="loadOneName_+3A_objname">objName</code></td>
<td>
<p>the name of the object</p>
</td></tr>
<tr><td><code id="loadOneName_+3A_file">file</code></td>
<td>
<p>the file path</p>
</td></tr>
<tr><td><code id="loadOneName_+3A_envir">envir</code></td>
<td>
<p>environment; default is calling environment: <a href="base.html#topic+parent.frame">parent.frame</a></p>
</td></tr>
<tr><td><code id="loadOneName_+3A_assign.on.exit">assign.on.exit</code></td>
<td>
<p>default is TRUE</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a new environment
</p>

<hr>
<h2 id='logit'>logit function</h2><span id='topic+logit'></span>

<h3>Description</h3>

<p>logit function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logit(p)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logit_+3A_p">p</code></td>
<td>
<p>Probability between 0 and 1</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A real number
</p>


<h3>Examples</h3>

<pre><code class='language-R'>logit(0.5)

</code></pre>

<hr>
<h2 id='logOR'>calculate pairwise log odds ratios</h2><span id='topic+logOR'></span>

<h3>Description</h3>

<p>Case at upper triangle; control at lower triangle
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logOR(MBS.case, MBS.ctrl)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logOR_+3A_mbs.case">MBS.case</code></td>
<td>
<p>Case Bronze-Standard (BrS) data; rows for case subjects;
columns contain <code>JBrS</code> measurements</p>
</td></tr>
<tr><td><code id="logOR_+3A_mbs.ctrl">MBS.ctrl</code></td>
<td>
<p>Control Bronze-Standard (BrS) data; rows for control subjects;
columns contain <code>JBrS</code> measurements</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of two elements: <code>logOR</code> (<code>JBrS</code> by <code>JBrS</code> matrix of log
odds ratios for each pair among <code>JBrS</code> measurements) and <code>logOR.se</code> (
same dimension as <code>logOR</code>, but representing the standard errors of the corresponding
estimated log odds ratios in <code>logOR</code>).
</p>

<hr>
<h2 id='logsumexp'>log sum exp trick</h2><span id='topic+logsumexp'></span>

<h3>Description</h3>

<p>log sum exp trick
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logsumexp(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logsumexp_+3A_x">x</code></td>
<td>
<p>a vector of numbers</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a numeric value
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
logsumexp(c(-20,-30))

</code></pre>

<hr>
<h2 id='lookup_quality'>Get position to store in data_nplcm$Mobs:</h2><span id='topic+lookup_quality'></span>

<h3>Description</h3>

<p>Get position to store in data_nplcm$Mobs:
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lookup_quality(quality_nm)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lookup_quality_+3A_quality_nm">quality_nm</code></td>
<td>
<p>names of quality: can be &quot;BrS&quot;, &quot;SS&quot; or &quot;GS&quot;</p>
</td></tr>
</table>


<h3>Details</h3>

<p>also works for a vector
</p>


<h3>Value</h3>

<p>position of the quality name: &quot;BrS&quot;-1; &quot;SS&quot;-2; &quot;GS&quot;-3.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+extract_data_raw">extract_data_raw()</a></code>
</p>

<hr>
<h2 id='make_filename'>Create new file name</h2><span id='topic+make_filename'></span>

<h3>Description</h3>

<p>Create new file name
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_filename(parameter_names, parameter_vals, format)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="make_filename_+3A_parameter_names">parameter_names</code></td>
<td>
<p>The parameters that distinguish this folder's scenario</p>
</td></tr>
<tr><td><code id="make_filename_+3A_parameter_vals">parameter_vals</code></td>
<td>
<p>The actual parameter values</p>
</td></tr>
<tr><td><code id="make_filename_+3A_format">format</code></td>
<td>
<p>The suffix &quot;.XXX&quot; in the end to specify the file format</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A string for file name
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
make_filename(c("theta","alpha"),c(0.9,2),"csv")

</code></pre>

<hr>
<h2 id='make_foldername'>Create new folder name</h2><span id='topic+make_foldername'></span>

<h3>Description</h3>

<p>Create new folder name
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_foldername(parent_path, parameter_names, parameter_vals, sep = "/")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="make_foldername_+3A_parent_path">parent_path</code></td>
<td>
<p>The parent directory where to put the new folder</p>
</td></tr>
<tr><td><code id="make_foldername_+3A_parameter_names">parameter_names</code></td>
<td>
<p>The parameters that distinguish this folder's scenario</p>
</td></tr>
<tr><td><code id="make_foldername_+3A_parameter_vals">parameter_vals</code></td>
<td>
<p>The actual parameter values</p>
</td></tr>
<tr><td><code id="make_foldername_+3A_sep">sep</code></td>
<td>
<p>file name separator - default to <code>"/"</code> for OSX; <code>"\\"</code> for Windows.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A string for folder name
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
make_foldername("/user",c("theta","alpha","beta"),c(1,2,3))


</code></pre>

<hr>
<h2 id='make_list'>Takes any number of R objects as arguments and returns a list whose names are
derived from the names of the R objects.</h2><span id='topic+make_list'></span>

<h3>Description</h3>

<p>Roger Peng's listlabeling challenge from
<a href="http://simplystatistics.tumblr.com/post/11988685443/computing-on-the-language">http://simplystatistics.tumblr.com/post/11988685443/computing-on-the-language</a>.
Code copied from <a href="https://gist.github.com/ajdamico/1329117/0134148987859856fcecbe4446cfd37e500e4272">https://gist.github.com/ajdamico/1329117/0134148987859856fcecbe4446cfd37e500e4272</a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_list(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="make_list_+3A_...">...</code></td>
<td>
<p>any R objects</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list as described above
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#create three example variables for a list
x &lt;- 1
y &lt;- 2
z &lt;- "hello"
#display the results
make_list( x , y , z )
</code></pre>

<hr>
<h2 id='make_meas_object'>Make measurement slice</h2><span id='topic+make_meas_object'></span>

<h3>Description</h3>

<p>Wrap the information about a particular type of measurement, e.g., NPPCR.
NB: add example! copy some from the vignette file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_meas_object(patho, specimen, test, quality, cause_list, sep_char = "_")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="make_meas_object_+3A_patho">patho</code></td>
<td>
<p>A vector of pathogen names</p>
</td></tr>
<tr><td><code id="make_meas_object_+3A_specimen">specimen</code></td>
<td>
<p>Specimen name</p>
</td></tr>
<tr><td><code id="make_meas_object_+3A_test">test</code></td>
<td>
<p>Test name</p>
</td></tr>
<tr><td><code id="make_meas_object_+3A_quality">quality</code></td>
<td>
<p>Quality category: any of &quot;BrS&quot;, &quot;SS&quot; or &quot;GS&quot;.</p>
</td></tr>
<tr><td><code id="make_meas_object_+3A_cause_list">cause_list</code></td>
<td>
<p>The vector of potential latent status</p>
</td></tr>
<tr><td><code id="make_meas_object_+3A_sep_char">sep_char</code></td>
<td>
<p>a character string that separate the pathogen names and the
specimen-test pair; Default to <code>"_"</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with measurement information
</p>

<ul>
<li><p><code>quality</code> same as argument
</p>
</li>
<li><p><code>patho</code> same as argument
</p>
</li>
<li><p><code>name_in_data</code> the names used in the raw data to locate these measurements
</p>
</li>
<li><p><code>template</code> a mapping from <code>patho</code> to <code>cause_list</code>.
<code>NROW = length(cause_list)+1</code>;
<code>NCOL = length(patho)</code>. This value is crucial in model fitting to determine
which measurements are informative of a particular category of latent status.
</p>
</li>
<li><p><code>specimen</code> same as argument
</p>
</li>
<li><p><code>test</code> same as argument
</p>
</li>
<li><p><code>nm_spec_test</code> paste <code>specimen</code> and <code>test</code> together
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+make_template">make_template()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>make_meas_object(
patho = c("A","B","C","D","E","F"), 
specimen = "MBS",
test = "1",
quality = "BrS", 
cause_list = c("A","B","C","D","E"))

</code></pre>

<hr>
<h2 id='make_numbered_list'>Make a list with numbered names</h2><span id='topic+make_numbered_list'></span>

<h3>Description</h3>

<p>To collect multiple measurements within the same category, e.g., bronze-standard.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_numbered_list(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="make_numbered_list_+3A_...">...</code></td>
<td>
<p>any R object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list with names numbered
</p>

<hr>
<h2 id='make_template'>make a mapping template for model fitting</h2><span id='topic+make_template'></span>

<h3>Description</h3>

<p><code>make_template</code> creates a mapping matrix (binary values). Each pathogen
in a measurement slice (e.g., nasal-pharyngeal PCR test) is mapped to inform
one category of latent status. All the possible categories (e.g., causes of pneumonia)
remain the same regardless of the measurement slice used (e.g., NPPCR or BCX).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_template(patho, cause_list)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="make_template_+3A_patho">patho</code></td>
<td>
<p>A vector of pathogen names for a particular measurement slice.
<code>patho</code> must be a substring of some elements in <code>cause_list</code>, e.g.,
&quot;PNEU&quot; is a substring of &quot;PNEU_VT13&quot;. Also see Examples for this function.</p>
</td></tr>
<tr><td><code id="make_template_+3A_cause_list">cause_list</code></td>
<td>
<p>A vector of characters; Potential categories of latent statuses.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The first argument has to be character substrings from the second argument.
For example, the two arguments can respectively be <code>"A"</code> and <code>"A_1"</code>,
or <code>"A"</code> and <code>"A+B"</code>.The second argument can have character strings not
matched in the first argument. If so, it means some causes of diseases are not
directly measured in the current measurement slice.
For each element of <code>patho</code>, the function matches from the start of the strings
of <code>cause_list</code>. Therefore, make sure that latent statuses from the same family
(e.g., &quot;PNEU_VT13&quot; and &quot;PNEU_NOVT13&quot;) need to start with the same family name
(e.g., &quot;PNEU&quot;) followed by subcategories (e.g., &quot;_VT13&quot; and &quot;_NOVT13&quot;).
</p>


<h3>Value</h3>

<p>a mapping from <code>patho</code> to <code>cause_list</code>.
<code>NROW = length(cause_list)+1</code>;
<code>NCOL = length(patho)</code>. This value is crucial in model fitting to determine
which measurements are informative of a particular category of latent status.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
cause_list &lt;- c("HINF","PNEU_VT13","PNEU_NOVT13","SAUR","HMPV_A_B","FLU_A",
"PARA_1","PARA_3","PARA_4","PV_EV","RHINO","RSV", "ENTRB","TB")

patho_BrS_NPPCR &lt;- c("HINF","PNEU","SAUR","HMPV_A_B","FLU_A","PARA_1",
"PARA_3","PARA_4","PV_EV","RHINO","RSV")
make_template(patho_BrS_NPPCR,cause_list)


 cause = c("A","B1","B2","C","A+C","B+C")
 patho = c("A","B","C")
 make_template(patho,cause)
 
 cause = c("A","B1","B2","C","A+C","B+C","other")
 patho = c("A","B","C")
 make_template(patho,cause)
 
 
 cause = c("A","B1","B2","X_B","Y_B","C","A+C","B+C","other")
 patho = c("A","B","C","X_B","Y_B")
 make_template(patho,cause)
 
 
</code></pre>

<hr>
<h2 id='marg_H'>Shannon entropy for binary data</h2><span id='topic+marg_H'></span>

<h3>Description</h3>

<p>Shannon entropy for binary data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>marg_H(m_px)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="marg_H_+3A_m_px">m_px</code></td>
<td>
<p>a number between 0 and 1</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a non-negative number
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
marg_H(0.1)

</code></pre>

<hr>
<h2 id='match_cause'>Match latent causes that might have the same combo but
different specifications</h2><span id='topic+match_cause'></span>

<h3>Description</h3>

<p>@details In our cause_list, &quot;A+B&quot; represents the same cause
as &quot;B+A&quot;. It is used for plotting side-by-side posterior sample comparisons
</p>


<h3>Usage</h3>

<pre><code class='language-R'>match_cause(pattern, vec)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="match_cause_+3A_pattern">pattern</code></td>
<td>
<p>a vector of latent cause names, e.g., from a particular fit</p>
</td></tr>
<tr><td><code id="match_cause_+3A_vec">vec</code></td>
<td>
<p>a vector of latent cause names, e.g., usually a union of cause names
from several model fits. Usually, it is also the display order that one wants to
show.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of length <code>length(vec)</code>; <code>NA</code> means no pattern matches
vec; 1 at position 10 means the first element of <code>pattern</code> matches the
10th element of <code>vec</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
pattern &lt;- c("X+Y","A+Z","C")
vec     &lt;- c(LETTERS[1:26],"Y+Z","Y+X","Z+A")
match_cause(pattern,vec)

</code></pre>

<hr>
<h2 id='merge_lists'>For a list of many sublists each of which has matrices as its member,
we combine across the many sublists to produce a final list</h2><span id='topic+merge_lists'></span>

<h3>Description</h3>

<p>For a list of many sublists each of which has matrices as its member,
we combine across the many sublists to produce a final list
</p>


<h3>Usage</h3>

<pre><code class='language-R'>merge_lists(list_of_lists)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="merge_lists_+3A_list_of_lists">list_of_lists</code></td>
<td>
<p>a list of sublists</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list after merge
</p>


<h3>See Also</h3>

<p>Other data operation functions: 
<code><a href="#topic+combine_data_nplcm">combine_data_nplcm</a>()</code>,
<code><a href="#topic+subset_data_nplcm_by_index">subset_data_nplcm_by_index</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>DT1 = list(A=1:3,B=letters[1:3])
DT2 = list(A=4:5,B=letters[4:5])
DT3 = list(A=1:4,B=letters[1:4])
DT4 = list(A=4:7,B=letters[4:7])
l = list(DT1,DT2);names(l) &lt;- c("haha","hihi")
l2 = list(DT3,DT4);names(l2) &lt;- c("haha","hihi")
listoflists &lt;- list(l,l2);names(listoflists) &lt;- c("dude1","dude2")
listoflists
merge_lists(listoflists)
</code></pre>

<hr>
<h2 id='my_reorder'>Reorder the measurement dimensions to match the order for display</h2><span id='topic+my_reorder'></span>

<h3>Description</h3>

<p>Reorder the measurement dimensions to match the order for display
</p>


<h3>Usage</h3>

<pre><code class='language-R'>my_reorder(disp_order, raw_nm)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="my_reorder_+3A_disp_order">disp_order</code></td>
<td>
<p>The vector of names to be displayed (order matters)</p>
</td></tr>
<tr><td><code id="my_reorder_+3A_raw_nm">raw_nm</code></td>
<td>
<p>The vector of names from raw measurements (order matters)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A permuted vector from 1 to <code>length(raw_nm)</code>. For example, if
its first element is 3, it means that the 3rd pathogen in <code>raw_nm</code>
should be arranged to the first in the raw measurements.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  disp_order &lt;- c("B","E","D","C","F","A")
  raw_nm &lt;- c("C","A","E")
  my_reorder(disp_order,raw_nm)


</code></pre>

<hr>
<h2 id='NA2dot'>convert 'NA' to '.'</h2><span id='topic+NA2dot'></span>

<h3>Description</h3>

<p>convert 'NA' to '.'
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NA2dot(s)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="NA2dot_+3A_s">s</code></td>
<td>
<p>A string of characters that may contain &quot;NA&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A string of characters without 'NA'
</p>

<hr>
<h2 id='nplcm'>Fit nested partially-latent class models (highest-level wrapper function)</h2><span id='topic+nplcm'></span>

<h3>Description</h3>

<p>Uses <code>JAGS</code> (OSX or Windows) operating system for Bayesian posterior inference
(see <code>README</code> file for an instruction to install <code>JAGS</code>). If running <code>JAGS</code> on windows,
please go to control panel to add the directory to <code>JAGS</code> into ENVIRONMENTAL VARIABLE.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nplcm(data_nplcm, model_options, mcmc_options)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nplcm_+3A_data_nplcm">data_nplcm</code></td>
<td>
<p>Cases are on top of controls in the rows of diagnostic
test results and the covariate matrix. This is assumed by <code>baker</code> to automatically
write model files (<code>.bug</code>).
</p>

<ul>
<li>  <p><code>Mobs</code> A list of measurements of distinct qualities (Bronze-, Silver, and Gold-Standard:
<code>MBS</code>,<code>MSS</code>,<code>MGS</code>). The elements of the list
should include <code>MBS</code>, <code>MSS</code>, and <code>MGS</code>. If any of the component
is not available, please specify it as, e.g., <code>MGS=NULL</code>
(effectively deleting <code>MGS</code> from <code>Mobs</code>).
</p>

<ul>
<li> <p><code>MBS</code> a list of data frame of bronze-standard (BrS) measurements.
For each data frame (referred to as a 'slice'),
rows are subjects, columns are causative agents (e.g., pathogen species).
We use <code>list</code> here to accommodate the possibility of multiple sets of BrS data.
They have imperfect sensitivity/specificity (e.g. nasopharyngeal polymerase chain
reaction - NPPCR).
</p>
</li>
<li> <p><code>MSS</code> a list of data frame of silver-standard (SS) measurements.
Rows are subjects, columns are causative agents measured in specimen (e.g. blood culture).
These measurements have perfect specificity but imperfect sensitivity.
</p>
</li>
<li> <p><code>MGS</code> a list of data frame of gold-standard (GS) measurements.
Rows are subject, columns are measured causative agents
These measurements have perfect sensitivity and specificity.
</p>
</li></ul>

</li>
<li> <p><code>Y</code> Vector of disease status: <code>1</code> for case, <code>0</code> for control.
</p>
</li>
<li> <p><code>X</code> Covariate matrix. A subset of columns are primary covariates in cause-specific-
case-fraction (CSCF) functions and hence must be available for cases, and another subset
are covariates that are available in the cases and the controls.
The two sets of covariates may be identical, overlapping or completely different.
In general, this is not the design matrix for regression models,
because for enrollment date in a study which may have non-linear effect,
basis expansion is often needed for approximation.
</p>
</li></ul>
</td></tr>
<tr><td><code id="nplcm_+3A_model_options">model_options</code></td>
<td>
<p>A list of model options: likelihood and prior.
</p>

<dl>
<dt><code>use_measurements</code></dt><dd>
<p>A vector of characters strings; can be one or more from <code>"BrS"</code>, <code>"SS"</code>, <code>"GS"</code>.
</p>
</dd>
<dt><code>likelihood</code></dt><dd>

<dl>
<dt>cause_list</dt><dd><p> The vector of causes (NB: specify);</p>
</dd>
<dt>k_subclass</dt><dd><p> The number of nested subclasses in each
disease class (one of case classes or the control class; the same <code>k_subclass</code>
is assumed for each class) and each slice of BrS measurements.
<code>1</code> for conditional independence; larger than <code>1</code> for conditional dependence.
It is only available for BrS measurements. It is a vector of length equal to
the number of slices of BrS measurements;</p>
</dd>
<dt>Eti_formula</dt><dd><p> Formula for etiology regressions. You can use
<code><a href="#topic+s_date_Eti">s_date_Eti()</a></code> to specify the design matrix for <code>R</code> format enrollment date;
it will produce natural cubic spline basis. Specify <code>~ 1</code> if no regression is intended.</p>
</dd>
<dt>FPR_formula</dt><dd><p>formula for false positive rates (FPR) regressions; see <code><a href="stats.html#topic+formula">formula()</a></code>.
You can use <code><a href="#topic+s_date_FPR">s_date_FPR()</a></code> to specify part of the design matrix for <code>R</code>
format enrollment date; it will produce penalized-spline basis (based on B-splines).
Specify <code>~ 1</code> if no regression is intended. (NB: If <code>effect="fixed"</code>, <code><a href="#topic+dm_Rdate_FPR">dm_Rdate_FPR()</a></code>
will just specify a design matrix with appropriately standardized dates.)</p>
</dd>
</dl>

</dd>
<dt><code>prior</code></dt><dd>

<dl>
<dt>Eti_prior</dt><dd><p>Description of etiology prior (e.g., <code>overall_uniform</code> -
all hyperparameters are <code>1</code>; or <code style="white-space: pre;">&#8288;0_1&#8288;</code> - all hyperparameters are <code>0.1</code>);</p>
</dd>
<dt>TPR_prior</dt><dd><p>Description of priors for the measurements
(e.g., informative vs non-informative). Its length should be the
same as <code>use_measurements</code> above. Please see examples for how to specify.
The package can also handle multiple slices of BrS, SS data, so separate
specification of the TPR priors are needed.
</p>
</dd>
</dl>

</dd>
</dl>
</td></tr>
<tr><td><code id="nplcm_+3A_mcmc_options">mcmc_options</code></td>
<td>
<p>A list of Markov chain Monte Carlo (MCMC) options.
</p>

<ul>
<li> <p><code>debugstatus</code> Logical - whether to pause WinBUGS after it finishes
model fitting; (NB: is this obsolete? Test.)
</p>
</li>
<li> <p><code>n.chains</code> Number of MCMC chains;
</p>
</li>
<li> <p><code>n.burnin</code> Number of burn-in iterations;
</p>
</li>
<li> <p><code>n.thin</code> To keep every other <code>n.thin</code> samples after burn-in period;
</p>
</li>
<li> <p><code>individual.pred</code> <code>TRUE</code> to perform individual prediction (<code>Icat</code>
variables in the <code>.bug</code> file); <code>FALSE</code> otherwise;
</p>
</li>
<li> <p><code>ppd</code> <code>TRUE</code> to simulate new data (<code>XXX.new</code>
variables in the <code>.bug</code> file) from the posterior predictive distribution (ppd);
<code>FALSE</code> otherwise;
</p>
</li>
<li> <p><code>get.pEti</code> <code>TRUE</code> for getting posterior samples of individual etiologic fractions;
<code>FALSE</code> otherwise. For non-regression, or regression models with all discrete predictors,
by default this is <code>TRUE</code>, so no need to specify this entry. It is only relevant for regression models
with non-discrete covariates. Because individuals have distinct CSCFs at their specific covariate values,
it's easier to just store the posterior samples of the regression coefficients and reconstruct the pies afterwards,
rather than storing them through <code>JAGS</code>.
</p>
</li>
<li> <p><code>result.folder</code> Path to folder storing the results;
</p>
</li>
<li> <p><code>bugsmodel.dir</code> Path to <code>.bug</code> model files;
</p>
</li>
<li> <p><code>jags.dir</code> Path to where JAGS is installed; if <code>NULL</code>, this will be set
to <code>jags.dir=""</code>.
</p>
</li></ul>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>JAGS</code> output result, fitted by function <code><a href="R2jags.html#topic+jags">R2jags::jags2()</a></code> from <code>R2jags</code>.
It is an object of class <code>nplcm</code> and <code>bugs</code>.
Current implemented models follow the hierarchy below:
</p>

<ul>
<li><p> no regression:  Fitted by at low level by <a href="#topic+nplcm_fit_NoReg">nplcm_fit_NoReg</a>
</p>
</li>
<li><p> regression:
Given disease class (control or a class of cases with the same subset of causative agents):
</p>

<ul>
<li><p> local independence model for BrS measures:
Fitted at lower level by
</p>

<ul>
<li> <p><a href="#topic+nplcm_fit_Reg_NoNest">nplcm_fit_Reg_NoNest</a> deals with the setting with two sets of covariates,
one for CSCF regression and the other for FPR regression. The two sets of
covariates may be identical, overlapping or non-overlapping.
This function is called when there exists one or more than one discrete covariate among
the union of the two covariate sets. The method implemented by this function
directly lets FPR depend upon covariates.
This is different from Wu and Chen (2021), which let the subclass
weights depend upon covariates. We implemented this function for methods comparison.
</p>
</li>
<li> <p><a href="#topic+nplcm_fit_Reg_discrete_predictor_NoNest">nplcm_fit_Reg_discrete_predictor_NoNest</a> deals with the setting
with all discrete covariates for FPRs and CSCFs. The strata defined by the two sets of
covariates need not be identical, e.g., as a result of distinct sets of covariates. Again,
this is directly to let FPR be stratified by covariates, hence different from Wu and Chen (2020+)
We implemented this function for methods comparison.
</p>
</li></ul>

</li>
<li><p> local dependence model for BrS measures:
Fitted at lower level by <a href="#topic+nplcm_fit_Reg_Nest">nplcm_fit_Reg_Nest</a>: This is the method introduced in
Wu and Chen (2021): CSCF regression + case/control subclass weight regression.
It does not provide a specialized function for the setting with all discrete covariates.
</p>
</li></ul>

</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>

data(data_nplcm_noreg)
cause_list &lt;- LETTERS[1:6]
J.BrS      &lt;- 6
model_options_no_reg &lt;- list(
  likelihood   = list(
    cause_list = cause_list,
    k_subclass = 2,
    Eti_formula = ~-1, # no covariate for the etiology regression
    FPR_formula = list(
      MBS1 =   ~-1)    # no covariate for the subclass weight regression
  ),
  use_measurements = c("BrS"), 
  # use bronze-standard data only for model estimation.
  prior= list(
    Eti_prior = overall_uniform(1,cause_list), 
    # Dirichlet(1,...,1) prior for the etiology.
    TPR_prior  = list(BrS = list(
      info  = "informative", # informative prior for TPRs
      input = "match_range", 
      # specify the informative prior for TPRs by specifying a plausible range.
      val = list(MBS1 = list(up =  list(rep(0.99,J.BrS)), 
                             # upper ranges: matched to 97.5% quantile of a Beta prior
                             low = list(rep(0.55,J.BrS))))
      # lower ranges: matched to 2.5% quantile of a Beta prior
    )
    )
  )
)     


set.seed(1)
# include stratification information in file name:
thedir    &lt;- paste0(tempdir(),"_no_reg")

# create folders to store the model results 
dir.create(thedir, showWarnings = FALSE)
result_folder_no_reg &lt;- file.path(thedir,paste("results",collapse="_"))
thedir &lt;- result_folder_no_reg
dir.create(thedir, showWarnings = FALSE)

# options for MCMC chains:
mcmc_options_no_reg &lt;- list(
  debugstatus = TRUE,
  n.chains = 1,
  n.itermcmc = as.integer(200), 
  n.burnin = as.integer(100), 
  n.thin = 1,
  individual.pred = TRUE, # &lt;- must set to TRUE! &lt;------- NOTE! 
  ppd = FALSE,
  result.folder = thedir,
  bugsmodel.dir = thedir
)

BrS_object_1 &lt;- make_meas_object(patho = LETTERS[1:6], 
                                 specimen = "MBS", test = "1", 
                                 quality = "BrS", cause_list = cause_list)
clean_options &lt;- list(BrS_objects = make_list(BrS_object_1))
# place the nplcm data and cleaning options into the results folder
dput(data_nplcm_noreg,file.path(thedir,"data_nplcm.txt")) 
dput(clean_options, file.path(thedir, "data_clean_options.txt"))

rjags::load.module("glm")

nplcm_noreg &lt;- nplcm(data_nplcm_noreg,model_options_no_reg,mcmc_options_no_reg)





</code></pre>

<hr>
<h2 id='nplcm_fit_NoReg'>Fit nested partially-latent class model (low-level)</h2><span id='topic+nplcm_fit_NoReg'></span>

<h3>Description</h3>

<p>This function prepares data, specifies hyperparameters in priors
(true positive rates and etiology fractions), initializes the posterior
sampling chain, writes the model file (for JAGS or WinBUGS with slight differences
in syntax), and fits the model. Features:
</p>

<ul>
<li><p> no regression;
</p>
</li>
<li><p> no nested subclasses
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>nplcm_fit_NoReg(data_nplcm, model_options, mcmc_options)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nplcm_fit_NoReg_+3A_data_nplcm">data_nplcm</code></td>
<td>
<p>Cases are on top of controls in the rows of diagnostic
test results and the covariate matrix. This is assumed by <code>baker</code> to automatically
write model files (<code>.bug</code>).
</p>

<ul>
<li>  <p><code>Mobs</code> A list of measurements of distinct qualities (Bronze-, Silver, and Gold-Standard:
<code>MBS</code>,<code>MSS</code>,<code>MGS</code>). The elements of the list
should include <code>MBS</code>, <code>MSS</code>, and <code>MGS</code>. If any of the component
is not available, please specify it as, e.g., <code>MGS=NULL</code>
(effectively deleting <code>MGS</code> from <code>Mobs</code>).
</p>

<ul>
<li> <p><code>MBS</code> a list of data frame of bronze-standard (BrS) measurements.
For each data frame (referred to as a 'slice'),
rows are subjects, columns are causative agents (e.g., pathogen species).
We use <code>list</code> here to accommodate the possibility of multiple sets of BrS data.
They have imperfect sensitivity/specificity (e.g. nasopharyngeal polymerase chain
reaction - NPPCR).
</p>
</li>
<li> <p><code>MSS</code> a list of data frame of silver-standard (SS) measurements.
Rows are subjects, columns are causative agents measured in specimen (e.g. blood culture).
These measurements have perfect specificity but imperfect sensitivity.
</p>
</li>
<li> <p><code>MGS</code> a list of data frame of gold-standard (GS) measurements.
Rows are subject, columns are measured causative agents
These measurements have perfect sensitivity and specificity.
</p>
</li></ul>

</li>
<li> <p><code>Y</code> Vector of disease status: <code>1</code> for case, <code>0</code> for control.
</p>
</li>
<li> <p><code>X</code> Covariate matrix. A subset of columns are primary covariates in cause-specific-
case-fraction (CSCF) functions and hence must be available for cases, and another subset
are covariates that are available in the cases and the controls.
The two sets of covariates may be identical, overlapping or completely different.
In general, this is not the design matrix for regression models,
because for enrollment date in a study which may have non-linear effect,
basis expansion is often needed for approximation.
</p>
</li></ul>
</td></tr>
<tr><td><code id="nplcm_fit_NoReg_+3A_model_options">model_options</code></td>
<td>
<p>A list of model options: likelihood and prior.
</p>

<dl>
<dt><code>use_measurements</code></dt><dd>
<p>A vector of characters strings; can be one or more from <code>"BrS"</code>, <code>"SS"</code>, <code>"GS"</code>.
</p>
</dd>
<dt><code>likelihood</code></dt><dd>

<dl>
<dt>cause_list</dt><dd><p> The vector of causes (NB: specify);</p>
</dd>
<dt>k_subclass</dt><dd><p> The number of nested subclasses in each
disease class (one of case classes or the control class; the same <code>k_subclass</code>
is assumed for each class) and each slice of BrS measurements.
<code>1</code> for conditional independence; larger than <code>1</code> for conditional dependence.
It is only available for BrS measurements. It is a vector of length equal to
the number of slices of BrS measurements;</p>
</dd>
<dt>Eti_formula</dt><dd><p> Formula for etiology regressions. You can use
<code><a href="#topic+s_date_Eti">s_date_Eti()</a></code> to specify the design matrix for <code>R</code> format enrollment date;
it will produce natural cubic spline basis. Specify <code>~ 1</code> if no regression is intended.</p>
</dd>
<dt>FPR_formula</dt><dd><p>formula for false positive rates (FPR) regressions; see <code><a href="stats.html#topic+formula">formula()</a></code>.
You can use <code><a href="#topic+s_date_FPR">s_date_FPR()</a></code> to specify part of the design matrix for <code>R</code>
format enrollment date; it will produce penalized-spline basis (based on B-splines).
Specify <code>~ 1</code> if no regression is intended. (NB: If <code>effect="fixed"</code>, <code><a href="#topic+dm_Rdate_FPR">dm_Rdate_FPR()</a></code>
will just specify a design matrix with appropriately standardized dates.)</p>
</dd>
</dl>

</dd>
<dt><code>prior</code></dt><dd>

<dl>
<dt>Eti_prior</dt><dd><p>Description of etiology prior (e.g., <code>overall_uniform</code> -
all hyperparameters are <code>1</code>; or <code style="white-space: pre;">&#8288;0_1&#8288;</code> - all hyperparameters are <code>0.1</code>);</p>
</dd>
<dt>TPR_prior</dt><dd><p>Description of priors for the measurements
(e.g., informative vs non-informative). Its length should be the
same as <code>use_measurements</code> above. Please see examples for how to specify.
The package can also handle multiple slices of BrS, SS data, so separate
specification of the TPR priors are needed.
</p>
</dd>
</dl>

</dd>
</dl>
</td></tr>
<tr><td><code id="nplcm_fit_NoReg_+3A_mcmc_options">mcmc_options</code></td>
<td>
<p>A list of Markov chain Monte Carlo (MCMC) options.
</p>

<ul>
<li> <p><code>debugstatus</code> Logical - whether to pause WinBUGS after it finishes
model fitting; (NB: is this obsolete? Test.)
</p>
</li>
<li> <p><code>n.chains</code> Number of MCMC chains;
</p>
</li>
<li> <p><code>n.burnin</code> Number of burn-in iterations;
</p>
</li>
<li> <p><code>n.thin</code> To keep every other <code>n.thin</code> samples after burn-in period;
</p>
</li>
<li> <p><code>individual.pred</code> <code>TRUE</code> to perform individual prediction (<code>Icat</code>
variables in the <code>.bug</code> file); <code>FALSE</code> otherwise;
</p>
</li>
<li> <p><code>ppd</code> <code>TRUE</code> to simulate new data (<code>XXX.new</code>
variables in the <code>.bug</code> file) from the posterior predictive distribution (ppd);
<code>FALSE</code> otherwise;
</p>
</li>
<li> <p><code>get.pEti</code> <code>TRUE</code> for getting posterior samples of individual etiologic fractions;
<code>FALSE</code> otherwise. For non-regression, or regression models with all discrete predictors,
by default this is <code>TRUE</code>, so no need to specify this entry. It is only relevant for regression models
with non-discrete covariates. Because individuals have distinct CSCFs at their specific covariate values,
it's easier to just store the posterior samples of the regression coefficients and reconstruct the pies afterwards,
rather than storing them through <code>JAGS</code>.
</p>
</li>
<li> <p><code>result.folder</code> Path to folder storing the results;
</p>
</li>
<li> <p><code>bugsmodel.dir</code> Path to <code>.bug</code> model files;
</p>
</li>
<li> <p><code>jags.dir</code> Path to where JAGS is installed; if <code>NULL</code>, this will be set
to <code>jags.dir=""</code>.
</p>
</li></ul>
</td></tr>
</table>


<h3>Value</h3>

<p>BUGS fit results.
</p>


<h3>See Also</h3>

<p><a href="#topic+write_model_NoReg">write_model_NoReg</a> for constructing <code>.bug</code> model file; This function
then put it in the folder <code>mcmc_options$bugsmodel.dir</code>.
</p>
<p>Other model fitting functions: 
<code><a href="#topic+nplcm_fit_Reg_Nest">nplcm_fit_Reg_Nest</a>()</code>,
<code><a href="#topic+nplcm_fit_Reg_NoNest">nplcm_fit_Reg_NoNest</a>()</code>,
<code><a href="#topic+nplcm_fit_Reg_discrete_predictor_NoNest">nplcm_fit_Reg_discrete_predictor_NoNest</a>()</code>
</p>

<hr>
<h2 id='nplcm_fit_Reg_discrete_predictor_NoNest'>Fit nested partially-latent class model with regression (low-level)</h2><span id='topic+nplcm_fit_Reg_discrete_predictor_NoNest'></span>

<h3>Description</h3>

<p>Fit nested partially-latent class model with regression (low-level)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nplcm_fit_Reg_discrete_predictor_NoNest(
  data_nplcm,
  model_options,
  mcmc_options
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nplcm_fit_Reg_discrete_predictor_NoNest_+3A_data_nplcm">data_nplcm</code></td>
<td>
<p>Cases are on top of controls in the rows of diagnostic
test results and the covariate matrix. This is assumed by <code>baker</code> to automatically
write model files (<code>.bug</code>).
</p>

<ul>
<li>  <p><code>Mobs</code> A list of measurements of distinct qualities (Bronze-, Silver, and Gold-Standard:
<code>MBS</code>,<code>MSS</code>,<code>MGS</code>). The elements of the list
should include <code>MBS</code>, <code>MSS</code>, and <code>MGS</code>. If any of the component
is not available, please specify it as, e.g., <code>MGS=NULL</code>
(effectively deleting <code>MGS</code> from <code>Mobs</code>).
</p>

<ul>
<li> <p><code>MBS</code> a list of data frame of bronze-standard (BrS) measurements.
For each data frame (referred to as a 'slice'),
rows are subjects, columns are causative agents (e.g., pathogen species).
We use <code>list</code> here to accommodate the possibility of multiple sets of BrS data.
They have imperfect sensitivity/specificity (e.g. nasopharyngeal polymerase chain
reaction - NPPCR).
</p>
</li>
<li> <p><code>MSS</code> a list of data frame of silver-standard (SS) measurements.
Rows are subjects, columns are causative agents measured in specimen (e.g. blood culture).
These measurements have perfect specificity but imperfect sensitivity.
</p>
</li>
<li> <p><code>MGS</code> a list of data frame of gold-standard (GS) measurements.
Rows are subject, columns are measured causative agents
These measurements have perfect sensitivity and specificity.
</p>
</li></ul>

</li>
<li> <p><code>Y</code> Vector of disease status: <code>1</code> for case, <code>0</code> for control.
</p>
</li>
<li> <p><code>X</code> Covariate matrix. A subset of columns are primary covariates in cause-specific-
case-fraction (CSCF) functions and hence must be available for cases, and another subset
are covariates that are available in the cases and the controls.
The two sets of covariates may be identical, overlapping or completely different.
In general, this is not the design matrix for regression models,
because for enrollment date in a study which may have non-linear effect,
basis expansion is often needed for approximation.
</p>
</li></ul>
</td></tr>
<tr><td><code id="nplcm_fit_Reg_discrete_predictor_NoNest_+3A_model_options">model_options</code></td>
<td>
<p>A list of model options: likelihood and prior.
</p>

<dl>
<dt><code>use_measurements</code></dt><dd>
<p>A vector of characters strings; can be one or more from <code>"BrS"</code>, <code>"SS"</code>, <code>"GS"</code>.
</p>
</dd>
<dt><code>likelihood</code></dt><dd>

<dl>
<dt>cause_list</dt><dd><p> The vector of causes (NB: specify);</p>
</dd>
<dt>k_subclass</dt><dd><p> The number of nested subclasses in each
disease class (one of case classes or the control class; the same <code>k_subclass</code>
is assumed for each class) and each slice of BrS measurements.
<code>1</code> for conditional independence; larger than <code>1</code> for conditional dependence.
It is only available for BrS measurements. It is a vector of length equal to
the number of slices of BrS measurements;</p>
</dd>
<dt>Eti_formula</dt><dd><p> Formula for etiology regressions. You can use
<code><a href="#topic+s_date_Eti">s_date_Eti()</a></code> to specify the design matrix for <code>R</code> format enrollment date;
it will produce natural cubic spline basis. Specify <code>~ 1</code> if no regression is intended.</p>
</dd>
<dt>FPR_formula</dt><dd><p>formula for false positive rates (FPR) regressions; see <code><a href="stats.html#topic+formula">formula()</a></code>.
You can use <code><a href="#topic+s_date_FPR">s_date_FPR()</a></code> to specify part of the design matrix for <code>R</code>
format enrollment date; it will produce penalized-spline basis (based on B-splines).
Specify <code>~ 1</code> if no regression is intended. (NB: If <code>effect="fixed"</code>, <code><a href="#topic+dm_Rdate_FPR">dm_Rdate_FPR()</a></code>
will just specify a design matrix with appropriately standardized dates.)</p>
</dd>
</dl>

</dd>
<dt><code>prior</code></dt><dd>

<dl>
<dt>Eti_prior</dt><dd><p>Description of etiology prior (e.g., <code>overall_uniform</code> -
all hyperparameters are <code>1</code>; or <code style="white-space: pre;">&#8288;0_1&#8288;</code> - all hyperparameters are <code>0.1</code>);</p>
</dd>
<dt>TPR_prior</dt><dd><p>Description of priors for the measurements
(e.g., informative vs non-informative). Its length should be the
same as <code>use_measurements</code> above. Please see examples for how to specify.
The package can also handle multiple slices of BrS, SS data, so separate
specification of the TPR priors are needed.
</p>
</dd>
</dl>

</dd>
</dl>
</td></tr>
<tr><td><code id="nplcm_fit_Reg_discrete_predictor_NoNest_+3A_mcmc_options">mcmc_options</code></td>
<td>
<p>A list of Markov chain Monte Carlo (MCMC) options.
</p>

<ul>
<li> <p><code>debugstatus</code> Logical - whether to pause WinBUGS after it finishes
model fitting; (NB: is this obsolete? Test.)
</p>
</li>
<li> <p><code>n.chains</code> Number of MCMC chains;
</p>
</li>
<li> <p><code>n.burnin</code> Number of burn-in iterations;
</p>
</li>
<li> <p><code>n.thin</code> To keep every other <code>n.thin</code> samples after burn-in period;
</p>
</li>
<li> <p><code>individual.pred</code> <code>TRUE</code> to perform individual prediction (<code>Icat</code>
variables in the <code>.bug</code> file); <code>FALSE</code> otherwise;
</p>
</li>
<li> <p><code>ppd</code> <code>TRUE</code> to simulate new data (<code>XXX.new</code>
variables in the <code>.bug</code> file) from the posterior predictive distribution (ppd);
<code>FALSE</code> otherwise;
</p>
</li>
<li> <p><code>get.pEti</code> <code>TRUE</code> for getting posterior samples of individual etiologic fractions;
<code>FALSE</code> otherwise. For non-regression, or regression models with all discrete predictors,
by default this is <code>TRUE</code>, so no need to specify this entry. It is only relevant for regression models
with non-discrete covariates. Because individuals have distinct CSCFs at their specific covariate values,
it's easier to just store the posterior samples of the regression coefficients and reconstruct the pies afterwards,
rather than storing them through <code>JAGS</code>.
</p>
</li>
<li> <p><code>result.folder</code> Path to folder storing the results;
</p>
</li>
<li> <p><code>bugsmodel.dir</code> Path to <code>.bug</code> model files;
</p>
</li>
<li> <p><code>jags.dir</code> Path to where JAGS is installed; if <code>NULL</code>, this will be set
to <code>jags.dir=""</code>.
</p>
</li></ul>
</td></tr>
</table>


<h3>Details</h3>

<p>This function prepares data, specifies hyperparameters in priors
(true positive rates and etiology fractions), initializes the posterior
sampling chain, writes the model file (for JAGS or WinBUGS with slight
differences in syntax), and fits the model. Features:
</p>

<ul>
<li><p> regression;
</p>
</li>
<li><p> no nested subclasses, i.e. conditional independence of
multivariate measurements given disease class and covariates;
</p>
</li>
<li><p> multiple BrS + multiple SS.
</p>
</li></ul>

<p>If running JAGS on windows, please go to control panel to add the directory to
jags into ENVIRONMENTAL VARIABLE!
</p>


<h3>Value</h3>

<p>BUGS fit results.
</p>


<h3>See Also</h3>

<p><a href="#topic+write_model_NoReg">write_model_NoReg</a> for automatically generate <code>.bug</code> model
file; This present function store it in location: <code>mcmc_options$bugsmodel.dir</code>.
</p>
<p>Other model fitting functions: 
<code><a href="#topic+nplcm_fit_NoReg">nplcm_fit_NoReg</a>()</code>,
<code><a href="#topic+nplcm_fit_Reg_Nest">nplcm_fit_Reg_Nest</a>()</code>,
<code><a href="#topic+nplcm_fit_Reg_NoNest">nplcm_fit_Reg_NoNest</a>()</code>
</p>

<hr>
<h2 id='nplcm_fit_Reg_Nest'>Fit nested partially-latent class model with regression (low-level)</h2><span id='topic+nplcm_fit_Reg_Nest'></span>

<h3>Description</h3>

<p>Called by <code><a href="#topic+nplcm">nplcm()</a></code> upon being assigned to this nested regression by
<code><a href="#topic+assign_model">assign_model()</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nplcm_fit_Reg_Nest(data_nplcm, model_options, mcmc_options)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nplcm_fit_Reg_Nest_+3A_data_nplcm">data_nplcm</code></td>
<td>
<p>Cases are on top of controls in the rows of diagnostic
test results and the covariate matrix. This is assumed by <code>baker</code> to automatically
write model files (<code>.bug</code>).
</p>

<ul>
<li>  <p><code>Mobs</code> A list of measurements of distinct qualities (Bronze-, Silver, and Gold-Standard:
<code>MBS</code>,<code>MSS</code>,<code>MGS</code>). The elements of the list
should include <code>MBS</code>, <code>MSS</code>, and <code>MGS</code>. If any of the component
is not available, please specify it as, e.g., <code>MGS=NULL</code>
(effectively deleting <code>MGS</code> from <code>Mobs</code>).
</p>

<ul>
<li> <p><code>MBS</code> a list of data frame of bronze-standard (BrS) measurements.
For each data frame (referred to as a 'slice'),
rows are subjects, columns are causative agents (e.g., pathogen species).
We use <code>list</code> here to accommodate the possibility of multiple sets of BrS data.
They have imperfect sensitivity/specificity (e.g. nasopharyngeal polymerase chain
reaction - NPPCR).
</p>
</li>
<li> <p><code>MSS</code> a list of data frame of silver-standard (SS) measurements.
Rows are subjects, columns are causative agents measured in specimen (e.g. blood culture).
These measurements have perfect specificity but imperfect sensitivity.
</p>
</li>
<li> <p><code>MGS</code> a list of data frame of gold-standard (GS) measurements.
Rows are subject, columns are measured causative agents
These measurements have perfect sensitivity and specificity.
</p>
</li></ul>

</li>
<li> <p><code>Y</code> Vector of disease status: <code>1</code> for case, <code>0</code> for control.
</p>
</li>
<li> <p><code>X</code> Covariate matrix. A subset of columns are primary covariates in cause-specific-
case-fraction (CSCF) functions and hence must be available for cases, and another subset
are covariates that are available in the cases and the controls.
The two sets of covariates may be identical, overlapping or completely different.
In general, this is not the design matrix for regression models,
because for enrollment date in a study which may have non-linear effect,
basis expansion is often needed for approximation.
</p>
</li></ul>
</td></tr>
<tr><td><code id="nplcm_fit_Reg_Nest_+3A_model_options">model_options</code></td>
<td>
<p>A list of model options: likelihood and prior.
</p>

<dl>
<dt><code>use_measurements</code></dt><dd>
<p>A vector of characters strings; can be one or more from <code>"BrS"</code>, <code>"SS"</code>, <code>"GS"</code>.
</p>
</dd>
<dt><code>likelihood</code></dt><dd>

<dl>
<dt>cause_list</dt><dd><p> The vector of causes (NB: specify);</p>
</dd>
<dt>k_subclass</dt><dd><p> The number of nested subclasses in each
disease class (one of case classes or the control class; the same <code>k_subclass</code>
is assumed for each class) and each slice of BrS measurements.
<code>1</code> for conditional independence; larger than <code>1</code> for conditional dependence.
It is only available for BrS measurements. It is a vector of length equal to
the number of slices of BrS measurements;</p>
</dd>
<dt>Eti_formula</dt><dd><p> Formula for etiology regressions. You can use
<code><a href="#topic+s_date_Eti">s_date_Eti()</a></code> to specify the design matrix for <code>R</code> format enrollment date;
it will produce natural cubic spline basis. Specify <code>~ 1</code> if no regression is intended.</p>
</dd>
<dt>FPR_formula</dt><dd><p>formula for false positive rates (FPR) regressions; see <code><a href="stats.html#topic+formula">formula()</a></code>.
You can use <code><a href="#topic+s_date_FPR">s_date_FPR()</a></code> to specify part of the design matrix for <code>R</code>
format enrollment date; it will produce penalized-spline basis (based on B-splines).
Specify <code>~ 1</code> if no regression is intended. (NB: If <code>effect="fixed"</code>, <code><a href="#topic+dm_Rdate_FPR">dm_Rdate_FPR()</a></code>
will just specify a design matrix with appropriately standardized dates.)</p>
</dd>
</dl>

</dd>
<dt><code>prior</code></dt><dd>

<dl>
<dt>Eti_prior</dt><dd><p>Description of etiology prior (e.g., <code>overall_uniform</code> -
all hyperparameters are <code>1</code>; or <code style="white-space: pre;">&#8288;0_1&#8288;</code> - all hyperparameters are <code>0.1</code>);</p>
</dd>
<dt>TPR_prior</dt><dd><p>Description of priors for the measurements
(e.g., informative vs non-informative). Its length should be the
same as <code>use_measurements</code> above. Please see examples for how to specify.
The package can also handle multiple slices of BrS, SS data, so separate
specification of the TPR priors are needed.
</p>
</dd>
</dl>

</dd>
</dl>
</td></tr>
<tr><td><code id="nplcm_fit_Reg_Nest_+3A_mcmc_options">mcmc_options</code></td>
<td>
<p>A list of Markov chain Monte Carlo (MCMC) options.
</p>

<ul>
<li> <p><code>debugstatus</code> Logical - whether to pause WinBUGS after it finishes
model fitting; (NB: is this obsolete? Test.)
</p>
</li>
<li> <p><code>n.chains</code> Number of MCMC chains;
</p>
</li>
<li> <p><code>n.burnin</code> Number of burn-in iterations;
</p>
</li>
<li> <p><code>n.thin</code> To keep every other <code>n.thin</code> samples after burn-in period;
</p>
</li>
<li> <p><code>individual.pred</code> <code>TRUE</code> to perform individual prediction (<code>Icat</code>
variables in the <code>.bug</code> file); <code>FALSE</code> otherwise;
</p>
</li>
<li> <p><code>ppd</code> <code>TRUE</code> to simulate new data (<code>XXX.new</code>
variables in the <code>.bug</code> file) from the posterior predictive distribution (ppd);
<code>FALSE</code> otherwise;
</p>
</li>
<li> <p><code>get.pEti</code> <code>TRUE</code> for getting posterior samples of individual etiologic fractions;
<code>FALSE</code> otherwise. For non-regression, or regression models with all discrete predictors,
by default this is <code>TRUE</code>, so no need to specify this entry. It is only relevant for regression models
with non-discrete covariates. Because individuals have distinct CSCFs at their specific covariate values,
it's easier to just store the posterior samples of the regression coefficients and reconstruct the pies afterwards,
rather than storing them through <code>JAGS</code>.
</p>
</li>
<li> <p><code>result.folder</code> Path to folder storing the results;
</p>
</li>
<li> <p><code>bugsmodel.dir</code> Path to <code>.bug</code> model files;
</p>
</li>
<li> <p><code>jags.dir</code> Path to where JAGS is installed; if <code>NULL</code>, this will be set
to <code>jags.dir=""</code>.
</p>
</li></ul>
</td></tr>
</table>


<h3>Details</h3>

<p>This function prepares data, specifies hyperparameters in priors
(true positive rates and etiology fractions), initializes the posterior
sampling chain, writes the model file (for <code>JAGS</code>), and fits the model. Features:
</p>

<ul>
<li><p> regression (not all discrete covariates);
</p>
</li>
<li><p> nested subclasses, i.e. conditional dependence of
multivariate measurements given disease class and covariates;
</p>
</li>
<li><p> multiple BrS + multiple SS.
</p>
</li></ul>



<h3>Value</h3>

<p>BUGS fit results.
</p>


<h3>See Also</h3>

<p><a href="#topic+write_model_Reg_Nest">write_model_Reg_Nest</a> for constructing <code>.bug</code> model file; This function
then put it in the folder <code>mcmc_options$bugsmodel.dir</code>.
</p>
<p>Other model fitting functions: 
<code><a href="#topic+nplcm_fit_NoReg">nplcm_fit_NoReg</a>()</code>,
<code><a href="#topic+nplcm_fit_Reg_NoNest">nplcm_fit_Reg_NoNest</a>()</code>,
<code><a href="#topic+nplcm_fit_Reg_discrete_predictor_NoNest">nplcm_fit_Reg_discrete_predictor_NoNest</a>()</code>
</p>

<hr>
<h2 id='nplcm_fit_Reg_NoNest'>Fit nested partially-latent class model with regression (low-level)</h2><span id='topic+nplcm_fit_Reg_NoNest'></span>

<h3>Description</h3>

<p>Fit nested partially-latent class model with regression (low-level)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nplcm_fit_Reg_NoNest(data_nplcm, model_options, mcmc_options)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nplcm_fit_Reg_NoNest_+3A_data_nplcm">data_nplcm</code></td>
<td>
<p>Cases are on top of controls in the rows of diagnostic
test results and the covariate matrix. This is assumed by <code>baker</code> to automatically
write model files (<code>.bug</code>).
</p>

<ul>
<li>  <p><code>Mobs</code> A list of measurements of distinct qualities (Bronze-, Silver, and Gold-Standard:
<code>MBS</code>,<code>MSS</code>,<code>MGS</code>). The elements of the list
should include <code>MBS</code>, <code>MSS</code>, and <code>MGS</code>. If any of the component
is not available, please specify it as, e.g., <code>MGS=NULL</code>
(effectively deleting <code>MGS</code> from <code>Mobs</code>).
</p>

<ul>
<li> <p><code>MBS</code> a list of data frame of bronze-standard (BrS) measurements.
For each data frame (referred to as a 'slice'),
rows are subjects, columns are causative agents (e.g., pathogen species).
We use <code>list</code> here to accommodate the possibility of multiple sets of BrS data.
They have imperfect sensitivity/specificity (e.g. nasopharyngeal polymerase chain
reaction - NPPCR).
</p>
</li>
<li> <p><code>MSS</code> a list of data frame of silver-standard (SS) measurements.
Rows are subjects, columns are causative agents measured in specimen (e.g. blood culture).
These measurements have perfect specificity but imperfect sensitivity.
</p>
</li>
<li> <p><code>MGS</code> a list of data frame of gold-standard (GS) measurements.
Rows are subject, columns are measured causative agents
These measurements have perfect sensitivity and specificity.
</p>
</li></ul>

</li>
<li> <p><code>Y</code> Vector of disease status: <code>1</code> for case, <code>0</code> for control.
</p>
</li>
<li> <p><code>X</code> Covariate matrix. A subset of columns are primary covariates in cause-specific-
case-fraction (CSCF) functions and hence must be available for cases, and another subset
are covariates that are available in the cases and the controls.
The two sets of covariates may be identical, overlapping or completely different.
In general, this is not the design matrix for regression models,
because for enrollment date in a study which may have non-linear effect,
basis expansion is often needed for approximation.
</p>
</li></ul>
</td></tr>
<tr><td><code id="nplcm_fit_Reg_NoNest_+3A_model_options">model_options</code></td>
<td>
<p>A list of model options: likelihood and prior.
</p>

<dl>
<dt><code>use_measurements</code></dt><dd>
<p>A vector of characters strings; can be one or more from <code>"BrS"</code>, <code>"SS"</code>, <code>"GS"</code>.
</p>
</dd>
<dt><code>likelihood</code></dt><dd>

<dl>
<dt>cause_list</dt><dd><p> The vector of causes (NB: specify);</p>
</dd>
<dt>k_subclass</dt><dd><p> The number of nested subclasses in each
disease class (one of case classes or the control class; the same <code>k_subclass</code>
is assumed for each class) and each slice of BrS measurements.
<code>1</code> for conditional independence; larger than <code>1</code> for conditional dependence.
It is only available for BrS measurements. It is a vector of length equal to
the number of slices of BrS measurements;</p>
</dd>
<dt>Eti_formula</dt><dd><p> Formula for etiology regressions. You can use
<code><a href="#topic+s_date_Eti">s_date_Eti()</a></code> to specify the design matrix for <code>R</code> format enrollment date;
it will produce natural cubic spline basis. Specify <code>~ 1</code> if no regression is intended.</p>
</dd>
<dt>FPR_formula</dt><dd><p>formula for false positive rates (FPR) regressions; see <code><a href="stats.html#topic+formula">formula()</a></code>.
You can use <code><a href="#topic+s_date_FPR">s_date_FPR()</a></code> to specify part of the design matrix for <code>R</code>
format enrollment date; it will produce penalized-spline basis (based on B-splines).
Specify <code>~ 1</code> if no regression is intended. (NB: If <code>effect="fixed"</code>, <code><a href="#topic+dm_Rdate_FPR">dm_Rdate_FPR()</a></code>
will just specify a design matrix with appropriately standardized dates.)</p>
</dd>
</dl>

</dd>
<dt><code>prior</code></dt><dd>

<dl>
<dt>Eti_prior</dt><dd><p>Description of etiology prior (e.g., <code>overall_uniform</code> -
all hyperparameters are <code>1</code>; or <code style="white-space: pre;">&#8288;0_1&#8288;</code> - all hyperparameters are <code>0.1</code>);</p>
</dd>
<dt>TPR_prior</dt><dd><p>Description of priors for the measurements
(e.g., informative vs non-informative). Its length should be the
same as <code>use_measurements</code> above. Please see examples for how to specify.
The package can also handle multiple slices of BrS, SS data, so separate
specification of the TPR priors are needed.
</p>
</dd>
</dl>

</dd>
</dl>
</td></tr>
<tr><td><code id="nplcm_fit_Reg_NoNest_+3A_mcmc_options">mcmc_options</code></td>
<td>
<p>A list of Markov chain Monte Carlo (MCMC) options.
</p>

<ul>
<li> <p><code>debugstatus</code> Logical - whether to pause WinBUGS after it finishes
model fitting; (NB: is this obsolete? Test.)
</p>
</li>
<li> <p><code>n.chains</code> Number of MCMC chains;
</p>
</li>
<li> <p><code>n.burnin</code> Number of burn-in iterations;
</p>
</li>
<li> <p><code>n.thin</code> To keep every other <code>n.thin</code> samples after burn-in period;
</p>
</li>
<li> <p><code>individual.pred</code> <code>TRUE</code> to perform individual prediction (<code>Icat</code>
variables in the <code>.bug</code> file); <code>FALSE</code> otherwise;
</p>
</li>
<li> <p><code>ppd</code> <code>TRUE</code> to simulate new data (<code>XXX.new</code>
variables in the <code>.bug</code> file) from the posterior predictive distribution (ppd);
<code>FALSE</code> otherwise;
</p>
</li>
<li> <p><code>get.pEti</code> <code>TRUE</code> for getting posterior samples of individual etiologic fractions;
<code>FALSE</code> otherwise. For non-regression, or regression models with all discrete predictors,
by default this is <code>TRUE</code>, so no need to specify this entry. It is only relevant for regression models
with non-discrete covariates. Because individuals have distinct CSCFs at their specific covariate values,
it's easier to just store the posterior samples of the regression coefficients and reconstruct the pies afterwards,
rather than storing them through <code>JAGS</code>.
</p>
</li>
<li> <p><code>result.folder</code> Path to folder storing the results;
</p>
</li>
<li> <p><code>bugsmodel.dir</code> Path to <code>.bug</code> model files;
</p>
</li>
<li> <p><code>jags.dir</code> Path to where JAGS is installed; if <code>NULL</code>, this will be set
to <code>jags.dir=""</code>.
</p>
</li></ul>
</td></tr>
</table>


<h3>Details</h3>

<p>This function prepares data, specifies hyperparameters in priors
(true positive rates and CSCFs), initializes the posterior
sampling chain, writes the model file (for JAGS or WinBUGS with slight
differences in syntax), and fits the model. Features:
</p>

<ul>
<li><p> regression (not all discrete covariates);
</p>
</li>
<li><p> no nested subclasses, i.e. conditional independence of
multivariate measurements given disease class and covariates;
</p>
</li>
<li><p> multiple BrS + multiple SS.
</p>
</li></ul>



<h3>Value</h3>

<p>BUGS fit results from <code>JAGS</code>.
</p>


<h3>See Also</h3>

<p><a href="#topic+write_model_NoReg">write_model_NoReg</a> for constructing <code>.bug</code> model file; This function
then puts it in the folder <code>mcmc_options$bugsmodel.dir</code>.
</p>
<p>Other model fitting functions: 
<code><a href="#topic+nplcm_fit_NoReg">nplcm_fit_NoReg</a>()</code>,
<code><a href="#topic+nplcm_fit_Reg_Nest">nplcm_fit_Reg_Nest</a>()</code>,
<code><a href="#topic+nplcm_fit_Reg_discrete_predictor_NoNest">nplcm_fit_Reg_discrete_predictor_NoNest</a>()</code>
</p>

<hr>
<h2 id='nplcm_read_folder'>Read data and other model information from a folder that stores model results.</h2><span id='topic+nplcm_read_folder'></span>

<h3>Description</h3>

<p>Read data and other model information from a folder that stores model results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nplcm_read_folder(DIR_NPLCM)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nplcm_read_folder_+3A_dir_nplcm">DIR_NPLCM</code></td>
<td>
<p>File path to the folder containing posterior samples</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with data, options and posterior samples.
</p>

<ul>
<li> <p><code>bugs.dat</code>
</p>
</li>
<li> <p><code>model_options</code>
</p>
</li>
<li> <p><code>clean_otions</code>
</p>
</li>
<li> <p><code>Nd</code>; <code>Nu</code>; <code>Y</code>; <code>Mobs</code>;
</p>
</li>
<li> <p><code>res_nplcm</code>.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>

data(data_nplcm_noreg)
cause_list &lt;- LETTERS[1:6]
J.BrS      &lt;- 6
model_options_no_reg &lt;- list(
  likelihood   = list(
    cause_list = cause_list,
    k_subclass = 2,
    Eti_formula = ~-1, # no covariate for the etiology regression
    FPR_formula = list(
      MBS1 =   ~-1)    # no covariate for the subclass weight regression
  ),
  use_measurements = c("BrS"), 
  # use bronze-standard data only for model estimation.
  prior= list(
    Eti_prior = overall_uniform(1,cause_list), 
    # Dirichlet(1,...,1) prior for the etiology.
    TPR_prior  = list(BrS = list(
      info  = "informative", # informative prior for TPRs
      input = "match_range", 
      # specify the informative prior for TPRs by specifying a plausible range.
      val = list(MBS1 = list(up =  list(rep(0.99,J.BrS)), 
                             # upper ranges: matched to 97.5% quantile of a Beta prior
                             low = list(rep(0.55,J.BrS))))
      # lower ranges: matched to 2.5% quantile of a Beta prior
    )
    )
  )
)     


set.seed(1)
# include stratification information in file name:
thedir    &lt;- paste0(tempdir(),"_no_reg")

# create folders to store the model results 
dir.create(thedir, showWarnings = FALSE)
result_folder_no_reg &lt;- file.path(thedir,paste("results",collapse="_"))
thedir &lt;- result_folder_no_reg
dir.create(thedir, showWarnings = FALSE)

# options for MCMC chains:
mcmc_options_no_reg &lt;- list(
  debugstatus = TRUE,
  n.chains = 1,
  n.itermcmc = as.integer(200), 
  n.burnin = as.integer(100), 
  n.thin = 1,
  individual.pred = FALSE, 
  ppd = TRUE,
  result.folder = thedir,
  bugsmodel.dir = thedir
)

BrS_object_1 &lt;- make_meas_object(patho = LETTERS[1:6], 
                                 specimen = "MBS", test = "1", 
                                 quality = "BrS", cause_list = cause_list)
clean_options &lt;- list(BrS_objects = make_list(BrS_object_1))
# place the nplcm data and cleaning options into the results folder
dput(data_nplcm_noreg,file.path(thedir,"data_nplcm.txt")) 
dput(clean_options, file.path(thedir, "data_clean_options.txt"))

rjags::load.module("glm")

nplcm_noreg &lt;- nplcm(data_nplcm_noreg,model_options_no_reg,mcmc_options_no_reg)

res &lt;- nplcm_read_folder(nplcm_noreg$DIR_NPLCM)


</code></pre>

<hr>
<h2 id='null_as_zero'>Convert <code>NULL</code> to zero.</h2><span id='topic+null_as_zero'></span>

<h3>Description</h3>

<p><code>null_as_zero</code> make <code>NULL</code> to be zero.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>null_as_zero(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="null_as_zero_+3A_x">x</code></td>
<td>
<p>A number (usually a member of a list) that might be <code>NULL</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A number
</p>

<hr>
<h2 id='order_post_eti'>order latent status by posterior mean</h2><span id='topic+order_post_eti'></span>

<h3>Description</h3>

<p>order latent status by posterior mean
</p>


<h3>Usage</h3>

<pre><code class='language-R'>order_post_eti(res_nplcm, model_options)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="order_post_eti_+3A_res_nplcm">res_nplcm</code></td>
<td>
<p>result from model fits</p>
</td></tr>
<tr><td><code id="order_post_eti_+3A_model_options">model_options</code></td>
<td>
<p>model specification</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list with order (<code>ord</code>) and ordered posterior samples (by column)
</p>

<hr>
<h2 id='overall_uniform'>specify overall uniform (symmetric Dirichlet distribution) for etiology prior</h2><span id='topic+overall_uniform'></span>

<h3>Description</h3>

<p>specify overall uniform (symmetric Dirichlet distribution) for etiology prior
</p>


<h3>Usage</h3>

<pre><code class='language-R'>overall_uniform(alpha, cause_list)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="overall_uniform_+3A_alpha">alpha</code></td>
<td>
<p>any positive number, usually 1.</p>
</td></tr>
<tr><td><code id="overall_uniform_+3A_cause_list">cause_list</code></td>
<td>
<p>a list of latent status</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector of length <code>length(cause_list)</code>
</p>


<h3>See Also</h3>

<p>Other prior specification functions: 
<code><a href="#topic+set_prior_tpr_BrS_NoNest">set_prior_tpr_BrS_NoNest</a>()</code>,
<code><a href="#topic+set_prior_tpr_SS">set_prior_tpr_SS</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
overall_uniform(1,c("A","B","C"))

</code></pre>

<hr>
<h2 id='parse_nplcm_reg'>parse regression components (either false positive rate or etiology regression)
for fitting npLCM; Only use this when formula is not <code>NULL</code>.</h2><span id='topic+parse_nplcm_reg'></span>

<h3>Description</h3>

<p>parse regression components (either false positive rate or etiology regression)
for fitting npLCM; Only use this when formula is not <code>NULL</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>parse_nplcm_reg(form, data_nplcm, silent = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="parse_nplcm_reg_+3A_form">form</code></td>
<td>
<p>regression formula</p>
</td></tr>
<tr><td><code id="parse_nplcm_reg_+3A_data_nplcm">data_nplcm</code></td>
<td>
<p>data object for <code><a href="#topic+nplcm">nplcm()</a></code>; may contain covariates X;
must have case-control status Y.</p>
</td></tr>
<tr><td><code id="parse_nplcm_reg_+3A_silent">silent</code></td>
<td>
<p>Default is <code>TRUE</code> for no message about covariates;
<code>FALSE</code> otherwise.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>TRUE</code> for doing regression; <code>FALSE</code> otherwise.
</p>

<hr>
<h2 id='pathogen_category_perch'>pathogens and their categories in PERCH study (virus or bacteria)</h2><span id='topic+pathogen_category_perch'></span>

<h3>Description</h3>

<p>231 rows indicating bacteria, virus, fungi, or other categories.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("pathogen_category_perch")
</code></pre>


<h3>Format</h3>

<p>A matrix of two columns
</p>

<dl>
<dt>pathogen</dt><dd><p>names of the pathogens</p>
</dd>
<dt>pathogen_type</dt><dd><p>category of the pathogens, <code>B</code> for
bacterium, <code>V</code> for virus, <code>F</code> for fungus, <code>O</code> for &quot;not categorized&quot;</p>
</dd>
</dl>



<h3>Value</h3>

<p>No returned value; just loading data into the working space.
</p>

<hr>
<h2 id='pathogen_category_simulation'>Hypothetical pathogens and their categories (virus or bacteria)</h2><span id='topic+pathogen_category_simulation'></span>

<h3>Description</h3>

<p>This is used in simulations where the pathogen names are from the alphabet,
and we hope to plot etiologies grouped by virus or bacteria
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("pathogen_category_simulation")
</code></pre>


<h3>Format</h3>

<p>A matrix of two columns
</p>

<dl>
<dt>pathogen</dt><dd><p>names of the hypothetical pathogens, A-Z</p>
</dd>
<dt>pathogen_type</dt><dd><p>category of the hypothetical pathogens, <code>B</code> for
bacterium, <code>V</code> for virus, which are randomly assigned.</p>
</dd>
</dl>



<h3>Value</h3>

<p>No returned value; just loading data into the working space.
</p>

<hr>
<h2 id='plot_BrS_panel'>Plot bronze-standard (BrS) panel</h2><span id='topic+plot_BrS_panel'></span>

<h3>Description</h3>

<p>Plot bronze-standard (BrS) panel
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_BrS_panel(
  slice,
  data_nplcm,
  model_options,
  clean_options,
  bugs.dat,
  res_nplcm,
  bg_color,
  select_latent = NULL,
  exact = TRUE,
  top_BrS = 1.3,
  cexval = 1,
  srtval = 0,
  prior_shape = "interval",
  silent = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_BrS_panel_+3A_slice">slice</code></td>
<td>
<p>the index of measurement slice for BrS.</p>
</td></tr>
<tr><td><code id="plot_BrS_panel_+3A_data_nplcm">data_nplcm</code></td>
<td>
<p>See <code><a href="#topic+nplcm">nplcm()</a></code></p>
</td></tr>
<tr><td><code id="plot_BrS_panel_+3A_model_options">model_options</code></td>
<td>
<p>See <code><a href="#topic+nplcm">nplcm()</a></code></p>
</td></tr>
<tr><td><code id="plot_BrS_panel_+3A_clean_options">clean_options</code></td>
<td>
<p>See <code><a href="#topic+clean_perch_data">clean_perch_data()</a></code></p>
</td></tr>
<tr><td><code id="plot_BrS_panel_+3A_bugs.dat">bugs.dat</code></td>
<td>
<p>Data input for the model fitting.</p>
</td></tr>
<tr><td><code id="plot_BrS_panel_+3A_res_nplcm">res_nplcm</code></td>
<td>
<p>See <code><a href="#topic+nplcm_read_folder">nplcm_read_folder()</a></code></p>
</td></tr>
<tr><td><code id="plot_BrS_panel_+3A_bg_color">bg_color</code></td>
<td>
<p>A list with names &quot;BrS&quot;, &quot;SS&quot;, &quot;pie&quot; to specify background colors</p>
</td></tr>
<tr><td><code id="plot_BrS_panel_+3A_select_latent">select_latent</code></td>
<td>
<p>a vector of character strings representing latent status. It is used for
just plotting a subset of latent status. For example, you can specify <code>select_latent = "HINF"</code>
to plot all latent status information relevant to <code>"HINF"</code>.</p>
</td></tr>
<tr><td><code id="plot_BrS_panel_+3A_exact">exact</code></td>
<td>
<p>Default is <code>TRUE</code> to use <code>select_latent</code> as exact names of causes. If you want to
specify a name and plot all single or combo causes with that name, specify it to be <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="plot_BrS_panel_+3A_top_brs">top_BrS</code></td>
<td>
<p>Numerical value to specify the rightmost limit
on the horizontal axis for the BrS panel.</p>
</td></tr>
<tr><td><code id="plot_BrS_panel_+3A_cexval">cexval</code></td>
<td>
<p>Default is 1 - size of text of the BrS percentages.</p>
</td></tr>
<tr><td><code id="plot_BrS_panel_+3A_srtval">srtval</code></td>
<td>
<p>Default is 0 - the direction of the text for the BrS percentages.</p>
</td></tr>
<tr><td><code id="plot_BrS_panel_+3A_prior_shape">prior_shape</code></td>
<td>
<p><code>interval</code> or <code>boxplot</code> - for how to represent
prior/posteriors of the TPR/FPRs of measurements.</p>
</td></tr>
<tr><td><code id="plot_BrS_panel_+3A_silent">silent</code></td>
<td>
<p>Default is TRUE to not print any warning messages; FALSE otherwise.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>plotting function.
</p>


<h3>See Also</h3>

<p>Other visualization functions: 
<code><a href="#topic+plot.nplcm">plot.nplcm</a>()</code>,
<code><a href="#topic+plot_SS_panel">plot_SS_panel</a>()</code>,
<code><a href="#topic+plot_check_common_pattern">plot_check_common_pattern</a>()</code>,
<code><a href="#topic+plot_check_pairwise_SLORD">plot_check_pairwise_SLORD</a>()</code>,
<code><a href="#topic+plot_etiology_regression">plot_etiology_regression</a>()</code>,
<code><a href="#topic+plot_etiology_strat">plot_etiology_strat</a>()</code>,
<code><a href="#topic+plot_panels">plot_panels</a>()</code>,
<code><a href="#topic+plot_pie_panel">plot_pie_panel</a>()</code>,
<code><a href="#topic+plot_subwt_regression">plot_subwt_regression</a>()</code>
</p>

<hr>
<h2 id='plot_case_study'>visualize the PERCH etiology regression with a continuous covariate</h2><span id='topic+plot_case_study'></span>

<h3>Description</h3>

<p>This function is specifically designed for PERCH data, e.g.,
(NB: dealing with NoA, multiple-pathogen causes, other continuous covariates?
also there this function only plots the first slice - so generalization may be useful - give
users an option to choose slice s; currently default to the first slice.)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_case_study(
  DIR_NPLCM,
  stratum_bool = stratum_bool,
  bugs.dat = NULL,
  slice = 1,
  RES_NPLCM = NULL,
  do_plot = TRUE,
  do_rug = FALSE,
  return_metric = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_case_study_+3A_dir_nplcm">DIR_NPLCM</code></td>
<td>
<p>File path to the folder containing posterior samples</p>
</td></tr>
<tr><td><code id="plot_case_study_+3A_stratum_bool">stratum_bool</code></td>
<td>
<p>integer; for this function, indicates which strata to plot</p>
</td></tr>
<tr><td><code id="plot_case_study_+3A_bugs.dat">bugs.dat</code></td>
<td>
<p>The posterior samples (loaded into the environment to save time) -&gt; default is NULL</p>
</td></tr>
<tr><td><code id="plot_case_study_+3A_slice">slice</code></td>
<td>
<p>integer; specifies which slice of bronze-standard data to visualize; Default to 1.</p>
</td></tr>
<tr><td><code id="plot_case_study_+3A_res_nplcm">RES_NPLCM</code></td>
<td>
<p>pre-read res_nplcm; default to NULL.</p>
</td></tr>
<tr><td><code id="plot_case_study_+3A_do_plot">do_plot</code></td>
<td>
<p>TRUE for plotting</p>
</td></tr>
<tr><td><code id="plot_case_study_+3A_do_rug">do_rug</code></td>
<td>
<p>TRUE for plotting</p>
</td></tr>
<tr><td><code id="plot_case_study_+3A_return_metric">return_metric</code></td>
<td>
<p>TRUE for showing overall mean etiology, quantiles, s.d., and if <code>truth$Eti</code> is supplied,
coverage, bias, truth and integrated mean squared errors (IMSE).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A figure of etiology regression curves and some marginal positive rate assessment of
model fit; See example for the legends.
</p>

<hr>
<h2 id='plot_check_common_pattern'>Posterior predictive checking for the nested partially class models -
frequent patterns in the BrS data. (for multiple folders)</h2><span id='topic+plot_check_common_pattern'></span>

<h3>Description</h3>

<p>At each MCMC iteration, we generate a new data set based on the model and
parameter values at that iteration. The sample size of the new data set equals
that of the actual data set, i.e. the same number of cases and controls.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_check_common_pattern(
  DIR_list,
  slice_vec = rep(1, length(DIR_list)),
  n_pat = 10,
  dodge_val = 0.8
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_check_common_pattern_+3A_dir_list">DIR_list</code></td>
<td>
<p>The list of directory paths, each storing a model output.</p>
</td></tr>
<tr><td><code id="plot_check_common_pattern_+3A_slice_vec">slice_vec</code></td>
<td>
<p>Default are 1s, for the first slice of BrS data.</p>
</td></tr>
<tr><td><code id="plot_check_common_pattern_+3A_n_pat">n_pat</code></td>
<td>
<p>Number of the most common BrS measurement pattern among cases and controls.
Default is 10.</p>
</td></tr>
<tr><td><code id="plot_check_common_pattern_+3A_dodge_val">dodge_val</code></td>
<td>
<p>Default is 0.8; For width of boxplots.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A figure of posterior predicted frequencies compared with the observed
frequencies of the most common patterns for the BrS data.
</p>


<h3>See Also</h3>

<p>Other visualization functions: 
<code><a href="#topic+plot.nplcm">plot.nplcm</a>()</code>,
<code><a href="#topic+plot_BrS_panel">plot_BrS_panel</a>()</code>,
<code><a href="#topic+plot_SS_panel">plot_SS_panel</a>()</code>,
<code><a href="#topic+plot_check_pairwise_SLORD">plot_check_pairwise_SLORD</a>()</code>,
<code><a href="#topic+plot_etiology_regression">plot_etiology_regression</a>()</code>,
<code><a href="#topic+plot_etiology_strat">plot_etiology_strat</a>()</code>,
<code><a href="#topic+plot_panels">plot_panels</a>()</code>,
<code><a href="#topic+plot_pie_panel">plot_pie_panel</a>()</code>,
<code><a href="#topic+plot_subwt_regression">plot_subwt_regression</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(data_nplcm_noreg)
cause_list &lt;- LETTERS[1:6]
J.BrS      &lt;- 6
model_options_no_reg &lt;- list(
  likelihood   = list(
    cause_list = cause_list,
    k_subclass = 2,
    Eti_formula = ~-1, # no covariate for the etiology regression
    FPR_formula = list(
      MBS1 =   ~-1)    # no covariate for the subclass weight regression
  ),
  use_measurements = c("BrS"), 
  # use bronze-standard data only for model estimation.
  prior= list(
    Eti_prior = overall_uniform(1,cause_list), 
    # Dirichlet(1,...,1) prior for the etiology.
    TPR_prior  = list(BrS = list(
      info  = "informative", # informative prior for TPRs
      input = "match_range", 
      # specify the informative prior for TPRs by specifying a plausible range.
      val = list(MBS1 = list(up =  list(rep(0.99,J.BrS)), 
                             # upper ranges: matched to 97.5% quantile of a Beta prior
                             low = list(rep(0.55,J.BrS))))
      # lower ranges: matched to 2.5% quantile of a Beta prior
    )
    )
  )
)     


set.seed(1)
# include stratification information in file name:
thedir    &lt;- paste0(tempdir(),"_no_reg")

# create folders to store the model results 
dir.create(thedir, showWarnings = FALSE)
result_folder_no_reg &lt;- file.path(thedir,paste("results",collapse="_"))
thedir &lt;- result_folder_no_reg
dir.create(thedir, showWarnings = FALSE)

# options for MCMC chains:
mcmc_options_no_reg &lt;- list(
  debugstatus = TRUE,
  n.chains = 1,
  n.itermcmc = as.integer(200), 
  n.burnin = as.integer(100), 
  n.thin = 1,
  individual.pred = FALSE, 
  ppd = TRUE,
  result.folder = thedir,
  bugsmodel.dir = thedir
)

BrS_object_1 &lt;- make_meas_object(patho = LETTERS[1:6], 
                                 specimen = "MBS", test = "1", 
                                 quality = "BrS", cause_list = cause_list)
clean_options &lt;- list(BrS_objects = make_list(BrS_object_1))
# place the nplcm data and cleaning options into the results folder
dput(data_nplcm_noreg,file.path(thedir,"data_nplcm.txt")) 
dput(clean_options, file.path(thedir, "data_clean_options.txt"))

rjags::load.module("glm")

nplcm_noreg &lt;- nplcm(data_nplcm_noreg,model_options_no_reg,mcmc_options_no_reg)

plot_check_common_pattern(nplcm_noreg$DIR_NPLCM)



</code></pre>

<hr>
<h2 id='plot_check_pairwise_SLORD'>Posterior predictive checking for nested partially latent class models -
pairwise log odds ratio (only for bronze-standard data)</h2><span id='topic+plot_check_pairwise_SLORD'></span>

<h3>Description</h3>

<p>At each MCMC iteration, we generate a new data set based on the model and
parameter values at that iteration. The sample size of the new data set equals
that of the actual data set, i.e. the same number of cases and controls.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_check_pairwise_SLORD(DIR_NPLCM, slice = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_check_pairwise_SLORD_+3A_dir_nplcm">DIR_NPLCM</code></td>
<td>
<p>File path to the folder that stores results from npLCM fit.</p>
</td></tr>
<tr><td><code id="plot_check_pairwise_SLORD_+3A_slice">slice</code></td>
<td>
<p>Default is 1, for the first slice of BrS data.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A figure of posterior predicted log odds ratio compared with the observed
log odds ratio for the BrS data. The function generates this figure in your working directory automatically.
</p>


<h3>See Also</h3>

<p>Other visualization functions: 
<code><a href="#topic+plot.nplcm">plot.nplcm</a>()</code>,
<code><a href="#topic+plot_BrS_panel">plot_BrS_panel</a>()</code>,
<code><a href="#topic+plot_SS_panel">plot_SS_panel</a>()</code>,
<code><a href="#topic+plot_check_common_pattern">plot_check_common_pattern</a>()</code>,
<code><a href="#topic+plot_etiology_regression">plot_etiology_regression</a>()</code>,
<code><a href="#topic+plot_etiology_strat">plot_etiology_strat</a>()</code>,
<code><a href="#topic+plot_panels">plot_panels</a>()</code>,
<code><a href="#topic+plot_pie_panel">plot_pie_panel</a>()</code>,
<code><a href="#topic+plot_subwt_regression">plot_subwt_regression</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 data(data_nplcm_noreg)
cause_list &lt;- LETTERS[1:6]
J.BrS      &lt;- 6
model_options_no_reg &lt;- list(
  likelihood   = list(
    cause_list = cause_list,
    k_subclass = 2,
    Eti_formula = ~-1, # no covariate for the etiology regression
    FPR_formula = list(
      MBS1 =   ~-1)    # no covariate for the subclass weight regression
  ),
  use_measurements = c("BrS"), 
  # use bronze-standard data only for model estimation.
  prior= list(
    Eti_prior = overall_uniform(1,cause_list), 
    # Dirichlet(1,...,1) prior for the etiology.
    TPR_prior  = list(BrS = list(
      info  = "informative", # informative prior for TPRs
      input = "match_range", 
      # specify the informative prior for TPRs by specifying a plausible range.
      val = list(MBS1 = list(up =  list(rep(0.99,J.BrS)), 
                             # upper ranges: matched to 97.5% quantile of a Beta prior
                             low = list(rep(0.55,J.BrS))))
      # lower ranges: matched to 2.5% quantile of a Beta prior
    )
    )
  )
)     


set.seed(1)
# include stratification information in file name:
thedir    &lt;- paste0(tempdir(),"_no_reg")

# create folders to store the model results 
dir.create(thedir, showWarnings = FALSE)
result_folder_no_reg &lt;- file.path(thedir,paste("results",collapse="_"))
thedir &lt;- result_folder_no_reg
dir.create(thedir, showWarnings = FALSE)

# options for MCMC chains:
mcmc_options_no_reg &lt;- list(
  debugstatus = TRUE,
  n.chains = 1,
  n.itermcmc = as.integer(200), 
  n.burnin = as.integer(100), 
  n.thin = 1,
  individual.pred = FALSE, 
  ppd = TRUE,
  result.folder = thedir,
  bugsmodel.dir = thedir
)

BrS_object_1 &lt;- make_meas_object(patho = LETTERS[1:6], 
                                 specimen = "MBS", test = "1", 
                                 quality = "BrS", cause_list = cause_list)
clean_options &lt;- list(BrS_objects = make_list(BrS_object_1))
# place the nplcm data and cleaning options into the results folder
dput(data_nplcm_noreg,file.path(thedir,"data_nplcm.txt")) 
dput(clean_options, file.path(thedir, "data_clean_options.txt"))

rjags::load.module("glm")

nplcm_noreg &lt;- nplcm(data_nplcm_noreg,model_options_no_reg,mcmc_options_no_reg)

plot_check_pairwise_SLORD(nplcm_noreg$DIR_NPLCM,slice=1)

</code></pre>

<hr>
<h2 id='plot_etiology_regression'>visualize the etiology regression with a continuous covariate</h2><span id='topic+plot_etiology_regression'></span>

<h3>Description</h3>

<p>This function visualizes the etiology regression against one continuous covariate, e.g.,
enrollment date. (NB: dealing with NoA, multiple-pathogen causes, other continuous covariates?
also there this function only plots the first slice - so generalization may be useful - give
users an option to choose slice s; currently default to the first slice.)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_etiology_regression(
  DIR_NPLCM,
  stratum_bool,
  slice = 1,
  plot_basis = FALSE,
  truth = NULL,
  RES_NPLCM = NULL,
  do_plot = TRUE,
  do_rug = TRUE,
  return_metric = TRUE,
  plot_ma_dots = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_etiology_regression_+3A_dir_nplcm">DIR_NPLCM</code></td>
<td>
<p>File path to the folder containing posterior samples</p>
</td></tr>
<tr><td><code id="plot_etiology_regression_+3A_stratum_bool">stratum_bool</code></td>
<td>
<p>a vector of TRUE/FALSE with TRUE indicating the rows of subjects to include</p>
</td></tr>
<tr><td><code id="plot_etiology_regression_+3A_slice">slice</code></td>
<td>
<p>integer; specifies which slice of bronze-standard data to visualize; Default to 1.</p>
</td></tr>
<tr><td><code id="plot_etiology_regression_+3A_plot_basis">plot_basis</code></td>
<td>
<p>TRUE for plotting basis functions; Default to FALSE</p>
</td></tr>
<tr><td><code id="plot_etiology_regression_+3A_truth">truth</code></td>
<td>
<p>a list of truths computed from true parameters in simulations; elements:
Eti, FPR, PR_case,TPR; All default to <code>NULL</code> in real data analyses.
Currently only works for one slice of bronze-standard measurements (in a non-nested model).
</p>

<ul>
<li><p> Eti matrix of # of rows = # of subjects, # columns: <code>length(cause_list)</code> for Eti
</p>
</li>
<li><p> FPR matrix of # of rows = # of subjects, # columns: <code>ncol(data_nplcm$Mobs$MBS$MBS1)</code>
</p>
</li>
<li><p> PR_case matrix of # of rows = # of subjects, # columns: <code>ncol(data_nplcm$Mobs$MBS$MBS1)</code>
</p>
</li>
<li><p> TPR a vector of length identical to <code>PR_case</code>
</p>
</li></ul>
</td></tr>
<tr><td><code id="plot_etiology_regression_+3A_res_nplcm">RES_NPLCM</code></td>
<td>
<p>pre-read res_nplcm; default to NULL.</p>
</td></tr>
<tr><td><code id="plot_etiology_regression_+3A_do_plot">do_plot</code></td>
<td>
<p>TRUE for plotting</p>
</td></tr>
<tr><td><code id="plot_etiology_regression_+3A_do_rug">do_rug</code></td>
<td>
<p>TRUE for plotting</p>
</td></tr>
<tr><td><code id="plot_etiology_regression_+3A_return_metric">return_metric</code></td>
<td>
<p>TRUE for showing overall mean etiology, quantiles, s.d., and if <code>truth$Eti</code> is supplied,
coverage, bias, truth and integrated mean squared errors (IMSE).</p>
</td></tr>
<tr><td><code id="plot_etiology_regression_+3A_plot_ma_dots">plot_ma_dots</code></td>
<td>
<p>plot moving averages among case and controls if TRUE; Default to FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A figure of etiology regression curves and some marginal positive rate assessment of
model fit; See example for the legends.
</p>


<h3>References</h3>

<p>See example figures
</p>

<ul>
<li><p> A Figure using simulated data for six pathogens:
<a href="https://github.com/zhenkewu/baker/blob/master/inst/figs/visualize_etiology_regression_SITE=1.pdf">https://github.com/zhenkewu/baker/blob/master/inst/figs/visualize_etiology_regression_SITE=1.pdf</a>
</p>
</li>
<li><p> The legends for the figure above:
<a href="https://github.com/zhenkewu/baker/blob/master/inst/figs/legends_visualize_etiology_regression.png">https://github.com/zhenkewu/baker/blob/master/inst/figs/legends_visualize_etiology_regression.png</a>
</p>
</li></ul>



<h3>See Also</h3>

<p>Other visualization functions: 
<code><a href="#topic+plot.nplcm">plot.nplcm</a>()</code>,
<code><a href="#topic+plot_BrS_panel">plot_BrS_panel</a>()</code>,
<code><a href="#topic+plot_SS_panel">plot_SS_panel</a>()</code>,
<code><a href="#topic+plot_check_common_pattern">plot_check_common_pattern</a>()</code>,
<code><a href="#topic+plot_check_pairwise_SLORD">plot_check_pairwise_SLORD</a>()</code>,
<code><a href="#topic+plot_etiology_strat">plot_etiology_strat</a>()</code>,
<code><a href="#topic+plot_panels">plot_panels</a>()</code>,
<code><a href="#topic+plot_pie_panel">plot_pie_panel</a>()</code>,
<code><a href="#topic+plot_subwt_regression">plot_subwt_regression</a>()</code>
</p>

<hr>
<h2 id='plot_etiology_strat'>visualize the etiology estimates for each discrete levels</h2><span id='topic+plot_etiology_strat'></span>

<h3>Description</h3>

<p>This function visualizes the etiology estimates against one discrete covariate, e.g.,
age groups.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_etiology_strat(
  DIR_NPLCM,
  strata_weights = "empirical",
  truth = NULL,
  RES_NPLCM = NULL,
  show_levels = 0,
  is_plot = TRUE,
  VERBOSE = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_etiology_strat_+3A_dir_nplcm">DIR_NPLCM</code></td>
<td>
<p>File path to the folder containing posterior samples</p>
</td></tr>
<tr><td><code id="plot_etiology_strat_+3A_strata_weights">strata_weights</code></td>
<td>
<p>a vector of weights that sum to one; for each pathogen
the weights specify how the j-th etiology fraction should be combined across all
levels of the discrete predictors in the data; default is <code>"empirical"</code>
to use empirical weights (observed fractions of subjects across strata).</p>
</td></tr>
<tr><td><code id="plot_etiology_strat_+3A_truth">truth</code></td>
<td>
<p>a list of true values, e.g.,
<code style="white-space: pre;">&#8288;truth=list(allEti = &lt;a list of etiology fractions, each of identical length - the # of strata; &gt;)&#8288;</code>;
if available, will be shown in thicker red solid vertical lines.</p>
</td></tr>
<tr><td><code id="plot_etiology_strat_+3A_res_nplcm">RES_NPLCM</code></td>
<td>
<p>pre-read <code>res_nplcm</code>; default to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="plot_etiology_strat_+3A_show_levels">show_levels</code></td>
<td>
<p>a vector of integers less than or equal to the total number of
levels of strata; default to <code>0</code> for overall.</p>
</td></tr>
<tr><td><code id="plot_etiology_strat_+3A_is_plot">is_plot</code></td>
<td>
<p>default to TRUE, plotting the figures; if <code>FALSE</code> only returning summaries</p>
</td></tr>
<tr><td><code id="plot_etiology_strat_+3A_verbose">VERBOSE</code></td>
<td>
<p>default to <code>TRUE</code>, print actual meanings of the levels</p>
</td></tr>
</table>


<h3>Value</h3>

<p>plotting function
</p>


<h3>See Also</h3>

<p>Other visualization functions: 
<code><a href="#topic+plot.nplcm">plot.nplcm</a>()</code>,
<code><a href="#topic+plot_BrS_panel">plot_BrS_panel</a>()</code>,
<code><a href="#topic+plot_SS_panel">plot_SS_panel</a>()</code>,
<code><a href="#topic+plot_check_common_pattern">plot_check_common_pattern</a>()</code>,
<code><a href="#topic+plot_check_pairwise_SLORD">plot_check_pairwise_SLORD</a>()</code>,
<code><a href="#topic+plot_etiology_regression">plot_etiology_regression</a>()</code>,
<code><a href="#topic+plot_panels">plot_panels</a>()</code>,
<code><a href="#topic+plot_pie_panel">plot_pie_panel</a>()</code>,
<code><a href="#topic+plot_subwt_regression">plot_subwt_regression</a>()</code>
</p>

<hr>
<h2 id='plot_leftmost'>plotting the labels on the left margin for panels plot</h2><span id='topic+plot_leftmost'></span>

<h3>Description</h3>

<p>plotting the labels on the left margin for panels plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_leftmost(model_options, height)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_leftmost_+3A_model_options">model_options</code></td>
<td>
<p>See <code><a href="#topic+nplcm">nplcm()</a></code></p>
</td></tr>
<tr><td><code id="plot_leftmost_+3A_height">height</code></td>
<td>
<p>no. of rows in the panels plot; commonly set as <code>length(select_latent)</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a plot
</p>


<h3>See Also</h3>

<p><a href="#topic+plot_panels">plot_panels</a>
</p>

<hr>
<h2 id='plot_logORmat'>Visualize pairwise log odds ratios (LOR) for data that are available in
both cases and controls</h2><span id='topic+plot_logORmat'></span>

<h3>Description</h3>

<p>Visualize pairwise log odds ratios (LOR) for data that are available in
both cases and controls
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_logORmat(data_nplcm, pathogen_display, BrS_slice = 1, logOR_rounding = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_logORmat_+3A_data_nplcm">data_nplcm</code></td>
<td>
<p>See <code><a href="#topic+assign_model">assign_model()</a></code>.</p>
</td></tr>
<tr><td><code id="plot_logORmat_+3A_pathogen_display">pathogen_display</code></td>
<td>
<p>The pathogen vector in desired order for display.
It can be of larger length than that of <code>pathogen_BrS</code>.</p>
</td></tr>
<tr><td><code id="plot_logORmat_+3A_brs_slice">BrS_slice</code></td>
<td>
<p>Default is 1 - the set of BrS data to visualize.</p>
</td></tr>
<tr><td><code id="plot_logORmat_+3A_logor_rounding">logOR_rounding</code></td>
<td>
<p>Rounding number of the log odds ratio. Default is 2.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>plot_logORmat</code> visualizes a matrix of pairwise log odds ratios (LOR)
for cases (upper) and controls (lower). LOR is at the top of the cell.
Below it, its standard error is in smaller type, using the same color as the LOR.
Then the estimate is divided by its standard error. We put the actual value when
the Z-statistics has an absolute value greater than $2$; a plus (red) or minus (blue)
if between $1$ and $2$; blank otherwise.
</p>


<h3>Value</h3>

<p>Figure of LOR matrix and relevant s.e. and significance information.
</p>


<h3>See Also</h3>

<p>Other exploratory data analysis functions: 
<code><a href="#topic+get_top_pattern">get_top_pattern</a>()</code>,
<code><a href="#topic+show_individual">show_individual</a>()</code>,
<code><a href="#topic+summarize_BrS">summarize_BrS</a>()</code>,
<code><a href="#topic+summarize_SS">summarize_SS</a>()</code>,
<code><a href="#topic+visualize_season">visualize_season</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(data_nplcm_noreg)
plot_logORmat(data_nplcm_noreg,names(data_nplcm_noreg$Mobs$MBS[[1]]))

</code></pre>

<hr>
<h2 id='plot_panels'>Plot three-panel figures for nested partially-latent model results</h2><span id='topic+plot_panels'></span>

<h3>Description</h3>

<p><code>plot_panels()</code> visualizes the model outputs for communicating how the data inform final
latent disease status (etiology). It works for singleton or combo etiologies.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_panels(
  DIR_NPLCM,
  slices = "all",
  bg_color = list(BrS = "lavenderblush", SS = "mistyrose", pie = "antiquewhite"),
  select_latent = NULL,
  exact = TRUE,
  SS_upperlimit = 1,
  eti_upperlimit = 1,
  silent = TRUE,
  ref_eti0 = NULL,
  is_plot = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_panels_+3A_dir_nplcm">DIR_NPLCM</code></td>
<td>
<p>File path to the folder containing posterior samples</p>
</td></tr>
<tr><td><code id="plot_panels_+3A_slices">slices</code></td>
<td>
<p>DEFAULT is &quot;all&quot; - to plot all measurements; Otherwise, one can
specify a list: <code>list(MBS=c(1,3),MSS=1)</code> means to plot the 1st and
3rd slice of BrS measurements and 1st of SS measurement.</p>
</td></tr>
<tr><td><code id="plot_panels_+3A_bg_color">bg_color</code></td>
<td>
<p>A list with names &quot;BrS&quot;, &quot;SS&quot;, &quot;pie&quot; to specify background colors.
The current default is <code>list(BrS = "lavenderblush", SS = "mistyrose",  pie="antiquewhite")</code>. If no background is intended, specify as NULL or for a particular
measurement, e.g., <code>BrS = NULL</code>.</p>
</td></tr>
<tr><td><code id="plot_panels_+3A_select_latent">select_latent</code></td>
<td>
<p>a vector of character strings representing latent status. It is used for
just plotting a subset of latent status. For example, you can specify <code>select_latent = "HINF"</code>
to plot all latent status information relevant to <code>"HINF"</code>.</p>
</td></tr>
<tr><td><code id="plot_panels_+3A_exact">exact</code></td>
<td>
<p>Default is <code>TRUE</code> to use <code>select_latent</code> as exact names of causes. If you want to
specify a name and plot all single or combo causes with that name, specify it to be <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="plot_panels_+3A_ss_upperlimit">SS_upperlimit</code></td>
<td>
<p>The upper limit of horizontal bar for the silver-standard
subpanel (the middle panel). The default value is .25.</p>
</td></tr>
<tr><td><code id="plot_panels_+3A_eti_upperlimit">eti_upperlimit</code></td>
<td>
<p>The upper limit of horizontal bar for the etiology
posterior subpanel (the rightmost panel). The default value is .4</p>
</td></tr>
<tr><td><code id="plot_panels_+3A_silent">silent</code></td>
<td>
<p>Default is TRUE to not print any warning messages; FALSE otherwise.</p>
</td></tr>
<tr><td><code id="plot_panels_+3A_ref_eti0">ref_eti0</code></td>
<td>
<p>reference quantiles and means; a list: pEti_ref_q, pEti_ref_mean_ord</p>
</td></tr>
<tr><td><code id="plot_panels_+3A_is_plot">is_plot</code></td>
<td>
<p>default to <code>TRUE</code> for plotting only; set to <code>FALSE</code> if to get summary.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Missing data for BrS or SS are dropped when calculating observed measurement
positive rates
</p>


<h3>Value</h3>

<p>A figure with two or three columns (if <code>is_plot=TRUE</code>); otherwise, it
provide posterior summaries of Etiology information to
used by <code><a href="#topic+print.summary.nplcm.no_reg">print.summary.nplcm.no_reg()</a></code>
</p>


<h3>See Also</h3>

<p>Other visualization functions: 
<code><a href="#topic+plot.nplcm">plot.nplcm</a>()</code>,
<code><a href="#topic+plot_BrS_panel">plot_BrS_panel</a>()</code>,
<code><a href="#topic+plot_SS_panel">plot_SS_panel</a>()</code>,
<code><a href="#topic+plot_check_common_pattern">plot_check_common_pattern</a>()</code>,
<code><a href="#topic+plot_check_pairwise_SLORD">plot_check_pairwise_SLORD</a>()</code>,
<code><a href="#topic+plot_etiology_regression">plot_etiology_regression</a>()</code>,
<code><a href="#topic+plot_etiology_strat">plot_etiology_strat</a>()</code>,
<code><a href="#topic+plot_pie_panel">plot_pie_panel</a>()</code>,
<code><a href="#topic+plot_subwt_regression">plot_subwt_regression</a>()</code>
</p>

<hr>
<h2 id='plot_pie_panel'>Plot etiology (pie) panel</h2><span id='topic+plot_pie_panel'></span>

<h3>Description</h3>

<p>Plot etiology (pie) panel
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_pie_panel(
  model_options,
  res_nplcm,
  bugs.dat,
  bg_color,
  select_latent = NULL,
  exact = TRUE,
  top_pie = 1,
  label_size = 1,
  ref_eti = NULL,
  is_plot = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_pie_panel_+3A_model_options">model_options</code></td>
<td>
<p>See <code><a href="#topic+nplcm">nplcm()</a></code></p>
</td></tr>
<tr><td><code id="plot_pie_panel_+3A_res_nplcm">res_nplcm</code></td>
<td>
<p>See <code><a href="#topic+nplcm_read_folder">nplcm_read_folder()</a></code></p>
</td></tr>
<tr><td><code id="plot_pie_panel_+3A_bugs.dat">bugs.dat</code></td>
<td>
<p>Data input for the model fitting.</p>
</td></tr>
<tr><td><code id="plot_pie_panel_+3A_bg_color">bg_color</code></td>
<td>
<p>A list with names &quot;BrS&quot;, &quot;SS&quot;, &quot;pie&quot; to specify background colors</p>
</td></tr>
<tr><td><code id="plot_pie_panel_+3A_select_latent">select_latent</code></td>
<td>
<p>a vector of character strings representing latent status. It is used for
just plotting a subset of latent status. For example, you can specify <code>select_latent = "HINF"</code></p>
</td></tr>
<tr><td><code id="plot_pie_panel_+3A_exact">exact</code></td>
<td>
<p>Default is <code>TRUE</code> to use <code>select_latent</code> as exact names of causes. If you want to
specify a name and plot all single or combo causes with that name, specify it to be <code>FALSE</code>.
to plot all latent status information relevant to <code>"HINF"</code>.</p>
</td></tr>
<tr><td><code id="plot_pie_panel_+3A_top_pie">top_pie</code></td>
<td>
<p>Numerical value to specify the rightmost limit
on the horizontal axis for the pie panel.</p>
</td></tr>
<tr><td><code id="plot_pie_panel_+3A_label_size">label_size</code></td>
<td>
<p>the size of latent status labels on the right margin</p>
</td></tr>
<tr><td><code id="plot_pie_panel_+3A_ref_eti">ref_eti</code></td>
<td>
<p>reference quantiles and means; a list: pEti_ref_q, pEti_ref_mean_ord</p>
</td></tr>
<tr><td><code id="plot_pie_panel_+3A_is_plot">is_plot</code></td>
<td>
<p>default to <code>TRUE</code> for plotting only; set to <code>FALSE</code> if to get summary.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>plotting function.
</p>


<h3>See Also</h3>

<p>Other visualization functions: 
<code><a href="#topic+plot.nplcm">plot.nplcm</a>()</code>,
<code><a href="#topic+plot_BrS_panel">plot_BrS_panel</a>()</code>,
<code><a href="#topic+plot_SS_panel">plot_SS_panel</a>()</code>,
<code><a href="#topic+plot_check_common_pattern">plot_check_common_pattern</a>()</code>,
<code><a href="#topic+plot_check_pairwise_SLORD">plot_check_pairwise_SLORD</a>()</code>,
<code><a href="#topic+plot_etiology_regression">plot_etiology_regression</a>()</code>,
<code><a href="#topic+plot_etiology_strat">plot_etiology_strat</a>()</code>,
<code><a href="#topic+plot_panels">plot_panels</a>()</code>,
<code><a href="#topic+plot_subwt_regression">plot_subwt_regression</a>()</code>
</p>

<hr>
<h2 id='plot_SS_panel'>Plot silver-standard (SS) panel</h2><span id='topic+plot_SS_panel'></span>

<h3>Description</h3>

<p>Plot silver-standard (SS) panel
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_SS_panel(
  slice,
  data_nplcm,
  model_options,
  clean_options,
  bugs.dat,
  res_nplcm,
  bg_color,
  select_latent = NULL,
  exact = TRUE,
  top_SS = 1,
  cexval = 1,
  srtval = 0,
  prior_shape = "interval"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_SS_panel_+3A_slice">slice</code></td>
<td>
<p>the index of measurement slice for SS.</p>
</td></tr>
<tr><td><code id="plot_SS_panel_+3A_data_nplcm">data_nplcm</code></td>
<td>
<p>See <code><a href="#topic+nplcm">nplcm()</a></code></p>
</td></tr>
<tr><td><code id="plot_SS_panel_+3A_model_options">model_options</code></td>
<td>
<p>See <code><a href="#topic+nplcm">nplcm()</a></code></p>
</td></tr>
<tr><td><code id="plot_SS_panel_+3A_clean_options">clean_options</code></td>
<td>
<p>See <code><a href="#topic+clean_perch_data">clean_perch_data()</a></code></p>
</td></tr>
<tr><td><code id="plot_SS_panel_+3A_bugs.dat">bugs.dat</code></td>
<td>
<p>Data input for the model fitting.</p>
</td></tr>
<tr><td><code id="plot_SS_panel_+3A_res_nplcm">res_nplcm</code></td>
<td>
<p>See <code><a href="#topic+nplcm_read_folder">nplcm_read_folder()</a></code></p>
</td></tr>
<tr><td><code id="plot_SS_panel_+3A_bg_color">bg_color</code></td>
<td>
<p>A list with names &quot;BrS&quot;, &quot;SS&quot;, &quot;pie&quot; to specify background colors</p>
</td></tr>
<tr><td><code id="plot_SS_panel_+3A_select_latent">select_latent</code></td>
<td>
<p>a vector of character strings representing latent status. It is used for
just plotting a subset of latent status. For example, you can specify <code>select_latent = "HINF"</code>
to plot all latent status information relevant to <code>"HINF"</code>.</p>
</td></tr>
<tr><td><code id="plot_SS_panel_+3A_exact">exact</code></td>
<td>
<p>Default is <code>TRUE</code> to use <code>select_latent</code> as exact names of causes. If you want to
specify a name and plot all single or combo causes with that name, specify it to be <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="plot_SS_panel_+3A_top_ss">top_SS</code></td>
<td>
<p>Numerical value to specify the rightmost limit
on the horizontal axis for the SS panel.</p>
</td></tr>
<tr><td><code id="plot_SS_panel_+3A_cexval">cexval</code></td>
<td>
<p>Default is 1 - size of text of the SS percentages.</p>
</td></tr>
<tr><td><code id="plot_SS_panel_+3A_srtval">srtval</code></td>
<td>
<p>Default is 0 - the direction of the text for the SS percentages.</p>
</td></tr>
<tr><td><code id="plot_SS_panel_+3A_prior_shape">prior_shape</code></td>
<td>
<p><code>interval</code> or <code>boxplot</code> - for how to represent
prior/posteriors of the TPR/FPRs of measurements.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>plotting function
</p>


<h3>See Also</h3>

<p>Other visualization functions: 
<code><a href="#topic+plot.nplcm">plot.nplcm</a>()</code>,
<code><a href="#topic+plot_BrS_panel">plot_BrS_panel</a>()</code>,
<code><a href="#topic+plot_check_common_pattern">plot_check_common_pattern</a>()</code>,
<code><a href="#topic+plot_check_pairwise_SLORD">plot_check_pairwise_SLORD</a>()</code>,
<code><a href="#topic+plot_etiology_regression">plot_etiology_regression</a>()</code>,
<code><a href="#topic+plot_etiology_strat">plot_etiology_strat</a>()</code>,
<code><a href="#topic+plot_panels">plot_panels</a>()</code>,
<code><a href="#topic+plot_pie_panel">plot_pie_panel</a>()</code>,
<code><a href="#topic+plot_subwt_regression">plot_subwt_regression</a>()</code>
</p>

<hr>
<h2 id='plot_subwt_regression'>visualize the subclass weight regression with a continuous covariate</h2><span id='topic+plot_subwt_regression'></span>

<h3>Description</h3>

<p>visualize the subclass weight regression with a continuous covariate
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_subwt_regression(
  DIR_NPLCM,
  stratum_bool,
  case = 0,
  slice = 1,
  truth = NULL,
  RES_NPLCM = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_subwt_regression_+3A_dir_nplcm">DIR_NPLCM</code></td>
<td>
<p>File path to the folder containing posterior samples</p>
</td></tr>
<tr><td><code id="plot_subwt_regression_+3A_stratum_bool">stratum_bool</code></td>
<td>
<p>a vector of TRUE/FALSE with TRUE indicating the rows of subjects to include</p>
</td></tr>
<tr><td><code id="plot_subwt_regression_+3A_case">case</code></td>
<td>
<p>1 for plotting cases, 0 for plotting controls; default to 0.</p>
</td></tr>
<tr><td><code id="plot_subwt_regression_+3A_slice">slice</code></td>
<td>
<p>integer; specifies which slice of bronze-standard data to visualize; Default to 1.</p>
</td></tr>
<tr><td><code id="plot_subwt_regression_+3A_truth">truth</code></td>
<td>
<p>a list of truths computed from true parameters in simulations; elements:
Eti, FPR, PR_case,TPR; All default to <code>NULL</code> in real data analyses.
Currently only works for one slice of bronze-standard measurements (in a non-nested model).
</p>

<ul>
<li><p> truth_subwt matrix of # of rows = # of subjects, # columns: number of true subclasses
</p>
</li></ul>
</td></tr>
<tr><td><code id="plot_subwt_regression_+3A_res_nplcm">RES_NPLCM</code></td>
<td>
<p>pre-read res_nplcm; default to NULL.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A figure of subclass regression curves
</p>


<h3>See Also</h3>

<p>Other visualization functions: 
<code><a href="#topic+plot.nplcm">plot.nplcm</a>()</code>,
<code><a href="#topic+plot_BrS_panel">plot_BrS_panel</a>()</code>,
<code><a href="#topic+plot_SS_panel">plot_SS_panel</a>()</code>,
<code><a href="#topic+plot_check_common_pattern">plot_check_common_pattern</a>()</code>,
<code><a href="#topic+plot_check_pairwise_SLORD">plot_check_pairwise_SLORD</a>()</code>,
<code><a href="#topic+plot_etiology_regression">plot_etiology_regression</a>()</code>,
<code><a href="#topic+plot_etiology_strat">plot_etiology_strat</a>()</code>,
<code><a href="#topic+plot_panels">plot_panels</a>()</code>,
<code><a href="#topic+plot_pie_panel">plot_pie_panel</a>()</code>
</p>

<hr>
<h2 id='plot.nplcm'><code>plot.nplcm</code> plot the results from <code><a href="#topic+nplcm">nplcm()</a></code>.</h2><span id='topic+plot.nplcm'></span>

<h3>Description</h3>

<p><code>plot.nplcm</code> plot the results from <code><a href="#topic+nplcm">nplcm()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'nplcm'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.nplcm_+3A_x">x</code></td>
<td>
<p>Output from <code><a href="#topic+nplcm">nplcm()</a></code>.</p>
</td></tr>
<tr><td><code id="plot.nplcm_+3A_...">...</code></td>
<td>
<p>Arguments passed to summary and printing methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a figure
</p>


<h3>See Also</h3>

<p>Other visualization functions: 
<code><a href="#topic+plot_BrS_panel">plot_BrS_panel</a>()</code>,
<code><a href="#topic+plot_SS_panel">plot_SS_panel</a>()</code>,
<code><a href="#topic+plot_check_common_pattern">plot_check_common_pattern</a>()</code>,
<code><a href="#topic+plot_check_pairwise_SLORD">plot_check_pairwise_SLORD</a>()</code>,
<code><a href="#topic+plot_etiology_regression">plot_etiology_regression</a>()</code>,
<code><a href="#topic+plot_etiology_strat">plot_etiology_strat</a>()</code>,
<code><a href="#topic+plot_panels">plot_panels</a>()</code>,
<code><a href="#topic+plot_pie_panel">plot_pie_panel</a>()</code>,
<code><a href="#topic+plot_subwt_regression">plot_subwt_regression</a>()</code>
</p>

<hr>
<h2 id='print.nplcm'><code>print.nplcm</code> summarizes the results from <code><a href="#topic+nplcm">nplcm()</a></code>.</h2><span id='topic+print.nplcm'></span>

<h3>Description</h3>

<p><code>print.nplcm</code> summarizes the results from <code><a href="#topic+nplcm">nplcm()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'nplcm'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.nplcm_+3A_x">x</code></td>
<td>
<p>Output from <code><a href="#topic+nplcm">nplcm()</a></code>.</p>
</td></tr>
<tr><td><code id="print.nplcm_+3A_...">...</code></td>
<td>
<p>Arguments passed to summary and printing methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Summary of object output by <code><a href="#topic+nplcm">nplcm()</a></code> &mdash; need details.
</p>


<h3>See Also</h3>

<p>Other nplcm results: 
<code><a href="#topic+print.summary.nplcm.no_reg">print.summary.nplcm.no_reg</a>()</code>,
<code><a href="#topic+print.summary.nplcm.reg_nest_strat">print.summary.nplcm.reg_nest_strat</a>()</code>,
<code><a href="#topic+print.summary.nplcm.reg_nest">print.summary.nplcm.reg_nest</a>()</code>,
<code><a href="#topic+print.summary.nplcm.reg_nonest_strat">print.summary.nplcm.reg_nonest_strat</a>()</code>,
<code><a href="#topic+print.summary.nplcm.reg_nonest">print.summary.nplcm.reg_nonest</a>()</code>,
<code><a href="#topic+summary.nplcm">summary.nplcm</a>()</code>
</p>

<hr>
<h2 id='print.summary.nplcm.no_reg'>Compact printing of <code><a href="#topic+nplcm">nplcm()</a></code> model fits</h2><span id='topic+print.summary.nplcm.no_reg'></span>

<h3>Description</h3>

<p><code>print.summary.nplcm</code> is a print method for class
<code>summary.nplcm.NoReg</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.nplcm.no_reg'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.summary.nplcm.no_reg_+3A_x">x</code></td>
<td>
<p>output from <code>summary.nplcm</code> with <code>summary.nplcm.no_reg</code> as the output object class.</p>
</td></tr>
<tr><td><code id="print.summary.nplcm.no_reg_+3A_...">...</code></td>
<td>
<p>Not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>see <code><a href="#topic+print.nplcm">print.nplcm()</a></code>
</p>


<h3>See Also</h3>

<p>Other nplcm results: 
<code><a href="#topic+print.nplcm">print.nplcm</a>()</code>,
<code><a href="#topic+print.summary.nplcm.reg_nest_strat">print.summary.nplcm.reg_nest_strat</a>()</code>,
<code><a href="#topic+print.summary.nplcm.reg_nest">print.summary.nplcm.reg_nest</a>()</code>,
<code><a href="#topic+print.summary.nplcm.reg_nonest_strat">print.summary.nplcm.reg_nonest_strat</a>()</code>,
<code><a href="#topic+print.summary.nplcm.reg_nonest">print.summary.nplcm.reg_nonest</a>()</code>,
<code><a href="#topic+summary.nplcm">summary.nplcm</a>()</code>
</p>

<hr>
<h2 id='print.summary.nplcm.reg_nest'>Compact printing of <code><a href="#topic+nplcm">nplcm()</a></code> model fits</h2><span id='topic+print.summary.nplcm.reg_nest'></span>

<h3>Description</h3>

<p><code>print.summary.nplcm</code> is a print method for class
<code>summary.nplcm.reg_nest</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.nplcm.reg_nest'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.summary.nplcm.reg_nest_+3A_x">x</code></td>
<td>
<p>output from <code>summary.nplcm</code> with <code>summary.nplcm.reg_nest</code> as the output object class.</p>
</td></tr>
<tr><td><code id="print.summary.nplcm.reg_nest_+3A_...">...</code></td>
<td>
<p>Not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>see <code><a href="#topic+print.nplcm">print.nplcm()</a></code>
</p>


<h3>See Also</h3>

<p>Other nplcm results: 
<code><a href="#topic+print.nplcm">print.nplcm</a>()</code>,
<code><a href="#topic+print.summary.nplcm.no_reg">print.summary.nplcm.no_reg</a>()</code>,
<code><a href="#topic+print.summary.nplcm.reg_nest_strat">print.summary.nplcm.reg_nest_strat</a>()</code>,
<code><a href="#topic+print.summary.nplcm.reg_nonest_strat">print.summary.nplcm.reg_nonest_strat</a>()</code>,
<code><a href="#topic+print.summary.nplcm.reg_nonest">print.summary.nplcm.reg_nonest</a>()</code>,
<code><a href="#topic+summary.nplcm">summary.nplcm</a>()</code>
</p>

<hr>
<h2 id='print.summary.nplcm.reg_nest_strat'>Compact printing of <code><a href="#topic+nplcm">nplcm()</a></code> model fits</h2><span id='topic+print.summary.nplcm.reg_nest_strat'></span>

<h3>Description</h3>

<p>Same as <code><a href="#topic+print.summary.nplcm.reg_nonest_strat">print.summary.nplcm.reg_nonest_strat()</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.nplcm.reg_nest_strat'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.summary.nplcm.reg_nest_strat_+3A_x">x</code></td>
<td>
<p>output from <code>summary.nplcm</code> with <code>summary.nplcm.reg_nest_strat</code> as the output object class.</p>
</td></tr>
<tr><td><code id="print.summary.nplcm.reg_nest_strat_+3A_...">...</code></td>
<td>
<p>Not used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>print.summary.nplcm</code> is a print method for class
<code>summary.nplcm.reg_nest_strat</code>.
</p>


<h3>Value</h3>

<p>see <code><a href="#topic+print.nplcm">print.nplcm()</a></code>
</p>


<h3>See Also</h3>

<p>Other nplcm results: 
<code><a href="#topic+print.nplcm">print.nplcm</a>()</code>,
<code><a href="#topic+print.summary.nplcm.no_reg">print.summary.nplcm.no_reg</a>()</code>,
<code><a href="#topic+print.summary.nplcm.reg_nest">print.summary.nplcm.reg_nest</a>()</code>,
<code><a href="#topic+print.summary.nplcm.reg_nonest_strat">print.summary.nplcm.reg_nonest_strat</a>()</code>,
<code><a href="#topic+print.summary.nplcm.reg_nonest">print.summary.nplcm.reg_nonest</a>()</code>,
<code><a href="#topic+summary.nplcm">summary.nplcm</a>()</code>
</p>

<hr>
<h2 id='print.summary.nplcm.reg_nonest'>Compact printing of <code><a href="#topic+nplcm">nplcm()</a></code> model fits</h2><span id='topic+print.summary.nplcm.reg_nonest'></span>

<h3>Description</h3>

<p><code>print.summary.nplcm</code> is a print method for class
<code>summary.nplcm.reg_nonest</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.nplcm.reg_nonest'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.summary.nplcm.reg_nonest_+3A_x">x</code></td>
<td>
<p>output from <code>summary.nplcm</code> with <code>summary.nplcm.reg_nonest</code> as the output object class.</p>
</td></tr>
<tr><td><code id="print.summary.nplcm.reg_nonest_+3A_...">...</code></td>
<td>
<p>Not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>see <code><a href="#topic+print.nplcm">print.nplcm()</a></code>
</p>


<h3>See Also</h3>

<p>Other nplcm results: 
<code><a href="#topic+print.nplcm">print.nplcm</a>()</code>,
<code><a href="#topic+print.summary.nplcm.no_reg">print.summary.nplcm.no_reg</a>()</code>,
<code><a href="#topic+print.summary.nplcm.reg_nest_strat">print.summary.nplcm.reg_nest_strat</a>()</code>,
<code><a href="#topic+print.summary.nplcm.reg_nest">print.summary.nplcm.reg_nest</a>()</code>,
<code><a href="#topic+print.summary.nplcm.reg_nonest_strat">print.summary.nplcm.reg_nonest_strat</a>()</code>,
<code><a href="#topic+summary.nplcm">summary.nplcm</a>()</code>
</p>

<hr>
<h2 id='print.summary.nplcm.reg_nonest_strat'>Compact printing of <code><a href="#topic+nplcm">nplcm()</a></code> model fits</h2><span id='topic+print.summary.nplcm.reg_nonest_strat'></span>

<h3>Description</h3>

<p><code>print.summary.nplcm</code> is a print method for class
<code>summary.nplcm.reg_nonest_strat</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.nplcm.reg_nonest_strat'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.summary.nplcm.reg_nonest_strat_+3A_x">x</code></td>
<td>
<p>output from <code>summary.nplcm</code> with <code>summary.nplcm.reg_nonest_strat</code> as the output object class.</p>
</td></tr>
<tr><td><code id="print.summary.nplcm.reg_nonest_strat_+3A_...">...</code></td>
<td>
<p>Not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>see <code><a href="#topic+print.nplcm">print.nplcm()</a></code>
</p>


<h3>See Also</h3>

<p>Other nplcm results: 
<code><a href="#topic+print.nplcm">print.nplcm</a>()</code>,
<code><a href="#topic+print.summary.nplcm.no_reg">print.summary.nplcm.no_reg</a>()</code>,
<code><a href="#topic+print.summary.nplcm.reg_nest_strat">print.summary.nplcm.reg_nest_strat</a>()</code>,
<code><a href="#topic+print.summary.nplcm.reg_nest">print.summary.nplcm.reg_nest</a>()</code>,
<code><a href="#topic+print.summary.nplcm.reg_nonest">print.summary.nplcm.reg_nonest</a>()</code>,
<code><a href="#topic+summary.nplcm">summary.nplcm</a>()</code>
</p>

<hr>
<h2 id='read_meas_object'>Read measurement slices</h2><span id='topic+read_meas_object'></span>

<h3>Description</h3>

<p>NB: add example, small data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_meas_object(object, data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read_meas_object_+3A_object">object</code></td>
<td>
<p>Outputs from <code><a href="#topic+make_meas_object">make_meas_object()</a></code></p>
</td></tr>
<tr><td><code id="read_meas_object_+3A_data">data</code></td>
<td>
<p>Raw data with column names
<code>{pathogen name}_{specimen}{test}</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with two elements: <code>meas</code>-data frame with measurements;
<code>position</code>-see <code><a href="#topic+lookup_quality">lookup_quality()</a></code>
</p>


<h3>See Also</h3>

<p>Other raw data importing functions: 
<code><a href="#topic+extract_data_raw">extract_data_raw</a>()</code>
</p>

<hr>
<h2 id='rvbern'>Sample a vector of Bernoulli variables.</h2><span id='topic+rvbern'></span>

<h3>Description</h3>

<p>Sample a vector of Bernoulli variables with higher speed
(same length with <code>"p"</code>).
The Bernoulli random variables can have different means.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rvbern(p)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rvbern_+3A_p">p</code></td>
<td>
<p>A vector of probabilities, each being the head probability
of an independent coin toss</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of 1s (head) and 0s (tail)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>rvbern(c(0.9,0.1,0.2,0.3))

</code></pre>

<hr>
<h2 id='s_date_Eti'>Make Etiology design matrix for dates with R format.</h2><span id='topic+s_date_Eti'></span>

<h3>Description</h3>

<p><code>s_date_Eti</code> creates design matrices for etiology regressions;
</p>


<h3>Usage</h3>

<pre><code class='language-R'>s_date_Eti(Rdate, Y, basis = "ps", dof = ifelse(basis == "ncs", 5, 10), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="s_date_Eti_+3A_rdate">Rdate</code></td>
<td>
<p>a vector of dates of <code>R</code> format</p>
</td></tr>
<tr><td><code id="s_date_Eti_+3A_y">Y</code></td>
<td>
<p>Binary case/control status; <code>1</code> for case; <code>0</code> for controls</p>
</td></tr>
<tr><td><code id="s_date_Eti_+3A_basis">basis</code></td>
<td>
<p><code>ncs</code> for natural cubic splines; <code>ps</code> for penalized-splines based
on B-spline basis functions (NB: baker does not recommend setting ncs using
this function; use splines::ns)</p>
</td></tr>
<tr><td><code id="s_date_Eti_+3A_dof">dof</code></td>
<td>
<p>Degree-of-freedom for the bases. For <code>ncs</code> basis, <code>dof</code> is
the number of columns; For <code>ps</code> basis,  the number of columns is <code>dof</code>
if <code>intercept=TRUE</code>; <code>dof-1</code> if <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="s_date_Eti_+3A_...">...</code></td>
<td>
<p>Other arguments as in <code><a href="splines.html#topic+bs">splines::bs()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>


<ul>
<li> <p><code>Z_Eti</code> design matrix for etiology regression on dates.
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+nplcm">nplcm()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("data_nplcm_reg_nest")
s_date_Eti(data_nplcm_reg_nest$X$DATE,data_nplcm_reg_nest$Y,basis='ps',dof=7)
</code></pre>

<hr>
<h2 id='s_date_FPR'>Make false positive rate (FPR) design matrix for dates with R format.</h2><span id='topic+s_date_FPR'></span>

<h3>Description</h3>

<p><code>s_date_FPR</code> creates design matrices for FPR regressions;
</p>


<h3>Usage</h3>

<pre><code class='language-R'>s_date_FPR(Rdate, Y, basis = "ps", dof = 10, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="s_date_FPR_+3A_rdate">Rdate</code></td>
<td>
<p>a vector of dates of R format</p>
</td></tr>
<tr><td><code id="s_date_FPR_+3A_y">Y</code></td>
<td>
<p>Binary case/control status; 1 for case; 0 for controls</p>
</td></tr>
<tr><td><code id="s_date_FPR_+3A_basis">basis</code></td>
<td>
<p>&quot;ps&quot; for penalized-splines based
on B-spline basis functions</p>
</td></tr>
<tr><td><code id="s_date_FPR_+3A_dof">dof</code></td>
<td>
<p>Degree-of-freedom for the bases.For &quot;ps&quot; basis,
the number of columns is <code>dof</code>
if <code>intercept=TRUE</code>; <code>dof-1</code> if <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="s_date_FPR_+3A_...">...</code></td>
<td>
<p>Other arguments as in <code><a href="splines.html#topic+bs">splines::bs()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Design matrix for FPR regression, with cases' rows on top of
controls'.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+nplcm">nplcm()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(data_nplcm_reg_nest)
s_date_FPR(data_nplcm_reg_nest$X$DATE,data_nplcm_reg_nest$Y,basis='ps',dof=7)


</code></pre>

<hr>
<h2 id='set_prior_tpr_BrS_NoNest'>Set true positive rate (TPR) prior ranges for bronze-standard (BrS) data</h2><span id='topic+set_prior_tpr_BrS_NoNest'></span>

<h3>Description</h3>

<p><code>set_prior_tpr_BrS_NoNest</code> is for for conditional independence models.
We currently also use it for conditional dependence model: subclass TPRs
are independently assigned a beta prior. Ongoing work will enable specifying
priors for the marginal TPR, i.e. TPRs for a disease class, not for the
finer subclass.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>set_prior_tpr_BrS_NoNest(slice, model_options, data_nplcm)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="set_prior_tpr_BrS_NoNest_+3A_slice">slice</code></td>
<td>
<p>The BrS measurement slice under consideration.</p>
</td></tr>
<tr><td><code id="set_prior_tpr_BrS_NoNest_+3A_model_options">model_options</code></td>
<td>
<p>See <code><a href="#topic+nplcm">nplcm()</a></code> function.</p>
</td></tr>
<tr><td><code id="set_prior_tpr_BrS_NoNest_+3A_data_nplcm">data_nplcm</code></td>
<td>
<p>See <code><a href="#topic+assign_model">assign_model()</a></code> function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Parameters for the BrS dta TPR priors. It is a list of two lists
(alpha and beta). Alpha and beta are of the same length, the number of BrS
measurement slices. Each element of the alpha (beta) list is a numeric vector
for alpha (beta) parameters as in BETA distribution.
</p>


<h3>See Also</h3>

<p>Other prior specification functions: 
<code><a href="#topic+overall_uniform">overall_uniform</a>()</code>,
<code><a href="#topic+set_prior_tpr_SS">set_prior_tpr_SS</a>()</code>
</p>

<hr>
<h2 id='set_prior_tpr_SS'>Set true positive rate (TPR) prior ranges for silver-standard data.</h2><span id='topic+set_prior_tpr_SS'></span>

<h3>Description</h3>

<p>Set true positive rate (TPR) prior ranges for silver-standard data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>set_prior_tpr_SS(model_options, data_nplcm)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="set_prior_tpr_SS_+3A_model_options">model_options</code></td>
<td>
<p>See <code><a href="#topic+nplcm">nplcm()</a></code> function.</p>
</td></tr>
<tr><td><code id="set_prior_tpr_SS_+3A_data_nplcm">data_nplcm</code></td>
<td>
<p>See <code><a href="#topic+assign_model">assign_model()</a></code> function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Parameters for the SS data TPR priors. It is a list of two lists
(alpha and beta). Alpha and beta are of the same length, the number of
BrS measurement slices. Each element of the alpha (beta) list is a
numeric vector for alpha (beta) parameters to specify Beta prior for TPRs.
</p>


<h3>See Also</h3>

<p>Other prior specification functions: 
<code><a href="#topic+overall_uniform">overall_uniform</a>()</code>,
<code><a href="#topic+set_prior_tpr_BrS_NoNest">set_prior_tpr_BrS_NoNest</a>()</code>
</p>

<hr>
<h2 id='set_strat'>Stratification setup by covariates</h2><span id='topic+set_strat'></span>

<h3>Description</h3>

<p><code>set_strat</code> makes group indicators based on <code style="white-space: pre;">&#8288;model_options$X_reg_*&#8288;</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>set_strat(X, X_reg)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="set_strat_+3A_x">X</code></td>
<td>
<p>A data frame of covariates</p>
</td></tr>
<tr><td><code id="set_strat_+3A_x_reg">X_reg</code></td>
<td>
<p>The vector of covariates that will stratify the analyses. These
variables have to be categorical.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>the results from this function will help stratify etiology or FPR for
different strata; the ways of stratification for etiology and FPR can be based
on different covariates.
</p>


<h3>Value</h3>

<p>A list with following elements:
</p>

<ul>
<li> <p><code>N_group</code> The number of groups
</p>
</li>
<li> <p><code>group</code> A vector of group indicator for every observation
</p>
</li></ul>


<hr>
<h2 id='show_dep'>Show function dependencies</h2><span id='topic+show_dep'></span>

<h3>Description</h3>

<p>Show function dependencies
</p>


<h3>Usage</h3>

<pre><code class='language-R'>show_dep(fname, pckg = "package:baker", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="show_dep_+3A_fname">fname</code></td>
<td>
<p>Character string for one function</p>
</td></tr>
<tr><td><code id="show_dep_+3A_pckg">pckg</code></td>
<td>
<p>Package name; default is <code>"package:baker"</code></p>
</td></tr>
<tr><td><code id="show_dep_+3A_...">...</code></td>
<td>
<p>Other parameters accepted by <code><a href="mvbutils.html#topic+foodweb">mvbutils::foodweb()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A figure showing function dependencies
</p>


<h3>Examples</h3>

<pre><code class='language-R'>show_dep("nplcm",ancestor=FALSE)
show_dep("nplcm")

</code></pre>

<hr>
<h2 id='show_individual'>get an individual's data from the output of <code><a href="#topic+clean_perch_data">clean_perch_data()</a></code></h2><span id='topic+show_individual'></span>

<h3>Description</h3>

<p>get an individual's data from the output of <code><a href="#topic+clean_perch_data">clean_perch_data()</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>show_individual(data_nplcm, ID)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="show_individual_+3A_data_nplcm">data_nplcm</code></td>
<td>
<p>data for fitting nplcm; See <code><a href="#topic+nplcm">nplcm()</a></code></p>
</td></tr>
<tr><td><code id="show_individual_+3A_id">ID</code></td>
<td>
<p>patient id: <code>patid</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list with the inquired patient's data
</p>


<h3>See Also</h3>

<p>Other exploratory data analysis functions: 
<code><a href="#topic+get_top_pattern">get_top_pattern</a>()</code>,
<code><a href="#topic+plot_logORmat">plot_logORmat</a>()</code>,
<code><a href="#topic+summarize_BrS">summarize_BrS</a>()</code>,
<code><a href="#topic+summarize_SS">summarize_SS</a>()</code>,
<code><a href="#topic+visualize_season">visualize_season</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(data_nplcm_noreg)
data_nplcm_noreg$X$patid &lt;- paste("PAT",1:length(data_nplcm_noreg$Y0),sep="")
data_nplcm_noreg$X &lt;- as.data.frame(data_nplcm_noreg$X)
subset_data_nplcm_by_index(data_nplcm_noreg,which(data_nplcm_noreg$X$patid%in%c("PAT12","PAT408")))
data_nplcm_noreg$X &lt;- NULL

</code></pre>

<hr>
<h2 id='simulate_brs'>Simulate Bronze-Standard (BrS) Data</h2><span id='topic+simulate_brs'></span>

<h3>Description</h3>

<p>Simulate Bronze-Standard (BrS) Data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulate_brs(set_parameter, latent_samples)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simulate_brs_+3A_set_parameter">set_parameter</code></td>
<td>
<p>True model parameters in an npLCM specification:
</p>

<dl>
<dt><code>cause_list</code></dt><dd><p> a vector of disease class names among cases (since
the causes could be multi-agent (e.g., multiple pathogens may cause an individual case's
pneumonia), so its length could be longer than the total number of unique
causative agents)</p>
</dd>
<dt><code>etiology</code></dt><dd><p> a vector of proportions that sum to 100 percent</p>
</dd>
<dt><code>pathogen_BrS</code></dt><dd><p> a vector of putative causative agents' names measured in bronze-standard (BrS) data.
This function simulates only one slice defined by <code style="white-space: pre;">&#8288;specimen``test``pathogen&#8288;</code></p>
</dd>
<dt><code>pathogen_SS</code></dt><dd><p> a vector of pathogen names measured in silver-standard (SS) data.</p>
</dd>
<dt><code>meas_nm</code></dt><dd><p> a list of <code style="white-space: pre;">&#8288;specimen``test&#8288;</code> names e.g., <code>list(MBS = c("NPPCR"),MSS="BCX")</code>
for nasopharyngeal (NP) specimen tested by polymerase chain reaction (PCR) - <code>NPPCR</code> and
blood (B) tested by culture (Cx) - <code>BCX</code></p>
</dd>
<dt><code>Lambda</code></dt><dd><p> controls' subclass weights <code class="reqn">\nu_1, \nu_2, \ldots, \nu_K</code>
a vector of <code>K</code> probabilities that sum to 1.</p>
</dd>
<dt><code>Eta</code></dt><dd><p>    a matrix of dimension <code>length(cause_list)</code> by <code>K</code>;
each row represents a disease class (among cases); the values in that row
are subclass weights <code class="reqn">\eta_1, \eta_2, \ldots, \eta_K</code> for that disease class,
so needs to sum to one. In Wu et al. 2016 (JRSS-C), the subclass weights are the same across disease
classes across rows. But when simulating data, one can specify rows with distinct
subclass weights - it is a matter whether we can recover these parameters (possible when
some cases' true disease classes are observed)</p>
</dd>
<dt><code>PsiBS/PsiSS</code></dt><dd><p> False positive rates for Bronze-Standard data and
for Silver-Standard data. For example, the rows of <code>PsiBS</code> correspond to the dimension of the particular
slice of BrS measures, e.g., <code>10</code> for 10 causative agents measured by NPPCR; the
columns correspond to <code>K</code> subclasses; generically, the dimension is <code>J</code> by <code>K</code>
<code>PsiSS</code> is supposed to be a vector of all zeros (perfect specificity in silver-standard measures).</p>
</dd>
<dt><code>ThetaBS/ThetaSS</code></dt><dd><p>  True positive rates <code class="reqn">\Theta</code> for Bronze-Standard data and
for Silver-Standard data. Dimension is <code>J</code> by <code>K</code> (can contain <code>NA</code> if the total number of
causative agents measured by BrS or SS exceeds the measured causative agents in SS. For example,
in PERCH study, nasopharyngeal polymerase chain reaction (NPPCR; bronze-standard) may target 30 distinct pathogens, but blood culture (BCX; silver-standard) may only target a subset of the 30,
so we have to specify <code>NA</code> in <code>ThetaSS</code>for those pathogens not targeted by BCX).</p>
</dd>
<dt><code>Nu</code></dt><dd><p> the number of control subjects</p>
</dd>
<dt><code>Nd</code></dt><dd><p> the number of case subjects</p>
</dd>
</dl>
</td></tr>
<tr><td><code id="simulate_brs_+3A_latent_samples">latent_samples</code></td>
<td>
<p>simulated latent status for all the subjects, for use in simulating
BrS measurements.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data frame with first column being case-control status (case at top) and
columns of bronze-standard measurements
</p>


<h3>See Also</h3>

<p>Other internal simulation functions: 
<code><a href="#topic+simulate_latent">simulate_latent</a>()</code>,
<code><a href="#topic+simulate_ss">simulate_ss</a>()</code>
</p>

<hr>
<h2 id='simulate_latent'>Simulate Latent Status:</h2><span id='topic+simulate_latent'></span>

<h3>Description</h3>

<p>Simulate Latent Status:
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulate_latent(set_parameter)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simulate_latent_+3A_set_parameter">set_parameter</code></td>
<td>
<p>True model parameters in an npLCM specification:
</p>

<dl>
<dt><code>cause_list</code></dt><dd><p> a vector of disease class names among cases (since
the causes could be multi-agent (e.g., multiple pathogens may cause an individual case's
pneumonia), so its length could be longer than the total number of unique
causative agents)</p>
</dd>
<dt><code>etiology</code></dt><dd><p> a vector of proportions that sum to 100 percent</p>
</dd>
<dt><code>pathogen_BrS</code></dt><dd><p> a vector of putative causative agents' names measured in bronze-standard (BrS) data.
This function simulates only one slice defined by <code style="white-space: pre;">&#8288;specimen``test``pathogen&#8288;</code></p>
</dd>
<dt><code>pathogen_SS</code></dt><dd><p> a vector of pathogen names measured in silver-standard (SS) data.</p>
</dd>
<dt><code>meas_nm</code></dt><dd><p> a list of <code style="white-space: pre;">&#8288;specimen``test&#8288;</code> names e.g., <code>list(MBS = c("NPPCR"),MSS="BCX")</code>
for nasopharyngeal (NP) specimen tested by polymerase chain reaction (PCR) - <code>NPPCR</code> and
blood (B) tested by culture (Cx) - <code>BCX</code></p>
</dd>
<dt><code>Lambda</code></dt><dd><p> controls' subclass weights <code class="reqn">\nu_1, \nu_2, \ldots, \nu_K</code>
a vector of <code>K</code> probabilities that sum to 1.</p>
</dd>
<dt><code>Eta</code></dt><dd><p>    a matrix of dimension <code>length(cause_list)</code> by <code>K</code>;
each row represents a disease class (among cases); the values in that row
are subclass weights <code class="reqn">\eta_1, \eta_2, \ldots, \eta_K</code> for that disease class,
so needs to sum to one. In Wu et al. 2016 (JRSS-C), the subclass weights are the same across disease
classes across rows. But when simulating data, one can specify rows with distinct
subclass weights - it is a matter whether we can recover these parameters (possible when
some cases' true disease classes are observed)</p>
</dd>
<dt><code>PsiBS/PsiSS</code></dt><dd><p> False positive rates for Bronze-Standard data and
for Silver-Standard data. For example, the rows of <code>PsiBS</code> correspond to the dimension of the particular
slice of BrS measures, e.g., <code>10</code> for 10 causative agents measured by NPPCR; the
columns correspond to <code>K</code> subclasses; generically, the dimension is <code>J</code> by <code>K</code>
<code>PsiSS</code> is supposed to be a vector of all zeros (perfect specificity in silver-standard measures).</p>
</dd>
<dt><code>ThetaBS/ThetaSS</code></dt><dd><p>  True positive rates <code class="reqn">\Theta</code> for Bronze-Standard data and
for Silver-Standard data. Dimension is <code>J</code> by <code>K</code> (can contain <code>NA</code> if the total number of
causative agents measured by BrS or SS exceeds the measured causative agents in SS. For example,
in PERCH study, nasopharyngeal polymerase chain reaction (NPPCR; bronze-standard) may target 30 distinct pathogens, but blood culture (BCX; silver-standard) may only target a subset of the 30,
so we have to specify <code>NA</code> in <code>ThetaSS</code>for those pathogens not targeted by BCX).</p>
</dd>
<dt><code>Nu</code></dt><dd><p> the number of control subjects</p>
</dd>
<dt><code>Nd</code></dt><dd><p> the number of case subjects</p>
</dd>
</dl>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of latent status samples for use in simulating measurements. It
also includes a template to look up measurement parameters for each disease class.
</p>


<h3>See Also</h3>

<p>Other internal simulation functions: 
<code><a href="#topic+simulate_brs">simulate_brs</a>()</code>,
<code><a href="#topic+simulate_ss">simulate_ss</a>()</code>
</p>

<hr>
<h2 id='simulate_nplcm'>Simulate data from nested partially-latent class model (npLCM) family</h2><span id='topic+simulate_nplcm'></span>

<h3>Description</h3>

<p>Simulate data from nested partially-latent class model (npLCM) family
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulate_nplcm(set_parameter)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simulate_nplcm_+3A_set_parameter">set_parameter</code></td>
<td>
<p>True model parameters in an npLCM specification:
</p>

<dl>
<dt><code>cause_list</code></dt><dd><p> a vector of disease class names among cases (since
the causes could be multi-agent (e.g., multiple pathogens may cause an individual case's
pneumonia), so its length could be longer than the total number of unique
causative agents)</p>
</dd>
<dt><code>etiology</code></dt><dd><p> a vector of proportions that sum to 100 percent</p>
</dd>
<dt><code>pathogen_BrS</code></dt><dd><p> a vector of putative causative agents' names measured in bronze-standard (BrS) data.
This function simulates only one slice defined by <code style="white-space: pre;">&#8288;specimen``test``pathogen&#8288;</code></p>
</dd>
<dt><code>pathogen_SS</code></dt><dd><p> a vector of pathogen names measured in silver-standard (SS) data.</p>
</dd>
<dt><code>meas_nm</code></dt><dd><p> a list of <code style="white-space: pre;">&#8288;specimen``test&#8288;</code> names e.g., <code>list(MBS = c("NPPCR"),MSS="BCX")</code>
for nasopharyngeal (NP) specimen tested by polymerase chain reaction (PCR) - <code>NPPCR</code> and
blood (B) tested by culture (Cx) - <code>BCX</code></p>
</dd>
<dt><code>Lambda</code></dt><dd><p> controls' subclass weights <code class="reqn">\nu_1, \nu_2, \ldots, \nu_K</code>
a vector of <code>K</code> probabilities that sum to 1.</p>
</dd>
<dt><code>Eta</code></dt><dd><p>    a matrix of dimension <code>length(cause_list)</code> by <code>K</code>;
each row represents a disease class (among cases); the values in that row
are subclass weights <code class="reqn">\eta_1, \eta_2, \ldots, \eta_K</code> for that disease class,
so needs to sum to one. In Wu et al. 2016 (JRSS-C), the subclass weights are the same across disease
classes across rows. But when simulating data, one can specify rows with distinct
subclass weights - it is a matter whether we can recover these parameters (possible when
some cases' true disease classes are observed)</p>
</dd>
<dt><code>PsiBS/PsiSS</code></dt><dd><p> False positive rates for Bronze-Standard data and
for Silver-Standard data. For example, the rows of <code>PsiBS</code> correspond to the dimension of the particular
slice of BrS measures, e.g., <code>10</code> for 10 causative agents measured by NPPCR; the
columns correspond to <code>K</code> subclasses; generically, the dimension is <code>J</code> by <code>K</code>
<code>PsiSS</code> is supposed to be a vector of all zeros (perfect specificity in silver-standard measures).</p>
</dd>
<dt><code>ThetaBS/ThetaSS</code></dt><dd><p>  True positive rates <code class="reqn">\Theta</code> for Bronze-Standard data and
for Silver-Standard data. Dimension is <code>J</code> by <code>K</code> (can contain <code>NA</code> if the total number of
causative agents measured by BrS or SS exceeds the measured causative agents in SS. For example,
in PERCH study, nasopharyngeal polymerase chain reaction (NPPCR; bronze-standard) may target 30 distinct pathogens, but blood culture (BCX; silver-standard) may only target a subset of the 30,
so we have to specify <code>NA</code> in <code>ThetaSS</code>for those pathogens not targeted by BCX).</p>
</dd>
<dt><code>Nu</code></dt><dd><p> the number of control subjects</p>
</dd>
<dt><code>Nd</code></dt><dd><p> the number of case subjects</p>
</dd>
</dl>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of diagnostic test measurements, true latent statues:
</p>

<dl>
<dt><code>data_nplcm</code></dt><dd><p> a list of structured data (see <code><a href="#topic+nplcm">nplcm()</a></code> for
description). </p>
</dd>
<dt><code>template</code></dt><dd><p> a matrix: rows for causes (may comprise a single or multiple causative agents),
columns for measurements; generated as a lookup table to match disease-class specific
parameters (true and false positive rates)</p>
</dd>
<dt><code>latent_cat</code></dt><dd><p> integer values to indicate the latent category. The integer
code corresponds to the order specified in <code>set_parameter$etiology</code>.
Controls are coded as <code>length(set_parameter$etiology)+1</code>.)</p>
</dd>
</dl>



<h3>See Also</h3>

<p><a href="#topic+simulate_latent">simulate_latent</a> for simulating discrete latent status, given
which <a href="#topic+simulate_brs">simulate_brs</a> simulates bronze-standard data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>K.true  &lt;- 2   # no. of latent subclasses in actual simulation. 
               # If eta = c(1,0), effectively, it is K.true=1.
J       &lt;- 21   # no. of pathogens.
N       &lt;- 600 # no. of cases/controls.

eta &lt;- c(1,0) 
# if it is c(1,0),then it is conditional independence model, and
# only the first column of parameters in PsiBS, ThetaBS matter!

seed_start &lt;- 20150202
print(eta)

# set fixed simulation sequence:
set.seed(seed_start)

ThetaBS_withNA &lt;- c(.75,rep(c(.75,.75,.75,NA),5))
PsiBS_withNA &lt;- c(.15,rep(c(.05,.05,.05,NA),5))

ThetaSS_withNA &lt;- c(NA,rep(c(0.15,NA,0.15,0.15),5))
PsiSS_withNA &lt;- c(NA,rep(c(0,NA,0,0),5))

set_parameter &lt;- list(
  cause_list      = c(LETTERS[1:J]),
  etiology        = c(c(0.36,0.1,0.1,0.1,0.1,0.05,0.05,0.05,
                 0.05,0.01,0.01,0.01,0.01),rep(0.00,8)), 
                 #same length as cause_list.
  pathogen_BrS    = LETTERS[1:J][!is.na(ThetaBS_withNA)],
  pathogen_SS     = LETTERS[1:J][!is.na(ThetaSS_withNA)],
  meas_nm         = list(MBS = c("MBS1"),MSS="MSS1"),
  Lambda          = eta, #ctrl mix
  Eta             = t(replicate(J,eta)), #case mix, row number equal to Jcause.
  PsiBS           = cbind(PsiBS_withNA[!is.na(PsiBS_withNA)],
                          rep(0,sum(!is.na(PsiBS_withNA)))),
  ThetaBS         = cbind(ThetaBS_withNA[!is.na(ThetaBS_withNA)],
                          rep(0,sum(!is.na(ThetaBS_withNA)))),
  PsiSS           = PsiSS_withNA[!is.na(PsiSS_withNA)],
  ThetaSS         = ThetaSS_withNA[!is.na(ThetaSS_withNA)],
  Nu      =     N, # control size.
  Nd      =     N  # case size.
)
 simu_out &lt;- simulate_nplcm(set_parameter)
 data_nplcm &lt;- simu_out$data_nplcm
 
 pathogen_display &lt;- rev(set_parameter$pathogen_BrS)
 plot_logORmat(data_nplcm,pathogen_display)
 # more examples are provided in the vignette, including settings with 
 # covariates.
</code></pre>

<hr>
<h2 id='simulate_ss'>Simulate Silver-Standard (SS) Data</h2><span id='topic+simulate_ss'></span>

<h3>Description</h3>

<p>Simulate Silver-Standard (SS) Data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulate_ss(set_parameter, latent_samples)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simulate_ss_+3A_set_parameter">set_parameter</code></td>
<td>
<p>True model parameters in an npLCM specification:
</p>

<dl>
<dt><code>cause_list</code></dt><dd><p> a vector of disease class names among cases (since
the causes could be multi-agent (e.g., multiple pathogens may cause an individual case's
pneumonia), so its length could be longer than the total number of unique
causative agents)</p>
</dd>
<dt><code>etiology</code></dt><dd><p> a vector of proportions that sum to 100 percent</p>
</dd>
<dt><code>pathogen_BrS</code></dt><dd><p> a vector of putative causative agents' names measured in bronze-standard (BrS) data.
This function simulates only one slice defined by <code style="white-space: pre;">&#8288;specimen``test``pathogen&#8288;</code></p>
</dd>
<dt><code>pathogen_SS</code></dt><dd><p> a vector of pathogen names measured in silver-standard (SS) data.</p>
</dd>
<dt><code>meas_nm</code></dt><dd><p> a list of <code style="white-space: pre;">&#8288;specimen``test&#8288;</code> names e.g., <code>list(MBS = c("NPPCR"),MSS="BCX")</code>
for nasopharyngeal (NP) specimen tested by polymerase chain reaction (PCR) - <code>NPPCR</code> and
blood (B) tested by culture (Cx) - <code>BCX</code></p>
</dd>
<dt><code>Lambda</code></dt><dd><p> controls' subclass weights <code class="reqn">\nu_1, \nu_2, \ldots, \nu_K</code>
a vector of <code>K</code> probabilities that sum to 1.</p>
</dd>
<dt><code>Eta</code></dt><dd><p>    a matrix of dimension <code>length(cause_list)</code> by <code>K</code>;
each row represents a disease class (among cases); the values in that row
are subclass weights <code class="reqn">\eta_1, \eta_2, \ldots, \eta_K</code> for that disease class,
so needs to sum to one. In Wu et al. 2016 (JRSS-C), the subclass weights are the same across disease
classes across rows. But when simulating data, one can specify rows with distinct
subclass weights - it is a matter whether we can recover these parameters (possible when
some cases' true disease classes are observed)</p>
</dd>
<dt><code>PsiBS/PsiSS</code></dt><dd><p> False positive rates for Bronze-Standard data and
for Silver-Standard data. For example, the rows of <code>PsiBS</code> correspond to the dimension of the particular
slice of BrS measures, e.g., <code>10</code> for 10 causative agents measured by NPPCR; the
columns correspond to <code>K</code> subclasses; generically, the dimension is <code>J</code> by <code>K</code>
<code>PsiSS</code> is supposed to be a vector of all zeros (perfect specificity in silver-standard measures).</p>
</dd>
<dt><code>ThetaBS/ThetaSS</code></dt><dd><p>  True positive rates <code class="reqn">\Theta</code> for Bronze-Standard data and
for Silver-Standard data. Dimension is <code>J</code> by <code>K</code> (can contain <code>NA</code> if the total number of
causative agents measured by BrS or SS exceeds the measured causative agents in SS. For example,
in PERCH study, nasopharyngeal polymerase chain reaction (NPPCR; bronze-standard) may target 30 distinct pathogens, but blood culture (BCX; silver-standard) may only target a subset of the 30,
so we have to specify <code>NA</code> in <code>ThetaSS</code>for those pathogens not targeted by BCX).</p>
</dd>
<dt><code>Nu</code></dt><dd><p> the number of control subjects</p>
</dd>
<dt><code>Nd</code></dt><dd><p> the number of case subjects</p>
</dd>
</dl>
</td></tr>
<tr><td><code id="simulate_ss_+3A_latent_samples">latent_samples</code></td>
<td>
<p>simulated latent status for all the subjects,
for use in simulating SS measurements.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data frame with first column being case-control status (case at top) and
columns of silver-standard measurements
</p>


<h3>See Also</h3>

<p>Other internal simulation functions: 
<code><a href="#topic+simulate_brs">simulate_brs</a>()</code>,
<code><a href="#topic+simulate_latent">simulate_latent</a>()</code>
</p>

<hr>
<h2 id='softmax'>softmax</h2><span id='topic+softmax'></span>

<h3>Description</h3>

<p>uses logsumexp trick to prevent numerical overflow
</p>


<h3>Usage</h3>

<pre><code class='language-R'>softmax(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="softmax_+3A_x">x</code></td>
<td>
<p>a vector of numbers</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector of positive values that sum to one.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
softmax2 &lt;- function(x) exp(x) / sum(exp(x))
softmax(c(1, 2, 3) * 1000)  # NaN NaN NaN
softmax2(c(1, 2, 3) * 1000)  # 0 0 1

</code></pre>

<hr>
<h2 id='subset_data_nplcm_by_index'>subset data from the output of <code><a href="#topic+clean_perch_data">clean_perch_data()</a></code></h2><span id='topic+subset_data_nplcm_by_index'></span>

<h3>Description</h3>

<p>It is particularly useful in simulating data from a regression model where one
generates a case and control at a particular covariate value, and just choose
a case or control to retain in the simulated data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>subset_data_nplcm_by_index(data_nplcm, index)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="subset_data_nplcm_by_index_+3A_data_nplcm">data_nplcm</code></td>
<td>
<p>data for fitting nplcm; See <code><a href="#topic+nplcm">nplcm()</a></code></p>
</td></tr>
<tr><td><code id="subset_data_nplcm_by_index_+3A_index">index</code></td>
<td>
<p>a vector of indices indicating the observations you hope to subset;
it will subset in all the sublists of data_nplcm</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list with the requested data, in the order determined by 'index'
</p>


<h3>See Also</h3>

<p>Other data operation functions: 
<code><a href="#topic+combine_data_nplcm">combine_data_nplcm</a>()</code>,
<code><a href="#topic+merge_lists">merge_lists</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
J = 3                          # number of causes
cause_list = c(LETTERS[1:J])   # cause list
K = 2                          # number of subclasses
lambda = c(1,0)                # subclass weights for control group
eta = c(1,0)                   # subclass weights for case group

# setup parameters for the present individual:
set_parameter &lt;- list(
 cause_list      = cause_list,
 etiology        = c(0.5,0.2,0.3), # only meaningful for cases 
 pathogen_BrS    = LETTERS[1:J],
 pathogen_SS     = LETTERS[1:2],
 meas_nm         = list(MBS = c("MBS1"),MSS=c("MSS1")),
 Lambda          = lambda,         # for BrS   
 Eta             = t(replicate(J,eta)),  # case subclass weight for BrS
 PsiBS           = cbind(c(0.15,0.3,0.35),   
                         c(0.25,0.2,0.15)), # FPR
 PsiSS           = cbind(rep(0,J),rep(0,J)),
 ThetaBS         = cbind(c(0.95,0.9,0.85),    # TPR
                         c(0.95,0.9,0.85)),
 ThetaSS         = cbind(c(0.25,0.10),
                         c(0.25,0.10)),
 Nd      =     5,
 Nu      =     3 
)
simu_out   &lt;- simulate_nplcm(set_parameter)
out &lt;- simu_out$data_nplcm
out
subset_data_nplcm_by_index(out,c(1,4,5))
subset_data_nplcm_by_index(out,2)

</code></pre>

<hr>
<h2 id='summarize_BrS'>summarize bronze-standard data</h2><span id='topic+summarize_BrS'></span>

<h3>Description</h3>

<p>summarize bronze-standard data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>summarize_BrS(BrS_dat, Y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summarize_BrS_+3A_brs_dat">BrS_dat</code></td>
<td>
<p>bronze-standard data, which is usually <code>data_nplcm$Mobs$MBS[[1]]</code></p>
</td></tr>
<tr><td><code id="summarize_BrS_+3A_y">Y</code></td>
<td>
<p>A vector of case/control status: 1 for case; 0 for control</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of summaries for BrS data
</p>


<h3>See Also</h3>

<p>Other exploratory data analysis functions: 
<code><a href="#topic+get_top_pattern">get_top_pattern</a>()</code>,
<code><a href="#topic+plot_logORmat">plot_logORmat</a>()</code>,
<code><a href="#topic+show_individual">show_individual</a>()</code>,
<code><a href="#topic+summarize_SS">summarize_SS</a>()</code>,
<code><a href="#topic+visualize_season">visualize_season</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(data_nplcm_noreg)
summarize_BrS(data_nplcm_noreg$Mobs$MBS[[1]], data_nplcm_noreg$Y)

</code></pre>

<hr>
<h2 id='summarize_SS'>silver-standard data summary</h2><span id='topic+summarize_SS'></span>

<h3>Description</h3>

<p>silver-standard data summary
</p>


<h3>Usage</h3>

<pre><code class='language-R'>summarize_SS(SS_dat, Y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summarize_SS_+3A_ss_dat">SS_dat</code></td>
<td>
<p>a data frame of silver-standard data. It can usually
be obtained by <code>data_nplcm$Mobs$MSS[[1]]</code>, meaning the first SS measurement
slice.</p>
</td></tr>
<tr><td><code id="summarize_SS_+3A_y">Y</code></td>
<td>
<p>a vector of case control status: 1 for case; 0 for control.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector of number of positives
</p>


<h3>See Also</h3>

<p>Other exploratory data analysis functions: 
<code><a href="#topic+get_top_pattern">get_top_pattern</a>()</code>,
<code><a href="#topic+plot_logORmat">plot_logORmat</a>()</code>,
<code><a href="#topic+show_individual">show_individual</a>()</code>,
<code><a href="#topic+summarize_BrS">summarize_BrS</a>()</code>,
<code><a href="#topic+visualize_season">visualize_season</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(data_nplcm_noreg)
summarize_BrS(data_nplcm_noreg$Mobs$MBS[[1]], data_nplcm_noreg$Y)
summarize_SS(data_nplcm_noreg$Mobs$MSS[[1]], data_nplcm_noreg$Y)

</code></pre>

<hr>
<h2 id='summary.nplcm'><code>summary.nplcm</code> summarizes the results from <code><a href="#topic+nplcm">nplcm()</a></code>.</h2><span id='topic+summary.nplcm'></span>

<h3>Description</h3>

<p><code>summary.nplcm</code> summarizes the results from <code><a href="#topic+nplcm">nplcm()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'nplcm'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.nplcm_+3A_object">object</code></td>
<td>
<p>Output from <code><a href="#topic+nplcm">nplcm()</a></code>.
An object of class &quot;nplcm&quot;</p>
</td></tr>
<tr><td><code id="summary.nplcm_+3A_...">...</code></td>
<td>
<p>Not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>see <code><a href="#topic+print.nplcm">print.nplcm()</a></code>
</p>


<h3>See Also</h3>

<p>Other nplcm results: 
<code><a href="#topic+print.nplcm">print.nplcm</a>()</code>,
<code><a href="#topic+print.summary.nplcm.no_reg">print.summary.nplcm.no_reg</a>()</code>,
<code><a href="#topic+print.summary.nplcm.reg_nest_strat">print.summary.nplcm.reg_nest_strat</a>()</code>,
<code><a href="#topic+print.summary.nplcm.reg_nest">print.summary.nplcm.reg_nest</a>()</code>,
<code><a href="#topic+print.summary.nplcm.reg_nonest_strat">print.summary.nplcm.reg_nonest_strat</a>()</code>,
<code><a href="#topic+print.summary.nplcm.reg_nonest">print.summary.nplcm.reg_nonest</a>()</code>
</p>

<hr>
<h2 id='sym_diff_month'>get symmetric difference of months from two vector of R-format dates</h2><span id='topic+sym_diff_month'></span>

<h3>Description</h3>

<p><code>sym_diff_month</code> evaluates the symmetric difference between two sets
of R-formatted date
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sym_diff_month(Rdate1, Rdate2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sym_diff_month_+3A_rdate1">Rdate1</code>, <code id="sym_diff_month_+3A_rdate2">Rdate2</code></td>
<td>
<p>R-formatted R dates. See <code><a href="base.html#topic+as.Date">as.Date()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>NULL</code> if no difference; the set of different months otherwise.
</p>

<hr>
<h2 id='symb2I'>Convert names of pathogen/combinations into 0/1 coding</h2><span id='topic+symb2I'></span>

<h3>Description</h3>

<p>Convert names of pathogen/combinations into 0/1 coding
</p>


<h3>Usage</h3>

<pre><code class='language-R'>symb2I(pathogen_name, pathogen_list)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="symb2I_+3A_pathogen_name">pathogen_name</code></td>
<td>
<p>The allowed pathogen name (can be a combination of pathogens in &quot;pathlist&quot;)</p>
</td></tr>
<tr><td><code id="symb2I_+3A_pathogen_list">pathogen_list</code></td>
<td>
<p>The complete list of pathogen names</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A 1 by length(pathlist) matrix of binary code (usually for pathogen presence/absence)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>symb2I("A",c("A","B","C"))
symb2I("A+B",c("A","B","C"))
symb2I("NoA",c("A","B","C"))
symb2I(c("A","B+C"),c("A","B","C")) # gives a 2 by 3 matrix.


</code></pre>

<hr>
<h2 id='tsb'>generate stick-breaking prior (truncated) from a vector of random probabilities</h2><span id='topic+tsb'></span>

<h3>Description</h3>

<p>generate stick-breaking prior (truncated) from a vector of random probabilities
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tsb(u)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tsb_+3A_u">u</code></td>
<td>
<p>a vector of probabilities, with the last element 1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector of the same length as u; sum to 1.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
oldpar &lt;- graphics::par(mfrow=c(3,3),oma=c(0,1,5,0),
   mar=c(1,2,1,1))
for (iter in 1:9){
 u   &lt;- c(rbeta(9,1,0.8),1)
 res &lt;- tsb(u)
 barplot(res,ylim=c(0,1),main=paste0("Random Sample #", iter),ylab="Probability")
}
graphics::mtext("Truncated Stick-Breaking Dist. (10 segments)",3,
     outer=TRUE,cex=1.5,line=1.5)
par(oldpar)
</code></pre>

<hr>
<h2 id='unfactor'>Convert factor to numeric without losing information on the label</h2><span id='topic+unfactor'></span>

<h3>Description</h3>

<p>Convert factor to numeric without losing information on the label
</p>


<h3>Usage</h3>

<pre><code class='language-R'>unfactor(f)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="unfactor_+3A_f">f</code></td>
<td>
<p>A factor</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector
</p>


<h3>Examples</h3>

<pre><code class='language-R'>unfactor(factor(c("1","3","3"),levels=c("1","3")))
# contrast this to:
as.numeric(factor(c("1","3","3"),levels=c("1","3"))) 
</code></pre>

<hr>
<h2 id='unique_cause'>get unique causes, regardless of the actual order in combo</h2><span id='topic+unique_cause'></span>

<h3>Description</h3>

<p>get unique causes, regardless of the actual order in combo
</p>


<h3>Usage</h3>

<pre><code class='language-R'>unique_cause(cause_vec)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="unique_cause_+3A_cause_vec">cause_vec</code></td>
<td>
<p>a vector of characters with potential combo repetitions
written in scrambled orders separated by &quot;+&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector of characters with unique meanings for latent causes
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- c("A","B","A","CC+DD","DD+CC","E+F+G","B")
unique_cause(x)

</code></pre>

<hr>
<h2 id='unique_month'>Get unique month from Date</h2><span id='topic+unique_month'></span>

<h3>Description</h3>

<p><code>unique_month</code> converts observed dates into unique months
to help visualize sampled months
</p>


<h3>Usage</h3>

<pre><code class='language-R'>unique_month(Rdate)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="unique_month_+3A_rdate">Rdate</code></td>
<td>
<p>standard date format in R</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector of characters with <code>month-year</code>, e.g., <code>4-2012</code>.
</p>

<hr>
<h2 id='visualize_case_control_matrix'>Visualize matrix for a quantity measured on cases and controls (a single number)</h2><span id='topic+visualize_case_control_matrix'></span>

<h3>Description</h3>

<p>Special to case-control visualization: upper right for cases, lower left
for controls.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>visualize_case_control_matrix(
  mat,
  dim_names = ncol(mat),
  cell_metrics = "",
  folding_line = TRUE,
  axes = FALSE,
  xlab = "",
  ylab = "",
  asp = 1,
  title = ""
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="visualize_case_control_matrix_+3A_mat">mat</code></td>
<td>
<p>matrix of values: upper for cases, lower for controls;</p>
</td></tr>
<tr><td><code id="visualize_case_control_matrix_+3A_dim_names">dim_names</code></td>
<td>
<p>names of the columns, from left to right. It is also the
names of the rows, from bottom to top. Default is 1 through <code>ncol(mat)</code>;</p>
</td></tr>
<tr><td><code id="visualize_case_control_matrix_+3A_cell_metrics">cell_metrics</code></td>
<td>
<p>the meaning of number in every cell;</p>
</td></tr>
<tr><td><code id="visualize_case_control_matrix_+3A_folding_line">folding_line</code></td>
<td>
<p>Default is <code>TRUE</code> for adding dashed major diagonal
line.</p>
</td></tr>
<tr><td><code id="visualize_case_control_matrix_+3A_axes">axes</code></td>
<td>
<p>plot axes; default is <code>FALSE</code>;</p>
</td></tr>
<tr><td><code id="visualize_case_control_matrix_+3A_xlab">xlab</code></td>
<td>
<p>label for x-axis</p>
</td></tr>
<tr><td><code id="visualize_case_control_matrix_+3A_ylab">ylab</code></td>
<td>
<p>label for y-axis</p>
</td></tr>
<tr><td><code id="visualize_case_control_matrix_+3A_asp">asp</code></td>
<td>
<p>aspect ratio; default is <code>1</code> to ensure square shape</p>
</td></tr>
<tr><td><code id="visualize_case_control_matrix_+3A_title">title</code></td>
<td>
<p>text for the figure</p>
</td></tr>
</table>


<h3>Value</h3>

<p>plotting function; no returned value.
</p>

<hr>
<h2 id='visualize_season'>visualize trend of pathogen observation rate for NPPCR data (both cases and controls)</h2><span id='topic+visualize_season'></span>

<h3>Description</h3>

<p>visualize trend of pathogen observation rate for NPPCR data (both cases and controls)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>visualize_season(data_nplcm, patho, slice = 1, slice_SS = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="visualize_season_+3A_data_nplcm">data_nplcm</code></td>
<td>
<p>Data set produced by <code><a href="#topic+clean_perch_data">clean_perch_data()</a></code></p>
</td></tr>
<tr><td><code id="visualize_season_+3A_patho">patho</code></td>
<td>
<p>the index of pathogen</p>
</td></tr>
<tr><td><code id="visualize_season_+3A_slice">slice</code></td>
<td>
<p>the slice of BrS data for visualization; default is 1.</p>
</td></tr>
<tr><td><code id="visualize_season_+3A_slice_ss">slice_SS</code></td>
<td>
<p>the slice of SS data to add onto BrS plots; default is 1, usually
representing blood culture measurements.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function shows observed
positive rate for continuous covariates,e.g., enrollment date
in PERCH application. Smoothing is done by penalized splines implemented by
<code>mgcv</code> package. The penalized spline smoothing term is constructed by
<code><a href="mgcv.html#topic+smooth.construct.ps.smooth.spec">mgcv::smooth.construct.ps.smooth.spec()</a></code>. The window size of the moving averages currently is set
to 60 days.
</p>


<h3>Value</h3>

<p>A figure with smoothed positive rate and confidence bands for cases
and controls, respectively. The right margin shows marginal positive rates; all
rates are only among the subset of case subjects who had non-missing responses
for a measured agent (e.g., pathogen); similarly for controls.
</p>


<h3>See Also</h3>

<p>Other exploratory data analysis functions: 
<code><a href="#topic+get_top_pattern">get_top_pattern</a>()</code>,
<code><a href="#topic+plot_logORmat">plot_logORmat</a>()</code>,
<code><a href="#topic+show_individual">show_individual</a>()</code>,
<code><a href="#topic+summarize_BrS">summarize_BrS</a>()</code>,
<code><a href="#topic+summarize_SS">summarize_SS</a>()</code>
</p>

<hr>
<h2 id='write_model_NoReg'>Write .bug model file for model without regression</h2><span id='topic+write_model_NoReg'></span>

<h3>Description</h3>

<p><code>write_model_NoReg</code> automatically generates model file according to
<code>model_options</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write_model_NoReg(
  k_subclass,
  Mobs,
  prior,
  cause_list,
  use_measurements,
  ppd = NULL,
  use_jags = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="write_model_NoReg_+3A_k_subclass">k_subclass</code></td>
<td>
<p>the number of subclasses for the slices that require
conditional dependence modeling (only applicable to BrS data); its length is
of the same value as the number of BrS slices.</p>
</td></tr>
<tr><td><code id="write_model_NoReg_+3A_mobs">Mobs</code></td>
<td>
<p>measurement data in the form of <code>data_nplcm</code></p>
</td></tr>
<tr><td><code id="write_model_NoReg_+3A_prior">prior</code></td>
<td>
<p>prior specification from <code>model_options</code></p>
</td></tr>
<tr><td><code id="write_model_NoReg_+3A_cause_list">cause_list</code></td>
<td>
<p>a list of latent status names (crucial for building templates;
see <code><a href="#topic+make_template">make_template()</a></code>)</p>
</td></tr>
<tr><td><code id="write_model_NoReg_+3A_use_measurements">use_measurements</code></td>
<td>
<p>&quot;BrS&quot;, or &quot;SS&quot;</p>
</td></tr>
<tr><td><code id="write_model_NoReg_+3A_ppd">ppd</code></td>
<td>
<p>Default is NULL; set to TRUE for posterior predictive checking</p>
</td></tr>
<tr><td><code id="write_model_NoReg_+3A_use_jags">use_jags</code></td>
<td>
<p>Default is FALSE; set to TRUE if want to use JAGS for model fitting.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a long character string to be written into .bug file.
</p>


<h3>See Also</h3>

<p><a href="#topic+insert_bugfile_chunk_noreg_meas">insert_bugfile_chunk_noreg_meas</a> for inserting .bug file
chunk for measurements (plug-and-play); <a href="#topic+insert_bugfile_chunk_noreg_etiology">insert_bugfile_chunk_noreg_etiology</a>
for inserting .bug file chunk for distribution of latent status (etiology).
</p>
<p>Other model generation functions: 
<code><a href="#topic+write_model_Reg_Nest">write_model_Reg_Nest</a>()</code>,
<code><a href="#topic+write_model_Reg_NoNest">write_model_Reg_NoNest</a>()</code>,
<code><a href="#topic+write_model_Reg_discrete_predictor_NoNest">write_model_Reg_discrete_predictor_NoNest</a>()</code>
</p>

<hr>
<h2 id='write_model_Reg_discrete_predictor_NoNest'>Write .bug model file for regression model without nested subclasses</h2><span id='topic+write_model_Reg_discrete_predictor_NoNest'></span>

<h3>Description</h3>

<p><code>write_model_Reg_discrete_predictor_NoNest</code> automatically generates model file according to
<code>model_options</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write_model_Reg_discrete_predictor_NoNest(
  Mobs,
  prior,
  cause_list,
  use_measurements,
  ppd = NULL,
  use_jags = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="write_model_Reg_discrete_predictor_NoNest_+3A_mobs">Mobs</code></td>
<td>
<p>Measurement data in the form of <code>data_nplcm</code></p>
</td></tr>
<tr><td><code id="write_model_Reg_discrete_predictor_NoNest_+3A_prior">prior</code></td>
<td>
<p>Prior specification from <code>model_options</code></p>
</td></tr>
<tr><td><code id="write_model_Reg_discrete_predictor_NoNest_+3A_cause_list">cause_list</code></td>
<td>
<p>A list of latent status names (crucial for building templates;
see <code><a href="#topic+make_template">make_template()</a></code>)</p>
</td></tr>
<tr><td><code id="write_model_Reg_discrete_predictor_NoNest_+3A_use_measurements">use_measurements</code></td>
<td>
<p>&quot;BrS&quot;, or &quot;SS&quot;</p>
</td></tr>
<tr><td><code id="write_model_Reg_discrete_predictor_NoNest_+3A_ppd">ppd</code></td>
<td>
<p>Default is NULL; set to TRUE for posterior predictive checking</p>
</td></tr>
<tr><td><code id="write_model_Reg_discrete_predictor_NoNest_+3A_use_jags">use_jags</code></td>
<td>
<p>Default is FALSE; set to TRUE if want to use JAGS for model fitting.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a long character string to be written into .bug file.
</p>


<h3>See Also</h3>

<p><a href="#topic+insert_bugfile_chunk_noreg_meas">insert_bugfile_chunk_noreg_meas</a> for inserting .bug file
chunk for measurements (plug-and-play); <a href="#topic+insert_bugfile_chunk_noreg_etiology">insert_bugfile_chunk_noreg_etiology</a>
for inserting .bug file chunk for distribution of latent status (etiology).
</p>
<p>Other model generation functions: 
<code><a href="#topic+write_model_NoReg">write_model_NoReg</a>()</code>,
<code><a href="#topic+write_model_Reg_Nest">write_model_Reg_Nest</a>()</code>,
<code><a href="#topic+write_model_Reg_NoNest">write_model_Reg_NoNest</a>()</code>
</p>

<hr>
<h2 id='write_model_Reg_Nest'>Write <code>.bug</code> model file for regression model WITH nested subclasses</h2><span id='topic+write_model_Reg_Nest'></span>

<h3>Description</h3>

<p><code>write_model_Reg_Nest</code> automatically generates model file according to
<code>model_options</code>; This is called within <a href="#topic+nplcm_fit_Reg_Nest">nplcm_fit_Reg_Nest</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write_model_Reg_Nest(
  Mobs,
  prior,
  cause_list,
  Eti_formula,
  FPR_formula,
  use_measurements,
  ppd = NULL,
  use_jags = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="write_model_Reg_Nest_+3A_mobs">Mobs</code></td>
<td>
<p>Measurement data in the form of <code>data_nplcm</code></p>
</td></tr>
<tr><td><code id="write_model_Reg_Nest_+3A_prior">prior</code></td>
<td>
<p>Prior specification from <code>model_options</code></p>
</td></tr>
<tr><td><code id="write_model_Reg_Nest_+3A_cause_list">cause_list</code></td>
<td>
<p>A list of latent status names (crucial for building templates;
see <code><a href="#topic+make_template">make_template()</a></code>)</p>
</td></tr>
<tr><td><code id="write_model_Reg_Nest_+3A_eti_formula">Eti_formula</code></td>
<td>
<p>Etiology regression formula; Check <code>model_options$likelihood$Eti_formula</code>.</p>
</td></tr>
<tr><td><code id="write_model_Reg_Nest_+3A_fpr_formula">FPR_formula</code></td>
<td>
<p>A list of FPR regression formula; check
<code>model_options$likelihood$FPR_formula</code></p>
</td></tr>
<tr><td><code id="write_model_Reg_Nest_+3A_use_measurements">use_measurements</code></td>
<td>
<p>&quot;BrS&quot;, or &quot;SS&quot;</p>
</td></tr>
<tr><td><code id="write_model_Reg_Nest_+3A_ppd">ppd</code></td>
<td>
<p>Default is NULL; set to TRUE for posterior predictive checking</p>
</td></tr>
<tr><td><code id="write_model_Reg_Nest_+3A_use_jags">use_jags</code></td>
<td>
<p>Default is FALSE; set to TRUE if want to use JAGS for model fitting.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a long character string to be written into .bug file.
</p>


<h3>See Also</h3>

<p><a href="#topic+insert_bugfile_chunk_noreg_meas">insert_bugfile_chunk_noreg_meas</a> for inserting .bug file
chunk for measurements (plug-and-play.R); <a href="#topic+insert_bugfile_chunk_noreg_etiology">insert_bugfile_chunk_noreg_etiology</a>
for inserting .bug file chunk for distribution of latent status (etiology).
</p>
<p>Other model generation functions: 
<code><a href="#topic+write_model_NoReg">write_model_NoReg</a>()</code>,
<code><a href="#topic+write_model_Reg_NoNest">write_model_Reg_NoNest</a>()</code>,
<code><a href="#topic+write_model_Reg_discrete_predictor_NoNest">write_model_Reg_discrete_predictor_NoNest</a>()</code>
</p>

<hr>
<h2 id='write_model_Reg_NoNest'>Write .bug model file for regression model without nested subclasses</h2><span id='topic+write_model_Reg_NoNest'></span>

<h3>Description</h3>

<p><code>write_model_Reg_NoNest</code> automatically generates model file according to
<code>model_options</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write_model_Reg_NoNest(
  Mobs,
  prior,
  cause_list,
  Eti_formula,
  FPR_formula,
  use_measurements,
  ppd = NULL,
  use_jags = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="write_model_Reg_NoNest_+3A_mobs">Mobs</code></td>
<td>
<p>Measurement data in the form of <code>data_nplcm</code></p>
</td></tr>
<tr><td><code id="write_model_Reg_NoNest_+3A_prior">prior</code></td>
<td>
<p>Prior specification from <code>model_options</code></p>
</td></tr>
<tr><td><code id="write_model_Reg_NoNest_+3A_cause_list">cause_list</code></td>
<td>
<p>A list of latent status names (crucial for building templates;
see <code><a href="#topic+make_template">make_template()</a></code>)</p>
</td></tr>
<tr><td><code id="write_model_Reg_NoNest_+3A_eti_formula">Eti_formula</code></td>
<td>
<p>Etiology regression formula; Check <code>model_options$likelihood$Eti_formula</code>.</p>
</td></tr>
<tr><td><code id="write_model_Reg_NoNest_+3A_fpr_formula">FPR_formula</code></td>
<td>
<p>A list of FPR regression formula; check
<code>model_options$likelihood$FPR_formula</code></p>
</td></tr>
<tr><td><code id="write_model_Reg_NoNest_+3A_use_measurements">use_measurements</code></td>
<td>
<p>&quot;BrS&quot;, or &quot;SS&quot;</p>
</td></tr>
<tr><td><code id="write_model_Reg_NoNest_+3A_ppd">ppd</code></td>
<td>
<p>Default is NULL; set to TRUE for posterior predictive checking</p>
</td></tr>
<tr><td><code id="write_model_Reg_NoNest_+3A_use_jags">use_jags</code></td>
<td>
<p>Default is FALSE; set to TRUE if want to use JAGS for model fitting.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a long character string to be written into .bug file.
</p>


<h3>See Also</h3>

<p><a href="#topic+insert_bugfile_chunk_noreg_meas">insert_bugfile_chunk_noreg_meas</a> for inserting .bug file
chunk for measurements (plug-and-play); <a href="#topic+insert_bugfile_chunk_noreg_etiology">insert_bugfile_chunk_noreg_etiology</a>
for inserting .bug file chunk for distribution of latent status (etiology).
</p>
<p>Other model generation functions: 
<code><a href="#topic+write_model_NoReg">write_model_NoReg</a>()</code>,
<code><a href="#topic+write_model_Reg_Nest">write_model_Reg_Nest</a>()</code>,
<code><a href="#topic+write_model_Reg_discrete_predictor_NoNest">write_model_Reg_discrete_predictor_NoNest</a>()</code>
</p>

<hr>
<h2 id='write.model'>function to write bugs model (copied from R2WinBUGS)</h2><span id='topic+write.model'></span>

<h3>Description</h3>

<p>function to write bugs model (copied from R2WinBUGS)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write.model(model, con = "model.bug", digits = 5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="write.model_+3A_model">model</code></td>
<td>
<p>R / S-PLUS function containing the BUGS model in the BUGS model language, for minor differences see Section Details.</p>
</td></tr>
<tr><td><code id="write.model_+3A_con">con</code></td>
<td>
<p>passed to writeLines which actually writes the model file</p>
</td></tr>
<tr><td><code id="write.model_+3A_digits">digits</code></td>
<td>
<p>number of significant digits used for WinBUGS input, see formatC</p>
</td></tr>
</table>


<h3>Value</h3>

<p>write text lines to a connection; same as <code><a href="base.html#topic+writeLines">writeLines()</a></code>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
