<!DOCTYPE html><html lang="en"><head><title>Help for package SenSpe</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {SenSpe}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#snsp1m'><p>Estimating specificity (or sensitivity) at a controlled sensitivity</p>
(or specificity) level</a></li>
<li><a href='#snsp2mp'><p>Two-biomarker paired comparison in specificity (or sensitivity) at a</p>
controlled sensitivity (or specificity) level</a></li>
<li><a href='#snsp2mup'><p>Two-biomarker unpaired comparison in specificity (or sensitivity) at a</p>
controlled sensitivity (or specificity) level</a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Version:</td>
<td>1.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-01-05</td>
</tr>
<tr>
<td>Title:</td>
<td>Estimating Specificity at Controlled Sensitivity, or Vice Versa</td>
</tr>
<tr>
<td>Author:</td>
<td>Yijian Huang &lt;yhuang5@emory.edu&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Yijian Huang &lt;yhuang5@emory.edu&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.8.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Description:</td>
<td>Perform biomarker evaluation and comparison in terms of specificity at a controlled sensitivity level, or sensitivity at a controlled specificity level. Point estimation and exact bootstrap of Huang, Parakati, Patil, and Sanda (2023) &lt;<a href="https://doi.org/10.5705%2Fss.202021.0020">doi:10.5705/ss.202021.0020</a>&gt; for the one- and two-biomarker problems are implemented.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-01-05 21:50:40 UTC; eugene</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-01-09 15:00:12 UTC</td>
</tr>
</table>
<hr>
<h2 id='snsp1m'>Estimating specificity (or sensitivity) at a controlled sensitivity
(or specificity) level</h2><span id='topic+snsp1m'></span>

<h3>Description</h3>

<p>Point estimation and exact bootstrap-based inference</p>


<h3>Usage</h3>

<pre><code class='language-R'>snsp1m(mk, n1, s0, covp=0.95, fixsens=TRUE, lbmdis=TRUE)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="snsp1m_+3A_mk">mk</code></td>
<td>
<p>biomarker values of cases followed by controls.</p>
</td></tr>
<tr><td><code id="snsp1m_+3A_n1">n1</code></td>
<td>
<p>size of cases.</p>
</td></tr>
<tr><td><code id="snsp1m_+3A_s0">s0</code></td>
<td>
<p>controlled level of sensitivity or specificity.</p>
</td></tr>
<tr><td><code id="snsp1m_+3A_covp">covp</code></td>
<td>
<p>norminal level of confidence intervals.</p>
</td></tr>
<tr><td><code id="snsp1m_+3A_fixsens">fixsens</code></td>
<td>
<p>fixing sensitivity if True, and specificity otherwise.</p>
</td></tr>
<tr><td><code id="snsp1m_+3A_lbmdis">lbmdis</code></td>
<td>
<p>larger biomarker value is more associated with cases if True,
and controls otherwise.</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>threshold</code></td>
<td>
<p>estimated threshold, at and beyond which the empirical
sensitivity or specificity is the smallest no less than the controlled level
s0.</p>
</td></tr>
<tr><td><code>hss</code></td>
<td>
<p>hss[1]: empirical point estimate of specificity at controlled
sensitivity, or vice versa; hss[2]: oscillating bias-corrected estimate.</p>
</td></tr>
<tr><td><code>hvar1</code></td>
<td>
<p>estimated variance component from cases if specificity at
controlled sensitivity is estimated, or from controls otherwise.</p>
</td></tr>
<tr><td><code>hvar2</code></td>
<td>
<p>estimated variance component from controls if specificity at
controlled sensitivity is estimated, or from cases otherwise.</p>
</td></tr>
<tr><td><code>hvar</code></td>
<td>
<p>exact bootstrap variance estimate, =hvar1+hvar2.</p>
</td></tr>
<tr><td><code>btpdf</code></td>
<td>
<p>exact bootstrap probability mass function at (0:n0)/n0 with n0
being the size of controls if sensitivity is controlled, or at (0:n1)/n1
otherwise.</p>
</td></tr>
<tr><td><code>wald_ci</code></td>
<td>
<p>wald_ci[1,]: Wald confidence interval using hss[1];
wald_ci[2,]: Wald confidence interval using hss[2].</p>
</td></tr>
<tr><td><code>pct_ci</code></td>
<td>
<p>percentile confidence interval.</p>
</td></tr>
<tr><td><code>scr_ci</code></td>
<td>
<p>scr_ci[1,]: score confidence interval using hss[1];
scr_ci[2,]: score confidence interval using hss[2].</p>
</td></tr>
<tr><td><code>zq_ci</code></td>
<td>
<p>exact bootstrap version of the BTII in Zhou and Qin (2005,
Statistics in Medicine 24, pp 465&ndash;477).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Yijian Huang</p>


<h3>References</h3>

<p>Huang, Y., Parakati, I., Patil, D. H.,and Sanda, M. G. (2023).
Interval estimation for operating characteristic of continuous biomarkers with
controlled sensitivity or specificity, <em>Statistica Sinica</em> 33, 193&ndash;214.</p>


<h3>Examples</h3>

<pre><code class='language-R'>## simulate biomarkers of 100 cases and 100 controls
set.seed(1234)
mk &lt;- c(rnorm(100,1,1),rnorm(100,0,1))

## estimate specificity at controlled 0.95 sensitivity
est &lt;- snsp1m(mk, 100, 0.95)
</code></pre>

<hr>
<h2 id='snsp2mp'>Two-biomarker paired comparison in specificity (or sensitivity) at a
controlled sensitivity (or specificity) level</h2><span id='topic+snsp2mp'></span>

<h3>Description</h3>

<p>Point estimation and exact bootstrap-based inference</p>


<h3>Usage</h3>

<pre><code class='language-R'>snsp2mp(mk, n1, s0, covp=0.95, fixsens=TRUE, lbmdis=TRUE)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="snsp2mp_+3A_mk">mk</code></td>
<td>
<p>Each of two rows corresponds to a biomarker, cases followed by
controls.</p>
</td></tr>
<tr><td><code id="snsp2mp_+3A_n1">n1</code></td>
<td>
<p>case size.</p>
</td></tr>
<tr><td><code id="snsp2mp_+3A_s0">s0</code></td>
<td>
<p>controlled level of sensitivity or specificity.</p>
</td></tr>
<tr><td><code id="snsp2mp_+3A_covp">covp</code></td>
<td>
<p>norminal level of confidence intervals.</p>
</td></tr>
<tr><td><code id="snsp2mp_+3A_fixsens">fixsens</code></td>
<td>
<p>fixing sensitivity if True, and specificity otherwise.</p>
</td></tr>
<tr><td><code id="snsp2mp_+3A_lbmdis">lbmdis</code></td>
<td>
<p>larger value of a biomarker is more associated with cases if
True, and controls otherwise.</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>diff</code></td>
<td>
<p>diff[1]: difference of empirical point estimates;
hss[2]: difference of oscillating bias-corrected estimates.</p>
</td></tr>
<tr><td><code>btmn</code></td>
<td>
<p>bootstrap mean of the empirical difference.</p>
</td></tr>
<tr><td><code>btva</code></td>
<td>
<p>exact bootstrap variance estimate for diff[1].</p>
</td></tr>
<tr><td><code>btdist</code></td>
<td>
<p>exact bootstrap probability mass function at (-n0:n0)/n0 with n0
being the size of controls if sensitivity is controlled, or at (-n1:n1)/n1
otherwise.</p>
</td></tr>
<tr><td><code>wald_ci</code></td>
<td>
<p>wald_ci[1,]: Wald confidence interval using diff[1];
wald_ci[2,]: Wald confidence interval using diff[2].</p>
</td></tr>
<tr><td><code>pct_ci</code></td>
<td>
<p>percentile confidence interval.</p>
</td></tr>
<tr><td><code>scr_ci</code></td>
<td>
<p>scr_ci[1,]: score confidence interval using diff[1];
scr_ci[2,]: score confidence interval using diff[2].</p>
</td></tr>
<tr><td><code>zq_ci</code></td>
<td>
<p>extension of the BTII in Zhou and Qin (2005,
Statistics in Medicine 24, pp 465&ndash;477).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Yijian Huang</p>


<h3>References</h3>

<p>Huang, Y., Parakati, I., Patil, D. H.,and Sanda, M. G. (2023).
Interval estimation for operating characteristic of continuous biomarkers with
controlled sensitivity or specificity, <em>Statistica Sinica</em> 33, 193&ndash;214.</p>


<h3>Examples</h3>

<pre><code class='language-R'>## simulate paired biomarkers X and Y, with correlation 0.5, 100 cases and 100 controls
n1 &lt;- 100
n0 &lt;- 100
rho &lt;- 0.5
set.seed(1234)
mkx &lt;- rnorm(n1+n0,0,1)
mky &lt;- rho*mkx + sqrt(1-rho^2)*rnorm(n1+n0,0,1)
mkx &lt;- mkx + c(rep(2,n1),rep(0,n0))
mky &lt;- mky + c(rep(1,n1),rep(0,n0))
mk &lt;- rbind(mkx,mky)

## compare specificity at controlled 0.95 sensitivity
est &lt;- snsp2mp(mk, 100, 0.95)
</code></pre>

<hr>
<h2 id='snsp2mup'>Two-biomarker unpaired comparison in specificity (or sensitivity) at a
controlled sensitivity (or specificity) level</h2><span id='topic+snsp2mup'></span>

<h3>Description</h3>

<p>Point estimation and exact bootstrap-based inference</p>


<h3>Usage</h3>

<pre><code class='language-R'>snsp2mup(mkx, n1x, mky, n1y, s0, covp=0.95, fixsens=TRUE, lbmdisx=TRUE, lbmdisy=TRUE)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="snsp2mup_+3A_mkx">mkx</code></td>
<td>
<p>values of biomarker X, cases followed by controls.</p>
</td></tr>
<tr><td><code id="snsp2mup_+3A_n1x">n1x</code></td>
<td>
<p>case size of biomarker X.</p>
</td></tr>
<tr><td><code id="snsp2mup_+3A_mky">mky</code></td>
<td>
<p>values of biomarker Y, cases followed by controls.</p>
</td></tr>
<tr><td><code id="snsp2mup_+3A_n1y">n1y</code></td>
<td>
<p>case size of biomarker Y.</p>
</td></tr>
<tr><td><code id="snsp2mup_+3A_s0">s0</code></td>
<td>
<p>controlled level of sensitivity or specificity.</p>
</td></tr>
<tr><td><code id="snsp2mup_+3A_covp">covp</code></td>
<td>
<p>norminal level of confidence intervals.</p>
</td></tr>
<tr><td><code id="snsp2mup_+3A_fixsens">fixsens</code></td>
<td>
<p>fixing sensitivity if True, and specificity otherwise.</p>
</td></tr>
<tr><td><code id="snsp2mup_+3A_lbmdisx">lbmdisx</code></td>
<td>
<p>larger value of biomarker X is more associated with cases if
True, and controls otherwise.</p>
</td></tr>
<tr><td><code id="snsp2mup_+3A_lbmdisy">lbmdisy</code></td>
<td>
<p>larger value of biomarker Y is more associated with cases if
True, and controls otherwise.</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>diff</code></td>
<td>
<p>diff[1]: difference of empirical point estimates;
diff[2]: difference of oscillating bias-corrected estimates.</p>
</td></tr>
<tr><td><code>hvar</code></td>
<td>
<p>exact bootstrap variance estimate for diff[1].</p>
</td></tr>
<tr><td><code>wald_ci</code></td>
<td>
<p>wald_ci[1,]: Wald confidence interval using diff[1];
wald_ci[2,]: Wald confidence interval using diff[2].</p>
</td></tr>
<tr><td><code>pct_ci</code></td>
<td>
<p>percentile confidence interval.</p>
</td></tr>
<tr><td><code>scr_ci</code></td>
<td>
<p>scr_ci[1,]: score confidence interval using diff[1];
scr_ci[2,]: score confidence interval using diff[2].</p>
</td></tr>
<tr><td><code>zq_ci</code></td>
<td>
<p>extension of the BTII in Zhou and Qin (2005,
Statistics in Medicine 24, pp 465&ndash;477).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Yijian Huang</p>


<h3>References</h3>

<p>Huang, Y., Parakati, I., Patil, D. H.,and Sanda, M. G. (2023).
Interval estimation for operating characteristic of continuous biomarkers with
controlled sensitivity or specificity, <em>Statistica Sinica</em> 33, 193&ndash;214.</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1234)
## simulate biomarker X with 100 cases and 100 controls
mkx &lt;- c(rnorm(100,2,1),rnorm(100,0,1))
## simulate biomarker Y with 100 cases and 100 controls
mky &lt;- c(rnorm(100,1,1),rnorm(100,0,1))

## compare specificity at controlled 0.95 sensitivity
est &lt;- snsp2mup(mkx, 100, mky, 100, 0.95)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
