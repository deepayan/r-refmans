<!DOCTYPE html><html lang="en"><head><title>Help for package iNEXT.beta3D</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {iNEXT.beta3D}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#iNEXT.beta3D-package'>
<p>Interpolation and extrapolation with beta diversity for three dimensions of biodiversity</p></a></li>
<li><a href='#Brazil_distM'>
<p>Species pairwise distance matrix for species in the dataset <code>Brazil_rainforests</code></p></a></li>
<li><a href='#Brazil_rainforests'>
<p>Brazil rainforests data (datatype = &quot;abundance&quot; for TD, PD, and FD)</p></a></li>
<li><a href='#Brazil_tree'>
<p>Phylogenetic tree for Brazil abundance data</p></a></li>
<li><a href='#DataInfobeta3D'><p>Data information for reference samples</p></a></li>
<li><a href='#ggiNEXTbeta3D'><p>ggplot2 extension for the iNEXTbeta3D object</p></a></li>
<li><a href='#iNEXTbeta3D'><p>iNterpolation and EXTrapolation with beta diversity for TD, PD and FD</p></a></li>
<li><a href='#print.iNEXTbeta3D'><p>Printing <code>iNEXTbeta3D</code> object</p></a></li>
<li><a href='#Second_growth_forests'>
<p>Second-growth forests data (datatype = &quot;incidence_raw&quot; for taxonomic diversity)</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Interpolation and Extrapolation with Beta Diversity for Three
Dimensions of Biodiversity</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.2</td>
</tr>
<tr>
<td>Author:</td>
<td>Anne Chao [aut, cre],
  KaiHsiang Hu [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Anne Chao &lt;chao@stat.nthu.edu.tw&gt;</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://sites.google.com/view/chao-lab-website/software/inext-beta3d">https://sites.google.com/view/chao-lab-website/software/inext-beta3d</a></td>
</tr>
<tr>
<td>Description:</td>
<td>As a sequel to 'iNEXT', the 'iNEXT.beta3D' package provides functions to compute 
              standardized taxonomic, phylogenetic, and functional diversity (3D) estimates 
              with a common sample size (for alpha and gamma diversity) or sample coverage 
              (for alpha, beta, gamma diversity as well as dissimilarity or turnover indices). 
              Hill numbers and their generalizations are used to quantify 3D and to make 
              multiplicative decomposition (gamma = alpha x beta). The package also features 
              size- and coverage-based rarefaction and extrapolation sampling curves to 
              facilitate rigorous comparison of beta diversity across datasets.  
              See Chao et al. (2023) &lt;<a href="https://doi.org/10.1002%2Fecm.1588">doi:10.1002/ecm.1588</a>&gt; for more details.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, magrittr, ggplot2, abind, iNEXT.3D, future.apply,
tibble, dplyr, tidytree, tidyr, phyclust, ape</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, knitr, rmarkdown, ggthemes</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/AnneChao/iNEXT.beta3D/issues">https://github.com/AnneChao/iNEXT.beta3D/issues</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>ByteCompile:</td>
<td>true</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-04-17 15:03:43 UTC; stat-pc</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-04-17 19:40:11 UTC</td>
</tr>
</table>
<hr>
<h2 id='iNEXT.beta3D-package'>
Interpolation and extrapolation with beta diversity for three dimensions of biodiversity
</h2><span id='topic+iNEXT.beta3D-package'></span><span id='topic+iNEXT.beta3D'></span>

<h3>Description</h3>

<p>This package <code>iNEXT.beta3D</code> (iNterpolation and EXTrapolation with beta diversity for three dimensions of biodiversity)
is a sequel to <code>iNEXT</code>. Here the three dimensions (3D) of diversity includes taxonomic diversity (TD),
phylogenetic diversity (PD) and functional diversity (FD). An online version &quot;iNEXT.beta3D Online&quot;
(https://chao.shinyapps.io/iNEXT_beta3D/) is also available for users without an R background.<br />
</p>
<p>A unified framework based on Hill numbers (for TD) and their generalizations (Hill-Chao numbers, for PD and FD) 
is adopted to quantify 3D. In this framework, TD quantifies the effective number of species, PD quantifies the 
effective total branch length or total evolutionary history, mean-PD (PD divided by 
tree depth) quantifies the effective number of lineages, and FD quantifies the effective number of virtual functional
groups (or functional &quot;species&quot;). Thus, TD, mean-PD, and FD are all in the same units of species/lineage equivalents
and can be meaningfully compared; see Chao et al. (2021) for a review of the unified framework. <br />
</p>
<p>For each of the three dimensions, <code>iNEXT.beta3D</code> focuses on the multiplicative diversity decomposition 
(gamma = alpha x beta) of orders q = 0, 1 and 2 based on sampling data. Beta diversity quantifies the extent 
of among-assemblage differentiation, or the changes in species/lineages/functional-groups composition and
their abundance among assemblages. <code>iNEXT.beta3D</code> features standardized 3D estimates with a common sample size
(for alpha and gamma diversity) or sample coverage (for alpha, beta and gamma diversity). <code>iNEXT.beta3D</code> also 
features standardized estimates of four classes of coverage-based dissimilarity measures. Based on the 
rarefaction and extrapolation (R/E) method for Hill numbers (TD) for q = 0, 1 and 2, Chao et al. (2023b) 
developed the pertinent R/E theory for taxonomic beta diversity with applications to real-world spatial,
temporal and spatio-temporal data. An application to Gentry's global forest data along with a concise 
description of the theory is provided in Chao et al. (2023a). The extension to phylogenetic and functional
beta diversity is generally parallel.<br />
</p>
<p><code>iNEXT.beta3D</code> also features two types of R/E sampling curves:
</p>
<p>*	Sample-size-based (or size-based) R/E curves: This type of sampling curve plots standardized 3D gamma and 
alpha diversity with respect to sample size. Note that the size-based beta diversity is not a statistically 
valid measure (Chao et al. 2023b) and thus the corresponding sampling curve is not provided. 
</p>
<p>*	Coverage-based R/E sampling curves: This type of sampling curve plots standardized 3D gamma, alpha, and
beta diversity as well as four classes of dissimilarity measures with respect to sample coverage 
(an objective measure of sample completeness).<br />
</p>
<p>Sufficient data are needed to run <code>iNEXT.beta3D</code>. If your data comprise only a few species and their 
abundances/phylogenies/traits, it is probable that the data lack sufficient information to run <code>iNEXT.beta3D</code>.  
</p>
<p>This package contains three main functions: <br />
</p>
<p>1. <code>iNEXTbeta3D</code> computes standardized 3D estimates with a common sample size (for alpha and gamma diversity)
or sample coverage (for alpha, beta and gamma diversity) for default sample sizes or coverage values. This function 
also computes coverage-based standardized 3D estimates of four classes of dissimilarity measures for default coverage 
values. In addition, this function also computes standardized 3D 
estimates with a particular vector of user-specified sample sizes or coverage values. <br />
</p>
<p>2. <code>ggiNEXTbeta3D</code> visualizes the output from the function <code>iNEXTbeta3D</code>. <br />
</p>
<p>3. <code>DataInfobeta3D</code> provides basic data information for (1) the reference sample in each assemblage, 
(2) the gamma reference sample in the pooled assemblage, and (3) the alpha reference sample in the joint assemblage.
</p>


<h3>Author(s)</h3>

<p>Anne Chao, K.H. Hu <br />
</p>
<p>Maintainer: Anne Chao &lt;chao@stat.nthu.edu.tw&gt;
</p>


<h3>References</h3>

<p>Chao, A., Chiu, C.-H., Hu, K.-H., and Zeleny, D. (2023a). Revisiting Alwyn H. Gentry's forest transect data: 
a statistical sampling-model-based approach. Japanese Journal of Statistics and Data Science, 6, 861-884. 
https://doi.org/10.1007/s42081-023-00214-1 <br /><br />
Chao, A., Henderson, P. A., Chiu, C.-H., Moyes, F., Hu, K.-H., Dornelas, M. and Magurran, A. E. (2021).
Measuring temporal change in alpha diversity: a framework integrating taxonomic, phylogenetic and functional diversity 
and the iNEXT.3D standardization. Methods in Ecology and Evolution, 12, 1926-1940. <br /><br />
Chao, A., Thorn, S., Chiu, C.-H., Moyes, F., Hu, K.-H., Chazdon, R. L., Wu, J., Dornelas, M., Zeleny, D., Colwell, R. K., and Magurran, A. E. (2023b). Rarefaction and extrapolation with beta diversity under a framework of Hill numbers: The iNEXT.beta3D standardization. Ecological Monographs e1588. https://doi.org/10.1002/ecm.1588 <br /><br />
</p>

<hr>
<h2 id='Brazil_distM'>
Species pairwise distance matrix for species in the dataset <code>Brazil_rainforests</code>
</h2><span id='topic+Brazil_distM'></span>

<h3>Description</h3>

<p>This dataset includes a tree species pairwise symmetric distance matrix for 185 species listed in the 
<code>Brazil_rainforests</code> dataset. Each element in the matrix represents a Gower distance between two species
computed from species traits. <br />
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Brazil_distM)</code></pre>


<h3>Format</h3>

<p><code>Brazil_distM</code> is a 185 x 185 (species by species) symmetric data.frame. Each element of the data.frame
is between zero (for species pairs with identical traits) and one.  <br />
$ Carpotroche_brasiliensis      : num  0 0.522 0.522 0.253 0.0.396 ... <br />
$ Astronium_concinnum           : num  0.522 0 0 0.525 0.0.625 ... <br />
$ Astronium_graveolens          : num  0.522 0 0 0.525 0.0.625 ... <br />
....... <br />
</p>

<hr>
<h2 id='Brazil_rainforests'>
Brazil rainforests data (datatype = &quot;abundance&quot; for TD, PD, and FD)
</h2><span id='topic+Brazil_rainforests'></span>

<h3>Description</h3>

<p>This dataset includes tree species abundace counts in two rainforests (Marium and Rebio2) collected from
rainforests in Brazil by Magnago et al. (2014, 2015, 2017). Within each forest, 
there are two assemblages/habitats (Edge and Interior). The data are slightly different from those used in 
Chao et al. (2023) because some species are excluded due to lack of phylogeny information. <br />
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Brazil_rainforests)</code></pre>


<h3>Format</h3>

<p><code>Brazil_rainforests</code> is a list with two species-by-assemblage data.frames/matrices. The two columns
represents the Edge and Interior habitats. <br />
A list of 2 matrices: <br />
$ Marim is a matrix with 119 species(rows) and 2 columns (&quot;Edge&quot; and &quot;Interior&quot;). <br />
$ Rebio2 is a matrix with 118 species(rows) and 2 columns (&quot;Edge&quot; and &quot;Interior&quot;). <br />
</p>


<h3>References</h3>

<p>Chao, A., Henderson, P. A., Chiu, C.-H., Moyes, F., Hu, K.-H., Dornelas, M. and Magurran, A. E. (2021).
Measuring temporal change in alpha diversity: a framework integrating taxonomic, phylogenetic and functional diversity 
and the iNEXT.3D standardization. Methods in Ecology and Evolution, 12, 1926-1940.<br /><br />
Magnago, L. F. S., Edwards, D. P., Edwards, F. A., Magrach, A., Martins, S. V., &amp; Laurance, W. F. (2014). Functional attributes change but functional richness is unchanged after fragmentation of Brazilian Atlantic forests. Journal of Ecology, 102, 475-485. <br /><br />
Magnago, L. F. S., Magrach, A., Barlow, J., Schaefer, C. E. G. R., Laurance, W. F., Martins, S. V., &amp; Edwards, D. P. (2017). Do fragment size and edge effects predict carbon stocks in trees and lianas in tropical forests? Functional Ecology, 31, 542-552. <br /><br />
Magnago, L. F. S., Rocha, M. F., Meyer, L., Martins, S. V., &amp; Meira-Neto, J. A. A. (2015). Microclimatic conditions at forest edges have significant impacts on vegetation structure in large Atlantic forest fragments. Biodiversity and Conservation, 24, 2305-2318. <br /><br />
</p>

<hr>
<h2 id='Brazil_tree'>
Phylogenetic tree for Brazil abundance data
</h2><span id='topic+Brazil_tree'></span>

<h3>Description</h3>

<p>This dataset includes a phylogenetic tree spanned by 185 species listed in the <code>Brazil_rainforests</code> dataset.  <br />
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Brazil_tree)</code></pre>


<h3>Format</h3>

<p><code>Brazil_tree</code> is a list (phylo tree) with the following phylogenetic information: <br />
A list of 5: <br />
$ edge       : int [1:301, 1:2] 186 187 188 189 190 191 192 193 193 194 ... <br />
$ edge.length: num [1:301] 75 146 8 6 18 10 10 127 6 23 ... <br />
$ Nnode      : int 117 <br />
$ node.label : chr [1:117] &quot;magnoliales_to_asterales&quot; &quot;poales_to_asterales&quot; ... <br />
$ tip.label  : chr [1:185] &quot;Carpotroche_brasiliensis&quot; &quot;Casearia_ulmifolia&quot; &quot;Casearia_sp2&quot; ... <br />
</p>

<hr>
<h2 id='DataInfobeta3D'>Data information for reference samples</h2><span id='topic+DataInfobeta3D'></span>

<h3>Description</h3>

<p><code>DataInfobeta3D</code> provides basic data information for (1) the reference sample in each assemblage, 
(2) the gamma reference sample in the pooled assemblage, and (3) the alpha reference sample in the
joint assemblage for TD, PD and FD.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DataInfobeta3D(
  data,
  diversity = "TD",
  datatype = "abundance",
  PDtree = NULL,
  PDreftime = NULL,
  FDdistM = NULL,
  FDtype = "AUC",
  FDtau = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="DataInfobeta3D_+3A_data">data</code></td>
<td>
<p>(a) For <code>datatype = "abundance"</code>, species abundance data for a single dataset can be input as a <code>matrix/data.frame</code> (species-by-assemblage); data for multiple datasets can be input as a <code>list</code> of <code>matrices/data.frames</code>, with each matrix representing a species-by-assemblage abundance matrix for one of the datasets.<br />
(b) For <code>datatype = "incidence_raw"</code>, data for a single dataset with N assemblages can be input as a <code>list</code> of <code>matrices/data.frames</code>, with each matrix representing a species-by-sampling-unit incidence matrix for one of the assemblages; data for multiple datasets can be input as multiple lists.</p>
</td></tr>
<tr><td><code id="DataInfobeta3D_+3A_diversity">diversity</code></td>
<td>
<p>selection of diversity type: <code>'TD'</code> = Taxonomic diversity, <code>'PD'</code> = Phylogenetic diversity, and <code>'FD'</code> = Functional diversity.</p>
</td></tr>
<tr><td><code id="DataInfobeta3D_+3A_datatype">datatype</code></td>
<td>
<p>data type of input data: individual-based abundance data (<code>datatype = "abundance"</code>) or species by sampling-units incidence/occurrence matrix (<code>datatype = "incidence_raw"</code>) with all entries being 0 (non-detection) or 1 (detection).</p>
</td></tr>
<tr><td><code id="DataInfobeta3D_+3A_pdtree">PDtree</code></td>
<td>
<p>(required argument for <code>diversity = "PD"</code>), a phylogenetic tree in Newick format for all observed species in the pooled assemblage.</p>
</td></tr>
<tr><td><code id="DataInfobeta3D_+3A_pdreftime">PDreftime</code></td>
<td>
<p>(argument only for <code>diversity = "PD"</code>), a numerical value specifying reference time for PD. Default is <code>PDreftime = NULL</code> (i.e., the age of the root of <code>PDtree</code>).</p>
</td></tr>
<tr><td><code id="DataInfobeta3D_+3A_fddistm">FDdistM</code></td>
<td>
<p>(required argument for <code>diversity = "FD"</code>), a species pairwise distance matrix for all species in the pooled assemblage.</p>
</td></tr>
<tr><td><code id="DataInfobeta3D_+3A_fdtype">FDtype</code></td>
<td>
<p>(argument only for <code>diversity = "FD"</code>), select FD type: <code>FDtype = "tau_value"</code> for FD under a specified threshold value, or <code>FDtype = "AUC"</code> (area under the curve of tau-profile) for an overall FD which integrates all threshold values between zero and one. Default is <code>FDtype = "AUC"</code>.</p>
</td></tr>
<tr><td><code id="DataInfobeta3D_+3A_fdtau">FDtau</code></td>
<td>
<p>(argument only for <code>diversity = "FD"</code> and <code>FDtype = "tau_value"</code>), a numerical value between 0 and
1 specifying the tau value (threshold level) that will be used to compute FD. If <code>FDtype = NULL</code> (default), 
then threshold level is set to be the mean distance between any two individuals randomly selected from the pooled 
dataset (i.e., quadratic entropy).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.frame including basic data information.<br /><br /> 
For abundance data, basic information shared by TD, mean-PD and FD
includes dataset name (<code>Dataset</code>), individual/pooled/joint assemblage (<code>Assemblage</code>),
sample size (<code>n</code>), observed species richness (<code>S.obs</code>), sample coverage estimates of the reference sample (<code>SC(n)</code>), 
sample coverage estimate for twice the reference sample size (<code>SC(2n)</code>). Other additional information is given below.<br /><br />
(1) TD: the first five species abundance frequency counts in the reference sample (<code>f1</code>&ndash;<code>f5</code>).<br /><br />
(2) Mean-PD: the the observed total branch length in the phylogenetic tree (<code>PD.obs</code>), 
the number of singletons (<code>f1*</code>) and doubletons (<code>f2*</code>) in the node/branch abundance set, as well as the total branch length 
of those singletons (<code>g1</code>) and of those doubletons (<code>g2</code>), and the reference time (<code>Reftime</code>).<br /><br />
(3) FD (<code>FDtype = "AUC"</code>): the minimum distance (<code>dmin</code>) and the maximum distance (<code>dmax</code>) among all non-diagonal elements in the distance matrix, 
and the mean distance between any two individuals randomly selected from the dataset (<code>dmean</code>).<br /><br />
(4) FD (<code>FDtype = "tau_value"</code>): the number of singletons (<code>a1*</code>) and of doubletons (<code>a2*</code>) among the functionally indistinct
set at the specified threshold level <code>'Tau'</code>, as well as the total contribution of singletons (<code>h1</code>) and of doubletons (<code>h2</code>)
at the specified threshold level <code>'Tau'</code>.<br /><br />
</p>
<p>For incidence data, the basic information for TD includes dataset name (<code>Dataset</code>), individual/pooled/joint assemblage 
(<code>Assemblage</code>), number of sampling units (<code>T</code>), total number of incidences (<code>U</code>), observed species richness (<code>S.obs</code>), 
sample coverage estimates of the reference sample (<code>SC(T)</code>), sample coverage estimate for twice the reference sample size
(<code>SC(2T)</code>), as well as the first five species incidence frequency counts (<code>Q1</code>&ndash;<code>Q5</code>) in the reference sample. For mean-PD and FD, output is similar to that
for abundance data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## (Data Information) Taxonomic diversity for abundance data
data(Brazil_rainforests)
info_TD_abun = DataInfobeta3D(data = Brazil_rainforests, diversity = 'TD', datatype = 'abundance')
info_TD_abun


## (Data Information) Taxonomic diversity for incidence data
data(Second_growth_forests)
info_TD_inci = DataInfobeta3D(data = Second_growth_forests, diversity = 'TD',
                              datatype = 'incidence_raw')
info_TD_inci


## (Data Information) Mean phylogenetic diversity for abundance data
data(Brazil_rainforests)
data(Brazil_tree)
info_PD_abun = DataInfobeta3D(data = Brazil_rainforests, diversity = 'PD', 
                              datatype = 'abundance', PDtree = Brazil_tree, PDreftime = NULL)
info_PD_abun


## (Data Information) Functional diversity for abundance data under a specified threshold level
data(Brazil_rainforests)
data(Brazil_distM)
info_FDtau_abun = DataInfobeta3D(data = Brazil_rainforests, diversity = 'FD', 
                                 datatype = 'abundance', FDdistM = Brazil_distM, 
                                 FDtype = 'tau_value', FDtau = NULL)
info_FDtau_abun


## (Data Information) Functional diversity for abundance data when all threshold levels
## from 0 to 1 are considered
data(Brazil_rainforests)
data(Brazil_distM)
info_FDAUC_abun = DataInfobeta3D(data = Brazil_rainforests, diversity = 'FD', 
                                 datatype = 'abundance', FDdistM = Brazil_distM, FDtype = 'AUC')
info_FDAUC_abun


</code></pre>

<hr>
<h2 id='ggiNEXTbeta3D'>ggplot2 extension for the iNEXTbeta3D object</h2><span id='topic+ggiNEXTbeta3D'></span>

<h3>Description</h3>

<p><code>ggiNEXTbeta3D</code> is an <code>ggplot2</code> extension for the <code>iNEXTbeta3D</code> 
object to plot sample-size- and coverage-based rarefaction/extrapolation curves.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ggiNEXTbeta3D(output, type = "B")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ggiNEXTbeta3D_+3A_output">output</code></td>
<td>
<p>output from the function <code>iNEXTbeta3D</code>.</p>
</td></tr>
<tr><td><code id="ggiNEXTbeta3D_+3A_type">type</code></td>
<td>
<p>(argument only for <code>base = "coverage"</code>),<br />
<code>type = 'B'</code> for plotting the rarefaction and extrapolation sampling curves for gamma, alpha, and beta diversity;  <br />
<code>type = 'D'</code> for plotting the rarefaction and extrapolation sampling curves for four dissimilarity indices.<br />
Skip the argument for plotting size-based rarefaction and extrapolation sampling curves for gamma and alpha diversity.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a figure for gamma, alpha, and beta diversity, or a figure for four dissimilarity indices for <code>base = "coverage"</code>; 
or a figure for gamma and alpha diversity when <code>base = "size"</code>.<br />
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## (Graphic Display) Taxonomic diversity for abundance data
# Coverage-based rarefaction and extrapolation sampling curves 
data(Brazil_rainforests)
output_TDc_abun = iNEXTbeta3D(data = Brazil_rainforests, diversity = 'TD', 
                              datatype = 'abundance', base = "coverage", nboot = 10)

ggiNEXTbeta3D(output_TDc_abun, type = 'B')
ggiNEXTbeta3D(output_TDc_abun, type = 'D')


# Size-based rarefaction and extrapolation sampling curves 
data(Brazil_rainforests)
output_TDs_abun = iNEXTbeta3D(data = Brazil_rainforests, diversity = 'TD', 
                              datatype = 'abundance', base = "size", nboot = 10)

ggiNEXTbeta3D(output_TDs_abun)


## (Graphic Display) Taxonomic diversity for incidence data
# Coverage-based rarefaction and extrapolation sampling curves 
data(Second_growth_forests)
output_TDc_inci = iNEXTbeta3D(data = Second_growth_forests, diversity = 'TD', 
                              datatype = 'incidence_raw', base = "coverage", nboot = 10)

ggiNEXTbeta3D(output_TDc_inci, type = 'B')
ggiNEXTbeta3D(output_TDc_inci, type = 'D')


# Size-based rarefaction and extrapolation sampling curves 
data(Second_growth_forests)
output_TDs_inci = iNEXTbeta3D(data = Second_growth_forests, diversity = 'TD', 
                              datatype = 'incidence_raw', base = "size", nboot = 10)

ggiNEXTbeta3D(output_TDs_inci)


## (Graphic Display) Phylogenetic diversity for abundance data
# Coverage-based rarefaction and extrapolation sampling curves 
data(Brazil_rainforests)
data(Brazil_tree)
output_PDc_abun = iNEXTbeta3D(data = Brazil_rainforests, diversity = 'PD', 
                              datatype = 'abundance', base = "coverage", nboot = 10, 
                              PDtree = Brazil_tree, PDreftime = NULL, PDtype = 'meanPD')

ggiNEXTbeta3D(output_PDc_abun, type = 'B')
ggiNEXTbeta3D(output_PDc_abun, type = 'D')


# Size-based rarefaction and extrapolation sampling curves 
data(Brazil_rainforests)
data(Brazil_tree)
output_PDs_abun = iNEXTbeta3D(data = Brazil_rainforests, diversity = 'PD', 
                              datatype = 'abundance', base = "size", nboot = 10, 
                              PDtree = Brazil_tree, PDreftime = NULL, PDtype = 'meanPD')

ggiNEXTbeta3D(output_PDs_abun)


## (Graphic Display) Functional diversity for abundance data when all threshold levels 
## from 0 to 1 are considered
# Coverage-based rarefaction and extrapolation sampling curves 
data(Brazil_rainforests)
data(Brazil_distM)
output_FDc_abun = iNEXTbeta3D(data = Brazil_rainforests, diversity = 'FD', 
                              datatype = 'abundance', base = "coverage", nboot = 10, 
                              FDdistM = Brazil_distM, FDtype = 'AUC', FDcut_number = 30)

ggiNEXTbeta3D(output_FDc_abun, type = 'B')
ggiNEXTbeta3D(output_FDc_abun, type = 'D')


# Size-based rarefaction and extrapolation sampling curves 
data(Brazil_rainforests)
data(Brazil_distM)
output_FDs_abun = iNEXTbeta3D(data = Brazil_rainforests, diversity = 'FD', 
                              datatype = 'abundance', base = "size", nboot = 10, 
                              FDdistM = Brazil_distM, FDtype = 'AUC', FDcut_number = 30)

ggiNEXTbeta3D(output_FDs_abun)



</code></pre>

<hr>
<h2 id='iNEXTbeta3D'>iNterpolation and EXTrapolation with beta diversity for TD, PD and FD</h2><span id='topic+iNEXTbeta3D'></span>

<h3>Description</h3>

<p><code>iNEXTbeta3D</code> computes standardized 3D estimates with a common sample size
(for alpha and gamma diversity) or sample coverage (for alpha, beta, gamma diversity as well as
dissimilarity indices) for default sizes or coverage values. This function also computes standardized 3D estimates
with a particular vector of user-specified sample sizes or coverage values. See Chao et al. (2023) for the theory.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>iNEXTbeta3D(
  data,
  diversity = "TD",
  q = c(0, 1, 2),
  datatype = "abundance",
  base = "coverage",
  level = NULL,
  nboot = 10,
  conf = 0.95,
  PDtree = NULL,
  PDreftime = NULL,
  PDtype = "meanPD",
  FDdistM = NULL,
  FDtype = "AUC",
  FDtau = NULL,
  FDcut_number = 30
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="iNEXTbeta3D_+3A_data">data</code></td>
<td>
<p>(a) For <code>datatype = "abundance"</code>, species abundance data for a single dataset can be input as a <code>matrix/data.frame</code> (species-by-assemblage); data for multiple datasets can be input as a <code>list</code> of <code>matrices/data.frames</code>, with each matrix representing a species-by-assemblage abundance matrix for one of the datasets.<br />
(b) For <code>datatype = "incidence_raw"</code>, data for a single dataset with N assemblages can be input as a <code>list</code> of <code>matrices/data.frames</code>, with each matrix representing a species-by-sampling-unit incidence matrix for one of the assemblages; data for multiple datasets can be input as multiple lists.</p>
</td></tr>
<tr><td><code id="iNEXTbeta3D_+3A_diversity">diversity</code></td>
<td>
<p>selection of diversity type: <code>'TD'</code> = Taxonomic diversity, <code>'PD'</code> = Phylogenetic diversity, and <code>'FD'</code> = Functional diversity.</p>
</td></tr>
<tr><td><code id="iNEXTbeta3D_+3A_q">q</code></td>
<td>
<p>a numerical vector specifying the diversity orders. Default is <code>c(0, 1, 2)</code>.</p>
</td></tr>
<tr><td><code id="iNEXTbeta3D_+3A_datatype">datatype</code></td>
<td>
<p>data type of input data: individual-based abundance data (<code>datatype = "abundance"</code>) or species by sampling-units incidence/occurrence matrix (<code>datatype = "incidence_raw"</code>) with all entries being 0 (non-detection) or 1 (detection).</p>
</td></tr>
<tr><td><code id="iNEXTbeta3D_+3A_base">base</code></td>
<td>
<p>standardization base: coverage-based rarefaction and extrapolation for gamma, alpha, beta diversity, and four classes of dissimilarity indices (<code>base = "coverage"</code>), or sized-based rarefaction and extrapolation for gamma and alpha diversity (<code>base = "size"</code>). Default is <code>base = "coverage"</code>.</p>
</td></tr>
<tr><td><code id="iNEXTbeta3D_+3A_level">level</code></td>
<td>
<p>a numerical vector specifying the particular values of sample coverage (between 0 and 1 when 
<code>base = "coverage"</code>) or sample sizes (<code>base = "size"</code>) that will be used to compute standardized
diversity/dissimilarity. Asymptotic diversity estimator can be obtained by setting <code>level = 1</code>
( i.e., complete coverage for <code>base = "coverage"</code>). <br />
By default (with <code>base = "coverage"</code>), 
this function computes the standardized 3D gamma, alpha, beta diversity, and four dissimilarity indices 
for coverage up to one (for <code>q = 1, 2</code>) or up to the coverage of double the reference sample size 
(for <code>q = 0</code>), in increments of 0.025. The extrapolation limit for beta diversity is defined as that
for alpha diversity. <br />
If users set <code>base = "size"</code>, this function computes the size-based standardized
3D gamma and alpha diversity estimates based on 40 equally-spaced sample sizes/knots from sample size 1 
up to double the reference sample size.</p>
</td></tr>
<tr><td><code id="iNEXTbeta3D_+3A_nboot">nboot</code></td>
<td>
<p>a positive integer specifying the number of bootstrap replications when assessing sampling uncertainty and constructing confidence intervals. Bootstrap replications are generally time consuming. Set <code>nboot = 0</code> to skip the bootstrap procedures. Default is <code>nboot = 10</code>. If more accurate results are required, set <code>nboot = 100</code> (or <code>nboot = 200</code>).</p>
</td></tr>
<tr><td><code id="iNEXTbeta3D_+3A_conf">conf</code></td>
<td>
<p>a positive number &lt; 1 specifying the level of confidence interval. Default is 0.95.</p>
</td></tr>
<tr><td><code id="iNEXTbeta3D_+3A_pdtree">PDtree</code></td>
<td>
<p>(required argument for <code>diversity = "PD"</code>), a phylogenetic tree in Newick format for all observed species in the pooled assemblage.</p>
</td></tr>
<tr><td><code id="iNEXTbeta3D_+3A_pdreftime">PDreftime</code></td>
<td>
<p>(argument only for <code>diversity = "PD"</code>), a numerical value specifying reference time for PD. Default is <code>PDreftime = NULL</code> (i.e., the age of the root of <code>PDtree</code>).</p>
</td></tr>
<tr><td><code id="iNEXTbeta3D_+3A_pdtype">PDtype</code></td>
<td>
<p>(argument only for <code>diversity = "PD"</code>), select PD type: <code>PDtype = "PD"</code> (effective total branch length) or <code>PDtype = "meanPD"</code> (effective number of equally divergent lineages). Default is <code>PDtype = "meanPD"</code>, where <code>meanPD = PD/tree depth</code>.</p>
</td></tr>
<tr><td><code id="iNEXTbeta3D_+3A_fddistm">FDdistM</code></td>
<td>
<p>(required argument for <code>diversity = "FD"</code>), a species pairwise distance matrix for all species in the pooled dataset.</p>
</td></tr>
<tr><td><code id="iNEXTbeta3D_+3A_fdtype">FDtype</code></td>
<td>
<p>(argument only for <code>diversity = "FD"</code>), select FD type: <code>FDtype = "tau_value"</code> for FD under a specified threshold value, or <code>FDtype = "AUC"</code> (area under the curve of tau-profile) for an overall FD which integrates all threshold values between zero and one. Default is <code>FDtype = "AUC"</code>.</p>
</td></tr>
<tr><td><code id="iNEXTbeta3D_+3A_fdtau">FDtau</code></td>
<td>
<p>(argument only for <code>diversity = "FD"</code> and <code>FDtype = "tau_value"</code>), a numerical value between 0 and
1 specifying the tau value (threshold level) that will be used to compute FD. If <code>FDtype = NULL</code> (default), 
then threshold level is set to be the mean distance between any two individuals randomly selected from the pooled 
dataset (i.e., quadratic entropy).</p>
</td></tr>
<tr><td><code id="iNEXTbeta3D_+3A_fdcut_number">FDcut_number</code></td>
<td>
<p>(argument only for <code>diversity = "FD"</code> and <code>FDtype = "AUC"</code>), a numeric number to cut [0, 1] interval into equal-spaced sub-intervals to obtain the AUC value by integrating the tau-profile. Equivalently, the number of tau values that will be considered to compute the integrated AUC value. Default is <code>FDcut_number = 30</code>. A larger value can be set to obtain more accurate AUC value.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>For <code>base = "coverage"</code>, return a list of seven data frames with three diversity (gamma, alpha, and beta
diversity) and four dissimilarity measures. For <code>base = "size"</code>, return a list of two matrices with two diversity
(gamma and alpha diversity).<br /> 
</p>
<p>For <code>base = "coverage"</code>, the output in each data frame includes: 
</p>
<table role = "presentation">
<tr><td><code>Dataset</code></td>
<td>
<p>the name of dataset.</p>
</td></tr>
<tr><td><code>Order.q</code></td>
<td>
<p>the diversity order of q.</p>
</td></tr> 
<tr><td><code>SC</code></td>
<td>
<p>the target standardized coverage value.</p>
</td></tr>
<tr><td><code>Size/mT</code></td>
<td>
<p>the corresponding sample size.</p>
</td></tr>
<tr><td><code>Alpha/Beta/Gamma/Dissimilarity</code></td>
<td>
<p>the estimated diversity/dissimilarity estimate.</p>
</td></tr>
<tr><td><code>Method</code></td>
<td>
<p>Rarefaction, Observed, or Extrapolation, depending on whether the target coverage is less than, equal to, or greater than the coverage of the reference sample.</p>
</td></tr> 
<tr><td><code>s.e.</code></td>
<td>
<p>standard error of standardized estimate.</p>
</td></tr>
<tr><td><code>LCL</code>, <code>UCL</code></td>
<td>
<p>the bootstrap lower and upper confidence limits for the diversity/dissimilarity with a default significance level of 0.95.</p>
</td></tr>
<tr><td><code>Diversity</code></td>
<td>
<p><code>'TD'</code> = 'Taxonomic diversity', <code>'PD'</code> = 'Phylogenetic diversity', <code>'meanPD'</code> = 'Mean phylogenetic diversity', <code>'FD_tau'</code> = 'Functional diversity (given tau)', <code>'FD_AUC'</code> = 'Functional diversity (AUC)'</p>
</td></tr>
<tr><td><code>Reftime</code></td>
<td>
<p>the reference time for PD.</p>
</td></tr>
<tr><td><code>Tau</code></td>
<td>
<p>the threshold of functional distinctiveness between any two species for FD (under <code>FDtype = "tau_value"</code>).</p>
</td></tr>
</table>
<p>Similar output is obtained for <code>base = "size"</code>.<br />
</p>


<h3>References</h3>

<p>Chao, A., Thorn, S., Chiu, C.-H., Moyes, F., Hu, K.-H., Chazdon, R. L., Wu, J., Magnago, 
L. F. S., Dornelas, M., Zeleny, D., Colwell, R. K., and Magurran, A. E. (2023). 
Rarefaction and extrapolation with beta diversity under a framework of Hill numbers: 
the iNEXT.beta3D standardization. Ecological Monographs e1588.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## (R/E Analysis) Taxonomic diversity for abundance data
# Coverage-based standardized TD estimates and related statistics
data(Brazil_rainforests)
output_TDc_abun = iNEXTbeta3D(data = Brazil_rainforests, diversity = 'TD', 
                              datatype = 'abundance', base = "coverage", nboot = 10)
output_TDc_abun


# Coverage-based standardized TD estimates and related statistics by 
# user-specified coverage values
data(Brazil_rainforests)
output_TDc_abun_byuser = iNEXTbeta3D(data = Brazil_rainforests, diversity = 'TD', 
                                     datatype = 'abundance', base = "coverage", nboot = 10,
                                     level = c(0.85, 0.9))
output_TDc_abun_byuser


# Size-based standardized TD estimates and related statistics
data(Brazil_rainforests)
output_TDs_abun = iNEXTbeta3D(data = Brazil_rainforests, diversity = 'TD', 
                              datatype = 'abundance', base = "size", nboot = 10)
output_TDs_abun


# Size-based standardized TD estimates and related statistics by user-specified sample sizes
data(Brazil_rainforests)
output_TDs_abun_byuser = iNEXTbeta3D(data = Brazil_rainforests, diversity = 'TD', 
                                     datatype = 'abundance', base = "size", nboot = 10,
                                     level = c(300, 500))
output_TDs_abun_byuser


## (R/E Analysis) Taxonomic diversity for incidence data
# Coverage-based standardized TD estimates and related statistics
data(Second_growth_forests)
output_TDc_inci = iNEXTbeta3D(data = Second_growth_forests, diversity = 'TD', 
                              datatype = 'incidence_raw', base = "coverage", nboot = 10)
output_TDc_inci


# Coverage-based standardized TD estimates and related statistics by 
# user-specified coverage values
data(Second_growth_forests)
output_TDc_inci_byuser = iNEXTbeta3D(data = Second_growth_forests, diversity = 'TD', 
                                     datatype = 'incidence_raw', base = "coverage", 
                                     nboot = 10, level = c(0.9, 0.95))
output_TDc_inci_byuser


# Size-based standardized TD estimates and related statistics
data(Second_growth_forests)
output_TDs_inci = iNEXTbeta3D(data = Second_growth_forests, diversity = 'TD', 
                              datatype = 'incidence_raw', base = "size", nboot = 10)
output_TDs_inci


# Size-based standardized TD estimates and related statistics by user-specified sample sizes
data(Second_growth_forests)
output_TDs_inci_byuser = iNEXTbeta3D(data = Second_growth_forests, diversity = 'TD', 
                                     datatype = 'incidence_raw', base = "size", 
                                     nboot = 10, level = c(100, 200))
output_TDs_inci_byuser


## (R/E Analysis) Phylogenetic diversity for abundance data
# Coverage-based standardized PD estimates and related statistics
data(Brazil_rainforests)
data(Brazil_tree)
output_PDc_abun = iNEXTbeta3D(data = Brazil_rainforests, diversity = 'PD', 
                              datatype = 'abundance', base = "coverage", nboot = 10, 
                              PDtree = Brazil_tree, PDreftime = NULL, PDtype = 'meanPD')
output_PDc_abun


# Size-based standardized PD estimates and related statistics
data(Brazil_rainforests)
data(Brazil_tree)
output_PDs_abun = iNEXTbeta3D(data = Brazil_rainforests, diversity = 'PD', 
                              datatype = 'abundance', base = "size", nboot = 10, 
                              PDtree = Brazil_tree, PDreftime = NULL, PDtype = 'meanPD')
output_PDs_abun


## (R/E Analysis) Functional diversity for abundance data when all thresholds from 0 to 1 
## are considered
# Coverage-based standardized FD estimates and related statistics
data(Brazil_rainforests)
data(Brazil_distM)
output_FDc_abun = iNEXTbeta3D(data = Brazil_rainforests, diversity = 'FD', 
                              datatype = 'abundance', base = "coverage", nboot = 10, 
                              FDdistM = Brazil_distM, FDtype = 'AUC', FDcut_number = 30)
output_FDc_abun


# Size-based standardized FD estimates and related statistics
data(Brazil_rainforests)
data(Brazil_distM)
output_FDs_abun = iNEXTbeta3D(data = Brazil_rainforests, diversity = 'FD', 
                              datatype = 'abundance', base = "size", nboot = 10, 
                              FDdistM = Brazil_distM, FDtype = 'AUC', FDcut_number = 30)
output_FDs_abun



</code></pre>

<hr>
<h2 id='print.iNEXTbeta3D'>Printing <code>iNEXTbeta3D</code> object</h2><span id='topic+print.iNEXTbeta3D'></span>

<h3>Description</h3>

<p><code>print.iNEXTbeta3D</code>: Print method for objects inheriting from class <code>"iNEXTbeta3D"</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'iNEXTbeta3D'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.iNEXTbeta3D_+3A_x">x</code></td>
<td>
<p>an <code>iNEXTbeta3D</code> object computed by <code>iNEXTbeta3D</code>.</p>
</td></tr>
<tr><td><code id="print.iNEXTbeta3D_+3A_...">...</code></td>
<td>
<p>additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of multiple objects (see <code>iNEXTbeta3D</code> for more details) with simplified outputs.
</p>

<hr>
<h2 id='Second_growth_forests'>
Second-growth forests data (datatype = &quot;incidence_raw&quot; for taxonomic diversity)
</h2><span id='topic+Second_growth_forests'></span>

<h3>Description</h3>

<p>This dataset includes tree incidence data in 100 subplots (each with 0.01 ha) collected from two 
second-growth forests, namely Cuatro Rios (CR) and Juan Enriquez (JE) in Costa Rica.
Each 1-ha forest was divided into 100 subplots (each with 0.01 ha) and only species' incidence records 
in each subplot were used to compute the incidence frequency for a species 
(i.e., the number of subplots in which that species occurred); see Chazdon et al. (2021, 2022)
for sampling details and pertinent analyses. The original time series data covers 2005 to 2017; here only two-year data
(2005 and 2017) are used for assessing temporal beta diversity between the two years within each forest. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Second_growth_forests)</code></pre>


<h3>Format</h3>

<p>Second_growth_forests is a list with two forests. The input format for each forests is a list with two species-by-sampling-units matrices (&quot;Year_2005&quot; and &quot;Year_2017&quot;). Each matrix record the species as 0 (undetect) or 1 (detect) in each sampling units. <br />
A list of 2  <br />
$ CR 2005 vs. 2017: A list of 2 <br />
.. ..$ Year_2005 (151 (species) x 100 (quadrats)) <br />
.. ..$ Year_2017 (151 (species) x 100 (quadrats)) <br /> 
$ JE 2005 vs. 2017: A list of 2 <br />
.. ..$ Year_2005 (107 (species) x 100 (quadrats)) <br />
.. ..$ Year_2017 (107 (species) x 100 (quadrats)) <br /> 
</p>


<h3>References</h3>

<p>Chazdon, R. (2021). Tree abundance in eight 1-ha tropical forest plots in northeastern Costa Rica from 1997-2017, https://doi.org/10.5061/dryad.ncjsxksvr <br /><br />
Chazdon, R. L., N. Norden, R. K. Colwell, and A. Chao. (2022). Monitoring recovery of tree diversity during tropical forest restoration: lessons from long-term trajectories of natural regeneration. Philosophical Transactions of the Royal Society B, 378: 20210069. <br /><br />
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
