<!DOCTYPE html><html><head><title>Help for package conicfit</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {conicfit}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#AtoG'><p>Conversion of algebraic parameters to geometric parameters</p></a></li>
<li><a href='#calculateCircle'><p> Generate points from a circle</p></a></li>
<li><a href='#calculateEllipse'><p> Generate points from a ellipse</p></a></li>
<li><a href='#CircleFitByKasa'><p>Algebraic circle fit (Kasa method)</p></a></li>
<li><a href='#CircleFitByLandau'><p>Geometric circle fit (minimizing orthogonal distances) by Landau</p>
algorithm</a></li>
<li><a href='#CircleFitByPratt'><p>Algebraic circle fit by Pratt</p></a></li>
<li><a href='#CircleFitBySpath'><p>Geometric circle fit by Spath</p></a></li>
<li><a href='#CircleFitByTaubin'><p>Algebraic circle fit (Taubin method)</p></a></li>
<li><a href='#CurrentIteration'><p>Internal conicfit functions</p></a></li>
<li><a href='#EllipseDirectFit'><p> Algebraic ellipse fit method by Fitzgibbon-Pilu-Fisher</p></a></li>
<li><a href='#EllipseFitByTaubin'><p>Algebraic ellipse fit by Taubin</p></a></li>
<li><a href='#ellipticity'><p>Formulas for the ellipse</p></a></li>
<li><a href='#estimateInitialGuessCircle'><p>Estimate Initial Guess Circle values</p></a></li>
<li><a href='#fit.conicLMA'><p>Fitting a conic to a given set of points (Implicit method)</p></a></li>
<li><a href='#fit.ellipseLMG'><p>Fitting an ellipse using Implicit method</p></a></li>
<li><a href='#fitbookstein'><p> Linear ellipse fit using bookstein constraint</p></a></li>
<li><a href='#GtoA'><p>Conversion of geometric parameters to algebraic parameters</p></a></li>
<li><a href='#JmatrixLMA'><p>Compute the Jacobian matrix using algebraic parameters</p></a></li>
<li><a href='#JmatrixLMG'><p>Compute the Jacobian matrix using geometric parameters</p></a></li>
<li><a href='#LMcircleFit'><p>Geometric circle fit (minimizing orthogonal distances) based on the</p>
Levenberg-Marquardt method</a></li>
<li><a href='#LMreducedCircleFit'><p>Geometric circle fit (minimizing orthogonal distances) based on the</p>
Levenberg-Marquardt method</a></li>
<li><a href='#Residuals.ellipse'><p>Projecting a given set of points onto an ellipse</p></a></li>
<li><a href='#Residuals.hyperbola'><p>Projecting a given set of points onto an hyperbola</p></a></li>
<li><a href='#Residuals.parabola'><p>Projecting a given set of points onto an parabola</p></a></li>
<li><a href='#ResidualsG'><p>Projecting a given set of points onto an ellipse</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Algorithms for Fitting Circles, Ellipses and Conics Based on the
Work by Prof. Nikolai Chernov</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.4</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Description:</td>
<td>Geometric circle fitting with Levenberg-Marquardt (a, b, R), Levenberg-Marquardt reduced (a, b), Landau, Spath and Chernov-Lesort. Algebraic circle fitting with Taubin, Kasa, Pratt and Fitzgibbon-Pilu-Fisher. Geometric ellipse fitting with ellipse LMG (geometric parameters) and conic LMA (algebraic parameters). Algebraic ellipse fitting with Fitzgibbon-Pilu-Fisher and Taubin.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.7.0), pracma, geigen</td>
</tr>
<tr>
<td>Author:</td>
<td>Jose Gama [aut, cre],
  Nikolai Chernov [aut, cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jose Gama &lt;rxprtgama@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Repository/R-Forge/Project:</td>
<td>conicfit</td>
</tr>
<tr>
<td>Repository/R-Forge/Revision:</td>
<td>10</td>
</tr>
<tr>
<td>Repository/R-Forge/DateTimeStamp:</td>
<td>2015-10-05 15:19:30</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2015-10-05 22:57:57</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2015-10-05 15:25:31 UTC; rforge</td>
</tr>
</table>
<hr>
<h2 id='AtoG'>Conversion of algebraic parameters to geometric parameters</h2><span id='topic+AtoG'></span>

<h3>Description</h3>

<p><code>AtoG</code> converts algebraic parameters (A, B, C, D, E, F) to 
geometric parameters (Center(1:2), Axes(1:2), Angle).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AtoG(ParA)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="AtoG_+3A_para">ParA</code></td>
<td>
<p> vector or array with geometric parameters (A, B, C, D, E, F)</p>
</td></tr>
</table>


<h3>Format</h3>

<p>code is:  -1 - degenerate cases  
0 - imaginary ellipse  
4 - imaginary parell lines
1 - ellipse  2 - hyperbola 3 - parabola
</p>


<h3>Value</h3>

<table>
<tr><td><code>list(ParG</code>, <code>exitCode</code></td>
<td>
<p> list with algebraic parameters (Center(1:2), 
Axes(1:2), Angle) and exit code</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jose Gama</p>


<h3>Source</h3>

<p>Nikolai Chernov, 2014
Fitting ellipses, circles, and lines by least squares
<a href="http://people.cas.uab.edu/~mosya/cl/">http://people.cas.uab.edu/~mosya/cl/</a>
</p>
<p>Nikolai Chernov, 2010
Circular and linear regression: Fitting circles and lines by least squares
Chapman &amp; Hall/CRC, Monographs on Statistics and Applied Probability, Volume 117
</p>


<h3>References</h3>

<p>Nikolai Chernov, 2014
Fitting ellipses, circles, and lines by least squares
<a href="http://people.cas.uab.edu/~mosya/cl/">http://people.cas.uab.edu/~mosya/cl/</a>
</p>
<p>Nikolai Chernov, 2010
Circular and linear regression: Fitting circles and lines by least squares
Chapman &amp; Hall/CRC, Monographs on Statistics and Applied Probability, Volume 117
</p>


<h3>Examples</h3>

<pre><code class='language-R'>AtoG(c(0.0551,-0.0908,0.1588,0.0489,-0.9669,0.1620))
</code></pre>

<hr>
<h2 id='calculateCircle'> Generate points from a circle</h2><span id='topic+calculateCircle'></span>

<h3>Description</h3>

<p><code>calculateCircle</code> generates points from a circle 
with many options, equally spaced, randomly spaced, with noise added 
to the radius or limited to a segment of angle alpha.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculateCircle(x, y, r, steps=50,sector=c(0,360),randomDist=FALSE, 
randomFun=runif, noiseFun = NA, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calculateCircle_+3A_x">x</code></td>
<td>
<p> center point x</p>
</td></tr>
<tr><td><code id="calculateCircle_+3A_y">y</code></td>
<td>
<p> center point y</p>
</td></tr>
<tr><td><code id="calculateCircle_+3A_r">r</code></td>
<td>
<p> radius</p>
</td></tr>
<tr><td><code id="calculateCircle_+3A_steps">steps</code></td>
<td>
<p> number of points</p>
</td></tr>
<tr><td><code id="calculateCircle_+3A_sector">sector</code></td>
<td>
<p> limited circular sector</p>
</td></tr>
<tr><td><code id="calculateCircle_+3A_randomdist">randomDist</code></td>
<td>
<p> logical, TRUE = randomly spaced</p>
</td></tr>
<tr><td><code id="calculateCircle_+3A_randomfun">randomFun</code></td>
<td>
<p> random function for the position of the points in the circle</p>
</td></tr>
<tr><td><code id="calculateCircle_+3A_noisefun">noiseFun</code></td>
<td>
<p> random function for the noise</p>
</td></tr>
<tr><td><code id="calculateCircle_+3A_...">...</code></td>
<td>
<p> optional parameters to pass to randomFun</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>points</code></td>
<td>
<p> array n x 2 of point coordinates.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jose Gama</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# 100 points from a circle at c(0,0) with radius=200
a&lt;-calculateCircle(0,0,200,100)
plot(a[,1],a[,2],xlim=c(-250,250),ylim=c(-250,250))
par(new=T)
# 12 points from a circle at c(0,0) with radius=190, points between 0 and 90 
#degrees
a&lt;-calculateCircle(0,0,190,12,c(0,90))
plot(a[,1],a[,2],xlim=c(-250,250),ylim=c(-250,250),col='red')
par(new=T)
# 12 points from a circle at c(0,0) with radius=180, points between 0 and 180 
#degrees, uniform random distribution
a&lt;-calculateCircle(0,0,180,12,c(0,180),TRUE)
plot(a[,1],a[,2],xlim=c(-250,250),ylim=c(-250,250),col='green')
par(new=T)
# 12 points from a circle at c(0,0) with radius=170, points between 0 and 180 
#degrees, normal random distribution
a&lt;-calculateCircle(0,0,170,12,c(0,180),TRUE,rnorm)
plot(a[,1],a[,2],xlim=c(-250,250),ylim=c(-250,250),col='blue')
par(new=T)
# 12 points from a circle at c(0,0) with radius=200, points between 0 and 180 
#degrees, positioned by uniform random distribution, noise=normal random 
#distribution with sd=10
a&lt;-calculateCircle(0,0,200,12,c(180,360),TRUE,noiseFun=function(x) 
(x+rnorm(1,mean=0,sd=10)))
plot(a[,1],a[,2],xlim=c(-250,250),ylim=c(-250,250),col='orange')

## End(Not run)
</code></pre>

<hr>
<h2 id='calculateEllipse'> Generate points from a ellipse</h2><span id='topic+calculateEllipse'></span>

<h3>Description</h3>

<p><code>calculateEllipse</code> generates points from a ellipse 
with many options, equally spaced, randomly spaced, with noise added 
to the radius or limited to a segment of angle alpha.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculateEllipse(x, y, a, b, angle = 0, steps = 50, sector = c(0, 360), 
randomDist = FALSE, randomFun = runif, noiseFun = NA, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calculateEllipse_+3A_x">x</code></td>
<td>
<p> center point x</p>
</td></tr>
<tr><td><code id="calculateEllipse_+3A_y">y</code></td>
<td>
<p> center point y</p>
</td></tr>
<tr><td><code id="calculateEllipse_+3A_a">a</code></td>
<td>
<p> axis a</p>
</td></tr>
<tr><td><code id="calculateEllipse_+3A_b">b</code></td>
<td>
<p> axis b</p>
</td></tr>
<tr><td><code id="calculateEllipse_+3A_angle">angle</code></td>
<td>
<p> tilt angle</p>
</td></tr>
<tr><td><code id="calculateEllipse_+3A_steps">steps</code></td>
<td>
<p> number of points</p>
</td></tr>
<tr><td><code id="calculateEllipse_+3A_sector">sector</code></td>
<td>
<p> limited circular sector</p>
</td></tr>
<tr><td><code id="calculateEllipse_+3A_randomdist">randomDist</code></td>
<td>
<p> logical, TRUE = randomly spaced</p>
</td></tr>
<tr><td><code id="calculateEllipse_+3A_randomfun">randomFun</code></td>
<td>
<p> random function for the position of the points in the ellipse</p>
</td></tr>
<tr><td><code id="calculateEllipse_+3A_noisefun">noiseFun</code></td>
<td>
<p> random function for the noise</p>
</td></tr>
<tr><td><code id="calculateEllipse_+3A_...">...</code></td>
<td>
<p> optional parameters to pass to randomFun</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>points</code></td>
<td>
<p> array n x 2 of point coordinates.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jose Gama</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# 50 points from an ellipse at c(0,0) with axis (200, 100), angle 45 degrees
a&lt;-calculateEllipse(0,0,200,100,45,50)
plot(a[,1],a[,2],xlim=c(-250,250),ylim=c(-250,250))
par(new=T)
# 10 points from an ellipse at c(0,0) with axis (200, 100), angle 45 degrees,
#points between 0 and 180 # degrees, normal random distribution
b&lt;-calculateEllipse(0,0,200,100,45,10,c(0,90))
plot(b[,1],b[,2],xlim=c(-250,250),ylim=c(-250,250),col='red')
par(new=T)
# 50 points from an ellipse at c(0,0) with axis (200, 100), angle 45 degrees
a&lt;-calculateEllipse(0,0,200,100,45,50, randomDist=TRUE,noiseFun=function(x) 
(x+rnorm(1,mean=0,sd=10)))
plot(a[,1],a[,2],xlim=c(-250,250),ylim=c(-250,250),col='cyan')

## End(Not run)
</code></pre>

<hr>
<h2 id='CircleFitByKasa'>Algebraic circle fit (Kasa method)</h2><span id='topic+CircleFitByKasa'></span>

<h3>Description</h3>

<p><code>CircleFitByKasa</code> applies the simple algebraic circle fit
(Kasa method) </p>


<h3>Usage</h3>

<pre><code class='language-R'>CircleFitByKasa(XY)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CircleFitByKasa_+3A_xy">XY</code></td>
<td>
<p> array of sample data  </p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>vector(a</code>, <code>b</code>, <code>R)</code></td>
<td>
<p> vector with the values for the circle: center (a,b)
and radius R</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jose Gama</p>


<h3>Source</h3>

<p>Nikolai Chernov, 2014
Fitting ellipses, circles, and lines by least squares
<a href="http://people.cas.uab.edu/~mosya/cl/">http://people.cas.uab.edu/~mosya/cl/</a>
</p>
<p>Nikolai Chernov, 2010
Circular and linear regression: Fitting circles and lines by least squares
Chapman &amp; Hall/CRC, Monographs on Statistics and Applied Probability, Volume 117
</p>


<h3>References</h3>

<p>Nikolai Chernov, 2014
Fitting ellipses, circles, and lines by least squares
<a href="http://people.cas.uab.edu/~mosya/cl/">http://people.cas.uab.edu/~mosya/cl/</a>
</p>
<p>Nikolai Chernov, 2010
Circular and linear regression: Fitting circles and lines by least squares
Chapman &amp; Hall/CRC, Monographs on Statistics and Applied Probability, Volume 117
</p>


<h3>Examples</h3>

<pre><code class='language-R'>xy&lt;-calculateCircle(0,0,200,50,randomDist=TRUE,noiseFun=function(x) (x+rnorm(1,mean=0,sd=50)))
plot(xy[,1],xy[,2],xlim=c(-250,250),ylim=c(-250,250));par(new=TRUE)
c3 &lt;- CircleFitByKasa(xy)
xyc3&lt;-calculateCircle(c3[1],c3[2],c3[3])
plot(xyc3[,1],xyc3[,2],xlim=c(-250,250),ylim=c(-250,250),col='green',type='l');par(new=TRUE)
</code></pre>

<hr>
<h2 id='CircleFitByLandau'>Geometric circle fit (minimizing orthogonal distances) by Landau 
algorithm</h2><span id='topic+CircleFitByLandau'></span>

<h3>Description</h3>

<p><code>CircleFitByLandau</code> applies the Geometric circle fit 
(minimizing orthogonal distances) by Landau algorithm </p>


<h3>Usage</h3>

<pre><code class='language-R'>CircleFitByLandau(XY,ParIni = NA, epsilon = 1e-06, IterMAX = 50)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CircleFitByLandau_+3A_xy">XY</code></td>
<td>
<p> array of sample data </p>
</td></tr>
<tr><td><code id="CircleFitByLandau_+3A_parini">ParIni</code></td>
<td>
<p> initial guess (a, b, R)</p>
</td></tr>
<tr><td><code id="CircleFitByLandau_+3A_epsilon">epsilon</code></td>
<td>
<p> tolerance (small threshold)  </p>
</td></tr>
<tr><td><code id="CircleFitByLandau_+3A_itermax">IterMAX</code></td>
<td>
<p> maximal number of iterations, with a bad initial guess it may
take &gt;100 iterations</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>vector(a</code>, <code>b</code>, <code>R)</code></td>
<td>
<p> vector with the values for the circle: center (a,b)
and radius R</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jose Gama</p>


<h3>Source</h3>

<p>Nikolai Chernov, 2014
Fitting ellipses, circles, and lines by least squares
<a href="http://people.cas.uab.edu/~mosya/cl/">http://people.cas.uab.edu/~mosya/cl/</a>
</p>
<p>Nikolai Chernov, 2010
Circular and linear regression: Fitting circles and lines by least squares
Chapman &amp; Hall/CRC, Monographs on Statistics and Applied Probability, Volume 117
</p>
<p>Geometric circle fit (minimizing orthogonal distances) by Landau algorithm
M. Landau, &quot;Estimation of a circular arc center and its radius&quot;,
Computer Vision, Graphics and Image Processing, Vol. 38, pages 317-326, (1987)
</p>


<h3>References</h3>

<p>Nikolai Chernov, 2014
Fitting ellipses, circles, and lines by least squares
<a href="http://people.cas.uab.edu/~mosya/cl/">http://people.cas.uab.edu/~mosya/cl/</a>
</p>
<p>Nikolai Chernov, 2010
Circular and linear regression: Fitting circles and lines by least squares
Chapman &amp; Hall/CRC, Monographs on Statistics and Applied Probability, Volume 117
</p>
<p>Geometric circle fit (minimizing orthogonal distances) by Landau algorithm
M. Landau, &quot;Estimation of a circular arc center and its radius&quot;,
Computer Vision, Graphics and Image Processing, Vol. 38, pages 317-326, (1987)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>xy&lt;-calculateCircle(0,0,200,50,randomDist=TRUE,noiseFun=function(x) (x+rnorm(1,mean=0,sd=50)))
plot(xy[,1],xy[,2],xlim=c(-250,250),ylim=c(-250,250));par(new=TRUE)
c6 &lt;- CircleFitByLandau(xy)
xyc6&lt;-calculateCircle(c6[1],c6[2],c6[3])
plot(xyc6[,1],xyc6[,2],xlim=c(-250,250),ylim=c(-250,250),col='purple',type='l');par(new=TRUE)
</code></pre>

<hr>
<h2 id='CircleFitByPratt'>Algebraic circle fit by Pratt</h2><span id='topic+CircleFitByPratt'></span>

<h3>Description</h3>

<p><code>CircleFitByPratt</code> applies the Algebraic circle fit by Pratt </p>


<h3>Usage</h3>

<pre><code class='language-R'>CircleFitByPratt(XY)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CircleFitByPratt_+3A_xy">XY</code></td>
<td>
<p> array of sample data </p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>vector(a</code>, <code>b</code>, <code>R)</code></td>
<td>
<p> vector with the values for the circle: center (a,b) 
and radius R</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jose Gama</p>


<h3>Source</h3>

<p>Nikolai Chernov, 2014
Fitting ellipses, circles, and lines by least squares
<a href="http://people.cas.uab.edu/~mosya/cl/">http://people.cas.uab.edu/~mosya/cl/</a>
</p>
<p>Nikolai Chernov, 2010
Circular and linear regression: Fitting circles and lines by least squares
Chapman &amp; Hall/CRC, Monographs on Statistics and Applied Probability, Volume 117
</p>


<h3>References</h3>

<p>Nikolai Chernov, 2014
Fitting ellipses, circles, and lines by least squares
<a href="http://people.cas.uab.edu/~mosya/cl/">http://people.cas.uab.edu/~mosya/cl/</a>
</p>
<p>Nikolai Chernov, 2010
Circular and linear regression: Fitting circles and lines by least squares
Chapman &amp; Hall/CRC, Monographs on Statistics and Applied Probability, Volume 117
</p>


<h3>Examples</h3>

<pre><code class='language-R'>xy&lt;-calculateCircle(0,0,200,50,randomDist=TRUE,noiseFun=function(x) (x+rnorm(1,mean=0,sd=50)))
plot(xy[,1],xy[,2],xlim=c(-250,250),ylim=c(-250,250));par(new=TRUE)
c2 &lt;- CircleFitByPratt(xy)
xyc2&lt;-calculateCircle(c2[1],c2[2],c2[3])
plot(xyc2[,1],xyc2[,2],xlim=c(-250,250),ylim=c(-250,250),col='blue',type='l');par(new=TRUE)
</code></pre>

<hr>
<h2 id='CircleFitBySpath'>Geometric circle fit by Spath</h2><span id='topic+CircleFitBySpath'></span>

<h3>Description</h3>

<p><code>CircleFitBySpath</code> applies the Geometric circle fit by Spath </p>


<h3>Usage</h3>

<pre><code class='language-R'>CircleFitBySpath(XY, ParIni = NA, epsilon = 1e-06, IterMAX = 50)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CircleFitBySpath_+3A_xy">XY</code></td>
<td>
<p> array of sample data </p>
</td></tr>
<tr><td><code id="CircleFitBySpath_+3A_parini">ParIni</code></td>
<td>
<p> initial guess (a, b, R) </p>
</td></tr>
<tr><td><code id="CircleFitBySpath_+3A_epsilon">epsilon</code></td>
<td>
<p> tolerance (small threshold)  </p>
</td></tr>
<tr><td><code id="CircleFitBySpath_+3A_itermax">IterMAX</code></td>
<td>
<p> maximal number of iterations, with a bad initial guess it may 
take &gt;100 iterations</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>vector(a</code>, <code>b</code>, <code>R)</code></td>
<td>
<p> vector with the values for the circle: center (a,b) 
and radius R</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jose Gama</p>


<h3>Source</h3>

<p>Nikolai Chernov, 2014
Fitting ellipses, circles, and lines by least squares
<a href="http://people.cas.uab.edu/~mosya/cl/">http://people.cas.uab.edu/~mosya/cl/</a>
</p>
<p>Nikolai Chernov, 2010
Circular and linear regression: Fitting circles and lines by least squares
Chapman &amp; Hall/CRC, Monographs on Statistics and Applied Probability, Volume 117
</p>


<h3>References</h3>

<p>Nikolai Chernov, 2014
Fitting ellipses, circles, and lines by least squares
<a href="http://people.cas.uab.edu/~mosya/cl/">http://people.cas.uab.edu/~mosya/cl/</a>
</p>
<p>Nikolai Chernov, 2010
Circular and linear regression: Fitting circles and lines by least squares
Chapman &amp; Hall/CRC, Monographs on Statistics and Applied Probability, Volume 117
</p>


<h3>Examples</h3>

<pre><code class='language-R'>xy&lt;-calculateCircle(0,0,200,50,randomDist=TRUE,noiseFun=function(x) (x+rnorm(1,mean=0,sd=50)))
plot(xy[,1],xy[,2],xlim=c(-250,250),ylim=c(-250,250));par(new=TRUE)
c5 &lt;- CircleFitBySpath(xy)
xyc5&lt;-calculateCircle(c5[1],c5[2],c5[3])
plot(xyc5[,1],xyc5[,2],xlim=c(-250,250),ylim=c(-250,250),col='magenta',type='l');par(new=TRUE)
</code></pre>

<hr>
<h2 id='CircleFitByTaubin'>Algebraic circle fit (Taubin method)</h2><span id='topic+CircleFitByTaubin'></span>

<h3>Description</h3>

<p><code>CircleFitByTaubin</code> applies the simple algebraic circle fit 
(Taubin method) </p>


<h3>Usage</h3>

<pre><code class='language-R'>CircleFitByTaubin(XY)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CircleFitByTaubin_+3A_xy">XY</code></td>
<td>
<p> array of sample data  </p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>vector(a</code>, <code>b</code>, <code>R)</code></td>
<td>
<p> vector with the values for the circle: center (a,b) 
and radius R</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jose Gama</p>


<h3>Source</h3>

<p>Nikolai Chernov, 2014
Fitting ellipses, circles, and lines by least squares
<a href="http://people.cas.uab.edu/~mosya/cl/">http://people.cas.uab.edu/~mosya/cl/</a>
</p>
<p>Nikolai Chernov, 2010
Circular and linear regression: Fitting circles and lines by least squares
Chapman &amp; Hall/CRC, Monographs on Statistics and Applied Probability, Volume 117
</p>


<h3>References</h3>

<p>Nikolai Chernov, 2014
Fitting ellipses, circles, and lines by least squares
<a href="http://people.cas.uab.edu/~mosya/cl/">http://people.cas.uab.edu/~mosya/cl/</a>
</p>
<p>Nikolai Chernov, 2010
Circular and linear regression: Fitting circles and lines by least squares
Chapman &amp; Hall/CRC, Monographs on Statistics and Applied Probability, Volume 117
</p>


<h3>Examples</h3>

<pre><code class='language-R'>xy&lt;-calculateCircle(0,0,200,50,randomDist=TRUE,noiseFun=function(x) (x+rnorm(1,mean=0,sd=50)))
plot(xy[,1],xy[,2],xlim=c(-250,250),ylim=c(-250,250));par(new=TRUE)
c1 &lt;- CircleFitByTaubin(xy)
xyc1&lt;-calculateCircle(c1[1],c1[2],c1[3])
plot(xyc1[,1],xyc1[,2],xlim=c(-250,250),ylim=c(-250,250),col='red',type='l');par(new=TRUE)
</code></pre>

<hr>
<h2 id='CurrentIteration'>Internal conicfit functions</h2><span id='topic+CurrentIteration'></span><span id='topic+CurrentIterationReduced'></span>

<h3>Description</h3>

<p>Ignore these.</p>

<hr>
<h2 id='EllipseDirectFit'> Algebraic ellipse fit method by Fitzgibbon-Pilu-Fisher</h2><span id='topic+EllipseDirectFit'></span>

<h3>Description</h3>

<p><code>EllipseDirectFit</code> applies the algebraic ellipse fit method 
by Fitzgibbon-Pilu-Fisher </p>


<h3>Usage</h3>

<pre><code class='language-R'>EllipseDirectFit(XY)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="EllipseDirectFit_+3A_xy">XY</code></td>
<td>
<p> array of sample data </p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>vector(A</code>, <code>B</code>, <code>C</code>, <code>D</code>, <code>E</code>, <code>F)</code></td>
<td>
<p> vector of algebraic parameters of the fitting 
ellipse: ax^2 + bxy + cy^2 +dx + ey + f = 0</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jose Gama</p>


<h3>Source</h3>

<p>Nikolai Chernov, 2014
Fitting ellipses, circles, and lines by least squares
<a href="http://people.cas.uab.edu/~mosya/cl/">http://people.cas.uab.edu/~mosya/cl/</a>
</p>
<p>A. W. Fitzgibbon, M. Pilu, R. B. Fisher, 1999
Direct Least Squares Fitting of Ellipses
IEEE Trans. PAMI, Vol. 21, pages 476-480
</p>
<p>A. W. Fitzgibbon, M. Pilu, R. B. Fisher, &quot;Direct Least Squares Fitting of 
Ellipses&quot;, IEEE Trans. PAMI, Vol. 21, pages 476-480 (1999)
Halir R, Flusser J (1998) Proceedings of the 6th International Conference 
in Central Europe on Computer Graphics and Visualization, 
Numerically stable direct least squares fitting of ellipses (WSCG, Plzen, 
Czech Republic), pp 125–132.
</p>


<h3>References</h3>

<p>Nikolai Chernov, 2014
Fitting ellipses, circles, and lines by least squares
<a href="http://people.cas.uab.edu/~mosya/cl/">http://people.cas.uab.edu/~mosya/cl/</a>
</p>
<p>A. W. Fitzgibbon, M. Pilu, R. B. Fisher, 1999
Direct Least Squares Fitting of Ellipses
IEEE Trans. PAMI, Vol. 21, pages 476-480
</p>
<p>A. W. Fitzgibbon, M. Pilu, R. B. Fisher, &quot;Direct Least Squares Fitting of 
Ellipses&quot;, IEEE Trans. PAMI, Vol. 21, pages 476-480 (1999)
Halir R, Flusser J (1998) Proceedings of the 6th International Conference 
in Central Europe on Computer Graphics and Visualization, 
Numerically stable direct least squares fitting of ellipses (WSCG, Plzen, 
Czech Republic), pp 125–132.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>xy&lt;-calculateEllipse(0,0,200,100,45,50, randomDist=TRUE,noiseFun=function(x) 
(x+rnorm(1,mean=0,sd=50)))
plot(xy[,1],xy[,2],xlim=c(-250,250),ylim=c(-250,250),col='magenta');par(new=TRUE)

ellipDirect &lt;- EllipseDirectFit(xy)
ellipDirectG &lt;- AtoG(ellipDirect)$ParG
xyDirect&lt;-calculateEllipse(ellipDirectG[1], ellipDirectG[2], ellipDirectG[3], 
ellipDirectG[4], 180/pi*ellipDirectG[5])
plot(xyDirect[,1],xyDirect[,2],xlim=c(-250,250),ylim=c(-250,250),type='l',
col='cyan');par(new=TRUE)
</code></pre>

<hr>
<h2 id='EllipseFitByTaubin'>Algebraic ellipse fit by Taubin</h2><span id='topic+EllipseFitByTaubin'></span>

<h3>Description</h3>

<p><code>EllipseFitByTaubin</code> applies the Algebraic ellipse fit by
Taubin </p>


<h3>Usage</h3>

<pre><code class='language-R'>EllipseFitByTaubin(XY)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="EllipseFitByTaubin_+3A_xy">XY</code></td>
<td>
<p> array of sample data </p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>vector(A</code>, <code>B</code>, <code>C</code>, <code>D</code>, <code>E</code>, <code>F)</code></td>
<td>
<p> vector with the values for the ellipse </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jose Gama</p>


<h3>Source</h3>

<p>Nikolai Chernov, 2014
Fitting ellipses, circles, and lines by least squares
<a href="http://people.cas.uab.edu/~mosya/cl/">http://people.cas.uab.edu/~mosya/cl/</a>
</p>
<p>Nikolai Chernov, 2010
Circular and linear regression: Fitting circles and lines by least squares
Chapman &amp; Hall/CRC, Monographs on Statistics and Applied Probability, Volume 117
</p>


<h3>References</h3>

<p>Nikolai Chernov, 2014
Fitting ellipses, circles, and lines by least squares
<a href="http://people.cas.uab.edu/~mosya/cl/">http://people.cas.uab.edu/~mosya/cl/</a>
</p>
<p>Nikolai Chernov, 2010
Circular and linear regression: Fitting circles and lines by least squares
Chapman &amp; Hall/CRC, Monographs on Statistics and Applied Probability, Volume 117
</p>


<h3>Examples</h3>

<pre><code class='language-R'>xy&lt;-calculateEllipse(0,0,200,100,45,50, randomDist=TRUE,noiseFun=function(x) 
(x+rnorm(1,mean=0,sd=50)))
plot(xy[,1],xy[,2],xlim=c(-250,250),ylim=c(-250,250),col='magenta');par(new=TRUE)

ellipTaubin &lt;- EllipseFitByTaubin(xy)
ellipTaubinG &lt;- AtoG(ellipTaubin)$ParG
xyTaubin&lt;-calculateEllipse(ellipTaubinG[1], ellipTaubinG[2], ellipTaubinG[3], 
ellipTaubinG[4], 180/pi*ellipTaubinG[5])
plot(xyTaubin[,1],xyTaubin[,2],xlim=c(-250,250),ylim=c(-250,250),type='l',
col='red');par(new=TRUE)

</code></pre>

<hr>
<h2 id='ellipticity'>Formulas for the ellipse</h2><span id='topic+ellipticity'></span><span id='topic+ellipseEccentricity'></span><span id='topic+ellipseFocus'></span><span id='topic+ellipseRa'></span><span id='topic+ellipseRp'></span><span id='topic+ellipse.l'></span>

<h3>Description</h3>

<p><code>ellipticity</code> ellipticity = flattening factor
<code>ellipseEccentricity</code> eccentricity of the ellipse
<code>ellipseFocus</code> focus of the ellipse
<code>ellipseRa</code> radius at apoapsis (the farthest distance)
<code>ellipseRp</code> radius at periapsis (the closest distance)
<code>ellipse.l</code> semi-latus rectum l
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ellipticity(minorAxis,majorAxis)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ellipticity_+3A_minoraxis">minorAxis</code></td>
<td>
<p> minor ellipse axis</p>
</td></tr>
<tr><td><code id="ellipticity_+3A_majoraxis">majorAxis</code></td>
<td>
<p> major ellipse axis</p>
</td></tr>
</table>


<h3>Value</h3>

<p>scalar result
</p>


<h3>Author(s)</h3>

<p>Jose Gama</p>


<h3>Source</h3>

<p>Wikipedia
Ellipse
<a href="http://en.wikipedia.org/wiki/Ellipse#Mathematical_definitions_and_properties">http://en.wikipedia.org/wiki/Ellipse#Mathematical_definitions_and_properties</a>
</p>


<h3>References</h3>

<p>Wikipedia
Ellipse
<a href="http://en.wikipedia.org/wiki/Ellipse#Mathematical_definitions_and_properties">http://en.wikipedia.org/wiki/Ellipse#Mathematical_definitions_and_properties</a>
</p>

<hr>
<h2 id='estimateInitialGuessCircle'>Estimate Initial Guess Circle values</h2><span id='topic+estimateInitialGuessCircle'></span>

<h3>Description</h3>

<p><code>estimateInitialGuessCircle</code> estimates initial guess values 
for the center and radius of the circle</p>


<h3>Usage</h3>

<pre><code class='language-R'>estimateInitialGuessCircle(XY)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estimateInitialGuessCircle_+3A_xy">XY</code></td>
<td>
<p> array of sample data </p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>vector(a</code>, <code>b</code>, <code>R)</code></td>
<td>
<p> vector with the estimates for the circle: center (a,b)
and radius R</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jose Gama</p>


<h3>Examples</h3>

<pre><code class='language-R'>xy&lt;-calculateCircle(0,0,200,50,randomDist=TRUE,noiseFun=function(x) (x+rnorm(1,mean=0,sd=50)))
estimateInitialGuessCircle(xy)
</code></pre>

<hr>
<h2 id='fit.conicLMA'>Fitting a conic to a given set of points (Implicit method)</h2><span id='topic+fit.conicLMA'></span>

<h3>Description</h3>

<p><code>fit.conicLMA</code> fits a conic to a given set of points 
(Implicit method) using algebraic parameters. Conic:  Ax^2 + Bxy + Cy^2 +Dx + Ey + F = 0</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit.conicLMA(XY, ParAini, LambdaIni, epsilonP = 1e-10, epsilonF = 1e-13,
IterMAX = 2e+06)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit.conicLMA_+3A_xy">XY</code></td>
<td>
<p> array of sample data</p>
</td></tr>
<tr><td><code id="fit.conicLMA_+3A_paraini">ParAini</code></td>
<td>
<p> initial parameter vector c(A,B,C,D,E,F)</p>
</td></tr>
<tr><td><code id="fit.conicLMA_+3A_lambdaini">LambdaIni</code></td>
<td>
<p> initial value of the control parameter Lambda</p>
</td></tr>
<tr><td><code id="fit.conicLMA_+3A_epsilonp">epsilonP</code></td>
<td>
<p> tolerance (small threshold)</p>
</td></tr>
<tr><td><code id="fit.conicLMA_+3A_epsilonf">epsilonF</code></td>
<td>
<p> tolerance (small threshold)</p>
</td></tr>
<tr><td><code id="fit.conicLMA_+3A_itermax">IterMAX</code></td>
<td>
<p> maximum number of (main) iterations, usually 10-20 will suffice</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>list(ParA</code>, <code>RSS</code>, <code>iters</code></td>
<td>
<p> list with algebraic parameters (Center(1:2),
Axes(1:2), Angle), Residual Sum of Squares and number of iterations</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jose Gama</p>


<h3>Source</h3>

<p>Nikolai Chernov, 2014
Fitting ellipses, circles, and lines by least squares
<a href="http://people.cas.uab.edu/~mosya/cl/">http://people.cas.uab.edu/~mosya/cl/</a>
</p>
<p>N. Chernov, Q. Huang, and H. Ma, 2014
Fitting quadratic curves to data points
British Journal of Mathematics &amp; Computer Science, 4, 33-60.
</p>
<p>N. Chernov and H. Ma, 2011
Least squares fitting of quadratic curves and surfaces
In: Computer Vision, Editor S. R. Yoshida, Nova Science Publishers; pp. 285-302.
</p>


<h3>References</h3>

<p>Nikolai Chernov, 2014
Fitting ellipses, circles, and lines by least squares
<a href="http://people.cas.uab.edu/~mosya/cl/">http://people.cas.uab.edu/~mosya/cl/</a>
</p>
<p>N. Chernov, Q. Huang, and H. Ma, 2014
Fitting quadratic curves to data points
British Journal of Mathematics &amp; Computer Science, 4, 33-60.
</p>
<p>N. Chernov and H. Ma, 2011
Least squares fitting of quadratic curves and surfaces
In: Computer Vision, Editor S. R. Yoshida, Nova Science Publishers; pp. 285-302.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>XY &lt;- matrix(c(1,7,2,6,5,8,7,7,9,5,3,7,6,2,8,4),8,2,byrow=TRUE)
ParAini &lt;- matrix(c(0.2500,0, 1.0000, 0, 0, -1.0000),ncol=1)
LambdaIni=0.1
fit.conicLMA(XY,ParAini,LambdaIni)
</code></pre>

<hr>
<h2 id='fit.ellipseLMG'>Fitting an ellipse using Implicit method</h2><span id='topic+fit.ellipseLMG'></span><span id='topic+fit.ellipseLMG.H'></span>

<h3>Description</h3>

<p><code>fit.ellipseLMG</code> Fits an ellipse to a given set of points 
(Implicit method) using geometric parameters. Conic: </p>


<h3>Usage</h3>

<pre><code class='language-R'>fit.ellipseLMG(XY,ParGini,LambdaIni = 1, epsilon = 1e-06, IterMAX = 200,
L = 200)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit.ellipseLMG_+3A_xy">XY</code></td>
<td>
<p> array of sample data</p>
</td></tr>
<tr><td><code id="fit.ellipseLMG_+3A_pargini">ParGini</code></td>
<td>
<p> initial parameter vector c(Center(1:2), Axes(1:2), Angle)</p>
</td></tr>
<tr><td><code id="fit.ellipseLMG_+3A_lambdaini">LambdaIni</code></td>
<td>
<p> initial value of the control parameter Lambda</p>
</td></tr>
<tr><td><code id="fit.ellipseLMG_+3A_epsilon">epsilon</code></td>
<td>
<p> tolerance (small threshold)</p>
</td></tr>
<tr><td><code id="fit.ellipseLMG_+3A_itermax">IterMAX</code></td>
<td>
<p> maximum number of (main) iterations, usually 10-20 will suffice</p>
</td></tr>
<tr><td><code id="fit.ellipseLMG_+3A_l">L</code></td>
<td>
<p> boundary for major/minor axis</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>list(ParG</code>, <code>RSS</code>, <code>iters</code>, <code>TF)</code></td>
<td>
<p> list with geometric parameters (A,B,C,D,E,F),
Residual Sum of Squares, number of iterations and TF==TRUE if the method diverges</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jose Gama</p>


<h3>Source</h3>

<p>Nikolai Chernov, 2014
Fitting ellipses, circles, and lines by least squares
<a href="http://people.cas.uab.edu/~mosya/cl/">http://people.cas.uab.edu/~mosya/cl/</a>
</p>
<p>N. Chernov, Q. Huang, and H. Ma, 2014
Fitting quadratic curves to data points
British Journal of Mathematics &amp; Computer Science, 4, 33-60.
</p>
<p>N. Chernov and H. Ma, 2011
Least squares fitting of quadratic curves and surfaces
In: Computer Vision, Editor S. R. Yoshida, Nova Science Publishers; pp. 285-302.
</p>


<h3>References</h3>

<p>Nikolai Chernov, 2014
Fitting ellipses, circles, and lines by least squares
<a href="http://people.cas.uab.edu/~mosya/cl/">http://people.cas.uab.edu/~mosya/cl/</a>
</p>
<p>N. Chernov, Q. Huang, and H. Ma, 2014
Fitting quadratic curves to data points
British Journal of Mathematics &amp; Computer Science, 4, 33-60.
</p>
<p>N. Chernov and H. Ma, 2011
Least squares fitting of quadratic curves and surfaces
In: Computer Vision, Editor S. R. Yoshida, Nova Science Publishers; pp. 285-302.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>XY &lt;- matrix(c(1,7,2,6,5,8,7,7,9,5,3,7,6,2,8,4),8,2,byrow=TRUE)
ParGini &lt;- matrix(c(0,0,2,1,0),ncol=1)
LambdaIni=0.1
fit.ellipseLMG(XY,ParGini,LambdaIni)
</code></pre>

<hr>
<h2 id='fitbookstein'> Linear ellipse fit using bookstein constraint</h2><span id='topic+fitbookstein'></span><span id='topic+conic2parametric'></span><span id='topic+fitggk'></span>

<h3>Description</h3>

<p><code>fitbookstein</code> Linear ellipse fit using bookstein constraint 
</p>
<p><code>conic2parametric</code> Diagonalise A - find Q, D such at A = Q' * D * Q 
</p>
<p><code>fitggk</code> Linear least squares with the Euclidean-invariant constraint Trace(A) = 1 </p>


<h3>Usage</h3>

<pre><code class='language-R'>fitbookstein(x)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitbookstein_+3A_x">x</code></td>
<td>
<p> array of sample data </p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>list(z</code>, <code>a</code>, <code>b</code>, <code>alpha)</code></td>
<td>
<p> list with fitted ellipse parameters </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jose Gama</p>


<h3>Source</h3>

<p>Richard Brown, May 28, 2007
<a href="http://www.mathworks.com/matlabcentral/fileexchange/15125-fitellipse-m/content/demo/html/ellipsedemo.html">http://www.mathworks.com/matlabcentral/fileexchange/15125-fitellipse-m/content/demo/html/ellipsedemo.html</a>
</p>


<h3>References</h3>

<p>Richard Brown, May 28, 2007
<a href="http://www.mathworks.com/matlabcentral/fileexchange/15125-fitellipse-m/content/demo/html/ellipsedemo.html">http://www.mathworks.com/matlabcentral/fileexchange/15125-fitellipse-m/content/demo/html/ellipsedemo.html</a>
</p>
<p>W. Gander, G. H. Golub, R. Strebel, 1994
Least-Squares Fitting of Circles and Ellipses
BIT Numerical Mathematics, Springer 
</p>

<hr>
<h2 id='GtoA'>Conversion of geometric parameters to algebraic parameters</h2><span id='topic+GtoA'></span>

<h3>Description</h3>

<p><code>GtoA</code> converts geometric parameters (A, B, C, D, E, F) to 
algebraic parameters (Center(1:2), Axes(1:2), Angle).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GtoA(ParG)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GtoA_+3A_parg">ParG</code></td>
<td>
<p> list with geometric parameters (A, B, C, D, E, F)</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>ParA</code></td>
<td>
<p> vector or array with algebraic parameters (Center(1:2), 
Axes(1:2), Angle)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jose Gama</p>


<h3>Source</h3>

<p>Nikolai Chernov, 2014
Fitting ellipses, circles, and lines by least squares
<a href="http://people.cas.uab.edu/~mosya/cl/">http://people.cas.uab.edu/~mosya/cl/</a>
</p>
<p>Nikolai Chernov, 2010
Circular and linear regression: Fitting circles and lines by least squares
Chapman &amp; Hall/CRC, Monographs on Statistics and Applied Probability, Volume 117
</p>


<h3>References</h3>

<p>Nikolai Chernov, 2014
Fitting ellipses, circles, and lines by least squares
<a href="http://people.cas.uab.edu/~mosya/cl/">http://people.cas.uab.edu/~mosya/cl/</a>
</p>
<p>Nikolai Chernov, 2010
Circular and linear regression: Fitting circles and lines by least squares
Chapman &amp; Hall/CRC, Monographs on Statistics and Applied Probability, Volume 117
</p>


<h3>Examples</h3>

<pre><code class='language-R'>GtoA(c(0,0,20,60,45))
</code></pre>

<hr>
<h2 id='JmatrixLMA'>Compute the Jacobian matrix using algebraic parameters</h2><span id='topic+JmatrixLMA'></span>

<h3>Description</h3>

<p><code>JmatrixLMA</code> Computes the Jacobian matrix(Implicit method) 
using algebraic parameters </p>


<h3>Usage</h3>

<pre><code class='language-R'>JmatrixLMA(XY,ParA,XYproj)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="JmatrixLMA_+3A_xy">XY</code></td>
<td>
<p> array of sample data</p>
</td></tr>
<tr><td><code id="JmatrixLMA_+3A_para">ParA</code></td>
<td>
<p> initial parameter vector c(Center(1:2), Axes(1:2), Angle)</p>
</td></tr>
<tr><td><code id="JmatrixLMA_+3A_xyproj">XYproj</code></td>
<td>
<p> corresponding n projection points on the conic</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>list(Res</code>, <code>J)</code></td>
<td>
<p> list with the Residual Sum of Squares and the Jacobian
matrix</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jose Gama</p>


<h3>Source</h3>

<p>Nikolai Chernov, 2014
Fitting ellipses, circles, and lines by least squares
<a href="http://people.cas.uab.edu/~mosya/cl/">http://people.cas.uab.edu/~mosya/cl/</a>
</p>
<p>Nikolai Chernov, 2010
Circular and linear regression: Fitting circles and lines by least squares
Chapman &amp; Hall/CRC, Monographs on Statistics and Applied Probability, Volume 117
</p>


<h3>References</h3>

<p>Nikolai Chernov, 2014
Fitting ellipses, circles, and lines by least squares
<a href="http://people.cas.uab.edu/~mosya/cl/">http://people.cas.uab.edu/~mosya/cl/</a>
</p>
<p>Nikolai Chernov, 2010
Circular and linear regression: Fitting circles and lines by least squares
Chapman &amp; Hall/CRC, Monographs on Statistics and Applied Probability, Volume 117
</p>


<h3>Examples</h3>

<pre><code class='language-R'>XY &lt;- matrix(c(1,7,2,6,5,8,7,7,9,5,3,7,6,2,8,4),8,2,byrow=TRUE)
ParA &lt;- matrix(c(0.250000000000000,0,1,0,0,-1),ncol=1)
XYproj=matrix(c(0.394467220216675,0.980356518335872,0.833315950425981,
0.909063326557293,1.40466123643977,0.711850899213363,
1.70601340510202,0.521899957274429,1.89925244997324,0.313384799914835,
1.06482258038841,0.846485805004280,1.95308457257492,
0.215325713960169,1.91319150256275,0.291418202297698),8,2,byrow=TRUE)
JmatrixLMA(XY,ParA,XYproj)
</code></pre>

<hr>
<h2 id='JmatrixLMG'>Compute the Jacobian matrix using geometric parameters</h2><span id='topic+JmatrixLMG'></span>

<h3>Description</h3>

<p><code>JmatrixLMG</code> Computes the Jacobian matrix (Implicit method)
using geometric parameters </p>


<h3>Usage</h3>

<pre><code class='language-R'>JmatrixLMG(XY,A,XYproj)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="JmatrixLMG_+3A_xy">XY</code></td>
<td>
<p> array of sample data</p>
</td></tr>
<tr><td><code id="JmatrixLMG_+3A_a">A</code></td>
<td>
<p> initial parameter vector c(Xc,Yc,a,b,alpha)</p>
</td></tr>
<tr><td><code id="JmatrixLMG_+3A_xyproj">XYproj</code></td>
<td>
<p> corresponding n projection points on the conic</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>list(Res</code>, <code>J)</code></td>
<td>
<p> list with the Residual Sum of Squares and the Jacobian
matrix</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jose Gama</p>


<h3>Source</h3>

<p>Nikolai Chernov, 2014
Fitting ellipses, circles, and lines by least squares
<a href="http://people.cas.uab.edu/~mosya/cl/">http://people.cas.uab.edu/~mosya/cl/</a>
</p>
<p>Nikolai Chernov, 2010
Circular and linear regression: Fitting circles and lines by least squares
Chapman &amp; Hall/CRC, Monographs on Statistics and Applied Probability, Volume 117
</p>


<h3>References</h3>

<p>Nikolai Chernov, 2014
Fitting ellipses, circles, and lines by least squares
<a href="http://people.cas.uab.edu/~mosya/cl/">http://people.cas.uab.edu/~mosya/cl/</a>
</p>
<p>Nikolai Chernov, 2010
Circular and linear regression: Fitting circles and lines by least squares
Chapman &amp; Hall/CRC, Monographs on Statistics and Applied Probability, Volume 117
</p>


<h3>Examples</h3>

<pre><code class='language-R'>XY &lt;- matrix(c(1,7,2,6,5,8,7,7,9,5,3,7,6,2,8,4),8,2,byrow=TRUE)
A &lt;- matrix(c(0,0,2,1,0),ncol=1)
XYproj=matrix(c(0.394467220216675,0.980356518335872,0.833315950425981,
0.909063326557293,1.40466123643977,0.711850899213363,
1.70601340510202,0.521899957274429,1.89925244997324,0.313384799914835,
1.06482258038841,0.846485805004280,1.95308457257492,
0.215325713960169,1.91319150256275,0.291418202297698),8,2,byrow=TRUE)
JmatrixLMG(XY,A,XYproj)
</code></pre>

<hr>
<h2 id='LMcircleFit'>Geometric circle fit (minimizing orthogonal distances) based on the
Levenberg-Marquardt method</h2><span id='topic+LMcircleFit'></span>

<h3>Description</h3>

<p><code>LMcircleFit</code> applies a Geometric circle fit (minimizing 
orthogonal distances) based on the standard Levenberg-Marquardt scheme </p>


<h3>Usage</h3>

<pre><code class='language-R'>LMcircleFit(XY, ParIni, LambdaIni = 1, epsilon = 1e-06, IterMAX = 50)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LMcircleFit_+3A_xy">XY</code></td>
<td>
<p> array of sample data </p>
</td></tr>
<tr><td><code id="LMcircleFit_+3A_parini">ParIni</code></td>
<td>
<p> initial guess (a, b, R) </p>
</td></tr>
<tr><td><code id="LMcircleFit_+3A_lambdaini">LambdaIni</code></td>
<td>
<p> initial value for the correction factor lambda </p>
</td></tr>
<tr><td><code id="LMcircleFit_+3A_epsilon">epsilon</code></td>
<td>
<p> tolerance (small threshold)</p>
</td></tr>
<tr><td><code id="LMcircleFit_+3A_itermax">IterMAX</code></td>
<td>
<p> maximum number of (main) iterations, usually 10-20 will suffice</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>vector(a</code>, <code>b</code>, <code>R)</code></td>
<td>
<p> vector with the estimates for the circle: center (a,b)
and radius R</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jose Gama</p>


<h3>Source</h3>

<p>Nikolai Chernov, 2014
Fitting ellipses, circles, and lines by least squares
<a href="http://people.cas.uab.edu/~mosya/cl/">http://people.cas.uab.edu/~mosya/cl/</a>
</p>
<p>Nikolai Chernov, 2010
Circular and linear regression: Fitting circles and lines by least squares
Chapman &amp; Hall/CRC, Monographs on Statistics and Applied Probability, Volume 117
</p>


<h3>References</h3>

<p>Nikolai Chernov, 2014
Fitting ellipses, circles, and lines by least squares
<a href="http://people.cas.uab.edu/~mosya/cl/">http://people.cas.uab.edu/~mosya/cl/</a>
</p>
<p>Nikolai Chernov, 2010
Circular and linear regression: Fitting circles and lines by least squares
Chapman &amp; Hall/CRC, Monographs on Statistics and Applied Probability, Volume 117
</p>


<h3>Examples</h3>

<pre><code class='language-R'>xy&lt;-calculateCircle(0,0,200,50,randomDist=TRUE,noiseFun=function(x) (x+rnorm(1,mean=0,sd=50)))
plot(xy[,1],xy[,2],xlim=c(-250,250),ylim=c(-250,250));par(new=TRUE)
c4 &lt;- LMcircleFit(xy)
xyc4&lt;-calculateCircle(c4[1],c4[2],c4[3])
plot(xyc4[,1],xyc4[,2],xlim=c(-250,250),ylim=c(-250,250),col='cyan',type='l')
</code></pre>

<hr>
<h2 id='LMreducedCircleFit'>Geometric circle fit (minimizing orthogonal distances) based on the 
Levenberg-Marquardt method</h2><span id='topic+LMreducedCircleFit'></span>

<h3>Description</h3>

<p><code>LMreducedCircleFit</code> applies a Geometric circle fit 
(minimizing orthogonal distances) based on the standard Levenberg-Marquardt scheme in the &quot;reduced&quot; (a,b) parameter space </p>


<h3>Usage</h3>

<pre><code class='language-R'>LMreducedCircleFit(XY, ParIni, LambdaIni = 1, epsilon = 1e-06, 
IterMAX = 50)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LMreducedCircleFit_+3A_xy">XY</code></td>
<td>
<p> array of sample data </p>
</td></tr>
<tr><td><code id="LMreducedCircleFit_+3A_parini">ParIni</code></td>
<td>
<p> initial guess (a, b) </p>
</td></tr>
<tr><td><code id="LMreducedCircleFit_+3A_lambdaini">LambdaIni</code></td>
<td>
<p> initial value for the correction factor lambda </p>
</td></tr>
<tr><td><code id="LMreducedCircleFit_+3A_epsilon">epsilon</code></td>
<td>
<p> tolerance (small threshold)</p>
</td></tr>
<tr><td><code id="LMreducedCircleFit_+3A_itermax">IterMAX</code></td>
<td>
<p> maximum number of (main) iterations, usually 10-20 will suffice</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>vector(a</code>, <code>b</code>, <code>R)</code></td>
<td>
<p> vector with the estimates for the circle: center (a,b)
and radius R</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jose Gama</p>


<h3>Source</h3>

<p>Nikolai Chernov, 2014
Fitting ellipses, circles, and lines by least squares
<a href="http://people.cas.uab.edu/~mosya/cl/">http://people.cas.uab.edu/~mosya/cl/</a>
</p>
<p>Nikolai Chernov, 2010
Circular and linear regression: Fitting circles and lines by least squares
Chapman &amp; Hall/CRC, Monographs on Statistics and Applied Probability, Volume 117
</p>


<h3>References</h3>

<p>Nikolai Chernov, 2014
Fitting ellipses, circles, and lines by least squares
<a href="http://people.cas.uab.edu/~mosya/cl/">http://people.cas.uab.edu/~mosya/cl/</a>
</p>
<p>Nikolai Chernov, 2010
Circular and linear regression: Fitting circles and lines by least squares
Chapman &amp; Hall/CRC, Monographs on Statistics and Applied Probability, Volume 117
</p>


<h3>Examples</h3>

<pre><code class='language-R'>xy&lt;-calculateCircle(0,0,200,50,randomDist=TRUE,noiseFun=function(x) (x+rnorm(1,mean=0,sd=50)))
plot(xy[,1],xy[,2],xlim=c(-250,250),ylim=c(-250,250));par(new=TRUE)
c7 &lt;- LMreducedCircleFit(xy)
xyc7&lt;-calculateCircle(c7[1],c7[2],c7[3])
plot(xyc7[,1],xyc7[,2],xlim=c(-250,250),ylim=c(-250,250),col='pink',type='l')
</code></pre>

<hr>
<h2 id='Residuals.ellipse'>Projecting a given set of points onto an ellipse</h2><span id='topic+Residuals.ellipse'></span>

<h3>Description</h3>

<p><code>Residuals.ellipse</code> projects a given set of points onto an 
ellipse and computing the distances from the points to the ellipse </p>


<h3>Usage</h3>

<pre><code class='language-R'>Residuals.ellipse(XY,ParG)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Residuals.ellipse_+3A_xy">XY</code></td>
<td>
<p> array of sample data  </p>
</td></tr>
<tr><td><code id="Residuals.ellipse_+3A_parg">ParG</code></td>
<td>
<p> vector 5x1 of the ellipse parameters (Center(1:2), Axes(1:2),
Angle) </p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>list(Res</code>, <code>J)</code></td>
<td>
<p> list with the Residual Sum of Squares and the Jacobian 
matrix</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jose Gama</p>


<h3>Source</h3>

<p>Nikolai Chernov, 2014
Fitting ellipses, circles, and lines by least squares
<a href="http://people.cas.uab.edu/~mosya/cl/">http://people.cas.uab.edu/~mosya/cl/</a>
</p>
<p>N. Chernov, Q. Huang, and H. Ma, 2014
Fitting quadratic curves to data points
British Journal of Mathematics &amp; Computer Science, 4, 33-60.
</p>


<h3>References</h3>

<p>Nikolai Chernov, 2014
Fitting ellipses, circles, and lines by least squares
<a href="http://people.cas.uab.edu/~mosya/cl/">http://people.cas.uab.edu/~mosya/cl/</a>
</p>
<p>N. Chernov, Q. Huang, and H. Ma, 2014
Fitting quadratic curves to data points
British Journal of Mathematics &amp; Computer Science, 4, 33-60.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>XY &lt;- matrix(c(1,7,2,6,5,8,7,7,9,5,3,7,6,2,8,4),8,2,byrow=TRUE)
ParG &lt;- matrix(c(0,0,2,1,0),ncol=1)
Residuals.ellipse(XY,ParG)</code></pre>

<hr>
<h2 id='Residuals.hyperbola'>Projecting a given set of points onto an hyperbola</h2><span id='topic+Residuals.hyperbola'></span>

<h3>Description</h3>

<p><code>Residuals.hyperbola</code> projects a given set of points onto an
hyperbola and computing the distances from the points to the hyperbola </p>


<h3>Usage</h3>

<pre><code class='language-R'>Residuals.hyperbola(XY,ParG)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Residuals.hyperbola_+3A_xy">XY</code></td>
<td>
<p> array of sample data  </p>
</td></tr>
<tr><td><code id="Residuals.hyperbola_+3A_parg">ParG</code></td>
<td>
<p> vector 5x1 of the hyperbola parameters (Center(1:2), Axes(1:2), 
Angle) </p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>list(RSS</code>, <code>XYproj)</code></td>
<td>
<p> list with the Residual Sum of Squares and the array
of coordinates of projections</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jose Gama</p>


<h3>Source</h3>

<p>Nikolai Chernov, 2014
Fitting ellipses, circles, and lines by least squares
<a href="http://people.cas.uab.edu/~mosya/cl/">http://people.cas.uab.edu/~mosya/cl/</a>
</p>
<p>N. Chernov, Q. Huang, and H. Ma, 2014
Fitting quadratic curves to data points
British Journal of Mathematics &amp; Computer Science, 4, 33-60.
</p>


<h3>References</h3>

<p>Nikolai Chernov, 2014
Fitting ellipses, circles, and lines by least squares
<a href="http://people.cas.uab.edu/~mosya/cl/">http://people.cas.uab.edu/~mosya/cl/</a>
</p>
<p>N. Chernov, Q. Huang, and H. Ma, 2014
Fitting quadratic curves to data points
British Journal of Mathematics &amp; Computer Science, 4, 33-60.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>XY &lt;- matrix(c(1,7,2,6,5,8,7,7,9,5,3,7,6,2,8,4),8,2,byrow=TRUE)
ParG &lt;- matrix(c(0,0,2,1,0),ncol=1)
Residuals.hyperbola(XY,ParG)</code></pre>

<hr>
<h2 id='Residuals.parabola'>Projecting a given set of points onto an parabola</h2><span id='topic+Residuals.parabola'></span>

<h3>Description</h3>

<p><code>Residuals.parabola</code> projects a given set of points onto an 
parabola and computing the distances from the points to the parabola </p>


<h3>Usage</h3>

<pre><code class='language-R'>Residuals.parabola(XY,ParG)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Residuals.parabola_+3A_xy">XY</code></td>
<td>
<p> array of sample data  </p>
</td></tr>
<tr><td><code id="Residuals.parabola_+3A_parg">ParG</code></td>
<td>
<p> vector 4x1 of the parabola parameters (Vertex(1:2), p, Angle) </p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>list(RSS</code>, <code>XYproj)</code></td>
<td>
<p> list with the Residual Sum of Squares and the array
of coordinates of projections</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jose Gama</p>


<h3>Source</h3>

<p>Nikolai Chernov, 2014
Fitting ellipses, circles, and lines by least squares
<a href="http://people.cas.uab.edu/~mosya/cl/">http://people.cas.uab.edu/~mosya/cl/</a>
</p>
<p>N. Chernov, Q. Huang, and H. Ma, 2014
Fitting quadratic curves to data points
British Journal of Mathematics &amp; Computer Science, 4, 33-60.
</p>


<h3>References</h3>

<p>Nikolai Chernov, 2014
Fitting ellipses, circles, and lines by least squares
<a href="http://people.cas.uab.edu/~mosya/cl/">http://people.cas.uab.edu/~mosya/cl/</a>
</p>
<p>N. Chernov, Q. Huang, and H. Ma, 2014
Fitting quadratic curves to data points
British Journal of Mathematics &amp; Computer Science, 4, 33-60.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>XY &lt;- matrix(c(1,7,2,6,5,8,7,7,9,5,3,7,6,2,8,4),8,2,byrow=TRUE)
ParG &lt;- matrix(c(0,0,2,1,0),ncol=1)
Residuals.parabola(XY,ParG)
</code></pre>

<hr>
<h2 id='ResidualsG'>Projecting a given set of points onto an ellipse</h2><span id='topic+ResidualsG'></span>

<h3>Description</h3>

<p><code>ResidualsG</code> projects a given set of points onto an ellipse 
and computing the distances from the points to the ellipse </p>


<h3>Usage</h3>

<pre><code class='language-R'>ResidualsG(XY,ParG)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ResidualsG_+3A_xy">XY</code></td>
<td>
<p> array of sample data  </p>
</td></tr>
<tr><td><code id="ResidualsG_+3A_parg">ParG</code></td>
<td>
<p> vector 5x1 of the ellipse parameters (Center(1:2), Axes(1:2), 
Angle) </p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>list(RSS</code>, <code>XYproj)</code></td>
<td>
<p> list with the Residual Sum of Squares and the array
of coordinates of projections</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jose Gama</p>


<h3>Source</h3>

<p>Nikolai Chernov, 2014
Fitting ellipses, circles, and lines by least squares
<a href="http://people.cas.uab.edu/~mosya/cl/">http://people.cas.uab.edu/~mosya/cl/</a>
</p>
<p>N. Chernov, Q. Huang, and H. Ma, 2014
Fitting quadratic curves to data points
British Journal of Mathematics &amp; Computer Science, 4, 33-60.
</p>


<h3>References</h3>

<p>Nikolai Chernov, 2014
Fitting ellipses, circles, and lines by least squares
<a href="http://people.cas.uab.edu/~mosya/cl/">http://people.cas.uab.edu/~mosya/cl/</a>
</p>
<p>N. Chernov, Q. Huang, and H. Ma, 2014
Fitting quadratic curves to data points
British Journal of Mathematics &amp; Computer Science, 4, 33-60.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>XY &lt;- matrix(c(1,7,2,6,5,8,7,7,9,5,3,7,6,2,8,4),8,2,byrow=TRUE)
ParG &lt;- matrix(c(0,0,2,1,0),ncol=1)
ResidualsG(XY,ParG)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
