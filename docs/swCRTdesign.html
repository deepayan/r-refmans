<!DOCTYPE html><html><head><title>Help for package swCRTdesign</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {swCRTdesign}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#swCRTdesign-package'>
<p>Stepped Wedge Cluster Randomized Trial (SW CRT) Design</p></a></li>
<li><a href='#blkDiag'>
<p>Block Diagonal Matrix Generator</p></a></li>
<li><a href='#Release+20Notes'><p>Release notes for v4.0</p></a></li>
<li><a href='#swDsn'>
<p>Study design of Stepped Wedge Cluster Randomized Trial (SW CRT)</p></a></li>
<li><a href='#swGlmPwr'>
<p>Power of Stepped Wedge Cluster Randomized Trial with Discrete Outcomes</p></a></li>
<li><a href='#swPlot'>
<p>Plot of Mean Response/Outcome for Stepped Wedge Cluster Randomized Trial (SW CRT)</p></a></li>
<li><a href='#swPwr'>
<p>Power of Stepped Wedge Cluster Randomized Trial (SW CRT)</p></a></li>
<li><a href='#swSim'>
<p>Simulating individual-level data for specified study design of Stepped Wedge Cluster Randomized Trial (SW CRT)</p></a></li>
<li><a href='#swSimPwr'>
<p>Simulating power for Stepped Wedge Cluster Randomized Trials (SW CRT)</p></a></li>
<li><a href='#swSummary'>
<p>Summary of Response/Outcome for Stepped Wedge Cluster Randomized Trial (SW CRT)</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Stepped Wedge Cluster Randomized Trial (SW CRT) Design</td>
</tr>
<tr>
<td>Version:</td>
<td>4.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-08-08</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jim Hughes &lt;jphughes@uw.edu&gt;</td>
</tr>
<tr>
<td>Author:</td>
<td>Jim Hughes, Navneet R. Hakhu, Emily Voldal, and Fan Xia</td>
</tr>
<tr>
<td>Description:</td>
<td>A set of tools for examining the design and analysis aspects of stepped wedge cluster randomized trials (SW CRT) based on a repeated cross-sectional sampling scheme (Hussey MA and Hughes JP (2007) Contemporary Clinical Trials 28:182-191. &lt;<a href="https://doi.org/10.1016%2Fj.cct.2006.05.007">doi:10.1016/j.cct.2006.05.007</a>&gt;). </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-25 23:26:10 UTC; jphug</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-25 23:50:02 UTC</td>
</tr>
<tr>
<td>Imports:</td>
<td>lme4, lmerTest</td>
</tr>
</table>
<hr>
<h2 id='swCRTdesign-package'>
Stepped Wedge Cluster Randomized Trial (SW CRT) Design
</h2><span id='topic+swCRTdesign-package'></span><span id='topic+swCRTdesign'></span>

<h3>Description</h3>

<p>This package includes functions for the design and analysis of stepped wedge cluster randomized trials. For additional guidance, see (Voldal EC, Hakhu NR, Xia F, Heagerty PJ, Hughes JP. swCRTdesign: An R package for stepped wedge trial design and analysis. Computer Methods and Programs in Biomedicine 2020;196:105514. &lt;doi:10.1016/j.cmpb.2020.105514&gt;). Six primary functions - <code>swPwr</code>, <code>swGlmPwr</code>, <code>swSimPwr</code>, <code>swSim</code>, <code>swSummary</code>, and <code>swPlot</code> - and two support functions - <code>blkDiag</code> and <code>swDsn</code> - are included. The <code>blkDiag</code> function creates a block diagonal matrix from a specified array or list of block-matrices. The <code>swDsn</code> function creates a stepped wedge (SW) design object based on specified information on clusters, time points, and the arms of the cluster randomized trial (CRT). The <code>swPwr</code> function computes the (two-sided) power of treatment effect (<code class="reqn">\theta</code>) for the specified SW CRT design via weighted least squares (WLS), where the response/outcome of interest is assumed to come from a mixed effects model with normal or binomial errors, linear link and random time effects and (possibly correlated) random intercepts and random treatment effects. The random time effects apply to all time points, and time is treated as categorical.  <code>swGlmPwr</code> does power calculations using the generalized linear mixed model framework (Xia et al, 2019). <code>swSimPwr</code> simulates data and runs analyses using the linear mixed model or generalized linear mixed model framework to compute power. <code>swPwr</code>, <code>swGlmPwr</code> and <code>swSimPwr</code> provide power calculations for both an immediate treatment (IT) model and an exposure time indicator (ETI) model (Kenny et al, 2022) and can handle cross-sectional or closed cohort designs. The <code>swSim</code> function generates individual-level data consisting of response, treatment, time, time on treatment and cluster id variables (and individual id for a closed cohort) based on a specified SW CRT design. The <code>swSummary</code> function computes the mean, sum, or number of non-missing response values for clusters separately or aggregated by wave at each time point from stepped wedge data that includes, at least, response, treatment, time, and cluster variables. The <code>swPlot</code> function plots mean response as a combined or separate plot, for waves and clusters.  Some features of the package are also available as a shiny app, available online (https://swcrtdesign.shinyapps.io/stepped_wedge_power_calculation/) or to download and run locally (https://github.com/swCRTdesign/Stepped-wedge-power-calculation).
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> swCRTdesign</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 4.0</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2023-06-15</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;= 2)</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>James P Hughes, Navneet R Hakhu, Emily C Voldal, and Fan Xia
</p>
<p>Maintainer: James P Hughes &lt;jphughes@uw.edu&gt;
</p>


<h3>References</h3>

<p>Hussey MA, Hughes JP. Design and analysis of stepped wedge cluster randomized trials. Contemporary Clinical Trials 2007;28:182-191.
</p>
<p>Kenny A, Voldal E, Xia F, Heagerty PJ, Hughes JP. Analysis of stepped wedge cluster randomized trials in the presence of a time-varying treatment effect. Statistics in Medicine, in press, 2022.
</p>
<p>Voldal EC, Hakhu NR, Xia F, Heagerty PJ, Hughes JP. swCRTdesign: An R package for stepped wedge trial design and analysis. Computer Methods and Programs in Biomedicine 2020;196:105514.
</p>
<p>Xia F, Hughes JP, Voldal EC, Heagerty PJ. Power and sample size calculation for stepped-wedge designs with discrete outcomes. Trials. 2021 Dec;22(1):598.
</p>

<hr>
<h2 id='blkDiag'>
Block Diagonal Matrix Generator
</h2><span id='topic+blkDiag'></span>

<h3>Description</h3>

<p><code>blkDiag</code> returns block diagonal matrix based on specified square blocks (either as an array or a list).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>blkDiag(z)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="blkDiag_+3A_z">z</code></td>
<td>

<p>numeric (array or list): User-specified matrices to be combined into one block diagonal matrix.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric (matrix): <code>blkDiag</code> gives a block diagonal matrix.
</p>


<h3>Author(s)</h3>

<p>James P Hughes and Navneet R Hakhu
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(swCRTdesign)
# Example 1 (input: array)
blkDiag.Ex1.array &lt;- blkDiag( z=array(1:12, c(2,2,3)) )
blkDiag.Ex1.array

# Example 2 (input: list)
blkDiag.Ex2.list &lt;- blkDiag( z=list(matrix(1,2,2), diag(2,3), matrix(3,4,4)) )
blkDiag.Ex2.list

</code></pre>

<hr>
<h2 id='Release+20Notes'>Release notes for v4.0</h2><span id='topic+Release+20Notes'></span>

<h3>Description</h3>

<p>Changes from prior versions:
</p>
<p>1) A bug in the way that swGlmPwr handled fractional treatment effects has been fixed.
</p>
<p>2) In SwDsn, the extra.time argument has been deprecated and replaced by extra.trt.time. If you enter extra.time it will be used as extra.trt.time.
</p>
<p>3) In swPwr, the warning &quot;The order of variance component arguments has changed for swPwr (in version 2.2.0, it was tau, eta, rho, sigma); please modify existing code if necessary.&quot; has been removed.
</p>
<p>4)	In swPwr, the closed form power calculation (only applicable to a special subset of situations) is no longer provided.
</p>
<p>5)  In swPwr and swSim variance components now default to 0 instead of NULL so you only have to enter non-zero variance components. However, you cannot mix the two types of specifications (ie either use the tau, eta, gamma, zeta form or the icc, cac, iac form)
</p>
<p>6)	In swSim, the retTimeOnTx argument has been deprecated and timeOnTx.var is always returned
</p>
<p>New features:
1)	In swDsn, you can now directly specify an arbitrary stepped wedge design using the swBlk argument. This also allows one to specify multiple treatment levels
</p>
<p>2)	In swPwr and swGlmPwr, closed cohort designs may be specified by entering a non-zero value for either zeta or iac. If zeta/iac is 0 (the default) then a cross-sectional sampling design is assumed.
</p>
<p>3)	In swPwr and swGlmPwr, ETI-type estimators (Kenny et al) may be specified using the H argument. If the elements of H do not sum to 1 they are automatically renormalized.
</p>
<p>4)	swSim can simulate cross-sectional or closed cohort data, data with multiple treatment levels and data with an exposure-time-varying treatment effect.
</p>
<p>5)	swPlot allows specification of x and y axis limits.
</p>
<p>6)  A new function, swSimPwr, is included to compute power by simulation. Analyses are based on linear mixed models (lmer) or generalized linear mixed models (glmer).
</p>

<hr>
<h2 id='swDsn'>
Study design of Stepped Wedge Cluster Randomized Trial (SW CRT)
</h2><span id='topic+swDsn'></span>

<h3>Description</h3>

<p><code>swDsn</code> returns a SW CRT study design object. 
</p>
<p>All calls to <code>swDsn</code> require a <code>clusters</code> argument, a vector that specifies the number of clusters in each wave (all clusters that start the intervention at a given time point are collectively referred to as a wave or sequence). Used by itself, <code>clusters</code> specifies a classic stepped wedge design with number of waves equal to the length of <code>clusters</code> and number of time points equal to number of waves plus one. Further design modifications may be specified using the <code>extra.ctl.time</code>, <code>extra.trt.time</code>, and <code>all.ctl.time0</code> arguments. Fractional treatment effects may be specified for each time after the intervention is introduced using the <code>tx.effect.frac</code> argument.
</p>
<p>Alternatively, the <code>swBlk</code> argument can be used to specify a completely arbitrary stepped wedge design with multiple treatment levels and/or periods with no data collection (alternatively, periods with no data collection can  be defined in the sample size arguments of <code>swPwr</code>, <code>swGlmPwr</code> and <code>swSimPwr</code>).
</p>
<p>One can choose to use the <code>extra.ctl.time</code>, <code>extra.trt.time</code>, and <code>all.ctl.time0</code> arguments or the <code>swBlk</code> argument, but not both. Also, <code>tx.effect.frac</code> may not be used with the <code>swBlk</code> argument.
</p>
<p><code>swDsn</code> is used by other functions in this package. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>swDsn(clusters, tx.effect.frac=1, extra.ctl.time=0, extra.trt.time=0, 
all.ctl.time0=TRUE, swBlk, extra.time=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="swDsn_+3A_clusters">clusters</code></td>
<td>

<p>integer (vector): Number of clusters for each wave (e.g. c(6,6,6,6) specifies four waves with 6 clusters in each wave). A value of 0 in the vector means that no clusters introduce the intervention at a given time (see examples). Note that 0 clusters in a wave is not allowed when using the swBlk specification.
</p>
</td></tr>
<tr><td><code id="swDsn_+3A_tx.effect.frac">tx.effect.frac</code></td>
<td>

<p>numeric (scalar or vector): Relative treatment effect upon crossing over from control. Note that this is not the treatment effect (the treatment effect is specified in the call to other functions such as <code>swPwr</code> or <code>swSim</code>)!  If <code>tx.effect.frac</code> is set to a scalar with value of 1, the standard SW CRT treatment effect will be presumed. If codetx.effect.frac is set to a scalar with a fractional value between 0 and 1, then only the first time point upon crossing over from control will have fractional relative treatment effect; the remaining exposure times will have a relative treatment effect of 1. If a vector of fractional treatment effect is specified, each element of the vector corresponds to the (fractional) treatment effect upon crossing over from control; if the length of the vector is less than total number of exposure times, the remaining time points will have a relative treatment effect value of 1; if the length of the vector is greater than total number of time points after crossing over, not all elements of <code>tx.effect.frac</code> will be used. The default value is (scalar) 1.
</p>
</td></tr>
<tr><td><code id="swDsn_+3A_extra.ctl.time">extra.ctl.time</code></td>
<td>

<p>integer (scalar): Number of additional time steps during the control period beyond the standard SW CRT design. The default value is 0.
</p>
</td></tr>
<tr><td><code id="swDsn_+3A_extra.trt.time">extra.trt.time</code></td>
<td>

<p>integer (scalar): Number of additional time steps during the treatment period beyond the standard SW CRT design. The default value is 0.
</p>
</td></tr>
<tr><td><code id="swDsn_+3A_all.ctl.time0">all.ctl.time0</code></td>
<td>

<p>logical: If <code>TRUE</code>, all clusters receive control at the first time point. If <code>FALSE</code>, clusters in the first wave (i.e., the first element of <code>clusters</code>) receive intervention at the first time. The default is <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="swDsn_+3A_swblk">swBlk</code></td>
<td>

<p>integer (matrix): matrix with number of rows equal to the number of waves and number of columns equal to the total number of time periods of the study. Each row of <code>swBlk</code> corresponds to a wave and describes the introduction and levels of the intervention. Each element of <code>swBlk</code> is either NA, meaning no data will be collected in that cluster-time period, or an integer. Integers correspond to levels of the intervention where 0 is the control condition and values &gt;0 correspond to various levels of the intervention. A classic SW design includes only 2 values (0 and 1). More generally, one can specify integers corresponding to different levels of the intervention (e.g., a learning period, full intervention effect period and followup period could be coded as 1, 2 and 3, respectively). Alternatively, level 2 might denote the introduction of a second intervention that replaces the first, or is added to the first. A separate parameter is assigned for each intervention level so power can be computed for comparisons between any level and the control, or between different levels. 
</p>
<p>Note that the ETI model of Kenny et al (2022) implies a different intervention level for each exposure lag time. However, if you plan to use an ETI-based estimator of the treatment effect, then you should specify a standard 2-value design (0/1) in <code>swDsn</code> and use the H argument in <code>swPwr</code> or <code>swGlmPwr</code> to determine power for the estimator of interest. Also, note that NA periods that are interspersed with intervention periods (e.g. 0, 1, NA, 1) may cause unpredictable results for power calculations for ETI-based estimators since the lag for periods after the NA is ill-defined; NA periods that occur after the last intervention lag period of interest (e.g. 0, 1, 1, NA) are okay, however.</p>
</td></tr>	
<tr><td><code id="swDsn_+3A_extra.time">extra.time</code></td>
<td>

<p>integer (scalar): deprecated; if used, replaces extra.trt.time.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>clusters</code> argument is required. After that, a design may be specified using the <code>tx.effect.frac</code>, <code>extra.ctrl.time</code>, <code>extra.trt.time</code>, <code>all.ctl.time0</code> arguments or the <code>swBlk</code> argument:
</p>
<p>swDsn(clusters, tx.effect.frac=1, extra.ctl.time=0, extra.trt.time=0, all.ctl.time0=TRUE)
</p>
<p>or 
</p>
<p>swDsn(clusters, swBlk)
</p>


<h3>Value</h3>

<p>numeric (list): Returns the following user-specified and computed objects
</p>
<table>
<tr><td><code>swDsn</code></td>
<td>

<p>numeric (matrix):  schematic representation of the specified SW CRT design. Number of clusters is equal to the number of rows of the matrix and total number of time intervals is equal to the number of columns of the matrix. <code>swDsn[i,j]</code> gives the intervention status for cluster <code>i</code> at time <code>j</code> and has possible values NA (no data), 0 (control), or &gt;=1 (intervention levels).
</p>
</td></tr>
<tr><td><code>swDsn.unique.clusters</code></td>
<td>

<p>numeric (matrix): Truncated SW CRT design of interest, with one row for each wave.
</p>
</td></tr>
<tr><td><code>n.waves</code></td>
<td>

<p>numeric (scalar): Number of waves for the SW CRT design of interest.
</p>
</td></tr>
<tr><td><code>clusters</code></td>
<td>

<p>numeric (vector): Number of clusters for each wave for the SW CRT design of interest.
</p>
</td></tr>
<tr><td><code>n.clusters</code></td>
<td>

<p>numeric (scalar): Total number of clusters for the SW CRT design of interest.
</p>
</td></tr>
<tr><td><code>tx.effect.frac</code></td>
<td>

<p>numeric (scalar or vector): Fractional treatment effect for time points upon crossing over from control of SW CRT design of interest.
</p>
</td></tr>
<tr><td><code>total.time</code></td>
<td>

<p>numeric (scalar): Total number of time points for the SW CRT design of interest.
</p>
</td></tr>
<tr><td><code>nTxLev</code></td>
<td>

<p>numeric (integer): Number of treatment levels. 
</p>
</td></tr>
<tr><td><code>TxLev</code></td>
<td>

<p>numeric (integer): Vector of unique treatment levels. 
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>James P Hughes and Navneet R Hakhu
</p>


<h3>References</h3>

<p>Hussey MA, Hughes JP. Design and analysis of stepped wedge cluster randomized trials. Contemporary Clinical Trials 2007;28:182-191.
</p>
<p>Voldal EC, Hakhu NR, Xia, F, Heagerty PJ, Hughes JP. swCRTdesign: An R Package for Stepped Wedge Trial Design and Analysis. Computer Methods and Programs in Biomedicine 2020;196:105514.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example 1 (Equal clusters per wave, standard SW design)
swDsn.Ex1.std &lt;- swDsn( clusters=c(3,3,3) )
swDsn.Ex1.std$swDsn

# Example 2 (Equal clusters per wave, extended SW design)
swDsn.Ex1.extend &lt;- swDsn( clusters=c(3,3,3), extra.trt.time=2 )
swDsn.Ex1.extend$swDsn

# Example 3 (Equal clusters per wave, not all ctl at time 0, "standard" for time SW design)
swDsn.Ex1.std.noAllctl &lt;- swDsn( clusters=c(3,3,3), all.ctl.time0=FALSE )
swDsn.Ex1.std.noAllctl$swDsn

# Example 4 (Equal clusters per wave, not all ctl at time 0, extended SW design)
swDsn.Ex1.extend.noAllctl &lt;- swDsn( clusters=c(3,3,3), extra.trt.time=2, all.ctl.time0=FALSE )
swDsn.Ex1.extend.noAllctl$swDsn

# Example 5 (Unequal clusters per wave, standard SW design)
swDsn.Ex1.std.unequal &lt;- swDsn( clusters=c(3,0,2) )
swDsn.Ex1.std.unequal$swDsn

# Example 6 (Unequal clusters per wave, extended SW design)
swDsn.Ex1.extend.unequal &lt;- swDsn( clusters=c(3,0,2), extra.trt.time=2 )
swDsn.Ex1.extend.unequal$swDsn

# Example 7 (Unequal clusters per wave, extended SW design)
swDsn.Ex1.extend.unequal.varyTxEffect &lt;- swDsn( clusters=c(3,0,2), tx.effect.frac=c(0.8,0.9,1.0),
extra.trt.time=2 )
swDsn.Ex1.extend.unequal.varyTxEffect$swDsn

#Example 8 (Equal clusters per wave, extra control time and extra treatment time)
swDsn.Ex1.extendctrl.extendtrt &lt;- swDsn(c(5,5,5,5,5),extra.ctl.time=3,extra.trt.time=5)
swDsn.Ex1.extendctrl.extendtrt$swDsn

# Examples with swBlk
# Example 9 (Equal clusters per wave, standard SW design)
mat9 = matrix(c(0,1,1,1,1,0,0,1,1,1,0,0,0,1,1,0,0,0,0,1),4,5,byrow=TRUE)
swDsn.Ex9 &lt;- swDsn(c(6,6,6,6),swBlk=mat9)
swDsn.Ex9$swDsn

# Example 10 (Unequal clusters per wave, periods with no data collection)
mat10 = matrix(c(0,1,1,1,1,NA,0,1,1,1,NA,NA,0,1,1,NA,NA,NA,0,1),4,5,byrow=TRUE)
swDsn.Ex10 &lt;- swDsn(c(5,6,6,5),swBlk=mat10)
swDsn.Ex10$swDsn

# Example 11 (Unequal clusters per wave, periods with no data collection, 
# multiple intervention levels)
mat11 = matrix(c(0,1,2,2,2,2,NA,0,1,2,2,2,NA,NA,0,1,2,2,NA,NA,NA,0,1,2),4,6,byrow=TRUE)
swDsn.Ex11 &lt;- swDsn(c(5,6,6,5),swBlk=mat11)
swDsn.Ex11$swDsn

# Example 12 (Dogleg design)
swDsn.Ex12 &lt;- swDsn(c(4,4,4), swBlk=matrix(c(1,NA,0,1,NA,0),3,2,byrow=TRUE))
swDsn.Ex12$swDsn
</code></pre>

<hr>
<h2 id='swGlmPwr'>
Power of Stepped Wedge Cluster Randomized Trial with Discrete Outcomes
</h2><span id='topic+swGlmPwr'></span>

<h3>Description</h3>

<p><code>swGlmPwr</code> returns (two-sided) power of the treatment effect for the specified SW CRT design in the context of generalized linear models by adopting the Laplace approximation detailed in Breslow and Clayton (1993) to obtain the covariance matrix of the estimated parameters. The response/outcome of interest can be binomial (logit link only) or Poisson (log link only) distributed. A cross-sectional or closed cohort sampling scheme can be specified.
The outcome is assumed to come from a model with fixed treatment effect(s) (using an immediate treatment (IT) or exposure time indicator (ETI) model - see Kenny et al (2022)), fixed time effect, random intercepts, random treatment effects, random cluster-specific time effects  and, in the case of closed cohort sampling, an individual random effect. The coefficients for fixed effects can be specified using <code>fixed.intercept</code>, <code>fixed.treatment.effect</code>, and <code>fixed.time.effect</code>. Variance components can be specified using <code>tau</code>, <code>eta</code>, <code>rho</code>, <code>gamma</code> and <code>zeta</code>. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>swGlmPwr(design, distn, n, fixed.intercept, fixed.treatment.effect, 
fixed.time.effect, H = NULL, tau = 0, eta = 0, rho = 0, gamma = 0, zeta = 0, 
alpha=0.05, retDATA = FALSE, silent=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="swGlmPwr_+3A_design">design</code></td>
<td>

<p>list: A stepped wedge design object, typically from <code>swDsn</code>, that includes at least the   following components: swDsn, swDsn.unique.clusters, clusters, n.clusters, total.time, nTxLev, TxLev. Fractional treatment effects specified in <code>swDsn</code> are used in the calculation.
</p>
</td></tr>
<tr><td><code id="swGlmPwr_+3A_distn">distn</code></td>
<td>

<p>character: Distribution assumed (binomial or Poisson). &quot;binomial&quot; implies binomial outcomes with logit link and &quot;poisson&quot; implies Poisson outcome with log link. ***NOTE: It is the users responsibility to make sure specified parameters (fixed.intercept, fixed.treatment effect, fixed.time effect, tau, eta, rho, gamma, zeta) are ALL on SAME scale as specified link function; see example.***
</p>
</td></tr>
<tr><td><code id="swGlmPwr_+3A_n">n</code></td>
<td>

<p>integer (scalar, vector, or matrix): Number of observations: (scalar) for all clusters and all time points that are not NA in design$swDsn; (vector) for each cluster at all time points that are not NA in design$swDsn; and (matrix) for each cluster at each time point, where rows correspond to clusters and columns correspond to time. <code>n</code> can also be used to specify a design with transition periods (a transition period is a period, typically, immediately after treatment is introduced were no data are collected).  Simply define <code>n</code> as a matrix with a sample size of 0 during every transition period. This is equivalent to putting an NA in design$swDsn.
</p>
</td></tr>
<tr><td><code id="swGlmPwr_+3A_fixed.intercept">fixed.intercept</code></td>
<td>

<p>numeric (scalar): Intercept for the fixed effect on canonical scales (logit for binomial outcomes and log for Poisson outcomes). It is the mean outcome under the control condition in the first time point transformed to the canonical scales.
</p>
</td></tr>
<tr><td><code id="swGlmPwr_+3A_fixed.treatment.effect">fixed.treatment.effect</code></td>
<td>

<p>numeric (scalar, vector): Gives the coefficients for the treatment effect on the canonical scale (logit for binomial outcomes and log for Poisson outcomes). 
</p>
<p>If H = NULL then an IT model is assumed and <code>fixed.treatment.effect</code> gives the coefficient(s) for the <code>design$nTxLev</code> treatment effect(s). If <code>tx.effect.frac</code> is specified in <code>design</code> then the assumed treatment effect at exposure time k is <code>tx.effect.frac[k]*fixed.treatment.effect</code>. 
</p>
<p>If H is non-NULL then an ETI model is assumed and fixed.treatment.effect is a vector as long as the longest treatment effect exposure time; in a classic stepped wedge design, the longest exposure time is the number of time periods minus one. 
</p>
</td></tr>
<tr><td><code id="swGlmPwr_+3A_fixed.time.effect">fixed.time.effect</code></td>
<td>

<p>numeric(scalar, vector): Coefficients for the time (as dummy variables) in the fixed effect model on canonical scales (logit for binomial outcomes and log for Poisson outcomes). The first time point is always used as reference.
Specify a common time effect for all time points after the first (scalar) or differnt time effects for each time point after the first (vector of length (total time-1)).
</p>
</td></tr>
<tr><td><code id="swGlmPwr_+3A_h">H</code></td>
<td>

<p>numeric (vector): If NULL, then swGlmPwr assumes an immediate, constant treatment effect (IT) model. If not NULL, then an exposure time indicator (ETI) model is assumed and H should be a vector as long as the longest exposure time (typically, number of time periods minus one). H specifies the desired linear combination of fixed.treatment.effect. For example, in a stepped wedge trial with 5 time periods and four exposure times, H = rep(.25,4) gives the average treatment effect over the four exposure times; H = c(0,0,.5,.5) ignores the first two periods after the intervention is introduced and averages the remaining periods. Typically, the sum of H is 1.0; if not, it is renormalized to sum to 1.0. H can only be specified when there is a single intervention level (i.e. design$swDsn includes only NA,0,1; see cautions in help for <code>swDsn</code> about including NA periods when H is used). Do not use an ETI model (non-null <code>H</code>) if you specified a fractional treatment effect in <code>swDsn</code>.
</p>
</td></tr>
<tr><td><code id="swGlmPwr_+3A_tau">tau</code></td>
<td>

<p>numeric (scalar): Standard deviation of random intercepts on canonical scales (logit for binomial outcomes and log for Poisson outcomes).
</p>
</td></tr>
<tr><td><code id="swGlmPwr_+3A_eta">eta</code></td>
<td>
 
<p>numeric (scalar): Standard deviation of random treatment effects on canonical scales (logit for binomial outcomes and log for Poisson outcomes).
</p>
</td></tr>
<tr><td><code id="swGlmPwr_+3A_rho">rho</code></td>
<td>
 
<p>numeric (scalar): Correlation between random intercepts and random treatment effects on canonical scales (logit for binomial outcomes and log for Poisson outcomes).
</p>
</td></tr>
<tr><td><code id="swGlmPwr_+3A_gamma">gamma</code></td>
<td>

<p>numeric (scalar): Standard deviation of random time effects on canonical scales (logit for binomial outcomes and log for Poisson outcomes).
</p>
</td></tr>
<tr><td><code id="swGlmPwr_+3A_zeta">zeta</code></td>
<td>

<p>numeric (scalar): Standard deviation of individual effects for closed cohort sampling on canonical scales (logit for binomial outcomes and log for Poisson outcomes). Default is 0 which implies cross-sectional sampling. Values greater than 0 imply closed cohort sampling.
</p>
</td></tr>
<tr><td><code id="swGlmPwr_+3A_alpha">alpha</code></td>
<td>

<p>numeric (scalar): Statistical significance level. Default is 0.05.
</p>
</td></tr>
<tr><td><code id="swGlmPwr_+3A_retdata">retDATA</code></td>
<td>

<p>logical: if <code>TRUE</code>, all stored (input, intermediate, and output) values of <code>swGlmPwr</code> are returned. Default value is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="swGlmPwr_+3A_silent">silent</code></td>
<td>

<p>logical: if TRUE, hides most warning messages.  Default value is <code>FALSE</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The two-sided statistical power of treatment effect <code class="reqn">\theta</code> (equal to H%*%fixed.treatment.effect if H is non-NULL) is
</p>
<p style="text-align: center;"><code class="reqn">Pwr(\theta) = \Phi( \frac{Z - z_{1 - \alpha /2} \sqrt{V_0(\hat{\theta})}}{\sqrt{V_\alpha(\hat{\theta})}}) + 1 - \Phi( \frac{Z+ z_{1 - \alpha /2} \sqrt{V_0(\hat{\theta})}}{\sqrt{V_\alpha(\hat{\theta})}})</code>
</p>
<p>,
where <code class="reqn">\Phi</code> is the cumulative distribution function of the standard normal distribution. 
</p>
<p>The variance of  <code class="reqn">\hat{\theta}</code> under the null is denoted as <code class="reqn">V_0(\hat{\theta})</code>, and the variance of <code class="reqn">\hat{\theta}</code> under the alternative is denoted as <code class="reqn">V_\alpha(\hat{\theta})</code>). Both variances are approximated by simplifying the Laplace approximation that marginalizes the random effects in the generalized linear mixed models. For more details, see Xia et al. (2020). 
</p>
<p>When the outcome is Gaussian, the method adopted by <code>swGlmPwr</code> coincides with that of <code>swPwr</code>, so power calculation for Gaussian outcomes is not included in <code>swGlmPwr</code> to avoid repetition. When the outcome is binomial, <code>swGlmPwr</code> performs power calculation on the natural scale (logit), while <code>swPwr</code> performs power calculation on the linear scale. 
</p>
<p>The value of zeta defines the samling scheme. When zeta = 0, cross-sectional sampling is assumed; if zeta &gt; 0 then closed cohort sampling is assumed.
</p>


<h3>Value</h3>

<p>numeric (scalar): <code>swGlmPwr</code> returns the power of treatment effect if retDATA = FALSE.
</p>
<p>numeric (list): <code>swGlmPwr</code> returns all specified and computed items as objects of a list if retDATA = TRUE.  
</p>
<table>
<tr><td><code>$design</code></td>
<td>

<p>list: A stepped wedge design object, typically from swDsn, that includes at least the   following components: swDsn, swDsn.unique.clusters, clusters, n.clusters, total.time, nTxLev
</p>
</td></tr>
<tr><td><code>$distn</code></td>
<td>

<p>character: Distribution assumed (binomial or Poisson). &quot;binomial&quot; implies binomial outcomes and &quot;poisson&quot; implies Poisson outcome.  
</p>
</td></tr>
<tr><td><code>$n</code></td>
<td>

<p>integer (scalar, vector, or matrix): Number of observations: (scalar) for all clusters and all time points; (vector) for each cluster at all time points; and (matrix) for each cluster at each time point, where rows correspond to clusters and columns correspond to time. 
</p>
</td></tr>
<tr><td><code>$fixed.intercept</code></td>
<td>

<p>numeric (scalar): Intercept for the fixed effect on canonical scales (logit for binomial outcomes and log for Poisson outcomes).
</p>
</td></tr>
<tr><td><code>$fixed.treatment.effect</code></td>
<td>

<p>numeric (scalar): Coefficient(s) for the treatment(s) in the fixed effect model on canonical scales (logit for binomial outcomes and log for Poisson outcomes).
</p>
</td></tr>
<tr><td><code>$fixed.time.effect</code></td>
<td>

<p>numeric(scalar, vector): Coefficients for the time (as dummy variables) in the fixed effect model on canonical scales (logit for binomial outcomes and log for Poisson outcomes). The first time point is always used as reference.
A common time effect for all time points after the first (scalar) or differnt time effects for each time point after the first (vector of length (total time-1)).
</p>
</td></tr>
<tr><td><code>H</code></td>
<td>

<p>numeric (vector): H specifies the desired linear combination of exposure time treatment effects for a ETI model-based estimate.
</p>
</td></tr>
<tr><td><code>$tau</code></td>
<td>

<p>numeric (scalar): Standard deviation of random intercepts on canonical scales (logit for binomial outcomes and log for Poisson outcomes).
</p>
</td></tr>
<tr><td><code>$eta</code></td>
<td>
 
<p>numeric (scalar): Standard deviation of random treatment effects on canonical scales (logit for binomial outcomes and log for Poisson outcomes).
</p>
</td></tr>
<tr><td><code>$rho</code></td>
<td>
 
<p>numeric (scalar): Correlation between random intercepts and random treatment effects on canonical scales (logit for binomial outcomes and log for Poisson outcomes).
</p>
</td></tr>
<tr><td><code>$gamma</code></td>
<td>

<p>numeric (scalar): Standard deviation of random time effects on canonical scales (logit for binomial outcomes and log for Poisson outcomes).
</p>
</td></tr>
<tr><td><code>$zeta</code></td>
<td>

<p>numeric (scalar):  Standard deviation of individual random effects for closed cohort sampling on canonical scales (logit for binomial outcomes and log for Poisson outcomes).
</p>
</td></tr>
<tr><td><code>$alpha</code></td>
<td>

<p>numeric (scalar): Statistical significance level. Default is 0.05.
</p>
</td></tr>
<tr><td><code>$var.theta.null</code></td>
<td>

<p>numeric (martix): Variance-covariance martix of the estimated treatment effect(s) under the null for this SW CRT design.
</p>
</td></tr>
<tr><td><code>$var.theta.alt</code></td>
<td>

<p>numeric (marix): Variance-covariance matrix of the estimated treatment effect(s) under the alternative for this SW CRT design.
</p>
</td></tr>
<tr><td><code>$pwrGLM</code></td>
<td>

<p>numeric (scalar): Power of treatment effect using a simplified Laplace approximation.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Fan Xia, James P Hughes, and Emily C Voldal
</p>


<h3>References</h3>

<p>Breslow NE and Clayton DG (1993). Approximate inference in generalized linear mixed models. Journal of the American Statistical Association, 88(421):9-25.
</p>
<p>Kenny A, Voldal E, Xia F, Heagerty PJ, Hughes JP. Analysis of stepped wedge cluster randomized trials in the presence of a time-varying treatment effect. Statistics in Medicine, in press, 2022.
</p>
<p>Voldal EC, Hakhu NR, Xia, F, Heagerty PJ, Hughes JP. swCRTdesign: An R Package for Stepped Wedge Trial Design and Analysis. Computer Methods and Programs in Biomedicine 2020;196:105514.
</p>
<p>Xia F, Hughes JP, Voldal EC, Heagerty PJ. Power and sample size calculation for stepped-wedge designs with discrete outcomes. Trials. 2021 Dec;22(1):598.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##test-case large clusters
logit &lt;- function(x){log(x/(1 - x))}
#specify large cluster sizes
size = c(35219,53535,63785,456132,128670,96673,
51454,156667,127440,68615,56502,17719,75931,58655,52874,75936)

# Cross-sectional example
swGlmPwr(design=swDsn(c(4,3,5,4)),distn="binomial",n=size,
        fixed.intercept=log(28.62/(2*100000)),fixed.time.effect = 1,
        fixed.treatment.effect = log(.6),
        tau=.31,eta=abs(0.4*log(.6)),rho=0,gamma=.15,alpha=.05,retDATA = FALSE)

# Closed cohort example, comparing average of intervention period exposure 
# lags 3 and 4 to control period
swGlmPwr(design=swDsn(c(5,5,5,5,5),extra.ctl.time=3,extra.trt.time=5),
         distn="binomial",n=20,
         fixed.intercept=logit(0.40),
         fixed.treatment.effect=c(0,0,rep(logit(0.60)-logit(0.40),8)),
         fixed.time.effect=0.08,
         H=c(0,0,1,1,0,0,0,0,0,0),
         tau=sqrt(.1316),gamma=sqrt(.1974),eta=0,zeta=sqrt(2.5))

# Example wih periods with no data and multiple treatment levels
stdy &lt;- swDsn(c(6,6,6,6),swBlk=matrix(c(0,1,2,2,2,2,
                                         NA,0,1,2,2,2,
                                         NA,NA,0,1,2,2,
                                         NA,NA,NA,0,1,2),4,6,byrow=TRUE))
swGlmPwr(stdy, distn="binomial",n=10000, 
         fixed.intercept=log(28.62/(2*100000)),fixed.time.effect = 1,
         fixed.treatment.effect = c(log(.6),log(.5)),
         tau=.31,eta=0,rho=0,gamma=0,alpha=.05,retDATA = FALSE)

</code></pre>

<hr>
<h2 id='swPlot'>
Plot of Mean Response/Outcome for Stepped Wedge Cluster Randomized Trial (SW CRT)
</h2><span id='topic+swPlot'></span>

<h3>Description</h3>

<p><code>swPlot</code> returns plot of the mean response versus time based on waves and/or clusters from a SW CRT.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>swPlot(response.var, tx.var, time.var, cluster.var, data, choose.mfrow=NULL,
by.wave=TRUE, combined.plot=TRUE, choose.xlab="Time", choose.main=NULL,
choose.pch=NULL, choose.cex=1, choose.tx.col=NULL, choose.tx.lty = c(2,1),
choose.ncol=2, xlim=NULL, ylim=NULL, choose.tx.pos="topright", choose.legend.pos="right")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="swPlot_+3A_response.var">response.var</code></td>
<td>

<p>numeric(vector): Response (Outcome) variable.
</p>
</td></tr>
<tr><td><code id="swPlot_+3A_tx.var">tx.var</code></td>
<td>

<p>numeric(vector): Treatment (Predictor of Interest) variable. Typically, 0=control, 1=intervention, and values greater than 1 correspond to other treatment levels.
</p>
</td></tr>
<tr><td><code id="swPlot_+3A_time.var">time.var</code></td>
<td>

<p>integer(vector): Time (points) variable, corresponding to the time points when data were collected during the SW CRT.
</p>
</td></tr>
<tr><td><code id="swPlot_+3A_cluster.var">cluster.var</code></td>
<td>

<p>integer(vector): Cluster (identification) variable, corresponding to the cluster where an observation is from.
</p>
</td></tr>
<tr><td><code id="swPlot_+3A_data">data</code></td>
<td>

<p>An optional data frame containing (at least) the response, treatment (tx), time, and cluster variables.
</p>
</td></tr>
<tr><td><code id="swPlot_+3A_choose.mfrow">choose.mfrow</code></td>
<td>

<p>numeric (vector): Choose <code>mfrow</code> for plot. If <code>NULL</code>, <code>mfrow</code> is automatically assigned based on the plot created. The default is <code>NULL</code>.
</p>
</td></tr>
<tr><td><code id="swPlot_+3A_by.wave">by.wave</code></td>
<td>

<p>logical: If <code>TRUE</code>, plot mean response according to each wave. If <code>FALSE</code>, plot mean response according to each cluster. The default is <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="swPlot_+3A_combined.plot">combined.plot</code></td>
<td>

<p>logical: If <code>TRUE</code>, plot mean response on same plot (what is plotted depends on <code>by.wave</code>). If <code>FALSE</code>, plot mean response on separate plots for each wave (what is plotted depends on <code>by.wave</code>). The default is <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="swPlot_+3A_choose.xlab">choose.xlab</code></td>
<td>

<p>Choose <code>xlab</code> for plot. The default is &quot;Time&quot;.
</p>
</td></tr>
<tr><td><code id="swPlot_+3A_choose.main">choose.main</code></td>
<td>

<p>Choose <code>main</code> for plot. If <code>NULL</code>, <code>main</code> is chosen for the user; which is highly recommended. The default is <code>NULL</code>.
</p>
</td></tr>
<tr><td><code id="swPlot_+3A_choose.pch">choose.pch</code></td>
<td>

<p>Choose <code>pch</code> for plot. If <code>NULL</code>, <code>pch</code> are chosen for the user; which is highly recommended. The default is <code>NULL</code>.
</p>
</td></tr>
<tr><td><code id="swPlot_+3A_choose.cex">choose.cex</code></td>
<td>

<p>Choose <code>cex</code> for <code>choose.pch</code>. Standard <code>cex</code> option in <code>points()</code> applies. The default is <code>1</code>.
</p>
</td></tr>
<tr><td><code id="swPlot_+3A_choose.tx.col">choose.tx.col</code></td>
<td>

<p>Choose colors for different treatment options. Vector of two colors, corresponding to control and treatment groups, respectively. If <code>NULL</code>, colors are chosen for the unique treatment options in the data supplied. The default is <code>NULL</code>.
</p>
</td></tr>
<tr><td><code id="swPlot_+3A_choose.tx.lty">choose.tx.lty</code></td>
<td>

<p>Choose line types for different treatment options. Vector of two numbers for <code>lty</code>, corresponding to control and treatment groups, respectively. The default is <code>c(2,1)</code>.
</p>
</td></tr>
<tr><td><code id="swPlot_+3A_choose.ncol">choose.ncol</code></td>
<td>

<p>Choose number of columns for non-treatment legend. Standard <code>ncol</code> option in <code>legend()</code> applies. The default is <code>2</code>.
</p>
</td></tr>
<tr><td><code id="swPlot_+3A_xlim">xlim</code>, <code id="swPlot_+3A_ylim">ylim</code></td>
<td>

<p>Vectors of length 2 giving x and y axis limits on plot. If NULL, minimum and maximum of summary time and response variables are used, respectively.
</p>
</td></tr>
<tr><td><code id="swPlot_+3A_choose.tx.pos">choose.tx.pos</code></td>
<td>

<p>Choose where to place treatment colors &quot;legend&quot;. Standard <code>legend()</code> positions apply. The default is &quot;topright&quot;; if this covers points, it should be changed.
</p>
</td></tr>
<tr><td><code id="swPlot_+3A_choose.legend.pos">choose.legend.pos</code></td>
<td>

<p>Choose where to place the non-treatment legend. Standard <code>legend()</code> positions apply. The default is &quot;right&quot;; if this covers points, it should be changed.  If &quot;mouseclick&quot;, user specifies location with mouse/trackpad by clicking on the plot that appears. Specify <code>NULL</code> to remove legend.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Returns a plot of the mean response versus time with a combination of by wave (<code>TRUE</code> / <code>FALSE</code>) and combined plot (<code>TRUE</code> / <code>FALSE</code>) from a SW CRT. See discussion of number of waves in help file for swSummary.
</p>


<h3>Author(s)</h3>

<p>James P Hughes, Navneet R Hakhu, and Emily C Voldal
</p>


<h3>References</h3>

<p>Hussey MA, Hughes JP. Design and analysis of stepped wedge cluster randomized trials. Contemporary Clinical Trials 2007;28:182-191.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(swCRTdesign)
# Example 1 
# Generate binary response with 5 clusters, 4 time points
data.Ex1 &lt;- swSim(swDsn(c(2,2,1)),family=binomial(link="identity"), n=120,
                     mu0=0.25, mu1=0.30,time.effect=0, tau=0.05, gamma=.01)

# Example 1 (Mean Response vs Time, by.wave=TRUE, combined.plot=TRUE)
swPlot(response.var, tx.var, time.var, cluster.var, data.Ex1, by.wave=TRUE,
combined.plot=TRUE, choose.tx.pos="bottomright", choose.legend.pos="bottom")

# Example 2 (Mean Response vs Time, by.wave=TRUE, combined.plot=FALSE)
swPlot(response.var, tx.var, time.var, cluster.var, data.Ex1, by.wave=TRUE,
combined.plot=FALSE, choose.tx.pos="bottomright", choose.legend.pos="bottom")

# Example 3 (Mean Response vs Time, by.wave=FALSE, combined.plot=TRUE)
swPlot(response.var, tx.var, time.var, cluster.var, data.Ex1, by.wave=FALSE,
combined.plot=TRUE, ylim=c(0,0.6), choose.tx.pos="bottomright", choose.legend.pos="topleft")

# Example 4 (Mean Response vs Time, by.wave=FALSE, combined.plot=FALSE)
swPlot(response.var, tx.var, time.var, cluster.var, data.Ex1, by.wave=FALSE,
combined.plot=FALSE, choose.tx.pos="bottomright", choose.legend.pos="bottom")

</code></pre>

<hr>
<h2 id='swPwr'>
Power of Stepped Wedge Cluster Randomized Trial (SW CRT)
</h2><span id='topic+swPwr'></span>

<h3>Description</h3>

<p><code>swPwr</code> returns (two-sided) power for the treatment effect(s) from an immediate treatment effect (IT) model or an exposure time indicator (ETI) model (Kenny et al, 2022) for the specified SW CRT design using a linear models weighted least squares (WLS) approach. A cross-sectional or closed cohort sampling scheme can be specified. The response/outcome of interest can be binomial or Gaussian distributed and is assumed to come from a model with random intercepts, random treatment effects, random cluster-specific time effects, and, in the case of closed cohort sampling, an individual random effect. Variance components can be specified using either random effect variances (tau, eta, rho, gamma, and zeta) or icc, cac, iac (see details).  If a cross-sectional sampling, random intercepts only model is used (i.e., eta, rho, gamma and zeta are 0 and n is constant over clusters and time), then the power calculation is comparable to the closed-form formula of [Hussey and Hughes, 2007]. See [Voldal et al., 2020] for more guidance.  This function is also available as a Shiny app at https://swcrtdesign.shinyapps.io/stepped_wedge_power_calculation/.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>swPwr(design, distn, n, mu0, mu1, H=NULL, sigma, tau=0, eta=0, rho=0, gamma=0, zeta=0,
icc=0, cac=1, iac=0, alpha=0.05, retDATA=FALSE, silent=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="swPwr_+3A_design">design</code></td>
<td>

<p>list: A stepped wedge design object, typically from <code>swDsn</code>, that includes at least the following components: swDsn, swDsn.unique.clusters, clusters, n.clusters, total.time, nTxLev, TxLev. Fractional treatment effects specified in <code>swDsn</code> are used in the calculation.
</p>
</td></tr>
<tr><td><code id="swPwr_+3A_distn">distn</code></td>
<td>

<p>character: Distribution assumed (<code>gaussian</code> or <code>binomial</code>).  Currently, 'Binomial' implies Bernoulli.
</p>
</td></tr>
<tr><td><code id="swPwr_+3A_n">n</code></td>
<td>

<p>integer (scalar, vector, or matrix): Number of observations: (scalar) for all clusters and all time points that are not NA in design$swDsn; (vector) for each cluster at all time points that are not NA in design$swDsn; and (matrix) for each cluster at each time point, where rows correspond to clusters and columns correspond to time.  <code>n</code> can also be used to specify a design with transition periods (a transition period is a period, typically, immediately after treatment is introduced were no data are collected).  Simply define <code>n</code> as a matrix with a sample size of 0 during every transition period. This is equivalent to putting an NA in design$swDsn.
</p>
</td></tr>
<tr><td><code id="swPwr_+3A_mu0">mu0</code></td>
<td>

<p>numeric (scalar): Mean outcome in the control group. See also documentation for H, below.
</p>
</td></tr>
<tr><td><code id="swPwr_+3A_mu1">mu1</code></td>
<td>

<p>numeric (scalar or vector): Mean outcome in the treatment group(s). The treatment effect is the difference in means <code class="reqn">\theta = \mu_1 - \mu_0</code>. If <code>tx.effect.frac</code> is specified in the call to <code>swDsn</code> then the assumed treatment effect at exposure time k is <code>tx.effect.frac</code>[k]*<code class="reqn">\theta</code>. For an IT model with multiple treatment levels the length of <code>mu1</code> should be equal to the number of treatment levels. See also documentation for H, below.
</p>
</td></tr>
<tr><td><code id="swPwr_+3A_h">H</code></td>
<td>

<p>numeric (vector): If NULL, then swPwr assumes an immediate, constant treatment effect (IT) model. If not NULL, then an exposure time indicator (ETI) model is assumed and H should be a vector as long as the longest exposure time (in a classic stepped wedge design, the longest exposure time is the number of time periods minus one). H specifies the desired linear combination of exposure time treatment effects. For example, in a stepped wedge trial with 5 time periods and four exposure times, H = rep(.25,4) gives the average treatment effect over the four exposure times; H = c(0,0,.5,.5) ignores the first two periods after the intervention is introduced and averages the remaining periods. Typically, the sum of H is 1.0; if not, it is renormalized to sum to 1.0. H can only be specified when there is a single intervention level (i.e. design$swDsn includes only NA,0,1; see cautions in help for <code>swDsn</code> about including NA periods when H is used). mu0 and mu1 give expected values of the linear combination of exposure time treatment effects under the null and alternative hypotheses, respectively. Do not use an ETI model (non-null <code>H</code>) if you specified a fractional treatment effect in <code>swDsn</code>.
</p>
</td></tr>
<tr><td><code id="swPwr_+3A_sigma">sigma</code></td>
<td>

<p>numeric (scalar): Standard deviation when assuming Gaussian distribution (<code>distn=gaussian</code>). For binomial distribution <code class="reqn">\sigma^2</code> is automatically set to <code class="reqn">\bar{\mu}(1-\bar{\mu})</code> where <code class="reqn">\bar{\mu} = (\mu_1 + \mu_0)/2</code>
</p>
</td></tr>
<tr><td><code id="swPwr_+3A_tau">tau</code></td>
<td>

<p>numeric (scalar): Standard deviation of random intercepts.
</p>
</td></tr>
<tr><td><code id="swPwr_+3A_eta">eta</code></td>
<td>

<p>numeric (scalar): Standard deviation of random treatment effects.
</p>
</td></tr>
<tr><td><code id="swPwr_+3A_rho">rho</code></td>
<td>

<p>numeric (scalar): Correlation between random intercepts and random treatment effects.
</p>
</td></tr>
<tr><td><code id="swPwr_+3A_gamma">gamma</code></td>
<td>

<p>numeric (scalar): Standard deviation of random time effects.
</p>
</td></tr>
<tr><td><code id="swPwr_+3A_zeta">zeta</code></td>
<td>

<p>numeric (scalar): Standard deviation of individual effects for closed cohort sampling. Default is 0 which implies cross-sectional sampling. Values greater than 0 imply closed cohort sampling.
</p>
</td></tr>
<tr><td><code id="swPwr_+3A_icc">icc</code></td>
<td>

<p>numeric (scalar): Within-period intra-cluster correlation.  Can be used with CAC instead of tau, eta, rho, and gamma; see details.
</p>
</td></tr>
<tr><td><code id="swPwr_+3A_cac">cac</code></td>
<td>

<p>numeric (scalar): Cluster auto-correlation.  Can be used with ICC instead of tau, eta, rho, and gamma; see details.
</p>
</td></tr>
<tr><td><code id="swPwr_+3A_iac">iac</code></td>
<td>

<p>numeric (scalar): Individual auto-correlation for closed cohort sampling.  Can be used with ICC and CAC instead of tau, eta, rho, gamma, and zeta; see details. Default is 0 which implies cross-sectional sampling. Values greater than 0 imply closed cohort sampling.
</p>
</td></tr>
<tr><td><code id="swPwr_+3A_alpha">alpha</code></td>
<td>

<p>numeric (scalar): Two-sided statistical significance level.
</p>
</td></tr>
<tr><td><code id="swPwr_+3A_retdata">retDATA</code></td>
<td>

<p>logical: if TRUE, all stored (input, intermediate, and output) values of <code>swPwr</code> are returned. Default value is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="swPwr_+3A_silent">silent</code></td>
<td>

<p>logical: if TRUE, hides most warning messages.  Default value is <code>FALSE</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The two-sided statistical power of treatment effect <code class="reqn">(\theta = \mu_1 - \mu_0)</code> is
</p>
<p style="text-align: center;"><code class="reqn"> Pwr(\theta) = \Phi( Z - z_{1 - \alpha /2} ) + \Phi( -Z - z_{1 - \alpha /2} ) </code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn"> Z = \frac{ |\theta| }{ \sqrt{Var(\hat{\theta}_{WLS})} } </code>
</p>

<p>and <code class="reqn">\Phi</code> is the cumulative distribution function of the standard normal <code class="reqn">N(0,1)</code> distribution. If H is non-NULL then the <code class="reqn">\mu</code> are assumed to be equal to H<code class="reqn">\delta</code> where <code class="reqn">\delta</code> is a vector of exposure time treatment effects.
</p>
<p>The value of zeta defines the samling scheme. When zeta = 0, cross-sectional sampling is assumed; if zeta &gt; 0 then closed cohort sampling is assumed.
</p>
<p>When eta (and rho) are 0, instead of using tau, eta, rho, gamma and zeta, the icc, cac and iac can be used to define the variability of the random effects.  In this model,
</p>
<p style="text-align: center;"><code class="reqn"> ICC = \frac{\tau^2+\gamma^2}{\tau^2+\gamma^2+\zeta^2+\sigma^2} </code>
</p>

<p style="text-align: center;"><code class="reqn"> CAC = \frac{\tau^2}{\tau^2+\gamma^2} </code>
</p>

<p style="text-align: center;"><code class="reqn"> IAC = \frac{\zeta^2}{\zeta^2+\sigma^2}</code>
</p>

<p>Choose one parameterization or the other, do not mix parameterizations.
</p>


<h3>Value</h3>

<p>numeric (vector): <code>swPwr</code> returns the power of treatment effect(s), where the variance of treatment effect is computed by WLS.  
</p>
<p>numeric (list): <code>swPwr</code> returns all specified and computed items as objects of a list if <code>retDATA = TRUE</code>.
</p>
<table>
<tr><td><code>design</code></td>
<td>

<p>list: The stepped wedge design object as input.
</p>
</td></tr>
<tr><td><code>distn</code></td>
<td>

<p>character: Distribution assumed (<code>gaussian</code> or <code>binomial</code>).
</p>
</td></tr>
<tr><td><code>n</code></td>
<td>

<p>integer (scalar, vector, or matrix): Number of observations: (scalar) for all clusters and all time points; (vector) for each cluster at all time points; and (matrix) for each cluster at each time point, where rows correspond to clusters and columns correspond to time.
</p>
</td></tr>
<tr><td><code>mu0</code></td>
<td>

<p>numeric (scalar): Mean outcome in the control group.
</p>
</td></tr>
<tr><td><code>mu1</code></td>
<td>

<p>numeric (scalar): Mean outcome in intervention group(s). Note: treatment effect is difference in means <code class="reqn">\theta = \mu_1 - \mu_0</code>.
</p>
</td></tr>
<tr><td><code>H</code></td>
<td>

<p>numeric (vector): H specifies the desired linear combination of exposure time treatment effects for a ETI model-based estimate.
</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>

<p>numeric (scalar): Standard deviation input. For binomial distribution, sigma = NA
</p>
</td></tr>
<tr><td><code>tau</code></td>
<td>

<p>numeric (scalar): Standard deviation of random intercepts.
</p>
</td></tr>
<tr><td><code>eta</code></td>
<td>

<p>numeric (scalar): Standard deviation of random treatment effects.
</p>
</td></tr>
<tr><td><code>rho</code></td>
<td>

<p>numeric (scalar): Correlation between random intercepts and random treatment effects.
</p>
</td></tr>
<tr><td><code>gamma</code></td>
<td>

<p>numeric (scalar): Standard deviation of random time effects.
</p>
</td></tr>
<tr><td><code>zeta</code></td>
<td>

<p>numeric (scalar): Standard deviation of individual random effects for closed cohort sampling.
</p>
</td></tr>
<tr><td><code>icc</code></td>
<td>

<p>numeric (scalar): Within-period intra-cluster correlation.  Can be used with CAC and IAC instead of tau, eta, rho, gamma and zeta; see details.
</p>
</td></tr>
<tr><td><code>cac</code></td>
<td>

<p>numeric (scalar): Cluster auto-correlation.  Can be used with ICC and IAC instead of tau, eta, rho, gamma and zeta; see details.
</p>
</td></tr>
<tr><td><code>iac</code></td>
<td>

<p>numeric (scalar): Individual auto-correlation for closed cohort sampling.  Can be used with ICC and CAC instead of tau, eta, rho, gamma and zeta; see details.
</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>

<p>numeric (scalar): Statistical significance level.
</p>
</td></tr>
<tr><td><code>Xmat</code></td>
<td>

<p>numeric (matrix): Design matrix for this SW CRT design.
</p>
</td></tr>
<tr><td><code>Wmat</code></td>
<td>

<p>numeric (matrix): Covariance matrix for this SW CRT design.
</p>
</td></tr>
<tr><td><code>var</code></td>
<td>
<p>Variance-covariance matrix of treatment effect(s). Can be used to calculate power for constrasts other than control versus treatment
</p>
</td></tr>
<tr><td><code>var.theta.WLS</code></td>
<td>

<p>numeric (scalar): Variance(s) of treatment effect(s) using weighted least squares (WLS) for this SW CRT design.
</p>
</td></tr>
<tr><td><code>pwrWLS</code></td>
<td>

<p>numeric (scalar): Power of treatment effect (<code class="reqn">\theta</code>) using weighted least squares (WLS) for this SW CRT design.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>James P Hughes, Navneet R Hakhu, and Emily C Voldal
</p>


<h3>References</h3>

<p>Hussey MA, Hughes JP. Design and analysis of stepped wedge cluster randomized trials. Contemporary Clinical Trials 2007;28:182-191.
</p>
<p>Kenny A, Voldal E, Xia F, Heagerty PJ, Hughes JP. Analysis of stepped wedge cluster randomized trials in the presence of a time-varying treatment effect. Statistics in Medicine, in press, 2022.
</p>
<p>Voldal EC, Hakhu NR, Xia F, Heagerty PJ, Hughes JP. swCRTdesign: An R package for stepped wedge trial design and analysis. Computer Methods and Programs in Biomedicine 2020;196:105514.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example 1 (Random Intercepts Only, standard Stepped Wedge (SW) design)
swPwr.Ex1.RIO.std &lt;- swPwr(swDsn(c(6,6,6,6)), distn="binomial",
n=120, mu0=0.05, mu1=0.035, tau=0.01, eta=0, rho=0, gamma=0, alpha=0.05, retDATA=FALSE)
swPwr.Ex1.RIO.std

# Example 2 (Random Intercepts Only, extended SW design)
swPwr.Ex1.RIO.extend &lt;- swPwr(swDsn(c(6,6,6,6), extra.trt.time=3), distn="binomial",
n=120, mu0=0.05, mu1=0.035, tau=0.01, eta=0, rho=0, gamma=0,
alpha=0.05, retDATA=FALSE)
swPwr.Ex1.RIO.extend

# Example 3 (Independent Random Intercepts and Treatment effects, standard SW design)
swPwr.Ex1.IRIS &lt;- swPwr(swDsn(c(6,6,6,6)), distn="binomial",
n=120, mu0=0.05, mu1=0.035, tau=0.01, eta=0.0045, rho=0, gamma=0,
alpha=0.05, retDATA=FALSE)
swPwr.Ex1.IRIS

# Example 4 (Correlated Random Intercepts and Slopes, standard SW design)
swPwr.Ex1.CRIS &lt;- swPwr(swDsn(c(6,6,6,6)), distn="binomial",
n=120, mu0=0.05, mu1=0.035, tau=0.01, eta=0.0045, rho=0.4, gamma=0,
alpha=0.05, retDATA=FALSE)
swPwr.Ex1.CRIS

# Example 5 (Random time effect and correlated Random Intercepts and Slopes, standard SW design)
swPwr.Ex1.RTCRIS &lt;- swPwr(swDsn(c(6,6,6,6)), distn="binomial",
n=120, mu0=0.05, mu1=0.035, tau=0.01, eta=0.0045, rho=0.4, gamma = 0.1,
alpha=0.05, retDATA=FALSE)
swPwr.Ex1.RTCRIS

#Example 6 (Sample size varying by cluster)
sample.size.vector &lt;- c(35219,53535,63785,456132,128670,96673,
           51454,156667,127440,68615,56502,17719,
           75931,58655,52874,75936)
swPwr.Ex1.vector &lt;- swPwr(swDsn(c(4,3,5,4)), distn="gaussian",
n=sample.size.vector, mu0=2.66, mu1=2.15,
sigma=sqrt(1/2.66), tau=0.31, eta=0.2, rho=0, gamma = 0.15,
alpha=0.05, retDATA=FALSE)
swPwr.Ex1.vector

#Example 7 (Sample size varying by cluster and time)
sample.size.matrix &lt;- matrix(c(26, 493,  64,  45,  48, 231, 117,  17,  49,  36,  19,  77, 67, 590,
261, 212,  67, 318, 132,  58,  44,  57,  59,  78, 115, 532, 176, 199,  73, 293, 129,  79,  51,
62, 109,  94, 174, 785, 133,  79, 120, 305, 224,  99,  83,  79, 122, 122, 94, 961,  90, 131, 166,
352, 316,  59,  54, 131, 101, 133),nrow=12,ncol=5, byrow=FALSE)
swPwr.Ex1.matrix &lt;- swPwr(swDsn(c(3,3,3,3)), distn="binomial",
n=sample.size.matrix, mu0=0.08, mu1=0.06, tau=0.017, eta=0.006, rho=-0.5, gamma = 0,
alpha=0.05, retDATA=FALSE)
swPwr.Ex1.matrix

#Example 8 (Using ICC and CAC)
swPwr.Ex1.icccac &lt;- swPwr(swDsn(c(6,6,6,6)), distn="gaussian",
n=120, mu0=0.05, mu1=0.035, sigma=0.1, icc=0.02, cac=0.125, alpha=0.05, retDATA=FALSE)
swPwr.Ex1.icccac

# Example 9 (Random time effect, closed cohort sampling)
sample_size = matrix(c(rep(c(20,20,20,20,20,20,20,20,20,20,20,20,20,20),5),
                       rep(c( 0,20,20,20,20,20,20,20,20,20,20,20,20,20),5),
                       rep(c( 0, 0,20,20,20,20,20,20,20,20,20,20,20,20),5),
                       rep(c( 0, 0, 0,20,20,20,20,20,20,20,20,20,20,20),5),
                       rep(c( 0, 0, 0, 0,20,20,20,20,20,20,20,20,20,20),5)),
                       25,14,byrow=TRUE)
swPwr.Ex9 &lt;- swPwr(design=swDsn(c(5,5,5,5,5),extra.ctl.time=3,extra.trt.time=5),
      distn="gaussian",n=sample_size,mu0=-0.4,mu1=0.4,
      sigma=1.0,tau=sqrt(.1316),gamma=sqrt(.1974),eta=0,rho=0,zeta=sqrt(2.5),
      silent=TRUE)
swPwr.Ex9

#Example 10 (Periods with no data, multiple treatment levels)
stdy &lt;- swDsn(c(6,6,6,6),swBlk=matrix(c(0,1,2,2,2,2,
                                         NA,0,1,2,2,2,
                                         NA,NA,0,1,2,2,
                                         NA,NA,NA,0,1,2),4,6,byrow=TRUE))
swPwr.Ex10 &lt;-swPwr(stdy, distn="binomial",n=120, mu0=0.05, mu1=c(0.035,0.03),
      tau=0.01, eta=0, rho=0, gamma=0, alpha=0.05, retDATA=TRUE, silent=TRUE)
swPwr.Ex10

</code></pre>

<hr>
<h2 id='swSim'>
Simulating individual-level data for specified study design of Stepped Wedge Cluster Randomized Trial (SW CRT)
</h2><span id='topic+swSim'></span>

<h3>Description</h3>

<p><code>swSim</code> returns individual-level data set of a SW CRT study design for the specified number of clusters per wave, treatment effect (possibly varying according to the exposure time - time after crossing over from control), time effect, family (and link function), number of individuals per cluster per time period, mean in control arm, mean in treatment arm(s), standard deviation (if applicable), standard deviation of random intercepts, standard deviation of random treatment effects, correlation between random intercepts and random treatment effects, standard deviation of random time effects, and, for closed cohorts, standard deviation of individual random effects. Alternatively, for a Gaussian family, standard deviations of random effects may be specified using ICC, CAC and, for closed cohorts, IAC; see <code><a href="#topic+swPwr">swPwr</a></code> details. An option to add time point labels is also included.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>swSim(design, family, log.gaussian = FALSE, n, mu0, mu1, time.effect, 
sigma, tau=0, eta=0, rho=0, gamma=0, zeta=0, icc=0, cac=1, iac=0, 
time.lab = NULL, retTimeOnTx=TRUE, silent = FALSE, nocheck=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="swSim_+3A_design">design</code></td>
<td>

<p>list: A stepped wedge design object, typically from <code>swDsn</code>, that includes at least the following components: swDsn, swDsn.unique.clusters, clusters, n.clusters, total.time, nTxLev, TxLev. Fractional treatment effects specified in <code>swDsn</code> are used in the simulation.
</p>
</td></tr>
<tr><td><code id="swSim_+3A_family">family</code></td>
<td>

<p>character: Used in typical way. However, only Gaussian, Binomial, and Poisson families accepted. Also, only identity, logit, and log links accepted.  Logit link is only available for Binomial family, and log link is only available for Binomial and Poisson.  Currently, 'Binomial' implies Bernoulli. Default links are identity for Gaussian, logit for Binomial, log for Posson. ***NOTE: It is the users responsibility to make sure specified parameters (mu0, mu1, time.effect, tau, eta, rho, gamma) are ALL on the SAME scale as the specified link function; see example.***
</p>
</td></tr>
<tr><td><code id="swSim_+3A_log.gaussian">log.gaussian</code></td>
<td>

<p>character: When <code>TRUE</code> with a Gaussian family, simulates data whose log follows a Gaussian distribution; all parameters (mu0, mu1, time.effect, variance parameters) refer to the log scale.  Default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="swSim_+3A_n">n</code></td>
<td>

<p>integer (scalar, vector, or matrix): Number of observations: (scalar) for all clusters and all time points; (vector) for each cluster at all time points; and (matrix) for each cluster at each time point, where rows correspond to clusters and columns correspond to time.  <code>n</code> can also be used to specify a design with transition periods were no data is collected; see <code>swPwr</code>.
</p>
</td></tr>
<tr><td><code id="swSim_+3A_mu0">mu0</code></td>
<td>

<p>numeric (scalar): Mean outcome in the control group on the appropriate scale.
</p>
</td></tr>
<tr><td><code id="swSim_+3A_mu1">mu1</code></td>
<td>

<p>numeric (scalar or vector): Mean outcome in the treatment group on the appropriate scale. If design$nTxLev &gt; 1 (number of treatment levels greater than 1) then <code>mu1</code> should have length equal to <code>design$nTxLev</code>; if <code>design$nTxLev = 1</code> then <code>mu1</code> should be either a scalar (constant treatment effect) or a vector with length equal to the maximum number of exposure times (time-varying treatment effect). Do not specify time-varying or multiple treatment effects if the design includes fractional treatment effects.
</p>
</td></tr>
<tr><td><code id="swSim_+3A_time.effect">time.effect</code></td>
<td>

<p>integer (scalar or vector): Time effect at each time point on the appropriate scale (added to mean at each time).
</p>
</td></tr>
<tr><td><code id="swSim_+3A_sigma">sigma</code></td>
<td>

<p>numeric (scalar): Pooled treatment and control arm standard deviation on the appropriate scale. Ignored if family != Gaussian.
</p>
</td></tr>
<tr><td><code id="swSim_+3A_tau">tau</code></td>
<td>

<p>numeric (scalar): Standard deviation of random intercepts on the appropriate scale. Default is 0.
</p>
</td></tr>
<tr><td><code id="swSim_+3A_eta">eta</code></td>
<td>

<p>numeric (scalar): Standard deviation of random treatment effects on the appropriate scale. Default is 0.
</p>
</td></tr>
<tr><td><code id="swSim_+3A_rho">rho</code></td>
<td>

<p>numeric (scalar): Correlation between random intercepts and random treatment effects on the appropriate scale. Default is 0.
</p>
</td></tr>
<tr><td><code id="swSim_+3A_gamma">gamma</code></td>
<td>

<p>numeric (scalar): Standard deviation of random time effects on the appropriate scale. Default is 0.
</p>
</td></tr>
<tr><td><code id="swSim_+3A_zeta">zeta</code></td>
<td>

<p>numeric (scalar): Standard deviation of individual effects for closed cohort sampling on the appropriate scale. Default is 0 which implies cross-sectional sampling. Values greater than 0 imply closed cohort sampling.
</p>
</td></tr>
<tr><td><code id="swSim_+3A_icc">icc</code></td>
<td>

<p>numeric (scalar): Within-period intra-cluster correlation on the appropriate scale.  Can be used with CAC instead of tau, eta, rho, and gamma when the outcome is Gaussian. Default is 0.
</p>
</td></tr>
<tr><td><code id="swSim_+3A_cac">cac</code></td>
<td>

<p>numeric (scalar): Cluster auto-correlation on the appropriate scale.  Can be used with ICC instead of tau, eta, rho, and gamma when the outcome is Gaussian. Default is 1.
</p>
</td></tr>
<tr><td><code id="swSim_+3A_iac">iac</code></td>
<td>

<p>numeric (scalar): Individual auto-correlation for closed cohort sampling on the appropriate scale. Can be used with ICC and CAC instead of tau, eta, rho, gamma, and zeta when the outcome is gaussian. Default is 0 which implies cross-sectional sampling. Values greater than 0 imply closed cohort sampling.
</p>
</td></tr>
<tr><td><code id="swSim_+3A_time.lab">time.lab</code></td>
<td>

<p>character (vector): Labeling for time points when output is display; choice of labeling does not affect results.
</p>
</td></tr>
<tr><td><code id="swSim_+3A_rettimeontx">retTimeOnTx</code></td>
<td>

<p>This argument has been deprecated. TimeOnTx is always returned.
</p>
</td></tr>
<tr><td><code id="swSim_+3A_silent">silent</code></td>
<td>

<p>logical: if TRUE, hides reminder about order of entries in <code>n</code> when <code>n</code> is not a scalar.  Default value is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="swSim_+3A_nocheck">nocheck</code></td>
<td>

<p>logical: if TRUE, various checks on the validity of the arguments are not done. For internal use only.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When simulating from a Gaussian distribution and if eta (and rho) are 0, instead of using tau, eta, rho, gamma and zeta, the icc, cac and iac can be used to define the variability of the random effects.  In this model,
</p>
<p style="text-align: center;"><code class="reqn"> ICC = \frac{\tau^2+\gamma^2}{\tau^2+\gamma^2+\zeta^2+\sigma^2} </code>
</p>

<p style="text-align: center;"><code class="reqn"> CAC = \frac{\tau^2}{\tau^2+\gamma^2} </code>
</p>

<p style="text-align: center;"><code class="reqn"> IAC = \frac{\zeta^2}{\zeta^2+\sigma^2}</code>
</p>

<p>Choose one parameterization or the other, do not mix parameterizations.
</p>


<h3>Value</h3>

<p>numeric (data frame): Returns the following (individual-level) variables corresponding to the specified SW CRT design:
</p>
<table>
<tr><td><code>$response.var</code></td>
<td>

<p>numeric (vector):  Response variable based on specified SW CRT design of interest (including family and link function) for each observation in the data frame/set.
</p>
</td></tr>
<tr><td><code>$tx.var</code></td>
<td>

<p>numeric (vector): Predictor of interest. (Fractional) treatment effect corresponding to 0=control, 1=treatment, and value between 0 and 1 corresponding to treatment arm with fractional treatment effect (for each observation in the data frame/set).
</p>
</td></tr>
<tr><td><code>$timeOnTx.var</code></td>
<td>

<p>numeric (vector): Predictor of interest when interested in time on treatment lag effect. Total time spent on treatment for each observation in the data frame/set, with 0=control, 1=first time period on treatment, 2=second time period on treatment, etc.
</p>
</td></tr>
<tr><td><code>$time.var</code></td>
<td>

<p>numeric (vector): Time point id for each observation in the data frame/set.
</p>
</td></tr>
<tr><td><code>$cluster.var</code></td>
<td>

<p>numeric (vector): Grouping variable. Cluster id for each observation in the data frame/set.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>James P Hughes, Navneet R Hakhu, and Emily C Voldal
</p>


<h3>References</h3>

<p>Hussey MA, Hughes JP. Design and analysis of stepped wedge cluster randomized trials. Contemporary Clinical Trials 2007;28:182-191.
</p>
<p>Voldal EC, Hakhu NR, Xia, F, Heagerty PJ, Hughes JP. swCRTdesign: An R Package for Stepped Wedge Trial Design and Analysis. Computer Methods and Programs in Biomedicine 2020;196:105514.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(swCRTdesign)
# Example 1 [ n = scalar; can be vector (for different n for each cluster,
# n=rep(120,22)) or matrix (different n for each cluster at each time point,
# n=matrix(120,22,5)) ]

# generate cross-sectional SW data 
design &lt;- swDsn(clusters=c(6,6,6,4))
set.seed(5)
swGenData.nScalar &lt;- swSim( design, family=binomial(link="logit"), n=120,
mu0=log(0.1/0.9), mu1=log(0.9) + log(0.1/0.9), time.effect=0, tau=0.2, eta=0,
rho=0, gamma=0, time.lab=seq(0,12,3))

# summarize SW data by wave
swSummary(response.var, tx.var, time.var, cluster.var, swGenData.nScalar,
type="mean", digits=3)$response.wave

swSummary(response.var, tx.var, time.var, cluster.var, swGenData.nScalar,
type="mean", digits=3)$swDsn

</code></pre>

<hr>
<h2 id='swSimPwr'>
Simulating power for Stepped Wedge Cluster Randomized Trials (SW CRT)
</h2><span id='topic+swSimPwr'></span>

<h3>Description</h3>

<p><code>swSimPwr</code> uses a simulation approach to compute (two-sided) power for the treatment effect(s) from an immediate treatment effect (IT) model or an exposure time indicator (ETI) model (Kenny et al, 2022) for the specified SW CRT design. A cross-sectional or closed cohort sampling scheme can be specified. The outcome of interest can be Gaussian, binomial or Poisson. Individual-level data are generated using <code>swSim</code> for the specified number of clusters per wave, treatment effect (possibly varying according to the exposure time - time after crossing over from control), time effect, family (and link function), number of individuals per cluster per time period, mean in control arm, mean in treatment arm(s), standard deviation (if applicable), standard deviation of random intercepts, standard deviation of random treatment effects, correlation between random intercepts and random treatment effects, standard deviation of random time effects, and, for closed cohorts, standard deviation of individual random effects. For a Gaussian family, standard deviations of random effects may be specified using ICC, CAC and, for closed cohorts, IAC; see <code><a href="#topic+swPwr">swPwr</a></code> details. These data are then analyzed by either <code>lmer</code> or <code>glmer</code> and the proportion of p-values less than or equal to the specified alpha are computed over the nsim simulations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>swSimPwr(design, family, n, mu0, mu1, time.effect=0, H = NULL, 
sigma, tau=0, eta=0, rho=0, gamma=0,zeta=0, icc=0, cac=1, iac=0, 
alpha = 0.05, nsim = 500, retDATA = FALSE, silent = FALSE, counter=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="swSimPwr_+3A_design">design</code></td>
<td>

<p>list: A stepped wedge design object, typically from <code>swDsn</code>, that includes at least the following components: swDsn, swDsn.unique.clusters, clusters, n.clusters, total.time, nTxLev, TxLev. Fractional treatment effects specified in <code>swDsn</code> are used in the simulation.
</p>
</td></tr>
<tr><td><code id="swSimPwr_+3A_family">family</code></td>
<td>

<p>character: Used in typical way. Only Gaussian, Binomial, and Poisson families accepted. Also, only identity, logit, and log links accepted.  Logit link is only available for Binomial family, and log link is only available for Binomial and Poisson.  Currently, 'Binomial' implies Bernoulli. Default links are identity for Gaussian, logit for Binomial, log for Posson. ***NOTE: It is the users responsibility to make sure specified parameters (mu0, mu1, time.effect, tau, eta, rho, gamma, zeta) are ALL on the SAME scale as the specified link function; see example.***
</p>
</td></tr>
<tr><td><code id="swSimPwr_+3A_n">n</code></td>
<td>

<p>integer (scalar, vector, or matrix): Number of observations: (scalar) for all clusters and all time points; (vector) for each cluster at all time points; and (matrix) for each cluster at each time point, where rows correspond to clusters and columns correspond to time.  <code>n</code> can also be used to specify a design with transition periods were no data is collected (a transition period is a period, typically, immediately after treatment is introduced were no data are collected). Simply define <code>n</code> as a matrix with a sample size of 0 during every transition period. This is equivalent to putting an NA in design$swDsn.
</p>
</td></tr>
<tr><td><code id="swSimPwr_+3A_mu0">mu0</code></td>
<td>

<p>numeric (scalar): Mean outcome in the control group on the appropriate scale.
</p>
</td></tr>
<tr><td><code id="swSimPwr_+3A_mu1">mu1</code></td>
<td>

<p>numeric (scalar or vector): Mean outcome in the treatment group on the appropriate scale. If design$nTxLev &gt; 1 (number of treatment levels greater than 1) then mu1 should have length equal to design$nTxLev; if design$nTxLev = 1 then mu1 should be either a scalar (constant treatment effect) or a vector with length equal to the maximum number of exposure times (time-varying treatment effect). Do not specify time-varying or multiple treatment effects if the design includes fractional treatment effects.
</p>
</td></tr>
<tr><td><code id="swSimPwr_+3A_time.effect">time.effect</code></td>
<td>

<p>integer (scalar or vector): Time effect at each time point on the appropriate scale (added to mean at each time). Default is 0.
</p>
</td></tr>
<tr><td><code id="swSimPwr_+3A_h">H</code></td>
<td>

<p>numeric (vector): If NULL, then swPwr assumes an immediate, constant treatment effect (IT) model. If not NULL, then an exposure time indicator (ETI) model is assumed and H should be a vector as long as the longest exposure time (typically, number of time periods minus one). H specifies the desired linear combination of exposure time treatment effects. For example, in a stepped wedge trial with 5 time periods and four exposure times, H = rep(.25,4) gives the average treatment effect over the four exposure times; H = c(0,0,.5,.5) ignores the first two periods after the intervention is introduced and averages the remaining periods. Typically, the sum of H is 1.0; if not, it is renormalized to sum to 1.0. H can only be specified when there is a single intervention level (i.e. design$swDsn includes only NA,0,1; see cautions in help for <code>swDsn</code> about including NA periods when H is used).
</p>
</td></tr>
<tr><td><code id="swSimPwr_+3A_sigma">sigma</code></td>
<td>

<p>numeric (scalar): Pooled treatment and control arm standard deviation on the appropriate scale. Ignored if family != Gaussian.
</p>
</td></tr>
<tr><td><code id="swSimPwr_+3A_tau">tau</code></td>
<td>

<p>numeric (scalar): Standard deviation of random intercepts on the appropriate scale. Default is 0.
</p>
</td></tr>
<tr><td><code id="swSimPwr_+3A_eta">eta</code></td>
<td>

<p>numeric (scalar): Standard deviation of random treatment effects on the appropriate scale. Default is 0.
</p>
</td></tr>
<tr><td><code id="swSimPwr_+3A_rho">rho</code></td>
<td>

<p>numeric (scalar): Correlation between random intercepts and random treatment effects on the appropriate scale. Default is 0.
</p>
</td></tr>
<tr><td><code id="swSimPwr_+3A_gamma">gamma</code></td>
<td>

<p>numeric (scalar): Standard deviation of random time effects on the appropriate scale. Default is 0.
</p>
</td></tr>
<tr><td><code id="swSimPwr_+3A_zeta">zeta</code></td>
<td>

<p>numeric (scalar): Standard deviation of individual effects for closed cohort sampling on the appropriate scale. Default is 0 which implies cross-sectional sampling. Values greater than 0 imply closed cohort sampling.
</p>
</td></tr>
<tr><td><code id="swSimPwr_+3A_icc">icc</code></td>
<td>

<p>numeric (scalar): Within-period intra-cluster correlation on the appropriate scale.  Can be used with CAC instead of tau, eta, rho, and gamma when the outcome is Gaussian. Default is 0.
</p>
</td></tr>
<tr><td><code id="swSimPwr_+3A_cac">cac</code></td>
<td>

<p>numeric (scalar): Cluster auto-correlation on the appropriate scale.  Can be used with ICC instead of tau, eta, rho, and gamma when the outcome is Gaussian. Default is 1.
</p>
</td></tr>
<tr><td><code id="swSimPwr_+3A_iac">iac</code></td>
<td>

<p>numeric (scalar): Individual auto-correlation for closed cohort sampling on the appropriate scale. Can be used with ICC and CAC instead of tau, eta, rho, gamma, and zeta when the outcome is gaussian. Default is 0 which implies cross-sectional sampling. Values greater than 0 imply closed cohort sampling.
</p>
</td></tr>
<tr><td><code id="swSimPwr_+3A_alpha">alpha</code></td>
<td>

<p>numeric (scalar): Desired alpha level for a two-sided test.
</p>
</td></tr>
<tr><td><code id="swSimPwr_+3A_nsim">nsim</code></td>
<td>

<p>numeric (scalar): Number of simulations.
</p>
</td></tr>
<tr><td><code id="swSimPwr_+3A_retdata">retDATA</code></td>
<td>

<p>logical: if FALSE, only power is returned; if TRUE, then estimates, standard errors, p-values and convergence information from all simulations are also returned.
</p>
</td></tr>
<tr><td><code id="swSimPwr_+3A_silent">silent</code></td>
<td>

<p>logical: if TRUE, hides most warning messages.  Default value is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="swSimPwr_+3A_counter">counter</code></td>
<td>

<p>logical: if TRUE, show a counter for the simulations. Default value is <code>TRUE</code>
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>swSimPwr</code> uses a simulation approach to compute the two-sided statistical power for testing the hypotheses <code class="reqn">Ho: \mu_1 - \mu_0 = 0</code> if H is NULL or <code class="reqn">Ho: \sum H*(\mu_1 - \mu_0) = 0</code> if H is non-NULL. swSim is called to generate <code>nsim</code> simulations and then <code>lmer</code> or <code>glmer</code> is used to analyze each simulated dataset. The simulated power is equal to the proportion of p-values from <code>lmer</code>/<code>glmer</code> that are less than or equal to alpha. For small sample sizes it is recommended that the user run a simulation under the null to check the accuracy of the simulated type I error rate. Optionally, a counter is printed as each simulation is completed.
</p>


<h3>Value</h3>

<p>numeric (vector): if <code>retDATA = FALSE</code>, <code>swSimPwr</code> returns the power for the two-sided design$nTxLev hypothesis test(s) treatment effect(s) against a null of 0.0.
</p>
<p>numeric (list): if <code>retDATA = TRUE</code>, <code>swSimPwr</code> returns the following objects of a list.
</p>
<table>
<tr><td><code>power</code></td>
<td>

<p>Power for the two-sided design$nTxLev hypothesis test(s) of treatment effect(s) against a null of 0.0.
</p>
</td></tr>
<tr><td><code>nsim</code></td>
<td>

<p>Number of simulation power is based on
</p>
</td></tr>
<tr><td><code>est</code></td>
<td>

<p>matrix: nsim x design$nTxLev matrix of estimated treatment effects. If H is specified then this is the linear combination of the exposure time estimates.
</p>
</td></tr>
<tr><td><code>se</code></td>
<td>

<p>matrix: nsim x design$nTxLev matrix of standard errros of the estimated treatment effects. If H is specified then this is the standard error of the linear combination of the exposure time estimates.
</p>
</td></tr>
<tr><td><code>sdcor</code></td>
<td>

<p>matrix: matrix with nsim rows and number of columns equal to the number of variance components in the model (expressed on the random effects scale) giving the estimated variance components (expressed as standard deviations) from each fit. Note that eta is expressed as a correlation.
</p>
</td></tr>
<tr><td><code>df</code></td>
<td>

<p>matrix: nsim x design$nTxLev matrix of degrees of freedom for testing the hypotheses on the treatment effect(s). Only returned if lmer is called for estimation; otherwise NULL.
</p>
</td></tr>
<tr><td><code>pval</code></td>
<td>

<p>matrix: nsim x design$nTxLev matrix of p-values for testing the hypotheses on the treatment effect(s). 
</p>
</td></tr>
<tr><td><code>code</code></td>
<td>

<p>vector: vector of length <code>nsim</code> giving either 0 (convergence) or the value of rslt@optinfo$conv$lme4$code for each simulation 
</p>
</td></tr>
<tr><td><code>msg</code></td>
<td>

<p>vector: vector of length <code>nsim</code> giving all messages from rslt@optinfo$conv$lme4$messages for each simulation
</p>
</td></tr>
</table>


<h3>References</h3>

<p>Kenny A, Voldal E, Xia F, Heagerty PJ, Hughes JP. Analysis of stepped wedge cluster randomized trials in the presence of a time-varying treatment effect. Statistics in Medicine, in press, 2022.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>logit = function(x){log(x/(1 - x))}
stdy1 &lt;- swDsn(c(6,6,6,6),swBlk=matrix(c(0,1,1,1,1,0,0,1,1,1,0,0,0,1,1,0,0,0,0,1),4,5,byrow=TRUE))
# analytic power by swPwr
swPwr(stdy1, distn="binomial",n=120, mu0=0.45, mu1=0.5, 
      tau=0.1, alpha=0.05, retDATA=FALSE)
# 
# equivalent analysis on logit scale with transformation of variables
swGlmPwr(stdy1,distn="binomial",n=120,fixed.intercept=logit(0.45),
         fixed.treatment.effect = logit(0.5)-logit(0.45), fixed.time.effect=0.0,
         tau=.1/(.475*.525))
#
# Same problem by simulation using three different approaches
#
#swSimPwr(stdy1,family=binomial(link="logit"),n=120,
#         mu0=logit(.45),mu1=logit(.5),time.effect=0.0,
#         tau=.1/(.475*.525),nsim=500)  
#
#swSimPwr(stdy1,family="gaussian",n=120,
#         mu0=.45,mu1=.5,time.effect=0.0,
#         sigma=sqrt(.475*.525),tau=.1,nsim=500) 
#
#swSimPwr(stdy1,family=binomial(link="identity"),n=120,
#         mu0=.45,mu1=0.5,time.effect=0.0,
#         tau=.1,nsim=500)
</code></pre>

<hr>
<h2 id='swSummary'>
Summary of Response/Outcome for Stepped Wedge Cluster Randomized Trial (SW CRT)
</h2><span id='topic+swSummary'></span>

<h3>Description</h3>

<p><code>swSummary</code> returns the mean, sum, and number of non-missing values for the response/outcome variable of interest for each cluster at each time point from a SW CRT.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>swSummary(response.var, tx.var, time.var, cluster.var, data, 
type="mean", digits=16, fcn.Call=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="swSummary_+3A_response.var">response.var</code></td>
<td>

<p>numeric(vector): Response (Outcome) variable.
</p>
</td></tr>
<tr><td><code id="swSummary_+3A_tx.var">tx.var</code></td>
<td>

<p>numeric(vector): Treatment (Predictor of Interest) variable. Typically, 0=placebo, 1=intervention, and values greater than 1 correspond to other treatment levels. 
</p>
</td></tr>
<tr><td><code id="swSummary_+3A_time.var">time.var</code></td>
<td>

<p>integer(vector): Time (points) variable, corresponding to the time points when data were collected during the SW CRT.
</p>
</td></tr>
<tr><td><code id="swSummary_+3A_cluster.var">cluster.var</code></td>
<td>

<p>integer(vector): Cluster (identification) variable, corresponding to the cluster where an individual is from.
</p>
</td></tr>
<tr><td><code id="swSummary_+3A_data">data</code></td>
<td>

<p>An optional data frame containing (at least) the response, treatment (tx), time, and cluster variables.
</p>
</td></tr>
<tr><td><code id="swSummary_+3A_type">type</code></td>
<td>

<p>character (scalar): Specify which summary measure is of interest from <code>"mean"</code>, <code>"sum"</code>, and <code>"n"</code>. (Note: The default returns &quot;mean&quot; as the summary measure of response. Note that all summary measures may not be scientifically relevant in every situation.)
</p>
</td></tr>
<tr><td><code id="swSummary_+3A_digits">digits</code></td>
<td>

<p>integer (scalar): Number of places right of the decimal. The default value is 16.
</p>
</td></tr>
<tr><td><code id="swSummary_+3A_fcn.call">fcn.Call</code></td>
<td>

<p>logical: Only <code>TRUE</code> when calling <code>swSummary</code> from within <code>swPlot</code>. The default is <code>FALSE</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Returns a list containing a matrix of dimension <code>length(unique(data$cluster))</code> by <code>length(</code> <code>unique(data$time))</code> that summarizes <code>data$response</code> for specified <code>type</code>. Either the mean, sum, or the number of non-missing <code>data$response</code> values may be requested using <code>type</code>. <code>dimnames</code> of the matrix correspond to the unique values of cluster and time. Note that the stepping pattern in the data may be obtained by specifying the treatment variable name as the response and <code>type = "mean"</code>.
</p>


<h3>Value</h3>

<p>numeric (list): <code>swSummary</code> returns a list containing the following
</p>
<table>
<tr><td><code>type</code></td>
<td>

<p>One of user-specified options <code>"mean"</code>, <code>"sum"</code>, or <code>"n"</code>.
</p>
</td></tr>
<tr><td><code>swDsn</code></td>
<td>

<p>The SW design.		
</p>
</td></tr>
<tr><td><code>swDsn.unique.clusters</code></td>
<td>

<p>The unique clusters (i.e., rows) SW design.		
</p>
</td></tr>
<tr><td><code>n.waves</code></td>
<td>

<p>Number of waves. Note that this is usually, but not necessarily, the same as data$n.waves. See example 2.
</p>
</td></tr>
<tr><td><code>clusters</code></td>
<td>

<p>Clusters per wave.		
</p>
</td></tr>
<tr><td><code>n.clusters</code></td>
<td>

<p>Total number of clusters.		
</p>
</td></tr>
<tr><td><code>time.at.each.wave</code></td>
<td>

<p>Time at each wave.		
</p>
</td></tr>
<tr><td><code>total.time</code></td>
<td>

<p>Total time points.		
</p>
</td></tr>
<tr><td><code>response.cluster</code></td>
<td>

<p>numeric (matrix): Response variable summarized according to <code>type</code> for all clusters, with dimension 
<code>length(data$cluster)</code> by <code>length(unique(data$time))</code>.
</p>
</td></tr>
<tr><td><code>response.wave</code></td>
<td>

<p>numeric (matrix): Response variable summarized according to <code>type</code>, for all waves (all clusters of a particular wave are combined), with dimension <code>length(</code> <code>unique(data$cluster))</code> by <code>length(unique(data$time))</code>.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>James P Hughes and Navneet R Hakhu
</p>


<h3>References</h3>

<p>Hussey MA, Hughes JP. Design and analysis of stepped wedge cluster randomized trials. Contemporary Clinical Trials 2007;28:182-191.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(swCRTdesign)
# Example 1 
# Generate binary response with 5 clusters, 4 time points
data.Ex1 &lt;- swSim(swDsn(c(2,2,1)),family=binomial(link="identity"), n=120,
                     mu0=0.25, mu1=0.30,time.effect=0, tau=0.05, gamma=.01)

## Example 1 (type="mean", by cluster and by wave)
swSummary.Ex1.mean &lt;- swSummary(response.var, tx.var, time.var, cluster.var, 
data=data.Ex1, type="mean", digits=3)

swSummary.Ex1.mean$response.cluster

swSummary.Ex1.mean$response.wave

# Example 1 (type="sum", by cluster and by wave)
swSummary.Ex1.sum &lt;- swSummary(response.var, tx.var, time.var, cluster.var, 
data=data.Ex1, type="sum")

swSummary.Ex1.sum$response.cluster

swSummary.Ex1.sum$response.wave

## Example 1 (type="n", by cluster and by wave)
swSummary.Ex1.n &lt;- swSummary(response.var, tx.var, time.var, cluster.var, 
data=data.Ex1, type="n")

swSummary.Ex1.n$response.cluster

swSummary.Ex1.n$response.wave

## Example 2
design2 &lt;- swDsn(clusters=c(6,6,6,6)) 
# design2$n.waves says 4 waves
nmat2 = rbind(matrix(rep(c(120,120,120,120,120),6),6,5,byrow=TRUE),
              matrix(rep(c(120,120,120,120,120),3),3,5,byrow=TRUE),
              matrix(rep(c(0,120,120,120,120),3),3,5,byrow=TRUE),
              matrix(rep(c(0,0,120,120,120),6),6,5,byrow=TRUE),
              matrix(rep(c(0,0,0,120,120),6),6,5,byrow=TRUE))
swGenData2 &lt;- swSim( design2,family=binomial(link="logit"), n=nmat2,
                     mu0=log(0.1/0.9), mu1=log(0.9) + log(0.1/0.9),
                     time.effect=0, tau=0.2, time.lab=seq(0,12,3))
swSummary(response.var, tx.var, time.var, cluster.var, swGenData2,
          type="mean", digits=3)
# This summary create 5 waves
#
# The following is equivalent to above
design2b &lt;- swDsn(c(6,3,3,6,6),
                   swBlk=matrix(c(0,1,1,1,1,
                                  0,0,1,1,1,
                                  NA,0,1,1,1,
                                  NA,NA,0,1,1,
                                  NA,NA,NA,0,1),5,5,byrow=TRUE)) 
# design2b$n.waves says 5 waves
swGenData2b &lt;- swSim(design2b,family=binomial(link="logit"), n=120,
                      mu0=log(0.1/0.9), mu1=log(0.9) + log(0.1/0.9),
                      time.effect=0, tau=0.2, time.lab=seq(0,12,3))
swSummary(response.var, tx.var, time.var, cluster.var, swGenData2b,
          type="mean", digits=3)
# This summary create 5 waves          
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
