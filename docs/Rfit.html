<!DOCTYPE html><html lang="en"><head><title>Help for package Rfit</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {Rfit}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Rfit-package'><p> Rank-Based Estimates and Inference for Linear Models</p></a></li>
<li><a href='#allscores'><p> All Scores</p></a></li>
<li><a href='#baseball'><p>Baseball Card Data</p></a></li>
<li><a href='#bbsalaries'><p>Baseball Salaries</p></a></li>
<li><a href='#BoxCox'>
<p>Box and Cox (1964) data.</p></a></li>
<li><a href='#CardioRiskFactors'>
<p>Cardiovascular risk factors</p></a></li>
<li><a href='#confintadjust'><p> Confidence interval adjustment methods</p></a></li>
<li><a href='#disp'><p> Jaeckel's Dispersion Function</p></a></li>
<li><a href='#drop.test'><p> Drop (Reduction) in Dispersion Test</p></a></li>
<li><a href='#ffa'>
<p>Free Fatty Acid Data</p></a></li>
<li><a href='#getScores-methods'><p> ~~ Methods for Function getScores  ~~</p></a></li>
<li><a href='#getScoresDeriv-methods'><p> ~~ Methods for Function getScoresDeriv  ~~</p></a></li>
<li><a href='#gettau'><p>Estimate of the scale parameter tau</p></a></li>
<li><a href='#grad'><p> Calculate the Gradiant of Jaeckel's Dispersion Function</p></a></li>
<li><a href='#jaeckel'><p> Function to Minimize Jaeckel's Dispersion Function</p></a></li>
<li><a href='#kwayr'>
<p>Internal Functions for K-Way analysis of variance</p></a></li>
<li><a href='#oneway.rfit'><p> Rank-based Oneway Analysis of Variance</p></a></li>
<li><a href='#param-class'><p>Class &quot;param&quot;</p></a></li>
<li><a href='#print.rfit'><p> Rfit Internal Print Functions</p></a></li>
<li><a href='#quail'><p> Quail Data</p></a></li>
<li><a href='#raov'>
<p>R ANOVA</p></a></li>
<li><a href='#rfit'><p> Rank-based Estimates of Regression Coefficients</p></a></li>
<li><a href='#rstudent.rfit'><p> Studentized Residuals for Rank-Based Regression</p></a></li>
<li><a href='#scores-class'><p>Class &quot;scores&quot;</p></a></li>
<li><a href='#serumLH'>
<p>Serum Level of luteinizing hormone (LH)</p></a></li>
<li><a href='#signedrank'><p> Signed-Rank Estimate of Location (Intercept)</p></a></li>
<li><a href='#summary.oneway.rfit'>
<p>Provides a summary for the oneway anova based on an R fit.</p></a></li>
<li><a href='#summary.rfit'><p> Summarize Rank-Based Linear Model Fits</p></a></li>
<li><a href='#taufuncs'><p> Internal Functions for Estimating tau</p></a></li>
<li><a href='#taustar'><p> Estimate of the Scale Parameter taustar</p></a></li>
<li><a href='#telephone'><p> Telephone Data</p></a></li>
<li><a href='#vcov.rfit'><p> Variance-Covariance Matrix for Rank-Based Regression</p></a></li>
<li><a href='#wald.test.overall'><p>Overall Wald test</p></a></li>
<li><a href='#walsh'><p>Walsh Averages</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Rank-Based Estimation for Linear Models</td>
</tr>
<tr>
<td>Version:</td>
<td>0.27.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-05-25</td>
</tr>
<tr>
<td>Author:</td>
<td>John Kloke, Joseph McKean</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>John Kloke &lt;johndkloke@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Rank-based (R) estimation and inference for linear models.  Estimation
        is for general scores and a library of commonly used score
        functions is included.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>Depends:</td>
<td>methods</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-05-25 17:10:20 UTC; john</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-05-25 17:50:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='Rfit-package'> Rank-Based Estimates and Inference for Linear Models</h2><span id='topic+Rfit-package'></span><span id='topic+Rfit'></span>

<h3>Description</h3>

<p>Package provides functions for rank-based analyses of linear models.
Rank-based estimation and inference offers a robust alternative to least squares.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> Rfit</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 0.27.0</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2024-05-25</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;">  GPL (version 2 or later)</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>John Kloke, Joesph McKean
</p>
<p>Maintainer: John Kloke &lt;johndkloke@gmail.com&gt;
</p>


<h3>References</h3>

<p>Hettmansperger, T.P. and McKean J.W. (2011), <em>Robust Nonparametric Statistical Methods, 2nd ed.</em>, New York: Chapman-Hall.
</p>
<p>Jaeckel, L. A. (1972). Estimating regression coefficients by minimizing the dispersion of residuals. <em>Annal
s of Mathematical Statistics</em>, 43, 1449 - 1458.
</p>
<p>Jureckova, J. (1971). Nonparametric estimate of regression coefficients. <em>Annals of Mathematical Statistics
</em>, 42, 1328 - 1338.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(baseball)
data(wscores)
fit&lt;-rfit(weight~height,data=baseball)
summary(fit)
plot(fitted(fit),rstudent(fit))

### Example of the Reduction (Drop) in dispersion test ###
y&lt;-rnorm(47)
x1&lt;-rnorm(47)
x2&lt;-rnorm(47)
fitF&lt;-rfit(y~x1+x2)
fitR&lt;-rfit(y~x1)
drop.test(fitF,fitR)



</code></pre>

<hr>
<h2 id='allscores'> All Scores </h2><span id='topic+wscores'></span><span id='topic+nscores'></span><span id='topic+bentscores1'></span><span id='topic+bentscores2'></span><span id='topic+bentscores3'></span><span id='topic+bentscores4'></span><span id='topic+logGFscores'></span><span id='topic+logrank.scores'></span>

<h3>Description</h3>

<p>An object of class scores which includes the score function and it's derivative for rank-based regression inference.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(wscores)</code></pre>


<h3>Format</h3>

<p>The format is:
Formal class 'scores' [package &quot;.GlobalEnv&quot;] with 2 slots
..@ phi :function (u)  
..@ Dphi:function (u)  
</p>


<h3>Details</h3>

<p>Using Wilcoxon (linear) scores leads to inference which has ARE of 0.955 to least squares (ML) when the data are normal.
Wilcoxon scores are optimal when the underlying error distribution is logistic.
Normal scores are optimal when the data are normally distributed.
Log-rank scores are optimal when the data are from an exponential distribution, e.g. in a proportional hazards model.
Log-Generalized F scores can also be used in the analysis of survival data (see Hettmansperger and McKean p. 233).
</p>
<p>bentscores1 are recommended for right-skewed distributions.
bentscores2 are recommended for light-tailed distributions.
bentscores3 are recommended for left-skewed distributions.
bentscores4 are recommended for heavy-tailed distributions.
</p>


<h3>References</h3>

<p>Hettmansperger, T.P. and McKean J.W. (2011), <em>Robust Nonparametric Statistical Methods, 2nd ed.</em>, New York: Chapman-Hall.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>u &lt;- seq(0.01,0.99,by=0.01)
plot(u,getScores(wscores,u),type='l',main='Wilcoxon Scores')
plot(u,getScores(nscores,u),type='l',main='Normal Scores')

data(wscores)
x&lt;-runif(50)
y&lt;-rlogis(50)
rfit(y~x,scores=wscores)

x&lt;-rnorm(50)
y&lt;-rnorm(50)
rfit(y~x,scores=nscores)

</code></pre>

<hr>
<h2 id='baseball'>Baseball Card Data</h2><span id='topic+baseball'></span>

<h3>Description</h3>

<p>These data come from the back-side of 59 baseball cards that Carrie had.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(baseball)</code></pre>


<h3>Format</h3>

<p>A data frame with 59 observations on the following 6 variables.
</p>

<dl>
<dt><code>height</code></dt><dd><p>Height in inches</p>
</dd>
<dt><code>weight</code></dt><dd><p>Weight in pounds</p>
</dd>
<dt><code>bat</code></dt><dd><p>a factor with levels <code>L</code> <code>R</code> <code>S</code></p>
</dd>
<dt><code>throw</code></dt><dd><p>a factor with levels <code>L</code> <code>R</code></p>
</dd>
<dt><code>field</code></dt><dd><p>a factor with levels <code>0</code> <code>1</code></p>
</dd>
<dt><code>average</code></dt><dd><p>ERA if the player is a pitcher and his batting average if the player is a fielder</p>
</dd>
</dl>



<h3>Source</h3>

<p>Hettmansperger, T.P. and McKean J.W. (2011), <em>Robust Nonparametric Statistical Methods, 2nd ed.</em>, New York: Chapman-Hall.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(baseball)
wilcox.test(height~field,data=baseball)
rfit(weight~height,data=baseball)
</code></pre>

<hr>
<h2 id='bbsalaries'>Baseball Salaries</h2><span id='topic+bbsalaries'></span>

<h3>Description</h3>

<p>Salaries of 176 professional baseball players for the 1987 season.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(bbsalaries)</code></pre>


<h3>Format</h3>

<p>A data frame with 176 observations on the following 8 variables.
</p>

<dl>
<dt><code>logYears</code></dt><dd><p>Log of the number of years experience</p>
</dd>
<dt><code>aveWins</code></dt><dd><p>Average wins per year</p>
</dd>
<dt><code>aveLosses</code></dt><dd><p>Average losses per year</p>
</dd>
<dt><code>era</code></dt><dd><p>Earned Run Average</p>
</dd>
<dt><code>aveGames</code></dt><dd><p>Average games pitched in per year</p>
</dd>
<dt><code>aveInnings</code></dt><dd><p>Average number of innings pitched per year</p>
</dd>
<dt><code>aveSaves</code></dt><dd><p>Average number of saves per year</p>
</dd>
<dt><code>logSalary</code></dt><dd><p>Log of the base salary in dollars</p>
</dd>
</dl>



<h3>Source</h3>

<p>http://lib.stat.cmu.edu/datasets/baseball.data
</p>


<h3>References</h3>

<p>Hettmansperger, T.P. and McKean J.W. (2011), <em>Robust Nonparametric Statistical Methods, 2nd ed.</em>, New York: Chapman-Hall.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(bbsalaries)
summary(rfit(logSalary~logYears+aveWins+aveLosses+era+aveGames+aveInnings+aveSaves,data=bbsalaries))
</code></pre>

<hr>
<h2 id='BoxCox'>
Box and Cox (1964) data.
</h2><span id='topic+BoxCox'></span>

<h3>Description</h3>

<p>The data are  the results of a 3 * 4 two-way design, where
forty-eight animals were exposed to three different poisons and four different treatments.
The design is balanced with four replications per cell.
The response was the log survival time of the animal.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(BoxCox)</code></pre>


<h3>Format</h3>

<p>A data frame with 48 observations on the following 3 variables.
</p>

<dl>
<dt><code>logSurv</code></dt><dd><p>log Survival Time</p>
</dd>
<dt><code>Poison</code></dt><dd><p>a factor indicating poison level</p>
</dd>
<dt><code>Treatment</code></dt><dd><p>a factor indicating treatment level</p>
</dd>
</dl>



<h3>Source</h3>

<p>Box, G.E.P. and Cox, D.R. (1964), An analysis of transformations, <em> Journal of the Royal Statistical Society, Series B, Methodological</em>, 26, 211-252.
</p>


<h3>References</h3>

<p>Hettmansperger, T.P. and McKean J.W. (2011), <em>Robust Nonparametric Statistical Methods, 2nd ed.</em>, New York: Chapman-Hall.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(BoxCox)
with(BoxCox,interaction.plot(Treatment,Poison,logSurv,median))
raov(logSurv~Poison+Treatment,data=BoxCox)
</code></pre>

<hr>
<h2 id='CardioRiskFactors'>
Cardiovascular risk factors
</h2><span id='topic+CardioRiskFactors'></span>

<h3>Description</h3>

<p>Data from a study to investigate assocation between uric acid and various cardiovascular risk factors in developing countries (Heritier et. al. 2009).
There are 474 men and 524 women aged 25-64.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(CardioRiskFactors)</code></pre>


<h3>Format</h3>

<p>A data frame with 998 observations on the following 14 variables.
</p>

<dl>
<dt><code>age</code></dt><dd><p>Age of subject</p>
</dd>
<dt><code>bmi</code></dt><dd><p>Body Mass Index</p>
</dd>
<dt><code>waisthip</code></dt><dd><p>waist/hip ratio(?)</p>
</dd>
<dt><code>smok</code></dt><dd><p>indicator for regular smoker</p>
</dd>
<dt><code>choles</code></dt><dd><p>total cholesterol</p>
</dd>
<dt><code>trig</code></dt><dd><p>triglycerides level in body fat</p>
</dd>
<dt><code>hdl</code></dt><dd><p>high-density lipoprotien(?)</p>
</dd>
<dt><code>ldl</code></dt><dd><p>low-density lipoprotein</p>
</dd>
<dt><code>sys</code></dt><dd><p>systolic blood pressure</p>
</dd>
<dt><code>dia</code></dt><dd><p>diastolic blood pressure(?)</p>
</dd>
<dt><code>Uric</code></dt><dd><p>serum uric</p>
</dd>
<dt><code>sex</code></dt><dd><p>indicator for male</p>
</dd>
<dt><code>alco</code></dt><dd><p>alcohol intake (mL/day)</p>
</dd>
<dt><code>apoa</code></dt><dd><p>apoprotein A</p>
</dd>
</dl>



<h3>Details</h3>

<p>Data set and description taken from Heritier et. al. (2009) (c.f. Conen et. al. 2004).
</p>


<h3>Source</h3>

<p>Heritier, S., Cantoni, E., Copt, S., and Victoria-Feser, M. (2009), <em>Robust Methods in Biostatistics</em>, New York: John Wiley and Sons.
</p>
<p>Conen, D., Wietlisbach, V., Bovet, P., Shamlaye, C., Riesen, W., Paccaud, F., and Burnier, M. (2004), Prevalence of hyperuricemia and relation of serum uric acid with cardiovascular risk factors in a developing country.
<em>BMC Public Health</em>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(CardioRiskFactors)
fitF&lt;-rfit(Uric~bmi+sys+choles+ldl+sex+smok+alco+apoa+trig+age,data=CardioRiskFactors)
fitR&lt;-rfit(Uric~bmi+sys+choles+ldl+sex,data=CardioRiskFactors)
drop.test(fitF,fitR)
summary(fitR)
</code></pre>

<hr>
<h2 id='confintadjust'> Confidence interval adjustment methods </h2><span id='topic+confintadjust'></span><span id='topic+confintadjust.methods'></span>

<h3>Description</h3>

<p>Returns the critical value to be used in calculating adjusted confidence intervals.
Currently provides methods for Boneferroni and Tukey for confidence interval adjustment methods as well as no adjustment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>confintadjust(n, k, alpha = 0.05, method = confintadjust.methods, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="confintadjust_+3A_n">n</code></td>
<td>

<p>sample size
</p>
</td></tr>
<tr><td><code id="confintadjust_+3A_k">k</code></td>
<td>

<p>number of comparisons
</p>
</td></tr>
<tr><td><code id="confintadjust_+3A_alpha">alpha</code></td>
<td>

<p>overall (experimentwise) type I error rate
</p>
</td></tr>
<tr><td><code id="confintadjust_+3A_method">method</code></td>
<td>

<p>one of confintadjust.methods
</p>
</td></tr>
<tr><td><code id="confintadjust_+3A_...">...</code></td>
<td>

<p>Additonal arguments.  Currently not used.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Returns critial value based on one of the adjustment methods.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>cv</code></td>
<td>
<p>critical value</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>the method used</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Joseph McKean, John Kloke
</p>


<h3>References</h3>

<p>Hettmansperger, T.P. and McKean J.W. (2011), <em>Robust Nonparametric Statistical Methods, 2nd ed.</em>, New York: Chapman-Hall.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+oneway.rfit">oneway.rfit</a></code>
</p>

<hr>
<h2 id='disp'> Jaeckel's Dispersion Function </h2><span id='topic+disp'></span>

<h3>Description</h3>

<p>Returns the value of Jaeckel's dispersion function for given values of the regression coefficents.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>disp(beta, x, y, scores)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="disp_+3A_beta">beta</code></td>
<td>
<p> p by 1 vector of regression coefficents </p>
</td></tr>
<tr><td><code id="disp_+3A_x">x</code></td>
<td>
<p> n by p design matrix </p>
</td></tr>
<tr><td><code id="disp_+3A_y">y</code></td>
<td>
<p> n by 1 response vector </p>
</td></tr>
<tr><td><code id="disp_+3A_scores">scores</code></td>
<td>
<p> an object of class scores </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Returns the value of Jaeckel's disperion function evaluated 
at the value of the parameters in the function call.
That is,
<code class="reqn">sum_{i=1}^n a(R(e_i)) * e_i</code> where 
R denotes rank
and a(1) &lt;= a(2) &lt;= ... &lt;= a(n) are the scores.
The residuals (e_i i=1,...n) are calculated y - x beta.
</p>


<h3>Author(s)</h3>

<p>John Kloke, Joseph McKean</p>


<h3>References</h3>

 
<p>Hettmansperger, T.P. and McKean J.W. (2011), <em>Robust Nonparametric Statistical Methods, 2nd ed.</em>, New York: Chapman-Hall.
</p>
<p>Jaeckel, L. A. (1972). Estimating regression coefficients by minimizing the dispersion of residuals. <em>Annals of Mathematical Statistics</em>, 43, 1449 - 1458.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rfit">rfit</a></code>
<code><a href="#topic+drop.test">drop.test</a></code>
<code><a href="#topic+summary.rfit">summary.rfit</a></code>
</p>

<hr>
<h2 id='drop.test'> Drop (Reduction) in Dispersion Test </h2><span id='topic+drop.test'></span>

<h3>Description</h3>

<p>Given two full model fits, this function performs a reduction in dispersion test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>drop.test(fitF, fitR = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="drop.test_+3A_fitf">fitF</code></td>
<td>
<p> An object of class rfit.  The full model fit. </p>
</td></tr>
<tr><td><code id="drop.test_+3A_fitr">fitR</code></td>
<td>
<p> An object of class rfit.  The reduced model fit. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Rank-based inference procedure analogous to the traditional (LS) reduced model test.
</p>
<p>The full and reduced model dispersions are calculated.
The reduction in dispersion test, or drop test for short, has an asymptotic chi-sq
distribution.
Simulation studies suggest using F critical values.
The p-value returned is based on a F-distribution with df1 and df2 degrees of freedom
where df1 is the difference in the number of parameters in the fits of fitF and fitR
and df2 is the residual degrees of freedom in the fit fitF.
</p>
<p>Both fits are based on a minimization routine.
It is possible that resulting solutions are such that the fitF$disp &gt; fitRdisp.
We recommend starting the full model at the reduced model fit as a way to avoid this situation.
See examples.
</p>
<p>Checks to see if models appear to be proper subsets.  
The space spanned by the columns of the reduced model design matrix should be a subset of the space spanned by the columns of the full model design matrix.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>F</code></td>
<td>
<p>Value of the F test statistic</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>The observed significance level of the test (using an F quantile)</p>
</td></tr>
<tr><td><code>RD</code></td>
<td>
<p>Reduced model dispersion minus Full model dispersion</p>
</td></tr>
<tr><td><code>tauhat</code></td>
<td>
<p>Estimate of the scale parameter (using the full model residuals)</p>
</td></tr>
<tr><td><code>df1</code></td>
<td>
<p>numerator degrees of freedom</p>
</td></tr>
<tr><td><code>df2</code></td>
<td>
<p>denominator degrees of freedom</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>John Kloke, Joseph McKean</p>


<h3>References</h3>

 
<p>Hettmansperger, T.P. and McKean J.W. (2011), <em>Robust Nonparametric Statistical Methods, 2nd ed.</em>, New York: Chapman-Hall.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+rfit">rfit</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>y&lt;-rnorm(47)
x1&lt;-rnorm(47)
x2&lt;-rnorm(47)
fitF&lt;-rfit(y~x1+x2)
fitR&lt;-rfit(y~x1)
drop.test(fitF,fitR)

## try starting the full model at the reduced model fit ##
fitF&lt;-rfit(y~x1+x2,yhat0=fitR$fitted)
drop.test(fitF,fitR)
</code></pre>

<hr>
<h2 id='ffa'>
Free Fatty Acid Data
</h2><span id='topic+ffa'></span>

<h3>Description</h3>

<p>The response variable is level of free fatty acid in a sample of prepubescent boys. The explanatory variables are age (in months), weight (in lbs), and skin fold thickness.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ffa)</code></pre>


<h3>Format</h3>

<p>A data frame with 41 rows and 4 columns.
</p>

<dl>
<dt><code>age</code></dt><dd><p> age in years </p>
</dd>
<dt><code>weight</code></dt><dd><p> weight in lbs </p>
</dd>
<dt><code>skin</code></dt><dd><p> skin fold thinkness </p>
</dd>
<dt><code>ffa</code></dt><dd><p>  free fatty acid </p>
</dd>
</dl>



<h3>Source</h3>

<p>Morrison, D.F. (1983), <em>Applied Linear Statistical Models</em>, Englewood Cliffs, NJ:Prentice Hall.
</p>


<h3>References</h3>

<p>Hettmansperger, T.P. and McKean J.W. (2011), <em>Robust Nonparametric Statistical Methods, 2nd ed.</em>, New York: Chapman-Hall.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ffa)
summary(rfit(ffa~age+weight+skin,data=ffa))  #using the default (Wilcoxon scores)
summary(rfit(ffa~age+weight+skin,data=ffa,scores=bentscores1))
</code></pre>

<hr>
<h2 id='getScores-methods'> ~~ Methods for Function getScores  ~~</h2><span id='topic+getScores-methods'></span><span id='topic+getScores+2Cscores-method'></span><span id='topic+getScores'></span>

<h3>Description</h3>

<p>~~ Methods for function <code>getScores</code>  ~~
Calculates the centered and scaled scores as used in rank-based analysis.
</p>


<h3>Methods</h3>


<dl>
<dt><code>signature(object = "scores")</code></dt><dd>
</dd>
</dl>


<h3>See Also</h3>

<p><code><a href="#topic+rfit">rfit</a></code></p>

<hr>
<h2 id='getScoresDeriv-methods'> ~~ Methods for Function getScoresDeriv  ~~</h2><span id='topic+getScoresDeriv-methods'></span><span id='topic+getScoresDeriv+2Cscores-method'></span><span id='topic+getScoresDeriv'></span>

<h3>Description</h3>

<p>~~ Methods for function <code>getScoresDeriv</code>  ~~
This derivative is used in the estimate of the scale parameter tau.
</p>


<h3>Methods</h3>


<dl>
<dt><code>signature(object = "scores")</code></dt><dd>
</dd>
</dl>


<h3>See Also</h3>

<p><code><a href="#topic+rfit">rfit</a></code></p>

<hr>
<h2 id='gettau'>Estimate of the scale parameter tau</h2><span id='topic+gettau'></span><span id='topic+gettauF0'></span>

<h3>Description</h3>

<p>An estimate of the scale parameter tau may be used for the standard errors of the coefficients in rank-based regression.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gettau(ehat, p, scores = Rfit::wscores, delta = 0.8, hparm = 2, ...)
gettauF0(ehat, p, scores = Rfit::wscores, delta = 0.8, hparm = 2, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gettau_+3A_ehat">ehat</code></td>
<td>
<p>vector of length n: full model residuals </p>
</td></tr>
<tr><td><code id="gettau_+3A_p">p</code></td>
<td>
<p>scalar: number of regression coefficients (excluding the intercept); see Details</p>
</td></tr>
<tr><td><code id="gettau_+3A_scores">scores</code></td>
<td>
<p> object of class scores, defaults to Wilcoxon scores</p>
</td></tr>
<tr><td><code id="gettau_+3A_delta">delta</code></td>
<td>
<p> confidence level; see Details</p>
</td></tr>
<tr><td><code id="gettau_+3A_hparm">hparm</code></td>
<td>
<p> used in Huber's degrees of freedom correction; see Details</p>
</td></tr>
<tr><td><code id="gettau_+3A_...">...</code></td>
<td>
<p> additional arguments. currently unused </p>
</td></tr>
</table>


<h3>Details</h3>

<p>For rank-based analyses of linear models, the estimator <code class="reqn">\hat{\tau}</code> of the scale parameter <code class="reqn">\tau</code> plays a standardizing role in the standard errors (SE) of the rank-based estimators of the regression coefficients and in the denominator of Wald-type and the drop-in-dispersion test statistics of linear hypotheses.
<code>rfit</code> currently implements the KSM (Koul, Sievers, and McKean 1987) estimator of tau.   
</p>
<p>The functions <code>gettau</code> and <code>gettauF0</code> are both available to compute the KSM estimate and may be call from <code>rfit</code> and used for inference.  The default is to use the faster FORTRAN version <code>gettauF0</code> via the to option <code>TAU='F0'</code>.
The R version, <code>gettau</code>, may be much slower especially when sample sizes are large; this version may be called from <code>rfit</code> using the option <code>TAU='R'</code>.
</p>
<p>The KSM estimator tauhat is a density type estimator that has the bandwidth given by <code class="reqn">t_\delta/sqrt{n}</code>,
where <code class="reqn">t_\delta</code> is the <code class="reqn">\delta-th</code> quantile of the cdf <code class="reqn">H(y)</code> given in expression (3.7.2) of Hettmansperger and McKean (2011), with the corresponding estimator <code class="reqn">\hat{H}</code>, given in expression (3.7.7) of Hettmansperger and McKean (2011).
</p>
<p>Based on simulation studies, most situations where (n/p &gt;= 6), the default delta = 0.80 provides a valid rank-based
analysis (McKean and Sheather, 1991).
For situations with n/p &lt; 6, caution is needed as the KSM estimate is sensitive to choice of bandwidth.  McKean and Sheather (1991) recommend using a value of 0.95 for delta in such situations.
</p>
<p>To correct for heavy-tailed random errors, Huber (1973) proposed a degree of freedom correction for the M-estimate scale parameter.  The correction is given by <code class="reqn">K = 1 + [p*(1-h_c)/n*h_c]</code> where <code class="reqn">h_c</code> is the proportion of standardized residuals in absolute value less than the parameter <code>hparm</code>.  This correction <code class="reqn">K</code> is used as a multiplicative factor to tauhat.  The default value of hparm is set at 2.
</p>
<p>The usual degrees of freedom correction, <code class="reqn">\sqrt{n/(n-p)}</code>, is also used as a multiplicative factor to tauhat.
</p>


<h3>Value</h3>

<p>Length one numeric object.
</p>


<h3>Author(s)</h3>

<p> Joseph McKean, John Kloke</p>


<h3>References</h3>

 
<p>Hettmansperger, T.P. and McKean J.W. (2011), <em>Robust Nonparametric Statistical Methods, 2nd ed.</em>, New York: Chapman-Hall.
</p>
<p>Huber, P.J. (1973), Robust regression: Asymptotics, conjectures and Monte Carlo, <em>Annals of Statistics</em>, 1, 799&ndash;821.
</p>
<p>Koul, H.L., Sievers, G.L., and McKean, J.W. (1987), An estimator of the scale parameter for the rank analysis of linear models under general score functions, <em>Scandinavian Journal of Statistics</em>, 14, 131&ndash;141.
</p>
<p>McKean, J. W. and Sheather, S. J. (1991), Small Sample Properties of Robust Analyses of Linear Models Based on R-Estimates: A Survey, in <em>Directions in Robust Statistics and Diagnostics, Part II</em>, Editors: W.\ Stahel and S.\ Weisberg, Springer-Verlag: New York, 1&ndash;19.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+rfit">rfit</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>#  For a standard normal distribution the parameter tau has the value 1.023327 (sqrt(pi/3)).
set.seed(283643659)
n &lt;- 12; p &lt;- 6; y &lt;- rnorm(n); x &lt;- matrix(rnorm(n*p),ncol=p)
tau1 &lt;- rfit(y~x)$tauhat; tau2 &lt;- rfit(y~x,delta=0.95)$tauhat
c(tau1,tau2) # 0.5516708 1.0138415
n &lt;- 120; p &lt;- 6; y &lt;- rnorm(n); x &lt;- matrix(rnorm(n*p),ncol=p)
tau3 &lt;- rfit(y~x)$tauhat; tau4 &lt;- rfit(y~x,delta=0.95)$tauhat
c(tau3,tau4) # 1.053974 1.041783
</code></pre>

<hr>
<h2 id='grad'> Calculate the Gradiant of Jaeckel's Dispersion Function </h2><span id='topic+grad'></span>

<h3>Description</h3>

<p>Calculate the Gradiant of Jaeckel's Dispersion Function 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>grad(x, y, beta, scores)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="grad_+3A_x">x</code></td>
<td>
<p> n by p design matrix </p>
</td></tr>
<tr><td><code id="grad_+3A_y">y</code></td>
<td>
<p> n by 1 response vector </p>
</td></tr>
<tr><td><code id="grad_+3A_beta">beta</code></td>
<td>
<p> p by 1 vector of regression coefficients</p>
</td></tr> 
<tr><td><code id="grad_+3A_scores">scores</code></td>
<td>
<p> an object of class scores </p>
</td></tr>
</table>


<h3>Value</h3>

<p>The gradiant evaluated at beta.
</p>


<h3>Author(s)</h3>

<p> John Kloke </p>


<h3>References</h3>

<p>Hettmansperger, T.P. and McKean J.W. (2011), <em>Robust Nonparametric Statistical Methods, 2nd ed.</em>, New York: Chapman-Hall.
</p>
<p>Jaeckel, L. A. (1972). Estimating regression coefficients by minimizing the dispersion of residuals. <em>Annals of Mathematical Statistics</em>, 43, 1449 - 1458.
</p>
<p>Jureckova, J. (1971). Nonparametric estimate of regression coefficients. <em>Annals of Mathematical Statistics</em>, 42, 1328 - 1338.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+disp">disp</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## The function is currently defined as
function (x, y, beta, scores) 
{
    x &lt;- as.matrix(x)
    e &lt;- y - x %*% beta
    r &lt;- rank(e, ties.method = "first")/(length(e) + 1)
    -t(x) %*% scores@phi(r)
  }
</code></pre>

<hr>
<h2 id='jaeckel'> Function to Minimize Jaeckel's Dispersion Function</h2><span id='topic+jaeckel'></span>

<h3>Description</h3>

<p>Uses the built-in function <code>optim</code> to minimize Jaeckel's dispersion function with respect to beta. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>jaeckel(x, y, beta0 = lm(y ~ x)$coef[2:(ncol(x) + 1)], 
  scores = Rfit::wscores, control = NULL,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="jaeckel_+3A_x">x</code></td>
<td>
<p> n by p design matrix </p>
</td></tr>
<tr><td><code id="jaeckel_+3A_y">y</code></td>
<td>
<p> n by 1 response vector </p>
</td></tr>
<tr><td><code id="jaeckel_+3A_beta0">beta0</code></td>
<td>
<p> initial estimate of beta </p>
</td></tr>
<tr><td><code id="jaeckel_+3A_scores">scores</code></td>
<td>
<p> object of class 'scores' </p>
</td></tr>
<tr><td><code id="jaeckel_+3A_control">control</code></td>
<td>
<p> control passed to fitting routine </p>
</td></tr>
<tr><td><code id="jaeckel_+3A_...">...</code></td>
<td>
<p>addtional arguments to be passed to fitting routine </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Jaeckel's dispersion function (Jaeckel 1972) is a convex function which measures the distance between the observed responses <code class="reqn">y</code> and the fitted values <code class="reqn">x \beta</code>.
The dispersion function is a sum of the products of the residuals, <code class="reqn">y - x \beta</code>, and the scored ranks of the residuals.  A rank-based fit minimizes the dispersion function; see McKean and Schrader (1980) and Kloke and McKean (2012) for discussion.
<code>jaeckel</code> uses <code>optim</code> with the method set to BFGS to minimize Jaeckel's dispersion function.
If control is not specified at the function call, the relative tolerance (reltol) is set to <code>.Machine$double.eps^(3/4)</code> and maximum number of iterations is set to 200.
</p>
<p><code>jaeckel</code> is intended to be an internal function.  See <code>rfit</code> for a general purpose function.
</p>


<h3>Value</h3>

<p>Results of <code>optim</code> are returned.
</p>


<h3>Author(s)</h3>

<p> John Kloke </p>


<h3>References</h3>

 
<p>Hettmansperger, T.P. and McKean J.W. (2011), <em>Robust Nonparametric Statistical Methods, 2nd ed.</em>, New York: Chapman-Hall.
</p>
<p>Jaeckel, L. A. (1972), Estimating regression coefficients by minimizing the dispersion of residuals. <em>Annals of Mathematical Statistics</em>, 43, 1449 - 1458.
</p>
<p>Kapenga, J. A., McKean, J. W., and Vidmar, T. J. (1988), <em>RGLM: Users Manual</em>, Statist. Assoc. Short Course on Robust Statistical Procedures for the Analysis of Linear and Nonlinear Models, New Orleans.
</p>


<h3>See Also</h3>

 <p><code><a href="stats.html#topic+optim">optim</a></code>, <code><a href="#topic+rfit">rfit</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>##  This is a internal function.  See rfit for user-level examples.
</code></pre>

<hr>
<h2 id='kwayr'>
Internal Functions for K-Way analysis of variance
</h2><span id='topic+kwayr'></span><span id='topic+cellx'></span><span id='topic+khmat'></span><span id='topic+pasteColsRfit'></span><span id='topic+redmod'></span><span id='topic+subsets'></span>

<h3>Description</h3>

<p>These are internal functions used to construct the robust anova table.
The function <code>raov</code> is the main program.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kwayr(levs, data,...)
cellx(X)
khmat(levsind,permh)
pasteColsRfit(x,sep="")
redmod(xmat,amat)
subsets(k)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="kwayr_+3A_levs">levs</code></td>
<td>

<p>vector of levels corresponding to each of the factors
</p>
</td></tr>
<tr><td><code id="kwayr_+3A_data">data</code></td>
<td>

<p>data matrix in the form y, factor 1,..., factor k
</p>
</td></tr>
<tr><td><code id="kwayr_+3A_x">X</code></td>
<td>

<p>n x k matrix where the columns represent the levels of the k factors.
</p>
</td></tr>
<tr><td><code id="kwayr_+3A_levsind">levsind</code></td>
<td>

<p>Internal parameter.
</p>
</td></tr>
<tr><td><code id="kwayr_+3A_permh">permh</code></td>
<td>

<p>Internal parameter.
</p>
</td></tr>
<tr><td><code id="kwayr_+3A_x">x</code></td>
<td>

<p>n x k matrix where the columns represent the levels of the k factors.
</p>
</td></tr>
<tr><td><code id="kwayr_+3A_xmat">xmat</code></td>
<td>

<p>n x p full model design matrix 
</p>
</td></tr>
<tr><td><code id="kwayr_+3A_amat">amat</code></td>
<td>

<p>Internal parameter.
</p>
</td></tr>
<tr><td><code id="kwayr_+3A_k">k</code></td>
<td>

<p>Internal parameter.
</p>
</td></tr>
<tr><td><code id="kwayr_+3A_sep">sep</code></td>
<td>

<p>Seperator used in pasteColsRfit 
</p>
</td></tr>
<tr><td><code id="kwayr_+3A_...">...</code></td>
<td>

<p>additional arguments
</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Renamed pasteCols of library plotrix written by Jim Lemon et. al. June 2011 under GPL 2
</p>


<h3>Author(s)</h3>

<p>Joseph McKean, John Kloke
</p>


<h3>References</h3>

<p>Hettmansperger, T.P. and McKean J.W. (2011), <em>Robust Nonparametric Statistical Methods, 2nd ed.</em>, New York: Chapman-Hall.
</p>
<p>Hocking, R. R. (1985), <em>The Analysis of Linear Models</em>, Monterey, California: Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+raov">raov</a></code>
</p>

<hr>
<h2 id='oneway.rfit'> Rank-based Oneway Analysis of Variance </h2><span id='topic+oneway.rfit'></span>

<h3>Description</h3>

<p>Carries out a robust analysis of variance for a one factor design.
Analysis is based on the R estimates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>oneway.rfit(y, g, scores = Rfit::wscores, p.adjust = "none",...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="oneway.rfit_+3A_y">y</code></td>
<td>
<p> n by 1 response vector </p>
</td></tr>
<tr><td><code id="oneway.rfit_+3A_g">g</code></td>
<td>
<p> n by 1 vector representing group membership </p>
</td></tr>
<tr><td><code id="oneway.rfit_+3A_scores">scores</code></td>
<td>
<p> an object of class 'scores'</p>
</td></tr>
<tr><td><code id="oneway.rfit_+3A_p.adjust">p.adjust</code></td>
<td>
<p> adjustment to the p-values, argument passed to p.adjust </p>
</td></tr>
<tr><td><code id="oneway.rfit_+3A_...">...</code></td>
<td>
<p> additional arguments </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Carries out a robust one-way analysis of variance based on full model r fit.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>fit</code></td>
<td>
<p> full model fit from rfit </p>
</td></tr>
<tr><td><code>est</code></td>
<td>
<p> Estimates </p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p> Standard Errors </p>
</td></tr> 
<tr><td><code>I</code></td>
<td>
<p> First Index </p>
</td></tr>
<tr><td><code>J</code></td>
<td>
<p> Second Index </p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p> p-values </p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p> response vector </p>
</td></tr>
<tr><td><code>g</code></td>
<td>
<p> vector denoting group membership </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Joseph McKean, John Kloke</p>


<h3>References</h3>

<p>Hettmansperger, T.P. and McKean J.W. (2011), <em>Robust Nonparametric Statistical Methods, 2nd ed.</em>, New York: Chapman-Hall.
</p>


<h3>See Also</h3>

<p><a href="#topic+rfit">rfit</a> </p>


<h3>Examples</h3>

<pre><code class='language-R'>	data(quail)
	oneway.rfit(quail$ldl,quail$treat)
 </code></pre>

<hr>
<h2 id='param-class'>Class &quot;param&quot;</h2><span id='topic+param-class'></span><span id='topic+param'></span>

<h3>Description</h3>

<p>Internal class for use with score functions.
</p>


<h3>Objects from the Class</h3>

<p>A virtual Class: No objects may be created from it.</p>


<h3>Methods</h3>

<p>No methods defined with class &quot;param&quot; in the signature.
</p>


<h3>Author(s)</h3>

<p>John Kloke
</p>


<h3>See Also</h3>

<p><code><a href="#topic+scores-class">scores</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>showClass("param")
</code></pre>

<hr>
<h2 id='print.rfit'> Rfit Internal Print Functions</h2><span id='topic+print.rfit'></span><span id='topic+print.summary.rfit'></span><span id='topic+print.drop.test'></span><span id='topic+print.oneway.rfit'></span><span id='topic+print.summary.oneway.rfit'></span><span id='topic+print.raov'></span>

<h3>Description</h3>

<p>These functions print the output in a user-friendly manner using the internal R function <code>print</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rfit'
print(x, ...)
## S3 method for class 'summary.rfit'
print(x, digits = max(5, .Options$digits - 2), ...)
## S3 method for class 'drop.test'
print(x, digits = max(5, .Options$digits - 2), ...)
## S3 method for class 'oneway.rfit'
print(x, digits = max(5, .Options$digits - 2), ...)
## S3 method for class 'summary.oneway.rfit'
print(x, digits = max(5, .Options$digits - 2), ...)
## S3 method for class 'raov'
print(x, digits = max(5, .Options$digits - 2), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.rfit_+3A_x">x</code></td>
<td>
<p> An object to be printed </p>
</td></tr>
<tr><td><code id="print.rfit_+3A_digits">digits</code></td>
<td>
<p>number of digits to display</p>
</td></tr>
<tr><td><code id="print.rfit_+3A_...">...</code></td>
<td>
<p>  additional arguments to be passed to <code>print</code> </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>John Kloke</p>


<h3>See Also</h3>

 
<p><code><a href="#topic+rfit">rfit</a></code>, <code><a href="#topic+summary.rfit">summary.rfit</a></code>, <code><a href="#topic+drop.test">drop.test</a></code>
</p>

<hr>
<h2 id='quail'> Quail Data </h2><span id='topic+quail'></span>

<h3>Description</h3>

<p>Thirty-nine quail were randomized to one of for treatments for lowering cholesterol.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(quail)</code></pre>


<h3>Format</h3>

<p>A data frame with 39 observations on the following 2 variables.
</p>

<dl>
<dt><code>treat</code></dt><dd><p>a factor with levels <code>1</code> <code>2</code> <code>3</code> <code>4</code></p>
</dd>
<dt><code>ldl</code></dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>Source</h3>

<p>Hettmansperger, T.P. and McKean J.W. (2011), <em>Robust Nonparametric Statistical Methods, 2nd ed.</em>, New York: Chapman-Hall.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(quail)
boxplot(ldl~treat,data=quail)
</code></pre>

<hr>
<h2 id='raov'>
R ANOVA 
</h2><span id='topic+raov'></span>

<h3>Description</h3>

<p>Returns full model fit and robust ANOVA table for all main effects and interactions. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>raov(f, data = list(), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="raov_+3A_f">f</code></td>
<td>

<p>an object of class formula
</p>
</td></tr>
<tr><td><code id="raov_+3A_data">data</code></td>
<td>

<p>an optional data frame
</p>
</td></tr>
<tr><td><code id="raov_+3A_...">...</code></td>
<td>

<p>additional arguments
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Based on reduction in dispersion tests for testing main effects and interaction.
Uses an algorithm described in Hocking (1985).
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>table</code></td>
<td>
<p>Description of 'comp1'</p>
</td></tr>
<tr><td><code>fit</code></td>
<td>
<p>full model fit returned from rfit</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>the residuals, i.e. y-yhat</p>
</td></tr>
<tr><td><code>fitted.values</code></td>
<td>
<p> yhat = x betahat</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>Call to the function</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Joseph McKean, John Kloke
</p>


<h3>References</h3>

<p>Hettmansperger, T.P. and McKean J.W. (2011), <em>Robust Nonparametric Statistical Methods, 2nd ed.</em>, New York: Chapman-Hall.
</p>
<p>Hocking, R. R. (1985), <em>The Analysis of Linear Models</em>, Monterey, California: Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rfit">rfit</a></code>, <code><a href="#topic+oneway.rfit">oneway.rfit</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>raov(logSurv~Poison+Treatment,data=BoxCox)
</code></pre>

<hr>
<h2 id='rfit'> Rank-based Estimates of Regression Coefficients </h2><span id='topic+rfit'></span><span id='topic+rfit.default'></span>

<h3>Description</h3>

<p>Minimizes Jaeckel's dispersion function to obtain a rank-based solution for linear models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rfit(formula, data = list(), ...)
## Default S3 method:
rfit(formula, data, subset, yhat0 = NULL, 
scores = Rfit::wscores, symmetric = FALSE, TAU = "F0", 
betahat0 = NULL, ...)

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rfit_+3A_formula">formula</code></td>
<td>
<p>an object of class formula </p>
</td></tr>
<tr><td><code id="rfit_+3A_data">data</code></td>
<td>
<p> an optional data frame</p>
</td></tr>
<tr><td><code id="rfit_+3A_subset">subset</code></td>
<td>
<p> an optional argument specifying the subset of observations to be used</p>
</td></tr>
<tr><td><code id="rfit_+3A_yhat0">yhat0</code></td>
<td>
<p> an n by 1 vector of initial fitted values, default is NULL</p>
</td></tr>
<tr><td><code id="rfit_+3A_scores">scores</code></td>
<td>
<p> an object of class 'scores'</p>
</td></tr>
<tr><td><code id="rfit_+3A_symmetric">symmetric</code></td>
<td>
<p> logical.  If 'FALSE' uses median of residuals as estimate of intercept</p>
</td></tr> 
<tr><td><code id="rfit_+3A_tau">TAU</code></td>
<td>
<p>version of estimation routine for scale parameter.  F0 for Fortran, R for (slower) R, N for none</p>
</td></tr>
<tr><td><code id="rfit_+3A_betahat0">betahat0</code></td>
<td>
<p> a p by 1 vector of initial parameter estimates, default is NULL</p>
</td></tr>
<tr><td><code id="rfit_+3A_...">...</code></td>
<td>
<p> additional arguments to be passed to fitting routines </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Rank-based estimation involves replacing the L2 norm of least squares estimation with a pseudo-norm which is a function of the residuals and the scored ranks of the residuals.
That is, in rank-based estimation, the usual notion of Euclidean distance is replaced with another measure of distance which is referred to as Jaeckel's (1972) dispersion function.
Jaeckel's dispersion function depends on a score function and a library of commonly used score functions is included; eg., linear (Wilcoxon) and normal (Gaussian) scores.
If an inital fit is not supplied (i.e. yhat0 = NULL and betahat0 = NULL) then inital fit is based on a LS fit.
</p>
<p>Esimation of scale parameter tau is provided which may be used for inference.  
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>coefficients</code></td>
<td>
<p>estimated regression coefficents with intercept</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>the residuals, i.e. y-yhat</p>
</td></tr>
<tr><td><code>fitted.values</code></td>
<td>
<p> yhat = x betahat</p>
</td></tr>
<tr><td><code>xc</code></td>
<td>
<p>centered design matrix</p>
</td></tr>
<tr><td><code>tauhat</code></td>
<td>
<p>estimated value of the scale parameter tau</p>
</td></tr>
<tr><td><code>taushat</code></td>
<td>
<p>estimated value of the scale parameter tau_s</p>
</td></tr>
<tr><td><code>betahat</code></td>
<td>
<p>estimated regression coefficents</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>Call to the function</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> John Kloke, Joesph McKean </p>


<h3>References</h3>

<p>Hettmansperger, T.P. and McKean J.W. (2011), <em>Robust Nonparametric Statistical Methods, 2nd ed.</em>, New York: Chapman-Hall.
</p>
<p>Jaeckel, L. A. (1972). Estimating regression coefficients by minimizing the dispersion of residuals. <em>Annals of Mathematical Statistics</em>, 43, 1449 - 1458.
</p>
<p>Jureckova, J. (1971). Nonparametric estimate of regression coefficients. <em>Annals of Mathematical Statistics</em>, 42, 1328 - 1338.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+summary.rfit">summary.rfit</a></code>
<code><a href="#topic+drop.test">drop.test</a></code>
<code><a href="#topic+rstudent.rfit">rstudent.rfit</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(baseball)
data(wscores)
fit&lt;-rfit(weight~height,data=baseball)
summary(fit)

### set the starting value
x1 &lt;- runif(47); x2 &lt;- runif(47); y &lt;- 1 + 0.5*x1 + rnorm(47)
# based on a fit to a sub-model
rfit(y~x1+x2,yhat0=fitted.values(rfit(y~x1)))

### set value of delta used in estimation of tau ###
w &lt;- factor(rep(1:3,each=3))
y &lt;- rt(9,9)
rfit(y~w)$tauhat
rfit(y~w,delta=0.95)$tauhat  # recommended when n/p &lt; 5
</code></pre>

<hr>
<h2 id='rstudent.rfit'> Studentized Residuals for Rank-Based Regression </h2><span id='topic+rstudent.rfit'></span>

<h3>Description</h3>

<p> Returns the Studentized residuals based on rank-based estimation.  </p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rfit'
rstudent(model,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rstudent.rfit_+3A_model">model</code></td>
<td>
<p> an object of class rfit </p>
</td></tr>
<tr><td><code id="rstudent.rfit_+3A_...">...</code></td>
<td>
<p> additional arguments. currently not used.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> John Kloke, Joseph McKean</p>


<h3>References</h3>

<p>Hettmansperger, T.P. and McKean J.W. (2011), <em>Robust Nonparametric Statistical Methods, 2nd ed.</em>, New York: Chapman-Hall.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+rfit">rfit</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>x&lt;-runif(47)
y&lt;-rcauchy(47)
qqnorm(rstudent(fit&lt;-rfit(y~x)))
plot(x,rstudent(fit)) ; abline(h=c(-2,2))
</code></pre>

<hr>
<h2 id='scores-class'>Class &quot;scores&quot;</h2><span id='topic+scores-class'></span><span id='topic+scores'></span>

<h3>Description</h3>

<p>A score function and it's corresponding derivative is required for rank-based estimation.  
This object puts them together.
</p>


<h3>Objects from the Class</h3>

<p>Objects can be created by calls of the form <code>new("scores", ...)</code>.
</p>


<h3>Slots</h3>


<dl>
<dt><code>phi</code>:</dt><dd><p>Object of class <code>"function"</code> the score function </p>
</dd>
<dt><code>Dphi</code>:</dt><dd><p>Object of class <code>"function"</code> the first derivative of the score function </p>
</dd>
<dt><code>param</code>:</dt><dd><p>Object of class <code>"param"</code> </p>
</dd>
</dl>



<h3>Author(s)</h3>

<p> John Kloke </p>


<h3>References</h3>

<p>Hettmansperger, T.P. and McKean J.W. (2011), <em>Robust Nonparametric Statistical Methods, 2nd ed.</em>, New York: Chapman-Hall.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+param-class">param</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>showClass("scores")
</code></pre>

<hr>
<h2 id='serumLH'>
Serum Level of luteinizing hormone (LH)
</h2><span id='topic+serumLH'></span>

<h3>Description</h3>

<p>Hollander and Wolfe (1999) discuss a 2 by 5 factorial design for a study
to determine the effect of light on the release of luteinizing hormone (LH).
The factors in the design are: light regimes at two levels (constant light and 14 hours of light followed by 10 hours of darkness) and a luteinizing release factor (LRF) at 5 different dosage levels.
The response is the level of luteinizing hormone (LH), nanograms per ml of serum in
blood samples.
Sixty rats were put on test under these 10 treatment combinations, six rats per combination.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(serumLH)</code></pre>


<h3>Format</h3>

<p>A data frame with 60 observations on the following 3 variables.
</p>

<dl>
<dt><code>serum</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>light.regime</code></dt><dd><p>a factor with levels <code>Constant</code> <code>Intermittent</code></p>
</dd>
<dt><code>LRF.dose</code></dt><dd><p>a factor with levels <code>0</code> <code>10</code> <code>1250</code> <code>250</code> <code>50</code></p>
</dd>
</dl>



<h3>Source</h3>

<p>Hollander, M. and Wolfe, D.A. (1999), <em>Nonparametric Statistical Methods</em>, New York: Wiley.
</p>


<h3>References</h3>

<p>Hollander, M. and Wolfe, D.A. (1999), <em>Nonparametric Statistical Methods</em>, New York: Wiley.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(serumLH)
raov(serum~light.regime + LRF.dose + light.regime*LRF.dose, data = serumLH)
</code></pre>

<hr>
<h2 id='signedrank'> Signed-Rank Estimate of Location (Intercept) </h2><span id='topic+signedrank'></span>

<h3>Description</h3>

<p>Returns the signed-rank estimate of intercept with is equivalent to the Hodges-Lehmann estimate of the residuals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>signedrank(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="signedrank_+3A_x">x</code></td>
<td>
<p> numeric vector </p>
</td></tr> 
</table>


<h3>Value</h3>

<p>Returns the median of the Walsh averages.
</p>


<h3>Author(s)</h3>

<p> John Kloke, Joseph McKean </p>


<h3>References</h3>

 
<p>Hettmansperger, T.P. and McKean J.W. (2011), <em>Robust Nonparametric Statistical Methods, 2nd ed.</em>, New York: Chapman-Hall.
</p>
<p>Hollander, M. and Wolfe, D.A. (1999), <em>Nonparametric Statistical Methods</em>, New York: Wiley.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+walsh">walsh</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
## The function is currently defined as
function (x) 
median(walsh(x))
</code></pre>

<hr>
<h2 id='summary.oneway.rfit'>
Provides a summary for the oneway anova based on an R fit.
</h2><span id='topic+summary.oneway.rfit'></span>

<h3>Description</h3>

<p>Provides a summary for the oneway anova based on an R fit including a test for main effects as tests for pairwise comparisons.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'oneway.rfit'
summary(object, alpha=0.05,method=confintadjust.methods,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.oneway.rfit_+3A_object">object</code></td>
<td>
<p>an object of class 'oneway.rfit', usually, a result of a call to 'oneway.rfit'</p>
</td></tr>
<tr><td><code id="summary.oneway.rfit_+3A_alpha">alpha</code></td>
<td>
<p>Experimentwise Error Rate</p>
</td></tr>
<tr><td><code id="summary.oneway.rfit_+3A_method">method</code></td>
<td>
<p>method used in confidence interval adjustment</p>
</td></tr>
<tr><td><code id="summary.oneway.rfit_+3A_...">...</code></td>
<td>
<p> additional arguments </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> John Kloke, Joseph McKean</p>


<h3>References</h3>

<p>Hettmansperger, T.P. and McKean J.W. (2011), <em>Robust Nonparametric Statistical Methods, 2nd ed.</em>, New York: Chapman-Hall.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(quail)
oneway.rfit(quail$ldl,quail$treat)
</code></pre>

<hr>
<h2 id='summary.rfit'> Summarize Rank-Based Linear Model Fits </h2><span id='topic+summary.rfit'></span>

<h3>Description</h3>

<p>Provides a summary similar to the traditional least squares fit.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rfit'
summary(object,overall.test,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.rfit_+3A_object">object</code></td>
<td>
<p>an object of class 'rfit', usually, a result of a call to 'rfit'</p>
</td></tr>
<tr><td><code id="summary.rfit_+3A_overall.test">overall.test</code></td>
<td>
<p>either 'wald' or 'drop'</p>
</td></tr>
<tr><td><code id="summary.rfit_+3A_...">...</code></td>
<td>
<p> additional arguments </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Provides summary statistics based on a rank-based fit.
A table of estimates, standard errors, t-ratios, and p-values are provided.
An overall test of the explantory variables is provided; the default is to use a Wald test.
A drop in dispersion test is also availble in which case a robust R^2 is provided as well.
</p>


<h3>Author(s)</h3>

<p> John Kloke </p>


<h3>References</h3>

<p>Hettmansperger, T.P. and McKean J.W. (2011), <em>Robust Nonparametric Statistical Methods, 2nd ed.</em>, New York: Chapman-Hall.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(baseball)
fit&lt;-rfit(weight~height,data=baseball)
summary(fit)
summary(fit,overall.test='drop')
</code></pre>

<hr>
<h2 id='taufuncs'> Internal Functions for Estimating tau </h2><span id='topic+hstarreadyscr'></span><span id='topic+hstar'></span><span id='topic+looptau'></span><span id='topic+pairup'></span><span id='topic+nscale'></span>

<h3>Description</h3>

<p>These are internal functions used for calculating the scale parameter tau necessary for estimating the standard errors of coefficients for rank-regression.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hstarreadyscr(ehat,asc,ascpr)
hstar(abdord, wtord, const, n, y) 
looptau(delta, abdord, wtord, const, n)
pairup(x,type="less") 
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="taufuncs_+3A_ehat">ehat</code></td>
<td>
<p> Full model residals </p>
</td></tr>
<tr><td><code id="taufuncs_+3A_delta">delta</code></td>
<td>
<p>Window parameter (proportion) used in the Koul et al. estimator of tau.  Default value is 0.80.   If the ratio of sample size to number of regression parameters (n to p) is less than 5, larger values such as 0.90 to 0.95 are more approporiate.</p>
</td></tr>
<tr><td><code id="taufuncs_+3A_y">y</code></td>
<td>
<p>Argument of function hstar</p>
</td></tr>
<tr><td><code id="taufuncs_+3A_abdord">abdord</code></td>
<td>
<p>Ordered absolute differences of residuals</p>
</td></tr>
<tr><td><code id="taufuncs_+3A_wtord">wtord</code></td>
<td>
<p>Standardized (by const) ordered absolute differences of residuals</p>
</td></tr>
<tr><td><code id="taufuncs_+3A_const">const</code></td>
<td>
<p>Range of score function</p>
</td></tr>
<tr><td><code id="taufuncs_+3A_n">n</code></td>
<td>
<p>Sample size</p>
</td></tr>
<tr><td><code id="taufuncs_+3A_x">x</code></td>
<td>
<p>Argument for pairup</p>
</td></tr>
<tr><td><code id="taufuncs_+3A_type">type</code></td>
<td>
<p>Argument for the function pairup</p>
</td></tr>
<tr><td><code id="taufuncs_+3A_asc">asc</code></td>
<td>
<p> scores </p>
</td></tr>
<tr><td><code id="taufuncs_+3A_ascpr">ascpr</code></td>
<td>
<p> derivative of the scores </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Joseph McKean, John Kloke</p>


<h3>References</h3>

 
<p>Hettmansperger, T.P. and McKean J.W. (2011), <em>Robust Nonparametric Statistical Methods, 2nd ed.</em>, New York: Chapman-Hall.
</p>
<p>Koul, H.L., Sievers, G.L., and McKean, J.W. (1987) An esimator of the scale parameter for the rank analysis of linear models under general score functions, <em>Scandinavian Journal of Statistics</em>, 14, 131-141.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+gettau">gettau</a></code>, <code><a href="#topic+rfit">rfit</a></code> </p>

<hr>
<h2 id='taustar'> Estimate of the Scale Parameter taustar </h2><span id='topic+taustar'></span>

<h3>Description</h3>

<p>An estimate of the scale parameter taustar =  1/(2*f(0)) is needed for the standard error of the intercept in rank-based regression.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>taustar(e, p, conf = 0.95)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="taustar_+3A_e">e</code></td>
<td>
<p>n x 1 vector of full model residuals </p>
</td></tr>
<tr><td><code id="taustar_+3A_p">p</code></td>
<td>
<p>is the number of regression coefficients (without the intercept) </p>
</td></tr>
<tr><td><code id="taustar_+3A_conf">conf</code></td>
<td>
<p> confidence level of CI used </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Confidence interval estimate of taustar.
See, for example, Hettmansperger and McKean (1998) p.7-8 and p.25-26.
</p>


<h3>Value</h3>

<p>Length-one numeric object containing the estimated scale parameter taustar.
</p>


<h3>Author(s)</h3>

<p> Joseph McKean, John Kloke</p>


<h3>References</h3>

 
<p>Hettmansperger, T.P. and McKean J.W. (2011), <em>Robust Nonparametric Statistical Methods, 2nd ed.</em>, New York: Chapman-Hall.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+rfit">rfit</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>##  This is an internal function.  See rfit for user-level examples.
</code></pre>

<hr>
<h2 id='telephone'> Telephone Data</h2><span id='topic+telephone'></span>

<h3>Description</h3>

<p>The number of telephone calls (in tens of millions) made in Belgium from 1950-1973.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(telephone)</code></pre>


<h3>Format</h3>

<p>A data frame with 24 observations on the following 2 variables.
</p>

<dl>
<dt><code>year</code></dt><dd><p>years since 1950 AD</p>
</dd>
<dt><code>calls</code></dt><dd><p>number of telephone calls in tens of millions</p>
</dd>
</dl>



<h3>Source</h3>

<p>Rousseeuw, P.J. and Leroy, A.M. (1987), <em>Robust Regression and Outlier Detection</em>, New York: Wiley.
</p>


<h3>References</h3>

<p>Hettmansperger, T.P. and McKean J.W. (2011), <em>Robust Nonparametric Statistical Methods, 2nd ed.</em>, New York: Chapman-Hall.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(telephone)
plot(telephone)
abline(rfit(calls~year,data=telephone))
</code></pre>

<hr>
<h2 id='vcov.rfit'> Variance-Covariance Matrix for Rank-Based Regression </h2><span id='topic+vcov.rfit'></span>

<h3>Description</h3>

<p>Returns the variance-covariance matrix of the regression estimates from an object of type rfit.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rfit'
vcov(object, intercept = NULL,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="vcov.rfit_+3A_object">object</code></td>
<td>
<p> an object of type rfit </p>
</td></tr>
<tr><td><code id="vcov.rfit_+3A_intercept">intercept</code></td>
<td>
<p> logical. If TRUE include the variance-covariance estimates corresponding to the intercept </p>
</td></tr>
<tr><td><code id="vcov.rfit_+3A_...">...</code></td>
<td>
<p> additional arguments </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> John Kloke </p>


<h3>References</h3>

<p>Hettmansperger, T.P. and McKean J.W. (2011), <em>Robust Nonparametric Statistical Methods, 2nd ed.</em>, New York: Chapman-Hall.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rfit">rfit</a></code></p>

<hr>
<h2 id='wald.test.overall'>Overall Wald test</h2><span id='topic+wald.test.overall'></span>

<h3>Description</h3>

<p>Conducts a Wald test of all regression parameters are zero</p>


<h3>Usage</h3>

<pre><code class='language-R'>wald.test.overall(fit)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="wald.test.overall_+3A_fit">fit</code></td>
<td>
<p>result from a rfit</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>John Kloke</p>


<h3>References</h3>

<p>Hettmansperger, T.P. and McKean J.W. (2011), <em>Robust Nonparametric Statistical Methods, 2nd ed.</em>, New York: Chapman-Hall.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- rnorm(47)
y &lt;- rnorm(47)
wald.test.overall(rfit(y~x))
</code></pre>

<hr>
<h2 id='walsh'>Walsh Averages </h2><span id='topic+walsh'></span>

<h3>Description</h3>

<p>Given a list of n numbers, the Walsh averages are the <code class="reqn">latex</code> pairwise averages.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>walsh(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="walsh_+3A_x">x</code></td>
<td>
<p> A numeric vector  </p>
</td></tr>
</table>


<h3>Value</h3>

<p>The Walsh averages.
</p>


<h3>Author(s)</h3>

<p> John Kloke, Joseph McKean </p>


<h3>References</h3>

 
<p>Hettmansperger, T.P. and McKean J.W. (2011), <em>Robust Nonparametric Statistical Methods, 2nd ed.</em>, New York: Chapman-Hall.
</p>
<p>Hollander, M. and Wolfe, D.A. (1999), <em>Nonparametric Statistical Methods</em>, New York: Wiley.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+signedrank">signedrank</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
median(walsh(rnorm(100)))  # Hodges-Lehmann estimate of location

## The function is currently defined as
function (x) 
{
    n &lt;- length(x)
    w &lt;- vector(n * (n + 1)/2, mode = "numeric")
    ind &lt;- 0
    for (i in 1:n) {
        for (j in i:n) {
            ind &lt;- ind + 1
            w[ind] &lt;- 0.5 * (x[i] + x[j])
        }
    }
    return(w)
  }
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
