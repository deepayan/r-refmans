<!DOCTYPE html><html><head><title>Help for package RcppCensSpatial</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {RcppCensSpatial}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#CovMat'><p>Covariance matrix for spatial models</p></a></li>
<li><a href='#dist2Dmatrix'><p>Distance matrix computation</p></a></li>
<li><a href='#EM.sclm'><p>ML estimation of spatial censored linear models via the EM algorithm</p></a></li>
<li><a href='#MCEM.sclm'><p>ML estimation of spatial censored linear models via the MCEM algorithm</p></a></li>
<li><a href='#Missouri'><p>TCDD concentration data</p></a></li>
<li><a href='#predict.sclm'><p>Prediction in spatial models with censored/missing responses</p></a></li>
<li><a href='#rCensSp'><p>Censored spatial data simulation</p></a></li>
<li><a href='#SAEM.sclm'><p>ML estimation of spatial censored linear models via the SAEM algorithm</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Spatial Estimation and Prediction for Censored/Missing Responses</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3.0</td>
</tr>
<tr>
<td>Description:</td>
<td>It provides functions to estimate parameters in linear spatial models with 
  censored/missing responses via the Expectation-Maximization (EM), the Stochastic 
  Approximation EM (SAEM), or the Monte Carlo EM (MCEM) algorithm. These algorithms 
  are widely used to compute the maximum likelihood (ML) estimates in problems with 
  incomplete data. The EM algorithm computes the ML estimates when a closed expression 
  for the conditional expectation of the complete-data log-likelihood function is 
  available. In the MCEM algorithm, the conditional expectation is substituted by a 
  Monte Carlo approximation based on many independent simulations of the missing data. 
  In contrast, the SAEM algorithm splits the E-step into simulation and integration 
  steps. This package also approximates the standard error of the estimates using the 
  Louis method. Moreover, it has a function that performs spatial prediction in new 
  locations.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.0</td>
</tr>
<tr>
<td>Imports:</td>
<td>ggplot2, gridExtra, MomTrunc, mvtnorm, Rcpp, Rdpack,
relliptical, stats, StempCens</td>
</tr>
<tr>
<td>RdMacros:</td>
<td>Rdpack</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>RcppArmadillo, Rcpp, RcppProgress, roptim</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-06-27 22:27:04 UTC; 55199</td>
</tr>
<tr>
<td>Author:</td>
<td>Katherine A. L. Valeriano
    <a href="https://orcid.org/0000-0001-6388-4753"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre],
  Alejandro Ordonez Cuastumal
    <a href="https://orcid.org/0000-0002-8157-9012"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [ctb],
  Christian Galarza Morales
    <a href="https://orcid.org/0000-0002-4818-6006"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [ctb],
  Larissa Avila Matos
    <a href="https://orcid.org/0000-0002-2635-0901"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Katherine A. L. Valeriano &lt;katandreina@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-06-27 23:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='CovMat'>Covariance matrix for spatial models</h2><span id='topic+CovMat'></span>

<h3>Description</h3>

<p>It computes the spatial variance-covariance matrix considering exponential,
gaussian, matérn, or power exponential correlation function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CovMat(phi, tau2, sig2, coords, type = "exponential", kappa = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CovMat_+3A_phi">phi</code></td>
<td>
<p>spatial scaling parameter.</p>
</td></tr>
<tr><td><code id="CovMat_+3A_tau2">tau2</code></td>
<td>
<p>nugget effect parameter.</p>
</td></tr>
<tr><td><code id="CovMat_+3A_sig2">sig2</code></td>
<td>
<p>partial sill parameter.</p>
</td></tr>
<tr><td><code id="CovMat_+3A_coords">coords</code></td>
<td>
<p>2D spatial coordinates of dimensions <code class="reqn">n\times 2</code>.</p>
</td></tr>
<tr><td><code id="CovMat_+3A_type">type</code></td>
<td>
<p>type of spatial correlation function: <code>'exponential'</code>,
<code>'gaussian'</code>, <code>'matern'</code>, and <code>'pow.exp'</code> for exponential,
gaussian, matérn, and power exponential, respectively.</p>
</td></tr>
<tr><td><code id="CovMat_+3A_kappa">kappa</code></td>
<td>
<p>parameter for some spatial correlation functions. For exponential
and gaussian <code>kappa=NULL</code>, for power exponential <code>0 &lt; kappa &lt;= 2</code>,
and for matérn correlation function <code>kappa &gt; 0</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The spatial covariance matrix is given by
</p>
<p><code class="reqn">\Sigma = [Cov(s_i, s_j )] = \sigma^2 R(\phi) + \tau^2 I_n</code>,
</p>
<p>where <code class="reqn">\sigma^2 &gt; 0</code> is the partial sill, <code class="reqn">\phi &gt; 0</code> is the spatial scaling
parameter, <code class="reqn">\tau^2 &gt; 0</code> is known as the nugget effect in the geostatistical
framework, <code class="reqn">R(\phi)</code> is the <code class="reqn">n\times n</code> correlation matrix computed from a
correlation function, and <code class="reqn">I_n</code> is the <code class="reqn">n\times n</code> identity matrix.
</p>
<p>The spatial correlation functions available are:
</p>

<dl>
<dt><strong>Exponential</strong>:</dt><dd><p><code class="reqn">Corr(d) = exp(-d/\phi)</code>,</p>
</dd>
<dt><strong>Gaussian</strong>:</dt><dd><p><code class="reqn">Corr(d) = exp(-(d/\phi)^2)</code>,</p>
</dd>
<dt><strong>Matérn</strong>:</dt><dd><p><code class="reqn">Corr(d) = \frac{1}{2^{(\kappa-1)}\Gamma(\kappa)}\left(\frac{d}{\phi}\right)^\kappa K_\kappa \left( \frac{d}{\phi} \right)</code>,</p>
</dd>
<dt><strong>Power exponential</strong>:</dt><dd><p><code class="reqn">Corr(d) = exp(-(d/\phi)^\kappa)</code>,</p>
</dd>
</dl>
<p>where <code class="reqn">d \geq 0</code> is the Euclidean distance between two observations,
<code class="reqn">\Gamma(.)</code> is the gamma function, <code class="reqn">\kappa</code> is the smoothness parameter,
and <code class="reqn">K_\kappa(.)</code> is the modified Bessel function of the second kind of order
<code class="reqn">\kappa</code>.
</p>


<h3>Value</h3>

<p>An <code class="reqn">n\times n</code> spatial covariance matrix.
</p>


<h3>Author(s)</h3>

<p>Katherine L. Valeriano, Alejandro Ordoñez, Christian E. Galarza, and Larissa A. Matos.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dist2Dmatrix">dist2Dmatrix</a></code>, <code><a href="#topic+EM.sclm">EM.sclm</a></code>, <code><a href="#topic+MCEM.sclm">MCEM.sclm</a></code>, <code><a href="#topic+SAEM.sclm">SAEM.sclm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1000)
n = 20
coords = round(matrix(runif(2*n, 0, 10), n, 2), 5)
Cov = CovMat(phi=5, tau2=0.8, sig2=2, coords=coords, type="exponential")
</code></pre>

<hr>
<h2 id='dist2Dmatrix'>Distance matrix computation</h2><span id='topic+dist2Dmatrix'></span>

<h3>Description</h3>

<p>It computes the Euclidean distance matrix for a set of coordinates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dist2Dmatrix(coords)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dist2Dmatrix_+3A_coords">coords</code></td>
<td>
<p>2D spatial coordinates of dimensions <code class="reqn">n\times 2</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An <code class="reqn">n\times n</code> distance matrix.
</p>


<h3>Author(s)</h3>

<p>Katherine L. Valeriano, Alejandro Ordoñez, Christian E. Galarza, and Larissa A. Matos.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n = 100
set.seed(1000)
x = round(runif(n,0,10), 5)     # X coordinate
y = round(runif(n,0,10), 5)     # Y coordinate
Mdist = dist2Dmatrix(cbind(x, y))
</code></pre>

<hr>
<h2 id='EM.sclm'>ML estimation of spatial censored linear models via the EM algorithm</h2><span id='topic+EM.sclm'></span>

<h3>Description</h3>

<p>It fits the left, right, or interval spatial censored linear model using the
Expectation-Maximization (EM) algorithm. It provides estimates and standard errors
of the parameters and supports missing values on the dependent variable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EM.sclm(y, x, ci, lcl = NULL, ucl = NULL, coords, phi0, nugget0,
  type = "exponential", kappa = NULL, lower = c(0.01, 0.01),
  upper = c(30, 30), MaxIter = 300, error = 1e-04, show_se = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="EM.sclm_+3A_y">y</code></td>
<td>
<p>vector of responses of length <code class="reqn">n</code>.</p>
</td></tr>
<tr><td><code id="EM.sclm_+3A_x">x</code></td>
<td>
<p>design matrix of dimensions <code class="reqn">n\times q</code>, where <code class="reqn">q</code> is the number
of fixed effects, including the intercept.</p>
</td></tr>
<tr><td><code id="EM.sclm_+3A_ci">ci</code></td>
<td>
<p>vector of censoring indicators of length <code class="reqn">n</code>. For each observation:
<code>1</code> if censored/missing, <code>0</code> otherwise.</p>
</td></tr>
<tr><td><code id="EM.sclm_+3A_lcl">lcl</code>, <code id="EM.sclm_+3A_ucl">ucl</code></td>
<td>
<p>vectors of length <code class="reqn">n</code> representing the lower and upper bounds
of the interval, which contains the true value of the censored observation. Default
<code>=NULL</code>, indicating no-censored data. For each observation: <code>lcl=-Inf</code> and
<code>ucl=c</code> (left censoring); <code>lcl=c</code> and <code>ucl=Inf</code> (right censoring); and
<code>lcl</code> and <code>ucl</code> must be finite for interval censoring. Moreover, missing data
could be defined by setting <code>lcl=-Inf</code> and <code>ucl=Inf</code>.</p>
</td></tr>
<tr><td><code id="EM.sclm_+3A_coords">coords</code></td>
<td>
<p>2D spatial coordinates of dimensions <code class="reqn">n\times 2</code>.</p>
</td></tr>
<tr><td><code id="EM.sclm_+3A_phi0">phi0</code></td>
<td>
<p>initial value for the spatial scaling parameter.</p>
</td></tr>
<tr><td><code id="EM.sclm_+3A_nugget0">nugget0</code></td>
<td>
<p>initial value for the nugget effect parameter.</p>
</td></tr>
<tr><td><code id="EM.sclm_+3A_type">type</code></td>
<td>
<p>type of spatial correlation function: <code>'exponential'</code>,
<code>'gaussian'</code>, <code>'matern'</code>, and <code>'pow.exp'</code> for exponential, gaussian,
matérn, and power exponential, respectively.</p>
</td></tr>
<tr><td><code id="EM.sclm_+3A_kappa">kappa</code></td>
<td>
<p>parameter for some spatial correlation functions. See <code><a href="#topic+CovMat">CovMat</a></code>.</p>
</td></tr>
<tr><td><code id="EM.sclm_+3A_lower">lower</code>, <code id="EM.sclm_+3A_upper">upper</code></td>
<td>
<p>vectors of lower and upper bounds for the optimization method.
If unspecified, the default is <code>c(0.01,0.01)</code> for lower and <code>c(30,30)</code>
for upper.</p>
</td></tr>
<tr><td><code id="EM.sclm_+3A_maxiter">MaxIter</code></td>
<td>
<p>maximum number of iterations for the EM algorithm. By default <code>=300</code>.</p>
</td></tr>
<tr><td><code id="EM.sclm_+3A_error">error</code></td>
<td>
<p>maximum convergence error. By default <code>=1e-4</code>.</p>
</td></tr>
<tr><td><code id="EM.sclm_+3A_show_se">show_se</code></td>
<td>
<p>logical. It indicates if the standard errors should be estimated by default <code>=TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The spatial Gaussian model is given by
</p>
<p><code class="reqn">Y = X\beta + \xi</code>,
</p>
<p>where <code class="reqn">Y</code> is the <code class="reqn">n\times 1</code> response vector, <code class="reqn">X</code> is the <code class="reqn">n\times q</code>
design matrix, <code class="reqn">\beta</code> is the <code class="reqn">q\times 1</code> vector of regression coefficients
to be estimated, and <code class="reqn">\xi</code> is the error term. Which is normally distributed with
zero-mean and covariance matrix <code class="reqn">\Sigma=\sigma^2 R(\phi) + \tau^2 I_n</code>. We assume
that <code class="reqn">\Sigma</code> is non-singular and <code class="reqn">X</code> has a full rank (Diggle and Ribeiro 2007).
</p>
<p>The estimation process is performed via the EM algorithm, initially proposed by
Dempster et al. (1977). The conditional
expectations are computed using the function <code>meanvarTMD</code> available in the
package <code>MomTrunc</code>.
</p>


<h3>Value</h3>

<p>An object of class &quot;sclm&quot;. Generic functions <code>print</code> and <code>summary</code> have
methods to show the results of the fit. The function <code>plot</code> can extract
convergence graphs for the parameter estimates.
</p>
<p>Specifically, the following components are returned:
</p>
<table>
<tr><td><code>Theta</code></td>
<td>
<p>estimated parameters in all iterations, <code class="reqn">\theta = (\beta, \sigma^2, \phi, \tau^2)</code>.</p>
</td></tr>
<tr><td><code>theta</code></td>
<td>
<p>final estimation of <code class="reqn">\theta = (\beta, \sigma^2, \phi, \tau^2)</code>.</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>estimated <code class="reqn">\beta</code>.</p>
</td></tr>
<tr><td><code>sigma2</code></td>
<td>
<p>estimated <code class="reqn">\sigma^2</code>.</p>
</td></tr>
<tr><td><code>phi</code></td>
<td>
<p>estimated <code class="reqn">\phi</code>.</p>
</td></tr>
<tr><td><code>tau2</code></td>
<td>
<p>estimated <code class="reqn">\tau^2</code>.</p>
</td></tr>
<tr><td><code>EY</code></td>
<td>
<p>first conditional moment computed in the last iteration.</p>
</td></tr>
<tr><td><code>EYY</code></td>
<td>
<p>second conditional moment computed in the last iteration.</p>
</td></tr>
<tr><td><code>SE</code></td>
<td>
<p>vector of standard errors of <code class="reqn">\theta = (\beta, \sigma^2, \phi, \tau^2)</code>.</p>
</td></tr>
<tr><td><code>InfMat</code></td>
<td>
<p>observed information matrix.</p>
</td></tr>
<tr><td><code>loglik</code></td>
<td>
<p>log-likelihood for the EM method.</p>
</td></tr>
<tr><td><code>AIC</code></td>
<td>
<p>Akaike information criterion.</p>
</td></tr>
<tr><td><code>BIC</code></td>
<td>
<p>Bayesian information criterion.</p>
</td></tr>
<tr><td><code>Iter</code></td>
<td>
<p>number of iterations needed to converge.</p>
</td></tr>
<tr><td><code>time</code></td>
<td>
<p>processing time.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p><code>RcppCensSpatial</code> call that produced the object.</p>
</td></tr>
<tr><td><code>tab</code></td>
<td>
<p>table of estimates.</p>
</td></tr>
<tr><td><code>critFin</code></td>
<td>
<p>selection criteria.</p>
</td></tr>
<tr><td><code>range</code></td>
<td>
<p>effective range.</p>
</td></tr>
<tr><td><code>ncens</code></td>
<td>
<p>number of censored/missing observations.</p>
</td></tr>
<tr><td><code>MaxIter</code></td>
<td>
<p>maximum number of iterations for the EM algorithm.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The EM final estimates correspond to the estimates obtained at the last iteration
of the EM algorithm.
</p>
<p>To fit a regression model for non-censored data, just set <code>ci</code> as a vector of zeros.
</p>


<h3>Author(s)</h3>

<p>Katherine L. Valeriano, Alejandro Ordoñez, Christian E. Galarza, and Larissa A. Matos.
</p>


<h3>References</h3>

<p>Dempster AP, Laird NM, Rubin DB (1977).
&ldquo;Maximum likelihood from incomplete data via the EM algorithm.&rdquo;
<em>Journal of the Royal Statistical Society: Series B (Methodological)</em>, <b>39</b>(1), 1&ndash;38.<br /><br /> Diggle P, Ribeiro P (2007).
<em>Model-based Geostatistics</em>.
Springer.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MCEM.sclm">MCEM.sclm</a></code>, <code><a href="#topic+SAEM.sclm">SAEM.sclm</a></code>, <code><a href="#topic+predict.sclm">predict.sclm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Simulated example: 10% of left-censored observations
set.seed(1000)
n = 50   # Test with another values for n
coords = round(matrix(runif(2*n,0,15),n,2), 5)
x = cbind(rnorm(n), runif(n))
data = rCensSp(c(-1,3), 2, 4, 0.5, x, coords, "left", 0.10, 0, "gaussian")

fit = EM.sclm(y=data$y, x=x, ci=data$ci, lcl=data$lcl, ucl=data$ucl,
              coords=coords, phi0=3, nugget0=1, type="gaussian")
fit
</code></pre>

<hr>
<h2 id='MCEM.sclm'>ML estimation of spatial censored linear models via the MCEM algorithm</h2><span id='topic+MCEM.sclm'></span>

<h3>Description</h3>

<p>It fits the left, right, or interval spatial censored linear model using the Monte
Carlo EM (MCEM) algorithm. It provides estimates and standard errors of the
parameters and supports missing values on the dependent variable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MCEM.sclm(y, x, ci, lcl = NULL, ucl = NULL, coords, phi0, nugget0,
  type = "exponential", kappa = NULL, lower = c(0.01, 0.01),
  upper = c(30, 30), MaxIter = 500, nMin = 20, nMax = 5000,
  error = 1e-04, show_se = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MCEM.sclm_+3A_y">y</code></td>
<td>
<p>vector of responses of length <code class="reqn">n</code>.</p>
</td></tr>
<tr><td><code id="MCEM.sclm_+3A_x">x</code></td>
<td>
<p>design matrix of dimensions <code class="reqn">n\times q</code>, where <code class="reqn">q</code> is the number
of fixed effects, including the intercept.</p>
</td></tr>
<tr><td><code id="MCEM.sclm_+3A_ci">ci</code></td>
<td>
<p>vector of censoring indicators of length <code class="reqn">n</code>. For each observation:
<code>1</code> if censored/missing, <code>0</code> otherwise.</p>
</td></tr>
<tr><td><code id="MCEM.sclm_+3A_lcl">lcl</code>, <code id="MCEM.sclm_+3A_ucl">ucl</code></td>
<td>
<p>vectors of length <code class="reqn">n</code> representing the lower and upper bounds
of the interval, which contains the true value of the censored observation. Default
<code>=NULL</code>, indicating no-censored data. For each observation: <code>lcl=-Inf</code> and
<code>ucl=c</code> (left censoring); <code>lcl=c</code> and <code>ucl=Inf</code> (right censoring); and
<code>lcl</code> and <code>ucl</code> must be finite for interval censoring. Moreover, missing data
could be defined by setting <code>lcl=-Inf</code> and <code>ucl=Inf</code>.</p>
</td></tr>
<tr><td><code id="MCEM.sclm_+3A_coords">coords</code></td>
<td>
<p>2D spatial coordinates of dimensions <code class="reqn">n\times 2</code>.</p>
</td></tr>
<tr><td><code id="MCEM.sclm_+3A_phi0">phi0</code></td>
<td>
<p>initial value for the spatial scaling parameter.</p>
</td></tr>
<tr><td><code id="MCEM.sclm_+3A_nugget0">nugget0</code></td>
<td>
<p>initial value for the nugget effect parameter.</p>
</td></tr>
<tr><td><code id="MCEM.sclm_+3A_type">type</code></td>
<td>
<p>type of spatial correlation function: <code>'exponential'</code>,
<code>'gaussian'</code>, <code>'matern'</code>, and <code>'pow.exp'</code> for exponential, gaussian,
matérn, and power exponential, respectively.</p>
</td></tr>
<tr><td><code id="MCEM.sclm_+3A_kappa">kappa</code></td>
<td>
<p>parameter for some spatial correlation functions. See <code><a href="#topic+CovMat">CovMat</a></code>.</p>
</td></tr>
<tr><td><code id="MCEM.sclm_+3A_lower">lower</code>, <code id="MCEM.sclm_+3A_upper">upper</code></td>
<td>
<p>vectors of lower and upper bounds for the optimization method.
If unspecified, the default is <code>c(0.01,0.01)</code> for lower and <code>c(30,30)</code> for upper.</p>
</td></tr>
<tr><td><code id="MCEM.sclm_+3A_maxiter">MaxIter</code></td>
<td>
<p>maximum number of iterations for the MCEM algorithm. By default <code>=500</code>.</p>
</td></tr>
<tr><td><code id="MCEM.sclm_+3A_nmin">nMin</code></td>
<td>
<p>initial sample size for Monte Carlo integration. By default <code>=20</code>.</p>
</td></tr>
<tr><td><code id="MCEM.sclm_+3A_nmax">nMax</code></td>
<td>
<p>maximum sample size for Monte Carlo integration. By default <code>=5000</code>.</p>
</td></tr>
<tr><td><code id="MCEM.sclm_+3A_error">error</code></td>
<td>
<p>maximum convergence error. By default <code>=1e-4</code>.</p>
</td></tr>
<tr><td><code id="MCEM.sclm_+3A_show_se">show_se</code></td>
<td>
<p>logical. It indicates if the standard errors
should be estimated by default <code>=TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The spatial Gaussian model is given by
</p>
<p><code class="reqn">Y = X\beta + \xi</code>,
</p>
<p>where <code class="reqn">Y</code> is the <code class="reqn">n\times 1</code> response vector, <code class="reqn">X</code> is the <code class="reqn">n\times q</code>
design matrix, <code class="reqn">\beta</code> is the <code class="reqn">q\times 1</code> vector of regression coefficients
to be estimated, and <code class="reqn">\xi</code> is the error term. Which is normally distributed with
zero-mean and covariance matrix <code class="reqn">\Sigma=\sigma^2 R(\phi) + \tau^2 I_n</code>. We assume
that <code class="reqn">\Sigma</code> is non-singular and <code class="reqn">X</code> has a full rank (Diggle and Ribeiro 2007).
</p>
<p>The estimation process is performed via the MCEM algorithm, initially proposed by
Wei and Tanner (1990). The Monte Carlo (MC) approximation starts
with a sample of size <code>nMin</code>; at each iteration, the sample size increases (<code>nMax-nMin</code>)/<code>MaxIter</code>,
and at the last iteration, the sample size is <code>nMax</code>. The random observations are sampled through the slice
sampling algorithm available in package <code>relliptical</code>.
</p>


<h3>Value</h3>

<p>An object of class &quot;sclm&quot;. Generic functions <code>print</code> and <code>summary</code>
have methods to show the results of the fit. The function <code>plot</code> can extract
convergence graphs for the parameter estimates.
</p>
<p>Specifically, the following components are returned:
</p>
<table>
<tr><td><code>Theta</code></td>
<td>
<p>estimated parameters in all iterations, <code class="reqn">\theta = (\beta, \sigma^2, \phi, \tau^2)</code>.</p>
</td></tr>
<tr><td><code>theta</code></td>
<td>
<p>final estimation of <code class="reqn">\theta = (\beta, \sigma^2, \phi, \tau^2)</code>.</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>estimated <code class="reqn">\beta</code>.</p>
</td></tr>
<tr><td><code>sigma2</code></td>
<td>
<p>estimated <code class="reqn">\sigma^2</code>.</p>
</td></tr>
<tr><td><code>phi</code></td>
<td>
<p>estimated <code class="reqn">\phi</code>.</p>
</td></tr>
<tr><td><code>tau2</code></td>
<td>
<p>estimated <code class="reqn">\tau^2</code>.</p>
</td></tr>
<tr><td><code>EY</code></td>
<td>
<p>MC approximation of the first conditional moment.</p>
</td></tr>
<tr><td><code>EYY</code></td>
<td>
<p>MC approximation of the second conditional moment.</p>
</td></tr>
<tr><td><code>SE</code></td>
<td>
<p>vector of standard errors of <code class="reqn">\theta = (\beta, \sigma^2, \phi, \tau^2)</code>.</p>
</td></tr>
<tr><td><code>InfMat</code></td>
<td>
<p>observed information matrix.</p>
</td></tr>
<tr><td><code>loglik</code></td>
<td>
<p>log-likelihood for the MCEM method.</p>
</td></tr>
<tr><td><code>AIC</code></td>
<td>
<p>Akaike information criterion.</p>
</td></tr>
<tr><td><code>BIC</code></td>
<td>
<p>Bayesian information criterion.</p>
</td></tr>
<tr><td><code>Iter</code></td>
<td>
<p>number of iterations needed to converge.</p>
</td></tr>
<tr><td><code>time</code></td>
<td>
<p>processing time.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p><code>RcppCensSpatial</code> call that produced the object.</p>
</td></tr>
<tr><td><code>tab</code></td>
<td>
<p>table of estimates.</p>
</td></tr>
<tr><td><code>critFin</code></td>
<td>
<p>selection criteria.</p>
</td></tr>
<tr><td><code>range</code></td>
<td>
<p>effective range.</p>
</td></tr>
<tr><td><code>ncens</code></td>
<td>
<p>number of censored/missing observations.</p>
</td></tr>
<tr><td><code>MaxIter</code></td>
<td>
<p>maximum number of iterations for the MCEM algorithm.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The MCEM final estimates correspond to the mean of the estimates obtained at each
iteration after deleting the half and applying a thinning of 3.
</p>
<p>To fit a regression model for non-censored data, just set <code>ci</code> as a vector of zeros.
</p>


<h3>Author(s)</h3>

<p>Katherine L. Valeriano, Alejandro Ordoñez, Christian E. Galarza, and Larissa A. Matos.
</p>


<h3>References</h3>

<p>Diggle P, Ribeiro P (2007).
<em>Model-based Geostatistics</em>.
Springer.<br /><br /> Wei G, Tanner M (1990).
&ldquo;A Monte Carlo implementation of the EM algorithm and the poor man's data augmentation algorithms.&rdquo;
<em>Journal of the American Statistical Association</em>, <b>85</b>(411), 699&ndash;704.
<a href="https://doi.org/10.1080/01621459.1990.10474930">doi:10.1080/01621459.1990.10474930</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+EM.sclm">EM.sclm</a></code>, <code><a href="#topic+SAEM.sclm">SAEM.sclm</a></code>, <code><a href="#topic+predict.sclm">predict.sclm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example 1: left censoring data
set.seed(1000)
n = 50   # Test with another values for n
coords = round(matrix(runif(2*n,0,15),n,2), 5)
x = cbind(rnorm(n), rnorm(n))
data = rCensSp(c(2,-1), 2, 3, 0.70, x, coords, "left", 0.08, 0, "matern", 1)

fit = MCEM.sclm(y=data$y, x=x, ci=data$ci, lcl=data$lcl, ucl=data$ucl,
                coords, phi0=2.50, nugget0=0.75, type="matern",
                kappa=1, MaxIter=30, nMax=1000)
fit$tab

# Example 2: left censoring and missing data
yMiss = data$y
yMiss[20] = NA
ci = data$ci
ci[20] = 1
ucl = data$ucl
ucl[20] = Inf

fit1 = MCEM.sclm(y=yMiss, x=x, ci=ci, lcl=data$lcl, ucl=ucl, coords,
                 phi0=2.50, nugget0=0.75, type="matern", kappa=1,
                 MaxIter=300, nMax=1000)
summary(fit1)
plot(fit1)
</code></pre>

<hr>
<h2 id='Missouri'>TCDD concentration data</h2><span id='topic+Missouri'></span>

<h3>Description</h3>

<p>The level of dioxin (2,3,7,8-tetrachlorodibenzo-p-dioxin or TCDD) data was collected
in November 1983 by the U.S. Environmental Protection Agency (EPA) in several areas
of a highway in Missouri, USA. The TCDD measurement was subject to a limit of
detection (<code>cens</code>); thereby, the <code>TCDD</code> data is left-censored. Only the
locations used in the geostatistical analysis by Zirschky and Harris (1986) are shown.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("Missouri")
</code></pre>


<h3>Format</h3>

<p>A data frame with 127 observations and five variables:
</p>

<dl>
<dt>xcoord</dt><dd><p>x coordinate of the start of each transect (ft).</p>
</dd>
<dt>ycoord</dt><dd><p>y coordinate of the start of each transect (ft).</p>
</dd>
<dt>TCDD</dt><dd><p>TCDD concentrations (mg/kg).</p>
</dd>
<dt>transect</dt><dd><p>transect length (ft).</p>
</dd>
<dt>cens</dt><dd><p>indicator of censoring (left-censored observations).</p>
</dd>
</dl>



<h3>Source</h3>

<p>Zirschky JH, Harris DJ (1986).
&ldquo;Geostatistical analysis of hazardous waste site data.&rdquo;
<em>Journal of Environmental Engineering</em>, <b>112</b>(4), 770&ndash;784.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+EM.sclm">EM.sclm</a></code>, <code><a href="#topic+MCEM.sclm">MCEM.sclm</a></code>, <code><a href="#topic+SAEM.sclm">SAEM.sclm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("Missouri")
y = log(Missouri$TCDD)
cc = Missouri$cens
coord = cbind(Missouri$xcoord/100, Missouri$ycoord)
x = matrix(1, length(y), 1)
lcl = rep(-Inf, length(y))
ucl = y

## SAEM fit
set.seed(83789)
fit1 = SAEM.sclm(y, x, cc, lcl, ucl, coord, 5, 1, lower=c(1e-5,1e-5),
                 upper=c(50,50))
fit1$tab

## MCEM fit
fit2 = MCEM.sclm(y, x, cc, lcl, ucl, coord, 5, 1, lower=c(1e-5,1e-5),
                 upper=c(50,50), MaxIter=300, nMax=1000)
fit2$tab

## Imputed values
cbind(fit1$EY, fit2$EY)[cc==1,]
</code></pre>

<hr>
<h2 id='predict.sclm'>Prediction in spatial models with censored/missing responses</h2><span id='topic+predict.sclm'></span>

<h3>Description</h3>

<p>It performs spatial prediction in a set of new <code>S</code> spatial locations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'sclm'
predict(object, locPre, xPre, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.sclm_+3A_object">object</code></td>
<td>
<p>object of class <code>'sclm'</code> given as output of <code><a href="#topic+EM.sclm">EM.sclm</a></code>,
<code><a href="#topic+MCEM.sclm">MCEM.sclm</a></code>, or <code><a href="#topic+SAEM.sclm">SAEM.sclm</a></code> function.</p>
</td></tr>
<tr><td><code id="predict.sclm_+3A_locpre">locPre</code></td>
<td>
<p>matrix of coordinates for which prediction is performed.</p>
</td></tr>
<tr><td><code id="predict.sclm_+3A_xpre">xPre</code></td>
<td>
<p>matrix of covariates for which prediction is performed.</p>
</td></tr>
<tr><td><code id="predict.sclm_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function predicts using the mean squared error (MSE) criterion, which
takes the conditional expectation E(Y|X) as the best linear predictor.
</p>


<h3>Value</h3>

<p>The function returns a list with:
</p>
<table>
<tr><td><code>coord</code></td>
<td>
<p>matrix of coordinates.</p>
</td></tr>
<tr><td><code>predValues</code></td>
<td>
<p>predicted values.</p>
</td></tr>
<tr><td><code>sdPred</code></td>
<td>
<p>predicted standard deviations.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Katherine L. Valeriano, Alejandro Ordoñez, Christian E. Galarza, and Larissa A. Matos.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+EM.sclm">EM.sclm</a></code>, <code><a href="#topic+MCEM.sclm">MCEM.sclm</a></code>, <code><a href="#topic+SAEM.sclm">SAEM.sclm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1000)
n = 120
coords = round(matrix(runif(2*n,0,15),n,2), 5)
x = cbind(rbinom(n,1,0.50), rnorm(n), rnorm(n))
data = rCensSp(c(1,4,-1), 2, 3, 0.50, x, coords, "left", 0.10, 20)

## Estimation
data1 = data$Data

# Estimation: EM algorithm
fit1 = EM.sclm(y=data1$y, x=data1$x, ci=data1$ci, lcl=data1$lcl,
               ucl=data1$ucl, coords=data1$coords, phi0=2.50, nugget0=1)

# Estimation: SAEM algorithm
fit2 = SAEM.sclm(y=data1$y, x=data1$x, ci=data1$ci, lcl=data1$lcl,
                 ucl=data1$ucl, coords=data1$coords, phi0=2.50, nugget0=1)

# Estimation: MCEM algorithm
fit3 = MCEM.sclm(y=data1$y, x=data1$x, ci=data1$ci, lcl=data1$lcl,
                 ucl=data1$ucl, coords=data1$coords, phi0=2.50, nugget0=1,
                 MaxIter=300)
cbind(fit1$theta, fit2$theta, fit3$theta)

# Prediction
data2 = data$TestData
pred1 = predict(fit1, data2$coords, data2$x)
pred2 = predict(fit2, data2$coords, data2$x)
pred3 = predict(fit3, data2$coords, data2$x)

# Cross-validation
mean((data2$y - pred1$predValues)^2)
mean((data2$y - pred2$predValues)^2)
mean((data2$y - pred3$predValues)^2)
</code></pre>

<hr>
<h2 id='rCensSp'>Censored spatial data simulation</h2><span id='topic+rCensSp'></span>

<h3>Description</h3>

<p>It simulates censored spatial data with a linear structure for an established censoring rate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rCensSp(beta, sigma2, phi, nugget, x, coords, cens = "left", pcens = 0.1,
  npred = 0, cov.model = "exponential", kappa = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rCensSp_+3A_beta">beta</code></td>
<td>
<p>linear regression parameters.</p>
</td></tr>
<tr><td><code id="rCensSp_+3A_sigma2">sigma2</code></td>
<td>
<p>partial sill parameter.</p>
</td></tr>
<tr><td><code id="rCensSp_+3A_phi">phi</code></td>
<td>
<p>spatial scaling parameter.</p>
</td></tr>
<tr><td><code id="rCensSp_+3A_nugget">nugget</code></td>
<td>
<p>nugget effect parameter.</p>
</td></tr>
<tr><td><code id="rCensSp_+3A_x">x</code></td>
<td>
<p>design matrix of dimensions <code class="reqn">n\times q</code>.</p>
</td></tr>
<tr><td><code id="rCensSp_+3A_coords">coords</code></td>
<td>
<p>2D spatial coordinates of dimensions <code class="reqn">n\times 2</code>.</p>
</td></tr>
<tr><td><code id="rCensSp_+3A_cens">cens</code></td>
<td>
<p><code>'left'</code> or <code>'right'</code> censoring. By default <code>='left'</code>.</p>
</td></tr>
<tr><td><code id="rCensSp_+3A_pcens">pcens</code></td>
<td>
<p>desired censoring rate. By default <code>=0.10</code>.</p>
</td></tr>
<tr><td><code id="rCensSp_+3A_npred">npred</code></td>
<td>
<p>number of simulated data used for cross-validation (Prediction). By default <code>=0</code>.</p>
</td></tr>
<tr><td><code id="rCensSp_+3A_cov.model">cov.model</code></td>
<td>
<p>type of spatial correlation function: <code>'exponential'</code>, <code>'gaussian'</code>,
<code>'matern'</code>, and <code>'pow.exp'</code> for exponential, gaussian, matérn, and power exponential, respectively.</p>
</td></tr>
<tr><td><code id="rCensSp_+3A_kappa">kappa</code></td>
<td>
<p>parameter for some spatial correlation functions. For exponential and
gaussian <code>kappa=NULL</code>, for power exponential <code>0 &lt; kappa &lt;= 2</code>, and for
matérn correlation function <code>kappa &gt; 0</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If <code>npred &gt; 0</code>, it returns two lists: <code>Data</code> and
<code>TestData</code>; otherwise, it returns a list with the simulated data.
</p>
<p><code>Data</code>
</p>
<table>
<tr><td><code>y</code></td>
<td>
<p>response vector.</p>
</td></tr>
<tr><td><code>ci</code></td>
<td>
<p>censoring indicator.</p>
</td></tr>
<tr><td><code>lcl</code></td>
<td>
<p>lower censoring bound.</p>
</td></tr>
<tr><td><code>ucl</code></td>
<td>
<p>upper censoring bound.</p>
</td></tr>
<tr><td><code>coords</code></td>
<td>
<p>coordinates matrix.</p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p>design matrix.</p>
</td></tr>
</table>
<p><code>TestData</code>
</p>
<table>
<tr><td><code>y</code></td>
<td>
<p>response vector.</p>
</td></tr>
<tr><td><code>coords</code></td>
<td>
<p>coordinates matrix.</p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p>design matrix.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Katherine L. Valeriano, Alejandro Ordoñez, Christian E. Galarza, and Larissa A. Matos.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n = 100
set.seed(1000)
coords = round(matrix(runif(2*n,0,15),n,2), 5)
x = cbind(1, rnorm(n))
data = rCensSp(beta=c(5,2), sigma2=2, phi=4, nugget=0.70, x=x,
               coords=coords, cens="left", pcens=0.10, npred=10,
               cov.model="gaussian")
data$Data
data$TestData
</code></pre>

<hr>
<h2 id='SAEM.sclm'>ML estimation of spatial censored linear models via the SAEM algorithm</h2><span id='topic+SAEM.sclm'></span>

<h3>Description</h3>

<p>It fits the left, right, or interval spatial censored linear model using the
Stochastic Approximation EM (SAEM) algorithm. It provides estimates and standard
errors of the parameters and supports missing values on the dependent variable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SAEM.sclm(y, x, ci, lcl = NULL, ucl = NULL, coords, phi0, nugget0,
  type = "exponential", kappa = NULL, lower = c(0.01, 0.01),
  upper = c(30, 30), MaxIter = 300, M = 20, pc = 0.2, error = 1e-04,
  show_se = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SAEM.sclm_+3A_y">y</code></td>
<td>
<p>vector of responses of length <code class="reqn">n</code>.</p>
</td></tr>
<tr><td><code id="SAEM.sclm_+3A_x">x</code></td>
<td>
<p>design matrix of dimensions <code class="reqn">n\times q</code>, where <code class="reqn">q</code> is the number
of fixed effects, including the intercept.</p>
</td></tr>
<tr><td><code id="SAEM.sclm_+3A_ci">ci</code></td>
<td>
<p>vector of censoring indicators of length <code class="reqn">n</code>. For each observation:
<code>1</code> if censored/missing, <code>0</code> otherwise.</p>
</td></tr>
<tr><td><code id="SAEM.sclm_+3A_lcl">lcl</code>, <code id="SAEM.sclm_+3A_ucl">ucl</code></td>
<td>
<p>vectors of length <code class="reqn">n</code> representing the lower and upper bounds
of the interval, which contains the true value of the censored observation. Default
<code>=NULL</code>, indicating no-censored data. For each observation: <code>lcl=-Inf</code> and
<code>ucl=c</code> (left censoring); <code>lcl=c</code> and <code>ucl=Inf</code> (right censoring); and
<code>lcl</code> and <code>ucl</code> must be finite for interval censoring. Moreover, missing data
could be defined by setting <code>lcl=-Inf</code> and <code>ucl=Inf</code>.</p>
</td></tr>
<tr><td><code id="SAEM.sclm_+3A_coords">coords</code></td>
<td>
<p>2D spatial coordinates of dimensions <code class="reqn">n\times 2</code>.</p>
</td></tr>
<tr><td><code id="SAEM.sclm_+3A_phi0">phi0</code></td>
<td>
<p>initial value for the spatial scaling parameter.</p>
</td></tr>
<tr><td><code id="SAEM.sclm_+3A_nugget0">nugget0</code></td>
<td>
<p>initial value for the nugget effect parameter.</p>
</td></tr>
<tr><td><code id="SAEM.sclm_+3A_type">type</code></td>
<td>
<p>type of spatial correlation function: <code>'exponential'</code>,
<code>'gaussian'</code>, <code>'matern'</code>, and <code>'pow.exp'</code> for exponential, gaussian,
matérn, and power exponential, respectively.</p>
</td></tr>
<tr><td><code id="SAEM.sclm_+3A_kappa">kappa</code></td>
<td>
<p>parameter for some spatial correlation functions. See <code><a href="#topic+CovMat">CovMat</a></code>.</p>
</td></tr>
<tr><td><code id="SAEM.sclm_+3A_lower">lower</code>, <code id="SAEM.sclm_+3A_upper">upper</code></td>
<td>
<p>vectors of lower and upper bounds for the optimization method.
If unspecified, the default is <code>c(0.01,0.01)</code> for lower and <code>c(30,30)</code> for upper.</p>
</td></tr>
<tr><td><code id="SAEM.sclm_+3A_maxiter">MaxIter</code></td>
<td>
<p>maximum number of iterations of the SAEM algorithm. By default <code>=300</code>.</p>
</td></tr>
<tr><td><code id="SAEM.sclm_+3A_m">M</code></td>
<td>
<p>number of Monte Carlo samples for stochastic approximation. By default <code>=20</code>.</p>
</td></tr>
<tr><td><code id="SAEM.sclm_+3A_pc">pc</code></td>
<td>
<p>percentage of initial iterations of the SAEM algorithm with no memory.
It is recommended that <code>50&lt;MaxIter*pc&lt;100</code>. By default <code>=0.20</code>.</p>
</td></tr>
<tr><td><code id="SAEM.sclm_+3A_error">error</code></td>
<td>
<p>maximum convergence error. By default <code>=1e-4</code>.</p>
</td></tr>
<tr><td><code id="SAEM.sclm_+3A_show_se">show_se</code></td>
<td>
<p>logical. It indicates if the standard errors
should be estimated by default <code>=TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The spatial Gaussian model is given by
</p>
<p><code class="reqn">Y = X\beta + \xi</code>,
</p>
<p>where <code class="reqn">Y</code> is the <code class="reqn">n\times 1</code> response vector, <code class="reqn">X</code> is the <code class="reqn">n\times q</code>
design matrix, <code class="reqn">\beta</code> is the <code class="reqn">q\times 1</code> vector of regression coefficients
to be estimated, and <code class="reqn">\xi</code> is the error term which is normally distributed with
zero-mean and covariance matrix <code class="reqn">\Sigma=\sigma^2 R(\phi) + \tau^2 I_n</code>. We assume
that <code class="reqn">\Sigma</code> is non-singular and <code class="reqn">X</code> has full rank (Diggle and Ribeiro 2007).
</p>
<p>The estimation process is performed via the SAEM algorithm, initially proposed by
Delyon et al. (1999). The spatial censored
(SAEM) algorithm was previously proposed by Lachos et al. (2017) and
Ordoñez et al. (2018) and is available in the package <code>CensSpatial</code>.
These packages differ in the random number generation and optimization procedure.
</p>
<p>This model is also a particular case of the spatio-temporal model defined by
Valeriano et al. (2021) when the number of
temporal observations is equal to one. The computing codes of the spatio-temporal
SAEM algorithm are available in the package <code>StempCens</code>.
</p>


<h3>Value</h3>

<p>An object of class &quot;sclm&quot;. Generic functions <code>print</code> and <code>summary</code> have
methods to show the results of the fit. The function <code>plot</code> can extract
convergence graphs for the parameter estimates.
</p>
<p>Specifically, the following components are returned:
</p>
<table>
<tr><td><code>Theta</code></td>
<td>
<p>estimated parameters in all iterations, <code class="reqn">\theta = (\beta, \sigma^2, \phi, \tau^2)</code>.</p>
</td></tr>
<tr><td><code>theta</code></td>
<td>
<p>final estimation of <code class="reqn">\theta = (\beta, \sigma^2, \phi, \tau^2)</code>.</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>estimated <code class="reqn">\beta</code>.</p>
</td></tr>
<tr><td><code>sigma2</code></td>
<td>
<p>estimated <code class="reqn">\sigma^2</code>.</p>
</td></tr>
<tr><td><code>phi</code></td>
<td>
<p>estimated <code class="reqn">\phi</code>.</p>
</td></tr>
<tr><td><code>tau2</code></td>
<td>
<p>estimated <code class="reqn">\tau^2</code>.</p>
</td></tr>
<tr><td><code>EY</code></td>
<td>
<p>stochastic approximation of the first conditional moment.</p>
</td></tr>
<tr><td><code>EYY</code></td>
<td>
<p>stochastic approximation of the second conditional moment.</p>
</td></tr>
<tr><td><code>SE</code></td>
<td>
<p>vector of standard errors of <code class="reqn">\theta = (\beta, \sigma^2, \phi, \tau^2)</code>.</p>
</td></tr>
<tr><td><code>InfMat</code></td>
<td>
<p>observed information matrix.</p>
</td></tr>
<tr><td><code>loglik</code></td>
<td>
<p>log-likelihood for the SAEM method.</p>
</td></tr>
<tr><td><code>AIC</code></td>
<td>
<p>Akaike information criterion.</p>
</td></tr>
<tr><td><code>BIC</code></td>
<td>
<p>Bayesian information criterion.</p>
</td></tr>
<tr><td><code>Iter</code></td>
<td>
<p>number of iterations needed to converge.</p>
</td></tr>
<tr><td><code>time</code></td>
<td>
<p>processing time.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p><code>RcppCensSpatial</code> call that produced the object.</p>
</td></tr>
<tr><td><code>tab</code></td>
<td>
<p>table of estimates.</p>
</td></tr>
<tr><td><code>critFin</code></td>
<td>
<p>selection criteria.</p>
</td></tr>
<tr><td><code>range</code></td>
<td>
<p>effective range.</p>
</td></tr>
<tr><td><code>ncens</code></td>
<td>
<p>number of censored/missing observations.</p>
</td></tr>
<tr><td><code>MaxIter</code></td>
<td>
<p>maximum number of iterations for the SAEM algorithm.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The SAEM final estimates correspond to the estimates obtained at the last iteration
of the algorithm.
</p>
<p>To fit a regression model for non-censored data, just set <code>ci</code> as a vector of zeros.
</p>


<h3>Author(s)</h3>

<p>Katherine L. Valeriano, Alejandro Ordoñez, Christian E. Galarza, and Larissa A. Matos.
</p>


<h3>References</h3>

<p>Delyon B, Lavielle M, Moulines E (1999).
&ldquo;Convergence of a stochastic approximation version of the EM algorithm.&rdquo;
<em>The Annals of Statistics</em>, <b>27</b>(1), 94&ndash;128.<br /><br /> Diggle P, Ribeiro P (2007).
<em>Model-based Geostatistics</em>.
Springer.<br /><br /> Lachos VH, Matos LA, Barbosa TS, Garay AM, Dey DK (2017).
&ldquo;Influence diagnostics in spatial models with censored response.&rdquo;
<em>Environmetrics</em>, <b>28</b>(7).<br /><br /> Ordoñez JA, Bandyopadhyay D, Lachos VH, Cabral CRB (2018).
&ldquo;Geostatistical estimation and prediction for censored responses.&rdquo;
<em>Spatial Statistics</em>, <b>23</b>, 109&ndash;123.
<a href="https://doi.org/10.1016/j.spasta.2017.12.001">doi:10.1016/j.spasta.2017.12.001</a>.<br /><br /> Valeriano KL, Lachos VH, Prates MO, Matos LA (2021).
&ldquo;Likelihood-based inference for spatiotemporal data with censored and missing responses.&rdquo;
<em>Environmetrics</em>, <b>32</b>(3).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+EM.sclm">EM.sclm</a></code>, <code><a href="#topic+MCEM.sclm">MCEM.sclm</a></code>, <code><a href="#topic+predict.sclm">predict.sclm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example 1: 8% of right-censored observations
set.seed(1000)
n = 50   # Test with another values for n
coords = round(matrix(runif(2*n,0,15),n,2), 5)
x = cbind(rnorm(n), rnorm(n))
data = rCensSp(c(4,-2), 1, 3, 0.50, x, coords, "right", 0.08)

fit = SAEM.sclm(y=data$y, x=x, ci=data$ci, lcl=data$lcl, ucl=data$ucl,
                coords, phi0=2, nugget0=1, type="exponential", M=10,
                pc=0.18)
fit

# Example 2: censored and missing observations
set.seed(123)
n = 200
coords = round(matrix(runif(2*n,0,20),n,2), 5)
x = cbind(runif(n), rnorm(n), rexp(n))
data = rCensSp(c(1,4,-1), 2, 3, 0.50, x, coords, "left", 0.05, 0,
               "matern", 3)
data$y[c(10,120)] = NA
data$ci[c(10,120)] = 1
data$ucl[c(10,120)] = Inf

fit2 = SAEM.sclm(y=data$y, x=x, ci=data$ci, lcl=data$lcl, ucl=data$ucl,
                 coords, phi0=2, nugget0=1, type="matern", kappa=3,
                 M=10, pc=0.18)
fit2$tab
plot(fit2)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
