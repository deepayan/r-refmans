<!DOCTYPE html><html><head><title>Help for package fitode</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {fitode}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#apply_link'><p>Apply link functions to model parameters</p></a></li>
<li><a href='#blowfly'><p>Nicholson's blowfly data</p></a></li>
<li><a href='#check_link'><p>Check link functions</p></a></li>
<li><a href='#coef,fitode-method'><p>Extract model coefficients from fitode objects</p></a></li>
<li><a href='#coef,fitodeMCMC-method'><p>Extract model coefficients from fitodeMCMC objects</p></a></li>
<li><a href='#confint,fitode-method'><p>Calculate confidence intervals from fitode objects for model parameters and their transformations</p></a></li>
<li><a href='#confint,fitodeMCMC-method'><p>Calculate credible intervals from fitodeMCMC objects for model parameters and their transformations</p></a></li>
<li><a href='#dfun'><p>Taylor expansion of digamma(a+b) for a&gt;&gt;b</p></a></li>
<li><a href='#dfun2'><p>Taylor expansion of trigamma(a+b) (?) for a&gt;&gt;b</p></a></li>
<li><a href='#Eval'><p>S4 generic for evaluating an object</p></a></li>
<li><a href='#Eval,loglik.ode-method'><p>Evaluate the log-likelihood model</p></a></li>
<li><a href='#fitode'><p>Fit ordinary differential equations model</p></a></li>
<li><a href='#fitode-class'><p>Class &quot;fitode&quot;.</p>
Result of ode fitting based on Maximum Likelihood Estimation</a></li>
<li><a href='#fitodeMCMC'><p>Fit ordinary differential equations model using MCMC</p></a></li>
<li><a href='#fitodeMCMC-class'><p>Class &quot;fitodeMCMC&quot;.</p>
Result of ode fitting based on Markov Chain Monte Carlo (MCMC)</a></li>
<li><a href='#fixpar'><p>Fix parameters of an ODE model</p></a></li>
<li><a href='#grad'><p>S4 generic for computing a gradient</p></a></li>
<li><a href='#grad,loglik.ode-method'><p>Evaluate the gradient of a likelihood model</p></a></li>
<li><a href='#grad,odemodel-method'><p>Evaluate the gradients of a model</p></a></li>
<li><a href='#hessian'><p>S4 generic for computing a hessian</p></a></li>
<li><a href='#initialize,loglik.ode-method'><p>The initializer for loglik.ode</p></a></li>
<li><a href='#initialize,odemodel-method'><p>Constructor method of &quot;odemodel&quot; class</p></a></li>
<li><a href='#initialize,prior.ode-method'><p>the initializer for prior.ode</p></a></li>
<li><a href='#initialize,solution.ode-method'><p>Constructor for solution.ode class</p></a></li>
<li><a href='#jacobian'><p>S4 generic for computing a jacobian</p></a></li>
<li><a href='#jacobian,odemodel-method'><p>Evaluate the jacobian of the gradients</p></a></li>
<li><a href='#logLik,fitode-method'><p>Extract log-likelihood</p></a></li>
<li><a href='#loglik.ode-class'><p>Class representing log-likelihood models used to fit ode models</p></a></li>
<li><a href='#logLik.sensitivity'><p>Calculate the derivative of the log-likelihood function</p></a></li>
<li><a href='#make_prior'><p>Make a list containing log prior density and its gradient</p></a></li>
<li><a href='#ode.sensitivity'><p>Calculate the derivative of the mean expression</p></a></li>
<li><a href='#ode.solve'><p>solve ode models</p></a></li>
<li><a href='#odemodel-class'><p>Class &quot;odemodel&quot; representing ode models</p></a></li>
<li><a href='#plot_internal'><p>Internal function for plotting methods</p></a></li>
<li><a href='#plot,fitode,missing-method'><p>Plot a fitode object</p></a></li>
<li><a href='#plot,fitodeMCMC,missing-method'><p>Plot a fitodeMCMC object</p></a></li>
<li><a href='#predict,fitode-method'><p>Prediction function for fitode objects</p></a></li>
<li><a href='#predict,fitodeMCMC-method'><p>Prediction function for fitodeMCMC objects</p></a></li>
<li><a href='#prior.ode-class'><p>Class representing prior models used to fit ode models</p></a></li>
<li><a href='#profile,fitode-method'><p>Profile fitode objects</p></a></li>
<li><a href='#select_model'><p>Select a log-likelihood model</p></a></li>
<li><a href='#select_prior'><p>Select a prior model</p></a></li>
<li><a href='#set_link'><p>Set up link functions for model parameters</p></a></li>
<li><a href='#show,fitode-method'><p>Show fitode objects</p></a></li>
<li><a href='#show,fitodeMCMC-method'><p>Show fitodeMCMC object</p></a></li>
<li><a href='#show,odemodel-method'><p>Show the model</p></a></li>
<li><a href='#SierraLeone2014'><p>Data from 2014 Sierra Leone Ebola epidemic</p></a></li>
<li><a href='#simulate_internal'><p>Internal function for simulation models</p></a></li>
<li><a href='#simulate,fitode-method'><p>simulate fitode objects</p></a></li>
<li><a href='#simulate,odemodel-method'><p>simulate model objects</p></a></li>
<li><a href='#solution.ode-class'><p>Class &quot;solution.ode&quot;.</p>
Result of solving ode modeld with/without sensitivity equations</a></li>
<li><a href='#stdEr,fitode-method'><p>Extract standard error from fitode objects</p></a></li>
<li><a href='#stdEr,fitodeMCMC-method'><p>Extract standard error from fitodeMCMC objects</p></a></li>
<li><a href='#summary,fitode-method'><p>Summarize fitode object</p></a></li>
<li><a href='#summary,fitodeMCMC-method'><p>Summarize fitodeMCMC object</p></a></li>
<li><a href='#Transform'><p>S4 generic for transforming an object</p></a></li>
<li><a href='#Transform,loglik.ode-method'><p>Transform the model</p></a></li>
<li><a href='#Transform,odemodel-method'><p>Transform the model</p></a></li>
<li><a href='#Transform,prior.ode-method'><p>Transform the prior model</p></a></li>
<li><a href='#tumorgrowth'><p>Tumor growth data</p></a></li>
<li><a href='#update,fitode-method'><p>Update fitode fits</p></a></li>
<li><a href='#update,fitodeMCMC-method'><p>Update fitodeMCMC fits</p></a></li>
<li><a href='#vcov,fitode-method'><p>Extract variance-covariance matrix from fitode objects</p></a></li>
<li><a href='#vcov,fitodeMCMC-method'><p>Extract variance-covariance matrix from fitodeMCMC objects</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Tools for Ordinary Differential Equations Model Fitting</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Methods and functions for fitting ordinary differential equations (ODE) model in 'R'. Sensitivity equations are used to compute the gradients of ODE trajectories with respect to underlying parameters, which in turn allows for more stable fitting. Other fitting methods, such as MCMC (Markov chain Monte Carlo), are also available.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0), bbmle</td>
</tr>
<tr>
<td>Imports:</td>
<td>deSolve, Deriv, MASS, numDeriv, mvtnorm, coda, methods</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, ggplot2, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-10-26 16:53:41 UTC; swp2</td>
</tr>
<tr>
<td>Author:</td>
<td>Sang Woo Park <a href="https://orcid.org/0000-0003-2202-3361"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Ben Bolker <a href="https://orcid.org/0000-0002-2127-0443"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Sang Woo Park &lt;swp2@princeton.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-10-29 08:50:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='apply_link'>Apply link functions to model parameters</h2><span id='topic+apply_link'></span>

<h3>Description</h3>

<p>Apply link functions to model parameters &ndash; for <code><a href="#topic+fitode">fitode</a></code>
internal usage. <code>type=linkfun</code> applies link functions;
<code>type=linkinv</code> applies inverse link functions; <code>type=mu.eta</code>
returns derivative of inverse link functions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>apply_link(par, linklist, type = c("linkfun", "linkinv", "mu.eta"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="apply_link_+3A_par">par</code></td>
<td>
<p>named vector of parameter values</p>
</td></tr>
<tr><td><code id="apply_link_+3A_linklist">linklist</code></td>
<td>
<p>list containing <code>linkfun</code>, <code>linkinv</code>, and <code>mu.eta</code> for each link</p>
</td></tr>
<tr><td><code id="apply_link_+3A_type">type</code></td>
<td>
<p>string specifying which function should be applied</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector of parameter values with link transformations
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+make.link">make.link</a></code>
</p>

<hr>
<h2 id='blowfly'>Nicholson's blowfly data</h2><span id='topic+blowfly'></span>

<h3>Description</h3>

<p>...
</p>


<h3>Usage</h3>

<pre><code class='language-R'>blowfly
</code></pre>


<h3>Format</h3>

<p>A data frame containing 361 rows comprising:
</p>

<dl>
<dt>eggs</dt><dd><p>number of eggs</p>
</dd>
<dt>nonemerging</dt><dd><p>?</p>
</dd>
<dt>emerging</dt><dd><p>?</p>
</dd>
<dt>deaths</dt><dd><p>?</p>
</dd>
<dt>total</dt><dd><p>?</p>
</dd>
</dl>


<hr>
<h2 id='check_link'>Check link functions</h2><span id='topic+check_link'></span>

<h3>Description</h3>

<p>Check link functions for model parameters &ndash; for <code><a href="#topic+fitode">fitode</a></code>
internal usage
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_link(model, link)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_link_+3A_model">model</code></td>
<td>
<p>odemodel object</p>
</td></tr>
<tr><td><code id="check_link_+3A_link">link</code></td>
<td>
<p>named vector specifying link functions</p>
</td></tr>
</table>

<hr>
<h2 id='coef+2Cfitode-method'>Extract model coefficients from fitode objects</h2><span id='topic+coef+2Cfitode-method'></span>

<h3>Description</h3>

<p>Extracts estimated parameters (either on response scales or link scales)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'fitode'
coef(object, type = c("response", "links"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coef+2B2Cfitode-method_+3A_object">object</code></td>
<td>
<p>fitode object</p>
</td></tr>
<tr><td><code id="coef+2B2Cfitode-method_+3A_type">type</code></td>
<td>
<p>type of coefficients. The default (<code>type=response</code>) is on the
response scale; this is the scale on which the model parameters are defined.
Alternatively, <code>type=link</code> can be used to obtain parameters on the estimated scale.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The estimated coefficients of the fitode object
</p>

<hr>
<h2 id='coef+2CfitodeMCMC-method'>Extract model coefficients from fitodeMCMC objects</h2><span id='topic+coef+2CfitodeMCMC-method'></span>

<h3>Description</h3>

<p>Extracts estimated parameters (median of the marginal posterior distributions)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'fitodeMCMC'
coef(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coef+2B2CfitodeMCMC-method_+3A_object">object</code></td>
<td>
<p>fitodeMCMC object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The estimated median coefficients of the fitodeMCMC object
</p>

<hr>
<h2 id='confint+2Cfitode-method'>Calculate confidence intervals from fitode objects for model parameters and their transformations</h2><span id='topic+confint+2Cfitode-method'></span>

<h3>Description</h3>

<p>Calculate confidence intervals for model parameters and their transformations using
(1) delta method, (2) profile likelihood, and (3) importance sampling.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'fitode'
confint(
  object,
  parm,
  level = 0.95,
  method = c("delta", "profile", "impsamp", "wmvrnorm"),
  nsim = 1000,
  seed,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="confint+2B2Cfitode-method_+3A_object">object</code></td>
<td>
<p>fitode object</p>
</td></tr>
<tr><td><code id="confint+2B2Cfitode-method_+3A_parm">parm</code></td>
<td>
<p>character vector specifying model parameters or list of formuals specifying transformations</p>
</td></tr>
<tr><td><code id="confint+2B2Cfitode-method_+3A_level">level</code></td>
<td>
<p>the confidence level required</p>
</td></tr>
<tr><td><code id="confint+2B2Cfitode-method_+3A_method">method</code></td>
<td>
<p>method for calculating confidence intervals</p>
</td></tr>
<tr><td><code id="confint+2B2Cfitode-method_+3A_nsim">nsim</code></td>
<td>
<p>number of simulations to be used for importance sampling</p>
</td></tr>
<tr><td><code id="confint+2B2Cfitode-method_+3A_seed">seed</code></td>
<td>
<p>seed</p>
</td></tr>
<tr><td><code id="confint+2B2Cfitode-method_+3A_...">...</code></td>
<td>
<p>extra arguments passed to profiling method</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The confidence intervals for model parameters and their transformations of the fitode object
</p>

<hr>
<h2 id='confint+2CfitodeMCMC-method'>Calculate credible intervals from fitodeMCMC objects for model parameters and their transformations</h2><span id='topic+confint+2CfitodeMCMC-method'></span>

<h3>Description</h3>

<p>Calculate credible intervals for model parameters and their transformations
from posterior samples.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'fitodeMCMC'
confint(object, parm, level = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="confint+2B2CfitodeMCMC-method_+3A_object">object</code></td>
<td>
<p>fitodeMCMC object</p>
</td></tr>
<tr><td><code id="confint+2B2CfitodeMCMC-method_+3A_parm">parm</code></td>
<td>
<p>character vector specifying model parameters or list of formuals specifying transformations</p>
</td></tr>
<tr><td><code id="confint+2B2CfitodeMCMC-method_+3A_level">level</code></td>
<td>
<p>the credible level required</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The credible intervals of the fitodeMCMC object
</p>

<hr>
<h2 id='dfun'>Taylor expansion of digamma(a+b) for a&gt;&gt;b</h2><span id='topic+dfun'></span>

<h3>Description</h3>

<p>Taylor expansion of digamma(a+b) for a&gt;&gt;b
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dfun(x, y, mag = 1e+08)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dfun_+3A_x">x</code></td>
<td>
<p>first argument</p>
</td></tr>
<tr><td><code id="dfun_+3A_y">y</code></td>
<td>
<p>second argument</p>
</td></tr>
<tr><td><code id="dfun_+3A_mag">mag</code></td>
<td>
<p>cutoff magnitude for switching approximations</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric
</p>

<hr>
<h2 id='dfun2'>Taylor expansion of trigamma(a+b) (?) for a&gt;&gt;b</h2><span id='topic+dfun2'></span>

<h3>Description</h3>

<p>Taylor expansion of trigamma(a+b) (?) for a&gt;&gt;b
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dfun2(x, y, mag = 1e+08, focal = "x")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dfun2_+3A_x">x</code></td>
<td>
<p>first argument</p>
</td></tr>
<tr><td><code id="dfun2_+3A_y">y</code></td>
<td>
<p>second argument</p>
</td></tr>
<tr><td><code id="dfun2_+3A_mag">mag</code></td>
<td>
<p>cutoff magnitude for switching approximations</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric
</p>

<hr>
<h2 id='Eval'>S4 generic for evaluating an object</h2><span id='topic+Eval'></span>

<h3>Description</h3>

<p>S4 generic for evaluating an object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Eval(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Eval_+3A_object">object</code></td>
<td>
<p>an <code>R</code> object</p>
</td></tr>
<tr><td><code id="Eval_+3A_...">...</code></td>
<td>
<p>further arguments passed to methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The result of evaluating the object.
</p>

<hr>
<h2 id='Eval+2Cloglik.ode-method'>Evaluate the log-likelihood model</h2><span id='topic+Eval+2Cloglik.ode-method'></span>

<h3>Description</h3>

<p>Evaluate the log-likelihood model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'loglik.ode'
Eval(object, observation, mean, par = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Eval+2B2Cloglik.ode-method_+3A_object">object</code></td>
<td>
<p>loglik.ode object</p>
</td></tr>
<tr><td><code id="Eval+2B2Cloglik.ode-method_+3A_observation">observation</code></td>
<td>
<p>observations</p>
</td></tr>
<tr><td><code id="Eval+2B2Cloglik.ode-method_+3A_mean">mean</code></td>
<td>
<p>mean values</p>
</td></tr>
<tr><td><code id="Eval+2B2Cloglik.ode-method_+3A_par">par</code></td>
<td>
<p>additional parameters</p>
</td></tr>
<tr><td><code id="Eval+2B2Cloglik.ode-method_+3A_...">...</code></td>
<td>
<p>other values if required</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric
</p>

<hr>
<h2 id='fitode'>Fit ordinary differential equations model</h2><span id='topic+fitode'></span>

<h3>Description</h3>

<p>This function fits ordinary differential equations models to a uni- or
multi-variate time series by maximum likelihood.
It relies on sensitivity equations to compute
gradients of the estimated trajectory with respect to model parameters.
This allows one to use gradient-based optimization algorithms, which can
provide more robust estimation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitode(
  model,
  data,
  start,
  tcol = "times",
  method = "BFGS",
  optimizer = "optim",
  link,
  fixed = list(),
  prior = list(),
  prior.density = TRUE,
  control = list(maxit = 1e+05),
  solver.opts = list(method = "rk4"),
  solver = ode,
  skip.hessian = FALSE,
  force.hessian = FALSE,
  use.ginv = TRUE,
  quietly = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitode_+3A_model">model</code></td>
<td>
<p>odemodel object</p>
</td></tr>
<tr><td><code id="fitode_+3A_data">data</code></td>
<td>
<p>data frame with a time column and observation columns</p>
</td></tr>
<tr><td><code id="fitode_+3A_start">start</code></td>
<td>
<p>named vector of starting parameter values</p>
</td></tr>
<tr><td><code id="fitode_+3A_tcol">tcol</code></td>
<td>
<p>(character) time column</p>
</td></tr>
<tr><td><code id="fitode_+3A_method">method</code></td>
<td>
<p>optimization method</p>
</td></tr>
<tr><td><code id="fitode_+3A_optimizer">optimizer</code></td>
<td>
<p>optimizer</p>
</td></tr>
<tr><td><code id="fitode_+3A_link">link</code></td>
<td>
<p>named vector or list of link functions for model parameters</p>
</td></tr>
<tr><td><code id="fitode_+3A_fixed">fixed</code></td>
<td>
<p>named vector or list of model parameters to fix and their values</p>
</td></tr>
<tr><td><code id="fitode_+3A_prior">prior</code></td>
<td>
<p>list of formulas specifying prior distributions</p>
</td></tr>
<tr><td><code id="fitode_+3A_prior.density">prior.density</code></td>
<td>
<p>(logical) should priors represent probability distributions?</p>
</td></tr>
<tr><td><code id="fitode_+3A_control">control</code></td>
<td>
<p>see <code><a href="stats.html#topic+optim">optim</a></code></p>
</td></tr>
<tr><td><code id="fitode_+3A_solver.opts">solver.opts</code></td>
<td>
<p>options for ode integration. See <code><a href="deSolve.html#topic+ode">ode</a></code></p>
</td></tr>
<tr><td><code id="fitode_+3A_solver">solver</code></td>
<td>
<p>ode solver</p>
</td></tr>
<tr><td><code id="fitode_+3A_skip.hessian">skip.hessian</code></td>
<td>
<p>skip hessian calculation</p>
</td></tr>
<tr><td><code id="fitode_+3A_force.hessian">force.hessian</code></td>
<td>
<p>(logical) calculate the hessian numerically instead of taking the jacobian of the gradients based on sensitivity equations</p>
</td></tr>
<tr><td><code id="fitode_+3A_use.ginv">use.ginv</code></td>
<td>
<p>(logical) use generalized inverse (<code><a href="MASS.html#topic+ginv">ginv</a></code>) to compute approximate vcov</p>
</td></tr>
<tr><td><code id="fitode_+3A_quietly">quietly</code></td>
<td>
<p>suppress progress messages?</p>
</td></tr>
<tr><td><code id="fitode_+3A_...">...</code></td>
<td>
<p>mle2 arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class &ldquo;fitode&rdquo; as described in <code><a href="#topic+fitode-class">fitode-class</a></code>.
</p>


<h3>See Also</h3>

<p><code><a href="bbmle.html#topic+mle2">mle2</a></code>
</p>

<hr>
<h2 id='fitode-class'>Class &quot;fitode&quot;.
Result of ode fitting based on Maximum Likelihood Estimation</h2><span id='topic+fitode-class'></span>

<h3>Description</h3>

<p>Class &quot;fitode&quot;.
Result of ode fitting based on Maximum Likelihood Estimation
</p>


<h3>Slots</h3>


<dl>
<dt><code>call</code></dt><dd><p>(languge) The call to <code><a href="#topic+fitode">fitode</a></code></p>
</dd>
<dt><code>model</code></dt><dd><p>odemodel object</p>
</dd>
<dt><code>data</code></dt><dd><p>the time series data</p>
</dd>
<dt><code>coef</code></dt><dd><p>estimated parameters</p>
</dd>
<dt><code>vcov</code></dt><dd><p>estimated variance-covariance matrix</p>
</dd>
<dt><code>min</code></dt><dd><p>minimum negative log-likelihood</p>
</dd>
<dt><code>mle2</code></dt><dd><p>mle2 object</p>
</dd>
<dt><code>link</code></dt><dd><p>list of link functions for model parameters</p>
</dd>
<dt><code>fixed</code></dt><dd><p>list of fixed parameters</p>
</dd>
<dt><code>prior</code></dt><dd><p>list of priors</p>
</dd>
</dl>


<h3>See Also</h3>

<p><code><a href="bbmle.html#topic+mle2-class">mle2-class</a></code>
</p>

<hr>
<h2 id='fitodeMCMC'>Fit ordinary differential equations model using MCMC</h2><span id='topic+fitodeMCMC'></span>

<h3>Description</h3>

<p>This function fits ordinary differential equations models to a uni- or
multi-variate time series by MCMC using the Metropolis-Hastings update
rule. It searches through the parameter space
on link scales, which can provide more efficient posterior sampling.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitodeMCMC(
  model,
  data,
  start,
  tcol = "times",
  proposal.vcov,
  prior = list(),
  chains = 1,
  iter = 2000,
  burnin = iter/2,
  thin = 1,
  refresh = max(iter/10, 1),
  prior.only = FALSE,
  link,
  fixed = list(),
  solver.opts = list(method = "rk4"),
  solver = ode,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitodeMCMC_+3A_model">model</code></td>
<td>
<p>ode model</p>
</td></tr>
<tr><td><code id="fitodeMCMC_+3A_data">data</code></td>
<td>
<p>data frame with time column and observation column</p>
</td></tr>
<tr><td><code id="fitodeMCMC_+3A_start">start</code></td>
<td>
<p>named vector of starting parameter values</p>
</td></tr>
<tr><td><code id="fitodeMCMC_+3A_tcol">tcol</code></td>
<td>
<p>time column</p>
</td></tr>
<tr><td><code id="fitodeMCMC_+3A_proposal.vcov">proposal.vcov</code></td>
<td>
<p>variance-covariance matrix of a multivariate normal proposal distribution</p>
</td></tr>
<tr><td><code id="fitodeMCMC_+3A_prior">prior</code></td>
<td>
<p>list of formulas specifying prior distributions</p>
</td></tr>
<tr><td><code id="fitodeMCMC_+3A_chains">chains</code></td>
<td>
<p>(numeric) number of chains</p>
</td></tr>
<tr><td><code id="fitodeMCMC_+3A_iter">iter</code></td>
<td>
<p>(numeric) number of iterations per chain</p>
</td></tr>
<tr><td><code id="fitodeMCMC_+3A_burnin">burnin</code></td>
<td>
<p>(numeric) number of burnin interations</p>
</td></tr>
<tr><td><code id="fitodeMCMC_+3A_thin">thin</code></td>
<td>
<p>(numeric) thining interval between consecutive observations</p>
</td></tr>
<tr><td><code id="fitodeMCMC_+3A_refresh">refresh</code></td>
<td>
<p>(numeric) refresh interval</p>
</td></tr>
<tr><td><code id="fitodeMCMC_+3A_prior.only">prior.only</code></td>
<td>
<p>(logical) sample from prior distribution only?</p>
</td></tr>
<tr><td><code id="fitodeMCMC_+3A_link">link</code></td>
<td>
<p>named vector or list of link functions for model parameters</p>
</td></tr>
<tr><td><code id="fitodeMCMC_+3A_fixed">fixed</code></td>
<td>
<p>named vector or list of model parameters to fix and their values</p>
</td></tr>
<tr><td><code id="fitodeMCMC_+3A_solver.opts">solver.opts</code></td>
<td>
<p>options for ode integration. See <code><a href="deSolve.html#topic+ode">ode</a></code></p>
</td></tr>
<tr><td><code id="fitodeMCMC_+3A_solver">solver</code></td>
<td>
<p>ode solver</p>
</td></tr>
<tr><td><code id="fitodeMCMC_+3A_...">...</code></td>
<td>
<p>additional arguments (unused)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class &ldquo;fitodeMCMC&rdquo; as described in <code><a href="#topic+fitodeMCMC-class">fitodeMCMC-class</a></code>.
</p>

<hr>
<h2 id='fitodeMCMC-class'>Class &quot;fitodeMCMC&quot;.
Result of ode fitting based on Markov Chain Monte Carlo (MCMC)</h2><span id='topic+fitodeMCMC-class'></span>

<h3>Description</h3>

<p>Class &quot;fitodeMCMC&quot;.
Result of ode fitting based on Markov Chain Monte Carlo (MCMC)
</p>


<h3>Slots</h3>


<dl>
<dt><code>call</code></dt><dd><p>(languge) The call to <code><a href="#topic+fitodeMCMC">fitodeMCMC</a></code></p>
</dd>
<dt><code>model</code></dt><dd><p>odemodel object</p>
</dd>
<dt><code>data</code></dt><dd><p>the time series data</p>
</dd>
<dt><code>coef</code></dt><dd><p>estimated parameters (posterior median)</p>
</dd>
<dt><code>vcov</code></dt><dd><p>estimated variance-covariance matrix</p>
</dd>
<dt><code>mcmc</code></dt><dd><p>mcmc.list object containing posterior samples</p>
</dd>
<dt><code>lp</code></dt><dd><p>mcmc.list object containing log-posterior values of posterior samples</p>
</dd>
<dt><code>link</code></dt><dd><p>list of link functions for model parameters</p>
</dd>
<dt><code>fixed</code></dt><dd><p>list of fixed parameters</p>
</dd>
<dt><code>prior</code></dt><dd><p>list of priors</p>
</dd>
<dt><code>details</code></dt><dd><p>a list containing miscellaneous objects for internal uses</p>
</dd>
</dl>

<hr>
<h2 id='fixpar'>Fix parameters of an ODE model</h2><span id='topic+fixpar'></span>

<h3>Description</h3>

<p>Fix parameters of an ODE model to a constant value by transforming
the model (using Transform() function)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fixpar(model, fixed)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fixpar_+3A_model">model</code></td>
<td>
<p>odemodel object</p>
</td></tr>
<tr><td><code id="fixpar_+3A_fixed">fixed</code></td>
<td>
<p>named vector or list of model parameters to fix</p>
</td></tr>
</table>

<hr>
<h2 id='grad'>S4 generic for computing a gradient</h2><span id='topic+grad'></span>

<h3>Description</h3>

<p>S4 generic for computing a gradient
</p>


<h3>Usage</h3>

<pre><code class='language-R'>grad(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="grad_+3A_object">object</code></td>
<td>
<p>an <code>R</code> object</p>
</td></tr>
<tr><td><code id="grad_+3A_...">...</code></td>
<td>
<p>further arguments passed to methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The gradient of the object.
</p>

<hr>
<h2 id='grad+2Cloglik.ode-method'>Evaluate the gradient of a likelihood model</h2><span id='topic+grad+2Cloglik.ode-method'></span>

<h3>Description</h3>

<p>Evaluate the gradient of a likelihood model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'loglik.ode'
grad(object, observation, mean, par, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="grad+2B2Cloglik.ode-method_+3A_object">object</code></td>
<td>
<p>loglik.ode object</p>
</td></tr>
<tr><td><code id="grad+2B2Cloglik.ode-method_+3A_observation">observation</code></td>
<td>
<p>observations</p>
</td></tr>
<tr><td><code id="grad+2B2Cloglik.ode-method_+3A_mean">mean</code></td>
<td>
<p>mean values</p>
</td></tr>
<tr><td><code id="grad+2B2Cloglik.ode-method_+3A_par">par</code></td>
<td>
<p>additional parameters</p>
</td></tr>
<tr><td><code id="grad+2B2Cloglik.ode-method_+3A_...">...</code></td>
<td>
<p>other values if required</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list with each element as a partial derivative values
</p>

<hr>
<h2 id='grad+2Codemodel-method'>Evaluate the gradients of a model</h2><span id='topic+grad+2Codemodel-method'></span>

<h3>Description</h3>

<p>Evaluate the gradients of a model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'odemodel'
grad(object, state, par)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="grad+2B2Codemodel-method_+3A_object">object</code></td>
<td>
<p>odemodel object</p>
</td></tr>
<tr><td><code id="grad+2B2Codemodel-method_+3A_state">state</code></td>
<td>
<p>state</p>
</td></tr>
<tr><td><code id="grad+2B2Codemodel-method_+3A_par">par</code></td>
<td>
<p>parameter values</p>
</td></tr>
</table>

<hr>
<h2 id='hessian'>S4 generic for computing a hessian</h2><span id='topic+hessian'></span>

<h3>Description</h3>

<p>S4 generic for computing a hessian
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hessian(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hessian_+3A_object">object</code></td>
<td>
<p>an <code>R</code> object</p>
</td></tr>
<tr><td><code id="hessian_+3A_...">...</code></td>
<td>
<p>further arguments passed to methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The hessian of the object.
</p>

<hr>
<h2 id='initialize+2Cloglik.ode-method'>The initializer for loglik.ode</h2><span id='topic+initialize+2Cloglik.ode-method'></span>

<h3>Description</h3>

<p>The initializer for loglik.ode
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'loglik.ode'
initialize(
  .Object,
  name,
  model,
  observation = "X",
  mean,
  par = NULL,
  keep_grad = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="initialize+2B2Cloglik.ode-method_+3A_.object">.Object</code></td>
<td>
<p>object</p>
</td></tr>
<tr><td><code id="initialize+2B2Cloglik.ode-method_+3A_name">name</code></td>
<td>
<p>name of the distribution</p>
</td></tr>
<tr><td><code id="initialize+2B2Cloglik.ode-method_+3A_model">model</code></td>
<td>
<p>formula specifying the disstribution</p>
</td></tr>
<tr><td><code id="initialize+2B2Cloglik.ode-method_+3A_observation">observation</code></td>
<td>
<p>observation variable name</p>
</td></tr>
<tr><td><code id="initialize+2B2Cloglik.ode-method_+3A_mean">mean</code></td>
<td>
<p>mean variable name</p>
</td></tr>
<tr><td><code id="initialize+2B2Cloglik.ode-method_+3A_par">par</code></td>
<td>
<p>additional parameter names</p>
</td></tr>
<tr><td><code id="initialize+2B2Cloglik.ode-method_+3A_keep_grad">keep_grad</code></td>
<td>
<p>maintain the gradient as part of the model</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class &ldquo;loglik.ode&rdquo; as described in <code><a href="#topic+loglik.ode-class">loglik.ode-class</a></code>.
</p>

<hr>
<h2 id='initialize+2Codemodel-method'>Constructor method of &quot;odemodel&quot; class</h2><span id='topic+initialize+2Codemodel-method'></span>

<h3>Description</h3>

<p>Constructor method of &quot;odemodel&quot; class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'odemodel'
initialize(
  .Object,
  name,
  model,
  observation,
  initial,
  par,
  link,
  diffnames,
  keep_sensitivity = TRUE,
  call
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="initialize+2B2Codemodel-method_+3A_.object">.Object</code></td>
<td>
<p>object</p>
</td></tr>
<tr><td><code id="initialize+2B2Codemodel-method_+3A_name">name</code></td>
<td>
<p>name of the model</p>
</td></tr>
<tr><td><code id="initialize+2B2Codemodel-method_+3A_model">model</code></td>
<td>
<p>ode model</p>
</td></tr>
<tr><td><code id="initialize+2B2Codemodel-method_+3A_observation">observation</code></td>
<td>
<p>observation model</p>
</td></tr>
<tr><td><code id="initialize+2B2Codemodel-method_+3A_initial">initial</code></td>
<td>
<p>initial values</p>
</td></tr>
<tr><td><code id="initialize+2B2Codemodel-method_+3A_par">par</code></td>
<td>
<p>model parameters</p>
</td></tr>
<tr><td><code id="initialize+2B2Codemodel-method_+3A_link">link</code></td>
<td>
<p>link functions for parameters (log links are used as default)</p>
</td></tr>
<tr><td><code id="initialize+2B2Codemodel-method_+3A_diffnames">diffnames</code></td>
<td>
<p>optional character vector specifying the names of a variable for which the consecutive difference needs to be calculated</p>
</td></tr>
<tr><td><code id="initialize+2B2Codemodel-method_+3A_keep_sensitivity">keep_sensitivity</code></td>
<td>
<p>(logical) maintain the Jacobian as a part of the model object?</p>
</td></tr>
<tr><td><code id="initialize+2B2Codemodel-method_+3A_call">call</code></td>
<td>
<p>original function call</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class &ldquo;odemodel&rdquo; as described in <code><a href="#topic+odemodel-class">odemodel-class</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>SI_model &lt;- odemodel(
    name = "SI",
    model = list(
        S ~ - beta*S*I/N,
        I ~ beta*S*I/N - gamma*I
    ),
    observation = list(
        susceptible ~ dnorm(mean=S, sd=sigma1),
        infected ~ dnorm(mean=I, sd=sigma2)
    ),
    initial = list(
        S ~ N * (1 - i0),
        I ~ N * i0
    ),
    par = c("beta", "gamma", "N", "i0", "sigma1", "sigma2"),
    link = c(i0="logit")
)
</code></pre>

<hr>
<h2 id='initialize+2Cprior.ode-method'>the initializer for prior.ode</h2><span id='topic+initialize+2Cprior.ode-method'></span>

<h3>Description</h3>

<p>the initializer for prior.ode
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'prior.ode'
initialize(
  .Object,
  name,
  model,
  observation = "X",
  par = NULL,
  keep_grad = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="initialize+2B2Cprior.ode-method_+3A_.object">.Object</code></td>
<td>
<p>object</p>
</td></tr>
<tr><td><code id="initialize+2B2Cprior.ode-method_+3A_name">name</code></td>
<td>
<p>name of the distribution</p>
</td></tr>
<tr><td><code id="initialize+2B2Cprior.ode-method_+3A_model">model</code></td>
<td>
<p>the formula specifying the model</p>
</td></tr>
<tr><td><code id="initialize+2B2Cprior.ode-method_+3A_observation">observation</code></td>
<td>
<p>observation variable name</p>
</td></tr>
<tr><td><code id="initialize+2B2Cprior.ode-method_+3A_par">par</code></td>
<td>
<p>additional parameter names</p>
</td></tr>
<tr><td><code id="initialize+2B2Cprior.ode-method_+3A_keep_grad">keep_grad</code></td>
<td>
<p>maintain the gradient as part of the model</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class &ldquo;prior.ode&rdquo; as described in <code><a href="#topic+prior.ode-class">prior.ode-class</a></code>.
</p>

<hr>
<h2 id='initialize+2Csolution.ode-method'>Constructor for solution.ode class</h2><span id='topic+initialize+2Csolution.ode-method'></span>

<h3>Description</h3>

<p>Constructor for solution.ode class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'solution.ode'
initialize(
  .Object,
  y,
  times,
  model,
  parms,
  solver.opts = list(method = "rk4"),
  solver = ode
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="initialize+2B2Csolution.ode-method_+3A_.object">.Object</code></td>
<td>
<p>object</p>
</td></tr>
<tr><td><code id="initialize+2B2Csolution.ode-method_+3A_y">y</code></td>
<td>
<p>initial values</p>
</td></tr>
<tr><td><code id="initialize+2B2Csolution.ode-method_+3A_times">times</code></td>
<td>
<p>time vector</p>
</td></tr>
<tr><td><code id="initialize+2B2Csolution.ode-method_+3A_model">model</code></td>
<td>
<p>ode model</p>
</td></tr>
<tr><td><code id="initialize+2B2Csolution.ode-method_+3A_parms">parms</code></td>
<td>
<p>parameters of the solution</p>
</td></tr>
<tr><td><code id="initialize+2B2Csolution.ode-method_+3A_solver.opts">solver.opts</code></td>
<td>
<p>options for ode solver</p>
</td></tr>
<tr><td><code id="initialize+2B2Csolution.ode-method_+3A_solver">solver</code></td>
<td>
<p>ode solver (must take y, times, func, and parms as arguments)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class &ldquo;solution.ode&rdquo; as described in <code><a href="#topic+solution.ode-class">solution.ode-class</a></code>.
</p>

<hr>
<h2 id='jacobian'>S4 generic for computing a jacobian</h2><span id='topic+jacobian'></span>

<h3>Description</h3>

<p>S4 generic for computing a jacobian
</p>


<h3>Usage</h3>

<pre><code class='language-R'>jacobian(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="jacobian_+3A_object">object</code></td>
<td>
<p>an <code>R</code> object</p>
</td></tr>
<tr><td><code id="jacobian_+3A_...">...</code></td>
<td>
<p>further arguments passed to methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The jacobian of the object.
</p>

<hr>
<h2 id='jacobian+2Codemodel-method'>Evaluate the jacobian of the gradients</h2><span id='topic+jacobian+2Codemodel-method'></span>

<h3>Description</h3>

<p>Evaluate the jacobian of the gradients
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'odemodel'
jacobian(object, state, par, type = c("initial", "state", "par"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="jacobian+2B2Codemodel-method_+3A_object">object</code></td>
<td>
<p>odemodel object</p>
</td></tr>
<tr><td><code id="jacobian+2B2Codemodel-method_+3A_state">state</code></td>
<td>
<p>state</p>
</td></tr>
<tr><td><code id="jacobian+2B2Codemodel-method_+3A_par">par</code></td>
<td>
<p>parameter values</p>
</td></tr>
<tr><td><code id="jacobian+2B2Codemodel-method_+3A_type">type</code></td>
<td>
<p>state of par?</p>
</td></tr>
</table>

<hr>
<h2 id='logLik+2Cfitode-method'>Extract log-likelihood</h2><span id='topic+logLik+2Cfitode-method'></span>

<h3>Description</h3>

<p>Extract log-likelihood of a fit
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'fitode'
logLik(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logLik+2B2Cfitode-method_+3A_object">object</code></td>
<td>
<p>fitode object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The log-likelihood of the fitode object
</p>

<hr>
<h2 id='loglik.ode-class'>Class representing log-likelihood models used to fit ode models</h2><span id='topic+loglik.ode-class'></span>

<h3>Description</h3>

<p>Class representing log-likelihood models used to fit ode models
</p>


<h3>Slots</h3>


<dl>
<dt><code>name</code></dt><dd><p>name of the distribution</p>
</dd>
<dt><code>expr</code></dt><dd><p>an expression specifying the model</p>
</dd>
<dt><code>observation</code></dt><dd><p>observation variable name</p>
</dd>
<dt><code>mean</code></dt><dd><p>mean variable name</p>
</dd>
<dt><code>par</code></dt><dd><p>additional parameter names</p>
</dd>
<dt><code>grad</code></dt><dd><p>the gradient with respect to the parameters</p>
</dd>
</dl>

<hr>
<h2 id='logLik.sensitivity'>Calculate the derivative of the log-likelihood function</h2><span id='topic+logLik.sensitivity'></span>

<h3>Description</h3>

<p>Calculate the derivative of the log-likelihood function with respect to model parameters
using sensitivity equations and chain rule
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logLik.sensitivity(
  parms,
  model,
  data,
  solver.opts = list(method = "rk4"),
  solver = ode,
  return.NLL = TRUE,
  return.traj = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logLik.sensitivity_+3A_parms">parms</code></td>
<td>
<p>named vector of parameter values</p>
</td></tr>
<tr><td><code id="logLik.sensitivity_+3A_model">model</code></td>
<td>
<p>odemodel object</p>
</td></tr>
<tr><td><code id="logLik.sensitivity_+3A_data">data</code></td>
<td>
<p>data</p>
</td></tr>
<tr><td><code id="logLik.sensitivity_+3A_solver.opts">solver.opts</code></td>
<td>
<p>options for the ode solver (see <code><a href="deSolve.html#topic+ode">ode</a></code>)</p>
</td></tr>
<tr><td><code id="logLik.sensitivity_+3A_solver">solver</code></td>
<td>
<p>ode solver</p>
</td></tr>
<tr><td><code id="logLik.sensitivity_+3A_return.nll">return.NLL</code></td>
<td>
<p>(logical) return negative log-likelihood</p>
</td></tr>
<tr><td><code id="logLik.sensitivity_+3A_return.traj">return.traj</code></td>
<td>
<p>(logical) return estimated trajectory</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector of nll and derivative of nll with respect to model parameters
(or a list containing (1) the estimated traejctory and (2) a vector of nll and its derivatives)
</p>

<hr>
<h2 id='make_prior'>Make a list containing log prior density and its gradient</h2><span id='topic+make_prior'></span>

<h3>Description</h3>

<p>Make a list containing log prior density and its gradient
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_prior(model, link, prior, prior.density = TRUE, keep_grad = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="make_prior_+3A_model">model</code></td>
<td>
<p>model.ode object</p>
</td></tr>
<tr><td><code id="make_prior_+3A_link">link</code></td>
<td>
<p>link</p>
</td></tr>
<tr><td><code id="make_prior_+3A_prior">prior</code></td>
<td>
<p>list of formulas</p>
</td></tr>
<tr><td><code id="make_prior_+3A_prior.density">prior.density</code></td>
<td>
<p>(logical) does this represent a probability density?</p>
</td></tr>
<tr><td><code id="make_prior_+3A_keep_grad">keep_grad</code></td>
<td>
<p>(logical) keep gradient?</p>
</td></tr>
</table>

<hr>
<h2 id='ode.sensitivity'>Calculate the derivative of the mean expression</h2><span id='topic+ode.sensitivity'></span>

<h3>Description</h3>

<p>Calculate the derivative of an expression with respect to model parameters
using sensitivity equations and chain rule
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ode.sensitivity(
  model,
  parms,
  times,
  solver.opts = list(method = "rk4"),
  solver = ode
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ode.sensitivity_+3A_model">model</code></td>
<td>
<p>odemodel object</p>
</td></tr>
<tr><td><code id="ode.sensitivity_+3A_parms">parms</code></td>
<td>
<p>named vector of parameter values</p>
</td></tr>
<tr><td><code id="ode.sensitivity_+3A_times">times</code></td>
<td>
<p>time window for which the model should be solved</p>
</td></tr>
<tr><td><code id="ode.sensitivity_+3A_solver.opts">solver.opts</code></td>
<td>
<p>options for the ode solver (see <code><a href="deSolve.html#topic+ode">ode</a></code>)</p>
</td></tr>
<tr><td><code id="ode.sensitivity_+3A_solver">solver</code></td>
<td>
<p>ode solver</p>
</td></tr>
</table>

<hr>
<h2 id='ode.solve'>solve ode models</h2><span id='topic+ode.solve'></span>

<h3>Description</h3>

<p>solve ode models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ode.solve(
  model,
  times,
  parms,
  y,
  solver.opts = list(method = "rk4"),
  solver = ode
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ode.solve_+3A_model">model</code></td>
<td>
<p>odemodel object</p>
</td></tr>
<tr><td><code id="ode.solve_+3A_times">times</code></td>
<td>
<p>time vector</p>
</td></tr>
<tr><td><code id="ode.solve_+3A_parms">parms</code></td>
<td>
<p>named vector of parameter values</p>
</td></tr>
<tr><td><code id="ode.solve_+3A_y">y</code></td>
<td>
<p>initial values</p>
</td></tr>
<tr><td><code id="ode.solve_+3A_solver.opts">solver.opts</code></td>
<td>
<p>options for ode solver</p>
</td></tr>
<tr><td><code id="ode.solve_+3A_solver">solver</code></td>
<td>
<p>ode solver (must take y, times, func, and parms as arguments)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class &ldquo;solution.ode&rdquo; as described in <code><a href="#topic+solution.ode-class">solution.ode-class</a></code>.
</p>

<hr>
<h2 id='odemodel-class'>Class &quot;odemodel&quot; representing ode models</h2><span id='topic+odemodel-class'></span><span id='topic+odemodel'></span>

<h3>Description</h3>

<p>Class &quot;odemodel&quot; representing ode models
</p>
<p>Create a new odemodel
</p>


<h3>Usage</h3>

<pre><code class='language-R'>odemodel(...)
</code></pre>


<h3>Slots</h3>


<dl>
<dt><code>name</code></dt><dd><p>name of the model</p>
</dd>
<dt><code>gfun</code></dt><dd><p>gradient function</p>
</dd>
<dt><code>grad</code></dt><dd><p>list of gradients</p>
</dd>
<dt><code>observation</code></dt><dd><p>list of observation models</p>
</dd>
<dt><code>initial</code></dt><dd><p>list of expressions representing the initial values</p>
</dd>
<dt><code>state</code></dt><dd><p>state variables</p>
</dd>
<dt><code>par</code></dt><dd><p>parameters</p>
</dd>
<dt><code>link</code></dt><dd><p>link functions for parameters (log links are used as default)</p>
</dd>
<dt><code>diffnames</code></dt><dd><p>character vector specifying the names of a variable for which the consecutive difference needs to be calculated</p>
</dd>
<dt><code>call</code></dt><dd><p>original function call</p>
</dd>
<dt><code>jacobian.initial</code></dt><dd><p>Jacobian of initial values with respect to its parameters</p>
</dd>
<dt><code>jacobian.state</code></dt><dd><p>Jacobian with respect to its states</p>
</dd>
<dt><code>jacobian.par</code></dt><dd><p>Jacobian with repsect to its parameters</p>
</dd>
<dt><code>loglik</code></dt><dd><p>list of log-likelihood functions</p>
</dd>
<dt><code>expr</code></dt><dd><p>expressions for true trajectories</p>
</dd>
<dt><code>expr.sensitivity</code></dt><dd><p>sensitivity of the expressions with respect to state variables and parameters</p>
</dd>
<dt><code>keep_sensitivity</code></dt><dd><p>(logical) keep sensitivity equations?</p>
</dd>
</dl>

<hr>
<h2 id='plot_internal'>Internal function for plotting methods</h2><span id='topic+plot_internal'></span>

<h3>Description</h3>

<p>Internal function for plotting methods
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_internal(
  pred,
  data,
  onepage = TRUE,
  xlim,
  ylim,
  xlabs,
  ylabs,
  col.traj = "black",
  lty.traj = 1,
  col.conf = "black",
  lty.conf = 4,
  add = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_internal_+3A_pred">pred</code></td>
<td>
<p>prediction objects</p>
</td></tr>
<tr><td><code id="plot_internal_+3A_data">data</code></td>
<td>
<p>observed data</p>
</td></tr>
<tr><td><code id="plot_internal_+3A_onepage">onepage</code></td>
<td>
<p>(logical) print all figures on one page?</p>
</td></tr>
<tr><td><code id="plot_internal_+3A_xlim">xlim</code></td>
<td>
<p>x coordinates range</p>
</td></tr>
<tr><td><code id="plot_internal_+3A_ylim">ylim</code></td>
<td>
<p>y coordinates range</p>
</td></tr>
<tr><td><code id="plot_internal_+3A_xlabs">xlabs</code></td>
<td>
<p>a label for the x axis</p>
</td></tr>
<tr><td><code id="plot_internal_+3A_ylabs">ylabs</code></td>
<td>
<p>a label for the y axis</p>
</td></tr>
<tr><td><code id="plot_internal_+3A_col.traj">col.traj</code></td>
<td>
<p>colour of the estimated trajectory</p>
</td></tr>
<tr><td><code id="plot_internal_+3A_lty.traj">lty.traj</code></td>
<td>
<p>line type of the estimated trajectory</p>
</td></tr>
<tr><td><code id="plot_internal_+3A_col.conf">col.conf</code></td>
<td>
<p>colour of the confidence intervals</p>
</td></tr>
<tr><td><code id="plot_internal_+3A_lty.conf">lty.conf</code></td>
<td>
<p>line type of the confidence intervals</p>
</td></tr>
<tr><td><code id="plot_internal_+3A_add">add</code></td>
<td>
<p>add to another plot?</p>
</td></tr>
<tr><td><code id="plot_internal_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed on to the plot function</p>
</td></tr>
</table>

<hr>
<h2 id='plot+2Cfitode+2Cmissing-method'>Plot a fitode object</h2><span id='topic+plot+2Cfitode+2Cmissing-method'></span><span id='topic+plot+2Cfitode-method'></span>

<h3>Description</h3>

<p>Plot a fitode object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'fitode,missing'
plot(
  x,
  level,
  data,
  which,
  method = c("delta", "impsamp", "wmvrnorm"),
  onepage = TRUE,
  xlim,
  ylim,
  xlabs,
  ylabs,
  col.traj = "black",
  lty.traj = 1,
  col.conf = "black",
  lty.conf = 4,
  add = FALSE,
  nsim = 1000,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot+2B2Cfitode+2B2Cmissing-method_+3A_x">x</code></td>
<td>
<p>fitode object</p>
</td></tr>
<tr><td><code id="plot+2B2Cfitode+2B2Cmissing-method_+3A_level">level</code></td>
<td>
<p>the confidence level required</p>
</td></tr>
<tr><td><code id="plot+2B2Cfitode+2B2Cmissing-method_+3A_data">data</code></td>
<td>
<p>(FIXME)</p>
</td></tr>
<tr><td><code id="plot+2B2Cfitode+2B2Cmissing-method_+3A_which">which</code></td>
<td>
<p>which to plot</p>
</td></tr>
<tr><td><code id="plot+2B2Cfitode+2B2Cmissing-method_+3A_method">method</code></td>
<td>
<p>confidence interval method</p>
</td></tr>
<tr><td><code id="plot+2B2Cfitode+2B2Cmissing-method_+3A_onepage">onepage</code></td>
<td>
<p>(logical) print all figures on one page?</p>
</td></tr>
<tr><td><code id="plot+2B2Cfitode+2B2Cmissing-method_+3A_xlim">xlim</code></td>
<td>
<p>x coordinates range</p>
</td></tr>
<tr><td><code id="plot+2B2Cfitode+2B2Cmissing-method_+3A_ylim">ylim</code></td>
<td>
<p>y coordinates range</p>
</td></tr>
<tr><td><code id="plot+2B2Cfitode+2B2Cmissing-method_+3A_xlabs">xlabs</code></td>
<td>
<p>a label for the x axis</p>
</td></tr>
<tr><td><code id="plot+2B2Cfitode+2B2Cmissing-method_+3A_ylabs">ylabs</code></td>
<td>
<p>a label for the y axis</p>
</td></tr>
<tr><td><code id="plot+2B2Cfitode+2B2Cmissing-method_+3A_col.traj">col.traj</code></td>
<td>
<p>colour of the estimated trajectory</p>
</td></tr>
<tr><td><code id="plot+2B2Cfitode+2B2Cmissing-method_+3A_lty.traj">lty.traj</code></td>
<td>
<p>line type of the estimated trajectory</p>
</td></tr>
<tr><td><code id="plot+2B2Cfitode+2B2Cmissing-method_+3A_col.conf">col.conf</code></td>
<td>
<p>colour of the confidence intervals</p>
</td></tr>
<tr><td><code id="plot+2B2Cfitode+2B2Cmissing-method_+3A_lty.conf">lty.conf</code></td>
<td>
<p>line type of the confidence intervals</p>
</td></tr>
<tr><td><code id="plot+2B2Cfitode+2B2Cmissing-method_+3A_add">add</code></td>
<td>
<p>add to another plot?</p>
</td></tr>
<tr><td><code id="plot+2B2Cfitode+2B2Cmissing-method_+3A_nsim">nsim</code></td>
<td>
<p>number of simulations for mvrnorm, wmvrnorm methods</p>
</td></tr>
<tr><td><code id="plot+2B2Cfitode+2B2Cmissing-method_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed on to the plot function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for side effects
</p>

<hr>
<h2 id='plot+2CfitodeMCMC+2Cmissing-method'>Plot a fitodeMCMC object</h2><span id='topic+plot+2CfitodeMCMC+2Cmissing-method'></span><span id='topic+plot+2CfitodeMCMC-method'></span>

<h3>Description</h3>

<p>Plot a fitodeMCMC object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'fitodeMCMC,missing'
plot(
  x,
  level,
  data,
  which,
  onepage = TRUE,
  xlim,
  ylim,
  xlabs,
  ylabs,
  col.traj = "black",
  lty.traj = 1,
  col.conf = "black",
  lty.conf = 4,
  add = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot+2B2CfitodeMCMC+2B2Cmissing-method_+3A_x">x</code></td>
<td>
<p>fitodeMCMC object</p>
</td></tr>
<tr><td><code id="plot+2B2CfitodeMCMC+2B2Cmissing-method_+3A_level">level</code></td>
<td>
<p>the confidence level required</p>
</td></tr>
<tr><td><code id="plot+2B2CfitodeMCMC+2B2Cmissing-method_+3A_data">data</code></td>
<td>
<p>(FIXME)</p>
</td></tr>
<tr><td><code id="plot+2B2CfitodeMCMC+2B2Cmissing-method_+3A_which">which</code></td>
<td>
<p>which to plot</p>
</td></tr>
<tr><td><code id="plot+2B2CfitodeMCMC+2B2Cmissing-method_+3A_onepage">onepage</code></td>
<td>
<p>(logical) print all figures on one page?</p>
</td></tr>
<tr><td><code id="plot+2B2CfitodeMCMC+2B2Cmissing-method_+3A_xlim">xlim</code></td>
<td>
<p>x coordinates range</p>
</td></tr>
<tr><td><code id="plot+2B2CfitodeMCMC+2B2Cmissing-method_+3A_ylim">ylim</code></td>
<td>
<p>y coordinates range</p>
</td></tr>
<tr><td><code id="plot+2B2CfitodeMCMC+2B2Cmissing-method_+3A_xlabs">xlabs</code></td>
<td>
<p>a label for the x axis</p>
</td></tr>
<tr><td><code id="plot+2B2CfitodeMCMC+2B2Cmissing-method_+3A_ylabs">ylabs</code></td>
<td>
<p>a label for the y axis</p>
</td></tr>
<tr><td><code id="plot+2B2CfitodeMCMC+2B2Cmissing-method_+3A_col.traj">col.traj</code></td>
<td>
<p>colour of the estimated trajectory</p>
</td></tr>
<tr><td><code id="plot+2B2CfitodeMCMC+2B2Cmissing-method_+3A_lty.traj">lty.traj</code></td>
<td>
<p>line type of the estimated trajectory</p>
</td></tr>
<tr><td><code id="plot+2B2CfitodeMCMC+2B2Cmissing-method_+3A_col.conf">col.conf</code></td>
<td>
<p>colour of the confidence intervals</p>
</td></tr>
<tr><td><code id="plot+2B2CfitodeMCMC+2B2Cmissing-method_+3A_lty.conf">lty.conf</code></td>
<td>
<p>line type of the confidence intervals</p>
</td></tr>
<tr><td><code id="plot+2B2CfitodeMCMC+2B2Cmissing-method_+3A_add">add</code></td>
<td>
<p>add to another plot?</p>
</td></tr>
<tr><td><code id="plot+2B2CfitodeMCMC+2B2Cmissing-method_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed on to the plot function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for side effects
</p>

<hr>
<h2 id='predict+2Cfitode-method'>Prediction function for fitode objects</h2><span id='topic+predict+2Cfitode-method'></span>

<h3>Description</h3>

<p>Computes estimated trajectories and their confidence intervals (using either
the delta method or importance sampling).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'fitode'
predict(
  object,
  level,
  times,
  method = c("delta", "impsamp", "wmvrnorm"),
  nsim = 1000
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict+2B2Cfitode-method_+3A_object">object</code></td>
<td>
<p>fitode object</p>
</td></tr>
<tr><td><code id="predict+2B2Cfitode-method_+3A_level">level</code></td>
<td>
<p>the confidence level required</p>
</td></tr>
<tr><td><code id="predict+2B2Cfitode-method_+3A_times">times</code></td>
<td>
<p>time vector to predict over. Default is set to the time frame of the data.</p>
</td></tr>
<tr><td><code id="predict+2B2Cfitode-method_+3A_method">method</code></td>
<td>
<p>confidence interval method. Default is set to Delta method.</p>
</td></tr>
<tr><td><code id="predict+2B2Cfitode-method_+3A_nsim">nsim</code></td>
<td>
<p>number of simulations for mvrnorm, wmvrnorm methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The estimated trajectories and their confidence intervals of the fitode object
</p>

<hr>
<h2 id='predict+2CfitodeMCMC-method'>Prediction function for fitodeMCMC objects</h2><span id='topic+predict+2CfitodeMCMC-method'></span>

<h3>Description</h3>

<p>Computes estimated trajectories and their credible intervals.
The estimated trajectories are obtained by taking the median trajectories
from the posterior samples.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'fitodeMCMC'
predict(object, level, times, simplify = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict+2B2CfitodeMCMC-method_+3A_object">object</code></td>
<td>
<p>fitodeMCMC object</p>
</td></tr>
<tr><td><code id="predict+2B2CfitodeMCMC-method_+3A_level">level</code></td>
<td>
<p>the credible level required</p>
</td></tr>
<tr><td><code id="predict+2B2CfitodeMCMC-method_+3A_times">times</code></td>
<td>
<p>time vector to predict over. Default is set to the time frame of the data.</p>
</td></tr>
<tr><td><code id="predict+2B2CfitodeMCMC-method_+3A_simplify">simplify</code></td>
<td>
<p>(logical) simplify output to return estimated trajectories and their
credible intervals? If <code>simplify=FALSE</code>, all posterior trajectories will be returned</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Estimated trajectories and their credible intervals of the fitodeMCMC object
</p>

<hr>
<h2 id='prior.ode-class'>Class representing prior models used to fit ode models</h2><span id='topic+prior.ode-class'></span>

<h3>Description</h3>

<p>Class representing prior models used to fit ode models
</p>


<h3>Slots</h3>


<dl>
<dt><code>name</code></dt><dd><p>name of the distribution</p>
</dd>
<dt><code>expr</code></dt><dd><p>an expression specifying the model</p>
</dd>
<dt><code>observation</code></dt><dd><p>observation variable name</p>
</dd>
<dt><code>par</code></dt><dd><p>additional parameter names</p>
</dd>
<dt><code>keep_grad</code></dt><dd><p>keep gradient?</p>
</dd>
<dt><code>grad</code></dt><dd><p>the gradient with respect to the parameters</p>
</dd>
</dl>

<hr>
<h2 id='profile+2Cfitode-method'>Profile fitode objects</h2><span id='topic+profile+2Cfitode-method'></span>

<h3>Description</h3>

<p>Profile fitode objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'fitode'
profile(fitted, which = 1:p, alpha = 0.05, trace = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="profile+2B2Cfitode-method_+3A_fitted">fitted</code></td>
<td>
<p>fitted model object</p>
</td></tr>
<tr><td><code id="profile+2B2Cfitode-method_+3A_which">which</code></td>
<td>
<p>which parameter(s) to profile? (integer value)</p>
</td></tr>
<tr><td><code id="profile+2B2Cfitode-method_+3A_alpha">alpha</code></td>
<td>
<p>critical level</p>
</td></tr>
<tr><td><code id="profile+2B2Cfitode-method_+3A_trace">trace</code></td>
<td>
<p>trace progress of computations?</p>
</td></tr>
<tr><td><code id="profile+2B2Cfitode-method_+3A_...">...</code></td>
<td>
<p>additional arguments passed to mle2 profiling method</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The log-likelihood profile of the fitode object
</p>

<hr>
<h2 id='select_model'>Select a log-likelihood model</h2><span id='topic+select_model'></span>

<h3>Description</h3>

<p>Select a log-likelihood model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>select_model(
  dist = c("ols", "dnorm", "dnorm2", "dpois", "dnbinom", "dnbinom1", "dgamma",
    "dlnorm")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="select_model_+3A_dist">dist</code></td>
<td>
<p>conditional distribution of reported data (dnorm, dnorm2, dpois, dnbinom, dnbinom1, dgamma)</p>
</td></tr>
</table>

<hr>
<h2 id='select_prior'>Select a prior model</h2><span id='topic+select_prior'></span>

<h3>Description</h3>

<p>Select a prior model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>select_prior(
  family = c("dnorm", "dgamma", "dbeta", "dlnorm"),
  link = c("identity", "log", "logit"),
  prior.density = TRUE,
  keep_grad = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="select_prior_+3A_family">family</code></td>
<td>
<p>prior distribution type</p>
</td></tr>
<tr><td><code id="select_prior_+3A_link">link</code></td>
<td>
<p>link</p>
</td></tr>
<tr><td><code id="select_prior_+3A_prior.density">prior.density</code></td>
<td>
<p>(logical) keep the Jacobian of transformations?</p>
</td></tr>
<tr><td><code id="select_prior_+3A_keep_grad">keep_grad</code></td>
<td>
<p>(logical) keep gradients?</p>
</td></tr>
</table>

<hr>
<h2 id='set_link'>Set up link functions for model parameters</h2><span id='topic+set_link'></span>

<h3>Description</h3>

<p>Set up link functions for model parameters &ndash; for <code><a href="#topic+fitode">fitode</a></code>
internal usage; assumes log-link by default if link functions are
not specified
</p>


<h3>Usage</h3>

<pre><code class='language-R'>set_link(link, par)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="set_link_+3A_link">link</code></td>
<td>
<p>named list or vector of strings specifying link functions</p>
</td></tr>
<tr><td><code id="set_link_+3A_par">par</code></td>
<td>
<p>(character) model parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of strings specifying link functions for each model parameter
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+make.link">make.link</a></code>
</p>

<hr>
<h2 id='show+2Cfitode-method'>Show fitode objects</h2><span id='topic+show+2Cfitode-method'></span>

<h3>Description</h3>

<p>Show fitode objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'fitode'
show(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="show+2B2Cfitode-method_+3A_object">object</code></td>
<td>
<p>fitode object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for side effects
</p>

<hr>
<h2 id='show+2CfitodeMCMC-method'>Show fitodeMCMC object</h2><span id='topic+show+2CfitodeMCMC-method'></span>

<h3>Description</h3>

<p>Show fitodeMCMC object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'fitodeMCMC'
show(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="show+2B2CfitodeMCMC-method_+3A_object">object</code></td>
<td>
<p>fitodeMCMC object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for side effects
</p>

<hr>
<h2 id='show+2Codemodel-method'>Show the model</h2><span id='topic+show+2Codemodel-method'></span>

<h3>Description</h3>

<p>Show the model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'odemodel'
show(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="show+2B2Codemodel-method_+3A_object">object</code></td>
<td>
<p>odemodel object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for side effects
</p>

<hr>
<h2 id='SierraLeone2014'>Data from 2014 Sierra Leone Ebola epidemic</h2><span id='topic+SierraLeone2014'></span>

<h3>Description</h3>

<p>Ebola case reports ...
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SierraLeone2014
</code></pre>


<h3>Format</h3>

<p>A data frame with 67 rows comprising:
</p>

<dl>
<dt>times</dt><dd><p>decimal dates (year + fraction of year)</p>
</dd>
<dt>confirmed</dt><dd><p>confirmed cases</p>
</dd>
</dl>


<hr>
<h2 id='simulate_internal'>Internal function for simulation models</h2><span id='topic+simulate_internal'></span>

<h3>Description</h3>

<p>Simulates deterministic trajectories and propagates observation error
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulate_internal(
  model,
  times,
  parms,
  y,
  solver.opts = list(method = "rk4"),
  solver = ode,
  observation = TRUE,
  nsim = 1,
  seed = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simulate_internal_+3A_model">model</code></td>
<td>
<p>odemodel object</p>
</td></tr>
<tr><td><code id="simulate_internal_+3A_times">times</code></td>
<td>
<p>time vector</p>
</td></tr>
<tr><td><code id="simulate_internal_+3A_parms">parms</code></td>
<td>
<p>named vector of parameter values</p>
</td></tr>
<tr><td><code id="simulate_internal_+3A_y">y</code></td>
<td>
<p>initial values</p>
</td></tr>
<tr><td><code id="simulate_internal_+3A_solver.opts">solver.opts</code></td>
<td>
<p>options for ode solver</p>
</td></tr>
<tr><td><code id="simulate_internal_+3A_solver">solver</code></td>
<td>
<p>ode solver (must take y, times, func, and parms arguments)</p>
</td></tr>
<tr><td><code id="simulate_internal_+3A_observation">observation</code></td>
<td>
<p>(logical) propagate observation error?</p>
</td></tr>
<tr><td><code id="simulate_internal_+3A_nsim">nsim</code></td>
<td>
<p>number of simulations</p>
</td></tr>
<tr><td><code id="simulate_internal_+3A_seed">seed</code></td>
<td>
<p>seed</p>
</td></tr>
</table>

<hr>
<h2 id='simulate+2Cfitode-method'>simulate fitode objects</h2><span id='topic+simulate+2Cfitode-method'></span>

<h3>Description</h3>

<p>simulate fitode objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'fitode'
simulate(object, nsim = 1, seed = NULL, times, parms, y, observation = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simulate+2B2Cfitode-method_+3A_object">object</code></td>
<td>
<p>fitode object</p>
</td></tr>
<tr><td><code id="simulate+2B2Cfitode-method_+3A_nsim">nsim</code></td>
<td>
<p>number of simulations</p>
</td></tr>
<tr><td><code id="simulate+2B2Cfitode-method_+3A_seed">seed</code></td>
<td>
<p>random-number seed</p>
</td></tr>
<tr><td><code id="simulate+2B2Cfitode-method_+3A_times">times</code></td>
<td>
<p>time vector</p>
</td></tr>
<tr><td><code id="simulate+2B2Cfitode-method_+3A_parms">parms</code></td>
<td>
<p>named vector of parameter values</p>
</td></tr>
<tr><td><code id="simulate+2B2Cfitode-method_+3A_y">y</code></td>
<td>
<p>initial values</p>
</td></tr>
<tr><td><code id="simulate+2B2Cfitode-method_+3A_observation">observation</code></td>
<td>
<p>(logical) propagate observation error?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The numerical simulation of the object
</p>

<hr>
<h2 id='simulate+2Codemodel-method'>simulate model objects</h2><span id='topic+simulate+2Codemodel-method'></span>

<h3>Description</h3>

<p>simulate model objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'odemodel'
simulate(
  object,
  nsim = 1,
  seed = NULL,
  times,
  parms,
  y,
  solver.opts = list(method = "rk4"),
  solver = ode,
  observation = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simulate+2B2Codemodel-method_+3A_object">object</code></td>
<td>
<p>odemodel object</p>
</td></tr>
<tr><td><code id="simulate+2B2Codemodel-method_+3A_nsim">nsim</code></td>
<td>
<p>number of simulations</p>
</td></tr>
<tr><td><code id="simulate+2B2Codemodel-method_+3A_seed">seed</code></td>
<td>
<p>random-number seed</p>
</td></tr>
<tr><td><code id="simulate+2B2Codemodel-method_+3A_times">times</code></td>
<td>
<p>time vector</p>
</td></tr>
<tr><td><code id="simulate+2B2Codemodel-method_+3A_parms">parms</code></td>
<td>
<p>named vector of parameter values</p>
</td></tr>
<tr><td><code id="simulate+2B2Codemodel-method_+3A_y">y</code></td>
<td>
<p>initial values</p>
</td></tr>
<tr><td><code id="simulate+2B2Codemodel-method_+3A_solver.opts">solver.opts</code></td>
<td>
<p>options for ode solver</p>
</td></tr>
<tr><td><code id="simulate+2B2Codemodel-method_+3A_solver">solver</code></td>
<td>
<p>ode solver (must take y, times, func, and parms arguments)</p>
</td></tr>
<tr><td><code id="simulate+2B2Codemodel-method_+3A_observation">observation</code></td>
<td>
<p>(logical) propagate observation error?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The numerical simulation of the object
</p>

<hr>
<h2 id='solution.ode-class'>Class &quot;solution.ode&quot;.
Result of solving ode modeld with/without sensitivity equations</h2><span id='topic+solution.ode-class'></span>

<h3>Description</h3>

<p>Class &quot;solution.ode&quot;.
Result of solving ode modeld with/without sensitivity equations
</p>


<h3>Slots</h3>


<dl>
<dt><code>name</code></dt><dd><p>name of the model</p>
</dd>
<dt><code>y</code></dt><dd><p>initial values</p>
</dd>
<dt><code>times</code></dt><dd><p>time vector</p>
</dd>
<dt><code>model</code></dt><dd><p>ode model</p>
</dd>
<dt><code>parms</code></dt><dd><p>parameters of the solution</p>
</dd>
<dt><code>solution</code></dt><dd><p>solution of the model</p>
</dd>
<dt><code>sensitivity</code></dt><dd><p>partial derivative of each state variable with respect to the parameters</p>
</dd>
</dl>

<hr>
<h2 id='stdEr+2Cfitode-method'>Extract standard error from fitode objects</h2><span id='topic+stdEr+2Cfitode-method'></span>

<h3>Description</h3>

<p>Calculates standard error by taking the square root of the diagonal matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'fitode'
stdEr(x, type = c("response", "links"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stdEr+2B2Cfitode-method_+3A_x">x</code></td>
<td>
<p>fitode object</p>
</td></tr>
<tr><td><code id="stdEr+2B2Cfitode-method_+3A_type">type</code></td>
<td>
<p>type of standard error. The default (<code>type=response</code>) is on the
response scale; this is the scale on which the model parameters are defined.
Alternatively, <code>type=link</code> can be used to obtain standard errors on the estimated scale.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The standard error of the fitode object
</p>

<hr>
<h2 id='stdEr+2CfitodeMCMC-method'>Extract standard error from fitodeMCMC objects</h2><span id='topic+stdEr+2CfitodeMCMC-method'></span>

<h3>Description</h3>

<p>Calculates standard error by taking the square root of the diagonal of the variance-covariance matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'fitodeMCMC'
stdEr(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stdEr+2B2CfitodeMCMC-method_+3A_x">x</code></td>
<td>
<p>fitodeMCMC object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The standard error of the fitodeMCMC object
</p>

<hr>
<h2 id='summary+2Cfitode-method'>Summarize fitode object</h2><span id='topic+summary+2Cfitode-method'></span>

<h3>Description</h3>

<p>Summarize fitode objects;
returns estimate, standard error, and confidence intervals
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'fitode'
summary(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary+2B2Cfitode-method_+3A_object">object</code></td>
<td>
<p>fitode object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The summary of the fitode object
</p>

<hr>
<h2 id='summary+2CfitodeMCMC-method'>Summarize fitodeMCMC object</h2><span id='topic+summary+2CfitodeMCMC-method'></span>

<h3>Description</h3>

<p>Summarize fitodeMCMC object;
returns estimate, standard error, credible intervals, effective sample sizes, and gelman-rubin diagnostic
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'fitodeMCMC'
summary(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary+2B2CfitodeMCMC-method_+3A_object">object</code></td>
<td>
<p>fitodeMCMC object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The summary of the fitodeMCMC object
</p>


<h3>See Also</h3>

<p><code><a href="coda.html#topic+effectiveSize">effectiveSize</a></code> <code><a href="coda.html#topic+gelman.diag">gelman.diag</a></code>
</p>

<hr>
<h2 id='Transform'>S4 generic for transforming an object</h2><span id='topic+Transform'></span>

<h3>Description</h3>

<p>S4 generic for transforming an object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Transform(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Transform_+3A_object">object</code></td>
<td>
<p>an <code>R</code> object</p>
</td></tr>
<tr><td><code id="Transform_+3A_...">...</code></td>
<td>
<p>further arguments passed to methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The result of transforming the object.
</p>

<hr>
<h2 id='Transform+2Cloglik.ode-method'>Transform the model</h2><span id='topic+Transform+2Cloglik.ode-method'></span>

<h3>Description</h3>

<p>Transform the model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'loglik.ode'
Transform(
  object,
  transforms = NULL,
  name,
  observation = "X",
  mean,
  par,
  keep_grad = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Transform+2B2Cloglik.ode-method_+3A_object">object</code></td>
<td>
<p>loglik.ode object</p>
</td></tr>
<tr><td><code id="Transform+2B2Cloglik.ode-method_+3A_transforms">transforms</code></td>
<td>
<p>list of formulas specifying transformations</p>
</td></tr>
<tr><td><code id="Transform+2B2Cloglik.ode-method_+3A_name">name</code></td>
<td>
<p>name of the log-likelihood model</p>
</td></tr>
<tr><td><code id="Transform+2B2Cloglik.ode-method_+3A_observation">observation</code></td>
<td>
<p>observation variable name</p>
</td></tr>
<tr><td><code id="Transform+2B2Cloglik.ode-method_+3A_mean">mean</code></td>
<td>
<p>mean variable name</p>
</td></tr>
<tr><td><code id="Transform+2B2Cloglik.ode-method_+3A_par">par</code></td>
<td>
<p>additional parameter names</p>
</td></tr>
<tr><td><code id="Transform+2B2Cloglik.ode-method_+3A_keep_grad">keep_grad</code></td>
<td>
<p>maintain the gradient as part of the model</p>
</td></tr>
</table>


<h3>Value</h3>

<p>loglik.ode object
</p>

<hr>
<h2 id='Transform+2Codemodel-method'>Transform the model</h2><span id='topic+Transform+2Codemodel-method'></span>

<h3>Description</h3>

<p>Transform the model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'odemodel'
Transform(
  object,
  transforms,
  observation,
  initial,
  par,
  link,
  keep_sensitivity
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Transform+2B2Codemodel-method_+3A_object">object</code></td>
<td>
<p>odemodel object</p>
</td></tr>
<tr><td><code id="Transform+2B2Codemodel-method_+3A_transforms">transforms</code></td>
<td>
<p>list of formulas specifying transformations</p>
</td></tr>
<tr><td><code id="Transform+2B2Codemodel-method_+3A_observation">observation</code></td>
<td>
<p>observation model</p>
</td></tr>
<tr><td><code id="Transform+2B2Codemodel-method_+3A_initial">initial</code></td>
<td>
<p>initial values</p>
</td></tr>
<tr><td><code id="Transform+2B2Codemodel-method_+3A_par">par</code></td>
<td>
<p>model parameters</p>
</td></tr>
<tr><td><code id="Transform+2B2Codemodel-method_+3A_keep_sensitivity">keep_sensitivity</code></td>
<td>
<p>(logical) maintain the Jacobian as part of the model</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class &ldquo;odemodel&rdquo; as described in <code><a href="#topic+odemodel-class">odemodel-class</a></code>.
</p>

<hr>
<h2 id='Transform+2Cprior.ode-method'>Transform the prior model</h2><span id='topic+Transform+2Cprior.ode-method'></span>

<h3>Description</h3>

<p>Transform the prior model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'prior.ode'
Transform(
  object,
  transforms = NULL,
  name,
  observation = "X",
  par,
  keep_grad = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Transform+2B2Cprior.ode-method_+3A_object">object</code></td>
<td>
<p>object</p>
</td></tr>
<tr><td><code id="Transform+2B2Cprior.ode-method_+3A_transforms">transforms</code></td>
<td>
<p>list of formulas specifying transformations</p>
</td></tr>
<tr><td><code id="Transform+2B2Cprior.ode-method_+3A_name">name</code></td>
<td>
<p>name of the log-likelihood model</p>
</td></tr>
<tr><td><code id="Transform+2B2Cprior.ode-method_+3A_observation">observation</code></td>
<td>
<p>observation variable name</p>
</td></tr>
<tr><td><code id="Transform+2B2Cprior.ode-method_+3A_par">par</code></td>
<td>
<p>additional parameter names</p>
</td></tr>
<tr><td><code id="Transform+2B2Cprior.ode-method_+3A_keep_grad">keep_grad</code></td>
<td>
<p>maintain the gradient as part of the model</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class &ldquo;prior.ode&rdquo; as described in <code><a href="#topic+prior.ode-class">prior.ode-class</a></code>.
</p>

<hr>
<h2 id='tumorgrowth'>Tumor growth data</h2><span id='topic+tumorgrowth'></span>

<h3>Description</h3>

<p>...
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tumorgrowth
</code></pre>


<h3>Format</h3>

<p>A data frame containing 14 rows comprising:
</p>

<dl>
<dt>day</dt><dd></dd>
<dt>volume</dt><dd></dd>
</dl>


<hr>
<h2 id='update+2Cfitode-method'>Update fitode fits</h2><span id='topic+update+2Cfitode-method'></span>

<h3>Description</h3>

<p>Update fitode fits
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'fitode'
update(object, observation, initial, par, link, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="update+2B2Cfitode-method_+3A_object">object</code></td>
<td>
<p>fitode objects</p>
</td></tr>
<tr><td><code id="update+2B2Cfitode-method_+3A_observation">observation</code></td>
<td>
<p>observation model</p>
</td></tr>
<tr><td><code id="update+2B2Cfitode-method_+3A_initial">initial</code></td>
<td>
<p>initial values</p>
</td></tr>
<tr><td><code id="update+2B2Cfitode-method_+3A_par">par</code></td>
<td>
<p>model parameters</p>
</td></tr>
<tr><td><code id="update+2B2Cfitode-method_+3A_link">link</code></td>
<td>
<p>link functions for parameters (log links are used as default)</p>
</td></tr>
<tr><td><code id="update+2B2Cfitode-method_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed to fitode</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class &ldquo;fitode&rdquo; as described in <code><a href="#topic+fitode-class">fitode-class</a></code>.
</p>

<hr>
<h2 id='update+2CfitodeMCMC-method'>Update fitodeMCMC fits</h2><span id='topic+update+2CfitodeMCMC-method'></span>

<h3>Description</h3>

<p>Update fitodeMCMC fits
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'fitodeMCMC'
update(object, observation, initial, par, link, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="update+2B2CfitodeMCMC-method_+3A_object">object</code></td>
<td>
<p>fitodeMCMC objects</p>
</td></tr>
<tr><td><code id="update+2B2CfitodeMCMC-method_+3A_observation">observation</code></td>
<td>
<p>observation model</p>
</td></tr>
<tr><td><code id="update+2B2CfitodeMCMC-method_+3A_initial">initial</code></td>
<td>
<p>initial values</p>
</td></tr>
<tr><td><code id="update+2B2CfitodeMCMC-method_+3A_par">par</code></td>
<td>
<p>model parameters</p>
</td></tr>
<tr><td><code id="update+2B2CfitodeMCMC-method_+3A_link">link</code></td>
<td>
<p>link functions for parameters (log links are used as default)</p>
</td></tr>
<tr><td><code id="update+2B2CfitodeMCMC-method_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed to fitode</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class &ldquo;fitode&rdquo; as described in <code><a href="#topic+fitodeMCMC-class">fitodeMCMC-class</a></code>.
</p>

<hr>
<h2 id='vcov+2Cfitode-method'>Extract variance-covariance matrix from fitode objects</h2><span id='topic+vcov+2Cfitode-method'></span>

<h3>Description</h3>

<p>Extracts variance-covariance matrix (either on response scales or link scales)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'fitode'
vcov(object, type = c("response", "links"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vcov+2B2Cfitode-method_+3A_object">object</code></td>
<td>
<p>fitode object</p>
</td></tr>
<tr><td><code id="vcov+2B2Cfitode-method_+3A_type">type</code></td>
<td>
<p>type of covariance matrix. The default (<code>type=response</code>) is on the
response scale; this is the scale on which the model parameters are defined.
Alternatively, <code>type=link</code> can be used to obtain the covariance matrix on the estimated scale.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The variance-covariance matrix of the fitode object
</p>

<hr>
<h2 id='vcov+2CfitodeMCMC-method'>Extract variance-covariance matrix from fitodeMCMC objects</h2><span id='topic+vcov+2CfitodeMCMC-method'></span>

<h3>Description</h3>

<p>Calculates variance-covariance matrix from posterior samples
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'fitodeMCMC'
vcov(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vcov+2B2CfitodeMCMC-method_+3A_object">object</code></td>
<td>
<p>fitodeMCMC object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The variance-covariance matrix of the fitodeMCMC object
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
