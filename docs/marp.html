<!DOCTYPE html><html><head><title>Help for package marp</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {marp}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bpt_bstrp'><p>A function to generate (double) bootstrap samples and fit BPT renewal model</p></a></li>
<li><a href='#bpt_logl'><p>A function to calculate the log-likelihood of BPT model</p></a></li>
<li><a href='#bpt_rp'><p>A function to fit BPT renewal model</p></a></li>
<li><a href='#dllog'><p>Density function of Log-Logistics model</p></a></li>
<li><a href='#gamma_bstrp'><p>A function to generate (double) bootstrap samples and fit Gamma renewal model</p></a></li>
<li><a href='#gamma_logl'><p>A function to calculate the log-likelihood of Gamma model</p></a></li>
<li><a href='#gamma_rp'><p>A function to fit Gamma renewal model</p></a></li>
<li><a href='#loglogis_bstrp'><p>A function to generate (double) bootstrap samples and fit Log-Logistic renewal model</p></a></li>
<li><a href='#loglogis_logl'><p>A function to calculate the log-likelihood of Log-Logistics model</p></a></li>
<li><a href='#loglogis_rp'><p>A function to fit Log-Logistics renewal model</p></a></li>
<li><a href='#lognorm_bstrp'><p>A function to generate (double) bootstrap samples and fit Log-Normal renewal model</p></a></li>
<li><a href='#lognorm_rp'><p>A function to fit Log-Normal renewal model</p></a></li>
<li><a href='#lowerT'><p>An utility function to calculate upper limit of T statistic</p></a></li>
<li><a href='#marp'><p>A function to apply model-averaged renewal process</p></a></li>
<li><a href='#marp_bstrp'><p>A function to fit model-averaged renewal process</p></a></li>
<li><a href='#marp_confint'><p>A function to apply model-averaged renewal process</p></a></li>
<li><a href='#percent_confint'><p>A function to calculate percentile bootstrap confidence interval</p></a></li>
<li><a href='#pllog'><p>Probability function of Log-Logistics model</p></a></li>
<li><a href='#poisson_bstrp'><p>A function to generate (double) bootstrap samples and fit Poisson renewal model</p></a></li>
<li><a href='#poisson_rp'><p>A function to fit Poisson renewal model</p></a></li>
<li><a href='#student_confint'><p>A function to calculate Studentized bootstrap confidence interval</p></a></li>
<li><a href='#upperT'><p>An utility function to calculate lower limit of T statistic</p></a></li>
<li><a href='#weibull_bstrp'><p>A function to generate (double) bootstrap samples and fit Weibull renewal model</p></a></li>
<li><a href='#weibull_logl'><p>A function to calculate the log-likelihood of Weibull model</p></a></li>
<li><a href='#weibull_rp'><p>A function to fit Weibull renewal model #' @import weibull_logl</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Model-Averaged Renewal Process</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jie Kang &lt;jkang@maths.otago.ac.nz&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>To implement a model-averaging approach with different renewal
    models, with a primary focus on forecasting large earthquakes. Based on
    six renewal models (i.e., Poisson, Gamma, Log-Logistics, Weibull,
    Log-Normal and BPT), model-averaged point estimates are calculated using
    AIC (or BIC) weights. Additionally, both percentile and studentized
    bootstrapped model-averaged confidence intervals are constructed. In
    comparison, point and interval estimation from the individual or "best"
    model (determined via model selection) can be retrieved. </td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/kanji709/marp">https://github.com/kanji709/marp</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/kanji709/marp/issues">https://github.com/kanji709/marp/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.15)</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, gtools, statmod, VGAM,</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, devtools, roxygen2, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-08-07 05:06:58 UTC; kangj</td>
</tr>
<tr>
<td>Author:</td>
<td>Jie Kang [aut, cre, cph],
  Chris Scott [ctb],
  Albert Savary [ctb]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-08-11 15:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='bpt_bstrp'>A function to generate (double) bootstrap samples and fit BPT renewal model</h2><span id='topic+bpt_bstrp'></span>

<h3>Description</h3>

<p>A function to generate (double) bootstrap samples and fit BPT renewal model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bpt_bstrp(n, t, B, BB, m, par_hat, mu_hat, pr_hat, haz_hat, y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bpt_bstrp_+3A_n">n</code></td>
<td>
<p>number of inter-event times</p>
</td></tr>
<tr><td><code id="bpt_bstrp_+3A_t">t</code></td>
<td>
<p>user-specified time intervals (used to compute hazard rate)</p>
</td></tr>
<tr><td><code id="bpt_bstrp_+3A_b">B</code></td>
<td>
<p>number of bootstrap samples</p>
</td></tr>
<tr><td><code id="bpt_bstrp_+3A_bb">BB</code></td>
<td>
<p>number of double-bootstrap samples</p>
</td></tr>
<tr><td><code id="bpt_bstrp_+3A_m">m</code></td>
<td>
<p>the number of iterations in nlm</p>
</td></tr>
<tr><td><code id="bpt_bstrp_+3A_par_hat">par_hat</code></td>
<td>
<p>estimated parameters</p>
</td></tr>
<tr><td><code id="bpt_bstrp_+3A_mu_hat">mu_hat</code></td>
<td>
<p>estimated mean inter-event times</p>
</td></tr>
<tr><td><code id="bpt_bstrp_+3A_pr_hat">pr_hat</code></td>
<td>
<p>estimated time to event probability</p>
</td></tr>
<tr><td><code id="bpt_bstrp_+3A_haz_hat">haz_hat</code></td>
<td>
<p>estimated hazard rates</p>
</td></tr>
<tr><td><code id="bpt_bstrp_+3A_y">y</code></td>
<td>
<p>user-specified time point (used to compute time-to-event probability)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns list of estimates after fitting BPT renewal model on (double) bootstrap samples, containing:
</p>

<dl>
<dt>mu_star</dt><dd><p>Estimated mean from bootstrapped samples </p>
</dd>
<dt>pr_star</dt><dd><p>Estimated probability from bootstrapped samples </p>
</dd>
<dt>haz_star</dt><dd><p>Estimated hazard rates from bootstrapped samples</p>
</dd>
<dt>mu_var_hat</dt><dd><p>Variance of estimated mean</p>
</dd>
<dt>pr_var_hat</dt><dd><p>Variance of estimated probability</p>
</dd>
<dt>haz_var_hat</dt><dd><p>Variance of estimated hazard rates</p>
</dd>
<dt>mu_var_double</dt><dd><p>Variance of estimated mean of bootstrapped samples (via double-bootstrapping)</p>
</dd>
<dt>pr_var_double</dt><dd><p>Variance of estimated probability of bootstrapped samples (via double-bootstrapping)</p>
</dd>
<dt>haz_var_double</dt><dd><p>Variance of estimated hazard rates of bootstrapped samples (via double-bootstrapping)</p>
</dd>
<dt>mu_Tstar</dt><dd><p>Pivot quantity of the estimated mean</p>
</dd>
<dt>pr_Tstar</dt><dd><p>Pivot quantity of the estimated probability </p>
</dd>
<dt>haz_Tstar</dt><dd><p>Pivot quantity of the estimated hazard rates </p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>
# set some parameters
n &lt;- 30 # sample size
t &lt;- seq(100, 200, by = 10) # time intervals
B &lt;- 100 # number of bootstraps
BB &lt;- 100 # number of double-bootstraps
m &lt;- 10 # number of iterations for MLE optimization
par_hat &lt;- c(
  3.41361e-03, 2.76268e+00, 2.60370e+00, 3.30802e+02, 5.48822e+00, 2.92945e+02, NA,
  9.43071e-03, 2.47598e+02, 1.80102e+00, 6.50845e-01, 7.18247e-01
)
mu_hat &lt;- c(292.94512, 292.94513, 319.72017, 294.16945, 298.87286, 292.94512)
pr_hat &lt;- c(0.60039, 0.42155, 0.53434, 0.30780, 0.56416, 0.61795)
haz_hat &lt;-   matrix(c(
 -5.67999, -5.67999, -5.67999, -5.67999, -5.67999, -5.67999,
 -5.67999, -5.67999, -5.67999, -5.67999, -5.67999, -6.09420,
 -5.99679, -5.91174, -5.83682, -5.77031, -5.71085, -5.65738,
 -5.60904, -5.56512, -5.52504, -5.48833, -6.09902, -5.97017,
 -5.85769, -5.75939, -5.67350, -5.59856, -5.53336, -5.47683,
 -5.42805, -5.38621, -5.35060, -6.17146, -6.09512, -6.02542,
 -5.96131, -5.90194, -5.84668, -5.79498, -5.74642, -5.70064,
 -5.65733, -5.61624, -5.92355, -5.80239, -5.70475, -5.62524,
 -5.55994, -5.50595, -5.46106, -5.42359, -5.39222, -5.36591,
 -5.34383, -5.79111, -5.67660, -5.58924, -5.52166, -5.46879,
 -5.42707, -5.39394, -5.36751, -5.34637, -5.32946, -5.31596
),length(t),6)
y &lt;- 304 # cut-off point for probablity estimation

# generate bootstrapped samples then fit renewal model
res &lt;- marp::bpt_bstrp(n, t, B, BB, m, par_hat, mu_hat, pr_hat, haz_hat, y)


</code></pre>

<hr>
<h2 id='bpt_logl'>A function to calculate the log-likelihood of BPT model</h2><span id='topic+bpt_logl'></span>

<h3>Description</h3>

<p>A function to calculate the log-likelihood of BPT model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bpt_logl(param, x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bpt_logl_+3A_param">param</code></td>
<td>
<p>parameters of BPT model</p>
</td></tr>
<tr><td><code id="bpt_logl_+3A_x">x</code></td>
<td>
<p>input data for BPT model</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns the value of negative log-likelihood of the BPT model
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(42)
data &lt;-  rgamma(30,3,0.01)

# set some parameters
par_hat &lt;- c(292.945125794581, 0.718247184450307) # estimated parameters
param &lt;-  c(log(par_hat[1]),log(par_hat[2]^2)) # input parameters for logl function

# calculate log-likelihood
result &lt;- marp::bpt_logl(param, data)

# print result
cat("-logl = ", result, "\n")

</code></pre>

<hr>
<h2 id='bpt_rp'>A function to fit BPT renewal model</h2><span id='topic+bpt_rp'></span>

<h3>Description</h3>

<p>A function to fit BPT renewal model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bpt_rp(data, t, m, y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bpt_rp_+3A_data">data</code></td>
<td>
<p>input inter-event times</p>
</td></tr>
<tr><td><code id="bpt_rp_+3A_t">t</code></td>
<td>
<p>user-specified time intervals (used to compute hazard rate)</p>
</td></tr>
<tr><td><code id="bpt_rp_+3A_m">m</code></td>
<td>
<p>the number of iterations in nlm</p>
</td></tr>
<tr><td><code id="bpt_rp_+3A_y">y</code></td>
<td>
<p>user-specified time point (used to compute time-to-event probability)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns list of estimates after fitting BPT renewal model
</p>

<dl>
<dt>par1</dt><dd><p>Estimated parameter (mu) of the BPT model</p>
</dd>
<dt>par2</dt><dd><p>Estimated parameter (alpha) of the BPT model</p>
</dd>
<dt>logL</dt><dd><p>Negative log-likelihood</p>
</dd>
<dt>AIC</dt><dd><p>Akaike information criterion (AIC)</p>
</dd>
<dt>BIC</dt><dd><p>Bayesian information criterion (BIC)</p>
</dd>
<dt>mu_hat</dt><dd><p>Estimated mean</p>
</dd>
<dt>pr_hat</dt><dd><p>Estimated (logit) probabilities</p>
</dd>
<dt>haz_hat</dt><dd><p>Estimated (log) hazard rates</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>set.seed(42)
data &lt;-  rgamma(30,3,0.01)

# set some parameters
m &lt;- 10  # number of iterations for MLE optimization
t &lt;- seq(100, 200, by=10)  # time intervals
y &lt;- 304  # cut-off year for estimating probablity

# fit BPT renewal model
result &lt;- marp::bpt_rp(data, t, m, y)

# print result
cat("par1 = ", result$par1, "\n")
cat("par2 = ", result$par2, "\n")
cat("logL = ", result$logL, "\n")
cat("AIC = ", result$AIC, "\n")
cat("BIC = ", result$BIC, "\n")
cat("mu_hat = ", result$mu_hat, "\n")
cat("pr_hat = ", result$pr_hat, "\n")

</code></pre>

<hr>
<h2 id='dllog'>Density function of Log-Logistics model</h2><span id='topic+dllog'></span>

<h3>Description</h3>

<p>Density function of Log-Logistics model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dllog(x, shape = 1, scale = 1, log = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dllog_+3A_x">x</code></td>
<td>
<p>input data for Log-Logistics model</p>
</td></tr>
<tr><td><code id="dllog_+3A_shape">shape</code></td>
<td>
<p>shape parameter of Log-Logistics model</p>
</td></tr>
<tr><td><code id="dllog_+3A_scale">scale</code></td>
<td>
<p>scale parameter of Log-Logistics model</p>
</td></tr>
<tr><td><code id="dllog_+3A_log">log</code></td>
<td>
<p>logic function to determine whether log of logistics to be returned</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns the density of the Log-Logistics model
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- as.numeric(c(350., 450., 227., 352., 654.))
# set paramters
shape &lt;- 5
scale &lt;- 3
log &lt;- FALSE
result_1 &lt;- marp::dllog(x, shape, scale, log)

# alternatively, set log == TRUE
log &lt;- TRUE
result_2 &lt;- marp::dllog(x, shape, scale, log)

</code></pre>

<hr>
<h2 id='gamma_bstrp'>A function to generate (double) bootstrap samples and fit Gamma renewal model</h2><span id='topic+gamma_bstrp'></span>

<h3>Description</h3>

<p>A function to generate (double) bootstrap samples and fit Gamma renewal model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gamma_bstrp(n, t, B, BB, m, par_hat, mu_hat, pr_hat, haz_hat, y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gamma_bstrp_+3A_n">n</code></td>
<td>
<p>number of inter-event times</p>
</td></tr>
<tr><td><code id="gamma_bstrp_+3A_t">t</code></td>
<td>
<p>user-specified time intervals (used to compute hazard rate)</p>
</td></tr>
<tr><td><code id="gamma_bstrp_+3A_b">B</code></td>
<td>
<p>number of bootstrap samples</p>
</td></tr>
<tr><td><code id="gamma_bstrp_+3A_bb">BB</code></td>
<td>
<p>number of double-bootstrap samples</p>
</td></tr>
<tr><td><code id="gamma_bstrp_+3A_m">m</code></td>
<td>
<p>the number of iterations in nlm</p>
</td></tr>
<tr><td><code id="gamma_bstrp_+3A_par_hat">par_hat</code></td>
<td>
<p>estimated parameters</p>
</td></tr>
<tr><td><code id="gamma_bstrp_+3A_mu_hat">mu_hat</code></td>
<td>
<p>estimated mean inter-event times</p>
</td></tr>
<tr><td><code id="gamma_bstrp_+3A_pr_hat">pr_hat</code></td>
<td>
<p>estimated time to event probability</p>
</td></tr>
<tr><td><code id="gamma_bstrp_+3A_haz_hat">haz_hat</code></td>
<td>
<p>estimated hazard rates</p>
</td></tr>
<tr><td><code id="gamma_bstrp_+3A_y">y</code></td>
<td>
<p>user-specified time point (used to compute time-to-event probability)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns list of estimates after fitting Gamma renewal model on (double) bootstrap samples
</p>

<dl>
<dt>mu_star</dt><dd><p>Estimated mean from bootstrapped samples </p>
</dd>
<dt>pr_star</dt><dd><p>Estimated probability from bootstrapped samples </p>
</dd>
<dt>haz_star</dt><dd><p>Estimated hazard rates from bootstrapped samples</p>
</dd>
<dt>mu_var_hat</dt><dd><p>Variance of estimated mean</p>
</dd>
<dt>pr_var_hat</dt><dd><p>Variance of estimated probability</p>
</dd>
<dt>haz_var_hat</dt><dd><p>Variance of estimated hazard rates</p>
</dd>
<dt>mu_var_double</dt><dd><p>Variance of estimated mean of bootstrapped samples (via double-bootstrapping)</p>
</dd>
<dt>pr_var_double</dt><dd><p>Variance of estimated probability of bootstrapped samples (via double-bootstrapping)</p>
</dd>
<dt>haz_var_double</dt><dd><p>Variance of estimated hazard rates of bootstrapped samples (via double-bootstrapping)</p>
</dd>
<dt>mu_Tstar</dt><dd><p>Pivot quantity of the estimated mean</p>
</dd>
<dt>pr_Tstar</dt><dd><p>Pivot quantity of the estimated probability </p>
</dd>
<dt>haz_Tstar</dt><dd><p>Pivot quantity of the estimated hazard rates </p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>
# set some parameters
n &lt;- 30 # sample size
t &lt;- seq(100, 200, by = 10) # time intervals
B &lt;- 100 # number of bootstraps
BB &lt;- 100 # number of double-bootstraps
m &lt;- 10 # number of iterations for MLE optimization
par_hat &lt;- c(
  3.41361e-03, 2.76268e+00, 2.60370e+00, 3.30802e+02, 5.48822e+00, 2.92945e+02, NA,
  9.43071e-03, 2.47598e+02, 1.80102e+00, 6.50845e-01, 7.18247e-01
)
mu_hat &lt;- c(292.94512, 292.94513, 319.72017, 294.16945, 298.87286, 292.94512)
pr_hat &lt;- c(0.60039, 0.42155, 0.53434, 0.30780, 0.56416, 0.61795)
haz_hat &lt;-   matrix(c(
  -5.67999, -5.67999, -5.67999, -5.67999, -5.67999, -5.67999,
  -5.67999, -5.67999, -5.67999, -5.67999, -5.67999, -6.09420,
  -5.99679, -5.91174, -5.83682, -5.77031, -5.71085, -5.65738,
  -5.60904, -5.56512, -5.52504, -5.48833, -6.09902, -5.97017,
  -5.85769, -5.75939, -5.67350, -5.59856, -5.53336, -5.47683,
  -5.42805, -5.38621, -5.35060, -6.17146, -6.09512, -6.02542,
  -5.96131, -5.90194, -5.84668, -5.79498, -5.74642, -5.70064,
  -5.65733, -5.61624, -5.92355, -5.80239, -5.70475, -5.62524,
  -5.55994, -5.50595, -5.46106, -5.42359, -5.39222, -5.36591,
  -5.34383, -5.79111, -5.67660, -5.58924, -5.52166, -5.46879,
  -5.42707, -5.39394, -5.36751, -5.34637, -5.32946, -5.31596
),length(t),6)
y &lt;- 304 # cut-off year for estimating probablity

# generate bootstrapped samples then fit renewal model
res &lt;- marp::gamma_bstrp(n, t, B, BB, m, par_hat, mu_hat, pr_hat, haz_hat, y)


</code></pre>

<hr>
<h2 id='gamma_logl'>A function to calculate the log-likelihood of Gamma model</h2><span id='topic+gamma_logl'></span>

<h3>Description</h3>

<p>A function to calculate the log-likelihood of Gamma model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gamma_logl(param, x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gamma_logl_+3A_param">param</code></td>
<td>
<p>parameters of Gamma model</p>
</td></tr>
<tr><td><code id="gamma_logl_+3A_x">x</code></td>
<td>
<p>input data for Gamma model</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns the value of negative log-likelihood of the Gamma model
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(42)
data &lt;-  rgamma(30,3,0.01)

# set some parameters
par_hat &lt;- c(2.7626793657057762, 0.0094307059277139432) # estimated parameters
param &lt;- log(par_hat) # input parameters for logl function

# calculate log-likelihood
result &lt;- marp::gamma_logl(param, data)

# print result
cat("-logl = ", result, "\n")

</code></pre>

<hr>
<h2 id='gamma_rp'>A function to fit Gamma renewal model</h2><span id='topic+gamma_rp'></span>

<h3>Description</h3>

<p>A function to fit Gamma renewal model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gamma_rp(data, t, m, y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gamma_rp_+3A_data">data</code></td>
<td>
<p>input inter-event times</p>
</td></tr>
<tr><td><code id="gamma_rp_+3A_t">t</code></td>
<td>
<p>user-specified time intervals (used to compute hazard rate)</p>
</td></tr>
<tr><td><code id="gamma_rp_+3A_m">m</code></td>
<td>
<p>the number of iterations in nlm</p>
</td></tr>
<tr><td><code id="gamma_rp_+3A_y">y</code></td>
<td>
<p>user-specified time point (used to compute time-to-event probability)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns list of estimates after fitting Gamma renewal model
</p>

<dl>
<dt>par1</dt><dd><p>Estimated shape parameter of the Gamma model</p>
</dd>
<dt>par2</dt><dd><p>Estimated scale parameter of the Gamma model</p>
</dd>
<dt>logL</dt><dd><p>Negative log-likelihood</p>
</dd>
<dt>AIC</dt><dd><p>Akaike information criterion (AIC)</p>
</dd>
<dt>BIC</dt><dd><p>Bayesian information criterion (BIC)</p>
</dd>
<dt>mu_hat</dt><dd><p>Estimated mean</p>
</dd>
<dt>pr_hat</dt><dd><p>Estimated (logit) probabilities</p>
</dd>
<dt>haz_hat</dt><dd><p>Estimated (log) hazard rates</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>set.seed(42)
data &lt;-  rgamma(100,3,0.01)

# set some parameters
m = 10  # number of iterations for MLE optimization
t = seq(100, 200, by=10)  # time intervals
y = 304  # cut-off year for estimating probablity

# fit Gamma renewal model
result &lt;- marp::gamma_rp(data, t, m, y)

# print result
cat("par1 = ", result$par1, "\n")
cat("par2 = ", result$par2, "\n")
cat("logL = ", result$logL, "\n")
cat("AIC = ", result$AIC, "\n")
cat("BIC = ", result$BIC, "\n")
cat("mu_hat = ", result$mu_hat, "\n")
cat("pr_hat = ", result$pr_hat, "\n")

</code></pre>

<hr>
<h2 id='loglogis_bstrp'>A function to generate (double) bootstrap samples and fit Log-Logistic renewal model</h2><span id='topic+loglogis_bstrp'></span>

<h3>Description</h3>

<p>A function to generate (double) bootstrap samples and fit Log-Logistic renewal model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loglogis_bstrp(n, t, B, BB, m, par_hat, mu_hat, pr_hat, haz_hat, y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="loglogis_bstrp_+3A_n">n</code></td>
<td>
<p>number of inter-event times</p>
</td></tr>
<tr><td><code id="loglogis_bstrp_+3A_t">t</code></td>
<td>
<p>user-specified time intervals (used to compute hazard rate)</p>
</td></tr>
<tr><td><code id="loglogis_bstrp_+3A_b">B</code></td>
<td>
<p>number of bootstrap samples</p>
</td></tr>
<tr><td><code id="loglogis_bstrp_+3A_bb">BB</code></td>
<td>
<p>number of double-bootstrap samples</p>
</td></tr>
<tr><td><code id="loglogis_bstrp_+3A_m">m</code></td>
<td>
<p>the number of iterations in nlm</p>
</td></tr>
<tr><td><code id="loglogis_bstrp_+3A_par_hat">par_hat</code></td>
<td>
<p>estimated parameters</p>
</td></tr>
<tr><td><code id="loglogis_bstrp_+3A_mu_hat">mu_hat</code></td>
<td>
<p>estimated mean inter-event times</p>
</td></tr>
<tr><td><code id="loglogis_bstrp_+3A_pr_hat">pr_hat</code></td>
<td>
<p>estimated time to event probability</p>
</td></tr>
<tr><td><code id="loglogis_bstrp_+3A_haz_hat">haz_hat</code></td>
<td>
<p>estimated hazard rates</p>
</td></tr>
<tr><td><code id="loglogis_bstrp_+3A_y">y</code></td>
<td>
<p>user-specified time point (used to compute time-to-event probability)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns list of estimates after fitting Log-Logistic renewal model on (double) bootstrap samples
</p>

<dl>
<dt>mu_star</dt><dd><p>Estimated mean from bootstrapped samples </p>
</dd>
<dt>pr_star</dt><dd><p>Estimated probability from bootstrapped samples </p>
</dd>
<dt>haz_star</dt><dd><p>Estimated hazard rates from bootstrapped samples</p>
</dd>
<dt>mu_var_hat</dt><dd><p>Variance of estimated mean</p>
</dd>
<dt>pr_var_hat</dt><dd><p>Variance of estimated probability</p>
</dd>
<dt>haz_var_hat</dt><dd><p>Variance of estimated hazard rates</p>
</dd>
<dt>mu_var_double</dt><dd><p>Variance of estimated mean of bootstrapped samples (via double-bootstrapping)</p>
</dd>
<dt>pr_var_double</dt><dd><p>Variance of estimated probability of bootstrapped samples (via double-bootstrapping)</p>
</dd>
<dt>haz_var_double</dt><dd><p>Variance of estimated hazard rates of bootstrapped samples (via double-bootstrapping)</p>
</dd>
<dt>mu_Tstar</dt><dd><p>Pivot quantity of the estimated mean</p>
</dd>
<dt>pr_Tstar</dt><dd><p>Pivot quantity of the estimated probability</p>
</dd>
<dt>haz_Tstar</dt><dd><p>Pivot quantity of the estimated hazard rates</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>
# set some parameters
n &lt;- 30 # sample size
t &lt;- seq(100, 200, by = 10) # time intervals
B &lt;- 100 # number of bootstraps
BB &lt;- 100 # number of double-bootstraps
m &lt;- 10 # number of iterations for MLE optimization
par_hat &lt;- c(
  3.41361e-03, 2.76268e+00, 2.60370e+00, 3.30802e+02, 5.48822e+00, 2.92945e+02, NA,
  9.43071e-03, 2.47598e+02, 1.80102e+00, 6.50845e-01, 7.18247e-01
)
mu_hat &lt;- c(292.94512, 292.94513, 319.72017, 294.16945, 298.87286, 292.94512)
pr_hat &lt;- c(0.60039, 0.42155, 0.53434, 0.30780, 0.56416, 0.61795)
haz_hat &lt;-   matrix(c(
  -5.67999, -5.67999, -5.67999, -5.67999, -5.67999, -5.67999,
  -5.67999, -5.67999, -5.67999, -5.67999, -5.67999, -6.09420,
  -5.99679, -5.91174, -5.83682, -5.77031, -5.71085, -5.65738,
  -5.60904, -5.56512, -5.52504, -5.48833, -6.09902, -5.97017,
  -5.85769, -5.75939, -5.67350, -5.59856, -5.53336, -5.47683,
  -5.42805, -5.38621, -5.35060, -6.17146, -6.09512, -6.02542,
  -5.96131, -5.90194, -5.84668, -5.79498, -5.74642, -5.70064,
  -5.65733, -5.61624, -5.92355, -5.80239, -5.70475, -5.62524,
  -5.55994, -5.50595, -5.46106, -5.42359, -5.39222, -5.36591,
  -5.34383, -5.79111, -5.67660, -5.58924, -5.52166, -5.46879,
  -5.42707, -5.39394, -5.36751, -5.34637, -5.32946, -5.31596
),length(t),6)
 y &lt;- 304 # cut-off year for estimating probablity

# generate bootstrapped samples then fit renewal model
res &lt;- marp::loglogis_bstrp(n, t, B, BB, m, par_hat, mu_hat, pr_hat, haz_hat, y)


</code></pre>

<hr>
<h2 id='loglogis_logl'>A function to calculate the log-likelihood of Log-Logistics model</h2><span id='topic+loglogis_logl'></span>

<h3>Description</h3>

<p>A function to calculate the log-likelihood of Log-Logistics model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loglogis_logl(param, x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="loglogis_logl_+3A_param">param</code></td>
<td>
<p>parameters of Log-Logistics model</p>
</td></tr>
<tr><td><code id="loglogis_logl_+3A_x">x</code></td>
<td>
<p>input data for Log-Logistics model</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns the value of negative log-likelihood of the Log-Logistics model
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(42)
data &lt;-  rgamma(30,3,0.01)

# set some parameters
par_hat &lt;- c(2.6037079185931518, 247.59811806509711) # estimated parameters
param &lt;-  c(log(par_hat[2]),log(par_hat[1])) # input parameters for logl function

# calculate log-likelihood
result &lt;- marp::loglogis_logl(param, data)

# print result
cat("-logl = ", result, "\n")

</code></pre>

<hr>
<h2 id='loglogis_rp'>A function to fit Log-Logistics renewal model</h2><span id='topic+loglogis_rp'></span>

<h3>Description</h3>

<p>A function to fit Log-Logistics renewal model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loglogis_rp(data, t, m, y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="loglogis_rp_+3A_data">data</code></td>
<td>
<p>input inter-event times</p>
</td></tr>
<tr><td><code id="loglogis_rp_+3A_t">t</code></td>
<td>
<p>user-specified time intervals (used to compute hazard rate)</p>
</td></tr>
<tr><td><code id="loglogis_rp_+3A_m">m</code></td>
<td>
<p>the number of iterations in nlm</p>
</td></tr>
<tr><td><code id="loglogis_rp_+3A_y">y</code></td>
<td>
<p>user-specified time point (used to compute time-to-event probability)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns list of estimates after fitting Log-Logistics renewal model
</p>

<dl>
<dt>par1</dt><dd><p>Estimated shape parameter of the Log-Logistics model</p>
</dd>
<dt>par2</dt><dd><p>Estimated scale parameter of the Log-Logistics model</p>
</dd>
<dt>logL</dt><dd><p>Negative log-likelihood</p>
</dd>
<dt>AIC</dt><dd><p>Akaike information criterion (AIC)</p>
</dd>
<dt>BIC</dt><dd><p>Bayesian information criterion (BIC)</p>
</dd>
<dt>mu_hat</dt><dd><p>Estimated mean</p>
</dd>
<dt>pr_hat</dt><dd><p>Estimated (logit) probabilities</p>
</dd>
<dt>haz_hat</dt><dd><p>Estimated (log) hazard rates</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>set.seed(42)
data &lt;-  rgamma(100,3,0.01)

# set some parameters
m = 10  # number of iterations for MLE optimization
t = seq(100, 200, by=10)  # time intervals
y = 304  # cut-off year for estimating probablity

# fit Log-Logistic renewal model
result &lt;- marp::loglogis_rp(data, t, m, y)

# print result
cat("par1 = ", result$par1, "\n")
cat("par2 = ", result$par2, "\n")
cat("logL = ", result$logL, "\n")
cat("AIC = ", result$AIC, "\n")
cat("BIC = ", result$BIC, "\n")
cat("mu_hat = ", result$mu_hat, "\n")
cat("pr_hat = ", result$pr_hat, "\n")

</code></pre>

<hr>
<h2 id='lognorm_bstrp'>A function to generate (double) bootstrap samples and fit Log-Normal renewal model</h2><span id='topic+lognorm_bstrp'></span>

<h3>Description</h3>

<p>A function to generate (double) bootstrap samples and fit Log-Normal renewal model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lognorm_bstrp(n, t, B, BB, par_hat, mu_hat, pr_hat, haz_hat, y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lognorm_bstrp_+3A_n">n</code></td>
<td>
<p>number of inter-event times</p>
</td></tr>
<tr><td><code id="lognorm_bstrp_+3A_t">t</code></td>
<td>
<p>user-specified time intervals (used to compute hazard rate)</p>
</td></tr>
<tr><td><code id="lognorm_bstrp_+3A_b">B</code></td>
<td>
<p>number of bootstrap samples</p>
</td></tr>
<tr><td><code id="lognorm_bstrp_+3A_bb">BB</code></td>
<td>
<p>number of double-bootstrap samples</p>
</td></tr>
<tr><td><code id="lognorm_bstrp_+3A_par_hat">par_hat</code></td>
<td>
<p>estimated parameters</p>
</td></tr>
<tr><td><code id="lognorm_bstrp_+3A_mu_hat">mu_hat</code></td>
<td>
<p>estimated mean inter-event times</p>
</td></tr>
<tr><td><code id="lognorm_bstrp_+3A_pr_hat">pr_hat</code></td>
<td>
<p>estimated time to event probability</p>
</td></tr>
<tr><td><code id="lognorm_bstrp_+3A_haz_hat">haz_hat</code></td>
<td>
<p>estimated hazard rates</p>
</td></tr>
<tr><td><code id="lognorm_bstrp_+3A_y">y</code></td>
<td>
<p>user-specified time point (used to compute time-to-event probability)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns list of estimates after fitting Log-Normal renewal model on (double) bootstrap samples
</p>

<dl>
<dt>mu_star</dt><dd><p>Estimated mean from bootstrapped samples </p>
</dd>
<dt>pr_star</dt><dd><p>Estimated probability from bootstrapped samples </p>
</dd>
<dt>haz_star</dt><dd><p>Estimated hazard rates from bootstrapped samples</p>
</dd>
<dt>mu_var_hat</dt><dd><p>Variance of estimated mean</p>
</dd>
<dt>pr_var_hat</dt><dd><p>Variance of estimated probability</p>
</dd>
<dt>haz_var_hat</dt><dd><p>Variance of estimated hazard rates</p>
</dd>
<dt>mu_var_double</dt><dd><p>Variance of estimated mean of bootstrapped samples (via double-bootstrapping)</p>
</dd>
<dt>pr_var_double</dt><dd><p>Variance of estimated probability of bootstrapped samples (via double-bootstrapping)</p>
</dd>
<dt>haz_var_double</dt><dd><p>Variance of estimated hazard rates of bootstrapped samples (via double-bootstrapping)</p>
</dd>
<dt>mu_Tstar</dt><dd><p>Pivot quantity of the estimated mean</p>
</dd>
<dt>pr_Tstar</dt><dd><p>Pivot quantity of the estimated probability</p>
</dd>
<dt>haz_Tstar</dt><dd><p>Pivot quantity of the estimated hazard rates</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>
# set some parameters
n &lt;- 30 # sample size
t &lt;- seq(100, 200, by = 10) # time intervals
B &lt;- 100 # number of bootstraps
BB &lt;- 100 # number of double-bootstraps
# m &lt;- 10 # number of iterations for MLE optimization
par_hat &lt;- c(
  3.41361e-03, 2.76268e+00, 2.60370e+00, 3.30802e+02, 5.48822e+00, 2.92945e+02, NA,
  9.43071e-03, 2.47598e+02, 1.80102e+00, 6.50845e-01, 7.18247e-01
)
mu_hat &lt;- c(292.94512, 292.94513, 319.72017, 294.16945, 298.87286, 292.94512)
pr_hat &lt;- c(0.60039, 0.42155, 0.53434, 0.30780, 0.56416, 0.61795)
haz_hat &lt;-   matrix(c(
  -5.67999, -5.67999, -5.67999, -5.67999, -5.67999, -5.67999,
  -5.67999, -5.67999, -5.67999, -5.67999, -5.67999, -6.09420,
  -5.99679, -5.91174, -5.83682, -5.77031, -5.71085, -5.65738,
  -5.60904, -5.56512, -5.52504, -5.48833, -6.09902, -5.97017,
  -5.85769, -5.75939, -5.67350, -5.59856, -5.53336, -5.47683,
  -5.42805, -5.38621, -5.35060, -6.17146, -6.09512, -6.02542,
  -5.96131, -5.90194, -5.84668, -5.79498, -5.74642, -5.70064,
  -5.65733, -5.61624, -5.92355, -5.80239, -5.70475, -5.62524,
  -5.55994, -5.50595, -5.46106, -5.42359, -5.39222, -5.36591,
  -5.34383, -5.79111, -5.67660, -5.58924, -5.52166, -5.46879,
  -5.42707, -5.39394, -5.36751, -5.34637, -5.32946, -5.31596
),length(t),6)
y &lt;- 304 # cut-off year for estimating probablity

# generate bootstrapped samples then fit renewal model
res &lt;- marp::lognorm_bstrp(n, t, B, BB, par_hat, mu_hat, pr_hat, haz_hat, y)


</code></pre>

<hr>
<h2 id='lognorm_rp'>A function to fit Log-Normal renewal model</h2><span id='topic+lognorm_rp'></span>

<h3>Description</h3>

<p>A function to fit Log-Normal renewal model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lognorm_rp(data, t, y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lognorm_rp_+3A_data">data</code></td>
<td>
<p>as input inter-event times</p>
</td></tr>
<tr><td><code id="lognorm_rp_+3A_t">t</code></td>
<td>
<p>as user-specified time intervals (used to compute hazard rate)</p>
</td></tr>
<tr><td><code id="lognorm_rp_+3A_y">y</code></td>
<td>
<p>as user-specified time point (used to compute time-to-event probability)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns list of estimates after fitting Log-Normal renewal model
</p>

<dl>
<dt>par1</dt><dd><p>Estimated mean (on the log scale) of the Log-Normal model</p>
</dd>
<dt>par2</dt><dd><p>Estimated standard deviation (on the log scale)of the Log-Normal model</p>
</dd>
<dt>logL</dt><dd><p>Negative log-likelihood</p>
</dd>
<dt>AIC</dt><dd><p>Akaike information criterion (AIC)</p>
</dd>
<dt>BIC</dt><dd><p>Bayesian information criterion (BIC)</p>
</dd>
<dt>mu_hat</dt><dd><p>Estimated mean</p>
</dd>
<dt>pr_hat</dt><dd><p>Estimated (logit) probabilities</p>
</dd>
<dt>haz_hat</dt><dd><p>Estimated (log) hazard rates</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>set.seed(42)
data &lt;-  rgamma(100,3,0.01)

# set some parameters
t = seq(100, 200, by=10)  # time intervals
y = 304  # cut-off year for estimating probablity

# fit Log-Normal renewal model
result &lt;- marp::lognorm_rp(data, t, y)

# print result
cat("par1 = ", result$par1, "\n")
cat("par2 = ", result$par2, "\n")
cat("logL = ", result$logL, "\n")
cat("AIC = ", result$AIC, "\n")
cat("BIC = ", result$BIC, "\n")
cat("mu_hat = ", result$mu_hat, "\n")
cat("pr_hat = ", result$pr_hat, "\n")

</code></pre>

<hr>
<h2 id='lowerT'>An utility function to calculate upper limit of T statistic</h2><span id='topic+lowerT'></span>

<h3>Description</h3>

<p>An utility function to calculate upper limit of T statistic
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lowerT(low, hat, sigmasq, Tstar, weights, B, alpha)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lowerT_+3A_low">low</code></td>
<td>
<p>lower limit</p>
</td></tr>
<tr><td><code id="lowerT_+3A_hat">hat</code></td>
<td>
<p>estimates</p>
</td></tr>
<tr><td><code id="lowerT_+3A_sigmasq">sigmasq</code></td>
<td>
<p>variance</p>
</td></tr>
<tr><td><code id="lowerT_+3A_tstar">Tstar</code></td>
<td>
<p>T statistics estimated from bootstrap samples</p>
</td></tr>
<tr><td><code id="lowerT_+3A_weights">weights</code></td>
<td>
<p>model weights</p>
</td></tr>
<tr><td><code id="lowerT_+3A_b">B</code></td>
<td>
<p>number of bootstraps</p>
</td></tr>
<tr><td><code id="lowerT_+3A_alpha">alpha</code></td>
<td>
<p>confidence level</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns upper limit of T-statistic
</p>


<h3>Examples</h3>

<pre><code class='language-R'># set some parameters
low &lt;- 100 # lower bound
hat &lt;- rep(150, 6) # estimates obtained from each model
sigmasq &lt;- 10 # variance
Tstar &lt;- matrix(rep(100,600),6,100) # T statistics estimated from bootstrap samples
weights &lt;- rep(1/6, 6) # model weights
B &lt;- 100 # number of bootstrapped samples
alpha &lt;- 0.05 # confidence level

# calculate the upper limit of T statistics
res &lt;- marp::lowerT(low, hat, sigmasq, Tstar, weights, B, alpha)

# print result
cat("res = ", res, "\n")

</code></pre>

<hr>
<h2 id='marp'>A function to apply model-averaged renewal process</h2><span id='topic+marp'></span>

<h3>Description</h3>

<p>A function to apply model-averaged renewal process
</p>


<h3>Usage</h3>

<pre><code class='language-R'>marp(data, t, m, y, which.model = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="marp_+3A_data">data</code></td>
<td>
<p>input inter-event times</p>
</td></tr>
<tr><td><code id="marp_+3A_t">t</code></td>
<td>
<p>user-specified time intervals (used to compute hazard rate)</p>
</td></tr>
<tr><td><code id="marp_+3A_m">m</code></td>
<td>
<p>the number of iterations in nlm</p>
</td></tr>
<tr><td><code id="marp_+3A_y">y</code></td>
<td>
<p>user-specified time point (used to compute time-to-event probability)</p>
</td></tr>
<tr><td><code id="marp_+3A_which.model">which.model</code></td>
<td>
<p>user-specified generating (or true underlying if known) model</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns list of estimates obtained from different renewal processes and after applying model-averaging
</p>

<dl>
<dt>par1</dt><dd><p>Estimated scale parameters (if applicable) of all six renewal models</p>
</dd>
<dt>par2</dt><dd><p>Estimated shape parameters (if applicable) of all six renewal models</p>
</dd>
<dt>logL</dt><dd><p>Negative log-likelihood</p>
</dd>
<dt>AIC</dt><dd><p>Akaike information criterion (AIC)</p>
</dd>
<dt>BIC</dt><dd><p>Bayesian information criterion (BIC)</p>
</dd>
<dt>mu_hat</dt><dd><p>Estimated mean</p>
</dd>
<dt>pr_hat</dt><dd><p>Estimated (logit) probabilities</p>
</dd>
<dt>haz_hat</dt><dd><p>Estimated (log) hazard rates</p>
</dd>
<dt>weights_AIC</dt><dd><p>Model weights calculated based on AIC</p>
</dd>
<dt>weights_BIC</dt><dd><p>Model weights calculated based on BIC</p>
</dd>
<dt>model_best</dt><dd><p>Model selected based on the lowest AIC</p>
</dd>
<dt>mu_best</dt><dd><p>Estimated mean obtained from the model with the lowest AIC</p>
</dd>
<dt>pr_best</dt><dd><p>Estimated probability obtained from the model with the lowest AIC</p>
</dd>
<dt>haz_best</dt><dd><p>Estimated hazard rates obtained from the model with the lowest AIC</p>
</dd>
<dt>mu_gen</dt><dd><p>Estimated mean obtained from the (true or hypothetical) generating model </p>
</dd>
<dt>pr_gen</dt><dd><p>Estimated probability obtained from the (true or hypothetical) generating model </p>
</dd>
<dt>haz_gen</dt><dd><p>Estimated hazard rates obtained from the (true or hypothetical) generating model </p>
</dd>
<dt>mu_aic</dt><dd><p>Estimated mean obtained from model-averaging (using AIC weights)</p>
</dd>
<dt>pr_aic</dt><dd><p>Estimated probability obtained from model-averaging (using AIC weights)  </p>
</dd>
<dt>haz_aic</dt><dd><p>Estimated hazard rates obtained from model-averaging (using AIC weights)</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>set.seed(42)
data &lt;-  rgamma(100,3,0.01)

# set some parameters
m = 10  # number of iterations for MLE optimization
t = seq(100, 200, by=10)  # time intervals
y = 304  # cut-off year for estimating probability
which.model &lt;- 2 # specify the generating model

# model selection and averaging
result &lt;- marp::marp(data, t, m, y, which.model)

</code></pre>

<hr>
<h2 id='marp_bstrp'>A function to fit model-averaged renewal process</h2><span id='topic+marp_bstrp'></span>

<h3>Description</h3>

<p>A function to fit model-averaged renewal process
</p>


<h3>Usage</h3>

<pre><code class='language-R'>marp_bstrp(n, t, B, BB, m, par_hat, mu_hat, pr_hat, haz_hat, y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="marp_bstrp_+3A_n">n</code></td>
<td>
<p>number of inter-event times</p>
</td></tr>
<tr><td><code id="marp_bstrp_+3A_t">t</code></td>
<td>
<p>user-specified time intervals (used to compute hazard rate)</p>
</td></tr>
<tr><td><code id="marp_bstrp_+3A_b">B</code></td>
<td>
<p>number of bootstrap samples</p>
</td></tr>
<tr><td><code id="marp_bstrp_+3A_bb">BB</code></td>
<td>
<p>number of double-bootstrap samples</p>
</td></tr>
<tr><td><code id="marp_bstrp_+3A_m">m</code></td>
<td>
<p>the number of iterations in nlm</p>
</td></tr>
<tr><td><code id="marp_bstrp_+3A_par_hat">par_hat</code></td>
<td>
<p>estimated parameters</p>
</td></tr>
<tr><td><code id="marp_bstrp_+3A_mu_hat">mu_hat</code></td>
<td>
<p>estimated mean inter-event times</p>
</td></tr>
<tr><td><code id="marp_bstrp_+3A_pr_hat">pr_hat</code></td>
<td>
<p>estimated time to event probability</p>
</td></tr>
<tr><td><code id="marp_bstrp_+3A_haz_hat">haz_hat</code></td>
<td>
<p>estimated hazard rates</p>
</td></tr>
<tr><td><code id="marp_bstrp_+3A_y">y</code></td>
<td>
<p>user-specified time point (used to compute time-to-event probability)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns list of estimates after fitting different renewal models on (double) bootstrap samples
</p>

<dl>
<dt>mu_star</dt><dd><p>Estimated mean from bootstrapped samples </p>
</dd>
<dt>pr_star</dt><dd><p>Estimated probability from bootstrapped samples </p>
</dd>
<dt>haz_star</dt><dd><p>Estimated hazard rates from bootstrapped samples</p>
</dd>
<dt>mu_var_hat</dt><dd><p>Variance of estimated mean</p>
</dd>
<dt>pr_var_hat</dt><dd><p>Variance of estimated probability</p>
</dd>
<dt>haz_var_hat</dt><dd><p>Variance of estimated hazard rates</p>
</dd>
<dt>mu_var_double</dt><dd><p>Variance of estimated mean of bootstrapped samples (via double-bootstrapping)</p>
</dd>
<dt>pr_var_double</dt><dd><p>Variance of estimated probability of bootstrapped samples (via double-bootstrapping)</p>
</dd>
<dt>haz_var_double</dt><dd><p>Variance of estimated hazard rates of bootstrapped samples (via double-bootstrapping)</p>
</dd>
<dt>mu_Tstar</dt><dd><p>Pivot quantity of the estimated mean</p>
</dd>
<dt>pr_Tstar</dt><dd><p>Pivot quantity of the estimated probability</p>
</dd>
<dt>haz_Tstar</dt><dd><p>Pivot quantity of the estimated hazard rates</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>
# set some parameters
n &lt;- 30 # sample size
t &lt;- seq(100, 200, by = 10) # time intervals
B &lt;- 100 # number of bootstraps
BB &lt;- 100 # number of double-bootstraps
m &lt;- 10 # number of iterations for MLE optimization
par_hat &lt;- c(
  3.41361e-03, 2.76268e+00, 2.60370e+00, 3.30802e+02, 5.48822e+00, 2.92945e+02, NA,
  9.43071e-03, 2.47598e+02, 1.80102e+00, 6.50845e-01, 7.18247e-01
)
mu_hat &lt;- c(292.94512, 292.94513, 319.72017, 294.16945, 298.87286, 292.94512)
pr_hat &lt;- c(0.60039, 0.42155, 0.53434, 0.30780, 0.56416, 0.61795)
haz_hat &lt;-   matrix(c(
  -5.67999, -5.67999, -5.67999, -5.67999, -5.67999, -5.67999,
  -5.67999, -5.67999, -5.67999, -5.67999, -5.67999, -6.09420,
  -5.99679, -5.91174, -5.83682, -5.77031, -5.71085, -5.65738,
  -5.60904, -5.56512, -5.52504, -5.48833, -6.09902, -5.97017,
  -5.85769, -5.75939, -5.67350, -5.59856, -5.53336, -5.47683,
  -5.42805, -5.38621, -5.35060, -6.17146, -6.09512, -6.02542,
  -5.96131, -5.90194, -5.84668, -5.79498, -5.74642, -5.70064,
  -5.65733, -5.61624, -5.92355, -5.80239, -5.70475, -5.62524,
  -5.55994, -5.50595, -5.46106, -5.42359, -5.39222, -5.36591,
  -5.34383, -5.79111, -5.67660, -5.58924, -5.52166, -5.46879,
  -5.42707, -5.39394, -5.36751, -5.34637, -5.32946, -5.31596
),length(t),6)
y &lt;- 304 # cut-off year for estimating probablity

# generate bootstrapped samples then fit renewal model
res &lt;- marp::marp_bstrp(n, t, B, BB, m, par_hat, mu_hat, pr_hat, haz_hat, y)


</code></pre>

<hr>
<h2 id='marp_confint'>A function to apply model-averaged renewal process</h2><span id='topic+marp_confint'></span>

<h3>Description</h3>

<p>A function to apply model-averaged renewal process
</p>


<h3>Usage</h3>

<pre><code class='language-R'>marp_confint(data, m, t, B, BB, alpha, y, which.model)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="marp_confint_+3A_data">data</code></td>
<td>
<p>input inter-event times</p>
</td></tr>
<tr><td><code id="marp_confint_+3A_m">m</code></td>
<td>
<p>the number of iterations in nlm</p>
</td></tr>
<tr><td><code id="marp_confint_+3A_t">t</code></td>
<td>
<p>user-specified time intervals (used to compute hazard rate)</p>
</td></tr>
<tr><td><code id="marp_confint_+3A_b">B</code></td>
<td>
<p>number of bootstrap samples</p>
</td></tr>
<tr><td><code id="marp_confint_+3A_bb">BB</code></td>
<td>
<p>number of double-bootstrap samples</p>
</td></tr>
<tr><td><code id="marp_confint_+3A_alpha">alpha</code></td>
<td>
<p>significance level</p>
</td></tr>
<tr><td><code id="marp_confint_+3A_y">y</code></td>
<td>
<p>user-specified time point (used to compute time-to-event probability)</p>
</td></tr>
<tr><td><code id="marp_confint_+3A_which.model">which.model</code></td>
<td>
<p>user-specified generating (or true underlying if known) model</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns list of point and interval estimation obtained from different renewal models (including model-averaged confidence intervals).
</p>

<dl>
<dt>par1</dt><dd><p>Estimated scale parameters (if applicable) of all six renewal models</p>
</dd>
<dt>par2</dt><dd><p>Estimated shape parameters (if applicable) of all six renewal models</p>
</dd>
<dt>logL</dt><dd><p>Negative log-likelihood</p>
</dd>
<dt>AIC</dt><dd><p>Akaike information criterion (AIC)</p>
</dd>
<dt>BIC</dt><dd><p>Bayesian information criterion (BIC)</p>
</dd>
<dt>mu_hat</dt><dd><p>Estimated mean</p>
</dd>
<dt>pr_hat</dt><dd><p>Estimated (logit) probabilities</p>
</dd>
<dt>haz_hat</dt><dd><p>Estimated (log) hazard rates</p>
</dd>
<dt>weights_AIC</dt><dd><p>Model weights calculated based on AIC</p>
</dd>
<dt>weights_BIC</dt><dd><p>Model weights calculated based on BIC</p>
</dd>
<dt>model_best</dt><dd><p>Model selected based on the lowest AIC</p>
</dd>
<dt>mu_best</dt><dd><p>Estimated mean obtained from the model with the lowest AIC</p>
</dd>
<dt>pr_best</dt><dd><p>Estimated probability obtained from the model with the lowest AIC</p>
</dd>
<dt>haz_best</dt><dd><p>Estimated hazard rates obtained from the model with the lowest AIC</p>
</dd>
<dt>mu_gen</dt><dd><p>Estimated mean obtained from the (true or hypothetical) generating model </p>
</dd>
<dt>pr_gen</dt><dd><p>Estimated probability obtained from the (true or hypothetical) generating model </p>
</dd>
<dt>haz_gen</dt><dd><p>Estimated hazard rates obtained from the (true or hypothetical) generating model </p>
</dd>
<dt>mu_aic</dt><dd><p>Estimated mean obtained from model-averaging (using AIC weights)</p>
</dd>
<dt>pr_aic</dt><dd><p>Estimated probability obtained from model-averaging (using AIC weights)  </p>
</dd>
<dt>haz_aic</dt><dd><p>Estimated hazard rates obtained from model-averaging (using AIC weights)</p>
</dd>
<dt>mu_bstrp</dt><dd><p>Estimated mean obtained from model-averaging (using bootstrapped weights)</p>
</dd>
<dt>pr_bstrp</dt><dd><p>Estimated probability obtained from model-averaging (using bootstrapped weights)  </p>
</dd>
<dt>haz_bstrp</dt><dd><p>Estimated hazard rates obtained from model-averaging (using bootstrapped weights)</p>
</dd>
<dt>weights_bstp</dt><dd><p>Model weights calculated by bootstrapping, that is, the frequency of each model being selected as the best model is divided by the total number of bootstraps</p>
</dd>
<dt>mu_gen</dt><dd><p>Median of the percentile bootstrap confidence interval of the estimated mean based on the generating model</p>
</dd>
<dt>mu_gen_lower</dt><dd><p>Lower limit of the percentile bootstrap confidence interval of the estimated mean based on the generating model</p>
</dd>
<dt>mu_gen_upper</dt><dd><p>Upper limit of the percentile bootstrap confidence interval of the estimated mean based on the generating model</p>
</dd>
<dt>mu_best</dt><dd><p>Median of the percentile bootstrap confidence interval of the estimated mean based on the best model</p>
</dd>
<dt>mu_best_lower</dt><dd><p>Lower limit of the percentile bootstrap confidence interval of the estimated mean based on the best model</p>
</dd>
<dt>mu_best_upper</dt><dd><p>Upper limit of the percentile bootstrap confidence interval of the estimated mean based on the best model</p>
</dd>
<dt>pr_gen</dt><dd><p>Median of the percentile bootstrap confidence interval of the estimated probabilities  based on the generating model</p>
</dd>
<dt>pr_gen_lower</dt><dd><p>Lower limit of the percentile bootstrap confidence interval of the estimated probabilities  based on the generating model</p>
</dd>
<dt>pr_gen_upper</dt><dd><p>Upper limit of the percentile bootstrap confidence interval of the estimated probabilities  based on the generating model</p>
</dd>
<dt>pr_best</dt><dd><p>Median of the percentile bootstrap confidence interval of the estimated probabilities  based on the best model</p>
</dd>
<dt>pr_best_lower</dt><dd><p>Lower limit of the percentile bootstrap confidence interval of the estimated probabilities  based on the best model</p>
</dd>
<dt>pr_best_upper</dt><dd><p>Upper limit of the percentile bootstrap confidence interval of the estimated probabilities  based on the best model</p>
</dd>
<dt>haz_gen</dt><dd><p>Median of the percentile bootstrap confidence interval of the estimated hazard rates  based on the generating model</p>
</dd>
<dt>haz_gen_lower</dt><dd><p>Lower limit of the percentile bootstrap confidence interval of the estimated hazard rates  based on the generating model</p>
</dd>
<dt>haz_gen_upper</dt><dd><p>Upper limit of the percentile bootstrap confidence interval of the estimated hazard rates  based on the generating model</p>
</dd>
<dt>haz_best</dt><dd><p>Median of the percentile bootstrap confidence interval of the estimated hazard rates  based on the best model</p>
</dd>
<dt>haz_best_lower</dt><dd><p>Lower limit of the percentile bootstrap confidence interval of the estimated hazard rates  based on the best model</p>
</dd>
<dt>haz_best_upper</dt><dd><p>Upper limit of the percentile bootstrap confidence interval of the estimated hazard rates  based on the best model</p>
</dd>
<dt>mu_lower_gen</dt><dd><p>Lower limit of the studentized bootstrap confidence interval of the estimated mean based on the generating model</p>
</dd>
<dt>mu_upper_gen</dt><dd><p>Upper limit of the studentized bootstrap confidence interval of the estimated mean based on the generating model</p>
</dd>
<dt>mu_lower_best</dt><dd><p>Lower limit of the studentized bootstrap confidence interval of the estimated mean based on the best model</p>
</dd>
<dt>mu_upper_best</dt><dd><p>Upper limit of the studentized bootstrap confidence interval of the estimated mean based on the best model</p>
</dd>
<dt>pr_lower_gen</dt><dd><p>Lower limit of the studentized bootstrap confidence interval of the estimated probabilities  based on the generating model</p>
</dd>
<dt>pr_upper_gen</dt><dd><p>Upper limit of the studentized bootstrap confidence interval of the estimated probabilities  based on the generating model</p>
</dd>
<dt>pr_lower_best</dt><dd><p>Lower limit of the studentized bootstrap confidence interval of the estimated probabilities  based on the best model</p>
</dd>
<dt>pr_upper_best</dt><dd><p>Upper limit of the studentized bootstrap confidence interval of the estimated probabilities  based on the best model</p>
</dd>
<dt>haz_lower_gen</dt><dd><p>Lower limit of the studentized bootstrap confidence interval of the estimated hazard rates  based on the generating model</p>
</dd>
<dt>haz_upper_gen</dt><dd><p>Upper limit of the studentized bootstrap confidence interval of the estimated hazard rates  based on the generating model</p>
</dd>
<dt>haz_lower_best</dt><dd><p>Lower limit of the studentized bootstrap confidence interval of the estimated hazard rates  based on the best model</p>
</dd>
<dt>haz_upper_best</dt><dd><p>Upper limit of the studentized bootstrap confidence interval of the estimated hazard rates  based on the best model</p>
</dd>
<dt>mu_lower_ma</dt><dd><p>Lower limit of model-averaged studentized bootstrap confidence interval of the estimated mean </p>
</dd>
<dt>mu_upper_ma</dt><dd><p>Upper limit of model-averaged studentized bootstrap confidence interval of the estimated mean </p>
</dd>
<dt>pr_lower_ma</dt><dd><p>Lower limit of model-averaged studentized bootstrap confidence interval of the estimated probabilities  </p>
</dd>
<dt>pr_upper_ma</dt><dd><p>Upper limit of model-averaged studentized bootstrap confidence interval of the estimated probabilities  </p>
</dd>
<dt>haz_lower_ma</dt><dd><p>Lower limit of model-averaged studentized bootstrap confidence interval of the estimated hazard rates  </p>
</dd>
<dt>haz_upper_ma</dt><dd><p>Upper limit of model-averaged studentized bootstrap confidence interval of the estimated hazard rates  </p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>
# generate random data
set.seed(42)
data &lt;- rgamma(30, 3, 0.01)

# set some parameters
m &lt;- 10 # number of iterations for MLE optimization
t &lt;- seq(100,200,by=10) # time intervals
alpha &lt;- 0.05 # confidence level
y &lt;- 304 # cut-off year for estimating probability
B &lt;- 100 # number of bootstraps
BB &lt;- 100 # number of double bootstraps
which.model &lt;- 2 # specify the generating model

# construct confidence invtervals
res &lt;- marp::marp_confint(data,m,t,B,BB,alpha,y,which.model)


</code></pre>

<hr>
<h2 id='percent_confint'>A function to calculate percentile bootstrap confidence interval</h2><span id='topic+percent_confint'></span>

<h3>Description</h3>

<p>A function to calculate percentile bootstrap confidence interval
</p>


<h3>Usage</h3>

<pre><code class='language-R'>percent_confint(data, B, t, m, y, which.model = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="percent_confint_+3A_data">data</code></td>
<td>
<p>input inter-event times</p>
</td></tr>
<tr><td><code id="percent_confint_+3A_b">B</code></td>
<td>
<p>number of bootstrap samples</p>
</td></tr>
<tr><td><code id="percent_confint_+3A_t">t</code></td>
<td>
<p>user-specified time intervals (used to compute hazard rate)</p>
</td></tr>
<tr><td><code id="percent_confint_+3A_m">m</code></td>
<td>
<p>the number of iterations in nlm</p>
</td></tr>
<tr><td><code id="percent_confint_+3A_y">y</code></td>
<td>
<p>user-specified time point (used to compute time-to-event probability)</p>
</td></tr>
<tr><td><code id="percent_confint_+3A_which.model">which.model</code></td>
<td>
<p>user-specified generating (or true underlying if known) model</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns list of percentile bootstrap intervals (including the model-averaged approach).
</p>

<dl>
<dt>weights_bstp</dt><dd><p>Model weights calculated by bootstrapping, that is, the frequency of each model being selected as the best model is divided by the total number of bootstraps</p>
</dd>
<dt>mu_gen</dt><dd><p>Median of the percentile bootstrap confidence interval of the estimated mean based on the generating model</p>
</dd>
<dt>mu_gen_lower</dt><dd><p>Lower limit of the percentile bootstrap confidence interval of the estimated mean based on the generating model</p>
</dd>
<dt>mu_gen_upper</dt><dd><p>Upper limit of the percentile bootstrap confidence interval of the estimated mean based on the generating model</p>
</dd>
<dt>mu_best</dt><dd><p>Median of the percentile bootstrap confidence interval of the estimated mean based on the best model</p>
</dd>
<dt>mu_best_lower</dt><dd><p>Lower limit of the percentile bootstrap confidence interval of the estimated mean based on the best model</p>
</dd>
<dt>mu_best_upper</dt><dd><p>Upper limit of the percentile bootstrap confidence interval of the estimated mean based on the best model</p>
</dd>
<dt>pr_gen</dt><dd><p>Median of the percentile bootstrap confidence interval of the estimated probabilities  based on the generating model</p>
</dd>
<dt>pr_gen_lower</dt><dd><p>Lower limit of the percentile bootstrap confidence interval of the estimated probabilities  based on the generating model</p>
</dd>
<dt>pr_gen_upper</dt><dd><p>Upper limit of the percentile bootstrap confidence interval of the estimated probabilities  based on the generating model</p>
</dd>
<dt>pr_best</dt><dd><p>Median of the percentile bootstrap confidence interval of the estimated probabilities  based on the best model</p>
</dd>
<dt>pr_best_lower</dt><dd><p>Lower limit of the percentile bootstrap confidence interval of the estimated probabilities  based on the best model</p>
</dd>
<dt>pr_best_upper</dt><dd><p>Upper limit of the percentile bootstrap confidence interval of the estimated probabilities  based on the best model</p>
</dd>
<dt>haz_gen</dt><dd><p>Median of the percentile bootstrap confidence interval of the estimated hazard rates  based on the generating model</p>
</dd>
<dt>haz_gen_lower</dt><dd><p>Lower limit of the percentile bootstrap confidence interval of the estimated hazard rates  based on the generating model</p>
</dd>
<dt>haz_gen_upper</dt><dd><p>Upper limit of the percentile bootstrap confidence interval of the estimated hazard rates  based on the generating model</p>
</dd>
<dt>haz_best</dt><dd><p>Median of the percentile bootstrap confidence interval of the estimated hazard rates  based on the best model</p>
</dd>
<dt>haz_best_lower</dt><dd><p>Lower limit of the percentile bootstrap confidence interval of the estimated hazard rates  based on the best model</p>
</dd>
<dt>haz_best_upper</dt><dd><p>Upper limit of the percentile bootstrap confidence interval of the estimated hazard rates  based on the best model</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>
# generate random data
set.seed(42)
data &lt;- rgamma(30, 3, 0.01)

# set some parameters
m &lt;- 10 # number of iterations for MLE optimization
t &lt;- seq(100,200,by=10) # time intervals
y &lt;- 304 # cut-off year for estimating probablity
B &lt;- 100 # number of bootstraps
BB &lt;- 100 # number of double bootstraps
which.model &lt;- 2 # specify the generating model

# construct percentile bootstrap confidence invtervals
marp::percent_confint(data, B, t, m, y, which.model)


</code></pre>

<hr>
<h2 id='pllog'>Probability function of Log-Logistics model</h2><span id='topic+pllog'></span>

<h3>Description</h3>

<p>Probability function of Log-Logistics model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pllog(q, shape = 1, scale = 1, lower.tail = TRUE, log.p = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pllog_+3A_q">q</code></td>
<td>
<p>input quantile for Log-Logistics model</p>
</td></tr>
<tr><td><code id="pllog_+3A_shape">shape</code></td>
<td>
<p>shape parameter of Log-Logistics model</p>
</td></tr>
<tr><td><code id="pllog_+3A_scale">scale</code></td>
<td>
<p>scale parameter of Log-Logistics model</p>
</td></tr>
<tr><td><code id="pllog_+3A_lower.tail">lower.tail</code></td>
<td>
<p>logic function to determine whether lower tail probability to be returned</p>
</td></tr>
<tr><td><code id="pllog_+3A_log.p">log.p</code></td>
<td>
<p>logic function to determine whether log of logistics to be returned</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns the probability of the Log-Logistics model
</p>


<h3>Examples</h3>

<pre><code class='language-R'>q &lt;- c(1, 2, 3, 4)
# set paramters
shape &lt;- 5
scale &lt;- 3
log &lt;- FALSE
result_1 &lt;- marp::pllog(q, shape, scale, log)

# alternatively, set log == TRUE
log &lt;- TRUE
result_2 &lt;-  marp::pllog(q, shape, scale, log)

</code></pre>

<hr>
<h2 id='poisson_bstrp'>A function to generate (double) bootstrap samples and fit Poisson renewal model</h2><span id='topic+poisson_bstrp'></span>

<h3>Description</h3>

<p>A function to generate (double) bootstrap samples and fit Poisson renewal model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>poisson_bstrp(n, t, B, BB, par_hat, mu_hat, pr_hat, haz_hat, y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="poisson_bstrp_+3A_n">n</code></td>
<td>
<p>number of inter-event times</p>
</td></tr>
<tr><td><code id="poisson_bstrp_+3A_t">t</code></td>
<td>
<p>user-specified time intervals (used to compute hazard rate)</p>
</td></tr>
<tr><td><code id="poisson_bstrp_+3A_b">B</code></td>
<td>
<p>number of bootstrap samples</p>
</td></tr>
<tr><td><code id="poisson_bstrp_+3A_bb">BB</code></td>
<td>
<p>number of double-bootstrap samples</p>
</td></tr>
<tr><td><code id="poisson_bstrp_+3A_par_hat">par_hat</code></td>
<td>
<p>estimated parameters</p>
</td></tr>
<tr><td><code id="poisson_bstrp_+3A_mu_hat">mu_hat</code></td>
<td>
<p>estimated mean inter-event times</p>
</td></tr>
<tr><td><code id="poisson_bstrp_+3A_pr_hat">pr_hat</code></td>
<td>
<p>estimated time to event probability</p>
</td></tr>
<tr><td><code id="poisson_bstrp_+3A_haz_hat">haz_hat</code></td>
<td>
<p>estimated hazard rates</p>
</td></tr>
<tr><td><code id="poisson_bstrp_+3A_y">y</code></td>
<td>
<p>user-specified time point (used to compute time-to-event probability)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns list of estimates after fitting Poisson renewal model on (double) bootstrap samples
</p>

<dl>
<dt>mu_star</dt><dd><p>Estimated mean from bootstrapped samples </p>
</dd>
<dt>pr_star</dt><dd><p>Estimated probability from bootstrapped samples </p>
</dd>
<dt>haz_star</dt><dd><p>Estimated hazard rates from bootstrapped samples</p>
</dd>
<dt>mu_var_hat</dt><dd><p>Variance of estimated mean</p>
</dd>
<dt>pr_var_hat</dt><dd><p>Variance of estimated probability</p>
</dd>
<dt>haz_var_hat</dt><dd><p>Variance of estimated hazard rates</p>
</dd>
<dt>mu_var_double</dt><dd><p>Variance of estimated mean of bootstrapped samples (via double-bootstrapping)</p>
</dd>
<dt>pr_var_double</dt><dd><p>Variance of estimated probability of bootstrapped samples (via double-bootstrapping)</p>
</dd>
<dt>haz_var_double</dt><dd><p>Variance of estimated hazard rates of bootstrapped samples (via double-bootstrapping)</p>
</dd>
<dt>mu_Tstar</dt><dd><p>Pivot quantity of the estimated mean</p>
</dd>
<dt>pr_Tstar</dt><dd><p>Pivot quantity of the estimated probability </p>
</dd>
<dt>haz_Tstar</dt><dd><p>Pivot quantity of the estimated hazard rates </p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>
# set some parameters
n &lt;- 30 # sample size
t &lt;- seq(100, 200, by = 10) # time intervals
B &lt;- 100 # number of bootstraps
BB &lt;- 100 # number of double-bootstraps
# m &lt;- 10 # number of iterations for MLE optimization
par_hat &lt;- c(
  3.41361e-03, 2.76268e+00, 2.60370e+00, 3.30802e+02, 5.48822e+00, 2.92945e+02, NA,
  9.43071e-03, 2.47598e+02, 1.80102e+00, 6.50845e-01, 7.18247e-01
)
mu_hat &lt;- c(292.94512, 292.94513, 319.72017, 294.16945, 298.87286, 292.94512)
pr_hat &lt;- c(0.60039, 0.42155, 0.53434, 0.30780, 0.56416, 0.61795)
haz_hat &lt;-   matrix(c(
  -5.67999, -5.67999, -5.67999, -5.67999, -5.67999, -5.67999,
  -5.67999, -5.67999, -5.67999, -5.67999, -5.67999, -6.09420,
  -5.99679, -5.91174, -5.83682, -5.77031, -5.71085, -5.65738,
  -5.60904, -5.56512, -5.52504, -5.48833, -6.09902, -5.97017,
  -5.85769, -5.75939, -5.67350, -5.59856, -5.53336, -5.47683,
  -5.42805, -5.38621, -5.35060, -6.17146, -6.09512, -6.02542,
  -5.96131, -5.90194, -5.84668, -5.79498, -5.74642, -5.70064,
  -5.65733, -5.61624, -5.92355, -5.80239, -5.70475, -5.62524,
  -5.55994, -5.50595, -5.46106, -5.42359, -5.39222, -5.36591,
  -5.34383, -5.79111, -5.67660, -5.58924, -5.52166, -5.46879,
  -5.42707, -5.39394, -5.36751, -5.34637, -5.32946, -5.31596
),length(t),6)
y &lt;- 304 # cut-off year for estimating probablity

# generate bootstrapped samples then fit renewal model
res &lt;- marp::poisson_bstrp(n, t, B, BB, par_hat, mu_hat, pr_hat, haz_hat, y)


</code></pre>

<hr>
<h2 id='poisson_rp'>A function to fit Poisson renewal model</h2><span id='topic+poisson_rp'></span>

<h3>Description</h3>

<p>A function to fit Poisson renewal model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>poisson_rp(data, t, y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="poisson_rp_+3A_data">data</code></td>
<td>
<p>input inter-event times</p>
</td></tr>
<tr><td><code id="poisson_rp_+3A_t">t</code></td>
<td>
<p>user-specified time intervals (used to compute hazard rate)</p>
</td></tr>
<tr><td><code id="poisson_rp_+3A_y">y</code></td>
<td>
<p>user-specified time point (used to compute time-to-event probability)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns list of estimates after fitting Poisson renewal model
</p>

<dl>
<dt>par1</dt><dd><p>Estimated parameter of the Poisson model</p>
</dd>
<dt>par2</dt><dd><p>N/A, only keep it as a place holder for output formatting purpose</p>
</dd>
<dt>logL</dt><dd><p>Negative log-likelihood</p>
</dd>
<dt>AIC</dt><dd><p>Akaike information criterion (AIC)</p>
</dd>
<dt>BIC</dt><dd><p>Bayesian information criterion (BIC)</p>
</dd>
<dt>mu_hat</dt><dd><p>Estimated mean</p>
</dd>
<dt>pr_hat</dt><dd><p>Estimated (logit) probabilities</p>
</dd>
<dt>haz_hat</dt><dd><p>Estimated (log) hazard rates</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>set.seed(42)
data &lt;-  rgamma(100,3,0.01)

# set some parameters
t = seq(100, 200, by=10)  # time intervals
y = 304  # cut-off year for estimating probablity

# fit Poisson renewal model
result &lt;- marp::poisson_rp(data, t, y)

# print result
cat("par1 = ", result$par1, "\n")
cat("par2 = ", result$par2, "\n")
cat("logL = ", result$logL, "\n")
cat("AIC = ", result$AIC, "\n")
cat("BIC = ", result$BIC, "\n")
cat("mu_hat = ", result$mu_hat, "\n")
cat("pr_hat = ", result$pr_hat, "\n")

</code></pre>

<hr>
<h2 id='student_confint'>A function to calculate Studentized bootstrap confidence interval</h2><span id='topic+student_confint'></span>

<h3>Description</h3>

<p>A function to calculate Studentized bootstrap confidence interval
</p>


<h3>Usage</h3>

<pre><code class='language-R'>student_confint(
  n,
  B,
  t,
  m,
  BB,
  par_hat,
  mu_hat,
  pr_hat,
  haz_hat,
  weights,
  alpha,
  y,
  best.model,
  which.model = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="student_confint_+3A_n">n</code></td>
<td>
<p>number of inter-event times</p>
</td></tr>
<tr><td><code id="student_confint_+3A_b">B</code></td>
<td>
<p>number of bootstrap samples</p>
</td></tr>
<tr><td><code id="student_confint_+3A_t">t</code></td>
<td>
<p>user-specified time intervals (used to compute hazard rate)</p>
</td></tr>
<tr><td><code id="student_confint_+3A_m">m</code></td>
<td>
<p>the number of iterations in nlm</p>
</td></tr>
<tr><td><code id="student_confint_+3A_bb">BB</code></td>
<td>
<p>number of double-bootstrap samples</p>
</td></tr>
<tr><td><code id="student_confint_+3A_par_hat">par_hat</code></td>
<td>
<p>estimated parameters</p>
</td></tr>
<tr><td><code id="student_confint_+3A_mu_hat">mu_hat</code></td>
<td>
<p>estimated mean inter-event times</p>
</td></tr>
<tr><td><code id="student_confint_+3A_pr_hat">pr_hat</code></td>
<td>
<p>estimated time to event probability</p>
</td></tr>
<tr><td><code id="student_confint_+3A_haz_hat">haz_hat</code></td>
<td>
<p>estimated hazard rates</p>
</td></tr>
<tr><td><code id="student_confint_+3A_weights">weights</code></td>
<td>
<p>model weights</p>
</td></tr>
<tr><td><code id="student_confint_+3A_alpha">alpha</code></td>
<td>
<p>significance level</p>
</td></tr>
<tr><td><code id="student_confint_+3A_y">y</code></td>
<td>
<p>user-specified time point (used to compute time-to-event probability)</p>
</td></tr>
<tr><td><code id="student_confint_+3A_best.model">best.model</code></td>
<td>
<p>best model based on information criterion (i.e. AIC)</p>
</td></tr>
<tr><td><code id="student_confint_+3A_which.model">which.model</code></td>
<td>
<p>user-specified generating (or true underlying if known) model</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns list of Studentized bootstrap intervals (including the model-averaged approach).
</p>

<dl>
<dt>mu_lower_gen</dt><dd><p>Lower limit of the studentized bootstrap confidence interval of the estimated mean based on the generating model</p>
</dd>
<dt>mu_upper_gen</dt><dd><p>Upper limit of the studentized bootstrap confidence interval of the estimated mean based on the generating model</p>
</dd>
<dt>mu_lower_best</dt><dd><p>Lower limit of the studentized bootstrap confidence interval of the estimated mean based on the best model</p>
</dd>
<dt>mu_upper_best</dt><dd><p>Upper limit of the studentized bootstrap confidence interval of the estimated mean based on the best model</p>
</dd>
<dt>pr_lower_gen</dt><dd><p>Lower limit of the studentized bootstrap confidence interval of the estimated probabilities  based on the generating model</p>
</dd>
<dt>pr_upper_gen</dt><dd><p>Upper limit of the studentized bootstrap confidence interval of the estimated probabilities  based on the generating model</p>
</dd>
<dt>pr_lower_best</dt><dd><p>Lower limit of the studentized bootstrap confidence interval of the estimated probabilities  based on the best model</p>
</dd>
<dt>pr_upper_best</dt><dd><p>Upper limit of the studentized bootstrap confidence interval of the estimated probabilities  based on the best model</p>
</dd>
<dt>haz_lower_gen</dt><dd><p>Lower limit of the studentized bootstrap confidence interval of the estimated hazard rates  based on the generating model</p>
</dd>
<dt>haz_upper_gen</dt><dd><p>Upper limit of the studentized bootstrap confidence interval of the estimated hazard rates  based on the generating model</p>
</dd>
<dt>haz_lower_best</dt><dd><p>Lower limit of the studentized bootstrap confidence interval of the estimated hazard rates  based on the best model</p>
</dd>
<dt>haz_upper_best</dt><dd><p>Upper limit of the studentized bootstrap confidence interval of the estimated hazard rates  based on the best model</p>
</dd>
<dt>mu_lower_ma</dt><dd><p>Lower limit of model-averaged studentized bootstrap confidence interval of the estimated mean </p>
</dd>
<dt>mu_upper_ma</dt><dd><p>Upper limit of model-averaged studentized bootstrap confidence interval of the estimated mean </p>
</dd>
<dt>pr_lower_ma</dt><dd><p>Lower limit of model-averaged studentized bootstrap confidence interval of the estimated probabilities  </p>
</dd>
<dt>pr_upper_ma</dt><dd><p>Upper limit of model-averaged studentized bootstrap confidence interval of the estimated probabilities  </p>
</dd>
<dt>haz_lower_ma</dt><dd><p>Lower limit of model-averaged studentized bootstrap confidence interval of the estimated hazard rates  </p>
</dd>
<dt>haz_upper_ma</dt><dd><p>Upper limit of model-averaged studentized bootstrap confidence interval of the estimated hazard rates  </p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>
# generate random data
set.seed(42)
data &lt;- rgamma(30, 3, 0.01)

# set some parameters
n &lt;- 30 # sample size
m &lt;- 10 # number of iterations for MLE optimization
t &lt;- seq(100,200,by=10) # time intervals
y &lt;- 304 # cut-off year for estimating probablity
B &lt;- 100 # number of bootstraps
BB &lt;- 100 # number of double bootstraps
par_hat &lt;- c(
  3.41361e-03, 2.76268e+00, 2.60370e+00, 3.30802e+02, 5.48822e+00, 2.92945e+02, NA,
  9.43071e-03, 2.47598e+02, 1.80102e+00, 6.50845e-01, 7.18247e-01)
mu_hat &lt;- c(292.94512, 292.94513, 319.72017, 294.16945, 298.87286, 292.94512)
pr_hat &lt;- c(0.60039, 0.42155, 0.53434, 0.30780, 0.56416, 0.61795)
haz_hat &lt;-   matrix(c(
  -5.67999, -5.67999, -5.67999, -5.67999, -5.67999, -5.67999,
  -5.67999, -5.67999, -5.67999, -5.67999, -5.67999, -6.09420,
  -5.99679, -5.91174, -5.83682, -5.77031, -5.71085, -5.65738,
  -5.60904, -5.56512, -5.52504, -5.48833, -6.09902, -5.97017,
  -5.85769, -5.75939, -5.67350, -5.59856, -5.53336, -5.47683,
  -5.42805, -5.38621, -5.35060, -6.17146, -6.09512, -6.02542,
  -5.96131, -5.90194, -5.84668, -5.79498, -5.74642, -5.70064,
  -5.65733, -5.61624, -5.92355, -5.80239, -5.70475, -5.62524,
  -5.55994, -5.50595, -5.46106, -5.42359, -5.39222, -5.36591,
  -5.34383, -5.79111, -5.67660, -5.58924, -5.52166, -5.46879,
  -5.42707, -5.39394, -5.36751, -5.34637, -5.32946, -5.31596
),length(t),6)
weights &lt;- c(0.00000, 0.21000, 0.02000, 0.55000, 0.00000, 0.22000) # model weights
alpha &lt;- 0.05 # confidence level
y &lt;- 304 # cut-off year for estimating probablity
best.model &lt;- 2
which.model &lt;- 2 # specify the generating model#'

# construct Studentized bootstrap confidence interval
marp::student_confint(
  n,B,t,m,BB,par_hat,mu_hat,pr_hat,haz_hat,weights,alpha,y,best.model,which.model
)


</code></pre>

<hr>
<h2 id='upperT'>An utility function to calculate lower limit of T statistic</h2><span id='topic+upperT'></span>

<h3>Description</h3>

<p>An utility function to calculate lower limit of T statistic
</p>


<h3>Usage</h3>

<pre><code class='language-R'>upperT(up, hat, sigmasq, Tstar, weights, B, alpha)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="upperT_+3A_up">up</code></td>
<td>
<p>upper limit</p>
</td></tr>
<tr><td><code id="upperT_+3A_hat">hat</code></td>
<td>
<p>estimates</p>
</td></tr>
<tr><td><code id="upperT_+3A_sigmasq">sigmasq</code></td>
<td>
<p>variance</p>
</td></tr>
<tr><td><code id="upperT_+3A_tstar">Tstar</code></td>
<td>
<p>T statistics estimated from bootstrap samples</p>
</td></tr>
<tr><td><code id="upperT_+3A_weights">weights</code></td>
<td>
<p>model weights</p>
</td></tr>
<tr><td><code id="upperT_+3A_b">B</code></td>
<td>
<p>number of bootstraps</p>
</td></tr>
<tr><td><code id="upperT_+3A_alpha">alpha</code></td>
<td>
<p>confidence level</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns lower limit of T statistic
</p>


<h3>Examples</h3>

<pre><code class='language-R'># set some parameters
up &lt;- 100 # upper bound
hat &lt;- rep(150, 6) # estimates obtained from each model
sigmasq &lt;- 10 # variance
Tstar &lt;- matrix(rep(100,600),6,100) # T statistics estimated from bootstrap samples
weights &lt;- rep(1/6, 6) # model weights
B &lt;- 100 # number of bootstrapped samples
alpha &lt;- 0.05 # confidence level

# calculate the upper limit of T statistics
res &lt;-  marp::upperT(up, hat, sigmasq, Tstar, weights, B, alpha)

# print result
cat("res = ", res, "\n")

</code></pre>

<hr>
<h2 id='weibull_bstrp'>A function to generate (double) bootstrap samples and fit Weibull renewal model</h2><span id='topic+weibull_bstrp'></span>

<h3>Description</h3>

<p>A function to generate (double) bootstrap samples and fit Weibull renewal model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>weibull_bstrp(n, t, B, BB, m, par_hat, mu_hat, pr_hat, haz_hat, y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="weibull_bstrp_+3A_n">n</code></td>
<td>
<p>number of inter-event times</p>
</td></tr>
<tr><td><code id="weibull_bstrp_+3A_t">t</code></td>
<td>
<p>user-specified time intervals (used to compute hazard rate)</p>
</td></tr>
<tr><td><code id="weibull_bstrp_+3A_b">B</code></td>
<td>
<p>number of bootstrap samples</p>
</td></tr>
<tr><td><code id="weibull_bstrp_+3A_bb">BB</code></td>
<td>
<p>number of double-bootstrap samples</p>
</td></tr>
<tr><td><code id="weibull_bstrp_+3A_m">m</code></td>
<td>
<p>the number of iterations in nlm</p>
</td></tr>
<tr><td><code id="weibull_bstrp_+3A_par_hat">par_hat</code></td>
<td>
<p>estimated parameters</p>
</td></tr>
<tr><td><code id="weibull_bstrp_+3A_mu_hat">mu_hat</code></td>
<td>
<p>estimated mean inter-event times</p>
</td></tr>
<tr><td><code id="weibull_bstrp_+3A_pr_hat">pr_hat</code></td>
<td>
<p>estimated time to event probability</p>
</td></tr>
<tr><td><code id="weibull_bstrp_+3A_haz_hat">haz_hat</code></td>
<td>
<p>estimated hazard rates</p>
</td></tr>
<tr><td><code id="weibull_bstrp_+3A_y">y</code></td>
<td>
<p>user-specified time point (used to compute time-to-event probability)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns list of estimates after fitting Weibull renewal model on (double) bootstrap samples
</p>

<dl>
<dt>mu_star</dt><dd><p>Estimated mean from bootstrapped samples </p>
</dd>
<dt>pr_star</dt><dd><p>Estimated probability from bootstrapped samples </p>
</dd>
<dt>haz_star</dt><dd><p>Estimated hazard rates from bootstrapped samples</p>
</dd>
<dt>mu_var_hat</dt><dd><p>Variance of estimated mean</p>
</dd>
<dt>pr_var_hat</dt><dd><p>Variance of estimated probability</p>
</dd>
<dt>haz_var_hat</dt><dd><p>Variance of estimated hazard rates</p>
</dd>
<dt>mu_var_double</dt><dd><p>Variance of estimated mean of bootstrapped samples (via double-bootstrapping)</p>
</dd>
<dt>pr_var_double</dt><dd><p>Variance of estimated probability of bootstrapped samples (via double-bootstrapping)</p>
</dd>
<dt>haz_var_double</dt><dd><p>Variance of estimated hazard rates of bootstrapped samples (via double-bootstrapping)</p>
</dd>
<dt>mu_Tstar</dt><dd><p>Pivot quantity of the estimated mean</p>
</dd>
<dt>pr_Tstar</dt><dd><p>Pivot quantity of the estimated probability </p>
</dd>
<dt>haz_Tstar</dt><dd><p>Pivot quantity of the estimated hazard rates </p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>
# set some parameters
n &lt;- 30 # sample size
t &lt;- seq(100, 200, by = 10) # time intervals
B &lt;- 100 # number of bootstraps
BB &lt;- 100 # number of double-bootstraps
m &lt;- 10 # number of iterations for MLE optimization
par_hat &lt;- c(
  3.4136086430979953e-03, 2.7626793657057762e+00, 2.6037039674870583e+00, 3.3080162440951688e+02,
  5.4882183788378658e+00, 2.9294512422957860e+02, NA, 9.4307059277139432e-03,
  2.4759796859031687e+02, 1.8010183507666513e+00, 6.5084541680686814e-01, 7.1824719073918109e-01
)
mu_hat &lt;- c(
  292.94512187913182, 292.94512912200048, 319.72017228620746, 294.16945213908519,
  298.87285747700128, 292.94512422957860
)
pr_hat &lt;- c(
  0.60038574701819891, 0.42154974433034809, 0.53433568234281148, 0.30779792692414687,
  0.56416103510057725, 0.61794524610544410
)
haz_hat &lt;-   matrix(c(
  -5.6799852941338829, -5.6799852941338829, -5.6799852941338829, -5.6799852941338829,
  -5.6799852941338829, -5.6799852941338829, -5.6799852941338829, -5.6799852941338829,
  -5.6799852941338829, -5.6799852941338829, -5.6799852941338829, -6.0942031084732298,
  -5.9967873794574516, -5.9117418563554684, -5.8368230853439300, -5.7703089176306639,
  -5.7108525626839901, -5.6573839062669986, -5.6090408956082456, -5.5651206740587922,
  -5.5250440506799734, -5.4883291920475745, -6.0990192429336094, -5.9701664705134210,
  -5.8576899644670348, -5.7593884711134971, -5.6734972529860741, -5.5985621349393231,
  -5.5333565788683616, -5.4768259914915305, -5.4280496904694857, -5.3862145095364315,
  -5.3505961502861927, -6.1714638710963881, -6.0951186680582552, -6.0254209583640863,
  -5.9613052806725335, -5.9019434350392981, -5.8466788789061646, -5.7949823391436279,
  -5.7464209045603756, -5.7006359661738628, -5.6573271297614109, -5.6162402596857071,
  -5.9235521978533958, -5.8023896004395645, -5.7047473880293342, -5.6252373537796752,
  -5.5599409055534252, -5.5059486025117375, -5.4610610586440487, -5.4235891601883868,
  -5.3922173604047572, -5.3659081375131672, -5.3438339586221275, -5.7911126719889303,
  -5.6765973314326752, -5.5892417143301261, -5.5216608261560411, -5.4687921205249133,
  -5.4270729562323066, -5.3939387902533049, -5.3675067327627373, -5.3463701567645607,
  -5.3294619641245422, -5.3159614865560094
),length(t),6)
y &lt;- 304 # cut-off year for estimating probablity

# generate bootstrapped samples then fit renewal model
res &lt;- marp::weibull_bstrp(n, t, B, BB, m, par_hat, mu_hat, pr_hat, haz_hat, y)


</code></pre>

<hr>
<h2 id='weibull_logl'>A function to calculate the log-likelihood of Weibull model</h2><span id='topic+weibull_logl'></span>

<h3>Description</h3>

<p>A function to calculate the log-likelihood of Weibull model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>weibull_logl(param, x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="weibull_logl_+3A_param">param</code></td>
<td>
<p>parameters of Weibull model</p>
</td></tr>
<tr><td><code id="weibull_logl_+3A_x">x</code></td>
<td>
<p>input data for Weibull model</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns the value of negative log-likelihood of the Weibull model
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(42)
data &lt;-  rgamma(30,3,0.01)

# set some parameters
par_hat &lt;- c(330.801103808081, 1.80101338777944) # estimated parameters
param &lt;- log(par_hat) # input parameters for logl function

# calculate log-likelihood
result &lt;- marp::weibull_logl(param, data)

# print result
cat("-logl = ", result, "\n")


</code></pre>

<hr>
<h2 id='weibull_rp'>A function to fit Weibull renewal model #' @import weibull_logl</h2><span id='topic+weibull_rp'></span>

<h3>Description</h3>

<p>A function to fit Weibull renewal model #' @import weibull_logl
</p>


<h3>Usage</h3>

<pre><code class='language-R'>weibull_rp(data, t, m, y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="weibull_rp_+3A_data">data</code></td>
<td>
<p>input inter-event times</p>
</td></tr>
<tr><td><code id="weibull_rp_+3A_t">t</code></td>
<td>
<p>user-specified time intervals (used to compute hazard rate)</p>
</td></tr>
<tr><td><code id="weibull_rp_+3A_m">m</code></td>
<td>
<p>the number of iterations in nlm</p>
</td></tr>
<tr><td><code id="weibull_rp_+3A_y">y</code></td>
<td>
<p>user-specified time point (used to compute time-to-event probability)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns list of estimates after fitting Weibull renewal model
</p>

<dl>
<dt>par1</dt><dd><p>Estimated scale parameter of the Weibull model</p>
</dd>
<dt>par2</dt><dd><p>Estimated shape parameter of the Weibull model</p>
</dd>
<dt>logL</dt><dd><p>Negative log-likelihood</p>
</dd>
<dt>AIC</dt><dd><p>Akaike information criterion (AIC)</p>
</dd>
<dt>BIC</dt><dd><p>Bayesian information criterion (BIC)</p>
</dd>
<dt>mu_hat</dt><dd><p>Estimated mean</p>
</dd>
<dt>pr_hat</dt><dd><p>Estimated (logit) probabilities</p>
</dd>
<dt>haz_hat</dt><dd><p>Estimated (log) hazard rates</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>set.seed(42)
data &lt;-  rgamma(100,3,0.01)

# set some parameters
m = 10  # number of iterations for MLE optimization
t = seq(100, 200, by=10)  # time intervals
y = 304  # cut-off year for estimating probablity

# fit Weibull renewal model
result &lt;- marp::weibull_rp(data, t, m, y)

# print result
cat("par1 = ", result$par1, "\n")
cat("par2 = ", result$par2, "\n")
cat("logL = ", result$logL, "\n")
cat("AIC = ", result$AIC, "\n")
cat("BIC = ", result$BIC, "\n")
cat("mu_hat = ", result$mu_hat, "\n")
cat("pr_hat = ", result$pr_hat, "\n")

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
