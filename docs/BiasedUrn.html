<!DOCTYPE html><html><head><title>Help for package BiasedUrn</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {BiasedUrn}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#BiasedUrn-package'><p>Biased Urn Model Distributions</p></a></li>
<li><a href='#BiasedUrn-Multivariate'><p>Biased urn models: Multivariate distributions</p></a></li>
<li><a href='#BiasedUrn-Univariate'><p>Biased urn models: Univariate distributions</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Biased Urn Model Distributions</td>
</tr>
<tr>
<td>Version:</td>
<td>2.0.11</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-08-19</td>
</tr>
<tr>
<td>Author:</td>
<td>Agner Fog</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Agner Fog &lt;agner@agner.org&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Statistical models of biased sampling in the form of 
  univariate and multivariate noncentral hypergeometric distributions, 
  including Wallenius' noncentral hypergeometric distribution and
  Fisher's noncentral hypergeometric distribution. 
  See vignette("UrnTheory") for explanation of these distributions.
  Literature: 
  Fog, A. (2008a). Calculation Methods for Wallenius' Noncentral Hypergeometric Distribution, Communications in Statistics, Simulation and Computation, 37(2) &lt;<a href="https://doi.org/10.1080%2F03610910701790269">doi:10.1080/03610910701790269</a>&gt;.
  Fog, A. (2008b). Sampling methods for Wallenius’ and Fisher’s noncentral hypergeometric distributions, Communications in Statistics—Simulation and Computation, 37(2)
  &lt;<a href="https://doi.org/10.1080%2F03610910701790236">doi:10.1080/03610910701790236</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://www.agner.org/random/">https://www.agner.org/random/</a> <a href="https://www.r-project.org/">https://www.r-project.org/</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-19 07:33:28 UTC; A</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-19 10:22:32 UTC</td>
</tr>
</table>
<hr>
<h2 id='BiasedUrn-package'>Biased Urn Model Distributions</h2><span id='topic+BiasedUrn'></span><span id='topic+BiasedUrn-package'></span>

<h3>Description</h3>

<p>Statistical models of biased sampling in the form of univariate and
multivariate noncentral hypergeometric distributions, 
including Wallenius' noncentral hypergeometric distribution and
Fisher's noncentral hypergeometric distribution 
(also called extended hypergeometric distribution).
</p>
<p>These are distributions that you can get when taking colored balls
from an urn without replacement, with bias.  
The univariate distributions are used when there are two colors of balls.  
The multivariate distributions are used when there are more 
than two colors of balls.
</p>
<p>The (central) univariate and multivariate hypergeometric distribution
can be obtained by setting <code>odds</code> = 1.
</p>
<p>Please see <code>vignette("UrnTheory")</code>
for a definition of these distributions and how
to decide which distribution to use in a specific case.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> BiasedUrn</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 2.0.11</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2023-08-19</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-3</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p><b>Univariate functions in this package</b>
</p>

<table>
<tr>
 <td style="text-align: left;">
  </td><td style="text-align: center;"> Wallenius' noncentral hypergeometric </td><td style="text-align: center;"> Fisher's noncentral hypergeometric </td>
</tr>
<tr>
 <td style="text-align: left;">
Probability mass function </td><td style="text-align: center;"> dWNCHypergeo </td><td style="text-align: center;"> dFNCHypergeo </td>
</tr>
<tr>
 <td style="text-align: left;">
Cumulative distribution function </td><td style="text-align: center;"> pWNCHypergeo </td><td style="text-align: center;"> pFNCHypergeo </td>
</tr>
<tr>
 <td style="text-align: left;">
Quantile function </td><td style="text-align: center;"> qWNCHypergeo </td><td style="text-align: center;"> qFNCHypergeo </td>
</tr>
<tr>
 <td style="text-align: left;">
Random variate generation function </td><td style="text-align: center;"> rWNCHypergeo </td><td style="text-align: center;"> rFNCHypergeo </td>
</tr>
<tr>
 <td style="text-align: left;">
Calculate mean </td><td style="text-align: center;"> meanWNCHypergeo </td><td style="text-align: center;"> meanFNCHypergeo </td>
</tr>
<tr>
 <td style="text-align: left;">
Calculate variance </td><td style="text-align: center;"> varWNCHypergeo </td><td style="text-align: center;"> varFNCHypergeo </td>
</tr>
<tr>
 <td style="text-align: left;">
Calculate mode </td><td style="text-align: center;"> modeWNCHypergeo </td><td style="text-align: center;"> modeFNCHypergeo </td>
</tr>
<tr>
 <td style="text-align: left;">  
Estimate odds from mean </td><td style="text-align: center;"> oddsWNCHypergeo </td><td style="text-align: center;"> oddsFNCHypergeo </td>
</tr>
<tr>
 <td style="text-align: left;">
Estimate number from mean and odds </td><td style="text-align: center;"> numWNCHypergeo </td><td style="text-align: center;"> numFNCHypergeo </td>
</tr>
<tr>
 <td style="text-align: left;">
Minimum x </td><td style="text-align: center;"> minHypergeo </td><td style="text-align: center;"> minHypergeo </td>
</tr>
<tr>
 <td style="text-align: left;">
Maximum x </td><td style="text-align: center;"> maxHypergeo </td><td style="text-align: center;"> maxHypergeo
</td>
</tr>

</table>

<p><b>Multivariate functions in this package</b>
</p>

<table>
<tr>
 <td style="text-align: left;">
  </td><td style="text-align: center;"> Wallenius' noncentral hypergeometric </td><td style="text-align: center;"> Fisher's noncentral hypergeometric </td>
</tr>
<tr>
 <td style="text-align: left;">
Probability mass function </td><td style="text-align: center;"> dMWNCHypergeo </td><td style="text-align: center;"> dMFNCHypergeo </td>
</tr>
<tr>
 <td style="text-align: left;">
Random variate generation function </td><td style="text-align: center;"> rMWNCHypergeo </td><td style="text-align: center;"> rMFNCHypergeo </td>
</tr>
<tr>
 <td style="text-align: left;">
Calculate mean </td><td style="text-align: center;"> meanMWNCHypergeo </td><td style="text-align: center;"> meanMFNCHypergeo </td>
</tr>
<tr>
 <td style="text-align: left;">
Calculate variance </td><td style="text-align: center;"> varMWNCHypergeo </td><td style="text-align: center;"> varMFNCHypergeo </td>
</tr>
<tr>
 <td style="text-align: left;">
Calculate mean and variance </td><td style="text-align: center;"> momentsMWNCHypergeo </td><td style="text-align: center;"> momentsMFNCHypergeo </td>
</tr>
<tr>
 <td style="text-align: left;">
Estimate odds from mean </td><td style="text-align: center;"> oddsMWNCHypergeo </td><td style="text-align: center;"> oddsMFNCHypergeo </td>
</tr>
<tr>
 <td style="text-align: left;">
Estimage number from mean and odds </td><td style="text-align: center;"> numMWNCHypergeo </td><td style="text-align: center;"> numMFNCHypergeo </td>
</tr>
<tr>
 <td style="text-align: left;">
Minimum x </td><td style="text-align: center;"> minMHypergeo </td><td style="text-align: center;"> minMHypergeo </td>
</tr>
<tr>
 <td style="text-align: left;">
Maximum x </td><td style="text-align: center;"> maxMHypergeo </td><td style="text-align: center;"> maxMHypergeo
</td>
</tr>

</table>



<h3>Note</h3>

<p>The implementation cannot run safely in multiple threads simultaneously
</p>


<h3>Author(s)</h3>

<p>Agner Fog
</p>
<p>Maintainer: Agner Fog &lt;agner@agner.org&gt;
</p>


<h3>References</h3>

<p><a href="https://www.agner.org/random/">https://www.agner.org/random/</a>
</p>
<p>Fog, A. 2008a. Calculation methods for Wallenius’ noncentral hypergeometric distribution.  <em>Communications in Statistics—Simulation and Computation</em> <b>37</b>, 2 <a href="https://doi.org/10.1080/03610910701790269">doi:10.1080/03610910701790269</a>
</p>
<p>Fog, A. 2008b. Sampling methods for Wallenius’ and Fisher’s noncentral hypergeometric distributions.  <em>Communications in Statistics—Simulation and Computation</em> <b>37</b>, 2 <a href="https://doi.org/10.1080/03610910701790236">doi:10.1080/03610910701790236</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+BiasedUrn-Univariate">BiasedUrn-Univariate</a></code>.
<br />
<code><a href="#topic+BiasedUrn-Multivariate">BiasedUrn-Multivariate</a></code>.
<br />
<code>vignette("UrnTheory")</code>
<br />
<code>demo(CompareHypergeo)</code>
<br />
<code>demo(ApproxHypergeo)</code>
<br />
<code>demo(OddsPrecision)</code>
<br />
<code>demo(SampleWallenius)</code>
<br />
<code><a href="stats.html#topic+dhyper">dhyper</a></code>
<br />
<code><a href="stats.html#topic+fisher.test">fisher.test</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dWNCHypergeo(12, 25, 32, 20, 2.5)
</code></pre>

<hr>
<h2 id='BiasedUrn-Multivariate'>Biased urn models: Multivariate distributions</h2><span id='topic+BiasedUrn-Multivariate'></span><span id='topic+dMWNCHypergeo'></span><span id='topic+dMFNCHypergeo'></span><span id='topic+rMWNCHypergeo'></span><span id='topic+rMFNCHypergeo'></span><span id='topic+meanMWNCHypergeo'></span><span id='topic+meanMFNCHypergeo'></span><span id='topic+varMWNCHypergeo'></span><span id='topic+varMFNCHypergeo'></span><span id='topic+momentsMWNCHypergeo'></span><span id='topic+momentsMFNCHypergeo'></span><span id='topic+oddsMWNCHypergeo'></span><span id='topic+oddsMFNCHypergeo'></span><span id='topic+numMWNCHypergeo'></span><span id='topic+numMFNCHypergeo'></span><span id='topic+minMHypergeo'></span><span id='topic+maxMHypergeo'></span>

<h3>Description</h3>

<p>Statistical models of biased sampling in the form of 
multivariate noncentral hypergeometric distributions, 
including Wallenius' noncentral hypergeometric distribution and
Fisher's noncentral hypergeometric distribution 
(also called extended hypergeometric distribution).
</p>
<p>These are distributions that you can get when taking colored balls
from an urn without replacement, with bias.  
The univariate distributions are used when there are two colors of balls.
The multivariate distributions are used when there are more 
than two colors of balls.
</p>
<p>Please see <code>vignette("UrnTheory")</code>
for a definition of these distributions and how
to decide which distribution to use in a specific case.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dMWNCHypergeo(x, m, n, odds, precision = 1E-7)
dMFNCHypergeo(x, m, n, odds, precision = 1E-7)
rMWNCHypergeo(nran, m, n, odds, precision = 1E-7)
rMFNCHypergeo(nran, m, n, odds, precision = 1E-7)
meanMWNCHypergeo(m, n, odds, precision = 0.1)
meanMFNCHypergeo(m, n, odds, precision = 0.1)
varMWNCHypergeo(m, n, odds, precision = 0.1)
varMFNCHypergeo(m, n, odds, precision = 0.1)
momentsMWNCHypergeo(m, n, odds, precision = 0.1)
momentsMFNCHypergeo(m, n, odds, precision = 0.1)
oddsMWNCHypergeo(mu, m, n, precision = 0.1)
oddsMFNCHypergeo(mu, m, n, precision = 0.1)
numMWNCHypergeo(mu, n, N, odds, precision = 0.1)
numMFNCHypergeo(mu, n, N, odds, precision = 0.1)
minMHypergeo(m, n)
maxMHypergeo(m, n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BiasedUrn-Multivariate_+3A_x">x</code></td>
<td>
<p>Number of balls of each color sampled.  
Vector with length = number of colors, or matrix with nrows = number of colors.</p>
</td></tr>
<tr><td><code id="BiasedUrn-Multivariate_+3A_m">m</code></td>
<td>
<p>Initial number of balls of each color in the urn.  
Length of vector = number of colors.</p>
</td></tr>
<tr><td><code id="BiasedUrn-Multivariate_+3A_n">n</code></td>
<td>
<p>Total number of balls sampled.  Scalar.</p>
</td></tr>
<tr><td><code id="BiasedUrn-Multivariate_+3A_n">N</code></td>
<td>
<p>Total number of balls in urn before sampling.  Scalar.</p>
</td></tr>
<tr><td><code id="BiasedUrn-Multivariate_+3A_odds">odds</code></td>
<td>
<p>Odds or weight for each color, arbitrarily scaled.  Length of vector = number of colors.  
Gives the (central) multivariate hypergeometric distribution if all odds are equal.</p>
</td></tr>
<tr><td><code id="BiasedUrn-Multivariate_+3A_nran">nran</code></td>
<td>
<p>Number of random variates to generate.  Scalar.</p>
</td></tr>
<tr><td><code id="BiasedUrn-Multivariate_+3A_mu">mu</code></td>
<td>
<p>Mean x for each color. Length of vector = number of colors.</p>
</td></tr>
<tr><td><code id="BiasedUrn-Multivariate_+3A_precision">precision</code></td>
<td>
<p>Desired precision of calculation.  Scalar.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><b>Allowed parameter values</b> <br />
<code>x</code>, <code>m</code>, <code>odds</code> and <code>mu</code> are all vectors with one 
element for each color.  These vectors must have the same length.  
<code>x</code> can also be a matrix with one column for each observation.  
The number of rows in this matrix must be equal to the number of colors.  
The maximum number of colors is currently set to 32.
</p>
<p>All parameters must be non-negative.  
<code>n</code> cannot exceed <code>N = sum(m)</code>.
The odds may be arbitrarily scaled.  
The code has been tested with odds ratios in the range 
<code class="reqn">10^{-9} \ldots 10^9</code> and zero.  
The code may work with odds ratios
outside this range, but errors or NAN can occur for extreme values of odds.  
A ball with odds = 0 is equivalent to no ball.  
<code>mu</code> must be within the possible range of <code>x</code>.
</p>
<p><b>Calculation time</b> <br />
The calculation time depends on the specified precision and the number of colors.  
The calculation time can be high for rMWNCHypergeo and rMFNCHypergeo when nran
is high.  
The calculation time can be extremely high for dMFNCHypergeo when n is high and
the number of colors is high.  
The calculation time can be extremely high for the mean... var... and moments...
functions when <code>precision</code> &lt; 0.1 and n is high and the
number of colors is high.
</p>


<h3>Value</h3>

<p><code>dMWNCHypergeo</code> and <code>dMFNCHypergeo</code> return the probability mass 
function for the multivariate Wallenius' and Fisher's noncentral hypergeometric 
distribution, respectively.  
A single value is returned if <code>x</code> is a vector with length = number of colors.  
Multiple values are returned if <code>x</code> is a matrix with one column for each 
observation.  The number of rows must be equal to the number of colors.
<br />
</p>
<p><code>rMWNCHypergeo</code> and <code>rMFNCHypergeo</code> return random vectors with
the multivariate Wallenius' and Fisher's noncentral hypergeometric 
distribution, respectively.  
A vector is returned when <code>nran = 1</code>.  A matrix with one column for each
observation is returned when <code>nran &gt; 1</code>.
<br />
</p>
<p><code>meanMWNCHypergeo</code> and <code>meanMFNCHypergeo</code> return the mean
of the multivariate Wallenius' and Fisher's noncentral hypergeometric 
distribution, respectively.  A simple and fast approximation is used when 
<code>precision</code> &gt;= 0.1.  A full calculation of all 
possible x combinations is used when <code>precision</code> &lt; 0.1.  
This can take extremely long time when the number of colors is high.
<br />
</p>
<p><code>varMWNCHypergeo</code> and <code>varMFNCHypergeo</code> return the variance
of the multivariate Wallenius' and Fisher's noncentral hypergeometric 
distribution, respectively.  A simple and fast approximation is used when 
<code>precision</code> &gt;= 0.1.  A full calculation of all 
possible x combinations is used when <code>precision</code> &lt; 0.1.  
This can take extremely long time when the number of colors is high.
<br />
</p>
<p><code>momentsMWNCHypergeo</code> and <code>momentsMFNCHypergeo</code> return a data
frame with the mean and variance of the multivariate Wallenius' and 
Fisher's noncentral hypergeometric distribution, respectively.  
Calculating the mean and variance in the same operation saves time when 
<code>precision</code> &lt; 0.1.
<br />
</p>
<p><code>oddsMWNCHypergeo</code> and <code>oddsMFNCHypergeo</code> estimate the odds
from an observed mean for the multivariate Wallenius' and 
Fisher's noncentral hypergeometric distribution, respectively.  
A vector of odds is returned if <code>mu</code> is a vector.  
A matrix is returned if <code>mu</code> is a matrix with one row for each color.  
A simple and fast approximation is used regardless of the specified precision.  
Exact calculation is not supported.  
See <code>demo(OddsPrecision)</code>.
<br />
</p>
<p><code>numMWNCHypergeo</code> and <code>numMFNCHypergeo</code> estimate the 
number of balls of each color in the urn before sampling from
experimental mean and known odds ratios for
Wallenius' and Fisher's noncentral hypergeometric distributions.  
The returned <code>m</code> values are not integers.  
A vector of <code>m</code> is returned if <code>mu</code> is a vector.  
A matrix of <code>m</code> is returned if <code>mu</code> is a matrix with one row for each color.  
A simple and fast approximation is used regardless of the specified precision.  
Exact calculation is not supported.  
The precision of calculation is indicated by <code>demo(OddsPrecision)</code>.  
<br />
</p>
<p><code>minMHypergeo</code> and <code>maxMHypergeo</code> calculate the 
minimum and maximum value of <code>x</code> for the multivariate distributions.  
The values are valid for the multivariate Wallenius' and Fisher's noncentral 
hypergeometric distributions as well as for the multivariate (central) 
hypergeometric distribution.
</p>


<h3>References</h3>

<p><a href="https://www.agner.org/random/">https://www.agner.org/random/</a>
</p>
<p>Fog, A. 2008a. Calculation methods for Wallenius’ noncentral hypergeometric distribution.  <em>Communications in Statistics—Simulation and Computation</em> <b>37</b>, 2 <a href="https://doi.org/10.1080/03610910701790269">doi:10.1080/03610910701790269</a>
</p>
<p>Fog, A. 2008b. Sampling methods for Wallenius’ and Fisher’s noncentral hypergeometric distributions.  <em>Communications in Statistics—Simulation and Computation</em> <b>37</b>, 2 <a href="https://doi.org/10.1080/03610910701790236">doi:10.1080/03610910701790236</a>
</p>


<h3>See Also</h3>

<p><code>vignette("UrnTheory")</code>
<br />
<code><a href="#topic+BiasedUrn-Univariate">BiasedUrn-Univariate</a></code>.
<br />
<code><a href="#topic+BiasedUrn">BiasedUrn</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># get probability
dMWNCHypergeo(c(8,10,6), c(20,30,20), 24, c(1.,2.5,1.8))
</code></pre>

<hr>
<h2 id='BiasedUrn-Univariate'>Biased urn models: Univariate distributions</h2><span id='topic+BiasedUrn-Univariate'></span><span id='topic+dWNCHypergeo'></span><span id='topic+dFNCHypergeo'></span><span id='topic+pWNCHypergeo'></span><span id='topic+pFNCHypergeo'></span><span id='topic+qWNCHypergeo'></span><span id='topic+qFNCHypergeo'></span><span id='topic+rWNCHypergeo'></span><span id='topic+rFNCHypergeo'></span><span id='topic+meanWNCHypergeo'></span><span id='topic+meanFNCHypergeo'></span><span id='topic+varWNCHypergeo'></span><span id='topic+varFNCHypergeo'></span><span id='topic+modeWNCHypergeo'></span><span id='topic+modeFNCHypergeo'></span><span id='topic+oddsWNCHypergeo'></span><span id='topic+oddsFNCHypergeo'></span><span id='topic+numWNCHypergeo'></span><span id='topic+numFNCHypergeo'></span><span id='topic+minHypergeo'></span><span id='topic+maxHypergeo'></span>

<h3>Description</h3>

<p>Statistical models of biased sampling in the form of noncentral 
hypergeometric distributions, 
including Wallenius' noncentral hypergeometric distribution and
Fisher's noncentral hypergeometric distribution 
(also called extended hypergeometric distribution).
</p>
<p>These are distributions that you can get when taking colored balls
from an urn without replacement, with bias.  
The univariate distributions are used when there are two colors of balls.  
The multivariate distributions are used when there are more 
than two colors of balls.
</p>
<p>Please see <code>vignette("UrnTheory")</code>
for a definition of these distributions and how
to decide which distribution to use in a specific case.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dWNCHypergeo(x, m1, m2, n, odds, precision=1E-7)
dFNCHypergeo(x, m1, m2, n, odds, precision=1E-7)
pWNCHypergeo(x, m1, m2, n, odds, precision=1E-7, lower.tail=TRUE)
pFNCHypergeo(x, m1, m2, n, odds, precision=1E-7, lower.tail=TRUE)
qWNCHypergeo(p, m1, m2, n, odds, precision=1E-7, lower.tail=TRUE)
qFNCHypergeo(p, m1, m2, n, odds, precision=1E-7, lower.tail=TRUE)
rWNCHypergeo(nran, m1, m2, n, odds, precision=1E-7)
rFNCHypergeo(nran, m1, m2, n, odds, precision=1E-7)
meanWNCHypergeo(m1, m2, n, odds, precision=1E-7)
meanFNCHypergeo(m1, m2, n, odds, precision=1E-7)
varWNCHypergeo(m1, m2, n, odds, precision=1E-7)
varFNCHypergeo(m1, m2, n, odds, precision=1E-7)
modeWNCHypergeo(m1, m2, n, odds, precision=1E-7)
modeFNCHypergeo(m1, m2, n, odds, precision=0)
oddsWNCHypergeo(mu, m1, m2, n, precision=0.1)
oddsFNCHypergeo(mu, m1, m2, n, precision=0.1)
numWNCHypergeo(mu, n, N, odds, precision=0.1)
numFNCHypergeo(mu, n, N, odds, precision=0.1)
minHypergeo(m1, m2, n)
maxHypergeo(m1, m2, n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BiasedUrn-Univariate_+3A_x">x</code></td>
<td>
<p>Number of red balls sampled.</p>
</td></tr>
<tr><td><code id="BiasedUrn-Univariate_+3A_m1">m1</code></td>
<td>
<p>Initial number of red balls in the urn.</p>
</td></tr>
<tr><td><code id="BiasedUrn-Univariate_+3A_m2">m2</code></td>
<td>
<p>Initial number of white balls in the urn.</p>
</td></tr>
<tr><td><code id="BiasedUrn-Univariate_+3A_n">n</code></td>
<td>
<p>Total number of balls sampled.</p>
</td></tr>
<tr><td><code id="BiasedUrn-Univariate_+3A_n">N</code></td>
<td>
<p>Total number of balls in urn before sampling.</p>
</td></tr>
<tr><td><code id="BiasedUrn-Univariate_+3A_odds">odds</code></td>
<td>
<p>Probability ratio of red over white balls.</p>
</td></tr>
<tr><td><code id="BiasedUrn-Univariate_+3A_p">p</code></td>
<td>
<p>Cumulative probability.</p>
</td></tr>
<tr><td><code id="BiasedUrn-Univariate_+3A_nran">nran</code></td>
<td>
<p>Number of random variates to generate.</p>
</td></tr>
<tr><td><code id="BiasedUrn-Univariate_+3A_mu">mu</code></td>
<td>
<p>Mean x.</p>
</td></tr>
<tr><td><code id="BiasedUrn-Univariate_+3A_precision">precision</code></td>
<td>
<p>Desired precision of calculation.</p>
</td></tr>
<tr><td><code id="BiasedUrn-Univariate_+3A_lower.tail">lower.tail</code></td>
<td>
<p>if TRUE (default), probabilities are
<code class="reqn">P(X \le x)</code>, otherwise, <code class="reqn">P(X &gt; x)</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><b>Allowed parameter values</b> <br />
All parameters must be non-negative.  <code>n</code> cannot exceed <code>N = m1 + m2</code>.  
The code has been tested with odds in the range 
<code class="reqn">10^{-9} \ldots 10^9</code> and zero.  The code may work with odds
outside this range, but errors or NAN can occur for extreme values of odds.
A ball with odds = 0 is equivalent to no ball.  
<code>mu</code> must be within the possible range of <code>x</code>.
</p>
<p><b>Calculation time</b> <br />
The calculation time depends on the specified precision.
</p>


<h3>Value</h3>

<p><code>dWNCHypergeo</code> and <code>dFNCHypergeo</code> return the probability mass function for
Wallenius' and Fisher's noncentral hypergeometric distribution, respectively.  
A single value is returned if <code>x</code> is a scalar.  
Multiple values are returned if <code>x</code> is a vector.
<br />
</p>
<p><code>pWNCHypergeo</code> and <code>pFNCHypergeo</code> return the 
cumulative probability function for
Wallenius' and Fisher's noncentral hypergeometric distribution, respectively.  
A single value is returned if <code>x</code> is a scalar.  
Multiple values are returned if <code>x</code> is a vector.
<br />
</p>
<p><code>qWNCHypergeo</code> and <code>qFNCHypergeo</code> return the quantile function for
Wallenius' and Fisher's noncentral hypergeometric distribution, respectively.  
A single value is returned if <code>p</code> is a scalar.  
Multiple values are returned if <code>p</code> is a vector.
<br />
</p>
<p><code>rWNCHypergeo</code> and <code>rFNCHypergeo</code> return 
random variates with Wallenius' and Fisher's noncentral hypergeometric 
distribution, respectively.
<br />
</p>
<p><code>meanWNCHypergeo</code> and <code>meanFNCHypergeo</code> calculate the mean
of Wallenius' and Fisher's noncentral hypergeometric 
distribution, respectively.  A simple and fast approximation is used when 
<code class="reqn">precision \geq 0.1</code>.
<br />
</p>
<p><code>varWNCHypergeo</code> and <code>varFNCHypergeo</code> calculate the variance
of Wallenius' and Fisher's noncentral hypergeometric 
distribution, respectively.  A simple and fast approximation is used when 
<code class="reqn">precision \geq 0.1</code>.
<br />
</p>
<p><code>modeWNCHypergeo</code> and <code>modeFNCHypergeo</code> calculate the mode
of Wallenius' and Fisher's noncentral hypergeometric 
distribution, respectively.
<br />
</p>
<p><code>oddsWNCHypergeo</code> and <code>oddsFNCHypergeo</code> estimate the odds
of Wallenius' and Fisher's noncentral hypergeometric 
distribution from a measured mean.
A single value is returned if <code>mu</code> is a scalar.  
Multiple values are returned if <code>mu</code> is a vector.  
A simple and fast approximation is used regardless of the specified precision.  
Exact calculation is not supported.  
See <code>demo(OddsPrecision)</code>.
<br />
</p>
<p><code>numWNCHypergeo</code> and <code>numFNCHypergeo</code> estimate the 
number of balls of each color in the urn before sampling from
an experimental mean and a known odds ratio for
Wallenius' and Fisher's noncentral hypergeometric distributions.  
The returned numbers <code>m1</code> and <code>m2</code> are not integers.  
A vector of <code>m1</code> and <code>m2</code> is returned if <code>mu</code> is a scalar.  
A matrix is returned if <code>mu</code> is a vector.
A simple approximation is used regardless of the specified precision.  
Exact calculation is not supported.  
The precision of calculation is indicated by <code>demo(OddsPrecision)</code>.  
<br />
</p>
<p><code>minHypergeo</code> and <code>maxHypergeo</code> calculate the 
minimum and maximum value of <code>x</code>.  The value is valid for 
Wallenius' and Fisher's noncentral hypergeometric distribution
as well as for the (central) hypergeometric distribution.
</p>


<h3>References</h3>

<p><a href="https://www.agner.org/random/">https://www.agner.org/random/</a>
</p>
<p>Fog, A. 2008a. Calculation methods for Wallenius’ noncentral hypergeometric distribution.  <em>Communications in Statistics—Simulation and Computation</em> <b>37</b>, 2 <a href="https://doi.org/10.1080/03610910701790269">doi:10.1080/03610910701790269</a>
</p>
<p>Fog, A. 2008b. Sampling methods for Wallenius’ and Fisher’s noncentral hypergeometric distributions.  <em>Communications in Statistics—Simulation and Computation</em> <b>37</b>, 2 <a href="https://doi.org/10.1080/03610910701790236">doi:10.1080/03610910701790236</a>
</p>


<h3>See Also</h3>

<p><code>vignette("UrnTheory")</code>
<br />
<code><a href="#topic+BiasedUrn-Multivariate">BiasedUrn-Multivariate</a></code>.
<br />
<code><a href="#topic+BiasedUrn">BiasedUrn</a></code>.
<br />
<code><a href="stats.html#topic+fisher.test">fisher.test</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># get probability
dWNCHypergeo(12, 25, 32, 20, 2.5)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
