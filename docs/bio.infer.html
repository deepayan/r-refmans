<!DOCTYPE html><html><head><title>Help for package bio.infer</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {bio.infer}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bio.infer-package'>
<p>Scripts for computing biological inferences</p></a></li>
<li><a href='#bcnt.emapw'><p>Benthic count data for the western United States</p></a></li>
<li><a href='#bcnt.OR'><p>Benthic count data for western Oregon</p></a></li>
<li><a href='#bcnt.otu.OR'><p>Benthic count data with OTU</p></a></li>
<li><a href='#bcnt.tax.OR'><p>Benthic count with taxonomic hierarchy</p></a></li>
<li><a href='#coef.east.sed'><p>Regression coefficients for eastern U.S. sediment</p></a></li>
<li><a href='#coef.west.wt'><p>Weighted regression coefficients for western U.S.</p></a></li>
<li><a href='#correct.taxanames'><p>Correct unrecognized taxon names</p></a></li>
<li><a href='#envdata.emapw'><p>Environmental data from the western United States</p></a></li>
<li><a href='#envdata.OR'><p>Environmental data from western OR</p></a></li>
<li><a href='#flist.data'><p>List available data</p></a></li>
<li><a href='#flist.match'><p>Selects data files matching search string</p></a></li>
<li><a href='#formtomat'><p>Analyze formula string</p></a></li>
<li><a href='#get.dupe.sel'><p>Get duplicate selection</p></a></li>
<li><a href='#get.otu'><p>Defines operational taxonomic units (OTUs)</p></a></li>
<li><a href='#get.taxon.names'><p>Get taxon names from benthic count file</p></a></li>
<li><a href='#get.taxonomic'><p>Merge benthic count data with the ITIS taxonomy table</p></a></li>
<li><a href='#get.valid.names'><p>Get taxon names from benthic count file</p></a></li>
<li><a href='#in.ITIS'><p>Check to see if taxon name is in ITIS</p></a></li>
<li><a href='#incorp.correct'><p>Incorporate taxon name revisions</p></a></li>
<li><a href='#infergui'><p>Graphical User Interface for biological inferences</p></a></li>
<li><a href='#itis.ttable'><p>ITIS taxonomic hierarchy table</p></a></li>
<li><a href='#load.itis'><p>Load ITIS taxon table</p></a></li>
<li><a href='#load.revised.otu'><p>Loads a user-revised OTU table</p></a></li>
<li><a href='#load.revised.species'><p>Loads a user-revised list of species names</p></a></li>
<li><a href='#locate.dupes'><p>Locate duplicated taxon names</p></a></li>
<li><a href='#make.fulltab1'><p>Make full taxonomic table</p></a></li>
<li><a href='#make.species'><p>Generate species names</p></a></li>
<li><a href='#makess'><p>Make a site-OTU matrix</p></a></li>
<li><a href='#mlsolve'><p>Maximum likelihood inferences</p></a></li>
<li><a href='#modalDialog'><p>Modal dialog box using TclTK</p></a></li>
<li><a href='#output.tax.table'><p>Output final taxonomic table</p></a></li>
<li><a href='#parse.taxon.name'><p>Parse taxon name</p></a></li>
<li><a href='#remove.dupes'><p>Remove unselected duplicates from taxon table</p></a></li>
<li><a href='#resolve.mult'><p>Resolve cases in which two taxa are found in ITIS</p></a></li>
<li><a href='#sel.coeffile'><p>Select coefficient file</p></a></li>
<li><a href='#ss.OR'><p>site-OTU matrix for western Oregon</p></a></li>
<li><a href='#taxon.env'><p>Estimate taxon-environment relationships</p></a></li>
<li><a href='#tklist.modal'><p>Modal select list dialog using TclTk</p></a></li>
<li><a href='#trait.feeding'><p>Feeding traits for benthic invertebrates</p></a></li>
<li><a href='#trait.habit'><p>Habit traits for benthic invertebrates</p></a></li>
<li><a href='#trait.stat'><p>Compute trait metrics</p></a></li>
<li><a href='#view.te'><p>View taxon-environment relationships</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Predict Environmental Conditions from Biological Observations</td>
</tr>
<tr>
<td>Version:</td>
<td>1.3-6</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-09-01</td>
</tr>
<tr>
<td>Author:</td>
<td>Lester L. Yuan</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Lester L. Yuan &lt;yuan.lester@epa.gov&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Imports benthic count data, reformats this data, and
        computes environmental inferences from this data.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10), tcltk</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>FALSE</td>
</tr>
<tr>
<td>LazyData:</td>
<td>FALSE</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-09-02 12:28:36 UTC; lesterlyuan</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-09-02 13:20:07 UTC</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
</table>
<hr>
<h2 id='bio.infer-package'>
Scripts for computing biological inferences
</h2><span id='topic+bio.infer-package'></span><span id='topic+bio.infer'></span>

<h3>Description</h3>

<p>Reformats raw benthic count files, combines them with existing
taxon-environment relationships, and computes inferences of
environmental conditions.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> bio.infer</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.0</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2006-10-31</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL version 2 or newer</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Use this package to import benthic count data, reformat the data, and
compute inferences of environmental conditions using taxon-environment
relationships.
</p>
<p>Typically, the user will start by loading a local benthic count
data file (see  <code><a href="#topic+bcnt.OR">bcnt.OR</a></code>
for an example of the required format).
This benthic count file will be merged with standardized
taxonomic hierarchy information using <code><a href="#topic+get.taxonomic">get.taxonomic</a></code>.
Then, operational taxonomic units will be assigned, based on the number
of occurrences of different taxa and based on the identity of taxa for
which environmental preferences have been quantified. (See
<code><a href="#topic+get.otu">get.otu</a></code> for the OTU assignment script, and
<code><a href="#topic+coef.west.wt">coef.west.wt</a></code> for an example file of environmental
preferences.)
</p>
<p>Once OTUs have been assigned, the benthic count file is reformatted as a
site-taxon matrix (<code><a href="#topic+makess">makess</a></code>).  This file can then be used to
compute biological inferences (<code><a href="#topic+mlsolve">mlsolve</a></code>).
</p>
<p>This package was developed in Windows but should be fully functional in other
operating systems.
</p>


<h3>Author(s)</h3>

<p>Lester L. Yuan
</p>

<hr>
<h2 id='bcnt.emapw'>Benthic count data for the western United States</h2><span id='topic+bcnt.emapw'></span>

<h3>Description</h3>

<p>Benthic count data for streams in the western United States. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(bcnt.emapw)</code></pre>


<h3>Format</h3>

<p>Three fields are included.
</p>

<dl>
<dt><code>ID.NEW</code></dt><dd><p>Unique sample code</p>
</dd>
<dt><code>Taxaname</code></dt><dd><p>Name of the observed taxon</p>
</dd>
<dt><code>Abundance</code></dt><dd><p>Abundance of the observed taxon</p>
</dd>
</dl>



<h3>Source</h3>

<p>U.S. Environmental Protection Agency Environmental Monitoring and
Assessment Program
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(bcnt.emapw)
</code></pre>

<hr>
<h2 id='bcnt.OR'>Benthic count data for western Oregon</h2><span id='topic+bcnt.OR'></span>

<h3>Description</h3>

<p>Benthic count data for streams in western Oregon. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(bcnt.OR)</code></pre>


<h3>Format</h3>

<p>Three fields are included.
</p>

<dl>
<dt><code>SVN</code></dt><dd><p>Unique sample code</p>
</dd>
<dt><code>Taxon</code></dt><dd><p>Name of the observed taxon</p>
</dd>
<dt><code>CountValue</code></dt><dd><p>Abundance of the observed taxon</p>
</dd>
</dl>



<h3>Source</h3>

<p>Oregon Department of Environmental Quality
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(bcnt.OR)
</code></pre>

<hr>
<h2 id='bcnt.otu.OR'>Benthic count data with OTU</h2><span id='topic+bcnt.otu.OR'></span>

<h3>Description</h3>

<p>Benthic count data from western Oregon with operational taxonomic units
assigned by <code><a href="#topic+get.otu">get.otu</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(bcnt.otu.OR)</code></pre>


<h3>Format</h3>

<p>Five fields are included.
</p>

<dl>
<dt><code>SVN</code></dt><dd><p>Unique sample identifier</p>
</dd>
<dt><code>Taxon</code></dt><dd><p>Original taxon name, same as in <code><a href="#topic+bcnt.OR">bcnt.OR</a></code></p>
</dd>
<dt><code>CountValue</code></dt><dd><p>Taxon abundance</p>
</dd>
<dt><code>TNAME</code></dt><dd><p>Taxon name after processing by
<code><a href="#topic+get.taxonomic">get.taxonomic</a></code></p>
</dd>
<dt><code>OTU</code></dt><dd><p>Operational taxonomic unit.  Taxon name selected with
associated taxon-environment data and selected to eliminate
double-counting</p>
</dd>
</dl>



<h3>Source</h3>

<p>Oregon Department of Environmental Quality
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(bcnt.otu.OR)
</code></pre>

<hr>
<h2 id='bcnt.tax.OR'>Benthic count with taxonomic hierarchy</h2><span id='topic+bcnt.tax.OR'></span>

<h3>Description</h3>

<p>Benthic count data from western Oregon with full taxonomic hierarchy
assigned by <code><a href="#topic+get.taxonomic">get.taxonomic</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(bcnt.tax.OR)</code></pre>


<h3>Source</h3>

<p>Oregon Department of Environmental Quality
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(bcnt.tax.OR)
</code></pre>

<hr>
<h2 id='coef.east.sed'>Regression coefficients for eastern U.S. sediment</h2><span id='topic+coef.east.sed'></span>

<h3>Description</h3>

<p>Regression coefficients describing relationships between different
taxa and percent sands/fines.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(coef.west.wt)</code></pre>


<h3>Format</h3>

<p>A list of with following four elements is provided.
</p>

<dl>
<dt><code>tnames</code></dt><dd><p>Character vector with the names of each taxon modelled.</p>
</dd>
<dt><code>csave</code></dt><dd><p>Matrix of regression coefficients for each taxon.  Number
of rows is the same as the number of taxa modelled and the number of
columns is 6.</p>
</dd>
<dt><code>xvar</code></dt><dd><p>Character vector with the names of variables modelled.</p>
</dd>
<dt><code>xlims</code></dt><dd><p>List of limits for each of the environmental
variables.</p>
</dd>
<dt><code>form</code></dt><dd><p>Regression formula used
to estimate coefficients.</p>
</dd>
</dl>



<h3>Details</h3>

<p>These regression coefficients were computed using logistic regression.
</p>


<h3>Source</h3>

<p>Yuan, L.L.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(coef.east.sed)
</code></pre>

<hr>
<h2 id='coef.west.wt'>Weighted regression coefficients for western U.S.</h2><span id='topic+coef.west.wt'></span>

<h3>Description</h3>

<p>Regression coefficients describing relationships between different
taxa and percent sands/fines and stream temperature.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(coef.west.wt)</code></pre>


<h3>Format</h3>

<p>A list of with following four elements is provided.
</p>

<dl>
<dt><code>tnames</code></dt><dd><p>Character vector with the names of each taxon modelled.</p>
</dd>
<dt><code>csave</code></dt><dd><p>Matrix of regression coefficients for each taxon.  Number
of rows is the same as the number of taxa modelled and the number of
columns is 6.</p>
</dd>
<dt><code>xvar</code></dt><dd><p>Character vector with the names of variables modelled.</p>
</dd>
<dt><code>xlims</code></dt><dd><p>List of limits for each of the environmental
variables.</p>
</dd>
<dt><code>form</code></dt><dd><p>Regression formula used
to estimate coefficients.</p>
</dd>
</dl>



<h3>Details</h3>

<p>These regression coefficients were computed using logistic regression
weighted by the number of stream miles represented by each sample.
</p>


<h3>Source</h3>

<p>Yuan, L.L.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(coef.west.wt)
</code></pre>

<hr>
<h2 id='correct.taxanames'>Correct unrecognized taxon names</h2><span id='topic+correct.taxanames'></span>

<h3>Description</h3>

<p>Prompts user to correct unrecognized taxon names
</p>


<h3>Usage</h3>

<pre><code class='language-R'>correct.taxanames(tname.old, get.tax.env)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="correct.taxanames_+3A_tname.old">tname.old</code></td>
<td>
<p>Character vector of unrecognized names</p>
</td></tr>
<tr><td><code id="correct.taxanames_+3A_get.tax.env">get.tax.env</code></td>
<td>
<p>Environment for ITIS taxon table</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Prompts user to enter corrections to names via a tcltk dialog box.
</p>


<h3>Value</h3>

<p>Character vector of corrected names
</p>


<h3>Author(s)</h3>

<p>Lester L. Yuan</p>

<hr>
<h2 id='envdata.emapw'>Environmental data from the western United States</h2><span id='topic+envdata.emapw'></span>

<h3>Description</h3>

<p>Environmental data for stream sampled in the western United States.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(envdata.OR)</code></pre>


<h3>Format</h3>

<p>A data frame with 1674 observations on the following 8 variables.
</p>

<dl>
<dt><code>ID.NEW</code></dt><dd><p>Unique sample code</p>
</dd>
<dt><code>ntl</code></dt><dd><p>Total nitrogen concentration</p>
</dd>
<dt><code>no3</code></dt><dd><p>Nitrate concentration</p>
</dd>
<dt><code>ptl</code></dt><dd><p>Total phosphorus concentration</p>
</dd>
<dt><code>sed</code></dt><dd><p>Percent sands and fines</p>
</dd>
<dt><code>tempres</code></dt><dd><p>Corrected temperature</p>
</dd>
<dt><code>STRMTEMP</code></dt><dd><p>Grab temperature</p>
</dd>
<dt><code>jday</code></dt><dd><p>Julian sampling day</p>
</dd>
</dl>



<h3>Source</h3>

<p>U.S. Environmental Protection Agency Environmental Monitoring and
Assessment Program.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(envdata.emapw)
</code></pre>

<hr>
<h2 id='envdata.OR'>Environmental data from western OR</h2><span id='topic+envdata.OR'></span>

<h3>Description</h3>

<p>Environmental data for stream sampled in western Oregon.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(envdata.OR)</code></pre>


<h3>Format</h3>

<p>A data frame with 245 observations on the following 13 variables.
</p>

<dl>
<dt><code>STRM.ID</code></dt><dd><p>Unique sample code</p>
</dd>
<dt><code>jday</code></dt><dd><p>Sampling day</p>
</dd>
<dt><code>lon</code></dt><dd><p>Longitude in decimal degrees</p>
</dd>
<dt><code>lat</code></dt><dd><p>Latitude in decimal degrees</p>
</dd>
<dt><code>sed</code></dt><dd><p>Percent sands and fines</p>
</dd>
<dt><code>elev</code></dt><dd><p>Log-transformed elevation</p>
</dd>
<dt><code>slope</code></dt><dd><p>Slope</p>
</dd>
<dt><code>area</code></dt><dd><p>Log-transformed catchment area</p>
</dd>
<dt><code>sed.log</code></dt><dd><p>Log-transformed percent sands and fines</p>
</dd>
<dt><code>temp</code></dt><dd><p>Grab stream temperature</p>
</dd>
<dt><code>temp.avg</code></dt><dd><p>Seven day average maximum temperature</p>
</dd>
<dt><code>elev.ut</code></dt><dd><p>Elevation</p>
</dd>
<dt><code>sp</code></dt><dd><p>Estimate of unit stream power</p>
</dd>
</dl>



<h3>Source</h3>

<p>Oregon Department of Environmental Quality
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(envdata.OR)
</code></pre>

<hr>
<h2 id='flist.data'>List available data</h2><span id='topic+flist.data'></span>

<h3>Description</h3>

<p>Lists available data in the package
</p>


<h3>Usage</h3>

<pre><code class='language-R'>flist.data()
</code></pre>


<h3>Value</h3>

<p>List of data files.
</p>


<h3>Author(s)</h3>

<p>Lester L. Yuan</p>

<hr>
<h2 id='flist.match'>Selects data files matching search string</h2><span id='topic+flist.match'></span>

<h3>Description</h3>

<p>Select data files matching search string
</p>


<h3>Usage</h3>

<pre><code class='language-R'>flist.match(pattern = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="flist.match_+3A_pattern">pattern</code></td>
<td>
<p>Character string to be matched.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of matched data files.
</p>


<h3>Author(s)</h3>

<p>Lester L. Yuan</p>

<hr>
<h2 id='formtomat'>Analyze formula string</h2><span id='topic+formtomat'></span>

<h3>Description</h3>

<p>Analyzes formula string that defines the regression models for
taxon-environment relationships.  Returns a numerical representation
of the formula and the derivative of the formula that can be used by
<code>mlsolve</code>. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>formtomat(a, xvar)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="formtomat_+3A_a">a</code></td>
<td>
<p>Character string defining regression formula.</p>
</td></tr>
<tr><td><code id="formtomat_+3A_xvar">xvar</code></td>
<td>
<p>Character vector with variable names.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Internal function to <code>mlsolve</code>.  
</p>


<h3>Value</h3>

<p>List of transformations.
</p>


<h3>Author(s)</h3>

<p>Lester L. Yuan</p>

<hr>
<h2 id='get.dupe.sel'>Get duplicate selection</h2><span id='topic+get.dupe.sel'></span>

<h3>Description</h3>

<p>Prompt user to select correct version from duplicated entries
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.dupe.sel(sumstr)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get.dupe.sel_+3A_sumstr">sumstr</code></td>
<td>
<p>Character vector summarizing duplicated taxon names</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Prompts the user via a tcltk window to select appropriate name from
duplicate taxon names.
</p>


<h3>Value</h3>

<p>Returns integer indicating which names are selected.
</p>


<h3>Author(s)</h3>

<p>Lester L. Yuan</p>

<hr>
<h2 id='get.otu'>Defines operational taxonomic units (OTUs)</h2><span id='topic+get.otu'></span>

<h3>Description</h3>

<p><code>get.otu</code> generates OTUs for benthic count data using a simple
algorithm that is designed to maximize the amount of taxonomic
information retained across the entire data set, while eliminating
redundant taxonomic identifications.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.otu(bcnt, optlist = NULL, ndc = TRUE, outputFile = FALSE,
gui = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get.otu_+3A_bcnt">bcnt</code></td>
<td>
<p>benthic count data frame that includes the full taxonomic
hierarchy for each taxon.  Typically, <code>bcnt</code> is the output from
<code><a href="#topic+get.taxonomic">get.taxonomic</a></code>.
</p>
</td></tr>
<tr><td><code id="get.otu_+3A_optlist">optlist</code></td>
<td>
<p>vector of taxon names for which trait or tolerance value
is available.  Specify <code>optlist = NULL</code> for cases in which OTU are
computed without regard for any additional taxon specific information,
e.g. for developing a RIVPACS model.</p>
</td></tr>
<tr><td><code id="get.otu_+3A_ndc">ndc</code></td>
<td>
<p>Logical flag indicating whether OTU should be computed that
eliminate double-counting of taxa.</p>
</td></tr>
<tr><td><code id="get.otu_+3A_outputfile">outputFile</code></td>
<td>
<p>Logical indicating whether to output summary information</p>
</td></tr>
<tr><td><code id="get.otu_+3A_gui">gui</code></td>
<td>
<p>Logical indicating whether to use gui interface.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>get.otu</code> makes decisions about OTU according to the following rule.
The number samples in which a given taxonomic group (e.g. Baetidae) is
observed, is compared to the number of samples in which members of the
that same group are identified to a higher taxonomic level (e.g.,
Baetis, Fallceon, Acentrella, etc.).  If more samples are observed
with the coarser identification, then all identifications are
downgraded to the coarse identification.  If more samples are observed
at the finer level of identification, then those sample are retained,
and all identifications at the coarser level are omitted.
Before deciding on OTU assignments, the script first reviews the
species names that are listed in the benthic count file and matches
them with the species names provided in <code>optlist</code>.
</p>


<h3>Value</h3>

<p>Final OTU decisions are returned as tab-delimited text file,
<code>sum.otu.txt</code>, which is best viewed using a spreadsheet.  A new benthic count
file is also returned in R, including the original benthic count
information and a new field specifying the OTU designation for each
taxon.  Manual revisions to the assigned OTUs can be recorded in
<code>sum.otu.txt</code> and loaded with <code><a href="#topic+load.revised.otu">load.revised.otu</a></code>
</p>


<h3>Author(s)</h3>

<p>Lester L. Yuan
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get.taxonomic">get.taxonomic</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(bcnt.tax.OR)
data(coef.west.wt)
bcnt.otu.OR &lt;- get.otu(bcnt.tax.OR, coef.west.wt)
</code></pre>

<hr>
<h2 id='get.taxon.names'>Get taxon names from benthic count file</h2><span id='topic+get.taxon.names'></span>

<h3>Description</h3>

<p>Get taxon names from benthic count file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.taxon.names(bcnt)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get.taxon.names_+3A_bcnt">bcnt</code></td>
<td>
<p>Benthic count file with taxon names in second column</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Checks to see if second column is factor or character.
</p>


<h3>Value</h3>

<p>Returns character vector of taxon names.
</p>


<h3>Author(s)</h3>

<p>Lester L. Yuan</p>

<hr>
<h2 id='get.taxonomic'>Merge benthic count data with the ITIS taxonomy table</h2><span id='topic+get.taxonomic'></span>

<h3>Description</h3>

<p><code>get.taxonomic</code> merges the taxon names provided in a benthic
count data file with a standardized taxonomy table.  The
purpose of this function is to provide the complete taxonomic
hierarchy for each taxon.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.taxonomic(bcnt)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get.taxonomic_+3A_bcnt">bcnt</code></td>
<td>
<p>A benthic count data frame with the following three
fields: a sample identifier, taxon name, and abundance.  The three
fields must be ordered as listed.  Sample identifier is typically a
character string that is a unique identifier for a given
sample. Taxon name is a character string that specifies the name of
the taxon observed in the sample, and abundance is the number of
individuals of that taxon that were observed.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>get.taxonomic</code> attempts to match taxon names provided in a
benthic count data file with taxa listed in ITIS.  The script
automatically corrects for the most common conventions in taxonomic
naming.  For example, taxon names are converted to all capital
letters, and trailing strings such as &quot;SP.&quot; and &quot;SPP.&quot; are deleted.
</p>
<p>The script lists taxa remaining that are not
matched to entries in the ITIS database using <code><a href="utils.html#topic+fix">fix</a></code>.  The
user can then enter a 
corrected spelling for the taxon name.  
</p>
<p>The script provides a final summary of the unmatched taxon names, and
the user can continue revising names, or complete the program.
</p>


<h3>Value</h3>

<p>A final taxonomic table is returned as tab-delimited text in the file
<code>sum.tax.table.txt</code>.  This file is best viewed using a
spreadsheet.   Within 
R, the script returns a benthic count file with the original taxon
name associated with a full taxonomic hierarchy for that taxon.
The assigned species names can be modified by hand in
<code>sum.tax.table.txt</code> and the revised information loaded with
<code><a href="#topic+load.revised.species">load.revised.species</a></code>. 
</p>


<h3>Author(s)</h3>

<p>Lester L. Yuan
</p>


<h3>See Also</h3>

<p><code><a href="#topic+itis.ttable">itis.ttable</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(bcnt.OR)
data(itis.ttable)
## Not run: 
bcnt.tax.OR &lt;- get.taxonomic(bcnt.OR)

## End(Not run)
</code></pre>

<hr>
<h2 id='get.valid.names'>Get taxon names from benthic count file</h2><span id='topic+get.valid.names'></span>

<h3>Description</h3>

<p>Identifies valid names from parsed name matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.valid.names(df.parse, get.tax.env)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get.valid.names_+3A_df.parse">df.parse</code></td>
<td>
<p>Parsed name matrix</p>
</td></tr>
<tr><td><code id="get.valid.names_+3A_get.tax.env">get.tax.env</code></td>
<td>
<p>Environment for ITIS taxon table</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Searches for taxon names in ITIS and splits name matrix into list with
first element being the matrix of valid names and the second element
being the matrix of invalid names.
</p>


<h3>Value</h3>

<p>List of two taxon name matrices.
</p>


<h3>Author(s)</h3>

<p>Lester L. Yuan</p>

<hr>
<h2 id='in.ITIS'>Check to see if taxon name is in ITIS</h2><span id='topic+in.ITIS'></span>

<h3>Description</h3>

<p>Checks to see if taxon names are listed in the ITIS taxon table.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>in.ITIS(df.parse, get.tax.env, col.sel = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="in.ITIS_+3A_df.parse">df.parse</code></td>
<td>
<p>Character vector or matrix character vectors of names
that need to be checked for presence in ITIS</p>
</td></tr>
<tr><td><code id="in.ITIS_+3A_get.tax.env">get.tax.env</code></td>
<td>
<p>Environment variable where the full ITIS taxon
table is available</p>
</td></tr>
<tr><td><code id="in.ITIS_+3A_col.sel">col.sel</code></td>
<td>
<p>Integer allowing selection of a particular column
of the matrix of names to check.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list in which each element of the list is a successive
character string from the parsed names.
</p>


<h3>Author(s)</h3>

<p>Lester L. Yuan</p>

<hr>
<h2 id='incorp.correct'>Incorporate taxon name revisions</h2><span id='topic+incorp.correct'></span>

<h3>Description</h3>

<p>Incorporates corrected taxon names into parse.list
</p>


<h3>Usage</h3>

<pre><code class='language-R'>incorp.correct(tname.new, parse.list)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="incorp.correct_+3A_tname.new">tname.new</code></td>
<td>
<p>Character vector of corrected taxon names</p>
</td></tr>
<tr><td><code id="incorp.correct_+3A_parse.list">parse.list</code></td>
<td>
<p>List of parsed taxon names</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Revised parse.list.
</p>


<h3>Author(s)</h3>

<p>Lester L. Yuan</p>

<hr>
<h2 id='infergui'>Graphical User Interface for biological inferences</h2><span id='topic+infergui'></span>

<h3>Description</h3>

<p>Provides a graphical user interface that allows users to compute
biological inferences using existing taxon-environment relationships.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>infergui()
</code></pre>


<h3>Value</h3>

<p>None.  Used for its side effects.
</p>


<h3>Author(s)</h3>

<p>Lester L. Yuan
</p>

<hr>
<h2 id='itis.ttable'>ITIS taxonomic hierarchy table</h2><span id='topic+itis.ttable'></span>

<h3>Description</h3>

<p>Full taxonomic hierarchy to genus for the Kingdom Animalia.
Retrieved November 21, 2008 from the Integrated Taxonomic Information
System on-line database, <a href="http://www.itis.gov">http://www.itis.gov</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(itis.ttable)</code></pre>


<h3>Source</h3>

<p>Integrated Taxonomic Information System, U.S. Department of
Agriculture.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(itis.ttable)
</code></pre>

<hr>
<h2 id='load.itis'>Load ITIS taxon table</h2><span id='topic+load.itis'></span>

<h3>Description</h3>

<p>Load ITIS taxon table to the specified environment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>load.itis(get.tax.env)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="load.itis_+3A_get.tax.env">get.tax.env</code></td>
<td>
<p>Environment variable.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Loads full ITIS taxonomic table into specified environment.
</p>


<h3>Value</h3>

<p>None.  Used for side effects.
</p>


<h3>Author(s)</h3>

<p>Lester L. Yuan</p>

<hr>
<h2 id='load.revised.otu'>Loads a user-revised OTU table</h2><span id='topic+load.revised.otu'></span>

<h3>Description</h3>

<p>If manual correction of the OTU selections is desired, these
corrections should be made on the &quot;sum.otu.txt&quot; file provided by
<code><a href="#topic+get.otu">get.otu</a></code>.  The corrections should be saved as
tab-delimited text, and then <code>load.revised.otu</code> run.   
</p>


<h3>Usage</h3>

<pre><code class='language-R'>load.revised.otu(bcnt.otu, otufname = "sum.otu.txt")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="load.revised.otu_+3A_bcnt.otu">bcnt.otu</code></td>
<td>
<p>Original benthic count file with OTU designations.
Output from <code><a href="#topic+get.otu">get.otu</a></code>
</p>
</td></tr>
<tr><td><code id="load.revised.otu_+3A_otufname">otufname</code></td>
<td>
<p>File name of revised OTU assignments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The benthic count data frame
is assumed to be the original output from <code><a href="#topic+get.otu">get.otu</a></code>, and
therefore has a field called <code>TNAME</code>. 
</p>


<h3>Value</h3>

<p>The script returns a new benthic count file that incorporates the
corrections to the OTU table. 
</p>


<h3>Author(s)</h3>

<p>Lester L. Yuan
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get.otu">get.otu</a></code></p>

<hr>
<h2 id='load.revised.species'>Loads a user-revised list of species names</h2><span id='topic+load.revised.species'></span>

<h3>Description</h3>

<p>If manual correction of the species names assigned by <code>get.taxonomic</code> is desired, these
corrections should be made on the <code>sum.tax.table.txt</code> file.
The corrections should be saved as
tab-delimited text, and then <code>load.revised.species</code> run.   
</p>


<h3>Usage</h3>

<pre><code class='language-R'>load.revised.species(bcnt.tax, fname)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="load.revised.species_+3A_bcnt.tax">bcnt.tax</code></td>
<td>
<p>benthic count data frame that includes the full
taxonomic hierarchy for each taxon.</p>
</td></tr>
<tr><td><code id="load.revised.species_+3A_fname">fname</code></td>
<td>
<p>Character string containing file name for the revised,
tab-delimited, file in the format of <code>sum.tax.table.txt</code>.  See <code><a href="#topic+get.taxonomic">get.taxonomic</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The script prompts the user to enter the name of the text file
containing the revised species names.  The original &quot;SPECIES&quot; column
in bcnt.tax is deleted and the new, revised version is merged into
bcnt.tax. 
</p>


<h3>Value</h3>

<p>The script returns a new benthic count file that incorporates the
corrections to the species names
</p>


<h3>Author(s)</h3>

<p>Lester L. Yuan
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get.taxonomic">get.taxonomic</a></code></p>

<hr>
<h2 id='locate.dupes'>Locate duplicated taxon names</h2><span id='topic+locate.dupes'></span>

<h3>Description</h3>

<p>Locate taxon names that match multiple records in ITIS.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>locate.dupes(fulltab)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="locate.dupes_+3A_fulltab">fulltab</code></td>
<td>
<p>Full taxonomic table for matched taxon names</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Finds duplicate names in fulltab
</p>


<h3>Value</h3>

<p>Returns string that summarizes duplicates and their row numbers.
</p>


<h3>Author(s)</h3>

<p>Lester L. Yuan</p>

<hr>
<h2 id='make.fulltab1'>Make full taxonomic table</h2><span id='topic+make.fulltab1'></span>

<h3>Description</h3>

<p>Merge full ITIS taxonomy with names in benthic count file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make.fulltab1(df.parse, get.tax.env)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="make.fulltab1_+3A_df.parse">df.parse</code></td>
<td>
<p>Matrix with valid taxon names in the second column</p>
</td></tr>
<tr><td><code id="make.fulltab1_+3A_get.tax.env">get.tax.env</code></td>
<td>
<p>Environment variable where the full ITIS taxon
table is available</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Initial merge of taxon names with full ITIS table.
</p>


<h3>Value</h3>

<p>Returns the current list of valid taxon names merged with the full
taxonomic hierarchy.
</p>


<h3>Author(s)</h3>

<p>Lester L. Yuan</p>

<hr>
<h2 id='make.species'>Generate species names</h2><span id='topic+make.species'></span>

<h3>Description</h3>

<p>Generate species names from possibilities in the parsed taxa name table.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make.species(df.parse, fulltab)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="make.species_+3A_df.parse">df.parse</code></td>
<td>
<p>Matrix with valid taxon names in the second column</p>
</td></tr>
<tr><td><code id="make.species_+3A_fulltab">fulltab</code></td>
<td>
<p>Full taxonomic table for matched taxon names</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generates likely species names from matched taxon names that are
identified as Genus level names.
</p>


<h3>Value</h3>

<p>Returns full taxonomic table with SPECIES field appended.
</p>


<h3>Author(s)</h3>

<p>Lester L. Yuan</p>

<hr>
<h2 id='makess'>Make a site-OTU matrix</h2><span id='topic+makess'></span>

<h3>Description</h3>

<p><code>makess</code> generates a site-OTU matrix based on a benthic count
file.  The script assumes that the benthic count file has a field
entitled 'OTU' on which the matrix is based. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>makess(bcnt, tname = "OTU", plothist=FALSE, prints = FALSE, nview = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="makess_+3A_bcnt">bcnt</code></td>
<td>
<p>a benthic count file that results from running
<code><a href="#topic+get.otu">get.otu</a></code> or <code><a href="#topic+load.revised.otu">load.revised.otu</a></code>.
</p>
</td></tr>
<tr><td><code id="makess_+3A_tname">tname</code></td>
<td>
<p>Character string specifying the field in bcnt in which
the name of the taxon is stored.</p>
</td></tr>
<tr><td><code id="makess_+3A_plothist">plothist</code></td>
<td>
<p>Set to <code>TRUE</code> to plot a histogram of the proportion of
abundance at each site that is included in the OTU designations</p>
</td></tr>
<tr><td><code id="makess_+3A_prints">prints</code></td>
<td>
<p>Set to <code>TRUE</code> to view statistics on the proportion
of abundance at each site that is included in the OTU designations</p>
</td></tr>
<tr><td><code id="makess_+3A_nview">nview</code></td>
<td>
<p>Selects the number of sites to view in which the
proportion of abundance included is low</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A site-OTU matrix.
</p>


<h3>Author(s)</h3>

<p>Lester L. Yuan
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get.otu">get.otu</a></code>, <code><a href="#topic+load.revised.otu">load.revised.otu</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(bcnt.otu.OR)
ss.OR &lt;- makess(bcnt.otu.OR)
</code></pre>

<hr>
<h2 id='mlsolve'>Maximum likelihood inferences</h2><span id='topic+mlsolve'></span>

<h3>Description</h3>

<p><code>mlsolve</code> uses maximum likelihood estimation to infer
environmental conditions from biological observations.</p>


<h3>Usage</h3>

<pre><code class='language-R'>mlsolve(ss, coef0, site.sel = "all", bruteforce = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mlsolve_+3A_ss">ss</code></td>
<td>
<p>A site-species matrix, with sample identifiers in the first
column, and abundances.  Typically, the result of <code><a href="#topic+makess">makess</a></code>.
</p>
</td></tr>
<tr><td><code id="mlsolve_+3A_site.sel">site.sel</code></td>
<td>
<p>Character vector of sample id's at which inferences
should be computed.  Default selection of 'all' forces script to
compute inferences for all samples in the matrix.</p>
</td></tr>
<tr><td><code id="mlsolve_+3A_coef0">coef0</code></td>
<td>
<p>Coefficient file with model specifications and regression
coefficients defining 
taxon-environment relationships. See <code><a href="#topic+taxon.env">taxon.env</a></code> for
more details.</p>
</td></tr>
<tr><td><code id="mlsolve_+3A_bruteforce">bruteforce</code></td>
<td>
<p>Logical flag.  Select <code>TRUE</code> to compute solution by
brute force rather than by conjugate gradients.  Provides a means of
examining likelihood contours when needed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>mlsolve</code> uses maximum likelihood estimation to infer environmental
conditions from biological observations.  Maximum likelihood
estimation in this context is a constrained optimization problem, in
which we wish find the point at which the likelihood function is
maximized, constrained by the range of the environmental variables in
the calibration data.  <code>mlsolve</code> formulates the likelihood
function and calls <code><a href="stats.html#topic+optim">optim</a></code> to solve the optimization
problem.
</p>
<p>The option <code>bruteforce</code> can be used to check the performance of the
iterative solver.  When <code>bruteforce</code> is set to be <code>TRUE</code>,
the script also 
computes likelihood values for a uniformly-spaced grid that spans the
ranges of the environmental variables.  This is a time-consuming
calculation, and therefore should only be attempted on a few samples.
Once the grid is computed, though, contours of the likelihood surface
are plotted.
</p>
<p><code>mlsolve</code> requires that the taxa included in <code>ss</code> each have
associated taxon-environment information in <code>coef0</code>.  The best
way to ensure that this condition is satisfied is to make sure that
<code><a href="#topic+get.otu">get.otu</a></code> is run with the same <code>coef0</code> as used in
<code>mlsolve</code>, and that the results from <code>get.otu</code> are used to
generate <code>ss</code> (see <code><a href="#topic+makess">makess</a></code>). 
</p>


<h3>Value</h3>

 
<p>The script returns a dataframe containing inferences for each sample as
well as a logical flag indicating whether solutions computing with four
different starting locations are consistent with one another.
</p>


<h3>Author(s)</h3>

<p>Lester L. Yuan
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(coef.west.wt)
data(ss.OR)
inf.out &lt;- mlsolve(ss.OR, coef.west.wt)
</code></pre>

<hr>
<h2 id='modalDialog'>Modal dialog box using TclTK</h2><span id='topic+modalDialog'></span>

<h3>Description</h3>

<p><code>modalDialog</code> generates a dialog box prompting the user to
enter a list of text before the process continues.  Based on scripts
provided in http://bioinf.wehi.edu.au/~wettenhall/RTclTkExamples/
</p>


<h3>Usage</h3>

<pre><code class='language-R'>modalDialog(title,itemlist,entryInit,entryWidth=20,
                        returnValOnCancel="ID_CANCEL")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="modalDialog_+3A_title">title</code></td>
<td>
<p>Title for the dialog box</p>
</td></tr>
<tr><td><code id="modalDialog_+3A_itemlist">itemlist</code></td>
<td>
<p>Character vector of names that the user must correct</p>
</td></tr>
<tr><td><code id="modalDialog_+3A_entryinit">entryInit</code></td>
<td>
<p>Default string to fill in the entries</p>
</td></tr>
<tr><td><code id="modalDialog_+3A_entrywidth">entryWidth</code></td>
<td>
<p>Width of entry string</p>
</td></tr>
<tr><td><code id="modalDialog_+3A_returnvaloncancel">returnValOnCancel</code></td>
<td>
<p>Value for script to return if canceled</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Character vector of user entries.
</p>


<h3>Author(s)</h3>

<p>Lester L. Yuan
</p>

<hr>
<h2 id='output.tax.table'>Output final taxonomic table</h2><span id='topic+output.tax.table'></span>

<h3>Description</h3>

<p>Output final taxonomic table as tab-delimited text
</p>


<h3>Usage</h3>

<pre><code class='language-R'>output.tax.table(finaltab, tlevs)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="output.tax.table_+3A_finaltab">finaltab</code></td>
<td>
<p>Merged taxonomic table</p>
</td></tr>
<tr><td><code id="output.tax.table_+3A_tlevs">tlevs</code></td>
<td>
<p>Character vector of taxonomic levels in ITIS</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Outputs final table to file.
</p>


<h3>Value</h3>

<p>None. Used for side effects.
</p>


<h3>Author(s)</h3>

<p>Lester L. Yuan</p>

<hr>
<h2 id='parse.taxon.name'>Parse taxon name</h2><span id='topic+parse.taxon.name'></span>

<h3>Description</h3>

<p>Parses taxon names from benthic count file to facilitate matching with
ITIS.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>parse.taxon.name(tname.orig)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="parse.taxon.name_+3A_tname.orig">tname.orig</code></td>
<td>
<p>Character vector of taxon names</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Parses compound names typically found in benthic count files into
a list of strings for each name.
</p>


<h3>Value</h3>

<p>Returns a matrix in which each row corresponds with a different
element of the provided character vector, and each column corresponds
to distinct strings in each element.
</p>


<h3>Author(s)</h3>

<p>Lester L. Yuan</p>

<hr>
<h2 id='remove.dupes'>Remove unselected duplicates from taxon table</h2><span id='topic+remove.dupes'></span>

<h3>Description</h3>

<p>Remove unselected duplicate taxon names from taxon table.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>remove.dupes(fulltab, dupe.list, dupe.sel)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="remove.dupes_+3A_fulltab">fulltab</code></td>
<td>
<p>Full taxon table for matched taxon names.</p>
</td></tr>
<tr><td><code id="remove.dupes_+3A_dupe.list">dupe.list</code></td>
<td>
<p>List of duplicated entries.</p>
</td></tr>
<tr><td><code id="remove.dupes_+3A_dupe.sel">dupe.sel</code></td>
<td>
<p>Character vector of taxa selected by user.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Deletes rows from fulltab that are not selected by user
</p>


<h3>Value</h3>

<p>Returns revised fulltab.
</p>


<h3>Author(s)</h3>

<p>Lester L. Yuan</p>

<hr>
<h2 id='resolve.mult'>Resolve cases in which two taxa are found in ITIS</h2><span id='topic+resolve.mult'></span>

<h3>Description</h3>

<p>Resolves cases in which two taxa listed on the same entry are both
found in ITIS. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>resolve.mult(parse.list, get.tax.env)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="resolve.mult_+3A_parse.list">parse.list</code></td>
<td>
<p>List of taxa that are found in ITIS (position 1)and
taxa that are still unresolved (position 2).</p>
</td></tr>
<tr><td><code id="resolve.mult_+3A_get.tax.env">get.tax.env</code></td>
<td>
<p>Environment variable where the full ITIS taxon
table is available</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The most likely reason for two valid taxa being listed in the same
entry is that the taxonomist could only identify a specimen down to
two possibilities.  In these cases, the script downgrades the
identification to a coarser level that is the same for both taxa.
</p>


<h3>Value</h3>

<p>Updates parse.list so that resolved multiple listings are included in
position 1.
</p>


<h3>Author(s)</h3>

<p>Lester L. Yuan</p>

<hr>
<h2 id='sel.coeffile'>Select coefficient file</h2><span id='topic+sel.coeffile'></span>

<h3>Description</h3>

<p>Prompt user to select coefficient file from those available in data directory
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sel.coeffile(fstring = "coef")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sel.coeffile_+3A_fstring">fstring</code></td>
<td>
<p>Character string for filtering files in data directory</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Provides the list of data files available to the user.
</p>


<h3>Value</h3>

<p>Selected file name.
</p>


<h3>Author(s)</h3>

<p>Lester L. Yuan</p>

<hr>
<h2 id='ss.OR'>site-OTU matrix for western Oregon</h2><span id='topic+ss.OR'></span>

<h3>Description</h3>

<p>Matrix with each row representing a distinct sample and each colum
representing a different OTU for western Oregon benthic count data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ss.OR)</code></pre>


<h3>Source</h3>

<p>Oregon Department of Environmental Quality
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ss.OR)
</code></pre>

<hr>
<h2 id='taxon.env'>Estimate taxon-environment relationships</h2><span id='topic+taxon.env'></span>

<h3>Description</h3>

<p><code>taxon.env</code> estimates taxon-environment relationships using
logistic regression.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>taxon.env(form, bcnt, envdata, bcnt.siteid, bcnt.abndid,
env.siteid,tlevs = "all", dumpdata = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="taxon.env_+3A_form">form</code></td>
<td>
<p>Regression
formula for model.
Format is identical to that used for <code>glm</code>. </p>
</td></tr>
<tr><td><code id="taxon.env_+3A_bcnt">bcnt</code></td>
<td>
<p>A benthic count file with a full taxonomic hierarchy  that
results from running <code><a href="#topic+get.taxonomic">get.taxonomic</a></code>.</p>
</td></tr>
<tr><td><code id="taxon.env_+3A_envdata">envdata</code></td>
<td>
<p>Environmental data file</p>
</td></tr>
<tr><td><code id="taxon.env_+3A_bcnt.siteid">bcnt.siteid</code></td>
<td>
<p>Field name for <code>bcnt</code> unique site identifier.</p>
</td></tr>
<tr><td><code id="taxon.env_+3A_bcnt.abndid">bcnt.abndid</code></td>
<td>
<p>Field name for <code>bcnt</code> taxon abundance.</p>
</td></tr>
<tr><td><code id="taxon.env_+3A_env.siteid">env.siteid</code></td>
<td>
<p>Field name for <code>envdata</code> unique site
identifier.</p>
</td></tr>
<tr><td><code id="taxon.env_+3A_tlevs">tlevs</code></td>
<td>
<p>Taxonomic levels to compute taxon-environment
relationships.</p>
</td></tr>
<tr><td><code id="taxon.env_+3A_dumpdata">dumpdata</code></td>
<td>
<p>Logical field specifying whether data used to estimate
taxon-environment relationships should be included in the output.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This script generates logistic regression models for taxa at various levels of
taxonomic resolution (as specified by the user).  The script
computes the degrees of freedom specified by the model ($df$) and
selects taxa that occur in at least 10 times df and is absent from at
least 10 times df sites.  Then, logistic regression models based on
the formula specified by the user are
computed for each taxon using <code><a href="stats.html#topic+glm">glm</a></code>.
The user can select the taxonomic levels (e.g., CLASS, ORDER, SPECIES,
etc.) at which taxon-environment relationships are computed using the
parameter <code>tlevs</code>.  The default value for <code>tlevs</code> computes
relationships at all levels.
</p>


<h3>Value</h3>

<p>Regression coefficient file that can be used with <code>mlsolve</code> to
infer environmental conditions.
</p>
<table>
<tr><td><code>tnames</code></td>
<td>
<p>Taxon names for which models are calculated</p>
</td></tr>
<tr><td><code>csave</code></td>
<td>
<p>Matrix of regression coefficients</p>
</td></tr>
<tr><td><code>xvar</code></td>
<td>
<p>Character vector with names of explanatory variables</p>
</td></tr>
<tr><td><code>xlims</code></td>
<td>
<p>Range of each explanatory variable</p>
</td></tr>
<tr><td><code>form</code></td>
<td>
<p>Model formula</p>
</td></tr>
<tr><td><code>roc</code></td>
<td>
<p>Area under receiver operator curve for model for each
taxon.</p>
</td></tr>
<tr><td><code>raw.data</code></td>
<td>
<p>Data used to estimate relationships.  Only included if
<code>dumpdata = T</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Lester L. Yuan
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get.taxonomic">get.taxonomic</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(envdata.OR)
data(bcnt.tax.OR)
coef &lt;- taxon.env(~sed + sed^2, bcnt.tax.OR, envdata.OR, "SVN",
"CountValue", "STRM.ID")
</code></pre>

<hr>
<h2 id='tklist.modal'>Modal select list dialog using TclTk</h2><span id='topic+tklist.modal'></span>

<h3>Description</h3>

<p><code>tklist.modal</code> generates a dialog box that prompts the user to
select from a list of options.  This script uses TclTk tools that
should be operable on different operating systems.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tklist.modal(title, elements0, returnValOnCancel="ID_CANCEL",selectmode =
"single")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tklist.modal_+3A_title">title</code></td>
<td>
<p>Title for the list box.</p>
</td></tr>
<tr><td><code id="tklist.modal_+3A_elements0">elements0</code></td>
<td>
<p>Character vector of elements listing different
choices</p>
</td></tr>
<tr><td><code id="tklist.modal_+3A_returnvaloncancel">returnValOnCancel</code></td>
<td>
<p>Character string returned by the script if
the dialog box is canceled</p>
</td></tr>
<tr><td><code id="tklist.modal_+3A_selectmode">selectmode</code></td>
<td>
<p>Set to multiple to allow for multiple selections.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A TclTk dialog box.
</p>


<h3>Author(s)</h3>

<p>Lester L. Yuan
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
tklist.modal("Select a color", c("red", "green", "blue"))

## End(Not run)
</code></pre>

<hr>
<h2 id='trait.feeding'>Feeding traits for benthic invertebrates</h2><span id='topic+trait.feeding'></span>

<h3>Description</h3>

<p>Feeding classifications for different benthic invertebrates. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(trait.feeding)</code></pre>


<h3>Format</h3>

<p>A data frame with two columns.
</p>

<dl>
<dt><code>TAXON</code></dt><dd><p>Character vector with the names of each taxon.</p>
</dd>
<dt><code>TRAITVAL</code></dt><dd><p>Value of trait classification</p>
</dd>
</dl>



<h3>Details</h3>

<p>These trait classifications were summarized from the USGS data set
prepared by Viera et al. <a href="http://pubs.usgs.gov/ds/ds187/">http://pubs.usgs.gov/ds/ds187/</a>.
</p>


<h3>Source</h3>

<p>Yuan, L.L.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(trait.feeding)
</code></pre>

<hr>
<h2 id='trait.habit'>Habit traits for benthic invertebrates</h2><span id='topic+trait.habit'></span>

<h3>Description</h3>

<p>Habit classifications for different benthic invertebrates. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(trait.habit)</code></pre>


<h3>Format</h3>

<p>A data frame with two columns.
</p>

<dl>
<dt><code>TAXON</code></dt><dd><p>Character vector with the names of each taxon.</p>
</dd>
<dt><code>TRAITVAL</code></dt><dd><p>Value of trait classification</p>
</dd>
</dl>



<h3>Details</h3>

<p>These trait classifications were summarized from the USGS data set
prepared by Viera et al. <a href="http://pubs.usgs.gov/ds/ds187/">http://pubs.usgs.gov/ds/ds187/</a>.
</p>


<h3>Source</h3>

<p>Yuan, L.L.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(trait.habit)
</code></pre>

<hr>
<h2 id='trait.stat'>Compute trait metrics</h2><span id='topic+trait.stat'></span>

<h3>Description</h3>

<p>Compute trait metrics from benthic count data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trait.stat(bcnt.otu, coefs)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="trait.stat_+3A_bcnt.otu">bcnt.otu</code></td>
<td>
<p>Benthic count file with OTU defined consistently with selected trait file</p>
</td></tr>
<tr><td><code id="trait.stat_+3A_coefs">coefs</code></td>
<td>
<p>Trait file</p>
</td></tr>
</table>


<h3>Details</h3>

<p>OTUs appropriate for the selected trait file must first be assigned
using <code><a href="#topic+get.otu">get.otu</a></code>.  A list of trait files provided in the
library can be obtained using <code><a href="#topic+sel.coeffile">sel.coeffile</a></code>.  Script will
compute richness, relative richness, and relative abundance of each
trait group.  Note that many taxa in a benthic count file are often
not assigned to traits, and so relative richness and relative
abundance values within a given sample may not sum to 1.
</p>


<h3>Value</h3>

<p>Data frame of trait metrics.
</p>


<h3>Author(s)</h3>

<p>Lester L. Yuan</p>

<hr>
<h2 id='view.te'>View taxon-environment relationships</h2><span id='topic+view.te'></span>

<h3>Description</h3>

<p>Viewer for taxon-environment relationships.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>view.te(coef, plotform = "pdf")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="view.te_+3A_coef">coef</code></td>
<td>
<p>Taxon-environment coefficient file
(e.g. <code><a href="#topic+coef.west.wt">coef.west.wt</a></code>)</p>
</td></tr>
<tr><td><code id="view.te_+3A_plotform">plotform</code></td>
<td>
<p>Specify output plot format.  Options include pdf and
windows.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generates contour plots that show taxon-environment relationships
represented by taxon-environment coefficients.  Models with a single
explanaotry variable are displayed as line plots, and models with two
explanatory variables are displayed as contour plots.
Plots are returned returned the file <code>taxon.env.pdf</code> is
<code>plotform = "pdf"</code>.
</p>


<h3>Value</h3>

<p>None.  Used for side effects.
</p>


<h3>Author(s)</h3>

<p>Lester L. Yuan</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(coef.west.wt)
view.te(coef.west.wt)
## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
