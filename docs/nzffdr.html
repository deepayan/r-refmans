<!DOCTYPE html><html lang="en"><head><title>Help for package nzffdr</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {nzffdr}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#nzffdr_add_dates'><p>Add dates to a NZFFD dataset</p></a></li>
<li><a href='#nzffdr_clean'><p>Clean NZ Freshwater Fish Datasets</p></a></li>
<li><a href='#nzffdr_data'><p>Sample NZFFD data.</p></a></li>
<li><a href='#nzffdr_get_table'><p>Get NZFFD search terms</p></a></li>
<li><a href='#nzffdr_import'><p>Import NZ Freshwater Fish datasets.</p></a></li>
<li><a href='#nzffdr_ind_lengths'><p>Fish length to tidy long format</p></a></li>
<li><a href='#nzffdr_nzmap'><p>Simple features map of New Zealand</p></a></li>
<li><a href='#nzffdr_razzle_dazzle'><p>Wrapper for multiple nzffdr functions</p></a></li>
<li><a href='#nzffdr_taxon_threat'><p>Add taxonomic and threat status data</p></a></li>
<li><a href='#nzffdr_widen_habitat'><p>Converts habitat variables to tidy wide format</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Import, Clean and Update Data from the New Zealand Freshwater
Fish Database</td>
</tr>
<tr>
<td>Version:</td>
<td>2.1.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Access the New Zealand Freshwater Fish Database from R and a few functions to clean the data once in R.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>curl, httr, rlang, stringi, tidyr, utils, xml2</td>
</tr>
<tr>
<td>Suggests:</td>
<td>devtools, knitr, rmarkdown, roxygen2,</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://flee598.github.io/nzffdr/">https://flee598.github.io/nzffdr/</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-11-08 06:46:18 UTC; Finn</td>
</tr>
<tr>
<td>Author:</td>
<td>Finnbar Lee [aut, cre],
  Nick Young [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Finnbar Lee &lt;lee.finnbar@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-11-08 09:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='nzffdr_add_dates'>Add dates to a NZFFD dataset</h2><span id='topic+nzffdr_add_dates'></span>

<h3>Description</h3>

<p>Add year, month and day columns to a NZFFD dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nzffdr_add_dates(fishd)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nzffdr_add_dates_+3A_fishd">fishd</code></td>
<td>
<p>a dataframe imported from the NZFFD using <code>nzffdr_import()</code>, which contains the column <code>"eventDate"</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Adds year, month and day columns to a NZFFD dataset, based on values in 
the &quot;eventDate&quot; column.
</p>


<h3>Value</h3>

<p>a NZFFD dataframe, with year, month and day columns added.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>nzffdr_add_dates(nzffdr::nzffdr_data)

</code></pre>

<hr>
<h2 id='nzffdr_clean'>Clean NZ Freshwater Fish Datasets</h2><span id='topic+nzffdr_clean'></span>

<h3>Description</h3>

<p>Clean up data imported from the NZ Freshwater Fish Database.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nzffdr_clean(fishd)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nzffdr_clean_+3A_fishd">fishd</code></td>
<td>
<p>a dataframe imported from the NZFFD using <code>nzffdr_import()</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Cleans up a few inconsistencies in the NZFFD data returned from
<code>nzffd_import()</code>. Column types are checked and converted to, integer,
numeric or character. Empty cells are filled with NA, variable 'catchmentName'
entries are standardised (e.g. Clutha r, Clutha River and Clutha R all
become Clutha R) and, any empty columns are removed.
</p>


<h3>Value</h3>

<p>A cleaned NZFFD dataframe.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>nzffdr_clean(nzffdr::nzffdr_data)

</code></pre>

<hr>
<h2 id='nzffdr_data'>Sample NZFFD data.</h2><span id='topic+nzffdr_data'></span>

<h3>Description</h3>

<p>Sample NZFFD data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(nzffdr_data)
</code></pre>


<h3>Format</h3>

<p>A dataframe of 200 rows and 67 variables.
</p>


<h3>Source</h3>

<p><a href="https://niwa.co.nz">NIWA</a>
</p>

<hr>
<h2 id='nzffdr_get_table'>Get NZFFD search terms</h2><span id='topic+nzffdr_get_table'></span>

<h3>Description</h3>

<p>Lists of possible argument options for function <code>nzffdr_import()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nzffdr_get_table(x = c("fish_method", "institution", "taxon"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nzffdr_get_table_+3A_x">x</code></td>
<td>
<p>one of &quot;fish_method&quot;, &quot;institution&quot; or &quot;taxon&quot;, depending on
which argument values are wanted.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Returns the possible argument values for arguments: fish_method, 
institution and taxon, used in the function <code>nzffdr_import()</code>.
</p>
<p>This function requires an internet connection to query NIWA's database.
</p>


<h3>Value</h3>

<p>A dataframe or character string of argument options.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

dat &lt;- nzffdr_get_table("taxon")


## End(Not run)
</code></pre>

<hr>
<h2 id='nzffdr_import'>Import NZ Freshwater Fish datasets.</h2><span id='topic+nzffdr_import'></span>

<h3>Description</h3>

<p>Import data from the NZ Freshwater Fish Database. Enter search terms as 
arguments as you would in the NZFFD and import directly into R. You can 
search using all the same query options which are
used for in the <a href="https://nzffdms.niwa.co.nz/search">NZFFFD</a>, see their
<a href="https://niwa.co.nz/information-services/nz-freshwater-fish-database">info page</a> 
for details. To import the entire database leave all arguments as default.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nzffdr_import(
  institution = "",
  catchment_num = "",
  catchment_name = "",
  water_body = "",
  fish_method = "",
  taxon = "",
  starts = "",
  ends = "",
  download_format = "all"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nzffdr_import_+3A_institution">institution</code></td>
<td>
<p>institution that collected the data. Use the
<code>nzffdr_get_table("institution")</code> function to see a list of all possible options,
or don't set the arg if you want all institutions in the database.</p>
</td></tr>
<tr><td><code id="nzffdr_import_+3A_catchment_num">catchment_num</code></td>
<td>
<p>catchment number. A 6 digit number unique to the reach of
interest. You can search using the individual number (e.g. <code>catchment =
"702.500"</code>), or for all rivers in a catchment you can use the wildcard
search term (e.g. <code>catchment = "702%"</code>), or don't set the arg if you
want all catchments in the database.</p>
</td></tr>
<tr><td><code id="nzffdr_import_+3A_catchment_name">catchment_name</code></td>
<td>
<p>catchment name. e.g. <code>catchment_name = "Hinds R"</code>. 
Case sensitive. Don't set the arg if you want all catchments in the database.</p>
</td></tr>
<tr><td><code id="nzffdr_import_+3A_water_body">water_body</code></td>
<td>
<p>water body name. e.g. to get all records for Limestone
Creek, <code>water_body = "Limestone Creek"</code>. Don't set the arg if you
want all water bodies in the database.</p>
</td></tr>
<tr><td><code id="nzffdr_import_+3A_fish_method">fish_method</code></td>
<td>
<p>fishing method used. Use the <code>nzffdr_get_table("fish_method")</code> 
function to see a list of all possible options. If you only want fish caught
be lures use <code>fish_meth = "Angling - Lure"</code>, don't set the arg if
you want all fishing methods in the database.</p>
</td></tr>
<tr><td><code id="nzffdr_import_+3A_taxon">taxon</code></td>
<td>
<p>taxon of interest. Use the <code>nzffdr_get_table("taxon")</code> function
to see a list of all possible options. You can search using either 
common or scientific names and can search for multiple taxon at 
once, e.g. to search for Black mudfish use <code>taxon = "Black mudfish"</code> 
or <code>taxon = "Neochanna diversus"</code> and to search for Black mudfish
and Bluegill bully use <code>taxon = c("Black mudfish", "Bluegill bully")</code> 
etc.</p>
</td></tr>
<tr><td><code id="nzffdr_import_+3A_starts">starts</code></td>
<td>
<p>start year. Don't set the arg if
you want all records in the database.</p>
</td></tr>
<tr><td><code id="nzffdr_import_+3A_ends">ends</code></td>
<td>
<p>end year. Don't set the arg if
you want all records in the database.</p>
</td></tr>
<tr><td><code id="nzffdr_import_+3A_download_format">download_format</code></td>
<td>
<p>use &quot;all&quot; or &quot;essential&quot; to download either, all 
variables (67 columns), which now includes some River Environment
Classification data, or just essential data (23 columns).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function requires an internet connection to query NIWA's database.
</p>
<p>Data citation: Stoffels R (2022). New Zealand Freshwater Fish Database (extended).
The National Institute of Water and Atmospheric Research (NIWA).
Sampling event dataset https://doi.org/10.15468/jbpw92
</p>


<h3>Value</h3>

<p>A dataframe where each row is a NZFFD record.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# import entire NZFFD
dat &lt;- nzffdr_import()

## End(Not run)
</code></pre>

<hr>
<h2 id='nzffdr_ind_lengths'>Fish length to tidy long format</h2><span id='topic+nzffdr_ind_lengths'></span>

<h3>Description</h3>

<p>Converts individual fish length measures from multiple entries in
a single cell to tidy long format.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nzffdr_ind_lengths(fishd)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nzffdr_ind_lengths_+3A_fishd">fishd</code></td>
<td>
<p>an NZFFD dataframe returned from nzffdr_import(). Must contain
the columns &quot;nzffdRecordNumber&quot;, &quot;taxonName&quot; and &quot;indLengths&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe with three columns,&quot;nzffdRecordNumber&quot;, &quot;taxonName&quot; and
&quot;indLengths&quot;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>nzffdr_ind_lengths(nzffdr::nzffdr_data)
</code></pre>

<hr>
<h2 id='nzffdr_nzmap'>Simple features map of New Zealand</h2><span id='topic+nzffdr_nzmap'></span>

<h3>Description</h3>

<p>A simple features map of New Zealand. A simplified version of the 1:150k
NZ map outline available from Land Information New Zealand.
CRS: NZ Transverse Mercator (NZTM: EPSG 2193).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nzffdr_nzmap
</code></pre>


<h3>Format</h3>

<p>A simple features dataframe with 4 rows and 2 columns:
</p>

<dl>
<dt>island</dt><dd><p>Island name</p>
</dd>
<dt>geometry</dt><dd><p>Line geometry</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="https://data.linz.govt.nz">https://data.linz.govt.nz</a>
</p>

<hr>
<h2 id='nzffdr_razzle_dazzle'>Wrapper for multiple nzffdr functions</h2><span id='topic+nzffdr_razzle_dazzle'></span>

<h3>Description</h3>

<p>Wraps multiple nzffdr functions allowing, importing, cleaning and adding
of new information all in one step.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nzffdr_razzle_dazzle()
</code></pre>


<h3>Details</h3>

<p>Wraps: [nzffdr_import()], [nzffdr_clean()], [nzffdr_add_date()],
[nzffdr_taxon_threat()], [nzffdr_widen_habitat()] and runs the lot
in one go, returning a downloaded and cleaned NZFFD dataset.
</p>
<p>This function requires an internet connection to query the NZFFD
</p>


<h3>Value</h3>

<p>An NZFFD dataframe which has been cleaned and had date, taxonomic and 
threat classification status data added.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
dat &lt;- nzffdr_razzle_dazzle()

## End(Not run)
</code></pre>

<hr>
<h2 id='nzffdr_taxon_threat'>Add taxonomic and threat status data</h2><span id='topic+nzffdr_taxon_threat'></span>

<h3>Description</h3>

<p>Adds additional common and scientific names, and threat classification status
information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nzffdr_taxon_threat(fishd)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nzffdr_taxon_threat_+3A_fishd">fishd</code></td>
<td>
<p>A dataframe imported from the NZFFD using <code>nzffd_import</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Adds additional taxonomic data (&quot;commonMaoriName&quot;, &quot;alternativeNames&quot;,
&quot;species&quot;, &quot;genus&quot;, &quot;family&quot;, &quot;order&quot;, &quot;class&quot;, &quot;phylum&quot;) and NZ Threat 
Classification Status information (&quot;category&quot;, &quot;status&quot;, &quot;taxonomicStatus&quot;,
&quot;bioStatus&quot;). See <a href="https://nztcs.org.nz/home">NZTCS</a> for details
regarding the NZTCS variables.
</p>


<h3>Value</h3>

<p>An NZFFD dataframe, with 12 additional columns.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>nzffdr_taxon_threat(nzffdr::nzffdr_data)
</code></pre>

<hr>
<h2 id='nzffdr_widen_habitat'>Converts habitat variables to tidy wide format</h2><span id='topic+nzffdr_widen_habitat'></span>

<h3>Description</h3>

<p>Converts habitat variables to tidy wide format columns and appends to 
original dataframe. Warning, with large (&gt;100k rows) datasets this function 
slow (~30 seconds).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nzffdr_widen_habitat(
  fishd,
  cols_to_expand = c("habitatFlowPercent", "habitatInstreamCoverPresent",
    "habitatRiparianVegPercent", "habitatSubstratePercent")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nzffdr_widen_habitat_+3A_fishd">fishd</code></td>
<td>
<p>an NZFFD dataframe returned from nzffdr_import.</p>
</td></tr>
<tr><td><code id="nzffdr_widen_habitat_+3A_cols_to_expand">cols_to_expand</code></td>
<td>
<p>the habitat columns to expand, can be any combination
of &quot;habitatFlowPercent&quot;, &quot;habitatInstreamCoverPresent&quot;,
&quot;habitatRiparianVegPercent&quot;, &quot;habitatSubstratePercent&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An NZFFD dataframe with added wide format columns for each of the 
selected habitat columns.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>nzffdr_widen_habitat(nzffdr::nzffdr_data)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
