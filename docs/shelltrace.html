<!DOCTYPE html><html><head><title>Help for package shelltrace</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {shelltrace}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#BMP'><p>BMP image of phase map of cross section of modern oyster.</p></a></li>
<li><a href='#cross_section'><p>Digitized growth increments in cross section of modern oyster rescaled to</p>
the same X-axis.</a></li>
<li><a href='#el_time'><p>Matrix listing the concentrations of elements in every subincrement</p></a></li>
<li><a href='#image_length'><p>Length (in mm) of the digitized phase map image.</p></a></li>
<li><a href='#IncG'><p>Interpolated subincrements in cross section of modern oyster rescaled to</p>
the same X-axis.</a></li>
<li><a href='#incr_matrix0'><p>Matrix containing data calculated for each growth band.</p></a></li>
<li><a href='#incr_matrix1'><p>Matrix containing data calculated for each growth band.</p></a></li>
<li><a href='#incr_matrix2'><p>Matrix containing data calculated for each growth band.</p></a></li>
<li><a href='#incr_matrix3'><p>Matrix containing data calculated for each growth band.</p></a></li>
<li><a href='#lengthfactor'><p>Multiplier used to convert shell cross section from pixels to mm</p></a></li>
<li><a href='#M_el_mat'><p>Matrix of modelled mass accumulation rates per trace element</p></a></li>
<li><a href='#M_el_mat_c'><p>Matrix of modelled cumulative mass accumulation rates per trace element</p></a></li>
<li><a href='#O1_input'><p>Digitized growth increments in cross section of modern oyster.</p></a></li>
<li><a href='#O1_phase'><p>Characteristics of phase in XRF map of oyster</p></a></li>
<li><a href='#Oyster_accumulation'><p>Calculate trace element accumulation rates</p></a></li>
<li><a href='#Oyster_combined_run'><p>Runs the growth and trace element model</p></a></li>
<li><a href='#Oyster_Convert_cross_section'><p>Function that converts XY-data of digitized cross section</p></a></li>
<li><a href='#Oyster_el_time'><p>Calculate concentrations of trace elements per sub-increment</p></a></li>
<li><a href='#Oyster_ellipse_parameters'><p>Function that calculates the parameters of the base ellipse used for</p>
bivalve growth modelling</a></li>
<li><a href='#Oyster_Export'><p>Function that exports data of the growth model</p></a></li>
<li><a href='#Oyster_growth_run'><p>Runs the entire growth model</p></a></li>
<li><a href='#Oyster_height'><p>Measured height of the shell</p></a></li>
<li><a href='#Oyster_import_BMP'><p>Function that imports a BMP of an XRF map</p></a></li>
<li><a href='#Oyster_import_phases'><p>Function that imports phase data</p></a></li>
<li><a href='#Oyster_import_TIF'><p>Function that imports a TIF file</p></a></li>
<li><a href='#Oyster_incr_area'><p>Area between shell increments</p></a></li>
<li><a href='#Oyster_incr_cross_section'><p>Formula that interpolates shell increments</p></a></li>
<li><a href='#Oyster_length'><p>Measured length of the shell</p></a></li>
<li><a href='#Oyster_Mass_gain'><p>Formula that calculates mass increase of bivalve shell with time</p></a></li>
<li><a href='#Oyster_phase_export'><p>Export results of trace element model</p></a></li>
<li><a href='#Oyster_phase_matrix_BMP'><p>Function that calculates phase matrix</p></a></li>
<li><a href='#Oyster_phase_matrix_TIF'><p>Function that calculates phase matrix</p></a></li>
<li><a href='#Oyster_phase_run'><p>Runs the entire trace element model</p></a></li>
<li><a href='#Oyster_phase_stats'><p>Function that exports phase statistics</p></a></li>
<li><a href='#Oyster_plot_cross_section'><p>Plot the converted shell cross section</p></a></li>
<li><a href='#Oyster_plot_incr_CS'><p>Plot the result of interpolation of sub-increments</p></a></li>
<li><a href='#Oyster_plot_incr_fill'><p>Plot the result of interpolation of sub-increments with a coloured</p>
area plot</a></li>
<li><a href='#Oyster_run_sec2'><p>Runs complete Step 2 of the growth model</p></a></li>
<li><a href='#Oyster_run_sec3'><p>Runs complete Step 3 of the growth model</p></a></li>
<li><a href='#Oyster_run_sec4'><p>Runs complete Step 4 of the growth model</p></a></li>
<li><a href='#Oyster_run_sec5'><p>Runs complete Step 5 of the trace element model</p></a></li>
<li><a href='#Oyster_run_sec6'><p>Runs complete Step 6 of the trace element model</p></a></li>
<li><a href='#Oyster_Shell_height'><p>Formula that calculates shell height through time</p></a></li>
<li><a href='#Oyster_Shell_thickness'><p>Formula that calculates average shell thickness through time</p></a></li>
<li><a href='#Oyster_subincr_area'><p>Formula that calculates area between sub-increments</p></a></li>
<li><a href='#Oyster_subincr_av_thickness'><p>Formula that calculates average shell thickness through time</p></a></li>
<li><a href='#Oyster_subincr_av_thickness_X'><p>Formula that calculates average shell thickness through time</p></a></li>
<li><a href='#Oyster_subincr_phases'><p>Calculates proportion of phases in each sub-increment</p></a></li>
<li><a href='#Oyster_subincr_shell_height'><p>A fomula to calculate shell height per sub-increment</p></a></li>
<li><a href='#Oyster_Volumes'><p>Formula that calculates volume of the shell through time</p></a></li>
<li><a href='#Oyster_Z_matrices'><p>Function that calculates matrices of Z-values for all sub-increments and</p>
all X-values</a></li>
<li><a href='#phase_mat'><p>Matrix listing the amount of pixels of each phase in every subincrement</p></a></li>
<li><a href='#phase_stat'><p>Statistics of elemental concentrations in XRF map of oyster</p></a></li>
<li><a href='#phasemat'><p>Matrix of phases names for each pixel in the phase map</p></a></li>
<li><a href='#pixelsize'><p>Size of pixels in phase map in mm</p></a></li>
<li><a href='#pma'><p>Function to do an n-point moving average</p></a></li>
<li><a href='#ShellTrace'><p>ShellTrace: Growth and trace element uptake modelling in bivalve shells</p></a></li>
<li><a href='#subincr_matrix0'><p>Matrix containing data calculated for each growth band.</p></a></li>
<li><a href='#subincr_matrix1'><p>Matrix containing data calculated for each growth band.</p></a></li>
<li><a href='#subincr_matrix2'><p>Matrix containing data calculated for each growth band.</p></a></li>
<li><a href='#subincr_matrix3'><p>Matrix containing data calculated for each growth band.</p></a></li>
<li><a href='#subincr_matrix4'><p>Matrix containing data calculated for each growth band.</p></a></li>
<li><a href='#subincr_matrix5'><p>Matrix containing data calculated for each growth band.</p></a></li>
<li><a href='#subincr_matrix6'><p>Matrix containing data calculated for each growth band.</p></a></li>
<li><a href='#TIF'><p>TIF image of phase map of cross section of modern oyster.</p></a></li>
<li><a href='#Z_mat'><p>Z-values describing the base ellipse of the oyster</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Bivalve Growth and Trace Element Accumulation Model</td>
</tr>
<tr>
<td>Version:</td>
<td>3.5.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2017-09-27</td>
</tr>
<tr>
<td>Author:</td>
<td>Niels J. de Winter</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Niels J. de Winter &lt;niels.de.winter@vub.be&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.1.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>xlsx, bmp, tiff, grDevices, stats</td>
</tr>
<tr>
<td>Description:</td>
<td>
    Contains all the formulae of the growth and trace element uptake model described in the equally-named
    Geoscientific Model Development paper (de Winter, 2017, &lt;<a href="https://doi.org/10.5194%2Fgmd-2017-137">doi:10.5194/gmd-2017-137</a>&gt;). The model takes as input a file with X- and Y-coordinates of digitized
    growth increments recognized on a longitudinal cross section through the bivalve shell, as well as a BMP file of an elemental map of the
    cross section surface with chemically distinct phases separated by phase analysis. It proceeds by a step-by-step process described in
    the paper, by which digitized growth increments are used to calculate changes in shell height, shell thickness, shell volume, shell mass
    and shell growth rate through the bivalve's life time. Then, results of this growth modelling are combined with the trace element mapping
    results to trace the incorporation of trace elements into the bivalve shell. Results of various modelling parameters can be exported in
    the form of XLSX files.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/nielsjdewinter/ShellTrace">https://github.com/nielsjdewinter/ShellTrace</a>,
<a href="https://doi.org/10.5194/gmd-2017-137-supplement">https://doi.org/10.5194/gmd-2017-137-supplement</a>,
<a href="http://nidewint.wixsite.com/nielsdewinter">http://nidewint.wixsite.com/nielsdewinter</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/nielsjdewinter/ShellTrace/issues">https://github.com/nielsjdewinter/ShellTrace/issues</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.0.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2017-10-06 11:17:04 UTC; Niels</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2017-10-06 11:35:20 UTC</td>
</tr>
</table>
<hr>
<h2 id='BMP'>BMP image of phase map of cross section of modern oyster.</h2><span id='topic+BMP'></span>

<h3>Description</h3>

<p>An image of the microXRF phase map of the cross section used for this model
from the Crassostre gigas #1 oyster used as an example in de Winter (2017)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(BMP)
</code></pre>


<h3>Format</h3>

<p>A BMP image imported into R as a large data array</p>


<h3>Source</h3>

<p><a href="https://doi.org/10.5194/gmd-2017-137-supplement">https://doi.org/10.5194/gmd-2017-137-supplement</a>
</p>

<hr>
<h2 id='cross_section'>Digitized growth increments in cross section of modern oyster rescaled to
the same X-axis.</h2><span id='topic+cross_section'></span>

<h3>Description</h3>

<p>A dataset containing X- and Y-coordinates of digitized growth increments
from the Crassostrea gigas #1 oyster used as an example in de Winter (2017)
resampled to fit the same X-axis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(cross_section)
</code></pre>


<h3>Format</h3>

<p>A data frame with 101 rows and 10 variables:
</p>

<dl>
<dt>0</dt><dd><p>X-coordinates in mm</p>
</dd>
<dt>44</dt><dd><p>Empty column, title contains day of the year the shell started growing (estimated)</p>
</dd>
<dt>0</dt><dd><p>Y-coordinates of digitized increment 0 (top of shell), title contains age in days</p>
</dd>
<dt>30</dt><dd><p>Y-coordinates of digitized increment 1, title contains age in days</p>
</dd>
<dt>90</dt><dd><p>Y-coordinates of digitized increment 2, title contains age in days</p>
</dd>
<dt>270</dt><dd><p>Y-coordinates of digitized increment 3, title contains age in days</p>
</dd>
<dt>420</dt><dd><p>Y-coordinates of digitized increment 4, title contains age in days</p>
</dd>
<dt>780</dt><dd><p>Y-coordinates of digitized increment 5, title contains age in days</p>
</dd>
<dt>1050</dt><dd><p>Y-coordinates of digitized increment 6, title contains age in days</p>
</dd>
<dt>1290</dt><dd><p>Y-coordinates of digitized increment 7 (bottom of shell), title contains age in days</p>
</dd>
</dl>


<h3>Source</h3>

<p><a href="https://doi.org/10.5194/gmd-2017-137-supplement">https://doi.org/10.5194/gmd-2017-137-supplement</a>
</p>

<hr>
<h2 id='el_time'>Matrix listing the concentrations of elements in every subincrement</h2><span id='topic+el_time'></span>

<h3>Description</h3>

<p>A dataset containing the concentrations of every element measured in the
phase map of the XRF mapped surface of the Crassostrea gigas #1 oyster
used as an example in de Winter (2017) reconstructed in every subincrement.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(el_time)
</code></pre>


<h3>Format</h3>

<p>A data frame with 24 rows and 1291 variables:</p>


<h3>Source</h3>

<p><a href="https://doi.org/10.5194/gmd-2017-137-supplement">https://doi.org/10.5194/gmd-2017-137-supplement</a>
</p>

<hr>
<h2 id='image_length'>Length (in mm) of the digitized phase map image.</h2><span id='topic+image_length'></span>

<h3>Description</h3>

<p>A single value of the image length in mm
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(image_length)
</code></pre>


<h3>Format</h3>

<p>A single value:
</p>

<p>Length in mm of digitized shell cross section
</p>


<h3>Source</h3>

<p><a href="https://doi.org/10.5194/gmd-2017-137-supplement">https://doi.org/10.5194/gmd-2017-137-supplement</a>
</p>

<hr>
<h2 id='IncG'>Interpolated subincrements in cross section of modern oyster rescaled to
the same X-axis.</h2><span id='topic+IncG'></span>

<h3>Description</h3>

<p>A dataset containing X- and Y-coordinates of subincrements interpolated
between digitized growth increments from the Crassostrea gigas #1 oyster
used as an example in de Winter (2017) sampled to fit a common X-axis.
A Xstep of 0.1, a Tstep of 1 and a growth season of 250 days are used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(IncG)
</code></pre>


<h3>Format</h3>

<p>A large data frame with 101 rows and 1291 variables:</p>


<h3>Source</h3>

<p><a href="https://doi.org/10.5194/gmd-2017-137-supplement">https://doi.org/10.5194/gmd-2017-137-supplement</a>
</p>

<hr>
<h2 id='incr_matrix0'>Matrix containing data calculated for each growth band.</h2><span id='topic+incr_matrix0'></span>

<h3>Description</h3>

<p>A dataset containing specific parameters calculated for all digitized growth
increments from the Crassostre gigas #1 oyster used as an example in de Winter
(2017) sorted per increment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(incr_matrix0)
</code></pre>


<h3>Format</h3>

<p>A data frame with 8 rows and 3 variables:
</p>

<dl>
<dt>growth band</dt><dd><p>name of the growth increment</p>
</dd>
<dt>age (days)</dt><dd><p>Age associated with the deposition of the growth increment</p>
</dd>
<dt>age_cal (days)</dt><dd><p>Age associated with the deposition of the growth increment, calibrated to the seasonal cycle</p>
</dd>
</dl>


<h3>Source</h3>

<p><a href="https://doi.org/10.5194/gmd-2017-137-supplement">https://doi.org/10.5194/gmd-2017-137-supplement</a>
</p>

<hr>
<h2 id='incr_matrix1'>Matrix containing data calculated for each growth band.</h2><span id='topic+incr_matrix1'></span>

<h3>Description</h3>

<p>A dataset containing specific parameters calculated for all digitized growth
increments from the Crassostre gigas #1 oyster used as an example in de Winter
(2017) sorted per increment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(incr_matrix1)
</code></pre>


<h3>Format</h3>

<p>A data frame with 8 rows and 5 variables:
</p>

<dl>
<dt>growth band</dt><dd><p>name of the growth increment</p>
</dd>
<dt>age (days)</dt><dd><p>Age associated with the deposition of the growth increment</p>
</dd>
<dt>age_cal (days)</dt><dd><p>Age associated with the deposition of the growth increment, calibrated to the seasonal cycle</p>
</dd>
<dt>incr_area</dt><dd><p>area between subsequent increments</p>
</dd>
<dt>incr_cumarea</dt><dd><p>area between increment and the top of the shell</p>
</dd>
</dl>


<h3>Source</h3>

<p><a href="https://doi.org/10.5194/gmd-2017-137-supplement">https://doi.org/10.5194/gmd-2017-137-supplement</a>
</p>

<hr>
<h2 id='incr_matrix2'>Matrix containing data calculated for each growth band.</h2><span id='topic+incr_matrix2'></span>

<h3>Description</h3>

<p>A dataset containing specific parameters calculated for all digitized growth
increments from the Crassostre gigas #1 oyster used as an example in de Winter
(2017) sorted per increment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(incr_matrix2)
</code></pre>


<h3>Format</h3>

<p>A data frame with 8 rows and 6 variables:
</p>

<dl>
<dt>growth band</dt><dd><p>name of the growth increment</p>
</dd>
<dt>age (days)</dt><dd><p>Age associated with the deposition of the growth increment</p>
</dd>
<dt>age_cal (days)</dt><dd><p>Age associated with the deposition of the growth increment, calibrated to the seasonal cycle</p>
</dd>
<dt>incr_area</dt><dd><p>area between subsequent increments</p>
</dd>
<dt>incr_cumarea</dt><dd><p>area between increment and the top of the shell</p>
</dd>
<dt>av_thickness</dt><dd><p>average thickness of area between increment and the top of the shell</p>
</dd>
</dl>


<h3>Source</h3>

<p><a href="https://doi.org/10.5194/gmd-2017-137-supplement">https://doi.org/10.5194/gmd-2017-137-supplement</a>
</p>

<hr>
<h2 id='incr_matrix3'>Matrix containing data calculated for each growth band.</h2><span id='topic+incr_matrix3'></span>

<h3>Description</h3>

<p>A dataset containing specific parameters calculated for all digitized growth
increments from the Crassostre gigas #1 oyster used as an example in de Winter
(2017) sorted per increment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(incr_matrix3)
</code></pre>


<h3>Format</h3>

<p>A data frame with 8 rows and 11 variables:
</p>

<dl>
<dt>growth band</dt><dd><p>name of the growth increment</p>
</dd>
<dt>age (days)</dt><dd><p>Age associated with the deposition of the growth increment</p>
</dd>
<dt>age_cal (days)</dt><dd><p>Age associated with the deposition of the growth increment, calibrated to the seasonal cycle</p>
</dd>
<dt>incr_area</dt><dd><p>area between subsequent increments</p>
</dd>
<dt>incr_cumarea</dt><dd><p>area between increment and the top of the shell</p>
</dd>
<dt>av_thickness</dt><dd><p>average thickness of area between increment and the top of the shell</p>
</dd>
<dt>p1x</dt><dd><p>X-value of first (leftmost) point in growth increment</p>
</dd>
<dt>p1y</dt><dd><p>Y-value of first (leftmost) point in growth increment</p>
</dd>
<dt>p2x</dt><dd><p>X-value of last (rightmost) point in growth increment</p>
</dd>
<dt>p2y</dt><dd><p>Y-value of last (rightmost) point in growth increment</p>
</dd>
<dt>shell_height</dt><dd><p>Height of shell during deposition of shell increment</p>
</dd>
</dl>


<h3>Source</h3>

<p><a href="https://doi.org/10.5194/gmd-2017-137-supplement">https://doi.org/10.5194/gmd-2017-137-supplement</a>
</p>

<hr>
<h2 id='lengthfactor'>Multiplier used to convert shell cross section from pixels to mm</h2><span id='topic+lengthfactor'></span>

<h3>Description</h3>

<p>A single value of the amount of mm contained in one pixel
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(lengthfactor)
</code></pre>


<h3>Format</h3>

<p>A single value:
</p>

<p>Length in mm of one pixel in the digitized shell cross section
</p>


<h3>Source</h3>

<p><a href="https://doi.org/10.5194/gmd-2017-137-supplement">https://doi.org/10.5194/gmd-2017-137-supplement</a>
</p>

<hr>
<h2 id='M_el_mat'>Matrix of modelled mass accumulation rates per trace element</h2><span id='topic+M_el_mat'></span>

<h3>Description</h3>

<p>A dataset containing trace element accumulation modelled for every
based on the a phase map of the XRF mapped surface of the Crassostrea
gigas #1 oyster used as an example in de Winter (2017)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(M_el_mat)
</code></pre>


<h3>Format</h3>

<p>A data frame with 5 rows and 24 variables:
</p>

<dl>
<dt>C</dt><dd><p>Mass accumulation of C in subincrement</p>
</dd>
<dt>O</dt><dd><p>Mass accumulation of O in subincrement</p>
</dd>
<dt>Na</dt><dd><p>Mass accumulation of Na in subincrement</p>
</dd>
<dt>Mg</dt><dd><p>Mass accumulation of Mg in subincrement</p>
</dd>
<dt>Al</dt><dd><p>Mass accumulation of Al in subincrement</p>
</dd>
<dt>Si</dt><dd><p>Mass accumulation of Si in subincrement</p>
</dd>
<dt>P</dt><dd><p>Mass accumulation of P in subincrement</p>
</dd>
<dt>S</dt><dd><p>Mass accumulation of S in subincrement</p>
</dd>
<dt>Cl</dt><dd><p>Mass accumulation of Cl in subincrement</p>
</dd>
<dt>K</dt><dd><p>Mass accumulation of K in subincrement</p>
</dd>
<dt>Ca</dt><dd><p>Mass accumulation of Ca in subincrement</p>
</dd>
<dt>Ti</dt><dd><p>Mass accumulation of Ti in subincrement</p>
</dd>
<dt>Cr</dt><dd><p>Mass accumulation of Cr in subincrement</p>
</dd>
<dt>Mn</dt><dd><p>Mass accumulation of Mn in subincrement</p>
</dd>
<dt>Fe</dt><dd><p>Mass accumulation of Fe in subincrement</p>
</dd>
<dt>Ni</dt><dd><p>Mass accumulation of Ni in subincrement</p>
</dd>
<dt>Cu</dt><dd><p>Mass accumulation of Cu in subincrement</p>
</dd>
<dt>Zn</dt><dd><p>Mass accumulation of Zn in subincrement</p>
</dd>
<dt>Br</dt><dd><p>Mass accumulation of Br in subincrement</p>
</dd>
<dt>Rb</dt><dd><p>Mass accumulation of Rb in subincrement</p>
</dd>
<dt>Sr</dt><dd><p>Mass accumulation of Sr in subincrement</p>
</dd>
<dt>Rh</dt><dd><p>Mass accumulation of Rh in subincrement</p>
</dd>
<dt>Ba</dt><dd><p>Mass accumulation of Ba in subincrement</p>
</dd>
<dt>Pb</dt><dd><p>Mass accumulation of Pb in subincrement</p>
</dd>
</dl>


<h3>Source</h3>

<p><a href="https://doi.org/10.5194/gmd-2017-137-supplement">https://doi.org/10.5194/gmd-2017-137-supplement</a>
</p>

<hr>
<h2 id='M_el_mat_c'>Matrix of modelled cumulative mass accumulation rates per trace element</h2><span id='topic+M_el_mat_c'></span>

<h3>Description</h3>

<p>A dataset containing mass accumulation of trace elements modelled for every
based on the a phase map of the XRF mapped surface of the Crassostrea
gigas #1 oyster used as an example in de Winter (2017)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(M_el_mat_c)
</code></pre>


<h3>Format</h3>

<p>A data frame with 5 rows and 24 variables:
</p>

<dl>
<dt>C</dt><dd><p>Cumulative mass accumulation of C in subincrement</p>
</dd>
<dt>O</dt><dd><p>Cumulative mass accumulation of O in subincrement</p>
</dd>
<dt>Na</dt><dd><p>Cumulative mass accumulation of Na in subincrement</p>
</dd>
<dt>Mg</dt><dd><p>Cumulative mass accumulation of Mg in subincrement</p>
</dd>
<dt>Al</dt><dd><p>Cumulative mass accumulation of Al in subincrement</p>
</dd>
<dt>Si</dt><dd><p>Cumulative mass accumulation of Si in subincrement</p>
</dd>
<dt>P</dt><dd><p>Cumulative mass accumulation of P in subincrement</p>
</dd>
<dt>S</dt><dd><p>Cumulative mass accumulation of S in subincrement</p>
</dd>
<dt>Cl</dt><dd><p>Cumulative mass accumulation of Cl in subincrement</p>
</dd>
<dt>K</dt><dd><p>Cumulative mass accumulation of K in subincrement</p>
</dd>
<dt>Ca</dt><dd><p>Cumulative mass accumulation of Ca in subincrement</p>
</dd>
<dt>Ti</dt><dd><p>Cumulative mass accumulation of Ti in subincrement</p>
</dd>
<dt>Cr</dt><dd><p>Cumulative mass accumulation of Cr in subincrement</p>
</dd>
<dt>Mn</dt><dd><p>Cumulative mass accumulation of Mn in subincrement</p>
</dd>
<dt>Fe</dt><dd><p>Cumulative mass accumulation of Fe in subincrement</p>
</dd>
<dt>Ni</dt><dd><p>Cumulative mass accumulation of Ni in subincrement</p>
</dd>
<dt>Cu</dt><dd><p>Cumulative mass accumulation of Cu in subincrement</p>
</dd>
<dt>Zn</dt><dd><p>Cumulative mass accumulation of Zn in subincrement</p>
</dd>
<dt>Br</dt><dd><p>Cumulative mass accumulation of Br in subincrement</p>
</dd>
<dt>Rb</dt><dd><p>Cumulative mass accumulation of Rb in subincrement</p>
</dd>
<dt>Sr</dt><dd><p>Cumulative mass accumulation of Sr in subincrement</p>
</dd>
<dt>Rh</dt><dd><p>Cumulative mass accumulation of Rh in subincrement</p>
</dd>
<dt>Ba</dt><dd><p>Cumulative mass accumulation of Ba in subincrement</p>
</dd>
<dt>Pb</dt><dd><p>Cumulative mass accumulation of Pb in subincrement</p>
</dd>
</dl>


<h3>Source</h3>

<p><a href="https://doi.org/10.5194/gmd-2017-137-supplement">https://doi.org/10.5194/gmd-2017-137-supplement</a>
</p>

<hr>
<h2 id='O1_input'>Digitized growth increments in cross section of modern oyster.</h2><span id='topic+O1_input'></span>

<h3>Description</h3>

<p>A dataset containing X- and Y-coordinates of digitized growth increments
from the Crassostrea gigas #1 oyster used as an example in de Winter (2017)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(O1_input)
</code></pre>


<h3>Format</h3>

<p>A data frame with 181 rows and 26 variables:
</p>

<dl>
<dt>x_base</dt><dd><p>X-coordinate in pixels of bottom line on image</p>
</dd>
<dt>y_base</dt><dd><p>Y-coordinate in pixels of bottom line on image, second row value represents the day of the year</p>
</dd>
<dt>EMPTY1</dt><dd><p>Empty column</p>
</dd>
<dt>x_top</dt><dd><p>X-coordinate in pixels of top of Crassostrea gigas shell #1 (increment 0)</p>
</dd>
<dt>y_top</dt><dd><p>Y-coordinate in pixels of top of Crassostrea gigas shell #1 (increment 0), second row value represents the age in days (=0)</p>
</dd>
<dt>EMPTY2</dt><dd><p>Empty column</p>
</dd>
<dt>x_1</dt><dd><p>X-coordinate in pixels of increment 1</p>
</dd>
<dt>y_1</dt><dd><p>Y-coordinate in pixels of increment 1, second row value represents the age in days</p>
</dd>
<dt>EMPTY3</dt><dd><p>Empty column</p>
</dd>
<dt>x_2</dt><dd><p>X-coordinate in pixels of increment 2</p>
</dd>
<dt>y_2</dt><dd><p>Y-coordinate in pixels of increment 2, second row value represents the age in days</p>
</dd>
<dt>EMPTY4</dt><dd><p>Empty column</p>
</dd>
<dt>x_3</dt><dd><p>X-coordinate in pixels of increment 3</p>
</dd>
<dt>y_3</dt><dd><p>Y-coordinate in pixels of increment 3, second row value represents the age in days</p>
</dd>
<dt>EMPTY5</dt><dd><p>Empty column</p>
</dd>
<dt>x_4</dt><dd><p>X-coordinate in pixels of increment 4</p>
</dd>
<dt>y_4</dt><dd><p>Y-coordinate in pixels of increment 4, second row value represents the age in days</p>
</dd>
<dt>EMPTY6</dt><dd><p>Empty column</p>
</dd>
<dt>x_5</dt><dd><p>X-coordinate in pixels of increment 5</p>
</dd>
<dt>y_5</dt><dd><p>Y-coordinate in pixels of increment 5, second row value represents the age in days</p>
</dd>
<dt>EMPTY7</dt><dd><p>Empty column</p>
</dd>
<dt>x_6</dt><dd><p>X-coordinate in pixels of increment 6</p>
</dd>
<dt>y_6</dt><dd><p>Y-coordinate in pixels of increment 6, second row value represents the age in days</p>
</dd>
<dt>EMPTY8</dt><dd><p>Empty column</p>
</dd>
<dt>x_bottom</dt><dd><p>X-coordinate in pixels of bottom of Crassostrea gigas shell #1</p>
</dd>
<dt>y_bottom</dt><dd><p>Y-coordinate in pixels of bottom of Crassostrea gigas shell #1, second row value represents the age in days (= age of death)</p>
</dd>
</dl>


<h3>Source</h3>

<p><a href="https://doi.org/10.5194/gmd-2017-137-supplement">https://doi.org/10.5194/gmd-2017-137-supplement</a>
</p>

<hr>
<h2 id='O1_phase'>Characteristics of phase in XRF map of oyster</h2><span id='topic+O1_phase'></span>

<h3>Description</h3>

<p>A dataset containing trace element concentrations and RGB colour values
of a phase map of the XRF mapped surface of the Crassostrea gigas #1 oyster
used as an example in de Winter (2017)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(O1_phase)
</code></pre>


<h3>Format</h3>

<p>A data frame with 5 rows and 30 variables:
</p>

<dl>
<dt>Description</dt><dd><p>Desription of phase</p>
</dd>
<dt>Name</dt><dd><p>Name of phase</p>
</dd>
<dt>R</dt><dd><p>R-value of phase colour</p>
</dd>
<dt>G</dt><dd><p>G-value of phase colour</p>
</dd>
<dt>B</dt><dd><p>B-value of phase colour</p>
</dd>
<dt>density</dt><dd><p>specific density of different phases</p>
</dd>
<dt>C</dt><dd><p>Concentration of C in phase</p>
</dd>
<dt>O</dt><dd><p>Concentration of O in phase</p>
</dd>
<dt>Na</dt><dd><p>Concentration of Na in phase</p>
</dd>
<dt>Mg</dt><dd><p>Concentration of Mg in phase</p>
</dd>
<dt>Al</dt><dd><p>Concentration of Al in phase</p>
</dd>
<dt>Si</dt><dd><p>Concentration of Si in phase</p>
</dd>
<dt>P</dt><dd><p>Concentration of P in phase</p>
</dd>
<dt>S</dt><dd><p>Concentration of S in phase</p>
</dd>
<dt>Cl</dt><dd><p>Concentration of Cl in phase</p>
</dd>
<dt>K</dt><dd><p>Concentration of K in phase</p>
</dd>
<dt>Ca</dt><dd><p>Concentration of Ca in phase</p>
</dd>
<dt>Ti</dt><dd><p>Concentration of Ti in phase</p>
</dd>
<dt>Cr</dt><dd><p>Concentration of Cr in phase</p>
</dd>
<dt>Mn</dt><dd><p>Concentration of Mn in phase</p>
</dd>
<dt>Fe</dt><dd><p>Concentration of Fe in phase</p>
</dd>
<dt>Ni</dt><dd><p>Concentration of Ni in phase</p>
</dd>
<dt>Cu</dt><dd><p>Concentration of Cu in phase</p>
</dd>
<dt>Zn</dt><dd><p>Concentration of Zn in phase</p>
</dd>
<dt>Br</dt><dd><p>Concentration of Br in phase</p>
</dd>
<dt>Rb</dt><dd><p>Concentration of Rb in phase</p>
</dd>
<dt>Sr</dt><dd><p>Concentration of Sr in phase</p>
</dd>
<dt>Rh</dt><dd><p>Concentration of Rh in phase</p>
</dd>
<dt>Ba</dt><dd><p>Concentration of Ba in phase</p>
</dd>
<dt>Pb</dt><dd><p>Concentration of Pb in phase</p>
</dd>
</dl>


<h3>Source</h3>

<p><a href="https://doi.org/10.5194/gmd-2017-137-supplement">https://doi.org/10.5194/gmd-2017-137-supplement</a>
</p>

<hr>
<h2 id='Oyster_accumulation'>Calculate trace element accumulation rates</h2><span id='topic+Oyster_accumulation'></span>

<h3>Description</h3>

<p>Function that combines the concentrations of trace elements per
sub-increment with a smoothed record of mass accumulation with time to
calculate the rate of accumulation of each element through the lifetime
of the bivalve.
de Winter, N. J. (2017) &lt;doi:10.5194/gmd-2017-137&gt;</p>


<h3>Usage</h3>

<pre><code class='language-R'>Oyster_accumulation(el_time, subincr_matrix, npma = 10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Oyster_accumulation_+3A_el_time">el_time</code></td>
<td>
<p>Matrix of trace element concentrations through time</p>
</td></tr>
<tr><td><code id="Oyster_accumulation_+3A_subincr_matrix">subincr_matrix</code></td>
<td>
<p>Data frame that contains characteristics of
every sub-increment</p>
</td></tr>
<tr><td><code id="Oyster_accumulation_+3A_npma">npma</code></td>
<td>
<p>Integer n-value determining the window size of the moving
average smoothing of the mass accumulation record</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A record of mass accumulation of the shell is smoothed using a
moving average. This mass accumulation record is multiplied with the
records of trace element concentrations per sub-increment to obtain
a record of mass accumulation of each trace element through time
and a record of cumulative trace element accumulation through
time</p>


<h3>Value</h3>

<p>Matrices of trace element accumulation per sub-increment and cumulative
trace element accumulation
</p>
<table>
<tr><td><code>M_el_mat</code></td>
<td>
<p>Matrix of mass accumulation per trace element</p>
</td></tr>
<tr><td><code>M_el_mat_c</code></td>
<td>
<p>Matrix of cumulative mass accumulation per trace
element</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Please cite Geoscientific Model Development paper dealing with
the ShellTrace model</p>


<h3>Author(s)</h3>

<p>Niels J. de Winter</p>


<h3>Source</h3>

<p><a href="https://github.com/nielsjdewinter/ShellTrace">GitHub</a> <br />
<a href="https://doi.org/10.5194/gmd-2017-137">Manuscript</a> <br />
<a href="https://doi.org/10.5194/gmd-2017-137-supplement">Supplementary data</a> <br />
<a href="http://nidewint.wixsite.com/nielsdewinter">Author website</a>
</p>


<h3>References</h3>

<p>de Winter, N. J.: ShellTrace v1.0 ? A new approach for
modelling growth and trace element uptake in marine bivalve shells:
Model verification on pacific oyster shells (Crassostrea gigas),
Geosci. Model Dev. Discuss., https://doi.org/10.5194/gmd-2017-137,
in review, 2017.</p>


<h3>See Also</h3>

<p>&quot;Oyster_el_time&quot;</p>


<h3>Examples</h3>

<pre><code class='language-R'>  AccL&lt;-Oyster_accumulation(el_time, subincr_matrix6, npma = 10)
</code></pre>

<hr>
<h2 id='Oyster_combined_run'>Runs the growth and trace element model</h2><span id='topic+Oyster_combined_run'></span>

<h3>Description</h3>

<p>Function that runs the bivalve growth and trace element model from
start to finish, combining Step 2-6.
de Winter, N. J. (2017) &lt;doi:10.5194/gmd-2017-137&gt;</p>


<h3>Usage</h3>

<pre><code class='language-R'>Oyster_combined_run(raw_data, image_length, season_length=250, Xstep=0.1, Tstep=1,
Oyster_height, Oyster_length, name_file="Oyster_growth_model", phases_name,
image_name, image_ext, npma=10, name_shell)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Oyster_combined_run_+3A_raw_data">raw_data</code></td>
<td>
<p>Numeric data frame containing the X- and Y-coordinates
digitized in Adobe Illustrator or another image processing software</p>
</td></tr>
<tr><td><code id="Oyster_combined_run_+3A_image_length">image_length</code></td>
<td>
<p>Measured maximum length of the area of the cross
section that is represented in &quot;raw_data&quot;</p>
</td></tr>
<tr><td><code id="Oyster_combined_run_+3A_season_length">season_length</code></td>
<td>
<p>Length (in days) of the growth season of the
studied bivalve</p>
</td></tr>
<tr><td><code id="Oyster_combined_run_+3A_xstep">Xstep</code></td>
<td>
<p>The step size (dx) in X-direction used to interpolate
coordinates of shell increments</p>
</td></tr>
<tr><td><code id="Oyster_combined_run_+3A_tstep">Tstep</code></td>
<td>
<p>The step size (dt) in time (days) used to interpolate
the existing shell increments</p>
</td></tr>
<tr><td><code id="Oyster_combined_run_+3A_oyster_height">Oyster_height</code></td>
<td>
<p>Measured maximum height of the shell</p>
</td></tr>
<tr><td><code id="Oyster_combined_run_+3A_oyster_length">Oyster_length</code></td>
<td>
<p>Measured maximum length of the shell in anterio-posterior direction</p>
</td></tr>
<tr><td><code id="Oyster_combined_run_+3A_name_file">name_file</code></td>
<td>
<p>string indicating the name that should be added to
all exported model results</p>
</td></tr>
<tr><td><code id="Oyster_combined_run_+3A_phases_name">phases_name</code></td>
<td>
<p>String of full name (including extension!) of the CSV
file that contains information about the phases in the map</p>
</td></tr>
<tr><td><code id="Oyster_combined_run_+3A_image_name">image_name</code></td>
<td>
<p>String of full name of the BMP that needs to be imported,
excluding extension</p>
</td></tr>
<tr><td><code id="Oyster_combined_run_+3A_image_ext">image_ext</code></td>
<td>
<p>Extention of phase map file (&quot;BMP&quot; or &quot;TIF&quot;)</p>
</td></tr>
<tr><td><code id="Oyster_combined_run_+3A_npma">npma</code></td>
<td>
<p>Window size of the moving average used to smooth mass gain
record from the bivalve growth model</p>
</td></tr>
<tr><td><code id="Oyster_combined_run_+3A_name_shell">name_shell</code></td>
<td>
<p>string indicating the name that should be added to all
exported model results</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Oyster_growth_run and Oyster_phase_run, bundling and exporting
the model results</p>


<h3>Value</h3>

<p>Exports matrices containing oyster growth parameters for each sub-increment
as well as matrices containing trace element accumulation rates and
concentration changes through the shells life time resulting from the
trace element model.
All these matrices are also exported as a list containing:
</p>
<table>
<tr><td><code>subincr_matrix</code></td>
<td>
<p>Revised version of the &quot;incr_matrix&quot; data frame
that contains characteristics calculated for every sub-increment</p>
</td></tr>
<tr><td><code>phase_stat</code></td>
<td>
<p>matrix of statistics of trace elements and phases in the
total map</p>
</td></tr>
<tr><td><code>el_time</code></td>
<td>
<p>Matrix of trace element concentrations through time</p>
</td></tr>
<tr><td><code>M_el_mat</code></td>
<td>
<p>Matrix of mass accumulation per trace element</p>
</td></tr>
<tr><td><code>M_el_mat_c</code></td>
<td>
<p>Matrix of cumulative mass accumulation per trace element</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Please cite Geoscientific Model Development paper dealing with the
ShellTrace model</p>


<h3>Author(s)</h3>

<p>Niels J. de Winter</p>


<h3>Source</h3>

<p><a href="https://github.com/nielsjdewinter/ShellTrace">GitHub</a> <br />
<a href="https://doi.org/10.5194/gmd-2017-137">Manuscript</a> <br />
<a href="https://doi.org/10.5194/gmd-2017-137-supplement">Supplementary data</a> <br />
<a href="http://nidewint.wixsite.com/nielsdewinter">Author website</a>
</p>


<h3>References</h3>

<p>de Winter, N. J.: ShellTrace v1.0 ? A new approach for modelling
growth and trace element uptake in marine bivalve shells: Model
verification on pacific oyster shells (Crassostrea gigas),
Geosci. Model Dev. Discuss., https://doi.org/10.5194/gmd-2017-137,
in review, 2017.</p>


<h3>See Also</h3>

<p>&quot;Oyster_growth_run&quot; and &quot;Oyster_phase_run&quot;</p>

<hr>
<h2 id='Oyster_Convert_cross_section'>Function that converts XY-data of digitized cross section</h2><span id='topic+Oyster_Convert_cross_section'></span>

<h3>Description</h3>

<p>Takes XY data of digitized growth increments in a shell cross section
and converts them to a common X-axis with the correct lengths in millimeters.
de Winter, N. J. (2017) &lt;doi:10.5194/gmd-2017-137&gt;</p>


<h3>Usage</h3>

<pre><code class='language-R'>Oyster_Convert_cross_section(raw_data, image_length, Xstep = 0.1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Oyster_Convert_cross_section_+3A_raw_data">raw_data</code></td>
<td>
<p>Numeric data frame containing the X- and Y-coordinates digitized
in Adobe Illustrator or another image processing software</p>
</td></tr>
<tr><td><code id="Oyster_Convert_cross_section_+3A_image_length">image_length</code></td>
<td>
<p>Measured maximum length of the area of the cross section that
is represented in &quot;raw_data&quot;</p>
</td></tr>
<tr><td><code id="Oyster_Convert_cross_section_+3A_xstep">Xstep</code></td>
<td>
<p>The step size (dx) in X-direction used to interpolate coordinates
of shell increments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>First step in growth modelling: Converting XY data of increments to a common
X-axis</p>


<h3>Value</h3>

<p>List of two data sets and one value:
</p>
<table>
<tr><td><code>cross_section</code></td>
<td>
<p>Digitized cross section of the shell with shell top, bottom and
growth increments relative to a common X-axis</p>
</td></tr>
<tr><td><code>year_trace</code></td>
<td>
<p>Digitized cross section of shell increments without addition of top
and bottom of the shell to the increment Y-values</p>
</td></tr>
<tr><td><code>lengthfactor</code></td>
<td>
<p>Factor of actual shell length relative to shell length in cross
section</p>
</td></tr>
<tr><td><code>incr_matrix</code></td>
<td>
<p>Matrix containing ages and calibrated ages for each shell increment</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Please cite Geoscientific Model Development paper dealing with the ShellTrace model</p>


<h3>Author(s)</h3>

<p>Niels J. de Winter</p>


<h3>Source</h3>

<p><a href="https://github.com/nielsjdewinter/ShellTrace">GitHub</a> <br />
<a href="https://doi.org/10.5194/gmd-2017-137">Manuscript</a> <br />
<a href="https://doi.org/10.5194/gmd-2017-137-supplement">Supplementary data</a> <br />
<a href="http://nidewint.wixsite.com/nielsdewinter">Author website</a>
</p>


<h3>References</h3>

<p>de Winter, N. J.: ShellTrace v1.0 - A new approach for modelling growth
and trace element uptake in marine bivalve shells: Model verification on pacific
oyster shells (Crassostrea gigas), Geosci. Model Dev. Discuss.,
https:\doi.org\10.5194\gmd-2017-137, in review, 2017.</p>


<h3>Examples</h3>

<pre><code class='language-R'>  Llist&lt;-Oyster_Convert_cross_section(O1_input, image_length, Xstep=1)
</code></pre>

<hr>
<h2 id='Oyster_el_time'>Calculate concentrations of trace elements per sub-increment</h2><span id='topic+Oyster_el_time'></span>

<h3>Description</h3>

<p>Function that takes the matrix of phase pixels per sub-increment
together with the matrix of concentrations per phase to calculate the
concentration of each trace element in every sub-increment.
de Winter, N. J. (2017) &lt;doi:10.5194/gmd-2017-137&gt;</p>


<h3>Usage</h3>

<pre><code class='language-R'>Oyster_el_time(phase_mat, phases)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Oyster_el_time_+3A_phase_mat">phase_mat</code></td>
<td>
<p>Matrix of amounts of pixels of each phase per sub-increment</p>
</td></tr>
<tr><td><code id="Oyster_el_time_+3A_phases">phases</code></td>
<td>
<p>Matrix containing colour and trace element data of the phases
in the XRF phase map</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For every sub-increment, the relative contribution of phases is
multiplied with the trace element concentrations of the phases to calculate
the average concentration of trace elements in each sub-increment</p>


<h3>Value</h3>

<p>Matrix of trace element concentrations per sub-increment
</p>
<table>
<tr><td><code>el_time</code></td>
<td>
<p>Matrix of trace element concentrations through time</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Please cite Geoscientific Model Development paper dealing with the
ShellTrace model</p>


<h3>Author(s)</h3>

<p>Niels J. de Winter</p>


<h3>Source</h3>

<p><a href="https://github.com/nielsjdewinter/ShellTrace">GitHub</a> <br />
<a href="https://doi.org/10.5194/gmd-2017-137">Manuscript</a> <br />
<a href="https://doi.org/10.5194/gmd-2017-137-supplement">Supplementary data</a> <br />
<a href="http://nidewint.wixsite.com/nielsdewinter">Author website</a>
</p>


<h3>References</h3>

<p>de Winter, N. J.: ShellTrace v1.0 ? A new approach for modelling
growth and trace element uptake in marine bivalve shells: Model verification
on pacific oyster shells (Crassostrea gigas), Geosci. Model Dev. Discuss.,
https://doi.org/10.5194/gmd-2017-137, in review, 2017.</p>


<h3>See Also</h3>

<p>&quot;Oyster_Volumes&quot;</p>


<h3>Examples</h3>

<pre><code class='language-R'>  el_time&lt;-Oyster_el_time(phase_mat, O1_phase)
</code></pre>

<hr>
<h2 id='Oyster_ellipse_parameters'>Function that calculates the parameters of the base ellipse used for
bivalve growth modelling</h2><span id='topic+Oyster_ellipse_parameters'></span>

<h3>Description</h3>

<p>Calculates the parameters a and b of the ellipse that forms
the base of the shell in growth modelling.
de Winter, N. J. (2017) &lt;doi:10.5194/gmd-2017-137&gt;</p>


<h3>Usage</h3>

<pre><code class='language-R'>Oyster_ellipse_parameters(subincr_matrix, IncG, Oyster_height, Oyster_length)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Oyster_ellipse_parameters_+3A_subincr_matrix">subincr_matrix</code></td>
<td>
<p>Data frame that contains characteristics of every
sub-increment</p>
</td></tr>
<tr><td><code id="Oyster_ellipse_parameters_+3A_incg">IncG</code></td>
<td>
<p>Matrix of X- and Y-coordinates of all interpolated
sub-increments</p>
</td></tr>
<tr><td><code id="Oyster_ellipse_parameters_+3A_oyster_height">Oyster_height</code></td>
<td>
<p>Measured maximum height of the shell</p>
</td></tr>
<tr><td><code id="Oyster_ellipse_parameters_+3A_oyster_length">Oyster_length</code></td>
<td>
<p>Measured maximum length of the shell in anterio-posterior direction</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Parameters of the base ellipse of the shell are calculated by
calculating the ratio between measured shell height and length and the
endpoints of all sub-increments</p>


<h3>Value</h3>

<table>
<tr><td><code>subincr_matrix</code></td>
<td>
<p>Updated data frame that contains characteristics
of every sub-increment, with ellipse parameters added</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Please cite Geoscientific Model Development paper dealing with the
ShellTrace model</p>


<h3>Author(s)</h3>

<p>Niels J. de Winter</p>


<h3>Source</h3>

<p><a href="https://github.com/nielsjdewinter/ShellTrace">GitHub</a> <br />
<a href="https://doi.org/10.5194/gmd-2017-137">Manuscript</a> <br />
<a href="https://doi.org/10.5194/gmd-2017-137-supplement">Supplementary data</a> <br />
<a href="http://nidewint.wixsite.com/nielsdewinter">Author website</a>
</p>


<h3>References</h3>

<p>de Winter, N. J.: ShellTrace v1.0 ? A new approach for modelling
growth and trace element uptake in marine bivalve shells: Model verification
on pacific oyster shells (Crassostrea gigas), Geosci. Model Dev. Discuss.,
https://doi.org/10.5194/gmd-2017-137, in review, 2017.</p>


<h3>See Also</h3>

<p>&quot;Oyster_av_thickness&quot;</p>


<h3>Examples</h3>

<pre><code class='language-R'>  subincr_matrix4&lt;-Oyster_ellipse_parameters(subincr_matrix3,IncG,Oyster_height,Oyster_height)
</code></pre>

<hr>
<h2 id='Oyster_Export'>Function that exports data of the growth model</h2><span id='topic+Oyster_Export'></span>

<h3>Description</h3>

<p>Function that exports the results of the bivalve growth model as
tables in the form of XLSX files.
de Winter, N. J. (2017) &lt;doi:10.5194/gmd-2017-137&gt;</p>


<h3>Usage</h3>

<pre><code class='language-R'>Oyster_Export(subincr_matrix, name_file)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Oyster_Export_+3A_subincr_matrix">subincr_matrix</code></td>
<td>
<p>Data frame that contains characteristics of every
sub-increment</p>
</td></tr>
<tr><td><code id="Oyster_Export_+3A_name_file">name_file</code></td>
<td>
<p>String containing the name of the file to be exported</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Results are exported as &quot;&lt;name file&gt;.xlsx?&quot; in the working directory</p>


<h3>Note</h3>

<p>Please cite Geoscientific Model Development paper dealing with the
ShellTrace model</p>


<h3>Author(s)</h3>

<p>Niels J. de Winter</p>


<h3>Source</h3>

<p><a href="https://github.com/nielsjdewinter/ShellTrace">GitHub</a> <br />
<a href="https://doi.org/10.5194/gmd-2017-137">Manuscript</a> <br />
<a href="https://doi.org/10.5194/gmd-2017-137-supplement">Supplementary data</a> <br />
<a href="http://nidewint.wixsite.com/nielsdewinter">Author website</a>
</p>


<h3>References</h3>

<p>de Winter, N. J.: ShellTrace v1.0 ? A new approach for modelling
growth and trace element uptake in marine bivalve shells: Model verification
on pacific oyster shells (Crassostrea gigas), Geosci. Model Dev. Discuss.,
https://doi.org/10.5194/gmd-2017-137, in review, 2017.</p>


<h3>See Also</h3>

<p>&quot;Oyster_av_thickness&quot;</p>


<h3>Examples</h3>

<pre><code class='language-R'>  ## Not run: 
    Oyster_Export(subincr_matrix6, "test_export")
  
## End(Not run)
</code></pre>

<hr>
<h2 id='Oyster_growth_run'>Runs the entire growth model</h2><span id='topic+Oyster_growth_run'></span>

<h3>Description</h3>

<p>Function that runs all functions contained in Step 2-4 of the
growth model.
de Winter, N. J. (2017) &lt;doi:10.5194/gmd-2017-137&gt;</p>


<h3>Usage</h3>

<pre><code class='language-R'>Oyster_growth_run(LOG=T, raw_data, image_length, season_length=250,
  Xstep=0.1, Tstep=1, Oyster_height, Oyster_length,
  name_file="Oyster_growth_model")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Oyster_growth_run_+3A_log">LOG</code></td>
<td>
<p>Boolean parameter specifying if a LOG should be printed
detailing the parameters entered into this function</p>
</td></tr>
<tr><td><code id="Oyster_growth_run_+3A_raw_data">raw_data</code></td>
<td>
<p>Numeric data frame containing the X- and Y-coordinates
digitized in Adobe Illustrator or another image processing software</p>
</td></tr>
<tr><td><code id="Oyster_growth_run_+3A_image_length">image_length</code></td>
<td>
<p>Measured maximum length of the area of the cross
section that is represented in &quot;raw_data&quot;</p>
</td></tr>
<tr><td><code id="Oyster_growth_run_+3A_season_length">season_length</code></td>
<td>
<p>Length (in days) of the growth season of the
studied bivalve</p>
</td></tr>
<tr><td><code id="Oyster_growth_run_+3A_xstep">Xstep</code></td>
<td>
<p>The step size (dx) in X-direction used to interpolate
coordinates of shell increments</p>
</td></tr>
<tr><td><code id="Oyster_growth_run_+3A_tstep">Tstep</code></td>
<td>
<p>The step size (dt) in time (days) used to interpolate
the existing shell increments</p>
</td></tr>
<tr><td><code id="Oyster_growth_run_+3A_oyster_height">Oyster_height</code></td>
<td>
<p>Measured maximum height of the shell</p>
</td></tr>
<tr><td><code id="Oyster_growth_run_+3A_oyster_length">Oyster_length</code></td>
<td>
<p>Measured maximum length of the shell in anterio-posterior direction</p>
</td></tr>
<tr><td><code id="Oyster_growth_run_+3A_name_file">name_file</code></td>
<td>
<p>string indicating the name that should be added to
all exported model results</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Runs Oyser_run_sec2, Oyser_run_sec3, Oyser_run_sec4 and
Oyster_Export</p>


<h3>Value</h3>

<p>Matrix containing all parameters of the shell calculated per sub-increment
and CSV file containing this matrix
</p>
<table>
<tr><td><code>subincr_matrix</code></td>
<td>
<p>Revised version of the &quot;incr_matrix&quot; data frame
that contains characteristics calculated for every sub-increment</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Please cite Geoscientific Model Development paper dealing with
the ShellTrace model</p>


<h3>Author(s)</h3>

<p>Niels J. de Winter</p>


<h3>Source</h3>

<p><a href="https://github.com/nielsjdewinter/ShellTrace">GitHub</a> <br />
<a href="https://doi.org/10.5194/gmd-2017-137">Manuscript</a> <br />
<a href="https://doi.org/10.5194/gmd-2017-137-supplement">Supplementary data</a> <br />
<a href="http://nidewint.wixsite.com/nielsdewinter">Author website</a>
</p>


<h3>References</h3>

<p>de Winter, N. J.: ShellTrace v1.0 ? A new approach for modelling
growth and trace element uptake in marine bivalve shells: Model
verification on pacific oyster shells (Crassostrea gigas),
Geosci. Model Dev. Discuss., https://doi.org/10.5194/gmd-2017-137,
in review, 2017.</p>


<h3>Examples</h3>

<pre><code class='language-R'>  ## Not run: 
    GList&lt;-Oyster_growth_run(TRUE, O1_input, image_length, season_length=250,
    Xstep=1, Tstep=1, Oyster_height, Oyster_length,name_file="test_export")
  
## End(Not run)
</code></pre>

<hr>
<h2 id='Oyster_height'>Measured height of the shell</h2><span id='topic+Oyster_height'></span>

<h3>Description</h3>

<p>A single value containing the measured height in mm of the
Crassostrea gigas #1 oyster used as an example in de Winter
(2017) GMD.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Oyster_height)
</code></pre>


<h3>Format</h3>

<p>A single value:
</p>

<p>Height in mm of the Crassostrea gigas #1 shell
</p>


<h3>Source</h3>

<p><a href="https://doi.org/10.5194/gmd-2017-137-supplement">https://doi.org/10.5194/gmd-2017-137-supplement</a>
</p>

<hr>
<h2 id='Oyster_import_BMP'>Function that imports a BMP of an XRF map</h2><span id='topic+Oyster_import_BMP'></span>

<h3>Description</h3>

<p>Function that imports a BMP file into R.
de Winter, N. J. (2017) &lt;doi:10.5194/gmd-2017-137&gt;</p>


<h3>Usage</h3>

<pre><code class='language-R'>Oyster_import_BMP(file_name)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Oyster_import_BMP_+3A_file_name">file_name</code></td>
<td>
<p>String of full name of the BMP that needs to be imported,
excluding the extension</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Requires &quot;bmp&quot; package to work</p>


<h3>Value</h3>

<table>
<tr><td><code>BMP</code></td>
<td>
<p>&quot;BMP&quot; file representing the BMP image in R session</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Please cite Geoscientific Model Development paper dealing with the ShellTrace
model</p>


<h3>Author(s)</h3>

<p>Niels J. de Winter</p>


<h3>Source</h3>

<p><a href="https://github.com/nielsjdewinter/ShellTrace">GitHub</a> <br />
<a href="https://doi.org/10.5194/gmd-2017-137">Manuscript</a> <br />
<a href="https://doi.org/10.5194/gmd-2017-137-supplement">Supplementary data</a> <br />
<a href="http://nidewint.wixsite.com/nielsdewinter">Author website</a>
</p>


<h3>References</h3>

<p>de Winter, N. J.: ShellTrace v1.0 ? A new approach for modelling
growth and trace element uptake in marine bivalve shells: Model verification
on pacific oyster shells (Crassostrea gigas), Geosci. Model Dev. Discuss.,
https://doi.org/10.5194/gmd-2017-137, in review, 2017.</p>


<h3>See Also</h3>

<p>&quot;Oyster_av_thickness&quot;</p>

<hr>
<h2 id='Oyster_import_phases'>Function that imports phase data</h2><span id='topic+Oyster_import_phases'></span>

<h3>Description</h3>

<p>Function that imports a table (in CSV format) containing the
specifics of phases that make up the phase XRF map used in the trace
element model.
de Winter, N. J. (2017) &lt;doi:10.5194/gmd-2017-137&gt;</p>


<h3>Usage</h3>

<pre><code class='language-R'>Oyster_import_phases(file_name)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Oyster_import_phases_+3A_file_name">file_name</code></td>
<td>
<p>String containing the name of the CSV file to be imported,
including its extension</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This funcion imports a table containing trace element concentration
and RGB colour data. Table needs to be of the same format as the example
shown in de Winter, N.J., GMD, in review. The amount of phases represented
in the table byrows is unlimited)
</p>


<h3>Value</h3>

<table>
<tr><td><code>phases</code></td>
<td>
<p>Matrix containing colour, density and trace element data of the
phases in the XRF phase map</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Please cite Geoscientific Model Development paper dealing with the
ShellTrace model</p>


<h3>Author(s)</h3>

<p>Niels J. de Winter</p>


<h3>Source</h3>

<p><a href="https://github.com/nielsjdewinter/ShellTrace">GitHub</a> <br />
<a href="https://doi.org/10.5194/gmd-2017-137">Manuscript</a> <br />
<a href="https://doi.org/10.5194/gmd-2017-137-supplement">Supplementary data</a> <br />
<a href="http://nidewint.wixsite.com/nielsdewinter">Author website</a>
</p>


<h3>References</h3>

<p>de Winter, N. J.: ShellTrace v1.0 ? A new approach for modelling
growth and trace element uptake in marine bivalve shells: Model verification
on pacific oyster shells (Crassostrea gigas), Geosci. Model Dev. Discuss.,
https://doi.org/10.5194/gmd-2017-137, in review, 2017.</p>


<h3>See Also</h3>

<p>&quot;Oyster_av_thickness&quot;</p>

<hr>
<h2 id='Oyster_import_TIF'>Function that imports a TIF file</h2><span id='topic+Oyster_import_TIF'></span>

<h3>Description</h3>

<p>Function that imports an image in TIF or TIFF format of an XRF map.
de Winter, N. J. (2017) &lt;doi:10.5194/gmd-2017-137&gt;</p>


<h3>Usage</h3>

<pre><code class='language-R'>Oyster_import_TIF(file_name)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Oyster_import_TIF_+3A_file_name">file_name</code></td>
<td>
<p>String of full name of the TIF(F) that needs to be imported,
including extension</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Requires &quot;tiff&quot; package to work</p>


<h3>Value</h3>

<table>
<tr><td><code>TIF</code></td>
<td>
<p>&quot;TIF&quot; file representing the TIF(F) image in R session</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Please cite Geoscientific Model Development paper dealing with the
ShellTrace model</p>


<h3>Author(s)</h3>

<p>Niels J. de Winter</p>


<h3>Source</h3>

<p><a href="https://github.com/nielsjdewinter/ShellTrace">GitHub</a> <br />
<a href="https://doi.org/10.5194/gmd-2017-137">Manuscript</a> <br />
<a href="https://doi.org/10.5194/gmd-2017-137-supplement">Supplementary data</a> <br />
<a href="http://nidewint.wixsite.com/nielsdewinter">Author website</a>
</p>


<h3>References</h3>

<p>de Winter, N. J.: ShellTrace v1.0 ? A new approach for modelling
growth and trace element uptake in marine bivalve shells: Model verification
on pacific oyster shells (Crassostrea gigas), Geosci. Model Dev. Discuss.,
https://doi.org/10.5194/gmd-2017-137, in review, 2017.</p>


<h3>See Also</h3>

<p>&quot;Oyster_av_thickness&quot;</p>

<hr>
<h2 id='Oyster_incr_area'>Area between shell increments</h2><span id='topic+Oyster_incr_area'></span>

<h3>Description</h3>

<p>Calculates the area between this shell increment and the
previous increment and the cumulative shell cross section area at the
moment of deposition of the current increment and adds these to
the previously created increment matrix.
de Winter, N. J. (2017) &lt;doi:10.5194/gmd-2017-137&gt;</p>


<h3>Usage</h3>

<pre><code class='language-R'>Oyster_incr_area(cross_section, incr_matrix)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Oyster_incr_area_+3A_cross_section">cross_section</code></td>
<td>
<p>Digitized cross section of the shell with shell top,
bottom and growth increments relative to a common X-axis</p>
</td></tr>
<tr><td><code id="Oyster_incr_area_+3A_incr_matrix">incr_matrix</code></td>
<td>
<p>Matrix containing ages and calibrated ages for each shell
increment</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Areas between shell increments are calculated by iterating through
increments in X-direction (dx) and adding differences in Y-values between
increments</p>


<h3>Value</h3>

<table>
<tr><td><code>incr_matrix</code></td>
<td>
<p>Matrix containing ages and calibrated ages for each shell
increment</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Please cite Geoscientific Model Development paper dealing with the
ShellTrace model</p>


<h3>Author(s)</h3>

<p>Niels J. de Winter</p>


<h3>Source</h3>

<p><a href="https://github.com/nielsjdewinter/ShellTrace">GitHub</a> <br />
<a href="https://doi.org/10.5194/gmd-2017-137">Manuscript</a> <br />
<a href="https://doi.org/10.5194/gmd-2017-137-supplement">Supplementary data</a> <br />
<a href="http://nidewint.wixsite.com/nielsdewinter">Author website</a>
</p>


<h3>References</h3>

<p>de Winter, N. J.: ShellTrace v1.0 ? A new approach for modelling
growth and trace element uptake in marine bivalve shells: Model verification
on pacific oyster shells (Crassostrea gigas), Geosci. Model Dev. Discuss.,
https://doi.org/10.5194/gmd-2017-137, in review, 2017.</p>


<h3>Examples</h3>

<pre><code class='language-R'>  incr_matrix1&lt;-Oyster_incr_area(cross_section, incr_matrix0)
</code></pre>

<hr>
<h2 id='Oyster_incr_cross_section'>Formula that interpolates shell increments</h2><span id='topic+Oyster_incr_cross_section'></span>

<h3>Description</h3>

<p>Formula that takes the coordinates of digitized shell increments
and interpolates a number of sub-increments between them to increase
the time resolution of the growth model. The number of interpolated
shell increments as well as the relative thickness of these increments
is determined by a sinusoidal seasonal model that simulates seasonal
variations in shell growth rate.
de Winter, N. J. (2017) &lt;doi:10.5194/gmd-2017-137&gt;</p>


<h3>Usage</h3>

<pre><code class='language-R'>Oyster_incr_cross_section(incr_matrix, cross_section, season_length,
  Tstep=1, Xstep=0.1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Oyster_incr_cross_section_+3A_incr_matrix">incr_matrix</code></td>
<td>
<p>Matrix listing characteristics of each digitized
increment</p>
</td></tr>
<tr><td><code id="Oyster_incr_cross_section_+3A_cross_section">cross_section</code></td>
<td>
<p>Digitized cross section of the shell with shell top,
bottom and growth increments relative to a common X-axis</p>
</td></tr>
<tr><td><code id="Oyster_incr_cross_section_+3A_season_length">season_length</code></td>
<td>
<p>Length (in days) of the growth season of the
studied bivalve</p>
</td></tr>
<tr><td><code id="Oyster_incr_cross_section_+3A_tstep">Tstep</code></td>
<td>
<p>The step size (dt) in time (days) used to interpolate
the existing shell increments</p>
</td></tr>
<tr><td><code id="Oyster_incr_cross_section_+3A_xstep">Xstep</code></td>
<td>
<p>The step size (dx) in X-direction used to interpolate
coordinates of shell increments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Sub-increments are reconstructed by interpolating Y-values between
the digitized shell increments</p>


<h3>Value</h3>

<p>List of two data frames:
</p>
<table>
<tr><td><code>IncG</code></td>
<td>
<p>Matrix of X- and Y-coordinates of all interpolated sub-increments</p>
</td></tr>
<tr><td><code>subincr_matrix</code></td>
<td>
<p>Revised version of the &quot;incr_matrix&quot; data frame that
contains characteristics (sub-increment number, X-value of start of
increment) recalculated for every sub-increment</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Please cite Geoscientific Model Development paper dealing with the
ShellTrace model</p>


<h3>Author(s)</h3>

<p>Niels J. de Winter</p>


<h3>Source</h3>

<p><a href="https://github.com/nielsjdewinter/ShellTrace">GitHub</a> <br />
<a href="https://doi.org/10.5194/gmd-2017-137">Manuscript</a> <br />
<a href="https://doi.org/10.5194/gmd-2017-137-supplement">Supplementary data</a> <br />
<a href="http://nidewint.wixsite.com/nielsdewinter">Author website</a>
</p>


<h3>References</h3>

<p>de Winter, N. J.: ShellTrace v1.0 ? A new approach for modelling
growth and trace element uptake in marine bivalve shells: Model verification
on pacific oyster shells (Crassostrea gigas), Geosci. Model Dev. Discuss.,
https://doi.org/10.5194/gmd-2017-137, in review, 2017.</p>


<h3>Examples</h3>

<pre><code class='language-R'>  Lsub&lt;-Oyster_incr_cross_section(incr_matrix3, cross_section, season_length=250,
  Tstep=1, Xstep=1)
</code></pre>

<hr>
<h2 id='Oyster_length'>Measured length of the shell</h2><span id='topic+Oyster_length'></span>

<h3>Description</h3>

<p>A single value containing the measured length (in 
anterio-posterior direction) in mm of the Crassostrea
gigas #1 oyster used as an example in de Winter (2017) GMD.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Oyster_length)
</code></pre>


<h3>Format</h3>

<p>A single value:
</p>

<p>Lenght in mm of the Crassostrea gigas #1 shell
</p>


<h3>Source</h3>

<p><a href="https://doi.org/10.5194/gmd-2017-137-supplement">https://doi.org/10.5194/gmd-2017-137-supplement</a>
</p>

<hr>
<h2 id='Oyster_Mass_gain'>Formula that calculates mass increase of bivalve shell with time</h2><span id='topic+Oyster_Mass_gain'></span>

<h3>Description</h3>

<p>Formula that takes the modelled volume of a bivalve shell by
sub-increment and calculates mass increase using variable shell density.
de Winter, N. J. (2017) &lt;doi:10.5194/gmd-2017-137&gt;</p>


<h3>Usage</h3>

<pre><code class='language-R'>Oyster_Mass_gain(subincr_matrix, phase_mat, phases)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Oyster_Mass_gain_+3A_subincr_matrix">subincr_matrix</code></td>
<td>
<p>Data frame that contains characteristics of
every sub-increment</p>
</td></tr>
<tr><td><code id="Oyster_Mass_gain_+3A_phase_mat">phase_mat</code></td>
<td>
<p>Matrix of amounts of pixels of each phase per sub-increment</p>
</td></tr>
<tr><td><code id="Oyster_Mass_gain_+3A_phases">phases</code></td>
<td>
<p>Matrix containing colour, density and trace element data of the
phases in the XRF phase map</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calculates mass gain from modelled changes in volume based on the shell
density
</p>


<h3>Value</h3>

<table>
<tr><td><code>subincr_matrix</code></td>
<td>
<p>Updated data frame that contains characteristics
of every sub-increment with modelled shell mass calculations added to
the matrix</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Please cite Geoscientific Model Development paper dealing with the
ShellTrace model</p>


<h3>Author(s)</h3>

<p>Niels J. de Winter</p>


<h3>Source</h3>

<p><a href="https://github.com/nielsjdewinter/ShellTrace">GitHub</a> <br />
<a href="https://doi.org/10.5194/gmd-2017-137">Manuscript</a> <br />
<a href="https://doi.org/10.5194/gmd-2017-137-supplement">Supplementary data</a> <br />
<a href="http://nidewint.wixsite.com/nielsdewinter">Author website</a>
</p>


<h3>References</h3>

<p>de Winter, N. J.: ShellTrace v1.0 ? A new approach for
modelling growth and trace element uptake in marine bivalve shells:
Model verification on pacific oyster shells (Crassostrea gigas),
Geosci. Model Dev. Discuss., https://doi.org/10.5194/gmd-2017-137,
in review, 2017.</p>


<h3>See Also</h3>

<p>&quot;Oyster_av_thickness&quot;</p>


<h3>Examples</h3>

<pre><code class='language-R'>  subincr_matrix6&lt;-Oyster_Mass_gain(subincr_matrix5, phase_mat, O1_phase)
</code></pre>

<hr>
<h2 id='Oyster_phase_export'>Export results of trace element model</h2><span id='topic+Oyster_phase_export'></span>

<h3>Description</h3>

<p>A function that takes all the matrices with results of the trace
element model and exports them as XLSX files.
de Winter, N. J. (2017) &lt;doi:10.5194/gmd-2017-137&gt;</p>


<h3>Usage</h3>

<pre><code class='language-R'>Oyster_phase_export(phase_stat, el_time, M_el_mat, M_el_mat_c, name_shell)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Oyster_phase_export_+3A_phase_stat">phase_stat</code></td>
<td>
<p>matrix of statistics of trace elements and phases in
the total map</p>
</td></tr>
<tr><td><code id="Oyster_phase_export_+3A_el_time">el_time</code></td>
<td>
<p>Matrix of trace element concentrations through time</p>
</td></tr>
<tr><td><code id="Oyster_phase_export_+3A_m_el_mat">M_el_mat</code></td>
<td>
<p>Matrix of mass accumulation per trace element</p>
</td></tr>
<tr><td><code id="Oyster_phase_export_+3A_m_el_mat_c">M_el_mat_c</code></td>
<td>
<p>Matrix of cumulative mass accumulation per trace element</p>
</td></tr>
<tr><td><code id="Oyster_phase_export_+3A_name_shell">name_shell</code></td>
<td>
<p>Name of the shell used in the model to be incorporated
into the file names</p>
</td></tr>
</table>


<h3>Details</h3>

<p>All matrices fed to the function are exported as XLSX files in the
working directory using the &quot; write.xlsx&quot;  function of the &quot;xlsx&quot; package</p>


<h3>Value</h3>

<p>XLSX files of all result matrices of the trace element model</p>


<h3>Note</h3>

<p>Please cite Geoscientific Model Development paper dealing with the
ShellTrace model</p>


<h3>Author(s)</h3>

<p>Niels J. de Winter</p>


<h3>Source</h3>

<p><a href="https://github.com/nielsjdewinter/ShellTrace">GitHub</a> <br />
<a href="https://doi.org/10.5194/gmd-2017-137">Manuscript</a> <br />
<a href="https://doi.org/10.5194/gmd-2017-137-supplement">Supplementary data</a> <br />
<a href="http://nidewint.wixsite.com/nielsdewinter">Author website</a>
</p>


<h3>References</h3>

<p>de Winter, N. J.: ShellTrace v1.0 ? A new approach for modelling
growth and trace element uptake in marine bivalve shells: Model verification
on pacific oyster shells (Crassostrea gigas), Geosci. Model Dev. Discuss.,
https://doi.org/10.5194/gmd-2017-137, in review, 2017.</p>


<h3>See Also</h3>

<p>&quot;Oyster_Export&quot;</p>


<h3>Examples</h3>

<pre><code class='language-R'>  ## Not run: 
    Oyster_phase_export(phase_stat, el_time, M_el_mat, M_el_mat_c, "test")
  
## End(Not run)
</code></pre>

<hr>
<h2 id='Oyster_phase_matrix_BMP'>Function that calculates phase matrix</h2><span id='topic+Oyster_phase_matrix_BMP'></span>

<h3>Description</h3>

<p>Function that calculates a matrix of phase numbers for every pixel
in the imported BMP file.
de Winter, N. J. (2017) &lt;doi:10.5194/gmd-2017-137&gt;</p>


<h3>Usage</h3>

<pre><code class='language-R'>Oyster_phase_matrix_BMP(BMP, phases)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Oyster_phase_matrix_BMP_+3A_bmp">BMP</code></td>
<td>
<p>&quot;BMP&quot; file representing the BMP image in R session</p>
</td></tr>
<tr><td><code id="Oyster_phase_matrix_BMP_+3A_phases">phases</code></td>
<td>
<p>Matrix containing colour, density and trace element data of the
phases in the XRF phase map</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function compares the colour data from the &quot;BMP&quot; object with
colour codes of phases in &quot;phases&quot; table to assign a phase to every pixel
in the BMP</p>


<h3>Value</h3>

<table>
<tr><td><code>phasemat</code></td>
<td>
<p>matrix of phases of each pixel sorted by X- and Y-coordinate
of the pixel</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Please cite Geoscientific Model Development paper dealing with the
ShellTrace model</p>


<h3>Author(s)</h3>

<p>Niels J. de Winter</p>


<h3>Source</h3>

<p><a href="https://github.com/nielsjdewinter/ShellTrace">GitHub</a> <br />
<a href="https://doi.org/10.5194/gmd-2017-137">Manuscript</a> <br />
<a href="https://doi.org/10.5194/gmd-2017-137-supplement">Supplementary data</a> <br />
<a href="http://nidewint.wixsite.com/nielsdewinter">Author website</a>
</p>


<h3>References</h3>

<p>de Winter, N. J.: ShellTrace v1.0 ? A new approach for modelling
growth and trace element uptake in marine bivalve shells: Model verification
on pacific oyster shells (Crassostrea gigas), Geosci. Model Dev. Discuss.,
https://doi.org/10.5194/gmd-2017-137, in review, 2017.</p>


<h3>See Also</h3>

<p>&quot;Oyster_av_thickness&quot;</p>


<h3>Examples</h3>

<pre><code class='language-R'>  ## Not run: 
    phasemat&lt;-Oyster_phase_matrix_BMP(BMP, O1_phase)
  
## End(Not run)
</code></pre>

<hr>
<h2 id='Oyster_phase_matrix_TIF'>Function that calculates phase matrix</h2><span id='topic+Oyster_phase_matrix_TIF'></span>

<h3>Description</h3>

<p>Function that calculates a matrix of phase numbers for every pixel
in the imported TIF file.
de Winter, N. J. (2017) &lt;doi:10.5194/gmd-2017-137&gt;</p>


<h3>Usage</h3>

<pre><code class='language-R'>Oyster_phase_matrix_TIF(TIF, phases)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Oyster_phase_matrix_TIF_+3A_tif">TIF</code></td>
<td>
<p>&quot;TIF&quot; file representing the TIF(F) image in R session</p>
</td></tr>
<tr><td><code id="Oyster_phase_matrix_TIF_+3A_phases">phases</code></td>
<td>
<p>Matrix containing colour and trace element data of the phases
in the XRF phase map</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function compares the colour data from the &quot;TIF&quot; object with colour
codes of phases in &quot;phases&quot; table to assign a phase to every pixel in the
TIF(F)</p>


<h3>Value</h3>

<table>
<tr><td><code>phasemat</code></td>
<td>
<p>matrix of phases of each pixel sorted by X- and Y-coordinate
of the pixel</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Please cite Geoscientific Model Development paper dealing with the
ShellTrace model</p>


<h3>Author(s)</h3>

<p>Niels J. de Winter</p>


<h3>Source</h3>

<p><a href="https://github.com/nielsjdewinter/ShellTrace">GitHub</a> <br />
<a href="https://doi.org/10.5194/gmd-2017-137">Manuscript</a> <br />
<a href="https://doi.org/10.5194/gmd-2017-137-supplement">Supplementary data</a> <br />
<a href="http://nidewint.wixsite.com/nielsdewinter">Author website</a>
</p>


<h3>References</h3>

<p>de Winter, N. J.: ShellTrace v1.0 ? A new approach for modelling
growth and trace element uptake in marine bivalve shells: Model verification
on pacific oyster shells (Crassostrea gigas), Geosci. Model Dev. Discuss.,
https://doi.org/10.5194/gmd-2017-137, in review, 2017.</p>


<h3>See Also</h3>

<p>&quot;Oyster_av_thickness&quot;</p>


<h3>Examples</h3>

<pre><code class='language-R'>  ## Not run: 
    phasemat&lt;-Oyster_phase_matrix_TIF(TIF, O1_phase)
  
## End(Not run)
</code></pre>

<hr>
<h2 id='Oyster_phase_run'>Runs the entire trace element model</h2><span id='topic+Oyster_phase_run'></span>

<h3>Description</h3>

<p>Function that runs all functions contained in Step 5 and 6 of the
trace element model.
de Winter, N. J. (2017) &lt;doi:10.5194/gmd-2017-137&gt;</p>


<h3>Usage</h3>

<pre><code class='language-R'>Oyster_phase_run(LOG=T, phases_name, image_name, image_ext, IncG,
  pixelsize, subincr_matrix, npma=10, name_shell, name_file)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Oyster_phase_run_+3A_log">LOG</code></td>
<td>
<p>Boolean parameter specifying if a LOG should be printed
detailing the parameters entered into this function</p>
</td></tr>
<tr><td><code id="Oyster_phase_run_+3A_phases_name">phases_name</code></td>
<td>
<p>String of full name (including extension!) of the CSV
file that contains information about the phases in the map</p>
</td></tr>
<tr><td><code id="Oyster_phase_run_+3A_image_name">image_name</code></td>
<td>
<p>String of full name of the BMP that needs to be imported,
excluding extension</p>
</td></tr>
<tr><td><code id="Oyster_phase_run_+3A_image_ext">image_ext</code></td>
<td>
<p>Extention of phase map file (&quot;BMP&quot; or &quot;TIF&quot;)</p>
</td></tr>
<tr><td><code id="Oyster_phase_run_+3A_incg">IncG</code></td>
<td>
<p>Matrix of X- and Y-coordinates of all interpolated
sub-increments</p>
</td></tr>
<tr><td><code id="Oyster_phase_run_+3A_pixelsize">pixelsize</code></td>
<td>
<p>Size of pixels in phase map in micrometeres</p>
</td></tr>
<tr><td><code id="Oyster_phase_run_+3A_subincr_matrix">subincr_matrix</code></td>
<td>
<p>Revised version of the &quot;yearly_matrix&quot; data
frame that contains characteristics calculated for every sub-increment</p>
</td></tr>
<tr><td><code id="Oyster_phase_run_+3A_npma">npma</code></td>
<td>
<p>Window size of the moving average used to smooth mass gain
record from the bivalve growth model</p>
</td></tr>
<tr><td><code id="Oyster_phase_run_+3A_name_shell">name_shell</code></td>
<td>
<p>string indicating the name that should be added to all
exported model results</p>
</td></tr>
<tr><td><code id="Oyster_phase_run_+3A_name_file">name_file</code></td>
<td>
<p>string indicating the name of the exported results file</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Runs Oyser_run_sec5, Oyser_run_sec6 and Oyster_phase_export</p>


<h3>Value</h3>

<p>XLSX files of all result matrices of the trace element model as well as a
list containing these matrices:
</p>
<table>
<tr><td><code>phase_stat</code></td>
<td>
<p>matrix of statistics of trace elements and phases in
the total map</p>
</td></tr>
<tr><td><code>el_time</code></td>
<td>
<p>Matrix of trace element concentrations through time</p>
</td></tr>
<tr><td><code>M_el_mat</code></td>
<td>
<p>Matrix of mass accumulation per trace element</p>
</td></tr>
<tr><td><code>M_el_mat_c</code></td>
<td>
<p>Matrix of cumulative mass accumulation per trace element</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Please cite Geoscientific Model Development paper dealing with the
ShellTrace model</p>


<h3>Author(s)</h3>

<p>Niels J. de Winter</p>


<h3>Source</h3>

<p><a href="https://github.com/nielsjdewinter/ShellTrace">GitHub</a> <br />
<a href="https://doi.org/10.5194/gmd-2017-137">Manuscript</a> <br />
<a href="https://doi.org/10.5194/gmd-2017-137-supplement">Supplementary data</a> <br />
<a href="http://nidewint.wixsite.com/nielsdewinter">Author website</a>
</p>


<h3>References</h3>

<p>de Winter, N. J.: ShellTrace v1.0 ? A new approach for modelling
growth and trace element uptake in marine bivalve shells: Model
verification on pacific oyster shells (Crassostrea gigas),
Geosci. Model Dev. Discuss., https://doi.org/10.5194/gmd-2017-137,
in review, 2017.</p>

<hr>
<h2 id='Oyster_phase_stats'>Function that exports phase statistics</h2><span id='topic+Oyster_phase_stats'></span>

<h3>Description</h3>

<p>Function that searches through the matrix of phases per pixel and
exports the statistics of representation of different phases in the map as
well as the bulk composition of pixels in the map.
de Winter, N. J. (2017) &lt;doi:10.5194/gmd-2017-137&gt;</p>


<h3>Usage</h3>

<pre><code class='language-R'>Oyster_phase_stats(phasemat, phases)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Oyster_phase_stats_+3A_phasemat">phasemat</code></td>
<td>
<p>matrix of phases of each pixel sorted by X- and Y-coordinate
of the pixel</p>
</td></tr>
<tr><td><code id="Oyster_phase_stats_+3A_phases">phases</code></td>
<td>
<p>Matrix containing colour and trace element data of the phases
in the XRF phase map</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Phase statistics are calculated by looping through the matrix of phases
created from the XRF phase map and comparing with the &quot;phases&quot; statistics
table</p>


<h3>Value</h3>

<table>
<tr><td><code>phase_stat</code></td>
<td>
<p>matrix of statistics of trace elements and phases in the
total map</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Please cite Geoscientific Model Development paper dealing with the
ShellTrace model</p>


<h3>Author(s)</h3>

<p>Niels J. de Winter</p>


<h3>Source</h3>

<p><a href="https://github.com/nielsjdewinter/ShellTrace">GitHub</a> <br />
<a href="https://doi.org/10.5194/gmd-2017-137">Manuscript</a> <br />
<a href="https://doi.org/10.5194/gmd-2017-137-supplement">Supplementary data</a> <br />
<a href="http://nidewint.wixsite.com/nielsdewinter">Author website</a>
</p>


<h3>References</h3>

<p>de Winter, N. J.: ShellTrace v1.0 ? A new approach for modelling
growth and trace element uptake in marine bivalve shells: Model verification
on pacific oyster shells (Crassostrea gigas), Geosci. Model Dev. Discuss.,
https://doi.org/10.5194/gmd-2017-137, in review, 2017.</p>


<h3>See Also</h3>

<p>&quot;Oyster_phase_matrix_BMP&quot;</p>


<h3>Examples</h3>

<pre><code class='language-R'>  phase_stat&lt;-Oyster_phase_stats(phasemat, O1_phase)
</code></pre>

<hr>
<h2 id='Oyster_plot_cross_section'>Plot the converted shell cross section</h2><span id='topic+Oyster_plot_cross_section'></span>

<h3>Description</h3>

<p>Simple function that returns a plot of the shell cross section
after it has been converted to a common X-axis.
de Winter, N. J. (2017) &lt;doi:10.5194/gmd-2017-137&gt;</p>


<h3>Usage</h3>

<pre><code class='language-R'>Oyster_plot_cross_section(cross_section)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Oyster_plot_cross_section_+3A_cross_section">cross_section</code></td>
<td>
<p>Digitized cross section of the shell with shell top,
bottom and growth increments relative to a common X-axis</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Plotting of digitized cross section after first modelling step to
verify the correct digitization of the shell increments</p>


<h3>Value</h3>

<p>Opens a new plotting window to plot the shell cross section based on
its X- and Y-coordinates
</p>


<h3>Note</h3>

<p>Please cite Geoscientific Model Development paper dealing with the
ShellTrace model</p>


<h3>Author(s)</h3>

<p>Niels J. de Winter</p>


<h3>Source</h3>

<p><a href="https://github.com/nielsjdewinter/ShellTrace">GitHub</a> <br />
<a href="https://doi.org/10.5194/gmd-2017-137">Manuscript</a> <br />
<a href="https://doi.org/10.5194/gmd-2017-137-supplement">Supplementary data</a> <br />
<a href="http://nidewint.wixsite.com/nielsdewinter">Author website</a>
</p>


<h3>References</h3>

<p>de Winter, N. J.: ShellTrace v1.0 ? A new approach for modelling
growth and trace element uptake in marine bivalve shells: Model
verification on pacific oyster shells (Crassostrea gigas), Geosci.
Model Dev. Discuss., https://doi.org/10.5194/gmd-2017-137, in review,
2017.</p>


<h3>Examples</h3>

<pre><code class='language-R'>  Oyster_plot_cross_section(cross_section)
</code></pre>

<hr>
<h2 id='Oyster_plot_incr_CS'>Plot the result of interpolation of sub-increments</h2><span id='topic+Oyster_plot_incr_CS'></span>

<h3>Description</h3>

<p>Formula that plots the result of the interpolation of digitized
shell growth increments to reconstruct sub-increments to provide a check
on the progress of the model.
de Winter, N. J. (2017) &lt;doi:10.5194/gmd-2017-137&gt;</p>


<h3>Usage</h3>

<pre><code class='language-R'>Oyster_plot_incr_CS(IncG, incr_matrix, Tstep)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Oyster_plot_incr_CS_+3A_incg">IncG</code></td>
<td>
<p>Matrix of X- and Y-coordinates of all interpolated
sub-increments</p>
</td></tr>
<tr><td><code id="Oyster_plot_incr_CS_+3A_incr_matrix">incr_matrix</code></td>
<td>
<p>Matrix listing characteristics of each digitized
increment</p>
</td></tr>
<tr><td><code id="Oyster_plot_incr_CS_+3A_tstep">Tstep</code></td>
<td>
<p>The step size (dt) in time (days) used to interpolate
the existing shell increments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In order to prevent overcrowding the plot area and slowing the
plotting process, only original shell increments and sub-increments
halfway between original increments are plotted. Sub-increments are
colored blue</p>


<h3>Value</h3>

<p>No data is exported, but a plot showing interpolated sub-increments is
given in a separate window.
</p>


<h3>Note</h3>

<p>Please cite Geoscientific Model Development paper dealing with the
ShellTrace model</p>


<h3>Author(s)</h3>

<p>Niels J. de Winter</p>


<h3>Source</h3>

<p><a href="https://github.com/nielsjdewinter/ShellTrace">GitHub</a> <br />
<a href="https://doi.org/10.5194/gmd-2017-137">Manuscript</a> <br />
<a href="https://doi.org/10.5194/gmd-2017-137-supplement">Supplementary data</a> <br />
<a href="http://nidewint.wixsite.com/nielsdewinter">Author website</a>
</p>


<h3>References</h3>

<p>de Winter, N. J.: ShellTrace v1.0 - A new approach for modelling
growth and trace element uptake in marine bivalve shells: Model verification
on pacific oyster shells (Crassostrea gigas), Geosci. Model Dev. Discuss.,
https://doi.org/10.5194/gmd-2017-137, in review, 2017.</p>


<h3>Examples</h3>

<pre><code class='language-R'>  Oyster_plot_incr_CS(IncG,incr_matrix3,Tstep=1)
</code></pre>

<hr>
<h2 id='Oyster_plot_incr_fill'>Plot the result of interpolation of sub-increments with a coloured
area plot</h2><span id='topic+Oyster_plot_incr_fill'></span>

<h3>Description</h3>

<p>Formula that plots the result of the interpolation of digitized
shell growth increments to reconstruct sub-increments to provide a check
on the progress of the model. Areas between sub-increments are coloured
in direction of growth using the heat colour palette.
de Winter, N. J. (2017) &lt;doi:10.5194/gmd-2017-137&gt;</p>


<h3>Usage</h3>

<pre><code class='language-R'>Oyster_plot_incr_fill(IncG)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Oyster_plot_incr_fill_+3A_incg">IncG</code></td>
<td>
<p>Matrix of X- and Y-coordinates of all interpolated
sub-increments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Areas between sub-increments are represented by coloured polygons,
while digitized increments are plotted using black lines. High numbers
of interpolated sub-increments can cause plotting to become slow</p>


<h3>Value</h3>

<p>No data is exported, but a coloured plot showing interpolated sub-increments
is given in a separate window.
</p>


<h3>Note</h3>

<p>Please cite Geoscientific Model Development paper dealing with the
ShellTrace model</p>


<h3>Author(s)</h3>

<p>Niels J. de Winter</p>


<h3>Source</h3>

<p><a href="https://github.com/nielsjdewinter/ShellTrace">GitHub</a> <br />
<a href="https://doi.org/10.5194/gmd-2017-137">Manuscript</a> <br />
<a href="https://doi.org/10.5194/gmd-2017-137-supplement">Supplementary data</a> <br />
<a href="http://nidewint.wixsite.com/nielsdewinter">Author website</a>
</p>


<h3>References</h3>

<p>de Winter, N. J.: ShellTrace v1.0 - A new approach for modelling
growth and trace element uptake in marine bivalve shells: Model verification
on pacific oyster shells (Crassostrea gigas), Geosci. Model Dev. Discuss.,
https://doi.org/10.5194/gmd-2017-137, in review, 2017.</p>


<h3>Examples</h3>

<pre><code class='language-R'>  Oyster_plot_incr_fill(IncG)
</code></pre>

<hr>
<h2 id='Oyster_run_sec2'>Runs complete Step 2 of the growth model</h2><span id='topic+Oyster_run_sec2'></span>

<h3>Description</h3>

<p>Function that combines all functions in Step 2 of the bivalve
growth model and runs them consecutively given the right input.
de Winter, N. J. (2017) &lt;doi:10.5194/gmd-2017-137&gt;</p>


<h3>Usage</h3>

<pre><code class='language-R'>Oyster_run_sec2(raw_data, image_length, Xstep)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Oyster_run_sec2_+3A_raw_data">raw_data</code></td>
<td>
<p>Numeric data frame containing the X- and Y-coordinates
digitized in Adobe Illustrator or another image processing software</p>
</td></tr>
<tr><td><code id="Oyster_run_sec2_+3A_image_length">image_length</code></td>
<td>
<p>Measured maximum length of the area of the cross
section that is represented in raw_data</p>
</td></tr>
<tr><td><code id="Oyster_run_sec2_+3A_xstep">Xstep</code></td>
<td>
<p>The step size (dx) in X-direction used to interpolate
coordinates of shell increments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function runs the functions Oyster_Convert_cross_section,
Oyster_plot_cross_section, Oyster_incr_area, Oyster_Shell_thickness
and Oyster_Shell_height consecutively</p>


<h3>Value</h3>

<p>List of three items:
</p>
<table>
<tr><td><code>cross_section</code></td>
<td>
<p>Digitized cross section of the shell with shell top,
bottom and growth increments relative to a common X-axis</p>
</td></tr>
<tr><td><code>incr_matrix</code></td>
<td>
<p>Matrix listing characteristics of each digitized
increment</p>
</td></tr>
<tr><td><code>lengthfactor</code></td>
<td>
<p>Factor of actual shell length relative to shell
length in cross section, used to constrain pixelsize in phase map</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Please cite Geoscientific Model Development paper dealing with
the ShellTrace model</p>


<h3>Author(s)</h3>

<p>Niels J. de Winter</p>


<h3>Source</h3>

<p><a href="https://github.com/nielsjdewinter/ShellTrace">GitHub</a> <br />
<a href="https://doi.org/10.5194/gmd-2017-137">Manuscript</a> <br />
<a href="https://doi.org/10.5194/gmd-2017-137-supplement">Supplementary data</a> <br />
<a href="http://nidewint.wixsite.com/nielsdewinter">Author website</a>
</p>


<h3>References</h3>

<p>de Winter, N. J.: ShellTrace v1.0 ? A new approach for
modelling growth and trace element uptake in marine bivalve shells:
Model verification on pacific oyster shells (Crassostrea gigas),
Geosci. Model Dev. Discuss., https://doi.org/10.5194/gmd-2017-137,
in review, 2017.</p>


<h3>Examples</h3>

<pre><code class='language-R'>  List2&lt;-Oyster_run_sec2(O1_input, image_length, Xstep=1)
</code></pre>

<hr>
<h2 id='Oyster_run_sec3'>Runs complete Step 3 of the growth model</h2><span id='topic+Oyster_run_sec3'></span>

<h3>Description</h3>

<p>Function that combines all functions in Step 3 of the bivalve
growth model and runs them consecutively given the right input.
de Winter, N. J. (2017) &lt;doi:10.5194/gmd-2017-137&gt;</p>


<h3>Usage</h3>

<pre><code class='language-R'>Oyster_run_sec3(cross_section, incr_matrix, season_length=250, Xstep=0.1,
  Tstep=1, Oyster_height, Oyster_length)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Oyster_run_sec3_+3A_cross_section">cross_section</code></td>
<td>
<p>Digitized cross section of the shell with shell top,
bottom and growth increments relative to a common X-axis</p>
</td></tr>
<tr><td><code id="Oyster_run_sec3_+3A_incr_matrix">incr_matrix</code></td>
<td>
<p>Matrix listing characteristics of each digitized
increment</p>
</td></tr>
<tr><td><code id="Oyster_run_sec3_+3A_season_length">season_length</code></td>
<td>
<p>Length (in days) of the growth season of the
studied bivalve</p>
</td></tr>
<tr><td><code id="Oyster_run_sec3_+3A_xstep">Xstep</code></td>
<td>
<p>The step size (dx) in X-direction used to interpolate
coordinates of shell increments</p>
</td></tr>
<tr><td><code id="Oyster_run_sec3_+3A_tstep">Tstep</code></td>
<td>
<p>The step size (dt) in time (days) used to interpolate
the existing shell increments</p>
</td></tr>
<tr><td><code id="Oyster_run_sec3_+3A_oyster_height">Oyster_height</code></td>
<td>
<p>Measured maximum height of the shell</p>
</td></tr>
<tr><td><code id="Oyster_run_sec3_+3A_oyster_length">Oyster_length</code></td>
<td>
<p>Measured maximum length of the shell in anterio-posterior direction</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function runs the functions Oyster_Increment_cross_section,
Oyster_plot_Inc_CS, Oyster_Inc_fill, Oyster_subincr_area,
Oyster_subincr_shell_height, Oyster_subincr_av_thickness and
Oyster_ellipse_parameters consecutively</p>


<h3>Value</h3>

<p>List of two items:
</p>
<table>
<tr><td><code>IncG</code></td>
<td>
<p>Matrix of X- and Y-coordinates of all interpolated
sub-increments</p>
</td></tr>
<tr><td><code>subincr_matrix</code></td>
<td>
<p>Revised version of the &quot;yearly_matrix&quot; data
frame that contains characteristics (sub-increment number, X-value
of start of increment) recalculated for every sub-increment</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Please cite Geoscientific Model Development paper dealing with
the ShellTrace model</p>


<h3>Author(s)</h3>

<p>Niels J. de Winter</p>


<h3>Source</h3>

<p><a href="https://github.com/nielsjdewinter/ShellTrace">GitHub</a> <br />
<a href="https://doi.org/10.5194/gmd-2017-137">Manuscript</a> <br />
<a href="https://doi.org/10.5194/gmd-2017-137-supplement">Supplementary data</a> <br />
<a href="http://nidewint.wixsite.com/nielsdewinter">Author website</a>
</p>


<h3>References</h3>

<p>de Winter, N. J.: ShellTrace v1.0 ? A new approach for
modelling growth and trace element uptake in marine bivalve shells:
Model verification on pacific oyster shells (Crassostrea gigas),
Geosci. Model Dev. Discuss., https://doi.org/10.5194/gmd-2017-137,
in review, 2017.</p>


<h3>Examples</h3>

<pre><code class='language-R'>  List3&lt;-Oyster_run_sec3(cross_section, incr_matrix3, season_length=250, Xstep=1,
  Tstep=1, Oyster_height, Oyster_length)
</code></pre>

<hr>
<h2 id='Oyster_run_sec4'>Runs complete Step 4 of the growth model</h2><span id='topic+Oyster_run_sec4'></span>

<h3>Description</h3>

<p>Function that combines all functions in Step 4 of the bivalve growth
model and runs them consecutively given the right input.
de Winter, N. J. (2017) &lt;doi:10.5194/gmd-2017-137&gt;</p>


<h3>Usage</h3>

<pre><code class='language-R'>Oyster_run_sec4(IncG, subincr_matrix, Xstep = 0.1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Oyster_run_sec4_+3A_incg">IncG</code></td>
<td>
<p>Matrix of X- and Y-coordinates of all interpolated sub-increments</p>
</td></tr>
<tr><td><code id="Oyster_run_sec4_+3A_subincr_matrix">subincr_matrix</code></td>
<td>
<p>Revised version of the &quot;yearly_matrix&quot; data frame that
contains characteristics calculated for every sub-increment</p>
</td></tr>
<tr><td><code id="Oyster_run_sec4_+3A_xstep">Xstep</code></td>
<td>
<p>The step size (dx) in X-direction used to interpolate coordinates
of shell increments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function runs the functions Oyster_Z_matrices and Oyster_Volumes
consecutively</p>


<h3>Value</h3>

<p>A list of two items:
</p>
<table>
<tr><td><code>subincr_matrix</code></td>
<td>
<p>Revised version of the &quot;incr_matrix&quot; data frame that
contains characteristics calculated for every sub-increment</p>
</td></tr>
<tr><td><code>IncGAnet</code></td>
<td>
<p>Matrix of areas of cross sections in YZ-directions sorted by
X-values and by sub-increment</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Please cite Geoscientific Model Development paper dealing with the
ShellTrace model</p>


<h3>Author(s)</h3>

<p>Niels J. de Winter</p>


<h3>Source</h3>

<p><a href="https://github.com/nielsjdewinter/ShellTrace">GitHub</a> <br />
<a href="https://doi.org/10.5194/gmd-2017-137">Manuscript</a> <br />
<a href="https://doi.org/10.5194/gmd-2017-137-supplement">Supplementary data</a> <br />
<a href="http://nidewint.wixsite.com/nielsdewinter">Author website</a>
</p>


<h3>References</h3>

<p>de Winter, N. J.: ShellTrace v1.0 ? A new approach for modelling
growth and trace element uptake in marine bivalve shells: Model verification
on pacific oyster shells (Crassostrea gigas), Geosci. Model Dev. Discuss.,
https://doi.org/10.5194/gmd-2017-137, in review, 2017.</p>


<h3>Examples</h3>

<pre><code class='language-R'>  ## Not run: 
    List4&lt;-Oyster_run_sec4(IncG, subincr_matrix4, Xstep = 1)
  
## End(Not run)
</code></pre>

<hr>
<h2 id='Oyster_run_sec5'>Runs complete Step 5 of the trace element model</h2><span id='topic+Oyster_run_sec5'></span>

<h3>Description</h3>

<p>Function that combines all functions in Step 5 of the bivalve
trace element model and runs them consecutively given the right input.
de Winter, N. J. (2017) &lt;doi:10.5194/gmd-2017-137&gt;</p>


<h3>Usage</h3>

<pre><code class='language-R'>Oyster_run_sec5(phases_name, image_name, image_ext)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Oyster_run_sec5_+3A_phases_name">phases_name</code></td>
<td>
<p>String of full name (including extension!) of the CSV
file that contains information about the phases in the map</p>
</td></tr>
<tr><td><code id="Oyster_run_sec5_+3A_image_name">image_name</code></td>
<td>
<p>String of full name of the BMP that needs to be imported,
excluding extension</p>
</td></tr>
<tr><td><code id="Oyster_run_sec5_+3A_image_ext">image_ext</code></td>
<td>
<p>Extention of phase map file (&quot;BMP&quot; or &quot;TIF&quot;)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function runs the functions Oyster_import_phases,
Oyster_phase_matrix_BMP, Oyster_phase_matrix_TIF and Oyster_phase_stat consecutively</p>


<h3>Value</h3>

<p>List of two items:
</p>
<table>
<tr><td><code>phasemat</code></td>
<td>
<p>matrix of phases of each pixel sorted by X- and
Y-coordinate of the pixel</p>
</td></tr>
<tr><td><code>phase_stat</code></td>
<td>
<p>matrix of statistics of trace elements and phases
in the total map</p>
</td></tr>
<tr><td><code>phases</code></td>
<td>
<p>Matrix containing colour, density and trace element data of the
phases in the XRF phase map</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Please cite Geoscientific Model Development paper dealing with
the ShellTrace model</p>


<h3>Author(s)</h3>

<p>Niels J. de Winter</p>


<h3>Source</h3>

<p><a href="https://github.com/nielsjdewinter/ShellTrace">GitHub</a> <br />
<a href="https://doi.org/10.5194/gmd-2017-137">Manuscript</a> <br />
<a href="https://doi.org/10.5194/gmd-2017-137-supplement">Supplementary data</a> <br />
<a href="http://nidewint.wixsite.com/nielsdewinter">Author website</a>
</p>


<h3>References</h3>

<p>de Winter, N. J.: ShellTrace v1.0 ? A new approach for
modelling growth and trace element uptake in marine bivalve shells:
Model verification on pacific oyster shells (Crassostrea gigas),
Geosci. Model Dev. Discuss., https://doi.org/10.5194/gmd-2017-137,
in review, 2017.</p>

<hr>
<h2 id='Oyster_run_sec6'>Runs complete Step 6 of the trace element model</h2><span id='topic+Oyster_run_sec6'></span>

<h3>Description</h3>

<p>Function that combines all functions in Step 6 of the bivalve trace
element model and runs them consecutively given the right input.
de Winter, N. J. (2017) &lt;doi:10.5194/gmd-2017-137&gt;</p>


<h3>Usage</h3>

<pre><code class='language-R'>Oyster_run_sec6(phasemat, IncG, pixelsize, phases, subincr_matrix, npma,
  name_file)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Oyster_run_sec6_+3A_phasemat">phasemat</code></td>
<td>
<p>matrix of phases of each pixel sorted by X- and Y-coordinate
of the pixel</p>
</td></tr>
<tr><td><code id="Oyster_run_sec6_+3A_incg">IncG</code></td>
<td>
<p>Matrix of X- and Y-coordinates of all interpolated
sub-increments</p>
</td></tr>
<tr><td><code id="Oyster_run_sec6_+3A_pixelsize">pixelsize</code></td>
<td>
<p>size of pixels in the phase map in micrometer</p>
</td></tr>
<tr><td><code id="Oyster_run_sec6_+3A_phases">phases</code></td>
<td>
<p>Matrix containing colour and trace element data of
the phases in the XRF phase map</p>
</td></tr>
<tr><td><code id="Oyster_run_sec6_+3A_subincr_matrix">subincr_matrix</code></td>
<td>
<p>Data frame that contains characteristics of
every sub-increment</p>
</td></tr>
<tr><td><code id="Oyster_run_sec6_+3A_npma">npma</code></td>
<td>
<p>Integer n-value determining the window size of the moving
average smoothing of the mass accumulation record</p>
</td></tr>
<tr><td><code id="Oyster_run_sec6_+3A_name_file">name_file</code></td>
<td>
<p>string indicating the name of the exported results file</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function runs the functions Oyster_subincr_phases, Oyster_Mass_gain
Oyster_el_time and Oyster_accumulation consecutively</p>


<h3>Value</h3>

<p>List of three items:
</p>
<table>
<tr><td><code>el_time</code></td>
<td>
<p>Matrix of trace element concentrations through time</p>
</td></tr>
<tr><td><code>M_el_mat</code></td>
<td>
<p>Matrix of mass accumulation per trace element</p>
</td></tr>
<tr><td><code>M_el_mat_c</code></td>
<td>
<p>Matrix of cumulative mass accumulation per trace element</p>
</td></tr>
<tr><td><code>subincr_matrix</code></td>
<td>
<p>Data frame that contains characteristics of
every sub-increment</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Please cite Geoscientific Model Development paper dealing with the
ShellTrace model</p>


<h3>Author(s)</h3>

<p>Niels J. de Winter</p>


<h3>Source</h3>

<p><a href="https://github.com/nielsjdewinter/ShellTrace">GitHub</a> <br />
<a href="https://doi.org/10.5194/gmd-2017-137">Manuscript</a> <br />
<a href="https://doi.org/10.5194/gmd-2017-137-supplement">Supplementary data</a> <br />
<a href="http://nidewint.wixsite.com/nielsdewinter">Author website</a>
</p>


<h3>References</h3>

<p>de Winter, N. J.: ShellTrace v1.0 ? A new approach for modelling
growth and trace element uptake in marine bivalve shells: Model verification
on pacific oyster shells (Crassostrea gigas), Geosci. Model Dev. Discuss.,
https://doi.org/10.5194/gmd-2017-137, in review, 2017.</p>


<h3>Examples</h3>

<pre><code class='language-R'>  ## Not run: 
    List6&lt;-Oyster_run_sec6(phasemat, IncG, pixelsize, O1_phase, subincr_matrix5, npma=10,
    "test_export")
  
## End(Not run)
</code></pre>

<hr>
<h2 id='Oyster_Shell_height'>Formula that calculates shell height through time</h2><span id='topic+Oyster_Shell_height'></span>

<h3>Description</h3>

<p>Formula that calculates shell height at the moment of deposition of
each shell increment from X- and Y-coordinates of the shell increments and
adds the result to the matrix of increment characteristics.
de Winter, N. J. (2017) &lt;doi:10.5194/gmd-2017-137&gt;</p>


<h3>Usage</h3>

<pre><code class='language-R'>Oyster_Shell_height(cross_section, incr_matrix)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Oyster_Shell_height_+3A_incr_matrix">incr_matrix</code></td>
<td>
<p>Matrix listing characteristics of each digitized
increment</p>
</td></tr>
<tr><td><code id="Oyster_Shell_height_+3A_cross_section">cross_section</code></td>
<td>
<p>Digitized cross section of the shell with shell top,
bottom and growth increments relative to a common X-axis</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Shell height is calculated via the Pythagorean Theorem using the
X- and Y-coordinates of both ends of the shell increment with extreme
X-values</p>


<h3>Value</h3>

<table>
<tr><td><code>incr_matrix</code></td>
<td>
<p>Updated matrix listing characteristics of each digitized
increment, shell height values as well as the coordinates of both ends of
the shell increments are added</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Please cite Geoscientific Model Development paper dealing with the
ShellTrace model</p>


<h3>Author(s)</h3>

<p>Niels J. de Winter</p>


<h3>Source</h3>

<p><a href="https://github.com/nielsjdewinter/ShellTrace">GitHub</a> <br />
<a href="https://doi.org/10.5194/gmd-2017-137">Manuscript</a> <br />
<a href="https://doi.org/10.5194/gmd-2017-137-supplement">Supplementary data</a> <br />
<a href="http://nidewint.wixsite.com/nielsdewinter">Author website</a>
</p>


<h3>References</h3>

<p>de Winter, N. J.: ShellTrace v1.0 ? A new approach for modelling
growth and trace element uptake in marine bivalve shells: Model verification
on pacific oyster shells (Crassostrea gigas), Geosci. Model Dev. Discuss.,
https://doi.org/10.5194/gmd-2017-137, in review, 2017.</p>


<h3>Examples</h3>

<pre><code class='language-R'>  incr_matrix3&lt;-Oyster_Shell_height(cross_section, incr_matrix2)
</code></pre>

<hr>
<h2 id='Oyster_Shell_thickness'>Formula that calculates average shell thickness through time</h2><span id='topic+Oyster_Shell_thickness'></span>

<h3>Description</h3>

<p>Formula that calculates average shell thickness at the moment of
deposition of each shell increment from X- and Y-coordinates of the shell
increments and adds the result to the matrix of increment characteristics.
de Winter, N. J. (2017) &lt;doi:10.5194/gmd-2017-137&gt;</p>


<h3>Usage</h3>

<pre><code class='language-R'>Oyster_Shell_thickness(cross_section, incr_matrix)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Oyster_Shell_thickness_+3A_incr_matrix">incr_matrix</code></td>
<td>
<p>Matrix listing characteristics of each digitized
increment</p>
</td></tr>
<tr><td><code id="Oyster_Shell_thickness_+3A_cross_section">cross_section</code></td>
<td>
<p>Digitized cross section of the shell with shell top,
bottom and growth increments relative to a common X-axis</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Shell thickness is calculated as the average difference in Y-values
between the shell increment and the top of the shell (Increment 0)</p>


<h3>Value</h3>

<table>
<tr><td><code>incr_matrix</code></td>
<td>
<p>Updated matrix listing characteristics of each digitized
increment, shell thickness values are added</p>
</td></tr>
</table>
<p>A plot of the change in shell thickness with shell age based on the digitized
growth increments is produced in a new window
</p>


<h3>Note</h3>

<p>Please cite Geoscientific Model Development paper dealing with the
ShellTrace model</p>


<h3>Author(s)</h3>

<p>Niels J. de Winter</p>


<h3>Source</h3>

<p><a href="https://github.com/nielsjdewinter/ShellTrace">GitHub</a> <br />
<a href="https://doi.org/10.5194/gmd-2017-137">Manuscript</a> <br />
<a href="https://doi.org/10.5194/gmd-2017-137-supplement">Supplementary data</a> <br />
<a href="http://nidewint.wixsite.com/nielsdewinter">Author website</a>
</p>


<h3>References</h3>

<p>de Winter, N. J.: ShellTrace v1.0 ? A new approach for modelling
growth and trace element uptake in marine bivalve shells: Model verification
on pacific oyster shells (Crassostrea gigas), Geosci. Model Dev. Discuss.,
https://doi.org/10.5194/gmd-2017-137, in review, 2017.</p>


<h3>Examples</h3>

<pre><code class='language-R'>  incr_matrix2&lt;-Oyster_Shell_thickness(cross_section, incr_matrix1)
</code></pre>

<hr>
<h2 id='Oyster_subincr_area'>Formula that calculates area between sub-increments</h2><span id='topic+Oyster_subincr_area'></span>

<h3>Description</h3>

<p>Formula that calculates cross section area between each sub-increment and
the previous sub-increment.
de Winter, N. J. (2017) &lt;doi:10.5194/gmd-2017-137&gt;</p>


<h3>Usage</h3>

<pre><code class='language-R'>Oyster_subincr_area(IncG, subincr_matrix, Xstep)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Oyster_subincr_area_+3A_incg">IncG</code></td>
<td>
<p>Matrix of X- and Y-coordinates of all interpolated sub-increments</p>
</td></tr>
<tr><td><code id="Oyster_subincr_area_+3A_subincr_matrix">subincr_matrix</code></td>
<td>
<p>Data frame that contains characteristics of every
sub-increment</p>
</td></tr>
<tr><td><code id="Oyster_subincr_area_+3A_xstep">Xstep</code></td>
<td>
<p>Step value in X-direction for the interpolation of sub-increments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Areas between sub-increments are calculated by averaging the difference
in Y-values between sub-increments and multiplying them with the step in X-values
(dx)</p>


<h3>Value</h3>

<table>
<tr><td><code>subincr_matrix</code></td>
<td>
<p>Revised version of the &quot;incr_matrix&quot; data frame that
contains cross section area recalculated for every sub-increment</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Please cite Geoscientific Model Development paper dealing with the ShellTrace
model</p>


<h3>Author(s)</h3>

<p>Niels J. de Winter</p>


<h3>Source</h3>

<p><a href="https://github.com/nielsjdewinter/ShellTrace">GitHub</a> <br />
<a href="https://doi.org/10.5194/gmd-2017-137">Manuscript</a> <br />
<a href="https://doi.org/10.5194/gmd-2017-137-supplement">Supplementary data</a> <br />
<a href="http://nidewint.wixsite.com/nielsdewinter">Author website</a>
</p>


<h3>References</h3>

<p>de Winter, N. J.: ShellTrace v1.0 ? A new approach for modelling growth
and trace element uptake in marine bivalve shells: Model verification on pacific
oyster shells (Crassostrea gigas), Geosci. Model Dev. Discuss.,
https://doi.org/10.5194/gmd-2017-137, in review, 2017.</p>


<h3>See Also</h3>

<p>&quot;Oyster_Shell_length&quot;</p>


<h3>Examples</h3>

<pre><code class='language-R'>  subincr_matrix1&lt;-Oyster_subincr_area(IncG, subincr_matrix0, Xstep=1)
</code></pre>

<hr>
<h2 id='Oyster_subincr_av_thickness'>Formula that calculates average shell thickness through time</h2><span id='topic+Oyster_subincr_av_thickness'></span>

<h3>Description</h3>

<p>Formula that calculates average shell thickness at the moment of
deposition of each shell sub-increment from cross section area and shell
length and adds the result to the matrix of increment characteristics.
de Winter, N. J. (2017) &lt;doi:10.5194/gmd-2017-137&gt;</p>


<h3>Usage</h3>

<pre><code class='language-R'>Oyster_subincr_av_thickness(subincr_matrix)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Oyster_subincr_av_thickness_+3A_subincr_matrix">subincr_matrix</code></td>
<td>
<p>Data frame that contains characteristics of every
sub-increment</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Shell thickness is calculated as the ratio between cross section
area and shell length (Increment 0)</p>


<h3>Value</h3>

<table>
<tr><td><code>subincr_matrix</code></td>
<td>
<p>Revised version of the &quot;incr_matrix&quot; data frame
that contains average shell thickness recalculated for every sub-increment</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Please cite Geoscientific Model Development paper dealing with the
ShellTrace model</p>


<h3>Author(s)</h3>

<p>Niels J. de Winter</p>


<h3>Source</h3>

<p><a href="https://github.com/nielsjdewinter/ShellTrace">GitHub</a> <br />
<a href="https://doi.org/10.5194/gmd-2017-137">Manuscript</a> <br />
<a href="https://doi.org/10.5194/gmd-2017-137-supplement">Supplementary data</a> <br />
<a href="http://nidewint.wixsite.com/nielsdewinter">Author website</a>
</p>


<h3>References</h3>

<p>de Winter, N. J.: ShellTrace v1.0 ? A new approach for modelling
growth and trace element uptake in marine bivalve shells: Model verification
on pacific oyster shells (Crassostrea gigas), Geosci. Model Dev. Discuss.,
https://doi.org/10.5194/gmd-2017-137, in review, 2017.</p>


<h3>See Also</h3>

<p>&quot;Oyster_av_thickness&quot;</p>


<h3>Examples</h3>

<pre><code class='language-R'>  subincr_matrix3&lt;-Oyster_subincr_av_thickness(subincr_matrix2)
</code></pre>

<hr>
<h2 id='Oyster_subincr_av_thickness_X'>Formula that calculates average shell thickness through time</h2><span id='topic+Oyster_subincr_av_thickness_X'></span>

<h3>Description</h3>

<p>Formula that calculates average shell thickness at the moment of
deposition of each shell sub-increment from X- and Y-coordinates of the shell
increments and adds the result to the matrix of increment characteristics.
de Winter, N. J. (2017) &lt;doi:10.5194/gmd-2017-137&gt;</p>


<h3>Usage</h3>

<pre><code class='language-R'>Oyster_subincr_av_thickness_X(IncG, subincr_matrix)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Oyster_subincr_av_thickness_X_+3A_incg">IncG</code></td>
<td>
<p>Matrix of X- and Y-coordinates of all interpolated sub-increments</p>
</td></tr>
<tr><td><code id="Oyster_subincr_av_thickness_X_+3A_subincr_matrix">subincr_matrix</code></td>
<td>
<p>Data frame that contains characteristics of every
sub-increment</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Shell thickness is calculated as the average difference in Y-values
between the shell sub-increment and the top of the shell (Increment 0)</p>


<h3>Value</h3>

<table>
<tr><td><code>subincr_matrix</code></td>
<td>
<p>Revised version of the &quot;incr_matrix&quot; data frame that
contains average shell thickness recalculated for every sub-increment</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Please cite Geoscientific Model Development paper dealing with the
ShellTrace model</p>


<h3>Author(s)</h3>

<p>Niels J. de Winter</p>


<h3>Source</h3>

<p><a href="https://github.com/nielsjdewinter/ShellTrace">GitHub</a> <br />
<a href="https://doi.org/10.5194/gmd-2017-137">Manuscript</a> <br />
<a href="https://doi.org/10.5194/gmd-2017-137-supplement">Supplementary data</a> <br />
<a href="http://nidewint.wixsite.com/nielsdewinter">Author website</a>
</p>


<h3>References</h3>

<p>de Winter, N. J.: ShellTrace v1.0 ? A new approach for modelling
growth and trace element uptake in marine bivalve shells: Model verification
on pacific oyster shells (Crassostrea gigas), Geosci. Model Dev. Discuss.,
https://doi.org/10.5194/gmd-2017-137, in review, 2017.</p>


<h3>See Also</h3>

<p>&quot;Oyster_av_thickness&quot;</p>


<h3>Examples</h3>

<pre><code class='language-R'>  subincr_matrix3&lt;-Oyster_subincr_av_thickness_X(IncG, subincr_matrix2)
</code></pre>

<hr>
<h2 id='Oyster_subincr_phases'>Calculates proportion of phases in each sub-increment</h2><span id='topic+Oyster_subincr_phases'></span>

<h3>Description</h3>

<p>Function that takes the matrix of sub-increment positions and the
matrix of phases and calculates the amount of pixels of each phase that is
contained in each sub-increment based on pixelsize and phase characteristics.
de Winter, N. J. (2017) &lt;doi:10.5194/gmd-2017-137&gt;</p>


<h3>Usage</h3>

<pre><code class='language-R'>Oyster_subincr_phases(IncG, phasemat, pixelsize, phases)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Oyster_subincr_phases_+3A_incg">IncG</code></td>
<td>
<p>Matrix of X- and Y-coordinates of all interpolated sub-increments</p>
</td></tr>
<tr><td><code id="Oyster_subincr_phases_+3A_phasemat">phasemat</code></td>
<td>
<p>matrix of phases of each pixel sorted by X- and Y-coordinate
of the pixel</p>
</td></tr>
<tr><td><code id="Oyster_subincr_phases_+3A_pixelsize">pixelsize</code></td>
<td>
<p>size of pixels in the phase map in millimeter</p>
</td></tr>
<tr><td><code id="Oyster_subincr_phases_+3A_phases">phases</code></td>
<td>
<p>Matrix containing colour and trace element data of the phases
in the XRF phase map</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For every sub-increment, all pixels that cover area in the sub-increment
are identified based on the pixel size of the phase map and the X- and
Y-positions of the sub-increments. The amount of pixels of each phase in the
sub-increment is saved in a new matrix of phases per sub-increment</p>


<h3>Value</h3>

<p>A matrix of the amount of pixels for each phase found in every sub-increment
</p>
<table>
<tr><td><code>phase_mat</code></td>
<td>
<p>Matrix of amounts of pixels of each phase per sub-increment</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Please cite Geoscientific Model Development paper dealing with the
ShellTrace model</p>


<h3>Author(s)</h3>

<p>Niels J. de Winter</p>


<h3>Source</h3>

<p><a href="https://github.com/nielsjdewinter/ShellTrace">GitHub</a> <br />
<a href="https://doi.org/10.5194/gmd-2017-137">Manuscript</a> <br />
<a href="https://doi.org/10.5194/gmd-2017-137-supplement">Supplementary data</a> <br />
<a href="http://nidewint.wixsite.com/nielsdewinter">Author website</a>
</p>


<h3>References</h3>

<p>de Winter, N. J.: ShellTrace v1.0 ? A new approach for modelling
growth and trace element uptake in marine bivalve shells: Model verification
on pacific oyster shells (Crassostrea gigas), Geosci. Model Dev. Discuss.,
https://doi.org/10.5194/gmd-2017-137, in review, 2017.</p>


<h3>See Also</h3>

<p>&quot;Oyster_Suby_av_thickness&quot;</p>


<h3>Examples</h3>

<pre><code class='language-R'>  ## Not run: 
    phase_mat&lt;-Oyster_subincr_phases(IncG, phasemat, pixelsize, O1_phase)
  
## End(Not run)
</code></pre>

<hr>
<h2 id='Oyster_subincr_shell_height'>A fomula to calculate shell height per sub-increment</h2><span id='topic+Oyster_subincr_shell_height'></span>

<h3>Description</h3>

<p>Formula that calculates shell height at the time of deposition
of each sub-increment.
de Winter, N. J. (2017) &lt;doi:10.5194/gmd-2017-137&gt;</p>


<h3>Usage</h3>

<pre><code class='language-R'>Oyster_subincr_shell_height(subincr_matrix, IncG, Xstep)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Oyster_subincr_shell_height_+3A_subincr_matrix">subincr_matrix</code></td>
<td>
<p>Data frame that contains characteristics of every
sub-increment</p>
</td></tr>
<tr><td><code id="Oyster_subincr_shell_height_+3A_incg">IncG</code></td>
<td>
<p>Matrix of X- and Y-coordinates of all interpolated
sub-increments</p>
</td></tr>
<tr><td><code id="Oyster_subincr_shell_height_+3A_xstep">Xstep</code></td>
<td>
<p>Step value in X-direction for the interpolation of
sub-increments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Shell height is calculated via the Pythagorean Theorem using the
X- and Y-coordinates of both ends of the shell sub-increment with extreme
X-values</p>


<h3>Value</h3>

<table>
<tr><td><code>subincr_matrix</code></td>
<td>
<p>Revised version of the &quot;incr_matrix&quot; data frame
that contains shell height recalculated for every sub-increment</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Please cite Geoscientific Model Development paper dealing with the
ShellTrace model</p>


<h3>Author(s)</h3>

<p>Niels J. de Winter</p>


<h3>Source</h3>

<p><a href="https://github.com/nielsjdewinter/ShellTrace">GitHub</a> <br />
<a href="https://doi.org/10.5194/gmd-2017-137">Manuscript</a> <br />
<a href="https://doi.org/10.5194/gmd-2017-137-supplement">Supplementary data</a> <br />
<a href="http://nidewint.wixsite.com/nielsdewinter">Author website</a>
</p>


<h3>References</h3>

<p>de Winter, N. J.: ShellTrace v1.0 ? A new approach for modelling
growth and trace element uptake in marine bivalve shells: Model verification
on pacific oyster shells (Crassostrea gigas), Geosci. Model Dev. Discuss.,
https://doi.org/10.5194/gmd-2017-137, in review, 2017.</p>


<h3>See Also</h3>

<p>&quot;Oyster_Shell_height&quot;</p>


<h3>Examples</h3>

<pre><code class='language-R'>  subincr_matrix2&lt;-Oyster_subincr_shell_height(subincr_matrix1,IncG,Xstep=1)
</code></pre>

<hr>
<h2 id='Oyster_Volumes'>Formula that calculates volume of the shell through time</h2><span id='topic+Oyster_Volumes'></span>

<h3>Description</h3>

<p>Formula that calculates the volume of the bivalve shell during the
time of deposition of each sub-increment.
de Winter, N. J. (2017) &lt;doi:10.5194/gmd-2017-137&gt;</p>


<h3>Usage</h3>

<pre><code class='language-R'>Oyster_Volumes(subincr_matrix, Z_mat, IncG, Xstep = 0.1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Oyster_Volumes_+3A_subincr_matrix">subincr_matrix</code></td>
<td>
<p>Data frame that contains characteristics of every
sub-increment</p>
</td></tr>
<tr><td><code id="Oyster_Volumes_+3A_z_mat">Z_mat</code></td>
<td>
<p>Matrix of Z-values for each X-value and each sub-increment</p>
</td></tr>
<tr><td><code id="Oyster_Volumes_+3A_incg">IncG</code></td>
<td>
<p>Matrix of X- and Y-coordinates of all interpolated sub-increments</p>
</td></tr>
<tr><td><code id="Oyster_Volumes_+3A_xstep">Xstep</code></td>
<td>
<p>Step value in X-direction for the interpolation of sub-increments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Volume is calculated for each sub-increment and each X-value based on
cross sections perpendicular to the XY-plane. Area of the shell in this
cross section is calculated by constructing a circle section through the
intercept with the base ellipse and the top of the shell sub-increment.
See paper de Winter, GMD (in review) for details and illustrations</p>


<h3>Value</h3>

<p>A list of two data frames:
</p>
<table>
<tr><td><code>subincr_matrix</code></td>
<td>
<p>Updated data frame that contains characteristics of every
sub-increment with modelled shell volumes added to the matrix</p>
</td></tr>
<tr><td><code>IncGAnet</code></td>
<td>
<p>Matrix of areas of cross sections in YZ-directions sorted by
X-values and by sub-increment</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Please cite Geoscientific Model Development paper dealing with the
ShellTrace model</p>


<h3>Author(s)</h3>

<p>Niels J. de Winter</p>


<h3>Source</h3>

<p><a href="https://github.com/nielsjdewinter/ShellTrace">GitHub</a> <br />
<a href="https://doi.org/10.5194/gmd-2017-137">Manuscript</a> <br />
<a href="https://doi.org/10.5194/gmd-2017-137-supplement">Supplementary data</a> <br />
<a href="http://nidewint.wixsite.com/nielsdewinter">Author website</a>
</p>


<h3>References</h3>

<p>de Winter, N. J.: ShellTrace v1.0 ? A new approach for modelling
growth and trace element uptake in marine bivalve shells: Model verification
on pacific oyster shells (Crassostrea gigas), Geosci. Model Dev. Discuss.,
https://doi.org/10.5194/gmd-2017-137, in review, 2017.</p>


<h3>See Also</h3>

<p>&quot;Oyster_av_thickness&quot;</p>


<h3>Examples</h3>

<pre><code class='language-R'>  ## Not run: 
    diagL&lt;-Oyster_Volumes(subincr_matrix4, Z_mat, IncG, Xstep = 1)
  
## End(Not run)
</code></pre>

<hr>
<h2 id='Oyster_Z_matrices'>Function that calculates matrices of Z-values for all sub-increments and
all X-values</h2><span id='topic+Oyster_Z_matrices'></span>

<h3>Description</h3>

<p>Function that calculates Z-values that form the edge of the shell
in terms of distance from the X-axis in direction of the width of the shell.
de Winter, N. J. (2017) &lt;doi:10.5194/gmd-2017-137&gt;</p>


<h3>Usage</h3>

<pre><code class='language-R'>Oyster_Z_matrices(IncG, subincr_matrix)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Oyster_Z_matrices_+3A_incg">IncG</code></td>
<td>
<p>Matrix of X- and Y-coordinates of all interpolated sub-increments</p>
</td></tr>
<tr><td><code id="Oyster_Z_matrices_+3A_subincr_matrix">subincr_matrix</code></td>
<td>
<p>Data frame that contains characteristics of every
sub-increment</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Z-values are calculated using the standard formulae of an ellipse, the
parameters calculated in &quot;Oyster_Oval_parameters&quot; and the X-coordinates of
each sub-increment
</p>


<h3>Value</h3>

<table>
<tr><td><code>Z-mat</code></td>
<td>
<p>Matrix of Z-values for each X-value and each sub-increment</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Please cite Geoscientific Model Development paper dealing with the
ShellTrace model</p>


<h3>Author(s)</h3>

<p>Niels J. de Winter</p>


<h3>Source</h3>

<p><a href="https://github.com/nielsjdewinter/ShellTrace">GitHub</a> <br />
<a href="https://doi.org/10.5194/gmd-2017-137">Manuscript</a> <br />
<a href="https://doi.org/10.5194/gmd-2017-137-supplement">Supplementary data</a> <br />
<a href="http://nidewint.wixsite.com/nielsdewinter">Author website</a>
</p>


<h3>References</h3>

<p>de Winter, N. J.: ShellTrace v1.0 ? A new approach for modelling
growth and trace element uptake in marine bivalve shells: Model verification
on pacific oyster shells (Crassostrea gigas), Geosci. Model Dev. Discuss.,
https://doi.org/10.5194/gmd-2017-137, in review, 2017.</p>


<h3>See Also</h3>

<p>&quot;Oyster_av_thickness&quot;</p>


<h3>Examples</h3>

<pre><code class='language-R'>  Z_mat&lt;-Oyster_Z_matrices(IncG, subincr_matrix4)
</code></pre>

<hr>
<h2 id='phase_mat'>Matrix listing the amount of pixels of each phase in every subincrement</h2><span id='topic+phase_mat'></span>

<h3>Description</h3>

<p>A dataset containing the amounts of pixels of each phase in the
phase map of the XRF mapped surface of the Crassostrea gigas #1 oyster
used as an example in de Winter (2017) represented in every subincrement.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(phase_mat)
</code></pre>


<h3>Format</h3>

<p>A data frame with 4 rows and 1291 variables:</p>


<h3>Source</h3>

<p><a href="https://doi.org/10.5194/gmd-2017-137-supplement">https://doi.org/10.5194/gmd-2017-137-supplement</a>
</p>

<hr>
<h2 id='phase_stat'>Statistics of elemental concentrations in XRF map of oyster</h2><span id='topic+phase_stat'></span>

<h3>Description</h3>

<p>A dataset containing trace element concentrations and fractions of a
phase map of the XRF mapped surface of the Crassostrea gigas #1 oyster
used as an example in de Winter (2017)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(phase_stat)
</code></pre>


<h3>Format</h3>

<p>A data frame with 5 rows and 27 variables:
</p>

<dl>
<dt>Names</dt><dd><p>Names of phases</p>
</dd>
<dt>pixels</dt><dd><p>Amount of pixels representing the phase</p>
</dd>
<dt>fraction</dt><dd><p>Fraction of map surface represented by phase</p>
</dd>
<dt>C</dt><dd><p>Concentration of C in phase</p>
</dd>
<dt>O</dt><dd><p>Concentration of O in phase</p>
</dd>
<dt>Na</dt><dd><p>Concentration of Na in phase</p>
</dd>
<dt>Mg</dt><dd><p>Concentration of Mg in phase</p>
</dd>
<dt>Al</dt><dd><p>Concentration of Al in phase</p>
</dd>
<dt>Si</dt><dd><p>Concentration of Si in phase</p>
</dd>
<dt>P</dt><dd><p>Concentration of P in phase</p>
</dd>
<dt>S</dt><dd><p>Concentration of S in phase</p>
</dd>
<dt>Cl</dt><dd><p>Concentration of Cl in phase</p>
</dd>
<dt>K</dt><dd><p>Concentration of K in phase</p>
</dd>
<dt>Ca</dt><dd><p>Concentration of Ca in phase</p>
</dd>
<dt>Ti</dt><dd><p>Concentration of Ti in phase</p>
</dd>
<dt>Cr</dt><dd><p>Concentration of Cr in phase</p>
</dd>
<dt>Mn</dt><dd><p>Concentration of Mn in phase</p>
</dd>
<dt>Fe</dt><dd><p>Concentration of Fe in phase</p>
</dd>
<dt>Ni</dt><dd><p>Concentration of Ni in phase</p>
</dd>
<dt>Cu</dt><dd><p>Concentration of Cu in phase</p>
</dd>
<dt>Zn</dt><dd><p>Concentration of Zn in phase</p>
</dd>
<dt>Br</dt><dd><p>Concentration of Br in phase</p>
</dd>
<dt>Rb</dt><dd><p>Concentration of Rb in phase</p>
</dd>
<dt>Sr</dt><dd><p>Concentration of Sr in phase</p>
</dd>
<dt>Rh</dt><dd><p>Concentration of Rh in phase</p>
</dd>
<dt>Ba</dt><dd><p>Concentration of Ba in phase</p>
</dd>
<dt>Pb</dt><dd><p>Concentration of Pb in phase</p>
</dd>
</dl>


<h3>Source</h3>

<p><a href="https://doi.org/10.5194/gmd-2017-137-supplement">https://doi.org/10.5194/gmd-2017-137-supplement</a>
</p>

<hr>
<h2 id='phasemat'>Matrix of phases names for each pixel in the phase map</h2><span id='topic+phasemat'></span>

<h3>Description</h3>

<p>A dataset containing names of phases for every pixel in the phase map
measured on a cross section through the Crassostrea gigas #1 oyster
used as an example in de Winter (2017)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(phasemat)
</code></pre>


<h3>Format</h3>

<p>A large data frame with 2258 rows and 2383 variables:</p>


<h3>Source</h3>

<p><a href="https://doi.org/10.5194/gmd-2017-137-supplement">https://doi.org/10.5194/gmd-2017-137-supplement</a>
</p>

<hr>
<h2 id='pixelsize'>Size of pixels in phase map in mm</h2><span id='topic+pixelsize'></span>

<h3>Description</h3>

<p>A single value of the amount of mm contained in one pixel
rounded up to the nearest micrometer.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(pixelsize)
</code></pre>


<h3>Format</h3>

<p>A single value:
</p>

<p>Length in mm of one pixel in the digitized shell cross section
rounded up to the nearest micrometer
</p>


<h3>Source</h3>

<p><a href="https://doi.org/10.5194/gmd-2017-137-supplement">https://doi.org/10.5194/gmd-2017-137-supplement</a>
</p>

<hr>
<h2 id='pma'>Function to do an n-point moving average</h2><span id='topic+pma'></span>

<h3>Description</h3>

<p>Performs a moving average smoothing on a data series.
de Winter, N. J. (2017) &lt;doi:10.5194/gmd-2017-137&gt;</p>


<h3>Usage</h3>

<pre><code class='language-R'>pma(x, i, n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pma_+3A_x">x</code></td>
<td>
<p>A numeric data frame containing the data set to be smoothed, X-values should be in the first column</p>
</td></tr>
<tr><td><code id="pma_+3A_i">i</code></td>
<td>
<p>The index of the column that contains the Y-values</p>
</td></tr>
<tr><td><code id="pma_+3A_n">n</code></td>
<td>
<p>Integer N-value determining the window size of the moving average smoothing</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric data frame containing three columns: One with X-values, one with Y-values and one with smoothed Y-values
</p>


<h3>Note</h3>

<p>Please cite Geoscientific Model Development paper dealing with the ShellTrace model</p>


<h3>Author(s)</h3>

<p>Niels J. de Winter</p>


<h3>Source</h3>

<p><a href="https://github.com/nielsjdewinter/ShellTrace">GitHub</a> <br />
<a href="https://doi.org/10.5194/gmd-2017-137">Manuscript</a> <br />
<a href="https://doi.org/10.5194/gmd-2017-137-supplement">Supplementary data</a> <br />
<a href="http://nidewint.wixsite.com/nielsdewinter">Author website</a>
</p>


<h3>References</h3>

<p>de Winter, N. J.: ShellTrace v1.0 ? A new approach for modelling growth and trace element uptake in marine bivalve shells: Model verification on pacific oyster shells (Crassostrea gigas), Geosci. Model Dev. Discuss., https://doi.org/10.5194/gmd-2017-137, in review, 2017.</p>


<h3>Examples</h3>

<pre><code class='language-R'>Nile&lt;-as.data.frame(Nile)
Nile&lt;-cbind(rownames(Nile),Nile)
Nile_5pma&lt;-pma(Nile,2,5)
</code></pre>

<hr>
<h2 id='ShellTrace'>ShellTrace: Growth and trace element uptake modelling in bivalve shells</h2><span id='topic+ShellTrace'></span><span id='topic+ShellTrace'></span>

<h3>Description</h3>

<p>This package contains formulae used to model the growth and
development of bivalve shells based on digitized coordinated of shell
increments in a longitudinal cross section thorugh the shell. The
growth model is combined with XRF mapping results of the same
cross section and a seasonal growth rate model to model
trace element concentrations and uptake rates into the
bivalve shell.
de Winter, N. J. (2017) &lt;doi:10.5194/gmd-2017-137&gt;</p>


<h3>Details</h3>

<p>Formulae in this package form the several steps of the model, and
are not meant to be used individually. The order and application of
these functions is outlined in the publication in Geoscientific
Model Development that bears the name of the model (de Winter,
in review)</p>


<h3>Author(s)</h3>

<p>Niels J. de Winter
</p>
<p>Maintainer: Niels J. de Winter
</p>


<h3>References</h3>

<p>de Winter, N. J.: ShellTrace v1.0 - A new approach for modelling
growth and trace element uptake in marine bivalve shells: Model
verification on pacific oyster shells (Crassostrea gigas), Geosci.
Model Dev. Discuss., https://doi.org/10.5194/gmd-2017-137, in review,
2017.</p>


<h3>See Also</h3>

<p><a href="https://github.com/nielsjdewinter/ShellTrace">GitHub</a> <br />
<a href="https://doi.org/10.5194/gmd-2017-137">Manuscript</a> <br />
<a href="https://doi.org/10.5194/gmd-2017-137-supplement">Supplementary data</a> <br />
<a href="http://nidewint.wixsite.com/nielsdewinter">Author website</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>print("de Winter, N. J.: ShellTrace v1.0 - A new approach for
     modelling growth and trace element uptake in marine bivalve shells:
     Model verification on pacific oyster shells (Crassostrea gigas),
     Geosci. Model Dev. Discuss., in review, 2017.")
</code></pre>

<hr>
<h2 id='subincr_matrix0'>Matrix containing data calculated for each growth band.</h2><span id='topic+subincr_matrix0'></span>

<h3>Description</h3>

<p>A dataset containing specific parameters calculated for all interpolated
subincrements from the Crassostrea gigas #1 oyster used as an example in de Winter
(2017) sorted per increment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(subincr_matrix0)
</code></pre>


<h3>Format</h3>

<p>A data frame with 1291 rows and 3 variables:
</p>

<dl>
<dt>Age</dt><dd><p>age (in days) of the subincrement</p>
</dd>
<dt>p1xs</dt><dd><p>X-value of the first (leftmost) point in the subincrement</p>
</dd>
<dt>p2xs</dt><dd><p>X-value of the last (rightmost) point in the subincrement</p>
</dd>
</dl>


<h3>Source</h3>

<p><a href="https://doi.org/10.5194/gmd-2017-137-supplement">https://doi.org/10.5194/gmd-2017-137-supplement</a>
</p>

<hr>
<h2 id='subincr_matrix1'>Matrix containing data calculated for each growth band.</h2><span id='topic+subincr_matrix1'></span>

<h3>Description</h3>

<p>A dataset containing specific parameters calculated for all interpolated
subincrements from the Crassostrea gigas #1 oyster used as an example in de Winter
(2017) sorted per increment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(subincr_matrix1)
</code></pre>


<h3>Format</h3>

<p>A data frame with 1291 rows and 5 variables:
</p>

<dl>
<dt>Age</dt><dd><p>age (in days) of the subincrement</p>
</dd>
<dt>p1xs</dt><dd><p>X-value of the first (leftmost) point in the subincrement</p>
</dd>
<dt>p2xs</dt><dd><p>X-value of the last (rightmost) point in the subincrement</p>
</dd>
<dt>areaY</dt><dd><p>Area between subsequent subincrements</p>
</dd>
<dt>areaC</dt><dd><p>Area between subincrement and top of shell</p>
</dd>
</dl>


<h3>Source</h3>

<p><a href="https://doi.org/10.5194/gmd-2017-137-supplement">https://doi.org/10.5194/gmd-2017-137-supplement</a>
</p>

<hr>
<h2 id='subincr_matrix2'>Matrix containing data calculated for each growth band.</h2><span id='topic+subincr_matrix2'></span>

<h3>Description</h3>

<p>A dataset containing specific parameters calculated for all interpolated
subincrements from the Crassostrea gigas #1 oyster used as an example in de Winter
(2017) sorted per increment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(subincr_matrix2)
</code></pre>


<h3>Format</h3>

<p>A data frame with 1291 rows and 10 variables:
</p>

<dl>
<dt>Age</dt><dd><p>age (in days) of the subincrement</p>
</dd>
<dt>p1xs</dt><dd><p>X-value of the first (leftmost) point in the subincrement</p>
</dd>
<dt>p2xs</dt><dd><p>X-value of the last (rightmost) point in the subincrement</p>
</dd>
<dt>areaY</dt><dd><p>Area between subsequent subincrements</p>
</dd>
<dt>areaC</dt><dd><p>Area between subincrement and top of shell</p>
</dd>
<dt>p1y</dt><dd><p>Y-value of the first (leftmost) point in the subincrement</p>
</dd>
<dt>p2y</dt><dd><p>Y-value of the last (rightmost) point in the subincrement</p>
</dd>
<dt>shell_height</dt><dd><p>Height of shell during deposition of the subincrement</p>
</dd>
<dt>firstl</dt><dd><p>Row number in IncG of first (leftmost) data point belonging to the subincrement</p>
</dd>
<dt>lastl</dt><dd><p>Row number in IncG of last (rightmost) data point belonging to the subincrement</p>
</dd>
</dl>


<h3>Source</h3>

<p><a href="https://doi.org/10.5194/gmd-2017-137-supplement">https://doi.org/10.5194/gmd-2017-137-supplement</a>
</p>

<hr>
<h2 id='subincr_matrix3'>Matrix containing data calculated for each growth band.</h2><span id='topic+subincr_matrix3'></span>

<h3>Description</h3>

<p>A dataset containing specific parameters calculated for all interpolated
subincrements from the Crassostrea gigas #1 oyster used as an example in de Winter
(2017) sorted per increment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(subincr_matrix3)
</code></pre>


<h3>Format</h3>

<p>A data frame with 1291 rows and 11 variables:
</p>

<dl>
<dt>Age</dt><dd><p>age (in days) of the subincrement</p>
</dd>
<dt>p1xs</dt><dd><p>X-value of the first (leftmost) point in the subincrement</p>
</dd>
<dt>p2xs</dt><dd><p>X-value of the last (rightmost) point in the subincrement</p>
</dd>
<dt>areaY</dt><dd><p>Area between subsequent subincrements</p>
</dd>
<dt>areaC</dt><dd><p>Area between subincrement and top of shell</p>
</dd>
<dt>p1y</dt><dd><p>Y-value of the first (leftmost) point in the subincrement</p>
</dd>
<dt>p2y</dt><dd><p>Y-value of the last (rightmost) point in the subincrement</p>
</dd>
<dt>shell_height</dt><dd><p>Height of shell during deposition of the subincrement</p>
</dd>
<dt>firstl</dt><dd><p>Row number in IncG of first (leftmost) data point belonging to the subincrement</p>
</dd>
<dt>lastl</dt><dd><p>Row number in IncG of last (rightmost) data point belonging to the subincrement</p>
</dd>
<dt>av_thickness</dt><dd><p>Average thickness during deposition of the subincrement</p>
</dd>
</dl>


<h3>Source</h3>

<p><a href="https://doi.org/10.5194/gmd-2017-137-supplement">https://doi.org/10.5194/gmd-2017-137-supplement</a>
</p>

<hr>
<h2 id='subincr_matrix4'>Matrix containing data calculated for each growth band.</h2><span id='topic+subincr_matrix4'></span>

<h3>Description</h3>

<p>A dataset containing specific parameters calculated for all interpolated
subincrements from the Crassostrea gigas #1 oyster used as an example in de Winter
(2017) sorted per increment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(subincr_matrix4)
</code></pre>


<h3>Format</h3>

<p>A data frame with 1291 rows and 15 variables:
</p>

<dl>
<dt>Age</dt><dd><p>age (in days) of the subincrement</p>
</dd>
<dt>p1xs</dt><dd><p>X-value of the first (leftmost) point in the subincrement</p>
</dd>
<dt>p2xs</dt><dd><p>X-value of the last (rightmost) point in the subincrement</p>
</dd>
<dt>areaY</dt><dd><p>Area between subsequent subincrements</p>
</dd>
<dt>areaC</dt><dd><p>Area between subincrement and top of shell</p>
</dd>
<dt>p1y</dt><dd><p>Y-value of the first (leftmost) point in the subincrement</p>
</dd>
<dt>p2y</dt><dd><p>Y-value of the last (rightmost) point in the subincrement</p>
</dd>
<dt>shell_height</dt><dd><p>Height of shell during deposition of the subincrement</p>
</dd>
<dt>firstl</dt><dd><p>Row number in IncG of first (leftmost) data point belonging to the subincrement</p>
</dd>
<dt>lastl</dt><dd><p>Row number in IncG of last (rightmost) data point belonging to the subincrement</p>
</dd>
<dt>av_thickness</dt><dd><p>Average thickness during deposition of the subincrement</p>
</dd>
<dt>W_ellipse</dt><dd><p>Length of the short axis of the base ellipse of the oyster during deposition of the subincrement</p>
</dd>
<dt>L_ellipse_acc</dt><dd><p>Length of the long axis of the base ellipse of the oyster during deposition of the subincrement projected on the X-axis</p>
</dd>
<dt>a_ellipse</dt><dd><p>Half the length of the long axis of the base ellipse of the oyster during deposition of the subincrement</p>
</dd>
<dt>b_ellipse</dt><dd><p>Half the length of the short axis of the base ellipse of the oyster during deposition of the subincrement</p>
</dd>
</dl>


<h3>Source</h3>

<p><a href="https://doi.org/10.5194/gmd-2017-137-supplement">https://doi.org/10.5194/gmd-2017-137-supplement</a>
</p>

<hr>
<h2 id='subincr_matrix5'>Matrix containing data calculated for each growth band.</h2><span id='topic+subincr_matrix5'></span>

<h3>Description</h3>

<p>A dataset containing specific parameters calculated for all interpolated
subincrements from the Crassostrea gigas #1 oyster used as an example in de Winter
(2017) sorted per increment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(subincr_matrix5)
</code></pre>


<h3>Format</h3>

<p>A data frame with 1291 rows and 17 variables:
</p>

<dl>
<dt>Age</dt><dd><p>age (in days) of the subincrement</p>
</dd>
<dt>p1xs</dt><dd><p>X-value of the first (leftmost) point in the subincrement</p>
</dd>
<dt>p2xs</dt><dd><p>X-value of the last (rightmost) point in the subincrement</p>
</dd>
<dt>areaY</dt><dd><p>Area between subsequent subincrements</p>
</dd>
<dt>areaC</dt><dd><p>Area between subincrement and top of shell</p>
</dd>
<dt>p1y</dt><dd><p>Y-value of the first (leftmost) point in the subincrement</p>
</dd>
<dt>p2y</dt><dd><p>Y-value of the last (rightmost) point in the subincrement</p>
</dd>
<dt>shell_height</dt><dd><p>Height of shell during deposition of the subincrement</p>
</dd>
<dt>firstl</dt><dd><p>Row number in IncG of first (leftmost) data point belonging to the subincrement</p>
</dd>
<dt>lastl</dt><dd><p>Row number in IncG of last (rightmost) data point belonging to the subincrement</p>
</dd>
<dt>av_thickness</dt><dd><p>Average thickness during deposition of the subincrement</p>
</dd>
<dt>W_ellipse</dt><dd><p>Length of the short axis of the base ellipse of the oyster during deposition of the subincrement</p>
</dd>
<dt>L_ellipse_acc</dt><dd><p>Length of the long axis of the base ellipse of the oyster during deposition of the subincrement projected on the X-axis</p>
</dd>
<dt>a_ellipse</dt><dd><p>Half the length of the long axis of the base ellipse of the oyster during deposition of the subincrement</p>
</dd>
<dt>b_ellipse</dt><dd><p>Half the length of the short axis of the base ellipse of the oyster during deposition of the subincrement</p>
</dd>
<dt>VolI</dt><dd><p>Volume between subsequent subincrements</p>
</dd>
<dt>VolC</dt><dd><p>Volume between subincrement and top of shell</p>
</dd>
</dl>


<h3>Source</h3>

<p><a href="https://doi.org/10.5194/gmd-2017-137-supplement">https://doi.org/10.5194/gmd-2017-137-supplement</a>
</p>

<hr>
<h2 id='subincr_matrix6'>Matrix containing data calculated for each growth band.</h2><span id='topic+subincr_matrix6'></span>

<h3>Description</h3>

<p>A dataset containing specific parameters calculated for all interpolated
subincrements from the Crassostrea gigas #1 oyster used as an example in de Winter
(2017) sorted per increment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(subincr_matrix6)
</code></pre>


<h3>Format</h3>

<p>A data frame with 1291 rows and 20 variables:
</p>

<dl>
<dt>Age</dt><dd><p>age (in days) of the subincrement</p>
</dd>
<dt>p1xs</dt><dd><p>X-value of the first (leftmost) point in the subincrement</p>
</dd>
<dt>p2xs</dt><dd><p>X-value of the last (rightmost) point in the subincrement</p>
</dd>
<dt>areaY</dt><dd><p>Area between subsequent subincrements</p>
</dd>
<dt>areaC</dt><dd><p>Area between subincrement and top of shell</p>
</dd>
<dt>p1y</dt><dd><p>Y-value of the first (leftmost) point in the subincrement</p>
</dd>
<dt>p2y</dt><dd><p>Y-value of the last (rightmost) point in the subincrement</p>
</dd>
<dt>shell_height</dt><dd><p>Height of shell during deposition of the subincrement</p>
</dd>
<dt>firstl</dt><dd><p>Row number in IncG of first (leftmost) data point belonging to the subincrement</p>
</dd>
<dt>lastl</dt><dd><p>Row number in IncG of last (rightmost) data point belonging to the subincrement</p>
</dd>
<dt>av_thickness</dt><dd><p>Average thickness during deposition of the subincrement</p>
</dd>
<dt>W_ellipse</dt><dd><p>Length of the short axis of the base ellipse of the oyster during deposition of the subincrement</p>
</dd>
<dt>L_ellipse_acc</dt><dd><p>Length of the long axis of the base ellipse of the oyster during deposition of the subincrement projected on the X-axis</p>
</dd>
<dt>a_ellipse</dt><dd><p>Half the length of the long axis of the base ellipse of the oyster during deposition of the subincrement</p>
</dd>
<dt>b_ellipse</dt><dd><p>Half the length of the short axis of the base ellipse of the oyster during deposition of the subincrement</p>
</dd>
<dt>VolI</dt><dd><p>Volume between subsequent subincrements</p>
</dd>
<dt>VolC</dt><dd><p>Volume between subincrement and top of shell</p>
</dd>
<dt>WeightI</dt><dd><p>Mass of shell material between subsequent subincrements</p>
</dd>
<dt>Growth_rate</dt><dd><p>Mass of shell material accumulated per day</p>
</dd>
<dt>WeightC</dt><dd><p>Mass of shell material between subincrement and top of shell</p>
</dd>
</dl>


<h3>Source</h3>

<p><a href="https://doi.org/10.5194/gmd-2017-137-supplement">https://doi.org/10.5194/gmd-2017-137-supplement</a>
</p>

<hr>
<h2 id='TIF'>TIF image of phase map of cross section of modern oyster.</h2><span id='topic+TIF'></span>

<h3>Description</h3>

<p>An image of the microXRF phase map of the cross section used for this model
from the Crassostre gigas #1 oyster used as an example in de Winter (2017)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(TIF)
</code></pre>


<h3>Format</h3>

<p>A TIF image imported into R as a large data array</p>


<h3>Source</h3>

<p><a href="https://doi.org/10.5194/gmd-2017-137-supplement">https://doi.org/10.5194/gmd-2017-137-supplement</a>
</p>

<hr>
<h2 id='Z_mat'>Z-values describing the base ellipse of the oyster</h2><span id='topic+Z_mat'></span>

<h3>Description</h3>

<p>A dataset containing Z-coordinates of the base ellipse calculated
for all subincrements in the Crassostrea gigas #1 oyster used as
an example in de Winter (2017).
A Xstep of 0.1, a Tstep of 1 and a growth season of 250 days are used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Z_mat)
</code></pre>


<h3>Format</h3>

<p>A large data frame with 101 rows and 1291 variables:</p>


<h3>Source</h3>

<p><a href="https://doi.org/10.5194/gmd-2017-137-supplement">https://doi.org/10.5194/gmd-2017-137-supplement</a>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
