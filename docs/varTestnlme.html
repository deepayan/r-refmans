<!DOCTYPE html><html><head><title>Help for package varTestnlme</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {varTestnlme}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#alt.desc'><p>alt.desc</p></a></li>
<li><a href='#approxWeights'><p>Monte Carlo approximation of chi-bar-square weights</p></a></li>
<li><a href='#bootinvFIM'><p>Approximation of the inverse of the Fisher Information Matrix via parametric bootstrap</p></a></li>
<li><a href='#bootinvFIM.lme'><p>Compute the inverse of the Fisher Information Matrix using parametric bootstrap</p></a></li>
<li><a href='#bootinvFIM.merMod'><p>Compute the inverse of the Fisher Information Matrix using parametric bootstrap</p></a></li>
<li><a href='#bootinvFIM.SaemixObject'><p>Compute the inverse of the Fisher Information Matrix using parametric bootstrap</p></a></li>
<li><a href='#dfChiBarSquare'><p>Chi-bar-square degrees of freedom computation</p></a></li>
<li><a href='#extractFIM.lme'><p>Extract FIM</p></a></li>
<li><a href='#extractStruct'><p>Extracting models' structures</p></a></li>
<li><a href='#extractStruct.lme'><p>Extract model structure</p></a></li>
<li><a href='#extractStruct.merMod'><p>Extract model structure</p></a></li>
<li><a href='#extractStruct.SaemixObject'><p>Extract model structure</p></a></li>
<li><a href='#extractVarCov'><p>Extract covariance matrix</p></a></li>
<li><a href='#extractVarCov.lme'><p>Extract covariance matrix</p></a></li>
<li><a href='#extractVarCov.merMod'><p>Extract covariance matrix</p></a></li>
<li><a href='#fim.vctest'><p>Extract the Fisher Information Matrix</p></a></li>
<li><a href='#null.desc'><p>null.desc</p></a></li>
<li><a href='#objFunction'><p>Internal functions for constrained minimization</p></a></li>
<li><a href='#pckName'><p>Extract package name from a fitted mixed-effects model</p></a></li>
<li><a href='#print.desc.message'><p>print.desc.message</p></a></li>
<li><a href='#print.res.message'><p>print.res.message</p></a></li>
<li><a href='#print.vctest'><p>Print</p></a></li>
<li><a href='#summary.vctest'><p>Summary</p></a></li>
<li><a href='#varCompTest'><p>Variance component testing</p></a></li>
<li><a href='#weightsChiBarSquare'><p>Monte Carlo approximation of chi-bar-square weights</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Variance Components Testing for Linear and Nonlinear Mixed
Effects Models</td>
</tr>
<tr>
<td>Version:</td>
<td>1.3.5</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/baeyc/varTestnlme/">https://github.com/baeyc/varTestnlme/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/baeyc/varTestnlme/issues">https://github.com/baeyc/varTestnlme/issues</a></td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Charlotte Baey &lt;charlotte.baey@univ-lille.fr&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>An implementation of the Likelihood ratio Test (LRT) for testing that,
    in a (non)linear mixed effects model, the variances of a subset of the random
    effects are equal to zero. There is no restriction on the subset of variances
    that can be tested: for example, it is possible to test that all the variances
    are equal to zero. Note that the implemented test is asymptotic.
    This package should be used on model fits from packages 'nlme', 'lmer', and 'saemix'.
    Charlotte Baey and Estelle Kuhn (2019) &lt;<a href="https://doi.org/10.18637%2Fjss.v107.i06">doi:10.18637/jss.v107.i06</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Imports:</td>
<td>mvtnorm, lmeresampler, alabama, Matrix, merDeriv, anocva,
corpcor, quadprog, lme4, nlme, saemix, msm, foreach, methods,
doParallel, parallel</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, EnvStats</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-09-22 12:07:26 UTC; charlotte</td>
</tr>
<tr>
<td>Author:</td>
<td>Charlotte Baey <a href="https://orcid.org/0000-0002-1413-1058"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Estelle Kuhn [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-09-22 15:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='alt.desc'>alt.desc</h2><span id='topic+alt.desc'></span>

<h3>Description</h3>

<p>create alternative description
</p>


<h3>Usage</h3>

<pre><code class='language-R'>alt.desc(msdata)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="alt.desc_+3A_msdata">msdata</code></td>
<td>
<p>a list containing the structure of the model and data, as an output from 
<code>extractStruct.&lt;package_name&gt;</code> functions</p>
</td></tr>
</table>

<hr>
<h2 id='approxWeights'>Monte Carlo approximation of chi-bar-square weights</h2><span id='topic+approxWeights'></span>

<h3>Description</h3>

<p>The chi-bar-square distribution <code class="reqn">\bar{\chi}^2(I,C)</code> is a mixture of chi-square distributions. The function provides
a method to approximate the weights of the mixture components, when the number of components is known as well as the
degrees of freedom of each chi-square distribution in the mixture, and given a vector of simulated values from the target
<code class="reqn">\bar{\chi}^2(I,C)</code> distribution. Note that the estimation is based on (pseudo)-random Monte Carlo samples. For reproducible
results, one should fix the seed of the (pseudo)-random number generator.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>approxWeights(x, df, q)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="approxWeights_+3A_x">x</code></td>
<td>
<p>a vector of i.i.d. random realizations of the target chi-bar-square distribution</p>
</td></tr>
<tr><td><code id="approxWeights_+3A_df">df</code></td>
<td>
<p>a vector containing the degrees of freedom of the chi-squared components</p>
</td></tr>
<tr><td><code id="approxWeights_+3A_q">q</code></td>
<td>
<p>the empirical quantile of <code>x</code> used to choose the <code class="reqn">p-2</code> values <code class="reqn">c_1, \dots, c_{p-2}</code> (see Details)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let us assume that there are <code class="reqn">p</code> components in the mixture, with degrees of
freedom between <code class="reqn">n_1</code> and <code class="reqn">n_p</code>. By definition of a mixture distribution, we have :
</p>
<p style="text-align: center;"><code class="reqn"> P(\bar{\chi}^2(I,C) \leq c) = \sum_{i=n_1}^{n_p} w_i P(\chi^2_{i} \leq c)</code>
</p>

<p>Choosing <code class="reqn">p-2</code> values <code class="reqn">c_1, \dots, c_{p-2}</code>, the function will generate a system of <code class="reqn">p-2</code> equations
according to the above relationship, and add two additional relationships stating that the sum of all the weights is
equal to 1, and that the sum of odd weights and of even weights is equal to 1/2, so that we end up with a system a <code class="reqn">p</code>
equations with <code class="reqn">p</code> variables.
</p>


<h3>Value</h3>

<p>A vector containing the estimated weights, as well as their covariance matrix.
</p>


<h3>Author(s)</h3>

<p>Charlotte Baey &lt;<a href="mailto:charlotte.baey@univ-lille.fr">charlotte.baey@univ-lille.fr</a>&gt;
</p>

<hr>
<h2 id='bootinvFIM'>Approximation of the inverse of the Fisher Information Matrix via parametric bootstrap</h2><span id='topic+bootinvFIM'></span><span id='topic+invFIM'></span><span id='topic+bootstrap'></span>

<h3>Description</h3>

<p>When the FIM is not available, this function provides an approximation of the FIM based on an estimate
of the covariance matrix of the model's parameters obtained via parametric bootstrap.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bootinvFIM(m, B = 1000, seed = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bootinvFIM_+3A_m">m</code></td>
<td>
<p>a fitted model that will be used as the basis of the parametric bootstrap (providing the initial maximum
likelihood estimate of the parameters and the modelling framework)</p>
</td></tr>
<tr><td><code id="bootinvFIM_+3A_b">B</code></td>
<td>
<p>the size of the bootstrap sample</p>
</td></tr>
<tr><td><code id="bootinvFIM_+3A_seed">seed</code></td>
<td>
<p>a seed for the random generator</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the empirical covariance matrix of the parameter estimates obtained on the bootstrap sample
</p>


<h3>Author(s)</h3>

<p>Charlotte Baey &lt;<a href="mailto:charlotte.baey@univ-lille.fr">charlotte.baey@univ-lille.fr</a>&gt;
</p>

<hr>
<h2 id='bootinvFIM.lme'>Compute the inverse of the Fisher Information Matrix using parametric bootstrap</h2><span id='topic+bootinvFIM.lme'></span>

<h3>Description</h3>

<p>Compute the inverse of the Fisher Information Matrix using parametric bootstrap
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lme'
bootinvFIM(m, B = 1000, seed = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bootinvFIM.lme_+3A_m">m</code></td>
<td>
<p>the model under H1</p>
</td></tr>
<tr><td><code id="bootinvFIM.lme_+3A_b">B</code></td>
<td>
<p>the bootstrap sample size</p>
</td></tr>
<tr><td><code id="bootinvFIM.lme_+3A_seed">seed</code></td>
<td>
<p>a seed for the random generator</p>
</td></tr>
</table>

<hr>
<h2 id='bootinvFIM.merMod'>Compute the inverse of the Fisher Information Matrix using parametric bootstrap</h2><span id='topic+bootinvFIM.merMod'></span>

<h3>Description</h3>

<p>Compute the inverse of the Fisher Information Matrix using parametric bootstrap
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'merMod'
bootinvFIM(m, B = 1000, seed = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bootinvFIM.merMod_+3A_m">m</code></td>
<td>
<p>the model under H1</p>
</td></tr>
<tr><td><code id="bootinvFIM.merMod_+3A_b">B</code></td>
<td>
<p>the bootstrap sample size</p>
</td></tr>
<tr><td><code id="bootinvFIM.merMod_+3A_seed">seed</code></td>
<td>
<p>a seed for the random generator</p>
</td></tr>
</table>

<hr>
<h2 id='bootinvFIM.SaemixObject'>Compute the inverse of the Fisher Information Matrix using parametric bootstrap</h2><span id='topic+bootinvFIM.SaemixObject'></span>

<h3>Description</h3>

<p>Compute the inverse of the Fisher Information Matrix using parametric bootstrap
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'SaemixObject'
bootinvFIM(m, B = 1000, seed = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bootinvFIM.SaemixObject_+3A_m">m</code></td>
<td>
<p>the model under H1</p>
</td></tr>
<tr><td><code id="bootinvFIM.SaemixObject_+3A_b">B</code></td>
<td>
<p>the bootstrap sample size</p>
</td></tr>
<tr><td><code id="bootinvFIM.SaemixObject_+3A_seed">seed</code></td>
<td>
<p>a seed for the random generator</p>
</td></tr>
</table>

<hr>
<h2 id='dfChiBarSquare'>Chi-bar-square degrees of freedom computation</h2><span id='topic+dfChiBarSquare'></span>

<h3>Description</h3>

<p>Computation of the degrees of freedom of the chi-bar-square
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dfChiBarSquare(msdata)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dfChiBarSquare_+3A_msdata">msdata</code></td>
<td>
<p>a list containing the structure of the model and data, as an output from 
<code>extractStruct.&lt;package_name&gt;</code> functions</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list containing the vector of the degrees of freedom of the chi-bar-square and the dimensions
of the cone of the chi-bar-square distribution
</p>

<hr>
<h2 id='extractFIM.lme'>Extract FIM</h2><span id='topic+extractFIM.lme'></span>

<h3>Description</h3>

<p>Extract FIM
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extractFIM.lme(m, struct)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extractFIM.lme_+3A_m">m</code></td>
<td>
<p>the model to extract the FIM from</p>
</td></tr>
<tr><td><code id="extractFIM.lme_+3A_struct">struct</code></td>
<td>
<p>the structure of the covariance matrix (either 'full', 'diag', or 'blockdiag)</p>
</td></tr>
</table>

<hr>
<h2 id='extractStruct'>Extracting models' structures</h2><span id='topic+extractStruct'></span>

<h3>Description</h3>

<p>Functions extracting the structure of the models under both hypothesis: the number of fixed and random effects, 
the number of tested fixed and random effects, and the residual dimension, as well as the random effects covariance structure
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extractStruct(m1, m0, randm0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extractStruct_+3A_m1">m1</code></td>
<td>
<p>the model under H1</p>
</td></tr>
<tr><td><code id="extractStruct_+3A_m0">m0</code></td>
<td>
<p>the model under H0</p>
</td></tr>
<tr><td><code id="extractStruct_+3A_randm0">randm0</code></td>
<td>
<p>a boolean stating whether the model under H0 contains any random effect</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following components:
</p>
<table>
<tr><td><code>detailStruct</code></td>
<td>
<p>a data frame containing the list of the parameters and whether they are tested or not</p>
</td></tr>
<tr><td><code>nameVarTested</code></td>
<td>
<p>the name of the variance components being tested</p>
</td></tr>
<tr><td><code>nameFixedTested</code></td>
<td>
<p>the name of the fixed effects being tested</p>
</td></tr>
<tr><td><code>dims</code></td>
<td>
<p>a list with the dimensions of fixed and random effects, tested or not tested</p>
</td></tr>
<tr><td><code>structGamma</code></td>
<td>
<p>the structure of the covariance matrix of the random effects <code>diag</code>, <code>full</code> or 
<code>blockDiag</code></p>
</td></tr>
</table>

<hr>
<h2 id='extractStruct.lme'>Extract model structure</h2><span id='topic+extractStruct.lme'></span>

<h3>Description</h3>

<p>Extract model structure
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lme'
extractStruct(m1, m0, randm0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extractStruct.lme_+3A_m1">m1</code></td>
<td>
<p>the fit under H1</p>
</td></tr>
<tr><td><code id="extractStruct.lme_+3A_m0">m0</code></td>
<td>
<p>the fit under H0</p>
</td></tr>
<tr><td><code id="extractStruct.lme_+3A_randm0">randm0</code></td>
<td>
<p>a boolean indicating whether random effects are present in m0</p>
</td></tr>
</table>

<hr>
<h2 id='extractStruct.merMod'>Extract model structure</h2><span id='topic+extractStruct.merMod'></span>

<h3>Description</h3>

<p>Extract model structure
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'merMod'
extractStruct(m1, m0, randm0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extractStruct.merMod_+3A_m1">m1</code></td>
<td>
<p>the fit under H1</p>
</td></tr>
<tr><td><code id="extractStruct.merMod_+3A_m0">m0</code></td>
<td>
<p>the fit under H0</p>
</td></tr>
<tr><td><code id="extractStruct.merMod_+3A_randm0">randm0</code></td>
<td>
<p>a boolean indicating whether random effects are present in m0</p>
</td></tr>
</table>

<hr>
<h2 id='extractStruct.SaemixObject'>Extract model structure</h2><span id='topic+extractStruct.SaemixObject'></span>

<h3>Description</h3>

<p>Extract model structure
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'SaemixObject'
extractStruct(m1, m0, randm0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extractStruct.SaemixObject_+3A_m1">m1</code></td>
<td>
<p>the fit under H1</p>
</td></tr>
<tr><td><code id="extractStruct.SaemixObject_+3A_m0">m0</code></td>
<td>
<p>the fit under H0</p>
</td></tr>
<tr><td><code id="extractStruct.SaemixObject_+3A_randm0">randm0</code></td>
<td>
<p>a boolean indicating whether random effects are present in m0</p>
</td></tr>
</table>

<hr>
<h2 id='extractVarCov'>Extract covariance matrix</h2><span id='topic+extractVarCov'></span>

<h3>Description</h3>

<p>Extract covariance matrix of the random effects for a model fitted with lme4.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extractVarCov(m)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extractVarCov_+3A_m">m</code></td>
<td>
<p>a fit from lme4 package (either linear or nonlinear)</p>
</td></tr>
</table>

<hr>
<h2 id='extractVarCov.lme'>Extract covariance matrix</h2><span id='topic+extractVarCov.lme'></span>

<h3>Description</h3>

<p>Extract covariance matrix of the random effects for a model fitted with nlme.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lme'
extractVarCov(m)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extractVarCov.lme_+3A_m">m</code></td>
<td>
<p>a fit from nlme package (either linear or nonlinear)</p>
</td></tr>
</table>

<hr>
<h2 id='extractVarCov.merMod'>Extract covariance matrix</h2><span id='topic+extractVarCov.merMod'></span>

<h3>Description</h3>

<p>Extract covariance matrix of the random effects for a model fitted with lme4.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'merMod'
extractVarCov(m)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extractVarCov.merMod_+3A_m">m</code></td>
<td>
<p>a fit from lme4 package (either linear or nonlinear)</p>
</td></tr>
</table>

<hr>
<h2 id='fim.vctest'>Extract the Fisher Information Matrix</h2><span id='topic+fim.vctest'></span>

<h3>Description</h3>

<p>Extract the Fisher Information Matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fim.vctest(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fim.vctest_+3A_object">object</code></td>
<td>
<p>an object of class vctest</p>
</td></tr>
</table>

<hr>
<h2 id='null.desc'>null.desc</h2><span id='topic+null.desc'></span>

<h3>Description</h3>

<p>create null.value description
</p>


<h3>Usage</h3>

<pre><code class='language-R'>null.desc(msdata)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="null.desc_+3A_msdata">msdata</code></td>
<td>
<p>a list containing the structure of the model and data, as an output from 
<code>extractStruct.&lt;package_name&gt;</code> functions</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Useful intern functions
</p>

<hr>
<h2 id='objFunction'>Internal functions for constrained minimization</h2><span id='topic+objFunction'></span><span id='topic+gradObjFunction'></span><span id='topic+symMatrixFromVect'></span><span id='topic+ineqCstr'></span><span id='topic+jacobianIneqCstr'></span><span id='topic+eqCstr'></span><span id='topic+jacobianEqCstr'></span>

<h3>Description</h3>

<p>Groups of functions used for the constrained minimization problem arising in the computation of the
likelihood ratio test statistics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>objFunction(x, cst)

gradObjFunction(x, cst)

symMatrixFromVect(x)

ineqCstr(x, cst)

jacobianIneqCstr(x, cst)

eqCstr(x, cst)

jacobianEqCstr(x, cst)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="objFunction_+3A_x">x</code></td>
<td>
<p>A vector</p>
</td></tr>
<tr><td><code id="objFunction_+3A_cst">cst</code></td>
<td>
<p>A list of constants to be passed to the optimisation function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>value of the objective function, its gradient, and the set of inequality and equality constraints
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>objFunction()</code>: objective function to be optimized
</p>
</li>
<li> <p><code>gradObjFunction()</code>: gradient of the objective function
</p>
</li>
<li> <p><code>symMatrixFromVect()</code>: function creating a symmetric matrix from its unique elements stored in a vector
</p>
</li>
<li> <p><code>ineqCstr()</code>: set of inequality constraints
</p>
</li>
<li> <p><code>jacobianIneqCstr()</code>: jacobian of the inequality constraints
</p>
</li>
<li> <p><code>eqCstr()</code>: set of equality constraints
</p>
</li>
<li> <p><code>jacobianEqCstr()</code>: jacobian of the inequality constraints
</p>
</li></ul>

<hr>
<h2 id='pckName'>Extract package name from a fitted mixed-effects model</h2><span id='topic+pckName'></span>

<h3>Description</h3>

<p>Extract package name from a fitted mixed-effects model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pckName(m)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pckName_+3A_m">m</code></td>
<td>
<p>a model with random effects fitted with <code>nlme</code>, <code>lme4</code> or <code>saemix</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a string giving the name of the package
</p>

<hr>
<h2 id='print.desc.message'>print.desc.message</h2><span id='topic+print.desc.message'></span>

<h3>Description</h3>

<p>print a message to indicate the null and alternative hypotheses
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'desc.message'
print(msdata)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.desc.message_+3A_msdata">msdata</code></td>
<td>
<p>a list containing the structure of the model and data, as an output from 
<code>extractStruct.&lt;package_name&gt;</code> functions</p>
</td></tr>
</table>

<hr>
<h2 id='print.res.message'>print.res.message</h2><span id='topic+print.res.message'></span>

<h3>Description</h3>

<p>print a message with the results
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'res.message'
print(results)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.res.message_+3A_results">results</code></td>
<td>
<p>an object of class vctest</p>
</td></tr>
</table>

<hr>
<h2 id='print.vctest'>Print</h2><span id='topic+print.vctest'></span>

<h3>Description</h3>

<p>Print
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'vctest'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.vctest_+3A_x">x</code></td>
<td>
<p>an object of class vctest</p>
</td></tr>
<tr><td><code id="print.vctest_+3A_...">...</code></td>
<td>
<p>additional arguments</p>
</td></tr>
</table>

<hr>
<h2 id='summary.vctest'>Summary</h2><span id='topic+summary.vctest'></span>

<h3>Description</h3>

<p>Summary
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'vctest'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.vctest_+3A_object">object</code></td>
<td>
<p>an object of class vctest</p>
</td></tr>
<tr><td><code id="summary.vctest_+3A_...">...</code></td>
<td>
<p>additional arguments</p>
</td></tr>
</table>

<hr>
<h2 id='varCompTest'>Variance component testing</h2><span id='topic+varCompTest'></span><span id='topic+varCompTest.lme'></span><span id='topic+varCompTest.lme4'></span><span id='topic+varCompTest.saemix'></span><span id='topic+varCompTest.merMod'></span><span id='topic+varCompTest.SaemixObject'></span>

<h3>Description</h3>

<p>Perform a likelihood ratio test to test whether a subset of the variances of the random effects
are equal to zero. The test is defined by two hypotheses, H0 and H1, and the model under H0 is
assumed to be nested within the model under H1. These functions can be used on objects of class
<code>lme</code>-, <code>nlme</code>-, <code>mer</code>-, <code>lmerMod</code>, <code>glmerMod</code>, <code>nlmerMord</code> or <code>SaemixObject</code>.
</p>
<p>It is possible to tests if any subset of the variances are equal to zero. However, the function does not
currently support nested random effects, and assumes that the random effects are Gaussian.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>varCompTest(
  m1,
  m0,
  control = list(M = 5000, parallel = T, nb_cores = 1, B = 1000),
  pval.comp = "bounds",
  fim = "extract",
  output = TRUE
)

## S3 method for class 'lme'
varCompTest(
  m1,
  m0,
  control = list(M = 5000, parallel = FALSE, nb_cores = 1, B = 1000),
  pval.comp = "bounds",
  fim = "extract",
  output = TRUE
)

## S3 method for class 'merMod'
varCompTest(
  m1,
  m0,
  control = list(M = 5000, parallel = FALSE, nb_cores = 1, B = 1000),
  pval.comp = "bounds",
  fim = "extract",
  output = TRUE
)

## S3 method for class 'SaemixObject'
varCompTest(
  m1,
  m0,
  control = list(M = 5000, parallel = FALSE, nb_cores = 1, B = 1000),
  pval.comp = "bounds",
  fim = "extract",
  output = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="varCompTest_+3A_m1">m1</code></td>
<td>
<p>a fit of the model under H1, obtained from <code>nlme</code>, <code>lme4</code>
or <code>saemix</code></p>
</td></tr>
<tr><td><code id="varCompTest_+3A_m0">m0</code></td>
<td>
<p>a fit of the model under H0, obtained from the same package as <code>m0</code></p>
</td></tr>
<tr><td><code id="varCompTest_+3A_control">control</code></td>
<td>
<p>(optional) a list of control options for the computation of the chi-bar-weights (see Details section)</p>
</td></tr>
<tr><td><code id="varCompTest_+3A_pval.comp">pval.comp</code></td>
<td>
<p>(optional) the method to be used to compute the p-value, one of: <code>"bounds"</code> (the default),
<code>"approx"</code> or <code>"both"</code> (see Details section)</p>
</td></tr>
<tr><td><code id="varCompTest_+3A_fim">fim</code></td>
<td>
<p>(optional) the method to compute the Fisher Information Matrix. Options are: <code>fim="extract"</code> to extract the
FIM computed by the package which was used to fit the models, <code>fim="compute"</code> to evaluate the FIM using parametric
bootstrap, and <code>fim=I</code> with <code>I</code> a positive semidefinite matrix, for a FIM provided by the user.</p>
</td></tr>
<tr><td><code id="varCompTest_+3A_output">output</code></td>
<td>
<p>a boolean specifying if any output should be printed in the console (default to TRUE)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The asymptotic distribution of the likelihood ratio test is a chi-bar-square, with weights that need to be
approximated by Monte Carlo methods, apart from some specific cases where they are available explicitly. 
Therefore, the p-value of the test is not exact but approximated. This computation can be time-consuming, so
the default behaviour of the function is to provide bounds on the exact p-value, which can be enough in practice
to decide whether to reject or not the null hypothesis. This is triggered by the option <code>pval.comp="bounds"</code>.
To compute an approximation of the exact p-value, one should use the option <code>pval.comp="approx"</code> or <code>pval.comp="both"</code>.
</p>
<p>When <code>pval.comp="approx"</code> or <code>pval.comp="both"</code>, the weights of the chi-bar-square distribution are computed using Monte Carlo,
which might involve a larger computing time.
</p>
<p>The <code>control</code> argument controls the options for chi-bar-square weights computation. It is a list with the
following elements: <code>M</code> the size of the Monte Carlo simulation, i.e. the number of samples generated, <code>parallel</code> a
boolean to specify if parallel computing should be used, and <code>nbcores</code> the number of cores to be used in case of 
parallel computing. Default is <code>M=5000</code>, <code>parallel=FALSE</code> and <code>nb_cores=1</code>.
If <code>parallel=TRUE</code> but the value of <code>nb_cores</code> is not given, then it is set to the number of detected
cores minus 1
</p>


<h3>Value</h3>

<p>An object of class <code>htest</code> with the following components:
</p>

<ul>
<li> <p><code>statistic</code> the likelihood ratio test statistics
</p>
</li>
<li> <p><code>null.value</code> 
</p>
</li>
<li> <p><code>alternative</code> 
</p>
</li>
<li> <p><code>parameters</code> the parameters of the limiting chi-bar-square distribution: the degrees of freedom and
the weights of the chi-bar-square components and the Fisher Information Matrix
</p>
</li>
<li> <p><code>method</code> a character string indicating the name of the test
</p>
</li>
<li> <p><code>pvalue</code> a named vector containing the different p-values computed by the function: using the 
(estimated) weights, using the random sample from the chi-bar-square distribution, and the two bounds on
the p-value.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Charlotte Baey &lt;<a href="mailto:charlotte.baey@univ-lille.fr">charlotte.baey@univ-lille.fr</a>&gt;
</p>


<h3>References</h3>

<p>Baey C, Cournède P-H, Kuhn E, 2019. Asymptotic distribution of likelihood ratio test
statistics for variance components in nonlinear mixed effects models. <em>Computational
Statistics and Data Analysis</em> 135:107-122.
</p>
<p>Silvapulle  MJ, Sen PK, 2011. Constrained statistical inference: order, inequality and shape constraints.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load lme4 package and example dataset
library(lme4)
data(Orthodont, package = "nlme")

# fit the two models under H1 and H0
m1 &lt;- lmer(distance ~ 1 + Sex + age + age*Sex + 
(0 + age | Subject), data = Orthodont, REML = FALSE)
m0 &lt;- lm(distance ~ 1 + Sex + age + age*Sex, data = Orthodont)

# compare them (order is important: m1 comes first)
varCompTest(m1,m0,pval.comp="bounds")

# using nlme
library(nlme)
m1 &lt;- lme(distance ~ 1 + Sex + age + age*Sex, 
random = pdSymm(Subject ~ 1 + age), data = Orthodont, method = "ML")
m0 &lt;- lme(distance ~ 1 + Sex, random = ~ 1 | Subject, data = Orthodont, method = "ML")

varCompTest(m1,m0)

</code></pre>

<hr>
<h2 id='weightsChiBarSquare'>Monte Carlo approximation of chi-bar-square weights</h2><span id='topic+weightsChiBarSquare'></span>

<h3>Description</h3>

<p>The function provides a method to approximate the weights of the mixture components, 
when the number of components is known as well as the degrees of freedom of each chi-square distribution 
in the mixture, and given a vector of simulated values from the target <code class="reqn">\bar{\chi}^2(V,C)</code> 
distribution. Note that the estimation is based on (pseudo)-random Monte Carlo samples. For reproducible
results, one should fix the seed of the (pseudo)-random number generator.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>weightsChiBarSquare(df, V, dimsCone, orthan, control)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="weightsChiBarSquare_+3A_df">df</code></td>
<td>
<p>a vector with the degrees of freedom of the chi-square components of the chi-bar-square distribution</p>
</td></tr>
<tr><td><code id="weightsChiBarSquare_+3A_v">V</code></td>
<td>
<p>a positive semi-definite matrix</p>
</td></tr>
<tr><td><code id="weightsChiBarSquare_+3A_dimscone">dimsCone</code></td>
<td>
<p>a list with the dimensions of the cone C, expressed on the parameter space scale</p>
</td></tr>
<tr><td><code id="weightsChiBarSquare_+3A_orthan">orthan</code></td>
<td>
<p>a boolean specifying whether the cone is an orthan</p>
</td></tr>
<tr><td><code id="weightsChiBarSquare_+3A_control">control</code></td>
<td>
<p>(optional) a list of control options for the computation of the chi-bar-weights, containing 
two elements: <code>parallel</code> a boolean indicating whether computation should be done in parallel (FALSE 
by default), <code>nb_cores</code> the number of cores for parallel computing (if <code>parallel=TRUE</code> but no value is given
for <code>nb_cores</code>, it is set to number of detected cores minus 1), and <code>M</code> the Monte Carlo sample
size for the computation of the weights.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the estimated weights, the standard deviations of the estimated weights and the
random sample of <code>M</code> realizations from the chi-bar-square distribution
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
