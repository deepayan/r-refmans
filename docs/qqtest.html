<!DOCTYPE html><html><head><title>Help for package qqtest</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {qqtest}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bacteria'><p>Bacteria from Delaware River water entering the Torresdale Filter</p>
of the Philadelphia water supply 1913.</a></li>
<li><a href='#dkay'><p><code>dkay</code> The density function of the K distribution</p></a></li>
<li><a href='#hideLocation'><p><code>hideLocation</code> Obfuscating the true location of the real data.</p></a></li>
<li><a href='#penicillin'><p>31 contrast sums from a 32 run 2^(5-0) factorial experiment on penicillin production.</p></a></li>
<li><a href='#pkay'><p><code>pkay</code> The cumulative distribution function K distribution</p></a></li>
<li><a href='#primer'><p>Automobile primer paint thickness quality control measurements.</p></a></li>
<li><a href='#pullstrength'><p>Strength of pull for 519 males aged 23-26.</p></a></li>
<li><a href='#qkay'><p><code>qkay</code> The K distribution quantile function</p></a></li>
<li><a href='#qqtest'><p><code>qqtest</code> A self-calibrated quantile-quantile plot for assessing distributional shape.</p></a></li>
<li><a href='#revealLocation'><p><code>revealLocation</code> Revealing locations encoded as a string calculation.</p></a></li>
<li><a href='#rkay'><p><code>rkay</code> The K distribution - generating pseudo-random values</p></a></li>
<li><a href='#sittingHeights'><p>Sitting height in inches of female adults (aged 23-50).</p></a></li>
<li><a href='#stacklossDistances'><p>Mahalanobis squared distances of Brownlee's stack loss plant operation data based only on the explanatory variates (air flow, water temperature, and acid concentration).</p></a></li>
<li><a href='#WachusettReservoir'><p>Storage, in millions of gallons daily per square mile of net land area, at the Wachusett Reservoir in Massacusetts - storage computed for each of several rates of draft (draft being a determined maintainable flow in 1,000s of gallons per square mile daily).</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Self Calibrating Quantile-Quantile Plots for Visual Testing</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-03-14</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Wayne Oldford &lt;rwoldford@uwaterloo.ca&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides the function qqtest which incorporates uncertainty in its
    qqplot display(s) so that the user might have a better sense of the
    evidence against the specified distributional hypothesis.  qqtest draws a
    quantile quantile plot for visually assessing whether the data come from a
    test distribution that has been defined in one of many ways.  The vertical
    axis plots the data quantiles, the horizontal those of a test distribution.
    The default behaviour generates 1000 samples from the test distribution and
    overlays the plot with shaded pointwise interval estimates for the ordered
    quantiles from the test distribution.  A small number of independently
    generated exemplar quantile plots can also be overlaid.  Both the interval
    estimates and the exemplars provide different comparative information to
    assess the evidence provided by the qqplot for or against the hypothesis
    that the data come from the test distribution (default is normal or
    gaussian).  Finally, a visual test of significance (a lineup plot) can also
    be displayed to test the null hypothesis that the data come from the test
    distribution.</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>grDevices, stats</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-03-16 15:50:02 UTC; rwoldford</td>
</tr>
<tr>
<td>Author:</td>
<td>Wayne Oldford [aut, cre]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.0.2</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/rwoldford/qqtest">https://github.com/rwoldford/qqtest</a>,
<a href="https://rwoldford.github.io/qqtest/">https://rwoldford.github.io/qqtest/</a></td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-03-16 16:40:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='bacteria'>Bacteria from Delaware River water entering the Torresdale Filter 
of the Philadelphia water supply 1913.</h2><span id='topic+bacteria'></span>

<h3>Description</h3>

<p>The number of bacteria per cubic centimetre was measured daily 
for river water entering the Torresdale filter of the Philadelphia
water supply through the whole of 1913.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bacteria
</code></pre>


<h3>Format</h3>

<p>A data frame with 22 rows and 2 variates:
</p>

<dl>
<dt>count</dt><dd><p>Number of bacteria per cc.</p>
</dd>
<dt>percentTime</dt><dd><p>Percent of days (out of 365) having bacteria count 
less than or equal to the measured count.</p>
</dd>
</dl>


<h3>Details</h3>

<p>Rather than the individual daily results, recorded here are 22 values 
together with the percentage of days whose value was less than or equal
to the recorded value.
These quantiles are therefore based on 365 daily measurements.
</p>
<p>Values were taken from a logarithmic-normal probability plot dated 
January 21, 1915 as it appeared in Figure 22 of George C. Whipple's 
1916 (Part 2) paper on the &ldquo;Element of Chance in Sanitation&rdquo;.
This paper introduces logarithimic-normal probability paper (or a log-normal qqplot).
</p>
<p><code>with(bacteria, plot(qnorm(percentTime/100), log(count,10), type="o"))</code> 
reproduces Whipple's 1915 plot.
</p>
<p><code>with(bacteria, qqtest(data=count, p=percentTime/100, np=365, dist="log-normal", type="o"))</code>
will effect a qqtest plot for this data.  More detail can be had from:
<code>with(bacteria, qqtest(data=log(count, 10), p=percentTime/100, np=365, dist="normal", type="o"))</code>
</p>


<h3>Source</h3>

<p>&quot;The Element of Chance in Sanitation&quot;, 
George C. Whipple, Journal of the Franklin Institue, Volume 182,
July and August (1916), pp. 37-59 and 205-227.
Data taken directly from Figure 22, page 209.
</p>

<hr>
<h2 id='dkay'><code>dkay</code> The density function of the K distribution</h2><span id='topic+dkay'></span>

<h3>Description</h3>

<p>The K density function on <code>df</code> degrees of freedom and non-centrality parameter <code>ncp</code>.
</p>
<p>A K distribution is the square root of a chi-square divided by its degrees of freedom.  That is, if x is chi-squared on m degrees of freedom, then y = sqrt(x/m) is K on m degrees of freedom.
Under standard normal theory, K is the distribution of the pivotal quantity  s/sigma where s is the sample standard deviation and sigma is the standard deviation parameter of the normal density.  K is the natural distribution for tests and confidence intervals about sigma.
K densities are more nearly symmetric than are chi-squared and concentrate near 1.  As the degrees of freedom increase, they become more symmetric, more concentrated, and more nearly normally distributed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dkay(x, df, ncp = 0, log.p = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dkay_+3A_x">x</code></td>
<td>
<p>A vector of values at which to calculate the density.</p>
</td></tr>
<tr><td><code id="dkay_+3A_df">df</code></td>
<td>
<p>Degrees of freedom (non-negative, but can be non-integer).</p>
</td></tr>
<tr><td><code id="dkay_+3A_ncp">ncp</code></td>
<td>
<p>Non-centrality parameter (non-negative).</p>
</td></tr>
<tr><td><code id="dkay_+3A_log.p">log.p</code></td>
<td>
<p>logical; if <code>TRUE</code>, probabilities are given as log(p).</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>dkay</code> gives the density evaluated at the values of <code>x</code>.
</p>
<p>Invalid arguments will result in return value NaN, with a warning.
</p>
<p>The length of the result is the maximum of the lengths of the numerical arguments for the other functions.
</p>
<p>The numerical arguments are recycled to the length of the result. Only the first elements of the logical arguments are used.
</p>


<h3>Note</h3>

<p>All calls depend on analogous calls to chi-squared functions.  See <code>dchisq</code> for details on non-centrality parameter calculations.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
dkay(1, 20)
#
# See also the vignette on the "K-distribution"
#
</code></pre>

<hr>
<h2 id='hideLocation'><code>hideLocation</code> Obfuscating the true location of the real data.</h2><span id='topic+hideLocation'></span>

<h3>Description</h3>

<p>Hides the true location of the data as a non-obvious calculation string.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hideLocation(trueLoc, nSubjects)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hideLocation_+3A_trueloc">trueLoc</code></td>
<td>
<p>A vector of one or more numbers in the set 1, 2, ..., nSubjects whose locations are to be hidden.</p>
</td></tr>
<tr><td><code id="hideLocation_+3A_nsubjects">nSubjects</code></td>
<td>
<p>An integer larger than 1 used to define the set 1, 2, ..., nSubjects.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a character vector, each element being a string
containing an obscure calculation which, if parsed and evaluated, would return
the value of the corresponding number in <code>trueLoc</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+revealLocation">revealLocation</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>trueLoc &lt;- hideLocation(3,100)
trueLoc
revealLocation(trueLoc)

n &lt;- 200
trueLoc &lt;- sample(1:n, 3)
trueLoc
ans &lt;- hideLocation(trueLoc , n)
ans
revealLocation(ans)

</code></pre>

<hr>
<h2 id='penicillin'>31 contrast sums from a 32 run 2^(5-0) factorial experiment on penicillin production.</h2><span id='topic+penicillin'></span>

<h3>Description</h3>

<p>Values are arranged in decreasing order of absolute magnitude.
Name of the contrast effect is given as the row name of each value.
Daniel(1959) uses the data to illustrate the use of half-normal plots.
In his words: &quot;We need, of course, some rule of inference that will help us to 
be objective in judging whether or not the largest effects are real.&quot;
</p>


<h3>Usage</h3>

<pre><code class='language-R'>penicillin
</code></pre>


<h3>Format</h3>

<p>A data frame with 31 rows and 1 variate:
</p>

<dl>
<dt>value</dt><dd><p>value of contrast for that row</p>
</dd>
</dl>


<h3>Details</h3>

<p><code>qqtest(penicillin[1],dist="half-normal")</code> will effect Daniel's plot.
</p>


<h3>Source</h3>

<p>&quot;Use of Half-Normal Plots in Interpreting Factorial Two-Level Experiments&quot;, 
Cuthbert Daniel, Technometrics, Vol. 1, No. 4 (Nov., 1959), pp. 311-341.  
Daniel cites: Davies, O. L., Editor: Design and Analysis of Industrial Experiments, 
Second Edition, Oliver and Boyd, London, and Hafner, New York, 1956 
as the original.
</p>

<hr>
<h2 id='pkay'><code>pkay</code> The cumulative distribution function K distribution</h2><span id='topic+pkay'></span>

<h3>Description</h3>

<p>The cumulative distribution function for the K distribution on <code>df</code> degrees of freedom having non-centrality parameter <code>ncp</code>.
</p>
<p>A K distribution is the square root of a chi-square divided by its degrees of freedom.  That is, if x is chi-squared on m degrees of freedom, then y = sqrt(x/m) is K on m degrees of freedom.
Under standard normal theory, K is the distribution of the pivotal quantity  s/sigma where s is the sample standard deviation and sigma is the standard deviation parameter of the normal density.  K is the natural distribution for tests and confidence intervals about sigma.
K densities are more nearly symmetric than are chi-squared and concentrate near 1.  As the degrees of freedom increase, they become more symmetric, more concentrated, and more nearly normally distributed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pkay(q, df, ncp = 0, upper.tail = FALSE, log.p = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pkay_+3A_q">q</code></td>
<td>
<p>A vector of quantiles at which to calculate the cumulative distribution.</p>
</td></tr>
<tr><td><code id="pkay_+3A_df">df</code></td>
<td>
<p>Degrees of freedom (non-negative, but can be non-integer).</p>
</td></tr>
<tr><td><code id="pkay_+3A_ncp">ncp</code></td>
<td>
<p>Non-centrality parameter (non-negative).</p>
</td></tr>
<tr><td><code id="pkay_+3A_upper.tail">upper.tail</code></td>
<td>
<p>logical; if <code>TRUE</code>,  instead of returning F(q)  (the default), the upper tail probabilities 1-F(q) = Pr(Q&gt;q) are returned.</p>
</td></tr>
<tr><td><code id="pkay_+3A_log.p">log.p</code></td>
<td>
<p>logical; if <code>TRUE</code>, probabilities are given as log(p).</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>pkay</code> returns the value of the K cumulative distribution function, F(q), evaluated at <code>q</code> for the given <code>df</code> and <code>ncp</code>.  If <code>upper.trail = TRUE</code> then the upper tail probabilities 1-F(q) = Pr(Q&gt;q) are returned instead of F(q).
</p>
<p>Invalid arguments will result in return value NaN, with a warning.
</p>
<p>The length of the result is the maximum of the lengths of the numerical arguments.
</p>
<p>The numerical arguments are recycled to the length of the result. Only the first elements of the logical arguments are used.
</p>


<h3>Note</h3>

<p>All calls depend on analogous calls to chi-squared functions.  See <code>pchisq</code> for details on non-centrality parameter calculations.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
pkay(1, 20)
q &lt;- seq(0.01, 1.8, 0.01)
#
# Plot the cdf for K(5)
u &lt;- pkay(q,5)
plot(q, u, type="l",
     xlab="q", ylab="cumulative probability",
     xlim=range(q), ylim=c(0,1),
     main="K cdf")
#
# Add some other K cdfs
lines(q, pkay(q,10), lty=2)
lines(q, pkay(q,20), lty=3)
lines(q, pkay(q,30), lty=4)
legend("topleft",
       legend=c("df = 5", "df = 10", "df = 20", "df = 30"),
       lty=c(1,2,3,4),
       title="degrees of freedom",
       cex=0.75, bty="n")

#
# See the vignette for more on the "K-distribution"
#
</code></pre>

<hr>
<h2 id='primer'>Automobile primer paint thickness quality control measurements.</h2><span id='topic+primer'></span>

<h3>Description</h3>

<p>Contains process control measurements of thickness of primer applied to
automotive body parts in an auto factory.
Twice daily, a set of 10 consecutive parts were selected and the thickness in mils (thousandths of an inch)
were measured.  For each set of 10 parts, the average (xbar) and the sample standard deviation (s) were also
calculated and recorded.  These summaries would be plotted in xbar or s control charts with suitably determined upper and
lower control limits.
Alternatively, for checking outliers a qqplot (via qqtest) could be used for either xbar or s.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>primer
</code></pre>


<h3>Format</h3>

<p>A data frame with 20 rows and 14 variates:
</p>

<dl>
<dt>day</dt><dd><p>Day on which the parts were taken and measured.</p>
</dd>
<dt>batch</dt><dd><p>Either the first or second set of 10 consecutive parts taken.</p>
</dd>
<dt>sel1</dt><dd><p>Thickness of primer in mils on the first part sampled in the specified batch of that day.</p>
</dd>
<dt>sel2</dt><dd><p>Thickness of primer in mils on the second part sampled in the specified batch of that day.</p>
</dd>
<dt>sel3</dt><dd><p>Thickness of primer in mils on the third part sampled in the specified batch of that day.</p>
</dd>
<dt>sel4</dt><dd><p>Thickness of primer in mils on the fourth part sampled in the specified batch of that day.</p>
</dd>
<dt>sel5</dt><dd><p>Thickness of primer in mils on the fifth part sampled in the specified batch of that day.</p>
</dd>
<dt>sel6</dt><dd><p>Thickness of primer in mils on the sixth part sampled in the specified batch of that day.</p>
</dd>
<dt>sel7</dt><dd><p>Thickness of primer in mils on the seventh part sampled in the specified batch of that day.</p>
</dd>
<dt>sel8</dt><dd><p>Thickness of primer in mils on the eighth part sampled in the specified batch of that day.</p>
</dd>
<dt>sel9</dt><dd><p>Thickness of primer in mils on the ninth part sampled in the specified batch of that day.</p>
</dd>
<dt>sel10</dt><dd><p>Thickness of primer in mils on the tenth part sampled in the specified batch of that day.</p>
</dd>
<dt>xbar</dt><dd><p>Arithmetic average of the measurements of primer thickness of the 10 parts selected in the specified batch of that day.</p>
</dd>
<dt>s</dt><dd><p>Sample standard deviation of the measurements of primer thickness of the 10 parts selected in the specified batch of that day.</p>
</dd>
</dl>


<h3>Details</h3>

<p><code>with(primer,qqtest(xbar, main="Averages"))</code> will effect this plot for xbar.
<code>with(primer,qqtest(s,dist="kay", df=9, main ="Standard deviations"))</code> will effect this plot for s.
</p>


<h3>Source</h3>

<p>&quot;Statistical Process Control - SPC&quot;, 
Automotive Industry Action Group(AIAG), Southfield MI,  (1995), page 64.
</p>

<hr>
<h2 id='pullstrength'>Strength of pull for 519 males aged 23-26.</h2><span id='topic+pullstrength'></span>

<h3>Description</h3>

<p>From measurements made by Francis Galton at the International Health Exhibition in 1884.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pullstrength
</code></pre>


<h3>Format</h3>

<p>A data frame with 7 rows and 4 variates:
</p>

<dl>
<dt>strength</dt><dd><p>Pull strength lower bound in pounds.</p>
</dd>
<dt>nCases</dt><dd><p>Number of cases observed with pull strength between this bound and the next.</p>
</dd>
<dt>percentCases</dt><dd><p>Percent of cases observed with pull strength between this bound and the next.</p>
</dd>
<dt>percentCumulative</dt><dd><p>Cumulative percent of cases observed with pull strength up to this bound.</p>
</dd>
<dt>percentAdjustedCumulative</dt><dd><p>Adjust Galton's cumulative percent to include only half  the cases between this bound and the next.</p>
</dd>
</dl>


<h3>Details</h3>

<p><code>qqtest(pullstrength$strength, p=pullstrength$percentCumulative/100, np=519, dist="uniform", main="Galton's ogive of pull strength for 519 males aged 23-26", xlab="Cumulative Proportions (Adjusted)",yAxisAsProbs=FALSE, ylab="Strength in lbs.", type="o")</code> will effect Galton's Ogive.
</p>
<p><code>qqtest(pullstrength$strength, p=pullstrength$percentAdjustedCumulative/100, np=519, dist="normal", main="Gaussian qqplot of pull strength for 519 males aged 23-26", xlab="Cumulative Proportions (Adjusted)",yAxisAsProbs=FALSE, ylab="Strength in lbs.", type="o")</code> will effect a normal qqplot for this data.
</p>


<h3>Source</h3>

<p>&quot;Natural Inheritance&quot;, 
Francis Galton, (1889), Table 1, page 199.
</p>

<hr>
<h2 id='qkay'><code>qkay</code> The K distribution quantile function</h2><span id='topic+qkay'></span>

<h3>Description</h3>

<p>Quantile function for the K distribution on <code>df</code> degrees of freedom having non-centrality parameter <code>ncp</code>.
</p>
<p>A K distribution is the square root of a chi-square divided by its degrees of freedom.  That is, if x is chi-squared on m degrees of freedom, then y = sqrt(x/m) is K on m degrees of freedom.
Under standard normal theory, K is the distribution of the pivotal quantity  s/sigma where s is the sample standard deviation and sigma is the standard deviation parameter of the normal density.  K is the natural distribution for tests and confidence intervals about sigma.
K densities are more nearly symmetric than are chi-squared and concentrate near 1.  As the degrees of freedom increase, they become more symmetric, more concentrated, and more nearly normally distributed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qkay(p, df, ncp = 0, upper.tail = FALSE, log.p = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="qkay_+3A_p">p</code></td>
<td>
<p>A vector of probabilities at which to calculate the quantiles.</p>
</td></tr>
<tr><td><code id="qkay_+3A_df">df</code></td>
<td>
<p>Degrees of freedom (non-negative, but can be non-integer).</p>
</td></tr>
<tr><td><code id="qkay_+3A_ncp">ncp</code></td>
<td>
<p>Non-centrality parameter (non-negative).</p>
</td></tr>
<tr><td><code id="qkay_+3A_upper.tail">upper.tail</code></td>
<td>
<p>logical; if <code>TRUE</code>,  instead of returning F(x)  (the default), the upper tail probabilities 1-F(x) = Pr(X&gt;x) are returned.</p>
</td></tr>
<tr><td><code id="qkay_+3A_log.p">log.p</code></td>
<td>
<p>logical; if <code>TRUE</code>, probabilities are given as log(p).</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>qkay</code> returns the quantiles at probabilities <code>p</code> for a K on <code>df</code> degrees of freedom and non-centrality parameter <code>ncp</code>.
</p>
<p>Invalid arguments will result in return value NaN, with a warning.
</p>
<p>The length of the result is the maximum of the lengths of the numerical arguments.
</p>
<p>The numerical arguments are recycled to the length of the result. Only the first elements of the logical arguments are used.
</p>


<h3>Note</h3>

<p>All calls depend on analogous calls to chi-squared functions.  See <code>qchisq</code> for details on non-centrality parameter calculations.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
p &lt;- ppoints(30)
# Get the quantiles for these points
q5 &lt;- qkay(p, 5)
plot(p, q5, main="Quantile plot of K(20)", ylim=c(0,max(q5)))
# Add quantiles from another K
points(p, qkay(p, 20), pch=19)

#
# Do these EXACT quantiles from a K(5) look like they might
# have been generated from K(20)?
qqtest(q5, dist="kay",df=20)

# How about compared to normal?
qqnorm(q5)
qqtest(q5)
# for this many degrees of freedom it looks a lot like
# a gaussian (normal) distribution

# And should look really good compared to the true distribution
qqtest(q5, dist="kay", df=5)
#
#
# But not so much like it came from a K on 1 degree of freedom
qqtest(q5, dist="kay",df=1)

#
# See the vignette for more on the "K-distribution"
#
</code></pre>

<hr>
<h2 id='qqtest'><code>qqtest</code> A self-calibrated quantile-quantile plot for assessing distributional shape.</h2><span id='topic+qqtest'></span>

<h3>Description</h3>

<p>Draws a quantile-quantile plot for visually assessing whether the data come
from a test distribution that has been defined in one of many ways.
</p>
<p>The vertical axis plots the data quantiles, the horizontal those of a test distribution.
</p>
<p>Interval estimates and exemplars provide different comparative information to assess the
evidence provided by the qqplot against the hypothesis that the data come from the test distribution
(default is normal or gaussian).
Interval estimates provide test information related to individual quantiles,
exemplars provide test information related to the shape of the quantile quantile curve.
</p>
<p>Optionally, a visual test of significance (a lineup plot) can be displayed to provide a
coarse level of significance for testing the null hypothesis that the data come from the
test distribution.
</p>
<p>The default behaviour generates 1000 samples from the test distribution and overlays the
plot with pointwise interval estimates for the ordered quantiles from the test distribution.
</p>
<p>Various option choices are available to effect different visualizations of the
uncertainty surrounding the quantile quantile plot.
These include overlaying independently generated exemplar test distribution sample
quantile traces so as to assess the joint (as opposed to pointwise) distribution of quantiles.
</p>
<p>See argument descriptions and examples for more details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qqtest(
  data,
  dist = c("gaussian", "normal", "log-normal", "half-normal", "uniform", "exponential",
    "chi-squared", "kay", "student", "t"),
  df = 1,
  qfunction = NULL,
  rfunction = NULL,
  dataTest = NULL,
  p = NULL,
  a = NULL,
  np = NULL,
  matchMethod = c("hinges", "quartiles", "middlehalf", "bottomhalf", "tophalf"),
  xAxisAsProbs = FALSE,
  yAxisAsProbs = FALSE,
  xAxisProbs = c(0.05, 0.25, 0.5, 0.75, 0.95),
  yAxisProbs = c(0.05, 0.25, 0.5, 0.75, 0.95),
  nreps = 1000,
  centralPercents = c(0.9, 0.95, 0.99),
  envelope = TRUE,
  drawPercentiles = FALSE,
  drawQuartiles = FALSE,
  legend = NULL,
  legend.xy = "topleft",
  legend.cex = 0.8,
  nexemplars = 0,
  typex = NULL,
  plainTrails = FALSE,
  colTrails = NULL,
  alphaTrails = 0.25,
  lwdTrails = 1,
  lineup = FALSE,
  nsuspects = 20,
  col = NULL,
  h = 260,
  c = 90,
  l = 60,
  alpha = 1,
  cex = NULL,
  pch = 19,
  type = NULL,
  main = NULL,
  xlab = NULL,
  ylab = NULL,
  xlim = NULL,
  ylim = NULL,
  axes = NULL,
  bty = "o",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="qqtest_+3A_data">data</code></td>
<td>
<p>A univariate dataset to be tested. If data has more than one column, the first is used.</p>
</td></tr>
<tr><td><code id="qqtest_+3A_dist">dist</code></td>
<td>
<p>The name of the distribution against which the comparison is made, the test distribution for a few built-in distributions.
One of <code>"gaussian"</code> (or <code>"normal"</code>), <code>"log normal"</code>,<code>"half normal"</code>,
<code>"uniform"</code>,<code>"exponential"</code>,<code>"student"</code>, <code>"chi-squared"</code>, or <code>"kay"</code>.
Only the first three characters of any of these is needed to specify the dist.
</p>
<p>If dist is <code>"student"</code>,  <code>"chi-squared"</code>, or <code>"kay"</code>, then a value for the degrees of freedom
argument (<code>df</code> below) is also required.</p>
</td></tr>
<tr><td><code id="qqtest_+3A_df">df</code></td>
<td>
<p>Degrees of freedom of <code>dist</code> to be used when <code>dist</code> is either <code>"student"</code> or <code>"chi-squared"</code>.</p>
</td></tr>
<tr><td><code id="qqtest_+3A_qfunction">qfunction</code></td>
<td>
<p>If non-<code>NULL</code>, this must be a function of a single argument (a proportion, p say) which will be used
to calculate the quantiles for the test distribution.  If non-<code>NULL</code>, the <code>rfunction</code> should also be non-<code>NULL</code>.
The value of the <code>dist</code> argument will be ignored when this is the case.</p>
</td></tr>
<tr><td><code id="qqtest_+3A_rfunction">rfunction</code></td>
<td>
<p>If non-<code>NULL</code>, this must be a function of a single argument (a count, n say) which will be
used to randomly select a sample of size n from the test distribution.
If non-<code>NULL</code>, the <code>qfunction</code> must also be non-NULL.
If <code>qfunction</code> is non-<code>NULL</code> and  <code>rfunction</code> is <code>NULL</code>, then <code>qfunction</code> will
be applied to the output of a call to <code>runif</code> in place of the <code>NULL</code> <code>rfunction</code>
(i.e. a probability integral transform is used to generate a random sample).
</p>
<p>The value of the <code>dist</code> argument will be ignored whenever <code>qfunction</code> is a function.</p>
</td></tr>
<tr><td><code id="qqtest_+3A_datatest">dataTest</code></td>
<td>
<p>If non-<code>NULL</code>, this must be a second data set.
The empirical distribution given by this data will be used as the test distribution against which the value of data will be tested.
If non-<code>NULL</code>, the values of the arguments <code>dist</code>, <code>qfunction</code>, and <code>rfunction</code> will all be ignored in
favour of using this empirical distribution as the test distribution.</p>
</td></tr>
<tr><td><code id="qqtest_+3A_p">p</code></td>
<td>
<p>If non-<code>NULL</code>, this must be a vector containing the probability points at which the quantiles are to be calculated.
If the length of this vector is the same as that of the data, then <code>p</code> is taken to be the probabilities that
correspond to the data; otherwise the data are taken to provide and empirical quantile function values of which are
taken at <code>p</code> to produce the plot.
</p>
<p>If <code>p</code> is <code>NULL</code> (the default), then <code>p</code> is determined by the function <code>ppoints(n,a)</code>
where <code>n</code> is the number of data points in <code>data</code> and <code>a</code> is given by the argument <code>a</code> below.</p>
</td></tr>
<tr><td><code id="qqtest_+3A_a">a</code></td>
<td>
<p>This is the second parameter given to the <code>ppoints</code> call to determine <code>p</code> as necessary.
If <code>a</code> is <code>NULL</code>, then default values are chosen for each specific distribution
(e.g. 3/8 for gaussian, 0 for uniform, etc.) and as 2/5 otherwise, following the recommendations of C. Cunnane (1978).
Users may supply their own value such as the original Hazen's 1/2 or Tukey's 1/3.</p>
</td></tr>
<tr><td><code id="qqtest_+3A_np">np</code></td>
<td>
<p>This is required if the vector <code>p</code> is provided.
Because <code>p</code> could take any values, we need to know <code>np</code> the sample size that was used  to construct the
quantiles at the provided vlaues <code>p</code>.
When <code>p</code> and <code>np</code> are provided all simulation is based on simulating values from the distribution of
the order statistics <code>p*np</code>.</p>
</td></tr>
<tr><td><code id="qqtest_+3A_matchmethod">matchMethod</code></td>
<td>
<p>It is necessary to match locations and scales of the two distributions.  The method used to do this matching
is given by <code>matchMethod</code> which must be one of <code>c("hinges","quartiles", "middlehalf", "bottomhalf", "tophalf")</code>.
A line is fitted to the data and its coefficients used to adjust the location and scale of the test quantiles to match the data.
</p>
<p>If <code>matchMethod = "hinges"</code> (the default), then the line is fit to <code>(x, y)</code> pairs given by the three central values of
<code>fivenum()</code> on each of the coordinates; if <code>"quartiles"</code> the three quartiles of each coordinate are paired and a line fit.
The method <code>"middlehalf"</code>, as the name suggests, fits a line to the middle half of the sorted data.  In this way, it is very similar
to the previous two methods.  All three are fairly robust and use the central part of the data to estimate the location and scale based roughly
on matching medians and inter-quartile spreads.
</p>
<p>The remaining two methods, <code>"bottomhalf"</code> and <code>"tophalf"</code>, use a line fitted to the bottom and top half of the sorted data.
These are not generally recommended but might be used when the comparison <code>dist</code> is skewed.  For example with a chi-squared distribution,
one might use <code>bottomhalf</code> to match on data from the shorter left tail of the distribution.  Similarly, <code>"tophalf"</code> might be
preferred when <code>dist</code> is skewed in the opposite direction.
</p>
<p>Finally, note that the user may supply their own matching method by providing a function having vector arguments <code>x</code> and <code>y</code>
for the horizontal and vertical quantiles which returns a vector of coefficients (intercept, slope) for the line to be used to match
the quantile location and scales.</p>
</td></tr>
<tr><td><code id="qqtest_+3A_xaxisasprobs">xAxisAsProbs</code></td>
<td>
<p>If <code>TRUE</code> (the default is FALSE) the horizontal axis will be labelled as probabilities.
These are the cumulative probabilities according to the test distribution.  They are located at the corresponding quantile values.
They are handy in comparing percentiles of the test and data distributions as well as giving some measure of the symmetry and
tail weights of the test distribution by their location.
If <code>FALSE</code> the axis is labelled according to the quantile values.</p>
</td></tr>
<tr><td><code id="qqtest_+3A_yaxisasprobs">yAxisAsProbs</code></td>
<td>
<p>If <code>TRUE</code> (the default is FALSE) the vertical axis will be labelled as probabilities.
These are the cumulative probabilities according to the empirical distribution of the <code>data</code>.
They are located at the corresponding quantile values.
They are handy in comparing percentiles of the test and data distributions as well as giving
some measure of the symmetry and tail weights of the <code>data</code> distribution by their location.
If <code>FALSE</code> the axis is labelled according to the quantile values.</p>
</td></tr>
<tr><td><code id="qqtest_+3A_xaxisprobs">xAxisProbs</code></td>
<td>
<p>A vector of probabilities to be used to label the x axis ticks when <code>xAxisAsProbs</code> is <code>TRUE</code>.
Default is <code>c(0.05, 0.25, 0.50, 0.75, 0.95)</code>.  Ignored if <code>xAxisAsProbs</code> is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="qqtest_+3A_yaxisprobs">yAxisProbs</code></td>
<td>
<p>A vector of probabilities to be used to label the y axis ticks when <code>yAxisAsProbs</code> is <code>TRUE</code>.
Default is <code>c(0.05, 0.25, 0.50, 0.75, 0.95)</code>.  Ignored if <code>yAxisAsProbs</code> is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="qqtest_+3A_nreps">nreps</code></td>
<td>
<p>The number of replicate samples to be taken from the test distribution to construct the pointwise intervals
for each quantile.  Default is 1000.
From these samples, an empirical distribution is generated from the test distribution for the ordered quantiles
corresponding to the values of<code>ppoints(length(data))</code>.
These are used to construct central intervals of whatever proportions are given by <code>centralPercents</code>.</p>
</td></tr>
<tr><td><code id="qqtest_+3A_centralpercents">centralPercents</code></td>
<td>
<p>The vector of proportions determining the central intervals of the empirical distribution of
each ordered quantile from the test distribution.
Default is <code>c(0.90, 0.95, 0.99)</code> corresponding to central 90, 95, and 99% simulated pointwise confidence
intervals for each quantile coming from the test distribution for a sample the same size as <code>data</code>.
The quality of these interval locations typically increases with <code>nreps</code> and decreases with the
probability used for each interval.</p>
</td></tr>
<tr><td><code id="qqtest_+3A_envelope">envelope</code></td>
<td>
<p>If <code>TRUE</code> (the default), a grey envelope is plotted showing the central intervals for
each quantile as a shade of grey.  The higher is the corresponding probability associated with the interval,
the lighter is the shade.
The outermost edges of the envelope are the range of the simulated data from the test distribution.
The envelope thus provides a (pointwise) density estimate of the quantiles drawn from the test distribution for this sample size.
If <code>FALSE</code> no envelope is drawn.</p>
</td></tr>
<tr><td><code id="qqtest_+3A_drawpercentiles">drawPercentiles</code></td>
<td>
<p>If <code>TRUE</code>, a pair of curves is plotted to show each of the central intervals as a different line type.
These are plotted over the envelope if <code>envelope</code> is <code>TRUE</code>.
If <code>FALSE</code> (the default) no simulated percentile curves are drawn.</p>
</td></tr>
<tr><td><code id="qqtest_+3A_drawquartiles">drawQuartiles</code></td>
<td>
<p>If <code>TRUE</code>, a pair of curves is plotted to show the quartiles (central 50% region)
of the ordered quantiles simulated from the test distribution.  The median of these is also plotted as a solid line type.
These are plotted over the envelope if <code>envelope</code> is <code>TRUE</code>.
If <code>FALSE</code> (the default) none of these curves are drawn.</p>
</td></tr>
<tr><td><code id="qqtest_+3A_legend">legend</code></td>
<td>
<p>If <code>TRUE</code> (the default is <code>NULL</code>) with <code>nreps&gt;0</code> a legend for the appearance
of the simulated ranges of the central intervals is added to the plot.
If <code>FALSE</code>, no legend appears. If <code>NULL</code>, legend always appears except when <code>lineup = TRUE</code>.</p>
</td></tr>
<tr><td><code id="qqtest_+3A_legend.xy">legend.xy</code></td>
<td>
<p>Either a string being one of <code>c("bottomright", "bottom", "bottomleft", "left", "topleft","top", "topright", "right", "center")</code>
(default is <code>"topleft"</code>) or a list with named components <code>x</code> and <code>y</code>
to be interpreted exactly as in the function <code>legend()</code> from the <code>graphics</code> package.</p>
</td></tr>
<tr><td><code id="qqtest_+3A_legend.cex">legend.cex</code></td>
<td>
<p>Character expansion size for legend (default 0.8).</p>
</td></tr>
<tr><td><code id="qqtest_+3A_nexemplars">nexemplars</code></td>
<td>
<p>(default is 0) The number of replicate samples to be taken from the test distribution and
plotted as a coloured trail on the qqplot.
Each such trail is a sample of the same size as <code>data</code> but truly coming from the test distribution.
Each trail gives some idea of what the shape of a qqplot would be for a sample of that size from the test distribution.
Together, they give some sense of the variability in the plot's shape.</p>
</td></tr>
<tr><td><code id="qqtest_+3A_typex">typex</code></td>
<td>
<p>(default is &quot;o&quot;, or match <code>type</code> if supplied) The <code>plot</code> type to be used in the
plotting of the exemplars, legal values are the same as for the  <code>type</code> argument of <code>plot</code>.</p>
</td></tr>
<tr><td><code id="qqtest_+3A_plaintrails">plainTrails</code></td>
<td>
<p>If <code>TRUE</code>, then a single grey colour is used for all exemplar trails.
If <code>FALSE</code> (the default), each exemplar trail is shown in a different colour.</p>
</td></tr>
<tr><td><code id="qqtest_+3A_coltrails">colTrails</code></td>
<td>
<p>Colours to be used for the trails (default will be multi-colours).</p>
</td></tr>
<tr><td><code id="qqtest_+3A_alphatrails">alphaTrails</code></td>
<td>
<p>The alpha transparency to be used in plotting all exemplar trails. The default is 0.25.
Because the trails will overplot, a smaller <code>alphaTrails</code> value is recommended as <code>nexemplars</code> increases.</p>
</td></tr>
<tr><td><code id="qqtest_+3A_lwdtrails">lwdTrails</code></td>
<td>
<p>The graphical line width (<code>lwd</code>) to be used in plotting all exemplar trails.   The default is 1.
Because the trails will overplot, combining a larger <code>lwdTrails</code> with <code>envelope = FALSE</code>,
a lower <code>alphaTrails</code> value larger <code>nexemplars</code> can give a truer sense of the density of qqplot
configurations than with <code>envelope = TRUE</code>.</p>
</td></tr>
<tr><td><code id="qqtest_+3A_lineup">lineup</code></td>
<td>
<p>If <code>TRUE</code> (default is <code>FALSE</code>) the qqplot of <code>data</code> is randomly located in a
grid of <code>nsuspects</code> plots.  Identical arguments are given to construct all <code>qqtest</code> plots in the grid.
Assuming the viewer has not seen the qqplot of this <code>data</code> before, a successful selection of the true <code>data</code>
plot out of the grid of plots corresponds to evidence against the hypothesis that the <code>data</code> come from the test distribution.
Significance level is 1/<code>nsuspects</code>.
Similarly, if the viewer narrows the selection down to only k possible subjects AND the true location is among them, then
the corresponding observed level of significance (p-value) would be k//<code>nsuspects</code>.
</p>
<p>Each plot is given a suspect number from 1 to <code>nsuspects</code> (left to right, top to bottom).
The suspect number of the plot corresponding to the actual <code>data</code> is returned, slightly obfuscated to help keep the test honest.</p>
</td></tr>
<tr><td><code id="qqtest_+3A_nsuspects">nsuspects</code></td>
<td>
<p>The total number of plots (default is 20) to be viewed in the lineup display when <code>lineup</code> is <code>lineup</code>.</p>
</td></tr>
<tr><td><code id="qqtest_+3A_col">col</code></td>
<td>
<p>If non-<code>NULL</code>, <code>col</code> must be colour to be used for the points in the plot.  If <code>NULL</code> (the default), an <code>hcl</code> colour will be used from the values of the arguments <code>h</code>, <code>c</code>, <code>l</code>, and <code>alpha</code>.</p>
</td></tr>
<tr><td><code id="qqtest_+3A_h">h</code></td>
<td>
<p>The hue of the colour of the points.  Specified as an angle in degrees from 0 to 360 around a colour wheel.  E.g. 0 is red, 120 green, 240 blue,  Default is 260 (a bluish).</p>
</td></tr>
<tr><td><code id="qqtest_+3A_c">c</code></td>
<td>
<p>The chroma of the colour of the points.  Takes values from 0 to an upper bound that is a function of hue, <code>h</code>,  and luminance, <code>l</code>.  Roughly, for fixed <code>h</code> and <code>l</code> the higher the value of <code>c</code> the greater the intensity of colour.</p>
</td></tr>
<tr><td><code id="qqtest_+3A_l">l</code></td>
<td>
<p>The luminance of the colour of the points.  Takes values from 0 to 100. For any given combination of hue, <code>h</code>,  and chroma, <code>c</code>, only a subset of this range will be possible.  Roughly, for fixed <code>h</code> and <code>c</code> the higher the value of <code>l</code> the lighter is the colour.</p>
</td></tr>
<tr><td><code id="qqtest_+3A_alpha">alpha</code></td>
<td>
<p>The alpha transparency of the colour of the points.  Takes values from 0 to 1. Values near 0 are more transparent, values near 1 (the default) are more opaque. Alpha values sum when points over plot, giving some indication of density.</p>
</td></tr>
<tr><td><code id="qqtest_+3A_cex">cex</code></td>
<td>
<p>The graphical parameter <code>cex</code> for the size of the points.</p>
</td></tr>
<tr><td><code id="qqtest_+3A_pch">pch</code></td>
<td>
<p>The graphical parameter <code>pch</code> for the point character to be used for the points.  Default is 19, a filled circle.</p>
</td></tr>
<tr><td><code id="qqtest_+3A_type">type</code></td>
<td>
<p>The graphical parameter <code>type</code> for the points of the qqplot. Default is &quot;p&quot;.</p>
</td></tr>
<tr><td><code id="qqtest_+3A_main">main</code></td>
<td>
<p>The graphical parameter <code>main</code> providing a title for the plot.
If <code>NULL</code> (the default), the title will be &quot;qqtest&quot; when <code>lineup = FALSE</code> and &quot;Suspect: &quot; followed by
the plot number when <code>lineup = TRUE</code>.  An empty string will suppress the title.</p>
</td></tr>
<tr><td><code id="qqtest_+3A_xlab">xlab</code></td>
<td>
<p>The graphical parameter <code>xlab</code> labelling the x axis of the plot.
If <code>NULL</code> (the default), an <code>xlab</code> is created based on the information available from the
other arguments to <code>qqtest</code> about the test distribution.  An empty string will suppress the labelling.</p>
</td></tr>
<tr><td><code id="qqtest_+3A_ylab">ylab</code></td>
<td>
<p>The graphical parameter <code>ylab</code> labelling the y axis of the plot.
If <code>NULL</code> (the default), a <code>ylab</code> is created based on the information available from the other
arguments to <code>qqtest</code>. An empty string will suppress the labelling.</p>
</td></tr>
<tr><td><code id="qqtest_+3A_xlim">xlim</code></td>
<td>
<p>The graphical parameter <code>xlim</code> determining the display limits of the x axis.</p>
</td></tr>
<tr><td><code id="qqtest_+3A_ylim">ylim</code></td>
<td>
<p>The graphical parameter <code>ylim</code> determining the display limits of the y axis.</p>
</td></tr>
<tr><td><code id="qqtest_+3A_axes">axes</code></td>
<td>
<p>The graphical parameter <code>axes</code> determining whether axes are to be displayed
(default is <code>NULL</code> which the same as <code>TRUE</code> except when <code>lineup=TRUE</code>, then <code>axes</code> is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="qqtest_+3A_bty">bty</code></td>
<td>
<p>The graphical parameter <code>bty</code> determining the type of box to be used to
enclose the plot (default is <code>"o"</code>, set <code>bty="n"</code> for no box).</p>
</td></tr>
<tr><td><code id="qqtest_+3A_...">...</code></td>
<td>
<p>Any further graphical parameters to be passed to the <code>plot</code> function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Displays the qqplot.
</p>
<p>Invisibly returns a list with named components <code>x</code>, <code>y</code>, and <code>order</code> giving the horizontal and
vertical locations of the points in sorted order, as well as the order vector from the input data.   The result of <code>qqtest</code> must be assigned to get these.
The values could then, for example, be used to identify or label points in the display.
</p>
<p>When <code>lineup</code> is <code>TRUE</code>, it returns a string encoding
the true location of the data as a calculation to be evaluated.  This provides some simple obfuscation of the true
location so that the visual assessment can be honest.  The true location is revealed by calling <code>revealLocation()</code>
on the returned value.
</p>


<h3>Source</h3>

<p>&quot;Self calibrating quantile-quantile plots&quot;,
R. Wayne Oldford, The American Statistician, 70, (2016)
<a href="https://doi.org/10.1080/00031305.2015.1090338">https://doi.org/10.1080/00031305.2015.1090338</a>
</p>
<p>&quot;Unbiased Plotting Positions &ndash; A Review&quot;,
C. Cunnane, Journal of Hydrology, Vol. 37 (1978), pp. 205-222.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#
# default qqtest plot
qqtest(precip, main = "Precipitation (inches/year) in 70 US cities")
#
# qqtest to compare to qqnorm
op &lt;- par(mfrow=c(1,2))
qqnorm(precip, main="qqnorm")
qqtest(precip, main="qqtest",
       xAxisAsProbs=FALSE, yAxisAsProbs=FALSE)
par(op)
#
#  Use lines instead of envelope
qqtest(precip, envelope=FALSE, drawPercentiles=TRUE,
       main = "Precipitation (inches/year) in 70 US cities")
#
#  Use quartiles instead of envelope
qqtest(precip, envelope=FALSE, drawQuartiles=TRUE,
       main = "Precipitation (inches/year) in 70 US cities")
#
#  Use coloured exemplars (qqplot of data simulated from the test distribution)
#  and suppress the envelope.  Where the envelope, percentiles, and quartiles are
#  simulated pointwise bands, exemplars give some sense of what the (joint) shape of the
#  quantile-quantile plot should look like (for data from the test distribution).
#  Each simulated sample is a different colour.
qqtest(precip, nexemplars=10, typex="o", envelope=FALSE, type="p",
       main = "Precipitation (inches/year) in 70 US cities")
#
#  Alternatively, the trail of each exemplar could be plain (the identical grey).
#  Making each trail wide and assigning it some transparency (alpha near 0)
#  allows the trails to give a sense of the density through the darkness of the grey.
#
qqtest(precip, nexemplars=20, envelope=FALSE,
       lwdTrails=3, plainTrails=TRUE, alphaTrail=0.4, typex="o", type="o",
       main = "Precipitation (inches/year) in 70 US cities")
#
#  Wide coloured exemplars with some transparency provide an indication of
#  density and allow some trails to be followed by colour.
#
qqtest(precip, nexemplars=20, envelope=FALSE,
       lwdTrails=3,  alphaTrail=0.4, typex="o", type="o", col="black",
       main = "Precipitation (inches/year) in 70 US cities")


#  Envelope and exemplars with coloured trails to be followed.
#
qqtest(precip, nexemplars=5,
       lwdTrails=2, alphaTrail=0.6, alpha=0.8,
       main = "Precipitation (inches/year) in 70 US cities")
#
#
#  gaussian - qqplot, but now showing in the line up
trueLoc &lt;- qqtest(precip, lineup=TRUE, main="Suspect", legend=FALSE,
                  cex=0.75, col="grey20", ylab="", pch=21)
# the location of the real data in the line up can be found by evaluating
# the contents of the string
trueLoc
#
# Cut and paste the string contents into the R console, or simply
revealLocation(trueLoc)
#
#
# log-normal ... using the bacteria data from Whipple(1916)
data(bacteria, package="qqtest")
# Note that these are selected percentiles from a sample of 365 days in a year
with(bacteria,
    qqtest(count, dist = "log-normal", p=percentTime/100, np=365, type="o",
 		  yAxisAsProbs=FALSE, ylab="bacteria per cc",
           xAxisProbs = c(0.01, 0.50,0.75, 0.90, 0.95, 0.99, 0.995),
           xlab="Percentage of days in 1913",
           main = "Number of bacteria from the Delaware river in 1913")
    )
ptics &lt;- c(0.01, 0.10, 0.25, 0.50, 0.75, 0.90, 0.99 )
axis(1,at=qnorm(ptics), labels=floor(ptics*100))
yvals &lt;- c(100, 1000, 10000, 100000)
axis(2, at=log(yvals,10),
     labels=c("100", "1,000", "10,000", "100,000"))
#
# compare this to the log-scaled normal qqplot
#
#
with(bacteria,
    qqtest(log(count, 10), dist = "normal",
           p=percentTime/100, np=365,
 		  type="o", axes=FALSE,
           ylab="bacteria per cc",
           xlab="Proportion of days in 1913",
           main = "Number of bacteria from the Delaware river in 1913")
    )
#
#
# Half normal ... using the penicillin data from Daniel(1959)
data(penicillin)

qqtest(penicillin, dist = "half-normal")

# Or the same again but with significant contrast labelled


with (penicillin,
	{qqtest(value, yAxisProbs=c(0.1, 0.75, 0.90, 0.95),
         dist="half-normal",
			ylab="Sample cumulative probability",
         xlab="Half-normal cumulative probability")
	 ppAdj &lt;- (1+ppoints(31))/2  # to get half-normals from normal
	 x &lt;- qnorm(ppAdj)
	 valOrder &lt;- order(value)    # need data and rownames in increasing order
	 y &lt;- value[valOrder]
	 tags &lt;- rownames(penicillin)[valOrder]
	 selPoints &lt;- 28:31          # going to label only the largest effects
  xoffset &lt;- c(0.01, 0.02, 0.03, 0.075)  # text function is a bit off
	 text(x[selPoints]-xoffset, y[selPoints],
       tags[selPoints],
       pos=2, cex=0.75)
	}
)

# Alternatively, use the returned results for a lot less work
results &lt;- qqtest(penicillin$value, yAxisProbs=c(0.1, 0.75, 0.90, 0.95),
                     dist="half-normal",
                     ylab="Sample cumulative probability",
                     xlab="Half-normal cumulative probability")
tags &lt;- row.names(penicillin)[results$order]
selPoints &lt;- 28:31          # going to label only the largest effects
xoffset &lt;- c(0.01, 0.02, 0.03, 0.075)  # text function is a bit off
text(results$x[selPoints]-xoffset, results$y[selPoints],
     tags[selPoints],
     pos=2, cex=0.75)

# or the same points could have been identified interactively vusing
# identify(results$x, results$y, labels = row.names(penicillin)[results$order])
#
# K on 9 df  ... see help(dkay)
# Use data on primer paint thickness (standard deviations on n=10)
data(primer, package="qqtest")
with (primer,
	     qqtest(s,  dist="kay", df=9,
		        yAxisAsProbs=FALSE,
			    ylab="Standard deviation of primer thickness (in mils)")
		)
#
# chi-squared on 3 df
# Use robust covariance matrix in calculation Mahalanobis distances
# for the classical Brownlee stackloss data.
data(stacklossDistances, package="qqtest")
with(stacklossDistances,
     qqtest(robust, dist="chi", df=3, ylab="Robust Mahalanobis distances"))
#
#
# user supplied qfunction and rfunction -- compare to beta distribution
qqtest(precip,
       qfunction=function(p){qbeta(p, 2, 2)},
       rfunction=function(n){rbeta(n, 2, 2)},
       main = "Precipitation (inches/year) in 70 US cities")
#
#
# user supplied qfunction only -- compare to beta distribution
qqtest(precip,
       qfunction=function(p){qbeta(p, 2, 2)},
       main = "Precipitation (inches/year) in 70 US cities")
#
# comparing data samples
#
# Does the sample of beaver2's temperatures look like they
# could have come from a distribution shaped like beaver1's?
#
 	qqtest(beaver2[,"temp"],
		       dataTest=beaver1[,"temp"],
		       ylab="Beaver 2", xlab="Beaver 1",
		       main="Beaver body temperatures")

</code></pre>

<hr>
<h2 id='revealLocation'><code>revealLocation</code> Revealing locations encoded as a string calculation.</h2><span id='topic+revealLocation'></span>

<h3>Description</h3>

<p>Reveals the location by parsing and evaluating the string.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>revealLocation(hiddenLocation)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="revealLocation_+3A_hiddenlocation">hiddenLocation</code></td>
<td>
<p>A character vector of calculation strings.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the value of the each calculation.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+hideLocation">hideLocation</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>trueLoc &lt;- hideLocation(3,100)
trueLoc
revealLocation(trueLoc)

n &lt;- 200
trueLoc &lt;- sample(1:n, 3)
trueLoc
ans &lt;- hideLocation(trueLoc , n)
ans
revealLocation(ans)

</code></pre>

<hr>
<h2 id='rkay'><code>rkay</code> The K distribution - generating pseudo-random values</h2><span id='topic+rkay'></span>

<h3>Description</h3>

<p>Random generation for the K distribution on <code>df</code> degrees of freedom having non-centrality parameter <code>ncp</code>.
</p>
<p>A K distribution is the square root of a chi-square divided by its degrees of freedom.  That is, if x is chi-squared on m degrees of freedom, then y = sqrt(x/m) is K on m degrees of freedom.
Under standard normal theory, K is the distribution of the pivotal quantity  s/sigma where s is the sample standard deviation and sigma is the standard deviation parameter of the normal density.  K is the natural distribution for tests and confidence intervals about sigma.
K densities are more nearly symmetric than are chi-squared and concentrate near 1.  As the degrees of freedom increase, they become more symmetric, more concentrated, and more nearly normally distributed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rkay(n, df, ncp = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rkay_+3A_n">n</code></td>
<td>
<p>Number of observations. If <code>length(n) &gt; 1</code>, the length is taken to be the number required.</p>
</td></tr>
<tr><td><code id="rkay_+3A_df">df</code></td>
<td>
<p>Degrees of freedom (non-negative, but can be non-integer).</p>
</td></tr>
<tr><td><code id="rkay_+3A_ncp">ncp</code></td>
<td>
<p>Non-centrality parameter (non-negative).</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>rkay</code> returns pseudo-randomly generated values.
</p>
<p>Invalid arguments will result in return value NaN, with a warning.
</p>


<h3>Note</h3>

<p>Depends on call to analogous chi-squared functions.  See <code>rchisq</code> for details on non-centrality parameter calculations.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
x &lt;- rkay(100, 20)
hist(x, main="100 observations from a K(20)")
# Certainly looks like it comes from a K on 20
qqtest(x, dist="kay",df=20)
# for this many degrees of freedom it looks
# a lot like a gaussian (normal) distribution
qqtest(x, dist="gau",df=1)
# But not like it came from a K on 1 degree of freedom
qqtest(x, dist="kay",df=1)
#
# See the vignette for more on the "K-distribution"
#
</code></pre>

<hr>
<h2 id='sittingHeights'>Sitting height in inches of female adults (aged 23-50).</h2><span id='topic+sittingHeights'></span>

<h3>Description</h3>

<p>From measurements made by Francis Galton at London's International Health Exhibition in 1884, published in 1885.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sittingHeights
</code></pre>


<h3>Format</h3>

<p>A data frame with 9 rows and 8 variates, the first 5 of which are as recorded by Galton:
</p>

<dl>
<dt>lowerBound</dt><dd><p>Sitting height greater than or equal to this lower bound in inches.</p>
</dd>
<dt>upperBound</dt><dd><p>Sitting height strictly less than this upper bound in inches.</p>
</dd>
<dt>nCases</dt><dd><p>Number of cases observed with sitting height between the two bounds.</p>
</dd>
<dt>nCasesCumulative</dt><dd><p>Number of cases observed with sitting height up to but not including the upper bound.</p>
</dd>
<dt>percentCumulative</dt><dd><p>Cumulative number of cases expressed as a percent.</p>
</dd>
<dt>binCentre</dt><dd><p>Average of the lower and upper bounds.</p>
</dd>
<dt>nCasesCentred</dt><dd><p>Number of cases assigned to the binCentre; half of cases observed with sitting height between the two bounds is assigned to be below the binCentre, half above (avoids producing 100 percent for last entry).</p>
</dd>
<dt>proportionCumulativeAdjusted</dt><dd><p>Cumulative proportions using nCasesCentred. </p>
</dd>
</dl>


<h3>Details</h3>

<p><code>with(sittingHeights, plot(percentCumulative,upperBound, type="o", lwd=2, xlim=c(0,100), ylim=c(20,40),xlab="Percentage of women", ylab="Sitting heights in inches"))</code> will effect Galton's Ogive.
</p>
<p><code>with(sittingHeights, qqtest(binCentre, dist="normal", p = proportionCumulativeAdjusted, np=775, main="Sitting heights of women in inches"))</code> will effect a normal qqplot for this data.
</p>


<h3>Source</h3>

<p>&quot;The Application of a Graphic Method to Fallible Measures&quot;, 
Francis Galton, (1885), Journal of the Statistical Society of London, Jubilee Volume (June 22-24, 1885), pp. 262-265.
</p>

<hr>
<h2 id='stacklossDistances'>Mahalanobis squared distances of Brownlee's stack loss plant operation data based only on the explanatory variates (air flow, water temperature, and acid concentration).</h2><span id='topic+stacklossDistances'></span>

<h3>Description</h3>

<p>Mahalanobis distances were calculated using the mahalanobis R function. 
Under standard normal theory, these are approximately Chi-squared on 3 degrees of freedom.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stacklossDistances
</code></pre>


<h3>Format</h3>

<p>A data frame with 21 rows and 2 variates:
</p>

<dl>
<dt>ordinary</dt><dd><p>Mahalanobis squared distances from the arithemetic mean using the eliptical contours of the sample covariance matrix.</p>
</dd>
<dt>robust</dt><dd><p>As with distances, these are Mahalobis squared distances butnow based on robust measures of location and covariance matrix (as determined from the default covRob of the robust package).</p>
</dd>
</dl>


<h3>Details</h3>

<p><code>with(stacklossDistances, qqtest(robust,dist="chi", df=3))</code> will show &quot;outliers&quot;.
</p>
<p><code>with(stacklossDistances, qqtest(ordinary,dist="chi", df=3))</code> will show &quot;inliers&quot;.
</p>


<h3>Source</h3>

<p>&quot;Statistical Theory and Methodology in Science and Engineering&quot;, 
K.A. Brownlee, (1960, 2nd ed. 1965), Wiley, New York pp. 491-500.
</p>

<hr>
<h2 id='WachusettReservoir'>Storage, in millions of gallons daily per square mile of net land area, at the Wachusett Reservoir in Massacusetts - storage computed for each of several rates of draft (draft being a determined maintainable flow in 1,000s of gallons per square mile daily).</h2><span id='topic+WachusettReservoir'></span>

<h3>Description</h3>

<p>First extensive published use of normal qqplots. Hazen uses a=1/2 to make the p values for the plots.  Hazen doesn'tplot zeros but has them contribute to the sample size. The context of use is in a study of the relation between the water storage provided in a reservoir on any stream and the quantity of water that can be continuously supplied by it.  To quote the paper: ... treat all the remaining variations on the basis of probabilities, using all data from a number of streams; and to study them in comparison with the normal law of error.&quot;
</p>


<h3>Usage</h3>

<pre><code class='language-R'>WachusettReservoir
</code></pre>


<h3>Format</h3>

<p>A data frame with 15 rows and 6 variates:
</p>

<dl>
<dt>draft100</dt><dd><p>Computed storage, in millions of gallons per square mile of land area, given a draft of 100,000 gallons per square mile daily.</p>
</dd>
<dt>draft200</dt><dd><p>Computed storage, in millions of gallons per square mile of land area, given a draft of 200,000 gallons per square mile daily.</p>
</dd>
<dt>draft400</dt><dd><p>Computed storage, in millions of gallons per square mile of land area, given a draft of 400,000 gallons per square mile daily.</p>
</dd>
<dt>draft600</dt><dd><p>Computed storage, in millions of gallons per square mile of land area, given a draft of 600,000 gallons per square mile daily.</p>
</dd>
<dt>draft800</dt><dd><p>Computed storage, in millions of gallons per square mile of land area, given a draft of 800,000 gallons per square mile daily.</p>
</dd>
<dt>draft1000</dt><dd><p>Computed storage, in millions of gallons per square mile of land area, given a draft of 1,000,000 gallons per square mile daily.</p>
</dd>
</dl>


<h3>Details</h3>

<p><code>qqtest(WachusettReservoir$draft800,dist="uniform", a=1/2,type="o")</code> will effect Hazen's original plot for a draft of 800,000 gallons per square mile daily.
</p>
<p><code>qqtest(WachusettReservoir$draft800,dist="normal", a=1/2, type="o")</code> will effect Hazen's normal qq plot for a draft of 800,000 gallons per square mile daily.
</p>


<h3>Source</h3>

<p>&quot;Storage to be provided in impounding reservoirs for municipal water supply (with discussion)&quot;, 
Allen Hazen, Transactions of the American Society of Civil Engineers, Vol. 77, (1914), pp. 1539-1669.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
