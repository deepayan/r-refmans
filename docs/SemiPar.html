<!DOCTYPE html><html><head><title>Help for package SemiPar</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {SemiPar}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#age.income'><p>Age/income data</p></a></li>
<li><a href='#bpd'><p>Bronchopulmonary dysplasia data</p></a></li>
<li><a href='#calif.air.poll'><p>California air polution data</p></a></li>
<li><a href='#copper'><p>Copper data</p></a></li>
<li><a href='#elec.temp'><p>Electricity usage and temperature data</p></a></li>
<li><a href='#ethanol'><p>Ethanol data</p></a></li>
<li><a href='#fitted.spm'><p>Fitted values for semiparametric regression.</p></a></li>
<li><a href='#fossil'><p>Fossil data</p></a></li>
<li><a href='#fuel.frame'><p>Automobile data from consumer reports</p></a></li>
<li><a href='#janka'><p>Janka hardness data</p></a></li>
<li><a href='#lidar'><p>LIDAR data</p></a></li>
<li><a href='#lines.spm'><p>Add a curves to an existing plot.</p></a></li>
<li><a href='#milan.mort'><p>Milan mortality data</p></a></li>
<li><a href='#monitor.mercury'><p>Mercury biomonintoring data</p></a></li>
<li><a href='#onions'><p>Onions data</p></a></li>
<li><a href='#pig.weights'><p>Pig weight data</p></a></li>
<li><a href='#plot.spm'><p>Semiparametric regression plotting</p></a></li>
<li><a href='#predict.spm'><p>Semiparametric regression prediction.</p></a></li>
<li><a href='#print.spm'><p>Prints semiparametric regression fit object.</p></a></li>
<li><a href='#ragweed'><p>Ragweed data</p></a></li>
<li><a href='#residuals.spm'><p>Residuals for semiparametric regression.</p></a></li>
<li><a href='#retire.plan'><p>Retirement plan data</p></a></li>
<li><a href='#salinity'><p>Salinity data</p></a></li>
<li><a href='#sausage'><p>Sausage data</p></a></li>
<li><a href='#scallop'><p>Scallop abundance data</p></a></li>
<li><a href='#SemiPar-internal'><p>Internal SemiPar Objects</p></a></li>
<li><a href='#sitka'><p>Sitka spruce data</p></a></li>
<li><a href='#spm'><p>Fit a SemiParametric regression Model</p></a></li>
<li><a href='#summary.spm'><p>Semiparametric regression summary</p></a></li>
<li><a href='#term.structure'><p>Term structure data</p></a></li>
<li><a href='#trade.union'><p>Trade union data</p></a></li>
<li><a href='#ustemp'><p>U.S. temperature data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>1.0-4.2</td>
</tr>
<tr>
<td>Title:</td>
<td>Semiparametic Regression</td>
</tr>
<tr>
<td>Author:</td>
<td>Matt Wand &lt;mwand@uts.edu.au&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Billy Aung Myint &lt;r@use-r.com&gt;</td>
</tr>
<tr>
<td>Imports:</td>
<td>MASS, cluster, nlme</td>
</tr>
<tr>
<td>Suggests:</td>
<td>lattice</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions for semiparametric regression analysis, to
        complement the book: Ruppert, D., Wand, M.P. and Carroll, R.J.
        (2003). Semiparametric Regression. Cambridge University Press.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="http://matt-wand.utsacademics.info/SPmanu.pdf">http://matt-wand.utsacademics.info/SPmanu.pdf</a></td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-04-16 14:26:13 UTC; hornik</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-04-16 15:01:35 UTC</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
</table>
<hr>
<h2 id='age.income'>Age/income data</h2><span id='topic+age.income'></span>

<h3>Description</h3>

<p>The <code>age.income</code> data frame has 205 pairs observations on 
Canadian workers from a 1971 Canadian Census Public Use Tape
(Ullah, 1985).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(age.income)</code></pre>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>age</dt><dd><p>age in years.</p>
</dd>
<dt>log.income</dt><dd><p>logarithm of income.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Ullah, A. (1985). Specification analysis of econometric
models. <em>Journal of Quantitative Economics</em>,
<b>2</b>, 187-209.
</p>


<h3>References</h3>

<p>Ruppert, D., Wand, M.P. and Carroll, R.J. (2003)<br />
<em>Semiparametric Regression</em> Cambridge University Press.<br />
<a href="http://stat.tamu.edu/~carroll/semiregbook/">http://stat.tamu.edu/~carroll/semiregbook/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(SemiPar)
data(age.income)
attach(age.income)
plot(age,log.income)
</code></pre>

<hr>
<h2 id='bpd'>Bronchopulmonary dysplasia data</h2><span id='topic+bpd'></span>

<h3>Description</h3>

<p>The <code>bpd</code> data frame has data on 223 human babies.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(bpd)</code></pre>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>birthweight</dt><dd><p>birthweight of baby (grammes).</p>
</dd>
<dt>BPD</dt><dd><p>an indicator of presence of bronchopulmonary dysplasia (BPD):
0=absent, 1=present.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Pagano, M. and Gauvreau, K. (1993).
<em>Principles of Biostatistics</em>. Duxbury Press.
</p>


<h3>References</h3>

<p>Ruppert, D., Wand, M.P. and Carroll, R.J. (2003)<br />
<em>Semiparametric Regression</em> Cambridge University Press.<br />
<a href="http://stat.tamu.edu/~carroll/semiregbook/">http://stat.tamu.edu/~carroll/semiregbook/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(SemiPar)
data(bpd)
attach(bpd)
plot(birthweight,BPD)
boxplot(split(birthweight,BPD),col="green")
</code></pre>

<hr>
<h2 id='calif.air.poll'>California air polution data</h2><span id='topic+calif.air.poll'></span>

<h3>Description</h3>

<p>The <code>calif.air.poll</code> data frame has 345 sets
of observations ozone level and meteorological variables
in Upland, California, U.S.A., in 1976.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(calif.air.poll)</code></pre>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>ozone.level</dt><dd><p>Ozone concentration (ppm) at Sandburg Air Force Base.</p>
</dd>
<dt>daggett.pressure.gradient</dt><dd><p>Pressure gradient at Daggett, California.</p>
</dd>
<dt>inversion.base.height</dt><dd><p>Inversion base height, feet.</p>
</dd>
<dt>inversion.base.temp</dt><dd><p>Inversion base temperature, degrees Fahrenheit.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Brieman, L. and Friedman, J. (1985). Estimating optimal
transformations for multiple regression and correlation
(with discussion).
<em>Journal of the American Statistical Association</em>,
<b>80</b>, 580&ndash;619.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(SemiPar)
data(calif.air.poll)
pairs(calif.air.poll)
</code></pre>

<hr>
<h2 id='copper'>Copper data</h2><span id='topic+copper'></span>

<h3>Description</h3>

<p>The <code>copper</code> data frame has 442 sets
of observations from a simulation based on a stockpile
of mined material in the former Soviet Union. Boreholes
have been drilled into the dump. The drill core
is cut every 5 metres and assayed for copper and cobalt
content in percentage by weight.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(copper)</code></pre>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>sample.num</dt><dd><p>sample number.</p>
</dd>
<dt>id</dt><dd><p>sample identification number.</p>
</dd>
<dt>zone</dt><dd><p>zone code.</p>
</dd>
<dt>xcoord</dt><dd><p>x co-ordinate.</p>
</dd>
<dt>ycoord</dt><dd><p>y co-ordinate.</p>
</dd>    
<dt>zcoord</dt><dd><p>z co-ordinate.</p>
</dd>    
<dt>grade</dt><dd><p>grade measurement.</p>
</dd>    
<dt>core.length</dt><dd><p>percentage of copper.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Clark, I. and Harper, W.V. (2000). 
<em>Practical Geostatistics 2000</em>.
Columbus, Ohio: Ecosse North America Llc.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(SemiPar)
data(copper)
pairs(copper[,4:7])
</code></pre>

<hr>
<h2 id='elec.temp'>Electricity usage and temperature data</h2><span id='topic+elec.temp'></span>

<h3>Description</h3>

<p>The <code>elec.temp</code> data frame has 55 observations on
monthly electricity usage and average temperature for
a house in Westchester County, New York, USA.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(elec.temp)</code></pre>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>usage</dt><dd><p>monthly electricity usage (kilowatt-hours) from a house
in Westchester County, New York, USA.</p>
</dd>
<dt>temp</dt><dd><p>average temperature (degrees Fahrenheit) for the
corresponding month.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Chatterjee, S., Handcock, M. and Simonoff, J.S. (1995).
<em>A Casebook for a First Course in Statistics
and Data Analysis</em>, New York: John Wiley &amp; Sons.
</p>


<h3>References</h3>

<p>Ruppert, D., Wand, M.P. and Carroll, R.J. (2003)<br />
<em>Semiparametric Regression</em> Cambridge University Press.<br />
<a href="http://stat.tamu.edu/~carroll/semiregbook/">http://stat.tamu.edu/~carroll/semiregbook/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(SemiPar)
data(elec.temp)
attach(elec.temp)
plot(usage,temp)
</code></pre>

<hr>
<h2 id='ethanol'>Ethanol data</h2><span id='topic+ethanol'></span>

<h3>Description</h3>

<p>The ethanol data frame contains 88 sets of measurements for variables
from an experiment in which ethanol was burned in a
single cylinder automobile test engine.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ethanol)</code></pre>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>NOx</dt><dd><p>the concentration of nitric oxide (NO) and 
nitrogen dioxide (NO2) in engine exhaust, 
normalized by the work done by the engine.</p>
</dd>
<dt>C</dt><dd><p>the compression ratio of the engine</p>
</dd>
<dt>E</dt><dd><p>the equivalence ratio at which the engine was run &ndash;
a measure of the richness of the air/ethanol mix.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Brinkman, N.D. (1981). Ethanol fuel &ndash; a single-cylinder 
engine study of efficiency and exhaust emissions.
<em>SAE transactions</em> Vol. 90, 
No 810345, 1410&ndash;1424.
</p>


<h3>References</h3>

<p>Ruppert, D., Wand, M.P. and Carroll, R.J. (2003)<br />
<em>Semiparametric Regression</em> Cambridge University Press.<br />
<a href="http://stat.tamu.edu/~carroll/semiregbook/">http://stat.tamu.edu/~carroll/semiregbook/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(SemiPar)
data(ethanol)
pairs(ethanol)
</code></pre>

<hr>
<h2 id='fitted.spm'>Fitted values for semiparametric regression.</h2><span id='topic+fitted.spm'></span>

<h3>Description</h3>

<p>Extracts fitted values from a semiparametric 
regression fit object.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'spm'
fitted(object,...)
</code></pre>


<h3>Arguments</h3>

 
<table>
<tr><td><code id="fitted.spm_+3A_object">object</code></td>
<td>
<p>a fitted <code>spm</code> object as produced by <code>spm()</code>.</p>
</td></tr>
<tr><td><code id="fitted.spm_+3A_...">...</code></td>
<td>
<p>other possible arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Extracts fitted from a semiparametric regression fit object.
The fitted are defined to be the set of values obtained
when the predictor variable data are substituted into the
fitted regression model.</p>


<h3>Value</h3>

<p>The vector of fitted.</p>


<h3>Author(s)</h3>

<p>M.P. Wand 
<a href="mailto:mwand@uow.edu.au">mwand@uow.edu.au</a>
(other contributors listed in SemiPar Users' Manual).</p>


<h3>References</h3>

<p>Ruppert, D., Wand, M.P. and Carroll, R.J. (2003)<br />
<em>Semiparametric Regression</em> Cambridge University Press.<br />
<a href="http://stat.tamu.edu/~carroll/semiregbook/">http://stat.tamu.edu/~carroll/semiregbook/</a>
</p>
<p>Ganguli, B. and Wand, M.P. (2005)<br />
<em>SemiPar 1.0 Users' Manual</em>.<br />
<a href="http://matt-wand.utsacademics.info/SPmanu.pdf">http://matt-wand.utsacademics.info/SPmanu.pdf</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+spm">spm</a></code>
<code><a href="#topic+plot.spm">plot.spm</a></code> 
<code><a href="#topic+lines.spm">lines.spm</a></code>
<code><a href="#topic+predict.spm">predict.spm</a></code>
<code><a href="#topic+summary.spm">summary.spm</a></code>
<code><a href="#topic+residuals.spm">residuals.spm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(SemiPar)
data(fossil)
attach(fossil)
fit &lt;- spm(strontium.ratio~f(age))
plot(fit)
points(age,fitted(fit),col="red")
</code></pre>

<hr>
<h2 id='fossil'>Fossil data</h2><span id='topic+fossil'></span>

<h3>Description</h3>

<p>The <code>fossil</code> data frame has 106 observations on fossil shells.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(fossil)</code></pre>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>age</dt><dd><p>age in millions of years</p>
</dd>
<dt>strontium.ratio</dt><dd><p>ratios of strontium isotopes</p>
</dd>
</dl>



<h3>Source</h3>

<p>Bralower, T.J., Fullagar, P.D., Paull, C.K., Dwyer, G.S.
and Leckie, R.M. (1997).
Mid-cretaceous strontium-isotope stratigraphy
of deep-sea sections. <em>Geological Society
of America Bulletin</em>, <b>109</b>, 1421-1442.
</p>


<h3>References</h3>

<p>Ruppert, D., Wand, M.P. and Carroll, R.J. (2003)<br />
<em>Semiparametric Regression</em> Cambridge University Press.<br />
<a href="http://stat.tamu.edu/~carroll/semiregbook/">http://stat.tamu.edu/~carroll/semiregbook/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(SemiPar)
data(fossil)
attach(fossil)
plot(age,strontium.ratio)
</code></pre>

<hr>
<h2 id='fuel.frame'>Automobile data from consumer reports</h2><span id='topic+fuel.frame'></span>

<h3>Description</h3>

<p>The <code>fuel.frame</code> data frame contains data on 
5 variables (columns) for 117 cars (rows).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(fuel.frame)</code></pre>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>car.name</dt><dd><p>character variable giving the name (make) of the car</p>
</dd>
<dt>Weight</dt><dd><p>the weight of the car in pounds.</p>
</dd>
<dt>Disp.</dt><dd><p>the engine displacement in litres.</p>
</dd>
<dt>Mileage</dt><dd><p>gas mileage in miles/gallon.</p>
</dd>    
<dt>Fuel</dt><dd><p>a derived variable concerning fuel efficiency.</p>
</dd>
<dt>Type</dt><dd><p>a factor giving the general type of car. 
The levels are: Small ,Sporty , Compact , 
Medium , Large , Van.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Consumer Reports, April, 1990, pp. 235-288.
</p>


<h3>References</h3>

<p>Chambers, J.M. and Hastie, T.J. (eds.) (1992)<br />
<em>Statistical Models in S</em>.<br />
Wadsworth and Brooks, Pacific Grove, California.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(SemiPar)
data(fuel.frame)
pairs(fuel.frame)
par(mfrow=c(2,2))
fuel.fit &lt;- lm(Fuel ~ Weight + Disp.,fuel.frame)
plot(fuel.fit,ask=FALSE)
par(mfrow=c(1,1))
</code></pre>

<hr>
<h2 id='janka'>Janka hardness data</h2><span id='topic+janka'></span>

<h3>Description</h3>

<p>The <code>janka</code> data frame has 36 observations on Australian timber
samples.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(janka)</code></pre>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>dens</dt><dd><p>a measure of density of the timber.</p>
</dd>
<dt>hardness</dt><dd><p>the Janka hardness (structural property) of the timber.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Williams, E.J. (1959) <em>Regression Analysis</em>, New York:
John Wiley &amp; Sons.
</p>


<h3>References</h3>

<p>Ruppert, D., Wand, M.P. and Carroll, R.J. (2003)<br />
<em>Semiparametric Regression</em> Cambridge University Press.<br />
<a href="http://stat.tamu.edu/~carroll/semiregbook/">http://stat.tamu.edu/~carroll/semiregbook/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(SemiPar)
data(janka)
attach(janka)
plot(dens,hardness)
</code></pre>

<hr>
<h2 id='lidar'>LIDAR data</h2><span id='topic+lidar'></span>

<h3>Description</h3>

<p>The <code>lidar</code> data frame has 221 observations
from a light detection and ranging (LIDAR) experiment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(lidar)</code></pre>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>range</dt><dd><p>distance travelled before the light is reflected
back to its source.</p>
</dd>
<dt>logratio</dt><dd><p>logarithm of the ratio of received light
from two laser sources.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Sigrist, M. (Ed.) (1994). <em>Air Monitoring by 
Spectroscopic Techniques</em> (Chemical Analysis Series, vol. 197).
New York: Wiley.
</p>


<h3>References</h3>

<p>Ruppert, D., Wand, M.P. and Carroll, R.J. (2003)<br />
<em>Semiparametric Regression</em> Cambridge University Press.<br />
<a href="http://stat.tamu.edu/~carroll/semiregbook/">http://stat.tamu.edu/~carroll/semiregbook/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(SemiPar)
data(lidar)
attach(lidar)
plot(range,logratio)
</code></pre>

<hr>
<h2 id='lines.spm'>Add a curves to an existing plot.</h2><span id='topic+lines.spm'></span>

<h3>Description</h3>

<p>Takes a fitted <code>spm</code> object produced by <code>spm()</code> and 
adds a curve. The function is only appropriate in the case 
of a single predictor.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'spm'
lines(x,...)
</code></pre>


<h3>Arguments</h3>

 
<table>
<tr><td><code id="lines.spm_+3A_x">x</code></td>
<td>
<p>a fitted <code>spm</code> object as produced by <code>spm()</code>.</p>
</td></tr>
<tr><td><code id="lines.spm_+3A_...">...</code></td>
<td>
<p>other graphics parameters described in Appendix B of 
the SemiPar Users' Manual <a href="http://matt-wand.utsacademics.info/SPmanu.pdf">http://matt-wand.utsacademics.info/SPmanu.pdf</a></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Takes a fitted <code>spm</code> object produced by <code>spm()</code> and 
adds a curve. The function is only appropriate in the case 
of a single predictor.</p>


<h3>Value</h3>

<p>The function adds a curve to a plot.</p>


<h3>Author(s)</h3>

<p>M.P. Wand 
<a href="mailto:mwand@uow.edu.au">mwand@uow.edu.au</a>
(other contributors listed in SemiPar Users' Manual).</p>


<h3>References</h3>

<p>Ruppert, D., Wand, M.P. and Carroll, R.J. (2003)<br />
<em>Semiparametric Regression</em> Cambridge University Press.<br />
<a href="http://stat.tamu.edu/~carroll/semiregbook/">http://stat.tamu.edu/~carroll/semiregbook/</a>
</p>
<p>Ganguli, B. and Wand, M.P. (2005)<br />
<em>SemiPar 1.0 Users' Manual</em>.<br />
<a href="http://matt-wand.utsacademics.info/SPmanu.pdf">http://matt-wand.utsacademics.info/SPmanu.pdf</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+spm">spm</a></code>
<code><a href="#topic+plot.spm">plot.spm</a></code>
<code><a href="#topic+predict.spm">predict.spm</a></code>
<code><a href="#topic+summary.spm">summary.spm</a></code>
<code><a href="#topic+residuals.spm">residuals.spm</a></code>
<code><a href="#topic+fitted.spm">fitted.spm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(SemiPar)
data(fossil)
attach(fossil)
fit &lt;- spm(strontium.ratio~f(age))
plot(fossil,type="n")
lines(fit)
points(fossil)

# Now do several customisations

op &lt;- par(bg="white")
par(bg="honeydew")
plot(fossil,type="n")
lines(fit,col="green",lwd=5,shade.col="mediumpurple1")   
points(fossil,col="orange",pch=16)
par(op)

</code></pre>

<hr>
<h2 id='milan.mort'>Milan mortality data</h2><span id='topic+milan.mort'></span>

<h3>Description</h3>

<p>The <code>milan.mort</code> data frame has data on 3652 consecutive
days (10 consecutive years: 1st January, 1980 to
30th December, 1989) for the city of Milan, Italy.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(milan.mort)</code></pre>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>day.num</dt><dd><p>number of days since 31st December, 1979</p>
</dd>
<dt>day.of.week</dt><dd><p>1=Monday,2=Tuesday,3=Wednesday,4=Thursday,
5=Friday,6=Saturday,7=Sunday.</p>
</dd>
<dt>holiday</dt><dd><p>indicator of public holiday: 1=public holiday, 0=otherwise.</p>
</dd>
<dt>mean.temp</dt><dd><p>mean daily temperature in degrees Celcius.</p>
</dd>
<dt>rel.humid</dt><dd><p>relative humidity.</p>
</dd>
<dt>tot.mort</dt><dd><p>total number of deaths.</p>
</dd>
<dt>resp.mort</dt><dd><p>total number of respiratory deaths.</p>
</dd>
<dt>SO2</dt><dd><p>measure of sulphur dioxide level in ambient air.</p>
</dd>
<dt>TSP</dt><dd><p>total suspended particles in ambient air.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Vigotti, M.A., Rossi, G., Bisanti, L., Zanobetti, A. and Schwartz, J.
(1996). Short term effect of urban air pollution on respiratory
health in Milan, Italy, 1980-1989. <em>Journal of Epidemiology
and Community Health</em>, <b>50</b>, S71-S75.
</p>


<h3>References</h3>

<p>Ruppert, D., Wand, M.P. and Carroll, R.J. (2003)<br />
<em>Semiparametric Regression</em> Cambridge University Press.<br />
<a href="http://stat.tamu.edu/~carroll/semiregbook/">http://stat.tamu.edu/~carroll/semiregbook/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(SemiPar)
data(milan.mort)
pairs(milan.mort,pch=".")
</code></pre>

<hr>
<h2 id='monitor.mercury'>Mercury biomonintoring data</h2><span id='topic+monitor.mercury'></span>

<h3>Description</h3>

<p>The <code>monitor.mercury</code> data frame has 22 observations 
from sampling locations around a solid waste 
incinerator in Warren County, New Jersey, USA</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(monitor.mercury)</code></pre>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>UTM.North</dt><dd><p>longitude of sampling location.</p>
</dd>
<dt>UTM.East</dt><dd><p>latitude of sampling location.</p>
</dd>
<dt>mercury.concentration</dt><dd><p>mercury concentration in dry sphagnum 
moss grown at the sampling location.</p>
</dd> 
</dl>



<h3>Source</h3>

<p>Opsomer, J.D., Agras, J., Carpi, A. and Rodrigues, G. (1995), 
An application of locally weighted regression to airborne mercury 
deposition around an incinerator site, <em>Environmetrics</em>, 
<b>6</b>, 205-221.
</p>


<h3>References</h3>

<p>Ruppert, D., Wand, M.P. and Carroll, R.J. (2003)<br />
<em>Semiparametric Regression</em> Cambridge University Press.<br />
<a href="http//stat.tamu.edu/~carroll/semiregbook/">http//stat.tamu.edu/~carroll/semiregbook/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(SemiPar)
data(monitor.mercury)
pairs(monitor.mercury)
</code></pre>

<hr>
<h2 id='onions'>Onions data</h2><span id='topic+onions'></span>

<h3>Description</h3>

<p>The <code>onions</code> data frame contains 84 sets of observations
from an experiment involving the production of white Spanish onions
in two South Australian locations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(onions)</code></pre>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>dens</dt><dd><p>areal density of plants (plants per square metre)</p>
</dd>
<dt>yield</dt><dd><p>onion yield (grammes per plant).</p>
</dd>
<dt>location</dt><dd><p>indicator of location: 0=Purnong Landing, 1=Virginia.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Ratkowsky, D. A. (1983).
<em>Nonlinear Regression Modeling: A Unified Practical Approach.</em>
New York: Marcel Dekker.
</p>


<h3>References</h3>

<p>Ruppert, D., Wand, M.P. and Carroll, R.J. (2003)<br />
<em>Semiparametric Regression</em> Cambridge University Press.<br />
<a href="http://stat.tamu.edu/~carroll/semiregbook/">http://stat.tamu.edu/~carroll/semiregbook/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(SemiPar)
data(onions)
attach(onions)
points.cols &lt;- c("red","blue")
plot(dens,yield,col=points.cols[location+1],pch=16)
legend(100,250,c("Purnong Landing","Virginia"),col=points.cols,pch=rep(16,2))
</code></pre>

<hr>
<h2 id='pig.weights'>Pig weight data</h2><span id='topic+pig.weights'></span>

<h3>Description</h3>

<p>The <code>pig.weights</code> data frame has 9 repeated 
weight measures on 48 pigs. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(pig.weights)</code></pre>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>id.num</dt><dd><p>identification number of pig.</p>
</dd>
<dt>num.weeks</dt><dd><p>number of weeks since measurements commenced.</p>
</dd>
<dt>weight</dt><dd><p>bodyweight of pig &quot;id.num&quot; after &quot;num.weeks&quot; weeks.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Diggle, P.J., Heagerty, P., Liang, K.-Y. and Zeger, S.L. (2002).
<em>Analysis of Longitudinal Data, Second Edition</em>, Oxord: Oxford
University Press.
</p>


<h3>References</h3>

<p>Ruppert, D., Wand, M.P. and Carroll, R.J. (2003)<br />
<em>Semiparametric Regression</em> Cambridge University Press.<br />
<a href="http://stat.tamu.edu/~carroll/semiregbook/">http://stat.tamu.edu/~carroll/semiregbook/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(SemiPar)
data(pig.weights)
library(lattice)
xyplot(weight~num.weeks,data=pig.weights,groups=id.num,type="b")
</code></pre>

<hr>
<h2 id='plot.spm'>Semiparametric regression plotting</h2><span id='topic+plot.spm'></span>

<h3>Description</h3>

<p>Takes a fitted <code>spm</code> object 
produced by <code>spm()</code> and plots the 
component smooth functions that make it up, on the 
scale of the linear predictor.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'spm'
plot(x,...)
</code></pre>


<h3>Arguments</h3>

 
<table>
<tr><td><code id="plot.spm_+3A_x">x</code></td>
<td>
<p>a fitted <code>spm</code> object as produced by <code>spm()</code>.</p>
</td></tr>
<tr><td><code id="plot.spm_+3A_...">...</code></td>
<td>
<p>other graphics parameters described in Appendix B of 
the SemiPar Users' Manual <a href="http://matt-wand.utsacademics.info/SPmanu.pdf">http://matt-wand.utsacademics.info/SPmanu.pdf</a></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Produces plots with each panel corresponding 
to a component of the semiparametric regression model.</p>


<h3>Value</h3>

<p>The function generates plots.</p>


<h3>Author(s)</h3>

<p>M.P. Wand 
<a href="mailto:mwand@uow.edu.au">mwand@uow.edu.au</a>
(other contributors listed in SemiPar Users' Manual).</p>


<h3>References</h3>

<p>Ruppert, D., Wand, M.P. and Carroll, R.J. (2003)<br />
<em>Semiparametric Regression</em> Cambridge University Press.<br />
<a href="http://stat.tamu.edu/~carroll/semiregbook/">http://stat.tamu.edu/~carroll/semiregbook/</a>
</p>
<p>Ganguli, B. and Wand, M.P. (2005)<br />
<em>SemiPar 1.0 Users' Manual</em>.<br />
<a href="http://matt-wand.utsacademics.info/SPmanu.pdf">http://matt-wand.utsacademics.info/SPmanu.pdf</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+spm">spm</a></code>
<code><a href="#topic+lines.spm">lines.spm</a></code>
<code><a href="#topic+predict.spm">predict.spm</a></code>
<code><a href="#topic+summary.spm">summary.spm</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>library(SemiPar)
data(fossil)
attach(fossil)
fit &lt;- spm(strontium.ratio~f(age))
plot(fit)

# Now do several customisations

op &lt;- par(bg="white")
par(bg="honeydew")
plot(fit,ylim=range(strontium.ratio),col="green",
     lwd=5,shade.col="mediumpurple1",rug.col="blue")   
points(age,strontium.ratio,col="orange",pch=16)
par(op)

</code></pre>

<hr>
<h2 id='predict.spm'>Semiparametric regression prediction.</h2><span id='topic+predict.spm'></span>

<h3>Description</h3>

<p>Takes a fitted <code>spm</code> object produced by 
<code>spm()</code> and obtains predictions at new data values.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'spm'
predict(object,newdata,se,...)
</code></pre>


<h3>Arguments</h3>

 
<table>
<tr><td><code id="predict.spm_+3A_object">object</code></td>
<td>
<p>a fitted <code>spm</code> object as produced by <code>spm()</code>.</p>
</td></tr>
<tr><td><code id="predict.spm_+3A_newdata">newdata</code></td>
<td>
<p>a data frame containing the values of the predictors at
which predictions are required. The columns should
have the same name as the predictors.</p>
</td></tr>
<tr><td><code id="predict.spm_+3A_se">se</code></td>
<td>
<p>when this is TRUE standard error estimates are
returned for each prediction. The default is FALSE.</p>
</td></tr>
<tr><td><code id="predict.spm_+3A_...">...</code></td>
<td>
<p>other arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Takes a fitted <code>spm</code> object produced by 
<code>spm()</code> and obtains predictions at new data values
as specified by the &lsquo;newdata&rsquo; argument. If &lsquo;se=TRUE&rsquo; then
standard error estimates are also obtained.</p>


<h3>Value</h3>

<p>If se=FALSE then a vector of predictions at &lsquo;newdata&rsquo; is returned.
If se=TRUE then a list with components named &lsquo;fit&rsquo; and &lsquo;se&rsquo; is
returned. The &lsquo;fit&rsquo; component contains the predictions. 
The &lsquo;se&rsquo; component contains standard error estimates.</p>


<h3>Author(s)</h3>

<p>M.P. Wand 
<a href="mailto:mwand@uow.edu.au">mwand@uow.edu.au</a>
(other contributors listed in SemiPar Users' Manual).</p>


<h3>References</h3>

<p>Ruppert, D., Wand, M.P. and Carroll, R.J. (2003)<br />
<em>Semiparametric Regression</em> Cambridge University Press.<br />
<a href="http://stat.tamu.edu/~carroll/semiregbook/">http://stat.tamu.edu/~carroll/semiregbook/</a>
</p>
<p>Ganguli, B. and Wand, M.P. (2005)<br />
<em>SemiPar 1.0 Users' Manual</em>.<br />
<a href="http://matt-wand.utsacademics.info/SPmanu.pdf">http://matt-wand.utsacademics.info/SPmanu.pdf</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+spm">spm</a></code>
<code><a href="#topic+lines.spm">lines.spm</a></code>
<code><a href="#topic+plot.spm">plot.spm</a></code>
<code><a href="#topic+summary.spm">summary.spm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(SemiPar)
data(fossil)
attach(fossil)
fit &lt;- spm(strontium.ratio~f(age))
newdata.age &lt;- data.frame(age=c(90,100,110,120,130))
preds &lt;-  predict(fit,newdata=newdata.age,se=TRUE)
print(preds)

plot(fit,xlim=c(90,130))
points(unlist(newdata.age),preds$fit,col="red")
points(unlist(newdata.age),preds$fit+2*preds$se,col="blue")
points(unlist(newdata.age),preds$fit-2*preds$se,col="green")
</code></pre>

<hr>
<h2 id='print.spm'>Prints semiparametric regression fit object.</h2><span id='topic+print.spm'></span>

<h3>Description</h3>

<p>Prints a brief description of a 
semiparametric regression fit object to the screen.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'spm'
print(x,...)
</code></pre>


<h3>Arguments</h3>

 
<table>
<tr><td><code id="print.spm_+3A_x">x</code></td>
<td>
<p>a fitted <code>spm</code> object as produced by <code>spm()</code>.</p>
</td></tr>
<tr><td><code id="print.spm_+3A_...">...</code></td>
<td>
<p>other possible arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Prints a brief description of a 
semiparametric regression fit object to the screen.</p>


<h3>Value</h3>

<p>The function prints to the screen.</p>


<h3>Author(s)</h3>

<p>M.P. Wand 
<a href="mailto:mwand@uow.edu.au">mwand@uow.edu.au</a>
(other contributors listed in SemiPar Users' Manual).</p>


<h3>References</h3>

<p>Ruppert, D., Wand, M.P. and Carroll, R.J. (2003)<br />
<em>Semiparametric Regression</em> Cambridge University Press.<br />
<a href="http://stat.tamu.edu/~carroll/semiregbook/">http://stat.tamu.edu/~carroll/semiregbook/</a>
</p>
<p>Ganguli, B. and Wand, M.P. (2005)<br />
<em>SemiPar 1.0 Users' Manual</em>.<br />
<a href="http://matt-wand.utsacademics.info/SPmanu.pdf">http://matt-wand.utsacademics.info/SPmanu.pdf</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+spm">spm</a></code>
<code><a href="#topic+plot.spm">plot.spm</a></code> 
<code><a href="#topic+lines.spm">lines.spm</a></code>
<code><a href="#topic+predict.spm">predict.spm</a></code>
<code><a href="#topic+summary.spm">summary.spm</a></code>
<code><a href="#topic+residuals.spm">residuals.spm</a></code>
<code><a href="#topic+fitted.spm">fitted.spm</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>library(SemiPar)
data(fossil)
attach(fossil)
fit &lt;- spm(strontium.ratio~f(age))
print(fit)
</code></pre>

<hr>
<h2 id='ragweed'>Ragweed data</h2><span id='topic+ragweed'></span>

<h3>Description</h3>

<p>The <code>ragweed</code> data frame has data on ragweed levels
and meteorological variables for 335 days in Kalamazoo,
Michigan, U.S.A.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ragweed)</code></pre>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>ragweed</dt><dd><p>ragweed level (grains per cubic metre).</p>
</dd>
<dt>year</dt><dd><p>one of 1991, 1992, 1993 or 1994.</p>
</dd>
<dt>day.in.seas</dt><dd><p>day number in the current ragweed pollen season.</p>
</dd>
<dt>temperature</dt><dd><p>temperature of following day (degrees Fahrenheit).</p>
</dd>
<dt>rain</dt><dd><p>indicator of significant rain the following day:
1=at least 3 hours of steady or brief but intense rain,
0=otherwise.</p>
</dd>
<dt>wind.speed</dt><dd><p>wind speed forecast for following day (knots).</p>
</dd>
</dl>



<h3>Source</h3>

<p>Stark, P. C., Ryan, L. M., McDonald, J. L. and Burge, H. A. (1997).
Using meteorologic data to model and predict daily ragweed pollen levels.
<em>Aerobiologia</em>, <b>13</b>, 177-184.
</p>


<h3>References</h3>

<p>Ruppert, D., Wand, M.P. and Carroll, R.J. (2003)<br />
<em>Semiparametric Regression</em> Cambridge University Press.<br />
<a href="http://stat.tamu.edu/~carroll/semiregbook/">http://stat.tamu.edu/~carroll/semiregbook/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(SemiPar)
data(ragweed)
pairs(ragweed,pch=".")
</code></pre>

<hr>
<h2 id='residuals.spm'>Residuals for semiparametric regression.</h2><span id='topic+residuals.spm'></span>

<h3>Description</h3>

<p>Extracts residuals from a semiparametric regression fit object.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'spm'
residuals(object,...)
</code></pre>


<h3>Arguments</h3>

 
<table>
<tr><td><code id="residuals.spm_+3A_object">object</code></td>
<td>
<p>a fitted <code>spm</code> object as produced by <code>spm()</code>.</p>
</td></tr>
<tr><td><code id="residuals.spm_+3A_...">...</code></td>
<td>
<p>other possible arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Extracts residuals from a semiparametric regression fit object.
The residuals are defined to be the difference between the response
variable and the fitted values.</p>


<h3>Value</h3>

<p>The vector of residuals.</p>


<h3>Author(s)</h3>

<p>M.P. Wand 
<a href="mailto:mwand@uow.edu.au">mwand@uow.edu.au</a>
(other contributors listed in SemiPar Users' Manual).</p>


<h3>References</h3>

<p>Ruppert, D., Wand, M.P. and Carroll, R.J. (2003)<br />
<em>Semiparametric Regression</em> Cambridge University Press.<br />
<a href="http://stat.tamu.edu/~carroll/semiregbook/">http://stat.tamu.edu/~carroll/semiregbook/</a>
</p>
<p>Ganguli, B. and Wand, M.P. (2005)<br />
<em>SemiPar 1.0 Users' Manual</em>.<br />
<a href="http://matt-wand.utsacademics.info/SPmanu.pdf">http://matt-wand.utsacademics.info/SPmanu.pdf</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+spm">spm</a></code>
<code><a href="#topic+plot.spm">plot.spm</a></code> 
<code><a href="#topic+lines.spm">lines.spm</a></code>
<code><a href="#topic+predict.spm">predict.spm</a></code>
<code><a href="#topic+summary.spm">summary.spm</a></code>
<code><a href="#topic+fitted.spm">fitted.spm</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>library(SemiPar)
data(fossil)
attach(fossil)
fit &lt;- spm(strontium.ratio~f(age))
plot(age,residuals(fit))
abline(0,0)
</code></pre>

<hr>
<h2 id='retire.plan'>Retirement plan data</h2><span id='topic+retire.plan'></span>

<h3>Description</h3>

<p>The <code>retire.plan</code> data frame has data on &quot;401(k)&quot; retirement
plans for employees of 
92 firms managed by a company code-named Best Retirement Inc. (BRI).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(retire.plan)</code></pre>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>contrib</dt><dd><p>contribution to retirement plan at end of first year</p>
</dd>
<dt>group</dt><dd><p>1=client has group life of group health insurance policy,
0=otherwise.</p>
</dd>
<dt>turnover</dt><dd><p>employee turnover rate.</p>
</dd>
<dt>eligible</dt><dd><p>number of employees eligible to 
participate in 401(k) plans.</p>
</dd>
<dt>vest</dt><dd><p>1=plan has immediate vesting of employer contributions,
0=otherwise.</p>
</dd>
<dt>failsafe</dt><dd><p>1=plan has a fail-safe provision, 0=otherwise.</p>
</dd>
<dt>match</dt><dd><p>percentage of contributions matched by the employer.</p>
</dd>
<dt>salary</dt><dd><p>average annual employee salary in dollars</p>
</dd></dl>
<p>.
</p>
<dl>
<dt>estimate</dt><dd><p>underwriter's estimate of
end-of-year contributions in dollars.</p>
</dd>
<dt>susan</dt><dd><p>1=plan was sold by a sales representative 
who has been specifically trained to deal 
exclusively with 401(k) plans (code-named
Susan Shepard).</p>
</dd>
</dl>



<h3>Source</h3>

<p>Bryant, P.G. and Smith, M.A. (1995).
<em>Practical data analysis: case studies in business statistics.</em>
Chicago: Irwin.
</p>


<h3>References</h3>

<p>Ruppert, D., Wand, M.P. and Carroll, R.J. (2003)<br />
<em>Semiparametric Regression</em> Cambridge University Press.<br />
<a href="http://stat.tamu.edu/~carroll/semiregbook/">http://stat.tamu.edu/~carroll/semiregbook/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(SemiPar)
data(retire.plan)
pairs(retire.plan)
</code></pre>

<hr>
<h2 id='salinity'>Salinity data</h2><span id='topic+salinity'></span>

<h3>Description</h3>

<p>The <code>salinity</code> data frame has 28 observations
on hydrological measurements from Pamlico Sound,
North Carolina, USA.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(salinity)</code></pre>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>salinity</dt><dd><p>salinity in Pamlico Sound.</p>
</dd>
<dt>lagged.salinity</dt><dd><p>salinity in Pamlico Sound during the previous
six weeks.</p>
</dd>
<dt>trend</dt><dd><p>trend=1 if the data is the first six-week period of the
spring, and so forth.  Used to detect possible effects of the seasonal
warming trend.</p>
</dd>
<dt>discharge</dt><dd><p>discharge of fresh water from rivers into the sound.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Ruppert, D, and Carroll, R.J. (1980), Trimmed least squares estimation in
the linear model, <em>Journal of the American Statistical Association</em>,
<b>75</b>,  828-838.
</p>


<h3>References</h3>

<p>Ruppert, D., Wand, M.P. and Carroll, R.J. (2003)<br />
<em>Semiparametric Regression</em> Cambridge University Press.<br />
<a href="http//stat.tamu.edu/~carroll/semiregbook/">http//stat.tamu.edu/~carroll/semiregbook/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(SemiPar)
data(salinity)
pairs(salinity)
</code></pre>

<hr>
<h2 id='sausage'>Sausage data</h2><span id='topic+sausage'></span>

<h3>Description</h3>

<p>The <code>sausage</code> data frame has data on 54 &lsquo;hot dog&rsquo;
sausages.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(sausage)</code></pre>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>type</dt><dd><p>type of meat.</p>
</dd>
<dt>calories</dt><dd><p>number of calories.</p>
</dd>
<dt>sodium</dt><dd><p>measure of sodium content.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Moore, D.S. and McCabe, G.P. (2003).
<em>Introduction to the Practice of Statistics, Fourth
Edition</em>, W.H. Freeman and Company.
</p>


<h3>References</h3>

<p>Ruppert, D., Wand, M.P. and Carroll, R.J. (2003)<br />
<em>Semiparametric Regression</em> Cambridge University Press.<br />
<a href="http://stat.tamu.edu/~carroll/semiregbook/">http://stat.tamu.edu/~carroll/semiregbook/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(SemiPar)
data(sausage)
attach(sausage)
points.cols &lt;- c("red","blue","green")
plot(sodium,calories,col=points.cols[type],pch=16)
legend(200,180,c("beef","pork","poultry"),col=points.cols,pch=rep(16,3))
</code></pre>

<hr>
<h2 id='scallop'>Scallop abundance data</h2><span id='topic+scallop'></span>

<h3>Description</h3>

<p>The <code>scallop</code> data frame has 148 triplets
concerning scallop abundance; based
on a 1990 survey cruise in the Atlantic continental
shelf off Long Island, New York, U.S.A.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(scallop)</code></pre>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>latitude</dt><dd><p>degrees latitude (north of the Equator).</p>
</dd>
<dt>longitude</dt><dd><p>degrees longitude (west of Greenwich).</p>
</dd>
<dt>tot.catch</dt><dd><p>size of scallop catch at location specified
by &quot;latitude&quot; and &quot;longitude&quot;.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Ecker, M.D. and Heltshe, J.F. (1994).
Geostatistical estimates of scallop abundance.
In <em>Case Studies in Biometry.</em> 
Lange, N., Ryan, L., Billard, L., Brillinger, D.,
Conquest, L. and Greenhouse, J. (eds.)
New York: John Wiley &amp; Sons, 107-124.
</p>


<h3>References</h3>

<p>Ruppert, D., Wand, M.P. and Carroll, R.J. (2003)<br />
<em>Semiparametric Regression</em> Cambridge University Press.<br />
<a href="http://stat.tamu.edu/~carroll/semiregbook/">http://stat.tamu.edu/~carroll/semiregbook/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(SemiPar)
data(scallop)
pairs(scallop)
</code></pre>

<hr>
<h2 id='SemiPar-internal'>Internal SemiPar Objects</h2><span id='topic+add.model.flag'></span><span id='topic+arg.search'></span><span id='topic+blend.col'></span><span id='topic+break.string'></span><span id='topic+compute.CTRinvC'></span><span id='topic+default.bdry'></span><span id='topic+default.knots'></span><span id='topic+default.knots.2D'></span><span id='topic+df.to.spar'></span><span id='topic+dinv.link'></span><span id='topic+dup'></span><span id='topic+dup.matrix'></span><span id='topic+gen.corr.range'></span><span id='topic+get.pixel.info'></span><span id='topic+glm.df.to.spar'></span><span id='topic+glmeAux'></span><span id='topic+imageFull'></span><span id='topic+imageLegend'></span><span id='topic+inv.link'></span><span id='topic+irls.ridge'></span><span id='topic+link'></span><span id='topic+lmeAux'></span><span id='topic+lmeFitQr'></span><span id='topic+matrix.sqrt'></span><span id='topic+pixel.frame'></span><span id='topic+plotControl'></span><span id='topic+pointsInPoly'></span><span id='topic+random.read'></span><span id='topic+ridge.reg'></span><span id='topic+rm.char'></span><span id='topic+set.plot.dflts'></span><span id='topic+spmArgRead'></span><span id='topic+spmDesign'></span><span id='topic+spmFormRead'></span><span id='topic+spmKrigeRead'></span><span id='topic+spmPenRead'></span><span id='topic+spmTermType'></span><span id='topic+tps.cov'></span>

<h3>Description</h3>

<p>Internal SemiPar functions.</p>


<h3>Details</h3>

<p>These are not to be called by the user.</p>

<hr>
<h2 id='sitka'>Sitka spruce data</h2><span id='topic+sitka'></span>

<h3>Description</h3>

<p>The <code>sitka</code> data frame contains measurements
of log-size for 79 Sitka spruce trees grown in normal
or ozone-enriched environments. Within each year, the
data are organised in four blocks, corresponding to
four controlled environment chambers. The first
two chambers, containing 27 trees each, have
an ozone-enriched atmosphere, the remaining two,
containing 12 and 13 trees respectively, have a normal
(control) atmosphere.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(sitka)</code></pre>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>id.num</dt><dd><p>identification number of tree.</p>
</dd>
<dt>order</dt><dd><p>time order ranking within each tree.</p>
</dd>
<dt>days</dt><dd><p>time in days since 1st January, 1988.</p>
</dd>
<dt>log.size</dt><dd><p>tree size measured on a logarithmic scale.</p>
</dd>
<dt>ozone</dt><dd><p>indicator ozone treatment: 0=control,1=ozone.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Diggle, P.J., Heagerty, P., Liang, K.-Y. and Zeger, S.L. (2002).
<em>Analysis of Longitudinal Data, Second Edition</em>, Oxord: Oxford
University Press.
</p>


<h3>References</h3>

<p>Ruppert, D., Wand, M.P. and Carroll, R.J. (2003)<br />
<em>Semiparametric Regression</em> Cambridge University Press.<br />
<a href="http://stat.tamu.edu/~carroll/semiregbook/">http://stat.tamu.edu/~carroll/semiregbook/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(SemiPar)
data(sitka)
attach(sitka)
library(lattice)
ozone.char &lt;- rep("control",nrow(sitka))
ozone.char[ozone==1] &lt;- "ozone"
xyplot(log.size~days|ozone.char,data=sitka,groups=id.num,type="b")
</code></pre>

<hr>
<h2 id='spm'>Fit a SemiParametric regression Model</h2><span id='topic+spm'></span>

<h3>Description</h3>

<p><code>spm</code> is used to fit semiparametric
regression models using the mixed model
representation of penalized splines
(per Ruppert, Wand and Carroll, 2003).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spm(form,random=NULL,group=NULL,family="gaussian",
                spar.method="REML",omit.missing=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="spm_+3A_form">form</code></td>
<td>
<p>a formula describing the model to be fit. 
Note, that an intercept is always included, whether 
given in the formula or not.</p>
</td></tr>
<tr><td><code id="spm_+3A_random">random</code></td>
<td>
<p>&quot;random=~1&quot; specifies inclusion of a random intercept
according to the groups specified by the &quot;group&quot; argument.</p>
</td></tr>
<tr><td><code id="spm_+3A_group">group</code></td>
<td>
<p>a vector of labels for specifying groups.</p>
</td></tr>
<tr><td><code id="spm_+3A_family">family</code></td>
<td>
<p>for specification of the type of likelihood
model assumed in the fitting.
May be &quot;gaussian&quot;,&quot;binomial&quot; or &quot;poisson&quot;</p>
</td></tr>
<tr><td><code id="spm_+3A_spar.method">spar.method</code></td>
<td>
<p>method for automatic smoothing parameter
selection. May be &quot;REML&quot; (restricted maximum
likelihood) or &quot;ML&quot; (maximum likelihood).</p>
</td></tr>
<tr><td><code id="spm_+3A_omit.missing">omit.missing</code></td>
<td>
<p>a logical value indicating whether
fields with missing values are to be
omitted.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See the SemiPar Users' Manual for details
and examples.
</p>


<h3>Value</h3>

<p>An list object of class <code>"spm"</code> containing the fitted model.
The components are:
</p>
<table>
<tr><td><code>fit</code></td>
<td>
<p>mimics fit object of lme() for
family=&quot;gaussian&quot; and glmmPQL() for family=&quot;binomial&quot; or
family=&quot;poisson&quot;.</p>
</td></tr>
<tr><td><code>info</code></td>
<td>
<p>information about the inputs.</p>
</td></tr>
<tr><td><code>aux</code></td>
<td>
<p>auxiliary information such as variability
estimates.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>M.P. Wand 
<a href="mailto:mwand@uow.edu.au">mwand@uow.edu.au</a>
(other contributors listed in SemiPar Users' Manual).
</p>


<h3>References</h3>

<p>Ruppert, D., Wand, M.P. and Carroll, R.J. (2003)<br />
<em>Semiparametric Regression</em> Cambridge University Press.<br />
<a href="http://stat.tamu.edu/~carroll/semiregbook/">http://stat.tamu.edu/~carroll/semiregbook/</a>
</p>
<p>Ganguli, B. and Wand, M.P. (2005)<br />
<em>SemiPar 1.0 Users' Manual</em>.<br />
<a href="http://matt-wand.utsacademics.info/SPmanu.pdf">http://matt-wand.utsacademics.info/SPmanu.pdf</a>
</p>


<h3>See Also</h3>

<p><code>gam</code> (in package &lsquo;mgcv&rsquo;)
<code><a href="nlme.html#topic+lme">lme</a></code> (in package &lsquo;nlme&rsquo;)
<code><a href="MASS.html#topic+glmmPQL">glmmPQL</a></code> (in package &lsquo;MASS&rsquo;)
<code><a href="#topic+plot.spm">plot.spm</a></code>
<code><a href="#topic+summary.spm">summary.spm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(SemiPar)
data(fossil)
attach(fossil)
fit &lt;- spm(strontium.ratio~f(age))
plot(fit)
summary(fit)

data(calif.air.poll)
attach(calif.air.poll)
fit &lt;- spm(ozone.level ~ f(daggett.pressure.gradient)+
                         f(inversion.base.height) +
                         f(inversion.base.temp))
summary(fit)
par(mfrow=c(2,2))
plot(fit)

# The SemiPar User Manual contains several other examples
# and details of plotting parameters.
#
# The current version of the manual is posted on the web-site:
#
#     http://matt-wand.utsacademics.info/SPmanu.pdf
</code></pre>

<hr>
<h2 id='summary.spm'>Semiparametric regression summary</h2><span id='topic+summary.spm'></span>

<h3>Description</h3>

<p>Takes a fitted <code>spm</code> object produced by 
<code>spm()</code> and summarises the fit.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'spm'
summary(object,...)
</code></pre>


<h3>Arguments</h3>

 
<table>
<tr><td><code id="summary.spm_+3A_object">object</code></td>
<td>
<p>a fitted <code>spm</code> object as produced by <code>spm()</code>.</p>
</td></tr>
<tr><td><code id="summary.spm_+3A_...">...</code></td>
<td>
<p>other arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Produces tables for the linear (parametric)
and non-linear (nonparametric) components. The linear
table provides coefficient estimates, standard errors
and p-values. The non-linear table provides degrees of
freedom values and other information.</p>


<h3>Value</h3>

<p>The function generates summary tables.</p>


<h3>Author(s)</h3>

<p>M.P. Wand 
<a href="mailto:mwand@uow.edu.au">mwand@uow.edu.au</a>
(other contributors listed in SemiPar Users' Manual).</p>


<h3>References</h3>

<p>Ruppert, D., Wand, M.P. and Carroll, R.J. (2003)<br />
<em>Semiparametric Regression</em> Cambridge University Press.<br />
<a href="http://stat.tamu.edu/~carroll/semiregbook/">http://stat.tamu.edu/~carroll/semiregbook/</a>
</p>
<p>Ganguli, B. and Wand, M.P. (2005)<br />
<em>SemiPar 1.0 Users' Manual</em>.<br />
<a href="http://matt-wand.utsacademics.info/SPmanu.pdf">http://matt-wand.utsacademics.info/SPmanu.pdf</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+spm">spm</a></code>
<code><a href="#topic+plot.spm">plot.spm</a></code>
<code><a href="#topic+predict.spm">predict.spm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(SemiPar)
data(onions)
attach(onions)
log.yield &lt;- log(yield)
fit &lt;- spm(log.yield~location+f(dens))
summary(fit)
</code></pre>

<hr>
<h2 id='term.structure'>Term structure data</h2><span id='topic+term.structure'></span>

<h3>Description</h3>

<p>The <code>term.structure</code> data frame has 117 
observations on the prices of U.S. STRIPS 
(Separate Trading on Registered Interest and 
Principal of Securities) on December 31, 1995.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(term.structure)</code></pre>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>time.to.maturity</dt><dd><p>time in years between 31st December, 1995, 
and the date on which the STRIPS matures.</p>
</dd>
<dt>price</dt><dd><p>price of the STRIPS as a percent of par.</p>
</dd>
</dl>



<h3>Source</h3>

<p>University of Houston Fixed Income Database.
</p>


<h3>References</h3>

<p>Jarrow, R., Ruppert, D., and Yu, Y. (2004).
Estimating the term structure of corporate debt 
with a semiparametric penalized spline model, 
<em>Journal of the American Statistical Association</em>,
<b>99</b>, 57-66. 
</p>
<p>Ruppert, D., Wand, M.P. and Carroll, R.J. (2003)<br />
<em>Semiparametric Regression</em> Cambridge University Press.<br />
<a href="http//stat.tamu.edu/~carroll/semiregbook/">http//stat.tamu.edu/~carroll/semiregbook/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(SemiPar)
data(term.structure)
attach(term.structure)
plot(time.to.maturity,price)
</code></pre>

<hr>
<h2 id='trade.union'>Trade union data</h2><span id='topic+trade.union'></span>

<h3>Description</h3>

<p>The <code>trade.union</code> data frame has data on 534 U.S. workers.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(trade.union)</code></pre>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>years.educ</dt><dd><p>number of years of education.</p>
</dd>
<dt>south</dt><dd><p>indicator of living in southern region of U.S.A.</p>
</dd>
<dt>female</dt><dd><p>gender indicator: 0=male,1=female.</p>
</dd>
<dt>years.experience</dt><dd><p>number of years of work experience</p>
</dd>
<dt>union.member</dt><dd><p>indicator of trade union membership: 
0=non-member, 1=member.</p>
</dd>
<dt>wage</dt><dd><p>wages in dollars per hour.</p>
</dd>
<dt>age</dt><dd><p>age in years.</p>
</dd>
<dt>race</dt><dd><p>1=black, 2=Hispanic, 3=white.</p>
</dd>
<dt>occupation</dt><dd><p>1=management, 2=sales, 3=clerical, 4=service, 5=professional, 6=other.</p>
</dd>
<dt>sector</dt><dd><p>0=other, 1=manufacturing, 2=construction.</p>
</dd>
<dt>married</dt><dd><p>indicator of being married: 0=unmarried, 1=married.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Berndt, E.R. (1991)
<em>The Practice of Econometrics.</em> New York: Addison-Wesley. 
</p>


<h3>References</h3>

<p>Ruppert, D., Wand, M.P. and Carroll, R.J. (2003)<br />
<em>Semiparametric Regression</em> Cambridge University Press.<br />
<a href="http://stat.tamu.edu/~carroll/semiregbook/">http://stat.tamu.edu/~carroll/semiregbook/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(SemiPar)
data(trade.union)
pairs(trade.union,pch=".")
</code></pre>

<hr>
<h2 id='ustemp'>U.S. temperature data</h2><span id='topic+ustemp'></span>

<h3>Description</h3>

<p>The <code>ustemp</code> data frame has 56 observations on the temperature
and location of 56 U.S. cities.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ustemp)</code></pre>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>city</dt><dd><p>character string giving name of city and state 
(two-letter abbreviation).</p>
</dd>
<dt>min.temp</dt><dd><p>average minimum January temperature.</p>
</dd>
<dt>latitude</dt><dd><p>degrees latitude (north of Equator).</p>
</dd>
<dt>longitude</dt><dd><p>degrees longitude (west of Greenwich).</p>
</dd>
</dl>



<h3>Source</h3>

<p>Peixoto, J.L. (1990). A property of well-formulated polynomial
regression models. <em>American Statistician</em>, <b>44</b>,
26-30.
</p>


<h3>References</h3>

<p>Ruppert, D., Wand, M.P. and Carroll, R.J. (2003)<br />
<em>Semiparametric Regression</em> Cambridge University Press.<br />
<a href="http://stat.tamu.edu/~carroll/semiregbook/">http://stat.tamu.edu/~carroll/semiregbook/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(SemiPar)
data(ustemp)
attach(ustemp)
grey.levs &lt;- min.temp+20
col.vec &lt;- paste("grey",as.character(grey.levs),sep="")
plot(-longitude,latitude,col=col.vec,pch=16,cex=3,xlim=c(-130,-60))
text(-longitude,latitude,as.character(city))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
