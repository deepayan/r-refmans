<!DOCTYPE html><html lang="en"><head><title>Help for package secret</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {secret}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#secret-package'><p>Share Sensitive Information in R Packages.</p></a></li>
<li><a href='#add_github_user'><p>Add a user via their GitHub username.</p></a></li>
<li><a href='#add_secret'><p>Add a new secret to the vault.</p></a></li>
<li><a href='#add_travis_user'><p>Add a user via their Travis repo.</p></a></li>
<li><a href='#add_user'><p>Add a new user to the vault.</p></a></li>
<li><a href='#create_package_vault'><p>Create a vault, as a folder or in an R package.</p></a></li>
<li><a href='#delete_secret'><p>Remove a secret from the vault.</p></a></li>
<li><a href='#delete_user'><p>Delete a user.</p></a></li>
<li><a href='#get_github_key'><p>Get the SSH public key of a GitHub user</p></a></li>
<li><a href='#get_secret'><p>Retrieve a secret from the vault.</p></a></li>
<li><a href='#get_travis_key'><p>Retrieve the public key of a Travis CI repository</p></a></li>
<li><a href='#get_user_file'><p>Get the file of a user (email)</p></a></li>
<li><a href='#list_owners'><p>List users that have access to a secret</p></a></li>
<li><a href='#list_secrets'><p>List all secrets.</p></a></li>
<li><a href='#list_users'><p>List users</p></a></li>
<li><a href='#local_key'><p>Read local secret key.</p></a></li>
<li><a href='#share_secret'><p>Share a secret among some users.</p></a></li>
<li><a href='#share_secret_with_key'><p>Share a secret, its AES key is known already.</p></a></li>
<li><a href='#share_secret_with_key1'><p>Share a secret with a single user, AES key is known.</p></a></li>
<li><a href='#store_secret_with_key'><p>Store a secret, encrypted with its AES key.</p></a></li>
<li><a href='#try_get_aes_key'><p>Try to get the AES key of a secret, using a private RSA key.</p></a></li>
<li><a href='#unshare_secret'><p>Unshare a secret among some users.</p></a></li>
<li><a href='#update_secret'><p>Update a secret in the vault.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Share Sensitive Information in R Packages</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Allow sharing sensitive information, for example passwords,
    'API' keys, etc., in R packages, using public key cryptography.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/gaborcsardi/secret#readme">https://github.com/gaborcsardi/secret#readme</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/gaborcsardi/secret/issues">https://github.com/gaborcsardi/secret/issues</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.0</td>
</tr>
<tr>
<td>Imports:</td>
<td>assertthat, openssl, rprojroot, curl, jsonlite</td>
</tr>
<tr>
<td>Suggests:</td>
<td>covr, mockery, testthat, knitr, rmarkdown, withr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-05-06 23:08:31 UTC; gaborcsardi</td>
</tr>
<tr>
<td>Author:</td>
<td>Gábor Csárdi [aut, cre],
  Andrie de Vries [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Gábor Csárdi &lt;csardi.gabor@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-05-07 13:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='secret-package'>Share Sensitive Information in R Packages.</h2><span id='topic+secret-package'></span><span id='topic+secret'></span>

<h3>Description</h3>

<p>Allow sharing sensitive information, for example passwords, API keys,
or other information in R packages, using public key cryptography.
</p>


<h3>Details</h3>

<p>A vault is a directory, typically inside an R package, that
stores a number of secrets. Each secret is shared among a group of
users. Users are identified using their public keys.
</p>
<p>The package implements the following operations:
</p>

<ul>
<li><p> Vault:
</p>

<ul>
<li><p> Creating a vault folder: <code><a href="#topic+create_vault">create_vault()</a></code>
</p>
</li>
<li><p> Creating a package vault: <code><a href="#topic+create_package_vault">create_package_vault()</a></code>
</p>
</li></ul>

</li>
<li><p> User management:
</p>

<ul>
<li><p> Adding a user: <code><a href="#topic+add_user">add_user()</a></code>, <code><a href="#topic+add_github_user">add_github_user()</a></code>.
</p>
</li>
<li><p> Deleting a user: <code><a href="#topic+delete_user">delete_user()</a></code>.
</p>
</li>
<li><p> Listing users: <code><a href="#topic+list_users">list_users()</a></code>.
</p>
</li></ul>

</li>
<li><p> Keys:
</p>

<ul>
<li><p> Reading local private key: <code><a href="#topic+local_key">local_key()</a></code>
</p>
</li></ul>

</li>
<li><p> Secrets:
</p>

<ul>
<li><p> Adding a secret: <code><a href="#topic+add_secret">add_secret()</a></code>.
</p>
</li>
<li><p> Retrieving a secret: <code><a href="#topic+get_secret">get_secret()</a></code>.
</p>
</li>
<li><p> Updating a secret: <code><a href="#topic+update_secret">update_secret()</a></code>.
</p>
</li>
<li><p> Deleting a secret: <code><a href="#topic+delete_secret">delete_secret()</a></code>.
</p>
</li>
<li><p> List secrets: <code><a href="#topic+list_secrets">list_secrets()</a></code>.
</p>
</li>
<li><p> Sharing a secret: <code><a href="#topic+share_secret">share_secret()</a></code>. Query or set the set of
users that have access to a secret.
</p>
</li>
<li><p> Unsharing a secret: <code><a href="#topic+unshare_secret">unshare_secret()</a></code>
</p>
</li></ul>

</li></ul>



<h3>Author(s)</h3>

<p>Gábor Csárdi and Andrie de Vries
</p>

<hr>
<h2 id='add_github_user'>Add a user via their GitHub username.</h2><span id='topic+add_github_user'></span>

<h3>Description</h3>

<p>On GitHub, a user can upload multiple keys. This function will download
the first key by default, but you can change this
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_github_user(github_user, email = NULL, vault = NULL, i = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="add_github_user_+3A_github_user">github_user</code></td>
<td>
<p>User name on GitHub.</p>
</td></tr>
<tr><td><code id="add_github_user_+3A_email">email</code></td>
<td>
<p>Email address of the github user. If NULL, constructs an
email as <code style="white-space: pre;">&#8288;github-&lt;&lt;github_user&gt;&gt;&#8288;</code></p>
</td></tr>
<tr><td><code id="add_github_user_+3A_vault">vault</code></td>
<td>
<p>Vault location (starting point to find the vault).
To create a vault, use <code><a href="#topic+create_vault">create_vault()</a></code> or <code><a href="#topic+create_package_vault">create_package_vault()</a></code>.
If this is <code>NULL</code>, then <code>secret</code> tries to find the vault automatically:
</p>

<ul>
<li><p> If the <code>secret.vault</code> option is set to path, that is used as the
starting point.
</p>
</li>
<li><p> Otherwise, if the <code>R_SECRET_VAULT</code> environment variable is set to a
path, that is used as a starting point.
</p>
</li>
<li><p> Otherwise the current working directory is used as the starting
point.
</p>
</li></ul>

<p>If the starting point is a vault, that is used. Otherwise, if the
starting point is in a package tree, the <code>inst/vault</code> folder is used
within the package. If no vault can be found, an error is thrown.</p>
</td></tr>
<tr><td><code id="add_github_user_+3A_i">i</code></td>
<td>
<p>Integer, indicating which GitHub key to use (if more than one
GitHub key exists).</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+add_travis_user">add_travis_user()</a></code>
</p>
<p>Other user functions: 
<code><a href="#topic+add_travis_user">add_travis_user</a>()</code>,
<code><a href="#topic+add_user">add_user</a>()</code>,
<code><a href="#topic+delete_user">delete_user</a>()</code>,
<code><a href="#topic+list_users">list_users</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
vault &lt;- file.path(tempdir(), ".vault")
create_vault(vault)

add_github_user("hadley", vault = vault)
list_users(vault = vault)
delete_user("github-hadley", vault = vault)

## End(Not run)
</code></pre>

<hr>
<h2 id='add_secret'>Add a new secret to the vault.</h2><span id='topic+add_secret'></span>

<h3>Description</h3>

<p>By default, the newly added secret is not shared with other
users. See the users argument if you want to change this.
You can also use <code><a href="#topic+share_secret">share_secret()</a></code> later, to specify the users that
have access to the secret.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_secret(name, value, users, vault = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="add_secret_+3A_name">name</code></td>
<td>
<p>Name of the secret, a string that can contain alphanumeric
characters, underscores, dashes and dots.</p>
</td></tr>
<tr><td><code id="add_secret_+3A_value">value</code></td>
<td>
<p>Value of the secret, an arbitrary R object that
will be serialized using <code><a href="base.html#topic+serialize">base::serialize()</a></code>.</p>
</td></tr>
<tr><td><code id="add_secret_+3A_users">users</code></td>
<td>
<p>Email addresses of users that will have access to the
secret. (See <code><a href="#topic+add_user">add_user()</a></code>)</p>
</td></tr>
<tr><td><code id="add_secret_+3A_vault">vault</code></td>
<td>
<p>Vault location (starting point to find the vault).
To create a vault, use <code><a href="#topic+create_vault">create_vault()</a></code> or <code><a href="#topic+create_package_vault">create_package_vault()</a></code>.
If this is <code>NULL</code>, then <code>secret</code> tries to find the vault automatically:
</p>

<ul>
<li><p> If the <code>secret.vault</code> option is set to path, that is used as the
starting point.
</p>
</li>
<li><p> Otherwise, if the <code>R_SECRET_VAULT</code> environment variable is set to a
path, that is used as a starting point.
</p>
</li>
<li><p> Otherwise the current working directory is used as the starting
point.
</p>
</li></ul>

<p>If the starting point is a vault, that is used. Otherwise, if the
starting point is in a package tree, the <code>inst/vault</code> folder is used
within the package. If no vault can be found, an error is thrown.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other secret functions: 
<code><a href="#topic+delete_secret">delete_secret</a>()</code>,
<code><a href="#topic+get_secret">get_secret</a>()</code>,
<code><a href="#topic+list_owners">list_owners</a>()</code>,
<code><a href="#topic+list_secrets">list_secrets</a>()</code>,
<code><a href="#topic+local_key">local_key</a>()</code>,
<code><a href="#topic+share_secret">share_secret</a>()</code>,
<code><a href="#topic+unshare_secret">unshare_secret</a>()</code>,
<code><a href="#topic+update_secret">update_secret</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
# The `secret` package contains some user keys for demonstration purposes.
# In this example, Alice shares a secret with Bob using a vault.

keys &lt;- function(x){
  file.path(system.file("user_keys", package = "secret"), x)
}
alice_public  &lt;- keys("alice.pub")
alice_private &lt;- keys("alice.pem")
bob_public  &lt;- keys("bob.pub")
bob_private &lt;- keys("bob.pem")
carl_private &lt;- keys("carl.pem")

# Create vault

vault &lt;- file.path(tempdir(), ".vault")
if (dir.exists(vault)) unlink(vault) # ensure vault is empty
create_vault(vault)

# Add users with their public keys

add_user("alice", public_key = alice_public, vault = vault)
add_user("bob", public_key = bob_public, vault = vault)
list_users(vault = vault)

# Share a secret

secret &lt;- list(username = "user123", password = "Secret123!")

add_secret("secret", value = secret, users = c("alice", "bob"),
           vault = vault)
list_secrets(vault = vault)

# Alice and Bob can decrypt the secret with their private keys
# Note that you would not normally have access to the private key
# of any of your collaborators!

get_secret("secret", key = alice_private, vault = vault)
get_secret("secret", key = bob_private, vault = vault)

# But Carl can't decrypt the secret

try(
  get_secret("secret", key = carl_private, vault = vault)
)

# Unshare the secret

unshare_secret("secret", users = "bob", vault = vault)
try(
  get_secret("secret", key = bob_private, vault = vault)
)


# Delete the secret

delete_secret("secret", vault = vault)
list_secrets(vault)

# Delete the users

delete_user("alice", vault = vault)
delete_user("bob", vault = vault)
list_users(vault)


## End(Not run)
</code></pre>

<hr>
<h2 id='add_travis_user'>Add a user via their Travis repo.</h2><span id='topic+add_travis_user'></span>

<h3>Description</h3>

<p>On Travis, every repo has a private/public key pair. This function adds a
user and downloads the public key from Travis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_travis_user(travis_repo, email, vault = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="add_travis_user_+3A_travis_repo">travis_repo</code></td>
<td>
<p>Name of Travis repository, usually in a format
<code style="white-space: pre;">&#8288;&lt;&lt;username&gt;&gt;/&lt;&lt;repo&gt;&gt;&#8288;</code></p>
</td></tr>
<tr><td><code id="add_travis_user_+3A_email">email</code></td>
<td>
<p>Email address of the user. This is used to identify
users.</p>
</td></tr>
<tr><td><code id="add_travis_user_+3A_vault">vault</code></td>
<td>
<p>Vault location (starting point to find the vault).
To create a vault, use <code><a href="#topic+create_vault">create_vault()</a></code> or <code><a href="#topic+create_package_vault">create_package_vault()</a></code>.
If this is <code>NULL</code>, then <code>secret</code> tries to find the vault automatically:
</p>

<ul>
<li><p> If the <code>secret.vault</code> option is set to path, that is used as the
starting point.
</p>
</li>
<li><p> Otherwise, if the <code>R_SECRET_VAULT</code> environment variable is set to a
path, that is used as a starting point.
</p>
</li>
<li><p> Otherwise the current working directory is used as the starting
point.
</p>
</li></ul>

<p>If the starting point is a vault, that is used. Otherwise, if the
starting point is in a package tree, the <code>inst/vault</code> folder is used
within the package. If no vault can be found, an error is thrown.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other user functions: 
<code><a href="#topic+add_github_user">add_github_user</a>()</code>,
<code><a href="#topic+add_user">add_user</a>()</code>,
<code><a href="#topic+delete_user">delete_user</a>()</code>,
<code><a href="#topic+list_users">list_users</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
vault &lt;- file.path(tempdir(), ".vault")
create_vault(vault)

add_travis_user("gaborcsardi/secret", vault = vault)
list_users(vault = vault)
delete_user("travis-gaborcsardi-secret", vault = vault)

## End(Not run)
</code></pre>

<hr>
<h2 id='add_user'>Add a new user to the vault.</h2><span id='topic+add_user'></span>

<h3>Description</h3>

<p>By default the new user does not have access to any secrets.
See <code><a href="#topic+add_secret">add_secret()</a></code> or <code><a href="#topic+share_secret">share_secret()</a></code> to give them access.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_user(email, public_key, vault = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="add_user_+3A_email">email</code></td>
<td>
<p>Email address of the user. This is used to identify
users.</p>
</td></tr>
<tr><td><code id="add_user_+3A_public_key">public_key</code></td>
<td>
<p>Public key of the user. This is used to encrypt
the secrets for the different users. It can be
</p>

<ul>
<li><p> a string containing a PEM,
</p>
</li>
<li><p> a file name that points to a PEM file,
</p>
</li>
<li><p> a <code>pubkey</code> object created via the <code>openssl</code> package.
</p>
</li></ul>
</td></tr>
<tr><td><code id="add_user_+3A_vault">vault</code></td>
<td>
<p>Vault location (starting point to find the vault).
To create a vault, use <code><a href="#topic+create_vault">create_vault()</a></code> or <code><a href="#topic+create_package_vault">create_package_vault()</a></code>.
If this is <code>NULL</code>, then <code>secret</code> tries to find the vault automatically:
</p>

<ul>
<li><p> If the <code>secret.vault</code> option is set to path, that is used as the
starting point.
</p>
</li>
<li><p> Otherwise, if the <code>R_SECRET_VAULT</code> environment variable is set to a
path, that is used as a starting point.
</p>
</li>
<li><p> Otherwise the current working directory is used as the starting
point.
</p>
</li></ul>

<p>If the starting point is a vault, that is used. Otherwise, if the
starting point is in a package tree, the <code>inst/vault</code> folder is used
within the package. If no vault can be found, an error is thrown.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other user functions: 
<code><a href="#topic+add_github_user">add_github_user</a>()</code>,
<code><a href="#topic+add_travis_user">add_travis_user</a>()</code>,
<code><a href="#topic+delete_user">delete_user</a>()</code>,
<code><a href="#topic+list_users">list_users</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
# The `secret` package contains some user keys for demonstration purposes.
# In this example, Alice shares a secret with Bob using a vault.

keys &lt;- function(x){
  file.path(system.file("user_keys", package = "secret"), x)
}
alice_public  &lt;- keys("alice.pub")
alice_private &lt;- keys("alice.pem")
bob_public  &lt;- keys("bob.pub")
bob_private &lt;- keys("bob.pem")
carl_private &lt;- keys("carl.pem")

# Create vault

vault &lt;- file.path(tempdir(), ".vault")
if (dir.exists(vault)) unlink(vault) # ensure vault is empty
create_vault(vault)

# Add users with their public keys

add_user("alice", public_key = alice_public, vault = vault)
add_user("bob", public_key = bob_public, vault = vault)
list_users(vault = vault)

# Share a secret

secret &lt;- list(username = "user123", password = "Secret123!")

add_secret("secret", value = secret, users = c("alice", "bob"),
           vault = vault)
list_secrets(vault = vault)

# Alice and Bob can decrypt the secret with their private keys
# Note that you would not normally have access to the private key
# of any of your collaborators!

get_secret("secret", key = alice_private, vault = vault)
get_secret("secret", key = bob_private, vault = vault)

# But Carl can't decrypt the secret

try(
  get_secret("secret", key = carl_private, vault = vault)
)

# Unshare the secret

unshare_secret("secret", users = "bob", vault = vault)
try(
  get_secret("secret", key = bob_private, vault = vault)
)


# Delete the secret

delete_secret("secret", vault = vault)
list_secrets(vault)

# Delete the users

delete_user("alice", vault = vault)
delete_user("bob", vault = vault)
list_users(vault)


## End(Not run)
</code></pre>

<hr>
<h2 id='create_package_vault'>Create a vault, as a folder or in an R package.</h2><span id='topic+create_package_vault'></span><span id='topic+create_vault'></span>

<h3>Description</h3>

<p>A vault is a folder that contains information about users and the secrets
they share. You can create a vault as either a standalone folder, or
as part of a package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_package_vault(path = ".")

create_vault(path)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="create_package_vault_+3A_path">path</code></td>
<td>
<p>Path to the R package. A file or directory within the
package is fine, too. If the vault directory already exists, a message
is given, and the function does nothing.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A vault is a folder with a specific structure, containing two
directories: <code>users</code> and <code>secrets</code>.
</p>
<p>In <code>users</code>, each file contains a public key in PEM format. The name of
the file is the identifier of the key, an arbitrary name. We suggest
that you use email addresses to identify public keys. See also <code><a href="#topic+add_user">add_user()</a></code>.
</p>
<p>In <code>secrets</code>, each secret is stored in its own directory.
The directory of a secret contains
</p>

<ol>
<li><p> the secret, encrypted with its own AES key, and
</p>
</li>
<li><p> the AES key, encrypted with the public keys of all users that
have access to the secret, each in its own file.
</p>
</li></ol>

<p>To add a secret, see <code><a href="#topic+add_secret">add_secret()</a></code>
</p>


<h3>Value</h3>

<p>The directory of the vault, invisibly.
</p>


<h3>Creating a package folder</h3>

<p>When you create a vault in a package, this vault is stored in the
<code>inst/vault</code> directory of the package during development. At package
install time, this folder is copied to the <code>vault</code> folder.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+add_user">add_user()</a></code>, <code><a href="#topic+add_secret">add_secret()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
# The `secret` package contains some user keys for demonstration purposes.
# In this example, Alice shares a secret with Bob using a vault.

keys &lt;- function(x){
  file.path(system.file("user_keys", package = "secret"), x)
}
alice_public  &lt;- keys("alice.pub")
alice_private &lt;- keys("alice.pem")
bob_public  &lt;- keys("bob.pub")
bob_private &lt;- keys("bob.pem")
carl_private &lt;- keys("carl.pem")

# Create vault

vault &lt;- file.path(tempdir(), ".vault")
if (dir.exists(vault)) unlink(vault) # ensure vault is empty
create_vault(vault)

# Add users with their public keys

add_user("alice", public_key = alice_public, vault = vault)
add_user("bob", public_key = bob_public, vault = vault)
list_users(vault = vault)

# Share a secret

secret &lt;- list(username = "user123", password = "Secret123!")

add_secret("secret", value = secret, users = c("alice", "bob"),
           vault = vault)
list_secrets(vault = vault)

# Alice and Bob can decrypt the secret with their private keys
# Note that you would not normally have access to the private key
# of any of your collaborators!

get_secret("secret", key = alice_private, vault = vault)
get_secret("secret", key = bob_private, vault = vault)

# But Carl can't decrypt the secret

try(
  get_secret("secret", key = carl_private, vault = vault)
)

# Unshare the secret

unshare_secret("secret", users = "bob", vault = vault)
try(
  get_secret("secret", key = bob_private, vault = vault)
)


# Delete the secret

delete_secret("secret", vault = vault)
list_secrets(vault)

# Delete the users

delete_user("alice", vault = vault)
delete_user("bob", vault = vault)
list_users(vault)


## End(Not run)
</code></pre>

<hr>
<h2 id='delete_secret'>Remove a secret from the vault.</h2><span id='topic+delete_secret'></span>

<h3>Description</h3>

<p>Remove a secret from the vault.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>delete_secret(name, vault = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="delete_secret_+3A_name">name</code></td>
<td>
<p>Name of the secret to delete.</p>
</td></tr>
<tr><td><code id="delete_secret_+3A_vault">vault</code></td>
<td>
<p>Vault location (starting point to find the vault).
To create a vault, use <code><a href="#topic+create_vault">create_vault()</a></code> or <code><a href="#topic+create_package_vault">create_package_vault()</a></code>.
If this is <code>NULL</code>, then <code>secret</code> tries to find the vault automatically:
</p>

<ul>
<li><p> If the <code>secret.vault</code> option is set to path, that is used as the
starting point.
</p>
</li>
<li><p> Otherwise, if the <code>R_SECRET_VAULT</code> environment variable is set to a
path, that is used as a starting point.
</p>
</li>
<li><p> Otherwise the current working directory is used as the starting
point.
</p>
</li></ul>

<p>If the starting point is a vault, that is used. Otherwise, if the
starting point is in a package tree, the <code>inst/vault</code> folder is used
within the package. If no vault can be found, an error is thrown.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other secret functions: 
<code><a href="#topic+add_secret">add_secret</a>()</code>,
<code><a href="#topic+get_secret">get_secret</a>()</code>,
<code><a href="#topic+list_owners">list_owners</a>()</code>,
<code><a href="#topic+list_secrets">list_secrets</a>()</code>,
<code><a href="#topic+local_key">local_key</a>()</code>,
<code><a href="#topic+share_secret">share_secret</a>()</code>,
<code><a href="#topic+unshare_secret">unshare_secret</a>()</code>,
<code><a href="#topic+update_secret">update_secret</a>()</code>
</p>

<hr>
<h2 id='delete_user'>Delete a user.</h2><span id='topic+delete_user'></span>

<h3>Description</h3>

<p>It also removes access of the user to all secrets, so if the user
is re-added again, they will not have access to any secrets.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>delete_user(email, vault = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="delete_user_+3A_email">email</code></td>
<td>
<p>Email address of the user.</p>
</td></tr>
<tr><td><code id="delete_user_+3A_vault">vault</code></td>
<td>
<p>Vault location (starting point to find the vault).
To create a vault, use <code><a href="#topic+create_vault">create_vault()</a></code> or <code><a href="#topic+create_package_vault">create_package_vault()</a></code>.
If this is <code>NULL</code>, then <code>secret</code> tries to find the vault automatically:
</p>

<ul>
<li><p> If the <code>secret.vault</code> option is set to path, that is used as the
starting point.
</p>
</li>
<li><p> Otherwise, if the <code>R_SECRET_VAULT</code> environment variable is set to a
path, that is used as a starting point.
</p>
</li>
<li><p> Otherwise the current working directory is used as the starting
point.
</p>
</li></ul>

<p>If the starting point is a vault, that is used. Otherwise, if the
starting point is in a package tree, the <code>inst/vault</code> folder is used
within the package. If no vault can be found, an error is thrown.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other user functions: 
<code><a href="#topic+add_github_user">add_github_user</a>()</code>,
<code><a href="#topic+add_travis_user">add_travis_user</a>()</code>,
<code><a href="#topic+add_user">add_user</a>()</code>,
<code><a href="#topic+list_users">list_users</a>()</code>
</p>

<hr>
<h2 id='get_github_key'>Get the SSH public key of a GitHub user</h2><span id='topic+get_github_key'></span>

<h3>Description</h3>

<p>Get the SSH public key of a GitHub user
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_github_key(github_user, i = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_github_key_+3A_github_user">github_user</code></td>
<td>
<p>GitHub username.</p>
</td></tr>
<tr><td><code id="get_github_key_+3A_i">i</code></td>
<td>
<p>Which key to get, in case the user has multiple keys.
<code>get_github_key()</code> retrieves the first key by default.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Character scalar.
</p>

<hr>
<h2 id='get_secret'>Retrieve a secret from the vault.</h2><span id='topic+get_secret'></span>

<h3>Description</h3>

<p>Retrieve a secret from the vault.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_secret(name, key = local_key(), vault = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_secret_+3A_name">name</code></td>
<td>
<p>Name of the secret.</p>
</td></tr>
<tr><td><code id="get_secret_+3A_key">key</code></td>
<td>
<p>The private RSA key to use. It defaults to the current
user's default key.</p>
</td></tr>
<tr><td><code id="get_secret_+3A_vault">vault</code></td>
<td>
<p>Vault location (starting point to find the vault).
To create a vault, use <code><a href="#topic+create_vault">create_vault()</a></code> or <code><a href="#topic+create_package_vault">create_package_vault()</a></code>.
If this is <code>NULL</code>, then <code>secret</code> tries to find the vault automatically:
</p>

<ul>
<li><p> If the <code>secret.vault</code> option is set to path, that is used as the
starting point.
</p>
</li>
<li><p> Otherwise, if the <code>R_SECRET_VAULT</code> environment variable is set to a
path, that is used as a starting point.
</p>
</li>
<li><p> Otherwise the current working directory is used as the starting
point.
</p>
</li></ul>

<p>If the starting point is a vault, that is used. Otherwise, if the
starting point is in a package tree, the <code>inst/vault</code> folder is used
within the package. If no vault can be found, an error is thrown.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other secret functions: 
<code><a href="#topic+add_secret">add_secret</a>()</code>,
<code><a href="#topic+delete_secret">delete_secret</a>()</code>,
<code><a href="#topic+list_owners">list_owners</a>()</code>,
<code><a href="#topic+list_secrets">list_secrets</a>()</code>,
<code><a href="#topic+local_key">local_key</a>()</code>,
<code><a href="#topic+share_secret">share_secret</a>()</code>,
<code><a href="#topic+unshare_secret">unshare_secret</a>()</code>,
<code><a href="#topic+update_secret">update_secret</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
# The `secret` package contains some user keys for demonstration purposes.
# In this example, Alice shares a secret with Bob using a vault.

keys &lt;- function(x){
  file.path(system.file("user_keys", package = "secret"), x)
}
alice_public  &lt;- keys("alice.pub")
alice_private &lt;- keys("alice.pem")
bob_public  &lt;- keys("bob.pub")
bob_private &lt;- keys("bob.pem")
carl_private &lt;- keys("carl.pem")

# Create vault

vault &lt;- file.path(tempdir(), ".vault")
if (dir.exists(vault)) unlink(vault) # ensure vault is empty
create_vault(vault)

# Add users with their public keys

add_user("alice", public_key = alice_public, vault = vault)
add_user("bob", public_key = bob_public, vault = vault)
list_users(vault = vault)

# Share a secret

secret &lt;- list(username = "user123", password = "Secret123!")

add_secret("secret", value = secret, users = c("alice", "bob"),
           vault = vault)
list_secrets(vault = vault)

# Alice and Bob can decrypt the secret with their private keys
# Note that you would not normally have access to the private key
# of any of your collaborators!

get_secret("secret", key = alice_private, vault = vault)
get_secret("secret", key = bob_private, vault = vault)

# But Carl can't decrypt the secret

try(
  get_secret("secret", key = carl_private, vault = vault)
)

# Unshare the secret

unshare_secret("secret", users = "bob", vault = vault)
try(
  get_secret("secret", key = bob_private, vault = vault)
)


# Delete the secret

delete_secret("secret", vault = vault)
list_secrets(vault)

# Delete the users

delete_user("alice", vault = vault)
delete_user("bob", vault = vault)
list_users(vault)


## End(Not run)
</code></pre>

<hr>
<h2 id='get_travis_key'>Retrieve the public key of a Travis CI repository</h2><span id='topic+get_travis_key'></span>

<h3>Description</h3>

<p>Retrieve the public key of a Travis CI repository
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_travis_key(travis_repo)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_travis_key_+3A_travis_repo">travis_repo</code></td>
<td>
<p>The repository slug, e.g. <code>gaborcsardi/secret</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Character scalar, the key. If the repository does not exist,
or it is not user in Travis CI, an HTTP 404 error is thrown.
</p>

<hr>
<h2 id='get_user_file'>Get the file of a user (email)</h2><span id='topic+get_user_file'></span>

<h3>Description</h3>

<p>We assume that <code>vault</code> is a proper vault directory, and <code>email</code> is a
valid email address.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_user_file(vault, email)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_user_file_+3A_vault">vault</code></td>
<td>
<p>Vault directory.</p>
</td></tr>
<tr><td><code id="get_user_file_+3A_email">email</code></td>
<td>
<p>Email address (or user name, in general).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The path to the user's public key. (It might not exist yet.)
</p>

<hr>
<h2 id='list_owners'>List users that have access to a secret</h2><span id='topic+list_owners'></span>

<h3>Description</h3>

<p>List users that have access to a secret
</p>


<h3>Usage</h3>

<pre><code class='language-R'>list_owners(name, vault = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="list_owners_+3A_name">name</code></td>
<td>
<p>Name of the secret, a string that can contain alphanumeric
characters, underscores, dashes and dots.</p>
</td></tr>
<tr><td><code id="list_owners_+3A_vault">vault</code></td>
<td>
<p>Vault location (starting point to find the vault).
To create a vault, use <code><a href="#topic+create_vault">create_vault()</a></code> or <code><a href="#topic+create_package_vault">create_package_vault()</a></code>.
If this is <code>NULL</code>, then <code>secret</code> tries to find the vault automatically:
</p>

<ul>
<li><p> If the <code>secret.vault</code> option is set to path, that is used as the
starting point.
</p>
</li>
<li><p> Otherwise, if the <code>R_SECRET_VAULT</code> environment variable is set to a
path, that is used as a starting point.
</p>
</li>
<li><p> Otherwise the current working directory is used as the starting
point.
</p>
</li></ul>

<p>If the starting point is a vault, that is used. Otherwise, if the
starting point is in a package tree, the <code>inst/vault</code> folder is used
within the package. If no vault can be found, an error is thrown.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other secret functions: 
<code><a href="#topic+add_secret">add_secret</a>()</code>,
<code><a href="#topic+delete_secret">delete_secret</a>()</code>,
<code><a href="#topic+get_secret">get_secret</a>()</code>,
<code><a href="#topic+list_secrets">list_secrets</a>()</code>,
<code><a href="#topic+local_key">local_key</a>()</code>,
<code><a href="#topic+share_secret">share_secret</a>()</code>,
<code><a href="#topic+unshare_secret">unshare_secret</a>()</code>,
<code><a href="#topic+update_secret">update_secret</a>()</code>
</p>

<hr>
<h2 id='list_secrets'>List all secrets.</h2><span id='topic+list_secrets'></span>

<h3>Description</h3>

<p>Returns a data frame with secrets and emails that these are shared with.
The emails are in a list-column, each element of the <code>email</code> column is
a character vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>list_secrets(vault = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="list_secrets_+3A_vault">vault</code></td>
<td>
<p>Vault location (starting point to find the vault).
To create a vault, use <code><a href="#topic+create_vault">create_vault()</a></code> or <code><a href="#topic+create_package_vault">create_package_vault()</a></code>.
If this is <code>NULL</code>, then <code>secret</code> tries to find the vault automatically:
</p>

<ul>
<li><p> If the <code>secret.vault</code> option is set to path, that is used as the
starting point.
</p>
</li>
<li><p> Otherwise, if the <code>R_SECRET_VAULT</code> environment variable is set to a
path, that is used as a starting point.
</p>
</li>
<li><p> Otherwise the current working directory is used as the starting
point.
</p>
</li></ul>

<p>If the starting point is a vault, that is used. Otherwise, if the
starting point is in a package tree, the <code>inst/vault</code> folder is used
within the package. If no vault can be found, an error is thrown.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data.frame
</p>


<h3>See Also</h3>

<p>Other secret functions: 
<code><a href="#topic+add_secret">add_secret</a>()</code>,
<code><a href="#topic+delete_secret">delete_secret</a>()</code>,
<code><a href="#topic+get_secret">get_secret</a>()</code>,
<code><a href="#topic+list_owners">list_owners</a>()</code>,
<code><a href="#topic+local_key">local_key</a>()</code>,
<code><a href="#topic+share_secret">share_secret</a>()</code>,
<code><a href="#topic+unshare_secret">unshare_secret</a>()</code>,
<code><a href="#topic+update_secret">update_secret</a>()</code>
</p>

<hr>
<h2 id='list_users'>List users</h2><span id='topic+list_users'></span>

<h3>Description</h3>

<p>List users
</p>


<h3>Usage</h3>

<pre><code class='language-R'>list_users(vault = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="list_users_+3A_vault">vault</code></td>
<td>
<p>Vault location (starting point to find the vault).
To create a vault, use <code><a href="#topic+create_vault">create_vault()</a></code> or <code><a href="#topic+create_package_vault">create_package_vault()</a></code>.
If this is <code>NULL</code>, then <code>secret</code> tries to find the vault automatically:
</p>

<ul>
<li><p> If the <code>secret.vault</code> option is set to path, that is used as the
starting point.
</p>
</li>
<li><p> Otherwise, if the <code>R_SECRET_VAULT</code> environment variable is set to a
path, that is used as a starting point.
</p>
</li>
<li><p> Otherwise the current working directory is used as the starting
point.
</p>
</li></ul>

<p>If the starting point is a vault, that is used. Otherwise, if the
starting point is in a package tree, the <code>inst/vault</code> folder is used
within the package. If no vault can be found, an error is thrown.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other user functions: 
<code><a href="#topic+add_github_user">add_github_user</a>()</code>,
<code><a href="#topic+add_travis_user">add_travis_user</a>()</code>,
<code><a href="#topic+add_user">add_user</a>()</code>,
<code><a href="#topic+delete_user">delete_user</a>()</code>
</p>

<hr>
<h2 id='local_key'>Read local secret key.</h2><span id='topic+local_key'></span>

<h3>Description</h3>

<p>Reads a local secret key from disk. The location of this file can be
specified in the <code>USER_KEY</code> environment variable.
If this environment variable does not exist, then attempts to read the
key from:
</p>

<ul>
<li> <p><code style="white-space: pre;">&#8288;~/.ssh/id_rsa&#8288;</code>, and
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;~/.ssh/id_rsa.pem&#8288;</code>.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>local_key()
</code></pre>


<h3>Details</h3>

<p>The location of the key is defined by:</p>
<pre>Sys.getenv("USER_KEY")
</pre>
<p>To use a local in a different location, set an environment variable:</p>
<pre>Sys.setenv(USER_KEY = "path/to/private/key")
</pre>


<h3>See Also</h3>

<p>Other secret functions: 
<code><a href="#topic+add_secret">add_secret</a>()</code>,
<code><a href="#topic+delete_secret">delete_secret</a>()</code>,
<code><a href="#topic+get_secret">get_secret</a>()</code>,
<code><a href="#topic+list_owners">list_owners</a>()</code>,
<code><a href="#topic+list_secrets">list_secrets</a>()</code>,
<code><a href="#topic+share_secret">share_secret</a>()</code>,
<code><a href="#topic+unshare_secret">unshare_secret</a>()</code>,
<code><a href="#topic+update_secret">update_secret</a>()</code>
</p>

<hr>
<h2 id='share_secret'>Share a secret among some users.</h2><span id='topic+share_secret'></span>

<h3>Description</h3>

<p>Use this function to extend the set of users that have access to a
secret. The calling user must have access to the secret as well.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>share_secret(name, users, key = local_key(), vault = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="share_secret_+3A_name">name</code></td>
<td>
<p>Name of the secret, a string that can contain alphanumeric
characters, underscores, dashes and dots.</p>
</td></tr>
<tr><td><code id="share_secret_+3A_users">users</code></td>
<td>
<p>addresses of users that will have access to the secret.
(See <code><a href="#topic+add_user">add_user()</a></code>).</p>
</td></tr>
<tr><td><code id="share_secret_+3A_key">key</code></td>
<td>
<p>Private key that has access to the secret. (I.e. its
corresponding public key is among the vault users.)</p>
</td></tr>
<tr><td><code id="share_secret_+3A_vault">vault</code></td>
<td>
<p>Vault location (starting point to find the vault).
To create a vault, use <code><a href="#topic+create_vault">create_vault()</a></code> or <code><a href="#topic+create_package_vault">create_package_vault()</a></code>.
If this is <code>NULL</code>, then <code>secret</code> tries to find the vault automatically:
</p>

<ul>
<li><p> If the <code>secret.vault</code> option is set to path, that is used as the
starting point.
</p>
</li>
<li><p> Otherwise, if the <code>R_SECRET_VAULT</code> environment variable is set to a
path, that is used as a starting point.
</p>
</li>
<li><p> Otherwise the current working directory is used as the starting
point.
</p>
</li></ul>

<p>If the starting point is a vault, that is used. Otherwise, if the
starting point is in a package tree, the <code>inst/vault</code> folder is used
within the package. If no vault can be found, an error is thrown.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+unshare_secret">unshare_secret()</a></code>, <code><a href="#topic+list_owners">list_owners()</a></code> to list users that have
access to a secret.
</p>
<p>Other secret functions: 
<code><a href="#topic+add_secret">add_secret</a>()</code>,
<code><a href="#topic+delete_secret">delete_secret</a>()</code>,
<code><a href="#topic+get_secret">get_secret</a>()</code>,
<code><a href="#topic+list_owners">list_owners</a>()</code>,
<code><a href="#topic+list_secrets">list_secrets</a>()</code>,
<code><a href="#topic+local_key">local_key</a>()</code>,
<code><a href="#topic+unshare_secret">unshare_secret</a>()</code>,
<code><a href="#topic+update_secret">update_secret</a>()</code>
</p>

<hr>
<h2 id='share_secret_with_key'>Share a secret, its AES key is known already.</h2><span id='topic+share_secret_with_key'></span>

<h3>Description</h3>

<p>Share a secret, its AES key is known already.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>share_secret_with_key(name, users, aeskey, vault)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="share_secret_with_key_+3A_name">name</code></td>
<td>
<p>Name of the secret.</p>
</td></tr>
<tr><td><code id="share_secret_with_key_+3A_users">users</code></td>
<td>
<p>Email addresses of users.</p>
</td></tr>
<tr><td><code id="share_secret_with_key_+3A_aeskey">aeskey</code></td>
<td>
<p>AES key of the secret.</p>
</td></tr>
<tr><td><code id="share_secret_with_key_+3A_vault">vault</code></td>
<td>
<p>Vault directory.</p>
</td></tr>
</table>

<hr>
<h2 id='share_secret_with_key1'>Share a secret with a single user, AES key is known.</h2><span id='topic+share_secret_with_key1'></span>

<h3>Description</h3>

<p>Share a secret with a single user, AES key is known.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>share_secret_with_key1(name, email, aeskey, vault)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="share_secret_with_key1_+3A_name">name</code></td>
<td>
<p>Name of the secret.</p>
</td></tr>
<tr><td><code id="share_secret_with_key1_+3A_email">email</code></td>
<td>
<p>Email address of the user.</p>
</td></tr>
<tr><td><code id="share_secret_with_key1_+3A_aeskey">aeskey</code></td>
<td>
<p>The AES key of the secret.</p>
</td></tr>
<tr><td><code id="share_secret_with_key1_+3A_vault">vault</code></td>
<td>
<p>Vault directory.</p>
</td></tr>
</table>

<hr>
<h2 id='store_secret_with_key'>Store a secret, encrypted with its AES key.</h2><span id='topic+store_secret_with_key'></span>

<h3>Description</h3>

<p>Store a secret, encrypted with its AES key.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>store_secret_with_key(name, value, key, vault)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="store_secret_with_key_+3A_name">name</code></td>
<td>
<p>Name of secret.</p>
</td></tr>
<tr><td><code id="store_secret_with_key_+3A_value">value</code></td>
<td>
<p>Value of secret.</p>
</td></tr>
<tr><td><code id="store_secret_with_key_+3A_key">key</code></td>
<td>
<p>The AES key, an <code>aes</code> object from the <code>openssl</code> package.</p>
</td></tr>
<tr><td><code id="store_secret_with_key_+3A_vault">vault</code></td>
<td>
<p>Vault directory.</p>
</td></tr>
</table>

<hr>
<h2 id='try_get_aes_key'>Try to get the AES key of a secret, using a private RSA key.</h2><span id='topic+try_get_aes_key'></span>

<h3>Description</h3>

<p>We just try the private key against all encrypted copies of the
AES key. If none of the succeed, then we return <code>NULL</code>. Otherwise
we return the AES key, an <code>aes</code> object, from the <code>openssl</code> package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>try_get_aes_key(vault, name, key)
</code></pre>

<hr>
<h2 id='unshare_secret'>Unshare a secret among some users.</h2><span id='topic+unshare_secret'></span>

<h3>Description</h3>

<p>Use this function to restrict the set of users that have access to a
secret. Note that users may still have access to the secret, through
version control history, or if they have a copy of the project. They
will not have access to future values of the secret, though.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>unshare_secret(name, users, vault = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="unshare_secret_+3A_name">name</code></td>
<td>
<p>Name of the secret, a string that can contain alphanumeric
characters, underscores, dashes and dots.</p>
</td></tr>
<tr><td><code id="unshare_secret_+3A_users">users</code></td>
<td>
<p>Email addresses of users that will have access to the
secret. (See <code><a href="#topic+add_user">add_user()</a></code>)</p>
</td></tr>
<tr><td><code id="unshare_secret_+3A_vault">vault</code></td>
<td>
<p>Vault location (starting point to find the vault).
To create a vault, use <code><a href="#topic+create_vault">create_vault()</a></code> or <code><a href="#topic+create_package_vault">create_package_vault()</a></code>.
If this is <code>NULL</code>, then <code>secret</code> tries to find the vault automatically:
</p>

<ul>
<li><p> If the <code>secret.vault</code> option is set to path, that is used as the
starting point.
</p>
</li>
<li><p> Otherwise, if the <code>R_SECRET_VAULT</code> environment variable is set to a
path, that is used as a starting point.
</p>
</li>
<li><p> Otherwise the current working directory is used as the starting
point.
</p>
</li></ul>

<p>If the starting point is a vault, that is used. Otherwise, if the
starting point is in a package tree, the <code>inst/vault</code> folder is used
within the package. If no vault can be found, an error is thrown.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+share_secret">share_secret()</a></code>
</p>
<p>Other secret functions: 
<code><a href="#topic+add_secret">add_secret</a>()</code>,
<code><a href="#topic+delete_secret">delete_secret</a>()</code>,
<code><a href="#topic+get_secret">get_secret</a>()</code>,
<code><a href="#topic+list_owners">list_owners</a>()</code>,
<code><a href="#topic+list_secrets">list_secrets</a>()</code>,
<code><a href="#topic+local_key">local_key</a>()</code>,
<code><a href="#topic+share_secret">share_secret</a>()</code>,
<code><a href="#topic+update_secret">update_secret</a>()</code>
</p>

<hr>
<h2 id='update_secret'>Update a secret in the vault.</h2><span id='topic+update_secret'></span>

<h3>Description</h3>

<p>Update a secret in the vault.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>update_secret(name, value, key = local_key(), vault = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="update_secret_+3A_name">name</code></td>
<td>
<p>Name of the secret.</p>
</td></tr>
<tr><td><code id="update_secret_+3A_value">value</code></td>
<td>
<p>Value of the secret, an arbitrary R object that
will be serialized using <code><a href="base.html#topic+serialize">base::serialize()</a></code>.</p>
</td></tr>
<tr><td><code id="update_secret_+3A_key">key</code></td>
<td>
<p>The private RSA key to use. It defaults to the current
user's default key.</p>
</td></tr>
<tr><td><code id="update_secret_+3A_vault">vault</code></td>
<td>
<p>Vault location (starting point to find the vault).
To create a vault, use <code><a href="#topic+create_vault">create_vault()</a></code> or <code><a href="#topic+create_package_vault">create_package_vault()</a></code>.
If this is <code>NULL</code>, then <code>secret</code> tries to find the vault automatically:
</p>

<ul>
<li><p> If the <code>secret.vault</code> option is set to path, that is used as the
starting point.
</p>
</li>
<li><p> Otherwise, if the <code>R_SECRET_VAULT</code> environment variable is set to a
path, that is used as a starting point.
</p>
</li>
<li><p> Otherwise the current working directory is used as the starting
point.
</p>
</li></ul>

<p>If the starting point is a vault, that is used. Otherwise, if the
starting point is in a package tree, the <code>inst/vault</code> folder is used
within the package. If no vault can be found, an error is thrown.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other secret functions: 
<code><a href="#topic+add_secret">add_secret</a>()</code>,
<code><a href="#topic+delete_secret">delete_secret</a>()</code>,
<code><a href="#topic+get_secret">get_secret</a>()</code>,
<code><a href="#topic+list_owners">list_owners</a>()</code>,
<code><a href="#topic+list_secrets">list_secrets</a>()</code>,
<code><a href="#topic+local_key">local_key</a>()</code>,
<code><a href="#topic+share_secret">share_secret</a>()</code>,
<code><a href="#topic+unshare_secret">unshare_secret</a>()</code>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
