<!DOCTYPE html><html lang="en"><head><title>Help for package h0</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {h0}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#h0-package'><p>A Bayesian Meta-Analysis for Estimating the Hubble Constant via Time Delay Cosmography</p></a></li>
<li><a href='#h0'><p>Obtaining Bayesian posterior sample of the Hubble constant via the proposed meta-analysis</p></a></li>
<li><a href='#h0-internal'><p>Internal <code>h0</code> functions</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Version:</td>
<td>1.0.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-8-24</td>
</tr>
<tr>
<td>Title:</td>
<td>A Robust Bayesian Meta-Analysis for Estimating the Hubble
Constant via Time Delay Cosmography</td>
</tr>
<tr>
<td>Author:</td>
<td>Hyungsuk Tak</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Hyungsuk Tak &lt;hyungsuk.tak@gmail.com&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.2.0)</td>
</tr>
<tr>
<td>Description:</td>
<td>We provide a toolbox to conduct a Bayesian meta-analysis for estimating the current expansion rate of the Universe, called the Hubble constant H0, via time delay cosmography. The input data are Fermat potential difference and time delay estimates. For a robust inference, we assume a Student's t error for these inputs. Given these inputs, the meta-analysis produces posterior samples of the model parameters including the Hubble constant via Metropolis-Hastings within Gibbs. The package provides an option to implement repelling-attracting Metropolis-Hastings within Gibbs in a case where the parameter space has multiple modes.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-24 18:59:43 UTC; hyungsuktak</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-24 19:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='h0-package'>A Bayesian Meta-Analysis for Estimating the Hubble Constant via Time Delay Cosmography</h2><span id='topic+h0-package'></span>

<h3>Description</h3>

<p>The R package <span class="pkg">h0</span> provides a toolbox to conduct a Bayesian meta-analysis for estimating the current expansion rate of the Universe, called the Hubble constant H0, via time delay cosmography. The input data are (i) estimates of Fermat potential differences and their one-sigma uncertainties (standard errors), and (ii) estimates of time delays and their one-sigma uncertainties. Given these inputs, the meta-analysis draws a posterior sample of the model parameters including the Hubble constant.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> h0</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.0.1</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2023-8-24</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-2</td>
</tr>
<tr>
 <td style="text-align: left;">
Main functions: </td><td style="text-align: left;"> <code><a href="#topic+h0">h0</a></code></td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Hyungsuk Tak
</p>


<h3>References</h3>

<p>T. Treu and P. Marshall (2016) &lt;doi:10.1007/s00159-016-0096-8&gt; &quot;Time Delay Cosmography&quot;.
</p>

<hr>
<h2 id='h0'>Obtaining Bayesian posterior sample of the Hubble constant via the proposed meta-analysis</h2><span id='topic+h0'></span>

<h3>Description</h3>

<p>The function <code>h0</code> conducts a Bayesian meta-analysis to infer the current expansion rate of the University (Hubble constant). The analysis is constructed under time delay cosmography. The minimum inputs of the meta-analysis are (1) time delay estimates (<code>TD.est</code>); (2) their standard errors (<code>TD.se</code>); (3) Fermat potential difference estimates (<code>FPD.est</code>); (4) their standard errors (<code>FPD.se</code>); (5) redshifts of deflectors (lenses) (<code>z.d</code>); and (6) redshifts of sources (quasars) (<code>z.s</code>). We note that the length of each input vector must be identical, and the order of input values in each vector must be consistent across all of the vectors. For example, let's say the third input value in one of the input vectors, <code>TD.est</code>, is a time delay estimate between gravitationally lensed images A and C of a specific quasar. Then the third input value in the other input vectors must be a quantity corresponding to the gravitationally lensed images A and C of that specific quasar.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h0(TD.est, TD.se, 
   FPD.est, FPD.se, 
   z.d, z.s,
   multimodal = FALSE,
   h0.bound = c(0, 150),
   h0.scale = 10,
   omega.bound = c(0.05, 0.5),
   initial.param,
   sample.size, burnin.size)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="h0_+3A_td.est">TD.est</code></td>
<td>
<p>A vector for time delay estimates (in days). For example, if a data set contained three time delay estimates of a quad-lens system and one time delay estimate of a double-lens system, then this vector would be composed of the three time delay estimates from the quad and one time delay estimate from the double.</p>
</td></tr>
<tr><td><code id="h0_+3A_td.se">TD.se</code></td>
<td>
<p>A vector for standard errors (one-sigma uncertainties) of the time delay estimates. For example, if a data set contained three time delay estimates of a quad-lens system and one time delay estimate of a double-lens system, then this vector would be composed of the three standard errors corresponding to the first three time delay estimates from the quad and one standard error corresponding to the single time delay estimate from the double.</p>
</td></tr>
<tr><td><code id="h0_+3A_fpd.est">FPD.est</code></td>
<td>
<p>A vector for Fermat potential difference estimates. For example, if a data set contained three Fermat potential difference estimates of a quad-lens system and one Fermat potential difference estimate of a double-lens system, then this vector would be composed of the three Fermat potential difference estimates from the quad and one Fermat potential difference estimate from the double.</p>
</td></tr>
<tr><td><code id="h0_+3A_fpd.se">FPD.se</code></td>
<td>
<p>A vector for standard errors (one-sigma uncertainties) of the Fermat potential difference estimates. For example, if a data set contained three Fermat potential difference estimates of a quad-lens system and one Fermat potential difference estimate of a double-lens system, then this vector would be composed of the three standard errors corresponding to the first three Fermat potential difference estimates from the quad and one standard error corresponding to the single Fermat potential difference estimate from the double.</p>
</td></tr>
<tr><td><code id="h0_+3A_z.d">z.d</code></td>
<td>
<p>A vector for redshifts of deflectors (lenses). For example, if a data set contained three time delay estimates of a quad-lens system and one time delay estimate of a double-lens system, then users need to fill out the first three spots of this vector by the same redshift of the quad-lens, and fill out the last spot by the redshift of the double-lens.</p>
</td></tr>
<tr><td><code id="h0_+3A_z.s">z.s</code></td>
<td>
<p>A vector for redshifts of sources (quasars). For example, if a data set contained three time delay estimates of a quad-lens system and one time delay estimate of a double-lens system, then users need to fill out the first three spots of this vector by the same redshift of the quadruply lensed quasar, and fill out the last spot by the redshift of the doubly-lensed quasar.</p>
</td></tr>
<tr><td><code id="h0_+3A_multimodal">multimodal</code></td>
<td>
<p>If &quot;TRUE&quot;, the sampling method switches from Metropolis-Hastings within Gibbs to repelling-attracting Metropolis-Hastings within Gibbs to enhance the convergence of Markov chain to a multimodal target distribution. Default is &quot;FALSE&quot;.</p>
</td></tr>
<tr><td><code id="h0_+3A_h0.bound">h0.bound</code></td>
<td>
<p>It determins the Uniform prior range for the Hubble constant. Default is to search possible values of the Hubble constant between 0 and 150. Users can set a wider range, if needed.</p>
</td></tr>
<tr><td><code id="h0_+3A_h0.scale">h0.scale</code></td>
<td>
<p>It determins the proposal scale of the Metropolis update for the Hubble constant. Default is 10. Due to the adaptive Markov chain Monte Carlo method adopted in this package, this scale changes at every 100 iterations. If &quot;multimodal = FALSE&quot;, then the scale changes to achieve the acceptance rate equal to 0.4. If &quot;multimodal = TRUE&quot;, the scale is adapted to achieve the acceptance rate equal to 0.1.</p>
</td></tr>
<tr><td><code id="h0_+3A_omega.bound">omega.bound</code></td>
<td>
<p>It determins the prior range for the current dark matter density. Default is to search possible values of the current dark matter density between 0.05 and 0.5. Users can set a wider range, if needed.</p>
</td></tr>
<tr><td><code id="h0_+3A_initial.param">initial.param</code></td>
<td>
<p>A vector of (K+2) model parameters, that is, the Hubble constant, the dark matter density, and K external convergences, where K is the number of lens systems in the data set. A reasonable set of values is  c(runif(1, 0, 150), runif(1, 0.05, 0.5), rcaucy(K, scale = 0.025)).</p>
</td></tr>
<tr><td><code id="h0_+3A_sample.size">sample.size</code></td>
<td>
<p>It determines the posterior sample size for each of the model parameters, the Hubble constant, the dark matter density, and K external convergences.</p>
</td></tr>
<tr><td><code id="h0_+3A_burnin.size">burnin.size</code></td>
<td>
<p>It determines the warming-up posterior sample size to be discarded before obtaining the desired sample size. The total number of iterations is the sum of sample.size and burnin.size.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Time delay cosmography infers the Hubble constant <code class="reqn">H_0</code> by modeling time delays caused by strong gravitational lensing. The following equation is the basis of time delay cosmography:
</p>
<p style="text-align: center;"><code class="reqn">c\Delta_{ijk}=D_{\Delta}(H_0, z_k, \Omega) \phi_{ijk},</code>
</p>

<p>where <code class="reqn">c</code> denotes the speed of light, and <code class="reqn">\Delta_{ijk}</code> is the time delay in days between lensed images <code class="reqn">i</code> and <code class="reqn">j</code> of quasar <code class="reqn">k</code> (<code class="reqn">k=1, 2, \ldots, n</code>). The notation <code class="reqn">z_k=\{z_{sk}, z_{dk}\}</code> indicates a vector for two redshifts of the <code class="reqn">k</code>-th source (<code class="reqn">z_{sk}</code>) and deflector (<code class="reqn">z_{dk}</code>). The next notation <code class="reqn">\Omega=\{\Omega_{m}, \Omega_{\Lambda}\}</code> indicates a vector for the present-day dark matter density <code class="reqn">\Omega_{m}</code> and dark energy density <code class="reqn">\Omega_{\Lambda}</code>. Since their sum becomes one under the flat <code class="reqn">\Lambda</code>CDM model (standard cosmology),  we treat <code class="reqn">\Omega_{m}</code> as the only unknown parameter. The notation  <code class="reqn">D_{\Delta}(H_0, z_k, \Omega)</code> denotes the time delay distance in the unit of megaparsec (Mpc), which is a deterministic function of <code class="reqn">H_0</code>, <code class="reqn">z_k</code>, and <code class="reqn">\Omega</code>.
</p>
<p>In addition, the meta-analysis accounts for the impact of the mass structure in the line of sight between the observer and the lens via external convergences, <code class="reqn">\kappa_{ext, k}</code>, where <code class="reqn">k</code> is the lens index (<code class="reqn">k=1, 2, ..., K</code>). The Hubble constant after accounting for this impact is obtained by <code class="reqn">H_0^{ext}=(1-\kappa_{ext, k})H_0</code>, where <code class="reqn">H_0</code> is the Hubble constant without considering the external convergense.
</p>
<p>The meta analysis takes advantage of these physical relationships, and returns posterior samples of the model parameters, <code class="reqn">H_0</code> <code class="reqn">\Omega</code>, and <code class="reqn">\kappa_{ext, k}</code>'s.
</p>


<h3>Value</h3>

<p>The outcomes of <code>h0</code> are composed of:
</p>

<dl>
<dt>h0</dt><dd><p>A vector. The posterior sample of the Hubble constant.</p>
</dd>
<dt>omega</dt><dd><p>A vector. The posterior sample of the dark matter density.</p>
</dd>
<dt>kappa</dt><dd><p>A matrix. Each row contains one posterior sample of K external convergences.</p>
</dd>
<dt>h0.accept.rate</dt><dd><p>A scalar. The acceptance rate of the posterior sample of the Hubble constant.</p>
</dd>
<dt>omega.accept.rate</dt><dd><p>A scalar. The acceptance rate of the posterior sample of the dark matter density.</p>
</dd>
<dt>kappa.accept.rate</dt><dd><p>A vector. The acceptance rates of the posterior samples of K external convergences.</p>
</dd>
<dt>h0.scale</dt><dd><p>A scalar. The proposal scale of the Metropolis update when the last ieration is made because it changes at every 100 iterations for adaptive Markov chain Monte Carlo.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Hyungsuk Tak
</p>


<h3>References</h3>

<p>T. Treu and P. Marshall (2016) &lt;doi:10.1007/s00159-016-0096-8&gt; &quot;Time Delay Cosmography&quot;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#####  Suppose we have three time delay estimates of a quad-lens system, 
#####  and one time delay estimate of a double-lens system. 
time.delay.est &lt;- c(-101, -91.7, -104.2, -18.8)

#####  Each time delay estimate accompanies its one-sigma uncertainty (standard error)
time.delay.se &lt;- c(4.4, 4.2, 4.1, 0.9)

#####  The redshift of the deflector in the quad-lens system is 0.868, 
#####  and that in the double-lens system is 0.512.
z.d.obs &lt;- c(0.868, 0.868, 0.868, 0.512)

#####  The redshift of the source in the quad-lens system is 2.621, 
#####  and that in the double-lens system is 3.37.
z.s.obs &lt;- c(2.621, 2.621, 2.621, 3.37)

#####  Three Fermat potential difference estimates are obtained from a quad-lens syatem, 
#####  and one estimate is from the double-lens system.
fermat.diff.est &lt;- c(-0.6395, -0.5734, -0.6431, -0.2625)

#####  Each Fermat potential difference estimate accompanies 
#####  its one-sigma uncertainty (standard error).
fermat.diff.se &lt;- c(0.0265, 0.0254, 0.0299, 0.0148)

#### Next, we make sure that each vector has the same length.
length(z.d.obs); length(z.s.obs); length(fermat.diff.est); 
length(fermat.diff.se); length(time.delay.est); length(time.delay.se)

#####  The following is an example code to obtain 10 posterior samples of the model parameters.
initial.values &lt;- c(runif(1, 0, 150), runif(1, 0.05, 0.5), rcauchy(2, scale = 0.025))
res &lt;- h0(TD.est = time.delay.est, TD.se = time.delay.se, 
          FPD.est = fermat.diff.est, FPD.se = fermat.diff.se,
          z.d = z.d.obs, z.s = z.s.obs, 
          initial.param = initial.values,
          sample.size = 10, burnin.size = 5)
</code></pre>

<hr>
<h2 id='h0-internal'>Internal <code>h0</code> functions</h2><span id='topic+lpost.H0'></span><span id='topic+lpost.H0.temp'></span><span id='topic+TD.dist'></span><span id='topic+D.diff'></span><span id='topic+D'></span><span id='topic+E.inv'></span>

<h3>Description</h3>

<p>Internal <code>h0</code> functions</p>


<h3>Details</h3>

<p>These are not to be called by users.</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
