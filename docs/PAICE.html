<!DOCTYPE html><html><head><title>Help for package PAICE</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {PAICE}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#.onAttach'><p>.onAttach start message</p></a></li>
<li><a href='#CmonsData'><p>Occurrence matrix of <em>Cistus monspeliensis</em> in the Canary Islands</p></a></li>
<li><a href='#CmonsNetwork'><p>Genealogical relationship of <em>Cistus monspeliensis</em> haplotypes</p></a></li>
<li><a href='#CmonsRare'><p>Simulated rarefaction curves of <em>Cistus monspeliensis</em></p></a></li>
<li><a href='#colonization'><p>Inference of minimum number of colonization events</p></a></li>
<li><a href='#geneticResampling'><p>Simulate genetic sampling effort reduction</p></a></li>
<li><a href='#maxCol'><p>Asymptotic estimation of the number of colonization events</p></a></li>
<li><a href='#PAICE-package'>
<p>Phylogeographic Analysis of Island Colonization Events</p></a></li>
<li><a href='#plot.maxCol'><p>Plot asymptotic estimators of colonization events</p></a></li>
<li><a href='#plot.rarecol'><p>Plot rarefaction curve of colonization events</p></a></li>
<li><a href='#rarecol'><p>Rarefaction curve of colonization events</p></a></li>
<li><a href='#read.rarecol'><p>Read files containing rarefaction curves of colonization events</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Phylogeographic Analysis of Island Colonization Events</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.1</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>spelling, testthat</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimation of the number of colonization events between islands of the same archipelago for a species. It uses rarefaction curves to control for both field and genetic sample sizes as it was described in Coello et al. (2022) &lt;<a href="https://doi.org/10.1111%2Fjbi.14341">doi:10.1111/jbi.14341</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-11-12</td>
</tr>
<tr>
<td>URL:</td>
<td>&lt;<a href="https://github.com/PAICEcode/PAICE&amp;gt;">https://github.com/PAICEcode/PAICE&gt;</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/PAICEcode/PAICE/issues">https://github.com/PAICEcode/PAICE/issues</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-11-12 11:55:24 UTC; Alberto</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>Author:</td>
<td>Alberto J. Coello [aut, cre] (ORCID = 0000-0002-2665-3726),
  Mario Fern√°ndez-Mazuecos [aut] (ORCID = 0000-0003-4027-6477),
  Ruben H. Heleno [aut] (ORCID = 0000-0002-4808-4907),
  Pablo Vargas [aut] (ORCID = 0000-0003-4502-0382)</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Alberto J. Coello &lt;albjcoello@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-11-13 17:33:29 UTC</td>
</tr>
</table>
<hr>
<h2 id='.onAttach'>.onAttach start message</h2><span id='topic+.onAttach'></span>

<h3>Description</h3>

<p>.onAttach start message
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.onAttach(libname, pkgname)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".onAttach_+3A_libname">libname</code></td>
<td>
<p>defunct</p>
</td></tr>
<tr><td><code id=".onAttach_+3A_pkgname">pkgname</code></td>
<td>
<p>defunct</p>
</td></tr>
</table>


<h3>Value</h3>

<p>invisible()
</p>

<hr>
<h2 id='CmonsData'>Occurrence matrix of <em>Cistus monspeliensis</em> in the Canary Islands</h2><span id='topic+CmonsData'></span>

<h3>Description</h3>

<p>Data of <em>Cistus monspeliensis</em> prepared to be used as example for the
<span class="pkg">PAICE</span> package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(CmonsData)
</code></pre>


<h3>Format</h3>

<p>A data frame containing a presence matrix of <em>Cistus monspeliensis</em>
haplotypes in the Canary Islands extracted from Coello et al. (2021). Each
row indicates the number of individuals of each haplotype occurring in each
population. The first column indicates the island, the second column
indicates the population and successive columns correspond to haplotypes in
the island system. Missing haplotypes are also included but without any
presence (haplotypes <code>m1</code> and <code>m2</code>).
</p>


<h3>Details</h3>

<p>Data containing occurrences of each haplotype of <em>Cistus monspeliensis</em>
found in the Canary Islands. Data were taken from Coello et al. (2021). This
dataset was constructed using three ptDNA regions and 37 populations from
the Canarian archipelago.
</p>


<h3>References</h3>

<p>Coello, A.J., Fernandez-Mazuecos, M., Garcia-Verdugo, C., Vargas, P.
(2021).
Phylogeographic sampling guided by species distribution modeling reveals the
Quaternary history of the Mediterranean-Canarian <em>Cistus monspeliensis</em>
(Cistaceae).
<em>Journal of Systematics and Evolution, 59(2)</em>, 262-277.
DOI: <a href="https://onlinelibrary.wiley.com/doi/10.1111/jse.12570">10.1111/jse.12570</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(CmonsData)
CmonsData # Show data frame
</code></pre>

<hr>
<h2 id='CmonsNetwork'>Genealogical relationship of <em>Cistus monspeliensis</em> haplotypes</h2><span id='topic+CmonsNetwork'></span>

<h3>Description</h3>

<p>Genealogy of Canarian haplotypes of <em>Cistus monspeliensis</em>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("CmonsNetwork")
</code></pre>


<h3>Format</h3>

<p>A data frame containing the genalogy of <em>Cistus monspeliensis</em>
in the Canary Islands. Each row indicates the connection between each
haplotype and its ancestral haplotype. The first column is the name of the
haplotype, the second column is the name of its ancestral haplotype and the
third column indicates the number of variable positions that change between
both haplotypes. The ancestral haplotype in the archipelago (haplotype C1)
is connected to the outgroup (<code>"OUT"</code>), and is be located in the first
row of the genealogy.
</p>


<h3>Details</h3>

<p>This dataset was taken from Coello et al. (2021). It was constructed using
three ptDNA regions and 37 populations from the Canarian archipelago.
</p>


<h3>References</h3>

<p>Coello, A.J., Fernandez-Mazuecos, M., Garcia-Verdugo, C., Vargas, P.
(2021).
Phylogeographic sampling guided by species distribution modeling reveals the
Quaternary history of the Mediterranean-Canarian <em>Cistus monspeliensis</em>
(Cistaceae).
<em>Journal of Systematics and Evolution, 59(2)</em>, 262-277.
DOI: <a href="https://onlinelibrary.wiley.com/doi/10.1111/jse.12570">10.1111/jse.12570</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(CmonsNetwork)
CmonsNetwork # Show data frame
</code></pre>

<hr>
<h2 id='CmonsRare'>Simulated rarefaction curves of <em>Cistus monspeliensis</em></h2><span id='topic+CmonsRare'></span>

<h3>Description</h3>

<p>Simulated rarefaction curves to be used as example data for estimation of
colonization events.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(CmonsRare)
</code></pre>


<h3>Format</h3>

<p>A list containing data of both genetic and field rarefaction curves. The
first element corresponds to the genetic estimation and the second element
corresponds to the field estimation.
</p>


<h3>Details</h3>

<p>This dataset was constructed from <code><a href="#topic+CmonsData">CmonsData</a></code> and
<code><a href="#topic+CmonsNetwork">CmonsNetwork</a></code> with the following code:
</p>
<pre>
set.seed(31)

CmonsRare &lt;- rarecol(data = CmonsData, network = CmonsNetwork,
    replicates_field = 25, replicates_genetic = 25)
    </pre>


<h3>Examples</h3>

<pre><code class='language-R'>data(CmonsRare)
str(CmonsRare) # Structure of data
</code></pre>

<hr>
<h2 id='colonization'>Inference of minimum number of colonization events</h2><span id='topic+colonization'></span>

<h3>Description</h3>

<p>A inference of the minimum number of colonization events between islands of
an archipelago considering both haplotype distributions and genealogy.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>colonization(data, network)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="colonization_+3A_data">data</code></td>
<td>

<p>a data frame containing the matrix of occurrences of haplotypes in the
islands of an archipelago (applicable to any island-like system). The
first two columns indicate islands and populations sampled. Successive
columns indicate haplotype occurrences (one column per haplotype). If
present, missing haplotypes must also be included (i.e. columns without
occurrences).
</p>
</td></tr>
<tr><td><code id="colonization_+3A_network">network</code></td>
<td>

<p>a data frame containing the genealogy of haplotypes. The first column
indicates the haplotype, the second column indicates its ancestral
haplotype and the third column indicates the variable position changed
between an haplotype and its ancestral haplotype. If present, missing
haplotypes must also be included. The ancestral haplotype must be
connected to an outgroup named <code>"OUT"</code>, located in the first row of
the data frame, and has a variable position not shared with other
connections.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Colonization events are inferred following Coello et al. (2022).
</p>
<p>Each haplotype produces a number of colonization events equal to the total
number of islands in which the haplotype occurs minus one. These are type 1
colonization events (<code>c1</code>).
</p>
<p>Additionally, colonization events between an ancestral haplotype and the
derived haplotypes are also inferred if the ancestral haplotype occurs in
different islands than the derived haplotypes. These inferred colonization
events correspond to type 2 (<code>c2</code>) and type 3 (<code>c3</code>) colonization
events.
</p>
<p>A type 2 colonization events is that between a haplotype and its ancestral
haplotype that can only be assigned to the connection between these two
haplotypes. These colonization events are noted in the derived haplotype.
</p>
<p>Type 3 colonization events are those (one or more) inferred between an
ancestral haplotype and its derived haplotypes but that cannot be assigned
to a specific connection, so colonization events are assigned to the
ancestral haplotype.
</p>


<h3>Value</h3>

<p><code>colonization</code> returns an object of <code><a href="base.html#topic+class">class</a></code>
<code>"colonization"</code>.
</p>
<p>The function <code>print</code> shows the total of colonization events inferred.
The function <code>summary</code> returns a more detailed output showing a
description of data used and inferred colonization events by haplotype and
by type.
</p>


<h3>Note</h3>

<p><code>colonization</code> only considers the complete sampling. To correct the
inference by field and genetic sampling use <code><a href="#topic+rarecol">rarecol</a></code>.
</p>


<h3>References</h3>

<p>Coello, A.J., Fernandez-Mazuecos, M., Heleno, R.H., Vargas, P. (2022).
PAICE: A new R package to estimate the number of inter-island colonizations
considering haplotype data and sample size. <em>Journal of Biogeography</em>,
49(4), 577-589.DOI:
<a href="https://onlinelibrary.wiley.com/doi/10.1111/jbi.14341">10.1111/jbi.14341</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rarecol">rarecol</a></code> to build a rarefaction curve of colonization events.
<code><a href="#topic+maxCol">maxCol</a></code> to calculate the asymptotic estimator for the number of
colonization events from data generated by <code><a href="#topic+rarecol">rarecol</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(CmonsData)
data(CmonsNetwork)
col &lt;- colonization(data = CmonsData, network = CmonsNetwork)
col # Total of colonization events inferred
summary(col) # Detailed description of inferred colonization events
</code></pre>

<hr>
<h2 id='geneticResampling'>Simulate genetic sampling effort reduction</h2><span id='topic+geneticResampling'></span>

<h3>Description</h3>

<p>A reduction of the resolution of the genealogy by supressing a variable
position in the genealogy. It simulates a lower level of genetic sampling.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>geneticResampling(data, network, position)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="geneticResampling_+3A_data">data</code></td>
<td>

<p>a data frame containing the occurrence matrix of haplotypes in the
islands of an archipelago (applicable to any island-like system). The
two first columns indicate islands and populations sampled. Successive
columns indicate haplotype occurrences (one column per haplotype). If
present, missing haplotypes must also be included (i.e. columns without
occurrences).
</p>
</td></tr>
<tr><td><code id="geneticResampling_+3A_network">network</code></td>
<td>

<p>a data frame containing the genealogy of haplotypes. The first column
indicates the haplotype, the second column indicates its ancestral
haplotype and the third column indicates the variable position changed
between an haplotype and its ancestral haplotype. If present, missing haplotypes must also be
included. The ancestral haplotype must be connected to an outgroup named
<code>"OUT"</code>, located in the first row of the data frame, and has a
variable position not shared with other connections.
</p>
</td></tr>
<tr><td><code id="geneticResampling_+3A_position">position</code></td>
<td>

<p>numeric. Indicates the variable position that will be deleted in the
simplified data.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To simulate a lower level of genetic sampling, this function deletes a
variable position from the original data and thus simplifies the genealogy.
<code>geneticResampling</code> generates a new occurrence matrix of haplotypes and
a new genealogy without the variable position previously indicated and
merging ancestral and derived haplotypes separated by this variable
position. If more than one connection are defined by the variable position
indicated, this function deletes all connections with this variable
position. This function works for both observed and missing haplotypes.
</p>


<h3>Value</h3>

<p><code>geneticResampling</code> returns a list containing the new occurrence matrix
of haplotypes and the new genealogy after deleting the variable position
indicated. The returned object contains the following components:
</p>
<table>
<tr><td><code>data</code></td>
<td>

<p>a data frame containing the new occurrence matrix of haplotypes after
removing the variable position indicated.
</p>
</td></tr>
<tr><td><code>network</code></td>
<td>

<p>a data frame containing the new genealogy after removing the variable
position indicated.
</p>
</td></tr>
</table>


<h3>Note</h3>

<p>If the variable position corresponds to the connection between the ancestral
haplotype in the archipelago and the outgroup (denoted as <code>"OUT"</code>), no
change is effected as the ancestral haplotype stays connected to the
outgroup.
</p>
<p>This function works inside <code><a href="#topic+rarecol">rarecol</a></code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rarecol">rarecol</a></code> to build a rarefaction curve of colonization events.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(CmonsData)
data(CmonsNetwork)
# Delete position 462 of Cistus monspeliensis data
newdata &lt;- geneticResampling(CmonsData, CmonsNetwork, 462)
newdata$data # New presences matrix of haplotypes
newdata$network # New genealogy
</code></pre>

<hr>
<h2 id='maxCol'>Asymptotic estimation of the number of colonization events</h2><span id='topic+maxCol'></span>

<h3>Description</h3>

<p>A calculation of asymptotic estimators of colonization events from both
curves generated using the <a href="#topic+rarecol">rarecol</a> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>maxCol(data, level = 0.95, del = 0.05, method = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="maxCol_+3A_data">data</code></td>
<td>

<p>an object of <code><a href="base.html#topic+class">class</a></code> <code>"rarecol"</code> that contains
output from <code><a href="#topic+rarecol">rarecol</a></code>.
</p>
</td></tr>
<tr><td><code id="maxCol_+3A_level">level</code></td>
<td>

<p>numeric. Determines the confidence interval used to estimate error in
Michaelis-Menten equation parameters. By default 0.95.
</p>
</td></tr>
<tr><td><code id="maxCol_+3A_del">del</code></td>
<td>

<p>numeric. Determines the interval of values to be deleted to avoid the
influence of extreme values. By default 0.05 (i.e. deleted values below
2.5 quantile and above 97.5 quantile).
</p>
</td></tr>
<tr><td><code id="maxCol_+3A_method">method</code></td>
<td>

<p>numeric. Indicates if the algorithm should try to fit the curve by
assigning a value to the intercept in genetic rarefaction curves
(<code>method = 1</code>) or discard these cases when it is not possible to
fit the curve with all values (<code>method = 0</code>). By default,
<code>method = 1</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function calculates the number of colonization events estimated by both
resampling methods used in the function <code><a href="#topic+rarecol">rarecol</a></code>. The first
estimation (genetic estimation) corresponds to resampling first at genetic
level (number of variable positions) and then, per each variable position, a
complete resampling of the number of populations is done. The second
estimation (field estimation) corresponds to the opposite resampling, it is
done first at field level (number of populations) and then, per each
population, a complete resampling of the number of variable positions is
done.
</p>
<p>For each curve, the function first estimates the asymptote (estimated number
of colonization events) for each level of the second resampling (populations
in the first estimation and variable positions in the second estimation)
using the mean value of all replicates at each point. Then, these
estimations are used to build the final curve estimating the number of
colonization events for each resampling methodology. This final curve uses
estimations calculated previously, and the asymptote of the curve is
calculated by using mean points for each value of the first resampling
method (variable positions in the first estimation and populations in the
second estimation). The asymptote is calculated by fitting the curve to a
Michaelis-Menten equation following Coello et al. (2022).
</p>
<p>The confidence interval for the estimated number of colonization events is
calculated with the <code><a href="stats.html#topic+confint">confint</a></code> function. Curve fitting is done using the <code><a href="stats.html#topic+nls">nls</a></code> function.
</p>


<h3>Value</h3>

<p>This function returns an object of <code><a href="base.html#topic+class">class</a></code> <code>"maxCol"</code>
consisting in a list of the following elements:
</p>
<table>
<tr><td><code>DataGen</code></td>
<td>

<p>a data frame containing the mean estimated number of colonization events
per number of variable positions in the genetic estimation.
</p>
</td></tr>
<tr><td><code>FormulaGen</code></td>
<td>

<p>formula used to fit final curve in the genetic estimation.
</p>
</td></tr>
<tr><td><code>DataField</code></td>
<td>

<p>a data frame containing the mean estimated number of colonization events
per population in the field estimation.
</p>
</td></tr>
<tr><td><code>FormulaField</code></td>
<td>

<p>formula used to fit the final curve in the field estimation.
</p>
</td></tr>
<tr><td><code>Summary</code></td>
<td>

<p>a matrix containing the estimated number of colonization events of each
estimation (genetic and field). Minimum and maximum are calculated using
the confidence interval indicated.
</p>
</td></tr>
<tr><td><code>ParametersGen</code></td>
<td>

<p>a matrix containing the value of each parameter to fit a
Michaelis-Menten equation for genetic estimation. The minimum and
maximum of each parameter according to the confidence interval
indicated. This equation is described as: colonization events = M *
positions / (K + positions) + c.
</p>
</td></tr>
<tr><td><code>ParametersField</code></td>
<td>

<p>a matrix containing the value of each parameter to fit a
Michaelis-Menten equation for field estimation. The minimum and maximum
of each parameter according to the confidence interval indicated. This
equation is described as: colonization events = M * (populations - 1) /
(K + populations - 1).
</p>
</td></tr>
<tr><td><code>ConfintLevel</code></td>
<td>

<p>a vector containing the confidence interval used to calculate minimum
and maximum for each parameter.
</p>
</td></tr>
<tr><td><code>DeletedData</code></td>
<td>

<p>a vector containing the interval of extreme values deleted to do the fit
of the second accumulation curve.
</p>
</td></tr>
</table>
<p>The function <code>print</code> returns the number of colonization events inferred
for each estimation (genetic and field) and the interval of confidence of
these estimations.The function <code>summary</code> shows a detailed description
of parameters used to fit both curves, the formula used to fit these curves
and the confidence of interval of each parameter.
</p>


<h3>Note</h3>

<p>To show a detailed description of inferred colonization events in the most
complete case use the function <code><a href="#topic+colonization">colonization</a></code>.
</p>


<h3>References</h3>

<p>Coello, A.J., Fernandez-Mazuecos, M., Heleno, R.H., Vargas, P. (2022).
PAICE: A new R package to estimate the number of inter-island colonizations
considering haplotype data and sample size. <em>Journal of Biogeography</em>,
49(4), 577-589.DOI:
<a href="https://onlinelibrary.wiley.com/doi/10.1111/jbi.14341">10.1111/jbi.14341</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rarecol">rarecol</a></code> to build rarefaction curves of colonization events. To
describe the number of colonization events inferred in the most complete
case use the function <code><a href="#topic+colonization">colonization</a></code>. <code><a href="#topic+plot.maxCol">plot.maxCol</a></code>
to plot the result of this function.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Use 'CmonsRare' data, a dataset generated using 25 replicates
# in both genetic and field sampling
data(CmonsRare)
maxcol &lt;- maxCol(data = CmonsRare)
maxcol # Number of colonization estimated in each curve
summary(maxcol) # Description of curves
plot(maxcol) # Plotting estimations
# Plot all the information
old.par &lt;- par(no.readonly = TRUE) # To restore previous options
par(mfrow = c(2, 2))
plot(CmonsRare) # First two plots with rarefaction curves
par(fig = c(0, 1, 0, 0.5), new = TRUE)
plot(maxcol) # Third plot with estimations
par(old.par)
</code></pre>

<hr>
<h2 id='PAICE-package'>
Phylogeographic Analysis of Island Colonization Events
</h2><span id='topic+PAICE'></span><span id='topic+PAICE-package'></span>

<h3>Description</h3>

<p>A package for inferring inter-island colonization events in island-like
systems.
</p>


<h3>Details</h3>

<p>Estimation of the number of infer inter-island colonization events in an
island-like system by analyzing the geographic distribution of uniparentally
inherited haplotypes and their genealogical relationships. Furthermore, by
building rarefaction curves based on both genetic sampling (variable
positions) and field sampling (populations/individuals), an estimation of
the number of colonization events corrected by sampling effort could be
done. The method used in the <span class="pkg">PAICE</span> package is described in Coello et
al. (2022).
</p>


<h3>PAICE functions</h3>

<p><code><a href="#topic+colonization">colonization</a></code> to infer the minimun number of colonization
events
</p>
<p><code><a href="#topic+geneticResampling">geneticResampling</a></code> to simplify the genealogy by deleting a
variable position
</p>
<p><code><a href="#topic+maxCol">maxCol</a></code> to calculate asymptotic estimators considering genetic
and field sampling
</p>
<p><code><a href="#topic+plot.maxCol">plot.maxCol</a></code> to plot curves generated by maxCol
</p>
<p><code><a href="#topic+plot.rarecol">plot.rarecol</a></code> to plot rarefaction curves
</p>
<p><code><a href="#topic+rarecol">rarecol</a></code> to generate rarefaction curves of colonization events
</p>
<p><code><a href="#topic+read.rarecol">read.rarecol</a></code> to read previously saved rarefaction curve files
</p>


<h3>PAICE datasets</h3>

<p><code><a href="#topic+CmonsData">CmonsData</a></code> haplotype distribution of
<em>Cistus monspeliensis</em> in the Canary Islands
</p>
<p><code><a href="#topic+CmonsNetwork">CmonsNetwork</a></code> genealogy of <em>Cistus monspeliensis</em>
</p>
<p><code><a href="#topic+CmonsRare">CmonsRare</a></code> example data of rarefaction curves for <em>Cistus
monspeliensis</em>
</p>


<h3>Author(s)</h3>

<p>Alberto J. Coello,
Mario Fernandez-Mazuecos,
Ruben H. Heleno
and Pablo Vargas
</p>
<p>Maintainer: Alberto J. Coello &lt;albjcoello@gmail.com&gt;
</p>


<h3>References</h3>

<p>Coello, A.J., Fernandez-Mazuecos, M., Heleno, R.H., Vargas, P. (2022).
PAICE: A new R package to estimate the number of inter-island colonizations
considering haplotype data and sample size. <em>Journal of Biogeography</em>,
49(4), 577-589.DOI:
<a href="https://onlinelibrary.wiley.com/doi/10.1111/jbi.14341">10.1111/jbi.14341</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Inference of minimum number of inter-island colonization events
data(CmonsData)
data(CmonsNetwork)
col &lt;- colonization(data = CmonsData, network = CmonsNetwork)
col
summary(col)

# Asumptotic estimators of colonization events
# 25 replicates used in each sampling variable
set.seed(31)
CmonsRare &lt;- rarecol(data = CmonsData, network = CmonsNetwork,
    replicates_field = 25, replicates_genetic = 25, monitor = TRUE,
    mode = c(1, 2))
maxcol &lt;- maxCol(data = CmonsRare)
maxcol
summary(maxcol)

# Plotting results
old.par &lt;- par(no.readonly = TRUE) # To restore previous options
par(mfrow = c(2, 2))
plot(CmonsRare)
par(fig = c(0, 1, 0, 0.5), new = TRUE)
plot(maxcol)
par(old.par)
</code></pre>

<hr>
<h2 id='plot.maxCol'>Plot asymptotic estimators of colonization events</h2><span id='topic+plot.maxCol'></span>

<h3>Description</h3>

<p>Plots for the estimators calculated by <code><a href="#topic+maxCol">maxCol</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'maxCol'
plot(x, xlim, ylim, col, xlabbotton, xlabtop, ylab, main,
     pch = 16, lty = 1, lwd = 2, cex = 1, estimation = TRUE,
     legend = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.maxCol_+3A_x">x</code></td>
<td>

<p>an object of <code><a href="base.html#topic+class">class</a></code> <code>"maxCol"</code> returned by
<code><a href="#topic+maxCol">maxCol</a></code> function.
</p>
</td></tr>
<tr><td><code id="plot.maxCol_+3A_xlim">xlim</code>, <code id="plot.maxCol_+3A_ylim">ylim</code></td>
<td>

<p>numeric vector containing limits of x and y axis of the plot (min, max).
</p>
</td></tr>
<tr><td><code id="plot.maxCol_+3A_col">col</code></td>
<td>

<p>character vector containing colour of both estimation: genetic and field.
</p>
</td></tr>
<tr><td><code id="plot.maxCol_+3A_xlabbotton">xlabbotton</code></td>
<td>

<p>a title of the x axis at the bottom of the plot. It correspond with
genetic estimation.
</p>
</td></tr>
<tr><td><code id="plot.maxCol_+3A_xlabtop">xlabtop</code></td>
<td>

<p>a title of the x axis at the top of the plot. It correponds with field
estimation.
</p>
</td></tr>
<tr><td><code id="plot.maxCol_+3A_ylab">ylab</code></td>
<td>

<p>a title of the y axis of the plot.
</p>
</td></tr>
<tr><td><code id="plot.maxCol_+3A_main">main</code></td>
<td>

<p>an overall title for the plot.
</p>
</td></tr>
<tr><td><code id="plot.maxCol_+3A_pch">pch</code></td>
<td>

<p>indicate symbol used for points of the plot (by default
<code>pch = 16</code>). See <code><a href="graphics.html#topic+par">par</a></code> for additional
information.
</p>
</td></tr>
<tr><td><code id="plot.maxCol_+3A_lty">lty</code></td>
<td>

<p>type of lines used in the plot for curve fitting (by default
<code>lty = 1</code>). See <code><a href="graphics.html#topic+par">par</a></code> for additional
information.
</p>
</td></tr>
<tr><td><code id="plot.maxCol_+3A_lwd">lwd</code></td>
<td>

<p>width of lines used in the plot for curve fitting (by default
<code>lwd = 2</code>). See <code><a href="graphics.html#topic+par">par</a></code> for additional
information.
</p>
</td></tr>
<tr><td><code id="plot.maxCol_+3A_cex">cex</code></td>
<td>

<p>size of elements in the plot.
</p>
</td></tr>
<tr><td><code id="plot.maxCol_+3A_estimation">estimation</code></td>
<td>

<p>logical. If it is <code>TRUE</code> an estimation of estimation of number of
colonization events is plotted at the right size of the plot.
</p>
</td></tr>
<tr><td><code id="plot.maxCol_+3A_legend">legend</code></td>
<td>

<p>logial. If it is <code>TRUE</code> the legend is added.
</p>
</td></tr>
<tr><td><code id="plot.maxCol_+3A_...">...</code></td>
<td>

<p>aditional graphical parameters (see <code><a href="graphics.html#topic+par">par</a></code>) for
aditional information.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Genetic and field estimation are fitted to Michaelis-Menten equation
following Coello et al. (2022).
</p>


<h3>Value</h3>

<p>Plot returned by this function represent estimations calculated by
<code><a href="#topic+maxCol">maxCol</a></code>. The two curves representing both estimators: genetic
and field. Each point represent the mean of number of colonization events
inferred by all replicates at this sampling level. Curves represent
Michaelis-Menten equation fitted to this dataset. If it is plotted, right
side of the plot represent the number of colonization events estimated by
this fitting curve for each estimation, including the conficende interval of
this estimation.
</p>


<h3>References</h3>

<p>Coello, A.J., Fernandez-Mazuecos, M., Heleno, R.H., Vargas, P. (2022).
PAICE: A new R package to estimate the number of inter-island colonizations
considering haplotype data and sample size. <em>Journal of Biogeography</em>,
49(4), 577-589.DOI:
<a href="https://onlinelibrary.wiley.com/doi/10.1111/jbi.14341">10.1111/jbi.14341</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+maxCol">maxCol</a></code> to fit the accumulation curve of colonization events
and estimate the number of colonization events.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Use 'CmonsRare' data, a dataset generated using 25 replicates
# in both genetic and field sampling
data(CmonsRare)
maxcol &lt;- maxCol(data = CmonsRare)
plot(maxcol)
</code></pre>

<hr>
<h2 id='plot.rarecol'>Plot rarefaction curve of colonization events</h2><span id='topic+plot.rarecol'></span>

<h3>Description</h3>

<p>Plots for the rarefaction curves produced by <code><a href="#topic+rarecol">rarecol</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rarecol'
plot(x, xlim1, xlim2, ylim, ylim1, ylim2, palette1, palette2, main1,
    main2, xlab1, xlab2, ylab1, ylab2, las1 = 1, las2 = 1,
    cextText = 0.75, legendbar = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.rarecol_+3A_x">x</code></td>
<td>

<p>an object generated by the <code><a href="#topic+rarecol">rarecol</a></code> function.
</p>
</td></tr>
<tr><td><code id="plot.rarecol_+3A_xlim1">xlim1</code>, <code id="plot.rarecol_+3A_xlim2">xlim2</code></td>
<td>

<p>x limits (min, max) of the two plots.
</p>
</td></tr>
<tr><td><code id="plot.rarecol_+3A_ylim1">ylim1</code>, <code id="plot.rarecol_+3A_ylim2">ylim2</code></td>
<td>

<p>y limits (min, max) of the two plots.
</p>
</td></tr>
<tr><td><code id="plot.rarecol_+3A_ylim">ylim</code></td>
<td>

<p>y limits (min, max) of the two plots simultaneously. If <code>ylim</code> is
defined, the function does not consider <code>ylim1</code> and <code>ylim2</code>.
</p>
</td></tr>
<tr><td><code id="plot.rarecol_+3A_palette1">palette1</code>, <code id="plot.rarecol_+3A_palette2">palette2</code></td>
<td>

<p>vector of color for lines in plot 1 and plot 2.
</p>
</td></tr>
<tr><td><code id="plot.rarecol_+3A_main1">main1</code>, <code id="plot.rarecol_+3A_main2">main2</code></td>
<td>

<p>overall title of plot 1 and plot 2.
</p>
</td></tr>
<tr><td><code id="plot.rarecol_+3A_xlab1">xlab1</code>, <code id="plot.rarecol_+3A_xlab2">xlab2</code></td>
<td>

<p>label of x axis of plot 1 and plot 2.
</p>
</td></tr>
<tr><td><code id="plot.rarecol_+3A_ylab1">ylab1</code>, <code id="plot.rarecol_+3A_ylab2">ylab2</code></td>
<td>

<p>label of y axis of plot 1 and plot 2
</p>
</td></tr>
<tr><td><code id="plot.rarecol_+3A_las1">las1</code>, <code id="plot.rarecol_+3A_las2">las2</code></td>
<td>

<p>numeric. Corresponds to the style of axis labels in plot 1 and plot 2.
Values: 0 (always parallel to the axis), 1 (always horizontal), 2
(always perpendicular to the axis), 3 (always vertical). See
<code><a href="graphics.html#topic+par">par</a></code> for more information.
</p>
</td></tr>
<tr><td><code id="plot.rarecol_+3A_cexttext">cextText</code></td>
<td>

<p>size of legend text.
</p>
</td></tr>
<tr><td><code id="plot.rarecol_+3A_legendbar">legendbar</code></td>
<td>

<p>logical. If <code>TRUE</code>, it shows a legend bar indicating the color value of
each variable position.
</p>
</td></tr>
<tr><td><code id="plot.rarecol_+3A_...">...</code></td>
<td>

<p>aditional graphical parameters (see <code><a href="graphics.html#topic+par">par</a></code>) for
additional information.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The first plot corresponds to the genetic estimation. This plot shows
accumulation of colonization events as a function of population number. Each
curve was created for each number of variable positions in the dataset.
</p>
<p>The second plot corresponds to the field estimation. This plot shows
accumulation of colonization events as a function of the number of variable
positions. Each curve is created for each number of populations in the
dataset.
</p>


<h3>Value</h3>

<p>This function returns two plots corresponding to the two resampling methods
used in <code><a href="#topic+rarecol">rarecol</a></code>. The first curve corresponds to the &quot;genetic
estimation&quot; in which a genetic resampling of every possible number of
variable position is done and, for each resample, a complete resampling of
population is done. The second curve represents the opposite method
corresponding to the &quot;field estimation&quot;: it first resamples every possible
number of populations and, for each case, a complete resampling of
variable positions is done.
</p>


<h3>References</h3>

<p>Coello, A.J., Fernandez-Mazuecos, M., Heleno, R.H., Vargas, P. (2022).
PAICE: A new R package to estimate the number of inter-island colonizations
considering haplotype data and sample size. <em>Journal of Biogeography</em>,
49(4), 577-589.DOI:
<a href="https://onlinelibrary.wiley.com/doi/10.1111/jbi.14341">10.1111/jbi.14341</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rarecol">rarecol</a></code> to build a rarefection curve of colonization events.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Use 'CmonsRare' data, a dataset generated using 25 replicates
# in both genetic and field sampling
data(CmonsRare)
plot(CmonsRare)
</code></pre>

<hr>
<h2 id='rarecol'>Rarefaction curve of colonization events</h2><span id='topic+rarecol'></span>

<h3>Description</h3>

<p>A creation of rarefaction curves considering both genetic and field data.
First, the function samples variable positions and then samples populations
for each variable position. Second, it samples populations and then samples
variable positions for each population.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rarecol(data, network, replicates_field = 10,
        replicates_genetic = 10, mode = c(1, 2), monitor = TRUE,
        file = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rarecol_+3A_data">data</code></td>
<td>

<p>a data frame containing the occurrence matrix of haplotypes in the
islands of an archipelago (applicable to any island-like system). The
first two columns indicate islands and populations sampled. Successive
columns indicate haplotype occurrences (one column per haplotype). If
present, missing haplotypes must also be included (i.e. columns without
occurrences).
</p>
</td></tr>
<tr><td><code id="rarecol_+3A_network">network</code></td>
<td>

<p>a data frame containing the genealogy of haplotypes. The first column
indicates the haplotype, the second column indicates its ancestral
haplotype and the third column indicates the variable position changed
between an haplotype and its ancestral haplotype. If present, missing
haplotypes must also be included. The ancestral haplotype must be
connected to an outgroup named <code>"OUT"</code>, located in the first row of
the data frame, and has a variable position not shared with other
connections.
</p>
</td></tr>
<tr><td><code id="rarecol_+3A_replicates_field">replicates_field</code></td>
<td>

<p>numeric. Number of replicates for field resampling. Each replicate adds
populations from one to the total number of populations in the dataset
and infers the corresponding number of colonization events.
</p>
</td></tr>
<tr><td><code id="rarecol_+3A_replicates_genetic">replicates_genetic</code></td>
<td>

<p>numeric. Number of replicates for genetic resampling. Each replicate
adds variable positions from none (chorology) to the total number of
variable positions in the dataset and infers the corresponding number of
colonization events.
</p>
</td></tr>
<tr><td><code id="rarecol_+3A_monitor">monitor</code></td>
<td>

<p>logical. If <code>TRUE</code> it shows progress in the console.
</p>
</td></tr>
<tr><td><code id="rarecol_+3A_mode">mode</code></td>
<td>

<p>numeric vector. Indicates which estimations must be conducted. 1 for
genetic estimation and 2 for field estimation. By default the function
conducts both processes.
</p>
</td></tr>
<tr><td><code id="rarecol_+3A_file">file</code></td>
<td>

<p>character string determining the name of the file to save rarefaction
curves built by this function. Two files are created, one for genetic
estimation and one for field estimation. If a file name is indicated,
the function does not return any result, all the results are saved in
the indicated files. If set to <code>NULL</code>, the data are showed as
output.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>rarecol</code> returns an object of <code><a href="base.html#topic+class">class</a></code>
<code>"rarecol"</code>. The return is a list containing information about the two
rarefaction curves generated.
</p>


<h3>References</h3>

<p>Coello, A.J., Fernandez-Mazuecos, M., Heleno, R.H., Vargas, P. (2022).
PAICE: A new R package to estimate the number of inter-island colonizations
considering haplotype data and sample size. <em>Journal of Biogeography</em>,
49(4), 577-589.DOI:
<a href="https://onlinelibrary.wiley.com/doi/10.1111/jbi.14341">10.1111/jbi.14341</a>
</p>


<h3>See Also</h3>

<p>To describe the number of colonization events observed in the most complete
case, use the function <code><a href="#topic+colonization">colonization</a></code>. <code><a href="#topic+maxCol">maxCol</a></code>,
which estimates the number of colonization events of data generated by this
funtion. <code><a href="#topic+plot.rarecol">plot.rarecol</a></code> to plot the result of this function.
<code><a href="#topic+read.rarecol">read.rarecol</a></code> to import files generated from this function.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(CmonsData)
data(CmonsNetwork)
# Build rarefaction curves with 5 field and genetic replicates
## Note: more replicates are needed to build accurate curves
## Note: 5 replicates are relatively fast and adequate to
##       explore the data
rcol &lt;- rarecol(data = CmonsData, network = CmonsNetwork,
                replicates_field = 5, replicates_genetic = 5,
                monitor = TRUE, mode = c(1, 2))
old.par &lt;- par(no.readonly = TRUE) # To restore previous options
par(mfrow = c(1, 2))
plot(rcol) # Plotting results
par(old.par)
</code></pre>

<hr>
<h2 id='read.rarecol'>Read files containing rarefaction curves of colonization events</h2><span id='topic+read.rarecol'></span>

<h3>Description</h3>

<p>An import method for data generated by <code><a href="#topic+rarecol">rarecol</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read.rarecol(gen, field)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read.rarecol_+3A_gen">gen</code>, <code id="read.rarecol_+3A_field">field</code></td>
<td>

<p>filenames of genetic and field estimation data.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function uses <code><a href="utils.html#topic+read.table">read.table</a></code> to import both files
created by <code><a href="#topic+rarecol">rarecol</a></code>.
</p>


<h3>Value</h3>

<p>This function returns an object of <code><a href="base.html#topic+class">class</a></code> <code>rarecol</code>.
This object is a list in which each element is a data.frame containing
information about colonization inference.
</p>


<h3>References</h3>

<p>Coello, A.J., Fernandez-Mazuecos, M., Heleno, R.H., Vargas, P. (2022).
PAICE: A new R package to estimate the number of inter-island colonizations
considering haplotype data and sample size. <em>Journal of Biogeography</em>,
49(4), 577-589.DOI:
<a href="https://onlinelibrary.wiley.com/doi/10.1111/jbi.14341">10.1111/jbi.14341</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rarecol">rarecol</a></code> for building of rarefaction curves of colonization
events.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(CmonsData)
data(CmonsNetwork)
# Make rarefaction curves and save it in working directory,
## Note: only one replicate per sampling to it quickly
rarecol(data = CmonsData, network = CmonsNetwork,
        replicates_field = 1, replicates_genetic = 1,
        monitor = TRUE, file = "rareData")
# Genetic estimation has the suffix "_gen" and the field "_field"
raredata &lt;- read.rarecol(gen = "rareData_gen.csv",
                         field = "rareData_field.csv")
str(raredata) # Show structure of data imported
# Remove files created
file.remove("rareData_gen.csv", "rareData_field.csv")
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
