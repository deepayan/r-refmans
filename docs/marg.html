<!DOCTYPE html><html><head><title>Help for package marg</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {marg}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#marg-package'>
<p>Approximate marginal inference for regression-scale models</p></a></li>
<li><a href='#anova.rsm'><p>ANOVA Table for a RSM Object</p></a></li>
<li><a href='#anova.rsmlist'>
<p>Use anova() on a &ldquo;rsmlist&rdquo; object</p></a></li>
<li><a href='#cond'>
<p>Approximate Conditional Inference - Generic Function</p></a></li>
<li><a href='#cond.rsm'>
<p>Approximate Conditional Inference in Regression-Scale Models</p></a></li>
<li><a href='#darwin'><p>Darwin's Data on Growth Rates of Plants</p></a></li>
<li><a href='#family.rsm'>
<p>Use family() on a &ldquo;rsm&rdquo; object</p></a></li>
<li><a href='#family.rsm.object'>
<p>Family Object for Regression-Scale Models</p></a></li>
<li><a href='#houses'><p>House Price Data</p></a></li>
<li><a href='#Huber'>
<p>Huber's Least Favourable Distribution</p></a></li>
<li><a href='#logLik.rsm'>
<p>Compute the Log Likelihood for Regression-Scale Models</p></a></li>
<li><a href='#make.family.rsm'>
<p>Support for RSM Family Functions</p></a></li>
<li><a href='#marg.object'>
<p>Approximate Marginal Inference Object</p></a></li>
<li><a href='#nuclear'><p>Nuclear Power Station Data</p></a></li>
<li><a href='#plot.marg'>
<p>Generate Plots for an Approximate Marginal Inference Object</p></a></li>
<li><a href='#print.family.rsm'>
<p>Use print() on a &ldquo;family.rsm&rdquo; object</p></a></li>
<li><a href='#print.marg'>
<p>Use print() on a &ldquo;marg&rdquo; object</p></a></li>
<li><a href='#print.rsm'>
<p>Use print() on a &ldquo;rsm&rdquo; object</p></a></li>
<li><a href='#print.summary.marg'>
<p>Use print() on a &ldquo;summary.marg&rdquo; object</p></a></li>
<li><a href='#print.summary.rsm'>
<p>Use print() on a &ldquo;summary.rsm&rdquo; object</p></a></li>
<li><a href='#residuals.rsm'>
<p>Compute Residuals for Regression-Scale Models</p></a></li>
<li><a href='#rsm'>
<p>Fit a Regression-Scale Model</p></a></li>
<li><a href='#rsm.diag'>
<p>Diagnostics for Regression-Scale Models</p></a></li>
<li><a href='#rsm.diag.plots'>
<p>Diagnostic Plots for Regression-Scale Models</p></a></li>
<li><a href='#rsm.dispersion'>
<p>Support for Functions rsm.fit and rsm.surv</p></a></li>
<li><a href='#rsm.distributions'>
<p>RSM Family Support Object</p></a></li>
<li><a href='#rsm.families'>
<p>Generate a RSM Family Object</p></a></li>
<li><a href='#rsm.fit'>
<p>Fit a Regression-Scale Model Without Computing the Model Matrix</p></a></li>
<li><a href='#rsm.null'>
<p>Fit an Empty Regression-Scale Model</p></a></li>
<li><a href='#rsm.object'>
<p>Regression-Scale Model Object</p></a></li>
<li><a href='#rsm.surv'>
<p>Fit a Regression-Scale Model Without Computing the Model Matrix</p></a></li>
<li><a href='#summary.marg'>
<p>Summary Method for Objects of Class &ldquo;marg&rdquo;</p></a></li>
<li><a href='#summary.rsm'>
<p>Summary Method for Regression-Scale Models</p></a></li>
<li><a href='#update.rsm'>
<p>Update and Re-fit a RSM Model Call</p></a></li>
<li><a href='#vcov.rsm'><p>Calculate Variance-Covariance Matrix for a Fitted RSM Model</p></a></li>
<li><a href='#venice'><p>Sea Level Data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>1.2-2.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2014-03-31</td>
</tr>
<tr>
<td>Title:</td>
<td>Approximate Marginal Inference for Regression-Scale Models</td>
</tr>
<tr>
<td>Author:</td>
<td>S original by Alessandra R. Brazzale &lt;alessandra.brazzale@unipd.it&gt;.
  R port by Alessandra R. Brazzale &lt;alessandra.brazzale@unipd.it&gt;, following 
  earlier work by Douglas Bates.</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Alessandra R. Brazzale &lt;alessandra.brazzale@unipd.it&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.0), statmod, survival</td>
</tr>
<tr>
<td>Suggests:</td>
<td>boot, cond, csampling, nlreg</td>
</tr>
<tr>
<td>Description:</td>
<td>Likelihood inference based on higher order approximations 
  for linear nonnormal regression models.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> | file LICENCE [expanded from: GPL (&ge; 2) | file LICENCE]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://www.r-project.org">https://www.r-project.org</a>, <a href="http://statwww.epfl.ch/AA/">http://statwww.epfl.ch/AA/</a></td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-04-16 14:54:19 UTC; hornik</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-04-16 15:01:46 UTC</td>
</tr>
</table>
<hr>
<h2 id='marg-package'>
Approximate marginal inference for regression-scale models
</h2><span id='topic+marg-package'></span><span id='topic+marg'></span>

<h3>Description</h3>

<p>Likelihood inference based on higher order approximations
for linear nonnormal regression models
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> marg</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.2-0</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2009-10-03</td>
</tr>
<tr>
 <td style="text-align: left;">
Depends: </td><td style="text-align: left;"> R (&gt;= 2.6.0), statmod, survival</td>
</tr>
<tr>
 <td style="text-align: left;">
Suggests: </td><td style="text-align: left;"> boot, cond, csampling, nlreg</td>
</tr>
<tr>
 <td style="text-align: left;"> 
License: </td><td style="text-align: left;"> GPL (&gt;= 2)</td>
</tr>
<tr>
 <td style="text-align: left;">
URL: </td><td style="text-align: left;"> http://www.r-project.org, http://statwww.epfl.ch/AA/</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyData: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Index:
</p>
<pre>
Functions:
=========
cond                    Approximate Conditional Inference - Generic
                        Function
cond.rsm                Approximate Conditional Inference in
                        Regression-Scale Models
dHuber                  Huber's Least Favourable Distribution
family.rsm              Use family() on a "rsm" object
family.rsm.object       Family Object for Regression-Scale Models
logLik.rsm              Compute the Log Likelihood for
                        Regression-Scale Models
marg.object             Approximate Marginal Inference Object
plot.marg               Generate Plots for an Approximate Marginal
                        Inference Object
print.summary.marg      Use print() on a "summary.marg" object
residuals.rsm           Compute Residuals for Regression-Scale Models
rsm                     Fit a Regression-Scale Model
rsm.diag                Diagnostics for Regression-Scale Models
rsm.diag.plots          Diagnostic Plots for Regression-Scale Models
rsm.families            Generate a RSM Family Object
rsm.fit                 Fit a Regression-Scale Model Without Computing
                        the Model Matrix
rsm.null                Fit an Empty Regression-Scale Model
rsm.object              Regression-Scale Model Object
rsm.surv                Fit a Regression-Scale Model Without Computing
                        the Model Matrix
summary.marg            Summary Method for Objects of Class "marg"
summary.rsm             Summary Method for Regression-Scale Models
update.rsm              Update and Re-fit a RSM Model Call
vcov.rsm                Calculate Variance-Covariance Matrix for a
                        Fitted RSM Model


Datasets:
========
darwin                  Darwin's Data on Growth Rates of Plants
houses                  House Price Data
nuclear                 Nuclear Power Station Data
venice                  Sea Level Data
</pre>
<p>Further information is available in the following vignettes:
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>Rnews-paper</code> </td><td style="text-align: left;"> hoa: An R Package Bundle for Higher Order Likelihood Inference (source, pdf)</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>S original by Alessandra R. Brazzale &lt;alessandra.brazzale@unimore.it&gt;.
R port by Alessandra R. Brazzale &lt;alessandra.brazzale@unimore.it&gt;, following
earlier work by Douglas Bates.
</p>
<p>Maintainer: Alessandra R. Brazzale &lt;alessandra.brazzale@unimore.it&gt;
</p>

<hr>
<h2 id='anova.rsm'>ANOVA Table for a RSM Object</h2><span id='topic+anova.rsm'></span>

<h3>Description</h3>

<p>This is a method for the function <code>anova()</code> for objects 
inheriting from class <code>rsm</code>.  See <code><a href="stats.html#topic+anova">anova</a></code> 
for the general behaviour of this function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rsm'
anova(object, ..., test = c("Chisq", "none"))
</code></pre>


<h3>Details</h3>

<p>When called with a single <code>rsm</code> object, <code>anova.rsm</code> 
may take a while to run, because it fully iterates a series of 
<code>rsm</code> models.  The series is constructed by successively 
adding to the null model all the terms in <code>object</code>, taken 
in the order they appear in <code>terms(object)</code>.  
</p>


<h3>Note</h3>

<p>For each term minus twice the log likelihood is returned instead
of the residual sum of squares.  The degrees of freedom change 
according to whether the scale parameter is known or not.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+anova">anova</a></code>, <code><a href="#topic+rsm.object">rsm.object</a></code>, 
<code><a href="#topic+rsm">rsm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Sea Level Data
data(venice)
attach(venice)
Year &lt;- 1:51/51
c11 &lt;- cos(2*pi*1:51/11) ; s11 &lt;- sin(2*pi*1:51/11)
c19 &lt;- cos(2*pi*1:51/18.62) ; s19 &lt;- sin(2*pi*1:51/18.62)
venice.p &lt;- rsm(sea ~ Year + I(Year^2) + c11 + s11 + c19 + s19, 
                family = extreme)
anova(venice.p)
##
venice.l &lt;- rsm(sea ~ Year + I(Year^2), family = extreme)
anova(venice.p, venice.l)
##
detach()

## House Price Data
data(houses)
houses.rsm &lt;- rsm(price ~ ., family = student(5), data = houses)
anova(houses.rsm)
</code></pre>

<hr>
<h2 id='anova.rsmlist'>
Use anova() on a &ldquo;rsmlist&rdquo; object
</h2><span id='topic+anova.rsmlist'></span>

<h3>Description</h3>

<p>This is a method for the function <code>anova()</code> for objects
inheriting from class <code>rsmlist</code>.  See 
<code><a href="stats.html#topic+anova">anova</a></code> and <code><a href="#topic+anova.rsm">anova.rsm</a></code> for the 
general behaviour of this function and for the interpretation of the 
arguments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> 
## S3 method for class 'rsmlist'
anova(object, ..., test = c("Chisq", "none"))
</code></pre>


<h3>See Also</h3>

<p><code><a href="#topic+anova.rsm">anova.rsm</a></code>, <code><a href="stats.html#topic+anova">anova</a></code>
</p>

<hr>
<h2 id='cond'>
Approximate Conditional Inference - Generic Function
</h2><span id='topic+cond'></span>

<h3>Description</h3>

<p>Performs approximate conditional inference.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cond(object, offset, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cond_+3A_object">object</code></td>
<td>

<p>a fitted model object.  Families supported are binomial and 
Poisson with canonical link function (class <code>glm</code>), and 
regression-scale models (class <code>rsm</code>).  
</p>
</td></tr>
<tr><td><code id="cond_+3A_offset">offset</code></td>
<td>

<p>the covariate occurring in the model formula whose coefficient
represents the parameter of interest.  May be numerical or a 
two-level factor.  In case of a two-level factor, it must be 
coded by contrasts and not appear as two dummy variables in the 
model.  Can also be a call to a mathematical function (such as 
<code>exp</code>, <code>sin</code>, ...) or to a mathematical 
operator (<code>\^</code>, <code>/</code>, ...) applied to a 
numerical variable.  The call must always agree with the label 
used to identify the corresponding parameter in the fitted model 
object passed through the <code>object</code> argument.  Beware that 
the label includes the identity function <code>I()</code> if an 
arithmetic operator was used.  Other function types (e.g. 
<code>factor</code>) and interactions are not admitted.
</p>
</td></tr>
<tr><td><code id="cond_+3A_...">...</code></td>
<td>

<p>absorbs any additional arguments.  See <code><a href="cond.html#topic+cond.glm">cond.glm</a></code> 
and <code><a href="#topic+cond.rsm">cond.rsm</a></code> for details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is generic (see <code><a href="utils.html#topic+methods">methods</a></code>); method
functions can be written to handle specific classes of data.  
Classes which already have methods for this function include: 
<code>glm</code> and <code>rsm</code>. 
</p>


<h3>Value</h3>

<p>The returned value is an <em>approximate conditional inference</em>
object.  Classes already supported are <code>cond</code> and 
<code>marg</code> depending on whether the fitted model object passed 
through the <code>object</code> argument has class <code>glm</code> or 
<code>rsm</code>.  See <code><a href="cond.html#topic+cond.object">cond.object</a></code> or 
<code><a href="#topic+marg.object">marg.object</a></code> for more details.
</p>


<h3>References</h3>

<p>Brazzale, A. R. (2000) <em>Practical Small-Sample Parametric 
Inference</em>.  Ph.D. Thesis N. 2230, Department of Mathematics, Swiss 
Federal Institute of Technology Lausanne.  Chapter 6.
</p>


<h3>See Also</h3>

<p><code><a href="cond.html#topic+cond.glm">cond.glm</a></code>, <code><a href="#topic+cond.rsm">cond.rsm</a></code>, 
<code><a href="cond.html#topic+cond.object">cond.object</a></code>, <code><a href="#topic+marg.object">marg.object</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Urine Data 
## Not run: 
data(urine)
urine.glm &lt;- glm(r ~ gravity + ph + osmo + cond + urea + log(calc), 
                 family = binomial, data = urine)
##
## function call as offset variable 
labels(coef(urine.glm))
cond(urine.glm, log(calc))
##
## large estimate of regression coefficient
urine.glm &lt;- glm(r ~ gravity + ph + osmo + cond + urea + calc, 
                 family = binomial, data = urine)
coef(urine.glm)
urine.glm &lt;- glm(r ~ I(gravity * 100) + ph + osmo + cond + urea + calc, 
                 family = binomial, data = urine)
coef(urine.glm)
urine.cond &lt;- cond(urine.glm, I(gravity * 100))
plot(urine.cond, which = 4)

## End(Not run)

## House Price Data
data(houses)
houses.rsm &lt;- rsm(price ~ ., family = student(5), data = houses)
##
## parameter of interest: scale parameter
houses.marg &lt;- cond(houses.rsm, scale)
plot(houses.marg, which = 2)
</code></pre>

<hr>
<h2 id='cond.rsm'>
Approximate Conditional Inference in Regression-Scale Models
</h2><span id='topic+cond.rsm'></span>

<h3>Description</h3>

<p>Performs approximate conditional inference on a scalar parameter of 
interest in regression-scale models.  The output is stored in an 
object of class <code>marg</code>. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rsm'
cond(object, offset, formula = NULL, family = NULL, 
     dispersion = NULL, data = sys.frame(sys.parent()), pts = 20, 
     n = max(100, 2*pts), tms = 0.6, from = NULL, to = NULL, 
     control = glm.control(...), trace = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cond.rsm_+3A_object">object</code></td>
<td>

<p>a <code>rsm</code> object; for instance the result of a call to 
<code><a href="#topic+rsm">rsm</a></code>.
</p>
</td></tr>
<tr><td><code id="cond.rsm_+3A_offset">offset</code></td>
<td>

<p>either the covariate occurring in the model formula whose 
coefficient represents the parameter of interest or <code>scale</code> 
if the parameter of interest is the scale parameter.  In the first 
case, the variable may be numerical or a two-level factor.  In case
of a two-level factor, it must be coded by contrasts and not as two
dummy variables.  Can also be a call to a mathematical function 
(such as <code>exp</code>, <code>sin</code>, ...) or to a mathematical 
operator (<code>^</code>, <code>/</code>, ...) applied to a numerical 
variable.  The call must always agree with the label used to identify
the corresponding parameter in the <code>rsm</code> object passed through
the <code>object</code> argument or defined by <code>formula</code> and 
<code>family</code>.  Beware that the label includes the identity 
function <code>I()</code> if an arithmetic operator was used.  Other 
function types (e.g. <code>factor</code>) and interactions are not 
admitted.  If interest focuses on the scale parameter, it must not
be fixed in <code>object</code> or when using the <code>dispersion</code> 
argument in case no <code>rsm</code> object is supplied. 
</p>
</td></tr>
<tr><td><code id="cond.rsm_+3A_formula">formula</code></td>
<td>

<p>a formula expression (only if no <code>rsm</code> object is defined).
</p>
</td></tr>
<tr><td><code id="cond.rsm_+3A_family">family</code></td>
<td>

<p>a <code>family.rsm</code> object defining the error distribution (only if
no <code>rsm</code> object is defined).  See <code><a href="#topic+rsm.families">rsm.families</a></code> 
for the families supported. 
</p>
</td></tr>
<tr><td><code id="cond.rsm_+3A_dispersion">dispersion</code></td>
<td>

<p>argument only to be used if no <code>rsm</code> object is defined.  If 
<code>NULL</code>, the scale parameter is taken to be unknown.  If known,
the numerical value can be passed.  The default is <code>NULL</code>.  
Huber's least favourable error distribution represents a special 
case.  If <code>dispersion</code> is <code>NULL</code>,  the maximum likelihood
estimate is computed, while if <code>TRUE</code> the <abbr><span class="acronym">MAD</span></abbr> 
estimate is calculated and the scale parameter fixed to this value
in subsequent computations.
</p>
</td></tr>
<tr><td><code id="cond.rsm_+3A_data">data</code></td>
<td>

<p>an optional data frame in which to interpret the variables 
occurring in the formula (only if no <code>rsm</code> object is defined).
</p>
</td></tr>
<tr><td><code id="cond.rsm_+3A_pts">pts</code></td>
<td>

<p>number of output points (minimum 10) that are calculated exactly; 
the default is 20. 
</p>
</td></tr>
<tr><td><code id="cond.rsm_+3A_n">n</code></td>
<td>

<p>approximate number of output points (minimum 50) produced by the 
spline interpolation.  The default is the maximum between 100 and 
twice <code>pts</code>.
</p>
</td></tr>
<tr><td><code id="cond.rsm_+3A_tms">tms</code></td>
<td>

<p>defines the range <abbr><span class="acronym">MLE</span></abbr> +/- <code>tms</code> * <abbr><span class="acronym">s.e.</span></abbr> 
where cubic spline interpolation is replaced by polynomial 
interpolation.  The default is 0.6.
</p>
</td></tr>
<tr><td><code id="cond.rsm_+3A_from">from</code></td>
<td>

<p>starting value of the sequence that contains the values of the 
parameter of interest for which output points are calculated 
exactly.  The default is <abbr><span class="acronym">MLE</span></abbr> - 3.5 * <abbr><span class="acronym">s.e.</span></abbr>
</p>
</td></tr>
<tr><td><code id="cond.rsm_+3A_to">to</code></td>
<td>

<p>ending value of the sequence that contains the values of the 
parameter of interest for which output points are calculated 
exactly.  The default is <abbr><span class="acronym">MLE</span></abbr> + 3.5 * <abbr><span class="acronym">s.e</span></abbr>.
</p>
</td></tr>
<tr><td><code id="cond.rsm_+3A_control">control</code></td>
<td>

<p>a list of iteration and algorithmic constants that control the 
<code>rsm</code> fit.  See <code><a href="stats.html#topic+glm.control">glm.control</a></code> for their names and
default values.  
</p>
</td></tr>
<tr><td><code id="cond.rsm_+3A_trace">trace</code></td>
<td>

<p>if <code>TRUE</code>, iteration numbers will be printed.
</p>
</td></tr>
<tr><td><code id="cond.rsm_+3A_...">...</code></td>
<td>

<p>additional arguments, such as <code>weights</code>, <code>subset</code>, 
<code>control</code> etc. used by the <code>rsm</code> fitting routine if the 
<code>rsm</code> object is defined through <code>formula</code> and
<code>family</code>.  See <code><a href="#topic+rsm">rsm</a></code> for their definition and use.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is a method for the generic function <code><a href="#topic+cond">cond</a></code>
for class <code>rsm</code>.  It can be invoked by calling <code>cond</code> for 
an object of the appropriate class, or directly by calling 
<code>cond.rsm</code> regardless of the class of the object.  
<code>cond.rsm</code> has also to be used if the <code>rsm</code> object is not 
provided throught the <code>object</code> argument but specified by 
<code>formula</code> and <code>family</code>.
</p>
<p>The function <code>cond.rsm</code> implements several small sample 
asymptotic methods for approximate conditional inference in 
regression-scale models.  Approximations for both the modified/marginal 
log likelihood function and approximate conditional/marginal tail 
probabilities are 
available (see <code><a href="#topic+marg.object">marg.object</a></code> for details).  Attention is
restricted to a scalar parameter of interest, either a regression 
coefficient or the scale parameter.  In the first case, the 
associated covariate may be either numerical or a two-level factor. 
</p>
<p>Approximate conditional (or equivalently marginal) inference is performed 
by either updating a 
fitted regression-scale model or defining the model formula and 
family.  All approximations are calculated exactly for <code>pts</code> 
equally spaced points ranging from <code>from</code> to <code>to</code>.  A 
spline interpolation is used to extend them over the whole interval 
of interest, except for the range of values defined by <abbr><span class="acronym">MLE</span></abbr>
+/- <code>tms</code> * <abbr><span class="acronym">s.e.</span></abbr> where the spline interpolation is 
replaced by a higher order polynomial interpolation.  This is done 
in order to avoid numerical instabilities which are likely to occur
for values of the parameter of interest close to the <abbr><span class="acronym">MLE</span></abbr>.  
Results 
are stored in an object of class <code>marg</code>.  Method functions 
like <code><a href="base.html#topic+print">print</a></code>, <code><a href="base.html#topic+summary">summary</a></code> and 
<code><a href="graphics.html#topic+plot">plot</a></code> can be used to examine the output or 
represent it graphically.  Components can be extracted using 
<code><a href="stats.html#topic+coef">coef</a></code>, <code><a href="stats.html#topic+formula">formula</a></code> and 
<code><a href="stats.html#topic+family">family</a></code>.
</p>
<p>Main references for the methods considered are the papers by 
<cite>Barndorff-Nielsen (1991)</cite>, <cite>DiCiccio, Field and Fraser 
(1990)</cite> and <cite>DiCiccio and Field (1991)</cite>.  The theory and 
statistics used are summarized in <cite>Brazzale (2000, Chapters 2 
and 3)</cite>.  More details of the implementation are given in 
<cite>Brazzale (1999; 2000, Section 6.3.1)</cite>.
</p>


<h3>Value</h3>

<p>The returned value is an object of class <code>marg</code>; see 
<code><a href="#topic+marg.object">marg.object</a></code> for details.
</p>


<h3>Note</h3>

<p>If the parameter of interest is the scale parameter, all calculations
are performed on the logarithmic scale, though most results are 
reported on the original scale.  
</p>
<p>In rare occasions, <code>cond.rsm</code> dumps because of non-convergence 
of the function <code><a href="#topic+rsm">rsm</a></code> which is used to refit the model 
for a fixed value of the parameter of interest.  This happens for 
instance if this value is too extreme.  The arguments <code>from</code> 
and <code>to</code> may then be used to limit the default range of 
<abbr><span class="acronym">MLE</span></abbr> +/- 3.5 * <abbr><span class="acronym">s.e.</span></abbr>  A further possibility is to
fine-tuning the constants (number of iterations, convergence
threshold) that control the <code>rsm</code> fit through the 
<code>control</code> argument. 
</p>
<p><code>cond.rsm</code> may also dump if the estimate of the parameter of 
interest is large (tipically &gt; 400) in absolute value.  This may be 
avoided by reparametrizing the model.
</p>


<h3>References</h3>

<p>Barndorff-Nielsen, O. E. (1991) Modified signed log likelihood ratio.
<em>Biometrika</em>, <b>78</b>, 557&ndash;564.
</p>
<p>Brazzale, A. R. (1999) Approximate conditional inference for logistic
and loglinear models.  <em>J. Comput. Graph. Statist.</em>, <b>8</b>,
653&ndash;661.
</p>
<p>Brazzale, A. R. (2000) <em>Practical Small-Sample Parametric 
Inference</em>.  Ph.D. Thesis N. 2230, Department of Mathematics, Swiss
Federal Institute of Technology Lausanne.
</p>
<p>DiCiccio, T. J., Field, C. A. and Fraser, D. A. S. (1990) 
Approximations of marginal tail probabilities and inference for 
scalar parameters.  <em>Biometrika</em>, <b>77</b>, 77&ndash;95.
</p>
<p>DiCiccio, T. J. and Field, C. A. (1991) An accurate method for
approximate conditional and Bayesian inference about linear 
regression models from censored data.  <em>Biometrika</em>, <b>78</b>,
903&ndash;910.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+marg.object">marg.object</a></code>, <code><a href="#topic+summary.marg">summary.marg</a></code>,
<code><a href="#topic+plot.marg">plot.marg</a></code>, <code><a href="#topic+rsm">rsm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Sea Level Data
data(venice)
attach(venice)
Year &lt;- 1:51/51
c11 &lt;- cos(2*pi*1:51/11) ; s11 &lt;- sin(2*pi*1:51/11)
c19 &lt;- cos(2*pi*1:51/18.62) ; s19 &lt;- sin(2*pi*1:51/18.62)
##
## quadratic model fitted to the sea level, includes 18.62-year 
## astronomical tidal cycle and 11-year sunspot cycle
venice.rsm &lt;- rsm(sea ~ Year + I(Year^2) + c11 + s11 + c19 + s19, 
                  family = extreme)
names(coef(venice.rsm))
## "(Intercept)"  "Year"  "I(Year^2)"  "c11"  "s11"  "c19"  "s19"      
##
## variable of interest: quadratic term
venice.marg &lt;- cond(venice.rsm, I(Year^2))
##
detach()

## House Price Data
data(houses)
houses.rsm &lt;- rsm(price ~ ., family = student(5), data = houses)
##
## parameter of interest: scale parameter
houses.marg &lt;- cond(houses.rsm, scale)
</code></pre>

<hr>
<h2 id='darwin'>Darwin's Data on Growth Rates of Plants</h2><span id='topic+darwin'></span>

<h3>Description</h3>

<p>The <code>darwin</code> data frame has 15 rows and 3 columns.
</p>
<p>Charles Darwin conducted an experiment to examine the superiority of
cross-fertilized plants over self-fertilized plants.  15 pairs of
plants were used. Each pair consisted of one cross-fertilized plant
and one self-fertilized plant which germinated at the same time and
grew in the same pot. The heights of the plants were measured at a
fixed time after planting.  Four different pots were used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(darwin)</code></pre>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt><code>cross</code></dt><dd> 
<p>the heights of the cross-fertilized plants (in inches);
</p>
</dd>
<dt><code>self</code></dt><dd>  
<p>the heights of the self-fertilized plants (in inches);
</p>
</dd>
<dt><code>pot</code></dt><dd>   
<p>a factor variable for the pot number.
</p>
</dd>
</dl>



<h3>Source</h3>

<p>The data were obtained from
</p>
<p>Andrews, D. F. and Herzberg, A. M. (1985) <em>Data: A Collection 
of Problems From Many Fields for the Student and Research Worker</em> 
(Chapter 2).  New York: Springer-Verlag.  
</p>


<h3>References</h3>

<p>Darwin, C. (1878) <em>The Effects of Cross and Self Fertilisation 
in the Vegetable Kingdom </em> (2nd ed.).  London: John Murray.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(darwin)
plot(cross - self ~ pot, data = darwin)
</code></pre>

<hr>
<h2 id='family.rsm'>
Use family() on a &ldquo;rsm&rdquo; object
</h2><span id='topic+family.rsm'></span>

<h3>Description</h3>

<p>This is a method for the function <code>family()</code> for objects 
from which a <code>family.rsm</code> object can be extracted.  Typically 
a fitted <code>rsm</code> model object.  See <code><a href="stats.html#topic+family">family</a></code> for 
the general behaviour of this function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rsm'
family(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="family.rsm_+3A_object">object</code></td>
<td>

<p>any object from which a <code>family.rsm</code> object can be extracted.   
</p>
</td></tr>
<tr><td><code id="family.rsm_+3A_...">...</code></td>
<td>

<p>absorbs any additional argument.  
</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+family.rsm.object">family.rsm.object</a></code>, <code><a href="stats.html#topic+family">family</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Sea Level Data
data(venice)
attach(venice)
Year &lt;- 1:51/51
c11 &lt;- cos(2*pi*1:51/11) ; s11 &lt;- sin(2*pi*1:51/11)
c19 &lt;- cos(2*pi*1:51/18.62) ; s19 &lt;- sin(2*pi*1:51/18.62)
venice.rsm &lt;- rsm(sea ~ Year + I(Year^2) + c11 + s11 + c19 + s19, 
                  family = extreme)
family(venice.rsm)
detach()

## House Price Data
data(houses)
houses.rsm &lt;- rsm(price ~ ., family = student(5), data = houses)
family(houses.rsm)
</code></pre>

<hr>
<h2 id='family.rsm.object'>
Family Object for Regression-Scale Models
</h2><span id='topic+family.rsm.object'></span>

<h3>Description</h3>

<p>Class of objects that characterize the error distribution of a
regression-scale model.
</p>


<h3>Generation</h3>

<p>This class of objects is returned by a call to a <code>family.rsm</code> 
generator function.  See <code><a href="#topic+rsm.families">rsm.families</a></code> for the 
distributions which are supported by the <code>marg</code> package.  The 
object includes a list of functions and expressions that 
characterize the error distribution of a regression-scale model.  
These are used by the <abbr><span class="acronym">IRLS</span></abbr> algorithm implemented in the 
<code>rsm</code> fitting routine.  New families can be added to the 
ones already supported.  See the demonstration file 
&lsquo;<span class="file">margdemo.R</span>&rsquo; that ships with the package.  There is a 
<code>print</code> method for <code>family.rsm</code> objects which 
produces a simple summary without any detail; use 
<code>unclass(family.rsm.object)</code> to see the contents.
</p>


<h3>Structure</h3>

<p>The following components, with the corresponding functionality,
are required for a <code>family.rsm</code> object:
</p>

<dl>
<dt><code>family</code></dt><dd>
<p>a character vector giving the family name.
</p>
</dd> 
<dt><code>g0</code></dt><dd>
<p>a function that yields minus the log density of the error 
distribution in the regression-scale model.
</p>
</dd>
<dt><code>g1</code></dt><dd>
<p>a function that yields the first derivative of minus the 
log density.
</p>
</dd>
<dt><code>g2</code></dt><dd>
<p>a function that yields the second derivative of minus the 
log density.
</p>
</dd>
<dt><code>df</code></dt><dd>
<p>argument with <code>NULL</code> value; must be included to guarantee
compatibility with the existing code.
</p>
</dd>
<dt><code>k</code></dt><dd>
<p>argument with <code>NULL</code> value; must be included to guarantee
compatibility with the existing code.
</p>
</dd>
</dl>



<h3>Note</h3>

<p>For the sake of compatibility, the <code>g0</code>, <code>g1</code> and 
<code>g2</code> functions of a user-defined family can only take two 
arguments: <code>y</code> representing an observation and the 
<code>...</code> argument which absorbes any additional arguments.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rsm.families">rsm.families</a></code>, <code><a href="#topic+family.rsm">family.rsm</a></code>, 
<code><a href="#topic+rsm">rsm</a></code>
</p>

<hr>
<h2 id='houses'>House Price Data</h2><span id='topic+houses'></span>

<h3>Description</h3>

<p>The <code>houses</code> data frame has 26 rows and 5 columns.
</p>
<p>Ms. Terry Tasch of Long-Kogan Realty, Chicago, provides data on 
the selling prices of houses and on different variables describing
their status.  This data frame contains the prices and a subset
of the covariates.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(houses)</code></pre>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt><code>price</code></dt><dd>
<p>selling price (in thousands of dollars);
</p>
</dd>
<dt><code>bdroom</code></dt><dd>
<p>number of bedrooms;
</p>
</dd>
<dt><code>floor</code></dt><dd>
<p>floor space (in square feet);
</p>
</dd>
<dt><code>rooms</code></dt><dd>
<p>total number of rooms;
</p>
</dd>
<dt><code>front</code></dt><dd>
<p>front footage of lot (in feet).
</p>
</dd>
</dl>



<h3>Source</h3>

<p>The data were obtained from
</p>
<p>Sen, A. and Srivastava, M. (1990) <em>Regression Analysis: Theory,
Methods and Applications</em> (Exhibit 2.2, page 32).  New York:
Springer-Verlag.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(houses)
summary(houses)
pairs(houses)
</code></pre>

<hr>
<h2 id='Huber'>
Huber's Least Favourable Distribution
</h2><span id='topic+dHuber'></span><span id='topic+pHuber'></span><span id='topic+qHuber'></span><span id='topic+rHuber'></span>

<h3>Description</h3>

<p>Density, cumulative distribution, quantiles and random number 
generator for Huber's least favourable distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dHuber(x, k = 1.345)
pHuber(q, k = 1.345)
qHuber(p, k = 1.345)
rHuber(n, k = 1.345)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Huber_+3A_x">x</code></td>
<td>

<p>vector of quantiles.  Missing values (<code>NA</code>s) are allowed.
</p>
</td></tr>
<tr><td><code id="Huber_+3A_q">q</code></td>
<td>

<p>vector of quantiles.  Missing values (<code>NA</code>s) are allowed.
</p>
</td></tr>
<tr><td><code id="Huber_+3A_p">p</code></td>
<td>

<p>vector of probabilities.  Missing values (<code>NA</code>s) are allowed.
</p>
</td></tr>
<tr><td><code id="Huber_+3A_n">n</code></td>
<td>

<p>sample size.  If <code>length(n)</code> is larger than 1, then
<code>length(n)</code> random values are returned.
</p>
</td></tr>
<tr><td><code id="Huber_+3A_k">k</code></td>
<td>

<p>tuning constant.  Values should preferably lie between 1 and 1.5.
The default is 1.345, which gives 95% efficiency at the Normal.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Inversion of the cumulative distribution function is used to
generate deviates from Huber's least favourable distribution. 
</p>


<h3>Value</h3>

<p>Density (<code>dHuber</code>), probability (<code>pHuber</code>), 
quantile (<code>qHuber</code>), or random sample (<code>rHuber</code>) 
for Huber's least favourable distribution with tuning constant 
<code>k</code>.  If values are missing, <code>NA</code>s will be returned.
</p>


<h3>Side Effects</h3>

<p>The function <code>rHuber</code> causes creation of the dataset 
<code>.Random.seed</code> if it does not already exist; otherwise its 
value is updated.
</p>


<h3>Background</h3>

<p>Huber's least favourable distribution is a compound distribution 
with gaussian behaviour in the interval (-<code>k</code>,<code>k</code>) and 
double exponential tails.  It is strongly related to Huber's 
M-estimator, which represents the maximum likelihood estimator of 
the location parameter.
</p>


<h3>References</h3>

<p>Hampel, F. R., Ronchetti, E. M., Rousseeuw, P. J. and Stahel, W. A. 
(1986) <em>Robust Statistics: The Approach Based on Influence 
Functions</em>.  New York: Wiley.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pHuber(0.5)
## 0.680374
pHuber(0.5, k = 1.5)
## 0.6842623
</code></pre>

<hr>
<h2 id='logLik.rsm'>
Compute the Log Likelihood for Regression-Scale Models
</h2><span id='topic+logLik.rsm'></span>

<h3>Description</h3>

<p>Computes the log likelihood for regression-scale models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rsm'
logLik(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logLik.rsm_+3A_object">object</code></td>
<td>

<p>an object inheriting from class <code>rsm</code> representing a fitted
regression-scale model.
</p>
</td></tr>
<tr><td><code id="logLik.rsm_+3A_...">...</code></td>
<td>

<p>absorbs any additional argument.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a method for the function <code>logLik()</code> for objects
inheriting from class <code>rsm</code>.  
</p>


<h3>Value</h3>

<p>Returns an object class <code>logLik</code> which is a number
with attributes, <code>attr(r, "df")</code> (degrees of freedom) 
giving the number of parameters (regression coefficients plus
scale parameter, if not fixed) in the model.  
</p>


<h3>Note</h3>

<p>The default
<code>print</code> method for <code>logLik</code> objects is used.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rsm.object">rsm.object</a></code>, <code><a href="stats.html#topic+logLik">logLik</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Sea Level Data
data(venice)
attach(venice)
Year &lt;- 1:51/51
c11 &lt;- cos(2*pi*1:51/11) ; s11 &lt;- sin(2*pi*1:51/11)
c19 &lt;- cos(2*pi*1:51/18.62) ; s19 &lt;- sin(2*pi*1:51/18.62)
venice.rsm &lt;- rsm(sea ~ Year + I(Year^2) + c11 + s11 + c19 + s19, 
                  family = extreme)
##
logLik(venice.rsm)
detach()
</code></pre>

<hr>
<h2 id='make.family.rsm'>
Support for RSM Family Functions
</h2><span id='topic+make.family.rsm'></span>

<h3>Description</h3>

<p>This is support for the functions <code><a href="#topic+family.rsm">family.rsm</a></code>, 
<code><a href="#topic+extreme">extreme</a></code>, <code><a href="#topic+Huber">Huber</a></code>, <code><a href="#topic+logistic">logistic</a></code>,  
<code><a href="#topic+logWeibull">logWeibull</a></code> and <code><a href="#topic+student">student</a></code>.  It is not intended to 
be called directly by users.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make.family.rsm(name, arg, ...)
</code></pre>

<hr>
<h2 id='marg.object'>
Approximate Marginal Inference Object
</h2><span id='topic+marg.object'></span>

<h3>Description</h3>

<p>Class of objects returned when performing approximate conditional
inference for regression-scale models.
</p>


<h3>Arguments</h3>

<p>Objects of class <code>marg</code> are implemented as a list.  The 
following components are included: 
</p>
<table>
<tr><td><code id="marg.object_+3A_workspace">workspace</code></td>
<td>

<p>a list whose elements are the spline interpolations of several 
first order and higher order statistics. They are used to 
implement the following likelihood quantities:
</p>
<p>- the profile and modified profile/approximate marginal log 
likelihoods;
</p>
<p>- the Wald pivots from the unconditional and 
conditional/approximate marginal <abbr><span class="acronym">MLE</span></abbr>s;
</p>
<p>- the profile and modified/approximate marginal likelihood roots;
</p>
<p>- the conditional/approximate marginal Lugannani-Rice tail area
approximation;
</p>
<p>- the correction term used in the higher order statistics;
</p>
<p>- the conditional/marginal information and nuisance parameter 
aspects.
</p>
<p>Method functions work mainly on this part of the object.  In order
to avoid errors in the calculation of confidence intervals and 
tail probabilities, this part of the object should not be 
modified.
</p>
</td></tr>
<tr><td><code id="marg.object_+3A_coefficients">coefficients</code></td>
<td>

<p>a <code class="reqn">2\times 2</code> matrix containing the unconditional and 
approximate conditional/marginal <abbr><span class="acronym">MLE</span></abbr>s and their 
standard errors.
</p>
</td></tr>
<tr><td><code id="marg.object_+3A_call">call</code></td>
<td>

<p>the function call that created the <code>marg</code> object.
</p>
</td></tr>
<tr><td><code id="marg.object_+3A_formula">formula</code></td>
<td>

<p>the model formula.
</p>
</td></tr>
<tr><td><code id="marg.object_+3A_family">family</code></td>
<td>

<p>the name of the error distribution.
</p>
</td></tr>
<tr><td><code id="marg.object_+3A_offset">offset</code></td>
<td>

<p>the covariate occurring in the model formula whose coefficient 
represents the parameter of interest or <code>scale</code> if the 
parameter of interest is the scale parameter.
</p>
</td></tr>
<tr><td><code id="marg.object_+3A_diagnostics">diagnostics</code></td>
<td>

<p>diagnostics related to the decomposition of the higher order
adjustments into an information and a nuisance parameters term. 
</p>
</td></tr>
<tr><td><code id="marg.object_+3A_n.approx">n.approx</code></td>
<td>

<p>the number of output points for which the statistics have been 
calculated exactly. 
</p>
</td></tr>
<tr><td><code id="marg.object_+3A_omitted.val">omitted.val</code></td>
<td>

<p>the range of values omitted in the spline interpolation of some
of the higher order statistics considered.  The aim is to avoid 
numerical instabilities around the maximum likelihood estimate.
</p>
</td></tr>
<tr><td><code id="marg.object_+3A_is.scalar">is.scalar</code></td>
<td>

<p>a logical value indicating whether there are any nuisance 
parameters.  If <code>FALSE</code> there are none.
</p>
</td></tr>
</table>
<p>Main references for the methods considered are the papers by 
<cite>Barndorff-Nielsen (1991)</cite>, <cite>DiCiccio, Field and Fraser 
(1990)</cite> and <cite>DiCiccio and Field (1991)</cite>.  The theory and 
statistics used are summarized in <cite>Brazzale (2000, Chapters 2 
and 3)</cite>.  More details of the implementation and of the methods  
considered are given in <cite>Brazzale (1999; 2000, Section 6.3.1)</cite>.
</p>


<h3>Generation</h3>

<p>This class of objects is returned from calls to the function 
<code><a href="#topic+cond.rsm">cond.rsm</a></code>. 
</p>


<h3>Methods</h3>

<p>The class <code>marg</code> has methods for <code><a href="base.html#topic+summary">summary</a></code>, 
<code><a href="graphics.html#topic+plot">plot</a></code>, <code><a href="base.html#topic+print">print</a></code>, 
<code><a href="stats.html#topic+coef">coef</a></code> and <code><a href="stats.html#topic+family">family</a></code>, among 
others.
</p>


<h3>Note</h3>

<p>If the parameter of interest is the scale parameter, all 
calculations are performed on the logarithmic scale, though most 
results are reported on the original scale.  
</p>


<h3>References</h3>

<p>Barndorff-Nielsen, O. E. (1991)  Modified signed log likelihood 
ratio.  <em>Biometrika</em>, <b>78</b>, 557&ndash;564.
</p>
<p>Brazzale, A. R. (1999) Approximate conditional inference for 
logistic and loglinear models.  <em>J. Comput. Graph. Statist.</em>, 
<b>8</b>, 653&ndash;661.
</p>
<p>Brazzale, A. R. (2000) <em>Practical Small-Sample Parametric
Inference</em>. Ph.D. Thesis N. 2230, Department of Mathematics, Swiss
Federal Institute of Technology Lausanne. 
</p>
<p>DiCiccio, T. J., Field, C. A. and Fraser, D. A. S. (1990) 
Approximations of marginal tail probabilities and inference for 
scalar parameters.  <em>Biometrika</em>, <b>77</b>, 77&ndash;95.
</p>
<p>DiCiccio, T. J. and Field, C. A. (1991) An accurate method for
approximate conditional and Bayesian inference about linear 
regression models from censored data.  <em>Biometrika</em>, <b>78</b>,
903&ndash;910.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cond.rsm">cond.rsm</a></code>, <code><a href="#topic+summary.marg">summary.marg</a></code>,
<code><a href="#topic+plot.marg">plot.marg</a></code>
</p>

<hr>
<h2 id='nuclear'>Nuclear Power Station Data</h2><span id='topic+nuclear'></span>

<h3>Description</h3>

<p>This data frame contains data on the construction of 32 light water 
reactors constructed in the USA.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(nuclear)</code></pre>


<h3>Format</h3>

<p>A data frame with 32 observations on the following 11 variables.
</p>

<dl>
<dt><code>cost</code></dt><dd>
<p>cost of construction (in billions of dollars adjusted to a 1976
base)
</p>
</dd>
<dt><code>date</code></dt><dd>
<p>date at which the construction permit was issued
</p>
</dd>
<dt><code>T1</code></dt><dd>
<p>time between application for and issue of permit
</p>
</dd>
<dt><code>T2</code></dt><dd>
<p>time between issue of operating license and construction permit
</p>
</dd>
<dt><code>cap</code></dt><dd>
<p>power plant capacity (in MWe)
</p>
</dd>
<dt><code>PR</code></dt><dd>
<p><code>1</code> if light water reactor already present on site
</p>
</dd>
<dt><code>NE</code></dt><dd>
<p><code>1</code> if constructed in north-east region of USA
</p>
</dd>
<dt><code>CT</code></dt><dd>
<p><code>1</code> if cooling tower used
</p>
</dd>
<dt><code>BW</code></dt><dd>
<p><code>1</code> if nuclear steam supply system manufactured by 
Babcock-Wilcox
</p>
</dd>
<dt><code>N</code></dt><dd>
<p>cumulative number of power plants constructed by each 
architect-engineer
</p>
</dd>
<dt><code>PT</code></dt><dd>
<p><code>1</code> if partial turnkey plant
</p>
</dd>
</dl>



<h3>Source</h3>

<p>The data were obtained from
</p>
<p>Cox, D.R. and Snell, E.J. (1981).  <em>Applied Statistics</em> (page 81,
Example G).  Chapman and Hall, London. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(nuclear)
</code></pre>

<hr>
<h2 id='plot.marg'>
Generate Plots for an Approximate Marginal Inference Object
</h2><span id='topic+plot.marg'></span>

<h3>Description</h3>

<p>Creates a set of plots for an object of class <code>marg</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'marg'
plot(x = stop("nothing to plot"), from = x.axis[1], to = x.axis[n], 
     which = NULL, alpha = 0.05, add.leg = TRUE, loc.leg = FALSE, 
     add.labs = TRUE, cex = 0.7, cex.lab = 1, cex.axis = 1, 
     cex.main = 1, lwd1 = 1, lwd2 = 2, lty1 = "solid", 
     lty2 = "dashed", col1 = "black", col2 = "blue", tck = 0.02, 
     las = 1, adj = 0.5, lab = c(15, 15, 5), ...)           
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.marg_+3A_x">x</code></td>
<td>

<p>a <code>marg</code> object.  This is assumed to be the result returned 
by the <code><a href="#topic+cond.rsm">cond.rsm</a></code> function.
</p>
</td></tr>
<tr><td><code id="plot.marg_+3A_from">from</code></td>
<td>

<p>the starting value for the x-axis range.  The default value has 
been set by <code>cond.rsm</code>.
</p>
</td></tr>
<tr><td><code id="plot.marg_+3A_to">to</code></td>
<td>

<p>the ending value for the x-axis range.  The default value has been 
set by <code>cond.rsm</code>.
</p>
</td></tr>
<tr><td><code id="plot.marg_+3A_which">which</code></td>
<td>

<p>which plot to print.  Admissible values are <code>2</code> to <code>7</code> 
corresponding to the choices in the menu below.
</p>
</td></tr>
<tr><td><code id="plot.marg_+3A_alpha">alpha</code></td>
<td>

<p>the level used to read off confidence intervals; the default is 
5%.
</p>
</td></tr>
<tr><td><code id="plot.marg_+3A_add.leg">add.leg</code></td>
<td>

<p>if <code>TRUE</code>, a legend is added to each plot; default is 
<code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="plot.marg_+3A_loc.leg">loc.leg</code></td>
<td>

<p>if <code>TRUE</code>, the position of the legend can be located by hand; 
default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="plot.marg_+3A_add.labs">add.labs</code></td>
<td>

<p>if <code>TRUE</code>, labels are added; default is <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="plot.marg_+3A_cex">cex</code>, <code id="plot.marg_+3A_cex.lab">cex.lab</code>, <code id="plot.marg_+3A_cex.axis">cex.axis</code>, <code id="plot.marg_+3A_cex.main">cex.main</code></td>
<td>

<p>the character expansions relative to the standard size of the 
device to be used for printing text, labels, axes and main title. 
See <code><a href="graphics.html#topic+par">par</a></code> for details. 
</p>
</td></tr>
<tr><td><code id="plot.marg_+3A_lwd1">lwd1</code>, <code id="plot.marg_+3A_lwd2">lwd2</code></td>
<td>

<p>the line widths used to compare different curves in the same plot; 
default is <code>lwd2 = 2</code> for higher order solutions and 
<code>lwd1 = 1</code> for first order solutions.
</p>
</td></tr>
<tr><td><code id="plot.marg_+3A_lty1">lty1</code>, <code id="plot.marg_+3A_lty2">lty2</code></td>
<td>

<p>line type used to compare different curves in the same plot; 
default is <code>lty2 = "dashed"</code> for the Wald statistic and 
<code>lty1 = "solid"</code> for the remaining first and higher order 
statistics.
</p>
</td></tr>
<tr><td><code id="plot.marg_+3A_col1">col1</code>, <code id="plot.marg_+3A_col2">col2</code></td>
<td>

<p>colors used to compare different curves in the same plot; default 
is <code>col2 = "blue"</code> for higher order solutions, and 
<code>col1 = "black"</code> for the remaining first order statistics.
</p>
</td></tr>
<tr><td><code id="plot.marg_+3A_tck">tck</code>, <code id="plot.marg_+3A_las">las</code>, <code id="plot.marg_+3A_adj">adj</code>, <code id="plot.marg_+3A_lab">lab</code></td>
<td>

<p>further graphical parameters.  See <code><a href="graphics.html#topic+par">par</a></code> for 
details. 
</p>
</td></tr>
<tr><td><code id="plot.marg_+3A_...">...</code></td>
<td>

<p>optional graphical parameters; see <code><a href="graphics.html#topic+par">par</a></code> for 
details.  
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Several plots are produced for an object of class <code>marg</code>.  A 
menu lists all the plots that can be produced.  They may be one or 
all of the following ones:
</p>
<pre>
 Make a plot selection (or 0 to exit)

1: All
2: Profile and modified profile log likelihoods
3: Profile and modified profile likelihood ratios
4: Profile and modified likelihood root
5: Lugannani-Rice approximation
6: Confidence intervals
7: Diagnostics based on INF/NP decomposition

Selection:
  </pre>
<p>If no nuisance parameters are presented, a subset of the above 
pictures is produced.  A message is printed if this is the case.  
More details and examples are given in <cite>Brazzale (2000, 
Sections 6.5 and 5.3.2)</cite>.
</p>
<p>This function is a method for the generic function <code>plot()</code> for
class <code>marg</code>.  It can be invoked by calling <code>plot</code> or
directly <code>plot.marg</code> for an object of the appropriate class.
</p>


<h3>Value</h3>

<p>A plot is created on the current graphics device.
</p>


<h3>Side Effects</h3>

<p>The current device is cleared.  When <code>add.leg</code> is 
<code>TRUE</code>, a legend is added to each plot. Furthermore, if
<code>loc.leg</code> is <code>TRUE</code>, the location of the legend can
be set by the user.  All screens are closed, but not cleared, on 
termination of the function.
</p>


<h3>Note</h3>

<p>If the parameter of interest is the scale parameter, all calculations
are performed on the log scale, though most results are reported
on the original scale.  
</p>
<p>Four diagnostic plots are provided.
The two panels on the right trace the information and nuisance
correction terms, <abbr><span class="acronym">INF</span></abbr> and <abbr><span class="acronym">NP</span></abbr>, against the
likelihood root statistic.  These are generally smooth functions
and used to approximate the information and nuisance parameter
aspects as a function of the parameter of interest, as shown in the
two panels on the left.  This procedure has the advantage
of largely eliminating the numerical instabilities that affect the
statistics around the <abbr><span class="acronym">MLE</span></abbr>.  All four pictures are intended
to give an idea of the order of magnitude of the two correction
terms while trying to deal with the numerical problems that likely
occur for these kinds of data.
</p>
<p>More details can be found in <cite>Brazzale (2000, Appendix B.2)</cite>.  
</p>


<h3>References</h3>

<p>Brazzale, A. R. (2000) <em>Practical Small-Sample Parametric
Inference</em>.  Ph.D. Thesis N. 2230, Department of Mathematics, Swiss 
Federal Institute of Technology Lausanne.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cond.rsm">cond.rsm</a></code>, <code><a href="#topic+marg.object">marg.object</a></code>, 
<code><a href="#topic+summary.marg">summary.marg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Sea Level Data
data(venice)
attach(venice)
Year &lt;- 1:51/51
c11 &lt;- cos(2*pi*1:51/11) ; s11 &lt;- sin(2*pi*1:51/11)
c19 &lt;- cos(2*pi*1:51/18.62) ; s19 &lt;- sin(2*pi*1:51/18.62)
#
# quadratic model fitted to the sea level, includes 18.62-year 
# astronomical tidal cycle and 11-year sunspot cycle
venice.rsm &lt;- rsm(sea ~ Year + I(Year^2) + c11 + s11 + c19 + s19, 
                  family = extreme)
venice.marg &lt;- cond(venice.rsm, I(Year^2))
plot(venice.marg, which = 4)
##
detach()
</code></pre>

<hr>
<h2 id='print.family.rsm'>
Use print() on a &ldquo;family.rsm&rdquo; object
</h2><span id='topic+print.family.rsm'></span>

<h3>Description</h3>

<p>This is a method for the function <code>print()</code> for objects 
inheriting from class <code>family.rsm</code>.  See 
<code><a href="base.html#topic+print">print</a></code> or <code><a href="base.html#topic+print.default">print.default</a></code> for 
the general behaviour of this function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'family.rsm'
print(x, ...)
</code></pre>


<h3>Details</h3>

<p>A <code>family.rsm</code> object is a list of functions and expressions.  
All that is printed is an identification label.  To see the 
functions themselves, access the individual components, or use 
<code>print.default()</code> or <code>unclass()</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+family.rsm.object">family.rsm.object</a></code>, <code><a href="base.html#topic+print">print</a></code>,
<code><a href="base.html#topic+print.default">print.default</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>student(df = 3) ## generates Student's t error distribution family
## 
## g  :  function (y, df, ...)  (df + 1)/2 * log(1 + y^2/df)
## g' :  function (y, df, ...)  (df + 1) * y/(df + y^2)
## g'':  function (y, df, ...)  (df + 1) * (df - y^2)/(df + y^2)^2
##
## df : 3
unclass(student(df = 3))
## $family
## [1] "student"
##
## $g0
## function(y,df,...)  (df+1)/2*log(1+y^2/df)
##
## $g1
## function(y,df,...)  (df+1)*y/(df+y^2)
##
## $g2
## function(y,df,...)  (df+1)*(df-y^2)/(df+y^2)^2
##
## $df
## [1] 3
##
## $k
## NULL
</code></pre>

<hr>
<h2 id='print.marg'>
Use print() on a &ldquo;marg&rdquo; object
</h2><span id='topic+print.marg'></span>

<h3>Description</h3>

<p>This is a method for the function <code>print()</code> for objects 
inheriting from class <code>marg</code>. See <code><a href="base.html#topic+print">print</a></code> 
and <code><a href="base.html#topic+print.default">print.default</a></code> for the general behaviour of 
this function and for the interpretation of <code>digits</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'marg'
print(x, digits=max(3, getOption("digits")-3), ...)
## S3 method for class 'marg'
print(x, digits, ...)
</code></pre>


<h3>See Also</h3>

<p><code><a href="#topic+marg.object">marg.object</a></code>, <code><a href="base.html#topic+print">print</a></code>,
<code><a href="base.html#topic+print.default">print.default</a></code>
</p>

<hr>
<h2 id='print.rsm'>
Use print() on a &ldquo;rsm&rdquo; object
</h2><span id='topic+print.rsm'></span>

<h3>Description</h3>

<p>This is a method for the function <code>print()</code> for objects 
inheriting from class <code>rsm</code>. See <code><a href="base.html#topic+print">print</a></code> 
and <code><a href="base.html#topic+print.default">print.default</a></code> for the general behaviour of 
this function and for the interpretation of <code>digits</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rsm'
print(x, digits=max(3, getOption("digits")-3), ...)
## S3 method for class 'rsm'
print(x, digits, ...)
</code></pre>


<h3>See Also</h3>

<p><code><a href="#topic+rsm.object">rsm.object</a></code>, <code><a href="base.html#topic+print">print</a></code>,
<code><a href="base.html#topic+print.default">print.default</a></code>
</p>

<hr>
<h2 id='print.summary.marg'>
Use print() on a &ldquo;summary.marg&rdquo; object
</h2><span id='topic+print.summary.marg'></span>

<h3>Description</h3>

<p>This is a method for the function <code>print()</code> for objects of 
class <code>summary.marg</code>.  See <code><a href="base.html#topic+print">print</a></code> 
and <code><a href="base.html#topic+print.default">print.default</a></code> for the general behaviour of 
this function and for the interpretation of <code>digits</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.marg'
print(x, all = x$all, Coef = x$cf, int = x$int, test = x$hyp,
      digits = if(!is.null(x$digits)) x$digits else max(3, getOption("digits")-3),
      ...)
## S3 method for class 'summary.marg'
print(x, all, Coef, int, test, digits, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.summary.marg_+3A_x">x</code></td>
<td>

<p>a <code>summary.marg</code> object. This is assumed to be the result 
returned by the <code>summary.marg</code> function.
</p>
</td></tr>
<tr><td><code id="print.summary.marg_+3A_all">all</code></td>
<td>

<p>if <code>TRUE</code> all the information stored in the 
<code>summary.marg</code> object is printed, else only a subset of it.  
The default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="print.summary.marg_+3A_coef">Coef</code></td>
<td>

<p>if <code>TRUE</code> all parameter estimates are printed.  The default 
is <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="print.summary.marg_+3A_int">int</code></td>
<td>

<p>if <code>TRUE</code> confidence intervals are printed.  The default is 
<code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="print.summary.marg_+3A_test">test</code></td>
<td>

<p>if <code>TRUE</code> test statistics and tail probabilities are printed.
The default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="print.summary.marg_+3A_digits">digits</code></td>
<td>

<p>the number of significant digits to be printed.  The default 
depends on the value of <code>digits</code> set by <code>options</code>.
</p>
</td></tr>
<tr><td><code id="print.summary.marg_+3A_...">...</code></td>
<td>

<p>additional arguments.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Changing the default values of <code>all</code>, <code>Coef</code>, <code>int</code> 
and <code>test</code> allows only a subset of the information in the 
<code>summary.marg</code> object to be printed.  With <code>all = FALSE</code>, 
one-sided confidence intervals and the Lugannani-Rice tail area 
approximation are omitted.  See <code><a href="#topic+summary.marg">summary.marg</a></code> for more 
details.
</p>


<h3>Note</h3>

<p>If the parameter of interest is the scale parameter, all 
calculations are performed on the log scale, though most results 
are reported on the original scale.  
</p>
<p>The amount of information printed may vary depending on whether 
there are any nuisance parameters.  A message is printed if there 
are none.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+summary.marg">summary.marg</a></code>, <code><a href="#topic+marg.object">marg.object</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## House Price Data
data(houses)
houses.rsm &lt;- rsm(price ~ ., family = student(5), data = houses)
houses.cond &lt;- cond(houses.rsm, front)
print(summary(houses.cond), digits = 4)
print(summary(houses.cond), Coef = FALSE)
</code></pre>

<hr>
<h2 id='print.summary.rsm'>
Use print() on a &ldquo;summary.rsm&rdquo; object
</h2><span id='topic+print.summary.rsm'></span>

<h3>Description</h3>

<p>This is a method for the function <code>print()</code> for objects 
inheriting from class <code>summary.rsm</code>.  See 
<code><a href="base.html#topic+print">print</a></code> or <code><a href="base.html#topic+print.default">print.default</a></code> for 
the general behaviour of this function and for the interpretation 
of <code>x</code>, <code>digits</code>, <code>signif.stars</code> and <code>quote</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.rsm'
print(x, digits=max(3, getOption("digits")-3), 
      signif.stars = getOption("show.signif.stars"), quote=TRUE, ...)
## S3 method for class 'summary.rsm'
print(x, digits, signif.stars, quote = TRUE, ...)
</code></pre>


<h3>See Also</h3>

<p><code><a href="#topic+summary.rsm">summary.rsm</a></code>, <code><a href="base.html#topic+print">print</a></code>,
<code><a href="base.html#topic+print.default">print.default</a></code>
</p>

<hr>
<h2 id='residuals.rsm'>
Compute Residuals for Regression-Scale Models
</h2><span id='topic+residuals.rsm'></span>

<h3>Description</h3>

<p>Computes one of the six types of residuals available for 
regression-scale models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rsm'
residuals(object, type = c("deviance", "pearson", 
                           "response", "r.star", "prob", "deletion"),
          weighting = "observed", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="residuals.rsm_+3A_object">object</code></td>
<td>

<p>an object inheriting from class <code>rsm</code> representing a fitted
regression-scale model.
</p>
</td></tr>
<tr><td><code id="residuals.rsm_+3A_type">type</code></td>
<td>

<p>character string; defines the type of residuals, with choices 
<code>"deviance"</code>, <code>"pearson"</code>, <code>"response"</code>, 
<code>"r.star"</code>, <code>"prob"</code> or <code>"deletion"</code>; the first 
is the default.
</p>
</td></tr>
<tr><td><code id="residuals.rsm_+3A_weighting">weighting</code></td>
<td>

<p>character string; defines the weight matrix that should be used in
the calculation of the residuals and diagnostics.  Possible 
choices are <code>"observed"</code>, <code>"score"</code>, <code>"deviance"</code> 
and <code>"max"</code>; see <cite>Jorgensen (1984)</cite> for their 
definition.  The default is <code>"observed"</code>. 
</p>
</td></tr>
<tr><td><code id="residuals.rsm_+3A_...">...</code></td>
<td>

<p>absorbs any additional argument.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a method for the function <code>residuals()</code> for objects
inheriting from class <code>rsm</code>.  As several types of residuals are
available for <code>rsm</code> objects, there is an additional optional
argument <code>type</code>.  The <code>"deviance"</code>, <code>"pearson"</code>,
<code>"r.star"</code>, <code>"prob"</code> and <code>"deletion"</code> residuals are
derived from the final <abbr><span class="acronym">IRLS</span></abbr> fit.  The <code>"response"</code> residuals 
are standardized residuals on the scale of the response, the 
<code>"prob"</code> residuals are on the <code class="reqn">U(0,1)</code> scale, 
whereas the remaining ones follow approximately the standard normal 
distribution.
</p>
<p>The default weighting scheme used is <code>"observed"</code>.  The weights
used are the values stored in the <code>q2</code> component of the 
<code>rsm</code> object.  Some of the <abbr><span class="acronym">IRLS</span></abbr> weights 
returned by <code>rsm</code> may be negative if the error distribution 
is Student's t or user-defined.  In order to avoid missing values 
in the residuals, the default weighting scheme used is then 
<code>"score"</code> unless otherwise specified.  The <code>"score"</code> 
weights are also used by default if Huber's least favourable error 
distribution is used.
</p>
<p>More details, in particular of the use of these residuals, are 
given in <cite>Brazzale (2000, Section 6.3.1).</cite>
</p>


<h3>Value</h3>

<p>A numeric vector of residuals.  See <cite>Davison and Snell (1991)</cite> 
for detailed definitions of each type of residual.
</p>


<h3>Note</h3>

<p>The <code>summary</code> method for <code>rsm</code> objects produces 
response residuals.  The <code>residuals</code> component of a <code>rsm</code> 
object contains the response residuals.
</p>


<h3>References</h3>

<p>Brazzale, A. R. (2000) <em>Practical Small-Sample Parametric
Inference</em>.  Ph.D. Thesis N. 2230, Department of Mathematics, Swiss
Federal Institute of Technology Lausanne.
</p>
<p>Davison, A. C. and Snell, E. J. (1991) Residuals and diagnostics.  
In <em>Statistical Theory and Modelling: In Honour of Sir David 
Cox</em> (eds. D.V. Hinkley, N. Reid, and E.J. Snell), 83&ndash;106.  London:
Chapman \&amp; Hall.
</p>
<p>Davison, A. C. and Tsai, C.-L. (1992) Regression model diagnostics. 
<em>Int. Stat. Rev.</em>, <b>60</b>, 337&ndash;353.
</p>
<p>Jorgensen, B. (1984).  The delta algorithm and GLIM.  
<em>Int. Stat. Rev.</em>, <b>52</b>, 283&ndash;300.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rsm.object">rsm.object</a></code>, <code><a href="stats.html#topic+residuals">residuals</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Sea Level Data
data(venice)
attach(venice)
Year &lt;- 1:51/51
c11 &lt;- cos(2*pi*1:51/11) ; s11 &lt;- sin(2*pi*1:51/11)
c19 &lt;- cos(2*pi*1:51/18.62) ; s19 &lt;- sin(2*pi*1:51/18.62)
venice.rsm &lt;- rsm(sea ~ Year + I(Year^2) + c11 + s11 + c19 + s19, 
                  family = extreme)
##
residuals(venice.rsm)
## deviance residuals with observed weights
residuals(venice.rsm, type = "r.star", weighting = "score")
## r* residuals with score weights
detach()
</code></pre>

<hr>
<h2 id='rsm'>
Fit a Regression-Scale Model
</h2><span id='topic+rsm'></span>

<h3>Description</h3>

<p>Produces an object of class <code>rsm</code> which is a regression-scale
model fit of the data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rsm(formula = formula(data), family = gaussian, 
    data = sys.frame(sys.parent()), dispersion = NULL, 
    weights = NULL, subset = NULL, na.action = na.fail, 
    offset = NULL, method = "rsm.surv", 
    control = glm.control(maxit=100, trace=FALSE), 
    model = FALSE, x = FALSE, y = TRUE, contrasts = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rsm_+3A_formula">formula</code></td>
<td>

<p>a formula expression as for other linear regression models, of the 
form <code>response ~ predictors</code> where the predictors are 
separated  by suitable operators.  See the documentation of 
<code><a href="stats.html#topic+lm">lm</a></code> and <code><a href="stats.html#topic+formula">formula</a></code> for details.
</p>
</td></tr>
<tr><td><code id="rsm_+3A_family">family</code></td>
<td>

<p>a <code>family.rsm</code> object, i.e. a list of functions and
expressions characterizing the error distribution.  Families
supported are <code>gaussian</code>, <code>student</code> (Student's t),
<code>extreme</code> (Gumbel or extreme value), <code>logistic</code>,
<code>logWeibull</code>, <code>logExponential</code>, <code>logRayleigh</code>
and <code>Huber</code> (Huber's least favourable).  These represent
calls to the corresponding generator functions.  The calls to
<code>gaussian</code>, <code>extreme</code>, <code>logistic</code>,
<code>logWeibull</code>, <code>logExponential</code> and <code>logRayleigh</code>
can be given without parentheses.  The functions <code>student</code>
and <code>Huber</code> may take as argument respectively the degrees
of freedom (<code>df</code>) and the tuning constant
(<code>k</code>).  Users can construct their own
families, as long as they have components compatible with those
given in <code><a href="#topic+rsm.distributions">rsm.distributions</a></code>.  The demonstration file
&lsquo;<span class="file">margdemo.R</span>&rsquo; that ships with the package 
shows how to create a new generator function.  The default is
<code>gaussian</code>.
</p>
</td></tr>
<tr><td><code id="rsm_+3A_data">data</code></td>
<td>

<p>an optional data frame in which to interpret the variables 
occurring in the model formula, or in the <code>subset</code> and the 
<code>weights</code> arguments.  If this is missing, then the variables 
in the formula should be on the search list. 
</p>
</td></tr>
<tr><td><code id="rsm_+3A_dispersion">dispersion</code></td>
<td>

<p>if <code>NULL</code>, the scale parameter is taken to be unknown.  If 
known, the numerical value can be passed.  The default is 
<code>NULL</code>.  Huber's least favourable distribution represents a 
special case.  If <code>dispersion</code> is <code>NULL</code>, the maximum 
likelihood estimate is computed, while if <code>TRUE</code> the 
<abbr><span class="acronym">MAD</span></abbr> estimate is calculated and the scale parameter fixed 
to this value in subsequent computations.
</p>
</td></tr>
<tr><td><code id="rsm_+3A_weights">weights</code></td>
<td>

<p>the optional weights for the fitting criterion.  If supplied, the
response variable and the covariates are multiplied by the weights
in the <abbr><span class="acronym">IRLS</span></abbr> algorithm.  The length of the <code>weights</code>
argument must be the same as the number of observations.  The 
weights must be nonnegative and it is strongly recommended that 
they be strictly positive, since zero weights are ambiguous, 
compared to use of the <code>subset</code> argument.
</p>
</td></tr>
<tr><td><code id="rsm_+3A_subset">subset</code></td>
<td>

<p>expression saying which subset of the rows of the data should be 
used in the fit.  This can be a logical vector (which is 
replicated to have length equal to the number of observations), or 
a numeric vector indicating which observation numbers are to be 
included, or a character vector of the row names to be included.  
All observations are included by default.
</p>
</td></tr>
<tr><td><code id="rsm_+3A_na.action">na.action</code></td>
<td>

<p>a function to filter missing data.  This is applied to the model 
frame after any <code>subset</code> argument has been used.  The 
default (with <code>na.fail</code>) is to create an error if any missing 
value is found.  A possible alternative is <code>na.omit</code>, which 
deletes observations that contain one or more missing values.
</p>
</td></tr>
<tr><td><code id="rsm_+3A_offset">offset</code></td>
<td>

<p>this can be used to specify an <em>a priori</em> known component to
be included in the linear predictor during fitting.  An 
<code>offset</code> term can be included in the formula instead or as 
well, and if both are specified their sum is used.  Defaults to
<code>NULL</code>
</p>
</td></tr>
<tr><td><code id="rsm_+3A_method">method</code></td>
<td>

<p>the fitting method to be used; the default is <code>rsm.fit</code>.  The
method <code>model.frame</code> simply returns the model frame.
</p>
</td></tr>
<tr><td><code id="rsm_+3A_control">control</code></td>
<td>

<p>a list of iteration and algorithmic constants.  See 
<code><a href="stats.html#topic+glm.control">glm.control</a></code> for their names and default values. 
</p>
</td></tr>
<tr><td><code id="rsm_+3A_model">model</code></td>
<td>

<p>if <code>TRUE</code>, the model frame is returned; default is 
<code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="rsm_+3A_x">x</code></td>
<td>

<p>if <code>TRUE</code>, the model matrix is returned; default is 
<code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="rsm_+3A_y">y</code></td>
<td>

<p>if <code>TRUE</code>, the response variable is returned; default is 
<code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="rsm_+3A_contrasts">contrasts</code></td>
<td>

<p>a list of contrasts to be used for some or all of the factors
appearing as variables in the model formula.  The names of the 
list should be the names of the corresponding variables, and the 
elements should either be contrast-type matrices (matrices with 
as many rows as levels of the factor and with columns linearly 
independent of each other and of a column of one's), or else 
they should be functions that compute such contrast matrices.
</p>
</td></tr>
<tr><td><code id="rsm_+3A_...">...</code></td>
<td>

<p>absorbs any additional argument.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The model is fitted using <em>Iteratively Reweighted Least 
Squares</em>, <abbr><span class="acronym">IRLS</span></abbr> for short (<cite>Green, 1984</cite>, 
<cite>Jorgensen, 1984</cite>).  The working response and iterative 
weights are computed using the functions contained in the 
<code>family.rsm</code> object.  
</p>
<p>The two workhorses of <code>rsm</code> are <code><a href="#topic+rsm.fit">rsm.fit</a></code> and 
<code><a href="#topic+rsm.surv">rsm.surv</a></code>, which expect an <code>X</code> and <code>Y</code> 
argument rather then a formula.  The first function is used for the 
families <code>student</code> with <code>df</code> <code class="reqn">&lt;</code> 3 and 
<code>Huber</code>; 
the second one, based on the <code><a href="survival.html#topic+survreg.fit">survreg.fit</a></code> 
routine for fitting parametric survival models, is used in case of 
<code>extreme</code>, <code>logistic</code>, <code>logWeibull</code>, 
<code>logExponential</code>, <code>logRayleigh</code> and <code>student</code> (with 
<code>df</code> &gt; 2) error distributions.  In the presence of a 
user-defined error distribution the <code>rsm.fit</code> routine is used.
The <code><a href="#topic+rsm.null">rsm.null</a></code> function is invoked to fit an empty (null)
model.
</p>
<p>The details are given in <cite>Brazzale (2000, Section 6.3.1)</cite>.
</p>


<h3>Value</h3>

<p>an object of class <code>rsm</code> is returned which inherits from 
<code>glm</code> and <code>lm</code>.  See <code><a href="#topic+rsm.object">rsm.object</a></code> for details.
</p>
<p>The output can be examined by <code><a href="base.html#topic+print">print</a></code>, 
<code><a href="base.html#topic+summary">summary</a></code>, <code><a href="#topic+rsm.diag.plots">rsm.diag.plots</a></code> and 
<code><a href="stats.html#topic+anova">anova</a></code>.  Components can be extracted using 
<code><a href="stats.html#topic+fitted">fitted</a></code>, <code><a href="stats.html#topic+residuals">residuals</a></code>, 
<code><a href="stats.html#topic+formula">formula</a></code> and <code><a href="stats.html#topic+family">family</a></code>.  It can 
be modified using <code><a href="stats.html#topic+update">update</a></code>. It has most of the 
components of a <code>glm</code> object, with a few more.  Use 
<code><a href="#topic+rsm.object">rsm.object</a></code> for further details.
</p>


<h3>Note</h3>

<p>In case of <code>extreme</code>, <code>logistic</code>, <code>logWeibull</code>,
<code>logExponential</code>, <code>logRayleigh</code> and <code>student</code> (with
<code>df</code> &gt; 2) error distributions, both methods,
<code><a href="#topic+rsm.fit">rsm.fit</a></code> (default choice) and
<code><a href="#topic+rsm.surv">rsm.surv</a></code>, can be used to fit the model.
There are, however, examples where one of the two algorithms (most 
likely the one invoked by <code><a href="#topic+rsm.surv">rsm.surv</a></code>) breaks 
down.  If this is the case, try and refit the model with the 
alternative choice.  
</p>









<p>The message <code>"negative iterative weights returned!"</code> is 
returned if some of the iterative weights (<code>q2</code> component of 
the fitted <code>rsm</code> object) are negative.  These would be used by 
default by the <code><a href="#topic+rsm.diag">rsm.diag</a></code> routine for the definition of 
residuals and regression diagnostics.  In order to avoid missing 
values (<code>NA</code>s), the default weighting scheme <code>"observed"</code> 
automatically switches to <code>"score"</code> unless otherwise specified.
</p>


<h3>References</h3>

<p>Brazzale, A. R. (2000) <em>Practical Small-Sample Parametric
Inference</em>.  Ph.D. Thesis N. 2230, Department of Mathematics, Swiss
Federal Institute of Technology Lausanne.
</p>
<p>Green, P. J. (1984) Iteratively reweighted least squares for maximum 
likelihood estimation, and some robust and resistant alternatives 
(with Discussion).  <em>J. R. Statist. Soc. </em> B, <b>46</b>, 
149&ndash;192.
</p>
<p>Jorgensen, B. (1984) The delta algorithm and GLIM.  <em>Int. Stat.
Rev.</em>, <b>52</b>, 283&ndash;300.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rsm.object">rsm.object</a></code>, <code><a href="#topic+rsm.fit">rsm.fit</a></code>, 
<code><a href="#topic+rsm.surv">rsm.surv</a></code>, <code><a href="#topic+rsm.null">rsm.null</a></code>,
<code><a href="#topic+rsm.families">rsm.families</a></code>  
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## House Price Data
data(houses)
houses.rsm &lt;- rsm(price ~ ., family = student(5), data = houses)
## model fit including all covariates
houses.rsm &lt;- rsm(price ~ ., family = student(5), data = houses, 
                  method = "rsm.fit", control = glm.control(trace = TRUE))
## prints information about the iterative procedure at each iteration
update(houses.rsm, ~ . - bdroom + offset(7 * bdroom))
## "bdroom" is included as offset variable with fixed (= 7) coefficient

## Sea Level Data
data(venice)
attach(venice)
Year &lt;- 1:51/51
venice.2.rsm &lt;- rsm(sea ~ Year + I(Year^2), family = extreme)
## quadratic model fitted to sea level data
venice.1.rsm &lt;- update(venice.2.rsm, ~. - I(Year^2))
## linear model fit
##
c11 &lt;- cos(2*pi*1:51/11) ; s11 &lt;- sin(2*pi*1:51/11)
c19 &lt;- cos(2*pi*1:51/18.62) ; s19 &lt;- sin(2*pi*1:51/18.62)
venice.rsm &lt;- rsm(sea ~ Year + I(Year^2) + c11 + s11 + c19 + s19, 
                  family = extreme)
## includes 18.62-year astronomical tidal cycle and 11-year sunspot cycle
venice.11.rsm &lt;- rsm(sea ~ Year + I(Year^2) + c11 + s11, family = extreme)
venice.19.rsm &lt;- rsm(sea ~ Year + I(Year^2) + c19 + s19, family = extreme)
## includes either astronomical cycle
##
## comparison of linear, quadratic and periodic (11-year, 19-year) models 
plot(year, sea, ylab = "sea level") 
lines(year, fitted(venice.1.rsm))
lines(year, fitted(venice.2.rsm), col="red")
lines(year, fitted(venice.11.rsm), col="blue")
lines(year, fitted(venice.19.rsm), col="green")
##
detach()

## Darwin's Data on Growth Rates of Plants
data(darwin)
darwin.rsm &lt;- rsm(cross - self ~ pot - 1, family  =  student(3), 
                  data = darwin)
## Maximum likelihood estimates
darwin.rsm &lt;- rsm(cross - self ~ pot - 1, family = Huber, data = darwin)
## M-estimates
</code></pre>

<hr>
<h2 id='rsm.diag'>
Diagnostics for Regression-Scale Models 
</h2><span id='topic+rsm.diag'></span>

<h3>Description</h3>

<p>Calculates different types of residuals, Cook's distance and the
leverages for a regression-scale model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rsm.diag(rsmfit, weighting = "observed")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rsm.diag_+3A_rsmfit">rsmfit</code></td>
<td>

<p>an <code>rsm</code> object, i.e. the result of a call to <code>rsm</code>.
</p>
</td></tr>
<tr><td><code id="rsm.diag_+3A_weighting">weighting</code></td>
<td>

<p>character string; defines the weight matrix that should be used 
in the calculation of the residuals and diagnostics.  Possible 
choices are <code>"observed"</code>, <code>"score"</code>, <code>"deviance"</code> 
and <code>"max"</code>; see <cite>Jorgensen (1984)</cite> for their 
definition.  The default is <code>"observed"</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the weighting scheme is <code>"observed"</code>, the weights used are 
the values stored in the <code>q2</code> component of the <code>rsm</code> 
object <code>rsmfit</code>.  Otherwise, they are calculated by 
<code>rsm.diag</code>.  Some of the <abbr><span class="acronym">IRLS</span></abbr> weights returned by 
<code>rsm</code> may be negative if the error distribution is Student's
t or user-defined.  In order to avoid missing values in the 
residuals and regression diagnostics, the default weighting scheme 
used in <code>rsm.diag</code> switches automatically from 
<code>"observed"</code> to <code>"score"</code> unless otherwise specified.  The
<code>"score"</code> weights are also used by default if Huber's least 
favourable error distribution is used.
</p>
<p>There are three types of residuals.  The response residuals are 
taken on the response scale, whereas the probability transform 
residuals are on the <code class="reqn">U(0,1)</code> scale.  The remaining 
ones follow approximately the standard normal distribution.  
</p>
<p>More details and in particular the definitions of the above 
residuals and diagnostics can be found in <cite>Brazzale (2000, 
Section 6.3.1)</cite>.
</p>


<h3>Value</h3>

<p>Returns a list with the following components:
</p>
<table>
<tr><td><code>resid</code></td>
<td>

<p>the response residuals on the response scale.
</p>
</td></tr>
<tr><td><code>rd</code></td>
<td>

<p>the standardized deviance residuals from the <abbr><span class="acronym">IRLS</span></abbr> fit.
</p>
</td></tr>
<tr><td><code>rp</code></td>
<td>

<p>the standardized Pearson residuals from the <abbr><span class="acronym">IRLS</span></abbr> fit.
</p>
</td></tr>
<tr><td><code>rg</code></td>
<td>

<p>the deletion residuals from the <abbr><span class="acronym">IRLS</span></abbr> fit.
</p>
</td></tr>
<tr><td><code>rs</code></td>
<td>

<p>the <code class="reqn">r^*</code> residuals from the <abbr><span class="acronym">IRLS</span></abbr> fit.
</p>
</td></tr>
<tr><td><code>rcs</code></td>
<td>

<p>the probability transform residuals from the <abbr><span class="acronym">IRLS</span></abbr> fit.
</p>
</td></tr>
<tr><td><code>cook</code></td>
<td>

<p>Cook's distance.
</p>
</td></tr>
<tr><td><code>h</code></td>
<td>

<p>the leverages of the observations.
</p>
</td></tr>
<tr><td><code>dispersion</code></td>
<td>

<p>the value of the scale parameter.
</p>
</td></tr>
</table>


<h3>Acknowledgments</h3>

<p>This function is based on A.J. Canty's function <code>glm.diag</code> 
contained in the package <span class="pkg">boot</span>.
</p>


<h3>Note</h3>

<p>Huber's least favourable distribution represents a special case.  
The regression diagnostics are only meaningful if the errors 
<em>truly</em> follow a Huber-type distribution.  This no longer holds
if the option <code>family = Huber</code> in <code>rsm</code> is used to 
obtain the M-estimates of the parameters in place or the maximum 
likelihood estimates.
</p>


<h3>References</h3>

<p>Brazzale, A. R. (2000) <em>Practical Small-Sample Parametric 
Inference</em>.  Ph.D. Thesis N. 2230, Department of Mathematics, Swiss 
Federal Institute of Technology Lausanne.
</p>
<p>Jorgensen, B. (1984) The delta algorithm and GLIM.  <em>Int. Stat.
Rev.</em>, <b>52</b>, 283&ndash;300.
</p>
<p>Davison, A. C. and Snell, E. J. (1991) Residuals and diagnostics.  
In <em>Statistical Theory and Modelling: In Honour of Sir David 
Cox</em> (eds. D. V. Hinkley, N. Reid, and E. J. Snell), 83&ndash;106.  
London: Chapman &amp; Hall.
</p>
<p>Davison, A. C. and Tsai, C.-L. (1992)  Regression model diagnostics.
<em>Int. Stat. Rev.</em>, <b>60</b>, 337&ndash;353.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rsm.diag.plots">rsm.diag.plots</a></code>, <code><a href="#topic+rsm.object">rsm.object</a></code>, 
<code><a href="#topic+summary.rsm">summary.rsm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Sea Level Data
data(venice)
attach(venice)
Year &lt;- 1:51/51
c11 &lt;- cos(2*pi*1:51/11) ; s11 &lt;- sin(2*pi*1:51/11)
c19 &lt;- cos(2*pi*1:51/18.62) ; s19 &lt;- sin(2*pi*1:51/18.62)
venice.rsm &lt;- rsm(sea ~ Year + I(Year^2) + c11 + s11 + c19 + s19, 
                  family = extreme)
venice.diag &lt;- rsm.diag(venice.rsm)
## observed weights
detach()

## Darwin's Data on Growth Rates of Plants
data(darwin)
darwin.rsm &lt;- rsm(cross-self ~ pot - 1, family = Huber, data = darwin)
darwin.diag &lt;- rsm.diag(darwin.rsm)
## score weights
</code></pre>

<hr>
<h2 id='rsm.diag.plots'>
Diagnostic Plots for Regression-Scale Models
</h2><span id='topic+rsm.diag.plots'></span><span id='topic+plot.rsm'></span>

<h3>Description</h3>

<p>Generates diagnostic plots for a regression-scale model using 
different types of residuals, Cook's distance and the leverages.    
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rsm.diag.plots(rsmfit, rsmdiag = NULL, weighting = NULL, 
               which = NULL, subset = NULL, iden = FALSE, 
               labels = NULL, ret = FALSE, ...)
## S3 method for class 'rsm'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rsm.diag.plots_+3A_rsmfit">rsmfit</code>, <code id="rsm.diag.plots_+3A_x">x</code></td>
<td>

<p>a <code>rsm</code> object, i.e. the result of a call to <code>rsm</code>.
</p>
</td></tr>
<tr><td><code id="rsm.diag.plots_+3A_rsmdiag">rsmdiag</code></td>
<td>

<p>the object returned by a call to <code>rsm.diag</code> containing the
regression diagnostics for the regression-scale model defined by 
<code>rsmfit</code>.  If not supplied, this object is created by 
<code>rsm.diag.plots</code> and returned upon request (if 
<code>ret = TRUE</code>).
</p>
</td></tr>
<tr><td><code id="rsm.diag.plots_+3A_weighting">weighting</code></td>
<td>

<p>character string; defines the weight matrix that should be used in
the calculation of the residuals and diagnostics.  Possible  
choices are <code>"observed"</code>, <code>"score"</code>, <code>"deviance"</code> 
and <code>"max"</code>; see <cite>Jorgensen (1984)</cite> for their 
definition.  Will only be used if the <code>rsmdiag</code> argument is
missing.
</p>
</td></tr>
<tr><td><code id="rsm.diag.plots_+3A_which">which</code></td>
<td>

<p>which plot to print.  Admissible values are <code>2</code> to <code>7</code> 
corresponding to the choices in the menu below.
</p>
</td></tr>
<tr><td><code id="rsm.diag.plots_+3A_subset">subset</code></td>
<td>

<p>subset of data used in the original <code>rsm</code> fit: should be 
the same than the <code>subset</code> option used in the call to 
<code>rsm</code> which generated <code>rsmfit</code>.  Needed only if the
<code>subset</code> option was used in the call to <code>rsm</code>.  
</p>
</td></tr>
<tr><td><code id="rsm.diag.plots_+3A_iden">iden</code></td>
<td>

<p>logical argument.  If <code>TRUE</code>, the user will be prompted after
the plots are drawn.  A positive integer will select a plot and 
invoke <code>identify()</code> on that plot.  After exiting 
<code>identify()</code>, the user is again prompted, this loop 
continuing until the user responds to the prompt with <code>0</code>.  
If <code>iden</code> is <code>FALSE</code> (default) the user cannot 
interact with the plots.
</p>
</td></tr>
<tr><td><code id="rsm.diag.plots_+3A_labels">labels</code></td>
<td>

<p>a vector of labels for use with <code>identify()</code> if 
<code>iden</code> is <code>TRUE</code>.  If it is not supplied, then the 
labels are derived from <code>rsmfit</code>.
</p>
</td></tr>
<tr><td><code id="rsm.diag.plots_+3A_ret">ret</code></td>
<td>

<p>logical argument indicating if <code>rsmdiag</code> should be 
returned; the default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="rsm.diag.plots_+3A_...">...</code></td>
<td>

<p>additional arguments such as graphical parameters.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The diagnostics required for the plots are calculated by 
<code><a href="#topic+rsm.diag">rsm.diag</a></code>.  These are then used to produce the plots
on the current graphics device.
</p>
<p>A menu lists all the plots that can be produced. They may be one or 
all of the following:
</p>
<pre>
 Make a plot selection (or 0 to exit)

1: All
2: Response residuals against fitted values
3: Deviance residuals against fitted values
4: QQ-plot of deviance residuals
5: Normal QQ-plot of r* residuals
6: Cook statistic against h/(1-h)
7: Cook statistic against observation number

Selection:
  </pre>
<p>In the normal scores plots, the dotted line represents the expected 
line if the residuals are normally distributed, i.e. it is the line 
with intercept 0 and slope 1.
</p>
<p>In general, when plotting Cook's distance against the standardized 
leverages, there will be two dotted lines on the plot.  The 
horizontal line is at <code class="reqn">8/(n-2p)</code>, where <code class="reqn">n</code> is 
the number of observations and <code class="reqn">p</code> is the number of 
estimated parameters.  Points above this line may be points with 
high influence on the model.  The vertical line is at 
<code class="reqn">2p/(n-2p)</code> and points to the right of this line have
high leverage compared to the variance of the raw residual at that 
point.  If all points are below the horizontal line or to the left 
of the vertical line then the line is not shown.
</p>
<p>Use of <code>iden = TRUE</code> is encouraged for proper exploration of 
these plots as a guide to how well the model fits the data and 
whether certain observations have an unduly large effect on 
parameter estimates.
</p>


<h3>Value</h3>

<p>If <code>ret</code> is <code>TRUE</code> then the value of <code>rsmdiag</code> 
is returned, otherwise there is no returned value.
</p>


<h3>Side Effects</h3>

<p>The current device is cleared.  If <code>iden = TRUE</code>, interactive 
identification of points is enabled.  All screens are closed, but 
not cleared, on termination of the function.
</p>


<h3>Acknowledgments</h3>

<p>This function is based on A. J. Canty's function 
<code>glm.diag.plots</code> contained in the package <span class="pkg">boot</span>.
</p>


<h3>References</h3>

<p>Davison, A. C. and Snell, E. J. (1991) Residuals and diagnostics.  
In <em>Statistical Theory and Modelling: In Honour of Sir David 
Cox</em> (eds. D. V. Hinkley, N. Reid, and E. J. Snell), 83&ndash;106.  
London: Chapman &amp; Hall, London.
</p>
<p>Davison, A. C. and Tsai, C.-L. (1992) Regression model diagnostics.
<em>Int. Stat. Rev.</em>, <b>60</b>, 337&ndash;353.
</p>
<p>Jorgensen, B. (1984) The Delta Algorithm and GLIM.  <em>Int. Stat.
Rev.</em>, <b>52</b>, 283&ndash;300.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rsm.diag">rsm.diag</a></code>, <code><a href="#topic+rsm.object">rsm.object</a></code>, 
<code><a href="graphics.html#topic+identify">identify</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Sea Level Data
data(venice)
attach(venice)
Year &lt;- 1:51/51
c11 &lt;- cos(2*pi*1:51/11) ; s11 &lt;- sin(2*pi*1:51/11)
c19 &lt;- cos(2*pi*1:51/18.62) ; s19 &lt;- sin(2*pi*1:51/18.62)
venice.rsm &lt;- rsm(sea ~ Year + I(Year^2) + c11 + s11 + c19 + s19, 
                  family = extreme)
## Not run: 
rsm.diag.plots(venice.rsm, which = 3)

## End(Not run)
## or
## Not run: 
plot(venice.rsm)

## End(Not run)
## menu-driven
##
rsm.diag.plots(venice.rsm, which = 5, las = 1)
## normal QQ-plot of r* residuals 
## Not run: 
rsm.diag.plots(venice.rsm, which = 7, iden = T, labels = paste(1931:1981))

## End(Not run)
## year 1932 highly influential
detach()
</code></pre>

<hr>
<h2 id='rsm.dispersion'>
Support for Functions rsm.fit and rsm.surv
</h2><span id='topic+rsm.dispersion'></span>

<h3>Description</h3>

<p>This is support for the functions <code><a href="#topic+rsm.fit">rsm.fit</a></code> and 
<code><a href="#topic+rsm.surv">rsm.surv</a></code>.  It is not intended to be called directly by 
users.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rsm.dispersion(log.dispersion, abs.res, family, arg)
</code></pre>

<hr>
<h2 id='rsm.distributions'>
RSM Family Support Object
</h2><span id='topic+rsm.distributions'></span>

<h3>Description</h3>

<p>Support object for regression-scale models
</p>


<h3>Details</h3>

<p>This is a matrix object used in the construction of <code>family.rsm</code> 
objects.  It is of mode <code>list</code>, and has dimension <code>c(3,5)</code>.  
The 5 columns in
</p>
<p><code>rsm.distributions[[functionName, familyName]]</code>
</p>
<p>represent the distributions <code>student</code> (Student's t),
<code>logistic</code>, <code>logWeibull</code>, <code>extreme</code> (Gumbel 
or extreme value) and <code>Huber</code> (Huber's least favourable).  
The rows <code>g0</code>, <code>g1</code> and <code>g2</code> contain functions that
define minus the corresponding log density and its first and second
derivatives.  They take a single argument for the families
<code>logistic</code>, <code>logWeibull</code> and <code>extreme</code>, while for the
families <code>student</code> and <code>Huber</code> they have a further
argument, respectively <code>df</code> and <code>k</code>, which denote the
degrees of freedom and the tuning constant.
</p>
<p>This object is used by the functions <code>make.family.rsm</code> and,
indirectly, by <code>rsm</code> when constructing a <code>family.rsm</code>
object.  See the documentation of <code><a href="#topic+family.rsm.object">family.rsm.object</a></code>
and <code><a href="#topic+make.family.rsm">make.family.rsm</a></code> for additional details.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+family.rsm.object">family.rsm.object</a></code>, <code><a href="#topic+make.family.rsm">make.family.rsm</a></code>,
<code><a href="#topic+rsm">rsm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>rsm.distributions[["g0", "student"]]
</code></pre>

<hr>
<h2 id='rsm.families'>
Generate a RSM Family Object
</h2><span id='topic+rsm.families'></span><span id='topic+extreme'></span><span id='topic+Huber'></span><span id='topic+logistic'></span><span id='topic+logWeibull'></span><span id='topic+student'></span>

<h3>Description</h3>

<p>Generates a <code>family.rsm</code> object containing a list of functions 
and expressions used by <code>rsm</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extreme()
Huber(k = 1.345)
logistic()
logWeibull()
student(df = stop("Argument \"df\" is missing, with no default"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rsm.families_+3A_k">k</code></td>
<td>

<p>the tuning constant in Huber's least favourable distribution.
</p>
</td></tr>
<tr><td><code id="rsm.families_+3A_df">df</code></td>
<td>

<p>the degrees of freedom in Student's t distribution.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Each of the names are associated with a member of the class of error 
distributions for regression-scale models.  Users can construct 
their own families, as long as they have components compatible with 
those given in <code>rsm.distributions</code>.  The demonstration file 
&lsquo;<span class="file">margdemo.R</span>&rsquo; that accompanies the package shows how to 
create a new generator function.  When passed as an argument to 
<code>rsm</code> with the default setting, the empty parentheses 
<code>()</code> can be omitted.  There is a <code>print</code> method for the
class <code>family.rsm</code>.
</p>


<h3>Value</h3>

<p>A <code>family.rsm</code> object, which is a list of functions and 
expressions used by <code>rsm</code> in the iteratively reweighted 
least-squares algorithm.  See <code><a href="#topic+family.rsm.object">family.rsm.object</a></code> for 
details.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+family.rsm.object">family.rsm.object</a></code>, <code><a href="#topic+family.rsm">family.rsm</a></code>, 
<code><a href="#topic+rsm">rsm</a></code>, <code><a href="#topic+Huber">Huber</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>student(df = 3) ## generates Student's t error distribution with 3 d.f.
## Not run: 
rsm(formula = value, data = value, family = extreme)

## End(Not run)
</code></pre>

<hr>
<h2 id='rsm.fit'>
Fit a Regression-Scale Model Without Computing the Model Matrix
</h2><span id='topic+rsm.fit'></span>

<h3>Description</h3>

<p>Fits a <code>rsm</code> model without computing the model matrix of the 
response vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rsm.fit(X, Y, offset, family, dispersion, score.dispersion, maxit, epsilon, 
        trace, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rsm.fit_+3A_x">X</code></td>
<td>

<p>the model matrix (design matrix).
</p>
</td></tr>
<tr><td><code id="rsm.fit_+3A_y">Y</code></td>
<td>

<p>the response vector.
</p>
</td></tr>
<tr><td><code id="rsm.fit_+3A_dispersion">dispersion</code></td>
<td>

<p>if <code>NULL</code>, the <abbr><span class="acronym">MLE</span></abbr> of the scale parameter is returned, 
otherwise the scale parameter is fixed to the numerical value 
passed through the argument.  If Huber's least favourable 
distribution is used and <code>dispersion</code> is <code>TRUE</code>, the 
<abbr><span class="acronym">MAD</span></abbr> is computed and the scale parameter fixed to this 
value in subsequent calculations.
</p>
</td></tr>
<tr><td><code id="rsm.fit_+3A_score.dispersion">score.dispersion</code></td>
<td>

<p>must default to <code>NULL</code>.
</p>
</td></tr>	
<tr><td><code id="rsm.fit_+3A_offset">offset</code></td>
<td>

<p>optional offset added to the linear predictor.
</p>
</td></tr>
<tr><td><code id="rsm.fit_+3A_family">family</code></td>
<td>

<p>a <code>family.rsm</code> object, i.e. a list of functions and 
expressions characterizing the error distribution.  Families 
supported are <code>gaussian</code>, <code>student</code> (Student's t), 
<code>extreme</code> (Gumbel or extreme value), <code>logistic</code>, 
<code>logWeibull</code>, <code>logExponential</code>, <code>logRayleigh</code> and 
<code>Huber</code> (Huber's least favourable).  Users can construct their
own families, as long as they have components compatible with those
given in <code><a href="#topic+rsm.distributions">rsm.distributions</a></code>.  The demonstration file
&lsquo;<span class="file">margdemo.R</span>&rsquo; that ships with the package shows how to
create a new generator function.
</p>
</td></tr>
<tr><td><code id="rsm.fit_+3A_maxit">maxit</code></td>
<td>

<p>maximum number of iterations allowed.
</p>
</td></tr>
<tr><td><code id="rsm.fit_+3A_epsilon">epsilon</code></td>
<td>

<p>convergence threshold.
</p>
</td></tr>
<tr><td><code id="rsm.fit_+3A_trace">trace</code></td>
<td>

<p>if <code>TRUE</code>, iterations details are printed during execution.
</p>
</td></tr>
<tr><td><code id="rsm.fit_+3A_...">...</code></td>
<td>

<p>not used, but do absorb any redundant argument.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>rsm.fit</code> function is called internally by the 
<code><a href="#topic+rsm">rsm</a></code> routine to do the actual model fitting.  Although 
it is not intended to be used directly by the user, it may be useful
when the same data frame is used over and over again.  It might save
computational time, since the model matrix is not created.  No 
formula needs to be specified as an argument.  As no <code>weights</code>
argument is available, the response <code>Y</code> and the  model matrix 
<code>X</code> must already include the weights if weighting is desired.
</p>


<h3>Value</h3>

<p>an object which is a subset of a <code>rsm</code> object. 
</p>


<h3>Note</h3>

<p>The <code>rsm.fit</code> function is the workhorse of the <code><a href="#topic+rsm">rsm</a></code>
fitting routine for the <code>student</code> (with <code>df</code> 
<code class="reqn">\leq</code> 2), <code>Huber</code> and user-defined error 
distributions.  It receives <code>X</code> and <code>Y</code> data rather than a 
formula, but still uses the <code>family.rsm</code> object to define the 
<abbr><span class="acronym">IRLS</span></abbr> steps.  Users can write
their own versions of <code>rsm.fit</code>, and pass the name of their 
function via the <code>method</code> argument to <code>rsm</code>.  Care should 
be taken to include as many of the arguments as feasible, but 
definitely the <code>...</code> argument, which will absorb any 
additional argument given in the call from <code>rsm</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rsm">rsm</a></code>, <code><a href="#topic+rsm.surv">rsm.surv</a></code>, <code><a href="#topic+rsm.null">rsm.null</a></code>, 
<code><a href="#topic+rsm.object">rsm.object</a></code>, <code><a href="#topic+rsm.families">rsm.families</a></code>
</p>

<hr>
<h2 id='rsm.null'>  
Fit an Empty Regression-Scale Model
</h2><span id='topic+rsm.null'></span>

<h3>Description</h3>

<p>Fits a <code>rsm</code> model with empty model matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rsm.null(X = NULL, Y, offset, family, dispersion, score.dispersion, maxit, 
         epsilon, trace, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rsm.null_+3A_x">X</code></td>
<td>
 
<p>defaults to <code>NULL</code>.  
</p>
</td></tr>
<tr><td><code id="rsm.null_+3A_y">Y</code></td>
<td>

<p>the response vector.
</p>
</td></tr>
<tr><td><code id="rsm.null_+3A_dispersion">dispersion</code></td>
<td>

<p>either <code>NULL</code> or <code>TRUE</code>.  If <code>NULL</code>, the 
<abbr><span class="acronym">MLE</span></abbr> of the scale parameter is returned.  If Huber's least
favourable distribution is used and <code>dispersion</code> is 
<code>TRUE</code>, the <abbr><span class="acronym">MAD</span></abbr> is computed and the scale parameter 
fixed to this value in subsequent calculations.
</p>
</td></tr>
<tr><td><code id="rsm.null_+3A_score.dispersion">score.dispersion</code></td>
<td>

<p>must default to <code>NULL</code>.
</p>
</td></tr>	
<tr><td><code id="rsm.null_+3A_offset">offset</code></td>
<td>

<p>optional offset added to the linear predictor.
</p>
</td></tr>
<tr><td><code id="rsm.null_+3A_family">family</code></td>
<td>

<p>a <code>family.rsm</code> object, i.e. a list of functions and 
expressions characterizing the error distribution.  Families 
supported are <code>gaussian</code>, <code>student</code> (Student's t), 
<code>extreme</code> (Gumbel or extreme value), <code>logistic</code>, 
<code>logWeibull</code>, <code>logExponential</code>, <code>logRayleigh</code> and 
<code>Huber</code> (Huber's least favourable).  Users can construct their
own families, as long as they have components compatible with those
given in <code><a href="#topic+rsm.distributions">rsm.distributions</a></code>.  The demonstration file
&lsquo;<span class="file">margdemo.R</span>&rsquo; that ships with the package shows how to
create a new generator function.
</p>
</td></tr>
<tr><td><code id="rsm.null_+3A_maxit">maxit</code></td>
<td>

<p>maximum number of iterations allowed.
</p>
</td></tr>
<tr><td><code id="rsm.null_+3A_epsilon">epsilon</code></td>
<td>

<p>convergence threshold.
</p>
</td></tr>
<tr><td><code id="rsm.null_+3A_trace">trace</code></td>
<td>

<p>if <code>TRUE</code>, iterations details are printed during execution.
</p>
</td></tr>
<tr><td><code id="rsm.null_+3A_...">...</code></td>
<td>

<p>not used, but do absorb any redundant argument.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>rsm.null</code> function is called internally by the 
<code><a href="#topic+rsm">rsm</a></code> routine to do the actual model fitting in case of an
empty model.  It is not intended to be used directly by the user.  As
no <code>weights</code> argument is available, the response <code>Y</code> and 
the model matrix <code>X</code> must already include the weights if 
weighting is desired.
</p>


<h3>Value</h3>

<p>an object which is a subset of a <code>rsm</code> object. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rsm">rsm</a></code>, <code><a href="#topic+rsm.surv">rsm.surv</a></code>, <code><a href="#topic+rsm.fit">rsm.fit</a></code>, 
<code><a href="#topic+rsm.object">rsm.object</a></code>, <code><a href="#topic+rsm.families">rsm.families</a></code>
</p>

<hr>
<h2 id='rsm.object'>
Regression-Scale Model Object
</h2><span id='topic+rsm.object'></span>

<h3>Description</h3>

<p>Class of objects returned when fitting a regression-scale model.
</p>


<h3>Arguments</h3>

<p>The following components must be included in a <code>rsm</code> object:
</p>
<table>
<tr><td><code id="rsm.object_+3A_coefficients">coefficients</code></td>
<td>

<p>the coefficients of the linear predictor, which multiply the 
columns of the model matrix.  The names of the coefficients are 
the names of the single-degree-of-freedom effects (the columns 
of the model matrix).  If the model is over-determined there will
be missing values in the coefficients corresponding to 
inestimable coefficients.
</p>
</td></tr>
<tr><td><code id="rsm.object_+3A_dispersion">dispersion</code></td>
<td>

<p>the (estimated or known) value of the scale parameter.
</p>
</td></tr>
<tr><td><code id="rsm.object_+3A_fixed">fixed</code></td>
<td>

<p>a logical value.  If <code>TRUE</code>, the scale parameter is fixed.
</p>
</td></tr>
<tr><td><code id="rsm.object_+3A_residuals">residuals</code></td>
<td>

<p>the response residuals from the fit.  If weights were used, they
are not taken into account.  If you need other kinds of 
residuals, use the <code><a href="#topic+residuals.rsm">residuals.rsm</a></code> function.
</p>
</td></tr>
<tr><td><code id="rsm.object_+3A_fitted.values">fitted.values</code></td>
<td>

<p>the fitted values from the fit.  If weights were used, the fitted 
values are not adjusted for the weights.
</p>
</td></tr>
<tr><td><code id="rsm.object_+3A_loglik">loglik</code></td>
<td>

<p>the log likelihood from the fit.
</p>
</td></tr>
<tr><td><code id="rsm.object_+3A_q1">q1</code></td>
<td>

<p>the value of the first derivative of minus the log density for 
each observation.
</p>
</td></tr>
<tr><td><code id="rsm.object_+3A_q2">q2</code></td>
<td>

<p>the value of the second derivative of minus the log density for
each observation.    
</p>
</td></tr>
<tr><td><code id="rsm.object_+3A_rank">rank</code></td>
<td>

<p>the computed rank (number of linearly independent columns in the
model matrix).
</p>
</td></tr>
<tr><td><code id="rsm.object_+3A_r">R</code></td>
<td>

<p>the unscaled observed information matrix.
</p>
</td></tr>
<tr><td><code id="rsm.object_+3A_score.dispersion">score.dispersion</code></td>
<td>

<p>a list containing the value of the objective function, its gradient
and the convergence diagnostic, that result from estimating the 
scale parameter.
</p>
</td></tr>
<tr><td><code id="rsm.object_+3A_iter">iter</code></td>
<td>

<p>the number of <abbr><span class="acronym">IRLS</span></abbr> iterations used to compute the 
estimates. 
</p>
</td></tr>
<tr><td><code id="rsm.object_+3A_weights">weights</code></td>
<td>

<p>the (optional) weights used for the fit.
</p>
</td></tr>
<tr><td><code id="rsm.object_+3A_assign">assign</code></td>
<td>

<p>the list of assignments of coefficients (and effects) to the terms
in the model.  The names of this list are the names of the terms.
The <em>i</em>th element of the list is the vector saying which 
coefficients correspond to the <em>i</em>th term.  It may be of 
length 0 if there were no estimable effects for the term.
</p>
</td></tr>
<tr><td><code id="rsm.object_+3A_df.residuals">df.residuals</code></td>
<td>

<p>the number of degrees of freedom for residuals.
</p>
</td></tr>
<tr><td><code id="rsm.object_+3A_family">family</code></td>
<td>

<p>the entire <code>family.rsm</code> object used. 
</p>
</td></tr>
<tr><td><code id="rsm.object_+3A_user.def">user.def</code></td>
<td>

<p>a logical value.  If <code>TRUE</code>, the error distribution is 
user-defined.
</p>
</td></tr>
<tr><td><code id="rsm.object_+3A_dist">dist</code></td>
<td>

<p>a character string representing the name of the error 
distribution.
</p>
</td></tr>
<tr><td><code id="rsm.object_+3A_formula">formula</code></td>
<td>

<p>the model formula.
</p>
</td></tr>
<tr><td><code id="rsm.object_+3A_data">data</code></td>
<td>

<p>the data frame in which to interpret the variables occurring in 
the model formula, or in the <code>subset</code> and the <code>weights</code> 
arguments to <code>rsm</code>.  
</p>
</td></tr>
<tr><td><code id="rsm.object_+3A_terms">terms</code></td>
<td>

<p>an object of mode <code>expression</code> and class <code>term</code>
summarizing the formula.
</p>
</td></tr>
<tr><td><code id="rsm.object_+3A_contrasts">contrasts</code></td>
<td>

<p>a list containing sufficient information to construct the contrasts
used to fit any factors occurring in the model.  The list contains
entries that are either matrices or character vectors.  When a 
factor is coded by contrasts, the corresponding contrast matrix is
stored in this list.  Factors that appear only as dummy variables 
and variables in the model that are matrices correspond to 
character vectors in the list.  The character vector has the level
names for a factor or the column labels for a matrix.
</p>
</td></tr>
<tr><td><code id="rsm.object_+3A_control">control</code></td>
<td>

<p>a list of iteration and algorithmic constants used in <code>rsm</code>
to fit the model.
</p>
</td></tr>
<tr><td><code id="rsm.object_+3A_call">call</code></td>
<td>

<p>an image of the call that produced the object, but with the 
arguments all named and with the actual formula included as the 
formula argument.
</p>
</td></tr>
<tr><td><code id="rsm.object_+3A_y">y</code></td>
<td>

<p>optionally the response, if <code>y = TRUE</code> in the original 
<code>rsm</code> call.
</p>
</td></tr>
<tr><td><code id="rsm.object_+3A_x">x</code></td>
<td>

<p>optionally the model matrix, if <code>x = TRUE</code> in the original 
<code>rsm</code> call.
</p>
</td></tr>
<tr><td><code id="rsm.object_+3A_model">model</code></td>
<td>

<p>optionally the model frame, if <code>model = TRUE</code> in the original     
<code>rsm</code> call.
</p>
</td></tr>
</table>


<h3>Generation</h3>

<p>This class of objects is returned by the <code><a href="#topic+rsm">rsm</a></code> function 
to represent a fitted regression-scale model.  Class <code>rsm</code> 
inherits from classes <code><a href="stats.html#topic+glm">glm</a></code> and 
<code><a href="stats.html#topic+lm">lm</a></code>, since it is fitted by iteratively reweighted
least squares.  The object returned has all the components of a 
weighted least squares object.  
</p>


<h3>Methods</h3>

<p>Objects of this class have methods for the functions 
<code><a href="base.html#topic+print">print</a></code>, <code><a href="base.html#topic+summary">summary</a></code>, 
<code><a href="stats.html#topic+anova">anova</a></code> and <code><a href="stats.html#topic+fitted">fitted</a></code> among 
others.
</p>


<h3>Note</h3>

<p>The residuals, fitted values and coefficients should be extracted by 
the generic functions of the same name, rather than by the <code>$</code> 
operator. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rsm">rsm</a></code>, <code><a href="stats.html#topic+glm">glm</a></code>, <code><a href="stats.html#topic+lm">lm</a></code>.
</p>

<hr>
<h2 id='rsm.surv'>
Fit a Regression-Scale Model Without Computing the Model Matrix
</h2><span id='topic+rsm.surv'></span>

<h3>Description</h3>

<p>Fits a <code>rsm</code> model without computing the model matrix of the 
response vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rsm.surv(X, Y, offset, family, dispersion, score.dispersion, maxit, epsilon, 
         trace, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rsm.surv_+3A_x">X</code></td>
<td>

<p>the model matrix (design matrix).
</p>
</td></tr>
<tr><td><code id="rsm.surv_+3A_y">Y</code></td>
<td>

<p>the response vector.
</p>
</td></tr>
<tr><td><code id="rsm.surv_+3A_offset">offset</code></td>
<td>

<p>optional offset added to the linear predictor.
</p>
</td></tr>
<tr><td><code id="rsm.surv_+3A_family">family</code></td>
<td>

<p>a <code>family.rsm</code> object, i.e. a list of functions and 
expressions characterizing the error distribution.  Families 
supported are <code>extreme</code> (Gumbel or extreme value), 
<code>logWeibull</code>, <code>logExponential</code>, <code>logRayleigh</code>, 
<code>logistic</code> and <code>student</code> (Student's t) with <code>df</code>
<code class="reqn">&gt;</code> 2.
</p>
</td></tr>
<tr><td><code id="rsm.surv_+3A_dispersion">dispersion</code></td>
<td>

<p>if <code>NULL</code>, the <abbr><span class="acronym">MLE</span></abbr> of the scale parameter is 
returned, otherwise the scale parameter is fixed to the numerical 
value passed through the argument. 
</p>
</td></tr>
<tr><td><code id="rsm.surv_+3A_score.dispersion">score.dispersion</code></td>
<td>

<p>must default to <code>NULL</code>.
</p>
</td></tr>	
<tr><td><code id="rsm.surv_+3A_maxit">maxit</code></td>
<td>

<p>maximum number of iterations.
</p>
</td></tr>
<tr><td><code id="rsm.surv_+3A_epsilon">epsilon</code></td>
<td>

<p>convergence threshold.
</p>
</td></tr>
<tr><td><code id="rsm.surv_+3A_trace">trace</code></td>
<td>

<p>if <code>TRUE</code>, iterations details are printed during execution.
</p>
</td></tr>
<tr><td><code id="rsm.surv_+3A_...">...</code></td>
<td>

<p>not used, but do absorb any redundant argument.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>rsm.surv</code> function is called internally by the 
<code><a href="#topic+rsm">rsm</a></code> routine to do the actual model fitting.  Although 
it is not intended to be used directly by the user, it may be useful
when the same data frame is used over and over again.  It might save
computational time, since the model matrix is not created.  No 
formula needs to be specified as an argument.  As no <code>weights</code>
argument is available, the response <code>Y</code> and the  model matrix 
<code>X</code> must already include the weights if weighting is desired.
</p>


<h3>Value</h3>

<p>an object, which is a subset of a <code>rsm</code> object. 
</p>


<h3>Note</h3>

<p>The <code>rsm.surv</code> function is the default option for 
<code><a href="#topic+rsm">rsm</a></code> for the <code>extreme</code>, <code>logistic</code>, 
<code>logWeibull</code>, <code>logExponential</code>, <code>logRayleigh</code> and 
<code>student</code> (with <code>df</code> larger than 2) error distributions. 
It makes use of the <code><a href="survival.html#topic+survreg.fit">survreg.fit</a></code> routine to 
estimate parametric survival models.  It receives <code>X</code> and 
<code>Y</code> data rather than a formula, but still uses the 
<code>family.rsm</code> object to define the <abbr><span class="acronym">IRLS</span></abbr> steps.  The
<code>rsm.surv</code> routine cannot be used for Huber-type and 
user-defined error distributions.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rsm">rsm</a></code>, <code><a href="#topic+rsm.fit">rsm.fit</a></code>, <code><a href="#topic+rsm.null">rsm.null</a></code>,
<code><a href="#topic+rsm.object">rsm.object</a></code>, <code><a href="#topic+rsm.families">rsm.families</a></code>
</p>

<hr>
<h2 id='summary.marg'>
Summary Method for Objects of Class &ldquo;marg&rdquo;
</h2><span id='topic+summary.marg'></span>

<h3>Description</h3>

<p>Returns a summary list for objects of class <code>marg</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'marg'
summary(object, alpha = 0.05, test = NULL, all = FALSE, 
        coef = TRUE, int = ifelse((is.null(test) || all), TRUE, FALSE), 
        digits = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.marg_+3A_object">object</code></td>
<td>

<p>a <code>marg</code> object.  This is assumed to be the result returned 
by the <code><a href="#topic+cond.rsm">cond.rsm</a></code> function.
</p>
</td></tr>
<tr><td><code id="summary.marg_+3A_alpha">alpha</code></td>
<td>

<p>a vector of levels for confidence intervals; the default is 5%.
</p>
</td></tr>
<tr><td><code id="summary.marg_+3A_test">test</code></td>
<td>

<p>a vector of values of the parameter of interest one wants to test
for.  If <code>NULL</code> no test is performed.  The default is 
<code>NULL</code>.
</p>
</td></tr>
<tr><td><code id="summary.marg_+3A_all">all</code></td>
<td>

<p>logical value; if <code>TRUE</code> all the information stored in the 
<code>summary.marg</code> object is printed, else only a subset of it.  
The default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="summary.marg_+3A_coef">coef</code></td>
<td>

<p>logical value; if <code>TRUE</code> the unconditional and approximate 
conditional/marginal <abbr><span class="acronym">MLE</span></abbr>s are printed.  The default is 
<code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="summary.marg_+3A_int">int</code></td>
<td>

<p>logical value; if <code>TRUE</code> confidence intervals are printed.  
The default is <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="summary.marg_+3A_digits">digits</code></td>
<td>

<p>the number of significant digits to be printed.  The default depends 
on the value of <code>digits</code> set by <code>options</code>
</p>
</td></tr>
<tr><td><code id="summary.marg_+3A_...">...</code></td>
<td>

<p>absorbs any additional argument.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is a method for the generic function <code>summary()</code> 
for objects of class <code>marg</code>.  It can be invoked by calling 
<code>summary</code> or directly <code>summary.marg</code> for an object of the 
appropriate class.
</p>


<h3>Value</h3>

<p>A list is returned with the following components:
</p>
<table>
<tr><td><code>coefficients</code></td>
<td>

<p>a <code class="reqn">2\times 2</code> matrix containing the unconditional and 
approximate conditional/marginal <abbr><span class="acronym">MLE</span></abbr>s and their standard
errors.
</p>
</td></tr>
<tr><td><code>conf.int</code></td>
<td>

<p>a matrix containing, for each level given in <code>alpha</code>, the 
upper and lower confidence bounds derived from several first and 
higher order test statistics.  One-sided and two-sided confidence 
intervals are considered.  See <code><a href="#topic+marg.object">marg.object</a></code> for 
details on the test statistics used.
</p>
</td></tr>
<tr><td><code>signif.tests</code></td>
<td>

<p>a list with two elements.  The first (<code>stats</code>) contains, for 
each value given in <code>test</code>, the values and tail probabilities 
of several first and higher order test statistics.  See 
<code><a href="#topic+marg.object">marg.object</a></code> for details on the test statistics.  The
second element of the list (<code>qTerm</code>) contains for each tested
hypothesis the correction term used in the higher order solutions.
</p>
</td></tr>
<tr><td><code>call</code></td>
<td>

<p>the function call that created the <code>marg</code> object.
</p>
</td></tr>
<tr><td><code>formula</code></td>
<td>

<p>the model formula.
</p>
</td></tr>
<tr><td><code>family</code></td>
<td>

<p>the name of the error distribution.
</p>
</td></tr>
<tr><td><code>offset</code></td>
<td>

<p>the covariate occurring in the model formula whose coefficient 
represents the parameter of interest or <code>scale</code> if the 
parameter of interest is the scale parameter.
</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>

<p>the vector of levels used to compute the confidence intervals.
</p>
</td></tr>
<tr><td><code>hypotheses</code></td>
<td>

<p>the values for the parameter of interest that have been tested for.
</p>
</td></tr>
<tr><td><code>diagnostics</code></td>
<td>

<p>the information and nuisance parameters aspects; see 
<code><a href="#topic+marg.object">marg.object</a></code> for details.
</p>
</td></tr>
<tr><td><code>n.approx</code></td>
<td>

<p>the number of output points that have been calculated exactly. 
</p>
</td></tr>
<tr><td><code>all</code></td>
<td>

<p>logical value; if <code>TRUE</code>, all the information stored in the
<code>summary.marg</code> object is printed.
</p>
</td></tr>
<tr><td><code>cf</code></td>
<td>

<p>logical value; if <code>TRUE</code>, the parameter estimates are printed.
</p>
</td></tr>
<tr><td><code>int</code></td>
<td>

<p>logical value; if <code>TRUE</code>, confidence intervals are printed.
</p>
</td></tr>
<tr><td><code>is.scalar</code></td>
<td>

<p>a logical value indicating whether there are any nuisance 
parameters.  If <code>FALSE</code> there are none.
</p>
</td></tr>
<tr><td><code>digits</code></td>
<td>

<p>the number of significant digits to be printed.
</p>
</td></tr>
</table>


<h3>Note</h3>

<p>If the parameter of interest is the scale parameter, all calculations
are performed on the log scale, though most results are reported
on the original scale.  
</p>
<p>The amount of information calculated may vary depending on whether 
there are any nuisance parameters.  A message is printed if there are
none.
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+summary">summary</a></code>, <code><a href="#topic+marg.object">marg.object</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## House Price Data
data(houses)
houses.rsm &lt;- rsm(price ~ ., family = student(5), data = houses)
houses.marg &lt;- cond(houses.rsm, floor)
summary(houses.marg, test = 0, coef = FALSE)
</code></pre>

<hr>
<h2 id='summary.rsm'>
Summary Method for Regression-Scale Models
</h2><span id='topic+summary.rsm'></span>

<h3>Description</h3>

<p>Returns a summary list for a fitted regression-scale model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rsm'
summary(object, correlation = FALSE, digits = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.rsm_+3A_object">object</code></td>
<td>

<p>a fitted <code>rsm</code> object.  This is assumed to be the result of 
some fit that produces an object inheriting from the class 
<code>rsm</code>, in the sense that the components returned by the 
<code>rsm</code> function will be available.
</p>
</td></tr>
<tr><td><code id="summary.rsm_+3A_correlation">correlation</code></td>
<td>

<p>logical argument.  If <code>TRUE</code>, the correlation matrix for the 
coefficients is computed; default is <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="summary.rsm_+3A_digits">digits</code></td>
<td>

<p>a non-null value specifies the minimum number of significant 
digits to be printed in values.  If <code>NULL</code>, the value of 
<code>digits</code> set by <code>options</code> is used.
</p>
</td></tr>
<tr><td><code id="summary.rsm_+3A_...">...</code></td>
<td>

<p>absorbs any additional argument.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is a method for the generic function 
<code>summary()</code> for class <code>rsm</code>.  It can be invoked by 
calling <code>summary</code> for an object of the appropriate class, or
directly by calling <code>summary.rsm</code> regardless of the class of
the object.
</p>


<h3>Value</h3>

<p>A list is returned with the following components:
</p>
<table>
<tr><td><code>coefficients</code></td>
<td>

<p>a matrix with four columns, containing the coefficients, their 
standard errors, the <code class="reqn">z</code>-values (or Wald statistics) and 
the associated <code class="reqn">p</code>-values based on the standard normal 
approximation to the distribution of the <code class="reqn">z</code> statistic.
</p>
</td></tr>
<tr><td><code>dispersion</code></td>
<td>

<p>the value of the scale parameter used in the computations.
</p>
</td></tr>
<tr><td><code>fixed</code></td>
<td>

<p>a logical value.  If <code>TRUE</code>, the scale parameter is known. 
</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>

<p>the response residuals.
</p>
</td></tr>
<tr><td><code>cov.unscaled</code></td>
<td>

<p>the unscaled covariance matrix, i.e, a matrix such that 
multiplying it by the squared scale parameter, or an estimate 
thereof, produces an estimated (asymptotic) covariance matrix for 
the coefficients.
</p>
</td></tr>
<tr><td><code>correlation</code></td>
<td>

<p>the computed correlation matrix for the coefficients in the model.
</p>
</td></tr>
<tr><td><code>family</code></td>
<td>

<p>the entire <code>family.rsm</code> object used.
</p>
</td></tr>
<tr><td><code>loglik</code></td>
<td>

<p>the computed log likelihood.
</p>
</td></tr>
<tr><td><code>terms</code></td>
<td>

<p>an object of mode <code>expression</code> and class <code>term</code> 
summarizing the formula.
</p>
</td></tr>
<tr><td><code>df</code></td>
<td>

<p>the number of degrees of freedom for the model and for the 
residuals.
</p>
</td></tr>
<tr><td><code>iter</code></td>
<td>

<p>the number of <abbr><span class="acronym">IRLS</span></abbr> iterations used to compute the estimates.
</p>
</td></tr>
<tr><td><code>nas</code></td>
<td>

<p>a logical vector indicating which, if any, coefficients are 
missing.
</p>
</td></tr>
<tr><td><code>call</code></td>
<td>

<p>an image of the call that produced the <code>rsm</code> object, but 
with the arguments all named and with the actual formula.
</p>
</td></tr>
<tr><td><code>digits</code></td>
<td>

<p>the value of the <code>digits</code> argument.
</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+rsm.object">rsm.object</a></code>, <code><a href="base.html#topic+summary">summary</a></code>,
<code><a href="#topic+rsm">rsm</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## House Price Data
data(houses)
houses.rsm &lt;- rsm(price ~ ., family = student(5), data = houses)
summary(houses.rsm)
</code></pre>

<hr>
<h2 id='update.rsm'>
Update and Re-fit a RSM Model Call</h2><span id='topic+update.rsm'></span>

<h3>Description</h3>

<p><code>update.rsm</code> is used to update a <code><a href="#topic+rsm">rsm</a></code> model 
formulae.  This typically involves adding or dropping terms, but 
updates can be more general.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rsm'
update(object, formula., ..., evaluate = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="update.rsm_+3A_object">object</code></td>
<td>

<p>a model of class <code>rsm</code> to be updated.
</p>
</td></tr>
<tr><td><code id="update.rsm_+3A_formula.">formula.</code></td>
<td>

<p>changes to the formula &ndash; see <code><a href="stats.html#topic+update.formula">update.formula</a></code> 
for details.
</p>
</td></tr>
<tr><td><code id="update.rsm_+3A_...">...</code></td>
<td>

<p>additional arguments to the call, or arguments with changed
values.  Use <code>name = NULL</code> to remove the argument 
<code>name</code>.
</p>
</td></tr>
<tr><td><code id="update.rsm_+3A_evaluate">evaluate</code></td>
<td>

<p>if <code>TRUE</code> evaluate the new call else return the call.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If <code>evaluate = TRUE</code> the fitted object, otherwise the updated 
call.
</p>


<h3>Note</h3>

<p>Based upon <code><a href="stats.html#topic+update.default">update.default</a></code>.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+update">update</a></code>, <code><a href="stats.html#topic+update.default">update.default</a></code>, 
<code><a href="stats.html#topic+update.formula">update.formula</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(houses)
houses.rsm &lt;- rsm(price ~ ., family = student(5), data = houses)
## model fit including all covariates
##
houses.rsm &lt;- update(houses.rsm, method = "rsm.fit", 
                     control = glm.control(trace = TRUE))
## prints information about the iterative procedure at each iteration
##
update(houses.rsm, ~ . - bdroom + offset(7 * bdroom))
## "bdroom" is included as offset variable with fixed (= 7) coefficient
</code></pre>

<hr>
<h2 id='vcov.rsm'>Calculate Variance-Covariance Matrix for a Fitted RSM Model</h2><span id='topic+vcov.rsm'></span>

<h3>Description</h3>

<p>Returns the variance-covariance matrix of the parameters of a
fitted <code><a href="#topic+rsm">rsm</a></code> model object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rsm'
vcov(object, correlation = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vcov.rsm_+3A_object">object</code></td>
<td>
 
<p>a fitted model object of class <code>rsm</code>.
</p>
</td></tr>
<tr><td><code id="vcov.rsm_+3A_correlation">correlation</code></td>
<td>

<p>if <code>TRUE</code> the correlation matrix is returned instead of the
variance-covariance matrix.
</p>
</td></tr>
<tr><td><code id="vcov.rsm_+3A_...">...</code></td>
<td>
 
<p>absobs any additional argument.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a method for function <code><a href="stats.html#topic+vcov">vcov</a></code> for objects
of class <code>rsm</code>.
</p>


<h3>Value</h3>

<p>A matrix of the estimated covariances between the parameter
estimates of a fitted regression-scale model, or, if 
<code>dispersion = TRUE</code> the correlation matrix.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+vcov">vcov</a></code>, <code><a href="#topic+rsm.object">rsm.object</a></code>,
<code><a href="#topic+rsm">rsm</a></code>, <code><a href="#topic+summary.rsm">summary.rsm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Sea Level Data
data(venice)
attach(venice)
Year &lt;- 1:51/51
c11 &lt;- cos(2*pi*1:51/11) ; s11 &lt;- sin(2*pi*1:51/11)
c19 &lt;- cos(2*pi*1:51/18.62) ; s19 &lt;- sin(2*pi*1:51/18.62)
venice.rsm &lt;- rsm(sea ~ Year + I(Year^2) + c11 + s11 + c19 + s19, 
                  family = extreme)
##
vcov(venice.rsm)
vcov(venice.rsm, corr = TRUE)
##
detach()
</code></pre>

<hr>
<h2 id='venice'>Sea Level Data</h2><span id='topic+venice'></span>

<h3>Description</h3>

<p>The <code>venice</code> data frame has 51 rows and 2 columns.
</p>
<p><cite>Pirazzoli (1982)</cite> collected the ten largest values of sea 
levels in Venice (with a few exceptions) for the years 1887&ndash;1981.  
The <code>venice</code> data frame contains the maxima for the years 
1931&ndash;1981.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(venice)</code></pre>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt><code>year</code></dt><dd>
<p>the years;
</p>
</dd>
<dt><code>sea</code></dt><dd>
<p>the sea levels (in cm).
</p>
</dd>
</dl>



<h3>Source</h3>

<p>The data were obtained from
</p>
<p>Smith, R. L. (1986) Extreme value theory based on the 
<code class="reqn">r</code>-largest annual events.  <em>Journal of Hydrology </em>, 
<b>86</b>, 27&ndash;43.
</p>


<h3>References</h3>

<p>Pirazzoli, P. (1982) Maree estreme a Venezia (periodo 1872&ndash;1981).
<em>Acqua Aria</em>, <b>10</b>, 1023&ndash;1039.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(venice)
attach(venice)
#
plot(sea ~ year, ylab = "sea level")
##
Year &lt;- 1:51/51
venice.l &lt;- rsm(sea ~ Year + I(Year^2), family = extreme)
lines(year, fitted(venice.l))
##
c11 &lt;- cos(2*pi*1:51/11) ; s11 &lt;- sin(2*pi*1:51/11)
c19 &lt;- cos(2*pi*1:51/18.62) ; s19 &lt;- sin(2*pi*1:51/18.62)
venice.p &lt;- rsm(sea ~ Year + I(Year^2) + c11 + s11 + c19 + s19, 
                family = extreme)
lines(year, fitted(venice.p), col = "red")
##
detach()
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
