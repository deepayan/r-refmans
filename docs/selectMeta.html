<!DOCTYPE html><html><head><title>Help for package selectMeta</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {selectMeta}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#selectMeta-package'><p>Estimation of Weight Functions in Meta Analysis</p></a></li>
<li><a href='#DearBegg'><p>Compute the nonparametric weight function from Dear and Begg (1992)</p></a></li>
<li><a href='#DearBeggMonotoneCItheta'><p>Compute an approximate profile likelihood ratio confidence interval for effect estimate</p></a></li>
<li><a href='#DearBeggMonotonePvalSelection'><p>Compute simulation-based p-value to assess null hypothesis of no selection</p></a></li>
<li><a href='#education'><p>Dataset open vs. traditional education on creativity</p></a></li>
<li><a href='#effectBias'><p>Compute bias for each effect size based on estimated weight function</p></a></li>
<li><a href='#IyenGreen'><p>Compute MLE and weight functions of Iyengar and Greenhouse (1988)</p></a></li>
<li><a href='#passive_smoking'><p>Dataset on the effect of environmental tobacco smoke</p></a></li>
<li><a href='#pPool'><p>Pool p-values in pairs</p></a></li>
<li><a href='#Pval'><p>Functions for the distribution of p-values</p></a></li>
<li><a href='#weightLine'><p>Function to plot estimated weight functions</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Estimation of Weight Functions in Meta Analysis</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.8</td>
</tr>
<tr>
<td>Date:</td>
<td>2015-07-03</td>
</tr>
<tr>
<td>Author:</td>
<td>Kaspar Rufibach &lt;kaspar.rufibach@gmail.com&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Kaspar Rufibach &lt;kaspar.rufibach@gmail.com&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>DEoptim (&ge; 2.0-6)</td>
</tr>
<tr>
<td>Imports:</td>
<td>graphics, stats</td>
</tr>
<tr>
<td>Description:</td>
<td>Publication bias, the fact that studies identified for inclusion in a meta analysis do not represent all studies on the topic of interest, is commonly recognized as a threat to the validity of the results of a meta analysis. One way to explicitly model publication bias is via selection models or weighted probability distributions. In this package we provide implementations of several parametric and nonparametric weight functions. The novelty in Rufibach (2011) is the proposal of a non-increasing variant of the nonparametric weight function of Dear &amp; Begg (1992). The new approach potentially offers more insight in the selection process than other methods, but is more flexible than parametric approaches. To maximize the log-likelihood function proposed by Dear &amp; Begg (1992) under a monotonicity constraint we use a differential evolution algorithm proposed by Ardia et al (2010a, b) and implemented in Mullen et al (2009). In addition, we offer a method to compute a confidence interval for the overall effect size theta, adjusted for selection bias as well as a function that computes the simulation-based p-value to assess the null hypothesis of no selection as described in Rufibach (2011, Section 6).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="http://www.kasparrufibach.ch">http://www.kasparrufibach.ch</a></td>
</tr>
<tr>
<td>Packaged:</td>
<td>2015-07-03 09:52:15 UTC; rufibach</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2015-07-03 12:51:10</td>
</tr>
</table>
<hr>
<h2 id='selectMeta-package'>Estimation of Weight Functions in Meta Analysis</h2><span id='topic+selectMeta-package'></span><span id='topic+selectMeta'></span>

<h3>Description</h3>

<p>Publication bias, the fact that studies identified for inclusion in a meta analysis do not represent
all studies on the topic of interest, is commonly recognized as a threat to the validity of the results
of a meta analysis. One way to explicitly model publication bias is via selection models or weighted
probability distributions. For details we refer to Iyengar &amp; Greenhouse (1998), Dear &amp; Begg (1992), 
and Rufibach (2011). In this package we provide implementations of all the weight functions proposed in these
papers. The novelty in Rufibach (2011) is the proposal of a non-increasing variant of the nonparametric weight
function of Dear &amp; Begg (1992). Since virtually all parametric weight functions proposed so far in the literature 
are in fact decreasing and only few studies are included in a typical meta analysis regularization by imposing
monotonicity seems a sensible approach. The new approach potentially offers more insight
in the selection process than other methods, but is more flexible than parametric approaches.
To maximize the log-likelihood function proposed by Dear &amp; Begg (1992) under a monotonicity constraint on <code class="reqn">w</code>
we use a differential evolution algorithm proposed by Ardia et al (2010a, b) and implemented in Mullen et al (2009).
</p>
<p>The main functions in this package are <code><a href="#topic+IyenGreen">IyenGreen</a></code> and <code><a href="#topic+DearBegg">DearBegg</a></code>. 
Using <code><a href="#topic+DearBeggMonotoneCItheta">DearBeggMonotoneCItheta</a></code> one can compute a profile likelihood confidence interval for the overall effect size <code class="reqn">\theta</code>
and using <code><a href="#topic+DearBeggMonotonePvalSelection">DearBeggMonotonePvalSelection</a></code> the simulation-based <code class="reqn">p</code>-value to assess the null hypothesis of no selection, as
described in Rufibach (2011, Section 6), can be computed. In addition, we provide two datasets: 
<code><a href="#topic+education">education</a></code>, a dataset frequently used in illustration of meta analysis and <code><a href="#topic+passive_smoking">passive_smoking</a></code>, a second dataset
that has caused some controversy about whether publication bias is present in this dataset or not.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> selectMeta</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.0.8</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2015-07-03</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;=2) </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Kaspar Rufibach (maintainer), <a href="mailto:kaspar.rufibach@gmail.com">kaspar.rufibach@gmail.com</a>, <br /> <a href="http://www.kasparrufibach.ch">http://www.kasparrufibach.ch</a>
</p>


<h3>References</h3>

<p>Ardia, D., Boudt, K., Carl, P., Mullen, K.M., Peterson, B.G. (2010).
Differential Evolution ('DEoptim') for Non-Convex Portfolio Optimization. 
</p>
<p>Ardia, D., Mullen, K.M., et.al. (2010). The 'DEoptim' Package:
Differential Evolution Optimization in 'R'. Version 2.0-7.
</p>
<p>Dear, K.B.G. and Begg, C.B. (1992).
An Approach for Assessing Publication Bias Prior to Performing a Meta-Analysis.
<em>Statist. Sci.</em>, <b>7(2)</b>, 237&ndash;245.
</p>
<p>Hedges, L. and Olkin, I. (1985).
Statistical Methods for Meta-Analysis. 
Academic, Orlando, Florida.
</p>
<p>Iyengar, S. and Greenhouse, J.B. (1988).
Selection models and the file drawer problem.
<em>Statist. Sci.</em>, <b>3</b>, 109&ndash;135.
</p>
<p>Mullen, K.M., Ardia, D., Gil, D.L., Windover, D., Cline, J. (2009).
'DEoptim': An 'R' Package for Global Optimization by Differential Evolution. 
</p>
<p>Rufibach, K. (2011).
Selection Models with Monotone Weight Functions in Meta-Analysis.
<em>Biom. J.</em>, <b>53</b>(4), 689&ndash;704. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'># All functions in this package are illustrated 
# in the help file for the function DearBegg().
</code></pre>

<hr>
<h2 id='DearBegg'>Compute the nonparametric weight function from Dear and Begg (1992)</h2><span id='topic+DearBegg'></span><span id='topic+DearBeggMonotone'></span><span id='topic+DearBeggLoglik'></span><span id='topic+DearBeggToMinimize'></span><span id='topic+Hij'></span>

<h3>Description</h3>

<p>In Dear and Begg (1992) it was proposed to nonparametrically estimate via maximum likelihood the weight function <code class="reqn">w</code> in a selection model via
pooling <code class="reqn">p</code>-values in groups of 2 and assuming a piecewise constant <code class="reqn">w</code>. The function <code><a href="#topic+DearBegg">DearBegg</a></code> implements estimation of <code class="reqn">w</code> via 
a coordinate-wise Newton-Raphson algorithm as described in Dear and Begg (1992). In addition, the function <code><a href="#topic+DearBeggMonotone">DearBeggMonotone</a></code> enables computation of the 
weight function in the same model under the constraint that it is non-increasing, see Rufibach (2011). To this end we use the differential evolution algorithm
described in Ardia et al (2010a, b) and implemented in Mullen et al (2009).
The functions <code><a href="#topic+Hij">Hij</a></code>, <code><a href="#topic+DearBeggLoglik">DearBeggLoglik</a></code>, and <code><a href="#topic+DearBeggToMinimize">DearBeggToMinimize</a></code> are not intended to be called by the user.</p>


<h3>Usage</h3>

<pre><code class='language-R'>DearBegg(y, u, lam = 2, tolerance = 10^-10, maxiter = 1000, 
    trace = TRUE)
DearBeggMonotone(y, u, lam = 2, maxiter = 1000, CR = 0.9, 
    NP = NA, trace = TRUE)
Hij(theta, sigma, y, u, teststat)
DearBeggLoglik(w, theta, sigma, y, u, hij, lam)
DearBeggToMinimize(vec, y, u, lam)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DearBegg_+3A_y">y</code></td>
<td>
<p>Normally distributed effect sizes.</p>
</td></tr>
<tr><td><code id="DearBegg_+3A_u">u</code></td>
<td>
<p>Associated standard errors.</p>
</td></tr>
<tr><td><code id="DearBegg_+3A_lam">lam</code></td>
<td>
<p>Weight of the first entry of <code class="reqn">w</code> in the likelihood function. Dear and Begg (1992) recommend to use <code>lam = 2</code>.</p>
</td></tr>
<tr><td><code id="DearBegg_+3A_tolerance">tolerance</code></td>
<td>
<p>Stopping criterion for Newton-Raphson.</p>
</td></tr>
<tr><td><code id="DearBegg_+3A_maxiter">maxiter</code></td>
<td>
<p>Maximal number of iterations for Newton-Raphson.</p>
</td></tr>
<tr><td><code id="DearBegg_+3A_trace">trace</code></td>
<td>
<p>If <code>TRUE</code>, progress of the algorithm is shown.</p>
</td></tr>
<tr><td><code id="DearBegg_+3A_cr">CR</code></td>
<td>
<p>Parameter that is given to <code>DEoptim</code>. See the help file of the function <code>DEoptim.control</code> for details.</p>
</td></tr>
<tr><td><code id="DearBegg_+3A_np">NP</code></td>
<td>
<p>Parameter that is given to <code>DEoptim</code>. See the help file of the function <code>DEoptim.control</code> for details.</p>
</td></tr>
<tr><td><code id="DearBegg_+3A_w">w</code></td>
<td>
<p>Weight function, parametrized as vector of length <code class="reqn">1 + \lfloor(n / 2)\rfloor</code> where <code class="reqn">n</code> is the number of studies, i.e. the length of <code class="reqn">y</code>.</p>
</td></tr>
<tr><td><code id="DearBegg_+3A_theta">theta</code></td>
<td>
<p>Effect size estimate.</p>
</td></tr>
<tr><td><code id="DearBegg_+3A_sigma">sigma</code></td>
<td>
<p>Random effects variance component.</p>
</td></tr>
<tr><td><code id="DearBegg_+3A_hij">hij</code></td>
<td>
<p>Integral of density over a constant piece of <code class="reqn">w</code>. See Rufibach (2011, Appendix) for details.</p>
</td></tr>
<tr><td><code id="DearBegg_+3A_vec">vec</code></td>
<td>
<p>Vector of parameters over which we maximize.</p>
</td></tr>
<tr><td><code id="DearBegg_+3A_teststat">teststat</code></td>
<td>
<p>Vector of test statistics, equals <code class="reqn">|y| / u</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list consisting of the following elements:
</p>
<table>
<tr><td><code>w</code></td>
<td>
<p>Vector of estimated weights.</p>
</td></tr>
<tr><td><code>theta</code></td>
<td>
<p>Estimate of the combined effect in the Dear and Begg model.</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>Estimate of the random effects component variance.</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p><code class="reqn">p</code>-values computed from the inputed test statistics, ordered in decreasing order.</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>Effect sizes, ordered in decreasing order of <code class="reqn">p</code>-values.</p>
</td></tr>
<tr><td><code>u</code></td>
<td>
<p>Standard errors, ordered in decreasing order of <code class="reqn">p</code>-values.</p>
</td></tr>
<tr><td><code>loglik</code></td>
<td>
<p>Value of the log-likelihood at the maximum.</p>
</td></tr>
<tr><td><code>DEoptim.res</code></td>
<td>
<p>Only available in <code><a href="#topic+DearBeggMonotone">DearBeggMonotone</a></code>. Provides the object that is outputted by <code><a href="DEoptim.html#topic+DEoptim">DEoptim</a></code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kaspar Rufibach (maintainer), <a href="mailto:kaspar.rufibach@gmail.com">kaspar.rufibach@gmail.com</a>, <br /> <a href="http://www.kasparrufibach.ch">http://www.kasparrufibach.ch</a>
</p>


<h3>References</h3>

<p>Ardia, D., Boudt, K., Carl, P., Mullen, K.M., Peterson, B.G. (2010).
Differential Evolution ('DEoptim') for Non-Convex Portfolio Optimization. 
</p>
<p>Ardia, D., Mullen, K.M., et.al. (2010). The 'DEoptim' Package:
Differential Evolution Optimization in 'R'. Version 2.0-7.
</p>
<p>Dear, K.B.G. and Begg, C.B. (1992).
An Approach for Assessing Publication Bias Prior to Performing a Meta-Analysis.
<em>Statist. Sci.</em>, <b>7(2)</b>, 237&ndash;245.
</p>
<p>Mullen, K.M., Ardia, D., Gil, D.L., Windover, D., Cline, J. (2009).
'DEoptim': An 'R' Package for Global Optimization by Differential Evolution. 
</p>
<p>Rufibach, K. (2011).
Selection Models with Monotone Weight Functions in Meta-Analysis.
<em>Biom. J.</em>, <b>53</b>(4), 689&ndash;704. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+IyenGreen">IyenGreen</a></code> for a parametric selection model.</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
##------------------------------------------
## Analysis of Hedges &amp; Olkin dataset
## re-analyzed in Iyengar &amp; Greenhouse, Dear &amp; Begg
##------------------------------------------
data(education)
t  &lt;- education$t
q  &lt;- education$q
N  &lt;- education$N
y  &lt;- education$theta 
u  &lt;- sqrt(2 / N)
n  &lt;- length(y)
k  &lt;- 1 + floor(n / 2)
lam1 &lt;- 2

## compute p-values
p &lt;- 2 * pnorm(-abs(t))


##------------------------------------------
## compute all weight functions available
## in this package
##------------------------------------------

## weight functions from Iyengar &amp; Greenhouse (1988)
res1 &lt;- IyenGreenMLE(t, q, N, type = 1)
res2 &lt;- IyenGreenMLE(t, q, N, type = 2)

## weight function from Dear &amp; Begg (1992)
res3 &lt;- DearBegg(y, u, lam = lam1)

## monotone version of Dear &amp; Begg, as introduced in Rufibach (2011)
set.seed(1977)
res4 &lt;- DearBeggMonotone(y, u, lam = lam1, maxiter = 1000, CR = 1)

## plot
plot(0, 0, type = "n", xlim = c(0, 1), ylim = c(0, 1), xlab = "p-values", 
    ylab = "estimated weight function")
ps &lt;- seq(0, 1, by = 0.01)
rug(p, lwd = 3)
lines(ps, IyenGreenWeight(-qnorm(ps / 2), b = res1$beta, q = 50, 
    type = 1, alpha = 0.05), lwd = 3, col = 2)
lines(ps, IyenGreenWeight(-qnorm(ps / 2), b = res2$beta, q = 50, 
    type = 2, alpha = 0.05), lwd = 3, col = 4)
weightLine(p, w = res3$w, col0 = 3, lwd0 = 3, lty0 = 2)  
weightLine(p, w = res4$w, col0 = 6, lwd0 = 2, lty0 = 1)  

legend("topright", c(expression("Iyengar &amp; Greenhouse (1988) w"[1]), 
    expression("Iyengar &amp; Greenhouse (1988) w"[2]), "Dear and Begg (1992)", 
    "Rufibach (2011)"), col = c(2, 4, 3, 6), lty = c(1, 1, 2, 1), 
    lwd = c(3, 3, 3, 2), bty = "n")

## compute selection bias
eta &lt;- sqrt(res4$sigma ^ 2 + res4$u ^ 2)
bias &lt;- effectBias(res4$y, res4$u, res4$w, res4$theta, eta)
bias


##------------------------------------------
## Compute p-value to assess null hypothesis of no selection,
## as described in Rufibach (2011, Section 6)
## We use the package 'meta' to compute initial estimates for
## theta and sigma
##------------------------------------------
library(meta)

## compute null parameters
meta.edu &lt;- metagen(TE = y, seTE = u, sm = "MD", level = 0.95, 
    comb.fixed = TRUE, comb.random = TRUE)
theta0 &lt;- meta.edu$TE.random
sigma0 &lt;- meta.edu$tau

M &lt;- 1000
res &lt;- DearBeggMonotonePvalSelection(y, u, theta0, sigma0, lam = lam1, 
    M = M, maxiter = 1000)

## plot all the computed monotone functions
plot(0, 0, xlim = c(0, 1), ylim = c(0, 1), type = "n", xlab = "p-values", 
    ylab = expression(w(p)))
abline(v = 0.05, lty = 3)
for (i in 1:M){weightLine(p, w = res$res.mono[1:k, i], col0 = grey(0.8), 
    lwd0 = 1, lty0 = 1)}
rug(p, lwd = 2)
weightLine(p, w = res$mono0, col0 = 2, lwd0 = 1, lty0 = 1)  


## =======================================================================


##------------------------------------------
## Analysis second-hand tobacco smoke dataset
## Rothstein et al (2005), Publication Bias in Meta-Analysis, Appendix A
##------------------------------------------
data(passive_smoking)
u &lt;- passive_smoking$selnRR
y &lt;- passive_smoking$lnRR
n &lt;- length(y)
k &lt;- 1 + floor(n / 2)
lam1 &lt;- 2

res2 &lt;- DearBegg(y, u, lam = lam1)
set.seed(1)
res3 &lt;- DearBeggMonotone(y = y, u = u, lam = lam1, maxiter = 2000, CR = 1)

plot(0, 0, type = "n", xlim = c(0, 1), ylim = c(0, 1), pch = 19, col = 1, 
    xlab = "p-values", ylab = "estimated weight function")
weightLine(rev(sort(res2$p)), w = res2$w, col0 = 2, lwd0 = 3, lty0 = 2)  
weightLine(rev(sort(res3$p)), w = res3$w, col0 = 4, lwd0 = 2, lty0 = 1)  

legend("bottomright", c("Dear and Begg (1992)", "Rufibach (2011)"), col = 
    c(2, 4), lty = c(2, 1), lwd = c(3, 2), bty = "n")
    
## compute selection bias
eta &lt;- sqrt(res3$sigma ^ 2 + res3$u ^ 2)
bias &lt;- effectBias(res3$y, res3$u, res3$w, res3$theta, eta)
bias  


##------------------------------------------
## Compute p-value to assess null hypothesis of no selection
##------------------------------------------
## compute null parameters
meta.toba &lt;- metagen(TE = y, seTE = u, sm = "MD", level = 0.95, 
    comb.fixed = TRUE, comb.random = TRUE)
theta0 &lt;- meta.toba$TE.random
sigma0 &lt;- meta.toba$tau

M &lt;- 1000
res &lt;- DearBeggMonotonePvalSelection(y, u, theta0, sigma0, lam = lam1, 
    M = M, maxiter = 2000)

## plot all the computed monotone functions
plot(0, 0, xlim = c(0, 1), ylim = c(0, 1), type = "n", xlab = "p-values", 
    ylab = expression(w(p)))
abline(v = 0.05, lty = 3)
for (i in 1:M){weightLine(p, w = res$res.mono[1:k, i], col0 = grey(0.8), 
    lwd0 = 1, lty0 = 1)}
rug(p, lwd = 2)
weightLine(p, w = res$mono0, col0 = 2, lwd0 = 1, lty0 = 1)

## End(Not run)
</code></pre>

<hr>
<h2 id='DearBeggMonotoneCItheta'>Compute an approximate profile likelihood ratio confidence interval for effect estimate</h2><span id='topic+DearBeggMonotoneCItheta'></span><span id='topic+DearBeggProfileLL'></span><span id='topic+DearBeggToMinimizeProfile'></span>

<h3>Description</h3>

<p>Under some assumptions on the true underlying <code class="reqn">p</code>-value density the usual likelihood ratio theory for the finite-dimensional
parameter of interest, <code class="reqn">\theta</code>, holds although we estimate the infinite-dimensional nuisance parameter <code class="reqn">w</code>, see Murphy and van der Vaart (2000). 
These functions implement such a confidence interval. To this end we compute the set
</p>
<p style="text-align: center;"><code class="reqn">\{\theta : \tilde l(\theta, \hat \sigma(\theta), \hat w(\theta)) \ge c\}</code>
</p>

<p>where <code class="reqn">c = - 0.5 \cdot \chi_{1-\alpha}^2(1)</code> and <code class="reqn">\tilde l</code> is the relative profile log-likelihood function.
</p>
<p>The functions <code><a href="#topic+DearBeggProfileLL">DearBeggProfileLL</a></code> and <code><a href="#topic+DearBeggToMinimizeProfile">DearBeggToMinimizeProfile</a></code> are not intended to be called by the user directly.</p>


<h3>Usage</h3>

<pre><code class='language-R'>DearBeggMonotoneCItheta(res, lam = 2, conf.level = 0.95, maxiter = 500)
DearBeggProfileLL(z, res0, lam, conf.level = 0.95, maxiter = 500)
DearBeggToMinimizeProfile(vec, theta, y, u, lam)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DearBeggMonotoneCItheta_+3A_res">res</code></td>
<td>
<p>Output from function <code><a href="#topic+DearBeggMonotone">DearBeggMonotone</a></code>.</p>
</td></tr>
<tr><td><code id="DearBeggMonotoneCItheta_+3A_lam">lam</code></td>
<td>
<p>Weight of the first entry of <code class="reqn">w</code> in the likelihood function. Should be the same as used to generate <code>res</code>.</p>
</td></tr>
<tr><td><code id="DearBeggMonotoneCItheta_+3A_conf.level">conf.level</code></td>
<td>
<p>Confidence level of confidence interval.</p>
</td></tr>
<tr><td><code id="DearBeggMonotoneCItheta_+3A_maxiter">maxiter</code></td>
<td>
<p>Maximum number of iterations of differential evolution algorithm used in computation of confidence limits. Increase this number to get higher accuracy.</p>
</td></tr>
<tr><td><code id="DearBeggMonotoneCItheta_+3A_z">z</code></td>
<td>
<p>Variable to maximize over, corresponds to <code class="reqn">\theta</code>.</p>
</td></tr>  
<tr><td><code id="DearBeggMonotoneCItheta_+3A_res0">res0</code></td>
<td>
<p>Output from <code><a href="#topic+DearBeggMonotone">DearBeggMonotone</a></code>, contains initial estimates.</p>
</td></tr>  
<tr><td><code id="DearBeggMonotoneCItheta_+3A_vec">vec</code></td>
<td>
<p>Vector of parameters over which we maximize.</p>
</td></tr>
<tr><td><code id="DearBeggMonotoneCItheta_+3A_theta">theta</code></td>
<td>
<p>Current <code class="reqn">\theta</code>.</p>
</td></tr>  
<tr><td><code id="DearBeggMonotoneCItheta_+3A_y">y</code></td>
<td>
<p>Normally distributed effect sizes.</p>
</td></tr>
<tr><td><code id="DearBeggMonotoneCItheta_+3A_u">u</code></td>
<td>
<p>Associated standard errors.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the element
</p>
<table>
<tr><td><code>ci.theta</code></td>
<td>
<p>that contains the profile likelihood confidence interval for <code class="reqn">\theta</code>.</p>
</td></tr></table>


<h3>Note</h3>

<p>Since we have to numerically find zeros of a suitable function, via <code><a href="stats.html#topic+uniroot">uniroot</a></code>, to get the limits and each iteration involves
computation of <code class="reqn">w(\theta)</code> via a variant of <code><a href="#topic+DearBeggMonotone">DearBeggMonotone</a></code>, computation of a confidence interval may take some time (typically seconds
to minutes).</p>


<h3>Author(s)</h3>

<p>Kaspar Rufibach (maintainer), <a href="mailto:kaspar.rufibach@gmail.com">kaspar.rufibach@gmail.com</a>, <br /> <a href="http://www.kasparrufibach.ch">http://www.kasparrufibach.ch</a>
</p>


<h3>References</h3>

<p>Murphy, S. and van der Vaart, A. (2000).
On profile likelihood.
<em>J. Amer. Statist. Assoc.</em>, <b>95</b>, 449&ndash;485.
</p>
<p>Rufibach, K. (2011).
Selection Models with Monotone Weight Functions in Meta-Analysis.
<em>Biom. J.</em>, <b>53</b>(4), 689&ndash;704. 
</p>


<h3>See Also</h3>

<p>The estimate under a monotone selection function can be computed using <cite><a href="#topic+DearBeggMonotone">DearBeggMonotone</a></cite>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## compute confidence interval for theta in the education dataset
data(education)
N  &lt;- education$N
y  &lt;- education$theta
u  &lt;- sqrt(2 / N)
lam1 &lt;- 2
res.edu &lt;- DearBeggMonotone(y, u, lam = lam1, maxiter = 1000, 
    CR = 1, trace = FALSE)
r1 &lt;- DearBeggMonotoneCItheta(res.edu, lam = 2, conf.level = 0.95)
res.edu$theta
r1$ci.theta

## compute confidence interval for theta in the passive smoking dataset
data(passive_smoking)
u &lt;- passive_smoking$selnRR
y &lt;- passive_smoking$lnRR
lam1 &lt;- 2
res.toba &lt;- DearBeggMonotone(y, u, lam = lam1, maxiter = 1000, 
    CR = 1, trace = FALSE)
r2 &lt;- DearBeggMonotoneCItheta(res.toba, lam = 2, conf.level = 0.95)
res.toba$theta
r2$ci.theta

## End(Not run)
</code></pre>

<hr>
<h2 id='DearBeggMonotonePvalSelection'>Compute simulation-based p-value to assess null hypothesis of no selection</h2><span id='topic+DearBeggMonotonePvalSelection'></span>

<h3>Description</h3>

<p>This function computes a simulation-based <code class="reqn">p</code>-value to assess the null hypothesis of no selection. For details we refer
to Rufibach (2011, Section 6).</p>


<h3>Usage</h3>

<pre><code class='language-R'>DearBeggMonotonePvalSelection(y, u, theta0, sigma0, lam = 2, M = 1000, 
    maxiter = 1000, test.stat = function(x){return(min(x))})</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DearBeggMonotonePvalSelection_+3A_y">y</code></td>
<td>
<p>Normally distributed effect sizes.</p>
</td></tr>
<tr><td><code id="DearBeggMonotonePvalSelection_+3A_u">u</code></td>
<td>
<p>Associated standard errors.</p>
</td></tr>
<tr><td><code id="DearBeggMonotonePvalSelection_+3A_theta0">theta0</code></td>
<td>
<p>Initial estimate for <code class="reqn">\theta</code>.</p>
</td></tr>
<tr><td><code id="DearBeggMonotonePvalSelection_+3A_sigma0">sigma0</code></td>
<td>
<p>Initial estimate for <code class="reqn">\sigma</code>.</p>
</td></tr>
<tr><td><code id="DearBeggMonotonePvalSelection_+3A_lam">lam</code></td>
<td>
<p>Weight of the first entry of <code class="reqn">w</code> in the likelihood function. Should be the same as used to generate <code>res</code>.</p>
</td></tr>
<tr><td><code id="DearBeggMonotonePvalSelection_+3A_m">M</code></td>
<td>
<p>Number of runs to compute <code class="reqn">p</code>-value.</p>
</td></tr>
<tr><td><code id="DearBeggMonotonePvalSelection_+3A_maxiter">maxiter</code></td>
<td>
<p>Maximum number of iterations of differential evolution algorithm. Increase this number to get higher accuracy.</p>
</td></tr>
<tr><td><code id="DearBeggMonotonePvalSelection_+3A_test.stat">test.stat</code></td>
<td>
<p>A function that takes as argument a vector and returns a number. Defines the test statistic to be used on the estimated
selection function <code class="reqn">w</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>pval</code></td>
<td>
<p>The computed <code class="reqn">p</code>-value.</p>
</td></tr>
<tr><td><code>res.mono</code></td>
<td>
<p>The monotone estimates for each simulation run.</p>
</td></tr>
<tr><td><code>mono0</code></td>
<td>
<p>The monotone estimates for the original data.</p>
</td></tr>
<tr><td><code>Ti</code></td>
<td>
<p>The test statistics for each simulation run.</p>
</td></tr>
<tr><td><code>T0</code></td>
<td>
<p>The test statistic for the original data.</p>
</td></tr>
<tr><td><code>ran.num</code></td>
<td>
<p>Matrix that contains the generated <code class="reqn">p</code>-values.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kaspar Rufibach (maintainer), <a href="mailto:kaspar.rufibach@gmail.com">kaspar.rufibach@gmail.com</a>, <br /> <a href="http://www.kasparrufibach.ch">http://www.kasparrufibach.ch</a></p>


<h3>References</h3>

<p>Rufibach, K. (2011).
Selection Models with Monotone Weight Functions in Meta-Analysis.
<em>Biom. J.</em>, <b>53</b>(4), 689&ndash;704. 
</p>


<h3>See Also</h3>

<p>This function is illustrated in the help file for <code><a href="#topic+DearBegg">DearBegg</a></code>.</p>

<hr>
<h2 id='education'>Dataset open vs. traditional education on creativity</h2><span id='topic+education'></span>

<h3>Description</h3>

<p>Dataset of studies of effect of open vs. traditional education on creativity. Standard dataset to illustrate selection models in meta-analysis.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(education)</code></pre>


<h3>Format</h3>

<p>A data frame with 10 observations on the following 5 variables.
</p>

<dl>
<dt><code>i</code></dt><dd><p>Study number.</p>
</dd>
<dt><code>N</code></dt><dd><p>Sample size of study.</p>
</dd>
<dt><code>theta</code></dt><dd><p>Estimated effect size.</p>
</dd>
<dt><code>t</code></dt><dd><p><code class="reqn">t</code> test statistic, <code class="reqn">t = \theta / \sqrt{2 / N}</code>.</p>
</dd>
<dt><code>q</code></dt><dd><p>Defrees of freedom, <code class="reqn">q = 2 N - 2</code>.</p>
</dd>
</dl>



<h3>References</h3>

<p>Dear, Keith B.G. and Begg, Colin B. (1992).
An Approach for Assessing Publication Bias Prior to Performing a Meta-Analysis.
<em>Statist. Sci.</em>, <b>7(2)</b>, 237&ndash;245.
</p>
<p>Hedges, L. and Olkin, I. (1985).
Statistical Methods for Meta-Analysis. 
Academic, Orlando, Florida.
</p>
<p>Iyengar, S. and Greenhouse, J.B. (1988).
Selection models and the file drawer problem (including rejoinder).
<em>Statist. Sci.</em>, <b>3</b>, 109&ndash;135.
</p>


<h3>See Also</h3>

<p>This dataset is analyzed in the help file for <code><a href="#topic+DearBegg">DearBegg</a></code>.</p>

<hr>
<h2 id='effectBias'>Compute bias for each effect size based on estimated weight function</h2><span id='topic+effectBias'></span>

<h3>Description</h3>

<p>Based on the estimated weight function an explicit formula for the bias of each initial effect estimate can be derived,
see Rufibach (2011). This function implements computation of this bias and is called by <code><a href="#topic+DearBegg">DearBegg</a></code> and <code><a href="#topic+DearBeggMonotone">DearBeggMonotone</a></code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>effectBias(y, u, w, theta, eta)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="effectBias_+3A_y">y</code></td>
<td>
<p>Normally distributed effect sizes.</p>
</td></tr>
<tr><td><code id="effectBias_+3A_u">u</code></td>
<td>
<p>Associated standard errors.</p>
</td></tr>
<tr><td><code id="effectBias_+3A_w">w</code></td>
<td>
<p>Vector of estimated weights as computed by either <code><a href="#topic+DearBegg">DearBegg</a></code> or <code><a href="#topic+DearBeggMonotone">DearBeggMonotone</a></code>.</p>
</td></tr>
<tr><td><code id="effectBias_+3A_theta">theta</code></td>
<td>
<p>Effect size estimate.</p>
</td></tr>
<tr><td><code id="effectBias_+3A_eta">eta</code></td>
<td>
<p>Standard error of effect size estimate.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list consisting of the following elements:
</p>
<table>
<tr><td><code>dat</code></td>
<td>
<p>Matrix with columns <code class="reqn">y</code>, <code class="reqn">u</code>, <code class="reqn">y</code>, <code class="reqn">p</code>, bias, <code class="reqn">y</code> - bias, bias / <code class="reqn">y</code>, 
where the rows are provided in decreasing order of <code class="reqn">p</code>-values.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kaspar Rufibach (maintainer), <a href="mailto:kaspar.rufibach@gmail.com">kaspar.rufibach@gmail.com</a>, <br /> <a href="http://www.kasparrufibach.ch">http://www.kasparrufibach.ch</a>
</p>


<h3>References</h3>

<p>Rufibach, K. (2011).
Selection Models with Monotone Weight Functions in Meta-Analysis.
<em>Biom. J.</em>, <b>53</b>(4), 689&ndash;704. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'># For an illustration see the help file for the function DearBegg().
</code></pre>

<hr>
<h2 id='IyenGreen'>Compute MLE and weight functions of Iyengar and Greenhouse (1988)</h2><span id='topic+IyenGreen'></span><span id='topic+IyenGreenLoglikT'></span><span id='topic+IyenGreenMLE'></span><span id='topic+IyenGreenWeight'></span><span id='topic+normalizeT'></span>

<h3>Description</h3>

<p>Two parameteric weight functions for selection models were introduced in Iyengar and Greenhouse (1988):
</p>
<p style="text-align: center;"><code class="reqn">w_1(x; \beta, q) = |x|^\beta / t(q, \alpha)</code>
</p>

<p style="text-align: center;"><code class="reqn">w_2(x; \gamma, q) = e^{-\gamma}</code>
</p>

<p>if <code class="reqn">|x| \le t(q, \alpha)</code> and <code class="reqn">w_1(x; \beta, q) = w_2(x; \gamma, q) = 1</code> otherwise. Here, <code class="reqn">t(q, \alpha)</code> is the <code class="reqn">\alpha</code>-quantile of a <code class="reqn">t</code> distribution
with <code class="reqn">q</code> degrees of freedom. The functions <code class="reqn">w_1</code> and <code class="reqn">w_2</code> are used to model the selection process that may be present 
in a meta analysis, in a model where effect sizes are assumed to follow a <code class="reqn">t</code> distribution. We have implemented estimation of the parameters in
this model in <code>IyenGreenMLE</code> and plotting in <code>IyenGreenWeight</code>. 
The functions <code>normalizeT</code> and <code>IyenGreenLoglikT</code> are used in computation of ML estimators and not intended to be called by the user.
For an example how to use <code>IyenGreenMLE</code> and <code>IyenGreenWeight</code> we refer to the help file for <code><a href="#topic+DearBegg">DearBegg</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>normalizeT(s, theta, b, q, N, type = 1, alpha = 0.05)
IyenGreenLoglikT(para, t, q, N, type = 1)
IyenGreenMLE(t, q, N, type = 1, alpha = 0.05)
IyenGreenWeight(x, b, q, type = 1, alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="IyenGreen_+3A_s">s</code></td>
<td>
<p>Quantile where normalizing integrand should be computed.</p>
</td></tr>
<tr><td><code id="IyenGreen_+3A_theta">theta</code></td>
<td>
<p>Vector containing effect size estimates of the meta analysis.</p>
</td></tr>
<tr><td><code id="IyenGreen_+3A_b">b</code></td>
<td>
<p>Parameter that governs shape of the weight function. Equals <code class="reqn">\beta</code> for <code class="reqn">w_1</code> and <code class="reqn">\gamma</code> for <code class="reqn">w_2</code>.</p>
</td></tr>
<tr><td><code id="IyenGreen_+3A_q">q</code></td>
<td>
<p>Degrees of freedom in the denominator of <code class="reqn">w_1, w_2</code>. Must be a real number.</p>
</td></tr>
<tr><td><code id="IyenGreen_+3A_n">N</code></td>
<td>
<p>Number of observations in each trial.</p>
</td></tr>
<tr><td><code id="IyenGreen_+3A_type">type</code></td>
<td>
<p>Type of weight function in Iyengar &amp; Greenhouse (1988). Either 1 (for <code class="reqn">w_1</code>) or 2 (for <code class="reqn">w_2</code>).</p>
</td></tr>
<tr><td><code id="IyenGreen_+3A_alpha">alpha</code></td>
<td>
<p>Quantile to be used in the denominator of <code class="reqn">w_1, w_2</code>.</p>
</td></tr>
<tr><td><code id="IyenGreen_+3A_para">para</code></td>
<td>
<p>Vector in <code class="reqn">R^2</code> over which log-likelihood function is maximized.</p>
</td></tr>
<tr><td><code id="IyenGreen_+3A_t">t</code></td>
<td>
<p>Vector of real numbers, <code class="reqn">t</code> test statistics.</p>
</td></tr>
<tr><td><code id="IyenGreen_+3A_x">x</code></td>
<td>
<p>Vector of real numbers where weight function should be computed at.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that these weight functions operate on the scale of <code class="reqn">t</code> statistics, not <code class="reqn">p</code>-values.</p>


<h3>Value</h3>

<p>See example in <code><a href="#topic+DearBegg">DearBegg</a></code> for details.</p>


<h3>Author(s)</h3>

<p>Kaspar Rufibach (maintainer), <a href="mailto:kaspar.rufibach@gmail.com">kaspar.rufibach@gmail.com</a>, <br /> <a href="http://www.kasparrufibach.ch">http://www.kasparrufibach.ch</a>
</p>


<h3>References</h3>

<p>Iyengar, S. and Greenhouse, J.B. (1988).
Selection models and the file drawer problem (including rejoinder).
<em>Statist. Sci.</em>, <b>3</b>, 109&ndash;135.
</p>


<h3>See Also</h3>

<p>For nonparametric estimation of weight functions see <code><a href="#topic+DearBegg">DearBegg</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'># For an illustration see the help file for the function DearBegg().
</code></pre>

<hr>
<h2 id='passive_smoking'>Dataset on the effect of environmental tobacco smoke</h2><span id='topic+passive_smoking'></span>

<h3>Description</h3>

<p>Effect of environmental tobacco smoke on lung-cancer in lifetime non-smokers.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(passive_smoking)</code></pre>


<h3>Format</h3>

<p>A data frame with 37 observations on the following 2 variables.
</p>

<dl>
<dt><code>lnRR</code></dt><dd><p>Log-relative risk.</p>
</dd>
<dt><code>selnRR</code></dt><dd><p>Standard error of log-relative risk.</p>
</dd>
</dl>



<h3>Details</h3>

<p>The sample consists of lung cancer patients and controls that were lifelong non-smokers.
The effect of interest is measured by the relative risk of lung cancer according to whether the spouse currently smoked or had never smoked.</p>


<h3>References</h3>

<p>Hackshaw, A. K., Law, M. R., and Wald, N.J.
The accumulated evidence on lung cancer and environmental tobacco smoke.
<em>BMJ</em>, <b>315</b>, 980&ndash;988.
</p>


<h3>See Also</h3>

<p>This dataset is analyzed in the help file for <code><a href="#topic+DearBegg">DearBegg</a></code>.</p>

<hr>
<h2 id='pPool'>Pool p-values in pairs</h2><span id='topic+pPool'></span>

<h3>Description</h3>

<p>To avoid unidentifiability in estimation of a selection function, Dear and Begg (1992) pool <code class="reqn">p</code>-values in 
pairs.</p>


<h3>Usage</h3>

<pre><code class='language-R'>pPool(p)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pPool_+3A_p">p</code></td>
<td>
<p>Vector of <code class="reqn">p</code>-values.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of pooled <code class="reqn">p</code>-values.</p>


<h3>Author(s)</h3>

<p>Kaspar Rufibach (maintainer), <a href="mailto:kaspar.rufibach@gmail.com">kaspar.rufibach@gmail.com</a>, <br /> <a href="http://www.kasparrufibach.ch">http://www.kasparrufibach.ch</a>
</p>


<h3>References</h3>

<p>Dear, K.B.G. and Begg, C.B. (1992).
An Approach for Assessing Publication Bias Prior to Performing a Meta-Analysis.
<em>Statist. Sci.</em>, <b>7(2)</b>, 237&ndash;245.
</p>
<p>Rufibach, K. (2011).
Selection Models with Monotone Weight Functions in Meta-Analysis.
<em>Biom. J.</em>, <b>53</b>(4), 689&ndash;704. 
</p>


<h3>See Also</h3>

<p>This function is used in <code><a href="#topic+weightLine">weightLine</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'># This function is used in the help file for the function DearBegg().
</code></pre>

<hr>
<h2 id='Pval'>Functions for the distribution of p-values</h2><span id='topic+Pval'></span><span id='topic+dPval'></span><span id='topic+pPval'></span><span id='topic+qPval'></span><span id='topic+rPval'></span>

<h3>Description</h3>

<p>The density of the <code class="reqn">p</code>-value generated by a test of the hypothesis
</p>
<p style="text-align: center;"><code class="reqn">H_0 : Y \sim N(0, \sigma^2) \ \ vs. \ \ H_1 : Y \sim N(\theta, \eta^2)</code>
</p>

<p>has the form
</p>
<p style="text-align: center;"><code class="reqn">f(p; \theta, \sigma, \eta) = \frac{\sigma}{2 \eta} \frac{\phi\Bigl((-\sigma \Phi^{-1}(p / 2) - \theta) / \eta\Bigr) + \phi\Bigl((\sigma \Phi^{-1}(p / 2) - \theta) / \eta\Bigr)}{\phi(\Phi^{-1}(p / 2))}</code>
</p>

<p>where <code class="reqn">\eta^2 = u^2 + \sigma^2</code>. We refer to Rufibach (2011) for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dPval(p, u, theta, sigma2)
pPval(q, u, theta, sigma2)
qPval(prob, u, theta, sigma2)
rPval(n, u, theta, sigma2, seed = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Pval_+3A_p">p</code>, <code id="Pval_+3A_q">q</code></td>
<td>
<p>Quantile.</p>
</td></tr>
<tr><td><code id="Pval_+3A_prob">prob</code></td>
<td>
<p>Probability.</p>
</td></tr>
<tr><td><code id="Pval_+3A_u">u</code></td>
<td>
<p>Standard error of the effect size.</p>
</td></tr>
<tr><td><code id="Pval_+3A_theta">theta</code></td>
<td>
<p>Effect size.</p>
</td></tr>
<tr><td><code id="Pval_+3A_sigma2">sigma2</code></td>
<td>
<p>Random effect variance component.</p>
</td></tr>
<tr><td><code id="Pval_+3A_n">n</code></td>
<td>
<p>Number of random numbers to be generated.</p>
</td></tr>
<tr><td><code id="Pval_+3A_seed">seed</code></td>
<td>
<p>Seed to set.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>dPval</code> gives the density, <code>pPval</code> gives the distribution function, <code>qPval</code> gives the quantile function, and <code>rPval</code> generates 
random deviates for the density <code class="reqn">f(p; \theta, \sigma, \eta)</code>.</p>


<h3>Author(s)</h3>

<p>Kaspar Rufibach (maintainer), <a href="mailto:kaspar.rufibach@gmail.com">kaspar.rufibach@gmail.com</a>, <br /> <a href="http://www.kasparrufibach.ch">http://www.kasparrufibach.ch</a>
</p>


<h3>References</h3>

<p>Dear, K.B.G. and Begg, C.B. (1992).
An Approach for Assessing Publication Bias Prior to Performing a Meta-Analysis.
<em>Statist. Sci.</em>, <b>7(2)</b>, 237&ndash;245.
</p>
<p>Rufibach, K. (2011).
Selection Models with Monotone Weight Functions in Meta-Analysis.
<em>Biom. J.</em>, <b>53</b>(4), 689&ndash;704. 
</p>

<hr>
<h2 id='weightLine'>Function to plot estimated weight functions</h2><span id='topic+weightLine'></span>

<h3>Description</h3>

<p>This function faclitiates plotting of estimated weight functions according to the method in Dear and Begg (1992) or
its non-increasing version described in Rufibach (2010).</p>


<h3>Usage</h3>

<pre><code class='language-R'>weightLine(p, w, col0, lwd0, lty0 = 1, type = c("pval", "empirical")[1])
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="weightLine_+3A_p">p</code></td>
<td>
<p>Vector of <code class="reqn">p</code>-values.</p>
</td></tr>
<tr><td><code id="weightLine_+3A_w">w</code></td>
<td>
<p>Vector of estimated weights, as outputted by <code><a href="#topic+DearBegg">DearBegg</a></code> or <code><a href="#topic+DearBeggMonotone">DearBeggMonotone</a></code>.</p>
</td></tr>
<tr><td><code id="weightLine_+3A_col0">col0</code></td>
<td>
<p>Color of line that is drawn.</p>
</td></tr>
<tr><td><code id="weightLine_+3A_lwd0">lwd0</code></td>
<td>
<p>Line width.</p>
</td></tr>
<tr><td><code id="weightLine_+3A_lty0">lty0</code></td>
<td>
<p>Line type.</p>
</td></tr>
<tr><td><code id="weightLine_+3A_type">type</code></td>
<td>
<p>Should weights be drawn versus original <code class="reqn">p</code>-values (<code>type == "pval"</code>) or versus the empirical distribution of the 
<code class="reqn">p</code>-values (<code>type === "empirical"</code>).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kaspar Rufibach (maintainer), <a href="mailto:kaspar.rufibach@gmail.com">kaspar.rufibach@gmail.com</a>, <br /> <a href="http://www.kasparrufibach.ch">http://www.kasparrufibach.ch</a>
</p>


<h3>References</h3>

<p>Dear, K.B.G. and Begg, C.B. (1992).
An Approach for Assessing Publication Bias Prior to Performing a Meta-Analysis.
<em>Statist. Sci.</em>, <b>7(2)</b>, 237&ndash;245.
</p>
<p>Rufibach, K. (2011).
Selection Models with Monotone Weight Functions in Meta-Analysis.
<em>Biom. J.</em>, <b>53</b>(4), 689&ndash;704. 
</p>


<h3>See Also</h3>

<p>This function is used in <code><a href="#topic+weightLine">weightLine</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'># This function is used in the help file for the function DearBegg().
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
