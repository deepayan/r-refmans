<!DOCTYPE html><html><head><title>Help for package strap</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {strap}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#strap-package'><p>Measuring Morphological Diversity and Evolutionary Tempo</p></a></li>
<li><a href='#Asaphidae'><p>Phylogeny and age data for the Asaphidae</p></a></li>
<li><a href='#DateNodeHedman'><p>Calculates branch lengths for a topology</p></a></li>
<li><a href='#DatePhylo'><p>Calculates branch lengths for a topology</p></a></li>
<li><a href='#DatePhyloHedman'><p>Calculates branch lengths for a topology</p></a></li>
<li><a href='#Dipnoi'><p>Phylogeny and age data for dipnoans (lungfish)</p></a></li>
<li><a href='#FindDescendants'><p>Finds the tip numbers descending from a specific node in a phylo object</p></a></li>
<li><a href='#geoscalePhylo'><p>Plots a phylogeny against the geological time scale</p></a></li>
<li><a href='#geoscalePhylo.mod'><p>Plots a phylogeny against the geological time scale</p></a></li>
<li><a href='#StratPhyloCongruence'><p>Calculates fit to stratigraphy metrics for a set of tree(s)</p></a></li>
<li><a href='#UKzones'><p>British regional stages for the Ordovician</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Stratigraphic Tree Analysis for Palaeontology</td>
</tr>
<tr>
<td>Version:</td>
<td>1.6-0</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-06-10</td>
</tr>
<tr>
<td>Depends:</td>
<td>ape, geoscale</td>
</tr>
<tr>
<td>Imports:</td>
<td>graphics, grDevices, pbapply, stats, utils</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions for the stratigraphic analysis of phylogenetic trees.</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>ByteCompile:</td>
<td>yes</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-06-12 18:03:44 UTC; eargtl</td>
</tr>
<tr>
<td>Author:</td>
<td>Mark A. Bell [aut, cph],
  Graeme T. Lloyd [aut, cre, cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Graeme T. Lloyd &lt;graemetlloyd@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-06-13 07:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='strap-package'>Measuring Morphological Diversity and Evolutionary Tempo</h2><span id='topic+strap-package'></span><span id='topic+strap'></span>

<h3>Description</h3>

<p>A series of functions for stratigraphic analysis of phylogenetic trees.
</p>


<h3>Author(s)</h3>

<p>Graeme T. Lloyd &lt;graemetlloyd@gmail.com&gt;&gt;
</p>


<h3>References</h3>

<p>Bell, M. A. and Lloyd, G. T., 2015. strap: an R package for plotting phylogenies against stratigraphy and assessing their stratigraphic congruence. <em>Palaeontology</em>, <b>58</b>, 379-389.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Calculate stratigraphic fit measures treating ages as ranges:
fit.to.strat.1 &lt;- StratPhyloCongruence(trees = Dipnoi$tree,
  ages = Dipnoi$ages, rlen = 0, method = "basic", samp.perm=5,
  rand.perm = 5, hard = TRUE, randomly.sample.ages = FALSE,
  fix.topology = FALSE, fix.outgroup = TRUE,
  outgroup.taxon = "Psarolepis_romeri")

# Show just the output for the input tree(s)
fit.to.strat.1$input.tree.results

</code></pre>

<hr>
<h2 id='Asaphidae'>Phylogeny and age data for the Asaphidae</h2><span id='topic+Asaphidae'></span>

<h3>Description</h3>

<p>Phylogeny (162 most parsimonious trees) and age data for Asaphidae genera (Trilobita, Asaphida) taken from Bell and Braddy (2012).
</p>


<h3>Format</h3>

<p>A list containing 162 trees (<code>$tree</code>) and a matrix of first and last appearances (<code>$ages</code>).
</p>


<h3>References</h3>

<p>Bell, M. A. and Braddy, S. J., 2012, Copeâ€™s rule in the Ordovician trilobite Family Asaphidae (Order Asaphida): patterns across multiple most parsimonious trees: <em>Historical Biology</em>, <b>24</b>, 223-230.
</p>

<hr>
<h2 id='DateNodeHedman'>Calculates branch lengths for a topology</h2><span id='topic+DateNodeHedman'></span>

<h3>Description</h3>

<p>Calculates branch lengths for a topology given a tree and age data for the tips.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DateNodeHedman(tnodes, t0, resolution)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DateNodeHedman_+3A_tnodes">tnodes</code></td>
<td>
<p>The sequence of outgroup ages to the target node.</p>
</td></tr>
<tr><td><code id="DateNodeHedman_+3A_t0">t0</code></td>
<td>
<p>The arbitrary lower stratigraphic bound.</p>
</td></tr>
<tr><td><code id="DateNodeHedman_+3A_resolution">resolution</code></td>
<td>
<p>The number of steps to take between the FAD and the lower stratigraphic bound.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The basic method (Norell 1992; Smith 1994) of dating a phylogenetic tree of fossil occurrences in palaeontology has been to make each internal node the age of its oldest descendant. In practical terms this means at least half or the branches in a fully bifurcating tree will have a duration of zero million years, as a hypothetical ancestor and its immediate descendant will have the same age, creaing a major problem for a variety of rate-based approaches where bracnh duration is the denominator.
</p>
<p>Early solutions to this problem relied on adding some arbitrary value to each branch in order to enforce non-zero durations. However, more recently Ruta et al. (2006) argued for an approach that first dated the tree using the basic approach then, working from tip-to-root, whenever a zero duration branch was encountered it was assigned a share of the time available from the first directly ancestral branch of positive length. The size of this share is decided by some measure of evolutionary change along that branch. Ruta et al. (2006) used patristic dissimilarity (Wagner 1997), but conceivably any measure could be used. This approach was modified slightly by Brusatte et al. (2008), who preferred equal sharing. This has a couple of benefits over Ruta et al. (2006). Firstly, it avoids zero-length branches entirely - these could still happen with the Ruta et al. 2006 approach, as if no change occurs along a branch it gets zero share of any time. Secondly, it opens up the dating approach to trees without meaningful branch lengths, such as supertrees.
</p>
<p>An undiscussed problem with the Ruta et al. (2006), and by extension the Brusatte et al. (2008) approach, concerns the inevitable zero-length branch at the base of the tree that has no preceding ancestral branch with which to share time. Here the obvious practical solution to this problem is implemented - to allow the user to pick a root length that the lowest branch(es) of the tree can share time with (Lloyd et al. 2012). Although selection of this value is potentially arbitrary, in most cases it will only effect a very small number of branches (potentially only a single branch). A recommended method for choosing root length is to use the difference between the oldest taxon in the tree and the age of the first outgroup to the tree that is older (ensuring a positive value).
</p>
<p>Note that all three methods implemented here are effectively minimal approaches, in that they assume as little missing or unsampled history as possible. This is because they have their roots in maximum parsimony as an optimality criterion. Consequently the user should be aware that this function will likely return trees with relatively very short internal branch lengths, which may be a source of bias in subsequent analyses.
</p>
<p>These approaches (with the exception of the Ruta method) are also implemented, along with others, in the timePaleoPhy function of the paleotree package.
</p>


<h3>Value</h3>

<p>A phylo object with branch lengths scaled to time and the root age stored as $root.time.
</p>


<h3>Author(s)</h3>

<p>Matt Friedman <a href="mailto:mfriedm@umich.edu">mfriedm@umich.edu</a> and Graeme T. Lloyd <a href="mailto:graemetlloyd@gmail.com">graemetlloyd@gmail.com</a>
</p>


<h3>References</h3>

<p>Brusatte, S. L., Benton, M. J., Ruta, M. and Lloyd, G. T., 2008. Superiority, competition, and opportunism in the evolutionary radiation of dinosaurs. Science, 321, 1485-1488.
Lloyd, G. T., Wang, S. C. and Brusatte, S. L., 2012. Identifying heterogeneity in rates of morphological evolution: discrete character change in the evolution of lungfish (Sarcopterygii; Dipnoi). Evolution, 66, 330-348.
Norell, M. A., 1992. Taxic origin and temporal diversity: the effect of phylogeny. In: Extinction and Phylogeny, Novacek, M. J. and Wheeler, Q. D. (eds.). Columbia University Press, New York, p89-118.
Ruta, M., Wagner, P. J. and Coates, M. I., 2006. Evolutionary patterns in early tetrapods. I. Rapid initial diversification followed by decrease in rates of character change. Proceedings of the Royal Society B, 273, 2107-2111.
Smith, A. B., 1994. Systematics and the Fossil Record. Blackwell Scientific, London, 223pp.
Wagner, P. J., 1997. Patterns of morphologic diversification among the Rostroconchia. Paleobiology, 23, 115-15
</p>


<h3>See Also</h3>

<p>cal3 in paleotree package
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Time-scale the lungfish tree using the "equal" method and a root length of 1 Ma:
time.tree &lt;- DatePhylo(Dipnoi$tree, Dipnoi$ages, method = "equal", rlen = 1)

# Plot the tree with new branch lengths:
plot(time.tree, cex = 0.5)

</code></pre>

<hr>
<h2 id='DatePhylo'>Calculates branch lengths for a topology</h2><span id='topic+DatePhylo'></span>

<h3>Description</h3>

<p>Calculates branch lengths for a topology given a tree and age data for the tips.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DatePhylo(tree, ages, rlen = 0, method = "basic", add.terminal = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DatePhylo_+3A_tree">tree</code></td>
<td>
<p>Tree as a phylo object.</p>
</td></tr>
<tr><td><code id="DatePhylo_+3A_ages">ages</code></td>
<td>
<p>A two-column matrix of taxa (rows) against First and Last Appearance Datums (FADs and LADs). Note that rownames should be the taxon names exactly as they appear in tree$tip.label and colnames should be &quot;FAD&quot; and &quot;LAD&quot;. All ages should be in time before present.</p>
</td></tr>
<tr><td><code id="DatePhylo_+3A_rlen">rlen</code></td>
<td>
<p>Root length. This must be greater than zero if using a method other than basic.</p>
</td></tr>
<tr><td><code id="DatePhylo_+3A_method">method</code></td>
<td>
<p>The dating method used. Either basic (Norell 1992; Smith 1994), ruta (Ruta et al. 2006; requires input tree to have branch lengths) or equal (Brusatte et al. 2008).</p>
</td></tr>
<tr><td><code id="DatePhylo_+3A_add.terminal">add.terminal</code></td>
<td>
<p>An optional to add the range of a taxon (FAD minus LAD) to terminal branch lengths.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The basic method (Norell 1992; Smith 1994) of dating a phylogenetic tree of fossil occurrences in palaeontology has been to make each internal node the age of its oldest descendant. In practical terms this means at least half or the branches in a fully bifurcating tree will have a duration of zero million years, as a hypothetical ancestor and its immediate descendant will have the same age, creaing a major problem for a variety of rate-based approaches that use branch durations as a divisor.
</p>
<p>Early solutions to this problem relied on adding some arbitrary value to each branch in order to enforce non-zero durations. However, more recently Ruta et al. (2006) argued for an approach that first dated the tree using the basic approach then, working from tip-to-root, whenever a zero duration branch was encountered it was assigned a share of the time available from the first directly ancestral branch of positive length. The size of this share is decided by some measure of evolutionary change along that branch. Ruta et al. (2006) used patristic dissimilarity (Wagner 1997), but conceivably any measure could be used. This approach was modified slightly by Brusatte et al. (2008), who preferred equal sharing. This has a couple of benefits over Ruta et al. (2006). Firstly, it avoids zero-length branches entirely - these could still happen with the Ruta et al. 2006 approach, as if no change occurs along a branch it gets zero share of any time. Secondly, it opens up the dating approach to trees without meaningful branch lengths, such as supertrees.
</p>
<p>An undiscussed problem with the Ruta et al. (2006), and by extension the Brusatte et al. (2008) approach, concerns the inevitable zero-length branch at the base of the tree that has no preceding ancestral branch with which to share time. Here the obvious practical solution to this problem is implemented - to allow the user to pick a root length that the lowest branch(es) of the tree can share time with (Lloyd et al. 2012). Although selection of this value is potentially arbitrary, in most cases it will only effect a very small number of branches (potentially only a single branch). A recommended method for choosing root length is to use the difference between the oldest taxon in the tree and the age of the first outgroup to the tree that is older (ensuring a positive value).
</p>
<p>Note that all three methods implemented here are effectively minimal approaches, in that they assume as little missing or unsampled history as possible. This is because they have their roots in maximum parsimony as an optimality criterion. Consequently the user should be aware that this function will likely return trees with relatively very short internal branch lengths, which may be a source of bias in subsequent analyses.
</p>
<p>These approaches (with the exception of the Ruta method) are also implemented, along with others, in the timePaleoPhy function of the paleotree package.
</p>


<h3>Value</h3>

<p>A phylo object with branch lengths scaled to time and the root age stored as $root.time.
</p>


<h3>Author(s)</h3>

<p>Graeme T. Lloyd <a href="mailto:graemetlloyd@gmail.com">graemetlloyd@gmail.com</a>
</p>


<h3>References</h3>

<p>Brusatte, S. L., Benton, M. J., Ruta, M. and Lloyd, G. T., 2008. Superiority, competition, and opportunism in the evolutionary radiation of dinosaurs. Science, 321, 1485-1488.
Lloyd, G. T., Wang, S. C. and Brusatte, S. L., 2012. Identifying heterogeneity in rates of morphological evolution: discrete character change in the evolution of lungfish (Sarcopterygii; Dipnoi). Evolution, 66, 330-348.
Norell, M. A., 1992. Taxic origin and temporal diversity: the effect of phylogeny. In: Extinction and Phylogeny, Novacek, M. J. and Wheeler, Q. D. (eds.). Columbia University Press, New York, p89-118.
Ruta, M., Wagner, P. J. and Coates, M. I., 2006. Evolutionary patterns in early tetrapods. I. Rapid initial diversification followed by decrease in rates of character change. Proceedings of the Royal Society B, 273, 2107-2111.
Smith, A. B., 1994. Systematics and the Fossil Record. Blackwell Scientific, London, 223pp.
Wagner, P. J., 1997. Patterns of morphologic diversification among the Rostroconchia. Paleobiology, 23, 115-15
</p>


<h3>See Also</h3>

<p>timePaleoPhy in paleotree package
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Time-scale the lungfish tree using the "equal" method and a root length of 1 Ma:
time.tree &lt;- DatePhylo(Dipnoi$tree, Dipnoi$ages, method = "equal", rlen = 1)

# Plot the tree with new branch lengths:
plot(time.tree, cex = 0.5)

</code></pre>

<hr>
<h2 id='DatePhyloHedman'>Calculates branch lengths for a topology</h2><span id='topic+DatePhyloHedman'></span>

<h3>Description</h3>

<p>Calculates branch lengths for a topology given a tree and age data for the tips.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DatePhyloHedman(
  tree,
  tip.ages,
  outgroup.ages,
  t0,
  resolution = 1000,
  conservative = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DatePhyloHedman_+3A_tree">tree</code></td>
<td>
<p>A phylo object representing the tree the user wishes to time-scale.</p>
</td></tr>
<tr><td><code id="DatePhyloHedman_+3A_tip.ages">tip.ages</code></td>
<td>
<p>The ages of the tips of the tree to use for time-scaling.</p>
</td></tr>
<tr><td><code id="DatePhyloHedman_+3A_outgroup.ages">outgroup.ages</code></td>
<td>
<p>A vector of numeric values representing the ages of the outgroup taxa that fall immediately outside of the root node.</p>
</td></tr>
<tr><td><code id="DatePhyloHedman_+3A_t0">t0</code></td>
<td>
<p>The absolute maximum age allowable. This must be older than anything in either tip.ages or outgroup.ages.</p>
</td></tr>
<tr><td><code id="DatePhyloHedman_+3A_resolution">resolution</code></td>
<td>
<p>The number of ages to sample from the posterior distributionof each inferred node age.</p>
</td></tr>
<tr><td><code id="DatePhyloHedman_+3A_conservative">conservative</code></td>
<td>
<p>A logical indicating whether or not to apply the conservatove approach of Lloyd et al. (2016). TRUE is the default and recommended option.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The basic method (Norell 1992; Smith 1994) of dating a phylogenetic tree of fossil occurrences in palaeontology has been to make each internal node the age of its oldest descendant. In practical terms this means at least half or the branches in a fully bifurcating tree will have a duration of zero million years, as a hypothetical ancestor and its immediate descendant will have the same age, creaing a major problem for a variety of rate-based approaches that use branch durations as a divisor.
</p>
<p>Early solutions to this problem relied on adding some arbitrary value to each branch in order to enforce non-zero durations. However, more recently Ruta et al. (2006) argued for an approach that first dated the tree using the basic approach then, working from tip-to-root, whenever a zero duration branch was encountered it was assigned a share of the time available from the first directly ancestral branch of positive length. The size of this share is decided by some measure of evolutionary change along that branch. Ruta et al. (2006) used patristic dissimilarity (Wagner 1997), but conceivably any measure could be used. This approach was modified slightly by Brusatte et al. (2008), who preferred equal sharing. This has a couple of benefits over Ruta et al. (2006). Firstly, it avoids zero-length branches entirely - these could still happen with the Ruta et al. 2006 approach, as if no change occurs along a branch it gets zero share of any time. Secondly, it opens up the dating approach to trees without meaningful branch lengths, such as supertrees.
</p>
<p>An undiscussed problem with the Ruta et al. (2006), and by extension the Brusatte et al. (2008) approach, concerns the inevitable zero-length branch at the base of the tree that has no preceding ancestral branch with which to share time. Here the obvious practical solution to this problem is implemented - to allow the user to pick a root length that the lowest branch(es) of the tree can share time with (Lloyd et al. 2012). Although selection of this value is potentially arbitrary, in most cases it will only effect a very small number of branches (potentially only a single branch). A recommended method for choosing root length is to use the difference between the oldest taxon in the tree and the age of the first outgroup to the tree that is older (ensuring a positive value).
</p>
<p>Note that all three methods implemented here are effectively minimal approaches, in that they assume as little missing or unsampled history as possible. This is because they have their roots in maximum parsimony as an optimality criterion. Consequently the user should be aware that this function will likely return trees with relatively very short internal branch lengths, which may be a source of bias in subsequent analyses.
</p>
<p>These approaches (with the exception of the Ruta method) are also implemented, along with others, in the timePaleoPhy function of the paleotree package.
</p>


<h3>Value</h3>

<p>A phylo object with branch lengths scaled to time and the root age stored as $root.time.
</p>


<h3>Author(s)</h3>

<p>Graeme T. Lloyd <a href="mailto:graemetlloyd@gmail.com">graemetlloyd@gmail.com</a>
</p>


<h3>References</h3>

<p>Brusatte, S. L., Benton, M. J., Ruta, M. and Lloyd, G. T., 2008. Superiority, competition, and opportunism in the evolutionary radiation of dinosaurs. Science, 321, 1485-1488.
Lloyd, G. T., Wang, S. C. and Brusatte, S. L., 2012. Identifying heterogeneity in rates of morphological evolution: discrete character change in the evolution of lungfish (Sarcopterygii; Dipnoi). Evolution, 66, 330-348.
Norell, M. A., 1992. Taxic origin and temporal diversity: the effect of phylogeny. In: Extinction and Phylogeny, Novacek, M. J. and Wheeler, Q. D. (eds.). Columbia University Press, New York, p89-118.
Ruta, M., Wagner, P. J. and Coates, M. I., 2006. Evolutionary patterns in early tetrapods. I. Rapid initial diversification followed by decrease in rates of character change. Proceedings of the Royal Society B, 273, 2107-2111.
Smith, A. B., 1994. Systematics and the Fossil Record. Blackwell Scientific, London, 223pp.
Wagner, P. J., 1997. Patterns of morphologic diversification among the Rostroconchia. Paleobiology, 23, 115-15
</p>


<h3>See Also</h3>

<p>timePaleoPhy in paleotree package
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Time-scale the lungfish tree using the "equal" method and a root length of 1 Ma:
time.tree &lt;- DatePhylo(Dipnoi$tree, Dipnoi$ages, method = "equal", rlen = 1)

# Plot the tree with new branch lengths:
plot(time.tree, cex = 0.5)

</code></pre>

<hr>
<h2 id='Dipnoi'>Phylogeny and age data for dipnoans (lungfish)</h2><span id='topic+Dipnoi'></span>

<h3>Description</h3>

<p>Phylogeny (first most parsimonious tree) and age data for lungfish (Osteichthyes, Sarcopterygii, Dipnoi) taken from Lloyd et al. (2012).
</p>


<h3>Format</h3>

<p>A list containing a tree (<code>$tree</code>) and a matrix of first and last appearances (<code>$ages</code>).
</p>


<h3>References</h3>

<p>Lloyd, G. T., Wang, S. C. and Brusatte, S. L., 2012. Identifying heterogeneity in rates of morphological evolution: discrete character change in the evolution of lungfish (Sarcopterygii; Dipnoi). <em>Evolution</em>, <b>66</b>, 330-348.
</p>

<hr>
<h2 id='FindDescendants'>Finds the tip numbers descending from a specific node in a phylo object</h2><span id='topic+FindDescendants'></span>

<h3>Description</h3>

<p>Finds the tip numbers descending from a specific node in a phylo object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FindDescendants(n, tree)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="FindDescendants_+3A_n">n</code></td>
<td>
<p>The node number.</p>
</td></tr>
<tr><td><code id="FindDescendants_+3A_tree">tree</code></td>
<td>
<p>Tree as a phylo object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A simple way to get the tips descending from a given node in a phylogenetic tree.
</p>


<h3>Value</h3>

<p>A vector of the descendant tip numbers.
</p>


<h3>Author(s)</h3>

<p>Graeme T. Lloyd <a href="mailto:graemetlloyd@gmail.com">graemetlloyd@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Find descendants of the root node in the lungfish tree:
FindDescendants(n = 87, tree = Dipnoi$tree)

</code></pre>

<hr>
<h2 id='geoscalePhylo'>Plots a phylogeny against the geological time scale</h2><span id='topic+geoscalePhylo'></span>

<h3>Description</h3>

<p>Plots a time-scaled phylogeny against the international geological time scale.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>geoscalePhylo(
  tree,
  ages,
  direction = "rightwards",
  units = c("Period", "Epoch", "Age"),
  boxes = "Age",
  tick.scale = "myr",
  user.scale,
  cex.age = 0.3,
  cex.ts = 0.3,
  cex.tip = 0.3,
  width = 1,
  label.offset,
  ts.col = TRUE,
  vers = "ICS2013",
  x.lim,
  quat.rm = FALSE,
  erotate,
  arotate,
  urotate,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="geoscalePhylo_+3A_tree">tree</code></td>
<td>
<p>A tree as a phylo object.</p>
</td></tr>
<tr><td><code id="geoscalePhylo_+3A_ages">ages</code></td>
<td>
<p>A dataset containing the first and last appearence datums,&quot;FAD&quot; and &quot;LAD&quot; respectively, of all taxa in the phylogeny. See the object $ages in utils::data(Dipnoi) for an example.</p>
</td></tr>
<tr><td><code id="geoscalePhylo_+3A_direction">direction</code></td>
<td>
<p>The direction the tree is to be plotted in, options include &quot;rightwards&quot; and &quot;upwards&quot;, see help(plot.phylo).</p>
</td></tr>
<tr><td><code id="geoscalePhylo_+3A_units">units</code></td>
<td>
<p>The temporal unit(s) to be included in the timescale, options include: &quot;Eon&quot;, &quot;Era&quot;, &quot;Period&quot;, &quot;Epoch&quot;, &quot;Age&quot; and &quot;User&quot;. The option &quot;User&quot; is required when including a user-defined timescale. This also requires an object to be assigned to user.scale (see Details).</p>
</td></tr>
<tr><td><code id="geoscalePhylo_+3A_boxes">boxes</code></td>
<td>
<p>Option for including grey boxes at a certain temporal resolution, options are the same as for units.</p>
</td></tr>
<tr><td><code id="geoscalePhylo_+3A_tick.scale">tick.scale</code></td>
<td>
<p>The resolution of the tick marks at the base of the timescale, the default is the same as units. The resolution of the scale can also be chosen by specifiying a value or removed entirely by using &quot;no&quot;.</p>
</td></tr>
<tr><td><code id="geoscalePhylo_+3A_user.scale">user.scale</code></td>
<td>
<p>The data object to be used when including a user-defined time scale, requires the option &quot;User&quot; to be included in units. See utils::data(UKzones) as an example of the required data format.</p>
</td></tr>
<tr><td><code id="geoscalePhylo_+3A_cex.age">cex.age</code></td>
<td>
<p>Size of the text on the scale bar.</p>
</td></tr>
<tr><td><code id="geoscalePhylo_+3A_cex.ts">cex.ts</code></td>
<td>
<p>Size of the text on the geological time scale.</p>
</td></tr>
<tr><td><code id="geoscalePhylo_+3A_cex.tip">cex.tip</code></td>
<td>
<p>Size of the tip labels on the phylogeny</p>
</td></tr>
<tr><td><code id="geoscalePhylo_+3A_width">width</code></td>
<td>
<p>Width of the edges of the phylogeny.</p>
</td></tr>
<tr><td><code id="geoscalePhylo_+3A_label.offset">label.offset</code></td>
<td>
<p>A value for the distance between the nodes and tip labels, see help(plot.phylo).</p>
</td></tr>
<tr><td><code id="geoscalePhylo_+3A_ts.col">ts.col</code></td>
<td>
<p>Option for using standard ICS colours on the time scale.</p>
</td></tr>
<tr><td><code id="geoscalePhylo_+3A_vers">vers</code></td>
<td>
<p>The version of the geological time scale to use. Options include: &quot;ICS2013&quot;, &quot;ICS2012&quot;, &quot;ICS2010&quot;, &quot;ICS2009&quot; or &quot;ICS2008&quot;.</p>
</td></tr>
<tr><td><code id="geoscalePhylo_+3A_x.lim">x.lim</code></td>
<td>
<p>A two item statement for the geological range, in millions of years, of the plot i.e. (0,65). If only one value is used it will be used as the upper limit, see help(plot.phylo).</p>
</td></tr>
<tr><td><code id="geoscalePhylo_+3A_quat.rm">quat.rm</code></td>
<td>
<p>Option to remove the names from Quaternary time bins, useful when plotting clades with long durations that range through to the recent.</p>
</td></tr>
<tr><td><code id="geoscalePhylo_+3A_erotate">erotate</code></td>
<td>
<p>A numerical value for the rotation for the Epoch/Series temporal units, default values are 0 when direction = &quot;upwards&quot; and 90 when direction = &quot;rightwards&quot;.</p>
</td></tr>
<tr><td><code id="geoscalePhylo_+3A_arotate">arotate</code></td>
<td>
<p>A numerical value for the rotation for the Age/Stage temporal units, default values are 0 when direction = &quot;upwards&quot; and 90 when direction = &quot;rightwards&quot;.</p>
</td></tr>
<tr><td><code id="geoscalePhylo_+3A_urotate">urotate</code></td>
<td>
<p>A numerical value for the rotation for the User temporal units, default values are 0 when direction = &quot;upwards&quot; and 90 when direction = &quot;rightwards&quot;.</p>
</td></tr>
<tr><td><code id="geoscalePhylo_+3A_...">...</code></td>
<td>
<p>All other arguments passed to plot.phylo</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Often palaeontologists wish to display phylogenetic trees against a geological time scale for easy visualization of the temporal position of the taxa the generation of which can be time-consuming. geoscalePhylo fills this need and works in ths same way as geoscale.plot from the package geoscale and allows users to plot a time-scaled phylogeny against the International Chronostratigraphic Chart (Gradstein, 2014). This function accepts any tree time-scaled through either the function DatePhylo in this package or the timePaleoPhy function in the library paleotree.
</p>
<p>Built-in options allows the user control over which direction the tree is plotted in (either horizonally or vertically) as well as deciding which temporal units are included in the time scale (see below for example).
</p>
<p>Temporal units
</p>
<p>The function geoscalePhylo allows for a time-scaled phylogeny to be plotted against geologic time using either the current geologic time scale of Gradstein et al., 2012 or previously published time scales by the International Commisioin on Stratigraphy. The time scale that is plotted is comprised of a number of temporal components representing the different units that the geological time scale is divided into. There are five main temporal units that can be included, each of which have two alternative names and are as follows: Eon (Eonothem), Era (Erathem), System (Period), Series (Epoch), and Stage (Age). These alternative names can be used interchangably i.e. both Eon and Erathem are accepted, however should both these alternative names be included then that temporal unit will only be included once. In addition, the order in which they are included into units does not affect the order in which they appear in the chart so units=c(&quot;Period&quot;,&quot;Epoch&quot;,&quot;Age&quot;) will produce the same results as units=c(&quot;Age&quot;,&quot;Epoch&quot;,&quot;Period&quot;) with the default order as they were listed previously with Eons plotted at the base and Stages at the top.
</p>
<p>Including a user-defined time scale
</p>
<p>There is a sixth option that can be included into the units argument. &quot;User&quot; allows for an additional temporal unit to be plotted i.e. biozonal or terrane-specific time scales. This requires a matrix of three columns named &quot;Start&quot;, &quot;End&quot; and &quot;Name&quot; representing the bottom, top of each temporal bin (in millions of years) and the name to be plotted respectively. An example dataset called UKzones representing Stages of the UK Ordovician System is included in the package. See below for an example of how to implement this option.
</p>
<p>Stratigraphic ranges
</p>
<p>geoscalePhylo allows for the stratigraphic ranges to be included in the plot. This requires an matrix with the first appearance and last appearance dates in millions of years (FAD and LAD respectively) with the row names containing all the tip labels of the taxa in the tree, exactly as they appear in tree$tip.label and the column names should be &quot;FAD&quot; and &quot;LAD&quot;. In order to add the stratigraphic ranges to the plot this matrix should be attached to the argument ages. See below for an example of this option.
</p>
<p>Apparent appearance of polytomies
</p>
<p>It should be noted that using certain methods for time-scaling a tree, such as the &quot;basic&quot; method (the default), it can create the appearance of polytomies in a tree is otherwise fully resolved due to the presence of a large number of zero length branches. This can be solved by using another timescaling method such as the &quot;equal&quot; method which will enforce all the branches to have a positive length.
</p>


<h3>Value</h3>

<p>Nothing (simply produces a plot of the tree against geologic time).
</p>


<h3>Author(s)</h3>

<p>Mark A. Bell <a href="mailto:mark.bell521@gmail.com">mark.bell521@gmail.com</a>
</p>


<h3>References</h3>

<p>Gradstein, F. M., Ogg, J. M., and Schmitz, M. 2012. A Geologic Time Scale. Elsevier, Boston, USA.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
### Example lungfish data
utils::data(Dipnoi)

tree_l &lt;- DatePhylo(Dipnoi$tree, Dipnoi$ages, method = "equal", rlen = 1)

geoscalePhylo(tree = tree_l, boxes = "Age", cex.tip = 0.4)

# Plotting the tree with the stratigraphical ranges included
geoscalePhylo(tree = tree_l, ages = Dipnoi$ages, boxes = "Age", cex.tip = 0.4)

# Including all temporal units into the stratigraphic column
geoscalePhylo(tree_l, Dipnoi$ages, units = c("Eon", "Era", "Period", "Epoch", "Age"),
  boxes = "Age", cex.tip = 0.4)

# Plotting the numerical values on the time scale at Age resolution
geoscalePhylo(tree_l, Dipnoi$ages, units = c("Eon", "Era", "Period", "Epoch", "Age"),
  boxes="Age", cex.tip = 0.4, tick.scale = "Age")

### Example trilobite data
utils::data(Asaphidae)

tree_a &lt;- DatePhylo(Asaphidae$trees[[1]], Asaphidae$ages, method = "equal", rlen = 1)

geoscalePhylo(ladderize(tree_a), Asaphidae$ages, boxes = "Age", x.lim = c(504, 435),
  cex.tip = 0.5, cex.ts = 0.5, vers = "ICS2009")

# Plotting the tree vertically
geoscalePhylo(ladderize(tree_a), Asaphidae$ages, boxes = "Age", x.lim = c(504, 435),
  cex.tip = 0.5, cex.ts = 0.5, direction = "upwards", vers = "ICS2009")

# Including a user-defined time scale
utils::data(UKzones)
utils::data(Asaphidae)

tree_a &lt;- DatePhylo(Asaphidae$trees[[1]], Asaphidae$ages, method = "equal", rlen = 1)

geoscalePhylo(ladderize(tree_a), Asaphidae$ages, units = c("Eon", "Era", "Period",
  "Epoch", "User"), boxes = "Age", cex.tip = 0.4, user.scale = UKzones,
  vers = "ICS2009", cex.ts = 0.5, x.lim = c(520, 440), direction = "upwards")

# Rotating the text on the time scale
tree_a &lt;- DatePhylo(Asaphidae$trees[[1]], Asaphidae$ages, method = "equal", rlen = 1)

#geoscalePhylo(ladderize(tree_a), Asaphidae$ages, units = c("Period",
#  "Epoch", "Age", "User"), boxes = "Age", cex.tip = 0.4, user.scale = UKzones,
#  vers = "ICS2009", cex.ts = 0.5, x.lim = c(520, 440), arotate = 0, erotate = 0, urotate = 0)

</code></pre>

<hr>
<h2 id='geoscalePhylo.mod'>Plots a phylogeny against the geological time scale</h2><span id='topic+geoscalePhylo.mod'></span>

<h3>Description</h3>

<p>Plots a time-scaled phylogeny against the international geological time scale.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>geoscalePhylo.mod(
  tree,
  ages,
  occs,
  direction = "rightwards",
  units = c("Period", "Epoch", "Age"),
  boxes = "Age",
  tick.scale = "myr",
  user.scale,
  cex.age = 0.3,
  cex.ts = 0.3,
  cex.tip = 0.3,
  width = 1,
  label.offset,
  ts.col = TRUE,
  vers = "ICS2013",
  x.lim,
  quat.rm = FALSE,
  erotate,
  arotate,
  urotate,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="geoscalePhylo.mod_+3A_tree">tree</code></td>
<td>
<p>A tree as a phylo object.</p>
</td></tr>
<tr><td><code id="geoscalePhylo.mod_+3A_ages">ages</code></td>
<td>
<p>A dataset containing the first and last appearence datums,&quot;FAD&quot; and &quot;LAD&quot; respectively, of all taxa in the phylogeny. See the object $ages in utils::data(Dipnoi) for an example.</p>
</td></tr>
<tr><td><code id="geoscalePhylo.mod_+3A_occs">occs</code></td>
<td>
<p>UNKNOWN.</p>
</td></tr>
<tr><td><code id="geoscalePhylo.mod_+3A_direction">direction</code></td>
<td>
<p>The direction the tree is to be plotted in, options include &quot;rightwards&quot; and &quot;upwards&quot;, see help(plot.phylo).</p>
</td></tr>
<tr><td><code id="geoscalePhylo.mod_+3A_units">units</code></td>
<td>
<p>The temporal unit(s) to be included in the timescale, options include: &quot;Eon&quot;, &quot;Era&quot;, &quot;Period&quot;, &quot;Epoch&quot;, &quot;Age&quot; and &quot;User&quot;. The option &quot;User&quot; is required when including a user-defined timescale. This also requires an object to be assigned to user.scale (see Details).</p>
</td></tr>
<tr><td><code id="geoscalePhylo.mod_+3A_boxes">boxes</code></td>
<td>
<p>Option for including grey boxes at a certain temporal resolution, options are the same as for units.</p>
</td></tr>
<tr><td><code id="geoscalePhylo.mod_+3A_tick.scale">tick.scale</code></td>
<td>
<p>The resolution of the tick marks at the base of the timescale, the default is the same as units. The resolution of the scale can also be chosen by specifiying a value or removed entirely by using &quot;no&quot;.</p>
</td></tr>
<tr><td><code id="geoscalePhylo.mod_+3A_user.scale">user.scale</code></td>
<td>
<p>The data object to be used when including a user-defined time scale, requires the option &quot;User&quot; to be included in units. See utils::data(UKzones) as an example of the required data format.</p>
</td></tr>
<tr><td><code id="geoscalePhylo.mod_+3A_cex.age">cex.age</code></td>
<td>
<p>Size of the text on the scale bar.</p>
</td></tr>
<tr><td><code id="geoscalePhylo.mod_+3A_cex.ts">cex.ts</code></td>
<td>
<p>Size of the text on the geological time scale.</p>
</td></tr>
<tr><td><code id="geoscalePhylo.mod_+3A_cex.tip">cex.tip</code></td>
<td>
<p>Size of the tip labels on the phylogeny</p>
</td></tr>
<tr><td><code id="geoscalePhylo.mod_+3A_width">width</code></td>
<td>
<p>Width of the edges of the phylogeny.</p>
</td></tr>
<tr><td><code id="geoscalePhylo.mod_+3A_label.offset">label.offset</code></td>
<td>
<p>A value for the distance between the nodes and tip labels, see help(plot.phylo).</p>
</td></tr>
<tr><td><code id="geoscalePhylo.mod_+3A_ts.col">ts.col</code></td>
<td>
<p>Option for using standard ICS colours on the time scale.</p>
</td></tr>
<tr><td><code id="geoscalePhylo.mod_+3A_vers">vers</code></td>
<td>
<p>The version of the geological time scale to use. Options include: &quot;ICS2013&quot;, &quot;ICS2012&quot;, &quot;ICS2010&quot;, &quot;ICS2009&quot; or &quot;ICS2008&quot;.</p>
</td></tr>
<tr><td><code id="geoscalePhylo.mod_+3A_x.lim">x.lim</code></td>
<td>
<p>A two item statement for the geological range, in millions of years, of the plot i.e. (0,65). If only one value is used it will be used as the upper limit, see help(plot.phylo).</p>
</td></tr>
<tr><td><code id="geoscalePhylo.mod_+3A_quat.rm">quat.rm</code></td>
<td>
<p>Option to remove the names from Quaternary time bins, useful when plotting clades with long durations that range through to the recent.</p>
</td></tr>
<tr><td><code id="geoscalePhylo.mod_+3A_erotate">erotate</code></td>
<td>
<p>A numerical value for the rotation for the Epoch/Series temporal units, default values are 0 when direction = &quot;upwards&quot; and 90 when direction = &quot;rightwards&quot;.</p>
</td></tr>
<tr><td><code id="geoscalePhylo.mod_+3A_arotate">arotate</code></td>
<td>
<p>A numerical value for the rotation for the Age/Stage temporal units, default values are 0 when direction = &quot;upwards&quot; and 90 when direction = &quot;rightwards&quot;.</p>
</td></tr>
<tr><td><code id="geoscalePhylo.mod_+3A_urotate">urotate</code></td>
<td>
<p>A numerical value for the rotation for the User temporal units, default values are 0 when direction = &quot;upwards&quot; and 90 when direction = &quot;rightwards&quot;.</p>
</td></tr>
<tr><td><code id="geoscalePhylo.mod_+3A_...">...</code></td>
<td>
<p>All other arguments passed to plot.phylo</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Often palaeontologists wish to display phylogenetic trees against a geological time scale for easy visualization of the temporal position of the taxa the generation of which can be time-consuming. geoscalePhylo fills this need and works in ths same way as geoscale.plot from the package geoscale and allows users to plot a time-scaled phylogeny against the International Chronostratigraphic Chart (Gradstein, 2014). This function accepts any tree time-scaled through either the function DatePhylo in this package or the timePaleoPhy function in the library paleotree.
</p>
<p>Built-in options allows the user control over which direction the tree is plotted in (either horizonally or vertically) as well as deciding which temporal units are included in the time scale (see below for example).
</p>
<p>Temporal units
</p>
<p>The function geoscalePhylo allows for a time-scaled phylogeny to be plotted against geologic time using either the current geologic time scale of Gradstein et al., 2012 or previously published time scales by the International Commisioin on Stratigraphy. The time scale that is plotted is comprised of a number of temporal components representing the different units that the geological time scale is divided into. There are five main temporal units that can be included, each of which have two alternative names and are as follows: Eon (Eonothem), Era (Erathem), System (Period), Series (Epoch), and Stage (Age). These alternative names can be used interchangably i.e. both Eon and Erathem are accepted, however should both these alternative names be included then that temporal unit will only be included once. In addition, the order in which they are included into units does not affect the order in which they appear in the chart so units=c(&quot;Period&quot;,&quot;Epoch&quot;,&quot;Age&quot;) will produce the same results as units=c(&quot;Age&quot;,&quot;Epoch&quot;,&quot;Period&quot;) with the default order as they were listed previously with Eons plotted at the base and Stages at the top.
</p>
<p>Including a user-defined time scale
</p>
<p>There is a sixth option that can be included into the units argument. &quot;User&quot; allows for an additional temporal unit to be plotted i.e. biozonal or terrane-specific time scales. This requires a matrix of three columns named &quot;Start&quot;, &quot;End&quot; and &quot;Name&quot; representing the bottom, top of each temporal bin (in millions of years) and the name to be plotted respectively. An example dataset called UKzones representing Stages of the UK Ordovician System is included in the package. See below for an example of how to implement this option.
</p>
<p>Stratigraphic ranges
</p>
<p>geoscalePhylo allows for the stratigraphic ranges to be included in the plot. This requires an matrix with the first appearance and last appearance dates in millions of years (FAD and LAD respectively) with the row names containing all the tip labels of the taxa in the tree, exactly as they appear in tree$tip.label and the column names should be &quot;FAD&quot; and &quot;LAD&quot;. In order to add the stratigraphic ranges to the plot this matrix should be attached to the argument ages. See below for an example of this option.
</p>
<p>Apparent appearance of polytomies
</p>
<p>It should be noted that using certain methods for time-scaling a tree, such as the &quot;basic&quot; method (the default), it can create the appearance of polytomies in a tree is otherwise fully resolved due to the presence of a large number of zero length branches. This can be solved by using another timescaling method such as the &quot;equal&quot; method which will enforce all the branches to have a positive length.
</p>


<h3>Value</h3>

<p>Nothing (simply produces a plot of the tree against geologic time).
</p>


<h3>Author(s)</h3>

<p>Mark A. Bell <a href="mailto:mark.bell521@gmail.com">mark.bell521@gmail.com</a>
</p>


<h3>References</h3>

<p>Gradstein, F. M., Ogg, J. M., and Schmitz, M. 2012. A Geologic Time Scale. Elsevier, Boston, USA.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
### Example lungfish data
utils::data(Dipnoi)

tree_l &lt;- DatePhylo(Dipnoi$tree, Dipnoi$ages, method = "equal", rlen = 1)

geoscalePhylo(tree = tree_l, boxes = "Age", cex.tip = 0.4)

# Plotting the tree with the stratigraphical ranges included
geoscalePhylo(tree = tree_l, ages = Dipnoi$ages, boxes = "Age", cex.tip = 0.4)

# Including all temporal units into the stratigraphic column
geoscalePhylo(tree_l, Dipnoi$ages, units = c("Eon", "Era", "Period", "Epoch", "Age"),
  boxes = "Age", cex.tip = 0.4)

# Plotting the numerical values on the time scale at Age resolution
geoscalePhylo(tree_l, Dipnoi$ages, units = c("Eon", "Era", "Period", "Epoch", "Age"),
  boxes="Age", cex.tip = 0.4, tick.scale = "Age")

### Example trilobite data
utils::data(Asaphidae)

tree_a &lt;- DatePhylo(Asaphidae$trees[[1]], Asaphidae$ages, method = "equal", rlen = 1)

geoscalePhylo(ladderize(tree_a), Asaphidae$ages, boxes = "Age", x.lim = c(504, 435),
  cex.tip = 0.5, cex.ts = 0.5, vers = "ICS2009")

# Plotting the tree vertically
geoscalePhylo(ladderize(tree_a), Asaphidae$ages, boxes = "Age", x.lim = c(504, 435),
  cex.tip = 0.5, cex.ts = 0.5, direction = "upwards", vers = "ICS2009")

# Including a user-defined time scale
utils::data(UKzones)
utils::data(Asaphidae)

tree_a &lt;- DatePhylo(Asaphidae$trees[[1]], Asaphidae$ages, method = "equal", rlen = 1)

geoscalePhylo(ladderize(tree_a), Asaphidae$ages, units = c("Eon", "Era", "Period",
  "Epoch", "User"), boxes = "Age", cex.tip = 0.4, user.scale = UKzones,
  vers = "ICS2009", cex.ts = 0.5, x.lim = c(520, 440), direction = "upwards")

# Rotating the text on the time scale
tree_a &lt;- DatePhylo(Asaphidae$trees[[1]], Asaphidae$ages, method = "equal", rlen = 1)

#geoscalePhylo(ladderize(tree_a), Asaphidae$ages, units = c("Period",
#  "Epoch", "Age", "User"), boxes = "Age", cex.tip = 0.4, user.scale = UKzones,
#  vers = "ICS2009", cex.ts = 0.5, x.lim = c(520, 440), arotate = 0, erotate = 0, urotate = 0)

</code></pre>

<hr>
<h2 id='StratPhyloCongruence'>Calculates fit to stratigraphy metrics for a set of tree(s)</h2><span id='topic+StratPhyloCongruence'></span>

<h3>Description</h3>

<p>Calculates SCI, RCI, MSM*, and GER for a number of topologies.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>StratPhyloCongruence(
  trees,
  ages,
  rlen = 0,
  method = "basic",
  samp.perm = 1000,
  rand.perm = 1000,
  hard = TRUE,
  randomly.sample.ages = FALSE,
  fix.topology = TRUE,
  fix.outgroup = TRUE,
  outgroup.taxon = NULL,
  calculate.SCI = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="StratPhyloCongruence_+3A_trees">trees</code></td>
<td>
<p>Input tree(s) as either a phylo or multiphylo object.</p>
</td></tr>
<tr><td><code id="StratPhyloCongruence_+3A_ages">ages</code></td>
<td>
<p>A two-column matrix of taxa (rows) against First and Last Appearance Datums (FADs and LADs) to be passed to DatePhylo. Note that rownames should be the taxon names exactly as they appear in tree$tip.label and colnames should be &quot;FAD&quot; and &quot;LAD&quot;. All ages should be in time before present.</p>
</td></tr>
<tr><td><code id="StratPhyloCongruence_+3A_rlen">rlen</code></td>
<td>
<p>Root length, to be passed to DatePhylo.</p>
</td></tr>
<tr><td><code id="StratPhyloCongruence_+3A_method">method</code></td>
<td>
<p>Tree dating method, to be passed to DatePhylo.</p>
</td></tr>
<tr><td><code id="StratPhyloCongruence_+3A_samp.perm">samp.perm</code></td>
<td>
<p>Number of sampled trees to be produced by resolving polytomies and/or drawing random dates for the tips for the input trees.</p>
</td></tr>
<tr><td><code id="StratPhyloCongruence_+3A_rand.perm">rand.perm</code></td>
<td>
<p>Number of random trees to be produced in calculating probabilities for the input trees, and (if used) the sampled trees.</p>
</td></tr>
<tr><td><code id="StratPhyloCongruence_+3A_hard">hard</code></td>
<td>
<p>Whether to treat polytomies as hard or soft. If FALSE polytomies are resolved randomly.</p>
</td></tr>
<tr><td><code id="StratPhyloCongruence_+3A_randomly.sample.ages">randomly.sample.ages</code></td>
<td>
<p>Whether to treat FAD and LAD as a range (randomly.sample.ages = FALSE) or an uncertainty (randomly.sample.ages = TRUE). If the latter then two ages are randomly sampled from the range and these are used as the FAD and LAD.</p>
</td></tr>
<tr><td><code id="StratPhyloCongruence_+3A_fix.topology">fix.topology</code></td>
<td>
<p>Whether to allow tree shape to be random (fix.topology = FALSE) or to reflect the tree shape of the input tree(s) (fix.topology = TRUE).</p>
</td></tr>
<tr><td><code id="StratPhyloCongruence_+3A_fix.outgroup">fix.outgroup</code></td>
<td>
<p>Whether to force the randomly generated trees to share the outgroup of the first input tree (fix.outgroup = TRUE) or not (fix.outgroup = FALSE)</p>
</td></tr>
<tr><td><code id="StratPhyloCongruence_+3A_outgroup.taxon">outgroup.taxon</code></td>
<td>
<p>The outgroup taxon name (only applicable if fix.outgroup = TRUE).</p>
</td></tr>
<tr><td><code id="StratPhyloCongruence_+3A_calculate.sci">calculate.SCI</code></td>
<td>
<p>Logical indicating whether or not to calculate the Stratigraphic Consistency Index (default is <code>TRUE</code>). If this index is not required switiching to <code>FALSE</code> can significantly improve the speed of the function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Cladograms of fossil taxa make explicit predictions about the successive appearance of taxa in the fossil record that can be compared with their observed stratigraphic ranges. Several methods have been developed to quantify this &quot;fit to stratigraphy&quot; of phylogenetic hypotheses, and these can be assessed in both a statistic (measuring the apparent strength of this congruence) and an associated significance test (p-value) based on generating random topologies for the same taxon set.
</p>
<p>This function produces both values for all four main metrics: the Stratigraphic Consistency Index (SCI; Huelsenbeck 1994), the Relative Consistency Index (RCI; Benton and Storrs 1994), the Manhattan Stratigraphic Measure (MSM*; Siddall 1998; Pol and Norell 2001), and the Gap Excess Ratio (GER; Wills 1999).
</p>
<p><b>SCI - Stratigraphic Consistency Index</b>
</p>
<p>The SCI works by assessing the &quot;consistency&quot; of nodes. A node is considered stratigraphically consistent if its oldest descendant is the same age or younger than the oldest descendant of the preceding node. The SCI is thus given simply as:
</p>
<p>SCI = C/N
</p>
<p>Where C is the sum of all the consistent nodes and N is the total number of nodes - 1. (As there is no node preceding the root there is no basis on which to estimate its consistency.) This value can range from zero (maximally inconsistent) to one (maximally consistent). However, a potential criticism of the SCI is that a high value may be returned when in fact a single inconsistent node may represent a very large amount of missing history (measured in unsampled units or millions of years), whereas a low SCI may represent relatively few unsampled units or millions of years.
</p>
<p><b>RCI - Relative Completeness Index</b>
</p>
<p>The RCI was the first method to explicitly account for the absolute amount of missing data implied by the tree. This figure is usually expressed as the Minimum Implied Gap (MIG), a term also used by both the MSM and GER (see below), and corresponds to the sum of the branch lengths excluding the duration of the terminals (the observed ranges of the taxa). The RCI expresses the MIG as a proportion of the sum of the observed ranges (Simple Range Length; SRL) of the taxa converted to a percentage:
</p>
<p>RCI = (1 - (MIG/SRL)) * 100percent
</p>
<p>Importantly this value is not confined to a 0 to 100 percent scale, and can have both negative values and values greater than 100 percent, which can make it difficult to interpret.
</p>
<p><b>MSM - Manhattan Stratigraphic Measure</b>
</p>
<p>The MSM was the first method to account for both the absolute MIG and range on a confined zero to one scale. It is expressed as:
</p>
<p>MSM = Lm/L0
</p>
<p>Where L0 is the length of the tree expressed by optimising times of first appearance on to the tree as a Sankoff character and taking the total length. Lm represents the same process, but for the optimal possible tree given the same set of first appearances. However, Pol and Norell (2001) noted a critical flaw in this approach, specifically that the Sankoff optimisation is reversible, meaning that nodes in the topology are allowed to be younger than their descendants, leading in some cases to a poor fit to stratigraphy being perceived as a good fit. Instead they suggest modifying the character step matrix to make the cost of reversals effectively infinite and hence impossible. Thus the values for L0 and Lm are modified accordingly. This approach they termed MSM* and is the implementation of MSM used here. This statistic can be expressed as:
</p>
<p>MSM* = Gmin/MIG
</p>
<p>Where Gmin represents the MIG for the tree with the optimal fit to stratigraphy. In effect this is a completely unbalanced tree where the youngest pair of taxa are the most deeply nested and successive outgroups represent the next oldest taxon. Theoretically MSM* ranges from one (the best fit as the observed tree is the maximally consistent tree) to zero (the least optimal tree). However, in effect no tree can have a value of zero as its MIG would have to be equal to infinity.
</p>
<p><b>GER - Gap Excess Ratio</b>
</p>
<p>The GER represents a method that accounts for MIG, ranges from zero to one, and the best and worst fits to stratigraphy are both practically realisable. It can be expressed as:
</p>
<p>GER = 1 - ((MIG - Gmin)/(Gmax - Gmin))
</p>
<p>Where Gmax represents the MIG of the tree with the worst possible fit to stratigraphy. This is in effect any topology where the oldest taxon is the most deeply nested such that every clade in the tree contains it and hence must be minimally that old.
</p>
<p><b>P-values</b>
</p>
<p>In isolation all four methods suffer from an inability to reject the null hypothesis that an apparent good fit to stratigraphy may be generated by chance alone. In practice this can be tested by generating a set of random topologies, calculating the fit to stratigraphy measure, and then either fitting a normal distribution to the resulting values (to get an estimated p-value) or assessing the relative position of the MIG of the observed (and sampled) tree(s) to get an absolute p-value. (Note that the assumption of normality may not always hold and the former approach should be used at the userâ€™s discretion. However, it should be noted that for the SCI, MSM*, and GER p-values are calculated after first transforming the data by taking the arcsine of the square root of each value.) The reason for having two sets of p-values is that if the observed trees fall completely outside the range of the random topologies they will be given an extreme p-value (0 or 1) that may be misleading. In such cases the estimated value may be more accurate.
</p>
<p>P-values should be interpreted as the probability of the null: that the observed tree(s) have an equal or worse fit to stratigraphy than the sample of random trees. Thus if the p-values are very small the user can reject the null hypothesis in favour of the alternative: that the observed tree(s) have a better fit to stratigraphy than expected by chance alone.
</p>
<p><b>Modifications of the GER</b>
</p>
<p>More recently Wills et al. (2008) introduced two new versions of the GER that take advantage of the distribution of MIGs from the set of randomly generated topologies. The first of these (GERt) uses the extreme values of the random topologies as modified versions of Gmax and Gmin, termed Gtmax and Gtmin respectively. GERt is thus expressed as:
</p>
<p>GERt = 1 - ((MIG - Gtmin)/(Gtmax - Gtmin))
</p>
<p>In practice the MIG of the observed tree(s) may fall outside of these ranges so here a correction factor is employed so that any value below zero is corrected to zero, and any value above one is corrected to one. An additional stipulation for GERt is that the overall tree topology is fixed and only the taxa themselves are shuffled. This is to give a more realistic set of random topologies as there are known biases towards unbalanced trees in many palaeontological data sets. Here this is implemented by selecting the fix.topology=TRUE option. However, here GERt can also be calculated when fix.topology=FALSE.
</p>
<p>A second modification of GER is to use the position of the observed tree(s) in the sample of randomly generated topologies, such that:
</p>
<p>GER* = 1 - (F ractionof distribution &lt;= MIG)
</p>
<p>Thus if the MIG of the observed tree(s) is less than any randomly generated topology GER* will be one (maximally optimal fit) and if it worse than any of the randomly generated topologies it will be zero (maximally suboptimal fit).
</p>
<p>Note: it is recommended that you use a large number of random topologies in order to get reliable values for GERt and GER* using rand.perm=N. Wills et al. (2008) used 50000, but the user should note that for many real world examples such values will take many hours to run.
</p>
<p>Wills et al. (2008) also introduced the notion of referring to intervals sampled rather than absolute time by recasting MIG as MIGu: the sum of ghost ranges for intervals of unit length. Although not directly implemented here this can be done manually by converting the time values (in Ma) used to simple unit counts such that FADs and LADs of taxa are given as numbered time bins (the youngest being 1 and the oldest N, where there are N time bins).
</p>
<p><b>Polytomies and age uncertainties</b>
</p>
<p>Alongside the input trees the user can also create an additional set of sampled trees based on the input trees. This option is automatically implemented when choosing either hard = FALSE or randomly.sample.ages = TRUE, and the total number of permutations to perform dictated by samp.perm = N. This process works by first sampling from the set of input tree(s) and then randomly resolving any polytomies (if hard = FALSE) to ensure all sampled trees are fully dichotomous. (At present the function does not allow the various options laid out in Boyd et al. 2011, but the user can achieve this effect by modifying the input trees themselves.) Then if randomly.sample.ages = TRUE the FAD and LAD are treated as bounds of a uniform distribution which is sampled at random. This allows the user to get results for a set of trees that account for uncertainty in dating (as outlined in Pol and Norell 2006). (Note that two dates are picked for each taxon to avoid the problem of having an SRL of zero that would cause a divide by zero error for the RCI metric.)
</p>
<p>All fit to stratigraphy measures calculated for the input trees are then repeated for the sampled trees. However, if both hard = TRUE and randomly.sample.ages = FALSE (the defaults) no set of sampled trees will be created.
</p>
<p>In all cases when using the function users will see progress bars that indicate the general progress through the various sets of trees (input, sampled, and randomly generated). This serves as a useful indicator of the time it will take for the function to finish. Here default values for samp.perm and rand.perm are both set at 1000, but the user may wish to lower these (to decrease calculation time) or increase them (to enhance accuracy).
</p>
<p><b>Additional options</b>
</p>
<p>Note that because this function uses DatePhylo the user has the option of using different tree dating algorithms than the basic method (equivalent to the basic method in the paleotree package) employed in all the published studies cited above (and the default option here). The dating method used will apply to all trees generated, including the input, sampled, and randomly generated topologies. In all cases the time-scaled trees are returned with the function output.
</p>
<p>A final option (fix.outgroup = TRUE) allows the user to always use the same outgroup taxon (supplied as outgroup.taxon) for all randomly generated topologies. Because the outgroup will often be the oldest taxon and its position in the input topologies is not allowed to vary letting it do so in the random topologies may lead to inferring a better fit to stratigraphy for the observed tree(s) than is fair. Fixing the outgroup thus ameliorates this potential bias and is the default option here.
</p>


<h3>Value</h3>

<table>
<tr><td><code>input.tree.results</code></td>
<td>
<p>A matrix with a row for each input tree and columns indicating the values for SCI, RCI, GER and MSM* and their estimated probabilities assuming a normal distribution (est.p.SCI, est.p.RCI, est.p.GER, and est.p.MSM*) as well as GERt, GER*, MIG, and p.Wills (their probability as position within the MIGs of the random topologies).</p>
</td></tr>
<tr><td><code>samp.permutation.results</code></td>
<td>
<p>If used, a matrix with a row for each sampled tree (up to samp.perm) and columns indicating the values for SCI, RCI, GER and MSM* and their estimated probabilities assuming a normal distribution (est.p.SCI, est.p.RCI, est.p.GER, and est.p.MSM*) as well as GERt, GER*, MIG, and p.Wills (their probability as position within the MIGs of random topologies).</p>
</td></tr>
<tr><td><code>rand.permutations</code></td>
<td>
<p>A matrix with a row for each randomly generated tree (up to rand.perm) and columns indicating the values for SCI, RCI, GER, MSM*, and MIG.</p>
</td></tr>
<tr><td><code>input.trees</code></td>
<td>
<p>The input tree(s) as a phylo or multiphylo object, with branches scaled to time according to the input values passed to <a href="#topic+DatePhylo">DatePhylo</a>.</p>
</td></tr>
<tr><td><code>samp.trees</code></td>
<td>
<p>The sampled tree(s) as a phylo or multiphylo object, with branches scaled to time according to the input values passed to <a href="#topic+DatePhylo">DatePhylo</a>.</p>
</td></tr>
<tr><td><code>rand.trees</code></td>
<td>
<p>The randomly generated tree(s) as a phylo or multiphylo object, with branches scaled to time according to the input values passed to <a href="#topic+DatePhylo">DatePhylo</a>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Mark A. Bell <a href="mailto:mark.bell521@gmail.com">mark.bell521@gmail.com</a> and Graeme T. Lloyd <a href="mailto:graemetlloyd@gmail.com">graemetlloyd@gmail.com</a>
</p>


<h3>References</h3>

<p>Bell, M. A. and Lloyd, G. T., 2015. <code>strap</code>: an R package for plotting phylogenies against stratigraphy and assessing their stratigraphic congruence. <em>Palaeontology</em>, <b>58</b>, 379-389.
</p>
<p>Benton, M. J. and Storrs, G. W., 1994. Testing the quality of the fossil record: palaeontological knowledge is improving. <em>Geology</em>, <b>22</b>, 111-114.
</p>
<p>Boyd, C. A., Cleland, T. P., Marrero, N. L. and Clarke, J. A., 2011. Exploring the effects of phylogenetic uncertainty and consensus trees on stratigraphic consistency scores: a new program and a standardized method. <em>Cladistics</em>, <b>27</b>, 52-60.
</p>
<p>Huelsenbeck, J. P., 1994. Comparing the stratigraphic record to estimates of phylogeny. <em>Paleobiology</em>, <b>20</b>, 470-483.
</p>
<p>Pol, D. and Norell, M. A., 2001. Comments on the Manhattan Stratigraphic Measure. <em>Cladistics</em>, <b>17</b>, 285-289.
</p>
<p>Pol, D. and Norell, M. A., 2006. Uncertainty in the age of fossils and the stratigraphic fit to phylogenies. <em>Systematic Biology</em>, <b>55</b>, 512-521.
</p>
<p>Siddall, M. E., 1998. Stratigraphic fit to phylogenies: a proposed solution. <em>Cladistics</em>, <b>14</b>, 201-208.
</p>
<p>Wills, M. A., 1999. Congruence between phylogeny and stratigraphy: randomization tests and the Gap Excess Ratio. <em>Systematic Biology</em>, <b>48</b>, 559-580.
</p>
<p>Wills, M. A., Barrett, P. M. and Heathcote, J. F., 2008. The modified Gap Excess Ratio (GER*) and the stratigraphic congruence of dinosaur phylogenies. <em>Systematic Biology</em>, <b>57</b>, 891-904.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run:  # Do not run for build purposes as slow
# Calculate stratigraphic fit measures treating ages as ranges
# (permutation numbers used are lower than recommended for standard use):
fit.to.strat.1 &lt;- StratPhyloCongruence(
  trees = Dipnoi$tree,
  ages = Dipnoi$ages,
  rlen = 0,
  method = "basic",
  samp.perm = 100,
  rand.perm = 100,
  hard = TRUE,
  randomly.sample.ages = FALSE,
  fix.topology = TRUE,
  fix.outgroup = TRUE,
  outgroup.taxon = "Psarolepis_romeri"
)

# View all output:
fit.to.strat.1

# Show output options:
names(fit.to.strat.1)

# Show just the output for the input tree(s):
fit.to.strat.1$input.tree.results

# Calculate stratigraphic fit measures treating ages as uncertainties
# (permutation numbers used are lower than recommended for standard use):
fit.to.strat.2 &lt;- StratPhyloCongruence(
  trees = Dipnoi$tree,
  ages = Dipnoi$ages,
  rlen = 0,
  method = "basic",
  samp.perm = 100,
  rand.perm = 100,
  hard = TRUE,
  randomly.sample.ages = TRUE,
  fix.topology = TRUE,
  fix.outgroup = TRUE,
  outgroup.taxon = "Psarolepis_romeri"
)

## End(Not run)

</code></pre>

<hr>
<h2 id='UKzones'>British regional stages for the Ordovician</h2><span id='topic+UKzones'></span>

<h3>Description</h3>

<p>The stratigraphic ranges for the British stages of the Ordovician.
</p>


<h3>Format</h3>

<p>A matrix containing the start and end ages for the British stage subdivisions of the Ordovician.
</p>


<h3>References</h3>

<p>Webby, B.D., Paris, F., Droser, M.L., and Percival, I.G. (editors), 2004. <em>The Great Ordovician Biodiversity Event</em>. Columbia University Press, New York, 496 pp.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
