<!DOCTYPE html><html><head><title>Help for package PhViD</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {PhViD}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#PhViD-package'><p>PhViD: an R package for PharmacoVigilance signal Detection</p></a></li>
<li><a href='#as.PhViD'><p>data.frame to PhViD data</p></a></li>
<li><a href='#BCPNN'><p>Bayesian confidence propagation neural network</p></a></li>
<li><a href='#GPS'><p>Gamma Poisson Shrinkage</p></a></li>
<li><a href='#PhViD.search'><p>PhViD.search</p></a></li>
<li><a href='#PhViDdata.frame'><p>Simulated Pharmacovigilance data</p></a></li>
<li><a href='#PRR'><p>Proportional Reporting Ratio</p></a></li>
<li><a href='#RFET'><p>Reporting Fisher's Exact Test</p></a></li>
<li><a href='#ROR'><p>Reporting Odds Ratio</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>PharmacoVigilance Signal Detection</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.8</td>
</tr>
<tr>
<td>Date:</td>
<td>2016-11-03</td>
</tr>
<tr>
<td>Author:</td>
<td>Ismaïl Ahmed &amp; Antoine Poncet</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Ismaïl Ahmed &lt;ismail.ahmed@inserm.fr&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10), LBE, MCMCpack</td>
</tr>
<tr>
<td>Description:</td>
<td>A collection of several pharmacovigilance signal detection methods extended to the multiple comparison setting.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2016-11-03 09:45:18 UTC; isma</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>Tcl/Tk package TkTable.</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2016-11-03 12:14:08</td>
</tr>
</table>
<hr>
<h2 id='PhViD-package'>PhViD: an R package for PharmacoVigilance signal Detection</h2><span id='topic+PhViD-package'></span><span id='topic+PhViD'></span>

<h3>Description</h3>

<p>The <code>PhViD-package</code> proposes the main pharmacovigilance signal detection methods extended to the multiple comparison setting. For the frequentist methods, the package requires the LBE procedure that is stored in the Bioconductor website <a href="http://bioconductor.org/">http://bioconductor.org/</a>. LBE can be installed by entering <br />
<code>source("http://bioconductor.org/biocLite.R")</code> <br />
<code>biocLite("LBE")</code> <br />
in the R console.
</p>


<h3>Author(s)</h3>

<p>Ismaïl Ahmed &amp; Antoine Poncet
</p>
<p>Maintainer: Ismaïl Ahmed &lt;ismail.ahmed@inserm.fr&gt;
</p>


<h3>References</h3>

<p>Ahmed I, Thiessard F, Miremont-Salamé G, Bégaud B, Tubert-Bitter P. Pharmacovigilance data mining with methods based on false discovery rates: a comparative simulation study. Clin. Pharmacol. Ther. 2010 Oct;88(4):492-498. 
</p>
<p>Ahmed I, Dalmasso C, Haramburu F, Thiessard F, Broët P, Tubert-Bitter P. False discovery rate estimation for frequentist pharmacovigilance signal detection methods. Biometrics. 2010 Mar;66(1):301-309. 
</p>
<p>Ahmed I, Haramburu F, Fourrier-Réglat A, Thiessard F, Kreft-Jais C, Miremont-Salamé G, Bégaud B, Tubert-Bitter P. Bayesian pharmacovigilance signal detection methods revisited in a multiple comparison setting. Stat Med. 2009 Jun 15;28(13):1774-1792. 
</p>
<p>Bate A, Lindquist M, Edwards IR, Olsson S, Orre R, Lansner A, De Freitas RM. A Bayesian Neural Network Method for Adverse Drug Reaction Signal Generation European Journal of Clinical Pharmacology, 1998, 54, 315-321.  
</p>
<p>Dalmasso C, Broet P, Moreau T (2005), A simple procedure for estimating the false discovery rate, Bioinformatics, Bioinformatics, 21: 660 - 668. 
</p>
<p>DuMouchel W. Bayesian Data Mining in Large Frequency Tables, with an Application to the FDA Spontaneous Reporting System. The American Statistician. 1999, 53. 177-190. 
</p>
<p>Evans SJ, Waller PC, Davis S, Use of Proportional Reporting Ratios (PRRs) for Signal Generation from Spontaneous Adverse Drug Reaction Reports Pharmacoepidemiology and Drug Safety, 2001, 10, 483-486. 
</p>
<p>Noren, GN, Bate A, Orre R, Edwards IR, Extending the methods used to screen the WHO drug safety database towards analysis of complex associations and improved accuracy for rare events Statistics in Medicine, 2006, 25, 3740-3757. 
</p>
<p>van Puijenbroek EP, Bate A, Leufkens HG, Lindquist M, Orre R, Egberts AC, A Comparison of Measures of Disproportionality for Signal Detection in Spontaneous Reporting Systems for Adverse Drug Reactions Pharmacoepidemiology and Drug Safety, 2002, 11, 3-1. 
</p>

<hr>
<h2 id='as.PhViD'>data.frame to PhViD data</h2><span id='topic+as.PhViD'></span>

<h3>Description</h3>

<p><code>as.PhViD</code> is a function that converts a data.frame into an object that can be used in the signal detection method functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.PhViD(DATA.FRAME, MARGIN.THRES = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.PhViD_+3A_data.frame">DATA.FRAME</code></td>
<td>
<p>The <code>data.frame</code> has to be structured as follows
</p>
<p>1st column: label of the drugs
</p>
<p>2nd column: label of the adverse events
</p>
<p>3rd column: Number of spontaneous reports of the corresponding couple drug-adverse event.
</p>
</td></tr>
<tr><td><code id="as.PhViD_+3A_margin.thres">MARGIN.THRES</code></td>
<td>
<p> This option can be used to eliminate the drugs and the adverse events for which the marginal counts are less than <code>MARGIN.THRES</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>L</code></td>
<td>
<p><code>data.frame</code> that contains the labels of the drugs and the adverse events.</p>
</td></tr>
<tr><td><code>N</code></td>
<td>
<p>sum of the spontaneous reports counts.</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p><code>data.frame</code> that contains the number of spontaneous reports (<code>n11</code>) and the corresponding marginal counts as well (<code>n1.</code> and <code>n.1</code>).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ismaïl Ahmed &amp; Antoine Poncet</p>

<hr>
<h2 id='BCPNN'>Bayesian confidence propagation neural network</h2><span id='topic+BCPNN'></span>

<h3>Description</h3>

<p>Bayesian confidence propagation neural network (Bate et al. 1998, Noren et al. 2006) extended to the multiple comparison framework. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BCPNN(DATABASE, RR0 = 1, MIN.n11 = 1, DECISION = 1, DECISION.THRES = 0.05, 
RANKSTAT = 1, MC = FALSE, NB.MC = 10000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BCPNN_+3A_database">DATABASE</code></td>
<td>
<p>Object returned by the function <code>as.PhViD</code>.</p>
</td></tr>
<tr><td><code id="BCPNN_+3A_rr0">RR0</code></td>
<td>
<p>Value of the tested risk. By default, <code>RR0=1</code>.</p>
</td></tr>
<tr><td><code id="BCPNN_+3A_min.n11">MIN.n11</code></td>
<td>
<p>Minimum number of notifications for a couple to be potentially considered as a signal. By default, <code>MIN.n11 = 1</code>.</p>
</td></tr>
<tr><td><code id="BCPNN_+3A_decision">DECISION</code></td>
<td>
<p>Decision rule for the signal generation based on
</p>
<p>1 = FDR (Default value)
</p>
<p>2 = Number of signals 
</p>
<p>3 = Ranking statistic. See <code>RANKSTAT</code></p>
</td></tr>
<tr><td><code id="BCPNN_+3A_decision.thres">DECISION.THRES</code></td>
<td>
<p>Threshold for <code>DECISION</code>. Ex 0.05 for FDR (<code>DECISION</code>=1). </p>
</td></tr>
<tr><td><code id="BCPNN_+3A_rankstat">RANKSTAT</code></td>
<td>
<p>Statistic used for ranking the couples:
</p>
<p>1 = Posterior probability of the null hypothesis
</p>
<p>2 = 2.5% quantile of the posterior distribution of IC.</p>
</td></tr>
<tr><td><code id="BCPNN_+3A_mc">MC</code></td>
<td>
<p>If <code>MC=TRUE</code>, the statistic of interest (see <code>RANKSTAT</code>) is calculated by Monte Carlo simulations which can be very long. If <code>MC=FALSE</code>, IC is approximated by a normal distribution (which can be very crude for small counts).</p>
</td></tr>
<tr><td><code id="BCPNN_+3A_nb.mc">NB.MC</code></td>
<td>
<p>If <code>MC=TRUE</code>, <code>NB.MC</code> indicates the number of Monte Carlo simulations to be done</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The BCPNN method is based on the calculation of the Information Component IC. If <code>MC = FALSE</code>, the bayesian model used is the beta-binomial proposed by Bate et al. (1998). The statistic of interest (see <code>RANKSTAT</code>) is calculated by the normal approximation made in Bate et al. (1998) with the use of the exact expectation and variance proposed by Gould (2003). If <code>MC = TRUE</code>, the model is based on the Dirichlet-multinomial model proposed more recently in Noren et al. (2006). In this case, the statistic of interest is calculated by Monte Carlo simulations. 
</p>


<h3>Value</h3>

<table>
<tr><td><code>ALLSIGNALS</code></td>
<td>
<p>Data.frame summarizing the results of all couples with at least <code>MIN.n11</code> notifications ordered by <code>RANKSTAT</code>. It contains notably the labels, the cell counts, the expected counts (<code class="reqn">n1. \times n.1 / N</code>, see <code><a href="#topic+as.PhViD">as.PhViD</a></code>), <code>RANKSTAT</code>, the ratios(count/expected count), the marginal counts and the estimations of FDR, FNR, Se et Sp. If <code>RANKSTAT!=1</code>, the last column is the posterior probability of the null hypothesis.</p>
</td></tr>
<tr><td><code>SIGNALS</code></td>
<td>
<p>Same Data.frame as <code>ALLSIGNALS</code> but restricted to the list of generated signals.</p>
</td></tr>
<tr><td><code>NB.SIGNALS</code></td>
<td>
<p>Number of generated signals.</p>
</td></tr> 
<tr><td><code>INPUT.PARAM</code></td>
<td>
<p>Parameters entered in the function.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ismaïl Ahmed &amp; Antoine Poncet</p>


<h3>References</h3>

<p>Ahmed I, Haramburu F, Fourrier-Réglat A, Thiessard F, Kreft-Jais C, Miremont-Salamé G, Bégaud B, Tubert-Bitter P. Bayesian pharmacovigilance signal detection methods revisited in a multiple comparison setting. Stat Med. 2009 Jun 15;28(13):1774-1792. 
</p>
<p>Bate A, Lindquist M, Edwards IR, Olsson S, Orre R, Lansner A, De Freitas RM, A Bayesian Neural Network Method for Adverse Drug Reaction Signal Generation European Journal of Clinical Pharmacology, 1998, 54, 315-321.
</p>
<p>Gould AL, Practical Pharmacovigilance Analysis Strategies Pharmacoepidemiology and Drug Safety, 2003, 12, 559-574
</p>
<p>Noren, GN, Bate A, Orre R, Edwards IR, Extending the methods used to screen the WHO drug safety database towards analysis of complex associations and improved accuracy for rare events Statistics in Medicine, 2006, 25, 3740-3757.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## start
data(PhViDdata.frame)
PhViDdata &lt;- as.PhViD(PhViDdata.frame)
# res &lt;- BCPNN(PhViDdata)
## end
</code></pre>

<hr>
<h2 id='GPS'>Gamma Poisson Shrinkage</h2><span id='topic+GPS'></span>

<h3>Description</h3>

<p>Gamma Poisson Shrinkage model proposed by DuMouchel (1999) extended to the multiple comparison framework. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GPS(DATABASE,  RR0 = 1, MIN.n11 = 1, DECISION = 1, DECISION.THRES = 0.05, 
RANKSTAT = 1, TRONC = FALSE, TRONC.THRES = 1,   
PRIOR.INIT = c(alpha1 = 0.2, beta1 = 0.06, alpha2 = 1.4,
beta2 = 1.8, w = 0.1), PRIOR.PARAM = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GPS_+3A_database">DATABASE</code></td>
<td>
<p>Object returned by the function <code>as.PhViD</code>.</p>
</td></tr>
<tr><td><code id="GPS_+3A_rr0">RR0</code></td>
<td>
<p>Value of the tested risk. By default, <code>RR0=1</code>.</p>
</td></tr>
<tr><td><code id="GPS_+3A_min.n11">MIN.n11</code></td>
<td>
<p>Minimum number of notifications for a couple to be potentially considered as a signal. This option does not affect the calculation of the hyper parameters. By default, <code>MIN.n11 = 1</code>.</p>
</td></tr>
<tr><td><code id="GPS_+3A_decision">DECISION</code></td>
<td>
<p>Decision rule for the signal generation based on
</p>
<p>1 = FDR (Default value)
</p>
<p>2 = Number of signals
</p>
<p>3 = Ranking statistic. See <code>RANKSTAT</code></p>
</td></tr>
<tr><td><code id="GPS_+3A_decision.thres">DECISION.THRES</code></td>
<td>
<p>Threshold for <code>DECISION</code>. Ex 0.05 for FDR (<code>DECISION</code>=1). </p>
</td></tr>
<tr><td><code id="GPS_+3A_rankstat">RANKSTAT</code></td>
<td>
<p>Statistic used for ranking the couples:
</p>
<p>1 = Posterior probability of the null hypothesis
</p>
<p>2 = 5% quantile of the posterior distribution of <code class="reqn">\lambda</code>
</p>
<p>3 = Posterior Expectation of <code class="reqn">\log_2(\lambda)</code></p>
</td></tr> 
<tr><td><code id="GPS_+3A_tronc">TRONC</code></td>
<td>
<p>If TRUE, only the data with at least <code>TRONC.THRES</code> notifications are considered in the calculation of the hyper parameters and the likelihood is a product of mixture of two negative binomial truncated by <code>TRONC.THRES-1</code>. By default, <code>TRONC=F</code></p>
</td></tr>
<tr><td><code id="GPS_+3A_tronc.thres">TRONC.THRES</code></td>
<td>
<p>See <code>TRONC</code> </p>
</td></tr>
<tr><td><code id="GPS_+3A_prior.init">PRIOR.INIT</code></td>
<td>
<p>Vector of initialization of the prior parameters <code class="reqn">(\alpha_1, \beta_1, \alpha_2, \beta_2, w)</code>. By default, <code>PRIOR.INIT</code> <code class="reqn">= c(\alpha_1 = 0.2, \beta_1 = 0.06, \alpha_2 = 1.4, \beta_2 = 1.8, w = 0.1)</code>, ie the prior parameters found in DuMouchel (1999).</p>
</td></tr>
<tr><td><code id="GPS_+3A_prior.param">PRIOR.PARAM</code></td>
<td>
<p>Chosen hyper parameters. By default, <code>PRIOR.PARAM</code> = NULL which means that the hyperparameters are calculated by maximising the marginal likelihood.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Each observed count <code class="reqn">n_{11}</code> is assumed to be drawn from a Poisson distribution with parameters 
<code class="reqn">e_{11}</code> where <code class="reqn">e_{11}</code> is the expected count under the hypothesis of independence between the adverse events and the drugs (<code class="reqn">n1. \times n.1 / N</code>, see <code><a href="#topic+as.PhViD">as.PhViD</a></code>). <code class="reqn">\lambda</code> is a priori assumed to be distributed according to a mixture of two gamma distributions: <code class="reqn">\lambda \sim w \: \Gamma(\alpha_1,\beta_1) + (1-w) \: \Gamma(\alpha_2,\beta_2)</code>.</p>


<h3>Value</h3>

<table>
<tr><td><code>ALLSIGNALS</code></td>
<td>
<p>Data.frame summarizing the results of all couples with at least <code>MIN.n11</code> notifications ordered by <code>RANKSTAT</code>. It contains notably the labels, the cell counts, the expected counts, <code>RANKSTAT</code>, the ratios(count/expected count), the marginal counts and the estimations of FDR, FNR, Se et Sp. If <code>RANKSTAT!=1</code>, the last column is the posterior probability of the null hypothesis.</p>
</td></tr>
<tr><td><code>SIGNALS</code></td>
<td>
<p>Same Data.frame as <code>ALLSIGNALS</code> but restricted to the list of generated signals.</p>
</td></tr>
<tr><td><code>NB.SIGNALS</code></td>
<td>
<p>Number of generated signals.</p>
</td></tr> 
<tr><td><code>INPUT.PARAM</code></td>
<td>
<p>Parameters entered in the function.</p>
</td></tr>
<tr><td><code>PARAM</code></td>
<td>
<p>A list that contains the prior hyper parameters (<code>PRIOR.PARAM</code>). Additionally if <code>PRIOR.PARAM=NULL</code>, it also contains the prior hyper parameters initialization (<code>PRIOR.INIT</code>) and the convergence code (see <code>nlm()</code>).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ismaïl Ahmed &amp; Antoine Poncet</p>


<h3>References</h3>

<p>Ahmed I, Haramburu F, Fourrier-Réglat A, Thiessard F, Kreft-Jais C, Miremont-Salamé G, Bégaud B, Tubert-Bitter P. Bayesian pharmacovigilance signal detection methods revisited in a multiple comparison setting. Stat Med. 2009 Jun 15;28(13):1774-1792. 
</p>
<p>DuMouchel W, Bayesian Data Mining in Large Frequency Tables, with an Application to the FDA Spontaneous Reporting System, The American Statistician, 1999, 53, 177-190.
</p>
<p>Szarfman A, Machado S, O'Neill R, Use of Screening Algorithms and Computer Systems to Efficiently Signal Higher-Than-Expected Combinations of Drugs and Events in the US FDA's Spontaneous Reports Database Drug Safety, 2002, 25, 381-392.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## start
#data(PhViDdata.frame)


#PhViDdata &lt;- as.PhViD(PhViDdata.frame)
#res &lt;- GPS(PhViDdata)

#List of signals generated by the decision rule proposed 
#by Szarfman et al. (2002)
#res2 &lt;- GPS(PhViDdata, DECISION = 3, DECISION.THRES = 2, RANKSTAT = 2)
## end
</code></pre>

<hr>
<h2 id='PhViD.search'>PhViD.search</h2><span id='topic+PhViD.search'></span>

<h3>Description</h3>

<p>This function makes possible to extract some information from the output of the PhViD functions for a given couple adverse event-drug, for a drug or for an adverse event.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PhViD.search(RESULT, DRUG = NULL, EVENT = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PhViD.search_+3A_result">RESULT</code></td>
<td>
<p><code>RESULT</code> must be the output of one the signal detection method functions (<code>ROR, PRR, RFET, GPS</code> or <code>BCPNN</code></p>
</td></tr>
<tr><td><code id="PhViD.search_+3A_drug">DRUG</code></td>
<td>
<p>The label of the drug. By default, <code>DRUG=FALSE</code>.</p>
</td></tr>
<tr><td><code id="PhViD.search_+3A_event">EVENT</code></td>
<td>
<p>The label of the adverse event. By default, <code>EVENT=FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>DRUG</code></td>
<td>
<p>Recalls the label of the drug.</p>
</td></tr>
<tr><td><code>EVENT</code></td>
<td>
<p>Recalls the label of the event.</p>
</td></tr>
<tr><td><code>EXIST_DRUG</code></td>
<td>
<p>Indicates if the label of the drug exists in the database.</p>
</td></tr>
<tr><td><code>EVENT</code></td>
<td>
<p>Indicates if the label of the adverse event exists in the database.</p>
</td></tr>
<tr><td><code>EXIST_COUPLE</code></td>
<td>
<p>Indicates if the couple is present in the database.</p>
</td></tr>
<tr><td><code>LIST</code></td>
<td>
<p>It is a <code>dataframe</code> that contains the labels, the counts, the expected counts, the value of the statistic of interest, the rank and the estimated FDR for each couple.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Antoine Poncet &amp; Ismaïl Ahmed</p>

<hr>
<h2 id='PhViDdata.frame'>Simulated Pharmacovigilance data</h2><span id='topic+PhViDdata.frame'></span>

<h3>Description</h3>

<p>This is a simulated data set aiming at mimicking the French database coded in ATC5 for the drugs and HLT for the adverse events. The simulation procedure is described in Ahmed et al.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(PhViDdata.frame)</code></pre>


<h3>Format</h3>

<p>A data frame with 102483 observations on the following 3 variables.
</p>

<dl>
<dt><code>Drug lab</code></dt><dd><p>a factor indicating the label of the 634 drugs.</p>
</dd>
<dt><code>AE lab</code></dt><dd><p>a factor indicating the label of the 756 adverse events.</p>
</dd>
<dt><code>n11</code></dt><dd><p>a numeric vector indicating the number of spontaneous reports of the corresponding couple.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Ismaïl Ahmed &amp; Antoine Poncet</p>

<hr>
<h2 id='PRR'>Proportional Reporting Ratio</h2><span id='topic+PRR'></span>

<h3>Description</h3>

<p>Proportional Reporting Ratio proposed by Evans et al. (2001) extended to the multiple comparison framework. Note that the computed variance is different from the one used in van Puijenbroek et al. (2002)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PRR(DATABASE, RR0 = 1, MIN.n11 = 1, DECISION = 1, 
DECISION.THRES = 0.05, RANKSTAT = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PRR_+3A_database">DATABASE</code></td>
<td>
<p>Object returned by the function <code>as.PhViD</code>.</p>
</td></tr>
<tr><td><code id="PRR_+3A_rr0">RR0</code></td>
<td>
<p>Value of the tested relative risk. By default, <code>RR0=1</code>.</p>
</td></tr>
<tr><td><code id="PRR_+3A_min.n11">MIN.n11</code></td>
<td>
<p>Minimum number of notifications for a couple to be potentially considered as a signal. By default, <code>MIN.n11 = 1</code>.</p>
</td></tr>
<tr><td><code id="PRR_+3A_decision">DECISION</code></td>
<td>
<p>Decision rule for the signal generation based on  
1 = FDR (Default value) 
</p>
<p>2 = Number of signals
</p>
<p>3 = Ranking statistic. See <code>RANKSTAT</code></p>
</td></tr>
<tr><td><code id="PRR_+3A_decision.thres">DECISION.THRES</code></td>
<td>
<p>Threshold for <code>DECISION</code>. Ex 0.05 for FDR (<code>DECISION</code>=1). </p>
</td></tr>
<tr><td><code id="PRR_+3A_rankstat">RANKSTAT</code></td>
<td>
<p>Statistic used for ranking the couples:
</p>
<p>1 = P-value
</p>
<p>2 = Lower bound of the 95% two sided confidence interval of log(PRR).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The FDR is estimated with the LBE procedure proposed by Dalmasso et al. (2005). Note that the FDR can only be estimated if the statistic of interest is the P-value.
</p>


<h3>Value</h3>

<table>
<tr><td><code>ALLSIGNALS</code></td>
<td>
<p>Data.frame summarizing the results of all couples with at least <code>MIN.n11</code> notifications ordered by <code>RANKSTAT</code>. It contains notably the labels, the cell counts, the expected counts (<code class="reqn">n1. \times n.1 / N</code>, see <code><a href="#topic+as.PhViD">as.PhViD</a></code>), <code>RANKSTAT</code>, the observed relative risks (PRR), the marginal counts and the estimations of FDR (when <code>RANKSTAT=1</code>.)</p>
</td></tr>
<tr><td><code>SIGNALS</code></td>
<td>
<p>Same Data.frame as <code>ALLSIGNALS</code> but restricted to the list of generated signals.</p>
</td></tr>
<tr><td><code>NB.SIGNALS</code></td>
<td>
<p>Number of generated signals.</p>
</td></tr> 
<tr><td><code>INPUT.PARAM</code></td>
<td>
<p>Parameters entered in the function.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ismaïl Ahmed &amp; Antoine Poncet</p>


<h3>References</h3>

<p>Ahmed I, Dalmasso C, Haramburu F, Thiessard F, Broët P, Tubert-Bitter P. False discovery rate estimation for frequentist pharmacovigilance signal detection methods. Biometrics. 2010 Mar;66(1):301-309. 
</p>
<p>Dalmasso C, Broët P, Moreau T (2005), A simple procedure for estimating the false discovery rate, Bioinformatics, Bioinformatics, 21: 660 - 668.
</p>
<p>Evans SJ, Waller PC, Davis S, Use of Proportional Reporting Ratios (PRRs) for Signal Generation from Spontaneous Adverse Drug Reaction Reports Pharmacoepidemiology and Drug Safety, 2001, 10, 483-486. 
</p>
<p>van Puijenbroek EP, Bate A, Leufkens HGM, Lindquist M, Orre R and Egberts ACG, A comparison of measures of disproportionality for signal detection in spontaneous reporting systems for adverse drug reactions, Pharmacoepidemiology and Drug Safety, 2002, 11, 3-10.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## start
data(PhViDdata.frame)
PhViDdata &lt;- as.PhViD(PhViDdata.frame)
# res &lt;- PRR(PhViDdata)
## end
</code></pre>

<hr>
<h2 id='RFET'>Reporting Fisher's Exact Test</h2><span id='topic+RFET'></span>

<h3>Description</h3>

<p>This function proposes the Fisher's Exact Test as an alternative to the PRR and ROR methods. The statistic of interest is the P-value or the mid-P-value resulting from the test (Ahmed et al., Biometrics).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RFET(DATABASE, OR0 = 1, MIN.n11 = 1, DECISION = 1, 
DECISION.THRES = 0.05, MID.PVAL = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RFET_+3A_database">DATABASE</code></td>
<td>
<p>Object returned by the function <code>as.PhViD</code>.</p>
</td></tr>
<tr><td><code id="RFET_+3A_or0">OR0</code></td>
<td>
<p>Value of the tested odds ratio. By default, <code>OR0=1</code>.</p>
</td></tr>
<tr><td><code id="RFET_+3A_min.n11">MIN.n11</code></td>
<td>
<p>Minimum number of notifications for a couple to be potentially considered as a signal. By default, <code>MIN.n11 = 1</code>.</p>
</td></tr>
<tr><td><code id="RFET_+3A_decision">DECISION</code></td>
<td>
<p>Decision rule for the signal generation based on
</p>
<p>1 = FDR (Default value)
</p>
<p>2 = Number of signals
</p>
<p>3 = P-values or mid-P-values. See <code>MID.PVAL</code></p>
</td></tr>
<tr><td><code id="RFET_+3A_decision.thres">DECISION.THRES</code></td>
<td>
<p>Threshold for <code>DECISION</code>. Ex 0.05 for FDR (<code>DECISION</code>=1). </p>
</td></tr>
<tr><td><code id="RFET_+3A_mid.pval">MID.PVAL</code></td>
<td>
<p>if <code>MID.PVAL=TRUE</code>, the statistic of interest becomes the mid-P-values instead of the P-values resulting from the Fisher's exact test. By default <code>MID.PVAL=FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The FDR is estimated with the LBE procedure proposed by Dalmasso et al. (2005).
</p>


<h3>Value</h3>

<table>
<tr><td><code>ALLSIGNALS</code></td>
<td>
<p>Data.frame summarizing the results of all couples with at least <code>MIN.n11</code> notifications ordered by <code>RANKSTAT</code>. It contains notably the labels, the cell counts, the expected count (<code class="reqn">n1. \times n.1 / N</code>, see <code><a href="#topic+as.PhViD">as.PhViD</a></code>), <code>RANKSTAT</code>, the observed odds ratio (ROR), the marginal counts and the estimation of FDR.</p>
</td></tr>
<tr><td><code>SIGNALS</code></td>
<td>
<p>Same Data.frame as <code>ALLSIGNALS</code> but restricted to the list of generated signals.</p>
</td></tr>
<tr><td><code>NB.SIGNALS</code></td>
<td>
<p>Number of generated signals.</p>
</td></tr> 
<tr><td><code>INPUT.PARAM</code></td>
<td>
<p>Parameters entered in the function.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ismaïl Ahmed &amp; Antoine Poncet</p>


<h3>References</h3>

<p>Ahmed I, Dalmasso C, Haramburu F, Thiessard F, Broët P, Tubert-Bitter P. False discovery rate estimation for frequentist pharmacovigilance signal detection methods. Biometrics. 2010 Mar;66(1):301-309. 
</p>
<p>Dalmasso C, Broët P, Moreau T (2005), A simple procedure for estimating the false discovery rate, Bioinformatics, Bioinformatics, 21: 660 - 668.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## start
#data(PhViDdata.frame)
#PhViDdata &lt;- as.PhViD(PhViDdata.frame)
#res &lt;- RFET(PhViDdata)
## end
</code></pre>

<hr>
<h2 id='ROR'>Reporting Odds Ratio</h2><span id='topic+ROR'></span>

<h3>Description</h3>

<p>Reporting Odds Ratio proposed by van Puijenbroak et al. (2002) extended to the multiple comparison framework.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ROR(DATABASE, OR0 = 1, MIN.n11 = 1, DECISION = 1, 
DECISION.THRES = 0.05, RANKSTAT = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ROR_+3A_database">DATABASE</code></td>
<td>
<p>Object returned by the function <code>as.PhViD</code>.</p>
</td></tr>
<tr><td><code id="ROR_+3A_or0">OR0</code></td>
<td>
<p>Value of the tested odds ratio. By default, <code>OR0=1</code>.</p>
</td></tr>
<tr><td><code id="ROR_+3A_min.n11">MIN.n11</code></td>
<td>
<p>Minimum number of notifications for a couple to be potentially considered as a signal. By default, <code>MIN.n11 = 1</code>.</p>
</td></tr>
<tr><td><code id="ROR_+3A_decision">DECISION</code></td>
<td>
<p>Decision rule for the signal generation based on
</p>
<p>1 = FDR (Default value) 
</p>
<p>2 = Number of signals 
</p>
<p>3 = Ranking statistic. See <code>RANKSTAT</code></p>
</td></tr>
<tr><td><code id="ROR_+3A_decision.thres">DECISION.THRES</code></td>
<td>
<p>Threshold for <code>DECISION</code>. Ex 0.05 for FDR (<code>DECISION</code>=1). </p>
</td></tr>
<tr><td><code id="ROR_+3A_rankstat">RANKSTAT</code></td>
<td>
<p>Statistic used for ranking the couples: 
</p>
<p>1 = P-value 
</p>
<p>2 = Lower bound of the 95% two sided confidence interval of log(ROR).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The FDR is estimated with the LBE procedure proposed by Dalmasso et al. (2005). Note that the FDR can only be estimated if the statistic of interest is the P-value.
</p>


<h3>Value</h3>

<table>
<tr><td><code>ALLSIGNALS</code></td>
<td>
<p>Data.frame summarizing the results of all couples with at least <code>MIN.n11</code> notifications ordered by <code>RANKSTAT</code>. It contains notably the labels, the cell counts, the expected counts (<code class="reqn">n1. \times n.1 / N</code>, see <code><a href="#topic+as.PhViD">as.PhViD</a></code>), <code>RANKSTAT</code>, the observed odds ratios (ROR), the marginal counts and the estimations of FDR (when 
<code>RANKSTAT=1</code>.)</p>
</td></tr>
<tr><td><code>SIGNALS</code></td>
<td>
<p>Same Data.frame as <code>ALLSIGNALS</code> but restricted to the list of generated signals.</p>
</td></tr>
<tr><td><code>NB.SIGNALS</code></td>
<td>
<p>Number of generated signals.</p>
</td></tr> 
<tr><td><code>INPUT.PARAM</code></td>
<td>
<p>Parameters entered in the function.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ismaïl Ahmed &amp; Antoine Poncet</p>


<h3>References</h3>

<p>Ahmed I, Dalmasso C, Haramburu F, Thiessard F, Broët P, Tubert-Bitter P. False discovery rate estimation for frequentist pharmacovigilance signal detection methods. Biometrics. 2010 Mar;66(1):301-309. 
</p>
<p>Dalmasso C, Broët P, Moreau T (2005), A simple procedure for estimating the false discovery rate, Bioinformatics, Bioinformatics, 21: 660 - 668.
</p>
<p>van Puijenbroek EP, Bate A, Leufkens HG, Lindquist M, Orre R, Egberts AC, A Comparison of Measures of Disproportionality for Signal Detection in Spontaneous Reporting Systems for Adverse Drug Reactions Pharmacoepidemiology and Drug Safety, 2002, 11, 3-1.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## start
data(PhViDdata.frame)
PhViDdata &lt;- as.PhViD(PhViDdata.frame)
res &lt;- ROR(PhViDdata, MIN.n11 = 3)

# Decision rule proposed by van Puijenbroek et al. (2002)
# res2 &lt;- ROR(PhViDdata, MIN.n11 = 1, DECISION=3, DECISION.THRES=0, RANKSTAT=2)
## end
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
