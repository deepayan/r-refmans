<!DOCTYPE html><html lang="en"><head><title>Help for package MGMM</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {MGMM}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#MGMM-package'><p>MGMM: Missingness Aware Gaussian Mixture Models</p></a></li>
<li><a href='#CalHar'><p>Calinski-Harabaz Index</p></a></li>
<li><a href='#ChooseK'><p>Cluster Number Selection</p></a></li>
<li><a href='#ClustQual'><p>Cluster Quality</p></a></li>
<li><a href='#CombineMIs'><p>Combine Multiple Imputations</p></a></li>
<li><a href='#DavBou'><p>Davies-Bouldin Index</p></a></li>
<li><a href='#FitGMM'><p>Estimate Multivariate Normal Mixture</p></a></li>
<li><a href='#FitMix'><p>Fit Multivariate Mixture Distribution</p></a></li>
<li><a href='#FitMVN'><p>Fit Multivariate Normal Distribution</p></a></li>
<li><a href='#GenImputation'><p>Generate Imputation</p></a></li>
<li><a href='#logLik.mix'><p>Log likelihood for Fitted GMM</p></a></li>
<li><a href='#logLik.mvn'><p>Log likelihood for Fitted MVN Model</p></a></li>
<li><a href='#mean.mix'><p>Mean for Fitted GMM</p></a></li>
<li><a href='#mean.mvn'><p>Mean for Fitted MVN Model</p></a></li>
<li><a href='#mix-class'><p>Mixture Model Class</p></a></li>
<li><a href='#MixUpdateMeans'><p>Mean Update for Mixture of MVNs with Missingness.</p></a></li>
<li><a href='#mvn-class'><p>Multivariate Normal Model Class</p></a></li>
<li><a href='#PartitionData'><p>Partition Data by Missingness Pattern</p></a></li>
<li><a href='#print.mix'><p>Print for Fitted GMM</p></a></li>
<li><a href='#print.mvn'><p>Print for Fitted MVN Model</p></a></li>
<li><a href='#ReconstituteData'><p>Reconstitute Data</p></a></li>
<li><a href='#rGMM'><p>Generate Data from Gaussian Mixture Models</p></a></li>
<li><a href='#show+2Cmix-method'><p>Show for Fitted Mixture Models</p></a></li>
<li><a href='#show+2Cmvn-method'><p>Show for Multivariate Normal Models</p></a></li>
<li><a href='#vcov.mix'><p>Covariance for Fitted GMM</p></a></li>
<li><a href='#vcov.mvn'><p>Covariance for Fitted MVN Model</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Missingness Aware Gaussian Mixture Models</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-09-30</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.1.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Parameter estimation and classification for Gaussian Mixture Models (GMMs) in the presence of missing data. This package complements existing implementations by allowing for both missing elements in the input vectors and full (as opposed to strictly diagonal) covariance matrices. Estimation is performed using an expectation conditional maximization algorithm that accounts for missingness of both the cluster assignments and the vector components. The output includes the marginal cluster membership probabilities; the mean and covariance of each cluster; the posterior probabilities of cluster membership; and a completed version of the input data, with missing values imputed to their posterior expectations. For additional details, please see McCaw ZR, Julienne H, Aschard H. "Fitting Gaussian mixture models on incomplete data." &lt;<a href="https://doi.org/10.1186%2Fs12859-022-04740-9">doi:10.1186/s12859-022-04740-9</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>Imports:</td>
<td>cluster, methods, mvnfast, plyr, Rcpp (&ge; 1.0.3), stats</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.0.0), knitr, rmarkdown, withr</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-09-30 15:23:08 UTC; zmccaw</td>
</tr>
<tr>
<td>Author:</td>
<td>Zachary McCaw <a href="https://orcid.org/0000-0002-2006-9828"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Zachary McCaw &lt;zmccaw@alumni.harvard.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-09-30 15:42:38 UTC</td>
</tr>
</table>
<hr>
<h2 id='MGMM-package'>MGMM: Missingness Aware Gaussian Mixture Models</h2><span id='topic+MGMM'></span><span id='topic+MGMM-package'></span>

<h3>Description</h3>

<p>Parameter estimation and classification for Gaussian Mixture Models (GMMs) in the presence of missing data. This package complements existing implementations by allowing for both missing elements in the input vectors and full (as opposed to strictly diagonal) covariance matrices. Estimation is performed using an expectation conditional maximization algorithm that accounts for missingness of both the cluster assignments and the vector components. The output includes the marginal cluster membership probabilities; the mean and covariance of each cluster; the posterior probabilities of cluster membership; and a completed version of the input data, with missing values imputed to their posterior expectations. For additional details, please see McCaw ZR, Julienne H, Aschard H. &quot;Fitting Gaussian mixture models on incomplete data.&quot; <a href="https://doi.org/10.1186/s12859-022-04740-9">doi:10.1186/s12859-022-04740-9</a>.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Zachary McCaw <a href="mailto:zmccaw@alumni.harvard.edu">zmccaw@alumni.harvard.edu</a> (<a href="https://orcid.org/0000-0002-2006-9828">ORCID</a>)
</p>

<hr>
<h2 id='CalHar'>Calinski-Harabaz Index</h2><span id='topic+CalHar'></span>

<h3>Description</h3>

<p>Calculates the Calinski-Harabaz index.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CalHar(data, assign, means)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="CalHar_+3A_data">data</code></td>
<td>
<p>Observations.</p>
</td></tr>
<tr><td><code id="CalHar_+3A_assign">assign</code></td>
<td>
<p>Assignments.</p>
</td></tr>
<tr><td><code id="CalHar_+3A_means">means</code></td>
<td>
<p>List of cluster means.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Scalar metric.
</p>

<hr>
<h2 id='ChooseK'>Cluster Number Selection</h2><span id='topic+ChooseK'></span>

<h3>Description</h3>

<p>Function to choose the number of clusters k. Examines cluster numbers between
k0 and k1. For each cluster number, generates <code>boot</code> bootstrap data
sets, fits the Gaussian Mixture Model (<code><a href="#topic+FitGMM">FitGMM</a></code>), and calculates
quality metrics (<code><a href="#topic+ClustQual">ClustQual</a></code>). For each metric, determines the
optimal cluster number <code>k_opt</code>, and the <code>k_1SE</code>, the smallest
cluster number whose quality is within 1 SE of the optimum.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ChooseK(
  data,
  k0 = 2,
  k1 = NULL,
  boot = 100,
  init_means = NULL,
  fix_means = FALSE,
  init_covs = NULL,
  init_props = NULL,
  maxit = 10,
  eps = 1e-04,
  report = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ChooseK_+3A_data">data</code></td>
<td>
<p>Numeric data matrix.</p>
</td></tr>
<tr><td><code id="ChooseK_+3A_k0">k0</code></td>
<td>
<p>Minimum number of clusters.</p>
</td></tr>
<tr><td><code id="ChooseK_+3A_k1">k1</code></td>
<td>
<p>Maximum number of clusters.</p>
</td></tr>
<tr><td><code id="ChooseK_+3A_boot">boot</code></td>
<td>
<p>Bootstrap replicates.</p>
</td></tr>
<tr><td><code id="ChooseK_+3A_init_means">init_means</code></td>
<td>
<p>Optional list of initial mean vectors.</p>
</td></tr>
<tr><td><code id="ChooseK_+3A_fix_means">fix_means</code></td>
<td>
<p>Fix the means to their starting value? Must provide initial
values.</p>
</td></tr>
<tr><td><code id="ChooseK_+3A_init_covs">init_covs</code></td>
<td>
<p>Optional list of initial covariance matrices.</p>
</td></tr>
<tr><td><code id="ChooseK_+3A_init_props">init_props</code></td>
<td>
<p>Optional vector of initial cluster proportions.</p>
</td></tr>
<tr><td><code id="ChooseK_+3A_maxit">maxit</code></td>
<td>
<p>Maximum number of EM iterations.</p>
</td></tr>
<tr><td><code id="ChooseK_+3A_eps">eps</code></td>
<td>
<p>Minimum acceptable increment in the EM objective.</p>
</td></tr>
<tr><td><code id="ChooseK_+3A_report">report</code></td>
<td>
<p>Report bootstrap progress?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List containing <code>Choices</code>, the recommended number of clusters
according to each quality metric, and <code>Results</code>, the mean and standard
error of the quality metrics at each cluster number evaluated.
</p>


<h3>See Also</h3>

<p>See <code><a href="#topic+ClustQual">ClustQual</a></code> for evaluating cluster quality, and <code><a href="#topic+FitGMM">FitGMM</a></code>
for estimating the GMM with a specified cluster number.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(100)
mean_list &lt;- list(c(2, 2), c(2, -2), c(-2, 2), c(-2, -2))
data &lt;- rGMM(n = 500, d = 2, k = 4, means = mean_list)
choose_k &lt;- ChooseK(data, k0 = 2, k1 = 6, boot = 10)
choose_k$Choices

</code></pre>

<hr>
<h2 id='ClustQual'>Cluster Quality</h2><span id='topic+ClustQual'></span>

<h3>Description</h3>

<p>Evaluates cluster quality. Returns the following metrics:
</p>

<ul>
<li><p> BIC: Bayesian Information Criterion, lower value indicates better clustering quality.
</p>
</li>
<li><p> CHI: Calinski-Harabaz Index, higher value indicates better clustering quality.
</p>
</li>
<li><p> DBI: Davies-Bouldin, lower value indicates better clustering quality.
</p>
</li>
<li><p> SIL: Silhouette Width, higher value indicates better clustering quality.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>ClustQual(fit)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ClustQual_+3A_fit">fit</code></td>
<td>
<p>Object of class mix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List containing the cluster quality metrics.
</p>


<h3>See Also</h3>

<p>See <code><a href="#topic+ChooseK">ChooseK</a></code> for using quality metrics to choose the cluster number.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(100)

# Data generation
mean_list = list(
c(2, 2, 2),
c(-2, 2, 2),
c(2, -2, 2),
c(2, 2, -2)
)

data &lt;- rGMM(n = 500, d = 3, k = 4, means = mean_list)
fit &lt;- FitGMM(data, k = 4)

# Clustering quality
cluster_qual &lt;- ClustQual(fit)
</code></pre>

<hr>
<h2 id='CombineMIs'>Combine Multiple Imputations</h2><span id='topic+CombineMIs'></span>

<h3>Description</h3>

<p>Combines point estimates and standard errors across multiple imputations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CombineMIs(points, covs)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="CombineMIs_+3A_points">points</code></td>
<td>
<p>List of point estimates, potentially vector valued.</p>
</td></tr>
<tr><td><code id="CombineMIs_+3A_covs">covs</code></td>
<td>
<p>List of sampling covariances, potentially matrix valued.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List containing the final point estimate ('point') and 
sampling covariance ('cov').
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(100)

# Generate data and introduce missingness.
data &lt;- rGMM(n = 25, d = 2, k = 1)
data[1, 1] &lt;- NA
data[2, 2] &lt;- NA
data[3, ] &lt;- NA 

# Fit GMM.
fit &lt;- FitGMM(data)

# Lists to store summary statistics.
points &lt;- list()
covs &lt;- list()

# Perform 50 multiple imputations.
# For each, calculate the marginal mean and its sampling variance.
for (i in seq_len(50)) {
  imputed &lt;- GenImputation(fit)
  points[[i]] &lt;- apply(imputed, 2, mean)
  covs[[i]] &lt;- cov(imputed) / nrow(imputed)
}

# Combine summary statistics across imputations.
results &lt;- CombineMIs(points, covs)
</code></pre>

<hr>
<h2 id='DavBou'>Davies-Bouldin Index</h2><span id='topic+DavBou'></span>

<h3>Description</h3>

<p>Calculates the Davies-Bouldin index.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DavBou(data, assign, means)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="DavBou_+3A_data">data</code></td>
<td>
<p>Observations</p>
</td></tr>
<tr><td><code id="DavBou_+3A_assign">assign</code></td>
<td>
<p>Assignments</p>
</td></tr>
<tr><td><code id="DavBou_+3A_means">means</code></td>
<td>
<p>List of cluster means</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Scalar index.
</p>

<hr>
<h2 id='FitGMM'>Estimate Multivariate Normal Mixture</h2><span id='topic+FitGMM'></span>

<h3>Description</h3>

<p>Given an <code class="reqn">n \times d</code> matrix of random vectors, estimates the parameters
of a Gaussian Mixture Model (GMM). Accommodates arbitrary patterns of missingness
at random (MAR) in the input vectors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FitGMM(
  data,
  k = 1,
  init_means = NULL,
  fix_means = FALSE,
  init_covs = NULL,
  init_props = NULL,
  maxit = 100,
  eps = 1e-06,
  report = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FitGMM_+3A_data">data</code></td>
<td>
<p>Numeric data matrix.</p>
</td></tr>
<tr><td><code id="FitGMM_+3A_k">k</code></td>
<td>
<p>Number of mixture components. Defaults to 1.</p>
</td></tr>
<tr><td><code id="FitGMM_+3A_init_means">init_means</code></td>
<td>
<p>Optional list of initial mean vectors.</p>
</td></tr>
<tr><td><code id="FitGMM_+3A_fix_means">fix_means</code></td>
<td>
<p>Fix the means to their starting value? Must provide initial
values.</p>
</td></tr>
<tr><td><code id="FitGMM_+3A_init_covs">init_covs</code></td>
<td>
<p>Optional list of initial covariance matrices.</p>
</td></tr>
<tr><td><code id="FitGMM_+3A_init_props">init_props</code></td>
<td>
<p>Optional vector of initial cluster proportions.</p>
</td></tr>
<tr><td><code id="FitGMM_+3A_maxit">maxit</code></td>
<td>
<p>Maximum number of EM iterations.</p>
</td></tr>
<tr><td><code id="FitGMM_+3A_eps">eps</code></td>
<td>
<p>Minimum acceptable increment in the EM objective.</p>
</td></tr>
<tr><td><code id="FitGMM_+3A_report">report</code></td>
<td>
<p>Report fitting progress?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Initial values for the cluster means, covariances, and proportions are
specified using <code>M0</code>, <code>S0</code>, and <code>pi0</code>, respectively. If the
data contains complete observations, i.e. observations with no missing
elements, then <code>fit.GMM</code> will attempt to initialize these parameters
internally using K-means. If the data contains no complete observations, then
initial values are required for <code>M0</code>, <code>S0</code>, and <code>pi0</code>.
</p>


<h3>Value</h3>


<ul>
<li><p> For a single component, an object of class <code>mvn</code>, containing
the estimated mean and covariance, the final objective function, and the
imputed data. 
</p>
</li>
<li><p> For a multicomponent model <code class="reqn">k&gt;1</code>, an object of class <code>mix</code>, 
containing the estimated means, covariances, cluster proportions, cluster
responsibilities, and observation assignments.
</p>
</li></ul>



<h3>See Also</h3>

<p>See <code><a href="#topic+rGMM">rGMM</a></code> for data generation, and <code><a href="#topic+ChooseK">ChooseK</a></code> for selecting
the number of clusters.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Single component without missingness
# Bivariate normal observations
sigma &lt;- matrix(c(1, 0.5, 0.5, 1), nrow = 2)
data &lt;- rGMM(n = 1e3, d = 2, k = 1, means = c(2, 2), covs = sigma)
fit &lt;- FitGMM(data, k = 1)

# Single component with missingness
# Trivariate normal observations
mean_list &lt;- list(c(-2, -2, -2), c(2, 2, 2))
sigma &lt;- matrix(c(1, 0.5, 0.5, 0.5, 1, 0.5, 0.5, 0.5, 1), nrow = 3)
data &lt;- rGMM(n = 1e3, d = 3, k = 2, means = mean_list, covs = sigma)
fit &lt;- FitGMM(data, k = 2)

# Two components without missingness
# Trivariate normal observations
mean_list &lt;- list(c(-2, -2, -2), c(2, 2, 2))
sigma &lt;- matrix(c(1, 0.5, 0.5, 0.5, 1, 0.5, 0.5, 0.5, 1), nrow = 3)
data &lt;- rGMM(n = 1e3, d = 3, k = 2, means = mean_list, covs = sigma)
fit &lt;- FitGMM(data, k = 2)

# Four components with missingness
# Bivariate normal observations
# Note: Fitting is slow.
mean_list &lt;- list(c(2, 2), c(2, -2), c(-2, 2), c(-2, -2))
sigma &lt;- 0.5 * diag(2)
data &lt;- rGMM(
n = 1000, 
d = 2, 
k = 4, 
pi = c(0.35, 0.15, 0.15, 0.35), 
m = 0.1, 
means = mean_list, 
covs = sigma)
fit &lt;- FitGMM(data, k = 4)

</code></pre>

<hr>
<h2 id='FitMix'>Fit Multivariate Mixture Distribution</h2><span id='topic+FitMix'></span>

<h3>Description</h3>

<p>Given a matrix of random vectors, estimates the parameters for a mixture of
multivariate normal distributions. Accommodates arbitrary patterns of
missingness, provided the elements are missing at random (MAR).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FitMix(
  data,
  k = 2,
  init_means = NULL,
  fix_means = FALSE,
  init_covs = NULL,
  init_props = NULL,
  maxit = 100,
  eps = 1e-06,
  report = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FitMix_+3A_data">data</code></td>
<td>
<p>Numeric data matrix.</p>
</td></tr>
<tr><td><code id="FitMix_+3A_k">k</code></td>
<td>
<p>Number of mixture components. Defaults to 2.</p>
</td></tr>
<tr><td><code id="FitMix_+3A_init_means">init_means</code></td>
<td>
<p>Optional list of initial mean vectors.</p>
</td></tr>
<tr><td><code id="FitMix_+3A_fix_means">fix_means</code></td>
<td>
<p>Fix means to their starting values? Must initialize.</p>
</td></tr>
<tr><td><code id="FitMix_+3A_init_covs">init_covs</code></td>
<td>
<p>Optional list of initial covariance matrices.</p>
</td></tr>
<tr><td><code id="FitMix_+3A_init_props">init_props</code></td>
<td>
<p>Optional vector of initial cluster proportions.</p>
</td></tr>
<tr><td><code id="FitMix_+3A_maxit">maxit</code></td>
<td>
<p>Maximum number of EM iterations.</p>
</td></tr>
<tr><td><code id="FitMix_+3A_eps">eps</code></td>
<td>
<p>Minimum acceptable increment in the EM objective.</p>
</td></tr>
<tr><td><code id="FitMix_+3A_report">report</code></td>
<td>
<p>Report fitting progress?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Object of class <code>mix</code>.
</p>

<hr>
<h2 id='FitMVN'>Fit Multivariate Normal Distribution</h2><span id='topic+FitMVN'></span>

<h3>Description</h3>

<p>Given a matrix of n x d-dimensional random vectors, possibly containing
missing elements, estimates the mean and covariance of the best fitting
multivariate normal distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FitMVN(
  data,
  init_mean = NULL,
  fix_mean = FALSE,
  init_cov = NULL,
  maxit = 100,
  eps = 1e-06,
  report = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FitMVN_+3A_data">data</code></td>
<td>
<p>Numeric data matrix.</p>
</td></tr>
<tr><td><code id="FitMVN_+3A_init_mean">init_mean</code></td>
<td>
<p>Optional initial mean vector.</p>
</td></tr>
<tr><td><code id="FitMVN_+3A_fix_mean">fix_mean</code></td>
<td>
<p>Fix the mean to its starting value? Must initialize.</p>
</td></tr>
<tr><td><code id="FitMVN_+3A_init_cov">init_cov</code></td>
<td>
<p>Optional initial covariance matrix.</p>
</td></tr>
<tr><td><code id="FitMVN_+3A_maxit">maxit</code></td>
<td>
<p>Maximum number of EM iterations.</p>
</td></tr>
<tr><td><code id="FitMVN_+3A_eps">eps</code></td>
<td>
<p>Minimum acceptable increment in the EM objective.</p>
</td></tr>
<tr><td><code id="FitMVN_+3A_report">report</code></td>
<td>
<p>Report fitting progress?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>mvn</code>.
</p>

<hr>
<h2 id='GenImputation'>Generate Imputation</h2><span id='topic+GenImputation'></span>

<h3>Description</h3>

<p>Generates a stochastic imputation of a data set from a fitted data set.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GenImputation(fit)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GenImputation_+3A_fit">fit</code></td>
<td>
<p>Fitted model.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric matrix with missing values imputed.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(100)

# Generate data and introduce missingness.
data &lt;- rGMM(n = 25, d = 2, k = 1)
data[1, 1] &lt;- NA
data[2, 2] &lt;- NA
data[3, ] &lt;- NA 

# Fit GMM.
fit &lt;- FitGMM(data)

# Generate imputation.
imputed &lt;- GenImputation(fit)
</code></pre>

<hr>
<h2 id='logLik.mix'>Log likelihood for Fitted GMM</h2><span id='topic+logLik.mix'></span>

<h3>Description</h3>

<p>Log likelihood for Fitted GMM
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mix'
logLik(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="logLik.mix_+3A_object">object</code></td>
<td>
<p>A <code>mix</code> object.</p>
</td></tr>
<tr><td><code id="logLik.mix_+3A_...">...</code></td>
<td>
<p>Unused.</p>
</td></tr>
</table>

<hr>
<h2 id='logLik.mvn'>Log likelihood for Fitted MVN Model</h2><span id='topic+logLik.mvn'></span>

<h3>Description</h3>

<p>Log likelihood for Fitted MVN Model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mvn'
logLik(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="logLik.mvn_+3A_object">object</code></td>
<td>
<p>A <code>mvn</code> object.</p>
</td></tr>
<tr><td><code id="logLik.mvn_+3A_...">...</code></td>
<td>
<p>Unused.</p>
</td></tr>
</table>

<hr>
<h2 id='mean.mix'>Mean for Fitted GMM</h2><span id='topic+mean.mix'></span>

<h3>Description</h3>

<p>Mean for Fitted GMM
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mix'
mean(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mean.mix_+3A_x">x</code></td>
<td>
<p>A <code>mix</code> object.</p>
</td></tr>
<tr><td><code id="mean.mix_+3A_...">...</code></td>
<td>
<p>Unused.</p>
</td></tr>
</table>

<hr>
<h2 id='mean.mvn'>Mean for Fitted MVN Model</h2><span id='topic+mean.mvn'></span>

<h3>Description</h3>

<p>Mean for Fitted MVN Model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mvn'
mean(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mean.mvn_+3A_x">x</code></td>
<td>
<p>A <code>mvn</code> object.</p>
</td></tr>
<tr><td><code id="mean.mvn_+3A_...">...</code></td>
<td>
<p>Unused.</p>
</td></tr>
</table>

<hr>
<h2 id='mix-class'>Mixture Model Class</h2><span id='topic+mix-class'></span>

<h3>Description</h3>

<p>Defines a class to hold Gaussian Mixture Models.
</p>


<h3>Slots</h3>


<dl>
<dt><code>Assignments</code></dt><dd><p>Maximum a posteriori assignments.</p>
</dd>
<dt><code>Completed</code></dt><dd><p>Completed data, with missing values imputed to their
posterior expectations.</p>
</dd>
<dt><code>Components</code></dt><dd><p>Number of components.</p>
</dd>
<dt><code>Covariances</code></dt><dd><p>List of fitted cluster covariance matrices.</p>
</dd>
<dt><code>Data</code></dt><dd><p>Original data, with missing values present.</p>
</dd>
<dt><code>Density</code></dt><dd><p>Density of each component at each example.</p>
</dd>
<dt><code>Means</code></dt><dd><p>List of fitted cluster means.</p>
</dd>
<dt><code>Objective</code></dt><dd><p>Final value of the EM objective.</p>
</dd>
<dt><code>Proportions</code></dt><dd><p>Fitted cluster proportions.</p>
</dd>
<dt><code>Responsibilities</code></dt><dd><p>Posterior membership probabilities for each example.</p>
</dd>
</dl>

<hr>
<h2 id='MixUpdateMeans'>Mean Update for Mixture of MVNs with Missingness.</h2><span id='topic+MixUpdateMeans'></span>

<h3>Description</h3>

<p>Mean Update for Mixture of MVNs with Missingness.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MixUpdateMeans(split_data, means, covs, gamma)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MixUpdateMeans_+3A_split_data">split_data</code></td>
<td>
<p>Data partitioned by missingness.</p>
</td></tr>
<tr><td><code id="MixUpdateMeans_+3A_means">means</code></td>
<td>
<p>List of component means.</p>
</td></tr>
<tr><td><code id="MixUpdateMeans_+3A_covs">covs</code></td>
<td>
<p>List of component covariances.</p>
</td></tr>
<tr><td><code id="MixUpdateMeans_+3A_gamma">gamma</code></td>
<td>
<p>List of component responsibilities.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List containing the updated component means.
</p>

<hr>
<h2 id='mvn-class'>Multivariate Normal Model Class</h2><span id='topic+mvn-class'></span>

<h3>Description</h3>

<p>Defines a class to hold multivariate normal models.
</p>


<h3>Slots</h3>


<dl>
<dt><code>Completed</code></dt><dd><p>Completed data, with missing values imputed to their
posterior expectations.</p>
</dd>
<dt><code>Covariance</code></dt><dd><p>Fitted covariance matrix.</p>
</dd>
<dt><code>Data</code></dt><dd><p>Original data, with missing values present.</p>
</dd>
<dt><code>Mean</code></dt><dd><p>Fitted mean vector.</p>
</dd>
<dt><code>Objective</code></dt><dd><p>Final value of the EM objective.</p>
</dd>
</dl>

<hr>
<h2 id='PartitionData'>Partition Data by Missingness Pattern</h2><span id='topic+PartitionData'></span>

<h3>Description</h3>

<p>Returns a list with the input data split in separate matrices for complete
cases, incomplete cases, and empty cases.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PartitionData(data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PartitionData_+3A_data">data</code></td>
<td>
<p>Data.frame.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List containing:
</p>

<ul>
<li><p> The original row and column names: 'orig_row_names', 'orig_col_names'.
</p>
</li>
<li><p> The original row and column numbers: 'n_row' and 'n_col'.
</p>
</li>
<li><p> The complete cases 'data_comp'.
</p>
</li>
<li><p> The incomplete cases 'data_incomp'.
</p>
</li>
<li><p> The empty cases 'data_empty'.
</p>
</li>
<li><p> Counts of complete 'n0', incomplete 'n1', and empty 'n2' cases.
</p>
</li>
<li><p> Initial order of the observations 'init_order'. 
</p>
</li></ul>


<hr>
<h2 id='print.mix'>Print for Fitted GMM</h2><span id='topic+print.mix'></span>

<h3>Description</h3>

<p>Print method for objects of class <code>mix</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mix'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.mix_+3A_x">x</code></td>
<td>
<p>A <code>mix</code> object.</p>
</td></tr>
<tr><td><code id="print.mix_+3A_...">...</code></td>
<td>
<p>Unused.</p>
</td></tr>
</table>

<hr>
<h2 id='print.mvn'>Print for Fitted MVN Model</h2><span id='topic+print.mvn'></span>

<h3>Description</h3>

<p>Print for Fitted MVN Model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mvn'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.mvn_+3A_x">x</code></td>
<td>
<p>A <code>mvn</code> object.</p>
</td></tr>
<tr><td><code id="print.mvn_+3A_...">...</code></td>
<td>
<p>Unused.</p>
</td></tr>
</table>

<hr>
<h2 id='ReconstituteData'>Reconstitute Data</h2><span id='topic+ReconstituteData'></span>

<h3>Description</h3>

<p>Reassembles a data matrix split by missingness pattern.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ReconstituteData(split_data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ReconstituteData_+3A_split_data">split_data</code></td>
<td>
<p>Split data are returned by <code><a href="#topic+PartitionData">PartitionData</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric matrix.
</p>

<hr>
<h2 id='rGMM'>Generate Data from Gaussian Mixture Models</h2><span id='topic+rGMM'></span>

<h3>Description</h3>

<p>Generates an <code class="reqn">n\times d</code> matrix of multivariate normal random vectors
with observations (examples) as rows. If <code class="reqn">k=1</code>, all observations belong to the same
cluster. If <code class="reqn">k&gt;1</code> the observations are generated via two-step procedure.
First, the cluster membership is drawn from a multinomial distribution, with
mixture proportions specified by <code>pi</code>. Conditional on cluster
membership, the observation is drawn from a multivariate normal distribution,
with cluster-specific mean and covariance. The cluster means are provided
using <code>means</code>, and the cluster covariance matrices are provided using
<code>covs</code>. If <code class="reqn">miss&gt;0</code>, missingness is introduced, completely at random, by
setting that proportion of elements in the data matrix to <code>NA</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rGMM(n, d = 2, k = 1, pi = NULL, miss = 0, means = NULL, covs = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rGMM_+3A_n">n</code></td>
<td>
<p>Observations (rows).</p>
</td></tr>
<tr><td><code id="rGMM_+3A_d">d</code></td>
<td>
<p>Observation dimension (columns).</p>
</td></tr>
<tr><td><code id="rGMM_+3A_k">k</code></td>
<td>
<p>Number of mixture components. Defaults to 1.</p>
</td></tr>
<tr><td><code id="rGMM_+3A_pi">pi</code></td>
<td>
<p>Mixture proportions. If omitted, components are assumed
equiprobable.</p>
</td></tr>
<tr><td><code id="rGMM_+3A_miss">miss</code></td>
<td>
<p>Proportion of elements missing, <code class="reqn">miss\in[0,1)</code>.</p>
</td></tr>
<tr><td><code id="rGMM_+3A_means">means</code></td>
<td>
<p>Either a prototype mean vector, or a list of mean vectors. Defaults
to the zero vector.</p>
</td></tr>
<tr><td><code id="rGMM_+3A_covs">covs</code></td>
<td>
<p>Either a prototype covariance matrix, or a list of covariance
matrices. Defaults to the identity matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric matrix with observations as rows. Row numbers specify the
true cluster assignments.
</p>


<h3>See Also</h3>

<p>For estimation, see <code><a href="#topic+FitGMM">FitGMM</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(100)
# Single component without missingness.
# Bivariate normal observations.
cov &lt;- matrix(c(1, 0.5, 0.5, 1), nrow = 2)
data &lt;- rGMM(n = 1e3, d = 2, k = 1, means = c(2, 2), covs = cov)

# Single component with missingness.
# Trivariate normal observations.
mean_list &lt;- list(c(-2, -2, -2), c(2, 2, 2))
cov &lt;- matrix(c(1, 0.5, 0.5, 0.5, 1, 0.5, 0.5, 0.5, 1), nrow = 3)
data &lt;- rGMM(n = 1e3, d = 3, k = 2, means = mean_list, covs = cov)

# Two components without missingness.
# Trivariate normal observations.
mean_list &lt;- list(c(-2, -2, -2), c(2, 2, 2))
cov &lt;- matrix(c(1, 0.5, 0.5, 0.5, 1, 0.5, 0.5, 0.5, 1), nrow = 3)
data &lt;- rGMM(n = 1e3, d = 3, k = 2, means = mean_list, covs = cov)

# Four components with missingness.
# Bivariate normal observations.
mean_list &lt;- list(c(2, 2), c(2, -2), c(-2, 2), c(-2, -2))
cov &lt;- 0.5 * diag(2)
data &lt;- rGMM(
n = 1000, 
d = 2, 
k = 4, 
pi = c(0.35, 0.15, 0.15, 0.35), 
miss = 0.1, 
means = mean_list, 
covs = cov)
</code></pre>

<hr>
<h2 id='show+2Cmix-method'>Show for Fitted Mixture Models</h2><span id='topic+show+2Cmix-method'></span>

<h3>Description</h3>

<p>Show for Fitted Mixture Models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'mix'
show(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="show+2B2Cmix-method_+3A_object">object</code></td>
<td>
<p>A <code>mix</code> object.</p>
</td></tr>
</table>

<hr>
<h2 id='show+2Cmvn-method'>Show for Multivariate Normal Models</h2><span id='topic+show+2Cmvn-method'></span>

<h3>Description</h3>

<p>Show for Multivariate Normal Models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'mvn'
show(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="show+2B2Cmvn-method_+3A_object">object</code></td>
<td>
<p>A <code>mvn</code> object.</p>
</td></tr>
</table>

<hr>
<h2 id='vcov.mix'>Covariance for Fitted GMM</h2><span id='topic+vcov.mix'></span>

<h3>Description</h3>

<p>Covariance for Fitted GMM
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mix'
vcov(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="vcov.mix_+3A_object">object</code></td>
<td>
<p>A <code>mix</code> object.</p>
</td></tr>
<tr><td><code id="vcov.mix_+3A_...">...</code></td>
<td>
<p>Unused.</p>
</td></tr>
</table>

<hr>
<h2 id='vcov.mvn'>Covariance for Fitted MVN Model</h2><span id='topic+vcov.mvn'></span>

<h3>Description</h3>

<p>Covariance for Fitted MVN Model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mvn'
vcov(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="vcov.mvn_+3A_object">object</code></td>
<td>
<p>A <code>mvn</code> object.</p>
</td></tr>
<tr><td><code id="vcov.mvn_+3A_...">...</code></td>
<td>
<p>Unused.</p>
</td></tr>
</table>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
