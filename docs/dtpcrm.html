<!DOCTYPE html><html><head><title>Help for package dtpcrm</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {dtpcrm}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#applied_crm'><p>Execute the CRM</p></a></li>
<li><a href='#applied_crm_sim'><p>Simulate CRM trials using specified design options</p></a></li>
<li><a href='#applied_titecrm'><p>Execute the TITE-CRM</p></a></li>
<li><a href='#applied_titecrm_sim'><p>Simulate TITE-CRM trials using specified design options</p></a></li>
<li><a href='#applied_titecrmts_sim'><p>Simulate TITE-CRM trials using specified design options</p></a></li>
<li><a href='#calculate_dtps'><p>Produce the Dose Transition Pathways</p></a></li>
<li><a href='#dtpflow'><p>Produce DTP flow diagram</p></a></li>
<li><a href='#plot_crm'><p>Plot of posterior estimates from the CRM</p></a></li>
<li><a href='#stop_for_consensus_reached'><p>Stopping for consensus</p></a></li>
<li><a href='#stop_for_excess_toxicity_empiric'><p>Stopping for excess toxicity - Empiric method</p></a></li>
<li><a href='#stop_for_excess_toxicity_logistic'><p>Stopping for excess toxicity - Logistic method</p></a></li>
<li><a href='#stop_for_sample_size'><p>Stopping for sample size reached</p></a></li>
<li><a href='#summary_crm'><p>Provide a summary of applied_crm output</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Dose Transition Pathways for Continual Reassessment Method</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.1</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Christina Yap &lt;yapchristina17@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides the dose transition pathways (DTP) to project in advance
    the doses recommended by a model-based design for subsequent patients (stay,
    escalate, deescalate or stop early) using all the accumulated toxicity
    information; See Yap et al (2017) &lt;<a href="https://doi.org/10.1158%2F1078-0432.CCR-17-0582">doi:10.1158/1078-0432.CCR-17-0582</a>&gt;. DTP
    can be used as a design and an operational tool and can be displayed as a
    table or flow diagram. The 'dtpcrm' package also provides the modified
    continual reassessment method (CRM) and time-to-event CRM (TITE-CRM) with
    added practical considerations to allow stopping early when there is
    sufficient evidence that the lowest dose is too toxic and/or there is a
    sufficient number of patients dosed at the maximum tolerated dose.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Imports:</td>
<td>diagram, dfcrm</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-08-20 09:01:12 UTC; pany</td>
</tr>
<tr>
<td>Author:</td>
<td>Christina Yap [aut, cre],
  Daniel Slade [aut],
  Kristian Brock [aut],
  Yi Pan [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-08-20 11:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='applied_crm'>Execute the CRM</h2><span id='topic+applied_crm'></span>

<h3>Description</h3>

<p>applied_crm is used to execute the continual reassessment method
with specified design options to determine the dose for the next subject.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>applied_crm(prior, target, tox, level, no_skip_esc = TRUE,
  no_skip_deesc = TRUE, global_coherent_esc = TRUE, stop_func = NULL,
  ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="applied_crm_+3A_prior">prior</code></td>
<td>
<p>A vector of prior estimates of toxicity probabilties for the
dose levels.</p>
</td></tr>
<tr><td><code id="applied_crm_+3A_target">target</code></td>
<td>
<p>The target DLT rate.</p>
</td></tr>
<tr><td><code id="applied_crm_+3A_tox">tox</code></td>
<td>
<p>A vector of subject outcomes; 1 indicates toxicity, 0 otherwise.</p>
</td></tr>
<tr><td><code id="applied_crm_+3A_level">level</code></td>
<td>
<p>A vector of dose levels assigned to subjects. The length of
level must be equal to that of tox.</p>
</td></tr>
<tr><td><code id="applied_crm_+3A_no_skip_esc">no_skip_esc</code></td>
<td>
<p>If FALSE, the method will not enforce no skipping of doses
in escalation. Default is TRUE.</p>
</td></tr>
<tr><td><code id="applied_crm_+3A_no_skip_deesc">no_skip_deesc</code></td>
<td>
<p>If FALSE, the method will not enforce no skipping of
doses in de-escalation. Default is TRUE.</p>
</td></tr>
<tr><td><code id="applied_crm_+3A_global_coherent_esc">global_coherent_esc</code></td>
<td>
<p>If FALSE, the method will not enforce global
coherent escalation, that is, escalation if the overall rate of toxicity
seen at the current dose level is above the target rate. Default is TRUE.</p>
</td></tr>
<tr><td><code id="applied_crm_+3A_stop_func">stop_func</code></td>
<td>
<p>An optional argument to provide a function which will
utilised alongside the CRM to determine if the trial should be stopped.</p>
</td></tr>
<tr><td><code id="applied_crm_+3A_...">...</code></td>
<td>
<p>Any other arguments detailed in dfcrm::crm.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For maximum likelihood estimation, the variance of the estimate of beta
(post.var) is approximated by the posterior variance of beta with a
dispersed normal prior.
</p>
<p>The empiric model is specified as F(d, beta) = d^exp(beta). The logistic model is
specified as logit (F(d,beta)) = intcpt + exp(beta) * d. For method=&quot;bayes&quot;, the
prior on beta is normal with mean 0. Exponentiation of beta ensures an increasing
dose-toxicity function.
</p>
<p>This function is largely a wrapper for the dfcrm function crm.  It provides
functionality for additional design choices for the CRM including global coherency
and stopping for excess toxicity and stopping when sufficient number of subjects are dosed at MTD.
</p>


<h3>Value</h3>

<p>An object of class &quot;mtd&quot; is returned as per package &quot;dfcrm&quot;,
additional information is provided if a stopping function is used.
</p>
<table>
<tr><td><code>prior</code></td>
<td>
<p>Initial guesses of toxicity rates.</p>
</td></tr>  <tr><td><code>target</code></td>
<td>
<p>The
target probability of toxicity at the MTD.</p>
</td></tr>  <tr><td><code>ptox</code></td>
<td>
<p>Updated
estimates of toxicity rates.</p>
</td></tr>  <tr><td><code>ptoxL</code></td>
<td>
<p>Lower confidence/probability
limits of toxicity rates.</p>
</td></tr>  <tr><td><code>ptoxU</code></td>
<td>
<p>Upper confidence/probability
limits of toxicity rates.</p>
</td></tr>  <tr><td><code>mtd</code></td>
<td>
<p>The updated estimate of the MTD.</p>
</td></tr>
<tr><td><code>prior.var</code></td>
<td>
<p>The variance of the normal prior.</p>
</td></tr>  <tr><td><code>post.var</code></td>
<td>
<p>The
posterior variance of the model parameter.</p>
</td></tr>  <tr><td><code>estimate</code></td>
<td>
<p>Estimate of
the model parameter.</p>
</td></tr>  <tr><td><code>method</code></td>
<td>
<p>The method of estimation.</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>The working model.</p>
</td></tr>  <tr><td><code>dosescaled</code></td>
<td>
<p>The scaled doses
obtained via backward substitution.</p>
</td></tr>  <tr><td><code>tox</code></td>
<td>
<p>Patients' toxicity
indications.</p>
</td></tr>  <tr><td><code>level</code></td>
<td>
<p>Dose levels assigned to patients.</p>
</td></tr>
<tr><td><code>stop</code></td>
<td>
<p>A logical variable detailing if the trial should be stopped;
TRUE to stop, FALSE otherwise</p>
</td></tr> <tr><td><code>stop_reason</code></td>
<td>
<p>A detailed reason for
why the trial should be stopped. Only provided if stop is TRUE</p>
</td></tr>
</table>


<h3>References</h3>

<p>O'Quigley, J. O., Pepe, M., and Fisher, L. (1990). Continual
reassessment method: A practical design for phase I clinical trials in
cancer. Biometrics 46:33-48.
</p>
<p>Cheung, Y. K. (2011). Dose Finding by the Continual Reassessment Method. New
York: Chapman &amp; Hall/CRC Press.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>prior  &lt;- c(0.1, 0.3, 0.5)
target &lt;- 0.2
tox    &lt;- c(0, 0, 1, 0, 1, 1)
level  &lt;- c(1, 1, 1, 2, 2, 2)
applied_crm(prior, target, tox, level, no_skip_esc = TRUE, no_skip_deesc = TRUE,
            global_coherent_esc = TRUE, stop_func = NULL)

</code></pre>

<hr>
<h2 id='applied_crm_sim'>Simulate CRM trials using specified design options</h2><span id='topic+applied_crm_sim'></span>

<h3>Description</h3>

<p>applied_crm_sim is used to simulate trials using the continual
reassessment method with specified design options to determine the
operating characteristics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>applied_crm_sim(true_tox, prior, target, max_sample_size, first_dose,
    num_sims, cohort_size = 1, dose_func = applied_crm, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="applied_crm_sim_+3A_true_tox">true_tox</code></td>
<td>
<p>A vector of 'true' underlying rates of toxicity for each of
the dose levels.</p>
</td></tr>
<tr><td><code id="applied_crm_sim_+3A_prior">prior</code></td>
<td>
<p>A vector of prior estimates of toxicity probabilties for the
dose levels.</p>
</td></tr>
<tr><td><code id="applied_crm_sim_+3A_target">target</code></td>
<td>
<p>The target DLT rate.</p>
</td></tr>
<tr><td><code id="applied_crm_sim_+3A_max_sample_size">max_sample_size</code></td>
<td>
<p>The maximum number of subjects to be recruited in any
simulation.</p>
</td></tr>
<tr><td><code id="applied_crm_sim_+3A_first_dose">first_dose</code></td>
<td>
<p>The first dose level to tested.</p>
</td></tr>
<tr><td><code id="applied_crm_sim_+3A_num_sims">num_sims</code></td>
<td>
<p>The total number of simulations to be run.</p>
</td></tr>
<tr><td><code id="applied_crm_sim_+3A_cohort_size">cohort_size</code></td>
<td>
<p>The size of the cohorts. Default is 1.</p>
</td></tr>
<tr><td><code id="applied_crm_sim_+3A_dose_func">dose_func</code></td>
<td>
<p>The function to be employed in executing the CRM. Default is
applied_crm.</p>
</td></tr>
<tr><td><code id="applied_crm_sim_+3A_...">...</code></td>
<td>
<p>Any other arguements detailed in dtpcrm::applied_crm.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing two further lists. The first of these lists contains
the operating charateristics of the design, the second contains the
underlying data for each of the simulation iterations.
</p>


<h3>References</h3>

<p>O'Quigley, J. O., Pepe, M., and Fisher, L. (1990). Continual
reassessment method: A practical design for phase I clinical trials in
cancer. Biometrics 46:33-48.
</p>
<p>Cheung, Y. K. (2011). Dose Finding by the Continual Reassessment Method. New
York: Chapman &amp; Hall/CRC Press.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># It may take quite long for large num_sims
prior  &lt;- c(0.1, 0.3, 0.5)
target &lt;- 0.2
true_tox &lt;- c(0.15, 0.25, 0.45)
first_dose &lt;- 1
num_sims &lt;- 5  # recommend doing 5000 simulations for the final design

applied_crm_sim(true_tox, prior, target, max_sample_size = 30, first_dose,
                num_sims, cohort_size = 1, dose_func = applied_crm)

</code></pre>

<hr>
<h2 id='applied_titecrm'>Execute the TITE-CRM</h2><span id='topic+applied_titecrm'></span>

<h3>Description</h3>

<p>applied_titecrm is used to execute the time-to-event continual
reassessment method with specified design options to determine the dose
for the next subject.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>applied_titecrm(prior, target, tox, level, followup, obswin,
    no_skip_esc = TRUE, no_skip_deesc = TRUE, global_coherent_esc = TRUE,
    stop_func = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="applied_titecrm_+3A_prior">prior</code></td>
<td>
<p>A vector of prior estimates of toxicity probabilties for the
dose levels.</p>
</td></tr>
<tr><td><code id="applied_titecrm_+3A_target">target</code></td>
<td>
<p>The target DLT rate.</p>
</td></tr>
<tr><td><code id="applied_titecrm_+3A_tox">tox</code></td>
<td>
<p>A vector of subject outcomes; 1 indicates toxicity, 0 otherwise.</p>
</td></tr>
<tr><td><code id="applied_titecrm_+3A_level">level</code></td>
<td>
<p>A vector of dose levels assigned to subjects. The length of
level must be equal to that of tox.</p>
</td></tr>
<tr><td><code id="applied_titecrm_+3A_followup">followup</code></td>
<td>
<p>A vector of follow up times of subjects. The length must be equal
to that of tox.</p>
</td></tr>
<tr><td><code id="applied_titecrm_+3A_obswin">obswin</code></td>
<td>
<p>The observation period with respect to which DLT is assessed.</p>
</td></tr>
<tr><td><code id="applied_titecrm_+3A_no_skip_esc">no_skip_esc</code></td>
<td>
<p>If FALSE, the method will not enforce no skipping of doses
in escalation. Default is TRUE.</p>
</td></tr>
<tr><td><code id="applied_titecrm_+3A_no_skip_deesc">no_skip_deesc</code></td>
<td>
<p>If FALSE, the method will not enforce no skipping of
doses in de-escalation. Default is TRUE.</p>
</td></tr>
<tr><td><code id="applied_titecrm_+3A_global_coherent_esc">global_coherent_esc</code></td>
<td>
<p>If FALSE, the method will not enforce global
coherent escalation, that is, escalation if the overall rate of toxicity
seen at the current dose level is above the target rate. Default is TRUE.</p>
</td></tr>
<tr><td><code id="applied_titecrm_+3A_stop_func">stop_func</code></td>
<td>
<p>An optional argument to provide a function which will
utilised alongside the TITE-CRM to determine if the trial should be stopped.</p>
</td></tr>
<tr><td><code id="applied_titecrm_+3A_...">...</code></td>
<td>
<p>Any other arguments detailed in dfcrm::titecrm.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The adaptive weighting scheme is given in Cheung and Chappell (2000)
given in the reference list.
</p>


<h3>Value</h3>

<p>An object of class &quot;mtd&quot; is returned as per package &quot;dfcrm&quot;,
additional information is provided if a stopping function is used.
</p>
<table>
<tr><td><code>prior</code></td>
<td>
<p>Initial guesses of toxicity rates.</p>
</td></tr>  <tr><td><code>target</code></td>
<td>
<p>The target
probability of toxicity at the MTD.</p>
</td></tr>  <tr><td><code>ptox</code></td>
<td>
<p>Updated estimates of
toxicity rates.</p>
</td></tr>  <tr><td><code>ptoxL</code></td>
<td>
<p>Lower confidence/probability limits of
toxicity rates.</p>
</td></tr>  <tr><td><code>ptoxU</code></td>
<td>
<p>Upper confidence/probability limits of
toxicity rates.</p>
</td></tr>  <tr><td><code>mtd</code></td>
<td>
<p>The updated estimate of the MTD.</p>
</td></tr>
<tr><td><code>prior.var</code></td>
<td>
<p>The variance of the normal prior.</p>
</td></tr>  <tr><td><code>post.var</code></td>
<td>
<p>The
posterior variance of the model parameter.</p>
</td></tr>  <tr><td><code>estimate</code></td>
<td>
<p>Estimate of the
model parameter.</p>
</td></tr>  <tr><td><code>method</code></td>
<td>
<p>The method of estimation.</p>
</td></tr>  <tr><td><code>model</code></td>
<td>
<p>The
working model.</p>
</td></tr>  <tr><td><code>dosescaled</code></td>
<td>
<p>The scaled doses obtained via backward
substitution.</p>
</td></tr>  <tr><td><code>tox</code></td>
<td>
<p>subjects' toxicity indications.</p>
</td></tr>
<tr><td><code>level</code></td>
<td>
<p>Dose levels assigned to subjects.</p>
</td></tr>  <tr><td><code>followup</code></td>
<td>
<p>Follow-up
times of subjects.</p>
</td></tr>  <tr><td><code>obswin</code></td>
<td>
<p>Observation window with respect to which
DLT is assessed.</p>
</td></tr>  <tr><td><code>weights</code></td>
<td>
<p>Weights assigned to subjects.</p>
</td></tr>
<tr><td><code>entry</code></td>
<td>
<p>Entry times of subjects.</p>
</td></tr>  <tr><td><code>exit</code></td>
<td>
<p>Exit times of subjects.</p>
</td></tr>
<tr><td><code>scheme</code></td>
<td>
<p>Weighting scheme.</p>
</td></tr>  <tr><td><code>stop</code></td>
<td>
<p>A logical variable detailing if
the trial should be stopped; TRUE to stop, FALSE otherwise</p>
</td></tr>
<tr><td><code>stop_reason</code></td>
<td>
<p>A detailed reason for why the trial should be
stopped. Only provided if stop is TRUE</p>
</td></tr>
</table>


<h3>References</h3>

<p>O'Quigley, J. O., Pepe, M., and Fisher, L. (1990). Continual
reassessment method: A practical design for phase I clinical trials in
cancer. Biometrics 46:33-48.
</p>
<p>Cheung, Y. K. (2011). Dose Finding by the Continual Reassessment Method. New
York: Chapman &amp; Hall/CRC Press.
</p>
<p>Cheung, Y. K. and Chappell, R. (2000). Sequential designs for phase I
clinical trials with late-onset toxicities. Biometrics 56:1177-1182.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>prior    &lt;- c(0.1, 0.3, 0.5)
target   &lt;- 0.2
tox      &lt;- c(0, 0, 1, 0, 1, 1)
level    &lt;- c(1, 1, 1, 2, 2, 2)
followup &lt;- c(96, 82, 77, 60, 51, 44)
obswin   &lt;- 80

applied_titecrm(prior = prior, target = target, tox = tox,level = level,
                followup = followup, obswin = obswin)

</code></pre>

<hr>
<h2 id='applied_titecrm_sim'>Simulate TITE-CRM trials using specified design options</h2><span id='topic+applied_titecrm_sim'></span>

<h3>Description</h3>

<p>applied_titecrm_sim is used to simulate trials using the
time-to-event continual reassessment method with specified design options
to determine the operating characteristics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>applied_titecrm_sim(true_tox, prior, target, max_sample_size,
    first_dose, num_sims, cohort_size = 1, obswin, minfu, recrate, dose_func
    = applied_titecrm, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="applied_titecrm_sim_+3A_true_tox">true_tox</code></td>
<td>
<p>A vector of 'true' underlying rates of toxicity for each of
the dose levels.</p>
</td></tr>
<tr><td><code id="applied_titecrm_sim_+3A_prior">prior</code></td>
<td>
<p>A vector of prior estimates of toxicity probabilties for the
dose levels.</p>
</td></tr>
<tr><td><code id="applied_titecrm_sim_+3A_target">target</code></td>
<td>
<p>The target DLT rate.</p>
</td></tr>
<tr><td><code id="applied_titecrm_sim_+3A_max_sample_size">max_sample_size</code></td>
<td>
<p>The maximum number of subjects to be recruited in any
simulation.</p>
</td></tr>
<tr><td><code id="applied_titecrm_sim_+3A_first_dose">first_dose</code></td>
<td>
<p>The first dose level to tested.</p>
</td></tr>
<tr><td><code id="applied_titecrm_sim_+3A_num_sims">num_sims</code></td>
<td>
<p>The total number of simulations to be run.</p>
</td></tr>
<tr><td><code id="applied_titecrm_sim_+3A_cohort_size">cohort_size</code></td>
<td>
<p>The size of the subject cohorts. Default is 1.</p>
</td></tr>
<tr><td><code id="applied_titecrm_sim_+3A_obswin">obswin</code></td>
<td>
<p>The observation period for total subject follow up.</p>
</td></tr>
<tr><td><code id="applied_titecrm_sim_+3A_minfu">minfu</code></td>
<td>
<p>The minimum amount of follow-up required for each subjects.</p>
</td></tr>
<tr><td><code id="applied_titecrm_sim_+3A_recrate">recrate</code></td>
<td>
<p>The number of subjects recruited per obswin.</p>
</td></tr>
<tr><td><code id="applied_titecrm_sim_+3A_dose_func">dose_func</code></td>
<td>
<p>The function to be employed in executing the CRM. Default is
applied_titecrm.</p>
</td></tr>
<tr><td><code id="applied_titecrm_sim_+3A_...">...</code></td>
<td>
<p>Any other arguements detailed in dtp::applied_titecrm.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containg two further lists. The first of these lists contains
the operating charateristics of the design, the second contains the
underlying data for each of the simulation iterations.
</p>


<h3>References</h3>

<p>O'Quigley, J. O., Pepe, M., and Fisher, L. (1990). Continual
reassessment method: A practical design for phase I clinical trials in
cancer. Biometrics 46:33-48.
</p>
<p>Cheung, Y. K. (2011). Dose Finding by the Continual Reassessment Method. New
York: Chapman &amp; Hall/CRC Press.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># It may take quite long for large num_sims
prior  &lt;- c(0.1, 0.3, 0.5)
target &lt;- 0.2
true_tox &lt;- c(0.05, 0.2, 0.35)
first_dose &lt;- 1
num_sims &lt;- 5  # recommend doing 5000 simulations for the final design
obswin = 80

applied_titecrm_sim(true_tox = true_tox, prior = prior, target = target,
                              max_sample_size = 21, first_dose = first_dose,
                              num_sims = num_sims, cohort_size = 3,
                              obswin = obswin, minfu = 20, recrate = 3,
                              dose_func = applied_titecrm)
                              
</code></pre>

<hr>
<h2 id='applied_titecrmts_sim'>Simulate TITE-CRM trials using specified design options</h2><span id='topic+applied_titecrmts_sim'></span>

<h3>Description</h3>

<p>applied_titecrmts_sim is used to simulate trials using the
two-stage time-to-event continual reassessment method with specified
design options to determine the operating characteristics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>applied_titecrmts_sim(true_tox, prior, target, max_sample_size,
    num_sims, cohort_size = 1, obswin, minfu, recrate, initdes,
    dose_func = applied_titecrm, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="applied_titecrmts_sim_+3A_true_tox">true_tox</code></td>
<td>
<p>A vector of 'true' underlying rates of toxicity for each of
the dose levels.</p>
</td></tr>
<tr><td><code id="applied_titecrmts_sim_+3A_prior">prior</code></td>
<td>
<p>A vector of prior estimates of toxicity probabilties for the
dose levels.</p>
</td></tr>
<tr><td><code id="applied_titecrmts_sim_+3A_target">target</code></td>
<td>
<p>The target DLT rate.</p>
</td></tr>
<tr><td><code id="applied_titecrmts_sim_+3A_max_sample_size">max_sample_size</code></td>
<td>
<p>The maximum number of subjects to be recruited in any
simulation.</p>
</td></tr>
<tr><td><code id="applied_titecrmts_sim_+3A_num_sims">num_sims</code></td>
<td>
<p>The total number of simulations to be run.</p>
</td></tr>
<tr><td><code id="applied_titecrmts_sim_+3A_cohort_size">cohort_size</code></td>
<td>
<p>The size of the cohorts. Default is 1.</p>
</td></tr>
<tr><td><code id="applied_titecrmts_sim_+3A_obswin">obswin</code></td>
<td>
<p>The observation period for total subject follow up.</p>
</td></tr>
<tr><td><code id="applied_titecrmts_sim_+3A_minfu">minfu</code></td>
<td>
<p>The minimum amount of follow-up required for each subject.</p>
</td></tr>
<tr><td><code id="applied_titecrmts_sim_+3A_recrate">recrate</code></td>
<td>
<p>The number of subjects recruited per obswin.</p>
</td></tr>
<tr><td><code id="applied_titecrmts_sim_+3A_initdes">initdes</code></td>
<td>
<p>A vector specifying the doses to be assisned to subjects as
per the initial design.</p>
</td></tr>
<tr><td><code id="applied_titecrmts_sim_+3A_dose_func">dose_func</code></td>
<td>
<p>The function to be employed in executing the CRM. Default is
applied_titecrm.</p>
</td></tr>
<tr><td><code id="applied_titecrmts_sim_+3A_...">...</code></td>
<td>
<p>Any other arguements detailed in dtp::applied_titecrm.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containg two further lists. The first of these lists contains
the operating charateristics of the design, the second contains the
underlying data for each of the simulation iterations.
</p>


<h3>References</h3>

<p>O'Quigley, J. O., Pepe, M., and Fisher, L. (1990). Continual
reassessment method: A practical design for phase I clinical trials in
cancer. Biometrics 46:33-48.
</p>
<p>Cheung, Y. K. (2011). Dose Finding by the Continual Reassessment Method. New
York: Chapman &amp; Hall/CRC Press.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># It may take quite long for large num_sims
prior  &lt;- c(0.1, 0.3, 0.5)
target &lt;- 0.2
true_tox &lt;- c(0.05, 0.2, 0.35)
first_dose &lt;- 1
num_sims &lt;- 5  # recommend doing 5000 simulations for the final design
obswin = 80

applied_titecrmts_sim(true_tox = true_tox, prior = prior, target = target,
                      max_sample_size = 21, num_sims = num_sims,
                      cohort_size = 3, obswin = obswin, minfu = 20,
                      recrate = 3, initdes = c(rep(1, 3), rep(2, 3), rep(3, 15)),
                      dose_func = applied_titecrm)
                      
</code></pre>

<hr>
<h2 id='calculate_dtps'>Produce the Dose Transition Pathways</h2><span id='topic+calculate_dtps'></span>

<h3>Description</h3>

<p>calculate_dtps is used to produce the dose transition pathways
for the continual reassessment method with specified design
options. These pathways present the possible model recommendations based
on all permumations of trial outcomes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculate_dtps(next_dose, cohort_sizes, prev_tox = c(), prev_dose =
    c(), dose_func = applied_crm, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calculate_dtps_+3A_next_dose">next_dose</code></td>
<td>
<p>An integer value representing the dose to be assigned to the
first cohort of subjects in the pathways.</p>
</td></tr>
<tr><td><code id="calculate_dtps_+3A_cohort_sizes">cohort_sizes</code></td>
<td>
<p>A vector of cohort sizes representing the size of the
cohorts to be treated with the recommended dose at each decision point.</p>
</td></tr>
<tr><td><code id="calculate_dtps_+3A_prev_tox">prev_tox</code></td>
<td>
<p>A vector of previous subject outcomes; 1 indicates toxicity,
0 otherwise.</p>
</td></tr>
<tr><td><code id="calculate_dtps_+3A_prev_dose">prev_dose</code></td>
<td>
<p>A vector of previous subject doses; The length of prev_dose
must be equal to that of prev_tox.</p>
</td></tr>
<tr><td><code id="calculate_dtps_+3A_dose_func">dose_func</code></td>
<td>
<p>A function such as applied_crm which produces an object of
class 'mtd'. To be used for calculation of the next recommended dose for
each pathway permutation.</p>
</td></tr>
<tr><td><code id="calculate_dtps_+3A_...">...</code></td>
<td>
<p>Any other arguments to be passed to dose_func; for specific
arguments related to applied_crm see.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Produces a dataframe containing all possible permutations of outcomes
for each cohort based on cohort_sizes and the recommended
doses for such permutations.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>prior  &lt;- c(0.1, 0.2, 0.5)
target &lt;- 0.15
prev_tox &lt;- c(0, 0, 0)
prev_dose &lt;- c(2, 2, 2)
cohort_sizes &lt;- c(2, 3)

next_dose = applied_crm(prior = prior, target = target,
                        tox = prev_tox, level = prev_dose)$mtd

dose_func &lt;- applied_crm

DTP = calculate_dtps(next_dose, cohort_sizes, prev_tox = prev_tox,
                      prev_dose = prev_dose, dose_func = applied_crm,
                      prior = prior, target = target)

</code></pre>

<hr>
<h2 id='dtpflow'>Produce DTP flow diagram</h2><span id='topic+dtpflow'></span>

<h3>Description</h3>

<p>dtpflow will produce a flow diagram of the possible paths for
the next three cohorts of subjects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dtpflow(dtptable, cohort.labels = c('C1', 'C2', 'C3'))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dtpflow_+3A_dtptable">dtptable</code></td>
<td>
<p>a dataframe produced by calculate_dtps where cohort_sizes was of length 3.</p>
</td></tr>
<tr><td><code id="dtpflow_+3A_cohort.labels">cohort.labels</code></td>
<td>
<p>A vector of length 3, containing character strings for
the cohort labels.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function will produce a visual flow diagram for the first three
cohorts of the provided dataframe.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
prior  &lt;- c(0.1, 0.2, 0.5)
target &lt;- 0.15
prev_tox &lt;- c(0, 0, 0)
prev_dose &lt;- c(2, 2, 2)
cohort_sizes &lt;- c(2, 3, 3)

next_dose = applied_crm(prior = prior, target = target,
                        tox = prev_tox, level = prev_dose)$mtd

dose_func &lt;- applied_crm

DTP = calculate_dtps(next_dose, cohort_sizes, prev_tox = prev_tox,
                      prev_dose = prev_dose, dose_func = applied_crm,
                      prior = prior, target = target)

dtpflow(dtptable = DTP, cohort.labels = c('C1', 'C2', 'C3'))

</code></pre>

<hr>
<h2 id='plot_crm'>Plot of posterior estimates from the CRM</h2><span id='topic+plot_crm'></span>

<h3>Description</h3>

<p>Provides functionality for plotting the posterior estimates of
probabilities of toxicity at each dose level for both the most recent
update and for past cohort updates if specified.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_crm(crm, dose_labels, cohort_sizes = NULL, file = NULL,
                height = 600, width = 750, dose_func = NULL, ...,
                ylim = c(0, 1), lwd = 1, cex.axis = 1, cex.lab = 1,
                cex = 1, cohort.last = F)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_crm_+3A_crm">crm</code></td>
<td>
<p>An object of class 'mtd' produced by applied_crm to be plotted.</p>
</td></tr>
<tr><td><code id="plot_crm_+3A_dose_labels">dose_labels</code></td>
<td>
<p>A vector of character strings detailing the labels to be
used for each dose level in the plot.</p>
</td></tr>
<tr><td><code id="plot_crm_+3A_cohort_sizes">cohort_sizes</code></td>
<td>
<p>An optional vector of cohort sizes; if provided the
previous estimates for each cohort will be plotted in addition.</p>
</td></tr>
<tr><td><code id="plot_crm_+3A_file">file</code></td>
<td>
<p>An optional string for the file name; if provided the plot will
be saved as a .PNG to the current working directory under the provided
file name.</p>
</td></tr>
<tr><td><code id="plot_crm_+3A_height">height</code></td>
<td>
<p>A numeric value specifying the vertical pixel count of the
plot. Default is 600.</p>
</td></tr>
<tr><td><code id="plot_crm_+3A_width">width</code></td>
<td>
<p>A numeric value specifiying the horizontal pixel count of the
plot. Default is 750.</p>
</td></tr>
<tr><td><code id="plot_crm_+3A_dose_func">dose_func</code></td>
<td>
<p>Must be provided if cohort_sizes is provided. The function
to be used to when implementing the CRM for previous cohorts.</p>
</td></tr>
<tr><td><code id="plot_crm_+3A_...">...</code></td>
<td>
<p>Arguments to be provided to dose_func detailing CRM specification.
See applied_crm.</p>
</td></tr>
<tr><td><code id="plot_crm_+3A_ylim">ylim</code></td>
<td>
<p>The y-axis range. Default is c(0, 1)</p>
</td></tr>
<tr><td><code id="plot_crm_+3A_lwd">lwd</code></td>
<td>
<p>line width relative to the default (default=1). 2 is twice as wide. Default is 1.</p>
</td></tr>
<tr><td><code id="plot_crm_+3A_cex.axis">cex.axis</code></td>
<td>
<p>The magnification to be used for axis annotation relative to the current setting of cex. Default is 1.</p>
</td></tr>
<tr><td><code id="plot_crm_+3A_cex.lab">cex.lab</code></td>
<td>
<p>The magnification to be used for x and y labels relative to the current setting of cex. Default is 1.</p>
</td></tr>
<tr><td><code id="plot_crm_+3A_cex">cex</code></td>
<td>
<p>A numerical value giving the amount by which plotting text and symbols should be magnified relative to the default. Default is 1.</p>
</td></tr>
<tr><td><code id="plot_crm_+3A_cohort.last">cohort.last</code></td>
<td>
<p>If TRUE, the last cohort will have lwd = 6 for emphasis. Default is FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Produces a plot of current dose-toxicity estimates including the
priors and outputs a .png of plot to current directory if 'file' is
provided. Potential for history of estimates by cohort if cohort.sizes is
provided; dose_func is required to do this.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>prior  &lt;- c(0.1, 0.3, 0.5)
target &lt;- 0.2
tox    &lt;- c(0, 0, 1, 0, 1, 1)
level  &lt;- c(1, 1, 1, 2, 2, 2)

crm &lt;- applied_crm(prior, target, tox, level, no_skip_esc = TRUE, no_skip_deesc = TRUE,
                   global_coherent_esc = TRUE, stop_func = NULL)

plot_crm(crm, dose_labels = c("1", "2", "3"))

</code></pre>

<hr>
<h2 id='stop_for_consensus_reached'>Stopping for consensus</h2><span id='topic+stop_for_consensus_reached'></span>

<h3>Description</h3>

<p>This is a function for use with applied_crm for the stop_func
argument. The rule will suggest stopping in the scenario that a
particular number of patients has already been treated at the current
recommended MTD.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stop_for_consensus_reached(x, req_at_mtd)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stop_for_consensus_reached_+3A_x">x</code></td>
<td>
<p>An object of class 'mtd'.</p>
</td></tr>
<tr><td><code id="stop_for_consensus_reached_+3A_req_at_mtd">req_at_mtd</code></td>
<td>
<p>An integer; the number of patients required at current
estimate of MTD to suggest stopping for consensus.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is an example of a possible stopping function to be
used with applied_crm, it will modifiy the 'mtd' class object produced by
applied_crm to include a logical value under the name 'stop' indicting
whether or not the trial should stop. The package dtpcrm contains a few
of these functions for possible use with applied_crm.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>prior  &lt;- c(0.1, 0.3, 0.5)
target &lt;- 0.2
tox    &lt;- c(0, 0, 1, 0, 1, 1)
level  &lt;- c(1, 1, 1, 2, 2, 2)

stop_rule &lt;- function(x){
  x &lt;- stop_for_consensus_reached(x, req_at_mtd = 6)
}

crm &lt;- applied_crm(prior, target, tox, level, no_skip_esc = TRUE, no_skip_deesc = TRUE,
                   global_coherent_esc = TRUE, stop_func = stop_rule)

</code></pre>

<hr>
<h2 id='stop_for_excess_toxicity_empiric'>Stopping for excess toxicity - Empiric method</h2><span id='topic+stop_for_excess_toxicity_empiric'></span>

<h3>Description</h3>

<p>This is a function for use with applied_crm for the stop_func
argument. The rule will suggest stopping in the scenario that the
probability of toxicity being greater than a specifed value at a defined
dose is greater than some further specified certainty value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stop_for_excess_toxicity_empiric(x, tox_lim, prob_cert, dose = 1,
    nsamps = 10^6, suppress_dose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stop_for_excess_toxicity_empiric_+3A_x">x</code></td>
<td>
<p>An object of class 'mtd'.</p>
</td></tr>
<tr><td><code id="stop_for_excess_toxicity_empiric_+3A_tox_lim">tox_lim</code></td>
<td>
<p>A numeric; specifying the value for which the estimated
toxicity at the selcted dose is not to exceed.</p>
</td></tr>
<tr><td><code id="stop_for_excess_toxicity_empiric_+3A_prob_cert">prob_cert</code></td>
<td>
<p>A numeric; specifying the probability value to be used when
assessing the certainty required that toxicty at the specificed dose
exceeds tox_lim.</p>
</td></tr>
<tr><td><code id="stop_for_excess_toxicity_empiric_+3A_dose">dose</code></td>
<td>
<p>An integer; the dose to be assessed.</p>
</td></tr>
<tr><td><code id="stop_for_excess_toxicity_empiric_+3A_nsamps">nsamps</code></td>
<td>
<p>number of samples used for beta in the underlying normal
sampling of beta.</p>
</td></tr>
<tr><td><code id="stop_for_excess_toxicity_empiric_+3A_suppress_dose">suppress_dose</code></td>
<td>
<p>A logical value indicating if the MTD should be set to
NA if trial should stop.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is an example of a possible stopping function to be
used with applied_crm, it will modifiy the 'mtd' class object produced by
applied_crm to include a logical value under the name 'stop' indicating
whether or not the trial should stop. The package dtpcrm contains a few
of these functions for possible use with applied_crm.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>prior  &lt;- c(0.1, 0.3, 0.5)
target &lt;- 0.2
tox    &lt;- c(0, 0, 1, 0, 1, 1)
level  &lt;- c(1, 1, 1, 2, 2, 2)

stop_rule &lt;- function(x){
  x &lt;- stop_for_excess_toxicity_empiric(x, tox_lim = 0.25, prob_cert = 0.85)
}

crm &lt;- applied_crm(prior, target, tox, level, no_skip_esc = TRUE, no_skip_deesc = TRUE,
                   global_coherent_esc = TRUE, stop_func = stop_rule)

</code></pre>

<hr>
<h2 id='stop_for_excess_toxicity_logistic'>Stopping for excess toxicity - Logistic method</h2><span id='topic+stop_for_excess_toxicity_logistic'></span>

<h3>Description</h3>

<p>This is a function for use with applied_crm for the stop_func
argument. The rule will suggest stopping in the scenario that the
probability of toxicity being greater than a specifed value at a defined
dose is greater than some further specified certainty value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stop_for_excess_toxicity_logistic(x, tox_lim, prob_cert, dose = 1,
    nsamps = 10^6, suppress_dose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stop_for_excess_toxicity_logistic_+3A_x">x</code></td>
<td>
<p>An object of class 'mtd'.</p>
</td></tr>
<tr><td><code id="stop_for_excess_toxicity_logistic_+3A_tox_lim">tox_lim</code></td>
<td>
<p>A numeric; specifying the value for which the estimated
toxicity at the selcted dose is not to exceed.</p>
</td></tr>
<tr><td><code id="stop_for_excess_toxicity_logistic_+3A_prob_cert">prob_cert</code></td>
<td>
<p>A numeric; specifying the probability value to be used when
assessing the certainty required that toxicty at the specificed dose
exceeds tox_lim.</p>
</td></tr>
<tr><td><code id="stop_for_excess_toxicity_logistic_+3A_dose">dose</code></td>
<td>
<p>An integer; the dose to be assessed.</p>
</td></tr>
<tr><td><code id="stop_for_excess_toxicity_logistic_+3A_nsamps">nsamps</code></td>
<td>
<p>Number of samples used for beta in the underlying normal
sampling of beta.</p>
</td></tr>
<tr><td><code id="stop_for_excess_toxicity_logistic_+3A_suppress_dose">suppress_dose</code></td>
<td>
<p>A logical value indicating if the MTD should be set to
NA if trial should stop.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is an example of a possible stopping function to be
used with applied_crm, it will modifiy the 'mtd' class object produced by
applied_crm to include a logical value under the name 'stop' indicating
whether or not the trial should stop. The package dtpcrm contains a few
of these functions for possible use with applied_crm.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>prior  &lt;- c(0.1, 0.3, 0.5)
target &lt;- 0.2
tox    &lt;- c(0, 0, 1, 0, 1, 1)
level  &lt;- c(1, 1, 1, 2, 2, 2)

stop_rule &lt;- function(x){
  x &lt;- stop_for_excess_toxicity_logistic(x, tox_lim = 0.25, prob_cert = 0.85)
}

crm &lt;- applied_crm(prior, target, tox, level, no_skip_esc = TRUE, no_skip_deesc = TRUE,
                   global_coherent_esc = TRUE, stop_func = stop_rule)

</code></pre>

<hr>
<h2 id='stop_for_sample_size'>Stopping for sample size reached</h2><span id='topic+stop_for_sample_size'></span>

<h3>Description</h3>

<p>This is a function for use with applied_crm for the stop_func
argument. The rule will suggest stopping in the scenario that a maximum
number of subjects has been recruited.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stop_for_sample_size(x, max_sample_size)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stop_for_sample_size_+3A_x">x</code></td>
<td>
<p>An object of class 'mtd'.</p>
</td></tr>
<tr><td><code id="stop_for_sample_size_+3A_max_sample_size">max_sample_size</code></td>
<td>
<p>An integer; specifying the maxmium number of subjects
to be recruited.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is an example of a possible stopping function to be
used with applied_crm, it will modifiy the 'mtd' class object produced by
applied_crm to include a logical value under the name 'stop' indicting
whether or not the trial should stop. The package dtpcrm contains a few
of these functions for possible use with applied_crm.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>prior  &lt;- c(0.1, 0.3, 0.5)
target &lt;- 0.2
tox    &lt;- c(0, 0, 1, 0, 1, 1)
level  &lt;- c(1, 1, 1, 2, 2, 2)

stop_rule &lt;- function(x){
  x &lt;- stop_for_sample_size(x, max_sample_size = 20)
}

crm &lt;- applied_crm(prior, target, tox, level, no_skip_esc = TRUE, no_skip_deesc = TRUE,
                   global_coherent_esc = TRUE, stop_func = stop_rule)

</code></pre>

<hr>
<h2 id='summary_crm'>Provide a summary of applied_crm output</h2><span id='topic+summary_crm'></span>

<h3>Description</h3>

<p>summary_crm is used to return a dataframe of the summary of the
output from applied_crm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>summary_crm(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary_crm_+3A_x">x</code></td>
<td>
<p>An object assigned to be the output from applied_crm.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function takes an object of class &quot;mtd&quot; and produces a
dataframe containing a summary of information within the
object. Specifically it shows the dose levels, prior probabilities, number
of evaluable patients, number of DLTs and the posterior probability
estimates along with confidence/probability intervals if estimated in the
underlying object.
</p>


<h3>Value</h3>

<p>Dataframe of the summary of the output from applied_crm.
</p>


<h3>References</h3>

<p>O'Quigley, J. O., Pepe, M., and Fisher, L. (1990). Continual
reassessment method: A practical design for phase I clinical trials in
cancer. Biometrics 46:33-48.
</p>
<p>Cheung, Y. K. (2011). Dose Finding by the Continual Reassessment Method. New
York: Chapman &amp; Hall/CRC Press.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>prior  &lt;- c(0.1, 0.3, 0.5)
target &lt;- 0.2
tox    &lt;- c(0, 0, 1, 0, 1, 1)
level  &lt;- c(1, 1, 1, 2, 2, 2)

crm_obj &lt;- applied_crm(prior, target, tox, level, no_skip_esc = TRUE, no_skip_deesc = TRUE,
                       global_coherent_esc = TRUE, stop_func = NULL)

summary_crm(crm_obj)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
