<!DOCTYPE html><html><head><title>Help for package s2net</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {s2net}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#auto_mpg'>

<p>Auto MPG Data Set</p></a></li>
<li><a href='#predict_Rcpp_s2net'>

<p>Predict method for <code>s2net</code> C++ class.</p></a></li>
<li><a href='#predict.s2netR'>

<p>S3 Methods for <code>s2netR</code> objects.</p></a></li>
<li><a href='#print.s2Data'>

<p>Print methods for S3 objects</p></a></li>
<li><a href='#Rcpp_s2net-class'><p>Class <code>s2net</code></p></a></li>
<li><a href='#s2Data'>

<p>Data wrapper for <code>s2net</code>.</p></a></li>
<li><a href='#s2Fista'>

<p>Hyper-parameter wrapper for FISTA.</p></a></li>
<li><a href='#s2net-package'><p>The Generalized Semi-Supervised Elastic-Net</p></a></li>
<li><a href='#s2netR'>

<p>Trains a generalized extended linear joint trained model using semi-supervised data.</p></a></li>
<li><a href='#s2Params'>

<p>Hyper-parameter wrapper for <code>s2net</code></p></a></li>
<li><a href='#simulate_extra'>

<p>Simulate extrapolated data</p></a></li>
<li><a href='#simulate_groups'>

<p>Simulate data (two groups design)</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>The Generalized Semi-Supervised Elastic-Net</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.7</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-03-04</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements the generalized semi-supervised elastic-net. This method extends the supervised elastic-net problem, and thus it is a practical solution to the problem of feature selection in semi-supervised contexts. Its mathematical formulation is presented from a general perspective, covering a wide range of models.  We focus on linear and logistic responses, but the implementation could be easily extended to other losses in generalized linear models. We develop a flexible and fast implementation, written in 'C++' using 'RcppArmadillo' and integrated into R via 'Rcpp' modules. See Culp, M. 2013 &lt;<a href="https://doi.org/10.1080%2F10618600.2012.657139">doi:10.1080/10618600.2012.657139</a>&gt; for references on the Joint Trained Elastic-Net.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp, methods, MASS</td>
</tr>
<tr>
<td>Depends:</td>
<td>stats</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, glmnet, Metrics, testthat</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/jlaria/s2net">https://github.com/jlaria/s2net</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/jlaria/s2net/issues">https://github.com/jlaria/s2net/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.0</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-03-31 08:37:38 UTC; root</td>
</tr>
<tr>
<td>Author:</td>
<td>Juan C. Laria <a href="https://orcid.org/0000-0001-7734-9647"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Line H. Clemmensen [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Juan C. Laria &lt;juank.laria@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-03-31 10:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='auto_mpg'>

Auto MPG Data Set
</h2><span id='topic+auto_mpg'></span>

<h3>Description</h3>


<p>This dataset was taken from the UCI Machine Learning Repository <a href="https://archive.ics.uci.edu/ml/datasets/Auto+MPG">https://archive.ics.uci.edu/ml/datasets/Auto+MPG</a>, and processed for the semi-supervised setting (Ryan and Culp, 2015).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("auto_mpg")</code></pre>


<h3>Format</h3>

<p>There are two lists that contain partitions from a data frame with 398 observations on the following 9 variables.
</p>

<dl>
<dt><code>mpg</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>cylinders</code></dt><dd><p>an ordered factor with levels <code>3</code> &lt; <code>4</code> &lt; <code>5</code> &lt; <code>6</code> &lt; <code>8</code></p>
</dd>
<dt><code>displacement</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>horsepower</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>weight</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>acceleration</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>year</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>origin</code></dt><dd><p>a factor</p>
</dd>
</dl>



<h3>Details</h3>


<p>This dataset is a slightly modified version of the dataset provided in the StatLib library. In line with the use by Ross Quinlan (1993) in predicting the attribute &quot;mpg&quot;, 8 of the original instances were removed because they had unknown values for the &quot;mpg&quot; attribute. &quot;The data concerns city-cycle fuel consumption in miles per gallon, to be predicted in terms of 3 multivalued discrete and 5 continuous attributes.&quot; (Quinlan, 1993)
</p>


<h3>Source</h3>


<p>Quinlan,R. (1993). Combining Instance-Based and Model-Based Learning. In Proceedings on the Tenth International Conference of Machine Learning, 236-243, University of Massachusetts, Amherst. Morgan Kaufmann.
</p>
<p>Dua, D. and Graff, C. (2019). UCI Machine Learning Repository [<a href="http://archive.ics.uci.edu/ml/">http://archive.ics.uci.edu/ml/</a>]. Irvine, CA: University of California, School of Information and Computer Science.
</p>


<h3>References</h3>


<p>Ryan, K. J., &amp; Culp, M. V. (2015). On semi-supervised linear regression in covariate shift problems. <em>The Journal of Machine Learning Research, 16</em>(1), 3183-3217.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(auto_mpg)
head(auto_mpg$P1$xL)
</code></pre>

<hr>
<h2 id='predict_Rcpp_s2net'>

Predict method for <code>s2net</code> C++ class.
</h2><span id='topic+predict_Rcpp_s2net'></span>

<h3>Description</h3>


<p>This function provides an interface in <span class="rlang"><b>R</b></span> for the method <code>predict</code> in C++ class <code>s2net</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
predict_Rcpp_s2net(object, newX, type = "default")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict_Rcpp_s2net_+3A_object">object</code></td>
<td>


<p>An object of class <code><a href="#topic+Rcpp_s2net">Rcpp_s2net</a></code>.
</p>
</td></tr>
<tr><td><code id="predict_Rcpp_s2net_+3A_newx">newX</code></td>
<td>


<p>Data to make predictions. Could be a <code><a href="#topic+s2Data">s2Data</a></code> object (field <code>xL</code> is used) or a <code>matrix</code> (in the same space as the original data where the model was fitted).  
</p>
</td></tr>
<tr><td><code id="predict_Rcpp_s2net_+3A_type">type</code></td>
<td>


<p>Type of predictions. One of <code>"default"</code>: let the method figure it out; <code>"response"</code>: the linear predictor; <code>"probs"</code>: fitted probabilities; <code>class</code>: fitted class.
</p>
</td></tr>
</table>


<h3>Details</h3>


<p>This method is included as a high-level wrapper of <code>object$predict()</code>.
</p>


<h3>Value</h3>






<p>Returns a column <code>matrix</code> with the same number of rows/observations as <code>newX</code>.
</p>


<h3>Author(s)</h3>


<p>Juan C. Laria
</p>


<h3>See Also</h3>


<p><code><a href="#topic+Rcpp_s2net">Rcpp_s2net</a></code>
</p>

<hr>
<h2 id='predict.s2netR'>

S3 Methods for <code><a href="#topic+s2netR">s2netR</a></code> objects.
</h2><span id='topic+predict.s2netR'></span>

<h3>Description</h3>


<p>Generic predict method. Wrapper for the C++ class method <code>s2net$predict</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 's2netR'
predict(object, newX, type = "default", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.s2netR_+3A_object">object</code></td>
<td>


<p>A <code><a href="#topic+s2netR">s2netR</a></code> object
</p>
</td></tr>
<tr><td><code id="predict.s2netR_+3A_newx">newX</code></td>
<td>


<p>A matrix with the data to make predictions. It should be in the same scale as the original data. See <code><a href="#topic+s2Data">s2Data</a></code> to see how to format the data. 
</p>
</td></tr>
<tr><td><code id="predict.s2netR_+3A_type">type</code></td>
<td>


<p>Type of predictions. One of <code>"default"</code> (figure it out from the train data), <code>"response", "probs", "class"</code>.
</p>
</td></tr>
<tr><td><code id="predict.s2netR_+3A_...">...</code></td>
<td>
<p> other parameters passed to predict

</p>
</td></tr>
</table>


<h3>Value</h3>






<p>A column matrix with predictions. 
</p>


<h3>See Also</h3>


<p><code><a href="#topic+s2netR">s2netR</a></code>, <code><a href="#topic+s2net">s2net</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("auto_mpg")
train = s2Data(xL = auto_mpg$P1$xL, yL = auto_mpg$P1$yL,  xU = auto_mpg$P1$xU)

model = s2netR(train, 
                s2Params(lambda1 = 0.1, 
                           lambda2 = 0,
                           gamma1 = 0.1,
                           gamma2 = 100,
                           gamma3 = 0.1),
                loss = "linear",
                frame = "ExtJT",
                proj = "auto",
                fista = s2Fista(5000, 1e-7, 1, 0.8))

valid = s2Data(auto_mpg$P1$xU, auto_mpg$P1$yU, preprocess = train)
ypred = predict(model, valid$xL)
## Not run: 
if(require(ggplot2)){
  ggplot() + 
    aes(x = ypred, y = valid$yL) + geom_point() + 
    geom_abline(intercept = 0, slope = 1, linetype = 2)
}

## End(Not run)
</code></pre>

<hr>
<h2 id='print.s2Data'>

Print methods for S3 objects
</h2><span id='topic+print.s2Data'></span><span id='topic+print.s2Fista'></span>

<h3>Description</h3>


<p>Very simple print methods to show basic information about these simple S3 objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 's2Data'
print(x, ...)
## S3 method for class 's2Fista'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.s2Data_+3A_x">x</code></td>
<td>


<p>S3 object of class <code>s2Data</code> or <code>s2Fista</code>
</p>
</td></tr>
<tr><td><code id="print.s2Data_+3A_...">...</code></td>
<td>
<p> other parameters passed to print

</p>
</td></tr>
</table>


<h3>See Also</h3>


<p><code><a href="#topic+s2Data">s2Data</a></code>
</p>

<hr>
<h2 id='Rcpp_s2net-class'>Class <code>s2net</code></h2><span id='topic+Rcpp_s2net-class'></span><span id='topic+Rcpp_s2net'></span><span id='topic+_rcpp_module_boot_Rcpp_s2net_export'></span><span id='topic+.__Mod__Rcpp_s2net_export'></span><span id='topic+predict+2CRcpp_s2net-method'></span>

<h3>Description</h3>


<p>This is the main class of this library, implemented in C++ and exposed to <span class="rlang"><b>R</b></span> using <code>Rcpp</code> modules. 
It can be used in <span class="rlang"><b>R</b></span> directly, although some generic S4 methods have been implemented to make it easier to interact in <span class="rlang"><b>R</b></span>.
</p>


<h3>Methods</h3>


<dl>
<dt>predict</dt><dd><p><code>signature(object = "Rcpp_s2net")</code>: See <code><a href="#topic+predict_Rcpp_s2net">predict_Rcpp_s2net</a></code></p>
</dd>
</dl>



<h3>Fields</h3>


<dl>
<dt><code>beta</code>:</dt><dd><p>Object of class <code>matrix</code>. The fitted model coefficients.</p>
</dd>
<dt><code>intercept</code>:</dt><dd><p> The model intercept.</p>
</dd>
</dl>



<h3>Class-Based Methods</h3>


<dl>
<dt><code>initialize(data, loss)</code>:</dt><dd>

<dl>
<dt><code>data</code> </dt><dd> <p><code><a href="#topic+s2Data">s2Data</a></code> object</p>
</dd>
<dt><code>loss</code> </dt><dd><p>Loss function: 0 = linear, 1 = logit</p>
</dd>
</dl>

</dd>
<dt><code>setupFista(<a href="#topic+s2Fista">s2Fista</a>)</code>:</dt><dd><p> Configures the FISTA internal algorithm.</p>
</dd>
<dt><code>predict(newX, type)</code>:</dt><dd>

<dl>
<dt><code>newX</code> </dt><dd><p> New data <code>matrix</code> to make predictions.</p>
</dd>
<dt><code>type</code> </dt><dd><p> 0 = default, 1 = response, 2 = probs, 3 = class</p>
</dd>
</dl>

</dd>
<dt><code>fit(params, frame, proj)</code>:</dt><dd>

<dl>
<dt><code>params </code></dt><dd><p><code><a href="#topic+s2Params">s2Params</a></code> object</p>
</dd>
<dt><code>frame</code> </dt><dd><p>0 = &quot;JT&quot;, 1 = &quot;ExtJT&quot;</p>
</dd>
<dt><code>proj</code> </dt><dd><p>0 = no, 1 = yes, 2 = auto</p>
</dd>
</dl>

</dd>
</dl>



<h3>Author(s)</h3>


<p>Juan C. Laria
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("auto_mpg")
train = s2Data(xL = auto_mpg$P1$xL, yL = auto_mpg$P1$yL,  xU = auto_mpg$P1$xU)

# We create the C++ object calling the new method (constructor)
obj = new(s2net, train, 0) # 0 = regression 
obj

# We call directly the $fit method of obj, 
obj$fit(s2Params(lambda1 = 0.01, 
                   lambda2 = 0.01, 
                   gamma1 = 0.05, 
                   gamma2 = 100, 
                   gamma3 = 0.05), 1, 2)
# fitted model
obj$beta

# We can test the results using the unlabeled data
test = s2Data(xL = auto_mpg$P1$xU, yL = auto_mpg$P1$yU,  preprocess = train)
ypred = obj$predict(test$xL, 0)

## Not run: 
if(require(ggplot2)){
  ggplot() + 
    aes(x = ypred, y = test$yL) + geom_point() + 
    geom_abline(intercept = 0, slope = 1, linetype = 2)
}

## End(Not run)

</code></pre>

<hr>
<h2 id='s2Data'>

Data wrapper for <code>s2net</code>.
</h2><span id='topic+s2Data'></span>

<h3>Description</h3>


<p>This function preprocess the data to fit a semi-supervised linear joint trained model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>s2Data(xL, yL, xU = NULL, preprocess = T)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="s2Data_+3A_xl">xL</code></td>
<td>


<p>The labeled data. Could be a <code>matrix</code> or <code>data.frame</code>. 
</p>
</td></tr>
<tr><td><code id="s2Data_+3A_yl">yL</code></td>
<td>


<p>The labels associated with <code>xL</code>. Could be a <code>vector</code>, <code>matrix</code> or <code>data.frame</code>, of <code>factor</code> or <code>numeric</code> types.
</p>
</td></tr>
<tr><td><code id="s2Data_+3A_xu">xU</code></td>
<td>


<p>The unlabeled data (optional). Could be a <code>matrix</code> or <code>data.frame</code>. 
</p>
</td></tr>
<tr><td><code id="s2Data_+3A_preprocess">preprocess</code></td>
<td>


<p>Should the input data be pre-processed? Possible values are: 
</p>
<p><code>TRUE</code> (default) The data is converted to a matrix. Factor variables are automatically coded using <code><a href="stats.html#topic+model.matrix">model.matrix</a></code>. The data is scaled, and constant columns are removed.
</p>
<p><code>FALSE</code> Do nothing. Keep in mind that the theoretical framework assumes that <code>xL</code> is centered. Unless you are absolutely sure, avoid this.
</p>
<p>Another object of class <code>s2Data</code> that was obtained from similar data (same original variables). This is useful when using train/validation sets, to apply the validation data the same transformation as train data. 
</p>
</td></tr>
</table>


<h3>Value</h3>






<p>Returns an object of S3 class <code>s2Data</code> with fields
</p>
<table>
<tr><td><code>xL</code></td>
<td>
<p>Transformed labeled data</p>
</td></tr>
<tr><td><code>yL</code></td>
<td>
<p>Transformed labels. If <code>yL</code> was a factor, it is converted to numeric, and the base category is kept in <code>base</code></p>
</td></tr>
<tr><td><code>xU</code></td>
<td>
<p>Tranformed unlabeled data</p>
</td></tr> 
<tr><td><code>type</code></td>
<td>
<p>Type of task. This one is inferred from the response labels.</p>
</td></tr>
<tr><td><code>base</code></td>
<td>
<p>Base category for classification <code>0 = base</code></p>
</td></tr>
</table>
<p>In addition the following attributes are stored.
</p>
<table>
<tr><td><code>pr:rm_cols</code></td>
<td>
<p>logical vector of removed columns</p>
</td></tr>
<tr><td><code>pr:center</code></td>
<td>
<p>column center</p>
</td></tr>
<tr><td><code>pr:scale</code></td>
<td>
<p>column scale</p>
</td></tr>
<tr><td><code>pr:ycenter</code></td>
<td>
<p>yL center. Regression</p>
</td></tr>
<tr><td><code>pr:yscale</code></td>
<td>
<p>yL scale. Regression</p>
</td></tr>
</table>


<h3>Author(s)</h3>


<p>Juan C. Laria
</p>


<h3>See Also</h3>


<p><code><a href="#topic+s2Fista">s2Fista</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("auto_mpg")

train = s2Data( xL = auto_mpg$P1$xL,
                  yL = auto_mpg$P1$yL,
                  xU = auto_mpg$P1$xU,
                  preprocess = TRUE )
show(train)

# Notice how ordered factor variable $cylinders is handled 
# .L (linear) .Q (quadratic) .C (cubic) and .^4
head(train$xL) 


#if you want to do validation with the unlabeled data
idx = sample(length(auto_mpg$P1$yU), 200)

train = s2Data(xL = auto_mpg$P1$xL, yL = auto_mpg$P1$yL, xU = auto_mpg$P1$xU[idx, ])

valid = s2Data(xL = auto_mpg$P1$xU[-idx, ], yL = auto_mpg$P1$yU[-idx], preprocess = train)

test = s2Data(xL = auto_mpg$P1$xU[idx, ], yL = auto_mpg$P1$yU[idx], preprocess = train)

train
valid
test
</code></pre>

<hr>
<h2 id='s2Fista'>

Hyper-parameter wrapper for FISTA.
</h2><span id='topic+s2Fista'></span>

<h3>Description</h3>


<p>This is a very simple function that supplies the hyper-parameters for the Fast Iterative Soft-Threshold Algorithm (FISTA) that solves the <code>s2net</code> minimization problem.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>s2Fista(MAX_ITER_INNER = 5000, TOL = 1e-07, t0 = 2, step = 0.1, use_warmstart = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="s2Fista_+3A_max_iter_inner">MAX_ITER_INNER</code></td>
<td>


<p>Number of iterations of FISTA
</p>
</td></tr>
<tr><td><code id="s2Fista_+3A_tol">TOL</code></td>
<td>


<p>The relative tolerance. The algorith stops when the objective does not improve more than <code>TOL*</code>the null model's objective function evaluation, after two succesive iterations. 
</p>
</td></tr>
<tr><td><code id="s2Fista_+3A_t0">t0</code></td>
<td>


<p>The initial stepsize for backtracking.
</p>
</td></tr>
<tr><td><code id="s2Fista_+3A_step">step</code></td>
<td>


<p>The scale factor in the stepsize to backtrack until a valid step is found.
</p>
</td></tr>
<tr><td><code id="s2Fista_+3A_use_warmstart">use_warmstart</code></td>
<td>


<p>Should we use a warm <code>beta</code> to fit the model? This is useful to speed-up hyper-parameter searching methods.
</p>
</td></tr>
</table>


<h3>Value</h3>






<p>Returns an object of S3 class <code>s2Fista</code> with the input arguments as fields.
</p>


<h3>References</h3>


<p>Beck, A., &amp; Teboulle, M. (2009). 
A fast iterative shrinkage-thresholding algorithm for linear inverse problems. <em>SIAM journal on imaging sciences</em>, 2(1), 183-202. <a href="https://doi.org/10.1137/080716542">doi:10.1137/080716542</a>
</p>


<h3>See Also</h3>


<p><code><a href="#topic+s2Params">s2Params</a></code>, <code><a href="#topic+s2Data">s2Data</a></code>
</p>

<hr>
<h2 id='s2net-package'>The Generalized Semi-Supervised Elastic-Net</h2><span id='topic+s2net'></span>

<h3>Description</h3>

 
<p><img src="../help/figures/s2net.png" width=200 alt="s2net.png" />
Implements the generalized semi-supervised elastic-net. This method extends the supervised elastic-net problem, and thus it is a practical solution to the problem of feature selection in semi-supervised contexts. Its mathematical formulation is presented from a general perspective, covering a wide range of models.  We focus on linear and logistic responses, but the implementation could be easily extended to other losses in generalized linear models. We develop a flexible and fast implementation, written in 'C++' using 'RcppArmadillo' and integrated into R via 'Rcpp' modules. See Culp, M. 2013 &lt;doi:10.1080/10618600.2012.657139&gt; for references on the Joint Trained Elastic-Net.
</p>


<h3>Details</h3>

<p>The DESCRIPTION file: </p>

<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> s2net</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Title: </td><td style="text-align: left;"> The Generalized Semi-Supervised Elastic-Net</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.0.7</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2024-03-04</td>
</tr>
<tr>
 <td style="text-align: left;">
Authors@R: </td><td style="text-align: left;"> c(person("Juan C.",
           "Laria",,
           role = c("aut", "cre"),
           email = "juank.laria@gmail.com",
           comment = c(ORCID = "0000-0001-7734-9647")),
    person("Line H.",
           "Clemmensen",,
           role = c("aut"),
           email = "lkhc@dtu.dk"))</td>
</tr>
<tr>
 <td style="text-align: left;">
Description: </td><td style="text-align: left;"> Implements the generalized semi-supervised elastic-net. This method extends the supervised elastic-net problem, and thus it is a practical solution to the problem of feature selection in semi-supervised contexts. Its mathematical formulation is presented from a general perspective, covering a wide range of models.  We focus on linear and logistic responses, but the implementation could be easily extended to other losses in generalized linear models. We develop a flexible and fast implementation, written in 'C++' using 'RcppArmadillo' and integrated into R via 'Rcpp' modules. See Culp, M. 2013 &lt;doi:10.1080/10618600.2012.657139&gt; for references on the Joint Trained Elastic-Net.</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;= 2)</td>
</tr>
<tr>
 <td style="text-align: left;">
Imports: </td><td style="text-align: left;"> Rcpp, methods, MASS</td>
</tr>
<tr>
 <td style="text-align: left;">
Depends: </td><td style="text-align: left;"> stats</td>
</tr>
<tr>
 <td style="text-align: left;">
LinkingTo: </td><td style="text-align: left;"> Rcpp, RcppArmadillo</td>
</tr>
<tr>
 <td style="text-align: left;">
Suggests: </td><td style="text-align: left;"> knitr,
rmarkdown,
glmnet,
Metrics,
testthat</td>
</tr>
<tr>
 <td style="text-align: left;">
VignetteBuilder: </td><td style="text-align: left;"> knitr</td>
</tr>
<tr>
 <td style="text-align: left;">
URL: </td><td style="text-align: left;"> https://github.com/jlaria/s2net</td>
</tr>
<tr>
 <td style="text-align: left;">
BugReports: </td><td style="text-align: left;"> https://github.com/jlaria/s2net/issues</td>
</tr>
<tr>
 <td style="text-align: left;">
Encoding: </td><td style="text-align: left;"> UTF-8</td>
</tr>
<tr>
 <td style="text-align: left;">
RoxygenNote: </td><td style="text-align: left;"> 7.2.0</td>
</tr>
<tr>
 <td style="text-align: left;">
Author: </td><td style="text-align: left;"> Juan C. Laria [aut, cre] (&lt;https://orcid.org/0000-0001-7734-9647&gt;),
  Line H. Clemmensen [aut]</td>
</tr>
<tr>
 <td style="text-align: left;">
Maintainer: </td><td style="text-align: left;"> Juan C. Laria &lt;juank.laria@gmail.com&gt;</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>


<p>Index of help topics:
</p>
<pre>
Rcpp_s2net-class        Class 's2net'
auto_mpg                Auto MPG Data Set
predict.s2netR          S3 Methods for 's2netR' objects.
predict_Rcpp_s2net      Predict method for 's2net' C++ class.
print.s2Data            Print methods for S3 objects
s2Data                  Data wrapper for 's2net'.
s2Fista                 Hyper-parameter wrapper for FISTA.
s2Params                Hyper-parameter wrapper for 's2net'
s2net                   The Generalized Semi-Supervised Elastic-Net
s2netR                  Trains a generalized extended linear joint
                        trained model using semi-supervised data.
simulate_extra          Simulate extrapolated data
simulate_groups         Simulate data (two groups design)
</pre>
<p>This package includes a very easy-to-use interface for handling data, with the <code><a href="#topic+s2Data">s2Data</a></code> function. The main function of the package is the <code><a href="#topic+s2netR">s2netR</a></code> function, which is a wrapper for the <code><a href="#topic+Rcpp_s2net">Rcpp_s2net</a></code> (<code>s2net</code>) class. 
</p>


<h3>Author(s)</h3>

<p>Juan C. Laria [aut, cre] (&lt;https://orcid.org/0000-0001-7734-9647&gt;),
  Line H. Clemmensen [aut]
</p>


<h3>References</h3>

<p>Laria, J.C., L. Clemmensen (2019). A generalized elastic-net for semi-supervised learning of sparse features.
</p>
<p>Sogaard Larsen, J. et. al. (2019).  Semi-supervised covariate shift modelling of spectroscopic data.
</p>
<p>Ryan, K. J., &amp; Culp, M. V. (2015). On semi-supervised linear regression in covariate shift problems. <em>The Journal of Machine Learning Research, 16</em>(1), 3183-3217.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+s2Data">s2Data</a></code>,
<code><a href="#topic+s2netR">s2netR</a></code>,
<code><a href="#topic+Rcpp_s2net">Rcpp_s2net</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("auto_mpg")
train = s2Data(xL = auto_mpg$P1$xL, yL = auto_mpg$P1$yL,  xU = auto_mpg$P1$xU)

model = s2netR(train, 
                s2Params(lambda1 = 0.1, 
                           lambda2 = 0,
                           gamma1 = 0.1,
                           gamma2 = 100,
                           gamma3 = 0.1))

# here we tell it to transform the valid data as we did with train.
valid = s2Data(auto_mpg$P1$xU, auto_mpg$P1$yU, preprocess = train) 
ypred = predict(model, valid$xL)

## Not run: 
if(require(ggplot2)){
  ggplot() + 
    aes(x = ypred, y = valid$yL) + geom_point() + 
    geom_abline(intercept = 0, slope = 1, linetype = 2)
}

## End(Not run)
</code></pre>

<hr>
<h2 id='s2netR'>

Trains a generalized extended linear joint trained model using semi-supervised data.
</h2><span id='topic+s2netR'></span>

<h3>Description</h3>


<p>This function is a wrapper for the class <code><a href="#topic+s2net">s2net</a></code>. It creates the C++ object and fits the model using input <code>data</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>s2netR(data, params, loss = "default", frame = "ExtJT", proj = "auto", 
        fista = NULL, S3 = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="s2netR_+3A_data">data</code></td>
<td>


<p>A <code><a href="#topic+s2Data">s2Data</a></code> object with the (training) data.
</p>
</td></tr>
<tr><td><code id="s2netR_+3A_params">params</code></td>
<td>


<p>A <code><a href="#topic+s2Params">s2Params</a></code> object with the model hyper-parameters.
</p>
</td></tr>
<tr><td><code id="s2netR_+3A_loss">loss</code></td>
<td>


<p>Loss function. One of <code>"default"</code> (figure it out from the data), <code>"linear"</code> or <code>"logit"</code>.
</p>
</td></tr>
<tr><td><code id="s2netR_+3A_frame">frame</code></td>
<td>


<p>The semi-supervised frame: <code>"ExtJT"</code> (the extended linear joint trained model), <code>"JT"</code> (the linear joint trained model from Ryan and Culp. 2015)
</p>
</td></tr>
<tr><td><code id="s2netR_+3A_proj">proj</code></td>
<td>


<p>Should the unlabeled data be shifted to remove the model's effect? One of <code>"no", "yes", "auto"</code> (option <code>auto</code> shifts the unlabeled data if the angle betwen beta and the center of the data is important)
</p>
</td></tr>
<tr><td><code id="s2netR_+3A_fista">fista</code></td>
<td>


<p>Fista setup parameters. An object of class <code><a href="#topic+s2Fista">s2Fista</a></code>.
</p>
</td></tr>
<tr><td><code id="s2netR_+3A_s3">S3</code></td>
<td>


<p>Boolean: should the method return an S3 object (default) or a C++ object?
</p>
</td></tr>
</table>


<h3>Value</h3>






<p>Returns an object of S3 class <code>s2netR</code> or a C++ object of class <code><a href="#topic+s2net">s2net</a></code>
</p>


<h3>Author(s)</h3>


<p>Juan C. Laria
</p>


<h3>References</h3>


<p>Ryan, K. J., &amp; Culp, M. V. (2015). On semi-supervised linear regression in covariate shift problems. <em>The Journal of Machine Learning Research, 16</em>(1), 3183-3217.
</p>


<h3>See Also</h3>


<p><code><a href="#topic+s2net">s2net</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("auto_mpg")
train = s2Data(xL = auto_mpg$P1$xL, yL = auto_mpg$P1$yL,  xU = auto_mpg$P1$xU)

model = s2netR(train, 
                s2Params(lambda1 = 0.1, 
                           lambda2 = 0,
                           gamma1 = 0.1,
                           gamma2 = 100,
                           gamma3 = 0.1),
                loss = "linear",
                frame = "ExtJT",
                proj = "auto",
                fista = s2Fista(5000, 1e-7, 1, 0.8))

valid = s2Data(auto_mpg$P1$xU, auto_mpg$P1$yU, preprocess = train)
ypred = predict(model, valid$xL)

## Not run: 
if(require(ggplot2)){
  ggplot() + 
    aes(x = ypred, y = valid$yL) + geom_point() + 
    geom_abline(intercept = 0, slope = 1, linetype = 2)
}

## End(Not run)

</code></pre>

<hr>
<h2 id='s2Params'>

Hyper-parameter wrapper for <code>s2net</code>
</h2><span id='topic+s2Params'></span>

<h3>Description</h3>


<p>This is a very simple function that collapses the input parameters into a named vector to supply to C++ methods. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>s2Params(lambda1, lambda2 = 0, gamma1 = 0, gamma2 = 0, gamma3 = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="s2Params_+3A_lambda1">lambda1</code></td>
<td>


<p>elastic-net regularization parameter - <code class="reqn">l_1</code> norm.
</p>
</td></tr>
<tr><td><code id="s2Params_+3A_lambda2">lambda2</code></td>
<td>


<p>elastic-net regularization parameter - <code class="reqn">l_2</code> norm.
</p>
</td></tr>
<tr><td><code id="s2Params_+3A_gamma1">gamma1</code></td>
<td>


<p>s2net weight hyper-parameter.
</p>
</td></tr>
<tr><td><code id="s2Params_+3A_gamma2">gamma2</code></td>
<td>


<p>s2net covariance hyper-parameter (between 1 and <code>Inf</code>).
</p>
</td></tr>
<tr><td><code id="s2Params_+3A_gamma3">gamma3</code></td>
<td>


<p>s2net shift hyper-parameter (between 0 and 1).
</p>
</td></tr>
</table>


<h3>Value</h3>






<p>Returns a named vector of S3 class <code>s2Params</code>.
</p>


<h3>See Also</h3>


<p><code><a href="#topic+s2Data">s2Data</a></code>, <code><a href="#topic+s2Fista">s2Fista</a></code>
</p>

<hr>
<h2 id='simulate_extra'>

Simulate extrapolated data
</h2><span id='topic+simulate_extra'></span>

<h3>Description</h3>


<p>Simulated data scenarios described in the paper from Ryan and Culp (2015). 
</p>
<p><img src="../help/figures/sim_extra.jpg" width=300 alt="sim_extra.jpg" />
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulate_extra(n_source = 100, n_target = 100, p = 1000, shift = 10, 
               scenario = "same", response = "linear", sigma2 = 2.5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simulate_extra_+3A_n_source">n_source</code></td>
<td>

<p>Number of source samples (labeled)
</p>
</td></tr>
<tr><td><code id="simulate_extra_+3A_n_target">n_target</code></td>
<td>

<p>Number of target samples (unlabeled)
</p>
</td></tr>
<tr><td><code id="simulate_extra_+3A_p">p</code></td>
<td>


<p>Number of variables ( <code>p &gt; 10</code>)
</p>
</td></tr>
<tr><td><code id="simulate_extra_+3A_shift">shift</code></td>
<td>


<p>The shift applied to the first 10 columns of xU.
</p>
</td></tr>
<tr><td><code id="simulate_extra_+3A_scenario">scenario</code></td>
<td>


<p>Simulation scenario. One of <code>"same"</code> (same distribution), <code>"lucky"</code> (extrapolation with lucky <code class="reqn">\beta</code>), <code>"unlucky"</code> (extrapolation with unlucky <code class="reqn">\beta</code>)
</p>
</td></tr>
<tr><td><code id="simulate_extra_+3A_response">response</code></td>
<td>


<p>Type of response: <code>"linear"</code> or <code>"logit"</code>
</p>
</td></tr>
<tr><td><code id="simulate_extra_+3A_sigma2">sigma2</code></td>
<td>


<p>The variance of the error term, linear response case.
</p>
</td></tr>
</table>


<h3>Value</h3>






<p>A list, with 
</p>

<dl>
<dt>xL</dt><dd><p> data frame with the labeled (source) data</p>
</dd>
<dt>yL</dt><dd><p> labels associated with <code>xL</code></p>
</dd>
<dt>xU</dt><dd><p> data frame with the unlabeled (target) data</p>
</dd>
<dt>yU</dt><dd><p> labels associated with <code>xU</code> (for validation/testing)</p>
</dd>
</dl>



<h3>References</h3>


<p>Ryan, K. J., &amp; Culp, M. V. (2015). On semi-supervised linear regression in covariate shift problems. <em>The Journal of Machine Learning Research, 16</em>(1), 3183-3217.
</p>


<h3>See Also</h3>


<p><code><a href="#topic+simulate_groups">simulate_groups</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(0)
data = simulate_extra()

train = s2Data(data$xL, data$yL, data$xU)
valid = s2Data(data$xU, data$yU, preprocess = train)

model = s2netR(train, s2Params(0.1))
ypred = predict(model, valid$xL)
plot(ypred, valid$yL)
</code></pre>

<hr>
<h2 id='simulate_groups'>

Simulate data (two groups design)
</h2><span id='topic+simulate_groups'></span>

<h3>Description</h3>


<p>Simulated data scenario described in paper [citation here].
</p>
<p><img src="../help/figures/sim_fr.jpg" width=600 alt="sim_fr.jpg" />
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulate_groups(n_source = 100, n_target = 100, p = 200, response = "linear")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simulate_groups_+3A_n_source">n_source</code></td>
<td>


<p>Number of labeled observations
</p>
</td></tr>
<tr><td><code id="simulate_groups_+3A_n_target">n_target</code></td>
<td>


<p>Number of unlabeled (target) observations
</p>
</td></tr>
<tr><td><code id="simulate_groups_+3A_p">p</code></td>
<td>


<p>Number of variables
</p>
</td></tr>
<tr><td><code id="simulate_groups_+3A_response">response</code></td>
<td>


<p>Type of response: <code>"linear"</code> or <code>"logit"</code>
</p>
</td></tr>
</table>


<h3>Value</h3>






<p>A list, with 
</p>

<dl>
<dt>xL</dt><dd><p> data frame with the labeled (source) data</p>
</dd>
<dt>yL</dt><dd><p> labels associated with <code>xL</code></p>
</dd>
<dt>xU</dt><dd><p> data frame with the unlabeled (target) data</p>
</dd>
<dt>yU</dt><dd><p> labels associated with <code>xU</code> (for validation/testing)</p>
</dd>
</dl>



<h3>Author(s)</h3>


<p>Juan C. Laria
</p>


<h3>See Also</h3>


<p><code><a href="#topic+simulate_extra">simulate_extra</a></code>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
