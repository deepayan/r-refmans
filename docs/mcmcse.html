<!DOCTYPE html><html lang="en"><head><title>Help for package mcmcse</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {mcmcse}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#mcmcse-package'>
<p>Monte Carlo Standard Errors for MCMC</p></a></li>
<li><a href='#batchSize'><p>Batch size (truncation point) selection</p></a></li>
<li><a href='#BVN_Gibbs'><p>MCMC samples from a bivariate normal distribution</p></a></li>
<li><a href='#confRegion'><p>Confidence regions (ellipses) for Monte Carlo estimates</p></a></li>
<li><a href='#ess'><p>Univariate effective sample size (ESS) as described in Gong and Flgal (2015).</p></a></li>
<li><a href='#estvssamp'><p>Create a plot that shows how Monte Carlo estimates change with increasing sample size.</p></a></li>
<li><a href='#is.mcmcse'><p>Check if the class of the object is mcmcse</p></a></li>
<li><a href='#mcse'><p>Compute Monte Carlo standard errors for expectations.</p></a></li>
<li><a href='#mcse.initseq'><p>Multivariate Monte Carlo standard errors for expectations with the initial sequence method of Dai</p>
and Jones (2017)</a></li>
<li><a href='#mcse.mat'><p>Apply <code>mcse</code> to each column of the MCMC samples.</p></a></li>
<li><a href='#mcse.multi'><p>Multivariate Monte Carlo standard errors for expectations.</p></a></li>
<li><a href='#mcse.q'><p>Compute Monte Carlo standard errors for quantiles.</p></a></li>
<li><a href='#mcse.q.mat'><p>Apply <code>mcse.q</code> to each column of a matrix or data frame of MCMC samples.</p></a></li>
<li><a href='#minESS'><p>Minimum effective sample size required for stable estimation as described in Vats et al. (2015)</p></a></li>
<li><a href='#multiESS'><p>Effective Sample Size of a multivariate Markov chain as described in Vats et al. (2015).</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Version:</td>
<td>1.5-0</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-08-29</td>
</tr>
<tr>
<td>Title:</td>
<td>Monte Carlo Standard Errors for MCMC</td>
</tr>
<tr>
<td>Author:</td>
<td>James M. Flegal &lt;jflegal@ucr.edu&gt;,
		John Hughes,
		Dootika Vats &lt;dootika@iitk.ac.in&gt;, 
		Ning Dai,
		Kushagra Gupta, and
		Uttiya Maji</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Dootika Vats &lt;dootika@iitk.ac.in&gt;</td>
</tr>
<tr>
<td>Imports:</td>
<td>utils, ellipse, Rcpp (&ge; 0.12.10), fftwtools, testthat</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides tools for computing Monte Carlo standard
        errors (MCSE) in Markov chain Monte Carlo (MCMC) settings. MCSE
        computation for expectation and quantile estimators is
        supported as well as multivariate estimations. The package also provides 
	functions for computing effective sample size and for plotting
	Monte Carlo estimates versus sample size.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-09-09 06:55:11 UTC; Dootika</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-09-09 07:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='mcmcse-package'>
Monte Carlo Standard Errors for MCMC
</h2><span id='topic+mcmcse-package'></span><span id='topic+mcmcse'></span>

<h3>Description</h3>

<p>Provides tools for computing Monte Carlo standard
errors (MCSE) in Markov chain Monte Carlo (MCMC) settings. MCSE
computation for expectation and quantile estimators is
supported. The package also provides functions for computing
effective sample size and for plotting Monte Carlo estimates
versus sample size.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> mcmcse</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.5-0</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2021-08-29</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;= 2)</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>James M. Flegal &lt;jflegal@ucr.edu&gt;,<br />  
John Hughes, <br />   
Dootika Vats, &lt;dootika@iitk.ac.in&gt;,<br />   
Ning Dai, <br />  
Kushagra Gupta, and<br />  
Uttiya Maji  
</p>
<p>Maintainer: Dootika Vats &lt;dootika@iitk.ac.in&gt;
</p>


<h3>References</h3>

<p>Dai, N and Jones, G.L. (2017)  Multivariate initial sequence estimators in Markov chain Monte Carlo, <em> Journal of Multivariate Analysis</em>, <b>159</b>, 184-199.
</p>
<p>Flegal, J. M. (2012) Applicability of subsampling
bootstrap methods in Markov chain Monte Carlo. In
Wozniakowski, H. and Plaskota, L., editors, <em>Monte
Carlo and Quasi-Monte Carlo Methods 2010</em>, pages 363&ndash;372.
Springer-Verlag.
</p>
<p>Flegal, J. M. and Jones, G. L. (2010) Batch means and
spectral variance estimators in Markov chain Monte Carlo.
<em>The Annals of Statistics</em>, <b>38</b>, 1034&ndash;1070.
</p>
<p>Flegal, J. M. and Jones, G. L. (2011) Implementing Markov
chain Monte Carlo: Estimating with confidence. In Brooks,
S., Gelman, A., Jones, G. L., and Meng, X., editors,
<em>Handbook of Markov Chain Monte Carlo</em>, pages
175&ndash;197. Chapman &amp; Hall/CRC Press.
</p>
<p>Doss, C. R., Flegal, J. M., Jones, G. L., and Neath, R. C. (2014). Markov chain Monte Carlo estimation of quantiles. <em>Electronic Journal of Statistics</em>, <b>8</b>, 2448-2478.
</p>
<p>Gong, L., and Flegal, J. M. A practical sequential stopping rule for high-dimensional Markov chain Monte Carlo. <em>Journal of Computational and Graphical Statistics</em>, <b>25</b>,  684–-700.
</p>
<p>Heberle, J., and Sattarhoff, C. (2017). A fast algorithm for the computation of HAC covariance matrix estimators. <em>Econometrics</em>, <b>5</b>, 9.
</p>
<p>Jones, G. L., Haran, M., Caffo, B. S. and Neath, R.
(2006) Fixed-width output analysis for Markov chain Monte
Carlo. <em>Journal of the American Statistical
Association</em>, <b>101</b>, 1537&ndash;1547.
</p>
<p>Liu, Y., Vats, D., and Flegal, J. M. (2021) Batch size selection for variance estimators in MCMC, <em>Methodology and Computing in Applied Probability</em>, to appear.
</p>
<p>Vats, D., Flegal, J. M., and, Jones, G. L Multivariate output analysis for Markov chain Monte Carlo, <em>Biometrika</em>, <b>106</b>, 321–-337.
</p>
<p>Vats, D., Flegal, J. M., and, Jones, G. L. (2018) Strong Consistency of multivariate spectral variance estimators for Markov chain Monte Carlo, <em>Bernoulli</em>, <b>24</b>, 1860–-1909.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n &lt;- 1e3
mu = c(2, 50)
sigma = matrix(c(1, 0.5, 0.5, 1), nrow = 2)
out = BVN_Gibbs(n, mu, sigma)

multiESS(out)
ess(out)
mcse.mat(out)

mcse.bm &lt;- mcse.multi(x = out)
mcse.tuk &lt;- mcse.multi(x = out, method = "tukey")

</code></pre>

<hr>
<h2 id='batchSize'>Batch size (truncation point) selection</h2><span id='topic+batchSize'></span>

<h3>Description</h3>

<p>Function returns the optimal batch size (or truncation point) for a given chain and method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>batchSize(x, method = c("bm", "obm", "bartlett", "tukey", "sub"), g = NULL, fast = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="batchSize_+3A_x">x</code></td>
<td>
<p>A matrix or data frame of Markov chain output. Number of rows is the Monte
Carlo sample size.</p>
</td></tr>
<tr><td><code id="batchSize_+3A_method">method</code></td>
<td>
<p>Any of &ldquo;<code>bm</code>&rdquo;,&ldquo;<code>obm</code>&rdquo;,&ldquo;<code>bartlett</code>&rdquo;,&ldquo;<code>tukey</code>&rdquo;. &ldquo;<code>bm</code>&rdquo;
represents batch means estimator, &ldquo;<code>obm</code>&rdquo; represents the overlapping batch means estimator,
and &ldquo;<code>bartlett</code>&rdquo; and &ldquo;<code>tukey</code>&rdquo; represent the modified-Bartlett window and
the Tukey-Hanning windows for the spectral variance estimators.</p>
</td></tr>
<tr><td><code id="batchSize_+3A_g">g</code></td>
<td>
<p>A function that represents features of interest. <code>g</code> is applied to each row of x and
thus <code>g</code> should take a vector input only. If <code>g</code> is <code>NULL</code>, <code>g</code> is set to be identity, which
is estimation of the mean of the target density.</p>
</td></tr>
<tr><td><code id="batchSize_+3A_fast">fast</code></td>
<td>
<p>Boolean variable for fast estimation using a reasonable subset of the Markov chain.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>batchSize</code> fits a stationary autoregressive process to the marginals of <code>x</code>, selecting the order of
the process as the one with the maximum AIC among the models with coefficients greater than a threshold.
</p>


<h3>Value</h3>

<p>A value of the optimal batch size (truncation point or bandwidth) is returned.
</p>


<h3>References</h3>

<p>Liu, Y., Vats, D., and Flegal, J. M. (2021) Batch size selection for variance estimators in MCMC, <em>Methodology and
Computing in Applied Probability</em>, to appear.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mcse.multi">mcse.multi</a></code> and <code><a href="#topic+mcse">mcse</a></code>, which calls on <code>batchSize</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Bivariate Normal with mean (mu1, mu2) and covariance sigma
n &lt;- 1e3
mu &lt;- c(2, 50)
sigma &lt;- matrix(c(1, 0.5, 0.5, 1), nrow = 2)

out &lt;- BVN_Gibbs(n, mu, sigma)

batchSize(out)
batchSize(out, method = "obm")
batchSize(out, method = "bartlett")

</code></pre>

<hr>
<h2 id='BVN_Gibbs'>MCMC samples from a bivariate normal distribution</h2><span id='topic+BVN_Gibbs'></span>

<h3>Description</h3>

<p>Function returns Gibbs samples from a bivariate normal target density.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BVN_Gibbs(n, mu, sigma)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BVN_Gibbs_+3A_n">n</code></td>
<td>
<p>Sample size of the Markov chain.</p>
</td></tr>
<tr><td><code id="BVN_Gibbs_+3A_mu">mu</code></td>
<td>
<p>A 2 dimensional vector. Mean of the target normal distribution.</p>
</td></tr>
<tr><td><code id="BVN_Gibbs_+3A_sigma">sigma</code></td>
<td>
<p>2 x 2 symmetric positive definite matrix. The covariance matrix of the target normal distribution.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An n x 2 matrix of the Gibbs samples.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n &lt;- 1e3
mu &lt;- c(2, 50)
sigma &lt;- matrix(c(1, 0.5, 0.5, 1), nrow = 2)
out &lt;- BVN_Gibbs(n, mu, sigma)

</code></pre>

<hr>
<h2 id='confRegion'>Confidence regions (ellipses) for Monte Carlo estimates</h2><span id='topic+confRegion'></span>

<h3>Description</h3>

<p>Constructs confidence regions (ellipses) from the Markov chain output for the features of interest
Function uses the ellipse package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>confRegion(mcse.obj, which = c(1,2), level = .95)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="confRegion_+3A_mcse.obj">mcse.obj</code></td>
<td>
<p>The list returned by the mcse.multi or mcse.initseq command, or an mcmcse class object.</p>
</td></tr>
<tr><td><code id="confRegion_+3A_which">which</code></td>
<td>
<p>Integer vector of length 2 indicating the component for which to make the confidence
ellipse. Chooses the first two by default.</p>
</td></tr>
<tr><td><code id="confRegion_+3A_level">level</code></td>
<td>
<p>confidence level for the ellipse.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a matrix of x and y coordinates for the ellipse. Use plot function on the matrix
to plot the ellipse.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Bivariate Normal with mean (mu1, mu2) and covariance sigma
n &lt;- 1e3
mu &lt;- c(2, 50)
sigma &lt;- matrix(c(1, 0.5, 0.5, 1), nrow = 2)

out &lt;- BVN_Gibbs(n, mu, sigma)

mcerror &lt;- mcse.multi(out, blather = TRUE)

## Plotting the ellipse
plot(confRegion(mcerror), type = 'l')
</code></pre>

<hr>
<h2 id='ess'>Univariate effective sample size (ESS) as described in Gong and Flgal (2015).</h2><span id='topic+ess'></span>

<h3>Description</h3>

<p>Estimate the effective sample size (ESS) of a Markov chain as described in Gong and Flegal (2015).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ess(x, g = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ess_+3A_x">x</code></td>
<td>
<p>a matrix or data frame of Markov chain output. Number of rows is the Monte
Carlo sample size.</p>
</td></tr>
<tr><td><code id="ess_+3A_g">g</code></td>
<td>
<p>a function that represents features of interest. <code>g</code> is applied to each row of x and thus
<code>g</code> should take a vector input only. Ifcodeg is <code>NULL</code>, <code>g</code> is set to be identity, which is estimation
of the mean of the target density.</p>
</td></tr>
<tr><td><code id="ess_+3A_...">...</code></td>
<td>
<p>arguments passed on to the <code>mcse.mat</code> function. For example method = &ldquo;<code>tukey</code>&rdquo; and size =
&ldquo;<code>cuberoot</code>&rdquo; can be used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>ESS is the size of an iid sample with the same variance as the current sample for estimating the expectation of g. ESS is given by
</p>
<p style="text-align: center;"><code class="reqn">ESS = n \frac{\lambda^{2}}{\sigma^{2}}</code>
</p>
<p> where <code class="reqn">\lambda^{2}</code> is the sample variance and
<code class="reqn">\sigma^{2}</code> is an estimate of the variance in the Markov chain central limit theorem. The denominator by default
is a batch means estimator, but the default can be changed with the 'method' argument.
</p>


<h3>Value</h3>

<p>The function returns the estimated effective sample size for each component of <code>g</code>.
</p>


<h3>References</h3>

<p>Gong, L. and Flegal, J. M. (2015) A practical sequential stopping rule for high-dimensional
Markov chain Monte Carlo, <em>Journal of Computational and Graphical Statistics</em>,  <b>25</b>, 684—700.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+minESS">minESS</a></code>, which calculates the minimum effective samples required for the problem.
<code><a href="#topic+multiESS">multiESS</a></code>, which calculates multivariate effective sample size using a Markov chain
and a function <code>g</code>.
</p>

<hr>
<h2 id='estvssamp'>Create a plot that shows how Monte Carlo estimates change with increasing sample size.</h2><span id='topic+estvssamp'></span>

<h3>Description</h3>

<p>Create a plot that shows how Monte Carlo estimates change with increasing sample size.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estvssamp(x, g = mean, main = "Estimates vs Sample Size", add = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="estvssamp_+3A_x">x</code></td>
<td>
<p>a sample vector.</p>
</td></tr>
<tr><td><code id="estvssamp_+3A_g">g</code></td>
<td>
<p>a function such that <code class="reqn">E(g(x))</code> is the quantity of interest. The default is <code>g =
<a href="base.html#topic+mean">mean</a></code>.</p>
</td></tr>
<tr><td><code id="estvssamp_+3A_main">main</code></td>
<td>
<p>an overall title for the plot. The default is &ldquo;<code>Estimates vs Sample
Size</code>&rdquo;.</p>
</td></tr>
<tr><td><code id="estvssamp_+3A_add">add</code></td>
<td>
<p>logical. If <code>TRUE</code>, add to a current plot.</p>
</td></tr>
<tr><td><code id="estvssamp_+3A_...">...</code></td>
<td>
<p>additional arguments to the plotting function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>NULL</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Bivariate Normal with mean (mu1, mu2) and covariance sigma
n &lt;- 1e3
mu &lt;- c(2, 50)
sigma &lt;- matrix(c(1, 0.5, 0.5, 1), nrow = 2)

out &lt;- BVN_Gibbs(n, mu, sigma)

estvssamp(out[,1], main = expression(E(x[1])))
</code></pre>

<hr>
<h2 id='is.mcmcse'>Check if the class of the object is mcmcse</h2><span id='topic+is.mcmcse'></span>

<h3>Description</h3>

<p>Check if the class of the object is mcmcse
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.mcmcse(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="is.mcmcse_+3A_x">x</code></td>
<td>
<p>The object that is checked to belong to the class mcmcse</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Boolean variable indicating if the input belongs to the class mcmcse
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Bivariate Normal with mean (mu1, mu2) and covariance sigma
n &lt;- 1e3
mu &lt;- c(2, 50)
sigma &lt;- matrix(c(1, 0.5, 0.5, 1), nrow = 2)

out &lt;- BVN_Gibbs(n, mu, sigma)
is.mcmcse(mcse.multi(out))

</code></pre>

<hr>
<h2 id='mcse'>Compute Monte Carlo standard errors for expectations.</h2><span id='topic+mcse'></span>

<h3>Description</h3>

<p>Compute Monte Carlo standard errors for expectations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mcse(x, size = NULL, g = NULL, r = 3,  method = "bm", warn = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mcse_+3A_x">x</code></td>
<td>
<p>a vector of values from a Markov chain of length n.</p>
</td></tr>
<tr><td><code id="mcse_+3A_size">size</code></td>
<td>
<p>represents the batch size in &ldquo;<code>bm</code>&rdquo; and the truncation point in &ldquo;<code>bartlett</code>&rdquo; and 
&ldquo;<code>tukey</code>&rdquo;. Default is <code>NULL</code> which implies that an optimal batch size is calculated using the 
<code>batchSize</code> function. Can take character values of &ldquo;<code>sqroot</code>&rdquo; and &ldquo;<code>cuberoot</code>&rdquo; or any numeric
value between 1 and n/2. &ldquo;<code>sqroot</code>&rdquo; means size is <code class="reqn">\lfloor n^{1/2} \rfloor</code> and &ldquo;<code>cuberoot</code>&rdquo; means size is
<code class="reqn">\lfloor n^{1/3} \rfloor</code>.</p>
</td></tr>
<tr><td><code id="mcse_+3A_g">g</code></td>
<td>
<p>a function such that <code class="reqn">E(g(x))</code> is the quantity of interest. The default is
<code>NULL</code>, which causes the identity function to be used.</p>
</td></tr>
<tr><td><code id="mcse_+3A_r">r</code></td>
<td>
<p>The lugsail parameters (<code>r</code>) that converts a lag window into its lugsail
equivalent. Larger values of <code>r</code> will typically imply less underestimation of &ldquo;<code>cov</code>&rdquo;,
but higher variability of the estimator. Default is <code>r = 3</code> and <code>r = 1,2</code> are
also good choices, but will likely underestimation of variance. <code>r &gt; 5</code> is not recommended.</p>
</td></tr>
<tr><td><code id="mcse_+3A_method">method</code></td>
<td>
<p>any of &ldquo;<code>bm</code>&rdquo;,&ldquo;<code>obm</code>&rdquo;,&ldquo;<code>bartlett</code>&rdquo;, &ldquo;<code>tukey</code>&rdquo;. &ldquo;<code>bm</code>&rdquo;
represents batch means estimator, &ldquo;<code>obm</code>&rdquo; represents overlapping batch means estimator with, &ldquo;<code>bartlett</code>&rdquo;
and &ldquo;<code>tukey</code>&rdquo; represents the modified-Bartlett window and the Tukey-Hanning windows for spectral variance estimators.</p>
</td></tr>
<tr><td><code id="mcse_+3A_warn">warn</code></td>
<td>
<p>a logical value indicating whether the function should issue a warning if the sample
size is too small (less than 1,000).</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>mcse</code> returns a list with three elements:
</p>
<table role = "presentation">
<tr><td><code>est</code></td>
<td>
<p>an estimate of <code class="reqn">E(g(x))</code>.</p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p>the Monte Carlo standard error.</p>
</td></tr>
<tr><td><code>nsim</code></td>
<td>
<p>The number of samples in the input Markov chain.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Flegal, J. M. (2012) Applicability of subsampling bootstrap methods in Markov chain Monte Carlo.
In Wozniakowski, H. and Plaskota, L., editors, <em>Monte Carlo and Quasi-Monte Carlo Methods
2010</em>, pp. 363-372. Springer-Verlag.
</p>
<p>Flegal, J. M. and Jones, G. L. (2010) Batch means and spectral variance estimators in Markov
chain Monte Carlo. <em>The Annals of Statistics</em>, <b>38</b>, 1034&ndash;1070.
</p>
<p>Flegal, J. M. and Jones, G. L. (2011) Implementing Markov chain Monte Carlo: Estimating with
confidence. In Brooks, S., Gelman, A., Jones, G. L., and Meng, X., editors, <em>Handbook of
Markov Chain Monte Carlo</em>, pages 175&ndash;197. Chapman &amp; Hall/CRC Press.
</p>
<p>Doss, C. R., Flegal, J. M., Jones, G. L., and Neath, R. C. (2014). Markov chain Monte Carlo estimation of quantiles. <em>Electronic Journal of Statistics</em>, <b>8</b>, 2448-2478.
Jones, G. L., Haran, M., Caffo, B. S. and Neath, R. (2006) Fixed-width output analysis for Markov
chain Monte Carlo. <em>Journal of the American Statistical Association</em>, <b>101</b>, 1537&ndash;154.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mcse.mat">mcse.mat</a></code>, which applies <code>mcse</code> to each column of a matrix or data frame.
</p>
<p><code><a href="#topic+mcse.multi">mcse.multi</a></code>, for a multivariate estimate of the Monte Carlo standard error.
</p>
<p><code><a href="#topic+mcse.q">mcse.q</a></code> and <code><a href="#topic+mcse.q.mat">mcse.q.mat</a></code>, which compute standard errors for quantiles.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Bivariate Normal with mean (mu1, mu2) and covariance sigma
n &lt;- 1e3
mu = c(2, 50)
sigma = matrix(c(1, 0.5, 0.5, 1), nrow = 2)
out = BVN_Gibbs(n, mu, sigma)
x = out[,1]
mcse(x)
mcse.q(x, 0.1)
mcse.q(x, 0.9)

# Estimate the mean, 0.1 quantile, and 0.9 quantile with MCSEs using overlapping batch means.

mcse(x, method = "obm")
mcse.q(x, 0.1, method = "obm")
mcse.q(x, 0.9, method = "obm")

# Estimate E(x^2) with MCSE using spectral methods.

g = function(x) { x^2 }
mcse(x, g = g, method = "tukey")

</code></pre>

<hr>
<h2 id='mcse.initseq'>Multivariate Monte Carlo standard errors for expectations with the initial sequence method of Dai
and Jones (2017)</h2><span id='topic+mcse.initseq'></span>

<h3>Description</h3>

<p>Function returns the estimate of the covariance matrix in the Markov Chain central limit theorem
using initial sequence method. This method is designed to give an asymptotically conservative
estimate of the Monte Carlo standard error.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mcse.initseq(x, g = NULL, adjust = FALSE, blather = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mcse.initseq_+3A_x">x</code></td>
<td>
<p>A matrix or data frame of Markov chain output. Number of rows is the Monte
Carlo sample size.</p>
</td></tr>
<tr><td><code id="mcse.initseq_+3A_g">g</code></td>
<td>
<p>A function that represents features of interest. <code>g</code> is applied to each row of x and
thus <code>g</code> should take a vector input only. If <code>g</code> is <code>NULL</code>, <code>g</code> is set to be identity, which
is estimation of the mean of the target density.</p>
</td></tr>
<tr><td><code id="mcse.initseq_+3A_adjust">adjust</code></td>
<td>
<p>Logical; if <code>TRUE</code>, an adjustment is made to increase slightly the eigenvalues of
the initial sequence estimator. The default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="mcse.initseq_+3A_blather">blather</code></td>
<td>
<p>if <code>TRUE</code>, outputs under the hood information about the function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list is returned with the following components,
</p>
<table role = "presentation">
<tr><td><code>cov</code></td>
<td>
<p>a covariance matrix estimate using intial sequence method.</p>
</td></tr>
<tr><td><code>cov.adj</code></td>
<td>
<p>a covariance matrix estimate using adjusted initial sequence method if the
input <code>adjust=TRUE</code>.</p>
</td></tr>
<tr><td><code>eigen_values</code></td>
<td>
<p>eigen values of the estimate cov.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>method used to calculate matrix cov.</p>
</td></tr>
<tr><td><code>est</code></td>
<td>
<p>estimate of g(x).</p>
</td></tr>
<tr><td><code>nsim</code></td>
<td>
<p>number of rows of the input x. Only if <code>blather = TRUE</code>.</p>
</td></tr>
<tr><td><code>Adjustment_Used</code></td>
<td>
<p>logical of whether an adjustment was made to the initial sequence estimator.
Only if <code>blather = TRUE</code>.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Dai, N and Jones, G.L. (2017)  Multivariate initial sequence estimators in Markov chain Monte Carlo, 
<em> Journal of Multivariate Analysis</em>, <b>159</b>, 184-199.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mcse">mcse</a></code>, which acts on a vector. 
<code><a href="#topic+mcse.mat">mcse.mat</a></code>, which applies <code>mcse</code> to each
column of a matrix or data frame. 
<code><a href="#topic+mcse.q">mcse.q</a></code> and <code><a href="#topic+mcse.q.mat">mcse.q.mat</a></code>, which compute standard errors for quantiles. 
<code>mcse.multi</code>, which estimates the covariance matrix in the
Markov Chain CLT using batch means or spectral variance methods.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Bivariate Normal with mean (mu1, mu2) and covariance sigma
n &lt;- 1e3
mu &lt;- c(2, 50)
sigma &lt;- matrix(c(1, 0.5, 0.5, 1), nrow = 2)
out &lt;- BVN_Gibbs(n, mu, sigma)

out.mcse &lt;- mcse.initseq(x = out)
out.mcse.adj &lt;- mcse.initseq(x = out, adjust = TRUE)

# If we are only estimating the mean of the first component,
# and the second moment of the second component
g &lt;- function(x) return(c(x[1], x[2]^2))
out.g.mcse &lt;- mcse.initseq(x = out, g = g)

</code></pre>

<hr>
<h2 id='mcse.mat'>Apply <code>mcse</code> to each column of the MCMC samples.</h2><span id='topic+mcse.mat'></span>

<h3>Description</h3>

<p>Apply <code>mcse</code> to each column of the MCMC samples.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mcse.mat(x, size = NULL, g = NULL, method = "bm", r = 3)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mcse.mat_+3A_x">x</code></td>
<td>
<p>a matrix of values from a Markov chain of size n x p.</p>
</td></tr>
<tr><td><code id="mcse.mat_+3A_size">size</code></td>
<td>
<p>represents the batch size in &ldquo;<code>bm</code>&rdquo; and the truncation point in &ldquo;<code>bartlett</code>&rdquo; and 
&ldquo;<code>tukey</code>&rdquo;. Default is <code>NULL</code> which implies that an optimal batch size is calculated using the 
<code>batchSize</code> function. Can take character values of &ldquo;<code>sqroot</code>&rdquo; and &ldquo;<code>cuberoot</code>&rdquo; or any numeric
value between 1 and n/2. &ldquo;<code>sqroot</code>&rdquo; means size is <code class="reqn">\lfloor n^{1/2} \rfloor</code> and &ldquo;<code>cuberoot</code>&rdquo; means size is
<code class="reqn">\lfloor n^{1/3} \rfloor</code>.</p>
</td></tr>
<tr><td><code id="mcse.mat_+3A_g">g</code></td>
<td>
<p>a function such that <code class="reqn">E(g(x))</code> is the quantity of interest. The default is
<code>NULL</code>, which causes the identity function to be used.</p>
</td></tr>
<tr><td><code id="mcse.mat_+3A_method">method</code></td>
<td>
<p>any of &ldquo;<code>bm</code>&rdquo;,&ldquo;<code>obm</code>&rdquo;,&ldquo;<code>bartlett</code>&rdquo;, &ldquo;<code>tukey</code>&rdquo;. &ldquo;<code>bm</code>&rdquo;
represents batch means estimator, &ldquo;<code>obm</code>&rdquo; represents overlapping batch means estimator with, &ldquo;<code>bartlett</code>&rdquo;
and &ldquo;<code>tukey</code>&rdquo; represents the modified-Bartlett window and the Tukey-Hanning windows for spectral variance estimators.</p>
</td></tr>
<tr><td><code id="mcse.mat_+3A_r">r</code></td>
<td>
<p>The lugsail parameters (<code>r</code>) that converts a lag window into its lugsail
equivalent. Larger values of <code>r</code> will typically imply less underestimation of &ldquo;<code>cov</code>&rdquo;,
but higher variability of the estimator. Default is <code>r = 3</code> and <code>r = 1,2</code> are
also good choices although may lead to underestimates of the variance. <code>r &gt; 5</code> is not recommended.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>mcse.mat</code> returns a matrix with <code>ncol(x)</code> rows and two columns. The row names
of the matrix are the same as the column names of <code>x</code>. The column names of the matrix are
&ldquo;<code>est</code>&rdquo; and &ldquo;<code>se</code>&rdquo;. The <code class="reqn">j</code>th row of the matrix contains the result
of applying <code>mcse</code> to the <code class="reqn">j</code>th column of <code>x</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mcse">mcse</a></code>, which acts on a vector.
</p>
<p><code><a href="#topic+mcse.multi">mcse.multi</a></code>, for a multivariate estimate of the Monte Carlo standard error.
</p>
<p><code><a href="#topic+mcse.q">mcse.q</a></code> and <code><a href="#topic+mcse.q.mat">mcse.q.mat</a></code>, which compute standard errors for quantiles.
</p>

<hr>
<h2 id='mcse.multi'>Multivariate Monte Carlo standard errors for expectations.</h2><span id='topic+mcse.multi'></span>

<h3>Description</h3>

<p>Function returns the estimate of the covariance matrix in the Markov Chain CLT using batch means
or spectral variance methods (with different lag windows). The function also returns the Monte
Carlo estimate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mcse.multi(x, method = "bm", r = 3, size = NULL, g = NULL,  
                  adjust = TRUE, blather = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mcse.multi_+3A_x">x</code></td>
<td>
<p>A matrix or data frame of Markov chain output. Number of rows is the Monte
Carlo sample size.</p>
</td></tr>
<tr><td><code id="mcse.multi_+3A_method">method</code></td>
<td>
<p>Any of &ldquo;<code>bm</code>&rdquo;,&ldquo;<code>obm</code>&rdquo;,&ldquo;<code>bartlett</code>&rdquo;,&ldquo;<code>tukey</code>&rdquo;. &ldquo;<code>bm</code>&rdquo;
represents batch means estimator, &ldquo;<code>obm</code>&rdquo; represents the overlapping batch means estimator,
and &ldquo;<code>bartlett</code>&rdquo; and &ldquo;<code>tukey</code>&rdquo; represent the modified-Bartlett window and
the Tukey-Hanning windows for the spectral variance estimators.</p>
</td></tr>
<tr><td><code id="mcse.multi_+3A_r">r</code></td>
<td>
<p>The lugsail parameters (<code>r</code>) that converts a lag window into its lugsail
equivalent. Larger values of <code>r</code> will typically imply less underestimation of &ldquo;<code>cov</code>&rdquo;,
but higher variability of the estimator. Default is <code>r = 3</code> and <code>r = 1,2</code> are
good choices. <code>r &gt; 5</code> is not recommended.</p>
</td></tr>
<tr><td><code id="mcse.multi_+3A_size">size</code></td>
<td>
<p>Represents the batch size in &ldquo;<code>bm</code>&rdquo; and the truncation point in &ldquo;<code>bartlett</code>&rdquo; and
&ldquo;<code>tukey</code>&rdquo;. Default is <code>NULL</code> which implies that an optimal batch size is calculated
using the <code>batchSize</code> function. Can take character values of &ldquo;<code>sqroot</code>&rdquo; and
&ldquo;<code>cuberoot</code>&rdquo; or any numeric value between 1 and n/2. &ldquo;<code>sqroot</code>&rdquo; means
size is floor(n^(1/2)) and &ldquo;<code>cuberoot</code>&rdquo; means size is floor(n^(1/3)).</p>
</td></tr>
<tr><td><code id="mcse.multi_+3A_g">g</code></td>
<td>
<p>A function that represents features of interest. <code>g</code> is applied to each row of <code>x</code> and
thus <code>g</code> should take a vector input only. If <code>g</code> is <code>NULL</code>, <code>g</code> is set to be identity, which
is estimation of the mean of the target density.</p>
</td></tr>
<tr><td><code id="mcse.multi_+3A_adjust">adjust</code></td>
<td>
<p>Defaults to <code>TRUE</code>. logical for whether the matrix should automatically be adjusted if unstable.</p>
</td></tr>
<tr><td><code id="mcse.multi_+3A_blather">blather</code></td>
<td>
<p>If <code>TRUE</code>, returns under-the-hood workings of the package.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list is returned with the following components,
</p>
<table role = "presentation">
<tr><td><code>cov</code></td>
<td>
<p>a covariance matrix estimate.</p>
</td></tr>
<tr><td><code>est</code></td>
<td>
<p>estimate of g(x).</p>
</td></tr>
<tr><td><code>nsim</code></td>
<td>
<p>number of rows of the input x.</p>
</td></tr>
<tr><td><code>eigen_values</code></td>
<td>
<p>eigen values of the estimate cov.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>method used to calculate matrix cov.</p>
</td></tr>
<tr><td><code>size</code></td>
<td>
<p>value of size used to calculate cov.</p>
</td></tr>
<tr><td><code>Adjustment_Used</code></td>
<td>
<p>whether an adjustment was used to calculate cov.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Vats, D., Flegal, J. M., and, Jones, G. L Multivariate output analysis for Markov chain Monte Carlo, 
<em>Biometrika</em>, <b>106</b>, 321–-337.
</p>
<p>Vats, D., Flegal, J. M., and, Jones, G. L. (2018) Strong Consistency of multivariate spectral variance 
estimators for Markov chain Monte Carlo, <em>Bernoulli</em>, <b>24</b>, 1860–-1909.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+batchSize">batchSize</a></code>, which computes an optimal batch size. 
<code><a href="#topic+mcse.initseq">mcse.initseq</a></code>, which computes an initial sequence estimator.
<code><a href="#topic+mcse">mcse</a></code>, which acts on a vector. 
<code><a href="#topic+mcse.mat">mcse.mat</a></code>, which applies mcse to each column of a matrix or data frame. 
<code><a href="#topic+mcse.q">mcse.q</a></code> and <code><a href="#topic+mcse.q.mat">mcse.q.mat</a></code>, which compute standard
errors for quantiles.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Bivariate Normal with mean (mu1, mu2) and covariance sigma
n &lt;- 1e3
mu &lt;- c(2, 50)
sigma &lt;- matrix(c(1, 0.5, 0.5, 1), nrow = 2)
out &lt;- BVN_Gibbs(n, mu, sigma)

mcse.bm &lt;- mcse.multi(x = out)
mcse.tuk &lt;- mcse.multi(x = out, method = "tukey")

# If we are only estimating the mean of the first component,
# and the second moment of the second component

g &lt;- function(x) return(c(x[1], x[2]^2))
mcse &lt;- mcse.multi(x = out, g = g)
</code></pre>

<hr>
<h2 id='mcse.q'>Compute Monte Carlo standard errors for quantiles.</h2><span id='topic+mcse.q'></span>

<h3>Description</h3>

<p>Compute Monte Carlo standard errors for quantiles.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mcse.q(x, q, size = NULL, g = NULL, method = c("bm", "obm", "sub"), warn = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mcse.q_+3A_x">x</code></td>
<td>
<p>a vector of values from a Markov chain.</p>
</td></tr>
<tr><td><code id="mcse.q_+3A_q">q</code></td>
<td>
<p>the quantile of interest.</p>
</td></tr>
<tr><td><code id="mcse.q_+3A_size">size</code></td>
<td>
<p>the batch size. The default value is &ldquo;<code>sqroot</code>&rdquo;, which uses the square
root of the sample size. A numeric value may be provided if &ldquo;<code>sqroot</code>&rdquo; is not
satisfactory.</p>
</td></tr>
<tr><td><code id="mcse.q_+3A_g">g</code></td>
<td>
<p>a function such that the <code class="reqn">q</code>th quantile of the univariate distribution function of
<code class="reqn">g(x)</code> is the quantity of interest. The default is <code>NULL</code>, which causes the identity
function to be used.</p>
</td></tr>
<tr><td><code id="mcse.q_+3A_method">method</code></td>
<td>
<p>the method used to compute the standard error. This is one of &ldquo;<code>bm</code>&rdquo;
(batch means, the default), &ldquo;<code>obm</code>&rdquo; (overlapping batch means), or
&ldquo;<code>sub</code>&rdquo; (subsampling bootstrap).</p>
</td></tr>
<tr><td><code id="mcse.q_+3A_warn">warn</code></td>
<td>
<p>a logical value indicating whether the function should issue a warning if the sample
size is too small (less than 1,000).</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>mcse.q</code> returns a list with three elements:
</p>
<table role = "presentation">
<tr><td><code>est</code></td>
<td>
<p>an estimate of the <code class="reqn">q</code>th quantile of the univariate distribution function of <code class="reqn">g(x)</code>.</p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p>the Monte Carlo standard error.</p>
</td></tr>
<tr><td><code>nsim</code></td>
<td>
<p>The number of samples in the input Markov chain.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Flegal, J. M. (2012) Applicability of subsampling bootstrap methods in Markov chain Monte Carlo.
In Wozniakowski, H. and Plaskota, L., editors, <em>Monte Carlo and Quasi-Monte Carlo Methods
2010</em> (to appear). Springer-Verlag.
</p>
<p>Flegal, J. M. and Jones, G. L. (2010) Batch means and spectral variance estimators in Markov
chain Monte Carlo. <em>The Annals of Statistics</em>, <b>38</b>, 1034&ndash;1070.
</p>
<p>Flegal, J. M. and Jones, G. L. (2011) Implementing Markov chain Monte Carlo: Estimating with
confidence. In Brooks, S., Gelman, A., Jones, G. L., and Meng, X., editors, <em>Handbook of
Markov Chain Monte Carlo</em>, pages 175&ndash;197. Chapman &amp; Hall/CRC Press.
</p>
<p>Doss, C. R., Flegal, J. M., Jones, G. L., and Neath, R. C. (2014). Markov chain Monte Carlo estimation of quantiles. <em>Electronic Journal of Statistics</em>, <b>8</b>, 2448-2478.
Jones, G. L., Haran, M., Caffo, B. S. and Neath, R. (2006) Fixed-width output analysis for Markov
chain Monte Carlo. <em>Journal of the American Statistical Association</em>, <b>101</b>, 1537&ndash;154
.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mcse.q.mat">mcse.q.mat</a></code>, which applies <code>mcse.q</code> to each column of a matrix or data frame.
</p>
<p><code><a href="#topic+mcse">mcse</a></code> and <code><a href="#topic+mcse.mat">mcse.mat</a></code>, which compute standard errors for expectations.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Bivariate Normal with mean (mu1, mu2) and covariance sigma
n &lt;- 1e3
mu &lt;- c(2, 50)
sigma &lt;- matrix(c(1, 0.5, 0.5, 1), nrow = 2)
out &lt;- BVN_Gibbs(n, mu, sigma)
x &lt;- out[,1]

# Estimate the mean, 0.1 quantile, and 0.9 quantile with MCSEs using batch means.

mcse(x)
mcse.q(x, 0.1)
mcse.q(x, 0.9)

# Estimate the mean, 0.1 quantile, and 0.9 quantile with MCSEs using overlapping batch means.

mcse(x, method = "obm")
mcse.q(x, 0.1, method = "obm")
mcse.q(x, 0.9, method = "obm")

# Estimate E(x^2) with MCSE using spectral methods.

g &lt;- function(x) { x^2 }
mcse(x, g = g, method = "tukey")

</code></pre>

<hr>
<h2 id='mcse.q.mat'>Apply <code>mcse.q</code> to each column of a matrix or data frame of MCMC samples.</h2><span id='topic+mcse.q.mat'></span>

<h3>Description</h3>

<p>Apply <code>mcse.q</code> to each column of a matrix or data frame of MCMC samples.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mcse.q.mat(x, q, size = NULL, g = NULL, method = c("bm", "obm", "sub"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mcse.q.mat_+3A_x">x</code></td>
<td>
<p>a matrix or data frame with each row being a draw from the multivariate distribution of
interest.</p>
</td></tr>
<tr><td><code id="mcse.q.mat_+3A_q">q</code></td>
<td>
<p>the quantile of interest.</p>
</td></tr>
<tr><td><code id="mcse.q.mat_+3A_size">size</code></td>
<td>
<p>the batch size. The default value is &ldquo;<code>sqroot</code>&rdquo;, which uses the square
root of the sample size. &ldquo;<code>cuberoot</code>&rdquo; will cause the function to use the cube root
of the sample size. A numeric value may be provided if &ldquo;<code>sqroot</code>&rdquo; is not
satisfactory.</p>
</td></tr>
<tr><td><code id="mcse.q.mat_+3A_g">g</code></td>
<td>
<p>a function such that the <code class="reqn">q</code>th quantile of the univariate distribution function of
<code class="reqn">g(x)</code> is the quantity of interest. The default is <code>NULL</code>, which causes the identity
function to be used.</p>
</td></tr>
<tr><td><code id="mcse.q.mat_+3A_method">method</code></td>
<td>
<p>the method used to compute the standard error. This is one of &ldquo;<code>bm</code>&rdquo;
(batch means, the default), &ldquo;<code>obm</code>&rdquo; (overlapping batch means), or
&ldquo;<code>sub</code>&rdquo; (subsampling bootstrap).</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>mcse.q.mat</code> returns a matrix with <code>ncol(x)</code> rows and two columns. The row
names of the matrix are the same as the column names of <code>x</code>. The column names of the
matrix are &ldquo;<code>est</code>&rdquo; and &ldquo;<code>se</code>&rdquo;. The <code class="reqn">j</code>th row of the matrix contains
the result of applying <code>mcse.q</code> to the <code class="reqn">j</code>th column of <code>x</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mcse.q">mcse.q</a></code>, which acts on a vector.
</p>
<p><code><a href="#topic+mcse">mcse</a></code> and <code><a href="#topic+mcse.mat">mcse.mat</a></code>, which compute standard errors for expectations.
</p>

<hr>
<h2 id='minESS'>Minimum effective sample size required for stable estimation as described in Vats et al. (2015)</h2><span id='topic+minESS'></span>

<h3>Description</h3>

<p>The function calculates the minimum effective sample size required for a specified relative
tolerance level. This function can also calculate the relative precision in estimation for a given
estimated effective sample size.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>minESS(p, alpha = .05, eps = .05, ess = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="minESS_+3A_p">p</code></td>
<td>
<p>dimension of the estimation problem.</p>
</td></tr>
<tr><td><code id="minESS_+3A_alpha">alpha</code></td>
<td>
<p>Confidence level.</p>
</td></tr>
<tr><td><code id="minESS_+3A_eps">eps</code></td>
<td>
<p>Tolerance level. The eps value is ignored is <code>ess</code> is not <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="minESS_+3A_ess">ess</code></td>
<td>
<p>Estimated effective sample size. Usually the output value from <code>multiESS</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The minimum effective samples required when estimating a vector of length <code>p</code>, with <code class="reqn">100(
1-\alpha)\%</code> confidence and tolerance of <code class="reqn">\epsilon</code> is </p>
<p style="text-align: center;"><code class="reqn">mESS \geq \frac{2^{2/p} \pi}{(p
\Gamma(p/2))^{2/p}} \frac{\chi^{2}_{1-\alpha,p}}{\epsilon^{2}}.</code>
</p>

<p>The above equality can also be used to get <code class="reqn">\epsilon</code> from an already obtained estimate of
mESS.
</p>


<h3>Value</h3>

<p>By default function returns the minimum effective sample required for a given eps
tolerance. If <code>ess</code> is specified, then the value returned is the <code>eps</code> corresponding to that <code>ess</code>.
</p>


<h3>References</h3>

<p>Gong, L., and Flegal, J. M. A practical sequential stopping rule for high-dimensional Markov chain Monte Carlo. 
<em>Journal of Computational and Graphical Statistics</em>, <b>25</b>,  684–-700.
</p>
<p>Vats, D., Flegal, J. M., and, Jones, G. L Multivariate output analysis for Markov chain Monte Carlo, 
<em>Biometrika</em>, <b>106</b>, 321–-337.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+multiESS">multiESS</a></code>, which calculates multivariate effective sample size using a
Markov chain and a function g.
<code><a href="#topic+ess">ess</a></code> which calculates univariate effective sample size using a Markov chain and a
function g.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>minESS(p = 5)

</code></pre>

<hr>
<h2 id='multiESS'>Effective Sample Size of a multivariate Markov chain as described in Vats et al. (2015).</h2><span id='topic+multiESS'></span>

<h3>Description</h3>

<p>Calculate the effective sample size of the Markov chain, using the multivariate dependence
structure of the process.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multiESS(x, covmat = NULL, g = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="multiESS_+3A_x">x</code></td>
<td>
<p>a matrix or data frame of Markov chain output. Number of rows is the Monte Carlo sample
size.</p>
</td></tr>
<tr><td><code id="multiESS_+3A_covmat">covmat</code></td>
<td>
<p>optional matrix estimate obtained using <code>mcse.multi</code> or <code>mcse.initseq</code>.</p>
</td></tr>
<tr><td><code id="multiESS_+3A_g">g</code></td>
<td>
<p>a function that represents features of interest. <code>g</code> is applied to each row of <code>x</code> and
thus <code>g</code> should take a vector input only. If <code>g</code> is <code>NULL</code>, <code>g</code> is set to be identity, which
is estimation of the mean of the target density.</p>
</td></tr>
<tr><td><code id="multiESS_+3A_...">...</code></td>
<td>
<p>arguments for <code>mcse.multi</code> function. Don't use this if a suitable matrix estimate
from <code>mcse.multi</code> or <code>mcse.initseq</code> is already obtained.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Effective sample size is the size of an iid sample with the same variance as the current sample.
ESS is given by </p>
<p style="text-align: center;"><code class="reqn">ESS = n\frac{|\Lambda|^{1/p}}{|\Sigma|^{1/p}},</code>
</p>
<p> where <code class="reqn">\Lambda</code> is the
sample covariance matrix for <code>g</code> and <code class="reqn">\Sigma</code> is an estimate of the Monte Carlo standard
error for <code>g</code>.
</p>


<h3>Value</h3>

<p>The function returns the estimated effective sample size.
</p>


<h3>References</h3>

<p>Vats, D., Flegal, J. M., and, Jones, G. L Multivariate output analysis for Markov chain Monte Carlo, 
<em>Biometrika</em>, <b>106</b>, 321–-337.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+minESS">minESS</a></code>, which calculates the minimum effective samples required for the
problem.
<code><a href="#topic+ess">ess</a></code> which calculates univariate effective sample size using a Markov chain and a
function g.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Bivariate Normal with mean (mu1, mu2) and covariance sigma
n &lt;- 1e3
mu &lt;- c(2, 50)
sigma &lt;- matrix(c(1, 0.5, 0.5, 1), nrow = 2)
out &lt;- BVN_Gibbs(n, mu, sigma)

multiESS(out)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
