<!DOCTYPE html><html><head><title>Help for package rdacca.hp</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {rdacca.hp}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#creatbin'><p>Internal function for rdacca.hp() to create diagonal matrix</p></a></li>
<li><a href='#genList'><p>Internal function for rdacca.hp()</p></a></li>
<li><a href='#odd'><p>Internal function for rdacca.hp() to determine whether the odd number</p></a></li>
<li><a href='#permu.hp'><p>Permutation Test of Hierarchical Partitioning for Canonical Analysis</p></a></li>
<li><a href='#plot.rdaccahp'><p>Plot for a <code>rdacca.hp</code> object</p></a></li>
<li><a href='#rdacca.hp'><p>Hierarchical and Variation Partitioning for Canonical Analysis Without Limiting the Number of Predictors (Matrices)</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Hierarchical and Variation Partitioning for Canonical Analysis</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1-0</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-5-23</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.4.0),vegan,ggplot2</td>
</tr>
<tr>
<td>Author:</td>
<td>Jiangshan Lai,Yao Liu,Pedro Peres-Neto,Kim Nimon</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jiangshan Lai &lt;lai@njfu.edu.cn&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>This function conducts variation partitioning and hierarchical partitioning to calculate the unique, shared (referred as to "common") and individual contributions of each predictor (or matrix) towards explained variation (R-square and adjusted R-square) on canonical analysis (RDA,CCA and db-RDA), applying the algorithm of Lai J.,Zou Y., Zhang J.,Peres-Neto P.(2022) Generalizing hierarchical and variation partitioning in multiple regression and canonical analyses using the rdacca.hp R package.Methods in Ecology and Evolution,13: 782-788 &lt;<a href="https://doi.org/10.1111%2F2041-210X.13800">doi:10.1111/2041-210X.13800</a>&gt;. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/laijiangshan/rdacca.hp">https://github.com/laijiangshan/rdacca.hp</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-05-23 08:30:49 UTC; janson</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-05-23 09:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='creatbin'>Internal function for rdacca.hp() to create diagonal matrix</h2><span id='topic+creatbin'></span>

<h3>Description</h3>

<p>Internal function for rdacca.hp() to create diagonal matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>creatbin(col, binmatrix)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="creatbin_+3A_col">col</code></td>
<td>
<p>Imput number.</p>
</td></tr>
<tr><td><code id="creatbin_+3A_binmatrix">binmatrix</code></td>
<td>
<p>Imput empty matrix.</p>
</td></tr>
</table>

<hr>
<h2 id='genList'>Internal function for rdacca.hp()</h2><span id='topic+genList'></span>

<h3>Description</h3>

<p>Internal function for rdacca.hp()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>genList(ivlist, value)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="genList_+3A_ivlist">ivlist</code></td>
<td>
<p>The names of explanatory variable.</p>
</td></tr>
<tr><td><code id="genList_+3A_value">value</code></td>
<td>
<p>The sequence ID.</p>
</td></tr>
</table>

<hr>
<h2 id='odd'>Internal function for rdacca.hp() to determine whether the odd number</h2><span id='topic+odd'></span>

<h3>Description</h3>

<p>Internal function for rdacca.hp() to determine whether the odd number
</p>


<h3>Usage</h3>

<pre><code class='language-R'>odd(val)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="odd_+3A_val">val</code></td>
<td>
<p>Imput number.</p>
</td></tr>
</table>

<hr>
<h2 id='permu.hp'>Permutation Test of Hierarchical Partitioning for Canonical Analysis</h2><span id='topic+permu.hp'></span>

<h3>Description</h3>

<p>Permutation Test of Hierarchical Partitioning for Canonical Analysis
</p>


<h3>Usage</h3>

<pre><code class='language-R'>permu.hp(
  dv,
  iv,
  method = c("RDA", "dbRDA", "CCA"),
  type = c("adjR2", "R2"),
  scale = FALSE,
  add = FALSE,
  sqrt.dist = FALSE,
  n.perm = 1000,
  permutations = 1000
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="permu.hp_+3A_dv">dv</code></td>
<td>
<p>Response variable, either a numeric vector or a matrix. If method=&quot;dbRDA&quot;, dv should be a &quot;dist&quot; matrix.</p>
</td></tr>
<tr><td><code id="permu.hp_+3A_iv">iv</code></td>
<td>
<p>Predictors (explanatory variable), either a data frame or a list of data frames. If it is a data frame, the relative importance of each column of the data frame will be evaluated; if it is a list, the relative importance of each element (matrix) will be evaluated.</p>
</td></tr>
<tr><td><code id="permu.hp_+3A_method">method</code></td>
<td>
<p>Type of canonical analysis used for variation partitioning, should be a character string, either &quot;RDA&quot;, &quot;dbRDA&quot; or &quot;CCA&quot;, the default is &quot;RDA&quot;. If the response variable (dv) is a numerical vector and method=&quot;RDA&quot;, the hierarchical and variation partitioning for the classical multiple regression is implemented.</p>
</td></tr>
<tr><td><code id="permu.hp_+3A_type">type</code></td>
<td>
<p>The type of total explained variation, either &quot;R2&quot; or &quot;adjR2&quot;, in which &quot;R2&quot; is unadjusted R-square and &quot;adjR2&quot; is adjusted R-square, the default is &quot;adjR2&quot;. The adjusted R-square is calculated using Ezekiel's formula (Ezekiel 1930) for RDA and dbRDA, while permutation procedure is used for CCA (Peres-Neto et al. 2006).</p>
</td></tr>
<tr><td><code id="permu.hp_+3A_scale">scale</code></td>
<td>
<p>Logical; If the columns of dv should be standardized to unit variance when method=&quot;RDA&quot; is applied.</p>
</td></tr>
<tr><td><code id="permu.hp_+3A_add">add</code></td>
<td>
<p>Logical; If a constant should be added to the non-diagonal values to euclidify dissimilarities (see dbrda function in vegan for details). Choice &quot;lingoes&quot; (or TRUE) uses the recommended method of Legendre &amp; Anderson (1999: &quot;method 1&quot;) and &quot;cailliez&quot; uses their &quot;method 2&quot;. The argument has an effect only when method=&quot;dbRDA&quot;.</p>
</td></tr>
<tr><td><code id="permu.hp_+3A_sqrt.dist">sqrt.dist</code></td>
<td>
<p>Logical, If the square root of dissimilarities should be taken. This often euclidifies dissimilarities. The argument has an effect only when method=&quot;dbRDA&quot;(see dbrda function in vegan for details).</p>
</td></tr>
<tr><td><code id="permu.hp_+3A_n.perm">n.perm</code></td>
<td>
<p>An integer; Number of permutations for computing the adjusted R-square for CCA. The argument has an effect only when method=&quot;CCA&quot;.</p>
</td></tr>
<tr><td><code id="permu.hp_+3A_permutations">permutations</code></td>
<td>
<p>An integer; Number of permutations for computing p value of individual contribution for the randomized dataset.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is a permutation test of hierarchical partitioning for canonical analysis. It returns a matrix of I values (the individual contribution towards total explained variation) for all values from permutations randomizations. For each permutation, the values in each variable (i.e each column of iv) are randomized independently, and rdacca.hp is run on the randomized iv. As well as the randomized I matrix, the function returns a summary table listing the observed I values, the p value of I for the randomized dataset.
</p>


<h3>Value</h3>

<p>a data.frame containing a summary table listing the observed individual contribution, the p value of individual contribution for the randomized dataset
</p>


<h3>Author(s)</h3>

<p>Jiangshan Lai <a href="mailto:lai@ibcas.ac.cn">lai@ibcas.ac.cn</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(vegan)
data(mite)
data(mite.env)
#Hellinger-transform the species dataset for RDA
mite.hel &lt;- decostand(mite, "hellinger")
permu.hp(mite.hel,mite.env,method="RDA",type="adjR2",permutations=10)
</code></pre>

<hr>
<h2 id='plot.rdaccahp'>Plot for a <code><a href="#topic+rdacca.hp">rdacca.hp</a></code> object</h2><span id='topic+plot.rdaccahp'></span>

<h3>Description</h3>

<p>Plot for a <code><a href="#topic+rdacca.hp">rdacca.hp</a></code> object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rdaccahp'
plot(x, plot.perc = FALSE, color = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.rdaccahp_+3A_x">x</code></td>
<td>
<p>A <code><a href="#topic+rdacca.hp">rdacca.hp</a></code> object.</p>
</td></tr>
<tr><td><code id="plot.rdaccahp_+3A_plot.perc">plot.perc</code></td>
<td>
<p>Logical;if TRUE, the bar plot (based on ggplot2 package) of the percentage to individual effects of variables or groups towards total explained variation, the default is FALSE to show plot with original individual effects.</p>
</td></tr>
<tr><td><code id="plot.rdaccahp_+3A_color">color</code></td>
<td>
<p>Color of variables.</p>
</td></tr>
<tr><td><code id="plot.rdaccahp_+3A_...">...</code></td>
<td>
<p>unused</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a ggplot object
</p>


<h3>Author(s)</h3>

<p>Jiangshan Lai <a href="mailto:lai@njfu.edu.cn">lai@njfu.edu.cn</a>
</p>
<p>Yao Liu <a href="mailto:liuyao@stu.xmu.edu.cn">liuyao@stu.xmu.edu.cn</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(vegan)
data(mite)
data(mite.env)
mite.hel &lt;- decostand(mite, "hellinger")
avc&lt;-rdacca.hp(mite.hel,mite.env,method="RDA",type="adjR2")
plot(avc)
plot(avc, plot.perc=TRUE)
avc&lt;-rdacca.hp(mite.hel,mite.env[,1:3],method="RDA",type="adjR2",var.part=TRUE)
plot(avc,color = c("#8DD3C7", "#FFFFB3", "#BEBADA"))
</code></pre>

<hr>
<h2 id='rdacca.hp'>Hierarchical and Variation Partitioning for Canonical Analysis Without Limiting the Number of Predictors (Matrices)</h2><span id='topic+rdacca.hp'></span>

<h3>Description</h3>

<p>Hierarchical and Variation Partitioning for Canonical Analysis Without Limiting the Number of Predictors (Matrices)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rdacca.hp(
  dv,
  iv,
  method = c("RDA", "dbRDA", "CCA"),
  type = c("adjR2", "R2"),
  scale = FALSE,
  add = FALSE,
  sqrt.dist = FALSE,
  n.perm = 1000,
  var.part = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rdacca.hp_+3A_dv">dv</code></td>
<td>
<p>Response variable, either a numeric vector, matrix or data frame. If method=&quot;dbRDA&quot;, dv should be of class &quot;dist&quot;.</p>
</td></tr>
<tr><td><code id="rdacca.hp_+3A_iv">iv</code></td>
<td>
<p>Predictorsrepresented in either a data frame or a list of data frames. If it is a data frame, the relative importance of each column of the data frame will be evaluated; if it is a list, the relative importance of each element (matrix) will be evaluated.</p>
</td></tr>
<tr><td><code id="rdacca.hp_+3A_method">method</code></td>
<td>
<p>Type of canonical analysis to be performed, should be a character string, either &quot;RDA&quot;, &quot;dbRDA&quot; or &quot;CCA&quot;, the default is &quot;RDA&quot;. If the response variable (dv) is a numerical vector and method=&quot;RDA&quot;, the hierarchical and variation partitioning for the classical multiple regression is implemented.If response variable (dv) is of class &quot;dist&quot;, &quot;dbRDA&quot; will be chosen automatically.</p>
</td></tr>
<tr><td><code id="rdacca.hp_+3A_type">type</code></td>
<td>
<p>The type of total explained variation, either &quot;R2&quot; or &quot;adjR2&quot;, in which &quot;R2&quot; is unadjusted R-square and &quot;adjR2&quot; is adjusted R-square, the default is &quot;adjR2&quot;. The adjusted R-square is calculated using Ezekiel's formula (Ezekiel 1930) for RDA and dbRDA, while permutation procedure is used for CCA (Peres-Neto et al. 2006).</p>
</td></tr>
<tr><td><code id="rdacca.hp_+3A_scale">scale</code></td>
<td>
<p>Logical; If the columns of dv should be standardized to unit variance when method=&quot;RDA&quot; is applied.</p>
</td></tr>
<tr><td><code id="rdacca.hp_+3A_add">add</code></td>
<td>
<p>Logical; Specifies whether a constant should be added to the non-diagonal values to euclidify dissimilarities (see dbrda function in vegan for details). Choice &quot;lingoes&quot; (or TRUE) uses the recommended method of Legendre &amp; Anderson (1999: &quot;method 1&quot;) and &quot;cailliez&quot; uses their &quot;method 2&quot;. The argument has an effect only when method=&quot;dbRDA&quot;.</p>
</td></tr>
<tr><td><code id="rdacca.hp_+3A_sqrt.dist">sqrt.dist</code></td>
<td>
<p>Logical, Specifies whether the square root of dissimilarities should be taken. This often euclidifies dissimilarities. The argument has an effect only when method=&quot;dbRDA&quot;(see dbrda function in vegan for details).</p>
</td></tr>
<tr><td><code id="rdacca.hp_+3A_n.perm">n.perm</code></td>
<td>
<p>Integer; Number of permutations for computing the adjusted R-square for CCA. The argument has an effect only when method=&quot;CCA&quot;.</p>
</td></tr>
<tr><td><code id="rdacca.hp_+3A_var.part">var.part</code></td>
<td>
<p>Logical; If TRUE, the result of variation partitioning (2^N-1 fractions for N predictors or matrices) is shown, the default is FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function conducts variation partitioning and hierarchical partitioning to calculate the unique, average shared (referred as to &quot;common&quot;) and individual contributions of each predictor (or matrix) towards explained variation (R-square) on canonical analysis (RDA,CCA and dbRDA).
Variation partitioning should be conducted before hierarchical partitioning. The former emphasizes unique and common variation among predictors, the latter emphasizes the overall importance of each predictor (or group of predictors). This function simultaneously implements variation and hierarchical partitioning for single- and multiple-response models without limiting in the number of predictors / matrices of predictors.
</p>


<h3>Value</h3>

<p>a list containing
</p>
<table>
<tr><td><code>Method_Type</code></td>
<td>
<p>The type of canonical analysis and whether the raw or adjusted R2 waswere used in the analysis.</p>
</td></tr>
<tr><td><code>Total_explained_variation</code></td>
<td>
<p>The explained variation for the full model (raw or adjusted R2).</p>
</td></tr>
<tr><td><code>Var.part</code></td>
<td>
<p>If var.part=TRUE, a matrix containing the value and percentage of all commonality (2^N-1 for N predictors or matrices).</p>
</td></tr>
<tr><td><code>Hier.part</code></td>
<td>
<p>A matrix containing unique, average shared, individual effects and percentage of individual effects towards total explained variation for each predictor or matrix.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jiangshan Lai <a href="mailto:lai@ibcas.ac.cn">lai@ibcas.ac.cn</a>
</p>
<p>Pedro Peres-Neto <a href="mailto:pedro.peres-neto@concordia.ca">pedro.peres-neto@concordia.ca</a>
</p>
<p>Kim Nimon <a href="mailto:kim.nimon@gmail.com">kim.nimon@gmail.com</a>
</p>


<h3>References</h3>


<ul>
<li><p> Lai J.,Zou Y., Zhang J.,Peres-Neto P.(2022) Generalizing hierarchical and variation partitioning in multiple regression and canonical analyses using the rdacca.hp R package.Methods in Ecology and Evolution,13,782-788&lt;DOI:10.1111/2041-210X.13800&gt;
</p>
</li>
<li><p> Chevan, A. &amp; Sutherland, M. (1991). Hierarchical partitioning. American Statistician, 45, 90-96. doi:10.1080/00031305.1991.10475776
</p>
</li>
<li><p> Nimon, K., Oswald, F.L. &amp; Roberts, J.K. (2013). Yhat: Interpreting regression effects. R package version 2.0.0.
</p>
</li>
<li><p> Legendre, P. &amp; Anderson, M. J. (1999). Distance-based redundancy analysis: testing multispecies responses in multifactorial ecological experiments. Ecological Monographs, 69, 1–24.&lt;DOI:10.1890/0012-9615(1999)069[0001:dbratm]2.0.co;2&gt;
</p>
</li>
<li><p> Walsh, C.J. &amp; Mac Nally, R. (2013) hier.part: Hierarchical Partitioning. R package version 1.0-4.
</p>
</li>
<li><p> Peres-Neto, P.R., Legendre, P., Dray, S. &amp; Borcard, D. (2006) Variation partitioning of species data matrices: Estimation and comparison of fractions. Ecology, 87, 2614-2625.&lt;DOI: doi.org/10.1890/0012-9658(2006)87[2614:VPOSDM]2.0.CO;2&gt;
</p>
</li>
<li><p> Ezekiel, M. (1930) Methods of Correlational Analysis. Wiley, New York
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>library(vegan)
data(mite)
data(mite.env)
data(mite.xy)
data(mite.pcnm)
#Hellinger-transform the species dataset for RDA
mite.hel &lt;- decostand(mite, "hellinger")
rdacca.hp(mite.hel,mite.env,method="RDA",type="adjR2")
rdacca.hp(vegdist(mite),mite.env,method="dbRDA",type="adjR2")
rdacca.hp(mite,mite.env,method="CCA",type="adjR2")
iv &lt;- list(env=mite.env,xy=mite.xy,pcnm=mite.pcnm)
rdacca.hp(mite.hel,iv,method="RDA",var.part = TRUE)
rdacca.hp(vegdist(mite),iv,method="dbRDA",var.part = TRUE)
rdacca.hp(mite,iv,method="CCA",var.part = TRUE)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
