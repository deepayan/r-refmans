<!DOCTYPE html><html lang="en"><head><title>Help for package tstests</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {tstests}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#tstests-package'><p>tstests: Time Series Goodness of Fit and Forecast Evaluation Tests</p></a></li>
<li><a href='#arma_forecast'><p>Sample ARMA Forecast Data</p></a></li>
<li><a href='#as_flextable.tstest.berkowitz'><p>Transform a summary object into flextable</p></a></li>
<li><a href='#berkowitz_test'><p>Berkowitz Forecast Density Test</p></a></li>
<li><a href='#dac_test'><p>Directional Accuracy Tests</p></a></li>
<li><a href='#garch_forecast'><p>Sample GARCH Forecast Data</p></a></li>
<li><a href='#gmm_test'><p>GMM Orthogonality Test</p></a></li>
<li><a href='#hongli_test'><p>The Non-Parametric Density Test of Hong and Li</p></a></li>
<li><a href='#minzar_test'><p>Mincer-Zarnowitz Test</p></a></li>
<li><a href='#nyblom_test'><p>Nyblom-Hansen Parameter Constancy Test</p></a></li>
<li><a href='#print.tstest.berkowitz'><p>Test Print method</p></a></li>
<li><a href='#shortfall_de_test'><p>Expected Shortfall DE Test</p></a></li>
<li><a href='#signbias_test'><p>Sign Bias Test</p></a></li>
<li><a href='#spy'><p>SPY ETF Adjusted Close</p></a></li>
<li><a href='#var_cp_test'><p>Value at Risk CP Test</p></a></li>
<li><a href='#var_test'><p>Value at Risk and Expected Shortfall Tests</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Time Series Goodness of Fit and Forecast Evaluation Tests</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.1</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Alexios Galanos &lt;alexios@4dscape.com&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), methods, tsmethods</td>
</tr>
<tr>
<td>Description:</td>
<td>Goodness of Fit and Forecast Evaluation Tests for timeseries models. Includes, among others, the Generalized Method of Moments (GMM) Orthogonality Test of Hansen (1982), the Nyblom (1989) parameter constancy test, the sign-bias test of Engle and Ng (1993), and a range of tests for value at risk and expected shortfall evaluation.</td>
</tr>
<tr>
<td>Imports:</td>
<td>data.table, flextable, Rdpack, car, ks, xts</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RdMacros:</td>
<td>Rdpack</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://www.nopredict.com/packages/tstests">https://www.nopredict.com/packages/tstests</a>,
<a href="https://github.com/tsmodels/tstests">https://github.com/tsmodels/tstests</a></td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, sandwich, testthat (&ge; 3.0.0),
tsdistributions, tsgarch</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-10-24 22:37:43 UTC; alexios</td>
</tr>
<tr>
<td>Author:</td>
<td>Alexios Galanos <a href="https://orcid.org/0009-0000-9308-0457"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre, cph]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-10-24 23:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='tstests-package'>tstests: Time Series Goodness of Fit and Forecast Evaluation Tests</h2><span id='topic+tstests'></span><span id='topic+tstests-package'></span>

<h3>Description</h3>

<p>Goodness of Fit and Forecast Evaluation Tests for timeseries models. Includes, among others, the Generalized Method of Moments (GMM) Orthogonality Test of Hansen (1982), the Nyblom (1989) parameter constancy test, the sign-bias test of Engle and Ng (1993), and a range of tests for value at risk and expected shortfall evaluation.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Alexios Galanos <a href="mailto:alexios@4dscape.com">alexios@4dscape.com</a> (<a href="https://orcid.org/0009-0000-9308-0457">ORCID</a>) [copyright holder]
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://www.nopredict.com/packages/tstests">https://www.nopredict.com/packages/tstests</a>
</p>
</li>
<li> <p><a href="https://github.com/tsmodels/tstests">https://github.com/tsmodels/tstests</a>
</p>
</li></ul>


<hr>
<h2 id='arma_forecast'>Sample ARMA Forecast Data</h2><span id='topic+arma_forecast'></span>

<h3>Description</h3>

<p>A pre-computed backtest of the SPY log returns data
using an ARMA(1,1)-JSU model (see details for replication code).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>arma_forecast
</code></pre>


<h3>Format</h3>



<h4><code>arma_forecast</code></h4>

<p>A data.table with 250 rows and 5 columns:
</p>

<dl>
<dt>date</dt><dd><p>the forecast date</p>
</dd>
<dt>actual</dt><dd><p>the realized values</p>
</dd>
<dt>forecast</dt><dd><p>the forecast mu</p>
</dd>
<dt>sigma</dt><dd><p>the estimated sigma</p>
</dd>
<dt>skew</dt><dd><p>the estimated skew of the jsu distribution</p>
</dd>
<dt>shape</dt><dd><p>the estimated shape of the jsu distribution</p>
</dd>
</dl>




<h3>Details</h3>

<p>The replication code for the backtest based 1-step ahead forecast distribution
is as follows:
</p>
<div class="sourceCode r"><pre>library(xts)
library(tsarma)
# from the tsmodels github repo
data("spy", package = "tstests")
spyr &lt;- na.omit(diff(log(spy)))
n &lt;- NROW(spyr)
spec &lt;- arma_modelspec(spyr, order c(1,1), distribution = "jsu")
b &lt;- tsbacktest(spec, start = (n - 250), end = n, h = 1, estimate_every = 30,
rolling = T, trace = T)
arma_forecast &lt;- data.table(date = b$table$forecast_date,
actual = b$table$actual, forecast = b$table$mu, sigma = b$table$sigma,
skew = b$table$skew, shape = b$table$shape)
</pre></div>

<hr>
<h2 id='as_flextable.tstest.berkowitz'>Transform a summary object into flextable</h2><span id='topic+as_flextable.tstest.berkowitz'></span><span id='topic+as_flextable.tstest'></span><span id='topic+as_flextable.tstest.dac'></span><span id='topic+as_flextable.tstest.gmm'></span><span id='topic+as_flextable.tstest.hongli'></span><span id='topic+as_flextable.tstest.minzar'></span><span id='topic+as_flextable.tstest.nyblom'></span><span id='topic+as_flextable.tstest.shortfall_de'></span><span id='topic+as_flextable.tstest.signbias'></span><span id='topic+as_flextable.tstest.vares'></span><span id='topic+as_flextable.tstest.var_cp'></span>

<h3>Description</h3>

<p>Transforms a &ldquo;tstest.test&rdquo; object into a flextable
with options on symbolic representation and model equation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'tstest.berkowitz'
as_flextable(
  x,
  digits = max(3L, getOption("digits") - 3L),
  signif.stars = getOption("show.signif.stars"),
  include.decision = FALSE,
  table.caption = x$test_name,
  footnote.reference = FALSE,
  ...
)

## S3 method for class 'tstest.dac'
as_flextable(
  x,
  digits = max(3L, getOption("digits") - 3L),
  signif.stars = getOption("show.signif.stars"),
  include.decision = FALSE,
  table.caption = x$test_name,
  footnote.reference = FALSE,
  ...
)

## S3 method for class 'tstest.gmm'
as_flextable(
  x,
  digits = max(3L, getOption("digits") - 3L),
  signif.stars = getOption("show.signif.stars"),
  include.decision = FALSE,
  collapse = TRUE,
  use.symbols = TRUE,
  table.caption = x$test_name,
  footnote.reference = FALSE,
  ...
)

## S3 method for class 'tstest.hongli'
as_flextable(
  x,
  digits = max(3L, getOption("digits") - 3L),
  signif.stars = getOption("show.signif.stars"),
  include.decision = FALSE,
  table.caption = x$test_name,
  footnote.reference = FALSE,
  ...
)

## S3 method for class 'tstest.minzar'
as_flextable(
  x,
  digits = max(3L, getOption("digits") - 3L),
  signif.stars = getOption("show.signif.stars"),
  include.decision = FALSE,
  table.caption = x$test_name,
  footnote.reference = FALSE,
  ...
)

## S3 method for class 'tstest.nyblom'
as_flextable(
  x,
  digits = max(3L, getOption("digits") - 3L),
  signif.stars = getOption("show.signif.stars"),
  include.decision = FALSE,
  use.symbols = TRUE,
  table.caption = x$test_name,
  footnote.reference = FALSE,
  ...
)

## S3 method for class 'tstest.shortfall_de'
as_flextable(
  x,
  digits = max(3L, getOption("digits") - 3L),
  signif.stars = getOption("show.signif.stars"),
  include.decision = FALSE,
  table.caption = x$test_name,
  footnote.reference = FALSE,
  ...
)

## S3 method for class 'tstest.signbias'
as_flextable(
  x,
  digits = max(3L, getOption("digits") - 3L),
  signif.stars = getOption("show.signif.stars"),
  include.decision = FALSE,
  use.symbols = TRUE,
  table.caption = x$test_name,
  footnote.reference = FALSE,
  ...
)

## S3 method for class 'tstest.vares'
as_flextable(
  x,
  digits = max(3L, getOption("digits") - 3L),
  signif.stars = getOption("show.signif.stars"),
  include.decision = FALSE,
  table.caption = x$test_name,
  footnote.reference = FALSE,
  ...
)

## S3 method for class 'tstest.var_cp'
as_flextable(
  x,
  digits = max(3L, getOption("digits") - 3L),
  signif.stars = getOption("show.signif.stars"),
  include.decision = FALSE,
  table.caption = x$test_name,
  footnote.reference = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="as_flextable.tstest.berkowitz_+3A_x">x</code></td>
<td>
<p>an object of which inherits a &ldquo;tstest&rdquo; class.</p>
</td></tr>
<tr><td><code id="as_flextable.tstest.berkowitz_+3A_digits">digits</code></td>
<td>
<p>integer, used for number formatting. Optionally, to avoid
scientific notation, set &lsquo;options(scipen=999)&rsquo;.</p>
</td></tr>
<tr><td><code id="as_flextable.tstest.berkowitz_+3A_signif.stars">signif.stars</code></td>
<td>
<p>logical. If TRUE, &lsquo;significance stars&rsquo; are printed.</p>
</td></tr>
<tr><td><code id="as_flextable.tstest.berkowitz_+3A_include.decision">include.decision</code></td>
<td>
<p>prints out whether to reject the NULL at the 5% level
of significance.</p>
</td></tr>
<tr><td><code id="as_flextable.tstest.berkowitz_+3A_table.caption">table.caption</code></td>
<td>
<p>an optional string for the table caption.</p>
</td></tr>
<tr><td><code id="as_flextable.tstest.berkowitz_+3A_footnote.reference">footnote.reference</code></td>
<td>
<p>whether to include the reference paper of the test
in the footnotes.</p>
</td></tr>
<tr><td><code id="as_flextable.tstest.berkowitz_+3A_...">...</code></td>
<td>
<p>not currently used. The returned object can be manipulated further
using flextable.</p>
</td></tr>
<tr><td><code id="as_flextable.tstest.berkowitz_+3A_collapse">collapse</code></td>
<td>
<p>collapses the results for multiple lags to just report the
joint test.</p>
</td></tr>
<tr><td><code id="as_flextable.tstest.berkowitz_+3A_use.symbols">use.symbols</code></td>
<td>
<p>for tests which either have parameters for which the
latex symbols were included in the calling function or for which the tests
generate values which can be represented as latex symbols, then these will
be generated.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A flextable object.
</p>

<hr>
<h2 id='berkowitz_test'>Berkowitz Forecast Density Test</h2><span id='topic+berkowitz_test'></span>

<h3>Description</h3>

<p>The forecast density test of Berkowitz (2001).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>berkowitz_test(x, lags = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="berkowitz_test_+3A_x">x</code></td>
<td>
<p>a series representing the PIT transformed actuals given the forecast
values.</p>
</td></tr>
<tr><td><code id="berkowitz_test_+3A_lags">lags</code></td>
<td>
<p>the number of autoregressive lags (positive and greater than 0).</p>
</td></tr>
<tr><td><code id="berkowitz_test_+3A_...">...</code></td>
<td>
<p>additional arguments passed to the arima function which estimates
the unrestricted model.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class &ldquo;tstest.berkowitz&rdquo; which has a print and
as_flextable method.
</p>


<h3>References</h3>

<p>Berkowitz J (2001).
&ldquo;Testing density forecasts, with applications to risk management.&rdquo;
<em>Journal of Business &amp; Economic Statistics</em>, <b>19</b>(4), 465&ndash;474.
</p>
<p>Jarque CM, Bera AK (1987).
&ldquo;A test for normality of observations and regression residuals.&rdquo;
<em>International Statistical Review/Revue Internationale de Statistique</em>, 163&ndash;172.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(tsdistributions)
data(garch_forecast)
x &lt;- pdist('jsu', q = garch_forecast$actual, mu = garch_forecast$forecast,
sigma = garch_forecast$sigma, skew = garch_forecast$skew,
shape = garch_forecast$shape)
print(berkowitz_test(x))

</code></pre>

<hr>
<h2 id='dac_test'>Directional Accuracy Tests</h2><span id='topic+dac_test'></span>

<h3>Description</h3>

<p>The directional accuracy test of Pesaran and Timmermann (1992),
and excess profitability test of Anatolyev and Gerko (2005).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dac_test(actual, forecast, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dac_test_+3A_actual">actual</code></td>
<td>
<p>a series representing the actual value of the series in the
out of sample period.</p>
</td></tr>
<tr><td><code id="dac_test_+3A_forecast">forecast</code></td>
<td>
<p>the forecast values of the series in the out of sample period.</p>
</td></tr>
<tr><td><code id="dac_test_+3A_...">...</code></td>
<td>
<p>not currently used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The null hypothesis for the test of Pesaran and Timmermann (1992) is
that the actual and predicted are independent (no sign predictability), whereas
the test of Anatolyev and Gerko (2005) measures the significance of the excess
profitability under the null hypothesis of no excess excess profitability. Both
are Hausman type tests asymptotically distributed as standard Normal.
</p>


<h3>Value</h3>

<p>An object of class &ldquo;tstest.dac&rdquo; which has a print and
as_flextable method.
</p>


<h3>Note</h3>

<p>The test will not work with constant forecasts.
</p>


<h3>References</h3>

<p>Pesaran,M.H., Timmermann,A. (1992).
&ldquo;A simple nonparametric test of predictive performance.&rdquo;
<em>Journal of Business &amp; Economic Statistics</em>, <b>10</b>(4), 461&ndash;465.
</p>
<p>Anatolyev,S., Gerko,A. (2005).
&ldquo;A trading approach to testing for predictability.&rdquo;
<em>Journal of Business &amp; Economic Statistics</em>, <b>23</b>(4), 455&ndash;461.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(arma_forecast)
print(dac_test(arma_forecast$actual, arma_forecast$forecast))

</code></pre>

<hr>
<h2 id='garch_forecast'>Sample GARCH Forecast Data</h2><span id='topic+garch_forecast'></span>

<h3>Description</h3>

<p>A pre-computed backtest of the SPY log returns data
using a GARCH(1,1)-JSU model (see details for replication code).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>garch_forecast
</code></pre>


<h3>Format</h3>



<h4><code>garch_forecast</code></h4>

<p>A data.table with 250 rows and 5 columns:
</p>

<dl>
<dt>date</dt><dd><p>the forecast date</p>
</dd>
<dt>actual</dt><dd><p>the realized values</p>
</dd>
<dt>forecast</dt><dd><p>the forecast mu</p>
</dd>
<dt>sigma</dt><dd><p>the forecast sigma</p>
</dd>
<dt>skew</dt><dd><p>the estimated skew of the jsu distribution</p>
</dd>
<dt>shape</dt><dd><p>the estimated shape of the jsu distribution</p>
</dd>
</dl>




<h3>Details</h3>

<p>The replication code for the backtest based 1-step ahead forecast distribution
is as follows:
</p>
<div class="sourceCode r"><pre>library(xts)
library(tsgarch)
data("spy", package = "tstests")
spyr &lt;- na.omit(diff(log(spy)))
n &lt;- NROW(spyr)
spec &lt;- garch_modelspec(spyr, model = "garch", constant = T,
distribution = "jsu")
b &lt;- tsbacktest(spec, start = (n - 250), end = n, h = 1, estimate_every = 30,
rolling = T, trace = T)
garch_forecast &lt;- data.table(date = b$table$forecast_date,
actual = b$table$actual, forecast = b$table$mu, sigma = b$table$sigma,
skew = b$table$skew, shape = b$table$shape)
</pre></div>

<hr>
<h2 id='gmm_test'>GMM Orthogonality Test</h2><span id='topic+gmm_test'></span>

<h3>Description</h3>

<p>The GMM orthogonality test of Hansen (1982).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gmm_test(x, lags = 1, skewness = 0, kurtosis = 3, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gmm_test_+3A_x">x</code></td>
<td>
<p>a series representing the standardized residuals of some estimated model.</p>
</td></tr>
<tr><td><code id="gmm_test_+3A_lags">lags</code></td>
<td>
<p>the lags for the co-moment test.</p>
</td></tr>
<tr><td><code id="gmm_test_+3A_skewness">skewness</code></td>
<td>
<p>the skewness of the estimated model residuals.</p>
</td></tr>
<tr><td><code id="gmm_test_+3A_kurtosis">kurtosis</code></td>
<td>
<p>the kurtosis of the estimated model residuals.</p>
</td></tr>
<tr><td><code id="gmm_test_+3A_...">...</code></td>
<td>
<p>not currently used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For parametric models estimated with a particular distribution, the
skewness and kurtosis should flow from the distributional model. See for example
<code><a href="tsdistributions.html#topic+dskewness">dskewness</a></code> and
<code><a href="tsdistributions.html#topic+dkurtosis">dkurtosis</a></code>.
</p>


<h3>Value</h3>

<p>An object of class &ldquo;tstest.gmm&rdquo; which has a print and
as_flextable method.
</p>


<h3>References</h3>

<p>Hansen,L.P. (1982).
&ldquo;Large sample properties of generalized method of moments estimators.&rdquo;
<em>Econometrica</em>, <b>50</b>(4), 1029&ndash;1054.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(tsgarch)
library(tsdistributions)
library(data.table)
library(xts)
data("spy")
spyr &lt;- na.omit(diff(log(spy)))
spec &lt;- garch_modelspec(spyr, model = "egarch", order = c(2,1), constant = TRUE,
distribution = "jsu")
mod &lt;- estimate(spec)
skewness &lt;- dskewness("jsu", skew = coef(mod)["skew"], shape = coef(mod)["shape"])
# kurtosis is dkurtosis is the excess over the Normal (3) so we add back 3
# since the test takes the actual not excess kurtosis.
kurtosis &lt;- dkurtosis("jsu", skew = coef(mod)["skew"], shape = coef(mod)["shape"]) + 3
test &lt;- gmm_test(residuals(mod, standardize = TRUE), lags = 2, skewness = skewness,
kurtosis = kurtosis)
print(test, collapse = TRUE, include.decision = TRUE)

</code></pre>

<hr>
<h2 id='hongli_test'>The Non-Parametric Density Test of Hong and Li</h2><span id='topic+hongli_test'></span>

<h3>Description</h3>

<p>Implements the Non-Parametric Density Test of Hong and Li (2005).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hongli_test(x, lags = 4, conf_level = 0.95, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="hongli_test_+3A_x">x</code></td>
<td>
<p>a series representing the PIT transformed actuals given the forecast
values.</p>
</td></tr>
<tr><td><code id="hongli_test_+3A_lags">lags</code></td>
<td>
<p>the number lags to use for testing the joint hypothesis.</p>
</td></tr>
<tr><td><code id="hongli_test_+3A_conf_level">conf_level</code></td>
<td>
<p>the confidence level for generating the critical values
which serve as thresholds for deciding on the null hypothesis.</p>
</td></tr>
<tr><td><code id="hongli_test_+3A_...">...</code></td>
<td>
<p>none.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A novel method to analyze how well a conditional density fits the underlying
data is through the probability integral transformation (PIT) discussed in
Rosenblatt (1952) and used in the <code><a href="#topic+berkowitz_test">berkowitz_test</a></code>. Hong and Li (2005)
introduced a nonparametric portmanteau test, building on the work of
Ait-Sahalia (1996), which tests the joint hypothesis of i.i.d and uniformity
for a series of PIT transformed data. To achieve this, it tests for
misspecification in the conditional moments of the model transformed
standardized residuals, and is distributed as N(0, 1) under the null of a
correctly specified model. These moment tests are reported as &lsquo;M(1,1)&rsquo;
to &lsquo;M(4,4)&rsquo; in the output, with &lsquo;M(1,2)&rsquo; related to
ARCH-in-mean effects, and &lsquo;M(2,1)&rsquo; to leverage, while &lsquo;W&rsquo; is the
Portmanteu type test statistic for general misspecification (using p lags)
and also distributed as N(0, 1) under the null of a correctly specified model.
Only upper tail critical values are used in this test. The interested reader
is referred to the paper for more details.
</p>


<h3>Value</h3>

<p>An object of class &ldquo;tstest.hongli&rdquo; which has a print and
&ldquo;as_flextable&rdquo; method.
</p>


<h3>References</h3>

<p>Hong,Y., Li,H. (2005).
&ldquo;Nonparametric specification testing for continuous-time models with applications to term structure of interest rates.&rdquo;
<em>Review of Financial Studies</em>, <b>18</b>(1), 37&ndash;84.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(tsdistributions)
data(garch_forecast)
x &lt;- pdist('jsu', q = garch_forecast$actual, mu = garch_forecast$forecast,
sigma = garch_forecast$sigma, skew = garch_forecast$skew,
shape = garch_forecast$shape)
print(hongli_test(x), include.decision = TRUE)

</code></pre>

<hr>
<h2 id='minzar_test'>Mincer-Zarnowitz Test</h2><span id='topic+minzar_test'></span>

<h3>Description</h3>

<p>The forecast unbiasedness test of Mincer and Zarnowitz (1969).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>minzar_test(actual, forecast, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="minzar_test_+3A_actual">actual</code></td>
<td>
<p>a vector representing the actual values of a series.</p>
</td></tr>
<tr><td><code id="minzar_test_+3A_forecast">forecast</code></td>
<td>
<p>a vector representing the forecasted values of the series.</p>
</td></tr>
<tr><td><code id="minzar_test_+3A_...">...</code></td>
<td>
<p>additional arguments passed to <code><a href="car.html#topic+linearHypothesis">linearHypothesis</a></code>,
except the &ldquo;test&rdquo; argument which is fixed to Chisq.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class &ldquo;tstest.minzar&rdquo; which has a print and
as_flextable method.
</p>


<h3>References</h3>

<p>Mincer JA, Zarnowitz V (1969).
&ldquo;The evaluation of economic forecasts.&rdquo;
In <em>Economic forecasts and expectations: Analysis of forecasting behavior and performance</em>, 3&ndash;46.
NBER.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(arma_forecast)
test &lt;- minzar_test(arma_forecast$actual, arma_forecast$forecast)
test

</code></pre>

<hr>
<h2 id='nyblom_test'>Nyblom-Hansen Parameter Constancy Test</h2><span id='topic+nyblom_test'></span>

<h3>Description</h3>

<p>The parameter constancy test of Nyblom (1989).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nyblom_test(
  x,
  scores = NULL,
  parameter_names = colnames(scores),
  parameter_symbols = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nyblom_test_+3A_x">x</code></td>
<td>
<p>a series representing the standardized residuals of some estimated model.</p>
</td></tr>
<tr><td><code id="nyblom_test_+3A_scores">scores</code></td>
<td>
<p>the log likelihood score matrix. The <code><a href="sandwich.html#topic+estfun">estfun</a></code> method
if exported by a package for a model will return this matrix.</p>
</td></tr>
<tr><td><code id="nyblom_test_+3A_parameter_names">parameter_names</code></td>
<td>
<p>optional character vector of the parameter names. Usually
read off the column names of the score matrix.</p>
</td></tr>
<tr><td><code id="nyblom_test_+3A_parameter_symbols">parameter_symbols</code></td>
<td>
<p>an optional character vector of the latex names of the
parameters which can be used when printing using the flextable format.</p>
</td></tr>
<tr><td><code id="nyblom_test_+3A_...">...</code></td>
<td>
<p>not currently used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The p-values for the test statistic are based on a pre-computed density,
by simulation using equation 3.3 of Nyblom (1989), with up to 40 parameters and
saved as an internal data object within the package. A kernel density is used
to fit the 10,000 samples of the distribution before extracting the p-values.
The original simulation generated more than 100,000 data points but these
were compressed to quantiles at intervals of 0.001 in order to keep the package
size under 5MB.
</p>


<h3>Value</h3>

<p>An object of class &ldquo;tstest.nyblom&rdquo; which has a print and
as_flextable method.
</p>


<h3>References</h3>

<p>Nyblom,J. (1989).
&ldquo;Testing for the constancy of parameters over time.&rdquo;
<em>Journal of the American Statistical Association</em>, <b>84</b>(405), 223&ndash;230.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(tsgarch)
library(xts)
data("spy")
spyr &lt;- na.omit(diff(log(spy)))
spec &lt;- garch_modelspec(spyr[1:1200], model = "garch", order = c(1,1),
constant = TRUE, distribution = "norm")
mod &lt;- estimate(spec)
test &lt;- nyblom_test(residuals(mod, standardize = TRUE), scores = estfun(mod),
parameter_names = names(coef(mod)),
parameter_symbols = mod$parmatrix[estimate == 1]$symbol)
print(test)

</code></pre>

<hr>
<h2 id='print.tstest.berkowitz'>Test Print method</h2><span id='topic+print.tstest.berkowitz'></span><span id='topic+print.tstest'></span><span id='topic+print.tstest.dac'></span><span id='topic+print.tstest.gmm'></span><span id='topic+print.tstest.hongli'></span><span id='topic+print.tstest.minzar'></span><span id='topic+print.tstest.nyblom'></span><span id='topic+print.tstest.shortfall_de'></span><span id='topic+print.tstest.signbias'></span><span id='topic+print.tstest.vares'></span><span id='topic+print.tstest.var_cp'></span>

<h3>Description</h3>

<p>Print method for objects inheriting class &ldquo;tstest&rdquo;
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'tstest.berkowitz'
print(
  x,
  digits = max(3L, getOption("digits") - 3L),
  signif.stars = getOption("show.signif.stars"),
  include.decision = FALSE,
  ...
)

## S3 method for class 'tstest.dac'
print(
  x,
  digits = max(3L, getOption("digits") - 3L),
  signif.stars = getOption("show.signif.stars"),
  include.decision = FALSE,
  ...
)

## S3 method for class 'tstest.gmm'
print(
  x,
  digits = max(3L, getOption("digits") - 3L),
  signif.stars = getOption("show.signif.stars"),
  include.decision = FALSE,
  collapse = TRUE,
  ...
)

## S3 method for class 'tstest.hongli'
print(
  x,
  digits = max(3L, getOption("digits") - 3L),
  signif.stars = getOption("show.signif.stars"),
  include.decision = FALSE,
  ...
)

## S3 method for class 'tstest.minzar'
print(
  x,
  digits = max(3L, getOption("digits") - 3L),
  signif.stars = getOption("show.signif.stars"),
  include.decision = FALSE,
  ...
)

## S3 method for class 'tstest.nyblom'
print(
  x,
  digits = max(3L, getOption("digits") - 3L),
  signif.stars = getOption("show.signif.stars"),
  include.decision = FALSE,
  ...
)

## S3 method for class 'tstest.shortfall_de'
print(
  x,
  digits = max(3L, getOption("digits") - 3L),
  signif.stars = getOption("show.signif.stars"),
  include.decision = FALSE,
  ...
)

## S3 method for class 'tstest.signbias'
print(
  x,
  digits = max(3L, getOption("digits") - 3L),
  signif.stars = getOption("show.signif.stars"),
  include.decision = FALSE,
  ...
)

## S3 method for class 'tstest.vares'
print(
  x,
  digits = max(3L, getOption("digits") - 3L),
  signif.stars = getOption("show.signif.stars"),
  include.decision = FALSE,
  ...
)

## S3 method for class 'tstest.var_cp'
print(
  x,
  digits = max(3L, getOption("digits") - 3L),
  signif.stars = getOption("show.signif.stars"),
  include.decision = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.tstest.berkowitz_+3A_x">x</code></td>
<td>
<p>an object inheriting class &ldquo;tstest.test&rdquo;.</p>
</td></tr>
<tr><td><code id="print.tstest.berkowitz_+3A_digits">digits</code></td>
<td>
<p>integer, used for number formatting. Optionally, to avoid
scientific notation, set &lsquo;options(scipen=999)&rsquo;.</p>
</td></tr>
<tr><td><code id="print.tstest.berkowitz_+3A_signif.stars">signif.stars</code></td>
<td>
<p>logical. If TRUE, &lsquo;significance stars&rsquo; are printed.</p>
</td></tr>
<tr><td><code id="print.tstest.berkowitz_+3A_include.decision">include.decision</code></td>
<td>
<p>prints out whether to reject the NULL at the 5% level
of significance.</p>
</td></tr>
<tr><td><code id="print.tstest.berkowitz_+3A_...">...</code></td>
<td>
<p>not currently used.</p>
</td></tr>
<tr><td><code id="print.tstest.berkowitz_+3A_collapse">collapse</code></td>
<td>
<p>collapses the results for multiple lags to just report the
joint test.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Invisibly returns the original object.
</p>

<hr>
<h2 id='shortfall_de_test'>Expected Shortfall DE Test</h2><span id='topic+shortfall_de_test'></span><span id='topic+shortfall_test'></span>

<h3>Description</h3>

<p>The expected shortfall test of Du and Escanciano (2017).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>shortfall_de_test(x, alpha = 0.05, lags = 1, boot = FALSE, n_boot = 2000, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="shortfall_de_test_+3A_x">x</code></td>
<td>
<p>the probability integral transformed series (pit).</p>
</td></tr>
<tr><td><code id="shortfall_de_test_+3A_alpha">alpha</code></td>
<td>
<p>the quantile level for calculating the forecast value at risk
and expected shortfall.</p>
</td></tr>
<tr><td><code id="shortfall_de_test_+3A_lags">lags</code></td>
<td>
<p>the numbers of lags to use for the conditional test.</p>
</td></tr>
<tr><td><code id="shortfall_de_test_+3A_boot">boot</code></td>
<td>
<p>whether to use bootstrap simulation for estimating the p-values.</p>
</td></tr>
<tr><td><code id="shortfall_de_test_+3A_n_boot">n_boot</code></td>
<td>
<p>the bootstrap replications used to calculate the p-value.</p>
</td></tr>
<tr><td><code id="shortfall_de_test_+3A_...">...</code></td>
<td>
<p>not currently used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The test of Du and Escanciano (2017) combines ideas from
Berkowitz (2001) and Christoffersen (1998) to create an unconditional
and conditional shortfall test based on the probability integral transformed
actuals conditioned on the forecast distribution to evaluate the severity
and independence of the residuals shortfall (based on violations of VaR).
The unconditional test (severity) checks for the mean of cumulative violations using
a t-test, whilst the conditional test (independence) is a Portmanteau test applied to
estimated cumulative violations. A bootstrap approach to calculating the
distribution of the test statistics is available for finite samples, similar
to the suggestions of McNeil (2000).
</p>


<h3>Value</h3>

<p>An object of class &ldquo;tstest.shortfall_de&rdquo; which has a print and
as_flextable method.
</p>


<h3>References</h3>

<p>Du Z, Escanciano JC (2017).
&ldquo;Backtesting expected shortfall: accounting for tail risk.&rdquo;
<em>Management Science</em>, <b>63</b>(4), 940&ndash;958.
</p>
<p>Berkowitz J (2001).
&ldquo;Testing density forecasts, with applications to risk management.&rdquo;
<em>Journal of Business &amp; Economic Statistics</em>, <b>19</b>(4), 465&ndash;474.
</p>
<p>Christoffersen PF (1998).
&ldquo;Evaluating interval forecasts.&rdquo;
<em>International Economic Review</em>, 841&ndash;862.
</p>
<p>McNeil,A.J., Frey,R. (2000).
&ldquo;Estimation of tail-related risk measures for heteroscedastic financial time series: An extreme value approach.&rdquo;
<em>Journal of Empirical Finance</em>, <b>7</b>(3-4), 271&ndash;300.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(tsdistributions)
data("garch_forecast")
x &lt;- pdist("jsu", q = garch_forecast$actual, mu = garch_forecast$forecast,
sigma = garch_forecast$sigma, skew = garch_forecast$skew,
shape = garch_forecast$shape)
print(shortfall_de_test(x, alpha = 0.05, lags = 4))

</code></pre>

<hr>
<h2 id='signbias_test'>Sign Bias Test</h2><span id='topic+signbias_test'></span>

<h3>Description</h3>

<p>The sign bias test of Engle and Ng (1993).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>signbias_test(x, sigma = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="signbias_test_+3A_x">x</code></td>
<td>
<p>a series representing the residuals of some estimated model.</p>
</td></tr>
<tr><td><code id="signbias_test_+3A_sigma">sigma</code></td>
<td>
<p>either a scalar representing the residuals standard deviation else
a vector of the same length as x representing the conditional standard deviation
of the residuals.</p>
</td></tr>
<tr><td><code id="signbias_test_+3A_...">...</code></td>
<td>
<p>additional arguments passed to <code><a href="car.html#topic+linearHypothesis">linearHypothesis</a></code>,
except the &ldquo;test&rdquo; which is fixed to use the Chisq test.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class &ldquo;tstest.signbias&rdquo; which has a print and
as_flextable method.
</p>


<h3>References</h3>

<p>Engle RF, Ng VK (1993).
&ldquo;Measuring and testing the impact of news on volatility.&rdquo;
<em>The Journal of Finance</em>, <b>48</b>(5), 1749&ndash;1778.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(tsgarch)
library(tsdistributions)
library(xts)
data("spy")
spyr &lt;- na.omit(diff(log(spy)))
spec &lt;- garch_modelspec(spyr, model = "garch", order = c(1,1),
constant = TRUE, distribution = "jsu")
mod &lt;- estimate(spec)
print(signbias_test(residuals(mod), sigma(mod)))

</code></pre>

<hr>
<h2 id='spy'>SPY ETF Adjusted Close</h2><span id='topic+spy'></span>

<h3>Description</h3>

<p>The adjusted closing price of the SPY ETF.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spy
</code></pre>


<h3>Format</h3>



<h4><code>spy</code></h4>

<p>An xts vector with 7597 observations spanning the period 1993-01-29 / 2023-03-30
from Yahoo Finance.
</p>


<hr>
<h2 id='var_cp_test'>Value at Risk CP Test</h2><span id='topic+var_cp_test'></span>

<h3>Description</h3>

<p>The value at risk coverage and duration tests of
Kupiec (1995) and Christoffersen and Pelletier (1998,2004).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>var_cp_test(actual, forecast, alpha, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="var_cp_test_+3A_actual">actual</code></td>
<td>
<p>a series representing the actual value of the series in the
out of sample period.</p>
</td></tr>
<tr><td><code id="var_cp_test_+3A_forecast">forecast</code></td>
<td>
<p>the forecast values of the series at the quantile
given by alpha (the forecast value at risk).</p>
</td></tr>
<tr><td><code id="var_cp_test_+3A_alpha">alpha</code></td>
<td>
<p>the quantile level used to calculate the forecast value at risk.</p>
</td></tr>
<tr><td><code id="var_cp_test_+3A_...">...</code></td>
<td>
<p>not currently used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The unconditional (Kupiec 1995) and conditional (Christoffersen and
Pelletier 1998) coverage tests evaluate the correctness and independence of
value at risk violations (failures), individually and jointly. Correctness
is measured in terms of the expected and actual violations of value at risk
for a given quantile and data size, whilst independence checks the clustering
of violations with past violations, which is key in determining whether a model
can accurately capture the higher order dynamics of a series.
The duration of time between value ar risk violations (no-hits) should ideally
be independent and not cluster. Under the null hypothesis of a correctly
specified risk model, the no-hit duration should have no memory. Since the
only continuous distribution which is memory free is the exponential, the
test can conducted on any distribution which embeds the exponential as a
restricted case, and a likelihood ratio test then conducted to see whether
the restriction holds. Following Christoffersen and Pelletier (2004), the
Weibull distribution is used with parameter &lsquo;b=1&rsquo; representing the case of
the exponential.
</p>


<h3>Value</h3>

<p>An object of class &ldquo;tstest.var_cp&rdquo; which has a print and
as_flextable method.
</p>


<h3>References</h3>

<p>Kupiec,P.H. (1995).
&ldquo;Techniques for verifying the accuracy of risk measurement models.&rdquo;
<em>The Journal of Derivatives</em>, <b>3</b>(2), 73&ndash;84.
</p>
<p>Christoffersen PF (1998).
&ldquo;Evaluating interval forecasts.&rdquo;
<em>International Economic Review</em>, 841&ndash;862.
</p>
<p>Christoffersen PF, Pelletier,D. (2004).
&ldquo;Backtesting value-at-risk: A duration-based approach.&rdquo;
<em>Journal of Financial Econometrics</em>, <b>2</b>(1), 84&ndash;108.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(tsdistributions)
data("garch_forecast")
q &lt;- qdist("jsu", p = 0.05, mu = garch_forecast$forecast, sigma = garch_forecast$sigma,
skew = garch_forecast$skew, shape = garch_forecast$shape)
var_cp_test(actual = garch_forecast$actual, forecast = q, alpha = 0.05)

</code></pre>

<hr>
<h2 id='var_test'>Value at Risk and Expected Shortfall Tests</h2><span id='topic+var_test'></span>

<h3>Description</h3>

<p>The value at risk coverage and duration tests of
Kupiec (1995) and Christoffersen and Pelletier (1998,2004), and
expected shortfall test of Du and Escanciano (2017).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>var_test(
  actual,
  forecast,
  x,
  alpha,
  lags = 1,
  boot = FALSE,
  n_boot = 2000,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="var_test_+3A_actual">actual</code></td>
<td>
<p>a series representing the actual value of the series in the
out of sample period.</p>
</td></tr>
<tr><td><code id="var_test_+3A_forecast">forecast</code></td>
<td>
<p>the forecast values of the series at the quantile
given by alpha (the forecast value at risk).</p>
</td></tr>
<tr><td><code id="var_test_+3A_x">x</code></td>
<td>
<p>the probability integral transformed series (pit).</p>
</td></tr>
<tr><td><code id="var_test_+3A_alpha">alpha</code></td>
<td>
<p>the quantile level used to calculate the forecast value at risk.</p>
</td></tr>
<tr><td><code id="var_test_+3A_lags">lags</code></td>
<td>
<p>the numbers of lags to use for the conditional shortfall test.</p>
</td></tr>
<tr><td><code id="var_test_+3A_boot">boot</code></td>
<td>
<p>whether to use bootstrap simulation for estimating the p-values of
the conditional shortfall test.</p>
</td></tr>
<tr><td><code id="var_test_+3A_n_boot">n_boot</code></td>
<td>
<p>the bootstrap replications used to calculate the p-value.</p>
</td></tr>
<tr><td><code id="var_test_+3A_...">...</code></td>
<td>
<p>not currently used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a condensed table of both the <code><a href="#topic+var_cp_test">var_cp_test</a></code> and
<code><a href="#topic+shortfall_de_test">shortfall_de_test</a></code>.
</p>


<h3>Value</h3>

<p>An object of class &ldquo;tstest.vares&rdquo; which has a print and
as_flextable method.
</p>


<h3>References</h3>

<p>Kupiec,P.H. (1995).
&ldquo;Techniques for verifying the accuracy of risk measurement models.&rdquo;
<em>The Journal of Derivatives</em>, <b>3</b>(2), 73&ndash;84.
</p>
<p>Christoffersen PF (1998).
&ldquo;Evaluating interval forecasts.&rdquo;
<em>International Economic Review</em>, 841&ndash;862.
</p>
<p>Christoffersen PF, Pelletier,D. (2004).
&ldquo;Backtesting value-at-risk: A duration-based approach.&rdquo;
<em>Journal of Financial Econometrics</em>, <b>2</b>(1), 84&ndash;108.
</p>
<p>Du Z, Escanciano JC (2017).
&ldquo;Backtesting expected shortfall: accounting for tail risk.&rdquo;
<em>Management Science</em>, <b>63</b>(4), 940&ndash;958.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
