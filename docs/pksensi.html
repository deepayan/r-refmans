<!DOCTYPE html><html><head><title>Help for package pksensi</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {pksensi}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#about-pksensi'><p>About <span class="pkg">pksensi</span> package</p></a></li>
<li><a href='#APAP'><p>Pharmacokinetic Dataset of Acetaminophen</p></a></li>
<li><a href='#check'><p>Check the Parameter Sensitivity</p></a></li>
<li><a href='#compile_model'><p>Model Compiler</p></a></li>
<li><a href='#mcsim_install'><p>Download and install <span class="pkg">GNU MCSim</span></p></a></li>
<li><a href='#models'><p>Example PK Model for Sensitivity Analysis</p></a></li>
<li><a href='#pksim'><p>PK Simulation from Sampling Parameter</p></a></li>
<li><a href='#rfast99'><p>Extended Fourier Amplitude Sensitivity Test with Random Phase Shift</p></a></li>
<li><a href='#solve_fun'><p>Solve PK Model Through <span class="pkg">deSolve</span> Package or Analytical Function</p></a></li>
<li><a href='#solve_mcsim'><p>Solve PK Model Through <span class="pkg">GNU MCSim</span></p></a></li>
<li><a href='#tell2'><p>The Decoupling Simulations</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Global Sensitivity Analysis in Physiologically Based Kinetic
Modeling</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2.3</td>
</tr>
<tr>
<td>Description:</td>
<td>Applying the global sensitivity analysis workflow to investigate 
    the parameter uncertainty and sensitivity in physiologically based 
    kinetic (PK) models, especially the physiologically based 
    pharmacokinetic/toxicokinetic model with multivariate outputs. 
    The package also provides some functions to check the convergence 
    and sensitivity of model parameters. The workflow was first mentioned 
    in Hsieh et al., (2018) &lt;<a href="https://doi.org/10.3389%2Ffphar.2018.00588">doi:10.3389/fphar.2018.00588</a>&gt;, then further 
    refined (Hsieh et al., 2020 &lt;<a href="https://doi.org/10.1016%2Fj.softx.2020.100609">doi:10.1016/j.softx.2020.100609</a>&gt;).                </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> | file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/nanhung/pksensi">https://github.com/nanhung/pksensi</a>,
<a href="https://nanhung.github.io/pksensi/">https://nanhung.github.io/pksensi/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/nanhung/pksensi/issues">https://github.com/nanhung/pksensi/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.1)</td>
</tr>
<tr>
<td>Imports:</td>
<td>ggplot2, data.table, deSolve, foreach, parallel, doParallel</td>
</tr>
<tr>
<td>Suggests:</td>
<td>covr, knitr, httk, rmarkdown, testthat</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-09-21 16:56:17 UTC; lanhsieh</td>
</tr>
<tr>
<td>Author:</td>
<td>Nan-Hung Hsieh <a href="https://orcid.org/0000-0003-0163-2766"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Brad Reisfeld <a href="https://orcid.org/0000-0003-1310-1495"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb],
  Weihsueh A. Chiu <a href="https://orcid.org/0000-0002-7575-2368"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Nan-Hung Hsieh &lt;d99622005@ntu.edu.tw&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-09-21 18:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='about-pksensi'>About <span class="pkg">pksensi</span> package</h2><span id='topic+about-pksensi'></span><span id='topic+pksensi-package'></span>

<h3>Description</h3>

<p>Applying a global sensitivity analysis approach to reduce parameter dimensionality in
physiologically based kinetic modeling and evaluate the robustness of the algorithm under the given sampling number.
</p>


<h3>Details</h3>

<p>The &quot;extended Fourier amplitude sensitivity testing (eFAST)&quot;, a variance-based sensitivity analysis
method is used to estimate the parameter impact on model output
(Saltelli et al. 1999).
The eFAST is the effective algorithm to determine the influential parameter in
physiologically-based pharmacokinetic model calibration (Hsieh et al. 2018).
The eFAST algorithm is sourced from <span class="pkg">sensitivity</span> package
but implemented the random-phase shift to evaluating the robustness of sensitivity measurement under the given sample size.
</p>


<h3>References</h3>

<p>Saltelli, A., Tarantola, S., &amp; Chan, K. S. (1999).
A quantitative model-independent method for global sensitivity analysis of model output.
<em>Technometrics</em>, 41, 39-56.
</p>
<p>Hsieh, N. H., Reisfeld, B., Bois, F. Y., &amp; Chiu, W. A. (2018).
Applying a global sensitivity analysis workflow to improve the computational efficiencies
in physiologically-based pharmacokinetic modeling.
<em>Frontiers in Pharmacology</em>, 9, 588.
</p>
<p>Hsieh, N-H., Reisfeld B., and Chiu W.A., (2020).
pksensi: An R package to apply global sensitivity analysis in physiologically based
kinetic modeling
<em>SoftwareX</em>, 12, 100609.
</p>

<hr>
<h2 id='APAP'>Pharmacokinetic Dataset of Acetaminophen</h2><span id='topic+APAP'></span>

<h3>Description</h3>

<p>The Acetaminophen dataset contains a human experiment of pharmacokinetic data
for acetaminophen and it's major metabolites acetaminophen-glucuronide and acetaminophen-sulfate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>APAP
</code></pre>


<h3>Format</h3>

<p>A data frame containing the following columns:
</p>

<ul>
<li><p> Wt: averaged weight of the study population (kg).
</p>
</li>
<li><p> Dose: given oral dose of acetaminophen administered (mg/kg).
</p>
</li>
<li><p> Time: time after drug administration (hr).
</p>
</li>
<li><p> APAP: concentration of acetaminophen in the sample (mg/L).
</p>
</li>
<li><p> AG: concentration of acetaminophen-glucuronide in the sample (mg/L).
</p>
</li>
<li><p> AS: concentration of acetaminophen-sulfate in the sample (mg/L).
</p>
</li>
<li><p> Study: sourced reference.
</p>
</li></ul>



<h3>References</h3>

<p>Zurlinden, T. J., &amp; Reisfeld, B. (2016).
Physiologically based modeling of the pharmacokinetics of acetaminophen and
its major metabolites in humans using a Bayesian population approach.
<em>European journal of drug metabolism and pharmacokinetics</em>, 41(3), 267-280.
</p>

<hr>
<h2 id='check'>Check the Parameter Sensitivity</h2><span id='topic+check'></span><span id='topic+heat_check'></span><span id='topic+plot.rfast99'></span><span id='topic+print.rfast99'></span>

<h3>Description</h3>

<p>Visualize and check the sensitivity (or convergence) measurement with the given result.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check(x, times, vars, cutoff, out)

heat_check(
  x,
  order = c("first order", "interaction", "total order"),
  vars = NULL,
  times = NULL,
  index = "SI",
  cutoff = c(0.05, 0.1),
  level = T,
  text = F,
  show.all = FALSE
)

## S3 method for class 'rfast99'
plot(x, vars = 1, cutoff = 0.1, ...)

## S3 method for class 'rfast99'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_+3A_x">x</code></td>
<td>
<p>a list of the storing information in the defined sensitivity function.</p>
</td></tr>
<tr><td><code id="check_+3A_times">times</code></td>
<td>
<p>a logical value or character to specify the display time in simulation.</p>
</td></tr>
<tr><td><code id="check_+3A_vars">vars</code></td>
<td>
<p>a logical value or character to specify the display variable in simulation.</p>
</td></tr>
<tr><td><code id="check_+3A_cutoff">cutoff</code></td>
<td>
<p>a value or vector to set the cut-off for sensitivity (or convergence) index.
The default is 0.05 and 0.1.</p>
</td></tr>
<tr><td><code id="check_+3A_out">out</code></td>
<td>
<p>a logical value to print the checking result to the console.</p>
</td></tr>
<tr><td><code id="check_+3A_order">order</code></td>
<td>
<p>a vector of the interested output index, including <code>first order</code>, <code>interaction</code>, and <code>total order</code>.</p>
</td></tr>
<tr><td><code id="check_+3A_index">index</code></td>
<td>
<p>a character to choose sensitivity index <code>SI</code> (default) or convergence index <code>CI</code>.</p>
</td></tr>
<tr><td><code id="check_+3A_level">level</code></td>
<td>
<p>a logical value to use continuous or discrete (default) output.</p>
</td></tr>
<tr><td><code id="check_+3A_text">text</code></td>
<td>
<p>a logical value to display the calculated indices in the plot.</p>
</td></tr>
<tr><td><code id="check_+3A_show.all">show.all</code></td>
<td>
<p>a logical value to show all testing parameters in the heatmap. The default is set to <code>FALSE</code> to show only the influential parameters.</p>
</td></tr>
<tr><td><code id="check_+3A_...">...</code></td>
<td>
<p>additional arguments to customize the graphical parameters.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The convergence of sensitivity indices for each parameter is using the approach proposed
by Sarrazin et al. (2016).
This method quantitatively assesses the convergence by computing the range of
95\
Using the global approach based on the heatmap visualization combined with the index &quot;cut-off,&quot;
can systematically distinguish between &quot;influential&quot; and &quot;non-influential&quot; parameters (Hsieh et al. 2018).
</p>


<h3>Value</h3>

<p>The <code>print</code> function returns sensitivity and convergence indices
with given time-step in the console. The <code>check</code> method provides the summary of
parameter sensitivity and convergence according to the given <code>cutoff</code>.
It can distinguish the influential and non-influential parameter by the providing value
of <code>cutoff</code>. The <code>plot</code> function can generate the
time-course functional outputs of first order and interaction indices for each parameter.
The default output is the first model variable. The <code>heat_check</code> provides a convenient way
to visualize and distinguish the influential and non-influential parameter by the setting cut-off.
The convergence index can examine the stability of the sensitivity index.
To check convergence, be sure to conduct the replication in <code>rfast99</code>.
</p>


<h3>References</h3>

<p>Sarrazin, F., Pianosi, F., &amp; Wagener, T. (2016).
Global Sensitivity Analysis of environmental models: Convergence and validation.
<em>Environmental Modelling &amp; Software</em>, 79, 135–152.
</p>
<p>Hsieh, N. H., Reisfeld, B., Bois, F. Y., &amp; Chiu, W. A. (2018).
Applying a global sensitivity analysis workflow to improve the computational efficiencies
in physiologically-based pharmacokinetic modeling.
<em>Frontiers in Pharmacology</em>, 9, 588.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+tell2">tell2</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>q &lt;- "qunif"
q.arg &lt;- list(list(min = 0.6, max = 1),
  list(min = 0.5, max = 1.5),
  list(min = 0.02, max = 0.3),
  list(min = 20, max = 60))

params &lt;- c("F","KA","KE","V")

set.seed(1234)
x &lt;- rfast99(params = params, n = 200, q = q, q.arg = q.arg, rep = 20)

time &lt;- c(0.25, 0.5, 1, 2, 4, 6, 8, 12, 24)
out &lt;- solve_fun(x, model = FFPK, time = time, vars = "output")


# Check results of sensitivity measures
check(out)
plot(out)
heat_check(out, show.all = TRUE)
heat_check(out, index = "CI")

</code></pre>

<hr>
<h2 id='compile_model'>Model Compiler</h2><span id='topic+compile_model'></span>

<h3>Description</h3>

<p>The <code>compile_model</code> is used to compile the model code that is written under C or <span class="pkg">GNU MCSim</span> format and
generate the executable program in numerical analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compile_model(
  mName,
  application = "mcsim",
  use_model_file = TRUE,
  mcsim_dir = NULL,
  mod_dir = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compile_model_+3A_mname">mName</code></td>
<td>
<p>a string giving the name of the model code (without extension).</p>
</td></tr>
<tr><td><code id="compile_model_+3A_application">application</code></td>
<td>
<p>a character to assign the specific methods (<code>mcsim</code> or <code>R</code>)
that will be applied to the numerical analysis (default is <code>mcsim</code>).
The version must be assigned for Windows user (default is <code>6.2.0</code>).</p>
</td></tr>
<tr><td><code id="compile_model_+3A_use_model_file">use_model_file</code></td>
<td>
<p>a logical value to operate the compiler to model or C file,
the default is set to <code>TRUE</code> to assign the <span class="pkg">GNU MCSim</span>'s model file in compiling.</p>
</td></tr>
<tr><td><code id="compile_model_+3A_mcsim_dir">mcsim_dir</code></td>
<td>
<p>a character to assign the installed location of MCSim directory
(The default is set to home).</p>
</td></tr>
<tr><td><code id="compile_model_+3A_mod_dir">mod_dir</code></td>
<td>
<p>a character giving the name of the directory that is used to store the model file.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generally, the solving function through <span class="pkg">GNU MCSim</span> can provide faster computing speed than exporting C in R.
Therefore, this function set <code>use_model_file = TRUE</code> and <code>application = 'mcsim'</code>
as a default setting, suggesting to use <span class="pkg">GNU MCSim</span> as main solver to solve the differential equation.
To compile model code in Windows, be sure to install Rtools (rtools40) first.
In addition, the <code>version</code> of <span class="pkg">GNU MCSim</span> should provide to conduct model compiling in Windows.
</p>


<h3>Value</h3>

<p>The default <code>application</code> is set to <code>'mcsim'</code>
to generate the executable program to solve differential equations by <span class="pkg">GNU MCSim</span>.
If <code>application = 'R'</code>,
the function will compile and create dynamic-link libraries (.dll) on Windows and
shared objects (.so) on Unix-likes systems (e.g., Linux and MacOS) that can link with <span class="pkg">deSolve</span> solver.
</p>

<hr>
<h2 id='mcsim_install'>Download and install <span class="pkg">GNU MCSim</span></h2><span id='topic+mcsim_install'></span><span id='topic+mcsim_version'></span><span id='topic+set_rtools40_path'></span>

<h3>Description</h3>

<p>Download the latest or specific version of <span class="pkg">GNU MCSim</span> from the official website
(<a href="https://www.gnu.org/software/mcsim/">https://www.gnu.org/software/mcsim/</a>) and install it to the system directory.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mcsim_install(version = "6.2.0", install_dir = NULL, mxstep = 5000)

mcsim_version()

set_rtools40_path()
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mcsim_install_+3A_version">version</code></td>
<td>
<p>a character of version number.</p>
</td></tr>
<tr><td><code id="mcsim_install_+3A_install_dir">install_dir</code></td>
<td>
<p>a character to assign the installed directory.</p>
</td></tr>
<tr><td><code id="mcsim_install_+3A_mxstep">mxstep</code></td>
<td>
<p>a numeric value to assign the maximum number of (internally defined) steps
allowed during one call to the solver.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function aims to help users download (source: https://ftp.gnu.org/gnu/mcsim/)
and install <span class="pkg">GNU MCSim</span> more easily.
However, if you can not install it through this function.
The additional way is to follow the instruction and install it manually:
<a href="https://www.gnu.org/software/mcsim/mcsim.html#Installation">https://www.gnu.org/software/mcsim/mcsim.html#Installation</a>
</p>
<p>The default <code>mxstp</code> is setting to 5000.
The user can increase <code>mxstp</code> to avoid possible error return.
If you meet any error when conduct sensitivity analysis,
you can use this function to re-install <span class="pkg">GNU MCSim</span> and set the higher <code>mxstp</code>.
The default installed <code>directory</code> is under <code>/home/username</code> (Linux),
<code>/Users/username</code> (MacOS),
and <code>C:/Users/username/Documents</code> (windows).
To install <span class="pkg">GNU MCSim</span> in Windows, be sure to install Rtools first.
The current suggested Rtools version is 4.0.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>mcsim_version()</code>: Return the version number.
</p>
</li>
<li> <p><code>set_rtools40_path()</code>: the function to set Rtools40 path
</p>
</li></ul>


<h3>References</h3>

<p>Bois, F. Y., &amp; Maszle, D. R. (1997).
MCSim: a Monte Carlo simulation program.
<em>Journal of Statistical Software</em>, 2(9): 1–60.
</p>
<p><a href="https://www.gnu.org/software/mcsim/">https://www.gnu.org/software/mcsim/</a>
</p>

<hr>
<h2 id='models'>Example PK Model for Sensitivity Analysis</h2><span id='topic+models'></span><span id='topic+FFPK'></span><span id='topic+pbtk1cpt_model'></span><span id='topic+pbpk_apap_model'></span>

<h3>Description</h3>

<p>The example PK model that were used in sensitivity testing.
Three examples are included: Flip-flop pharmacokinetic model,
one-compartment toxicokinetic model from <span class="pkg">httk</span> (Pearce et al. 2017),
and acetaminophen pharmacokinetic model (Zurlinden et al. 2016).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FFPK(params, time, dose = 1)

pbtk1cpt_model()

pbpk_apap_model()
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="models_+3A_params">params</code></td>
<td>
<p>a numeric vector to define the input parameter value.</p>
</td></tr>
<tr><td><code id="models_+3A_time">time</code></td>
<td>
<p>a numeric vector to define the given time point(s).</p>
</td></tr>
<tr><td><code id="models_+3A_dose">dose</code></td>
<td>
<p>a numeric value to define the given dose in flip-flop model.</p>
</td></tr>
</table>


<h3>Functions</h3>


<ul>
<li> <p><code>pbtk1cpt_model()</code>: Download pbtk1cpt.model file.
</p>
</li>
<li> <p><code>pbpk_apap_model()</code>: Download pbpk_apap.model file.
</p>
</li></ul>


<h3>References</h3>

<p>Pearce, R. G., Setzer, R. W., Strope, C. L.,
Wambaugh, J. F., &amp; Sipes, N. S. (2017).
httk: R package for high-throughput toxicokinetics.
<em>Journal of Statistical Software</em>, 79(4), 1-26.
</p>
<p>Zurlinden, T. J., &amp; Reisfeld, B. (2016).
Physiologically based modeling of the pharmacokinetics of acetaminophen and
its major metabolites in humans using a Bayesian population approach.
<em>European journal of drug metabolism and pharmacokinetics</em>,
41(3), 267-280.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>params &lt;- c(F = 0.9, KA = 1.2, KE = 0.2, V = 1.5)
t &lt;- seq(0, 12, 0.1)
C &lt;-FFPK(params = params, time = t)
plot(t, C, type = "l", xlab = "time", ylab = "concentration")

</code></pre>

<hr>
<h2 id='pksim'>PK Simulation from Sampling Parameter</h2><span id='topic+pksim'></span>

<h3>Description</h3>

<p>Create the PK profile of the output results based on the given parameter (uncertainty analysis).
This function is used to visualize the corresponding output PK profile from the input parameters in sensitivity analysis.
If there are multiple outputs in model, the generated result will be the first model variable (default).
A PK plot is generated with median, 25\
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pksim(y, vars = 1, log = F, legend = T, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pksim_+3A_y">y</code></td>
<td>
<p>a numeric array created from <code>solve_fun</code> or <code>solve_mcsim</code> function.</p>
</td></tr>
<tr><td><code id="pksim_+3A_vars">vars</code></td>
<td>
<p>a logical value or character to specific the display variable in simulation (default 1).</p>
</td></tr>
<tr><td><code id="pksim_+3A_log">log</code></td>
<td>
<p>a logical value to transform the y-axis to log scale.</p>
</td></tr>
<tr><td><code id="pksim_+3A_legend">legend</code></td>
<td>
<p>a logical value to display the legend in the created plot.</p>
</td></tr>
<tr><td><code id="pksim_+3A_...">...</code></td>
<td>
<p>additional arguments to customize the graphical parameters.</p>
</td></tr>
</table>

<hr>
<h2 id='rfast99'>Extended Fourier Amplitude Sensitivity Test with Random Phase Shift</h2><span id='topic+rfast99'></span>

<h3>Description</h3>

<p>Applying the extended Fourier amplitude sensitivity Test algorithm to create the numeric sequences for each parameter (Saltelli et al. 1999).
Each sequence is random generated based on the random phase shift approach.
It is an extension based on the <code>fast99</code> function in <span class="pkg">sensitivity</span> package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rfast99(
  params,
  n,
  M = 4,
  omega = NULL,
  q = NULL,
  q.arg = NULL,
  replicate = 5,
  conf = 0.95
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rfast99_+3A_params">params</code></td>
<td>
<p>an integer for the giving number of parameters,
or a vector of character strings giving their names.</p>
</td></tr>
<tr><td><code id="rfast99_+3A_n">n</code></td>
<td>
<p>an integer for the sampling size.</p>
</td></tr>
<tr><td><code id="rfast99_+3A_m">M</code></td>
<td>
<p>an integer specifying the interference parameter. The default is 4.</p>
</td></tr>
<tr><td><code id="rfast99_+3A_omega">omega</code></td>
<td>
<p>a vector giving the set of frequencies.</p>
</td></tr>
<tr><td><code id="rfast99_+3A_q">q</code></td>
<td>
<p>a vector of quantile functions names corresponding to wanted parameters distributions.</p>
</td></tr>
<tr><td><code id="rfast99_+3A_q.arg">q.arg</code></td>
<td>
<p>a list of quantile functions parameters.</p>
</td></tr>
<tr><td><code id="rfast99_+3A_replicate">replicate</code></td>
<td>
<p>an integer to define the number of replication. The default is 5.</p>
</td></tr>
<tr><td><code id="rfast99_+3A_conf">conf</code></td>
<td>
<p>the confidence level for replication confidence intervals. The default is 0.95.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The returned parameter value will be stored in an array with
c(model evaluation, replication, parameters).
</p>


<h3>References</h3>

<p>Saltelli, A., Tarantola, S., &amp; Chan, K. S. (1999).
A quantitative model-independent method for global sensitivity analysis of model output.
<em>Technometrics</em>, 41, 39-56.
</p>
<p>Cukier, R. I., Levine, H. B., &amp; Shuler, K. E. (1978).
Nonlinear sensitivity analysis of multiparameter model systems.
<em>Journal of Computational Physics</em>, 26, 1–42.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate the parameter matrix with 20 replications
q &lt;- "qunif"
q.arg &lt;- list(min = 0, max = 1)

set.seed(1234)
x &lt;- rfast99(params = 3, n = 100, replicate = 20, q = q, q.arg = q.arg)
dim(x$a) # the array of c(model evaluation, replication, parameters).

## Not run: 
save(x, file = "input_parameters.rda")

## End(Not run)

</code></pre>

<hr>
<h2 id='solve_fun'>Solve PK Model Through <span class="pkg">deSolve</span> Package or Analytical Function</h2><span id='topic+solve_fun'></span>

<h3>Description</h3>

<p>Solve time-dependent quantities/concentrations of different variables in PK model
through the imported <code>ode</code> function in <span class="pkg">deSolve</span> package.
It can also be used to solve the function with analytical solution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>solve_fun(
  x,
  time = NULL,
  initParmsfun = "initParms",
  initState,
  dllname = NULL,
  func = "derivs",
  initfunc = "initmod",
  outnames,
  method = "lsode",
  rtol = 1e-08,
  atol = 1e-12,
  model = NULL,
  lnparam = F,
  vars = NULL,
  tell = T,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="solve_fun_+3A_x">x</code></td>
<td>
<p>a list of storing information in the defined sensitivity function.</p>
</td></tr>
<tr><td><code id="solve_fun_+3A_time">time</code></td>
<td>
<p>a vector to define the given time sequence.</p>
</td></tr>
<tr><td><code id="solve_fun_+3A_initparmsfun">initParmsfun</code></td>
<td>
<p>a character for the given specific initial parameter function.</p>
</td></tr>
<tr><td><code id="solve_fun_+3A_initstate">initState</code></td>
<td>
<p>a vector that define the initial values of state variables for the ODE system.</p>
</td></tr>
<tr><td><code id="solve_fun_+3A_dllname">dllname</code></td>
<td>
<p>a string giving the name of the shared library (without extension)
that contains the compiled function.</p>
</td></tr>
<tr><td><code id="solve_fun_+3A_func">func</code></td>
<td>
<p>the name of the function in the dynamically loaded shared library.</p>
</td></tr>
<tr><td><code id="solve_fun_+3A_initfunc">initfunc</code></td>
<td>
<p>the name of the initialization function (which initialises values of parameters), as provided in dllname.</p>
</td></tr>
<tr><td><code id="solve_fun_+3A_outnames">outnames</code></td>
<td>
<p>the names of output variables calculated in the compiled function <code>func</code>.</p>
</td></tr>
<tr><td><code id="solve_fun_+3A_method">method</code></td>
<td>
<p>method used by integrator (<span class="pkg">deSolve</span>).</p>
</td></tr>
<tr><td><code id="solve_fun_+3A_rtol">rtol</code></td>
<td>
<p>argument passed to integrator (<span class="pkg">deSolve</span>).</p>
</td></tr>
<tr><td><code id="solve_fun_+3A_atol">atol</code></td>
<td>
<p>argument passed to integrator (<span class="pkg">deSolve</span>).</p>
</td></tr>
<tr><td><code id="solve_fun_+3A_model">model</code></td>
<td>
<p>the defined analytical equation with functional output.</p>
</td></tr>
<tr><td><code id="solve_fun_+3A_lnparam">lnparam</code></td>
<td>
<p>a logical value that make the statement of the log-transformed parameter (default FALSE).</p>
</td></tr>
<tr><td><code id="solve_fun_+3A_vars">vars</code></td>
<td>
<p>a character for the selected output.</p>
</td></tr>
<tr><td><code id="solve_fun_+3A_tell">tell</code></td>
<td>
<p>a logical value to automatically combine the result y to decoupling simulation x.</p>
</td></tr>
<tr><td><code id="solve_fun_+3A_...">...</code></td>
<td>
<p>additional arguments for <code>deSolve::ode</code> method.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Soetaert, K. E., Petzoldt, T., &amp; Setzer, R. W. (2010).
Solving differential equations in R: package deSolve.
<em>Journal of Statistical Software</em>, 33(9), 1–25.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pksim">pksim</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  q &lt;- "qunif"
  q.arg &lt;- list(list(min = 0.6, max = 1.0),
   list(min = 0.5, max = 1.5),
   list(min = 0.02, max = 0.3),
   list(min = 20, max = 60))

  params &lt;- c("F","KA","KE","V")

  set.seed(1234)
  x &lt;- rfast99(params = params, n = 200, q = q, q.arg = q.arg, rep = 20)

  time &lt;- seq(from = 0.25, to = 12.25, by = 0.5)
  y &lt;- solve_fun(x, model = FFPK, time = time, vars = "output")

  pksim(y) # Visualize uncertainty of model output

</code></pre>

<hr>
<h2 id='solve_mcsim'>Solve PK Model Through <span class="pkg">GNU MCSim</span></h2><span id='topic+solve_mcsim'></span><span id='topic+generate_infile'></span>

<h3>Description</h3>

<p>Solve the differential equations of time-dependent quantity/concentration in different tissues/compartments
through <span class="pkg">GNU MCSim</span>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>solve_mcsim(
  x,
  mName,
  infile.name = NULL,
  outfile.name = NULL,
  setpoint.name = NULL,
  params = NULL,
  vars = NULL,
  times = NULL,
  condition = NULL,
  generate.infile = T,
  tell = T,
  rtol = 1e-06,
  atol = 1e-06,
  monte_carlo = NULL,
  dist = NULL,
  q.arg = NULL,
  parallel = 1
)

generate_infile(
  mod = NULL,
  infile.name = NULL,
  outfile.name = NULL,
  params = NULL,
  vars,
  times,
  condition,
  rtol = 1e-06,
  atol = 1e-06,
  monte_carlo = NULL,
  dist = NULL,
  q.arg = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="solve_mcsim_+3A_x">x</code></td>
<td>
<p>a list of storing information in the defined sensitivity function.</p>
</td></tr>
<tr><td><code id="solve_mcsim_+3A_mname">mName</code></td>
<td>
<p>a string giving the name of the model or C file (without extension).</p>
</td></tr>
<tr><td><code id="solve_mcsim_+3A_infile.name">infile.name</code></td>
<td>
<p>a character to assign the name of input file.</p>
</td></tr>
<tr><td><code id="solve_mcsim_+3A_outfile.name">outfile.name</code></td>
<td>
<p>a character to assign the name of output file.</p>
</td></tr>
<tr><td><code id="solve_mcsim_+3A_setpoint.name">setpoint.name</code></td>
<td>
<p>a character to assign the name of file for parameter matrix.</p>
</td></tr>
<tr><td><code id="solve_mcsim_+3A_params">params</code></td>
<td>
<p>a character to assign the testing parameters.</p>
</td></tr>
<tr><td><code id="solve_mcsim_+3A_vars">vars</code></td>
<td>
<p>a character or a vector to assign the selected output(s).</p>
</td></tr>
<tr><td><code id="solve_mcsim_+3A_times">times</code></td>
<td>
<p>a numeric vector to define the given time point(s).</p>
</td></tr>
<tr><td><code id="solve_mcsim_+3A_condition">condition</code></td>
<td>
<p>a character to set the specific parameter value in the input file.</p>
</td></tr>
<tr><td><code id="solve_mcsim_+3A_generate.infile">generate.infile</code></td>
<td>
<p>a logical value to automatically generate the input file.</p>
</td></tr>
<tr><td><code id="solve_mcsim_+3A_tell">tell</code></td>
<td>
<p>a logical value to automatically combine the result y to decoupling simulation x.</p>
</td></tr>
<tr><td><code id="solve_mcsim_+3A_rtol">rtol</code></td>
<td>
<p>an argument passed to the integrator (default 1e-6).</p>
</td></tr>
<tr><td><code id="solve_mcsim_+3A_atol">atol</code></td>
<td>
<p>an argument passed to the integrator (default 1e-6).</p>
</td></tr>
<tr><td><code id="solve_mcsim_+3A_monte_carlo">monte_carlo</code></td>
<td>
<p>a numeric value to define the sample size in Monte Carlo simulation.</p>
</td></tr>
<tr><td><code id="solve_mcsim_+3A_dist">dist</code></td>
<td>
<p>a vector of distribution names corresponding to <code>&lt;distribution-name&gt;</code> in <span class="pkg">GNU MCSim</span>.</p>
</td></tr>
<tr><td><code id="solve_mcsim_+3A_q.arg">q.arg</code></td>
<td>
<p>a list of shape parameters in the sampling distribution (<code>dist</code>).</p>
</td></tr>
<tr><td><code id="solve_mcsim_+3A_parallel">parallel</code></td>
<td>
<p>a numeric value to assign the number of cores in parallel computing (default is set to 1).</p>
</td></tr>
<tr><td><code id="solve_mcsim_+3A_mod">mod</code></td>
<td>
<p>a list of model and parameters information that is used in solving differential equation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function allows users to use external data file that assigned in <code>setpoint.name</code> as parameter matrix.
If you want to use it, be sure to define <code>n</code> and <code>setpoint.name</code>.
</p>


<h3>Value</h3>

<p>The output result is the 4-dimension array with
c(model evaluations, replications, time-points, output variables).
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>solve_mcsim()</code>: Numerical analysis for the PK model by <span class="pkg">GNU MCSim</span>.
</p>
</li>
<li> <p><code>generate_infile()</code>: Generate the <span class="pkg">GNU MCSim</span> input file.
</p>
</li></ul>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
pbtk1cpt_model()
mName &lt;- "pbtk1cpt"
compile_model(mName)

q &lt;- "qunif"
q.arg &lt;- list(list(min = 0.4, max = 1.1),
              list(min = 0.1, max = 0.4),
              list(min = 1.0, max = 3.0))

params &lt;- c("vdist", "ke", "kgutabs")

set.seed(1234)
x &lt;- rfast99(params = params, n = 200, q = q, q.arg = q.arg, rep = 20)

infile.name &lt;- "example.in"
outfile.name &lt;- "example.csv"
vars &lt;- "Ccompartment"

t &lt;- seq(from = 0.25, to = 12.25, by = 0.5)

y &lt;- solve_mcsim(x, mName = mName, infile.name = infile.name,
                 setpoint.name = "setpoint.dat",
                 outfile.name = outfile.name, params = params, vars = vars, time = t,
                 condition = "Agutlument = 10")
pksim(y)

## End(Not run)

</code></pre>

<hr>
<h2 id='tell2'>The Decoupling Simulations</h2><span id='topic+tell2'></span>

<h3>Description</h3>

<p>Integrate the decoupling simulations (parameter sequences) and estimation results
to compute the sensitivity measures.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tell2(x, y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tell2_+3A_x">x</code></td>
<td>
<p>a list of storing information in the defined sensitivity function.</p>
</td></tr>
<tr><td><code id="tell2_+3A_y">y</code></td>
<td>
<p>a numeric array generated from the solutions of <code>solve_fun</code>
or <code>solve_mcsim</code> function.</p>
</td></tr>
</table>


<h3>Source</h3>

<p>This function is based on <code>tell</code> function in <span class="pkg">sensitivity</span> package,
which is an S3 generic method to estimate sensitivity measures by combining sensitivity object (<code>rfast99</code>) and external simulation results.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
