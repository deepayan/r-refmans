<!DOCTYPE html><html><head><title>Help for package whippr</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {whippr}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#whippr-package'><p>whippr: Tools for Manipulating Gas Exchange Data</p></a></li>
<li><a href='#+25+26gt+3B+25'><p>Pipe operator</p></a></li>
<li><a href='#detect_outliers'><p>Detect outliers</p></a></li>
<li><a href='#get_residuals'><p>Get residuals</p></a></li>
<li><a href='#incremental_normalize'><p>Normalize incremental test data</p></a></li>
<li><a href='#interpolate'><p>Interpolate data from breath-by-breath into second-by-second</p></a></li>
<li><a href='#model_diagnostics'><p>Model diagnostics</p></a></li>
<li><a href='#new_whippr_tibble'><p>Construct a new tibble with metadata</p></a></li>
<li><a href='#normalize_first_breath'><p>Normalize first breath</p></a></li>
<li><a href='#normalize_time'><p>Normalize time column</p></a></li>
<li><a href='#normalize_transitions'><p>Normalize transitions</p></a></li>
<li><a href='#outliers_anomaly'><p>Anomaly method for detecting outliers from an incremental test</p></a></li>
<li><a href='#outliers_linear'><p>Linear method for detecting outliers from an incremental test</p></a></li>
<li><a href='#perform_average'><p>Perform average on second-by-second data</p></a></li>
<li><a href='#perform_kinetics'><p>Perform VO2 kinetics fitting</p></a></li>
<li><a href='#perform_max'><p>Perform VO2max calculation</p></a></li>
<li><a href='#plot_incremental'><p>Plot incremental test work rate</p></a></li>
<li><a href='#plot_outliers'><p>Plot outliers</p></a></li>
<li><a href='#predict_bands'><p>Extract confidence and prediction bands</p></a></li>
<li><a href='#predict_bands_baseline'><p>Extract confidence and prediction bands for the baseline phase</p></a></li>
<li><a href='#predict_bands_transition'><p>Extract confidence and prediction bands for the transition phase</p></a></li>
<li><a href='#print.whippr'><p>Whippr print method</p></a></li>
<li><a href='#process_data'><p>Process data for VO2 kinetics fitting</p></a></li>
<li><a href='#read_data'><p>Read data from metabolic cart</p></a></li>
<li><a href='#remove_empty'><p>Remove empty rows and/or columns from a data.frame or matrix.</p></a></li>
<li><a href='#run_manual_cleaner'><p>Manual data cleaner</p></a></li>
<li><a href='#theme_whippr'><p>Whippr ggplot2 theme</p></a></li>
<li><a href='#undoHistory'><p>Undo/Redo History Buttons</p></a></li>
<li><a href='#vo2_kinetics'><p>VO2 kinetics</p></a></li>
<li><a href='#vo2_max'><p>VO2max</p></a></li>
<li><a href='#work_rate_ramp'><p>Work rate for a ramp-incremental test</p></a></li>
<li><a href='#work_rate_step'><p>Work rate for a step-incremental test</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Tools for Manipulating Gas Exchange Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.3</td>
</tr>
<tr>
<td>Description:</td>
<td>Set of tools for manipulating gas exchange data from cardiopulmonary exercise testing.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://fmmattioni.github.io/whippr/">https://fmmattioni.github.io/whippr/</a>,
<a href="https://github.com/fmmattioni/whippr">https://github.com/fmmattioni/whippr</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/fmmattioni/whippr/issues">https://github.com/fmmattioni/whippr/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Imports:</td>
<td>readxl (&ge; 1.3.1), dplyr (&ge; 1.0.1), stringr (&ge; 1.4.0),
lubridate (&ge; 1.7.9), magrittr, tibble, zoo, purrr, tidyr (&ge;
1.1.1), broom (&ge; 0.7.0), cli, ggplot2 (&ge; 3.4.0), glue,
minpack.lm, patchwork (&ge; 1.0.1), rlang, nlstools, pillar</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.0</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, fansi, collapsibleTree, testthat, shiny,
miniUI, datapasta, rstudioapi, htmltools, readr, anomalize,
ggforce, ggtext, forcats</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-19 07:41:51 UTC; fmattioni</td>
</tr>
<tr>
<td>Author:</td>
<td>Felipe Mattioni Maturana
    <a href="https://orcid.org/0000-0002-4221-6104"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Felipe Mattioni Maturana &lt;felipe.mattioni@med.uni-tuebingen.de&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-19 08:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='whippr-package'>whippr: Tools for Manipulating Gas Exchange Data</h2><span id='topic+whippr'></span><span id='topic+whippr-package'></span>

<h3>Description</h3>

<p><img src="../help/figures/logo.png" style='float: right' alt='logo' width='120' />
</p>
<p>Set of tools for manipulating gas exchange data from cardiopulmonary exercise testing.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Felipe Mattioni Maturana <a href="mailto:felipe.mattioni@med.uni-tuebingen.de">felipe.mattioni@med.uni-tuebingen.de</a> (<a href="https://orcid.org/0000-0002-4221-6104">ORCID</a>)
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://fmmattioni.github.io/whippr/">https://fmmattioni.github.io/whippr/</a>
</p>
</li>
<li> <p><a href="https://github.com/fmmattioni/whippr">https://github.com/fmmattioni/whippr</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/fmmattioni/whippr/issues">https://github.com/fmmattioni/whippr/issues</a>
</p>
</li></ul>


<hr>
<h2 id='+25+26gt+3B+25'>Pipe operator</h2><span id='topic++25+3E+25'></span>

<h3>Description</h3>

<p>See <code>magrittr::<a href="magrittr.html#topic+pipe">%&gt;%</a></code> for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lhs %&gt;% rhs
</code></pre>

<hr>
<h2 id='detect_outliers'>Detect outliers</h2><span id='topic+detect_outliers'></span>

<h3>Description</h3>

<p>It detects outliers based on prediction bands for the given level of confidence provided.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>detect_outliers(
  .data,
  test_type = c("incremental", "kinetics"),
  vo2_column = "VO2",
  cleaning_level = 0.95,
  cleaning_baseline_fit,
  protocol_n_transitions,
  protocol_baseline_length,
  protocol_transition_length,
  method_incremental = c("linear", "anomaly"),
  verbose = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="detect_outliers_+3A_.data">.data</code></td>
<td>
<p>Data retrieved from <code>read_data()</code> for a <strong>kinetics</strong> test, or
the data retrieved from <code>incremental_normalize()</code> for a <strong>incremental</strong> test.</p>
</td></tr>
<tr><td><code id="detect_outliers_+3A_test_type">test_type</code></td>
<td>
<p>The test to be analyzed. Either 'incremental' or 'kinetics'.</p>
</td></tr>
<tr><td><code id="detect_outliers_+3A_vo2_column">vo2_column</code></td>
<td>
<p>The name (quoted) of the column containing the absolute oxygen uptake (VO2) data. Default to <code>VO2</code>.</p>
</td></tr>
<tr><td><code id="detect_outliers_+3A_cleaning_level">cleaning_level</code></td>
<td>
<p>A numeric scalar between 0 and 1 giving the confidence level for the intervals to be calculated. Default to <code>0.95</code>.</p>
</td></tr>
<tr><td><code id="detect_outliers_+3A_cleaning_baseline_fit">cleaning_baseline_fit</code></td>
<td>
<p>For <strong>kinetics</strong> test only. A vector of the same length as the number in <code>protocol_n_transitions</code>, indicating what kind of fit to perform for each baseline. Vector accepts characters either 'linear' or 'exponential'.</p>
</td></tr>
<tr><td><code id="detect_outliers_+3A_protocol_n_transitions">protocol_n_transitions</code></td>
<td>
<p>For <strong>kinetics</strong> test only. Number of transitions performed.</p>
</td></tr>
<tr><td><code id="detect_outliers_+3A_protocol_baseline_length">protocol_baseline_length</code></td>
<td>
<p>For <strong>kinetics</strong> test only. The length of the baseline (in seconds).</p>
</td></tr>
<tr><td><code id="detect_outliers_+3A_protocol_transition_length">protocol_transition_length</code></td>
<td>
<p>For <strong>kinetics</strong> test only. The length of the transition (in seconds).</p>
</td></tr>
<tr><td><code id="detect_outliers_+3A_method_incremental">method_incremental</code></td>
<td>
<p>The method to be used in detecting outliers from the
incremental test. Either 'linear' or 'anomaly'. See <code>Details</code>.</p>
</td></tr>
<tr><td><code id="detect_outliers_+3A_verbose">verbose</code></td>
<td>
<p>A boolean indicating whether messages should be printed in the console. Default to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="detect_outliers_+3A_...">...</code></td>
<td>
<p>Additional arguments. Currently ignored.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>TODO
</p>


<h3>Value</h3>

<p>a <a href="tibble.html#topic+tibble-package">tibble</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## get file path from example data
path_example &lt;- system.file("example_cosmed.xlsx", package = "whippr")

## read data
df &lt;- read_data(path = path_example, metabolic_cart = "cosmed")

## detect outliers
data_outliers &lt;- detect_outliers(
  .data = df,
  test_type = "kinetics",
  vo2_column = "VO2",
  cleaning_level = 0.95,
  cleaning_baseline_fit = c("linear", "exponential", "exponential"),
  protocol_n_transitions = 3,
  protocol_baseline_length = 360,
  protocol_transition_length = 360,
  verbose = TRUE
 )

## get file path from example data
path_example_ramp &lt;- system.file("ramp_cosmed.xlsx", package = "whippr")

## read data from ramp test
df_ramp &lt;- read_data(path = path_example_ramp, metabolic_cart = "cosmed")

## normalize incremental test data
ramp_normalized &lt;- df_ramp %&gt;%
 incremental_normalize(
   .data = .,
   incremental_type = "ramp",
   has_baseline = TRUE,
   baseline_length = 240,
   work_rate_magic = TRUE,
   baseline_intensity = 20,
   ramp_increase = 25
 )

## detect ramp outliers
data_ramp_outliers &lt;- detect_outliers(
  .data = ramp_normalized,
  test_type = "incremental",
  vo2_column = "VO2",
  cleaning_level = 0.95,
  method_incremental = "linear",
  verbose = TRUE
 )

## End(Not run)
</code></pre>

<hr>
<h2 id='get_residuals'>Get residuals</h2><span id='topic+get_residuals'></span>

<h3>Description</h3>

<p>Computes residuals from the VO2 kinetics model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_residuals(.model)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_residuals_+3A_.model">.model</code></td>
<td>
<p>A model of class <code>nls</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <a href="tibble.html#topic+tibble-package">tibble</a> containing the data passed to augment, and additional columns:
</p>
<table>
<tr><td><code>.fitted</code></td>
<td>
<p>The predicted response for that observation.</p>
</td></tr>
<tr><td><code>.resid</code></td>
<td>
<p>The residual for a particular point.</p>
</td></tr>
<tr><td><code>standardized_residuals</code></td>
<td>
<p>Standardized residuals.</p>
</td></tr>
<tr><td><code>sqrt_abs_standardized_residuals</code></td>
<td>
<p>The sqrt of absolute value of standardized residuals.</p>
</td></tr>
<tr><td><code>lag_residuals</code></td>
<td>
<p>The lag of the <code>.resid</code> column for plotting auto-correlation.</p>
</td></tr>
</table>

<hr>
<h2 id='incremental_normalize'>Normalize incremental test data</h2><span id='topic+incremental_normalize'></span>

<h3>Description</h3>

<p>Detect protocol phases (baseline, ramp, steps), normalize work rate, and
time-align baseline phase (baseline time becomes negative).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>incremental_normalize(
  .data,
  incremental_type = c("ramp", "step"),
  has_baseline = TRUE,
  baseline_length = NULL,
  work_rate_magic = FALSE,
  baseline_intensity = NULL,
  ramp_increase = NULL,
  step_start = NULL,
  step_increase = NULL,
  step_length = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="incremental_normalize_+3A_.data">.data</code></td>
<td>
<p>Data retrieved from <code>read_data()</code>.</p>
</td></tr>
<tr><td><code id="incremental_normalize_+3A_incremental_type">incremental_type</code></td>
<td>
<p>The type of the incremental test performed. Either &quot;ramp&quot; or &quot;step&quot;.</p>
</td></tr>
<tr><td><code id="incremental_normalize_+3A_has_baseline">has_baseline</code></td>
<td>
<p>A boolean to indicate whether the data contains a baseline phase. This is used for an incremental test only. Default to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="incremental_normalize_+3A_baseline_length">baseline_length</code></td>
<td>
<p>The baseline length (in seconds) performed.</p>
</td></tr>
<tr><td><code id="incremental_normalize_+3A_work_rate_magic">work_rate_magic</code></td>
<td>
<p>A boolean indicating whether to perform the work rate calculations. When set to <code>TRUE</code>,
it will calculate the work rate throughout a ramp or step test. In the case of a step test, it will also
perform a linear transformation of the work rate.
If set to <code>TRUE</code>, the arguments below should be given. Default to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="incremental_normalize_+3A_baseline_intensity">baseline_intensity</code></td>
<td>
<p>A numeric atomic vector indicating the work rate of the baseline. If the baseline was performed at rest, indicate <code>0</code>.</p>
</td></tr>
<tr><td><code id="incremental_normalize_+3A_ramp_increase">ramp_increase</code></td>
<td>
<p>A numeric atomic vector indicating the ramp increase in watts per minute (W/min). For example, if the ramp
was <code style="white-space: pre;">&#8288;30 W/min&#8288;</code>, then pass the number <code>30</code> to this argument.</p>
</td></tr>
<tr><td><code id="incremental_normalize_+3A_step_start">step_start</code></td>
<td>
<p>In case your baseline was performed at rest, you can set in this parameter at which intensity
the step test started.</p>
</td></tr>
<tr><td><code id="incremental_normalize_+3A_step_increase">step_increase</code></td>
<td>
<p>A numeric atomic vector indicating the step increase, in watts. For example, if the step increase was
<code style="white-space: pre;">&#8288;25 W&#8288;</code> at each step, then pass the number <code>25</code> to this argument.</p>
</td></tr>
<tr><td><code id="incremental_normalize_+3A_step_length">step_length</code></td>
<td>
<p>A numeric atomic vector indicating the length (in seconds) of each step in the step incremental test.</p>
</td></tr>
<tr><td><code id="incremental_normalize_+3A_...">...</code></td>
<td>
<p>Additional arguments. Currently ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <a href="tibble.html#topic+tibble-package">tibble</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## get file path from example data
path_example &lt;- system.file("ramp_cosmed.xlsx", package = "whippr")

## read data from ramp test
df &lt;- read_data(path = path_example, metabolic_cart = "cosmed")

## normalize incremental test data
ramp_normalized &lt;- df %&gt;%
 incremental_normalize(
   .data = .,
   incremental_type = "ramp",
   has_baseline = TRUE,
   baseline_length = 240,
   work_rate_magic = TRUE,
   baseline_intensity = 20,
   ramp_increase = 25
 )

## get file path from example data
path_example_step &lt;- system.file("step_cortex.xlsx", package = "whippr")

## read data from step test
df_step &lt;- read_data(path = path_example_step, metabolic_cart = "cortex")

## normalize incremental test data
step_normalized &lt;- df_step %&gt;%
 incremental_normalize(
   .data = .,
   incremental_type = "step",
   has_baseline = TRUE,
   baseline_length = 120,
   work_rate_magic = TRUE,
   baseline_intensity = 0,
   step_start = 50,
   step_increase = 25,
   step_length = 180
 )

## End(Not run)
</code></pre>

<hr>
<h2 id='interpolate'>Interpolate data from breath-by-breath into second-by-second</h2><span id='topic+interpolate'></span>

<h3>Description</h3>

<p>This function interpolates the data based on the time column. It takes the breath-by-breath data
and transforms it into second-by-second.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>interpolate(.data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="interpolate_+3A_.data">.data</code></td>
<td>
<p>Data retrieved from <code>read_data()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <a href="tibble.html#topic+tibble-package">tibble</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## get file path from example data
path_example &lt;- system.file("example_cosmed.xlsx", package = "whippr")

## read data
df &lt;- read_data(path = path_example, metabolic_cart = "cosmed")

df %&gt;%
 interpolate()

## End(Not run)
</code></pre>

<hr>
<h2 id='model_diagnostics'>Model diagnostics</h2><span id='topic+model_diagnostics'></span>

<h3>Description</h3>

<p>Plots different model diagnostics for checking the model performance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>model_diagnostics(.residuals_tbl)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="model_diagnostics_+3A_.residuals_tbl">.residuals_tbl</code></td>
<td>
<p>The data retrived from <code>get_residuals()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a patchwork object
</p>

<hr>
<h2 id='new_whippr_tibble'>Construct a new tibble with metadata</h2><span id='topic+new_whippr_tibble'></span>

<h3>Description</h3>

<p>Construct a new tibble with metadata
</p>


<h3>Usage</h3>

<pre><code class='language-R'>new_whippr_tibble(.data, metadata)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="new_whippr_tibble_+3A_.data">.data</code></td>
<td>
<p>A data frame</p>
</td></tr>
<tr><td><code id="new_whippr_tibble_+3A_metadata">metadata</code></td>
<td>
<p>Metadata to be passed along with the data</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <a href="tibble.html#topic+tibble-package">tibble</a>
</p>

<hr>
<h2 id='normalize_first_breath'>Normalize first breath</h2><span id='topic+normalize_first_breath'></span>

<h3>Description</h3>

<p>This is needed specially when the data gets filtered. For example, if the data file does not only contain
the baseline and transitions performed, we will have to normalize the time column.
This function will make sure that in case the first breath does not start at zero, it will create a zero data point,
duplicating the first breath. This will make sure the data does not get shifted (misalignment).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>normalize_first_breath(.data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="normalize_first_breath_+3A_.data">.data</code></td>
<td>
<p>Breath-by-breath data.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <a href="tibble.html#topic+tibble-package">tibble</a>
</p>

<hr>
<h2 id='normalize_time'>Normalize time column</h2><span id='topic+normalize_time'></span>

<h3>Description</h3>

<p>Normalizes the the time column such that the baseline phase has negative time values. Point zero will then represent the start of the transition phase.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>normalize_time(.data, protocol_baseline_length)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="normalize_time_+3A_.data">.data</code></td>
<td>
<p>Breath-by-breath data.</p>
</td></tr>
<tr><td><code id="normalize_time_+3A_protocol_baseline_length">protocol_baseline_length</code></td>
<td>
<p>The length of the baseline (in seconds).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <a href="tibble.html#topic+tibble-package">tibble</a>
</p>

<hr>
<h2 id='normalize_transitions'>Normalize transitions</h2><span id='topic+normalize_transitions'></span>

<h3>Description</h3>

<p>Recognizes and normalizes the time column of each transition. It will also label the transitions into: 'baseline' or 'transition'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>normalize_transitions(
  .data,
  protocol_n_transitions,
  protocol_baseline_length,
  protocol_transition_length
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="normalize_transitions_+3A_.data">.data</code></td>
<td>
<p>Breath-by-breath data.</p>
</td></tr>
<tr><td><code id="normalize_transitions_+3A_protocol_n_transitions">protocol_n_transitions</code></td>
<td>
<p>Number of transitions performed.</p>
</td></tr>
<tr><td><code id="normalize_transitions_+3A_protocol_baseline_length">protocol_baseline_length</code></td>
<td>
<p>The length of the baseline (in seconds).</p>
</td></tr>
<tr><td><code id="normalize_transitions_+3A_protocol_transition_length">protocol_transition_length</code></td>
<td>
<p>The length of the transition (in seconds).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <a href="tibble.html#topic+tibble-package">tibble</a>
</p>

<hr>
<h2 id='outliers_anomaly'>Anomaly method for detecting outliers from an incremental test</h2><span id='topic+outliers_anomaly'></span>

<h3>Description</h3>

<p>Function for internal use only. It will not be exported.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>outliers_anomaly(.data, time_column, vo2_column, cleaning_level)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="outliers_anomaly_+3A_.data">.data</code></td>
<td>
<p>The data retrieved from <code>incremental_normalize()</code>.</p>
</td></tr>
<tr><td><code id="outliers_anomaly_+3A_time_column">time_column</code></td>
<td>
<p>The name (quoted) of the column containing the time. Depending on the language of your system, this column might not be &quot;t&quot;. Therefore, you may specify it here.</p>
</td></tr>
<tr><td><code id="outliers_anomaly_+3A_vo2_column">vo2_column</code></td>
<td>
<p>The name (quoted) of the column containing the absolute oxygen uptake (VO2) data.</p>
</td></tr>
<tr><td><code id="outliers_anomaly_+3A_cleaning_level">cleaning_level</code></td>
<td>
<p>A numeric scalar between 0 and 1 giving the confidence level for the intervals to be calculated.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <a href="tibble.html#topic+tibble-package">tibble</a>
</p>

<hr>
<h2 id='outliers_linear'>Linear method for detecting outliers from an incremental test</h2><span id='topic+outliers_linear'></span>

<h3>Description</h3>

<p>Function for internal use only. It will not be exported.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>outliers_linear(.data, time_column, vo2_column, cleaning_level)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="outliers_linear_+3A_.data">.data</code></td>
<td>
<p>The data retrieved from <code>incremental_normalize()</code>.</p>
</td></tr>
<tr><td><code id="outliers_linear_+3A_time_column">time_column</code></td>
<td>
<p>The name (quoted) of the column containing the time. Depending on the language of your system, this column might not be &quot;t&quot;. Therefore, you may specify it here.</p>
</td></tr>
<tr><td><code id="outliers_linear_+3A_vo2_column">vo2_column</code></td>
<td>
<p>The name (quoted) of the column containing the absolute oxygen uptake (VO2) data.</p>
</td></tr>
<tr><td><code id="outliers_linear_+3A_cleaning_level">cleaning_level</code></td>
<td>
<p>A numeric scalar between 0 and 1 giving the confidence level for the intervals to be calculated.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <a href="tibble.html#topic+tibble-package">tibble</a>
</p>

<hr>
<h2 id='perform_average'>Perform average on second-by-second data</h2><span id='topic+perform_average'></span>

<h3>Description</h3>

<p>This function performs either a bin- or a rolling-average on the interpolated data.
You must specify the <code>type</code> of the average before continuing.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>perform_average(
  .data,
  type = c("bin", "rolling", "ensemble"),
  bins = 30,
  rolling_window = 30
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="perform_average_+3A_.data">.data</code></td>
<td>
<p>The second-by-second data retrieved from <code>interpolate()</code>.</p>
</td></tr>
<tr><td><code id="perform_average_+3A_type">type</code></td>
<td>
<p>The type of the average to perform. Either <code>bin</code>, <code>rolling</code>, or <code>ensemble</code>.</p>
</td></tr>
<tr><td><code id="perform_average_+3A_bins">bins</code></td>
<td>
<p>If bin-average is chosen, here you can specify the size of the bin-average, in seconds. Default to 30-s bin-average.</p>
</td></tr>
<tr><td><code id="perform_average_+3A_rolling_window">rolling_window</code></td>
<td>
<p>If rolling-average is chosen, here you can specify the rolling-average window, in seconds. Default to 30-s rolling-average.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Ensemble average is used in VO2 kinetics analysis, where a series of transitions from baseline to
the moderate/heavy/severe intensity-domain is ensembled averaged into a single 'bout' for further data processing.
</p>


<h3>Value</h3>

<p>a <a href="tibble.html#topic+tibble-package">tibble</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## get file path from example data
path_example &lt;- system.file("example_cosmed.xlsx", package = "whippr")

## read data
df &lt;- read_data(path = path_example, metabolic_cart = "cosmed")

## interpolate and perform 30-s bin-average
df %&gt;%
 interpolate() %&gt;%
 perform_average(type = "bin", bins = 30)

## interpolate and perform 30-s rolling-average
df %&gt;%
 interpolate() %&gt;%
 perform_average(type = "rolling", rolling_window = 30)

## End(Not run)
</code></pre>

<hr>
<h2 id='perform_kinetics'>Perform VO2 kinetics fitting</h2><span id='topic+perform_kinetics'></span>

<h3>Description</h3>

<p>Performs the fitting process for the VO2 kinetics analysis. At this point, the data should already have been cleaned (outliers removed) and processed
(interpolated, time-aligned, ensembled-averaged, and bin-averaged).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>perform_kinetics(
  .data_processed,
  intensity_domain = c("moderate", "heavy", "severe"),
  fit_level = 0.95,
  fit_phase_1_length,
  fit_baseline_length,
  fit_transition_length,
  verbose = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="perform_kinetics_+3A_.data_processed">.data_processed</code></td>
<td>
<p>The data retrieved from <code>process_data()</code>.</p>
</td></tr>
<tr><td><code id="perform_kinetics_+3A_intensity_domain">intensity_domain</code></td>
<td>
<p>The exercise-intensity domain that the test was performed. Either <em>moderate</em>, <em>heavy</em>, or <em>severe</em>.</p>
</td></tr>
<tr><td><code id="perform_kinetics_+3A_fit_level">fit_level</code></td>
<td>
<p>A numeric scalar between 0 and 1 giving the confidence level for the parameter estimates in the final VO2 kinetics fit. Default to <code>0.95</code>.</p>
</td></tr>
<tr><td><code id="perform_kinetics_+3A_fit_phase_1_length">fit_phase_1_length</code></td>
<td>
<p>The length of the phase I that you wish to exclude from the final exponential fit, in seconds. See  <code style="white-space: pre;">&#8288;VO2 kinetics&#8288;</code> section in <code>?vo2_kinetics</code> for more details.</p>
</td></tr>
<tr><td><code id="perform_kinetics_+3A_fit_baseline_length">fit_baseline_length</code></td>
<td>
<p>The length the baseline to perform the final linear fit, in seconds. See <code style="white-space: pre;">&#8288;VO2 kinetics&#8288;</code> section <code>?vo2_kinetics</code> for more details.</p>
</td></tr>
<tr><td><code id="perform_kinetics_+3A_fit_transition_length">fit_transition_length</code></td>
<td>
<p>The length of the transition to perform the final exponential fit, in seconds. See <code style="white-space: pre;">&#8288;VO2 kinetics&#8288;</code> section <code>?vo2_kinetics</code> for more details.</p>
</td></tr>
<tr><td><code id="perform_kinetics_+3A_verbose">verbose</code></td>
<td>
<p>A boolean indicating whether messages should be printed in the console. Default to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="perform_kinetics_+3A_...">...</code></td>
<td>
<p>Additional arguments when fitting VO2 kinetics in the heavy- or severe-intensity domains. Arguments may be the following:
</p>

<dl>
<dt><code>TODO</code></dt><dd></dd>
</dl>
</td></tr>
</table>


<h3>Details</h3>

<p>See <code>?vo2_kinetics</code> for details.
</p>


<h3>Value</h3>

<p>a <code><a href="tibble.html#topic+tibble-package">tibble</a></code> containing one row and the nested columns:
</p>
<table>
<tr><td><code>data_fitted</code></td>
<td>
<p>The data containing the time and VO2 columns, as well as the fitted data and its residuals for each data point.</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>A <code>nls</code> object. The model used in the VO2 kinetics fitting.</p>
</td></tr>
<tr><td><code>model_summary</code></td>
<td>
<p>The tidied summary of the <code>model</code>.</p>
</td></tr>
<tr><td><code>model_residuals</code></td>
<td>
<p>The residuals of the <code>model</code>.</p>
</td></tr>
<tr><td><code>plot_model</code></td>
<td>
<p>The final plot of the fitted <code>model</code>.</p>
</td></tr>
<tr><td><code>plot_residuals</code></td>
<td>
<p>The residuals plot for the <code>model</code> diagnostics.</p>
</td></tr>
</table>

<hr>
<h2 id='perform_max'>Perform VO2max calculation</h2><span id='topic+perform_max'></span>

<h3>Description</h3>

<p>It performs the calculation of VO2max, HRmax, and maximal RER. Additionally, it detects whether a plateau can be identified from your data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>perform_max(
  .data,
  vo2_column = "VO2",
  vo2_relative_column = NULL,
  heart_rate_column = NULL,
  rer_column = NULL,
  average_method = c("bin", "rolling"),
  average_length = 30,
  plot = TRUE,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="perform_max_+3A_.data">.data</code></td>
<td>
<p>The data retrieved either from <code>incremental_normalize()</code> or <code>detect_outliers()</code>.</p>
</td></tr>
<tr><td><code id="perform_max_+3A_vo2_column">vo2_column</code></td>
<td>
<p>The name (quoted) of the column containing the absolute oxygen uptake (VO2) data. Default to <code>"VO2"</code>.</p>
</td></tr>
<tr><td><code id="perform_max_+3A_vo2_relative_column">vo2_relative_column</code></td>
<td>
<p>The name (quoted) of the column containing the relative to body weight oxygen uptake (VO2) data. Default to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="perform_max_+3A_heart_rate_column">heart_rate_column</code></td>
<td>
<p>The name (quoted) of the column containing the heart rate (HR) data. Default to <code>NULL</code>. If <code>NULL</code>, this parameter will not be calculated.</p>
</td></tr>
<tr><td><code id="perform_max_+3A_rer_column">rer_column</code></td>
<td>
<p>The name (quoted) of the column containing the respiratory exchange ratio (RER) data. Default to <code>NULL</code>. If <code>NULL</code>, this parameter will not be calculated.</p>
</td></tr>
<tr><td><code id="perform_max_+3A_average_method">average_method</code></td>
<td>
<p>The average method to be used for VO2max calculation. One of <code>bin</code> or <code>rolling</code>.</p>
</td></tr>
<tr><td><code id="perform_max_+3A_average_length">average_length</code></td>
<td>
<p>The length, in seconds, of the average to be used. For example, if <code>average_method = bin</code>, and <code>average_length = 30</code>, it will perform a 30-s bin-average.</p>
</td></tr>
<tr><td><code id="perform_max_+3A_plot">plot</code></td>
<td>
<p>A boolean indicating whether to produce a plot with the summary results. Default to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="perform_max_+3A_verbose">verbose</code></td>
<td>
<p>A boolean indicating whether messages should be printed in the console. Default to <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a tibble
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## get file path from example data
path_example &lt;- system.file("ramp_cosmed.xlsx", package = "whippr")

## read data from ramp test
df &lt;- read_data(path = path_example, metabolic_cart = "cosmed")

## normalize incremental test data
ramp_normalized &lt;- df %&gt;%
 incremental_normalize(
   .data = .,
   incremental_type = "ramp",
   has_baseline = TRUE,
   baseline_length = 240,
   work_rate_magic = TRUE,
   baseline_intensity = 20,
   ramp_increase = 25
 )

## detect outliers
data_ramp_outliers &lt;- detect_outliers(
 .data = ramp_normalized,
 test_type = "incremental",
 vo2_column = "VO2",
 cleaning_level = 0.95,
 method_incremental = "linear",
 verbose = TRUE
)

## analyze VO2max
perform_max(
 .data = data_ramp_outliers,
 vo2_column = "VO2",
 vo2_relative_column = "VO2/Kg",
 heart_rate_column = "HR",
 rer_column = "R",
 average_method = "bin",
 average_length = 30,
 plot = TRUE,
 verbose = FALSE
)

## End(Not run)
</code></pre>

<hr>
<h2 id='plot_incremental'>Plot incremental test work rate</h2><span id='topic+plot_incremental'></span>

<h3>Description</h3>

<p>Visualize what was done during the process of deriving the work rate from the incremental test protocol
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_incremental(.data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_incremental_+3A_.data">.data</code></td>
<td>
<p>data retrieved from <code>incremental_normalize()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a ggplot object
</p>

<hr>
<h2 id='plot_outliers'>Plot outliers</h2><span id='topic+plot_outliers'></span>

<h3>Description</h3>

<p>Plot outliers
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_outliers(.data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_outliers_+3A_.data">.data</code></td>
<td>
<p>The data retrieved from <code>detect_outliers()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a patchwork object
</p>

<hr>
<h2 id='predict_bands'>Extract confidence and prediction bands</h2><span id='topic+predict_bands'></span>

<h3>Description</h3>

<p>It extracts confidence and prediction bands from the <code>nls</code> model. It is used only for data cleaning.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predict_bands(
  .data,
  time_column = "t",
  vo2_column = "VO2",
  cleaning_level = 0.95,
  cleaning_baseline_fit = c("linear", "exponential")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict_bands_+3A_.data">.data</code></td>
<td>
<p>The nornalized data retrieved from <code>normalize_transitions()</code>.</p>
</td></tr>
<tr><td><code id="predict_bands_+3A_time_column">time_column</code></td>
<td>
<p>The name (quoted) of the column containing the time. Depending on the language of your system, this column might not be &quot;t&quot;. Therefore, you may specify it here.  Default to &quot;t&quot;.</p>
</td></tr>
<tr><td><code id="predict_bands_+3A_vo2_column">vo2_column</code></td>
<td>
<p>The name (quoted) of the column containing the absolute oxygen uptake (VO2) data. Default to 'VO2'.</p>
</td></tr>
<tr><td><code id="predict_bands_+3A_cleaning_level">cleaning_level</code></td>
<td>
<p>A numeric scalar between 0 and 1 giving the confidence level for the intervals to be calculated.</p>
</td></tr>
<tr><td><code id="predict_bands_+3A_cleaning_baseline_fit">cleaning_baseline_fit</code></td>
<td>
<p>A character indicating what kind of fit to perform for each baseline. Either 'linear' or 'exponential'.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <a href="tibble.html#topic+tibble-package">tibble</a> containing the following columns:
</p>
<table>
<tr><td><code>x</code></td>
<td>
<p>The provided time data.</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>The provided VO2 data.</p>
</td></tr>
<tr><td><code>.fitted</code></td>
<td>
<p>The predicted response for that observation.</p>
</td></tr>
<tr><td><code>.resid</code></td>
<td>
<p>The residual for a particular point.</p>
</td></tr>
<tr><td><code>lwr_conf</code></td>
<td>
<p>Lower limit of the confidence band.</p>
</td></tr>
<tr><td><code>upr_conf</code></td>
<td>
<p>Upper limit of the confidence band.</p>
</td></tr>
<tr><td><code>lwr_pred</code></td>
<td>
<p>Lower limit of the prediction band.</p>
</td></tr>
<tr><td><code>upr_pred</code></td>
<td>
<p>Upper limit of the prediction band.</p>
</td></tr>
</table>

<hr>
<h2 id='predict_bands_baseline'>Extract confidence and prediction bands for the baseline phase</h2><span id='topic+predict_bands_baseline'></span>

<h3>Description</h3>

<p>Extract confidence and prediction bands for the baseline phase
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predict_bands_baseline(
  .data,
  time_column,
  vo2_column,
  cleaning_level,
  cleaning_baseline_fit
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict_bands_baseline_+3A_.data">.data</code></td>
<td>
<p>The nornalized data retrieved from <code>normalize_transitions()</code>. The data should be filtered to only the 'baseline' phase before passing to the function.</p>
</td></tr>
<tr><td><code id="predict_bands_baseline_+3A_time_column">time_column</code></td>
<td>
<p>The name (quoted) of the column containing the time. Depending on the language of your system, this column might not be &quot;t&quot;. Therefore, you may specify it here.  Default to &quot;t&quot;.</p>
</td></tr>
<tr><td><code id="predict_bands_baseline_+3A_vo2_column">vo2_column</code></td>
<td>
<p>The name (quoted) of the column containing the absolute oxygen uptake (VO2) data. Default to 'VO2'.</p>
</td></tr>
<tr><td><code id="predict_bands_baseline_+3A_cleaning_level">cleaning_level</code></td>
<td>
<p>A numeric scalar between 0 and 1 giving the confidence level for the intervals to be calculated.</p>
</td></tr>
<tr><td><code id="predict_bands_baseline_+3A_cleaning_baseline_fit">cleaning_baseline_fit</code></td>
<td>
<p>A character indicating what kind of fit to perform for each baseline. Either 'linear' or 'exponential'.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <a href="tibble.html#topic+tibble-package">tibble</a> containing the following columns:
</p>
<table>
<tr><td><code>x</code></td>
<td>
<p>The provided time data.</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>The provided VO2 data.</p>
</td></tr>
<tr><td><code>.fitted</code></td>
<td>
<p>The predicted response for that observation.</p>
</td></tr>
<tr><td><code>.resid</code></td>
<td>
<p>The residual for a particular point.</p>
</td></tr>
<tr><td><code>lwr_conf</code></td>
<td>
<p>Lower limit of the confidence band.</p>
</td></tr>
<tr><td><code>upr_conf</code></td>
<td>
<p>Upper limit of the confidence band.</p>
</td></tr>
<tr><td><code>lwr_pred</code></td>
<td>
<p>Lower limit of the prediction band.</p>
</td></tr>
<tr><td><code>upr_pred</code></td>
<td>
<p>Upper limit of the prediction band.</p>
</td></tr>
</table>

<hr>
<h2 id='predict_bands_transition'>Extract confidence and prediction bands for the transition phase</h2><span id='topic+predict_bands_transition'></span>

<h3>Description</h3>

<p>Extract confidence and prediction bands for the transition phase
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predict_bands_transition(
  .data,
  time_column,
  vo2_column,
  cleaning_level,
  cleaning_model
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict_bands_transition_+3A_.data">.data</code></td>
<td>
<p>The nornalized data retrieved from <code>normalize_transitions()</code>. The data should be filtered to only the 'transition' phase before passing to the function.</p>
</td></tr>
<tr><td><code id="predict_bands_transition_+3A_time_column">time_column</code></td>
<td>
<p>The name (quoted) of the column containing the time. Depending on the language of your system, this column might not be &quot;t&quot;. Therefore, you may specify it here.  Default to &quot;t&quot;.</p>
</td></tr>
<tr><td><code id="predict_bands_transition_+3A_vo2_column">vo2_column</code></td>
<td>
<p>The name (quoted) of the column containing the absolute oxygen uptake (VO2) data. Default to 'VO2'.</p>
</td></tr>
<tr><td><code id="predict_bands_transition_+3A_cleaning_level">cleaning_level</code></td>
<td>
<p>A numeric scalar between 0 and 1 giving the confidence level for the intervals to be calculated.</p>
</td></tr>
<tr><td><code id="predict_bands_transition_+3A_cleaning_model">cleaning_model</code></td>
<td>
<p>The <code>nls</code> model to retrieve the bands from.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <a href="tibble.html#topic+tibble-package">tibble</a> containing the following columns:
</p>
<table>
<tr><td><code>x</code></td>
<td>
<p>The provided time data.</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>The provided VO2 data.</p>
</td></tr>
<tr><td><code>.fitted</code></td>
<td>
<p>The predicted response for that observation.</p>
</td></tr>
<tr><td><code>.resid</code></td>
<td>
<p>The residual for a particular point.</p>
</td></tr>
<tr><td><code>lwr_conf</code></td>
<td>
<p>Lower limit of the confidence band.</p>
</td></tr>
<tr><td><code>upr_conf</code></td>
<td>
<p>Upper limit of the confidence band.</p>
</td></tr>
<tr><td><code>lwr_pred</code></td>
<td>
<p>Lower limit of the prediction band.</p>
</td></tr>
<tr><td><code>upr_pred</code></td>
<td>
<p>Upper limit of the prediction band.</p>
</td></tr>
</table>

<hr>
<h2 id='print.whippr'>Whippr print method</h2><span id='topic+print.whippr'></span>

<h3>Description</h3>

<p>Whippr print method
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'whippr'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.whippr_+3A_x">x</code></td>
<td>
<p>A tibble with class 'whippr'</p>
</td></tr>
<tr><td><code id="print.whippr_+3A_...">...</code></td>
<td>
<p>Extra arguments, not used.</p>
</td></tr>
</table>

<hr>
<h2 id='process_data'>Process data for VO2 kinetics fitting</h2><span id='topic+process_data'></span>

<h3>Description</h3>

<p>It removes the outliers detected through <code>detect_outliers()</code>, interpolates each transition,
ensemble-averages all the transitions into one, performs a bin-average, and normalizes the time column
(time zero will indicate the end of baseline and the start of the transition phase).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>process_data(.data_outliers, protocol_baseline_length, fit_bin_average)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="process_data_+3A_.data_outliers">.data_outliers</code></td>
<td>
<p>The data retrived from <code>detect_outliers()</code>.</p>
</td></tr>
<tr><td><code id="process_data_+3A_protocol_baseline_length">protocol_baseline_length</code></td>
<td>
<p>The length of the baseline (in seconds).</p>
</td></tr>
<tr><td><code id="process_data_+3A_fit_bin_average">fit_bin_average</code></td>
<td>
<p>The bin average to be performed for the final fit.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>TODO
</p>


<h3>Value</h3>

<p>a <a href="tibble.html#topic+tibble-package">tibble</a> with the time-aligned, ensembled-averaged, and bin-averaged data.
</p>

<hr>
<h2 id='read_data'>Read data from metabolic cart</h2><span id='topic+read_data'></span>

<h3>Description</h3>

<p>It reads the raw data exported from the metabolic cart.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_data(
  path,
  metabolic_cart = c("cosmed", "cortex", "nspire", "parvo", "geratherm", "cardiocoach",
    "custom"),
  time_column = "t",
  work_rate_column = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read_data_+3A_path">path</code></td>
<td>
<p>Path to read the file from.</p>
</td></tr>
<tr><td><code id="read_data_+3A_metabolic_cart">metabolic_cart</code></td>
<td>
<p>Metabolic cart that was used for data collection. Currently, 'cosmed', 'cortex', 'nspire', 'parvo', 'geratherm', and 'cardiocoach' are supported. Additionaly, there is an option called 'custom' that supports files that do not have a metabolic cart-specific format.</p>
</td></tr>
<tr><td><code id="read_data_+3A_time_column">time_column</code></td>
<td>
<p>The name (quoted) of the column containing the time. Depending on the language of your system, this column might not be &quot;t&quot;. Therefore, you may specify it here.  Default to &quot;t&quot;.</p>
</td></tr>
<tr><td><code id="read_data_+3A_work_rate_column">work_rate_column</code></td>
<td>
<p>Default is <code>NULL</code>. In case your work rate column is coerced as a character column
you can define here the name of this column in your data file. This happens because at the very beginning of the test
the system may input a character like &quot;-&quot; to indicate no work rate. Therefore this is not going to get recognized as a numeric column.
If your work rate column is called <code>WR</code>, for example, just pass <code>"WR"</code> to this argument.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <a href="tibble.html#topic+tibble-package">tibble</a>
</p>

<hr>
<h2 id='remove_empty'>Remove empty rows and/or columns from a data.frame or matrix.</h2><span id='topic+remove_empty'></span>

<h3>Description</h3>

<p>Removes all rows and/or columns from a data.frame or matrix that
are composed entirely of <code>NA</code> values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>remove_empty(dat, which = c("rows", "cols"), cutoff = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="remove_empty_+3A_dat">dat</code></td>
<td>
<p>the input data.frame or matrix.</p>
</td></tr>
<tr><td><code id="remove_empty_+3A_which">which</code></td>
<td>
<p>one of &quot;rows&quot;, &quot;cols&quot;, or <code>c("rows", "cols")</code>.  Where no
value of which is provided, defaults to removing both empty rows and empty
columns, declaring the behavior with a printed message.</p>
</td></tr>
<tr><td><code id="remove_empty_+3A_cutoff">cutoff</code></td>
<td>
<p>What fraction (&gt;0 to &lt;=1) of rows or columns must be empty to
be removed?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the object without its missing rows or columns.
</p>

<hr>
<h2 id='run_manual_cleaner'>Manual data cleaner</h2><span id='topic+run_manual_cleaner'></span>

<h3>Description</h3>

<p>Usually manual data cleaning should be avoided. However, sometimes in gas exchange data
there is the need to delete a few clear &quot;bad breaths&quot; (noise). In these situations you may use this function.
Although it is encouraged that you use the <code>detect_outliers()</code> function, you may use this function at your own risk.
This function can also be used to clean other kind of data, like heart rate data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>run_manual_cleaner(.data, width = 1200, height = 900)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="run_manual_cleaner_+3A_.data">.data</code></td>
<td>
<p>The data to be manually cleaned. The first column will be always treated as the x-axis.</p>
</td></tr>
<tr><td><code id="run_manual_cleaner_+3A_width">width</code></td>
<td>
<p>The width, in pixels, of the window.</p>
</td></tr>
<tr><td><code id="run_manual_cleaner_+3A_height">height</code></td>
<td>
<p>the height, in pixels, of the window.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The code to reproduce the manual data cleaning.
</p>

<hr>
<h2 id='theme_whippr'>Whippr ggplot2 theme</h2><span id='topic+theme_whippr'></span>

<h3>Description</h3>

<p>This theme was inspired by the plots from the Acta Physiologica Journal
</p>


<h3>Usage</h3>

<pre><code class='language-R'>theme_whippr(base_size = 14, base_family = "sans")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="theme_whippr_+3A_base_size">base_size</code></td>
<td>
<p>base font size, given in pts. Default is <code>14</code>.</p>
</td></tr>
<tr><td><code id="theme_whippr_+3A_base_family">base_family</code></td>
<td>
<p>base font family. Default is <code>sans</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a ggplot2 object
</p>

<hr>
<h2 id='undoHistory'>Undo/Redo History Buttons</h2><span id='topic+undoHistory'></span>

<h3>Description</h3>

<p>This is a simple Shiny module for undo/redo history. The Shiny module accepts
an arbitrary reactive data value. Changes in the state of this reactive value
are tracked and added to the user's history. The user can then repeatedly
undo and redo to walk through this stack. The module returns the current
selected value of the reactive from this historical stack, or <code>NULL</code> when
the app state was changed by the user. Because this reactive can hold
arbitrary data about the state of the Shiny app, it is up to the app
developer to use the returned current value to update the Shiny apps' inputs
and UI elements.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>undoHistory(id, value, value_debounce_rate = 500)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="undoHistory_+3A_id">id</code></td>
<td>
<p>The module id</p>
</td></tr>
<tr><td><code id="undoHistory_+3A_value">value</code></td>
<td>
<p>The reactive expression with the values should be saved for the
user's history. This expression can contain arbitrary data and be of any
structure as long as it returns a single value (or list). Each change in
this value is stored, so the module may not work well for storing large
data sets.</p>
</td></tr>
<tr><td><code id="undoHistory_+3A_value_debounce_rate">value_debounce_rate</code></td>
<td>
<p>Debounce rate in milliseconds for the <code>value</code>
reactive expression. To avoid saving spurious changes in <code>value</code>, the
expression is debounced. See <code><a href="shiny.html#topic+debounce">shiny::debounce()</a></code> for more information.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The <code>undoHistory()</code> module returns the currently selected history
item as the user moves through the stack, or <code>NULL</code> if the last update
was the result of user input. The returned value has the same structure as
the reactive <code>value</code> passed to <code>undoHistory()</code>.
</p>

<hr>
<h2 id='vo2_kinetics'>VO2 kinetics</h2><span id='topic+vo2_kinetics'></span>

<h3>Description</h3>

<p>It performs the whole process of the VO2 kinetics data analysis, which includes:
data cleaning (<code>detect_outliers()</code>); outliers removal, interpolation, ensemble-averaging transitions and bin-avering final dataset (<code>process_data()</code>),
and modelling VO2 kinetics (<code>perform_kinetics()</code>). This function is a general function that will call these separate functions.
You can also call each one of them separately if you want.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vo2_kinetics(
  .data,
  intensity_domain = c("moderate", "heavy", "severe"),
  vo2_column = "VO2",
  protocol_n_transitions,
  protocol_baseline_length,
  protocol_transition_length,
  cleaning_level = 0.95,
  cleaning_baseline_fit,
  fit_level = 0.95,
  fit_bin_average,
  fit_phase_1_length,
  fit_baseline_length,
  fit_transition_length,
  verbose = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vo2_kinetics_+3A_.data">.data</code></td>
<td>
<p>Data retrieved from <code>read_data()</code>.</p>
</td></tr>
<tr><td><code id="vo2_kinetics_+3A_intensity_domain">intensity_domain</code></td>
<td>
<p>The exercise-intensity domain that the test was performed. Either <em>moderate</em>, <em>heavy</em>, or <em>severe</em>.</p>
</td></tr>
<tr><td><code id="vo2_kinetics_+3A_vo2_column">vo2_column</code></td>
<td>
<p>The name (quoted) of the column containing the absolute oxygen uptake (VO2) data. Default to <code>"VO2"</code>.</p>
</td></tr>
<tr><td><code id="vo2_kinetics_+3A_protocol_n_transitions">protocol_n_transitions</code></td>
<td>
<p>Number of transitions performed.</p>
</td></tr>
<tr><td><code id="vo2_kinetics_+3A_protocol_baseline_length">protocol_baseline_length</code></td>
<td>
<p>The length of the baseline (in seconds).</p>
</td></tr>
<tr><td><code id="vo2_kinetics_+3A_protocol_transition_length">protocol_transition_length</code></td>
<td>
<p>The length of the transition (in seconds).</p>
</td></tr>
<tr><td><code id="vo2_kinetics_+3A_cleaning_level">cleaning_level</code></td>
<td>
<p>A numeric scalar between 0 and 1 giving the confidence level for the intervals to be calculated during the data cleaning process. Breaths lying outside the prediction bands will be excluded. Default to <code>0.95</code>.</p>
</td></tr>
<tr><td><code id="vo2_kinetics_+3A_cleaning_baseline_fit">cleaning_baseline_fit</code></td>
<td>
<p>A vector of the same length as the number in <code>protocol_n_transitions</code>, indicating what kind of fit to perform for each baseline. Either <em>linear</em> or <em>exponential</em>.</p>
</td></tr>
<tr><td><code id="vo2_kinetics_+3A_fit_level">fit_level</code></td>
<td>
<p>A numeric scalar between 0 and 1 giving the confidence level for the parameter estimates in the final VO2 kinetics fit. Default to <code>0.95</code>.</p>
</td></tr>
<tr><td><code id="vo2_kinetics_+3A_fit_bin_average">fit_bin_average</code></td>
<td>
<p>The bin average to be performed for the final fit.</p>
</td></tr>
<tr><td><code id="vo2_kinetics_+3A_fit_phase_1_length">fit_phase_1_length</code></td>
<td>
<p>The length of the phase I that you wish to exclude from the final exponential fit, in seconds. See  <code style="white-space: pre;">&#8288;VO2 kinetics&#8288;</code> section for more details.</p>
</td></tr>
<tr><td><code id="vo2_kinetics_+3A_fit_baseline_length">fit_baseline_length</code></td>
<td>
<p>The length the baseline to perform the final linear fit, in seconds. See <code style="white-space: pre;">&#8288;VO2 kinetics&#8288;</code> section for more details.</p>
</td></tr>
<tr><td><code id="vo2_kinetics_+3A_fit_transition_length">fit_transition_length</code></td>
<td>
<p>The length of the transition to perform the final exponential fit, in seconds. See <code style="white-space: pre;">&#8288;VO2 kinetics&#8288;</code> section for more details.</p>
</td></tr>
<tr><td><code id="vo2_kinetics_+3A_verbose">verbose</code></td>
<td>
<p>A boolean indicating whether messages should be printed in the console. Default to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="vo2_kinetics_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code>perform_kinetics()</code> when fitting VO2 kinetics in the heavy- or severe-intensity domains. See <code>?perform_kinetics</code> for more details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function is a wrapper of smaller functions and has important arguments:
</p>

<ul>
<li> <p><strong>protocol_</strong> = sets arguments related to the protocol used.
</p>
</li>
<li> <p><strong>cleaning_</strong> = sets arguments related to data cleaning.
</p>
</li>
<li> <p><strong>fit_</strong> = sets arguments related to VO2 kinetics fitting.
</p>
</li></ul>

<p>The function works like the following sequence:
</p>
<p><strong><code>vo2_kinetics( )</code></strong>:
</p>

<ul>
<li> <p><code>detect_outliers( )</code> = separates the data into the number of transitions indicated,
and fits each baseline and transition phase indiviudally, retrieving the predictions bands for the level indicated.
Then it recognizes breaths lying outside the prediciton bands and flag them as outliers.
</p>
</li>
<li> <p><code>plot_outliers( )</code> = plots each transition identifying outliers.
</p>
</li>
<li> <p><code>process_data( )</code> = It removes the outliers detected through <code>detect_outliers()</code>, interpolates each transition,
ensemble-averages all the transitions into one, performs a bin-average, and normalizes the time column
(time zero will indicate the end of baseline and the start of the transition phase).
</p>
</li>
<li> <p><code>perform_kinetics( )</code> = performs the VO2 kinetics fitting based on the <strong>fit_</strong> parameters given.
It also calculates the residuals, and plots the final fit as well as residuals for model diagnostics.
</p>
</li></ul>



<h3>Value</h3>

<p>a <a href="tibble.html#topic+tibble-package">tibble</a> containing one row and the nested columns:
</p>
<table>
<tr><td><code>data_outliers</code></td>
<td>
<p>The raw data containing additional columns that identify breaths as outliers.</p>
</td></tr>
<tr><td><code>plot_outliers</code></td>
<td>
<p>A <code>patchwork</code> object to display outliers from every transition.</p>
</td></tr>
<tr><td><code>data_processed</code></td>
<td>
<p>The processed data (time-aligned, ensembled-averaged, and bin-averaged).</p>
</td></tr>
<tr><td><code>data_fitted</code></td>
<td>
<p>The data containing the time and VO2 columns, as well as the fitted data and its residuals for each data point.</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>A <code>nls</code> object. The model used in the VO2 kinetics fitting.</p>
</td></tr>
<tr><td><code>model_summary</code></td>
<td>
<p>The tidied summary of the <code>model</code>.</p>
</td></tr>
<tr><td><code>model_residuals</code></td>
<td>
<p>The residuals of the <code>model</code>.</p>
</td></tr>
<tr><td><code>plot_model</code></td>
<td>
<p>The final plot of the fitted <code>model</code>.</p>
</td></tr>
<tr><td><code>plot_residuals</code></td>
<td>
<p>The residuals plot for the <code>model</code> diagnostics.</p>
</td></tr>
</table>


<h3>VO2 kinetics</h3>

<p>VO2 kinetics, described as the rate of adjustment of the oxidative energy system to an
instantaneous increase in the energy demand, is exponential in nature, and it is described by the
oxygen uptake (VO2) time-constant (<code class="reqn">\tau</code>VO2) (Murias, Spencer and Paterson (2014); Poole and Jones (2011)).
</p>
<p>VO2 kinetics analysis provides understanding of the mechanisms that regulate the rate at which oxidative
phosphorylation adapts to step changes in exercise intensities and ATP requirement. This is usually accomplished
by performing step transitions from a baseline intensity to a higher work rate in either the <strong>moderate-</strong>, <strong>heavy-</strong>, or
<strong>severe-intensity domain</strong> (Murias et al., 2011).
</p>
<p>Three distinct phases may be observed in the VO2 response during on-transient exercise:
</p>
<p><strong>Phase I</strong>: also termed as the cardiodynamic phase, it represents the circulatory transit delay
on the VO2 response as a result of the increase in the pulmonary blood flow that does not reflect the increase
in oxygen extraction in the active muscles. The time-window of the Phase I is determined in the <strong><code>fit_phase_1_length</code></strong> argument, which will be internally passed into the <code>perform_kinetics()</code> function.
</p>
<p><strong>Phase II</strong>: also termed as the primary component, represents the exponential increase in VO2
related to the continued increase in pulmonary and muscle blood flow. The Phase II is described by the time-constant parameter (<code class="reqn">\tau</code>)
in the mono-exponential model (see below), and it is defined as the duration of time (in seconds) for the VO2 response
to increase to 63% of the required steady-state.
</p>
<p><strong>Phase III</strong>: represents the steady-state phase of the VO2 response
during moderate-intensity exercise.
</p>


<h4>Moderate-intensity domain</h4>

<p>The on-transient response from baseline to a transition within the <strong>moderate-intensity domain</strong>
is analyzed using a <strong>mono-exponential model</strong>:
</p>
<p style="text-align: center;"><code class="reqn">VO_{2\left(t\right)}=baseline+amplitude\cdot\left(1-e^{^{-\frac{\left(t-TD\right)}{tau}}}\right)</code>
</p>

<p>where:
</p>

<ul>
<li> <p><code>VO2(t)</code> = the oxygen uptake at any given time.
</p>
</li>
<li> <p><code>baseline</code> = the oxygen uptake associated with the baseline phase.
</p>
</li>
<li> <p><code>amplitude</code> = the steady-state increase increase in oxygen uptake above <code>baseline</code>.
</p>
</li>
<li> <p><code>TD</code> = the time delay.
</p>
</li>
<li> <p><code class="reqn">\tau</code> = the time constant defined as the duration of time for the oxygen uptake to increase to 63% of the steady-state increase.
</p>
</li></ul>

<p>The baseline value in the mono-exponential model is a <strong>fixed</strong> value and pre-determined
as the mean of the VO2 response (i.e., linear model with the slope set as zero) during the baseline phase.
The time window of the baseline period is determined in the <strong><code>fit_baseline_length</code></strong> argument, which will be internally passed into the <code>perform_kinetics()</code> function.
</p>
<p>Diverse exercise protocols exist to determine VO2 kinetics in the moderate-intensity domain.
Usually, the protocol consists of multiple transitions (typically 3 or 4) from a baseline exercise-intensity to an exercise-intensity
below the gas exchange threshold (typically the power output associated with 90% of the gas exchange threshold). Bbaseline and
transition phases are usually performed for 6 minutes each. The reason that 6 minutes is done for each phase is to give enough time for both
to reach a steady-state response:
</p>
<p>For example, for each multiple of the time-constant (<code class="reqn">\tau</code>), VO2 increases by 63% of the
difference between the previous <code class="reqn">\tau</code> and the required steady-state.
This means:
</p>

<ul>
<li> <p><code>1</code> <code class="reqn">\tau</code> <code style="white-space: pre;">&#8288;= 63%&#8288;</code> <code class="reqn">\Delta</code>.
</p>
</li>
<li> <p><code>2</code> <code class="reqn">\tau</code> <code style="white-space: pre;">&#8288;= 86%&#8288;</code> <code class="reqn">\Delta</code> <code style="white-space: pre;">&#8288;[100% - 63% = 37%; (37% x 63%) + 63% = 86%]&#8288;</code>.
</p>
</li>
<li> <p><code>3</code> <code class="reqn">\tau</code> <code style="white-space: pre;">&#8288;= 95%&#8288;</code> <code class="reqn">\Delta</code> <code style="white-space: pre;">&#8288;[100% - 86% = 14%; (14% x 63%) + 86% = 95%]&#8288;</code>.
</p>
</li>
<li> <p><code>4</code> <code class="reqn">\tau</code> <code style="white-space: pre;">&#8288;= 98%&#8288;</code> <code class="reqn">\Delta</code> <code style="white-space: pre;">&#8288;[100% - 95% = 5%; (5% x 63%) + 95% = 98%]&#8288;</code>.
</p>
</li></ul>

<p>In practical terms, let's imagine that a given participant has a <strong><code class="reqn">\tau</code> = 60 seconds</strong>. This means that this person
would need <strong>240 seconds</strong> (<code style="white-space: pre;">&#8288;4 x 60&#8288;</code>) to reach <strong>steady-state</strong> (98% of the response) in the <strong>moderate-intensity domain</strong>. This would leave other
120 seconds (2 minutes) of transition, so the protocol of performing 6-min transitions makes sure enough time is given.
</p>
<p>Now let's imagine that another person has a <strong><code class="reqn">\tau</code> = 20 seconds</strong>. This means that this person
would need <strong>80 seconds</strong> (<code style="white-space: pre;">&#8288;4 x 20&#8288;</code>) to reach <strong>steady-state</strong> (98% of the response) in the <strong>moderate-intensity domain</strong>.
</p>
<p>Given that there is enough time to reach a VO2 steady-state response with 6 minutes of transition, that means that for the final fit
(when the transitions were cleaned, ensembled-averaged, and bin-averaged) there is no need to include the whole 6 minutes of the transition.
This strategy avoids superfluous sections of the steadystate data, thus maximizing the quality of the fit during the exercise ontransient (Bell et al., 2001).
This may be specified through the <strong><code>fit_transition_length</code></strong> argument, which will be internally passed into the <code>perform_kinetics()</code> function.
</p>
<p>As for bin-averages in the final fit, usually the data are averaged into 5-s or 10-s bins, 5-s being the most common (Keir et al., 2014).
This may be specified through the <strong><code>fit_bin_average</code></strong> argument, which will be internally passed into the <code>process_data()</code> function.
</p>



<h4>Heavy- and severe-intensity domains</h4>

<p>TODO
</p>



<h3>References</h3>

<p>Bell, C., Paterson, D. H., Kowalchuk, J. M., Padilla, J., &amp; Cunningham, D. A. (2001). A comparison of modelling techniques used to characterise oxygen uptake kinetics during the on-transient of exercise. Experimental Physiology, 86(5), 667-676.
</p>
<p>Keir, D. A., Murias, J. M., Paterson, D. H., &amp; Kowalchuk, J. M. (2014). Breathbybreath pulmonary O2 uptake kinetics: effect of data processing on confidence in estimating model parameters. Experimental physiology, 99(11), 1511-1522.
</p>
<p>Murias, J. M., Spencer, M. D., &amp; Paterson, D. H. (2014). The critical role of O2 provision in the dynamic adjustment of oxidative phosphorylation. Exercise and sport sciences reviews, 42(1), 4-11.
</p>
<p>Murias, J. M., Spencer, M. D., Kowalchuk, J. M., &amp; Paterson, D. H. (2011). Influence of phase I duration on phase II VO2 kinetics parameter estimates in older and young adults. American Journal of Physiology-regulatory, integrative and comparative physiology, 301(1), R218-R224.
</p>
<p>Poole, D. C., &amp; Jones, A. M. (2011). Oxygen uptake kinetics. Comprehensive Physiology, 2(2), 933-996.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## get file path from example data
path_example &lt;- system.file("example_cosmed.xlsx", package = "whippr")

## read data
df &lt;- read_data(path = path_example, metabolic_cart = "cosmed", time_column = "t")

## VO2 kinetics analysis
results_kinetics &lt;- vo2_kinetics(
  .data = df,
  intensity_domain = "moderate",
  vo2_column = "VO2",
  protocol_n_transitions = 3,
  protocol_baseline_length = 360,
  protocol_transition_length = 360,
  cleaning_level = 0.95,
  cleaning_baseline_fit = c("linear", "exponential", "exponential"),
  fit_level = 0.95,
  fit_bin_average = 5,
  fit_phase_1_length = 20,
  fit_baseline_length = 120,
  fit_transition_length = 240,
  verbose = TRUE
)

## End(Not run)
</code></pre>

<hr>
<h2 id='vo2_max'>VO2max</h2><span id='topic+vo2_max'></span>

<h3>Description</h3>

<p>It performs the whole process of the VO2max data analysis, which includes:
data standardization and normalization according to incremental protocol (<code>incremental_normalize()</code>),
'bad breaths' detection (<code>detect_outliers()</code>),
mean response time calculation (<code>incremental_mrt()</code>) (currently ignored),
and maximal values calculation (VO2, PO, HR, RER) (<code>perform_max()</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vo2_max(
  .data,
  vo2_column = "VO2",
  vo2_relative_column = NULL,
  heart_rate_column = NULL,
  rer_column = NULL,
  detect_outliers = TRUE,
  average_method = c("bin", "rolling"),
  average_length = 30,
  mrt,
  plot = TRUE,
  verbose = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vo2_max_+3A_.data">.data</code></td>
<td>
<p>Data retrieved from <code>read_data()</code>.</p>
</td></tr>
<tr><td><code id="vo2_max_+3A_vo2_column">vo2_column</code></td>
<td>
<p>The name (quoted) of the column containing the absolute oxygen uptake (VO2) data. Default to <code>"VO2"</code>.</p>
</td></tr>
<tr><td><code id="vo2_max_+3A_vo2_relative_column">vo2_relative_column</code></td>
<td>
<p>The name (quoted) of the column containing the relative to body weight oxygen uptake (VO2) data. Default to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="vo2_max_+3A_heart_rate_column">heart_rate_column</code></td>
<td>
<p>The name (quoted) of the column containing the heart rate (HR) data. Default to <code>NULL</code>. If <code>NULL</code>, this parameter will not be calculated.</p>
</td></tr>
<tr><td><code id="vo2_max_+3A_rer_column">rer_column</code></td>
<td>
<p>The name (quoted) of the column containing the respiratory exchange ratio (RER) data. Default to <code>NULL</code>. If <code>NULL</code>, this parameter will not be calculated.</p>
</td></tr>
<tr><td><code id="vo2_max_+3A_detect_outliers">detect_outliers</code></td>
<td>
<p>A boolean indicating whether to detect outliers. Default to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="vo2_max_+3A_average_method">average_method</code></td>
<td>
<p>The average method to be used for VO2max calculation. One of <code>bin</code> or <code>rolling</code>.</p>
</td></tr>
<tr><td><code id="vo2_max_+3A_average_length">average_length</code></td>
<td>
<p>The length, in seconds, of the average to be used. For example, if <code>average_method = bin</code>, and <code>average_length = 30</code>, it will perform a 30-s bin-average.</p>
</td></tr>
<tr><td><code id="vo2_max_+3A_mrt">mrt</code></td>
<td>
<p>A boolean indicating whether to calculate the mean response time. To be implemented soon &lt;-  currently ignored.</p>
</td></tr>
<tr><td><code id="vo2_max_+3A_plot">plot</code></td>
<td>
<p>A boolean indicating whether to produce a plot with the summary results. Default to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="vo2_max_+3A_verbose">verbose</code></td>
<td>
<p>A boolean indicating whether messages should be printed in the console. Default to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="vo2_max_+3A_...">...</code></td>
<td>
<p>Additional arguments passed onto <code>incremental_normalize()</code>, <code>detect_outliers()</code> if <code>detect_outliers = TRUE</code>, and  <code>incremental_mrt()</code> if <code>mrt = TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>TODO
</p>


<h3>Value</h3>

<p>a <a href="tibble.html#topic+tibble-package">tibble</a> containing one row and the following columns:
</p>
<table>
<tr><td><code>VO2max_absolute</code></td>
<td>
<p>The absolute VO2max.</p>
</td></tr>
<tr><td><code>VO2max_relative</code></td>
<td>
<p>The relative VO2max.</p>
</td></tr>
<tr><td><code>POpeak</code></td>
<td>
<p>The peak power output.</p>
</td></tr>
<tr><td><code>HRmax</code></td>
<td>
<p>The maximal heart rate.</p>
</td></tr>
<tr><td><code>RERmax</code></td>
<td>
<p>The maximal RER.</p>
</td></tr>
<tr><td><code>plot</code></td>
<td>
<p>The plot, if <code>plot = TRUE</code>.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## get file path from example data
path_example &lt;- system.file("ramp_cosmed.xlsx", package = "whippr")

## read data from ramp test
df &lt;- read_data(path = path_example, metabolic_cart = "cosmed")

## normalize incremental test data
ramp_normalized &lt;- df %&gt;%
 incremental_normalize(
   .data = .,
   incremental_type = "ramp",
   has_baseline = TRUE,
   baseline_length = 240,
   work_rate_magic = TRUE,
   baseline_intensity = 20,
   ramp_increase = 25
 )

## detect outliers
data_ramp_outliers &lt;- detect_outliers(
 .data = ramp_normalized,
 test_type = "incremental",
 vo2_column = "VO2",
 cleaning_level = 0.95,
 method_incremental = "linear",
 verbose = TRUE
)

## analyze VO2max
perform_max(
 .data = data_ramp_outliers,
 vo2_column = "VO2",
 vo2_relative_column = "VO2/Kg",
 heart_rate_column = "HR",
 rer_column = "R",
 average_method = "bin",
 average_length = 30,
 plot = TRUE,
 verbose = FALSE
)

## End(Not run)

</code></pre>

<hr>
<h2 id='work_rate_ramp'>Work rate for a ramp-incremental test</h2><span id='topic+work_rate_ramp'></span>

<h3>Description</h3>

<p>This function produces the work rate throughout a ramp-incremental test given the procotol
</p>


<h3>Usage</h3>

<pre><code class='language-R'>work_rate_ramp(.data, baseline_intensity, ramp_increase)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="work_rate_ramp_+3A_.data">.data</code></td>
<td>
<p>The data with recognized protocol phases</p>
</td></tr>
<tr><td><code id="work_rate_ramp_+3A_baseline_intensity">baseline_intensity</code></td>
<td>
<p>The baseline intensity</p>
</td></tr>
<tr><td><code id="work_rate_ramp_+3A_ramp_increase">ramp_increase</code></td>
<td>
<p>The ramp increase, in watts per minute</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <a href="tibble.html#topic+tibble-package">tibble</a>
</p>

<hr>
<h2 id='work_rate_step'>Work rate for a step-incremental test</h2><span id='topic+work_rate_step'></span>

<h3>Description</h3>

<p>This function produces the work rate throughout a step-incremental test given the protocol
This will retrieve both the 'original' work rates, and also will perform a 'linearization' of the steps.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>work_rate_step(
  .data,
  baseline_intensity,
  step_start,
  step_increase,
  step_length
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="work_rate_step_+3A_.data">.data</code></td>
<td>
<p>The data with recognized protocol phases</p>
</td></tr>
<tr><td><code id="work_rate_step_+3A_baseline_intensity">baseline_intensity</code></td>
<td>
<p>The baseline intensity</p>
</td></tr>
<tr><td><code id="work_rate_step_+3A_step_start">step_start</code></td>
<td>
<p>In case the step test started in a different work rate than baseline</p>
</td></tr>
<tr><td><code id="work_rate_step_+3A_step_increase">step_increase</code></td>
<td>
<p>The step in increase, in watts per step</p>
</td></tr>
<tr><td><code id="work_rate_step_+3A_step_length">step_length</code></td>
<td>
<p>The length, in seconds, of each step</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <a href="tibble.html#topic+tibble-package">tibble</a>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
