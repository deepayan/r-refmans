<!DOCTYPE html><html><head><title>Help for package NNMIS</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {NNMIS}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#coxph.pool'><p>Estimate Cox regression model pooling over the imputed datasets</p></a></li>
<li><a href='#km.pool'><p>Perform Kaplan-Meier estmation over the multiply imputed survival data sets</p></a></li>
<li><a href='#nnmi'><p>A nnmi class</p></a></li>
<li><a href='#NNMIS'><p>Nearest Neighbor Based Multiple Imputation for Survival Data with Mssing Covariates (NNMIS)</p></a></li>
<li><a href='#plotKM'><p>Plot function for pooled Kaplan-Meier estimates</p></a></li>
<li><a href='#print.nnmi'><p>Print function for object of 'nnmi' class.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Nearest Neighbor Based Multiple Imputation for Survival Data
with Missing Covariates</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-04-19</td>
</tr>
<tr>
<td>Author:</td>
<td>Di Ran, Chiu-Hsieh Hsu, Mandi Yu</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Chiu-Hsieh Hsu &lt;pablo1639@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Imputation for both missing covariates and censored observations (optional) for survival data with missing covariates by the nearest neighbor based multiple imputation algorithm as described in Hsu et al. (2006) &lt;<a href="https://doi.org/10.1002%2Fsim.2452">doi:10.1002/sim.2452</a>&gt;, and Hsu and Yu (2018) &lt;<a href="https://doi.org/10.1177%2F0962280218772592">doi:10.1177/0962280218772592</a>&gt;. Note that the current version can only impute for a situation with one missing covariate.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/LGPL-2">LGPL-2</a> | <a href="https://www.r-project.org/Licenses/LGPL-2.1">LGPL-2.1</a> | <a href="https://www.r-project.org/Licenses/LGPL-3">LGPL-3</a> [expanded from: LGPL (&ge; 2)]</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.14.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, graphics, parallel, survival</td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.1</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-04-20 15:11:31 UTC; cophuser</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-04-20 16:00:23 UTC</td>
</tr>
</table>
<hr>
<h2 id='coxph.pool'>Estimate Cox regression model pooling over the imputed datasets</h2><span id='topic+coxph.pool'></span>

<h3>Description</h3>

<p>This function estimates Cox regression model, taking into account
the additional uncertainty that arises due to a finite number of
imputations of the missing data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>coxph.pool(obj, time, status, Z, forceNumeric = FALSE, setRef = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coxph.pool_+3A_obj">obj</code></td>
<td>
<p>A 'nnmi' object, that contains a finite number of imputations
of the missing data.</p>
</td></tr>
<tr><td><code id="coxph.pool_+3A_time">time</code></td>
<td>
<p>A vector contains the observed time.</p>
</td></tr>
<tr><td><code id="coxph.pool_+3A_status">status</code></td>
<td>
<p>A vector contains the event indicator.</p>
</td></tr>
<tr><td><code id="coxph.pool_+3A_z">Z</code></td>
<td>
<p>A vector or matrix that contains other covariates.</p>
</td></tr>
<tr><td><code id="coxph.pool_+3A_forcenumeric">forceNumeric</code></td>
<td>
<p>Logical, if it is True, the class of imputed variable will force to be numeric.
The default is FALSE.</p>
</td></tr>
<tr><td><code id="coxph.pool_+3A_setref">setRef</code></td>
<td>
<p>Optional, a reference group can be set for binary or categorical variable.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame contains pooled estimation of Cox regression model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# load required packages
library(NNMIS)
library(survival)

# load data set - stanford2 in package 'survival'
data("stanford2")
head(stanford2)
attach(stanford2)

# performance multiple imputation on missing covariate t5
imp.dat &lt;- NNMIS(t5, xa=age, xb=age, time=time, event=status, Seed = 2016)

# this program can impute censoring time based on the imputed missing covariate
# imp.dat &lt;- NNMIS(t5, xa=age, xb=age, time=time, event=status, imputeCT=T, Seed = 2016)
# check imputation results
# head(imp.dat$dat.NNMI)    #&gt; missing covariates
# head(imp.dat$dat.T.NNMI)  #&gt; censoring time
# head(imp.dat$dat.Id.NNMI) #&gt; censoring indicator

# check imputation results
head(imp.dat$dat.NNMI)

# combine inference from imputed data sets by using Rubin's rules
# estimates in Cox regression
coxph.pool(imp.dat, time, status, age)

</code></pre>

<hr>
<h2 id='km.pool'>Perform Kaplan-Meier estmation over the multiply imputed survival data sets</h2><span id='topic+km.pool'></span>

<h3>Description</h3>

<p>This function estimates Kaplan-Meier estimates based on Rubin's rules (multiple imputation algorithms) (Rubin, 2004).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>km.pool(obj, time, status)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="km.pool_+3A_obj">obj</code></td>
<td>
<p>A 'nnmi' object, that contains imputed data for the missing covariate and the censored observations.</p>
</td></tr>
<tr><td><code id="km.pool_+3A_time">time</code></td>
<td>
<p>A vector contains the observed time.</p>
</td></tr>
<tr><td><code id="km.pool_+3A_status">status</code></td>
<td>
<p>A vector contains the event indicator.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame contains pooled Kaplan-Meier estimates.
</p>


<h3>References</h3>

<p>Rubin DB. Multiple imputation for nonresponse in surveys. New York: John Wiley and Sons; 2004.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# load required packages
library(NNMIS)
library(survival)

# load data set - stanford2 in package 'survival'
data("stanford2")
head(stanford2)
attach(stanford2)

# performance multiple imputation on missing covariate t5 and
# censored observations based on the imputed missing covariates
imp.dat &lt;- NNMIS(t5, xa=age, xb=age, time=time, event=status, imputeCT=TRUE, Seed = 2016)

# check imputation results
head(imp.dat$dat.T.NNMI)

# combine inference from imputed data sets using Rubin's rules
# Kaplan-Meier estimates
kmfit &lt;- km.pool(imp.dat, time, status)
plotKM(kmfit)

</code></pre>

<hr>
<h2 id='nnmi'>A nnmi class</h2><span id='topic+nnmi'></span>

<h3>Description</h3>

<p>A nnmi class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nnmi(y, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nnmi_+3A_y">y</code></td>
<td>
<p>a list object</p>
</td></tr>
<tr><td><code id="nnmi_+3A_...">...</code></td>
<td>
<p>further arguments passed to function</p>
</td></tr>
</table>

<hr>
<h2 id='NNMIS'>Nearest Neighbor Based Multiple Imputation for Survival Data with Mssing Covariates (NNMIS)</h2><span id='topic+NNMIS'></span>

<h3>Description</h3>

<p>This function performs the nearest neighbor based multiple imputation approach proposed by
Hsu et al. (2006), Long et al. (2012), Hsu et al. (2014) and Hsu and Yu (2017, 2018) to impute for missing covariates
and censored observations (optional). To perform imputation for missing covariates, the approach
requires one to fit two working models: one for predicting the missing covariate values and the other
for predicting the missing probabilities based on the observed data. The distribution of the working
model for predicting the missing covariate values will be automatically decided by the data type of
the missing covariate. A logistic regression model will be fitted to predict the missing probabilities.
The estimation results of the two working models are then used to select a nearest neighborhood for
each missing covariate observation. Once the nearest neighborhood is chosen, multiple impuation is then
performed on the neighborhood non-parametrically. The detailed procedures can be found in Long et al. (2012), Hsu et al. (2014),
and Hsu and Yu (2017, 2018). Similarily, to perform imputation for censored observations, one has to fit two
working models first: one for predicting the survival time and the other for predicting the censoring time.
These two working models are derived using Cox regression. The estimation results of the two working models are then
used to select a nearest neighborhood for each censored observation. Once the nearest
neighborhood is chosen, multiple impuation is then performed on the neighborhood non-parametrically.
The detailed procedures can be found in Hsu et al. (2006).
</p>
<p>Note that the current version can only perform imputation for a situation with only one missing covariate.
Before you use this package, please check the input covariates matrix to see if there is more than one
missing covariate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NNMIS(y, xa = NULL, xb = NULL, time, event, MI = 10, NN = 5,
  w1 = 0.8, w2 = 0.2, Seed = NA, imputeCT = FALSE, NN.t = 10,
  mc.cores = 1, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="NNMIS_+3A_y">y</code></td>
<td>
<p>Can be any vector of covariate, which contains missing values to be imputed. Missing values are coded as NA.</p>
</td></tr>
<tr><td><code id="NNMIS_+3A_xa">xa</code></td>
<td>
<p>Can be any vector or matrix, which will be used as the covariates along with the estimated cumulative baseline hazard
and the observed censoring indicator for the working model of predicting the missing covariate values.
Note that no missing values are allowed for this.</p>
</td></tr>
<tr><td><code id="NNMIS_+3A_xb">xb</code></td>
<td>
<p>Can be any vector or matrix, which will be used as the covariates along with the estimated cumulative baseline hazard
and the observed censoring indicator for the working model of predicting the missing probabilities.
Note that no missing values are allowed for this.</p>
</td></tr>
<tr><td><code id="NNMIS_+3A_time">time</code></td>
<td>
<p>This is the observed time.</p>
</td></tr>
<tr><td><code id="NNMIS_+3A_event">event</code></td>
<td>
<p>This is the censoring indicator, i.e. 0:censored; 1: event.</p>
</td></tr>
<tr><td><code id="NNMIS_+3A_mi">MI</code></td>
<td>
<p>Number of imputation. The default is MI=10.</p>
</td></tr>
<tr><td><code id="NNMIS_+3A_nn">NN</code></td>
<td>
<p>Size of the nearest neighborhood considered for imputing missing covariate. Default is NN=5.</p>
</td></tr>
<tr><td><code id="NNMIS_+3A_w1">w1</code></td>
<td>
<p>Weight will be used in the working model of predicting the missing covariate values. The default is w1=0.8.</p>
</td></tr>
<tr><td><code id="NNMIS_+3A_w2">w2</code></td>
<td>
<p>Weight will be used in the working model of predicting the missing probabilities. The default is w1=0.2.</p>
</td></tr>
<tr><td><code id="NNMIS_+3A_seed">Seed</code></td>
<td>
<p>An integer that is used as argument by the set.seed() for
offsetting the random number generator. Default is to leave the random number generator alone.</p>
</td></tr>
<tr><td><code id="NNMIS_+3A_imputect">imputeCT</code></td>
<td>
<p>Logical. If TRUE, survival times for censored observations will be imputed and exported as part of output. (optional)</p>
</td></tr>
<tr><td><code id="NNMIS_+3A_nn.t">NN.t</code></td>
<td>
<p>Size of the nearest neighborhood considered for imputing survival times for each censored observation. Default is NN.t=10.</p>
</td></tr>
<tr><td><code id="NNMIS_+3A_mc.cores">mc.cores</code></td>
<td>
<p>Number of cpu cores to be used. This option depends on package &quot;parallel&quot;. The default is mc.core=1.</p>
</td></tr>
<tr><td><code id="NNMIS_+3A_verbose">verbose</code></td>
<td>
<p>If True, print messages.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class &quot;nnmi&quot; is a list containing parameters used in multiple imputation and all outputs.
</p>
<table>
<tr><td><code>N</code></td>
<td>
<p> Number of observations.</p>
</td></tr>
<tr><td><code>MI</code></td>
<td>
<p> Number of imputation.</p>
</td></tr>
<tr><td><code>NN</code></td>
<td>
<p> Size of the nearest neighborhood considered for imputing missing covariate.</p>
</td></tr>
<tr><td><code>w1</code></td>
<td>
<p> Weight in the working model for predicting the missing covariate values/survival times.</p>
</td></tr>
<tr><td><code>w2</code></td>
<td>
<p> Weight in the working model for predicting the missing probabilities/censoring times.</p>
</td></tr>
<tr><td><code>mfamily</code></td>
<td>
<p> Distribution family used in the working model for predicting the missing covariate values.</p>
</td></tr>
<tr><td><code>imputeCT</code></td>
<td>
<p> Logical, whether to impute survival times for censored observations or not.</p>
</td></tr>
<tr><td><code>dat.NNMI</code></td>
<td>
<p> data frame containing imputed missing covariate values.</p>
</td></tr>
<tr><td><code>dat.T.NNMI</code></td>
<td>
<p> data frame containing imputed survival times.</p>
</td></tr>
<tr><td><code>dat.Id.NNMI</code></td>
<td>
<p> data frame containing censoring indicator.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Hsu CH, Taylor JM, Murray S, Commenges D. Survival analysis using auxiliary variables via nonparametric multiple
imputation. Statistics in Medicine 2006; 25: 3503-17.
</p>
<p>Hsu CH, Long Q, Li Y, Jacobs E. A Nonparametric Multiple Imputation Approach for Data with Missing Covariate Values with Application to Colorectal Adenoma Data. Journal of Biopharmaceutical Statistics 2014; 24: 634-648.
</p>
<p>Hsu CH, Yu M. Cox regression analysis with missing covariates via nonparametric multiple imputation. arXiv 2017; 1710.04721.
</p>
<p>Hsu CH, Yu M. Cox regression analysis with missing covariates via nonparametric multiple imputation. Statistical Methods in Medical Research 2018; doi: 10.1177/0962280218772592.
</p>
<p>Long Q, Hsu CH, Li Y. Doubly robust nonparametric multiple imputation for ignorable missing data. Statistica Sinica 2012; 22: 149-172.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load required packages
library(NNMIS)
library(survival)

# load data set - stanford2 in package 'survival'
data("stanford2")
head(stanford2)
attach(stanford2)

# performance multiple imputation on missing covariate t5
imp.dat &lt;- NNMIS(t5, xa=age, xb=age, time=time, event=status, Seed = 2016, mc.core=1)

# check imputation results
head(imp.dat$dat.NNMI)

# this program can impute survival times for censored observations based on 
# the imputed missing covariate values
# imp.dat &lt;- NNMIS(t5, xa=age, xb=age, time=time, event=status, imputeCT=TRUE, Seed = 2016)
# check imputation results
# head(imp.dat$dat.NNMI)    # imputed missing covariate values
# head(imp.dat$dat.T.NNMI)  # imputed survival times
# head(imp.dat$dat.Id.NNMI) # censoring indicator

</code></pre>

<hr>
<h2 id='plotKM'>Plot function for pooled Kaplan-Meier estimates</h2><span id='topic+plotKM'></span>

<h3>Description</h3>

<p>A plot of survival curves is produced.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotKM(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotKM_+3A_x">x</code></td>
<td>
<p>a data.frame contains pooled estimates of survival function generated from function 'km.pool'.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>km.pool
</p>

<hr>
<h2 id='print.nnmi'>Print function for object of 'nnmi' class.</h2><span id='topic+print.nnmi'></span>

<h3>Description</h3>

<p>Print function for object of 'nnmi' class.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'nnmi'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.nnmi_+3A_x">x</code></td>
<td>
<p>a 'nnmi' object</p>
</td></tr>
<tr><td><code id="print.nnmi_+3A_...">...</code></td>
<td>
<p>further arguments passed to function</p>
</td></tr>
</table>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
