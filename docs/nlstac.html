<!DOCTYPE html><html lang="en"><head><title>Help for package nlstac</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {nlstac}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#deviance.nlstac'><p>Extract Model Deviance for a nsltac fit model</p></a></li>
<li><a href='#df.residual.nlstac'><p>Residuals Degree-of-Freedom of a nsltac Fit</p></a></li>
<li><a href='#fitted.nlstac'><p>Extract Fitted Values from a nsltac Fit</p></a></li>
<li><a href='#get_best_params'><p>Get best-fit parameters</p></a></li>
<li><a href='#get_functions'><p>Get nonlinear functions from a separable nonlinear formula</p></a></li>
<li><a href='#get_lhs'><p>Get left hand side of a formula</p></a></li>
<li><a href='#get_parameters'><p>Get parameters from a formula</p></a></li>
<li><a href='#get_rhs'><p>Get right hand side of a formula</p></a></li>
<li><a href='#is.nlstac'><p>Is nlsTAC class check</p></a></li>
<li><a href='#logLik.nlstac'><p>Extract Log-Likelihood from a nlstac Model</p></a></li>
<li><a href='#nls_tac'><p>Nonlinear fit with the TAC algorithm</p></a></li>
<li><a href='#nobs.nlstac'><p>Extract the Number of Observations from a nsltac Fit</p></a></li>
<li><a href='#predict.nlstac'><p>Predict a nls tac fit.</p></a></li>
<li><a href='#print.nlstac'><p>Print a nlstac Model</p></a></li>
<li><a href='#print.summary.nlstac'><p>Prints the summary a summary.nlstac object.</p></a></li>
<li><a href='#residuals.nlstac'><p>Extract Model Residuals for a nsltac fit model</p></a></li>
<li><a href='#summary.nlstac'><p>Summary a nls tac fit.</p></a></li>
<li><a href='#vcov.nlstac'><p>Calculate Variance-Covariance Matrix for a nlstac Fitted Model Object</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>An R Package for Fitting Separable Nonlinear Models</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.0</td>
</tr>
<tr>
<td>Author:</td>
<td>Mariano Rodriguez-Arias &lt;arias@unex.es&gt;, Juan Antonio Fernandez &lt;jfernandck@alumnos.unex.es&gt;, Javier Cabello &lt;coco@unex.es&gt;, Rafael Benitez &lt;rabesua@uv.es&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Rafael Benitez &lt;rabesua@uv.es&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Set of functions implementing the algorithm described in Fernandez 
    Torvisco et al. (2018) for fitting separable nonlinear regression curves. 
    See Fernandez Torvisco, Rodriguez-Arias Fernandez and Cabello Sanchez (2018)
    &lt;<a href="https://doi.org/10.2298%2FFIL1812233T">doi:10.2298/FIL1812233T</a>&gt;. </td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>Deriv, foreach, stringr, methods</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-04-11 14:54:00 UTC; rbens</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-04-11 15:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='deviance.nlstac'>Extract Model Deviance for a nsltac fit model</h2><span id='topic+deviance.nlstac'></span>

<h3>Description</h3>

<p>Returns the model deviance of the fit.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'nlstac'
deviance(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="deviance.nlstac_+3A_object">object</code></td>
<td>
<p>An object of class <code>"nlstac"</code> obtained by the <code>nls_tac</code> function.</p>
</td></tr>
<tr><td><code id="deviance.nlstac_+3A_...">...</code></td>
<td>
<p>Ignored, for compatibility issues.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A single numeric value for the deviance of the model
</p>


<h3>Author(s)</h3>

<p><strong>Mariano Rodríguez-Arias</strong> (<a href="mailto:arias@unex.es">arias@unex.es</a>).
<em>Deptartment of Mathematics</em>
</p>
<p><strong>Juan Antonio Fernández Torvisco</strong> (<a href="mailto:jfernandck@alumnos.unex.es">jfernandck@alumnos.unex.es</a>).
<em>Department of Mathematics</em>
</p>
<p>University of Extremadura (Spain)
</p>
<p><strong>Rafael Benítez</strong> (<a href="mailto:rafael.suarez@uv.es">rafael.suarez@uv.es</a>).
<em>Department of Business Mathematics</em>
</p>
<p>University of Valencia (Spain)
</p>

<hr>
<h2 id='df.residual.nlstac'>Residuals Degree-of-Freedom of a nsltac Fit</h2><span id='topic+df.residual.nlstac'></span>

<h3>Description</h3>

<p>Returns the residuals degrees-of-freedom from a nlstac model fit.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'nlstac'
df.residual(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="df.residual.nlstac_+3A_object">object</code></td>
<td>
<p>An object of class <code>"nlstac"</code> obtained by the <code>nls_tac</code> function.</p>
</td></tr>
<tr><td><code id="df.residual.nlstac_+3A_...">...</code></td>
<td>
<p>Ignored, for compatibility issues.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A single numeric value for the deviance of the model
</p>


<h3>Author(s)</h3>

<p><strong>Mariano Rodríguez-Arias</strong> (<a href="mailto:arias@unex.es">arias@unex.es</a>).
<em>Deptartment of Mathematics</em>
</p>
<p><strong>Juan Antonio Fernández Torvisco</strong> (<a href="mailto:jfernandck@alumnos.unex.es">jfernandck@alumnos.unex.es</a>).
<em>Department of Mathematics</em>
</p>
<p>University of Extremadura (Spain)
</p>
<p><strong>Rafael Benítez</strong> (<a href="mailto:rafael.suarez@uv.es">rafael.suarez@uv.es</a>).
<em>Department of Business Mathematics</em>
</p>
<p>University of Valencia (Spain)
</p>

<hr>
<h2 id='fitted.nlstac'>Extract Fitted Values from a nsltac Fit</h2><span id='topic+fitted.nlstac'></span>

<h3>Description</h3>

<p>Returns the fitted values from an object returned by a nlstac model fit.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'nlstac'
fitted(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fitted.nlstac_+3A_object">object</code></td>
<td>
<p>An object of class <code>"nlstac"</code> obtained by the <code>nls_tac</code> function.</p>
</td></tr>
<tr><td><code id="fitted.nlstac_+3A_...">...</code></td>
<td>
<p>Ignored, for compatibility issues.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A single numeric value for the deviance of the model
</p>


<h3>Author(s)</h3>

<p><strong>Mariano Rodríguez-Arias</strong> (<a href="mailto:arias@unex.es">arias@unex.es</a>).
<em>Deptartment of Mathematics</em>
</p>
<p><strong>Juan Antonio Fernández Torvisco</strong> (<a href="mailto:jfernandck@alumnos.unex.es">jfernandck@alumnos.unex.es</a>).
<em>Department of Mathematics</em>
</p>
<p>University of Extremadura (Spain)
</p>
<p><strong>Rafael Benítez</strong> (<a href="mailto:rafael.suarez@uv.es">rafael.suarez@uv.es</a>).
<em>Department of Business Mathematics</em>
</p>
<p>University of Valencia (Spain)
</p>

<hr>
<h2 id='get_best_params'>Get best-fit parameters</h2><span id='topic+get_best_params'></span>

<h3>Description</h3>

<p>Returns the best-fit parameters for a given nonlinear parameter bounds and nonlinear functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_best_params(
  dat,
  form,
  functions,
  nlparam,
  lp,
  lp_bounds = NULL,
  lhs_var,
  N = 10,
  silent = TRUE,
  parallel = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_best_params_+3A_dat">dat</code></td>
<td>
<p>Data frame with the data points to be fitted.</p>
</td></tr>
<tr><td><code id="get_best_params_+3A_form">form</code></td>
<td>
<p>A formula given in the form &quot;LHS ~ a1 * F_1(x,p1) + a2 * F_2(x,p2) + ... + an F_n(x,pn)&quot;</p>
</td></tr>
<tr><td><code id="get_best_params_+3A_functions">functions</code></td>
<td>
<p>A string array with the nonlinear functions as obtained with <code>get_functions</code> functions.</p>
</td></tr>
<tr><td><code id="get_best_params_+3A_nlparam">nlparam</code></td>
<td>
<p>A list with the names of the nonlinear parameters and their lower and upper bounds in the form <code>c(lower,upper)</code>.</p>
</td></tr>
<tr><td><code id="get_best_params_+3A_lp">lp</code></td>
<td>
<p>A string array with the names of the linear parameters contained in the formula as obtained with <code>get_parameters</code> function</p>
</td></tr>
<tr><td><code id="get_best_params_+3A_lp_bounds">lp_bounds</code></td>
<td>
<p>An optional list with the bounding restrictions over the linear parameters.</p>
</td></tr>
<tr><td><code id="get_best_params_+3A_lhs_var">lhs_var</code></td>
<td>
<p>The name of the left-hand-side of the formula</p>
</td></tr>
<tr><td><code id="get_best_params_+3A_n">N</code></td>
<td>
<p>Size of the partition of the nonlinear parameters. Defaults to 10.</p>
</td></tr>
<tr><td><code id="get_best_params_+3A_silent">silent</code></td>
<td>
<p>Logical. If TRUE (default) supresses any warnings regarding the collinearity of the columns of the matrix in the determination of the best linear parameters.</p>
</td></tr>
<tr><td><code id="get_best_params_+3A_parallel">parallel</code></td>
<td>
<p>Logical. If TRUE then multicore parallelization of for loops is done with the parallel package. Defaults to FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is an internal function called from  <code>nls_tac</code> function. It is not intended for direct use.
</p>


<h3>Value</h3>

<p>A list containing the strings for the  nonlinear functions of the formula.
</p>

<hr>
<h2 id='get_functions'>Get nonlinear functions from a separable nonlinear formula</h2><span id='topic+get_functions'></span>

<h3>Description</h3>

<p>Returns the nonlinear functions of a <code>formula</code> as charater strings.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_functions(form, lp)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_functions_+3A_form">form</code></td>
<td>
<p>Either a string in the form <code>'y ~ ...'</code> or an object of <code>formula</code> class</p>
</td></tr>
<tr><td><code id="get_functions_+3A_lp">lp</code></td>
<td>
<p>A string array with the names of the linear parameters contained in the formula as obtained with <code>get_parameters</code> function</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is an internal function used by <code>nls_tac</code>. A separable nonlinear formula is of the form
</p>
<p style="text-align: center;"><code class="reqn">y ~ a_1 f_1(x;p) + a_2 f_2(x;p) + \ldots + a_n f_n(x;p),</code>
</p>

<p>where <code class="reqn">f_1</code>,..., <code class="reqn">f_n</code> are general nonlinear functions, <code class="reqn">a_1</code>,...,<code class="reqn">a_n</code>, are the linear coefficients and <code class="reqn">p</code> is the vector of nonlinear parameters.
The <code>formula</code> given in the input should be of this form and <code>get_functions</code> will return an array with the string expressions of functions <code class="reqn">f_i</code>.
</p>


<h3>Value</h3>

<p>An array containing the strings for the  nonlinear functions of the formula.
</p>


<h3>Note</h3>

<p>Also formulas of the form
</p>
<p style="text-align: center;"><code class="reqn">y ~ a_1/f_1(x;p) + a_2/f_2(x;p) + \ldots</code>
</p>

<p>could be given.
</p>


<h3>Author(s)</h3>

<p><strong>Mariano Rodríguez-Arias</strong> (<a href="mailto:arias@unex.es">arias@unex.es</a>).
<em>Deptartment of Mathematics</em>
</p>
<p><strong>Juan Antonio Fernández Torvisco</strong> (<a href="mailto:jfernandck@alumnos.unex.es">jfernandck@alumnos.unex.es</a>).
<em>Department of Mathematics</em>
</p>
<p>University of Extremadura (Spain)
</p>
<p><strong>Rafael Benítez</strong> (<a href="mailto:rafael.suarez@uv.es">rafael.suarez@uv.es</a>).
<em>Department of Business Mathematics</em>
</p>
<p>University of Valencia (Spain)
</p>

<hr>
<h2 id='get_lhs'>Get left hand side of a formula</h2><span id='topic+get_lhs'></span>

<h3>Description</h3>

<p>Returns the dependent variable in a formula given by a string or a <code>formula</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_lhs(form)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_lhs_+3A_form">form</code></td>
<td>
<p>Either a string in the form <code>'y ~ ...'</code> or an object of <code>formula</code> class</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A string with the name of the left hand side variable in the formula
</p>

<hr>
<h2 id='get_parameters'>Get parameters from a formula</h2><span id='topic+get_parameters'></span>

<h3>Description</h3>

<p>Returns the linear and nonlinear parameters of a <code>formula</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_parameters(form, var_names)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_parameters_+3A_form">form</code></td>
<td>
<p>Either a string in the form <code>'y ~ ...'</code> or an object of <code>formula</code> class</p>
</td></tr>
<tr><td><code id="get_parameters_+3A_var_names">var_names</code></td>
<td>
<p>A string array with the column names of the data.frame containing the data to be fitted.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the names of the linear and the nonlinear parameters of the formula.
</p>

<hr>
<h2 id='get_rhs'>Get right hand side of a formula</h2><span id='topic+get_rhs'></span>

<h3>Description</h3>

<p>Returns the dependent variable in a formula given by a string or a <code>formula</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_rhs(form)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_rhs_+3A_form">form</code></td>
<td>
<p>Either a string in the form <code>'y ~ ...'</code> or an object of <code>formula</code> class</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A string with the name of the left hand side variable in the formula
</p>

<hr>
<h2 id='is.nlstac'>Is nlsTAC class check</h2><span id='topic+is.nlstac'></span>

<h3>Description</h3>

<p>Checks wether an R object is of tac class or not.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.nlstac(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="is.nlstac_+3A_x">x</code></td>
<td>
<p>Any <b>R</b> object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns <code>TRUE</code> if its argument is a tac object (that is, has &quot;tac&quot;
amongst its classes) and <code>FALSE</code> otherwise.
</p>

<hr>
<h2 id='logLik.nlstac'>Extract Log-Likelihood from a nlstac Model</h2><span id='topic+logLik.nlstac'></span>

<h3>Description</h3>

<p>Returns the log-likelihood value from an object returned by a nlstac model fit.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'nlstac'
logLik(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="logLik.nlstac_+3A_object">object</code></td>
<td>
<p>An object of class <code>"nlstac"</code> obtained by the <code>nls_tac</code> function.</p>
</td></tr>
<tr><td><code id="logLik.nlstac_+3A_...">...</code></td>
<td>
<p>Ignored, for compatibility issues.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A single numeric value for the log-likelihood of the model
</p>


<h3>Author(s)</h3>

<p><strong>Mariano Rodríguez-Arias</strong> (<a href="mailto:arias@unex.es">arias@unex.es</a>).
<em>Deptartment of Mathematics</em>
</p>
<p><strong>Juan Antonio Fernández Torvisco</strong> (<a href="mailto:jfernandck@alumnos.unex.es">jfernandck@alumnos.unex.es</a>).
<em>Department of Mathematics</em>
</p>
<p>University of Extremadura (Spain)
</p>
<p><strong>Rafael Benítez</strong> (<a href="mailto:rafael.suarez@uv.es">rafael.suarez@uv.es</a>).
<em>Department of Business Mathematics</em>
</p>
<p>University of Valencia (Spain)
</p>

<hr>
<h2 id='nls_tac'>Nonlinear fit with the TAC algorithm</h2><span id='topic+nls_tac'></span>

<h3>Description</h3>

<p>Fits a nonlinear function to data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nls_tac(
  formula,
  data = parent.frame(),
  functions = NULL,
  nlparam,
  lp_bounds = NULL,
  N = 10,
  tol = 1e-04,
  parallel = FALSE,
  maxiter = 50,
  quiet = FALSE,
  silent = TRUE,
  compute_errors = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nls_tac_+3A_formula">formula</code></td>
<td>
<p>A formula given in the form &quot;LHS ~ a1 * F_1(x,p1) + a2 * F_2(x,p2) + ... + an F_n(x,pn)&quot;</p>
</td></tr>
<tr><td><code id="nls_tac_+3A_data">data</code></td>
<td>
<p>Data frame with the data points to be fitted.</p>
</td></tr>
<tr><td><code id="nls_tac_+3A_functions">functions</code></td>
<td>
<p>A string array with the nonlinear functions. If <code>get_functions</code> fails to properly provide the functions they should be explicitly introduced.</p>
</td></tr>
<tr><td><code id="nls_tac_+3A_nlparam">nlparam</code></td>
<td>
<p>A list with the names of the nonlinear parameters and their lower and upper bounds in the form <code>c(lower,upper)</code>.</p>
</td></tr>
<tr><td><code id="nls_tac_+3A_lp_bounds">lp_bounds</code></td>
<td>
<p>An optional list with the bounding restrictions over the linear parameters.</p>
</td></tr>
<tr><td><code id="nls_tac_+3A_n">N</code></td>
<td>
<p>Size of the partition of the nonlinear parameters. Defaults to 10.</p>
</td></tr>
<tr><td><code id="nls_tac_+3A_tol">tol</code></td>
<td>
<p>Stopping condition. The algorithm stops whenever the maximum difference between two consecutive iterations is less than <code>tol</code>. Default value is 1e-4</p>
</td></tr>
<tr><td><code id="nls_tac_+3A_parallel">parallel</code></td>
<td>
<p>Logical. If TRUE then multicore parallelization of for loops is done with the parallel package. Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="nls_tac_+3A_maxiter">maxiter</code></td>
<td>
<p>Integer. The maximum number of iterations. Defaults to 50.</p>
</td></tr>
<tr><td><code id="nls_tac_+3A_quiet">quiet</code></td>
<td>
<p>Logical. If TRUE, all progress messages are supressed (defaults to FALSE).</p>
</td></tr>
<tr><td><code id="nls_tac_+3A_silent">silent</code></td>
<td>
<p>Logical. Parameter to be passed to get_best_parameters function. If TRUE (default) suppresses any warnings regarding the collinearity of the columns of the matrix in the determination of the best linear parameters.</p>
</td></tr>
<tr><td><code id="nls_tac_+3A_compute_errors">compute_errors</code></td>
<td>
<p>Logical. If TRUE (default value) the function computes the standard error of the estimates.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>nlstac</code>.  A list of
</p>
<table role = "presentation">
<tr><td><code>coefficients</code></td>
<td>
<p>Best coefficients obtained.</p>
</td></tr>
<tr><td><code>stdError</code></td>
<td>
<p>Standard errors for the obtained coefficients</p>
</td></tr>
<tr><td><code>convInfo</code></td>
<td>
<p>Convergence information: a list with the number of iterations performed (<code>niter</code>) and the tolerance attained at convergence (<code>tol</code>)</p>
</td></tr>
<tr><td><code>SSR</code></td>
<td>
<p>Sum of the squares of the residuals</p>
</td></tr>
<tr><td><code>resid</code></td>
<td>
<p>Residuals</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>Data frame used. Columns of variables not used in the formula fitted will be removed</p>
</td></tr>
<tr><td><code>formula</code></td>
<td>
<p>Formula used</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>Degrees of freedom</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>Standard deviation estimate.</p>
</td></tr>
<tr><td><code>Rmat</code></td>
<td>
<p>R matrix in the QR decomposition of the gradient matrix used for the computation of the standard errors of the coefficients</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p><strong>Mariano Rodríguez-Arias</strong> (<a href="mailto:arias@unex.es">arias@unex.es</a>).
<em>Deptartment of Mathematics</em>
</p>
<p><strong>Juan Antonio Fernández Torvisco</strong> (<a href="mailto:jfernandck@alumnos.unex.es">jfernandck@alumnos.unex.es</a>).
<em>Department of Mathematics</em>
</p>
<p>University of Extremadura (Spain)
</p>
<p><strong>Rafael Benítez</strong> (<a href="mailto:rafael.suarez@uv.es">rafael.suarez@uv.es</a>).
<em>Department of Business Mathematics</em>
</p>
<p>University of Valencia (Spain)
</p>


<h3>References</h3>

<p>Fernández Torvisco, J. A.; Rodríguez-Arias Fernández, M.; Cabello Sánchez, J. (2018). “A New Algorithm to Fit Exponential Decays without Initial Guess”, Filomat 32:12, 4233–4248.
</p>
<p>Bates, D. M. and Watts, D. G. (1988) Nonlinear Regression Analysis and Its Applications, Wiley
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### Examples from 'nls' doc ###

DNase1 &lt;- subset(DNase, Run == 1)
## using logistic formula
fm2DNase1 &lt;- nls_tac(density ~ Asym/(1 + exp((xmid - log(conc))/scal)),
                   data = DNase1,
                   nlparam = list(xmid = c(1e-7,10), scal = c(1e-7,3)))
## some generics are applicable
coefficients(fm2DNase1)
summary(fm2DNase1)
## obtaining extra information
fm2DNase1$resid # residuals
fm2DNase1$formula # formula used
fm2DNase1$df # degrees of freedom
fm2DNase1$convInfo # Convergence information (n. iterations, tolerance attained)
fm2DNase1$SSR # SSR
fm2DNase1$data$density - fm2DNase1$resid # fitted values

## Synthetic examples

## Double exponential
x &lt;- seq(from = 0, to = 20, length.out = 1000)
y &lt;- 3*exp(-0.12*x) + 0.6*exp(-3.05*x) +  5 + 0.1*rnorm(length(x))
df &lt;- data.frame(time = x, Temp = y)
# The nonlinear parameter list (with lower and upper values)
nlparam &lt;- list(b1 = c(0,2), b2 = c(0,8))
fittac &lt;- nls_tac('Temp ~ a1*exp(-b1*time) +  a2*exp(-b2*time) + a3',
                   data = df,
                   nlparam = nlparam,
                   N = 5)
summary(fittac)
plot(Temp ~ time, data = df)
lines(x, predict(fittac), col = "red", lwd = 2)

##
N &lt;- 100
x &lt;- seq(from = 0, to = 3, length.out = N)
y &lt;- 3*sin(5*x)^2 + 2 + 0.2*rnorm(N)
df &lt;- data.frame(x = x, y = y)
form &lt;- y ~ a1*sin(b1*x)^2 + a2
nlbnds &lt;- list(b1 = c(0.5,10)) # rough bouds for tac
tac_model &lt;-  nls_tac(formula = form,
                      data = df,
                      nlparam = nlbnds,
                      N = 10,
                      tol = 1e-5)
yhat &lt;- predict(tac_model)
plot(x,y)
lines(x,yhat, col = "blue")

</code></pre>

<hr>
<h2 id='nobs.nlstac'>Extract the Number of Observations from a nsltac Fit</h2><span id='topic+nobs.nlstac'></span>

<h3>Description</h3>

<p>Returns the number of observations from a nlstac model fit.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'nlstac'
nobs(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nobs.nlstac_+3A_object">object</code></td>
<td>
<p>An object of class <code>"nlstac"</code> obtained by the <code>nls_tac</code> function.</p>
</td></tr>
<tr><td><code id="nobs.nlstac_+3A_...">...</code></td>
<td>
<p>Ignored, for compatibility issues.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A single numeric value for the deviance of the model
</p>


<h3>Author(s)</h3>

<p><strong>Mariano Rodríguez-Arias</strong> (<a href="mailto:arias@unex.es">arias@unex.es</a>).
<em>Deptartment of Mathematics</em>
</p>
<p><strong>Juan Antonio Fernández Torvisco</strong> (<a href="mailto:jfernandck@alumnos.unex.es">jfernandck@alumnos.unex.es</a>).
<em>Department of Mathematics</em>
</p>
<p>University of Extremadura (Spain)
</p>
<p><strong>Rafael Benítez</strong> (<a href="mailto:rafael.suarez@uv.es">rafael.suarez@uv.es</a>).
<em>Department of Business Mathematics</em>
</p>
<p>University of Valencia (Spain)
</p>

<hr>
<h2 id='predict.nlstac'>Predict a nls tac fit.</h2><span id='topic+predict.nlstac'></span>

<h3>Description</h3>

<p>Returns the prediction values of a nls tac fit model for a given set of predictors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'nlstac'
predict(object, newdata = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict.nlstac_+3A_object">object</code></td>
<td>
<p>An object of class <code>"tac"</code> obtained by the <code>nls_tac</code> function.</p>
</td></tr>
<tr><td><code id="predict.nlstac_+3A_newdata">newdata</code></td>
<td>
<p>An optional data frame in which to look for variables with which to predict. It should contain
at least the columns for the independent variables with the same names as the ones used in the formula passed to the
<code>nls_tac</code> function. If omitted, the fitted values are used.</p>
</td></tr>
<tr><td><code id="predict.nlstac_+3A_...">...</code></td>
<td>
<p>Ignored, for compatibility issues.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector with the predicted values for the predictor given in the <code>newdata</code> input.
</p>


<h3>Author(s)</h3>

<p><strong>Mariano Rodríguez-Arias</strong> (<a href="mailto:arias@unex.es">arias@unex.es</a>).
<em>Deptartment of Mathematics</em>
</p>
<p><strong>Juan Antonio Fernández Torvisco</strong> (<a href="mailto:jfernandck@alumnos.unex.es">jfernandck@alumnos.unex.es</a>).
<em>Department of Mathematics</em>
</p>
<p>University of Extremadura (Spain)
</p>
<p><strong>Rafael Benítez</strong> (<a href="mailto:rafael.suarez@uv.es">rafael.suarez@uv.es</a>).
<em>Department of Business Mathematics</em>
</p>
<p>University of Valencia (Spain)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

x &lt;- seq(from = 0, to = 3, length.out = 50)
y &lt;- 3*exp(-5*x) + 2*x + 1 + 0.05*rnorm(50)
df &lt;- data.frame(x = x, y = y)
form &lt;- y ~ a1*exp(-b1*x) + a2*x + a3
nlbnds &lt;- list(b1 = c(0.5,10)) # bouds for tac
fitmodel &lt;-  nls_tac(formula = form, data = df, nlparam = nlbnds)
yhat &lt;- predict(fitmodel) # predict values in the fitted abcisae
plot(x,y)
lines(x,yhat, col = "red", lwd = 2)
# Predicting for other points
newdata &lt;- c(0.25,1.5,2.25)
yhat2 &lt;- predict(fitmodel, newdata = data.frame(x = newdata))
points(newdata, yhat2, pch = 19, col = "blue", cex = 1.2)

</code></pre>

<hr>
<h2 id='print.nlstac'>Print a nlstac Model</h2><span id='topic+print.nlstac'></span>

<h3>Description</h3>

<p>Standard method for overriding the print.list method for nlstac model fit.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'nlstac'
print(x, digits = max(3L, getOption("digits") - 3L), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.nlstac_+3A_x">x</code></td>
<td>
<p>An object of class <code>"nlstac"</code> obtained by the <code>nls_tac</code> function.</p>
</td></tr>
<tr><td><code id="print.nlstac_+3A_digits">digits</code></td>
<td>
<p>a positive integer indicating how many significant digits are to be shown.</p>
</td></tr>
<tr><td><code id="print.nlstac_+3A_...">...</code></td>
<td>
<p>Ignored, for compatibility issues.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p><strong>Mariano Rodríguez-Arias</strong> (<a href="mailto:arias@unex.es">arias@unex.es</a>).
<em>Deptartment of Mathematics</em>
</p>
<p><strong>Juan Antonio Fernández Torvisco</strong> (<a href="mailto:jfernandck@alumnos.unex.es">jfernandck@alumnos.unex.es</a>).
<em>Department of Mathematics</em>
</p>
<p>University of Extremadura (Spain)
</p>
<p><strong>Rafael Benítez</strong> (<a href="mailto:rafael.suarez@uv.es">rafael.suarez@uv.es</a>).
<em>Department of Business Mathematics</em>
</p>
<p>University of Valencia (Spain)
</p>

<hr>
<h2 id='print.summary.nlstac'>Prints the summary a summary.nlstac object.</h2><span id='topic+print.summary.nlstac'></span>

<h3>Description</h3>

<p>Internal function for printing the summary of a nlstac.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.nlstac'
print(
  x,
  digits = max(3L, getOption("digits") - 3L),
  signif.stars = getOption("show.signif.stars"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.summary.nlstac_+3A_x">x</code></td>
<td>
<p>An object of class <code>"nlstac"</code> obtained by the <code>fit_tac</code> function.</p>
</td></tr>
<tr><td><code id="print.summary.nlstac_+3A_digits">digits</code></td>
<td>
<p>Number of significant digits to be shown (defaults to 3).</p>
</td></tr>
<tr><td><code id="print.summary.nlstac_+3A_signif.stars">signif.stars</code></td>
<td>
<p>logical. If TRUE, ‘significance stars’ are printed for each coefficient.</p>
</td></tr>
<tr><td><code id="print.summary.nlstac_+3A_...">...</code></td>
<td>
<p>Ignored, for compatibility issues.</p>
</td></tr>
</table>

<hr>
<h2 id='residuals.nlstac'>Extract Model Residuals for a nsltac fit model</h2><span id='topic+residuals.nlstac'></span>

<h3>Description</h3>

<p>Returns the model residuals of the fit.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'nlstac'
residuals(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="residuals.nlstac_+3A_object">object</code></td>
<td>
<p>An object of class <code>"nlstac"</code> obtained by the <code>nls_tac</code> function.</p>
</td></tr>
<tr><td><code id="residuals.nlstac_+3A_...">...</code></td>
<td>
<p>Ignored, for compatibility issues.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector with the residual values.
</p>


<h3>Author(s)</h3>

<p><strong>Mariano Rodríguez-Arias</strong> (<a href="mailto:arias@unex.es">arias@unex.es</a>).
<em>Deptartment of Mathematics</em>
</p>
<p><strong>Juan Antonio Fernández Torvisco</strong> (<a href="mailto:jfernandck@alumnos.unex.es">jfernandck@alumnos.unex.es</a>).
<em>Department of Mathematics</em>
</p>
<p>University of Extremadura (Spain)
</p>
<p><strong>Rafael Benítez</strong> (<a href="mailto:rafael.suarez@uv.es">rafael.suarez@uv.es</a>).
<em>Department of Business Mathematics</em>
</p>
<p>University of Valencia (Spain)
</p>

<hr>
<h2 id='summary.nlstac'>Summary a nls tac fit.</h2><span id='topic+summary.nlstac'></span>

<h3>Description</h3>

<p>Gives the fitted coefficients and the convergence information of the fit.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'nlstac'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.nlstac_+3A_object">object</code></td>
<td>
<p>An object of class <code>"nlstac"</code> obtained by the <code>fit_tac</code> function.</p>
</td></tr>
<tr><td><code id="summary.nlstac_+3A_...">...</code></td>
<td>
<p>Ignored, for compatibility issues.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns, via the <code>print.nlstac</code> function the following items:
- Formula: The formula fitted to the data
- Parameters: The value of the estimated parameters (Estimated) together
with their standard errors (Std. Error), and their statistical
significance (t value, Pr(&gt;|t|), signif. stars)
- SSR and df.
- Convergence information: N. of iterations and the tolerance achieved.
</p>

<hr>
<h2 id='vcov.nlstac'>Calculate Variance-Covariance Matrix for a nlstac Fitted Model Object</h2><span id='topic+vcov.nlstac'></span>

<h3>Description</h3>

<p>Returns the variance-covariance matrix of the main parameters of a fitted model object. 
The “main” parameters of model correspond to those returned by coef,
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'nlstac'
vcov(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="vcov.nlstac_+3A_object">object</code></td>
<td>
<p>An object of class <code>"nlstac"</code> obtained by the <code>nls_tac</code> function.</p>
</td></tr>
<tr><td><code id="vcov.nlstac_+3A_...">...</code></td>
<td>
<p>Ignored, for compatibility issues.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of the estimated covariances between the parameter estimates.
</p>


<h3>Author(s)</h3>

<p><strong>Mariano Rodríguez-Arias</strong> (<a href="mailto:arias@unex.es">arias@unex.es</a>).
<em>Deptartment of Mathematics</em>
</p>
<p><strong>Juan Antonio Fernández Torvisco</strong> (<a href="mailto:jfernandck@alumnos.unex.es">jfernandck@alumnos.unex.es</a>).
<em>Department of Mathematics</em>
</p>
<p>University of Extremadura (Spain)
</p>
<p><strong>Rafael Benítez</strong> (<a href="mailto:rafael.suarez@uv.es">rafael.suarez@uv.es</a>).
<em>Department of Business Mathematics</em>
</p>
<p>University of Valencia (Spain)
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
