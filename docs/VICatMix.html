<!DOCTYPE html><html lang="en"><head><title>Help for package VICatMix</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {VICatMix}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#generateSampleDataBin'><p>generateSampleDataBin</p></a></li>
<li><a href='#generateSampleDataCat'><p>generateSampleDataCat</p></a></li>
<li><a href='#minVI'><p>Minimize the posterior expected Variation of Information</p></a></li>
<li><a href='#runVICatMix'><p>runVICatMix</p></a></li>
<li><a href='#runVICatMixAvg'><p>runVICatMixAvg</p></a></li>
<li><a href='#runVICatMixVarSel'><p>runVICatMixVarSel</p></a></li>
<li><a href='#runVICatMixVarSelAvg'><p>runVICatMixVarSelAvg</p></a></li>
<li><a href='#VI.lb'>
<p>Compute the modified Variation of Information from swapping log and expectation.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Variational Mixture Models for Clustering Categorical Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-11-25</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jackie Rao &lt;jackie.rao@mrc-bsu.cam.ac.uk&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>A variational Bayesian finite mixture model for the clustering of categorical data, and can implement variable selection and semi-supervised outcome guiding if desired. Incorporates an option to perform model averaging over multiple initialisations to reduce the effects of local optima and improve the automatic estimation of the true number of clusters. For further details, see the paper by Rao and Kirk (2024) &lt;<a href="https://doi.org/10.48550%2FarXiv.2406.16227">doi:10.48550/arXiv.2406.16227</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/j-ackierao/VICatMix">https://github.com/j-ackierao/VICatMix</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/j-ackierao/VICatMix/issues">https://github.com/j-ackierao/VICatMix/issues</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>klaR, matrixStats, mcclust, Rcpp, stats, gtools</td>
</tr>
<tr>
<td>Suggests:</td>
<td>doParallel, doRNG, foreach, parallel</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-11-26 15:24:01 UTC; jackie</td>
</tr>
<tr>
<td>Author:</td>
<td>Jackie Rao [aut, cre],
  Paul D.W Kirk [ths],
  Sara Wade [ctb],
  Colin Starr [ctb],
  John Maddock [cph] (Author of original version of digamma header
    (digamma.h).)</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-11-27 12:40:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='generateSampleDataBin'>generateSampleDataBin</h2><span id='topic+generateSampleDataBin'></span>

<h3>Description</h3>

<p>Generate sample clustered binary data with cluster labels. The probability of
a '1' in each cluster for each variable is randomly generated via a Beta(1,
5) distribution, encouraging sparse probabilities which vary across clusters.
For noisy variables, the probability of a '1' is also generated by a Beta(1,
5) distribution but this probability is the same regardless of the cluster
membership of the observation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>generateSampleDataBin(n, K, w, p, Irrp, yout = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="generateSampleDataBin_+3A_n">n</code></td>
<td>
<p>Number of observations in dataset.</p>
</td></tr>
<tr><td><code id="generateSampleDataBin_+3A_k">K</code></td>
<td>
<p>Number of clusters desired.</p>
</td></tr>
<tr><td><code id="generateSampleDataBin_+3A_w">w</code></td>
<td>
<p>A vector of mixture weights (proportion of population in each
cluster).</p>
</td></tr>
<tr><td><code id="generateSampleDataBin_+3A_p">p</code></td>
<td>
<p>Number of clustering variables/covariates in dataset.</p>
</td></tr>
<tr><td><code id="generateSampleDataBin_+3A_irrp">Irrp</code></td>
<td>
<p>Number of irrelevant/noisy variables/covariates in dataset. Note
that these variables will be the final Irrp columns in the simulated
dataset. Total data dimension is p + Irrp.</p>
</td></tr>
<tr><td><code id="generateSampleDataBin_+3A_yout">yout</code></td>
<td>
<p>Default FALSE. Indicate whether a binary outcome associated with
clustering is required.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following components: 
</p>
<table role = "presentation">
<tr><td><code>data</code></td>
<td>
<p>A matrix consisting of the simulated data.</p>
</td></tr> 
<tr><td><code>trueClusters</code></td>
<td>
<p>A vector with the simulated cluster assignments.</p>
</td></tr>
<tr><td><code>outcome</code></td>
<td>
<p>If yout = TRUE, this will be a vector with the outcome
variable.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># example code
generatedData &lt;- generateSampleDataBin(1000, 4, c(0.1, 0.2, 0.3, 0.4), 100, 0)

</code></pre>

<hr>
<h2 id='generateSampleDataCat'>generateSampleDataCat</h2><span id='topic+generateSampleDataCat'></span>

<h3>Description</h3>

<p>Generate sample clustered categorical data with cluster labels. The
probability of a '1' in each cluster for each variable is randomly generated
via a Dirichlet (1, ..., cat) distribution, where cat is the number of
categories for each variable. For noisy variables, the probability of a '1'
is also generated by a Dirichlet (1, ..., cat) distribution but this
probability is the same regardless of the cluster membership of the
observation. An outcome variable associated with the clustering structure can
be generated with a different number of categories, also generated with a
Dirichlet distribution. Package 'gtools' must be installed for this function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>generateSampleDataCat(n, K, w, p, Irrp, yout = FALSE, cat = 2, ycat = 2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="generateSampleDataCat_+3A_n">n</code></td>
<td>
<p>Number of observations in dataset.</p>
</td></tr>
<tr><td><code id="generateSampleDataCat_+3A_k">K</code></td>
<td>
<p>Number of clusters desired.</p>
</td></tr>
<tr><td><code id="generateSampleDataCat_+3A_w">w</code></td>
<td>
<p>A vector of mixture weights (proportion of population in each
cluster).</p>
</td></tr>
<tr><td><code id="generateSampleDataCat_+3A_p">p</code></td>
<td>
<p>Number of clustering variables/covariates in dataset.</p>
</td></tr>
<tr><td><code id="generateSampleDataCat_+3A_irrp">Irrp</code></td>
<td>
<p>Number of irrelevant/noisy variables/covariates in dataset. Note
that these variables will be the final Irrp columns in the simulated
dataset. Total data dimension is p + Irrp.</p>
</td></tr>
<tr><td><code id="generateSampleDataCat_+3A_yout">yout</code></td>
<td>
<p>Default FALSE. Indicate whether an outcome associated with
clustering is required.</p>
</td></tr>
<tr><td><code id="generateSampleDataCat_+3A_cat">cat</code></td>
<td>
<p>Number of categories in each covariate. Default is 2.</p>
</td></tr>
<tr><td><code id="generateSampleDataCat_+3A_ycat">ycat</code></td>
<td>
<p>Number of categories for the outcome varaible. Default is 2.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following components: 
</p>
<table role = "presentation">
<tr><td><code>data</code></td>
<td>
<p>A matrix consisting of the simulated data.</p>
</td></tr> 
<tr><td><code>trueClusters</code></td>
<td>
<p>A vector with the simulated cluster assignments.</p>
</td></tr>
<tr><td><code>outcome</code></td>
<td>
<p>If yout = TRUE, this will be a vector with the outcome
variable.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># example code
generatedData &lt;- generateSampleDataCat(1000, 4, c(0.1, 0.2, 0.3, 0.4), 100, 0, cat = 3)

</code></pre>

<hr>
<h2 id='minVI'>Minimize the posterior expected Variation of Information
</h2><span id='topic+minVI'></span>

<h3>Description</h3>

<p>Finds a representative partition of the posterior by minimizing the lower bound to the posterior
expected Variation of Information from Jensen's Inequality.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>minVI(psm, cls.draw=NULL, method=c("avg","comp","draws","all"), 
      max.k=NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="minVI_+3A_psm">psm</code></td>
<td>
<p>a posterior similarity matrix, which can be obtained from MCMC samples of clusterings through a call to <code>comp.psm</code>.</p>
</td></tr>
<tr><td><code id="minVI_+3A_cls.draw">cls.draw</code></td>
<td>
<p>a matrix of the samples of clusterings of the <code>ncol(cls)</code> data points that have been used to compute <code>psm</code>. Note: <code>cls.draw</code> has to be provided if 
<code>method="draw"</code> or <code>"all"</code>.</p>
</td></tr>
<tr><td><code id="minVI_+3A_method">method</code></td>
<td>
<p>the optimization method used. Should be one of <code>"avg"</code>, <code>"comp"</code>, <code>"draws"</code>, or <code>"all"</code>. Defaults to <code>"avg"</code>.</p>
</td></tr>
<tr><td><code id="minVI_+3A_max.k">max.k</code></td>
<td>
<p> integer, if <code>method="avg"</code> or <code>"comp"</code> the maximum number of clusters up to which the hierarchical clustering is cut.
Defaults to <code>ceiling(nrow(psm)/4)</code>. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Variation of Information between two clusterings is defined as the sum of the entropies minus two times the mutual information. Computation of the posterior expected Variation
of Information can be expensive, as it requires a Monte Carlo estimate. We consider a modified posterior expected Variation of Information, obtained by swapping the log and expectation, which is much more computationally efficient as it only depends on the posterior through the posterior similarity matrix. From Jensen's inequality, the problem can be viewed as minimizing a lower bound to the posterior expected loss. 
</p>
<p>We provide several optimization methods. For <code>method="avg"</code> and <code>"comp"</code>, the search is restricted to the clusterings obtained from a hierarchical clustering with average/complete linkage and <code>1-psm</code> as a distance matrix (the clusterings with number of clusters <code>1:max.k</code> are considered).<br />
Method <code>"draws"</code> restricts the search to the clusterings sampled. 
If <code>method="all"</code> all minimization methods are applied by default. 
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>cl</code></td>
<td>
<p>clustering with minimal value of expected loss. If <code>method="all"</code> a matrix containing the clustering with the smallest value
of the expected loss over all methods in the first row and the clusterings of the individual methods in the next rows.</p>
</td></tr>
<tr><td><code>value</code></td>
<td>
<p>value of posterior expected loss. A vector corresponding to the rows of <code>cl</code> if <code>method="all"</code>.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>the optimization method used.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sara Wade, <a href="mailto:sara.wade@ed.ac.uk">sara.wade@ed.ac.uk</a>
</p>


<h3>References</h3>

<p>Meila, M. (2007) Bayesian model based clustering
procedures, <em>Journal of Multivariate Analysis</em> <b>98</b>, 873&ndash;895.
</p>
<p>Wade, S. and Ghahramani, Z. (2015) Bayesian cluster analysis: Point estimation and credible balls. 
Submitted. arXiv:1505.03339
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(15)
generatedData &lt;- generateSampleDataBin(100, 4, c(0.1, 0.2, 0.3, 0.4), 25, 0)
resultforpsm &lt;- list()
for (i in 1:5){ #use 5 initialisations
  mix &lt;- runVICatMix(generatedData$data, 10, 0.01, tol = 0.005)
  resultforpsm[[i]] &lt;- mix$model$labels
}
p1 &lt;- t(matrix(unlist(resultforpsm), 100, 5))
psm &lt;- mcclust::comp.psm(p1)

labels_avg &lt;- minVI(psm, method = 'avg',max.k = 10)$cl

print(labels_avg)

</code></pre>

<hr>
<h2 id='runVICatMix'>runVICatMix</h2><span id='topic+runVICatMix'></span>

<h3>Description</h3>

<p>Perform a run of the VICatMix model on a data-frame with no variable
selection imposed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>runVICatMix(data, K, alpha, maxiter = 2000, tol = 5e-08, verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="runVICatMix_+3A_data">data</code></td>
<td>
<p>A data frame or data matrix with N rows of observations, and P
columns of covariates.</p>
</td></tr>
<tr><td><code id="runVICatMix_+3A_k">K</code></td>
<td>
<p>Maximum number of clusters desired. Must be an integer greater than 1.</p>
</td></tr>
<tr><td><code id="runVICatMix_+3A_alpha">alpha</code></td>
<td>
<p>The Dirichlet prior parameter. Recommended to set this to a
number &lt; 1. Must be &gt; 0.</p>
</td></tr>
<tr><td><code id="runVICatMix_+3A_maxiter">maxiter</code></td>
<td>
<p>The maximum number of iterations for the algorithm. Default is
2000.</p>
</td></tr>
<tr><td><code id="runVICatMix_+3A_tol">tol</code></td>
<td>
<p>A convergence parameter. Default is 5x10^-8.</p>
</td></tr>
<tr><td><code id="runVICatMix_+3A_verbose">verbose</code></td>
<td>
<p>Default FALSE. Set to TRUE to output ELBO values for each iteration.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following components: (maxNCat refers to the maximum
number of categories for any covariate in the data) 
</p>
<table role = "presentation">
<tr><td><code>labels</code></td>
<td>
<p>A numeric vector listing the cluster assignments for the 
observations.</p>
</td></tr> 
<tr><td><code>ELBO</code></td>
<td>
<p>A numeric vector tracking the value of the ELBO in every 
iteration.</p>
</td></tr>
<tr><td><code>Cl</code></td>
<td>
<p>A numeric vector tracking the number of clusters in every 
iteration.</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>A list containing all variational model parameters and the 
cluster labels:
</p>

<dl>
<dt>alpha</dt><dd><p>A K-length vector of Dirichlet parameters for alpha.</p>
</dd>
<dt>eps</dt><dd><p>A K x maxNCat x P array of Dirichlet parameters for epsilon.</p>
</dd>
<dt>labels</dt><dd><p>A numeric vector listing the cluster assignments for the 
observations.</p>
</dd>
<dt>rnk</dt><dd><p>A N x K matrix of responsibilities for the latent variables 
Z.</p>
</dd>
</dl>

</td></tr>
<tr><td><code>factor_labels</code></td>
<td>
<p>A data frame showing how variable categories
correspond to numeric factor labels in the model.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># example code
set.seed(20)
generatedData &lt;- generateSampleDataBin(500, 4, c(0.1, 0.2, 0.3, 0.4), 100, 0)
result &lt;- runVICatMix(generatedData$data, 10, 0.01)

print(result$labels)



</code></pre>

<hr>
<h2 id='runVICatMixAvg'>runVICatMixAvg</h2><span id='topic+runVICatMixAvg'></span>

<h3>Description</h3>

<p>An extension of 'runVICatMix' to incorporate model averaging/summarisation
over multiple initialisations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>runVICatMixAvg(
  data,
  K,
  alpha,
  maxiter = 2000,
  tol = 5e-08,
  inits = 25,
  loss = "VoIcomp",
  parallel = FALSE,
  cores = getOption("mc.cores", 2L),
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="runVICatMixAvg_+3A_data">data</code></td>
<td>
<p>A data frame or data matrix with N rows of observations, and P
columns of covariates.</p>
</td></tr>
<tr><td><code id="runVICatMixAvg_+3A_k">K</code></td>
<td>
<p>Maximum number of clusters desired. Must be an integer greater than 1.</p>
</td></tr>
<tr><td><code id="runVICatMixAvg_+3A_alpha">alpha</code></td>
<td>
<p>The Dirichlet prior parameter. Recommended to set this to a
number &lt; 1. Must be &gt; 0.</p>
</td></tr>
<tr><td><code id="runVICatMixAvg_+3A_maxiter">maxiter</code></td>
<td>
<p>The maximum number of iterations for the algorithm. Default is
2000.</p>
</td></tr>
<tr><td><code id="runVICatMixAvg_+3A_tol">tol</code></td>
<td>
<p>A convergence parameter. Default is 5x10^-8.</p>
</td></tr>
<tr><td><code id="runVICatMixAvg_+3A_inits">inits</code></td>
<td>
<p>The number of initialisations included in the co-clustering
matrix. Default is 25.</p>
</td></tr>
<tr><td><code id="runVICatMixAvg_+3A_loss">loss</code></td>
<td>
<p>The loss function to be used with the co-clustering matrix.
Default is VoIcomp. Options are &quot;VoIavg&quot;, &quot;VoIcomp&quot; and &quot;medv&quot;.</p>
</td></tr>
<tr><td><code id="runVICatMixAvg_+3A_parallel">parallel</code></td>
<td>
<p>Logical value indicating whether to run initialisations in
parallel. Default is FALSE.</p>
</td></tr>
<tr><td><code id="runVICatMixAvg_+3A_cores">cores</code></td>
<td>
<p>User can specify number of cores for parallelisation if parallel
= TRUE. Package automatically uses the user's parallel backend if one has
already been registered.</p>
</td></tr>
<tr><td><code id="runVICatMixAvg_+3A_verbose">verbose</code></td>
<td>
<p>Default FALSE. Set to TRUE to output ELBO values for each iteration.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following components: (maxNCat refers to the maximum
number of categories for any covariate in the data)
</p>
<table role = "presentation">
<tr><td><code>labels_avg</code></td>
<td>
<p>A numeric N-vector listing the cluster assignments for 
the observations in the averaged model.</p>
</td></tr>
<tr><td><code>init_results</code></td>
<td>
<p>A list where each entry is the cluster assignments for 
one of the initialisations included in the model averaging.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+runVICatMix">runVICatMix</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># example code
set.seed(20)
generatedData &lt;- generateSampleDataBin(500, 4, c(0.1, 0.2, 0.3, 0.4), 100, 0)
result &lt;- runVICatMixAvg(generatedData$data, 10, 0.01, inits = 10)

print(result$labels_avg)



</code></pre>

<hr>
<h2 id='runVICatMixVarSel'>runVICatMixVarSel</h2><span id='topic+runVICatMixVarSel'></span>

<h3>Description</h3>

<p>Perform a run of the VICatMixVarSel model on a data-frame including variable
selection. Includes an option to include an outcome variable for
semi-supervised profile regression.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>runVICatMixVarSel(
  data,
  K,
  alpha,
  a = 2,
  maxiter = 2000,
  tol = 5e-08,
  outcome = NA,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="runVICatMixVarSel_+3A_data">data</code></td>
<td>
<p>A data frame or data matrix with N rows of observations, and P
columns of covariates.</p>
</td></tr>
<tr><td><code id="runVICatMixVarSel_+3A_k">K</code></td>
<td>
<p>Maximum number of clusters desired. Must be an integer greater than 1.</p>
</td></tr>
<tr><td><code id="runVICatMixVarSel_+3A_alpha">alpha</code></td>
<td>
<p>The Dirichlet prior parameter. Recommended to set this to a
number &lt; 1. Must be &gt; 0.</p>
</td></tr>
<tr><td><code id="runVICatMixVarSel_+3A_a">a</code></td>
<td>
<p>Hyperparameter for variable selection hyperprior. Default is 2.</p>
</td></tr>
<tr><td><code id="runVICatMixVarSel_+3A_maxiter">maxiter</code></td>
<td>
<p>The maximum number of iterations for the algorithm. Default is
2000.</p>
</td></tr>
<tr><td><code id="runVICatMixVarSel_+3A_tol">tol</code></td>
<td>
<p>A convergence parameter. Default is 5x10^-8.</p>
</td></tr>
<tr><td><code id="runVICatMixVarSel_+3A_outcome">outcome</code></td>
<td>
<p>Optional outcome variable. Default is NA; having an outcome
triggers semi-supervised profile regression.</p>
</td></tr>
<tr><td><code id="runVICatMixVarSel_+3A_verbose">verbose</code></td>
<td>
<p>Default FALSE. Set to TRUE to output ELBO values for each iteration.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following components: (maxNCat refers to the maximum
number of categories for any covariate in the data) 
</p>
<table role = "presentation">
<tr><td><code>labels</code></td>
<td>
<p>A numeric vector listing the cluster assignments for the 
observations.</p>
</td></tr> 
<tr><td><code>ELBO</code></td>
<td>
<p>A numeric vector tracking the value of the ELBO in every 
iteration.</p>
</td></tr>
<tr><td><code>Cl</code></td>
<td>
<p>A numeric vector tracking the number of clusters in every 
iteration.</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>A list containing all variational model parameters and the 
cluster labels:
</p>

<dl>
<dt>alpha</dt><dd><p>A K-length vector of Dirichlet parameters for alpha.</p>
</dd>
<dt>eps</dt><dd><p>A K x maxNCat x P array of Dirichlet parameters for epsilon.</p>
</dd>
<dt>c</dt><dd><p>A P-length vector of expected values for the variable selection 
parameter, gamma.</p>
</dd>
<dt>labels</dt><dd><p>A numeric vector listing the cluster assignments for the 
observations.</p>
</dd>
<dt>nullphi</dt><dd><p>A P x maxNCat matrix of maximum likelihood parameters 
for irrelevant variables.</p>
</dd>
<dt>rnk</dt><dd><p>A N x K matrix of responsibilities for the latent variables 
Z.</p>
</dd>
</dl>

</td></tr>
<tr><td><code>factor_labels</code></td>
<td>
<p>A data frame showing how variable categories
correspond to numeric factor labels in the model.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># example code

set.seed(12)
generatedData &lt;- generateSampleDataBin(500, 4, c(0.1, 0.2, 0.3, 0.4), 90, 10)
result &lt;- runVICatMixVarSel(generatedData$data, 10, 0.01)

print(result$labels)
#clustering labels

print(result$c)
#expected values for variable selection parameter; 1 (or close to 1) indicates variable is relevant



</code></pre>

<hr>
<h2 id='runVICatMixVarSelAvg'>runVICatMixVarSelAvg</h2><span id='topic+runVICatMixVarSelAvg'></span>

<h3>Description</h3>

<p>An extension of 'runVICatMixVarSel' to incorporate model
averaging/summarisation over multiple initialisations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>runVICatMixVarSelAvg(
  data,
  K,
  alpha,
  a = 2,
  maxiter = 2000,
  tol = 5e-08,
  outcome = NA,
  inits = 25,
  loss = "VoIcomp",
  var_threshold = 0.95,
  parallel = FALSE,
  cores = getOption("mc.cores", 2L),
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="runVICatMixVarSelAvg_+3A_data">data</code></td>
<td>
<p>A data frame or data matrix with N rows of observations, and P
columns of covariates.</p>
</td></tr>
<tr><td><code id="runVICatMixVarSelAvg_+3A_k">K</code></td>
<td>
<p>Maximum number of clusters desired. Must be an integer greater than 1.</p>
</td></tr>
<tr><td><code id="runVICatMixVarSelAvg_+3A_alpha">alpha</code></td>
<td>
<p>The Dirichlet prior parameter. Recommended to set this to a
number &lt; 1. Must be &gt; 0.</p>
</td></tr>
<tr><td><code id="runVICatMixVarSelAvg_+3A_a">a</code></td>
<td>
<p>Hyperparameter for variable selection hyperprior. Default is 2.</p>
</td></tr>
<tr><td><code id="runVICatMixVarSelAvg_+3A_maxiter">maxiter</code></td>
<td>
<p>The maximum number of iterations for the algorithm. Default is
2000.</p>
</td></tr>
<tr><td><code id="runVICatMixVarSelAvg_+3A_tol">tol</code></td>
<td>
<p>A convergence parameter. Default is 5x10^-8.</p>
</td></tr>
<tr><td><code id="runVICatMixVarSelAvg_+3A_outcome">outcome</code></td>
<td>
<p>Optional outcome variable. Default is NA; having an outcome
triggers semi-supervised profile regression.</p>
</td></tr>
<tr><td><code id="runVICatMixVarSelAvg_+3A_inits">inits</code></td>
<td>
<p>The number of initialisations included in the co-clustering
matrix. Default is 25.</p>
</td></tr>
<tr><td><code id="runVICatMixVarSelAvg_+3A_loss">loss</code></td>
<td>
<p>The loss function to be used with the co-clustering matrix.
Default is VoIcomp. Options are &quot;VoIavg&quot;, &quot;VoIcomp&quot; and &quot;medv&quot;.</p>
</td></tr>
<tr><td><code id="runVICatMixVarSelAvg_+3A_var_threshold">var_threshold</code></td>
<td>
<p>Threshold for selection proportion for determining
selected variables under the averaged model. Options are 0 &lt; n &lt;= 1 for a
threshold. Default is 0.95.</p>
</td></tr>
<tr><td><code id="runVICatMixVarSelAvg_+3A_parallel">parallel</code></td>
<td>
<p>Logical value indicating whether to run initialisations in
parallel. Default is FALSE.</p>
</td></tr>
<tr><td><code id="runVICatMixVarSelAvg_+3A_cores">cores</code></td>
<td>
<p>User can specify number of cores for parallelisation if parallel
= TRUE. Package automatically uses the user's parallel backend if one has
already been registered.</p>
</td></tr>
<tr><td><code id="runVICatMixVarSelAvg_+3A_verbose">verbose</code></td>
<td>
<p>Default FALSE. Set to TRUE to output ELBO values for each iteration.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following components: (maxNCat refers to the maximum
number of categories for any covariate in the data) 
</p>
<table role = "presentation">
<tr><td><code>labels_avg</code></td>
<td>
<p>A numeric N-vector listing the cluster assignments for 
the observations in the averaged model.</p>
</td></tr> 
<tr><td><code>varsel_avg</code></td>
<td>
<p>A numeric P-vector with a variable selection indicator 
for the covariates in the averaged model.</p>
</td></tr>
<tr><td><code>init_results</code></td>
<td>
<p>A list where each entry is the cluster assignments for
one of the initialisations included in the model averaging.</p>
</td></tr>
<tr><td><code>init_varsel_results</code></td>
<td>
<p>A list where each entry is the expected value
for the variable selection parameters ('c') for one of the initialisations
included in the model averaging.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+runVICatMixVarSel">runVICatMixVarSel</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># example code

set.seed(12)
generatedData &lt;- generateSampleDataBin(500, 4, c(0.1, 0.2, 0.3, 0.4), 40, 10)
result &lt;- runVICatMixVarSelAvg(generatedData$data, 10, 0.01, inits = 10)

print(result$labels_avg)
print(result$varsel_avg)



</code></pre>

<hr>
<h2 id='VI.lb'>
Compute the modified Variation of Information from swapping log and expectation.
</h2><span id='topic+VI.lb'></span>

<h3>Description</h3>

<p>Based on samples of partitions (eg. from MCMC or different clustering initialisations), computes the modified Variation of Information which switches the log and expectation in the usual Variation of Information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
VI.lb(cls, psm)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="VI.lb_+3A_cls">cls</code></td>
<td>
<p>a matrix of partitions where the posterior expected (modified) Variation of Information is to be evaluated. Each row corresponds to a clustering of <code>ncol(cls)</code> data points.
</p>
</td></tr>
<tr><td><code id="VI.lb_+3A_psm">psm</code></td>
<td>
<p>a posterior similarity matrix, which can be obtained from clusterings through a call to <code>comp.psm</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Variation of Information (VoI) between two clusterings is defined as the sum of the entropies minus two times the mutual information. Computation of the posterior expected VoI can be expensive, as it requires a Monte Carlo estimate. The modified posterior expected VoI, obtained by swapping the log and expectation, is much more computationally efficient as it only depends on the posterior through the posterior similarity matrix. From Jensen's inequality, the problem of finding the optimal partition which minimizing the posterior expected modified VoI can be viewed as minimizing a lower bound to the posterior expected VoI. 
</p>


<h3>Value</h3>

<p>vector of length <code>nrow(cls)</code> of the posterior expected (modified) VoI.
</p>


<h3>Author(s)</h3>

<p>Sara Wade, <a href="mailto:sara.wade@ed.ac.uk">sara.wade@ed.ac.uk</a>
</p>


<h3>References</h3>

<p>Meila, M. (2007) Bayesian model based clustering
procedures, <em>Journal of Multivariate Analysis</em> <b>98</b>, 873&ndash;895.
</p>
<p>Wade, S. and Ghahramani, Z. (2015) Bayesian cluster analysis: Point estimation and credible balls. 
Submitted. arXiv:1505.03339.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+minVI">minVI</a></code> which locates the partition that minimizes the posterior expected modified VoI.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(15)
generatedData &lt;- generateSampleDataBin(100, 4, c(0.1, 0.2, 0.3, 0.4), 25, 0)
resultforpsm &lt;- list()
for (i in 1:5){ #use 5 initialisations
  mix &lt;- runVICatMix(generatedData$data, 10, 0.01, tol = 0.005)
  resultforpsm[[i]] &lt;- mix$model$labels
}
p1 &lt;- t(matrix(unlist(resultforpsm), 100, 5))
psm &lt;- mcclust::comp.psm(p1)

# Compute modified Variation of Information for each partition from VICatMix runs
VI.lb(p1, psm)


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
