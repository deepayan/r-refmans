<!DOCTYPE html><html lang="en"><head><title>Help for package linERR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {linERR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#linERR-package'><p>Fits the linear excess relative risk model</p></a></li>
<li><a href='#cohort1'><p>Simulated cohort data</p></a></li>
<li><a href='#ERRci'><p>Profile likelihood based confidence intervals</p></a></li>
<li><a href='#fit.linERR'><p>Fits linear ERR model</p></a></li>
<li><a href='#linERR-internal'><p>Internal fit.linERR functions</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Linear Excess Relative Risk Model</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2016-02-23</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Author:</td>
<td>David Moriña (ISGlobal, Centre for Research in Environmental Epidemiology)</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>David Moriña Soler &lt;david.morina@uab.cat&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Fits a linear excess relative risk model by maximum likelihood, possibly including several variables and allowing for lagged exposures.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.1.1), survival, stats4</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2016-02-23 10:36:30 UTC; dmorinya</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2016-02-23 13:46:03</td>
</tr>
</table>
<hr>
<h2 id='linERR-package'>Fits the linear excess relative risk model
</h2><span id='topic+linERR-package'></span><span id='topic+linERR'></span>

<h3>Description</h3>

<p>Usual approaches to the analysis of cohort and case control data often follow from risk-set sampling designs, where at each failure time a new risk set is defined, including the index case and all the controls that were at risk at that time. That kind of sampling designs are usually related to
the Cox proportional hazards model, available in most standard statistical packages but limited to log-linear models (except <em>Epicure</em>, (Preston et al., 1993)) of the form <code class="reqn">log(\phi(z, \beta)) = \beta_1 \cdot z_1 + \ldots \beta_k \cdot z_k</code>, where <code class="reqn">z</code> is a vector of explanatory variables and <code class="reqn">\phi</code> is the rate ratio. This implies exponential dose-response trends and multiplicative interactions, which may not be the best exposure-response representation in some cases, such as radiation exposures. One model of particular interest, especially in radiation environmental and occupational epidemiology is the ERR model,
<code class="reqn">\phi(z, \beta) = 1 + \alpha \cdot f(dose)</code>.
The ERR model represents the excess relative rate per unit of exposure and <code class="reqn">z_1, \ldots, z_k</code> are covariates. Estimation of a dose-response trend under a linear relative rate model implies that for every 1-unit increase in the exposure metric, the rate of disease increases (or decreases) in an
additive fashion. The modification of the effect of exposure in linear relative rate models by a study covariate <code class="reqn">m</code> can be assessed by including a log-linear subterm for the linear exposure effect (Preston et al., 2003; Ron et al., 1995), implying a model of the form <code class="reqn">\phi(z, \beta) = e^{\beta_0 + \beta_1 \cdot z_1 + \ldots + \beta_k \cdot z_k} (1 + \alpha \cdot f(dose))</code>.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> linERR</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.0</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2016-02-23</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL version 2 or newer</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>David Moriña, ISGlobal, Centre for Research in Environmental Epidemiology (CREAL)
</p>
<p>Maintainer: David Moriña &lt;david.morina@uab.cat&gt;
</p>


<h3>References</h3>

<p>B. Langholz and D. B. Richardson. Fitting general relative risk models for survival time and matched
case-control analysis. American journal of epidemiology, 171(3):377-383, 2010.
D. L. Preston, J. H. Lubin, D. A. Pierce, and M. E. McConney. Epicure: User's Guide. HiroSoft
International Corporation, Seattle, WA, 1993.
E. Ron, J. H. Lubin, R. E. Shore, K. Mabuchi, B. Modan, L. M. Pottern, A. B. Schneider, M. A.
Tucker, and J. D. Boice Jr. Thyroid Cancer after Exposure to External Radiation: A Pooled Analysis
of Seven Studies. Radiation Research, 141(3):259-277, 1995.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fit.linERR">fit.linERR</a></code>, <code><a href="#topic+ERRci">ERRci</a></code>
</p>

<hr>
<h2 id='cohort1'>Simulated cohort data</h2><span id='topic+cohort1'></span>

<h3>Description</h3>

<p>This data corresponds to a simulated cohort with a follow-up of 32 years, including the annual radiation dose received by each subject.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cohort1</code></pre>


<h3>Format</h3>

<p>A data frame with 1000 rows and 70 columns.</p>

<hr>
<h2 id='ERRci'>Profile likelihood based confidence intervals
</h2><span id='topic+ERRci'></span>

<h3>Description</h3>

<p>The standard procedure for computing a confidence interval for a parameter <code class="reqn">\beta</code> (Wald-type CI), based on <code class="reqn">\hat{\beta} \pm z_{1-\frac{\alpha}{2}} SE(\hat{\beta})</code> may work poorly if the distribution of the parameter estimator is markedly skewed or if the standard error is a poor
estimate of the standard deviation of the estimator. Profile likelihood confidence intervals doesn't assume normality of
the estimator and perform better for small sample sizes or skewed estimates than Wald-type confidence intervals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ERRci(object, prob=0.95)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ERRci_+3A_object">object</code></td>
<td>

<p>An object of class <code>fit.linERR</code>.
</p>
</td></tr>
<tr><td><code id="ERRci_+3A_prob">prob</code></td>
<td>

<p>Level of confidence, defaults to 0.95.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector containing the <code class="reqn">prob</code> profile likelihood based confidence interval.
</p>


<h3>Author(s)</h3>

<p>David Moriña, ISGlobal, Centre for Research in Environmental Epidemiology (CREAL)
</p>


<h3>References</h3>

<p>B. Langholz and D. B. Richardson. Fitting general relative risk models for survival time and matched
case-control analysis. American journal of epidemiology, 171(3):377-383, 2010.
D. L. Preston, J. H. Lubin, D. A. Pierce, and M. E. McConney. Epicure: User's Guide. HiroSoft
International Corporation, Seattle, WA, 1993.
E. Ron, J. H. Lubin, R. E. Shore, K. Mabuchi, B. Modan, L. M. Pottern, A. B. Schneider, M. A.
Tucker, and J. D. Boice Jr. Thyroid Cancer after Exposure to External Radiation: A Pooled Analysis
of Seven Studies. Radiation Research, 141(3):259-277, 1995.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ERRci">ERRci</a></code>, <code><a href="#topic+linERR-package">linERR-package</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(cohort1) 
  fit.1 &lt;- fit.linERR(Surv(entryage, exitage, leu)~sex|dose1+dose2+dose3+dose4+dose5+dose6+
                      dose7+dose8+dose9+dose10+dose11+dose12+dose13+dose14+dose15+dose16+
                      dose17+dose18+dose19+dose20+dose21+dose22+dose23+dose24+dose25+dose26+
                      dose27+dose28+dose29+dose30+dose31+dose32, data=cohort1, beta=NULL, 
                      ages=cohort1[, 7:38], lag=2)
  ERRci(fit.1, prob=0.9)
</code></pre>

<hr>
<h2 id='fit.linERR'>Fits linear ERR model
</h2><span id='topic+fit.linERR'></span>

<h3>Description</h3>

<p>Usual approaches to the analysis of cohort and case control data often follow from risk-set sampling designs, where at each failure time a new risk set is defined, including the index case and all the controls that were at risk at that time. That kind of sampling designs are usually related to
the Cox proportional hazards model, available in most standard statistical packages but limited to log-linear models (except <em>Epicure</em>, (Preston et al., 1993)) of the form <code class="reqn">log(\phi(z, \beta)) = \beta_1 \cdot z_1 + \ldots \beta_k \cdot z_k</code>, where <code class="reqn">z</code> is a vector of explanatory variables and <code class="reqn">\phi</code> is the rate ratio. This implies exponential dose-response trends and multiplicative interactions, which may not be the best exposure-response representation in some cases, such as radiation exposures. One model of particular interest, especially in radiation environmental and occupational epidemiology is the ERR model,
<code class="reqn">\phi(z, \beta) = 1 + \alpha \cdot f(dose)</code>.
The ERR model represents the excess relative rate per unit of exposure and <code class="reqn">z_1, \ldots, z_k</code> are covariates. Estimation of a dose-response trend under a linear relative rate model implies that for every 1-unit increase in the exposure metric, the rate of disease increases (or decreases) in an
additive fashion. The modification of the effect of exposure in linear relative rate models by a study covariate <code class="reqn">m</code> can be assessed by including a log-linear subterm for the linear exposure effect (Preston et al., 2003; Ron et al., 1995), implying a model of the form <code class="reqn">\phi(z, \beta) = e^{\beta_0 + \beta_1 \cdot z_1 + \ldots + \beta_k \cdot z_k} (1 + \alpha \cdot f(dose))</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit.linERR(formula, beta = NULL, data, ages, lag = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fit.linERR_+3A_formula">formula</code></td>
<td>

<p>An object of class <code>formula</code> (or one that can be coerced to that class), i.e. a symbolic description of the model to be fitted. The response must be a survival object as returned by the <code>Surv()</code> function, and the log-linear and linear terms are separated by the character &ldquo;|&rdquo;. Stratum are defined using the <code>strata()</code> function.
</p>
</td></tr>
<tr><td><code id="fit.linERR_+3A_beta">beta</code></td>
<td>

<p>Starting values for parameter estimates. Its default value is <code>NULL</code>.
</p>
</td></tr>
<tr><td><code id="fit.linERR_+3A_data">data</code></td>
<td>

<p>Data frame that contains the cohort.
</p>
</td></tr>
<tr><td><code id="fit.linERR_+3A_ages">ages</code></td>
<td>

<p>Age at each exposure.
</p>
</td></tr>
<tr><td><code id="fit.linERR_+3A_lag">lag</code></td>
<td>

<p>Lag to be applied. Its default value is zero.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>fit.linERR</code>, essentially a named list. The elements of this list are detailed below
</p>
<table role = "presentation">
<tr><td><code>lowb</code></td>
<td>
<p>Low boundary of the parameter in the linear part.</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>Initial values for the estimates.</p>
</td></tr>
<tr><td><code>max.exp</code></td>
<td>
<p>Maximum number of exposures.</p>
</td></tr>
<tr><td><code>covariates1</code></td>
<td>
<p>Covariates in the loglinear part.</p>
</td></tr>
<tr><td><code>data_2</code></td>
<td>
<p>Original data reestructured as a list.</p>
</td></tr>
<tr><td><code>rsets_2</code></td>
<td>
<p>Risk sets reestructured as a list.</p>
</td></tr>
<tr><td><code>doses_2</code></td>
<td>
<p>Doses at each exposure reestructured as a list.</p>
</td></tr>
<tr><td><code>ages_2</code></td>
<td>
<p>Ages at each exposure reestructured as a list.</p>
</td></tr>
<tr><td><code>vcov</code></td>
<td>
<p>Variance-covariance matrix.</p>
</td></tr>
<tr><td><code>aic</code></td>
<td>
<p>Akaike's Information Criteria.</p>
</td></tr>
<tr><td><code>Call</code></td>
<td>
<p>Call to the function.</p>
</td></tr>
<tr><td><code>llike</code></td>
<td>
<p>Maximum log-likelihood.</p>
</td></tr>
<tr><td><code>deviance</code></td>
<td>
<p>Deviance of the model.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>David Moriña, ISGlobal, Centre for Research in Environmental Epidemiology (CREAL)
</p>


<h3>References</h3>

<p>B. Langholz and D. B. Richardson. Fitting general relative risk models for survival time and matched
case-control analysis. American journal of epidemiology, 171(3):377-383, 2010.
D. L. Preston, J. H. Lubin, D. A. Pierce, and M. E. McConney. Epicure: User's Guide. HiroSoft
International Corporation, Seattle, WA, 1993.
E. Ron, J. H. Lubin, R. E. Shore, K. Mabuchi, B. Modan, L. M. Pottern, A. B. Schneider, M. A.
Tucker, and J. D. Boice Jr. Thyroid Cancer after Exposure to External Radiation: A Pooled Analysis
of Seven Studies. Radiation Research, 141(3):259-277, 1995.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ERRci">ERRci</a></code>, <code><a href="#topic+linERR-package">linERR-package</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(cohort1) 
  fit.1 &lt;- fit.linERR(Surv(entryage, exitage, leu)~sex|dose1+dose2+dose3+dose4+dose5+dose6+
                      dose7+dose8+dose9+dose10+dose11+dose12+dose13+dose14+dose15+dose16+
                      dose17+dose18+dose19+dose20+dose21+dose22+dose23+dose24+dose25+dose26+
                      dose27+dose28+dose29+dose30+dose31+dose32, data=cohort1, beta=NULL, 
                      ages=cohort1[, 7:38], lag=2)
</code></pre>

<hr>
<h2 id='linERR-internal'>Internal fit.linERR functions</h2><span id='topic+linERR-internal'></span><span id='topic+summary.fit.linERR'></span><span id='topic+print.summary.fit.linERR'></span><span id='topic+plot.fit.linERR'></span><span id='topic+llhood'></span>

<h3>Description</h3>

<p>Internal fit.linERR functions</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'fit.linERR'
summary(object, ...)
## S3 method for class 'fit.linERR'
print.summary(x, ...)
## S3 method for class 'fit.linERR'
plot(x, ...)
</code></pre>


<h3>Details</h3>

<p>These functions are not to be called by the user</p>


<h3>See Also</h3>

<p><code><a href="#topic+linERR-package">linERR-package</a></code>, <code><a href="#topic+fit.linERR">fit.linERR</a></code>, <code><a href="#topic+ERRci">ERRci</a></code>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
