<!DOCTYPE html><html><head><title>Help for package spikeSlabGAM</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {spikeSlabGAM}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#evalTerm'><p>Get summaries of the posterior (predictive) distribution of the linear</p>
predictor of a model term</a></li>
<li><a href='#fct'><p>Generate design for a factor covariate</p></a></li>
<li><a href='#getPosteriorTerm'><p>Get the posterior distribution of the linear predictor of a model term</p></a></li>
<li><a href='#lin'><p>Generate orthogonal polynomial base for a numeric covariate without intercept</p></a></li>
<li><a href='#mrf'><p>Generate design for a 2-D Gaussian Markov Random Field</p></a></li>
<li><a href='#plot.spikeSlabGAM'><p>Generates graphical summaries of a fitted model</p></a></li>
<li><a href='#plotTerm'><p>Plot the estimated effect of a model term.</p></a></li>
<li><a href='#predict.spikeSlabGAM'><p>Obtain posterior predictive/credible intervals from a spike-and-slab model</p></a></li>
<li><a href='#print.summary.spikeSlabGAM'><p>Print summary for posterior of a <code>spikeSlabGAM</code> fit</p></a></li>
<li><a href='#rnd'><p>Generate design for a random intercept</p></a></li>
<li><a href='#sm'><p>Generate a reparameterized P-spline base</p></a></li>
<li><a href='#spikeAndSlab'><p>Set up and sample a spike-and-slab prior model.</p></a></li>
<li><a href='#spikeSlabGAM'><p>Generate posterior samples for a GAMM with spike-and-slab priors</p></a></li>
<li><a href='#srf'><p>Generate design for penalized surface estimation.</p></a></li>
<li><a href='#ssGAM2Bugs'><p>Convert samples from a model fitted with <code>spikeSlabGAM</code> into a</p>
<code>bugs</code>-object</a></li>
<li><a href='#ssGAMDesign'><p>Generate design and model information for <code>spikeSlabGAM</code></p></a></li>
<li><a href='#summary.spikeSlabGAM'><p>Summary for posterior of a <code>spikeSlabGAM</code> fit</p></a></li>
<li><a href='#u'><p>Generate design for an always included covariate</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>1.1-19</td>
</tr>
<tr>
<td>Title:</td>
<td>Bayesian Variable Selection and Model Choice for Generalized
Additive Mixed Models</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.15.1)</td>
</tr>
<tr>
<td>Imports:</td>
<td>coda, cluster, ggplot2 (&ge; 2.0.0), gridExtra (&ge; 2.0.0),
interp, MASS, MCMCpack, mvtnorm, R2WinBUGS, reshape, scales,
splines, parallel</td>
</tr>
<tr>
<td>Suggests:</td>
<td>mboost, mlbench, gtable, knitr, rmarkdown</td>
</tr>
<tr>
<td>Description:</td>
<td>Bayesian variable selection, model choice, and regularized
    estimation for (spatial) generalized additive mixed regression models
    via stochastic search variable selection with spike-and-slab priors.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/fabian-s/spikeSlabGAM">https://github.com/fabian-s/spikeSlabGAM</a></td>
</tr>
<tr>
<td>Collate:</td>
<td>'utils.R' 'spikeAndSlab.R' 'terms.R' 'ssGAMDesign.R'
'spikeSlabGAM.R' 'bugs.R' 'plot.R' 'predict.R' 'summary.R'</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-06-10 12:31:37 UTC; fabians</td>
</tr>
<tr>
<td>Author:</td>
<td>Fabian Scheipl [aut, cre],
  Bettina Gruen [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Fabian Scheipl &lt;fabian.scheipl@stat.uni-muenchen.de&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-06-10 15:50:07 UTC</td>
</tr>
</table>
<hr>
<h2 id='evalTerm'>Get summaries of the posterior (predictive) distribution of the linear
predictor of a model term</h2><span id='topic+evalTerm'></span>

<h3>Description</h3>

<p>Get summaries of the posterior (predictive) distribution of the linear
predictor of a model term
</p>


<h3>Usage</h3>

<pre><code class='language-R'>evalTerm(
  label,
  model,
  newdata = NULL,
  aggregate = mean,
  quantiles = c(0.1, 0.9),
  returnData = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="evalTerm_+3A_label">label</code></td>
<td>
<p>(character) the label of one of the terms in <code>model</code>.</p>
</td></tr>
<tr><td><code id="evalTerm_+3A_model">model</code></td>
<td>
<p>a <code>spikeSlabGAM</code> object</p>
</td></tr>
<tr><td><code id="evalTerm_+3A_newdata">newdata</code></td>
<td>
<p><code>data.frame</code> on which to evaluate <code>label</code>. Defaults
to NULL, in which case the term is evaluated on the original data.</p>
</td></tr>
<tr><td><code id="evalTerm_+3A_aggregate">aggregate</code></td>
<td>
<p>(function) a summary statistic that is applied over the
mcmc-samples of the linear predictor. Defaults to <code>mean</code>.</p>
</td></tr>
<tr><td><code id="evalTerm_+3A_quantiles">quantiles</code></td>
<td>
<p>(numeric) a vector of quantiles for borders of credible
regions of the linear predictor. Defaults to 10 and 90 percent quantiles,
i.e. a (point-wise) 80 percent credible region.</p>
</td></tr>
<tr><td><code id="evalTerm_+3A_returndata">returnData</code></td>
<td>
<p>should the relevant original variables be included in the
returned <code>data.frame</code>? Defaults to TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>data.frame</code> that contains the relevant variables from newdata
(if <code>returnData</code> is TRUE), the <code>aggregate</code>-summary and the
requested <code>quantiles</code>.
</p>


<h3>Author(s)</h3>

<p>Fabian Scheipl
</p>

<hr>
<h2 id='fct'>Generate design for a factor covariate</h2><span id='topic+fct'></span>

<h3>Description</h3>

<p>Generate design for a factor covariate
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fct(x, contr = "contr.sum")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fct_+3A_x">x</code></td>
<td>
<p>a covariate that can be treated as a factor</p>
</td></tr>
<tr><td><code id="fct_+3A_contr">contr</code></td>
<td>
<p>(character) name of the <code><a href="stats.html#topic+contrasts">contrasts</a></code>
associated with the factor. Defaults to <code>"contr.sum"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>design matrix for a factor
</p>


<h3>Author(s)</h3>

<p>Fabian Scheipl
</p>

<hr>
<h2 id='getPosteriorTerm'>Get the posterior distribution of the linear predictor of a model term</h2><span id='topic+getPosteriorTerm'></span>

<h3>Description</h3>

<p>Get the posterior distribution of the linear predictor of a model term
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getPosteriorTerm(label = NULL, model, betaInd = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getPosteriorTerm_+3A_label">label</code></td>
<td>
<p>(character) one of the terms in <code>model</code></p>
</td></tr>
<tr><td><code id="getPosteriorTerm_+3A_model">model</code></td>
<td>
<p>a <code>spikeSlabGAM</code> object</p>
</td></tr>
<tr><td><code id="getPosteriorTerm_+3A_betaind">betaInd</code></td>
<td>
<p>(optional) the column indices of the part of the design matrix
for which the linear predictor is to be evaluated.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a matrix containing the samples of the linear predictor associated
with <code>label</code>; with attribute <code>'coef'</code> that contains the posterior
samples of the associated coefficients.
</p>


<h3>Author(s)</h3>

<p>Fabian Scheipl
</p>

<hr>
<h2 id='lin'>Generate orthogonal polynomial base for a numeric covariate without intercept</h2><span id='topic+lin'></span>

<h3>Description</h3>

<p>Generate orthogonal polynomial base for a numeric covariate without intercept
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lin(x, order = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lin_+3A_x">x</code></td>
<td>
<p>covariate</p>
</td></tr>
<tr><td><code id="lin_+3A_order">order</code></td>
<td>
<p>order of the polynomial, defaults to 1</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an orthogonal basis for a centered polynomial function in x
</p>


<h3>Author(s)</h3>

<p>Fabian Scheipl
</p>

<hr>
<h2 id='mrf'>Generate design for a 2-D Gaussian Markov Random Field</h2><span id='topic+mrf'></span>

<h3>Description</h3>

<p>The returned design is (a low-rank approximation to) the matrix square root
of the implied covariance of the centered MRF. The function stops if
'islands', i.e. regions without any neighbors are found. Regions without
observations have to be removed from the neighborhood matrix and there is
currently no <code>predict</code>-functionality for regions without observations in
the original data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mrf(x, N, decomposition = c("ortho", "MM"), tol = 1e-10, rankZ = 0.995)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mrf_+3A_x">x</code></td>
<td>
<p>a factor: which observation belongs to which region</p>
</td></tr>
<tr><td><code id="mrf_+3A_n">N</code></td>
<td>
<p>the neighborhood (adjacency) matrix: a symmetric matrix with one
column/row for every level of <code>x</code>, defining the neighborhood structure
(either 0-1 or with positive weights, e.g. based on shared boundary length
or centroid distances). Has to have rownames and column names that
correspond to the levels of <code>x</code>, the function checks whether the
rows/columns are in the same order as the levels of <code>x</code>. Entries on
the diagonal are ignored.</p>
</td></tr>
<tr><td><code id="mrf_+3A_decomposition">decomposition</code></td>
<td>
<p>use a (truncated) spectral decomposition of the implied
prior covariance of <code class="reqn">f(x)</code> for a low rank representation with
orthogonal  basis functions and i.i.d. coefficients (<code>"ortho"</code>), or
use the mixed model reparameterization for non-orthogonal basis functions
and i.i.d. coefficients (<code>"MM"</code>). Defaults to <code>"MM"</code>.</p>
</td></tr>
<tr><td><code id="mrf_+3A_tol">tol</code></td>
<td>
<p>count singular/eigenvalues smaller than this as zero</p>
</td></tr>
<tr><td><code id="mrf_+3A_rankz">rankZ</code></td>
<td>
<p>how many eigenvectors to retain from the eigen decomposition:
either a number &gt; 3 or the proportion of the sum of eigenvalues the
retained eigenvectors must represent at least. Defaults to .999.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a transformed design matrix for the Markov Random Field
</p>


<h3>Author(s)</h3>

<p>Fabian Scheipl
</p>


<h3>References</h3>

<p>Fahrmeir, L., Lang, S. (2001) Bayesian inference for generalized
additive mixed models based on Markov random field priors. <em>Applied
Statistics</em>, <b>50</b>(2):201&ndash;220.
</p>

<hr>
<h2 id='plot.spikeSlabGAM'>Generates graphical summaries of a fitted model</h2><span id='topic+plot.spikeSlabGAM'></span>

<h3>Description</h3>

<p>This function plots the estimated linear predictors of the terms in a model on
a grid of values. By default displays all 3-way, 2-way interactions and main
effects present in the model. Starting with ggplot-0.9.2 these are no longer
aligned by their axes due to internal changes in grid and ggplot2. Uses
<span class="pkg">gridExtra</span>'s  <code><a href="gridExtra.html#topic+marrangeGrob">marrangeGrob</a></code> to arrange the plots
for the terms, also over multiple pages if necessary. This means the graphics
device type is temporarily set to the value of <code>interactive.dev</code> in
interactive use in RStudio if necessary since the <code>RStudioGD</code> graphical
device does not support opening multiple pages.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'spikeSlabGAM'
plot(
  x,
  labels = NULL,
  cumulative = TRUE,
  commonEtaScale = FALSE,
  aggregate = mean,
  quantiles = c(0.1, 0.9),
  gridlength = 20,
  base_size = 12,
  ggElems = list(),
  nrow = min(ceiling(sqrt(length(plotList))), 3),
  ncol = min(ceiling(length(plotList)/nrow), 3),
  interactive.dev = c("x11", "quartz", "windows"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.spikeSlabGAM_+3A_x">x</code></td>
<td>
<p>a fitted <code>spikeSlabGAM</code> model</p>
</td></tr>
<tr><td><code id="plot.spikeSlabGAM_+3A_labels">labels</code></td>
<td>
<p>a character vector of names of model terms to be plotted</p>
</td></tr>
<tr><td><code id="plot.spikeSlabGAM_+3A_cumulative">cumulative</code></td>
<td>
<p>Defaults to TRUE, in which case all lower order terms that
are involved in an interaction are cumulated and then plotted (e.g, if a
model contains 2 smooth effects and their interaction, ONLY the sum of the
marginal smooth and linear terms and all their interactions are plotted.) If
FALSE, a separate plot for every term in the model is produced.</p>
</td></tr>
<tr><td><code id="plot.spikeSlabGAM_+3A_commonetascale">commonEtaScale</code></td>
<td>
<p>use the same limits for all vertical axes of the
different panels? Defaults to FALSE. Can be useful to compare effect sizes
more easily between panels, but tends to mess up the scales.</p>
</td></tr>
<tr><td><code id="plot.spikeSlabGAM_+3A_aggregate">aggregate</code></td>
<td>
<p>(function) which summary statistic to use for the posterior
of the model terms. Defaults to the mean.</p>
</td></tr>
<tr><td><code id="plot.spikeSlabGAM_+3A_quantiles">quantiles</code></td>
<td>
<p>which quantiles to use for the borders of credible regions.
Defaults to 10% and 90% percentiles. Set to NULL to omit plotting credible
regions.</p>
</td></tr>
<tr><td><code id="plot.spikeSlabGAM_+3A_gridlength">gridlength</code></td>
<td>
<p>length of the (univariate) grids for the covariates on which
to evaluate the posterior. Defaults to 20.</p>
</td></tr>
<tr><td><code id="plot.spikeSlabGAM_+3A_base_size">base_size</code></td>
<td>
<p>default base font size for plot (see e.g.
<code><a href="ggplot2.html#topic+theme_gray">theme_gray</a></code>)</p>
</td></tr>
<tr><td><code id="plot.spikeSlabGAM_+3A_ggelems">ggElems</code></td>
<td>
<p>a list of plot elements to give to <code>ggplot</code>. Use this to
supply custom themes or colors, fortify the plot(s) with partial residuals
etc. Defaults to an empty list. Unless specified differently here, the
default ggplot-theme (<code><a href="ggplot2.html#topic+theme_gray">theme_gray</a></code>) is changed to a
white background with major gridlines in gray (<code>'grey95'</code>), no minor
grid lines, and smaller text for the legends.</p>
</td></tr>
<tr><td><code id="plot.spikeSlabGAM_+3A_nrow">nrow</code></td>
<td>
<p>number of rows per page, defaults to min(sqrt(no. of plots), 3).
See <code><a href="gridExtra.html#topic+marrangeGrob">marrangeGrob</a></code>.</p>
</td></tr>
<tr><td><code id="plot.spikeSlabGAM_+3A_ncol">ncol</code></td>
<td>
<p>number of columns per page, defaults to min((no. of plots)/nrow,
3). See <code><a href="gridExtra.html#topic+marrangeGrob">marrangeGrob</a></code>.</p>
</td></tr>
<tr><td><code id="plot.spikeSlabGAM_+3A_interactive.dev">interactive.dev</code></td>
<td>
<p>alternative device to use in interactive mode in
RStudio if output needs to be spread on multiple pages, since the RStudio
graphical device does not support opening multiple displays.</p>
</td></tr>
<tr><td><code id="plot.spikeSlabGAM_+3A_...">...</code></td>
<td>
<p>arguments passed to <code><a href="gridExtra.html#topic+marrangeGrob">marrangeGrob</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code>-objects (invisible)
</p>


<h3>Note</h3>

<p>Note that <code>cumulative = TRUE</code> will only find all relevant terms to
accumulate if, for all numeric covariates that have a smooth term, the
smooth term is specified <em>after</em> the linear term in the formula.
</p>


<h3>Author(s)</h3>

<p>Fabian Scheipl
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plotTerm">plotTerm</a></code> for more details on the specific plots
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#see ?spikeSlabGAM
</code></pre>

<hr>
<h2 id='plotTerm'>Plot the estimated effect of a model term.</h2><span id='topic+plotTerm'></span>

<h3>Description</h3>

<p>Plots the estimated linear predictor for a model term, i.e a main effect or a
(2- or 3-way) interaction. Plots for the joint effect of two numerical
covariates show an overlay if quantiles were specified: Regions where the
pointwise credible intervals do not contain zero are plotted in muted red
(<code class="reqn">&gt;0</code>) and blue (<code class="reqn">&lt; 0</code>), overlaid by coloured contour lines that show
the <code>aggregate</code> values.  Contour lines are shown only inside the convex
hull of the original observations. Plots for
<code><a href="#topic+srf">srf</a></code>:<code><a href="#topic+lin">lin</a></code> terms show the spatially varying
coefficient, i.e. the contour lines represent the change in the linear
predictor when the <code>lin</code>-covariate increases by 1 standard deviation.
For this reason, a cumulative plot makes no sense and the routine will set
<code>cumulative = FALSE</code> with a warning.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotTerm(
  label,
  m,
  cumulative = TRUE,
  aggregate = mean,
  quantiles = c(0.1, 0.9),
  gridlength = 40,
  contours = 30,
  ggElems = list()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotTerm_+3A_label">label</code></td>
<td>
<p>(character) the label of the effect to be plotted.</p>
</td></tr>
<tr><td><code id="plotTerm_+3A_m">m</code></td>
<td>
<p>a fitted <code>spikeSlabGAM</code> model</p>
</td></tr>
<tr><td><code id="plotTerm_+3A_cumulative">cumulative</code></td>
<td>
<p>Defaults to TRUE, in which case the lower order terms that
are associated with the covariates involved in <code>label</code> are cumulated
and then plotted. (e.g, if <code>label</code> denotes a smoooth term, the sum of
the linear and smooth effect is displayed if TRUE, if <code>label</code> is a
factor-factor interaction, the sum of both main effects and their
interaction is displayed etc.) If FALSE, only the marginal effect of
<code>label</code> is displayed.</p>
</td></tr>
<tr><td><code id="plotTerm_+3A_aggregate">aggregate</code></td>
<td>
<p>(function) which summary statistic to use for the posterior
of the effect. Defaults to the mean.</p>
</td></tr>
<tr><td><code id="plotTerm_+3A_quantiles">quantiles</code></td>
<td>
<p>which quantiles to use for the borders of credible regions.
Defaults to 10
regions. Cannot deal with more than two quantiles.</p>
</td></tr>
<tr><td><code id="plotTerm_+3A_gridlength">gridlength</code></td>
<td>
<p>length of the (univariate) grids on which to evaluate the
posterior.</p>
</td></tr>
<tr><td><code id="plotTerm_+3A_contours">contours</code></td>
<td>
<p>use how many contour lines for the joint effect of two
numerical covariates. Defaults to 30.</p>
</td></tr>
<tr><td><code id="plotTerm_+3A_ggelems">ggElems</code></td>
<td>
<p>a list of plot elements to give to
<code><a href="ggplot2.html#topic+ggplot">ggplot</a></code>. Use this to supply custom themes, colour
schemes etc. Defaults to an empty list, which yields the standard settings.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Limitations: Plots for 4-way (or higher) interactions are not implemented.
Requesting such a plot will return the NULL object with a warning. Plots for
<code><a href="#topic+mrf">mrf</a></code> just treat the grouping variable as a conventional factor
i.e. will not incorporate any neighborhood or map information.
</p>


<h3>Value</h3>

<p>an object of class <code>ggplot</code>. Use <code>print</code> or wrap the call
to <code>plotTerm</code> in parentheses to directly render on a graphic device.
</p>


<h3>Author(s)</h3>

<p>Fabian Scheipl
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#see help for spikeSlabGAM
</code></pre>

<hr>
<h2 id='predict.spikeSlabGAM'>Obtain posterior predictive/credible intervals from a spike-and-slab model</h2><span id='topic+predict.spikeSlabGAM'></span>

<h3>Description</h3>

<p>Obtain posterior predictive/credible intervals from a spike-and-slab model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'spikeSlabGAM'
predict(
  object,
  newdata = NULL,
  type = c("response", "link", "terms"),
  terms = NULL,
  aggregate = mean,
  quantiles = NULL,
  addIntercept = is.null(terms),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.spikeSlabGAM_+3A_object">object</code></td>
<td>
<p>a <code>spikeSlabGAM</code> model</p>
</td></tr>
<tr><td><code id="predict.spikeSlabGAM_+3A_newdata">newdata</code></td>
<td>
<p>an optional <code>data.frame</code> on which to evaluate
predictions. Defaults to NULL, in which case the fitted values for the
original data are returned</p>
</td></tr>
<tr><td><code id="predict.spikeSlabGAM_+3A_type">type</code></td>
<td>
<p>the type of prediction required. The default is on the scale of
response, the alternative <code>'link'</code> is on the scale of the linear
predictor. Specifying <code>'terms'</code> returns a list giving the linear
predictors of the terms specified in <code>terms</code>.</p>
</td></tr>
<tr><td><code id="predict.spikeSlabGAM_+3A_terms">terms</code></td>
<td>
<p>an optional character vector of term labels or variable names
for which to return fits/predictions/credible regions. If variable names
instead of term labels are supplied, the function returns
predictions/estimates for <em>all</em> terms associated with these variables,
i.e. their main effects (usually both linear and smooth for numeric
covariates) and all interaction terms they are involved in.</p>
</td></tr>
<tr><td><code id="predict.spikeSlabGAM_+3A_aggregate">aggregate</code></td>
<td>
<p>(function) the summary statistic of the posterior predictive
of the linear predictor. Defaults to <code>mean</code>.</p>
</td></tr>
<tr><td><code id="predict.spikeSlabGAM_+3A_quantiles">quantiles</code></td>
<td>
<p>(numeric) an optional vector of quantiles for borders of
credible regions of the returned values. Defaults to NULL.</p>
</td></tr>
<tr><td><code id="predict.spikeSlabGAM_+3A_addintercept">addIntercept</code></td>
<td>
<p>include global intercept term in prediction/estimate?
Defaults to TRUE if <code>terms = NULL</code>.</p>
</td></tr>
<tr><td><code id="predict.spikeSlabGAM_+3A_...">...</code></td>
<td>
<p>arguments passed from or to other methods (not used)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If <code>type ="terms"</code>, a list of <code>data.frame</code>s containing the
requested pointwise summary statistics for the supplied terms (use e.g.
<code><a href="base.html#topic+Reduce">Reduce</a>("+", ...)</code> to get row-wise sums of the list-entries).
Otherwise, a <code>data.frame</code> containing the requested pointwise summary
statistics of the posterior predictive of the linear predictor
(<code>type ="link"</code>) or the conditional expectation of the response
(<code>type ="response"</code>) is returned.
</p>


<h3>Author(s)</h3>

<p>Fabian Scheipl
</p>

<hr>
<h2 id='print.summary.spikeSlabGAM'>Print summary for posterior of a <code>spikeSlabGAM</code> fit</h2><span id='topic+print.summary.spikeSlabGAM'></span>

<h3>Description</h3>

<p>The model table shows at least the 10 and at most the 20 most probable models
as found by SSVS, or enough models to account for 90% of the probability
mass in the model space as found by SSVS by default.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.spikeSlabGAM'
print(
  x,
  digits = 3,
  printPGamma = TRUE,
  printModels = TRUE,
  showModels = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.summary.spikeSlabGAM_+3A_x">x</code></td>
<td>
<p>an object of class <code>summary.spikeSlabGAM</code></p>
</td></tr>
<tr><td><code id="print.summary.spikeSlabGAM_+3A_digits">digits</code></td>
<td>
<p>see <code><a href="base.html#topic+options">options</a></code>, defaults to 3</p>
</td></tr>
<tr><td><code id="print.summary.spikeSlabGAM_+3A_printpgamma">printPGamma</code></td>
<td>
<p>print marginal inclusion probabilities and norm of the
linear predictor for each term? Defaults to TRUE</p>
</td></tr>
<tr><td><code id="print.summary.spikeSlabGAM_+3A_printmodels">printModels</code></td>
<td>
<p>print most probable models visited by the SSVS? Defaults
to TRUE</p>
</td></tr>
<tr><td><code id="print.summary.spikeSlabGAM_+3A_showmodels">showModels</code></td>
<td>
<p>how many of th most probable models to display. See details
for default.</p>
</td></tr>
<tr><td><code id="print.summary.spikeSlabGAM_+3A_...">...</code></td>
<td>
<p>arguments based from or to other methods (not used)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>invisibly returns <code>x</code>
</p>


<h3>Author(s)</h3>

<p>Fabian Scheipl
</p>


<h3>See Also</h3>

<p><code><a href="#topic+summary.spikeSlabGAM">summary.spikeSlabGAM</a></code>
</p>

<hr>
<h2 id='rnd'>Generate design for a random intercept</h2><span id='topic+rnd'></span>

<h3>Description</h3>

<p>Generate design for a random intercept
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rnd(x, C = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rnd_+3A_x">x</code></td>
<td>
<p>a covariate that can be treated as a factor</p>
</td></tr>
<tr><td><code id="rnd_+3A_c">C</code></td>
<td>
<p>an optional known correlation structure of the random effects
associated with x</p>
</td></tr>
</table>


<h3>Value</h3>

<p>design matrix for a random intercept for x
</p>


<h3>Author(s)</h3>

<p>Fabian Scheipl
</p>

<hr>
<h2 id='sm'>Generate a reparameterized P-spline base</h2><span id='topic+sm'></span>

<h3>Description</h3>

<p>The returned matrix is a low-rank approximation of the original P-spline
basis (unless <code>decomposition = "asIs"</code>), that is projected into the
complement of the nullspace of the associated penalty (unless
<code>centerBase = FALSE</code>), i.e. for the default second order difference
penalty, the resulting basis cannot reproduce linear or constant functions
and parameterizes the &quot;wiggly&quot; part of the influence of <code>x</code> only. This
means that it very rarely makes sense to run a model with <code>sm(x)</code>
without also using <code><a href="#topic+lin">lin</a>(x)</code> or <code><a href="#topic+u">u</a>(x)</code>. The projection
improves the separability between the linear and smooth parts of the
influence of <code>x</code> and centers the resulting function estimates s.t
<code class="reqn">\sum_i f(x_i) = 0</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sm(
  x,
  K = min(length(unique(x)), 20),
  spline.degree = 3,
  diff.ord = 2,
  rankZ = 0.999,
  centerBase = T,
  centerx = x,
  decomposition = c("ortho", "MM", "asIs"),
  tol = 1e-10
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sm_+3A_x">x</code></td>
<td>
<p>covariate</p>
</td></tr>
<tr><td><code id="sm_+3A_k">K</code></td>
<td>
<p>number of basis functions in the original basis (defaults to 20)</p>
</td></tr>
<tr><td><code id="sm_+3A_spline.degree">spline.degree</code></td>
<td>
<p>defaults to 3 for cubic B-plines</p>
</td></tr>
<tr><td><code id="sm_+3A_diff.ord">diff.ord</code></td>
<td>
<p>order of the difference penalty, defaults to 2 for penalizing
deviations from linearity</p>
</td></tr>
<tr><td><code id="sm_+3A_rankz">rankZ</code></td>
<td>
<p>how many eigenvectors to retain from the eigen decomposition:
either a number &gt; 3 or the proportion of the sum of eigenvalues the
retained eigenvectors must represent at least. Defaults to .999.</p>
</td></tr>
<tr><td><code id="sm_+3A_centerbase">centerBase</code></td>
<td>
<p>project the basis of the penalized part into the complement
of the column space of the basis of the unpenalized part? defaults to TRUE</p>
</td></tr>
<tr><td><code id="sm_+3A_centerx">centerx</code></td>
<td>
<p>vector of x-values used for centering (defaults to <code>x</code>)</p>
</td></tr>
<tr><td><code id="sm_+3A_decomposition">decomposition</code></td>
<td>
<p>use a truncated spectral decomposition of the implied
prior covariance of <code class="reqn">f(x)</code> for a low rank representation with
orthogonal basis functions and i.i.d. coefficients (<code>"ortho"</code>), or use
the mixed model reparameterization for non-orthogonal basis functions and
i.i.d. coefficients (<code>"MM"</code>) or use basis functions as they are with
i.i.d. coefficients (<code>"asIs"</code>). Defaults to <code>"ortho"</code>.</p>
</td></tr>
<tr><td><code id="sm_+3A_tol">tol</code></td>
<td>
<p>count eigenvalues smaller than this as zero</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a basis for a smooth function in x
</p>


<h3>Author(s)</h3>

<p>Fabian Scheipl
</p>


<h3>References</h3>

<p>Kneib, T. (2006). Mixed model based inference in structured
additive regression. Dr. Hut.
<a href="https://edoc.ub.uni-muenchen.de/archive/00005011/">https://edoc.ub.uni-muenchen.de/archive/00005011/</a>
</p>

<hr>
<h2 id='spikeAndSlab'>Set up and sample a spike-and-slab prior model.</h2><span id='topic+spikeAndSlab'></span>

<h3>Description</h3>

<p>This function sets up a spike-and-slab model for variable selection and model
choice in generalized additive models and samples its posterior. It uses a
blockwise Metropolis-within-Gibbs sampler and the redundant multiplicative
parameter expansion described in the reference. This routine is not meant to
be called directly by the user &ndash; <code><a href="#topic+spikeSlabGAM">spikeSlabGAM</a></code> provides a
formula-based interface for specifying models and takes care of (most of) the
housekeeping. Sampling of the chains is done in parallel using package
<code>parallel</code>. A &quot;SOCK&quot; cluster is set up under Windows to do so (and
closed after computations are done, I try to clean up after myself), see
<code><a href="parallel.html#topic+makeCluster">makeCluster</a></code> etc. Use <code>options(mc.cores =&lt;foo&gt;)</code>
to set the (maximal) number of processes forked by the parallelization. If
<code>options()$mc.cores</code> is unspecified, it is set to 2.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spikeAndSlab(
  y,
  X,
  family = c("gaussian", "binomial", "poisson"),
  hyperparameters = list(),
  model = list(),
  mcmc = list(),
  start = list()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="spikeAndSlab_+3A_y">y</code></td>
<td>
<p>response</p>
</td></tr>
<tr><td><code id="spikeAndSlab_+3A_x">X</code></td>
<td>
<p>design matrix</p>
</td></tr>
<tr><td><code id="spikeAndSlab_+3A_family">family</code></td>
<td>
<p>(character) the family of the response, defaults to
normal/Gaussian response</p>
</td></tr>
<tr><td><code id="spikeAndSlab_+3A_hyperparameters">hyperparameters</code></td>
<td>
<p>a list of hyperparameters controlling the priors (see
details)</p>
</td></tr>
<tr><td><code id="spikeAndSlab_+3A_model">model</code></td>
<td>
<p>a list with information about the grouping structure of the
model (see details)</p>
</td></tr>
<tr><td><code id="spikeAndSlab_+3A_mcmc">mcmc</code></td>
<td>
<p>(optional) list setting arguments for the sampler (see details)</p>
</td></tr>
<tr><td><code id="spikeAndSlab_+3A_start">start</code></td>
<td>
<p>(optional) list containing the starting values for <code class="reqn">\beta,
\gamma, \tau^2, \sigma^2, w</code> and, optionally, the random seed</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Details for model specification: </p>

<dl>
<dt><code>hyperparameters</code></dt><dd>
<dl>
<dt><code>w</code></dt><dd><p>hyperparameters for the <code class="reqn">Beta</code>-prior for <code class="reqn">w</code>;
defaults to <code>c(alphaW = 1, betaW = 1)</code>, i.e. a uniform distribution.</p>
</dd>
<dt><code>tau2</code></dt><dd><p>hyperparameters for the <code class="reqn">\Gamma^{-1}</code>-prior of the
hypervariances <code class="reqn">\tau^2</code>; defaults to <code>c(a1 = 5, a2 = 25)</code></p>
</dd>
<dt><code>gamma</code></dt><dd><p>sets <code class="reqn">v_0</code>, the ratio between the spike and slab
variances, defaults to <code>c(v0 = 0.00025)</code></p>
</dd>
<dt><code>sigma2</code></dt><dd><p>hyperparameters for <code class="reqn">\Gamma^{-1}</code>-prior for error
variance; defaults to <code>c(b1 = 1e-4, b2 = 1e-4)</code>. Only relevant for Gaussian
response.</p>
</dd> <dt><code>varKsi</code></dt><dd><p>variance for prior of <code class="reqn">\xi</code>, defaults to
1</p>
</dd> <dt><code>ksiDF</code></dt><dd><p>defaults to 0 for a gaussian prior for <code class="reqn">\xi</code>, else
induces a t-prior for <code class="reqn">\xi</code></p>
</dd></dl>
<p> with <code>ksiDF</code> degrees of freedom.</p>
</dd>
<dt><code>model</code></dt><dd>
<dl>
<dt><code>groupIndicators</code></dt><dd><p>a factor that maps the columns of X to the
different model terms</p>
</dd> <dt><code>H</code></dt><dd><p>a matrix containing the hierarchy of
the penalized model terms</p>
</dd> <dt><code>n</code></dt><dd><p>number of observations</p>
</dd>
<dt><code>q</code></dt><dd><p>length of <code class="reqn">\beta</code></p>
</dd> <dt><code>scale</code></dt><dd><p>scale/weights of
the response, defaults to <code>rep(1, n)</code>, use this to specify number of
trials for binomial data</p>
</dd> <dt><code>offset</code></dt><dd><p>defaults to <code>rep(0,
n)</code></p>
</dd></dl>
</dd> 
<dt><code>mcmc</code></dt><dd>
<dl>
<dt><code>nChains</code></dt><dd><p>how many parallel chains to run: defaults to 3</p>
</dd>
<dt><code>chainLength</code></dt><dd><p>how many samples should be generated per chain,
defaults to 500</p>
</dd> <dt><code>burnin</code></dt><dd><p>how many initial iterations should be
discarded, defaults to 100</p>
</dd> <dt><code>thin</code></dt><dd><p>save only every <code>thin</code>-th
iteration, defaults to 5</p>
</dd> <dt><code>verbose</code></dt><dd><p>verbose output and  report
progress? defaults to TRUE</p>
</dd> <dt><code>returnSamples</code></dt><dd><p>defaults to TRUE</p>
</dd>
<dt><code>sampleY</code></dt><dd><p>generate samples of y and its conditional expectation
from posterior predictive? defaults to FALSE</p>
</dd>
<dt><code>useRandomStart</code></dt><dd><p>use random draw or ridge estimate for beta as
starting value? defaults to TRUE, i.e. random starting values.</p>
</dd>
<dt><code>blocksize</code></dt><dd><p>approx. blocksizes of the updates for <code class="reqn">\alpha,
\xi</code>. Defaults to 50 for gaussian responses and 5/15 for non-gaussian
responses.</p>
</dd> <dt><code>scalemode</code></dt><dd><p>how to do term-wise rescaling of
subvectors of <code class="reqn">\xi</code> in each iteration:  0 means no rescaling, 1 means
rescaling s.t. each mean<code class="reqn">(|\xi_g|) = 1</code>,  2 means rescaling s.t. each
max<code class="reqn">(|\xi_g|) = 1</code></p>
</dd> <dt><code>modeSwitching</code></dt><dd><p>probability to do P-IWLS
with the mode of the proposal set to the current value, which is useful if
the chain gets stuck. Defaults to <code class="reqn">0.05</code>. Increase this if acceptance rates
are too low.</p>
</dd> <dt><code>reduceRet</code></dt><dd><p>don't return data and samples for
<code class="reqn">\alpha, \xi, \tau^2</code>? defaults to FALSE</p>
</dd></dl>
</dd>
<dt><code>start</code></dt><dd><dl>
<dt><code>beta</code></dt><dd><p>starting
values for <code class="reqn">\beta</code>. Defaults to a modified approximate ridge-penalized ML
estimate. See vignette for details on default specification.</p>
</dd>
<dt><code>gamma</code></dt><dd><p>starting values for <code class="reqn">\gamma</code>. Defaults to a vector of
1's if <code>mcmc$useRandomStart</code> is <code>FALSE</code>, otherwise drawn from the
prior.</p>
</dd> <dt><code>tau2</code></dt><dd><p>starting values for <code class="reqn">\tau^2</code>. Defaults to the
mode of the prior if <code>mcmc$useRandomStart</code> is <code>FALSE</code>, otherwise
drawn from the prior.</p>
</dd> <dt><code>sigma2</code></dt><dd><p>starting values for
<code class="reqn">\sigma^2</code>. Only relevant for Gaussian response. Defaults to the variance
of the response divided by the number of covariates if
<code>mcmc$useRandomStart</code> is <code>FALSE</code>, otherwise drawn from the prior.</p>
</dd>
<dt><code>w</code></dt><dd><p>starting value for <code class="reqn">w</code>. Defaults to the mean of the prior
if <code>mcmc$useRandomStart</code> is <code>FALSE</code>, otherwise drawn from the
prior.</p>
</dd> <dt><code>seed</code></dt><dd><p>Sets RNG seed for reproducible results. Parallel
chains are seeded with this seed incremented by the number of the chain.</p>
</dd></dl>
</dd></dl>



<h3>Value</h3>

<p>a list with components:</p>
 <dl>
<dt><code>formula</code></dt><dd><p>see
arguments</p>
</dd> <dt><code>data</code></dt><dd><p>see arguments</p>
</dd> <dt><code>family</code></dt><dd><p>see
arguments</p>
</dd> <dt><code>y</code></dt><dd><p>see arguments</p>
</dd> <dt><code>X</code></dt><dd><p>see arguments</p>
</dd>
<dt><code>hyperparameters</code></dt><dd><p>see arguments</p>
</dd> <dt><code>model</code></dt><dd><p>see
arguments</p>
</dd> <dt><code>mcmc</code></dt><dd><p>see arguments</p>
</dd> <dt><code>start</code></dt><dd><p>see
arguments</p>
</dd> <dt><code>posteriorPred</code></dt><dd><p>a list with entries <code>mu</code> and
<code>y</code> containing samples of the expected values and realizations of the
response from the posterior predictive</p>
</dd> <dt><code>postMeans</code></dt><dd><p>a list
containing the posterior means of the parameters: </p>

<dl>
<dt><code>beta</code></dt><dd><p>the regression coefficients</p>
</dd> <dt><code>alpha</code></dt><dd></dd>
<dt><code>ksi</code></dt><dd></dd> <dt><code>tau</code></dt><dd><p>hypervariances of the penalized model
terms</p>
</dd> <dt><code>gamma</code></dt><dd><p>inclusion indicator variables of the model
terms</p>
</dd> <dt><code>pV1</code></dt><dd><p><code class="reqn">P(\gamma = 1)</code></p>
</dd> <dt><code>w</code></dt><dd><p>hyperparameter
for <code>gamma</code></p>
</dd> <dt><code>sigma2</code></dt><dd><p>error variance (for Gaussian data)</p>
</dd>
<dt><code>logLik</code></dt><dd><p>log likelihood</p>
</dd> <dt><code>logPost</code></dt><dd><p>log of
(unnormalized) posterior</p>
</dd></dl>
</dd> <dt><code>samples</code></dt><dd><p>a list containing the
posterior samples of the parameters, see above for explanation of the
entries</p>
</dd> <dt><code>DIC</code></dt><dd><p>a vector with <code class="reqn">DIC, pD, \bar{D},\hat{D}</code>.
Usually doesn't make much sense for this kind of model because of the
posterior's multimodality.</p>
</dd> <dt><code>fitted</code></dt><dd><p>a matrix with the
posterior mean of the linear predictor in the first column and the
posterior mean of the expected response in the second.</p>
</dd>
<dt><code>runTime</code></dt><dd><p>of the sampler, in seconds</p>
</dd></dl>



<h3>Author(s)</h3>

<p>Fabian Scheipl, Daniel Sabanes Bove
</p>


<h3>References</h3>

<p>Scheipl, F. (2010) Normal-Mixture-of-Inverse-Gamma Priors for
Bayesian Regularization and Model Selection in Structured Additive
Regression Models. <em>LMU Munich, Department of Statistics</em>: Technical
Reports, No.84 (<a href="https://epub.ub.uni-muenchen.de/11785/">https://epub.ub.uni-muenchen.de/11785/</a>)
</p>

<hr>
<h2 id='spikeSlabGAM'>Generate posterior samples for a GAMM with spike-and-slab priors</h2><span id='topic+spikeSlabGAM'></span>

<h3>Description</h3>

<p>This function fits structured additive regression models with spike-and-slab
priors via MCMC. The spike-and-slab prior results in an SSVS-like term
selection that can be used to aid model choice, e.g. to decide between linear
and smooth modelling of numeric covariates or which interaction effects are
relevant. Model terms can be factors (<code><a href="#topic+fct">fct</a></code>), linear/polynomial
terms (<code><a href="#topic+lin">lin</a></code>),  uni- or bivariate splines (<code><a href="#topic+sm">sm</a></code>,
<code><a href="#topic+srf">srf</a></code>), random intercepts (<code><a href="#topic+rnd">rnd</a></code>) or Markov random
fields (<code><a href="#topic+mrf">mrf</a></code>) and their interactions, i.e. an interaction
between two smooth terms yields an effect surface, an interaction between a
linear term and a random intercept yields random slopes, an interaction
between a linear term and a smooth term yields a varying coefficient term
etc.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spikeSlabGAM(
  formula,
  data,
  ...,
  family = "gaussian",
  hyperparameters = list(),
  model = list(),
  mcmc = list(),
  start = list()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="spikeSlabGAM_+3A_formula">formula</code></td>
<td>
<p>the model formula (see details below and
<code><a href="#topic+ssGAMDesign">ssGAMDesign</a></code>).</p>
</td></tr>
<tr><td><code id="spikeSlabGAM_+3A_data">data</code></td>
<td>
<p>the data containing the variables in the function</p>
</td></tr>
<tr><td><code id="spikeSlabGAM_+3A_...">...</code></td>
<td>
<p>additional arguments for <code><a href="#topic+ssGAMDesign">ssGAMDesign</a></code></p>
</td></tr>
<tr><td><code id="spikeSlabGAM_+3A_family">family</code></td>
<td>
<p>(character) the family of the response, defaults to
normal/Gaussian response, <code>"poisson"</code> and <code>"binomial"</code> are
implemented as well.</p>
</td></tr>
<tr><td><code id="spikeSlabGAM_+3A_hyperparameters">hyperparameters</code></td>
<td>
<p>A list of arguments specifying the prior settings. See
<code><a href="#topic+spikeAndSlab">spikeAndSlab</a></code>.</p>
</td></tr>
<tr><td><code id="spikeSlabGAM_+3A_model">model</code></td>
<td>
<p>A list of arguments describing the model structure. See
<code><a href="#topic+spikeAndSlab">spikeAndSlab</a></code>. User-supplied <code>groupIndicators</code> and
<code>H</code> entries will be overwritten by <code><a href="#topic+ssGAMDesign">ssGAMDesign</a></code>.</p>
</td></tr>
<tr><td><code id="spikeSlabGAM_+3A_mcmc">mcmc</code></td>
<td>
<p>A list of arguments specifying MCMC sampler options. See
<code><a href="#topic+spikeAndSlab">spikeAndSlab</a></code>.</p>
</td></tr>
<tr><td><code id="spikeSlabGAM_+3A_start">start</code></td>
<td>
<p>A list of starting values for the MCMC sampler. See
<code><a href="#topic+spikeAndSlab">spikeAndSlab</a></code>. Use <code>start = list(seed =&lt;YOUR_SEED&gt;)</code> to set
the RNG seed for reproducible results.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Implemented types of terms: </p>
 <dl>
<dt><code><a href="#topic+u">u</a></code></dt><dd><p>unpenalized
model terms associated with a flat prior (no selection)</p>
</dd>
<dt><code><a href="#topic+lin">lin</a></code></dt><dd><p>linear/polynomial terms</p>
</dd>
<dt><code><a href="#topic+fct">fct</a></code></dt><dd><p>factors</p>
</dd> <dt><code><a href="#topic+sm">sm</a></code></dt><dd><p>univariate smooth
functions</p>
</dd> <dt><code><a href="#topic+rnd">rnd</a></code></dt><dd><p>random intercepts</p>
</dd>
<dt><code><a href="#topic+mrf">mrf</a></code></dt><dd><p>Markov random fields</p>
</dd>
<dt><code><a href="#topic+srf">srf</a></code></dt><dd><p>surface estimation</p>
</dd> </dl>
<p> Terms in the formula that are
not in the list of specials (i.e. the list of term types above) are
automatically assigned an appropriate special wrapper, i.e. numerical
covariates <code>x</code> are treated as <code><a href="#topic+lin">lin</a>(x) + <a href="#topic+sm">sm</a>(x)</code>,
factors <code>f</code> (and numerical covariates with very few distinct values, see
<code><a href="#topic+ssGAMDesign">ssGAMDesign</a></code>) are treated as <code><a href="#topic+fct">fct</a>(f)</code>. Valid model
formulas have to satisfy the following conditions: </p>
 <ol>
<li><p> All
variables that are involved in interactions have to be present as main
effects as well, i.e. <code>y ~ x1 + x1:x2</code> will produce an error because
the main effect of <code>x2</code> is missing. </p>
</li>
<li><p> Interactions between
unpenalized terms not under selection (i.e. terms of type <code><a href="#topic+u">u</a></code>)
and penalized terms are not allowed, i.e. <code>y ~ u(x1)* x2</code> will produce an
error. </p>
</li>
<li><p> If main effects are specified as special terms, the interactions
involving them have to be given as special terms as well, i.e. <code>y ~
lin(x1) + lin(x2) + x1:x2</code> will produce an error. </p>
</li></ol>

<p>The default prior settings for Gaussian data work best for a response with
unit variance. If your data is scaled very differently, either rescale the
response (recommended) or adjust the hyperparameters accordingly.
</p>
<p>Sampling of the chains is done in parallel using package <code>multicore</code> if
available. If not, a socket cluster set up with <code>snow</code> is used where
available. Use <code>options(mc.cores = foo)</code> to set the (maximal) number of
processes spawned by the parallelization. If <code>options()$mc.cores</code> is
unspecified, snow uses 8.
</p>


<h3>Value</h3>

<p>an object of class <code>spikeSlabGAM</code> with methods
<code><a href="#topic+summary.spikeSlabGAM">summary.spikeSlabGAM</a></code>, <code><a href="#topic+predict.spikeSlabGAM">predict.spikeSlabGAM</a></code>, and
<code><a href="#topic+plot.spikeSlabGAM">plot.spikeSlabGAM</a></code>.
</p>


<h3>Author(s)</h3>

<p>Fabian Scheipl
</p>


<h3>References</h3>

<p>Fabian Scheipl (2011). <code>spikeSlabGAM</code>: Bayesian Variable
Selection, Model Choice and Regularization for Generalized Additive Mixed
Models in R. <em>Journal of Statistical Software</em>, <b>43</b>(14), 1&ndash;24.
</p>
<p>Fabian Scheipl, Ludwig Fahrmeir, Thomas Kneib (2012). Spike-and-Slab Priors
for Function Selection in Structured Additive Regression Models.
<em>Journal of the American Statistical Association</em>, <b>107</b>(500),
1518&ndash;1532.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ssGAMDesign">ssGAMDesign</a></code> for details on model specification,
<code><a href="#topic+spikeAndSlab">spikeAndSlab</a></code> for more details on the MCMC sampler and prior
specification, and <code><a href="#topic+ssGAM2Bugs">ssGAM2Bugs</a></code> for MCMC diagnostics. Check out
the vignette for theoretical background and code examples.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## examples not run due to time constraints on CRAN checks.
## full examples below should take about 2-4 minutes.

set.seed(91179)
n &lt;- 400
d &lt;- data.frame(f1 = sample(gl(3, n/3)), f2 = sample(gl(4,
						n/4)), x1 = runif(n), x2 = runif(n), x3 = runif(n))
# true model:
#   - interaction between f1 and x1
#   - smooth interaction between x1 and x2,
#   - x3 and f2 are noise variables without influence on y
nf1 &lt;- as.numeric(d$f1)
d$f &lt;- with(d, 5 * (nf1 + 2 * sin(4 * pi * (x1 - 0.2) *
									(x2 - 0.7)) - nf1 * x1))
d$y &lt;- with(d, scale(f + rnorm(n)))
d$yp &lt;- with(d, rpois(n, exp(f/10)))

# fit &amp; display the model:
m1 &lt;- spikeSlabGAM(y ~ x1 * f1 + f1 * f2 + x3 * f1 +
				x1 * x2, data = d)
summary(m1)

# visualize estimates:
plot(m1)
plot(m1, cumulative = FALSE)
(plotTerm("fct(f1):fct(f2)", m1, aggregate = median))
print(p &lt;- plotTerm("sm(x1):sm(x2)", m1, quantiles = c(0.25,
						0.75), cumulative = FALSE))

# change MCMC settings and priors:
mcmc &lt;- list(nChains = 3, burnin = 100, chainLength = 1000,
		thin = 3, reduceRet = TRUE)
hyper &lt;- list(gamma = c(v0 = 5e-04), tau2 = c(10,
				30), w = c(2, 1))

# complicated formula example, poisson response:
m2 &lt;- spikeSlabGAM(yp ~ x1 * (x2 + f1) + (x2 + x3 + f2)^2 -
         sm(x2):sm(x3), data = d,
  				family = "poisson", mcmc = mcmc,
		      hyperparameters = hyper)
summary(m2)
plot(m2)

# quick&amp;dirty convergence diagnostics:
print(b &lt;- ssGAM2Bugs(m2))
plot(b)

## End(Not run)
</code></pre>

<hr>
<h2 id='srf'>Generate design for penalized surface estimation.</h2><span id='topic+srf'></span>

<h3>Description</h3>

<p>This function generates the design for a 2-D penalized spline using (almost)
radial basis functions. Use this type of term to account for <em>spatial</em>
variation. Smooth interactions between covariates are often better fitted via
the interactions of <code><a href="#topic+lin">lin</a></code> and <code><a href="#topic+sm">sm</a></code> terms, because
they allow a decomposition into (linear and smooth) marginal trends and
(linear-linear, linear-smooth/&quot;varying coefficients&quot;, and smooth-smooth)
interactions. This decomposition usually makes no sense for spatial data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>srf(
  coords,
  K = min(50, sum(nd)/4),
  rankZ = 0.999,
  centerBase = TRUE,
  baseType = c("B", "thinPlate"),
  decomposition = c("ortho", "MM", "asIs"),
  tol = 1e-10
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="srf_+3A_coords">coords</code></td>
<td>
<p>a <code>data.frame</code> with two columns containing the coordinates</p>
</td></tr>
<tr><td><code id="srf_+3A_k">K</code></td>
<td>
<p>(approximate) number of basis functions in the original basis
(defaults to 50). If <code>baseType ="B"</code> you can specify a vector giving
the number of marginal basis functions in each direction.</p>
</td></tr>
<tr><td><code id="srf_+3A_rankz">rankZ</code></td>
<td>
<p>how many eigenvectors to retain from the eigen decomposition:
either a number &gt; 3 or the proportion of the sum of eigenvalues the
retained eigenvectors must represent at least. Defaults to .999.</p>
</td></tr>
<tr><td><code id="srf_+3A_centerbase">centerBase</code></td>
<td>
<p>project the basis of the penalized part into the complement
of the column space of the basis of the unpenalized part? defaults to TRUE</p>
</td></tr>
<tr><td><code id="srf_+3A_basetype">baseType</code></td>
<td>
<p>Defaults to <code>"B"</code>, i.e. a tensor product basis based on
marginal cubic B-splines with ridge penalty (i.e. penalizing deviations
from the constant). Set to <code>"thinPlate"</code> if cubic thin plate splines
are desired, see note below.</p>
</td></tr>
<tr><td><code id="srf_+3A_decomposition">decomposition</code></td>
<td>
<p>use a (truncated) spectral decomposition of the implied
prior covariance of <code class="reqn">f(x, y)</code> for a low rank representation with
orthogonal    basis functions and i.i.d. coefficients (<code>"ortho"</code>), or use
the mixed model reparameterization for non-orthogonal basis functions and
i.i.d. coefficients (<code>"MM"</code>) or use basis functions as they are with
i.i.d. coefficients (<code>"asIs"</code>). Defaults to <code>"ortho"</code>.</p>
</td></tr>
<tr><td><code id="srf_+3A_tol">tol</code></td>
<td>
<p>count eigenvalues smaller than this as zero</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that <code>srf()</code> expects <code>coords</code> to be a <code>data.frame</code> within
the larger <code>data.frame</code> supplied to <code><a href="#topic+spikeSlabGAM">spikeSlabGAM</a></code> in its
<code>data</code> argument, i.e. <code>coords</code> is considered a two-dimensional
covariate.
</p>
<p>If <code>baseType</code> is <code>'thinPlate'</code>, knot locations for the thin plate
spline basis are chosen via a space-filling algorithm (i.e. medoids returned
by <code><a href="cluster.html#topic+clara">clara</a></code>) as suggested in Ruppert/Wand/Carroll, ch.
13.5. Since the thin plate penalty term penalizes deviations from a linear
trend, it is recommended to add marginal linear trends and their interaction
to the model if <code>baseType ="thinPlate"</code> to improve the fit.  
</p>
<p>Note that predictions outside the convex hull (sometimes even just close its 
border) of the original data tend to become rather unstable very quickly.
</p>


<h3>Value</h3>

<p>a design matrix for the 2-D spline.
</p>


<h3>Author(s)</h3>

<p>Fabian Scheipl
</p>


<h3>References</h3>

<p>Ruppert, D., Wand, M.P., Carroll, R.J. (2003). Semiparametric
Regression. Cambridge University Press
</p>

<hr>
<h2 id='ssGAM2Bugs'>Convert samples from a model fitted with <code>spikeSlabGAM</code> into a
<code>bugs</code>-object</h2><span id='topic+ssGAM2Bugs'></span>

<h3>Description</h3>

<p>Use <code>plot</code> and <code>print</code> on the returned
<code><a href="R2WinBUGS.html#topic+bugs">bugs</a></code> object for convergence diagnostics. Lack of
convergence for <code class="reqn">\alpha</code> or <code class="reqn">\xi</code> does not necessarily mean that the
sampler has not converged for <code class="reqn">\beta</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ssGAM2Bugs(m, rm = c("alpha", "ksi", "gamma"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ssGAM2Bugs_+3A_m">m</code></td>
<td>
<p>a model fitted with <code>spikeSlabGAM</code></p>
</td></tr>
<tr><td><code id="ssGAM2Bugs_+3A_rm">rm</code></td>
<td>
<p>which parameter blocks to omit from the conversion. Defaults to
omission of <code class="reqn">\alpha, \xi</code>, and <code class="reqn">\gamma</code>. Set to NULL to keep all
MCMC samples.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code><a href="R2WinBUGS.html#topic+bugs">bugs</a></code> object which has convenience
functions for assessing convergence based on parallel MCMC runs
</p>


<h3>Author(s)</h3>

<p>Fabian Scheipl
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#see help for spikeSlabGAM
</code></pre>

<hr>
<h2 id='ssGAMDesign'>Generate design and model information for <code>spikeSlabGAM</code></h2><span id='topic+ssGAMDesign'></span>

<h3>Description</h3>

<p>This function generates the design matrix for a generalized additive (mixed)
model, based on smoothing spline ANOVA-like orthogonal decomposition of the
model terms and their interactions. It parses the formula given to
<code><a href="#topic+spikeSlabGAM">spikeSlabGAM</a></code> to provide all the arguments necessary for the
MCMC sampler.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ssGAMDesign(
  formula,
  data,
  specials = c("u", "lin", "fct", "sm", "rnd", "mrf", "srf"),
  minUniqueValues = 6,
  lowRankInteractions = TRUE,
  orthogonalizeInteractions = TRUE,
  decomposition = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ssGAMDesign_+3A_formula">formula</code></td>
<td>
<p>the model formula. Follows the usual R syntax described in
<code><a href="stats.html#topic+formula">formula</a></code>. Terms in the formula that are not in the list
of specials are automatically assigned an appropriate special, i.e.
numerical covariates <code>x</code> are treated as <code>lin(x) + sm(x)</code>, factors
<code>f</code> are treated as <code>fct(f)</code> (see <code>specials</code> argument). See
<code><a href="#topic+spikeSlabGAM">spikeSlabGAM</a></code> for more details.</p>
</td></tr>
<tr><td><code id="ssGAMDesign_+3A_data">data</code></td>
<td>
<p><code>data.frame</code> containing all the variables in the function</p>
</td></tr>
<tr><td><code id="ssGAMDesign_+3A_specials">specials</code></td>
<td>
<p>a vector of the types of possible model terms. These must be
implemented as functions generating a design matrix with a label attribute.
See also <code><a href="#topic+sm">sm</a>()</code> for an example. The documentation for
<code><a href="#topic+spikeSlabGAM">spikeSlabGAM</a></code> contains a list of implemented model term types
and usage examples.</p>
</td></tr>
<tr><td><code id="ssGAMDesign_+3A_minuniquevalues">minUniqueValues</code></td>
<td>
<p>the minimal number of unique values a covariate has to
have in order to not be treated as a factor. Defaults to 6.</p>
</td></tr>
<tr><td><code id="ssGAMDesign_+3A_lowrankinteractions">lowRankInteractions</code></td>
<td>
<p>should a low-rank approximation of the design
matrix for interaction terms based on a (truncated) spectral decomposition
of the implied covariance matrix be used? defaults to TRUE.</p>
</td></tr>
<tr><td><code id="ssGAMDesign_+3A_orthogonalizeinteractions">orthogonalizeInteractions</code></td>
<td>
<p>should the design matrices for interaction
terms be projected into the complement of the column space of the
respective main effects?  Can help separate marginal and interaction
effects. Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="ssGAMDesign_+3A_decomposition">decomposition</code></td>
<td>
<p>which decomposition to use, see <code><a href="#topic+sm">sm</a></code>.
Defaults to the default of <code><a href="#topic+sm">sm</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Setting <code>lowRankInteractions</code> to FALSE can result in very large models,
especially if higher-order interactions or interactions between terms with
lots of parameters are involved. Note that numeric covariates with fewer
unique values than <code>minUniqueValues</code> are treated as factors unless
wrapped in a special argument.
</p>
<p>This function is not meant to be called directly by the user,
<code><a href="#topic+spikeSlabGAM">spikeSlabGAM</a></code> is the user interface.
</p>


<h3>Value</h3>

<p>a list with components: </p>
<table>
<tr><td><code>response</code></td>
<td>
<p>the left hand side of the
model formula</p>
</td></tr> <tr><td><code>Design</code></td>
<td>
<p>the design matrix of the model specified in
formula</p>
</td></tr> <tr><td><code>groupIndicators</code></td>
<td>
<p>a factor that maps the columns of
<code>Design</code> to the different model terms</p>
</td></tr> <tr><td><code>H</code></td>
<td>
<p>a matrix containing
the hierarchy of the penalization groups (not used, included for backwards
compatibility)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Fabian Scheipl
</p>

<hr>
<h2 id='summary.spikeSlabGAM'>Summary for posterior of a <code>spikeSlabGAM</code> fit</h2><span id='topic+summary.spikeSlabGAM'></span>

<h3>Description</h3>

<p>Returns basic information about prior and model structure, posterior means of
inclusion probabilities, term importance and the most probable models found by
the SSVS.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'spikeSlabGAM'
summary(object, threshold = 0.5, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.spikeSlabGAM_+3A_object">object</code></td>
<td>
<p>an object of class <code>spikeSlabGAM</code></p>
</td></tr>
<tr><td><code id="summary.spikeSlabGAM_+3A_threshold">threshold</code></td>
<td>
<p>threshold for inclusion of a model term.  Defaults to 0.5.</p>
</td></tr>
<tr><td><code id="summary.spikeSlabGAM_+3A_...">...</code></td>
<td>
<p>arguments passed from or to other methods (not used)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Two scalar summaries of term importance are included: </p>

<dl>
<dt><code>P(gamma = 1)</code></dt><dd><p>The posterior mean of <code class="reqn">P(\gamma = 1)</code>, i.e. the
marginal posterior inclusion probability of the term.</p>
</dd> <dt><code>pi</code></dt><dd><p>The
scaled dot products of the posterior mean of the linear predictor
<code class="reqn">\eta_i</code> associated with the <code class="reqn">i</code>-th term and the total linear
predictor <code class="reqn">\eta</code>: <code class="reqn">\pi_i = \eta_i^T \eta/ \eta^T \eta</code>. They sum to
one (but can be negative as well), and (for mutually orthogonal <code class="reqn">\eta_i</code>)
provide a percentage decomposition of the sum of squares of <code class="reqn">\eta</code>. See
references for details.</p>
</dd></dl>
<p> The summary also shows the dimensionality of the
basis associated with a term.
</p>
<p>The top row in the model table shows the relative frequency of the respective
model, the bottom row shows cumulative relative frequencies for the models
visited most often.
</p>


<h3>Value</h3>

<p>an object of class <code>summary.spikeSlabGAM</code>
</p>


<h3>Author(s)</h3>

<p>Fabian Scheipl
</p>


<h3>References</h3>

<p>Gu, Chong (2002). Smoothing Spline ANOVA models. Springer. (see
chapter 3.6)
</p>

<hr>
<h2 id='u'>Generate design for an always included covariate</h2><span id='topic+u'></span>

<h3>Description</h3>

<p>Basically a wrapper for <code>model.matrix(~ x, ...)</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>u(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="u_+3A_x">x</code></td>
<td>
<p>covariate</p>
</td></tr>
<tr><td><code id="u_+3A_...">...</code></td>
<td>
<p>arguments passed to <code><a href="stats.html#topic+model.matrix">model.matrix</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a design matrix for x
</p>


<h3>Author(s)</h3>

<p>Fabian Scheipl
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
