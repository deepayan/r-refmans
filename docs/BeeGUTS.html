<!DOCTYPE html><html><head><title>Help for package BeeGUTS</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {BeeGUTS}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#BeeGUTS-package'><p>'BeeGUTS' package; a package to perform GUTS modelling for Bee experiments.</p></a></li>
<li><a href='#betacyfluthrinChronic'><p>Survival datasets for <em>Honey bees</em> exposed to</p>
constant concentration of Betacyfluthrin for 10 days.</a></li>
<li><a href='#concAC'><p>Recalculate the concentrations for the acute contact tests for bees</p></a></li>
<li><a href='#concAO'><p>Recalculate concentration for the acute oral tests for bees</p></a></li>
<li><a href='#concCst'><p>Recalculate the concentrations for the chronic oral tests for bees from</p>
mg a.s./kg feed to <code class="reqn">\mu</code>g/bee</a></li>
<li><a href='#criteriaCheck'><p>Computes PPC and NRMSE as defined in EFSA 2018</p></a></li>
<li><a href='#dataGUTS'><p>Read and format the data for the BeeGUTS model</p></a></li>
<li><a href='#fitBeeGUTS'><p>Fit a GUTS model for bees survival analysis using Bayesian Inference (stan)</p></a></li>
<li><a href='#fitBetacyfluthrin_Chronic'><p>Model calibration results datasets for <em>Honey bees</em> exposed to</p>
constant concentration of Betacyfluthrin for 10 days.</a></li>
<li><a href='#LCx'><p>Predict the Lethal Concentration method at which <code class="reqn">x\%</code> of organisms die for any</p>
specified time-point for a <code>beeSurvFit</code> object</a></li>
<li><a href='#LCx.beeSurvFit'><p>Predict the Lethal Concentration at which <code class="reqn">x\%</code> of organisms die for any</p>
specified time-point for a <code>beeSurvFit</code> object</a></li>
<li><a href='#plot.beeSurvData'><p>Plotting method for <code>beeSurvData</code> objects</p></a></li>
<li><a href='#plot.beeSurvFit'><p>Plotting method for <code>beeSurvFit</code> objects</p></a></li>
<li><a href='#plot.beeSurvPred'><p>Plotting method for <code>beeSurvPred</code> objects</p></a></li>
<li><a href='#plot.beeSurvValidation'><p>Plotting method for <code>beeSurvValidation</code> objects</p></a></li>
<li><a href='#plot.ppc'><p>Plotting method for <code>ppc</code> objects</p></a></li>
<li><a href='#ppc'><p>Generates an object to be used in posterior predictive check for <code>beeSurvFit</code>, <code>beeSurvPred</code></p></a></li>
<li><a href='#ppc.beeSurvFit'><p>Posterior predictive check method for <code>beeSurvFit</code> objects</p></a></li>
<li><a href='#predict.beeSurvFit'><p>Predict method for <code>beeSurvFit</code> objects</p></a></li>
<li><a href='#summary.beeSurvFit'><p>Summary of <code>beeSurvFit</code> objects</p></a></li>
<li><a href='#summary.LCx'><p>Summary of <code>LCx</code> objects</p></a></li>
<li><a href='#traceplot'><p>Plotting method for traces and densities for <code>beeSurvFit</code> objects</p></a></li>
<li><a href='#validate'><p>Validation method for <code>beeSurvFit </code> objects</p></a></li>
<li><a href='#validate.beeSurvFit'><p>Validate method for <code>beeSurvFit</code> objects</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>General Unified Threshold Model of Survival for Bees using
Bayesian Inference</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.3</td>
</tr>
<tr>
<td>Description:</td>
<td>Tools to calibrate, validate, and make predictions with the
    General Unified Threshold model of Survival adapted for Bee species. The
    model is presented in the publication from Baas, J., Goussen, B., Miles, M.,
    Preuss, T.G., Roessing, I. (2022) &lt;<a href="https://doi.org/10.1002%2Fetc.5423">doi:10.1002/etc.5423</a>&gt; and is based on the GUTS framework
    Jager, T., Albert, C., Preuss, T.G. and Ashauer, R. (2011) &lt;<a href="https://doi.org/10.1021%2Fes103092a">doi:10.1021/es103092a</a>&gt;.
    The authors are grateful to Bayer A.G. for its financial support.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>LazyDataCompression:</td>
<td>xz</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Biarch:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.4.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods, Rcpp (&ge; 0.12.0), RcppParallel (&ge; 5.0.1), rstan (&ge;
2.26.0), rstantools (&ge; 2.1.1), data.table, tidyr, ggplot2,
cowplot, dplyr, magrittr, utils, gridExtra, odeGUTS</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>BH (&ge; 1.66.0), Rcpp (&ge; 0.12.0), RcppEigen (&ge; 0.3.3.3.0),
RcppParallel (&ge; 5.0.1), rstan (&ge; 2.26.0), StanHeaders (&ge;
2.26.0)</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>GNU make</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/bgoussen/BeeGUTS">https://github.com/bgoussen/BeeGUTS</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/bgoussen/BeeGUTS/issues">https://github.com/bgoussen/BeeGUTS/issues</a></td>
</tr>
<tr>
<td>Suggests:</td>
<td>rmarkdown, knitr</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-09-18 14:43:56 UTC; gob</td>
</tr>
<tr>
<td>Author:</td>
<td>Benoit Goussen <a href="https://orcid.org/0000-0001-7204-7981"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Liubov Zakharova [ctb],
  Romoli Carlo [ctb],
  Bayer AG [cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Benoit Goussen &lt;benoit.goussen@ibacon.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-09-18 15:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='BeeGUTS-package'>'BeeGUTS' package; a package to perform GUTS modelling for Bee experiments.</h2><span id='topic+BeeGUTS-package'></span><span id='topic+BeeGUTS'></span>

<h3>Description</h3>

<p>Provide tools to analyse the survival toxicity tests performed for
bee species. It can be used to fit a Toxicokinetic-Toxicodynamic (TKTD) model
adapted for bee standard studies (acute oral, acute contact, and chronic oral studies).
The TKTD model used is the General Unified Threshold model of Survival (GUTS).
</p>
<p>The package follows the concept and assumptions presented in Baas et al (submitted)
</p>


<h3>References</h3>

<p>Baas, J., Goussen, B., Miles, M., Preuss, T.G., Roessing, I. (submitted).
BeeGUTS â€“ new integrative TKTD model for honey bees approach moving from single point estimates of toxicity and exposure to a holistic link between exposure and effect.
</p>
<p>Jager, T., Albert, C., Preuss, T.G. and Ashauer, R. (2011). General Unified Threshold model of Survival - a toxicokinetic-toxicodynamic framework for ecotoxicology.
<a href="https://doi.org/10.1021/es103092a">doi:10.1021/es103092a</a>
</p>
<p>Jager, T. and Ashauer, R. (2018). Modelling survival under chemical stress. A comprehensive guide to the GUTS framework. Version 1.0
<a href="https://leanpub.com/guts_book">https://leanpub.com/guts_book</a>
</p>
<p>EFSA PPR Scientific Opinion (2018). Scientific Opinion on the state of the art of Toxicokinetic/Toxicodynamic (TKTD) effect models for regulatory risk assessment of pesticides for aquatic organisms.
<a href="https://www.efsa.europa.eu/en/efsajournal/pub/5377">https://www.efsa.europa.eu/en/efsajournal/pub/5377</a>
</p>
<p>Stan Development Team (2020). RStan: the R interface to Stan. R package version 2.21.2.
<a href="https://mc-stan.org">https://mc-stan.org</a>
</p>

<hr>
<h2 id='betacyfluthrinChronic'>Survival datasets for <em>Honey bees</em> exposed to
constant concentration of Betacyfluthrin for 10 days.</h2><span id='topic+betacyfluthrinChronic'></span>

<h3>Description</h3>

<p>Survival datasets for <em>Honey bees</em> exposed to
constant concentration of Betacyfluthrin for 10 days.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(betacyfluthrinChronic)
</code></pre>


<h3>Format</h3>

<p>A list of class <code>beeSurvData</code> constructed by <code>dataGUTS</code> containing:
</p>

<dl>
<dt><code>nDatasets</code></dt><dd><p>An integer representing the number of datasets used.</p>
</dd>
<dt><code>survData</code></dt><dd><p>A data frame containing the survival information over time
for five treatments and a control in a wide format.</p>
</dd>
<dt><code>survData_long</code></dt><dd><p>A data frame containing the survival information over time
for five treatments and a control in a long format.</p>
</dd>
<dt><code>concData</code></dt><dd><p>A data frame containing the concentration information over time
for five treatments and a control in a wide format.</p>
</dd>
<dt><code>concData_long</code></dt><dd><p>A data frame containing the concentration information over time
for five treatments and a control in a long format.</p>
</dd>
<dt><code>unitData</code></dt><dd><p>A character string containing the units of the concentration data.</p>
</dd>
<dt><code>typeData</code></dt><dd><p>A character string containing the type of data (here Chronic_Oral).</p>
</dd>
<dt><code>beeSpecies</code></dt><dd><p>A character string containing the species of bee of interest (here Honey_Bee).</p>
</dd>
<dt><code>concModel</code></dt><dd><p>A data frame containing the concentration information recalculated
for the species of bee and test type of interest in a wide format.</p>
</dd>
<dt><code>concModel_long</code></dt><dd><p>A data frame containing the concentration information recalculated
for the species of bee and test type of interest in a long format.</p>
</dd>
<dt><code>messages</code></dt><dd><p>A data frame containing the warning messages returned by the function.</p>
</dd>
</dl>



<h3>References</h3>

<p>Bayer data.
</p>

<hr>
<h2 id='concAC'>Recalculate the concentrations for the acute contact tests for bees</h2><span id='topic+concAC'></span>

<h3>Description</h3>

<p>Recalculate the concentrations for the acute contact tests for bees
</p>


<h3>Usage</h3>

<pre><code class='language-R'>concAC(cExt, expTime, k_ca = 0.4, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="concAC_+3A_cext">cExt</code></td>
<td>
<p>The concentration applied</p>
</td></tr>
<tr><td><code id="concAC_+3A_exptime">expTime</code></td>
<td>
<p>The duration of the experiment in days</p>
</td></tr>
<tr><td><code id="concAC_+3A_k_ca">k_ca</code></td>
<td>
<p>Contact availability rate (d-1), default is 0.4</p>
</td></tr>
<tr><td><code id="concAC_+3A_...">...</code></td>
<td>
<p>Not used</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame containing a column with the time points and a column with the
recalculated concentrations
</p>


<h3>Examples</h3>

<pre><code class='language-R'>conc &lt;- concAC(cbind(3.1, 4, 6, 8), 4)
</code></pre>

<hr>
<h2 id='concAO'>Recalculate concentration for the acute oral tests for bees</h2><span id='topic+concAO'></span>

<h3>Description</h3>

<p>Recalculate concentration for the acute oral tests for bees
</p>


<h3>Usage</h3>

<pre><code class='language-R'>concAO(cExt, cTime = 0.25, expTime, k_sr = 0.625, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="concAO_+3A_cext">cExt</code></td>
<td>
<p>A dataframe of concentrations at time 0 concentration applied</p>
</td></tr>
<tr><td><code id="concAO_+3A_ctime">cTime</code></td>
<td>
<p>The duration of exposure in days, default is 0.25 d</p>
</td></tr>
<tr><td><code id="concAO_+3A_exptime">expTime</code></td>
<td>
<p>The duration of the experiment in days</p>
</td></tr>
<tr><td><code id="concAO_+3A_k_sr">k_sr</code></td>
<td>
<p>Stomach release rate (d-1), default is 0.625</p>
</td></tr>
<tr><td><code id="concAO_+3A_...">...</code></td>
<td>
<p>Not used</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame containing a column with the time points and a column with the
recalculated concentrations
</p>


<h3>Examples</h3>

<pre><code class='language-R'>conc &lt;- concAO(cExt = cbind(3.5, 6, 8, 10), cTime = 0.25, expTime = 4)
</code></pre>

<hr>
<h2 id='concCst'>Recalculate the concentrations for the chronic oral tests for bees from
mg a.s./kg feed to <code class="reqn">\mu</code>g/bee</h2><span id='topic+concCst'></span>

<h3>Description</h3>

<p>Recalculate the concentrations for the chronic oral tests for bees from
mg a.s./kg feed to <code class="reqn">\mu</code>g/bee
</p>


<h3>Usage</h3>

<pre><code class='language-R'>concCst(cExt, f_rate = c(25), targConc = 1, cstConcCal = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="concCst_+3A_cext">cExt</code></td>
<td>
<p>The concentration dataframe in mg a.s./kg feed</p>
</td></tr>
<tr><td><code id="concCst_+3A_f_rate">f_rate</code></td>
<td>
<p>A vector containing the feeding rates of the bees in mg/bee/day. If the vector
is of size 1, the same feeding rate is used for all test conditions. If the vector
is of size &gt;1, it should be of the same size as the number of condition and one
feeding rate must be provided per condition. Default is 25 mg/bee/day</p>
</td></tr>
<tr><td><code id="concCst_+3A_targconc">targConc</code></td>
<td>
<p>A numerical scalar representing the unit of the target concentration amongst (default = 1)
</p>

<ul>
<li> <p><code>1</code> for <code class="reqn">\mu</code>g a.s./bee
</p>
</li>
<li> <p><code>2</code> for ng a.s./bee
</p>
</li>
<li> <p><code>3</code> for mg a.s./bee
</p>
</li></ul>
</td></tr>
<tr><td><code id="concCst_+3A_cstconccal">cstConcCal</code></td>
<td>
<p>Logical. Indicate if concentrations should be recalculated from
mg a.s./kg feed to Xg/bee</p>
</td></tr>
<tr><td><code id="concCst_+3A_...">...</code></td>
<td>
<p>Not used</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame containing a column with the time points and a column with the
recalculated concentrations
</p>


<h3>Examples</h3>

<pre><code class='language-R'>cExt &lt;- data.frame(SurvivalTime = c(0,10), Control = c(0,0),
        T1 = c(1, 1), T2 = c(5, 5), Dataset = c(1, 1))
conc &lt;- concCst(cExt, targConc = 2)
</code></pre>

<hr>
<h2 id='criteriaCheck'>Computes PPC and NRMSE as defined in EFSA 2018</h2><span id='topic+criteriaCheck'></span>

<h3>Description</h3>

<p>Computes PPC and NRMSE as defined in EFSA 2018
</p>


<h3>Usage</h3>

<pre><code class='language-R'>criteriaCheck(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="criteriaCheck_+3A_x">x</code></td>
<td>
<p>an object of class <code>beeSurvFit</code> or <code>beeSurvPred</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a list with three items:
</p>
<table>
<tr><td><code>PPC</code></td>
<td>
<p>The criterion, in percent, compares the predicted median number of survivors associated
to their uncertainty limits with the observed numbers of survivors.
Based on experience, PPC resulting in more than <code class="reqn">50\%</code> of the
observations within the uncertainty limits indicate good model performance (EFSA 2018). A fit of
<code class="reqn">100\%</code> may hide too large uncertainties of prediction (so covering all data).</p>
</td></tr>
<tr><td><code>NRMSE</code></td>
<td>
<p>The criterion, in percent, is based on the classical root-mean-square error (RMSE),
used to aggregate the magnitudes of the errors in predictions for various time-points
into a single measure of predictive power. In order to provide a criterion expressed
as a percentage, NRMSE is the normalised RMSE by the mean of the observations.
EFSA (2018) recognised that a NRMSE of less than 50% indicates good model performance</p>
</td></tr>
<tr><td><code>SPPE</code></td>
<td>
<p>A list with the Survival Probability Prediction Error per dataset and condition.
Each dataset is in a sublist.</p>
</td></tr>
</table>
<p>@references
EFSA PPR Scientific Opinion (2018)
<em>Scientific Opinion on the state of the art of Toxicokinetic/Toxicodynamic (TKTD) effect models for regulatory risk assessment of pesticides for aquatic organisms</em>
<a href="https://www.efsa.europa.eu/en/efsajournal/pub/5377">https://www.efsa.europa.eu/en/efsajournal/pub/5377</a>
</p>
<p>@example
data(fitBetacyfluthrin_Chronic)
out &lt;- criteriaCheck(fitBetacyfluthrin_Chronic)
</p>

<hr>
<h2 id='dataGUTS'>Read and format the data for the BeeGUTS model</h2><span id='topic+dataGUTS'></span>

<h3>Description</h3>

<p>Read data from a <code>text</code> or <code>csv</code> file and recalculate the
exposure profile depending on the type of experiment (acute oral, acute contact, chronic oral).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dataGUTS(
  file_location = NULL,
  test_type = NULL,
  bee_species = "Honey_Bee",
  NA_string = getOption("datatable.na.strings", "NA"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dataGUTS_+3A_file_location">file_location</code></td>
<td>
<p>List of Locations of text files containing each two datasets, one for the survival data,
and one for the concentration data. Both datasets must be included in the same file and contain the same number of column in the same order.
The following columns must be included in the survival dataset:
</p>

<ul>
<li> <p><code>Survival time \[d\]</code>: a vector of time in days
</p>
</li>
<li> <p><code>Control</code> A vector of number of survivors for the control
</p>
</li>
<li> <p><code>T1</code> - <code>Tn</code> A vector of number of survivors for the treatments
T1 to Tn, one column per treatment.
</p>
</li></ul>

<p>A line containing the <code>Concentration unit</code> must be included directly after the end of
the last row of the survival data.
</p>
<p>The following columns must be included in the concentration dataset
</p>

<ul>
<li> <p><code>Concentration time \[d\]</code>: a vector of time in days.
</p>
</li>
<li> <p><code>Control</code> A vector of concentrations for the control
</p>
</li>
<li> <p><code>T1</code> - <code>Tn</code> A vector of concentration for the treatments
T1 to Tn, one column per treatment.
</p>
</li></ul>

<p>For the <code>Acute_Oral</code> and <code>Acute_Contact</code>, only the initial
exposure concentration at time 0 is required.
</p>
<p>See detail section for example</p>
</td></tr>
<tr><td><code id="dataGUTS_+3A_test_type">test_type</code></td>
<td>
<p>list of test types amongst &quot;Acute_Oral&quot;, &quot;Acute_Contact&quot;, and &quot;Chronic_Oral&quot;
this list must have the same length of the list of file locations</p>
</td></tr>
<tr><td><code id="dataGUTS_+3A_bee_species">bee_species</code></td>
<td>
<p>the bee type among &quot;Honey_Bee&quot;, &quot;Bumble_Bee&quot;, &quot;Osmia_bicornis&quot;, and &quot;User_Bee&quot;. If &quot;User_Bee&quot; is selected,
optional arguments to be passed to the concentration reconstruction need to be defined.</p>
</td></tr>
<tr><td><code id="dataGUTS_+3A_na_string">NA_string</code></td>
<td>
<p>a character vector of strings which are to be interpreted as NA values</p>
</td></tr>
<tr><td><code id="dataGUTS_+3A_...">...</code></td>
<td>
<p>Optional arguments to be passed to the concentration reconstruction (e.g.
</p>

<ul>
<li> <p><code>k_sr =</code> for the stomach release rate (d-1), default is 0.625 for Honey bee,
</p>
</li>
<li> <p><code>k_ca =</code> contact availability rate (d-1), default is 0.4 for Honey bee), or
</p>
</li>
<li> <p><code>cTime =</code> the duration of exposure in days for the acute oral tests, default is 0.25 d
</p>
</li>
<li> <p><code>cstConcCal = </code> logical, recalculate concentration in the Chronic_Oral test from mg a.s./kg feed to Xg/bee (default is TRUE)
</p>
</li>
<li> <p><code>f_rate = </code> numerical vector, feeding rate used in the concentration recalculation in the Chronic_Oral (default is 25 mg/bee/day for honey bee)
</p>
</li>
<li> <p><code>targConc =</code> numerical scalar, target concentration unit in the recalculation in the Chronic_Oral, 1 for Âµg/bee, 2 for ng/bee, 3 for mg/bee (default is 1).
</p>
</li></ul>
</td></tr>
</table>


<h3>Details</h3>

<p>The filename must begin with name of the chemical substance being tested and
each word of the filename should be separated via an underscore '_'.
</p>
<p>#' Example of formatting of the input file for a chronic oral study
</p>

<table>
<tr>
 <td style="text-align: left;">
Survival time [d] </td><td style="text-align: left;">	Control	</td><td style="text-align: left;"> T1	</td><td style="text-align: left;"> T2	</td><td style="text-align: left;"> T3	</td><td style="text-align: left;"> T4	</td><td style="text-align: left;"> T5 </td>
</tr>
<tr>
 <td style="text-align: left;">
0	</td><td style="text-align: left;"> 120	</td><td style="text-align: left;"> 120	</td><td style="text-align: left;"> 120	</td><td style="text-align: left;"> 120	</td><td style="text-align: left;"> 120	</td><td style="text-align: left;"> 120 </td>
</tr>
<tr>
 <td style="text-align: left;">
1	</td><td style="text-align: left;"> 120	</td><td style="text-align: left;"> 118	</td><td style="text-align: left;"> 117	</td><td style="text-align: left;"> 112	</td><td style="text-align: left;"> 115	</td><td style="text-align: left;"> 94 </td>
</tr>
<tr>
 <td style="text-align: left;">
2	</td><td style="text-align: left;"> 120	</td><td style="text-align: left;"> 118	</td><td style="text-align: left;"> 115	</td><td style="text-align: left;"> 112	</td><td style="text-align: left;"> 98	</td><td style="text-align: left;"> 88 </td>
</tr>
<tr>
 <td style="text-align: left;">
3	</td><td style="text-align: left;"> 120	</td><td style="text-align: left;"> 118	</td><td style="text-align: left;"> 114	</td><td style="text-align: left;"> 106	</td><td style="text-align: left;"> 83	</td><td style="text-align: left;"> 27 </td>
</tr>
<tr>
 <td style="text-align: left;">
4	</td><td style="text-align: left;"> 119	</td><td style="text-align: left;"> 118	</td><td style="text-align: left;"> 113	</td><td style="text-align: left;"> 103	</td><td style="text-align: left;"> 67	</td><td style="text-align: left;"> 9 </td>
</tr>
<tr>
 <td style="text-align: left;">
5	</td><td style="text-align: left;"> 119	</td><td style="text-align: left;"> 118	</td><td style="text-align: left;"> 112	</td><td style="text-align: left;"> 100	</td><td style="text-align: left;"> 43	</td><td style="text-align: left;"> 3 </td>
</tr>
<tr>
 <td style="text-align: left;">
Concentration unit: ug/bee/day </td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
Concentration time [d]	</td><td style="text-align: left;"> Control	</td><td style="text-align: left;"> T1	</td><td style="text-align: left;"> T2	</td><td style="text-align: left;"> T3	</td><td style="text-align: left;"> T4	</td><td style="text-align: left;"> T5 </td>
</tr>
<tr>
 <td style="text-align: left;">
0	</td><td style="text-align: left;"> 0	</td><td style="text-align: left;"> 3	</td><td style="text-align: left;"> 7	</td><td style="text-align: left;"> 12	</td><td style="text-align: left;"> 41	</td><td style="text-align: left;"> 68 </td>
</tr>
<tr>
 <td style="text-align: left;">
5	</td><td style="text-align: left;"> 0	</td><td style="text-align: left;"> 3	</td><td style="text-align: left;"> 7	</td><td style="text-align: left;"> 12	</td><td style="text-align: left;"> 41	</td><td style="text-align: left;"> 68
</td>
</tr>

</table>



<h3>Value</h3>

<p>An object of class <code>beeSurvData</code>, which is a list with the following information:
</p>
<table>
<tr><td><code>nDatasets</code></td>
<td>
<p>Number of files passed to the function</p>
</td></tr>
<tr><td><code>survData</code></td>
<td>
<p>A table containing the survival data as entered by the user in the input file</p>
</td></tr>
<tr><td><code>survData_long</code></td>
<td>
<p>A data frame containing the survival data in long format for model purposes</p>
</td></tr>
<tr><td><code>concData</code></td>
<td>
<p>A table containing the concentration data as entered by the user in the input file</p>
</td></tr>
<tr><td><code>concData_long</code></td>
<td>
<p>A data frame containing concentration data in long format</p>
</td></tr>
<tr><td><code>unitData</code></td>
<td>
<p>A character vector containing the units of the data as entered in the line <code>Concentration unit</code>
of the input file</p>
</td></tr>
<tr><td><code>typeData</code></td>
<td>
<p>A character vector containing the type of experiment</p>
</td></tr>
<tr><td><code>beeSpecies</code></td>
<td>
<p>A character vector containing the type bee</p>
</td></tr>
<tr><td><code>concModel</code></td>
<td>
<p>A data frame containing the concentration data as recalculated by the model</p>
</td></tr>
<tr><td><code>concModel_long</code></td>
<td>
<p>A data frame containing the concentration data as recalculated by the model in a long format</p>
</td></tr>
</table>
<p>Each element of the list is itself a list to account for multiple files that can be passed as input.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
file_location &lt;- system.file("extdata", "betacyfluthrin_chronic_ug.txt", package = "BeeGUTS")
lsData &lt;- dataGUTS(file_location = c(file_location),
                  test_type = c('Chronic_Oral'),
                  bee_species = "Honey_Bee",
                  cstConcCal = FALSE)

</code></pre>

<hr>
<h2 id='fitBeeGUTS'>Fit a GUTS model for bees survival analysis using Bayesian Inference (stan)</h2><span id='topic+fitBeeGUTS'></span>

<h3>Description</h3>

<p>The function <code>fitBeeGUTS</code> estimates the parameters of a GUTS model
for the stochastic death (SD) or individual tolerance (IT) death mechanisms for
survival analysis using Bayesian inference.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitBeeGUTS(
  data,
  modelType = NULL,
  distribution = "loglogistic",
  priorsList = NULL,
  parallel = TRUE,
  nCores = parallel::detectCores() - 1L,
  nChains = 3,
  nIter = 2000,
  nWarmup = floor(nIter/2),
  thin = 1,
  adaptDelta = 0.95,
  odeIntegrator = "rk45",
  relTol = 1e-08,
  absTol = 1e-08,
  maxSteps = 1000,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitBeeGUTS_+3A_data">data</code></td>
<td>
<p>An object of class <code>beeSurvData</code></p>
</td></tr>
<tr><td><code id="fitBeeGUTS_+3A_modeltype">modelType</code></td>
<td>
<p>A model type between <code>"SD"</code> for Stochastic Death and
<code>"IT"</code> for Individual Tolerance.</p>
</td></tr>
<tr><td><code id="fitBeeGUTS_+3A_distribution">distribution</code></td>
<td>
<p>A distribution for the IT death mechanism. To be chosen between
<code>"loglogistic"</code> and <code>"lognormal"</code>. Default is <code>"loglogistic"</code></p>
</td></tr>
<tr><td><code id="fitBeeGUTS_+3A_priorslist">priorsList</code></td>
<td>
<p>A list containing the prior distribution for the parameter considered.
By default, when no priors are provided (default is <code>NULL</code>), priors are set automatically
based on the experimental design (adapted from Delignette-Muller et al 2017)</p>
</td></tr>
<tr><td><code id="fitBeeGUTS_+3A_parallel">parallel</code></td>
<td>
<p>Logical indicating whether parallel computing should be used or not.  Default is <code>TRUE</code></p>
</td></tr>
<tr><td><code id="fitBeeGUTS_+3A_ncores">nCores</code></td>
<td>
<p>A positive integer specifying the number of cores to use.
Default is one core less than maximum number of cores available</p>
</td></tr>
<tr><td><code id="fitBeeGUTS_+3A_nchains">nChains</code></td>
<td>
<p>A positive integer specifying the number of MCMC chains to run. Default is 3.</p>
</td></tr>
<tr><td><code id="fitBeeGUTS_+3A_niter">nIter</code></td>
<td>
<p>A positive integer specifying the number of iteration to monitor for each MCMC chain. Default is 2000</p>
</td></tr>
<tr><td><code id="fitBeeGUTS_+3A_nwarmup">nWarmup</code></td>
<td>
<p>A positive integer specifying the number of warmup iteration per chain. Default is half the number of iteration</p>
</td></tr>
<tr><td><code id="fitBeeGUTS_+3A_thin">thin</code></td>
<td>
<p>A positive integer specifying the interval between the iterations to monitor. Default is 1 (all iterations are monitored)</p>
</td></tr>
<tr><td><code id="fitBeeGUTS_+3A_adaptdelta">adaptDelta</code></td>
<td>
<p>A double, bounded between 0 and 1 and controlling part of the sampling algorithms.
See the <code>control</code> in the function <code>stan</code> <code><a href="rstan.html#topic+stan">rstan::stan()</a></code> of the package <code>rstan</code>. The default is 0.95.</p>
</td></tr>
<tr><td><code id="fitBeeGUTS_+3A_odeintegrator">odeIntegrator</code></td>
<td>
<p>A string specifying the integrator used to solve the system of
differential equations (ODE) in the <code>stan</code> module. To be chosen between
<code>"rk45"</code> and <code>"bdf"</code>. Default is <code>"rk45"</code>.</p>
</td></tr>
<tr><td><code id="fitBeeGUTS_+3A_reltol">relTol</code></td>
<td>
<p>A double, bounded between 0 and 1 and controlling the relative tolerance
of the accuracy of the solutions generated by the integrator. A smaller tolerance produces
more accurate solution at the expanse of the computing time. Default is 1e-8</p>
</td></tr>
<tr><td><code id="fitBeeGUTS_+3A_abstol">absTol</code></td>
<td>
<p>A double, bounded between 0 and 1 and controlling the absolute tolerance
of the accuracy of the solutions generated by the integrator. A smaller tolerance produces
more accurate solution at the expanse of the computing time. Default is 1e-8</p>
</td></tr>
<tr><td><code id="fitBeeGUTS_+3A_maxsteps">maxSteps</code></td>
<td>
<p>A double controlling the maximum number of steps that can be
taken before stopping a runaway simulation. Default is 1000</p>
</td></tr>
<tr><td><code id="fitBeeGUTS_+3A_...">...</code></td>
<td>
<p>Additional parameters to be passed to <code>sampling</code> from <code>stan</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The automated prior determination is modified from Delignette-Muller et al.
by considering that the minimal concentration for the prior can be close to 0 (1e-6)
whereas the original paper considered the lowest non-zero concentration.
Similarly, the minimal kd considered for the prior calculation was reduced to allow
more chance to capture slow kinetics.
</p>


<h3>Value</h3>

<p>The function <code>fitBeeGUTS</code> returns the parameter estimates
of the General Unified Threshold model of Survival (GUTS) in an object
of class <code>beeSurvFit</code>. This object is a list composed of the following:
</p>
<table>
<tr><td><code>stanFit</code></td>
<td>
<p>An object of S4 class <code>stanfit</code>. More information is available
in the package <code>rstan</code>. </p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>The data object provided as argument of the function</p>
</td></tr>
<tr><td><code>dataFit</code></td>
<td>
<p>A list of data passed to the Stan model object</p>
</td></tr>
<tr><td><code>setupMCMC</code></td>
<td>
<p>A list containing the setup used for the MCMC chains</p>
</td></tr>
<tr><td><code>modelType</code></td>
<td>
<p>A character vector specifying the type of GUTS model used between
<code>SD</code> and <code>IT</code></p>
</td></tr>
<tr><td><code>distribution</code></td>
<td>
<p>A character vector specifying the type of distribution used in case <code>IT</code> was used;
<code>NA</code> otherwise</p>
</td></tr>
<tr><td><code>messages</code></td>
<td>
<p>A character vector containing warning messages</p>
</td></tr>
</table>


<h3>References</h3>

<p>Delignette-Muller, M.L., Ruiz P. and Veber P. (2017).
Robust fit of toxicokinetic-toxicodynamic models using prior knowledge contained in the design of survival toxicity tests.
<a href="https://doi.org/10.1021/acs.est.6b05326">doi:10.1021/acs.est.6b05326</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(betacyfluthrinChronic)
fit &lt;- fitBeeGUTS(betacyfluthrinChronic, modelType = "SD", nIter = 1000, nCores = 2)

</code></pre>

<hr>
<h2 id='fitBetacyfluthrin_Chronic'>Model calibration results datasets for <em>Honey bees</em> exposed to
constant concentration of Betacyfluthrin for 10 days.</h2><span id='topic+fitBetacyfluthrin_Chronic'></span>

<h3>Description</h3>

<p>Model calibration results datasets for <em>Honey bees</em> exposed to
constant concentration of Betacyfluthrin for 10 days.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(fitBetacyfluthrin_Chronic)
</code></pre>


<h3>Format</h3>

<p>A list of class <code>beeSurvFit</code> constructed by <code>fitBeeGUTS</code> containing:
</p>

<dl>
<dt><code>stanFit</code></dt><dd><p>A 'stanfit'  object containing the results of the calibration.</p>
</dd>
<dt><code>data</code></dt><dd><p>A 'beeSurvData' objects with the user data used for the calibration.</p>
</dd>
<dt><code>dataFit</code></dt><dd><p>A list containing the priors and data formatted for the calibration algorithm.</p>
</dd>
<dt><code>setupMCMC</code></dt><dd><p>A list containing the setup used for the MCMC.</p>
</dd>
<dt><code>modelType</code></dt><dd><p>A character string containing the type of GUTS model used (here 'SD').</p>
</dd>
<dt><code>distribution</code></dt><dd><p>A character string containing the distribution used (IT only, here 'NA').</p>
</dd>
<dt><code>messages</code></dt><dd><p>A character string containing the error messages if Rhat &gt;1.1 (here 'NA').</p>
</dd>
</dl>



<h3>References</h3>

<p>Bayer data.
</p>

<hr>
<h2 id='LCx'>Predict the Lethal Concentration method at which <code class="reqn">x\%</code> of organisms die for any
specified time-point for a <code>beeSurvFit</code> object</h2><span id='topic+LCx'></span>

<h3>Description</h3>

<p>Predict median and 95% credible interval of the <code class="reqn">x\%</code> Lethal Concentration.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LCx(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LCx_+3A_object">object</code></td>
<td>
<p>An object used to select a method</p>
</td></tr>
<tr><td><code id="LCx_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to generic methods</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When class of <code>object</code> is <code>beeSurvFit</code>, see <a href="#topic+LCx.beeSurvFit">LCx.beeSurvFit</a>.
</p>


<h3>Value</h3>

<p>A <code>LCx</code> object containing the results of the lethal concentration predictions
</p>

<hr>
<h2 id='LCx.beeSurvFit'>Predict the Lethal Concentration at which <code class="reqn">x\%</code> of organisms die for any
specified time-point for a <code>beeSurvFit</code> object</h2><span id='topic+LCx.beeSurvFit'></span>

<h3>Description</h3>

<p>Predict the Lethal Concentration at which <code class="reqn">x\%</code> of organisms die for any
specified time-point for a <code>beeSurvFit</code> object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'beeSurvFit'
LCx(
  object,
  X = 50,
  testType = "Chronic_Oral",
  timeLCx = NULL,
  concRange = NULL,
  nPoints = 100,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LCx.beeSurvFit_+3A_object">object</code></td>
<td>
<p>An object of class <code>beeSurvFit</code></p>
</td></tr>
<tr><td><code id="LCx.beeSurvFit_+3A_x">X</code></td>
<td>
<p>Percentage of individuals dying (e.g., <code class="reqn">50</code> for the <code class="reqn">LC_{50}</code>)</p>
</td></tr>
<tr><td><code id="LCx.beeSurvFit_+3A_testtype">testType</code></td>
<td>
<p>Test type for which the <code class="reqn">LC_{X}</code> is calculated
amongst &quot;Acute_Oral&quot;, &quot;Acute_Contact&quot;, and &quot;Chronic_Oral&quot;. Note that for
&quot;Acute_Oral&quot; and &quot;Acute_Contact&quot;, the concentration will be reconstructed as
in the <a href="#topic+dataGUTS">dataGUTS</a> function (not recommended as this might not
make sense for <code class="reqn">LC_{X}</code> estimations. Default is &quot;Chronic_Oral&quot;</p>
</td></tr>
<tr><td><code id="LCx.beeSurvFit_+3A_timelcx">timeLCx</code></td>
<td>
<p>A scalar giving the time at which  <code class="reqn">LC_{x}</code> is predicted.
If <code>NULL</code>, the latest time point of the experiment used in the calibration is used</p>
</td></tr>
<tr><td><code id="LCx.beeSurvFit_+3A_concrange">concRange</code></td>
<td>
<p>A vector of length 2 with minimal and maximal value of the
range of concentration. If <code>NULL</code>, the range is define between 0 and the
highest tested concentration of the calibration experiment.</p>
</td></tr>
<tr><td><code id="LCx.beeSurvFit_+3A_npoints">nPoints</code></td>
<td>
<p>Number of time point in <code>concRange</code> between 0 and the
maximal concentration. 100 by default.</p>
</td></tr>
<tr><td><code id="LCx.beeSurvFit_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to generic methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A object of class <code>LCx</code> containing the results of the lethal concentration predictions
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(fitBetacyfluthrin_Chronic)
out &lt;- LCx(fitBetacyfluthrin_Chronic)

</code></pre>

<hr>
<h2 id='plot.beeSurvData'>Plotting method for <code>beeSurvData</code> objects</h2><span id='topic+plot.beeSurvData'></span>

<h3>Description</h3>

<p>This is the generic <code>plot</code> S3 method for the <code>beeSurvData</code>
class. It plots the number of survivors as a function of time as well as the reconstructed
concentrations for <code>"Acute_Oral"</code> and <code>"Acute_Contact"</code> test types.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'beeSurvData'
plot(
  x,
  ...,
  xlab = "Time [d]",
  ylab1 = "Number of survivors",
  ylab2 = "Concentration",
  main = paste("Data from a", x$typeData, "test on", x$beeSpecies)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.beeSurvData_+3A_x">x</code></td>
<td>
<p>An object of class <code>beeSurvData</code></p>
</td></tr>
<tr><td><code id="plot.beeSurvData_+3A_...">...</code></td>
<td>
<p>Additional parameters to generic plot function (not used)</p>
</td></tr>
<tr><td><code id="plot.beeSurvData_+3A_xlab">xlab</code></td>
<td>
<p>A character string for the label of the x-axis</p>
</td></tr>
<tr><td><code id="plot.beeSurvData_+3A_ylab1">ylab1</code></td>
<td>
<p>A character string for the label of the y-axis of the survivor plots</p>
</td></tr>
<tr><td><code id="plot.beeSurvData_+3A_ylab2">ylab2</code></td>
<td>
<p>A character string for the label of the y-axis of the concentration plots</p>
</td></tr>
<tr><td><code id="plot.beeSurvData_+3A_main">main</code></td>
<td>
<p>A character string for the title label plot</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A graphic with the input data
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(betacyfluthrinChronic)
plot(betacyfluthrinChronic)
</code></pre>

<hr>
<h2 id='plot.beeSurvFit'>Plotting method for <code>beeSurvFit</code> objects</h2><span id='topic+plot.beeSurvFit'></span>

<h3>Description</h3>

<p>This is the generic <code>plot</code> S3 method for the <code>beeSurvFit</code>
class. It plots the number of survivors as a function of time as well as the reconstructed
concentrations for <code>"Acute_Oral"</code> and <code>"Acute_Contact"</code> test types.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'beeSurvFit'
plot(
  x,
  ...,
  xlab = "Time [d]",
  ylab1 = "Number of survivors",
  ylab2 = "Concentration",
  main = paste("Calibration results for a", x$data$typeData, "test on",
    x$data$beeSpecies)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.beeSurvFit_+3A_x">x</code></td>
<td>
<p>An object of class <code>beeSurvFit</code></p>
</td></tr>
<tr><td><code id="plot.beeSurvFit_+3A_...">...</code></td>
<td>
<p>Additional parameters to generic plot functions (not used)</p>
</td></tr>
<tr><td><code id="plot.beeSurvFit_+3A_xlab">xlab</code></td>
<td>
<p>A character string for the label of the x-axis</p>
</td></tr>
<tr><td><code id="plot.beeSurvFit_+3A_ylab1">ylab1</code></td>
<td>
<p>A character string for the label of the y-axis of the survivor plots</p>
</td></tr>
<tr><td><code id="plot.beeSurvFit_+3A_ylab2">ylab2</code></td>
<td>
<p>A character string for the label of the y-axis of the concentration plots</p>
</td></tr>
<tr><td><code id="plot.beeSurvFit_+3A_main">main</code></td>
<td>
<p>A character string for the title label plot</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A graphic with the results of the fit
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(fitBetacyfluthrin_Chronic)
plot(fitBetacyfluthrin_Chronic)
</code></pre>

<hr>
<h2 id='plot.beeSurvPred'>Plotting method for <code>beeSurvPred</code> objects</h2><span id='topic+plot.beeSurvPred'></span>

<h3>Description</h3>

<p>This is the generic <code>plot</code> S3 method for the <code>beeSurvPred</code>
class. It plots the predicted number of survivors for the exposure concentration entered by the user.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'beeSurvPred'
plot(
  x,
  ...,
  xlab = "Time [d]",
  ylab1 = "Survival probability",
  ylab2 = "Concentration",
  main = paste("Predictions results for a BeeGUTS", x$modelType, "calibrated for",
    x$beeSpecies)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.beeSurvPred_+3A_x">x</code></td>
<td>
<p>An object of class <code>beeSurvPred</code></p>
</td></tr>
<tr><td><code id="plot.beeSurvPred_+3A_...">...</code></td>
<td>
<p>Additional parameters to generic plot functions (not used)</p>
</td></tr>
<tr><td><code id="plot.beeSurvPred_+3A_xlab">xlab</code></td>
<td>
<p>A character string for the label of the x-axis</p>
</td></tr>
<tr><td><code id="plot.beeSurvPred_+3A_ylab1">ylab1</code></td>
<td>
<p>A character string for the label of the y-axis of the survivor plots</p>
</td></tr>
<tr><td><code id="plot.beeSurvPred_+3A_ylab2">ylab2</code></td>
<td>
<p>A character string for the label of the y-axis of the concentration plots</p>
</td></tr>
<tr><td><code id="plot.beeSurvPred_+3A_main">main</code></td>
<td>
<p>A character string for the title label plot</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A graphic with results of the forward prediction
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
dataPredict &lt;- data.frame(time = c(1:10, 1:10, 1:10),
                     conc = c(rep(5, 10), rep(10, 10), rep(15, 10)),
                     replicate = c(rep("rep1", 10), rep("rep2", 10), rep("rep3", 10)),
                     NSurv = c(rep(5, 10), rep(10, 10), rep(15, 10)))
data(fitBetacyfluthrin_Chronic)
prediction &lt;- predict(fitBetacyfluthrin_Chronic, dataPredict)
plot(prediction)

</code></pre>

<hr>
<h2 id='plot.beeSurvValidation'>Plotting method for <code>beeSurvValidation</code> objects</h2><span id='topic+plot.beeSurvValidation'></span>

<h3>Description</h3>

<p>This is the generic <code>plot</code> S3 method for the <code>beeSurvValid</code>
class. It plots the number of survivors as a function of time as well as the reconstructed
concentrations for <code>"Acute_Oral"</code> and <code>"Acute_Contact"</code> test types.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'beeSurvValidation'
plot(
  x,
  ...,
  xlab = "Time [d]",
  ylab1 = "Number of survivors",
  ylab2 = "Concentration",
  main = paste("Validation of a BeeGUTS model calibrated for", x$beeSpecies, "on a ",
    x$typeData, "for", x$beeSpeciesVal)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.beeSurvValidation_+3A_x">x</code></td>
<td>
<p>An object of class <code>beeSurvValid</code></p>
</td></tr>
<tr><td><code id="plot.beeSurvValidation_+3A_...">...</code></td>
<td>
<p>Additional parameters to generic plot functions (not used)</p>
</td></tr>
<tr><td><code id="plot.beeSurvValidation_+3A_xlab">xlab</code></td>
<td>
<p>A character string for the label of the x-axis</p>
</td></tr>
<tr><td><code id="plot.beeSurvValidation_+3A_ylab1">ylab1</code></td>
<td>
<p>A character string for the label of the y-axis of the survivor plots</p>
</td></tr>
<tr><td><code id="plot.beeSurvValidation_+3A_ylab2">ylab2</code></td>
<td>
<p>A character string for the label of the y-axis of the concentration plots</p>
</td></tr>
<tr><td><code id="plot.beeSurvValidation_+3A_main">main</code></td>
<td>
<p>A character string for the title label plot</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A graphic with the results of the validation
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(betacyfluthrinChronic) # Load dataset for validation
data(fitBetacyfluthrin_Chronic)
validation &lt;- validate(fitBetacyfluthrin_Chronic, betacyfluthrinChronic)
plot(validation)

</code></pre>

<hr>
<h2 id='plot.ppc'>Plotting method for <code>ppc</code> objects</h2><span id='topic+plot.ppc'></span>

<h3>Description</h3>

<p>Plotting method for <code>ppc</code> objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ppc'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.ppc_+3A_x">x</code></td>
<td>
<p>An object of class <code>ppc</code>.</p>
</td></tr>
<tr><td><code id="plot.ppc_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to generic methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of class <code>ggplot</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(fitBetacyfluthrin_Chronic)
out &lt;- ppc(fitBetacyfluthrin_Chronic)
plot(out)

</code></pre>

<hr>
<h2 id='ppc'>Generates an object to be used in posterior predictive check for <code>beeSurvFit</code>, <code>beeSurvPred</code></h2><span id='topic+ppc'></span>

<h3>Description</h3>

<p>Generates an object to be used in posterior predictive check for <code>beeSurvFit</code>, <code>beeSurvPred</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ppc(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ppc_+3A_x">x</code></td>
<td>
<p>an object used to select a method <code>ppc</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>data.frame</code> of class <code>ppc</code>
</p>

<hr>
<h2 id='ppc.beeSurvFit'>Posterior predictive check method for <code>beeSurvFit</code> objects</h2><span id='topic+ppc.beeSurvFit'></span>

<h3>Description</h3>

<p>Posterior predictive check method for <code>beeSurvFit</code> objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'beeSurvFit'
ppc(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ppc.beeSurvFit_+3A_x">x</code></td>
<td>
<p>an object of class <code>beeSurvFit</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>data.frame</code> of class <code>ppc</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(fitBetacyfluthrin_Chronic)
out &lt;- ppc(fitBetacyfluthrin_Chronic)

</code></pre>

<hr>
<h2 id='predict.beeSurvFit'>Predict method for <code>beeSurvFit</code> objects</h2><span id='topic+predict.beeSurvFit'></span>

<h3>Description</h3>

<p>This is the generic <code>predict</code> S3 method for the <code>beeSurvFit</code>
class. It predict the survival over time for the concentration profiles entered by the user.
No concentration reconstructions are performed here. Functions <code><a href="odeGUTS.html#topic+predict">odeGUTS::predict_ode()</a></code>
from the <code>morse</code> package is used. This might be changed in a future update
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'beeSurvFit'
predict(object, dataPredict, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.beeSurvFit_+3A_object">object</code></td>
<td>
<p>An object of class <code>beeSurvFit</code></p>
</td></tr>
<tr><td><code id="predict.beeSurvFit_+3A_datapredict">dataPredict</code></td>
<td>
<p>Data to predict in the format as a dataframe containing the
following column:
</p>

<ul>
<li> <p><code>time</code>: A vector of time in days
</p>
</li>
<li> <p><code>conc</code>: A vector of number of survivors of same length
</p>
</li>
<li> <p><code>replicate</code> A vector replicate name
</p>
</li></ul>
</td></tr>
<tr><td><code id="predict.beeSurvFit_+3A_...">...</code></td>
<td>
<p>Additional arguments to be parsed to the  <code>predict.survFit</code> method from <code>odeGUTS</code> (e.g.
<code>mcmc_size = 1000</code> is to be used to reduce the number of mcmc samples in order to speed up
the computation. <code>mcmc_size</code> is the number of selected iterations for one chain. Default
is 1000. If all MCMC is wanted, set argument to <code>NULL</code>.
<code>hb_value  = FALSE</code> the background mortality <code>hb</code> is set to a fixed value.
If <code>TRUE</code>, parameter <code>hb</code> taken from the posterior (only works if
one <code>hb</code> value was estimated. The default is <code>FALSE</code>.
<code>hb_valueFORCED  = 0</code> hb_valueFORCED If <code>hb_value</code> is <code>FALSE</code>, it fix <code>hb</code>. The default is <code>0</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>beeSurvPred</code> object containing the results of the forwards prediction
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
dataPredict &lt;- data.frame(time = c(1:5, 1:15),
                          conc = c(rep(5, 5), rep(15, 15)),
                          replicate = c(rep("rep1", 5), rep("rep2", 15)))
data(fitBetacyfluthrin_Chronic)
prediction &lt;- predict(fitBetacyfluthrin_Chronic, dataPredict)

</code></pre>

<hr>
<h2 id='summary.beeSurvFit'>Summary of <code>beeSurvFit</code> objects</h2><span id='topic+summary.beeSurvFit'></span>

<h3>Description</h3>

<p>This is the generic <code>summary</code> S3 method for the <code>beeSurvFit</code> class.
It shows the quantiles of priors and posteriors on parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'beeSurvFit'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.beeSurvFit_+3A_object">object</code></td>
<td>
<p>An object of class <code>beeSurvFit</code></p>
</td></tr>
<tr><td><code id="summary.beeSurvFit_+3A_...">...</code></td>
<td>
<p>Additional arguments to be parsed to the generic <code>summary</code> method (not used)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A summary of the <code>beeSurvFit</code> object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(fitBetacyfluthrin_Chronic)
summary(fitBetacyfluthrin_Chronic)

</code></pre>

<hr>
<h2 id='summary.LCx'>Summary of <code>LCx</code> objects</h2><span id='topic+summary.LCx'></span>

<h3>Description</h3>

<p>This is the generic <code>summary</code> S3 method for the <code>LCx</code> class.
It shows the median and 95% credible interval of the calculated LCx.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'LCx'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.LCx_+3A_object">object</code></td>
<td>
<p>An object of class <code>LCx</code></p>
</td></tr>
<tr><td><code id="summary.LCx_+3A_...">...</code></td>
<td>
<p>Additional arguments to be parsed to the generic <code>summary</code> method (not used)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A summary of the <code>LCx</code> object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(fitBetacyfluthrin_Chronic)
out &lt;- LCx(fitBetacyfluthrin_Chronic)
summary(out)

</code></pre>

<hr>
<h2 id='traceplot'>Plotting method for traces and densities for <code>beeSurvFit</code> objects</h2><span id='topic+traceplot'></span><span id='topic+traceplot.beeSurvFit'></span>

<h3>Description</h3>

<p>This is the generic <code>traceplot</code> S3 method for the <code>beeSurvFit</code>
class. It plots the traces with as well as the densities for the parameters of
the GUTS IT or GUTS SD. The traceplot includes by default the warmup iterations,
the density plot does not include them
</p>


<h3>Usage</h3>

<pre><code class='language-R'>traceplot(object, ..., incWarmup_trace = TRUE, incWarmup_dens = FALSE)

## S3 method for class 'beeSurvFit'
traceplot(object, ..., incWarmup_trace = TRUE, incWarmup_dens = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="traceplot_+3A_object">object</code></td>
<td>
<p>An object of class <code>beeSurvFit</code> to be plotted</p>
</td></tr>
<tr><td><code id="traceplot_+3A_...">...</code></td>
<td>
<p>Additional parameters to be parsed to generic <code>rstan</code> plot functions</p>
</td></tr>
<tr><td><code id="traceplot_+3A_incwarmup_trace">incWarmup_trace</code></td>
<td>
<p>A logical indicating whether the warmup iterations should be plotted
in the traceplot (default TRUE)</p>
</td></tr>
<tr><td><code id="traceplot_+3A_incwarmup_dens">incWarmup_dens</code></td>
<td>
<p>A logical indicating whether the warmup iterations should be plotted
in the density plot (default FALSE)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A graphic with the traceplots and densities of the fit
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(fitBetacyfluthrin_Chronic)
traceplot(fitBetacyfluthrin_Chronic)
</code></pre>

<hr>
<h2 id='validate'>Validation method for <code>beeSurvFit </code> objects</h2><span id='topic+validate'></span>

<h3>Description</h3>

<p>This is a <code>validation</code> method for the
<code>beeSurvFit</code> object. It perform forwards predictions for a specific concentration
profile and compare these prediction to the respective experimental data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>validate(object, dataValidate, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="validate_+3A_object">object</code></td>
<td>
<p>An object of class <code>beeSurvFit</code></p>
</td></tr>
<tr><td><code id="validate_+3A_datavalidate">dataValidate</code></td>
<td>
<p>Data to validate in the format of the experimental data used for fit (dataGUTS)</p>
</td></tr>
<tr><td><code id="validate_+3A_...">...</code></td>
<td>
<p>Additional arguments to be parsed to the  <code>predict.survFit</code> method from <code>odeGUTS</code> (e.g.
<code>mcmc_size = 1000</code> is to be used to reduce the number of mcmc samples in order to speed up
the computation. <code>mcmc_size</code> is the number of selected iterations for one chain. Default
is 1000. If all MCMC is wanted, set argument to <code>NULL</code>.,
<code>hb_value  = FALSE</code> the background mortality <code>hb</code> is taken into account from the posterior.
If <code>FALSE</code>, parameter <code>hb</code> is set to a fixed value. The default is <code>FALSE</code>.
<code>hb_valueFORCED  = 0</code> hb_valueFORCED If <code>hb_value</code> is <code>FALSE</code>, it fix <code>hb</code>. The default is <code>0</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>beeSurvValidation</code>.
</p>

<hr>
<h2 id='validate.beeSurvFit'>Validate method for <code>beeSurvFit</code> objects</h2><span id='topic+validate.beeSurvFit'></span>

<h3>Description</h3>

<p>This is the generic <code>validate</code> S3 method for the <code>beeSurvFit</code>
class. It predict the survival over time for the concentration profiles entered by the user.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'beeSurvFit'
validate(object, dataValidate, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="validate.beeSurvFit_+3A_object">object</code></td>
<td>
<p>An object of class <code>beeSurvFit</code></p>
</td></tr>
<tr><td><code id="validate.beeSurvFit_+3A_datavalidate">dataValidate</code></td>
<td>
<p>Data to validate in the format of the experimental data used for fit (dataGUTS)</p>
</td></tr>
<tr><td><code id="validate.beeSurvFit_+3A_...">...</code></td>
<td>
<p>Additional arguments to be parsed to the  <code>predict.survFit</code> method from <code>odeGUTS</code> (e.g.
<code>mcmc_size = 1000</code> is to be used to reduce the number of mcmc samples in order to speed up
the computation. <code>mcmc_size</code> is the number of selected iterations for one chain. Default
is 1000. If all MCMC is wanted, set argument to <code>NULL</code>.,
<code>hb_value  = FALSE</code> the background mortality <code>hb</code> is taken into account from the posterior.
If <code>FALSE</code>, parameter <code>hb</code> is set to a fixed value. The default is <code>FALSE</code>.
<code>hb_valueFORCED  = 0</code> hb_valueFORCED If <code>hb_value</code> is <code>FALSE</code>, it fix <code>hb</code>. The default is <code>0</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>beeSurvValidation</code> object with the results of the validation
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(betacyfluthrinChronic)
data(fitBetacyfluthrin_Chronic)
validation &lt;- validate(fitBetacyfluthrin_Chronic, betacyfluthrinChronic)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
