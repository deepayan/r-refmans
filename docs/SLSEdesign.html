<!DOCTYPE html><html><head><title>Help for package SLSEdesign</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {SLSEdesign}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Aopt'><p>Calculate the A-optimal design under the second-order Least squares estimator</p></a></li>
<li><a href='#calc_phiA'><p>Calculate the loss function of the A-optimal design</p></a></li>
<li><a href='#calc_phiD'><p>Calculate the loss function of the D-optimal design</p></a></li>
<li><a href='#Dopt'><p>Calculate the D-optimal design under the SLSE</p></a></li>
<li><a href='#plot_direction_Aopt'><p>Verify the optimality condition for the A-optimal design</p></a></li>
<li><a href='#plot_direction_Dopt'><p>Verify the optimality condition for the D-optimal design</p></a></li>
<li><a href='#plot_weight'><p>Plot the weight distribution of the optimal design for univaraite regression model</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Optimal Regression Design under the Second-Order Least Squares
Estimator</td>
</tr>
<tr>
<td>Version:</td>
<td>0.0.3</td>
</tr>
<tr>
<td>Description:</td>
<td>With given inputs that include number of points, discrete design space, a measure of skewness, models and parameter value, this package calculates the objective value, optimal designs and plot the equivalence theory under A- and D-optimal criteria under the second-order Least squares estimator. This package is based on the paper "Properties of optimal regression designs under the second-order least squares estimator" by Chi-Kuang Yeh and Julie Zhou (2021) &lt;<a href="https://doi.org/10.1007%2Fs00362-018-01076-6">doi:10.1007/s00362-018-01076-6</a>&gt;. </td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/chikuang/SLSEdesign">https://github.com/chikuang/SLSEdesign</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/chikuang/SLSEdesign/issues">https://github.com/chikuang/SLSEdesign/issues</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>Imports:</td>
<td>CVXR</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-05-29 14:30:24 UTC; chikuang</td>
</tr>
<tr>
<td>Author:</td>
<td>Chi-Kuang Yeh <a href="https://orcid.org/0000-0001-7057-2096"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Julie Zhou [aut, ctb],
  Jason Hou-Liu [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Chi-Kuang Yeh &lt;chi-kuang.yeh@uwaterloo.ca&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-05-29 23:30:08 UTC</td>
</tr>
</table>
<hr>
<h2 id='Aopt'>Calculate the A-optimal design under the second-order Least squares estimator</h2><span id='topic+Aopt'></span>

<h3>Description</h3>

<p>Calculate the A-optimal design under the second-order Least squares estimator
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Aopt(N, u, tt, FUN, theta, num_iter = 1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Aopt_+3A_n">N</code></td>
<td>
<p>The number of sample points in the design space.</p>
</td></tr>
<tr><td><code id="Aopt_+3A_u">u</code></td>
<td>
<p>The discretized design space.</p>
</td></tr>
<tr><td><code id="Aopt_+3A_tt">tt</code></td>
<td>
<p>The level of skewness between 0 to 1 (inclusive). When tt=0, it is equivalent to compute the A-optimal design under the ordinary least squares estimator.</p>
</td></tr>
<tr><td><code id="Aopt_+3A_fun">FUN</code></td>
<td>
<p>The function to calculate the derivative of the given model.</p>
</td></tr>
<tr><td><code id="Aopt_+3A_theta">theta</code></td>
<td>
<p>The parameter value of the model.</p>
</td></tr>
<tr><td><code id="Aopt_+3A_num_iter">num_iter</code></td>
<td>
<p>Maximum number of iteration.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function calculates the A-optimal design and the loss function under the A-optimality. The loss function under A-optimality is defined as the trace of the inverse of the Fisher information matrix
</p>


<h3>Value</h3>

<p>A list that contains 1. Value of the objective function at solution. 2. Status. 3. Optimal design
</p>


<h3>Examples</h3>

<pre><code class='language-R'>poly3 &lt;- function(xi, theta){
  matrix(c(1, xi, xi^2, xi^3), ncol = 1)
}
Npt &lt;- 101
my_design &lt;- Aopt(N = Npt, u = seq(-1, +1, length.out = Npt),
   tt = 0, FUN = poly3, theta = rep(0,4), num_iter = 2000)
round(my_design$design, 3)
my_design$val
</code></pre>

<hr>
<h2 id='calc_phiA'>Calculate the loss function of the A-optimal design</h2><span id='topic+calc_phiA'></span>

<h3>Description</h3>

<p>Calculate the loss function of the A-optimal design
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_phiA(design, theta, FUN, tt, A)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calc_phiA_+3A_design">design</code></td>
<td>
<p>The resulted design that contains the design points and the associated weights</p>
</td></tr>
<tr><td><code id="calc_phiA_+3A_theta">theta</code></td>
<td>
<p>The parameter value of the model</p>
</td></tr>
<tr><td><code id="calc_phiA_+3A_fun">FUN</code></td>
<td>
<p>The function to calculate the derivative of the given model.</p>
</td></tr>
<tr><td><code id="calc_phiA_+3A_tt">tt</code></td>
<td>
<p>The level of skewness</p>
</td></tr>
<tr><td><code id="calc_phiA_+3A_a">A</code></td>
<td>
<p>The calculated covariance matrix</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function calculates the loss function of the design problem under the A-optimality. The loss function under A-optimality is defined as the trace of the inverse of the Fisher information matrix
</p>


<h3>Value</h3>

<p>The loss of the model at each design points
</p>


<h3>Examples</h3>

<pre><code class='language-R'>my_design &lt;- data.frame(location = c(0, 180), weight = c(1/2, 1/2))
theta &lt;- c(0.05, 0.5)
peleg &lt;- function(xi, theta){
   deno &lt;- (theta[1] + xi * theta[2])^2
   rbind(-xi/deno, -xi^2/deno)
}
A &lt;- matrix(c(1, 0, 0, 0, 0.2116, 1.3116, 0, 1.3116, 15.462521), byrow = TRUE, ncol = 3)
res &lt;- calc_phiA(my_design, theta, peleg, 0, A)
res

</code></pre>

<hr>
<h2 id='calc_phiD'>Calculate the loss function of the D-optimal design</h2><span id='topic+calc_phiD'></span>

<h3>Description</h3>

<p>Calculate the loss function of the D-optimal design
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_phiD(design, theta, FUN, tt, A)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calc_phiD_+3A_design">design</code></td>
<td>
<p>The resulted design that contains the design points and the associated weights</p>
</td></tr>
<tr><td><code id="calc_phiD_+3A_theta">theta</code></td>
<td>
<p>The parameter value of the model</p>
</td></tr>
<tr><td><code id="calc_phiD_+3A_fun">FUN</code></td>
<td>
<p>The function to calculate the derivative of the given model.</p>
</td></tr>
<tr><td><code id="calc_phiD_+3A_tt">tt</code></td>
<td>
<p>The level of skewness</p>
</td></tr>
<tr><td><code id="calc_phiD_+3A_a">A</code></td>
<td>
<p>The calculated covariance matrix</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function calculates the loss function of the design problem under the D-optimality. The loss function under D-optimality is defined as the log determinant of the inverse of the Fisher information matrix
</p>


<h3>Value</h3>

<p>The loss of the model at each design points
</p>


<h3>Examples</h3>

<pre><code class='language-R'>my_design &lt;- data.frame(location = c(0, 180), weight = c(1/2, 1/2))
theta &lt;- c(0.05, 0.5)
peleg &lt;- function(xi, theta){
   deno &lt;- (theta[1] + xi * theta[2])^2
   rbind(-xi/deno, -xi^2/deno)
}
A &lt;- matrix(c(1, 0, 0, 0, 0.2116, 1.3116, 0, 1.3116, 15.462521), byrow = TRUE, ncol = 3)
res &lt;- calc_phiA(my_design, theta, peleg, 0, A)
res
</code></pre>

<hr>
<h2 id='Dopt'>Calculate the D-optimal design under the SLSE</h2><span id='topic+Dopt'></span>

<h3>Description</h3>

<p>Calculate the D-optimal design under the SLSE
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Dopt(N, u, tt, FUN, theta, num_iter = 1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Dopt_+3A_n">N</code></td>
<td>
<p>The number of sample points in the design space.</p>
</td></tr>
<tr><td><code id="Dopt_+3A_u">u</code></td>
<td>
<p>The discretized design space.</p>
</td></tr>
<tr><td><code id="Dopt_+3A_tt">tt</code></td>
<td>
<p>The level of skewness. When tt=0, it is equivalent to compute the D-optimal design under the ordinary least squares estimator.</p>
</td></tr>
<tr><td><code id="Dopt_+3A_fun">FUN</code></td>
<td>
<p>The function to calculate the derivative of the given model.</p>
</td></tr>
<tr><td><code id="Dopt_+3A_theta">theta</code></td>
<td>
<p>The parameter value of the model.</p>
</td></tr>
<tr><td><code id="Dopt_+3A_num_iter">num_iter</code></td>
<td>
<p>Maximum number of iteration.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function calculates the D-optimal design and the loss function under the D-optimality. The loss function under D-optimality is defined as the log determinant of the inverse of the Fisher information matrix.
</p>


<h3>Value</h3>

<p>A list that contains 1. Value of the objective function at solution. 2. Status. 3. Optimal design
</p>


<h3>Examples</h3>

<pre><code class='language-R'>poly3 &lt;- function(xi, theta){
  matrix(c(1, xi, xi^2, xi^3), ncol = 1)
}
Npt &lt;- 101
my_design &lt;- Dopt(N = Npt, u = seq(-1, +1, length.out = Npt),
   tt = 0, FUN = poly3, theta = rep(0,4), num_iter = 2000)
round(my_design$design, 3)
my_design$val

</code></pre>

<hr>
<h2 id='plot_direction_Aopt'>Verify the optimality condition for the A-optimal design</h2><span id='topic+plot_direction_Aopt'></span>

<h3>Description</h3>

<p>Verify the optimality condition for the A-optimal design
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_direction_Aopt(u, design, tt, FUN, theta)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_direction_Aopt_+3A_u">u</code></td>
<td>
<p>The discretized design points.</p>
</td></tr>
<tr><td><code id="plot_direction_Aopt_+3A_design">design</code></td>
<td>
<p>The A-optimal design that contains the design points and the associated weights</p>
</td></tr>
<tr><td><code id="plot_direction_Aopt_+3A_tt">tt</code></td>
<td>
<p>The level of skewness.</p>
</td></tr>
<tr><td><code id="plot_direction_Aopt_+3A_fun">FUN</code></td>
<td>
<p>The function to calculate the derivative of the given model.</p>
</td></tr>
<tr><td><code id="plot_direction_Aopt_+3A_theta">theta</code></td>
<td>
<p>The parameter value of the model.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function produces the figure for the directional derivative of the given A-optimal design of the compact supports. According to the general equivalence theorem, for an optimal design, all the negative value of the directional derivative should be below zero line.
</p>


<h3>Value</h3>

<p>The plot of the negative value of the directional derivative of an A-optimal design
</p>


<h3>Examples</h3>

<pre><code class='language-R'>poly3 &lt;- function(xi, theta){
  matrix(c(1, xi, xi^2, xi^3), ncol = 1)
}
design = data.frame(location = c(-1, -0.464, 0.464, 1),
                      weight = c(0.151, 0.349, 0.349, 0.151))
u = seq(-1, 1, length.out = 201)
plot_direction_Aopt(u=u, design=design, tt=0, FUN = poly3, theta = rep(0,4))

</code></pre>

<hr>
<h2 id='plot_direction_Dopt'>Verify the optimality condition for the D-optimal design</h2><span id='topic+plot_direction_Dopt'></span>

<h3>Description</h3>

<p>Verify the optimality condition for the D-optimal design
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_direction_Dopt(u, design, tt, FUN, theta)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_direction_Dopt_+3A_u">u</code></td>
<td>
<p>The discretized design points.</p>
</td></tr>
<tr><td><code id="plot_direction_Dopt_+3A_design">design</code></td>
<td>
<p>The D-optimal design that contains the design points and the associated weights.</p>
</td></tr>
<tr><td><code id="plot_direction_Dopt_+3A_tt">tt</code></td>
<td>
<p>The level of skewness.</p>
</td></tr>
<tr><td><code id="plot_direction_Dopt_+3A_fun">FUN</code></td>
<td>
<p>The function to calculate the derivative of the given model.</p>
</td></tr>
<tr><td><code id="plot_direction_Dopt_+3A_theta">theta</code></td>
<td>
<p>The parameter value of the model.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function produces the figure for the negative value of the directional derivative of the given D-optimal design of the compact supports. According to the general equivalence theorem, for an optimal design, all the directional derivative should be below zero line.
</p>


<h3>Value</h3>

<p>The plot of the negative value of the directional derivative of a D-optimal design
</p>


<h3>Examples</h3>

<pre><code class='language-R'>poly3 &lt;- function(xi, theta){
    matrix(c(1, xi, xi^2, xi^3), ncol = 1)
}
design = data.frame(location = c(-1, -0.447, 0.447, 1),
 weight = rep(0.25, 4))
u = seq(-1, 1, length.out = 201)
plot_direction_Dopt(u, design, tt=0, FUN = poly3,
  theta = rep(0, 4))


</code></pre>

<hr>
<h2 id='plot_weight'>Plot the weight distribution of the optimal design for univaraite regression model</h2><span id='topic+plot_weight'></span>

<h3>Description</h3>

<p>Plot the weight distribution of the optimal design for univaraite regression model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_weight(design)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_weight_+3A_design">design</code></td>
<td>
<p>The resulted design that contains the design points and the associated weights</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This functions produce a figure that contains the location and their associated weights of the resulted optimal design measures.
</p>


<h3>Value</h3>

<p>The plot that shows the given optimal design
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Des = list(location = c(-1, +1), weight = c(0.5, 0.5))
plot_weight(Des)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
