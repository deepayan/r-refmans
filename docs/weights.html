<!DOCTYPE html><html><head><title>Help for package weights</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {weights}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#anes04'>
<p>Demographic Data From 2004 American National Election Studies (ANES)</p></a></li>
<li><a href='#dummify'>
<p>Separate a factor into separate dummy variables for each level.</p></a></li>
<li><a href='#nalevs'>
<p>Recode variables to 0-1 scale</p></a></li>
<li><a href='#plotwtdinteraction'>
<p>Functions to Identify and Plot Predicted Probabilities As Well As Two- and Three-Way Interactions From Regressions With or Without Weights and Standard Errors</p></a></li>
<li><a href='#rd'>
<p>Round Numbers To Text With No Leading Zero</p></a></li>
<li><a href='#starmaker'>
<p>Produce stars from p values for tables.</p></a></li>
<li><a href='#stdz'>
<p>Standardizes any numerical vector, with weights.</p></a></li>
<li><a href='#wpct'>
<p>Provides a weighted table of percentages for any variable.</p></a></li>
<li><a href='#wtd.chi.sq'>
<p>Produces weighted chi-squared tests.</p></a></li>
<li><a href='#wtd.cor'>
<p>Produces weighted correlations with standard errors and significance.  For a faster version without standard errors and p values, use the <code>wtd.cors</code> function.</p></a></li>
<li><a href='#wtd.cors'>
<p>Produces weighted correlations quickly using C.</p></a></li>
<li><a href='#wtd.hist'>
<p>Weighted Histograms</p></a></li>
<li><a href='#wtd.t.test'>
<p>Produces weighted Student's t-tests with standard errors and significance.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Weighting and Weighted Statistics</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.4</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-06-10</td>
</tr>
<tr>
<td>Author:</td>
<td>Josh Pasek [aut, cre], with some assistance from Alex Tahk and some code modified from R-core; Additional contributions by Gene Culter and Marcus Schwemmle.</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Josh Pasek &lt;josh@joshpasek.com&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>Hmisc</td>
</tr>
<tr>
<td>Imports:</td>
<td>mice, gdata, lme4</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides a variety of functions for producing simple weighted statistics, such as weighted Pearson's correlations, partial correlations, Chi-Squared statistics, histograms, and t-tests.  Also now includes some software for quickly recoding survey data and plotting estimates from interaction terms in regressions (and multiply imputed regressions) both with and without weights. NOTE: Weighted partial correlation calculations pulled to address a bug.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-06-10 18:27:46 UTC; jpasek</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-06-10 21:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='anes04'>
Demographic Data From 2004 American National Election Studies (ANES)
</h2><span id='topic+anes04'></span>

<h3>Description</h3>

<p>A dataset containing demographic data from the 2004 American National Election Studies.  The data include 5 variables: &quot;female&quot; (A Logical Variable Indicating Sex), &quot;age&quot; (Numerically Coded, Ranging From 18 to a Topcode of 90), &quot;educats&quot; (5 Education Categories corresponding to 1-Less than A High School Degree, 2-High School Gradutate, 3-Some College, 4-College Graduate, 5-Post College Education), &quot;racecats&quot; (6 Racial Categories), and &quot;married&quot; (A Logical Variable Indicating the Respondent's Marital Status, with one point of missing data).  Dataset is designed show how production of survey weights works in practice.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(anes04)</code></pre>


<h3>Format</h3>

<p>The format is:
chr &quot;anes04&quot;
</p>


<h3>Source</h3>

<p>http://www.electionstudies.org
</p>

<hr>
<h2 id='dummify'>
Separate a factor into separate dummy variables for each level.
</h2><span id='topic+dummify'></span>

<h3>Description</h3>

<p><code>dummify</code> creates a matrix with columns signifying separate dummy variables for each level of a factor.  The column names are the former levels of the factor.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dummify(x, show.na=FALSE, keep.na=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dummify_+3A_x">x</code></td>
<td>

<p><code>x</code> is a factor the researcher desires to split into separate dummy variables.
</p>
</td></tr>
<tr><td><code id="dummify_+3A_show.na">show.na</code></td>
<td>

<p>If <code>show.na</code> is 'TRUE', output will include a column idicating the cases that are missing.
</p>
</td></tr>
<tr><td><code id="dummify_+3A_keep.na">keep.na</code></td>
<td>

<p>If <code>keep.na</code> is 'TRUE', output vectors will have &quot;NA&quot;s for cases that were originally missing.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>dummify</code> returns a matrix with a number of rows equal to the length of <code>x</code> and a number of columns equal to the number of levels of <code>x</code>.
</p>


<h3>Author(s)</h3>

<p>Josh Pasek, Assistant Professor of Communication Studies at the University of Michigan (www.joshpasek.com).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("anes04")

anes04$agecats &lt;- cut(anes04$age, c(17, 25,35,45,55,65, 99))
levels(anes04$agecats) &lt;- c("age1824", "age2534", "age3544",
          "age4554", "age5564", "age6599")

agedums &lt;- dummify(anes04$agecats)
table(anes04$agecats)
summary(agedums)
</code></pre>

<hr>
<h2 id='nalevs'>
Recode variables to 0-1 scale
</h2><span id='topic+nalevs'></span>

<h3>Description</h3>

<p><code>nalevs</code> takes as an input any vector and recodes it to range from 0 to 1, to treat specified levels as missing, to treat specified levels as 0, 1, .5, or the mean (weighted or unweighted) of the levels present after coding.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nalevs(x, naset=NULL, setmid=NULL, set1=NULL, set0=NULL,
setmean=NULL, weight=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nalevs_+3A_x">x</code></td>
<td>
<p>A vector to be recoded to range from 0 to 1.</p>
</td></tr>
<tr><td><code id="nalevs_+3A_naset">naset</code></td>
<td>
<p>A vector of values of <code>x</code> to be coded as <code>NA</code>.</p>
</td></tr>
<tr><td><code id="nalevs_+3A_setmid">setmid</code></td>
<td>
<p>A vector of values of <code>x</code> to be recoded to .5.</p>
</td></tr>
<tr><td><code id="nalevs_+3A_set1">set1</code></td>
<td>
<p>A vector of values of <code>x</code> to be recoded to 1.</p>
</td></tr>
<tr><td><code id="nalevs_+3A_set0">set0</code></td>
<td>
<p>A vector of values of <code>x</code> to be recoded to 0.</p>
</td></tr>
<tr><td><code id="nalevs_+3A_setmean">setmean</code></td>
<td>
<p>A vector of values of <code>x</code> to be recoded to the mean (if no weight is specified) or weighted mean (if a weight is specified) of values of <code>x</code> after all recoding.</p>
</td></tr>
<tr><td><code id="nalevs_+3A_weight">weight</code></td>
<td>
<p>A vector of weights for <code>x</code> if weighted means are desired for values listed for <code>setmean</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of length equal to that of <code>x</code> of class <code>numeric</code>.
</p>


<h3>Author(s)</h3>

<p>Josh Pasek, Assistant Professor of Communication Studies at the University of Michigan (www.joshpasek.com).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(anes04)
summary(anes04$age)
summary(nalevs(anes04$age))
table(anes04$educcats)
table(nalevs(anes04$educcats, naset=c(2, 4)))
</code></pre>

<hr>
<h2 id='plotwtdinteraction'>
Functions to Identify and Plot Predicted Probabilities As Well As Two- and Three-Way Interactions From Regressions With or Without Weights and Standard Errors
</h2><span id='topic+plotwtdinteraction'></span><span id='topic+findwtdinteraction'></span><span id='topic+findwtdinteraction.default'></span><span id='topic+findwtdinteraction.mira'></span><span id='topic+findwtdinteraction.list'></span><span id='topic+findwtdinteraction.multinom'></span><span id='topic+findwtdinteraction.lmerMod'></span><span id='topic+plotinteractpreds'></span><span id='topic+plotinteractpreds.default'></span><span id='topic+plotinteractpreds.interactpreds'></span><span id='topic+plotinteractpreds.interactpredsmnl'></span>

<h3>Description</h3>

<p><code>plotwtdinteraction</code> produces a plot from a regression object to
illustrate a two- or three-way interaction for a prototypical individual
holding constant all other variables (or other counterfactuals,
depending on type). Prototypical individual is identified as the mean (numeric), median (ordinal), and/or modal (factors and logical variables) values for all measures. Standard errors are illustrated with polygons by default.
</p>
<p><code>findwtdinteraction</code> generates a table of point estimates from a regression object to illustrate a two- or three-way interaction for a prototypical individual holding constant all other variables. Prototypical individual is identified as the mean (numeric), median (ordinal), and/or modal (factors and logical variables) values for all measures. Standard errors are illustrated with polygons by default.
</p>
<p><code>plotinteractpreds</code> plots an object from <code>findwtdinteraction</code>.
</p>
<p>These functions are known to be compatible with <code><a href="stats.html#topic+lm">lm</a></code>,
<code><a href="stats.html#topic+glm">glm</a></code>, as well as multiply imputed <code><a href="stats.html#topic+lm">lm</a></code> and
<code><a href="stats.html#topic+glm">glm</a></code> data generated with the <code><a href="HH.html#topic+mice">mice</a></code>
package. They are also compatible with <code><a href="mgcv.html#topic+gam">gam</a></code> and
<code><a href="mgcv.html#topic+bam">bam</a></code> regressions from the mgcv package under default.
</p>
<p>ordinal regressions (polr) and multinomial regressions (multinom) do not
currently support standard errors, additional methods are still being added.
</p>
<p>*Note, this set of functions is still in beta, please let me know if you run into any bugs when using it.*
</p>
<p>**Important: If you are using a regression output from a multiply imputed dataset with a continuous variable as an interacting term, you should always specify the levels (acrosslevs, bylevs, or atlevs) for the variable, as imputations can change the set of levels that are available and thus can make the point estimates across imputed datasets incompatible with one-another.**
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotwtdinteraction(x, across, by=NULL, at=NULL, acrosslevs=NULL, bylevs=NULL,
atlevs=NULL, weight=NULL, dvname=NULL, acclevnames=NULL, bylevnames=NULL,
atlevnames=NULL, stdzacross=FALSE, stdzby=FALSE, stdzat=FALSE, limitlevs=20,
type="response", seplot=TRUE, ylim=NULL, main=NULL, xlab=NULL, ylab=NULL,
legend=TRUE, placement="bottomright", lwd=3, add=FALSE, addby = TRUE, addat=FALSE,
mfrow=NULL, linecol=NULL, secol=NULL, showbynamelegend=FALSE,
showatnamelegend=FALSE, showoutnamelegend = FALSE, 
lty=NULL, density=30, startangle=45, approach="prototypical", data=NULL,
nsim=100, ...)

findwtdinteraction(x, across, by=NULL, at=NULL, acrosslevs=NULL, bylevs=NULL,
atlevs=NULL, weight=NULL, dvname=NULL, acclevnames=NULL, bylevnames=NULL,
atlevnames=NULL, stdzacross=FALSE, stdzby=FALSE, stdzat=FALSE, limitlevs=20,
type="response", approach="prototypical", data=NULL, nsim=100)

plotinteractpreds(out, seplot=TRUE, ylim=NULL, main=NULL, xlab=NULL, ylab=NULL,
legend=TRUE, placement="bottomright", lwd=3, add=FALSE, addby = TRUE,
addat=FALSE, mfrow=NULL, linecol=NULL, secol=NULL, showbynamelegend=FALSE,
showatnamelegend=FALSE, showoutnamelegend = FALSE, lty=NULL,
density=30, startangle=45, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotwtdinteraction_+3A_x">x</code></td>
<td>

<p><code>x</code> is a regression object in lm, glm, or mira (multiply imputed) format that includes the variables to be plotted.
</p>
</td></tr>
<tr><td><code id="plotwtdinteraction_+3A_out">out</code></td>
<td>

<p><code>out</code> is an object estimate using findwtdinteraction that should be plotted.
</p>
</td></tr>
<tr><td><code id="plotwtdinteraction_+3A_across">across</code></td>
<td>

<p><code>across</code> specifies the name of the variable, in quotation marks, that was used in the regression that should be plotted on the X axis.
</p>
</td></tr>
<tr><td><code id="plotwtdinteraction_+3A_by">by</code></td>
<td>

<p><code>by</code> specifies the name of the variable, in quotation marks, that was used in the regression that should form each of the separate lines in the regression.
</p>
</td></tr>
<tr><td><code id="plotwtdinteraction_+3A_at">at</code></td>
<td>

<p><code>at</code> (optional) specifies the name of the variable, in quotation marks, that represents the third-way of a 3-way interaction.  Depending on specifications, this can either be plotted as additional lines or as separate graphs.
</p>
</td></tr>
<tr><td><code id="plotwtdinteraction_+3A_acrosslevs">acrosslevs</code></td>
<td>

<p><code>acrosslevs</code> (optional) specifies the unique levels of the variable <code>across</code> that should be estimated across the x axis.  If this is not specified, each unique level of the <code>across</code> variable will be used.
</p>
</td></tr>
<tr><td><code id="plotwtdinteraction_+3A_bylevs">bylevs</code></td>
<td>

<p><code>bylevs</code> (optional) specifies the unique levels of the variable <code>by</code> that should yield separate lines.  If this is not specified, each unique level of the <code>by</code> variable will be used.
</p>
</td></tr>
<tr><td><code id="plotwtdinteraction_+3A_atlevs">atlevs</code></td>
<td>

<p><code>atlevs</code> (optional) specifies the unique levels of the variable <code>at</code> that should yield separate figures or lines. If this is not specified, each unique level of the <code>at</code> variable will be used.
</p>
</td></tr>
<tr><td><code id="plotwtdinteraction_+3A_weight">weight</code></td>
<td>

<p><code>weight</code> (optional) allows the user to introduce a separate weight that was not used in the original regression.  If the regression was run using weights, those weights will always be used to generate estimates of the prototypical individual to be used.
</p>
</td></tr>
<tr><td><code id="plotwtdinteraction_+3A_dvname">dvname</code></td>
<td>

<p><code>dvname</code> (optional) allows the user to relabel the dependent variable for printouts.
</p>
</td></tr>
<tr><td><code id="plotwtdinteraction_+3A_acclevnames">acclevnames</code></td>
<td>

<p><code>dvname</code> (optional) allows the user to specify the names for the specified levels of the <code>accross</code> variable.
</p>
</td></tr>
<tr><td><code id="plotwtdinteraction_+3A_bylevnames">bylevnames</code></td>
<td>

<p><code>dvname</code> (optional) allows the user to specify the names for the specified levels of the <code>by</code> variable.
</p>
</td></tr>
<tr><td><code id="plotwtdinteraction_+3A_atlevnames">atlevnames</code></td>
<td>

<p><code>dvname</code> (optional) allows the user to specify the names for the specified levels of the <code>at</code> variable.
</p>
</td></tr>
<tr><td><code id="plotwtdinteraction_+3A_stdzacross">stdzacross</code></td>
<td>

<p><code>dvname</code> (optional) shows levels of <code>across</code> variable in (weighted) standard deviation units. This defaults to showing 1SD below mean and 1SD above mean; specifying <code>acrosslevs</code> to other values will provide results in SD units instead of variable units.
</p>
</td></tr>
<tr><td><code id="plotwtdinteraction_+3A_stdzby">stdzby</code></td>
<td>

<p><code>dvname</code> (optional) shows levels of <code>by</code> variable in (weighted) standard deviation units. This defaults to showing 1SD below mean and 1SD above mean; specifying <code>bylevs</code> to other values will provide results in SD units instead of variable units. 
</p>
</td></tr>
<tr><td><code id="plotwtdinteraction_+3A_stdzat">stdzat</code></td>
<td>

<p><code>dvname</code> (optional) shows levels of <code>at</code> variable in (weighted) standard deviation units. This defaults to showing 1SD below mean and 1SD above mean; specifying <code>atlevs</code> to other values will provide results in SD units instead of variable units. 
</p>
</td></tr>
<tr><td><code id="plotwtdinteraction_+3A_limitlevs">limitlevs</code></td>
<td>

<p><code>limitlevs</code> sets the number of different levels that any given interacting variable can have. This is meant to prevent inadvertent generation and plotting of tons of point estimates for continuous variables. The default is set to 20.
</p>
</td></tr>
<tr><td><code id="plotwtdinteraction_+3A_type">type</code></td>
<td>

<p><code>type</code> sets the type of prediction to be used for generation of the estimates. This defaults to <code>"response"</code> but can be used with any type of model prediction for which only one numeric estimate is given. (Not currently compatible with estimates derived from polr regression).
</p>
</td></tr>
<tr><td><code id="plotwtdinteraction_+3A_seplot">seplot</code></td>
<td>

<p><code>seplot</code> (optional) if set to <code>TRUE</code>, plots will include polygons illustrating standard errors.
</p>
</td></tr>
<tr><td><code id="plotwtdinteraction_+3A_ylim">ylim</code></td>
<td>

<p><code>ylim</code> (optional) passes on y-axis limits to <code><a href="graphics.html#topic+plot">plot</a></code> function.
</p>
</td></tr>
<tr><td><code id="plotwtdinteraction_+3A_main">main</code></td>
<td>

<p><code>main</code> (optional) passes on title to <code><a href="graphics.html#topic+plot">plot</a></code> function.
</p>
</td></tr>
<tr><td><code id="plotwtdinteraction_+3A_xlab">xlab</code></td>
<td>

<p><code>xlab</code> (optional) passes on x-axis labels to <code><a href="graphics.html#topic+plot">plot</a></code> function.
</p>
</td></tr>
<tr><td><code id="plotwtdinteraction_+3A_ylab">ylab</code></td>
<td>

<p><code>ylab</code> (optional) passes on y-axis labels to <code><a href="graphics.html#topic+plot">plot</a></code> function.
</p>
</td></tr>
<tr><td><code id="plotwtdinteraction_+3A_legend">legend</code></td>
<td>

<p><code>legend</code> (optional) if <code>TRUE</code> will produce a legend on the interaction figure.
</p>
</td></tr>
<tr><td><code id="plotwtdinteraction_+3A_placement">placement</code></td>
<td>

<p><code>placement</code> (optional) passes to <code><a href="graphics.html#topic+legend">legend</a></code> function a location for the legend. Can be set to &quot;bottomright&quot;, &quot;bottomleft&quot;, &quot;topright&quot;, and &quot;topleft&quot;.
</p>
</td></tr>
<tr><td><code id="plotwtdinteraction_+3A_lwd">lwd</code></td>
<td>

<p><code>lwd</code> (optional) specifies the line strength for plots, this passes on to the <code><a href="graphics.html#topic+plot">plot</a></code> command.
</p>
</td></tr>
<tr><td><code id="plotwtdinteraction_+3A_add">add</code></td>
<td>

<p><code>add</code> (optional) logical statement to add the results to an existing plot (<code>at=TRUE</code>) rather than generating a new one (<code>at=FALSE</code> is the default).
</p>
</td></tr>
<tr><td><code id="plotwtdinteraction_+3A_addby">addby</code></td>
<td>

<p><code>addby</code> (optional) logical statement specifying whether the levels of <code>by</code> should be different plots (<code>addby=TRUE</code>) or if each level of <code>by</code> should generate a new plot (<code>addby=TRUE</code> is the default). This only influences some types of plots.
</p>
</td></tr>
<tr><td><code id="plotwtdinteraction_+3A_addat">addat</code></td>
<td>

<p><code>addat</code> (optional) logical statement specifying whether the levels of <code>at</code> should be different plots (<code>addat=TRUE</code>) or if each level of <code>at</code> should generate a new plot (<code>addat=FALSE</code> is the default)
</p>
</td></tr>
<tr><td><code id="plotwtdinteraction_+3A_mfrow">mfrow</code></td>
<td>

<p><code>mfrow</code> (optional) temporarily changes the number of plots per page in <code><a href="graphics.html#topic+par">par</a></code> for the purpose of generating current plots. This should generally only be used for 3-way interactions.  It takes commands of the form <code>c(2,3)</code>, specifying the number of rows and columns in the graphics interface. The algorithm defaults to putting all 3-way interactions on a single page with a width of 2. 
</p>
</td></tr>
<tr><td><code id="plotwtdinteraction_+3A_linecol">linecol</code></td>
<td>

<p><code>linecol</code> (optional) Specifies the colors of lines in the figure(s). For two-way interactions, this should be a vector of the same length as <code>bylevs</code>.  For 3-way interactions, the colors demarcate the levels of <code>at</code> instead and should be the same length as <code>atlevs</code>.
</p>
</td></tr>
<tr><td><code id="plotwtdinteraction_+3A_secol">secol</code></td>
<td>

<p><code>secol</code> (optional) Specifies the colors of standard error in the figure(s). For two-way interactions, this should be a vector of the same length as <code>bylevs</code>.  For 3-way interactions, the colors demarcate the levels of <code>at</code> instead and should be the same length as <code>atlevs</code>.
</p>
</td></tr>
<tr><td><code id="plotwtdinteraction_+3A_showbynamelegend">showbynamelegend</code></td>
<td>

<p><code>showbynamelegend</code> (optional) adds name of <code>by</code> variable to names of value levels in legend.
</p>
</td></tr>
<tr><td><code id="plotwtdinteraction_+3A_showatnamelegend">showatnamelegend</code></td>
<td>

<p><code>showatnamelegend</code> (optional) adds name of <code>at</code> variable to names of value levels in legend.
</p>
</td></tr>
<tr><td><code id="plotwtdinteraction_+3A_showoutnamelegend">showoutnamelegend</code></td>
<td>

<p><code>showoutnamelegend</code> (optional) adds name of DV to legend in multinomial logit plots only.
</p>
</td></tr>
<tr><td><code id="plotwtdinteraction_+3A_lty">lty</code></td>
<td>

<p><code>lty</code> (optional) line type to pass on to plot.
</p>
</td></tr>
<tr><td><code id="plotwtdinteraction_+3A_density">density</code></td>
<td>

<p><code>density</code> (optional) line density for standard error plots.
</p>
</td></tr>
<tr><td><code id="plotwtdinteraction_+3A_startangle">startangle</code></td>
<td>

<p><code>startangle</code> (optional) line angle for standard error plots.
</p>
</td></tr>
<tr><td><code id="plotwtdinteraction_+3A_approach">approach</code></td>
<td>

<p><code>approach</code> determines whether you want to estimate counterfactuals for a prototypical individual <code>approach="prototypical"</code> (the default), for the entire population <code>approach="population"</code>, or for individuals in the subgroups specified in the <code>by</code> and <code>at</code> categories <code>approach="at"</code>,  <code>approach="by"</code>,  <code>approach="atby"</code>.
</p>
</td></tr>
<tr><td><code id="plotwtdinteraction_+3A_data">data</code></td>
<td>

<p><code>data</code> (optional) allows you to replace the dataset used in the regression to produce other prototypical values.
</p>
</td></tr>
<tr><td><code id="plotwtdinteraction_+3A_nsim">nsim</code></td>
<td>

<p><code>nsim</code> (optional) set the number of bootstrapped simulations to use
to generate standard errors for lmer-style regressions. Note that this SIGNIFICANLY increases the time to run, so test with smaller numbers before running.
</p>
</td></tr>
<tr><td><code id="plotwtdinteraction_+3A_...">...</code></td>
<td>

<p><code>...</code> (optional) Additional arguments to be passed on to plot command (or future methods of <code>findwtdinteraction</code>).
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A table or figure illustrating the predicted values of the dependent variable across levels of the independent variables for a prototypical respondent.
</p>


<h3>Author(s)</h3>

<p>Josh Pasek, Assistant Professor of Communication Studies at the University of Michigan (www.joshpasek.com).
</p>

<hr>
<h2 id='rd'>
Round Numbers To Text With No Leading Zero
</h2><span id='topic+rd'></span>

<h3>Description</h3>

<p>Rounds numbers to text and drops leading zeros in the process.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rd(x, digits=2, add=TRUE, max=(digits+3))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rd_+3A_x">x</code></td>
<td>
<p>A vector of values to be rounded (must be numeric).</p>
</td></tr>
<tr><td><code id="rd_+3A_digits">digits</code></td>
<td>
<p>The number of digits to round to (must be an integer).</p>
</td></tr>
<tr><td><code id="rd_+3A_add">add</code></td>
<td>
<p>An optional dichotomous indicator for whether additional digits should be added if no numbers appear in pre-set digit level.</p>
</td></tr>
<tr><td><code id="rd_+3A_max">max</code></td>
<td>
<p>Maximum number of digits to be shown if <code>add=TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of length equal to that of <code>x</code> of class <code>character</code>.
</p>


<h3>Author(s)</h3>

<p>Josh Pasek, Assistant Professor of Communication Studies at the University of Michigan (www.joshpasek.com).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>rd(seq(0, 1, by=.1))
</code></pre>

<hr>
<h2 id='starmaker'>
Produce stars from p values for tables.
</h2><span id='topic+starmaker'></span>

<h3>Description</h3>

<p>Recodes p values to stars for use in tables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>starmaker(x, p.levels=c(.001, .01, .05, .1), symbols=c("***", "**", "*", "+"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="starmaker_+3A_x">x</code></td>
<td>
<p>A vector of p values to be turned into stars (must be numeric).</p>
</td></tr>
<tr><td><code id="starmaker_+3A_p.levels">p.levels</code></td>
<td>
<p>A vector of the maximum p value for each symbol used (p&lt;p.level).</p>
</td></tr>
<tr><td><code id="starmaker_+3A_symbols">symbols</code></td>
<td>
<p>A vector of the symbols to be displayed for each p value.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of length equal to that of <code>x</code> of class <code>character</code>.
</p>


<h3>Author(s)</h3>

<p>Josh Pasek, Assistant Professor of Communication Studies at the University of Michigan (www.joshpasek.com).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>starmaker(seq(0, .15, by=.01))
cbind(p=seq(0, .15, by=.01), star=starmaker(seq(0, .15, by=.01)))
</code></pre>

<hr>
<h2 id='stdz'>
Standardizes any numerical vector, with weights.
</h2><span id='topic+stdz'></span>

<h3>Description</h3>

<p><code>stdz</code> produces a standardized copy of any input variable.  It can also standardize a weighted variable to produce a copy of the original variable standardized around its weighted mean and variance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stdz(x, weight=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stdz_+3A_x">x</code></td>
<td>

<p><code>x</code> should be a numerical vector which the researcher wishes to standardize.
</p>
</td></tr>
<tr><td><code id="stdz_+3A_weight">weight</code></td>
<td>

<p><code>weight</code> is an optional vector of weights to be used to determining the weighted mean and variance for standardization.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of length equal to x with a (weighted) mean of zero and a (weighted) standard deviation of 1.
</p>


<h3>Author(s)</h3>

<p>Josh Pasek, Assistant Professor of Communication Studies at the University of Michigan (www.joshpasek.com).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+wtd.cor">wtd.cor</a></code>
<code><a href="#topic+wtd.chi.sq">wtd.chi.sq</a></code>
<code><a href="#topic+wtd.t.test">wtd.t.test</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>test &lt;- c(1,1,1,1,1,1,2,2,2,3,3,3,4,4)
weight &lt;- c(.5,.5,.5,.5,.5,1,1,1,1,2,2,2,2,2)

summary(stdz(test))
summary(stdz(test, weight))
wtd.mean(stdz(test, weight), weight)
wtd.var(stdz(test, weight), weight)
</code></pre>

<hr>
<h2 id='wpct'>
Provides a weighted table of percentages for any variable.
</h2><span id='topic+wpct'></span>

<h3>Description</h3>

<p><code>wpct</code> produces a weighted table of the proportion of data in each category for any variable.  This is simply a weighted frequency table divided by its sum.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wpct(x, weight=NULL, na.rm=TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wpct_+3A_x">x</code></td>
<td>

<p><code>x</code> should be a vector for which a set of proportions is desired.
</p>
</td></tr>
<tr><td><code id="wpct_+3A_weight">weight</code></td>
<td>

<p><code>weight</code> is a vector of weights to be used to determining the weighted proportion in each category of <code>x</code>.
</p>
</td></tr>
<tr><td><code id="wpct_+3A_na.rm">na.rm</code></td>
<td>

<p>If <code>na.rm</code> is true, missing data will be dropped.  If <code>na.rm</code> is false, missing data will return an error.
</p>
</td></tr>
<tr><td><code id="wpct_+3A_...">...</code></td>
<td>

<p><code>...</code> (optional) Additional arguments to be passed on to <code><a href="Hmisc.html#topic+wtd.table">wtd.table</a></code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A table object of length equal to the number of separate values of <code>x</code>.
</p>


<h3>Author(s)</h3>

<p>Josh Pasek, Assistant Professor of Communication Studies at the University of Michigan (www.joshpasek.com).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>test &lt;- c(1,1,1,1,1,1,2,2,2,3,3,3,4,4)
weight &lt;- c(.5,.5,.5,.5,.5,1,1,1,1,2,2,2,2,2)

wpct(test)
wpct(test, weight)
</code></pre>

<hr>
<h2 id='wtd.chi.sq'>
Produces weighted chi-squared tests.
</h2><span id='topic+wtd.chi.sq'></span>

<h3>Description</h3>

<p><code>wtd.chi.sq</code> produces weighted chi-squared tests for two- and three-variable contingency tables.  Decomposes parts of three-variable contingency tables as well. Note that weights run with the default parameters here treat the weights as an estimate of the precision of the information. A prior version of this software was set to default to <code>mean1=FALSE</code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>wtd.chi.sq(var1, var2, var3=NULL, weight=NULL, na.rm=TRUE,
drop.missing.levels=TRUE, mean1=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wtd.chi.sq_+3A_var1">var1</code></td>
<td>

<p><code>var1</code> is a vector of values which the researcher would like to use to divide any data set.
</p>
</td></tr>
<tr><td><code id="wtd.chi.sq_+3A_var2">var2</code></td>
<td>

<p><code>var2</code> is a vector of values which the researcher would like to use to divide any data set.
</p>
</td></tr>
<tr><td><code id="wtd.chi.sq_+3A_var3">var3</code></td>
<td>

<p><code>var3</code> is an optional additional vector of values which the researcher would like to use to divide any data set.
</p>
</td></tr>
<tr><td><code id="wtd.chi.sq_+3A_weight">weight</code></td>
<td>

<p><code>weight</code> is an optional vector of weights to be used to determine the weighted chi-squared for all analyses.
</p>
</td></tr>
<tr><td><code id="wtd.chi.sq_+3A_na.rm">na.rm</code></td>
<td>

<p><code>na.rm</code> removes missing data from analyses.
</p>
</td></tr>
<tr><td><code id="wtd.chi.sq_+3A_drop.missing.levels">drop.missing.levels</code></td>
<td>

<p><code>drop.missing.levels</code> drops missing levels from variables.
</p>
</td></tr>
<tr><td><code id="wtd.chi.sq_+3A_mean1">mean1</code></td>
<td>

<p><code>mean1</code> is an optional parameter for determining whether the weights should be forced to have an average value of 1. If this is set as false, the weighted correlations will be produced with the assumption that the true N of the data is equivalent to the sum of the weights.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A two-way chi-squared produces a vector including a single chi-squared value, degrees of freedom measure, and p-value for each analysis.
</p>
<p>A three-way chi-squared produces a matrix with a single chi-squared value, degrees of freedom measure, and p-value for each of seven analyses.  These include: (1) the values using a three-way contingency table, (2) the values for a two-way contingency table with each pair of variables, and (3) assessments for whether the relations between each pair of variables are significantly different across levels of the third variable.
</p>


<h3>Author(s)</h3>

<p>Josh Pasek, Assistant Professor of Communication Studies at the University of Michigan (www.joshpasek.com).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+wtd.cor">wtd.cor</a></code>
<code><a href="#topic+wtd.t.test">wtd.t.test</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>var1 &lt;- c(1,1,1,1,1,2,2,2,2,2,3,3,3,3,3)
var2 &lt;- c(1,1,2,2,3,3,1,1,2,2,3,3,1,1,2)
var3 &lt;- c(1,2,3,1,2,3,1,2,3,1,2,3,1,2,3)
weight &lt;- c(.5,.5,.5,.5,.5,1,1,1,1,1,2,2,2,2,2)

wtd.chi.sq(var1, var2)
wtd.chi.sq(var1, var2, weight=weight)

wtd.chi.sq(var1, var2, var3)
wtd.chi.sq(var1, var2, var3, weight=weight)
</code></pre>

<hr>
<h2 id='wtd.cor'>
Produces weighted correlations with standard errors and significance.  For a faster version without standard errors and p values, use the <code><a href="#topic+wtd.cors">wtd.cors</a></code> function.
</h2><span id='topic+wtd.cor'></span><span id='topic+onecor.wtd'></span>

<h3>Description</h3>

<p><code>wtd.cor</code> produces a Pearsons correlation coefficient comparing two variables or matrices.  Note that weights run with the default parameters here treat the weights as an estimate of the precision of the information.  For survey data, users should run this code with bootstrapped standard errors <code>bootse=TRUE</code>, which are robust to heteroskadesticity, although these will vary slightly each time the weights are run. A prior version of this software was set to default to <code>mean1=FALSE</code> and <code>bootse=FALSE</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wtd.cor(x, y=NULL, weight=NULL, mean1=TRUE, collapse=TRUE, bootse=FALSE,
bootp=FALSE, bootn=1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wtd.cor_+3A_x">x</code></td>
<td>

<p><code>x</code> should be a matrix or vector which the researcher wishes to correlate with <code>y</code>.
</p>
</td></tr>
<tr><td><code id="wtd.cor_+3A_y">y</code></td>
<td>

<p><code>y</code> should be a numerical vector or matrix which the researcher wishes to correlate with <code>x</code>.  If <code>y</code> is NULL, <code>x</code> will be used instead
</p>
</td></tr>
<tr><td><code id="wtd.cor_+3A_weight">weight</code></td>
<td>

<p><code>weight</code> is an optional vector of weights to be used to determining the weighted mean and variance for calculation of the correlations.
</p>
</td></tr>
<tr><td><code id="wtd.cor_+3A_mean1">mean1</code></td>
<td>

<p><code>mean1</code> is an optional parameter for determining whether the weights should be forced to have an average value of 1. If this is set as false, the weighted correlations will be produced with the assumption that the true N of the data is equivalent to the sum of the weights.
</p>
</td></tr>
<tr><td><code id="wtd.cor_+3A_collapse">collapse</code></td>
<td>

<p><code>collapse</code> is an indicator for whether the data should be collapsed to a simpler form if either x or y is a vector instead of a matrix.
</p>
</td></tr>
<tr><td><code id="wtd.cor_+3A_bootse">bootse</code></td>
<td>

<p><code>bootse</code> is an optional parameter that produces bootstrapped standard errors. This should be used to address heteroskadesticity issues when weights indicate probabilities of selection rather than the precision of estimates.
</p>
</td></tr>
<tr><td><code id="wtd.cor_+3A_bootp">bootp</code></td>
<td>

<p><code>bootp</code> is an optional parameter that produces bootstrapped p values instead of estimating p values from the standard errors. This parameter only operates when <code>bootse=TRUE</code>.
</p>
</td></tr>
<tr><td><code id="wtd.cor_+3A_bootn">bootn</code></td>
<td>

<p><code>bootn</code> is an optional parameter that is used to indicate the number of bootstraps that should be run for <code>bootse</code> and <code>bootp</code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with matrices for the estimated correlation coefficient, the standard error on that correlation coefficient, the t-value for that correlation coefficient, and the p value for the significance of the correlation.  If the list can be simplified, simplification will be done.
</p>


<h3>Author(s)</h3>

<p>Josh Pasek, Assistant Professor of Communication Studies at the University of Michigan (www.joshpasek.com).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+wtd.cors">wtd.cors</a></code>
<code><a href="#topic+stdz">stdz</a></code>
<code><a href="#topic+wtd.t.test">wtd.t.test</a></code>
<code><a href="#topic+wtd.chi.sq">wtd.chi.sq</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>test &lt;- c(1,1,1,1,1,1,2,2,2,3,3,3,4,4)
t2 &lt;- rev(test)
weight &lt;- c(.5,.5,.5,.5,.5,1,1,1,1,2,2,2,2,2)

wtd.cor(test, t2)
wtd.cor(test, t2, weight)
wtd.cor(test, t2, weight, bootse=TRUE)
</code></pre>

<hr>
<h2 id='wtd.cors'>
Produces weighted correlations quickly using C.
</h2><span id='topic+wtd.cors'></span>

<h3>Description</h3>

<p><code>wtd.cors</code> produces a Pearsons correlation coefficient comparing two variables or matrices.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wtd.cors(x, y=NULL, weight=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wtd.cors_+3A_x">x</code></td>
<td>

<p><code>x</code> should be a matrix or vector which the researcher wishes to correlate with <code>y</code>.
</p>
</td></tr>
<tr><td><code id="wtd.cors_+3A_y">y</code></td>
<td>

<p><code>y</code> should be a numerical vector or matrix which the researcher wishes to correlate with <code>x</code>.  If <code>y</code> is NULL, <code>x</code> will be used instead
</p>
</td></tr>
<tr><td><code id="wtd.cors_+3A_weight">weight</code></td>
<td>

<p><code>weight</code> is an optional vector of weights to be used to determining the weighted mean and variance for calculation of the correlations.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of the estimated correlation coefficients.
</p>


<h3>Author(s)</h3>

<p>Marcus Schwemmle at GfK programmed the C code, R wrapper by Josh Pasek, Assistant Professor of Communication Studies at the University of Michigan (www.joshpasek.com).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+wtd.cor">wtd.cor</a></code>
<code><a href="#topic+stdz">stdz</a></code>
<code><a href="#topic+wtd.t.test">wtd.t.test</a></code>
<code><a href="#topic+wtd.chi.sq">wtd.chi.sq</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>test &lt;- c(1,1,1,1,1,1,2,2,2,3,3,3,4,4)
t2 &lt;- rev(test)
weight &lt;- c(.5,.5,.5,.5,.5,1,1,1,1,2,2,2,2,2)

wtd.cors(test, t2)
wtd.cors(test, t2, weight)
</code></pre>

<hr>
<h2 id='wtd.hist'>
Weighted Histograms
</h2><span id='topic+wtd.hist'></span>

<h3>Description</h3>

<p>Produces weighted histograms by adding a &quot;weight&quot; option to the his.default function from the graphics package (Copyright R-core). The code here was copied from that function and modified slightly to allow for weighted histograms as well as unweighted histograms. The generic function hist computes a histogram of the given data values. If plot=TRUE, the resulting object of class &quot;histogram&quot; is plotted by plot.histogram, before it is returned.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wtd.hist(x, breaks = "Sturges",
     freq = NULL, probability = !freq,
     include.lowest = TRUE, right = TRUE,
     density = NULL, angle = 45, col = NULL, border = NULL,
     main = paste("Histogram of" , xname),
     xlim = range(breaks), ylim = NULL,
     xlab = xname, ylab,
     axes = TRUE, plot = TRUE, labels = FALSE,
     nclass = NULL, weight = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wtd.hist_+3A_x">x</code></td>
<td>
<p>a vector of values for which the histogram is desired.</p>
</td></tr>
<tr><td><code id="wtd.hist_+3A_breaks">breaks</code></td>
<td>
<p>one of:
</p>

<ul>
<li><p> a vector giving the breakpoints between histogram cells,
</p>
</li>
<li><p> a single number giving the number of cells for the histogram,
</p>
</li>
<li><p> a character string naming an algorithm to compute the
number of cells (see &lsquo;Details&rsquo;),
</p>
</li>
<li><p> a function to compute the number of cells.
</p>
</li></ul>

<p>In the last three cases the number is a suggestion only.
</p>
</td></tr>
<tr><td><code id="wtd.hist_+3A_freq">freq</code></td>
<td>
<p>logical; if <code>TRUE</code>, the histogram graphic is a
representation of frequencies, the <code>counts</code> component of
the result; if <code>FALSE</code>, probability densities, component
<code>density</code>, are plotted (so that the histogram has a total area
of one).  Defaults to <code>TRUE</code> <em>if and only if</em> <code>breaks</code> are
equidistant (and <code>probability</code> is not specified).</p>
</td></tr>
<tr><td><code id="wtd.hist_+3A_probability">probability</code></td>
<td>
<p>an <em>alias</em> for <code>!freq</code>, for S compatibility.</p>
</td></tr>
<tr><td><code id="wtd.hist_+3A_include.lowest">include.lowest</code></td>
<td>
<p>logical; if <code>TRUE</code>, an <code>x[i]</code> equal to
the <code>breaks</code> value will be included in the first (or last, for
<code>right = FALSE</code>) bar.  This will be ignored (with a warning)
unless <code>breaks</code> is a vector.</p>
</td></tr>
<tr><td><code id="wtd.hist_+3A_right">right</code></td>
<td>
<p>logical; if <code>TRUE</code>, the histogram cells are
right-closed (left open) intervals.</p>
</td></tr>
<tr><td><code id="wtd.hist_+3A_density">density</code></td>
<td>
<p>the density of shading lines, in lines per inch.
The default value of <code>NULL</code> means that no shading lines
are drawn. Non-positive values of <code>density</code> also inhibit the
drawing of shading lines.</p>
</td></tr>
<tr><td><code id="wtd.hist_+3A_angle">angle</code></td>
<td>
<p>the slope of shading lines, given as an angle in
degrees (counter-clockwise).</p>
</td></tr>
<tr><td><code id="wtd.hist_+3A_col">col</code></td>
<td>
<p>a colour to be used to fill the bars.
The default of <code>NULL</code> yields unfilled bars.</p>
</td></tr>
<tr><td><code id="wtd.hist_+3A_border">border</code></td>
<td>
<p>the color of the border around the bars.  The default
is to use the standard foreground color.</p>
</td></tr>
<tr><td><code id="wtd.hist_+3A_main">main</code>, <code id="wtd.hist_+3A_xlab">xlab</code>, <code id="wtd.hist_+3A_ylab">ylab</code></td>
<td>
<p>these arguments to <code>title</code> have useful
defaults here.</p>
</td></tr>
<tr><td><code id="wtd.hist_+3A_xlim">xlim</code>, <code id="wtd.hist_+3A_ylim">ylim</code></td>
<td>
<p>the range of x and y values with sensible defaults.
Note that <code>xlim</code> is <em>not</em> used to define the histogram (breaks),
but only for plotting (when <code>plot = TRUE</code>).</p>
</td></tr>
<tr><td><code id="wtd.hist_+3A_axes">axes</code></td>
<td>
<p>logical.  If <code>TRUE</code> (default), axes are draw if the
plot is drawn.</p>
</td></tr>
<tr><td><code id="wtd.hist_+3A_plot">plot</code></td>
<td>
<p>logical.  If <code>TRUE</code> (default), a histogram is
plotted, otherwise a list of breaks and counts is returned.  In the
latter case, a warning is used if (typically graphical) arguments
are specified that only apply to the <code>plot = TRUE</code> case.</p>
</td></tr>
<tr><td><code id="wtd.hist_+3A_labels">labels</code></td>
<td>
<p>logical or character.  Additionally draw labels on top
of bars, if not <code>FALSE</code>; see <code>plot.histogram</code> in the <code>graphics</code> package.</p>
</td></tr>
<tr><td><code id="wtd.hist_+3A_nclass">nclass</code></td>
<td>
<p>numeric (integer).  For S(-PLUS) compatibility only,
<code>nclass</code> is equivalent to <code>breaks</code> for a scalar or
character argument.</p>
</td></tr>
<tr><td><code id="wtd.hist_+3A_weight">weight</code></td>
<td>
<p>numeric.  Defines a set of weights to produce a weighted histogram.  Will default to 1 for each case if no other weight is defined.</p>
</td></tr>
<tr><td><code id="wtd.hist_+3A_...">...</code></td>
<td>
<p>further arguments and graphical parameters passed to
<code>plot.histogram</code> and thence to <code>title</code> and
<code>axis</code> (if <code>plot=TRUE</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The definition of <em>histogram</em> differs by source (with
country-specific biases). R's default with equi-spaced breaks (also
the default) is to plot the (weighted) counts in the cells defined by
<code>breaks</code>.  Thus the height of a rectangle is proportional to
the (weighted) number of points falling into the cell, as is the area
<em>provided</em> the breaks are equally-spaced.
</p>
<p>The default with non-equi-spaced breaks is to give
a plot of area one, in which the <em>area</em> of the rectangles is the
fraction of the data points falling in the cells.
</p>
<p>If <code>right = TRUE</code> (default), the histogram cells are intervals
of the form <code>(a, b]</code>, i.e., they include their right-hand endpoint,
but not their left one, with the exception of the first cell when
<code>include.lowest</code> is <code>TRUE</code>.
</p>
<p>For <code>right = FALSE</code>, the intervals are of the form <code>[a, b)</code>,
and <code>include.lowest</code> means &lsquo;<em>include highest</em>&rsquo;.
</p>
<p>The default for <code>breaks</code> is <code>"Sturges"</code>: see
<code>nclass.Sturges</code>.  Other names for which algorithms
are supplied are <code>"Scott"</code> and <code>"FD"</code> /
<code>"Freedman-Diaconis"</code> (with corresponding functions
<code>nclass.scott</code> and <code>nclass.FD</code>).
Case is ignored and partial matching is used.
Alternatively, a function can be supplied which
will compute the intended number of breaks as a function of <code>x</code>.
</p>


<h3>Value</h3>

<p>an object of class <code>"histogram"</code> which is a list with components:
</p>
<table>
<tr><td><code>breaks</code></td>
<td>
<p>the <code class="reqn">n+1</code> cell boundaries (= <code>breaks</code> if that
was a vector). These are the nominal breaks, not with the boundary fuzz.</p>
</td></tr>
<tr><td><code>counts</code></td>
<td>
<p><code class="reqn">n</code> values; for each cell, the number of
<code>x[]</code> inside.</p>
</td></tr>
<tr><td><code>density</code></td>
<td>
<p>values for each bin such that the area under the histogram totals 1.
<code class="reqn">\hat f(x_i \omega_i)</code> / <code class="reqn">f^(x[i] \omega[i])</code>, as estimated
density values. If <code>all(diff(breaks) == 1)</code>, they are the
relative frequencies <code>counts/n</code> and in general satisfy
<code class="reqn">\sum_i \hat f(x_i  \omega_i) (b_{i+1}-b_i) = 1</code> / <code class="reqn">sum[i; f^(x[i]  \omega[i])
      (b[i+1]-b[i])] = 1</code>, where <code class="reqn">b_i</code> = <code>breaks[i]</code>.</p>
</td></tr>
<tr><td><code>intensities</code></td>
<td>
<p>same as <code>density</code>. Deprecated, but retained
for compatibility.</p>
</td></tr>
<tr><td><code>mids</code></td>
<td>
<p>the <code class="reqn">n</code> cell midpoints.</p>
</td></tr>
<tr><td><code>xname</code></td>
<td>
<p>a character string with the actual <code>x</code> argument name.</p>
</td></tr>
<tr><td><code>equidist</code></td>
<td>
<p>logical, indicating if the distances between
<code>breaks</code> are all the same.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Josh Pasek, Assistant Professor of Communication Studies at the University of Michigan (www.joshpasek.com) was responsible for the updates to the hist function necessary to implement weighted counts. The hist.default code from the graphics package on which the current function was based was written by R-core. All modifications are noted in code and the copyright for all original code remains with R-core.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>var1 &lt;- c(1:100)
wgt &lt;- var1/mean(var1)
par(mfrow=c(2, 2))
wtd.hist(var1)
wtd.hist(var1, weight=wgt)
wtd.hist(var1, weight=var1)
</code></pre>

<hr>
<h2 id='wtd.t.test'>
Produces weighted Student's t-tests with standard errors and significance.
</h2><span id='topic+wtd.t.test'></span>

<h3>Description</h3>

<p><code>wtd.t.test</code> produces either one- or two-sample t-tests comparing weighted data streams to one another. Note that weights run with the default parameters here treat the weights as an estimate of the precision of the information. For survey data, users should run this code with bootstrapped standard errors <code>bootse=TRUE</code>, which are robust to heteroskadesticity, although these will vary slightly each time the weights are run. A prior version of this software was set to default to <code>mean1=FALSE</code> and <code>bootse=FALSE</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wtd.t.test(x, y=0, weight=NULL, weighty=NULL, samedata=TRUE,
alternative="two.tailed", mean1=TRUE, bootse=FALSE, bootp=FALSE,
bootn=1000, drops="pairwise")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wtd.t.test_+3A_x">x</code></td>
<td>

<p><code>x</code> is a numerical vector which the researcher wishes to test against <code>y</code>.
</p>
</td></tr>
<tr><td><code id="wtd.t.test_+3A_y">y</code></td>
<td>

<p><code>y</code> can be either a single number representing an alternative hypothesis or a second numerical vector which the researcher wishes to compare against <code>x</code>.
</p>
</td></tr>
<tr><td><code id="wtd.t.test_+3A_weight">weight</code></td>
<td>

<p><code>weight</code> is an optional vector of weights to be used to determine the weighted mean and variance for the <code>x</code> vector for all t-tests.  If <code>weighty</code> is unspecified and <code>samedata</code> is TRUE, this weight will be assumed to apply to both <code>x</code> and <code>y</code>.
</p>
</td></tr>
<tr><td><code id="wtd.t.test_+3A_weighty">weighty</code></td>
<td>

<p><code>weighty</code> is an optional vector of weights to be used to determine the weighted mean and variance for the <code>y</code> vector for two-sample t-tests.  If <code>weighty</code> is unspecified and <code>samedata</code> is TRUE, this weight will be assumed to equal <code>weightx</code>.  If <code>weighty</code> is unspecified and <code>samedata</code> is FALSE, this weight will be assumed to equal 1 for all cases.
</p>
</td></tr>
<tr><td><code id="wtd.t.test_+3A_samedata">samedata</code></td>
<td>

<p><code>samedata</code> is an optional identifier for whether the <code>x</code> and <code>y</code> data come from the same data stream for a two-sample test.  If true, <code>wtd.t.test</code> assumes that <code>weighty</code> should equal <code>weightx</code> if (1) <code>weighty</code> is unspecified, and (2) the lengths of the two vectors are identical.
</p>
</td></tr>
<tr><td><code id="wtd.t.test_+3A_alternative">alternative</code></td>
<td>

<p><code>alternative</code> is an optional marker for whether one or two-tailed p-values shoould be returned.  By default, two-tailed values will be returned (<code>type="two.tailed"</code>).  To set to one-tailed values, alternative can be set to <code>type="greater"</code> to test <code>x&gt;y</code> or <code>type="less"</code> to test <code>x&lt;y</code>.
</p>
</td></tr>
<tr><td><code id="wtd.t.test_+3A_mean1">mean1</code></td>
<td>

<p><code>mean1</code> is an optional parameter for determining whether the weights should be forced to have an average value of 1. If this is set as false, the weighted correlations will be produced with the assumption that the true N of the data is equivalent to the sum of the weights.
</p>
</td></tr>
<tr><td><code id="wtd.t.test_+3A_bootse">bootse</code></td>
<td>

<p><code>bootse</code> is an optional parameter that produces bootstrapped standard errors. This should be used to address heteroskadesticity issues when weights indicate probabilities of selection rather than the precision of estimates.
</p>
</td></tr>
<tr><td><code id="wtd.t.test_+3A_bootp">bootp</code></td>
<td>

<p><code>bootp</code> is an optional parameter that produces bootstrapped p values instead of estimating p values from the standard errors. This parameter only operates when <code>bootse=TRUE</code>.
</p>
</td></tr>
<tr><td><code id="wtd.t.test_+3A_bootn">bootn</code></td>
<td>

<p><code>bootn</code> is an optional parameter that is used to indicate the number of bootstraps that should be run for <code>bootse</code> and <code>bootp</code>.
</p>
</td></tr>
<tr><td><code id="wtd.t.test_+3A_drops">drops</code></td>
<td>

<p><code>drops</code> is set to limit a t-test on the same data to cases with nonmissing data for x, y, and weights (if specified). If <code>drops</code> is anything other than <code>"pairwise"</code>, means for <code>x</code> and <code>y</code> are calculated on all available data rather than data that are available for both <code>x</code> and <code>y</code>. This parameter does nothing if <code>x</code> and <code>y</code> are not from the same dataset.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list element with an identifier for the test; coefficients for the t value, degrees of freedom, and p value of the t-test; and additional statistics of potential interest.
</p>


<h3>Author(s)</h3>

<p>Josh Pasek, Assistant Professor of Communication Studies at the University of Michigan (www.joshpasek.com).  Gene Culter added code for a one-tailed version of the test.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+stdz">stdz</a></code>
<code><a href="#topic+wtd.cor">wtd.cor</a></code>
<code><a href="#topic+wtd.chi.sq">wtd.chi.sq</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>test &lt;- c(1,1,1,1,1,1,2,2,2,3,3,3,4,4)
t2 &lt;- rev(test)+1
weight &lt;- c(.5,.5,.5,.5,.5,1,1,1,1,2,2,2,2,2)

wtd.t.test(test, t2)
wtd.t.test(test, t2, weight)
wtd.t.test(test, t2, weight, bootse=TRUE)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
