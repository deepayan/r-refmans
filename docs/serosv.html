<!DOCTYPE html><html lang="en"><head><title>Help for package serosv</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {serosv}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#serosv-package'><p>serosv: model infectious disease parameters</p></a></li>
<li><a href='#compute_ci'><p>Compute confidence interval</p></a></li>
<li><a href='#compute_ci.fp_model'><p>Compute confidence interval for fractional polynomial model</p></a></li>
<li><a href='#compute_ci.lp_model'><p>Compute confidence interval for local polynomial model</p></a></li>
<li><a href='#compute_ci.mixture_model'><p>Compute confidence interval for mixture model</p></a></li>
<li><a href='#compute_ci.penalized_spline_model'><p>Compute confidence interval for penalized_spline_model</p></a></li>
<li><a href='#compute_ci.weibull_model'><p>Compute confidence interval for Weibull model</p></a></li>
<li><a href='#est_foi'><p>Estimate force of infection</p></a></li>
<li><a href='#estimate_from_mixture'><p>Estimate seroprevalence and foi by combining mixture model and regression</p></a></li>
<li><a href='#farrington_model'><p>The Farrington (1990) model.</p></a></li>
<li><a href='#find_best_fp_powers'><p>Returns the powers of the GLM fitted model which has the lowest deviance score.</p></a></li>
<li><a href='#fp_model'><p>A fractional polynomial model.</p></a></li>
<li><a href='#hav_be_1993_1994'><p>Hepatitis A serological data from Belgium in 1993 and 1994 (aggregated)</p></a></li>
<li><a href='#hav_be_2002'><p>Hepatitis A serological data from Belgium in 2002 (line listing)</p></a></li>
<li><a href='#hav_bg_1964'><p>Hepatitis A serological data from Bulgaria in 1964 (aggregated)</p></a></li>
<li><a href='#hbv_ru_1999'><p>Hepatitis B serological data from Russia in 1999 (aggregated)</p></a></li>
<li><a href='#hcv_be_2006'><p>Hepatitis C serological data from Belgium in 2006 (line listing)</p></a></li>
<li><a href='#hierarchical_bayesian_model'><p>Hierarchical Bayesian Model</p></a></li>
<li><a href='#lp_model'><p>A local polynomial model.</p></a></li>
<li><a href='#mixture_model'><p>Fit a mixture model to classify serostatus</p></a></li>
<li><a href='#mseir_model'><p>MSEIR model</p></a></li>
<li><a href='#mumps_uk_1986_1987'><p>Mumps serological data from the UK in 1986 and 1987 (aggregated)</p></a></li>
<li><a href='#parvob19_be_2001_2003'><p>Parvo B19 serological data from Belgium from 2001-2003 (line listing)</p></a></li>
<li><a href='#parvob19_ew_1996'><p>Parvo B19 serological data from England and Wales in 1996 (line listing)</p></a></li>
<li><a href='#parvob19_fi_1997_1998'><p>Parvo B19 serological data from Finland from 1997-1998 (line listing)</p></a></li>
<li><a href='#parvob19_it_2003_2004'><p>Parvo B19 serological data from Italy from 2003-2004 (line listing)</p></a></li>
<li><a href='#parvob19_pl_1995_2004'><p>Parvo B19 serological data from Poland from 1995-2004 (line listing)</p></a></li>
<li><a href='#pava'><p>Monotonize seroprevalence</p></a></li>
<li><a href='#penalized_spline_model'><p>Penalized Spline model</p></a></li>
<li><a href='#plot_gcv'><p>Plotting GCV values with respect to different nn-s and h-s parameters.</p></a></li>
<li><a href='#plot.estimate_from_mixture'><p>plot() overloading for result of estimate_from_mixture</p></a></li>
<li><a href='#plot.farrington_model'><p>plot() overloading for Farrington model</p></a></li>
<li><a href='#plot.fp_model'><p>plot() overloading for fractional polynomial model</p></a></li>
<li><a href='#plot.hierarchical_bayesian_model'><p>plot() overloading for hierarchical_bayesian_model</p></a></li>
<li><a href='#plot.lp_model'><p>plot() overloading for local polynomial model</p></a></li>
<li><a href='#plot.mixture_model'><p>plot() overloading for mixture model</p></a></li>
<li><a href='#plot.mseir_model'><p>plot() overloading for MSEIR model</p></a></li>
<li><a href='#plot.penalized_spline_model'><p>plot() overloading for penalized spline</p></a></li>
<li><a href='#plot.polynomial_model'><p>plot() overloading for polynomial model</p></a></li>
<li><a href='#plot.sir_basic_model'><p>plot() overloading for SIR model</p></a></li>
<li><a href='#plot.sir_static_model'><p>plot() overloading for SIR static model</p></a></li>
<li><a href='#plot.sir_subpops_model'><p>plot() overloading for SIR sub populations model</p></a></li>
<li><a href='#plot.weibull_model'><p>plot() overloading for Weibull model</p></a></li>
<li><a href='#polynomial_model'><p>Polynomial models</p></a></li>
<li><a href='#rubella_mumps_uk'><p>Rubella - Mumps data from the UK (aggregated)</p></a></li>
<li><a href='#rubella_uk_1986_1987'><p>Rubella serological data from the UK in 1986 and 1987 (aggregated)</p></a></li>
<li><a href='#set_plot_style'><p>Helper to adjust styling of a plot</p></a></li>
<li><a href='#sir_basic_model'><p>Basic SIR model</p></a></li>
<li><a href='#sir_static_model'><p>SIR static model (age-heterogeneous, endemic equilibrium)</p></a></li>
<li><a href='#sir_subpops_model'><p>SIR Model with Interacting Subpopulations</p></a></li>
<li><a href='#tb_nl_1966_1973'><p>Tuberculosis serological data from the Netherlands 1966-1973 (aggregated)</p></a></li>
<li><a href='#transform_data'><p>Generate a dataframe with 't', 'pos' and 'tot' columns from</p>
't' and 'seropositive' vectors.</a></li>
<li><a href='#vzv_be_1999_2000'><p>VZV serological data from Belgium (Flanders) from 1999-2000 (aggregated)</p></a></li>
<li><a href='#vzv_be_2001_2003'><p>VZV serological data from Belgium from 2001-2003 (line listing)</p></a></li>
<li><a href='#vzv_parvo_be'><p>VZV and Parvovirus B19 serological data in Belgium (line listing)</p></a></li>
<li><a href='#weibull_model'><p>The Weibull model.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Model Infectious Disease Parameters from Serosurveys</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.1</td>
</tr>
<tr>
<td>Description:</td>
<td>An easy-to-use and efficient tool to estimate infectious diseases parameters using serological data. Implemented models include SIR models (basic_sir_model(), static_sir_model(), mseir_model(), sir_subpops_model()), parametric models (polynomial_model(), fp_model()), nonparametric models (lp_model()), semiparametric models (penalized_splines_model()), hierarchical models (hierarchical_bayesian_model()).
  The package is based on the book "Modeling Infectious Disease Parameters Based on Serological and Social Contact Data: A Modern Statistical Perspective" (Hens, Niel &amp; Shkedy, Ziv &amp; Aerts, Marc &amp; Faes, Christel &amp; Damme, Pierre &amp; Beutels, Philippe., 2013) &lt;<a href="https://doi.org/10.1007%2F978-1-4614-4072-7">doi:10.1007/978-1-4614-4072-7</a>&gt;. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.4.0)</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>Imports:</td>
<td>deSolve, dplyr, ggplot2, locfit, magrittr, methods, mgcv,
mixdist, patchwork, Rcpp (&ge; 0.12.0), RcppParallel (&ge; 5.0.1),
rstan (&ge; 2.18.1), rstantools (&ge; 2.4.0), boot, stats4</td>
</tr>
<tr>
<td>Suggests:</td>
<td>covr, knitr, rmarkdown, bookdown, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Collate:</td>
<td>'data.R' 'mseir_model.R' 'sir_basic_model.R'
'sir_static_model.R' 'sir_subpops_model.R'
'fractional_polynomial_models.R' 'polynomial_models.R'
'utils.R' 'weibull_model.R' 'nonparametric.R'
'semiparametric_models.R' 'mixture_model.R'
'hierarchical_bayesian_model.R' 'serosv.R' 'stanmodels.R'
'plots.R' 'compute_ci.R'</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://oucru-modelling.github.io/serosv/">https://oucru-modelling.github.io/serosv/</a>,
<a href="https://github.com/OUCRU-Modelling/serosv">https://github.com/OUCRU-Modelling/serosv</a></td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Biarch:</td>
<td>true</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>BH (&ge; 1.66.0), Rcpp (&ge; 0.12.0), RcppEigen (&ge; 0.3.3.3.0),
RcppParallel (&ge; 5.0.1), rstan (&ge; 2.18.1), StanHeaders (&ge;
2.18.0)</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>GNU make</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/OUCRU-Modelling/serosv/issues">https://github.com/OUCRU-Modelling/serosv/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-10-18 06:26:55 UTC; anhptq</td>
</tr>
<tr>
<td>Author:</td>
<td>Anh Phan Truong Quynh [aut, cre],
  Nguyen Pham Nguyen The [aut],
  Long Bui Thanh [aut],
  Tuyen Huynh [aut],
  Thinh Ong <a href="https://orcid.org/0000-0001-6772-9291"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Marc Choisy <a href="https://orcid.org/0000-0002-5187-6390"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Anh Phan Truong Quynh &lt;anhptq@oucru.org&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-10-18 10:50:01 UTC</td>
</tr>
</table>
<hr>
<h2 id='serosv-package'>serosv: model infectious disease parameters</h2><span id='topic+serosv'></span><span id='topic+serosv-package'></span>

<h3>Description</h3>

<p>An easy-to-use and efficient tool to estimate infectious diseases parameters using serological data. Implemented models include SIR models (basic_sir_model(), static_sir_model(), mseir_model(), sir_subpops_model()), parametric models (polynomial_model(), fp_model()), nonparametric models (lp_model()), semiparametric models (penalized_splines_model()), hierarchical models (hierarchical_bayesian_model()). The package is based on the book &quot;Modeling Infectious Disease Parameters Based on Serological and Social Contact Data: A Modern Statistical Perspective&quot; (Hens, Niel &amp; Shkedy, Ziv &amp; Aerts, Marc &amp; Faes, Christel &amp; Damme, Pierre &amp; Beutels, Philippe., 2013) <a href="https://doi.org/10.1007/978-1-4614-4072-7">doi:10.1007/978-1-4614-4072-7</a>.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Anh Phan Truong Quynh <a href="mailto:anhptq@oucru.org">anhptq@oucru.org</a>
</p>
<p>Authors:
</p>

<ul>
<li><p> Nguyen Pham Nguyen The <a href="mailto:nguyenpnt@oucru.org">nguyenpnt@oucru.org</a>
</p>
</li>
<li><p> Long Bui Thanh
</p>
</li>
<li><p> Tuyen Huynh <a href="mailto:tuyenhn@oucru.org">tuyenhn@oucru.org</a>
</p>
</li>
<li><p> Thinh Ong <a href="mailto:thinhop@oucru.org">thinhop@oucru.org</a> (<a href="https://orcid.org/0000-0001-6772-9291">ORCID</a>)
</p>
</li>
<li><p> Marc Choisy <a href="mailto:mchoisy@oucru.org">mchoisy@oucru.org</a> (<a href="https://orcid.org/0000-0002-5187-6390">ORCID</a>)
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://oucru-modelling.github.io/serosv/">https://oucru-modelling.github.io/serosv/</a>
</p>
</li>
<li> <p><a href="https://github.com/OUCRU-Modelling/serosv">https://github.com/OUCRU-Modelling/serosv</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/OUCRU-Modelling/serosv/issues">https://github.com/OUCRU-Modelling/serosv/issues</a>
</p>
</li></ul>


<hr>
<h2 id='compute_ci'>Compute confidence interval</h2><span id='topic+compute_ci'></span>

<h3>Description</h3>

<p>Compute confidence interval
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_ci(x, ci = 0.95, le = 100, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compute_ci_+3A_x">x</code></td>
<td>
<p>- serosv models</p>
</td></tr>
<tr><td><code id="compute_ci_+3A_ci">ci</code></td>
<td>
<p>- confidence interval</p>
</td></tr>
<tr><td><code id="compute_ci_+3A_le">le</code></td>
<td>
<p>- number of data for computing confidence interval</p>
</td></tr>
<tr><td><code id="compute_ci_+3A_...">...</code></td>
<td>
<p>- arbitrary argument</p>
</td></tr>
</table>


<h3>Value</h3>

<p>confidence interval dataframe with 4 variables, x and y for the fitted values and ymin and ymax for the confidence interval
</p>

<hr>
<h2 id='compute_ci.fp_model'>Compute confidence interval for fractional polynomial model</h2><span id='topic+compute_ci.fp_model'></span>

<h3>Description</h3>

<p>Compute confidence interval for fractional polynomial model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_ci.fp_model(x, ci = 0.95, le = 100, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compute_ci.fp_model_+3A_x">x</code></td>
<td>
<p>- serosv models</p>
</td></tr>
<tr><td><code id="compute_ci.fp_model_+3A_ci">ci</code></td>
<td>
<p>- confidence interval</p>
</td></tr>
<tr><td><code id="compute_ci.fp_model_+3A_le">le</code></td>
<td>
<p>- number of data for computing confidence interval</p>
</td></tr>
<tr><td><code id="compute_ci.fp_model_+3A_...">...</code></td>
<td>
<p>- arbitrary argument</p>
</td></tr>
</table>


<h3>Value</h3>

<p>confidence interval dataframe with 4 variables, x and y for the fitted values and ymin and ymax for the confidence interval
</p>

<hr>
<h2 id='compute_ci.lp_model'>Compute confidence interval for local polynomial model</h2><span id='topic+compute_ci.lp_model'></span>

<h3>Description</h3>

<p>Compute confidence interval for local polynomial model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_ci.lp_model(x, ci = 0.95, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compute_ci.lp_model_+3A_x">x</code></td>
<td>
<p>- serosv models</p>
</td></tr>
<tr><td><code id="compute_ci.lp_model_+3A_ci">ci</code></td>
<td>
<p>- confidence interval</p>
</td></tr>
<tr><td><code id="compute_ci.lp_model_+3A_...">...</code></td>
<td>
<p>- arbitrary arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>confidence interval dataframe with 4 variables, x and y for the fitted values and ymin and ymax for the confidence interval
</p>

<hr>
<h2 id='compute_ci.mixture_model'>Compute confidence interval for mixture model</h2><span id='topic+compute_ci.mixture_model'></span>

<h3>Description</h3>

<p>Compute confidence interval for mixture model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_ci.mixture_model(x, ci = 0.95, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compute_ci.mixture_model_+3A_x">x</code></td>
<td>
<p>- serosv mixture_model object</p>
</td></tr>
<tr><td><code id="compute_ci.mixture_model_+3A_ci">ci</code></td>
<td>
<p>- confidence interval</p>
</td></tr>
<tr><td><code id="compute_ci.mixture_model_+3A_...">...</code></td>
<td>
<p>- arbitrary arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of confidence interval for susceptible and infected. Each confidence interval is a list with 2 items for lower and upper bound of the interval.
</p>

<hr>
<h2 id='compute_ci.penalized_spline_model'>Compute confidence interval for penalized_spline_model</h2><span id='topic+compute_ci.penalized_spline_model'></span>

<h3>Description</h3>

<p>Compute confidence interval for penalized_spline_model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_ci.penalized_spline_model(x, ci = 0.95, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compute_ci.penalized_spline_model_+3A_x">x</code></td>
<td>
<p>- serosv models</p>
</td></tr>
<tr><td><code id="compute_ci.penalized_spline_model_+3A_ci">ci</code></td>
<td>
<p>- confidence interval</p>
</td></tr>
<tr><td><code id="compute_ci.penalized_spline_model_+3A_...">...</code></td>
<td>
<p>- arbitrary arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of confidence interval for seroprevalence and foi Each confidence interval dataframe with 4 variables, x and y for the fitted values and ymin and ymax for the confidence interval
</p>

<hr>
<h2 id='compute_ci.weibull_model'>Compute confidence interval for Weibull model</h2><span id='topic+compute_ci.weibull_model'></span>

<h3>Description</h3>

<p>Compute confidence interval for Weibull model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_ci.weibull_model(x, ci = 0.95, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compute_ci.weibull_model_+3A_x">x</code></td>
<td>
<p>- serosv models</p>
</td></tr>
<tr><td><code id="compute_ci.weibull_model_+3A_ci">ci</code></td>
<td>
<p>- confidence interval</p>
</td></tr>
<tr><td><code id="compute_ci.weibull_model_+3A_...">...</code></td>
<td>
<p>- arbitrary argument</p>
</td></tr>
</table>


<h3>Value</h3>

<p>confidence interval dataframe with 4 variables, x and y for the fitted values and ymin and ymax for the confidence interval
</p>

<hr>
<h2 id='est_foi'>Estimate force of infection</h2><span id='topic+est_foi'></span>

<h3>Description</h3>

<p>Estimate force of infection
</p>


<h3>Usage</h3>

<pre><code class='language-R'>est_foi(t, sp)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="est_foi_+3A_t">t</code></td>
<td>
<p>- time (in this case age) vector</p>
</td></tr>
<tr><td><code id="est_foi_+3A_sp">sp</code></td>
<td>
<p>- seroprevalence vector</p>
</td></tr>
</table>


<h3>Value</h3>

<p>computed foi vector
</p>

<hr>
<h2 id='estimate_from_mixture'>Estimate seroprevalence and foi by combining mixture model and regression</h2><span id='topic+estimate_from_mixture'></span>

<h3>Description</h3>

<p>Refers to section 11.2 - 11.4
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estimate_from_mixture(
  age,
  antibody_level,
  threshold_status = NULL,
  mixture_model,
  s = "ps",
  sp = 83,
  monotonize = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="estimate_from_mixture_+3A_age">age</code></td>
<td>
<p>- vector of age</p>
</td></tr>
<tr><td><code id="estimate_from_mixture_+3A_antibody_level">antibody_level</code></td>
<td>
<p>- vector of the corresponding raw antibody level</p>
</td></tr>
<tr><td><code id="estimate_from_mixture_+3A_threshold_status">threshold_status</code></td>
<td>
<p>- sero status using threshold approach in line listing (optional, for visualization and comparison only)</p>
</td></tr>
<tr><td><code id="estimate_from_mixture_+3A_mixture_model">mixture_model</code></td>
<td>
<p>- mixture_model object generated by serosv::mixture_model()</p>
</td></tr>
<tr><td><code id="estimate_from_mixture_+3A_s">s</code></td>
<td>
<p>- smoothing basis used to fit antibody level</p>
</td></tr>
<tr><td><code id="estimate_from_mixture_+3A_sp">sp</code></td>
<td>
<p>- smoothing parameter</p>
</td></tr>
<tr><td><code id="estimate_from_mixture_+3A_monotonize">monotonize</code></td>
<td>
<p>- whether to monotonize seroprevalence (default to TRUE)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of class estimated_from_mixture with the following items
</p>
<table role = "presentation">
<tr><td><code>df</code></td>
<td>
<p>the dataframe used for fitting the model</p>
</td></tr>
<tr><td><code>info</code></td>
<td>
<p>a fitted &quot;gam&quot; model for mu(a)</p>
</td></tr>
<tr><td><code>sp</code></td>
<td>
<p>seroprevalence</p>
</td></tr>
<tr><td><code>foi</code></td>
<td>
<p>force of infection</p>
</td></tr>
<tr><td><code>threshold_status</code></td>
<td>
<p>serostatus using threshold method only if provided</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>[mgcv::gam()] for more information about the fitted gam object
</p>

<hr>
<h2 id='farrington_model'>The Farrington (1990) model.</h2><span id='topic+farrington_model'></span>

<h3>Description</h3>

<p>Refers to section 6.1.2.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>farrington_model(
  age,
  start,
  pos = NULL,
  tot = NULL,
  status = NULL,
  fixed = list()
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="farrington_model_+3A_age">age</code></td>
<td>
<p>the age vector.</p>
</td></tr>
<tr><td><code id="farrington_model_+3A_start">start</code></td>
<td>
<p>Named list of vectors or single vector.
Initial values for optimizer.</p>
</td></tr>
<tr><td><code id="farrington_model_+3A_pos">pos</code></td>
<td>
<p>the positive count vector (optional if status is provided).</p>
</td></tr>
<tr><td><code id="farrington_model_+3A_tot">tot</code></td>
<td>
<p>the total count vector (optional if status is provided).</p>
</td></tr>
<tr><td><code id="farrington_model_+3A_status">status</code></td>
<td>
<p>the serostatus vector (optional if pos &amp; tot are provided).</p>
</td></tr>
<tr><td><code id="farrington_model_+3A_fixed">fixed</code></td>
<td>
<p>Named list of vectors or single vector.
Parameter values to keep fixed during optimization.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of class farrington_model with 5 items
</p>
<table role = "presentation">
<tr><td><code>datatype</code></td>
<td>
<p>type of datatype used for model fitting (aggregated or linelisting)</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>the dataframe used for fitting the model</p>
</td></tr>
<tr><td><code>info</code></td>
<td>
<p>fitted &quot;glm&quot; object</p>
</td></tr>
<tr><td><code>sp</code></td>
<td>
<p>seroprevalence</p>
</td></tr>
<tr><td><code>foi</code></td>
<td>
<p>force of infection</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>[stats::glm()] for more information on the fitted glm object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>df &lt;- rubella_uk_1986_1987
model &lt;- farrington_model(
  df$age, pos = df$pos, tot = df$tot,
  start=list(alpha=0.07,beta=0.1,gamma=0.03)
  )
plot(model)

</code></pre>

<hr>
<h2 id='find_best_fp_powers'>Returns the powers of the GLM fitted model which has the lowest deviance score.</h2><span id='topic+find_best_fp_powers'></span>

<h3>Description</h3>

<p>Refers to section 6.2.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>find_best_fp_powers(age, pos, tot, p, mc, degree, link = "logit")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="find_best_fp_powers_+3A_age">age</code></td>
<td>
<p>the age vector.</p>
</td></tr>
<tr><td><code id="find_best_fp_powers_+3A_pos">pos</code></td>
<td>
<p>the pos vector.</p>
</td></tr>
<tr><td><code id="find_best_fp_powers_+3A_tot">tot</code></td>
<td>
<p>the tot vector.</p>
</td></tr>
<tr><td><code id="find_best_fp_powers_+3A_p">p</code></td>
<td>
<p>a powers sequence.</p>
</td></tr>
<tr><td><code id="find_best_fp_powers_+3A_mc">mc</code></td>
<td>
<p>indicates if the returned model should be monotonic.</p>
</td></tr>
<tr><td><code id="find_best_fp_powers_+3A_degree">degree</code></td>
<td>
<p>the degree of the model. Recommended to be &lt;= 2.</p>
</td></tr>
<tr><td><code id="find_best_fp_powers_+3A_link">link</code></td>
<td>
<p>the link function. Defaulted to &quot;logit&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of 3 elements:
</p>
<table role = "presentation">
<tr><td><code>p</code></td>
<td>
<p>The best power for fp model.</p>
</td></tr>
<tr><td><code>deviance</code></td>
<td>
<p>Deviance of the best fitted model.</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>The best model fitted</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>df &lt;- hav_be_1993_1994
best_p &lt;- find_best_fp_powers(
df$age, df$pos, df$tot,
p=seq(-2,3,0.1), mc=FALSE, degree=2, link="cloglog"
)
best_p

</code></pre>

<hr>
<h2 id='fp_model'>A fractional polynomial model.</h2><span id='topic+fp_model'></span>

<h3>Description</h3>

<p>Refers to section 6.2.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fp_model(age, p, pos = NULL, tot = NULL, status = NULL, link = "logit")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fp_model_+3A_age">age</code></td>
<td>
<p>the age vector.</p>
</td></tr>
<tr><td><code id="fp_model_+3A_p">p</code></td>
<td>
<p>the powers of the predictor.</p>
</td></tr>
<tr><td><code id="fp_model_+3A_pos">pos</code></td>
<td>
<p>the positive count vector (optional if status is provided).</p>
</td></tr>
<tr><td><code id="fp_model_+3A_tot">tot</code></td>
<td>
<p>the total count vector (optional if status is provided).</p>
</td></tr>
<tr><td><code id="fp_model_+3A_status">status</code></td>
<td>
<p>the serostatus vector (optional if pos &amp; tot are provided).</p>
</td></tr>
<tr><td><code id="fp_model_+3A_link">link</code></td>
<td>
<p>the link function for model. Defaulted to &quot;logit&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of class fp_model with 5 items
</p>
<table role = "presentation">
<tr><td><code>datatype</code></td>
<td>
<p>type of data used for fitting model (aggregated or linelisting)</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>the dataframe used for fitting the model</p>
</td></tr>
<tr><td><code>info</code></td>
<td>
<p>a fitted glm model</p>
</td></tr>
<tr><td><code>sp</code></td>
<td>
<p>seroprevalence</p>
</td></tr>
<tr><td><code>foi</code></td>
<td>
<p>force of infection</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>[stats::glm()] for more information on glm object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>df &lt;- hav_be_1993_1994
model &lt;- fp_model(
  df$age, pos = df$pos, tot = df$tot,
  p=c(1.5, 1.6), link="cloglog")
plot(model)

</code></pre>

<hr>
<h2 id='hav_be_1993_1994'>Hepatitis A serological data from Belgium in 1993 and 1994 (aggregated)</h2><span id='topic+hav_be_1993_1994'></span>

<h3>Description</h3>

<p>A study of the prevalence of HAV antibodies conducted in the Flemish
Community of Belgium in 1993 and early 1994
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hav_be_1993_1994
</code></pre>


<h3>Format</h3>

<p>A data frame with 3 variables:
</p>

<dl>
<dt>age</dt><dd><p>Age group</p>
</dd>
<dt>pos</dt><dd><p>Number of seropositive individuals</p>
</dd>
<dt>tot</dt><dd><p>Total number of individuals surveyed</p>
</dd>
</dl>



<h3>Source</h3>

<p>Beutels, M., Van Damme, P., Aelvoet, W. et al. Prevalence of
hepatitis A, B and C in the Flemish population. Eur J Epidemiol 13,
275-280 (1997). <a href="https://doi.org/10.1023/A%3A1007393405966">doi:10.1023/A:1007393405966</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Reproduce Fig 4.1 (upper left panel), p. 63
age &lt;- hav_be_1993_1994$age
pos &lt;- hav_be_1993_1994$pos
tot &lt;- hav_be_1993_1994$tot
plot(
  age, pos / tot,
  pty = "s", cex = 0.06 * tot, pch = 16, xlab = "age",
  ylab = "seroprevalence", xlim = c(0, 86), ylim = c(0, 1)
)

</code></pre>

<hr>
<h2 id='hav_be_2002'>Hepatitis A serological data from Belgium in 2002 (line listing)</h2><span id='topic+hav_be_2002'></span>

<h3>Description</h3>

<p>A subset of the serological dataset of Varicella-Zoster Virus (VZV) and
Parvovirus B19 in Belgium where only individuals living in Flanders were
selected
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hav_be_2002
</code></pre>


<h3>Format</h3>

<p>A data frame with 2 variables:
</p>

<dl>
<dt>age</dt><dd><p>Age of individual</p>
</dd>
<dt>seropositive</dt><dd><p>If the individual is seropositive or not</p>
</dd>
</dl>



<h3>Source</h3>

<p>Thiry, N., Beutels, P., Shkedy, Z. et al. The seroepidemiology
of primary varicella-zoster virus infection in Flanders (Belgium).
Eur J Pediatr 161, 588-593 (2002).
<a href="https://doi.org/10.1007/s00431-002-1053-2">doi:10.1007/s00431-002-1053-2</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Reproduce Fig 4.1 (upper right panel), p. 63
library(dplyr)
df &lt;- hav_be_2002 %&gt;%
  group_by(age) %&gt;%
  summarise(pos = sum(seropositive), tot = n())
plot(
  df$age, df$pos / df$tot,
  pty = "s", cex = 0.06 * df$tot, pch = 16, xlab = "age",
  ylab = "seroprevalence", xlim = c(0, 86), ylim = c(0, 1)
)

</code></pre>

<hr>
<h2 id='hav_bg_1964'>Hepatitis A serological data from Bulgaria in 1964 (aggregated)</h2><span id='topic+hav_bg_1964'></span>

<h3>Description</h3>

<p>A cross-sectional survey conducted in 1964 in Bulgaria. Samples were
collected from schoolchildren and blood donors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hav_bg_1964
</code></pre>


<h3>Format</h3>

<p>A data frame with 3 variables:
</p>

<dl>
<dt>age</dt><dd><p>Age group</p>
</dd>
<dt>pos</dt><dd><p>Number of seropositive individuals</p>
</dd>
<dt>tot</dt><dd><p>Total number of individuals surveyed</p>
</dd>
</dl>



<h3>Source</h3>

<p>Keiding, Niels. &quot;Age-Specific Incidence and Prevalence: A
Statistical Perspective.&quot; Journal of the Royal Statistical Society.
Series A (Statistics in Society) 154, no. 3 (1991): 371-412.
<a href="https://doi.org/10.2307/2983150">doi:10.2307/2983150</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Reproduce Fig 4.1 (lower panel), p. 63
age &lt;- hav_bg_1964$age
pos &lt;- hav_bg_1964$pos
tot &lt;- hav_bg_1964$tot
plot(
    age, pos / tot,
    pty = "s", cex = 0.08 * tot, pch = 16, xlab = "age",
    ylab = "seroprevalence", xlim = c(0, 86), ylim = c(0, 1)
)

</code></pre>

<hr>
<h2 id='hbv_ru_1999'>Hepatitis B serological data from Russia in 1999 (aggregated)</h2><span id='topic+hbv_ru_1999'></span>

<h3>Description</h3>

<p>A seroprevalence study conducted in St. Petersburg
(more information in the book)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hbv_ru_1999
</code></pre>


<h3>Format</h3>

<p>A data frame with 4 variables:
</p>

<dl>
<dt>age</dt><dd><p>Age group</p>
</dd>
<dt>pos</dt><dd><p>Number of seropositive individuals</p>
</dd>
<dt>tot</dt><dd><p>Total number of individuals surveyed</p>
</dd>
<dt>gender</dt><dd><p>Gender of cohort (unsure what 1 and 2 means)</p>
</dd>
</dl>



<h3>Source</h3>

<p>Mukomolov, S., L. Shliakhtenko, I. Levakova, and E. Shargorodskaya.
Viral hepatitis in Russian federation. An analytical overview. Technical
Report 213 (3), 3rd edn. St Petersburg Pasteur Institute,
St Petersburg, 2000.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Reproduce Fig 4.2, p. 65
library(dplyr)
hbv_ru_1999$age &lt;- trunc(hbv_ru_1999$age / 1) * 1
hbv_ru_1999$age[hbv_ru_1999$age &gt; 40] &lt;- trunc(
  hbv_ru_1999$age[hbv_ru_1999$age &gt; 40] / 5
) * 5
df &lt;- hbv_ru_1999 %&gt;%
  group_by(age) %&gt;%
  summarise(pos = sum(pos), tot = sum(tot))
plot(
  df$age, df$pos / df$tot,
  cex = 0.05 * df$tot, pch = 16, xlab = "age",
  ylab = "seroprevalence", xlim = c(0, 72)
)

</code></pre>

<hr>
<h2 id='hcv_be_2006'>Hepatitis C serological data from Belgium in 2006 (line listing)</h2><span id='topic+hcv_be_2006'></span>

<h3>Description</h3>

<p>A study of HCV infection among injecting drug users. All injecting drug users
were interviewed by means of a standardized face-to-face interview and
information on their socio-demographic status, drug use history, drug use,
and related risk behavior was recorded
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hcv_be_2006
</code></pre>


<h3>Format</h3>

<p>A data frame with 3 variables:
</p>

<dl>
<dt>dur</dt><dd><p>Duration of injection/Exposure time (years)</p>
</dd>
<dt>seropositive</dt><dd><p>If the individual is seropositive or not</p>
</dd>
</dl>



<h3>Source</h3>

<p>Mathei, C., Shkedy, Z., Denis, B., Kabali, C., Aerts,
M., Molenberghs, G., Van Damme, P. and Buntinx, F. (2006), Evidence for
a substantial role of sharing of injecting paraphernalia other than
syringes/needles to the spread of hepatitis C among injecting drug users.
Journal of Viral Hepatitis, 13: 560-570.
<a href="https://doi.org/10.1111/j.1365-2893.2006.00725.x">doi:10.1111/j.1365-2893.2006.00725.x</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Reproduce Fig 4.3, p. 66
library(dplyr)
# snapping age to aggregated age group
# (credit: https://stackoverflow.com/a/12861810)
groups &lt;- c(0.5:24.5)
range &lt;- 0.5
low &lt;- findInterval(hcv_be_2006$dur, groups)
high &lt;- low + 1
low_diff &lt;- hcv_be_2006$dur - groups[ifelse(low == 0, NA, low)]
high_diff &lt;- groups[ifelse(high == 0, NA, high)] - hcv_be_2006$dur
mins &lt;- pmin(low_diff, high_diff, na.rm = TRUE)
pick &lt;- ifelse(!is.na(low_diff) &amp; mins == low_diff, low, high)
hcv_be_2006$dur &lt;- ifelse(
  mins &lt;= range + .Machine$double.eps, groups[pick], hcv_be_2006$dur
)
hcv_be_2006 &lt;- hcv_be_2006 %&gt;%
  group_by(dur) %&gt;%
  summarise(tot = n(), pos = sum(seropositive))

plot(
  hcv_be_2006$dur, hcv_be_2006$pos / hcv_be_2006$tot,
  cex = 0.1 * hcv_be_2006$tot, pch = 16,
  xlab = "duration of injection (years)",
  ylab = "seroprevalence", xlim = c(0, 25), ylim = c(0, 1)
)

</code></pre>

<hr>
<h2 id='hierarchical_bayesian_model'>Hierarchical Bayesian Model</h2><span id='topic+hierarchical_bayesian_model'></span>

<h3>Description</h3>

<p>Refers to section 10.3
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hierarchical_bayesian_model(
  age,
  pos = NULL,
  tot = NULL,
  status = NULL,
  type = "far3",
  chains = 1,
  warmup = 1500,
  iter = 5000
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="hierarchical_bayesian_model_+3A_age">age</code></td>
<td>
<p>the age vector</p>
</td></tr>
<tr><td><code id="hierarchical_bayesian_model_+3A_pos">pos</code></td>
<td>
<p>the positive count vector (optional if status is provided).</p>
</td></tr>
<tr><td><code id="hierarchical_bayesian_model_+3A_tot">tot</code></td>
<td>
<p>the total count vector (optional if status is provided).</p>
</td></tr>
<tr><td><code id="hierarchical_bayesian_model_+3A_status">status</code></td>
<td>
<p>the serostatus vector (optional if pos &amp; tot are provided).</p>
</td></tr>
<tr><td><code id="hierarchical_bayesian_model_+3A_type">type</code></td>
<td>
<p>type of model (&quot;far2&quot;, &quot;far3&quot; or &quot;log_logistic&quot;)</p>
</td></tr>
<tr><td><code id="hierarchical_bayesian_model_+3A_chains">chains</code></td>
<td>
<p>number of Markov chains</p>
</td></tr>
<tr><td><code id="hierarchical_bayesian_model_+3A_warmup">warmup</code></td>
<td>
<p>number of warmup runs</p>
</td></tr>
<tr><td><code id="hierarchical_bayesian_model_+3A_iter">iter</code></td>
<td>
<p>number of iterations</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of class hierarchical_bayesian_model with 6 items
</p>
<table role = "presentation">
<tr><td><code>datatype</code></td>
<td>
<p>type of datatype used for model fitting (aggregated or linelisting)</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>the dataframe used for fitting the model</p>
</td></tr>
<tr><td><code>type</code></td>
<td>
<p>type of bayesian model far2, far3 or log_logistic</p>
</td></tr>
<tr><td><code>info</code></td>
<td>
<p>parameters for the fitted model</p>
</td></tr>
<tr><td><code>sp</code></td>
<td>
<p>seroprevalence</p>
</td></tr>
<tr><td><code>foi</code></td>
<td>
<p>force of infection</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
df &lt;- mumps_uk_1986_1987
model &lt;- hierarchical_bayesian_model(age = df$age, pos = df$pos, tot = df$tot, type="far3")
model$info
plot(model)

</code></pre>

<hr>
<h2 id='lp_model'>A local polynomial model.</h2><span id='topic+lp_model'></span>

<h3>Description</h3>

<p>Refers to section 7.1. and 7.2.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lp_model(
  age,
  pos = NULL,
  tot = NULL,
  status = NULL,
  kern = "tcub",
  nn = 0,
  h = 0,
  deg = 2
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lp_model_+3A_age">age</code></td>
<td>
<p>the age vector.</p>
</td></tr>
<tr><td><code id="lp_model_+3A_pos">pos</code></td>
<td>
<p>the positive count vector (optional if status is provided).</p>
</td></tr>
<tr><td><code id="lp_model_+3A_tot">tot</code></td>
<td>
<p>the total count vector (optional if status is provided).</p>
</td></tr>
<tr><td><code id="lp_model_+3A_status">status</code></td>
<td>
<p>the serostatus vector (optional if pos &amp; tot are provided).</p>
</td></tr>
<tr><td><code id="lp_model_+3A_kern">kern</code></td>
<td>
<p>Weight function, default = &quot;tcub&quot;.
Other choices are &quot;rect&quot;, &quot;trwt&quot;, &quot;tria&quot;, &quot;epan&quot;, &quot;bisq&quot; and &quot;gauss&quot;.
Choices may be restricted when derivatives are required;
e.g. for confidence bands and some bandwidth selectors.</p>
</td></tr>
<tr><td><code id="lp_model_+3A_nn">nn</code></td>
<td>
<p>Nearest neighbor component of the smoothing parameter.
Default value is 0.7, unless either h is provided, in which case the default is 0.</p>
</td></tr>
<tr><td><code id="lp_model_+3A_h">h</code></td>
<td>
<p>The constant component of the smoothing parameter. Default: 0.</p>
</td></tr>
<tr><td><code id="lp_model_+3A_deg">deg</code></td>
<td>
<p>Degree of polynomial to use. Default: 2.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of class lp_model with 6 items
</p>
<table role = "presentation">
<tr><td><code>datatype</code></td>
<td>
<p>type of datatype used for model fitting (aggregated or linelisting)</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>the dataframe used for fitting the model</p>
</td></tr>
<tr><td><code>pi</code></td>
<td>
<p>fitted locfit object for pi</p>
</td></tr>
<tr><td><code>eta</code></td>
<td>
<p>fitted locfit object for eta</p>
</td></tr>
<tr><td><code>sp</code></td>
<td>
<p>seroprevalence</p>
</td></tr>
<tr><td><code>foi</code></td>
<td>
<p>force of infection</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>[locfit::locfit()] for more information on the fitted locfit object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>df &lt;- mumps_uk_1986_1987
model &lt;- lp_model(
  df$age, pos = df$pos, tot = df$tot,
  nn=0.7, kern="tcub"
  )
plot(model)

</code></pre>

<hr>
<h2 id='mixture_model'>Fit a mixture model to classify serostatus</h2><span id='topic+mixture_model'></span>

<h3>Description</h3>

<p>Refers to section 11.1 - 11.4
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mixture_model(
  antibody_level,
  breaks = 40,
  pi = c(0.2, 0.8),
  mu = c(2, 6),
  sigma = c(0.5, 1)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mixture_model_+3A_antibody_level">antibody_level</code></td>
<td>
<p>- vector of the corresponding raw antibody level</p>
</td></tr>
<tr><td><code id="mixture_model_+3A_breaks">breaks</code></td>
<td>
<p>- number of intervals which the antibody_level are grouped into</p>
</td></tr>
<tr><td><code id="mixture_model_+3A_pi">pi</code></td>
<td>
<p>- proportion of susceptible, infected</p>
</td></tr>
<tr><td><code id="mixture_model_+3A_mu">mu</code></td>
<td>
<p>- a vector of means of component distributions (vector of 2 numbers in ascending order)</p>
</td></tr>
<tr><td><code id="mixture_model_+3A_sigma">sigma</code></td>
<td>
<p>-  a vector of standard deviations of component distributions (vector of 2 number)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of class mixture_model with the following items
</p>
<table role = "presentation">
<tr><td><code>df</code></td>
<td>
<p>the dataframe used for fitting the model</p>
</td></tr>
<tr><td><code>info</code></td>
<td>
<p>list of 3 items parameters, distribution and constraints for the fitted model</p>
</td></tr>
<tr><td><code>susceptible</code></td>
<td>
<p>fitted distribution for susceptible</p>
</td></tr>
<tr><td><code>infected</code></td>
<td>
<p>fitted distribution for infected</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>df &lt;- vzv_be_2001_2003[vzv_be_2001_2003$age &lt; 40.5,]
data &lt;- df$VZVmIUml[order(df$age)]
model &lt;- mixture_model(antibody_level = data)
model$info
plot(model)
</code></pre>

<hr>
<h2 id='mseir_model'>MSEIR model</h2><span id='topic+mseir_model'></span>

<h3>Description</h3>

<p>Refers to section 3.4.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mseir_model(a, gamma, lambda, sigma, nu)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mseir_model_+3A_a">a</code></td>
<td>
<p>age sequence</p>
</td></tr>
<tr><td><code id="mseir_model_+3A_gamma">gamma</code></td>
<td>
<p>time in maternal class.</p>
</td></tr>
<tr><td><code id="mseir_model_+3A_lambda">lambda</code></td>
<td>
<p>time in susceptible class.</p>
</td></tr>
<tr><td><code id="mseir_model_+3A_sigma">sigma</code></td>
<td>
<p>time in latent class.</p>
</td></tr>
<tr><td><code id="mseir_model_+3A_nu">nu</code></td>
<td>
<p>time in infected class.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of class mseir_model with the following parameters
</p>
<table role = "presentation">
<tr><td><code>parameters</code></td>
<td>
<p>list of parameters used for fitting the model</p>
</td></tr>
<tr><td><code>output</code></td>
<td>
<p>matrix of proportion for each compartment over time</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>model &lt;- mseir_model(
  a=seq(from=1,to=20,length=500), # age range from 0 -&gt; 20 yo
  gamma=1/0.5, # 6 months in the maternal antibodies
  lambda=0.2,  # 5 years in the susceptible class
  sigma=26.07, # 14 days in the latent class
  nu=36.5      # 10 days in the infected class
)
model

</code></pre>

<hr>
<h2 id='mumps_uk_1986_1987'>Mumps serological data from the UK in 1986 and 1987 (aggregated)</h2><span id='topic+mumps_uk_1986_1987'></span>

<h3>Description</h3>

<p>a large survey of prevalence of antibodies to mumps and rubella viruses in
the UK. The survey, covering subjects from 1 to over 65 years of age,
provides information on the prevalence of antibody by age
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mumps_uk_1986_1987
</code></pre>


<h3>Format</h3>

<p>A data frame with 3 variables:
</p>

<dl>
<dt>age</dt><dd><p>Age group</p>
</dd>
<dt>pos</dt><dd><p>Number of seropositive individuals</p>
</dd>
<dt>tot</dt><dd><p>Total number of individuals surveyed</p>
</dd>
</dl>



<h3>Source</h3>

<p>Morgan-Capner P, Wright J, Miller C L, Miller E. Surveillance of
antibody to measles, mumps, and rubella by age. British Medical Journal
1988; 297 :770 <a href="https://doi.org/10.1136/bmj.297.6651.770">doi:10.1136/bmj.297.6651.770</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Reproduce Fig 4.4 (left panel), p. 67
age &lt;- mumps_uk_1986_1987$age
pos &lt;- mumps_uk_1986_1987$pos
tot &lt;- mumps_uk_1986_1987$tot
plot(age, pos / tot,
  cex = 0.008 * tot, pch = 16, xlab = "age", ylab = "seroprevalence",
  xlim = c(0, 45), ylim = c(0, 1)
)

</code></pre>

<hr>
<h2 id='parvob19_be_2001_2003'>Parvo B19 serological data from Belgium from 2001-2003 (line listing)</h2><span id='topic+parvob19_be_2001_2003'></span>

<h3>Description</h3>

<p>A seroprevalence survey testing for parvovirus B19 IgG antibody, performed on
large representative national serum banks in Belgium, England and Wales,
Finland, Italy, and Poland. The sera were collected between 1995 and 2004 and
were obtained from residual sera submitted for routine laboratory testing.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>parvob19_be_2001_2003
</code></pre>


<h3>Format</h3>

<p>A data frame with 5 variables:
</p>

<dl>
<dt>age</dt><dd><p>Age of individual</p>
</dd>
<dt>seropositive</dt><dd><p>If the individual is seropositive or not</p>
</dd>
<dt>year</dt><dd><p>Year surveyed</p>
</dd>
<dt>gender</dt><dd><p>Gender of individual</p>
</dd>
<dt>parvouml</dt><dd><p>Parvo B19 antibody units per ml</p>
</dd>
</dl>



<h3>Source</h3>

<p>MOSSONG, J., N. HENS, V. FRIEDERICHS, I. DAVIDKIN, M. BROMAN,
B. LITWINSKA, J. SIENNICKA, et al. &quot;Parvovirus B19 Infection in Five
European Countries: Seroepidemiology, Force of Infection and Maternal Risk
of Infection.&quot; Epidemiology and Infection 136, no. 8 (2008): 1059-68.
<a href="https://doi.org/10.1017/S0950268807009661">doi:10.1017/S0950268807009661</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Reproduce Fig 4.5 (left upper panel), p. 68
library(dplyr)
df &lt;- parvob19_be_2001_2003 %&gt;%
  group_by(age) %&gt;%
  summarise(pos = sum(seropositive), tot = n())
plot(df$age, df$pos / df$tot,
  cex = 0.02 * df$tot, pch = 16, xlab = "age", ylab = "seroprevalence",
  xlim = c(0, 82), ylim = c(0, 1)
)

</code></pre>

<hr>
<h2 id='parvob19_ew_1996'>Parvo B19 serological data from England and Wales in 1996 (line listing)</h2><span id='topic+parvob19_ew_1996'></span>

<h3>Description</h3>

<p>A seroprevalence survey testing for parvovirus B19 IgG antibody, performed on
large representative national serum banks in Belgium, England and Wales,
Finland, Italy, and Poland. The sera were collected between 1995 and 2004 and
were obtained from residual sera submitted for routine laboratory testing.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>parvob19_ew_1996
</code></pre>


<h3>Format</h3>

<p>A data frame with 5 variables:
</p>

<dl>
<dt>age</dt><dd><p>Age of individual</p>
</dd>
<dt>seropositive</dt><dd><p>If the individual is seropositive or not</p>
</dd>
<dt>year</dt><dd><p>Year surveyed</p>
</dd>
<dt>gender</dt><dd><p>Gender of individual</p>
</dd>
<dt>parvouml</dt><dd><p>Parvo B19 antibody units per ml</p>
</dd>
</dl>



<h3>Source</h3>

<p>MOSSONG, J., N. HENS, V. FRIEDERICHS, I. DAVIDKIN, M. BROMAN,
B. LITWINSKA, J. SIENNICKA, et al. &quot;Parvovirus B19 Infection in Five
European Countries: Seroepidemiology, Force of Infection and Maternal Risk
of Infection.&quot; Epidemiology and Infection 136, no. 8 (2008): 1059-68.
<a href="https://doi.org/10.1017/S0950268807009661">doi:10.1017/S0950268807009661</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Reproduce Fig 4.5 (right upper panel), p. 68
# NB: This figure will look different to that of in the book, since we
# believe that the original authors has made some errors in specifying
# the sample size of the dots.
library(dplyr)
df &lt;- parvob19_ew_1996 %&gt;%
  mutate(age = round(age)) %&gt;%
  group_by(age) %&gt;%
  summarise(pos = sum(seropositive), tot = n())
plot(df$age, df$pos / df$tot,
  cex = 0.02 * df$tot, pch = 16, xlab = "age", ylab = "seroprevalence",
  xlim = c(0, 82), ylim = c(0, 1)
)

</code></pre>

<hr>
<h2 id='parvob19_fi_1997_1998'>Parvo B19 serological data from Finland from 1997-1998 (line listing)</h2><span id='topic+parvob19_fi_1997_1998'></span>

<h3>Description</h3>

<p>A seroprevalence survey testing for parvovirus B19 IgG antibody, performed on
large representative national serum banks in Belgium, England and Wales,
Finland, Italy, and Poland. The sera were collected between 1995 and 2004 and
were obtained from residual sera submitted for routine laboratory testing.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>parvob19_fi_1997_1998
</code></pre>


<h3>Format</h3>

<p>A data frame with 5 variables:
</p>

<dl>
<dt>age</dt><dd><p>Age of individual</p>
</dd>
<dt>seropositive</dt><dd><p>If the individual is seropositive or not</p>
</dd>
<dt>year</dt><dd><p>Year surveyed</p>
</dd>
<dt>gender</dt><dd><p>Gender of individual</p>
</dd>
<dt>parvouml</dt><dd><p>Parvo B19 antibody units per ml</p>
</dd>
</dl>



<h3>Source</h3>

<p>MOSSONG, J., N. HENS, V. FRIEDERICHS, I. DAVIDKIN, M. BROMAN,
B. LITWINSKA, J. SIENNICKA, et al. &quot;Parvovirus B19 Infection in Five
European Countries: Seroepidemiology, Force of Infection and Maternal Risk
of Infection.&quot; Epidemiology and Infection 136, no. 8 (2008): 1059-68.
<a href="https://doi.org/10.1017/S0950268807009661">doi:10.1017/S0950268807009661</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Reproduce Fig 4.5 (left bottom panel), p. 68
# NB: This figure will look different to that of in the book, since we
# believe that the original authors has made some errors in specifying
# the sample size of the dots.
library(dplyr)
df &lt;- parvob19_fi_1997_1998 %&gt;%
  mutate(age = round(age)) %&gt;%
  group_by(age) %&gt;%
  summarise(pos = sum(seropositive), tot = n())
plot(df$age, df$pos / df$tot,
  cex = 0.07 * df$tot, pch = 16, xlab = "age", ylab = "seroprevalence",
  xlim = c(0, 82), ylim = c(0, 1)
)

</code></pre>

<hr>
<h2 id='parvob19_it_2003_2004'>Parvo B19 serological data from Italy from 2003-2004 (line listing)</h2><span id='topic+parvob19_it_2003_2004'></span>

<h3>Description</h3>

<p>A seroprevalence survey testing for parvovirus B19 IgG antibody, performed on
large representative national serum banks in Belgium, England and Wales,
Finland, Italy, and Poland. The sera were collected between 1995 and 2004 and
were obtained from residual sera submitted for routine laboratory testing.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>parvob19_it_2003_2004
</code></pre>


<h3>Format</h3>

<p>A data frame with 5 variables:
</p>

<dl>
<dt>age</dt><dd><p>Age of individual</p>
</dd>
<dt>seropositive</dt><dd><p>If the individual is seropositive or not</p>
</dd>
<dt>year</dt><dd><p>Year surveyed</p>
</dd>
<dt>gender</dt><dd><p>Gender of individual</p>
</dd>
<dt>parvouml</dt><dd><p>Parvo B19 antibody units per ml</p>
</dd>
</dl>



<h3>Source</h3>

<p>MOSSONG, J., N. HENS, V. FRIEDERICHS, I. DAVIDKIN, M. BROMAN,
B. LITWINSKA, J. SIENNICKA, et al. &quot;Parvovirus B19 Infection in Five
European Countries: Seroepidemiology, Force of Infection and Maternal Risk
of Infection.&quot; Epidemiology and Infection 136, no. 8 (2008): 1059-68.
<a href="https://doi.org/10.1017/S0950268807009661">doi:10.1017/S0950268807009661</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Reproduce Fig 4.5 (middle bottom panel), p. 68
# NB: This figure will look different to that of in the book, since we
# believe that the original authors has made some errors in specifying
# the sample size of the dots.
library(dplyr)
df &lt;- parvob19_it_2003_2004 %&gt;%
  group_by(age) %&gt;%
  summarise(pos = sum(seropositive), tot = n())
plot(df$age, df$pos / df$tot,
  cex = 0.07 * df$tot, pch = 16, xlab = "age", ylab = "seroprevalence",
  xlim = c(0, 82), ylim = c(0, 1)
)

</code></pre>

<hr>
<h2 id='parvob19_pl_1995_2004'>Parvo B19 serological data from Poland from 1995-2004 (line listing)</h2><span id='topic+parvob19_pl_1995_2004'></span>

<h3>Description</h3>

<p>A seroprevalence survey testing for parvovirus B19 IgG antibody, performed on
large representative national serum banks in Belgium, England and Wales,
Finland, Italy, and Poland. The sera were collected between 1995 and 2004 and
were obtained from residual sera submitted for routine laboratory testing.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>parvob19_pl_1995_2004
</code></pre>


<h3>Format</h3>

<p>A data frame with 5 variables:
</p>

<dl>
<dt>age</dt><dd><p>Age of individual</p>
</dd>
<dt>seropositive</dt><dd><p>If the individual is seropositive or not</p>
</dd>
<dt>year</dt><dd><p>Year surveyed</p>
</dd>
<dt>gender</dt><dd><p>Gender of individual</p>
</dd>
<dt>parvouml</dt><dd><p>Parvo B19 antibody units per ml</p>
</dd>
</dl>



<h3>Source</h3>

<p>MOSSONG, J., N. HENS, V. FRIEDERICHS, I. DAVIDKIN, M. BROMAN,
B. LITWINSKA, J. SIENNICKA, et al. &quot;Parvovirus B19 Infection in Five
European Countries: Seroepidemiology, Force of Infection and Maternal Risk
of Infection.&quot; Epidemiology and Infection 136, no. 8 (2008): 1059-68.
<a href="https://doi.org/10.1017/S0950268807009661">doi:10.1017/S0950268807009661</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Reproduce Fig 4.5 (right bottom panel), p. 68
# NB: This figure will look different to that of in the book, since we
# believe that the original authors has made some errors in specifying
# the sample size of the dots.
library(dplyr)
df &lt;- parvob19_pl_1995_2004 %&gt;%
  mutate(age = round(age)) %&gt;%
  group_by(age) %&gt;%
  summarise(pos = sum(seropositive), tot = n())
plot(df$age, df$pos / df$tot,
  cex = 0.07 * df$tot, pch = 16, xlab = "age", ylab = "seroprevalence",
  xlim = c(0, 82), ylim = c(0, 1)
)

</code></pre>

<hr>
<h2 id='pava'>Monotonize seroprevalence</h2><span id='topic+pava'></span>

<h3>Description</h3>

<p>Monotonize seroprevalence
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pava(pos = pos, tot = rep(1, length(pos)))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pava_+3A_pos">pos</code></td>
<td>
<p>the positive count vector.</p>
</td></tr>
<tr><td><code id="pava_+3A_tot">tot</code></td>
<td>
<p>the total count vector.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>computed list of 2 items pai1 for original values and pai2 for monotonized value
</p>

<hr>
<h2 id='penalized_spline_model'>Penalized Spline model</h2><span id='topic+penalized_spline_model'></span>

<h3>Description</h3>

<p>Penalized Spline model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>penalized_spline_model(
  age,
  pos = NULL,
  tot = NULL,
  status = NULL,
  s = "bs",
  link = "logit",
  framework = "pl",
  sp = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="penalized_spline_model_+3A_age">age</code></td>
<td>
<p>the age vector</p>
</td></tr>
<tr><td><code id="penalized_spline_model_+3A_pos">pos</code></td>
<td>
<p>the positive count vector (optional if status is provided).</p>
</td></tr>
<tr><td><code id="penalized_spline_model_+3A_tot">tot</code></td>
<td>
<p>the total count vector (optional if status is provided).</p>
</td></tr>
<tr><td><code id="penalized_spline_model_+3A_status">status</code></td>
<td>
<p>the serostatus vector (optional if pos &amp; tot are provided).</p>
</td></tr>
<tr><td><code id="penalized_spline_model_+3A_s">s</code></td>
<td>
<p>smoothing basis to use</p>
</td></tr>
<tr><td><code id="penalized_spline_model_+3A_link">link</code></td>
<td>
<p>link function to use</p>
</td></tr>
<tr><td><code id="penalized_spline_model_+3A_framework">framework</code></td>
<td>
<p>which approach to fit the model (&quot;pl&quot; for penalized likelihood framework, &quot;glmm&quot; for generalized linear mixed model framework)</p>
</td></tr>
<tr><td><code id="penalized_spline_model_+3A_sp">sp</code></td>
<td>
<p>smoothing parameter</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of class penalized_spline_model with 6 attributes
</p>
<table role = "presentation">
<tr><td><code>datatype</code></td>
<td>
<p>type of datatype used for model fitting (aggregated or linelisting)</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>the dataframe used for fitting the model</p>
</td></tr>
<tr><td><code>framework</code></td>
<td>
<p>either pl or glmm</p>
</td></tr>
<tr><td><code>info</code></td>
<td>
<p>fitted &quot;gam&quot; model when framework is pl or &quot;gamm&quot; model when framework is glmm</p>
</td></tr>
<tr><td><code>sp</code></td>
<td>
<p>seroprevalence</p>
</td></tr>
<tr><td><code>foi</code></td>
<td>
<p>force of infection</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>[mgcv::gam()], [mgcv::gamm()] for more information the fitted gam and gamm model
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- parvob19_be_2001_2003
model &lt;- penalized_spline_model(data$age, status = data$seropositive, framework="glmm")
model$info$gam
plot(model)
</code></pre>

<hr>
<h2 id='plot_gcv'>Plotting GCV values with respect to different nn-s and h-s parameters.</h2><span id='topic+plot_gcv'></span>

<h3>Description</h3>

<p>Refers to section 7.2.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_gcv(age, pos, tot, nn_seq, h_seq, kern = "tcub", deg = 2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_gcv_+3A_age">age</code></td>
<td>
<p>the age vector.</p>
</td></tr>
<tr><td><code id="plot_gcv_+3A_pos">pos</code></td>
<td>
<p>the pos vector.</p>
</td></tr>
<tr><td><code id="plot_gcv_+3A_tot">tot</code></td>
<td>
<p>the tot vector.#'</p>
</td></tr>
<tr><td><code id="plot_gcv_+3A_nn_seq">nn_seq</code></td>
<td>
<p>Nearest neighbor sequence.</p>
</td></tr>
<tr><td><code id="plot_gcv_+3A_h_seq">h_seq</code></td>
<td>
<p>Smoothing parameter sequence.</p>
</td></tr>
<tr><td><code id="plot_gcv_+3A_kern">kern</code></td>
<td>
<p>Weight function, default = &quot;tcub&quot;.
Other choices are &quot;rect&quot;, &quot;trwt&quot;, &quot;tria&quot;, &quot;epan&quot;, &quot;bisq&quot; and &quot;gauss&quot;.
Choices may be restricted when derivatives are required;
e.g. for confidence bands and some bandwidth selectors.</p>
</td></tr>
<tr><td><code id="plot_gcv_+3A_deg">deg</code></td>
<td>
<p>Degree of polynomial to use. Default: 2.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>plot of gcv value
</p>


<h3>Examples</h3>

<pre><code class='language-R'>df &lt;- mumps_uk_1986_1987
plot_gcv(
  df$age, df$pos, df$tot,
  nn_seq = seq(0.2, 0.8, by=0.1),
  h_seq = seq(5, 25, by=1)
)

</code></pre>

<hr>
<h2 id='plot.estimate_from_mixture'>plot() overloading for result of estimate_from_mixture</h2><span id='topic+plot.estimate_from_mixture'></span>

<h3>Description</h3>

<p>plot() overloading for result of estimate_from_mixture
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'estimate_from_mixture'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.estimate_from_mixture_+3A_x">x</code></td>
<td>
<p>the mixture_model</p>
</td></tr>
<tr><td><code id="plot.estimate_from_mixture_+3A_...">...</code></td>
<td>
<p>arbitrary params.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot object
</p>

<hr>
<h2 id='plot.farrington_model'>plot() overloading for Farrington model</h2><span id='topic+plot.farrington_model'></span>

<h3>Description</h3>

<p>plot() overloading for Farrington model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'farrington_model'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.farrington_model_+3A_x">x</code></td>
<td>
<p>the Farrington model object.</p>
</td></tr>
<tr><td><code id="plot.farrington_model_+3A_...">...</code></td>
<td>
<p>arbitrary params.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot object
</p>

<hr>
<h2 id='plot.fp_model'>plot() overloading for fractional polynomial model</h2><span id='topic+plot.fp_model'></span>

<h3>Description</h3>

<p>plot() overloading for fractional polynomial model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'fp_model'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.fp_model_+3A_x">x</code></td>
<td>
<p>the fractional polynomial model object.</p>
</td></tr>
<tr><td><code id="plot.fp_model_+3A_...">...</code></td>
<td>
<p>arbitrary params.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot object
</p>

<hr>
<h2 id='plot.hierarchical_bayesian_model'>plot() overloading for hierarchical_bayesian_model</h2><span id='topic+plot.hierarchical_bayesian_model'></span>

<h3>Description</h3>

<p>plot() overloading for hierarchical_bayesian_model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'hierarchical_bayesian_model'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.hierarchical_bayesian_model_+3A_x">x</code></td>
<td>
<p>hierarchical_bayesian_model object created by serosv.</p>
</td></tr>
<tr><td><code id="plot.hierarchical_bayesian_model_+3A_...">...</code></td>
<td>
<p>arbitrary params.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot object
</p>

<hr>
<h2 id='plot.lp_model'>plot() overloading for local polynomial model</h2><span id='topic+plot.lp_model'></span>

<h3>Description</h3>

<p>plot() overloading for local polynomial model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lp_model'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.lp_model_+3A_x">x</code></td>
<td>
<p>the local polynomial model object.</p>
</td></tr>
<tr><td><code id="plot.lp_model_+3A_...">...</code></td>
<td>
<p>arbitrary params.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot object
</p>

<hr>
<h2 id='plot.mixture_model'>plot() overloading for mixture model</h2><span id='topic+plot.mixture_model'></span>

<h3>Description</h3>

<p>plot() overloading for mixture model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mixture_model'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.mixture_model_+3A_x">x</code></td>
<td>
<p>the mixture_model</p>
</td></tr>
<tr><td><code id="plot.mixture_model_+3A_...">...</code></td>
<td>
<p>arbitrary params.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot object
</p>

<hr>
<h2 id='plot.mseir_model'>plot() overloading for MSEIR model</h2><span id='topic+plot.mseir_model'></span>

<h3>Description</h3>

<p>plot() overloading for MSEIR model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mseir_model'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.mseir_model_+3A_x">x</code></td>
<td>
<p>the mseir_model object.</p>
</td></tr>
<tr><td><code id="plot.mseir_model_+3A_...">...</code></td>
<td>
<p>arbitrary params.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot object
</p>

<hr>
<h2 id='plot.penalized_spline_model'>plot() overloading for penalized spline</h2><span id='topic+plot.penalized_spline_model'></span>

<h3>Description</h3>

<p>plot() overloading for penalized spline
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'penalized_spline_model'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.penalized_spline_model_+3A_x">x</code></td>
<td>
<p>the penalized_spline_model object</p>
</td></tr>
<tr><td><code id="plot.penalized_spline_model_+3A_...">...</code></td>
<td>
<p>arbitrary params.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot object
</p>

<hr>
<h2 id='plot.polynomial_model'>plot() overloading for polynomial model</h2><span id='topic+plot.polynomial_model'></span>

<h3>Description</h3>

<p>plot() overloading for polynomial model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'polynomial_model'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.polynomial_model_+3A_x">x</code></td>
<td>
<p>the polynomial model object</p>
</td></tr>
<tr><td><code id="plot.polynomial_model_+3A_...">...</code></td>
<td>
<p>arbitrary params.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot object
</p>

<hr>
<h2 id='plot.sir_basic_model'>plot() overloading for SIR model</h2><span id='topic+plot.sir_basic_model'></span>

<h3>Description</h3>

<p>plot() overloading for SIR model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'sir_basic_model'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.sir_basic_model_+3A_x">x</code></td>
<td>
<p>the sir_basic_model object.</p>
</td></tr>
<tr><td><code id="plot.sir_basic_model_+3A_...">...</code></td>
<td>
<p>arbitrary params.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot object
</p>

<hr>
<h2 id='plot.sir_static_model'>plot() overloading for SIR static model</h2><span id='topic+plot.sir_static_model'></span>

<h3>Description</h3>

<p>plot() overloading for SIR static model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'sir_static_model'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.sir_static_model_+3A_x">x</code></td>
<td>
<p>the sir_static_model object.</p>
</td></tr>
<tr><td><code id="plot.sir_static_model_+3A_...">...</code></td>
<td>
<p>arbitrary params.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot object
</p>

<hr>
<h2 id='plot.sir_subpops_model'>plot() overloading for SIR sub populations model</h2><span id='topic+plot.sir_subpops_model'></span>

<h3>Description</h3>

<p>plot() overloading for SIR sub populations model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'sir_subpops_model'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.sir_subpops_model_+3A_x">x</code></td>
<td>
<p>the sir_subpops_models object.</p>
</td></tr>
<tr><td><code id="plot.sir_subpops_model_+3A_...">...</code></td>
<td>
<p>arbitrary params.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of ggplot objects, each object is the plot for the corresponding subpopulation
</p>

<hr>
<h2 id='plot.weibull_model'>plot() overloading for Weibull model</h2><span id='topic+plot.weibull_model'></span>

<h3>Description</h3>

<p>plot() overloading for Weibull model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'weibull_model'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.weibull_model_+3A_x">x</code></td>
<td>
<p>the Weibull model object.</p>
</td></tr>
<tr><td><code id="plot.weibull_model_+3A_...">...</code></td>
<td>
<p>arbitrary params.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot object
</p>

<hr>
<h2 id='polynomial_model'>Polynomial models</h2><span id='topic+polynomial_model'></span>

<h3>Description</h3>

<p>Either 'status' (treated as line-listing dataset) or  'pos' &amp; 'tot' (treated as aggregated dataset) must be provided
</p>


<h3>Usage</h3>

<pre><code class='language-R'>polynomial_model(
  age,
  k,
  type,
  pos = NULL,
  tot = NULL,
  status = NULL,
  link = "log"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="polynomial_model_+3A_age">age</code></td>
<td>
<p>the age vector.</p>
</td></tr>
<tr><td><code id="polynomial_model_+3A_k">k</code></td>
<td>
<p>degree of the model.</p>
</td></tr>
<tr><td><code id="polynomial_model_+3A_type">type</code></td>
<td>
<p>name of method (Muench, Giffith, Grenfell).</p>
</td></tr>
<tr><td><code id="polynomial_model_+3A_pos">pos</code></td>
<td>
<p>the positive count vector (optional if status is provided).</p>
</td></tr>
<tr><td><code id="polynomial_model_+3A_tot">tot</code></td>
<td>
<p>the total count vector (optional if status is provided).</p>
</td></tr>
<tr><td><code id="polynomial_model_+3A_status">status</code></td>
<td>
<p>the serostatus vector (optional if pos &amp; tot are provided).</p>
</td></tr>
<tr><td><code id="polynomial_model_+3A_link">link</code></td>
<td>
<p>link function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Refers to section 6.1.1
</p>


<h3>Value</h3>

<p>a list of class polynomial_model with 5 items
</p>
<table role = "presentation">
<tr><td><code>datatype</code></td>
<td>
<p>type of datatype used for model fitting (aggregated or linelisting)</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>the dataframe used for fitting the model</p>
</td></tr>
<tr><td><code>info</code></td>
<td>
<p>fitted &quot;glm&quot; object</p>
</td></tr>
<tr><td><code>sp</code></td>
<td>
<p>seroprevalence</p>
</td></tr>
<tr><td><code>foi</code></td>
<td>
<p>force of infection</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- parvob19_fi_1997_1998[order(parvob19_fi_1997_1998$age), ]
aggregated &lt;- transform_data(data$age, data$seropositive)

# fit with aggregated data
model &lt;- polynomial_model(aggregated$t, pos = aggregated$pos, tot = aggregated$tot, type = "Muench")
# fit with linelisting data
model &lt;- polynomial_model(data$age, status = data$seropositive, type = "Muench")
plot(model)

</code></pre>

<hr>
<h2 id='rubella_mumps_uk'>Rubella - Mumps data from the UK (aggregated)</h2><span id='topic+rubella_mumps_uk'></span>

<h3>Description</h3>

<p>Rubella - Mumps data from the UK (aggregated)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rubella_mumps_uk
</code></pre>


<h3>Format</h3>

<p>A data frame with 5 variables:
</p>

<dl>
<dt>age</dt><dd><p>Age group</p>
</dd>
<dt>NN</dt><dd><p>Number of individuals negative to rubella and mumps</p>
</dd>
<dt>NP</dt><dd><p>Number of individuals negative to rubella and positive to mumps</p>
</dd>
<dt>PN</dt><dd><p>Number of individuals positive to rubella and negative to mumps</p>
</dd>
<dt>PP</dt><dd><p>Number of individuals positive to rubella and mumps</p>
</dd>
</dl>



<h3>Source</h3>

<p>Morgan-Capner P, Wright J, Miller C L, Miller E. Surveillance of
antibody to measles, mumps, and rubella by age. British Medical Journal
1988; 297 :770 <a href="https://doi.org/10.1136/bmj.297.6651.770">doi:10.1136/bmj.297.6651.770</a>
</p>

<hr>
<h2 id='rubella_uk_1986_1987'>Rubella serological data from the UK in 1986 and 1987 (aggregated)</h2><span id='topic+rubella_uk_1986_1987'></span>

<h3>Description</h3>

<p>Prevalence of rubella in the UK, obtained from a large survey of prevalence
of antibodies to both mumps and rubella viruses.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rubella_uk_1986_1987
</code></pre>


<h3>Format</h3>

<p>A data frame with 3 variables:
</p>

<dl>
<dt>age</dt><dd><p>Age group</p>
</dd>
<dt>pos</dt><dd><p>Number of seropositive individuals</p>
</dd>
<dt>tot</dt><dd><p>Total number of individuals surveyed</p>
</dd>
</dl>



<h3>Source</h3>

<p>Morgan-Capner P, Wright J, Miller C L, Miller E. Surveillance of
antibody to measles, mumps, and rubella by age. British Medical Journal
1988; 297 :770 <a href="https://doi.org/10.1136/bmj.297.6651.770">doi:10.1136/bmj.297.6651.770</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Reproduce Fig 4.4 (middle panel), p. 67
age &lt;- rubella_uk_1986_1987$age
pos &lt;- rubella_uk_1986_1987$pos
tot &lt;- rubella_uk_1986_1987$tot
plot(age, pos / tot,
  cex = 0.008 * tot, pch = 16, xlab = "age", ylab = "seroprevalence",
  xlim = c(0, 45), ylim = c(0, 1)
)

</code></pre>

<hr>
<h2 id='set_plot_style'>Helper to adjust styling of a plot</h2><span id='topic+set_plot_style'></span>

<h3>Description</h3>

<p>Helper to adjust styling of a plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>set_plot_style(
  sero = "blueviolet",
  ci = "royalblue1",
  foi = "#fc0328",
  sero_line = "solid",
  foi_line = "dashed",
  xlabel = "Age"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="set_plot_style_+3A_sero">sero</code></td>
<td>
<p>- color for seroprevalence line</p>
</td></tr>
<tr><td><code id="set_plot_style_+3A_ci">ci</code></td>
<td>
<p>- color for confidence interval</p>
</td></tr>
<tr><td><code id="set_plot_style_+3A_foi">foi</code></td>
<td>
<p>- color for force of infection line</p>
</td></tr>
<tr><td><code id="set_plot_style_+3A_sero_line">sero_line</code></td>
<td>
<p>- linetype for seroprevalence line</p>
</td></tr>
<tr><td><code id="set_plot_style_+3A_foi_line">foi_line</code></td>
<td>
<p>- linetype for force of infection line</p>
</td></tr>
<tr><td><code id="set_plot_style_+3A_xlabel">xlabel</code></td>
<td>
<p>- x label</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of updated aesthetic values
</p>

<hr>
<h2 id='sir_basic_model'>Basic SIR model</h2><span id='topic+sir_basic_model'></span>

<h3>Description</h3>

<p>Refers to section 3.1.3.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sir_basic_model(times, state, parameters)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sir_basic_model_+3A_times">times</code></td>
<td>
<p>time sequence.</p>
</td></tr>
<tr><td><code id="sir_basic_model_+3A_state">state</code></td>
<td>
<p>the initial state of the model.</p>
</td></tr>
<tr><td><code id="sir_basic_model_+3A_parameters">parameters</code></td>
<td>
<p>the parameters of the model.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In <code>state</code>:
</p>
<p>- <code>S</code>: number of susceptible
</p>
<p>- <code>I</code>: number of infected
</p>
<p>- <code>R</code>: number of recovered
</p>
<p>In <code>parameters</code>:
</p>
<p>- <code>alpha</code>: disease-related death rate
</p>
<p>- <code>mu</code>: natural death rate (= 1/life expectancy)
</p>
<p>- <code>beta</code>: transmission rate
</p>
<p>- <code>nu</code>: recovery rate
</p>
<p>- <code>p</code>: percent of population vaccinated at birth
</p>


<h3>Value</h3>

<p>list of class sir_basic_model with the following items
</p>
<table role = "presentation">
<tr><td><code>parameters</code></td>
<td>
<p>list of parameters used for fitting the model</p>
</td></tr>
<tr><td><code>output</code></td>
<td>
<p>matrix of population for each compartment over time</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>state &lt;- c(S=4999, I=1, R=0)
parameters &lt;- c(
  mu=1/75, # 1 divided by life expectancy (75 years old)
  alpha=0, # no disease-related death
  beta=0.0005, # transmission rate
  nu=1, # 1 year for infected to recover
  p=0 # no vaccination at birth
)
times &lt;- seq(0, 250, by=0.1)
model &lt;- sir_basic_model(times, state, parameters)
model

</code></pre>

<hr>
<h2 id='sir_static_model'>SIR static model (age-heterogeneous, endemic equilibrium)</h2><span id='topic+sir_static_model'></span>

<h3>Description</h3>

<p>Refers to section 3.2.2.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sir_static_model(a, state, parameters)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sir_static_model_+3A_a">a</code></td>
<td>
<p>age sequence.</p>
</td></tr>
<tr><td><code id="sir_static_model_+3A_state">state</code></td>
<td>
<p>the initial state of the system.</p>
</td></tr>
<tr><td><code id="sir_static_model_+3A_parameters">parameters</code></td>
<td>
<p>the model's parameter.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In <code>state</code>:
</p>
<p>- <code>s</code>: proportion susceptible
</p>
<p>- <code>i</code>: proportion infected
</p>
<p>- <code>r</code>: proportion recovered
</p>
<p>In <code>parameters</code>:
</p>
<p>- <code>lambda</code>: natural death rate
</p>
<p>- <code>nu</code>: recovery rate
</p>


<h3>Value</h3>

<p>list of class sir_static_model with the following items
</p>
<table role = "presentation">
<tr><td><code>parameters</code></td>
<td>
<p>list of parameters used for fitting the model</p>
</td></tr>
<tr><td><code>output</code></td>
<td>
<p>matrix of proportion for each compartment over time</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>state &lt;- c(s=0.99,i=0.01,r=0)
parameters &lt;- c(
  lambda = 0.05,
  nu=1/(14/365) # 2 weeks to recover
)
ages&lt;-seq(0, 90, by=0.01)
model = sir_static_model(ages, state, parameters)
model

</code></pre>

<hr>
<h2 id='sir_subpops_model'>SIR Model with Interacting Subpopulations</h2><span id='topic+sir_subpops_model'></span>

<h3>Description</h3>

<p>Refers to section 3.5.1.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sir_subpops_model(times, state, parameters)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sir_subpops_model_+3A_times">times</code></td>
<td>
<p>time sequence.</p>
</td></tr>
<tr><td><code id="sir_subpops_model_+3A_state">state</code></td>
<td>
<p>the initial state of the model.</p>
</td></tr>
<tr><td><code id="sir_subpops_model_+3A_parameters">parameters</code></td>
<td>
<p>the parameters of the model.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In <code>state</code>:
</p>
<p>- <code>s</code>: Percent susceptible
</p>
<p>- <code>i</code>: Percent infected
</p>
<p>- <code>r</code>: Percent recovered
</p>
<p>In <code>parameters</code>:
</p>
<p>- <code>mu</code>: natural death rate (1/L).
</p>
<p>- <code>beta</code>: transmission rate w.r.t population (beta tilde)
</p>
<p>- <code>nu</code>: recovery rate
</p>
<p>- <code>k</code>: number of subpopulations
</p>


<h3>Value</h3>

<p>list of class sir_subpops_model with the following items
</p>
<table role = "presentation">
<tr><td><code>parameters</code></td>
<td>
<p>list of parameters used for fitting the model</p>
</td></tr>
<tr><td><code>output</code></td>
<td>
<p>matrix of proportion for each compartment over time</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
k &lt;- 2
state &lt;- c(
  s = c(0.8, 0.8),
  i = c(0.2, 0.2),
  r = c(  0,   0)
)
beta_matrix &lt;- c(
  c(0.05, 0.00),
  c(0.00, 0.05)
)
parameters &lt;- list(
  beta = matrix(beta_matrix, nrow=k, ncol=k, byrow=TRUE),
  nu = c(1/30, 1/30),
  mu = 0.001,
  k = k
)
times&lt;-seq(0,10000,by=0.5)
model &lt;- sir_subpops_model(times, state, parameters)
model


</code></pre>

<hr>
<h2 id='tb_nl_1966_1973'>Tuberculosis serological data from the Netherlands 1966-1973 (aggregated)</h2><span id='topic+tb_nl_1966_1973'></span>

<h3>Description</h3>

<p>A study of tuberculosis conducted in the Netherlands. Schoolchildren, aged
between 6 and 18 years, were tested using the tuberculin skin test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tb_nl_1966_1973
</code></pre>


<h3>Format</h3>

<p>A data frame with 5 variables:
</p>

<dl>
<dt>age</dt><dd><p>Age group</p>
</dd>
<dt>pos</dt><dd><p>Number of seropositive individuals</p>
</dd>
<dt>tot</dt><dd><p>Total number of individuals surveyed</p>
</dd>
<dt>gender</dt><dd><p>Gender of cohort (unsure what 0 and 1 means)</p>
</dd>
<dt>birthyr</dt><dd><p>Birth year of cohort</p>
</dd>
</dl>



<h3>Source</h3>

<p>Nagelkerke, N., Heisterkamp, S., Borgdorff, M., Broekmans, J. and
Van Houwelingen, H. (1999), Semi-parametric estimation of age-time specific
infection incidence from serial prevalence data. Statist. Med., 18: 307-320.
<a href="https://doi.org/10.1002/%28SICI%291097-0258%2819990215%2918%3A3%3C307%3A%3AAID-SIM15%3E3.0.CO%3B2-Z">doi:10.1002/(SICI)1097-0258(19990215)18:3&lt;307::AID-SIM15&gt;3.0.CO;2-Z</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Reproduce Fig 4.6, p.70
age &lt;- tb_nl_1966_1973$age
birthyr &lt;- tb_nl_1966_1973$birthyr
pos &lt;- tb_nl_1966_1973$pos
tot &lt;- tb_nl_1966_1973$tot
# left panel
plot(age, pos / tot,
  pch = 16, cex = 0.00005 * tot, xlab = "age",
  ylab = "prevalence", xlim = c(6, 18)
)
# right panel
plot(birthyr, pos / tot,
  pch = 16, cex = 0.00005 * tot, xlab = "year", ylab = "prevalence"
)

</code></pre>

<hr>
<h2 id='transform_data'>Generate a dataframe with 't', 'pos' and 'tot' columns from
't' and 'seropositive' vectors.</h2><span id='topic+transform_data'></span>

<h3>Description</h3>

<p>Generate a dataframe with 't', 'pos' and 'tot' columns from
't' and 'seropositive' vectors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>transform_data(t, spos)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="transform_data_+3A_t">t</code></td>
<td>
<p>the time vector.</p>
</td></tr>
<tr><td><code id="transform_data_+3A_spos">spos</code></td>
<td>
<p>the seropositive vector.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>dataframe in aggregated format
</p>


<h3>Examples</h3>

<pre><code class='language-R'>df &lt;- hcv_be_2006
hcv_df &lt;- transform_data(df$dur, df$seropositive)
hcv_df

</code></pre>

<hr>
<h2 id='vzv_be_1999_2000'>VZV serological data from Belgium (Flanders) from 1999-2000 (aggregated)</h2><span id='topic+vzv_be_1999_2000'></span>

<h3>Description</h3>

<p>Age-specific seroprevalence of VZV antibodies, assessed in Flanders (Belgium)
between October 1999 and April 2000. This population was stratified by age
in order to obtain approximately 100 observations per age group.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vzv_be_1999_2000
</code></pre>


<h3>Format</h3>

<p>A data frame with 3 variables:
</p>

<dl>
<dt>age</dt><dd><p>Age group</p>
</dd>
<dt>pos</dt><dd><p>Number of seropositive individuals</p>
</dd>
<dt>tot</dt><dd><p>Total number of individuals surveyed</p>
</dd>
</dl>



<h3>Source</h3>

<p>Thiry, N., Beutels, P., Shkedy, Z. et al. The seroepidemiology
of primary varicella-zoster virus infection in Flanders (Belgium).
Eur J Pediatr 161, 588-593 (2002).
<a href="https://doi.org/10.1007/s00431-002-1053-2">doi:10.1007/s00431-002-1053-2</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Reproduce Fig 4.7 (left panel), p.71
age &lt;- vzv_be_1999_2000$age
pos &lt;- vzv_be_1999_2000$pos
tot &lt;- vzv_be_1999_2000$tot
plot(age, pos / tot,
  cex = 0.036 * tot, pch = 19, xlab = "age", ylab = "seroprevalence",
  xlim = c(0, 45), ylim = c(0, 1)
)

</code></pre>

<hr>
<h2 id='vzv_be_2001_2003'>VZV serological data from Belgium from 2001-2003 (line listing)</h2><span id='topic+vzv_be_2001_2003'></span>

<h3>Description</h3>

<p>The survey is the same as the one used to study the seroprevalence of
parvovirus B19 in Belgium, as described above.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vzv_be_2001_2003
</code></pre>


<h3>Format</h3>

<p>A data frame with 4 variables:
</p>

<dl>
<dt>age</dt><dd><p>Age of individual</p>
</dd>
<dt>seropositive</dt><dd><p>If the individual is seropositive or not</p>
</dd>
<dt>gender</dt><dd><p>Gender of individual</p>
</dd>
<dt>VZVmIUml</dt><dd><p>VZV milli international units per ml</p>
</dd>
</dl>



<h3>Source</h3>

<p>MOSSONG, J., N. HENS, V. FRIEDERICHS, I. DAVIDKIN, M. BROMAN,
B. LITWINSKA, J. SIENNICKA, et al. &quot;Parvovirus B19 Infection in Five
European Countries: Seroepidemiology, Force of Infection and Maternal Risk
of Infection.&quot; Epidemiology and Infection 136, no. 8 (2008): 1059-68.
<a href="https://doi.org/10.1017/S0950268807009661">doi:10.1017/S0950268807009661</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Reproduce Fig 4.7 (right panel), p.71
library(dplyr)
df &lt;- vzv_be_2001_2003 %&gt;%
  mutate(age = round(age)) %&gt;%
  group_by(age) %&gt;%
  summarise(pos = sum(seropositive), tot = n())
plot(df$age, df$pos / df$tot,
  cex = 0.036 * df$tot, pch = 19, xlab = "age", ylab = "seroprevalence",
  xlim = c(0, 45), ylim = c(0, 1)
)

</code></pre>

<hr>
<h2 id='vzv_parvo_be'>VZV and Parvovirus B19 serological data in Belgium (line listing)</h2><span id='topic+vzv_parvo_be'></span>

<h3>Description</h3>

<p>VZV and Parvovirus B19 serological data in Belgium (line listing)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vzv_parvo_be
</code></pre>


<h3>Format</h3>

<p>A data frame with 7 variables:
</p>

<dl>
<dt>id</dt><dd><p>ID of individual</p>
</dd>
<dt>age</dt><dd><p>Age of individual</p>
</dd>
<dt>gender</dt><dd><p>Gender of individual</p>
</dd>
<dt>parvouml</dt><dd><p>Parvo B19 antibody units per ml</p>
</dd>
<dt>parvo_res</dt><dd><p>If an individual is positive for parvovirus B19</p>
</dd>
<dt>VZVmUIml</dt><dd><p>VZV milli international units per ml</p>
</dd>
<dt>vzv_res</dt><dd><p>If an individual is positive for VZV</p>
</dd>
</dl>



<h3>Source</h3>

<p>MOSSONG, J., N. HENS, V. FRIEDERICHS, I. DAVIDKIN, M. BROMAN,
B. LITWINSKA, J. SIENNICKA, et al. &quot;Parvovirus B19 Infection in Five
European Countries: Seroepidemiology, Force of Infection and Maternal Risk
of Infection.&quot; Epidemiology and Infection 136, no. 8 (2008): 1059-68.
<a href="https://doi.org/10.1017/S0950268807009661">doi:10.1017/S0950268807009661</a>
</p>

<hr>
<h2 id='weibull_model'>The Weibull model.</h2><span id='topic+weibull_model'></span>

<h3>Description</h3>

<p>Refers to section 6.1.2.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>weibull_model(t, status = NULL, pos = NULL, tot = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="weibull_model_+3A_t">t</code></td>
<td>
<p>the time vector.</p>
</td></tr>
<tr><td><code id="weibull_model_+3A_status">status</code></td>
<td>
<p>the serostatus vector (optional if pos &amp; tot are provided).</p>
</td></tr>
<tr><td><code id="weibull_model_+3A_pos">pos</code></td>
<td>
<p>the positive count vector (optional if status is provided).</p>
</td></tr>
<tr><td><code id="weibull_model_+3A_tot">tot</code></td>
<td>
<p>the total count vector (optional if status is provided).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of class weibull_model with the following items
</p>
<table role = "presentation">
<tr><td><code>datatype</code></td>
<td>
<p>type of datatype used for model fitting (aggregated or linelisting)</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>the dataframe used for fitting the model</p>
</td></tr>
<tr><td><code>info</code></td>
<td>
<p>fitted &quot;glm&quot; object</p>
</td></tr>
<tr><td><code>sp</code></td>
<td>
<p>seroprevalence</p>
</td></tr>
<tr><td><code>foi</code></td>
<td>
<p>force of infection</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>[stats::glm()] for more information on the fitted &quot;glm&quot; object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>df &lt;- hcv_be_2006[order(hcv_be_2006$dur), ]
model &lt;- weibull_model(
  t=df$dur,
  status=df$seropositive
  )
plot(model)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
