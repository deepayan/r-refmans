<!DOCTYPE html><html lang="en"><head><title>Help for package frailtyHL</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {frailtyHL}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#frailtyHL-package'><p>H-likelihood Approach for Frailty Models</p></a></li>
<li><a href='#bladder'><p>Bladder Cancer Data</p></a></li>
<li><a href='#bladder0'><p>Bladder cancer data</p></a></li>
<li><a href='#cgd'><p>Chronic Granulomatous Disease (CGD) Infection Data</p></a></li>
<li><a href='#CmpRsk'><p>Model Formula of Competing Risk</p></a></li>
<li><a href='#frailty.vs'><p>Penalized Variable Selection for Frailty Models</p></a></li>
<li><a href='#frailtyHL'><p>Fitting Frailty Models using H-likelihood Approach</p></a></li>
<li><a href='#hlike.frailty'><p>Competing Risk Frialty Models using H-Likelihood</p></a></li>
<li><a href='#jmfit'><p>Joint Modelling of Longitudinal and Time-to-Event Data</p></a></li>
<li><a href='#jointmodeling'><p>Defining the Fixed and Random Models for the Mean and Dispersion Parameters in Joint Models</p></a></li>
<li><a href='#kidney'><p>Kidney Infection Data</p></a></li>
<li><a href='#mlmfit'><p>Accelerated Failure Time (AFT) Models with Random Effects</p></a></li>
<li><a href='#rats'><p>Rats data</p></a></li>
<li><a href='#ren'><p>Mammary tumor data</p></a></li>
<li><a href='#renal'><p>Renal transplant data</p></a></li>
<li><a href='#test'><p>Simulated data with clustered competing risks</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Frailty Models via Hierarchical Likelihood</td>
</tr>
<tr>
<td>Version:</td>
<td>2.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-11-19</td>
</tr>
<tr>
<td>Author:</td>
<td>Il Do Ha, Maengseok Noh, Jiwoong Kim, Youngjo Lee</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Maengseok Noh &lt;msnoh@pknu.ac.kr&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements the h-likelihood estimation procedures for general frailty models including competing-risk models and joint models.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), methods, Matrix, survival, cmprsk</td>
</tr>
<tr>
<td>License:</td>
<td>Unlimited</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-11-22 06:19:35 UTC; Noh</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-11-22 09:00:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='frailtyHL-package'>H-likelihood Approach for Frailty Models</h2><span id='topic+frailtyHL-package'></span>

<h3>Description</h3>

<p>The frailtyHL package fits frailty models which are Cox's proportional hazards models incorporating
random effects. The function implements the h-likelihood estimation procedures. For the frailty
distribution lognormal and gamma are allowed. The h-likelihood uses the Laplace approximation
when the numerical integration is intractable, giving a statistically efficient estimation in frailty
models. (Ha, Lee and Song, 2001; Ha and Lee, 2003, 2005; Lee, Nelder and Pawitan, 2017; Ha, Jeong and Lee, 2017).
This package handles various random-effect survival models such as time-dependent frailties, 
competing-risk frailty models, AFT random-effect models, and joint modelling of linear mixed models and frailty models.
It also provides penalized variable-selection procedures (LASSO, SCAD and HL).</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> frailtyHL</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 2.1</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2016-09-19</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> Unlimited</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>This is version 2.2 of the frailtyHL package.
</p>


<h3>Author(s)</h3>

<p>Il Do Ha, Maengseok Noh, Jiwoong Kim, Youngjo Lee
</p>
<p>Maintainer: Maengseok Noh &lt;msnoh@pknu.ac.kr&gt;
</p>


<h3>References</h3>

<p>Ha, I. D. and Lee, Y. (2003). Estimating frailty models via Poisson Hierarchical generalized linear
models. Journal of Computational and Graphical Statistics, 12, 663-681.
</p>
<p>Ha, I. D. and Lee, Y. (2005). Comparison of hierarchical likelihood versus orthodox best linear
unbiased predictor approaches for frailty models. Biometrika, 92, 717-723.
</p>
<p>Ha, I. D., Lee, Y. and Song, J. K. (2001). Hierarchical likelihood approach for frailty models.
Biometrika, 88, 233-243.
</p>
<p>Ha, I. D., Jeong, J. and Lee, Y. (2017). Statistical modelling of survival data with random effects.
Springer.
</p>
<p>Lee, Y., Nelder, J. A. and Pawitan, Y. (2017). Generalised linear models with random effects:
unified analysis via h-likelihood. 2nd Edition. Chapman and Hall: London.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(kidney)
kidney_g12&lt;-frailtyHL(Surv(time,status)~sex+age+(1|id),kidney)
</code></pre>

<hr>
<h2 id='bladder'>Bladder Cancer Data</h2><span id='topic+bladder'></span>

<h3>Description</h3>

<p>Bladder is an extension of Bladder0 to competing risks with 396 patients with
bladder cancer from 21 centers, focusing on two competing endpoints, i.e, time to
first bladder recurrence (an event of interest; Type 1 event) and time to death prior
to recurrence (competing event; Type 2 event).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("bladder")</code></pre>


<h3>Format</h3>

<p>A data frame with 396 observations on the following 13 variables.
</p>

<dl>
<dt><code>OBS</code></dt><dd><p>Observation number</p>
</dd>
<dt><code>center</code></dt><dd><p>Institution number of 24 centers</p>
</dd>
<dt><code>surtime</code></dt><dd><p>Time to event</p>
</dd>
<dt><code>status</code></dt><dd><p>Event indicator(1=recurrence, 2=death before recurrence, 0=no event)</p>
</dd>
<dt><code>CHEMO</code></dt><dd><p>Treatment indicator representing chemotherapy(0=No, 1=Yes)</p>
</dd>
<dt><code>AGE</code></dt><dd><p>Age(0, &lt;= 65 years; 1, &gt; 65 years)</p>
</dd>
<dt><code>SEX</code></dt><dd><p>Sex(0=male, 1=female)</p>
</dd>
<dt><code>PRIORREC</code></dt><dd><p>Prior recurrent rate(0, primary; 1, &lt;= 1/yr; 2, &gt; 1/yr)</p>
</dd>
<dt><code>NOTUM</code></dt><dd><p>Number of tumors(0, single; 1, 2-7 tumors; 2, &gt;= 8 tumors)</p>
</dd>
<dt><code>TUM3CM</code></dt><dd><p>Tumor size(0, &lt; 3cm; 1, &gt;= cm)</p>
</dd>
<dt><code>TLOCC</code></dt><dd><p>T cotegory(0=Ta, 1=T1)</p>
</dd>
<dt><code>CIS</code></dt><dd><p>Carcinoma in situ (0=No, 1=Yes)</p>
</dd>
<dt><code>GLOCAL</code></dt><dd><p>G grage(0=G1, 1=G2, 2=G3)</p>
</dd>
</dl>



<h3>References</h3>

<p>Sylvester, R., van der Meijden, A.P.M., Oosterlinck, W., Witjes, J., Bouffioux, C., Denis, L., Newling, D.W.W. and Kurth, K. (2006).
Predicting recurrence and progression in individual patients with stage Ta T1 bladder cancer using EORTC risk tables: a combined analysis of
2596 patients from seven EORTC trials. European Urology, 49, 466-477.
</p>
<p>Ha, I.D., Sylvester, R., Legrand, C. and MacKenzie, G. (2011).
Frailty modelling for survival data from multi-centre clinical trials. Statistics in Medicine, 30, 28-37.
</p>

<hr>
<h2 id='bladder0'>Bladder cancer data</h2><span id='topic+bladder0'></span>

<h3>Description</h3>

<p>Bladder0 is a subset of 410 patients from a full data set with bladder cancer
from 21 centers that participated in the EORTC trial
(Sylvester et al., 2006). Time to event is the duration of the disease free
interval (DFI), which is defined as time from randomization to the date of
the first recurrence.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("bladder0")</code></pre>


<h3>Format</h3>

<p>A data frame with 410 observations on the following 5 variables.
</p>

<dl>
<dt><code>Center</code></dt><dd><p>Institution number of 24 centers</p>
</dd>
<dt><code>Surtime</code></dt><dd><p>Time to the first recurrence from randomization</p>
</dd>
<dt><code>Status</code></dt><dd><p>Censoring indicator(1=recurrence, 0=no event)</p>
</dd>
<dt><code>Chemo</code></dt><dd><p>Treatment indicator representing chemotherapy(0=No, 1=Yes)</p>
</dd>
<dt><code>Tustat</code></dt><dd><p>Indicator representing prior recurrent rate(0=Primary, 1=Recurrent)</p>
</dd>
</dl>



<h3>References</h3>

<p>Sylvester, R., van der Meijden, A.P.M., Oosterlinck, W., Witjes, J., Bouffioux, C., Denis, L., Newling, D.W.W. and Kurth, K. (2006).
Predicting recurrence and progression in individual patients with stage Ta T1 bladder cancer using EORTC risk tables: a combined analysis of
2596 patients from seven EORTC trials. European Urology, 49, 466-477.
</p>
<p>Ha, I.D., Sylvester, R., Legrand, C. and MacKenzie, G. (2011).
Frailty modelling for survival data from multi-centre clinical trials. Statistics in Medicine, 30, 28-37.
</p>

<hr>
<h2 id='cgd'>Chronic Granulomatous Disease (CGD) Infection Data</h2><span id='topic+cgd'></span>

<h3>Description</h3>

<p>The CGD data set in Fleming and Harrington (1991) is from a placebo-controlled randomized trial
of gamma interferon in chronic granulomatous disease. In total, 128 patients from 13 hospitals
were followed for about 1 year. The number of patients per hospital ranged from 4 to 26. Each
patient may experience more than one infection. The survival times (times-to-event) are the times
between recurrent CGD infections on each patient (i.e. gap times). Censoring occurred at the last
observation for all patients, except one, who experienced a serious infection on the date he left the
study.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("cgd")</code></pre>


<h3>Format</h3>

<p>A data frame with 203 observations on the following 16 variables.
</p>

<dl>
<dt><code>id</code></dt><dd><p>Patient number for 128 patients</p>
</dd>
<dt><code>center</code></dt><dd><p>Enrolling center number for 13 hospitals</p>
</dd>
<dt><code>random</code></dt><dd><p>Date of randomization</p>
</dd>
<dt><code>treat</code></dt><dd><p>Gamma-interferon treatment(rIFN-g) or placebo(Placebo)</p>
</dd>
<dt><code>sex</code></dt><dd><p>Sex of each patient(male, female)</p>
</dd>
<dt><code>age</code></dt><dd><p>Age of each patient at study entry, in years</p>
</dd>
<dt><code>height</code></dt><dd><p>Height of each patient at study entry, in cm</p>
</dd>
<dt><code>weight</code></dt><dd><p>Weight of each patient at study entry, in kg</p>
</dd>
<dt><code>inherit</code></dt><dd><p>Pattern of inheritance (autosomal recessive, X-linked)</p>
</dd>
<dt><code>steroids</code></dt><dd><p>Using corticosteroids at times of study centry(1=Yes, 0=No)</p>
</dd>
<dt><code>propylac</code></dt><dd><p>Using prophylactic antibiotics at time of study entry(1=Yes, 0=No)</p>
</dd>
<dt><code>hos.cat</code></dt><dd><p>A categorization of the hospital region into 4 groups</p>
</dd>
<dt><code>tstart</code></dt><dd><p>Start of each time interval</p>
</dd>
<dt><code>enum</code></dt><dd><p>Sequence number. For each patient, the infection records are in sequnce number order</p>
</dd>
<dt><code>tstop</code></dt><dd><p>End of each time interval</p>
</dd>
<dt><code>status</code></dt><dd><p>Censoring indicator (1=uncensored, 0=censored)</p>
</dd>
</dl>



<h3>References</h3>

<p>Fleming, T. R. and Harrington, D. R. (1991). Counting processes and survival analysis. Wiley:
New York.
</p>
<p>Therneasu, T. (2012). survival: survival analysis, including penalised likelihood. http://CRAN.Rproject.
org/package=survival. R pakcage version 2.36-14.
</p>

<hr>
<h2 id='CmpRsk'>Model Formula of Competing Risk </h2><span id='topic+CmpRsk'></span>

<h3>Description</h3>

<p>A CmpRsk object is used as the response variable in the model formula. It is created using
the function CmpRsk(time, index), where time is the event time and index is an event indicator.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CmpRsk(time, index)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="CmpRsk_+3A_time">time</code></td>
<td>
<p>the event time</p>
</td></tr>
<tr><td><code id="CmpRsk_+3A_index">index</code></td>
<td>
<p>the event indicator;
values of index must be sequential whole numbers where 0 denotes right censoring
and positive numbers refer to different event types.</p>
</td></tr>
</table>

<hr>
<h2 id='frailty.vs'>Penalized Variable Selection for Frailty Models</h2><span id='topic+frailty.vs'></span>

<h3>Description</h3>

<p>frailty.vs is variable-selection procedures 
(LASSO, SCAD and HL) of fixed effects in frailty models.</p>


<h3>Usage</h3>

<pre><code class='language-R'>frailty.vs(formula, model, penalty, data, B = NULL, v = NULL, 
alpha = NULL, tun1 = NULL, tun2 = NULL, varfixed = FALSE, varinit = 0.1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="frailty.vs_+3A_formula">formula</code></td>
<td>
<p>A formula object, with the response on the left of a ~ operator, and the terms for
the fixed and random effects on the right. e.g. formula=Surv(time,status)~x+(1|id),
time : survival time, status : censoring indicator having 1 (0) for uncensored
(censored) observation, x : fixed covariate, id : random effect.</p>
</td></tr>
<tr><td><code id="frailty.vs_+3A_model">model</code></td>
<td>
<p>Log-normal frailty models (&quot;lognorm&quot;)</p>
</td></tr>
<tr><td><code id="frailty.vs_+3A_penalty">penalty</code></td>
<td>
<p>Penalty functions (&quot;LASSO&quot; or &quot;SCAD&quot; or &quot;HL&quot;))</p>
</td></tr>
<tr><td><code id="frailty.vs_+3A_data">data</code></td>
<td>
<p>Dataframe used</p>
</td></tr>
<tr><td><code id="frailty.vs_+3A_b">B</code></td>
<td>
<p>Initial values of fixed effects</p>
</td></tr>
<tr><td><code id="frailty.vs_+3A_v">v</code></td>
<td>
<p>Initial values of random effects. Zeros are default</p>
</td></tr>
<tr><td><code id="frailty.vs_+3A_alpha">alpha</code></td>
<td>
<p>Initial value of variance of random effects.</p>
</td></tr>
<tr><td><code id="frailty.vs_+3A_tun1">tun1</code></td>
<td>
<p>Tuning parameter gamma for LASSO, SCAD and HL</p>
</td></tr>
<tr><td><code id="frailty.vs_+3A_tun2">tun2</code></td>
<td>
<p>Tuning parameter omega for HL</p>
</td></tr>
<tr><td><code id="frailty.vs_+3A_varfixed">varfixed</code></td>
<td>
<p>Logical value: if TRUE (FALSE), the value of one or more of the variance terms for the frailties is fixed (estimated).</p>
</td></tr>
<tr><td><code id="frailty.vs_+3A_varinit">varinit</code></td>
<td>
<p>Starting values for frailties, the default is 0.1.</p>
</td></tr> 
</table>

<hr>
<h2 id='frailtyHL'>Fitting Frailty Models using H-likelihood Approach</h2><span id='topic+frailtyHL'></span>

<h3>Description</h3>

<p>frailtyHL is used to fit frailty models using h-likelihood estimation procedures. For the frailty
distribution lognormal and gamma are allowed. In particular, nested (multilevel) frailty models
allow survival studies for hierarchically clustered data by including two iid normal random effects.
The h-likelihood uses the Laplace approximation when the numerical integration is intractable,
giving a statistically efficient estimation in frailty models (Ha, Lee and Song, 2001; Ha and Lee,
2003, 2005; Lee, Nelder and Pawitan, 2017).</p>


<h3>Usage</h3>

<pre><code class='language-R'>frailtyHL(formula, data, weights, subset, na.action, RandDist = "Normal", 
mord = 0, dord = 1, Maxiter = 200, convergence = 10^-6, varfixed = FALSE, 
varinit = c(0.163), varnonneg = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="frailtyHL_+3A_formula">formula</code></td>
<td>
<p>A formula object, with the response on the left of a ~ operator, and the terms for
the fixed and random effects on the right. e.g. formula=Surv(time,status)~x+(1|id),
time : survival time, status : censoring indicator having 1 (0) for uncensored
(censored) observation, x : fixed covariate, id : random effect.</p>
</td></tr>
<tr><td><code id="frailtyHL_+3A_data">data</code></td>
<td>
<p>Dataframe for formulaMain.</p>
</td></tr>
<tr><td><code id="frailtyHL_+3A_weights">weights</code></td>
<td>
<p>Vector of case weights.</p>
</td></tr>
<tr><td><code id="frailtyHL_+3A_subset">subset</code></td>
<td>
<p>Expression indicating which subset of the rows of data should be used in the fit.
All observations are included by default.</p>
</td></tr>
<tr><td><code id="frailtyHL_+3A_na.action">na.action</code></td>
<td>
<p>A missing-data filter function.</p>
</td></tr>
<tr><td><code id="frailtyHL_+3A_randdist">RandDist</code></td>
<td>
<p>Distribution for random effect (&quot;Normal&quot; or &quot;Gamma&quot;).</p>
</td></tr>
<tr><td><code id="frailtyHL_+3A_mord">mord</code></td>
<td>
<p>The order of Laplce approximation to fit the mean parameters (0 or 1); default=0.</p>
</td></tr>
<tr><td><code id="frailtyHL_+3A_dord">dord</code></td>
<td>
<p>The order of Laplace approximation to fit the dispersion components (1 or 2);
default=1.</p>
</td></tr>
<tr><td><code id="frailtyHL_+3A_maxiter">Maxiter</code></td>
<td>
<p>The maximum number of iterations; default=200.</p>
</td></tr>
<tr><td><code id="frailtyHL_+3A_convergence">convergence</code></td>
<td>
<p>Specify the convergence criterion, the default is 1e-6.</p>
</td></tr>
<tr><td><code id="frailtyHL_+3A_varfixed">varfixed</code></td>
<td>
<p>Logical value: if TRUE (FALSE), the value of one or more of the variance terms for the frailties is fixed (estimated).</p>
</td></tr>
<tr><td><code id="frailtyHL_+3A_varinit">varinit</code></td>
<td>
<p>Starting values for frailties, the default is 0.1.</p>
</td></tr> 
<tr><td><code id="frailtyHL_+3A_varnonneg">varnonneg</code></td>
<td>
<p>Logical value: if TRUE (FALSE), gives zero (NaN) SE for random effects when they are estimated by zeros</p>
</td></tr>
</table>


<h3>Details</h3>

<p>frailtyHL package produces estimates of fixed effects and frailty parameters as well as their standard
errors. Also, frailtyHL makes it possible to fit models where the frailty distribution is normal and
gamma and estimate variance components when frailty structure is allowed to be shared or nested.</p>


<h3>References</h3>

<p>Ha, I. D. and Lee, Y. (2003). Estimating frailty models via Poisson Hierarchical generalized linear
models. Journal of Computational and Graphical Statistics, 12, 663-681.
</p>
<p>Ha, I. D. and Lee, Y. (2005). Comparison of hierarchical likelihood versus orthodox best linear
unbiased predictor approaches for frailty models. Biometrika, 92, 717-723.
</p>
<p>Ha, I. D., Lee, Y. and Song, J. K. (2001). Hierarchical likelihood approach for frailty models.
Biometrika, 88, 233-243.
</p>
<p>Lee, Y., Nelder, J. A. and Pawitan, Y. (2017). Generalised linear models with random effects:
unified analysis via h-likelihood. 2nd Edition. Chapman and Hall: London.</p>


<h3>Examples</h3>

<pre><code class='language-R'>#### Analysis of kidney data
data(kidney)
#### Normal frailty model using order = 0, 1 for the mean and dispersion
kidney_ln01&lt;-frailtyHL(Surv(time,status)~sex+age+(1|id),kidney,
RandDist="Normal",mord=0,dord=1)
#### Normal frailty model using order = 1, 1 for the mean and dispersion
#kidney_ln11&lt;-frailtyHL(Surv(time,status)~sex+age+(1|id),kidney,
#RandDist="Normal",mord=1,dord=1)
#### Gamma frailty model using order = 0, 2 for the mean and dispersion
#kidney_g02&lt;-frailtyHL(Surv(time,status)~sex+age+(1|id),kidney,
#RandDist="Gamma",mord=0,dord=2)
#### Gamma frailty model using order = 1, 2 for the mean and dispersion
#kidney_g12&lt;-frailtyHL(Surv(time,status)~sex+age+(1|id),kidney,
#RandDist="Gamma",mord=1,dord=2)

#### Analysis of rats data
data(rats)
#### Cox model
rat_cox&lt;-frailtyHL(Surv(time,status)~rx+(1|litter),rats,
varfixed=TRUE,varinit=c(0))
#### Normal frailty model using order = 1, 1 for the mean and dispersion
#rat_ln11&lt;-frailtyHL(Surv(time,status)~rx+(1|litter),rats,
#RandDist="Normal",mord=1,dord=1,varinit=c(0.9))
#### Gamma frailty model using order = 1, 2 for the mean and dispersion
#rat_g12&lt;-frailtyHL(Surv(time,status)~rx+(1|litter),rats,
#RandDist="Gamma",mord=1,dord=2,convergence=10^-4,varinit=c(0.9))

#### Analysis of CGD data
data(cgd)
#### Multilevel normal frailty model using order = 1, 1 for the mean and dispersion
#cgd_ln11&lt;-frailtyHL(Surv(tstop-tstart,status)~treat+(1|center)+(1|id),cgd,
#RandDist="Normal",mord=1,dord=1,convergence=10^-4,varinit=c(0.03,1.0))
</code></pre>

<hr>
<h2 id='hlike.frailty'>Competing Risk Frialty Models using H-Likelihood</h2><span id='topic+hlike.frailty'></span>

<h3>Description</h3>

<p>Perform hierarchical likelihood estimation of the univariate frailty model, cause-specific frailty
model and subhazard frailty model. Assuming either a univariate normal or multivariate
normal distribution for the random effects V, where different covariance structures can be
assumed for the multivariate normal distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hlike.frailty(formula, data, inits, order = 1, frailty.cov = "none", subHazard = FALSE, 
alpha = 0.05, MAX.ITER = 100, TOL = 1e-06)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="hlike.frailty_+3A_formula">formula</code></td>
<td>
<p>left-hand side is a CmpRsk object (see details), right-hand
side is predictors (currently limited to numeric main effects), must
include a cluster term that identifies the cluster variable.
</p>
</td></tr>
<tr><td><code id="hlike.frailty_+3A_data">data</code></td>
<td>
<p>dataframe containing the variables used in the formula</p>
</td></tr>
<tr><td><code id="hlike.frailty_+3A_inits">inits</code></td>
<td>
<p>list of initial values, three named components: beta, v and theta</p>
</td></tr>
<tr><td><code id="hlike.frailty_+3A_order">order</code></td>
<td>
<p>numeric, order of the Laplace approximation, 0=no order, 1=first-order,
2=second-order; second-order only applies to models with a univariate
normal distribution</p>
</td></tr>
<tr><td><code id="hlike.frailty_+3A_frailty.cov">frailty.cov</code></td>
<td>
<p>character string &quot;none&quot;, &quot;independent&quot; or
&quot;unstructured&quot; specifying the covariance structure for a multivariate
normal distribution; &quot;none&quot; indicates univariate normal distribution</p>
</td></tr>
<tr><td><code id="hlike.frailty_+3A_subhazard">subHazard</code></td>
<td>
<p>logical, if TRUE fits the subhazard frailty model</p>
</td></tr>
<tr><td><code id="hlike.frailty_+3A_alpha">alpha</code></td>
<td>
<p>numeric, 100(1-alpha) percent confidence intervals</p>
</td></tr>
<tr><td><code id="hlike.frailty_+3A_max.iter">MAX.ITER</code></td>
<td>
<p>numeric, maximum number of iterations</p>
</td></tr>
<tr><td><code id="hlike.frailty_+3A_tol">TOL</code></td>
<td>
<p>numeric, tolerance limit</p>
</td></tr>
</table>

<hr>
<h2 id='jmfit'>Joint Modelling of Longitudinal and Time-to-Event Data</h2><span id='topic+jmfit'></span>

<h3>Description</h3>

<p>jmfit is used to fit joint modelling of longitudinal and time-to-event 
data by using h-likelihood. The response of interest would involve repeated measurements
over time on the same subject as well as time to an event of interest
with or without competing risks.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>jmfit(jm, data, jm2 = NULL, data2 = NULL, Maxiter)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="jmfit_+3A_jm">jm</code></td>
<td>
<p>list of <code>jointmodeling</code> objects which specify the first reponses of interest.</p>
</td></tr>
<tr><td><code id="jmfit_+3A_data">data</code></td>
<td>
<p>list of dataframes containing the variables used in the jm.</p>
</td></tr>
<tr><td><code id="jmfit_+3A_jm2">jm2</code></td>
<td>
<p>list of <code>jointmodeling</code> object which specifies the second reponses.</p>
</td></tr>
<tr><td><code id="jmfit_+3A_data2">data2</code></td>
<td>
<p>dataframes containing the variables used in the jm2.</p>
</td></tr>
<tr><td><code id="jmfit_+3A_maxiter">Maxiter</code></td>
<td>
<p>numeric, maximum number of iterations</p>
</td></tr>
</table>

<hr>
<h2 id='jointmodeling'>Defining the Fixed and Random Models for the Mean and Dispersion Parameters in Joint Models</h2><span id='topic+jointmodeling'></span>

<h3>Description</h3>

<p>The jointmodeling specifies jointly both the hazard model in the frailty model and 
the mean model in the linear mixed model.</p>


<h3>Usage</h3>

<pre><code class='language-R'>jointmodeling(Model = "mean", RespDist = "gaussian", Link = NULL, LinPred = "constant", 
RandDist = NULL, Offset = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="jointmodeling_+3A_model">Model</code></td>
<td>
<p>This option specifies the mean model when Model=&quot;mean&quot; (default).</p>
</td></tr>
<tr><td><code id="jointmodeling_+3A_respdist">RespDist</code></td>
<td>
<p>This option specifies the distribution of response variables (linear mixed model: &quot;gaussian&quot; 
or accelerated failure time model : &quot;AFT&quot; or frailty model : &quot;FM&quot;)</p>
</td></tr>
<tr><td><code id="jointmodeling_+3A_link">Link</code></td>
<td>
<p>The link function for the linear predictor is
specified by the option Link. For &quot;AFT&quot; or &quot;FM&quot; (or &quot;gaussian&quot;) in RespDist, it is specified by &quot;log&quot; (or &quot;identity&quot;).</p>
</td></tr>
<tr><td><code id="jointmodeling_+3A_linpred">LinPred</code></td>
<td>
<p>The option LinPred specifies the fixed and
random terms for the linear predictor.</p>
</td></tr>
<tr><td><code id="jointmodeling_+3A_randdist">RandDist</code></td>
<td>
<p>The option RandDist specifies the
distributions of the random terms represented in the option LinPred.</p>
</td></tr>
<tr><td><code id="jointmodeling_+3A_offset">Offset</code></td>
<td>
<p>The option Offset can be used to
specify a known component to be included in the linear predictor specified by LinPred
during fitting.</p>
</td></tr>
</table>

<hr>
<h2 id='kidney'>Kidney Infection Data</h2><span id='topic+kidney'></span>

<h3>Description</h3>

<p>The data presented by McGilchrist and Aisbett (1991) consist of times to the first and second recurrences
of infection in 38 kidney patients using a portable dialysis machine. Infections can occur at
the location of insertion of the catheter. The catheter is later removed if infection occurs and can be
removed for other reasons, in which case the observation is censored.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("kidney")</code></pre>


<h3>Format</h3>

<p>A data frame with 76 observations on the following 10 variables.
</p>

<dl>
<dt><code>id</code></dt><dd><p>Patient number for 38 patients</p>
</dd>
<dt><code>time</code></dt><dd><p>Time to infection since insertion of the catheter</p>
</dd>
<dt><code>status</code></dt><dd><p>Censoring indicator(1=uncensored, 0=censored)</p>
</dd>
<dt><code>age</code></dt><dd><p>Age of each patient, in years</p>
</dd>
<dt><code>sex</code></dt><dd><p>Sex of each patient(1=male, 2=female)</p>
</dd>
<dt><code>disease</code></dt><dd><p>Disease type(GN, AN, PKD, Other)</p>
</dd>
<dt><code>frail</code></dt><dd><p>Frailty estimate from original paper</p>
</dd>
<dt><code>GN</code></dt><dd><p>Indicator for disease type GN</p>
</dd>
<dt><code>AN</code></dt><dd><p>Indicator for disease type AN</p>
</dd>
<dt><code>PKD</code></dt><dd><p>Indicator for disease type PKD</p>
</dd>
</dl>



<h3>References</h3>

<p>McGilchrist, C. A. and Aisbett, C. W. (1991). Regression with frailty in survival analysis. Biometrics,
47, 461-466.
</p>
<p>Therneasu, T. (2012). survival: survival analysis, including penalised likelihood. http://CRAN.Rproject.
org/package=survival. R pakcage version 2.36-14.
</p>

<hr>
<h2 id='mlmfit'>Accelerated Failure Time (AFT) Models with Random Effects</h2><span id='topic+mlmfit'></span>

<h3>Description</h3>

<p>mlmfit is used to fit linear mixed models with censoring 
by using h-likelihood.</p>


<h3>Usage</h3>

<pre><code class='language-R'>mlmfit(jm1, data, weights, subset, na.action, Maxiter = 200)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mlmfit_+3A_jm1">jm1</code></td>
<td>
<p>This option requires <code>jointmodeling</code> object which specifies the AFT random-effect model.</p>
</td></tr>
<tr><td><code id="mlmfit_+3A_data">data</code></td>
<td>
<p>dataframe containing the variables used in the jm1</p>
</td></tr>
<tr><td><code id="mlmfit_+3A_weights">weights</code></td>
<td>
<p>Vector of case weights.</p>
</td></tr>
<tr><td><code id="mlmfit_+3A_subset">subset</code></td>
<td>
<p>Expression indicating which subset of the rows of data should be used in the fit.
All observations are included by default.</p>
</td></tr>
<tr><td><code id="mlmfit_+3A_na.action">na.action</code></td>
<td>
<p>A missing-data filter function.</p>
</td></tr>
<tr><td><code id="mlmfit_+3A_maxiter">Maxiter</code></td>
<td>
<p>numeric, maximum number of iterations</p>
</td></tr>
</table>

<hr>
<h2 id='rats'>Rats data</h2><span id='topic+rats'></span>

<h3>Description</h3>

<p>Rats data set presented by Mantel et al. (1977) is based on a tumorigenesis study of 50 litters of
female rats. For each litter, one rat was selected to receive the drug and the other two rats were
placebo-treated controls. The survival time is the time to the development of tumor, measured in
weeks. Death before occurrent of tumor yields a right-censored observation; 40 rats developed a
tumor, leading to censoring of about 73 percent.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("rats")</code></pre>


<h3>Format</h3>

<p>A data frame with 150 observations on the following 4 variables.
</p>

<dl>
<dt><code>litter</code></dt><dd><p>Litter number for 50 female rats</p>
</dd>
<dt><code>rx</code></dt><dd><p>Treatment(1=drug, 0=placebo)</p>
</dd>
<dt><code>time</code></dt><dd><p>Time to the devlopment of tumor in weeks</p>
</dd>
<dt><code>status</code></dt><dd><p>Censoring indicator(1=uncensored, 0=censored)</p>
</dd>
</dl>



<h3>References</h3>

<p>Mantel,N., Bohidar N. R. and Ciminera, J. L. (1977). Mantel-Haenszel analyses of litter-matched
time-to-response data, with modifications for recovery of interlitter information. Cancer Research,
37, 3863-3868.
</p>
<p>Therneasu, T. (2012). survival: survival analysis, including penalised likelihood. http://CRAN.Rproject.
org/package=survival. R pakcage version 2.36-14.</p>

<hr>
<h2 id='ren'>Mammary tumor data</h2><span id='topic+ren'></span>

<h3>Description</h3>

<p>The data set by presented Gail et al. (1980) is based on multiple occurrences of mammary tumors for 48
female rats. The primary outcome of interest was time to development of a mammary
tumor for 23 female rats in the treatment group and 25 female rats in the control
group. Initially, 76 rats were injected with a carcinogen for mammary cancer at
day zero, and then all rats were given retinyl acetate to prevent cancer for 60 days.
After 60 days, forty-eight rats which remained tumor-free were randomly assigned to
continue being treated with retinoid prophylaxis (treatment group) or to the control
group receiving no further retinoid prophylaxis. Rats were palpated for tumors twice
weekly and observation ended 182 days after the initial carcinogen injection.
In some cases, there were multiple tumors detected by the same day.
The number of tumors ranges from 0 to 13.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("ren")</code></pre>


<h3>Format</h3>

<p>A data frame with 254 observations on the following 6 variables.
</p>

<dl>
<dt><code>rat</code></dt><dd><p>Rat id</p>
</dd>
<dt><code>time1</code></dt><dd><p>Start time</p>
</dd>
<dt><code>time2</code></dt><dd><p>Stop time</p>
</dd>
<dt><code>del</code></dt><dd><p>Censoring indicator(1=tumor, 0=censored)</p>
</dd>
<dt><code>gp</code></dt><dd><p>Treatment indicator(1=drug, 0=control)</p>
</dd>
<dt><code>time</code></dt><dd><p>time2-time1 (time=time+0.01 if there are ties)</p>
</dd>
</dl>



<h3>References</h3>

<p>Gail, M.H. Santner, T.J. and Brown, C.C. (1980), An analysis of comparative carcinogenesis experiments
based on multiple times to tumor. Biometrics, 36, 255-266.
</p>
<p>Ha, I. D., Jeong, J. H. and Lee, Y. (2017). Statistical modelling of survival data with
random effects: h-likelihood approach. Springer, in press.
</p>

<hr>
<h2 id='renal'>Renal transplant data</h2><span id='topic+renal'></span>

<h3>Description</h3>

<p>This is a data set from a clinical study to investigate the chronic renal allograft
dysfunction in renal transplants (Ha et al., 2017).
Data were available from 87 male and 25 female renal transplanted patients
who survived more than 4 years after transplant. For each patient,
both repeated-measure outcomes (serum creatinine levels) at several time points
and a terminating event time (graft-loss time) were observed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("renal")</code></pre>


<h3>Format</h3>

<p>A data frame with 1395 observations on the following 9 variables.
</p>

<dl>
<dt><code>id</code></dt><dd><p>Patient id</p>
</dd>
<dt><code>month</code></dt><dd><p>Time points (month) at which the measurements of sCr were recorded</p>
</dd>
<dt><code>cr</code></dt><dd><p>Serum creatinine (sCr) level</p>
</dd>
<dt><code>sex</code></dt><dd><p>Sex(1=male, 0=female)</p>
</dd>
<dt><code>age</code></dt><dd><p>Age(years)</p>
</dd>
<dt><code>icr</code></dt><dd><p>Reciprocal of sCr(=1/sCr)</p>
</dd>
<dt><code>sur_time</code></dt><dd><p>Time to graft loss</p>
</dd>
<dt><code>status</code></dt><dd><p>Censoring indicator(1=graft loss, 0=no event)</p>
</dd>
<dt><code>first</code></dt><dd><p>The first survival time (time to graft loss) of each patient</p>
</dd>
</dl>



<h3>References</h3>

<p>Ha, I. D., Noh, M. and Lee, Y. (2017). H-likelihood approach for joint modelling of longitudinal outcomes and time-to-event data.
Biometrical Journal, 59, 1122&ndash;1143.
</p>
<p>Ha, I. D., Jeong, J.-H. and Lee, Y. (2017). Statistical modelling of survival data with
random effects: h-likelihood approach. Springer, in press.
</p>

<hr>
<h2 id='test'>Simulated data with clustered competing risks</h2><span id='topic+test'></span>

<h3>Description</h3>

<p>A data set for the cause-specific hazard frailty model assuming a bivariate normal
distribution is generated using a technique similar to Beyersmann et al. (2009) and
Christian et al. (2016). Let there be two event types, Types 1 and 2, as well as
independent censoring. Consider a sample size n = 100 with (q, ni) = (50, 3).
Here, q is the number of clusters and ni is the cluster size.
The random effects (log-frailties) are from bivariate normal with mean vector (0,0) and variance-covariance matrix having (1,1,-0.5).
Data are generated from the conditional cause-specific hazard rates for each event type given the random effects.
Here, for Type 1 event the two true regression parameters are (0.6, -0.4) with a constant baseline hazard 2 and for Type 2 event
the true parameters are (-0.3, 0.7) with a constant baseline hazard 0.5, respectively.
The covariates x1 and x2 are generated from a standard normal distribution and a Bernoulli distribution  with probability 0.5, respectively.
Censoring times are generated from a Uniform(0, 1.3) distribution. Under this scenario,
with 25.2% censoring, the proportions of Type 1 and Type 2 events are 53.2% and 21.6%, respectively.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("test")</code></pre>


<h3>Format</h3>

<p>A data frame with 250 observations on the following 6 variables.
</p>

<dl>
<dt><code>obs</code></dt><dd><p>Observation number</p>
</dd>
<dt><code>id</code></dt><dd><p>Id number</p>
</dd>
<dt><code>time</code></dt><dd><p>Time to event</p>
</dd>
<dt><code>status</code></dt><dd><p>Event indicator(2=Type 2 event, 1=Type 1 event, 0=censored)</p>
</dd>
<dt><code>x1</code></dt><dd><p>A covariate from standard normal distribution</p>
</dd>
<dt><code>x2</code></dt><dd><p>A covariate from Bernoulli normal distribution</p>
</dd>
</dl>



<h3>References</h3>

<p>Beyersmann, J., Dettenkofer, M., Bertz, H. and Schumacher, M. (2007). A competing risks analysis of bloodstream infection after stem-cell
transplantation using subdistribution hazardsa and cause-specific hazards. Statistics in Medicine, 26, 5360-5369.
</p>
<p>Christian, N. J., Ha, I. D. and Jeong, J. H. (2016). Hierarchical likelihood inference on clustered competing risks data. Statistics in Medicine, 35, 251-267.
</p>
<p>Ha, I. D., Jeong, J. H. and Lee, Y. (2017). Statistical modelling of survival data with
random effects: h-likelihood approach. Springer, in press.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
