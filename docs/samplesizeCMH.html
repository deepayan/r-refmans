<!DOCTYPE html><html><head><title>Help for package samplesizeCMH</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {samplesizeCMH}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#contraceptives'><p>Oral contraceptive use and breast cancer rates</p></a></li>
<li><a href='#odds.and.proportions'><p>Interconvert odds and proportion values</p></a></li>
<li><a href='#odds.ratio'><p>Create an odds ratio estimate from a 2-by-2 table of frequencies or proportions</p></a></li>
<li><a href='#power.cmh.test'><p>Power and sample size calculation for the Cochran-Mantel-Haenszel test</p></a></li>
<li><a href='#print.power.cmh'><p>Print <code>"power.cmh"</code> object</p></a></li>
<li><a href='#rel.risk'><p>Calculate the relative risk from a 2-by-2 table</p></a></li>
<li><a href='#samplesizeCMH'><p>samplesizeCMH: Power and Sample Size Calculation for the</p>
Cochran-Mantel-Haenszel Test</a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Power and Sample Size Calculation for the
Cochran-Mantel-Haenszel Test</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-12-10</td>
</tr>
<tr>
<td>Version:</td>
<td>0.0.3</td>
</tr>
<tr>
<td>Copyright:</td>
<td>Spectrum Health, Grand Rapids, MI</td>
</tr>
<tr>
<td>Description:</td>
<td>
    Calculates the power and sample size for Cochran-Mantel-Haenszel tests. 
    There are also several helper functions for working with probability,
    odds, relative risk, and odds ratio values.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.4.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, DescTools, datasets, testthat</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/pegeler/samplesizeCMH">https://github.com/pegeler/samplesizeCMH</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/pegeler/samplesizeCMH/issues">https://github.com/pegeler/samplesizeCMH/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-12-10 09:03:28 UTC; pablo</td>
</tr>
<tr>
<td>Author:</td>
<td>Paul Egeler [aut, cre],
  Spectrum Health, Grand Rapids, MI [cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Paul Egeler &lt;paulegeler@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-12-12 04:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='contraceptives'>Oral contraceptive use and breast cancer rates</h2><span id='topic+contraceptives'></span>

<h3>Description</h3>

<p>This data summarizes counts of a case-control study investigating
the link between breast cancer rates and oral contraceptive use, stratified
by age group. In toto, 10,890 subjects. See source for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(contraceptives)
</code></pre>


<h3>Format</h3>

<p>A 3-dimensional table.
</p>

<ol>
<li> <p><code>OC Usage</code>: Subject exposure to oral contraceptives.
</p>
</li>
<li> <p><code>Disease Status</code>: Breast cancer present (case) or absent (control).
</p>
</li>
<li> <p><code>Age Group</code>: Age group of the subject.
</p>
</li></ol>



<h3>Source</h3>

<p>Hennekens, C. H., F. E. Speizer, R. J. Lipnick, B. Rosner, C. Bain,
C. Belanger, M. J. Stampfer, W. Willett, and R. Peto. (1984). &quot;A Case-Control
Study of Oral Contraceptive Use and Breast Cancer.&quot; <em>Journal of the
National Cancer Institute</em> <strong>72</strong> (1): 39â€“42. Table 1.
</p>

<hr>
<h2 id='odds.and.proportions'>Interconvert odds and proportion values</h2><span id='topic+odds.and.proportions'></span><span id='topic+prop2odds'></span><span id='topic+odds2prop'></span><span id='topic+effect.size'></span><span id='topic+props2theta'></span><span id='topic+rr2theta'></span><span id='topic+theta2rr'></span>

<h3>Description</h3>

<p>These functions will create either odds for a given probability,
probability for a given odds, calculate the odds ratio between two
probabilities, or calculate effect size (raise a probability by theta)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prop2odds(p)

odds2prop(o)

effect.size(p, theta)

props2theta(p1, p2)

rr2theta(rr, p1, p2)

theta2rr(theta, p1, p2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="odds.and.proportions_+3A_p">p</code>, <code id="odds.and.proportions_+3A_p1">p1</code>, <code id="odds.and.proportions_+3A_p2">p2</code></td>
<td>
<p>Proportion vector.</p>
</td></tr>
<tr><td><code id="odds.and.proportions_+3A_o">o</code></td>
<td>
<p>Odds vector.</p>
</td></tr>
<tr><td><code id="odds.and.proportions_+3A_theta">theta</code></td>
<td>
<p>Odds ratio vector.</p>
</td></tr>
<tr><td><code id="odds.and.proportions_+3A_rr">rr</code></td>
<td>
<p>Relative risk vector (<code>p1 / p2</code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector.
</p>


<h3>Author(s)</h3>

<p>Paul W. Egeler, M.S.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Convert proportions of 0 through 1 to odds
props &lt;- seq(0,1,0.1)
prop2odds(props)

# Convert odds to proportions
odds2prop(1:3)

# Raise a proportion by an effect size theta
effect.size(0.5, 2)

# Find the odds ratio between two proportions
props2theta(0.75, 0.5)
</code></pre>

<hr>
<h2 id='odds.ratio'>Create an odds ratio estimate from a 2-by-2 table of frequencies or proportions</h2><span id='topic+odds.ratio'></span>

<h3>Description</h3>

<p>Create an odds ratio estimate from a 2-by-2 table of frequencies or proportions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>odds.ratio(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="odds.ratio_+3A_x">x</code></td>
<td>
<p>A two-dimensional matrix or table containing frequencies or proportions.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector.
</p>


<h3>Author(s)</h3>

<p>Paul W. Egeler, M.S.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load in Titanic data from datasets package
data(Titanic, package = "datasets")

# Get marginal table of survival by sex
marginal_table &lt;- margin.table(Titanic, c(2,4))
marginal_table

# Compute odds ratio of marginal table
odds.ratio(marginal_table)

# Get partial tables of survival by sex, stratified by class
partial_tables &lt;- margin.table(Titanic, c(2,4,1))
partial_tables

# Compute odds ratio of each partial table
apply(partial_tables, 3, odds.ratio)

</code></pre>

<hr>
<h2 id='power.cmh.test'>Power and sample size calculation for the Cochran-Mantel-Haenszel test</h2><span id='topic+power.cmh.test'></span>

<h3>Description</h3>

<p>Compute the post-hoc power or required number of subjects for the
Cochran-Mantel-Haenszel test for association in <em>J</em> stratified 2 x 2
tables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>power.cmh.test(
  p1 = NULL,
  p2 = NULL,
  theta = NULL,
  N = NULL,
  sig.level = 0.05,
  power = 0.8,
  alternative = c("two.sided", "less", "greater"),
  s = 0.5,
  t = 1/J,
  correct = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="power.cmh.test_+3A_p1">p1</code></td>
<td>
<p>Vector of proportions of the <em>J</em> case groups.</p>
</td></tr>
<tr><td><code id="power.cmh.test_+3A_p2">p2</code></td>
<td>
<p>Vector of proportions of the <em>J</em> control groups.</p>
</td></tr>
<tr><td><code id="power.cmh.test_+3A_theta">theta</code></td>
<td>
<p>Vector of odds ratios relating to the <em>J</em> 2 x 2 tables.</p>
</td></tr>
<tr><td><code id="power.cmh.test_+3A_n">N</code></td>
<td>
<p>Total number of subjects.</p>
</td></tr>
<tr><td><code id="power.cmh.test_+3A_sig.level">sig.level</code></td>
<td>
<p>Significance level (Type I error probability).</p>
</td></tr>
<tr><td><code id="power.cmh.test_+3A_power">power</code></td>
<td>
<p>Power of test (1 minus Type II error probability).</p>
</td></tr>
<tr><td><code id="power.cmh.test_+3A_alternative">alternative</code></td>
<td>
<p>Two- or one-sided test. If one-sided, the direction of the
association must be defined (less than 1 or greater than 1). Can be
abbreviated.</p>
</td></tr>
<tr><td><code id="power.cmh.test_+3A_s">s</code></td>
<td>
<p>Proportion (weight) of case versus control in <em>J</em> stratum.</p>
</td></tr>
<tr><td><code id="power.cmh.test_+3A_t">t</code></td>
<td>
<p>Proportion (weight) of total number of cases of <em>J</em> stratum.</p>
</td></tr>
<tr><td><code id="power.cmh.test_+3A_correct">correct</code></td>
<td>
<p>Logical indicating whether to apply continuity correction.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This sample size calculation is based on the derivations described in the
Woolson <em>et al.</em> (1986). It is designed for case-control studies where
one margin is fixed. The method is &quot;based on the Cochran-Mantel-Haenszel
statistic expressed as a weighted difference in binomial proportions.&quot;
</p>
<p>Continuity corrected sample size is described in Nam's 1992 paper. This uses
the weighted binomial sample size calculation described in Woolson <em>et
al.</em> (1986) but is enhanced for use with the continuity corrected Cochran's
test.
</p>
<p>Power calculations are based on the writings of Wittes and Wallenstein
(1987). They are functionally equivalent to the derivations of the sample
size calculation described by Woolson and others and Nam, but have slightly
added precision.
</p>
<p>Terminology and symbolic conventions are borrowed from Woolson <em>et al.</em>
(1986). The <code>p1</code> group is dubbed the <em>Case</em> group and <code>p2</code>
group is called the <em>Control</em> group.
</p>


<h3>Value</h3>

<p>An object of class <code>"power.cmh"</code>: a list of the original arguments and
the calculated sample size or power. Also included are vectors of n's per
each group, an indicator or whether continuity correction was used, the
original function call, and <code>N.effective</code>.
</p>
<p>The vectors of n's per each group, <code>n1</code> and <code>n2</code>, are the
fractional n's required to achieve a final total N specified by the
calculation while satisfying the constraints of <code>s</code> and <code>t</code>.
However, the effective N, given the requirement of cell counts populated by
whole numbers is provided by <code>N.effective</code>. By default, the print method
is set to <code>n.frac = FALSE</code>, which will round each cell n up to the
nearest whole number.
</p>


<h3>Arguments</h3>

<p>To calculate <strong>power</strong>, the <code>power</code> parameter must be set to
<code>NULL</code>. To calculate <strong>sample size</strong>, the <code>N</code> parameter must
be set to <code>NULL</code>.
</p>
<p>The <code>J</code> number of groups will be inferred by the maximum length of
<code>p1</code>, <code>p2</code>, or <code>theta</code>.
</p>
<p>Effect size must be specified using one of the following combinations of
arguments.
</p>

<ul>
<li><p> Both case and control proportion vectors, ex.,
</p>
<ul>
<li> <p><code>p1</code> and <code>p2</code> with <code>theta = NULL</code>.</p>
</li></ul>

</li>
<li><p> One proportion vector and an effect size, ex.,
</p>

<ul>
<li> <p><code>p1</code> and <code>theta</code> with <code>p2 = NULL</code>, <strong>or</strong>
</p>
</li>
<li> <p><code>p2</code> and <code>theta</code> with <code>p1 = NULL</code>.
</p>
</li></ul>

</li></ul>



<h3>Author(s)</h3>

<p>Paul W. Egeler, M.S.
</p>


<h3>References</h3>

<p>Gail, M. (1973). &quot;The determination of sample sizes for trials involving
several 2 x 2 tables.&quot;
<em>Journal of Chronic Disease</em> <strong>26</strong>: 669-673.
</p>
<p>Munoz, A. and B. Rosner. (1984). &quot;Power and sample size for a collection of 2
x 2 tables.&quot; <em>Biometrics</em> <strong>40</strong>: 995-1004.
</p>
<p>Nam, J. (1992). &quot;Sample size determination for case-control studies and the
comparison of stratified and unstratified analyses.&quot;
<em>Biometrics</em> <strong>48</strong>: 389-395.
</p>
<p>Wittes, J. and S. Wallenstein. (1987). &quot;The power of the Mantel-Haenszel
test.&quot; <em>Journal of the American Statistical Association</em> <strong>82</strong>:
1104-1109.
</p>
<p>Woolson, R. F., Bean, J. A., and P. B. Rojas. (1986).
&quot;Sample size for case-control studies using Cochran's statistic.&quot;
<em>Biometrics</em> <strong>42</strong>: 927-932.
</p>


<h3>See Also</h3>

<p><a href="stats.html#topic+power.prop.test">power.prop.test</a>,
<a href="stats.html#topic+mantelhaen.test">mantelhaen.test</a>,
<a href="DescTools.html#topic+BreslowDayTest">BreslowDayTest</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># From "Sample size determination for case-control studies and the comparison
# of stratified and unstratified analyses", (Nam 1992). See references.

# Uncorrected sample size estimate first introduced
# by Woolson and others in 1986
sample_size_uncorrected &lt;- power.cmh.test(
  p2 = c(0.75,0.70,0.65,0.60),
  theta = 3,
  power = 0.9,
  t = c(0.10,0.40,0.35,0.15),
  alternative = "greater",
  correct = FALSE
)

print(sample_size_uncorrected, detail = FALSE)

# We see that the N is 171, the same as calculated by Nam
sample_size_uncorrected$N


# Continuity corrected sample size estimate added by Nam
sample_size_corrected &lt;- power.cmh.test(
  p2 = c(0.75,0.70,0.65,0.60),
  theta = 3,
  power = 0.9,
  t = c(0.10,0.40,0.35,0.15),
  alternative = "greater",
  correct = TRUE
)

print(sample_size_corrected, n.frac = TRUE)

# We see that the N is indeed equal to that which is reported in the paper
sample_size_corrected$N

</code></pre>

<hr>
<h2 id='print.power.cmh'>Print <code>"power.cmh"</code> object</h2><span id='topic+print.power.cmh'></span>

<h3>Description</h3>

<p>The S3 print method for the <code>"power.cmh"</code> object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'power.cmh'
print(x, detail = TRUE, n.frac = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.power.cmh_+3A_x">x</code></td>
<td>
<p>A <code>"power.cmh"</code> object.</p>
</td></tr>
<tr><td><code id="print.power.cmh_+3A_detail">detail</code></td>
<td>
<p>Logical to toggle detailed or simple output.</p>
</td></tr>
<tr><td><code id="print.power.cmh_+3A_n.frac">n.frac</code></td>
<td>
<p>Logical indicating whether sample n's should be rounded to the
next whole number.</p>
</td></tr>
<tr><td><code id="print.power.cmh_+3A_...">...</code></td>
<td>
<p>Ignored.</p>
</td></tr>
</table>

<hr>
<h2 id='rel.risk'>Calculate the relative risk from a 2-by-2 table</h2><span id='topic+rel.risk'></span>

<h3>Description</h3>

<p>Computes the relative risk of a specified column of a two-by-two table.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rel.risk(x, col.num = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rel.risk_+3A_x">x</code></td>
<td>
<p>A table or matrix containing frequencies.</p>
</td></tr>
<tr><td><code id="rel.risk_+3A_col.num">col.num</code></td>
<td>
<p>The column number upon which relative risk should be calculated.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector.
</p>


<h3>Author(s)</h3>

<p>Paul W. Egeler, M.S.
</p>

<hr>
<h2 id='samplesizeCMH'>samplesizeCMH: Power and Sample Size Calculation for the
Cochran-Mantel-Haenszel Test</h2><span id='topic+samplesizeCMH'></span>

<h3>Description</h3>

<p>This package provides functions relating to power and sample size calculation
for the CMH test. There are also several helper functions for interconverting
probability, odds, relative risk, and odds ratio values.
</p>


<h3>Details</h3>

<p>The <strong>Cochran-Mantel-Haenszel test</strong> (CMH) is an inferential test for
the association between two binary variables, while controlling for a third
confounding nominal variable. Two variables of interest, <em>X</em> and
<em>Y</em>, are compared at each level of the confounder variable <em>Z</em> and
the results are combined, creating a common odds ratio. Essentially, the CMH
test examines the <em>weighted</em> association of <em>X</em> and <em>Y</em>. The
CMH test is a common technique in the field of biostatistics, where it is
often used for case-control studies.
</p>


<h3>Sample Size Calculation</h3>

<p>Given a target power which the researcher would like to achieve, a
calculation can be performed in order to estimate the appropriate number of
subjects for a study. The <code><a href="#topic+power.cmh.test">power.cmh.test</a></code> function calculates
the required number of subjects per group to achieve a specified power for a
Cochran-Mantel-Haenszel test.
</p>


<h3>Power Calculation</h3>

<p>Researchers interested in estimating the probability of detecting a true
positive result from an inferential test must perform a power calculation
using a known sample size, effect size, significance level, <em>et cetera</em>.
The <code><a href="#topic+power.cmh.test">power.cmh.test</a></code> function can compute the power of a CMH test,
given parameters from the experiment.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
