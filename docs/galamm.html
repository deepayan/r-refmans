<!DOCTYPE html><html><head><title>Help for package galamm</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {galamm}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#anova.galamm'><p>Compare likelihoods of galamm objects</p></a></li>
<li><a href='#coef.galamm'><p>Extract galamm coefficients</p></a></li>
<li><a href='#cognition'><p>Simulated Data with Measurements of Cognitive Abilities</p></a></li>
<li><a href='#confint.galamm'><p>Confidence intervals for model parameters</p></a></li>
<li><a href='#deviance.galamm'><p>Extract deviance of galamm object</p></a></li>
<li><a href='#diet'><p>Diet Data</p></a></li>
<li><a href='#epilep'><p>Epilepsy Data</p></a></li>
<li><a href='#extract_optim_parameters.galamm'><p>Extract parameters from fitted model for use as initial values</p></a></li>
<li><a href='#factor_loadings.galamm'><p>Extract factor loadings from galamm object</p></a></li>
<li><a href='#family.galamm'><p>Extract family or families from fitted galamm</p></a></li>
<li><a href='#fitted.galamm'><p>Extract model fitted values</p></a></li>
<li><a href='#fixef'><p>Extract fixed effects from galamm objects</p></a></li>
<li><a href='#galamm'><p>Fit a generalized additive latent and mixed model</p></a></li>
<li><a href='#galamm_control'><p>Control values for galamm fit</p></a></li>
<li><a href='#galamm-package'><p>galamm: Generalized Additive Latent and Mixed Models</p></a></li>
<li><a href='#hsced'><p>Example Data with Heteroscedastic Residuals</p></a></li>
<li><a href='#latent_covariates'><p>Simulated Data with Latent and Observed Covariates Interaction</p></a></li>
<li><a href='#latent_covariates_long'><p>Simulated Longitudinal Data with Latent and Observed Covariates Interaction</p></a></li>
<li><a href='#llikAIC'><p>Extract log likelihood, AIC, and related statistics from a GALAMM</p></a></li>
<li><a href='#logLik.galamm'><p>Extract Log-Likelihood of galamm Object</p></a></li>
<li><a href='#mresp'><p>Simulated Mixed Response Data</p></a></li>
<li><a href='#mresp_hsced'><p>Simulated Mixed Response Data with Heteroscedastic Residuals</p></a></li>
<li><a href='#nobs.galamm'><p>Extract the Number of Observations from a galamm Fit</p></a></li>
<li><a href='#plot_smooth.galamm'><p>Plot smooth terms for galamm fits</p></a></li>
<li><a href='#plot.galamm'><p>Diagnostic plots for galamm objects</p></a></li>
<li><a href='#predict.galamm'><p>Predictions from a model at new data values</p></a></li>
<li><a href='#print.summary.galamm'><p>Print method for summary GALAMM fits</p></a></li>
<li><a href='#print.VarCorr.galamm'><p>Print method for variance-covariance objects</p></a></li>
<li><a href='#ranef.galamm'><p>Extract random effects from galamm object.</p></a></li>
<li><a href='#residuals.galamm'><p>Residuals of galamm objects</p></a></li>
<li><a href='#s'><p>Set up smooth term with factor loading</p></a></li>
<li><a href='#sigma.galamm'><p>Extract square root of dispersion parameter from galamm object</p></a></li>
<li><a href='#summary.galamm'><p>Summarizing GALAMM fits</p></a></li>
<li><a href='#t2'><p>Set up smooth term with factor loading</p></a></li>
<li><a href='#VarCorr'><p>Extract variance and correlation components from model</p></a></li>
<li><a href='#vcov.galamm'><p>Calculate variance-covariance matrix for GALAMM fit</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Generalized Additive Latent and Mixed Models</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimates generalized additive latent and
    mixed models using maximum marginal likelihood, 
    as defined in Sorensen et al. (2023) 
    &lt;<a href="https://doi.org/10.1007%2Fs11336-023-09910-z">doi:10.1007/s11336-023-09910-z</a>&gt;, which is an extension of Rabe-Hesketh and
    Skrondal (2004)'s unifying framework for multilevel latent variable 
    modeling &lt;<a href="https://doi.org/10.1007%2FBF02295939">doi:10.1007/BF02295939</a>&gt;. Efficient computation is done using sparse 
    matrix methods, Laplace approximation, and automatic differentiation. The 
    framework includes generalized multilevel models with heteroscedastic 
    residuals, mixed response types, factor loadings, smoothing splines, 
    crossed random effects, and combinations thereof. Syntax for model 
    formulation is close to 'lme4' (Bates et al. (2015) 
    &lt;<a href="https://doi.org/10.18637%2Fjss.v067.i01">doi:10.18637/jss.v067.i01</a>&gt;) and 'PLmixed' (Rockwood and Jeon (2019) 
    &lt;<a href="https://doi.org/10.1080%2F00273171.2018.1516541">doi:10.1080/00273171.2018.1516541</a>&gt;).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/LCBC-UiO/galamm">https://github.com/LCBC-UiO/galamm</a>,
<a href="https://lcbc-uio.github.io/galamm/">https://lcbc-uio.github.io/galamm/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/LCBC-UiO/galamm/issues">https://github.com/LCBC-UiO/galamm/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Imports:</td>
<td>lme4, Matrix, memoise, methods, mgcv, nlme, Rcpp, Rdpack,
stats</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppEigen</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Suggests:</td>
<td>covr, gamm4, ggplot2, knitr, PLmixed, rmarkdown, testthat (&ge;
3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>RdMacros:</td>
<td>Rdpack</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>C++17</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-10-13 12:47:16 UTC; oyss</td>
</tr>
<tr>
<td>Author:</td>
<td>Øystein Sørensen <a href="https://orcid.org/0000-0003-0724-3542"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Douglas Bates [ctb],
  Ben Bolker [ctb],
  Martin Maechler [ctb],
  Allan Leal [ctb],
  Fabian Scheipl [ctb],
  Steven Walker [ctb],
  Simon Wood [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Øystein Sørensen &lt;oystein.sorensen@psykologi.uio.no&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-10-13 21:10:07 UTC</td>
</tr>
</table>
<hr>
<h2 id='anova.galamm'>Compare likelihoods of galamm objects</h2><span id='topic+anova.galamm'></span>

<h3>Description</h3>

<p>Anova function for comparing different GALAMMs fitted on the same data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'galamm'
anova(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="anova.galamm_+3A_object">object</code></td>
<td>
<p>An object of class <code>galamm</code> returned from
<code><a href="#topic+galamm">galamm</a></code>.</p>
</td></tr>
<tr><td><code id="anova.galamm_+3A_...">...</code></td>
<td>
<p>Other fitted models of class <code>galamm</code>. Currently, if no
models are provided in this argument, no table will be returned.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A table with model comparison metric.
</p>


<h3>Author(s)</h3>

<p>Some of the source code for this function is adapted from
<code>lme4:::anova.merMod</code>, with authors Douglas M. Bates, Martin Maechler,
Ben Bolker, and Steve Walker.
</p>


<h3>References</h3>

<p>Bates DM, Mächler M, Bolker B, Walker S (2015).
&ldquo;Fitting Linear Mixed-Effects Models Using Lme4.&rdquo;
<em>Journal of Statistical Software</em>, <b>67</b>(1), 1&ndash;48.
ISSN 1548-7660, <a href="https://doi.org/10.18637/jss.v067.i01">doi:10.18637/jss.v067.i01</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+summary.galamm">summary.galamm()</a></code> for the summary method and <code><a href="stats.html#topic+anova">anova()</a></code> for the
generic function.
</p>
<p>Other summary functions: 
<code><a href="#topic+plot.galamm">plot.galamm</a>()</code>,
<code><a href="#topic+plot_smooth.galamm">plot_smooth.galamm</a>()</code>,
<code><a href="#topic+print.summary.galamm">print.summary.galamm</a>()</code>,
<code><a href="#topic+summary.galamm">summary.galamm</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Poisson GLMM
count_mod &lt;- galamm(
  formula = y ~ lbas * treat + lage + v4 + (1 | subj),
  data = epilep, family = poisson
)

# Model without interaction
count_mod0 &lt;- galamm(
  formula = y ~ lbas + treat + lage + v4 + (1 | subj),
  data = epilep, family = poisson
)

# Model comparison
anova(count_mod, count_mod0)

</code></pre>

<hr>
<h2 id='coef.galamm'>Extract galamm coefficients</h2><span id='topic+coef.galamm'></span>

<h3>Description</h3>

<p>Currently, this function only returns the fixed effects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'galamm'
coef(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coef.galamm_+3A_object">object</code></td>
<td>
<p>An object of class <code>galamm</code>, from <code><a href="#topic+galamm">galamm</a></code>.</p>
</td></tr>
<tr><td><code id="coef.galamm_+3A_...">...</code></td>
<td>
<p>Additional parameters passed on to other methods. Currently not
used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix with the requested coefficients.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fixef.galamm">fixef.galamm()</a></code> for fixed effects, <code><a href="#topic+ranef.galamm">ranef.galamm()</a></code> for random
effects, and <code><a href="stats.html#topic+coef">coef()</a></code> for the generic function.
</p>
<p>Other details of model fit: 
<code><a href="#topic+VarCorr">VarCorr</a>()</code>,
<code><a href="#topic+confint.galamm">confint.galamm</a>()</code>,
<code><a href="#topic+deviance.galamm">deviance.galamm</a>()</code>,
<code><a href="#topic+factor_loadings.galamm">factor_loadings.galamm</a>()</code>,
<code><a href="#topic+family.galamm">family.galamm</a>()</code>,
<code><a href="#topic+fitted.galamm">fitted.galamm</a>()</code>,
<code><a href="#topic+fixef">fixef</a>()</code>,
<code><a href="#topic+llikAIC">llikAIC</a>()</code>,
<code><a href="#topic+logLik.galamm">logLik.galamm</a>()</code>,
<code><a href="#topic+predict.galamm">predict.galamm</a>()</code>,
<code><a href="#topic+print.VarCorr.galamm">print.VarCorr.galamm</a>()</code>,
<code><a href="#topic+ranef.galamm">ranef.galamm</a>()</code>,
<code><a href="#topic+residuals.galamm">residuals.galamm</a>()</code>,
<code><a href="#topic+sigma.galamm">sigma.galamm</a>()</code>,
<code><a href="#topic+vcov.galamm">vcov.galamm</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Poisson GLMM
count_mod &lt;- galamm(
  formula = y ~ lbas * treat + lage + v4 + (1 | subj),
  data = epilep, family = poisson
)

# Extract coefficients
coef(count_mod)

</code></pre>

<hr>
<h2 id='cognition'>Simulated Data with Measurements of Cognitive Abilities</h2><span id='topic+cognition'></span>

<h3>Description</h3>

<p>Simulated dataset mimicking the measurement of abilities in three cognitive
domains. The latent traits (cognitive ability in a given domain) are based on
the functions in <code>mgcv::gamSim</code>
(Wood 2017), and depend on the
explanatory variable x.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cognition
</code></pre>


<h3>Format</h3>



<h4><code>cognition</code> A data frame with 14400 rows and 7 columns:</h4>


<dl>
<dt>id</dt><dd><p>Subject ID.</p>
</dd>
<dt>domain</dt><dd><p>Factor variable denoting the cognitive domain.</p>
</dd>
<dt>x</dt><dd><p>Explanatory variable.</p>
</dd>
<dt>timepoint</dt><dd><p>Factor variable denoting the timepoint.</p>
</dd>
<dt>item</dt><dd><p>Factor variable denoting the item within the tests of each
cognitive domain.</p>
</dd>
<dt>trials</dt><dd><p>Number of trials, if applicable.</p>
</dd>
<dt>y</dt><dd><p>Response variable. For domain 1 a real number, for domain 2 a
binomially distributed variable based on a single trial, for
domain 3 a real number.</p>
</dd>
</dl>




<h3>References</h3>

<p>Wood SN (2017).
<em>Generalized Additive Models: An Introduction with R</em>, 2 edition.
Chapman and Hall/CRC.
</p>


<h3>See Also</h3>

<p>Other datasets: 
<code><a href="#topic+diet">diet</a></code>,
<code><a href="#topic+epilep">epilep</a></code>,
<code><a href="#topic+hsced">hsced</a></code>,
<code><a href="#topic+latent_covariates_long">latent_covariates_long</a></code>,
<code><a href="#topic+latent_covariates">latent_covariates</a></code>,
<code><a href="#topic+mresp_hsced">mresp_hsced</a></code>,
<code><a href="#topic+mresp">mresp</a></code>
</p>

<hr>
<h2 id='confint.galamm'>Confidence intervals for model parameters</h2><span id='topic+confint.galamm'></span>

<h3>Description</h3>

<p>Confidence intervals for model parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'galamm'
confint(object, parm, level = 0.95, method = "Wald", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="confint.galamm_+3A_object">object</code></td>
<td>
<p>An object of class <code>galamm</code> returned from
<code><a href="#topic+galamm">galamm</a></code>.</p>
</td></tr>
<tr><td><code id="confint.galamm_+3A_parm">parm</code></td>
<td>
<p>Parameters for which to compute intervals. Use <code>"theta"</code> to
get all variance parameters, <code>"beta"</code> to get all fixed regression
coefficients, <code>"lambda"</code> to get all factor loadings, and
<code>"weights"</code> to get all weights. The parameter can also be given as a
numeric vector with indices specifying the parameters.</p>
</td></tr>
<tr><td><code id="confint.galamm_+3A_level">level</code></td>
<td>
<p>Confidence level. Defaults to 0.95.</p>
</td></tr>
<tr><td><code id="confint.galamm_+3A_method">method</code></td>
<td>
<p>Currently only &quot;Wald&quot; is available.</p>
</td></tr>
<tr><td><code id="confint.galamm_+3A_...">...</code></td>
<td>
<p>Other arguments passed on to other methods. Currently not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix with the requested confidence intervals.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fixef.galamm">fixef.galamm()</a></code> for fixed effects, <code><a href="#topic+coef.galamm">coef.galamm()</a></code> for
coefficients more generally, and <code><a href="#topic+vcov.galamm">vcov.galamm()</a></code> for the variance-covariance
matrix. <code><a href="stats.html#topic+confint">confint()</a></code> is the generic function.
</p>
<p>Other details of model fit: 
<code><a href="#topic+VarCorr">VarCorr</a>()</code>,
<code><a href="#topic+coef.galamm">coef.galamm</a>()</code>,
<code><a href="#topic+deviance.galamm">deviance.galamm</a>()</code>,
<code><a href="#topic+factor_loadings.galamm">factor_loadings.galamm</a>()</code>,
<code><a href="#topic+family.galamm">family.galamm</a>()</code>,
<code><a href="#topic+fitted.galamm">fitted.galamm</a>()</code>,
<code><a href="#topic+fixef">fixef</a>()</code>,
<code><a href="#topic+llikAIC">llikAIC</a>()</code>,
<code><a href="#topic+logLik.galamm">logLik.galamm</a>()</code>,
<code><a href="#topic+predict.galamm">predict.galamm</a>()</code>,
<code><a href="#topic+print.VarCorr.galamm">print.VarCorr.galamm</a>()</code>,
<code><a href="#topic+ranef.galamm">ranef.galamm</a>()</code>,
<code><a href="#topic+residuals.galamm">residuals.galamm</a>()</code>,
<code><a href="#topic+sigma.galamm">sigma.galamm</a>()</code>,
<code><a href="#topic+vcov.galamm">vcov.galamm</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Poisson GLMM
count_mod &lt;- galamm(
  formula = y ~ lbas * treat + lage + v4 + (1 | subj),
  data = epilep, family = poisson
)

confint(count_mod, parm = "beta", level = .99)

</code></pre>

<hr>
<h2 id='deviance.galamm'>Extract deviance of galamm object</h2><span id='topic+deviance.galamm'></span>

<h3>Description</h3>

<p>Extract deviance of galamm object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'galamm'
deviance(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="deviance.galamm_+3A_object">object</code></td>
<td>
<p>Object of class <code>galamm</code>, returned from
<code><a href="#topic+galamm">galamm</a></code>.</p>
</td></tr>
<tr><td><code id="deviance.galamm_+3A_...">...</code></td>
<td>
<p>Other arguments passed on to other methods. Currently not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric value giving the deviance of the model fit.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+logLik.galamm">logLik.galamm()</a></code> for a function returning the log likelihood and
<code><a href="stats.html#topic+deviance">deviance()</a></code> for the generic function.
</p>
<p>Other details of model fit: 
<code><a href="#topic+VarCorr">VarCorr</a>()</code>,
<code><a href="#topic+coef.galamm">coef.galamm</a>()</code>,
<code><a href="#topic+confint.galamm">confint.galamm</a>()</code>,
<code><a href="#topic+factor_loadings.galamm">factor_loadings.galamm</a>()</code>,
<code><a href="#topic+family.galamm">family.galamm</a>()</code>,
<code><a href="#topic+fitted.galamm">fitted.galamm</a>()</code>,
<code><a href="#topic+fixef">fixef</a>()</code>,
<code><a href="#topic+llikAIC">llikAIC</a>()</code>,
<code><a href="#topic+logLik.galamm">logLik.galamm</a>()</code>,
<code><a href="#topic+predict.galamm">predict.galamm</a>()</code>,
<code><a href="#topic+print.VarCorr.galamm">print.VarCorr.galamm</a>()</code>,
<code><a href="#topic+ranef.galamm">ranef.galamm</a>()</code>,
<code><a href="#topic+residuals.galamm">residuals.galamm</a>()</code>,
<code><a href="#topic+sigma.galamm">sigma.galamm</a>()</code>,
<code><a href="#topic+vcov.galamm">vcov.galamm</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Linear mixed model with heteroscedastic residuals
mod &lt;- galamm(
  formula = y ~ x + (1 | id),
  weights = ~ (1 | item),
  data = hsced
)

# Extract deviance
deviance(mod)

</code></pre>

<hr>
<h2 id='diet'>Diet Data</h2><span id='topic+diet'></span>

<h3>Description</h3>

<p>Longitudinal epilepsy data from
Morris et al. (1977). This
documentation is based on Chapter 14.2 of
Skrondal and Rabe-Hesketh (2004), where the
dataset is used. See also
Rabe-Hesketh et al. (2003).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>diet
</code></pre>


<h3>Format</h3>



<h4><code>diet</code> A data frame with 236 rows and 7 columns:</h4>


<dl>
<dt>id</dt><dd><p>Subject ID.</p>
</dd>
<dt>age</dt><dd><p>Age (standardized).</p>
</dd>
<dt>bus</dt><dd><p>Dummy variable indicating whether the subject is a bus
driver or banking staff.</p>
</dd>
<dt>item</dt><dd><p>Integer indicating whether the outcome is fiber intake at
time 1 (item = 1), fiber intake at time 2 (item = 2), or coronary heart
disease (item = 3).</p>
</dd>
<dt>y</dt><dd><p>Outcome.</p>
</dd>
<dt>chd</dt><dd><p>Dummy variable indicating whether y is an indicator for
coronary heart disease, coded as 0/1.</p>
</dd>
<dt>fiber</dt><dd><p>Dummy variable indicating whether y is a fiber measurement
at either timepoint 1 or 2.</p>
</dd>
<dt>fiber2</dt><dd><p>Dummy variable indicating whether y is a fiber measurement
at timepoint 2.</p>
</dd>
</dl>




<h3>Source</h3>

<p><a href="http://www.gllamm.org/books/readme.html#14.2">http://www.gllamm.org/books/readme.html#14.2</a>
</p>


<h3>References</h3>

<p>Morris JN, Marr JW, Clayton DG (1977).
&ldquo;Diet and Heart: A Postscript.&rdquo;
<em>Br Med J</em>, <b>2</b>(6098), 1307&ndash;1314.
ISSN 0007-1447, 1468-5833, <a href="https://doi.org/10.1136/bmj.2.6098.1307">doi:10.1136/bmj.2.6098.1307</a>.<br /><br /> Rabe-Hesketh S, Pickles A, Skrondal A (2003).
&ldquo;Correcting for Covariate Measurement Error in Logistic Regression Using Nonparametric Maximum Likelihood Estimation.&rdquo;
<em>Statistical Modelling</em>, <b>3</b>(3), 215&ndash;232.
ISSN 1471-082X, <a href="https://doi.org/10.1191/1471082X03st056oa">doi:10.1191/1471082X03st056oa</a>.<br /><br /> Skrondal A, Rabe-Hesketh S (2004).
<em>Generalized Latent Variable Modeling</em>,  Interdisciplinary Statistics Series.
Chapman and Hall/CRC, Boca Raton, Florida.
</p>


<h3>See Also</h3>

<p>Other datasets: 
<code><a href="#topic+cognition">cognition</a></code>,
<code><a href="#topic+epilep">epilep</a></code>,
<code><a href="#topic+hsced">hsced</a></code>,
<code><a href="#topic+latent_covariates_long">latent_covariates_long</a></code>,
<code><a href="#topic+latent_covariates">latent_covariates</a></code>,
<code><a href="#topic+mresp_hsced">mresp_hsced</a></code>,
<code><a href="#topic+mresp">mresp</a></code>
</p>

<hr>
<h2 id='epilep'>Epilepsy Data</h2><span id='topic+epilep'></span>

<h3>Description</h3>

<p>Longitudinal epilepsy data from
Leppik et al. (1987). This
documentation is based on Chapter 11.3 of
Skrondal and Rabe-Hesketh (2004), where
the dataset is used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>epilep
</code></pre>


<h3>Format</h3>



<h4><code>epilep</code> A data frame with 236 rows and 7 columns:</h4>


<dl>
<dt>subj</dt><dd><p>Subject ID.</p>
</dd>
<dt>y</dt><dd><p>Number of seizures.</p>
</dd>
<dt>treat</dt><dd><p>Dummy variable for treatment group.</p>
</dd>
<dt>visit</dt><dd><p>Time at visit.</p>
</dd>
<dt>v4</dt><dd><p>Dummy for visit 4.</p>
</dd>
<dt>lage</dt><dd><p>Logarithm of age.</p>
</dd>
<dt>lbas</dt><dd><p>Logarithm of a quarter of the number of seizures in the eight
weeks preceding entry into the trial.</p>
</dd>
</dl>




<h3>Source</h3>

<p><a href="http://www.gllamm.org/books/readme.html#11.3">http://www.gllamm.org/books/readme.html#11.3</a>
</p>


<h3>References</h3>

<p>Leppik IE, Dreifuss FE, Porter R, Bowman T, Santilli N, Jacobs M, Crosby C, Cloyd J, Stackman J, Graves N, Sutula T, Welty T, Vickery J, Brundage R, Gates J, Gumnit RJ, Gutierrez A (1987).
&ldquo;A Controlled Study of Progabide in Partial Seizures: Methodology and Results.&rdquo;
<em>Neurology</em>, <b>37</b>(6), 963&ndash;963.
ISSN 0028-3878, 1526-632X, <a href="https://doi.org/10.1212/WNL.37.6.963">doi:10.1212/WNL.37.6.963</a>.<br /><br /> Skrondal A, Rabe-Hesketh S (2004).
<em>Generalized Latent Variable Modeling</em>,  Interdisciplinary Statistics Series.
Chapman and Hall/CRC, Boca Raton, Florida.
</p>


<h3>See Also</h3>

<p>Other datasets: 
<code><a href="#topic+cognition">cognition</a></code>,
<code><a href="#topic+diet">diet</a></code>,
<code><a href="#topic+hsced">hsced</a></code>,
<code><a href="#topic+latent_covariates_long">latent_covariates_long</a></code>,
<code><a href="#topic+latent_covariates">latent_covariates</a></code>,
<code><a href="#topic+mresp_hsced">mresp_hsced</a></code>,
<code><a href="#topic+mresp">mresp</a></code>
</p>

<hr>
<h2 id='extract_optim_parameters.galamm'>Extract parameters from fitted model for use as initial values</h2><span id='topic+extract_optim_parameters.galamm'></span><span id='topic+extract_optim_parameters'></span>

<h3>Description</h3>

<p>This function extracts parameter values from a fitted model object in a form
that can be directly provided as initial values for a new model fit.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'galamm'
extract_optim_parameters(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extract_optim_parameters.galamm_+3A_object">object</code></td>
<td>
<p>Object of class <code>galamm</code> returned from
<code><a href="#topic+galamm">galamm</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>list</code> object containing the following elements:
</p>

<ul>
<li> <p><code>theta</code> Numerical vector of variance components, i.e., entries of
the lower Cholesky form of the covariance matrix of random effects.
</p>
</li>
<li> <p><code>beta</code> Fixed regression coefficients.
</p>
</li>
<li> <p><code>lambda</code> Factor loadings.
</p>
</li>
<li> <p><code>weights</code> Weights for heteroscedastic residuals.
</p>
</li></ul>



<h3>See Also</h3>

<p>Other optimization functions: 
<code><a href="#topic+galamm_control">galamm_control</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Fit linear mixed model with heteroscedastic residuals
mod &lt;- galamm(
  formula = y ~ x + (1 | id),
  weights = ~ (1 | item),
  data = hsced
)

# Extract parameters
start &lt;- extract_optim_parameters(mod)

# Fit again using the Nelder-Mead algorithm, using start as initial values:
mod_nm &lt;- galamm(
  formula = y ~ x + (1 | id),
  weights = ~ (1 | item),
  data = hsced,
  start = start,
  control = galamm_control(method = "Nelder-Mead")
)

</code></pre>

<hr>
<h2 id='factor_loadings.galamm'>Extract factor loadings from galamm object</h2><span id='topic+factor_loadings.galamm'></span><span id='topic+factor_loadings'></span>

<h3>Description</h3>

<p>Extract factor loadings from galamm object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'galamm'
factor_loadings(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="factor_loadings.galamm_+3A_object">object</code></td>
<td>
<p>Object of class <code>galamm</code> returned from
<code><a href="#topic+galamm">galamm</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function has been named <code>factor_loadings</code> rather than just
<code>loadings</code> to avoid conflict with <code>stats::loadings</code>.
</p>


<h3>Value</h3>

<p>A matrix containing the estimated factor loadings with corresponding
standard deviations.
</p>


<h3>Author(s)</h3>

<p>The example for this function comes from <code>PLmixed</code>, with
authors Nicholas Rockwood and Minjeong Jeon
(Rockwood and Jeon 2019).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fixef.galamm">fixef.galamm()</a></code> for fixed regression coefficients,
<code><a href="#topic+confint.galamm">confint.galamm()</a></code> for confidence intervals, and <code><a href="#topic+coef.galamm">coef.galamm()</a></code> for
coefficients more generally.
</p>
<p>Other details of model fit: 
<code><a href="#topic+VarCorr">VarCorr</a>()</code>,
<code><a href="#topic+coef.galamm">coef.galamm</a>()</code>,
<code><a href="#topic+confint.galamm">confint.galamm</a>()</code>,
<code><a href="#topic+deviance.galamm">deviance.galamm</a>()</code>,
<code><a href="#topic+family.galamm">family.galamm</a>()</code>,
<code><a href="#topic+fitted.galamm">fitted.galamm</a>()</code>,
<code><a href="#topic+fixef">fixef</a>()</code>,
<code><a href="#topic+llikAIC">llikAIC</a>()</code>,
<code><a href="#topic+logLik.galamm">logLik.galamm</a>()</code>,
<code><a href="#topic+predict.galamm">predict.galamm</a>()</code>,
<code><a href="#topic+print.VarCorr.galamm">print.VarCorr.galamm</a>()</code>,
<code><a href="#topic+ranef.galamm">ranef.galamm</a>()</code>,
<code><a href="#topic+residuals.galamm">residuals.galamm</a>()</code>,
<code><a href="#topic+sigma.galamm">sigma.galamm</a>()</code>,
<code><a href="#topic+vcov.galamm">vcov.galamm</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Logistic mixed model with factor loadings, example from PLmixed
data("IRTsim", package = "PLmixed")

# Reduce data size for the example to run faster
IRTsub &lt;- IRTsim[IRTsim$item &lt; 4, ]
IRTsub &lt;- IRTsub[sample(nrow(IRTsub), 300), ]
IRTsub$item &lt;- factor(IRTsub$item)

# Fix loading for first item to 1, and estimate the two others freely
loading_matrix &lt;- matrix(c(1, NA, NA), ncol = 1)

# Estimate model
mod &lt;- galamm(y ~ item + (0 + ability | sid) + (0 + ability | school),
  data = IRTsub, family = binomial, load.var = "item",
  factor = list("ability"), lambda = list(loading_matrix)
)

# Show estimated factor loadings, with standard errors
factor_loadings(mod)

</code></pre>

<hr>
<h2 id='family.galamm'>Extract family or families from fitted galamm</h2><span id='topic+family.galamm'></span>

<h3>Description</h3>

<p>This function returns a list of families for an object of class
<code>galamm</code>, returned from <code><a href="#topic+galamm">galamm</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'galamm'
family(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="family.galamm_+3A_object">object</code></td>
<td>
<p>An object of class <code>galamm</code>.</p>
</td></tr>
<tr><td><code id="family.galamm_+3A_...">...</code></td>
<td>
<p>Optional arguments. Currently not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of family objects.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+galamm">galamm()</a></code>
</p>
<p>Other details of model fit: 
<code><a href="#topic+VarCorr">VarCorr</a>()</code>,
<code><a href="#topic+coef.galamm">coef.galamm</a>()</code>,
<code><a href="#topic+confint.galamm">confint.galamm</a>()</code>,
<code><a href="#topic+deviance.galamm">deviance.galamm</a>()</code>,
<code><a href="#topic+factor_loadings.galamm">factor_loadings.galamm</a>()</code>,
<code><a href="#topic+fitted.galamm">fitted.galamm</a>()</code>,
<code><a href="#topic+fixef">fixef</a>()</code>,
<code><a href="#topic+llikAIC">llikAIC</a>()</code>,
<code><a href="#topic+logLik.galamm">logLik.galamm</a>()</code>,
<code><a href="#topic+predict.galamm">predict.galamm</a>()</code>,
<code><a href="#topic+print.VarCorr.galamm">print.VarCorr.galamm</a>()</code>,
<code><a href="#topic+ranef.galamm">ranef.galamm</a>()</code>,
<code><a href="#topic+residuals.galamm">residuals.galamm</a>()</code>,
<code><a href="#topic+sigma.galamm">sigma.galamm</a>()</code>,
<code><a href="#topic+vcov.galamm">vcov.galamm</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Mixed response model
loading_matrix &lt;- matrix(c(1, NA), ncol = 1)
families &lt;- c(gaussian, binomial)
family_mapping &lt;- ifelse(mresp$itemgroup == "a", 1, 2)

mixed_resp &lt;- galamm(
  formula = y ~ x + (0 + level | id),
  data = mresp,
  family = families,
  family_mapping = family_mapping,
  load.var = "itemgroup",
  lambda = list(loading_matrix),
  factor = list("level")
)

# This model has two family objects
family(mixed_resp)

</code></pre>

<hr>
<h2 id='fitted.galamm'>Extract model fitted values</h2><span id='topic+fitted.galamm'></span>

<h3>Description</h3>

<p>Extracts fitted values from a model including random effects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'galamm'
fitted(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitted.galamm_+3A_object">object</code></td>
<td>
<p>An object of class <code>galamm</code> returned from
<code><a href="#topic+galamm">galamm</a></code>.</p>
</td></tr>
<tr><td><code id="fitted.galamm_+3A_...">...</code></td>
<td>
<p>Optional arguments passed on to other methods. Currently not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numerical vector with fit values for each row in the input data.
</p>


<h3>See Also</h3>

<p>Other details of model fit: 
<code><a href="#topic+VarCorr">VarCorr</a>()</code>,
<code><a href="#topic+coef.galamm">coef.galamm</a>()</code>,
<code><a href="#topic+confint.galamm">confint.galamm</a>()</code>,
<code><a href="#topic+deviance.galamm">deviance.galamm</a>()</code>,
<code><a href="#topic+factor_loadings.galamm">factor_loadings.galamm</a>()</code>,
<code><a href="#topic+family.galamm">family.galamm</a>()</code>,
<code><a href="#topic+fixef">fixef</a>()</code>,
<code><a href="#topic+llikAIC">llikAIC</a>()</code>,
<code><a href="#topic+logLik.galamm">logLik.galamm</a>()</code>,
<code><a href="#topic+predict.galamm">predict.galamm</a>()</code>,
<code><a href="#topic+print.VarCorr.galamm">print.VarCorr.galamm</a>()</code>,
<code><a href="#topic+ranef.galamm">ranef.galamm</a>()</code>,
<code><a href="#topic+residuals.galamm">residuals.galamm</a>()</code>,
<code><a href="#topic+sigma.galamm">sigma.galamm</a>()</code>,
<code><a href="#topic+vcov.galamm">vcov.galamm</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Linear mixed model with heteroscedastic residuals
mod &lt;- galamm(
  formula = y ~ x + (1 | id),
  weights = ~ (1 | item),
  data = hsced
)

# Extract fitted values and plot against x
plot(hsced$x, fitted(mod))

</code></pre>

<hr>
<h2 id='fixef'>Extract fixed effects from galamm objects</h2><span id='topic+fixef'></span><span id='topic+fixef.galamm'></span>

<h3>Description</h3>

<p>Extract the fixed regression coefficients.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'galamm'
fixef(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fixef_+3A_object">object</code></td>
<td>
<p>An object of class <code>galamm</code>, returned from
<code><a href="#topic+galamm">galamm</a></code>.</p>
</td></tr>
<tr><td><code id="fixef_+3A_...">...</code></td>
<td>
<p>Optional parameters passed on to other functions. Currently
not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named <code>numeric</code> vector containing the requested fixed effects.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ranef.galamm">ranef.galamm()</a></code> for random effects, <code><a href="#topic+coef.galamm">coef.galamm()</a></code> for
coefficients more generally, and <code><a href="#topic+confint.galamm">confint.galamm()</a></code> for confidence intervals.
</p>
<p>Other details of model fit: 
<code><a href="#topic+VarCorr">VarCorr</a>()</code>,
<code><a href="#topic+coef.galamm">coef.galamm</a>()</code>,
<code><a href="#topic+confint.galamm">confint.galamm</a>()</code>,
<code><a href="#topic+deviance.galamm">deviance.galamm</a>()</code>,
<code><a href="#topic+factor_loadings.galamm">factor_loadings.galamm</a>()</code>,
<code><a href="#topic+family.galamm">family.galamm</a>()</code>,
<code><a href="#topic+fitted.galamm">fitted.galamm</a>()</code>,
<code><a href="#topic+llikAIC">llikAIC</a>()</code>,
<code><a href="#topic+logLik.galamm">logLik.galamm</a>()</code>,
<code><a href="#topic+predict.galamm">predict.galamm</a>()</code>,
<code><a href="#topic+print.VarCorr.galamm">print.VarCorr.galamm</a>()</code>,
<code><a href="#topic+ranef.galamm">ranef.galamm</a>()</code>,
<code><a href="#topic+residuals.galamm">residuals.galamm</a>()</code>,
<code><a href="#topic+sigma.galamm">sigma.galamm</a>()</code>,
<code><a href="#topic+vcov.galamm">vcov.galamm</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Poisson GLMM
count_mod &lt;- galamm(
  formula = y ~ lbas * treat + lage + v4 + (1 | subj),
  data = epilep, family = poisson
)

# Extract fixed effects
fixef(count_mod)

</code></pre>

<hr>
<h2 id='galamm'>Fit a generalized additive latent and mixed model</h2><span id='topic+galamm'></span>

<h3>Description</h3>

<p>This function fits a generalized additive latent and mixed model (GALAMMs),
as described in
Sørensen et al. (2023).
The building blocks of these models are generalized additive mixed models
(GAMMs) (Wood 2017), of which
generalized linear mixed models
(Breslow and Clayton 1993; Harville 1977; Henderson 1975; Laird and Ware 1982)
are special cases. GALAMMs extend upon GAMMs by allowing factor structures,
as commonly used to model hypothesized latent traits underlying observed
measurements. In this sense, GALAMMs are an extension of generalized linear
latent and mixed models (GLLAMMs)
(Skrondal and Rabe-Hesketh 2004; Rabe-Hesketh et al. 2004)
which allows semiparametric estimation. The implemented algorithm used to
compute model estimates is described in
Sørensen et al. (2023),
and is an extension of the algorithm used for fitting generalized linear
mixed models by the <code>lme4</code> package
(Bates et al. 2015). The syntax used to
define factor structures is based on that used by the <code>PLmixed</code> package,
which is detailed in
Rockwood and Jeon (2019).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>galamm(
  formula,
  weights = NULL,
  data,
  family = gaussian,
  family_mapping = rep(1L, nrow(data)),
  load.var = NULL,
  lambda = NULL,
  factor = NULL,
  factor_interactions = NULL,
  start = NULL,
  control = galamm_control()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="galamm_+3A_formula">formula</code></td>
<td>
<p>A formula specifying the model. Smooth terms are defined in
the style of the <code>mgcv</code> and <code>gamm4</code> packages, see
(Wood 2017) for an
introduction. Random effects are specified using <code>lme4</code> syntax, which
is described in detail in
(Bates et al. 2015). Factor loadings
will also be part of the model formula, and is based on the syntax of the
<code>PLmixed</code> package
(Rockwood and Jeon 2019).</p>
</td></tr>
<tr><td><code id="galamm_+3A_weights">weights</code></td>
<td>
<p>An optional formula object specifying an expression for the
residual variance. Defaults to <code>NULL</code>, corresponding to homoscedastic
errors. The formula is defined in <code>lme4</code> style; see vignettes and
examples for details.</p>
</td></tr>
<tr><td><code id="galamm_+3A_data">data</code></td>
<td>
<p>A data.frame containing all the variables specified by the model
formula, with the exception of factor loadings.</p>
</td></tr>
<tr><td><code id="galamm_+3A_family">family</code></td>
<td>
<p>A vector containing one or more model families. For each
element in <code>family</code> there should be a corresponding element in
<code>family_mapping</code> specifying which elements of the response are
conditionally distributed according to the given family. Currently family
can be one of <code>gaussian</code>, <code>binomial</code>, and <code>poisson</code>, and
only canonical link functions are supported.</p>
</td></tr>
<tr><td><code id="galamm_+3A_family_mapping">family_mapping</code></td>
<td>
<p>Optional integer vector mapping from the elements of
<code>family</code> to rows of <code>data</code>. Defaults to <code>rep(1L,
  nrow(data))</code>, which means that all observations are distributed according
to the first element of <code>family</code>.</p>
</td></tr>
<tr><td><code id="galamm_+3A_load.var">load.var</code></td>
<td>
<p>Optional character specifying the name of the variable in
<code>data</code> identifying what the factors load onto. That is, each unique
value of <code>load.var</code> corresponds to a unique factor loading. Currently
only a single loading is supported, so <code>load.var</code> must have length
one. Default to <code>NULL</code>, which means that there are no loading
variables.</p>
</td></tr>
<tr><td><code id="galamm_+3A_lambda">lambda</code></td>
<td>
<p>Optional list of factor loading matrices. Numerical values
indicate that the given value is fixed, while <code>NA</code> means that the
entry is a parameter to be estimated. Defaults to <code>NULL</code>, which means
that there are no factor loading matrices.</p>
</td></tr>
<tr><td><code id="galamm_+3A_factor">factor</code></td>
<td>
<p>Optional list of character vectors identical to the factor
loadings specified in <code>formula</code>. For each list element, the <code class="reqn">j</code>th
entry in the character vector corresponds to the <code class="reqn">j</code>th column of the
corresponding matrix in <code>lambda</code>. Defaults to <code>NULL</code>, which means
that there are no factor loadings.</p>
</td></tr>
<tr><td><code id="galamm_+3A_factor_interactions">factor_interactions</code></td>
<td>
<p>Optional list of length equal to the list provided
in the <code>factor</code> argument. If provided, each element of the lists
should itself be a list of length equal to the number of columns in the
corresponding matrix provided to the <code>lambda</code> argument. Each list
element should be a <code>formula</code> object containing the write-hand side of
a regression model, of the form <code>~ x + z</code>. Defaults to <code>NULL</code>,
which means that no factor interactions are used.</p>
</td></tr>
<tr><td><code id="galamm_+3A_start">start</code></td>
<td>
<p>Optional named list of starting values for parameters. Possible
names of list elements are <code>"theta"</code>, <code>"beta"</code>, <code>"lambda"</code>,
and <code>"weights"</code>, all of should be numerical vectors with starting
values. Default to <code>NULL</code>, which means that some relatively sensible
defaults are used.</p>
</td></tr>
<tr><td><code id="galamm_+3A_control">control</code></td>
<td>
<p>Optional control object for the optimization procedure of
class <code>galamm_control</code> resulting from calling
<code><a href="#topic+galamm_control">galamm_control</a></code>. Defaults to <code>NULL</code>, which means that the
defaults of <code><a href="#topic+galamm_control">galamm_control</a></code> are used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A model object of class <code>galamm</code>, containing the following
elements:
</p>

<ul>
<li> <p><code>call</code> the matched call used when fitting the model.
</p>
</li>
<li> <p><code>random_effects</code> a list containing the following two elements:
</p>

<ul>
<li> <p><code>b</code> random effects in original parametrization.
</p>
</li>
<li> <p><code>u</code> random effects standardized to have identity covariance matrix.
</p>
</li></ul>

</li>
<li> <p><code>model</code> a list with various elements related to the model setup and
fit:
</p>

<ul>
<li> <p><code>deviance</code> deviance of final model.
</p>
</li>
<li> <p><code>deviance_residuals</code> deviance residuals of the final model.
</p>
</li>
<li> <p><code>df</code> degrees of freedom of model.
</p>
</li>
<li> <p><code>family</code> a list of one or more family objects, as specified in the
<code>family</code> arguments to <code>galamm</code>.
</p>
</li>
<li> <p><code>factor_interactions</code> List of formulas specifying interactions
between latent and observed variables, as provided to the argument
<code>factor_interactions</code> to <code>galamm</code>. If not provided, it is
<code>NULL</code>.
</p>
</li>
<li> <p><code>fit</code> a numeric vector with fitted values.
</p>
</li>
<li> <p><code>fit_population</code> a numeric vector with fitted values excluding
random effects.
</p>
</li>
<li> <p><code>hessian</code> Hessian matrix of final model, i.e., the second
derivative of the log-likelihood with respect to all model parameters.
</p>
</li>
<li> <p><code>lmod</code> Linear model object returned by <code>lme4::lFormula</code>, which
is used internally for setting up the models.
</p>
</li>
<li> <p><code>loglik</code> Log-likelihood of final model.
</p>
</li>
<li> <p><code>n</code> Number of observations.
</p>
</li>
<li> <p><code>pearson_residual</code> Pearson residuals of final model.
</p>
</li>
<li> <p><code>reduced_hessian</code> Logical specifying whether the full Hessian
matrix was computed, or a Hessian matrix with derivatives only with respect
to beta and lambda.
</p>
</li>
<li> <p><code>response</code> A numeric vector containing the response values used when
fitting the model.
</p>
</li>
<li> <p><code>weights_object</code> Object with weights used in model fitting. Is
<code>NULL</code> when no weights were used.
</p>
</li></ul>

</li>
<li> <p><code>parameters</code> A list object with model parameters and related
information:
</p>

<ul>
<li> <p><code>beta_inds</code> Integer vector specifying the indices of fixed
regression coefficients among the estimated model parameters.
</p>
</li>
<li> <p><code>dispersion_parameter</code> One or more dispersion parameters of the
final model.
</p>
</li>
<li> <p><code>lambda_dummy</code> Dummy matrix of factor loadings, which shows the
structure of the loading matrix that was supplied in the <code>lambda</code>
arguments.
</p>
</li>
<li> <p><code>lambda_inds</code> Integer vector specifying the indices of factor
loadings among the estimated model parameters.
</p>
</li>
<li> <p><code>lambda_interaction_inds</code> Integer vector specifying the indices
of regression coefficients for interactions between latent and observed
variables.
</p>
</li>
<li> <p><code>parameter_estimates</code> Numeric vector of final parameter estimates.
</p>
</li>
<li> <p><code>parameter_names</code> Names of all parameters estimates.
</p>
</li>
<li> <p><code>theta_inds</code> Integer vector specifying the indices of variance
components among the estimated model parameters. Technically these are the
entries of the Cholesky decomposition of the covariance matrix.
</p>
</li>
<li> <p><code>weights_inds</code> Integer vector specifying the indices of estimated
weights (used in heteroscedastic Gaussian models) among the estimated model
parameters.
</p>
</li></ul>

</li>
<li> <p><code>gam</code> List containing information about smooth terms in the model.
If no smooth terms are contained in the model, then it is a list of length
zero.
</p>
</li></ul>



<h3>References</h3>

<p>Bates DM, Mächler M, Bolker B, Walker S (2015).
&ldquo;Fitting Linear Mixed-Effects Models Using Lme4.&rdquo;
<em>Journal of Statistical Software</em>, <b>67</b>(1), 1&ndash;48.
ISSN 1548-7660, <a href="https://doi.org/10.18637/jss.v067.i01">doi:10.18637/jss.v067.i01</a>.<br /><br /> Breslow NE, Clayton DG (1993).
&ldquo;Approximate Inference in Generalized Linear Mixed Models.&rdquo;
<em>Journal of the American Statistical Association</em>, <b>88</b>(421), 9&ndash;25.
ISSN 0162-1459, <a href="https://doi.org/10.2307/2290687">doi:10.2307/2290687</a>.<br /><br /> Harville DA (1977).
&ldquo;Maximum Likelihood Approaches to Variance Component Estimation and to Related Problems.&rdquo;
<em>Journal of the American Statistical Association</em>, <b>72</b>(358), 320&ndash;338.
ISSN 0162-1459, <a href="https://doi.org/10.2307/2286796">doi:10.2307/2286796</a>.<br /><br /> Henderson CR (1975).
&ldquo;Best Linear Unbiased Estimation and Prediction under a Selection Model.&rdquo;
<em>Biometrics</em>, <b>31</b>(2), 423&ndash;447.
ISSN 0006-341X, <a href="https://doi.org/10.2307/2529430">doi:10.2307/2529430</a>.<br /><br /> Laird NM, Ware JH (1982).
&ldquo;Random-Effects Models for Longitudinal Data.&rdquo;
<em>Biometrics</em>, <b>38</b>(4), 963&ndash;974.
ISSN 0006-341X, <a href="https://doi.org/10.2307/2529876">doi:10.2307/2529876</a>.<br /><br /> Rabe-Hesketh S, Skrondal A, Pickles A (2004).
&ldquo;Generalized Multilevel Structural Equation Modeling.&rdquo;
<em>Psychometrika</em>, <b>69</b>(2), 167&ndash;190.
ISSN 1860-0980, <a href="https://doi.org/10.1007/BF02295939">doi:10.1007/BF02295939</a>.<br /><br /> Rockwood NJ, Jeon M (2019).
&ldquo;Estimating Complex Measurement and Growth Models Using the R Package PLmixed.&rdquo;
<em>Multivariate Behavioral Research</em>, <b>54</b>(2), 288&ndash;306.
ISSN 0027-3171, <a href="https://doi.org/10.1080/00273171.2018.1516541">doi:10.1080/00273171.2018.1516541</a>.<br /><br /> Skrondal A, Rabe-Hesketh S (2004).
<em>Generalized Latent Variable Modeling</em>,  Interdisciplinary Statistics Series.
Chapman and Hall/CRC, Boca Raton, Florida.<br /><br /> Sørensen Ø, Fjell AM, Walhovd KB (2023).
&ldquo;Longitudinal Modeling of Age-Dependent Latent Traits with Generalized Additive Latent and Mixed Models.&rdquo;
<em>Psychometrika</em>, <b>88</b>(2), 456&ndash;486.
ISSN 1860-0980, <a href="https://doi.org/10.1007/s11336-023-09910-z">doi:10.1007/s11336-023-09910-z</a>.<br /><br /> Wood SN (2017).
<em>Generalized Additive Models: An Introduction with R</em>, 2 edition.
Chapman and Hall/CRC.
</p>


<h3>See Also</h3>

<p>Other modeling functions: 
<code><a href="#topic+s">s</a>()</code>,
<code><a href="#topic+t2">t2</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Mixed response model ------------------------------------------------------

# The mresp dataset contains a mix of binomial and Gaussian responses.

# We need to estimate a factor loading which scales the two response types.
loading_matrix &lt;- matrix(c(1, NA), ncol = 1)

# Define mapping to families.
families &lt;- c(gaussian, binomial)
family_mapping &lt;- ifelse(mresp$itemgroup == "a", 1, 2)


# Fit the model
mod &lt;- galamm(
  formula = y ~ x + (0 + level | id),
  data = mresp,
  family = families,
  family_mapping = family_mapping,
  factor = list("level"),
  load.var = "itemgroup",
  lambda = list(loading_matrix)
)

# Summary information
summary(mod)


# Heteroscedastic model -----------------------------------------------------
# Residuals allowed to differ according to the item variable
# We also set the initial value of the random intercept standard deviation
# to 1
mod &lt;- galamm(
  formula = y ~ x + (1 | id), weights = ~ (1 | item),
  data = hsced, start = list(theta = 1)
)
summary(mod)

# Generalized additive mixed model with factor structures -------------------

# The cognition dataset contains simulated measurements of three latent
# time-dependent processes, corresponding to individuals' abilities in
# cognitive domains. We focus here on the first domain, and take a single
# random timepoint per person:
dat &lt;- subset(cognition, domain == 1)
dat &lt;- split(dat, f = dat$id)
dat &lt;- lapply(dat, function(x) x[x$timepoint %in% sample(x$timepoint, 1), ])
dat &lt;- do.call(rbind, dat)
dat$item &lt;- factor(dat$item)

# At each timepoint there are three items measuring ability in the cognitive
# domain. We fix the factor loading for the first measurement to one, and
# estimate the remaining two. This is specified in the loading matrix.
loading_matrix &lt;- matrix(c(1, NA, NA), ncol = 1)

# We can now estimate the model.
mod &lt;- galamm(
  formula = y ~ 0 + item + sl(x, factor = "loading") +
    (0 + loading | id),
  data = dat,
  load.var = "item",
  lambda = list(loading_matrix),
  factor = list("loading")
)

# We can plot the estimated smooth term
plot_smooth(mod, shade = TRUE)


# Interaction between observed and latent covariates ------------------------
# Define the loading matrix
lambda &lt;- list(matrix(c(1, NA, NA), ncol = 1))

# Define the regression functions, one for each row in the loading matrix
factor_interactions &lt;- list(list(~1, ~1, ~x))

# Fit the model
mod &lt;- galamm(
  formula = y ~ type + x:response + (0 + loading | id),
  data = latent_covariates,
  load.var = "type",
  lambda = lambda,
  factor = list("loading"),
  factor_interactions = factor_interactions
)

# The summary output now include an interaction between the latent variable
# and x, for predicting the third element in "type"
summary(mod)

</code></pre>

<hr>
<h2 id='galamm_control'>Control values for galamm fit</h2><span id='topic+galamm_control'></span>

<h3>Description</h3>

<p>This function can be called for controling the optimization procedure used
when fitting GALAMMs using <code><a href="#topic+galamm">galamm</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>galamm_control(
  optim_control = list(),
  method = c("L-BFGS-B", "Nelder-Mead"),
  maxit_conditional_modes = 10,
  pwirls_tol_abs = 0.01,
  reduced_hessian = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="galamm_control_+3A_optim_control">optim_control</code></td>
<td>
<p>List containing optimization parameters. If <code>method
  = "L-BFGS-B"</code> it is passed on to <code>stats::optim</code>'s <code>control</code>
argument and if <code>method = "Nelder-Mead"</code>, it is passed on to
<code>lme4::Nelder_Mead</code>'s control argument. If not otherwise specified,
and <code>method = "L-BFGS-B"</code>, the following arguments are set to
non-default values: <code>fnscale = -1</code> and <code>lmm = 20</code>.</p>
</td></tr>
<tr><td><code id="galamm_control_+3A_method">method</code></td>
<td>
<p>Character string defining the algorithm to be used for
maximizing the marginal log-likelihood. The default is <code>"L-BFGS-B"</code>,
which uses the limited memory Broyden-Fletcher-Goldfarb-Shanno algorithm
with box constrained as implemented in <code>stats::optim</code>. The other
options is <code>"Nelder-Mead"</code>, which calls the Nelder-Mead algorithm with
box constraints implemented in <code>lme4::Nelder_Mead</code>.</p>
</td></tr>
<tr><td><code id="galamm_control_+3A_maxit_conditional_modes">maxit_conditional_modes</code></td>
<td>
<p>Maximum number of iterations in penalized
iteratively reweighted least squares algorithm. Ignored if <code>family =
  "gaussian"</code> for all observations, since then a single step gives the exact
answer.</p>
</td></tr>
<tr><td><code id="galamm_control_+3A_pwirls_tol_abs">pwirls_tol_abs</code></td>
<td>
<p>Absolute convergence criterion for penalized
iteratively reweighted least squares algorithm. Defaults to 0.01, which
means that when the reduction in marginal likelihood between two iterations
is below 0.01, the iterations stop.</p>
</td></tr>
<tr><td><code id="galamm_control_+3A_reduced_hessian">reduced_hessian</code></td>
<td>
<p>Logical value. Defaults to <code>TRUE</code>, which means
that the full Hessian matrix at the maximum marginal likelihood solution is
computed. If <code>FALSE</code>, a reduced Hessian matrix with second order
partial derivatives with respect to fixed regression coefficients and
factor loadings. The latter can help is the full Hessian is not positive
definite.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Object of class <code>galamm_control</code>, which typically will be
provided as an argument to <code><a href="#topic+galamm">galamm</a></code>.
</p>


<h3>References</h3>

<p>Bates DM, Mächler M, Bolker B, Walker S (2015).
&ldquo;Fitting Linear Mixed-Effects Models Using Lme4.&rdquo;
<em>Journal of Statistical Software</em>, <b>67</b>(1), 1&ndash;48.
ISSN 1548-7660, <a href="https://doi.org/10.18637/jss.v067.i01">doi:10.18637/jss.v067.i01</a>.
</p>
<p>BROYDEN CG (1970).
&ldquo;The Convergence of a Class of Double-rank Minimization Algorithms 1. General Considerations.&rdquo;
<em>IMA Journal of Applied Mathematics</em>, <b>6</b>(1), 76&ndash;90.
ISSN 0272-4960, <a href="https://doi.org/10.1093/imamat/6.1.76">doi:10.1093/imamat/6.1.76</a>.
</p>
<p>Byrd RH, Lu P, Nocedal J, Zhu C (1995).
&ldquo;A Limited Memory Algorithm for Bound Constrained Optimization.&rdquo;
<em>SIAM Journal on Scientific Computing</em>, <b>16</b>(5), 1190&ndash;1208.
ISSN 1064-8275, <a href="https://doi.org/10.1137/0916069">doi:10.1137/0916069</a>.
</p>
<p>Fletcher R (1970).
&ldquo;A New Approach to Variable Metric Algorithms.&rdquo;
<em>The Computer Journal</em>, <b>13</b>(3), 317&ndash;322.
ISSN 0010-4620, <a href="https://doi.org/10.1093/comjnl/13.3.317">doi:10.1093/comjnl/13.3.317</a>.
</p>
<p>Goldfarb D (1970).
&ldquo;A Family of Variable-Metric Methods Derived by Variational Means.&rdquo;
<em>Mathematics of Computation</em>, <b>24</b>(109), 23&ndash;26.
ISSN 0025-5718, 1088-6842, <a href="https://doi.org/10.1090/S0025-5718-1970-0258249-6">doi:10.1090/S0025-5718-1970-0258249-6</a>.
</p>
<p>Nelder JA, Mead R (1965).
&ldquo;A Simplex Method for Function Minimization.&rdquo;
<em>The Computer Journal</em>, <b>7</b>(4), 308&ndash;313.
ISSN 0010-4620, <a href="https://doi.org/10.1093/comjnl/7.4.308">doi:10.1093/comjnl/7.4.308</a>.
</p>
<p>Shanno DF (1970).
&ldquo;Conditioning of Quasi-Newton Methods for Function Minimization.&rdquo;
<em>Mathematics of Computation</em>, <b>24</b>(111), 647&ndash;656.
ISSN 0025-5718, 1088-6842, <a href="https://doi.org/10.1090/S0025-5718-1970-0274029-X">doi:10.1090/S0025-5718-1970-0274029-X</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+galamm">galamm()</a></code>
</p>
<p>Other optimization functions: 
<code><a href="#topic+extract_optim_parameters.galamm">extract_optim_parameters.galamm</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Define control object with quite a high degree of verbosity (trace = 6)
# and using the last 20 BFGS updates to estimate the Hessian in L-BFGS-B.
control &lt;- galamm_control(optim_control = list(trace = 6, lmm = 20))

</code></pre>

<hr>
<h2 id='galamm-package'>galamm: Generalized Additive Latent and Mixed Models</h2><span id='topic+galamm-package'></span>

<h3>Description</h3>

<p><img src="../help/figures/logo.png" style='float: right' alt='logo' width='120' />
</p>
<p>Estimates generalized additive latent and mixed models using maximum marginal likelihood, as defined in Sorensen et al. (2023) <a href="https://doi.org/10.1007/s11336-023-09910-z">doi:10.1007/s11336-023-09910-z</a>, which is an extension of Rabe-Hesketh and Skrondal (2004)'s unifying framework for multilevel latent variable modeling <a href="https://doi.org/10.1007/BF02295939">doi:10.1007/BF02295939</a>. Efficient computation is done using sparse matrix methods, Laplace approximation, and automatic differentiation. The framework includes generalized multilevel models with heteroscedastic residuals, mixed response types, factor loadings, smoothing splines, crossed random effects, and combinations thereof. Syntax for model formulation is close to 'lme4' (Bates et al. (2015) <a href="https://doi.org/10.18637/jss.v067.i01">doi:10.18637/jss.v067.i01</a>) and 'PLmixed' (Rockwood and Jeon (2019) <a href="https://doi.org/10.1080/00273171.2018.1516541">doi:10.1080/00273171.2018.1516541</a>).
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Øystein Sørensen <a href="mailto:oystein.sorensen@psykologi.uio.no">oystein.sorensen@psykologi.uio.no</a> (<a href="https://orcid.org/0000-0003-0724-3542">ORCID</a>)
</p>
<p>Other contributors:
</p>

<ul>
<li><p> Douglas Bates [contributor]
</p>
</li>
<li><p> Ben Bolker [contributor]
</p>
</li>
<li><p> Martin Maechler [contributor]
</p>
</li>
<li><p> Allan Leal [contributor]
</p>
</li>
<li><p> Fabian Scheipl [contributor]
</p>
</li>
<li><p> Steven Walker [contributor]
</p>
</li>
<li><p> Simon Wood [contributor]
</p>
</li></ul>



<h3>References</h3>

<p>Sørensen Ø, Fjell AM, Walhovd KB (2023).
&ldquo;Longitudinal Modeling of Age-Dependent Latent Traits with Generalized Additive Latent and Mixed Models.&rdquo;
<em>Psychometrika</em>, <b>88</b>(2), 456&ndash;486.
ISSN 1860-0980, <a href="https://doi.org/10.1007/s11336-023-09910-z">doi:10.1007/s11336-023-09910-z</a>.
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/LCBC-UiO/galamm">https://github.com/LCBC-UiO/galamm</a>
</p>
</li>
<li> <p><a href="https://lcbc-uio.github.io/galamm/">https://lcbc-uio.github.io/galamm/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/LCBC-UiO/galamm/issues">https://github.com/LCBC-UiO/galamm/issues</a>
</p>
</li></ul>


<hr>
<h2 id='hsced'>Example Data with Heteroscedastic Residuals</h2><span id='topic+hsced'></span>

<h3>Description</h3>

<p>Simulated dataset with residual standard deviation that varies between
items.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hsced
</code></pre>


<h3>Format</h3>



<h4><code>hsced</code> A data frame with 1200 rows and 5 columns:</h4>


<dl>
<dt>id</dt><dd><p>Subject ID.</p>
</dd>
<dt>age</dt><dd><p>Timepoint.</p>
</dd>
<dt>item</dt><dd><p>Item indicator.</p>
</dd>
<dt>x</dt><dd><p>Explanatory variable</p>
</dd>
<dt>y</dt><dd><p>Outcome.</p>
</dd>
</dl>




<h3>References</h3>

<p>There are no references for Rd macro <code style="white-space: pre;">&#8288;\insertAllCites&#8288;</code> on this help page.
</p>


<h3>See Also</h3>

<p>Other datasets: 
<code><a href="#topic+cognition">cognition</a></code>,
<code><a href="#topic+diet">diet</a></code>,
<code><a href="#topic+epilep">epilep</a></code>,
<code><a href="#topic+latent_covariates_long">latent_covariates_long</a></code>,
<code><a href="#topic+latent_covariates">latent_covariates</a></code>,
<code><a href="#topic+mresp_hsced">mresp_hsced</a></code>,
<code><a href="#topic+mresp">mresp</a></code>
</p>

<hr>
<h2 id='latent_covariates'>Simulated Data with Latent and Observed Covariates Interaction</h2><span id='topic+latent_covariates'></span>

<h3>Description</h3>

<p>Simulated dataset for use in examples and testing with a latent covariate
interacting with an observed covariate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>latent_covariates
</code></pre>


<h3>Format</h3>



<h4><code>latent_covariates</code> A data frame with 600 rows and 5 columns:</h4>


<dl>
<dt>id</dt><dd><p>Subject ID.</p>
</dd>
<dt>type</dt><dd><p>Type of observation in the <code>y</code> variable.
If it equals <code>"measurement1"</code> or <code>"measurement2"</code> then the
observation is a measurement of the latent variable. If it equals
<code>"response"</code>, then the observation is the actual response.</p>
</dd>
<dt>x</dt><dd><p>Explanatory variable.</p>
</dd>
<dt>y</dt><dd><p>Observed response. Note, this includes both the actual response,
and the measurements of the latent variable, since mathematically they
are all treated as responses.</p>
</dd>
<dt>response</dt><dd><p>Dummy variable indicating whether the given row is a
response or not.</p>
</dd>
</dl>




<h3>See Also</h3>

<p>Other datasets: 
<code><a href="#topic+cognition">cognition</a></code>,
<code><a href="#topic+diet">diet</a></code>,
<code><a href="#topic+epilep">epilep</a></code>,
<code><a href="#topic+hsced">hsced</a></code>,
<code><a href="#topic+latent_covariates_long">latent_covariates_long</a></code>,
<code><a href="#topic+mresp_hsced">mresp_hsced</a></code>,
<code><a href="#topic+mresp">mresp</a></code>
</p>

<hr>
<h2 id='latent_covariates_long'>Simulated Longitudinal Data with Latent and Observed Covariates Interaction</h2><span id='topic+latent_covariates_long'></span>

<h3>Description</h3>

<p>Simulated dataset for use in examples and testing with a latent covariate
interacting with an observed covariate. In this data, each response has been
measured six times for each subject.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>latent_covariates_long
</code></pre>


<h3>Format</h3>



<h4><code>latent_covariates_long</code> A data frame with 800 rows and 5</h4>

<p>columns:
</p>

<dl>
<dt>id</dt><dd><p>Subject ID.</p>
</dd>
<dt>type</dt><dd><p>Type of observation in the <code>y</code> variable.
If it equals <code>"measurement1"</code> or <code>"measurement2"</code> then the
observation is a measurement of the latent variable. If it equals
<code>"response"</code>, then the observation is the actual response.</p>
</dd>
<dt>x</dt><dd><p>Explanatory variable.</p>
</dd>
<dt>y</dt><dd><p>Observed response. Note, this includes both the actual response,
and the measurements of the latent variable, since mathematically they
are all treated as responses.</p>
</dd>
<dt>response</dt><dd><p>Dummy variable indicating whether the given row is a
response or not.</p>
</dd>
</dl>




<h3>See Also</h3>

<p>Other datasets: 
<code><a href="#topic+cognition">cognition</a></code>,
<code><a href="#topic+diet">diet</a></code>,
<code><a href="#topic+epilep">epilep</a></code>,
<code><a href="#topic+hsced">hsced</a></code>,
<code><a href="#topic+latent_covariates">latent_covariates</a></code>,
<code><a href="#topic+mresp_hsced">mresp_hsced</a></code>,
<code><a href="#topic+mresp">mresp</a></code>
</p>

<hr>
<h2 id='llikAIC'>Extract log likelihood, AIC, and related statistics from a GALAMM</h2><span id='topic+llikAIC'></span>

<h3>Description</h3>

<p>This function is assembles the values used by <code><a href="#topic+summary.galamm">summary.galamm</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>llikAIC(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="llikAIC_+3A_object">object</code></td>
<td>
<p>Object of class <code>galamm</code> returned from
<code><a href="#topic+galamm">galamm</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing AIC, BIC, log likelihood, deviance and residual
degrees of freedom.
</p>


<h3>See Also</h3>

<p>Other details of model fit: 
<code><a href="#topic+VarCorr">VarCorr</a>()</code>,
<code><a href="#topic+coef.galamm">coef.galamm</a>()</code>,
<code><a href="#topic+confint.galamm">confint.galamm</a>()</code>,
<code><a href="#topic+deviance.galamm">deviance.galamm</a>()</code>,
<code><a href="#topic+factor_loadings.galamm">factor_loadings.galamm</a>()</code>,
<code><a href="#topic+family.galamm">family.galamm</a>()</code>,
<code><a href="#topic+fitted.galamm">fitted.galamm</a>()</code>,
<code><a href="#topic+fixef">fixef</a>()</code>,
<code><a href="#topic+logLik.galamm">logLik.galamm</a>()</code>,
<code><a href="#topic+predict.galamm">predict.galamm</a>()</code>,
<code><a href="#topic+print.VarCorr.galamm">print.VarCorr.galamm</a>()</code>,
<code><a href="#topic+ranef.galamm">ranef.galamm</a>()</code>,
<code><a href="#topic+residuals.galamm">residuals.galamm</a>()</code>,
<code><a href="#topic+sigma.galamm">sigma.galamm</a>()</code>,
<code><a href="#topic+vcov.galamm">vcov.galamm</a>()</code>
</p>

<hr>
<h2 id='logLik.galamm'>Extract Log-Likelihood of galamm Object</h2><span id='topic+logLik.galamm'></span>

<h3>Description</h3>

<p>Extract Log-Likelihood of galamm Object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'galamm'
logLik(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logLik.galamm_+3A_object">object</code></td>
<td>
<p>Object</p>
</td></tr>
<tr><td><code id="logLik.galamm_+3A_...">...</code></td>
<td>
<p>Other arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Object of class <code>logLik</code>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+deviance.galamm">deviance.galamm()</a></code> for a function returning deviance and
<code><a href="stats.html#topic+logLik">logLik()</a></code> for the generic function.
</p>
<p>Other details of model fit: 
<code><a href="#topic+VarCorr">VarCorr</a>()</code>,
<code><a href="#topic+coef.galamm">coef.galamm</a>()</code>,
<code><a href="#topic+confint.galamm">confint.galamm</a>()</code>,
<code><a href="#topic+deviance.galamm">deviance.galamm</a>()</code>,
<code><a href="#topic+factor_loadings.galamm">factor_loadings.galamm</a>()</code>,
<code><a href="#topic+family.galamm">family.galamm</a>()</code>,
<code><a href="#topic+fitted.galamm">fitted.galamm</a>()</code>,
<code><a href="#topic+fixef">fixef</a>()</code>,
<code><a href="#topic+llikAIC">llikAIC</a>()</code>,
<code><a href="#topic+predict.galamm">predict.galamm</a>()</code>,
<code><a href="#topic+print.VarCorr.galamm">print.VarCorr.galamm</a>()</code>,
<code><a href="#topic+ranef.galamm">ranef.galamm</a>()</code>,
<code><a href="#topic+residuals.galamm">residuals.galamm</a>()</code>,
<code><a href="#topic+sigma.galamm">sigma.galamm</a>()</code>,
<code><a href="#topic+vcov.galamm">vcov.galamm</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Linear mixed model with heteroscedastic residuals
mod &lt;- galamm(
  formula = y ~ x + (1 | id),
  weights = ~ (1 | item),
  data = hsced
)

# Extract log likelihood
logLik(mod)

</code></pre>

<hr>
<h2 id='mresp'>Simulated Mixed Response Data</h2><span id='topic+mresp'></span>

<h3>Description</h3>

<p>Very basic mixed response dataset with one set of normally distributed
responses and one set of binomially distributed responses.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mresp
</code></pre>


<h3>Format</h3>



<h4><code>mresp</code> A data frame with 4000 rows and 5 columns:</h4>


<dl>
<dt>id</dt><dd><p>Subject ID.</p>
</dd>
<dt>x</dt><dd><p>Predictor variable.</p>
</dd>
<dt>y</dt><dd><p>Response.</p>
</dd>
<dt>itemgroup</dt><dd><p>Factor variable which equals &quot;a&quot; for the normally
distributed responses and &quot;b&quot; for the binomially distributed response
(with 1 trial).</p>
</dd>
</dl>




<h3>See Also</h3>

<p>Other datasets: 
<code><a href="#topic+cognition">cognition</a></code>,
<code><a href="#topic+diet">diet</a></code>,
<code><a href="#topic+epilep">epilep</a></code>,
<code><a href="#topic+hsced">hsced</a></code>,
<code><a href="#topic+latent_covariates_long">latent_covariates_long</a></code>,
<code><a href="#topic+latent_covariates">latent_covariates</a></code>,
<code><a href="#topic+mresp_hsced">mresp_hsced</a></code>
</p>

<hr>
<h2 id='mresp_hsced'>Simulated Mixed Response Data with Heteroscedastic Residuals</h2><span id='topic+mresp_hsced'></span>

<h3>Description</h3>

<p>Mixed response dataset with one set of normally distributed
responses and one set of binomially distributed responses. The normally
distributed response follow two different residual standard deviations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mresp_hsced
</code></pre>


<h3>Format</h3>



<h4><code>mresp</code> A data frame with 4000 rows and 5 columns:</h4>


<dl>
<dt>id</dt><dd><p>Subject ID.</p>
</dd>
<dt>x</dt><dd><p>Predictor variable.</p>
</dd>
<dt>y</dt><dd><p>Response.</p>
</dd>
<dt>itemgroup</dt><dd><p>Factor variable which equals &quot;a&quot; for the normally
distributed responses and &quot;b&quot; for the binomially distributed response
(with 1 trial).</p>
</dd>
<dt>grp</dt><dd><p>Grouping variable denoting which of the two residual standard
deviations apply. Only relevant for the normally distributed responses.</p>
</dd>
<dt>isgauss</dt><dd><p>Dummy variable indicating whether the observation on the
given line is normally (Gaussian) distributed or not.</p>
</dd>
</dl>




<h3>See Also</h3>

<p>Other datasets: 
<code><a href="#topic+cognition">cognition</a></code>,
<code><a href="#topic+diet">diet</a></code>,
<code><a href="#topic+epilep">epilep</a></code>,
<code><a href="#topic+hsced">hsced</a></code>,
<code><a href="#topic+latent_covariates_long">latent_covariates_long</a></code>,
<code><a href="#topic+latent_covariates">latent_covariates</a></code>,
<code><a href="#topic+mresp">mresp</a></code>
</p>

<hr>
<h2 id='nobs.galamm'>Extract the Number of Observations from a galamm Fit</h2><span id='topic+nobs.galamm'></span>

<h3>Description</h3>

<p>Extract the Number of Observations from a galamm Fit
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'galamm'
nobs(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nobs.galamm_+3A_object">object</code></td>
<td>
<p>galamm object</p>
</td></tr>
<tr><td><code id="nobs.galamm_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A number
</p>

<hr>
<h2 id='plot_smooth.galamm'>Plot smooth terms for galamm fits</h2><span id='topic+plot_smooth.galamm'></span><span id='topic+plot_smooth'></span>

<h3>Description</h3>

<p>Plots smooth terms of a fitted <code>galamm</code> object. This function is a thin
wrapper around <code>mgcv::plot.gam</code>
(Wood 2017).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'galamm'
plot_smooth(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_smooth.galamm_+3A_object">object</code></td>
<td>
<p>Object of class <code>galamm</code> returned from
<code><a href="#topic+galamm">galamm</a></code>.</p>
</td></tr>
<tr><td><code id="plot_smooth.galamm_+3A_...">...</code></td>
<td>
<p>Other optional arguments, passed on to <code>mgcv::plot.gam</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot is displayed on the screen.
</p>


<h3>References</h3>

<p>Wood SN (2017).
<em>Generalized Additive Models: An Introduction with R</em>, 2 edition.
Chapman and Hall/CRC.
</p>


<h3>See Also</h3>

<p>Other summary functions: 
<code><a href="#topic+anova.galamm">anova.galamm</a>()</code>,
<code><a href="#topic+plot.galamm">plot.galamm</a>()</code>,
<code><a href="#topic+print.summary.galamm">print.summary.galamm</a>()</code>,
<code><a href="#topic+summary.galamm">summary.galamm</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generalized additive mixed model with factor structures -------------------

# The cognition dataset contains simulated measurements of three latent
# time-dependent processes, corresponding to individuals' abilities in
# cognitive domains. We focus here on the first domain, and take a single
# random timepoint per person:
dat &lt;- subset(cognition, domain == 1)
dat &lt;- split(dat, f = dat$id)
dat &lt;- lapply(dat, function(x) x[x$timepoint %in% sample(x$timepoint, 1), ])
dat &lt;- do.call(rbind, dat)
dat$item &lt;- factor(dat$item)

# At each timepoint there are three items measuring ability in the cognitive
# domain. We fix the factor loading for the first measurement to one, and
# estimate the remaining two. This is specified in the loading matrix.
loading_matrix &lt;- matrix(c(1, NA, NA), ncol = 1)

# We can now estimate the model.
mod &lt;- galamm(
  formula = y ~ 0 + item + sl(x, factor = "loading") +
    (0 + loading | id),
  data = dat,
  load.var = "item",
  lambda = list(loading_matrix),
  factor = list("loading")
)

# We can plot the estimated smooth term
plot_smooth(mod, shade = TRUE)

# We can turn off the rug at the bottom
plot_smooth(mod, shade = TRUE, rug = FALSE)

</code></pre>

<hr>
<h2 id='plot.galamm'>Diagnostic plots for galamm objects</h2><span id='topic+plot.galamm'></span>

<h3>Description</h3>

<p>Diagnostic plots for galamm objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'galamm'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.galamm_+3A_x">x</code></td>
<td>
<p>An object of class <code>galamm</code> returned from <code><a href="#topic+galamm">galamm</a></code>.</p>
</td></tr>
<tr><td><code id="plot.galamm_+3A_...">...</code></td>
<td>
<p>Optional arguments passed on to the <code>plot</code> function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot is displayed.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+residuals.galamm">residuals.galamm()</a></code> for extracting residuals and <code><a href="graphics.html#topic+plot">plot()</a></code> for the
generic function.
</p>
<p>Other summary functions: 
<code><a href="#topic+anova.galamm">anova.galamm</a>()</code>,
<code><a href="#topic+plot_smooth.galamm">plot_smooth.galamm</a>()</code>,
<code><a href="#topic+print.summary.galamm">print.summary.galamm</a>()</code>,
<code><a href="#topic+summary.galamm">summary.galamm</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Linear mixed model example from lme4
data("sleepstudy", package = "lme4")
mod &lt;- galamm(Reaction ~ Days + (Days | Subject), data = sleepstudy)

# Diagnostic plot
plot(mod)

</code></pre>

<hr>
<h2 id='predict.galamm'>Predictions from a model at new data values</h2><span id='topic+predict.galamm'></span>

<h3>Description</h3>

<p>Predictions are given at the population level, i.e., with random effects set
to zero. For fitted models including random effects, see
<code><a href="#topic+fitted.galamm">fitted.galamm</a></code>. For mixed response models, only predictions on
the scale of the linear predictors is supported.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'galamm'
predict(object, newdata = NULL, type = c("link", "response"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.galamm_+3A_object">object</code></td>
<td>
<p>An object of class <code>galamm</code> returned from
<code><a href="#topic+galamm">galamm</a></code>.</p>
</td></tr>
<tr><td><code id="predict.galamm_+3A_newdata">newdata</code></td>
<td>
<p>Data from for which to evaluate predictions. Defaults to
&quot;NULL&quot;, which means that the predictions are evaluate at the data used to
fit the model.</p>
</td></tr>
<tr><td><code id="predict.galamm_+3A_type">type</code></td>
<td>
<p>Type of prediction object to be returned.</p>
</td></tr>
<tr><td><code id="predict.galamm_+3A_...">...</code></td>
<td>
<p>Optional arguments passed on to other methods. Currently used
for models with smooth terms, for which these arguments are forwarded to
<code>mgcv::predict.gam</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector of predicted values.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fitted.galamm">fitted.galamm()</a></code> for model fits, <code><a href="#topic+residuals.galamm">residuals.galamm()</a></code> for
residuals, and <code><a href="stats.html#topic+predict">predict()</a></code> for the generic function.
</p>
<p>Other details of model fit: 
<code><a href="#topic+VarCorr">VarCorr</a>()</code>,
<code><a href="#topic+coef.galamm">coef.galamm</a>()</code>,
<code><a href="#topic+confint.galamm">confint.galamm</a>()</code>,
<code><a href="#topic+deviance.galamm">deviance.galamm</a>()</code>,
<code><a href="#topic+factor_loadings.galamm">factor_loadings.galamm</a>()</code>,
<code><a href="#topic+family.galamm">family.galamm</a>()</code>,
<code><a href="#topic+fitted.galamm">fitted.galamm</a>()</code>,
<code><a href="#topic+fixef">fixef</a>()</code>,
<code><a href="#topic+llikAIC">llikAIC</a>()</code>,
<code><a href="#topic+logLik.galamm">logLik.galamm</a>()</code>,
<code><a href="#topic+print.VarCorr.galamm">print.VarCorr.galamm</a>()</code>,
<code><a href="#topic+ranef.galamm">ranef.galamm</a>()</code>,
<code><a href="#topic+residuals.galamm">residuals.galamm</a>()</code>,
<code><a href="#topic+sigma.galamm">sigma.galamm</a>()</code>,
<code><a href="#topic+vcov.galamm">vcov.galamm</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Poisson GLMM
count_mod &lt;- galamm(
  formula = y ~ lbas * treat + lage + v4 + (1 | subj),
  data = epilep, family = poisson
)

# Plot response versus link:
plot(
  predict(count_mod, type = "link"),
  predict(count_mod, type = "response")
)

# Predict on a new dataset
nd &lt;- data.frame(lbas = c(.3, .2), treat = c(0, 1), lage = 0.2, v4 = -.2)
predict(count_mod, newdata = nd)
predict(count_mod, newdata = nd, type = "response")

</code></pre>

<hr>
<h2 id='print.summary.galamm'>Print method for summary GALAMM fits</h2><span id='topic+print.summary.galamm'></span>

<h3>Description</h3>

<p>Print method for summary GALAMM fits
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.galamm'
print(x, digits = max(3, getOption("digits") - 3), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.summary.galamm_+3A_x">x</code></td>
<td>
<p>An object of class <code>summary.galamm</code> returned from
<code><a href="#topic+summary.galamm">summary.galamm</a></code>.</p>
</td></tr>
<tr><td><code id="print.summary.galamm_+3A_digits">digits</code></td>
<td>
<p>Number of digits to present in outputs.</p>
</td></tr>
<tr><td><code id="print.summary.galamm_+3A_...">...</code></td>
<td>
<p>Further arguments passed on to other methods. Currently used by
<code>stats::printCoefmat</code> for printing approximate significance of smooth
terms.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Summary printed to screen. Invisibly returns the argument <code>x</code>.
</p>


<h3>Author(s)</h3>

<p>Some of the code for producing summary information has been derived
from the summary methods of <code>mgcv</code> (author: Simon Wood) and
<code>lme4</code> (Bates et al. 2015)
(authors: Douglas M. Bates, Martin Maechler, Ben Bolker, and Steve Walker).
</p>


<h3>References</h3>

<p>There are no references for Rd macro <code style="white-space: pre;">&#8288;\insertAllCites&#8288;</code> on this help page.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+summary.galamm">summary.galamm()</a></code> for the summary function and <code><a href="base.html#topic+print">print()</a></code> for the
generic function.
</p>
<p>Other summary functions: 
<code><a href="#topic+anova.galamm">anova.galamm</a>()</code>,
<code><a href="#topic+plot.galamm">plot.galamm</a>()</code>,
<code><a href="#topic+plot_smooth.galamm">plot_smooth.galamm</a>()</code>,
<code><a href="#topic+summary.galamm">summary.galamm</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Linear mixed model with heteroscedastic residuals
mod &lt;- galamm(
  formula = y ~ x + (1 | id),
  weights = ~ (1 | item),
  data = hsced
)

summary(mod)

</code></pre>

<hr>
<h2 id='print.VarCorr.galamm'>Print method for variance-covariance objects</h2><span id='topic+print.VarCorr.galamm'></span>

<h3>Description</h3>

<p>Print method for variance-covariance objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'VarCorr.galamm'
print(
  x,
  digits = max(3, getOption("digits") - 2),
  comp = c("Std.Dev.", "Variance"),
  corr = any(comp == "Std.Dev."),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.VarCorr.galamm_+3A_x">x</code></td>
<td>
<p>An object of class <code>VarCorr.galamm</code>, returned from
<code><a href="#topic+VarCorr.galamm">VarCorr.galamm</a></code>.</p>
</td></tr>
<tr><td><code id="print.VarCorr.galamm_+3A_digits">digits</code></td>
<td>
<p>Optional arguments specifying number of digits to use when
printing.</p>
</td></tr>
<tr><td><code id="print.VarCorr.galamm_+3A_comp">comp</code></td>
<td>
<p>Character vector of length 1 or 2 specifying which variance
components to print.</p>
</td></tr>
<tr><td><code id="print.VarCorr.galamm_+3A_corr">corr</code></td>
<td>
<p>Boolean indicating whether covariances or correlations should be
printed.</p>
</td></tr>
<tr><td><code id="print.VarCorr.galamm_+3A_...">...</code></td>
<td>
<p>Optional arguments passed on to other methods. Currently not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The variance-covariance information is printed to the console and the
argument <code>x</code> is silently returned.
</p>


<h3>Author(s)</h3>

<p>This function is derived from <code>lme4:::print.VarCorr.merMod</code>
written by Douglas M. Bates, Martin Maechler, Ben Bolker, and Steve Walker.
</p>


<h3>References</h3>

<p>Bates DM, Mächler M, Bolker B, Walker S (2015).
&ldquo;Fitting Linear Mixed-Effects Models Using Lme4.&rdquo;
<em>Journal of Statistical Software</em>, <b>67</b>(1), 1&ndash;48.
ISSN 1548-7660, <a href="https://doi.org/10.18637/jss.v067.i01">doi:10.18637/jss.v067.i01</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+VarCorr.galamm">VarCorr.galamm()</a></code> for the function creating the variance-covariance
objects.
</p>
<p>Other details of model fit: 
<code><a href="#topic+VarCorr">VarCorr</a>()</code>,
<code><a href="#topic+coef.galamm">coef.galamm</a>()</code>,
<code><a href="#topic+confint.galamm">confint.galamm</a>()</code>,
<code><a href="#topic+deviance.galamm">deviance.galamm</a>()</code>,
<code><a href="#topic+factor_loadings.galamm">factor_loadings.galamm</a>()</code>,
<code><a href="#topic+family.galamm">family.galamm</a>()</code>,
<code><a href="#topic+fitted.galamm">fitted.galamm</a>()</code>,
<code><a href="#topic+fixef">fixef</a>()</code>,
<code><a href="#topic+llikAIC">llikAIC</a>()</code>,
<code><a href="#topic+logLik.galamm">logLik.galamm</a>()</code>,
<code><a href="#topic+predict.galamm">predict.galamm</a>()</code>,
<code><a href="#topic+ranef.galamm">ranef.galamm</a>()</code>,
<code><a href="#topic+residuals.galamm">residuals.galamm</a>()</code>,
<code><a href="#topic+sigma.galamm">sigma.galamm</a>()</code>,
<code><a href="#topic+vcov.galamm">vcov.galamm</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Linear mixed model with heteroscedastic residuals
mod &lt;- galamm(
  formula = y ~ x + (1 | id),
  weights = ~ (1 | item),
  data = hsced
)

# Extract information on variance and covariance
VarCorr(mod)

</code></pre>

<hr>
<h2 id='ranef.galamm'>Extract random effects from galamm object.</h2><span id='topic+ranef.galamm'></span><span id='topic+ranef'></span>

<h3>Description</h3>

<p>Extract random effects from galamm object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'galamm'
ranef(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ranef.galamm_+3A_object">object</code></td>
<td>
<p>An object of class <code>galamm</code>, returned from
<code><a href="#topic+galamm">galamm</a></code>.</p>
</td></tr>
<tr><td><code id="ranef.galamm_+3A_...">...</code></td>
<td>
<p>Optional parameters passed on to other methods. Currently not
used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>ranef.galamm</code>, containing the requested
random effects.
</p>


<h3>Author(s)</h3>

<p>This function is derived from <code>lme4::ranef.merMod</code>, written by
Douglas Bates, Martin Maechler, Ben Bolker, Steve Walker.
</p>


<h3>References</h3>

<p>Bates DM, Mächler M, Bolker B, Walker S (2015).
&ldquo;Fitting Linear Mixed-Effects Models Using Lme4.&rdquo;
<em>Journal of Statistical Software</em>, <b>67</b>(1), 1&ndash;48.
ISSN 1548-7660, <a href="https://doi.org/10.18637/jss.v067.i01">doi:10.18637/jss.v067.i01</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fixef.galamm">fixef.galamm()</a></code> for fixed effects and <code><a href="#topic+coef.galamm">coef.galamm()</a></code> for
coefficients more generally.
</p>
<p>Other details of model fit: 
<code><a href="#topic+VarCorr">VarCorr</a>()</code>,
<code><a href="#topic+coef.galamm">coef.galamm</a>()</code>,
<code><a href="#topic+confint.galamm">confint.galamm</a>()</code>,
<code><a href="#topic+deviance.galamm">deviance.galamm</a>()</code>,
<code><a href="#topic+factor_loadings.galamm">factor_loadings.galamm</a>()</code>,
<code><a href="#topic+family.galamm">family.galamm</a>()</code>,
<code><a href="#topic+fitted.galamm">fitted.galamm</a>()</code>,
<code><a href="#topic+fixef">fixef</a>()</code>,
<code><a href="#topic+llikAIC">llikAIC</a>()</code>,
<code><a href="#topic+logLik.galamm">logLik.galamm</a>()</code>,
<code><a href="#topic+predict.galamm">predict.galamm</a>()</code>,
<code><a href="#topic+print.VarCorr.galamm">print.VarCorr.galamm</a>()</code>,
<code><a href="#topic+residuals.galamm">residuals.galamm</a>()</code>,
<code><a href="#topic+sigma.galamm">sigma.galamm</a>()</code>,
<code><a href="#topic+vcov.galamm">vcov.galamm</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Poisson GLMM
count_mod &lt;- galamm(
  formula = y ~ lbas * treat + lage + v4 + (1 | subj),
  data = epilep, family = poisson
)

# Extract random effects
ranef(count_mod)

</code></pre>

<hr>
<h2 id='residuals.galamm'>Residuals of galamm objects</h2><span id='topic+residuals.galamm'></span>

<h3>Description</h3>

<p>Residuals of galamm objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'galamm'
residuals(object, type = c("pearson", "deviance"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="residuals.galamm_+3A_object">object</code></td>
<td>
<p>An object of class <code>galamm</code> returned from
<code><a href="#topic+galamm">galamm</a></code>.</p>
</td></tr>
<tr><td><code id="residuals.galamm_+3A_type">type</code></td>
<td>
<p>Type of residuals to be returned. One of <code>"pearson"</code> and
<code>"deviance"</code>.</p>
</td></tr>
<tr><td><code id="residuals.galamm_+3A_...">...</code></td>
<td>
<p>Optional arguments passed on to other methods. Currently not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric vector of residual values.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fitted.galamm">fitted.galamm()</a></code> for model fitted values, <code><a href="#topic+predict.galamm">predict.galamm()</a></code> for
model predictions, and <code><a href="#topic+plot.galamm">plot.galamm()</a></code> for diagnostic plots. The generic
function is <code><a href="stats.html#topic+residuals">residuals()</a></code>.
</p>
<p>Other details of model fit: 
<code><a href="#topic+VarCorr">VarCorr</a>()</code>,
<code><a href="#topic+coef.galamm">coef.galamm</a>()</code>,
<code><a href="#topic+confint.galamm">confint.galamm</a>()</code>,
<code><a href="#topic+deviance.galamm">deviance.galamm</a>()</code>,
<code><a href="#topic+factor_loadings.galamm">factor_loadings.galamm</a>()</code>,
<code><a href="#topic+family.galamm">family.galamm</a>()</code>,
<code><a href="#topic+fitted.galamm">fitted.galamm</a>()</code>,
<code><a href="#topic+fixef">fixef</a>()</code>,
<code><a href="#topic+llikAIC">llikAIC</a>()</code>,
<code><a href="#topic+logLik.galamm">logLik.galamm</a>()</code>,
<code><a href="#topic+predict.galamm">predict.galamm</a>()</code>,
<code><a href="#topic+print.VarCorr.galamm">print.VarCorr.galamm</a>()</code>,
<code><a href="#topic+ranef.galamm">ranef.galamm</a>()</code>,
<code><a href="#topic+sigma.galamm">sigma.galamm</a>()</code>,
<code><a href="#topic+vcov.galamm">vcov.galamm</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Poisson GLMM
count_mod &lt;- galamm(
  formula = y ~ lbas * treat + lage + v4 + (1 | subj),
  data = epilep, family = poisson
)

# Extract residuals
residuals(count_mod)

</code></pre>

<hr>
<h2 id='s'>Set up smooth term with factor loading</h2><span id='topic+s'></span><span id='topic+sl'></span>

<h3>Description</h3>

<p>This is a very thin wrapper around <code>mgcv::s</code>. It enables the
specification of loading variables for smooth terms. The last letter &quot;l&quot;,
which stands for &quot;loading&quot;, has been added to avoid namespace conflicts with
<code>mgcv</code> and <code>gamm4</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sl(..., factor = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="s_+3A_...">...</code></td>
<td>
<p>Arguments passed on to <code>mgcv::s</code>.</p>
</td></tr>
<tr><td><code id="s_+3A_factor">factor</code></td>
<td>
<p>Optional character argument specifying the loading variable.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>xx.smooth.spec</code>, where <code>xx</code> is a basis
identifying code given by the <code>bs</code> argument of <code>s</code>. It differs
from the smooth returned by <code>mgcv::s</code> in that it has an additional
attribute named <code>"factor"</code> which specifies any factor loading which
this smooth term should be multiplied with in order to produce the observed
outcome.
</p>


<h3>References</h3>

<p>Wood SN (2003).
&ldquo;Thin Plate Regression Splines.&rdquo;
<em>Journal of the Royal Statistical Society. Series B (Statistical Methodology)</em>, <b>65</b>(1), 95&ndash;114.
ISSN 1369-7412.
</p>
<p>Wood SN (2017).
<em>Generalized Additive Models: An Introduction with R</em>, 2 edition.
Chapman and Hall/CRC.
</p>


<h3>See Also</h3>

<p>Other modeling functions: 
<code><a href="#topic+galamm">galamm</a>()</code>,
<code><a href="#topic+t2">t2</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Linear mixed model with factor structures
dat &lt;- subset(cognition, domain == 1 &amp; timepoint == 1)
loading_matrix &lt;- matrix(c(1, NA, NA), ncol = 1)


# Model with four thin-plate regression splines as basis functions
mod &lt;- galamm(
  formula = y ~ 0 + item + sl(x, k = 4, factor = "loading"),
  data = dat,
  load.var = "item",
  lambda = list(loading_matrix),
  factor = list("loading")
)

# Model with four cubic regression splines as basis functions
mod &lt;- galamm(
  formula = y ~ 0 + item +
    sl(x, bs = "cr", k = 4, factor = "loading"),
  data = dat,
  load.var = "item",
  lambda = list(loading_matrix),
  factor = list("loading")
)

</code></pre>

<hr>
<h2 id='sigma.galamm'>Extract square root of dispersion parameter from galamm object</h2><span id='topic+sigma.galamm'></span>

<h3>Description</h3>

<p>Extracts the square root of the dispersion parameter(s) from an object of
class <code>galamm</code>, returned from <code><a href="#topic+galamm">galamm</a></code>. In the case of
conditionally Gaussian responses, this is the residual standard deviation.
When there are multiple dispersion parameters, e.g., with mixed response
type models, the square root of all of them are returned in a numeric vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'galamm'
sigma(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sigma.galamm_+3A_object">object</code></td>
<td>
<p>An object of class <code>galamm</code>.</p>
</td></tr>
<tr><td><code id="sigma.galamm_+3A_...">...</code></td>
<td>
<p>Other optional arguments. Currently not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The square root of one or more dispersion parameters.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+galamm">galamm()</a></code>
</p>
<p>Other details of model fit: 
<code><a href="#topic+VarCorr">VarCorr</a>()</code>,
<code><a href="#topic+coef.galamm">coef.galamm</a>()</code>,
<code><a href="#topic+confint.galamm">confint.galamm</a>()</code>,
<code><a href="#topic+deviance.galamm">deviance.galamm</a>()</code>,
<code><a href="#topic+factor_loadings.galamm">factor_loadings.galamm</a>()</code>,
<code><a href="#topic+family.galamm">family.galamm</a>()</code>,
<code><a href="#topic+fitted.galamm">fitted.galamm</a>()</code>,
<code><a href="#topic+fixef">fixef</a>()</code>,
<code><a href="#topic+llikAIC">llikAIC</a>()</code>,
<code><a href="#topic+logLik.galamm">logLik.galamm</a>()</code>,
<code><a href="#topic+predict.galamm">predict.galamm</a>()</code>,
<code><a href="#topic+print.VarCorr.galamm">print.VarCorr.galamm</a>()</code>,
<code><a href="#topic+ranef.galamm">ranef.galamm</a>()</code>,
<code><a href="#topic+residuals.galamm">residuals.galamm</a>()</code>,
<code><a href="#topic+vcov.galamm">vcov.galamm</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Linear mixed model with heteroscedastic residuals
mod &lt;- galamm(
  formula = y ~ x + (1 | id),
  weights = ~ (1 | item),
  data = hsced
)

# Extract residual standard deviation.
sigma(mod)

# The residual standard deviation applies to the base case. The variance
# function shown in the model output shows the estimated multiplier for
# various grouping levels:
summary(mod)

</code></pre>

<hr>
<h2 id='summary.galamm'>Summarizing GALAMM fits</h2><span id='topic+summary.galamm'></span>

<h3>Description</h3>

<p>Summary method for class &quot;galamm&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'galamm'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.galamm_+3A_object">object</code></td>
<td>
<p>An object of class <code>galamm</code> returned from
<code><a href="#topic+galamm">galamm</a></code>.</p>
</td></tr>
<tr><td><code id="summary.galamm_+3A_...">...</code></td>
<td>
<p>Further arguments passed on to other methods. Currently not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of summary statistics of the fitted model of class
<code>summary.galamm</code>, containing the following elements:
</p>

<ul>
<li> <p><code>AICtab</code> a table of model fit measures, returned by
<code><a href="#topic+llikAIC">llikAIC</a></code>.
</p>
</li>
<li> <p><code>call</code> the matched call used when fitting the model.
</p>
</li>
<li> <p><code>fixef</code> a matrix with fixed effect estimated, returned by
<code><a href="#topic+fixef">fixef</a></code>.
</p>
</li>
<li> <p><code>gam</code> List containing information about smooth terms in the model. If
no smooth terms are contained in the model, then it is a list of length
zero.
</p>
</li>
<li> <p><code>model</code> a list with various elements related to the model setup and
fit. See <code>?galamm</code> for details.
</p>
</li>
<li> <p><code>parameters</code> A list object with model parameters and related
information. See <code>?galamm</code> for details.
</p>
</li>
<li> <p><code>Lambda</code> An object containing the estimated factor loadings. Returned
from <code><a href="#topic+factor_loadings.galamm">factor_loadings.galamm</a></code>. If there are no estimated factor
loadings, then this object is <code>NULL</code>.
</p>
</li>
<li> <p><code>random_effects</code> a list containing the random effects.
See <code>?galamm</code> for details.
</p>
</li>
<li> <p><code>VarCorr</code> An object of class <code>VarCorr.galamm</code>, returned from
<code><a href="#topic+VarCorr.galamm">VarCorr.galamm</a></code>.
</p>
</li>
<li> <p><code>weights</code> An object containing information about estimated variance
functions, when there are heteroscedastic residuals. Otherwise the object
is <code>NULL</code>.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Some of the code for producing summary information has been derived
from the summary methods of <code>mgcv</code> (author: Simon Wood) and
<code>lme4</code> (Bates et al. 2015)
(authors: Douglas M. Bates, Martin Maechler, Ben Bolker, and Steve Walker).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+print.summary.galamm">print.summary.galamm()</a></code> for the print method and <code><a href="base.html#topic+summary">summary()</a></code> for
the generic.
</p>
<p>Other summary functions: 
<code><a href="#topic+anova.galamm">anova.galamm</a>()</code>,
<code><a href="#topic+plot.galamm">plot.galamm</a>()</code>,
<code><a href="#topic+plot_smooth.galamm">plot_smooth.galamm</a>()</code>,
<code><a href="#topic+print.summary.galamm">print.summary.galamm</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Linear mixed model with heteroscedastic residuals
mod &lt;- galamm(
  formula = y ~ x + (1 | id),
  weights = ~ (1 | item),
  data = hsced
)

summary(mod)

</code></pre>

<hr>
<h2 id='t2'>Set up smooth term with factor loading</h2><span id='topic+t2'></span><span id='topic+t2l'></span>

<h3>Description</h3>

<p>This is a very thin wrapper around <code>mgcv::t2</code>. It enables the
specification of loading variables for smooth terms. The last letter &quot;l&quot;,
which stands for &quot;loading&quot;, has been added to avoid namespace conflicts
with <code>mgcv</code> and <code>gamm4</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>t2l(..., factor = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="t2_+3A_...">...</code></td>
<td>
<p>Arguments passed on to <code>mgcv::t2</code>.</p>
</td></tr>
<tr><td><code id="t2_+3A_factor">factor</code></td>
<td>
<p>Optional character argument specifying the loading variable.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>xx.smooth.spec</code>, where <code>xx</code> is a basis
identifying code given by the <code>bs</code> argument of <code>t2</code>.
It differs from the smooth returned by <code>mgcv::s</code> in
that it has an additional attribute named <code>"factor"</code> which specifies
any factor loading which this smooth term should be multiplied with in
order to produce the observed outcome.
</p>


<h3>References</h3>

<p>Wood SN (2003).
&ldquo;Thin Plate Regression Splines.&rdquo;
<em>Journal of the Royal Statistical Society. Series B (Statistical Methodology)</em>, <b>65</b>(1), 95&ndash;114.
ISSN 1369-7412.
</p>
<p>Wood SN (2017).
<em>Generalized Additive Models: An Introduction with R</em>, 2 edition.
Chapman and Hall/CRC.
</p>


<h3>See Also</h3>

<p>Other modeling functions: 
<code><a href="#topic+galamm">galamm</a>()</code>,
<code><a href="#topic+s">s</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Linear mixed model with factor structures
dat &lt;- subset(cognition, domain == 1 &amp; timepoint == 1)
loading_matrix &lt;- matrix(c(1, NA, NA), ncol = 1)

# Model with four cubic regression splines as basis functions
mod &lt;- galamm(
  formula = y ~ 0 + item + t2l(x, k = 4, factor = "loading"),
  data = dat,
  load.var = "item",
  lambda = list(loading_matrix),
  factor = list("loading")
)

# Model with four thin-plate regression splines as basis functions
mod &lt;- galamm(
  formula = y ~ 0 + item +
    t2l(x, bs = "tp", k = 4, factor = "loading"),
  data = dat,
  load.var = "item",
  lambda = list(loading_matrix),
  factor = list("loading")
)

</code></pre>

<hr>
<h2 id='VarCorr'>Extract variance and correlation components from model</h2><span id='topic+VarCorr'></span><span id='topic+VarCorr.galamm'></span>

<h3>Description</h3>

<p>Extract variance and correlation components from model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'galamm'
VarCorr(x, sigma = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="VarCorr_+3A_x">x</code></td>
<td>
<p>An object of class <code>galamm</code> returned from <code><a href="#topic+galamm">galamm</a></code>.</p>
</td></tr>
<tr><td><code id="VarCorr_+3A_sigma">sigma</code></td>
<td>
<p>Numeric value used to multiply the standard deviations. Defaults
to 1.</p>
</td></tr>
<tr><td><code id="VarCorr_+3A_...">...</code></td>
<td>
<p>Other arguments passed onto other methods. Currently not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>VarCorr.galamm</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+print.VarCorr.galamm">print.VarCorr.galamm()</a></code> for the print function.
</p>
<p>Other details of model fit: 
<code><a href="#topic+coef.galamm">coef.galamm</a>()</code>,
<code><a href="#topic+confint.galamm">confint.galamm</a>()</code>,
<code><a href="#topic+deviance.galamm">deviance.galamm</a>()</code>,
<code><a href="#topic+factor_loadings.galamm">factor_loadings.galamm</a>()</code>,
<code><a href="#topic+family.galamm">family.galamm</a>()</code>,
<code><a href="#topic+fitted.galamm">fitted.galamm</a>()</code>,
<code><a href="#topic+fixef">fixef</a>()</code>,
<code><a href="#topic+llikAIC">llikAIC</a>()</code>,
<code><a href="#topic+logLik.galamm">logLik.galamm</a>()</code>,
<code><a href="#topic+predict.galamm">predict.galamm</a>()</code>,
<code><a href="#topic+print.VarCorr.galamm">print.VarCorr.galamm</a>()</code>,
<code><a href="#topic+ranef.galamm">ranef.galamm</a>()</code>,
<code><a href="#topic+residuals.galamm">residuals.galamm</a>()</code>,
<code><a href="#topic+sigma.galamm">sigma.galamm</a>()</code>,
<code><a href="#topic+vcov.galamm">vcov.galamm</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Linear mixed model with heteroscedastic residuals
mod &lt;- galamm(
  formula = y ~ x + (1 | id),
  weights = ~ (1 | item),
  data = hsced
)

# Extract information on variance and covariance
VarCorr(mod)

</code></pre>

<hr>
<h2 id='vcov.galamm'>Calculate variance-covariance matrix for GALAMM fit</h2><span id='topic+vcov.galamm'></span>

<h3>Description</h3>

<p>Calculate variance-covariance matrix for GALAMM fit
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'galamm'
vcov(object, parm = "beta", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vcov.galamm_+3A_object">object</code></td>
<td>
<p>Object of class <code>galamm</code> returned from
<code><a href="#topic+galamm">galamm</a></code>.</p>
</td></tr>
<tr><td><code id="vcov.galamm_+3A_parm">parm</code></td>
<td>
<p>The parameters for which the variance-covariance matrix should be
calculated. Character vector with one or more of the elements &quot;theta&quot;,
&quot;beta&quot;, &quot;lambda&quot;, and &quot;weights&quot;. Can also be an integer vector.</p>
</td></tr>
<tr><td><code id="vcov.galamm_+3A_...">...</code></td>
<td>
<p>Further arguments passed on to other methods. Currently not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A variance-covariance matrix.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+confint.galamm">confint.galamm()</a></code> for the method computing confidence intervals.
See <code><a href="stats.html#topic+vcov">vcov()</a></code> for the generic function.
</p>
<p>Other details of model fit: 
<code><a href="#topic+VarCorr">VarCorr</a>()</code>,
<code><a href="#topic+coef.galamm">coef.galamm</a>()</code>,
<code><a href="#topic+confint.galamm">confint.galamm</a>()</code>,
<code><a href="#topic+deviance.galamm">deviance.galamm</a>()</code>,
<code><a href="#topic+factor_loadings.galamm">factor_loadings.galamm</a>()</code>,
<code><a href="#topic+family.galamm">family.galamm</a>()</code>,
<code><a href="#topic+fitted.galamm">fitted.galamm</a>()</code>,
<code><a href="#topic+fixef">fixef</a>()</code>,
<code><a href="#topic+llikAIC">llikAIC</a>()</code>,
<code><a href="#topic+logLik.galamm">logLik.galamm</a>()</code>,
<code><a href="#topic+predict.galamm">predict.galamm</a>()</code>,
<code><a href="#topic+print.VarCorr.galamm">print.VarCorr.galamm</a>()</code>,
<code><a href="#topic+ranef.galamm">ranef.galamm</a>()</code>,
<code><a href="#topic+residuals.galamm">residuals.galamm</a>()</code>,
<code><a href="#topic+sigma.galamm">sigma.galamm</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Linear mixed model with heteroscedastic residuals
mod &lt;- galamm(
  formula = y ~ x + (1 | id),
  weights = ~ (1 | item),
  data = hsced
)

# Extract covariance matrix for fixed regression coefficients
vcov(mod, parm = "beta")

# and then for weights, which gives us the variance.
vcov(mod, parm = "weights")

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
