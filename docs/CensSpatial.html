<!DOCTYPE html><html lang="en"><head><title>Help for package CensSpatial</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {CensSpatial}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#algnaive12'>
<p>Naive 1 and Naive 2 method for spatial prediction.</p></a></li>
<li><a href='#depth'>
<p>Depths of a geological horizon.</p></a></li>
<li><a href='#derivcormatrix'><p>First and second derivates of some correlation matrix</p></a></li>
<li><a href='#derivQfun'><p>Maximum Likelihood Expectation (<code class="reqn">logQ</code> function and its derivates)</p></a></li>
<li><a href='#distmatrix'><p>Distance matrix</p></a></li>
<li><a href='#localinfmeas'><p>Local influence measures.</p></a></li>
<li><a href='#Missouri'>
<p>TCDD concentrations in Missouri (1971).</p></a></li>
<li><a href='#predgraphics'><p>Prediction graphics for SAEM Algortihm for censored spatial data.</p></a></li>
<li><a href='#predSCL'>
<p>Prediction for the SAEM algorithm for censored spatial data.</p></a></li>
<li><a href='#rspacens'><p>Censored Spatial data simulation</p>
</p></a></li>
<li><a href='#SAEMSCL'><p>SAEM Algorithm estimation for censored spatial data.</p>
</p></a></li>
<li><a href='#Seminaive'><p>Seminaive algorithm for spatial censored prediction.</p>
</p></a></li>
<li><a href='#summary.naive'><p>Summary of a naive object</p></a></li>
<li><a href='#summary.SAEMSpatialCens'><p>Summary of a SAEMSpatialCens object.</p></a></li>
<li><a href='#summary.seminaive'><p>Summary of a seminaive object</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Censored Spatial Models</td>
</tr>
<tr>
<td>Version:</td>
<td>3.6</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.1.0)</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-01-18</td>
</tr>
<tr>
<td>Author:</td>
<td>Alejandro Ordonez, Christian E. Galarza, Victor H. Lachos</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Alejandro Ordonez &lt;ordonezjosealejandro@gmail.com&gt;</td>
</tr>
<tr>
<td>Imports:</td>
<td>geoR (&ge; 1.8-1), Rcpp, stats, graphics, mvtnorm, optimx (&ge;
2021.10-12), tmvtnorm (&ge; 1.4-10), msm, psych, numDeriv (&ge;
2.11.1),raster,moments (&ge; 0.14),lattice, tlrmvnmvt (&ge; 1.1.0)</td>
</tr>
<tr>
<td>Description:</td>
<td>It fits linear regression models for censored spatial data. It provides different estimation methods as the SAEM (Stochastic Approximation of Expectation Maximization) algorithm and seminaive that uses Kriging prediction to estimate the response at censored locations and predict new values at unknown locations. It also offers graphical tools for assessing the fitted model. More details can be found in Ordonez et al. (2018) &lt;<a href="https://doi.org/10.1016%2Fj.spasta.2017.12.001">doi:10.1016/j.spasta.2017.12.001</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-01-24 08:13:12 UTC; ALEJANDRO</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-01-24 08:30:16 UTC</td>
</tr>
</table>
<hr>
<h2 id='algnaive12'>
Naive 1 and Naive 2 method for spatial prediction.
</h2><span id='topic+algnaive12'></span>

<h3>Description</h3>

<p>This function performs spatial censored estimation and prediction for left and right censure through the Naive 1 and Naive 2 methods.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>algnaive12(data, cc, copred, thetaini, y.col = 3,coords.col = 1:2,covar=FALSE, covar.col,
fix.nugget = TRUE, nugget, kappa = 0, cutoff, cov.model = "exponential", trend)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="algnaive12_+3A_data">data</code></td>
<td>

<p>data.frame containing the coordinates, covariates and the response variable (in any order).
</p>
</td></tr>
<tr><td><code id="algnaive12_+3A_cc">cc</code></td>
<td>

<p>(binary vector) indicator of censure (1: censored observation 0: observed).
</p>
</td></tr>
<tr><td><code id="algnaive12_+3A_copred">copred</code></td>
<td>

<p>coordinates used in the prediction procedure.
</p>
</td></tr>
<tr><td><code id="algnaive12_+3A_thetaini">thetaini</code></td>
<td>

<p>initial values for the <code class="reqn">\sigma^2</code> and <code class="reqn">\phi</code> values in the covariance structure.
</p>
</td></tr>
<tr><td><code id="algnaive12_+3A_y.col">y.col</code></td>
<td>

<p>(numeric) column of data.frame that corresponds to the response variable.
</p>
</td></tr>
<tr><td><code id="algnaive12_+3A_coords.col">coords.col</code></td>
<td>

<p>(numeric) columns of data.frame that corresponds to the coordinates of the spatial data.
</p>
</td></tr>
<tr><td><code id="algnaive12_+3A_covar">covar</code></td>
<td>

<p>(logical) indicates the presence of covariates in the spatial censored estimation
(<code>FALSE</code> :without covariates, <code>TRUE</code> :with covariates).
</p>
</td></tr>
<tr><td><code id="algnaive12_+3A_covar.col">covar.col</code></td>
<td>

<p>(numeric) columns of data.frame that corresponds to the covariates in the spatial censored linear model estimation.
</p>
</td></tr>
<tr><td><code id="algnaive12_+3A_fix.nugget">fix.nugget</code></td>
<td>

<p>(logical) it indicates if the <code class="reqn">\tau^2</code> parameter must be fixed.
</p>
</td></tr>
<tr><td><code id="algnaive12_+3A_nugget">nugget</code></td>
<td>

<p>(numeric) values of the <code class="reqn">\tau^2</code> parameter, if <code>fix.nugget=F</code> this value corresponds to an initial value.
</p>
</td></tr>
<tr><td><code id="algnaive12_+3A_kappa">kappa</code></td>
<td>

<p>value of <code class="reqn">\kappa</code> used in some covariance functions.
</p>
</td></tr>
<tr><td><code id="algnaive12_+3A_cutoff">cutoff</code></td>
<td>

<p>(vector) Limit of censure detection ( rc:&gt;cutoff, lc:&lt;cutoff).
</p>
</td></tr>
<tr><td><code id="algnaive12_+3A_cov.model">cov.model</code></td>
<td>

<p>structure of covariance (see <code>cov.spatial</code> from <code>geoR</code>).
</p>
</td></tr>
<tr><td><code id="algnaive12_+3A_trend">trend</code></td>
<td>

<p>it specifies the mean part of the model. See documentation of trend.spatial from geoR for further details. By default it takes <code>"cte"</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Naive 1 and Naive 2 are computed as in Schelin (2014). The naive 1 replaces the censored observations by the limit of detection (LD) and it performs estimation and prediction with this data. Instead of 1, the naive 2 replaces the censored observations by LD/2.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>beta1</code></td>
<td>
<p>beta parameter for the mean structure in the Naive 1 method.</p>
</td></tr>
<tr><td><code>beta2</code></td>
<td>
<p>beta parameter for the mean structure in the Naive 2 method.</p>
</td></tr>
<tr><td><code>theta1</code></td>
<td>
<p>vector of estimate parameter for the mean and covariance structure (<code class="reqn">\beta, \sigma^2, \phi, \tau^2</code>) in the
Naive 1 method.</p>
</td></tr>
<tr><td><code>theta2</code></td>
<td>
<p>vector of estimate parameter for the mean and covariance structure (<code class="reqn">\beta, \sigma^2, \phi, \tau^2</code>) in the
Naive 2 method.</p>
</td></tr>
<tr><td><code>predictions1</code></td>
<td>
<p>predictions obtained for the Naive 1 method.</p>
</td></tr>
<tr><td><code>predictions2</code></td>
<td>
<p>predictions obtained for the Naive 2 method.</p>
</td></tr>
<tr><td><code>AIC1</code></td>
<td>
<p>AIC of the estimated model in the Naive 1 method.</p>
</td></tr>
<tr><td><code>AIC2</code></td>
<td>
<p>AIC of the estimated model in the Naive 2 method.</p>
</td></tr>
<tr><td><code>BIC1</code></td>
<td>
<p>BIC of the estimated model in the Naive 1 method.</p>
</td></tr>
<tr><td><code>BIC2</code></td>
<td>
<p>BIC of the estimated model in the Naive 2 method.</p>
</td></tr>
<tr><td><code>loglik1</code></td>
<td>
<p>log likelihood for the estimated model in the Naive 1 method.</p>
</td></tr>
<tr><td><code>loglik2</code></td>
<td>
<p>log likelihood for the estimated model in the Naive 2 method.</p>
</td></tr>
<tr><td><code>sdpred1</code></td>
<td>
<p>standard deviations of predictions in the Naive 1 method.
</p>
</td></tr>
<tr><td><code>sdpred2</code></td>
<td>
<p>standard deviations of predictions in the Naive 2 method.
</p>
</td></tr>
<tr><td><code>type</code></td>
<td>
<p>covariance function used in estimation.
</p>
</td></tr>
<tr><td><code>trend1</code></td>
<td>
<p>trend form for the mean structure.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Alejandro Ordonez &lt;&lt;ordonezjosealejandro@gmail.com&gt;&gt;, Victor H. Lachos &lt;&lt;hlachos@ime.unicamp.br&gt;&gt;
and Christian E. Galarza &lt;&lt;cgalarza88@gmail.com&gt;&gt;
</p>
<p>Maintainer: Alejandro Ordonez &lt;&lt;ordonezjosealejandro@gmail.com&gt;&gt;
</p>


<h3>References</h3>

<p>Schelin, L. &amp; Sjostedt-de Luna, S. (2014). Spatial prediction in the presence of left-censoring.
Computational Statistics and Data Analysis, 74.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+SAEMSCL">SAEMSCL</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>###simulated coordinates
n&lt;-200 ### sample size for estimation.
n1=100 ### number of observation used in the prediction.

###simulated coordinates
r1=sample(seq(1,30,length=400),n+n1)
r2=sample(seq(1,30,length=400),n+n1)
coords=cbind(r1,r2)### total coordinates (used in estimation and prediction).

coords1=coords[1:n,]####coordinates used for estimation.

type="matern"### covariance structure.

xtot&lt;-cbind(1,runif((n+n1)),runif((n+n1),2,3))## X matrix for estimation and prediction.
xobs=xtot[1:n,]## X matrix for estimation.

###simulated data
obj=rspacens(cov.pars=c(3,.3,0),beta=c(5,3,1),x=xtot,coords=coords,kappa=1.2,
cens=0.25,n=(n+n1),n1=n1,cov.model=type,cens.type="left")

data2=obj$datare
data2[,4:5]=xobs[,-1]

cc=obj$cc
y=obj$datare[,3]
cutoff=rep(obj$cutoff,length(y[cc==1]))


aux2=algnaive12(data=data2,cc=obj$cc,covar=TRUE,covar.col=4:5,
copred=obj$coords1,thetaini=c(.1,.2),y.col=3,coords.col=1:2,
fix.nugget=TRUE,nugget=0,kappa=1.2,cutoff=cutoff,trend=~V4+V5,
cov.model=type)

summary(aux2)

</code></pre>

<hr>
<h2 id='depth'>
Depths of a geological horizon.
</h2><span id='topic+depth'></span>

<h3>Description</h3>

<p>Dataset previously analyzed by Dubrule and
Kostov (1986) and De Oliveira (2005).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("depth")</code></pre>


<h3>Format</h3>

<p>A data frame with 100 observations on the following 6 variables.
</p>

<dl>
<dt><code>coord x</code></dt><dd><p>x coordinate for depth data.</p>
</dd>
<dt><code>coord y</code></dt><dd><p>y coordinate for depth data.</p>
</dd>
<dt><code>cc</code></dt><dd><p>indicator of censure (left and right censure).</p>
</dd>
<dt><code>LI</code></dt><dd><p>lower limit of censure for depth data.</p>
</dd>
<dt><code>LS</code></dt><dd><p>upper limit of censure for depth data.</p>
</dd>
<dt><code>depth</code></dt><dd><p>observated depth.</p>
</dd>
</dl>



<h3>Details</h3>

<p>The observations are placed over a region of about 9 by 5 km and
represent depths of a geological horizon measured at 100 locations where 69 points are fully observed
and 31 points are censored points, these are divided into left- and right- censored points.
The depth data were transformed and their original units remains unknown for confidentiality reasons. For additional details about this dataset we refer to De Oliveira
(2005).
</p>


<h3>References</h3>

<p>Dubrule, O. and C. Kostov (1986). An interpolation method taking into account inequality constraints:
I. methodology. Mathematical Geology 18(1), 33-51.
</p>
<p>De Oliveira, V. (2005). Bayesian inference and prediction of Gaussian random fields based on censored
data. Journal of Computational and Graphical Statistics 14(1), 95-115.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(depth)
summary(depth$depth)
</code></pre>

<hr>
<h2 id='derivcormatrix'>First and second derivates of some correlation matrix
</h2><span id='topic+derivcormatrix'></span>

<h3>Description</h3>

<p>It computes the matrix of first and second derivates for the
exponential, gaussian, matern, spherical, powered exponential and
Cauchy correlation matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>derivcormatrix(coords, phi, kappa = 0, cov.model = "exponential")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="derivcormatrix_+3A_coords">coords</code></td>
<td>

<p>2D spatial coordinates.
</p>
</td></tr>
<tr><td><code id="derivcormatrix_+3A_phi">phi</code></td>
<td>

<p>parameter for the matern, powered exponential and cauchy functions.
</p>
</td></tr>
<tr><td><code id="derivcormatrix_+3A_kappa">kappa</code></td>
<td>

<p>parameter for all correlation functions.
</p>
</td></tr>
<tr><td><code id="derivcormatrix_+3A_cov.model">cov.model</code></td>
<td>

<p>parameter correlation funtion to calculates the derivates in this case 6 functions are avalible
&quot;exponential&quot;, &quot;gaussian&quot;, &quot;matern&quot;, &quot;spherical&quot;, &quot;powered.exponential&quot;, &quot;cauchy&quot;.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The correlations functions used to calculate the derivates
from this 6 functions are based in the functions
by the package <code>geoR</code> (see <code>cov.spatial</code>).
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>H</code></td>
<td>
<p>distance matrix.</p>
</td></tr>
<tr><td><code>devR1</code></td>
<td>
<p>first derivate of the correlation matrix.</p>
</td></tr>
<tr><td><code>devR2</code></td>
<td>
<p>second derivate of the correlation matrix.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Alejandro Ordonez &lt;&lt;ordonezjosealejandro@gmail.com&gt;&gt;, Victor H. Lachos &lt;&lt;hlachos@ime.unicamp.br&gt;&gt;
and Christian E. Galarza &lt;&lt;cgalarza88@gmail.com&gt;&gt;
</p>
<p>Maintainer: Alejandro Ordonez &lt;&lt;ordonezjosealejandro@gmail.com&gt;&gt;
</p>


<h3>References</h3>

<p>Diggle, P. &amp; Ribeiro, P. (2007). Model-Based Geostatistics. Springer Series in Statistics.
</p>
<p>Gradshtejn, I. S. &amp; Ryzhik, I. M. (1965). Table of integrals, series and products. Academic Press.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+SAEMSCL">SAEMSCL</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n&lt;-200
n1=100
r1=sample(seq(1,30,length=400),n+n1)
r2=sample(seq(1,30,length=400),n+n1)
coords=cbind(r1,r2)

s=derivcormatrix(coords=coords,phi=2,kappa=2,cov.model="exponential")

</code></pre>

<hr>
<h2 id='derivQfun'>Maximum Likelihood Expectation (<code class="reqn">logQ</code> function and its derivates)
</h2><span id='topic+derivQfun'></span>

<h3>Description</h3>

<p>It computes the <code class="reqn">logQ</code> function, its derivates of first and second order and the inverse of the hessian matrix for the SAEM estimated parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>derivQfun(est, fix.nugget = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="derivQfun_+3A_est">est</code></td>
<td>

<p>object of the class &quot;SAEMSpatialCens&quot;. See <code>SAEMSCL</code> function.
</p>
</td></tr>
<tr><td><code id="derivQfun_+3A_fix.nugget">fix.nugget</code></td>
<td>

<p>(logical) it indicates if the <code class="reqn">\tau^2</code> parameter must be fixed.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code class="reqn">logQ</code> function refers to the logarithm of the Maximum likelihood conditional expectation, the first and second moments of the truncated normal distribution of censored data are involved in its computation.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>Qlogvalue</code></td>
<td>
<p>value of the <code class="reqn">logQ</code> function evaluated in the SAEM estimates.</p>
</td></tr>
<tr><td><code>gradQ</code></td>
<td>
<p>gradient for the <code class="reqn">logQ</code> function evaluated in the SAEM estimates.</p>
</td></tr>
<tr><td><code>HQ</code></td>
<td>
<p>hessian Matrix for the <code class="reqn">logQ</code> function evaluated in the SAEM estimates.</p>
</td></tr>
<tr><td><code>Qinv</code></td>
<td>
<p>inverse of the negative Hessian matrix for the <code class="reqn">logQ</code> function evaluated in the SAEM estimates.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Alejandro Ordonez &lt;&lt;ordonezjosealejandro@gmail.com&gt;&gt;, Victor H. Lachos &lt;&lt;hlachos@ime.unicamp.br&gt;&gt;
and Christian E. Galarza &lt;&lt;cgalarza88@gmail.com&gt;&gt;
</p>
<p>Maintainer: Alejandro Ordonez &lt;&lt;ordonezjosealejandro@gmail.com&gt;&gt;
</p>


<h3>References</h3>

<p>Diggle, P. &amp; Ribeiro, P. (2007). Model-Based Geostatistics. Springer Series in Statistics.
</p>
<p>Gradshtejn, I. S. &amp; Ryzhik, I. M. (1965). Table of integrals, series and products. Academic Press.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+SAEMSCL">SAEMSCL</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(geoR)
data("Missouri")
data=Missouri[1:70,]
data$V3=log((data$V3))



cc=data$V5
y=data$V3
datare1=data
coords=datare1[,1:2]
data1=data.frame(coords,y)
data1=data1[cc==0,]
geodata=as.geodata(data1,y.col=3,coords.col=1:2)
v=variog(geodata)
v1=variofit(v)
cov.ini=c(0,2)

est=SAEMSCL(cc,y,cens.type="left",trend="cte",coords=coords,M=15,perc=0.25,MaxIter=5,pc=0.2,
cov.model="exponential",fix.nugget=TRUE,nugget=2,inits.sigmae=cov.ini[2],inits.phi=cov.ini[1],
search=TRUE,lower=0.00001,upper=50)


d1=derivQfun(est)
d1$QI
</code></pre>

<hr>
<h2 id='distmatrix'>Distance matrix</h2><span id='topic+distmatrix'></span>

<h3>Description</h3>

<p>It computes the euclidean distance matrix for a set of coordinates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>distmatrix(coords)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="distmatrix_+3A_coords">coords</code></td>
<td>

<p>2D spatial coordinates.
</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>dist</code></td>
<td>
<p>symetric matrix of distances between points.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Alejandro Ordonez &lt;&lt;ordonezjosealejandro@gmail.com&gt;&gt;, Victor H. Lachos &lt;&lt;hlachos@ime.unicamp.br&gt;&gt;
and Christian E. Galarza &lt;&lt;cgalarza88@gmail.com&gt;&gt;
</p>
<p>Maintainer: Alejandro Ordonez &lt;&lt;ordonezjosealejandro@gmail.com&gt;&gt;
</p>


<h3>References</h3>

<p>Diggle, P. &amp; Ribeiro, P. (2007). Model-Based Geostatistics.
Springer Series in Statistics.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+SAEMSCL">SAEMSCL</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n&lt;-200
n1=100

####Simulating spatial coordinates##
r1=sample(seq(1,30,length=400),n+n1)
r2=sample(seq(1,30,length=400),n+n1)
coords=cbind(r1,r2)

H=distmatrix(coords)
</code></pre>

<hr>
<h2 id='localinfmeas'>Local influence measures.
</h2><span id='topic+localinfmeas'></span>

<h3>Description</h3>

<p>It computes some measures and plots to asses the local influence of outliers in the SAEM spatial estimation
for censored spatial observations, for six types of covariance functions (est$type): &quot;exponential&quot;, &quot;matern&quot;, &quot;gauss&quot;, &quot;spherical&quot;,&quot;powered.exponential&quot; or &quot;stable&quot; and &quot;cauchy&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>localinfmeas(est, fix.nugget = TRUE, diag.plot = TRUE, type.plot = "all", c = 3)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="localinfmeas_+3A_est">est</code></td>
<td>

<p>object of the class &quot;SAEMSpatialCens&quot;. See <code>SAEMSCL</code> function.
</p>
</td></tr>
<tr><td><code id="localinfmeas_+3A_fix.nugget">fix.nugget</code></td>
<td>

<p>(logical) it indicates if the <code class="reqn">\tau^2</code> parameter must be fixed.
</p>
</td></tr>
<tr><td><code id="localinfmeas_+3A_diag.plot">diag.plot</code></td>
<td>

<p>(logical) it indicates if diagnostic plots must be showed.
</p>
</td></tr>
<tr><td><code id="localinfmeas_+3A_type.plot">type.plot</code></td>
<td>

<p>type of plot (all: all graphics, rp: response perturbation,smp: scale matrix perturbation,
evp: explanatory variable perturbation).
</p>
</td></tr>
<tr><td><code id="localinfmeas_+3A_c">c</code></td>
<td>

<p>constant used for fixing the limit of detection (benchmark value).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>this function uses the Maximum likelihood expectation (MLE) under three perturbation schemes,
in the response (<code class="reqn">M(0)_y</code>), scale matrix (<code class="reqn">M(0)_{\Sigma}</code>) and explanatory variables (<code class="reqn">M(0)_X</code>), to detect the influence of outliers in the SAEM estimation procedure.
</p>


<h3>Value</h3>

<p>in addition to the diagnostic graphics (response, scale matrix and explanatory variable schemes, respectively), the function returns the next values.
</p>
<table role = "presentation">
<tr><td><code>Qwrp</code></td>
<td>
<p>negative <code class="reqn">Q_{\omega_0}</code> matrix under the response perturbation scheme.</p>
</td></tr>
<tr><td><code>Qwsmp</code></td>
<td>
<p>negative <code class="reqn">Q_{\omega_0}</code> matrix under the scale matrix perturbation scheme.</p>
</td></tr>
<tr><td><code>Qwevp</code></td>
<td>
<p>negative <code class="reqn">Q_{\omega_0}</code> matrix under the explanatory variable perturbation scheme.</p>
</td></tr>
<tr><td><code>respper</code></td>
<td>
<p>data.frame containing an indicator of the presence of atypical values
and the <code class="reqn">M(0)</code> values for the response perturbation scheme.</p>
</td></tr>
<tr><td><code>smper</code></td>
<td>
<p>data.frame containing an indicator of the presence of atypical values
and the <code class="reqn">M(0)</code> values for the scale matrix perturbation scheme.</p>
</td></tr>
<tr><td><code>expvper</code></td>
<td>
<p>a data.frame containing an indicator of the presence of atypical values
and the <code class="reqn">M(0)</code> values for the explanatory variable perturbation scheme.</p>
</td></tr>
<tr><td><code>limrp</code></td>
<td>
<p>limit of detection for outliers for the response perturbation scheme.</p>
</td></tr>
<tr><td><code>limsmp</code></td>
<td>
<p>limit of detection for outliers for the scale matrix perturbation scheme.</p>
</td></tr>
<tr><td><code>limevp</code></td>
<td>
<p>limit of detection for outliers for the explanatory variable perturbation scheme.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Alejandro Ordonez &lt;&lt;ordonezjosealejandro@gmail.com&gt;&gt;, Victor H. Lachos &lt;&lt;hlachos@ime.unicamp.br&gt;&gt;
and Christian E. Galarza &lt;&lt;cgalarza88@gmail.com&gt;&gt;
</p>
<p>Maintainer: Alejandro Ordonez &lt;&lt;ordonezjosealejandro@gmail.com&gt;&gt;
</p>


<h3>References</h3>

<p>Cook, R. D. (1986). Assessment of local influence. Journal of the Royal Statistical Society, Series B,, 48, 133-169.
</p>
<p>Zhu, H., Lee, S., Wei, B. &amp; Zhou, J. (2001). Case-deletion measures for models with incomplete data. Biometrika,
88, 727-737.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+SAEMSCL">SAEMSCL</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>



require(geoR)

data("Missouri")
data=Missouri
data$V3=log((data$V3))
cc=data$V5
y=data$V3
n=127
k=1
datare1=data
coords=datare1[,1:2]
data1=data.frame(coords,y)
data1=data1[cc==0,]
geodata=as.geodata(data1,y.col=3,coords.col=1:2)
v=variog(geodata)
v1=variofit(v)
cov.ini=c(0,2)
est=SAEMSCL(cc,y,cens.type="left",trend="cte",coords=coords,M=15,perc=0.25,
MaxIter=5,pc=0.2,cov.model="exponential",fix.nugget=TRUE,nugget=2,
inits.sigmae=cov.ini[2],inits.phi=cov.ini[1], search=TRUE,lower=0.00001,upper=100)


w=localinfmeas(est,fix.nugget=TRUE,c=3)

res=w$respper
res[res[,1]=="atypical obs",]

sm=w$smper
sm[sm[,1]=="atypical obs",]

ev=w$expvper
ev[ev[,1]=="atypical obs",]


##############ANOTHER EXAMPLE#########

n&lt;-200 ### sample size for estimation
n1=100 ### number of observation used in the prediction

###simulated coordinates
r1=sample(seq(1,30,length=400),n+n1)
r2=sample(seq(1,30,length=400),n+n1)
coords=cbind(r1,r2)

coords1=coords[1:n,]

cov.ini=c(0.2,0.1)
type="exponential"
xtot=as.matrix(rep(1,(n+n1)))
xobs=xtot[1:n,]
beta=5

###simulated data
obj=rspacens(cov.pars=c(3,.3,0),beta=beta,x=xtot,coords=coords,cens=0.25,n=(n+n1),
n1=n1,cov.model=type,cens.type="left")

data2=obj$datare
cc=obj$cc
y=obj$datare[,3]

##### generating atypical observations###
y[91]=y[91]+4
y[126]=y[126]+4
y[162]=y[162]+4
coords=obj$datare[,1:2]

###initial values###
cov.ini=c(0.2,0.1)

est=SAEMSCL(cc,y,cens.type="left",trend="cte",coords=coords,M=15,perc=0.25,
MaxIter=10,pc=0.2,cov.model=type,fix.nugget=TRUE,nugget=0,inits.sigmae=cov.ini[1],
inits.phi=cov.ini[2],search=TRUE,lower=0.00001,upper=50)


w=localinfmeas(est,fix.nugget=TRUE,c=3)

res=w$respper
res[res[,1]=="atypical obs",]

sm=w$smper
sm[sm[,1]=="atypical obs",]

ev=w$expvper
ev[ev[,1]=="atypical obs",]


</code></pre>

<hr>
<h2 id='Missouri'>
TCDD concentrations in Missouri (1971).
</h2><span id='topic+Missouri'></span>

<h3>Description</h3>

<p>Contents the data of TCDD concentrations used for Zirschky et al. in his geostatistical analysis of Hazardous waste data in Missouri.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("Missouri")</code></pre>


<h3>Format</h3>

<p>A data frame with 127 observations on the following 5 variables.
</p>

<dl>
<dt><code>V1</code></dt><dd><p>x coordinate of start of each transect (ft).</p>
</dd>
<dt><code>V2</code></dt><dd><p>y coordinate of start of each transect (ft).</p>
</dd>
<dt><code>V3</code></dt><dd><p>TCDD Concentrations (mg/m^3).</p>
</dd>
<dt><code>V4</code></dt><dd><p>transect length (ft).</p>
</dd>
<dt><code>V5</code></dt><dd><p>indicator of censure (left censure in all data).</p>
</dd>
</dl>



<h3>Source</h3>

<p>The data was collected in November 1983 by U.S. EPA in several areas of a highway from Missouri. Only the locations used in the geostatistical analysis  by the autors are showed.
</p>


<h3>References</h3>

<p>Zirschky, J. H. &amp; Harris, D. J. (1986). Geostatistical analysis of hazardous waste site data. Journal of Environmental
Engineering, 112(4), 770-784.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Missouri)
summary(Missouri$V3)
</code></pre>

<hr>
<h2 id='predgraphics'>Prediction graphics for SAEM Algortihm for censored spatial data.</h2><span id='topic+predgraphics'></span>

<h3>Description</h3>

<p>This function provides prediction raster graphics representation and its standard deviation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predgraphics(xpred = NULL, grid1, est, points = TRUE,obspoints = 1:sum(est$cc == 0),
colors = terrain.colors(100),sdgraph = TRUE,xlab="X Coord",ylab="Y Coord",
main1="Predicted response", main2="Standard deviation predicted",
xlim=c(min(est$coords[,1]),max(est$coords[,1])),ylim=c(min(est$coords[,2]),
max(est$coords[,2])))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predgraphics_+3A_xpred">xpred</code></td>
<td>

<p>x design matrix for the prediction coordinates (must be specified when est$trend=&quot;other&quot;).
</p>
</td></tr>
<tr><td><code id="predgraphics_+3A_grid1">grid1</code></td>
<td>

<p>grid with the coordinates of the prediction graphics.
</p>
</td></tr>
<tr><td><code id="predgraphics_+3A_est">est</code></td>
<td>

<p>object of class &quot;SAEMSpatialCens&quot;.
</p>
</td></tr>
<tr><td><code id="predgraphics_+3A_points">points</code></td>
<td>

<p>(logical), it indicates if some of the observed points may be plotted in the prediction raster graphic (default, points=<code>TRUE</code>).
</p>
</td></tr>
<tr><td><code id="predgraphics_+3A_obspoints">obspoints</code></td>
<td>

<p>(vector) if points=<code>TRUE</code>, it indicates which of the observed (not censored) values may be plotted in the prediction raster graphics.
</p>
</td></tr>
<tr><td><code id="predgraphics_+3A_colors">colors</code></td>
<td>

<p>colors pallete used for the graphics (By default <code>terrain.colors(100)</code>).
</p>
</td></tr>
<tr><td><code id="predgraphics_+3A_sdgraph">sdgraph</code></td>
<td>

<p>(logical) it indicates if the standard deviation of the prediction points graphic must be plotted (default sdgraph=<code>TRUE</code>).
</p>
</td></tr>
<tr><td><code id="predgraphics_+3A_xlab">xlab</code></td>
<td>
<p>label for x coordinate of the two plots.</p>
</td></tr>
<tr><td><code id="predgraphics_+3A_ylab">ylab</code></td>
<td>
<p>label for y coordinate.</p>
</td></tr>
<tr><td><code id="predgraphics_+3A_main1">main1</code></td>
<td>
<p>an overall title for the prediction plot.</p>
</td></tr>
<tr><td><code id="predgraphics_+3A_main2">main2</code></td>
<td>
<p>an overall title for the standard deviation prediction plot.</p>
</td></tr>
<tr><td><code id="predgraphics_+3A_xlim">xlim</code></td>
<td>
<p>x axis limits for the two plots.</p>
</td></tr>
<tr><td><code id="predgraphics_+3A_ylim">ylim</code></td>
<td>
<p>y axis limits for the two plots.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>in addition to the raster graphics for prediction, the next values are retorned:
</p>
<table role = "presentation">
<tr><td><code>datapred</code></td>
<td>
<p>data.frame with the coordinates and the predicted points used in the prediction raster graphic.</p>
</td></tr>
<tr><td><code>datasdpred</code></td>
<td>
<p>data.frame with the coordinates and the standard deviation predicted points used in the standard deviation prediction raster graphic.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Alejandro Ordonez &lt;&lt;ordonezjosealejandro@gmail.com&gt;&gt;, Victor H. Lachos &lt;&lt;hlachos@ime.unicamp.br&gt;&gt;
and Christian E. Galarza &lt;&lt;cgalarza88@gmail.com&gt;&gt;
</p>
<p>Maintainer: Alejandro Ordonez &lt;&lt;ordonezjosealejandro@gmail.com&gt;&gt;
</p>


<h3>References</h3>

<p>DELYON, B., LAVIELLE, M.,ANDMOULI NES, E. (1999).  Convergence ofa stochastic approximation version of the EM algorithm.Annals of Statistic-s27, 1, 94-128.
</p>
<p>Diggle, P. &amp; Ribeiro, P. (2007). Model-Based Geostatistics. Springer Series in Statistics.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+SAEMSCL">SAEMSCL</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>


data(depth)
cc=depth$cc
y=depth$depth
coords=depth[,1:2]

cov.ini=c(1500,30)
est=SAEMSCL(cc,y,cens.type="left",trend="cte",coords=coords,M=15,perc=0.25,
MaxIter=100,pc=0.2,cov.model="gaussian",fix.nugget=FALSE,nugget=10,
inits.sigmae=cov.ini[2],inits.phi=cov.ini[1], search=TRUE,lower=c(0.00001,0.00001),
upper=c(10000,100))


coorgra1=seq(min(coords[,1]),max(coords[,1]),length=50)
coorgra2=seq(min(coords[,2]),max(coords[,2]),length=50)

grid1=expand.grid(x=coorgra1,y=coorgra2)
xpred=rep(1,2500)

predgraphics(xpred=xpred,est=est,grid1=grid1,points=TRUE,sdgraph=TRUE)


</code></pre>

<hr>
<h2 id='predSCL'>
Prediction for the SAEM algorithm for censored spatial data.
</h2><span id='topic+predSCL'></span>

<h3>Description</h3>

<p>This function uses the parameters estimates from SAEM to predict values at unknown locations through the MSE criterion assuming normal distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predSCL(xpred, coordspred, est)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predSCL_+3A_xpred">xpred</code></td>
<td>

<p>values of the x design matrix for prediction coordinates.
</p>
</td></tr>
<tr><td><code id="predSCL_+3A_coordspred">coordspred</code></td>
<td>

<p>points coordinates to be predicted.
</p>
</td></tr>
<tr><td><code id="predSCL_+3A_est">est</code></td>
<td>

<p>object of the class SAEMSpatialCens (see <code>SAEMSCL</code> function).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function predicts using the Mean Square of error (MSE) criterion, that is, it takes the conditional
expectation <code class="reqn">E(Y|X)</code> as the predictor that minimizes the MSE.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>prediction</code></td>
<td>
<p>prediction value.</p>
</td></tr>
<tr><td><code>indpred</code></td>
<td>
<p>indicator for the observed and predicted values (0:observed,1:predicted).</p>
</td></tr>
<tr><td><code>sdpred</code></td>
<td>
<p>standard deviation for prediction.</p>
</td></tr>
<tr><td><code>coordspred</code></td>
<td>
<p>points coordinates predicted.</p>
</td></tr>
<tr><td><code>coordsobs</code></td>
<td>
<p>observed coordinates.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Alejandro Ordonez &lt;&lt;ordonezjosealejandro@gmail.com&gt;&gt;, Victor H. Lachos &lt;&lt;hlachos@ime.unicamp.br&gt;&gt;
and Christian E. Galarza &lt;&lt;cgalarza88@gmail.com&gt;&gt;
</p>
<p>Maintainer: Alejandro Ordonez &lt;&lt;ordonezjosealejandro@gmail.com&gt;&gt;
</p>


<h3>References</h3>

<p>DELYON, B., LAVIELLE, M.,ANDMOULI NES, E. (1999).  Convergence of a stochastic approximation version of the EM algorithm.Annals of Statistic-s27, 1, 94-128.
</p>
<p>Diggle, P. &amp; Ribeiro, P. (2007). Model-Based Geostatistics. Springer Series in Statistics.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+SAEMSCL">SAEMSCL</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>






n&lt;-200 ### sample size for estimation.
n1=100 ### number of observation used in the prediction.

###simulated coordinates
r1=sample(seq(1,30,length=400),n+n1)
r2=sample(seq(1,30,length=400),n+n1)

coords=cbind(r1,r2)### coordinates for estimation and prediction.

coords1=coords[1:n,]####coordinates used in estimation.

cov.ini=c(0.2,0.1)###initial values for phi and sigma2.

type="matern"
xtot&lt;-cbind(1,runif((n+n1)),runif((n+n1),2,3))###X matrix for estimation and prediction.

xobs=xtot[1:n,]###X matrix for estimation.
beta=c(5,3,1)

###simulated data
obj=rspacens(cov.pars=c(3,.3,0),beta=beta,x=xtot,coords=coords,kappa=1.2,cens=0.25,
n=(n+n1),n1=n1,cov.model=type,cens.type="left")

data2=obj$datare
cc=obj$cc
y=obj$datare[,3]
coords=obj$datare[,1:2]


#######SAEMSpatialCens object########

est=SAEMSCL(cc,y,cens.type="left",trend="other",x=xobs,coords=coords,kappa=1.2,M=15,
perc=0.25,MaxIter=10,pc=0.2,cov.model="exponential",fix.nugget=TRUE,nugget=0,
inits.sigmae=cov.ini[2],inits.phi=cov.ini[1],search=TRUE,lower=0.00001,upper=50)


coordspred=obj$coords1
xpred=xtot[(n+1):(n+n1),]
h=predSCL(xpred,coordspred,est)


</code></pre>

<hr>
<h2 id='rspacens'>Censored Spatial data simulation
</h2><span id='topic+rspacens'></span>

<h3>Description</h3>

<p>It simulates spatial data with linear structure for one type of censure (left or right).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rspacens(cov.pars,beta,x=as.matrix(rep(1,n)),coords,kappa=0,cens,n,n1,
cov.model="exponential",cens.type)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rspacens_+3A_cov.pars">cov.pars</code></td>
<td>

<p>covariance structure parameters for the errors distribution (<code class="reqn">\phi,  \sigma^2, \tau^2</code>).
</p>
</td></tr>
<tr><td><code id="rspacens_+3A_beta">beta</code></td>
<td>

<p>linear regression parameters.
</p>
</td></tr>
<tr><td><code id="rspacens_+3A_x">x</code></td>
<td>

<p>design matrix.
</p>
</td></tr>
<tr><td><code id="rspacens_+3A_coords">coords</code></td>
<td>

<p>coordinates of simulated data.
</p>
</td></tr>
<tr><td><code id="rspacens_+3A_kappa">kappa</code></td>
<td>

<p><code class="reqn">\kappa</code> parameter used in some covariance structures.
</p>
</td></tr>
<tr><td><code id="rspacens_+3A_cens">cens</code></td>
<td>

<p>percentage of censure in the data (number between 0 and 1).
</p>
</td></tr>
<tr><td><code id="rspacens_+3A_n">n</code></td>
<td>

<p>number of simulated data used in estimation.
</p>
</td></tr>
<tr><td><code id="rspacens_+3A_n1">n1</code></td>
<td>

<p>number of simulated data used for cross validation (Prediction).
</p>
</td></tr>
<tr><td><code id="rspacens_+3A_cov.model">cov.model</code></td>
<td>

<p>covariance structure for the data (see <code>cov.spatial</code> from <code>geoR</code>).
</p>
</td></tr>
<tr><td><code id="rspacens_+3A_cens.type">cens.type</code></td>
<td>

<p>type of censure (<code>"left"</code> or <code>"right"</code>).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function analyses prediction in spatial data. It returns a
spatial dataset for estimation (n length) and a spatial dataset (n1 length) used to evaluate the prediction power of a model through
cross validation. The covariance functions used here were provided by cov.spatial from the geoR package.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>y</code></td>
<td>

<p>complete simulated data (<code class="reqn">(n+n1)</code> length).
</p>
</td></tr>
<tr><td><code>datare</code></td>
<td>

<p>data frame that will be used for the model estimation (coordinates and response).
</p>
</td></tr>
<tr><td><code>valre</code></td>
<td>

<p>data that will be used for cross validation studies (just response).
</p>
</td></tr>
<tr><td><code>cc</code></td>
<td>

<p>indicator of censure (1:censored 0:observed).
</p>
</td></tr>
<tr><td><code>cutoff</code></td>
<td>

<p>limit of detection simulated for censure (left: &lt;=cutoff, right: &gt; cutoff).
</p>
</td></tr>
<tr><td><code>coords1</code></td>
<td>

<p>coordinates of value data.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Alejandro Ordonez &lt;&lt;ordonezjosealejandro@gmail.com&gt;&gt;, Victor H. Lachos &lt;&lt;hlachos@ime.unicamp.br&gt;&gt;
and Christian E. Galarza &lt;&lt;cgalarza88@gmail.com&gt;&gt;
</p>
<p>Maintainer: Alejandro Ordonez &lt;&lt;ordonezjosealejandro@gmail.com&gt;&gt;
</p>


<h3>References</h3>

<p>Diggle, P. &amp; Ribeiro, P. (2007). Model-Based Geostatistics. Springer Series in Statistics.
</p>
<p>Schelin, L. &amp; Sjostedt-de Luna, S. (2014). Spatial prediction in the presence of left-censoring. Computational Statistics and Data Analysis, 74.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+SAEMSCL">SAEMSCL</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
n&lt;-200 ### sample size for estimation.
n1=100 ### number of observation used in the prediction.

###simulated coordinates
r1=sample(seq(1,30,length=400),n+n1)
r2=sample(seq(1,30,length=400),n+n1)
coords=cbind(r1,r2)### total coordinates (used in estimation and prediction).
coords1=coords[1:n,]####coordinates used for estimation.

type="matern"### covariance structure.

xtot&lt;-cbind(1,runif((n+n1)),runif((n+n1),2,3))## X matrix for estimation and prediction.
xobs=xtot[1:n,]## X matrix for estimation

obj=rspacens(cov.pars=c(3,.3,0),beta=c(5,3,1),x=xtot,coords=coords,
kappa=1.2,cens=0.25,n=(n+n1),n1=n1,cov.model=type,cens.type="left")

</code></pre>

<hr>
<h2 id='SAEMSCL'>SAEM Algorithm estimation for censored spatial data.
</h2><span id='topic+SAEMSCL'></span>

<h3>Description</h3>

<p>It estimates the parameters for a linear spatial model with censored observations
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SAEMSCL(cc, y, cens.type="left", trend = "cte", LI = NULL, LS = NULL, x = NULL, coords,
kappa = 0, M = 20, perc = 0.25, MaxIter = 300, pc = 0.2, cov.model = "exponential",
fix.nugget = TRUE, nugget, inits.sigmae, inits.phi, search = FALSE, lower, upper)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SAEMSCL_+3A_cc">cc</code></td>
<td>

<p>(binary vector) indicator of censure (1: censored observation 0: observed).
</p>
</td></tr>
<tr><td><code id="SAEMSCL_+3A_y">y</code></td>
<td>

<p>(vector) corresponds to  response variable.
</p>
</td></tr>
<tr><td><code id="SAEMSCL_+3A_cens.type">cens.type</code></td>
<td>

<p>type of censure (<code>"left"</code>:left or <code>"right"</code>:right).
</p>
</td></tr>
<tr><td><code id="SAEMSCL_+3A_trend">trend</code></td>
<td>

<p>linear trends options: <code>"cte"</code>, <code>"1st"</code>, <code>"2nd"</code> and <code>"other"</code>, the three first are defined
like in <code>geoR</code>, if trend=<code>"other"</code>, x (design matrix) must be defined.
</p>
</td></tr>
<tr><td><code id="SAEMSCL_+3A_li">LI</code></td>
<td>

<p>(vector) lower limit, if cens.type=<code>"both"</code>, LI must be provided, if cens.type=<code>"left"</code>
or <code>"right"</code> LI and LS are defined by the function through the indicator of censure cc.
</p>
</td></tr>
<tr><td><code id="SAEMSCL_+3A_ls">LS</code></td>
<td>

<p>(vector) upper limit, if <code>cens.type="both"</code>, LS must be provided, if <code>cens.type="left"</code>
or &quot;right&quot; LI and LS are defined by the function through the indicator of censure cc.
</p>
</td></tr>
<tr><td><code id="SAEMSCL_+3A_x">x</code></td>
<td>

<p>design matrix.
</p>
</td></tr>
<tr><td><code id="SAEMSCL_+3A_coords">coords</code></td>
<td>

<p>corresponds to the coordinates of the spatial data (2D coordinates).
</p>
</td></tr>
<tr><td><code id="SAEMSCL_+3A_kappa">kappa</code></td>
<td>

<p>value of kappa used in some covariance functions.
</p>
</td></tr>
<tr><td><code id="SAEMSCL_+3A_m">M</code></td>
<td>

<p>number of montecarlo samples for stochastic aproximation.
</p>
</td></tr>
<tr><td><code id="SAEMSCL_+3A_perc">perc</code></td>
<td>

<p>percentage of burn-in on the Monte Carlo sample. Default=0.25.
</p>
</td></tr>
<tr><td><code id="SAEMSCL_+3A_maxiter">MaxIter</code></td>
<td>

<p>maximum of iterations for the algorithm.
</p>
</td></tr>
<tr><td><code id="SAEMSCL_+3A_pc">pc</code></td>
<td>

<p>percentage of initial iterations of the SAEM algorithm.
(Default=0.2).
</p>
</td></tr>
<tr><td><code id="SAEMSCL_+3A_cov.model">cov.model</code></td>
<td>

<p>covariance Structure (see, <code>cov.spatial</code> from <code>geoR</code>).
</p>
</td></tr>
<tr><td><code id="SAEMSCL_+3A_fix.nugget">fix.nugget</code></td>
<td>

<p>(logical) indicates if the <code class="reqn">\tau^2</code> parameter must be fixed.
</p>
</td></tr>
<tr><td><code id="SAEMSCL_+3A_nugget">nugget</code></td>
<td>

<p>if <code>fix.nugget=TRUE</code>, the algorithm just estimates <code class="reqn">\beta</code>, <code class="reqn">\sigma^2</code>, and <code class="reqn">\phi</code>, and fixed <code class="reqn">\tau^2</code> like nugget, else, <code class="reqn">\tau^2</code> is estimated and nugget corresponds to initial value for <code class="reqn">\tau^2</code>.
</p>
</td></tr>
<tr><td><code id="SAEMSCL_+3A_inits.sigmae">inits.sigmae</code></td>
<td>

<p>corresponds to initial value for <code class="reqn">\sigma^2</code>.
</p>
</td></tr>
<tr><td><code id="SAEMSCL_+3A_inits.phi">inits.phi</code></td>
<td>

<p>corresponds to initial value for <code class="reqn">\phi</code> parameter.
</p>
</td></tr>
<tr><td><code id="SAEMSCL_+3A_search">search</code></td>
<td>

<p>(logical) this argument gives bounds where the optim routine can find the solution that maximizes the Maximum likelihood expectation. If <code>search=F</code>, the optim routine will try to search the solutions for maximization in all the domain for <code class="reqn">\phi</code> and <code class="reqn">\tau^2</code> (if <code>fix.nugget=FALSE</code>). If <code>search=TRUE</code>, the optim routine search the solutions in a specific neighborhood. We recommended to use <code>search=F</code> (see details).
</p>
</td></tr>
<tr><td><code id="SAEMSCL_+3A_lower">lower</code></td>
<td>

<p>(vector or numeric) lower bound from the optim solution. If <code>fix.nugget=T</code>, lower is numerical and corresponds to the lower bound for search the solution of the <code class="reqn">\phi</code> parameter, if <code>fix.nugget=FALSE</code> lower is a vector and corresponds to the lower bounds for search the solution of <code class="reqn">\phi</code> and <code class="reqn">\tau2</code> that maximizes the Maximum Likelihood Expectation
(see details).
</p>
</td></tr>
<tr><td><code id="SAEMSCL_+3A_upper">upper</code></td>
<td>

<p>(vector or numeric) upper bound from the optim solution. If <code>fix.nugget==T</code>, lower is numerical and corresponds to the lower bound for searching the solution of the phi parameter, if <code>fix.nugget==F</code>, lower is a vector and corresponds to the lower bounds for searching the solution for <code class="reqn">\phi</code> and <code class="reqn">\tau^2</code> parameters that maximizes the Maximum Likelihood Expectation</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The estimation process was computed via SAEM algorithm initially proposed by Deylon et. al.(1999). This is a stochastic approximation of the EM procedure. This procedure circunvent the heavy computational time involved in the MCEM procedure necessary for estimating phi and tau2 parameters
(when tau2 is not fixed) since there is not an analytical solution. The search interval was proposed because sometimes the maximization procedure used by optim function does not work for large intervals.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>beta</code></td>
<td>
<p>estimated <code class="reqn">\beta</code>.</p>
</td></tr>
<tr><td><code>sigma2</code></td>
<td>
<p>estimated <code class="reqn">\sigma^2</code>.</p>
</td></tr>
<tr><td><code>phi</code></td>
<td>
<p>estimated <code class="reqn">\phi</code>.</p>
</td></tr>
<tr><td><code>nugget</code></td>
<td>
<p>estimated or fixed <code class="reqn">\tau^2</code>.</p>
</td></tr>
<tr><td><code>Theta</code></td>
<td>
<p>estimated parameters in all iterations (<code class="reqn">\beta, \sigma^2, \phi</code>) or (<code class="reqn">\beta, \sigma^2, \phi, \tau^2</code>) if <code>fix.nugget=F</code>.</p>
</td></tr>
<tr><td><code>loglik</code></td>
<td>
<p>log likelihood for SAEM method.</p>
</td></tr>
<tr><td><code>AIC</code></td>
<td>
<p>Akaike information criteria.</p>
</td></tr>
<tr><td><code>BIC</code></td>
<td>
<p>Bayesian information criteria.</p>
</td></tr>
<tr><td><code>AICcorr</code></td>
<td>
<p>corrected AIC by the number of parameters.</p>
</td></tr>
<tr><td><code>X</code></td>
<td>
<p>design matrix.</p>
</td></tr>
<tr><td><code>Psi</code></td>
<td>
<p>estimated covariance matrix.</p>
</td></tr>
<tr><td><code>theta</code></td>
<td>
<p>final estimation of <code class="reqn">\theta=(\beta, \sigma^2, \phi)</code> or <code class="reqn">\theta=(\beta, \sigma^2, \phi, \tau^2)</code> if <code>fix.nugget=F</code>.</p>
</td></tr>
<tr><td><code>uy</code></td>
<td>
<p>stochastic approximation of the first moment for the truncated normal distribution.</p>
</td></tr>
<tr><td><code>uyy</code></td>
<td>
<p>stochastic approximation of the second moment for the truncated normal distribution.</p>
</td></tr>
<tr><td><code>cc</code></td>
<td>
<p>indicator of censure (0:observed, 1: censored).</p>
</td></tr>
<tr><td><code>type</code></td>
<td>
<p>covariance structure considered in the model.</p>
</td></tr>
<tr><td><code>kappa</code></td>
<td>
<p><code class="reqn">\kappa</code> parameter for some covariance structures.</p>
</td></tr>
<tr><td><code>coords</code></td>
<td>
<p>coordinates of the observed data.</p>
</td></tr>
<tr><td><code>iterations</code></td>
<td>
<p>number of iterations needed to convergence.</p>
</td></tr>
<tr><td><code>fitted</code></td>
<td>
<p>fitted values for the SAEM algortihm.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Alejandro Ordonez &lt;&lt;ordonezjosealejandro@gmail.com&gt;&gt;, Victor H. Lachos &lt;&lt;hlachos@ime.unicamp.br&gt;&gt;
and Christian E. Galarza &lt;&lt;cgalarza88@gmail.com&gt;&gt;
</p>
<p>Maintainer: Alejandro Ordonez &lt;&lt;ordonezjosealejandro@gmail.com&gt;&gt;
</p>


<h3>References</h3>

<p>DELYON, B., LAVIELLE, M.,ANDMOULI NES, E. (1999).  Convergence ofa stochastic approximation version of the EM algorithm.Annals of Statistic-s27, 1, 94-128.
</p>
<p>Diggle, P. &amp; Ribeiro, P. (2007). Model-Based Geostatistics. Springer Series in Statistics.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+localinfmeas">localinfmeas</a></code>, <code><a href="#topic+derivQfun">derivQfun</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>



n&lt;-200 ### sample size for estimation.
n1=100 ### number of observation used in the prediction.

###simulated coordinates
r1=sample(seq(1,30,length=400),n+n1)
r2=sample(seq(1,30,length=400),n+n1)
coords=cbind(r1,r2)

coords1=coords[1:n,]

type="matern"
#xtot&lt;-cbind(1,runif((n+n1)),runif((n+n1),2,3))
xtot=as.matrix(rep(1,(n+n1)))
xobs=xtot[1:n,]
beta=5
#beta=c(5,3,1)

###simulated data
obj=rspacens(cov.pars=c(3,.3,0),beta=beta,x=xtot,coords=coords,kappa=1.2,
cens=0.25,n=(n+n1),n1=n1,cov.model=type,cens.type="left")

data2=obj$datare
cc=obj$cc
y=obj$datare[,3]
coords=obj$datare[,1:2]
##initials values obtained from variofit.
cov.ini=c(0.13,0.86)

est=SAEMSCL(cc,y,cens.type="left",trend="cte",coords=coords,
kappa=1.2,M=15,perc=0.25,MaxIter=10,pc=0.2,cov.model=type,
fix.nugget=TRUE,nugget=0,inits.sigmae=cov.ini[1],
inits.phi=cov.ini[2],search=TRUE,lower=0.00001,upper=100)

summary(est)



</code></pre>

<hr>
<h2 id='Seminaive'>Seminaive algorithm for spatial censored prediction.
</h2><span id='topic+Seminaive'></span>

<h3>Description</h3>

<p>This function executes the seminaive algorithm proposed by Schelin et al. (2014)</p>


<h3>Usage</h3>

<pre><code class='language-R'>Seminaive(data, y.col, coords.col, covar, covar.col, copred,cov.model = "exponential",
thetaini, fix.nugget = TRUE, nugget,kappa = 0, cons, MaxIter, cc, cutoff, trend)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Seminaive_+3A_data">data</code></td>
<td>

<p>data.frame containing the coordinates, covariates and response variable.
</p>
</td></tr>
<tr><td><code id="Seminaive_+3A_y.col">y.col</code></td>
<td>

<p>(numeric) column of data.frame that corresponds to the response variable.
</p>
</td></tr>
<tr><td><code id="Seminaive_+3A_coords.col">coords.col</code></td>
<td>

<p>(numeric) columns of data.frame that corresponds to the coordinates of the spatial data.
</p>
</td></tr>
<tr><td><code id="Seminaive_+3A_covar">covar</code></td>
<td>

<p>(logical) indicates the presence of covariates in the spatial censored estimation (<code>FALSE</code>: without covariates, <code>TRUE</code>: with covariates).
</p>
</td></tr>
<tr><td><code id="Seminaive_+3A_covar.col">covar.col</code></td>
<td>

<p>(numeric) columns of data.frame that corresponds to the covariates in the spatial censored linear model estimation.
</p>
</td></tr>
<tr><td><code id="Seminaive_+3A_copred">copred</code></td>
<td>

<p>coordinates used in the prediction procedure.
</p>
</td></tr>
<tr><td><code id="Seminaive_+3A_cov.model">cov.model</code></td>
<td>

<p>covariance model in the structure of covariance (see <code>cov.spatial</code> from <code>geoR</code>).
</p>
</td></tr>
<tr><td><code id="Seminaive_+3A_thetaini">thetaini</code></td>
<td>

<p>initial values for the <code class="reqn">\sigma^2</code> and <code class="reqn">\phi</code> values in the covariance structure.
</p>
</td></tr>
<tr><td><code id="Seminaive_+3A_fix.nugget">fix.nugget</code></td>
<td>

<p>(logical) it indicates if the <code class="reqn">\tau^2</code> parameter must be fixed.
</p>
</td></tr>
<tr><td><code id="Seminaive_+3A_nugget">nugget</code></td>
<td>

<p>(numeric) values of the <code class="reqn">\tau^2</code> parameter, if <code>fix.nugget=F</code>, this value corresponds to an initial value.
</p>
</td></tr>
<tr><td><code id="Seminaive_+3A_kappa">kappa</code></td>
<td>

<p>value of <code class="reqn">\kappa</code> involved in some covariance functions.
</p>
</td></tr>
<tr><td><code id="Seminaive_+3A_cons">cons</code></td>
<td>

<p>(vector) vector containing the <code class="reqn">(c_1,c_2,c_3)</code> constants used in the convergence criterion for the algorithm (see Schedlin).
</p>
</td></tr>
<tr><td><code id="Seminaive_+3A_maxiter">MaxIter</code></td>
<td>

<p>maximum of iterations for the algorithm.
</p>
</td></tr>
<tr><td><code id="Seminaive_+3A_cc">cc</code></td>
<td>

<p>(binary vector) indicator of censure (1: censored, 0: observed)
</p>
</td></tr>
<tr><td><code id="Seminaive_+3A_cutoff">cutoff</code></td>
<td>

<p>(vector) limit of detection for censure ( rc: &gt;cutoff, lc: &lt;cutoff)
</p>
</td></tr>
<tr><td><code id="Seminaive_+3A_trend">trend</code></td>
<td>

<p>it specifies the mean part of the model. See documentation of <code>trend.spatial</code> from <code>geoR</code> for further details. By default <code>"cte"</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function estimates and computes predictions following Schedlin et al. (2014). See reference.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>zk</code></td>
<td>
<p>vector with observed and estimate censored observations by kriging prediction.</p>
</td></tr>
<tr><td><code>AIC</code></td>
<td>
<p>AIC of the estimated model.</p>
</td></tr>
<tr><td><code>BIC</code></td>
<td>
<p>BIC of the estimated model.</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>beta parameter for the mean structure.</p>
</td></tr>
<tr><td><code>theta</code></td>
<td>
<p>vector of estimate parameters for the mean and covariance structure (<code class="reqn">\beta,\sigma^2,\phi,\tau^2</code>).</p>
</td></tr>
<tr><td><code>predictions</code></td>
<td>
<p>Predictions obtained for the seminaive algorithm.</p>
</td></tr>
<tr><td><code>sdpred</code></td>
<td>
<p>Standard deviations of predictions.
</p>
</td></tr>
<tr><td><code>loglik</code></td>
<td>
<p>log likelihood from the estimated model.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Alejandro Ordonez &lt;&lt;ordonezjosealejandro@gmail.com&gt;&gt;, Victor H. Lachos &lt;&lt;hlachos@ime.unicamp.br&gt;&gt;
and Christian E. Galarza &lt;&lt;cgalarza88@gmail.com&gt;&gt;
</p>
<p>Maintainer: Alejandro Ordonez &lt;&lt;ordonezjosealejandro@gmail.com&gt;&gt;
</p>


<h3>References</h3>

<p>Schelin, L. &amp; Sjostedt-de Luna, S. (2014). Spatial prediction in the presence of left-censoring.
Computational Statistics and Data Analysis, 74.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+SAEMSCL">SAEMSCL</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>



n&lt;-200 ### sample size for estimation.
n1=100 ### number of observation used in the prediction.

###simulated coordinates.
r1=sample(seq(1,30,length=400),n+n1)
r2=sample(seq(1,30,length=400),n+n1)
coords=cbind(r1,r2)### total coordinates (used in estimation and prediction).
coords1=coords[1:n,]####coordinates used for estimation.

type="matern"### covariance structure.

xtot&lt;-cbind(1,runif((n+n1)),runif((n+n1),2,3))## X matrix for estimation and prediction.
xobs=xtot[1:n,]## X matrix for estimation.

###simulated data.
obj=rspacens(cov.pars=c(3,.3,0),beta=c(5,3,1),x=xtot,coords=coords,kappa=1.2,
cens=0.25,n=(n+n1),n1=n1,cov.model=type,cens.type="left")

data2=obj$datare
data2[,4:5]=xobs[,-1]

cc=obj$cc
y=obj$datare[,3]
cutoff=rep(obj$cutoff,length(y[cc==1]))

###seminaive algorithm
r=Seminaive(data=data2,y.col=3,covar=TRUE,coords.col=1:2,covar.col=4:5,cov.model="matern",
thetaini=c(.1,.2),fix.nugget=TRUE,nugget=0,kappa=1.5,cons=c(0.1,2,0.5),MaxIter=100,
cc=obj$cc,cutoff=cutoff,copred=obj$coords1,trend=~V4+V5)

summary(r)



</code></pre>

<hr>
<h2 id='summary.naive'>Summary of a naive object
</h2><span id='topic+summary.naive'></span>

<h3>Description</h3>

<p><code>summary</code> method for class &quot;naive&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'naive'
summary(object,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.naive_+3A_object">object</code></td>
<td>

<p>object of the class &quot;naive&quot; (see <code><a href="#topic+algnaive12">algnaive12</a></code> function).
</p>
</td></tr>
<tr><td><code id="summary.naive_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>mean.str1</code></td>
<td>

<p>Estimates for the mean structure parameters <code class="reqn">\mathbf{beta}</code> for Naive 1 method.
</p>
</td></tr>
<tr><td><code>var.str1</code></td>
<td>

<p>Estimates for the variance structure parameters <code class="reqn">\sigma^2, \phi</code> for Naive 1 method.
</p>
</td></tr>
<tr><td><code>mean.str2</code></td>
<td>

<p>Estimates for the mean structure parameters <code class="reqn">\mathbf{beta}</code> for Naive 2 method.
</p>
</td></tr>
<tr><td><code>var.str2</code></td>
<td>

<p>Estimates for the variance structure parameters <code class="reqn">\sigma^2, \phi</code> for Naive 2 method.
</p>
</td></tr>
<tr><td><code>predictions1</code></td>
<td>

<p>predictions for Naive 1 method.
</p>
</td></tr>
<tr><td><code>predictions2</code></td>
<td>

<p>predictions for Naive 1 method.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Alejandro Ordonez &lt;&lt;ordonezjosealejandro@gmail.com&gt;&gt;, Victor H. Lachos &lt;&lt;hlachos@ime.unicamp.br&gt;&gt;
and Christian E. Galarza &lt;&lt;cgalarza88@gmail.com&gt;&gt;
</p>
<p>Maintainer: Alejandro Ordonez &lt;&lt;ordonezjosealejandro@gmail.com&gt;&gt;
</p>


<h3>References</h3>

<p>Schelin, L. &amp; Sjostedt-de Luna, S. (2014). Spatial prediction in the presence of left-censoring. Computational Statistics and Data Analysis, 74.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+SAEMSCL">SAEMSCL</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n&lt;-200 ### sample size for estimation.
n1=100 ### number of observation used for prediction.

###simulated coordinates
n&lt;-200 ### sample size for estimation.
n1=100 ### number of observation used in the prediction.

###simulated coordinates
r1=sample(seq(1,30,length=400),n+n1)
r2=sample(seq(1,30,length=400),n+n1)
coords=cbind(r1,r2)### total coordinates (used in estimation and prediction).

coords1=coords[1:n,]####coordinates used for estimation.

type="matern"### covariance structure.

xtot&lt;-cbind(1,runif((n+n1)),runif((n+n1),2,3))## X matrix for estimation and prediction.
xobs=xtot[1:n,]## X matrix for estimation.

###simulated data
obj=rspacens(cov.pars=c(3,.3,0),beta=c(5,3,1),x=xtot,coords=coords,kappa=1.2,
cens=0.25,n=(n+n1),n1=n1,cov.model=type,cens.type="left")

data2=obj$datare
data2[,4:5]=xobs[,-1]

cc=obj$cc
y=obj$datare[,3]
cutoff=rep(obj$cutoff,length(y[cc==1]))


aux2=algnaive12(data=data2,cc=obj$cc,covar=TRUE,covar.col=4:5,
copred=obj$coords1,thetaini=c(.1,.2),y.col=3,coords.col=1:2,
fix.nugget=TRUE,nugget=0,kappa=1.2,cutoff=cutoff,trend=~V4+V5,
cov.model=type)

summary(aux2)
</code></pre>

<hr>
<h2 id='summary.SAEMSpatialCens'>Summary of a SAEMSpatialCens object.
</h2><span id='topic+summary.SAEMSpatialCens'></span>

<h3>Description</h3>

<p><code>summary</code> method for class &quot;SAEMSpatialCens&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'SAEMSpatialCens'
summary(object,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.SAEMSpatialCens_+3A_object">object</code></td>
<td>

<p>object of the class &quot;SAEMSpatialCens&quot; (see <code><a href="#topic+SAEMSCL">SAEMSCL</a></code> function).
</p>
</td></tr>
<tr><td><code id="summary.SAEMSpatialCens_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>mean.str</code></td>
<td>

<p>Estimates for the mean structure parameters <code class="reqn">\mathbf{beta}</code> for SAEMSCL method.
</p>
</td></tr>
<tr><td><code>var.str</code></td>
<td>

<p>Estimates for the variance structure parameters <code class="reqn">\sigma^2, \phi</code> for SAEMSCL method.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Alejandro Ordonez &lt;&lt;ordonezjosealejandro@gmail.com&gt;&gt;, Victor H. Lachos &lt;&lt;hlachos@ime.unicamp.br&gt;&gt;
and Christian E. Galarza &lt;&lt;cgalarza88@gmail.com&gt;&gt;
</p>
<p>Maintainer: Alejandro Ordonez &lt;&lt;ordonezjosealejandro@gmail.com&gt;&gt;
</p>


<h3>References</h3>

<p>DELYON, B., LAVIELLE, M.,ANDMOULI NES, E. (1999). Convergence of a stochastic approximation version of the EM algorithm.Annals of Statistic-s27, 1, 94-128.
</p>
<p>Diggle, P. &amp; Ribeiro, P. (2007). Model-Based Geostatistics. Springer Series in Statistics.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+SAEMSCL">SAEMSCL</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>



n&lt;-200 ### sample size for estimation.
n1=50 ### number of observation used in the prediction.

###simulated coordinates
r1=sample(seq(1,30,length=400),n+n1)
r2=sample(seq(1,30,length=400),n+n1)
coords=cbind(r1,r2)

coords1=coords[1:n,]

type="matern"
#xtot&lt;-cbind(1,runif((n+n1)),runif((n+n1),2,3))
xtot=as.matrix(rep(1,(n+n1)))
xobs=xtot[1:n,]
beta=5
#beta=c(5,3,1)

###simulated data
obj=rspacens(cov.pars=c(3,.3,0),beta=beta,x=xtot,coords=coords,kappa=1.2,
cens=0.25,n=(n+n1),n1=n1,cov.model=type,cens.type="left")

data2=obj$datare
cc=obj$cc
y=obj$datare[,3]
coords=obj$datare[,1:2]

est=SAEMSCL(cc,y,cens.type="left",trend="cte",coords=coords,
kappa=1.2,M=15,perc=0.25,MaxIter=10,pc=0.2,cov.model=type,
fix.nugget=TRUE,nugget=0,inits.sigmae=cov.ini[1],
inits.phi=cov.ini[2],search=TRUE,lower=0.00001,upper=100)

summary(est)




</code></pre>

<hr>
<h2 id='summary.seminaive'>Summary of a seminaive object
</h2><span id='topic+summary.seminaive'></span>

<h3>Description</h3>

<p><code>summary</code> method for class &quot;seminaive&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'seminaive'
summary(object,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.seminaive_+3A_object">object</code></td>
<td>

<p>object of the class &quot;seminaive&quot; (see <code><a href="#topic+Seminaive">Seminaive</a></code> function).
</p>
</td></tr>
<tr><td><code id="summary.seminaive_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>mean.str</code></td>
<td>

<p>Estimates for the mean structure parameters <code class="reqn">\mathbf{beta}</code> for seminaive method.
</p>
</td></tr>
<tr><td><code>var.str</code></td>
<td>

<p>Estimates for the variance structure parameters <code class="reqn">\sigma^2, \phi</code> for seminaive method.
</p>
</td></tr>
<tr><td><code>predictions</code></td>
<td>

<p>predictions for seminaive method.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Alejandro Ordonez &lt;&lt;ordonezjosealejandro@gmail.com&gt;&gt;, Victor H. Lachos &lt;&lt;hlachos@ime.unicamp.br&gt;&gt;
and Christian E. Galarza &lt;&lt;cgalarza88@gmail.com&gt;&gt;
</p>
<p>Maintainer: Alejandro Ordonez &lt;&lt;ordonezjosealejandro@gmail.com&gt;&gt;
</p>


<h3>References</h3>

<p>Schelin, L. &amp; Sjostedt-de Luna, S. (2014). Spatial prediction in the presence of left-censoring. Computational Statistics and Data Analysis, 74.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+SAEMSCL">SAEMSCL</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>



n&lt;-200 ### sample size for estimation.
n1=100 ### number of observation used in the prediction.

###simulated coordinates.
r1=sample(seq(1,30,length=400),n+n1)
r2=sample(seq(1,30,length=400),n+n1)
coords=cbind(r1,r2)### total coordinates (used in estimation and prediction).
coords1=coords[1:n,]####coordinates used for estimation.

type="matern"### covariance structure.

xtot&lt;-cbind(1,runif((n+n1)),runif((n+n1),2,3))## X matrix for estimation and prediction.
xobs=xtot[1:n,]## X matrix for estimation.

###simulated data.
obj=rspacens(cov.pars=c(3,.3,0),beta=c(5,3,1),x=xtot,coords=coords,kappa=1.2,
cens=0.25,n=(n+n1),n1=n1,cov.model=type,cens.type="left")

data2=obj$datare
data2[,4:5]=xobs[,-1]

cc=obj$cc
y=obj$datare[,3]
cutoff=rep(obj$cutoff,length(y[cc==1]))

###seminaive algorithm
r=Seminaive(data=data2,y.col=3,covar=TRUE,coords.col=1:2,covar.col=4:5,cov.model="matern",
thetaini=c(.1,.2),fix.nugget=TRUE,nugget=0,kappa=1.5,cons=c(0.1,2,0.5),MaxIter=100,
cc=obj$cc,cutoff=cutoff,copred=obj$coords1,trend=~V4+V5)

summary(r)




</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
