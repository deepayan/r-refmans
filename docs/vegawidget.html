<!DOCTYPE html><html><head><title>Help for package vegawidget</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {vegawidget}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#.vw_handler_body'><p>Constructor for internal S3 class</p></a></li>
<li><a href='#.vw_handler_def'><p>Constructor for internal S3 class</p></a></li>
<li><a href='#%&gt;%'><p>Pipe operator</p></a></li>
<li><a href='#add-listeners'><p>Add JavaScript listeners</p></a></li>
<li><a href='#as_vegaspec'><p>Coerce to vegaspec</p></a></li>
<li><a href='#data_category'><p>Example dataset: Categorical data</p></a></li>
<li><a href='#data_seattle_daily'><p>Example dataset: Seattle daily weather</p></a></li>
<li><a href='#data_seattle_hourly'><p>Example dataset: Seattle hourly temperatures</p></a></li>
<li><a href='#glue_js'><p>Interpolate into a JavaScript string</p></a></li>
<li><a href='#image'><p>Create or write image</p></a></li>
<li><a href='#JS'><p>Mark character strings as literal JavaScript code</p></a></li>
<li><a href='#knit_print.vegaspec'><p>Knit-print method</p></a></li>
<li><a href='#renderVegawidget'><p>Render shiny-output for vegawidget</p></a></li>
<li><a href='#s3_register'><p>Register an s3 method</p></a></li>
<li><a href='#shiny-getters'><p>Get information from a Vega chart into Shiny</p></a></li>
<li><a href='#shiny-setters'><p>Set information in a Vega chart from Shiny</p></a></li>
<li><a href='#spec_mtcars'><p>Example vegaspec: mtcars scatterplot</p></a></li>
<li><a href='#use_vegawidget'><p>Add vegawidget functions to your package</p></a></li>
<li><a href='#vega_embed'><p>Vega embed options</p></a></li>
<li><a href='#vega_schema'><p>Create string for schema-URL</p></a></li>
<li><a href='#vega_version'><p>Get Vega JavaScript versions</p></a></li>
<li><a href='#vegawidget'><p>Create a Vega/Vega-Lite htmlwidget</p></a></li>
<li><a href='#vegawidgetOutput'><p>Shiny-output for vegawidget</p></a></li>
<li><a href='#vw_as_json'><p>Coerce vegaspec to JSON</p></a></li>
<li><a href='#vw_autosize'><p>Autosize vegaspec</p></a></li>
<li><a href='#vw_examine'><p>Examine vegaspec</p></a></li>
<li><a href='#vw_fetch'><p>Callback helpers</p></a></li>
<li><a href='#vw_handler'><p>Construct a vegawidget handler</p></a></li>
<li><a href='#vw_handler_add_effect'><p>Add a side-effect to a JavaScript handler</p></a></li>
<li><a href='#vw_handler_body_compose'><p>Compose a JavaScript handler</p></a></li>
<li><a href='#vw_handler_signal'><p>Construct a JavaScript handler</p></a></li>
<li><a href='#vw_rename_datasets'><p>Rename datasets in a vegaspec</p></a></li>
<li><a href='#vw_serialize_data'><p>Serialize data-frame time-columns</p></a></li>
<li><a href='#vw_set_base_url'><p>Set base URL</p></a></li>
<li><a href='#vw_shiny_demo'><p>Run Shiny demonstration-apps</p></a></li>
<li><a href='#vw_spec_version'><p>Determine vegaspec version</p></a></li>
<li><a href='#vw_to_vega'><p>Convert to Vega specification</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>0.5.0</td>
</tr>
<tr>
<td>Title:</td>
<td>'Htmlwidget' for 'Vega' and 'Vega-Lite'</td>
</tr>
<tr>
<td>Description:</td>
<td>'Vega' and 'Vega-Lite' parse text in 'JSON' notation to render 
  chart-specifications into 'HTML'. This package is used to facilitate the 
  rendering. It also provides a means to interact with signals, events,
  and datasets in a 'Vega' chart using 'JavaScript' or 'Shiny'.</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>To use image functions for MacOS: X11</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>ByteCompile:</td>
<td>true</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://vegawidget.github.io/vegawidget/">https://vegawidget.github.io/vegawidget/</a>,
<a href="https://github.com/vegawidget/vegawidget">https://github.com/vegawidget/vegawidget</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/vegawidget/vegawidget/issues">https://github.com/vegawidget/vegawidget/issues</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.0</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Imports:</td>
<td>jsonlite, htmlwidgets, assertthat, rlang, glue, magrittr,
htmltools, digest, utils</td>
</tr>
<tr>
<td>Suggests:</td>
<td>spelling, knitr, rmarkdown, listviewer, testthat (&ge; 3.0.0),
yaml, fs, usethis (&ge; 1.5.0), readr, tibble, lubridate, V8 (&ge;
4.0), withr, learnr, rsvg, dplyr, png, conflicted, here, shiny,
purrr, rsconnect</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-01-13 16:41:39 UTC; ijlyttle</td>
</tr>
<tr>
<td>Author:</td>
<td>Ian Lyttle <a href="https://orcid.org/0000-0001-9962-4849"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre],
  Vega/Vega-Lite Developers [aut],
  Alicia Schep <a href="https://orcid.org/0000-0002-3915-0618"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb],
  Stuart Lee [ctb],
  Kanit Wongsuphasawat [ctb] (Vega/Vega-Lite library),
  Dominik Moritz [ctb] (Vega/Vega-Lite library),
  Arvind Satyanarayan [ctb] (Vega/Vega-Lite library),
  Jeffrey Heer [ctb] (Vega/Vega-Lite library),
  Mike Bostock [ctb] (D3 library)</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Ian Lyttle &lt;ijlyttle@me.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-01-13 17:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='.vw_handler_body'>Constructor for internal S3 class</h2><span id='topic+.vw_handler_body'></span>

<h3>Description</h3>

<p>This S3 class is used to define handler-function bodies.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.vw_handler_body(text, params = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".vw_handler_body_+3A_text">text</code></td>
<td>
<p><code>character</code>, text of the function body</p>
</td></tr>
<tr><td><code id=".vw_handler_body_+3A_params">params</code></td>
<td>
<p><code>character</code>, vector of names of required parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>S3 object with class <code>.vw_handler_body</code>
</p>


<h3>See Also</h3>

<p>.vw_handler_def
</p>

<hr>
<h2 id='.vw_handler_def'>Constructor for internal S3 class</h2><span id='topic+.vw_handler_def'></span>

<h3>Description</h3>

<p>This S3 class is used to define handler-functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.vw_handler_def(args, bodies)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".vw_handler_def_+3A_args">args</code></td>
<td>
<p><code>character</code>, vector of names of arguments for the
handler-function</p>
</td></tr>
<tr><td><code id=".vw_handler_def_+3A_bodies">bodies</code></td>
<td>
<p><code>.vw_handler_body</code>, list of possible bodies for the
handler-function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>S3 object with class <code>.vw_handler_def</code>
</p>


<h3>See Also</h3>

<p>.vw_handler_body
</p>

<hr>
<h2 id='+25+26gt+3B+25'>Pipe operator</h2><span id='topic++25+3E+25'></span>

<h3>Description</h3>

<p>See <code>magrittr::<a href="magrittr.html#topic+pipe">pipe</a></code> for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lhs %&gt;% rhs
</code></pre>

<hr>
<h2 id='add-listeners'>Add JavaScript listeners</h2><span id='topic+add-listeners'></span><span id='topic+vw_add_signal_listener'></span><span id='topic+vw_add_data_listener'></span><span id='topic+vw_add_event_listener'></span>

<h3>Description</h3>

<p>Listeners are how we get information out of a Vega chart and into the
JavaScript environment. To do this, we specify handler-functions to
run whenever a certain signal changes or an event fires.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vw_add_signal_listener(x, name, handler_body)

vw_add_data_listener(x, name, handler_body)

vw_add_event_listener(x, event, handler_body)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add-listeners_+3A_x">x</code></td>
<td>
<p>vegawidget object to be monitored</p>
</td></tr>
<tr><td><code id="add-listeners_+3A_name">name</code></td>
<td>
<p><code>character</code>, name of the signal or dataset to be monitored</p>
</td></tr>
<tr><td><code id="add-listeners_+3A_handler_body">handler_body</code></td>
<td>
<p><code>character</code> or <code>JS_EVAL</code>, text of the body of
the JavaScript handler-function to be called when the signal or dataset
changes, or the event fires</p>
</td></tr>
<tr><td><code id="add-listeners_+3A_event">event</code></td>
<td>
<p><code>character</code>, name of the type of event to be monitored,
e.g. <code>"click"</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>handler_body</code> can be the text of the <em>body</em> of a JavaScript function;
the arguments to this function will vary according to the type of listener
you are adding:
</p>

<ul>
<li><p> signal-handler and data-handler arguments: <code>name</code>, <code>value</code>
</p>
</li>
<li><p> event-handler arguments: <code>event</code>, <code>item</code>
</p>
</li></ul>

<p>This package offers some functions to make it easier to build JavaScript
handler functions from R: <code><a href="#topic+vw_handler_signal">vw_handler_signal()</a></code>, <code><a href="#topic+vw_handler_data">vw_handler_data()</a></code>,
and <code><a href="#topic+vw_handler_event">vw_handler_event()</a></code>. You can pipe one of these functions to
<code><a href="#topic+vw_handler_add_effect">vw_handler_add_effect()</a></code> to perform side-effects on the result.
</p>


<h3>Value</h3>

<p>modified copy of vegawidget object <code>x</code>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+vw_handler_signal">vw_handler_signal()</a></code>, <code><a href="#topic+vw_handler_data">vw_handler_data()</a></code>, <code><a href="#topic+vw_handler_event">vw_handler_event()</a></code>,
<code><a href="#topic+vw_handler_add_effect">vw_handler_add_effect()</a></code>,
<a href="https://vega.github.io/vega/docs/api/view/">vega-view</a>
</p>

<hr>
<h2 id='as_vegaspec'>Coerce to vegaspec</h2><span id='topic+as_vegaspec'></span><span id='topic+as_vegaspec.default'></span><span id='topic+as_vegaspec.vegaspec'></span><span id='topic+as_vegaspec.list'></span><span id='topic+as_vegaspec.json'></span><span id='topic+as_vegaspec.character'></span><span id='topic+as_vegaspec.vegawidget'></span>

<h3>Description</h3>

<p>Vega and Vega-Lite use JSON as their specification-format. Within R,
it seems natural to work with these specifications as lists. Accordingly,
a <code>vegaspec</code> is also a list. This family of functions is used to coerce lists,
JSON, and character strings to <code>vegaspec</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as_vegaspec(spec, ...)

## Default S3 method:
as_vegaspec(spec, ...)

## S3 method for class 'vegaspec'
as_vegaspec(spec, ...)

## S3 method for class 'list'
as_vegaspec(spec, ...)

## S3 method for class 'json'
as_vegaspec(spec, ...)

## S3 method for class 'character'
as_vegaspec(spec, encoding = "UTF-8", ...)

## S3 method for class 'vegawidget'
as_vegaspec(spec, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as_vegaspec_+3A_spec">spec</code></td>
<td>
<p>An object to be coerced to <code>vegaspec</code>, a Vega/Vega-Lite specification</p>
</td></tr>
<tr><td><code id="as_vegaspec_+3A_...">...</code></td>
<td>
<p>Other arguments (attempt to future-proof)</p>
</td></tr>
<tr><td><code id="as_vegaspec_+3A_encoding">encoding</code></td>
<td>
<p><code>character</code>, if spec is a file or a URL, specifies the encoding.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>character</code> method for this function will take:
</p>

<ul>
<li><p>JSON string.
</p>
</li>
<li><p>A path to a local JSON file.
</p>
</li>
<li><p>A URL that returns a JSON file.
</p>
</li></ul>

<p>For Vega and Vega-Lite, the translation between lists and JSON is a little
bit particular. This function, <code><a href="#topic+as_vegaspec">as_vegaspec()</a></code>, can be used to translate
from JSON; <code><a href="#topic+vw_as_json">vw_as_json()</a></code> can be used to translate to JSON.
</p>
<p>You can use the function <code><a href="#topic+vw_spec_version">vw_spec_version()</a></code> to determine if a <code>vegaspec</code> is built for
Vega-Lite or Vega. You can use <code><a href="#topic+vw_to_vega">vw_to_vega()</a></code> to translate a Vega-Lite spec to Vega.
</p>


<h3>Value</h3>

<p>An object with S3 class <code>vegaspec</code>
</p>


<h3>See Also</h3>

<p><a href="https://vega.github.io/vega/">Vega</a>,
<a href="https://vega.github.io/vega-lite/">Vega-Lite</a>,
<code><a href="#topic+vw_as_json">vw_as_json()</a></code>, <code><a href="#topic+vw_spec_version">vw_spec_version()</a></code>, <code><a href="#topic+vw_to_vega">vw_to_vega()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  spec &lt;- list(
    `$schema` = vega_schema(),
    data = list(values = mtcars),
    mark = "point",
    encoding = list(
      x = list(field = "wt", type = "quantitative"),
      y = list(field = "mpg", type = "quantitative"),
      color = list(field = "cyl", type = "nominal")
    )
  )

  as_vegaspec(spec)

  ## Not run: 
    # requires network-access
    as_vegaspec("https://vega.github.io/vega-lite/examples/specs/bar.vl.json")
  
## End(Not run)
</code></pre>

<hr>
<h2 id='data_category'>Example dataset: Categorical data</h2><span id='topic+data_category'></span>

<h3>Description</h3>

<p>This is a toy dataset; the numbers are generated randomly.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data_category
</code></pre>


<h3>Format</h3>

<p>A data frame with ten observations of two variables
</p>

<dl>
<dt>category</dt><dd><p><code>character</code>, representative of a nominal variable</p>
</dd>
<dt>number</dt><dd><p><code>double</code>, representative of a quantitative variable</p>
</dd>
</dl>


<hr>
<h2 id='data_seattle_daily'>Example dataset: Seattle daily weather</h2><span id='topic+data_seattle_daily'></span>

<h3>Description</h3>

<p>This dataset contains daily weather-observations from Seattle for the
years 2012-2015, inclusive.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data_seattle_daily
</code></pre>


<h3>Format</h3>

<p>A data frame with 1461 observations of six variables
</p>

<dl>
<dt>date</dt><dd><p><code>Date</code>, date of the observation</p>
</dd>
<dt>precipitation</dt><dd><p><code>double</code>, amount of precipitation (mm)</p>
</dd>
<dt>temp_max</dt><dd><p><code>double</code>, maximum temperature (°C)</p>
</dd>
<dt>temp_min</dt><dd><p><code>double</code>, minimum temperature (°C)</p>
</dd>
<dt>wind</dt><dd><p><code>double</code>, average wind-speed (m/s)</p>
</dd>
<dt>weather</dt><dd><p><code>character</code>, description of weather</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="https://vega.github.io/vega-datasets/data/seattle-weather.csv">https://vega.github.io/vega-datasets/data/seattle-weather.csv</a>
</p>

<hr>
<h2 id='data_seattle_hourly'>Example dataset: Seattle hourly temperatures</h2><span id='topic+data_seattle_hourly'></span>

<h3>Description</h3>

<p>This dataset contains hourly temperature observations from Seattle for the
year 2010.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data_seattle_hourly
</code></pre>


<h3>Format</h3>

<p>A data frame with 8759 observations of two variables
</p>

<dl>
<dt>date</dt><dd><p><code>POSIXct</code>, instant of the observation, uses <code>"America/Los_Angeles"</code></p>
</dd>
<dt>temp</dt><dd><p><code>double</code>, temperature (°C)</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="https://vega.github.io/vega-datasets/data/seattle-weather-hourly-normals.csv">https://vega.github.io/vega-datasets/data/seattle-weather-hourly-normals.csv</a>
</p>

<hr>
<h2 id='glue_js'>Interpolate into a JavaScript string</h2><span id='topic+glue_js'></span>

<h3>Description</h3>

<p>Uses JavaScript notation to interpolate R variables into a string
intended to be interpreted as JS.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>glue_js(..., .open = "${", .envir = parent.frame())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="glue_js_+3A_...">...</code></td>
<td>
<p>character vectors as the JavaScript source code (all arguments
will be pasted into one character string)</p>
</td></tr>
<tr><td><code id="glue_js_+3A_.open">.open</code></td>
<td>
<p><code>character</code>, opening delimiter used by <code><a href="glue.html#topic+glue">glue::glue()</a></code></p>
</td></tr>
<tr><td><code id="glue_js_+3A_.envir">.envir</code></td>
<td>
<p><code>environment</code>, tells <code><a href="glue.html#topic+glue">glue::glue()</a></code> where to find
the variables to be interpolated</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a wrapper to <code><a href="glue.html#topic+glue">glue::glue()</a></code>, but it uses the notation used by
<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Template_literals">JavaScript's template-literals</a>,
<code style="white-space: pre;">&#8288;${}&#8288;</code>.
</p>


<h3>Value</h3>

<p><code>glue::glue()</code> object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  x &lt;- 123
  glue_js("function(){return(${x});}") %&gt;% print()
</code></pre>

<hr>
<h2 id='image'>Create or write image</h2><span id='topic+image'></span><span id='topic+vw_to_svg'></span><span id='topic+vw_to_bitmap'></span><span id='topic+vw_write_svg'></span><span id='topic+vw_write_png'></span>

<h3>Description</h3>

<p>If you have <strong><a href="https://CRAN.R-project.org/package=V8">V8</a></strong>,
<strong><a href="https://withr.r-lib.org/">withr</a></strong>,  and <strong><a href="https://fs.r-lib.org/">fs</a></strong>
installed, you can use these functions can to create
or write images as PNG or SVG, using a <code>vegaspec</code> or <code>vegawidget</code>.
To convert to a bitmap, or write a PNG file, you will additionally need
the <strong><a href="https://CRAN.R-project.org/package=rsvg">rsvg</a></strong> and
<strong><a href="https://CRAN.R-project.org/package=png">png</a></strong> packages.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vw_to_svg(spec, width = NULL, height = NULL, base_url = NULL, seed = NULL)

vw_to_bitmap(spec, scale = 1, width = NULL, height = NULL, ...)

vw_write_svg(spec, path, width = NULL, height = NULL, ...)

vw_write_png(spec, path, scale = 1, width = NULL, height = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="image_+3A_spec">spec</code></td>
<td>
<p>An object to be coerced to <code>vegaspec</code>, a Vega/Vega-Lite specification</p>
</td></tr>
<tr><td><code id="image_+3A_width">width</code></td>
<td>
<p><code>integer</code>, if specified, the total rendered width (in pixels)
of the chart - valid only for single-view charts and layered charts;
the default is to use the width in the chart specification</p>
</td></tr>
<tr><td><code id="image_+3A_height">height</code></td>
<td>
<p><code>integer</code>, if specified, the total rendered height (in pixels)
of the chart - valid only for single-view charts and layered charts;
the default is to use the height in the chart specification</p>
</td></tr>
<tr><td><code id="image_+3A_base_url">base_url</code></td>
<td>
<p><code>character</code>, the base URL for a data file, useful for
specifying a local directory; defaults to an empty string</p>
</td></tr>
<tr><td><code id="image_+3A_seed">seed</code></td>
<td>
<p><code>integer</code>, the random seed for a Vega specification,
defaults to a &quot;random&quot; integer</p>
</td></tr>
<tr><td><code id="image_+3A_scale">scale</code></td>
<td>
<p><code>numeric</code>, useful for specifying larger images supporting the
increased-resolution of retina displays</p>
</td></tr>
<tr><td><code id="image_+3A_...">...</code></td>
<td>
<p>additional arguments passed to <code>vw_to_svg()</code></p>
</td></tr>
<tr><td><code id="image_+3A_path">path</code></td>
<td>
<p><code>character</code>, local path to which to write the file</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions can be called using (an object that can be coerced to)
a <code>vegaspec</code>.
</p>
<p>The scripts used are adapted from the Vega
<a href="https://vega.github.io/vega/usage/#cli">command line utilities</a>.
</p>


<h3>Value</h3>


<dl>
<dt><code>vw_to_svg()</code></dt><dd><p><code>character</code>, SVG string</p>
</dd>
<dt><code>vw_to_bitmap()</code></dt><dd><p><code>array</code>, bitmap array</p>
</dd>
<dt><code>vw_write_svg()</code></dt><dd><p>invisible <code>vegaspec</code> or <code>vegawidget</code>, called for side-effects</p>
</dd>
<dt><code>vw_write_png()</code></dt><dd><p>invisible <code>vegaspec</code> or <code>vegawidget</code>, called for side-effects</p>
</dd>
</dl>



<h3>See Also</h3>

<p><a href="https://github.com/vega/vega-view#image-export">vega-view library</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  # call any of these functions using either a vegaspec or a vegawidget
  svg &lt;- vw_to_svg(vegawidget(spec_mtcars))
  bmp &lt;- vw_to_bitmap(spec_mtcars)
  vw_write_png(spec_mtcars, file.path(tempdir(), "temp.png"))
  vw_write_svg(spec_mtcars, file.path(tempdir(), "temp.svg"))

  # To specify the path to a local file, use base_url
  spec_precip &lt;-
    list(
      `$schema` = vega_schema(),
      data = list(url = "seattle-weather.csv"),
      mark = "tick",
      encoding = list(
        x = list(field = "precipitation", type = "quantitative")
      )
    ) %&gt;%
    as_vegaspec()

  data_dir &lt;- system.file("example-data/", package = "vegawidget")
  vw_write_png(
    spec_precip,
    file.path(tempdir(), "temp-local.png"),
    base_url = data_dir
  )

</code></pre>

<hr>
<h2 id='JS'>Mark character strings as literal JavaScript code</h2><span id='topic+JS'></span>

<h3>Description</h3>

<p>See <code>htmlwidgets::<a href="htmlwidgets.html#topic+JS">JS</a></code> for details.
</p>

<hr>
<h2 id='knit_print.vegaspec'>Knit-print method</h2><span id='topic+knit_print.vegaspec'></span>

<h3>Description</h3>

<p>If you are knitting to an HTML-based format, the only supported options are
<code>vega.width</code>, <code>vega.height</code> (as pixels) and <code>vega.embed</code> (as a list).
If you are knitting to a non-HTML-based format, you additionally
have the options <code>dev</code>, <code>out.width</code> and <code>out.height</code> available.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>knit_print.vegaspec(spec, ..., options = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="knit_print.vegaspec_+3A_spec">spec</code></td>
<td>
<p>An object to be coerced to <code>vegaspec</code>, a Vega/Vega-Lite specification</p>
</td></tr>
<tr><td><code id="knit_print.vegaspec_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
<tr><td><code id="knit_print.vegaspec_+3A_options">options</code></td>
<td>
<p><code>list</code>, knitr options</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The biggest thing to keep in mind about a Vega visualization is that
very often, the chart tells you how much space it needs, rather
than than you tell it how much space it has available. In the future, it
may reveal itself how to manage better this &quot;conversation&quot;.
</p>


<h3>HTML-based</h3>

<p>When knitting to an HTML-based format, the <code>spec</code> is rendered as normal,
it calls <code><a href="#topic+vegawidget">vegawidget()</a></code> using the options <code>vega.width</code>, <code>vega.height</code>
and <code>vega.embed</code>:
</p>

<ul>
<li> <p><code>vega.width</code> and <code>vega.height</code> are passed to <code><a href="#topic+vegawidget">vegawidget()</a></code>
as <code>width</code> and <code>height</code>, respectively. These values are coerced to numeric,
so it is ineffective to specify a percentage. They are passed to
<code><a href="#topic+vw_autosize">vw_autosize()</a></code> to resize the chart, if
<a href="https://vega.github.io/vega-lite/docs/size.html#limitations">possible</a>.
</p>
</li>
<li> <p><code>vega.embed</code> is passed to <code><a href="#topic+vegawidget">vegawidget()</a></code> as <code>embed</code>. The function
<code><a href="#topic+vega_embed">vega_embed()</a></code> can be useful to set <code>vega.embed</code>.
</p>
</li></ul>



<h3>Non-HTML-based</h3>

<p>When knitting to an non-HTML-based format, e.g. <code>github_document</code> or
<code>pdf_document</code>, this function will convert the chart to an image, then knitr
will incorporate the image into your document. You have the additional
knitr options <code>dev</code>, <code>out.width</code>, and <code>out.height</code>:
</p>

<ul>
<li><p> The supported values of <code>dev</code> are <code>"png"</code>, <code>"svg"</code>, and <code>"pdf"</code>. If you
are knitting to a LaTeX format (e.g. <code>pdf_document</code>) and you specify <code>dev</code>
as <code>"svg"</code>, it will be implemented as <code>"pdf"</code>.
</p>
</li>
<li><p> To scale the image within your document, you can use  <code>out.width</code> or
<code>out.height</code>. Because the image will already have an aspect ratio,
it is recommended to specify no more than one of these.
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+vw_autosize">vw_autosize()</a></code>, <code><a href="#topic+vega_embed">vega_embed()</a></code>
</p>

<hr>
<h2 id='renderVegawidget'>Render shiny-output for vegawidget</h2><span id='topic+renderVegawidget'></span>

<h3>Description</h3>

<p>Use this function in the server part of your Shiny app.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>renderVegawidget(expr, env = parent.frame(), quoted = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="renderVegawidget_+3A_expr">expr</code></td>
<td>
<p>expression that generates a vegawidget. This can be
a <code>vegawidget</code> or a <code>vegaspec</code>.</p>
</td></tr>
<tr><td><code id="renderVegawidget_+3A_env">env</code></td>
<td>
<p>The environment in which to evaluate <code>expr</code>.</p>
</td></tr>
<tr><td><code id="renderVegawidget_+3A_quoted">quoted</code></td>
<td>
<p>Is <code>expr</code> a quoted expression (with <code>quote()</code>)? This
is useful if you want to save an expression in a variable.</p>
</td></tr>
</table>

<hr>
<h2 id='s3_register'>Register an s3 method</h2><span id='topic+s3_register'></span>

<h3>Description</h3>

<p>This is a reimplementation of <code>vctrs::s3_register()</code>, implemented here
to avoid having to take a dependency on vctrs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>s3_register(generic, class, method = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="s3_register_+3A_generic">generic</code></td>
<td>
<p>Name of the generic in the form <code>pkg::generic</code>.</p>
</td></tr>
<tr><td><code id="s3_register_+3A_class">class</code></td>
<td>
<p>Name of the class</p>
</td></tr>
<tr><td><code id="s3_register_+3A_method">method</code></td>
<td>
<p>Optionally, the implementation of the method. By default,
this will be found by looking for a function called <code>generic.class</code>
in the package environment.
</p>
<p>Note that providing <code>method</code> can be dangerous if you use
devtools. When the namespace of the method is reloaded by
<code>devtools::load_all()</code>, the function will keep inheriting from
the old namespace. This might cause crashes because of dangling
<code>.Call()</code> pointers.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Invisible <code>NULL</code>, called for side effects.
</p>

<hr>
<h2 id='shiny-getters'>Get information from a Vega chart into Shiny</h2><span id='topic+shiny-getters'></span><span id='topic+vw_shiny_get_signal'></span><span id='topic+vw_shiny_get_data'></span><span id='topic+vw_shiny_get_event'></span>

<h3>Description</h3>

<p>There are three types of information you can get from a Vega chart,
a <em>signal</em>, <em>data</em> (i.e. a dataset), and information associated with
an <em>event</em>.  A dataset or a signal must first be defined and <strong>named</strong>
in the vegaspec.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vw_shiny_get_signal(outputId, name, body_value = "value")

vw_shiny_get_data(outputId, name, body_value = "value")

vw_shiny_get_event(outputId, event, body_value = "datum")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="shiny-getters_+3A_outputid">outputId</code></td>
<td>
<p><code>character</code>, shiny <code>outputId</code> for the vegawidget</p>
</td></tr>
<tr><td><code id="shiny-getters_+3A_name">name</code></td>
<td>
<p><code>character</code>, name of the signal (defined in Vega specification)
being monitored</p>
</td></tr>
<tr><td><code id="shiny-getters_+3A_body_value">body_value</code></td>
<td>
<p><code>character</code> or <code>JS_EVAL</code>, the <strong>body</strong> of a JavaScript
function that Vega will use to handle the signal or event; this function
must return a value</p>
</td></tr>
<tr><td><code id="shiny-getters_+3A_event">event</code></td>
<td>
<p><code>character</code>, type of the event being monitored, e.g. <code>"click"</code>,
for list of supported events, please see
<a href="https://vega.github.io/vega/docs/event-streams/">Vega Event-Stream reference</a></p>
</td></tr>
</table>


<h3>Details</h3>

<p>These getter-functions are called from within
a Shiny <code>server()</code> function, where they act like
<code><a href="shiny.html#topic+reactive">shiny::reactive()</a></code>, returning a reactive expression.
</p>
<p>To see these functions in action, you can run a shiny-demo:
</p>

<ul>
<li> <p><code>vw_shiny_get_signal()</code>: call <code>vw_shiny_demo("signal-set-get")</code>
</p>
</li>
<li> <p><code>vw_shiny_get_data()</code>: call <code>vw_shiny_demo("data-set-get")</code>
</p>
</li>
<li> <p><code>vw_shiny_get_event()</code>: call <code>vw_shiny_demo("event-get")</code>
</p>
</li></ul>

<p>In addition to the chart <code>outputId</code>, you will need to provide:
</p>

<ul>
<li> <p><code>vw_shiny_get_signal()</code>: the <code>name</code> of the signal, as defined in the Vega
specification
</p>
</li>
<li> <p><code>vw_shiny_get_data()</code>: the <code>name</code> of the dataset, as defined in the Vega
specification
</p>
</li>
<li> <p><code>vw_shiny_get_event()</code>: the <code>event</code> type, as defined in the
<a href="https://vega.github.io/vega/docs/event-streams/">Vega Event-Stream reference</a>
</p>
</li></ul>

<p>When the signal or data changes, or when the event fires, Vega needs to
know which information you want returned to Shiny. To do this,
you provide a JavaScript handler-function:
</p>

<ul>
<li> <p><code>vw_shiny_get_signal()</code>: the default handler,
<code>vw_handler_signal("value")</code>,
specifies that the value of the signal be returned.
</p>
</li>
<li> <p><code>vw_shiny_get_data()</code>: the default handler,
<code>vw_handler_data("value")</code>,
specifies that the entire dataset be returned.
</p>
</li>
<li> <p><code>vw_shiny_get_event()</code>: the default handler,
<code>vw_handler_event("datum")</code>,
specifies that the single row of data associated with graphical mark
be returned. For example, if you are monitoring a <code>"click"</code> event,
Vega would return the row of data that backs any mark
(like a point) that you click.
</p>
</li></ul>

<p>If you need to specify a different behavior for the handler, there are a
couple of options. This package provides
a library of handler-functions; call <code><a href="#topic+vw_handler_signal">vw_handler_signal()</a></code>,
<code><a href="#topic+vw_handler_data">vw_handler_data()</a></code>, or <code><a href="#topic+vw_handler_event">vw_handler_event()</a></code> without arguments to
list the available handlers.
</p>
<p>If the library does not contain the handler you need, the <code>body_value</code>
argument will also accept a character string which will be used as
the <strong>body</strong> of the handler function.
</p>
<p>For example, these calls are equivalent:
</p>

<ul>
<li> <p><code>vw_shiny_get_signal(..., body_value = "value")</code>
</p>
</li>
<li> <p><code>vw_shiny_get_signal(..., body_value = vw_handler_signal("value"))</code>
</p>
</li>
<li> <p><code>vw_shiny_get_signal(..., body_value = "return value;")</code>
</p>
</li></ul>

<p>If you use a custom-handler that you think may be useful for the
handler-function library, please
<a href="https://github.com/vegawidget/vegawidget/issues">file an issue</a>.
</p>


<h3>Value</h3>

<p><code><a href="shiny.html#topic+reactive">shiny::reactive()</a></code> function that returns the value returned by
<code>body_value</code>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+vw_handler_signal">vw_handler_signal()</a></code>, <code><a href="#topic+vw_handler_event">vw_handler_event()</a></code>,
vega-view:
<a href="https://github.com/vega/vega/tree/master/packages/vega-view#view_addSignalListener">addSignalListener()</a>,
<a href="https://github.com/vega/vega/tree/master/packages/vega-view#view_addEventListener">addEventListener()</a>
</p>

<hr>
<h2 id='shiny-setters'>Set information in a Vega chart from Shiny</h2><span id='topic+shiny-setters'></span><span id='topic+vw_shiny_set_signal'></span><span id='topic+vw_shiny_set_data'></span><span id='topic+vw_shiny_run'></span>

<h3>Description</h3>

<p>There are two ways to change a Vega chart: by setting
a <em>signal</em> or by setting a <em>dataset</em>; you can also
direct a Vega chart to re-run itself. Any signal or
dataset you set must first be defined and <strong>named</strong> in the vegaspec.
These functions are called from within
a Shiny <code>server()</code> function, where they act like
<code><a href="shiny.html#topic+observe">shiny::observe()</a></code> or <code><a href="shiny.html#topic+observeEvent">shiny::observeEvent()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vw_shiny_set_signal(outputId, name, value, run = TRUE, ...)

vw_shiny_set_data(outputId, name, value, run = TRUE, ...)

vw_shiny_run(outputId, value, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="shiny-setters_+3A_outputid">outputId</code></td>
<td>
<p><code>character</code>, shiny <code>outputId</code> for the vegawidget</p>
</td></tr>
<tr><td><code id="shiny-setters_+3A_name">name</code></td>
<td>
<p><code>character</code>, name of the signal or dataset being set,
as defined in the vegaspec</p>
</td></tr>
<tr><td><code id="shiny-setters_+3A_value">value</code></td>
<td>
<p>reactive expression, e.g. <code>input$slider</code> or <code>dataset()</code>,
that returns the value to which to set the signal or dataset</p>
</td></tr>
<tr><td><code id="shiny-setters_+3A_run">run</code></td>
<td>
<p><code>logical</code> indicates if the chart is to be run immediately</p>
</td></tr>
<tr><td><code id="shiny-setters_+3A_...">...</code></td>
<td>
<p>other arguments passed on to <code><a href="shiny.html#topic+observeEvent">shiny::observeEvent()</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>To see these functions in action, you can run a shiny-demo:
</p>

<ul>
<li> <p><code>vw_shiny_set_signal()</code>: call <code>vw_shiny_demo("signal-set-get")</code>
</p>
</li>
<li> <p><code>vw_shiny_set_data()</code>: call <code>vw_shiny_demo("data-set-get")</code>
</p>
</li>
<li> <p><code>vw_shiny_run()</code>: call <code>vw_shiny_demo("data-set-swap-run")</code>
</p>
</li></ul>

<p>For the signal and data setters, in addition to the chart <code>outputId</code>,
you will need to provide:
</p>

<ul>
<li><p> the <code>name</code> of the signal or dataset you wish to keep updated
</p>
</li>
<li><p> the <code>value</code> to which you want to set the signal or dataset;
this should be a reactive expression like <code>input$slider</code> or <code>rct_dataset()</code>
</p>
</li>
<li><p> whether or not you want to <code>run</code> the Vega view again immediately
after setting this value
</p>
</li></ul>

<p>If you do not set <code>run = TRUE</code> in the setter-function,
you can use the <code>vw_shiny_run()</code> function to control when
the chart re-runs. One possibility is to set its <code>value</code> to a reactive
expression that refers to, for example, a <code><a href="shiny.html#topic+actionButton">shiny::actionButton()</a></code>.
</p>


<h3>Value</h3>

<p><code><a href="shiny.html#topic+observeEvent">shiny::observeEvent()</a></code> function that responds to changes in the
reactive-expression <code>value</code>
</p>

<hr>
<h2 id='spec_mtcars'>Example vegaspec: mtcars scatterplot</h2><span id='topic+spec_mtcars'></span>

<h3>Description</h3>

<p>A Vega-Lite specification to create a scatterplot for <code>mtcars</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spec_mtcars
</code></pre>


<h3>Format</h3>

<p>S3 object of class <code>vegaspec</code>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+as_vegaspec">as_vegaspec()</a></code>
</p>

<hr>
<h2 id='use_vegawidget'>Add vegawidget functions to your package</h2><span id='topic+use_vegawidget'></span><span id='topic+use_vegawidget_interactive'></span>

<h3>Description</h3>

<p>These functions are offered to help you import and re-export vegawidget
functions in your package. For more detail, please see
<a href="https://vegawidget.github.io/vegawidget/articles/articles/import.html">this article</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>use_vegawidget(s3_class_name = NULL)

use_vegawidget_interactive()
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="use_vegawidget_+3A_s3_class_name">s3_class_name</code></td>
<td>
<p><code>character</code>, name of an S3 class for object to
be coerced to a <code>vegaspec</code>; default (NULL) implies no additional class</p>
</td></tr>
</table>


<h3>Details</h3>

<p><strong><code>use_vegawidget()</code></strong>:
</p>
<p>Adds vegawidget functions:
</p>

<ul>
<li> <p><code><a href="#topic+as_vegaspec">as_vegaspec()</a></code>, <code><a href="#topic+vw_as_json">vw_as_json()</a></code>
</p>
</li>
<li> <p><code>format()</code>, <code>print()</code>, <code>knit_print()</code>
</p>
</li>
<li> <p><code><a href="#topic+vegawidget">vegawidget()</a></code>, <code><a href="#topic+vega_embed">vega_embed()</a></code>, <code><a href="#topic+vw_set_base_url">vw_set_base_url()</a></code>
</p>
</li>
<li> <p><code><a href="#topic+vw_to_svg">vw_to_svg()</a></code> and other image functions
</p>
</li>
<li> <p><code><a href="#topic+vegawidgetOutput">vegawidgetOutput()</a></code>, <code><a href="#topic+renderVegawidget">renderVegawidget()</a></code>
</p>
</li></ul>

<p>In practical terms:
</p>

<ul>
<li><p> adds <strong>vegawidget</strong> to <code>Imports</code> in your package's DESCRIPTION file.
</p>
</li>
<li><p> adds <strong>V8</strong>, <strong>withr</strong>, <strong>fs</strong>, <strong>rsvg</strong>, and <strong>png</strong> to <code>Suggests</code>
in your package's DESCRIPTION file.
</p>
</li>
<li><p> creates <code>R/utils-vegawidget.R</code>
</p>
</li>
<li><p> you can delete references to functions you do not want
to re-export.
</p>
</li></ul>

<p>If you have your own S3 class for a spec, specify the <code>s3_class_name</code>
argument. You will have to edit <code style="white-space: pre;">&#8288;R/utils-vegawidget-&lt;s3_class_name&gt;.R&#8288;</code>:
</p>

<ul>
<li><p> add the code within your class's method for
to coerce your object to a <code>vegaspec</code>.
</p>
</li></ul>

<p>To permit knit-printing of your custom class, you will have to add some code
to your package's <code>.onLoad()</code> function.
</p>
<p><strong><code>use_vegawidget_interactive()</code></strong>:
</p>
<p>If you want to add the JavaScript and Shiny functions,
use this after running <code>use_vegawidget()</code>. It adds:
</p>

<ul>
<li> <p><code><a href="#topic+vw_add_data_listener">vw_add_data_listener()</a></code> and other listener-functions.
</p>
</li>
<li> <p><code><a href="#topic+vw_handler_data">vw_handler_data()</a></code> and other handler functions.
</p>
</li>
<li> <p><code><a href="#topic+vw_shiny_get_data">vw_shiny_get_data()</a></code> and other Shiny getters.
</p>
</li>
<li> <p><code><a href="#topic+vw_shiny_set_data">vw_shiny_set_data()</a></code> and other Shiny setters.
</p>
</li></ul>

<p>In practical terms:
</p>

<ul>
<li><p> adds <strong>shiny</strong>, <strong>dplyr</strong>, to <code>Suggests</code>.
</p>
</li>
<li><p> creates <code>R/utils-vegawidget-interactive.R</code>.
</p>
</li>
<li><p> at your discretion, delete references to functions you do not want
to re-export.
</p>
</li></ul>



<h3>Value</h3>

<p>invisible <code>NULL</code>, called for side effects
</p>

<hr>
<h2 id='vega_embed'>Vega embed options</h2><span id='topic+vega_embed'></span>

<h3>Description</h3>

<p>Helper-function to specify the <code>embed</code> argument to <code>vegawidget()</code>.
These arguments reflect the options to the
<a href="https://github.com/vega/vega-embed/#options">vega-embed</a>
library, which ultimately renders the chart specification as HTML.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vega_embed(
  renderer = c("canvas", "svg"),
  actions = NULL,
  defaultStyle = TRUE,
  config = NULL,
  patch = NULL,
  bind = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vega_embed_+3A_renderer">renderer</code></td>
<td>
<p><code>character</code> the renderer to use for the view.
One of <code>"canvas"</code> (default) or <code>"svg"</code>.
See <a href="https://vega.github.io/vega/docs/api/view/#view_renderer">Vega docs</a>
for details.</p>
</td></tr>
<tr><td><code id="vega_embed_+3A_actions">actions</code></td>
<td>
<p><code>logical</code> or named vector of logicals, determines if action links
(&quot;Export as PNG/SVG&quot;, &quot;View Source&quot;, &quot;Open in Vega Editor&quot;)
are included with the embedded view.
If the value is <code>TRUE</code> (default), all action links will be shown
and none if the value is <code>FALSE</code>. This property can be a named vector of
logicals that maps
keys (<code>export</code>, <code>source</code>, <code>compiled</code>, <code>editor</code>) to logical values for determining
if each action link should be shown. By default, <code>export</code>, <code>source</code>,
and <code>editor</code> are <code>TRUE</code> and <code>compiled</code> is <code>FALSE</code>, but these defaults
can be overridden. For example, if <code>actions</code> is
<code>list(export =  FALSE, source = TRUE)</code>, the embedded visualization will
have two links – &quot;View Source&quot; and &quot;Open in Vega Editor&quot;.</p>
</td></tr>
<tr><td><code id="vega_embed_+3A_defaultstyle">defaultStyle</code></td>
<td>
<p><code>logical</code> or <code>character</code>
default stylesheet for embed actions. If set to <code>TRUE</code> (default),
the embed actions are shown in a menu. Set to <code>FALSE</code> to use simple links.
Provide a <code>character</code> string to set the style sheet.</p>
</td></tr>
<tr><td><code id="vega_embed_+3A_config">config</code></td>
<td>
<p><code>character</code> or <code>list</code>, a URL string from which to load
a Vega/Vega-Lite or Vega-Lite configuration file, or a <code>list</code> of
Vega/Vega-Lite configurations to override the default configuration
options. If <code>config</code> is a URL, it will be subject to standard browser
security restrictions. Typically this URL will point to a file on the same
host and port number as the web page itself.</p>
</td></tr>
<tr><td><code id="vega_embed_+3A_patch">patch</code></td>
<td>
<p><code>JS</code> function, <code>list</code> or <code>character</code>, A function to modify the
Vega specification before it is parsed. Alternatively, an <code>list</code> that,
when compiled to JSON, will meet
<a href="https://www.rfc-editor.org/rfc/rfc6902">JSON-Patch RFC6902</a>.
If you use Vega-Lite, the compiled Vega will be patched.
Alternatively to the function or the <code>list</code>, a URL string from which to
load the patch can be provided. This URL will be subject to standard
browser security restrictions. Typically this URL will point to a file
on the same host and port number as the web page itself.</p>
</td></tr>
<tr><td><code id="vega_embed_+3A_bind">bind</code></td>
<td>
<p><code>character</code></p>
</td></tr>
<tr><td><code id="vega_embed_+3A_...">...</code></td>
<td>
<p>other named items, outlined in
<a href="https://github.com/vega/vega-embed">vega-embed</a> options.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The most important arguments are <code>renderer</code>, <code>actions</code>, and <code>defaultStyle</code>:
</p>

<ul>
<li><p> The default <code>renderer</code> is <code>"canvas"</code>.
</p>
</li>
<li><p> The default for <code>actions</code> is <code>NULL</code>, which means that the <code>export</code>,
<code>source</code>, and <code>editor</code> links are shown, but the <code>compiled</code> link is
not shown.
</p>

<ul>
<li><p> To suppress all action links, call with <code>actions = FALSE</code>.
</p>
</li>
<li><p> To change from the default for a given action link, call with a list:
<code>actions = list(editor = FALSE)</code>.
</p>
</li></ul>

</li>
<li><p> The default for <code>defaultStyle</code> is <code>TRUE</code>, which means that action-links
are rendered in a widget at the upper-right corner of the rendered chart.
</p>
</li></ul>

<p>The <a href="https://github.com/vega/vega-embed/#options">vega-embed</a> library has a lot
more options, you can supply these as names arguments using <code>...</code>.
</p>
<p>For example, it is ineffective to set the <code>width</code> and <code>height</code> parameters
here when embedding a Vega-Lite specification, as they will be overridden
by the value in the chart specification.
</p>


<h3>Value</h3>

<p><code>list</code> to to be used with vega-embed JavaScript library
</p>


<h3>See Also</h3>

<p><a href="https://github.com/vega/vega-embed">vega-embed library</a>,
<code><a href="#topic+vegawidget">vegawidget()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>vega_embed(renderer = "svg")

</code></pre>

<hr>
<h2 id='vega_schema'>Create string for schema-URL</h2><span id='topic+vega_schema'></span>

<h3>Description</h3>

<p>Useful if you are creating a vegaspec manually.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vega_schema(
  library = c("vega_lite", "vega"),
  version = NULL,
  major = is.null(version)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vega_schema_+3A_library">library</code></td>
<td>
<p><code>character</code>, either <code>"vega"</code> or <code>"vega_lite"</code></p>
</td></tr>
<tr><td><code id="vega_schema_+3A_version">version</code></td>
<td>
<p><code>character</code>, version of library, e.g. <code>"5.2.0"</code>;
if <code>version</code> is provided, <code>major</code> defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="vega_schema_+3A_major">major</code></td>
<td>
<p><code>logical</code> return major version-tags rather than the
tags for the specific versions supported by this package</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>character</code> URL for schema
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  vega_schema()
  vega_schema("vega", major = FALSE)
  vega_schema("vega_lite", version = "5.2.0")

  # creating a spec by hand
  spec &lt;-
    list(
      `$schema` = vega_schema(),
      width = 300,
      height = 300
      # and so on
    ) %&gt;%
    as_vegaspec()

</code></pre>

<hr>
<h2 id='vega_version'>Get Vega JavaScript versions</h2><span id='topic+vega_version'></span><span id='topic+vega_version_all'></span><span id='topic+vega_version_available'></span>

<h3>Description</h3>

<p>Use these functions to get which versions of Vega JavaScript libraries
are available. <code>vega_version_all()</code> returns a data frame showing all
versions included in this package, <code>vega_version_available()</code> returns
all versions available - subject to locking,
<code>vega_version()</code> shows the default version.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vega_version(major = FALSE)

vega_version_all(major = FALSE)

vega_version_available(major = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vega_version_+3A_major">major</code></td>
<td>
<p><code>logical</code> return major version-tags rather than the
tags for the specific versions supported by this package</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This package offers multiple widgets, each corresponding to a major version
of Vega-Lite. Only one of these widgets can be used for a given loading of
this package. When <code>vegawidget()</code> is first called, the widget is &quot;locked&quot;
according to the <code style="white-space: pre;">&#8288;$schema&#8288;</code> in the <code>vegaspec</code> used, or the default - the
most-recent version.
</p>

<dl>
<dt><code>is_locked</code></dt><dd><p>indicates if <code>vegawidget()</code> is has locked the version.</p>
</dd>
<dt><code>widget</code></dt><dd><p>indicates which version of the widget would be used.</p>
</dd>
</dl>



<h3>Value</h3>


<dl>
<dt>vega_version()</dt><dd><p><code>list</code> with elements: <code>is_locked</code>, <code>widget</code>,
<code>vega_lite</code>, <code>vega</code>, <code>vega_embed</code>.</p>
</dd>
<dt>vega_version_all()</dt><dd><p><code>data.frame</code> with elements: <code>widget</code>,
<code>vega_lite</code>, <code>vega</code>, <code>vega_embed</code>.</p>
</dd>
<dt>vega_version_available()</dt><dd><p><code>data.frame</code> with elements: <code>widget</code>,
<code>vega_lite</code>, <code>vega</code>, <code>vega_embed</code>.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>  vega_version()
  vega_version(major = TRUE)
  vega_version_all()
  vega_version_available()
</code></pre>

<hr>
<h2 id='vegawidget'>Create a Vega/Vega-Lite htmlwidget</h2><span id='topic+vegawidget'></span>

<h3>Description</h3>

<p>The main use of this package is to render a <code>vegawidget</code>,
which is also an <code>htmlwidget</code>. This function builds a <code>vegawidget</code>
using a <code>vegaspec</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vegawidget(
  spec,
  embed = NULL,
  width = NULL,
  height = NULL,
  elementId = NULL,
  base_url = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vegawidget_+3A_spec">spec</code></td>
<td>
<p>An object to be coerced to <code>vegaspec</code>, a Vega/Vega-Lite specification</p>
</td></tr>
<tr><td><code id="vegawidget_+3A_embed">embed</code></td>
<td>
<p><code>list</code> to specify
<a href="https://github.com/vega/vega-embed#options">vega-embed</a> options,
see <strong>Details</strong> on how this is set if <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="vegawidget_+3A_width">width</code></td>
<td>
<p><code>integer</code>, if specified, the total rendered width (in pixels)
of the chart - valid only for single-view charts and layered charts;
the default is to use the width in the chart specification</p>
</td></tr>
<tr><td><code id="vegawidget_+3A_height">height</code></td>
<td>
<p><code>integer</code>, if specified, the total rendered height (in pixels)
of the chart - valid only for single-view charts and layered charts;
the default is to use the height in the chart specification</p>
</td></tr>
<tr><td><code id="vegawidget_+3A_elementid">elementId</code></td>
<td>
<p><code>character</code>, explicit element ID for the vegawidget,
useful if you have other JavaScript that needs to explicitly
discover and interact with a specific vegawidget</p>
</td></tr>
<tr><td><code id="vegawidget_+3A_base_url">base_url</code></td>
<td>
<p><code>character</code>, the base URL to prepend to data-URL elements
in the vegaspec. This could be the path
to a local directory that contains a local file referenced in the spec.
It could be the base for a remote URL. Please note that by specifying
the <code>base_url</code> here, you will override any <code>loader</code> that you specify
using <code>vega_embed()</code>. Please note that this does not work with
<code>knitr</code>. See examples.</p>
</td></tr>
<tr><td><code id="vegawidget_+3A_...">...</code></td>
<td>
<p>other arguments passed to <code><a href="htmlwidgets.html#topic+createWidget">htmlwidgets::createWidget()</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>embed</code> is <code>NULL</code>, <code>vegawidget()</code> uses:
</p>

<ul>
<li> <p><code>getOption("vega.embed")</code>, if that is NULL:
</p>
</li>
<li><p> an empty call to <code><a href="#topic+vega_embed">vega_embed()</a></code>
</p>
</li></ul>

<p>The most-important arguments to <code><a href="#topic+vega_embed">vega_embed()</a></code> are:
</p>

<ul>
<li> <p><code>renderer</code>, to specify <code>"canvas"</code> (default) or <code>"svg"</code>
</p>
</li>
<li> <p><code>actions</code>,  to specify action-links
for <code>export</code>, <code>source</code>, <code>compiled</code>, and <code>editor</code>
</p>
</li></ul>

<p>If either <code>width</code> or <code>height</code> is specified, the <code>autosize()</code> function
is used to override the width and height of the <code>spec</code>. There are some
important provisions:
</p>

<ul>
<li><p> Specifying <code>width</code> and <code>height</code> is
<a href="https://vega.github.io/vega-lite/docs/size.html#limitations">effective only for single-view charts and layered charts</a>.
It will not work for concatenated, faceted, or repeated charts.
</p>
</li>
<li><p> In the <code>spec</code>, the default interpretation of width and height
is to describe the dimensions of the
<strong>plotting rectangle</strong>, not including the space used by the axes, labels,
etc. Here, <code>width</code> and <code>height</code> describe the dimensions
of the <strong>entire</strong> rendered chart, including axes, labels, etc.
</p>
</li></ul>

<p>Please note that if you are using a remote URL to refer to a dataset in
your vegaspec, it may not render properly in the RStudio IDE,
due to a security policy set by RStudio. If you open the chart in a
browser, it should render properly.
</p>


<h3>Value</h3>

<p>S3 object of class <code>vegawidget</code> and <code>htmlwidget</code>
</p>


<h3>See Also</h3>

<p><a href="https://github.com/vega/vega-embed#options">vega-embed options</a>,
<code><a href="#topic+vega_embed">vega_embed()</a></code>, <code><a href="#topic+vw_autosize">vw_autosize()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  vegawidget(spec_mtcars, width = 350, height = 350)

  # vegaspec with a data URL
  spec_precip &lt;-
    list(
      `$schema` = vega_schema(),
      data = list(url = "seattle-weather.csv"),
      mark = "tick",
      encoding = list(
        x = list(field = "precipitation", type = "quantitative")
      )
    ) %&gt;%
    as_vegaspec()

  # define local path to file
  path_local &lt;- system.file("example-data", package = "vegawidget")

  # render using local path (does not work with knitr)
  vegawidget(spec_precip, base_url = path_local)

## Not run: 
  # requires network-access

  # define remote path to file
  url_remote &lt;- "https://vega.github.io/vega-datasets/data"

  # render using remote path
  # note: does not render in RStudio IDE; open using browser
  vegawidget(spec_precip, base_url = url_remote)

## End(Not run)
</code></pre>

<hr>
<h2 id='vegawidgetOutput'>Shiny-output for vegawidget</h2><span id='topic+vegawidgetOutput'></span>

<h3>Description</h3>

<p>Use this function in the UI part of your Shiny app.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vegawidgetOutput(outputId, width = "auto", height = "auto", widget = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vegawidgetOutput_+3A_outputid">outputId</code></td>
<td>
<p>output variable to read from</p>
</td></tr>
<tr><td><code id="vegawidgetOutput_+3A_width">width</code>, <code id="vegawidgetOutput_+3A_height">height</code></td>
<td>
<p>Must be a valid CSS unit (like <code>"100%"</code>,
<code>"400px"</code>, <code>"auto"</code>) or a number, which will be coerced to a
string and have <code>"px"</code> appended. For vegawidgets, <code>"auto"</code> is useful
because, as of now, the spec determines the size of the widget, then the
widget determines the size of the container.</p>
</td></tr>
<tr><td><code id="vegawidgetOutput_+3A_widget">widget</code></td>
<td>
<p><code>character</code>, indicating which version of libraries to use,
e.g. <code>"vl5"</code>. Normally, you should not need to set this.
See <code>vega_version_all()</code> for more information.</p>
</td></tr>
</table>

<hr>
<h2 id='vw_as_json'>Coerce vegaspec to JSON</h2><span id='topic+vw_as_json'></span>

<h3>Description</h3>

<p>For Vega and Vega-Lite, the translation between lists and JSON is a little
bit particular. This function, <code><a href="#topic+vw_as_json">vw_as_json()</a></code>, can be used to translate
to JSON; <code><a href="#topic+as_vegaspec">as_vegaspec()</a></code> can be used to translate from JSON.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vw_as_json(spec, pretty = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vw_as_json_+3A_spec">spec</code></td>
<td>
<p>An object to be coerced to <code>vegaspec</code>, a Vega/Vega-Lite specification</p>
</td></tr>
<tr><td><code id="vw_as_json_+3A_pretty">pretty</code></td>
<td>
<p><code>logical</code> indicates to use pretty (vs. minified) formatting</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>jsonlite::json</code> object
</p>


<h3>See Also</h3>

<p><code><a href="#topic+as_vegaspec">as_vegaspec()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  vw_as_json(spec_mtcars)

</code></pre>

<hr>
<h2 id='vw_autosize'>Autosize vegaspec</h2><span id='topic+vw_autosize'></span>

<h3>Description</h3>

<p>The arguments <code>width</code> and <code>height</code> are used to override the width and height
of the provided <code>spec</code>, if the <code>spec</code> does not have multiple views.
The dimensions you provide describe the overall width and height of the
rendered chart, including axes, labels, legends, etc.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vw_autosize(spec, width = NULL, height = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vw_autosize_+3A_spec">spec</code></td>
<td>
<p>An object to be coerced to <code>vegaspec</code>, a Vega/Vega-Lite specification</p>
</td></tr>
<tr><td><code id="vw_autosize_+3A_width">width</code></td>
<td>
<p><code>integer</code>, if specified, the total rendered width (in pixels)
of the chart - valid only for single-view charts and layered charts;
the default is to use the width in the chart specification</p>
</td></tr>
<tr><td><code id="vw_autosize_+3A_height">height</code></td>
<td>
<p><code>integer</code>, if specified, the total rendered height (in pixels)
of the chart - valid only for single-view charts and layered charts;
the default is to use the height in the chart specification</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In a Vega or Vega-Lite specification, the default interpretation
of width and height is to describe the dimensions of the
<strong>data rectangle</strong>, not including the space used by the axes, labels,
legends, etc. When <code>width</code> and <code>height</code> are specified using
<a href="https://vega.github.io/vega-lite/docs/size.html#autosize">autosize</a>,
the meanings of <code>width</code> and <code>height</code> change to describe the dimensions
of the <strong>entire chart</strong>, including axes, labels, legends, etc.
</p>
<p>There is an important limitation: specifying <code>width</code> and <code>height</code> is
<a href="https://vega.github.io/vega-lite/docs/size.html#limitations">effective only for single-view and layered specifications</a>.
It will not work for specifications with multiple views
(e.g. <code>hconcat</code>, <code>vconcat</code>, <code>facet</code>, <code>repeat</code>); this will issue a
warning that there will be no effect on the specification when rendered.
</p>


<h3>Value</h3>

<p>S3 object with class <code>vegaspec</code>
</p>


<h3>See Also</h3>

<p><a href="https://vegawidget.github.io/vegawidget/articles/articles/vegaspec.html#sizing">Article on vegaspec (sizing)</a>,
<a href="https://vega.github.io/vega-lite/docs/size.html#autosize">Vega documentation on sizing</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  vw_autosize(spec_mtcars, width = 350, height = 350)
</code></pre>

<hr>
<h2 id='vw_examine'>Examine vegaspec</h2><span id='topic+vw_examine'></span>

<h3>Description</h3>

<p>This is a thin wrapper to <code><a href="listviewer.html#topic+jsonedit">listviewer::jsonedit()</a></code>,
use to interactively examine a Vega or Vega-Lite specification.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vw_examine(
  spec,
  mode = "view",
  modes = c("view", "code", "form", "text", "tree"),
  ...,
  width = NULL,
  height = NULL,
  elementId = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vw_examine_+3A_spec">spec</code></td>
<td>
<p>An object to be coerced to <code>vegaspec</code>, a Vega/Vega-Lite specification</p>
</td></tr>
<tr><td><code id="vw_examine_+3A_mode">mode</code></td>
<td>
<p><code>string</code> for the initial view from modes.
<code>'view'</code> is the default.</p>
</td></tr>
<tr><td><code id="vw_examine_+3A_modes">modes</code></td>
<td>
<p>string <code>c('view','code', 'form', 'text', 'tree')</code>
will be the default, since these are all the modes
currently supported by <strong><code>jsoneditor</code></strong>.</p>
</td></tr>
<tr><td><code id="vw_examine_+3A_...">...</code></td>
<td>
<p><code>list</code> of other options for <code>jsoneditor</code>.  This is a temporary way
of trying other options in <code>jsoneditor</code>.  In the future, this will be eliminated
in favor of specific, more self-documenting and helpful arguments.</p>
</td></tr>
<tr><td><code id="vw_examine_+3A_width">width</code></td>
<td>
<p>integer in pixels defining the width of the <code>div</code> container.</p>
</td></tr>
<tr><td><code id="vw_examine_+3A_height">height</code></td>
<td>
<p>integer in pixels defining the height of the <code>div</code> container.</p>
</td></tr>
<tr><td><code id="vw_examine_+3A_elementid">elementId</code></td>
<td>
<p>character to specify valid <code>CSS</code> id of the
htmlwidget for special situations in which you want a non-random
identifier.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>S3 object of class <code>jsonedit</code> and <code>htmlwidget</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  vw_examine(spec_mtcars)

  spec_mtcars_autosize &lt;-
    spec_mtcars %&gt;%
    vw_autosize(width = 300, height = 300)

  vw_examine(spec_mtcars_autosize)
</code></pre>

<hr>
<h2 id='vw_fetch'>Callback helpers</h2><span id='topic+vw_fetch'></span><span id='topic+vw_load'></span>

<h3>Description</h3>

<p>These are used by V8 so that R can access the file-system and the network
so that external data can be accessed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vw_fetch(url, options = NULL, encoding = "UTF-8")

vw_load(filename, encoding = "UTF-8")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vw_fetch_+3A_url">url</code></td>
<td>
<p><code>character</code></p>
</td></tr>
<tr><td><code id="vw_fetch_+3A_options">options</code></td>
<td>
<p>named <code>list</code>, not yet implemented</p>
</td></tr>
<tr><td><code id="vw_fetch_+3A_filename">filename</code></td>
<td>
<p><code>character</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Assumes the encoding is UTF-8.
</p>


<h3>Value</h3>

<p><code>character</code> contents of the file or URL
</p>

<hr>
<h2 id='vw_handler'>Construct a vegawidget handler</h2><span id='topic+vw_handler'></span>

<h3>Description</h3>

<p>You will likely call one of the specific handler-constructors:
<code><a href="#topic+vw_handler_signal">vw_handler_signal()</a></code>, <code><a href="#topic+vw_handler_event">vw_handler_event()</a></code>, in conjunction with
<code><a href="#topic+vw_handler_add_effect">vw_handler_add_effect()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vw_handler(args, body_value, body_effect)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vw_handler_+3A_args">args</code></td>
<td>
<p><code>character</code>, vector of names for the arguments for the handler</p>
</td></tr>
<tr><td><code id="vw_handler_+3A_body_value">body_value</code></td>
<td>
<p><code>character</code>, body of the <em>value</em> part of the handler</p>
</td></tr>
<tr><td><code id="vw_handler_+3A_body_effect">body_effect</code></td>
<td>
<p><code>character</code>, body of the <em>effect</em> part of the handler</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The handler has three parts:
</p>

<ul>
<li> <p><code>args</code> arguments to the handler
</p>
</li>
<li> <p><code>body_value</code> the body of a function of the <code>args</code>, returns a value
</p>
</li>
<li> <p><code>body_effect</code> the body of a function of the value, <code>x</code>, performs a
side-effect
</p>
</li></ul>



<h3>Value</h3>

<p>object with S3 class <code>vw_handler</code>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+vw_handler_signal">vw_handler_signal()</a></code>, <code><a href="#topic+vw_handler_event">vw_handler_event()</a></code>,
<code><a href="#topic+vw_handler_add_effect">vw_handler_add_effect()</a></code>
</p>

<hr>
<h2 id='vw_handler_add_effect'>Add a side-effect to a JavaScript handler</h2><span id='topic+vw_handler_add_effect'></span>

<h3>Description</h3>

<p>With a JavaScript handler, once you have calculated a value
based on the handler's arguments (e.g. <code>name</code>, <code>value</code>) you will
likely want to produce a side-effect based on that calculated value.
This function helps you do that.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vw_handler_add_effect(vw_handler, body_effect, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vw_handler_add_effect_+3A_vw_handler">vw_handler</code></td>
<td>
<p><code>vw_handler</code> created using <code><a href="#topic+vw_handler_signal">vw_handler_signal()</a></code> or
<code><a href="#topic+vw_handler_event">vw_handler_event()</a></code></p>
</td></tr>
<tr><td><code id="vw_handler_add_effect_+3A_body_effect">body_effect</code></td>
<td>
<p><code>character</code>, the name of a defined handler-body,
or the text of the body of a handler-function</p>
</td></tr>
<tr><td><code id="vw_handler_add_effect_+3A_...">...</code></td>
<td>
<p>additional <em>named</em> parameters to be interpolated into the
text of the handler_body</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The calculation of a value is meant to be separate from the
production of a side-effect. This way, the code for a side-effect
can be used for any type of handler.
</p>
<p>You are supplying the <code>body_effect</code> to an effect-handler. This
takes a single argument, <code>x</code>, representing the
calculated value. Doing this allows us to chain side-effects together;
be careful not to modify <code>x</code> in any of the code you provide.
</p>
<p>To see what side-effects are available in this package's handler-library,
call <code>vw_handler_add_effect()</code> without any arguments. You may notice that
some of the effects, like <code>"element_text"</code>, require additional parameters,
in this case, <code>selector</code>.
</p>
<p>Those parameters with a default value of <code>NULL</code> require you to supply
a value; those with sensible defaults are optional.
</p>
<p>To provide the parameters, call
<code>vw_handler_add_effect()</code> with <em>named</em> arguments corresponding to the
names of the parameters. See the examples for details.
</p>


<h3>Value</h3>

<p>modified copy of <code>vw_handler</code>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+vw_handler_signal">vw_handler_signal()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  # list all the available effect-handlers
  vw_handler_add_effect()

  # build a signal handler that prints some text,
  # then the value, to the console
  vw_handler_signal("value") %&gt;%
    vw_handler_add_effect("console", label = "signal value:")

</code></pre>

<hr>
<h2 id='vw_handler_body_compose'>Compose a JavaScript handler</h2><span id='topic+vw_handler_body_compose'></span><span id='topic+vw_handler_compose'></span>

<h3>Description</h3>

<p>These functions are used to compose a <code>vw_handler</code> object into
text that will be interpreted either as a complete JavaScript
function, or a function-body.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vw_handler_body_compose(vw_handler, n_indent = 2L)

vw_handler_compose(vw_handler)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vw_handler_body_compose_+3A_vw_handler">vw_handler</code></td>
<td>
<p><code>vw_handler</code> created using <code><a href="#topic+vw_handler_signal">vw_handler_signal()</a></code> or
<code><a href="#topic+vw_handler_event">vw_handler_event()</a></code></p>
</td></tr>
<tr><td><code id="vw_handler_body_compose_+3A_n_indent">n_indent</code></td>
<td>
<p><code>integer</code>, number of spaces to indent the text of the body</p>
</td></tr>
</table>


<h3>Value</h3>

<p>object with S3 class <code>JS_EVAL</code>, text for the function or
function-body
</p>

<hr>
<h2 id='vw_handler_signal'>Construct a JavaScript handler</h2><span id='topic+vw_handler_signal'></span><span id='topic+vw_handler_data'></span><span id='topic+vw_handler_event'></span>

<h3>Description</h3>

<p>A Vega listener needs a JavaScript handler-function to call
when the object-being-listened-to changes. For instance, <a href="#topic+shiny-getters">shiny-getters</a> and
<a href="#topic+add-listeners">add-listeners</a> functions each have an argument called
<code>body_value</code>, which these functions help you build.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vw_handler_signal(body_value)

vw_handler_data(body_value)

vw_handler_event(body_value)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vw_handler_signal_+3A_body_value">body_value</code></td>
<td>
<p><code>character</code>, the name of a defined handler-body,
or the text of the body of a handler-function</p>
</td></tr>
</table>


<h3>Details</h3>

<p>There are two types of handlers defined in this package's handler-library.
To see the handlers that are defined for each, call the function
without any arguments:
</p>

<ul>
<li> <p><code>vw_handler_signal()</code>
</p>
</li>
<li> <p><code>vw_handler_data()</code>
</p>
</li>
<li> <p><code>vw_handler_event()</code>
</p>
</li></ul>

<p>With a JavaScript handler, you are trying to do two types of things:
</p>

<ul>
<li><p> calculate a value based on the handler's arguments
</p>
</li>
<li><p> produce a side-effect based on that calculated value
</p>
</li></ul>

<p>Let's look at a concrete example.
A <a href="https://vega.github.io/vega/docs/api/view/"><em>signal</em> handler</a>
will take arguments <code>name</code> and <code>value</code>. Let's say that we want to
return the value. We could do this two ways:
</p>

<ul>
<li> <p><code>vw_handler_signal("value")</code>: use this package's handler library
</p>
</li>
<li> <p><code>vw_handler_signal("return value;")</code>: supply the body of the
handler-function yourself
</p>
</li></ul>

<p>In the list above, the two calls do exactly the same thing, they build a
JavaScript function that returns the <code>value</code> provided by whatever is calling
the signal-handler. This will be a valid signal-handler, however, we will
likely want a signal-handler to <em>do</em> something with that value, which is
why we may wish to add a side-effect.
</p>
<p>Let's say we want the handler to print the value to the JavaScript console.
We would create the signal-handler, then add an effect to print the result
to the console.
</p>
<p><code>vw_handler_signal("value") %&gt;% vw_handler_add_effect("console")</code>
</p>
<p>We can add as many effects as we like; for more information,
please see the documentation for <code><a href="#topic+vw_handler_add_effect">vw_handler_add_effect()</a></code>.
</p>
<p>Please be aware that these functions do <em>not</em> check for the correctness
of JavaScript code you supply - any errors you make will not be apparent
until your visualization is rendered in a browser.
</p>
<p>One last note, if <code>body_value</code> is already a <code>vw_handler</code>, these functions
are no-ops; they will return the <code>body_value</code> unchanged.
</p>


<h3>Value</h3>

<p>object with S3 class <code>vw_handler</code>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+vw_handler_add_effect">vw_handler_add_effect()</a></code>,
<a href="https://vega.github.io/vega/docs/api/view/">vega-view</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  # list all the available signal-handlers
  vw_handler_signal()

  # list all the available data-handlers
  vw_handler_data()

  # list all the available event-handlers
  vw_handler_event()

  # use a defined signal-handler
  vw_handler_signal("value")

  # define your own signal-handler
  vw_handler_signal("return value;")
</code></pre>

<hr>
<h2 id='vw_rename_datasets'>Rename datasets in a vegaspec</h2><span id='topic+vw_rename_datasets'></span>

<h3>Description</h3>

<p>If a vegaspec has named datasets, it may be useful to rename them.
This function will return a vegaspec with datasets named <code>data_001</code>,
<code>data_002</code>, and so on. It will go through the spec and replace the
references to the names. A future version of this function may give you
the more control over the names used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vw_rename_datasets(spec)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vw_rename_datasets_+3A_spec">spec</code></td>
<td>
<p>An object to be coerced to <code>vegaspec</code>, a Vega/Vega-Lite specification</p>
</td></tr>
</table>


<h3>Value</h3>

<p>S3 object of class <code>vegaspec</code>
</p>

<hr>
<h2 id='vw_serialize_data'>Serialize data-frame time-columns</h2><span id='topic+vw_serialize_data'></span>

<h3>Description</h3>

<p><strong>Please think of this as an experimental function</strong>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vw_serialize_data(data, iso_dttm = FALSE, iso_date = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vw_serialize_data_+3A_data">data</code></td>
<td>
<p><code>data.frame</code>, data to be serialized</p>
</td></tr>
<tr><td><code id="vw_serialize_data_+3A_iso_dttm">iso_dttm</code></td>
<td>
<p><code>logical</code>, indicates if datetimes (<code>POSIXct</code>) are to be
formatted using ISO-8601</p>
</td></tr>
<tr><td><code id="vw_serialize_data_+3A_iso_date">iso_date</code></td>
<td>
<p><code>logical</code>, indicates if dates (<code>Date</code>) are to be
formatted using ISO-8601</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In Vega, for now, there are only two time-zones available: the local
time-zone of the browser where the spec is rendered, and UTC. This differs
from R, where a time-zone attribute is available to <code>POSIXct</code> vectors.
Accordingly, when designing a vegaspec that uses time, you have to make some
some compromises. This function helps you to implement your compromise in
a principled way, as explained in the opinions below.
</p>
<p>Let's assume that your <code>POSIXct</code> data has a time-zone attached.
There are three different scenarios for rendering this data:
</p>

<ul>
<li><p> using the time-zone of the browser
</p>
</li>
<li><p> using UTC
</p>
</li>
<li><p> using the time-zone of the data
</p>
</li></ul>

<p>If you intend to display the data using the <strong>time-zone of the browser</strong>,
or using <strong>UTC</strong>, you should serialize datetimes using ISO-8601, i.e.
<code>iso_dttm = TRUE</code>. In the rest of your vegaspec, you should choose
local or UTC time-scales accordingly. However, in either case, you should
use local time-units. No compromise is necessary.
</p>
<p>If you intend to display the data using the <strong>time-zone of the browser</strong>,
this is where you will have to compromise. In this case, you should
serialize using <code>iso_dttm = FALSE</code>. By doing this, your datetimes will be
serialized using a non-ISO-8601 format, and notably, <strong>using the time-zone</strong>
of the datetime. When you design your vegaspec, you should treat this as
if it were a UTC time. You should direct Vega to parse this data as UTC,
i.e. <code>{"foo": "utc:'%Y-%m-%d %H:%M:%S'"}</code>. In other words, Vega should
interpret your local timestamp as if it were a UTC timestamp.
As in the first UTC case, you should use UTC time-scales and local
time-units.
</p>
<p>The compromise you are making is this: the internal representation of
the instants in time will be different in Vega than it will be in R.
You are losing information because you are converting from a <code>POSIXct</code>
object with a time-zone to a timestamp without a time-zone. It is also
worth noting that the time information in your Vega plot should not
be used anywhere else - this should be the last place this serialized
data should be used because it is no longer trustworthy. For this,
you will gain the ability to show the data in the context of its
time-zone.
</p>
<p>Dates can be different creatures than datetimes. I think that can be
&quot;common currency&quot; for dates. I think this is because it is more common to
compare across different locations using dates as a common index. For
example, you might compare daily stock-market data from NYSE, CAC-40, and
Hang Seng. To maintain a common time-index, you might choose UTC to
represent the dates in all three locations, despite the time-zone
differences.
</p>
<p>This is why the default for <code>iso_date</code> is <code>TRUE</code>. In this scenario,
you need not specify to Vega how to parse the date; because of its
ISO-8601 format, it will parse to UTC. As with the other UTC cases,
you should use UTC time-scales and local time-units.
</p>


<h3>Value</h3>

<p>object with the same type as <code>data</code>
</p>


<h3>See Also</h3>

<p><a href="https://vega.github.io/vega-lite/docs/timeunit.html#utc">Vega-Lite Time Unit (UTC)</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  # datetimes
  data_seattle_hourly %&gt;% head()
  data_seattle_hourly %&gt;% head() %&gt;% vw_serialize_data(iso_dttm = TRUE)
  data_seattle_hourly %&gt;% head() %&gt;% vw_serialize_data(iso_dttm = FALSE)

  # dates
  data_seattle_daily %&gt;% head()
  data_seattle_daily %&gt;% head() %&gt;% vw_serialize_data(iso_date = TRUE)
  data_seattle_daily %&gt;% head() %&gt;% vw_serialize_data(iso_date = FALSE)

</code></pre>

<hr>
<h2 id='vw_set_base_url'>Set base URL</h2><span id='topic+vw_set_base_url'></span>

<h3>Description</h3>

<p>This is useful for specs where data is specified using a URL.
Using this function to set the base URL, you can specify the data URL
in specs using the relative path from the base.
</p>
<p>For example, this
<a href="https://vega.github.io/vega-lite/examples/point_2d.html">Vega-Lite example</a>
uses the base URL <code style="white-space: pre;">&#8288;https://cdn.jsdelivr.net/npm/vega-datasets@2&#8288;</code>. In a spec,
instead of specifying:
</p>
<div class="sourceCode"><pre>data = "https://cdn.jsdelivr.net/npm/vega-datasets@2/data/cars.json"
</pre></div>
<p>You can call:
</p>
<div class="sourceCode"><pre>vw_set_base_url("https://cdn.jsdelivr.net/npm/vega-datasets@2")
</pre></div>
<p>Then specify:
</p>
<div class="sourceCode"><pre>data = "data/cars.json"
</pre></div>
<p>This function sets the value of <code>getOption("vega-embed")$loader$baseURL</code>.
You need set it only once in a session or RMarkdown file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vw_set_base_url(url)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vw_set_base_url_+3A_url">url</code></td>
<td>
<p><code>character</code> URL to use as the base URL.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>character</code> called for side effects, it returns the previous value
invisibly.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> # this is the URL used for Vega datasets
 previous &lt;- vw_set_base_url("https://cdn.jsdelivr.net/npm/vega-datasets@2")

 # reset to previous value
 vw_set_base_url(previous)
</code></pre>

<hr>
<h2 id='vw_shiny_demo'>Run Shiny demonstration-apps</h2><span id='topic+vw_shiny_demo'></span>

<h3>Description</h3>

<p>Run Shiny demonstration-apps
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vw_shiny_demo(example = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vw_shiny_demo_+3A_example">example</code></td>
<td>
<p><code>character</code>, name of the example to run; if NULL (default),
prints out a list of available examples</p>
</td></tr>
<tr><td><code id="vw_shiny_demo_+3A_...">...</code></td>
<td>
<p>additional arguments passed to <code><a href="shiny.html#topic+runApp">shiny::runApp()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>invisible NULL, called for side-effects
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  vw_shiny_demo() # returns available examples

  # Run only in interactive R sessions
  if (interactive()) {
    vw_shiny_demo("data-set-get")
  }
</code></pre>

<hr>
<h2 id='vw_spec_version'>Determine vegaspec version</h2><span id='topic+vw_spec_version'></span>

<h3>Description</h3>

<p>Use this function to determine the <code>library</code> and <code>version</code> of a <code>vegaspec</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vw_spec_version(spec)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vw_spec_version_+3A_spec">spec</code></td>
<td>
<p>An object to be coerced to <code>vegaspec</code>, a Vega/Vega-Lite specification</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Returns a list with two elements:
</p>

<dl>
<dt><code>library</code></dt><dd><p><code>character</code>, either <code>"vega"</code> or <code>"vega_lite"</code></p>
</dd>
<dt><code>version</code></dt><dd><p><code>character</code>, version tag</p>
</dd>
</dl>



<h3>Value</h3>

<p><code>list</code> with elements <code>library</code>, <code>version</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  vw_spec_version(spec_mtcars)
  # vw_to_vega() requires the V8 package
  vw_spec_version(vw_to_vega(spec_mtcars))
</code></pre>

<hr>
<h2 id='vw_to_vega'>Convert to Vega specification</h2><span id='topic+vw_to_vega'></span>

<h3>Description</h3>

<p>If you have  <strong><a href="https://CRAN.R-project.org/package=V8">V8</a></strong> installed,
you can use this function to compile a Vega-Lite specification
into a Vega specification.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vw_to_vega(spec)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vw_to_vega_+3A_spec">spec</code></td>
<td>
<p>An object to be coerced to <code>vegaspec</code>, a Vega/Vega-Lite specification</p>
</td></tr>
</table>


<h3>Value</h3>

<p>S3 object of class <code>vegaspec_vega</code> and <code>vegaspec</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  vw_spec_version(spec_mtcars)
  vw_spec_version(vw_to_vega(spec_mtcars))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
