<!DOCTYPE html><html><head><title>Help for package Power2Stage</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {Power2Stage}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#final.tsd.in'>
<p>Analysis after second stage of 2-stage 2x2 crossover design based on</p>
the Inverse Normal method</a></li>
<li><a href='#interim.tsd.in'>
<p>Interim analysis of first stage data of 2-stage 2x2 crossover designs based on</p>
the Inverse Normal method</a></li>
<li><a href='#power.tsd'>
<p>Power calculation of adaptive 2-stage BE studies in a 2x2 crossover design</p></a></li>
<li><a href='#power.tsd.fC'>
<p>Power calculation of adaptive 2-stage BE studies (2x2 crossover) with a</p>
futility criterion for the point estimate of T/R or its 90% CI</a></li>
<li><a href='#power.tsd.GS'>
<p>Power calculation for non-adaptive group sequential (2-stage) BE studies</p></a></li>
<li><a href='#power.tsd.in'>
<p>Power calculation of adaptive 2-stage BE studies with 2x2 crossover design,</p>
based on the Inverse Normal method</a></li>
<li><a href='#power.tsd.KM'>
<p>Power calculation of adaptive 2-stage BE studies (2x2 crossover)</p>
(variant of power.2stage to obtain the results of Karalis / Macheras)</a></li>
<li><a href='#power.tsd.p'>
<p>Power calculation of adaptive 2-stage BE studies in 2-group parallel designs</p></a></li>
<li><a href='#power.tsd.ssr'>
<p>Power of 2-stage BE studies in 2x2 crossover designs with interim</p>
sample size re-estimation</a></li>
<li><a href='#sampleN2.TOST'>
<p>Sample size re-estimation of adaptive 2-stage BE studies in 2x2 crossover and</p>
parallel designs based on power of TOST</a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Power and Sample-Size Distribution of 2-Stage Bioequivalence
Studies</td>
</tr>
<tr>
<td>Version:</td>
<td>0.5-4</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-11-20</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Detlew Labes &lt;DetlewLabes@gmx.de&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Contains functions to obtain the operational characteristics of 
    bioequivalence studies in Two-Stage Designs (TSD) via simulations.</td>
</tr>
<tr>
<td>Imports:</td>
<td>PowerTOST, stats, mvtnorm, cubature</td>
</tr>
<tr>
<td>Suggests:</td>
<td>graphics</td>
</tr>
<tr>
<td>ByteCompile:</td>
<td>yes</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/Detlew/Power2Stage">https://github.com/Detlew/Power2Stage</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/Detlew/Power2Stage/issues">https://github.com/Detlew/Power2Stage/issues</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-11-20 16:56:01 UTC; Detlew</td>
</tr>
<tr>
<td>Author:</td>
<td>Detlew Labes <a href="https://orcid.org/0000-0003-2169-426X"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Benjamin Lang [aut, ctb],
  Helmut Sch√ºtz <a href="https://orcid.org/0000-0002-1167-7880"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, ctb]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-11-20 17:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='final.tsd.in'>
Analysis after second stage of 2-stage 2x2 crossover design based on
the Inverse Normal method
</h2><span id='topic+final.tsd.in'></span><span id='topic+final.2stage.in'></span>

<h3>Description</h3>

<p>Following the design scheme according to <code>power.tsd.in</code> the function
performs the analysis after the second stage has been performed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>final.tsd.in(alpha, weight, max.comb.test = TRUE, GMR1, CV1, n1, df1 = NULL,
             SEM1 = NULL, GMR2, CV2, n2, df2 = NULL, SEM2 = NULL,
             theta1, theta2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="final.tsd.in_+3A_alpha">alpha</code></td>
<td>

<p>If one element is given, the overall one-sided significance level (not the
adjusted level for stage&nbsp;2). If two
elements are given, the adjusted one-sided alpha levels for
stage&nbsp;1 and
stage&nbsp;2, respectively.<br />
If missing, defaults to <code style="white-space: pre;">&#8288;0.05&#8288;</code>.
</p>
</td></tr>
<tr><td><code id="final.tsd.in_+3A_weight">weight</code></td>
<td>

<p>Pre-defined weight(s) of stage&nbsp;1.
Note that using the notation from Maurer et al weight corresponds to
information fraction, other literature may refer to sqrt(weight) as
being the weight. <code style="white-space: pre;">&#8288;weight&#8288;</code> must either contain one element (in case of
<code style="white-space: pre;">&#8288;max.comb.test = FALSE&#8288;</code>) or two elements (in case of
<code style="white-space: pre;">&#8288;max.comb.test = TRUE&#8288;</code>).<br />
If missing, defaults to <code style="white-space: pre;">&#8288;0.5&#8288;</code> for <code style="white-space: pre;">&#8288;max.comb.test = FALSE&#8288;</code> and to
<code style="white-space: pre;">&#8288;c(0.5, 0.25)&#8288;</code> for <code style="white-space: pre;">&#8288;max.comb.test = TRUE&#8288;</code>.
</p>
</td></tr>
<tr><td><code id="final.tsd.in_+3A_max.comb.test">max.comb.test</code></td>
<td>

<p>Logical; if <code style="white-space: pre;">&#8288;TRUE&#8288;</code> (default) the maximum combination test will be
used, otherwise the standard combination test.
</p>
</td></tr>
<tr><td><code id="final.tsd.in_+3A_gmr1">GMR1</code></td>
<td>

<p>Observed ratio of geometric means (T/R) of
stage&nbsp;1 data
(use <em>e.g.</em>, 0.95 for 95%).
</p>
</td></tr>
<tr><td><code id="final.tsd.in_+3A_cv1">CV1</code></td>
<td>

<p>Observed coefficient of variation of the intra-subject variability of
stage&nbsp;1 (use <em>e.g.</em>, 0.3 for 30%).
</p>
</td></tr>
<tr><td><code id="final.tsd.in_+3A_n1">n1</code></td>
<td>

<p>Sample size of stage&nbsp;1.
</p>
</td></tr>
<tr><td><code id="final.tsd.in_+3A_df1">df1</code></td>
<td>

<p>Optional; Error degrees of freedom of
stage&nbsp;1 that can be specified in
addition to <code>n1</code>.
</p>
</td></tr>
<tr><td><code id="final.tsd.in_+3A_sem1">SEM1</code></td>
<td>

<p>Optional; Standard error of the difference of means of
stage&nbsp;1 that can be specified in
addition to <code>CV1</code>. Must be on additive scale (i.e. usually log-scale).
</p>
</td></tr>
<tr><td><code id="final.tsd.in_+3A_gmr2">GMR2</code></td>
<td>

<p>Observed ratio of geometric means (T/R) of (only)
stage&nbsp;2 data
(use <em>e.g.</em>, 0.95 for 95%).
</p>
</td></tr>
<tr><td><code id="final.tsd.in_+3A_cv2">CV2</code></td>
<td>

<p>Observed coefficient of variation of the intra-subject variability of (only)
stage&nbsp;2 (use <em>e.g.</em>, 0.3 for 30%).
</p>
</td></tr>
<tr><td><code id="final.tsd.in_+3A_n2">n2</code></td>
<td>

<p>Sample size of stage&nbsp;2.
</p>
</td></tr>
<tr><td><code id="final.tsd.in_+3A_df2">df2</code></td>
<td>

<p>Optional; Error degrees of freedom of (only)
stage&nbsp;2 that can be specified in
addition to <code>n2</code>.
</p>
</td></tr>
<tr><td><code id="final.tsd.in_+3A_sem2">SEM2</code></td>
<td>

<p>Optional; Standard error of the difference of means of (only)
stage&nbsp;2 that can be specified in
addition to <code>CV2</code>. Must be on additive scale (i.e. usually log-scale).
</p>
</td></tr>
<tr><td><code id="final.tsd.in_+3A_theta1">theta1</code></td>
<td>

<p>Lower bioequivalence limit. Defaults to 0.8.
</p>
</td></tr>
<tr><td><code id="final.tsd.in_+3A_theta2">theta2</code></td>
<td>

<p>Upper bioequivalence limit. Defaults to 1.25.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The observed values <code>GMR1</code>, <code>CV1</code>, <code>n1</code> must be obtained
using data from stage 1 only, and <code>GMR2</code>, <code>CV2</code>, <code>n2</code> must
be obtained using data from stage 2 only. This may be done via the usual
ANOVA approach.<br /><br />
The optional arguments <code>df1</code>, <code>SEM1</code>, <code>df2</code> and <code>SEM2</code>
require a somewhat advanced knowledge (provided in the raw output from for
example the software <abbr><span class="acronym">SAS</span></abbr>, or may be obtained via <code>emmeans::emmeans</code>).
However, it has the advantage that if there were missing data the exact
degrees of freedom and standard error of the difference can be used,
the former possibly being non-integer valued (e.g. if the
Kenward-Roger method was used).
</p>


<h3>Value</h3>

<p>Returns an object of class <code style="white-space: pre;">&#8288;"evaltsd"&#8288;</code> with all the input arguments and results
as components. As part of the input arguments a component <code>cval</code> is also
presented, containing the critical values for stage&nbsp;1 and 2 according to the
input based on <code>alpha</code>, <code>weight</code> and <code>max.comb.test</code>.<br />
The class <code style="white-space: pre;">&#8288;"evaltsd"&#8288;</code> has an S3 print method.<br /><br />
The results are in the components:
</p>
<table>
<tr><td><code>z1</code></td>
<td>
<p>Combination test statistic for first null hypothesis (standard
combination test statistic in case of <code>max.comb.test = FALSE</code> or
maximum combination test statistic in case of <code>max.comb.test = TRUE</code>)</p>
</td></tr>
<tr><td><code>z2</code></td>
<td>
<p>Combination test statistic for second null hypothesis (standard
combination test statistic in case of <code>max.comb.test = FALSE</code> or
maximum combination test statistic in case of <code>max.comb.test = TRUE</code>)</p>
</td></tr>
<tr><td><code>RCI</code></td>
<td>
<p>Repeated confidence interval for
stage&nbsp;2.</p>
</td></tr>
<tr><td><code>MEUE</code></td>
<td>
<p>Median unbiased point estimate as estimate for the final adjusted
geometric mean ratio after stage 2.</p>
</td></tr>
<tr><td><code>stop_BE</code></td>
<td>
<p>Logical, indicating whether <abbr><span class="acronym">BE</span></abbr> can be concluded after
stage&nbsp;2 or not.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>B. Lang
</p>


<h3>References</h3>

<p>K√∂nig F, Wolfsegger M, Jaki T, Sch√ºtz H, Wassmer G.<br />
<em>Adaptive two-stage bioequivalence trials with early stopping and sample size re-estimation.</em><br />
Vienna: 2014; 35<sup>th</sup> Annual Conference of the International Society for Clinical Biostatistics. Poster P1.2.88 <br />
doi: <a href="https://doi.org/10.13140/RG.2.1.5190.0967">10.13140/RG.2.1.5190.0967</a>.
</p>
<p>Patterson SD, Jones B. <em>Bioequivalence and Statistics in Clinical Pharmacology.</em><br />
Boca Raton: CRC Press; 2<sup>nd</sup> edition 2017.
</p>
<p>Maurer W, Jones B, Chen Y. <em>Controlling the type 1 error rate in two-stage
sequential designs when testing for average bioequivalence.</em><br />
Stat Med. 2018; 37(10): 1587&ndash;1607. doi: <a href="https://doi.org/10.1002/sim.7614">10.1002/sim.7614</a>.
</p>
<p>Wassmer G, Brannath W. <em>Group Sequential and Confirmatory Adaptive Designs
in Clinical Trials.</em><br />
Springer 2016. doi: <a href="https://doi.org/10.1007/978-3-319-32562-0">10.1007/978-3-319-32562-0</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+power.tsd.in">power.tsd.in</a>, <a href="#topic+interim.tsd.in">interim.tsd.in</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example from Maurer et al.
final.tsd.in(GMR1 = exp(0.0424), CV1 = 0.3682, n1 = 20,
             GMR2 = exp(-0.0134), CV2 = 0.3644, n2 = 36)
# Example 2 from Potvin et al.
final.tsd.in(GMR1 = 1.0876, CV1 = 0.18213, n1 = 12,
             GMR2 = 0.9141, CV2 = 0.25618, n2 = 8)
</code></pre>

<hr>
<h2 id='interim.tsd.in'>
Interim analysis of first stage data of 2-stage 2x2 crossover designs based on
the Inverse Normal method
</h2><span id='topic+interim.2stage.in'></span><span id='topic+interim.tsd.in'></span>

<h3>Description</h3>

<p>Following the design scheme according to <code>power.tsd.in</code> the function
performs the interim analysis of the first stage data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>interim.tsd.in(alpha, weight, max.comb.test = TRUE, targetpower = 0.8,
               GMR1, n1, CV1, df1 = NULL, SEM1 = NULL, theta1, theta2,
               GMR, usePE = FALSE, min.n2 = 4, max.n = Inf,
               fCpower = targetpower, fCrit = "CI", fClower, fCupper, fCNmax,
               ssr.conditional = c("error_power", "error", "no"),
               pmethod = c("exact", "nct", "shifted"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="interim.tsd.in_+3A_alpha">alpha</code></td>
<td>

<p>If one element is given, the overall one-sided significance level (not
the adjusted level for stage&nbsp;1). In this
case the adjusted alpha levels will be calcualted internally. If two
elements are given, the argument refers to the two adjusted one-sided
alpha levels for stage&nbsp;1 and
stage&nbsp;2, respectively.<br />
If missing, defaults to <code style="white-space: pre;">&#8288;0.05&#8288;</code>.
</p>
</td></tr>
<tr><td><code id="interim.tsd.in_+3A_weight">weight</code></td>
<td>

<p>Pre-defined weight(s) of stage&nbsp;1, see
'Details' for more information. Note that using the notation from
Maurer et al, weight corresponds to information fraction, other literature
may refer to sqrt(weight) as being the weight. <code style="white-space: pre;">&#8288;weight&#8288;</code> must either
contain one element (in case of <code style="white-space: pre;">&#8288;max.comb.test = FALSE&#8288;</code>) or
two elements (in case of <code style="white-space: pre;">&#8288;max.comb.test = TRUE&#8288;</code>).<br />
If missing, defaults to <code style="white-space: pre;">&#8288;0.5&#8288;</code> for <code style="white-space: pre;">&#8288;max.comb.test = FALSE&#8288;</code> and to
<code style="white-space: pre;">&#8288;c(0.5, 0.25)&#8288;</code> for <code style="white-space: pre;">&#8288;max.comb.test = TRUE&#8288;</code>.
</p>
</td></tr>
<tr><td><code id="interim.tsd.in_+3A_max.comb.test">max.comb.test</code></td>
<td>

<p>Logical; if <code style="white-space: pre;">&#8288;TRUE&#8288;</code> (default) the maximum combination test will be
used, otherwise the standard combination test.
</p>
</td></tr>
<tr><td><code id="interim.tsd.in_+3A_targetpower">targetpower</code></td>
<td>

<p>Desired (overall) target power to declare <abbr><span class="acronym">BE</span></abbr> at the end of the trial.
</p>
</td></tr>
<tr><td><code id="interim.tsd.in_+3A_gmr1">GMR1</code></td>
<td>

<p>Observed ratio of geometric means (T/R) of stage&nbsp;1 data (use <em>e.g.</em>, 0.95 for 95%).
</p>
</td></tr>
<tr><td><code id="interim.tsd.in_+3A_n1">n1</code></td>
<td>

<p>Sample size of stage&nbsp;1.
</p>
</td></tr>
<tr><td><code id="interim.tsd.in_+3A_cv1">CV1</code></td>
<td>

<p>Observed coefficient of variation of the intra-subject variability of
stage&nbsp;1 (use <em>e.g.</em>, 0.3 for 30%).
</p>
</td></tr>
<tr><td><code id="interim.tsd.in_+3A_df1">df1</code></td>
<td>

<p>Optional; Error degrees of freedom of
stage&nbsp;1 that can be specified in
addition to <code>n1</code>.
</p>
</td></tr>
<tr><td><code id="interim.tsd.in_+3A_sem1">SEM1</code></td>
<td>

<p>Optional; Standard error of the difference of means of
stage&nbsp;1 that can be specified in
addition to <code>CV1</code>. Must be on additive scale (i.e. usually log-scale).
</p>
</td></tr>
<tr><td><code id="interim.tsd.in_+3A_theta1">theta1</code></td>
<td>

<p>Lower bioequivalence limit. Defaults to 0.8.
</p>
</td></tr>
<tr><td><code id="interim.tsd.in_+3A_theta2">theta2</code></td>
<td>

<p>Upper bioequivalence limit. Defaults to 1.25.
</p>
</td></tr>
<tr><td><code id="interim.tsd.in_+3A_gmr">GMR</code></td>
<td>

<p>Assumed ratio of geometric means (T/R) to be used in power calculation
for stage&nbsp;1 and sample size re-estimation
for stage&nbsp;2.
</p>
</td></tr>
<tr><td><code id="interim.tsd.in_+3A_usepe">usePE</code></td>
<td>

<p>If <code style="white-space: pre;">&#8288;TRUE&#8288;</code> the sample size re-estimation is done with the observed
point estimate (<abbr><span class="acronym">PE</span></abbr>) of the treatment difference in
stage&nbsp;1.<br />
Defaults to <code style="white-space: pre;">&#8288;FALSE&#8288;</code>.<br />
Note: The power of stage 1 used for the futility inspection and calculation
of the estimated conditional target power is always calculated with the
planning value <code>GMR</code>.
</p>
</td></tr>
<tr><td><code id="interim.tsd.in_+3A_min.n2">min.n2</code></td>
<td>

<p>Minimum sample size of stage&nbsp;2. Defaults to 4.<br />
If the sample size re-estimation step gives a sample size for
stage&nbsp;2 less than <code style="white-space: pre;">&#8288;min.n2&#8288;</code>, then
<code style="white-space: pre;">&#8288;min.n2&#8288;</code> will be used for stage&nbsp;2.
</p>
</td></tr>
<tr><td><code id="interim.tsd.in_+3A_max.n">max.n</code></td>
<td>

<p>Maximum overall sample size stage&nbsp;1 +
stage&nbsp;2.<br />
This is <em>not</em> a futility criterion regarding the maximum sample size! If
<code style="white-space: pre;">&#8288;max.n&#8288;</code> is set to a finite value and the sample size re-estimation gives a
sample size for stage&nbsp;2 (<code style="white-space: pre;">&#8288;n2&#8288;</code>) such
that <code style="white-space: pre;">&#8288;n1 + n2 &gt; max.n&#8288;</code>, then the sample size for
stage&nbsp;2 will be set to <code style="white-space: pre;">&#8288;n2 = max.n - n1&#8288;</code>.<br />
Defaults to <code style="white-space: pre;">&#8288;Inf&#8288;</code>, <em>i.e.</em>, no constraint on the re-estimated sample size.
</p>
</td></tr>
<tr><td><code id="interim.tsd.in_+3A_fcpower">fCpower</code></td>
<td>

<p>Threshold for power monitoring step to decide on futility for cases where
<abbr><span class="acronym">BE</span></abbr> has not been achieved after
stage&nbsp;1: If <abbr><span class="acronym">BE</span></abbr> has not been
achieved after stage&nbsp;1 and the power for
stage&nbsp;1 is greater than or equal to
<code style="white-space: pre;">&#8288;fCpower&#8288;</code>, then the study will be considered a failure.<br /><br />
See &lsquo;Details&rsquo; for more information on the choice of
<code style="white-space: pre;">&#8288;fCpower&#8288;</code>.
</p>
</td></tr>
<tr><td><code id="interim.tsd.in_+3A_fcrit">fCrit</code></td>
<td>

<p>Futility criterion to use: <code style="white-space: pre;">&#8288;"No"&#8288;</code> (no futility criterion regarding
observed point estimate, confidence interval and maximum sample size),
<code style="white-space: pre;">&#8288;"PE"&#8288;</code> (observed point estimate of the geometric mean ratio from
stage&nbsp;1),
<code style="white-space: pre;">&#8288;"CI"&#8288;</code> (90% confidence interval of the geometric mean ratio from
stage&nbsp;1), <code>"Nmax"</code> (overall maximum
sample size); or a combination thereof (concatenate abbreviations).
Defaults to &quot;CI&quot;.
</p>
</td></tr>
<tr><td><code id="interim.tsd.in_+3A_fclower">fClower</code></td>
<td>

<p>Lower futility limit for the <abbr><span class="acronym">PE</span></abbr> or <abbr><span class="acronym">CI</span></abbr> of
stage&nbsp;1.<br />
If the <abbr><span class="acronym">PE</span></abbr> or <abbr><span class="acronym">CI</span></abbr> is completely outside of <code style="white-space: pre;">&#8288;fClower&#8288;</code>
... <code style="white-space: pre;">&#8288;fCupper&#8288;</code> the study is to be stopped due to futility (not <abbr><span class="acronym">BE</span></abbr>).<br />
May be missing. If <code style="white-space: pre;">&#8288;"PE"&#8288;</code> or <code style="white-space: pre;">&#8288;"CI"&#8288;</code> is specified within <code style="white-space: pre;">&#8288;fCrit&#8288;</code>,
the default will be set to 0.8 for <code style="white-space: pre;">&#8288;fCrit = "PE"&#8288;</code> or 0.95 for <code style="white-space: pre;">&#8288;fCrit = "CI"&#8288;</code>.
If neither <code style="white-space: pre;">&#8288;"PE"&#8288;</code> nor <code style="white-space: pre;">&#8288;"CI"&#8288;</code> is specified within <code style="white-space: pre;">&#8288;fCrit&#8288;</code>, there
will be no futility constraint regarding point estimate or confidence interval
from stage&nbsp;1 (regardless of any
specification of <code style="white-space: pre;">&#8288;fClower&#8288;</code> and/or <code style="white-space: pre;">&#8288;fCupper&#8288;</code>).
</p>
</td></tr>
<tr><td><code id="interim.tsd.in_+3A_fcupper">fCupper</code></td>
<td>

<p>Upper futility limit for the <abbr><span class="acronym">PE</span></abbr> or <abbr><span class="acronym">CI</span></abbr> of
stage&nbsp;1.<br />
Analogous to <code style="white-space: pre;">&#8288;fClower&#8288;</code>: Will be set to <code style="white-space: pre;">&#8288;1/fClower&#8288;</code> if missing.
</p>
</td></tr>
<tr><td><code id="interim.tsd.in_+3A_fcnmax">fCNmax</code></td>
<td>

<p>Futility criterion regarding maximum sample size. If the determined sample size
for stage&nbsp;2 (<code style="white-space: pre;">&#8288;n2&#8288;</code>) is such that
<code style="white-space: pre;">&#8288;n1 + n2 &gt; fCNmax&#8288;</code>, the study will not continue to
stage&nbsp;2 and stopped due to futility (not
<abbr><span class="acronym">BE</span></abbr>).<br />
If <code style="white-space: pre;">&#8288;"Nmax"&#8288;</code> is specified within <code style="white-space: pre;">&#8288;fCrit&#8288;</code> and argument <code style="white-space: pre;">&#8288;fCNmax&#8288;</code>
is missing, the value will be set to <code style="white-space: pre;">&#8288;fCNmax = 4*n1&#8288;</code>. If <code style="white-space: pre;">&#8288;"Nmax"&#8288;</code> is
not specified within <code style="white-space: pre;">&#8288;fCrit&#8288;</code>, then there will be no futility constraint
regarding maximum sample size (regardless of any specification of <code style="white-space: pre;">&#8288;fCNmax&#8288;</code>).
</p>
</td></tr>
<tr><td><code id="interim.tsd.in_+3A_ssr.conditional">ssr.conditional</code></td>
<td>

<p>Method for sample size re-estimation step: <code style="white-space: pre;">&#8288;"no"&#8288;</code> does not use
conditional error rates nor the estimated conditional target power for
the second stage, <code style="white-space: pre;">&#8288;"error"&#8288;</code> uses conditional error rates for the
second stage, and <code style="white-space: pre;">&#8288;"error_power"&#8288;</code> uses both conditional error rates
and the estimated conditional target power for the second stage.<br />
Defaults to <code style="white-space: pre;">&#8288;"error_power"&#8288;</code>.<br /><br />
See also &lsquo;Details&rsquo;.
</p>
</td></tr>
<tr><td><code id="interim.tsd.in_+3A_pmethod">pmethod</code></td>
<td>

<p>Power calculation method, also to be used in the sample size estimation for
stage&nbsp;2.<br />
Implemented are <code style="white-space: pre;">&#8288;"nct"&#8288;</code> (approximate calculations via non-central
<em>t</em>-distribution, <code style="white-space: pre;">&#8288;"exact"&#8288;</code> (exact calculations via Owen‚Äôs Q),
and <code style="white-space: pre;">&#8288;"shifted"&#8288;</code> (approximate calculation via shifted central <em>t</em>-distribution
like in the paper of Potvin <em>et al.</em>)<br />
In contrast to <code>power.tsd.in</code> the default value here is <code style="white-space: pre;">&#8288;"exact"&#8288;</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The observed values of stage 1 (e.g. <code>GMR1</code>, <code>n1</code>, <code>CV1</code>) may
be obtained based on the first stage data via the usual ANOVA approach.<br /><br />
The optional arguments <code>df1</code> and <code>SEM1</code> require a somewhat
advanced knowledge (provided in the raw output from for example the software
<abbr><span class="acronym">SAS</span></abbr>, or may be obtained via <code>emmeans::emmeans</code>).
However, it has the advantage that if there were missing data the exact
degrees of freedom and standard error of the difference can be used,
the former possibly being non-integer valued (e.g. if the
Kenward-Roger method was used).<br /><br />
The <code>weight</code> argument always refers to the first weight of a pair of
weights. For example, in case of <code>max.comb.test = FALSE</code> the standard
combination test requires two weights (w, 1-w) but only the first one, w,
is required as input argument here because the second weight is
automatically specified once the first is given. Similarly for
<code>max.comb.test = TRUE</code>, w and w* need to be specified, which in turn
define the two pairs of weights (w, 1-w) and (w*, 1-w*).<br /><br />
If <code style="white-space: pre;">&#8288;ssr.conditional = "error_power"&#8288;</code>, the design scheme generally
calculates the estimated conditional target power of the second stage and
uses this value as desired target power in the sample size re-estimation process:<br />
If <code>fCpower</code> &gt; <code>targetpower</code>, then the conditional estimated
target power may be negative. This does not seem sensible. Therefore, for such
cases the desired target power for the sample size re-calculation will be set
to <code>targetpower</code>, i.e. <code>ssr.conditional</code> will be set to <code>"error"</code>.<br />
Also, if the futility criterion based on the power of stage 1 is met,
then the conditional estimated target power will be negative. Thus, no further
sample size calculation can be made. To acknowledge that this rule is nonbinding,
for the purpose of calculating n2 the argument <code>ssr.conditional</code> is set
to <code>"error"</code>.
</p>


<h3>Value</h3>

<p>Returns an object of class <code style="white-space: pre;">&#8288;"evaltsd"&#8288;</code> with all the input arguments and results
as components. As part of the input arguments a component <code>cval</code> is also
presented, containing the critical values for
stage&nbsp;1 and 2 according to the
input based on <code>alpha</code>, <code>weight</code> and <code>max.comb.test</code>.<br />
The class <code style="white-space: pre;">&#8288;"evaltsd"&#8288;</code> has an S3 print method.<br /><br />
The results are in the components:
</p>
<table>
<tr><td><code>p11</code></td>
<td>
<p>Observed p-value for first hypothesis.</p>
</td></tr>
<tr><td><code>p12</code></td>
<td>
<p>Observed p-value for second hypothesis.</p>
</td></tr>
<tr><td><code>z1</code></td>
<td>
<p>z statistic value for first null hypothesis.</p>
</td></tr>
<tr><td><code>z2</code></td>
<td>
<p>z statistic value for second null hypothesis.</p>
</td></tr>
<tr><td><code>RCI</code></td>
<td>
<p>Repeated confidence interval for stage&nbsp;1. Corresponds to the usual CI with level alpha1.</p>
</td></tr>
<tr><td><code>MEUE</code></td>
<td>
<p>If the study stops, the median unbiased point estimate as estimate for the final adjusted
geometric mean ratio after stage 1 (note that the value is identical to <code>GMR1</code>.)</p>
</td></tr>
<tr><td><code>futility</code></td>
<td>
<p>Three dimensional vector with either 0 or 1. The first
component represents futility due to Power of first stage &gt; <code>fCpower</code>,
the second futility due to <code style="white-space: pre;">&#8288;CI&#8288;</code> (or <code style="white-space: pre;">&#8288;PE&#8288;</code>) outside of
<code>fClower ... fCupper</code>, the third futility due to
<code>n1 + n2 &gt; fCNmax</code>.<br />
Note that the futility rules can be applied in a non-binding manner.</p>
</td></tr>
<tr><td><code>CI90</code></td>
<td>
<p>90% Confidence interval for observed ratio of geometric means
from stage&nbsp;1. If <code style="white-space: pre;">&#8288;fCrit != "CI"&#8288;</code> result will be <code>NULL</code>.</p>
</td></tr>
<tr><td><code>Power Stage 1</code></td>
<td>
<p>Calculated power of stage&nbsp;1.</p>
</td></tr>
<tr><td><code>stop_s1</code></td>
<td>
<p>Logical, indicating whether to stop after stage&nbsp;1
(due to <abbr><span class="acronym">BE</span></abbr> or due to futility).</p>
</td></tr>
<tr><td><code>stop_fut</code></td>
<td>
<p>Logical, indicating whether study is recommended to be stopped after
stage&nbsp;1
due to futility.</p>
</td></tr>
<tr><td><code>stop_BE</code></td>
<td>
<p>Logical, indicating whether <abbr><span class="acronym">BE</span></abbr> could be concluded after
stage&nbsp;1 or not (regardless of any
futility criterion).</p>
</td></tr>
<tr><td><code>n2</code></td>
<td>
<p>Required (total) sample size for stage&nbsp;2
(will be zero if <abbr><span class="acronym">BE</span></abbr> has been shown after
stage&nbsp;1).</p>
</td></tr>
<tr><td><code>alpha_ssr</code></td>
<td>
<p>Only applicable if <abbr><span class="acronym">BE</span></abbr> has not been shown after
stage&nbsp;1. Contains
alpha values for the two hypotheses required for sample size re-calculation.
If <code>ssr.conditional = "no"</code> the result is equal to <code>alpha</code>,
otherwise it contains the conditional error rates for the standard combination
test (in case of <code>max.comb.test = FALSE</code>) or maximum combination test (in
case of <code>max.comb.test = TRUE</code>).</p>
</td></tr>
<tr><td><code>GMR_ssr</code></td>
<td>
<p>Only applicable if <abbr><span class="acronym">BE</span></abbr> has not been shown after
stage&nbsp;1. Contains the
geometric mean ratio used for sample size re-calculation (accounts for
adaptive planning step).</p>
</td></tr>
<tr><td><code>targetpower_ssr</code></td>
<td>
<p>Only applicable if <abbr><span class="acronym">BE</span></abbr> has not been shown after
stage&nbsp;1. Contains the target power used
for the sample size re-calculation (see also 'Details').</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>B. Lang
</p>


<h3>References</h3>

<p>K√∂nig F, Wolfsegger M, Jaki T, Sch√ºtz H, Wassmer G.<br />
<em>Adaptive two-stage bioequivalence trials with early stopping and sample size re-estimation.</em><br />
Vienna: 2014; 35<sup>th</sup> Annual Conference of the International Society for Clinical Biostatistics. Poster P1.2.88 <br />
doi: <a href="https://doi.org/10.13140/RG.2.1.5190.0967">10.13140/RG.2.1.5190.0967</a>.
</p>
<p>Patterson SD, Jones B. <em>Bioequivalence and Statistics in Clinical Pharmacology.</em><br />
Boca Raton: CRC Press; 2<sup>nd</sup> edition 2017.
</p>
<p>Maurer W, Jones B, Chen Y. <em>Controlling the type 1 error rate in two-stage
sequential designs when testing for average bioequivalence.</em><br />
Stat Med. 2018; 37(10): 1587&ndash;1607. doi: <a href="https://doi.org/10.1002/sim.7614">10.1002/sim.7614</a>.
</p>
<p>Wassmer G, Brannath W. <em>Group Sequential and Confirmatory Adaptive Designs
in Clinical Trials.</em><br />
Springer 2016. doi: <a href="https://doi.org/10.1007/978-3-319-32562-0">10.1007/978-3-319-32562-0</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+power.tsd.in">power.tsd.in</a>, <a href="#topic+final.tsd.in">final.tsd.in</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example from Maurer et al.
interim.tsd.in(GMR = 0.95, max.n = 4000,
               GMR1 = exp(0.0424), CV1 = 0.3682, n1 = 20)
# Example 2 from Potvin et al.
interim.tsd.in(GMR = 0.95, GMR1 = 1.0876, CV1 = 0.18213, n1 = 12,
               fCrit = "No", ssr.conditional = "no")
</code></pre>

<hr>
<h2 id='power.tsd'>
Power calculation of adaptive 2-stage BE studies in a 2x2 crossover design
</h2><span id='topic+power.2stage'></span><span id='topic+power.tsd'></span>

<h3>Description</h3>

<p>This function calculates the &lsquo;empiric&rsquo; power of 2-stage BE studies according
to Potvin <em>et al.</em> via simulations. The Potvin methods are modified to include
a futility criterion Nmax and to allow the sample size estimation step to be
done with the point estimate (<abbr><span class="acronym">PE</span></abbr>) and <abbr><span class="acronym">MSE</span></abbr> (calculated from CV)
of stage&nbsp;1.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>power.tsd(method = c("B", "C", "B0"), alpha0 = 0.05, alpha = c(0.0294, 0.0294), 
          n1, GMR, CV, targetpower = 0.8, pmethod = c("nct", "exact", "shifted"),
          usePE = FALSE, Nmax = Inf, min.n2 = 0, theta0, theta1, theta2,
          npct = c(0.05, 0.5, 0.95), nsims, setseed = TRUE, details = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="power.tsd_+3A_method">method</code></td>
<td>

<p>Decision schemes according to Potvin <em>et.al.</em> (defaults to <code style="white-space: pre;">&#8288;"B"&#8288;</code>).<br />
Potvin‚Äôs &lsquo;Method D&rsquo; can be obtained by choosing <code style="white-space: pre;">&#8288;"C"&#8288;</code> but setting
<code style="white-space: pre;">&#8288;alpha=c(0.028, 0.028)&#8288;</code>.<br />
Montague‚Äôs &lsquo;Method D&rsquo; can be obtained by choosing <code style="white-space: pre;">&#8288;"C"&#8288;</code> but setting
<code style="white-space: pre;">&#8288;alpha=c(0.028, 0.028)&#8288;</code> and <code style="white-space: pre;">&#8288;GMR=0.9&#8288;</code>.<br />
<code style="white-space: pre;">&#8288;method="B0"&#8288;</code> uses the decision scheme of Zheng <em>et al.</em> <abbr><span class="acronym">MSDBE</span></abbr>
(modified sequential design for <abbr><span class="acronym">B</span></abbr>E studies) which differs from B in case
of different alphas w.r.t. power monitoring and BE decision in case of power
&gt;= target power.
</p>
</td></tr>
<tr><td><code id="power.tsd_+3A_alpha0">alpha0</code></td>
<td>

<p>Alpha value for the first step(s) in Potvin <code style="white-space: pre;">&#8288;"C"&#8288;</code>, the power inspection
and BE decision if power &gt; targetpower. Defaults to 0.05.<br />
Only observed if <code style="white-space: pre;">&#8288;method="C"&#8288;</code>.
</p>
</td></tr>
<tr><td><code id="power.tsd_+3A_alpha">alpha</code></td>
<td>

<p>Vector (two elements) of the nominal alphas for the two stages. Defaults to
Pocock‚Äôs setting <code style="white-space: pre;">&#8288;alpha=c(0.0294, 0.0294)&#8288;</code>.<br />
Common values together with other arguments are:<br />
<code style="white-space: pre;">&#8288;rep(0.0294, 2)&#8288;</code>: Potvin <em>et al.</em> &lsquo;Method B&rsquo;<br />
<code style="white-space: pre;">&#8288;rep(0.0269, 2)&#8288;</code>: Fulgsang &lsquo;Method C/D&rsquo; <code style="white-space: pre;">&#8288;(method="C", GMR=0.9, targetpower=0.9)&#8288;</code><br />
<code style="white-space: pre;">&#8288;rep(0.0274, 2)&#8288;</code>: Fuglsang &lsquo;Method C/D&rsquo; <code style="white-space: pre;">&#8288;(method="C", targetpower=0.9)&#8288;</code><br />
<code style="white-space: pre;">&#8288;rep(0.0280, 2)&#8288;</code>: Montague <em>et al.</em> &lsquo;Method D&rsquo; <code style="white-space: pre;">&#8288;(method="C", GMR=0.9)&#8288;</code><br />
<code style="white-space: pre;">&#8288;rep(0.0284, 2)&#8288;</code>: Fulgsang &lsquo;Method B&rsquo; <code style="white-space: pre;">&#8288;(GMR=0.9, targetpower=0.9)&#8288;</code><br />
<code style="white-space: pre;">&#8288;rep(0.0304, 2)&#8288;</code>: Kieser &amp; Rauch<br />
<code style="white-space: pre;">&#8288;c(0.01, 0.04)&#8288;</code>: Zheng <em>et al.</em> &lsquo;MSDBE&rsquo; <code style="white-space: pre;">&#8288;(method="B0")&#8288;</code>
</p>
</td></tr>
<tr><td><code id="power.tsd_+3A_n1">n1</code></td>
<td>

<p>Sample size of stage&nbsp;1.
</p>
</td></tr>
<tr><td><code id="power.tsd_+3A_gmr">GMR</code></td>
<td>

<p>Ratio T/R to be used in decision scheme (power calculations in
stage&nbsp;1 and sample size estimation for
stage&nbsp;2).
</p>
</td></tr>
<tr><td><code id="power.tsd_+3A_cv">CV</code></td>
<td>

<p>Coefficient of variation of the intra-subject variability
(use <em>e.g.</em>, 0.3 for 30%).
</p>
</td></tr>
<tr><td><code id="power.tsd_+3A_targetpower">targetpower</code></td>
<td>

<p>Power threshold in the power monitoring steps and power to achieve
in the sample size estimation step.
</p>
</td></tr>
<tr><td><code id="power.tsd_+3A_pmethod">pmethod</code></td>
<td>

<p>Power calculation method, also to be used in the sample size estimation for
stage&nbsp;2.<br />
Implemented are <code style="white-space: pre;">&#8288;"nct"&#8288;</code> (approximate calculations via non-central
<em>t</em>-distribution, <code style="white-space: pre;">&#8288;"exact"&#8288;</code> (exact calculations via Owen‚Äôs Q),
and <code style="white-space: pre;">&#8288;"shifted"&#8288;</code> (approximate calculation via shifted central <em>t</em>-distribution
like in the paper of Potvin <em>et al.</em><br />
Defaults to <code style="white-space: pre;">&#8288;"nct"&#8288;</code> as a reasonable compromise between speed and
accuracy in the sample size estimation step.
</p>
</td></tr>
<tr><td><code id="power.tsd_+3A_usepe">usePE</code></td>
<td>

<p>If <code style="white-space: pre;">&#8288;TRUE&#8288;</code> the sample size estimation step is done with <abbr><span class="acronym">MSE</span></abbr>
<b>and</b> <abbr><span class="acronym">PE</span></abbr> of stage&nbsp;1.<br />
Defaults to <code>FALSE</code> <em>i.e.</em>, the sample size is estimated with
<code style="white-space: pre;">&#8288;GMR&#8288;</code> and <abbr><span class="acronym">MSE</span></abbr> (calculated from <code style="white-space: pre;">&#8288;CV&#8288;</code>) of
stage&nbsp;1 analogous to Potvin <em>et. al</em>.<br />
NB: The power inspection steps in the Potvin methods are always done with the
<code style="white-space: pre;">&#8288;GMR&#8288;</code> argument and <abbr><span class="acronym">MSE</span></abbr> (<code style="white-space: pre;">&#8288;CV&#8288;</code>) of
stage&nbsp;1.
</p>
</td></tr>
<tr><td><code id="power.tsd_+3A_nmax">Nmax</code></td>
<td>

<p>Futility criterion. If set to a finite value, all studies simulated in which a
sample size <code style="white-space: pre;">&#8288;&gt;Nmax&#8288;</code> is obtained will be regarded as BE=FAIL.<br />
Set this argument to <code style="white-space: pre;">&#8288;Inf&#8288;</code>, the default, to work without that futility
criterion.
</p>
</td></tr>
<tr><td><code id="power.tsd_+3A_min.n2">min.n2</code></td>
<td>

<p>Minimum sample size of stage&nbsp;2. Defaults to zero.<br />
If the sample size estimation step gives <code style="white-space: pre;">&#8288;N &lt; n1+min.n2&#8288;</code> the sample size for
stage&nbsp;2 will be forced to <code style="white-space: pre;">&#8288;min.n2&#8288;</code>,
<em>i.e.</em>, the total sample size to <code>n1+min.n2</code>.
</p>
</td></tr>
<tr><td><code id="power.tsd_+3A_theta0">theta0</code></td>
<td>

<p>True ratio of T/R for simulating. Defaults to the <code>GMR</code> argument if missing.
</p>
</td></tr>
<tr><td><code id="power.tsd_+3A_theta1">theta1</code></td>
<td>

<p>Lower bioequivalence limit. Defaults to 0.8.
</p>
</td></tr>
<tr><td><code id="power.tsd_+3A_theta2">theta2</code></td>
<td>

<p>Upper bioequivalence limit. Defaults to 1.25.
</p>
</td></tr>
<tr><td><code id="power.tsd_+3A_npct">npct</code></td>
<td>

<p>Percentiles to be used for the presentation of the distribution of
<code style="white-space: pre;">&#8288;n(total)=n1+n2&#8288;</code>.<br />
Defaults to <code style="white-space: pre;">&#8288;c(0.05, 0.5, 0.95)&#8288;</code> to obtain the 5% and 95% percentiles
and the median.
</p>
</td></tr>
<tr><td><code id="power.tsd_+3A_nsims">nsims</code></td>
<td>

<p>Number of studies to simulate.<br />
If missing, <code style="white-space: pre;">&#8288;nsims&#8288;</code> is set to 1E+05 = 100,000 or to 1E+06 = 1 Mio if
estimating the empiric Type I Error (<code style="white-space: pre;">&#8288;'alpha'&#8288;</code>), <em>i.e.</em>, with <code style="white-space: pre;">&#8288;theta0&#8288;</code> at
the border or outside the acceptance range <code style="white-space: pre;">&#8288;theta1&#8288;</code> ... <code style="white-space: pre;">&#8288;theta2&#8288;</code>.
</p>
</td></tr>
<tr><td><code id="power.tsd_+3A_setseed">setseed</code></td>
<td>

<p>Simulations are dependent on the starting point of the (pseudo) random number
generator. To avoid differences in power for different runs a
<code>set.seed(1234567)</code> is issued if <code style="white-space: pre;">&#8288;setseed=TRUE&#8288;</code>, the default.<br />
Set this argument to <code style="white-space: pre;">&#8288;FALSE&#8288;</code> to view the variation in power between
different runs.
</p>
</td></tr>
<tr><td><code id="power.tsd_+3A_details">details</code></td>
<td>

<p>If set to <code style="white-space: pre;">&#8288;TRUE&#8288;</code> the function prints the results of time measurements
of the simulation steps. Defaults to <code style="white-space: pre;">&#8288;FALSE&#8288;</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The calculations follow in principle the simulations as described in Potvin
<em>et al</em>.<br />
The underlying subject data are assumed to be evaluated after log-transformation.
But instead of simulating subject data, the statistics pe1, mse1 and pe2, SS2 are
simulated via their associated distributions (normal and
&chi;<sup>2</sup> distributions).
</p>


<h3>Value</h3>

<p>Returns an object of class <code style="white-space: pre;">&#8288;"pwrtsd"&#8288;</code> with all the input arguments and results
as components.<br />
The class <code style="white-space: pre;">&#8288;"pwrtsd"&#8288;</code>&quot; has an S3 print method.<br />
The results are in the components:
</p>
<table>
<tr><td><code>pBE</code></td>
<td>
<p>Fraction of studies found BE.</p>
</td></tr>
<tr><td><code>pBE_s1</code></td>
<td>
<p>Fraction of studies found BE in stage&nbsp;1.</p>
</td></tr>
<tr><td><code>pct_s2</code></td>
<td>
<p>Percentage of studies continuing to stage&nbsp;2.</p>
</td></tr>
<tr><td><code>nmean</code></td>
<td>
<p>Mean of n(total), aka average total sample size (<abbr><span class="acronym">ASN</span></abbr>).</p>
</td></tr>
<tr><td><code>nrange</code></td>
<td>
<p>Range (min, max) of n(total).</p>
</td></tr>
<tr><td><code>nperc</code></td>
<td>
<p>Vector of percentiles of the distribution of n(total).</p>
</td></tr>
<tr><td><code>ntable</code></td>
<td>
<p>Object of class <code style="white-space: pre;">&#8288;"table"&#8288;</code> summarizing the discrete distribution of
n(total) via its distinct values and counts of occurences of these values.<br />
This component is only given back if <code style="white-space: pre;">&#8288;usePE==FALSE&#8288;</code> or otherwise if
<code style="white-space: pre;">&#8288;is.finite(Nmax)&#8288;</code>, <em>i.e.</em>, a futility criterion is used.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>D. Labes
</p>


<h3>References</h3>

<p>Potvin D, DiLiberti CE, Hauck WW, Parr AF, Schuirmann DJ, Smith RA. <em>Sequential design approaches for bioequivalence studies with crossover designs.</em><br />
Pharm Stat. 2008; 7(4):245&ndash;62. doi: <a href="https://doi.org/10.1002/pst.294">10.1002/pst.294</a>
</p>
<p>Montague TH, Potvin D, DiLiberti CE, Hauck WW, Parr AF, Schuirmann DJ. <em>Additional results for &lsquo;Sequential design approaches for bioequivalence studies with crossover designs&rsquo;.</em><br />
Pharm Stat. 2011; 11(1):8&ndash;13. doi: <a href="https://doi.org/10.1002/pst.483">10.1002/pst.483</a>
</p>
<p>Fuglsang A. <em>Controlling type I errors for two-stage bioequivalence study designs.</em><br />
Clin Res Reg Aff. 2011; 28(4):100&ndash;5. doi: <a href="https://doi.org/10.3109/10601333.2011.631547">10.3109/10601333.2011.631547</a>
</p>
<p>Fuglsang A. <em>Sequential Bioequivalence Trial Designs with Increased Power and
Controlled Type I Error Rates.</em><br />
AAPS J. 2013; 15(3):659&ndash;61. doi: <a href="https://doi.org/10.1208/s12248-013-9475-5">10.1208/s12248-013-9475-5</a>
</p>
<p>Fuglsang A. <em>Futility Rules in Bioequivalence Trials with Sequential Designs.</em><br />
AAPS J. 2014; 16(1):79&ndash;82. doi: <a href="https://doi.org/10.1208/s12248-013-9540-0">10.1208/s12248-013-9540-0</a>
</p>
<p>Sch√ºtz H. <em>Two-stage designs in bioequivalence trials.</em><br />
Eur J Clin Pharmacol. 2015; 71(3):271&ndash;81. doi: <a href="https://doi.org/10.1007/s00228-015-1806-2">10.1007/s00228-015-1806-2</a>
</p>
<p>Kieser M, Rauch G. <em>Two-stage designs for cross-over bioequivalence trials.</em><br />
Stat Med. 2015; 34(16):2403&ndash;16. doi: <a href="https://doi.org/10.1002/sim.6487">10.1002/sim.6487</a>
</p>
<p>Zheng Ch, Zhao L, Wang J. <em>Modifications of sequential designs in bioequivalence trials.</em><br />
Pharm Stat. 2015; 14(3):180&ndash;8. doi: <a href="https://doi.org/10.1002/pst.1672">10.1002/pst.1672</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+power.tsd.p">power.tsd.p</a></code> for analogous calculations for 2-group parallel
design.<br />
<code><a href="#topic+power.tsd.fC">power.tsd.fC</a></code> for analogous calculations with futility check
based on point estimate of stage 1.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># using all the defaults and 24 subjects in stage 1, CV of 25%
power.tsd(n1=24, CV=0.25)
# computation time ~ 1 sec
#
# as above, but save results for further use
res &lt;- power.tsd(n1=24, CV=0.25)
## Not run: 
# representation of the discrete distribution of n(total)
# via plot method of object with class "table" which creates a
# 'needle' plot
plot(res$ntable/sum(res$ntable), ylab="Density",
     xlab=expression("n"[total]), las=1,
     main=expression("Distribution of n"[total]))
#
# If you prefer a histogram instead (IMHO, not the preferred plot):
# reconstruct the ntotal values from the ntable
ntot &lt;- rep.int(as.integer(names(res$ntable)),
                times=as.integer(res$ntable))
# annotated histogram
hist(ntot, freq=FALSE, breaks=res$nrange[2]-res$nrange[1],
     xlab=expression("n"[total]), las=1,
     main=expression("Histogram of n"[total]))
abline(v=c(res$nmean, res$nperc[["50%"]]), lty=c(1, 3))
legend("topright", box.lty=0, legend=c("mean", "median"),
       lty=c(1, 3), cex=0.9)
## End(Not run)
</code></pre>

<hr>
<h2 id='power.tsd.fC'>
Power calculation of adaptive 2-stage BE studies (2x2 crossover) with a
futility criterion for the point estimate of T/R or its 90% CI
</h2><span id='topic+power.tsd.fC'></span><span id='topic+power.2stage.fC'></span>

<h3>Description</h3>

<p>This function calculates the &lsquo;empiric&rsquo; power of 2-stage BE studies according
to Potvin <em>et al.</em> &lsquo;method B/C&rsquo; via simulations. The Potvin methods are
modified to include a futility criterion for the point estimate or for its
90%CI and to allow the sample size estimation step to be done with the point
estimate (<abbr><span class="acronym">PE</span></abbr>) and <abbr><span class="acronym">MSE</span></abbr> of stage&nbsp;1.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>power.tsd.fC(method = c("B", "C", "B0"), alpha0 = 0.05, alpha = c(0.0294, 0.0294),
             n1, CV, GMR, targetpower = 0.8, pmethod = c("nct", "exact", "shifted"),
             usePE = FALSE, powerstep = TRUE, min.n2=0, max.n=Inf,
             fCrit=c("CI", "PE"), fClower, fCupper, theta0, theta1, theta2,
             npct = c(0.05, 0.5, 0.95), nsims, setseed = TRUE, details = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="power.tsd.fC_+3A_method">method</code></td>
<td>

<p>Decision schemes according to Potvin <em>et.al.</em> (defaults to <code style="white-space: pre;">&#8288;"B"&#8288;</code>).<br />
Montague‚Äôs &lsquo;Method D&rsquo; can be obtained by choosing <code style="white-space: pre;">&#8288;"C"&#8288;</code> but setting
<code style="white-space: pre;">&#8288;alpha=c(0.028, 0.028)&#8288;</code>.<br />
&lsquo;Method E&rsquo; of Xu <em>et al.</em> can be obtained by choosing <code style="white-space: pre;">&#8288;"B"&#8288;</code> and setting alphas,
futility criterion <code style="white-space: pre;">&#8288;"CI"&#8288;</code>, <code style="white-space: pre;">&#8288;max.n&#8288;</code>, and <code style="white-space: pre;">&#8288;n1&#8288;</code> according to the reference.<br />
&lsquo;Method F&rsquo; can be obtained choosing <code style="white-space: pre;">&#8288;"C"&#8288;</code> with the appropriate design setting
according to the reference.<br />
<code style="white-space: pre;">&#8288;method="B0"&#8288;</code> uses the decision scheme of Zheng <em>et al.</em> <abbr><span class="acronym">MSDBE</span></abbr>
(modified sequential design for <abbr><span class="acronym">B</span></abbr>E studies) which differs from B in case
of different alphas w.r.t. power monitoring and BE decision in case of power
&gt;= target power.
</p>
</td></tr>
<tr><td><code id="power.tsd.fC_+3A_alpha0">alpha0</code></td>
<td>

<p>Alpha value for the first step(s) in Potvin <code style="white-space: pre;">&#8288;"C"&#8288;</code>, the power inspection
and BE decision if power &gt; targetpower. Defaults to 0.05.<br />
Only observed if <code style="white-space: pre;">&#8288;method="C"&#8288;</code>
</p>
</td></tr>
<tr><td><code id="power.tsd.fC_+3A_alpha">alpha</code></td>
<td>

<p>Vector (two elements) of the nominal alphas for the two stages. Defaults to
Pocock‚Äôs setting <code style="white-space: pre;">&#8288;alpha=c(0.0294, 0.0294)&#8288;</code>.<br />
Common values together with other arguments are:<br />
<code style="white-space: pre;">&#8288;rep(0.0294, 2)&#8288;</code>: Potvin <em>et al.</em> &lsquo;Method B&rsquo; <code style="white-space: pre;">&#8288;(fCrit="CI", fCupper=Inf)&#8288;</code><br />
<code style="white-space: pre;">&#8288;rep(0.0269, 2)&#8288;</code>: Fulgsang &lsquo;Method C/D&rsquo; <code style="white-space: pre;">&#8288;(method="C", GMR=0.9, targetpower=0.9, fCrit="CI", fCupper=Inf)&#8288;</code><br />
<code style="white-space: pre;">&#8288;rep(0.0274, 2)&#8288;</code>: Fuglsang &lsquo;Method C/D&rsquo; <code style="white-space: pre;">&#8288;(method="C", targetpower=0.9, fCrit="CI", fCupper=Inf)&#8288;</code><br />
<code style="white-space: pre;">&#8288;rep(0.0280, 2)&#8288;</code>: Montague <em>et al.</em> &lsquo;Method D&rsquo; <code style="white-space: pre;">&#8288;(method="C", GMR=0.9, fCrit="CI", fCupper=Inf)&#8288;</code><br />
<code style="white-space: pre;">&#8288;rep(0.0284, 2)&#8288;</code>: Fulgsang &lsquo;Method B&rsquo; <code style="white-space: pre;">&#8288;(GMR=0.9, targetpower=0.9, fCrit="CI", fCupper=Inf)&#8288;</code><br />
<code style="white-space: pre;">&#8288;rep(0.0304, 2)&#8288;</code>: Kieser &amp; Rauch <code style="white-space: pre;">&#8288;(fCrit="CI", fCupper=Inf)&#8288;</code><br />
<code style="white-space: pre;">&#8288;c(0.01, 0.04)&#8288;</code>: Zheng <em>et al.</em> &lsquo;MSDBE&rsquo; <code style="white-space: pre;">&#8288;(method="B0", fCrit="CI", fCupper=Inf)&#8288;</code><br />
<code style="white-space: pre;">&#8288;c(0.0249, 0.0357)&#8288;</code>: Xu <em>et al.</em> &lsquo;Method E&rsquo; for CV 10&ndash;30% <code style="white-space: pre;">&#8288;(fCrit="CI", fClower=0.9374, max.n=42)&#8288;</code><br />
<code style="white-space: pre;">&#8288;c(0.0254, 0.0363)&#8288;</code>: Xu <em>et al.</em> &lsquo;Method E&rsquo; for CV 30&ndash;55% <code style="white-space: pre;">&#8288;(fCrit="CI", fClower=0.9305, max.n=42)&#8288;</code><br />
<code style="white-space: pre;">&#8288;c(0.0248, 0.0364)&#8288;</code>: Xu <em>et al.</em> &lsquo;Method F&rsquo; for CV 10&ndash;30% <code style="white-space: pre;">&#8288;(method="C", fCrit="CI", fClower=0.9492, max.n=180)&#8288;</code><br />
<code style="white-space: pre;">&#8288;c(0.0259, 0.0349)&#8288;</code>: Xu <em>et al.</em> &lsquo;Method F&rsquo; for CV 30&ndash;55% <code style="white-space: pre;">&#8288;(method="C", fCrit="CI", fClower=0.9350, max.n=180)&#8288;</code>
</p>
</td></tr>
<tr><td><code id="power.tsd.fC_+3A_n1">n1</code></td>
<td>

<p>Sample size of stage&nbsp;1. For Xu‚Äôs
methods the recommended sample size should be at least 18 (if CV 10&ndash;30%) or
48 (if CV 30&ndash;55%).
</p>
</td></tr>
<tr><td><code id="power.tsd.fC_+3A_cv">CV</code></td>
<td>

<p>Coefficient of variation of the intra-subject variability
(use <em>e.g.</em>, 0.3 for 30%).
</p>
</td></tr>
<tr><td><code id="power.tsd.fC_+3A_gmr">GMR</code></td>
<td>

<p>Ratio T/R to be used in decision scheme (power calculations in
stage&nbsp;1 and sample size estimation for
stage&nbsp;2).
</p>
</td></tr>
<tr><td><code id="power.tsd.fC_+3A_targetpower">targetpower</code></td>
<td>

<p>Power threshold in the power monitoring steps and
power to achieve in the sample size estimation step.
</p>
</td></tr>
<tr><td><code id="power.tsd.fC_+3A_pmethod">pmethod</code></td>
<td>

<p>Power calculation method, also to be used in the sample size estimation for
stage&nbsp;2.<br />
Implemented are <code style="white-space: pre;">&#8288;"nct"&#8288;</code> (approximate calculations via non-central
<em>t</em>-distribution, <code style="white-space: pre;">&#8288;"exact"&#8288;</code> (exact calculations via Owen‚Äôs Q),
and <code style="white-space: pre;">&#8288;"shifted"&#8288;</code> (approximate calculation via shifted central <em>t</em>-distribution
like in the paper of Potvin <em>et al.</em><br />
Defaults to <code style="white-space: pre;">&#8288;"nct"&#8288;</code> as a reasonable compromise between speed and
accuracy in the sample size estimation step.
</p>
</td></tr>
<tr><td><code id="power.tsd.fC_+3A_usepe">usePE</code></td>
<td>

<p>If <code style="white-space: pre;">&#8288;TRUE&#8288;</code> the sample size estimation step is done with <abbr><span class="acronym">MSE</span></abbr>
<b>and</b> PE of stage&nbsp;1.<br />
Defaults to <code style="white-space: pre;">&#8288;FALSE&#8288;</code>, <em>i.e.</em>, the sample size is estimated with anticipated
(fixed) <code style="white-space: pre;">&#8288;GMR&#8288;</code> given as argument and <abbr><span class="acronym">MSE</span></abbr> of
stage&nbsp;1 (analogous to Potvin <em>et. al.</em>).
</p>
</td></tr>
<tr><td><code id="power.tsd.fC_+3A_powerstep">powerstep</code></td>
<td>

<p>If <code style="white-space: pre;">&#8288;TRUE&#8288;</code> (the default) the interim power monitoring step in
stage&nbsp;1 evaluation of &lsquo;method B&rsquo;
will be done as described in Potvin <em>et.al.</em><br />
Setting this argument to <code style="white-space: pre;">&#8288;FALSE&#8288;</code> will omit this step.<br />
Has no effect if <code style="white-space: pre;">&#8288;method="C"&#8288;</code> is choosen.
</p>
</td></tr>
<tr><td><code id="power.tsd.fC_+3A_min.n2">min.n2</code></td>
<td>

<p>Minimum sample size of stage&nbsp;2. Defaults to zero.<br />
If the sample size estimation step gives <code style="white-space: pre;">&#8288;N &lt; n1+min.n2&#8288;</code> the sample size for
stage&nbsp;2 will be forced to <code style="white-space: pre;">&#8288;min.n2&#8288;</code>,
<em>i.e.</em>, the total sample size to <code>n1+min.n2</code>.
</p>
</td></tr>
<tr><td><code id="power.tsd.fC_+3A_max.n">max.n</code></td>
<td>

<p>If <code style="white-space: pre;">&#8288;max.n&#8288;</code> is set to a finite value the re-estimated total sample size (N) is
set to <code>min(max.n, N)</code>.<br />
Defaults to <code style="white-space: pre;">&#8288;Inf&#8288;</code> which is equivalent to not constrain the re-estimated sample size.<br />
Attention! <code style="white-space: pre;">&#8288;max.n&#8288;</code> here is <b>not</b> a futility criterion like <code style="white-space: pre;">&#8288;Nmax&#8288;</code>
in other functions of this package.
</p>
</td></tr>
<tr><td><code id="power.tsd.fC_+3A_fcrit">fCrit</code></td>
<td>

<p>Futility criterion.<br />
If set to <code style="white-space: pre;">&#8288;"PE"&#8288;</code> the study stops after
stage&nbsp;1 if not <abbr><span class="acronym">BE</span></abbr> and if the point
estimate (<abbr><span class="acronym">PE</span></abbr>) of stage&nbsp;1 evaluation
is outside the range defined in the next two  arguments <code style="white-space: pre;">&#8288;"fClower"&#8288;</code> and
<code style="white-space: pre;">&#8288;"fCupper"&#8288;</code>.<br />
If set to <code style="white-space: pre;">&#8288;"CI"&#8288;</code> the study stops after stage&nbsp;1
if not <abbr><span class="acronym">BE</span></abbr> and if the confidence interval of
stage&nbsp;1 evaluation is outside the range
defined in the next two arguments.<br />
Defaults to <code style="white-space: pre;">&#8288;"PE"&#8288;</code>.
Futility criterion to use for <code style="white-space: pre;">&#8288;PE&#8288;</code> or <code style="white-space: pre;">&#8288;CI&#8288;</code>.
</p>
</td></tr>
<tr><td><code id="power.tsd.fC_+3A_fclower">fClower</code></td>
<td>

<p>Lower futility limit for the <code style="white-space: pre;">&#8288;PE&#8288;</code> or <code style="white-space: pre;">&#8288;CI&#8288;</code> of
stage&nbsp;1.<br />
If the <code style="white-space: pre;">&#8288;PE&#8288;</code> or <code style="white-space: pre;">&#8288;CI&#8288;</code> is outside <code style="white-space: pre;">&#8288;fClower&#8288;</code> ... <code style="white-space: pre;">&#8288;fCupper&#8288;</code>
the study is stopped in the interim with the result FAIL (not BE).<br />
May be missing. Defaults then to 0.8 if <code style="white-space: pre;">&#8288;fCrit="PE"&#8288;</code> or 0.925 if
<code style="white-space: pre;">&#8288;fCrit="CI"&#8288;</code>.
</p>
</td></tr>
<tr><td><code id="power.tsd.fC_+3A_fcupper">fCupper</code></td>
<td>

<p>Upper futility limit for the <code style="white-space: pre;">&#8288;PE&#8288;</code> or <code style="white-space: pre;">&#8288;CI&#8288;</code> of
stage&nbsp;1.<br />
Will be set to <code style="white-space: pre;">&#8288;1/fClower&#8288;</code> if missing.
</p>
</td></tr>
<tr><td><code id="power.tsd.fC_+3A_theta0">theta0</code></td>
<td>

<p>Assumed ratio of geometric means (T/R) for simulations. If missing,
defaults to <code style="white-space: pre;">&#8288;GMR&#8288;</code>.
</p>
</td></tr>
<tr><td><code id="power.tsd.fC_+3A_theta1">theta1</code></td>
<td>

<p>Lower bioequivalence limit. Defaults to 0.8.
</p>
</td></tr>
<tr><td><code id="power.tsd.fC_+3A_theta2">theta2</code></td>
<td>

<p>Upper bioequivalence limit. Defaults to 1.25.
</p>
</td></tr>
<tr><td><code id="power.tsd.fC_+3A_npct">npct</code></td>
<td>

<p>Percentiles to be used for the presentation of the distribution of
<code style="white-space: pre;">&#8288;n(total)=n1+n2&#8288;</code>.<br />
Defaults to <code style="white-space: pre;">&#8288;c(0.05, 0.5, 0.95)&#8288;</code> to obtain the 5% and 95% percentiles
and the median.
</p>
</td></tr>
<tr><td><code id="power.tsd.fC_+3A_nsims">nsims</code></td>
<td>

<p>Number of studies to simulate.<br />
If missing, <code style="white-space: pre;">&#8288;nsims&#8288;</code> is set to 1E+05 = 100,000 or to 1E+06 = 1 Mio if
estimating the empiric Type I Error (<code style="white-space: pre;">&#8288;'alpha'&#8288;</code>), <em>i.e.</em>, with <code style="white-space: pre;">&#8288;theta0&#8288;</code> at
the border or outside the acceptance range <code style="white-space: pre;">&#8288;theta1&#8288;</code> ... <code style="white-space: pre;">&#8288;theta2&#8288;</code>.
</p>
</td></tr>
<tr><td><code id="power.tsd.fC_+3A_setseed">setseed</code></td>
<td>

<p>Simulations are dependent on the starting point of the (pseudo) random number
generator. To avoid differences in power for different runs a
<code>set.seed(1234567)</code> is issued if <code style="white-space: pre;">&#8288;setseed=TRUE&#8288;</code>, the default.<br />
Set this argument to <code style="white-space: pre;">&#8288;FALSE&#8288;</code> to view the variation in power between
different runs.
</p>
</td></tr>
<tr><td><code id="power.tsd.fC_+3A_details">details</code></td>
<td>

<p>If set to <code style="white-space: pre;">&#8288;TRUE&#8288;</code> the function prints the results of time measurements
of the simulation steps. Defaults to <code style="white-space: pre;">&#8288;FALSE&#8288;</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The calculations follow in principle the simulations as described in Potvin
<em>et al</em>.<br />
The underlying subject data are assumed to be evaluated after log-transformation.
But instead of simulating subject data, the statistics pe1, mse1 and pe2, SS2 are
simulated via their associated distributions (normal and
&chi;<sup>2</sup> distributions).
</p>


<h3>Value</h3>

<p>Returns an object of class <code style="white-space: pre;">&#8288;"pwrtsd"&#8288;</code> with all the input arguments and results
as components.<br />
The class <code style="white-space: pre;">&#8288;"pwrtsd"&#8288;</code> has an S3 print method.<br />
The results are in the components:
</p>
<table>
<tr><td><code>pBE</code></td>
<td>
<p>Fraction of studies found BE.</p>
</td></tr>
<tr><td><code>pBE_s1</code></td>
<td>
<p>Fraction of studies found BE in stage&nbsp;1.</p>
</td></tr>
<tr><td><code>pct_s2</code></td>
<td>
<p>Percentage of studies continuing to stage&nbsp;2.</p>
</td></tr>
<tr><td><code>nmean</code></td>
<td>
<p>Mean of n(total), aka average total sample size (<abbr><span class="acronym">ASN</span></abbr>).</p>
</td></tr>
<tr><td><code>nrange</code></td>
<td>
<p>Range (min, max) of n(total).</p>
</td></tr>
<tr><td><code>nperc</code></td>
<td>
<p>Percentiles of the distribution of n(total).</p>
</td></tr>
<tr><td><code>ntable</code></td>
<td>
<p>Object of class <code style="white-space: pre;">&#8288;"table"&#8288;</code> summarizing the discrete distribution of
n(total) via its distinct values and counts of occurences of these values.<br />
This component is only given back if <code>usePE==FALSE</code> or
<code>usePE==TRUE &amp; fClower&gt;0 &amp; is.finite(fCupper)</code>, <em>i.e.</em>, a futility range is used.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>D. Labes
</p>


<h3>References</h3>

<p>Potvin D, DiLiberti CE, Hauck WW, Parr AF, Schuirmann DJ, Smith RA. <em>Sequential design approaches for bioequivalence studies with crossover designs.</em><br />
Pharm Stat. 2008; 7(4):245&ndash;62. doi: <a href="https://doi.org/10.1002/pst.294">10.1002/pst.294</a>
</p>
<p>Montague TH, Potvin D, DiLiberti CE, Hauck WW, Parr AF, Schuirmann DJ. <em>Additional results for &lsquo;Sequential design approaches for bioequivalence studies with crossover designs&rsquo;.</em><br />
Pharm Stat. 2011; 11(1):8&ndash;13. doi: <a href="https://doi.org/10.1002/pst.483">10.1002/pst.483</a>
</p>
<p>Fuglsang A. <em>Sequential Bioequivalence Trial Designs with Increased Power and
Controlled Type I Error Rates.</em><br />
AAPS J. 2013; 15(3):659&ndash;61. doi: <a href="https://doi.org/10.1208/s12248-013-9475-5">10.1208/s12248-013-9475-5</a>
</p>
<p>Sch√ºtz H. <em>Two-stage designs in bioequivalence trials.</em><br />
Eur J Clin Pharmacol. 2015; 71(3):271&ndash;81. doi: <a href="https://doi.org/10.1007/s00228-015-1806-2">10.1007/s00228-015-1806-2</a>
</p>
<p>Kieser M, Rauch G. <em>Two-stage designs for cross-over bioequivalence trials.</em><br />
Stat Med. 2015; 34(16):2403&ndash;16. doi: <a href="https://doi.org/10.1002/sim.6487">10.1002/sim.6487</a>
</p>
<p>Zheng Ch, Zhao L, Wang J. <em>Modifications of sequential designs in bioequivalence trials.</em><br />
Pharm Stat. 2015; 14(3):180&ndash;8. doi: <a href="https://doi.org/10.1002/pst.1672">10.1002/pst.1672</a>
</p>
<p>Xu J, Audet C, DiLiberti CE, Hauck WW, Montague TH, Parr TH, Potvin D, Schuirmann DJ.
<em>Optimal adaptive sequential designs for crossover bioequivalence studies.</em><br />
Pharm Stat. 2016;15(1):15&ndash;27. doi: <a href="https://doi.org/10.1002/pst.1721">10.1002/pst.1721</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+power.tsd">power.tsd</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># using all the defaults
power.tsd.fC(CV=0.25, n1=24)
# run-time ~1 sec
## Not run: 
# as above but storing the results
res &lt;- power.tsd.fC(CV=0.25, n1=24)
# representation of the discrete distribution of n(total)
# via plot method of object with class "table" which creates a
# 'needle' plot
plot(res$ntable/sum(res$ntable), ylab="Density",
     xlab=expression("n"[total]), las=1,
     main=expression("Distribution of n"[total]))
## End(Not run)
</code></pre>

<hr>
<h2 id='power.tsd.GS'>
Power calculation for non-adaptive group sequential (2-stage) BE studies
</h2><span id='topic+power.tsd.GS'></span><span id='topic+power.2stage.GS'></span>

<h3>Description</h3>

<p>This function calculates the &lsquo;empiric&rsquo; power of group sequential
2-stage <abbr><span class="acronym">BE</span></abbr> in 2√ó2 crossover designs via simulations.<br />
The number of subjects in both stages has to be prespecified (non-adaptive).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>power.tsd.GS(alpha = c(0.0294, 0.0294), n, CV, theta0, theta1, theta2,
             fCrit = c("CI", "PE"), fClower, fCupper, nsims, setseed = TRUE,
             details = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="power.tsd.GS_+3A_alpha">alpha</code></td>
<td>

<p>Vector of the two nominal alpha values to be used in the
100(1&ndash;2&alpha;)
confidence interval calculations in the two stages.<br />
Use something like package <code style="white-space: pre;">&#8288;ldbounds&#8288;</code> for choosing the nominal alphas.
</p>
</td></tr>
<tr><td><code id="power.tsd.GS_+3A_n">n</code></td>
<td>

<p>Vector of the two sample sizes in stage&nbsp;1
and stage&nbsp;2. <code style="white-space: pre;">&#8288;n(total)&#8288;</code> is <code style="white-space: pre;">&#8288;n[1]+n[2]&#8288;</code>
if a second stage is necessary. Otherwise it is <code style="white-space: pre;">&#8288;n[1]&#8288;</code>.
</p>
</td></tr>
<tr><td><code id="power.tsd.GS_+3A_cv">CV</code></td>
<td>

<p>Coefficient of variation of the intra-subject variability
(use <em>e.g.</em>, 0.3 for 30%).
</p>
</td></tr>
<tr><td><code id="power.tsd.GS_+3A_theta0">theta0</code></td>
<td>

<p>Assumed ratio of geometric means (T/R) for simulations. If missing,
defaults to 0.95.
</p>
</td></tr>
<tr><td><code id="power.tsd.GS_+3A_theta1">theta1</code></td>
<td>

<p>Lower bioequivalence limit. Defaults to 0.80.
</p>
</td></tr>
<tr><td><code id="power.tsd.GS_+3A_theta2">theta2</code></td>
<td>

<p>Upper bioequivalence limit. Defaults to 1.25.
</p>
</td></tr>
<tr><td><code id="power.tsd.GS_+3A_fcrit">fCrit</code></td>
<td>

<p>Futility criterion.<br />
If set to <code style="white-space: pre;">&#8288;"PE"&#8288;</code> the study stops after
stage&nbsp;1 if not <abbr><span class="acronym">BE</span></abbr> and if the point
estimate (<abbr><span class="acronym">PE</span></abbr>) of stage&nbsp;1 evaluation
is outside the range defined in the next two  arguments <code style="white-space: pre;">&#8288;"fClower"&#8288;</code> and
<code style="white-space: pre;">&#8288;"fCupper"&#8288;</code>.<br />
If set to <code style="white-space: pre;">&#8288;"CI"&#8288;</code> the study stops after stage&nbsp;1
if not <abbr><span class="acronym">BE</span></abbr> and if the 90% confidence interval of
stage&nbsp;1 evaluation is outside the range
defined in the next two arguments.<br />
Defaults to <code style="white-space: pre;">&#8288;"CI"&#8288;</code>.
</p>
</td></tr>
<tr><td><code id="power.tsd.GS_+3A_fclower">fClower</code></td>
<td>

<p>Lower limit of the futility criterion. Defaults to <code style="white-space: pre;">&#8288;0&#8288;</code> if missing,
<em>i.e.</em>, no futility criterion.
</p>
</td></tr>
<tr><td><code id="power.tsd.GS_+3A_fcupper">fCupper</code></td>
<td>

<p>Upper limit of the futility criterion. Defaults to <code style="white-space: pre;">&#8288;1/fClower&#8288;</code> if missing.
</p>
</td></tr>
<tr><td><code id="power.tsd.GS_+3A_nsims">nsims</code></td>
<td>

<p>Number of studies to simulate.<br />
If missing, <code style="white-space: pre;">&#8288;nsims&#8288;</code> is set to 1E+05 = 100,000 or to 1E+06 = 1 Mio if
estimating the empiric Type I Error (<code style="white-space: pre;">&#8288;'alpha'&#8288;</code>), <em>i.e.</em>, with <code style="white-space: pre;">&#8288;theta0&#8288;</code>
at the border or outside the acceptance range <code style="white-space: pre;">&#8288;theta1&#8288;</code> ... <code style="white-space: pre;">&#8288;theta2&#8288;</code>.
</p>
</td></tr>
<tr><td><code id="power.tsd.GS_+3A_setseed">setseed</code></td>
<td>

<p>Simulations are dependent on the starting point of the (pseudo) random number
generator. To avoid differences in power for different runs a
<code>set.seed(1234567)</code> is issued if <code style="white-space: pre;">&#8288;setseed=TRUE&#8288;</code>, the default.<br />
Set this argument to <code style="white-space: pre;">&#8288;FALSE&#8288;</code> to view the variation in power between
different runs.
</p>
</td></tr>
<tr><td><code id="power.tsd.GS_+3A_details">details</code></td>
<td>

<p>If set to <code style="white-space: pre;">&#8288;TRUE&#8288;</code> the function prints the results of time measurements
of the simulation steps. Defaults to <code style="white-space: pre;">&#8288;FALSE&#8288;</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The calculations follow in principle the simulations as described in Potvin
<em>et al.</em> for adaptive designs, but with no interim power inspection and
pre-specified (fixed) number of subjects in stage&nbsp;2.<br />
The underlying subject data are assumed to be evaluated after log-transformation.
But instead of simulating subject data, the statistics pe1, mse1 and pe2, SS2 are
simulated via their associated distributions (normal and
&chi;<sup>2</sup> distributions).
</p>


<h3>Value</h3>

<p>Returns an object of class <code style="white-space: pre;">&#8288;"pwrtsd"&#8288;</code> with all the input arguments and results
as components.<br />
The class <code style="white-space: pre;">&#8288;"pwrtsd"&#8288;</code> has a S3 print method.<br />
The results are in the components:
</p>
<table>
<tr><td><code>pBE</code></td>
<td>
<p>Fraction of studies found BE.</p>
</td></tr>
<tr><td><code>pBE_s1</code></td>
<td>
<p>Fraction of studies found BE in stage&nbsp;1.</p>
</td></tr>
<tr><td><code>pct_s2</code></td>
<td>
<p>Percentage of studies continuing to stage&nbsp;2.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The code is reasonable fast. 1E6 sims take ~ 1 sec on my machine.
Even 1E7 sims are meanwhile possible without too much beer. :-)<br /><br />
</p>


<h3>Author(s)</h3>

<p>D. Labes
</p>


<h3>References</h3>

<p>Gould AL. <em>Group sequential extensions of a standard bioequivalence testing procedure.</em><br />
J Pharmacokin Biopharm. 1995; 23(1):57&ndash;86 doi: <a href="https://doi.org/10.1007/BF02353786">10.1007/BF02353786</a>
</p>
<p>Patterson SD, Jones B. <em>Bioequivalence and Statistics in Clinical Pharmacology.</em><br />
Boca Raton: CRC Press; 2<sup>nd</sup> edition 2016. Chapter 5.6 Optional Designs.
</p>
<p>Sch√ºtz H. <em>Two-stage designs in bioequivalence trials.</em><br />
Eur J Clin Pharmacol. 2015; 71(3):271&ndash;81. doi: <a href="https://doi.org/10.1007/s00228-015-1806-2">10.1007/s00228-015-1806-2</a>
</p>
<p>Kieser M, Rauch G. <em>Two-stage designs for cross-over bioequivalence trials.</em><br />
Stat Med. 2015; 34(16):2403&ndash;16. doi: <a href="https://doi.org/10.1002/sim.6487">10.1002/sim.6487</a>
</p>
<p>Zheng Ch, Zhao L, Wang J. <em>Modifications of sequential designs in bioequivalence trials.</em><br />
Pharm Stat. 2015; 14(3):180&ndash;8. doi: <a href="https://doi.org/10.1002/pst.1672">10.1002/pst.1672</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+power.tsd">power.tsd</a></code> and <code><a href="#topic+power.tsd.p">power.tsd.p</a></code> for adaptive sequential designs.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># using the Pocock alpha settings and no futility rule
# (defaults), a CV of 20% and 12 subjects in both stages,
# midway interim
power.tsd.GS(CV=0.2, n=c(12,12))
</code></pre>

<hr>
<h2 id='power.tsd.in'>
Power calculation of adaptive 2-stage BE studies with 2x2 crossover design,
based on the Inverse Normal method
</h2><span id='topic+power.2stage.in'></span><span id='topic+power.tsd.in'></span>

<h3>Description</h3>

<p>The function calculates the &lsquo;empirical&rsquo; power of 2-stage BE studies based
on the Inverse-Normal combination method. The main design scheme is according
to Maurer <em>et al.</em> (Maximum Combination Test), but it may also be used
for other/modified designs, e.g. standard combination method, usage of the
observed treatment difference after stage&nbsp;1
in the sample size re-estimation step or different futility criteria.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>power.tsd.in(alpha, weight, max.comb.test = TRUE, n1, CV, targetpower = 0.8,
             theta0, theta1, theta2, GMR, usePE = FALSE, min.n2 = 4, max.n = Inf,
             fCpower = targetpower, fCrit = "CI", fClower, fCupper, fCNmax,
             ssr.conditional = c("error_power", "error", "no"),
             pmethod = c("nct", "exact", "shifted"), npct = c(0.05, 0.5, 0.95),
             nsims, setseed = TRUE, details = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="power.tsd.in_+3A_alpha">alpha</code></td>
<td>

<p>If one element is given, the overall one-sided significance level. In this
case the adjusted alpha levels will be calculated internally. If two
elements are given, the argument refers to the two adjusted one-sided alpha
levels for stage&nbsp;1 and
stage&nbsp;2, respectively.<br />
If missing, defaults to <code style="white-space: pre;">&#8288;0.05&#8288;</code>.
</p>
</td></tr>
<tr><td><code id="power.tsd.in_+3A_weight">weight</code></td>
<td>

<p>Pre-defined weight(s) of stage&nbsp;1, see
'Details' for more information.
Note that using the notation from Maurer et al, weight corresponds to
information fraction, other literature may refer to sqrt(weight) as being
the weight. <code style="white-space: pre;">&#8288;weight&#8288;</code> must either contain one element (in case of
<code style="white-space: pre;">&#8288;max.comb.test = FALSE&#8288;</code>) or two elements (in case of
<code style="white-space: pre;">&#8288;max.comb.test = TRUE&#8288;</code>).<br />
If missing, defaults to <code style="white-space: pre;">&#8288;0.5&#8288;</code> for <code style="white-space: pre;">&#8288;max.comb.test = FALSE&#8288;</code> and to
<code style="white-space: pre;">&#8288;c(0.5, 0.25)&#8288;</code> for <code style="white-space: pre;">&#8288;max.comb.test = TRUE&#8288;</code>.
</p>
</td></tr>
<tr><td><code id="power.tsd.in_+3A_max.comb.test">max.comb.test</code></td>
<td>

<p>Logical; if <code style="white-space: pre;">&#8288;TRUE&#8288;</code> (default) the maximum combination test will be
used, otherwise the standard combination test.
</p>
</td></tr>
<tr><td><code id="power.tsd.in_+3A_n1">n1</code></td>
<td>

<p>Sample size of stage&nbsp;1.
</p>
</td></tr>
<tr><td><code id="power.tsd.in_+3A_cv">CV</code></td>
<td>

<p>Coefficient of variation of the intra-subject variability (use <em>e.g.</em>, 0.3 for
30%).
</p>
</td></tr>
<tr><td><code id="power.tsd.in_+3A_targetpower">targetpower</code></td>
<td>

<p>Desired (overall) target power to declare <abbr><span class="acronym">BE</span></abbr> at the end of the trial.
</p>
</td></tr>
<tr><td><code id="power.tsd.in_+3A_theta0">theta0</code></td>
<td>

<p>Assumed ratio of geometric means (T/R) for simulations. If missing,
defaults to <code style="white-space: pre;">&#8288;GMR&#8288;</code>.
</p>
</td></tr>
<tr><td><code id="power.tsd.in_+3A_theta1">theta1</code></td>
<td>

<p>Lower bioequivalence limit. Defaults to 0.8.
</p>
</td></tr>
<tr><td><code id="power.tsd.in_+3A_theta2">theta2</code></td>
<td>

<p>Upper bioequivalence limit. Defaults to 1.25.
</p>
</td></tr>
<tr><td><code id="power.tsd.in_+3A_gmr">GMR</code></td>
<td>

<p>Assumed ratio of geometric means (T/R) to be used in power calculation
for stage&nbsp;1 and sample size re-estimation
for stage&nbsp;2. If missing, defaults to 0.95.
</p>
</td></tr>
<tr><td><code id="power.tsd.in_+3A_usepe">usePE</code></td>
<td>

<p>If <code style="white-space: pre;">&#8288;TRUE&#8288;</code> the sample size re-estimation is done with the observed
point estimate (<abbr><span class="acronym">PE</span></abbr>) of the treatment difference in
stage&nbsp;1.<br />
Defaults to <code style="white-space: pre;">&#8288;FALSE&#8288;</code>.<br />
Note: The power of stage 1 used for the futility inspection and calculation
of the estimated conditional target power is always calculated with the
the planning value <code>GMR</code>.
</p>
</td></tr>
<tr><td><code id="power.tsd.in_+3A_min.n2">min.n2</code></td>
<td>

<p>Minimum sample size of stage&nbsp;2. Defaults to 4.<br />
If the sample size re-estimation step gives a sample size for
stage&nbsp;2 less than <code style="white-space: pre;">&#8288;min.n2&#8288;</code>, then
<code style="white-space: pre;">&#8288;min.n2&#8288;</code> will be used for stage&nbsp;2.
</p>
</td></tr>
<tr><td><code id="power.tsd.in_+3A_max.n">max.n</code></td>
<td>

<p>Maximum overall sample size stage&nbsp;1 +
stage&nbsp;2.<br />
This is <em>not</em> a futility criterion regarding the maximum sample size! If
<code style="white-space: pre;">&#8288;max.n&#8288;</code> is set to a finite value and the sample size re-estimation gives a
sample size for stage&nbsp;2 (<code style="white-space: pre;">&#8288;n2&#8288;</code>) such
that <code style="white-space: pre;">&#8288;n1 + n2 &gt; max.n&#8288;</code>, then the sample size for
stage&nbsp;2 will be set to <code style="white-space: pre;">&#8288;n2 = max.n - n1&#8288;</code>.<br />
Defaults to <code style="white-space: pre;">&#8288;Inf&#8288;</code>, <em>i.e.</em>, no constraint on the re-estimated sample size.
</p>
</td></tr>
<tr><td><code id="power.tsd.in_+3A_fcpower">fCpower</code></td>
<td>

<p>Threshold for power monitoring step to decide on futility for cases where
<abbr><span class="acronym">BE</span></abbr> has not been achieved after
stage&nbsp;1: If <abbr><span class="acronym">BE</span></abbr> has not been
achieved after stage&nbsp;1 and the power for
stage&nbsp;1 is greater than or equal to
<code style="white-space: pre;">&#8288;fCpower&#8288;</code>, then the study will be considered a failure.<br /><br />
See &lsquo;Details&rsquo; for more information on the choice of
<code style="white-space: pre;">&#8288;fCpower&#8288;</code>.
</p>
</td></tr>
<tr><td><code id="power.tsd.in_+3A_fcrit">fCrit</code></td>
<td>

<p>Futility criterion to use: <code style="white-space: pre;">&#8288;"No"&#8288;</code> (no futility criterion regarding
observed point estimate, confidence interval and maximum sample size),
<code style="white-space: pre;">&#8288;"PE"&#8288;</code> (observed point estimate of the geometric mean ratio from
stage&nbsp;1),
<code style="white-space: pre;">&#8288;"CI"&#8288;</code> (90% confidence interval of the geometric mean ratio from
stage&nbsp;1), <code>"Nmax"</code> (overall maximum
sample size); or a combination thereof (concatenate abbreviations; see
&lsquo;Examples&rsquo;). Defaults to &quot;CI&quot;.
</p>
</td></tr>
<tr><td><code id="power.tsd.in_+3A_fclower">fClower</code></td>
<td>

<p>Lower futility limit for the <abbr><span class="acronym">PE</span></abbr> or <abbr><span class="acronym">CI</span></abbr> of
stage&nbsp;1.<br />
If the <abbr><span class="acronym">PE</span></abbr> or <abbr><span class="acronym">CI</span></abbr> is completely outside of <code style="white-space: pre;">&#8288;fClower&#8288;</code>
... <code style="white-space: pre;">&#8288;fCupper&#8288;</code> the study is stopped due to futility (not <abbr><span class="acronym">BE</span></abbr>).<br />
May be missing. If <code style="white-space: pre;">&#8288;"PE"&#8288;</code> or <code style="white-space: pre;">&#8288;"CI"&#8288;</code> is specified within <code style="white-space: pre;">&#8288;fCrit&#8288;</code>,
the default will be set to 0.8 for <code style="white-space: pre;">&#8288;fCrit = "PE"&#8288;</code> or 0.95 for <code style="white-space: pre;">&#8288;fCrit = "CI"&#8288;</code>.
If neither <code style="white-space: pre;">&#8288;"PE"&#8288;</code> nor <code style="white-space: pre;">&#8288;"CI"&#8288;</code> is specified within <code style="white-space: pre;">&#8288;fCrit&#8288;</code>, there
will be no futility constraint regarding point estimate or confidence interval
from stage&nbsp;1 (regardless of any
specification of <code style="white-space: pre;">&#8288;fClower&#8288;</code> and/or <code style="white-space: pre;">&#8288;fCupper&#8288;</code>).
</p>
</td></tr>
<tr><td><code id="power.tsd.in_+3A_fcupper">fCupper</code></td>
<td>

<p>Upper futility limit for the <abbr><span class="acronym">PE</span></abbr> or <abbr><span class="acronym">CI</span></abbr> of
stage&nbsp;1.<br />
Analogous to <code style="white-space: pre;">&#8288;fClower&#8288;</code>: Will be set to <code style="white-space: pre;">&#8288;1/fClower&#8288;</code> if missing.
</p>
</td></tr>
<tr><td><code id="power.tsd.in_+3A_fcnmax">fCNmax</code></td>
<td>

<p>Futility criterion regarding maximum sample size. If the determined sample size
for stage&nbsp;2 (<code style="white-space: pre;">&#8288;n2&#8288;</code>) is such that
<code style="white-space: pre;">&#8288;n1 + n2 &gt; fCNmax&#8288;</code>, the study will not continue to
stage&nbsp;2 and stopped due to futility (not
<abbr><span class="acronym">BE</span></abbr>).<br />
If <code style="white-space: pre;">&#8288;"Nmax"&#8288;</code> is specified within <code style="white-space: pre;">&#8288;fCrit&#8288;</code> and argument <code style="white-space: pre;">&#8288;fCNmax&#8288;</code>
is missing, the value will be set to <code style="white-space: pre;">&#8288;fCNmax = 4*n1&#8288;</code>. If <code style="white-space: pre;">&#8288;"Nmax"&#8288;</code> is
not specified within <code style="white-space: pre;">&#8288;fCrit&#8288;</code>, then there will be no futility constraint
regarding maximum sample size (regardless of any specification of <code style="white-space: pre;">&#8288;fCNmax&#8288;</code>).
</p>
</td></tr>
<tr><td><code id="power.tsd.in_+3A_ssr.conditional">ssr.conditional</code></td>
<td>

<p>Method for sample size re-estimation step: <code style="white-space: pre;">&#8288;"no"&#8288;</code> does not use
conditional error rates nor the estimated conditional target power for
the second stage, <code style="white-space: pre;">&#8288;"error"&#8288;</code> uses conditional error rates for the
second stage, and <code style="white-space: pre;">&#8288;"error_power"&#8288;</code> uses both conditional error rates
and the estimated conditional target power for the second stage.<br />
Defaults to <code style="white-space: pre;">&#8288;"error_power"&#8288;</code>.<br /><br />
See also &lsquo;Details&rsquo;.
</p>
</td></tr>
<tr><td><code id="power.tsd.in_+3A_pmethod">pmethod</code></td>
<td>

<p>Power calculation method, also to be used in the sample size estimation for
stage&nbsp;2.<br />
Implemented are <code style="white-space: pre;">&#8288;"nct"&#8288;</code> (approximate calculations via non-central
<em>t</em>-distribution, <code style="white-space: pre;">&#8288;"exact"&#8288;</code> (exact calculations via Owen‚Äôs Q),
and <code style="white-space: pre;">&#8288;"shifted"&#8288;</code> (approximate calculation via shifted central <em>t</em>-distribution
like in the paper of Potvin <em>et al.</em>)<br />
Defaults to <code style="white-space: pre;">&#8288;"nct"&#8288;</code> as it is a reasonable compromise between speed and
accuracy in the sample size estimation step.
</p>
</td></tr>
<tr><td><code id="power.tsd.in_+3A_npct">npct</code></td>
<td>

<p>Percentiles to be used for the presentation of the distribution of
<code style="white-space: pre;">&#8288;n(total)=n1+n2&#8288;</code>.<br />
Defaults to <code style="white-space: pre;">&#8288;c(0.05, 0.5, 0.95)&#8288;</code> to obtain the 5% and 95% percentiles
and the median.
</p>
</td></tr>
<tr><td><code id="power.tsd.in_+3A_nsims">nsims</code></td>
<td>

<p>Number of studies to simulate.<br />
If missing, <code style="white-space: pre;">&#8288;nsims&#8288;</code> is set to 1E+05 = 100,000 or to 1E+06 = 1 Mio if
estimating the empiric Type I Error (<code style="white-space: pre;">&#8288;'alpha'&#8288;</code>), <em>i.e.</em>, with <code style="white-space: pre;">&#8288;theta0&#8288;</code> at
the border of the acceptance range <code style="white-space: pre;">&#8288;theta1&#8288;</code> ... <code style="white-space: pre;">&#8288;theta2&#8288;</code>.
</p>
</td></tr>
<tr><td><code id="power.tsd.in_+3A_setseed">setseed</code></td>
<td>

<p>Simulations are dependent on the starting point of the (pseudo) random number
generator. To avoid differences in power for different runs a
<code>set.seed(1234567)</code> is issued if <code style="white-space: pre;">&#8288;setseed=TRUE&#8288;</code>, the default.<br />
Set this argument to <code style="white-space: pre;">&#8288;FALSE&#8288;</code> to view the variation in power between
different runs.
</p>
</td></tr>
<tr><td><code id="power.tsd.in_+3A_details">details</code></td>
<td>

<p>If set to <code style="white-space: pre;">&#8288;TRUE&#8288;</code> the function prints the results of time measurements
of the simulation steps. Default to <code style="white-space: pre;">&#8288;FALSE&#8288;</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The underlying subject data are assumed to be evaluated after log-transformation.
But instead of simulating subject data, the statistics pe1, mse1 and pe2, mse2
are simulated via their associated distributions (Normal and
&chi;<sup>2</sup> distribution).<br /><br />
The <code>weight</code> argument always refers to the first weight of a pair of
weights. For example, in case of <code>max.comb.test = FALSE</code> the standard
combination test requires two weights (w, 1-w) but only the first one, w,
is required as input argument here because the second weight is
automatically specified once the first is given. Similarly for
<code>max.comb.test = TRUE</code>, w and w* need to be specified, which in turn
define the two pairs of weights (w, 1-w) and (w*, 1-w*).<br /><br />
If <code style="white-space: pre;">&#8288;ssr.conditional = "error_power"&#8288;</code>, the design scheme generally
calculates the estimated conditional target power of the second stage and
uses this value as desired target power in the sample size re-estimation process:<br />
If <code>fCpower</code> &gt; <code>targetpower</code>, then the conditional estimated
target power may be negative. This does not seem sensible. Therefore, for such
cases the desired target power for the sample size re-calculation will be set
to <code>targetpower</code>, i.e. <code>ssr.conditional</code> will be set to <code>"error"</code>.
</p>


<h3>Value</h3>

<p>Returns an object of class <code style="white-space: pre;">&#8288;"pwrtsd"&#8288;</code> with all the input arguments and results
as components. As part of the input arguments a component <code>cval</code> is also
presented, containing the critical values for stage 1 and 2 according to the
input based on <code>alpha</code>, <code>weight</code> and <code>max.comb.test</code>.<br />
The class <code style="white-space: pre;">&#8288;"pwrtsd"&#8288;</code> has an S3 print method.<br /><br />
The results are in the components:
</p>
<table>
<tr><td><code>pBE</code></td>
<td>
<p>Fraction of studies found BE.</p>
</td></tr>
<tr><td><code>pBE_s1</code></td>
<td>
<p>Fraction of studies found BE in stage&nbsp;1.</p>
</td></tr>
<tr><td><code>pct_stop_s1</code></td>
<td>
<p>Percentage of studies stopped after
stage&nbsp;1 (due to BE or due to futility).</p>
</td></tr>
<tr><td><code>pct_stop_fut</code></td>
<td>
<p>Percentage of studies stopped after
stage&nbsp;1 due to futility.</p>
</td></tr>
<tr><td><code>pct_s2</code></td>
<td>
<p>Percentage of studies continuing to stage&nbsp;2.</p>
</td></tr>
<tr><td><code>nmean</code></td>
<td>
<p>Mean of n(total).</p>
</td></tr>
<tr><td><code>nrange</code></td>
<td>
<p>Range (min, max) of n(total).</p>
</td></tr>
<tr><td><code>nperc</code></td>
<td>
<p>Vector of percentiles of the distribution of n(total).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>B. Lang
</p>


<h3>References</h3>

<p>K√∂nig F, Wolfsegger M, Jaki T, Sch√ºtz H, Wassmer G.<br />
<em>Adaptive two-stage bioequivalence trials with early stopping and sample size re-estimation.</em><br />
Vienna: 2014; 35<sup>th</sup> Annual Conference of the International Society for Clinical Biostatistics. Poster P1.2.88 <br />
doi: <a href="https://doi.org/10.13140/RG.2.1.5190.0967">10.13140/RG.2.1.5190.0967</a>.
</p>
<p>Patterson SD, Jones B. <em>Bioequivalence and Statistics in Clinical Pharmacology.</em><br />
Boca Raton: CRC Press; 2<sup>nd</sup> edition 2017.
</p>
<p>Kieser M, Rauch G. <em>Two-stage designs for cross-over bioequivalence trials.</em><br />
Stat Med. 2015; 34(16): 2403&ndash;16. doi: <a href="https://doi.org/10.1002/sim.6487">10.1002/sim.6487</a>.
</p>
<p>Maurer W, Jones B, Chen Y. <em>Controlling the type 1 error rate in two-stage
sequential designs when testing for average bioequivalence.</em><br />
Stat Med. 2018; 37(10): 1587&ndash;1607. doi: <a href="https://doi.org/10.1002/sim.7614">10.1002/sim.7614</a>.
</p>
<p>Wassmer G, Brannath W. <em>Group Sequential and Confirmatory Adaptive Designs
in Clinical Trials.</em><br />
Springer 2016. doi: <a href="https://doi.org/10.1007/978-3-319-32562-0">10.1007/978-3-319-32562-0</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+interim.tsd.in">interim.tsd.in</a>, <a href="#topic+final.tsd.in">final.tsd.in</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># 12 subjects in stage 1, CV of 20%, no futility rule, otherwise all defaults
# except too low number of sims due to CRAN policy for run-time of examples
# This setting resembles values in Table 6.8 and 6.10 in Patterson and Jones
# if nsims=1e5 (default)
power.tsd.in(n1 = 12, CV = 0.2, fCrit = "No", nsims=1e4)

# Note that actual replication would require the following additional
# arguments (extremely long run-time)
## Not run: 
power.tsd.in(n1 = 12, CV = 0.2, fCrit = "No", max.n = 4000,
             pmethod = "exact", nsims = 1E6)
## End(Not run)

# Table 8 in Maurer et al
power.tsd.in(n1 = 36, CV = 0.4, max.n = 4000)

# Same example as before but with additional futility criterion regarding
# maximum sample size (using the default 4*n1 as maximum bound)
power.tsd.in(n1 = 36, CV = 0.4, max.n = 4000, fCrit = c("CI", "Nmax"))
</code></pre>

<hr>
<h2 id='power.tsd.KM'>
Power calculation of adaptive 2-stage BE studies (2x2 crossover)
(variant of power.2stage to obtain the results of Karalis / Macheras)
</h2><span id='topic+power.2stage.KM'></span><span id='topic+power.tsd.KM'></span>

<h3>Description</h3>

<p>This function calculates the &lsquo;empiric&rsquo; power of 2-stage BE studies according
to Potvin <em>et al.</em> via simulations. The Potvin methods are modified as
described by Karalis &amp; Macheras to include a futility criterion Nmax and to
perform the power calculation steps and the sample size estimation step in
the decision schemes with the <abbr><span class="acronym">MSE</span></abbr> (calculated from CV) <strong>and</strong>
the point estimate (<abbr><span class="acronym">PE</span></abbr>) of T/R from stage&nbsp;1.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>power.tsd.KM(method = c("C", "B"), alpha0 = 0.05, alpha = c(0.0294, 0.0294),
             n1, CV, targetpower = 0.8, pmethod = c("nct", "exact"),
             Nmax = 150, theta0, theta1, theta2, npct = c(0.05, 0.5, 0.95),
             nsims, setseed = TRUE, details = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="power.tsd.KM_+3A_method">method</code></td>
<td>

<p>Decision schemes according to Potvin <em>et al.</em><br />
Default is <code style="white-space: pre;">&#8288;"C"&#8288;</code> aka <abbr><span class="acronym">TSD</span></abbr> in the paper of Karalis &amp; Macheras
if setting <code style="white-space: pre;">&#8288;alpha=c(0.0294, 0.0294)&#8288;</code>.<br />
<abbr><span class="acronym">TSD-1</span></abbr> of Karalis can be obtained by choosing <code style="white-space: pre;">&#8288;"C"&#8288;</code> but
setting <code style="white-space: pre;">&#8288;alpha=c(0.028, 0.028)&#8288;</code>.<br />
<abbr><span class="acronym">TSD-2</span></abbr> of Karalis can be obtained by choosing <code style="white-space: pre;">&#8288;"B"&#8288;</code> and
setting <code style="white-space: pre;">&#8288;alpha=c(0.0294, 0.0294)&#8288;</code>.<br />
</p>
</td></tr>
<tr><td><code id="power.tsd.KM_+3A_alpha0">alpha0</code></td>
<td>

<p>Alpha value for the first step(s) in Potvin C aka <abbr><span class="acronym">TSD</span></abbr> of Karalis &amp;
Macheras or <abbr><span class="acronym">TSD-1</span></abbr> of Karalis, the power inspection and BE decision
if power &gt; targetpower.<br />
Defaults to 0.05.
</p>
</td></tr>
<tr><td><code id="power.tsd.KM_+3A_alpha">alpha</code></td>
<td>

<p>Vector (two elements) of the nominal alphas for the two stages.<br />
Defaults to Pocock‚Äôs alpha setting <code style="white-space: pre;">&#8288;alpha=c(0.0294, 0.0294)&#8288;</code>
as in <abbr><span class="acronym">TSD</span></abbr> of Karalis &amp; Macheras.
</p>
</td></tr>
<tr><td><code id="power.tsd.KM_+3A_n1">n1</code></td>
<td>

<p>Sample size of stage&nbsp;1.
</p>
</td></tr>
<tr><td><code id="power.tsd.KM_+3A_cv">CV</code></td>
<td>

<p>Coefficient of variation of the intra-subject variability
(use <em>e.g.</em>, 0.3 for 30%).
</p>
</td></tr>
<tr><td><code id="power.tsd.KM_+3A_targetpower">targetpower</code></td>
<td>

<p>Power threshold in the first step of Potvin <code style="white-space: pre;">&#8288;"C"&#8288;</code> and power to
achieve in the sample size estimation step.
</p>
</td></tr>
<tr><td><code id="power.tsd.KM_+3A_pmethod">pmethod</code></td>
<td>

<p>Power calculation method, also to be used in the sample size estimation for
stage&nbsp;2.<br />
Implemented are &quot;<code style="white-space: pre;">&#8288;"nct"&#8288;</code> (approximate calculations via non-central
<em>t</em>-distribution and <code style="white-space: pre;">&#8288;"exact"&#8288;</code> (exact calculations via Owen‚Äôs Q).<br />
Defaults to <code style="white-space: pre;">&#8288;"nct"&#8288;</code> as a reasonable compromise between speed and
accuracy in the sample size estimation step.
</p>
</td></tr>
<tr><td><code id="power.tsd.KM_+3A_nmax">Nmax</code></td>
<td>

<p>Futility criterion. If set to a finite value all studies simulated in which
a sample size &gt;Nmax is obtained will be regarded as BE=FAIL. Defaults to 150,
as recommended by Karalis &amp; Macheras.<br />
Set this argument to <code style="white-space: pre;">&#8288;Inf&#8288;</code>, to work without that futility criterion.
</p>
</td></tr>
<tr><td><code id="power.tsd.KM_+3A_theta0">theta0</code></td>
<td>

<p>Assumed ratio of geometric means (T/R) for simulations. If missing,
defaults to <code style="white-space: pre;">&#8288;GMR&#8288;</code>.
</p>
</td></tr>
<tr><td><code id="power.tsd.KM_+3A_theta1">theta1</code></td>
<td>

<p>Lower bioequivalence limit. Defaults to 0.8.
</p>
</td></tr>
<tr><td><code id="power.tsd.KM_+3A_theta2">theta2</code></td>
<td>

<p>Upper bioequivalence limit. Defaults to 1.25.
</p>
</td></tr>
<tr><td><code id="power.tsd.KM_+3A_npct">npct</code></td>
<td>

<p>Percentiles to be used for the presentation of the distribution of
<code style="white-space: pre;">&#8288;n(total)=n1+n2&#8288;</code>.<br />
Defaults to <code style="white-space: pre;">&#8288;c(0.05, 0.5, 0.95)&#8288;</code> to obtain the 5% and 95% percentiles
and the median.
</p>
</td></tr>
<tr><td><code id="power.tsd.KM_+3A_nsims">nsims</code></td>
<td>

<p>Number of studies to simulate.<br />
If missing, <code style="white-space: pre;">&#8288;nsims&#8288;</code> is set to 1E+05 = 100,000 or to 1E+06 = 1 Mio
if estimating the empiric Type I Error (<code style="white-space: pre;">&#8288;'alpha'&#8288;</code>), <em>i.e.</em>,
with <code style="white-space: pre;">&#8288;theta0&#8288;</code> at the border or outside the acceptance range
<code style="white-space: pre;">&#8288;theta1&#8288;</code> ... <code style="white-space: pre;">&#8288;theta2&#8288;</code>.
</p>
</td></tr>
<tr><td><code id="power.tsd.KM_+3A_setseed">setseed</code></td>
<td>

<p>Simulations are dependent on the starting point of the (pseudo) random number
generator. To avoid differences in power for different runs a
<code>set.seed(1234567)</code> is issued if <code style="white-space: pre;">&#8288;setseed=TRUE&#8288;</code>, the default.<br />
Set this argument to <code style="white-space: pre;">&#8288;FALSE&#8288;</code> to view the variation in power between
different runs.
</p>
</td></tr>
<tr><td><code id="power.tsd.KM_+3A_details">details</code></td>
<td>

<p>If set to <code style="white-space: pre;">&#8288;TRUE&#8288;</code> the function prints the results of time measurements
of the simulation steps. Defaults to <code style="white-space: pre;">&#8288;FALSE&#8288;</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The calculations follow in principle the simulations as described in Potvin
<em>et al</em>.<br />
The underlying subject data are assumed to be evaluated after log-transformation.
But instead of simulating subject data, the statistics pe1, mse1 and pe2, SS2 are
simulated via their associated distributions (normal and
&chi;<sup>2</sup> distributions).<br /><br />
In contrast to Potvin <em>et al.</em> the power calculation steps as well as the
sample size adaption step of the decision schemes are done using the <abbr><span class="acronym">MSE</span></abbr>
(calculated from CV) <b>and</b> the point estimate from
stage&nbsp;1.<br />
This resembles the methods described in Karalis &amp; Macheras and Karalis.
</p>


<h3>Value</h3>

<p>Returns an object of class <code style="white-space: pre;">&#8288;"pwrtsd"&#8288;</code> with all the input arguments and results
as components.<br />
The class <code style="white-space: pre;">&#8288;"pwrtsd"&#8288;</code> has a S3 print method.<br />
The results are in the components:
</p>
<table>
<tr><td><code>pBE</code></td>
<td>
<p>Fraction of studies found BE.</p>
</td></tr>
<tr><td><code>pBE_s1</code></td>
<td>
<p>Fraction of studies found BE in stage&nbsp;1.</p>
</td></tr>
<tr><td><code>pct_s2</code></td>
<td>
<p>Percentage of studies continuing to stage&nbsp;2.</p>
</td></tr>
<tr><td><code>nmean</code></td>
<td>
<p>Mean of n(total).</p>
</td></tr>
<tr><td><code>nrange</code></td>
<td>
<p>Range (min, max) of n(total).</p>
</td></tr>
<tr><td><code>nperc</code></td>
<td>
<p>Percentiles of the distribution of n(total).</p>
</td></tr>
<tr><td><code>ntable</code></td>
<td>
<p>Object of class <code style="white-space: pre;">&#8288;"table"&#8288;</code> summarizing the discrete distribution
of n(total) via its distinct values and counts of occurences of these values.<br />
This component is only given back if <code style="white-space: pre;">&#8288;is.finite(Nmax)&#8288;</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>D. Labes
</p>


<h3>References</h3>

<p>Potvin D, DiLiberti CE, Hauck WW, Parr AF, Schuirmann DJ, Smith RA. <em>Sequential design approaches for bioequivalence studies with crossover designs.</em><br />
Pharm Stat. 2008; 7(4):245&ndash;62. doi: <a href="https://doi.org/10.1002/pst.294">10.1002/pst.294</a>
</p>
<p>Karalis V, Macheras P. <em>An Insight into the Properties of a Two-Stage Design in Bioequivalence Studies.</em><br />
Pharm Res. 2013; 30(7):1824&ndash;35. doi: <a href="https://doi.org/10.1007/s11095-013-1026-3">10.1007/s11095-013-1026-3</a>
</p>
<p>Karalis V. <em>The role of the upper sample size limit in two-stage bioequivalence designs.</em><br />
Int J Pharm. 2013; 456(1):87&ndash;94. doi: <a href="https://doi.org/10.1016/j.ijpharm.2013.08.013">10.1016/j.ijpharm.2013.08.013</a>
</p>
<p>Fuglsang A. <em>Futility Rules in Bioequivalence Trials with Sequential Designs.</em><br />
AAPS J. 2014; 16(1):79&ndash;82. doi: <a href="https://doi.org/10.1208/s12248-013-9540-0">10.1208/s12248-013-9540-0</a>
</p>
<p>Sch√ºtz H. <em>Two-stage designs in bioequivalence trials.</em><br />
Eur J Clin Pharmacol. 2015; 71(3):271&ndash;81. doi: <a href="https://doi.org/10.1007/s00228-015-1806-2">10.1007/s00228-015-1806-2</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># using all the defaults
# but too low number of sims to complain with the CRAN policy:
# "check time only a few seconds per example"
# minimum number of sims should be 1E5 for power, 1E6 sims for 'alpha'
power.tsd.KM(n1=16, CV=0.2, nsims=1E4)
# ~3 sec if nsims=1E5
</code></pre>

<hr>
<h2 id='power.tsd.p'>
Power calculation of adaptive 2-stage BE studies in 2-group parallel designs
</h2><span id='topic+power.tsd.p'></span><span id='topic+power.tsd.pAF'></span><span id='topic+power.2stage.p'></span><span id='topic+power.2stage.pAF'></span>

<h3>Description</h3>

<p>This functions calculate the &lsquo;empirical&rsquo; power of 2-stage BE studies
with 2 parallel groups according to Fuglsang 2014 via simulations. The Potvin decision
schemes are modified to include a futility criterion Nmax, a minimum number of
subjects to be included in stage 2 and to allow the sample size estimation
step to be done with point estimate and variabilities from
stage&nbsp;1 (fully adaptive).<br /><br />
Function <code style="white-space: pre;">&#8288;power.tsd.pAF()&#8288;</code> performes exactly as described in
Fuglsang‚Äôs paper, namely the power monitoring steps and the sample
size estimation are based always on the pooled <em>t</em>-test.<br /><br />
Function <code>power.tsd.p()</code> with argument <code style="white-space: pre;">&#8288;test="welch"&#8288;</code> on the
other hand uses the genuine power of Welch‚Äôs test. Moreover it
accepts unequal treatment groups in stage&nbsp;1.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>power.tsd.p(method = c("B", "C"), alpha0 = 0.05, alpha = c(0.0294, 0.0294),
            n1, GMR, CV, targetpower = 0.8, pmethod = c("nct", "exact", "shifted"),
            usePE = FALSE, Nmax = Inf, min.n2=0, test = c("welch", "t-test", "anova"),
            theta0, theta1, theta2, npct = c(0.05, 0.5, 0.95), nsims,
            setseed = TRUE, details = FALSE)

power.tsd.pAF(method = c("B", "C"), alpha0 = 0.05, alpha = c(0.0294, 0.0294),
              n1, GMR, CV, targetpower = 0.8, pmethod = c("shifted", "nct", "exact"),
              usePE = FALSE, Nmax = Inf, test = c("welch", "t-test", "anova"),
              theta0, theta1, theta2, npct = c(0.05, 0.5, 0.95), nsims,
              setseed = TRUE, details = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="power.tsd.p_+3A_method">method</code></td>
<td>

<p>Decision schemes according to Potvin <em>et.al.</em> (defaults to <code style="white-space: pre;">&#8288;"B"&#8288;</code>).<br />
Potvin‚Äôs &lsquo;method D&rsquo; can be obtained by choosing <code style="white-space: pre;">&#8288;"C"&#8288;</code> but
setting <code style="white-space: pre;">&#8288;alpha=c(0.028, 0.028)&#8288;</code>.
</p>
</td></tr>
<tr><td><code id="power.tsd.p_+3A_alpha0">alpha0</code></td>
<td>

<p>Alpha value for the first step(s) in Potvin <code style="white-space: pre;">&#8288;"C"&#8288;</code>, the power inspection
and BE decision if power &gt; targetpower.<br />
Defaults to 0.05.
</p>
</td></tr>
<tr><td><code id="power.tsd.p_+3A_alpha">alpha</code></td>
<td>

<p>Vector (two elements) of the nominal alphas for the two stages.<br />
Defaults to Pocock‚Äôs alpha setting <code style="white-space: pre;">&#8288;alpha=c(0.0294, 0.0294)&#8288;</code>.
</p>
</td></tr>
<tr><td><code id="power.tsd.p_+3A_n1">n1</code></td>
<td>

<p>Sample size of stage&nbsp;1.<br />
Function <code style="white-space: pre;">&#8288;power.tsd.p()&#8288;</code> accepts also a vector of
stage&nbsp;1 sample sizes with two elements,
where the number of subjects in the in treatment group <em>T</em> should be
given in the first element and the number of subjects in the treatment
group <em>R</em> in the second.<br />
If given with one element, the total <code style="white-space: pre;">&#8288;n1&#8288;</code> should be even.
</p>
</td></tr>
<tr><td><code id="power.tsd.p_+3A_gmr">GMR</code></td>
<td>

<p>Ratio T/R to be used in decision scheme (power calculations in
stage&nbsp;1 and sample size estimation for
stage&nbsp;2).
</p>
</td></tr>
<tr><td><code id="power.tsd.p_+3A_cv">CV</code></td>
<td>

<p>Coefficient of variation of the total variability
(use <em>e.g.</em>, 0.3 for 30%)<br />
Can be a vector with two elements. In that case <code style="white-space: pre;">&#8288;CV[1]&#8288;</code> is for the group
under the Test treatment and <code style="white-space: pre;">&#8288;CV[2]&#8288;</code> for the group under the Reference.
</p>
</td></tr>
<tr><td><code id="power.tsd.p_+3A_targetpower">targetpower</code></td>
<td>

<p>Power threshold in the power monitoring steps and power to achieve
in the sample size estimation step.
</p>
</td></tr>
<tr><td><code id="power.tsd.p_+3A_pmethod">pmethod</code></td>
<td>

<p>Power calculation method, also to be used in the sample size estimation for
stage&nbsp;2.<br />
Implemented are <code style="white-space: pre;">&#8288;"nct"&#8288;</code> (approximate calculations via non-central
<em>t</em>-distribution, <code style="white-space: pre;">&#8288;"exact"&#8288;</code> (exact calculations via Owen‚Äôs Q),
and <code style="white-space: pre;">&#8288;"shifted"&#8288;</code> (approximate calculation via shifted central
<em>t</em>-distribution<br />
Defaults to <code style="white-space: pre;">&#8288;"nct"&#8288;</code> for speed reasons in function <code style="white-space: pre;">&#8288;power.tsd.p()&#8288;</code>
as a reasonable compromise between speed and accuracy in the sample size
estimation step.<br />
Defaults to <code style="white-space: pre;">&#8288;"shifted"&#8288;</code> in function <code style="white-space: pre;">&#8288;power.tsd.pAF()&#8288;</code> for
consistancy with Fuglsang.<br />
</p>
</td></tr>
<tr><td><code id="power.tsd.p_+3A_usepe">usePE</code></td>
<td>

<p>If <code style="white-space: pre;">&#8288;TRUE&#8288;</code> the sample size estimation step is done with <abbr><span class="acronym">MSE</span></abbr>
<b>and</b> <abbr><span class="acronym">PE</span></abbr> of stage&nbsp;1.<br />
Defaults to <code>FALSE</code> <em>i.e.</em>, the sample size is estimated with
<code style="white-space: pre;">&#8288;GMR&#8288;</code> and <abbr><span class="acronym">MSE</span></abbr> (calculated from <code style="white-space: pre;">&#8288;CV&#8288;</code>) of
stage&nbsp;1 analogous to Potvin <em>et. al</em>.<br />
NB: The power inspection steps in the Potvin methods are always done with the
<code style="white-space: pre;">&#8288;GMR&#8288;</code> argument and <abbr><span class="acronym">MSE</span></abbr> (<code style="white-space: pre;">&#8288;CV&#8288;</code>) of
stage&nbsp;1.
</p>
</td></tr>
<tr><td><code id="power.tsd.p_+3A_nmax">Nmax</code></td>
<td>

<p>Futility criterion. If set to a finite value, all studies simulated in which a
sample size <code style="white-space: pre;">&#8288;&gt;Nmax&#8288;</code> is obtained will be regarded as BE=FAIL.<br />
Set this argument to <code style="white-space: pre;">&#8288;Inf&#8288;</code>, the default, to work without that futility
criterion.
</p>
</td></tr>
<tr><td><code id="power.tsd.p_+3A_min.n2">min.n2</code></td>
<td>

<p>Minimum sample size of stage&nbsp;2.<br />
If the sample size estimation step gives <code style="white-space: pre;">&#8288;N &lt; n1+min.n2&#8288;</code> the sample size for
stage&nbsp;2 will be forced to <code style="white-space: pre;">&#8288;min.n2&#8288;</code>,
<em>i.e.</em> the total sample size to <code>n1+min.n2</code>.<br />
Defaults to zero, <em>i.e.</em>, no minimum sample size for
stage&nbsp;2 is applied.<br />
</p>
</td></tr>
<tr><td><code id="power.tsd.p_+3A_test">test</code></td>
<td>

<p>Test on which the CI calculations are based on.<br />
Defaults to <code style="white-space: pre;">&#8288;"welch"&#8288;</code> = Welch‚Äôs <em>t</em>-test accounting for
heteroscedasticity in the variabilities of Test and Reference, but neglecting
stage effects.<br />
<code style="white-space: pre;">&#8288;"anova"&#8288;</code> calculates the
100(1&ndash;2&alpha;)
confidence interval based on an <abbr><span class="acronym">ANOVA</span></abbr> with treatment and stage
in the model.<br />
<code style="white-space: pre;">&#8288;"t-test"&#8288;</code> calculates the
100(1&ndash;2&alpha;)
confidence interval based on the <em>t</em>-test assuming equal
variabilities of Test and Reference and neglecting stage effects.
</p>
</td></tr>
<tr><td><code id="power.tsd.p_+3A_theta0">theta0</code></td>
<td>

<p>Assumed ratio of geometric means (T/R) for simulations. If missing,
defaults to <code style="white-space: pre;">&#8288;GMR&#8288;</code>.
</p>
</td></tr>
<tr><td><code id="power.tsd.p_+3A_theta1">theta1</code></td>
<td>

<p>Lower bioequivalence limit. Defaults to 0.8.
</p>
</td></tr>
<tr><td><code id="power.tsd.p_+3A_theta2">theta2</code></td>
<td>

<p>Upper bioequivalence limit. Defaults to 1.25.
</p>
</td></tr>
<tr><td><code id="power.tsd.p_+3A_npct">npct</code></td>
<td>

<p>Percentiles to be used for the presentation of the distribution of
<code style="white-space: pre;">&#8288;n(total)=n1+n2&#8288;</code>.<br />
Defaults to <code style="white-space: pre;">&#8288;c(0.05, 0.5, 0.95)&#8288;</code> to obtain the 5% and 95% percentiles
and the median.
</p>
</td></tr>
<tr><td><code id="power.tsd.p_+3A_nsims">nsims</code></td>
<td>

<p>Number of studies to simulate.<br />
If missing, <code style="white-space: pre;">&#8288;nsims&#8288;</code> is set to 1E+05 = 100,000 or to 1E+06 = 1 Mio if
estimating the empiric Type I Error (<code style="white-space: pre;">&#8288;'alpha'&#8288;</code>), <em>i.e.</em>, with <code style="white-space: pre;">&#8288;theta0&#8288;</code> at
the border or outside the acceptance range <code style="white-space: pre;">&#8288;theta1&#8288;</code> ... <code style="white-space: pre;">&#8288;theta2&#8288;</code>.
</p>
</td></tr>
<tr><td><code id="power.tsd.p_+3A_setseed">setseed</code></td>
<td>

<p>Simulations are dependent on the starting point of the (pseudo) random number
generator. To avoid differences in power for different runs a
<code>set.seed(1234567)</code> is issued if <code style="white-space: pre;">&#8288;setseed=TRUE&#8288;</code>, the default.<br />
Set this argument to <code style="white-space: pre;">&#8288;FALSE&#8288;</code> to view the variation in power between
different runs.
</p>
</td></tr>
<tr><td><code id="power.tsd.p_+3A_details">details</code></td>
<td>

<p>If set to <code style="white-space: pre;">&#8288;TRUE&#8288;</code> the function prints the results of time measurements
of the simulation steps. Defaults to <code style="white-space: pre;">&#8288;FALSE&#8288;</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The calculations follow in principle the simulations as described by Fuglsang.<br />
The underlying subject data are assumed to be evaluated after log-transformation.
But instead of simulating subject data the statistics (mean and variance of Test
and Reference of stage&nbsp;1 and
stage&nbsp;2) are simulated via their associated
distributions (normal and &chi;<sup>2</sup>).
</p>


<h3>Value</h3>

<p>Returns an object of class <code style="white-space: pre;">&#8288;"pwrtsd"&#8288;</code> with all the input arguments and results
as components.<br />
The class <code style="white-space: pre;">&#8288;"pwrtsd"&#8288;</code> has an S3 print method.<br />
The results are in the components:
</p>
<table>
<tr><td><code>pBE</code></td>
<td>
<p>Fraction of studies found BE.</p>
</td></tr>
<tr><td><code>pBE_s1</code></td>
<td>
<p>Fraction of studies found BE in stage&nbsp;1.</p>
</td></tr>
<tr><td><code>pct_s2</code></td>
<td>
<p>Percentage of studies continuing to stage&nbsp;2.</p>
</td></tr>
<tr><td><code>nmean</code></td>
<td>
<p>Mean of n(total).</p>
</td></tr>
<tr><td><code>nrange</code></td>
<td>
<p>Range (min, max) of n(total).</p>
</td></tr>
<tr><td><code>nperc</code></td>
<td>
<p>Percentiles of the distribution of n(total).</p>
</td></tr>
<tr><td><code>ntable</code></td>
<td>
<p>Object of class <code style="white-space: pre;">&#8288;"table"&#8288;</code> summarizing the discrete distribution of
n(total) via its distinct values and counts of occurences of these values.
This component is only given back if <code style="white-space: pre;">&#8288;usePE==FALSE&#8288;</code> or otherwise if
<code style="white-space: pre;">&#8288;is.finite(Nmax)&#8288;</code>, <em>i.e.</em>, a futility criterion is used.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>D. Labes
</p>


<h3>References</h3>

<p>Fuglsang A. <em>Sequential Bioequivalence Approaches for Parallel Design.</em><br />
AAPS J. 2014; 16(3):373&ndash;8. doi: <a href="https://doi.org/10.1208/s12248-014-9571-1">10.1208/s12248-014-9571-1</a>
</p>
<p>Potvin D, DiLiberti CE, Hauck WW, Parr AF, Schuirmann DJ, Smith RA. <em>Sequential design approaches for bioequivalence studies with crossover designs.</em><br />
Pharm Stat. 2008; 7(4):245&ndash;62. doi: <a href="https://doi.org/10.1002/pst.294">10.1002/pst.294</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+power.2stage">power.2stage</a></code> for analogous calculations for the 2√ó2 crossover.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># using all the defaults
power.tsd.p(n1=48, CV=0.25)
</code></pre>

<hr>
<h2 id='power.tsd.ssr'>
Power of 2-stage BE studies in 2x2 crossover designs with interim
sample size re-estimation
</h2><span id='topic+power.2stage.ssr'></span><span id='topic+power.tsd.ssr'></span>

<h3>Description</h3>

<p>This function calculates the &lsquo;empiric&rsquo; power (via simulations) of
2-stage BE studies with interim sample size re-estimation (<em>i.e.</em>,
but no BE decision after stage&nbsp;1).
The sample size re-estimation can be done blinded or unblinded.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>power.tsd.ssr(alpha = 0.05, n1, GMR, CV, targetpower = 0.8,
              pmethod = c("nct", "exact", "shifted", "ls"), blind = FALSE,
              usePE = FALSE, min.n = 0, max.n = Inf, theta0, theta1, theta2,
              npct = c(0.05, 0.5, 0.95), nsims, setseed = TRUE, details = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="power.tsd.ssr_+3A_alpha">alpha</code></td>
<td>

<p>Nominal type I error. Has to be adjusted in case of inflation of
the Type I Error.
</p>
</td></tr>
<tr><td><code id="power.tsd.ssr_+3A_n1">n1</code></td>
<td>

<p>Sample size of stage&nbsp;1.
</p>
</td></tr>
<tr><td><code id="power.tsd.ssr_+3A_gmr">GMR</code></td>
<td>

<p>Ratio T/R to be used in the sample size re-estimation.<br />
Defaults to 0.95 if missing.
</p>
</td></tr>
<tr><td><code id="power.tsd.ssr_+3A_cv">CV</code></td>
<td>

<p>Coefficient of variation of the intra-subject variability
(use <em>e.g.</em>, 0.3 for 30%).<br />
Anticipated population value.
</p>
</td></tr>
<tr><td><code id="power.tsd.ssr_+3A_targetpower">targetpower</code></td>
<td>

<p>Power to achieve in the sample size estimation step.
</p>
</td></tr>
<tr><td><code id="power.tsd.ssr_+3A_pmethod">pmethod</code></td>
<td>

<p>Power calculation method to be used in the sample size re-estimation for
stage&nbsp;2.<br />
Implemented are <code style="white-space: pre;">&#8288;"nct"&#8288;</code> (approximate calculations via non-central
<em>t</em>-distribution, <code style="white-space: pre;">&#8288;"exact"&#8288;</code> (exact calculations via Owen‚Äôs
Q), and <code style="white-space: pre;">&#8288;"shifted"&#8288;</code> (approximate calculation via shifted central
<em>t</em>-distribution.<br />
Also implemented is the large sample approximation as used in the references.<br />
Defaults to <code style="white-space: pre;">&#8288;"nct"&#8288;</code> as a reasonable compromise between speed and
accuracy in the sample size estimation step.
</p>
</td></tr>
<tr><td><code id="power.tsd.ssr_+3A_blind">blind</code></td>
<td>

<p>If <code style="white-space: pre;">&#8288;TRUE&#8288;</code> the blinded estimate of the intra-subject variance, <em>i.e.</em>,
the estimate from the period differences, is used in sample size estimation.<br />
If <code style="white-space: pre;">&#8288;FALSE&#8288;</code> the usual <abbr><span class="acronym">MSE</span></abbr> from stage&nbsp;1
is used.<br />
Defaults to <code style="white-space: pre;">&#8288;FALSE&#8288;</code> since most <abbr><span class="acronym">BE</span></abbr> studies are open.
</p>
</td></tr>
<tr><td><code id="power.tsd.ssr_+3A_usepe">usePE</code></td>
<td>

<p>If <code style="white-space: pre;">&#8288;TRUE&#8288;</code> the point estimate from the interim analysis is used in the
sample size re-estimation. Defaults to <code style="white-space: pre;">&#8288;FALSE&#8288;</code>.<br />
<code style="white-space: pre;">&#8288;usePE = TRUE&#8288;</code> doesn‚Äôt make sense if <code style="white-space: pre;">&#8288;blind = TRUE&#8288;</code>. In that
case the function issues a warning and <code style="white-space: pre;">&#8288;usePE&#8288;</code> is reset to <code style="white-space: pre;">&#8288;usePE = FALSE&#8288;</code>.
</p>
</td></tr>
<tr><td><code id="power.tsd.ssr_+3A_min.n">min.n</code></td>
<td>

<p>If <code style="white-space: pre;">&#8288;min.n&gt;n1&#8288;</code>, the re-estimated sample size (<code style="white-space: pre;">&#8288;N&#8288;</code>) is set to
<code style="white-space: pre;">&#8288;max(min.n,N)&#8288;</code>.<br />
If <code style="white-space: pre;">&#8288;min.n=0&#8288;</code> (the default), no minimal sample size is applied.
</p>
</td></tr>
<tr><td><code id="power.tsd.ssr_+3A_max.n">max.n</code></td>
<td>

<p>If <code style="white-space: pre;">&#8288;max.n&#8288;</code> is set to a finite value the re-estimated sample size (<code style="white-space: pre;">&#8288;N&#8288;</code>)
is set to <code style="white-space: pre;">&#8288;min(max.n,N)&#8288;</code>.<br />
Defaults to <code style="white-space: pre;">&#8288;Inf&#8288;</code> which is equivalent to not constrain the re-estimated
sample size.<br />
Attention! <code style="white-space: pre;">&#8288;max.n&#8288;</code> is here <b>not</b> a futility criterion like <code style="white-space: pre;">&#8288;Nmax&#8288;</code>
in other functions of this package.
</p>
</td></tr>
<tr><td><code id="power.tsd.ssr_+3A_theta0">theta0</code></td>
<td>

<p>Assumed ratio of geometric means (T/R) for simulations. If missing, defaults
to <code style="white-space: pre;">&#8288;GMR&#8288;</code>.
</p>
</td></tr>
<tr><td><code id="power.tsd.ssr_+3A_theta1">theta1</code></td>
<td>

<p>Lower bioequivalence limit. Defaults to 0.8.
</p>
</td></tr>
<tr><td><code id="power.tsd.ssr_+3A_theta2">theta2</code></td>
<td>

<p>Upper bioequivalence limit. Defaults to 1.25.
</p>
</td></tr>
<tr><td><code id="power.tsd.ssr_+3A_npct">npct</code></td>
<td>

<p>Percentiles to be used for the presentation of the distribution of
<code style="white-space: pre;">&#8288;n(total)=n1+n2&#8288;</code>.<br />
Defaults to <code style="white-space: pre;">&#8288;c(0.05, 0.5, 0.95)&#8288;</code> to obtain the 5% and 95% percentiles
and the median.
</p>
</td></tr>
<tr><td><code id="power.tsd.ssr_+3A_nsims">nsims</code></td>
<td>

<p>Number of studies to simulate.<br />
If missing, <code style="white-space: pre;">&#8288;nsims&#8288;</code> is set to 1E+05 = 100,000 or to 1E+06 = 1 Mio if
estimating the empiric Type I Error (<code style="white-space: pre;">&#8288;'alpha'&#8288;</code>), <em>i.e.</em>, with <code style="white-space: pre;">&#8288;theta0&#8288;</code>
at the border or outside the acceptance range <code style="white-space: pre;">&#8288;theta1&#8288;</code> ... <code style="white-space: pre;">&#8288;theta2&#8288;</code>.
</p>
</td></tr>
<tr><td><code id="power.tsd.ssr_+3A_setseed">setseed</code></td>
<td>

<p>Simulations are dependent on the starting point of the (pseudo) random number
generator. To avoid differences in power for different runs a
<code>set.seed(1234567)</code> is issued if <code style="white-space: pre;">&#8288;setseed=TRUE&#8288;</code>, the default.<br />
Set this argument to <code style="white-space: pre;">&#8288;FALSE&#8288;</code> to view the variation in power between
different runs.
</p>
</td></tr>
<tr><td><code id="power.tsd.ssr_+3A_details">details</code></td>
<td>

<p>If set to <code style="white-space: pre;">&#8288;TRUE&#8288;</code> the function prints the results of time measurements
of the simulation steps. Defaults to <code style="white-space: pre;">&#8288;FALSE&#8288;</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The calculations follow in principle the simulations as described in Potvin
<em>et al</em>.<br />
The underlying subject data are assumed to be evaluated after log-transformation.
But instead of simulating subject data, the statistics pe1, mse1 and pe2, SS2 are
simulated via their associated distributions (normal and
&chi;<sup>2</sup> distributions).
</p>


<h3>Value</h3>

<p>Returns an object of class class <code style="white-space: pre;">&#8288;"pwrtsd"&#8288;</code> with all the input arguments and results
as components.<br />
The class class <code style="white-space: pre;">&#8288;"pwrtsd"&#8288;</code> has a S3 print method.<br />
The results are in the components:
</p>
<table>
<tr><td><code>pBE</code></td>
<td>
<p>Fraction of studies found BE.</p>
</td></tr>
<tr><td><code>pct_s2</code></td>
<td>
<p>Percentage of studies continuing to stage&nbsp;2.</p>
</td></tr>
<tr><td><code>nmean</code></td>
<td>
<p>Mean of n(total).</p>
</td></tr>
<tr><td><code>nrange</code></td>
<td>
<p>Range (min, max) of n(total).</p>
</td></tr>
<tr><td><code>nperc</code></td>
<td>
<p>Percentiles of the distribution of n(total).</p>
</td></tr>
<tr><td><code>ntable</code></td>
<td>
<p>Object of class <code style="white-space: pre;">&#8288;"table"&#8288;</code> summarizing the discrete distribution of
n(total) via its unique values and counts of occurences of these values.<br />
ntable is only given back if <code style="white-space: pre;">&#8288;usePE = FALSE&#8288;</code></p>
</td></tr>
</table>


<h3>Note</h3>

<p>The computation time is in the magnitude of a few seconds for 100,000 sim‚Äôs
on my machine (Intel core i7 2.5 GHz, 12GB RAM) if the non-central <em>t</em>
approximation is used. Thus be a bit patient if you simulate for the Tpye I Error
'alpha' with 1 Mio sim‚Äôs.<br />
Using the crude <code style="white-space: pre;">&#8288;pmethod="ls"&#8288;</code> on the other hand results in a nearly immediate
sample size re-estimation.
</p>


<h3>Author(s)</h3>

<p>D. Labes
</p>


<h3>References</h3>

<p>Golkowski D, Friede T, Kieser M. <em>Blinded sample size re-estimation in crossover bioequivalence trials.</em><br />
Pharm Stat. 2014; 13(3):157&ndash;62. doi: <a href="https://doi.org/10.1002/pst.1617">10.1002/pst.1617</a>
</p>
<p>Jones B, Kenward MG. <em>Design and Analysis of Cross-Over Trials.</em><br />
Boca Raton: CRC Press; 3<sup>rd</sup> edition 2014. Chapter 12.
</p>
<p>Potvin D, DiLiberti CE, Hauck WW, Parr AF, Schuirmann DJ, Smith RA. <em>Sequential design approaches for bioequivalence studies with crossover designs.</em><br />
Pharm Stat. 2008; 7(4):245&ndash;62. doi: <a href="https://doi.org/10.1002/pst.294">10.1002/pst.294</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+power.tsd">power.tsd</a></code> for 2-stage studies with interim BE decision.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Not run to comply with CRAN policy about examples' run-time;
# minimum number of sim's should be 1E5 for 'power', 1E6 sim's for 'alpha'
## Not run: 
power.tsd.ssr(alpha=0.05, n1=10, GMR=1, CV=0.239, targetpower=0.9,
              pmethod="ls", blind=TRUE, theta0=1.25)
# should give an alpha-inflation 0.072359 (run time &lt;5 seconds)
# repeated with noncentral t-approximation
power.tsd.ssr(alpha=0.05, n1=10, GMR=1, CV=0.239, targetpower=0.9,
              pmethod="nct", blind=TRUE, theta0=1.25)
# should give an alpha-inflation 0.069789 (run time ~20 seconds)
#
# adjusted alpha to control the Type I Error, noncentral t-approx.
power.tsd.ssr(alpha=0.03505, n1=10, GMR=1, CV=0.239, targetpower=0.9,
              pmethod="nct", blind=TRUE, theta0=1.25)
# should control the TIE with 0.049877
## End(Not run)
</code></pre>

<hr>
<h2 id='sampleN2.TOST'>
Sample size re-estimation of adaptive 2-stage BE studies in 2x2 crossover and 
parallel designs based on power of TOST
</h2><span id='topic+sampleN2.TOST'></span>

<h3>Description</h3>

<p>This function estimates the necessary sample size of
stage&nbsp;2 to have at least a given power.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sampleN2.TOST(alpha = 0.0294, CV, n1, theta0 = 0.95,
              theta1 = 0.8, theta2 = 1.25, targetpower = 0.8,
              design = "2x2", method = "exact", imax = 100)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sampleN2.TOST_+3A_alpha">alpha</code></td>
<td>

<p>Alpha value for the final analysis of pooled data. Defaults to Pocock‚Äôs
alpha setting <code style="white-space: pre;">&#8288;alpha=0.0294&#8288;</code>.
</p>
</td></tr>
<tr><td><code id="sampleN2.TOST_+3A_cv">CV</code></td>
<td>

<p>Coefficient of variation of the intra-subject variability as ratio.
</p>
</td></tr>
<tr><td><code id="sampleN2.TOST_+3A_n1">n1</code></td>
<td>

<p>Sample size of stage&nbsp;1.
</p>
</td></tr>
<tr><td><code id="sampleN2.TOST_+3A_theta0">theta0</code></td>
<td>

<p>True ratio of T/R for simulating. Defaults to 0.95 argument if missing.
</p>
</td></tr>
<tr><td><code id="sampleN2.TOST_+3A_theta1">theta1</code></td>
<td>

<p>Lower bioequivalence limit. Defaults to 0.8.
</p>
</td></tr>
<tr><td><code id="sampleN2.TOST_+3A_theta2">theta2</code></td>
<td>

<p>Upper bioequivalence limit. Defaults to 1.25.
</p>
</td></tr>
<tr><td><code id="sampleN2.TOST_+3A_targetpower">targetpower</code></td>
<td>

<p>Power to achieve at least. Must be &gt;0 and &lt;1.
</p>
</td></tr>
<tr><td><code id="sampleN2.TOST_+3A_design">design</code></td>
<td>

<p>Character string describing the study design. Implemented are <code style="white-space: pre;">&#8288;"2x2"&#8288;</code>
and <code style="white-space: pre;">&#8288;"parallel"&#8288;</code>.
</p>
</td></tr>
<tr><td><code id="sampleN2.TOST_+3A_method">method</code></td>
<td>

<p>Method for calculation of the power. Implemented are <code style="white-space: pre;">&#8288;"exact"&#8288;</code>
(exact calculation via Owen‚Äôs Q), <code style="white-space: pre;">&#8288;"nct"&#8288;</code> (approximate
calculation via non-central <em>t</em>-distribution, and <code style="white-space: pre;">&#8288;"shifted"&#8288;</code>
(approximate calculation via shifted central <em>t</em>-distribution
like in the paper of Potvin <em>et al.</em><br />
Defaults to <code style="white-space: pre;">&#8288;"exact"&#8288;</code>.
</p>
</td></tr>
<tr><td><code id="sampleN2.TOST_+3A_imax">imax</code></td>
<td>

<p>Maximum number of steps in sample size search.<br />
Defaults to 100. Adaption only in rare cases needed.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The sample size is calculated via iterative evaluation of power of the
TOST procedure.<br />
Start value for the sample size search is taken from a large sample
approximation according to Zhang, modified.
</p>


<h3>Value</h3>

<p>A data.frame with the input and results will be returned.<br />
The &quot;Sample size&quot; column contains the sample size for the second stage.
</p>


<h3>Note</h3>

<p>Since in the final analysis one degree of freedom less than in a fixed sample
design (or in stage&nbsp;1) is used, power will
be slightly lower than the one obtained with function <code style="white-space: pre;">&#8288;sampleN.TOST&#8288;</code> of
package <code style="white-space: pre;">&#8288;PowerTOST&#8288;</code>. However, different <em>sample sizes</em> are extremely
unlikely.
</p>


<h3>Author(s)</h3>

<p>H. Sch√ºtz, D. Labes
</p>


<h3>References</h3>

<p>Potvin D, DiLiberti CE, Hauck WW, Parr AF, Schuirmann DJ, Smith RA. <br />
<em>Sequential design approaches for bioequivalence studies with crossover designs.</em><br />
Pharm Stat. 2008; 7(4):245&ndash;62. doi: <a href="https://doi.org/10.1002/pst.294">10.1002/pst.294</a>
</p>
<p>Zhang P. <em>A Simple Formula for Sample Size Calculation in Equivalence Studies.</em><br />
J Biopharm Stat. 2003; 13(3):529&ndash;38. doi: <a href="https://doi.org/10.1081/BIP-120022772">10.1081/BIP-120022772</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># using all the defaults, CV of 25% and 12 subjects in stage 1
print(sampleN2.TOST(CV=0.25, n1=12), row.names=FALSE)
# should give a stage 2 sample size of 22 and achieved power ~0.812
# CV 10% and 12 subjects in stage 1
print(sampleN2.TOST(CV=0.1, n1=12), row.names=FALSE)
# should give a sample size of 0 (second stage not reasonable
# since power ~0.973 was already achieved in stage 1)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
