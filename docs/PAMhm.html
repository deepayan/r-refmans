<!DOCTYPE html><html><head><title>Help for package PAMhm</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {PAMhm}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#PAM.hm'><p>Main function to produce a heatmap using PAM clustering.</p></a></li>
<li><a href='#PAMhm'><p>Generate Heatmaps Based on Partioning Around Medoids (PAM)</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Generate Heatmaps Based on Partitioning Around Medoids (PAM)</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-08-24</td>
</tr>
<tr>
<td>Author:</td>
<td>Vidal Fey [aut, cre],
  Henri Sara [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Vidal Fey &lt;vidal.fey@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Data are partitioned (clustered) into k clusters "around medoids", which is
    a more robust version of K-means implemented in the function pam() in the 'cluster' package.
    The PAM algorithm is described in Kaufman and Rousseeuw (1990) &lt;<a href="https://doi.org/10.1002%2F9780470316801">doi:10.1002/9780470316801</a>&gt;.
    Please refer to the pam() function documentation for more references.
    Clustered data is plotted as a split heatmap allowing visualisation of representative
    "group-clusters" (medoids) in the data as separated fractions of the graph while those
    "sub-clusters" are visualised as a traditional heatmap based on hierarchical clustering.</td>
</tr>
<tr>
<td>Depends:</td>
<td>heatmapFlex, cluster, grDevices, graphics, stats</td>
</tr>
<tr>
<td>Imports:</td>
<td>RColorBrewer, R.utils, readxl, readmoRe, utils, plyr, robustHD</td>
</tr>
<tr>
<td>Suggests:</td>
<td>rmarkdown, knitr</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-08-24 08:51:36 UTC; fsvife</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-09-06 07:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='PAM.hm'>Main function to produce a heatmap using PAM clustering.</h2><span id='topic+PAM.hm'></span>

<h3>Description</h3>

<p>This is the main wrapper function to be called by end users. It accepts a numeric matrix
(or an object that can be coerced to a numeric matrix) or a number of data file formats and produces one or
more PDFs with the plots.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PAM.hm(
  x,
  project.folder = ".",
  nsheets = 1,
  dec = ".",
  header = TRUE,
  symbolcol = 1,
  sample.names = NULL,
  cluster.number = 4,
  trim = NULL,
  winsorize.mat = TRUE,
  cols = "BlueWhiteRed",
  dendrograms = "Both",
  autoadj = TRUE,
  pdf.height = 10,
  pdf.width = 10,
  labelheight = 0.25,
  labelwidth = 0.2,
  r.cex = 0.5,
  c.cex = 1,
  medianCenter = NULL,
  log = FALSE,
  do.log = FALSE,
  log.base = 2,
  metric = "manhattan",
  na.strings = "NA",
  makeFolder = TRUE,
  do.pdf = FALSE,
  do.png = FALSE,
  save.objects = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PAM.hm_+3A_x">x</code></td>
<td>
<p>(<code>character</code>, <code>data.frame</code>, <code>numeric</code>). The name(s) of the input files(s) (character vector)
or a data object such as a <code>data.frame</code> or <code>numeric matrix</code>. See 'Details'.</p>
</td></tr>
<tr><td><code id="PAM.hm_+3A_project.folder">project.folder</code></td>
<td>
<p>(<code>character</code>). Name of the root folder inside which the results will be created if any files are to be saved. See 'Details'.</p>
</td></tr>
<tr><td><code id="PAM.hm_+3A_nsheets">nsheets</code></td>
<td>
<p>(<code>integer</code>). Number of sheets to be read if file is of type &quot;.xls&quot; or &quot;.xlsx&quot;. All sheets starting from 1 up to the
given number in the respective data file will be read. If more than one file is read this must be be an integer vector with the
numbers of sheets in exactly the same order as the files.</p>
</td></tr>
<tr><td><code id="PAM.hm_+3A_dec">dec</code></td>
<td>
<p>(<code>character</code>). The decimal separator for numbers.</p>
</td></tr>
<tr><td><code id="PAM.hm_+3A_header">header</code></td>
<td>
<p>(<code>logical</code>). Does the input file have a header row?</p>
</td></tr>
<tr><td><code id="PAM.hm_+3A_symbolcol">symbolcol</code></td>
<td>
<p>(<code>character</code>). The name of the column with identifiers used as labels.</p>
</td></tr>
<tr><td><code id="PAM.hm_+3A_sample.names">sample.names</code></td>
<td>
<p>(<code>character</code>). A vector of names used for plot titles and output files.</p>
</td></tr>
<tr><td><code id="PAM.hm_+3A_cluster.number">cluster.number</code></td>
<td>
<p>(<code>character</code> or <code>integer</code>). A vector of numbers used for PAM clustering (corresponds to argument
<code>k</code> in <code><a href="cluster.html#topic+pam">pam</a></code>). If a character vector, this is broken down to a numeric vector accepting
comma-separated strings in the form of, e.g, &quot;4&quot; and &quot;2-5&quot;. The clustering algorithm then iterates through all given numbers.
See 'Details'.</p>
</td></tr>
<tr><td><code id="PAM.hm_+3A_trim">trim</code></td>
<td>
<p>(<code>numeric</code>). Value to &quot;cut off&quot; data distribution. Values at both ends of the distribution,
larger or smaller, respectively, will be made equal to <code>+/-trim</code>, i.e., data will be symmetrical around 0.
<code>NULL</code> means no trimming which is the default. If <code>trim</code> is <code>-1</code> (or any negative value) and
<code>winsorize.mat</code> is <code>TRUE</code> the matrix will be <em>winsorized</em> and then the smaller of the two largest
absolute values at both ends of the distribution rounded to three digits will be used. If <code>winsorize.mat</code>
is <code>FALSE</code> the largest possible absolute integer, i.e., the smaller of the to extreme integers is used.
Trimming is disabled for only positive or only negative values.</p>
</td></tr>
<tr><td><code id="PAM.hm_+3A_winsorize.mat">winsorize.mat</code></td>
<td>
<p>(<code>logical</code>). Should the matrix be <em>winsorized</em> (cleaned of outliers) before plotting?
Defaults to <code>TRUE</code>. See 'Details'.</p>
</td></tr>
<tr><td><code id="PAM.hm_+3A_cols">cols</code></td>
<td>
<p>(<code>character</code>). Name of the colour palette.</p>
</td></tr>
<tr><td><code id="PAM.hm_+3A_dendrograms">dendrograms</code></td>
<td>
<p>(<code>character</code>). Which dendrograms are to be plotted? One of &quot;Vertical&quot;, &quot;Horizontal&quot;,
&quot;None&quot; or &quot;Both&quot;. Defaults to &quot;Both&quot;.</p>
</td></tr>
<tr><td><code id="PAM.hm_+3A_autoadj">autoadj</code></td>
<td>
<p>(<code>logical</code>). Should label sizes and pdf dimensions be adjusted automatically? See 'Details'.</p>
</td></tr>
<tr><td><code id="PAM.hm_+3A_pdf.height">pdf.height</code></td>
<td>
<p>(<code>numeric</code>). Heigth of the PDF device.</p>
</td></tr>
<tr><td><code id="PAM.hm_+3A_pdf.width">pdf.width</code></td>
<td>
<p>(<code>numeric</code>). Width of the PDF device.</p>
</td></tr>
<tr><td><code id="PAM.hm_+3A_labelheight">labelheight</code></td>
<td>
<p>(<code>numeric</code> or <code>lcm(numeric)</code>). Relative or absolute height (using <code>lcm</code>, see <code>layout</code>) of the labels.</p>
</td></tr>
<tr><td><code id="PAM.hm_+3A_labelwidth">labelwidth</code></td>
<td>
<p>(<code>numeric</code> or <code>lcm(numeric)</code>). Relative or absolute width (using <code>lcm</code>, see <code>layout</code>) of the labels.</p>
</td></tr>
<tr><td><code id="PAM.hm_+3A_r.cex">r.cex</code></td>
<td>
<p>(<code>numeric</code>). Font size for row labels.</p>
</td></tr>
<tr><td><code id="PAM.hm_+3A_c.cex">c.cex</code></td>
<td>
<p>(<code>numeric</code>). Font size for column labels.</p>
</td></tr>
<tr><td><code id="PAM.hm_+3A_mediancenter">medianCenter</code></td>
<td>
<p>(<code>character</code>). If not <code>NULL</code>, how should data be median-centered? One of &quot;grand&quot;,
&quot;row&quot; or &quot;column&quot;. Defaults to <code>NULL</code>, no median-centering.</p>
</td></tr>
<tr><td><code id="PAM.hm_+3A_log">log</code></td>
<td>
<p>(<code>logical</code>). Is the data on log-scale. (The log-base is given in argument <code>log.base</code>).</p>
</td></tr>
<tr><td><code id="PAM.hm_+3A_do.log">do.log</code></td>
<td>
<p>(<code>logical</code>). Should data be log-transformed? (The log-base is given in argument <code>log.base</code>).</p>
</td></tr>
<tr><td><code id="PAM.hm_+3A_log.base">log.base</code></td>
<td>
<p>(<code>numeric</code>). The log-base used for <code>log</code> and <code>do.log</code>.</p>
</td></tr>
<tr><td><code id="PAM.hm_+3A_metric">metric</code></td>
<td>
<p>(<code>character</code>). The metric metric to be used for calculating dissimilarities between observations.
The currently available options are &quot;euclidean&quot; and &quot;manhattan&quot;. Euclidean distances are root sum-of-squares of differences,
and manhattan distances are the sum of absolute differences. Defaults to &quot;manhattan&quot;.</p>
</td></tr>
<tr><td><code id="PAM.hm_+3A_na.strings">na.strings</code></td>
<td>
<p>(<code>character</code>). Character vector of strings to interpret as missing values when reading data files
with <code>read.table</code> or <code>readxlread_excel</code>. By default, <code>readxl</code> treats blank cells as missing data.</p>
</td></tr>
<tr><td><code id="PAM.hm_+3A_makefolder">makeFolder</code></td>
<td>
<p>(<code>logical</code>). Should the results folder be created?</p>
</td></tr>
<tr><td><code id="PAM.hm_+3A_do.pdf">do.pdf</code></td>
<td>
<p>(<code>logical</code>). Should images be saved to PDFs?</p>
</td></tr>
<tr><td><code id="PAM.hm_+3A_do.png">do.png</code></td>
<td>
<p>(<code>logical</code>). Should images be saved to PNGs?</p>
</td></tr>
<tr><td><code id="PAM.hm_+3A_save.objects">save.objects</code></td>
<td>
<p>(<code>logical</code>). Should R objects be save to disk?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Argument <code>x</code> can be a <code>data.frame</code> or numeric matrix to be used directly for plotting the heatmap.
If it is a <code>data.frame</code> argument <code>symbolcol</code> sets the respective columns for symbols to be used as
labels and the column where the numeric data starts.
</p>
<p>Matrices will be coerced to data frames.
</p>
<p>The read function accepts txt, tsv, csv and xls files.
</p>
<p>If PDF, PNG or R object files are to be saved, i.e., if the corresponding arguments are <code>TRUE</code>, a results
folder will be created using time and date to create a unique name. The folder will be created in the directory
set by argument <code>project.folder</code>. The reasoning behind that behaviour is that during development the
heatmap was used as data analysis tool testing various <code>cluster.number</code> values with numerous files and
comparing the results.
</p>
<p>The <code>cluster.number</code> argument defines the numbers of clusters when doing PAM. After processing it is passed
one-by-one to argument <code>k</code> in <code><a href="cluster.html#topic+pam">pam</a></code>. The numbers can be defined in the form
<code>c("2","4-7", "9")</code>, for example, depending on the experimental setup. An integer vector is coerced to
character.
</p>
<p>If <code>autoadj</code> is <code>TRUE</code> character expansion (cex) for rows annd columns, pdf width and height and
label width and height are adjusted automatically based on the dimensions of the data matrix and length
(number of characters) of the labels.
</p>
<p>The default behavior regarding outliers is to <em>winsorize</em> the matrix before plotting, i.e., shrink outliers
to the unscattered part of the data by replacing extreme values at both ends of the distribution with less
extreme values. This is done for the same reason as trimming but the data will not be symmetrical around 0.
</p>


<h3>Value</h3>

<p>A list: Invisibly returns the results object from the PAM clustering.
</p>


<h3>References</h3>

<p>Kaufman, L., &amp; Rousseeuw, P. J. (Eds.). (1990). <em>Finding Groups in Data: An Introduction to Cluster Analysis.</em>
John Wiley &amp; Sons, Inc. doi: <a href="https://doi.org/10.1002/9780470316801">10.1002/9780470316801</a>
</p>


<h3>See Also</h3>

<p><code><a href="utils.html#topic+read.delim">read.delim</a></code>
</p>
<p><code><a href="readxl.html#topic+read_excel">read_excel</a></code>
</p>
<p><code><a href="cluster.html#topic+pam">pam</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate a random 10x10 matrix and plot it using default values
set.seed(1234)                                  # for reproducibility
mat &lt;- matrix(rnorm(120), nrow = 20)            # standard normal
PAM.hm(mat, cluster.number = 3)

## Plot with more than one cluster number
PAM.hm(mat, cluster.number = 2:4)               # integer vector
PAM.hm(mat, cluster.number = c("2", "4-5"))     # character vector

# Using the 'trim' argument
## Introduce outlier to the matrix and plot w/o trimming or winsorization
mat[1] &lt;- mat[1] * 10
PAM.hm(mat, cluster.number = 3, trim = NULL, winsorize = FALSE)

## calculate a trim value by getting the largest possible absolute integer and
## plot again
tr &lt;- min(abs(ceiling(c(min(mat, na.rm = TRUE), max(mat, na.rm = TRUE)))),
    na.rm = TRUE)
PAM.hm(mat, cluster.number = 3, trim = tr, winsorize = FALSE)
## Note that the outlier is still visible but since it is less extreme
## it does not distort the colour scheme.

# An example reading data from an Excel file
# The function readxl::read_excel is used internally to read Excel files.
# The example uses their example data.
readxl_datasets &lt;- readxl::readxl_example("datasets.xlsx")
PAM.hm(readxl_datasets, cluster.number = 4, symbolcol = 5)

</code></pre>

<hr>
<h2 id='PAMhm'>Generate Heatmaps Based on Partioning Around Medoids (PAM)</h2><span id='topic+PAMhm'></span>

<h3>Description</h3>

<p>Data are partitioned (clustered) into k clusters &quot;around medoids&quot;, which is
a more robust version of K-means implemented in the function pam() in the 'cluster' package.
The PAM algorithm is described in Kaufman and Rousseeuw (1990) &lt;doi:10.1002/9780470316801&gt;.
Please refer to the pam() function documentation for more references.
Clustered data is plotted as a split heatmap allowing visualisation of representative
&quot;group-clusters&quot; (medoids) in the data as separated fractions of the graph while those
&quot;sub-clusters&quot; are visualised as a traditional heatmap based on hierarchical clustering.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> PAMhm</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Initial version: </td><td style="text-align: left;"> 0.1-0</td>
</tr>
<tr>
 <td style="text-align: left;">
Created: </td><td style="text-align: left;"> 2011-01-07</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-3</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Vidal Fey &lt;vidal.fey@gmail.com&gt;, Henri Sara &lt;henri.sara@gmail.com&gt;
Maintainer: Vidal Fey &lt;vidal.fey@gmail.com&gt;
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
