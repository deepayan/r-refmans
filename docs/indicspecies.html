<!DOCTYPE html><html><head><title>Help for package indicspecies</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {indicspecies}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#birds'><p>Birds resource use data</p></a></li>
<li><a href='#combinespecies'><p>Combines species from a community table</p></a></li>
<li><a href='#coverage'><p>Coverage of a set of indicators</p></a></li>
<li><a href='#indicators'><p>Indicator analysis for species combinations</p></a></li>
<li><a href='#multipatt'><p>Multi-level pattern analysis</p></a></li>
<li><a href='#nichecentroid'><p>Resource niche metrics for a single niche</p></a></li>
<li><a href='#nichedispl'><p>Metrics to compare pairs of resource niches</p></a></li>
<li><a href='#pigeons'><p>Pigeon seed consumption data</p></a></li>
<li><a href='#plotniche'><p>Draws a single resource niche</p></a></li>
<li><a href='#predict.indicators'><p>Predicts site group from indicators</p></a></li>
<li><a href='#pruneindicators'><p>Determines the best subset of indicators</p></a></li>
<li><a href='#signassoc'><p>Statistical significance of species site-group associations</p></a></li>
<li><a href='#strassoc'><p>Strength of species site-group associations</p></a></li>
<li><a href='#summary.multipatt'><p>Summarizing multi-level pattern analysis</p></a></li>
<li><a href='#wetland'><p>Wetland vegetation data set</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Relationship Between Species and Groups of Sites</td>
</tr>
<tr>
<td>Version:</td>
<td>1.7.14</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-07-20</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions to assess the strength and statistical significance of the relationship between species occurrence/abundance and groups of sites [De Caceres &amp; Legendre (2009) &lt;<a href="https://doi.org/10.1890%2F08-1823.1">doi:10.1890/08-1823.1</a>&gt;]. Also includes functions to measure species niche breadth using resource categories [De Caceres et al. (2011) &lt;<a href="https://doi.org/10.1111%2FJ.1600-0706.2011.19679.x">doi:10.1111/J.1600-0706.2011.19679.x</a>&gt;].</td>
</tr>
<tr>
<td>Depends:</td>
<td>permute</td>
</tr>
<tr>
<td>Suggests:</td>
<td>rmarkdown, knitr, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://emf-creaf.github.io/indicspecies/">https://emf-creaf.github.io/indicspecies/</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-07-20 08:42:37 UTC; miquel</td>
</tr>
<tr>
<td>Author:</td>
<td>Miquel De Cáceres <a href="https://orcid.org/0000-0001-7132-2080"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Florian Jansen [aut],
  Noah Dell [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Miquel De Cáceres &lt;miquelcaceres@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-07-20 09:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='birds'>Birds resource use data</h2><span id='topic+birds'></span><span id='topic+birdsbreed'></span><span id='topic+birdswinter'></span><span id='topic+resourceD'></span>

<h3>Description</h3>

<p>The resource use data for a set of 10 hypothetical bird species during two different seasons. There are five resource classes, and their relationships are given in matrix <code>resourceD</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(birds)</code></pre>


<h3>Format</h3>

<p>birdsbreed - a data frame containing the resource use of 10 birds for a set of five resources during the breeding season.
</p>
<p>birdswinter - a data frame containing the resource use of 10 birds for a set of five resources during the winter season.
</p>
<p>resourceD - a distance matrix (object of class <code><a href="stats.html#topic+dist">dist</a></code>) containing the relationships between the five resources.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(birds)
</code></pre>

<hr>
<h2 id='combinespecies'>Combines species from a community table</h2><span id='topic+combinespecies'></span>

<h3>Description</h3>

<p>Creates species combinations to be used in indicator value analyses.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>combinespecies(
  X,
  min.order = 1,
  max.order = 3,
  min.occ = 1,
  FUN = min,
  verbose = FALSE,
  add.names = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="combinespecies_+3A_x">X</code></td>
<td>
<p>A community data table with sites in rows and species in columns. This table can contain either presence-absence or abundance data.</p>
</td></tr>
<tr><td><code id="combinespecies_+3A_min.order">min.order</code></td>
<td>
<p>Minimum number of species conforming species combinations.</p>
</td></tr>
<tr><td><code id="combinespecies_+3A_max.order">max.order</code></td>
<td>
<p>Maximum number of species conforming species combinations.</p>
</td></tr>
<tr><td><code id="combinespecies_+3A_min.occ">min.occ</code></td>
<td>
<p>Threshold for minimum occurrence. Combinations with lower values are not kept.</p>
</td></tr>
<tr><td><code id="combinespecies_+3A_fun">FUN</code></td>
<td>
<p>Function to be calculated for all species forming the species combination. Accepted values are <code>min</code>, <code>max</code>, <code>sum</code> and <code>mean</code>.</p>
</td></tr>
<tr><td><code id="combinespecies_+3A_verbose">verbose</code></td>
<td>
<p>If TRUE, prints the results of each step.</p>
</td></tr>
<tr><td><code id="combinespecies_+3A_add.names">add.names</code></td>
<td>
<p>If TRUE, adds the names of the species combinations to the output matrix. Species combination names are lists of species concatenated using character '+'.</p>
</td></tr>
<tr><td><code id="combinespecies_+3A_...">...</code></td>
<td>
<p>Additional arguments for function <code>FUN</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function allows creating a data table where rows are sites and columns are combinations of species. Values for a given column of this matrix are derived from the abundance values of the species forming the corresponding combination. In particular, the abundance value for a given combination in a given site is equal to the value returned by function 'FUN' (normally the minimum) among the site values of all species forming the combination. The matrix 'XC' returned by this function can be used in functions <code><a href="#topic+strassoc">strassoc</a></code> and <code><a href="#topic+signassoc">signassoc</a></code>. Alternatively, <code><a href="#topic+indicators">indicators</a></code> and related functions provide a more elaborated way to explore the indicator value of the simultaneous occurrence of sets of species (i.e. species combinations).
</p>


<h3>Value</h3>

<p>An list with:
</p>

<ul>
<li><p>XC - A matrix containing the abundance/occurrence of each species combination.
</p>
</li>
<li><p>C - A binary matrix describing the set of species forming each combination ('0' means that the species is not included, and '1' means that the species is included).
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Miquel De Cáceres Ainsa, EMF-CREAF
</p>


<h3>References</h3>

<p>De Cáceres, M., Legendre, P., Wiser, S.K. and Brotons, L. 2012. Using species combinations in indicator analyses. Methods in Ecology and Evolution 3(6): 973-982.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+indicators">indicators</a></code>, <code><a href="#topic+strassoc">strassoc</a></code>, <code><a href="#topic+signassoc">signassoc</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(stats)

## Loads species data
data(wetland) 

## Create species combinations
Y &lt;- combinespecies(X=wetland, max.order=3, min.occ=5, verbose=TRUE)

## Creates three site groups using kmeans
wetkm &lt;- kmeans(wetland, centers=3) 

## Calculate indicator value of species combinations for each of the three site groups
strassoc(Y$XC, cluster=wetkm$cluster,func="IndVal.g") 

## Calculate point biserial correlation value of species combinations 
## for each of the three site groups
strassoc(Y$XC, cluster=wetkm$cluster,func="r.g") 

</code></pre>

<hr>
<h2 id='coverage'>Coverage of a set of indicators</h2><span id='topic+coverage'></span><span id='topic+plotcoverage'></span>

<h3>Description</h3>

<p>Function <code>coverage</code> calculates the proportion of sites of the target site group where one or another indicator (a species or a species combination) is found. Parameters are used to select valid indicators before calculating coverage. Function <code>plotcoverage</code> plots the coverage against the positive predictive value threshold used to select indicators.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>coverage(
  x,
  y = NULL,
  selection = NULL,
  minstat = NULL,
  At = NULL,
  Bt = NULL,
  type = "stat",
  alpha = NULL
)

plotcoverage(
  x,
  y = NULL,
  by = 0.05,
  type = "stat",
  max.order = NULL,
  group = NULL,
  alpha = NULL,
  add = FALSE,
  xlab = expression(A[t]),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coverage_+3A_x">x</code></td>
<td>
<p>An object of class '<code><a href="#topic+indicators">indicators</a></code>' or a community data table with sites in rows and species in columns (in this second case, an object of class '<code><a href="#topic+multipatt">multipatt</a></code>' must be supplied for <code>y</code>).</p>
</td></tr>
<tr><td><code id="coverage_+3A_y">y</code></td>
<td>
<p>An object of class '<code><a href="#topic+multipatt">multipatt</a></code>'.</p>
</td></tr>
<tr><td><code id="coverage_+3A_selection">selection</code></td>
<td>
<p>A logical vector restricting the set of indicators used to calculate the coverage.</p>
</td></tr>
<tr><td><code id="coverage_+3A_minstat">minstat</code></td>
<td>
<p>Minimum value of the statistic for selecting indicators.</p>
</td></tr>
<tr><td><code id="coverage_+3A_at">At</code></td>
<td>
<p>Minimum value of positive predictive value (A) for selecting indicators.</p>
</td></tr>
<tr><td><code id="coverage_+3A_bt">Bt</code></td>
<td>
<p>Minimum value for sensitivity (B) for selecting indicators.</p>
</td></tr>
<tr><td><code id="coverage_+3A_type">type</code></td>
<td>
<p>Specifies how to select indicators: (1) using the value of the statistic (<code>type = "stat"</code>); 
(2) the lower bound of its confidence interval (<code>type = "lowerCI"</code>); 
or (3) the upper bound of its confidence interval (<code>type = "upperCI"</code>). 
This parameter makes sense when the function is called using objects of class '<code>indicators</code>' 
and bootstrap confidence intervals are available for this object. Otherwise <code>type</code> has no 
effect and the value of the statistic is used for selection. In function <code>coverage</code>, 
the value of <code>type</code> applies to selection using <code>minstat</code>, <code>At</code> and <code>Bt</code>. 
In function <code>plotcoverage</code>, the value of <code>type</code> applies to selection using <code>At</code>.</p>
</td></tr>
<tr><td><code id="coverage_+3A_alpha">alpha</code></td>
<td>
<p>Significance level for selecting indicators.</p>
</td></tr>
<tr><td><code id="coverage_+3A_by">by</code></td>
<td>
<p>Rate of increase in the predictive value threshold (At).</p>
</td></tr>
<tr><td><code id="coverage_+3A_max.order">max.order</code></td>
<td>
<p>The maximum number of species conforming species combinations (allows examining the effects of increasing the order of combinations).This parameter is only used when the function is called using objects of class '<code>indicators</code>'.</p>
</td></tr>
<tr><td><code id="coverage_+3A_group">group</code></td>
<td>
<p>Either an integer or a character string indicating the site group or site group combination for which plot is desired. This parameter is only used when the function is called using objects of class '<code>multipatt</code>'.</p>
</td></tr>
<tr><td><code id="coverage_+3A_add">add</code></td>
<td>
<p>Flag indicating whether the function should draw on the existing plot.</p>
</td></tr>
<tr><td><code id="coverage_+3A_xlab">xlab</code></td>
<td>
<p>Label for the x-axis.</p>
</td></tr>
<tr><td><code id="coverage_+3A_...">...</code></td>
<td>
<p>Additional plotting parameters that are passed to the <code>plot</code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>coverage</code> of a set of indicators was defined in De Cáceres et al. (2012) as the proportion of sites in a given site group where one or several indicators are found. This value allows assessing how often the site group will be able to be determined. If all indicators of a site group are rare, then the indication system will not be useful, regardless of how much restricted to the site group the indicators are. The coverage value is a generalization of quantity B of IndVal, that applies to a group of indicators instead of a single one. Function <code>plotcoverage</code> plots the coverage against the positive predictive value threshold (At) used to select indicators, as in De Cáceres et al. (2012). Functions <code>coverage</code> and <code>plotcoverage</code> can be executed using either an object of class '<code>indicators</code>', or an object of class '<code>multipatt</code>'. However, the parameters that apply to each case are slightly different. When using <code>coverage</code> and <code>plotcoverage</code> on objects of class '<code>multipatt</code>' one is expected to calculate the coverage for those indicators that are significant (see <code>alpha</code> parameter), although other constraints to select valid indicators can be used. When using <code>coverage</code> and <code>plotcoverage</code> on objects of class '<code>indicators</code>' one is expected to calculate the coverage for indicators that have values of A larger than a specified threshold (see <code>At</code> parameter). In this latter case, it may be advisable to use <code>stat="lowerCI"</code>, so that indicators with broad confidence intervals are not included in the selection.
</p>


<h3>Value</h3>

<p>When used with an object of class '<code>indicators</code>', function <code>coverage</code> returns the proportion of sites of the target site group where one or another indicator (species combination) is found. When used with an object of class '<code>indicators</code>', function <code>coverage</code> returns a vector containing the coverage value for each site group or site group combination.
</p>


<h3>Author(s)</h3>

<p>Miquel De Cáceres Ainsa, EMF-CREAF
</p>


<h3>References</h3>

<p>De Cáceres, M., Legendre, P., Wiser, S.K. and Brotons, L. 2012. Using species combinations in indicator analyses. Methods in Ecology and Evolution 3(6): 973-982.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+indicators">indicators</a></code>, <code><a href="#topic+multipatt">multipatt</a></code>, <code><a href="#topic+pruneindicators">pruneindicators</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(stats)

data(wetland) ## Loads species data

## Creates three clusters using kmeans
wetkm &lt;- kmeans(wetland, centers=3) 

## Run indicator analysis with species combinations for the first group
sc &lt;- indicators(X=wetland, cluster=wetkm$cluster, group=1, verbose=TRUE, At=0.5, Bt=0.2)

## Determine the coverage of the selected set of indicators
coverage(sc)

## Plot the coverage against the threshold At
plotcoverage(sc)
plotcoverage(sc, max.order=2, add=TRUE, lty=2)

## Runs the combination analysis using IndVal.g as statistic
wetpt &lt;- multipatt(wetland, wetkm$cluster, control = how(nperm=999))
 
## Determines the coverage for each site group combination
coverage(wetland, wetpt, alpha = 0.05)

</code></pre>

<hr>
<h2 id='indicators'>Indicator analysis for species combinations</h2><span id='topic+indicators'></span><span id='topic+print.indicators'></span><span id='topic+summary.indicators'></span><span id='topic+plot.indicators'></span>

<h3>Description</h3>

<p>Determines the indicator value of species combinations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>indicators(
  X,
  cluster,
  group,
  func = "IndVal",
  min.order = 1,
  max.order = 5,
  max.indicators = NULL,
  At = 0,
  Bt = 0,
  sqrtIVt = 0,
  control = how(),
  permutations = NULL,
  print.perm = FALSE,
  nboot.ci = NULL,
  alpha.ci = 0.05,
  XC = TRUE,
  enableFixed = FALSE,
  verbose = FALSE
)

## S3 method for class 'indicators'
print(
  x,
  At = 0,
  Bt = 0,
  sqrtIVt = 0,
  alpha = 1,
  selection = NULL,
  confint = FALSE,
  ...
)

## S3 method for class 'indicators'
summary(object, ...)

## S3 method for class 'indicators'
plot(x, type = "sqrtIV", maxline = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="indicators_+3A_x">X</code></td>
<td>
<p>A community data table with sites in rows and species in columns. This table can contain either presence-absence or abundance data.</p>
</td></tr>
<tr><td><code id="indicators_+3A_cluster">cluster</code></td>
<td>
<p>A vector containing the classification of sites into site groups.</p>
</td></tr>
<tr><td><code id="indicators_+3A_group">group</code></td>
<td>
<p>The label corresponding to the target site group.</p>
</td></tr>
<tr><td><code id="indicators_+3A_func">func</code></td>
<td>
<p>The indicator value variant to be used, either &quot;IndVal&quot; (non-equalized) or &quot;IndVal.g&quot; (group-equalized).</p>
</td></tr>
<tr><td><code id="indicators_+3A_min.order">min.order</code></td>
<td>
<p>Minimum number of species conforming species combinations.</p>
</td></tr>
<tr><td><code id="indicators_+3A_max.order">max.order</code></td>
<td>
<p>Maximum number of species conforming species combinations.</p>
</td></tr>
<tr><td><code id="indicators_+3A_max.indicators">max.indicators</code></td>
<td>
<p>Maximum number of valid indicators to be kept. If <code>NULL</code>, then all valid indicators are kept.</p>
</td></tr>
<tr><td><code id="indicators_+3A_at">At</code></td>
<td>
<p>Threshold for positive predictive value used to select valid indicators. Combinations with lower values are not kept.</p>
</td></tr>
<tr><td><code id="indicators_+3A_bt">Bt</code></td>
<td>
<p>Threshold for sensitivity used to select valid indicators. Combinations with lower values are not kept.</p>
</td></tr>
<tr><td><code id="indicators_+3A_sqrtivt">sqrtIVt</code></td>
<td>
<p>Threshold for (square root of) indicator value. Combinations with lower values are not kept.</p>
</td></tr>
<tr><td><code id="indicators_+3A_control">control</code></td>
<td>
<p>A list of control values describing properties of the permutation test design, as returned by a call to <code><a href="permute.html#topic+how">how</a></code>.</p>
</td></tr>
<tr><td><code id="indicators_+3A_permutations">permutations</code></td>
<td>
<p>A custom matrix of permutations, to be used if <code>control = NULL</code>, with permutations in rows and site indices in columns.</p>
</td></tr>
<tr><td><code id="indicators_+3A_print.perm">print.perm</code></td>
<td>
<p>If TRUE, prints permutation numbers after each set of 100 permutations.</p>
</td></tr>
<tr><td><code id="indicators_+3A_nboot.ci">nboot.ci</code></td>
<td>
<p>Number of bootstrap samples for confidence intervals. If <code>nboot.ci = NULL</code> then confidence intervals are not estimated.</p>
</td></tr>
<tr><td><code id="indicators_+3A_alpha.ci">alpha.ci</code></td>
<td>
<p>Error in confidence intervals.</p>
</td></tr>
<tr><td><code id="indicators_+3A_xc">XC</code></td>
<td>
<p>If TRUE, outputs the abundance/occurrence matrix of species combinations.</p>
</td></tr>
<tr><td><code id="indicators_+3A_enablefixed">enableFixed</code></td>
<td>
<p>If TRUE, uses species that occur in all sites as fixed elements and creates combinations with the remaining ones.</p>
</td></tr>
<tr><td><code id="indicators_+3A_verbose">verbose</code></td>
<td>
<p>If TRUE, prints the results of each step.</p>
</td></tr>
<tr><td><code id="indicators_+3A_x">x</code></td>
<td>
<p>An object of class 'indicators'.</p>
</td></tr>
<tr><td><code id="indicators_+3A_alpha">alpha</code></td>
<td>
<p>Threshold for statistical significance of indicator value. Combinations with higher p-values are not kept.</p>
</td></tr>
<tr><td><code id="indicators_+3A_selection">selection</code></td>
<td>
<p>A logical vector used to restrict, a priori, the species combinations to be printed.</p>
</td></tr>
<tr><td><code id="indicators_+3A_confint">confint</code></td>
<td>
<p>Flag to indicate that confidence interval bounds are desired when printing.</p>
</td></tr>
<tr><td><code id="indicators_+3A_...">...</code></td>
<td>
<p>Additional arguments for functions <code>print</code>,<code>summary</code> or <code>plot</code>.</p>
</td></tr>
<tr><td><code id="indicators_+3A_object">object</code></td>
<td>
<p>An object of class 'indicators'.</p>
</td></tr>
<tr><td><code id="indicators_+3A_type">type</code></td>
<td>
<p>Statistic to plot. Accepted values are &quot;IV&quot; (indicator value), &quot;sqrtIV&quot; (square root of indicator value), &quot;A&quot;, &quot;LA&quot;, &quot;UA&quot;, (positive predictive value and confidence limits), &quot;B&quot;,  &quot;LB&quot;, &quot;UB&quot; (sensitivity and confidence limits).</p>
</td></tr>
<tr><td><code id="indicators_+3A_maxline">maxline</code></td>
<td>
<p>Flag to indicate whether a line has to be drawn joining the maximum values for each order of combinations.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function <code>indicators</code> creates explores the indicator value of the simultaneous occurrence of sets of species (i.e. species combinations). The method is described in De Cáceres et al. (2012) and is a generalization of the Indicator Value method of Dufrêne &amp; Legendre (1997). The minimum and maximum number of species conforming the species combination can be controlled using <code>min.order</code> or <code>max.order</code>. For each combination of species it determines its positive predictive value (A), sensitivity (B) and the square root of indicator value (sqrtIV). Statistical significance of indicators for the target site group is determined by internal calls to function <code><a href="#topic+signassoc">signassoc</a></code>. Additionally, if <code>nboot.ci</code> is not null then bootstrap confidence intervals are determined with the specified <code>alpha</code> level, as explained in De Cáceres &amp; Legendre (2009). The combinations to be kept can be restricted to those whose positive predictive value, sensitivity and/or indicator value are equal or greater than input thresholds. Function <code>print</code> allows printing the results in a nice table, whereas <code>summary</code> provides information about candidate species, combinations and coverage of the set of indicators. Function <code>plot</code> draws the statistics against the order (i.e. the number of species) of the combination.
</p>


<h3>Value</h3>

<p>An object of class <code>indicators</code> with:
</p>
<table>
<tr><td><code>candidates</code></td>
<td>
<p>The vector of initial candidate species.</p>
</td></tr>
<tr><td><code>finalsplist</code></td>
<td>
<p>The vector of species finally selected for combinations.</p>
</td></tr>
<tr><td><code>C</code></td>
<td>
<p>A matrix describing all the combinations studied.</p>
</td></tr>
<tr><td><code>XC</code></td>
<td>
<p>A matrix containing the abundance/occurrence of each species combination.</p>
</td></tr>
<tr><td><code>A</code></td>
<td>
<p>Positive predictive power of species combinations. If <code>nboot</code> is not missing then this includes the lower and upper bounds of the confidence interval.</p>
</td></tr>
<tr><td><code>B</code></td>
<td>
<p>Sensitivity of species combinations. If <code>nboot</code> is not missing then this includes the lower and upper bounds of the confidence interval.</p>
</td></tr>
<tr><td><code>sqrtIV</code></td>
<td>
<p>Square root of indicator value of species combinations. If <code>nboot</code> is not missing then this includes the lower and upper bounds of the confidence interval.</p>
</td></tr>
<tr><td><code>sign</code></td>
<td>
<p>P-value of the permutation test of statistical significance.</p>
</td></tr>
<tr><td><code>group.vec</code></td>
<td>
<p>A logical vector indicating the membership to the target group.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Miquel De Cáceres Ainsa, EMF-CREAF
</p>


<h3>References</h3>

<p>De Cáceres, M., Legendre, P., Wiser, S.K. and Brotons, L. 2012. Using species combinations in indicator analyses. Methods in Ecology and Evolution 3(6): 973-982.
</p>
<p>De Cáceres, M. and Legendre, P. 2009. Associations between species and groups of sites: indices and statistical inference. Ecology 90(12): 3566-3574.
</p>
<p>Dufrêne, M. and P. Legendre. 1997. Species assemblages and indicator species: The need for a flexible asymetrical approach. Ecological Monographs 67:345-366.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+predict.indicators">predict.indicators</a></code>,<code><a href="#topic+pruneindicators">pruneindicators</a></code>, <code><a href="#topic+coverage">coverage</a></code>, <code><a href="#topic+multipatt">multipatt</a></code>, <code><a href="#topic+strassoc">strassoc</a></code>, <code><a href="#topic+signassoc">signassoc</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(stats)

data(wetland) ## Loads species data

## Creates three clusters using kmeans
wetkm &lt;- kmeans(wetland, centers=3) 

## Number of sites in each group
table(wetkm$cluster)

## Run indicator analysis with species combinations for the first group
sc &lt;- indicators(X=wetland, cluster=wetkm$cluster, group=1, verbose=TRUE, 
                 At=0.5, Bt=0.2)

#Prints the results
print(sc)

## Plots positive predictive power and sensitivity against the order of 
## combinations
plot(sc, type="A")
plot(sc, type="B")

## Run indicator analysis with species combinations for the first group, 
## but forcing 'Orysp' to be in all combinations
sc2 &lt;- indicators(X=wetland, cluster=wetkm$cluster, group=1, verbose=TRUE, 
                  At=0.5, Bt=0.2, enableFixed=TRUE)
                  
</code></pre>

<hr>
<h2 id='multipatt'>Multi-level pattern analysis</h2><span id='topic+multipatt'></span>

<h3>Description</h3>

<p>This function studies the association between species patterns and combinations of groups of sites.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multipatt(
  x,
  cluster,
  func = "IndVal.g",
  duleg = FALSE,
  restcomb = NULL,
  min.order = 1,
  max.order = NULL,
  control = how(),
  permutations = NULL,
  print.perm = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="multipatt_+3A_x">x</code></td>
<td>
<p>Community data table</p>
</td></tr>
<tr><td><code id="multipatt_+3A_cluster">cluster</code></td>
<td>
<p>A vector representing a partition of sites</p>
</td></tr>
<tr><td><code id="multipatt_+3A_func">func</code></td>
<td>
<p>Species-site group association function. Four values are accepted <code>"IndVal"</code>, <code>"IndVal.g"</code>, <code>"r"</code> and <code>"r.g"</code> (lowercase values are also accepted).</p>
</td></tr>
<tr><td><code id="multipatt_+3A_duleg">duleg</code></td>
<td>
<p>If TRUE, site group combinations are not considered, only the original site groups, like in Dufrêne &amp; Legendre (1997). Internally, <code>duleg = TRUE</code> equals <code>max.order = 1</code>.</p>
</td></tr>
<tr><td><code id="multipatt_+3A_restcomb">restcomb</code></td>
<td>
<p>A vector of integer values used to restrict the combinations of site groups to those with ecological sense according to the analyst. The default <code>NULL</code> indicates that all combinations are used. If <code>duleg=TRUE</code> this argument is ignored.</p>
</td></tr>
<tr><td><code id="multipatt_+3A_min.order">min.order</code></td>
<td>
<p>An integer indicating the minimum order of site group combinations (by default <code>max.order=1</code> for singletons). Cannot be larger than <code>max.order</code>.</p>
</td></tr>
<tr><td><code id="multipatt_+3A_max.order">max.order</code></td>
<td>
<p>An integer indicating the maximum order of site group combinations to be considered: <code>max.order=1</code> for singletons, <code>max.order=2</code> for pairs, <code>max.order=3</code> for triplets... As <code>restcomb</code>, this parameter provide a way to restrict the site group combinations that make ecological sense. By default all possible site group combinations are considered. If <code>max.order=1</code> then the function will behave as if <code>duleg=TRUE</code>.</p>
</td></tr>
<tr><td><code id="multipatt_+3A_control">control</code></td>
<td>
<p>A list of control values describing properties of the permutation design, as returned by a call to <code><a href="permute.html#topic+how">how</a></code>.</p>
</td></tr>
<tr><td><code id="multipatt_+3A_permutations">permutations</code></td>
<td>
<p>A custom matrix of permutations, to be used if <code>control = NULL</code>, with permutations in rows and site indices in columns</p>
</td></tr>
<tr><td><code id="multipatt_+3A_print.perm">print.perm</code></td>
<td>
<p>If TRUE, prints permutation numbers after each set of 100 permutations.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function creates combinations of the input clusters and compares each combination with the species in the input matrix x. For each species it chooses the combination with a highest association value. Best matching patterns are tested for statistical significance of the associations. Four association indices are possible (some less than for <code><a href="#topic+strassoc">strassoc</a></code>): &quot;IndVal&quot;, &quot;IndVal.g&quot;, &quot;r&quot; and &quot;r.g&quot;. Indicator value indices will return the pattern that better matches the species observed pattern, whereas correlation indices will return the pattern that creates a highest inside/outside difference. Details are given in De Cáceres et al. (2010). The user can restrict the combinations in three ways: (1) by using <code>duleg=TRUE</code>, which leads to consider single site-groups only; (2) by setting the minimum and maximum order of combinations using <code>min.order</code> and <code>max.order</code>; or (3) by using <code>restcomb</code> to restrict combinations at will. In order to carry out the third way, values in <code>restcomb</code> must be the indices of combinations that appear in the column <code>index</code> of object <code>sign</code> (see below). 
</p>
<p>Complex permutation designs are allowed through the function <code><a href="permute.html#topic+how">how</a></code> from package &quot;permute&quot;. If those are not enough, the user can set <code>control = NULL</code> and specify a custom matrix of permutations to test with parameter <code>permutations</code>.
</p>


<h3>Value</h3>

<p>An object of class <code>multipatt</code> with:
</p>
<table>
<tr><td><code>func</code></td>
<td>
<p>The name of the function used.</p>
</td></tr>
<tr><td><code>comb</code></td>
<td>
<p>A matrix describing all the combinations studied.</p>
</td></tr>
<tr><td><code>str</code></td>
<td>
<p>A matrix the association strength for all combinations studied.</p>
</td></tr>
<tr><td><code>A</code></td>
<td>
<p>If <code>func = "IndVal"</code> (or <code>func = "IndVal.g"</code>) a matrix whose values are the &quot;A&quot; (or &quot;A.g&quot;) component of indicator values. Otherwise this element is left as <code>NULL</code>.</p>
</td></tr>
<tr><td><code>B</code></td>
<td>
<p>If <code>func = "IndVal"</code> (or <code>func = "IndVal.g"</code>) a matrix whose values are the &quot;B&quot; component of indicator values. Otherwise this element is left as <code>NULL</code>.</p>
</td></tr>
<tr><td><code>sign</code></td>
<td>
<p>Data table with results of the best matching pattern, the association value and the degree of statistical significance of the association (i.e. p-values from permutation test). Note that p-values are not corrected for multiple testing.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>This function gives the same results as function <code>indval</code> in package &quot;labdsv&quot; when used setting <code>func="IndVal.g"</code> and <code>duleg=TRUE</code>, excepting the fact that the square root IndVal values is returned instead of the original IndVal.
</p>


<h3>Author(s)</h3>

<p>Miquel De Cáceres Ainsa, EMF-CREAF
</p>
<p>Florian Jansen, Institute of Botany and Landscape Ecology, Ernst-Moritz-Arndt-University
</p>


<h3>References</h3>

<p>De Cáceres, M. and Legendre, P. 2009. Associations between species and groups of sites: indices and statistical inference. Ecology 90(12): 3566-3574.
</p>
<p>De Cáceres, M., Legendre, P., Moretti, M. 2010. Improving indicator species analysis by combining groups of sites. Oikos 119(10): 1674-1684.
</p>
<p>Dufrêne, M. and P. Legendre. 1997. Species assemblages and indicator species: The need for a flexible asymetrical approach. Ecological Monographs 67:345-366.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+summary.multipatt">summary.multipatt</a></code>, <code><a href="#topic+strassoc">strassoc</a></code>, <code><a href="#topic+signassoc">signassoc</a></code>, <code><a href="permute.html#topic+how">how</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(stats)

data(wetland) ## Loads species data

wetkm &lt;- kmeans(wetland, centers=3) ## Creates three clusters using kmeans

## Runs the combination analysis using IndVal.g as statistic
wetpt &lt;- multipatt(wetland, wetkm$cluster, control = how(nperm=999)) 

## Lists those species with significant association to one combination
summary(wetpt) 

## Lists those species with significant association to one combination, 
## including indval components.
summary(wetpt, indvalcomp=TRUE) 

</code></pre>

<hr>
<h2 id='nichecentroid'>Resource niche metrics for a single niche</h2><span id='topic+nichecentroid'></span><span id='topic+nichepref'></span><span id='topic+nichevar'></span>

<h3>Description</h3>

<p>Function <code>nichepref</code> computes the species resource preference from a the 
species resource use (and resource availability when given). Function <code>nichecentroid</code> 
computes the centroid on the resource space for a set of species. Function <code>nichevar</code> 
computes the multivariate resource variance for a set of species (i.e. niche breadth). 
In all functions resources are given in distance matrix <code>D</code>, the species resource use is given in <code>P</code> and the availability of resources, if present, are given by vector <code>q</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nichecentroid(
  P,
  D = NULL,
  q = NULL,
  mode = "multiple",
  Np = NULL,
  Nq = NULL,
  nboot = 1000,
  alpha = 0.05
)

nichepref(
  P,
  D = NULL,
  q = NULL,
  mode = "multiple",
  Np = NULL,
  Nq = NULL,
  nboot = 1000,
  alpha = 0.05
)

nichevar(
  P,
  D = NULL,
  q = NULL,
  mode = "multiple",
  Np = NULL,
  Nq = NULL,
  nboot = 1000,
  alpha = 0.05
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nichecentroid_+3A_p">P</code></td>
<td>
<p>Data frame containing the relative or absolute usage that a set of species (in rows) make of a set of resources (in columns)</p>
</td></tr>
<tr><td><code id="nichecentroid_+3A_d">D</code></td>
<td>
<p>Object of type <code><a href="stats.html#topic+dist">dist</a></code> containing distance values between resources. If no distance matrix is provided (i.e. if <code>D==NULL</code>), the distances between resources is assumed to be maximum.</p>
</td></tr>
<tr><td><code id="nichecentroid_+3A_q">q</code></td>
<td>
<p>Vector with the availability of each resource</p>
</td></tr>
<tr><td><code id="nichecentroid_+3A_mode">mode</code></td>
<td>
<p>Either <code>mode = "single"</code> (rows of matrix P are individual observations to be pooled for a single niche) or <code>mode = "multiple"</code> (rows in P represent different niches)</p>
</td></tr>
<tr><td><code id="nichecentroid_+3A_np">Np</code></td>
<td>
<p>Vector with the number of observations per species from which the values in <code>P</code> come (in <code>mode = "multiple"</code>)</p>
</td></tr>
<tr><td><code id="nichecentroid_+3A_nq">Nq</code></td>
<td>
<p>The number of observations per species from which the values in <code>q</code> come (in <code>mode = "multiple"</code>)</p>
</td></tr>
<tr><td><code id="nichecentroid_+3A_nboot">nboot</code></td>
<td>
<p>Number of boostrap samples used to compute bias-corrected percentile confidence intervals</p>
</td></tr>
<tr><td><code id="nichecentroid_+3A_alpha">alpha</code></td>
<td>
<p>Used to set the confidence level (i.e. <code>alpha = 0.05</code> means 95 percent confidence interval)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The method is described in De Caceres et al. (2010). If the distance matrix is not specified 
(i.e. if <code>D=NULL</code>) the function assumes that all resources are at a maximum distance (<code>d=1</code>).
If the resource availability vector <code>q</code> is given then the values in <code>P</code> are taken as 
assessments of resource use and the species preference is calculated taking into account resource 
availability. Otherwise resource use is equated to resource preference. Moreover, most functions can 
compute bootstrap confidence intervals following the bias-corrected percentile method (Manly 2007). 
If <code>mode = "multiple"</code> and <code>Np != NULL</code>, bootstrap samples for a given species are generated
assuming a multinomial distribution with the proportions calculated from the corresponding row values 
in <code>P</code>, and the number of observations comes from the corresponding element in <code>Np</code>. 
If <code>mode = "single"</code> then the bootstrapped units are the rows of matrix <code>P</code>. In both cases, 
if <code>Nq</code> is indicated the availability of resources is also bootstrapped. 
The bias-corrected percentile method was described for overlap niche measures 
in Mueller and Altenberg (1985) and is extended here for all niche metrics.
</p>


<h3>Value</h3>

<p>Function <code>nichepref</code> returns a matrix of species relative preference. 
Function <code>nichevar</code> returns a vector with the variance of the resources 
used for each species in <code>P</code>. Function <code>nichecentroid</code> returns a matrix niche centroid in the resource space for each species in <code>df</code>. If bootstrap confidence intervals are asked then the three functions also compute two extra data containing respectively the lower and upper bounds of the confidence intervals obtained following the bias-corrected percentile method. Function <code>nichearea</code> returns the area of the convex hull occupied by the resources used for each species in <code>P</code>.
</p>


<h3>Author(s)</h3>

<p>Miquel De Caceres Ainsa, EMF-CREAF
</p>


<h3>References</h3>

<p>Mueller, L.D. and L. Altenberg. 1985. Statistical Inference on Measures of Niche Overlap. Ecology 66:1204-1210.
</p>
<p>Manly, B.F.J. 2007. Randomization, bootstrap and Monte Carlo methods in biology. Chapman and Hall texts in statistical science series. 2nd edition.
</p>
<p>De Caceres, M., Sol, D., Lapiedra, O. and P. Legendre. (2011) A framework for estimating niche metrics using the resemblance between qualitative resources. Oikos 120: 1341-1350.
</p>


<h3>See Also</h3>

<p>See <code><a href="#topic+nicheoverlap">nicheoverlap</a></code> for descriptors comparing two niches.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Loads example data
data(birds)

# The niche metrics using distances among resources and assuming equal availability of resources
nichepref(birdsbreed, D = resourceD) 
nichevar(birdsbreed, D = resourceD) 
nichecentroid(birdsbreed, D = resourceD) 

# The niche metrics using distances among resources and computes 
# 95 percent confidence intervals
nichepref(birdsbreed, D = resourceD, mode="multiple", 
          Np = rowSums(birdsbreed), Nq = 100) 
nichevar(birdsbreed, D = resourceD, mode="multiple", 
         Np = rowSums(birdsbreed), Nq = 100) 
nichecentroid(birdsbreed, D = resourceD, mode="multiple", 
              Np = rowSums(birdsbreed), Nq = 100) 

# Same computations with different resource availability
nichepref(birdsbreed, D = resourceD, 
          q = c(0.18, 0.24, 0.22, 0.21, 0.15), mode="multiple")
nichevar(birdsbreed, D = resourceD, 
         q = c(0.18, 0.24, 0.22, 0.21, 0.15), mode="multiple")
nichecentroid(birdsbreed, D = resourceD, 
              q = c(0.18, 0.24, 0.22, 0.21, 0.15), mode="multiple")

# The niche metrics using distances among resources and 
# computes 95 percent confidence intervals
nichepref(birdsbreed, D = resourceD, 
          q = c(0.18, 0.24, 0.22, 0.21, 0.15), mode="multiple", 
          Np = rowSums(birdsbreed), Nq = 100)
nichevar(birdsbreed, D = resourceD, 
         q = c(0.18, 0.24, 0.22, 0.21, 0.15), mode="multiple", 
         Np = rowSums(birdsbreed), Nq = 100)
nichecentroid(birdsbreed, D = resourceD, 
              q = c(0.18, 0.24, 0.22, 0.21, 0.15), mode="multiple",  
              Np = rowSums(birdsbreed), Nq = 100)

</code></pre>

<hr>
<h2 id='nichedispl'>Metrics to compare pairs of resource niches</h2><span id='topic+nichedispl'></span><span id='topic+nicheoverlap'></span>

<h3>Description</h3>

<p>Functions <code>nicheoverlap</code> and <code>nichedispl</code> compute the overlap and centroid distance between pairs of resource distributions. In both cases resource relationships are given in the distance matrix <code>D</code> and the resource use data are given in data frame <code>P1</code> (and in some modes also <code>P2</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nichedispl(
  P1,
  P2 = NULL,
  D = NULL,
  q1 = NULL,
  q2 = NULL,
  mode = "multiple",
  Np1 = NULL,
  Np2 = NULL,
  Nq1 = NULL,
  Nq2 = NULL,
  nboot = 1000,
  alpha = 0.05
)

nicheoverlap(
  P1,
  P2 = NULL,
  D = NULL,
  q1 = NULL,
  q2 = NULL,
  mode = "multiple",
  Np1 = NULL,
  Np2 = NULL,
  Nq1 = NULL,
  Nq2 = NULL,
  nboot = 1000,
  alpha = 0.05
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nichedispl_+3A_p1">P1</code></td>
<td>
<p>Data frame containing the amount of usage that a set of species (in rows) make of a first set of resources (in columns)</p>
</td></tr>
<tr><td><code id="nichedispl_+3A_p2">P2</code></td>
<td>
<p>Data frame containing the amount of usage that a set of species (in rows) make of a second set of resources (in columns). Not used if <code>mode = "pairwise"</code></p>
</td></tr>
<tr><td><code id="nichedispl_+3A_d">D</code></td>
<td>
<p>Object of type <code><a href="stats.html#topic+dist">dist</a></code> containing distance values between resources. If no distance matrix is provided (i.e. if <code>D==NULL</code>), the distances between resources is assumed to be maximum</p>
</td></tr>
<tr><td><code id="nichedispl_+3A_q1">q1</code></td>
<td>
<p>Vector with the availability of each resource corresponding to P1</p>
</td></tr>
<tr><td><code id="nichedispl_+3A_q2">q2</code></td>
<td>
<p>Vector with the availability of each resource corresponding to P2</p>
</td></tr>
<tr><td><code id="nichedispl_+3A_mode">mode</code></td>
<td>
<p>Either <code>mode = "single"</code> (rows of matrices P1 and P2 are individual observations to be pooled, for example to compare the niche of two species each with its individual observations), <code>mode = "multiple"</code> (each row in P1 is compared to the corresponding row of P2, for example, to compare seasonal niche shifts in each species) or <code>mode = "pairwise"</code> (all rows in P1 are compared pairwise).</p>
</td></tr>
<tr><td><code id="nichedispl_+3A_np1">Np1</code></td>
<td>
<p>Vector with the number of observations per species from which the values in <code>P1</code> come (in <code>mode = "multiple"</code> or <code>mode = "pairwise"</code>).</p>
</td></tr>
<tr><td><code id="nichedispl_+3A_np2">Np2</code></td>
<td>
<p>Vector with the number of observations per species from which the values in <code>P2</code> come (only in <code>mode = "multiple"</code>).</p>
</td></tr>
<tr><td><code id="nichedispl_+3A_nq1">Nq1</code></td>
<td>
<p>The number of observations from which the values in <code>q1</code> come.</p>
</td></tr>
<tr><td><code id="nichedispl_+3A_nq2">Nq2</code></td>
<td>
<p>The number of observations from which the values in <code>q2</code> come.</p>
</td></tr>
<tr><td><code id="nichedispl_+3A_nboot">nboot</code></td>
<td>
<p>Number of boostrap samples used to compute bias-corrected percentile confidence intervals.</p>
</td></tr>
<tr><td><code id="nichedispl_+3A_alpha">alpha</code></td>
<td>
<p>Used to set the confidence level (i.e. <code>alpha = 0.05</code> means 95 percent confidence interval).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The method is described in De Caceres et al. (2011). If the distance matrix is not specified (i.e. if <code>D=NULL</code>) the function assumes that all resources are at a maximum distance (<code>d=1</code>). If the resource availability vector <code>q1</code> (and <code>q2</code> if supplied) is specified, then the values in <code>P1</code> (and <code>P2</code> if supplied) are taken as assessments of resource use and the species preference is calculated taking into account resource availability. Otherwise, resource use is equated to resource preference (i.e. all resources are considered equally available). The functions can compute bootstrap confidence intervals following the bias-corrected percentile method (Manly 2007). If <code>mode = "multiple"</code> and <code>Np1</code> and <code>Np2</code> are not null, bootstrap samples for a given niche are generated assuming a multinomial distribution with the proportions calculated from the corresponding row values in <code>P1</code> (resp. <code>P2</code>), and the number of observations comes from the corresponding element in <code>Np1</code> (resp. <code>Np2</code>). Similarly, if <code>mode = "pairwise"</code> and <code>Np1</code> is not null, bootstrap samples for each niche are generated assuming a multinomial distribution with the proportions calculated from the corresponding row values in <code>P1</code>, and the number of observations comes from the corresponding element in <code>Np1</code>. Finally, if <code>mode = "single"</code> then the bootstrapped units are the rows of matrices <code>P1</code> and  <code>P2</code>. In both cases, if <code>Nq1</code> (and <code>Nq2</code>) is indicated, the availability of resources is also bootstrapped. The bias-corrected percentile method is described for overlap niche measures in Mueller and Altenberg (1985).
</p>


<h3>Value</h3>

<p>Function <code>nicheoverlap</code> (resp. <code>nichedispl</code>) returns the overlap (resp. the distance between centroids) between the each pair of rows in <code>P1</code> and <code>P2</code>. If <code>mode = "multiple"</code> or <code>mode = "single"</code> the values are returned as a data frame. If <code>mode = "pairwise"</code> a matrix of values is returned instead. If bootstrap confidence intervals are asked then the functions also compute the lower and upper bounds of a confidence interval obtained following the bias-corrected percentile method. Upper and lower bounds are returned as additional columns of the data frame in <code>mode = "multiple"</code> or <code>mode = "single"</code> or as additional matrices of a list in <code>mode = "pairwise"</code>.
</p>


<h3>Author(s)</h3>

<p>Miquel De Caceres Ainsa, EMF-CREAF
</p>


<h3>References</h3>

<p>Mueller, L.D. and L. Altenberg. 1985. Statistical Inference on Measures of Niche Overlap. Ecology 66:1204-1210.
</p>
<p>Manly, B.F.J. 2007. Randomization, bootstrap and Monte Carlo methods in biology. Chapman and Hall texts in statistical science series. 2nd edition.
</p>
<p>De Caceres, M., Sol, D., Lapiedra, O. and P. Legendre. (2011) A framework for estimating niche metrics using the resemblance between qualitative resources. Oikos 120: 1341-1350.
</p>


<h3>See Also</h3>

<p>See <code><a href="#topic+nichevar">nichevar</a></code> for descriptors of single niches.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Loads example data
data(birds)

# The overlap and displacement metrics using distances among 
# resources and assuming equal availability of resources
nicheoverlap(birdsbreed, birdswinter, D = resourceD, mode="multiple") 
nichedispl(birdsbreed, birdswinter, D = resourceD, mode="multiple") 

# The overlap and displacement metrics using distances among resources
# and computes 95 percent confidence intervals
nicheoverlap(birdsbreed, birdswinter, D = resourceD, mode="multiple", 
             Np1 = rowSums(birdsbreed), Np2 = rowSums(birdswinter), Nq1 = 100, Nq2 = 100) 
nichedispl(birdsbreed, birdswinter, D = resourceD, mode="multiple", 
           Np1 = rowSums(birdsbreed), Np2 = rowSums(birdswinter), Nq1 = 100, Nq2 = 100) 

# Same computations with different resource availability
q &lt;- c(0.18, 0.24, 0.22, 0.21, 0.15)
nicheoverlap(birdsbreed, birdswinter, D = resourceD, 
             q1 = q, q2 = q, mode="multiple")
nichedispl(birdsbreed, birdswinter, D = resourceD, 
           q1 = q, q2 = q, mode="multiple")
nicheoverlap(birdsbreed, birdswinter, D = resourceD, 
             q1 = q, q2 = q, mode="multiple", 
             Np1 = rowSums(birdsbreed), Np2 = rowSums(birdswinter), 
             Nq1 = 100, Nq2 = 100)
nichedispl(birdsbreed, birdswinter, D = resourceD, 
           q1 = q, q2 = q, mode="multiple", 
           Np1 = rowSums(birdsbreed), Np2 = rowSums(birdswinter), 
           Nq1 = 100, Nq2 = 100)

# The overlap metrics using distances among rows of 'birdsbreed'
nicheoverlap(birdsbreed, D = resourceD, mode="pairwise") 

</code></pre>

<hr>
<h2 id='pigeons'>Pigeon seed consumption data</h2><span id='topic+pigeons'></span><span id='topic+dfood'></span><span id='topic+diet.barcelona'></span><span id='topic+diet.moia'></span>

<h3>Description</h3>

<p>Data set used for the dietary analysis of two feral pigeon (Columba livia) populations. There are six seed types, and their distance relationships are given in matrix <code>dfood</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(pigeons)</code></pre>


<h3>Format</h3>

<p>diet.barcelona - a data frame containing the seed consumption (in grams) of pigeons taken from the population in Barcelona.
</p>
<p>diet.moia - a data frame containing the seed consumption (in grams) of pigeons taken from the population in Moia.
</p>
<p>dfood - a distance matrix (object of class <code><a href="stats.html#topic+dist">dist</a></code>) containing the relationships between the six seed types. Distances were calculated from data describing the nutritional content and dimensions of each seed type.
</p>


<h3>References</h3>

<p>De Caceres, M., Sol, D., Lapiedra, O. and P. Legendre. (2011) A framework for estimating niche metrics using the resemblance between qualitative resources. Oikos 120: 1341-1350.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(pigeons)
</code></pre>

<hr>
<h2 id='plotniche'>Draws a single resource niche</h2><span id='topic+plotniche'></span>

<h3>Description</h3>

<p>Function <code>plotniche</code> draws a resource niche on the resource space computed by means of principal coordinates analysis. Resource relationships are given in distance matrix <code>D</code>, the species resource use is given in <code>P</code> and the availability of resources is given by vector <code>q</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotniche(
  P,
  D = NULL,
  q = NULL,
  mode = "multiple",
  Np = NULL,
  Nq = NULL,
  nboot = 1000,
  alpha = 0.05,
  species = NULL,
  axes = c(1, 2),
  chull = TRUE,
  bubbles = TRUE,
  writeName = FALSE,
  add = FALSE,
  col = "black",
  lty = 1,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotniche_+3A_p">P</code></td>
<td>
<p>Data frame containing the relative or absolute usage that a set of species (in rows) make of a set of resources (in columns).</p>
</td></tr>
<tr><td><code id="plotniche_+3A_d">D</code></td>
<td>
<p>Object of type <code><a href="stats.html#topic+dist">dist</a></code> containing distance values between resources. If no distance matrix is provided (i.e. if <code>D==NULL</code>), the distances between resources is assumed to be maximum.</p>
</td></tr>
<tr><td><code id="plotniche_+3A_q">q</code></td>
<td>
<p>Vector with the availability of each resource.</p>
</td></tr>
<tr><td><code id="plotniche_+3A_mode">mode</code></td>
<td>
<p>Either <code>mode = "single"</code> (rows of matrix P are individual observations to be pooled for a single niche) or <code>mode = "multiple"</code> (rows in P represent different niches).</p>
</td></tr>
<tr><td><code id="plotniche_+3A_np">Np</code></td>
<td>
<p>Vector with the number of observations per species from which the values in <code>P</code> come (in <code>mode = "multiple"</code>).</p>
</td></tr>
<tr><td><code id="plotniche_+3A_nq">Nq</code></td>
<td>
<p>The number of observations per species from which the values in <code>q</code> come.</p>
</td></tr>
<tr><td><code id="plotniche_+3A_nboot">nboot</code></td>
<td>
<p>Number of boostrap samples used to compute bias-corrected percentile confidence intervals.</p>
</td></tr>
<tr><td><code id="plotniche_+3A_alpha">alpha</code></td>
<td>
<p>Used to set the confidence level (i.e. <code>alpha = 0.05</code> means 95 percent confidence interval).</p>
</td></tr>
<tr><td><code id="plotniche_+3A_species">species</code></td>
<td>
<p>Specifies which species niche is to be plot. This parameter is mandatory and can be either an numeric index or a string for a species name.</p>
</td></tr>
<tr><td><code id="plotniche_+3A_axes">axes</code></td>
<td>
<p>PCoA axes used for plotting.</p>
</td></tr>
<tr><td><code id="plotniche_+3A_chull">chull</code></td>
<td>
<p>Logical flag indicating whether or not convex hulls should be drawn (only in <code>type="single"</code>).</p>
</td></tr>
<tr><td><code id="plotniche_+3A_bubbles">bubbles</code></td>
<td>
<p>Logical flag to draws bubbles proportional to resource preference data.</p>
</td></tr>
<tr><td><code id="plotniche_+3A_writename">writeName</code></td>
<td>
<p>Logical flag indicating whether or not the name of the species should be drawn beside the centroid.</p>
</td></tr>
<tr><td><code id="plotniche_+3A_add">add</code></td>
<td>
<p>If <code>TRUE</code>, the current plot is used. This is helpful to draw more than one species on the same plot (see examples).</p>
</td></tr>
<tr><td><code id="plotniche_+3A_col">col</code></td>
<td>
<p>Color of the centroid and confidence interval arrows.</p>
</td></tr>
<tr><td><code id="plotniche_+3A_lty">lty</code></td>
<td>
<p>Line type of the confidence interval arrows.</p>
</td></tr>
<tr><td><code id="plotniche_+3A_...">...</code></td>
<td>
<p>Additional graphical parameters.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The method is described in De Caceres et al. (in prep). If the distance matrix is not specified (i.e. if <code>D=NULL</code>) the function assumes that all resources are at a maximum distance (<code>d=1</code>). If the resource availability vector <code>q</code> is given then the values in <code>P</code> are taken as assessments of resource use and the species preference is calculated taking into account resource availability. Otherwise resource use is equated to resource preference. The function can also plot bootstrap confidence intervals following the bias-corrected percentile method (Manly 2007). If If <code>mode = "multiple"</code> and <code>Np != NULL</code>, bootstrap samples for a given species are generated assuming a multinomial distribution with the proportions calculated from the corresponding row values in <code>P</code>, and the number of observations comes from the corresponding element in <code>Np</code>. If <code>mode = "single"</code> then the bootstrapped units are the rows of matrix <code>P</code>. In both cases, if <code>Nq</code> is indicated, the availability of resources is also bootstrapped. The bias-corrected percentile method was described for overlap niche measures in Mueller and Altenberg (1985) and is extended here for all niche metrics except <code>nichearea</code>.
</p>


<h3>Author(s)</h3>

<p>Miquel De Caceres Ainsa, EMF-CREAF
</p>


<h3>References</h3>

<p>Mueller, L.D. and L. Altenberg. 1985. Statistical Inference on Measures of Niche Overlap. Ecology 66:1204-1210.
</p>
<p>Manly, B.F.J. 2007. Randomization, bootstrap and Monte Carlo methods in biology. Chapman and Hall texts in statistical science series. 2nd edition.
</p>
<p>De Caceres, M., Sol, D., Lapiedra, O. and P. Legendre. (2011) A framework for estimating niche metrics using the resemblance between qualitative resources. Oikos 120: 1341-1350.
</p>


<h3>See Also</h3>

<p>See <code><a href="#topic+nichevar">nichevar</a></code> and <code><a href="#topic+nicheoverlap">nicheoverlap</a></code> to obtain a resource niche metrics.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Loads example data
data(birds)

plotniche(birdsbreed, D = resourceD, mode="multiple", species=10) 
plotniche(birdsbreed, D = resourceD, mode="multiple", 
          Np = rowSums(birdsbreed), Nq = 100, species=10) 
plotniche(birdsbreed, D = resourceD, 
          q = c(0.18, 0.24, 0.22, 0.21, 0.15), mode="multiple", species=10)
plotniche(birdsbreed, D = resourceD, 
          q = c(0.18, 0.24, 0.22, 0.21, 0.15), mode="multiple", 
          Np = rowSums(birdsbreed), Nq = 100, species=10)

#draw two species
plotniche(birdsbreed, D = resourceD, mode="multiple", 
          Np = rowSums(birdsbreed), Nq = 100, species=10, writeName=TRUE, 
          bubbles=FALSE, chull=FALSE) 
plotniche(birdsbreed, D = resourceD,  mode="multiple", 
          Np = rowSums(birdsbreed), Nq = 100, species=1, writeName=TRUE, 
          bubbles=FALSE, chull=FALSE, add=TRUE, col="red", lty=2) 
</code></pre>

<hr>
<h2 id='predict.indicators'>Predicts site group from indicators</h2><span id='topic+predict.indicators'></span>

<h3>Description</h3>

<p>Function <code>predict.indicators</code> takes an object of class <code><a href="#topic+indicators">indicators</a></code> and determines the probability of the indicated site group given a community data set. If no new data set is provided, the function can calculate the probabilities corresponding to the original sites used to build the <code><a href="#topic+indicators">indicators</a></code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'indicators'
predict(object, newdata = NULL, cv = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.indicators_+3A_object">object</code></td>
<td>
<p>An object of class 'indicators'.</p>
</td></tr>
<tr><td><code id="predict.indicators_+3A_newdata">newdata</code></td>
<td>
<p>A community data table (with sites in rows and species in columns) for which predictions are needed. This table can contain either presence-absence or abundance data, but only presence-absence information is used for the prediction. If <code>NULL</code>, then the original data set used to derive the <code><a href="#topic+indicators">indicators</a></code> object is used as data.</p>
</td></tr>
<tr><td><code id="predict.indicators_+3A_cv">cv</code></td>
<td>
<p>A boolean flag to indicate that probabilities should be calculated using leave-one-out cross validation (i.e recalculating positive predictive value of indicators after excluding the target site).</p>
</td></tr>
<tr><td><code id="predict.indicators_+3A_...">...</code></td>
<td>
<p>In function <code>predict</code>, additional arguments not used (included for compatibility with <code><a href="stats.html#topic+predict">predict</a></code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function <code><a href="#topic+indicators">indicators</a></code> explores the indicator value of the simultaneous occurrence of sets of species (i.e. species combinations). The method is described in De Cáceres et al. (2012) and is a generalization of the Indicator Value method of Dufrêne &amp; Legendre (1997). The current function <code>predict.indicators</code> is used to predict the indicated site group from the composition of a new set of observations. For communities where one or more of the indicator species combinations are found, the function returns the probability associated to the indicator that has the highest positive predictive value (if confidence intervals are available, the maximum value is calculated across the lower bounds of the confidence interval). For communities where none of the indicator species combinations is found, the function returns zeroes. 
If <code>newdata = NULL</code>, the function can be used to evaluate the predictive power of a set of indicators in a cross-validated fashion. For each site in the data set, recalculates the predictive value of indicators after excluding the information of the site, and then evaluates the probability of the site group.
</p>


<h3>Value</h3>

<p>If confidence intervals are available in <code>x</code>, function <code>predict.indicators</code> returns a matrix where communities are in rows and there are three columns, correspoinding to the probability of the indicated site group along with the confidence interval. If confidence intervals are not available in <code>x</code>, or if <code>cv = TRUE</code>, then <code>predict.indicators</code> returns a single vector with the probability of the indicated site group for each community.
</p>


<h3>Author(s)</h3>

<p>Miquel De Cáceres Ainsa, EMF-CREAF
</p>


<h3>References</h3>

<p>De Cáceres, M., Legendre, P., Wiser, S.K. and Brotons, L. 2012. Using species combinations in indicator analyses. Methods in Ecology and Evolution 3(6): 973-982.
</p>
<p>Dufrêne, M. and P. Legendre. 1997. Species assemblages and indicator species: The need for a flexible asymetrical approach. Ecological Monographs 67:345-366.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+indicators">indicators</a></code>, <code><a href="#topic+pruneindicators">pruneindicators</a></code> <code><a href="#topic+coverage">coverage</a></code>, <code><a href="#topic+multipatt">multipatt</a></code>, <code><a href="#topic+strassoc">strassoc</a></code>, <code><a href="#topic+signassoc">signassoc</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(stats)

data(wetland) ## Loads species data

## Creates three clusters using kmeans
wetkm &lt;- kmeans(wetland, centers=3) 


## Run indicator analysis with species combinations for the first group
sc &lt;- indicators(X=wetland, cluster=wetkm$cluster, group=1, verbose=TRUE, At=0.5, Bt=0.2)

## Use the indicators to make predictions of the probability of group #1
## Normally an independent data set should be used, because 'wetland' was used to derive
## indicators. The same would be obtained calling 'predict(sc)' without further arguments.
p &lt;- predict(sc, wetland)

## Calculate cross-validated probabilities (recalculates 'A' statistics once for each site 
## after excluding it, and then calls predict.indicators for that site)
pcv &lt;- predict(sc, cv = TRUE)

## Show original membership to group 1 along with (resubstitution) predicted probabilities  
## and cross-validated probabilities. Cross-validated probabilities can be lower for sites
## originally belonging to the target site group and higher for other sites.
data.frame(Group1 = as.numeric(wetkm$cluster==1), Prob = p, Prob_CV = pcv)

</code></pre>

<hr>
<h2 id='pruneindicators'>Determines the best subset of indicators</h2><span id='topic+pruneindicators'></span>

<h3>Description</h3>

<p>This function allows reducing drastically the number of species combinations to be retained for a given target site group.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pruneindicators(
  x,
  At = 0,
  Bt = 0,
  sqrtIVt = 0,
  alpha = 1,
  max.indicators = 4,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pruneindicators_+3A_x">x</code></td>
<td>
<p>An object of class '<code><a href="#topic+indicators">indicators</a></code>'.</p>
</td></tr>
<tr><td><code id="pruneindicators_+3A_at">At</code></td>
<td>
<p>Threshold for positive predictive value. Combinations with lower values are not kept.</p>
</td></tr>
<tr><td><code id="pruneindicators_+3A_bt">Bt</code></td>
<td>
<p>Threshold for sensitivity. Combinations with lower values are not kept.</p>
</td></tr>
<tr><td><code id="pruneindicators_+3A_sqrtivt">sqrtIVt</code></td>
<td>
<p>Threshold for (square root of) indicator value. Combinations with lower values are not kept.</p>
</td></tr>
<tr><td><code id="pruneindicators_+3A_alpha">alpha</code></td>
<td>
<p>Threshold for statistical significance of indicator value. Combinations with higher p-values are not kept.</p>
</td></tr>
<tr><td><code id="pruneindicators_+3A_max.indicators">max.indicators</code></td>
<td>
<p>Maximum number of species combinations to be kept. If <code>NULL</code>, the function returns all the non-nested valid indicators without further selection.</p>
</td></tr>
<tr><td><code id="pruneindicators_+3A_verbose">verbose</code></td>
<td>
<p>If TRUE, prints the results of each step.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>First, the function selects those indicators (species or species combinations) with valid positive predictive value, sensitivity and indicator value, according to the input thresholds. If the object '<code>speciescomb</code>' contains confidence intervals, then the lower bounds are used to select the valid indicators. Second, the function discards those valid indicators whose occurrence pattern is nested within other valid indicators. Third, the function evaluates the <code><a href="#topic+coverage">coverage</a></code> of the remaining set of indicators and explores subsets of increasing number of indicators, until the same coverage is attained and the set of indicators is returned. If the maximum allowed members is attained (<code>max.indicators</code>) then the set of indicators with maximum coverage is returned.
</p>


<h3>Value</h3>

<p>An object of class '<code><a href="#topic+indicators">indicators</a></code>' with only the species combinations selected.
</p>


<h3>Author(s)</h3>

<p>Miquel De Cáceres Ainsa, EMF-CREAF
</p>


<h3>References</h3>

<p>De Cáceres, M., Legendre, P., Wiser, S.K. and Brotons, L. 2012. Using species combinations in indicator analyses. Methods in Ecology and Evolution 3(6): 973-982.
</p>
<p>De Cáceres, M. and Legendre, P. 2009. Associations between species and groups of sites: indices and statistical inference. Ecology 90(12): 3566-3574.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+indicators">indicators</a></code>, <code><a href="#topic+coverage">coverage</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(stats)

data(wetland) ## Loads species data

## Creates three clusters using kmeans
wetkm &lt;- kmeans(wetland, centers=3) 

## Run indicator analysis with species combinations for the first group
sc &lt;- indicators(X=wetland, cluster=wetkm$cluster, group=1, verbose=TRUE, At=0.5, Bt=0.2)

## Finds the 'best' subset of indicators
sc2 &lt;- pruneindicators(sc, At=0.5, Bt=0.2, verbose=TRUE)
print(sc2)

</code></pre>

<hr>
<h2 id='signassoc'>Statistical significance of species site-group associations</h2><span id='topic+signassoc'></span>

<h3>Description</h3>

<p>This function computes the permutation p-value of the association between a species vector and a vector of memberships to a site-group. Four different tests of hypotheses arise from considering either presence/absence or quantitative species data, and from using a non-equalized or group-equalized approach.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>signassoc(
  X,
  U = NULL,
  cluster = NULL,
  mode = 1,
  alternative = "greater",
  control = how(),
  permutations = NULL,
  print.perm = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="signassoc_+3A_x">X</code></td>
<td>
<p>Community data table (rows are sites, columns are species).</p>
</td></tr>
<tr><td><code id="signassoc_+3A_u">U</code></td>
<td>
<p>A matrix of group memberships. Each column corresponds to one site-group. Membership values can be crisp or fuzzy. If this matrix is not provided, vector gmv will be used.</p>
</td></tr>
<tr><td><code id="signassoc_+3A_cluster">cluster</code></td>
<td>
<p>A vector of numeric group labels for sites.</p>
</td></tr>
<tr><td><code id="signassoc_+3A_mode">mode</code></td>
<td>
<p>Association mode, 0 (site-based) or 1 (group-based).</p>
</td></tr>
<tr><td><code id="signassoc_+3A_alternative">alternative</code></td>
<td>
<p>Alternative statistical hypothesis: &quot;greater&quot; (positive association), &quot;less&quot; (negative association), &quot;two.sided&quot; (either positive or negative).</p>
</td></tr>
<tr><td><code id="signassoc_+3A_control">control</code></td>
<td>
<p>A list of control values describing properties of the permutation design, as returned by a call to <code><a href="permute.html#topic+how">how</a></code>.</p>
</td></tr>
<tr><td><code id="signassoc_+3A_permutations">permutations</code></td>
<td>
<p>A custom matrix of permutations, to be used if <code>control = NULL</code>, with permutations in rows and site indices in columns.</p>
</td></tr>
<tr><td><code id="signassoc_+3A_print.perm">print.perm</code></td>
<td>
<p>If TRUE, prints permutation numbers after each set of 100 permutations.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Input data for this function is the species matrix X and either a matrix of group memberships (U) or a vector of numeric group labels (cluster). This R function works for both presence/absence and quantitative species data, depending on the values of the input matrix X.
If <code>mode = 0</code>, the null ecological hypothesis is that the frequency (or abundance) of the species of interest in sites belonging to the site group is not higher than the frequency (or abundance) in sites not belonging to it. If <code>mode = 1</code>, the null ecological hypothesis is that the relative frequency (average abundance) of the species of interest is not higher in the target site group than in other groups. See De Cáceres and Legendre for more details. 
</p>
<p>Complex permutation designs are allowed through the function <code><a href="permute.html#topic+how">how</a></code> from package &quot;permute&quot;. If those are not enough, the user can set <code>control = NULL</code> and specify a custom matrix of permutations to test with parameter <code>permutations</code>.
</p>


<h3>Value</h3>

<p>Returns a matrix of p-values, where species are in rows and groups are in columns. Two additional columns indicate the group with lowest p-value and the p-value for this group after Sidak's correction for multiple testing.
</p>


<h3>Note</h3>

<p>Users should be aware that the significance test in <code>signassoc</code> is not exactly the same as the one in <code>indval</code> from <code>labdsv</code> package. The <code>signassoc</code> function is using the preference for the target group (either non-equalized or group-equalized) as test statistic. After every permutation the preference for the target group is recalculated. The function is therefore testing the null hypothesis stating that the preference of the species for a given site group is due to chance only (as in Bakker 2008). The test is repeated for every group, and this is the reason why there are as many p-values as groups. In contrast, the <code>indval</code> function from <code>labdsv</code> package uses the maximum preference value as test statistic, and the maximum preference value is recalculated after each permutation. The maximum preference may correspond to other groups than the one chosen for the unpermuted data. <code>indval</code> function from <code>labdsv</code> package is therefore testing the null hypothesis saying that the group with observed maximum preference is not such, because the maximum preference was in that group due to chance only. In order to get the consistent results compared to the <code>indval</code> function, users should use the function <code><a href="#topic+multipatt">multipatt</a></code>, along with the option <code>duleg=TRUE</code>.
</p>


<h3>Author(s)</h3>

<p>Miquel De Cáceres Ainsa,  EMF-CREAF
</p>


<h3>References</h3>

<p>Bakker, J. 2008. Increasing the utility of Indicator Species Analysis. Journal of Applied Ecology 45: 1829-1835.
</p>
<p>De Cáceres, M. and Legendre, P. 2009. Associations between species and groups of sites: indices and statistical inference. Ecology 90(12): 3566-3574.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+strassoc">strassoc</a></code>, <code><a href="#topic+multipatt">multipatt</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(stats)

data(wetland) ## Load species data

wetkm &lt;- kmeans(wetland, centers=3)## Create three clusters using

## Look for species whose abundance is significantly higher in one of the three groups
signassoc(wetland, cluster=wetkm$cluster, mode=1, control = how(nperm=999))

## Look for species whose abundance is significantly higher in sites belonging 
## to one group as opposed to sites not belonging to it.
signassoc(wetland, cluster=wetkm$cluster, mode=0, control = how(nperm=999)) 

</code></pre>

<hr>
<h2 id='strassoc'>Strength of species site-group associations</h2><span id='topic+strassoc'></span>

<h3>Description</h3>

<p>This function computes the strength of the association between a species vector and a vector of memberships to the site-group. Several statistics are possible, following De Cáceres and Legendre (2009). The choice of the most appropriate statistic depends on the application. If required, bootstrap confidence interval bounds are also computed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>strassoc(
  X,
  cluster,
  func = "r",
  group = NULL,
  nboot.ci = NULL,
  alpha.ci = 0.05,
  c = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="strassoc_+3A_x">X</code></td>
<td>
<p>Community data table (rows are sites, columns are species).</p>
</td></tr>
<tr><td><code id="strassoc_+3A_cluster">cluster</code></td>
<td>
<p>A vector of numeric group labels for sites.</p>
</td></tr>
<tr><td><code id="strassoc_+3A_func">func</code></td>
<td>
<p>The association index to be used. Accepted function names: &quot;r&quot;, &quot;r.g&quot;, &quot;IndVal&quot;, &quot;IndVal.g&quot;, &quot;A&quot;, &quot;A.g&quot;, &quot;B&quot;, &quot;cos&quot;, &quot;cos.g&quot;, &quot;r.ind&quot;, &quot;r.ind.g&quot;, &quot;s.ind&quot;, &quot;s.ind.g&quot; (lowercase values are also accepted).</p>
</td></tr>
<tr><td><code id="strassoc_+3A_group">group</code></td>
<td>
<p>Group for which association values are to be computed. If group=NULL, association values will be computed for all groups.</p>
</td></tr>
<tr><td><code id="strassoc_+3A_nboot.ci">nboot.ci</code></td>
<td>
<p>Number of bootstrap samples. If <code>NULL</code> then confidence intervals are not estimated.</p>
</td></tr>
<tr><td><code id="strassoc_+3A_alpha.ci">alpha.ci</code></td>
<td>
<p>Error in confidence intervals.</p>
</td></tr>
<tr><td><code id="strassoc_+3A_c">c</code></td>
<td>
<p>Vector of total abundance per site (used in functions &quot;r.ind&quot;, &quot;r.ind.g&quot;, &quot;s.ind&quot;, &quot;s.ind.g&quot; only).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This R function is applicable to both presence-absence and quantitative species data, depending on the values in the input matrix X.  Indices &quot;r&quot;,&quot;r.g&quot;,&quot;cos&quot; and &quot;cos.g&quot; correspond to the general correlation generalization (&quot;r&quot; is the point-biserial correlation coefficient), whereas &quot;r.ind&quot;, &quot;r.ind.g&quot;, &quot;s.ind&quot; and &quot;s.ind.g&quot; correspond to the individual-based generalization. Both approaches give the same results for binary (presence-absence) species data. Indicator value indices &quot;IndVal&quot; and &quot;IndVal.g&quot; are partial generalizations of the indices of the presence-absence indices. The &quot;IndVal&quot; index of Dufrêne &amp; Legendre (1997) is called &quot;IndVal.g&quot; here and <code>strassoc</code> returns the square root of the original index. Indices &quot;A&quot;,&quot;A.g&quot; and &quot;B&quot; are the asymmetric quantities into which indicator values &quot;IndVal&quot; and &quot;IndVal.g&quot; can be decomposed. See De Cáceres and Legendre for details on the relationships between these indices and their usage. Bootstrap confidence intervals are computed using the simple percentile method (Manly 1997).
</p>


<h3>Value</h3>

<p>Returns a matrix of association values, where species are in rows and groups are in columns. If <code>nboot.ci</code> is not null, then a list is returned, where 'stat' contains the matrix of association values, and the lower and upper confidence limits are given in supplementary matrices named 'lowerCI' and 'upperCI' respectively.
</p>


<h3>Note</h3>

<p>This function gives the same association values as function <code>indval</code> in package &quot;labdsv&quot; when used setting <code>func="IndVal.g"</code>, excepting the fact that the square root IndVal values is returned instead of the original IndVal.
</p>


<h3>Author(s)</h3>

<p>Miquel De Cáceres Ainsa,  EMF-CREAF
</p>


<h3>References</h3>

<p>De Cáceres, M. and Legendre, P. 2009. Associations between species and groups of sites: indices and statistical inference. Ecology 90(12): 3566-3574.
</p>
<p>Dufrêne, M. and P. Legendre. 1997. Species assemblages and indicator species: The need for a flexible asymetrical approach. Ecological Monographs 67:345-366.
</p>
<p>Manly, B. F. J. 1997. Randomization, bootstrap and Monte Carlo methods in biology. Chapman and Hall Texts in Statistical Science Series.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+signassoc">signassoc</a></code>, <code><a href="#topic+multipatt">multipatt</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Load species data
data(wetland) 

## Create three clusters using
wetkm &lt;- kmeans(wetland, centers=3)

## Compute Dufrene and Legendre's IndVal
strassoc(wetland, wetkm$cluster, func="IndVal.g") 

## Compute correlation, with bootstrap 95 percent confidence intervals
strassoc(wetland, wetkm$cluster, func="r.g", 
         nboot.ci =100) 
         
</code></pre>

<hr>
<h2 id='summary.multipatt'>Summarizing multi-level pattern analysis</h2><span id='topic+summary.multipatt'></span>

<h3>Description</h3>

<p>This is a <code>summary</code> function for <code>multipatt</code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'multipatt'
summary(
  object,
  alpha = 0.05,
  minstat = NULL,
  At = NULL,
  Bt = NULL,
  indvalcomp = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.multipatt_+3A_object">object</code></td>
<td>
<p>An object returned by function <code><a href="#topic+multipatt">multipatt</a></code>.</p>
</td></tr>
<tr><td><code id="summary.multipatt_+3A_alpha">alpha</code></td>
<td>
<p>Significance level for selecting species in the summary.</p>
</td></tr>
<tr><td><code id="summary.multipatt_+3A_minstat">minstat</code></td>
<td>
<p>Minimum value of the statistic for selecting species in the summary.</p>
</td></tr>
<tr><td><code id="summary.multipatt_+3A_at">At</code></td>
<td>
<p>Minimum value of positive predictive value (A) for selecting indicators. This argument is effective only if <code>multipatt</code> function was executed using <code>func = "IndVal"</code> or <code>func = "IndVal.g"</code>.</p>
</td></tr>
<tr><td><code id="summary.multipatt_+3A_bt">Bt</code></td>
<td>
<p>Minimum value for sensitivity (B) for selecting indicators. This argument is effective only if <code>multipatt</code> function was executed using <code>func = "IndVal"</code> or <code>func = "IndVal.g"</code>.</p>
</td></tr>
<tr><td><code id="summary.multipatt_+3A_indvalcomp">indvalcomp</code></td>
<td>
<p>Logical flag used to report components &quot;A&quot; (or &quot;A.g&quot;) and &quot;B&quot; of indicator values. This argument is effective only if <code>multipatt</code> function was executed using <code>func = "IndVal"</code> or <code>func = "IndVal.g"</code>.</p>
</td></tr>
<tr><td><code id="summary.multipatt_+3A_...">...</code></td>
<td>
<p>Additional arguments of the <code>summary</code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The summary function for <code>multipatt</code> objects presents the results of the analysis by grouping species following their associated site group combination. Only significantly associated species are listed for each combination. The user can limit the species shown by setting a significance level and the minimum value for the strength of the association.
</p>


<h3>Author(s)</h3>

<p>Miquel De Cáceres Ainsa, EMF-CREAF
</p>


<h3>See Also</h3>

<p><code><a href="#topic+strassoc">strassoc</a></code>, <code><a href="#topic+signassoc">signassoc</a></code>, <code><a href="#topic+multipatt">multipatt</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(stats)

## Loads species data
data(wetland) 

## Creates three clusters using kmeans
wetkm &lt;- kmeans(wetland, centers=3) 

## Runs the combination analysis using IndVal.g as statistic
wetpt &lt;- multipatt(wetland, wetkm$cluster) 

## Lists those species with significant association to one combination
summary(wetpt) 

## Lists those species with significant association to one combination, 
## including indval components
summary(wetpt, indvalcomp=TRUE) 

</code></pre>

<hr>
<h2 id='wetland'>Wetland vegetation data set</h2><span id='topic+wetland'></span>

<h3>Description</h3>

<p>Vegetation of the Adelaide river alluvial plain (Australia). This data set was published by Bowman &amp; Wilson (1987) and used in Dale (1988) to compare fuzzy classification approaches.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(wetland)</code></pre>


<h3>Format</h3>

<p>A data frame with 41 sites (rows) and 33 species (columns). Abundance values are represented in abundance classes.
</p>


<h3>Source</h3>

<p>Bowman, D. M. J. S. and B. A. Wilson. 1986. Wetland vegetation pattern on the Adelaide River flood plain, Northern Territory, Australia. Proceedings of the Royal Society of Queensland 97:69-77.
</p>


<h3>References</h3>

<p>Dale, M. B. 1988. Some fuzzy approaches to phytosociology. Ideals and instances. Folia geobotanica et phytotaxonomica 23:239-274.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(wetland)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
