<!DOCTYPE html><html lang="en"><head><title>Help for package penPHcure</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {penPHcure}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#penPHcure-package'><p>Variable Selection in Proportional-Hazards Cure Model with Time-Varying Covariates</p></a></li>
<li><a href='#cpRossi'><p>Criminal Recidivism Data</p></a></li>
<li><a href='#penPHcure'><p>Variable selection in PH cure model with time-varying covariates</p></a></li>
<li><a href='#penPHcure.object'><p>Penalized PH cure model object</p></a></li>
<li><a href='#penPHcure.simulate'><p>Simulation of a PH cure model with time-varying covariates</p></a></li>
<li><a href='#PHcure.object'><p>Standard PH cure model object</p></a></li>
<li><a href='#predict.penPHcure'><p>Predict method for penPHcure.object</p></a></li>
<li><a href='#predict.PHcure'><p>Predict method for PHcure.object</p></a></li>
<li><a href='#summary.penPHcure'><p>Summary method for penPHcure.object</p></a></li>
<li><a href='#summary.PHcure'><p>Summary method for PHcure.object</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Variable Selection in PH Cure Model with Time-Varying Covariates</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-12-03</td>
</tr>
<tr>
<td>Description:</td>
<td>Implementation of the semi-parametric proportional-hazards (PH) of Sy and Taylor (2000) &lt;<a href="https://doi.org/10.1111%2Fj.0006-341X.2000.00227.x">doi:10.1111/j.0006-341X.2000.00227.x</a>&gt; extended to time-varying covariates. Estimation and variable selection are based on the methodology described in Beretta and Heuchenne (2019) &lt;<a href="https://doi.org/10.1080%2F02664763.2018.1554627">doi:10.1080/02664763.2018.1554627</a>&gt;; confidence intervals of the parameter estimates may be computed using a bootstrap approach. Moreover, data following the PH cure model may be simulated using a method similar to Hendry (2014) &lt;<a href="https://doi.org/10.1002%2Fsim.5945">doi:10.1002/sim.5945</a>&gt;, where the event-times are generated on a continuous scale from a piecewise exponential distribution conditional on time-varying covariates.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Copyright:</td>
<td>Copyright (C) 2019 University of Liège (Belgium).</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp, MASS, Rdpack</td>
</tr>
<tr>
<td>Depends:</td>
<td>survival, R (&ge; 3.5)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/a-beretta/penPHcure">https://github.com/a-beretta/penPHcure</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/a-beretta/penPHcure/issues">https://github.com/a-beretta/penPHcure/issues</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.0.0</td>
</tr>
<tr>
<td>RdMacros:</td>
<td>Rdpack</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-12-03 14:26:51 UTC; alessandroberetta</td>
</tr>
<tr>
<td>Author:</td>
<td>Alessandro Beretta
    <a href="https://orcid.org/0000-0002-0427-8785"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre],
  Cédric Heuchenne <a href="https://orcid.org/0000-0002-3150-3044"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Alessandro Beretta &lt;a.beretta@uliege.be&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-12-03 17:20:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='penPHcure-package'>Variable Selection in Proportional-Hazards Cure Model with Time-Varying Covariates</h2><span id='topic+penPHcure-package'></span>

<h3>Description</h3>

<p>Contrary to standard survival analysis models, which rely on the assumption that the entire population will eventually experience the event of interest, mixture cure models allow to split the population in susceptible and non-susceptible (cured) individuals.
</p>
<p>In this R package, we implement the semi-parametric proportional-hazards (PH) cure model of Sy and Taylor (2000) extended to time-varying covariates.
If we define <code class="reqn">T</code> as the time-to-event, the survival function for the entire population is given by
</p>
<p style="text-align: center;"><code class="reqn">S(t)=(1-p)+pS(t|Y=1)</code>
</p>

<p>where <code class="reqn">p</code> is the incidence (i.e. probability of being susceptible) and <code class="reqn">S(t|Y=1)</code> is the latency (i.e. survival function conditional on being susceptible). 
</p>
<p>The incidence is modeled by a logistic regression model: </p>
<p style="text-align: center;"><code class="reqn">p=P(Y=1|\mathbf{x}_i)=\exp(\mathbf{x}_i'\textbf{b})/(1+\exp(\mathbf{x}_i'\textbf{b)}),</code>
</p>
<p> where <code class="reqn">\textbf{x}_i</code> is a vector of time-invariant covariates (including the intercept) and <code class="reqn">\mathbf{b}</code> a vector of unknown coefficients.
Whereas, the latency is modeled by a Cox’s PH model: </p>
<p style="text-align: center;"><code class="reqn">\lambda(t|Y=1,\textbf{z}_i(t))=\lambda_{0}(t|Y=1)e^{\textbf{z}_i'(t)\boldsymbol{\beta}},</code>
</p>
<p> where <code class="reqn">\textbf{z}_i(t)</code> is a vector of time-varying covariates, <code class="reqn">\lambda_{0}(t|Y=1)</code> is an arbitrary conditional baseline hazard function and <code class="reqn">\boldsymbol{\beta}</code> is a vector of unknown coefficients.
</p>
<p>The function <code><a href="#topic+penPHcure">penPHcure</a></code> allows to:
</p>

<ul>
<li><p> estimate the regression coefficients (<code class="reqn">\textbf{b}</code>, <code class="reqn">\boldsymbol{\beta}</code>) and the baseline hazard function <code class="reqn">\lambda_{0}(t|Y=1)</code>; 
</p>
</li>
<li><p> compute confidence intervals for the estimated regression coefficients using the basic/percentile bootstrap method;
</p>
</li>
<li><p> perform variable selection with the SCAD-penalized likelihood technique proposed by Beretta and Heuchenne (2019).
</p>
</li></ul>

<p>Moreover, the function <code><a href="#topic+penPHcure.simulate">penPHcure.simulate</a></code> allows to simulate data from a PH cure model, where the event-times are generated on a continuous scale from a piecewise exponential distribution conditional on time-varying covariates, using a method similar to the one described in Hendry (2014).
</p>


<h3>References</h3>

<p>Beretta A, Heuchenne C (2019).
&ldquo;Variable selection in proportional hazards cure model with time-varying covariates, application to US bank failures.&rdquo;
<em>Journal of Applied Statistics</em>, <b>46</b>(9), 1529-1549.
doi: <a href="https://doi.org/10.1080/02664763.2018.1554627">10.1080/02664763.2018.1554627</a>.<br /><br /> Hendry DJ (2014).
&ldquo;Data generation for the Cox proportional hazards model with time-dependent covariates: a method for medical researchers.&rdquo;
<em>Statistics in Medicine</em>, <b>33</b>(3), 436-454.
doi: <a href="https://doi.org/10.1002/sim.5945">10.1002/sim.5945</a>.<br /><br /> Sy JP, Taylor JM (2000).
&ldquo;Estimation in a Cox proportional hazards cure model.&rdquo;
<em>Biometrics</em>, <b>56</b>(1), 227-236.
doi: <a href="https://doi.org/10.1111/j.0006-341X.2000.00227.x">10.1111/j.0006-341X.2000.00227.x</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+penPHcure">penPHcure</a></code>, <code><a href="#topic+penPHcure.simulate">penPHcure.simulate</a></code>
</p>

<hr>
<h2 id='cpRossi'>Criminal Recidivism Data</h2><span id='topic+cpRossi'></span>

<h3>Description</h3>

<p>A sample of 432 inmates released from Maryland state prisons followed for one year after release (Rossi et al. 1980).
The aim of this study was to investigate the relationship between the time to first arrest after release and some covariates observed during the follow-up period.
Most of the variables are constant over time, except one binary variable denoting whether the individual was working full time during the follow-up period.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cpRossi

data(cpRossi,package="penPHcure")
</code></pre>


<h3>Format</h3>

<p>A <code>data.frame</code> in counting process format with 1405 observations for 432 individuals on the following 13 variables.
</p>

<dl>
<dt><code>id</code></dt><dd><p>integer. Identification code for each individual.</p>
</dd>
<dt>(<code>tstart</code>, <code>tstop</code>]</dt><dd><p>integers. Time interval of the observation (in weeks). Observation for each individual start after the first release.</p>
</dd>
<dt><code>arrest</code></dt><dd><p>factor with 2 levels (&quot;no&quot;, &quot;yes&quot;). Denote whether the individual has been arrested during the 1 year follow-up period or not.</p>
</dd>
<dt><code>fin</code></dt><dd><p>factor with 2 levels (&quot;no&quot;, &quot;yes&quot;). Denote whether the inmate received financial aid after release.</p>
</dd>
<dt><code>age</code></dt><dd><p>integer. Age in years at the time of release.</p>
</dd>
<dt><code>race</code></dt><dd><p>factor with 2 levels (&quot;black&quot;, &quot;other&quot;). Denote whether the race of the individual is black or not.</p>
</dd>
<dt><code>wexp</code></dt><dd><p>factor with 2 levels (&quot;no&quot;, &quot;yes&quot;). Denote whether the individual had full-time work experience before incarceration or not.</p>
</dd>
<dt><code>mar</code></dt><dd><p>factor with 2 levels (&quot;yes&quot;, &quot;no&quot;). Denote whether the inmate was married at the time of release or not.</p>
</dd>
<dt><code>paro</code></dt><dd><p>factor with 2 levels (&quot;no&quot;, &quot;yes&quot;). Denote whether the inmate was released on parole or not.</p>
</dd>
<dt><code>prio</code></dt><dd><p>integer. The number of convictions an inmate had prior to incarceration.</p>
</dd>
<dt><code>educ</code></dt><dd><p>factor with 3 levels (&quot;3&quot;, &quot;4&quot;, &quot;5&quot;). Level of education: 
</p>

<ul>
<li><p> &quot;3&quot;: &lt;=9th degree; 
</p>
</li>
<li><p> &quot;4&quot;: 10th or 11th degree; and 
</p>
</li>
<li><p> &quot;5&quot;: &gt;=12 degree.
</p>
</li></ul>
</dd>
<dt><code>emp</code></dt><dd><p>factor with 2 levels (&quot;no&quot;, &quot;yes&quot;). Denote whether the individual was working full time during the observed time interval.</p>
</dd>
</dl>


<h3>Source</h3>

<p>The <code>Rossi</code> dataset in the <code>RcmdrPlugin.survival</code> package (Fox and Carvalho 2012) is the source of these data, which have been converted into counting process format.
</p>


<h3>References</h3>

<p>Fox J, Carvalho MS (2012).
&ldquo;The RcmdrPlugin.survival Package: Extending the R Commander Interface to Survival Analysis.&rdquo;
<em>Journal of Statistical Software</em>, <b>49</b>(7), 1&ndash;32.
<a href="http://www.jstatsoft.org/v49/i07/">http://www.jstatsoft.org/v49/i07/</a>.<br /><br /> Rossi PH, Berk RA, Lenihan KJ (1980).
<em>Money, Work, and Crime: Experimental Evidence</em>.
New York: Academic Press.
doi: <a href="https://doi.org/10.1016/C2013-0-11412-2">10.1016/C2013-0-11412-2</a>.
</p>

<hr>
<h2 id='penPHcure'>Variable selection in PH cure model with time-varying covariates</h2><span id='topic+penPHcure'></span>

<h3>Description</h3>

<p>This function allows to fit a PH cure model with time varying covariates, to compute confidence intervals for the estimated regression coefficients or to make variable selection through a LASSO/SCAD-penalized model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>penPHcure(
  formula,
  cureform,
  data,
  X = NULL,
  maxIterNR = 500,
  maxIterEM = 500,
  tol = 1e-06,
  standardize = TRUE,
  ties = c("efron", "breslow"),
  SV = NULL,
  which.X = c("last", "mean"),
  inference = FALSE,
  nboot = 100,
  constraint = TRUE,
  pen.type = c("none", "SCAD", "LASSO"),
  pen.weights = NULL,
  pen.tuneGrid = NULL,
  epsilon = 1e-08,
  pen.thres.zero = 1e-06,
  print.details = TRUE,
  warnings = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="penPHcure_+3A_formula">formula</code></td>
<td>
<p>a formula object, with the response on the left of a <code>~</code> operator and the variables to be included in the latency (survival) component on the right. The response must be a survival object returned by the <code>Surv(time,time2,status)</code> function.</p>
</td></tr>
<tr><td><code id="penPHcure_+3A_cureform">cureform</code></td>
<td>
<p>a one-sided formula object of the form <code>~ x1 + x2 + ...</code> with the covariates to be included in the incidence (cure) component.</p>
</td></tr>
<tr><td><code id="penPHcure_+3A_data">data</code></td>
<td>
<p>a data.frame (in a counting process format) in which to interpret the variables named in the <code>formula</code> and <code>cureform</code> arguments.</p>
</td></tr>
<tr><td><code id="penPHcure_+3A_x">X</code></td>
<td>
<p>a matrix of time-invariant covariates to be included in the incidence (cure) component. If the user provide such matrix, the arguments <code>cureform</code> and <code>which.X</code> will be ignored. By default, <code>X = NULL</code>.</p>
</td></tr>
<tr><td><code id="penPHcure_+3A_maxiternr">maxIterNR</code></td>
<td>
<p>a positive integer: the maximum number of iterations to attempt for convergence of the Newton-Raphson (NR) algorithm (Cox's and logistic regression model). By default <code>maxIterNR = 500</code>.</p>
</td></tr>
<tr><td><code id="penPHcure_+3A_maxiterem">maxIterEM</code></td>
<td>
<p>a positive integer: the maximum number of iterations to attempt for convergence of the Expectation-Maximization (EM) algorithm. By default <code>maxIterEM = 500</code>.</p>
</td></tr>
<tr><td><code id="penPHcure_+3A_tol">tol</code></td>
<td>
<p>a positive numeric value used to determine convergence of the NR and EM algorithms. By default, <code>tol = 1e-6</code>.</p>
</td></tr>
<tr><td><code id="penPHcure_+3A_standardize">standardize</code></td>
<td>
<p>a logical value. If <code>TRUE</code>, the values of the covariates are standardized (centered and scaled), such that their mean and variance will be equal to 0 and 1, respectively. By default, <code>standardize = TRUE</code>.</p>
</td></tr>
<tr><td><code id="penPHcure_+3A_ties">ties</code></td>
<td>
<p>a character string used to specify the method for handling ties: either <code>"efron"</code> or <code>"breslow"</code>. By default, <code>ties = "efron"</code>.</p>
</td></tr>
<tr><td><code id="penPHcure_+3A_sv">SV</code></td>
<td>
<p>a list with elements <code>b</code> and <code>beta</code>, numeric vectors of starting values for the regression coefficients in the incidence (cure) and latency (survival) component, respectively. By default <code>SV = NULL</code>.</p>
</td></tr>
<tr><td><code id="penPHcure_+3A_which.x">which.X</code></td>
<td>
<p>character string used to specify the method used to transform the covariates included in the incidence (cure) component from time-varying to time-invariant. There are two options: either take the last observation (<code>"last"</code>) or the mean over the full history of the covariates (<code>"mean"</code>). By default, <code>which.X = "last"</code>.</p>
</td></tr>
<tr><td><code id="penPHcure_+3A_inference">inference</code></td>
<td>
<p>a logical value. If <code>TRUE</code> and <code>pen.type == "none"</code>, confidence intervals for the regression coefficient estimates are computed using the basic/percentile bootstrap method. By default <code>inference = FALSE</code>.</p>
</td></tr>
<tr><td><code id="penPHcure_+3A_nboot">nboot</code></td>
<td>
<p>a positive integer: the number of bootstrap resamples for the construction of the confidence intervals (used only when <code>inference = TRUE</code>). By default, <code>nboot = 100</code>.</p>
</td></tr>
<tr><td><code id="penPHcure_+3A_constraint">constraint</code></td>
<td>
<p>a logical value. If <code>TRUE</code>, the model makes use of the zero-tail constraint, classifying the individuals with censoring times grater than the largest event time as non-susceptible. For more details, see Sy and Taylor (2000). By default <code>constraint = TRUE</code>.</p>
</td></tr>
<tr><td><code id="penPHcure_+3A_pen.type">pen.type</code></td>
<td>
<p>a character string used to specify the type of penalty used to make variable selection: either <code>"none"</code>, <code>"SCAD"</code> or <code>"LASSO"</code>. By default, <code>pen.type="none"</code>, only a standard model is fitted without performing variable selection.</p>
</td></tr>
<tr><td><code id="penPHcure_+3A_pen.weights">pen.weights</code></td>
<td>
<p>a list with elements named <code>CURE</code> and <code>SURV</code>, positive numeric vectors of penalty weights for the covariates in the incidence (cure) and latency (survival) component, respectively. By default, all weights are set equal to 1, except for the intercept in the incidence (cure) component (always equal to 0).</p>
</td></tr>
<tr><td><code id="penPHcure_+3A_pen.tunegrid">pen.tuneGrid</code></td>
<td>
<p>a list with elements named <code>CURE</code> and <code>SURV</code>, named lists of tuning parameter vectors. If <code>pen.type == "SCAD"</code> they should contain two numeric vectors of possible tuning parameters: <code>lambda</code> and <code>a</code>. Whereas, if <code>pen.type == "LASSO"</code>, only one vector <code>lambda</code>. By default <code>lambda = exp(seq(-7,0,length.out = 10))</code> and <code>a = 3.7</code>.</p>
</td></tr>
<tr><td><code id="penPHcure_+3A_epsilon">epsilon</code></td>
<td>
<p>a positive numeric value used as a perturbation of the penalty function. By default, <code>epsilon = 1e-08</code>.</p>
</td></tr>
<tr><td><code id="penPHcure_+3A_pen.thres.zero">pen.thres.zero</code></td>
<td>
<p>a positive numeric value used as a threshold. After fitting the penalized PH cure model, the estimated regression coefficients with an absolute value lower than this threshold are set equal to zero. By default, <code>pen.thres.zero = 1e-06</code>.</p>
</td></tr>
<tr><td><code id="penPHcure_+3A_print.details">print.details</code></td>
<td>
<p>a logical value. If <code>TRUE</code>, tracing information on the progress of the routines is produced. By default <code>print.details = TRUE</code>.</p>
</td></tr>
<tr><td><code id="penPHcure_+3A_warnings">warnings</code></td>
<td>
<p>a logical value. If <code>TRUE</code>, possible warnings from the NR and EM algorithms are produced. By default <code>warnings = FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When the starting values (<code>SV</code>) are not specified and <code>pen.type == "none"</code>:
</p>

<ul>
<li> <p><code>SV$b</code> is set equal to the estimates of a logistic regression model with the event indicator (0=censored, 1=event) as dependent variable; and
</p>
</li>
<li> <p><code>SV$beta</code> is set equal to the estimates of a standard Cox's model.
</p>
</li></ul>

<p>Whereas, if <code>pen.type == "SCAD" | "LASSO"</code>, both vectors are filled with zeros.
</p>
<p>When performing variable selection (<code>pen.type == "SCAD" | "LASSO"</code>), a penalized PH cure model is fitted for each possible combination of the tuning parameters in <code>pen.tuneGrid</code>. Two models are selected on the basis of the Akaike and Bayesian Information Criteria: </p>
<p style="text-align: center;"><code class="reqn">AIC=-ln(\hat{L})+2df,</code>
</p>
 <p style="text-align: center;"><code class="reqn">BIC=-ln(\hat{L})+ln(n)df,</code>
</p>
<p> where <code class="reqn">ln(\hat{L})</code> is the value of the log-likelihood at the penalized MLEs, <code class="reqn">df</code> is the value of the degrees of freedom (number of non-zero coefficients) and <code class="reqn">n</code> is the sample size.
</p>
<p>Regarding the possible tuning parameters in <code>pen.tuneGrid</code>, the numeric vectors <code>lambda</code> and <code>a</code> should contain values &gt;= 0 and &gt; 2, respectively.
</p>


<h3>Value</h3>

<p>If the argument <code>pen.type = "none"</code>, this function returns a <code><a href="#topic+PHcure.object">PHcure.object</a></code>. Otherwise, if <code>pen.type == "SCAD" | "LASSO"</code>, it returns a <code><a href="#topic+penPHcure.object">penPHcure.object</a></code>.
</p>


<h3>References</h3>

<p>Beretta A, Heuchenne C (2019).
&ldquo;Variable selection in proportional hazards cure model with time-varying covariates, application to US bank failures.&rdquo;
<em>Journal of Applied Statistics</em>, <b>46</b>(9), 1529-1549.
doi: <a href="https://doi.org/10.1080/02664763.2018.1554627">10.1080/02664763.2018.1554627</a>.
</p>
<p>Sy JP, Taylor JM (2000).
&ldquo;Estimation in a Cox proportional hazards cure model.&rdquo;
<em>Biometrics</em>, <b>56</b>(1), 227-236.
doi: <a href="https://doi.org/10.1111/j.0006-341X.2000.00227.x">10.1111/j.0006-341X.2000.00227.x</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+penPHcure-package">penPHcure-package</a></code>, <code><a href="#topic+PHcure.object">PHcure.object</a></code>, <code><a href="#topic+penPHcure.object">penPHcure.object</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Generate some data (for more details type ?penPHcure.simulate in your console)
data &lt;- penPHcure.simulate()

### Standard PH cure model

# Fit standard cure model (without inference)
fit &lt;- penPHcure(Surv(time = tstart,time2 = tstop,
                      event = status) ~ z.1 + z.2 + z.3 + z.4,
                 cureform = ~ x.1 + x.2 + x.3 + x.4,data = data)
# The returned PHcure.object has methods summary and predict, 
#  for more details type ?summary.PHcure or ?predict.PHcure in your console.

# Fit standard cure model (with inference)
fit2 &lt;- penPHcure(Surv(time = tstart,time2 = tstop,
                       event = status) ~ z.1 + z.2 + z.3 + z.4,
                  cureform = ~ x.1 + x.2 + x.3 + x.4,data = data,
                  inference = TRUE)
# The returned PHcure.object has methods summary and predict, 
#  for more details type ?summary.PHcure or ?predict.PHcure in your console.


### Tune penalized cure model with SCAD penalties

# First define the grid of possible values for the tuning parameters.
pen.tuneGrid &lt;- list(CURE = list(lambda = exp(seq(-7,-2,length.out = 10)),
                                 a = 3.7),
                     SURV = list(lambda = exp(seq(-7,-2,length.out = 10)),
                                 a = 3.7))
# Tune the penalty parameters.
tuneSCAD &lt;- penPHcure(Surv(time = tstart,time2 = tstop,
                           event = status) ~ z.1 + z.2 + z.3 + z.4,
                      cureform = ~ x.1 + x.2 + x.3 + x.4,
                      data = data,pen.type = "SCAD",
                      pen.tuneGrid = pen.tuneGrid)
# The returned penPHcure.object has methods summary and predict, for more
#  details type ?summary.penPHcure or ?predict.penPHcure in your console.

### Tune penalized cure model with LASSO penalties

# First define the grid of possible values for the tuning parameters.
pen.tuneGrid &lt;- list(CURE = list(lambda = exp(seq(-7,-2,length.out = 10))),
                     SURV = list(lambda = exp(seq(-7,-2,length.out = 10))))
# Tune the penalty parameters.
tuneLASSO &lt;- penPHcure(Surv(time = tstart,time2 = tstop,
                            event = status) ~ z.1 + z.2 + z.3 + z.4,
                       cureform = ~ x.1 + x.2 + x.3 + x.4,
                       data = data,pen.type = "LASSO",
                       pen.tuneGrid = pen.tuneGrid)
# The returned penPHcure.object has methods summary and predict, for more
#  details type ?summary.penPHcure or ?predict.penPHcure in your console.

</code></pre>

<hr>
<h2 id='penPHcure.object'>Penalized PH cure model object</h2><span id='topic+penPHcure.object'></span>

<h3>Description</h3>

<p>This class of objects is returned by the function <code><a href="#topic+penPHcure">penPHcure</a></code> when is called with the argument <code>pen.type = "SCAD" | "LASSO"</code>. Objects of this class have methods for the functions <code>summary</code> and <code>predict</code>.
</p>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="penPHcure.object_+3A_aic">AIC</code></td>
<td>
<p>a list with elements containing the results of the selected model based on the Akaike information criterion (AIC). See Details.</p>
</td></tr>
<tr><td><code id="penPHcure.object_+3A_bic">BIC</code></td>
<td>
<p>a list with elements containing the results of the selected model based on the Bayesian Information Criterion (BIC). See Details.</p>
</td></tr>
<tr><td><code id="penPHcure.object_+3A_pen.type">pen.type</code></td>
<td>
<p>a character string indicating the type of penalty used, either <code>"SCAD"</code> or <code>"LASSO"</code>.</p>
</td></tr>
<tr><td><code id="penPHcure.object_+3A_tunegrid">tuneGrid</code></td>
<td>
<p>a data.frame containing the values of the AIC and BIC criteria for each combination of the tuning parameters.</p>
</td></tr>
<tr><td><code id="penPHcure.object_+3A_pen.weights">pen.weights</code></td>
<td>
<p>a list with elements named <code>CURE</code> and <code>SURV</code>, containing the penalty weights. For more details, see <code><a href="#topic+penPHcure">penPHcure</a></code>.</p>
</td></tr>
<tr><td><code id="penPHcure.object_+3A_n">N</code></td>
<td>
<p>the sample size (number of individuals).</p>
</td></tr>
<tr><td><code id="penPHcure.object_+3A_k">K</code></td>
<td>
<p>the number of unique failure times.</p>
</td></tr>
<tr><td><code id="penPHcure.object_+3A_isties">isTies</code></td>
<td>
<p>logical value: <code>TRUE</code> in case of tied event times.</p>
</td></tr>
<tr><td><code id="penPHcure.object_+3A_censoring">censoring</code></td>
<td>
<p>the proportion of censored individuals.</p>
</td></tr>
<tr><td><code id="penPHcure.object_+3A_which.x">which.X</code></td>
<td>
<p>character string indicating the method used to transform the covariates included in the incidence (cure) component from time-varying to time-invariant. See <code><a href="#topic+penPHcure">penPHcure</a></code> for more details.</p>
</td></tr>
<tr><td><code id="penPHcure.object_+3A_survform">survform</code></td>
<td>
<p>a formula object with all variables involved in the latency (survival) component of the model.</p>
</td></tr>
<tr><td><code id="penPHcure.object_+3A_cureform">cureform</code></td>
<td>
<p>a formula object with all variables involved in the incidence (survival) component of the model.</p>
</td></tr>
<tr><td><code id="penPHcure.object_+3A_call">call</code></td>
<td>
<p>object of class <code>call</code>, with all the specified arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The lists <code>AIC</code> and <code>BIC</code> contain the results of the selected model based on the Akaike information criterion (AIC) and Bayesian Information Criterion (BIC), respectively. They are composed by the following elements:
</p>

<ul>
<li> <p><code>crit</code>: value of the minimized AIC/BIC criterion.
</p>
</li>
<li> <p><code>b</code>: a numeric vector with the estimated regression coefficients in the cure (incidence) component.
</p>
</li>
<li> <p><code>beta</code>: a numeric vector with the true estimated coefficients in the survival (latency) component.
</p>
</li>
<li> <p><code>cumhaz</code>: a numeric vector with the estimated cumulative baseline hazard function at the unique event times (reported in the <code>"names"</code> attribute).
</p>
</li>
<li> <p><code>tune_params</code>: a list with elements named <code>CURE</code> and <code>SURV</code> containing the selected tuning parameters, which minimize the AIC/BIC criterion.
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+penPHcure">penPHcure</a></code>
</p>

<hr>
<h2 id='penPHcure.simulate'>Simulation of a PH cure model with time-varying covariates</h2><span id='topic+penPHcure.simulate'></span>

<h3>Description</h3>

<p>This function allows to simulate data from a PH cure model with time-varying covariates:
</p>

<ul>
<li><p> the event-times are generated on a continuous scale from a piecewise exponential distribution conditional on time-varying covariates and regression coefficients <code>beta0</code>, using a method similar to the one described in <em>Hendry (2014)</em>. The time varying covariates are constant in the intervals <code class="reqn">(s_{j-1},s_j]</code>, for <code class="reqn">j=1,,,,J</code>.
</p>
</li>
<li><p> the censoring times are generated from an exponential distribution truncated above <code class="reqn">s_J</code>;
</p>
</li>
<li><p> the susceptibility indicators are generated from a logistic regression model conditional on time-invariant covariates and regression coefficients <code>b0</code>.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>penPHcure.simulate(
  N = 500,
  S = seq(0.1, 5, by = 0.1),
  b0 = c(1.2, -1, 0, 1, 0),
  beta0 = c(1, 0, -1, 0),
  gamma = 1,
  lambdaC = 1,
  mean_CURE = rep(0, length(b0) - 1L),
  mean_SURV = rep(0, length(beta0)),
  sd_CURE = rep(1, length(b0) - 1L),
  sd_SURV = rep(1, length(beta0)),
  cor_CURE = diag(length(b0) - 1L),
  cor_SURV = diag(length(beta0)),
  X = NULL,
  Z = NULL,
  C = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="penPHcure.simulate_+3A_n">N</code></td>
<td>
<p>the sample size (number of individuals). By default, <code>N = 500</code>.</p>
</td></tr>
<tr><td><code id="penPHcure.simulate_+3A_s">S</code></td>
<td>
<p>a numeric vector containing the end of the time intervals, in ascending order, over which the time-varying covariates are constant (the first interval start at 0). By default, <code>S = seq(0.1, 5, by=0.1)</code>.</p>
</td></tr>
<tr><td><code id="penPHcure.simulate_+3A_b0">b0</code></td>
<td>
<p>a numeric vector with the true coefficients in the incidence (cure) component, used to generate the susceptibility indicators. By default, <code>b0 = c(1.2,-1,0,1,0)</code>.</p>
</td></tr>
<tr><td><code id="penPHcure.simulate_+3A_beta0">beta0</code></td>
<td>
<p>a numeric vector with the true regression coefficients in the latency (survival)  component, used to generate the event times. By default, <code>beta0 = c(1,0,-1,0)</code>.</p>
</td></tr>
<tr><td><code id="penPHcure.simulate_+3A_gamma">gamma</code></td>
<td>
<p>a positive numeric value, parameter controlling the shape of the baseline hazard function: <code class="reqn">\lambda_0(t) = \gamma t^{\gamma-1}</code>. By default, <code>gamma = 1</code>.</p>
</td></tr>
<tr><td><code id="penPHcure.simulate_+3A_lambdac">lambdaC</code></td>
<td>
<p>a positive numeric value, parameter of the truncated exponential distribution used to generate the censoring times. By default, <code>lambdaC = 1</code>.</p>
</td></tr>
<tr><td><code id="penPHcure.simulate_+3A_mean_cure">mean_CURE</code></td>
<td>
<p>a numeric vector of means for the variables used to generate the susceptibility indicators. By default, all zeros.</p>
</td></tr>
<tr><td><code id="penPHcure.simulate_+3A_mean_surv">mean_SURV</code></td>
<td>
<p>a numeric vector of means for the variables used to generate the event-times. By default, all zeros.</p>
</td></tr>
<tr><td><code id="penPHcure.simulate_+3A_sd_cure">sd_CURE</code></td>
<td>
<p>a numeric vector of standard deviations for the variables used to generate the susceptibility indicators. By default, all ones.</p>
</td></tr>
<tr><td><code id="penPHcure.simulate_+3A_sd_surv">sd_SURV</code></td>
<td>
<p>a numeric vector of standard deviations for the variables used to generate the event-times. By default, all ones.</p>
</td></tr>
<tr><td><code id="penPHcure.simulate_+3A_cor_cure">cor_CURE</code></td>
<td>
<p>the correlation matrix of the variables used to generate the susceptibility indicators. By default, an identity matrix.</p>
</td></tr>
<tr><td><code id="penPHcure.simulate_+3A_cor_surv">cor_SURV</code></td>
<td>
<p>the correlation matrix of the variables used to generate the event-times. By default, an identity matrix.</p>
</td></tr>
<tr><td><code id="penPHcure.simulate_+3A_x">X</code></td>
<td>
<p>[optional] a matrix of time-invariant covariates used to generate the susceptibility indicators, with dimension <code>N</code> by <code>length(b0)-1L</code>. By default, <code>X = NULL</code>.</p>
</td></tr>
<tr><td><code id="penPHcure.simulate_+3A_z">Z</code></td>
<td>
<p>[optional] an array of time-varying covariates used to generate the censoring times, with dimension <code>length(S)</code> by <code>length(beta)</code> by <code>N</code>. By default, <code>Z = NULL</code>.</p>
</td></tr>
<tr><td><code id="penPHcure.simulate_+3A_c">C</code></td>
<td>
<p>[optional] a vector of censoring times with <code>N</code> elements.  By default, <code>C = NULL</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>By default, the time-varying covariates in the latency (survival) component are generated from a multivariate normal distribution with means <code>mean_SURV</code>, standard deviations <code>sd_SURV</code> and correlation matrix <code>cor_SURV</code>. Otherwise, they can be provided by the user using the argument <code>Z</code>. In this case, the arguments <code>mean_SURV</code>, <code>sd_SURV</code> and <code>cor_SURV</code> will be ignored. 
</p>
<p>By default, the time-invariant covariates in the incidence (cure) component are generated from a multivariate normal distribution with means <code>mean_CURE</code>, standard deviations <code>sd_CURE</code> and correlation matrix <code>cor_CURE</code>. Otherwise, they can be provided by the user using the argument <code>X</code>. In this case, the arguments <code>mean_CURE</code>, <code>sd_CURE</code> and <code>cor_CURE</code> will be ignored.
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> with columns:
</p>
<table role = "presentation">
<tr><td><code>id</code></td>
<td>
<p>unique ID number associated to each individual.</p>
</td></tr>
<tr><td><code>tstart</code></td>
<td>
<p>start of the time interval.</p>
</td></tr>
<tr><td><code>tstop</code></td>
<td>
<p>end of the time interval.</p>
</td></tr>
<tr><td><code>status</code></td>
<td>
<p>event indicator, 1 if the event occurs or 0, otherwise.</p>
</td></tr>
<tr><td><code>z.?</code></td>
<td>
<p>one or more columns of covariates used to generate the survival times.</p>
</td></tr>
<tr><td><code>x.?</code></td>
<td>
<p>one or more columns of covariates used to generate the susceptibility indicator (constant over time).</p>
</td></tr>
</table>
<p>In addition, it contains the following attributes:
</p>
<table role = "presentation">
<tr><td><code>perc_cure</code></td>
<td>
<p>Percentage of individuals not susceptible to the event of interest.</p>
</td></tr>
<tr><td><code>perc_cens</code></td>
<td>
<p>Percentage of censoring.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Hendry DJ (2014).
&ldquo;Data generation for the Cox proportional hazards model with time-dependent covariates: a method for medical researchers.&rdquo;
<em>Statistics in Medicine</em>, <b>33</b>(3), 436-454.
doi: <a href="https://doi.org/10.1002/sim.5945">10.1002/sim.5945</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### Example 1:
###  - event-times generated from a Cox's PH model with unit baseline hazard
###    and time-varying covariates generated from independent standard normal 
###    distributions over the intervals (0,s_1], (s_1,s_2], ..., (s_1,s_J]. 
###  - censoring times generated from an exponential distribution truncated 
###    above s_J.
###  - covariates in the incidence (cure) component generated from independent 
###    standard normal distributions.

# Define the sample size
N &lt;- 250
# Define the time intervals for the time-varying covariates
S &lt;- seq(0.1, 5, by=0.1)
# Define the true regression coefficients (incidence and latency)  
b0 &lt;- c(1,-1,0,1,0)
beta0 &lt;- c(1,0,-1,0)
# Define the parameter of the truncated exponential distribution (censoring) 
lambdaC &lt;- 1.5
# Simulate the data
data1 &lt;- penPHcure.simulate(N = N,S = S,
                            b0 = b0,
                            beta0 = beta0,
                            lambdaC = lambdaC)

                           
### Example 2:
###  Similar to the previous example, but with a baseline hazard function 
###   defined as lambda_0(t) = 3t^2.

# Define the sample size
N &lt;- 250
# Define the time intervals for the time-varying covariates
S &lt;- seq(0.1, 5, by=0.1)
# Define the true regression coefficients (incidence and latency)  
b0 &lt;- c(1,-1,0,1,0)
beta0 &lt;- c(1,0,-1,0)
# Define the parameter controlling the shape of the baseline hazard function
gamma &lt;- 3
# Simulate the data
data2 &lt;- penPHcure.simulate(N = N,S = S,
                            b0 = b0,
                            beta0 = beta0,
                            gamma = gamma)


### Example 3:
###  Simulation with covariates in the cure and survival components generated
###   from multivariate normal (MVN) distributions with specific means, 
###   standard deviations and correlation matrices.

# Define the sample size
N &lt;- 250
# Define the time intervals for the time-varying covariates
S &lt;- seq(0.1, 5, by=0.1)
# Define the true regression coefficients (incidence and latency)  
b0 &lt;- c(-1,-1,0,1,0)
beta0 &lt;- c(1,0,-1,0)
# Define the means of the MVN distribution (incidence and latency)  
mean_CURE &lt;- c(-1,0,1,2)
mean_SURV &lt;- c(2,1,0,-1)
# Define the std. deviations of the MVN distribution (incidence and latency)  
sd_CURE &lt;- c(0.5,1.5,1,0.5)
sd_SURV &lt;- c(0.5,1,1.5,0.5)
# Define the correlation matrix of the MVN distribution (incidence and latency)  
cor_CURE &lt;- matrix(NA,4,4)
for (p in 1:4)
  for (q in 1:4)
    cor_CURE[p,q] &lt;- 0.8^abs(p - q)
cor_SURV &lt;- matrix(NA,4,4)
for (p in 1:4)
  for (q in 1:4)
    cor_SURV[p,q] &lt;- 0.8^abs(p - q)
# Simulate the data
data3 &lt;- penPHcure.simulate(N = N,S = S,
                            b0 = b0,
                            beta0 = beta0,
                            mean_CURE = mean_CURE,
                            mean_SURV = mean_SURV,
                            sd_CURE = sd_CURE,
                            sd_SURV = sd_SURV,
                            cor_CURE = cor_CURE,
                            cor_SURV = cor_SURV)


### Example 4:
###  Simulation with covariates in the cure and survival components from a 
###   data generating process specified by the user. 

# Define the sample size
N &lt;- 250
# Define the time intervals for the time-varying covariates
S &lt;- seq(0.1, 5, by=0.1)
# Define the true regression coefficients (incidence and latency)  
b0 &lt;- c(1,-1,0,1,0)
beta0 &lt;- c(1,0,-1,0)
# As an example, we simulate data with covariates following independent
#  standard uniform distributions. But the user could provide random draws 
#  from any other distribution. Be careful!!! X should be a matrix of size 
#  N x length(b0) and Z an array of size length(S) x length(beta0) x N.
X &lt;- matrix(runif(N*(length(b0)-1)),N,length(b0)-1)
Z &lt;- array(runif(N*length(S)*length(beta0)),c(length(S),length(beta0),N))
data4 &lt;- penPHcure.simulate(N = N,S = S,
                            b0 = b0,
                            beta0 = beta0,
                            X = X,
                            Z = Z)


### Example 5:
###  Simulation with censoring times from a data generating process 
###   specified by the user

# Define the sample size
N &lt;- 250
# Define the time intervals for the time-varying covariates
S &lt;- seq(0.1, 5, by=0.1)
# Define the true regression coefficients (incidence and latency)  
b0 &lt;- c(1,-1,0,1,0)
beta0 &lt;- c(1,0,-1,0)
# As an example, we simulate data with censoring times following
#  a standard uniform distribution between 0 and S_J.
#  Be careful!!! C should be a numeric vector of length N.
C &lt;- runif(N)*max(S)
data5 &lt;- penPHcure.simulate(N = N,S = S,
                            b0 = b0,
                            beta0 = beta0,
                            C = C)
                           
</code></pre>

<hr>
<h2 id='PHcure.object'>Standard PH cure model object</h2><span id='topic+PHcure.object'></span>

<h3>Description</h3>

<p>This class of objects is returned by the function <code><a href="#topic+penPHcure">penPHcure</a></code> when is called with the argument <code>pen.type = "none"</code>. Objects of this class have methods for the functions <code>summary</code> and <code>predict</code>.
</p>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PHcure.object_+3A_b">b</code></td>
<td>
<p>a numeric vector with the estimated regression coefficients in the cure (incidence) component.</p>
</td></tr>
<tr><td><code id="PHcure.object_+3A_beta">beta</code></td>
<td>
<p>a numeric vector with the true estimated regression coefficients in the survival (latency) component.</p>
</td></tr>
<tr><td><code id="PHcure.object_+3A_cumhaz">cumhaz</code></td>
<td>
<p>a numeric vector with the estimated cumulative baseline hazard function at the unique event times (reported in the <code>"names"</code> attribute).</p>
</td></tr>
<tr><td><code id="PHcure.object_+3A_logl">logL</code></td>
<td>
<p>the value of the log-likelihood for the estimated model.</p>
</td></tr>
<tr><td><code id="PHcure.object_+3A_converged">converged</code></td>
<td>
<p>an integer to indicate if the Expectation-Maximization (EM) algorithm converged. The possible values are: <code>1</code> if it converged, <code>-1</code> if it exceeded the maximum number of iterations or <code>-2</code> if it stopped due to non-finite elements in the regression coefficients.</p>
</td></tr>
<tr><td><code id="PHcure.object_+3A_iter">iter</code></td>
<td>
<p>the maximum number of iteration before the convergence of the Expectation-Maximization (EM) algorithm.</p>
</td></tr>
<tr><td><code id="PHcure.object_+3A_n">N</code></td>
<td>
<p>the sample size (number of individuals).</p>
</td></tr>
<tr><td><code id="PHcure.object_+3A_k">K</code></td>
<td>
<p>the number of unique failure times.</p>
</td></tr>
<tr><td><code id="PHcure.object_+3A_isties">isTies</code></td>
<td>
<p>logical value: <code>TRUE</code> in case of tied event times.</p>
</td></tr>
<tr><td><code id="PHcure.object_+3A_censoring">censoring</code></td>
<td>
<p>the proportion of censored individuals.</p>
</td></tr>
<tr><td><code id="PHcure.object_+3A_which.x">which.X</code></td>
<td>
<p>character string indicating the method used to transform the covariates included in the incidence (cure) component from time-varying to time-invariant. See <code><a href="#topic+penPHcure">penPHcure</a></code> for more details.</p>
</td></tr>
<tr><td><code id="PHcure.object_+3A_survform">survform</code></td>
<td>
<p>a formula object with all variables involved in the latency (survival) component of the model.</p>
</td></tr>
<tr><td><code id="PHcure.object_+3A_cureform">cureform</code></td>
<td>
<p>a formula object with all variables involved in the incidence (survival) component of the model.</p>
</td></tr>
<tr><td><code id="PHcure.object_+3A_inference">inference</code></td>
<td>
<p>[optional] a list with elements named <code>bs</code>, <code>betas</code> and <code>nboot</code>. The elements <code>bs</code> and <code>betas</code> are matrices containing on each row the estimated regression coefficients in the incidence and latency components, respectively, for each of the <code>nboot</code> bootstrap resamples. This object is returned only if the function <code><a href="#topic+penPHcure">penPHcure</a></code> was called with the argument inference = TRUE.</p>
</td></tr>
<tr><td><code id="PHcure.object_+3A_call">call</code></td>
<td>
<p>object of class <code>call</code>, with all the specified arguments.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+penPHcure">penPHcure</a></code>
</p>

<hr>
<h2 id='predict.penPHcure'>Predict method for penPHcure.object</h2><span id='topic+predict.penPHcure'></span>

<h3>Description</h3>

<p>Compute probabilities to be susceptible and survival probabilities (conditional on being susceptible) for a model fitted by <code><a href="#topic+penPHcure">penPHcure</a></code> with the argument <code>pen.type = "SCAD" | "LASSO"</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'penPHcure'
predict(object, newdata, crit.type=c("BIC","AIC"), X = NULL,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict.penPHcure_+3A_object">object</code></td>
<td>
<p>an object of class <code><a href="#topic+PHcure.object">PHcure.object</a></code>.</p>
</td></tr>
<tr><td><code id="predict.penPHcure_+3A_newdata">newdata</code></td>
<td>
<p>a data.frame in counting process format.</p>
</td></tr>
<tr><td><code id="predict.penPHcure_+3A_crit.type">crit.type</code></td>
<td>
<p>a character string indicating the criterion used to select the tuning parameters, either <code>"AIC"</code> or <code>"BIC"</code>. By default <code>crit.type = "BIC"</code>.</p>
</td></tr>
<tr><td><code id="predict.penPHcure_+3A_x">X</code></td>
<td>
<p>[optional] a matrix of time-invariant covariates.</p>
</td></tr>
<tr><td><code id="predict.penPHcure_+3A_...">...</code></td>
<td>
<p>ellipsis to pass extra arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the model selected by means of the BIC criterion differs from the one selected by the AIC criterion, with the argument <code>crit.type</code> it is possible to specify which model to use for the calculation of the probabilities. 
</p>
<p>If argument <code>X</code> was not supplied in the call to the <code><a href="#topic+penPHcure">penPHcure</a></code> function, the probabilities to be susceptible are computed using the covariates retrieved using the same <code>which.X</code> method as in the <code><a href="#topic+penPHcure">penPHcure</a></code> function call.
</p>


<h3>Value</h3>

<p>An object of class <code>predict.penPHcure</code>, a list including the following elements:
</p>
<table role = "presentation">
<tr><td><code>CURE</code></td>
<td>
<p>a numeric vector containing the probabilities to be susceptible to the event of interest: </p>
<p style="text-align: center;"><code class="reqn">P(Y_i=1|x_i) = \frac{ e^{\mathbf{x}_i'\hat{\mathbf{b}}}   }{1+e^{\mathbf{x}_i'\hat{\mathbf{b}}}},</code>
</p>
<p> where <code class="reqn">\mathbf{x}_i</code> is a vector of time-invariant covariates and <code class="reqn">\hat{\mathbf{b}}</code> is a vector of estimated coefficients.</p>
</td></tr>
<tr><td><code>SURV</code></td>
<td>
<p>a numeric vector containing the survival probabilities (conditional on being susceptible to the event of interest): </p>
<p style="text-align: center;"><code class="reqn">S(t_i|Y_i=1,\bar{\mathbf{z}}_i(t))=\exp\left(-\sum_{j=1}^K (t_{(j-1)}-t_{(j)}) \hat{\lambda}_{0j} I(t_{(j)}\leq t_i) e^{\mathbf{z}_i(t_{(j)})\hat{\boldsymbol{\beta}}}\right),</code>
</p>
<p> where <code class="reqn">t_{(1)}&lt;t_{(2)}&lt;...&lt;t_{(K)}</code> denotes the <code class="reqn">K</code> ordered event-times, <code class="reqn">\mathbf{z}_i(t)</code> is a vector of time-varying covariates, <code class="reqn">\hat{\boldsymbol{\beta}}</code> is a vector of estimated coefficients and <code class="reqn">\hat{\lambda}_{0j}</code> is the estimated baseline hazard function (constant in the interval <code class="reqn">(t_{(j-1)},t_{(j)}]</code>). </p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
# Generate some data (for more details type ?penPHcure.simulate in your console)
set.seed(12) # For reproducibility
data &lt;- penPHcure.simulate(N=250)

### Tune penalized cure model with SCAD penalties
# First define the grid of possible values for the tuning parameters.
pen.tuneGrid &lt;- list(CURE = list(lambda = c(0.01,0.03,0.05,0.07,0.09),
                                 a = 3.7),
                     SURV = list(lambda = c(0.01,0.03,0.05,0.07,0.09),
                                 a = 3.7))
# Tune the penalty parameters.
tuneSCAD &lt;- penPHcure(Surv(time = tstart,time2 = tstop,
                           event = status) ~ z.1 + z.2 + z.3 + z.4,
                      cureform = ~ x.1 + x.2 + x.3 + x.4,
                      data = data,pen.type = "SCAD",
                      pen.tuneGrid = pen.tuneGrid,
                      print.details = FALSE)
                      
# Use the predict method to obtain the probabilities for the selected model.
#  By default, the model is the one selected on the basis of the BIC criterion.
pred.tuneSCAD.BIC &lt;- predict(tuneSCAD,data)
# Otherwise, to return the probabilities for the model selected on the basis 
#  of the AIC criterion, the user can set argument crit.type = "AIC": 
pred.tuneSCAD.AIC &lt;- predict(tuneSCAD,data,crit.type="AIC")

# Use the predict method to make prediction for new observations.
#  For example, two individuals censored at time 0.5 and 1.2, respectively,
#  and all cavariates equal to 1.
newdata &lt;- data.frame(tstart=c(0,0),tstop=c(0.5,1.2),status=c(0,0),
                      z.1=c(1,1),z.2=c(1,1),z.3=c(1,1),z.4=c(1,1),
                      x.1=c(1,1),x.2=c(1,1),x.3=c(1,1),x.4=c(1,1))
pred.tuneSCAD.newdata.BIC &lt;- predict(tuneSCAD,newdata)
pred.tuneSCAD.newdata.AIC &lt;- predict(tuneSCAD,newdata,crit.type="AIC")
# The probabilities to be susceptible for the BIC selected model are:
pred.tuneSCAD.newdata.BIC$CURE
# [1] 0.6456631 0.6456631
# The probabilities to be susceptible for the AIC selected model are:
pred.tuneSCAD.newdata.BIC$CURE
# [1] 0.6456631 0.6456631
# The survival probabilities (conditional on being susceptible) for the BIC 
#  selected model are:
pred.tuneSCAD.newdata.BIC$SURV
# [1] 0.5624514 0.1335912
# The survival probabilities (conditional on being susceptible) for the AIC 
#  selected model are:
pred.tuneSCAD.newdata.AIC$SURV
# [1] 0.5624514 0.1335912
</code></pre>

<hr>
<h2 id='predict.PHcure'>Predict method for PHcure.object</h2><span id='topic+predict.PHcure'></span>

<h3>Description</h3>

<p>Compute probabilities to be susceptible and survival probabilities (conditional on being susceptible) for a model fitted by <code><a href="#topic+penPHcure">penPHcure</a></code> with the argument <code>pen.type = "none"</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'PHcure'
predict(object, newdata, X = NULL,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict.PHcure_+3A_object">object</code></td>
<td>
<p>an object of class <code><a href="#topic+PHcure.object">PHcure.object</a></code>.</p>
</td></tr>
<tr><td><code id="predict.PHcure_+3A_newdata">newdata</code></td>
<td>
<p>a data.frame in counting process format.</p>
</td></tr>
<tr><td><code id="predict.PHcure_+3A_x">X</code></td>
<td>
<p>[optional] a matrix of time-invariant covariates. It is not required, unless argument <code>X</code> was supplied in the call to the <code><a href="#topic+penPHcure">penPHcure</a></code> function.</p>
</td></tr>
<tr><td><code id="predict.PHcure_+3A_...">...</code></td>
<td>
<p>ellipsis to pass extra arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If argument <code>X</code> was not supplied in the call to the <code><a href="#topic+penPHcure">penPHcure</a></code> function, the probabilities to be susceptible are computed using the covariates retrieved using the same <code>which.X</code> method as in the <code><a href="#topic+penPHcure">penPHcure</a></code> function call.
</p>


<h3>Value</h3>

<p>An object of class <code>predict.PHcure</code>, a list including the following elements:
</p>
<table role = "presentation">
<tr><td><code>CURE</code></td>
<td>
<p>a numeric vector containing the probabilities to be susceptible to the event of interest: </p>
<p style="text-align: center;"><code class="reqn">P(Y_i=1|x_i) = \frac{ e^{\mathbf{x}_i'\hat{\mathbf{b}}}   }{1+e^{\mathbf{x}_i'\hat{\mathbf{b}}}},</code>
</p>
<p> where <code class="reqn">\mathbf{x}_i</code> is a vector of time-invariant covariates and <code class="reqn">\hat{\mathbf{b}}</code> is a vector of estimated coefficients.</p>
</td></tr>
<tr><td><code>SURV</code></td>
<td>
<p>a numeric vector containing the survival probabilities (conditional on being susceptible to the event of interest): </p>
<p style="text-align: center;"><code class="reqn">S(t_i|Y_i=1,\bar{\mathbf{z}}_i(t))=\exp\left(-\sum_{j=1}^K (t_{(j-1)}-t_{(j)}) \hat{\lambda}_{0j} I(t_{(j)}\leq t_i) e^{\mathbf{z}_i(t_{(j)})\hat{\boldsymbol{\beta}}}\right),</code>
</p>
<p> where <code class="reqn">t_{(1)}&lt;t_{(2)}&lt;...&lt;t_{(K)}</code> denotes the <code class="reqn">K</code> ordered event-times, <code class="reqn">\mathbf{z}_i(t)</code> is a vector of time-varying covariates, <code class="reqn">\hat{\boldsymbol{\beta}}</code> is a vector of estimated coefficients and <code class="reqn">\hat{\lambda}_{0j}</code> is the estimated baseline hazard function (constant in the interval <code class="reqn">(t_{(j-1)},t_{(j)}]</code>). </p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># Generate some data (for more details type ?penPHcure.simulate in your console)
set.seed(12) # For reproducibility
data &lt;- penPHcure.simulate(N=250)
 
# Fit standard cure model (without inference)
fit &lt;- penPHcure(Surv(time = tstart,time2 = tstop,
                      event = status) ~ z.1 + z.2 + z.3 + z.4,
                 cureform = ~ x.1 + x.2 + x.3 + x.4,data = data)

# Use the predict method to obtain the probabilities for the fitted model
pred.fit &lt;- predict(fit,data)

# Use the predict method to make prediction for new observations.
#  For example, two individuals censored at time 0.5 and 1.2, respectively,
#  and all cavariates equal to 1.
newdata &lt;- data.frame(tstart=c(0,0),tstop=c(0.5,1.2),status=c(0,0),
                      z.1=c(1,1),z.2=c(1,1),z.3=c(1,1),z.4=c(1,1),
                      x.1=c(1,1),x.2=c(1,1),x.3=c(1,1),x.4=c(1,1))
pred.fit.newdata &lt;- predict(fit,newdata)
# The probabilities to be susceptible are:
pred.fit.newdata$CURE
# [1] 0.6761677 0.6761677
# The survival probabilities (conditional on being susceptible) are:
pred.fit.newdata$SURV
# [1] 0.5591570 0.1379086


</code></pre>

<hr>
<h2 id='summary.penPHcure'>Summary method for penPHcure.object</h2><span id='topic+summary.penPHcure'></span>

<h3>Description</h3>

<p>Produces a summary of a fitted penalized PH cure model, after selection of the tuning parameters, based on AIC or BIC criteria.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'penPHcure'
summary(object,crit.type=c("BIC","AIC"),...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.penPHcure_+3A_object">object</code></td>
<td>
<p>an object of class <code><a href="#topic+penPHcure.object">penPHcure.object</a></code>.</p>
</td></tr>
<tr><td><code id="summary.penPHcure_+3A_crit.type">crit.type</code></td>
<td>
<p>a character string indicating the criterion used to select the tuning parameters, either <code>"AIC"</code> or <code>"BIC"</code>. By default <code>crit.type = "BIC"</code>.</p>
</td></tr>
<tr><td><code id="summary.penPHcure_+3A_...">...</code></td>
<td>
<p>ellipsis to pass extra arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>summary.penPHcure</code>, a list including the following elements:
</p>
<table role = "presentation">
<tr><td><code>N</code></td>
<td>
<p>the sample size (number of individuals).</p>
</td></tr>
<tr><td><code>censoring</code></td>
<td>
<p>the proportion of censored individuals.</p>
</td></tr>
<tr><td><code>K</code></td>
<td>
<p>the number of unique failure times.</p>
</td></tr>
<tr><td><code>isTies</code></td>
<td>
<p>logical value: <code>TRUE</code> in case of tied event times.</p>
</td></tr>
<tr><td><code>pen.type</code></td>
<td>
<p>a character string indicating the type of penalty used, either <code>"SCAD"</code> or <code>"LASSO"</code>.</p>
</td></tr>
<tr><td><code>crit.type</code></td>
<td>
<p>a character string indicating the criterion used to select tuning parameters, either <code>"AIC"</code> or <code>"BIC"</code>. By default <code>crit.type = "BIC"</code>.</p>
</td></tr>
<tr><td><code>tune_params</code></td>
<td>
<p>a list with elements named <code>CURE</code> and <code>SURV</code> containing the selected tuning parameters, which minimize the AIC/BIC criterion.</p>
</td></tr>
<tr><td><code>crit</code></td>
<td>
<p>value of the minimized AIC/BIC criterion.</p>
</td></tr>
<tr><td><code>CURE</code></td>
<td>
<p>a matrix where in the first column the estimated regression coefficients in the cure (incidence) component are provided. If the argument <code>inference</code> (in the <code><a href="#topic+penPHcure">penPHcure</a></code> function) was set equal to <code>TRUE</code>, two additional columns for the confidence intervals are provided.</p>
</td></tr>
<tr><td><code>SURV</code></td>
<td>
<p>a matrix where in the first column the estimated regression coefficients in the survival (latency) component are provided. If the argument <code>inference</code> (in the <code><a href="#topic+penPHcure">penPHcure</a></code> function) was set equal to <code>TRUE</code>, two additional columns for the confidence intervals are provided.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># Generate some data (for more details type ?penPHcure.simulate in your console)
set.seed(12) # For reproducibility
data &lt;- penPHcure.simulate(N=250)

### Tune penalized cure model with SCAD penalties
# First define the grid of possible values for the tuning parameters.
pen.tuneGrid &lt;- list(CURE = list(lambda = c(0.01,0.03,0.05,0.07,0.09),
                                 a = 3.7),
                     SURV = list(lambda = c(0.01,0.03,0.05,0.07,0.09),
                                 a = 3.7))
# Tune the penalty parameters.
tuneSCAD &lt;- penPHcure(Surv(time = tstart,time2 = tstop,
                           event = status) ~ z.1 + z.2 + z.3 + z.4,
                      cureform = ~ x.1 + x.2 + x.3 + x.4,
                      data = data,pen.type = "SCAD",
                      pen.tuneGrid = pen.tuneGrid,
                      print.details = FALSE)
# Use the summary method to see the results
summary(tuneSCAD)
# 
# ------------------------------------------------------
# +++   PH cure model with time-varying covariates   +++
# +++             [ Variable selection ]             +++
# ------------------------------------------------------
# Sample size:  250
# Censoring proportion:  0.5
# Number of unique event times: 125
# Tied failure times:  FALSE
# Penalty type:  SCAD
# Selection criterion:  BIC
# 
# ------------------------------------------------------
# +++               Tuning parameters                +++
# ------------------------------------------------------
#  Cure (incidence) --- lambda:  0.07 
#                            a:  3.7 
# 
#  Survival (latency) - lambda:  0.07 
#                            a:  3.7 
# 
#  BIC =  -118.9359 
# 
# ------------------------------------------------------
# +++                Cure (incidence)                +++
# +++     [ Coefficients of selected covariates ]    +++
# ------------------------------------------------------
#              Estimate
# (Intercept)  0.872374
# x.1         -0.958260
# x.3          0.685916
# 
# ------------------------------------------------------
# +++              Survival (latency)                +++
# +++     [ Coefficients of selected covariates ]    +++
# ------------------------------------------------------
#      Estimate
# z.1  0.991754
# z.3 -1.008180

# By default, the summary method for the penPHcure.object returns the selected 
#  variables based on the BIC criterion. For AIC, the user can set the 
#  argument crit.type equal to "AIC". 
summary(tuneSCAD,crit.type = "AIC")
# 
# ------------------------------------------------------
# +++   PH cure model with time-varying covariates   +++
# +++             [ Variable selection ]             +++
# ------------------------------------------------------
# Sample size:  250
# Censoring proportion:  0.5
# Number of unique event times: 125
# Tied failure times:  FALSE
# Penalty type:  SCAD
# Selection criterion:  AIC
# 
# ------------------------------------------------------
# +++               Tuning parameters                +++
# ------------------------------------------------------
#  Cure (incidence) --- lambda:  0.07 
#                            a:  3.7 
# 
#  Survival (latency) - lambda:  0.07 
#                            a:  3.7 
# 
#  AIC =  -136.5432 
# 
# ------------------------------------------------------
# +++                Cure (incidence)                +++
# +++     [ Coefficients of selected covariates ]    +++
# ------------------------------------------------------
#              Estimate
# (Intercept)  0.872374
# x.1         -0.958260
# x.3          0.685916
# 
# ------------------------------------------------------
# +++              Survival (latency)                +++
# +++     [ Coefficients of selected covariates ]    +++
# ------------------------------------------------------
#      Estimate
# z.1  0.991754
# z.3 -1.008180

</code></pre>

<hr>
<h2 id='summary.PHcure'>Summary method for PHcure.object</h2><span id='topic+summary.PHcure'></span>

<h3>Description</h3>

<p>Produces a summary of a fitted PH cure model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'PHcure'
summary(object, conf.int = c("basic","percentile"), conf.int.level = 0.95,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.PHcure_+3A_object">object</code></td>
<td>
<p>an object of class <code><a href="#topic+PHcure.object">PHcure.object</a></code>.</p>
</td></tr>
<tr><td><code id="summary.PHcure_+3A_conf.int">conf.int</code></td>
<td>
<p>a character string indicating the method to compute bootstrapped confidence intervals: <code>"percentile"</code> or <code>"basic"</code>. By default <code>conf.int = "basic"</code>.</p>
</td></tr>
<tr><td><code id="summary.PHcure_+3A_conf.int.level">conf.int.level</code></td>
<td>
<p>confidence level. By default <code>conf.int.level = 0.95</code>.</p>
</td></tr>
<tr><td><code id="summary.PHcure_+3A_...">...</code></td>
<td>
<p>ellipsis to pass extra arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>summary.PHcure</code>, a list including the following elements:
</p>
<table role = "presentation">
<tr><td><code>N</code></td>
<td>
<p>the sample size (number of individuals).</p>
</td></tr>
<tr><td><code>censoring</code></td>
<td>
<p>the proportion of censored individuals.</p>
</td></tr>
<tr><td><code>K</code></td>
<td>
<p>the number of unique failure times.</p>
</td></tr>
<tr><td><code>isTies</code></td>
<td>
<p>a logical value, equal to <code>TRUE</code> in case of tied event times.</p>
</td></tr>
<tr><td><code>conf.int</code></td>
<td>
<p>a character string indicating the method used to compute the bootstrapped confidence intervals: <code>"percentile"</code>, <code>"basic"</code> or <code>"no"</code>. The latter is returned when the <code><a href="#topic+penPHcure">penPHcure</a></code> function was called with the argument <code>inference = FALSE</code>.</p>
</td></tr>
<tr><td><code>conf.int.level</code></td>
<td>
<p>confidence level used to compute the bootstrapped confidence intervals.</p>
</td></tr>
<tr><td><code>nboot</code></td>
<td>
<p>the number of bootstrap resamples for the construction of the confidence intervals.</p>
</td></tr>
<tr><td><code>logL</code></td>
<td>
<p>the value of the log-likelihood for the estimated model.</p>
</td></tr>
<tr><td><code>CURE</code></td>
<td>
<p>a matrix with one column containing the estimated regression coefficients in the incidence (cure) component. In case the function <code><a href="#topic+penPHcure">penPHcure</a></code> was called with the argument <code>inference = TRUE</code>, two additional columns for the confidence intervals are provided.</p>
</td></tr>
<tr><td><code>SURV</code></td>
<td>
<p>a matrix where in the first column the estimated regression coefficients in the latency (survival) component. In case the function <code><a href="#topic+penPHcure">penPHcure</a></code> was called with the argument <code>inference = TRUE</code>, two additional columns for the confidence intervals are provided.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># For reproducibility
set.seed(12) 
# If you use R v3.6 or greater, uncomment the following line
# RNGkind(sample.kind="Rounding") 

# Generate some data (for more details type ?penPHcure.simulate in your console)
data &lt;- penPHcure.simulate(N=250)
 
# Fit standard cure model (without inference)
fit &lt;- penPHcure(Surv(time = tstart,time2 = tstop,
                      event = status) ~ z.1 + z.2 + z.3 + z.4,
                 cureform = ~ x.1 + x.2 + x.3 + x.4,data = data)

# Use the summary method to see the results
summary(fit)
#
# ------------------------------------------------------
# +++   PH cure model with time-varying covariates   +++
# ------------------------------------------------------
# Sample size: 250
# Censoring proportion: 0.5
# Number of unique event times: 125
# Tied failure times: FALSE
# 
# log-likelihood:  74.11 
# 
# ------------------------------------------------------
# +++         Cure (incidence) coefficients          +++
# ------------------------------------------------------
#              Estimate
# (Intercept)  0.889668
# x.1         -0.972653
# x.2         -0.051580
# x.3          0.714611
# x.4          0.156169
# 
# ------------------------------------------------------
# +++         Survival (latency) coefficients         +++
# ------------------------------------------------------
#      Estimate
# z.1  0.996444
# z.2 -0.048792
# z.3 -1.013562
# z.4  0.079422

# Fit standard cure model (with inference). nboot = 30 bootstrap resamples
#  are used to compute the confidence intervals.  
fit2 &lt;- penPHcure(Surv(time = tstart,time2 = tstop,
                       event = status) ~ z.1 + z.2 + z.3 + z.4,
                  cureform = ~ x.1 + x.2 + x.3 + x.4,data = data,
                  inference = TRUE,print.details = FALSE,nboot = 30)
# Use the summary method to see the results
summary(fit2)
#
# ------------------------------------------------------
# +++   PH cure model with time-varying covariates   +++
# ------------------------------------------------------
# Sample size: 250
# Censoring proportion: 0.5
# Number of unique event times: 125
# Tied failure times: FALSE
# 
# log-likelihood:  74.11 
# 
# ------------------------------------------------------
# +++     Cure (incidence) coefficient estimates     +++
# +++          and 95% confidence intervals *        +++
# ------------------------------------------------------
#              Estimate      2.5%     97.5%
# (Intercept)  0.889668  0.455975  1.092495
# x.1         -0.972653 -1.414194 -0.503824
# x.2         -0.051580 -0.557843  0.304632
# x.3          0.714611  0.206211  1.081819
# x.4          0.156169 -0.011555  0.464841
# 
# ------------------------------------------------------
# +++    Survival (latency) coefficient estimates    +++
# +++          and 95% confidence intervals *        +++
# ------------------------------------------------------
#      Estimate      2.5%     97.5%
# z.1  0.996444  0.750321  1.130650
# z.2 -0.048792 -0.204435  0.073196
# z.3 -1.013562 -1.127882 -0.780339
# z.4  0.079422 -0.100677  0.193522
# 
# ------------------------------------------------------
# * Confidence intervals computed by the basic 
#   bootstrap method, with 30 replications.
# ------------------------------------------------------

# By default, confidence intervals are computed by the basic bootstrap method.
#  Otherwise, the user can specify the percentile bootstrap method.
summary(fit2,conf.int = "percentile")
#
# ------------------------------------------------------
# +++   PH cure model with time-varying covariates   +++
# ------------------------------------------------------
# Sample size: 250
# Censoring proportion: 0.5
# Number of unique event times: 125
# Tied failure times: FALSE
# 
# log-likelihood:  74.11 
# 
# ------------------------------------------------------
# +++     Cure (incidence) coefficient estimates     +++
# +++          and 95% confidence intervals *        +++
# ------------------------------------------------------
#              Estimate      2.5%     97.5%
# (Intercept)  0.889668  0.686842  1.323362
# x.1         -0.972653 -1.441483 -0.531112
# x.2         -0.051580 -0.407791  0.454684
# x.3          0.714611  0.347404  1.223011
# x.4          0.156169 -0.152503  0.323893
# 
# ------------------------------------------------------
# +++    Survival (latency) coefficient estimates    +++
# +++          and 95% confidence intervals *        +++
# ------------------------------------------------------
#      Estimate      2.5%     97.5%
# z.1  0.996444  0.862238  1.242567
# z.2 -0.048792 -0.170779  0.106852
# z.3 -1.013562 -1.246785 -0.899242
# z.4  0.079422 -0.034678  0.259521
# 
# ------------------------------------------------------
# * Confidence intervals computed by the percentile 
#   bootstrap method, with 30 replications.
# ------------------------------------------------------

# By default, a 95% confidence level is used. Otherwise, the user can specify 
#  another confidence level: e.g. 90%.
summary(fit2,conf.int.level = 0.90)
# 
# ------------------------------------------------------
# +++   PH cure model with time-varying covariates   +++
# ------------------------------------------------------
# Sample size: 250
# Censoring proportion: 0.5
# Number of unique event times: 125
# Tied failure times: FALSE
# 
# log-likelihood:  74.11 
# 
# ------------------------------------------------------
# +++     Cure (incidence) coefficient estimates     +++
# +++          and 90% confidence intervals *        +++
# ------------------------------------------------------
#              Estimate        5%       95%
# (Intercept)  0.889668  0.467864  1.074423
# x.1         -0.972653 -1.397088 -0.618265
# x.2         -0.051580 -0.527389  0.249460
# x.3          0.714611  0.314140  1.028425
# x.4          0.156169  0.033802  0.436361
# 
# ------------------------------------------------------
# +++    Survival (latency) coefficient estimates    +++
# +++          and 90% confidence intervals *        +++
# ------------------------------------------------------
#      Estimate        5%       95%
# z.1  0.996444  0.767937  1.125745
# z.2 -0.048792 -0.158821  0.050965
# z.3 -1.013562 -1.120989 -0.800606
# z.4  0.079422 -0.086063  0.180392
# 
# ------------------------------------------------------
# * Confidence intervals computed by the basic 
#   bootstrap method, with 30 replications.
# ------------------------------------------------------

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
