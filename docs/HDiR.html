<!DOCTYPE html><html lang="en"><head><title>Help for package HDiR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {HDiR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#cells10'>
<p>Indices of mesh cells for spherical numerical integration</p></a></li>
<li><a href='#cells20'>
<p>Indices of mesh cells for spherical numerical integration</p></a></li>
<li><a href='#cells40'>
<p>Indices of mesh cells for spherical numerical integration</p></a></li>
<li><a href='#circ.boot.bw'><p>Circular smoothing parameter for HDRs estimation</p></a></li>
<li><a href='#circ.boot.sample'>
<p>Bootstrap samples from a circular kernel estimator</p></a></li>
<li><a href='#circ.distances'><p>Euclidean and Hausdorff distances between two sets of points on the unit circle</p></a></li>
<li><a href='#circ.hdr'><p>Computation of HDRs for a circular density and of general level sets for circular real-valued functions</p></a></li>
<li><a href='#circ.plugin.hdr'><p>Circular plug-in estimation of HDRs and confidence regions</p></a></li>
<li><a href='#circ.scatterplot'><p>Circular scatterplot for plug-in HDRs</p></a></li>
<li><a href='#dspheremix'><p>Density functions for mixtures of spherical von Mises-Fisher</p></a></li>
<li><a href='#earthquakes'>
<p>Earthquakes on Earth between October 2004 and April 2020</p></a></li>
<li><a href='#find.circ.hdr'>
<p>Calculation of the boundaries of HDRs in the circular setting</p></a></li>
<li><a href='#is.wholenumber'>
<p>Checking if a value is integer</p></a></li>
<li><a href='#points10'>
<p>Coordinates of mesh vertices for spherical numerical integration</p></a></li>
<li><a href='#points20'>
<p>Coordinates of mesh vertices for spherical numerical integration</p></a></li>
<li><a href='#points40'>
<p>Coordinates of mesh vertices for spherical numerical integration</p></a></li>
<li><a href='#rspheremix'>
<p>Random generation functions for mixtures of spherical von Mises-Fisher</p></a></li>
<li><a href='#runif_on_sphere'>
<p>Random generation of a sample on a d-dimensional sphere of radius r</p></a></li>
<li><a href='#sandhoppers'>
<p>Behavioral plasticity of Talitrus saltator and Talorchestia brito</p></a></li>
<li><a href='#sphere.boot.bw'>
<p>Spherical smoothing parameter for HDRs estimation</p></a></li>
<li><a href='#sphere.boot.sample'>
<p>Bootstrap samples from a spherical kernel estimator</p></a></li>
<li><a href='#sphere.distances'>
<p>Euclidean and Hausdorff distances between two sets of points on the unit sphere</p></a></li>
<li><a href='#sphere.hdr'>
<p>Computation of HDRs for a spherical density and of general level sets for spherical real-valued functions</p></a></li>
<li><a href='#sphere.integration'>
<p>Numerical integration on the unit sphere</p></a></li>
<li><a href='#sphere.plugin.hdr'>
<p>Spherical plug-in estimation of HDRs</p></a></li>
<li><a href='#sphere.scatterplot'>
<p>Spherical scatterplot for plug-in HDRs</p></a></li>
<li><a href='#trapezoidal.rule'>
<p>Trapezoidal rule for numerical integration over a threshold</p></a></li>
<li><a href='#vmf.kerncontour2'>
<p>Von Mises-Fisher kernel density estimator with numerical smoothing parameter</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Directional Highest Density Regions</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.3</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Paula Saavedra-Nieves &lt;paula.saavedra@usc.es&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>We provide an R tool for computation and nonparametric plug-in estimation of Highest Density Regions (HDRs) and general level sets in the directional setting. Concretely, circular and spherical HDRs can be reconstructed from a data sample following Saavedra-Nieves and Crujeiras (2021) &lt;<a href="https://doi.org/10.1007%2Fs11634-021-00457-4">doi:10.1007/s11634-021-00457-4</a>&gt;. This library also contains two real datasets in the circular and spherical settings. The first one concerns a problem from animal orientation studies and the second one is related to earthquakes occurrences.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R(&ge; 3.5.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>ggplot2, maps, mapproj, DirStats</td>
</tr>
<tr>
<td>Imports:</td>
<td>NPCirc, circular, rgl, Directional, movMF, graphics, stats,
grDevices</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-11-16 11:06:25 UTC; Paula Saavedra</td>
</tr>
<tr>
<td>Author:</td>
<td>Paula Saavedra-Nieves [aut, cre],
  Rosa M Crujeiras [aut],
  Andrés Prieto [ctb],
  Felicita Scapini [dtc]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-11-16 13:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='cells10'>
Indices of mesh cells for spherical numerical integration
</h2><span id='topic+cells10'></span>

<h3>Description</h3>

<p>Indices of mesh cells for spherical numerical integration.
</p>


<h3>Format</h3>

<p>A data frame with 2000 rows where each one corresponds to the indices (rows) in the data set <code>points10</code> that characterizes a cell.
</p>

<dl>
<dt><code>V1</code></dt><dd><p>Index of the first cell vertex.</p>
</dd>
<dt><code>V2</code></dt><dd><p>Index of the second cell vertex.</p>
</dd>
<dt><code>V3</code></dt><dd><p>Index of the third cell vertex.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(cells10)
## maybe str(cells10) ; plot(cells10) ...
</code></pre>

<hr>
<h2 id='cells20'>
Indices of mesh cells for spherical numerical integration
</h2><span id='topic+cells20'></span>

<h3>Description</h3>

<p>Indices of mesh cells for spherical numerical integration.
</p>


<h3>Format</h3>

<p>A data frame with 8000 rows where each one corresponds to the indices (rows) in the data set <code>points20</code> that characterizes a cell.
</p>

<dl>
<dt><code>V1</code></dt><dd><p>Index of the first cell vertex.</p>
</dd>
<dt><code>V2</code></dt><dd><p>Index of the second cell vertex.</p>
</dd>
<dt><code>V3</code></dt><dd><p>Index of the third cell vertex.</p>
</dd>
</dl>


<hr>
<h2 id='cells40'>
Indices of mesh cells for spherical numerical integration
</h2><span id='topic+cells40'></span>

<h3>Description</h3>

<p>Indices of mesh cells for spherical numerical integration.
</p>


<h3>Format</h3>

<p>A data frame with 32000 rows where each one corresponds to the indices (rows) in the data set <code>points40</code> that characterizes a cell.
</p>

<dl>
<dt><code>V1</code></dt><dd><p>Index of the first cell vertex.</p>
</dd>
<dt><code>V2</code></dt><dd><p>Index of the second cell vertex.</p>
</dd>
<dt><code>V3</code></dt><dd><p>Index of the third cell vertex.</p>
</dd>
</dl>


<hr>
<h2 id='circ.boot.bw'>Circular smoothing parameter for HDRs estimation</h2><span id='topic+circ.boot.bw'></span>

<h3>Description</h3>

<p>This function provides the specific smoothing parameter for circular HDRs estimation proposed in Saavedra-Nieves and Crujeiras (2021).</p>


<h3>Usage</h3>

<pre><code class='language-R'>circ.boot.bw(sample, bw = bw.CV(circular(sample),
upper=100), tau = 0.5, B = 50, upper = 1.5 * bw)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="circ.boot.bw_+3A_sample">sample</code></td>
<td>
<p>Numeric vector of angles in radians.</p>
</td></tr>
<tr><td><code id="circ.boot.bw_+3A_bw">bw</code></td>
<td>
<p>Pilot soothing parameter to be used. Following Oliveira et al. (2014), the value of the smoothing parameter can be chosen by using the functions <code>bw.rt</code>, <code>bw.CV</code>, <code>bw.pi</code> or <code>bw.boot</code>. Default <code>bw=bw.CV</code> providing a cross-validation bandwidth.</p>
</td></tr>
<tr><td><code id="circ.boot.bw_+3A_tau">tau</code></td>
<td>
<p>Numeric probability. According to Saavedra-Nieves and Crujeiras (2021), <code>1-tau</code> represents the probability coverage required for HDR. Default <code>tau=0.5</code>.</p>
</td></tr>
<tr><td><code id="circ.boot.bw_+3A_b">B</code></td>
<td>
<p>Integer value indicating the number of bootstrap resamples. Default <code>B=50</code>.</p>
</td></tr>
<tr><td><code id="circ.boot.bw_+3A_upper">upper</code></td>
<td>
<p>Numerical upper value for bounding the optimization procedure. Default <code> 1.5bw</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Saavedra-Nieves and Crujeiras (2021) propose a specific smoothing parameter for HDRs estimation based on the minimization of the Hausdorff distance between the boundaries of the theoretical HDR and the plug-in estimator.</p>


<h3>Value</h3>

<p>A numeric value corresponding to the selected smoothing parameter.</p>


<h3>Author(s)</h3>

<p>Paula Saavedra-Nieves and Rosa M. Crujeiras.</p>


<h3>References</h3>

<p>Saavedra-Nieves, P. and Crujeiras, R. M.  (2021). Nonparametric estimation of directional highest density regions. Advances in Data Analysis and Classification, 1-36.</p>


<h3>Examples</h3>

<pre><code class='language-R'># HDR selector from a sample of size 500 of model 5 in NPCirc
library(NPCirc)
set.seed(1)
sample&lt;- rcircmix(500, model=5)
circ.boot.bw(sample,tau=0.4,B=2)
</code></pre>

<hr>
<h2 id='circ.boot.sample'>
Bootstrap samples from a circular kernel estimator
</h2><span id='topic+circ.boot.sample'></span>

<h3>Description</h3>

<p>This function generates bootstrap samples from a circular kernel estimator.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>circ.boot.sample(sample, n, bw)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="circ.boot.sample_+3A_sample">sample</code></td>
<td>

<p>Numeric vector containing the sample of angles in radians determining a set of points on the unit circle.
</p>
</td></tr>
<tr><td><code id="circ.boot.sample_+3A_n">n</code></td>
<td>

<p>Sample size to be generated.</p>
</td></tr>
<tr><td><code id="circ.boot.sample_+3A_bw">bw</code></td>
<td>

<p>Bandwidth parameter.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector containing a bootstrap sample of angles in radians of size <code>n</code>.
</p>


<h3>Author(s)</h3>

<p>Paula Saavedra-Nieves and Rosa M. Crujeiras.
</p>

<hr>
<h2 id='circ.distances'>Euclidean and Hausdorff distances between two sets of points on the unit circle</h2><span id='topic+circ.distances'></span>

<h3>Description</h3>

<p>This function determines the Euclidean and Hausdorff distances between two sets of points on the unit circle.</p>


<h3>Usage</h3>

<pre><code class='language-R'>circ.distances(x, y)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="circ.distances_+3A_x">x</code></td>
<td>
<p>Numeric vector of angles in radians determining a set of points on the unit circle.</p>
</td></tr>
<tr><td><code id="circ.distances_+3A_y">y</code></td>
<td>
<p>Numeric vector of angles in radians determining a set of points on the unit circle.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>x</code> and <code>y</code> corresponds to two HDRs boundaries, this function returns the Euclidean and Hausdorff distances between the HDRs frontiers, but the function computes the Euclidean and Hausdorff distance for two sets of points on the circle, no matter their nature. See Saavedra-Nieves and Crujeiras (2021) for more details on these two distances.</p>


<h3>Value</h3>

<p>A list with two components:
</p>
<table role = "presentation">
<tr><td><code>dE</code></td>
<td>
<p>Euclidean distance.</p>
</td></tr>
<tr><td><code>dH</code></td>
<td>
<p>Hausdorff distance.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Paula Saavedra-Nieves and Rosa M. Crujeiras.</p>


<h3>References</h3>

<p>Saavedra-Nieves, P. and Crujeiras, R. M. (2021). Nonparametric estimation of directional highest density regions. Advances in Data Analysis and Classification, 1-36.</p>


<h3>Examples</h3>

<pre><code class='language-R'># Distances between boundaries of two plug-in HDR estimators for orientations of saltator specie
data(sandhoppers)
attach(sandhoppers)
#Orientations in October
saltatorO&lt;-angle[(species=="salt")&amp;(time=="afternoon")&amp;(sex=="M")&amp;(month=="October")]
hdr1&lt;-circ.plugin.hdr(sample=saltatorO,tau=0.8,plot.hdrconf=FALSE)$hdr
#Orientations in April
saltatorA&lt;-angle[(species=="salt")&amp;(time=="afternoon")&amp;(sex=="M")&amp;(month=="April")]
hdr2&lt;-circ.plugin.hdr(sample=saltatorA,tau=0.8,plot.hdrconf=FALSE)$hdr
circ.distances(hdr1,hdr2)
</code></pre>

<hr>
<h2 id='circ.hdr'>Computation of HDRs for a circular density and of general level sets for circular real-valued functions</h2><span id='topic+circ.hdr'></span>

<h3>Description</h3>

<p>This function computes HDRs for a circular density and general level sets for real-valued functions defined on the unit circle.</p>


<h3>Usage</h3>

<pre><code class='language-R'>circ.hdr(f,tau=NULL,level=NULL,plot.hdr=TRUE,col=NULL,
         lty=NULL,shrink=NULL,cex=NULL,pch=NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="circ.hdr_+3A_f">f</code></td>
<td>
<p>Object of class <code>"function"</code> that represents a circular density function or any general real-valued function defined on the unit circle. Vector parametrisation of function <code>f</code> on a vector of angles with values between 0 and <code class="reqn">2\pi</code> must be established. Additionally, if <code>f</code> is not a density function, the argument <code>tau</code> cannot be specified and only the value of <code>level</code> must be provided by the user. </p>
</td></tr>
<tr><td><code id="circ.hdr_+3A_tau">tau</code></td>
<td>
<p>Numeric probability. According to Saavedra-Nieves and Crujeiras (2021), <code>1-tau</code> represents the probability coverage required for HDR. If <code>tau=NULL</code>, a value for the threshold <code>level</code> must be provided.</p>
</td></tr>
<tr><td><code id="circ.hdr_+3A_level">level</code></td>
<td>
<p>Numeric threshold of the HDR or of the general level set provided by the user. If <code>level</code> is larger than the maximum value of the function f, the HDR or the level set are equal to the emptyset. If <code>level</code> is smaller than the minimum of f, its support is obtained. If <code>level=NULL</code>, f must be a density function and a value for the probability coverage <code>1-tau</code> of the HDR must be provided.</p>
</td></tr>
<tr><td><code id="circ.hdr_+3A_plot.hdr">plot.hdr</code></td>
<td>
<p>Logical string. If <code>TRUE</code>, the circular density and the level set or the HDR are represented graphically. Default <code>plot.density=TRUE</code>.</p>
</td></tr>
<tr><td><code id="circ.hdr_+3A_col">col</code></td>
<td>
<p>Color for plotting the HDR. Default <code>col="darkgray"</code> is used.</p>
</td></tr>
<tr><td><code id="circ.hdr_+3A_lty">lty</code></td>
<td>
<p>A numeric value indicating the line type to represent the threshold of HDR. Line type can be specified as an integer (0=blank, 1=solid (default), 2=dashed, 3=dotted, 4=dotdash, 5=longdash, 6=twodash). Default <code>lty=2</code>.</p>
</td></tr>
<tr><td><code id="circ.hdr_+3A_shrink">shrink</code></td>
<td>
<p>Parameter that controls the size of the plotted circle. Default is 2. Larger than 1 values shrink the circle, while smaller values enlarge the circle.</p>
</td></tr>
<tr><td><code id="circ.hdr_+3A_cex">cex</code></td>
<td>
<p>Point character size for representing the data on the scatterplot. Default is 0.5.</p>
</td></tr>
<tr><td><code id="circ.hdr_+3A_pch">pch</code></td>
<td>
<p>Plotting character. Default <code>19</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A detailed definition of HDRs for circular and spherical densities is given in Saavedra-Nieves and Crujeiras (2021). Trapezoidal rule is used to compute the threshold of HDR when <code>tau</code> is provided.</p>


<h3>Value</h3>

<p>If <code>tau</code> is provided, a list with the next components:
</p>
<table role = "presentation">
<tr><td><code>hdr</code></td>
<td>
<p>Boundaries of the HDR.</p>
</td></tr>
<tr><td><code>prob.content</code></td>
<td>
<p>Probability coverage <code>1-tau</code>.</p>
</td></tr>
<tr><td><code>level</code></td>
<td>
<p>Threshold of the HDR associated to the probability content <code>1-tau</code>.</p>
</td></tr>
</table>
<p>If <code>level</code> is provided, a list with the next components:
</p>
<table role = "presentation">
<tr><td><code>levelset</code></td>
<td>
<p>Boundaries of the level set or a character indicating if the level set is equal to the emptyset or the support distribution.</p>
</td></tr>
<tr><td><code>level</code></td>
<td>
<p>Threshold of the level set.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Paula Saavedra-Nieves and Rosa M. Crujeiras.
</p>


<h3>References</h3>

<p>Saavedra-Nieves, P. and Crujeiras, R. M.  (2021). Nonparametric estimation of directional highest density regions. Advances in Data Analysis and Classification, 1-36.</p>


<h3>Examples</h3>

<pre><code class='language-R'># HDRs of model 11 in library NPCirc
library(NPCirc)
f1&lt;-function(x){return(dcircmix(x,11))}
circ.hdr(f1,tau=0.2,shrink=1.5)
circ.hdr(f1,tau=0.8,shrink=1.5)

# Plug-in level set estimation for regression
# with circular (x) - linear (y) data by using
# the Nadaraya-Watson estimator
f2&lt;-function(t){
  set.seed(1012)
  n &lt;- 100
  x &lt;- runif(n, 0, 2*pi)
  y &lt;- sin(x)+0.5*rnorm(n)
  return(kern.reg.circ.lin(circular(x),y,t,bw=10,method="NW")$y)
}
circ.hdr(f2,level=.5,plot.hdr=FALSE)

</code></pre>

<hr>
<h2 id='circ.plugin.hdr'>Circular plug-in estimation of HDRs and confidence regions
</h2><span id='topic+circ.plugin.hdr'></span>

<h3>Description</h3>

<p>This function computes the circular plug-in estimator of HDRs and confidence regions in Saavedra-Nieves and Crujeiras (2021).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>circ.plugin.hdr(sample,bw=bw.CV(circular(sample),upper=100),tau=NULL,
                tau.method="quantile",level=NULL,conf=.95,plot.hdr=TRUE,
                plot.hdrconf=TRUE,boot=FALSE,k=3,col=NULL,lty=NULL,shrink=NULL,
                lwd=NULL,pch=NULL,cex=NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="circ.plugin.hdr_+3A_sample">sample</code></td>
<td>
<p>Numeric vector of angles in radians.</p>
</td></tr>
<tr><td><code id="circ.plugin.hdr_+3A_bw">bw</code></td>
<td>
<p>Smoothing parameter to be used. It can be a numeric value directly selected by the user. Following Oliveira et al. (2014), the value of the smoothing parameter could be also chosen by using the functions <code>bw.rt</code>, <code>bw.CV</code>, <code>bw.pi</code> or <code>bw.boot</code>. Moreover, function <code>circ.boot.bw</code> allows to select the new smoothing parameter proposed in Saavedra-Nieves and Crujeiras (2021). Default <code>bw=bw.CV</code> providing a cross-validation bandwidth.</p>
</td></tr>
<tr><td><code id="circ.plugin.hdr_+3A_tau">tau</code></td>
<td>
<p>Numeric probability. According to Saavedra-Nieves and Crujeiras (2021), <code>1-tau</code> represents the probability coverage required for HDR. If <code>tau=NULL</code>, a value for the threshold <code>level</code> of the HDR must be provided.</p>
</td></tr>
<tr><td><code id="circ.plugin.hdr_+3A_tau.method">tau.method</code></td>
<td>
<p>Character value selecting the rule to estimate the threshold of the HDR. This must be one of <code>"quantile"</code> or <code>"trapezoidal"</code>. The first option estimates the threshold using the quantile method proposed in Hyndman(1996); the second one, using the trapezoidal rule for numerical integration. Default <code>tau.method=</code> <code>"quantile"</code>.</p>
</td></tr>
<tr><td><code id="circ.plugin.hdr_+3A_level">level</code></td>
<td>
<p>Numeric threshold of the HDR provided by the user. When <code>level</code> is larger than the maximum value of the density, the HDR is equal to the emptyset. If <code>level</code> is smaller than the minimum of the density, the HDR coincides with the support distribution. If <code>level=NULL</code>, a value for the probability coverage <code>1-tau</code> of the HDR must be provided.</p>
</td></tr>
<tr><td><code id="circ.plugin.hdr_+3A_conf">conf</code></td>
<td>
<p>Numeric value between 0 and 1 corresponding to the confidence for limits on HDR. Default <code>conf=0.95</code>.</p>
</td></tr>
<tr><td><code id="circ.plugin.hdr_+3A_plot.hdr">plot.hdr</code></td>
<td>
<p>Logical string. If <code>TRUE</code>, the level set or the HDR are depicted. Default <code>plot.hdr=TRUE</code>. </p>
</td></tr>
<tr><td><code id="circ.plugin.hdr_+3A_plot.hdrconf">plot.hdrconf</code></td>
<td>
<p>Logical string. If <code>TRUE</code>, the confidence region for the estimated HDR is added to the HDR graphical representation. Default <code>plot.hdr=TRUE</code>. </p>
</td></tr>
<tr><td><code id="circ.plugin.hdr_+3A_boot">boot</code></td>
<td>
<p>Logical string. If <code>TRUE</code>, confidence regions are not computed. This option is only used for function <code>circ.boot.bw</code> in order to reduce the execution time. Default <code>boot=FALSE</code>. </p>
</td></tr>
<tr><td><code id="circ.plugin.hdr_+3A_k">k</code></td>
<td>
<p>Positive integer value that controls if the confidence region is plotted near (large values of <code>k</code>) or far away (small values of <code>k</code>) the estimated HDR. Default <code>k=3</code>. </p>
</td></tr>
<tr><td><code id="circ.plugin.hdr_+3A_col">col</code></td>
<td>
<p>Color number for plotting the HDR. Default <code>col="darkgray"</code> is used.</p>
</td></tr>
<tr><td><code id="circ.plugin.hdr_+3A_lty">lty</code></td>
<td>
<p>A numeric value indicating the line type to represent the threshold of HDR. Line type can be specified as an integer (0=blank, 1=solid (default), 2=dashed, 3=dotted, 4=dotdash, 5=longdash, 6=twodash). Default <code>lty=2</code>.</p>
</td></tr>
<tr><td><code id="circ.plugin.hdr_+3A_shrink">shrink</code></td>
<td>
<p>Parameter that controls the size of the plotted circle. Default is 2. Larger than 1 values shrink the circle, while smaller values enlarge the circle.</p>
</td></tr>
<tr><td><code id="circ.plugin.hdr_+3A_lwd">lwd</code></td>
<td>
<p>A number indicating the line width for drawing symbol. Default <code>3</code>.</p>
</td></tr>
<tr><td><code id="circ.plugin.hdr_+3A_pch">pch</code></td>
<td>
<p>Point type. Default is <code>19</code>.</p>
</td></tr>
<tr><td><code id="circ.plugin.hdr_+3A_cex">cex</code></td>
<td>
<p>Point character size for representing the data on the scatterplot. Default is <code>0.5</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A detailed definition of plug-in estimators for directional HDRs is given in Saavedra-Nieves and Crujeiras (2021). The density quantile algorithm proposed in Hyndman (1996) or the numerical integration method of trapezoidal rule can be used to compute the threshold of HDR. The confidence region for the estimated HDR is calculated also following Hyndman (1996).</p>


<h3>Value</h3>

<p>If <code>tau</code> is provided, a list with the next components:
</p>
<table role = "presentation">
<tr><td><code>hdr</code></td>
<td>
<p>Boundaries of the HDR.</p>
</td></tr>
<tr><td><code>prob.content</code></td>
<td>
<p>Probability coverage <code>1-tau</code>.</p>
</td></tr>
<tr><td><code>level</code></td>
<td>
<p>Threshold associated to the probability content <code>1-tau</code>.</p>
</td></tr>
<tr><td><code>bw</code></td>
<td>
<p>Value of the smoothing parameter used for kernel density estimation.</p>
</td></tr>
<tr><td><code>hdr.lo</code></td>
<td>
<p>HDR corresponding to lower confidence limit.</p>
</td></tr>
<tr><td><code>level.lo</code></td>
<td>
<p>Threshold associated to the lower confidence limit.</p>
</td></tr>
<tr><td><code>hdr.hi</code></td>
<td>
<p>HDR corresponding to upper confidence limit.</p>
</td></tr>
<tr><td><code>level.hi</code></td>
<td>
<p>Threshold associated to the upper confidence limit.</p>
</td></tr>
</table>
<p>If <code>level</code> is provided, a list with the next components:
</p>
<table role = "presentation">
<tr><td><code>levelset</code></td>
<td>
<p>boundaries of the level set or a character indicating if the level set is equal to the emptyset or the support distribution.</p>
</td></tr>
<tr><td><code>prob.content</code></td>
<td>
<p>Probability coverage <code>1-tau</code> associated to the <code>level</code> value.</p>
</td></tr>
<tr><td><code>level</code></td>
<td>
<p>Threshold of the level set.</p>
</td></tr>
<tr><td><code>bw</code></td>
<td>
<p>Value of the smoothing parameter used for kernel density estimation.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Paula Saavedra-Nieves and Rosa M. Crujeiras.
</p>


<h3>References</h3>

<p>Hyndman, R.J. (1996). Computing and graphing highest density regions, The American Statistician, 50, 120-126.<br />
Oliveira, M., Crujeiras. R.M. and Rodríguez-Casal, A. (2014). NPCirc: An R Package for Nonparametric
Circular Methods, Journal of Statistical Software, 61, 1-26.<br />
Saavedra-Nieves, P. and Crujeiras, R. M. (2021). Nonparametric estimation of directional highest density regions. Advances in Data Analysis and Classification, 1-36.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Plug-in HDR for orientations of saltator specie in April and October
data(sandhoppers)
attach(sandhoppers)
#Orientations in October
saltatorO&lt;-angle[(species=="salt")&amp;(time=="afternoon")&amp;(sex=="M")&amp;(month=="October")]
circ.plugin.hdr(sample=saltatorO,tau=0.8,plot.hdrconf=FALSE)
#Orientations in April
saltatorA&lt;-angle[(species=="salt")&amp;(time=="afternoon")&amp;(sex=="M")&amp;(month=="April")]
circ.plugin.hdr(sample=saltatorA,tau=0.8,plot.hdrconf=FALSE)
#HDR confidence bands for model 5 in NPCirc package
library(NPCirc)
set.seed(1)
sample&lt;- rcircmix(500, model=5)
circ.plugin.hdr(sample,bw=bw.CV(circular(sample),upper=100),tau=0.6)
</code></pre>

<hr>
<h2 id='circ.scatterplot'>Circular scatterplot for plug-in HDRs</h2><span id='topic+circ.scatterplot'></span>

<h3>Description</h3>

<p>This function produces a circular scatterplot with points coloured according to the HDRs in which they fall.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>circ.scatterplot(sample,tau=c(0.25,0.5,.75),
bw=bw.CV(circular(sample),upper=100),tau.method="quantile",
plot.density=TRUE,col=NULL,shrink=NULL,cex=NULL,lty=NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="circ.scatterplot_+3A_sample">sample</code></td>
<td>
<p>Numeric vector of angles in radians.</p>
</td></tr>
<tr><td><code id="circ.scatterplot_+3A_tau">tau</code></td>
<td>

<p>Numeric vector of probabilities. According to Saavedra-Nieves and Crujeiras (2021), <code>1-tau</code> represents the probability coverages required for HDRs.</p>
</td></tr>
<tr><td><code id="circ.scatterplot_+3A_bw">bw</code></td>
<td>

<p>Smoothing parameter to be used. Following Oliveira et al. (2014), the value of the smoothing parameter can be chosen by using the functions <code>bw.rt</code>, <code>bw.CV</code>, <code>bw.pi</code> or <code>bw.boot</code>. It could be also selecting by considering <code>circ.boot.bw</code>, the new smoothing parameter proposed in Saavedra-Nieves and Crujeiras (2021). Default <code>bw=bw.CV</code> providing a cross-validation bandwidth.
</p>
</td></tr>
<tr><td><code id="circ.scatterplot_+3A_tau.method">tau.method</code></td>
<td>

<p>Character value selecting the rule to estimate the threshold of the HDR. This must be one of <code>"quantile"</code> or <code>"trapezoidal"</code>. The first option estimates the threshold using the quantile method proposed in Hyndman(1996); the second one, using the trapezoidal rule for numerical integration. Default <code>tau.method=</code> <code>"quantile"</code>.</p>
</td></tr>
<tr><td><code id="circ.scatterplot_+3A_plot.density">plot.density</code></td>
<td>

<p>Logical string. If <code>TRUE</code>, the kernel density estimator is added to the scatterplot. Default <code>plot.density=TRUE</code>. </p>
</td></tr>
<tr><td><code id="circ.scatterplot_+3A_col">col</code></td>
<td>

<p>Vector containing the color numbers for plotting the scatterplot. If <code>NULL</code>,
a default color palette is used.</p>
</td></tr>
<tr><td><code id="circ.scatterplot_+3A_shrink">shrink</code></td>
<td>

<p>Parameter that controls the size of the plotted circle. Default is 2. Larger values shrink the circle, while smaller values enlarge the circle.</p>
</td></tr>
<tr><td><code id="circ.scatterplot_+3A_cex">cex</code></td>
<td>

<p>Point character size for representing the data on the scatterplot. Default is 0.5.</p>
</td></tr>
<tr><td><code id="circ.scatterplot_+3A_lty">lty</code></td>
<td>

<p>A numeric vector indicating the line types to represent the thresholds of HDRs. Line type can be specified as an integer (0=blank, 1=solid (default), 2=dashed, 3=dotted, 4=dotdash, 5=longdash, 6=twodash). Default <code>lty=2</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A detailed definition of directional HDRs and of their plug-in estimators is given in Saavedra-Nieves and Crujeiras (2021).<br /> Package <code>NPCirc</code> is used to estimate the circular density using the classical kernel density estimator. See Oliveira et al. (2014) for more details.<br /> Moreover, the density quantile algorithm proposed in Hyndman (1996) or the trapezoidal rule can be used to compute the threshold of HDR.<br /> The scatterplot is created colouring the sample points according to which HDR they fall.
</p>


<h3>Value</h3>

<p>A scatterplot showing the points coloured according to which HDR they fall. Futhermore, a list where the number of components is equal to the number HDR estimated or, equivalently, to the length of <code>tau</code> vector. Each component contains the sample points in each HDR from the smallest value of <code>tau</code> to the biggest one.
</p>


<h3>Author(s)</h3>

<p>Paula Saavedra-Nieves and Rosa M. Crujeiras.
</p>


<h3>References</h3>

<p>Hyndman, R.J. (1996). Computing and graphing highest density regions, The American Statistician, 50, 120-126.<br />
Oliveira, M., Crujeiras R.M. and Rodríguez-Casal, A. (2014). NPCirc: an R package for nonparametric circular methods. Journal of Statistical Software, 61(9), 1-26. <a href="https://www.jstatsoft.org/v61/i09/">https://www.jstatsoft.org/v61/i09/</a>.<br />
Saavedra-Nieves, P. and Crujeiras, R. M. (2021). Nonparametric estimation of directional highest density regions. Advances in Data Analysis and Classification, 1-36.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Scatterplot for orientations of females for saltator specie
data(sandhoppers)
attach(sandhoppers)
saltatorF&lt;-angle[(species=="salt")&amp;(sex=="F")]
circ.scatterplot(saltatorF)
# Scatterplot for sample of size 100 of model 14 in NPCirc
library(NPCirc)
set.seed(1)
sample&lt;- rcircmix(100, model=14)
circ.scatterplot(sample,tau=c(0.2,0.5,0.8))
</code></pre>

<hr>
<h2 id='dspheremix'>Density functions for mixtures of spherical von Mises-Fisher</h2><span id='topic+dspheremix'></span>

<h3>Description</h3>

<p>Density functions for nine finite mixtures of spherical von Mises-Fisher allowing different numbers of modes.</p>


<h3>Usage</h3>

<pre><code class='language-R'>dspheremix(x, model = NULL)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dspheremix_+3A_x">x</code></td>
<td>
<p>A matrix whose rows represent points on the unit sphere in Cartesian coordinates. If a row norm is different from one, a message appears indicating that they must be standardized.</p>
</td></tr>
<tr><td><code id="dspheremix_+3A_model">model</code></td>
<td>
<p>Number between 1 and 9, corresponding to a density model defined in Saavedra-Nieves and Crujeiras (2021). See Details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These nine spherical models are obtained as mixtures of von Mises distributions where the density <code class="reqn">f</code> is given by:
</p>
<p style="text-align: center;"><code class="reqn">
f=\sum_{i=1}^I w_i K_{vM}(x;m_i;k_i), w_i\geq 0;\sum_{i=1}^I w_i=1
</code>
</p>
<p> with <code class="reqn">K_vM</code> denoting the von Mises-Fisher kernel density; <code class="reqn">m_i</code>, <code class="reqn">k_i</code> and <code class="reqn">w_i</code> the mean, concentration and weight corresponding to each component. More details can be found in Hornik and Grun (2014) and Wood (1994). The combination of means, concentration parameters and the weights of spherical models from Saavedra-Nieves and Crujeiras (2021) are specified below:<br /> <br />
S1: (0, 0, 1) (<code class="reqn">m</code>); 10 (<code class="reqn">k</code>); 1 (<code class="reqn">w</code>).<br /> <br />
S2: (0, 0, 1), (0, 0, -1) (<code class="reqn">m</code>); 1, 1 (<code class="reqn">k</code>); 1/2, 1/2 (<code class="reqn">w</code>).<br /> <br />
S3: (0, 0, 1), (0, 0, -1)  (<code class="reqn">m</code>); 10, 1 (<code class="reqn">k</code>); 1/2, 1/2 (<code class="reqn">w</code>).<br /> <br />
S4: (0, 0, 1); (0, 1/<code class="reqn">\sqrt2</code>, 1/<code class="reqn">\sqrt2</code>) (<code class="reqn">m</code>); 10, 10 (<code class="reqn">k</code>); 1/2, 1/2 (<code class="reqn">w</code>).<br /> <br />
S5: (0, 0, 1); (0, 1/<code class="reqn">\sqrt2</code>, 1/<code class="reqn">\sqrt2</code>) (<code class="reqn">m</code>); 10, 10 (<code class="reqn">k</code>); 2/5, 3/5 (<code class="reqn">w</code>).<br /> <br />
S6: (0, 0, 1); (0, 1/<code class="reqn">\sqrt2</code>, 1/<code class="reqn">\sqrt2 </code>) (<code class="reqn">m</code>); 10, 5 (<code class="reqn">k</code>); 1/5, 4/5 (<code class="reqn">w</code>).<br /> <br />
S7: (0, 0, 1), (0, 1, 0), (1, 0, 0) (<code class="reqn">m</code>); 5, 5, 5 (<code class="reqn">k</code>); 1/3, 1/3, 1/3 (<code class="reqn">w</code>).<br /> <br />
S8:  (0, 0, 1), (0, 1, 0), (1, 0, 0) (<code class="reqn">m</code>); 5, 5, 5 (<code class="reqn">k</code>); 2/3, 1/6, 1/6 (<code class="reqn">w</code>).<br /> <br />
S9: (0, 0, 1); (0, 1/<code class="reqn">\sqrt 2</code>, 1/<code class="reqn">\sqrt 2</code>), (0, 1, 0) (<code class="reqn">m</code>); 10, 10, 10 (<code class="reqn">k</code>); 1/3, 1/3, 1/3 (<code class="reqn">w</code>).<br /> <br />
</p>


<h3>Value</h3>

<p>A numeric vector of density evaluated on <code>x</code>.</p>


<h3>Author(s)</h3>

<p>Paula Saavedra-Nieves and Rosa M. Crujeiras.
</p>


<h3>References</h3>

<p>Hornik, K. and Grun, B. (2014). movMF: an R package for fitting mixtures of von Mises-Fisher distributions. Journal of Statistical Software, 58(10), 1-31.<br />
Saavedra-Nieves, P. and Crujeiras, R. M.  (2021). Nonparametric estimation of directional highest density regions. Advances in Data Analysis and Classification, 1-36.<br />
Wood, A. T. (1994). Simulation of the von Mises Fisher distribution. Communications in Statistics-Simulation and Computation, 23(1), 157-164.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Density function evaluation from model S1
data &lt;- rbind(c(1,0,0),c(0,1,0),c(0,0,1))
dspheremix(data, model=1)
</code></pre>

<hr>
<h2 id='earthquakes'>
Earthquakes on Earth between October 2004 and April 2020
</h2><span id='topic+earthquakes'></span>

<h3>Description</h3>

<p>Geographical coordinates (latitude and longitude) of earthquakes of magnitude greater than or equal to 2.5 degrees.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("earthquakes")</code></pre>


<h3>Format</h3>

<p>A data frame with 272 observations on the following 2 variables:
</p>

<dl>
<dt><code>Latitude</code></dt><dd><p>A numeric vector containing the latitude coordinates.</p>
</dd>
<dt><code>Longitude</code></dt><dd><p>A numeric vector containing the longitude coordinates.</p>
</dd>
</dl>



<h3>Details</h3>

<p>To map this dataset on the unit sphere, function <code>euclid</code> in package <code>Directional</code> can be used.
</p>


<h3>Source</h3>

<p>European-Mediterranean Seismological Centre, <a href="https://www.emsc-csem.org">https://www.emsc-csem.org</a>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (requireNamespace("ggplot2", quietly = TRUE)) {
library(ggplot2)
}
if (requireNamespace("maps", quietly = TRUE)) {
library(maps)
}
if (requireNamespace("mapproj", quietly = TRUE)) {
library(mapproj)
}
data(earthquakes)
world &lt;- map_data("world")
g.earthquakes &lt;- ggplot() +
  geom_map(data = world, map = world,
           mapping = aes(map_id = region),
           color = "grey90", fill = "grey80") +
  geom_point(data = earthquakes,
            mapping = aes(x = Longitude, y = Latitude),
            color = "red",alpha=.2,size=.75,stroke=0) +
    scale_y_continuous(breaks = NULL, limits = c(-90, 90)) +
  scale_x_continuous(breaks = NULL, limits = c(-180, 180)) +
  coord_map("mercator")
g.earthquakes
</code></pre>

<hr>
<h2 id='find.circ.hdr'>
Calculation of the boundaries of HDRs in the circular setting
</h2><span id='topic+find.circ.hdr'></span>

<h3>Description</h3>

<p>This function calculates the boundaries of HDRs in the circular setting.</p>


<h3>Usage</h3>

<pre><code class='language-R'>find.circ.hdr(x, f, level)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="find.circ.hdr_+3A_x">x</code></td>
<td>

<p>Numeric vector of sorted angles in radians.</p>
</td></tr>
<tr><td><code id="find.circ.hdr_+3A_f">f</code></td>
<td>

<p>Evaluation on a circular density <code>f</code> on <code>x</code>.</p>
</td></tr>
<tr><td><code id="find.circ.hdr_+3A_level">level</code></td>
<td>

<p>Threshold of the HDR.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector of angles in radians corresponding to the frontiers of the HDR.
</p>


<h3>Author(s)</h3>

<p>Paula Saavedra-Nieves and Rosa M. Crujeiras.
</p>

<hr>
<h2 id='is.wholenumber'>
Checking if a value is integer
</h2><span id='topic+is.wholenumber'></span>

<h3>Description</h3>

<p>This function checks if a value is integer.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.wholenumber(x, tol = .Machine$double.eps^0.5)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="is.wholenumber_+3A_x">x</code></td>
<td>

<p>Numeric value to check if it is integer.</p>
</td></tr>
<tr><td><code id="is.wholenumber_+3A_tol">tol</code></td>
<td>

<p>Tolerance parameter.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Logical value: <code>TRUE</code> if <code>x</code> is integer and <code>FALSE</code> if <code>x</code> is not integer.
</p>


<h3>Author(s)</h3>

<p>Paula Saavedra-Nieves and Rosa M. Crujeiras.
</p>

<hr>
<h2 id='points10'>
Coordinates of mesh vertices for spherical numerical integration
</h2><span id='topic+points10'></span>

<h3>Description</h3>

<p>Coordinates of mesh vertices for spherical numerical integration.
</p>


<h3>Format</h3>

<p>A data frame with 1002 rows where each one corresponds to the coordinates of vertices that characterize a cell.
</p>

<dl>
<dt><code>V1</code></dt><dd><p>Coordinate of the first cell vertex.</p>
</dd>
<dt><code>V2</code></dt><dd><p>Coordinate of the second cell vertex.</p>
</dd>
<dt><code>V3</code></dt><dd><p>Coordinate of the third cell vertex.</p>
</dd>
</dl>


<hr>
<h2 id='points20'>
Coordinates of mesh vertices for spherical numerical integration
</h2><span id='topic+points20'></span>

<h3>Description</h3>

<p>Coordinates of mesh vertices for spherical numerical integration.
</p>


<h3>Format</h3>

<p>A data frame with 4002 rows where each one corresponds to the coordinates of vertices that characterize a cell.
</p>

<dl>
<dt><code>V1</code></dt><dd><p>Coordinate of the first cell vertex.</p>
</dd>
<dt><code>V2</code></dt><dd><p>Coordinate of the second cell vertex.</p>
</dd>
<dt><code>V3</code></dt><dd><p>Coordinate of the third cell vertex.</p>
</dd>
</dl>


<hr>
<h2 id='points40'>
Coordinates of mesh vertices for spherical numerical integration
</h2><span id='topic+points40'></span>

<h3>Description</h3>

<p>Coordinates of mesh vertices for spherical numerical integration.
</p>


<h3>Format</h3>

<p>A data frame with 16002 rows where each one corresponds to the coordinates of vertices that characterize a cell.
</p>

<dl>
<dt><code>V1</code></dt><dd><p>Coordinate of the first cell vertex.</p>
</dd>
<dt><code>V2</code></dt><dd><p>Coordinate of the second cell vertex.</p>
</dd>
<dt><code>V3</code></dt><dd><p>Coordinate of the third cell vertex.</p>
</dd>
</dl>


<hr>
<h2 id='rspheremix'>
Random generation functions for mixtures of spherical von Mises-Fisher
</h2><span id='topic+rspheremix'></span>

<h3>Description</h3>

<p>Random generation functions for nine finite mixtures of spherical von Mises-Fisher allowing different numbers of modes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rspheremix(n, model = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rspheremix_+3A_n">n</code></td>
<td>

<p>Number of observations to generate.
</p>
</td></tr>
<tr><td><code id="rspheremix_+3A_model">model</code></td>
<td>

<p>Number between 1 and 9, corresponding with a model defined in Saavedra-Nieves and Crujeiras (2021). See Details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These nine spherical models are obtained as mixtures of von Mises distributions where the density <code class="reqn">f</code> is given by:
</p>
<p style="text-align: center;"><code class="reqn">
f=\sum_{i=1}^I w_i K_{vM}(x;m_i;k_i), w_i\geq 0;\sum_{i=1}^I w_i=1
</code>
</p>
<p> with <code class="reqn">K_vM</code> denoting the von Mises-Fisher kernel density; <code class="reqn">m_i</code>, <code class="reqn">k_i</code> and <code class="reqn">w_i</code> the mean, concentration and weight corresponding to each component. More details can be found in Hornik and Grun (2014) and Wood (1994). The combination of means, concentration parameters and the weights of spherical models from Saavedra-Nieves and Crujeiras (2021) are specified below:<br /> <br />
S1: (0, 0, 1) (<code class="reqn">m</code>); 10 (<code class="reqn">k</code>); 1 (<code class="reqn">w</code>).<br /> <br />
S2: (0, 0, 1), (0, 0, -1) (<code class="reqn">m</code>); 1, 1 (<code class="reqn">k</code>); 1/2, 1/2 (<code class="reqn">w</code>).<br /> <br />
S3: (0, 0, 1), (0, 0, -1)  (<code class="reqn">m</code>); 10, 1 (<code class="reqn">k</code>); 1/2, 1/2 (<code class="reqn">w</code>).<br /> <br />
S4: (0, 0, 1); (0, 1/<code class="reqn">\sqrt2</code>, 1/<code class="reqn">\sqrt2</code>) (<code class="reqn">m</code>); 10, 10 (<code class="reqn">k</code>); 1/2, 1/2 (<code class="reqn">w</code>).<br /> <br />
S5: (0, 0, 1); (0, 1/<code class="reqn">\sqrt2</code>, 1/<code class="reqn">\sqrt2</code>) (<code class="reqn">m</code>); 10, 10 (<code class="reqn">k</code>); 2/5, 3/5 (<code class="reqn">w</code>).<br /> <br />
S6: (0, 0, 1); (0, 1/<code class="reqn">\sqrt2</code>, 1/<code class="reqn">\sqrt2 </code>) (<code class="reqn">m</code>); 10, 5 (<code class="reqn">k</code>); 1/5, 4/5 (<code class="reqn">w</code>).<br /> <br />
S7: (0, 0, 1), (0, 1, 0), (1, 0, 0) (<code class="reqn">m</code>); 5, 5, 5 (<code class="reqn">k</code>); 1/3, 1/3, 1/3 (<code class="reqn">w</code>).<br /> <br />
S8:  (0, 0, 1), (0, 1, 0), (1, 0, 0) (<code class="reqn">m</code>); 5, 5, 5 (<code class="reqn">k</code>); 2/3, 1/6, 1/6 (<code class="reqn">w</code>).<br /> <br />
S9: (0, 0, 1); (0, 1/<code class="reqn">\sqrt 2</code>, 1/<code class="reqn">\sqrt 2</code>), (0, 1, 0) (<code class="reqn">m</code>); 10, 10, 10 (<code class="reqn">k</code>); 1/3, 1/3, 1/3 (<code class="reqn">w</code>).<br /> <br />
</p>


<h3>Value</h3>

<p>A matrix with <code class="reqn">n</code> unit length rows representing the generated values from a finite mixture of spherical von Mises-Fisher.<br />
</p>


<h3>Author(s)</h3>

<p>Paula Saavedra-Nieves and Rosa M. Crujeiras.
</p>


<h3>References</h3>

<p>Hornik, K. and Grun, B. (2014). movMF: an R package for fitting mixtures of von Mises-Fisher distributions. Journal of Statistical Software, 58(10), 1-31.<br />
Saavedra-Nieves, P. and Crujeiras, R. M. (2021). Nonparametric estimation of directional highest density regions. Advances in Data Analysis and Classification, 1-36.<br />
Wood, A. T. (1994). Simulation of the von Mises Fisher distribution. Communications in Statistics-Simulation and Computation, 23(1), 157-164.</p>


<h3>Examples</h3>

<pre><code class='language-R'># Random generation from model 1 in library HDiR
data &lt;- rspheremix(500, model=1)
library(Directional)
sphereplot(data)
</code></pre>

<hr>
<h2 id='runif_on_sphere'>
Random generation of a sample on a d-dimensional sphere of radius r</h2><span id='topic+runif_on_sphere'></span>

<h3>Description</h3>

<p>This function generates a random sample on the unit sphere.</p>


<h3>Usage</h3>

<pre><code class='language-R'>runif_on_sphere(n, d, r = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="runif_on_sphere_+3A_n">n</code></td>
<td>

<p>Size of the sample to be generated.</p>
</td></tr>
<tr><td><code id="runif_on_sphere_+3A_d">d</code></td>
<td>

<p>Dimension of the space which contains the sphere.</p>
</td></tr>
<tr><td><code id="runif_on_sphere_+3A_r">r</code></td>
<td>

<p>Radius of the sphere.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of <code>n</code> rows and <code>d</code> columns containing the sample points.
</p>


<h3>Author(s)</h3>

<p>Paula Saavedra-Nieves and Rosa M. Crujeiras.
</p>

<hr>
<h2 id='sandhoppers'>
Behavioral plasticity of Talitrus saltator and Talorchestia brito
</h2><span id='topic+sandhoppers'></span>

<h3>Description</h3>

<p>Orientation measured under natural conditions and other variables of interest for analyzing the behavioral plasticity of two sympatric sandhoppers species, Talitrus saltator and Talorchestia brito. The experiment was carried out on the exposed nontidal sand of Zouara beach located in the Tunisian northwestern coast. More details can be found in Marchetti and Scapini (2003) or Scapini et al. (2002).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("sandhoppers")</code></pre>


<h3>Format</h3>

<p>A data frame with 1828 observations on the following 12 variables.
</p>

<dl>
<dt><code>angle</code></dt><dd><p>Numeric vector containing the orientation angles in radians between 0 and <code class="reqn">2\pi</code>.</p>
</dd>
<dt><code>date</code></dt><dd><p>A factor where each level indicates the date when angles were measured.</p>
</dd>
<dt><code>month</code></dt><dd><p>A factor with two levels indicating the month when angles were measured. Experiments were performed in two different periods, <code>April</code> and <code>October</code>, which were chosen for the abundance of the populations, as well as for their non-extreme and changing climatic conditions.</p>
</dd>
<dt><code>time</code></dt><dd><p>A factor with levels <code>afternoon</code>, <code>morning</code> and <code>noon</code>.</p>
</dd>
<dt><code>azim</code></dt><dd><p>A numeric vector indicating the sun azimuth. The sun position was confounded with the time of the day (morning: 100-150, noon: az=151-210 and afternoon: az=211-260 experiments).</p>
</dd>
<dt><code>hour</code></dt><dd><p>A factor with hours when angles were measured.</p>
</dd>
<dt><code>species</code></dt><dd><p>A factor with three levels (<code>brito</code>, <code>salt</code>, <code>ND</code>) indicating the specie (brito, saltator, not determined).</p>
</dd>
<dt><code>sex</code></dt><dd><p>A factor with three levels (<code>F</code>, <code>M</code>, <code>J</code>) indicating the sex (female, male, J).</p>
</dd>
<dt><code>temp</code></dt><dd><p>A numeric vector indicating the temperature (degrees centigrade).</p>
</dd>
<dt><code>humid</code></dt><dd><p>A numeric vector indicating the air relative humidity (%).</p>
</dd>
<dt><code>land</code></dt><dd><p>A factor with two levels (<code>no</code>, <code>yes</code>) indicating landscape view was either permitted or screened.</p>
</dd>
<dt><code>trap</code></dt><dd><p>A numeric vector containing the traps identifier used for capturing the sandhoppers.</p>
</dd>
</dl>



<h3>Details</h3>

<p>Authors thank Prof. Felicita Scapini for providing the sandhoppers data (collected under the support of the European Project ERB ICI8-CT98-0270).</p>


<h3>References</h3>

<p>Marchetti, G. M. and Scapini, F., Use of multiple regression models in the study of sandhopper orientation under natural conditions, Estuarine, Coastal and Shelf Science, 58, 207-215 (2003).<br />
Scapini, F., Aloia, A., Bouslama, M. F., Chelazzi, L., Colombini, I., ElGtari, M., Fallaci, M. and Marchetti, G. M. Multiple regression analysis of the sources of variation in orientation of two sympatric sandhoppers, Talitrus saltator and Talorchestia brito, from an exposed Mediterranean beach, Behavioral Ecology and Sociobiology, 51(5), 403-414 (2002).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sandhoppers)
attach(sandhoppers)
library(NPCirc)
saltator=circular(angle[(species=="salt")],type="angles",units="radians")
brito=circular(angle[(species=="brito")],type="angles",units="radians")
library(NPCirc)
oldpar&lt;-par(mfrow=c(1,2))
plot(saltator)
plot(brito)
par(oldpar)
</code></pre>

<hr>
<h2 id='sphere.boot.bw'>
Spherical smoothing parameter for HDRs estimation</h2><span id='topic+sphere.boot.bw'></span>

<h3>Description</h3>

<p>This function provides the specific smoothing parameter for spherical HDRs estimation proposed in Saavedra-Nieves and Crujeiras (2021).</p>


<h3>Usage</h3>

<pre><code class='language-R'>sphere.boot.bw(sample,bw="none",tau=0.5,ngrid=500,
               B=50,nborder=500,upper=NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sphere.boot.bw_+3A_sample">sample</code></td>
<td>
<p>A matrix whose rows represent points on the unit sphere in Cartesian coordinates. If a row norm is different from one, a message appears indicating that they must be standardized.</p>
</td></tr>
<tr><td><code id="sphere.boot.bw_+3A_bw">bw</code></td>
<td>
<p>Pilot smoothing parameter to be used. According to <code>Directional</code> package, this can be either <code>"none"</code> for cross validation or <code>"rot"</code> for the rule of thumb suggested by García-Portugués (2013). Default <code>bw="none"</code>.</p>
</td></tr>
<tr><td><code id="sphere.boot.bw_+3A_tau">tau</code></td>
<td>
<p>Numeric probability. According to Saavedra-Nieves and Crujeiras (2021), <code>1-tau</code> represents the probability coverage required for HDR. Default <code>tau=0.5</code>.</p>
</td></tr>
<tr><td><code id="sphere.boot.bw_+3A_ngrid">ngrid</code></td>
<td>
<p>Resolution of the density calculation. Default <code>ngrid=500</code>.</p>
</td></tr>
<tr><td><code id="sphere.boot.bw_+3A_b">B</code></td>
<td>
<p>Integer string indicating the number of bootstrap resamples. Default <code>B=50</code>.</p>
</td></tr>
<tr><td><code id="sphere.boot.bw_+3A_nborder">nborder</code></td>
<td>
<p>Maximum number of HDRs boundary points to be represented. Default <code>nborder=500</code>.</p>
</td></tr>
<tr><td><code id="sphere.boot.bw_+3A_upper">upper</code></td>
<td>
<p>Numerical upper value for bounding the optimization procedure. Default <code>upper=NULL</code>. In this case, the upper bound is equal to <code> 1.5bw</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Saavedra-Nieves and Crujeiras (2021) propose a specific smoothing parameter for HDRs estimation based on the minimization of the Hausdorff distance between the boundaries of the theoretical HDR and the plug-in estimator.</p>


<h3>Value</h3>

<p>A numeric value corresponding to the selected smoothing parameter.
</p>


<h3>Author(s)</h3>

<p>Paula Saavedra-Nieves and Rosa M. Crujeiras.
</p>


<h3>References</h3>

<p>García-Portugués, E. (2013). Exact risk improvement of bandwidth selectors for kernel density
estimation with directional data. Electronic Journal of Statistics, 7, 1655-1685.<br />
Saavedra-Nieves, P. and Crujeiras, R. M. (2021). Nonparametric estimation of directional highest density regions. Advances in Data Analysis and Classification, 1-36.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# HDR selector from a sample of size 1000 of model 4 in library HDiR
set.seed(1)
sample=rspheremix(500,model=4)
sphere.boot.bw(sample,tau=0.8,B=2)

</code></pre>

<hr>
<h2 id='sphere.boot.sample'>
Bootstrap samples from a spherical kernel estimator</h2><span id='topic+sphere.boot.sample'></span>

<h3>Description</h3>

<p>This function generates bootstrap samples from a spherical kernel estimator.</p>


<h3>Usage</h3>

<pre><code class='language-R'>sphere.boot.sample(sample, n, bw)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sphere.boot.sample_+3A_sample">sample</code></td>
<td>

<p>Matrix of <code>n</code> rows and three columns containing the sample of points on the unit sphere.</p>
</td></tr>
<tr><td><code id="sphere.boot.sample_+3A_n">n</code></td>
<td>

<p>Sample size to be generated.</p>
</td></tr>
<tr><td><code id="sphere.boot.sample_+3A_bw">bw</code></td>
<td>

<p>Bandwidth parameter.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix containing a bootstrap sample on the unit sphere.
</p>


<h3>Author(s)</h3>

<p>Paula Saavedra-Nieves and Rosa M. Crujeiras.
</p>

<hr>
<h2 id='sphere.distances'>
Euclidean and Hausdorff distances between two sets of points on the unit sphere
</h2><span id='topic+sphere.distances'></span>

<h3>Description</h3>

<p>This function determines the Euclidean and Hausdorff distances between two sets of points on the unit sphere.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sphere.distances(x, y)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sphere.distances_+3A_x">x</code></td>
<td>

<p>A matrix whose rows represent points on the unit sphere in Cartesian coordinates. If a row norm is different from one, a message appears indicating that they must be standardized.
</p>
</td></tr>
<tr><td><code id="sphere.distances_+3A_y">y</code></td>
<td>

<p>A matrix whose rows represent points on the unit sphere in Cartesian coordinates. If a row norm is different from one, a message appears indicating that they must be standardized.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>x</code> and <code>y</code> correspond to two HDRs boundaries, this function returns the Euclidean and Hausdorff distances between the HDR frontiers, but the function computes the Euclidean and Hausdorff distance for two sets of points on the sphere, no matter their nature. See Saavedra-Nieves and Crujeiras (2021) for more details on these two distances.
</p>


<h3>Value</h3>

<p>A list with two components:
</p>
<table role = "presentation">
<tr><td><code>dE</code></td>
<td>
<p>Euclidean distance.</p>
</td></tr>
<tr><td><code>dH</code></td>
<td>
<p>Hausdorff distance.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Paula Saavedra-Nieves and Rosa M. Crujeiras.
</p>


<h3>References</h3>

<p>Saavedra-Nieves, P. and Crujeiras, R. M. (2021). Nonparametric estimation of directional highest density regions. Advances in Data Analysis and Classification, 1-36.</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Distances between boundaries of two plug-in HDR estimators for spherical model 9 in HDiR package
set.seed(1)
sample=rspheremix(1000, model =9)
x&lt;-sphere.plugin.hdr(sample,tau=0.8,plot.hdr=FALSE)$hdr
y&lt;-sphere.plugin.hdr(sample,tau=0.5,plot.hdr=FALSE)$hdr
sphere.distances(x, y)

</code></pre>

<hr>
<h2 id='sphere.hdr'>
Computation of HDRs for a spherical density and of general level sets for spherical real-valued functions</h2><span id='topic+sphere.hdr'></span>

<h3>Description</h3>

<p>This function computes HDRs of a spherical density and general level sets for real-valued functions defined on the unit sphere.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sphere.hdr(f,tau=NULL,level=NULL,nborder=1000,tol=0.1,
           mesh=40,deg=6,plot.hdr=TRUE,col=NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sphere.hdr_+3A_f">f</code></td>
<td>
<p>Object of class <code>"function"</code> that represents a spherical density function or any general real-valued function defined on the unit sphere. Matrix parametrisation of <code>f</code> must be established. Each row of the matrix corresponds to the cartesian coordinates of a point on the unit sphere. Additionally, if <code>f</code> is not a density function, the argument <code>tau</code> cannot be specified and only the value of <code>level</code> must be provided by the user.</p>
</td></tr>
<tr><td><code id="sphere.hdr_+3A_tau">tau</code></td>
<td>
<p>Numeric probability. According to Saavedra-Nieves and Crujeiras (2021), <code>1-tau</code> represents the probability coverage required for HDR. If <code>tau=NULL</code>, a value for the threshold <code>level</code> must be provided.</p>
</td></tr>
<tr><td><code id="sphere.hdr_+3A_level">level</code></td>
<td>
<p>Numeric threshold of the HDR or of the general level set provided by the user. If <code>level</code> is larger than the maximum value of the function f, the HDR or the level set are equal to the emptyset. If <code>level</code> is smaller than the minimum of f, its support is obtained. If <code>level=NULL</code>, f must be a density function and a value for the probability coverage <code>1-tau</code> of the HDR must be provided.</p>
</td></tr>
<tr><td><code id="sphere.hdr_+3A_nborder">nborder</code></td>
<td>
<p>Maximum number of HDRs boundary points to be represented. Default <code>nborder=</code> <code>1000</code>.</p>
</td></tr>
<tr><td><code id="sphere.hdr_+3A_tol">tol</code></td>
<td>

<p>Tolerance parameter to determinate the boundary of HDRs. Default <code>tol=0.1</code>.</p>
</td></tr>
<tr><td><code id="sphere.hdr_+3A_mesh">mesh</code></td>
<td>

<p>A numeric value 10, 20 or 40 indicating the 3D cartesian mesh used for numerical integration on the unit shere. Default <code>mesh=40</code> considering a total of 32000 triangular cells on the sphere. If <code>mesh=20</code> or <code>mesh=10</code>, 8000 triangular cells or 2000 are considered, respectively.
</p>
</td></tr>
<tr><td><code id="sphere.hdr_+3A_deg">deg</code></td>
<td>
<p>Integer string indicating the degree (from 0 to 6) of the quadrature rules for triangles on the sphere for numerical integration. Default <code>deg=6</code>.
</p>
</td></tr>
<tr><td><code id="sphere.hdr_+3A_plot.hdr">plot.hdr</code></td>
<td>

<p>Logical string. If <code>TRUE</code>, the boundary of the level set or the HDR are represented graphically. Default <code>plot.density=TRUE</code>.</p>
</td></tr>
<tr><td><code id="sphere.hdr_+3A_col">col</code></td>
<td>

<p>Color number for plotting the boundary of the HDR. Default <code>"darkgray"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A detailed definition of directional HDRs for a density is given in Saavedra-Nieves and Crujeiras (2021). Note that numerical integration on the sphere is used to compute the threshold of HDR when <code>tau</code> is provided.</p>


<h3>Value</h3>

<p>If <code>tau</code> is provided, a list with the next components:
</p>
<table role = "presentation">
<tr><td><code>hdr</code></td>
<td>
<p>A matrix of rows of points on the HDR boundary.</p>
</td></tr>
<tr><td><code>prob.content</code></td>
<td>
<p>Probability coverage <code>1-tau</code>.</p>
</td></tr>
<tr><td><code>level</code></td>
<td>
<p>Threshold associated to the probability content <code>1-tau</code>.</p>
</td></tr>
</table>
<p>If <code>level</code> is provided, a list with the next components:
</p>
<table role = "presentation">
<tr><td><code>levelset</code></td>
<td>
<p>A matrix of rows of points on the level set boundary.</p>
</td></tr>
<tr><td><code>level</code></td>
<td>
<p>Threshold of the level set.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Paula Saavedra-Nieves, Rosa M. Crujeiras and Andrés Prieto.
</p>


<h3>References</h3>

<p>Saavedra-Nieves, P. and Crujeiras, R. M. (2021). Nonparametric estimation of directional highest density regions. Advances in Data Analysis and Classification, 1-36.</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#HDR of model 8 in library HDiR
f1&lt;-function(x){return(dspheremix(x,model=8))}
sphere.hdr(f1,tau=0.5,mesh=20,deg=3)


# Density level set plug-in reconstruction from a sample
# of size 500 (model 8) by using a kernel density
# estimator with uniform kernel
library(DirStats)
f2&lt;-function(x){
  set.seed(1)
  sample&lt;-rspheremix(500, model = 3)
  return(kde_dir(x, data = sample, h = 0.4,
  L = function(x) dunif(x)))
}
sphere.hdr(f2,level=0.3)

</code></pre>

<hr>
<h2 id='sphere.integration'>
Numerical integration on the unit sphere</h2><span id='topic+sphere.integration'></span>

<h3>Description</h3>

<p>This function calculates the integral of a function <code class="reqn">f</code> on the unit sphere.</p>


<h3>Usage</h3>

<pre><code class='language-R'>sphere.integration(f, mesh = 40, deg = 3)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sphere.integration_+3A_f">f</code></td>
<td>

<p>Function to be integrated.</p>
</td></tr>
<tr><td><code id="sphere.integration_+3A_mesh">mesh</code></td>
<td>

<p>Triangular mesh to be used. More details can be found in the description of <code>sphere.hdr</code> function.
</p>
</td></tr>
<tr><td><code id="sphere.integration_+3A_deg">deg</code></td>
<td>

<p>Degree of the quadrature rules for triangles. More details can be found in the description of <code>sphere.hdr</code> function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric value of the integral.
</p>


<h3>Author(s)</h3>

<p>Andrés Prieto, Rosa M. Crujeiras and Paula Saavedra-Nieves.
</p>

<hr>
<h2 id='sphere.plugin.hdr'>
Spherical plug-in estimation of HDRs
</h2><span id='topic+sphere.plugin.hdr'></span>

<h3>Description</h3>

<p>This function computes the spherical plug-in estimator of HDRs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sphere.plugin.hdr(sample,bw="none",ngrid=500,
                  tau=NULL,level=NULL,nborder=1000,tol=0.01,
                  mesh=40,deg=3,plot.hdr=TRUE, col=NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sphere.plugin.hdr_+3A_sample">sample</code></td>
<td>

<p>A matrix whose rows represent points on the unit sphere in Cartesian coordinates. If a row norm is different from one, a message appears indicating that they must be standardized.</p>
</td></tr>
<tr><td><code id="sphere.plugin.hdr_+3A_bw">bw</code></td>
<td>
<p>Smoothing parameter to be used. It can be a numeric value directly selected by the user. According to <code>Directional</code> package, this could be also either <code>"none"</code> for cross validation or <code>"rot"</code> for the rule of thumb suggested by García-Portugués (2013).  Moreover, function <code>sphere.boot.bw</code> allows to select the new smoothing parameter proposed in Saavedra-Nieves and Crujeiras (2021). Default <code>bw="none"</code>.</p>
</td></tr>
<tr><td><code id="sphere.plugin.hdr_+3A_ngrid">ngrid</code></td>
<td>

<p>Sets the resolution of the density calculation. Default <code>ngrid=500</code>.</p>
</td></tr>
<tr><td><code id="sphere.plugin.hdr_+3A_tau">tau</code></td>
<td>

<p>Numeric probability. According to Saavedra-Nieves and Crujeiras (2021), <code>1-tau</code> represents the probability coverage required for HDR. If <code>tau=NULL</code>, a value for the threshold <code>level</code> of the HDR must be provided.</p>
</td></tr>
<tr><td><code id="sphere.plugin.hdr_+3A_level">level</code></td>
<td>
<p>Numeric threshold of the HDR provided by the user. When <code>level</code> is larger than the maximum value of the density, the HDR is equal to the emptyset. If <code>level</code> is smaller than the minimum of the density, the HDR coincides with the support distribution. If <code>level=NULL</code>, a value for the probability coverage <code>1-tau</code> of the HDR must be provided.</p>
</td></tr>
<tr><td><code id="sphere.plugin.hdr_+3A_nborder">nborder</code></td>
<td>

<p>Maximum number of HDRs boundary points to be represented. Default <code>nborder=</code> <code>1000</code>.</p>
</td></tr>
<tr><td><code id="sphere.plugin.hdr_+3A_tol">tol</code></td>
<td>
<p>Tolerance parameter to determinate the boundary of HDRs. Default <code>tol=0.01</code>.
</p>
</td></tr>
<tr><td><code id="sphere.plugin.hdr_+3A_mesh">mesh</code></td>
<td>

<p>A numeric value 10, 20 or 40 indicating the 3D cartesian mesh used for numerical integration on the unit shere. Default <code>mesh=40</code> considering a total of 32000 triangular cells on the sphere. If <code>mesh=20</code> or <code>mesh=10</code>, 8000 triangular cells or 2000 are considered, respectively.
</p>
</td></tr>
<tr><td><code id="sphere.plugin.hdr_+3A_deg">deg</code></td>
<td>
<p>Integer string indicating the degree (from 0 to 6) of the quadrature rules for triangles on the sphere. Default <code>deg=6</code>.
</p>
</td></tr>
<tr><td><code id="sphere.plugin.hdr_+3A_plot.hdr">plot.hdr</code></td>
<td>

<p>Logical string. If <code>TRUE</code>, the boundary of the level set or the HDR are represented graphically. Default <code>plot.hdr=TRUE</code>. </p>
</td></tr>
<tr><td><code id="sphere.plugin.hdr_+3A_col">col</code></td>
<td>

<p>Color number for plotting the boundary of the HDR. Default <code>"darkgray"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A detailed definition of plug-in estimators for directional HDRs is given in Saavedra-Nieves and Crujeiras (2021). Moreover, the density quantile algorithm proposed in Hyndman (1996) is used to compute the threshold of HDR.  </p>


<h3>Value</h3>

<p>If <code>tau</code> is provided, a list with the next components:
</p>
<table role = "presentation">
<tr><td><code>hdr</code></td>
<td>
<p>A matrix of rows of points on the HDR boundary.</p>
</td></tr>
<tr><td><code>prob.content</code></td>
<td>
<p>Probability coverage <code>1-tau</code>.</p>
</td></tr>
<tr><td><code>level</code></td>
<td>
<p>Threshold associated to the probability content <code>1-tau</code>.</p>
</td></tr>
<tr><td><code>bw</code></td>
<td>
<p>Value of the smoothing parameter used for kernel density estimation.</p>
</td></tr>
</table>
<p>If <code>level</code> is provided, a list with the next components:
</p>
<table role = "presentation">
<tr><td><code>levelset</code></td>
<td>
<p>A matrix of rows of points on the level set boundary or a character indicating if the level set is equal to the emptyset or the support distribution.</p>
</td></tr>
<tr><td><code>prob.content</code></td>
<td>
<p>Probability coverage <code>1-tau</code> associated to the <code>level</code> value.</p>
</td></tr>
<tr><td><code>level</code></td>
<td>
<p>Threshold of the level set.</p>
</td></tr>
<tr><td><code>bw</code></td>
<td>
<p>Value of the smoothing parameter used for kernel density estimation.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Paula Saavedra-Nieves and Rosa M. Crujeiras.
</p>


<h3>References</h3>

<p>García-Portugués, E. (2013). Exact risk improvement of bandwidth selectors for kernel density
estimation with directional data. Electronic Journal of Statistics, 7, 1655-1685.<br />
Hyndman, R.J. (1996). Computing and graphing highest density regions, The American Statistician, 50, 120-126.<br />
Saavedra-Nieves, P. and Crujeiras, R. M. (2021). Nonparametric estimation of directional highest density regions. Advances in Data Analysis and Classification, 1-36.</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Plug-in HDR estimator for spherical model 9 in HDiR package
set.seed(1)
sample=rspheremix(1000, model =9)
sphere.plugin.hdr(sample,tau=0.8,col="red")

#Plug-in HDR estimator for data on earthquakes on Earth
if (requireNamespace("ggplot2", quietly = TRUE)) {
library(ggplot2)
}
if (requireNamespace("maps", quietly = TRUE)) {
library(maps)
}
if (requireNamespace("mapproj", quietly = TRUE)) {
library(mapproj)
}
data(earthquakes)
library(Directional)
hdr08&lt;-as.data.frame(euclid.inv(sphere.plugin.hdr(euclid(earthquakes),tau=0.8,
plot.hdr=FALSE)$hdr))
world &lt;- map_data("world")
g.earthquakes &lt;- ggplot() +
  geom_map(data = world, map = world,
           mapping = aes(map_id = region),
           color = "grey90", fill = "grey80") +
  geom_point(data = earthquakes,
            mapping = aes(x = Longitude, y = Latitude),
           color = "red",alpha=.2,size=.75,stroke=0) +
  geom_point(data = hdr08,
            mapping = aes(x = Long, y = Lat),
            color = "darkblue", size = 1) +
  scale_y_continuous(breaks = NULL, limits = c(-90, 90)) +
 scale_x_continuous(breaks = NULL, limits = c(-180, 180)) +
  coord_map("mercator")
g.earthquakes

</code></pre>

<hr>
<h2 id='sphere.scatterplot'>
Spherical scatterplot for plug-in HDRs
</h2><span id='topic+sphere.scatterplot'></span>

<h3>Description</h3>

<p>This function produces a spherical scatterplot with points coloured according to the HDRs in which they fall.</p>


<h3>Usage</h3>

<pre><code class='language-R'>sphere.scatterplot(sample,tau=c(0.25,0.5,.75),bw="none",
                   ngrid=500,nborder=1000,tol=0.1, col=NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sphere.scatterplot_+3A_sample">sample</code></td>
<td>

<p>A matrix whose rows represent points on the unit sphere in Cartesian coordinates. If a row norm is different from one, a message appears indicating that they must be standardized.</p>
</td></tr>
<tr><td><code id="sphere.scatterplot_+3A_tau">tau</code></td>
<td>

<p>Numeric vector of probabilities. According to Saavedra-Nieves and Crujeiras (2021), <code>1-tau</code> represents the probability coverages required for HDRs.</p>
</td></tr>
<tr><td><code id="sphere.scatterplot_+3A_bw">bw</code></td>
<td>

<p>Smoothing parameter to be used. According to <code>Directional</code> package, this can be either <code>"none"</code> for cross validation or <code>"rot"</code> for the rule of thumb suggested by García-Portugués (2013). It could be also selecting by considering <code>sphere.boot.bw</code>, the new smoothing parameter proposed in Saavedra-Nieves and Crujeiras (2021). Default <code>bw="none"</code>.</p>
</td></tr>
<tr><td><code id="sphere.scatterplot_+3A_ngrid">ngrid</code></td>
<td>

<p>Sets the resolution of the density calculation. Default <code>ngrid=500</code>.</p>
</td></tr>
<tr><td><code id="sphere.scatterplot_+3A_nborder">nborder</code></td>
<td>

<p>Maximum number of HDRs boundary points to be represented. Default <code>nborder=</code> <code>1000</code>.</p>
</td></tr>
<tr><td><code id="sphere.scatterplot_+3A_tol">tol</code></td>
<td>

<p>Tolerance parameter to determinate the boundary of HDRs. Default <code>tol=0.1</code>.
</p>
</td></tr>
<tr><td><code id="sphere.scatterplot_+3A_col">col</code></td>
<td>

<p>Vector containing the color numbers for plotting the scatterplot. If <code>NULL</code>,
a default color palette is used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A detailed definition of directional HDRs and of their plug-in estimators is given in Saavedra-Nieves and Crujeiras (2021).<br /> Package <code>Directional</code> is used to compute tha von Mises-Fisher kernel density estimate.<br /> The density quantile algorithm proposed in Hyndman (1996) is used to calculate the threshold of HDR.<br /> The scatterplot is created colouring the sample points according to which HDR they fall.</p>


<h3>Value</h3>

<p>A scatterplot showing the points coloured according to which HDR they fall. Futhermore, a list where the number of components is equal to the number HDR estimated or, equivalently, to the length of tau vector. Each component contains the sample points in each HDR from the smallest value of tau to the biggest one.
</p>


<h3>Author(s)</h3>

<p>Paula Saavedra-Nieves and Rosa M. Crujeiras.
</p>


<h3>References</h3>

<p>García-Portugués, E. (2013). Exact risk improvement of bandwidth selectors for kernel density
estimation with directional data. Electronic Journal of Statistics, 7, 1655-1685.<br />
Tsagris, M., Athineou, G., Sajib, A., Tsagris, M. M. and Imports, M. A. S. S. (2016). Package <code>Directional</code>. <a href="https://cran.r-project.org/package=Directional">https://cran.r-project.org/package=Directional</a>.<br />
Saavedra-Nieves, P. and Crujeiras, R. M. (2021). Nonparametric estimation of directional highest density regions. Advances in Data Analysis and Classification, 1-36.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Scatterplot of model 4 in library HDiR
set.seed(1)
sample=rspheremix(1000,model=4)
sphere.scatterplot(sample,tau=c(.2,.5,.8))
#Scatterplot of model 9 in library HDiR
set.seed(1)
sample=rspheremix(1000,model=9)
sphere.scatterplot(sample)

</code></pre>

<hr>
<h2 id='trapezoidal.rule'>
Trapezoidal rule for numerical integration over a threshold</h2><span id='topic+trapezoidal.rule'></span>

<h3>Description</h3>

<p>This functions implements the trapezoidal rule for numerical integration of a function <code class="reqn">f</code> over a threshold.</p>


<h3>Usage</h3>

<pre><code class='language-R'>trapezoidal.rule(f, step, y)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="trapezoidal.rule_+3A_f">f</code></td>
<td>

<p>Function to be integrated.</p>
</td></tr>
<tr><td><code id="trapezoidal.rule_+3A_step">step</code></td>
<td>

<p>Numeric value of the distance between points for integration.</p>
</td></tr>
<tr><td><code id="trapezoidal.rule_+3A_y">y</code></td>
<td>

<p>Numeric value of the threshold.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric value of the integral.
</p>


<h3>Author(s)</h3>

<p>Paula Saavedra-Nieves and Rosa M. Crujeiras.
</p>

<hr>
<h2 id='vmf.kerncontour2'>
Von Mises-Fisher kernel density estimator with numerical smoothing parameter</h2><span id='topic+vmf.kerncontour2'></span>

<h3>Description</h3>

<p>This function calculates the Von Mises-Fisher kernel density estimator is a slight modification of function vmf.kerncontour
in <code>Directional</code> package. In this new version, it is possible to provide a numerical value for the bandwidth.</p>


<h3>Usage</h3>

<pre><code class='language-R'>vmf.kerncontour2(u, h, full = FALSE, ngrid = 100)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="vmf.kerncontour2_+3A_u">u</code></td>
<td>

<p>A two column matrix. The first column is the latitude and the second is the longitude.</p>
</td></tr>
<tr><td><code id="vmf.kerncontour2_+3A_h">h</code></td>
<td>

<p>Numeric value for bandwidth ot smoothing parameter.</p>
</td></tr>
<tr><td><code id="vmf.kerncontour2_+3A_full">full</code></td>
<td>

<p>If <code>FALSE</code> (default), uses the range of positions from <code>u</code> to calculate and optionally plot densities. If <code>TRUE</code>, calculates densities covering the entire sphere.</p>
</td></tr>
<tr><td><code id="vmf.kerncontour2_+3A_ngrid">ngrid</code></td>
<td>

<p>Sets the resolution of the density calculation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with kernel density estimation. For more details, see function <code>vmf.kerncontour</code> in <code>Directional</code> package.
</p>


<h3>Author(s)</h3>

<p>Paula Saavedra-Nieves and Rosa M. Crujeiras.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
