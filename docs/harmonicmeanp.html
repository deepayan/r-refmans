<!DOCTYPE html><html><head><title>Help for package harmonicmeanp</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {harmonicmeanp}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Asymptotically Exact Harmonic Mean p-Value'>
<p>Asymptotically Exact Harmonic Mean p-Value</p></a></li>
<li><a href='#Compute the Harmonic Mean p-Value'>
<p>Compute the Harmonic Mean <em>p</em>-Value</p></a></li>
<li><a href='#Compute the Model-Averaged Mean Maximized Likelihood'>
<p>Compute the Model-Averaged Mean Maximized Likelihood</p></a></li>
<li><a href='#Harmonic Mean p-Value Asymptotic Distribution'>
<p>The Harmonic Mean p-Value Asymptotic Distribution</p></a></li>
<li><a href='#harmonicmeanp'>
<p>Harmonic mean p-values and model averaging by mean maximum likelihood</p></a></li>
<li><a href='#Landau Distribution'>
<p>The Landau Distribution</p></a></li>
<li><a href='#Model-Averaged Mean Maximized Likelihood Ratio Asymptotic Distribution'>
<p>Model-Averaged Mean Maximized Likelihood Ratio Asymptotic Distribution</p></a></li>
<li><a href='#p.mamml'>
<p>Compute a combined <em>p</em>-value via the model-averaged mean maximized likelihood ratio</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Harmonic Mean p-Values and Model Averaging by Mean Maximum
Likelihood</td>
</tr>
<tr>
<td>Version:</td>
<td>3.0.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-01-16</td>
</tr>
<tr>
<td>Author:</td>
<td>Daniel J. Wilson</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Daniel Wilson &lt;hmp.R.package@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>The harmonic mean p-value (HMP) test combines p-values and corrects for multiple testing while controlling the strong-sense family-wise error rate. It is more powerful than common alternatives including Bonferroni and Simes procedures when combining large proportions of all the p-values, at the cost of slightly lower power when combining small proportions of all the p-values. It is more stringent than controlling the false discovery rate, and possesses theoretical robustness to positive correlations between tests and unequal weights. It is a multi-level test in the sense that a superset of one or more significant tests is certain to be significant and conversely when the superset is non-significant, the constituent tests are certain to be non-significant. It is based on MAMML (model averaging by mean maximum likelihood), a frequentist analogue to Bayesian model averaging, and is theoretically grounded in generalized central limit theorem. For detailed examples type vignette("harmonicmeanp") after installation. Version 3.0 addresses errors in versions 1.0 and 2.0 that led function p.hmp to control the familywise error rate only in the weak sense, rather than the strong sense as intended.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>FMStable</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, ape, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-01-17 09:22:23 UTC; wilson</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-01-17 13:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='Asymptotically+20Exact+20Harmonic+20Mean+20p-Value'>
Asymptotically Exact Harmonic Mean p-Value
</h2><span id='topic+p.hmp'></span>

<h3>Description</h3>

<p>Compute a combined <em>p</em>-value via the asymptotically exact harmonic mean <em>p</em>-value. The harmonic mean <em>p</em>-value (HMP) test combines <em>p</em>-values and corrects for multiple testing while controlling the strong-sense family-wise error rate. It is more powerful than common alternatives including Bonferroni and Simes procedures when combining large proportions of all the <em>p</em>-values, at the cost of slightly lower power when combining small proportions of all the <em>p</em>-values. It is more stringent than controlling the false discovery rate, and possesses theoretical robustness to positive correlations between tests and unequal weights. It is a multi-level test in the sense that a superset of one or more significant tests is certain to be significant and conversely when the superset is non-significant, the constituent tests are certain to be non-significant. It is based on MAMML (model averaging by mean maximum likelihood), a frequentist analogue to Bayesian model averaging, and is theoretically grounded in generalized central limit theorem.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>p.hmp(p, w = NULL, L = NULL, w.sum.tolerance = 1e-6, multilevel = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Asymptotically+2B20Exact+2B20Harmonic+2B20Mean+2B20p-Value_+3A_p">p</code></td>
<td>

<p>A numeric vector of one or more <em>p</em>-values to be combined. Missing values (NAs) will cause a missing value to be returned.
</p>
</td></tr>
<tr><td><code id="Asymptotically+2B20Exact+2B20Harmonic+2B20Mean+2B20p-Value_+3A_w">w</code></td>
<td>

<p>An optional numeric vector of weights that can be interpreted as incorporating information about prior model probabilities and power of the tests represented by the individual <em>p</em>-values. The sum of the weights cannot exceed one but may be less than one, which is interpreted as meaning that some of the <code>L</code> <em>p</em>-values have been excluded.
</p>
</td></tr>
<tr><td><code id="Asymptotically+2B20Exact+2B20Harmonic+2B20Mean+2B20p-Value_+3A_l">L</code></td>
<td>

<p>The number of constituent <em>p</em>-values. This is mandatory when using <code>p.hmp</code> as part of a multilevel test procedure and needs to be set equal to the total number of individual <em>p</em>-values investigated, which may be (much) larger than the length of the argument <code>p</code>. If ignored, it defaults to the length of argument <code>p</code>, with a warning.
</p>
</td></tr>
<tr><td><code id="Asymptotically+2B20Exact+2B20Harmonic+2B20Mean+2B20p-Value_+3A_w.sum.tolerance">w.sum.tolerance</code></td>
<td>

<p>Tolerance for checking that the weights do not exceed 1.
</p>
</td></tr>
<tr><td><code id="Asymptotically+2B20Exact+2B20Harmonic+2B20Mean+2B20p-Value_+3A_multilevel">multilevel</code></td>
<td>

<p>Logical, indicating whether the test is part of a multilevel procedure involving a total of <code>L</code> <em>p</em>-values intended to control the strong-sense familywise error rate (<code>TRUE</code>, default), or whether a stand-alone test is to be produced (<code>FALSE</code>), in which case <code>L</code> is ignored.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>When <code>multilevel==TRUE</code> an asymptotically exact combined <em>p</em>-value is returned, equivalent to <code>sum(w)*pharmonicmeanp(hmp.stat(p,w)/sum(w),L)</code>. This <em>p</em>-value can be compared against threshold <code>sum(w)*alpha</code> to control the strong-sense familywise error rate at level <code>alpha</code>. A test based on this asymptotically exact harmonic mean <em>p</em>-value is equivalent to comparison of the &lsquo;raw&rsquo; harmonic mean <em>p</em>-value calculated by <code>hmp.stat(p,w)</code> to a 'harmonic mean <em>p</em>-value threshold' <code>sum(w)*qharmonicmeanp(alpha,L)</code>.
</p>
<p>When <code>multilevel==FALSE</code> an asymptotically exact combined <em>p</em>-value is returned, equivalent to <code>pharmonicmeanp(hmp.stat(p,w),length(p))</code>. <code>L</code> is ignored and <code>w</code> is normalized to sum to 1. This <em>p</em>-value can be compared against threshold <code>alpha</code> to control the per-test error rate at level <code>alpha</code>. A test based on this asymptotically exact harmonic mean <em>p</em>-value is equivalent to comparison of the &lsquo;raw&rsquo; harmonic mean <em>p</em>-value calculated by <code>hmp.stat(p,w)</code> to a 'harmonic mean <em>p</em>-value threshold' <code>qharmonicmeanp(alpha,L)</code>.
</p>


<h3>Author(s)</h3>

<p>Daniel J. Wilson
</p>


<h3>References</h3>

<p>Daniel J. Wilson (2019) The harmonic mean <em>p</em>-value for combining dependent tests. <em>Proceedings of the National Academy of Sciences USA</em> 116: 1195-1200.
</p>


<h3>See Also</h3>

<p>hmp.stat
</p>


<h3>Examples</h3>

<pre><code class='language-R'># For detailed examples type vignette("harmonicmeanp")
# Example: simulate from a non-uniform distribution mildly enriched for small \emph{p}-values. 
# Compare the significance of the combined p-value for Bonferroni, Benjamini-Hochberg (i.e. Simes), 
# HMP and (equivalently) MAMML with 2 degrees of freedom.
L = 1000
p = rbeta(L,1/1.8,1)
min(p.adjust(p,"bonferroni"))
min(p.adjust(p,"BH"))
p.hmp(p,L=L)
p.mamml(1/p,2,L=L)

# Multilevel test: find significant subsets of the 1000 p-values by comparing overlapping
# subsets of size 100 and 10 in addition to the top-level test of all 1000, while maintaining
# the strong-sense family-wise error rate.
p.100 = sapply(seq(1,L-100,by=10),function(beg) p.hmp(p[beg+0:99],L=L))
plot(-log10(p.100),xlab="Test index",main="Moving average",
  ylab="Asymptotically exact combined -log10 p-value",type="o")
# The appropriate threshold is alpha (e.g. 0.05) times the proportion of tests in each p.100
abline(h=-log10(0.05*100/1000),col=2,lty=2)

p.10 = sapply(seq(1,L-10,by=5),function(beg) p.hmp(p[beg+0:9],L=L))
plot(-log10(p.10),xlab="Test index",main="Moving average",
  ylab="Asymptotically exact combined -log10 p-value",type="o")
# The appropriate threshold is alpha (e.g. 0.05) times the proportion of tests in each p.10
abline(h=-log10(0.05*10/1000),col=2,lty=2)
</code></pre>

<hr>
<h2 id='Compute+20the+20Harmonic+20Mean+20p-Value'>
Compute the Harmonic Mean <em>p</em>-Value
</h2><span id='topic+hmp.stat'></span>

<h3>Description</h3>

<p>The harmonic mean <em>p</em>-value (HMP) is defined as the inverse of the (possibly weighted) arithmetic mean of the inverse <em>p</em>-values. When the HMP is small (e.g. less than 0.05), it is approximately well-calibrated, meaning that it can be directly interpreted. However, the function p.hmp calculates an asymptotically exact <em>p</em>-value from the HMP and is preferred.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hmp.stat(p, w = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Compute+2B20the+2B20Harmonic+2B20Mean+2B20p-Value_+3A_p">p</code></td>
<td>

<p>A numeric vector of one or more <em>p</em>-values. Missing values (NAs) will cause a missing value to be returned.
</p>
</td></tr>
<tr><td><code id="Compute+2B20the+2B20Harmonic+2B20Mean+2B20p-Value_+3A_w">w</code></td>
<td>

<p>An optional numeric vector of weights that can be interpreted as prior model probabilities for each of the alternative hypotheses represented by the individual <em>p</em>-values. The sum of the weights cannot exceed one but may be less than one, which is interpreted as meaning that some <em>p</em>-values have been excluded.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The harmonic mean <em>p</em>-value is returned.
</p>


<h3>Author(s)</h3>

<p>Daniel J. Wilson
</p>


<h3>References</h3>

<p>Daniel J. Wilson (2019) The harmonic mean <em>p</em>-value for combining dependent tests. <em>Proceedings of the National Academy of Sciences USA</em> 116: 1195-1200.
</p>


<h3>See Also</h3>

<p>p.hmp
</p>


<h3>Examples</h3>

<pre><code class='language-R'># For detailed examples type vignette("harmonicmeanp")
p = rbeta(1000,1/1.5,1)
hmp.stat(p)
p.hmp(p,L=1000)
</code></pre>

<hr>
<h2 id='Compute+20the+20Model-Averaged+20Mean+20Maximized+20Likelihood'>
Compute the Model-Averaged Mean Maximized Likelihood
</h2><span id='topic+mamml.stat'></span>

<h3>Description</h3>

<p>The model-averaged mean maximized likelihood (MAMML) is defined as the (possibly weighted) arithmetic mean of the maximized likelihood ratios from a series of likelihood ratio tests comparing mutually exclusive alternative hypotheses with the same nested null hypothesis based on the exact same data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mamml.stat(R, w = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Compute+2B20the+2B20Model-Averaged+2B20Mean+2B20Maximized+2B20Likelihood_+3A_r">R</code></td>
<td>

<p>A numeric vector of one or more maximized likelihood ratios. Missing values (NAs) will cause a missing value to be returned.
</p>
</td></tr>
<tr><td><code id="Compute+2B20the+2B20Model-Averaged+2B20Mean+2B20Maximized+2B20Likelihood_+3A_w">w</code></td>
<td>

<p>An optional numeric vector of weights that can be interpreted as prior model probabilities for each of the alternative hypotheses represented by the individual <em>p</em>-values. The sum of the weights cannot exceed one but may be less than one, which is interpreted as meaning that some <em>p</em>-values have been excluded.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The model-averaged mean maximized likelihood ratio is returned.
</p>


<h3>Author(s)</h3>

<p>Daniel J. Wilson
</p>


<h3>References</h3>

<p>Daniel J. Wilson (2019) The harmonic mean <em>p</em>-value for combining dependent tests. <em>Proceedings of the National Academy of Sciences USA</em> 116: 1195-1200.
</p>


<h3>See Also</h3>

<p>p.mamml
</p>


<h3>Examples</h3>

<pre><code class='language-R'># For detailed examples type vignette("harmonicmeanp")
nu = 3
R = exp(0.5*rchisq(1000,nu))
mamml.stat(R)
p.mamml(R,nu,L=1000)
</code></pre>

<hr>
<h2 id='Harmonic+20Mean+20p-Value+20Asymptotic+20Distribution'>
The Harmonic Mean p-Value Asymptotic Distribution
</h2><span id='topic+dharmonicmeanp'></span><span id='topic+pharmonicmeanp'></span><span id='topic+qharmonicmeanp'></span><span id='topic+rharmonicmeanp'></span>

<h3>Description</h3>

<p>Density, distribution function, quantile function and random number generation for the harmonic mean of <em>L</em> <em>p</em>-values under their null hypotheses, i.e. the harmonic mean of <em>L</em> standard uniform random variables, assuming <em>L</em> is large.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dharmonicmeanp(x, L, log=FALSE)
pharmonicmeanp(x, L, log=FALSE, lower.tail=TRUE)
qharmonicmeanp(p, L, log=FALSE, lower.tail=TRUE)
rharmonicmeanp(n, L)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Harmonic+2B20Mean+2B20p-Value+2B20Asymptotic+2B20Distribution_+3A_x">x</code></td>
<td>

<p>The value or vector of values of the harmonic mean <em>p</em>-value, for example calculated from data using function <code>hmp.stat</code>.
</p>
</td></tr>
<tr><td><code id="Harmonic+2B20Mean+2B20p-Value+2B20Asymptotic+2B20Distribution_+3A_l">L</code></td>
<td>

<p>The number of constituent <em>p</em>-values used in calculating each value of x.
</p>
</td></tr>
<tr><td><code id="Harmonic+2B20Mean+2B20p-Value+2B20Asymptotic+2B20Distribution_+3A_log">log</code></td>
<td>

<p>If true the log probability is output.
</p>
</td></tr>
<tr><td><code id="Harmonic+2B20Mean+2B20p-Value+2B20Asymptotic+2B20Distribution_+3A_lower.tail">lower.tail</code></td>
<td>

<p>If true (the default) the lower tail probability is returned. Otherwise the upper tail probability.
</p>
</td></tr>
<tr><td><code id="Harmonic+2B20Mean+2B20p-Value+2B20Asymptotic+2B20Distribution_+3A_p">p</code></td>
<td>

<p>The value or vector of values, between 0 and 1, of the probability specifying the quantile for which to return the harmonic mean <em>p</em>-value.
</p>
</td></tr>
<tr><td><code id="Harmonic+2B20Mean+2B20p-Value+2B20Asymptotic+2B20Distribution_+3A_n">n</code></td>
<td>

<p>The number of values to simulate.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>dharmonicmeanp</code> produces the density, <code>pharmonicmeanp</code> the tail probability, <code>qharmonicmeanp</code> the quantile and <code>rharmonicmeanp</code> random variates for the harmonic mean of <em>L</em> <em>p</em>-values when their null hypotheses are true.
</p>
<p>Use <code>qharmonicmeanp(alpha,L)</code> to calculate <code class="reqn">\alpha_L</code>, the 'harmonic mean <em>p</em>-value threshold', as in Table 1 of Wilson (2019, corrected), where <code>L</code> is the total number of <em>p</em>-values under consideration and <code>alpha</code> is the intended strong-sense familywise error rate.
</p>


<h3>Author(s)</h3>

<p>Daniel J. Wilson
</p>


<h3>References</h3>

<p>Daniel J. Wilson (2019) The harmonic mean <em>p</em>-value for combining dependent tests. <em>Proceedings of the National Academy of Sciences USA</em> 116: 1195-1200.
</p>


<h3>See Also</h3>

<p>p.hmp
</p>


<h3>Examples</h3>

<pre><code class='language-R'># For a detailed tutorial type vignette("harmonicmeanp")
# Example: simulate from a non-uniform distribution mildly enriched for small \emph{p}-values. 
# Compare the significance of the combined p-value for Bonferroni, Benjamini-Hochberg (i.e. Simes), 
# HMP and (equivalently) MAMML with 2 degrees of freedom.
L = 1000
p = rbeta(L,1/1.5,1)
min(p.adjust(p,"bonferroni"))
min(p.adjust(p,"BH"))
x = hmp.stat(p)
pharmonicmeanp(x,length(p))
p.hmp(p,L=L)
p.mamml(1/p,2,L=L)

# Compute critical values for the HMP from asymptotic theory and compare to direct simulations
L = 100
alpha = 0.05
(hmp.crit = qharmonicmeanp(alpha,L))
nsim = 100000
p.direct = matrix(runif(L*nsim),nsim,L)
hmp.direct = apply(p.direct,1,hmp.stat)
(hmp.crit.sim = quantile(hmp.direct,alpha))

# Compare HMP of p-values simulated directly, and via the asymptotic distribution, 
# to the asymptotic density
L = 30
nsim = 10000
p.direct = matrix(runif(L*nsim),nsim,L)
hmp.direct = apply(p.direct,1,hmp.stat)
hmp.asympt = rharmonicmeanp(nsim,L)
h = hist(hmp.direct,60,col="green3",prob=TRUE,main="Distributions of harmonic mean p-values")
hist(hmp.asympt,c(-Inf,h$breaks,Inf),col="yellow2",prob=TRUE,add=TRUE)
hist(hmp.direct,60,col=NULL,prob=TRUE,add=TRUE)
curve(dharmonicmeanp(x,L),lwd=2,col="red3",add=TRUE)
legend("topright",c("Direct simulation","Asymptotic simulation","Asymptotic density"),
  fill=c("green3","yellow2",NA),col=c(NA,NA,"red3"),lwd=c(NA,NA,2),bty="n",border=c(1,1,NA))
</code></pre>

<hr>
<h2 id='harmonicmeanp'>
Harmonic mean p-values and model averaging by mean maximum likelihood
</h2><span id='topic+harmonicmeanp'></span><span id='topic+hmp'></span>

<h3>Description</h3>

<p>The harmonic mean <em>p</em>-value (HMP) test combines <em>p</em>-values and corrects for multiple testing while controlling the strong-sense family-wise error rate. It is more powerful than common alternatives including Bonferroni and Simes procedures when combining large proportions of all the <em>p</em>-values, at the cost of slightly lower power when combining small proportions of all the <em>p</em>-values. It is more stringent than controlling the false discovery rate, and possesses theoretical robustness to positive correlations between tests and unequal weights. It is a multi-level test in the sense that a superset of one or more significant tests is certain to be significant and conversely when the superset is non-significant, the constituent tests are certain to be non-significant. It is based on MAMML (model averaging by mean maximum likelihood), a frequentist analogue to Bayesian model averaging, and is theoretically grounded in generalized central limit theorem.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> harmonicmeanp</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 3.0</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2019-08-17</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-3</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>The key function is p.hmp for combining p-values using the HMP. Type vignette(&quot;harmonicmeanp&quot;) for detailed examples.
</p>


<h3>Author(s)</h3>

<p>Daniel J. Wilson
</p>
<p>Maintainer: Daniel Wilson &lt;hmp.R.package@gmail.com&gt;
</p>


<h3>References</h3>

<p>Daniel J. Wilson (2019) The harmonic mean <em>p</em>-value for combining dependent tests. <em>Proceedings of the National Academy of Sciences USA</em> 116: 1195-1200.
</p>


<h3>See Also</h3>

<p>Package FMStable
</p>


<h3>Examples</h3>

<pre><code class='language-R'># For detailed examples type vignette("harmonicmeanp")
# Example: simulate from a non-uniform distribution mildly enriched for small \emph{p}-values. 
# Compare the significance of the combined p-value for Bonferroni, Benjamini-Hochberg (i.e. Simes), 
# HMP and (equivalently) MAMML with 2 degrees of freedom.
p = rbeta(1000,1/1.5,1)
min(p.adjust(p,"bonferroni"))
min(p.adjust(p,"BH"))
p.hmp(p,L=1000)
p.mamml(1/p,2,L=1000)
</code></pre>

<hr>
<h2 id='Landau+20Distribution'>
The Landau Distribution
</h2><span id='topic+dLandau'></span><span id='topic+pLandau'></span><span id='topic+qLandau'></span><span id='topic+rLandau'></span>

<h3>Description</h3>

<p>Density, distribution function, quantile function and random number generation for the Landau distribution with location parameter mu and scale parameter sigma.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dLandau(x, mu=log(pi/2), sigma=pi/2, log=FALSE)
pLandau(x, mu=log(pi/2), sigma=pi/2, log=FALSE, lower.tail=TRUE)
qLandau(p, mu=log(pi/2), sigma=pi/2, log=FALSE, lower.tail=TRUE)
rLandau(n, mu=log(pi/2), sigma=pi/2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Landau+2B20Distribution_+3A_x">x</code></td>
<td>

<p>The value or vector of values of the Landau-distributed random variable.
</p>
</td></tr>
<tr><td><code id="Landau+2B20Distribution_+3A_mu">mu</code></td>
<td>

<p>The location parameter of the Landau distribution. Defaults to log(pi/2) to give Landau's original distribution.
</p>
</td></tr>
<tr><td><code id="Landau+2B20Distribution_+3A_sigma">sigma</code></td>
<td>

<p>The scale parameter of the Landau distribution. Defaults to pi/2 to give Landau's original distribution.
</p>
</td></tr>
<tr><td><code id="Landau+2B20Distribution_+3A_log">log</code></td>
<td>

<p>If true the log probability is output.
</p>
</td></tr>
<tr><td><code id="Landau+2B20Distribution_+3A_lower.tail">lower.tail</code></td>
<td>

<p>If true (the default) the lower tail probability is returned. Otherwise the upper tail probability.
</p>
</td></tr>
<tr><td><code id="Landau+2B20Distribution_+3A_p">p</code></td>
<td>

<p>The value or vector of values, between 0 and 1, of the probability specifying the quantile for which to return the Landau random variable <code>x</code>.
</p>
</td></tr>
<tr><td><code id="Landau+2B20Distribution_+3A_n">n</code></td>
<td>

<p>The number of values to simulate.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The density of the Landau distribution can be written
</p>
<p style="text-align: center;"><code class="reqn">f(x)=\frac{1}{\pi\,\sigma}\int_0^\infty \exp\left(-t\frac{(x-\mu)}{\sigma}-\frac{2}{\pi}t\log(t)\right)\,\sin\left(2t\right)\textrm{d}t</code>
</p>



<h3>Value</h3>

<p><code>dLandau</code> produces the density, <code>pLandau</code> the tail probability, <code>qLandau</code> the quantile and <code>rLandau</code> random variates for the Landau distribution.
</p>


<h3>Author(s)</h3>

<p>Daniel J. Wilson
</p>


<h3>References</h3>

<p>Landau LD (1944) On the energy loss of fast particles by ionization. <em>J Phys USSR</em> 8:201-205.
</p>
<p>Daniel J. Wilson (2019) The harmonic mean <em>p</em>-value for combining dependent tests. <em>Proceedings of the National Academy of Sciences USA</em> 116: 1195-1200.
</p>


<h3>See Also</h3>

<p>p.hmp
</p>


<h3>Examples</h3>

<pre><code class='language-R'># For detailed examples type vignette("harmonicmeanp")
# Example: simulate from a non-uniform distribution mildly enriched for small \emph{p}-values. 
# Compare the significance of the combined p-value for Bonferroni, Benjamini-Hochberg (i.e. Simes), 
# HMP and (equivalently) MAMML with 2 degrees of freedom.
L = 1000
p = rbeta(L,1/1.5,1)
min(p.adjust(p,"bonferroni"))
min(p.adjust(p,"BH"))
x = hmp.stat(p)
pLandau(1/x,log(length(p))+(1 + digamma(1) - log(2/pi)),pi/2,lower.tail=FALSE)
p.hmp(p,L=L)
p.mamml(1/p,2,L=L)
</code></pre>

<hr>
<h2 id='Model-Averaged+20Mean+20Maximized+20Likelihood+20Ratio+20Asymptotic+20Distribution'>
Model-Averaged Mean Maximized Likelihood Ratio Asymptotic Distribution
</h2><span id='topic+dmamml'></span><span id='topic+pmamml'></span><span id='topic+qmamml'></span><span id='topic+rmamml'></span>

<h3>Description</h3>

<p>Density, distribution function, quantile function and random number generation for the mean of <em>L</em> maximized likelihood ratios under their null hypotheses, i.e. the mean of <em>L</em> Pareto(1,1) variables, assuming <em>L</em> is large.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dmamml(x, L, df, log=FALSE)
pmamml(x, L, df, log=FALSE, lower.tail=TRUE)
qmamml(p, L, df, log=FALSE, lower.tail=TRUE, xmin=1+1e-12, xmax=1e12)
rmamml(n, L, df)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Model-Averaged+2B20Mean+2B20Maximized+2B20Likelihood+2B20Ratio+2B20Asymptotic+2B20Distribution_+3A_x">x</code></td>
<td>

<p>The value or vector of values of the mean maximized likelihood ratios, for example calculated from data using function <code>mamml.stat</code>.
</p>
</td></tr>
<tr><td><code id="Model-Averaged+2B20Mean+2B20Maximized+2B20Likelihood+2B20Ratio+2B20Asymptotic+2B20Distribution_+3A_l">L</code></td>
<td>

<p>The number of constituent likelihood ratios used in calculating each value of x.
</p>
</td></tr>
<tr><td><code id="Model-Averaged+2B20Mean+2B20Maximized+2B20Likelihood+2B20Ratio+2B20Asymptotic+2B20Distribution_+3A_df">df</code></td>
<td>

<p>Degrees of freedom of the constituent likelihood ratios, assumed all equal for each value of x.
</p>
</td></tr>
<tr><td><code id="Model-Averaged+2B20Mean+2B20Maximized+2B20Likelihood+2B20Ratio+2B20Asymptotic+2B20Distribution_+3A_log">log</code></td>
<td>

<p>If true the log probability is output.
</p>
</td></tr>
<tr><td><code id="Model-Averaged+2B20Mean+2B20Maximized+2B20Likelihood+2B20Ratio+2B20Asymptotic+2B20Distribution_+3A_lower.tail">lower.tail</code></td>
<td>

<p>If true (the default) the lower tail probability is returned. Otherwise the upper tail probability.
</p>
</td></tr>
<tr><td><code id="Model-Averaged+2B20Mean+2B20Maximized+2B20Likelihood+2B20Ratio+2B20Asymptotic+2B20Distribution_+3A_p">p</code></td>
<td>

<p>The value or vector of values, between 0 and 1, of the probability specifying the quantile for which to return the mean maximized likelihood ratio.
</p>
</td></tr>
<tr><td><code id="Model-Averaged+2B20Mean+2B20Maximized+2B20Likelihood+2B20Ratio+2B20Asymptotic+2B20Distribution_+3A_xmin">xmin</code>, <code id="Model-Averaged+2B20Mean+2B20Maximized+2B20Likelihood+2B20Ratio+2B20Asymptotic+2B20Distribution_+3A_xmax">xmax</code></td>
<td>

<p>The range of values of the mean maximized likelihood ratio over which to search for the quantile specified by <code>p</code>, used by the numerical root finding algorithm. Must bracket the solution.
</p>
</td></tr>
<tr><td><code id="Model-Averaged+2B20Mean+2B20Maximized+2B20Likelihood+2B20Ratio+2B20Asymptotic+2B20Distribution_+3A_n">n</code></td>
<td>

<p>The number of values to simulate.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>dmamml</code> produces the density, <code>pmamml</code> the tail probability, <code>qmamml</code> the quantile and <code>rmamml</code> random variates for the model-averaged mean maximized likelihood ratios when their null hypotheses are true.
</p>


<h3>Author(s)</h3>

<p>Daniel J. Wilson
</p>


<h3>References</h3>

<p>Daniel J. Wilson (2019) The harmonic mean <em>p</em>-value for combining dependent tests. <em>Proceedings of the National Academy of Sciences USA</em> 116: 1195-1200.
</p>


<h3>See Also</h3>

<p>p.hmp
</p>


<h3>Examples</h3>

<pre><code class='language-R'># For a detailed tutorial type vignette("harmonicmeanp")
# Example: simulate from a gamma distribution mildly enriched for large likelihood ratios.
# Compare the significance of the combined p-value for Bonferroni, Benjamini-Hochberg (i.e. Simes), 
# MAMML with 4 degrees of freedom.
L = 100
df = 4
enrich = 1.5
y = exp(0.5*rgamma(L,shape=df/2,rate=1/2/enrich))
p = pchisq(2*log(y),df,lower.tail=FALSE)
min(p.adjust(p,"bonferroni"))
min(p.adjust(p,"BH"))
(x = mamml.stat(y))
pmamml(x,L,df,lower.tail=FALSE)
p.mamml(y,df,L=L)
# Compare to the HMP - MAMML may act more conservatively because of adjustments for its
# poorer asymptotic approximation
x = hmp.stat(p)
p.hmp(p,L=L)

# Compute critical values for MAMML from asymptotic theory and compare to direct simulations
L = 100
df = 1
alpha = 0.05
(mamml.crit = qmamml(1-alpha,L,df))
nsim = 10000
y.direct = matrix(exp(0.5*rchisq(L*nsim,df)),nsim,L)
mamml.direct = apply(y.direct,1,mamml.stat)
# mamml.crit may be more conservative than mamml.crit.sim because of adjustments for its
# poorer asymptotic approximation
(mamml.crit.sim = quantile(mamml.direct,1-alpha))

# Compare MAMML simulated directly, and via the asymptotic distribution, to the asymptotic density
# Works best for df = 2
L = 30
df = 3
nsim = 1000
y.direct = matrix(exp(0.5*rchisq(L*nsim,df)),nsim,L)
mamml.direct = apply(y.direct,1,mamml.stat)
xmax = quantile(mamml.direct,.95)
h = hist(mamml.direct,c(-Inf,seq(0,xmax,len=60),Inf),col="green3",prob=TRUE,
  main="Distributions of MAMML",xlim=c(1,xmax))
# Slow because rmamml calls qmamml which uses numerical root finding
# mamml.asympt = rmamml(nsim,L,df)
# hist(mamml.asympt,c(-Inf,seq(0,xmax,len=60),Inf),col="yellow2",prob=TRUE,add=TRUE)
hist(mamml.direct,c(-Inf,seq(0,xmax,len=60),Inf),col=NULL,prob=TRUE,add=TRUE)
curve(dmamml(x,L,df),lwd=2,col="red3",add=TRUE)
legend("topright",c("Direct simulation","Asymptotic density"),
  fill=c("green3",NA),col=c(NA,"red3"),lwd=c(NA,2),bty="n",border=c(1,NA))
</code></pre>

<hr>
<h2 id='p.mamml'>
Compute a combined <em>p</em>-value via the model-averaged mean maximized likelihood ratio
</h2><span id='topic+p.mamml'></span>

<h3>Description</h3>

<p>The model averaging by mean maximum likelihood (MAMML) test combines likelihood ratio tests and corrects for multiple testing while controlling the weak-sense family-wise error rate in a way that is more powerful than common alternatives including Bonferroni and Simes procedures and possesses theoretical robustness to positive correlations between tests and unequal weights. It is a frequentist analogue to Bayesian model averaging, is theoretically grounded in generalized central limit theorem, and motivates the simpler and better-calibrated harmonic mean <em>p</em>-value (HMP) test. The model-averaged mean maximized likelihood (MAMML) is defined as the (possibly weighted) arithmetic mean of the maximized likelihood ratios from a series of likelihood ratio tests comparing mutually exclusive alternative hypotheses with the same nested null hypothesis based on the exact same data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>p.mamml(R, nu, w = NULL, L = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="p.mamml_+3A_r">R</code></td>
<td>

<p>A numeric vector of one or more maximized likelihood ratios. Missing values (NAs) will cause a missing value to be returned.
</p>
</td></tr>
<tr><td><code id="p.mamml_+3A_nu">nu</code></td>
<td>

<p>A numeric scalar or vector for the degrees of freedom corresponding to all or each of the maximized likelihood ratios respectively.
</p>
</td></tr>
<tr><td><code id="p.mamml_+3A_w">w</code></td>
<td>

<p>An optional numeric vector of weights that can be interpreted as prior model probabilities for each of the alternative hypotheses represented by the individual <em>p</em>-values. The sum of the weights cannot exceed one but may be less than one, which is interpreted as meaning that some <em>p</em>-values have been excluded.
</p>
</td></tr>
<tr><td><code id="p.mamml_+3A_l">L</code></td>
<td>

<p>The number of constituent maximized likelihood ratios. If ignored, it defaults to the length of argument <code>R</code>, with a warning.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The model-averaged mean maximized likelihood ratio is returned.
</p>


<h3>Author(s)</h3>

<p>Daniel J. Wilson
</p>


<h3>References</h3>

<p>Daniel J. Wilson (2019) The harmonic mean <em>p</em>-value for combining dependent tests. <em>Proceedings of the National Academy of Sciences USA</em> 116: 1195-1200.
</p>


<h3>See Also</h3>

<p>mamml.stat, hmp.stat, p.hmp
</p>


<h3>Examples</h3>

<pre><code class='language-R'># For detailed examples type vignette("harmonicmeanp")
nu = 3
R = exp(0.5*rchisq(1000,nu))
mamml.stat(R)
p.mamml(R,nu,L=1000)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
