<!DOCTYPE html><html lang="en"><head><title>Help for package multibridge</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {multibridge}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#.adjustUpperBoundForFreeParameters'><p>Adjusts Upper Bound For Free Parameters</p></a></li>
<li><a href='#.computeLengthOfRemainingStick'><p>Computes Length Of Remaining Stick</p></a></li>
<li><a href='#bayes_factor'><p>S3 method for class 'bayes_factor.bmult'</p></a></li>
<li><a href='#bayes_factor.bmult'><p>Extracts information about computed Bayes factors from object of class <code>bmult</code></p></a></li>
<li><a href='#binom_bf_equality'><p>Computes Bayes Factors For Equality Constrained Binomial Parameters</p></a></li>
<li><a href='#binom_bf_inequality'><p>Computes Bayes Factors For Inequality Constrained Independent Binomial Parameters</p></a></li>
<li><a href='#binom_bf_informed'><p>Evaluates Informed Hypotheses on Multiple Binomial Parameters</p></a></li>
<li><a href='#binom_tsampling'><p>Samples From Truncated Beta Densities</p></a></li>
<li><a href='#bridge_output'><p>S3 method for class <code>bridge_output.bmult</code></p></a></li>
<li><a href='#bridge_output.bmult'><p>Extracts bridge sampling output from object of class <code>bmult</code></p></a></li>
<li><a href='#generate_restriction_list'><p>Creates Restriction List Based On User Specified Informed Hypothesis</p></a></li>
<li><a href='#journals'><p>Prevalence of Statistical Reporting Errors</p></a></li>
<li><a href='#lifestresses'><p>Memory of Life Stresses</p></a></li>
<li><a href='#mult_bf_equality'><p>Computes Bayes Factors For Equality Constrained Multinomial Parameters</p></a></li>
<li><a href='#mult_bf_inequality'><p>Computes Bayes Factors For Inequality Constrained Multinomial Parameters</p></a></li>
<li><a href='#mult_bf_informed'><p>Evaluates Informed Hypotheses on Multinomial Parameters</p></a></li>
<li><a href='#mult_tsampling'><p>Samples From Truncated Dirichlet Density</p></a></li>
<li><a href='#peas'><p>Mendelian Laws of Inheritance</p></a></li>
<li><a href='#plot.summary.bmult'><p>Plot estimates</p></a></li>
<li><a href='#print.bmult'><p>print method for class <code>bmult</code></p></a></li>
<li><a href='#print.bmult_bridge'><p>Print method for class <code>bmult_bridge</code></p></a></li>
<li><a href='#print.summary.bmult'><p>print method for class <code>summary.bmult</code></p></a></li>
<li><a href='#print.summary.bmult_bridge'><p>print method for class <code>summary.bmult_bridge</code></p></a></li>
<li><a href='#restriction_list'><p>S3 method for class <code>restriction_list.bmult</code></p></a></li>
<li><a href='#restriction_list.bmult'><p>Extracts restriction list from an object of class <code>bmult</code></p></a></li>
<li><a href='#samples'><p>S3 method for class 'samples.bmult'</p></a></li>
<li><a href='#samples.bmult'><p>Extracts prior and posterior samples (if applicable) from an object of class <code>bmult</code></p></a></li>
<li><a href='#summary.bmult'><p>summary method for class <code>bmult</code></p></a></li>
<li><a href='#summary.bmult_bridge'><p>summary method for class <code>bmult_bridge</code></p></a></li>
<li><a href='#tbinom_backtrans'><p>Backtransforms Samples From Real Line To Beta Parameters</p></a></li>
<li><a href='#tbinom_trans'><p>Transforms Truncated Beta Samples To Real Line</p></a></li>
<li><a href='#tdir_backtrans'><p>Backtransforms Samples From Real Line To Dirichlet Parameters</p></a></li>
<li><a href='#tdir_trans'><p>Transforms Truncated Dirichlet Samples To Real Line</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Evaluating Multinomial Order Restrictions with Bridge Sampling</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-10-28</td>
</tr>
<tr>
<td>Description:</td>
<td>Evaluate hypotheses concerning the distribution of multinomial
  proportions using bridge sampling. The bridge sampling routine is able to
  compute Bayes factors for hypotheses that entail inequality constraints,
  equality constraints, free parameters, and mixtures of all three. These
  hypotheses are tested against the encompassing hypothesis, that all parameters
  vary freely or against the null hypothesis that all category proportions are equal.
  For more information see Sarafoglou et al. (2020) &lt;<a href="https://doi.org/10.31234%2Fosf.io%2Fbux7p">doi:10.31234/osf.io/bux7p</a>&gt;.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/asarafoglou/multibridge/">https://github.com/asarafoglou/multibridge/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/asarafoglou/multibridge/issues">https://github.com/asarafoglou/multibridge/issues</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Imports:</td>
<td>Brobdingnag, coda, mvtnorm, purrr, Rcpp (&ge; 0.12.17),
magrittr, progress, Rdpack, stringr</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>GNU make, mpfr (&gt;= 3.0.0), gmp (&gt;= 6.2.1_1)</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RdMacros:</td>
<td>Rdpack</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-10-28 15:43:48 UTC; alexandra.sarafoglougmail.com</td>
</tr>
<tr>
<td>Author:</td>
<td>Alexandra Sarafoglou
    <a href="https://orcid.org/0000-0003-0031-685X"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre],
  Frederik Aust <a href="https://orcid.org/0000-0003-4900-788X"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Julia M. Haaf <a href="https://orcid.org/0000-0001-5122-706X"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Joris Goosen [aut],
  Quentin F. Gronau [aut],
  Maarten Marsman <a href="https://orcid.org/0000-0001-5309-7502"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Alexandra Sarafoglou &lt;alexandra.sarafoglou@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-11-01 13:37:41 UTC</td>
</tr>
</table>
<hr>
<h2 id='.adjustUpperBoundForFreeParameters'>Adjusts Upper Bound For Free Parameters</h2><span id='topic+.adjustUpperBoundForFreeParameters'></span>

<h3>Description</h3>

<p>Corrects the upper bound for current parameter. This correction only applies for parameters that are free to vary within
the restriction. Then the length of the remaining stick must be based on the largest free parameter value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.adjustUpperBoundForFreeParameters(
  theta_mat,
  k,
  upper,
  nr_mult_equal,
  smaller_values,
  larger_values,
  hyp_direction
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".adjustUpperBoundForFreeParameters_+3A_theta_mat">theta_mat</code></td>
<td>
<p>matrix with samples from truncated Dirichlet density</p>
</td></tr>
<tr><td><code id=".adjustUpperBoundForFreeParameters_+3A_k">k</code></td>
<td>
<p>current parameter index</p>
</td></tr>
<tr><td><code id=".adjustUpperBoundForFreeParameters_+3A_upper">upper</code></td>
<td>
<p>current upper bound</p>
</td></tr>
<tr><td><code id=".adjustUpperBoundForFreeParameters_+3A_nr_mult_equal">nr_mult_equal</code></td>
<td>
<p>vector of multiplicative elements of collapsed parameters</p>
</td></tr>
<tr><td><code id=".adjustUpperBoundForFreeParameters_+3A_smaller_values">smaller_values</code></td>
<td>
<p>index of parameters that are smaller than the current one</p>
</td></tr>
<tr><td><code id=".adjustUpperBoundForFreeParameters_+3A_larger_values">larger_values</code></td>
<td>
<p>index of parameters that are larger than the current one</p>
</td></tr>
<tr><td><code id=".adjustUpperBoundForFreeParameters_+3A_hyp_direction">hyp_direction</code></td>
<td>
<p>specifies whether the imposed inequality constrained imposes an increasing (i.e., 'smaller') or
decreasing (i.e., 'larger') trend</p>
</td></tr>
</table>


<h3>Value</h3>

<p>adjusted upper bound
</p>

<hr>
<h2 id='.computeLengthOfRemainingStick'>Computes Length Of Remaining Stick</h2><span id='topic+.computeLengthOfRemainingStick'></span>

<h3>Description</h3>

<p>When applying the probit transformation on the Dirichlet samples, this function is used as part of the stick-breaking
algorithm. It computes the length of the remaining stick when the current element is broken off.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.computeLengthOfRemainingStick(theta_mat, k, hyp_direction)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".computeLengthOfRemainingStick_+3A_theta_mat">theta_mat</code></td>
<td>
<p>matrix with samples from truncated Dirichlet density</p>
</td></tr>
<tr><td><code id=".computeLengthOfRemainingStick_+3A_k">k</code></td>
<td>
<p>current parameter index</p>
</td></tr>
<tr><td><code id=".computeLengthOfRemainingStick_+3A_hyp_direction">hyp_direction</code></td>
<td>
<p>specifies whether the imposed inequality constrained imposes an increasing (i.e., 'smaller') or
decreasing (i.e., 'larger') trend</p>
</td></tr>
</table>


<h3>Value</h3>

<p>stick length
</p>

<hr>
<h2 id='bayes_factor'>S3 method for class 'bayes_factor.bmult'</h2><span id='topic+bayes_factor'></span>

<h3>Description</h3>

<p>Extracts information about computed Bayes factors from object of class <code>bmult</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bayes_factor(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bayes_factor_+3A_x">x</code></td>
<td>
<p>object of class <code>bmult</code> as returned from <code><a href="#topic+mult_bf_informed">mult_bf_informed</a></code> or <code><a href="#topic+binom_bf_informed">binom_bf_informed</a></code>
or an object of class <code>bmult_bridge</code> as returned from <code><a href="#topic+mult_bf_inequality">mult_bf_inequality</a></code> or <code><a href="#topic+binom_bf_inequality">binom_bf_inequality</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns <code>list</code> with three <code>data.frames</code>. The first dataframe <code>bf_table</code> summarizes information
the Bayes factor for equality and inequality constraints. The second dataframe <code>error_measures</code> contains for the overall Bayes factor
the approximate relative mean-squared error <code>re2</code>, the approximate coefficient of variation <code>cv</code>, and the approximate percentage error <code>percentage</code>.
The third dataframe <code>$bf_ineq_table</code> summarized
information about the Bayes factor for inequality constraints, that is, the log marginal likelihood estimates
for the constrained prior and posterior distribution. In addition, it contains for each independent Bayes factor
the approximate relative mean-squared error <code>re2</code>
</p>


<h3>Note</h3>

<p>In case the restricted hypothesis is tested against <code class="reqn">H_0</code> four <code>data.frame</code>s will be returned.
The fourth dataframe <code>$bf_eq_table</code> summarizes information about the Bayes factor for equality constraints compared to the encompassing
hypothesis.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># data
x &lt;- c(3, 4, 10, 11)
n &lt;- c(15, 12, 12, 12)
# priors
a &lt;- c(1, 1, 1, 1)
b &lt;- c(1, 1, 1, 1)
# informed hypothesis
factor_levels &lt;- c('theta1', 'theta2', 'theta3', 'theta4')
Hr            &lt;- c('theta1', '&lt;',  'theta2', '&lt;', 'theta3', '&lt;', 'theta4')

## Multinomial Case
out_mult  &lt;- mult_bf_informed(x=x, Hr=Hr, a=a, factor_levels=factor_levels,
niter=1e3, seed=2020)
bayes_factor(out_mult)
</code></pre>

<hr>
<h2 id='bayes_factor.bmult'>Extracts information about computed Bayes factors from object of class <code>bmult</code></h2><span id='topic+bayes_factor.bmult'></span>

<h3>Description</h3>

<p>Extracts information about computed Bayes factors from object of class <code>bmult</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bmult'
bayes_factor(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bayes_factor.bmult_+3A_x">x</code></td>
<td>
<p>object of class <code>bmult</code> as returned from <code><a href="#topic+mult_bf_informed">mult_bf_informed</a></code> or <code><a href="#topic+binom_bf_informed">binom_bf_informed</a></code>
or an object of class <code>bmult_bridge</code> as returned from <code><a href="#topic+mult_bf_inequality">mult_bf_inequality</a></code> or <code><a href="#topic+binom_bf_inequality">binom_bf_inequality</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns <code>list</code> with three <code>data.frames</code>. The first dataframe <code>bf_table</code> summarizes information
the Bayes factor for equality and inequality constraints. The second dataframe <code>error_measures</code> contains for the overall Bayes factor
the approximate relative mean-squared error <code>re2</code>, the approximate coefficient of variation <code>cv</code>, and the approximate percentage error <code>percentage</code>.
The third dataframe <code>$bf_ineq_table</code> summarized
information about the Bayes factor for inequality constraints, that is, the log marginal likelihood estimates
for the constrained prior and posterior distribution. In addition, it contains for each independent Bayes factor
the approximate relative mean-squared error <code>re2</code>
</p>


<h3>Note</h3>

<p>In case the restricted hypothesis is tested against <code class="reqn">H_0</code> four <code>data.frame</code>s will be returned.
The fourth dataframe <code>$bf_eq_table</code> summarizes information about the Bayes factor for equality constraints compared to the encompassing
hypothesis.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># data
x &lt;- c(3, 4, 10, 11)
n &lt;- c(15, 12, 12, 12)
# priors
a &lt;- c(1, 1, 1, 1)
b &lt;- c(1, 1, 1, 1)
# informed hypothesis
factor_levels &lt;- c('theta1', 'theta2', 'theta3', 'theta4')
Hr            &lt;- c('theta1', '&lt;',  'theta2', '&lt;', 'theta3', '&lt;', 'theta4')

## Multinomial Case
out_mult  &lt;- mult_bf_informed(x=x, Hr=Hr, a=a, factor_levels=factor_levels,
niter=1e3, seed=2020)
bayes_factor(out_mult)
</code></pre>

<hr>
<h2 id='binom_bf_equality'>Computes Bayes Factors For Equality Constrained Binomial Parameters</h2><span id='topic+binom_bf_equality'></span>

<h3>Description</h3>

<p>Computes Bayes factor for equality constrained binomial parameters.
Null hypothesis <code class="reqn">H_0</code> states that binomial proportions are exactly equal or
exactly equal and equal to <code>p</code>.
Alternative hypothesis <code class="reqn">H_e</code> states that binomial proportions are free to vary.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>binom_bf_equality(x, n = NULL, a, b, p = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="binom_bf_equality_+3A_x">x</code></td>
<td>
<p>a vector of counts of successes, or a two-dimensional table (or matrix) with 2 columns, giving the counts of successes
and failures, respectively</p>
</td></tr>
<tr><td><code id="binom_bf_equality_+3A_n">n</code></td>
<td>
<p>numeric. Vector of counts of trials. Must be the same length as <code>x</code>. Ignored if <code>x</code> is a matrix or a table</p>
</td></tr>
<tr><td><code id="binom_bf_equality_+3A_a">a</code></td>
<td>
<p>numeric. Vector with alpha parameters. Must be the same length as <code>x</code>. Default sets all alpha parameters to 1</p>
</td></tr>
<tr><td><code id="binom_bf_equality_+3A_b">b</code></td>
<td>
<p>numeric. Vector with beta parameters. Must be the same length as <code>x</code>. Default sets all beta parameters to 1</p>
</td></tr>
<tr><td><code id="binom_bf_equality_+3A_p">p</code></td>
<td>
<p>numeric. Hypothesized probability of success. Must be greater than 0 and less than 1.
Default sets all binomial proportions exactly equal without specifying a specific value.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The model assumes that the data in <code>x</code> (i.e., <code class="reqn">x_1, ..., x_K</code>) are the observations of <code class="reqn">K</code> independent
binomial experiments, based on <code class="reqn">n_1, ..., n_K</code> observations. Hence, the underlying likelihood is the product of the
<code class="reqn">k = 1, ..., K</code> individual binomial functions:
</p>
<p style="text-align: center;"><code class="reqn">(x_1, ... x_K) ~ \prod Binomial(N_k, \theta_k)</code>
</p>

<p>Furthermore, the model assigns a beta distribution as prior to each model parameter
(i.e., underlying binomial proportions). That is:
</p>
<p style="text-align: center;"><code class="reqn">\theta_k ~ Beta(\alpha_k, \beta_k)</code>
</p>



<h3>Value</h3>

<p>Returns a <code>data.frame</code> containing the Bayes factors <code>LogBFe0</code>, <code>BFe0</code>, and <code>BF0e</code>
</p>


<h3>Note</h3>

<p>The following signs can be used to encode restricted hypotheses: <code>"&lt;"</code> and <code>"&gt;"</code> for inequality constraints, <code>"="</code> for equality constraints,
<code>","</code> for free parameters, and <code>"&amp;"</code> for independent hypotheses. The restricted hypothesis can either be a string or a character vector.
For instance, the hypothesis <code>c("theta1 &lt; theta2, theta3")</code> means
</p>

<ul>
<li> <p><code>theta1</code> is smaller than both <code>theta2</code> and <code>theta3</code>
</p>
</li>
<li><p> The parameters <code>theta2</code> and <code>theta3</code> both have <code>theta1</code> as lower bound, but are not influenced by each other.
</p>
</li></ul>

<p>The hypothesis <code>c("theta1 &lt; theta2 = theta3 &amp; theta4 &gt; theta5")</code> means that
</p>

<ul>
<li><p> Two independent hypotheses are stipulated: <code>"theta1 &lt; theta2 = theta3"</code> and <code>"theta4 &gt; theta5"</code>
</p>
</li>
<li><p> The restrictions on the parameters <code>theta1</code>, <code>theta2</code>, and <code>theta3</code> do
not influence the restrictions on the parameters <code>theta4</code> and <code>theta5</code>.
</p>
</li>
<li> <p><code>theta1</code> is smaller than <code>theta2</code> and <code>theta3</code>
</p>
</li>
<li> <p><code>theta2</code> and <code>theta3</code> are assumed to be equal
</p>
</li>
<li> <p><code>theta4</code> is larger than <code>theta5</code>
</p>
</li></ul>



<h3>References</h3>

<p>Damien P, Walker SG (2001).
&ldquo;Sampling truncated normal, beta, and gamma densities.&rdquo;
<em>Journal of Computational and Graphical Statistics</em>, <b>10</b>, 206&ndash;215.
</p>
<p>Gronau QF, Sarafoglou A, Matzke D, Ly A, Boehm U, Marsman M, Leslie DS, Forster JJ, Wagenmakers E, Steingroever H (2017).
&ldquo;A tutorial on bridge sampling.&rdquo;
<em>Journal of Mathematical Psychology</em>, <b>81</b>, 80&ndash;97.
</p>
<p>Frühwirth-Schnatter S (2004).
&ldquo;Estimating marginal likelihoods for mixture and Markov switching models using bridge sampling techniques.&rdquo;
<em>The Econometrics Journal</em>, <b>7</b>, 143&ndash;167.
</p>
<p>Sarafoglou A, Haaf JM, Ly A, Gronau QF, Wagenmakers EJ, Marsman M (2021).
&ldquo;Evaluating Multinomial Order Restrictions with Bridge Sampling.&rdquo;
<em>Psychological Methods</em>.
</p>


<h3>See Also</h3>

<p>Other functions to evaluate informed hypotheses: 
<code><a href="#topic+binom_bf_inequality">binom_bf_inequality</a>()</code>,
<code><a href="#topic+binom_bf_informed">binom_bf_informed</a>()</code>,
<code><a href="#topic+mult_bf_equality">mult_bf_equality</a>()</code>,
<code><a href="#topic+mult_bf_inequality">mult_bf_inequality</a>()</code>,
<code><a href="#topic+mult_bf_informed">mult_bf_informed</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(journals)
x &lt;- journals$errors
n &lt;- journals$nr_NHST
a &lt;- rep(1, nrow(journals))
b &lt;- rep(1, nrow(journals))
binom_bf_equality(x=x, n=n, a=a, b=b)
</code></pre>

<hr>
<h2 id='binom_bf_inequality'>Computes Bayes Factors For Inequality Constrained Independent Binomial Parameters</h2><span id='topic+binom_bf_inequality'></span>

<h3>Description</h3>

<p>Computes Bayes factor for inequality constrained binomial parameters using a bridge sampling routine.
Restricted hypothesis <code class="reqn">H_r</code> states that binomial proportions follow a particular trend.
Alternative hypothesis <code class="reqn">H_e</code> states that binomial proportions are free to vary.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>binom_bf_inequality(
  samples = NULL,
  restrictions = NULL,
  x = NULL,
  n = NULL,
  Hr = NULL,
  a = rep(1, ncol(samples)),
  b = rep(1, ncol(samples)),
  factor_levels = NULL,
  prior = FALSE,
  index = 1,
  maxiter = 1000,
  seed = NULL,
  niter = 5000,
  nburnin = niter * 0.05
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="binom_bf_inequality_+3A_samples">samples</code></td>
<td>
<p>matrix of dimension (<code>nsamples x nparams</code>) with samples from truncated Dirichlet density</p>
</td></tr>
<tr><td><code id="binom_bf_inequality_+3A_restrictions">restrictions</code></td>
<td>
<p><code>list</code> of class <code>bmult_rl</code> or of class <code>bmult_rl_ineq</code> as returned from <code><a href="#topic+generate_restriction_list">generate_restriction_list</a></code> that encodes
inequality constraints for each independent restriction</p>
</td></tr>
<tr><td><code id="binom_bf_inequality_+3A_x">x</code></td>
<td>
<p>a vector of counts of successes, or a two-dimensional table (or matrix) with 2 columns, giving the counts of successes
and failures, respectively</p>
</td></tr>
<tr><td><code id="binom_bf_inequality_+3A_n">n</code></td>
<td>
<p>numeric. Vector of counts of trials. Must be the same length as <code>x</code>. Ignored if <code>x</code> is a matrix or a table</p>
</td></tr>
<tr><td><code id="binom_bf_inequality_+3A_hr">Hr</code></td>
<td>
<p>string or character. Encodes the user specified informed hypothesis. Use either specified <code>factor_levels</code>
or indices to refer to parameters. See &ldquo;Note&rdquo; section for details on how to formulate informed hypotheses</p>
</td></tr>
<tr><td><code id="binom_bf_inequality_+3A_a">a</code></td>
<td>
<p>numeric. Vector with alpha parameters. Must be the same length as <code>x</code>. Default sets all alpha parameters to 1</p>
</td></tr>
<tr><td><code id="binom_bf_inequality_+3A_b">b</code></td>
<td>
<p>numeric. Vector with beta parameters. Must be the same length as <code>x</code>. Default sets all beta parameters to 1</p>
</td></tr>
<tr><td><code id="binom_bf_inequality_+3A_factor_levels">factor_levels</code></td>
<td>
<p>character. Vector with category names. Must be the same length as <code>x</code></p>
</td></tr>
<tr><td><code id="binom_bf_inequality_+3A_prior">prior</code></td>
<td>
<p>logical. If <code>TRUE</code> the function will ignore the data and evaluate only the prior distribution</p>
</td></tr>
<tr><td><code id="binom_bf_inequality_+3A_index">index</code></td>
<td>
<p>numeric. Index of current restriction. Default is 1</p>
</td></tr>
<tr><td><code id="binom_bf_inequality_+3A_maxiter">maxiter</code></td>
<td>
<p>numeric. Maximum number of iterations for the iterative updating scheme used in the bridge sampling routine.
Default is 1,000 to avoid infinite loops</p>
</td></tr>
<tr><td><code id="binom_bf_inequality_+3A_seed">seed</code></td>
<td>
<p>numeric. Sets the seed for reproducible pseudo-random number generation</p>
</td></tr>
<tr><td><code id="binom_bf_inequality_+3A_niter">niter</code></td>
<td>
<p>numeric. Vector with number of samples to be drawn from truncated distribution</p>
</td></tr>
<tr><td><code id="binom_bf_inequality_+3A_nburnin">nburnin</code></td>
<td>
<p>numeric. A single value specifying the number of burn-in samples when drawing from the truncated distribution.
Minimum number of burn-in samples is 10. Default is 5% of the number of samples. Burn-in samples are removed automatically after the sampling.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The model assumes that the data in <code>x</code> (i.e., <code class="reqn">x_1, ..., x_K</code>) are the observations of <code class="reqn">K</code> independent
binomial experiments, based on <code class="reqn">n_1, ..., n_K</code> observations. Hence, the underlying likelihood is the product of the
<code class="reqn">k = 1, ..., K</code> individual binomial functions:
</p>
<p style="text-align: center;"><code class="reqn">(x_1, ... x_K) ~ \prod Binomial(N_k, \theta_k)</code>
</p>

<p>Furthermore, the model assigns a beta distribution as prior to each model parameter
(i.e., underlying binomial proportions). That is:
</p>
<p style="text-align: center;"><code class="reqn">\theta_k ~ Beta(\alpha_k, \beta_k)</code>
</p>



<h3>Value</h3>

<p>List consisting of the following elements:
</p>

<dl>
<dt><code>$eval</code></dt><dd>

<ul>
<li> <p><code>q11</code>: log prior or posterior evaluations for prior or posterior samples
</p>
</li>
<li> <p><code>q12</code>: log proposal evaluations for prior or posterior samples
</p>
</li>
<li> <p><code>q21</code>: log prior or posterior evaluations for samples from proposal
</p>
</li>
<li> <p><code>q22</code>: log proposal evaluations for samples from proposal
</p>
</li></ul>
</dd>
<dt><code>$niter</code></dt><dd><p>number of iterations of the iterative updating scheme</p>
</dd>
<dt><code>$logml</code></dt><dd><p>estimate of log marginal likelihood</p>
</dd>
<dt><code>$hyp</code></dt><dd><p>evaluated inequality constrained hypothesis</p>
</dd>
<dt><code>$error_measures</code></dt><dd>

<ul>
<li> <p><code>re2</code>: the approximate
relative mean-squared error for the marginal likelihood estimate
</p>
</li>
<li> <p><code>cv</code>: the approximate coefficient of variation for the marginal
likelihood estimate (assumes that bridge estimate is unbiased)
</p>
</li>
<li> <p><code>percentage</code>: the approximate percentage error of the marginal likelihood estimate
</p>
</li></ul>
</dd>
</dl>



<h3>Note</h3>

<p>The following signs can be used to encode restricted hypotheses: <code>"&lt;"</code> and <code>"&gt;"</code> for inequality constraints, <code>"="</code> for equality constraints,
<code>","</code> for free parameters, and <code>"&amp;"</code> for independent hypotheses. The restricted hypothesis can either be a string or a character vector.
For instance, the hypothesis <code>c("theta1 &lt; theta2, theta3")</code> means
</p>

<ul>
<li> <p><code>theta1</code> is smaller than both <code>theta2</code> and <code>theta3</code>
</p>
</li>
<li><p> The parameters <code>theta2</code> and <code>theta3</code> both have <code>theta1</code> as lower bound, but are not influenced by each other.
</p>
</li></ul>

<p>The hypothesis <code>c("theta1 &lt; theta2 = theta3 &amp; theta4 &gt; theta5")</code> means that
</p>

<ul>
<li><p> Two independent hypotheses are stipulated: <code>"theta1 &lt; theta2 = theta3"</code> and <code>"theta4 &gt; theta5"</code>
</p>
</li>
<li><p> The restrictions on the parameters <code>theta1</code>, <code>theta2</code>, and <code>theta3</code> do
not influence the restrictions on the parameters <code>theta4</code> and <code>theta5</code>.
</p>
</li>
<li> <p><code>theta1</code> is smaller than <code>theta2</code> and <code>theta3</code>
</p>
</li>
<li> <p><code>theta2</code> and <code>theta3</code> are assumed to be equal
</p>
</li>
<li> <p><code>theta4</code> is larger than <code>theta5</code>
</p>
</li></ul>



<h3>References</h3>

<p>Gronau QF, Sarafoglou A, Matzke D, Ly A, Boehm U, Marsman M, Leslie DS, Forster JJ, Wagenmakers E, Steingroever H (2017).
&ldquo;A tutorial on bridge sampling.&rdquo;
<em>Journal of Mathematical Psychology</em>, <b>81</b>, 80&ndash;97.
</p>
<p>Sarafoglou A, Haaf JM, Ly A, Gronau QF, Wagenmakers EJ, Marsman M (2021).
&ldquo;Evaluating Multinomial Order Restrictions with Bridge Sampling.&rdquo;
<em>Psychological Methods</em>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+generate_restriction_list">generate_restriction_list</a></code>
</p>
<p>Other functions to evaluate informed hypotheses: 
<code><a href="#topic+binom_bf_equality">binom_bf_equality</a>()</code>,
<code><a href="#topic+binom_bf_informed">binom_bf_informed</a>()</code>,
<code><a href="#topic+mult_bf_equality">mult_bf_equality</a>()</code>,
<code><a href="#topic+mult_bf_inequality">mult_bf_inequality</a>()</code>,
<code><a href="#topic+mult_bf_informed">mult_bf_informed</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># priors
a &lt;- c(1, 1, 1, 1)
b &lt;- c(1, 1, 1, 1)

# informed hypothesis
factor_levels &lt;- c('theta1', 'theta2', 'theta3', 'theta4')
Hr            &lt;- c('theta1', '&lt;',  'theta2', '&lt;', 'theta3', '&lt;', 'theta4')

results_prior  &lt;- binom_bf_inequality(Hr=Hr, a=a, b=b, 
factor_levels=factor_levels, prior=TRUE, seed = 2020)
# corresponds to
cbind(exp(results_prior$logml), 1/factorial(4))

# alternative - if you have samples and a restriction list
inequalities  &lt;- generate_restriction_list(Hr=Hr, a=a,b=b,
factor_levels=factor_levels)$inequality_constraints
prior_samples &lt;- binom_tsampling(inequalities, niter = 2e3, 
prior=TRUE, seed = 2020)
results_prior &lt;- binom_bf_inequality(prior_samples, inequalities, seed=2020)
cbind(exp(results_prior$logml), 1/factorial(4))

</code></pre>

<hr>
<h2 id='binom_bf_informed'>Evaluates Informed Hypotheses on Multiple Binomial Parameters</h2><span id='topic+binom_bf_informed'></span>

<h3>Description</h3>

<p>Evaluates informed hypotheses on multiple binomial parameters.
These hypotheses can contain (a mixture of) inequality constraints, equality constraints, and free parameters.
Informed hypothesis <code class="reqn">H_r</code> states that binomial proportions obey a particular constraint.
<code class="reqn">H_r</code> can be tested against the encompassing hypothesis <code class="reqn">H_e</code> or the null hypothesis <code class="reqn">H_0</code>.
Encompassing hypothesis <code class="reqn">H_e</code> states that binomial proportions are free to vary.
Null hypothesis <code class="reqn">H_0</code> states that category proportions are exactly equal.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>binom_bf_informed(
  x,
  n = NULL,
  Hr,
  a,
  b,
  factor_levels = NULL,
  cred_level = 0.95,
  niter = 5000,
  bf_type = "LogBFer",
  seed = NULL,
  maxiter = 1000,
  nburnin = niter * 0.05
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="binom_bf_informed_+3A_x">x</code></td>
<td>
<p>a vector of counts of successes, or a two-dimensional table (or matrix) with 2 columns, giving the counts of successes
and failures, respectively</p>
</td></tr>
<tr><td><code id="binom_bf_informed_+3A_n">n</code></td>
<td>
<p>numeric. Vector of counts of trials. Must be the same length as <code>x</code>. Ignored if <code>x</code> is a matrix or a table</p>
</td></tr>
<tr><td><code id="binom_bf_informed_+3A_hr">Hr</code></td>
<td>
<p>string or character. Encodes the user specified informed hypothesis. Use either specified <code>factor_levels</code>
or indices to refer to parameters. See &ldquo;Note&rdquo; section for details on how to formulate informed hypotheses</p>
</td></tr>
<tr><td><code id="binom_bf_informed_+3A_a">a</code></td>
<td>
<p>numeric. Vector with alpha parameters. Must be the same length as <code>x</code>. Default sets all alpha parameters to 1</p>
</td></tr>
<tr><td><code id="binom_bf_informed_+3A_b">b</code></td>
<td>
<p>numeric. Vector with beta parameters. Must be the same length as <code>x</code>. Default sets all beta parameters to 1</p>
</td></tr>
<tr><td><code id="binom_bf_informed_+3A_factor_levels">factor_levels</code></td>
<td>
<p>character. Vector with category names. Must be the same length as <code>x</code></p>
</td></tr>
<tr><td><code id="binom_bf_informed_+3A_cred_level">cred_level</code></td>
<td>
<p>numeric. Credible interval for the posterior point estimates. Must be a single number between 0 and 1</p>
</td></tr>
<tr><td><code id="binom_bf_informed_+3A_niter">niter</code></td>
<td>
<p>numeric. Vector with number of samples to be drawn from truncated distribution</p>
</td></tr>
<tr><td><code id="binom_bf_informed_+3A_bf_type">bf_type</code></td>
<td>
<p>character. The Bayes factor type. When the informed hypothesis is compared to the encompassing hypothesis,
the Bayes factor type can be <code>LogBFer</code>, <code>BFer</code>, or <code>BFre</code>. When the informed hypothesis is compared to the null hypothesis,
the Bayes factor type can be <code>LogBFr0</code>, <code>BF0r</code>, or <code>BFr0</code>. Default is <code>LogBFer</code></p>
</td></tr>
<tr><td><code id="binom_bf_informed_+3A_seed">seed</code></td>
<td>
<p>numeric. Sets the seed for reproducible pseudo-random number generation</p>
</td></tr>
<tr><td><code id="binom_bf_informed_+3A_maxiter">maxiter</code></td>
<td>
<p>numeric. Maximum number of iterations for the iterative updating scheme used in the bridge sampling routine.
Default is 1,000 to avoid infinite loops</p>
</td></tr>
<tr><td><code id="binom_bf_informed_+3A_nburnin">nburnin</code></td>
<td>
<p>numeric. A single value specifying the number of burn-in samples when drawing from the truncated distribution.
Minimum number of burn-in samples is 10. Default is 5% of the number of samples. Burn-in samples are removed automatically after the sampling.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The model assumes that the data in <code>x</code> (i.e., <code class="reqn">x_1, ..., x_K</code>) are the observations of <code class="reqn">K</code> independent
binomial experiments, based on <code class="reqn">n_1, ..., n_K</code> observations. Hence, the underlying likelihood is the product of the
<code class="reqn">k = 1, ..., K</code> individual binomial functions:
</p>
<p style="text-align: center;"><code class="reqn">(x_1, ... x_K) ~ \prod Binomial(N_k, \theta_k)</code>
</p>

<p>Furthermore, the model assigns a beta distribution as prior to each model parameter
(i.e., underlying binomial proportions). That is:
</p>
<p style="text-align: center;"><code class="reqn">\theta_k ~ Beta(\alpha_k, \beta_k)</code>
</p>



<h3>Value</h3>

<p>List consisting of the following elements
</p>

<dl>
<dt><code>$bf_list</code></dt><dd><p>gives an overview of the Bayes factor analysis:
</p>

<ul>
<li> <p><code>bf_type</code>: string. Contains Bayes factor type as specified by the user
</p>
</li>
<li> <p><code>bf</code>: data.frame. Contains Bayes factors for all Bayes factor types
</p>
</li>
<li> <p><code>error_measures</code>: data.frame. Contains for the overall Bayes factor
the approximate relative mean-squared error <code>re2</code>, the approximate coefficient of variation <code>cv</code>, and the approximate percentage error <code>percentage</code>
</p>
</li>
<li> <p><code>logBFe_equalities</code>: data.frame. Lists the log Bayes factors for all independent equality constrained hypotheses
</p>
</li>
<li> <p><code>logBFe_inequalities</code>: data.frame. Lists the log Bayes factor for all independent inequality constrained hypotheses
</p>
</li></ul>
</dd>
<dt><code>$cred_level</code></dt><dd><p>numeric. User specified credible interval</p>
</dd>
<dt><code>$restrictions</code></dt><dd><p>list that encodes informed hypothesis for each independent restriction:
</p>

<ul>
<li> <p><code>full_model</code>: list containing the hypothesis, parameter names, data and prior specifications for the full model.
</p>
</li>
<li> <p><code>equality_constraints</code>: list containing the hypothesis, parameter names, data and prior specifications for each equality constrained hypothesis.
</p>
</li>
<li> <p><code>inequality_constraints</code>: list containing the hypothesis, parameter names, data and prior specifications for each inequality constrained hypothesis.
In addition, in <code>nr_mult_equal</code> and <code>nr_mult_free</code> encodes which and how many parameters are
equality constraint or free, in <code>boundaries</code> includes the boundaries of each parameter, in <code>nineq_per_hyp</code> states the number of inequality constraint
parameters per independent inequality constrained hypothesis, and in <code>direction</code> states the direction of
the inequality constraint.
</p>
</li></ul>
</dd>
<dt><code>$bridge_output</code></dt><dd><p>list containing output from bridge sampling function:
</p>

<ul>
<li> <p><code>eval</code>: list containing the log prior or posterior evaluations
(<code>q11</code>) and the log proposal evaluations (<code>q12</code>) for the prior or posterior samples,
as well as the log prior or posterior evaluations (<code>q21</code>) and the log proposal evaluations (<code>q22</code>)
for the samples from the proposal distribution
</p>
</li>
<li> <p><code>niter</code>: number of iterations of the iterative updating scheme
</p>
</li>
<li> <p><code>logml</code>: estimate of log marginal likelihood
</p>
</li>
<li> <p><code>hyp</code>: evaluated inequality constrained hypothesis
</p>
</li>
<li> <p><code>error_measures</code>: list containing in <code>re2</code> the approximate
relative mean-squared error for the marginal likelihood estimate, in <code>cv</code> the approximate
coefficient of variation for the marginal likelihood estimate (assumes that bridge estimate is unbiased), and
in <code>percentage</code> the approximate percentage error of the marginal likelihood estimate
</p>
</li></ul>
</dd>
<dt><code>$samples</code></dt><dd><p>list containing a list for prior samples and a list
of posterior samples from truncated distributions which were used to evaluate inequality constraints.
Prior and posterior samples of independent inequality constraints are again saved
in separate lists. Samples are stored as matrix of dimension <code>nsamples x nparams</code>.</p>
</dd>
</dl>



<h3>Note</h3>

<p>The following signs can be used to encode restricted hypotheses: <code>"&lt;"</code> and <code>"&gt;"</code> for inequality constraints, <code>"="</code> for equality constraints,
<code>","</code> for free parameters, and <code>"&amp;"</code> for independent hypotheses. The restricted hypothesis can either be a string or a character vector.
For instance, the hypothesis <code>c("theta1 &lt; theta2, theta3")</code> means
</p>

<ul>
<li> <p><code>theta1</code> is smaller than both <code>theta2</code> and <code>theta3</code>
</p>
</li>
<li><p> The parameters <code>theta2</code> and <code>theta3</code> both have <code>theta1</code> as lower bound, but are not influenced by each other.
</p>
</li></ul>

<p>The hypothesis <code>c("theta1 &lt; theta2 = theta3 &amp; theta4 &gt; theta5")</code> means that
</p>

<ul>
<li><p> Two independent hypotheses are stipulated: <code>"theta1 &lt; theta2 = theta3"</code> and <code>"theta4 &gt; theta5"</code>
</p>
</li>
<li><p> The restrictions on the parameters <code>theta1</code>, <code>theta2</code>, and <code>theta3</code> do
not influence the restrictions on the parameters <code>theta4</code> and <code>theta5</code>.
</p>
</li>
<li> <p><code>theta1</code> is smaller than <code>theta2</code> and <code>theta3</code>
</p>
</li>
<li> <p><code>theta2</code> and <code>theta3</code> are assumed to be equal
</p>
</li>
<li> <p><code>theta4</code> is larger than <code>theta5</code>
</p>
</li></ul>



<h3>References</h3>

<p>Damien P, Walker SG (2001).
&ldquo;Sampling truncated normal, beta, and gamma densities.&rdquo;
<em>Journal of Computational and Graphical Statistics</em>, <b>10</b>, 206&ndash;215.
</p>
<p>Gronau QF, Sarafoglou A, Matzke D, Ly A, Boehm U, Marsman M, Leslie DS, Forster JJ, Wagenmakers E, Steingroever H (2017).
&ldquo;A tutorial on bridge sampling.&rdquo;
<em>Journal of Mathematical Psychology</em>, <b>81</b>, 80&ndash;97.
</p>
<p>Frühwirth-Schnatter S (2004).
&ldquo;Estimating marginal likelihoods for mixture and Markov switching models using bridge sampling techniques.&rdquo;
<em>The Econometrics Journal</em>, <b>7</b>, 143&ndash;167.
</p>
<p>Sarafoglou A, Haaf JM, Ly A, Gronau QF, Wagenmakers EJ, Marsman M (2021).
&ldquo;Evaluating Multinomial Order Restrictions with Bridge Sampling.&rdquo;
<em>Psychological Methods</em>.
</p>


<h3>See Also</h3>

<p>Other functions to evaluate informed hypotheses: 
<code><a href="#topic+binom_bf_equality">binom_bf_equality</a>()</code>,
<code><a href="#topic+binom_bf_inequality">binom_bf_inequality</a>()</code>,
<code><a href="#topic+mult_bf_equality">mult_bf_equality</a>()</code>,
<code><a href="#topic+mult_bf_inequality">mult_bf_inequality</a>()</code>,
<code><a href="#topic+mult_bf_informed">mult_bf_informed</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># data
x &lt;- c(3, 4, 10, 11)
n &lt;- c(15, 12, 12, 12)
# priors
a &lt;- c(1, 1, 1, 1)
b &lt;- c(1, 1, 1, 1)
# informed hypothesis
factor_levels &lt;- c('binom1', 'binom2', 'binom3', 'binom4')
Hr            &lt;- c('binom1', '&lt;',  'binom2', '&lt;', 'binom3', '&lt;', 'binom4')
output_total  &lt;- binom_bf_informed(x, n, Hr, a, b, niter=2e3, factor_levels, seed=2020)

</code></pre>

<hr>
<h2 id='binom_tsampling'>Samples From Truncated Beta Densities</h2><span id='topic+binom_tsampling'></span>

<h3>Description</h3>

<p>Based on specified inequality constraints, samples from truncated
prior or posterior beta densities.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>binom_tsampling(
  inequalities,
  index = 1,
  niter = 10000,
  prior = FALSE,
  nburnin = niter * 0.05,
  seed = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="binom_tsampling_+3A_inequalities">inequalities</code></td>
<td>
<p>list that contains inequality constraints for each independent inequality constrained hypotheses. The list
is created in the <code><a href="#topic+generate_restriction_list">generate_restriction_list</a></code> function</p>
</td></tr>
<tr><td><code id="binom_tsampling_+3A_index">index</code></td>
<td>
<p>numeric. If multiple independent inequality constraints are specified, this index determines for which
inequality constraint samples should be drawn. Must be a single value. Default is 1</p>
</td></tr>
<tr><td><code id="binom_tsampling_+3A_niter">niter</code></td>
<td>
<p>numeric. A single value specifying the number of samples. Default is set to <code class="reqn">10,000</code></p>
</td></tr>
<tr><td><code id="binom_tsampling_+3A_prior">prior</code></td>
<td>
<p>logical. If <code>TRUE</code> ignores the data that are encoded in <code>inequalities</code> and thus samples from the
prior distribution. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="binom_tsampling_+3A_nburnin">nburnin</code></td>
<td>
<p>numeric. A single value specifying the number of burn-in samples when drawing from the truncated distribution.
Minimum number of burn-in samples is 10. Default is 5% of the number of samples. Burn-in samples are removed automatically after the sampling.</p>
</td></tr>
<tr><td><code id="binom_tsampling_+3A_seed">seed</code></td>
<td>
<p>numeric. Sets the seed for reproducible pseudo-random number generation</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The model assumes that the data in <code>x</code> (i.e., <code class="reqn">x_1, ..., x_K</code>) are the observations of <code class="reqn">K</code> independent
binomial experiments, based on <code class="reqn">n_1, ..., n_K</code> observations. Hence, the underlying likelihood is the product of the
<code class="reqn">k = 1, ..., K</code> individual binomial functions:
</p>
<p style="text-align: center;"><code class="reqn">(x_1, ... x_K) ~ \prod Binomial(N_k, \theta_k)</code>
</p>

<p>Furthermore, the model assigns a beta distribution as prior to each model parameter
(i.e., underlying binomial proportions). That is:
</p>
<p style="text-align: center;"><code class="reqn">\theta_k ~ Beta(\alpha_k, \beta_k)</code>
</p>



<h3>Value</h3>

<p>matrix of dimension <code>niter * nsamples</code> containing samples from truncated beta distributions.
</p>


<h3>Note</h3>

<p>When equality constraints are specified in the restricted hypothesis, this function samples from the conditional
Beta distributions given that the equality constraints hold.
</p>
<p>Only inequality constrained parameters are sampled. Free parameters or parameters that are
exclusively equality constrained will be ignored.
</p>


<h3>References</h3>

<p>Damien P, Walker SG (2001).
&ldquo;Sampling truncated normal, beta, and gamma densities.&rdquo;
<em>Journal of Computational and Graphical Statistics</em>, <b>10</b>, 206&ndash;215.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+generate_restriction_list">generate_restriction_list</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- c(200, 130, 40, 10)
n &lt;- c(200, 200, 200, 200)
a &lt;- c(1, 1, 1, 1)
b &lt;- c(1, 1, 1, 1)
factor_levels &lt;- c('binom1', 'binom2', 'binom3', 'binom4')
Hr &lt;- c('binom1 &gt; binom2 &gt; binom3 &gt; binom4')

# generate restriction list
inequalities &lt;- generate_restriction_list(x=x, n=n, Hr=Hr, a=a, b=b, 
factor_levels=factor_levels)$inequality_constraints

# sample from prior distribution
prior_samples &lt;- binom_tsampling(inequalities, niter = 500, 
prior=TRUE)
# sample from posterior distribution
post_samples &lt;- binom_tsampling(inequalities, niter = 500)
</code></pre>

<hr>
<h2 id='bridge_output'>S3 method for class <code>bridge_output.bmult</code></h2><span id='topic+bridge_output'></span>

<h3>Description</h3>

<p>Extracts bridge sampling output from object of class <code>bmult</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bridge_output(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bridge_output_+3A_x">x</code></td>
<td>
<p>object of class <code>bmult</code> as returned from <code><a href="#topic+mult_bf_informed">mult_bf_informed</a></code> or <code><a href="#topic+binom_bf_informed">binom_bf_informed</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Extracts output related to the bridge sampling routine. The output contains the following elements::
</p>

<dl>
<dt><code>$eval</code></dt><dd>

<ul>
<li> <p><code>q11</code>: log prior or posterior evaluations for prior or posterior samples
</p>
</li>
<li> <p><code>q12</code>: log proposal evaluations for prior or posterior samples
</p>
</li>
<li> <p><code>q21</code>: log prior or posterior evaluations for samples from proposal
</p>
</li>
<li> <p><code>q22</code>: log proposal evaluations for samples from proposal
</p>
</li></ul>
</dd>
<dt><code>$niter</code></dt><dd><p>number of iterations of the iterative updating scheme</p>
</dd>
<dt><code>$logml</code></dt><dd><p>estimate of log marginal likelihood</p>
</dd>
<dt><code>$hyp</code></dt><dd><p>evaluated inequality constrained hypothesis</p>
</dd>
<dt><code>$error_measures</code></dt><dd>

<ul>
<li> <p><code>re2</code>: the approximate
relative mean-squared error for the marginal likelihood estimate
</p>
</li>
<li> <p><code>cv</code>: the approximate coefficient of variation for the marginal
likelihood estimate (assumes that bridge estimate is unbiased)
</p>
</li>
<li> <p><code>percentage</code>: the approximate percentage error of the marginal likelihood estimate
</p>
</li></ul>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'># data
x &lt;- c(3, 4, 10, 11)
n &lt;- c(15, 12, 12, 12)
# priors
a &lt;- c(1, 1, 1, 1)
b &lt;- c(1, 1, 1, 1)
# informed hypothesis
factor_levels &lt;- c('theta1', 'theta2', 'theta3', 'theta4')
Hr            &lt;- c('theta1', '&lt;',  'theta2', '&lt;', 'theta3', '&lt;', 'theta4')

## Multinomial Case
out_mult  &lt;- mult_bf_informed(x=x, Hr=Hr, a=a, factor_levels=factor_levels,
niter=1e3, seed=2020)
bridge_output &lt;- bridge_output(out_mult)
</code></pre>

<hr>
<h2 id='bridge_output.bmult'>Extracts bridge sampling output from object of class <code>bmult</code></h2><span id='topic+bridge_output.bmult'></span>

<h3>Description</h3>

<p>Extracts restriction list from an object of class <code>bmult</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bmult'
bridge_output(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bridge_output.bmult_+3A_x">x</code></td>
<td>
<p>object of class <code>bmult</code> as returned from <code><a href="#topic+mult_bf_informed">mult_bf_informed</a></code> or <code><a href="#topic+binom_bf_informed">binom_bf_informed</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Extracts restriction list and associated hypothesis from an object of class <code>bmult</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># data
x &lt;- c(3, 4, 10, 11)
n &lt;- c(15, 12, 12, 12)
# priors
a &lt;- c(1, 1, 1, 1)
b &lt;- c(1, 1, 1, 1)
# informed hypothesis
factor_levels &lt;- c('theta1', 'theta2', 'theta3', 'theta4')
Hr            &lt;- c('theta1', '&lt;',  'theta2', '&lt;', 'theta3', '&lt;', 'theta4')

## Multinomial Case
out_mult  &lt;- mult_bf_informed(x=x, Hr=Hr, a=a, factor_levels=factor_levels,
niter=1e3, seed=2020)
restriction_list &lt;- restriction_list(out_mult)
</code></pre>

<hr>
<h2 id='generate_restriction_list'>Creates Restriction List Based On User Specified Informed Hypothesis</h2><span id='topic+generate_restriction_list'></span>

<h3>Description</h3>

<p>Encodes the user specified informed hypothesis. It creates a separate restriction list
for the full model, and all independent equality and inequality constraints. The returned list features relevant
information for the transformation and sampling of the model parameters, such as information about the upper and
lower bound for each parameter, and the indexes of equality constrained and free parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>generate_restriction_list(x = NULL, n = NULL, Hr, a, b = NULL, factor_levels)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="generate_restriction_list_+3A_x">x</code></td>
<td>
<p>a vector with data (for multinomial models) or a vector of counts of successes, or a two-dimensional table
(or matrix) with 2 columns, giving the counts of successes and failures, respectively (for binomial models).</p>
</td></tr>
<tr><td><code id="generate_restriction_list_+3A_n">n</code></td>
<td>
<p>numeric. Vector of counts of trials. Must be the same length as <code>x</code>. Ignored if <code>x</code> is a matrix or a table</p>
</td></tr>
<tr><td><code id="generate_restriction_list_+3A_hr">Hr</code></td>
<td>
<p>string or character. Encodes the user specified informed hypothesis. Use either specified <code>factor_levels</code>
or indices to refer to parameters. See &ldquo;Note&rdquo; section for details on how to formulate informed hypotheses</p>
</td></tr>
<tr><td><code id="generate_restriction_list_+3A_a">a</code></td>
<td>
<p>numeric. Vector with concentration parameters of Dirichlet distribution (for multinomial models) or alpha
parameters for independent beta distributions (for binomial models). Default sets all parameters to 1</p>
</td></tr>
<tr><td><code id="generate_restriction_list_+3A_b">b</code></td>
<td>
<p>numeric. Vector with beta parameters. Must be the same length as <code>x</code>. Default sets all beta parameters to 1</p>
</td></tr>
<tr><td><code id="generate_restriction_list_+3A_factor_levels">factor_levels</code></td>
<td>
<p>character. Vector with category names. Must be the same length as <code>x</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The restriction list can be created for both binomial and multinomial models. If multinomial models are specified,
the arguments <code>b</code> and <code>n</code> should be left empty and <code>x</code> should not be a table or matrix.
</p>


<h3>Value</h3>

<p>Restriction list containing the following elements:
</p>

<dl>
<dt><code>$full_model</code></dt><dd>
<ul>
<li>  <p><code>hyp</code>: character. Vector containing the informed hypothesis as specified by the user
</p>
</li>
<li>  <p><code>parameters_full</code>: character. Vector containing the names for each constrained parameter
</p>
</li>
<li> <p><code>alpha_full</code>: numeric. Vector containing the concentration parameters
of the Dirichlet distribution (when evaluating ordered multinomial parameters) or alpha parameters of the
beta distribution (when evaluating ordered binomial parameters)
</p>
</li>
<li>  <p><code>beta_full</code>: numeric. Vector containing the values of beta parameters of the beta distribution
(when evaluating ordered binomial parameters)
</p>
</li>
<li>  <p><code>counts_full</code>: numeric. Vector containing data values (when evaluating multinomial parameters), or number
of successes (when evaluating ordered binomial parameters)
</p>
</li>
<li>  <p><code>total_full</code>: numeric. Vector containing the number of observations (when evaluating ordered binomial
parameters, that is, number of successes and failures)
</p>
</li></ul>
</dd>
<dt><code>$equality_constraints</code></dt><dd>
<ul>
<li>  <p><code>hyp</code>: list. Contains all independent equality constrained hypotheses
</p>
</li>
<li>  <p><code>parameters_equality</code>: character. Vector containing the names for each equality constrained parameter.
</p>
</li>
<li> <p><code>equality_hypotheses</code>: list. Contains the indexes of each equality constrained parameter. Note that these indices are based on the vector of all factor levels
</p>
</li>
<li>  <p><code>alpha_equalities</code>: list. Contains the concentration parameters for equality constrained hypotheses (when evaluating multinomial parameters) or alpha parameters of the
beta distribution (when evaluating ordered binomial parameters).
</p>
</li>
<li>  <p><code>beta_equalities</code>: list. Contains the values of beta parameters of the beta distribution (when evaluating ordered binomial parameters)
</p>
</li>
<li>  <p><code>counts_equalities</code>: list. Contains data values (when evaluating multinomial parameters), or number of successes
(when evaluating ordered binomial parameters) of each equality constrained parameter
</p>
</li>
<li>  <p><code>total_equalitiesl</code>: list. Contains the number of observations of each equality constrained parameter (when evaluating ordered binomial
parameters, that is, number of successes and failures)
</p>
</li></ul>
</dd>
<dt><code>$inequality_constraints</code></dt><dd>
<ul>
<li>  <p><code>hyp</code>: list. Contains all independent inequality constrained hypotheses
</p>
</li>
<li>  <p><code>parameters_inequality</code>: list. Contains the names for each inequality constrained parameter
</p>
</li>
<li> <p><code>inequality_hypotheses</code>: list. Contains the indices of each inequality constrained parameter
</p>
</li>
<li>  <p><code>alpha_inequalities</code>: list. Contains for inequality constrained hypotheses the concentration parameters
of the Dirichlet distribution (when evaluating ordered multinomial parameters) or alpha parameters of the beta distribution (when
evaluating ordered binomial parameters).
</p>
</li>
<li>  <p><code>beta_inequalities</code>: list. Contains for inequality constrained hypotheses the values of beta parameters of
the beta distribution (when evaluating ordered binomial parameters).
</p>
</li>
<li>  <p><code>counts_inequalities</code>: list. Contains for inequality constrained parameter data values (when evaluating
multinomial parameters), or number of successes (when evaluating ordered binomial parameters).
</p>
</li>
<li>  <p><code>total_inequalities</code>: list. Contains for each inequality constrained parameter the number of observations
(when evaluating ordered binomial parameters, that is, number of successes and failures).
</p>
</li>
<li>  <p><code>boundaries</code>: list that lists for each inequality constrained parameter the index of parameters that
serve as its upper and lower bounds. Note that these indices refer to the collapsed categories (i.e., categories after conditioning
for equality constraints). If a lower or upper bound is missing, for instance because the current parameter is set to be the
smallest or the largest, the bounds take the value <code>int(0)</code>.
</p>
</li>
<li>  <p><code>nr_mult_equal</code>: list. Contains multiplicative elements of collapsed categories
</p>
</li>
<li>  <p><code>nr_mult_free</code>: list. Contains multiplicative elements of free parameters
</p>
</li>
<li>  <p><code>mult_equal</code>: list. Contains for each lower and upper bound of each inequality constrained parameter
necessary multiplicative elements to recreate the implied order restriction, even for collapsed parameter values. If
there is no upper or lower bound, the multiplicative element will be 0.
</p>
</li>
<li>  <p><code>nineq_per_hyp</code>: numeric. Vector containing the total number of inequality constrained parameters
for each independent inequality constrained hypotheses.
</p>
</li>
<li>  <p><code>direction</code>: character. Vector containing the direction for each independent inequality constrained
hypothesis. Takes the values <code>smaller</code> or <code>larger</code>.
</p>
</li></ul>
</dd>
</dl>



<h3>Note</h3>

<p>The following signs can be used to encode restricted hypotheses: <code>"&lt;"</code> and <code>"&gt;"</code> for inequality constraints, <code>"="</code> for equality constraints,
<code>","</code> for free parameters, and <code>"&amp;"</code> for independent hypotheses. The restricted hypothesis can either be a string or a character vector.
For instance, the hypothesis <code>c("theta1 &lt; theta2, theta3")</code> means
</p>

<ul>
<li> <p><code>theta1</code> is smaller than both <code>theta2</code> and <code>theta3</code>
</p>
</li>
<li><p> The parameters <code>theta2</code> and <code>theta3</code> both have <code>theta1</code> as lower bound, but are not influenced by each other.
</p>
</li></ul>

<p>The hypothesis <code>c("theta1 &lt; theta2 = theta3 &amp; theta4 &gt; theta5")</code> means that
</p>

<ul>
<li><p> Two independent hypotheses are stipulated: <code>"theta1 &lt; theta2 = theta3"</code> and <code>"theta4 &gt; theta5"</code>
</p>
</li>
<li><p> The restrictions on the parameters <code>theta1</code>, <code>theta2</code>, and <code>theta3</code> do
not influence the restrictions on the parameters <code>theta4</code> and <code>theta5</code>.
</p>
</li>
<li> <p><code>theta1</code> is smaller than <code>theta2</code> and <code>theta3</code>
</p>
</li>
<li> <p><code>theta2</code> and <code>theta3</code> are assumed to be equal
</p>
</li>
<li> <p><code>theta4</code> is larger than <code>theta5</code>
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'># Restriction list for ordered multinomial
x &lt;- c(1, 4, 1, 10)
a &lt;- c(1, 1, 1, 1)
factor_levels &lt;- c('mult1', 'mult2', 'mult3', 'mult4')
Hr &lt;- c('mult2 &gt; mult1 , mult3 = mult4')
restrictions &lt;- generate_restriction_list(x=x, Hr=Hr, a=a, 
factor_levels=factor_levels)
</code></pre>

<hr>
<h2 id='journals'>Prevalence of Statistical Reporting Errors</h2><span id='topic+journals'></span>

<h3>Description</h3>

<p>This data set, &quot;journals&quot; provides a summary of statistical reporting errors (i.e., inconsistencies between reported test statistic
and reported p-value) of 16,695 research articles reporting results
from null hypothesis significance testing (NHST). The selected articles were published in
eight major journals in psychology between 1985 to 2013:
</p>

<ul>
<li> <p><em>Developmental Psychology</em> (DP)
</p>
</li>
<li> <p><em>Frontiers in Psychology</em> (FP)
</p>
</li>
<li> <p><em>Journal of Applied Psychology</em> (JAP)
</p>
</li>
<li> <p><em>Journal of Consulting and Clinical Psychology</em> (JCCP)
</p>
</li>
<li> <p><em>Journal of Experimental Psychology: General</em> (JEPG)
</p>
</li>
<li> <p><em>Journal of Personality and Social Psychology</em> (JPSP)
</p>
</li>
<li> <p><em>Public Library of Science</em> (PLoS)
</p>
</li>
<li> <p><em>Psychological Science</em> (PS)
</p>
</li></ul>

<p>In total, Nuijten et al. (2016) recomputed 258,105 p-values with the <code>R</code> software
package <code>statcheck</code> which extracts statistics from articles and recomputes the p-values.
The anonymized dataset and the data documentation was openly available on the
Open Science Framework (<a href="https://osf.io/d3ukb/">https://osf.io/d3ukb/</a>; <a href="https://osf.io/c6ap2/">https://osf.io/c6ap2/</a>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(journals)
</code></pre>


<h3>Format</h3>

<p>A <code>data.frame</code> with 8 rows and 14 variables:</p>

<table>
<tr>
 <td style="text-align: left;">
   Variable Name </td><td style="text-align: left;"> Description </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>journal</code> </td><td style="text-align: left;"> The journal name a research article was published in. </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>articles_downloaded</code> </td><td style="text-align: left;"> The number of articles downloaded per journal. </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>articles_with_NHST</code> </td><td style="text-align: left;"> The number of articles with NHST results. </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>perc_articles_with_NHST</code> </td><td style="text-align: left;"> The percentage of all downloaded articles that had NHST results. </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>nr_NHST</code> </td><td style="text-align: left;"> The total number of NHST results. </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>mean_nr_NHST_per_article_with_NHST</code> </td><td style="text-align: left;"> The mean number of NHST results per article that had at least one NHST result. </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>mean_nr_NHST_per_article_all_included</code> </td><td style="text-align: left;"> The mean number of NHST results in all downloaded articles. </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>errors</code> </td><td style="text-align: left;"> The total number of errors. </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>dec_errors</code> </td><td style="text-align: left;"> The total number of decision errors (i.e., an error that may have changed the statistical conclusion of the result). </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>perc_errors</code> </td><td style="text-align: left;"> The percentage of all results that was an error. </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>perc_dec_errors</code> </td><td style="text-align: left;"> The percentage of all results that was a decision error. </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>perc_articles_with_errors</code> </td><td style="text-align: left;"> The percentage of all articles that had at least one error. </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>perc_articles_with_dec_errors</code> </td><td style="text-align: left;"> The percentage of all articles that had at least one error. </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>APAfactor</code> </td><td style="text-align: left;"> APA factor: number of detected NHST results / total number of detected p values. </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>References</h3>

<p>Nuijten MB, Hartgerink CH, van Assen MA, Epskamp S, Wicherts JM (2016).
&ldquo;The prevalence of statistical reporting errors in psychology (1985&ndash;2013).&rdquo;
<em>Behavior Research Methods</em>, <b>48</b>, 1205&ndash;1226.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(journals)
# Prior specification 
# We assign a uniform Beta distribution on each binomial probability
a &lt;- rep(1, 8)  
b &lt;- rep(1, 8)  

x &lt;- journals$errors 
n  &lt;- journals$nr_NHST
factor_levels &lt;- levels(journals$journal)

# restricted hypothesis
Hr1 &lt;- c('JAP , PS , JCCP , PLOS , DP , FP , JEPG &lt; JPSP')
out &lt;- binom_bf_informed(x=x, n=n, Hr=Hr1, a=a, b=b, 
factor_levels=factor_levels, niter = 2e3)

summary(out)
</code></pre>

<hr>
<h2 id='lifestresses'>Memory of Life Stresses</h2><span id='topic+lifestresses'></span>

<h3>Description</h3>

<p>This data set, &quot;lifestresses&quot;, provides the number of reported life stresses (summed across participants)
that occurred in specific months prior to an interview. This data set contains the subset of 147 participants who
reported one negative life event over the time span of 18 months prior to an interview. Description taken from the JASP (2020)
data library.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(lifestresses)
</code></pre>


<h3>Format</h3>

<p>A <code>data.frame</code> with 18 rows and 3 variables:
</p>

<dl>
<dt><code>month</code></dt><dd><p>The month in which participants reported a stressful life event.</p>
</dd>
<dt><code>stress.freq</code></dt><dd><p>The number of participants who reported a life stress in the particular month prior to an interview.</p>
</dd>
<dt><code>stress.percentage</code></dt><dd><p>The percentage of participants who reported a life stress in the particular month prior to an interview.</p>
</dd>
</dl>



<h3>References</h3>

<p>Haberman SJ (1978).
<em>Analysis of qualitative data: Introductory topics</em>, volume 1.
Academic Press.
</p>
<p>JASP Team (2022).
&ldquo;JASP (Version 0.16.3.0) [Computer software].&rdquo;
<a href="https://jasp-stats.org/">https://jasp-stats.org/</a>.
</p>
<p>Sarafoglou A, Haaf JM, Ly A, Gronau QF, Wagenmakers EJ, Marsman M (2021).
&ldquo;Evaluating Multinomial Order Restrictions with Bridge Sampling.&rdquo;
<em>Psychological Methods</em>.
</p>
<p>Uhlenhuth EH, Haberman SJ, Balter MD, Lipman RS (1977).
&ldquo;Remembering life events.&rdquo;
In <em>The origins and course of psychopathology</em>, 117&ndash;134.
Springer Verlag.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(lifestresses)
# Prior specification 
# We assign a uniform Dirichlet distribution, that is, we set all 
# concentration parameters to 1
a             &lt;- rep(1, 18)
x             &lt;- lifestresses$stress.freq
factor_levels &lt;- lifestresses$month
# Test the following restricted Hypothesis:
# Hr: month1 &gt; month2 &gt; ... &gt; month18 
Hr            &lt;- paste0(1:18, collapse="&gt;"); Hr
out  &lt;- mult_bf_informed(x=x, Hr=Hr, a=a, factor_levels=factor_levels,
niter=1e3, bf_type = 'BFre', seed = 4)
m1 &lt;- summary(out)
m1
</code></pre>

<hr>
<h2 id='mult_bf_equality'>Computes Bayes Factors For Equality Constrained Multinomial Parameters</h2><span id='topic+mult_bf_equality'></span>

<h3>Description</h3>

<p>Computes Bayes factor for equality constrained multinomial parameters
using the standard Bayesian multinomial test.
Null hypothesis <code class="reqn">H_0</code> states that category proportions are exactly equal to those
specified in <code>p</code>.
Alternative hypothesis <code class="reqn">H_e</code> states that category proportions are free to vary.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mult_bf_equality(x, a, p = rep(1/length(a), length(a)))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mult_bf_equality_+3A_x">x</code></td>
<td>
<p>numeric. Vector with data</p>
</td></tr>
<tr><td><code id="mult_bf_equality_+3A_a">a</code></td>
<td>
<p>numeric. Vector with concentration parameters of Dirichlet distribution. Must be the same length as <code>x</code>. Default sets all concentration parameters to 1</p>
</td></tr>
<tr><td><code id="mult_bf_equality_+3A_p">p</code></td>
<td>
<p>numeric. A vector of probabilities of the same length as <code>x</code>.
Its elements must be greater than 0 and less than 1. Default is 1/K</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The model assumes that data follow a multinomial distribution and assigns a Dirichlet distribution as prior for the model parameters
(i.e., underlying category proportions). That is:
</p>
<p style="text-align: center;"><code class="reqn">x ~ Multinomial(N, \theta)</code>
</p>

<p style="text-align: center;"><code class="reqn">\theta ~ Dirichlet(\alpha)</code>
</p>



<h3>Value</h3>

<p>Returns a <code>data.frame</code> containing the Bayes factors <code>LogBFe0</code>, <code>BFe0</code>, and <code>BF0e</code>
</p>


<h3>Note</h3>

<p>The following signs can be used to encode restricted hypotheses: <code>"&lt;"</code> and <code>"&gt;"</code> for inequality constraints, <code>"="</code> for equality constraints,
<code>","</code> for free parameters, and <code>"&amp;"</code> for independent hypotheses. The restricted hypothesis can either be a string or a character vector.
For instance, the hypothesis <code>c("theta1 &lt; theta2, theta3")</code> means
</p>

<ul>
<li> <p><code>theta1</code> is smaller than both <code>theta2</code> and <code>theta3</code>
</p>
</li>
<li><p> The parameters <code>theta2</code> and <code>theta3</code> both have <code>theta1</code> as lower bound, but are not influenced by each other.
</p>
</li></ul>

<p>The hypothesis <code>c("theta1 &lt; theta2 = theta3 &amp; theta4 &gt; theta5")</code> means that
</p>

<ul>
<li><p> Two independent hypotheses are stipulated: <code>"theta1 &lt; theta2 = theta3"</code> and <code>"theta4 &gt; theta5"</code>
</p>
</li>
<li><p> The restrictions on the parameters <code>theta1</code>, <code>theta2</code>, and <code>theta3</code> do
not influence the restrictions on the parameters <code>theta4</code> and <code>theta5</code>.
</p>
</li>
<li> <p><code>theta1</code> is smaller than <code>theta2</code> and <code>theta3</code>
</p>
</li>
<li> <p><code>theta2</code> and <code>theta3</code> are assumed to be equal
</p>
</li>
<li> <p><code>theta4</code> is larger than <code>theta5</code>
</p>
</li></ul>



<h3>References</h3>

<p>Damien P, Walker SG (2001).
&ldquo;Sampling truncated normal, beta, and gamma densities.&rdquo;
<em>Journal of Computational and Graphical Statistics</em>, <b>10</b>, 206&ndash;215.
</p>
<p>Gronau QF, Sarafoglou A, Matzke D, Ly A, Boehm U, Marsman M, Leslie DS, Forster JJ, Wagenmakers E, Steingroever H (2017).
&ldquo;A tutorial on bridge sampling.&rdquo;
<em>Journal of Mathematical Psychology</em>, <b>81</b>, 80&ndash;97.
</p>
<p>Frühwirth-Schnatter S (2004).
&ldquo;Estimating marginal likelihoods for mixture and Markov switching models using bridge sampling techniques.&rdquo;
<em>The Econometrics Journal</em>, <b>7</b>, 143&ndash;167.
</p>
<p>Sarafoglou A, Haaf JM, Ly A, Gronau QF, Wagenmakers EJ, Marsman M (2021).
&ldquo;Evaluating Multinomial Order Restrictions with Bridge Sampling.&rdquo;
<em>Psychological Methods</em>.
</p>


<h3>See Also</h3>

<p>Other functions to evaluate informed hypotheses: 
<code><a href="#topic+binom_bf_equality">binom_bf_equality</a>()</code>,
<code><a href="#topic+binom_bf_inequality">binom_bf_inequality</a>()</code>,
<code><a href="#topic+binom_bf_informed">binom_bf_informed</a>()</code>,
<code><a href="#topic+mult_bf_inequality">mult_bf_inequality</a>()</code>,
<code><a href="#topic+mult_bf_informed">mult_bf_informed</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(lifestresses)
x &lt;- lifestresses$stress.freq
a &lt;- rep(1, nrow(lifestresses))
mult_bf_equality(x=x, a=a)
</code></pre>

<hr>
<h2 id='mult_bf_inequality'>Computes Bayes Factors For Inequality Constrained Multinomial Parameters</h2><span id='topic+mult_bf_inequality'></span>

<h3>Description</h3>

<p>Computes Bayes factor for inequality constrained multinomial parameters using a bridge sampling routine.
Restricted hypothesis <code class="reqn">H_r</code> states that category proportions follow a particular trend.
Alternative hypothesis <code class="reqn">H_e</code> states that category proportions are free to vary.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mult_bf_inequality(
  samples = NULL,
  restrictions = NULL,
  x = NULL,
  Hr = NULL,
  a = rep(1, ncol(samples)),
  factor_levels = NULL,
  prior = FALSE,
  index = 1,
  maxiter = 1000,
  seed = NULL,
  niter = 5000,
  nburnin = niter * 0.05
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mult_bf_inequality_+3A_samples">samples</code></td>
<td>
<p>matrix of dimension <code>nsamples x nparams</code> with samples from truncated Dirichlet density</p>
</td></tr>
<tr><td><code id="mult_bf_inequality_+3A_restrictions">restrictions</code></td>
<td>
<p><code>list</code> of class <code>bmult_rl</code> or of class <code>bmult_rl_ineq</code> as returned from <code><a href="#topic+generate_restriction_list">generate_restriction_list</a></code> that encodes
inequality constraints for each independent restriction</p>
</td></tr>
<tr><td><code id="mult_bf_inequality_+3A_x">x</code></td>
<td>
<p>numeric. Vector with data</p>
</td></tr>
<tr><td><code id="mult_bf_inequality_+3A_hr">Hr</code></td>
<td>
<p>string or character. Encodes the user specified informed hypothesis. Use either specified <code>factor_levels</code>
or indices to refer to parameters. See &ldquo;Note&rdquo; section for details on how to formulate informed hypotheses</p>
</td></tr>
<tr><td><code id="mult_bf_inequality_+3A_a">a</code></td>
<td>
<p>numeric. Vector with concentration parameters of Dirichlet distribution. Must be the same length as <code>x</code>. Default sets all concentration parameters to 1</p>
</td></tr>
<tr><td><code id="mult_bf_inequality_+3A_factor_levels">factor_levels</code></td>
<td>
<p>character. Vector with category names. Must be the same length as <code>x</code></p>
</td></tr>
<tr><td><code id="mult_bf_inequality_+3A_prior">prior</code></td>
<td>
<p>logical. If <code>TRUE</code> the function will ignore the data and evaluate only the prior distribution</p>
</td></tr>
<tr><td><code id="mult_bf_inequality_+3A_index">index</code></td>
<td>
<p>numeric. Index of current restriction. Default is 1</p>
</td></tr>
<tr><td><code id="mult_bf_inequality_+3A_maxiter">maxiter</code></td>
<td>
<p>numeric. Maximum number of iterations for the iterative updating scheme used in the bridge sampling routine.
Default is 1,000 to avoid infinite loops</p>
</td></tr>
<tr><td><code id="mult_bf_inequality_+3A_seed">seed</code></td>
<td>
<p>numeric. Sets the seed for reproducible pseudo-random number generation</p>
</td></tr>
<tr><td><code id="mult_bf_inequality_+3A_niter">niter</code></td>
<td>
<p>numeric. Vector with number of samples to be drawn from truncated distribution</p>
</td></tr>
<tr><td><code id="mult_bf_inequality_+3A_nburnin">nburnin</code></td>
<td>
<p>numeric. A single value specifying the number of burn-in samples when drawing from the truncated distribution.
Minimum number of burn-in samples is 10. Default is 5% of the number of samples. Burn-in samples are removed automatically after the sampling.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The model assumes that data follow a multinomial distribution and assigns a Dirichlet distribution as prior for the model parameters
(i.e., underlying category proportions). That is:
</p>
<p style="text-align: center;"><code class="reqn">x ~ Multinomial(N, \theta)</code>
</p>

<p style="text-align: center;"><code class="reqn">\theta ~ Dirichlet(\alpha)</code>
</p>



<h3>Value</h3>

<p>List consisting of the following elements:
</p>

<dl>
<dt><code>$eval</code></dt><dd>

<ul>
<li> <p><code>q11</code>: log prior or posterior evaluations for prior or posterior samples
</p>
</li>
<li> <p><code>q12</code>: log proposal evaluations for prior or posterior samples
</p>
</li>
<li> <p><code>q21</code>: log prior or posterior evaluations for samples from proposal
</p>
</li>
<li> <p><code>q22</code>: log proposal evaluations for samples from proposal
</p>
</li></ul>
</dd>
<dt><code>$niter</code></dt><dd><p>number of iterations of the iterative updating scheme</p>
</dd>
<dt><code>$logml</code></dt><dd><p>estimate of log marginal likelihood</p>
</dd>
<dt><code>$hyp</code></dt><dd><p>evaluated inequality constrained hypothesis</p>
</dd>
<dt><code>$error_measures</code></dt><dd>

<ul>
<li> <p><code>re2</code>: the approximate
relative mean-squared error for the marginal likelihood estimate
</p>
</li>
<li> <p><code>cv</code>: the approximate coefficient of variation for the marginal
likelihood estimate (assumes that bridge estimate is unbiased)
</p>
</li>
<li> <p><code>percentage</code>: the approximate percentage error of the marginal likelihood estimate
</p>
</li></ul>
</dd>
</dl>



<h3>Note</h3>

<p>The following signs can be used to encode restricted hypotheses: <code>"&lt;"</code> and <code>"&gt;"</code> for inequality constraints, <code>"="</code> for equality constraints,
<code>","</code> for free parameters, and <code>"&amp;"</code> for independent hypotheses. The restricted hypothesis can either be a string or a character vector.
For instance, the hypothesis <code>c("theta1 &lt; theta2, theta3")</code> means
</p>

<ul>
<li> <p><code>theta1</code> is smaller than both <code>theta2</code> and <code>theta3</code>
</p>
</li>
<li><p> The parameters <code>theta2</code> and <code>theta3</code> both have <code>theta1</code> as lower bound, but are not influenced by each other.
</p>
</li></ul>

<p>The hypothesis <code>c("theta1 &lt; theta2 = theta3 &amp; theta4 &gt; theta5")</code> means that
</p>

<ul>
<li><p> Two independent hypotheses are stipulated: <code>"theta1 &lt; theta2 = theta3"</code> and <code>"theta4 &gt; theta5"</code>
</p>
</li>
<li><p> The restrictions on the parameters <code>theta1</code>, <code>theta2</code>, and <code>theta3</code> do
not influence the restrictions on the parameters <code>theta4</code> and <code>theta5</code>.
</p>
</li>
<li> <p><code>theta1</code> is smaller than <code>theta2</code> and <code>theta3</code>
</p>
</li>
<li> <p><code>theta2</code> and <code>theta3</code> are assumed to be equal
</p>
</li>
<li> <p><code>theta4</code> is larger than <code>theta5</code>
</p>
</li></ul>



<h3>References</h3>

<p>Damien P, Walker SG (2001).
&ldquo;Sampling truncated normal, beta, and gamma densities.&rdquo;
<em>Journal of Computational and Graphical Statistics</em>, <b>10</b>, 206&ndash;215.
</p>
<p>Gronau QF, Sarafoglou A, Matzke D, Ly A, Boehm U, Marsman M, Leslie DS, Forster JJ, Wagenmakers E, Steingroever H (2017).
&ldquo;A tutorial on bridge sampling.&rdquo;
<em>Journal of Mathematical Psychology</em>, <b>81</b>, 80&ndash;97.
</p>
<p>Frühwirth-Schnatter S (2004).
&ldquo;Estimating marginal likelihoods for mixture and Markov switching models using bridge sampling techniques.&rdquo;
<em>The Econometrics Journal</em>, <b>7</b>, 143&ndash;167.
</p>
<p>Sarafoglou A, Haaf JM, Ly A, Gronau QF, Wagenmakers EJ, Marsman M (2021).
&ldquo;Evaluating Multinomial Order Restrictions with Bridge Sampling.&rdquo;
<em>Psychological Methods</em>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+generate_restriction_list">generate_restriction_list</a></code>
</p>
<p>Other functions to evaluate informed hypotheses: 
<code><a href="#topic+binom_bf_equality">binom_bf_equality</a>()</code>,
<code><a href="#topic+binom_bf_inequality">binom_bf_inequality</a>()</code>,
<code><a href="#topic+binom_bf_informed">binom_bf_informed</a>()</code>,
<code><a href="#topic+mult_bf_equality">mult_bf_equality</a>()</code>,
<code><a href="#topic+mult_bf_informed">mult_bf_informed</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># priors
a &lt;- c(1, 1, 1, 1)

# informed hypothesis
factor_levels &lt;- c('theta1', 'theta2', 'theta3', 'theta4')
Hr            &lt;- c('theta1', '&lt;',  'theta2', '&lt;', 'theta3', '&lt;', 'theta4')

results_prior  &lt;- mult_bf_inequality(Hr=Hr, a=a, factor_levels=factor_levels, 
prior=TRUE, seed = 2020)
# corresponds to
cbind(exp(results_prior$logml), 1/factorial(4))

# alternative - if you have samples and a restriction list
inequalities  &lt;- generate_restriction_list(Hr=Hr, a=a,
factor_levels=factor_levels)$inequality_constraints
prior_samples &lt;- mult_tsampling(inequalities, niter = 2e3, 
prior=TRUE, seed = 2020)
results_prior &lt;- mult_bf_inequality(prior_samples, inequalities, seed=2020)
cbind(exp(results_prior$logml), 1/factorial(4))
</code></pre>

<hr>
<h2 id='mult_bf_informed'>Evaluates Informed Hypotheses on Multinomial Parameters</h2><span id='topic+mult_bf_informed'></span>

<h3>Description</h3>

<p>Evaluates informed hypotheses on multinomial parameters. These hypotheses can contain
(a mixture of) inequality constraints, equality constraints, and free parameters.
Informed hypothesis <code class="reqn">H_r</code> states that category proportions obey the particular constraint.
<code class="reqn">H_r</code> can be tested against the encompassing hypothesis <code class="reqn">H_e</code> or the null hypothesis <code class="reqn">H_0</code>.
Encompassing hypothesis <code class="reqn">H_e</code> states that category proportions are free to vary.
Null hypothesis <code class="reqn">H_0</code> states that category proportions are exactly equal.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mult_bf_informed(
  x,
  Hr,
  a = rep(1, length(x)),
  factor_levels = NULL,
  cred_level = 0.95,
  niter = 5000,
  bf_type = "LogBFer",
  seed = NULL,
  maxiter = 1000,
  nburnin = niter * 0.05
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mult_bf_informed_+3A_x">x</code></td>
<td>
<p>numeric. Vector with data</p>
</td></tr>
<tr><td><code id="mult_bf_informed_+3A_hr">Hr</code></td>
<td>
<p>string or character. Encodes the user specified informed hypothesis. Use either specified <code>factor_levels</code>
or indices to refer to parameters. See &ldquo;Note&rdquo; section for details on how to formulate informed hypotheses</p>
</td></tr>
<tr><td><code id="mult_bf_informed_+3A_a">a</code></td>
<td>
<p>numeric. Vector with concentration parameters of Dirichlet distribution. Must be the same length as <code>x</code>. Default sets all concentration parameters to 1</p>
</td></tr>
<tr><td><code id="mult_bf_informed_+3A_factor_levels">factor_levels</code></td>
<td>
<p>character. Vector with category names. Must be the same length as <code>x</code></p>
</td></tr>
<tr><td><code id="mult_bf_informed_+3A_cred_level">cred_level</code></td>
<td>
<p>numeric. Credible interval for the posterior point estimates. Must be a single number between 0 and 1</p>
</td></tr>
<tr><td><code id="mult_bf_informed_+3A_niter">niter</code></td>
<td>
<p>numeric. Vector with number of samples to be drawn from truncated distribution</p>
</td></tr>
<tr><td><code id="mult_bf_informed_+3A_bf_type">bf_type</code></td>
<td>
<p>character. The Bayes factor type. When the informed hypothesis is compared to the encompassing hypothesis,
the Bayes factor type can be <code>LogBFer</code>, <code>BFer</code>, or <code>BFre</code>. When the informed hypothesis is compared to the null hypothesis,
the Bayes factor type can be <code>LogBFr0</code>, <code>BF0r</code>, or <code>BFr0</code>. Default is <code>LogBFer</code></p>
</td></tr>
<tr><td><code id="mult_bf_informed_+3A_seed">seed</code></td>
<td>
<p>numeric. Sets the seed for reproducible pseudo-random number generation</p>
</td></tr>
<tr><td><code id="mult_bf_informed_+3A_maxiter">maxiter</code></td>
<td>
<p>numeric. Maximum number of iterations for the iterative updating scheme used in the bridge sampling routine.
Default is 1,000 to avoid infinite loops</p>
</td></tr>
<tr><td><code id="mult_bf_informed_+3A_nburnin">nburnin</code></td>
<td>
<p>numeric. A single value specifying the number of burn-in samples when drawing from the truncated distribution.
Minimum number of burn-in samples is 10. Default is 5% of the number of samples. Burn-in samples are removed automatically after the sampling.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The model assumes that data follow a multinomial distribution and assigns a Dirichlet distribution as prior for the model parameters
(i.e., underlying category proportions). That is:
</p>
<p style="text-align: center;"><code class="reqn">x ~ Multinomial(N, \theta)</code>
</p>

<p style="text-align: center;"><code class="reqn">\theta ~ Dirichlet(\alpha)</code>
</p>



<h3>Value</h3>

<p>List consisting of the following elements
</p>

<dl>
<dt><code>$bf_list</code></dt><dd><p>gives an overview of the Bayes factor analysis:
</p>

<ul>
<li> <p><code>bf_type</code>: string. Contains Bayes factor type as specified by the user
</p>
</li>
<li> <p><code>bf</code>: data.frame. Contains Bayes factors for all Bayes factor types
</p>
</li>
<li> <p><code>error_measures</code>: data.frame. Contains for the overall Bayes factor
the approximate relative mean-squared error <code>re2</code>, the approximate coefficient of variation <code>cv</code>, and the approximate percentage error <code>percentage</code>
</p>
</li>
<li> <p><code>logBFe_equalities</code>: data.frame. Lists the log Bayes factors for all independent equality constrained hypotheses
</p>
</li>
<li> <p><code>logBFe_inequalities</code>: data.frame. Lists the log Bayes factor for all independent inequality constrained hypotheses
</p>
</li></ul>
</dd>
<dt><code>$cred_level</code></dt><dd><p>numeric. User specified credible interval</p>
</dd>
<dt><code>$restrictions</code></dt><dd><p>list that encodes informed hypothesis for each independent restriction:
</p>

<ul>
<li> <p><code>full_model</code>: list containing the hypothesis, parameter names, data and prior specifications for the full model.
</p>
</li>
<li> <p><code>equality_constraints</code>: list containing the hypothesis, parameter names, data and prior specifications for each equality constrained hypothesis.
</p>
</li>
<li> <p><code>inequality_constraints</code>: list containing the hypothesis, parameter names, data and prior specifications for each inequality constrained hypothesis.
In addition, in <code>nr_mult_equal</code> and <code>nr_mult_free</code> encodes which and how many parameters are
equality constraint or free, in <code>boundaries</code> includes the boundaries of each parameter, in <code>nineq_per_hyp</code> states the number of inequality constraint
parameters per independent inequality constrained hypothesis, and in <code>direction</code> states the direction of
the inequality constraint.
</p>
</li></ul>
</dd>
<dt><code>$bridge_output</code></dt><dd><p>list containing output from bridge sampling function:
</p>

<ul>
<li> <p><code>eval</code>: list containing the log prior or posterior evaluations
(<code>q11</code>) and the log proposal evaluations (<code>q12</code>) for the prior or posterior samples,
as well as the log prior or posterior evaluations (<code>q21</code>) and the log proposal evaluations (<code>q22</code>)
for the samples from the proposal distribution
</p>
</li>
<li> <p><code>niter</code>: number of iterations of the iterative updating scheme
</p>
</li>
<li> <p><code>logml</code>: estimate of log marginal likelihood
</p>
</li>
<li> <p><code>hyp</code>: evaluated inequality constrained hypothesis
</p>
</li>
<li> <p><code>error_measures</code>: list containing in <code>re2</code> the approximate
relative mean-squared error for the marginal likelihood estimate, in <code>cv</code> the approximate
coefficient of variation for the marginal likelihood estimate (assumes that bridge estimate is unbiased), and
in <code>percentage</code> the approximate percentage error of the marginal likelihood estimate
</p>
</li></ul>
</dd>
<dt><code>$samples</code></dt><dd><p>list containing a list for prior samples and a list
of posterior samples from truncated distributions which were used to evaluate inequality constraints.
Prior and posterior samples of independent inequality constraints are again saved
in separate lists. Samples are stored as matrix of dimension <code>nsamples x nparams</code>.</p>
</dd>
</dl>



<h3>Note</h3>

<p>The following signs can be used to encode restricted hypotheses: <code>"&lt;"</code> and <code>"&gt;"</code> for inequality constraints, <code>"="</code> for equality constraints,
<code>","</code> for free parameters, and <code>"&amp;"</code> for independent hypotheses. The restricted hypothesis can either be a string or a character vector.
For instance, the hypothesis <code>c("theta1 &lt; theta2, theta3")</code> means
</p>

<ul>
<li> <p><code>theta1</code> is smaller than both <code>theta2</code> and <code>theta3</code>
</p>
</li>
<li><p> The parameters <code>theta2</code> and <code>theta3</code> both have <code>theta1</code> as lower bound, but are not influenced by each other.
</p>
</li></ul>

<p>The hypothesis <code>c("theta1 &lt; theta2 = theta3 &amp; theta4 &gt; theta5")</code> means that
</p>

<ul>
<li><p> Two independent hypotheses are stipulated: <code>"theta1 &lt; theta2 = theta3"</code> and <code>"theta4 &gt; theta5"</code>
</p>
</li>
<li><p> The restrictions on the parameters <code>theta1</code>, <code>theta2</code>, and <code>theta3</code> do
not influence the restrictions on the parameters <code>theta4</code> and <code>theta5</code>.
</p>
</li>
<li> <p><code>theta1</code> is smaller than <code>theta2</code> and <code>theta3</code>
</p>
</li>
<li> <p><code>theta2</code> and <code>theta3</code> are assumed to be equal
</p>
</li>
<li> <p><code>theta4</code> is larger than <code>theta5</code>
</p>
</li></ul>



<h3>References</h3>

<p>Damien P, Walker SG (2001).
&ldquo;Sampling truncated normal, beta, and gamma densities.&rdquo;
<em>Journal of Computational and Graphical Statistics</em>, <b>10</b>, 206&ndash;215.
</p>
<p>Gronau QF, Sarafoglou A, Matzke D, Ly A, Boehm U, Marsman M, Leslie DS, Forster JJ, Wagenmakers E, Steingroever H (2017).
&ldquo;A tutorial on bridge sampling.&rdquo;
<em>Journal of Mathematical Psychology</em>, <b>81</b>, 80&ndash;97.
</p>
<p>Frühwirth-Schnatter S (2004).
&ldquo;Estimating marginal likelihoods for mixture and Markov switching models using bridge sampling techniques.&rdquo;
<em>The Econometrics Journal</em>, <b>7</b>, 143&ndash;167.
</p>
<p>Sarafoglou A, Haaf JM, Ly A, Gronau QF, Wagenmakers EJ, Marsman M (2021).
&ldquo;Evaluating Multinomial Order Restrictions with Bridge Sampling.&rdquo;
<em>Psychological Methods</em>.
</p>


<h3>See Also</h3>

<p>Other functions to evaluate informed hypotheses: 
<code><a href="#topic+binom_bf_equality">binom_bf_equality</a>()</code>,
<code><a href="#topic+binom_bf_inequality">binom_bf_inequality</a>()</code>,
<code><a href="#topic+binom_bf_informed">binom_bf_informed</a>()</code>,
<code><a href="#topic+mult_bf_equality">mult_bf_equality</a>()</code>,
<code><a href="#topic+mult_bf_inequality">mult_bf_inequality</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># data
x &lt;- c(3, 4, 10, 11, 7, 30)
# priors
a &lt;- c(1, 1, 1, 1, 1, 1)
# restricted hypothesis
factor_levels &lt;- c('theta1', 'theta2', 'theta3', 'theta4', 'theta5', 
'theta6')
Hr            &lt;- c('theta1', '&lt;',  'theta2', '&amp;', 'theta3', '=', 'theta4', 
',', 'theta5', '&lt;', 'theta6')
output_total  &lt;- mult_bf_informed(x, Hr, a, factor_levels, seed=2020, niter=2e3)

</code></pre>

<hr>
<h2 id='mult_tsampling'>Samples From Truncated Dirichlet Density</h2><span id='topic+mult_tsampling'></span>

<h3>Description</h3>

<p>Based on specified inequality constraints, samples from truncated
prior or posterior Dirichlet density.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mult_tsampling(
  inequalities,
  index = 1,
  niter = 10000,
  prior = FALSE,
  nburnin = niter * 0.05,
  seed = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mult_tsampling_+3A_inequalities">inequalities</code></td>
<td>
<p>list that contains inequality constraints for each independent inequality constrained hypotheses. The list
is created in the <code><a href="#topic+generate_restriction_list">generate_restriction_list</a></code> function</p>
</td></tr>
<tr><td><code id="mult_tsampling_+3A_index">index</code></td>
<td>
<p>numeric. If multiple independent inequality constraints are specified, this index determines for which
inequality constraint samples should be drawn. Must be a single value. Default is 1</p>
</td></tr>
<tr><td><code id="mult_tsampling_+3A_niter">niter</code></td>
<td>
<p>numeric. A single value specifying the number of samples. Default is set to <code class="reqn">10,000</code></p>
</td></tr>
<tr><td><code id="mult_tsampling_+3A_prior">prior</code></td>
<td>
<p>logical. If <code>TRUE</code> ignores the data that are encoded in <code>inequalities</code> and thus samples from the
prior distribution. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="mult_tsampling_+3A_nburnin">nburnin</code></td>
<td>
<p>numeric. A single value specifying the number of burn-in samples when drawing from the truncated distribution.
Minimum number of burn-in samples is 10. Default is 5% of the number of samples. Burn-in samples are removed automatically after the sampling.</p>
</td></tr>
<tr><td><code id="mult_tsampling_+3A_seed">seed</code></td>
<td>
<p>numeric. Sets the seed for reproducible pseudo-random number generation</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The model assumes that data follow a multinomial distribution and assigns a Dirichlet distribution as prior for the model parameters
(i.e., underlying category proportions). That is:
</p>
<p style="text-align: center;"><code class="reqn">x ~ Multinomial(N, \theta)</code>
</p>

<p style="text-align: center;"><code class="reqn">\theta ~ Dirichlet(\alpha)</code>
</p>



<h3>Value</h3>

<p>matrix of dimension <code>niter * nsamples</code> containing prior or posterior samples from truncated Dirichlet distribution.
</p>


<h3>Note</h3>

<p>When equality constraints are specified in the restricted hypothesis, this function samples from the conditional
Dirichlet distribution given that the equality constraints hold.
</p>
<p>Only inequality constrained parameters are sampled. Free parameters or parameters that are
exclusively equality constrained will be ignored.
</p>


<h3>References</h3>

<p>Damien P, Walker SG (2001).
&ldquo;Sampling truncated normal, beta, and gamma densities.&rdquo;
<em>Journal of Computational and Graphical Statistics</em>, <b>10</b>, 206&ndash;215.
</p>
<p>Sarafoglou A, Haaf JM, Ly A, Gronau QF, Wagenmakers EJ, Marsman M (2021).
&ldquo;Evaluating Multinomial Order Restrictions with Bridge Sampling.&rdquo;
<em>Psychological Methods</em>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+generate_restriction_list">generate_restriction_list</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- c(200, 130, 40, 10)
a &lt;- c(1, 1, 1, 1)
factor_levels &lt;- c('mult1', 'mult2', 'mult3', 'mult4')
Hr &lt;- c('mult1 &gt; mult2 &gt; mult3 &gt; mult4')

# generate restriction list
inequalities &lt;- generate_restriction_list(x=x, Hr=Hr, a=a, 
factor_levels=factor_levels)$inequality_constraints

# sample from prior distribution
prior_samples &lt;- mult_tsampling(inequalities, niter = 500, prior=TRUE)
# sample from posterior distribution
post_samples &lt;- mult_tsampling(inequalities, niter = 500)
</code></pre>

<hr>
<h2 id='peas'>Mendelian Laws of Inheritance</h2><span id='topic+peas'></span>

<h3>Description</h3>

<p>This data set, &quot;peas&quot;, provides the categorization of crossbreeds between a plant variety that produced
round yellow peas with a plant variety that produced wrinkled green peas. This data set contains the categorization
of 556 plants that were categorized either as (1) round and yellow, (2) wrinkled and yellow, (3) round and green,
or (4) wrinkled and green.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(peas)
</code></pre>


<h3>Format</h3>

<p>A <code>data.frame</code> with 4 rows and 2 variables:
</p>

<dl>
<dt><code>peas</code></dt><dd><p>Crossbreeds that are categorized as 'roundYellow', 'wrinkledYellow', 'roundGreen', or 'wrinkledGreen'.</p>
</dd>
<dt><code>counts</code></dt><dd><p>The number of plants assigned to a one of the crossbreed categories.</p>
</dd>
</dl>



<h3>References</h3>

<p>Mulder J, Wagenmakers E, Marsman M (in press).
&ldquo;A Generalization of the Savage-Dickey Density Ratio for Testing Equality and Order Constrained Hypotheses.&rdquo;
<em>The American Statistician</em>.
</p>
<p>Robertson T (1978).
&ldquo;Testing for and against an order restriction on multinomial parameters.&rdquo;
<em>Journal of the American Statistical Association</em>, <b>73</b>, 197&ndash;202.
</p>
<p>Sarafoglou A, Haaf JM, Ly A, Gronau QF, Wagenmakers EJ, Marsman M (2021).
&ldquo;Evaluating Multinomial Order Restrictions with Bridge Sampling.&rdquo;
<em>Psychological Methods</em>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("peas")
# Prior specification 
# We assign a uniform Dirichlet distribution, that is, we set all 
# concentration parameters to 1
a &lt;- c(1, 1, 1, 1)     

x &lt;- peas$counts
factor_levels &lt;- levels(peas$peas)
# Test the following mixed Hypothesis:
# Hr: roundYellow &gt; wrinkledYellow = roundGreen &gt; wrinkledGreen 
#
# Be careful: Factor levels are usually ordered alphabetically!
# When specifying hypotheses using indexes, make sure they refer to the 
# correct factor levels.
Hr &lt;- c('1 &gt; 2 = 3 &gt; 4') 
# To avoid mistakes, write out factor levels explicitly:
Hr &lt;- c('roundYellow &gt; wrinkledYellow = roundGreen &gt; wrinkledGreen')

out &lt;- mult_bf_informed(x=x, Hr=Hr, a=a, factor_levels=factor_levels, niter=2e3,
bf_type = 'BFre')
summary(out)
</code></pre>

<hr>
<h2 id='plot.summary.bmult'>Plot estimates</h2><span id='topic+plot.summary.bmult'></span>

<h3>Description</h3>

<p>Plots the posterior estimates from the unconstrained multi- or binomial model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.bmult'
plot(
  x,
  main = NULL,
  xlab = NULL,
  ylab = NULL,
  xlim = NULL,
  ylim = NULL,
  panel.first = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.summary.bmult_+3A_x">x</code></td>
<td>
<p>A <code>summary.bmult</code>-object returned by <code>summary()</code>.</p>
</td></tr>
<tr><td><code id="plot.summary.bmult_+3A_main">main</code></td>
<td>
<p><code>character</code>. A string used as title. Defaults to the informed
hypothesis and the Bayes factor.</p>
</td></tr>
<tr><td><code id="plot.summary.bmult_+3A_xlab">xlab</code></td>
<td>
<p><code>character</code>. A string used as title for the x-axis.</p>
</td></tr>
<tr><td><code id="plot.summary.bmult_+3A_ylab">ylab</code></td>
<td>
<p><code>character</code>. A string used as title for the y-axis.</p>
</td></tr>
<tr><td><code id="plot.summary.bmult_+3A_xlim">xlim</code>, <code id="plot.summary.bmult_+3A_ylim">ylim</code></td>
<td>
<p>numeric vectors of length 2, giving the x and y
coordinates ranges.</p>
</td></tr>
<tr><td><code id="plot.summary.bmult_+3A_panel.first">panel.first</code></td>
<td>
<p><code>expression</code>. Evaluated after the plot axes are set up but
before any plotting takes place. This can be useful for drawing background
grids or null distributions.</p>
</td></tr>
<tr><td><code id="plot.summary.bmult_+3A_...">...</code></td>
<td>
<p>additional arguments passed to <code>plot.summary.bmult</code>-method.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Invisibly returns a <code>data.frame</code> with the plotted estimates.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># data
x &lt;- c(3, 4, 10, 11, 7, 30)
# priors
a &lt;- c(1, 1, 1, 1, 1, 1)
# restricted hypothesis
factor_levels &lt;- c('theta1', 'theta2', 'theta3', 'theta4', 'theta5', 
                   'theta6')
Hr &lt;- c('theta1', '&lt;',  'theta2', '&amp;', 'theta3', '=', 
'theta4', ',', 'theta5', '&lt;', 'theta6')
output_total  &lt;- mult_bf_informed(x, Hr, a, factor_levels, seed=2020, 
niter=1e3, bf_type = "BFer")
plot(summary(output_total))

# data for a big Bayes factor
x &lt;- c(3, 4, 10, 11, 7, 30) * 1000
output_total  &lt;- mult_bf_informed(x, Hr, a, factor_levels, seed=2020, 
niter=1e3, bf_type = "BFre")
plot(summary(output_total))
</code></pre>

<hr>
<h2 id='print.bmult'>print method for class <code>bmult</code></h2><span id='topic+print.bmult'></span>

<h3>Description</h3>

<p>Prints model specification
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bmult'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.bmult_+3A_x">x</code></td>
<td>
<p>object of class <code>bmult</code> as returned from <code><a href="#topic+mult_bf_informed">mult_bf_informed</a></code> or <code><a href="#topic+binom_bf_informed">binom_bf_informed</a></code></p>
</td></tr>
<tr><td><code id="print.bmult_+3A_...">...</code></td>
<td>
<p>additional arguments, currently ignored</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The print methods print the model specifications and descriptives and return nothing
</p>


<h3>Examples</h3>

<pre><code class='language-R'># data
x &lt;- c(3, 4, 10, 11)
n &lt;- c(15, 12, 12, 12)
# priors
a &lt;- c(1, 1, 1, 1)
b &lt;- c(1, 1, 1, 1)
# informed hypothesis
factor_levels &lt;- c('theta1', 'theta2', 'theta3', 'theta4')
Hr            &lt;- c('theta1', '&lt;',  'theta2', '&lt;', 'theta3', '&lt;', 'theta4')

## Binomial Case
out_binom  &lt;- binom_bf_informed(x=x, n=n, Hr=Hr, a=a, b=b, niter=1e3,factor_levels, seed=2020)
out_binom
## Multinomial Case
out_mult  &lt;- mult_bf_informed(x=x, Hr=Hr, a=a, niter=1e3,factor_levels, seed=2020)
out_mult
</code></pre>

<hr>
<h2 id='print.bmult_bridge'>Print method for class <code>bmult_bridge</code></h2><span id='topic+print.bmult_bridge'></span>

<h3>Description</h3>

<p>Prints model specification
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bmult_bridge'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.bmult_bridge_+3A_x">x</code></td>
<td>
<p>object of class <code>bmult_bridge</code> as returned from <code><a href="#topic+mult_bf_inequality">mult_bf_inequality</a></code>
or <code><a href="#topic+binom_bf_inequality">binom_bf_inequality</a></code></p>
</td></tr>
<tr><td><code id="print.bmult_bridge_+3A_...">...</code></td>
<td>
<p>additional arguments, currently ignored</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The print methods print the results from the bridge sampling
algorithm and return nothing
</p>


<h3>Examples</h3>

<pre><code class='language-R'># data
x &lt;- c(3, 4, 10, 11)
n &lt;- c(15, 12, 12, 12)
# priors
a &lt;- c(1, 1, 1, 1)
b &lt;- c(1, 1, 1, 1)
# informed hypothesis
factor_levels &lt;- c('theta1', 'theta2', 'theta3', 'theta4')
Hr            &lt;- c('theta1', '&lt;',  'theta2', '&lt;', 'theta3', '&lt;', 'theta4')

## Multinomial Case
out_mult  &lt;- mult_bf_inequality(x=x, Hr=Hr, a=a, factor_levels=factor_levels,
niter=1e3, seed=2020)
out_mult
</code></pre>

<hr>
<h2 id='print.summary.bmult'>print method for class <code>summary.bmult</code></h2><span id='topic+print.summary.bmult'></span>

<h3>Description</h3>

<p>Prints the summary from Bayes factor analysis
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.bmult'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.summary.bmult_+3A_x">x</code></td>
<td>
<p>object of class <code>bmult</code> or <code>summary.bmult</code> as returned from <code><a href="#topic+summary.bmult">summary.bmult</a></code></p>
</td></tr>
<tr><td><code id="print.summary.bmult_+3A_...">...</code></td>
<td>
<p>additional arguments, currently ignored</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The print methods print the summary from the Bayes factor analysis and returns nothing
</p>


<h3>Examples</h3>

<pre><code class='language-R'># data
x &lt;- c(3, 4, 10, 11)
n &lt;- c(15, 12, 12, 12)
# priors
a &lt;- c(1, 1, 1, 1)
b &lt;- c(1, 1, 1, 1)
# informed hypothesis
factor_levels &lt;- c('theta1', 'theta2', 'theta3', 'theta4')
Hr            &lt;- c('theta1', '&lt;',  'theta2', '&lt;', 'theta3', '&lt;', 'theta4')

## Binomial Case
out_binom  &lt;- binom_bf_informed(x=x, n=n, Hr=Hr, a=a, b=b, niter=1e3,factor_levels, seed=2020)
summary(out_binom)
## Multinomial Case
out_mult  &lt;- mult_bf_informed(x=x, Hr=Hr, a=a, niter=1e3,factor_levels, seed=2020)
summary(out_mult)
</code></pre>

<hr>
<h2 id='print.summary.bmult_bridge'>print method for class <code>summary.bmult_bridge</code></h2><span id='topic+print.summary.bmult_bridge'></span>

<h3>Description</h3>

<p>Prints the summary of bridge sampling output
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.bmult_bridge'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.summary.bmult_bridge_+3A_x">x</code></td>
<td>
<p>object of class <code>summary.bmult_bridge</code> as returned from <code><a href="#topic+summary.bmult_bridge">summary.bmult_bridge</a></code></p>
</td></tr>
<tr><td><code id="print.summary.bmult_bridge_+3A_...">...</code></td>
<td>
<p>additional arguments, currently ignored</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The print methods print the summary of the bridge sampling output
</p>


<h3>Examples</h3>

<pre><code class='language-R'># data
x &lt;- c(3, 4, 10, 11)
n &lt;- c(15, 12, 12, 12)
# priors
a &lt;- c(1, 1, 1, 1)
b &lt;- c(1, 1, 1, 1)
# informed hypothesis
factor_levels &lt;- c('theta1', 'theta2', 'theta3', 'theta4')
Hr            &lt;- c('theta1', '&lt;',  'theta2', '&lt;', 'theta3', '&lt;', 'theta4')

## Multinomial Case
out_mult  &lt;- mult_bf_inequality(x=x, Hr=Hr, a=a, factor_levels=factor_levels,
niter=1e3, seed=2020)
summary(out_mult)
</code></pre>

<hr>
<h2 id='restriction_list'>S3 method for class <code>restriction_list.bmult</code></h2><span id='topic+restriction_list'></span>

<h3>Description</h3>

<p>Extracts restriction list from an object of class <code>bmult</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>restriction_list(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="restriction_list_+3A_x">x</code></td>
<td>
<p>object of class <code>bmult</code> as returned from <code><a href="#topic+mult_bf_informed">mult_bf_informed</a></code> or <code><a href="#topic+binom_bf_informed">binom_bf_informed</a></code></p>
</td></tr>
<tr><td><code id="restriction_list_+3A_...">...</code></td>
<td>
<p>additional arguments passed to other methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Extracts restriction list and associated hypothesis from an object of class <code>bmult</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># data
x &lt;- c(3, 4, 10, 11)
n &lt;- c(15, 12, 12, 12)
# priors
a &lt;- c(1, 1, 1, 1)
b &lt;- c(1, 1, 1, 1)
# informed hypothesis
factor_levels &lt;- c('theta1', 'theta2', 'theta3', 'theta4')
Hr            &lt;- c('theta1', '&lt;',  'theta2', '&lt;', 'theta3', '&lt;', 'theta4')

## Multinomial Case
out_mult  &lt;- mult_bf_informed(x=x, Hr=Hr, a=a, factor_levels=factor_levels,
niter=1e3, seed=2020)
restriction_list &lt;- restriction_list(out_mult)
</code></pre>

<hr>
<h2 id='restriction_list.bmult'>Extracts restriction list from an object of class <code>bmult</code></h2><span id='topic+restriction_list.bmult'></span>

<h3>Description</h3>

<p>Extracts restriction list from an object of class <code>bmult</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bmult'
restriction_list(x, restrictions = "inequalities", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="restriction_list.bmult_+3A_x">x</code></td>
<td>
<p>object of class <code>bmult</code> as returned from <code><a href="#topic+mult_bf_informed">mult_bf_informed</a></code> or <code><a href="#topic+binom_bf_informed">binom_bf_informed</a></code></p>
</td></tr>
<tr><td><code id="restriction_list.bmult_+3A_restrictions">restrictions</code></td>
<td>
<p>specifies whether to extract restriction list for <code>equalities</code> or <code>inequalities</code>. Default is <code>inequalities</code>.</p>
</td></tr>
<tr><td><code id="restriction_list.bmult_+3A_...">...</code></td>
<td>
<p>additional arguments, currently ignored</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Extracts restriction list and associated hypothesis from an object of class <code>bmult</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># data
x &lt;- c(3, 4, 10, 11)
n &lt;- c(15, 12, 12, 12)
# priors
a &lt;- c(1, 1, 1, 1)
b &lt;- c(1, 1, 1, 1)
# informed hypothesis
factor_levels &lt;- c('theta1', 'theta2', 'theta3', 'theta4')
Hr            &lt;- c('theta1', '&lt;',  'theta2', '&lt;', 'theta3', '&lt;', 'theta4')

## Multinomial Case
out_mult  &lt;- mult_bf_informed(x=x, Hr=Hr, a=a, factor_levels=factor_levels,
niter=1e3, seed=2020)
restriction_list &lt;- restriction_list(out_mult)
</code></pre>

<hr>
<h2 id='samples'>S3 method for class 'samples.bmult'</h2><span id='topic+samples'></span>

<h3>Description</h3>

<p>Extracts prior and posterior samples (if applicable) from an object of class <code>bmult</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>samples(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="samples_+3A_x">x</code></td>
<td>
<p>object of class <code>bmult</code> as returned from <code><a href="#topic+mult_bf_informed">mult_bf_informed</a></code> or <code><a href="#topic+binom_bf_informed">binom_bf_informed</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns <code>list</code> with prior and posterior samples (if applicable) from an object of class <code>bmult</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># data
x &lt;- c(3, 4, 10, 11)
n &lt;- c(15, 12, 12, 12)
# priors
a &lt;- c(1, 1, 1, 1)
b &lt;- c(1, 1, 1, 1)
# informed hypothesis
factor_levels &lt;- c('theta1', 'theta2', 'theta3', 'theta4')
Hr            &lt;- c('theta1', '&lt;',  'theta2', '&lt;', 'theta3', '&lt;', 'theta4')

## Multinomial Case
out_mult  &lt;- mult_bf_informed(x=x, Hr=Hr, a=a, factor_levels=factor_levels,
niter=1e3, seed=2020)
sample_list &lt;- samples(out_mult)
</code></pre>

<hr>
<h2 id='samples.bmult'>Extracts prior and posterior samples (if applicable) from an object of class <code>bmult</code></h2><span id='topic+samples.bmult'></span>

<h3>Description</h3>

<p>Extracts prior and posterior samples (if applicable) from an object of class <code>bmult</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bmult'
samples(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="samples.bmult_+3A_x">x</code></td>
<td>
<p>object of class <code>bmult</code> as returned from <code><a href="#topic+mult_bf_informed">mult_bf_informed</a></code> or <code><a href="#topic+binom_bf_informed">binom_bf_informed</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns <code>list</code> with prior and posterior samples (if applicable) from an object of class <code>bmult</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># data
x &lt;- c(3, 4, 10, 11)
n &lt;- c(15, 12, 12, 12)
# priors
a &lt;- c(1, 1, 1, 1)
b &lt;- c(1, 1, 1, 1)
# informed hypothesis
factor_levels &lt;- c('theta1', 'theta2', 'theta3', 'theta4')
Hr            &lt;- c('theta1', '&lt;',  'theta2', '&lt;', 'theta3', '&lt;', 'theta4')

## Multinomial Case
out_mult  &lt;- mult_bf_informed(x=x, Hr=Hr, a=a, factor_levels=factor_levels,
niter=1e3, seed=2020)
sample_list &lt;- samples(out_mult)
</code></pre>

<hr>
<h2 id='summary.bmult'>summary method for class <code>bmult</code></h2><span id='topic+summary.bmult'></span>

<h3>Description</h3>

<p>Summarizes results from Bayes factor analysis
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bmult'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.bmult_+3A_object">object</code></td>
<td>
<p>object of class <code>bmult</code> as returned from <code><a href="#topic+mult_bf_informed">mult_bf_informed</a></code> or <code><a href="#topic+binom_bf_informed">binom_bf_informed</a></code></p>
</td></tr>
<tr><td><code id="summary.bmult_+3A_...">...</code></td>
<td>
<p>additional arguments, currently ignored</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Invisibly returns a <code>list</code> which contains the Bayes factor and associated hypotheses for the full
model, but also the separate for the independent equality and inequality constraints.
</p>
<p>The summary method returns a <code>list</code> with the following elements:
</p>
<dl>
<dt><code>$hyp</code></dt><dd><p>Vector containing the informed hypothesis as specified by the user</p>
</dd>
<dt><code>$bf</code></dt><dd><p>Contains Bayes factor</p>
</dd>
<dt><code>$logmlHe</code></dt><dd><p>Contains log marginal likelihood of the encompassing model</p>
</dd>
<dt><code>$logmlH0</code></dt><dd><p>Contains log marginal likelihood of the null model</p>
</dd>
<dt><code>$logmlHr</code></dt><dd><p>Contains log marginal likelihood of the informed model</p>
</dd>
<dt><code>$re2</code></dt><dd><p>Contains relative mean-square error for the Bayes factor</p>
</dd>
<dt><code>$bf_type</code></dt><dd><p>Contains Bayes factor type as specified by the user</p>
</dd>
<dt><code>$cred_level</code></dt><dd><p>Credible interval for the posterior point estimates.</p>
</dd>
<dt><code>$prior</code></dt><dd><p>List containing the prior parameters.</p>
</dd>
<dt><code>$data</code></dt><dd><p>List containing the data.</p>
</dd>
<dt><code>$nr_equal</code></dt><dd><p>Number of independent equality-constrained hypotheses.</p>
</dd>
<dt><code>$nr_inequal</code></dt><dd><p>Number of independent inequality-constrained hypotheses.</p>
</dd>
<dt><code>$estimates</code></dt><dd><p>Parameter estimates for the encompassing model
</p>

<ul>
<li> <p><code>factor_level</code>: Vector with category names
</p>
</li>
<li> <p><code>alpha</code>: Vector with posterior concentration parameters of Dirichlet
distribution (for multinomial models) or alpha parameters for independent beta
distributions (for binomial models)
</p>
</li>
<li> <p><code>beta</code>: Vector with beta parameters for independent beta
distributions (for binomial models)
</p>
</li>
<li> <p><code>lower</code>: Lower value of credible intervals of marginal beta distributions
</p>
</li>
<li> <p><code>median</code>: Posterior median of marginal beta distributions
</p>
</li>
<li> <p><code>upper</code>: Upper value of credible intervals of marginal beta distributions
</p>
</li></ul>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'># data
x &lt;- c(3, 4, 10, 11)
n &lt;- c(15, 12, 12, 12)
# priors
a &lt;- c(1, 1, 1, 1)
b &lt;- c(1, 1, 1, 1)
# informed hypothesis
factor_levels &lt;- c('theta1', 'theta2', 'theta3', 'theta4')
Hr            &lt;- c('theta1', '&lt;',  'theta2', '&lt;', 'theta3', '&lt;', 'theta4')

## Binomial Case
out_binom  &lt;- binom_bf_informed(x=x, n=n, Hr=Hr, a=a, b=b, niter=1e3,factor_levels, seed=2020)
summary(out_binom)
## Multinomial Case
out_mult  &lt;- mult_bf_informed(x=x, Hr=Hr, a=a, niter=1e3,factor_levels, seed=2020)
summary(out_mult)
</code></pre>

<hr>
<h2 id='summary.bmult_bridge'>summary method for class <code>bmult_bridge</code></h2><span id='topic+summary.bmult_bridge'></span>

<h3>Description</h3>

<p>Summarizes bridge sampling results and associated error measures
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bmult_bridge'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.bmult_bridge_+3A_object">object</code></td>
<td>
<p>object of class <code>bmult_bridge</code> as returned from <code><a href="#topic+mult_bf_inequality">mult_bf_inequality</a></code> or <code><a href="#topic+binom_bf_inequality">binom_bf_inequality</a></code></p>
</td></tr>
<tr><td><code id="summary.bmult_bridge_+3A_...">...</code></td>
<td>
<p>additional arguments, currently ignored</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Invisibly returns a <code>list</code> which contains the log marginal likelihood for inequality constrained category proportions and associated error terms.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># data
x &lt;- c(3, 4, 10, 11)
n &lt;- c(15, 12, 12, 12)
# priors
a &lt;- c(1, 1, 1, 1)
b &lt;- c(1, 1, 1, 1)
# informed hypothesis
factor_levels &lt;- c('theta1', 'theta2', 'theta3', 'theta4')
Hr            &lt;- c('theta1', '&lt;',  'theta2', '&lt;', 'theta3', '&lt;', 'theta4')

## Multinomial Case
out_mult  &lt;- mult_bf_inequality(x=x, Hr=Hr, a=a, factor_levels=factor_levels,
niter=1e3, seed=2020)
summary(out_mult)
</code></pre>

<hr>
<h2 id='tbinom_backtrans'>Backtransforms Samples From Real Line To Beta Parameters</h2><span id='topic+tbinom_backtrans'></span>

<h3>Description</h3>

<p>Transforms samples from the real line to samples from a truncated beta density using a stick-breaking algorithm.
This algorithm is suitable for mixtures of equality constrained parameters, inequality constrained parameters,
and free parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tbinom_backtrans(xi_mat, boundaries, binom_equal, hyp_direction)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tbinom_backtrans_+3A_xi_mat">xi_mat</code></td>
<td>
<p>matrix with samples from truncated beta density. These samples should be transformed, so they range
over the entire real line</p>
</td></tr>
<tr><td><code id="tbinom_backtrans_+3A_boundaries">boundaries</code></td>
<td>
<p>list containing indices for upper and lower truncation boundaries</p>
</td></tr>
<tr><td><code id="tbinom_backtrans_+3A_binom_equal">binom_equal</code></td>
<td>
<p>multiplicative elements for each lower and upper bound of each inequality constrained parameter.</p>
</td></tr>
<tr><td><code id="tbinom_backtrans_+3A_hyp_direction">hyp_direction</code></td>
<td>
<p>specifies whether the imposed inequality constrained imposes an increasing (i.e., 'smaller') or
decreasing (i.e., 'larger') trend</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list consisting of the following elements:
(1) theta_mat: matrix with transformed samples
(2) lower_mat: matrix containing the lower bound for each parameter
(3) upper_mat: matrix containing the upper bound for each parameter
</p>

<hr>
<h2 id='tbinom_trans'>Transforms Truncated Beta Samples To Real Line</h2><span id='topic+tbinom_trans'></span>

<h3>Description</h3>

<p>Transforms samples from a truncated beta density to the real line using a stick-breaking algorithm.
This algorithm is suitable for mixtures of equality constrained parameters, inequality constrained parameters,
and free parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tbinom_trans(theta_mat, boundaries, binom_equal, hyp_direction)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tbinom_trans_+3A_theta_mat">theta_mat</code></td>
<td>
<p>matrix with samples from truncated beta density</p>
</td></tr>
<tr><td><code id="tbinom_trans_+3A_boundaries">boundaries</code></td>
<td>
<p>list containing indices for upper and lower truncation boundaries</p>
</td></tr>
<tr><td><code id="tbinom_trans_+3A_binom_equal">binom_equal</code></td>
<td>
<p>multiplicative elements for each lower and upper bound of each inequality constrained parameter.</p>
</td></tr>
<tr><td><code id="tbinom_trans_+3A_hyp_direction">hyp_direction</code></td>
<td>
<p>specifies whether the imposed inequality constrained imposes an increasing (i.e., 'smaller') or
decreasing (i.e., 'larger') trend</p>
</td></tr>
</table>


<h3>Value</h3>

<p>matrix with transformed samples
</p>

<hr>
<h2 id='tdir_backtrans'>Backtransforms Samples From Real Line To Dirichlet Parameters</h2><span id='topic+tdir_backtrans'></span>

<h3>Description</h3>

<p>Transforms samples from the real line to samples from a truncated Dirichlet density using a stick-breaking algorithm.
This algorithm is suitable for mixtures of equality constrained parameters, inequality constrained parameters,
and free parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tdir_backtrans(
  xi_mat,
  boundaries,
  mult_equal,
  nr_mult_equal,
  nr_mult_free,
  hyp_direction
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tdir_backtrans_+3A_xi_mat">xi_mat</code></td>
<td>
<p>matrix with samples from truncated Dirichlet density. These samples should be transformed, so they range
over the entire real line</p>
</td></tr>
<tr><td><code id="tdir_backtrans_+3A_boundaries">boundaries</code></td>
<td>
<p>list containing indices for upper and lower truncation boundaries</p>
</td></tr>
<tr><td><code id="tdir_backtrans_+3A_mult_equal">mult_equal</code></td>
<td>
<p>multiplicative elements for each lower and upper bound of each inequality constrained parameter.</p>
</td></tr>
<tr><td><code id="tdir_backtrans_+3A_nr_mult_equal">nr_mult_equal</code></td>
<td>
<p>vector of multiplicative elements of collapsed parameters</p>
</td></tr>
<tr><td><code id="tdir_backtrans_+3A_nr_mult_free">nr_mult_free</code></td>
<td>
<p>vector of multiplicative elements of free parameters</p>
</td></tr>
<tr><td><code id="tdir_backtrans_+3A_hyp_direction">hyp_direction</code></td>
<td>
<p>specifies whether the imposed inequality constrained imposes an increasing (i.e., 'smaller') or
decreasing (i.e., 'larger') trend</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list consisting of the following elements:
(1) theta_mat: matrix with transformed samples
(2) lower_mat: matrix containing the lower bound for each parameter
(3) upper_mat: matrix containing the upper bound for each parameter
</p>

<hr>
<h2 id='tdir_trans'>Transforms Truncated Dirichlet Samples To Real Line</h2><span id='topic+tdir_trans'></span>

<h3>Description</h3>

<p>Transforms samples from a truncated Dirichlet density to the real line using a stick-breaking algorithm.
This algorithm is suitable for mixtures of equality constrained parameters, inequality constrained parameters,
and free parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tdir_trans(
  theta_mat,
  boundaries,
  mult_equal,
  nr_mult_equal,
  nr_mult_free,
  hyp_direction
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tdir_trans_+3A_theta_mat">theta_mat</code></td>
<td>
<p>matrix with samples from truncated Dirichlet density</p>
</td></tr>
<tr><td><code id="tdir_trans_+3A_boundaries">boundaries</code></td>
<td>
<p>list containing indices for upper and lower truncation boundaries</p>
</td></tr>
<tr><td><code id="tdir_trans_+3A_mult_equal">mult_equal</code></td>
<td>
<p>multiplicative elements for each lower and upper bound of each inequality constrained parameter.</p>
</td></tr>
<tr><td><code id="tdir_trans_+3A_nr_mult_equal">nr_mult_equal</code></td>
<td>
<p>vector of multiplicative elements of collapsed parameters</p>
</td></tr>
<tr><td><code id="tdir_trans_+3A_nr_mult_free">nr_mult_free</code></td>
<td>
<p>vector of multiplicative elements of free parameters</p>
</td></tr>
<tr><td><code id="tdir_trans_+3A_hyp_direction">hyp_direction</code></td>
<td>
<p>specifies whether the imposed inequality constrained imposes an increasing (i.e., 'smaller') or
decreasing (i.e., 'larger') trend</p>
</td></tr>
</table>


<h3>Value</h3>

<p>matrix with transformed samples
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
