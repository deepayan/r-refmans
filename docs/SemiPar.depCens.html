<!DOCTYPE html><html lang="en"><head><title>Help for package SemiPar.depCens</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {SemiPar.depCens}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#boot.fun'><p>Nonparametric bootstrap approach for the dependent censoring model</p></a></li>
<li><a href='#boot.funI'><p>Nonparametric bootstrap approach for the independent censoring model</p></a></li>
<li><a href='#CompC'><p>Compute phi function</p></a></li>
<li><a href='#Distance'><p>Distance between vectors</p></a></li>
<li><a href='#fitDepCens'><p>Fit Dependent Censoring Models</p></a></li>
<li><a href='#fitIndepCens'><p>Fit Independent Censoring Models</p></a></li>
<li><a href='#follic'><p>Follicular Cell Lymphoma</p></a></li>
<li><a href='#genData'><p>Simulate a toy example for testing</p></a></li>
<li><a href='#LikCopInd'><p>Loglikehood function under independent censoring</p></a></li>
<li><a href='#Longfun'><p>Long format</p></a></li>
<li><a href='#PseudoL'><p>Likelihood function under dependent censoring</p></a></li>
<li><a href='#SearchIndicate'><p>Search function</p></a></li>
<li><a href='#SolveL'><p>Cumulative hazard function of survival time under dependent censoring</p></a></li>
<li><a href='#SolveLI'><p>Cumulative hazard function of survival time under independent censoring</p></a></li>
<li><a href='#summary.depFit'><p>Summary of <code>depCensoringFit</code> object</p></a></li>
<li><a href='#summary.indepFit'><p>Summary of <code>indepCensoringFit</code> object</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Copula Based Cox Proportional Hazards Models for Dependent
Censoring</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-08-26</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Negera Wakgari Deresa &lt;negera.deresa@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Copula based Cox proportional hazards models for survival data subject to dependent 
    censoring. This approach does not assume that the parameter defining the copula is known. The 
    dependency parameter is estimated with other finite model parameters by maximizing a Pseudo 
    likelihood function. The cumulative hazard function is estimated via estimating equations 
    derived based on martingale ideas. Available copula functions include Frank, Gumbel and Normal
    copulas. Only Weibull and lognormal models are allowed for the censoring model, even though any
    parametric model that satisfies certain identifiability conditions could be used. Implemented 
    methods are described in the article "Copula based Cox proportional hazards models for dependent
    censoring" by Deresa and Van Keilegom (2024) &lt;<a href="https://doi.org/10.1080%2F01621459.2022.2161387">doi:10.1080/01621459.2022.2161387</a>&gt;. </td>
</tr>
<tr>
<td>Imports:</td>
<td>survival, copula, stats, foreach, parallel, doParallel,
pbivnorm</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/Nago2020/SemiPar.depCens">https://github.com/Nago2020/SemiPar.depCens</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/Nago2020/SemiPar.depCens/issues">https://github.com/Nago2020/SemiPar.depCens/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-08-26 21:06:34 UTC; Negera Deresa</td>
</tr>
<tr>
<td>Author:</td>
<td>Negera Wakgari Deresa
    <a href="https://orcid.org/0000-0002-1302-3725"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre],
  Ingrid Van Keilegom
    <a href="https://orcid.org/0000-0001-8827-7642"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-08-26 23:30:08 UTC</td>
</tr>
</table>
<hr>
<h2 id='boot.fun'>Nonparametric bootstrap approach for the dependent censoring model</h2><span id='topic+boot.fun'></span>

<h3>Description</h3>

<p>This function estimates the bootstrap standard errors for the finite-dimensional model parameters and for the non-parametric cumulative
hazard function. Parallel computing using foreach has been used to speed up the estimation of standard errors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>boot.fun(
  init,
  resData,
  X,
  W,
  lhat,
  cumL,
  dist,
  k,
  lb,
  ub,
  Obs.time,
  cop,
  n.boot,
  n.iter,
  ncore,
  eps
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="boot.fun_+3A_init">init</code></td>
<td>
<p>Initial values for the finite dimensional parameters obtained from the fit of <code><a href="#topic+fitDepCens">fitDepCens</a></code></p>
</td></tr>
<tr><td><code id="boot.fun_+3A_resdata">resData</code></td>
<td>
<p>Data matrix with three columns;  Z = the observed survival time, d1 = the censoring indicator of T
and  d2 =  the censoring indicator of C.</p>
</td></tr>
<tr><td><code id="boot.fun_+3A_x">X</code></td>
<td>
<p>Data matrix with covariates related to T</p>
</td></tr>
<tr><td><code id="boot.fun_+3A_w">W</code></td>
<td>
<p>Data matrix with covariates related to C. First column of W should be a vector of ones</p>
</td></tr>
<tr><td><code id="boot.fun_+3A_lhat">lhat</code></td>
<td>
<p>Initial values for the hazard function obtained from the fit of <code><a href="#topic+fitDepCens">fitDepCens</a></code> based on the original data.</p>
</td></tr>
<tr><td><code id="boot.fun_+3A_cuml">cumL</code></td>
<td>
<p>Initial values for the cumulative hazard function obtained from the fit of <code><a href="#topic+fitDepCens">fitDepCens</a></code> based on the original data.</p>
</td></tr>
<tr><td><code id="boot.fun_+3A_dist">dist</code></td>
<td>
<p>The distribution to be used for the  dependent censoring time C. Only two distributions are allowed, i.e, Weibull
and lognormal distributions. With the value <code>"Weibull"</code> as the
default.</p>
</td></tr>
<tr><td><code id="boot.fun_+3A_k">k</code></td>
<td>
<p>Dimension of X</p>
</td></tr>
<tr><td><code id="boot.fun_+3A_lb">lb</code></td>
<td>
<p>lower boundary for finite dimensional parameters</p>
</td></tr>
<tr><td><code id="boot.fun_+3A_ub">ub</code></td>
<td>
<p>Upper boundary for finite dimensional parameters</p>
</td></tr>
<tr><td><code id="boot.fun_+3A_obs.time">Obs.time</code></td>
<td>
<p>Observed survival time, which is the minimum of T, C and A, where A is the administrative censoring time.</p>
</td></tr>
<tr><td><code id="boot.fun_+3A_cop">cop</code></td>
<td>
<p>Which copula should be computed to account for dependency between T and C. This argument can take
one of the values from <code>c("Gumbel", "Frank", "Normal")</code>.</p>
</td></tr>
<tr><td><code id="boot.fun_+3A_n.boot">n.boot</code></td>
<td>
<p>Number of bootstraps to use in the estimation of bootstrap standard errors.</p>
</td></tr>
<tr><td><code id="boot.fun_+3A_n.iter">n.iter</code></td>
<td>
<p>Number of iterations; the default is <code>n.iter = 20</code>. The larger the number of iterations, the longer the computational time.</p>
</td></tr>
<tr><td><code id="boot.fun_+3A_ncore">ncore</code></td>
<td>
<p>The number of cores to use for parallel computation is configurable, with the default <code>ncore = 7</code>.</p>
</td></tr>
<tr><td><code id="boot.fun_+3A_eps">eps</code></td>
<td>
<p>Convergence error. This is set by the user in such away that the desired convergence is met; the default is <code>eps = 1e-3</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Bootstrap standard errors for parameter estimates and for estimated cumulative hazard function.
</p>

<hr>
<h2 id='boot.funI'>Nonparametric bootstrap approach for the independent censoring model</h2><span id='topic+boot.funI'></span>

<h3>Description</h3>

<p>This function estimates the bootstrap standard errors for the finite-dimensional model parameters and for the non-parametric cumulative
hazard function under the assumption of independent censoring. Parallel computing using foreach has been used to speed up the computation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>boot.funI(
  init,
  resData,
  X,
  W,
  lhat,
  cumL,
  dist,
  k,
  lb,
  ub,
  Obs.time,
  n.boot,
  n.iter,
  ncore,
  eps
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="boot.funI_+3A_init">init</code></td>
<td>
<p>Initial values for the finite dimensional parameters obtained from the fit of <code><a href="#topic+fitIndepCens">fitIndepCens</a></code></p>
</td></tr>
<tr><td><code id="boot.funI_+3A_resdata">resData</code></td>
<td>
<p>Data matrix with three columns;  Z = the observed survival time, d1 = the censoring indicator of T
and  d2 =  the censoring indicator of C.</p>
</td></tr>
<tr><td><code id="boot.funI_+3A_x">X</code></td>
<td>
<p>Data matrix with covariates related to T</p>
</td></tr>
<tr><td><code id="boot.funI_+3A_w">W</code></td>
<td>
<p>Data matrix with covariates related to C. First column of W should be a vector of ones</p>
</td></tr>
<tr><td><code id="boot.funI_+3A_lhat">lhat</code></td>
<td>
<p>Initial values for the hazard function obtained from the fit of <code><a href="#topic+fitIndepCens">fitIndepCens</a></code> based on the original data</p>
</td></tr>
<tr><td><code id="boot.funI_+3A_cuml">cumL</code></td>
<td>
<p>Initial values for the cumulative hazard function obtained from the fit of <code><a href="#topic+fitIndepCens">fitIndepCens</a></code> based on the original data</p>
</td></tr>
<tr><td><code id="boot.funI_+3A_dist">dist</code></td>
<td>
<p>The distribution to be used for the  dependent censoring time C. Only two distributions are allowed, i.e, Weibull
and lognormal distributions. With the value <code>"Weibull"</code> as the
default</p>
</td></tr>
<tr><td><code id="boot.funI_+3A_k">k</code></td>
<td>
<p>Dimension of X</p>
</td></tr>
<tr><td><code id="boot.funI_+3A_lb">lb</code></td>
<td>
<p>lower boundary for finite dimensional parameters</p>
</td></tr>
<tr><td><code id="boot.funI_+3A_ub">ub</code></td>
<td>
<p>Upper boundary for finite dimensional parameters</p>
</td></tr>
<tr><td><code id="boot.funI_+3A_obs.time">Obs.time</code></td>
<td>
<p>Observed survival time, which is the minimum of T, C and A, where A is the administrative censoring time.</p>
</td></tr>
<tr><td><code id="boot.funI_+3A_n.boot">n.boot</code></td>
<td>
<p>Number of bootstraps to use in the estimation of bootstrap standard errors.</p>
</td></tr>
<tr><td><code id="boot.funI_+3A_n.iter">n.iter</code></td>
<td>
<p>Number of iterations; the default is <code>n.iter = 20</code>. The larger the number of iterations, the longer the computational time</p>
</td></tr>
<tr><td><code id="boot.funI_+3A_ncore">ncore</code></td>
<td>
<p>The number of cores to use for parallel computation is configurable, with the default <code>ncore = 7</code>.</p>
</td></tr>
<tr><td><code id="boot.funI_+3A_eps">eps</code></td>
<td>
<p>Convergence error. This is set by the user in such away that the desired convergence is met; the default is <code>eps = 1e-3</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Bootstrap standard errors for parameter estimates and for estimated cumulative hazard function.
</p>

<hr>
<h2 id='CompC'>Compute phi function</h2><span id='topic+CompC'></span>

<h3>Description</h3>

<p>This function estimates phi function at fixed time point t
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CompC(theta, t, X, W, ld, cop, dist)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="CompC_+3A_theta">theta</code></td>
<td>
<p>Estimated parameter values/initial values for finite dimensional parameters</p>
</td></tr>
<tr><td><code id="CompC_+3A_t">t</code></td>
<td>
<p>A fixed time point</p>
</td></tr>
<tr><td><code id="CompC_+3A_x">X</code></td>
<td>
<p>Data matrix with covariates related to T</p>
</td></tr>
<tr><td><code id="CompC_+3A_w">W</code></td>
<td>
<p>Data matrix with covariates related to C. First column of W should be ones</p>
</td></tr>
<tr><td><code id="CompC_+3A_ld">ld</code></td>
<td>
<p>Output of <code><a href="#topic+SolveL">SolveL</a></code> function at a fixed time t</p>
</td></tr>
<tr><td><code id="CompC_+3A_cop">cop</code></td>
<td>
<p>Which copula should be computed to account for dependency between T and C. This argument can take
one of the values from <code>c("Gumbel", "Frank", "Normal")</code>. The default copula model is &quot;Frank&quot;.</p>
</td></tr>
<tr><td><code id="CompC_+3A_dist">dist</code></td>
<td>
<p>The distribution to  be used for the dependent censoring C. Only two distributions are allowed, i.e, Weibull
and lognormal distributions. With the value <code>"Weibull"</code> as the
default.</p>
</td></tr>
</table>

<hr>
<h2 id='Distance'>Distance between vectors</h2><span id='topic+Distance'></span>

<h3>Description</h3>

<p>This function computes distance between two vectors based on L2-norm
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Distance(a, b)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Distance_+3A_a">a</code></td>
<td>
<p>First vector</p>
</td></tr>
<tr><td><code id="Distance_+3A_b">b</code></td>
<td>
<p>Second vector</p>
</td></tr>
</table>

<hr>
<h2 id='fitDepCens'>Fit Dependent Censoring Models</h2><span id='topic+fitDepCens'></span>

<h3>Description</h3>

<p>This function allows to estimate the dependency parameter along all other model parameters. First, estimates the cumulative hazard function, and
then at the second stage it estimates other model parameters assuming that the cumulative hazard function is known. The details for
implementing the dependent censoring methodology can be found in Deresa and Van Keilegom (2024).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitDepCens(
  resData,
  X,
  W,
  cop = c("Frank", "Gumbel", "Normal"),
  dist = c("Weibull", "lognormal"),
  start = NULL,
  n.iter = 50,
  bootstrap = TRUE,
  n.boot = 150,
  ncore = 7,
  eps = 1e-04
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fitDepCens_+3A_resdata">resData</code></td>
<td>
<p>Data matrix with three columns;  Z = the observed survival time, d1 = the censoring indicator of T
and  d2 =  the censoring indicator of C.</p>
</td></tr>
<tr><td><code id="fitDepCens_+3A_x">X</code></td>
<td>
<p>Data matrix with covariates related to T.</p>
</td></tr>
<tr><td><code id="fitDepCens_+3A_w">W</code></td>
<td>
<p>Data matrix with covariates related to C. First column of W should be a vector of ones.</p>
</td></tr>
<tr><td><code id="fitDepCens_+3A_cop">cop</code></td>
<td>
<p>Which copula should be computed to account for dependency between T and C. This argument can take
one of the values from <code>c("Gumbel", "Frank", "Normal")</code>.</p>
</td></tr>
<tr><td><code id="fitDepCens_+3A_dist">dist</code></td>
<td>
<p>The distribution to be used for the censoring time C. Only two distributions are allowed, i.e, Weibull
and lognormal distributions. With the value <code>"Weibull"</code> as the
default.</p>
</td></tr>
<tr><td><code id="fitDepCens_+3A_start">start</code></td>
<td>
<p>Initial values for the finite dimensional parameters. If <code>start</code> is NULL, the initial values will be obtained
by fitting a Cox model for survival time T and a Weibull model for dependent censoring C.</p>
</td></tr>
<tr><td><code id="fitDepCens_+3A_n.iter">n.iter</code></td>
<td>
<p>Number of iterations; the default is <code>n.iter = 50</code>. The larger the number of iterations, the longer the computational time.</p>
</td></tr>
<tr><td><code id="fitDepCens_+3A_bootstrap">bootstrap</code></td>
<td>
<p>A boolean indicating whether to compute bootstrap standard errors for making inferences.</p>
</td></tr>
<tr><td><code id="fitDepCens_+3A_n.boot">n.boot</code></td>
<td>
<p>Number of bootstrap samples to use in the estimation of bootstrap standard errors if <code>bootstrap = TRUE</code>. The default is n.boot = 150. But, higher
values  of <code>n.boot</code> are recommended for obtaining good estimates of bootstrap standard errors.</p>
</td></tr>
<tr><td><code id="fitDepCens_+3A_ncore">ncore</code></td>
<td>
<p>The number of cores to use for parallel computation in bootstrapping, with the default <code>ncore = 7</code>.</p>
</td></tr>
<tr><td><code id="fitDepCens_+3A_eps">eps</code></td>
<td>
<p>Convergence error. This is set by the user in such away that the desired convergence is met; the default is <code>eps = 1e-4</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function returns a fit of dependent censoring model; parameter estimates, estimate of the cumulative hazard function, bootstrap standard
errors for finite-dimensional parameters, the nonparametric cumulative hazard function, etc.
</p>


<h3>References</h3>

<p>Deresa and Van Keilegom (2024). Copula based Cox proportional hazards models for dependent censoring, Journal of the American Statistical Association, 119:1044-1054.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Toy data example to illustrate implementation
n = 300
beta = c(0.5)
lambd = 0.35
eta = c(0.9,0.4)
X = cbind(rbinom(n,1,0.5))
W = cbind(rep(1,n),rbinom(n,1,0.5))
# generate dependency structure from Frank
frank.cop &lt;- copula::frankCopula(param = 5,dim = 2)
U = copula::rCopula(n,frank.cop)
T1 = (-log(1-U[,1]))/(lambd*exp(X*beta))           # Survival time
T2 = (-log(1-U[,2]))^(1.1)*exp(W%*%eta)            # Censoring time
A = runif(n,0,15)                                  # administrative censoring time
Z = pmin(T1,T2,A)
d1 = as.numeric(Z==T1)
d2 = as.numeric(Z==T2)
resData = data.frame("Z" = Z,"d1" = d1, "d2" = d2)   # should be data frame
colnames(W) &lt;- c("ones","cov1")
colnames(X) &lt;- "cov.surv"

# Fit dependent censoring model

fit &lt;- fitDepCens(resData = resData, X = X, W = W, bootstrap = FALSE)

# parameter estimates

fit$parameterEstimates

# summary fit results
summary(fit)

# plot cumulative hazard vs time

plot(fit$observedTime, fit$cumhazardFunction, type = "l",xlab = "Time",
ylab = "Estimated cumulative hazard function")


</code></pre>

<hr>
<h2 id='fitIndepCens'>Fit Independent Censoring Models</h2><span id='topic+fitIndepCens'></span>

<h3>Description</h3>

<p>This function allows to estimate all model parameters under the assumption of independent censoring. First, estimates the cumulative hazard function, and
then at the second stage it estimates other model parameters assuming that the cumulative hazard is known.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitIndepCens(
  resData,
  X,
  W,
  dist = c("Weibull", "lognormal"),
  start = NULL,
  n.iter = 50,
  bootstrap = TRUE,
  n.boot = 150,
  ncore = 7,
  eps = 1e-04
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fitIndepCens_+3A_resdata">resData</code></td>
<td>
<p>Data matrix with three columns;  Z = the observed survival time, d1 = the censoring indicator of T
and  d2 =  the censoring indicator of C.</p>
</td></tr>
<tr><td><code id="fitIndepCens_+3A_x">X</code></td>
<td>
<p>Data matrix with covariates related to T.</p>
</td></tr>
<tr><td><code id="fitIndepCens_+3A_w">W</code></td>
<td>
<p>Data matrix with covariates related to C. First column of W should be ones.</p>
</td></tr>
<tr><td><code id="fitIndepCens_+3A_dist">dist</code></td>
<td>
<p>The distribution to be used for the censoring time C. Only two distributions are allowed, i.e, Weibull
and lognormal distributions. With the value <code>"Weibull"</code> as the
default.</p>
</td></tr>
<tr><td><code id="fitIndepCens_+3A_start">start</code></td>
<td>
<p>Initial values for the finite dimensional parameters. If <code>start</code> is NULL, the initial values will be obtained
by fitting a Cox model for survival time T and a Weibull model for censoring time C.</p>
</td></tr>
<tr><td><code id="fitIndepCens_+3A_n.iter">n.iter</code></td>
<td>
<p>Number of iterations; the default is <code>n.iter = 50</code>. The larger the number of iterations, the longer the computational time.</p>
</td></tr>
<tr><td><code id="fitIndepCens_+3A_bootstrap">bootstrap</code></td>
<td>
<p>A boolean indicating whether to compute bootstrap standard errors for making inferences.</p>
</td></tr>
<tr><td><code id="fitIndepCens_+3A_n.boot">n.boot</code></td>
<td>
<p>Number of bootstrap samples to use in the estimation of bootstrap standard errors if <code>bootstrap = TRUE</code>. The default is n.boot = 150. But, higher
values  of <code>n.boot</code> are recommended for obtaining good estimates of bootstrap standard errors.</p>
</td></tr>
<tr><td><code id="fitIndepCens_+3A_ncore">ncore</code></td>
<td>
<p>The number of cores to use for parallel computation is configurable, with the default <code>ncore = 7</code>.</p>
</td></tr>
<tr><td><code id="fitIndepCens_+3A_eps">eps</code></td>
<td>
<p>Convergence error. This is set by the user in such away that the desired convergence is met; the default is <code>eps = 1e-4</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function returns a fit of independent censoring model; parameter estimates, estimate of the cumulative hazard function, bootstrap standard
errors for finite-dimensional parameters, the nonparametric cumulative hazard function, etc.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

# Toy data example to illustrate implementation
n = 300
beta = c(0.5)
lambd = 0.35
eta = c(0.9,0.4)
X = cbind(rbinom(n,1,0.5))
W = cbind(rep(1,n),rbinom(n,1,0.5))
# generate dependency structure from Frank
frank.cop &lt;- copula::frankCopula(param = 5,dim = 2)
U = copula::rCopula(n,frank.cop)
T1 = (-log(1-U[,1]))/(lambd*exp(X*beta))                  # Survival time'
T2 = (-log(1-U[,2]))^(1.1)*exp(W%*%eta)                   # Censoring time
A = runif(n,0,15)                                         # administrative censoring time
Z = pmin(T1,T2,A)
d1 = as.numeric(Z==T1)
d2 = as.numeric(Z==T2)
resData = data.frame("Z" = Z,"d1" = d1, "d2" = d2)     # should be data frame

colnames(W) &lt;- c("ones","cov1")
colnames(X) &lt;- "cov.surv"

# Fit independent censoring model

fitI &lt;- fitIndepCens(resData = resData, X = X, W = W, bootstrap = FALSE)

# parameter estimates

fitI$parameterEstimates

# summary fit results
summary(fitI)

# plot cumulative hazard vs time

 plot(fitI$observedTime, fitI$cumhazardFunction, type = "l",xlab = "Time",
 ylab = "Estimated cumulative hazard function")


</code></pre>

<hr>
<h2 id='follic'>Follicular Cell Lymphoma</h2><span id='topic+follic'></span>

<h3>Description</h3>

<p>Competing risk data set involving follicular cell lymphoma as given in the book of Pintilie (2006).
The data consist of 541 patients with early disease stage (I or II) and treated with radiation alone (RT) or with
radiation and chemotherapy (CMT). The endpoints of interest are what comes first: relapse of the
disease or death in remission.
</p>


<h3>Format</h3>

<p>A data frame with 541 rows and 7 variables:
</p>

<ul>
<li><p> age:	age
</p>
</li>
<li><p> clinstg: clinical stage: 1=stage I, 2=stage II
</p>
</li>
<li><p> ch:	chemotherapy
</p>
</li>
<li><p> rt:	radiotherapy
</p>
</li>
<li><p> hgb: hemoglobin level in g/l
</p>
</li>
<li><p> time:	first failure time
</p>
</li>
<li><p> status:	censoring status; 0=censored, 1=relapse, 2=death
</p>
</li></ul>



<h3>References</h3>

<p>Pintilie, M. (2006), Competing Risks: A Practical Perspective, Chichester: Wiley.
</p>

<hr>
<h2 id='genData'>Simulate a toy example for testing</h2><span id='topic+genData'></span>

<h3>Description</h3>

<p>Simulate a toy example for testing
</p>


<h3>Usage</h3>

<pre><code class='language-R'>genData(n)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="genData_+3A_n">n</code></td>
<td>
<p>sample size</p>
</td></tr>
</table>

<hr>
<h2 id='LikCopInd'>Loglikehood function under independent censoring</h2><span id='topic+LikCopInd'></span>

<h3>Description</h3>

<p>Loglikehood function under independent censoring
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LikCopInd(theta, resData, X, W, lhat, cumL, dist)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="LikCopInd_+3A_theta">theta</code></td>
<td>
<p>Estimated parameter values/initial values for finite dimensional parameters</p>
</td></tr>
<tr><td><code id="LikCopInd_+3A_resdata">resData</code></td>
<td>
<p>Data matrix with three columns;  Z = the observed survival time, d1 = the censoring indicator of T
and  d2 =  the censoring indicator of C.</p>
</td></tr>
<tr><td><code id="LikCopInd_+3A_x">X</code></td>
<td>
<p>Data matrix with covariates related to T</p>
</td></tr>
<tr><td><code id="LikCopInd_+3A_w">W</code></td>
<td>
<p>Data matrix with covariates related to C. First column of W should be ones</p>
</td></tr>
<tr><td><code id="LikCopInd_+3A_lhat">lhat</code></td>
<td>
<p>The estimated hazard function obtained from the output of <code><a href="#topic+SolveLI">SolveLI</a></code>.</p>
</td></tr>
<tr><td><code id="LikCopInd_+3A_cuml">cumL</code></td>
<td>
<p>The estimated cumulative hazard function from the output of <code><a href="#topic+SolveLI">SolveLI</a></code>.</p>
</td></tr>
<tr><td><code id="LikCopInd_+3A_dist">dist</code></td>
<td>
<p>The distribution to  be used for the dependent censoring C. Only two distributions are allowed, i.e, Weibull
and lognormal distributions. With the value <code>"Weibull"</code> as the
default.
@importFrom stats nlminb pnorm  qnorm sd</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Maximized log-likelihood value
</p>

<hr>
<h2 id='Longfun'>Long format</h2><span id='topic+Longfun'></span>

<h3>Description</h3>

<p>Change hazard and cumulative hazard to long format
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Longfun(Z, T1, lhat, Lhat)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Longfun_+3A_z">Z</code></td>
<td>
<p>Observed survival time, which is the minimum of T, C and A, where A is the administrative censoring time.</p>
</td></tr>
<tr><td><code id="Longfun_+3A_t1">T1</code></td>
<td>
<p>Distinct observed survival time</p>
</td></tr>
<tr><td><code id="Longfun_+3A_lhat">lhat</code></td>
<td>
<p>Hazard function estimate</p>
</td></tr>
<tr><td><code id="Longfun_+3A_lhat">Lhat</code></td>
<td>
<p>Cumulative hazard function estimate</p>
</td></tr>
</table>

<hr>
<h2 id='PseudoL'>Likelihood function under dependent censoring</h2><span id='topic+PseudoL'></span>

<h3>Description</h3>

<p>The <code>PseudoL</code> function  is maximized in order to
estimate the finite dimensional model parameters, including the dependency parameter.
This function assumes that the cumulative hazard function is known.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PseudoL(theta, resData, X, W, lhat, cumL, cop, dist)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PseudoL_+3A_theta">theta</code></td>
<td>
<p>Estimated parameter values/initial values for finite dimensional parameters</p>
</td></tr>
<tr><td><code id="PseudoL_+3A_resdata">resData</code></td>
<td>
<p>Data matrix with three columns;  Z = the observed survival time, d1 = the censoring indicator of T
and  d2 =  the censoring indicator of C.</p>
</td></tr>
<tr><td><code id="PseudoL_+3A_x">X</code></td>
<td>
<p>Data matrix with covariates related to T</p>
</td></tr>
<tr><td><code id="PseudoL_+3A_w">W</code></td>
<td>
<p>Data matrix with covariates related to C. First column of W should be ones</p>
</td></tr>
<tr><td><code id="PseudoL_+3A_lhat">lhat</code></td>
<td>
<p>The estimated hazard function obtained from the output of <code><a href="#topic+SolveL">SolveL</a></code>.</p>
</td></tr>
<tr><td><code id="PseudoL_+3A_cuml">cumL</code></td>
<td>
<p>The estimated cumulative hazard function from the output of <code><a href="#topic+SolveL">SolveL</a></code>.</p>
</td></tr>
<tr><td><code id="PseudoL_+3A_cop">cop</code></td>
<td>
<p>Which copula should be computed to account for dependency between T and C. This argument can take
one of the values from <code>c("Gumbel", "Frank", "Normal")</code>. The default copula model is &quot;Frank&quot;.</p>
</td></tr>
<tr><td><code id="PseudoL_+3A_dist">dist</code></td>
<td>
<p>The distribution to  be used for the dependent censoring C. Only two distributions are allowed, i.e, Weibull
and lognormal distributions. With the value <code>"Weibull"</code> as the
default.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>maximized log-likelihood value
</p>

<hr>
<h2 id='SearchIndicate'>Search function</h2><span id='topic+SearchIndicate'></span>

<h3>Description</h3>

<p>Function to indicate position of t in observed survival time
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SearchIndicate(t, T1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SearchIndicate_+3A_t">t</code></td>
<td>
<p>fixed time t</p>
</td></tr>
<tr><td><code id="SearchIndicate_+3A_t1">T1</code></td>
<td>
<p>distinct observed survival time</p>
</td></tr>
</table>

<hr>
<h2 id='SolveL'>Cumulative hazard function of survival time under dependent censoring</h2><span id='topic+SolveL'></span>

<h3>Description</h3>

<p>This function estimates the cumulative hazard function of survival time (T) under dependent censoring (C). The estimation
makes use of the estimating equations derived based on martingale ideas.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SolveL(
  theta,
  resData,
  X,
  W,
  cop = c("Frank", "Gumbel", "Normal"),
  dist = c("Weibull", "lognormal")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SolveL_+3A_theta">theta</code></td>
<td>
<p>Estimated parameter values/initial values for finite dimensional parameters</p>
</td></tr>
<tr><td><code id="SolveL_+3A_resdata">resData</code></td>
<td>
<p>Data matrix with three columns;  Z = the observed survival time, d1 = the censoring indicator of T
and  d2 =  the censoring indicator of C.</p>
</td></tr>
<tr><td><code id="SolveL_+3A_x">X</code></td>
<td>
<p>Data matrix with covariates related to T</p>
</td></tr>
<tr><td><code id="SolveL_+3A_w">W</code></td>
<td>
<p>Data matrix with covariates related to C. First column of W should be ones</p>
</td></tr>
<tr><td><code id="SolveL_+3A_cop">cop</code></td>
<td>
<p>Which copula should be computed to account for dependency between T and C. This argument can take
one of the values from <code>c("Gumbel", "Frank", "Normal")</code>. The default copula model is &quot;Frank&quot;.</p>
</td></tr>
<tr><td><code id="SolveL_+3A_dist">dist</code></td>
<td>
<p>The distribution to  be used for the dependent censoring C. Only two distributions are allowed, i.e, Weibull
and lognormal distributions. With the value <code>"Weibull"</code> as the
default.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function returns an estimated hazard function,  cumulative hazard function and distinct observed survival times;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
n = 200
beta = c(0.5)
lambd = 0.35
eta = c(0.9,0.4)
X = cbind(rbinom(n,1,0.5))
W = cbind(rep(1,n),rbinom(n,1,0.5))
frank.cop &lt;- copula::frankCopula(param = 5,dim = 2)
U = copula::rCopula(n,frank.cop)
T1 = (-log(1-U[,1]))/(lambd*exp(X*beta))         # Survival time'
T2 = (-log(1-U[,2]))^(1.1)*exp(W%*%eta)          # Censoring time
A = runif(n,0,15)                                # administrative censoring time
Z = pmin(T1,T2,A)
d1 = as.numeric(Z==T1)
d2 = as.numeric(Z==T2)
resData = data.frame("Z" = Z,"d1" = d1, "d2" = d2)
theta = c(0.3,1,0.3,1,2)

# Estimate cumulative hazard function
cumFit &lt;- SolveL(theta, resData,X,W)
cumhaz = cumFit$cumhaz
time = cumFit$times

# plot hazard vs time

plot(time, cumhaz, type = "l",xlab = "Time",
ylab = "Estimated cumulative hazard function")



</code></pre>

<hr>
<h2 id='SolveLI'>Cumulative hazard function of survival time under independent censoring</h2><span id='topic+SolveLI'></span>

<h3>Description</h3>

<p>This function estimates the cumulative hazard function of survival time (T) under the assumption of independent censoring.
The estimating equation is derived based on martingale ideas.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SolveLI(theta, resData, X)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SolveLI_+3A_theta">theta</code></td>
<td>
<p>Estimated parameter values/initial values for finite dimensional parameters</p>
</td></tr>
<tr><td><code id="SolveLI_+3A_resdata">resData</code></td>
<td>
<p>Data matrix with three columns;  Z = the observed survival time, d1 = the censoring indicator of T
and  d2 =  the censoring indicator of C.</p>
</td></tr>
<tr><td><code id="SolveLI_+3A_x">X</code></td>
<td>
<p>Data matrix with covariates related to T</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function returns an estimated hazard function,  cumulative hazard function and distinct observed survival times;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
n = 200
beta = c(0.5)
lambd = 0.35
eta = c(0.9,0.4)
X = cbind(rbinom(n,1,0.5))
W = cbind(rep(1,n),rbinom(n,1,0.5))
frank.cop &lt;- copula::frankCopula(param = 5,dim = 2)
U = copula::rCopula(n,frank.cop)
T1 = (-log(1-U[,1]))/(lambd*exp(X*beta))           # Survival time'
T2 = (-log(1-U[,2]))^(1.1)*exp(W%*%eta)            # Censoring time
A = runif(n,0,15)                                  # administrative censoring time
Z = pmin(T1,T2,A)
d1 = as.numeric(Z==T1)
d2 = as.numeric(Z==T2)
resData = data.frame("Z" = Z,"d1" = d1, "d2" = d2)
theta = c(0.3,1,0.3,1)

# Estimate cumulative hazard function

cumFit_ind &lt;- SolveLI(theta, resData,X)

cumhaz = cumFit_ind$cumhaz
time = cumFit_ind$times

# plot hazard vs time

plot(time, cumhaz, type = "l",xlab = "Time",
ylab = "Estimated cumulative hazard function")




</code></pre>

<hr>
<h2 id='summary.depFit'>Summary of <code>depCensoringFit</code> object</h2><span id='topic+summary.depFit'></span>

<h3>Description</h3>

<p>Summary of <code>depCensoringFit</code> object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'depFit'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.depFit_+3A_object">object</code></td>
<td>
<p>Output of <code><a href="#topic+fitDepCens">fitDepCens</a></code> function</p>
</td></tr>
<tr><td><code id="summary.depFit_+3A_...">...</code></td>
<td>
<p>Further arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Summary of dependent censoring model fit in the form of table
</p>

<hr>
<h2 id='summary.indepFit'>Summary of <code>indepCensoringFit</code> object</h2><span id='topic+summary.indepFit'></span>

<h3>Description</h3>

<p>Summary of <code>indepCensoringFit</code> object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'indepFit'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.indepFit_+3A_object">object</code></td>
<td>
<p>Output of <code><a href="#topic+fitIndepCens">fitIndepCens</a></code> function</p>
</td></tr>
<tr><td><code id="summary.indepFit_+3A_...">...</code></td>
<td>
<p>Further arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Summary of independent censoring model fit in the form of table
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
