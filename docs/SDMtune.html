<!DOCTYPE html><html lang="en-US"><head><title>Help for package SDMtune</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {SDMtune}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#SDMtune-package'><p>SDMtune: Species Distribution Model Selection</p></a></li>
<li><a href='#addSamplesToBg'><p>Add Samples to Background</p></a></li>
<li><a href='#aicc'><p>AICc</p></a></li>
<li><a href='#ANN-class'><p>Artificial Neural Network</p></a></li>
<li><a href='#auc'><p>AUC</p></a></li>
<li><a href='#BRT-class'><p>Boosted Regression Tree</p></a></li>
<li><a href='#checkMaxentInstallation'><p>Check Maxent Installation</p></a></li>
<li><a href='#combineCV'><p>Combine Cross Validation models</p></a></li>
<li><a href='#confMatrix'><p>Confusion Matrix</p></a></li>
<li><a href='#corVar'><p>Print Correlated Variables</p></a></li>
<li><a href='#doJk'><p>Jackknife Test</p></a></li>
<li><a href='#getTunableArgs'><p>Get Tunable Arguments</p></a></li>
<li><a href='#gridSearch'><p>Grid Search</p></a></li>
<li><a href='#Maxent-class'><p>Maxent</p></a></li>
<li><a href='#maxentTh'><p>MaxEnt Thresholds</p></a></li>
<li><a href='#maxentVarImp'><p>Maxent Variable Importance</p></a></li>
<li><a href='#Maxnet-class'><p>Maxnet</p></a></li>
<li><a href='#mergeSWD'><p>Merge SWD Objects</p></a></li>
<li><a href='#modelReport'><p>Model Report</p></a></li>
<li><a href='#optimizeModel'><p>Optimize Model</p></a></li>
<li><a href='#plotCor'><p>Plot Correlation</p></a></li>
<li><a href='#plotJk'><p>Plot Jackknife Test</p></a></li>
<li><a href='#plotPA'><p>Plot Presence Absence Map</p></a></li>
<li><a href='#plotPred'><p>Plot Prediction</p></a></li>
<li><a href='#plotResponse'><p>Plot Response Curve</p></a></li>
<li><a href='#plotROC'><p>Plot ROC curve</p></a></li>
<li><a href='#plotVarImp'><p>Plot Variable Importance</p></a></li>
<li><a href='#predict+2CANN-method'><p>Predict ANN</p></a></li>
<li><a href='#predict+2CBRT-method'><p>Predict BRT</p></a></li>
<li><a href='#predict+2CMaxent-method'><p>Predict Maxent</p></a></li>
<li><a href='#predict+2CMaxnet-method'><p>Predict Maxnet</p></a></li>
<li><a href='#predict+2CRF-method'><p>Predict RF</p></a></li>
<li><a href='#predict+2CSDMmodel-method'><p>Predict</p></a></li>
<li><a href='#predict+2CSDMmodelCV-method'><p>Predict for Cross Validation</p></a></li>
<li><a href='#prepareSWD'><p>Prepare an SWD object</p></a></li>
<li><a href='#randomFolds'><p>Create Random Folds</p></a></li>
<li><a href='#randomSearch'><p>Random Search</p></a></li>
<li><a href='#reduceVar'><p>Reduce Variables</p></a></li>
<li><a href='#RF-class'><p>Random Forest</p></a></li>
<li><a href='#SDMmodel-class'><p>SDMmodel</p></a></li>
<li><a href='#SDMmodel2MaxEnt'><p>SDMmodel2MaxEnt</p></a></li>
<li><a href='#SDMmodelCV-class'><p>SDMmodelCV</p></a></li>
<li><a href='#SDMtune-class'><p>SDMtune class</p></a></li>
<li><a href='#SWD-class'><p>Sample With Data</p></a></li>
<li><a href='#swd2csv'><p>SWD to csv</p></a></li>
<li><a href='#thinData'><p>Thin Data</p></a></li>
<li><a href='#thresholds'><p>Thresholds</p></a></li>
<li><a href='#train'><p>Train</p></a></li>
<li><a href='#trainValTest'><p>Train, Validation and Test datasets</p></a></li>
<li><a href='#tss'><p>True Skill Statistics</p></a></li>
<li><a href='#varImp'><p>Variable Importance</p></a></li>
<li><a href='#varSel'><p>Variable Selection</p></a></li>
<li><a href='#virtualSp'><p>Virtual Species</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Species Distribution Model Selection</td>
</tr>
<tr>
<td>Version:</td>
<td>1.3.2</td>
</tr>
<tr>
<td>Description:</td>
<td>User-friendly framework that enables the training and the
    evaluation of species distribution models (SDMs). The package implements
    functions for data driven variable selection and model tuning and includes
    numerous utilities to display the results. All the functions used to select
    variables or to tune model hyperparameters have an interactive real-time
    chart displayed in the 'RStudio' viewer pane during their execution.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://consbiol-unibern.github.io/SDMtune/">https://consbiol-unibern.github.io/SDMtune/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/ConsBiol-unibern/SDMtune/issues">https://github.com/ConsBiol-unibern/SDMtune/issues</a></td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>Java (&gt;= 8)</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.1.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>cli (&ge; 3.4.1), dismo (&ge; 1.3-9), gbm (&ge; 2.1.5), ggplot2 (&ge;
3.4.0), jsonlite (&ge; 1.6), maxnet (&ge; 0.1.4), methods, nnet (&ge;
7.3-12), randomForest (&ge; 4.6-14), Rcpp (&ge; 1.0.1), rlang (&ge;
0.4.5), rstudioapi (&ge; 0.10), stringr (&ge; 1.4.0), terra (&ge;
1.6-47), whisker (&ge; 0.3-2)</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Suggests:</td>
<td>covr, htmltools (&ge; 0.3.6), kableExtra (&ge; 1.1.0), knitr (&ge;
1.23), maps (&ge; 3.3.0), pkgdown (&ge; 2.0.7), plotROC (&ge; 2.2.1),
rasterVis (&ge; 0.50), reshape2 (&ge; 1.4.3), rJava (&ge; 0.9-11),
rmarkdown (&ge; 2.16), scales (&ge; 1.0.0), testthat (&ge; 3.1.7),
withr (&ge; 2.5.0), zeallot (&ge; 0.1.0)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Collate:</td>
<td>'ANN-class.R' 'BRT-class.R' 'Maxent-class.R' 'Maxnet-class.R'
'RF-class.R' 'RcppExports.R' 'SWD-class.R' 'SDMmodel-class.R'
'SDMmodel2MaxEnt.R' 'SDMmodelCV-class.R' 'SDMtune-class.R'
'SDMtune-package.R' 'addSamplesToBg.R' 'aicc.R' 'auc.R'
'chart-utils.R' 'checkMaxentInstallation.R' 'combineCV.R'
'confMatrix.R' 'convertFolds.R' 'corVar.R' 'doJk.R'
'getTunableArgs.R' 'gridSearch.R' 'maxentTh.R' 'maxentVarImp.R'
'mergeSWD.R' 'modelReport.R' 'optimizeModel.R' 'plotCor.R'
'plotJk.R' 'plotPA.R' 'plotPred.R' 'plotROC.R' 'plotResponse.R'
'plotVarImp.R' 'predict-ANN.R' 'predict-BRT.R'
'predict-Maxent.R' 'predict-Maxnet.R' 'predict-RF.R'
'predict-SDMmodel.R' 'predict-SDMmodelCV.R' 'prepareSWD.R'
'randomFolds.R' 'randomSearch.R' 'reduceVar.R' 'swd2csv.R'
'thinData.R' 'thresholds.R' 'train.R' 'trainANN.R' 'trainBRT.R'
'trainMaxent.R' 'trainMaxnet.R' 'trainRF.R' 'trainValTest.R'
'tss.R' 'utils.R' 'varImp.R' 'varSel.R' 'virtualSp.R' 'zzz.R'</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-12-16 16:09:52 UTC; vignali</td>
</tr>
<tr>
<td>Author:</td>
<td>Sergio Vignali <a href="https://orcid.org/0000-0002-3390-5442"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Arnaud Barras <a href="https://orcid.org/0000-0003-0850-6965"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Veronika Braunisch
    <a href="https://orcid.org/0000-0001-7035-4662"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Conservation Biology - University of Bern [fnd]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Sergio Vignali &lt;sdmtune@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-12-16 16:50:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='SDMtune-package'>SDMtune: Species Distribution Model Selection</h2><span id='topic+SDMtune-package'></span>

<h3>Description</h3>

<p><img src="../help/figures/logo.png" style='float: right' alt='logo' width='120' />
</p>
<p>User-friendly framework that enables the training and the evaluation of species distribution models (SDMs). The package implements functions for data driven variable selection and model tuning and includes numerous utilities to display the results. All the functions used to select variables or to tune model hyperparameters have an interactive real-time chart displayed in the 'RStudio' viewer pane during their execution.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Sergio Vignali <a href="mailto:sdmtune@gmail.com">sdmtune@gmail.com</a> (<a href="https://orcid.org/0000-0002-3390-5442">ORCID</a>)
</p>
<p>Authors:
</p>

<ul>
<li><p> Arnaud Barras (<a href="https://orcid.org/0000-0003-0850-6965">ORCID</a>)
</p>
</li>
<li><p> Veronika Braunisch (<a href="https://orcid.org/0000-0001-7035-4662">ORCID</a>)
</p>
</li></ul>

<p>Other contributors:
</p>

<ul>
<li><p> Conservation Biology - University of Bern [funder]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://consbiol-unibern.github.io/SDMtune/">https://consbiol-unibern.github.io/SDMtune/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/ConsBiol-unibern/SDMtune/issues">https://github.com/ConsBiol-unibern/SDMtune/issues</a>
</p>
</li></ul>


<hr>
<h2 id='addSamplesToBg'>Add Samples to Background</h2><span id='topic+addSamplesToBg'></span>

<h3>Description</h3>

<p>The function add the presence locations to the background. This is equivalent
to the Maxent argument <code>addsamplestobackground=true</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>addSamplesToBg(x, all = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="addSamplesToBg_+3A_x">x</code></td>
<td>
<p><a href="#topic+SWD-class">SWD</a> object.</p>
</td></tr>
<tr><td><code id="addSamplesToBg_+3A_all">all</code></td>
<td>
<p>logical. If <code>TRUE</code> it adds all the presence locations even if
already included in the background locations. This is equivalent to the
Maxent argument <code>addallsamplestobackground=true</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <a href="#topic+SWD-class">SWD</a>.
</p>


<h3>Author(s)</h3>

<p>Sergio Vignali
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Acquire environmental variables
files &lt;- list.files(path = file.path(system.file(package = "dismo"), "ex"),
                    pattern = "grd",
                    full.names = TRUE)

predictors &lt;- terra::rast(files)

# Prepare presence and background locations
p_coords &lt;- virtualSp$presence
bg_coords &lt;- virtualSp$background

# Create SWD object
data &lt;- prepareSWD(species = "Virtual species",
                   p = p_coords,
                   a = bg_coords,
                   env = predictors,
                   categorical = "biome")
data

# Add presence locations with values not included in the backgrounds to the
# background locations
new_data &lt;- addSamplesToBg(data)
new_data

# Add all the presence locations to the background locations, even if they
# have values already included in the backgrounds
new_data &lt;- addSamplesToBg(data,
                           all = TRUE)
new_data
</code></pre>

<hr>
<h2 id='aicc'>AICc</h2><span id='topic+aicc'></span>

<h3>Description</h3>

<p>Compute the Akaike Information Criterion corrected for small samples size
(Warren and Seifert, 2011).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aicc(model, env)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="aicc_+3A_model">model</code></td>
<td>
<p><a href="#topic+SDMmodel-class">SDMmodel</a> object.</p>
</td></tr>
<tr><td><code id="aicc_+3A_env">env</code></td>
<td>
<p><a href="terra.html#topic+rast">rast</a> containing the environmental variables.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function is available only for <strong>Maxent</strong> and <strong>Maxnet</strong>
methods.
</p>


<h3>Value</h3>

<p>The computed AICc
</p>


<h3>Author(s)</h3>

<p>Sergio Vignali
</p>


<h3>References</h3>

<p>Warren D.L., Seifert S.N., (2011). Ecological niche modeling in
Maxent: the importance of model complexity and the performance of model
selection criteria. Ecological Applications, 21(2), 335–342.
</p>


<h3>See Also</h3>

<p><a href="#topic+auc">auc</a> and <a href="#topic+tss">tss</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Acquire environmental variables
files &lt;- list.files(path = file.path(system.file(package = "dismo"), "ex"),
                    pattern = "grd",
                   full.names = TRUE)

predictors &lt;- terra::rast(files)

# Prepare presence and background locations
p_coords &lt;- virtualSp$presence
bg_coords &lt;- virtualSp$background

# Create SWD object
data &lt;- prepareSWD(species = "Virtual species",
                   p = p_coords,
                   a = bg_coords,
                   env = predictors,
                   categorical = "biome")

# Train a model
model &lt;- train(method = "Maxnet",
               data = data,
               fc = "l")

# Compute the AICc
aicc(model,
     env = predictors)
</code></pre>

<hr>
<h2 id='ANN-class'>Artificial Neural Network</h2><span id='topic+ANN-class'></span><span id='topic+ANN'></span><span id='topic+show+2CANN-method'></span>

<h3>Description</h3>

<p>This Class represents an Artificial Neural Network model object and hosts
all the information related to the model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'ANN'
show(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ANN-class_+3A_object">object</code></td>
<td>
<p>ANN object</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See <a href="nnet.html#topic+nnet">nnet</a> for the meaning of the slots.
</p>


<h3>Slots</h3>


<dl>
<dt><code>size</code></dt><dd><p>integer. Number of the units in the hidden layer.</p>
</dd>
<dt><code>decay</code></dt><dd><p>numeric. Weight decay.</p>
</dd>
<dt><code>rang</code></dt><dd><p>numeric. Initial random weights.</p>
</dd>
<dt><code>maxit</code></dt><dd><p>integer. Maximum number of iterations.</p>
</dd>
<dt><code>model</code></dt><dd><p><a href="nnet.html#topic+nnet">nnet</a>. The nnet model object.</p>
</dd>
</dl>


<h3>Author(s)</h3>

<p>Sergio Vignali
</p>

<hr>
<h2 id='auc'>AUC</h2><span id='topic+auc'></span>

<h3>Description</h3>

<p>Compute the AUC using the Man-Whitney U Test formula.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>auc(model, test = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="auc_+3A_model">model</code></td>
<td>
<p>An <a href="#topic+SDMmodel-class">SDMmodel</a> or <a href="#topic+SDMmodelCV-class">SDMmodelCV</a> object.</p>
</td></tr>
<tr><td><code id="auc_+3A_test">test</code></td>
<td>
<p><a href="#topic+SWD-class">SWD</a> object when <code>model</code> is an
<a href="#topic+SDMmodel-class">SDMmodel</a> object; logical or <a href="#topic+SWD-class">SWD</a> object when
<code>model</code> is an <a href="#topic+SDMmodelCV-class">SDMmodelCV</a> object. If not provided it computes
the training AUC, see details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For <a href="#topic+SDMmodelCV-class">SDMmodelCV</a> objects, the function computes the mean
of the training AUC values of the k-folds. If <code>test = TRUE</code> it computes the
mean of the testing AUC values for the k-folds. If test is an
<a href="#topic+SWD-class">SWD</a> object, it computes the mean AUC values for the provided
testing dataset.
</p>


<h3>Value</h3>

<p>The value of the AUC.
</p>


<h3>Author(s)</h3>

<p>Sergio Vignali
</p>


<h3>References</h3>

<p>Mason, S. J. and Graham, N. E. (2002), Areas beneath the relative
operating characteristics (ROC) and relative operating levels (ROL) curves:
Statistical significance and interpretation. Q.J.R. Meteorol. Soc., 128:
2145-2166.
</p>


<h3>See Also</h3>

<p><a href="#topic+aicc">aicc</a> and <a href="#topic+tss">tss</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Acquire environmental variables
files &lt;- list.files(path = file.path(system.file(package = "dismo"), "ex"),
                    pattern = "grd",
                    full.names = TRUE)

predictors &lt;- terra::rast(files)

# Prepare presence and background locations
p_coords &lt;- virtualSp$presence
bg_coords &lt;- virtualSp$background

# Create SWD object
data &lt;- prepareSWD(species = "Virtual species",
                   p = p_coords,
                   a = bg_coords,
                   env = predictors,
                   categorical = "biome")

# Split presence locations in training (80%) and testing (20%) datasets
datasets &lt;- trainValTest(data,
                         test = 0.2,
                         only_presence = TRUE)
train &lt;- datasets[[1]]
test &lt;- datasets[[2]]

# Train a model
model &lt;- train(method = "Maxnet",
               data = train,
               fc = "l")

# Compute the training AUC
auc(model)

# Compute the testing AUC
auc(model,
    test = test)

# Same example but using cross validation instead of training and testing
# datasets
folds &lt;- randomFolds(data,
                     k = 4,
                     only_presence = TRUE)

model &lt;- train(method = "Maxnet",
               data = data,
               fc = "l",
               folds = folds)

# Compute the training AUC
auc(model)

# Compute the testing AUC
auc(model,
    test = TRUE)

# Compute the AUC for the held apart testing dataset
auc(model,
    test = test)
</code></pre>

<hr>
<h2 id='BRT-class'>Boosted Regression Tree</h2><span id='topic+BRT-class'></span><span id='topic+BRT'></span><span id='topic+show+2CBRT-method'></span>

<h3>Description</h3>

<p>This Class represents a Boosted Regression Tree model objects and hosts all
the information related to the model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'BRT'
show(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BRT-class_+3A_object">object</code></td>
<td>
<p>BRT object</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See <a href="gbm.html#topic+gbm">gbm</a> for the meaning of the slots.
</p>


<h3>Slots</h3>


<dl>
<dt><code>distribution</code></dt><dd><p>character. Name of the used distribution.</p>
</dd>
<dt><code>n.trees</code></dt><dd><p>integer. Maximum number of grown trees.</p>
</dd>
<dt><code>interaction.depth</code></dt><dd><p>integer. Maximum depth of each tree.</p>
</dd>
<dt><code>shrinkage</code></dt><dd><p>numeric. The shrinkage parameter.</p>
</dd>
<dt><code>bag.fraction</code></dt><dd><p>numeric. Random fraction of data used in the tree
expansion.</p>
</dd>
<dt><code>model</code></dt><dd><p><a href="gbm.html#topic+gbm">gbm</a>. The Boosted Regression Tree model object.</p>
</dd>
</dl>


<h3>Author(s)</h3>

<p>Sergio Vignali
</p>

<hr>
<h2 id='checkMaxentInstallation'>Check Maxent Installation</h2><span id='topic+checkMaxentInstallation'></span>

<h3>Description</h3>

<p>The function checks if Maxent is correctly installed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>checkMaxentInstallation(verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="checkMaxentInstallation_+3A_verbose">verbose</code></td>
<td>
<p>logical, if <code>TRUE</code> the function provides useful messages to
understand what is not correctly installed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In order to have Maxent correctly configured is necessary that:
</p>

<ul>
<li><p> Java is installed;
</p>
</li>
<li><p> the package &quot;rJava&quot; is installed;
</p>
</li>
<li><p> the file &quot;maxent.jar&quot; is in the correct folder.
</p>
</li></ul>



<h3>Value</h3>

<p><code>TRUE</code> if Maxent is correctly installed, <code>FALSE</code> otherwise.
</p>


<h3>Author(s)</h3>

<p>Sergio Vignali
</p>


<h3>Examples</h3>

<pre><code class='language-R'>checkMaxentInstallation()
</code></pre>

<hr>
<h2 id='combineCV'>Combine Cross Validation models</h2><span id='topic+combineCV'></span>

<h3>Description</h3>

<p>This function combines cross-validation models by retraining a new model with
all presence and absence/background locations and the same hyperparameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>combineCV(model)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="combineCV_+3A_model">model</code></td>
<td>
<p><a href="#topic+SDMmodelCV-class">SDMmodelCV</a> object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is an utility function to retrain a model with all data after,
for example, the hyperparameters tuning (<a href="#topic+gridSearch">gridSearch</a>,
<a href="#topic+randomSearch">randomSearch</a> or <a href="#topic+optimizeModel">optimizeModel</a>) to avoid manual setting of the
hyperparameters in the <a href="#topic+train">train</a> function.
</p>


<h3>Value</h3>

<p>An <a href="#topic+SDMmodel-class">SDMmodel</a> object.
</p>


<h3>Author(s)</h3>

<p>Sergio Vignali
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Acquire environmental variables
files &lt;- list.files(path = file.path(system.file(package = "dismo"), "ex"),
                    pattern = "grd",
                    full.names = TRUE)

predictors &lt;- terra::rast(files)

# Prepare presence and background locations
p_coords &lt;- virtualSp$presence
bg_coords &lt;- virtualSp$background

# Create SWD object
data &lt;- prepareSWD(species = "Virtual species",
                   p = p_coords,
                   a = bg_coords,
                   env = predictors,
                   categorical = "biome")

# Create 4 random folds splitting only the presence data
folds &lt;- randomFolds(data,
                     k = 4,
                     only_presence = TRUE)

model &lt;- train(method = "Maxnet",
               data = data,
               folds = folds)

# Define the hyperparameters to test
h &lt;- list(reg = 1:2,
          fc = c("lqp", "lqph"))

# Run the function using the AUC as metric
output &lt;- gridSearch(model,
                     hypers = h,
                     metric = "auc")
output@results
output@models

# Order results by highest test AUC
output@results[order(-output@results$test_AUC), ]

# Combine cross validation models for output with highest test AUC
idx &lt;- which.max(output@results$test_AUC)
combined_model &lt;- combineCV(output@models[[idx]])
combined_model
</code></pre>

<hr>
<h2 id='confMatrix'>Confusion Matrix</h2><span id='topic+confMatrix'></span>

<h3>Description</h3>

<p>Computes Confusion Matrixes for threshold values varying from 0 to 1.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>confMatrix(model, test = NULL, th = NULL, type = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="confMatrix_+3A_model">model</code></td>
<td>
<p><a href="#topic+SDMmodel-class">SDMmodel</a> object.</p>
</td></tr>
<tr><td><code id="confMatrix_+3A_test">test</code></td>
<td>
<p><a href="#topic+SWD-class">SWD</a> testing locations, if not provided it uses the
training dataset.</p>
</td></tr>
<tr><td><code id="confMatrix_+3A_th">th</code></td>
<td>
<p>numeric vector. If provided it computes the evaluation at the given
thresholds. Default is <code>NULL</code> and it computes the evaluation for the unique
predicted values at presence and absence/background locations.</p>
</td></tr>
<tr><td><code id="confMatrix_+3A_type">type</code></td>
<td>
<p>character. The output type used for &quot;Maxent&quot; and &quot;Maxnet&quot;
methods, possible values are &quot;cloglog&quot; and &quot;logistic&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p> For models trained with the <strong>Maxent</strong> method the argument <code>type</code> can be:
&quot;raw&quot;, &quot;logistic&quot; and &quot;cloglog&quot;.
</p>
</li>
<li><p> For models trained with the <strong>Maxnet</strong> method the argument <code>type</code> can be:
&quot;link&quot;, &quot;exponential&quot;, &quot;logistic&quot; and &quot;cloglog&quot;, see <a href="maxnet.html#topic+maxnet">maxnet</a>
for more details.
</p>
</li></ul>



<h3>Value</h3>

<p>The Confusion Matrix for all the used thresholds.
</p>


<h3>Author(s)</h3>

<p>Sergio Vignali
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Acquire environmental variables
files &lt;- list.files(path = file.path(system.file(package = "dismo"), "ex"),
                    pattern = "grd",
                    full.names = TRUE)

predictors &lt;- terra::rast(files)

# Prepare presence and background locations
p_coords &lt;- virtualSp$presence
bg_coords &lt;- virtualSp$background

# Create SWD object
data &lt;- prepareSWD(species = "Virtual species",
                   p = p_coords,
                   a = bg_coords,
                   env = predictors,
                   categorical = "biome")

# Train a model
model &lt;- train(method = "Maxnet",
               data = data,
               fc = "l")

# Get the confusion matrix for thresholds ranging from 0 to 1
cm &lt;- confMatrix(model,
                 type = "cloglog")
head(cm)
tail(cm)

# Get the confusion matrix for a specific threshold
confMatrix(model,
           type = "logistic",
           th = 0.6)
</code></pre>

<hr>
<h2 id='corVar'>Print Correlated Variables</h2><span id='topic+corVar'></span>

<h3>Description</h3>

<p>Utility that prints the name of correlated variables and the relative
correlation coefficient value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>corVar(
  bg,
  method = "spearman",
  cor_th = NULL,
  order = TRUE,
  remove_diagonal = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="corVar_+3A_bg">bg</code></td>
<td>
<p><a href="#topic+SWD-class">SWD</a> object with the locations used to compute the
correlation between environmental variables.</p>
</td></tr>
<tr><td><code id="corVar_+3A_method">method</code></td>
<td>
<p>character. The method used to compute the correlation matrix.</p>
</td></tr>
<tr><td><code id="corVar_+3A_cor_th">cor_th</code></td>
<td>
<p>numeric. If provided it prints only the variables whose
correlation coefficient is higher or lower than the given threshold.</p>
</td></tr>
<tr><td><code id="corVar_+3A_order">order</code></td>
<td>
<p>logical. If <code>TRUE</code> the variable are ordered from the most to the
less highly correlated.</p>
</td></tr>
<tr><td><code id="corVar_+3A_remove_diagonal">remove_diagonal</code></td>
<td>
<p>logical. If <code>TRUE</code> the values in the diagonal are
removed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame with the variables and their correlation.
</p>


<h3>Author(s)</h3>

<p>Sergio Vignali
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Acquire environmental variables
files &lt;- list.files(path = file.path(system.file(package = "dismo"), "ex"),
                    pattern = "grd",
                    full.names = TRUE)

predictors &lt;- terra::rast(files)

# Prepare background locations
bg_coords &lt;- terra::spatSample(predictors,
                               size = 10000,
                               method = "random",
                               na.rm = TRUE,
                               xy = TRUE,
                               values = FALSE)

# Create SWD object
bg &lt;- prepareSWD(species = "Virtual species",
                 a = bg_coords,
                 env = predictors,
                 categorical = "biome")

# Get the correlation among all the environmental variables
corVar(bg,
       method = "spearman")

# Get the environmental variables that have a correlation greater or equal to
# the given threshold
corVar(bg,
       method = "pearson",
       cor_th = 0.8)
</code></pre>

<hr>
<h2 id='doJk'>Jackknife Test</h2><span id='topic+doJk'></span>

<h3>Description</h3>

<p>Run the Jackknife test for variable importance removing one variable at time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>doJk(
  model,
  metric,
  variables = NULL,
  test = NULL,
  with_only = TRUE,
  env = NULL,
  return_models = FALSE,
  progress = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="doJk_+3A_model">model</code></td>
<td>
<p><a href="#topic+SDMmodel-class">SDMmodel</a> or <a href="#topic+SDMmodelCV-class">SDMmodelCV</a> object.</p>
</td></tr>
<tr><td><code id="doJk_+3A_metric">metric</code></td>
<td>
<p>character. The metric used to evaluate the models, possible
values are: &quot;auc&quot;, &quot;tss&quot; and &quot;aicc&quot;.</p>
</td></tr>
<tr><td><code id="doJk_+3A_variables">variables</code></td>
<td>
<p>vector. Variables used for the test, if not provided it
takes all the variables used to train the model.</p>
</td></tr>
<tr><td><code id="doJk_+3A_test">test</code></td>
<td>
<p><a href="#topic+SWD-class">SWD</a>. If provided it reports the result also for the
testing dataset. Not used for <strong>aicc</strong> and <a href="#topic+SDMmodelCV-class">SDMmodelCV</a>.</p>
</td></tr>
<tr><td><code id="doJk_+3A_with_only">with_only</code></td>
<td>
<p>logical. If <code>TRUE</code> it runs the test also for each variable
in isolation.</p>
</td></tr>
<tr><td><code id="doJk_+3A_env">env</code></td>
<td>
<p><a href="terra.html#topic+rast">rast</a> containing the environmental variables, used
only with &quot;aicc&quot;.</p>
</td></tr>
<tr><td><code id="doJk_+3A_return_models">return_models</code></td>
<td>
<p>logical. If <code>TRUE</code> returns all the models together with
the test result.</p>
</td></tr>
<tr><td><code id="doJk_+3A_progress">progress</code></td>
<td>
<p>logical If <code>TRUE</code> shows a progress bar.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with the test results. If <code>return_model = TRUE</code> it
returns a list containing the test results together with the models.
</p>


<h3>Author(s)</h3>

<p>Sergio Vignali
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Acquire environmental variables
files &lt;- list.files(path = file.path(system.file(package = "dismo"), "ex"),
                    pattern = "grd",
                    full.names = TRUE)

predictors &lt;- terra::rast(files)

# Prepare presence and background locations
p_coords &lt;- virtualSp$presence
bg_coords &lt;- virtualSp$background

# Create SWD object
data &lt;- prepareSWD(species = "Virtual species",
                   p = p_coords,
                   a = bg_coords,
                   env = predictors,
                   categorical = "biome")

# Split presence locations in training (80%) and testing (20%) datasets
datasets &lt;- trainValTest(data,
                         test = 0.2,
                         only_presence = TRUE)
train &lt;- datasets[[1]]
test &lt;- datasets[[2]]

# Train a model
model &lt;- train(method = "Maxnet",
               data = train,
               fc = "lq")

# Execute the Jackknife test only for the environmental variables "bio1" and
# "bio12", using the metric AUC
doJk(model,
     metric = "auc",
    variables = c("bio1", "bio12"),
    test = test)

# The same without testing dataset
doJk(model,
     metric = "auc",
     variables = c("bio1", "bio12"))

# Execute the Jackknife test only for the environmental variables "bio1" and
# "bio12", using the metric TSS but without running the test for one single
# variable
doJk(model,
     metric = "tss",
     variables = c("bio1", "bio12"),
     test = test,
     with_only = FALSE)

# Execute the Jackknife test only for the environmental variables "bio1" and
# "bio12", using the metric AICc but without running the test for one single
# variable
doJk(model,
     metric = "aicc",
     variables = c("bio1", "bio12"),
     with_only = FALSE,
     env = predictors)

# Execute the Jackknife test for all the environmental variables using the
# metric AUC and returning all the trained models
jk &lt;- doJk(model,
           metric = "auc",
           test = test,
           return_models = TRUE)

jk$results
jk$models_without
jk$models_withonly
</code></pre>

<hr>
<h2 id='getTunableArgs'>Get Tunable Arguments</h2><span id='topic+getTunableArgs'></span>

<h3>Description</h3>

<p>Returns the name of all function arguments that can be tuned for a given
model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getTunableArgs(model)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getTunableArgs_+3A_model">model</code></td>
<td>
<p><a href="#topic+SDMmodel-class">SDMmodel</a> or <a href="#topic+SDMmodelCV-class">SDMmodelCV</a> object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>character vector.
</p>


<h3>Author(s)</h3>

<p>Sergio Vignali
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Acquire environmental variables
files &lt;- list.files(path = file.path(system.file(package = "dismo"), "ex"),
                    pattern = "grd",
                    full.names = TRUE)

predictors &lt;- terra::rast(files)

# Prepare presence and background locations
p_coords &lt;- virtualSp$presence
bg_coords &lt;- virtualSp$background

# Create SWD object
data &lt;- prepareSWD(species = "Virtual species",
                   p = p_coords,
                   a = bg_coords,
                   env = predictors,
                   categorical = "biome")

# Train a Maxnet model and get tunable hyperparameters
model &lt;- train(method = "Maxnet",
               data = data,
               fc = "l")

getTunableArgs(model)
</code></pre>

<hr>
<h2 id='gridSearch'>Grid Search</h2><span id='topic+gridSearch'></span>

<h3>Description</h3>

<p>Given a set of possible hyperparameter values, the function trains models
with all the possible combinations of hyperparameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gridSearch(
  model,
  hypers,
  metric,
  test = NULL,
  env = NULL,
  save_models = TRUE,
  interactive = TRUE,
  progress = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gridSearch_+3A_model">model</code></td>
<td>
<p><a href="#topic+SDMmodel-class">SDMmodel</a> or <a href="#topic+SDMmodelCV-class">SDMmodelCV</a> object.</p>
</td></tr>
<tr><td><code id="gridSearch_+3A_hypers">hypers</code></td>
<td>
<p>named list containing the values of the hyperparameters that
should be tuned, see details.</p>
</td></tr>
<tr><td><code id="gridSearch_+3A_metric">metric</code></td>
<td>
<p>character. The metric used to evaluate the models, possible
values are: &quot;auc&quot;, &quot;tss&quot; and &quot;aicc&quot;.</p>
</td></tr>
<tr><td><code id="gridSearch_+3A_test">test</code></td>
<td>
<p><a href="#topic+SWD-class">SWD</a> object. Testing dataset used to evaluate the
model, not used with <a href="#topic+aicc">aicc</a> and <a href="#topic+SDMmodelCV-class">SDMmodelCV</a> objects.</p>
</td></tr>
<tr><td><code id="gridSearch_+3A_env">env</code></td>
<td>
<p><a href="terra.html#topic+rast">rast</a> containing the environmental variables, used
only with &quot;aicc&quot;.</p>
</td></tr>
<tr><td><code id="gridSearch_+3A_save_models">save_models</code></td>
<td>
<p>logical. If <code>FALSE</code> the models are not saved and the
output contains only a data frame with the metric values for each
hyperparameter combination. Set it to <code>FALSE</code> when there are many
combinations to avoid R crashing for memory overload.</p>
</td></tr>
<tr><td><code id="gridSearch_+3A_interactive">interactive</code></td>
<td>
<p>logical. If <code>FALSE</code> the interactive chart is not created.</p>
</td></tr>
<tr><td><code id="gridSearch_+3A_progress">progress</code></td>
<td>
<p>logical. If <code>TRUE</code> shows a progress bar.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To know which hyperparameters can be tuned you can use the output
of the function <a href="#topic+getTunableArgs">getTunableArgs</a>. Hyperparameters not included in the
<code>hypers</code> argument take the value that they have in the passed model.
</p>
<p>An interactive chart showing in real-time the steps performed by the
algorithm is displayed in the Viewer pane.
</p>


<h3>Value</h3>

<p><a href="#topic+SDMtune-class">SDMtune</a> object.
</p>


<h3>Author(s)</h3>

<p>Sergio Vignali
</p>


<h3>See Also</h3>

<p><a href="#topic+randomSearch">randomSearch</a> and <a href="#topic+optimizeModel">optimizeModel</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Acquire environmental variables
files &lt;- list.files(path = file.path(system.file(package = "dismo"), "ex"),
                    pattern = "grd",
                    full.names = TRUE)

predictors &lt;- terra::rast(files)

# Prepare presence and background locations
p_coords &lt;- virtualSp$presence
bg_coords &lt;- virtualSp$background

# Create SWD object
data &lt;- prepareSWD(species = "Virtual species",
                   p = p_coords,
                   a = bg_coords,
                   env = predictors,
                   categorical = "biome")

# Split presence locations in training (80%) and testing (20%) datasets
datasets &lt;- trainValTest(data,
                         test = 0.2,
                         only_presence = TRUE)
train &lt;- datasets[[1]]
test &lt;- datasets[[2]]

# Train a model
model &lt;- train(method = "Maxnet",
               data = train,
               fc = "l")

# Define the hyperparameters to test
h &lt;- list(reg = 1:2,
          fc = c("lqp", "lqph"))

# Run the function using the AUC as metric
output &lt;- gridSearch(model,
                     hypers = h,
                     metric = "auc",
                     test = test)
output@results
output@models

# Order results by highest test AUC
output@results[order(-output@results$test_AUC), ]

# Run the function using the AICc as metric and without saving the trained
# models, helpful when numerous hyperparameters are tested to avoid memory
# problems
output &lt;- gridSearch(model,
                     hypers = h,
                     metric = "aicc",
                     env = predictors,
                     save_models = FALSE)
output@results
</code></pre>

<hr>
<h2 id='Maxent-class'>Maxent</h2><span id='topic+Maxent-class'></span><span id='topic+Maxent'></span><span id='topic+show+2CMaxent-method'></span>

<h3>Description</h3>

<p>This Class represents a MaxEnt model objects and hosts all the information
related to the model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'Maxent'
show(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Maxent-class_+3A_object">object</code></td>
<td>
<p>Maxent object</p>
</td></tr>
</table>


<h3>Slots</h3>


<dl>
<dt><code>results</code></dt><dd><p>matrix. The result that usually MaxEnt provide as a csv file.</p>
</dd>
<dt><code>reg</code></dt><dd><p>numeric. The value of the regularization multiplier used to train
the model.</p>
</dd>
<dt><code>fc</code></dt><dd><p>character. The feature class combination used to train the model.</p>
</dd>
<dt><code>iter</code></dt><dd><p>numeric. The number of iterations used to train the model.</p>
</dd>
<dt><code>extra_args</code></dt><dd><p>character. Extra arguments used to run MaxEnt.</p>
</dd>
<dt><code>lambdas</code></dt><dd><p>vector. The lambdas parameters of the model.</p>
</dd>
<dt><code>coeff</code></dt><dd><p>data.frame. The lambda coefficients of the model.</p>
</dd>
<dt><code>formula</code></dt><dd><p>formula. The formula used to make prediction.</p>
</dd>
<dt><code>lpn</code></dt><dd><p>numeric. Linear Predictor Normalizer.</p>
</dd>
<dt><code>dn</code></dt><dd><p>numeric. Density Normalizer.</p>
</dd>
<dt><code>entropy</code></dt><dd><p>numeric. The entropy value.</p>
</dd>
<dt><code>min_max</code></dt><dd><p>data.frame. The minimum and maximum values of the continuous
variables, used for clamping.</p>
</dd>
</dl>


<h3>Author(s)</h3>

<p>Sergio Vignali
</p>

<hr>
<h2 id='maxentTh'>MaxEnt Thresholds</h2><span id='topic+maxentTh'></span>

<h3>Description</h3>

<p>Returns the value of the thresholds generated by the MaxEnt software.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>maxentTh(model)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="maxentTh_+3A_model">model</code></td>
<td>
<p><a href="#topic+SDMmodel-class">SDMmodel</a> object trained using the &quot;Maxent&quot; method.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data.frame with the thresholds.
</p>


<h3>Author(s)</h3>

<p>Sergio Vignali
</p>


<h3>See Also</h3>

<p><a href="#topic+maxentVarImp">maxentVarImp</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Acquire environmental variables
files &lt;- list.files(path = file.path(system.file(package = "dismo"), "ex"),
                    pattern = "grd",
                    full.names = TRUE)

predictors &lt;- terra::rast(files)

# Prepare presence and background locations
p_coords &lt;- virtualSp$presence
bg_coords &lt;- virtualSp$background

# Create SWD object
data &lt;- prepareSWD(species = "Virtual species",
                   p = p_coords,
                   a = bg_coords,
                   env = predictors,
                   categorical = "biome")

# Train a Maxent model
model &lt;- train(method = "Maxent",
               data = data,
               fc = "l")

maxentTh(model)
</code></pre>

<hr>
<h2 id='maxentVarImp'>Maxent Variable Importance</h2><span id='topic+maxentVarImp'></span>

<h3>Description</h3>

<p>Shows the percent contribution and permutation importance of the
environmental variables used to train the model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>maxentVarImp(model)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="maxentVarImp_+3A_model">model</code></td>
<td>
<p><a href="#topic+SDMmodel-class">SDMmodel</a> or <a href="#topic+SDMmodelCV-class">SDMmodelCV</a> object
trained using the &quot;Maxent&quot; method.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When an <a href="#topic+SDMmodelCV-class">SDMmodelCV</a> object is passed to the function,
the output is the average of the variable importance of each model trained
during the cross validation.
</p>


<h3>Value</h3>

<p>A data frame with the variable importance.
</p>


<h3>Author(s)</h3>

<p>Sergio Vignali
</p>


<h3>See Also</h3>

<p><a href="#topic+maxentTh">maxentTh</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Acquire environmental variables
files &lt;- list.files(path = file.path(system.file(package = "dismo"), "ex"),
                    pattern = "grd",
                    full.names = TRUE)

predictors &lt;- terra::rast(files)

# Prepare presence and background locations
p_coords &lt;- virtualSp$presence
bg_coords &lt;- virtualSp$background

# Create SWD object
data &lt;- prepareSWD(species = "Virtual species",
                   p = p_coords,
                   a = bg_coords,
                   env = predictors,
                   categorical = "biome")

# Train a Maxent model
# The next line checks if Maxent is correctly configured but you don't need
# to run it in your script
model &lt;- train(method = "Maxent",
               data = data,
               fc = "l")

maxentVarImp(model)
</code></pre>

<hr>
<h2 id='Maxnet-class'>Maxnet</h2><span id='topic+Maxnet-class'></span><span id='topic+Maxnet'></span><span id='topic+show+2CMaxnet-method'></span>

<h3>Description</h3>

<p>This Class represents a Maxnet model objects and hosts all the information
related to the model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'Maxnet'
show(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Maxnet-class_+3A_object">object</code></td>
<td>
<p>Maxnet object</p>
</td></tr>
</table>


<h3>Slots</h3>


<dl>
<dt><code>reg</code></dt><dd><p>numeric. The value of the regularization multiplier used to train
the model.</p>
</dd>
<dt><code>fc</code></dt><dd><p>character. The feature class combination used to train the model.</p>
</dd>
<dt><code>model</code></dt><dd><p>maxnet. The maxnet model object.</p>
</dd>
</dl>


<h3>Author(s)</h3>

<p>Sergio Vignali
</p>

<hr>
<h2 id='mergeSWD'>Merge SWD Objects</h2><span id='topic+mergeSWD'></span>

<h3>Description</h3>

<p>Merge two <a href="#topic+SWD-class">SWD</a> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mergeSWD(swd1, swd2, only_presence = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mergeSWD_+3A_swd1">swd1</code></td>
<td>
<p><a href="#topic+SWD-class">SWD</a> object.</p>
</td></tr>
<tr><td><code id="mergeSWD_+3A_swd2">swd2</code></td>
<td>
<p><a href="#topic+SWD-class">SWD</a> object.</p>
</td></tr>
<tr><td><code id="mergeSWD_+3A_only_presence">only_presence</code></td>
<td>
<p>logical If <code>TRUE</code> only for the presence locations are
merged and the absence/background locations are taken only from the <code>swd1</code>
object.</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p> In case the two <a href="#topic+SWD-class">SWD</a> objects have different columns, only the
common columns are used in the merged object.
</p>
</li>
<li><p> The <a href="#topic+SWD-class">SWD</a> object is created in a way that the presence
locations are always before than the absence/background locations.
</p>
</li></ul>



<h3>Value</h3>

<p>The merged <a href="#topic+SWD-class">SWD</a> object.
</p>


<h3>Author(s)</h3>

<p>Sergio Vignali
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Acquire environmental variables
files &lt;- list.files(path = file.path(system.file(package = "dismo"), "ex"),
                    pattern = "grd",
                    full.names = TRUE)

predictors &lt;- terra::rast(files)

# Prepare presence and background locations
p_coords &lt;- virtualSp$presence
bg_coords &lt;- virtualSp$background

# Create SWD object
data &lt;- prepareSWD(species = "Virtual species",
                   p = p_coords,
                   a = bg_coords,
                   env = predictors,
                   categorical = "biome")

# Split only presence locations in training (80%) and testing (20%) datasets
datasets &lt;- trainValTest(data,
                         test = 0.2,
                         only_presence = TRUE)
train &lt;- datasets[[1]]
test &lt;- datasets[[2]]

# Merge the training and the testing datasets together
merged &lt;- mergeSWD(train,
                   test,
                   only_presence = TRUE)

# Split presence and absence locations in training (80%) and testing (20%)
datasets
datasets &lt;- trainValTest(data,
                         test = 0.2)
train &lt;- datasets[[1]]
test &lt;- datasets[[2]]

# Merge the training and the testing datasets together
merged &lt;- mergeSWD(train, test)
</code></pre>

<hr>
<h2 id='modelReport'>Model Report</h2><span id='topic+modelReport'></span>

<h3>Description</h3>

<p>Make a report that shows the main results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>modelReport(
  model,
  folder,
  test = NULL,
  type = NULL,
  response_curves = FALSE,
  only_presence = FALSE,
  jk = FALSE,
  env = NULL,
  clamp = TRUE,
  permut = 10,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="modelReport_+3A_model">model</code></td>
<td>
<p><a href="#topic+SDMmodel-class">SDMmodel</a> object.</p>
</td></tr>
<tr><td><code id="modelReport_+3A_folder">folder</code></td>
<td>
<p>character. The name of the folder in which to save the output.
The folder is created in the working directory.</p>
</td></tr>
<tr><td><code id="modelReport_+3A_test">test</code></td>
<td>
<p><a href="#topic+SWD-class">SWD</a> object with the test locations.</p>
</td></tr>
<tr><td><code id="modelReport_+3A_type">type</code></td>
<td>
<p>character. The output type used for &quot;Maxent&quot; and &quot;Maxnet&quot;
methods, possible values are &quot;cloglog&quot; and &quot;logistic&quot;.</p>
</td></tr>
<tr><td><code id="modelReport_+3A_response_curves">response_curves</code></td>
<td>
<p>logical, if <code>TRUE</code> it plots the response curves in the
html output.</p>
</td></tr>
<tr><td><code id="modelReport_+3A_only_presence">only_presence</code></td>
<td>
<p>logical, if <code>TRUE</code> it uses only the range of the
presence location for the marginal response.</p>
</td></tr>
<tr><td><code id="modelReport_+3A_jk">jk</code></td>
<td>
<p>logical, if <code>TRUE</code> it runs the jackknife test.</p>
</td></tr>
<tr><td><code id="modelReport_+3A_env">env</code></td>
<td>
<p><a href="terra.html#topic+rast">rast</a>. If provided it computes and adds a prediction
map to the output.</p>
</td></tr>
<tr><td><code id="modelReport_+3A_clamp">clamp</code></td>
<td>
<p>logical for clumping during prediction, used for response curves
and for the prediction map.</p>
</td></tr>
<tr><td><code id="modelReport_+3A_permut">permut</code></td>
<td>
<p>integer. Number of permutations.</p>
</td></tr>
<tr><td><code id="modelReport_+3A_verbose">verbose</code></td>
<td>
<p>logical, if <code>TRUE</code> prints informative messages.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function produces a report similar to the one created by MaxEnt
software. See <span class="pkg">terra</span> documentation to see how to pass factors.
</p>


<h3>Author(s)</h3>

<p>Sergio Vignali
</p>


<h3>Examples</h3>

<pre><code class='language-R'># If you run the following examples with the function example(),
# you may want to set the argument ask like following: example("modelReport",
# ask = FALSE)
# Acquire environmental variables
files &lt;- list.files(path = file.path(system.file(package = "dismo"), "ex"),
                    pattern = "grd",
                    full.names = TRUE)

predictors &lt;- terra::rast(files)

# Prepare presence and background locations
p_coords &lt;- virtualSp$presence
bg_coords &lt;- virtualSp$background

# Create SWD object
data &lt;- prepareSWD(species = "Virtual species",
                   p = p_coords,
                   a = bg_coords,
                   env = predictors,
                   categorical = "biome")

# Split presence locations in training (80%) and testing (20%) datasets
datasets &lt;- trainValTest(data,
                         test = 0.2,
                         only_presence = TRUE)
train &lt;- datasets[[1]]
test &lt;- datasets[[2]]

# Train a model
model &lt;- train(method = "Maxnet",
               data = train,
               fc = "lq")

# Create the report
## Not run: 
modelReport(model,
            type = "cloglog",
            folder = "my_folder",
            test = test,
            response_curves = TRUE,
            only_presence = TRUE,
            jk = TRUE,
            env = predictors,
            permut = 2)
## End(Not run)
</code></pre>

<hr>
<h2 id='optimizeModel'>Optimize Model</h2><span id='topic+optimizeModel'></span>

<h3>Description</h3>

<p>The function uses a Genetic Algorithm implementation to optimize the model
hyperparameter configuration according to the chosen metric.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>optimizeModel(
  model,
  hypers,
  metric,
  test = NULL,
  pop = 20,
  gen = 5,
  env = NULL,
  keep_best = 0.4,
  keep_random = 0.2,
  mutation_chance = 0.4,
  interactive = TRUE,
  progress = TRUE,
  seed = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="optimizeModel_+3A_model">model</code></td>
<td>
<p><a href="#topic+SDMmodel-class">SDMmodel</a> or <a href="#topic+SDMmodelCV-class">SDMmodelCV</a> object.</p>
</td></tr>
<tr><td><code id="optimizeModel_+3A_hypers">hypers</code></td>
<td>
<p>named list containing the values of the hyperparameters that
should be tuned, see details.</p>
</td></tr>
<tr><td><code id="optimizeModel_+3A_metric">metric</code></td>
<td>
<p>character. The metric used to evaluate the models, possible
values are: &quot;auc&quot;, &quot;tss&quot; and &quot;aicc&quot;.</p>
</td></tr>
<tr><td><code id="optimizeModel_+3A_test">test</code></td>
<td>
<p><a href="#topic+SWD-class">SWD</a> object. Testing dataset used to evaluate
the model, not used with aicc and <a href="#topic+SDMmodelCV-class">SDMmodelCV</a> objects.</p>
</td></tr>
<tr><td><code id="optimizeModel_+3A_pop">pop</code></td>
<td>
<p>numeric. Size of the population.</p>
</td></tr>
<tr><td><code id="optimizeModel_+3A_gen">gen</code></td>
<td>
<p>numeric. Number of generations.</p>
</td></tr>
<tr><td><code id="optimizeModel_+3A_env">env</code></td>
<td>
<p><a href="terra.html#topic+rast">rast</a> containing the environmental variables, used
only with &quot;aicc&quot;.</p>
</td></tr>
<tr><td><code id="optimizeModel_+3A_keep_best">keep_best</code></td>
<td>
<p>numeric. Percentage of the best models in the population to
be retained during each iteration, expressed as decimal number.</p>
</td></tr>
<tr><td><code id="optimizeModel_+3A_keep_random">keep_random</code></td>
<td>
<p>numeric. Probability of retaining the excluded models
during each iteration, expressed as decimal number.</p>
</td></tr>
<tr><td><code id="optimizeModel_+3A_mutation_chance">mutation_chance</code></td>
<td>
<p>numeric. Probability of mutation of the child models,
expressed as decimal number.</p>
</td></tr>
<tr><td><code id="optimizeModel_+3A_interactive">interactive</code></td>
<td>
<p>logical. If <code>FALSE</code> the interactive chart is not created.</p>
</td></tr>
<tr><td><code id="optimizeModel_+3A_progress">progress</code></td>
<td>
<p>logical. If <code>TRUE</code> shows a progress bar.</p>
</td></tr>
<tr><td><code id="optimizeModel_+3A_seed">seed</code></td>
<td>
<p>numeric. The value used to set the seed to have consistent
results.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To know which hyperparameters can be tuned you can use the output
of the function <a href="#topic+getTunableArgs">getTunableArgs</a>. Hyperparameters not included in the
<code>hypers</code> argument take the value that they have in the passed model.
</p>
<p>An interactive chart showing in real-time the steps performed by the
algorithm is displayed in the Viewer pane.
</p>
<p>Part of the code is inspired by
<a href="https://blog.coast.ai/lets-evolve-a-neural-network-with-a-geneticalgorithm-code-included-8809bece164">this post</a>.
</p>


<h3>Value</h3>

<p><a href="#topic+SDMtune-class">SDMtune</a> object.
</p>


<h3>Author(s)</h3>

<p>Sergio Vignali
</p>


<h3>See Also</h3>

<p><a href="#topic+gridSearch">gridSearch</a> and <a href="#topic+randomSearch">randomSearch</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Acquire environmental variables
files &lt;- list.files(path = file.path(system.file(package = "dismo"), "ex"),
                    pattern = "grd",
                    full.names = TRUE)

predictors &lt;- terra::rast(files)

# Prepare presence and background locations
p_coords &lt;- virtualSp$presence
bg_coords &lt;- virtualSp$background

# Create SWD object
data &lt;- prepareSWD(species = "Virtual species",
                   p = p_coords,
                   a = bg_coords,
                   env = predictors,
                   categorical = "biome")

# Split presence locations in training (80%) and testing (20%) datasets
datasets &lt;- trainValTest(data,
                         val = 0.2,
                         test = 0.2,
                         only_presence = TRUE,
                         seed = 61516)
train &lt;- datasets[[1]]
val &lt;- datasets[[2]]

# Train a model
model &lt;- train("Maxnet",
               data = train)

# Define the hyperparameters to test
h &lt;- list(reg = seq(0.2, 5, 0.2),
          fc = c("l", "lq", "lh", "lp", "lqp", "lqph"))

# Run the function using as metric the AUC
## Not run: 
output &lt;- optimizeModel(model,
                        hypers = h,
                        metric = "auc",
                        test = val,
                        pop = 15,
                        gen = 2,
                        seed = 798)
output@results
output@models
output@models[[1]]  # Best model
## End(Not run)
</code></pre>

<hr>
<h2 id='plotCor'>Plot Correlation</h2><span id='topic+plotCor'></span>

<h3>Description</h3>

<p>Plot a correlation matrix heat map with the value of the correlation
coefficients according with the given method. If cor_th is passed then it
prints only the coefficients that are higher or lower than the given
threshold.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotCor(bg, method = "spearman", cor_th = NULL, text_size = 3)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotCor_+3A_bg">bg</code></td>
<td>
<p><a href="#topic+SWD-class">SWD</a> object used to compute the correlation matrix.</p>
</td></tr>
<tr><td><code id="plotCor_+3A_method">method</code></td>
<td>
<p>character. The method used to compute the correlation matrix.</p>
</td></tr>
<tr><td><code id="plotCor_+3A_cor_th">cor_th</code></td>
<td>
<p>numeric. If provided it prints only the coefficients that are
higher or lower than the given threshold.</p>
</td></tr>
<tr><td><code id="plotCor_+3A_text_size">text_size</code></td>
<td>
<p>numeric, used to change the size of the text.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <a href="ggplot2.html#topic+ggplot">ggplot</a> object.
</p>


<h3>Author(s)</h3>

<p>Sergio Vignali
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Acquire environmental variables
files &lt;- list.files(path = file.path(system.file(package = "dismo"), "ex"),
                    pattern = "grd",
                    full.names = TRUE)

predictors &lt;- terra::rast(files)

# Prepare background locations
bg_coords &lt;- terra::spatSample(predictors,
                               size = 9000,
                               method = "random",
                               na.rm = TRUE,
                               xy = TRUE,
                               values = FALSE)

# Create SWD object
bg &lt;- prepareSWD(species = "Virtual species",
                 a = bg_coords,
                 env = predictors,
                 categorical = "biome")

# Plot heat map
plotCor(bg,
        method = "spearman")

# Plot heat map showing only values higher than given threshold and change
# text size
plotCor(bg,
        method = "spearman",
        cor_th = 0.8,
        text_size = 4)
</code></pre>

<hr>
<h2 id='plotJk'>Plot Jackknife Test</h2><span id='topic+plotJk'></span>

<h3>Description</h3>

<p>Plot the Jackknife Test for variable importance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotJk(jk, type = c("train", "test"), ref = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotJk_+3A_jk">jk</code></td>
<td>
<p>data.frame with the output of the <a href="#topic+doJk">doJk</a> function.</p>
</td></tr>
<tr><td><code id="plotJk_+3A_type">type</code></td>
<td>
<p>character, &quot;train&quot; or &quot;test&quot; to plot the result of the test on
the train or testing dataset.</p>
</td></tr>
<tr><td><code id="plotJk_+3A_ref">ref</code></td>
<td>
<p>numeric. The value of the chosen metric for the model trained
using all the variables. If provided it plots a vertical line showing the
reference value.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <a href="ggplot2.html#topic+ggplot">ggplot</a> object.
</p>


<h3>Author(s)</h3>

<p>Sergio Vignali
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Acquire environmental variables
files &lt;- list.files(path = file.path(system.file(package = "dismo"), "ex"),
                    pattern = "grd",
                    full.names = TRUE)

predictors &lt;- terra::rast(files)

# Prepare presence and background locations
p_coords &lt;- virtualSp$presence
bg_coords &lt;- virtualSp$background

# Create SWD object
data &lt;- prepareSWD(species = "Virtual species",
                   p = p_coords,
                   a = bg_coords,
                   env = predictors,
                   categorical = "biome")

# Split presence locations in training (80%) and testing (20%) datasets
datasets &lt;- trainValTest(data,
                         test = 0.2,
                         only_presence = TRUE)
train &lt;- datasets[[1]]
test &lt;- datasets[[2]]

# Train a model
model &lt;- train(method = "Maxnet",
               data = train,
               fc = "lq")

# Execute the Jackknife test for all the environmental variables using the
# metric AUC
jk &lt;- doJk(model,
           metric = "auc",
           test = test)

# Plot Jackknife test result for training
plotJk(jk,
       type = "train",
       ref = auc(model))

#' # Plot Jackknife test result for testing
plotJk(jk,
       type = "test",
       ref = auc(model, test = test))
</code></pre>

<hr>
<h2 id='plotPA'>Plot Presence Absence Map</h2><span id='topic+plotPA'></span>

<h3>Description</h3>

<p>Plot a presence absence map using the given threshold.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotPA(
  map,
  th,
  colors = NULL,
  hr = FALSE,
  filename = "",
  overwrite = FALSE,
  wopt = list(),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotPA_+3A_map">map</code></td>
<td>
<p><a href="terra.html#topic+rast">rast</a> object with the prediction.</p>
</td></tr>
<tr><td><code id="plotPA_+3A_th">th</code></td>
<td>
<p>numeric. The threshold used to convert the output in a
presence/absence map.</p>
</td></tr>
<tr><td><code id="plotPA_+3A_colors">colors</code></td>
<td>
<p>vector. Colors to be used, default is <code>NULL</code> and it uses red
and blue.</p>
</td></tr>
<tr><td><code id="plotPA_+3A_hr">hr</code></td>
<td>
<p>logical. If <code>TRUE</code> it produces an output with high resolution.</p>
</td></tr>
<tr><td><code id="plotPA_+3A_filename">filename</code></td>
<td>
<p>character. If provided the raster map is saved in a file. It
must include the extension.</p>
</td></tr>
<tr><td><code id="plotPA_+3A_overwrite">overwrite</code></td>
<td>
<p>logical. If <code>TRUE</code> an existing file is overwritten.</p>
</td></tr>
<tr><td><code id="plotPA_+3A_wopt">wopt</code></td>
<td>
<p>list. Writing options passed to <a href="terra.html#topic+writeRaster">writeRaster</a>.</p>
</td></tr>
<tr><td><code id="plotPA_+3A_...">...</code></td>
<td>
<p>Unused arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <a href="ggplot2.html#topic+ggplot">ggplot</a> object.
</p>


<h3>Author(s)</h3>

<p>Sergio Vignali
</p>


<h3>See Also</h3>

<p><a href="#topic+plotPred">plotPred</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>map &lt;- terra::rast(matrix(runif(400, 0, 1),
                                    nrow = 20,
                                    ncol = 20))
plotPA(map,
       th = 0.8)

# Custom colors
plotPA(map,
       th = 0.5,
       colors = c("#d8b365", "#018571"))

## Not run: 
# Save the file. The following command will save the map in the working
# directory. Note that `filename` must include the extension.
plotPA(map,
       th = 0.7,
       filename = "my_map.tif")
## End(Not run)
</code></pre>

<hr>
<h2 id='plotPred'>Plot Prediction</h2><span id='topic+plotPred'></span>

<h3>Description</h3>

<p>Plot Prediction output.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotPred(map, lt = "", colorramp = NULL, hr = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotPred_+3A_map">map</code></td>
<td>
<p><a href="terra.html#topic+rast">rast</a> object with the prediction.</p>
</td></tr>
<tr><td><code id="plotPred_+3A_lt">lt</code></td>
<td>
<p>character. Legend title.</p>
</td></tr>
<tr><td><code id="plotPred_+3A_colorramp">colorramp</code></td>
<td>
<p>vector. A custom colour ramp given as a vector of colours
(see example), default is <code>NULL</code> and uses a blue/red colour ramp.</p>
</td></tr>
<tr><td><code id="plotPred_+3A_hr">hr</code></td>
<td>
<p>logical. If <code>TRUE</code> produces an output with high resolution.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <a href="ggplot2.html#topic+ggplot">ggplot</a> object.
</p>


<h3>Author(s)</h3>

<p>Sergio Vignali
</p>


<h3>See Also</h3>

<p><a href="#topic+plotPA">plotPA</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>map &lt;- terra::rast(matrix(runif(400, 0, 1),
                                    nrow = 20,
                                    ncol= 20))

plotPred(map,
         lt = "Habitat suitability \ncloglog")

# Custom colors
plotPred(map,
         lt = "Habitat suitability",
         colorramp = c("#2c7bb6", "#ffffbf", "#d7191c"))
</code></pre>

<hr>
<h2 id='plotResponse'>Plot Response Curve</h2><span id='topic+plotResponse'></span>

<h3>Description</h3>

<p>Plot the Response Curve of the given environmental variable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotResponse(
  model,
  var,
  type = NULL,
  only_presence = FALSE,
  marginal = FALSE,
  fun = mean,
  rug = FALSE,
  color = "red"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotResponse_+3A_model">model</code></td>
<td>
<p><a href="#topic+SDMmodel-class">SDMmodel</a> or <a href="#topic+SDMmodelCV-class">SDMmodelCV</a> object.</p>
</td></tr>
<tr><td><code id="plotResponse_+3A_var">var</code></td>
<td>
<p>character. Name of the variable to be plotted.</p>
</td></tr>
<tr><td><code id="plotResponse_+3A_type">type</code></td>
<td>
<p>character. The output type used for &quot;Maxent&quot; and &quot;Maxnet&quot;
methods, possible values are &quot;cloglog&quot; and &quot;logistic&quot;.</p>
</td></tr>
<tr><td><code id="plotResponse_+3A_only_presence">only_presence</code></td>
<td>
<p>logical. If <code>TRUE</code> it uses only the presence locations
when applying the function for the marginal response.</p>
</td></tr>
<tr><td><code id="plotResponse_+3A_marginal">marginal</code></td>
<td>
<p>logical. If <code>TRUE</code> it plots the marginal response curve.</p>
</td></tr>
<tr><td><code id="plotResponse_+3A_fun">fun</code></td>
<td>
<p>function used to compute the level of the other variables for
marginal curves.</p>
</td></tr>
<tr><td><code id="plotResponse_+3A_rug">rug</code></td>
<td>
<p>logical. If <code>TRUE</code> it adds the rug plot for the presence and
absence/background locations, available only for continuous variables.</p>
</td></tr>
<tr><td><code id="plotResponse_+3A_color">color</code></td>
<td>
<p>The color of the curve, default is &quot;red&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p> Note that <code>fun</code> is not a character argument, you must use <code>mean</code> and not
<code>"mean"</code>.
</p>
</li>
<li><p> If you want to modify the plot, first you have to assign the output of the
function to a variable, and then you have two options:
</p>

<ul>
<li><p> Modify the <code>ggplot</code> object by editing the theme or adding additional
elements
</p>
</li>
<li><p> Get the data with <code>ggplot2::ggplot_build()</code> and then build your own
plot (see examples)
</p>
</li></ul>

</li></ul>



<h3>Value</h3>

<p>A <a href="ggplot2.html#topic+ggplot">ggplot</a> object.
</p>


<h3>Author(s)</h3>

<p>Sergio Vignali
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Acquire environmental variables
files &lt;- list.files(path = file.path(system.file(package = "dismo"), "ex"),
                    pattern = "grd",
                    full.names = TRUE)

predictors &lt;- terra::rast(files)

# Prepare presence and background locations
p_coords &lt;- virtualSp$presence
bg_coords &lt;- virtualSp$background

# Create SWD object
data &lt;- prepareSWD(species = "Virtual species",
                   p = p_coords,
                   a = bg_coords,
                   env = predictors,
                   categorical = "biome")

# Train a model
model &lt;- train(method = "Maxnet",
               data = data,
               fc = "lq")

# Plot cloglog response curve for a continuous environmental variable (bio1)
plotResponse(model,
             var = "bio1",
             type = "cloglog")

# Plot marginal cloglog response curve for a continuous environmental
# variable (bio1)
plotResponse(model,
             var = "bio1",
             type = "cloglog",
             marginal = TRUE)

# Plot logistic response curve for a continuous environmental variable
# (bio12) adding the rugs and giving a custom color
plotResponse(model,
             var = "bio12",
             type = "logistic",
             rug = TRUE,
             color = "blue")

# Plot response curve for a categorical environmental variable (biome) giving
# a custom color
plotResponse(model,
             var = "biome",
             type = "logistic",
             color = "green")

# Modify plot
# Change y axes limits
my_plot &lt;- plotResponse(model,
                        var = "bio1",
                        type = "cloglog")
my_plot +
  ggplot2::scale_y_continuous(limits = c(0, 1))

# Get the data and create your own plot:
df &lt;- ggplot2::ggplot_build(my_plot)$data[[1]]
plot(df$x, df$y,
     type = "l",
     lwd = 3,
     col = "blue",
     xlab = "bio1",
     ylab = "cloglog output")

# Train a model with cross validation
folds &lt;- randomFolds(data,
                     k = 4,
                     only_presence = TRUE)

model &lt;- train(method = "Maxnet",
               data = data,
               fc = "lq",
               folds = folds)

# Plot cloglog response curve for a continuous environmental variable (bio17)
plotResponse(model,
             var = "bio1",
             type = "cloglog")

# Plot logistic response curve for a categorical environmental variable
# (biome) giving a custom color
plotResponse(model,
             var = "biome",
             type = "logistic",
             color = "green")
</code></pre>

<hr>
<h2 id='plotROC'>Plot ROC curve</h2><span id='topic+plotROC'></span>

<h3>Description</h3>

<p>Plot the ROC curve of the given model and print the AUC value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotROC(model, test = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotROC_+3A_model">model</code></td>
<td>
<p><a href="#topic+SDMmodel-class">SDMmodel</a> object.</p>
</td></tr>
<tr><td><code id="plotROC_+3A_test">test</code></td>
<td>
<p><a href="#topic+SWD-class">SWD</a> object. The testing dataset.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <a href="ggplot2.html#topic+ggplot">ggplot</a> object.
</p>


<h3>Author(s)</h3>

<p>Sergio Vignali
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Acquire environmental variables
files &lt;- list.files(path = file.path(system.file(package = "dismo"), "ex"),
                    pattern = "grd",
                    full.names = TRUE)

predictors &lt;- terra::rast(files)

# Prepare presence and background locations
p_coords &lt;- virtualSp$presence
bg_coords &lt;- virtualSp$background

# Create SWD object
data &lt;- prepareSWD(species = "Virtual species",
                   p = p_coords,
                   a = bg_coords,
                   env = predictors,
                   categorical = "biome")

# Split presence locations in training (80%) and testing (20%) datasets
datasets &lt;- trainValTest(data,
                         test = 0.2,
                         only_presence = TRUE)
train &lt;- datasets[[1]]
test &lt;- datasets[[2]]

# Train a model
model &lt;- train(method = "Maxnet",
               data = train,
               fc = "l")

# Plot the training ROC curve
plotROC(model)

# Plot the training and testing  ROC curves
plotROC(model,
        test = test)
</code></pre>

<hr>
<h2 id='plotVarImp'>Plot Variable Importance</h2><span id='topic+plotVarImp'></span>

<h3>Description</h3>

<p>Plot the variable importance as a bar plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotVarImp(df, color = "grey")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotVarImp_+3A_df">df</code></td>
<td>
<p>data.frame. A data.frame containing the the name of the variables
as first column and the value of the variable importance as second column.</p>
</td></tr>
<tr><td><code id="plotVarImp_+3A_color">color</code></td>
<td>
<p>character. The colour of the bar plot.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <a href="ggplot2.html#topic+ggplot">ggplot</a> object.
</p>


<h3>Author(s)</h3>

<p>Sergio Vignali
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Acquire environmental variables
files &lt;- list.files(path = file.path(system.file(package = "dismo"), "ex"),
                    pattern = "grd",
                    full.names = TRUE)

predictors &lt;- terra::rast(files)

# Prepare presence and background locations
p_coords &lt;- virtualSp$presence
bg_coords &lt;- virtualSp$background

# Create SWD object
data &lt;- prepareSWD(species = "Virtual species",
                   p = p_coords,
                   a = bg_coords,
                   env = predictors,
                   categorical = "biome")

# Train a model
model &lt;- train(method = "Maxnet",
               data = data,
               fc = "l")

# Compute variable importance
vi &lt;- varImp(model,
             permut = 1)

# Plot variable importance
plotVarImp(vi)

# Plot variable importance with custom color
plotVarImp(vi,
           color = "red")
</code></pre>

<hr>
<h2 id='predict+2CANN-method'>Predict ANN</h2><span id='topic+predict+2CANN-method'></span>

<h3>Description</h3>

<p>Predict the output for a new dataset from a trained ANN model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'ANN'
predict(object, data, type, clamp)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict+2B2CANN-method_+3A_object">object</code></td>
<td>
<p><a href="#topic+ANN-class">ANN</a> object.</p>
</td></tr>
<tr><td><code id="predict+2B2CANN-method_+3A_data">data</code></td>
<td>
<p>data.frame with the data for the prediction.</p>
</td></tr>
<tr><td><code id="predict+2B2CANN-method_+3A_type">type</code></td>
<td>
<p>Not used.</p>
</td></tr>
<tr><td><code id="predict+2B2CANN-method_+3A_clamp">clamp</code></td>
<td>
<p>Not used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Used by the <a href="#topic+predict+2CSDMmodel-method">predict,SDMmodel-method</a>, not exported.
</p>


<h3>Value</h3>

<p>A vector with the predicted values.
</p>


<h3>Author(s)</h3>

<p>Sergio Vignali
</p>

<hr>
<h2 id='predict+2CBRT-method'>Predict BRT</h2><span id='topic+predict+2CBRT-method'></span>

<h3>Description</h3>

<p>Predict the output for a new dataset from a trained BRT model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'BRT'
predict(object, data, type, clamp)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict+2B2CBRT-method_+3A_object">object</code></td>
<td>
<p><a href="#topic+BRT-class">BRT</a> object.</p>
</td></tr>
<tr><td><code id="predict+2B2CBRT-method_+3A_data">data</code></td>
<td>
<p>data.frame with the data for the prediction.</p>
</td></tr>
<tr><td><code id="predict+2B2CBRT-method_+3A_type">type</code></td>
<td>
<p>Not used.</p>
</td></tr>
<tr><td><code id="predict+2B2CBRT-method_+3A_clamp">clamp</code></td>
<td>
<p>Not used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Used by the <a href="#topic+predict+2CSDMmodel-method">predict,SDMmodel-method</a>, not exported.
</p>
<p>The function uses the number of tree defined to train the model and the
&quot;response&quot; type output.
</p>


<h3>Value</h3>

<p>A vector with the predicted values.
</p>


<h3>Author(s)</h3>

<p>Sergio Vignali
</p>

<hr>
<h2 id='predict+2CMaxent-method'>Predict Maxent</h2><span id='topic+predict+2CMaxent-method'></span>

<h3>Description</h3>

<p>Predict the output for a new dataset from a trained Maxent model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'Maxent'
predict(object, data, type = c("cloglog", "logistic", "raw"), clamp = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict+2B2CMaxent-method_+3A_object">object</code></td>
<td>
<p><a href="#topic+Maxent-class">Maxent</a> object.</p>
</td></tr>
<tr><td><code id="predict+2B2CMaxent-method_+3A_data">data</code></td>
<td>
<p>data.frame with the data for the prediction.</p>
</td></tr>
<tr><td><code id="predict+2B2CMaxent-method_+3A_type">type</code></td>
<td>
<p>character. MaxEnt output type, possible values are &quot;cloglog&quot;,
&quot;logistic&quot; and &quot;raw&quot;.</p>
</td></tr>
<tr><td><code id="predict+2B2CMaxent-method_+3A_clamp">clamp</code></td>
<td>
<p>logical for clumping during prediction.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Used by the <a href="#topic+predict+2CSDMmodel-method">predict,SDMmodel-method</a>, not exported.
</p>
<p>The function performs the prediction in <strong>R</strong> without calling the
<strong>MaxEnt</strong> Java software. This results in a faster computation for large
datasets and might result in a slightly different output compared to the Java
software.
</p>


<h3>Value</h3>

<p>A vector with the prediction
</p>


<h3>Author(s)</h3>

<p>Sergio Vignali
</p>


<h3>References</h3>

<p>Wilson P.D., (2009). Guidelines for computing MaxEnt model output
values from a lambdas file.
</p>

<hr>
<h2 id='predict+2CMaxnet-method'>Predict Maxnet</h2><span id='topic+predict+2CMaxnet-method'></span>

<h3>Description</h3>

<p>Predict the output for a new dataset from a trained Maxnet model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'Maxnet'
predict(
  object,
  data,
  type = c("link", "exponential", "cloglog", "logistic"),
  clamp = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict+2B2CMaxnet-method_+3A_object">object</code></td>
<td>
<p><a href="#topic+Maxnet-class">Maxnet</a> object.</p>
</td></tr>
<tr><td><code id="predict+2B2CMaxnet-method_+3A_data">data</code></td>
<td>
<p>data.frame with the data for the prediction.</p>
</td></tr>
<tr><td><code id="predict+2B2CMaxnet-method_+3A_type">type</code></td>
<td>
<p>character. Maxnet output type, possible values are &quot;link&quot;,
&quot;exponential&quot;, &quot;cloglog&quot; and &quot;logistic&quot;.</p>
</td></tr>
<tr><td><code id="predict+2B2CMaxnet-method_+3A_clamp">clamp</code></td>
<td>
<p>logical for clumping during prediction.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Used by the <a href="#topic+predict+2CSDMmodel-method">predict,SDMmodel-method</a>, not exported.
</p>


<h3>Value</h3>

<p>A vector with the predicted values.
</p>


<h3>Author(s)</h3>

<p>Sergio Vignali
</p>

<hr>
<h2 id='predict+2CRF-method'>Predict RF</h2><span id='topic+predict+2CRF-method'></span>

<h3>Description</h3>

<p>Predict the output for a new dataset from a trained RF model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'RF'
predict(object, data, type, clamp)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict+2B2CRF-method_+3A_object">object</code></td>
<td>
<p><a href="#topic+RF-class">RF</a> object.</p>
</td></tr>
<tr><td><code id="predict+2B2CRF-method_+3A_data">data</code></td>
<td>
<p>data.frame with the data for the prediction.</p>
</td></tr>
<tr><td><code id="predict+2B2CRF-method_+3A_type">type</code></td>
<td>
<p>Not used.</p>
</td></tr>
<tr><td><code id="predict+2B2CRF-method_+3A_clamp">clamp</code></td>
<td>
<p>Not used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Used by the <a href="#topic+predict+2CSDMmodel-method">predict,SDMmodel-method</a>, not exported.
</p>


<h3>Value</h3>

<p>A vector with the predicted probabilities of class 1.
</p>


<h3>Author(s)</h3>

<p>Sergio Vignali
</p>

<hr>
<h2 id='predict+2CSDMmodel-method'>Predict</h2><span id='topic+predict+2CSDMmodel-method'></span>

<h3>Description</h3>

<p>Predict the output for a new dataset given a trained <a href="#topic+SDMmodel-class">SDMmodel</a>
model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'SDMmodel'
predict(
  object,
  data,
  type = NULL,
  clamp = TRUE,
  filename = "",
  overwrite = FALSE,
  wopt = list(),
  extent = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict+2B2CSDMmodel-method_+3A_object">object</code></td>
<td>
<p><a href="#topic+SDMmodel-class">SDMmodel</a> object.</p>
</td></tr>
<tr><td><code id="predict+2B2CSDMmodel-method_+3A_data">data</code></td>
<td>
<p>data.frame, <a href="#topic+SWD-class">SWD</a> or <a href="terra.html#topic+rast">rast</a> with the data
for the prediction.</p>
</td></tr>
<tr><td><code id="predict+2B2CSDMmodel-method_+3A_type">type</code></td>
<td>
<p>character. Output type, see details, used only for <strong>Maxent</strong> and
<strong>Maxnet</strong> methods.</p>
</td></tr>
<tr><td><code id="predict+2B2CSDMmodel-method_+3A_clamp">clamp</code></td>
<td>
<p>logical for clumping during prediction, used only for <strong>Maxent</strong>
and <strong>Maxnet</strong> methods.</p>
</td></tr>
<tr><td><code id="predict+2B2CSDMmodel-method_+3A_filename">filename</code></td>
<td>
<p>character. If provided the raster map is saved in a file. It
must include the extension.</p>
</td></tr>
<tr><td><code id="predict+2B2CSDMmodel-method_+3A_overwrite">overwrite</code></td>
<td>
<p>logical. If <code>TRUE</code> an existing file is overwritten.</p>
</td></tr>
<tr><td><code id="predict+2B2CSDMmodel-method_+3A_wopt">wopt</code></td>
<td>
<p>list. Writing options passed to <a href="terra.html#topic+writeRaster">writeRaster</a>.</p>
</td></tr>
<tr><td><code id="predict+2B2CSDMmodel-method_+3A_extent">extent</code></td>
<td>
<p><a href="terra.html#topic+ext">ext</a> object, if provided it restricts the
prediction to the given extent.</p>
</td></tr>
<tr><td><code id="predict+2B2CSDMmodel-method_+3A_...">...</code></td>
<td>
<p>Additional arguments to pass to the <a href="terra.html#topic+predict">predict</a>
function.</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p> filename, and extent are arguments used only when the prediction is run for
a <a href="terra.html#topic+rast">rast</a> object.
</p>
</li>
<li><p> For models trained with the <strong>Maxent</strong> method the argument <code>type</code> can be:
&quot;raw&quot;, &quot;logistic&quot; and &quot;cloglog&quot;. The function performs the prediction in
<strong>R</strong> without calling the <strong>MaxEnt</strong> Java software. This results in a faster
computation for large datasets and might result in a slightly different
output compared to the Java software.
</p>
</li>
<li><p> For models trained with the <strong>Maxnet</strong> method the argument <code>type</code> can be:
&quot;link&quot;, &quot;exponential&quot;, &quot;logistic&quot; and &quot;cloglog&quot;, see <a href="maxnet.html#topic+maxnet">maxnet</a>
for more details.
</p>
</li>
<li><p> For models trained with the <strong>ANN</strong> method the function uses the &quot;raw&quot;
output type.
</p>
</li>
<li><p> For models trained with the <strong>RF</strong> method the output is the probability of
class 1.
</p>
</li>
<li><p> For models trained with the <strong>BRT</strong> method the function uses the number of
trees defined to train the model and the &quot;response&quot; output type.
</p>
</li></ul>



<h3>Value</h3>

<p>A vector with the prediction or a <a href="terra.html#topic+rast">rast</a> object if
data is a raster <a href="terra.html#topic+rast">rast</a>.
</p>


<h3>Author(s)</h3>

<p>Sergio Vignali
</p>


<h3>References</h3>

<p>Wilson P.D., (2009). Guidelines for computing MaxEnt model output
values from a lambdas file.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Acquire environmental variables
files &lt;- list.files(path = file.path(system.file(package = "dismo"), "ex"),
                    pattern = "grd",
                    full.names = TRUE)

predictors &lt;- terra::rast(files)

# Prepare presence and background locations
p_coords &lt;- virtualSp$presence
bg_coords &lt;- virtualSp$background

# Create SWD object
data &lt;- prepareSWD(species = "Virtual species",
                   p = p_coords,
                   a = bg_coords,
                   env = predictors,
                   categorical = "biome")

# Split presence locations in training (80%) and testing (20%) datasets
datasets &lt;- trainValTest(data,
                         test = 0.2,
                         only_presence = TRUE)
train &lt;- datasets[[1]]
test &lt;- datasets[[2]]

# Train a model
model &lt;- train(method = "Maxnet",
               data = train,
               fc = "l")

# Make cloglog prediction for the test dataset
predict(model,
        data = test,
        type = "cloglog")

# Make logistic prediction for the whole study area
predict(model,
        data = predictors,
        type = "logistic")

## Not run: 
# Make logistic prediction for the whole study area and save it in a file.
# Note that the filename must include the extension. The function saves the
# file in your working directory
predict(model,
        data = predictors,
        type = "logistic",
        filename = "my_map.tif")
## End(Not run)
</code></pre>

<hr>
<h2 id='predict+2CSDMmodelCV-method'>Predict for Cross Validation</h2><span id='topic+predict+2CSDMmodelCV-method'></span>

<h3>Description</h3>

<p>Predict the output for a new dataset given a trained <a href="#topic+SDMmodelCV-class">SDMmodelCV</a>
model. The output is given as the provided function applied to the prediction
of the k models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'SDMmodelCV'
predict(
  object,
  data,
  fun = "mean",
  type = NULL,
  clamp = TRUE,
  filename = "",
  overwrite = FALSE,
  wopt = list(),
  extent = NULL,
  progress = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict+2B2CSDMmodelCV-method_+3A_object">object</code></td>
<td>
<p><a href="#topic+SDMmodelCV-class">SDMmodelCV</a> object.</p>
</td></tr>
<tr><td><code id="predict+2B2CSDMmodelCV-method_+3A_data">data</code></td>
<td>
<p>data.frame, <a href="#topic+SWD-class">SWD</a> or raster <a href="terra.html#topic+rast">rast</a> with
the data for the prediction.</p>
</td></tr>
<tr><td><code id="predict+2B2CSDMmodelCV-method_+3A_fun">fun</code></td>
<td>
<p>character. Function used to combine the output of the k models.
Note that fun is a character argument, you must use <code>"mean"</code> and not <code>mean</code>.
You can also pass a vector of character containing multiple function names,
see details.</p>
</td></tr>
<tr><td><code id="predict+2B2CSDMmodelCV-method_+3A_type">type</code></td>
<td>
<p>character. Output type, see details, used only for <strong>Maxent</strong> and
<strong>Maxnet</strong> methods.</p>
</td></tr>
<tr><td><code id="predict+2B2CSDMmodelCV-method_+3A_clamp">clamp</code></td>
<td>
<p>logical for clumping during prediction, used only for <strong>Maxent</strong>
and <strong>Maxnet</strong> methods.</p>
</td></tr>
<tr><td><code id="predict+2B2CSDMmodelCV-method_+3A_filename">filename</code></td>
<td>
<p>character. If provided the raster map is saved in a file. It
must include the extension.</p>
</td></tr>
<tr><td><code id="predict+2B2CSDMmodelCV-method_+3A_overwrite">overwrite</code></td>
<td>
<p>logical. If <code>TRUE</code> an existing file is overwritten.</p>
</td></tr>
<tr><td><code id="predict+2B2CSDMmodelCV-method_+3A_wopt">wopt</code></td>
<td>
<p>list. Writing options passed to <a href="terra.html#topic+writeRaster">writeRaster</a>.</p>
</td></tr>
<tr><td><code id="predict+2B2CSDMmodelCV-method_+3A_extent">extent</code></td>
<td>
<p><a href="terra.html#topic+ext">ext</a> object, if provided it restricts the
prediction to the given extent.</p>
</td></tr>
<tr><td><code id="predict+2B2CSDMmodelCV-method_+3A_progress">progress</code></td>
<td>
<p>logical. If <code>TRUE</code> shows a progress bar during prediction.</p>
</td></tr>
<tr><td><code id="predict+2B2CSDMmodelCV-method_+3A_...">...</code></td>
<td>
<p>Additional arguments to pass to the <a href="terra.html#topic+predict">predict</a>
function.</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p> filename, and extent are arguments used only when the prediction is run for
a <a href="terra.html#topic+rast">rast</a> object.
</p>
</li>
<li><p> When a character vector is passed to the <code>fun</code> argument, than all the
given functions are applied and a named list is returned, see examples.
</p>
</li>
<li><p> When <code>filename</code> is provided and the <code>fun</code> argument contains more than one
function name, the saved files are named as <code>filename_fun</code>, see example.
</p>
</li>
<li><p> For models trained with the <strong>Maxent</strong> method the argument <code>type</code> can be:
&quot;raw&quot;, &quot;logistic&quot; and &quot;cloglog&quot;. The function performs the prediction in
<strong>R</strong> without calling the <strong>MaxEnt</strong> Java software. This results in a faster
computation for large datasets and might result in a slightly different
output compared to the Java software.
</p>
</li>
<li><p> For models trained with the <strong>Maxnet</strong> method the argument <code>type</code> can be:
&quot;link&quot;, &quot;exponential&quot;, &quot;logistic&quot; and &quot;cloglog&quot;, see <a href="maxnet.html#topic+maxnet">maxnet</a>
for more details.
</p>
</li>
<li><p> For models trained with the <strong>ANN</strong> method the function uses the &quot;raw&quot;
output type.
</p>
</li>
<li><p> For models trained with the <strong>RF</strong> method the output is the probability of
class 1.
</p>
</li>
<li><p> For models trained with the <strong>BRT</strong> method the function uses the number of
trees defined to train the model and the &quot;response&quot; output type.
</p>
</li></ul>



<h3>Value</h3>

<p>A vector with the prediction or a <a href="terra.html#topic+rast">rast</a> object if data
is a <a href="terra.html#topic+rast">rast</a> or a list in the case of multiple functions.
</p>


<h3>Author(s)</h3>

<p>Sergio Vignali
</p>


<h3>References</h3>

<p>Wilson P.D., (2009). Guidelines for computing MaxEnt model output
values from a lambdas file.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Acquire environmental variables
files &lt;- list.files(path = file.path(system.file(package = "dismo"), "ex"),
                    pattern = "grd",
                    full.names = TRUE)

predictors &lt;- terra::rast(files)

# Prepare presence and background locations
p_coords &lt;- virtualSp$presence
bg_coords &lt;- virtualSp$background

# Create SWD object
data &lt;- prepareSWD(species = "Virtual species",
                   p = p_coords,
                   a = bg_coords,
                   env = predictors,
                   categorical = "biome")

# Create 4 random folds splitting only the presence data
folds &lt;- randomFolds(data,
                     k = 4,
                     only_presence = TRUE)

model &lt;- train(method = "Maxnet",
               data = data,
               fc = "l",
               folds = folds)

# Make cloglog prediction for the whole study area and get the result as
# average of the k models
predict(model,
        data = predictors,
        fun = "mean",
        type = "cloglog")

# Make cloglog prediction for the whole study area, get the average, standard
# deviation, and maximum values of the k models, and save the output in three
# files.
# The following commands save the output in the working directory. Note that
# the `filename` must include the extension
## Not run: 
maps &lt;- predict(model,
                data = predictors,
                fun = c("mean", "sd", "max"),
                type = "cloglog",
                filename = "prediction.tif")

# In this case three files are created: prediction_mean.tif,
# prediction_sd.tif and prediction_max.tif
plotPred(maps$mean)
plotPred(maps$sd)
plotPred(maps$max)

# Make logistic prediction for the whole study area, given as standard
# deviation of the k models, and save it in a file
predict(model,
        data = predictors,
        fun = "sd",
        type = "logistic",
        filename = "my_map.tif")
## End(Not run)
</code></pre>

<hr>
<h2 id='prepareSWD'>Prepare an SWD object</h2><span id='topic+prepareSWD'></span>

<h3>Description</h3>

<p>Given the coordinates, the species' name and the environmental variables,
the function creates an <a href="#topic+SWD-class">SWD</a> object (sample with data).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prepareSWD(
  species,
  env,
  p = NULL,
  a = NULL,
  categorical = NULL,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="prepareSWD_+3A_species">species</code></td>
<td>
<p>character. The name of the species.</p>
</td></tr>
<tr><td><code id="prepareSWD_+3A_env">env</code></td>
<td>
<p><a href="terra.html#topic+rast">rast</a> containing the environmental variables used to
extract the values at coordinate locations.</p>
</td></tr>
<tr><td><code id="prepareSWD_+3A_p">p</code></td>
<td>
<p>data.frame. The coordinates of the presence locations.</p>
</td></tr>
<tr><td><code id="prepareSWD_+3A_a">a</code></td>
<td>
<p>data.frame. The coordinates of the absence/background locations.</p>
</td></tr>
<tr><td><code id="prepareSWD_+3A_categorical">categorical</code></td>
<td>
<p>vector indicating which of the environmental variable are
categorical.</p>
</td></tr>
<tr><td><code id="prepareSWD_+3A_verbose">verbose</code></td>
<td>
<p>logical, if <code>TRUE</code> prints informative messages.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <a href="#topic+SWD-class">SWD</a> object is created in a way that the presence
locations are always before than the absence/background locations.
</p>


<h3>Value</h3>

<p>An <a href="#topic+SWD-class">SWD</a> object.
</p>


<h3>Author(s)</h3>

<p>Sergio Vignali
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Acquire environmental variables
files &lt;- list.files(path = file.path(system.file(package = "dismo"), "ex"),
                    pattern = "grd",
                    full.names = TRUE)

predictors &lt;- terra::rast(files)

# Prepare presence and background locations
p_coords &lt;- virtualSp$presence
bg_coords &lt;- virtualSp$background

# Create the SWD object
data &lt;- prepareSWD(species = "Virtual species",
                   p = p_coords,
                   a = bg_coords,
                   env = predictors,
                   categorical = "biome")
data
</code></pre>

<hr>
<h2 id='randomFolds'>Create Random Folds</h2><span id='topic+randomFolds'></span>

<h3>Description</h3>

<p>Create random folds for cross validation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>randomFolds(data, k, only_presence = FALSE, seed = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="randomFolds_+3A_data">data</code></td>
<td>
<p><a href="#topic+SWD-class">SWD</a> object that will be used to train the model.</p>
</td></tr>
<tr><td><code id="randomFolds_+3A_k">k</code></td>
<td>
<p>integer. Number of fold used to create the partition.</p>
</td></tr>
<tr><td><code id="randomFolds_+3A_only_presence">only_presence</code></td>
<td>
<p>logical, if <code>TRUE</code> the random folds are created only for
the presence locations and all the background locations are included in each
fold, used manly for presence-only methods.</p>
</td></tr>
<tr><td><code id="randomFolds_+3A_seed">seed</code></td>
<td>
<p>integer. The value used to set the seed for the fold partition.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When <code>only_presence = FALSE</code>, the proportion of presence and absence
is preserved.
</p>


<h3>Value</h3>

<p>list with two matrices, the first for the training and the second for
the testing dataset. Each column of one matrix represents a fold with
<code>TRUE</code> for the locations included in and <code>FALSE</code> excluded from the partition.
</p>


<h3>Author(s)</h3>

<p>Sergio Vignali
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Acquire environmental variables
files &lt;- list.files(path = file.path(system.file(package = "dismo"), "ex"),
                    pattern = "grd", full.names = TRUE)
predictors &lt;- terra::rast(files)

# Prepare presence and background locations
p_coords &lt;- virtualSp$presence
bg_coords &lt;- virtualSp$background

data &lt;- prepareSWD(species = "Virtual species", p = p_coords, a = bg_coords,
                   env = predictors, categorical = "biome")

# Create 4 random folds splitting presence and absence locations
folds &lt;- randomFolds(data, k = 4)

# Create 4 random folds splitting only the presence locations
folds &lt;- randomFolds(data, k = 4, only_presence = TRUE)
</code></pre>

<hr>
<h2 id='randomSearch'>Random Search</h2><span id='topic+randomSearch'></span>

<h3>Description</h3>

<p>The function performs a random search in the hyperparameters space, creating
a population of random models each one with a random combination of the
provided hyperparameters values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>randomSearch(
  model,
  hypers,
  metric,
  test = NULL,
  pop = 20,
  env = NULL,
  interactive = TRUE,
  progress = TRUE,
  seed = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="randomSearch_+3A_model">model</code></td>
<td>
<p><a href="#topic+SDMmodel-class">SDMmodel</a> or <a href="#topic+SDMmodelCV-class">SDMmodelCV</a> object.</p>
</td></tr>
<tr><td><code id="randomSearch_+3A_hypers">hypers</code></td>
<td>
<p>named list containing the values of the hyperparameters that
should be tuned, see details.</p>
</td></tr>
<tr><td><code id="randomSearch_+3A_metric">metric</code></td>
<td>
<p>character. The metric used to evaluate the models, possible
values are: &quot;auc&quot;, &quot;tss&quot; and &quot;aicc&quot;.</p>
</td></tr>
<tr><td><code id="randomSearch_+3A_test">test</code></td>
<td>
<p><a href="#topic+SWD-class">SWD</a> object. Test dataset used to evaluate the
model, not used with aicc and <a href="#topic+SDMmodelCV-class">SDMmodelCV</a> objects.</p>
</td></tr>
<tr><td><code id="randomSearch_+3A_pop">pop</code></td>
<td>
<p>numeric. Size of the population.</p>
</td></tr>
<tr><td><code id="randomSearch_+3A_env">env</code></td>
<td>
<p><a href="terra.html#topic+rast">rast</a> containing the environmental variables, used
only with &quot;aicc&quot;.</p>
</td></tr>
<tr><td><code id="randomSearch_+3A_interactive">interactive</code></td>
<td>
<p>logical. If <code>FALSE</code> the interactive chart is not created.</p>
</td></tr>
<tr><td><code id="randomSearch_+3A_progress">progress</code></td>
<td>
<p>logical. If <code>TRUE</code> shows a progress bar.</p>
</td></tr>
<tr><td><code id="randomSearch_+3A_seed">seed</code></td>
<td>
<p>numeric. The value used to set the seed to have consistent
results.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To know which hyperparameters can be tuned you can use the output
of the function <a href="#topic+getTunableArgs">getTunableArgs</a>. Hyperparameters not included in the
<code>hypers</code> argument take the value that they have in the passed model.
</p>
<p>An interactive chart showing in real-time the steps performed by the
algorithm is displayed in the Viewer pane.
</p>


<h3>Value</h3>

<p><a href="#topic+SDMtune-class">SDMtune</a> object.
</p>


<h3>Author(s)</h3>

<p>Sergio Vignali
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Acquire environmental variables
files &lt;- list.files(path = file.path(system.file(package = "dismo"), "ex"),
                    pattern = "grd",
                    full.names = TRUE)

predictors &lt;- terra::rast(files)

# Prepare presence and background locations
p_coords &lt;- virtualSp$presence
bg_coords &lt;- virtualSp$background

# Create SWD object
data &lt;- prepareSWD(species = "Virtual species",
                   p = p_coords,
                   a = bg_coords,
                   env = predictors,
                   categorical = "biome")

# Split presence locations in training (80%) and testing (20%) datasets
datasets &lt;- trainValTest(data,
                         test = 0.2,
                         only_presence = TRUE)
train &lt;- datasets[[1]]
test &lt;- datasets[[2]]

# Train a model
model &lt;- train(method = "Maxnet",
               data = train,
               fc = "l")

# Define the hyperparameters to test
h &lt;- list(reg = seq(0.2, 3, 0.2),
          fc = c("lqp", "lqph", "lh"))

# Run the function using as metric the AUC
output &lt;- randomSearch(model,
                       hypers = h,
                       metric = "auc",
                       test = test,
                       pop = 10,
                       seed = 25)
output@results
output@models

# Order results by highest test AUC
output@results[order(-output@results$test_AUC), ]
</code></pre>

<hr>
<h2 id='reduceVar'>Reduce Variables</h2><span id='topic+reduceVar'></span>

<h3>Description</h3>

<p>Remove variables whose importance is less than the given threshold. The
function removes one variable at time and after trains a new model to get the
new variable contribution rank. If use_jk is TRUE the function checks if
after removing the variable the model performance decreases (according to the
given metric and based on the starting model). In this case the function
stops removing the variable even if the contribution is lower than the given
threshold.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>reduceVar(
  model,
  th,
  metric,
  test = NULL,
  env = NULL,
  use_jk = FALSE,
  permut = 10,
  use_pc = FALSE,
  interactive = TRUE,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="reduceVar_+3A_model">model</code></td>
<td>
<p><a href="#topic+SDMmodel-class">SDMmodel</a> or <a href="#topic+SDMmodelCV-class">SDMmodelCV</a> object.</p>
</td></tr>
<tr><td><code id="reduceVar_+3A_th">th</code></td>
<td>
<p>numeric. The contribution threshold used to remove variables.</p>
</td></tr>
<tr><td><code id="reduceVar_+3A_metric">metric</code></td>
<td>
<p>character. The metric used to evaluate the models, possible
values are: &quot;auc&quot;, &quot;tss&quot; and &quot;aicc&quot;, used only if use_jk is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="reduceVar_+3A_test">test</code></td>
<td>
<p><a href="#topic+SWD-class">SWD</a> object containing the test dataset used to
evaluate the model, not used with aicc, and if <code>use_jk = FALSE</code>.</p>
</td></tr>
<tr><td><code id="reduceVar_+3A_env">env</code></td>
<td>
<p><a href="terra.html#topic+rast">rast</a> containing the environmental variables, used
only with &quot;aicc&quot;.</p>
</td></tr>
<tr><td><code id="reduceVar_+3A_use_jk">use_jk</code></td>
<td>
<p>Flag to use the Jackknife AUC test during the variable
selection, if <code>FALSE</code> the function uses the percent variable contribution.</p>
</td></tr>
<tr><td><code id="reduceVar_+3A_permut">permut</code></td>
<td>
<p>integer. Number of permutations, used if <code>use_pc = FALSE</code>.</p>
</td></tr>
<tr><td><code id="reduceVar_+3A_use_pc">use_pc</code></td>
<td>
<p>logical. If <code>TRUE</code> and the model is trained using the
<a href="#topic+Maxent-class">Maxent</a> method, the algorithm uses the percent contribution
computed by Maxent software to score the variable importance.</p>
</td></tr>
<tr><td><code id="reduceVar_+3A_interactive">interactive</code></td>
<td>
<p>logical. If <code>FALSE</code> the interactive chart is not created.</p>
</td></tr>
<tr><td><code id="reduceVar_+3A_verbose">verbose</code></td>
<td>
<p>logical. If <code>TRUE</code> prints informative messages.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>An interactive chart showing in real-time the steps performed by the
algorithm is displayed in the Viewer pane.
</p>


<h3>Value</h3>

<p>The model trained using the selected variables.
</p>


<h3>Author(s)</h3>

<p>Sergio Vignali
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Acquire environmental variables
files &lt;- list.files(path = file.path(system.file(package = "dismo"), "ex"),
                    pattern = "grd",
                    full.names = TRUE)

predictors &lt;- terra::rast(files)

# Prepare presence and background locations
p_coords &lt;- virtualSp$presence
bg_coords &lt;- virtualSp$background

# Create SWD object
data &lt;- prepareSWD(species = "Virtual species",
                   p = p_coords,
                   a = bg_coords,
                   env = predictors,
                   categorical = "biome")

# Split presence locations in training (80%) and testing (20%) datasets
datasets &lt;- trainValTest(data,
                         test = 0.2,
                         only_presence = TRUE)
train &lt;- datasets[[1]]
test &lt;- datasets[[2]]

# Train a Maxnet model
model &lt;- train(method = "Maxnet",
               data = train,
               fc = "lq")

# Remove all variables with permuation importance lower than 2%
output &lt;- reduceVar(model,
                    th = 2,
                    metric = "auc",
                    test = test,
                    permut = 1)

# Remove variables with permuation importance lower than 3% only if testing
# TSS doesn't decrease
## Not run: 
output &lt;- reduceVar(model,
                    th = 3,
                    metric = "tss",
                    test = test,
                    permut = 1,
                    use_jk = TRUE)

# Remove variables with permuation importance lower than 2% only if AICc
# doesn't increase
output &lt;- reduceVar(model,
                    th = 2,
                    metric = "aicc",
                    permut = 1,
                    use_jk = TRUE,
                    env = predictors)

# Train a Maxent model
model &lt;- train(method = "Maxent",
               data = train,
               fc = "lq")

# Remove all variables with percent contribution lower than 2%
output &lt;- reduceVar(model,
                    th = 2,
                    metric = "auc",
                    test = test,
                    use_pc = TRUE)
## End(Not run)
</code></pre>

<hr>
<h2 id='RF-class'>Random Forest</h2><span id='topic+RF-class'></span><span id='topic+RF'></span><span id='topic+show+2CRF-method'></span>

<h3>Description</h3>

<p>This Class represents a Random Forest model objects and hosts all the
information related to the model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'RF'
show(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="RF-class_+3A_object">object</code></td>
<td>
<p>RF object</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See <a href="randomForest.html#topic+randomForest">randomForest</a> for the meaning of
the slots.
</p>


<h3>Slots</h3>


<dl>
<dt><code>mtry</code></dt><dd><p>integer. Number of variable randomly sampled.</p>
</dd>
<dt><code>ntree</code></dt><dd><p>integer. Number of grown trees.</p>
</dd>
<dt><code>nodesize</code></dt><dd><p>integer. Minimum size of terminal nodes.</p>
</dd>
<dt><code>model</code></dt><dd><p><a href="randomForest.html#topic+randomForest">randomForest</a>. The randomForest
model object.</p>
</dd>
</dl>


<h3>Author(s)</h3>

<p>Sergio Vignali
</p>

<hr>
<h2 id='SDMmodel-class'>SDMmodel</h2><span id='topic+SDMmodel-class'></span><span id='topic+SDMmodel'></span><span id='topic+show+2CSDMmodel-method'></span>

<h3>Description</h3>

<p>This Class represents an SDMmodel object and hosts all the information
related to the model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'SDMmodel'
show(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SDMmodel-class_+3A_object">object</code></td>
<td>
<p>SDMmodel object</p>
</td></tr>
</table>


<h3>Slots</h3>


<dl>
<dt><code>data</code></dt><dd><p><a href="#topic+SWD-class">SWD</a> object. The data used to train the model.</p>
</dd>
<dt><code>model</code></dt><dd><p>An object of class <a href="#topic+ANN-class">ANN</a>, <a href="#topic+BRT-class">BRT</a>,
<a href="#topic+RF-class">RF</a>, <a href="#topic+Maxent-class">Maxent</a> or <a href="#topic+Maxnet-class">Maxnet</a>.</p>
</dd>
</dl>


<h3>Author(s)</h3>

<p>Sergio Vignali
</p>

<hr>
<h2 id='SDMmodel2MaxEnt'>SDMmodel2MaxEnt</h2><span id='topic+SDMmodel2MaxEnt'></span>

<h3>Description</h3>

<p>Converts an <a href="#topic+SDMmodel-class">SDMmodel</a> object containing a
<a href="dismo.html#topic+maxent">MaxEnt</a> model into a dismo <a href="dismo.html#topic+maxent">MaxEnt</a> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SDMmodel2MaxEnt(model)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SDMmodel2MaxEnt_+3A_model">model</code></td>
<td>
<p><a href="#topic+SDMmodel-class">SDMmodel</a> object to be converted.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The converted dismo <a href="dismo.html#topic+maxent">MaxEnt</a> object.
</p>


<h3>Author(s)</h3>

<p>Sergio Vignali
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Acquire environmental variables
files &lt;- list.files(path = file.path(system.file(package = "dismo"), "ex"),
                    pattern = "grd",
                    full.names = TRUE)

predictors &lt;- terra::rast(files)

# Prepare presence and background locations
p_coords &lt;- virtualSp$presence
bg_coords &lt;- virtualSp$background

# Create SWD object
data &lt;- prepareSWD(species = "Virtual species",
                   p = p_coords,
                   a = bg_coords,
                   env = predictors,
                   categorical = "biome")

# Train a Maxent model
model &lt;- train(method = "Maxent",
               data = data,
               fc = "l")

dismo_model &lt;- SDMmodel2MaxEnt(model)
dismo_model
</code></pre>

<hr>
<h2 id='SDMmodelCV-class'>SDMmodelCV</h2><span id='topic+SDMmodelCV-class'></span><span id='topic+SDMmodelCV'></span><span id='topic+show+2CSDMmodelCV-method'></span>

<h3>Description</h3>

<p>This Class represents an SDMmodel model object with replicates and hosts all
the models trained during the cross validation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'SDMmodelCV'
show(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SDMmodelCV-class_+3A_object">object</code></td>
<td>
<p>SDMmodelCV object</p>
</td></tr>
</table>


<h3>Slots</h3>


<dl>
<dt><code>models</code></dt><dd><p>list. A list containing all the models trained during the cross
validation.</p>
</dd>
<dt><code>data</code></dt><dd><p><a href="#topic+SWD-class">SWD</a> object. Full dataset used to make the
partitions.</p>
</dd>
<dt><code>folds</code></dt><dd><p>list with two matrices, the first for the training and the second
for the testing dataset. Each column of one matrix represents a fold with
<code>TRUE</code> for the locations included in and <code>FALSE</code> excluded from the partition.</p>
</dd>
</dl>


<h3>Author(s)</h3>

<p>Sergio Vignali
</p>

<hr>
<h2 id='SDMtune-class'>SDMtune class</h2><span id='topic+SDMtune-class'></span><span id='topic+SDMtune'></span><span id='topic+show+2CSDMtune-method'></span><span id='topic+plot+2CSDMtune+2Cmissing-method'></span>

<h3>Description</h3>

<p>Class used to save the results of one of the following functions:
<a href="#topic+gridSearch">gridSearch</a>, <a href="#topic+randomSearch">randomSearch</a> or <a href="#topic+optimizeModel">optimizeModel</a>.
</p>
<p>Plot an SDMtune object. Use the interactive argument to create
an interactive chart.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'SDMtune'
show(object)

## S4 method for signature 'SDMtune,missing'
plot(x, title = "", interactive = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SDMtune-class_+3A_object">object</code></td>
<td>
<p>SDMtune object</p>
</td></tr>
<tr><td><code id="SDMtune-class_+3A_x">x</code></td>
<td>
<p>SDMtune object.</p>
</td></tr>
<tr><td><code id="SDMtune-class_+3A_title">title</code></td>
<td>
<p>character. The title of the plot.</p>
</td></tr>
<tr><td><code id="SDMtune-class_+3A_interactive">interactive</code></td>
<td>
<p>logical, if TRUE plot an interactive chart.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If <code>interactive = FALSE</code> the function returns a
<code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> object otherwise it returns an SDMtuneChart
object that contains the path of the temporary folder where the necessary
files to create the chart are saved. In both cases the objects are returned
as invisible.
</p>


<h3>Slots</h3>


<dl>
<dt><code>results</code></dt><dd><p>data.frame. Results with the evaluation of the models.</p>
</dd>
<dt><code>models</code></dt><dd><p>list. List of <a href="#topic+SDMmodel-class">SDMmodel</a> or <a href="#topic+SDMmodelCV-class">SDMmodelCV</a>
objects.</p>
</dd>
</dl>


<h3>Author(s)</h3>

<p>Sergio Vignali
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Acquire environmental variables
files &lt;- list.files(path = file.path(system.file(package = "dismo"), "ex"),
                    pattern = "grd", full.names = TRUE)
predictors &lt;- terra::rast(files)

# Prepare presence and background locations
p_coords &lt;- virtualSp$presence
bg_coords &lt;- virtualSp$background

# Create SWD object
data &lt;- prepareSWD(species = "Virtual species", p = p_coords, a = bg_coords,
                   env = predictors, categorical = "biome")

# Split presence locations in training (80%) and testing (20%) datasets
datasets &lt;- trainValTest(data, test = 0.2, only_presence = TRUE)
train &lt;- datasets[[1]]
test &lt;- datasets[[2]]

# Train a model
model &lt;- train(method = "Maxnet", data = train, fc = "l")

# Define the hyperparameters to test
h &lt;- list(reg = 1:5, fc = c("lqp", "lqph"))

# Run the gridSearch function using as metric the AUC
output &lt;- gridSearch(model, hypers = h, metric = "auc", test = test)
output

# Plot the output
plot(output, title = "My experiment")

# Plot the interactive chart
p &lt;- plot(output, title = "My experiment", interactive = TRUE)
# Print the temporary folder that stores the files used to create the chart
str(p)

</code></pre>

<hr>
<h2 id='SWD-class'>Sample With Data</h2><span id='topic+SWD-class'></span><span id='topic+SWD'></span><span id='topic+show+2CSWD-method'></span>

<h3>Description</h3>

<p>Object similar to the MaxEnt SWD format that hosts the species name, the
coordinates of the locations and the value of the environmental variables at
the location places.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'SWD'
show(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SWD-class_+3A_object">object</code></td>
<td>
<p>SWD object</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The object can contains presence/absence, presence/background,
presence only or absence/background only data. Use the <a href="#topic+prepareSWD">prepareSWD</a>
function to create the object.
</p>


<h3>Slots</h3>


<dl>
<dt><code>species</code></dt><dd><p>character. Name of the species.</p>
</dd>
<dt><code>coords</code></dt><dd><p>data.frame. Coordinates of the locations.</p>
</dd>
<dt><code>data</code></dt><dd><p>data.frame. Value of the environmental variables at location
sites.</p>
</dd>
<dt><code>pa</code></dt><dd><p>numeric. Vector with <code>1</code> for presence and <code>0</code> for absence/background
locations.</p>
</dd>
</dl>


<h3>Author(s)</h3>

<p>Sergio Vignali
</p>

<hr>
<h2 id='swd2csv'>SWD to csv</h2><span id='topic+swd2csv'></span>

<h3>Description</h3>

<p>Save an <a href="#topic+SWD-class">SWD</a> object as csv file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>swd2csv(swd, file_name)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="swd2csv_+3A_swd">swd</code></td>
<td>
<p><a href="#topic+SWD-class">SWD</a> object.</p>
</td></tr>
<tr><td><code id="swd2csv_+3A_file_name">file_name</code></td>
<td>
<p>character. The name of the file in which to save the object,
see details.</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p> The <code>file_name</code> argument should include the extension (i.e. my_file.csv).
</p>
</li>
<li><p> If <code>file_name</code> is a single name the function saves the presence
absence/background locations in a single file, adding the column <strong>pa</strong> with
1s for presence and 0s for absence/background locations. If <code>file_name</code> is a
vector with two names, it saves the object in two files: the first name
is used for the presence locations and the second for the absence/background
locations.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Sergio Vignali
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Acquire environmental variables
files &lt;- list.files(path = file.path(system.file(package = "dismo"), "ex"),
                    pattern = "grd",
                    full.names = TRUE)

predictors &lt;- terra::rast(files)

# Prepare presence and background locations
p_coords &lt;- virtualSp$presence
bg_coords &lt;- virtualSp$background

# Create SWD object
data &lt;- prepareSWD(species = "Virtual species",
                   p = p_coords,
                   a = bg_coords,
                   env = predictors,
                   categorical = "biome")
## Not run: 
# The following commands save the output in the working directory
# Save the SWD object as a single csv file
swd2csv(data,
        file_name = "train_data.csv")

# Save the SWD object in two separate csv files
swd2csv(data,
        file_name = c("presence.csv", "absence.csv"))
## End(Not run)
</code></pre>

<hr>
<h2 id='thinData'>Thin Data</h2><span id='topic+thinData'></span>

<h3>Description</h3>

<p>Remove all but one location per raster cell. The function removes NAs and if
more than one location falls within the same raster cell it selects randomly
one.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>thinData(coords, env, x = "x", y = "y", verbose = TRUE, progress = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="thinData_+3A_coords">coords</code></td>
<td>
<p>data.frame or matrix with the coordinates, see details.</p>
</td></tr>
<tr><td><code id="thinData_+3A_env">env</code></td>
<td>
<p><a href="terra.html#topic+rast">rast</a> containing the environmental variables.</p>
</td></tr>
<tr><td><code id="thinData_+3A_x">x</code></td>
<td>
<p>character. Name of the column containing the x coordinates.</p>
</td></tr>
<tr><td><code id="thinData_+3A_y">y</code></td>
<td>
<p>character. Name of the column containing the y coordinates.</p>
</td></tr>
<tr><td><code id="thinData_+3A_verbose">verbose</code></td>
<td>
<p>logical, if <code>TRUE</code> prints an informative message.</p>
</td></tr>
<tr><td><code id="thinData_+3A_progress">progress</code></td>
<td>
<p>logical, if <code>TRUE</code> shows a progress bar.</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li> <p><strong>coords</strong> and <strong>env</strong> must have the same coordinate reference
system.
</p>
</li>
<li><p> The <code>coords</code> argument can contain several columns. This is useful if the
user has information related to the coordinates that doesn't want to loose
with the thinning procedure. The function expects to have the x coordinates
in a column named &quot;x&quot;, and the y coordinates in a column named &quot;y&quot;. If this
is not the case, the name of the columns containing the coordinates can be
specified using the arguments <code>x</code> and <code>y</code>.
</p>
</li></ul>



<h3>Value</h3>

<p>a matrix or a data frame with the thinned locations.
</p>


<h3>Author(s)</h3>

<p>Sergio Vignali
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Acquire environmental variables
files &lt;- list.files(path = file.path(system.file(package = "dismo"), "ex"),
                    pattern = "grd",
                    full.names = TRUE)

predictors &lt;- terra::rast(files)

# Prepare background locations, by sampling  also on areas with NA values
bg_coords &lt;- terra::spatSample(predictors,
                               size = 9000,
                               method = "random",
                               xy = TRUE,
                               values = FALSE)
nrow(bg_coords)

# Thin the locations
# The function will remove the coordinates that have NA values for some
# predictors. Note that the function expects to have the coordinates in two
# columns named "x" and "y"

colnames(bg_coords)
thinned_bg &lt;- thinData(bg_coords,
                       env = predictors)
nrow(thinned_bg)

# Here we sample only on areas without NA values and then we double the
# coordinates
bg_coords &lt;- terra::spatSample(predictors,
                               size = 9000,
                               method = "random",
                               na.rm = TRUE,
                               xy = TRUE,
                               values = FALSE)

thinned_bg &lt;- thinData(rbind(bg_coords, bg_coords),
                       env = predictors)

nrow(thinned_bg)

# In case of a dataframe containing more than two columns (e.g. a dataframe
# with the coordinates plus an additional column with the age of the species)
# and custom column names, use the function in this way
age &lt;- sample(c(1, 2),
              size = nrow(bg_coords),
              replace = TRUE)

data &lt;- cbind(age, bg_coords)
colnames(data) &lt;- c("age", "X", "Y")

thinned_bg &lt;- thinData(data,
                       env = predictors,
                       x = "X",
                       y = "Y")
head(data)
</code></pre>

<hr>
<h2 id='thresholds'>Thresholds</h2><span id='topic+thresholds'></span>

<h3>Description</h3>

<p>Compute three threshold values: minimum training presence, equal training
sensitivity and specificity and maximum training sensitivity plus
specificity together with fractional predicted area and the omission rate. If
a test dataset is provided it returns also the equal test sensitivity and
specificity and maximum test sensitivity plus specificity thresholds and the
p-values of the one-tailed binomial exact test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>thresholds(model, type = NULL, test = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="thresholds_+3A_model">model</code></td>
<td>
<p><a href="#topic+SDMmodel-class">SDMmodel</a> object.</p>
</td></tr>
<tr><td><code id="thresholds_+3A_type">type</code></td>
<td>
<p>character. The output type used for &quot;Maxent&quot; and &quot;Maxnet&quot;
methods, possible values are &quot;cloglog&quot; and &quot;logistic&quot;.</p>
</td></tr>
<tr><td><code id="thresholds_+3A_test">test</code></td>
<td>
<p><a href="#topic+SWD-class">SWD</a> testing locations, if not provided it returns
the training and test thresholds.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The equal training sensitivity and specificity minimizes the
difference between sensitivity and specificity. The one-tailed binomial test
checks that test points are predicted no better than by a random prediction
with the same fractional predicted area.
</p>


<h3>Value</h3>

<p>data.frame with the thresholds.
</p>


<h3>Author(s)</h3>

<p>Sergio Vignali
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Acquire environmental variables
files &lt;- list.files(path = file.path(system.file(package = "dismo"), "ex"),
                    pattern = "grd",
                    full.names = TRUE)

predictors &lt;- terra::rast(files)

# Prepare presence and background locations
p_coords &lt;- virtualSp$presence
bg_coords &lt;- virtualSp$background

# Create SWD object
data &lt;- prepareSWD(species = "Virtual species",
                   p = p_coords,
                   a = bg_coords,
                   env = predictors,
                   categorical = "biome")

# Split presence locations in training (80%) and testing (20%) datasets
datasets &lt;- trainValTest(data,
                         test = 0.2,
                         only_presence = TRUE)
train &lt;- datasets[[1]]
test &lt;- datasets[[2]]

# Train a model
model &lt;- train(method = "Maxnet",
               data = train,
               fc = "l")

# Get the cloglog thresholds
thresholds(model,
           type = "cloglog")

# Get the logistic thresholds passing the test dataset
thresholds(model,
           type = "logistic",
           test = test)
</code></pre>

<hr>
<h2 id='train'>Train</h2><span id='topic+train'></span>

<h3>Description</h3>

<p>Train a model using one of the following methods: Artificial Neural Networks,
Boosted Regression Trees, Maxent, Maxnet or Random Forest.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>train(method, data, folds = NULL, progress = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="train_+3A_method">method</code></td>
<td>
<p>character or character vector. Method used to train the model,
possible values are &quot;ANN&quot;, &quot;BRT&quot;, &quot;Maxent&quot;, &quot;Maxnet&quot; or &quot;RF&quot;, see details.</p>
</td></tr>
<tr><td><code id="train_+3A_data">data</code></td>
<td>
<p><a href="#topic+SWD-class">SWD</a> object with presence and absence/background
locations.</p>
</td></tr>
<tr><td><code id="train_+3A_folds">folds</code></td>
<td>
<p>list. Output of the function <a href="#topic+randomFolds">randomFolds</a> or folds object
created with other packages, see details.</p>
</td></tr>
<tr><td><code id="train_+3A_progress">progress</code></td>
<td>
<p>logical. If <code>TRUE</code> shows a progress bar during cross
validation.</p>
</td></tr>
<tr><td><code id="train_+3A_...">...</code></td>
<td>
<p>Arguments passed to the relative method, see details.</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p> For the ANN method possible arguments are (for more details see
<a href="nnet.html#topic+nnet">nnet</a>):
</p>

<ul>
<li><p> size: integer. Number of the units in the hidden layer.
</p>
</li>
<li><p> decay numeric. Weight decay, default is 0.
</p>
</li>
<li><p> rang numeric. Initial random weights, default is 0.7.
</p>
</li>
<li><p> maxit integer. Maximum number of iterations, default is 100.
</p>
</li></ul>

</li>
<li><p> For the BRT method possible arguments are (for more details see
<a href="gbm.html#topic+gbm">gbm</a>):
</p>

<ul>
<li><p> distribution: character. Name of the distribution to use, default is
&quot;bernoulli&quot;.
</p>
</li>
<li><p> n.trees: integer. Maximum number of tree to grow, default is 100.
</p>
</li>
<li><p> interaction.depth: integer. Maximum depth of each tree, default is 1.
</p>
</li>
<li><p> shrinkage: numeric. The shrinkage parameter, default is 0.1.
</p>
</li>
<li><p> bag.fraction: numeric. Random fraction of data used in the tree
expansion, default is 0.5.
</p>
</li></ul>

</li>
<li><p> For the RF method the model is trained as classification. Possible
arguments are (for more details see
<a href="randomForest.html#topic+randomForest">randomForest</a>):
</p>

<ul>
<li><p> mtry: integer. Number of variable randomly sampled at each split,
default is <code style="white-space: pre;">&#8288;floor(sqrt(number of variables))&#8288;</code>.
</p>
</li>
<li><p> ntree: integer. Number of tree to grow, default is 500.
</p>
</li>
<li><p> nodesize: integer. Minimum size of terminal nodes, default is 1.
</p>
</li></ul>

</li>
<li><p> Maxent models are trained using the arguments
<code>"removeduplicates=false"</code> and <code>"addsamplestobackground=false"</code>.
Use the function <a href="#topic+thinData">thinData</a> to remove duplicates and the function
<a href="#topic+addSamplesToBg">addSamplesToBg</a> to add presence locations to background locations. For
the Maxent method, possible arguments are:
</p>

<ul>
<li><p> reg: numeric. The value of the regularization multiplier, default is 1.
</p>
</li>
<li><p> fc: character. The value of the feature classes, possible values are
combinations of &quot;l&quot;, &quot;q&quot;, &quot;p&quot;, &quot;h&quot; and &quot;t&quot;, default is &quot;lqph&quot;.
</p>
</li>
<li><p> iter: numeric. Number of iterations used by the MaxEnt algorithm,
default is 500.
</p>
</li></ul>

</li>
<li><p> Maxnet models are trained using the argument
<code>"addsamplestobackground = FALSE"</code>, use the function <a href="#topic+addSamplesToBg">addSamplesToBg</a>
to add presence locations to background locations. For the Maxnet method,
possible arguments are (for more details see <a href="maxnet.html#topic+maxnet">maxnet</a>):
</p>

<ul>
<li><p> reg: numeric. The value of the regularization intensity, default is 1.
</p>
</li>
<li><p> fc: character. The value of the feature classes, possible values are
combinations of &quot;l&quot;, &quot;q&quot;, &quot;p&quot;, &quot;h&quot; and &quot;t&quot;, default is &quot;lqph&quot;.
</p>
</li></ul>

</li></ul>

<p>The folds argument accepts also objects created with other packages:
<span class="pkg">ENMeval</span> or <span class="pkg">blockCV</span>. In this case the function converts
internally the folds into a format valid for <span class="pkg">SDMtune</span>.
</p>
<p>When multiple methods are given as <code>method</code> argument, the function returns a
named list of model object, with the name corresponding to the used method,
see examples.
</p>


<h3>Value</h3>

<p>An <a href="#topic+SDMmodel-class">SDMmodel</a> or <a href="#topic+SDMmodelCV-class">SDMmodelCV</a> or a list of
model objects.
</p>


<h3>Author(s)</h3>

<p>Sergio Vignali
</p>


<h3>References</h3>

<p>Venables, W. N. &amp; Ripley, B. D. (2002) Modern Applied Statistics with S.
Fourth Edition. Springer, New York. ISBN 0-387-95457-0.
</p>
<p>Brandon Greenwell, Bradley Boehmke, Jay Cunningham and GBM Developers (2019).
gbm: Generalized Boosted Regression Models.
<a href="https://CRAN.R-project.org/package=gbm">https://CRAN.R-project.org/package=gbm</a>.
</p>
<p>A. Liaw and M. Wiener (2002). Classification and Regression by randomForest.
R News 2(3), 18&ndash;22.
</p>
<p>Hijmans, Robert J., Steven Phillips, John Leathwick, and Jane Elith. 2017.
dismo: Species Distribution Modeling.
<a href="https://cran.r-project.org/package=dismo">https://cran.r-project.org/package=dismo</a>.
</p>
<p>Steven Phillips (2017). maxnet: Fitting 'Maxent' Species Distribution Models
with 'glmnet'. <a href="https://CRAN.R-project.org/package=maxnet">https://CRAN.R-project.org/package=maxnet</a>.
</p>
<p>Muscarella, R., Galante, P.J., Soley-Guardia, M., Boria, R.A., Kass, J.,
Uriarte, M. and R.P. Anderson (2014). ENMeval: An R package for conducting
spatially independent evaluations and estimating optimal model complexity
for ecological niche models. Methods in Ecology and Evolution.
</p>
<p>Roozbeh Valavi, Jane Elith, José Lahoz-Monfort and Gurutzeta Guillera-Arroita
(2018). blockCV: Spatial and environmental blocking for k-fold
cross-validation. <a href="https://github.com/rvalavi/blockCV">https://github.com/rvalavi/blockCV</a>.
</p>


<h3>See Also</h3>

<p><a href="#topic+randomFolds">randomFolds</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Acquire environmental variables
files &lt;- list.files(path = file.path(system.file(package = "dismo"), "ex"),
                    pattern = "grd",
                    full.names = TRUE)

predictors &lt;- terra::rast(files)

# Prepare presence and background locations
p_coords &lt;- virtualSp$presence
bg_coords &lt;- virtualSp$background

# Create SWD object
data &lt;- prepareSWD(species = "Virtual species",
                   p = p_coords,
                   a = bg_coords,
                   env = predictors,
                   categorical = "biome")

## Train a Maxent model
model &lt;- train(method = "Maxent",
               data = data,
               fc = "l",
               reg = 1.5,
               iter = 700)

# Add samples to background. This should be done preparing the data before
# training the model without using
data &lt;- addSamplesToBg(data)
model &lt;- train("Maxent",
               data = data)

## Train a Maxnet model
model &lt;- train(method = "Maxnet",
               data = data,
               fc = "lq",
               reg = 1.5)

## Cross Validation
# Create 4 random folds splitting only the presence data
folds &lt;- randomFolds(data,
                     k = 4,
                     only_presence = TRUE)

model &lt;- train(method = "Maxnet",
               data = data,
               fc = "l",
               reg = 0.8,
               folds = folds)

## Not run: 
# Run only if you have the package ENMeval installed
## Block partition using the ENMeval package
require(ENMeval)
block_folds &lt;- get.block(occ = data@coords[data@pa == 1, ],
                         bg.coords = data@coords[data@pa == 0, ])

model &lt;- train(method = "Maxnet",
               data = data,
               fc = "l",
               reg = 0.8,
               folds = block_folds)

## Checkerboard1 partition using the ENMeval package
cb_folds &lt;- get.checkerboard1(occ = data@coords[data@pa == 1, ],
                              env = predictors,
                              bg.coords = data@coords[data@pa == 0, ],
                              aggregation.factor = 4)

model &lt;- train(method = "Maxnet",
               data = data,
               fc = "l",
               reg = 0.8,
               folds = cb_folds)

## Environmental block using the blockCV package
# Run only if you have the package blockCV
require(blockCV)
# Create sf object
sf_df &lt;- sf::st_as_sf(cbind(data@coords, pa = data@pa),
                      coords = c("X", "Y"),
                      crs = terra::crs(predictors,
                                       proj = TRUE))

# Spatial blocks
spatial_folds &lt;- cv_spatial(x = sf_df,
                            column = "pa",
                            rows_cols = c(8, 10),
                            k = 5,
                            hexagon = FALSE,
                            selection = "systematic")

model &lt;- train(method = "Maxnet",
               data = data,
               fc = "l",
               reg = 0.8,
               folds = spatial_folds)
## End(Not run)

## Train presence absence models
# Prepare presence and absence locations
p_coords &lt;- virtualSp$presence
a_coords &lt;- virtualSp$absence
# Create SWD object
data &lt;- prepareSWD(species = "Virtual species",
                   p = p_coords,
                   a = a_coords,
                   env = predictors[[1:5]])

## Train an Artificial Neural Network model
model &lt;- train("ANN",
               data = data,
               size = 10)

## Train a Random Forest model
model &lt;- train("RF",
               data = data,
               ntree = 300)

## Train a Boosted Regression Tree model
model &lt;- train("BRT",
               data = data,
               n.trees = 300,
               shrinkage = 0.001)

## Multiple methods trained together with default arguments
output &lt;- train(method = c("ANN", "BRT", "RF"),
                data = data,
                size = 10)
output$ANN
output$BRT
output$RF

## Multiple methods trained together passing extra arguments
output &lt;- train(method = c("ANN", "BRT", "RF"),
                data = data,
                size = 10,
                ntree = 300,
                n.trees = 300,
                shrinkage = 0.001)
output
</code></pre>

<hr>
<h2 id='trainValTest'>Train, Validation and Test datasets</h2><span id='topic+trainValTest'></span>

<h3>Description</h3>

<p>Split a dataset randomly in training and testing datasets or training,
validation and testing datasets.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trainValTest(x, test, val = 0, only_presence = FALSE, seed = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="trainValTest_+3A_x">x</code></td>
<td>
<p><a href="#topic+SWD-class">SWD</a> object containing the data that have to be split
in training, validation and testing datasets.</p>
</td></tr>
<tr><td><code id="trainValTest_+3A_test">test</code></td>
<td>
<p>numeric. The percentage of data withhold for testing.</p>
</td></tr>
<tr><td><code id="trainValTest_+3A_val">val</code></td>
<td>
<p>numeric. The percentage of data withhold for validation, default
is <code>0</code>.</p>
</td></tr>
<tr><td><code id="trainValTest_+3A_only_presence">only_presence</code></td>
<td>
<p>logical. If <code>TRUE</code> the split is done only for the
presence locations and all the background locations are included in each
partition, used manly for presence-only methods, default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="trainValTest_+3A_seed">seed</code></td>
<td>
<p>numeric. The value used to set the seed in order to have
consistent results, default is <code>NULL</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When <code>only_presence = FALSE</code>, the proportion of presence and
absence is preserved.
</p>


<h3>Value</h3>

<p>A list with the training, validation and testing or training and
testing <a href="#topic+SWD-class">SWD</a> objects accordingly.
</p>


<h3>Author(s)</h3>

<p>Sergio Vignali
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Acquire environmental variables
files &lt;- list.files(path = file.path(system.file(package = "dismo"), "ex"),
                    pattern = "grd",
                    full.names = TRUE)

predictors &lt;- terra::rast(files)

# Prepare presence and background locations
p_coords &lt;- virtualSp$presence
bg_coords &lt;- virtualSp$background

# Create SWD object
data &lt;- prepareSWD(species = "Virtual species",
                   p = p_coords,
                   a = bg_coords,
                   env = predictors,
                   categorical = "biome")

# Split presence locations in training (80%) and testing (20%) datasets
# and splitting only the presence locations
datasets &lt;- trainValTest(data,
                         test = 0.2,
                         only_presence = TRUE)
train &lt;- datasets[[1]]
test &lt;- datasets[[2]]

# Split presence locations in training (60%), validation (20%) and testing
# (20%) datasets and splitting the presence and the absence locations
datasets &lt;- trainValTest(data,
                         val = 0.2,
                         test = 0.2)
train &lt;- datasets[[1]]
val &lt;- datasets[[2]]
test &lt;- datasets[[3]]
</code></pre>

<hr>
<h2 id='tss'>True Skill Statistics</h2><span id='topic+tss'></span>

<h3>Description</h3>

<p>Compute the max TSS of a given model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tss(model, test = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tss_+3A_model">model</code></td>
<td>
<p><a href="#topic+SDMmodel-class">SDMmodel</a> or <a href="#topic+SDMmodelCV-class">SDMmodelCV</a> object.</p>
</td></tr>
<tr><td><code id="tss_+3A_test">test</code></td>
<td>
<p><a href="#topic+SWD-class">SWD</a> object when <code>model</code> is an
<a href="#topic+SDMmodel-class">SDMmodel</a> object; logical or <a href="#topic+SWD-class">SWD</a> object when
<code>model</code> is an <a href="#topic+SDMmodelCV-class">SDMmodelCV</a> object. If not provided it computes
the training TSS, see details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For <a href="#topic+SDMmodelCV-class">SDMmodelCV</a> objects, the function computes the
mean of the training TSS values of the k-folds. If <code>test = TRUE</code> it computes
the mean of the testing TSS values for the k-folds. If test is an
<a href="#topic+SWD-class">SWD</a> object, it computes the mean TSS values for the provided
testing dataset.
</p>


<h3>Value</h3>

<p>The value of the TSS of the given model.
</p>


<h3>Author(s)</h3>

<p>Sergio Vignali
</p>


<h3>References</h3>

<p>Allouche O., Tsoar A., Kadmon R., (2006). Assessing the accuracy of species
distribution models: prevalence, kappa and the true skill statistic (TSS).
Journal of Applied Ecology, 43(6), 1223–1232.
</p>


<h3>See Also</h3>

<p><a href="#topic+aicc">aicc</a> and <a href="#topic+auc">auc</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Acquire environmental variables
files &lt;- list.files(path = file.path(system.file(package = "dismo"), "ex"),
                    pattern = "grd",
                    full.names = TRUE)

predictors &lt;- terra::rast(files)

# Prepare presence and background locations
p_coords &lt;- virtualSp$presence
bg_coords &lt;- virtualSp$background

# Create SWD object
data &lt;- prepareSWD(species = "Virtual species",
                   p = p_coords,
                   a = bg_coords,
                   env = predictors,
                   categorical = "biome")

# Split presence locations in training (80%) and testing (20%) datasets
datasets &lt;- trainValTest(data,
                         test = 0.2,
                         only_presence = TRUE)
train &lt;- datasets[[1]]
test &lt;- datasets[[2]]

# Train a model
model &lt;- train(method = "Maxnet",
               data = train,
               fc = "l")

# Compute the training TSS
tss(model)

# Compute the testing TSS
tss(model,
    test = test)

# Same example but using cross validation instead of training and
# testing datasets. Create 4 random folds splitting only the presence
# locations
folds = randomFolds(train,
                    k = 4,
                    only_presence = TRUE)

model &lt;- train(method = "Maxnet",
               data = train,
               fc = "l",
               folds = folds)

# Compute the training TSS
tss(model)

# Compute the testing TSS
tss(model,
    test = TRUE)

# Compute the TSS for the held apart testing dataset
tss(model,
    test = test)
</code></pre>

<hr>
<h2 id='varImp'>Variable Importance</h2><span id='topic+varImp'></span>

<h3>Description</h3>

<p>The function randomly permutes one variable at time (using training and
absence/background datasets) and computes the decrease in training AUC. The
result is normalized to percentages. Same implementation of MaxEnt java
software but with the additional possibility of running several permutations
to obtain a better estimate of the permutation importance. In case of more
than one permutation (default is 10) the average of the decrease in training
AUC is computed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>varImp(model, permut = 10, progress = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="varImp_+3A_model">model</code></td>
<td>
<p><a href="#topic+SDMmodel-class">SDMmodel</a> or <a href="#topic+SDMmodelCV-class">SDMmodelCV</a> object.</p>
</td></tr>
<tr><td><code id="varImp_+3A_permut">permut</code></td>
<td>
<p>integer. Number of permutations.</p>
</td></tr>
<tr><td><code id="varImp_+3A_progress">progress</code></td>
<td>
<p>logical. If <code>TRUE</code> shows a progress bar.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that it could return values slightly different from MaxEnt Java
software due to a different random permutation.
</p>
<p>For <a href="#topic+SDMmodelCV-class">SDMmodelCV</a> objects the function returns the average and the
standard deviation of the permutation importances of the single models.
</p>


<h3>Value</h3>

<p>data.frame with the ordered permutation importance.
</p>


<h3>Author(s)</h3>

<p>Sergio Vignali
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Acquire environmental variables
files &lt;- list.files(path = file.path(system.file(package = "dismo"), "ex"),
                    pattern = "grd",
                    full.names = TRUE)

predictors &lt;- terra::rast(files)

# Prepare presence and background locations
p_coords &lt;- virtualSp$presence
bg_coords &lt;- virtualSp$background

# Create SWD object
data &lt;- prepareSWD(species = "Virtual species",
                   p = p_coords,
                   a = bg_coords,
                   env = predictors,
                   categorical = "biome")

# Split presence locations in training (80%) and testing (20%) datasets
datasets &lt;- trainValTest(data,
                         test = 0.2,
                         only_presence = TRUE)
train &lt;- datasets[[1]]
test &lt;- datasets[[2]]

# Train a model
model &lt;- train(method = "Maxnet",
               data = train,
               fc = "l")

# Compute variable importance
vi &lt;- varImp(model,
             permut = 5)
vi

# Same example but using cross validation instead of training and testing
# datasets
# Create 4 random folds splitting only the presence locations
folds = randomFolds(data,
                    k = 4,
                    only_presence = TRUE)

model &lt;- train(method = "Maxnet",
               data = data,
               fc = "l",
               folds = folds)

# Compute variable importance
vi &lt;- varImp(model,
             permut = 5)
vi
</code></pre>

<hr>
<h2 id='varSel'>Variable Selection</h2><span id='topic+varSel'></span>

<h3>Description</h3>

<p>The function performs a data-driven variable selection. Starting from the
provided model it iterates through all the variables starting from the one
with the highest contribution (permutation importance or maxent percent
contribution). If the variable is correlated with other variables (according
to the given method and threshold) it performs a Jackknife test and among the
correlated variables it removes the one that results in the best performing
model when removed (according to the given metric for the training dataset).
The process is repeated until the remaining variables are not highly
correlated anymore.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>varSel(
  model,
  metric,
  bg4cor,
  test = NULL,
  env = NULL,
  method = "spearman",
  cor_th = 0.7,
  permut = 10,
  use_pc = FALSE,
  interactive = TRUE,
  progress = TRUE,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="varSel_+3A_model">model</code></td>
<td>
<p><a href="#topic+SDMmodel-class">SDMmodel</a> or <a href="#topic+SDMmodelCV-class">SDMmodelCV</a> object.</p>
</td></tr>
<tr><td><code id="varSel_+3A_metric">metric</code></td>
<td>
<p>character. The metric used to evaluate the models, possible
values are: &quot;auc&quot;, &quot;tss&quot; and &quot;aicc&quot;.</p>
</td></tr>
<tr><td><code id="varSel_+3A_bg4cor">bg4cor</code></td>
<td>
<p><a href="#topic+SWD-class">SWD</a> object. Background locations used to test the
correlation between environmental variables.</p>
</td></tr>
<tr><td><code id="varSel_+3A_test">test</code></td>
<td>
<p><a href="#topic+SWD-class">SWD</a>. Test dataset used to evaluate the model, not
used with aicc and <a href="#topic+SDMmodelCV-class">SDMmodelCV</a> objects.</p>
</td></tr>
<tr><td><code id="varSel_+3A_env">env</code></td>
<td>
<p><a href="terra.html#topic+rast">rast</a> containing the environmental variables, used
only with &quot;aicc&quot;.</p>
</td></tr>
<tr><td><code id="varSel_+3A_method">method</code></td>
<td>
<p>character. The method used to compute the correlation matrix.</p>
</td></tr>
<tr><td><code id="varSel_+3A_cor_th">cor_th</code></td>
<td>
<p>numeric. The correlation threshold used to select highly
correlated variables.</p>
</td></tr>
<tr><td><code id="varSel_+3A_permut">permut</code></td>
<td>
<p>integer. Number of permutations.</p>
</td></tr>
<tr><td><code id="varSel_+3A_use_pc">use_pc</code></td>
<td>
<p>logical, use percent contribution. If <code>TRUE</code> and the model is
trained using the <a href="#topic+Maxent-class">Maxent</a> method, the algorithm uses the percent
contribution computed by Maxent software to score the variable importance.</p>
</td></tr>
<tr><td><code id="varSel_+3A_interactive">interactive</code></td>
<td>
<p>logical. If <code>FALSE</code> the interactive chart is not created.</p>
</td></tr>
<tr><td><code id="varSel_+3A_progress">progress</code></td>
<td>
<p>logical. If <code>TRUE</code> shows a progress bar.</p>
</td></tr>
<tr><td><code id="varSel_+3A_verbose">verbose</code></td>
<td>
<p>logical. If <code>TRUE</code> prints informative messages.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>An interactive chart showing in real-time the steps performed by the
algorithm is displayed in the Viewer pane.
</p>
<p>To find highly correlated variables the following formula is used:
</p>
<p style="text-align: center;"><code class="reqn">| coeff | \le cor_th</code>
</p>



<h3>Value</h3>

<p>The <a href="#topic+SDMmodel-class">SDMmodel</a> or <a href="#topic+SDMmodelCV-class">SDMmodelCV</a> object trained
using the selected variables.
</p>


<h3>Author(s)</h3>

<p>Sergio Vignali
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Acquire environmental variables
files &lt;- list.files(path = file.path(system.file(package = "dismo"), "ex"),
                    pattern = "grd",
                    full.names = TRUE)

predictors &lt;- terra::rast(files)

# Prepare presence and background locations
p_coords &lt;- virtualSp$presence
bg_coords &lt;- virtualSp$background

# Create SWD object
data &lt;- prepareSWD(species = "Virtual species",
                   p = p_coords,
                   a = bg_coords,
                   env = predictors,
                   categorical = "biome")

# Split presence locations in training (80%) and testing (20%) datasets
datasets &lt;- trainValTest(data,
                         test = 0.2,
                         only_presence = TRUE)
train &lt;- datasets[[1]]
test &lt;- datasets[[2]]

# Train a model
model &lt;- train(method = "Maxnet",
               data = train,
               fc = "l")

# Prepare background locations to test autocorrelation, this usually gives a
# warning message given that less than 10000 points can be randomly sampled
bg_coords &lt;- terra::spatSample(predictors,
                               size = 9000,
                               method = "random",
                               na.rm = TRUE,
                               xy = TRUE,
                               values = FALSE)

bg &lt;- prepareSWD(species = "Virtual species",
                 a = bg_coords,
                 env = predictors,
                 categorical = "biome")

## Not run: 
# Remove variables with correlation higher than 0.7 accounting for the AUC,
# in the following example the variable importance is computed as permutation
# importance
vs &lt;- varSel(model,
             metric = "auc",
             bg4cor = bg,
             test = test,
             cor_th = 0.7,
             permut = 1)
vs

# Remove variables with correlation higher than 0.7 accounting for the TSS,
# in the following example the variable importance is the MaxEnt percent
# contribution
# Train a model
model &lt;- train(method = "Maxent",
               data = train,
               fc = "l")

vs &lt;- varSel(model,
             metric = "tss",
             bg4cor = bg,
             test = test,
             cor_th = 0.7,
             use_pc = TRUE)
vs

# Remove variables with correlation higher than 0.7 accounting for the aicc,
# in the following example the variable importance is the MaxEnt percent
# contribution
vs &lt;- varSel(model,
             metric = "aicc",
             bg4cor = bg,
             cor_th = 0.7,
             use_pc = TRUE,
             env = predictors)
vs
## End(Not run)
</code></pre>

<hr>
<h2 id='virtualSp'>Virtual Species</h2><span id='topic+virtualSp'></span>

<h3>Description</h3>

<p>Dataset containing a random generated virtual species. The purpose of this
dataset is to demonstrate the use of the functions included in the package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>virtualSp
</code></pre>


<h3>Format</h3>

<p>A list with five elements:
</p>

<dl>
<dt>presence</dt><dd><p>400 random generated coordinates for the presence locations.</p>
</dd>
<dt>absence</dt><dd><p>300 random generated coordinates for the absence locations.</p>
</dd>
<dt>background</dt><dd><p>5000 random generated coordinates for the background
locations.</p>
</dd>
<dt>pa_map</dt><dd><p>Presence absence map used to extract the presence and absence
locations.</p>
</dd>
<dt>prob_map</dt><dd><p>Probability map of the random generated virtual species.</p>
</dd>
</dl>



<h3>Details</h3>

<p>The random species has been generated using the package
<strong>virtualspecies</strong>.
</p>


<h3>References</h3>

<p>Leroy, B. , Meynard, C. N., Bellard, C. and Courchamp, F. (2016),
virtualspecies, an R package to generate virtual species distributions.
Ecography, 39: 599-607. doi:10.1111/ecog.01388
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
