<!DOCTYPE html><html lang="en-US"><head><title>Help for package ravepipeline</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ravepipeline}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#install_modules'><p>Install 'RAVE' modules</p></a></li>
<li><a href='#module_add'><p>Add new 'RAVE' (2.0) module to current project</p></a></li>
<li><a href='#module_registry'><p>'RAVE' module registry</p></a></li>
<li><a href='#pipeline'><p>Creates 'RAVE' pipeline instance</p></a></li>
<li><a href='#pipeline_install'><p>Install 'RAVE' pipelines</p></a></li>
<li><a href='#pipeline_settings_get_set'><p>Get or change pipeline input parameter settings</p></a></li>
<li><a href='#pipeline-knitr-markdown'><p>Configure <code>'rmarkdown'</code> files to build 'RAVE' pipelines</p></a></li>
<li><a href='#PipelineResult'><p>Pipeline result object</p></a></li>
<li><a href='#PipelineTools'><p>Class definition for pipeline tools</p></a></li>
<li><a href='#rave-pipeline'><p>Low-level 'RAVE' pipeline functions</p></a></li>
<li><a href='#rave-snippet'><p>'RAVE' code snippets</p></a></li>
<li><a href='#raveio-option'><p>Set/Get 'RAVE' option</p></a></li>
<li><a href='#ravepipeline_finalize_installation'><p>Download 'RAVE' built-in pipelines and code snippets</p></a></li>
<li><a href='#ravepipeline-constants'><p>Constant variables used in 'RAVE' pipeline</p></a></li>
<li><a href='#reexports'><p>Objects exported from other packages</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Reproducible Pipeline Infrastructure for Neuroscience</td>
</tr>
<tr>
<td>Version:</td>
<td>0.0.1</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>Description:</td>
<td>Defines the underlying pipeline structure for reproducible 
    neuroscience, adopted by 'RAVE' (reproducible analysis and visualization 
    of intracranial electroencephalography); provides high-level class 
    definition to build, compile, set, execute, and share analysis pipelines. 
    Both R and 'Python' are supported, with 'Markdown' and 'shiny' dashboard 
    templates for extending and building customized pipelines. See the full 
    documentations at <a href="https://rave.wiki">https://rave.wiki</a>; to cite us, 
    check out our paper by Magnotti, Wang, and Beauchamp (2020, 
    &lt;<a href="https://doi.org/10.1016%2Fj.neuroimage.2020.117341">doi:10.1016/j.neuroimage.2020.117341</a>&gt;), or run 
    citation("ravepipeline") for details.</td>
</tr>
<tr>
<td>Copyright:</td>
<td>Trustees of University of Pennsylvania owns the copyright of
the package unless otherwise stated. Zhengjia Wang owns the
copyright of all the low-level functions included in
'R/common.R', 'R/fastmap2', 'R/fastqueue2.R', 'R/filesys.R',
'R/fst.R', 'R/json.R', 'R/os_info.R', 'R/parallel.R',
'R/progress.R', 'R/simplelocker.R', 'R/yaml.R', and all the
template files under 'inst/rave-pipelines' and
'inst/rave-modules', these files are licensed under 'MIT'.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://dipterix.org/ravepipeline/">https://dipterix.org/ravepipeline/</a>,
<a href="https://github.com/dipterix/ravepipeline">https://github.com/dipterix/ravepipeline</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/dipterix/ravepipeline/issues">https://github.com/dipterix/ravepipeline/issues</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>utils, stats, base64url, callr, cli, digest, fastmap, future,
fst (&ge; 0.9.8), glue, jsonlite, knitr, promises, R6, remotes,
rlang, targets, uuid, yaml</td>
</tr>
<tr>
<td>Suggests:</td>
<td>filearray, future.apply, globals, ieegio, rpymat, rmarkdown,
rstudioapi, shidashi, threeBrain, testthat (&ge; 3.0.0),
visNetwork</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-03-10 21:34:33 UTC; dipterix</td>
</tr>
<tr>
<td>Author:</td>
<td>Zhengjia Wang [aut, cre, cph],
  John Magnotti [ctb, res],
  Xiang Zhang [ctb, res],
  Michael Beauchamp [ctb, res],
  Trustees of University of Pennsylvania [cph] (Copyright Holder)</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Zhengjia Wang &lt;dipterix.wang@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-03-13 12:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='install_modules'>Install 'RAVE' modules</h2><span id='topic+install_modules'></span>

<h3>Description</h3>

<p>Low-level function exported for down-stream 'RAVE' packages.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>install_modules(modules, dependencies = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="install_modules_+3A_modules">modules</code></td>
<td>
<p>a vector of characters, repository names; default is to
automatically determined from a public registry</p>
</td></tr>
<tr><td><code id="install_modules_+3A_dependencies">dependencies</code></td>
<td>
<p>whether to update dependent packages; default is false</p>
</td></tr>
</table>


<h3>Value</h3>

<p>nothing
</p>

<hr>
<h2 id='module_add'>Add new 'RAVE' (2.0) module to current project</h2><span id='topic+module_add'></span>

<h3>Description</h3>

<p>Creates a 'RAVE' pipeline with additional dashboard module from template.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>module_add(
  module_id,
  module_label,
  path = ".",
  type = c("default", "bare", "scheduler", "python"),
  ...,
  pipeline_name = module_id,
  overwrite = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="module_add_+3A_module_id">module_id</code></td>
<td>
<p>module ID to create, must be unique; users cannot install
two modules with identical module ID. We recommend that
a module ID follows snake format, starting with lab name, for example,
<code>'beauchamplab_imaging_preprocess'</code>, <code>'karaslab_freez'</code>, or
<code>'upenn_ese25_fooof'</code>.</p>
</td></tr>
<tr><td><code id="module_add_+3A_module_label">module_label</code></td>
<td>
<p>a friendly label to display in the dashboard</p>
</td></tr>
<tr><td><code id="module_add_+3A_path">path</code></td>
<td>
<p>project root path; default is current directory</p>
</td></tr>
<tr><td><code id="module_add_+3A_type">type</code></td>
<td>
<p>template to choose, options are <code>'default'</code> and
<code>'bare'</code></p>
</td></tr>
<tr><td><code id="module_add_+3A_...">...</code></td>
<td>
<p>additional configurations to the module such as <code>'order'</code>,
<code>'group'</code>, <code>'badge'</code></p>
</td></tr>
<tr><td><code id="module_add_+3A_pipeline_name">pipeline_name</code></td>
<td>
<p>the pipeline name to create along with the module;
default is identical to <code>module_id</code> (strongly recommended); leave
it default unless you know what you are doing.</p>
</td></tr>
<tr><td><code id="module_add_+3A_overwrite">overwrite</code></td>
<td>
<p>whether to overwrite existing module if module with
same ID exists; default is false</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

# For demonstrating this example only
project_root &lt;- tempfile()
dir.create(project_root, showWarnings = FALSE, recursive = TRUE)


# Add a module
module_id &lt;- "mylab_my_first_module"
module_add(
  module_id = module_id,
  module_label = "My Pipeline",
  path = project_root
)


# show the structure
cat(
  list.files(
    project_root,
    recursive = TRUE,
    full.names = FALSE,
    include.dirs = TRUE
  ),
  sep = "\n"
)

unlink(project_root, recursive = TRUE)


</code></pre>

<hr>
<h2 id='module_registry'>'RAVE' module registry</h2><span id='topic+module_registry'></span><span id='topic+module_registry2'></span><span id='topic+get_modules_registries'></span><span id='topic+get_module_description'></span><span id='topic+add_module_registry'></span>

<h3>Description</h3>

<p>Create, view, or reserve the module registry
</p>


<h3>Usage</h3>

<pre><code class='language-R'>module_registry(
  title,
  repo,
  modules,
  authors,
  url = sprintf("https://github.com/%s", repo)
)

module_registry2(repo, description)

get_modules_registries(update = NA)

get_module_description(path)

add_module_registry(title, repo, modules, authors, url, dry_run = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="module_registry_+3A_title">title</code></td>
<td>
<p>title of the registry, usually identical to the description
title in <code>'DESCRIPTION'</code> or <code>RAVE-CONFIG</code> file</p>
</td></tr>
<tr><td><code id="module_registry_+3A_repo">repo</code></td>
<td>
<p>'Github' repository</p>
</td></tr>
<tr><td><code id="module_registry_+3A_modules">modules</code></td>
<td>
<p>characters of module ID, must only contain letters, digits,
underscore, dash; must not be duplicated with existing registered modules</p>
</td></tr>
<tr><td><code id="module_registry_+3A_authors">authors</code></td>
<td>
<p>a list of module authors; there must be one and only one
author with <code>'cre'</code> role (see <code><a href="utils.html#topic+person">person</a></code>). This
author will be considered maintainer, who will be in charge if editing the
registry</p>
</td></tr>
<tr><td><code id="module_registry_+3A_url">url</code></td>
<td>
<p>the web address of the repository</p>
</td></tr>
<tr><td><code id="module_registry_+3A_update">update</code></td>
<td>
<p>whether to force updating the registry</p>
</td></tr>
<tr><td><code id="module_registry_+3A_path">path</code>, <code id="module_registry_+3A_description">description</code></td>
<td>
<p>path to <code>'DESCRIPTION'</code> or <code>RAVE-CONFIG</code> file</p>
</td></tr>
<tr><td><code id="module_registry_+3A_dry_run">dry_run</code></td>
<td>
<p>whether to generate and preview message content instead of
opening an email link</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A 'RAVE' registry contains the following data entries: repository
title, name, 'URL', authors, and a list of module IDs. 'RAVE' requires
that each module must use a unique module ID. It will cause an issue if two
modules share the same ID. Therefore 'RAVE' maintains a public registry
list such that the module maintainers can register their own module ID
and prevent other people from using it.
</p>
<p>To register your own module ID, please use <code>add_module_registry</code> to
validate and send an email to the 'RAVE' development team.
</p>


<h3>Value</h3>

<p>a registry object, or a list of registries
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(ravepipeline)

# create your own registry
module_registry(
  repo = "rave-ieeg/rave-pipelines",
  title = "A Collection of 'RAVE' Builtin Pipelines",
  authors = list(
    list("Zhengjia", "Wang", role = c("cre", "aut"),
         email = "dipterix@rave.wiki")
  ),
  modules = "brain_viewer"
)


## Not run: 

# This example will need access to Github and will open an email link

# get current registries
get_modules_registries(FALSE)

# If your repository is on Github and RAVE-CONFIG file exists
module_registry2("rave-ieeg/rave-pipelines")

# send a request to add your registry
registry &lt;- module_registry2("rave-ieeg/rave-pipelines")
add_module_registry(registry)


## End(Not run)


</code></pre>

<hr>
<h2 id='pipeline'>Creates 'RAVE' pipeline instance</h2><span id='topic+pipeline'></span><span id='topic+pipeline_from_path'></span>

<h3>Description</h3>

<p>Set pipeline inputs, execute, and read pipeline outputs
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pipeline(
  pipeline_name,
  settings_file = "settings.yaml",
  paths = pipeline_root(),
  temporary = FALSE
)

pipeline_from_path(path, settings_file = "settings.yaml")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pipeline_+3A_pipeline_name">pipeline_name</code></td>
<td>
<p>the name of the pipeline, usually title field in the
<code>'DESCRIPTION'</code> file, or the pipeline folder name (if description
file is missing)</p>
</td></tr>
<tr><td><code id="pipeline_+3A_settings_file">settings_file</code></td>
<td>
<p>the name of the settings file, usually stores user
inputs</p>
</td></tr>
<tr><td><code id="pipeline_+3A_paths">paths</code></td>
<td>
<p>the paths to search for the pipeline, usually the parent
directory of the pipeline; default is <code><a href="#topic+pipeline_root">pipeline_root</a></code>, which
only search for pipelines that are installed or in current working directory.</p>
</td></tr>
<tr><td><code id="pipeline_+3A_temporary">temporary</code></td>
<td>
<p>see <code><a href="#topic+pipeline_root">pipeline_root</a></code></p>
</td></tr>
<tr><td><code id="pipeline_+3A_path">path</code></td>
<td>
<p>the pipeline folder</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="#topic+PipelineTools">PipelineTools</a></code> instance
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(ravepipeline)

if(interactive()) {

  # ------------ Set up a bare minimal example pipeline ---------------
  root_path &lt;- tempdir()
  pipeline_root_folder &lt;- file.path(root_path, "modules")

  # create pipeline folder
  pipeline_path &lt;- pipeline_create_template(
    root_path = pipeline_root_folder, pipeline_name = "raveio_demo",
    overwrite = TRUE, activate = FALSE, template_type = "rmd-bare")

  # Set initial user inputs
  yaml::write_yaml(
    x = list(
      n = 100,
      pch = 16,
      col = "steelblue"
    ),
    file = file.path(pipeline_path, "settings.yaml")
  )

  # build the pipeline for the first time
  # this is a one-time setup
  pipeline_build(pipeline_path)

  # Temporarily redirect the pipeline project root
  # to `root_path`
  old_opt &lt;- options("raveio.pipeline.project_root" = root_path)
  # Make sure the options are reset
  on.exit({ options(old_opt) })

  # Compile the pipeline document
  pipeline_render(
    module_id = "raveio_demo",
    project_path = root_path
  )

  ## Not run: 

    # Open web browser to see compiled report
    utils::browseURL(file.path(pipeline_path, "main.html"))

  
## End(Not run)

  # --------------------- Example starts ------------------------

  # Load pipeline
  pipeline &lt;- pipeline(
    pipeline_name = "raveio_demo",
    paths = pipeline_root_folder,
    temporary = TRUE
  )

  # Check which pipeline targets to run
  pipeline$target_table

  # Run to `plot_data`, RAVE pipeline will automatically
  # calculate which up-stream targets need to be updated
  # and evaluate these targets
  pipeline$run("plot_data")

  # Customize settings
  pipeline$set_settings(pch = 2)

  # Run again with the new inputs, since input_data does not change,
  # the pipeline will skip that target automatically
  pipeline$run("plot_data")

  # Read intermediate data
  head(pipeline$read("input_data"))

  # or use `[]` to get results
  pipeline[c("n", "pch", "col")]
  pipeline[-c("input_data")]

  # Check evaluating status
  pipeline$progress("details")

  # result summary &amp; cache table
  pipeline$result_table

  # visualize the target dependency graph
  pipeline$visualize(glimpse = TRUE)

  # --------------------- Clean up ------------------------
  unlink(pipeline_path, recursive = TRUE)
}

</code></pre>

<hr>
<h2 id='pipeline_install'>Install 'RAVE' pipelines</h2><span id='topic+pipeline_install'></span><span id='topic+pipeline_install_local'></span><span id='topic+pipeline_install_github'></span>

<h3>Description</h3>

<p>Install 'RAVE' pipelines
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pipeline_install_local(
  src,
  to = c("default", "custom", "workdir", "tempdir"),
  upgrade = FALSE,
  force = FALSE,
  set_default = NA,
  ...
)

pipeline_install_github(
  repo,
  to = c("default", "custom", "workdir", "tempdir"),
  upgrade = FALSE,
  force = FALSE,
  set_default = NA,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pipeline_install_+3A_src">src</code></td>
<td>
<p>pipeline directory</p>
</td></tr>
<tr><td><code id="pipeline_install_+3A_to">to</code></td>
<td>
<p>installation path; choices are <code>'default'</code>, <code>'custom'</code>,
<code>'workdir'</code>, and <code>'tempdir'</code>. Please specify pipeline root path
via <code><a href="#topic+pipeline_root">pipeline_root</a></code> when <code>'custom'</code> is used.</p>
</td></tr>
<tr><td><code id="pipeline_install_+3A_upgrade">upgrade</code></td>
<td>
<p>whether to upgrade the dependence; default is <code>FALSE</code>
for stability, however, it is highly recommended to upgrade your
dependencies</p>
</td></tr>
<tr><td><code id="pipeline_install_+3A_force">force</code></td>
<td>
<p>whether to force installing the pipelines</p>
</td></tr>
<tr><td><code id="pipeline_install_+3A_set_default">set_default</code></td>
<td>
<p>whether to set current pipeline module folder as the
default, will be automatically set when the pipeline is from the official
'Github' repository.</p>
</td></tr>
<tr><td><code id="pipeline_install_+3A_...">...</code></td>
<td>
<p>other parameters not used</p>
</td></tr>
<tr><td><code id="pipeline_install_+3A_repo">repo</code></td>
<td>
<p>'Github' repository in user-repository combination, for example,
<code>'rave-ieeg/rave-pipeline'</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>nothing
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 


pipeline_install_github("rave-ieeg/pipelines")


# or download github.com/rave-ieeg/pipelines repository, extract
# to a folder, and call
pipeline_install_local("path/to/pipeline/folder")


## End(Not run)


</code></pre>

<hr>
<h2 id='pipeline_settings_get_set'>Get or change pipeline input parameter settings</h2><span id='topic+pipeline_settings_get_set'></span><span id='topic+pipeline_settings_set'></span><span id='topic+pipeline_settings_get'></span>

<h3>Description</h3>

<p>Get or change pipeline input parameter settings
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pipeline_settings_set(
  ...,
  pipeline_path = Sys.getenv("RAVE_PIPELINE", "."),
  pipeline_settings_path = file.path(pipeline_path, "settings.yaml")
)

pipeline_settings_get(
  key,
  default = NULL,
  constraint = NULL,
  pipeline_path = Sys.getenv("RAVE_PIPELINE", "."),
  pipeline_settings_path = file.path(pipeline_path, "settings.yaml")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pipeline_settings_get_set_+3A_pipeline_path">pipeline_path</code></td>
<td>
<p>the root directory of the pipeline</p>
</td></tr>
<tr><td><code id="pipeline_settings_get_set_+3A_pipeline_settings_path">pipeline_settings_path</code></td>
<td>
<p>the settings file of the pipeline, must be
a 'yaml' file; default is <code>'settings.yaml'</code> in the current pipeline</p>
</td></tr>
<tr><td><code id="pipeline_settings_get_set_+3A_key">key</code>, <code id="pipeline_settings_get_set_+3A_...">...</code></td>
<td>
<p>the character key(s) to get or set</p>
</td></tr>
<tr><td><code id="pipeline_settings_get_set_+3A_default">default</code></td>
<td>
<p>the default value is key is missing</p>
</td></tr>
<tr><td><code id="pipeline_settings_get_set_+3A_constraint">constraint</code></td>
<td>
<p>the constraint of the resulting value; if not <code>NULL</code>,
then result must be within the <code>constraint</code> values, otherwise the
first element of <code>constraint</code> will be returned. This is useful to make
sure the results stay within given options</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>pipeline_settings_set</code> returns a list of all the settings.
<code>pipeline_settings_get</code> returns the value of given key.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>


root_path &lt;- tempfile()
pipeline_root_folder &lt;- file.path(root_path, "modules")

# create pipeline folder
pipeline_path &lt;- pipeline_create_template(
  root_path = pipeline_root_folder, pipeline_name = "raveio_demo",
  overwrite = TRUE, activate = FALSE, template_type = "rmd-bare")

# Set initial user inputs
yaml::write_yaml(
  x = list(
    n = 100,
    pch = 16,
    col = "steelblue"
  ),
  file = file.path(pipeline_path, "settings.yaml")
)

# build the pipeline for the first time
# this is a one-time setup
pipeline_build(pipeline_path)

# get pipeline settings
pipeline_settings_get(
  key = "n",
  pipeline_path = pipeline_path
)

# get variable with default if missing
pipeline_settings_get(
  key = "missing_variable",
  default = "missing",
  pipeline_path = pipeline_path
)

pipeline_settings_set(
  missing_variable = "A",
  pipeline_path = pipeline_path
)

pipeline_settings_get(
  key = "missing_variable",
  default = "missing",
  pipeline_path = pipeline_path
)


unlink(root_path, recursive = TRUE)


</code></pre>

<hr>
<h2 id='pipeline-knitr-markdown'>Configure <code>'rmarkdown'</code> files to build 'RAVE' pipelines</h2><span id='topic+pipeline-knitr-markdown'></span><span id='topic+configure_knitr'></span><span id='topic+pipeline_setup_rmd'></span><span id='topic+pipeline_render'></span>

<h3>Description</h3>

<p>Allows building 'RAVE' pipelines from <code>'rmarkdown'</code> files.
Please use it in <code>'rmarkdown'</code> scripts only. Use
<code><a href="#topic+pipeline_create_template">pipeline_create_template</a></code> to create an example.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>configure_knitr(languages = c("R", "python"))

pipeline_setup_rmd(
  module_id,
  env = parent.frame(),
  collapse = TRUE,
  comment = "#&gt;",
  languages = c("R", "python"),
  project_path = getOption("raveio.pipeline.project_root", default =
    rs_active_project(child_ok = TRUE, shiny_ok = TRUE))
)

pipeline_render(
  module_id,
  ...,
  env = new.env(parent = parent.frame()),
  entry_file = "main.Rmd",
  project_path = getOption("raveio.pipeline.project_root", default =
    rs_active_project(child_ok = TRUE, shiny_ok = TRUE))
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pipeline-knitr-markdown_+3A_languages">languages</code></td>
<td>
<p>one or more programming languages to support; options are
<code>'R'</code> and <code>'python'</code></p>
</td></tr>
<tr><td><code id="pipeline-knitr-markdown_+3A_module_id">module_id</code></td>
<td>
<p>the module ID, usually the name of direct parent folder
containing the pipeline file</p>
</td></tr>
<tr><td><code id="pipeline-knitr-markdown_+3A_env">env</code></td>
<td>
<p>environment to set up the pipeline translator</p>
</td></tr>
<tr><td><code id="pipeline-knitr-markdown_+3A_collapse">collapse</code>, <code id="pipeline-knitr-markdown_+3A_comment">comment</code></td>
<td>
<p>passed to <code>set</code> method of
<code><a href="knitr.html#topic+opts_chunk">opts_chunk</a></code></p>
</td></tr>
<tr><td><code id="pipeline-knitr-markdown_+3A_project_path">project_path</code></td>
<td>
<p>the project path containing all the pipeline folders,
usually the active project folder</p>
</td></tr>
<tr><td><code id="pipeline-knitr-markdown_+3A_...">...</code></td>
<td>
<p>passed to internal function calls</p>
</td></tr>
<tr><td><code id="pipeline-knitr-markdown_+3A_entry_file">entry_file</code></td>
<td>
<p>the file to compile; default is <code>"main.Rmd"</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A function that is supposed to be called later that builds the
pipeline scripts
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
configure_knitr("R")

## Not run: 

# Requires to configure Python
configure_knitr("python")

# This function must be called in an Rmd file setup block
# for example, see
# https://rave.wiki/posts/customize_modules/python_module_01.html

pipeline_setup_rmd("my_module_id")


## End(Not run)

</code></pre>

<hr>
<h2 id='PipelineResult'>Pipeline result object</h2><span id='topic+PipelineResult'></span>

<h3>Description</h3>

<p>Pipeline result object
</p>
<p>Pipeline result object
</p>


<h3>Value</h3>

<p><code>TRUE</code> if the target is finished, or <code>FALSE</code> if
timeout is reached
</p>


<h3>Public fields</h3>

<div class="r6-fields">

<dl>
<dt><code>progressor</code></dt><dd><p>progress bar object, usually generated a progress
instance</p>
</dd>
<dt><code>promise</code></dt><dd><p>a <code><a href="promises.html#topic+promise">promise</a></code> instance that monitors
the pipeline progress</p>
</dd>
<dt><code>verbose</code></dt><dd><p>whether to print warning messages</p>
</dd>
<dt><code>names</code></dt><dd><p>names of the pipeline to build</p>
</dd>
<dt><code>async_callback</code></dt><dd><p>function callback to call in each check loop;
only used when the pipeline is running in <code>async=TRUE</code> mode</p>
</dd>
<dt><code>check_interval</code></dt><dd><p>used when <code>async=TRUE</code> in
<code><a href="#topic+pipeline_run">pipeline_run</a></code>, interval in seconds to check the progress</p>
</dd>
</dl>

</div>


<h3>Active bindings</h3>

<div class="r6-active-bindings">

<dl>
<dt><code>variables</code></dt><dd><p>target variables of the pipeline</p>
</dd>
<dt><code>variable_descriptions</code></dt><dd><p>readable descriptions of the target variables</p>
</dd>
<dt><code>valid</code></dt><dd><p>logical true or false whether the result instance hasn't
been invalidated</p>
</dd>
<dt><code>status</code></dt><dd><p>result status, possible status are <code>'initialize'</code>,
<code>'running'</code>, <code>'finished'</code>, <code>'canceled'</code>,
and <code>'errored'</code>. Note that <code>'finished'</code> only means the pipeline
process has been finished.</p>
</dd>
<dt><code>process</code></dt><dd><p>(read-only) process object if the pipeline is running in
<code>'async'</code> mode, or <code>NULL</code>; see <code><a href="callr.html#topic+r_bg">r_bg</a></code>.</p>
</dd>
</dl>

</div>


<h3>Methods</h3>



<h4>Public methods</h4>


<ul>
<li> <p><a href="#method-PipelineResult-validate"><code>PipelineResult$validate()</code></a>
</p>
</li>
<li> <p><a href="#method-PipelineResult-invalidate"><code>PipelineResult$invalidate()</code></a>
</p>
</li>
<li> <p><a href="#method-PipelineResult-get_progress"><code>PipelineResult$get_progress()</code></a>
</p>
</li>
<li> <p><a href="#method-PipelineResult-new"><code>PipelineResult$new()</code></a>
</p>
</li>
<li> <p><a href="#method-PipelineResult-run"><code>PipelineResult$run()</code></a>
</p>
</li>
<li> <p><a href="#method-PipelineResult-await"><code>PipelineResult$await()</code></a>
</p>
</li>
<li> <p><a href="#method-PipelineResult-print"><code>PipelineResult$print()</code></a>
</p>
</li>
<li> <p><a href="#method-PipelineResult-get_values"><code>PipelineResult$get_values()</code></a>
</p>
</li>
<li> <p><a href="#method-PipelineResult-clone"><code>PipelineResult$clone()</code></a>
</p>
</li></ul>


<hr>
<a id="method-PipelineResult-validate"></a>



<h4>Method <code>validate()</code></h4>

<p>check if result is valid, raises errors when invalidated
</p>


<h5>Usage</h5>

<div class="r"><pre>PipelineResult$validate()</pre></div>


<hr>
<a id="method-PipelineResult-invalidate"></a>



<h4>Method <code>invalidate()</code></h4>

<p>invalidate the pipeline result
</p>


<h5>Usage</h5>

<div class="r"><pre>PipelineResult$invalidate()</pre></div>


<hr>
<a id="method-PipelineResult-get_progress"></a>



<h4>Method <code>get_progress()</code></h4>

<p>get pipeline progress
</p>


<h5>Usage</h5>

<div class="r"><pre>PipelineResult$get_progress()</pre></div>


<hr>
<a id="method-PipelineResult-new"></a>



<h4>Method <code>new()</code></h4>

<p>constructor (internal)
</p>


<h5>Usage</h5>

<div class="r"><pre>PipelineResult$new(path = character(0L), verbose = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>path</code></dt><dd><p>pipeline path</p>
</dd>
<dt><code>verbose</code></dt><dd><p>whether to print warnings</p>
</dd>
</dl>

</div>


<hr>
<a id="method-PipelineResult-run"></a>



<h4>Method <code>run()</code></h4>

<p>run pipeline (internal)
</p>


<h5>Usage</h5>

<div class="r"><pre>PipelineResult$run(
  expr,
  env = parent.frame(),
  quoted = FALSE,
  async = FALSE,
  process = NULL
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>expr</code></dt><dd><p>expression to evaluate</p>
</dd>
<dt><code>env</code></dt><dd><p>environment of <code>expr</code></p>
</dd>
<dt><code>quoted</code></dt><dd><p>whether <code>expr</code> has been quoted</p>
</dd>
<dt><code>async</code></dt><dd><p>whether the process runs in other sessions</p>
</dd>
<dt><code>process</code></dt><dd><p>the process object inherits <code><a href="callr.html#topic+process">process</a></code>,
will be inferred from <code>expr</code> if <code>process=NULL</code>,
and will raise errors if cannot be found</p>
</dd>
</dl>

</div>


<hr>
<a id="method-PipelineResult-await"></a>



<h4>Method <code>await()</code></h4>

<p>wait until some targets get finished
</p>


<h5>Usage</h5>

<div class="r"><pre>PipelineResult$await(names = NULL, timeout = Inf)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>names</code></dt><dd><p>target names to wait, default is <code>NULL</code>, i.e. to
wait for all targets that have been scheduled</p>
</dd>
<dt><code>timeout</code></dt><dd><p>maximum waiting time in seconds</p>
</dd>
</dl>

</div>


<hr>
<a id="method-PipelineResult-print"></a>



<h4>Method <code>print()</code></h4>

<p>print method
</p>


<h5>Usage</h5>

<div class="r"><pre>PipelineResult$print()</pre></div>


<hr>
<a id="method-PipelineResult-get_values"></a>



<h4>Method <code>get_values()</code></h4>

<p>get results
</p>


<h5>Usage</h5>

<div class="r"><pre>PipelineResult$get_values(names = NULL, ...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>names</code></dt><dd><p>the target names to read</p>
</dd>
<dt><code>...</code></dt><dd><p>passed to <code><a href="#topic+pipeline_read">pipeline_read</a></code></p>
</dd>
</dl>

</div>


<hr>
<a id="method-PipelineResult-clone"></a>



<h4>Method <code>clone()</code></h4>

<p>The objects of this class are cloneable with this method.
</p>


<h5>Usage</h5>

<div class="r"><pre>PipelineResult$clone(deep = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>deep</code></dt><dd><p>Whether to make a deep clone.</p>
</dd>
</dl>

</div>



<hr>
<h2 id='PipelineTools'>Class definition for pipeline tools</h2><span id='topic+PipelineTools'></span>

<h3>Description</h3>

<p>Class definition for pipeline tools
</p>
<p>Class definition for pipeline tools
</p>


<h3>Value</h3>

<p>The value of the inputs, or a list if <code>key</code> is missing
</p>
<p>The values of the targets
</p>
<p>A <code><a href="#topic+PipelineResult">PipelineResult</a></code> instance if <code>as_promise</code>
or <code>async</code> is true; otherwise a list of values for input <code>names</code>
</p>
<p>An environment of shared variables
</p>
<p>See <code>type</code>
</p>
<p>A table of the progress
</p>
<p>Nothing
</p>
<p>ancestor target names (including <code>names</code>)
</p>
<p>A new pipeline object based on the path given
</p>
<p>A new pipeline object based on the path given
</p>
<p>the saved file path
</p>
<p>the data if file is found or a default value
</p>
<p>A list of key-value pairs
</p>
<p>A list of the preferences. If <code>simplify</code> is true and length
if keys is 1, then returns the value of that preference
</p>
<p>logical whether the keys exist
</p>


<h3>Active bindings</h3>

<div class="r6-active-bindings">

<dl>
<dt><code>description</code></dt><dd><p>pipeline description</p>
</dd>
<dt><code>settings_path</code></dt><dd><p>absolute path to the settings file</p>
</dd>
<dt><code>extdata_path</code></dt><dd><p>absolute path to the user-defined pipeline data folder</p>
</dd>
<dt><code>preference_path</code></dt><dd><p>directory to the pipeline preference folder</p>
</dd>
<dt><code>target_table</code></dt><dd><p>table of target names and their descriptions</p>
</dd>
<dt><code>result_table</code></dt><dd><p>summary of the results, including
signatures of data and commands</p>
</dd>
<dt><code>pipeline_path</code></dt><dd><p>the absolute path of the pipeline</p>
</dd>
<dt><code>pipeline_name</code></dt><dd><p>the code name of the pipeline</p>
</dd>
</dl>

</div>


<h3>Methods</h3>



<h4>Public methods</h4>


<ul>
<li> <p><a href="#method-PipelineTools-new"><code>PipelineTools$new()</code></a>
</p>
</li>
<li> <p><a href="#method-PipelineTools-set_settings"><code>PipelineTools$set_settings()</code></a>
</p>
</li>
<li> <p><a href="#method-PipelineTools-get_settings"><code>PipelineTools$get_settings()</code></a>
</p>
</li>
<li> <p><a href="#method-PipelineTools-read"><code>PipelineTools$read()</code></a>
</p>
</li>
<li> <p><a href="#method-PipelineTools-run"><code>PipelineTools$run()</code></a>
</p>
</li>
<li> <p><a href="#method-PipelineTools-eval"><code>PipelineTools$eval()</code></a>
</p>
</li>
<li> <p><a href="#method-PipelineTools-shared_env"><code>PipelineTools$shared_env()</code></a>
</p>
</li>
<li> <p><a href="#method-PipelineTools-python_module"><code>PipelineTools$python_module()</code></a>
</p>
</li>
<li> <p><a href="#method-PipelineTools-progress"><code>PipelineTools$progress()</code></a>
</p>
</li>
<li> <p><a href="#method-PipelineTools-attach"><code>PipelineTools$attach()</code></a>
</p>
</li>
<li> <p><a href="#method-PipelineTools-visualize"><code>PipelineTools$visualize()</code></a>
</p>
</li>
<li> <p><a href="#method-PipelineTools-target_ancestors"><code>PipelineTools$target_ancestors()</code></a>
</p>
</li>
<li> <p><a href="#method-PipelineTools-fork"><code>PipelineTools$fork()</code></a>
</p>
</li>
<li> <p><a href="#method-PipelineTools-fork_to_subject"><code>PipelineTools$fork_to_subject()</code></a>
</p>
</li>
<li> <p><a href="#method-PipelineTools-with_activated"><code>PipelineTools$with_activated()</code></a>
</p>
</li>
<li> <p><a href="#method-PipelineTools-clean"><code>PipelineTools$clean()</code></a>
</p>
</li>
<li> <p><a href="#method-PipelineTools-save_data"><code>PipelineTools$save_data()</code></a>
</p>
</li>
<li> <p><a href="#method-PipelineTools-load_data"><code>PipelineTools$load_data()</code></a>
</p>
</li>
<li> <p><a href="#method-PipelineTools-set_preferences"><code>PipelineTools$set_preferences()</code></a>
</p>
</li>
<li> <p><a href="#method-PipelineTools-get_preferences"><code>PipelineTools$get_preferences()</code></a>
</p>
</li>
<li> <p><a href="#method-PipelineTools-has_preferences"><code>PipelineTools$has_preferences()</code></a>
</p>
</li>
<li> <p><a href="#method-PipelineTools-clone"><code>PipelineTools$clone()</code></a>
</p>
</li></ul>


<hr>
<a id="method-PipelineTools-new"></a>



<h4>Method <code>new()</code></h4>

<p>construction function
</p>


<h5>Usage</h5>

<div class="r"><pre>PipelineTools$new(
  pipeline_name,
  settings_file = "settings.yaml",
  paths = pipeline_root(),
  temporary = FALSE
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>pipeline_name</code></dt><dd><p>name of the pipeline, usually in the pipeline
<code>'DESCRIPTION'</code> file, or pipeline folder name</p>
</dd>
<dt><code>settings_file</code></dt><dd><p>the file name of the settings file, where the
user inputs are stored</p>
</dd>
<dt><code>paths</code></dt><dd><p>the paths to find the pipeline, usually the parent folder
of the pipeline; default is <code>pipeline_root()</code></p>
</dd>
<dt><code>temporary</code></dt><dd><p>whether not to save <code>paths</code> to current pipeline
root registry. Set this to <code>TRUE</code> when importing pipelines
from subject pipeline folders</p>
</dd>
</dl>

</div>


<hr>
<a id="method-PipelineTools-set_settings"></a>



<h4>Method <code>set_settings()</code></h4>

<p>set inputs
</p>


<h5>Usage</h5>

<div class="r"><pre>PipelineTools$set_settings(..., .list = NULL)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>..., .list</code></dt><dd><p>named list of inputs; all inputs should be named,
otherwise errors will be raised</p>
</dd>
</dl>

</div>


<hr>
<a id="method-PipelineTools-get_settings"></a>



<h4>Method <code>get_settings()</code></h4>

<p>get current inputs
</p>


<h5>Usage</h5>

<div class="r"><pre>PipelineTools$get_settings(key, default = NULL, constraint)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>key</code></dt><dd><p>the input name; default is missing, i.e., to get all the
settings</p>
</dd>
<dt><code>default</code></dt><dd><p>default value if not found</p>
</dd>
<dt><code>constraint</code></dt><dd><p>the constraint of the results; if input value is not
from <code>constraint</code>, then only the first element of <code>constraint</code>
will be returned.</p>
</dd>
</dl>

</div>


<hr>
<a id="method-PipelineTools-read"></a>



<h4>Method <code>read()</code></h4>

<p>read intermediate variables
</p>


<h5>Usage</h5>

<div class="r"><pre>PipelineTools$read(var_names, ifnotfound = NULL, ...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>var_names</code></dt><dd><p>the target names, can be obtained via
<code>x$target_table</code> member; default is missing, i.e., to read
all the intermediate variables</p>
</dd>
<dt><code>ifnotfound</code></dt><dd><p>variable default value if not found</p>
</dd>
<dt><code>...</code></dt><dd><p>other parameters passing to <code><a href="#topic+pipeline_read">pipeline_read</a></code></p>
</dd>
</dl>

</div>


<hr>
<a id="method-PipelineTools-run"></a>



<h4>Method <code>run()</code></h4>

<p>run the pipeline
</p>


<h5>Usage</h5>

<div class="r"><pre>PipelineTools$run(
  names = NULL,
  async = FALSE,
  as_promise = async,
  scheduler = c("none", "future", "clustermq"),
  type = c("smart", "callr", "vanilla"),
  envir = new.env(parent = globalenv()),
  callr_function = NULL,
  return_values = TRUE,
  ...
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>names</code></dt><dd><p>pipeline variable names to calculate; default is to
calculate all the targets</p>
</dd>
<dt><code>async</code></dt><dd><p>whether to run asynchronous in another process</p>
</dd>
<dt><code>as_promise</code></dt><dd><p>whether to return a <code><a href="#topic+PipelineResult">PipelineResult</a></code>
instance</p>
</dd>
<dt><code>scheduler, type, envir, callr_function, return_values, ...</code></dt><dd><p>passed to
<code><a href="#topic+pipeline_run">pipeline_run</a></code> if <code>as_promise</code> is true, otherwise
these arguments will be passed to <code>pipeline_run_bare</code></p>
</dd>
</dl>

</div>


<hr>
<a id="method-PipelineTools-eval"></a>



<h4>Method <code>eval()</code></h4>

<p>run the pipeline in order; unlike <code>$run()</code>, this method
does not use the <code>targets</code> infrastructure, hence the pipeline
results will not be stored, and the order of <code>names</code> will be
respected.
</p>


<h5>Usage</h5>

<div class="r"><pre>PipelineTools$eval(
  names,
  env = parent.frame(),
  shortcut = FALSE,
  clean = TRUE,
  ...
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>names</code></dt><dd><p>pipeline variable names to calculate; must be specified</p>
</dd>
<dt><code>env</code></dt><dd><p>environment to evaluate and store the results</p>
</dd>
<dt><code>shortcut</code></dt><dd><p>logical or characters; default is <code>FALSE</code>, meaning
<code>names</code> and all the dependencies (if missing from <code>env</code>)
will be evaluated; set to <code>TRUE</code> if only <code>names</code> are to be
evaluated. When <code>shortcut</code> is a character vector, it should be
a list of targets (including their ancestors) whose values can be assumed
to be up-to-date, and the evaluation of those targets can be skipped.</p>
</dd>
<dt><code>clean</code></dt><dd><p>whether to evaluate without polluting <code>env</code></p>
</dd>
<dt><code>...</code></dt><dd><p>passed to <code><a href="#topic+pipeline_eval">pipeline_eval</a></code></p>
</dd>
</dl>

</div>


<hr>
<a id="method-PipelineTools-shared_env"></a>



<h4>Method <code>shared_env()</code></h4>

<p>run the pipeline shared library in scripts starting with
path <code>R/shared</code>
</p>


<h5>Usage</h5>

<div class="r"><pre>PipelineTools$shared_env(callr_function = callr::r)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>callr_function</code></dt><dd><p>either <code>callr::r</code> or <code>NULL</code>; when
<code>callr::r</code>, the environment will be loaded in isolated R session
and serialized back to the main session to avoid contaminating the
main session environment; when <code>NULL</code>, the code will be sourced
directly in current environment.</p>
</dd>
</dl>

</div>


<hr>
<a id="method-PipelineTools-python_module"></a>



<h4>Method <code>python_module()</code></h4>

<p>get 'Python' module embedded in the pipeline
</p>


<h5>Usage</h5>

<div class="r"><pre>PipelineTools$python_module(
  type = c("info", "module", "shared", "exist"),
  must_work = TRUE
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>type</code></dt><dd><p>return type, choices are <code>'info'</code> (get basic information
such as module path, default), <code>'module'</code> (load module and return
it), <code>'shared'</code> (load a shared sub-module from the module, which
is shared also in report script), and <code>'exist'</code> (returns true
or false on whether the module exists or not)</p>
</dd>
<dt><code>must_work</code></dt><dd><p>whether the module needs to be existed or not. If
<code>TRUE</code>, the raise errors when the module does not exist; default
is <code>TRUE</code>, ignored when <code>type</code> is <code>'exist'</code>.</p>
</dd>
</dl>

</div>


<hr>
<a id="method-PipelineTools-progress"></a>



<h4>Method <code>progress()</code></h4>

<p>get progress of the pipeline
</p>


<h5>Usage</h5>

<div class="r"><pre>PipelineTools$progress(method = c("summary", "details"))</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>method</code></dt><dd><p>either <code>'summary'</code> or <code>'details'</code></p>
</dd>
</dl>

</div>


<hr>
<a id="method-PipelineTools-attach"></a>



<h4>Method <code>attach()</code></h4>

<p>attach pipeline tool to environment (internally used)
</p>


<h5>Usage</h5>

<div class="r"><pre>PipelineTools$attach(env)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>env</code></dt><dd><p>an environment</p>
</dd>
</dl>

</div>


<hr>
<a id="method-PipelineTools-visualize"></a>



<h4>Method <code>visualize()</code></h4>

<p>visualize pipeline target dependency graph
</p>


<h5>Usage</h5>

<div class="r"><pre>PipelineTools$visualize(
  glimpse = FALSE,
  aspect_ratio = 2,
  node_size = 30,
  label_size = 40,
  ...
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>glimpse</code></dt><dd><p>whether to glimpse the graph network or render the state</p>
</dd>
<dt><code>aspect_ratio</code></dt><dd><p>controls node spacing</p>
</dd>
<dt><code>node_size, label_size</code></dt><dd><p>size of nodes and node labels</p>
</dd>
<dt><code>...</code></dt><dd><p>passed to <code><a href="#topic+pipeline_visualize">pipeline_visualize</a></code></p>
</dd>
</dl>

</div>


<hr>
<a id="method-PipelineTools-target_ancestors"></a>



<h4>Method <code>target_ancestors()</code></h4>

<p>a helper function to get target ancestors
</p>


<h5>Usage</h5>

<div class="r"><pre>PipelineTools$target_ancestors(names, skip_names = NULL)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>names</code></dt><dd><p>targets whose ancestor targets need to be queried</p>
</dd>
<dt><code>skip_names</code></dt><dd><p>targets that are assumed to be up-to-date, hence
will be excluded, notice this exclusion is
recursive, that means not only <code>skip_names</code> are excluded,
but also their ancestors will be excluded from the result.</p>
</dd>
</dl>

</div>


<hr>
<a id="method-PipelineTools-fork"></a>



<h4>Method <code>fork()</code></h4>

<p>fork (copy) the current pipeline to a new directory
</p>


<h5>Usage</h5>

<div class="r"><pre>PipelineTools$fork(path, policy = "default")</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>path</code></dt><dd><p>path to the new pipeline, a folder will be created there</p>
</dd>
<dt><code>policy</code></dt><dd><p>fork policy defined by module author, see text file
'fork-policy' under the pipeline directory; if missing, then default to
avoid copying <code>main.html</code> and <code>shared</code> folder</p>
</dd>
</dl>

</div>


<hr>
<a id="method-PipelineTools-fork_to_subject"></a>



<h4>Method <code>fork_to_subject()</code></h4>

<p>fork (copy) the current pipeline to a 'RAVE' subject
</p>


<h5>Usage</h5>

<div class="r"><pre>PipelineTools$fork_to_subject(
  subject,
  label = "NA",
  policy = "default",
  delete_old = FALSE,
  sanitize = TRUE
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>subject</code></dt><dd><p>subject ID or instance in which pipeline will be saved</p>
</dd>
<dt><code>label</code></dt><dd><p>pipeline label describing the pipeline</p>
</dd>
<dt><code>policy</code></dt><dd><p>fork policy defined by module author, see text file
'fork-policy' under the pipeline directory; if missing, then default to
avoid copying <code>main.html</code> and <code>shared</code> folder</p>
</dd>
<dt><code>delete_old</code></dt><dd><p>whether to delete old pipelines with the same label
default is false</p>
</dd>
<dt><code>sanitize</code></dt><dd><p>whether to sanitize the registry at save. This will
remove missing folders and import manually copied pipelines to the
registry (only for the pipelines with the same name)</p>
</dd>
</dl>

</div>


<hr>
<a id="method-PipelineTools-with_activated"></a>



<h4>Method <code>with_activated()</code></h4>

<p>run code with pipeline activated, some environment variables
and function behaviors might change under such condition (for example,
<code>targets</code> package functions)
</p>


<h5>Usage</h5>

<div class="r"><pre>PipelineTools$with_activated(expr, quoted = FALSE, env = parent.frame())</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>expr</code></dt><dd><p>expression to evaluate</p>
</dd>
<dt><code>quoted</code></dt><dd><p>whether <code>expr</code> is quoted; default is false</p>
</dd>
<dt><code>env</code></dt><dd><p>environment to run <code>expr</code></p>
</dd>
</dl>

</div>


<hr>
<a id="method-PipelineTools-clean"></a>



<h4>Method <code>clean()</code></h4>

<p>clean all or part of the data store
</p>


<h5>Usage</h5>

<div class="r"><pre>PipelineTools$clean(
  destroy = c("all", "cloud", "local", "meta", "process", "preferences", "progress",
    "objects", "scratch", "workspaces"),
  ask = FALSE
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>destroy, ask</code></dt><dd><p>see <code><a href="targets.html#topic+tar_destroy">tar_destroy</a></code></p>
</dd>
</dl>

</div>


<hr>
<a id="method-PipelineTools-save_data"></a>



<h4>Method <code>save_data()</code></h4>

<p>save data to pipeline data folder
</p>


<h5>Usage</h5>

<div class="r"><pre>PipelineTools$save_data(
  data,
  name,
  format = c("json", "yaml", "csv", "fst", "rds"),
  overwrite = FALSE,
  ...
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>data</code></dt><dd><p>R object</p>
</dd>
<dt><code>name</code></dt><dd><p>the name of the data to save, must start with letters</p>
</dd>
<dt><code>format</code></dt><dd><p>serialize format, choices are <code>'json'</code>,
<code>'yaml'</code>, <code>'csv'</code>, <code>'fst'</code>, <code>'rds'</code>; default is
<code>'json'</code>. To save arbitrary objects such as functions or
environments, use <code>'rds'</code></p>
</dd>
<dt><code>overwrite</code></dt><dd><p>whether to overwrite existing files; default is no</p>
</dd>
<dt><code>...</code></dt><dd><p>passed to saver functions</p>
</dd>
</dl>

</div>


<hr>
<a id="method-PipelineTools-load_data"></a>



<h4>Method <code>load_data()</code></h4>

<p>load data from pipeline data folder
</p>


<h5>Usage</h5>

<div class="r"><pre>PipelineTools$load_data(
  name,
  error_if_missing = TRUE,
  default_if_missing = NULL,
  format = c("auto", "json", "yaml", "csv", "fst", "rds"),
  ...
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>name</code></dt><dd><p>the name of the data</p>
</dd>
<dt><code>error_if_missing</code></dt><dd><p>whether to raise errors if the name is missing</p>
</dd>
<dt><code>default_if_missing</code></dt><dd><p>default values to return if the name is missing</p>
</dd>
<dt><code>format</code></dt><dd><p>the format of the data, default is automatically obtained
from the file extension</p>
</dd>
<dt><code>...</code></dt><dd><p>passed to loader functions</p>
</dd>
</dl>

</div>


<hr>
<a id="method-PipelineTools-set_preferences"></a>



<h4>Method <code>set_preferences()</code></h4>

<p>set persistent preferences from the pipeline.
The preferences should not affect how pipeline is working, hence usually
stores minor variables such as graphic options. Changing preferences
will not invalidate pipeline cache.
</p>


<h5>Usage</h5>

<div class="r"><pre>PipelineTools$set_preferences(..., .list = NULL)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>..., .list</code></dt><dd><p>key-value pairs of initial preference values. The keys
must start with 'global' or the module ID, followed by dot and preference
type and names. For example <code>'global.graphics.continuous_palette'</code>
for setting palette colors for continuous heat-map; &quot;global&quot; means the
settings should be applied to all 'RAVE' modules. The module-level
preference, <code>'power_explorer.export.default_format'</code> sets the
default format for power-explorer export dialogue.</p>
</dd>
<dt><code>name</code></dt><dd><p>preference name, must contain only letters, digits,
underscore, and hyphen, will be coerced to lower case (case-insensitive)</p>
</dd>
</dl>

</div>


<hr>
<a id="method-PipelineTools-get_preferences"></a>



<h4>Method <code>get_preferences()</code></h4>

<p>get persistent preferences from the pipeline.
</p>


<h5>Usage</h5>

<div class="r"><pre>PipelineTools$get_preferences(
  keys,
  simplify = TRUE,
  ifnotfound = NULL,
  validator = NULL,
  ...
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>keys</code></dt><dd><p>characters to get the preferences</p>
</dd>
<dt><code>simplify</code></dt><dd><p>whether to simplify the results when length of key is 1;
default is true; set to false to always return a list of preferences</p>
</dd>
<dt><code>ifnotfound</code></dt><dd><p>default value when the key is missing</p>
</dd>
<dt><code>validator</code></dt><dd><p><code>NULL</code> or function to validate the values; see
'Examples'</p>
</dd>
<dt><code>...</code></dt><dd><p>passed to <code>validator</code> if <code>validator</code> is a function</p>
</dd>
</dl>

</div>



<h5>Examples</h5>

<div class="r example copy">
<pre>
library(ravepipeline)
if(interactive() &amp;&amp; length(pipeline_list()) &gt; 0) {
  pipeline &lt;- pipeline("power_explorer")

  # set dummy preference
  pipeline$set_preferences("global.example.dummy_preference" = 1:3)

  # get preference
  pipeline$get_preferences("global.example.dummy_preference")

  # get preference with validator to ensure the value length to be 1
  pipeline$get_preferences(
    "global.example.dummy_preference",
    validator = function(value) {
      stopifnot(length(value) == 1)
    },
    ifnotfound = 100
  )

  pipeline$has_preferences("global.example.dummy_preference")
}

</pre>
</div>


<hr>
<a id="method-PipelineTools-has_preferences"></a>



<h4>Method <code>has_preferences()</code></h4>

<p>whether pipeline has preference keys
</p>


<h5>Usage</h5>

<div class="r"><pre>PipelineTools$has_preferences(keys, ...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>keys</code></dt><dd><p>characters name of the preferences</p>
</dd>
<dt><code>...</code></dt><dd><p>passed to internal methods</p>
</dd>
</dl>

</div>


<hr>
<a id="method-PipelineTools-clone"></a>



<h4>Method <code>clone()</code></h4>

<p>The objects of this class are cloneable with this method.
</p>


<h5>Usage</h5>

<div class="r"><pre>PipelineTools$clone(deep = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>deep</code></dt><dd><p>Whether to make a deep clone.</p>
</dd>
</dl>

</div>




<h3>See Also</h3>

<p><code><a href="#topic+pipeline">pipeline</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## ------------------------------------------------
## Method `PipelineTools$get_preferences`
## ------------------------------------------------


library(ravepipeline)
if(interactive() &amp;&amp; length(pipeline_list()) &gt; 0) {
  pipeline &lt;- pipeline("power_explorer")

  # set dummy preference
  pipeline$set_preferences("global.example.dummy_preference" = 1:3)

  # get preference
  pipeline$get_preferences("global.example.dummy_preference")

  # get preference with validator to ensure the value length to be 1
  pipeline$get_preferences(
    "global.example.dummy_preference",
    validator = function(value) {
      stopifnot(length(value) == 1)
    },
    ifnotfound = 100
  )

  pipeline$has_preferences("global.example.dummy_preference")
}

</code></pre>

<hr>
<h2 id='rave-pipeline'>Low-level 'RAVE' pipeline functions</h2><span id='topic+rave-pipeline'></span><span id='topic+pipeline_root'></span><span id='topic+pipeline_list'></span><span id='topic+pipeline_find'></span><span id='topic+pipeline_attach'></span><span id='topic+pipeline_run'></span><span id='topic+pipeline_clean'></span><span id='topic+pipeline_run_bare'></span><span id='topic+load_targets'></span><span id='topic+pipeline_target_names'></span><span id='topic+pipeline_debug'></span><span id='topic+pipeline_dep_targets'></span><span id='topic+pipeline_eval'></span><span id='topic+pipeline_visualize'></span><span id='topic+pipeline_progress'></span><span id='topic+pipeline_fork'></span><span id='topic+pipeline_build'></span><span id='topic+pipeline_read'></span><span id='topic+pipeline_vartable'></span><span id='topic+pipeline_hasname'></span><span id='topic+pipeline_watch'></span><span id='topic+pipeline_create_template'></span><span id='topic+pipeline_create_subject_pipeline'></span><span id='topic+pipeline_description'></span><span id='topic+pipeline_load_extdata'></span><span id='topic+pipeline_save_extdata'></span><span id='topic+pipeline_shared'></span><span id='topic+pipeline_set_preferences'></span><span id='topic+pipeline_get_preferences'></span><span id='topic+pipeline_has_preferences'></span>

<h3>Description</h3>

<p>Utility functions for 'RAVE' pipelines, currently designed for
internal development use. The infrastructure will be deployed to 'RAVE' in
the future to facilitate the &quot;self-expanding&quot; aim. Please check the official
'RAVE' website.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pipeline_root(root_path, temporary = FALSE)

pipeline_list(root_path = pipeline_root())

pipeline_find(name, root_path = pipeline_root())

pipeline_attach(name, root_path = pipeline_root())

pipeline_run(
  pipe_dir = Sys.getenv("RAVE_PIPELINE", "."),
  scheduler = c("none", "future", "clustermq"),
  type = c("smart", "callr", "vanilla"),
  envir = new.env(parent = globalenv()),
  callr_function = NULL,
  names = NULL,
  async = FALSE,
  check_interval = 0.5,
  progress_quiet = !async,
  progress_max = NA,
  progress_title = "Running pipeline",
  return_values = TRUE,
  ...
)

pipeline_clean(
  pipe_dir = Sys.getenv("RAVE_PIPELINE", "."),
  destroy = c("all", "cloud", "local", "meta", "process", "preferences", "progress",
    "objects", "scratch", "workspaces"),
  ask = FALSE
)

pipeline_run_bare(
  pipe_dir = Sys.getenv("RAVE_PIPELINE", "."),
  scheduler = c("none", "future", "clustermq"),
  type = c("smart", "callr", "vanilla"),
  envir = new.env(parent = globalenv()),
  callr_function = NULL,
  names = NULL,
  return_values = TRUE,
  ...
)

load_targets(..., env = NULL)

pipeline_target_names(pipe_dir = Sys.getenv("RAVE_PIPELINE", "."))

pipeline_debug(
  quick = TRUE,
  env = parent.frame(),
  pipe_dir = Sys.getenv("RAVE_PIPELINE", "."),
  skip_names
)

pipeline_dep_targets(
  names,
  skip_names = NULL,
  pipe_dir = Sys.getenv("RAVE_PIPELINE", ".")
)

pipeline_eval(
  names,
  env = new.env(parent = parent.frame()),
  pipe_dir = Sys.getenv("RAVE_PIPELINE", "."),
  settings_path = file.path(pipe_dir, "settings.yaml"),
  shortcut = FALSE
)

pipeline_visualize(
  pipe_dir = Sys.getenv("RAVE_PIPELINE", "."),
  glimpse = FALSE,
  targets_only = TRUE,
  shortcut = FALSE,
  zoom_speed = 0.1,
  ...
)

pipeline_progress(
  pipe_dir = Sys.getenv("RAVE_PIPELINE", "."),
  method = c("summary", "details", "custom"),
  func = targets::tar_progress_summary
)

pipeline_fork(
  src = Sys.getenv("RAVE_PIPELINE", "."),
  dest = tempfile(pattern = "rave_pipeline_"),
  policy = "default",
  activate = FALSE,
  ...
)

pipeline_build(pipe_dir = Sys.getenv("RAVE_PIPELINE", "."))

pipeline_read(
  var_names,
  pipe_dir = Sys.getenv("RAVE_PIPELINE", "."),
  branches = NULL,
  ifnotfound = NULL,
  dependencies = c("none", "ancestors_only", "all"),
  simplify = TRUE,
  ...
)

pipeline_vartable(
  pipe_dir = Sys.getenv("RAVE_PIPELINE", "."),
  targets_only = TRUE,
  complete_only = FALSE,
  ...
)

pipeline_hasname(var_names, pipe_dir = Sys.getenv("RAVE_PIPELINE", "."))

pipeline_watch(
  pipe_dir = Sys.getenv("RAVE_PIPELINE", "."),
  targets_only = TRUE,
  ...
)

pipeline_create_template(
  root_path,
  pipeline_name,
  overwrite = FALSE,
  activate = TRUE,
  template_type = c("rmd", "r", "rmd-bare", "rmd-scheduler", "rmd-python")
)

pipeline_create_subject_pipeline(
  subject,
  pipeline_name,
  overwrite = FALSE,
  activate = TRUE,
  template_type = c("rmd", "r", "rmd-python")
)

pipeline_description(file)

pipeline_load_extdata(
  name,
  format = c("auto", "json", "yaml", "csv", "fst", "rds"),
  error_if_missing = TRUE,
  default_if_missing = NULL,
  pipe_dir = Sys.getenv("RAVE_PIPELINE", "."),
  ...
)

pipeline_save_extdata(
  data,
  name,
  format = c("json", "yaml", "csv", "fst", "rds"),
  overwrite = FALSE,
  pipe_dir = Sys.getenv("RAVE_PIPELINE", "."),
  ...
)

pipeline_shared(
  pipe_dir = Sys.getenv("RAVE_PIPELINE", "."),
  callr_function = callr::r
)

pipeline_set_preferences(
  ...,
  .list = NULL,
  .pipe_dir = Sys.getenv("RAVE_PIPELINE", "."),
  .preference_instance = NULL
)

pipeline_get_preferences(
  keys,
  simplify = TRUE,
  ifnotfound = NULL,
  validator = NULL,
  ...,
  .preference_instance = NULL
)

pipeline_has_preferences(keys, ..., .preference_instance = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rave-pipeline_+3A_root_path">root_path</code></td>
<td>
<p>the root directory for pipeline templates</p>
</td></tr>
<tr><td><code id="rave-pipeline_+3A_temporary">temporary</code></td>
<td>
<p>whether not to save <code>paths</code> to current pipeline
root registry. Set this to <code>TRUE</code> when importing pipelines
from subject pipeline folders</p>
</td></tr>
<tr><td><code id="rave-pipeline_+3A_name">name</code>, <code id="rave-pipeline_+3A_pipeline_name">pipeline_name</code></td>
<td>
<p>the pipeline name to create; usually also the folder</p>
</td></tr>
<tr><td><code id="rave-pipeline_+3A_pipe_dir">pipe_dir</code>, <code id="rave-pipeline_+3A_.pipe_dir">.pipe_dir</code></td>
<td>
<p>where the pipeline directory is; can be set via
system environment <code>Sys.setenv("RAVE_PIPELINE"=...)</code></p>
</td></tr>
<tr><td><code id="rave-pipeline_+3A_scheduler">scheduler</code></td>
<td>
<p>how to schedule the target jobs: default is <code>'none'</code>,
which is sequential. If you have multiple heavy-weighted jobs that can be
scheduled at the same time, you can choose <code>'future'</code> or
<code>'clustermq'</code></p>
</td></tr>
<tr><td><code id="rave-pipeline_+3A_type">type</code></td>
<td>
<p>how the pipeline should be executed; current choices are
<code>"smart"</code> to enable 'future' package if possible, <code>'callr'</code>
to use <code><a href="callr.html#topic+r">r</a></code>, or <code>'vanilla'</code> to run everything
sequentially in the main session.</p>
</td></tr>
<tr><td><code id="rave-pipeline_+3A_callr_function">callr_function</code></td>
<td>
<p>function that will be passed to
<code><a href="targets.html#topic+tar_make">tar_make</a></code>; will be forced to be <code>NULL</code> if
<code>type='vanilla'</code>, or <code><a href="callr.html#topic+r">r</a></code> if
<code>type='callr'</code></p>
</td></tr>
<tr><td><code id="rave-pipeline_+3A_names">names</code></td>
<td>
<p>the names of pipeline targets that are to be executed; default
is <code>NULL</code>, which runs all targets; use <code>pipeline_target_names</code>
to check all your available target names.</p>
</td></tr>
<tr><td><code id="rave-pipeline_+3A_async">async</code></td>
<td>
<p>whether to run pipeline without blocking the main session</p>
</td></tr>
<tr><td><code id="rave-pipeline_+3A_check_interval">check_interval</code></td>
<td>
<p>when running in background (non-blocking mode),
how often to check the pipeline</p>
</td></tr>
<tr><td><code id="rave-pipeline_+3A_progress_title">progress_title</code>, <code id="rave-pipeline_+3A_progress_max">progress_max</code>, <code id="rave-pipeline_+3A_progress_quiet">progress_quiet</code></td>
<td>
<p>control the progress</p>
</td></tr>
<tr><td><code id="rave-pipeline_+3A_return_values">return_values</code></td>
<td>
<p>whether to return pipeline target values; default is
true; only works in <code>pipeline_run_bare</code> and will be ignored by
<code>pipeline_run</code></p>
</td></tr>
<tr><td><code id="rave-pipeline_+3A_...">...</code>, <code id="rave-pipeline_+3A_.list">.list</code></td>
<td>
<p>other parameters, targets, etc.</p>
</td></tr>
<tr><td><code id="rave-pipeline_+3A_destroy">destroy</code></td>
<td>
<p>what part of data repository needs to be cleaned</p>
</td></tr>
<tr><td><code id="rave-pipeline_+3A_ask">ask</code></td>
<td>
<p>whether to ask</p>
</td></tr>
<tr><td><code id="rave-pipeline_+3A_env">env</code>, <code id="rave-pipeline_+3A_envir">envir</code></td>
<td>
<p>environment to execute the pipeline</p>
</td></tr>
<tr><td><code id="rave-pipeline_+3A_quick">quick</code></td>
<td>
<p>whether to skip finished targets to save time</p>
</td></tr>
<tr><td><code id="rave-pipeline_+3A_skip_names">skip_names</code></td>
<td>
<p>hint of target names to fast skip provided they are
up-to-date; only used when <code>quick=TRUE</code>. If missing, then
<code>skip_names</code> will be automatically determined</p>
</td></tr>
<tr><td><code id="rave-pipeline_+3A_settings_path">settings_path</code></td>
<td>
<p>path to settings file
name within subject's pipeline path</p>
</td></tr>
<tr><td><code id="rave-pipeline_+3A_shortcut">shortcut</code></td>
<td>
<p>whether to display shortcut targets</p>
</td></tr>
<tr><td><code id="rave-pipeline_+3A_glimpse">glimpse</code></td>
<td>
<p>whether to hide network status when visualizing the pipelines</p>
</td></tr>
<tr><td><code id="rave-pipeline_+3A_targets_only">targets_only</code></td>
<td>
<p>whether to return the variable table for targets only;
default is true</p>
</td></tr>
<tr><td><code id="rave-pipeline_+3A_zoom_speed">zoom_speed</code></td>
<td>
<p>zoom speed when visualizing the pipeline dependence</p>
</td></tr>
<tr><td><code id="rave-pipeline_+3A_method">method</code></td>
<td>
<p>how the progress should be presented; choices are
<code>"summary"</code>, <code>"details"</code>, <code>"custom"</code>. If custom method is
chosen, then <code>func</code> will be called</p>
</td></tr>
<tr><td><code id="rave-pipeline_+3A_func">func</code></td>
<td>
<p>function to call when reading customized pipeline progress;
default is <code><a href="targets.html#topic+tar_progress_summary">tar_progress_summary</a></code></p>
</td></tr>
<tr><td><code id="rave-pipeline_+3A_src">src</code>, <code id="rave-pipeline_+3A_dest">dest</code></td>
<td>
<p>pipeline folder to copy the pipeline script from and to</p>
</td></tr>
<tr><td><code id="rave-pipeline_+3A_policy">policy</code></td>
<td>
<p>fork policy defined by module author, see text file
'fork-policy' under the pipeline directory; if missing, then default to
avoid copying <code>main.html</code> and <code>shared</code> folder</p>
</td></tr>
<tr><td><code id="rave-pipeline_+3A_activate">activate</code></td>
<td>
<p>whether to activate the new pipeline folder from <code>dest</code>;
default is false</p>
</td></tr>
<tr><td><code id="rave-pipeline_+3A_var_names">var_names</code></td>
<td>
<p>variable name to fetch or to check</p>
</td></tr>
<tr><td><code id="rave-pipeline_+3A_branches">branches</code></td>
<td>
<p>branch to read from; see <code><a href="targets.html#topic+tar_read">tar_read</a></code></p>
</td></tr>
<tr><td><code id="rave-pipeline_+3A_ifnotfound">ifnotfound</code></td>
<td>
<p>default values to return if variable is not found</p>
</td></tr>
<tr><td><code id="rave-pipeline_+3A_dependencies">dependencies</code></td>
<td>
<p>whether to load dependent targets, choices are
<code>'none'</code> (default, only load targets specified by <code>names</code>),
<code>'ancestors_only'</code> (load all but the ancestors targets), and
<code>'all'</code> (both targets and ancestors)</p>
</td></tr>
<tr><td><code id="rave-pipeline_+3A_simplify">simplify</code></td>
<td>
<p>whether to simplify the output</p>
</td></tr>
<tr><td><code id="rave-pipeline_+3A_complete_only">complete_only</code></td>
<td>
<p>whether only to show completed and up-to-date target
variables; default is false</p>
</td></tr>
<tr><td><code id="rave-pipeline_+3A_overwrite">overwrite</code></td>
<td>
<p>whether to overwrite existing pipeline; default is false
so users can double-check; if true, then existing pipeline, including the
data will be erased</p>
</td></tr>
<tr><td><code id="rave-pipeline_+3A_template_type">template_type</code></td>
<td>
<p>which template type to create; choices are <code>'r'</code>
or <code>'rmd'</code></p>
</td></tr>
<tr><td><code id="rave-pipeline_+3A_subject">subject</code></td>
<td>
<p>character indicating valid 'RAVE' subject ID, or a
<code>RAVESubject</code> instance</p>
</td></tr>
<tr><td><code id="rave-pipeline_+3A_file">file</code></td>
<td>
<p>path to the 'DESCRIPTION' file under the pipeline folder, or
pipeline collection folder that contains the pipeline information,
structures, dependencies, etc.</p>
</td></tr>
<tr><td><code id="rave-pipeline_+3A_format">format</code></td>
<td>
<p>format of the extended data, default is <code>'json'</code>, other
choices are <code>'yaml'</code>, <code>'fst'</code>, <code>'csv'</code>, <code>'rds'</code></p>
</td></tr>
<tr><td><code id="rave-pipeline_+3A_error_if_missing">error_if_missing</code>, <code id="rave-pipeline_+3A_default_if_missing">default_if_missing</code></td>
<td>
<p>what to do if the extended data
is not found</p>
</td></tr>
<tr><td><code id="rave-pipeline_+3A_data">data</code></td>
<td>
<p>extended data to be saved</p>
</td></tr>
<tr><td><code id="rave-pipeline_+3A_.preference_instance">.preference_instance</code></td>
<td>
<p>internally used</p>
</td></tr>
<tr><td><code id="rave-pipeline_+3A_keys">keys</code></td>
<td>
<p>preference keys</p>
</td></tr>
<tr><td><code id="rave-pipeline_+3A_validator">validator</code></td>
<td>
<p><code>NULL</code> or function to validate values</p>
</td></tr>
</table>


<h3>Value</h3>


<dl>
<dt><code>pipeline_root</code></dt><dd><p>the root directories of the pipelines</p>
</dd>
<dt><code>pipeline_list</code></dt><dd><p>the available pipeline names under <code>pipeline_root</code></p>
</dd>
<dt><code>pipeline_find</code></dt><dd><p>the path to the pipeline</p>
</dd>
<dt><code>pipeline_run</code></dt><dd><p>a <code><a href="#topic+PipelineResult">PipelineResult</a></code> instance</p>
</dd>
<dt><code>load_targets</code></dt><dd><p>a list of targets to build</p>
</dd>
<dt><code>pipeline_target_names</code></dt><dd><p>a vector of characters indicating the pipeline target names</p>
</dd>
<dt><code>pipeline_visualize</code></dt><dd><p>a widget visualizing the target dependence structure</p>
</dd>
<dt><code>pipeline_progress</code></dt><dd><p>a table of building progress</p>
</dd>
<dt><code>pipeline_fork</code></dt><dd><p>a normalized path of the forked pipeline directory</p>
</dd>
<dt><code>pipeline_read</code></dt><dd><p>the value of corresponding <code>var_names</code>, or a named list if <code>var_names</code> has more than one element</p>
</dd>
<dt><code>pipeline_vartable</code></dt><dd><p>a table of summaries of the variables; can raise errors if pipeline has never been executed</p>
</dd>
<dt><code>pipeline_hasname</code></dt><dd><p>logical, whether the pipeline has variable built</p>
</dd>
<dt><code>pipeline_watch</code></dt><dd><p>a basic shiny application to monitor the progress</p>
</dd>
<dt><code>pipeline_description</code></dt><dd><p>the list of descriptions of the pipeline or pipeline collection</p>
</dd>
</dl>


<hr>
<h2 id='rave-snippet'>'RAVE' code snippets</h2><span id='topic+rave-snippet'></span><span id='topic+update_local_snippet'></span><span id='topic+install_snippet'></span><span id='topic+list_snippets'></span><span id='topic+load_snippet'></span>

<h3>Description</h3>

<p>Run snippet code
</p>


<h3>Usage</h3>

<pre><code class='language-R'>update_local_snippet(force = TRUE)

install_snippet(path)

list_snippets()

load_snippet(topic, local = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rave-snippet_+3A_force">force</code></td>
<td>
<p>whether to force updating the snippets; default is true</p>
</td></tr>
<tr><td><code id="rave-snippet_+3A_path">path</code></td>
<td>
<p>for installing code snippets locally only; can be an R script,
a zip file, or a directory</p>
</td></tr>
<tr><td><code id="rave-snippet_+3A_topic">topic</code></td>
<td>
<p>snippet topic</p>
</td></tr>
<tr><td><code id="rave-snippet_+3A_local">local</code></td>
<td>
<p>whether to use local snippets first before requesting online
repository</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>load_snippet</code> returns snippet as a function, others return nothing
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# This example script requires running in an interactive session

if(interactive()){

# ---- Example 1: Install built-in pipeline snippets ------------
update_local_snippet(force = TRUE)

# ---- Example 2: Install customized pipeline snippets ----------
snippets &lt;- file.path(
  "https://github.com/rave-ieeg/rave-gists",
  "archive/refs/heads/main.zip",
  fsep = "/"
)
tempf &lt;- tempfile(fileext = ".zip")
utils::download.file(url = snippets, destfile = tempf)

install_snippet(tempf)

}

# ---- List snippets --------------------------------------------

# list all topics
list_snippets()


# ---- Run snippets as functions --------------------------------

topic &lt;- "image-burn-contacts-to-t1"

# check whether this example can run
# This snippet requires installing package `raveio`
# which is currently not on CRAN (soon it will)

condition_met &lt;- topic %in% list_snippets() &amp;&amp;
  (system.file(package = "raveio") != "")

if( interactive() &amp;&amp; condition_met ) {

  snippet &lt;- load_snippet(topic)

  # Read snippet documentation
  print(snippet)


  results &lt;- snippet(
    subject_code = "DemoSubject",
    project_name = "demo",
    save_path = NA,
    blank_underlay = FALSE
  )

  plot(results)
}

</code></pre>

<hr>
<h2 id='raveio-option'>Set/Get 'RAVE' option</h2><span id='topic+raveio-option'></span><span id='topic+raveio_setopt'></span><span id='topic+raveio_resetopt'></span><span id='topic+raveio_getopt'></span><span id='topic+raveio_confpath'></span>

<h3>Description</h3>

<p>Persist settings on local configuration file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>raveio_setopt(key, value, .save = TRUE)

raveio_resetopt(all = FALSE)

raveio_getopt(key, default = NA, temp = TRUE)

raveio_confpath(cfile = "settings.yaml")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="raveio-option_+3A_key">key</code></td>
<td>
<p>character, option name</p>
</td></tr>
<tr><td><code id="raveio-option_+3A_value">value</code></td>
<td>
<p>character or logical of length 1, option value</p>
</td></tr>
<tr><td><code id="raveio-option_+3A_.save">.save</code></td>
<td>
<p>whether to save to local drive, internally used to temporary
change option. Not recommended to use it directly.</p>
</td></tr>
<tr><td><code id="raveio-option_+3A_all">all</code></td>
<td>
<p>whether to reset all non-default keys</p>
</td></tr>
<tr><td><code id="raveio-option_+3A_default">default</code></td>
<td>
<p>is key not found, return default value</p>
</td></tr>
<tr><td><code id="raveio-option_+3A_temp">temp</code></td>
<td>
<p>when saving, whether the key-value pair should be considered
temporary, a temporary settings will be ignored when saving; when getting
options, setting <code>temp</code> to false will reveal the actual settings.</p>
</td></tr>
<tr><td><code id="raveio-option_+3A_cfile">cfile</code></td>
<td>
<p>file name in configuration path</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>raveio_setopt</code> stores key-value pair in local path.
The values are persistent and shared across multiple sessions.
There are some read-only keys such as <code>"session_string"</code>. Trying to
set those keys will result in error.
</p>
<p>The following keys are reserved by 'RAVE':
</p>

<dl>
<dt><code>data_dir</code></dt><dd><p>Directory path, where processed data are stored;
default is at home directory, folder <code>~/rave_data/data_dir</code></p>
</dd>
<dt><code>raw_data_dir</code></dt><dd><p>Directory path, where raw data files are stored,
mainly the original signal files and imaging files;
default is at home directory, folder <code>~/rave_data/raw_dir</code></p>
</dd>
<dt><code>max_worker</code></dt><dd><p>Maximum number of CPU cores to use; default
is one less than the total number of CPU cores</p>
</dd>
<dt><code>mni_template_root</code></dt><dd><p>Directory path, where 'MNI' templates
are stored</p>
</dd>
</dl>

<p><code>raveio_getopt</code> returns value corresponding to the keys. If key is
missing, the whole option will be returned.
</p>
<p>If set <code>all=TRUE</code>, <code>raveio_resetopt</code> resets all keys including
non-standard ones. However <code>"session_string"</code> will never reset.
</p>


<h3>Value</h3>

<p><code>raveio_setopt</code> returns modified <code>value</code>;
<code>raveio_resetopt</code> returns current settings as a list;
<code>raveio_confpath</code> returns absolute path for the settings file;
<code>raveio_getopt</code> returns the settings value to the given key, or
<code>default</code> if not found.
</p>


<h3>Side-Effects</h3>

<p>The following options will alter other packages and might cause changes in
behaviors:
</p>

<dl>
<dt><code>'disable_fork_clusters'</code></dt><dd><p>This option will change the
<code><a href="base.html#topic+options">options</a></code> <code>'dipsaus.no.fork'</code> and
<code>'dipsaus.cluster.backup'</code>, which handles the parallel computing</p>
</dd>
<dt><code>'threeBrain_template_subject'</code></dt><dd><p>This option will set and persist
option <code>'threeBrain.template_subject'</code>, which changes the default
group-level template brain.</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code>R_user_dir</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# get one RAVE option
ncore &lt;- raveio_getopt("max_worker")
print(ncore)

# get all options
raveio_getopt()

# set option
raveio_setopt("disable_fork_clusters", FALSE)

</code></pre>

<hr>
<h2 id='ravepipeline_finalize_installation'>Download 'RAVE' built-in pipelines and code snippets</h2><span id='topic+ravepipeline_finalize_installation'></span>

<h3>Description</h3>

<p>The official built-in pipeline repository is located at
<a href="https://github.com/rave-ieeg/rave-pipelines">https://github.com/rave-ieeg/rave-pipelines</a>;
The code snippet repository is located at
<a href="https://github.com/rave-ieeg/rave-gists">https://github.com/rave-ieeg/rave-gists</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ravepipeline_finalize_installation(
  upgrade = c("ask", "always", "never", "config-only", "data-only"),
  async = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ravepipeline_finalize_installation_+3A_upgrade">upgrade</code></td>
<td>
<p>rules to upgrade dependencies; default is to ask if needed</p>
</td></tr>
<tr><td><code id="ravepipeline_finalize_installation_+3A_async">async</code></td>
<td>
<p>whether to run in the background; ignore for now</p>
</td></tr>
<tr><td><code id="ravepipeline_finalize_installation_+3A_...">...</code></td>
<td>
<p>ignored; reserved for external calls.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list built-in pipelines will be installed, the function itself
returns nothing.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 

# This function requires connection to the Github, and must run
# under interactive session since an user prompt will be displayed

ravepipeline_finalize_installation()


## End(Not run)

</code></pre>

<hr>
<h2 id='ravepipeline-constants'>Constant variables used in 'RAVE' pipeline</h2><span id='topic+ravepipeline-constants'></span><span id='topic+PIPELINE_FORK_PATTERN'></span>

<h3>Description</h3>

<p>Regular expression <code>PIPELINE_FORK_PATTERN</code> defines the file matching
rules when forking a pipeline; see <code><a href="#topic+pipeline_fork">pipeline_fork</a></code> for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PIPELINE_FORK_PATTERN
</code></pre>


<h3>Format</h3>

<p>An object of class <code>character</code> of length 1.
</p>

<hr>
<h2 id='reexports'>Objects exported from other packages</h2><span id='topic+reexports'></span><span id='topic+glue'></span><span id='topic++25...+3E+25'></span><span id='topic++25...T+3E+25'></span><span id='topic++25...+21+25'></span><span id='topic++25...T+21+25'></span>

<h3>Description</h3>

<p>These objects are imported from other packages. Follow the links
below to see their documentation.
</p>

<dl>
<dt>glue</dt><dd><p><code><a href="glue.html#topic+glue">glue</a></code></p>
</dd>
<dt>promises</dt><dd><p><code><a href="promises.html#topic+pipes">%...!%</a></code>, <code><a href="promises.html#topic+pipes">%...&gt;%</a></code>, <code><a href="promises.html#topic+pipes">%...T!%</a></code>, <code><a href="promises.html#topic+pipes">%...T&gt;%</a></code></p>
</dd>
</dl>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
