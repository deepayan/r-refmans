<!DOCTYPE html><html lang="en"><head><title>Help for package AFM</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {AFM}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#addNode'><p>addNode</p></a></li>
<li><a href='#AFM'><p>Atomic Force Microscopy images tools</p></a></li>
<li><a href='#AFMImage-class'><p>AFM image class</p></a></li>
<li><a href='#AFMImage3DModelAnalysis-class'><p>AFM image Power Spectrum Density analysis class</p></a></li>
<li><a href='#AFMImageAnalyser-class'><p>AFM image analyser class</p></a></li>
<li><a href='#AFMImageCollagenNetwork'><p>AFM image sample</p></a></li>
<li><a href='#AFMImageFractalDimensionMethod-class'><p>AFM image fractal dimension method class</p></a></li>
<li><a href='#AFMImageFractalDimensionsAnalysis-class'><p>AFM image fractal dimensions analysis class</p></a></li>
<li><a href='#AFMImageGaussianMixAnalysis-class'><p>AFM image Gaussian Mix analysis class</p></a></li>
<li><a href='#AFMImageNetworksAnalysis-class'><p>AFM image networks analysis class</p></a></li>
<li><a href='#AFMImageOfAluminiumInterface'><p>AFM image sample</p></a></li>
<li><a href='#AFMImageOfNormallyDistributedHeights'><p>AFM image sample</p></a></li>
<li><a href='#AFMImageOfOnePeak'><p>AFM image sample</p></a></li>
<li><a href='#AFMImageOfRegularPeaks'><p>AFM image sample</p></a></li>
<li><a href='#AFMImagePSDAnalysis-class'><p>AFM image Power Spectrum Density analysis class</p></a></li>
<li><a href='#AFMImagePSDSlopesAnalysis-class'><p>AFM Image psd slope analysis</p></a></li>
<li><a href='#AFMImageVariogramAnalysis-class'><p>AFM image variogram analysis class</p></a></li>
<li><a href='#AFMImageVariogramModel-class'><p>AFM Image Variogram Model class</p></a></li>
<li><a href='#analyse'><p>Analyse an AFMImage</p></a></li>
<li><a href='#AreNodesConnected'><p>check if nodes represented by circles are connected. The function defines all the possible segments between the circles and check if at least one segment exists.</p></a></li>
<li><a href='#calculate3DModel'><p>Calculate the 3D model for 3D printing</p></a></li>
<li><a href='#calculateDirectionalVariograms'><p>Calculate experimental directional semi-variograms</p></a></li>
<li><a href='#calculateGaussianMixture'><p>Calculate Gaussian Mixture with two components from the AFM Image.</p></a></li>
<li><a href='#calculateHolesCharacteristics'><p>get the networks parameters</p></a></li>
<li><a href='#calculateIgraph'><p>Calculate iGraph from AFMImage</p></a></li>
<li><a href='#calculateNetworkParameters'><p>get the networks parameters</p></a></li>
<li><a href='#calculateNetworks'><p>Calculate networks on the surface</p></a></li>
<li><a href='#calculateNetworkSkeleton'><p>calculateNetworkSkeleton</p></a></li>
<li><a href='#calculateOmnidirectionalVariogram'><p>Calculate experimental omnidirectional semi-variogram</p></a></li>
<li><a href='#calculatePhysicalDistanceFromPath'><p>calculate the physical distances between nodes</p></a></li>
<li><a href='#calculateShortestPaths'><p>calculate the  shortest path between adjacent nodes</p></a></li>
<li><a href='#canBeRemoved'><p>canBeRemoved</p></a></li>
<li><a href='#checkIsotropy'><p>Check the isotropy of a sample</p></a></li>
<li><a href='#checkNormality'><p>Check visualy of the normality of the sample</p></a></li>
<li><a href='#createGraph'><p>create the igraph weighted graph from the nodes and edges</p></a></li>
<li><a href='#displayColoredNetworkWithVerticesSize'><p>displayColoredNetworkWithVerticesSize</p></a></li>
<li><a href='#displaygridIgraphPlot'><p>display the network of nodes and edges</p></a></li>
<li><a href='#displaygridIgraphPlotFromEdges'><p>display the network of nodes and edges</p></a></li>
<li><a href='#displayHolesIn3D'><p>Display a 3D image of the holes in an AFMImage and store it on disk.</p></a></li>
<li><a href='#displayIn3D'><p>Display a 3D image of an AFMImage and store it on disk.</p></a></li>
<li><a href='#dnormalmix'><p>dnormalmix density of a mixture of normals</p></a></li>
<li><a href='#evaluateVariogramModels'><p>evaluateVariogramModels method to evaluate the basic variogram models</p></a></li>
<li><a href='#existsEdge'><p>Does an edge exist ?</p></a></li>
<li><a href='#existsSegment'><p>existsSegment checks if a segment exists in an AFMImage; check if all the heights at the segment coordinates are different to zero.</p></a></li>
<li><a href='#exportToSTL'><p>Export an AFM Image as a STL format file.</p></a></li>
<li><a href='#extractAFMImage'><p>Extract a portion of an AFM image.</p></a></li>
<li><a href='#filterAFMImage'><p>filter the heights of an AFMImage with a minimun and a maximum value</p></a></li>
<li><a href='#fusionCloseNodes'><p>fusion the nodes that are intersecting</p></a></li>
<li><a href='#generateAFMImageReport'><p>Generate an analysis report from an AFMImageAnalyser object</p></a></li>
<li><a href='#generateCheckReport'><p>Generate a check report for one AFMImage</p></a></li>
<li><a href='#generatePolygonEnvelope'><p>generatePolygonEnvelope</p></a></li>
<li><a href='#generateReport'><p>Generate an analysis report for one AFMImage</p></a></li>
<li><a href='#generateReportFromNanoscopeImageDirectory'><p>Generate a pdf report for all AFM images in a directory</p></a></li>
<li><a href='#get3DImageFullfilename'><p>get 3D image full filename</p></a></li>
<li><a href='#getAllPointsToRemove'><p>getAllPointsToRemove</p></a></li>
<li><a href='#getAngle'><p>calculate the angle between two vectors</p></a></li>
<li><a href='#getAutoIntersectionForOmnidirectionalVariogram'><p>Calculate slopes and intersections in variogram</p>
<code>getAutoIntersectionForOmnidirectionalVariogram</code> returns the slope in the omnidirectional variograms</a></li>
<li><a href='#getAutoIntersectionForRoughnessAgainstLengthscale'><p>get the intersection between tangente and plateau</p></a></li>
<li><a href='#getAutomaticWidthForVariogramCalculation'><p>calculate a width to be used for experimental variogram calculation</p></a></li>
<li><a href='#getBresenham2DSegment'><p>get a segment of points thanks to Bresenham line algorithm</p></a></li>
<li><a href='#getCircleSpatialPoints'><p>get the spatial points on the circle including the center of the circle</p></a></li>
<li><a href='#getCoordinatesFromVertexId'><p>Get x,y coordinates from vertex id</p></a></li>
<li><a href='#getDTModelEvaluation'><p>getDTModelEvaluation method</p></a></li>
<li><a href='#getDTModelSillRange'><p>getDTModelSillRange method</p></a></li>
<li><a href='#getFractalDimensions'><p>Calculate 2D fractal dimensions and scales of an AFM Image</p></a></li>
<li><a href='#getHolesStatistics'><p>calculate statistics about holes in a binary image</p></a></li>
<li><a href='#getIntersectionForRoughnessAgainstLengthscale'><p>get the intersection between tangente and plateau</p></a></li>
<li><a href='#getIntersectionPointWithBorder'><p>getIntersectionPointWithBorder to be described</p></a></li>
<li><a href='#getListOfDiameters'><p>getListOfDiameters</p></a></li>
<li><a href='#getLogLogOmnidirectionalSlopeGraph'><p>Get the graph of the Log Log omnidiretction variogram</p>
<code>getLogLogOmnidirectionalSlopeGraph</code> returns Get the graph of the Log Log omnidirectional variogram</a></li>
<li><a href='#getMaxCircleMatrix'><p>getMaxCircleMatrix</p></a></li>
<li><a href='#getNetworkGridLayout'><p>#' @export</p>
getCoordinatesFromVertexId2&lt;-function(AFMImage, vId)
vertexId&lt;-as.numeric(vId)
y&lt;-floor(vertexId/HASHSIZE)
x&lt;-vertexId-y*HASHSIZE
return(data.table(vId=vId, coords.x1=x,coords.x2=y))

Get getNetworkGridLayout</a></li>
<li><a href='#getNetworkParameters'><p>Get Network parameters</p></a></li>
<li><a href='#getNyquistSpatialFrequency'><p>Get the Nyquist spatial frequency</p></a></li>
<li><a href='#getPaddedAFMImage'><p>Get a zero padded AFMImage</p></a></li>
<li><a href='#getRoughnessParameters'><p>Get Roughness parameters</p></a></li>
<li><a href='#getSpplotFromAFMImage'><p>Get an AFMImage as a Lattice (trellis) plot</p></a></li>
<li><a href='#getSurroundingVertexesList'><p>Get surrounding vertices from x,y coordinates</p></a></li>
<li><a href='#getTopologyAFMImage'><p>Calculate topology image (TBC)</p></a></li>
<li><a href='#getTriangle'><p>get a triangle starting from center, two segments of length r with angles deg1 and deg2</p></a></li>
<li><a href='#getVertexId'><p>Get vertex id from x,y coordinates</p></a></li>
<li><a href='#gridIgraphPlot'><p>gridIgraphPlot</p></a></li>
<li><a href='#identifyEdgesFromCircles'><p>display the network of nodes and edges</p></a></li>
<li><a href='#identifyIsolatedNodes'><p>identify isolated nodes comparing the list of edges and the list of nodes</p></a></li>
<li><a href='#identifyMaxCircleRadius'><p>identifyMaxCircleRadius</p></a></li>
<li><a href='#identifyNodesAndEdges'><p>identifyNodesAndEdges</p></a></li>
<li><a href='#identifyNodesWithCircles'><p>identify largest circles in binary image</p></a></li>
<li><a href='#importFromNanoscope'><p>Import data from nanoscope analysis(tm) tool</p></a></li>
<li><a href='#initialize+2CAFMImageAnalyser-method'><p>Constructor method of AFMImageAnalyser Class.</p></a></li>
<li><a href='#invertBinaryAFMImage'><p>invert a binary AFMImage</p></a></li>
<li><a href='#isAdjacentToBetterVertex'><p>isAdjacentToBetterVertex</p></a></li>
<li><a href='#isAngleBetweenEdgesAlwaysSuperiorToMinAngle'><p>check if all the angles between one edge and a list of edges is superior to a specified value.</p></a></li>
<li><a href='#isBinary'><p>has the AFM Image heights of 0 or 1</p></a></li>
<li><a href='#loglike.normalmix'><p>loglike sum of density of a mixture of normals</p></a></li>
<li><a href='#makeBinaryAFMImage'><p>make a binary AFMImage setting all the heights different to 0 to 1.</p></a></li>
<li><a href='#multiplyHeightsAFMImage'><p>multiply the heights of an AFMImage</p></a></li>
<li><a href='#omniVariogramSlopeAnalysis-class'><p>AFM Image log-log experimental variogram slope analysis</p></a></li>
<li><a href='#performAllPSDCalculation'><p>Perform all the calculation for PSD exploitation</p></a></li>
<li><a href='#performGaussianMixCalculation'><p>Perform  the calculation for the Gaussian mixes</p></a></li>
<li><a href='#pnormmix'><p>pnormmix distribution of a mixture of normals</p></a></li>
<li><a href='#printVariogramModelEvaluations'><p>printVariogramModelEvaluations</p></a></li>
<li><a href='#PSD1DAgainstFrequency'><p>Calculate the 1D Power Spectral Density; returns a data table of PSD 1D and PSD 2D values</p>
against spatial frequencies.<br /> As mentionned in Sidick2009, this function calculates the
PSD against spatial frequencies in 1D from <code>PSD2DAgainstFrequency</code> by using
breaks in the log space to sum PSD 2D and frequency values.</a></li>
<li><a href='#PSD2DAgainstFrequency'><p>Calculate the 2D Power Spectral Density</p></a></li>
<li><a href='#putAnalysisOnDisk'><p>Export all data from an analysis of an AFM Image as rdata file</p></a></li>
<li><a href='#putImagesFromAnalysisOnDisk'><p>Put the images from all analysis on disk</p></a></li>
<li><a href='#removeLonguestEdge'><p>removeLonguestEdge</p></a></li>
<li><a href='#removeNode'><p>removeNode</p></a></li>
<li><a href='#RoughnessByLengthScale'><p>Calculate the roughness of the sample against length scale</p></a></li>
<li><a href='#runAFMApp'><p>Launch the AFM shiny application</p></a></li>
<li><a href='#sampleAFMImage'><p>Get a sample of an AFM image.</p></a></li>
<li><a href='#saveOnDisk'><p>Save an AFM image on disk.</p></a></li>
<li><a href='#saveOnDiskIntersectionForRoughnessAgainstLengthscale'><p>save an image of the roughness against lenghtscale calculations</p></a></li>
<li><a href='#saveSpplotFromAFMImage'><p>Save on disk an AFMImage as a Lattice (trellis) plot</p></a></li>
<li><a href='#shiftedPSDuv'><p>Calculate the shifted PSD matrix</p></a></li>
<li><a href='#shiftFFT2D'><p>Shift the quadrants of the FFT 2D</p></a></li>
<li><a href='#simplifyAFMImage'><p>simplify an AFM image.</p></a></li>
<li><a href='#simplifyNetwork'><p>simplifyNetwork</p></a></li>
<li><a href='#thinImage'><p>thin an Image in matrix format</p></a></li>
<li><a href='#totalRMSRoughness'><p>Calculate the total Root Mean Square Roughness (Rrms total)</p></a></li>
<li><a href='#transformAFMImageForNetworkAnalysis'><p>Multiply, filter the heights and make a binary AFMImage from the transformed AFMImage</p></a></li>
<li><a href='#updateProgress'><p>updateProgress</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Version:</td>
<td>2.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-10-07</td>
</tr>
<tr>
<td>Title:</td>
<td>Atomic Force Microscope Image Analysis</td>
</tr>
<tr>
<td>Author:</td>
<td>Mathieu Beauvais [aut, cre],
  Irma Liascukiene [aut],
  Jessem Landoulsi [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Mathieu Beauvais &lt;beauvais.escp@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides Atomic Force Microscope images analysis such as Gaussian mixes identification, Power
    Spectral Density, roughness against lengthscale, experimental variogram and variogram models,
    fractal dimension and scale, 2D network analysis. The AFM images can be exported to STL format for 3D
    printing.</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/AGPL-3">AGPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.4)</td>
</tr>
<tr>
<td>Imports:</td>
<td>data.table(&ge; 1.9.6),stringr(&ge; 1.0.0),gstat(&ge;
1.0-26),fractaldim(&ge; 0.8-4),rgl(&ge; 0.96),pracma(&ge;
1.8.6),grid(&ge; 3.1.3),gridExtra(&ge; 2.0.0),moments(&ge;
0.14),ggplot2(&ge; 1.0.1),sp(&ge; 1.2-0),png(&ge; 0.1-7),plyr(&ge;
1.8.3), igraph(&ge; 1.0.1),methods(&ge; 3.1.3), shiny(&ge; 0.12.2),
shinyjs(&ge; 0.4.0), scales(&ge; 0.4.0), dbscan(&ge; 0.9-8),
mixtools(&ge; 1.0.4), fftwtools(&ge; 0.9-8)</td>
</tr>
<tr>
<td>Collate:</td>
<td>'AFM3DPrinter.R' 'AFMFractalDimensionAnalyser.R'
'AFMGaussianMixAnalyser.R' 'AFMImage.R' 'AFMNetworksAnalyser.R'
'AFMPSDAnalyser.R' 'AFMVariogramAnalyser.R'
'AFMImageAnalyser.R' 'AFMReportMaker.R' 'pkgname.R'
'runAFMApp.R'</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-10-07 07:32:17 UTC; mb</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-10-07 08:00:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='addNode'>addNode</h2><span id='topic+addNode'></span>

<h3>Description</h3>

<p>add a node to an AFMImage
</p>


<h3>Usage</h3>

<pre><code class='language-R'>addNode(circleAFMImage, nodeDT, filterIndex)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="addNode_+3A_circleafmimage">circleAFMImage</code></td>
<td>
<p>a <code><a href="#topic+AFMImage">AFMImage</a></code></p>
</td></tr>
<tr><td><code id="addNode_+3A_nodedt">nodeDT</code></td>
<td>
<p>nodeDT a data.table lon lat circleRadius</p>
</td></tr>
<tr><td><code id="addNode_+3A_filterindex">filterIndex</code></td>
<td>
<p>an integer</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an <code><a href="#topic+AFMImage">AFMImage</a></code>
</p>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>

<hr>
<h2 id='AFM'>Atomic Force Microscopy images tools</h2><span id='topic+AFM'></span>

<h3>Description</h3>

<p>The AFM package provides statistics analysis tools for Atomic Force Microscopy image analysis.<br />
Licence: Affero GPL v3
</p>


<h3>Details</h3>

<p>A graphical user interface is available by using <code><a href="#topic+runAFMApp">runAFMApp</a></code> command.
</p>
<p>Several high level functions are :
</p>

<ul>
<li><p> create your AFM image from a list of measured  heights (see example section of <code><a href="#topic+AFMImage">AFMImage</a></code>)
</p>
</li>
<li><p> import your image from Nanoscope Analysis (TM) tool (<code><a href="#topic+importFromNanoscope">importFromNanoscope</a></code>) 
</p>
</li>
<li><p> check if your sample is normally distributed and isotropic and get a pdf report (<code><a href="#topic+generateCheckReport">generateCheckReport</a></code>)
</p>
</li>
<li><p> calculate the Gaussian mixes of the heights (<code><a href="#topic+performGaussianMixCalculation">performGaussianMixCalculation</a></code>)
</p>
</li>
<li><p> perform variance (variogram), roughness against lengthscale, fractal analysis and get a pdf report (<code><a href="#topic+generateReport">generateReport</a></code>)
</p>
</li>
<li><p> identify 2D networks (<code><a href="#topic+getNetworkParameters">getNetworkParameters</a></code>)
</p>
</li></ul>

<p>Other functions are :
</p>

<ul>
<li><p> check sample: for normality (<code><a href="#topic+checkNormality">checkNormality</a></code>) and for isotropy (<code><a href="#topic+checkIsotropy">checkIsotropy</a></code>)
</p>
</li>
<li><p> calculate total RMS roughness: quick calculation of total root mean square roughness(<code><a href="#topic+totalRMSRoughness">totalRMSRoughness</a></code>)
</p>
</li>
<li><p> calculate omnidirectional variogram: calculate estimated variogram (<code><a href="#topic+calculateOmnidirectionalVariogram">calculateOmnidirectionalVariogram</a></code>)
</p>
</li>
<li><p> calculate roughness against lenghscale and Power Spectrum Density (PSD): calculate roughness against length scale (<code><a href="#topic+RoughnessByLengthScale">RoughnessByLengthScale</a></code>), PSD 1D (<code><a href="#topic+PSD1DAgainstFrequency">PSD1DAgainstFrequency</a></code>) or PSD 2D (<code><a href="#topic+PSD2DAgainstFrequency">PSD2DAgainstFrequency</a></code>) against frequencies 
</p>
</li>
<li><p> calculate fractal dimension and scale: use (<code><a href="#topic+getFractalDimensions">getFractalDimensions</a></code>) function
</p>
</li>
<li><p> print in 3D (3D print) (<code><a href="#topic+exportToSTL">exportToSTL</a></code>) your AFM image
</p>
</li></ul>

<p>An EC2 instance is available for basic testing at the following address: <a href="http://www.afmist.org">http://www.afmist.org</a>
</p>
<p>Note: To use with a Brucker(TM) Atomic Force Microscope, use nanoscope analysis(TM) software and
</p>

<ul>
<li><p> Use the &quot;Flatten&quot; function.
</p>
</li>
<li><p> Save the flattened image.
</p>
</li>
<li><p> Use the &quot;Browse Data Files&quot; windows, right click on image name and then Export the AFM image with the headers and the &quot;Export&gt; ASCII&quot; contextual menu option. 
</p>
</li></ul>



<h3>Author(s)</h3>

<p>M.Beauvais, J.Landoulsi, I.Liascukiene
</p>


<h3>References</h3>

<p>Gneiting2012, Tilmann Gneiting, Hana Sevcikova and Donald B. Percival 'Estimators of Fractal Dimension: Assessing the Roughness of Time Series and Spatial Data - Statistics in statistical Science, 2012, Vol. 27, No. 2, 247-277' <br /><br />
Olea2006, Ricardo A. Olea &quot;A six-step practical approach to semivariogram modeling&quot;, 2006, &quot;Stochastic Environmental Research and Risk Assessment, Volume 20, Issue 5 , pp 307-318&quot; <br /><br />
Sidick2009, Erkin Sidick &quot;Power Spectral Density Specification and Analysis of Large Optical Surfaces&quot;, 2009, &quot;Modeling Aspects in Optical Metrology II, Proc. of SPIE Vol. 7390 73900L-1&quot;
</p>


<h3>See Also</h3>

<p><code>gstat</code>, <code>fractaldim</code>, <code>rgl</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  library(AFM)
# Analyse the AFMImageOfRegularPeaks AFM Image from this package
  data("AFMImageOfRegularPeaks")
  AFMImage&lt;-AFMImageOfRegularPeaks
# exportDirectory="C:/Users/my_windows_login" or exportDirectory="/home/ubuntu"
  exportDirectory=tempdir()
  AFMImage@fullfilename&lt;-paste(exportDirectory,"AFMImageOfRegularPeaks.txt",sep="/")
  
# Start to check if your sample is normaly distributed and isotropic.
  generateCheckReport(AFMImage)
  
# If the sample is normaly distributed and isotropic, generate a full report
  generateReport(AFMImage)
  
## End(Not run)
</code></pre>

<hr>
<h2 id='AFMImage-class'>AFM image class</h2><span id='topic+AFMImage-class'></span><span id='topic+AFMImage'></span><span id='topic+initialize+2CAFMImage-method'></span>

<h3>Description</h3>

<p>A S4 class to store and manipulate images from Atomic Force Microscopes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AFMImage(
  data,
  samplesperline,
  lines,
  hscansize,
  vscansize,
  scansize,
  fullfilename
)

## S4 method for signature 'AFMImage'
initialize(
  .Object,
  data,
  samplesperline,
  lines,
  hscansize,
  vscansize,
  scansize,
  fullfilename
)

AFMImage(
  data,
  samplesperline,
  lines,
  hscansize,
  vscansize,
  scansize,
  fullfilename
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AFMImage-class_+3A_data">data</code></td>
<td>
<p>($x,$y,$h): a data.table storing the coordinates of the sample and the measured heights</p>
</td></tr>
<tr><td><code id="AFMImage-class_+3A_samplesperline">samplesperline</code></td>
<td>
<p>number of samples per line (e.g.: 512)</p>
</td></tr>
<tr><td><code id="AFMImage-class_+3A_lines">lines</code></td>
<td>
<p>number of line (e.g.: 512)</p>
</td></tr>
<tr><td><code id="AFMImage-class_+3A_hscansize">hscansize</code></td>
<td>
<p>horizontal size of scan usualy in nanometer (e.g.: hscansize=1000 for a scan size of 1000 nm)</p>
</td></tr>
<tr><td><code id="AFMImage-class_+3A_vscansize">vscansize</code></td>
<td>
<p>vertical size of scan usualy in nanometer (e.g.: vscansize=1000 for a scan size of 1000 nm)</p>
</td></tr>
<tr><td><code id="AFMImage-class_+3A_scansize">scansize</code></td>
<td>
<p>if hscansize equals vscansize, scansize is the size of scan usualy in nanometer (e.g.: scansize=1000 for a scan size of 1000 nm)</p>
</td></tr>
<tr><td><code id="AFMImage-class_+3A_fullfilename">fullfilename</code></td>
<td>
<p>directory and filename on the disk (e.g.: /users/ubuntu/flatten-image.txt)</p>
</td></tr>
<tr><td><code id="AFMImage-class_+3A_.object">.Object</code></td>
<td>
<p>an AFMImage object</p>
</td></tr>
</table>


<h3>Slots</h3>


<dl>
<dt><code>data</code></dt><dd><p>($x,$y,$h): a data.table storing the coordinates of the sample and the measured heights</p>
</dd>
<dt><code>samplesperline</code></dt><dd><p>number of samples per line (e.g.: 512)</p>
</dd>
<dt><code>lines</code></dt><dd><p>number of line (e.g.: 512)</p>
</dd>
<dt><code>hscansize</code></dt><dd><p>horizontal size of scan usualy in nanometer (e.g.: hscansize=1000 for a scan size of 1000 nm)</p>
</dd>
<dt><code>vscansize</code></dt><dd><p>vertical size of scan usualy in nanometer (e.g.: vscansize=1000 for a scan size of 1000 nm)</p>
</dd>
<dt><code>scansize</code></dt><dd><p>if hscansize equals vscansize, scansize is the size of scan usualy in nanometer (e.g.: scansize=1000 for a scan size of 1000 nm)</p>
</dd>
<dt><code>fullfilename</code></dt><dd><p>directory and filename on the disk (e.g.: /users/ubuntu/flatten-image.txt)</p>
</dd>
</dl>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(AFM)
library(data.table)

# create a 128 pixels by 128 pixels AFM image
Lines=128
Samplesperline=128
fullfilename="RandomFakeAFMImage"
# the size of scan is 128 nm
ScanSize=128
# the heights is a normal distribution in nanometers
nm&lt;-c(rnorm(128*128, mean=0, sd=1 )) 

scanby&lt;-ScanSize/Samplesperline
endScan&lt;-ScanSize*(1-1/Samplesperline)
RandomFakeAFMImage&lt;-AFMImage(
     data = data.table(x = rep(seq(0,endScan, by= scanby), times = Lines),
                       y = rep(seq(0,endScan, by= scanby), each = Samplesperline), 
                       h = nm),
     samplesperline = Samplesperline, lines = Lines, 
     vscansize = ScanSize, hscansize = ScanSize, scansize = ScanSize, 
     fullfilename = fullfilename )

## End(Not run)
</code></pre>

<hr>
<h2 id='AFMImage3DModelAnalysis-class'>AFM image Power Spectrum Density analysis class</h2><span id='topic+AFMImage3DModelAnalysis-class'></span><span id='topic+AFMImage3DModelAnalysis'></span>

<h3>Description</h3>

<p><code>AFMImage3DModelAnalysis</code>
</p>


<h3>Slots</h3>


<dl>
<dt><code>f1</code></dt><dd><p>a face of the 3D model</p>
</dd>
<dt><code>f2</code></dt><dd><p>a face of the 3D model</p>
</dd>
<dt><code>f3</code></dt><dd><p>a face of the 3D model</p>
</dd>
<dt><code>f4</code></dt><dd><p>a face of the 3D model</p>
</dd>
</dl>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>

<hr>
<h2 id='AFMImageAnalyser-class'>AFM image analyser class</h2><span id='topic+AFMImageAnalyser-class'></span><span id='topic+AFMImageAnalyser'></span>

<h3>Description</h3>

<p>A S4 class to handle the analysis of one AFM Image.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AFMImageAnalyser(AFMImage)

AFMImageAnalyser(AFMImage)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AFMImageAnalyser-class_+3A_afmimage">AFMImage</code></td>
<td>
<p>an <code>AFMImage</code></p>
</td></tr>
</table>


<h3>Slots</h3>


<dl>
<dt><code>AFMImage</code></dt><dd><p><code><a href="#topic+AFMImage">AFMImage</a></code> to be analysed</p>
</dd>
<dt><code>variogramAnalysis</code></dt><dd><p><code><a href="#topic+AFMImageVariogramAnalysis">AFMImageVariogramAnalysis</a></code></p>
</dd>
<dt><code>psdAnalysis</code></dt><dd><p><code><a href="#topic+AFMImagePSDAnalysis">AFMImagePSDAnalysis</a></code></p>
</dd>
<dt><code>fdAnalysis</code></dt><dd><p><code><a href="#topic+AFMImageFractalDimensionsAnalysis">AFMImageFractalDimensionsAnalysis</a></code></p>
</dd>
<dt><code>gaussianMixAnalysis</code></dt><dd><p><code><a href="#topic+AFMImageGaussianMixAnalysis">AFMImageGaussianMixAnalysis</a></code></p>
</dd>
<dt><code>networksAnalysis</code></dt><dd><p><code><a href="#topic+AFMImageNetworksAnalysis">AFMImageNetworksAnalysis</a></code></p>
</dd>
<dt><code>mean</code></dt><dd><p>the mean of heights of the <code><a href="#topic+AFMImage">AFMImage</a></code></p>
</dd>
<dt><code>variance</code></dt><dd><p>the variance of heights of the <code><a href="#topic+AFMImage">AFMImage</a></code></p>
</dd>
<dt><code>TotalRrms</code></dt><dd><p>the total Root Mean Square Roughness of the <code><a href="#topic+AFMImage">AFMImage</a></code> calculated from variance</p>
</dd>
<dt><code>Ra</code></dt><dd><p>mean roughness or mean of absolute values of heights</p>
</dd>
<dt><code>fullfilename</code></dt><dd><p>to be removed ?</p>
</dd>
<dt><code>updateProgress</code></dt><dd><p>a function to update a graphical user interface</p>
</dd>
</dl>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>

<hr>
<h2 id='AFMImageCollagenNetwork'>AFM image sample</h2><span id='topic+AFMImageCollagenNetwork'></span>

<h3>Description</h3>

<p>A real dataset containing an <code><a href="#topic+AFMImage">AFMImage</a></code> of a collagen network.
The image is made of 192*192 samples of a 1500 nm * 1500 nm surface.
samplesperline=192
lines=192
hscansize=1500
vscansize=1500
</p>

<hr>
<h2 id='AFMImageFractalDimensionMethod-class'>AFM image fractal dimension method class</h2><span id='topic+AFMImageFractalDimensionMethod-class'></span><span id='topic+AFMImageFractalDimensionMethod'></span><span id='topic+initialize+2CAFMImageFractalDimensionMethod-method'></span>

<h3>Description</h3>

<p><code>AFMImageFractalDimensionMethod</code> stores calculation from one fractal dimension method
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AFMImageFractalDimensionMethod(fd_method, fd, fd_scale)

## S4 method for signature 'AFMImageFractalDimensionMethod'
initialize(.Object, fd_method, fd, fd_scale)

AFMImageFractalDimensionMethod(fd_method, fd, fd_scale)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AFMImageFractalDimensionMethod-class_+3A_fd_method">fd_method</code></td>
<td>
<p>Two dimensional function names used to evaluate the fractal dimension and fractal scale</p>
</td></tr>
<tr><td><code id="AFMImageFractalDimensionMethod-class_+3A_fd">fd</code></td>
<td>
<p>the value of the fractal dimension</p>
</td></tr>
<tr><td><code id="AFMImageFractalDimensionMethod-class_+3A_fd_scale">fd_scale</code></td>
<td>
<p>the value of the fractal scale</p>
</td></tr>
<tr><td><code id="AFMImageFractalDimensionMethod-class_+3A_.object">.Object</code></td>
<td>
<p>an AFMImageFractalDimensionMethod object</p>
</td></tr>
</table>


<h3>Slots</h3>


<dl>
<dt><code>fd_method</code></dt><dd><p>Two dimensional function names used to evaluate the fractal dimension and fractal scale</p>
</dd>
<dt><code>fd</code></dt><dd><p>the value of the fractal dimension</p>
</dd>
<dt><code>fd_scale</code></dt><dd><p>the value of the fractal scale</p>
</dd>
</dl>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>


<h3>See Also</h3>

<p><code>fractaldim</code>
</p>

<hr>
<h2 id='AFMImageFractalDimensionsAnalysis-class'>AFM image fractal dimensions analysis class</h2><span id='topic+AFMImageFractalDimensionsAnalysis-class'></span><span id='topic+AFMImageFractalDimensionsAnalysis'></span><span id='topic+initialize+2CAFMImageFractalDimensionsAnalysis-method'></span><span id='topic+fractalDimensionMethods+2CAFMImageFractalDimensionsAnalysis-method'></span><span id='topic+fractalDimensionMethods'></span>

<h3>Description</h3>

<p>A S4 class to handle the fractal dimension calculation with several fractal dimension methods
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AFMImageFractalDimensionsAnalysis()

## S4 method for signature 'AFMImageFractalDimensionsAnalysis'
initialize(.Object, fractalDimensionMethods, csvFullfilename)

AFMImageFractalDimensionsAnalysis()

fractalDimensionMethods(object)

## S4 method for signature 'AFMImageFractalDimensionsAnalysis'
fractalDimensionMethods(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AFMImageFractalDimensionsAnalysis-class_+3A_.object">.Object</code></td>
<td>
<p>an AFMImageFractalDimensionsAnalysis Class</p>
</td></tr>
<tr><td><code id="AFMImageFractalDimensionsAnalysis-class_+3A_fractaldimensionmethods">fractalDimensionMethods</code></td>
<td>
<p>a list of <code><a href="#topic+AFMImageFractalDimensionMethod">AFMImageFractalDimensionMethod</a></code></p>
</td></tr>
<tr><td><code id="AFMImageFractalDimensionsAnalysis-class_+3A_csvfullfilename">csvFullfilename</code></td>
<td>
<p>To be removed ?</p>
</td></tr>
<tr><td><code id="AFMImageFractalDimensionsAnalysis-class_+3A_object">object</code></td>
<td>
<p>a <code><a href="#topic+AFMImageFractalDimensionsAnalysis">AFMImageFractalDimensionsAnalysis</a></code></p>
</td></tr>
</table>


<h3>Slots</h3>


<dl>
<dt><code>fractalDimensionMethods</code></dt><dd><p>a list of <code><a href="#topic+AFMImageFractalDimensionMethod">AFMImageFractalDimensionMethod</a></code></p>
</dd>
<dt><code>csvFullfilename</code></dt><dd><p>To be removed ?</p>
</dd>
<dt><code>updateProgress</code></dt><dd><p>a function to update a graphical user interface</p>
</dd>
</dl>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>

<hr>
<h2 id='AFMImageGaussianMixAnalysis-class'>AFM image Gaussian Mix analysis class</h2><span id='topic+AFMImageGaussianMixAnalysis-class'></span><span id='topic+AFMImageGaussianMixAnalysis'></span><span id='topic+initialize+2CAFMImageGaussianMixAnalysis-method'></span><span id='topic+summaryMixture+2CAFMImageGaussianMixAnalysis-method'></span><span id='topic+summaryMixture'></span><span id='topic+eachComponentsCounts+2CAFMImageGaussianMixAnalysis-method'></span><span id='topic+eachComponentsCounts'></span><span id='topic+densityCurvesAllHeights+2CAFMImageGaussianMixAnalysis-method'></span><span id='topic+densityCurvesAllHeights'></span><span id='topic+tcdfsEcdfsCheck+2CAFMImageGaussianMixAnalysis-method'></span><span id='topic+tcdfsEcdfsCheck'></span><span id='topic+gaussianMix+2CAFMImageGaussianMixAnalysis-method'></span><span id='topic+gaussianMix'></span><span id='topic+minGaussianMix+2CAFMImageGaussianMixAnalysis-method'></span><span id='topic+minGaussianMix'></span><span id='topic+maxGaussianMix+2CAFMImageGaussianMixAnalysis-method'></span><span id='topic+maxGaussianMix'></span><span id='topic+epsilonGaussianMix+2CAFMImageGaussianMixAnalysis-method'></span><span id='topic+epsilonGaussianMix'></span>

<h3>Description</h3>

<p><code>AFMImageGaussianMixAnalysis</code> handles an <code><a href="#topic+AFMImage">AFMImage</a></code> Gaussian mix of heights analysis
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AFMImageGaussianMixAnalysis()

## S4 method for signature 'AFMImageGaussianMixAnalysis'
initialize(.Object)

AFMImageGaussianMixAnalysis()

summaryMixture(object)

## S4 method for signature 'AFMImageGaussianMixAnalysis'
summaryMixture(object)

eachComponentsCounts(object)

## S4 method for signature 'AFMImageGaussianMixAnalysis'
eachComponentsCounts(object)

tcdfsEcdfsCheck(object)

densityCurvesAllHeights(object)

## S4 method for signature 'AFMImageGaussianMixAnalysis'
densityCurvesAllHeights(object)

tcdfsEcdfsCheck(object)

## S4 method for signature 'AFMImageGaussianMixAnalysis'
tcdfsEcdfsCheck(object)

gaussianMix(object)

## S4 method for signature 'AFMImageGaussianMixAnalysis'
gaussianMix(object)

minGaussianMix(object)

## S4 method for signature 'AFMImageGaussianMixAnalysis'
minGaussianMix(object)

maxGaussianMix(object)

## S4 method for signature 'AFMImageGaussianMixAnalysis'
maxGaussianMix(object)

epsilonGaussianMix(object)

## S4 method for signature 'AFMImageGaussianMixAnalysis'
epsilonGaussianMix(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AFMImageGaussianMixAnalysis-class_+3A_.object">.Object</code></td>
<td>
<p>an AFMImageGaussianMixAnalysis object</p>
</td></tr>
<tr><td><code id="AFMImageGaussianMixAnalysis-class_+3A_object">object</code></td>
<td>
<p>a <code><a href="#topic+AFMImageGaussianMixAnalysis">AFMImageGaussianMixAnalysis</a></code></p>
</td></tr>
</table>


<h3>Slots</h3>


<dl>
<dt><code>minGaussianMix</code></dt><dd><p>the minimum number of components to calculate</p>
</dd>
<dt><code>maxGaussianMix</code></dt><dd><p>the maximum number of components to calculate</p>
</dd>
<dt><code>epsilonGaussianMix</code></dt><dd><p>the convergence criterion</p>
</dd>
<dt><code>gaussianMix</code></dt><dd><p>a data.table to store the calculated Gaussian mixes</p>
</dd>
<dt><code>summaryMixture</code></dt><dd><p>a data.table to summaryse the mixtures</p>
</dd>
<dt><code>tcdfsEcdfsCheck</code></dt><dd><p>an array to store the points to draw tcdfs ecdfs check</p>
</dd>
<dt><code>densityCurvesAllHeights</code></dt><dd><p>an array to store the points to draw the density curves</p>
</dd>
<dt><code>eachComponentsCounts</code></dt><dd><p>an array to store the points to draw counts of each components</p>
</dd>
<dt><code>updateProgress</code></dt><dd><p>a function to update a graphical user interface</p>
</dd>
</dl>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>

<hr>
<h2 id='AFMImageNetworksAnalysis-class'>AFM image networks analysis class</h2><span id='topic+AFMImageNetworksAnalysis-class'></span><span id='topic+AFMImageNetworksAnalysis'></span><span id='topic+initialize+2CAFMImageNetworksAnalysis-method'></span>

<h3>Description</h3>

<p>A S4 class to handle the networks calculation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AFMImageNetworksAnalysis()

## S4 method for signature 'AFMImageNetworksAnalysis'
initialize(
  .Object,
  vertexHashsize,
  binaryAFMImage,
  binaryAFMImageWithCircles,
  circlesTable,
  edgesTable,
  fusionedNodesCorrespondance,
  fusionedNodesEdgesTable,
  isolatedNodesList,
  heightNetworksslider,
  filterNetworkssliderMin,
  filterNetworkssliderMax,
  smallBranchesTreatment,
  originalGraph,
  skeletonGraph,
  shortestPaths,
  networksCharacteristics,
  holes,
  holesCharacteristics,
  graphEvcent,
  graphBetweenness,
  libVersion
)

AFMImageNetworksAnalysis()
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AFMImageNetworksAnalysis-class_+3A_.object">.Object</code></td>
<td>
<p>an AFMImageNetworksAnalysis Class</p>
</td></tr>
<tr><td><code id="AFMImageNetworksAnalysis-class_+3A_vertexhashsize">vertexHashsize</code></td>
<td>
<p>hash to transform coordinates to vertexId</p>
</td></tr>
<tr><td><code id="AFMImageNetworksAnalysis-class_+3A_binaryafmimage">binaryAFMImage</code></td>
<td>
<p>the AFMImage after transformation before analysis</p>
</td></tr>
<tr><td><code id="AFMImageNetworksAnalysis-class_+3A_binaryafmimagewithcircles">binaryAFMImageWithCircles</code></td>
<td>
<p>the AFMImage after transformation with the spotted circles</p>
</td></tr>
<tr><td><code id="AFMImageNetworksAnalysis-class_+3A_circlestable">circlesTable</code></td>
<td>
<p>a data.table of identified circles</p>
</td></tr>
<tr><td><code id="AFMImageNetworksAnalysis-class_+3A_edgestable">edgesTable</code></td>
<td>
<p>a data.table of edges</p>
</td></tr>
<tr><td><code id="AFMImageNetworksAnalysis-class_+3A_fusionednodescorrespondance">fusionedNodesCorrespondance</code></td>
<td>
<p>a data.table of correspon</p>
</td></tr>
<tr><td><code id="AFMImageNetworksAnalysis-class_+3A_fusionednodesedgestable">fusionedNodesEdgesTable</code></td>
<td>
<p>a data.table of corresponsdance between intial node and fusioned node</p>
</td></tr>
<tr><td><code id="AFMImageNetworksAnalysis-class_+3A_isolatednodeslist">isolatedNodesList</code></td>
<td>
<p>a data.table of isolated nodes</p>
</td></tr>
<tr><td><code id="AFMImageNetworksAnalysis-class_+3A_heightnetworksslider">heightNetworksslider</code></td>
<td>
<p>used multiplier of heights to facilitate analysis</p>
</td></tr>
<tr><td><code id="AFMImageNetworksAnalysis-class_+3A_filternetworksslidermin">filterNetworkssliderMin</code></td>
<td>
<p>used filter minimum value to facilitate analysis</p>
</td></tr>
<tr><td><code id="AFMImageNetworksAnalysis-class_+3A_filternetworksslidermax">filterNetworkssliderMax</code></td>
<td>
<p>used filter maximum value to facilitate analysis</p>
</td></tr>
<tr><td><code id="AFMImageNetworksAnalysis-class_+3A_smallbranchestreatment">smallBranchesTreatment</code></td>
<td>
<p>boolean - smallest circle used or not</p>
</td></tr>
<tr><td><code id="AFMImageNetworksAnalysis-class_+3A_originalgraph">originalGraph</code></td>
<td>
<p>a list of <code>igraph</code></p>
</td></tr>
<tr><td><code id="AFMImageNetworksAnalysis-class_+3A_skeletongraph">skeletonGraph</code></td>
<td>
<p>a list of <code>igraph</code></p>
</td></tr>
<tr><td><code id="AFMImageNetworksAnalysis-class_+3A_shortestpaths">shortestPaths</code></td>
<td>
<p>a data.table of shortest path</p>
</td></tr>
<tr><td><code id="AFMImageNetworksAnalysis-class_+3A_networkscharacteristics">networksCharacteristics</code></td>
<td>
<p>a data.table to store the skeleton graph characteristics</p>
</td></tr>
<tr><td><code id="AFMImageNetworksAnalysis-class_+3A_holes">holes</code></td>
<td>
<p>a data.table to store the cluster number of each point</p>
</td></tr>
<tr><td><code id="AFMImageNetworksAnalysis-class_+3A_holescharacteristics">holesCharacteristics</code></td>
<td>
<p>a data.table to summarize the data about holes</p>
</td></tr>
<tr><td><code id="AFMImageNetworksAnalysis-class_+3A_graphevcent">graphEvcent</code></td>
<td>
<p>an array to store Evcent</p>
</td></tr>
<tr><td><code id="AFMImageNetworksAnalysis-class_+3A_graphbetweenness">graphBetweenness</code></td>
<td>
<p>an array to store the graph betweenness</p>
</td></tr>
<tr><td><code id="AFMImageNetworksAnalysis-class_+3A_libversion">libVersion</code></td>
<td>
<p>version of the AFM library used to perform the analysis</p>
</td></tr>
</table>


<h3>Slots</h3>


<dl>
<dt><code>vertexHashsize</code></dt><dd><p>hash to transform coordinates to vertexId</p>
</dd>
<dt><code>binaryAFMImage</code></dt><dd><p>the AFMImage after transformation before analysis</p>
</dd>
<dt><code>binaryAFMImageWithCircles</code></dt><dd><p>the AFMImage after transformation with the spotted circles</p>
</dd>
<dt><code>circlesTable</code></dt><dd><p>a data.table of identified circles</p>
</dd>
<dt><code>edgesTable</code></dt><dd><p>a data.table of edges</p>
</dd>
<dt><code>fusionedNodesCorrespondance</code></dt><dd><p>a data.table of corresponsdance between intial node and fusioned node</p>
</dd>
<dt><code>fusionedNodesEdgesTable</code></dt><dd><p>a data.table of nodes fusioned because of intersecting</p>
</dd>
<dt><code>isolatedNodesTable</code></dt><dd><p>a data.table of isolated nodes</p>
</dd>
<dt><code>heightNetworksslider</code></dt><dd><p>used multiplier of heights to facilitate analysis</p>
</dd>
<dt><code>filterNetworkssliderMin</code></dt><dd><p>used filter minimum value to facilitate analysis</p>
</dd>
<dt><code>filterNetworkssliderMax</code></dt><dd><p>used filter maximum value to facilitate analysis</p>
</dd>
<dt><code>smallBranchesTreatment</code></dt><dd><p>boolean - smallest circle used or not</p>
</dd>
<dt><code>originalGraph</code></dt><dd><p>a list of <code>igraph</code></p>
</dd>
<dt><code>skeletonGraph</code></dt><dd><p>a list of <code>igraph</code></p>
</dd>
<dt><code>shortestPaths</code></dt><dd><p>a data.table of shortest paths</p>
</dd>
<dt><code>networksCharacteristics</code></dt><dd><p>a data.table to store the skeleton graph characteristics</p>
</dd>
<dt><code>graphEvcent</code></dt><dd><p>an array to store Evcent</p>
</dd>
<dt><code>graphBetweenness</code></dt><dd><p>an array to store the graph betweenness</p>
</dd>
<dt><code>libVersion</code></dt><dd><p>version of the AFM library used to perform the analysis</p>
</dd>
<dt><code>updateProgress</code></dt><dd><p>a function to update a graphical user interface</p>
</dd>
</dl>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>

<hr>
<h2 id='AFMImageOfAluminiumInterface'>AFM image sample</h2><span id='topic+AFMImageOfAluminiumInterface'></span>

<h3>Description</h3>

<p>A real dataset containing an <code><a href="#topic+AFMImage">AFMImage</a></code> of an Aluminium interface.
The image is made of 512*512 samples of a 1000 nm * 1000 nm surface.
samplesperline=512
lines=512
hscansize=1000
vscansize=1000
</p>


<h3>Author(s)</h3>

<p>J.Landoulsi, I.Liascukiene
</p>

<hr>
<h2 id='AFMImageOfNormallyDistributedHeights'>AFM image sample</h2><span id='topic+AFMImageOfNormallyDistributedHeights'></span>

<h3>Description</h3>

<p>A fake dataset containing a manually generated <code><a href="#topic+AFMImage">AFMImage</a></code> (a normal distribution of heights).
The image is made of 128*128 samples of a 128 nm * 128 nm surface.
samplesperline= 128
lines= 128
hscansize= 128
vscansize= 128
</p>

<hr>
<h2 id='AFMImageOfOnePeak'>AFM image sample</h2><span id='topic+AFMImageOfOnePeak'></span>

<h3>Description</h3>

<p>A fake dataset containing a manually generated <code><a href="#topic+AFMImage">AFMImage</a></code> (one peak positioned on the surface).
The image is made of 128*128 samples of a 128 nm * 128 nm surface.
samplesperline= 128
lines= 128
hscansize= 128
vscansize= 128
</p>

<hr>
<h2 id='AFMImageOfRegularPeaks'>AFM image sample</h2><span id='topic+AFMImageOfRegularPeaks'></span>

<h3>Description</h3>

<p>A fake dataset containing a manually generated <code><a href="#topic+AFMImage">AFMImage</a></code> (peaks regularly positioned on the surface).
The image is made of 128*128 samples of a 128 nm * 128 nm surface.
samplesperline= 128
lines= 128
hscansize= 128
vscansize= 128
</p>

<hr>
<h2 id='AFMImagePSDAnalysis-class'>AFM image Power Spectrum Density analysis class</h2><span id='topic+AFMImagePSDAnalysis-class'></span><span id='topic+AFMImagePSDAnalysis'></span><span id='topic+initialize+2CAFMImagePSDAnalysis-method'></span><span id='topic+psd1d_breaks+2CAFMImagePSDAnalysis-method'></span><span id='topic+psd1d_breaks'></span><span id='topic+psd2d_maxHighLengthScale+2CAFMImagePSDAnalysis-method'></span><span id='topic+psd2d_maxHighLengthScale'></span><span id='topic+psd2d_truncHighLengthScale+2CAFMImagePSDAnalysis-method'></span><span id='topic+psd2d_truncHighLengthScale'></span><span id='topic+psd1d+2CAFMImagePSDAnalysis-method'></span><span id='topic+psd1d'></span><span id='topic+psd2d+2CAFMImagePSDAnalysis-method'></span><span id='topic+psd2d'></span><span id='topic+roughnessAgainstLengthscale+2CAFMImagePSDAnalysis-method'></span><span id='topic+roughnessAgainstLengthscale'></span><span id='topic+intersections+2CAFMImagePSDAnalysis-method'></span><span id='topic+intersections'></span>

<h3>Description</h3>

<p><code>AFMImagePSDAnalysis</code> handles an <code><a href="#topic+AFMImage">AFMImage</a></code> roughness against lenghscale analysis
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AFMImagePSDAnalysis()

## S4 method for signature 'AFMImagePSDAnalysis'
initialize(.Object)

AFMImagePSDAnalysis()

psd1d_breaks(object)

## S4 method for signature 'AFMImagePSDAnalysis'
psd1d_breaks(object)

psd2d_maxHighLengthScale(object)

## S4 method for signature 'AFMImagePSDAnalysis'
psd2d_maxHighLengthScale(object)

psd2d_truncHighLengthScale(object)

## S4 method for signature 'AFMImagePSDAnalysis'
psd2d_truncHighLengthScale(object)

psd1d(object)

## S4 method for signature 'AFMImagePSDAnalysis'
psd1d(object)

psd2d(object)

## S4 method for signature 'AFMImagePSDAnalysis'
psd2d(object)

roughnessAgainstLengthscale(object)

## S4 method for signature 'AFMImagePSDAnalysis'
roughnessAgainstLengthscale(object)

intersections(object)

## S4 method for signature 'AFMImagePSDAnalysis'
intersections(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AFMImagePSDAnalysis-class_+3A_.object">.Object</code></td>
<td>
<p>an AFMImagePSDAnalysis object</p>
</td></tr>
<tr><td><code id="AFMImagePSDAnalysis-class_+3A_object">object</code></td>
<td>
<p>a <code><a href="#topic+AFMImagePSDAnalysis">AFMImagePSDAnalysis</a></code></p>
</td></tr>
</table>


<h3>Slots</h3>


<dl>
<dt><code>roughnessAgainstLengthscale</code></dt><dd><p>a data.table to store the roughness against lengthscale data</p>
</dd>
<dt><code>intersections</code></dt><dd><p>a list to store the lengthscales values as the intersections between slopes and the sill in roughness against lenghscale graph</p>
</dd>
<dt><code>updateProgress</code></dt><dd><p>a function to update a graphical user interface</p>
</dd>
</dl>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>

<hr>
<h2 id='AFMImagePSDSlopesAnalysis-class'>AFM Image psd slope analysis</h2><span id='topic+AFMImagePSDSlopesAnalysis-class'></span><span id='topic+AFMImagePSDSlopesAnalysis'></span><span id='topic+initialize+2CAFMImagePSDSlopesAnalysis-method'></span>

<h3>Description</h3>

<p><code>AFMImagePSDSlopesAnalysis</code> stores the analysis of the second slope in roughness against lenghtscale
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AFMImagePSDSlopesAnalysis()

## S4 method for signature 'AFMImagePSDSlopesAnalysis'
initialize(.Object)

AFMImagePSDSlopesAnalysis()
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AFMImagePSDSlopesAnalysis-class_+3A_.object">.Object</code></td>
<td>
<p>an AFMImagePSDSlopesAnalysis object</p>
</td></tr>
</table>


<h3>Slots</h3>


<dl>
<dt><code>lc</code></dt><dd><p>to be removed ?</p>
</dd>
<dt><code>wsat</code></dt><dd><p>to be removed ?</p>
</dd>
<dt><code>slope</code></dt><dd><p>to be removed ?</p>
</dd>
<dt><code>yintersept</code></dt><dd><p>to be removed ?</p>
</dd>
</dl>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>

<hr>
<h2 id='AFMImageVariogramAnalysis-class'>AFM image variogram analysis class</h2><span id='topic+AFMImageVariogramAnalysis-class'></span><span id='topic+AFMImageVariogramAnalysis'></span><span id='topic+initialize+2CAFMImageVariogramAnalysis-method'></span><span id='topic+variogramModels+2CAFMImageVariogramAnalysis-method'></span><span id='topic+variogramModels'></span><span id='topic+omnidirectionalVariogram+2CAFMImageVariogramAnalysis-method'></span><span id='topic+omnidirectionalVariogram'></span><span id='topic+directionalVariograms+2CAFMImageVariogramAnalysis-method'></span><span id='topic+directionalVariograms'></span><span id='topic+variogramSlopeAnalysis+2CAFMImageVariogramAnalysis-method'></span><span id='topic+variogramSlopeAnalysis'></span>

<h3>Description</h3>

<p><code>AFMImageVariogramAnalysis</code> manages the variogram analysis of an <code><a href="#topic+AFMImage">AFMImage</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AFMImageVariogramAnalysis(sampleFitPercentage)

## S4 method for signature 'AFMImageVariogramAnalysis'
initialize(.Object, sampleFitPercentage, updateProgress)

AFMImageVariogramAnalysis(sampleFitPercentage)

variogramModels(object)

## S4 method for signature 'AFMImageVariogramAnalysis'
variogramModels(object)

omnidirectionalVariogram(object)

## S4 method for signature 'AFMImageVariogramAnalysis'
omnidirectionalVariogram(object)

directionalVariograms(object)

## S4 method for signature 'AFMImageVariogramAnalysis'
directionalVariograms(object)

variogramSlopeAnalysis(object)

## S4 method for signature 'AFMImageVariogramAnalysis'
variogramSlopeAnalysis(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AFMImageVariogramAnalysis-class_+3A_samplefitpercentage">sampleFitPercentage</code></td>
<td>
<p>a sample size as a percentage (e.g. &quot;5&quot; for 5 percents) of random points in the <code><a href="#topic+AFMImage">AFMImage</a></code>. These points will be used to fit the variogram models.</p>
</td></tr>
<tr><td><code id="AFMImageVariogramAnalysis-class_+3A_.object">.Object</code></td>
<td>
<p>an AFMImageVariogramAnalysis class</p>
</td></tr>
<tr><td><code id="AFMImageVariogramAnalysis-class_+3A_updateprogress">updateProgress</code></td>
<td>
<p>a function to update a graphical user interface</p>
</td></tr>
<tr><td><code id="AFMImageVariogramAnalysis-class_+3A_object">object</code></td>
<td>
<p>a <code>AFMImageVariogramAnalysis</code> object</p>
</td></tr>
</table>


<h3>Slots</h3>


<dl>
<dt><code>width</code></dt><dd><p>(optional) a distance step for the calculation of the variograms
(e.g.: width=  integer of (scan Size divided by number of lines)= ceil(1000 / 512) for AFMImageOfAluminiumInterface</p>
</dd>
<dt><code>omnidirectionalVariogram</code></dt><dd><p>a data.table to store the omnidirectional variogram</p>
</dd>
<dt><code>variogramSlopeAnalysis</code></dt><dd><p>a AFMImageVariogramAnalysis to analyse slope in log log omnidirectional semivariogram</p>
</dd>
<dt><code>directionalVariograms</code></dt><dd><p>a data.table to store the directional variograms</p>
</dd>
<dt><code>sampleFitPercentage</code></dt><dd><p>a sample size as a percentage of random points in the <code><a href="#topic+AFMImage">AFMImage</a></code>. These points will be used to fit the variogram models.</p>
</dd>
<dt><code>chosenFitSample</code></dt><dd><p>the chosen random points  of the <code><a href="#topic+AFMImage">AFMImage</a></code> to perform the fitting of the variogram models.</p>
</dd>
<dt><code>cuts</code></dt><dd><p>the cuts for spplot of the <code><a href="#topic+AFMImage">AFMImage</a></code>. The same cuts will be used for the predicted <code><a href="#topic+AFMImage">AFMImage</a></code></p>
</dd>
<dt><code>variogramModels</code></dt><dd><p>A list of <code><a href="#topic+AFMImageVariogramModel">AFMImageVariogramModel</a></code> containing the various evaluated variogram models.</p>
</dd>
<dt><code>fullfilename</code></dt><dd><p>to be removed ?</p>
</dd>
<dt><code>updateProgress</code></dt><dd><p>a function to update a graphical user interface</p>
</dd>
</dl>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>

<hr>
<h2 id='AFMImageVariogramModel-class'>AFM Image Variogram Model class</h2><span id='topic+AFMImageVariogramModel-class'></span><span id='topic+AFMImageVariogramModel'></span><span id='topic+initialize+2CAFMImageVariogramModel-method'></span>

<h3>Description</h3>

<p><code>AFMImageVariogramModel</code>stores the evaluation of one experimental variogram model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AFMImageVariogramModel()

## S4 method for signature 'AFMImageVariogramModel'
initialize(
  .Object,
  model,
  fit.v = data.table(),
  mykrige,
  res = data.table(),
  cor,
  press,
  sill,
  imageFullfilename
)

AFMImageVariogramModel()
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AFMImageVariogramModel-class_+3A_.object">.Object</code></td>
<td>
<p>an AFMImageVariogramModel object</p>
</td></tr>
<tr><td><code id="AFMImageVariogramModel-class_+3A_model">model</code></td>
<td>
<p>the variogram model name</p>
</td></tr>
<tr><td><code id="AFMImageVariogramModel-class_+3A_fit.v">fit.v</code></td>
<td>
<p>the values from the <code><a href="gstat.html#topic+fit.variogram">fit.variogram</a></code> function in the gstat package</p>
</td></tr>
<tr><td><code id="AFMImageVariogramModel-class_+3A_mykrige">mykrige</code></td>
<td>
<p>the values from the <code><a href="gstat.html#topic+krige">krige</a></code> function in the gstat library</p>
</td></tr>
<tr><td><code id="AFMImageVariogramModel-class_+3A_res">res</code></td>
<td>
<p>a data.table to store: (cor) the correlation between the predicted sample and the real sample (press) the sum of the square of the differences between real and predicted values for each point of the sample</p>
</td></tr>
<tr><td><code id="AFMImageVariogramModel-class_+3A_cor">cor</code></td>
<td>
<p>to be removed ?</p>
</td></tr>
<tr><td><code id="AFMImageVariogramModel-class_+3A_press">press</code></td>
<td>
<p>to be removed ?</p>
</td></tr>
<tr><td><code id="AFMImageVariogramModel-class_+3A_sill">sill</code></td>
<td>
<p>to be removed ?</p>
</td></tr>
<tr><td><code id="AFMImageVariogramModel-class_+3A_imagefullfilename">imageFullfilename</code></td>
<td>
<p>to be removed ?</p>
</td></tr>
</table>


<h3>Slots</h3>


<dl>
<dt><code>model</code></dt><dd><p>the variogram model name</p>
</dd>
<dt><code>fit.v</code></dt><dd><p>the values from the <code><a href="gstat.html#topic+fit.variogram">fit.variogram</a></code> function in the gstat package</p>
</dd>
<dt><code>mykrige</code></dt><dd><p>the values from the <code><a href="gstat.html#topic+krige">krige</a></code> function in the gstat library</p>
</dd>
<dt><code>res</code></dt><dd><p>a data.table to store: (cor) the correlation between the predicted sample and the real sample (press) the sum of the square of the differences between real and predicted values for each point of the sample</p>
</dd>
<dt><code>cor</code></dt><dd><p>to be removed ?</p>
</dd>
<dt><code>press</code></dt><dd><p>to be removed ?</p>
</dd>
<dt><code>sill</code></dt><dd><p>to be removed ?</p>
</dd>
<dt><code>imageFullfilename</code></dt><dd><p>to be removed ?</p>
</dd>
</dl>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>

<hr>
<h2 id='analyse'>Analyse an AFMImage</h2><span id='topic+analyse'></span>

<h3>Description</h3>

<p>A function to wrap all the analysis of an <code><a href="#topic+AFMImage">AFMImage</a></code>
</p>

<ul>
<li><p> variogram analysis  including evaluation of basic variogram models with sill and range calculation
</p>
</li>
<li><p> power spectrum density analysis including roughness against lengthscale calculation
</p>
</li>
<li><p> fractal dimension analysis including fractal dimensions calculation
</p>
</li>
<li><p> basic roughness parameters analysis such as mean, variance, Rrms, Ra
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>analyse(AFMImageAnalyser)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="analyse_+3A_afmimageanalyser">AFMImageAnalyser</code></td>
<td>
<p>a <code><a href="#topic+AFMImageAnalyser">AFMImageAnalyser</a></code> to manage and store image analysis</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an <code><a href="#topic+AFMImageAnalyser">AFMImageAnalyser</a></code> containing all the analysis
</p>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(AFM)

data(AFMImageOfAluminiumInterface)
AFMImage&lt;-extractAFMImage(AFMImageOfAluminiumInterface, 0, 0, 32)
AFMImageAnalyser&lt;-new("AFMImageAnalyser", AFMImage= AFMImage, fullfilename = AFMImage@fullfilename)
AFMImageAnalyser&lt;-analyse(AFMImageAnalyser)
print(AFMImageAnalyser@fdAnalysis)

## End(Not run)
</code></pre>

<hr>
<h2 id='AreNodesConnected'>check if nodes represented by circles are connected. The function defines all the possible segments between the circles and check if at least one segment exists.</h2><span id='topic+AreNodesConnected'></span>

<h3>Description</h3>

<p>check if nodes represented by circles are connected. The function defines all the possible segments between the circles and check if at least one segment exists.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AreNodesConnected(binaryAFMImage, center1, radius1, center2, radius2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AreNodesConnected_+3A_binaryafmimage">binaryAFMImage</code></td>
<td>
<p>a binary <code><a href="#topic+AFMImage">AFMImage</a></code> from Atomic Force Microscopy</p>
</td></tr>
<tr><td><code id="AreNodesConnected_+3A_center1">center1</code></td>
<td>
<p>the center of the circle with center$lon as the x coordinates and center$lat as the y coordinates</p>
</td></tr>
<tr><td><code id="AreNodesConnected_+3A_radius1">radius1</code></td>
<td>
<p>the radius of the circle</p>
</td></tr>
<tr><td><code id="AreNodesConnected_+3A_center2">center2</code></td>
<td>
<p>the center of the circle with center$lon as the x coordinates and center$lat as the y coordinates</p>
</td></tr>
<tr><td><code id="AreNodesConnected_+3A_radius2">radius2</code></td>
<td>
<p>the radius of the circle</p>
</td></tr>
</table>


<h3>Value</h3>

<p>TRUE if the nodes are connected
</p>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>

<hr>
<h2 id='calculate3DModel'>Calculate the 3D model for 3D printing</h2><span id='topic+calculate3DModel'></span><span id='topic+calculate3DModel+2CAFMImage3DModelAnalysis-method'></span><span id='topic+calculate3DModel+2CAFMImage-method'></span>

<h3>Description</h3>

<p><code>calculate3DModel</code> update  <code><a href="#topic+AFMImage3DModelAnalysis">AFMImage3DModelAnalysis</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculate3DModel(AFMImage3DModelAnalysis, AFMImage)

## S4 method for signature 'AFMImage3DModelAnalysis'
calculate3DModel(AFMImage3DModelAnalysis, AFMImage)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calculate3DModel_+3A_afmimage3dmodelanalysis">AFMImage3DModelAnalysis</code></td>
<td>
<p>n <code><a href="#topic+AFMImage3DModelAnalysis">AFMImage3DModelAnalysis</a></code> to store the setup and results of PSD analysis</p>
</td></tr>
<tr><td><code id="calculate3DModel_+3A_afmimage">AFMImage</code></td>
<td>
<p>an <code><a href="#topic+AFMImage">AFMImage</a></code> from Atomic Force Microscopy</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>

<hr>
<h2 id='calculateDirectionalVariograms'>Calculate experimental directional semi-variograms</h2><span id='topic+calculateDirectionalVariograms'></span>

<h3>Description</h3>

<p>calculate four experimental directional variograms of an <code><a href="#topic+AFMImage">AFMImage</a></code> with the <code><a href="gstat.html#topic+variogram">variogram</a></code> function of the gstat package.
The directional semi-variogram can be used to check the isotropy of the sample.
Note: The sample will be isotropic if the slopes of the four variograms are similar.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculateDirectionalVariograms(AFMImageVariogramAnalysis, AFMImage)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calculateDirectionalVariograms_+3A_afmimagevariogramanalysis">AFMImageVariogramAnalysis</code></td>
<td>
<p>an <code><a href="#topic+AFMImageVariogramAnalysis">AFMImageVariogramAnalysis</a></code> to manage and store the result of variogram analysis</p>
</td></tr>
<tr><td><code id="calculateDirectionalVariograms_+3A_afmimage">AFMImage</code></td>
<td>
<p>an <code><a href="#topic+AFMImage">AFMImage</a></code> from Atomic Force Microscopy</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>calculateDirectionalVariograms</code> returns the directional variograms
</p>


<h3>Value</h3>

<p>Four directional variograms
</p>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(AFM)
library(ggplot2)

data(AFMImageOfRegularPeaks)
variogramAnalysis&lt;-AFMImageVariogramAnalysis(sampleFitPercentage=3.43/100)
varios&lt;-AFM::calculateDirectionalVariograms(AFMImage= AFMImageOfRegularPeaks, 
                                            AFMImageVariogramAnalysis= variogramAnalysis)
dist&lt;-gamma&lt;-NULL
p &lt;- ggplot(varios, aes(x=dist, y=gamma,  
                        color= as.factor(dir.hor), 
                        shape=as.factor(dir.hor)))
p &lt;- p + expand_limits(y = 0)
p &lt;- p + geom_point()
p &lt;- p + geom_line()
p &lt;- p + ylab("semivariance (nm^2)")
p &lt;- p + xlab("distance (nm)")
p &lt;- p + ggtitle("Directional")
p

## End(Not run)
</code></pre>

<hr>
<h2 id='calculateGaussianMixture'>Calculate Gaussian Mixture with two components from the AFM Image.</h2><span id='topic+calculateGaussianMixture'></span>

<h3>Description</h3>

<p><code>calculateGaussianMixture</code> return a data.table containing the result of the Gaussian Mixture and result of the test
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculateGaussianMixture(AFMImage)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calculateGaussianMixture_+3A_afmimage">AFMImage</code></td>
<td>
<p>an <code><a href="#topic+AFMImage">AFMImage</a></code> from Atomic Force Microscopy</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(AFM)
data(AFMImageOfNetworks)
mixtureCharacteristics&lt;-calculateGaussianMixture(AFMImageOfNetworks)
print(mixtureCharacteristics)

## End(Not run)
</code></pre>

<hr>
<h2 id='calculateHolesCharacteristics'>get the networks parameters</h2><span id='topic+calculateHolesCharacteristics'></span>

<h3>Description</h3>

<p>Calculate the holes characteristics
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculateHolesCharacteristics(AFMImageNetworksAnalysis)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calculateHolesCharacteristics_+3A_afmimagenetworksanalysis">AFMImageNetworksAnalysis</code></td>
<td>
<p>a <code><a href="#topic+AFMImageNetworksAnalysis">AFMImageNetworksAnalysis</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.table with all the parameters
</p>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>

<hr>
<h2 id='calculateIgraph'>Calculate iGraph from AFMImage</h2><span id='topic+calculateIgraph'></span>

<h3>Description</h3>

<p><code>calculateIgraph</code> return
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculateIgraph(AFMImage, AFMImageNetworksAnalysis)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calculateIgraph_+3A_afmimage">AFMImage</code></td>
<td>
<p>an <code><a href="#topic+AFMImage">AFMImage</a></code> from Atomic Force Microscopy</p>
</td></tr>
<tr><td><code id="calculateIgraph_+3A_afmimagenetworksanalysis">AFMImageNetworksAnalysis</code></td>
<td>
<p>an <code><a href="#topic+AFMImageNetworksAnalysis">AFMImageNetworksAnalysis</a></code> from Atomic Force Microscopy</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>

<hr>
<h2 id='calculateNetworkParameters'>get the networks parameters</h2><span id='topic+calculateNetworkParameters'></span>

<h3>Description</h3>

<p>Calculate and return the networks parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculateNetworkParameters(AFMImageNetworksAnalysis, AFMImage)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calculateNetworkParameters_+3A_afmimagenetworksanalysis">AFMImageNetworksAnalysis</code></td>
<td>
<p>a <code><a href="#topic+AFMImageNetworksAnalysis">AFMImageNetworksAnalysis</a></code></p>
</td></tr>
<tr><td><code id="calculateNetworkParameters_+3A_afmimage">AFMImage</code></td>
<td>
<p>a <code><a href="#topic+AFMImage">AFMImage</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.table with all the parameters
</p>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>

<hr>
<h2 id='calculateNetworks'>Calculate networks on the surface</h2><span id='topic+calculateNetworks'></span><span id='topic+calculateNetworks+2CAFMImageNetworksAnalysis-method'></span><span id='topic+calculateNetworks+2CAFMImage-method'></span>

<h3>Description</h3>

<p><code>calculateNetworks</code> update  <code><a href="#topic+AFMImageNetworksAnalysis">AFMImageNetworksAnalysis</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculateNetworks(AFMImageNetworksAnalysis, AFMImage)

## S4 method for signature 'AFMImageNetworksAnalysis'
calculateNetworks(AFMImageNetworksAnalysis, AFMImage)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calculateNetworks_+3A_afmimagenetworksanalysis">AFMImageNetworksAnalysis</code></td>
<td>
<p>n <code><a href="#topic+AFMImageNetworksAnalysis">AFMImageNetworksAnalysis</a></code> to store the results of networks analysis</p>
</td></tr>
<tr><td><code id="calculateNetworks_+3A_afmimage">AFMImage</code></td>
<td>
<p>an <code><a href="#topic+AFMImage">AFMImage</a></code> from Atomic Force Microscopy</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>

<hr>
<h2 id='calculateNetworkSkeleton'>calculateNetworkSkeleton</h2><span id='topic+calculateNetworkSkeleton'></span>

<h3>Description</h3>

<p><code>calculateNetworkSkeleton</code> return
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculateNetworkSkeleton(AFMImage, AFMImageNetworksAnalysis)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calculateNetworkSkeleton_+3A_afmimage">AFMImage</code></td>
<td>
<p>an <code><a href="#topic+AFMImage">AFMImage</a></code> from Atomic Force Microscopy</p>
</td></tr>
<tr><td><code id="calculateNetworkSkeleton_+3A_afmimagenetworksanalysis">AFMImageNetworksAnalysis</code></td>
<td>
<p>an <code><a href="#topic+AFMImageNetworksAnalysis">AFMImageNetworksAnalysis</a></code> from Atomic Force Microscopy</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>

<hr>
<h2 id='calculateOmnidirectionalVariogram'>Calculate experimental omnidirectional semi-variogram</h2><span id='topic+calculateOmnidirectionalVariogram'></span>

<h3>Description</h3>

<p><code>calculateOmnidirectionalVariogram</code> returns the semivariance calculated for all the directions
calculate the experimental omnidirectional variogram of an <code><a href="#topic+AFMImage">AFMImage</a></code> with the <code><a href="gstat.html#topic+variogram">variogram</a></code> function of the gstat package.
The experimental semi-variogram is used to fit (find the best sill and range) the theoretical variogram models.
With 512*512 images, it takes several minutes to calculate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculateOmnidirectionalVariogram(AFMImageVariogramAnalysis, AFMImage)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calculateOmnidirectionalVariogram_+3A_afmimagevariogramanalysis">AFMImageVariogramAnalysis</code></td>
<td>
<p>an <code><a href="#topic+AFMImageVariogramAnalysis">AFMImageVariogramAnalysis</a></code> to manage and store the result of variogram analysis</p>
</td></tr>
<tr><td><code id="calculateOmnidirectionalVariogram_+3A_afmimage">AFMImage</code></td>
<td>
<p>an <code><a href="#topic+AFMImage">AFMImage</a></code> from Atomic Force Microscopy</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the semivariance calculated in all the directions
</p>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(AFM)
library(ggplot2)

data(AFMImageOfRegularPeaks)
variogramAnalysis&lt;-AFMImageVariogramAnalysis(sampleFitPercentage=3.43/100)
avario&lt;-AFM::calculateOmnidirectionalVariogram(AFMImageVariogramAnalysis= variogramAnalysis, 
                                               AFMImage= AFMImageOfRegularPeaks)
dist&lt;-gamma&lt;-NULL
p &lt;- ggplot(avario, aes(x=dist, y=gamma))
p &lt;- p + geom_point()
p &lt;- p + geom_line()
p &lt;- p + ylab("semivariance")
p &lt;- p + xlab("distance (nm)")
p &lt;- p + ggtitle("Experimental semivariogram")
p

## End(Not run)
</code></pre>

<hr>
<h2 id='calculatePhysicalDistanceFromPath'>calculate the physical distances between nodes</h2><span id='topic+calculatePhysicalDistanceFromPath'></span>

<h3>Description</h3>

<p>calculate the physical distances between nodes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculatePhysicalDistanceFromPath(pathVidVector, hscale, vscale)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calculatePhysicalDistanceFromPath_+3A_pathvidvector">pathVidVector</code></td>
<td>
<p>a network path</p>
</td></tr>
<tr><td><code id="calculatePhysicalDistanceFromPath_+3A_hscale">hscale</code></td>
<td>
<p>the hscale of the <code><a href="#topic+AFMImage">AFMImage</a></code> from Atomic Force Microscopy</p>
</td></tr>
<tr><td><code id="calculatePhysicalDistanceFromPath_+3A_vscale">vscale</code></td>
<td>
<p>the vscale of the <code><a href="#topic+AFMImage">AFMImage</a></code> from Atomic Force Microscopy</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the physical distance the extrmities of the path
</p>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>

<hr>
<h2 id='calculateShortestPaths'>calculate the  shortest path between adjacent nodes</h2><span id='topic+calculateShortestPaths'></span>

<h3>Description</h3>

<p>Calculate the shortest path between all nodes of degree different to 2
that are connected with nodes of degree equal to 2
Calculate the distance between the above nodes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculateShortestPaths(..., AFMImageNetworksAnalysis)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calculateShortestPaths_+3A_...">...</code></td>
<td>
<p>cl: a cluster object from the parallel package</p>
</td></tr>
<tr><td><code id="calculateShortestPaths_+3A_afmimagenetworksanalysis">AFMImageNetworksAnalysis</code></td>
<td>
<p>a <code><a href="#topic+AFMImageNetworksAnalysis">AFMImageNetworksAnalysis</a></code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>

<hr>
<h2 id='canBeRemoved'>canBeRemoved</h2><span id='topic+canBeRemoved'></span>

<h3>Description</h3>

<p><code>canBeRemoved</code> return
</p>


<h3>Usage</h3>

<pre><code class='language-R'>canBeRemoved(vertexId, g, allVertices, DEGREE_LIMIT_FOR_CANDIDATE_VERTICE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="canBeRemoved_+3A_vertexid">vertexId</code></td>
<td>
<p>a vertex id</p>
</td></tr>
<tr><td><code id="canBeRemoved_+3A_g">g</code></td>
<td>
<p>a igraph</p>
</td></tr>
<tr><td><code id="canBeRemoved_+3A_allvertices">allVertices</code></td>
<td>
<p>list of all vertices</p>
</td></tr>
<tr><td><code id="canBeRemoved_+3A_degree_limit_for_candidate_vertice">DEGREE_LIMIT_FOR_CANDIDATE_VERTICE</code></td>
<td>
<p>degree</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>

<hr>
<h2 id='checkIsotropy'>Check the isotropy of a sample</h2><span id='topic+checkIsotropy'></span>

<h3>Description</h3>

<p><code>checkIsotropy</code> is used to check the isotropy of an <code><a href="#topic+AFMImage">AFMImage</a></code>. 
A directional variogram is calculated for various directions. 
If the variogram is very similar for all the directions then the sample is isotropic.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>checkIsotropy(AFMImage, AFMImageAnalyser)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="checkIsotropy_+3A_afmimage">AFMImage</code></td>
<td>
<p>an <code><a href="#topic+AFMImage">AFMImage</a></code> to be analysed</p>
</td></tr>
<tr><td><code id="checkIsotropy_+3A_afmimageanalyser">AFMImageAnalyser</code></td>
<td>
<p>an <code><a href="#topic+AFMImageAnalyser">AFMImageAnalyser</a></code> to perform the analysis</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an <code><a href="#topic+AFMImageAnalyser">AFMImageAnalyser</a></code> containing the directional variograms
</p>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(AFM)
library(ggplot2)

data(AFMImageOfAluminiumInterface)
AFMImage&lt;-extractAFMImage(AFMImageOfAluminiumInterface, 0, 0, 32)
AFMImageAnalyser&lt;-new("AFMImageAnalyser", AFMImage= AFMImage, fullfilename = AFMImage@fullfilename)
AFMImageAnalyser&lt;-checkIsotropy(AFMImage,AFMImageAnalyser)
varios&lt;-AFMImageAnalyser@variogramAnalysis@directionalVariograms
p2 &lt;- ggplot(varios, aes(x=dist, y=gamma,  
                         color= as.factor(dir.hor), shape=as.factor(dir.hor)))
p2 &lt;- p2 + expand_limits(y = 0)
p2 &lt;- p2 + geom_point()
p2 &lt;- p2 + geom_line()
p2 &lt;- p2 + ylab("semivariance (nm^2)")
p2 &lt;- p2 + xlab("distance (nm)")
p2 &lt;- p2 + ggtitle("Directional")
p2

## End(Not run)

</code></pre>

<hr>
<h2 id='checkNormality'>Check visualy of the normality of the sample</h2><span id='topic+checkNormality'></span>

<h3>Description</h3>

<p><code>checkNormality</code> performs a visual check to know if the distribution of heights of an <code><a href="#topic+AFMImage">AFMImage</a></code> follows a normal distribution. The function displays Quantile/Quantile and distribution plots.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>checkNormality(..., AFMImage)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="checkNormality_+3A_...">...</code></td>
<td>
<p>pngfullfilename (optional): directory and filename to save the visual check to png or pdffullfilename(optional): directory and filename to save the visual check to pdf</p>
</td></tr>
<tr><td><code id="checkNormality_+3A_afmimage">AFMImage</code></td>
<td>
<p>an <code><a href="#topic+AFMImage">AFMImage</a></code> from Atomic Force Microscopy</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>


<h3>References</h3>

<p>Olea2006, Ricardo A. Olea &quot;A six-step practical approach to semivariogram modeling&quot;, 2006, &quot;Stochastic Environmental Research and Risk Assessment, Volume 20, Issue 5 , pp 307-318&quot;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(AFM)

# display Quantile/Quantile and distribution plots.
  data(AFMImageOfNormallyDistributedHeights)
  checkNormality(AFMImage= AFMImageOfNormallyDistributedHeights)

# display and save on disk Quantile/Quantile and distribution plots.
  data(AFMImageOfNormallyDistributedHeights)
  checkNormality(AFMImage= AFMImageOfNormallyDistributedHeights, 
                 pngfullfilename=paste(tempdir(), "checkNormality.png", sep="/"))

## End(Not run)
</code></pre>

<hr>
<h2 id='createGraph'>create the igraph weighted graph from the nodes and edges</h2><span id='topic+createGraph'></span>

<h3>Description</h3>

<p>create the igraph weighted graph from the nodes and edges
</p>


<h3>Usage</h3>

<pre><code class='language-R'>createGraph(AFMImageNetworksAnalysis)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="createGraph_+3A_afmimagenetworksanalysis">AFMImageNetworksAnalysis</code></td>
<td>
<p>a <code><a href="#topic+AFMImageNetworksAnalysis">AFMImageNetworksAnalysis</a></code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>

<hr>
<h2 id='displayColoredNetworkWithVerticesSize'>displayColoredNetworkWithVerticesSize</h2><span id='topic+displayColoredNetworkWithVerticesSize'></span>

<h3>Description</h3>

<p>display network
</p>


<h3>Usage</h3>

<pre><code class='language-R'>displayColoredNetworkWithVerticesSize(AFMImageNetworksAnalysis, fullfilename)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="displayColoredNetworkWithVerticesSize_+3A_afmimagenetworksanalysis">AFMImageNetworksAnalysis</code></td>
<td>
<p>a <code><a href="#topic+AFMImageNetworksAnalysis">AFMImageNetworksAnalysis</a></code></p>
</td></tr>
<tr><td><code id="displayColoredNetworkWithVerticesSize_+3A_fullfilename">fullfilename</code></td>
<td>
<p>a directory plus filename for export</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>

<hr>
<h2 id='displaygridIgraphPlot'>display the network of nodes and edges</h2><span id='topic+displaygridIgraphPlot'></span>

<h3>Description</h3>

<p>display the network of nodes and edges
</p>


<h3>Usage</h3>

<pre><code class='language-R'>displaygridIgraphPlot(AFMImageNetworksAnalysis)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="displaygridIgraphPlot_+3A_afmimagenetworksanalysis">AFMImageNetworksAnalysis</code></td>
<td>
<p>an <code><a href="#topic+AFMImageNetworksAnalysis">AFMImageNetworksAnalysis</a></code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>

<hr>
<h2 id='displaygridIgraphPlotFromEdges'>display the network of nodes and edges</h2><span id='topic+displaygridIgraphPlotFromEdges'></span>

<h3>Description</h3>

<p>display the network of nodes and edges
</p>


<h3>Usage</h3>

<pre><code class='language-R'>displaygridIgraphPlotFromEdges(AFMImage, edges, isolates)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="displaygridIgraphPlotFromEdges_+3A_afmimage">AFMImage</code></td>
<td>
<p>an <code><a href="#topic+AFMImage">AFMImage</a></code> from Atomic Force Microscopy</p>
</td></tr>
<tr><td><code id="displaygridIgraphPlotFromEdges_+3A_edges">edges</code></td>
<td>
<p>list of edges</p>
</td></tr>
<tr><td><code id="displaygridIgraphPlotFromEdges_+3A_isolates">isolates</code></td>
<td>
<p>list of isolated edges</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>

<hr>
<h2 id='displayHolesIn3D'>Display a 3D image of the holes in an AFMImage and store it on disk.</h2><span id='topic+displayHolesIn3D'></span>

<h3>Description</h3>

<p>Display a 3D image of  the holes in an AFMImage and store it on disk if fullfilename variable is set.
It uses the <code>rgl</code> package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>displayHolesIn3D(AFMImage, width, fullfilename, changeViewpoint, noLight)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="displayHolesIn3D_+3A_afmimage">AFMImage</code></td>
<td>
<p>the AFM image to be displayed in three dimensions.</p>
</td></tr>
<tr><td><code id="displayHolesIn3D_+3A_width">width</code></td>
<td>
<p>(optional)  width of the image. Default is 512 pixels. Note: width can't be superior to screen resolution.</p>
</td></tr>
<tr><td><code id="displayHolesIn3D_+3A_fullfilename">fullfilename</code></td>
<td>
<p>(optional) the directory and filename to save the png of the 3D image. If this variable is missing, the function will not save on disk the 3D image.</p>
</td></tr>
<tr><td><code id="displayHolesIn3D_+3A_changeviewpoint">changeViewpoint</code></td>
<td>
<p>(optional) if TRUE, the viewpoint is changed. Default is TRUE.</p>
</td></tr>
<tr><td><code id="displayHolesIn3D_+3A_nolight">noLight</code></td>
<td>
<p>if TRUE, the ligth is set off</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>

<hr>
<h2 id='displayIn3D'>Display a 3D image of an AFMImage and store it on disk.</h2><span id='topic+displayIn3D'></span>

<h3>Description</h3>

<p>Display a 3D image of an AFMImage and store it on disk if fullfilename variable is set.
It uses the <code>rgl</code> package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>displayIn3D(AFMImage, width, fullfilename, changeViewpoint, noLight)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="displayIn3D_+3A_afmimage">AFMImage</code></td>
<td>
<p>the AFM image to be displayed in three dimensions.</p>
</td></tr>
<tr><td><code id="displayIn3D_+3A_width">width</code></td>
<td>
<p>(optional)  width of the image. Default is 512 pixels. Note: width can't be superior to screen resolution.</p>
</td></tr>
<tr><td><code id="displayIn3D_+3A_fullfilename">fullfilename</code></td>
<td>
<p>(optional) the directory and filename to save the png of the 3D image. If this variable is missing, the function will not save on disk the 3D image.</p>
</td></tr>
<tr><td><code id="displayIn3D_+3A_changeviewpoint">changeViewpoint</code></td>
<td>
<p>(optional) if TRUE, the viewpoint is changed. Default is TRUE.</p>
</td></tr>
<tr><td><code id="displayIn3D_+3A_nolight">noLight</code></td>
<td>
<p>if TRUE, the ligth is set off</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>

<hr>
<h2 id='dnormalmix'>dnormalmix density of a mixture of normals</h2><span id='topic+dnormalmix'></span>

<h3>Description</h3>

<p>dnormalmix density of a mixture of normals
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dnormalmix(x, mixture, log = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dnormalmix_+3A_x">x</code></td>
<td>
<p>a vector of quantiles</p>
</td></tr>
<tr><td><code id="dnormalmix_+3A_mixture">mixture</code></td>
<td>
<p>a gaussian mixture</p>
</td></tr>
<tr><td><code id="dnormalmix_+3A_log">log</code></td>
<td>
<p>perform a log transsformation of the result</p>
</td></tr>
</table>

<hr>
<h2 id='evaluateVariogramModels'>evaluateVariogramModels method to evaluate the basic variogram models</h2><span id='topic+evaluateVariogramModels'></span><span id='topic+evaluateVariogramModels+2CAFMImageVariogramAnalysis-method'></span>

<h3>Description</h3>

<p>evaluateVariogramModels method to evaluate the basic variogram models available in the <code>gstat</code> package
A <code><a href="#topic+AFMImageVariogramAnalysis">AFMImageVariogramAnalysis</a></code> method to handle the variogram analysis of an <code><a href="#topic+AFMImage">AFMImage</a></code>.
The variogram models used can be seen with the show.vgms() function from the <code>gstat</code> package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>evaluateVariogramModels(AFMImageVariogramAnalysis, AFMImage)

## S4 method for signature 'AFMImageVariogramAnalysis'
evaluateVariogramModels(AFMImageVariogramAnalysis, AFMImage)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="evaluateVariogramModels_+3A_afmimagevariogramanalysis">AFMImageVariogramAnalysis</code></td>
<td>
<p>an object</p>
</td></tr>
<tr><td><code id="evaluateVariogramModels_+3A_afmimage">AFMImage</code></td>
<td>
<p>an <code><a href="#topic+AFMImage">AFMImage</a></code></p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(AFM)

data("AFMImageOfRegularPeaks")
# take an extract of the image to fasten the calculation      
AFMImage&lt;-extractAFMImage(AFMImageOfRegularPeaks, 40, 40, 32)
# e.g. AFMImage@fullfilename&lt;-"/users/ubuntu/AFMImageOfRegularPeaks-extract.txt"
AFMImage@fullfilename&lt;-paste(tempdir(), "AFMImageOfRegularPeaks-extract.txt", sep="/")
 
AFMImageAnalyser&lt;-AFMImageAnalyser(AFMImage)
 
 # Variogram analysis 
sampleFitPercentage&lt;-3.43/100
variogramAnalysis&lt;-AFMImageVariogramAnalysis(sampleFitPercentage)
variogramAnalysis@omnidirectionalVariogram&lt;- 
              AFM::calculateOmnidirectionalVariogram(AFMImage=AFMImage,
                                                     AFMImageVariogramAnalysis=variogramAnalysis)
variogramAnalysis@directionalVariograms&lt;- 
              AFM::calculateDirectionalVariograms(AFMImage=AFMImage,
                                                 AFMImageVariogramAnalysis=variogramAnalysis)
 
# manage model evaluations
AFMImageVariogram&lt;-variogramAnalysis@omnidirectionalVariogram
class(AFMImageVariogram)=c("gstatVariogram","data.frame")
variogramAnalysis&lt;-evaluateVariogramModels(variogramAnalysis, AFMImage)

mergedDT&lt;-getDTModelEvaluation(variogramAnalysis)
mergedDT
sillRangeDT&lt;-getDTModelSillRange(variogramAnalysis)
sillRangeDT

## End(Not run)

</code></pre>

<hr>
<h2 id='existsEdge'>Does an edge exist ?</h2><span id='topic+existsEdge'></span>

<h3>Description</h3>

<p><code>existsEdge</code> return TRUE if an edge exists for this vertex id
</p>


<h3>Usage</h3>

<pre><code class='language-R'>existsEdge(AFMImage, vertexId)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="existsEdge_+3A_afmimage">AFMImage</code></td>
<td>
<p>an <code><a href="#topic+AFMImage">AFMImage</a></code> from Atomic Force Microscopy</p>
</td></tr>
<tr><td><code id="existsEdge_+3A_vertexid">vertexId</code></td>
<td>
<p>the vertex id</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>

<hr>
<h2 id='existsSegment'>existsSegment checks if a segment exists in an AFMImage; check if all the heights at the segment coordinates are different to zero.</h2><span id='topic+existsSegment'></span>

<h3>Description</h3>

<p><code>existsSegment</code> return a boolean
</p>


<h3>Usage</h3>

<pre><code class='language-R'>existsSegment(AFMImage, segment)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="existsSegment_+3A_afmimage">AFMImage</code></td>
<td>
<p>a <code><a href="#topic+AFMImage">AFMImage</a></code> from Atomic Force Microscopy or a binary <code><a href="#topic+AFMImage">AFMImage</a></code></p>
</td></tr>
<tr><td><code id="existsSegment_+3A_segment">segment</code></td>
<td>
<p>a data.table coming from the getBresenham2Dsegment - x and y should start from 1,1 #TODO Segment class</p>
</td></tr>
</table>


<h3>Value</h3>

<p>TRUE if all the heights of the segment are different from zero
</p>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>

<hr>
<h2 id='exportToSTL'>Export an AFM Image as a STL format file.</h2><span id='topic+exportToSTL'></span>

<h3>Description</h3>

<p>Export an <code><a href="#topic+AFMImage">AFMImage</a></code> as a STL format file thanks to the <code>rgl</code> package. The STL file can be used as an input for a 3D printing software tool.<br /><br />
exportToSTL is compatible with slicr (http://slic3r.org) version 1.2.9 (GPL v3 licence).<br />
In order to 3D print the AFM Image with slic3r, do as following:
</p>

<ul>
<li><p> Use &quot;File&gt; Repair STL file...&quot; menu option to create a file with the obj extension.
</p>
</li>
<li><p> Use &quot;Add&quot; button below the menu to display your AFM Image on the print board
</p>
</li>
<li><p> Right click on your AFM image. Use &quot;Scale&gt; uniformely&quot; option, Set &quot;15
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>exportToSTL(AFMImage3DModelAnalysis, AFMImage, stlfullfilename)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="exportToSTL_+3A_afmimage3dmodelanalysis">AFMImage3DModelAnalysis</code></td>
<td>
<p>an <code><a href="#topic+AFMImage3DModelAnalysis">AFMImage3DModelAnalysis</a></code></p>
</td></tr>
<tr><td><code id="exportToSTL_+3A_afmimage">AFMImage</code></td>
<td>
<p>an <code><a href="#topic+AFMImage">AFMImage</a></code> from Atomic Force Microscopy</p>
</td></tr>
<tr><td><code id="exportToSTL_+3A_stlfullfilename">stlfullfilename</code></td>
<td>
<p>directory and filename to save as a stl file</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(AFM)
data("AFMImageOfRegularPeaks")
AFMImage&lt;-AFMImageOfRegularPeaks
# calculate the 3D model : surface and the faces
AFMImage3DModelAnalysis&lt;-new ("AFMImage3DModelAnalysis")
AFMImage3DModelAnalysis&lt;-calculate3DModel(AFMImage3DModelAnalysis= AFMImage3DModelAnalysis,
                                          AFMImage= AFMImage)
# export the 3D model to file
exportDirectory=tempdir()
print(paste("saving model in ", exportDirectory))
exportToSTL(AFMImage3DModelAnalysis=AFMImage3DModelAnalysis,
            AFMImage=AFMImage, 
            stlfullfilename=paste(exportDirectory, "myFile.stl", sep="/"))

## End(Not run)
</code></pre>

<hr>
<h2 id='extractAFMImage'>Extract a portion of an AFM image.</h2><span id='topic+extractAFMImage'></span>

<h3>Description</h3>

<p>The extract will be a square of the specified size.
If the size is too large for the original <code><a href="#topic+AFMImage">AFMImage</a></code>, only the biggest valid size will be kept.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extractAFMImage(AFMImage, cornerX, cornerY, size)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extractAFMImage_+3A_afmimage">AFMImage</code></td>
<td>
<p>an <code><a href="#topic+AFMImage">AFMImage</a></code> from Atomic Force Microscopy</p>
</td></tr>
<tr><td><code id="extractAFMImage_+3A_cornerx">cornerX</code></td>
<td>
<p>horizontal coordinates of the extract</p>
</td></tr>
<tr><td><code id="extractAFMImage_+3A_cornery">cornerY</code></td>
<td>
<p>vertical coordinates of the extract</p>
</td></tr>
<tr><td><code id="extractAFMImage_+3A_size">size</code></td>
<td>
<p>square size of the extract in number of pixels</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>extractAFMImage</code> returns an extract of the AFMImage
</p>


<h3>Value</h3>

<p>a new  <code><a href="#topic+AFMImage">AFMImage</a></code> sample
</p>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  data(AFMImageOfAluminiumInterface)
  anAFMImageExtract&lt;-extractAFMImage(AFMImageOfAluminiumInterface,15,15,256)

## End(Not run)

</code></pre>

<hr>
<h2 id='filterAFMImage'>filter the heights of an AFMImage with a minimun and a maximum value</h2><span id='topic+filterAFMImage'></span>

<h3>Description</h3>

<p><code>filterAFMImage</code> returns a filtered AFMImage
</p>


<h3>Usage</h3>

<pre><code class='language-R'>filterAFMImage(AFMImage, Min, Max)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="filterAFMImage_+3A_afmimage">AFMImage</code></td>
<td>
<p>an <code><a href="#topic+AFMImage">AFMImage</a></code> from Atomic Force Microscopy</p>
</td></tr>
<tr><td><code id="filterAFMImage_+3A_min">Min</code></td>
<td>
<p>the minimun height value to keep</p>
</td></tr>
<tr><td><code id="filterAFMImage_+3A_max">Max</code></td>
<td>
<p>the maximun height value to keep</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an <code><a href="#topic+AFMImage">AFMImage</a></code>
</p>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>

<hr>
<h2 id='fusionCloseNodes'>fusion the nodes that are intersecting</h2><span id='topic+fusionCloseNodes'></span>

<h3>Description</h3>

<p>manage the fusion of nodes which circles instersect
keep all the circles, manage a fusion table
node id / fusion id
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fusionCloseNodes(AFMImageNetworksAnalysis)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fusionCloseNodes_+3A_afmimagenetworksanalysis">AFMImageNetworksAnalysis</code></td>
<td>
<p>the AFMImageNetworksAnalysis instance</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of edges with fusioned nodes
</p>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>

<hr>
<h2 id='generateAFMImageReport'>Generate an analysis report from an AFMImageAnalyser object</h2><span id='topic+generateAFMImageReport'></span>

<h3>Description</h3>

<p><code>generateAFMImageReport</code> generates a report from an AFMImageAnalyser object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>generateAFMImageReport(AFMImageAnalyser, reportFullfilename, isCheckReport)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="generateAFMImageReport_+3A_afmimageanalyser">AFMImageAnalyser</code></td>
<td>
<p>an <code><a href="#topic+AFMImageAnalyser">AFMImageAnalyser</a></code> to be used to produce report</p>
</td></tr>
<tr><td><code id="generateAFMImageReport_+3A_reportfullfilename">reportFullfilename</code></td>
<td>
<p>location on disk where to save the generated report</p>
</td></tr>
<tr><td><code id="generateAFMImageReport_+3A_ischeckreport">isCheckReport</code></td>
<td>
<p>TRUE to generate a check report must be generated, FALSE to generate a full report</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>

<hr>
<h2 id='generateCheckReport'>Generate a check report for one AFMImage</h2><span id='topic+generateCheckReport'></span>

<h3>Description</h3>

<p>Generate a check report in pdf format in order to analyse the distribution and the isotropy of heights of the <code><a href="#topic+AFMImage">AFMImage</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>generateCheckReport(AFMImage)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="generateCheckReport_+3A_afmimage">AFMImage</code></td>
<td>
<p>an <code><a href="#topic+AFMImage">AFMImage</a></code> imported from Nanoscope Analysis(TM) with <code><a href="#topic+importFromNanoscope">importFromNanoscope</a></code> or created manually <code><a href="#topic+AFMImage">AFMImage</a></code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(AFM)

# Analyse the AFMImageOfRegularPeaks AFMImage sample from this package
  data("AFMImageOfRegularPeaks")
  AFMImage&lt;-AFMImageOfRegularPeaks
# exportDirectory="C:/Users/my_windows_login" or exportDirectory="/home/ubuntu"
  exportDirectory=tempdir()
  AFMImage@fullfilename&lt;-paste(exportDirectory,"AFMImageOfRegularPeaks.txt",sep="/")
  
# Start to check if your sample is normaly distributed and isotropic.
  generateCheckReport(AFMImage)
# If the sample is normaly distributed and isotropic, generate a full report
  generateReport(AFMImage)

# Analyse your own AFM image from nanoscope analysis (TM) software tool
   anotherAFMImage&lt;-importFromNanoscope("c:/users/me/myimage.txt")
# Start to check if your sample is normaly distributed and isotropic.
   generateCheckReport(anotherAFMImage)
# If your sample is normaly distributed and isotropic, generate a full report
   generateReport(anotherAFMImage)

## End(Not run)
</code></pre>

<hr>
<h2 id='generatePolygonEnvelope'>generatePolygonEnvelope</h2><span id='topic+generatePolygonEnvelope'></span>

<h3>Description</h3>

<p>generate a convex polygon from circles
</p>


<h3>Usage</h3>

<pre><code class='language-R'>generatePolygonEnvelope(AFMImageNetworksAnalysis, centers, radius)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="generatePolygonEnvelope_+3A_afmimagenetworksanalysis">AFMImageNetworksAnalysis</code></td>
<td>
<p>a <code><a href="#topic+AFMImageNetworksAnalysis">AFMImageNetworksAnalysis</a></code></p>
</td></tr>
<tr><td><code id="generatePolygonEnvelope_+3A_centers">centers</code></td>
<td>
<p>a matrix ?</p>
</td></tr>
<tr><td><code id="generatePolygonEnvelope_+3A_radius">radius</code></td>
<td>
<p>a vector of radius</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a polygon
</p>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>

<hr>
<h2 id='generateReport'>Generate an analysis report for one AFMImage</h2><span id='topic+generateReport'></span>

<h3>Description</h3>

<p>A function to analyse an <code><a href="#topic+AFMImage">AFMImage</a></code> and save on disk the analysis. The analysis are saved in outputs directory located in the image directory.
All the rdata and image files in the reportDirectory directory are loaded to generate one report for one <code><a href="#topic+AFMImage">AFMImage</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>generateReport(AFMImage)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="generateReport_+3A_afmimage">AFMImage</code></td>
<td>
<p>an <code><a href="#topic+AFMImage">AFMImage</a></code> to be analysed</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(AFM)

# Analyse the AFMImageOfRegularPeaks AFMImage sample from this package
  data("AFMImageOfRegularPeaks")
  AFMImage&lt;-AFMImageOfRegularPeaks

# exportDirectory="C:/Users/my_windows_login" or exportDirectory="/home/ubuntu"
  exportDirectory=tempdir()
  AFMImage@fullfilename&lt;-paste(exportDirectory,"AFMImageOfRegularPeaks.txt",sep="/")
  
# Start to check if your sample is normaly distributed and isotropic.
  generateCheckReport(AFMImage)
# If the sample is normaly distributed and isotropic, generate a full report
  generateReport(AFMImage)


# Analyse your own AFM image from nanoscope analysis (TM) software tool
   anotherAFMImage&lt;-importFromNanoscope("c:/users/my_windows_login/myimage.txt")
# Start to check if your sample is normaly distributed and isotropic.
   generateCheckReport(anotherAFMImage)
# If your sample is normaly distributed and isotropic, generate a full report
   generateReport(anotherAFMImage)

## End(Not run)
</code></pre>

<hr>
<h2 id='generateReportFromNanoscopeImageDirectory'>Generate a pdf report for all AFM images in a directory</h2><span id='topic+generateReportFromNanoscopeImageDirectory'></span>

<h3>Description</h3>

<p>A function to generate a pdf report for each <code><a href="#topic+AFMImage">AFMImage</a></code> in a directory. Images should be in export Nanoscope format as the <code><a href="#topic+importFromNanoscope">importFromNanoscope</a></code> function will be used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>generateReportFromNanoscopeImageDirectory(imageDirectory, imageNumber)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="generateReportFromNanoscopeImageDirectory_+3A_imagedirectory">imageDirectory</code></td>
<td>
<p>a directory where are located image as Nanoscope export format</p>
</td></tr>
<tr><td><code id="generateReportFromNanoscopeImageDirectory_+3A_imagenumber">imageNumber</code></td>
<td>
<p>(optional) an image number in the directory. If it is set only the selected image will be processed.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(AFM)
# A report will be generated for all the images in imageDirectory directory
# imageDirectory="c:/images"
imageDirectory=tempdir()
exit&lt;-generateReportFromNanoscopeImageDirectory(imageDirectory)

# A report will be generated for the fifth image in the imageDirectory directory
exit&lt;-generateReportFromNanoscopeImageDirectory(imageDirectory,5)

## End(Not run)
</code></pre>

<hr>
<h2 id='get3DImageFullfilename'>get 3D image full filename</h2><span id='topic+get3DImageFullfilename'></span>

<h3>Description</h3>

<p>get 3D image full filename
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get3DImageFullfilename(exportDirectory, imageName)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get3DImageFullfilename_+3A_exportdirectory">exportDirectory</code></td>
<td>
<p>a diretcory to export image</p>
</td></tr>
<tr><td><code id="get3DImageFullfilename_+3A_imagename">imageName</code></td>
<td>
<p>the image name</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>

<hr>
<h2 id='getAllPointsToRemove'>getAllPointsToRemove</h2><span id='topic+getAllPointsToRemove'></span>

<h3>Description</h3>

<p>get the points inside envelope
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getAllPointsToRemove(AFMImageNetworksAnalysis, envelope)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getAllPointsToRemove_+3A_afmimagenetworksanalysis">AFMImageNetworksAnalysis</code></td>
<td>
<p>a <code><a href="#topic+AFMImageNetworksAnalysis">AFMImageNetworksAnalysis</a></code></p>
</td></tr>
<tr><td><code id="getAllPointsToRemove_+3A_envelope">envelope</code></td>
<td>
<p>an envelope of points ?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.table of points
</p>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>

<hr>
<h2 id='getAngle'>calculate the angle between two vectors</h2><span id='topic+getAngle'></span>

<h3>Description</h3>

<p>calculate the angle between two vectors
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getAngle(x, y)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getAngle_+3A_x">x</code></td>
<td>
<p>a vector</p>
</td></tr>
<tr><td><code id="getAngle_+3A_y">y</code></td>
<td>
<p>a vector</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the angle between the vectors
</p>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>

<hr>
<h2 id='getAutoIntersectionForOmnidirectionalVariogram'>Calculate slopes and intersections in variogram
<code>getAutoIntersectionForOmnidirectionalVariogram</code> returns the slope in the omnidirectional variograms</h2><span id='topic+getAutoIntersectionForOmnidirectionalVariogram'></span>

<h3>Description</h3>

<p>Calculate slopes and intersections in variogram
<code>getAutoIntersectionForOmnidirectionalVariogram</code> returns the slope in the omnidirectional variograms
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getAutoIntersectionForOmnidirectionalVariogram(AFMImageAnalyser)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getAutoIntersectionForOmnidirectionalVariogram_+3A_afmimageanalyser">AFMImageAnalyser</code></td>
<td>
<p>an <code><a href="#topic+AFMImageAnalyser">AFMImageAnalyser</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>an <code><a href="#topic+omniVariogramSlopeAnalysis">omniVariogramSlopeAnalysis</a></code>
</p>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>

<hr>
<h2 id='getAutoIntersectionForRoughnessAgainstLengthscale'>get the intersection between tangente and plateau</h2><span id='topic+getAutoIntersectionForRoughnessAgainstLengthscale'></span>

<h3>Description</h3>

<p><code><a href="#topic+getAutoIntersectionForRoughnessAgainstLengthscale">getAutoIntersectionForRoughnessAgainstLengthscale</a></code> get the intersection between tangente and plateau
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getAutoIntersectionForRoughnessAgainstLengthscale(
  AFMImageAnalyser,
  second_slope = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getAutoIntersectionForRoughnessAgainstLengthscale_+3A_afmimageanalyser">AFMImageAnalyser</code></td>
<td>
<p>an <code><a href="#topic+AFMImageAnalyser">AFMImageAnalyser</a></code> to get Roughness against lenghtscale calculation</p>
</td></tr>
<tr><td><code id="getAutoIntersectionForRoughnessAgainstLengthscale_+3A_second_slope">second_slope</code></td>
<td>
<p>a boolean to manage first or second slope in the roughness against lenghtscale curve</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code><a href="#topic+AFMImagePSDSlopesAnalysis">AFMImagePSDSlopesAnalysis</a></code>
</p>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>

<hr>
<h2 id='getAutomaticWidthForVariogramCalculation'>calculate a width to be used for experimental variogram calculation</h2><span id='topic+getAutomaticWidthForVariogramCalculation'></span>

<h3>Description</h3>

<p>calculate a width to be used for experimental variogram calculation in order to generate a line
instead of a cloud of points. If the chosen width is too small, the experimental variogram will
be a cloud of points instead of a line.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getAutomaticWidthForVariogramCalculation(AFMImage)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getAutomaticWidthForVariogramCalculation_+3A_afmimage">AFMImage</code></td>
<td>
<p>an <code><a href="#topic+AFMImage">AFMImage</a></code> from Atomic Force Microscopy</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>getAutomaticWidthForVariogramCalculation</code> returns the width to be used for variogram calculation
</p>


<h3>Value</h3>

<p>the smallest width to be used for variogram calculation
</p>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(AFM)

data(AFMImageOfAluminiumInterface)
print(getAutomaticWidthForVariogramCalculation(AFMImageOfAluminiumInterface))

## End(Not run)

</code></pre>

<hr>
<h2 id='getBresenham2DSegment'>get a segment of points thanks to Bresenham line algorithm</h2><span id='topic+getBresenham2DSegment'></span>

<h3>Description</h3>

<p><code>getBresenham2DSegment</code> return the Bresenham segment in 2D from extremities coordinates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getBresenham2DSegment(x1, y1, x2, y2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getBresenham2DSegment_+3A_x1">x1</code></td>
<td>
<p>abscissa coordinates of the first point</p>
</td></tr>
<tr><td><code id="getBresenham2DSegment_+3A_y1">y1</code></td>
<td>
<p>ordinate coordinates of the first point</p>
</td></tr>
<tr><td><code id="getBresenham2DSegment_+3A_x2">x2</code></td>
<td>
<p>abscissa coordinates of the second point</p>
</td></tr>
<tr><td><code id="getBresenham2DSegment_+3A_y2">y2</code></td>
<td>
<p>ordinate coordinates of the second point</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.table of points - data.table(x, y)
</p>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>

<hr>
<h2 id='getCircleSpatialPoints'>get the spatial points on the circle including the center of the circle</h2><span id='topic+getCircleSpatialPoints'></span>

<h3>Description</h3>

<p>get the spatial points on the circle including the center of the circle
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getCircleSpatialPoints(binaryAFMImage, center, circleRadius)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getCircleSpatialPoints_+3A_binaryafmimage">binaryAFMImage</code></td>
<td>
<p>a binary <code><a href="#topic+AFMImage">AFMImage</a></code> from Atomic Force Microscopy</p>
</td></tr>
<tr><td><code id="getCircleSpatialPoints_+3A_center">center</code></td>
<td>
<p>the center of the circle with center$lon as the x coordinates and center$lat as the y coordinates</p>
</td></tr>
<tr><td><code id="getCircleSpatialPoints_+3A_circleradius">circleRadius</code></td>
<td>
<p>the radius of the circle</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>SpatialPoints</code> object of all the points of the circle including the center of the circle
</p>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>

<hr>
<h2 id='getCoordinatesFromVertexId'>Get x,y coordinates from vertex id</h2><span id='topic+getCoordinatesFromVertexId'></span>

<h3>Description</h3>

<p><code>getCoordinatesFromVertexId</code> return a list x,y coordinates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getCoordinatesFromVertexId(vId)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getCoordinatesFromVertexId_+3A_vid">vId</code></td>
<td>
<p>the vertex id</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>

<hr>
<h2 id='getDTModelEvaluation'>getDTModelEvaluation method</h2><span id='topic+getDTModelEvaluation'></span><span id='topic+getDTModelEvaluation+2CAFMImageVariogramAnalysis-method'></span>

<h3>Description</h3>

<p>getDTModelEvaluation method
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getDTModelEvaluation(AFMImageVariogramAnalysis)

## S4 method for signature 'AFMImageVariogramAnalysis'
getDTModelEvaluation(AFMImageVariogramAnalysis)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getDTModelEvaluation_+3A_afmimagevariogramanalysis">AFMImageVariogramAnalysis</code></td>
<td>
<p>an AFMImageVariogramAnalysis object</p>
</td></tr>
</table>

<hr>
<h2 id='getDTModelSillRange'>getDTModelSillRange method</h2><span id='topic+getDTModelSillRange'></span><span id='topic+getDTModelSillRange+2CAFMImageVariogramAnalysis-method'></span>

<h3>Description</h3>

<p>getDTModelSillRange method
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getDTModelSillRange(AFMImageVariogramAnalysis)

## S4 method for signature 'AFMImageVariogramAnalysis'
getDTModelSillRange(AFMImageVariogramAnalysis)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getDTModelSillRange_+3A_afmimagevariogramanalysis">AFMImageVariogramAnalysis</code></td>
<td>
<p>an AFMImageVariogramAnalysis object</p>
</td></tr>
</table>

<hr>
<h2 id='getFractalDimensions'>Calculate 2D fractal dimensions and scales of an AFM Image</h2><span id='topic+getFractalDimensions'></span>

<h3>Description</h3>

<p><code>getFractalDimensions</code> calculates fractal dimensions and scales of an <code><a href="#topic+AFMImage">AFMImage</a></code> with the fd.estim.method from the <code>fractaldim</code> package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getFractalDimensions(AFMImage, AFMImageFractalDimensionsAnalysis)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getFractalDimensions_+3A_afmimage">AFMImage</code></td>
<td>
<p>an <code><a href="#topic+AFMImage">AFMImage</a></code> from Atomic Force Microscopy</p>
</td></tr>
<tr><td><code id="getFractalDimensions_+3A_afmimagefractaldimensionsanalysis">AFMImageFractalDimensionsAnalysis</code></td>
<td>
<p>an <code><a href="#topic+AFMImageFractalDimensionsAnalysis">AFMImageFractalDimensionsAnalysis</a></code> to store the results of the fractal analysis</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of <code><a href="#topic+AFMImageFractalDimensionMethod">AFMImageFractalDimensionMethod</a></code> objects with the calculated fractal dimensions and scales
</p>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>


<h3>References</h3>

<p>Gneiting2012, Tilmann Gneiting, Hana Sevcikova and Donald B. Percival 'Estimators of Fractal Dimension: Assessing the Roughness of Time Series and Spatial Data - Statistics in statistical Science, 2012, Vol. 27, No. 2, 247-277'
</p>


<h3>See Also</h3>

<p><code>fractaldim</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(AFM)
data(AFMImageOfAluminiumInterface)
print(getFractalDimensions(AFMImageOfAluminiumInterface))

## End(Not run)
</code></pre>

<hr>
<h2 id='getHolesStatistics'>calculate statistics about holes in a binary image</h2><span id='topic+getHolesStatistics'></span>

<h3>Description</h3>

<p><code>getHolesStatistics</code> returns a binary AFMImage
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getHolesStatistics(AFMImage)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getHolesStatistics_+3A_afmimage">AFMImage</code></td>
<td>
<p>an <code><a href="#topic+AFMImage">AFMImage</a></code> from Atomic Force Microscopy</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an <code><a href="#topic+AFMImage">AFMImage</a></code>
</p>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(AFM)

data(AFMImageOfAluminiumInterface)
newAFMImage&lt;-copy(AFMImageOfAluminiumInterface)
displayIn3D(newAFMImage,noLight=TRUE)
newAFMImage&lt;-multiplyHeightsAFMImage(newAFMImage, multiplier=2)
displayIn3D(newAFMImage,noLight=TRUE)
newAFMImage&lt;-filterAFMImage(newAFMImage,  Min=140, Max=300)
displayIn3D(newAFMImage,noLight=TRUE)
newAFMImage&lt;-makeBinaryAFMImage(newAFMImage)
displayIn3D(newAFMImage,noLight=TRUE)

holesStats&lt;-getHolesStatistics(newAFMImage)
print(holesStats)

## End(Not run)
</code></pre>

<hr>
<h2 id='getIntersectionForRoughnessAgainstLengthscale'>get the intersection between tangente and plateau</h2><span id='topic+getIntersectionForRoughnessAgainstLengthscale'></span>

<h3>Description</h3>

<p><code><a href="#topic+getIntersectionForRoughnessAgainstLengthscale">getIntersectionForRoughnessAgainstLengthscale</a></code> get the intersection between tangente and plateau
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getIntersectionForRoughnessAgainstLengthscale(
  AFMImageAnalyser,
  minValue,
  maxValue,
  second_slope = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getIntersectionForRoughnessAgainstLengthscale_+3A_afmimageanalyser">AFMImageAnalyser</code></td>
<td>
<p>an <code><a href="#topic+AFMImageAnalyser">AFMImageAnalyser</a></code> to get Roughness against lenghtscale calculation</p>
</td></tr>
<tr><td><code id="getIntersectionForRoughnessAgainstLengthscale_+3A_minvalue">minValue</code></td>
<td>
<p>index of the lowest point to be used for the tangent</p>
</td></tr>
<tr><td><code id="getIntersectionForRoughnessAgainstLengthscale_+3A_maxvalue">maxValue</code></td>
<td>
<p>index of the highest point to be used for the tangent</p>
</td></tr>
<tr><td><code id="getIntersectionForRoughnessAgainstLengthscale_+3A_second_slope">second_slope</code></td>
<td>
<p>a boolean to manage first or second slope in the roughness against lenghtscale curve</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code><a href="#topic+AFMImagePSDSlopesAnalysis">AFMImagePSDSlopesAnalysis</a></code>
</p>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>

<hr>
<h2 id='getIntersectionPointWithBorder'>getIntersectionPointWithBorder to be described</h2><span id='topic+getIntersectionPointWithBorder'></span>

<h3>Description</h3>

<p><code>getIntersectionPointWithBorder</code> return a data.table
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getIntersectionPointWithBorder(AFMImage, center, r, deg)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getIntersectionPointWithBorder_+3A_afmimage">AFMImage</code></td>
<td>
<p>a <code><a href="#topic+AFMImage">AFMImage</a></code> from Atomic Force Microscopy</p>
</td></tr>
<tr><td><code id="getIntersectionPointWithBorder_+3A_center">center</code></td>
<td>
<p>center</p>
</td></tr>
<tr><td><code id="getIntersectionPointWithBorder_+3A_r">r</code></td>
<td>
<p>radius</p>
</td></tr>
<tr><td><code id="getIntersectionPointWithBorder_+3A_deg">deg</code></td>
<td>
<p>degree</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>

<hr>
<h2 id='getListOfDiameters'>getListOfDiameters</h2><span id='topic+getListOfDiameters'></span>

<h3>Description</h3>

<p><code>getListOfDiameters</code> return
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getListOfDiameters(g)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getListOfDiameters_+3A_g">g</code></td>
<td>
<p>list of igraph networks</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>

<hr>
<h2 id='getLogLogOmnidirectionalSlopeGraph'>Get the graph of the Log Log omnidiretction variogram
<code>getLogLogOmnidirectionalSlopeGraph</code> returns Get the graph of the Log Log omnidirectional variogram</h2><span id='topic+getLogLogOmnidirectionalSlopeGraph'></span>

<h3>Description</h3>

<p>Get the graph of the Log Log omnidiretction variogram
<code>getLogLogOmnidirectionalSlopeGraph</code> returns Get the graph of the Log Log omnidirectional variogram
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getLogLogOmnidirectionalSlopeGraph(AFMImageAnalyser, withFratcalSlope = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getLogLogOmnidirectionalSlopeGraph_+3A_afmimageanalyser">AFMImageAnalyser</code></td>
<td>
<p>an <code><a href="#topic+AFMImageAnalyser">AFMImageAnalyser</a></code></p>
</td></tr>
<tr><td><code id="getLogLogOmnidirectionalSlopeGraph_+3A_withfratcalslope">withFratcalSlope</code></td>
<td>
<p>a boolean to indicate if the graph should contain a line representating the slope for the calculation of the fractal index and topothesy</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a ggplot2 graph
</p>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(AFM)
library(ggplot2)

data(AFMImageOfRegularPeaks)

AFMImageAnalyser = new("AFMImageAnalyser",
         fullfilename="/home/ubuntu/AFMImageOfRegularPeaks-Analyser.txt")
variogramAnalysis&lt;-AFMImageVariogramAnalysis(sampleFitPercentage=3.43/100)
AFMImageAnalyser@variogramAnalysis&lt;-variogramAnalysis
AFMImageAnalyser@variogramAnalysis@omnidirectionalVariogram&lt;-
     calculateOmnidirectionalVariogram(AFMImage= AFMImageOfRegularPeaks, 
                                       AFMImageVariogramAnalysis= variogramAnalysis)
p&lt;-getLogLogOmnidirectionalSlopeGraph(AFMImageAnalyser,  withFratcalSlope=TRUE)
p

## End(Not run) 
</code></pre>

<hr>
<h2 id='getMaxCircleMatrix'>getMaxCircleMatrix</h2><span id='topic+getMaxCircleMatrix'></span>

<h3>Description</h3>

<p>for each pixel of the image,
if the pixel is not empty
try to place one circle
start with biggets circle
as soon as a circle is found the circle, the pixel is associated with with the circle raidus
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getMaxCircleMatrix(..., newCircleAFMImage, CIRCLE_RADIUS_INIT)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getMaxCircleMatrix_+3A_...">...</code></td>
<td>
<p>cl: a cluster object from the parallel package</p>
</td></tr>
<tr><td><code id="getMaxCircleMatrix_+3A_newcircleafmimage">newCircleAFMImage</code></td>
<td>
<p>a <code><a href="#topic+AFMImage">AFMImage</a></code></p>
</td></tr>
<tr><td><code id="getMaxCircleMatrix_+3A_circle_radius_init">CIRCLE_RADIUS_INIT</code></td>
<td>
<p>CIRCLE_RADIUS_INIT</p>
</td></tr>
</table>


<h3>Value</h3>

<p>res a matrix
</p>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>

<hr>
<h2 id='getNetworkGridLayout'>#' @export
getCoordinatesFromVertexId2&lt;-function(AFMImage, vId) 
vertexId&lt;-as.numeric(vId)
y&lt;-floor(vertexId/HASHSIZE)
x&lt;-vertexId-y*HASHSIZE
return(data.table(vId=vId, coords.x1=x,coords.x2=y))

Get getNetworkGridLayout</h2><span id='topic+getNetworkGridLayout'></span>

<h3>Description</h3>

<p><code>getNetworkGridLayout</code> return a list x,y coordinates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getNetworkGridLayout(AFMImage, vId)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getNetworkGridLayout_+3A_afmimage">AFMImage</code></td>
<td>
<p>an <code><a href="#topic+AFMImage">AFMImage</a></code> from Atomic Force Microscopy</p>
</td></tr>
<tr><td><code id="getNetworkGridLayout_+3A_vid">vId</code></td>
<td>
<p>the vertex id</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>

<hr>
<h2 id='getNetworkParameters'>Get Network parameters</h2><span id='topic+getNetworkParameters'></span><span id='topic+getNetworkParameters+2CAFMImageNetworksAnalysis-method'></span><span id='topic+getNetworkParameters+2CAFMImage-method'></span>

<h3>Description</h3>

<p>Get basic network parameters :
Total root mean square Roughness or Total Rrms or totalRMSRoughness_TotalRrms<br />
Mean roughness or Ra or MeanRoughness_Ra
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getNetworkParameters(AFMImageNetworksAnalysis, AFMImage)

## S4 method for signature 'AFMImageNetworksAnalysis'
getNetworkParameters(AFMImageNetworksAnalysis, AFMImage)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getNetworkParameters_+3A_afmimagenetworksanalysis">AFMImageNetworksAnalysis</code></td>
<td>
<p>an <code><a href="#topic+AFMImageNetworksAnalysis">AFMImageNetworksAnalysis</a></code></p>
</td></tr>
<tr><td><code id="getNetworkParameters_+3A_afmimage">AFMImage</code></td>
<td>
<p>an <code><a href="#topic+AFMImage">AFMImage</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>getNetworkParameters</code> returns a data.table of network parameters
</p>


<h3>Value</h3>

<p>a data.table of network parameters: 
</p>

<ul>
<li><p> totalNumberOfNodes the total number of nodes with degree different of 2
</p>
</li>
<li><p> totalNumberOfNodesWithDegreeTwoOrMore  the total number of nodes with degree 2 or more
</p>
</li>
<li><p> totalNumberOfNodesWithDegreeOne the total number of nodes with degree one
</p>
</li>
<li><p> numberOfNodesPerArea  the total number of nodes with degree diffrent of 2 per area
</p>
</li>
<li><p> numberOfNodesPerSurfaceArea the total number of nodes with degree diffrent of 2 per surface area
</p>
</li>
<li><p> MeanPhysicalDistanceBetweenNodes the mean physical distance between nodes of degree different of two
</p>
</li></ul>



<h3>Author(s)</h3>

<p>M.Beauvais
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(AFM)
library(parallel)

data(AFMImageCollagenNetwork)
AFMImage&lt;-AFMImageCollagenNetwork
AFMIA = new("AFMImageNetworksAnalysis")
AFMIA@heightNetworksslider=10
AFMIA@filterNetworkssliderMin=150
AFMIA@filterNetworkssliderMax=300
AFMIA@smallBranchesTreatment=TRUE
clExist&lt;-TRUE
cl &lt;- makeCluster(2,outfile="")
AFMIA&lt;-transformAFMImageForNetworkAnalysis(AFMImageNetworksAnalysis=AFMIA,AFMImage= AFMImage)
AFMIA&lt;-identifyNodesAndEdges(cl=cl,AFMImageNetworksAnalysis= AFMIA,maxHeight= 300)
AFMIA&lt;-identifyEdgesFromCircles(cl=cl,AFMImageNetworksAnalysis= AFMIA, MAX_DISTANCE = 75)
AFMIA&lt;-identifyIsolatedNodes(AFMIA)
AFMIA&lt;-createGraph(AFMIA)
AFMIA&lt;-calculateShortestPaths(cl=cl, AFMImageNetworksAnalysis=AFMIA)
AFMIA&lt;-calculateNetworkParameters(AFMImageNetworksAnalysis=AFMIA, AFMImage=AFMImage)
AFMIA&lt;-calculateHolesCharacteristics(AFMImageNetworksAnalysis=AFMIA)
stopCluster(cl)

## End(Not run)
</code></pre>

<hr>
<h2 id='getNyquistSpatialFrequency'>Get the Nyquist spatial frequency</h2><span id='topic+getNyquistSpatialFrequency'></span><span id='topic+getNyquistSpatialFrequency+2CAFMImage-method'></span>

<h3>Description</h3>

<p>Get the Nyquist spatial frequency of an <code><a href="#topic+AFMImage">AFMImage</a></code> calculated as following:<br />
0.5 multiplied by the minimum between the horizontal scansize divided by the number of samples per line and the vertical scansize divided by the number of lines
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getNyquistSpatialFrequency(AFMImage)

## S4 method for signature 'AFMImage'
getNyquistSpatialFrequency(AFMImage)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getNyquistSpatialFrequency_+3A_afmimage">AFMImage</code></td>
<td>
<p>an <code><a href="#topic+AFMImage">AFMImage</a></code> from Atomic Force Microscopy</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>getNyquistSpatialFrequency</code> returns the Nyquist spatial frequency as a numeric
</p>


<h3>Value</h3>

<p>the Nyquist spatial frequency of the <code><a href="#topic+AFMImage">AFMImage</a></code>
</p>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(AFM)

data(AFMImageOfNormallyDistributedHeights)
NyquistSpatialFrequency&lt;-getNyquistSpatialFrequency(AFMImageOfNormallyDistributedHeights)
print(NyquistSpatialFrequency)

## End(Not run)

</code></pre>

<hr>
<h2 id='getPaddedAFMImage'>Get a zero padded AFMImage</h2><span id='topic+getPaddedAFMImage'></span>

<h3>Description</h3>

<p>Get a zero padded <code><a href="#topic+AFMImage">AFMImage</a></code> useful in Power Spectral Density analysis. The original <code><a href="#topic+AFMImage">AFMImage</a></code> is padded with zero in order to get a larger square AFMImage which size is a power of 2.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getPaddedAFMImage(AFMImage)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getPaddedAFMImage_+3A_afmimage">AFMImage</code></td>
<td>
<p>an <code><a href="#topic+AFMImage">AFMImage</a></code> from Atomic Force Microscopy</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a zero-padded <code><a href="#topic+AFMImage">AFMImage</a></code> with a fullfilename equals to the original fullfilename pasted with padded-to-&quot;ScanSize&quot;.txt
</p>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(AFM)

data(AFMImageOfNormallyDistributedHeights)
paddedAFMImage&lt;-getPaddedAFMImage(AFMImageOfNormallyDistributedHeights)
displayIn3D(AFMImage= paddedAFMImage, width= 1024,noLight=TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='getRoughnessParameters'>Get Roughness parameters</h2><span id='topic+getRoughnessParameters'></span><span id='topic+getRoughnessParameters+2CAFMImage-method'></span>

<h3>Description</h3>

<p>Get basic roughness parameters as amplitude parameters:
Total root mean square Roughness or Total Rrms or totalRMSRoughness_TotalRrms<br />
Mean roughness or Ra or MeanRoughness_Ra
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getRoughnessParameters(AFMImage)

## S4 method for signature 'AFMImage'
getRoughnessParameters(AFMImage)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getRoughnessParameters_+3A_afmimage">AFMImage</code></td>
<td>
<p>an <code><a href="#topic+AFMImage">AFMImage</a></code> from Atomic Force Microscopy</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>getRoughnessParameters</code> returns a data.table of roughness parameters
</p>


<h3>Value</h3>

<p>a data.table of roughness parameters: 
</p>

<ul>
<li><p> totalRMSRoughness_TotalRrms the total RMS Roughness as the square root of the variance of heights
</p>
</li>
<li><p> MeanRoughness_Ra the average roughness as the mean of absolute value of heights
</p>
</li></ul>



<h3>Author(s)</h3>

<p>M.Beauvais
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(AFM)

data(AFMImageOfAluminiumInterface)
roughnessParameters&lt;-getRoughnessParameters(AFMImageOfAluminiumInterface)
print(roughnessParameters)

## End(Not run)

</code></pre>

<hr>
<h2 id='getSpplotFromAFMImage'>Get an AFMImage as a Lattice (trellis) plot</h2><span id='topic+getSpplotFromAFMImage'></span>

<h3>Description</h3>

<p>get a Lattice (trellis) plot of an <code><a href="#topic+AFMImage">AFMImage</a></code> using the <code><a href="sp.html#topic+spplot">spplot</a></code> method of the sp package.
This function is used to evaluate visually the quality of the predicted surface when a variogram model is used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getSpplotFromAFMImage(AFMImage, expectedWidth, expectHeight, withoutLegend)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getSpplotFromAFMImage_+3A_afmimage">AFMImage</code></td>
<td>
<p>an <code><a href="#topic+AFMImage">AFMImage</a></code> from Atomic Force Microscopy</p>
</td></tr>
<tr><td><code id="getSpplotFromAFMImage_+3A_expectedwidth">expectedWidth</code></td>
<td>
<p>(optional) expected width of the saved image. Default is 400px.</p>
</td></tr>
<tr><td><code id="getSpplotFromAFMImage_+3A_expectheight">expectHeight</code></td>
<td>
<p>(optional) expected height of the saved image. Default is 300px.</p>
</td></tr>
<tr><td><code id="getSpplotFromAFMImage_+3A_withoutlegend">withoutLegend</code></td>
<td>
<p>(optional) set at FALSE, the cuts legend will be included in the plot. Default is FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>getSpplotFromAFMImage</code> get a Lattice (trellis) plot of an <code><a href="#topic+AFMImage">AFMImage</a></code> on disk
</p>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(AFM)

data(AFMImageOfAluminiumInterface)
p&lt;-getSpplotFromAFMImage(AFMImageOfAluminiumInterface, 800,800, TRUE)
print(p)

## End(Not run)
</code></pre>

<hr>
<h2 id='getSurroundingVertexesList'>Get surrounding vertices from x,y coordinates</h2><span id='topic+getSurroundingVertexesList'></span>

<h3>Description</h3>

<p><code>getSurroundingVertexesList</code> return the vertexId
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getSurroundingVertexesList(AFMImage, x, y)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getSurroundingVertexesList_+3A_afmimage">AFMImage</code></td>
<td>
<p>an <code><a href="#topic+AFMImage">AFMImage</a></code> from Atomic Force Microscopy</p>
</td></tr>
<tr><td><code id="getSurroundingVertexesList_+3A_x">x</code></td>
<td>
<p>coordinates in x axis</p>
</td></tr>
<tr><td><code id="getSurroundingVertexesList_+3A_y">y</code></td>
<td>
<p>coordinates in y axis</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>

<hr>
<h2 id='getTopologyAFMImage'>Calculate topology image (TBC)</h2><span id='topic+getTopologyAFMImage'></span>

<h3>Description</h3>

<p><code>getTopologyAFMImage</code> return the global topological distance
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getTopologyAFMImage(BinaryAFMImage, AFMImageNetworksAnalysis)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getTopologyAFMImage_+3A_binaryafmimage">BinaryAFMImage</code></td>
<td>
<p>an <code><a href="#topic+AFMImage">AFMImage</a></code> from Atomic Force Microscopy in a binary format 0 or 1 values for heigths</p>
</td></tr>
<tr><td><code id="getTopologyAFMImage_+3A_afmimagenetworksanalysis">AFMImageNetworksAnalysis</code></td>
<td>
<p>an <code><a href="#topic+AFMImageNetworksAnalysis">AFMImageNetworksAnalysis</a></code> from Atomic Force Microscopy</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>

<hr>
<h2 id='getTriangle'>get a triangle starting from center, two segments of length r with angles deg1 and deg2</h2><span id='topic+getTriangle'></span>

<h3>Description</h3>

<p><code>getTriangle</code> return a data.table points of a triangle
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getTriangle(AFMImage, center, r, deg1, deg2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getTriangle_+3A_afmimage">AFMImage</code></td>
<td>
<p>a <code><a href="#topic+AFMImage">AFMImage</a></code> from Atomic Force Microscopy</p>
</td></tr>
<tr><td><code id="getTriangle_+3A_center">center</code></td>
<td>
<p>center</p>
</td></tr>
<tr><td><code id="getTriangle_+3A_r">r</code></td>
<td>
<p>length of segment</p>
</td></tr>
<tr><td><code id="getTriangle_+3A_deg1">deg1</code></td>
<td>
<p>angle 1</p>
</td></tr>
<tr><td><code id="getTriangle_+3A_deg2">deg2</code></td>
<td>
<p>angel 2</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>

<hr>
<h2 id='getVertexId'>Get vertex id from x,y coordinates</h2><span id='topic+getVertexId'></span>

<h3>Description</h3>

<p><code>getVertexId</code> return the vertexId
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getVertexId(AFMImage, x, y)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getVertexId_+3A_afmimage">AFMImage</code></td>
<td>
<p>an <code><a href="#topic+AFMImage">AFMImage</a></code> from Atomic Force Microscopy</p>
</td></tr>
<tr><td><code id="getVertexId_+3A_x">x</code></td>
<td>
<p>coordinates in x axis</p>
</td></tr>
<tr><td><code id="getVertexId_+3A_y">y</code></td>
<td>
<p>coordinates in y axis</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>

<hr>
<h2 id='gridIgraphPlot'>gridIgraphPlot</h2><span id='topic+gridIgraphPlot'></span>

<h3>Description</h3>

<p><code>gridIgraphPlot</code> return TRUE if vertex is adjacent to a better vertex
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gridIgraphPlot(AFMImage, g)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gridIgraphPlot_+3A_afmimage">AFMImage</code></td>
<td>
<p>an <code><a href="#topic+AFMImage">AFMImage</a></code> from Atomic Force Microscopy</p>
</td></tr>
<tr><td><code id="gridIgraphPlot_+3A_g">g</code></td>
<td>
<p>the networks</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>

<hr>
<h2 id='identifyEdgesFromCircles'>display the network of nodes and edges</h2><span id='topic+identifyEdgesFromCircles'></span>

<h3>Description</h3>

<p>display the network of nodes and edges
</p>


<h3>Usage</h3>

<pre><code class='language-R'>identifyEdgesFromCircles(..., AFMImageNetworksAnalysis, MAX_DISTANCE = 40)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="identifyEdgesFromCircles_+3A_...">...</code></td>
<td>
<p>cl: a cluster object from the parallel package</p>
</td></tr>
<tr><td><code id="identifyEdgesFromCircles_+3A_afmimagenetworksanalysis">AFMImageNetworksAnalysis</code></td>
<td>
<p>a <code><a href="#topic+AFMImageNetworksAnalysis">AFMImageNetworksAnalysis</a></code></p>
</td></tr>
<tr><td><code id="identifyEdgesFromCircles_+3A_max_distance">MAX_DISTANCE</code></td>
<td>
<p>the maximum distance between nodes to check if nodes are connected. Default value is 40.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>

<hr>
<h2 id='identifyIsolatedNodes'>identify isolated nodes comparing the list of edges and the list of nodes</h2><span id='topic+identifyIsolatedNodes'></span>

<h3>Description</h3>

<p>identify isolated nodes comparing the list of edges and the list of nodes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>identifyIsolatedNodes(AFMImageNetworksAnalysis)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="identifyIsolatedNodes_+3A_afmimagenetworksanalysis">AFMImageNetworksAnalysis</code></td>
<td>
<p>the AFMImageNetworksAnalysis instance</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the updated instance of AFMImageNetworksAnalysis
</p>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>

<hr>
<h2 id='identifyMaxCircleRadius'>identifyMaxCircleRadius</h2><span id='topic+identifyMaxCircleRadius'></span>

<h3>Description</h3>

<p>identifyMaxCircleRadius
</p>


<h3>Usage</h3>

<pre><code class='language-R'>identifyMaxCircleRadius(
  i,
  allXY,
  newCircleAFMImage,
  binaryAFMImageMatrix,
  maxCircleRadiusMatrix,
  circleRadius,
  circlenm
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="identifyMaxCircleRadius_+3A_i">i</code></td>
<td>
<p>an integer</p>
</td></tr>
<tr><td><code id="identifyMaxCircleRadius_+3A_allxy">allXY</code></td>
<td>
<p>combinations of ?</p>
</td></tr>
<tr><td><code id="identifyMaxCircleRadius_+3A_newcircleafmimage">newCircleAFMImage</code></td>
<td>
<p>a <code><a href="#topic+AFMImage">AFMImage</a></code></p>
</td></tr>
<tr><td><code id="identifyMaxCircleRadius_+3A_binaryafmimagematrix">binaryAFMImageMatrix</code></td>
<td>
<p>a <code><a href="#topic+AFMImage">AFMImage</a></code></p>
</td></tr>
<tr><td><code id="identifyMaxCircleRadius_+3A_maxcircleradiusmatrix">maxCircleRadiusMatrix</code></td>
<td>
<p>a matrix</p>
</td></tr>
<tr><td><code id="identifyMaxCircleRadius_+3A_circleradius">circleRadius</code></td>
<td>
<p>a vector of radius ?</p>
</td></tr>
<tr><td><code id="identifyMaxCircleRadius_+3A_circlenm">circlenm</code></td>
<td>
<p>a ?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data table with x,y,radius columns
</p>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>

<hr>
<h2 id='identifyNodesAndEdges'>identifyNodesAndEdges</h2><span id='topic+identifyNodesAndEdges'></span>

<h3>Description</h3>

<p>find nodes and edges
</p>


<h3>Usage</h3>

<pre><code class='language-R'>identifyNodesAndEdges(..., AFMImageNetworksAnalysis, maxHeight)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="identifyNodesAndEdges_+3A_...">...</code></td>
<td>
<p>cl: a cluster object from the parallel package</p>
</td></tr>
<tr><td><code id="identifyNodesAndEdges_+3A_afmimagenetworksanalysis">AFMImageNetworksAnalysis</code></td>
<td>
<p>a <code><a href="#topic+AFMImageNetworksAnalysis">AFMImageNetworksAnalysis</a></code></p>
</td></tr>
<tr><td><code id="identifyNodesAndEdges_+3A_maxheight">maxHeight</code></td>
<td>
<p>a double for filtering the heights - upper to this height the heights are set to zero</p>
</td></tr>
</table>


<h3>Value</h3>

<p>AFMImageNetworksAnalysis a <code><a href="#topic+AFMImageNetworksAnalysis">AFMImageNetworksAnalysis</a></code>
</p>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>

<hr>
<h2 id='identifyNodesWithCircles'>identify largest circles in binary image</h2><span id='topic+identifyNodesWithCircles'></span>

<h3>Description</h3>

<p><code>identifyNodesWithCircles</code> return TRUE if vertex is adjacent to a better vertex
</p>


<h3>Usage</h3>

<pre><code class='language-R'>identifyNodesWithCircles(..., AFMImageNetworksAnalysis)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="identifyNodesWithCircles_+3A_...">...</code></td>
<td>
<p>cl: a cluster object from the parallel package</p>
</td></tr>
<tr><td><code id="identifyNodesWithCircles_+3A_afmimagenetworksanalysis">AFMImageNetworksAnalysis</code></td>
<td>
<p>a <code><a href="#topic+AFMImageNetworksAnalysis">AFMImageNetworksAnalysis</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>AFMImageNetworksAnalysis the <code><a href="#topic+AFMImageNetworksAnalysis">AFMImageNetworksAnalysis</a></code> instance
</p>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>

<hr>
<h2 id='importFromNanoscope'>Import data from nanoscope analysis(tm) tool</h2><span id='topic+importFromNanoscope'></span>

<h3>Description</h3>

<p>The imported file should contain a header and list of heights
The header should contain the following fields:
</p>

<ul>
<li><p> Lines: number of scanned lines (e.g. 512)
</p>
</li>
<li><p> Sampsline: number of scan per line (e.g. 512)
</p>
</li>
<li><p> ScanSize: the sample size (e.g. 1000nm) the extension nm is mandatory and will be removed
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>importFromNanoscope(fullfilename)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="importFromNanoscope_+3A_fullfilename">fullfilename</code></td>
<td>
<p>a concatenated string of the directory and filename exported with Nanoscope analysis(TM) software</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>importFromNanoscope</code> returns an <code><a href="#topic+AFMImage">AFMImage</a></code>
</p>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(AFM)

fullfilename&lt;-"/user/ubuntu/NanoscopeFlattenExportedFile.txt"
myAFMimage&lt;-importFromNanoscope(fullfilename)
displayIn3D(myAFMimage, width=1024, noLight=TRUE))

## End(Not run)
</code></pre>

<hr>
<h2 id='initialize+2CAFMImageAnalyser-method'>Constructor method of AFMImageAnalyser Class.</h2><span id='topic+initialize+2CAFMImageAnalyser-method'></span>

<h3>Description</h3>

<p>Constructor method of AFMImageAnalyser Class.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'AFMImageAnalyser'
initialize(
  .Object,
  AFMImage,
  variogramAnalysis,
  psdAnalysis,
  fdAnalysis,
  gaussianMixAnalysis,
  networksAnalysis,
  threeDimensionAnalysis,
  mean,
  variance,
  TotalRrms,
  Ra,
  fullfilename
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="initialize+2B2CAFMImageAnalyser-method_+3A_.object">.Object</code></td>
<td>
<p>an AFMImageAnalyser object</p>
</td></tr>
<tr><td><code id="initialize+2B2CAFMImageAnalyser-method_+3A_afmimage">AFMImage</code></td>
<td>
<p>an <code>AFMImage</code></p>
</td></tr>
<tr><td><code id="initialize+2B2CAFMImageAnalyser-method_+3A_variogramanalysis">variogramAnalysis</code></td>
<td>
<p><code><a href="#topic+AFMImageVariogramAnalysis">AFMImageVariogramAnalysis</a></code></p>
</td></tr>
<tr><td><code id="initialize+2B2CAFMImageAnalyser-method_+3A_psdanalysis">psdAnalysis</code></td>
<td>
<p><code><a href="#topic+AFMImagePSDAnalysis">AFMImagePSDAnalysis</a></code></p>
</td></tr>
<tr><td><code id="initialize+2B2CAFMImageAnalyser-method_+3A_fdanalysis">fdAnalysis</code></td>
<td>
<p><code><a href="#topic+AFMImageFractalDimensionsAnalysis">AFMImageFractalDimensionsAnalysis</a></code></p>
</td></tr>
<tr><td><code id="initialize+2B2CAFMImageAnalyser-method_+3A_gaussianmixanalysis">gaussianMixAnalysis</code></td>
<td>
<p><code><a href="#topic+AFMImageGaussianMixAnalysis">AFMImageGaussianMixAnalysis</a></code></p>
</td></tr>
<tr><td><code id="initialize+2B2CAFMImageAnalyser-method_+3A_networksanalysis">networksAnalysis</code></td>
<td>
<p><code><a href="#topic+AFMImageNetworksAnalysis">AFMImageNetworksAnalysis</a></code></p>
</td></tr>
<tr><td><code id="initialize+2B2CAFMImageAnalyser-method_+3A_threedimensionanalysis">threeDimensionAnalysis</code></td>
<td>
<p><code><a href="#topic+AFMImage3DModelAnalysis">AFMImage3DModelAnalysis</a></code></p>
</td></tr>
<tr><td><code id="initialize+2B2CAFMImageAnalyser-method_+3A_mean">mean</code></td>
<td>
<p>the mean of heights of the <code><a href="#topic+AFMImage">AFMImage</a></code></p>
</td></tr>
<tr><td><code id="initialize+2B2CAFMImageAnalyser-method_+3A_variance">variance</code></td>
<td>
<p>the variance of heights of the <code><a href="#topic+AFMImage">AFMImage</a></code></p>
</td></tr>
<tr><td><code id="initialize+2B2CAFMImageAnalyser-method_+3A_totalrrms">TotalRrms</code></td>
<td>
<p>the total Root Mean Square Roughness of the <code><a href="#topic+AFMImage">AFMImage</a></code> calculated from variance</p>
</td></tr>
<tr><td><code id="initialize+2B2CAFMImageAnalyser-method_+3A_ra">Ra</code></td>
<td>
<p>mean roughness or mean of absolute values of heights</p>
</td></tr>
<tr><td><code id="initialize+2B2CAFMImageAnalyser-method_+3A_fullfilename">fullfilename</code></td>
<td>
<p>to be removed?</p>
</td></tr>
</table>

<hr>
<h2 id='invertBinaryAFMImage'>invert a binary AFMImage</h2><span id='topic+invertBinaryAFMImage'></span>

<h3>Description</h3>

<p><code>invertBinaryAFMImage</code> returns a binary AFMImage
</p>


<h3>Usage</h3>

<pre><code class='language-R'>invertBinaryAFMImage(AFMImage)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="invertBinaryAFMImage_+3A_afmimage">AFMImage</code></td>
<td>
<p>an <code><a href="#topic+AFMImage">AFMImage</a></code> from Atomic Force Microscopy</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an <code><a href="#topic+AFMImage">AFMImage</a></code>
</p>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(AFM)
data(AFMImageOfAluminiumInterface)
newAFMImage&lt;-copy(AFMImageOfAluminiumInterface)
displayIn3D(newAFMImage,noLight=TRUE)
newAFMImage&lt;-multiplyHeightsAFMImage(newAFMImage, multiplier=2)
displayIn3D(newAFMImage,noLight=TRUE)
newAFMImage&lt;-filterAFMImage(newAFMImage,  Min=140, Max=300)
displayIn3D(newAFMImage,noLight=TRUE)
newAFMImage&lt;-makeBinaryAFMImage(newAFMImage)
displayIn3D(newAFMImage,noLight=TRUE)
newAFMImage&lt;-invertBinaryAFMImage(newAFMImage)
displayIn3D(newAFMImage,noLight=TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='isAdjacentToBetterVertex'>isAdjacentToBetterVertex</h2><span id='topic+isAdjacentToBetterVertex'></span>

<h3>Description</h3>

<p><code>isAdjacentToBetterVertex</code> return TRUE if vertex is adjacent to a better vertex
</p>


<h3>Usage</h3>

<pre><code class='language-R'>isAdjacentToBetterVertex(AFMImage, x, y)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="isAdjacentToBetterVertex_+3A_afmimage">AFMImage</code></td>
<td>
<p>an <code><a href="#topic+AFMImage">AFMImage</a></code> from Atomic Force Microscopy</p>
</td></tr>
<tr><td><code id="isAdjacentToBetterVertex_+3A_x">x</code></td>
<td>
<p>coordinates in x axis</p>
</td></tr>
<tr><td><code id="isAdjacentToBetterVertex_+3A_y">y</code></td>
<td>
<p>coordinates in y axis</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>

<hr>
<h2 id='isAngleBetweenEdgesAlwaysSuperiorToMinAngle'>check if all the angles between one edge and a list of edges is superior to a specified value.</h2><span id='topic+isAngleBetweenEdgesAlwaysSuperiorToMinAngle'></span>

<h3>Description</h3>

<p>check if all the angles between one edge and a list of edges is superior to a specified value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>isAngleBetweenEdgesAlwaysSuperiorToMinAngle(
  binaryAFMImage,
  edge1,
  edges2,
  minAngle
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="isAngleBetweenEdgesAlwaysSuperiorToMinAngle_+3A_binaryafmimage">binaryAFMImage</code></td>
<td>
<p>a binary <code><a href="#topic+AFMImage">AFMImage</a></code> from Atomic Force Microscopy</p>
</td></tr>
<tr><td><code id="isAngleBetweenEdgesAlwaysSuperiorToMinAngle_+3A_edge1">edge1</code></td>
<td>
<p>one edge</p>
</td></tr>
<tr><td><code id="isAngleBetweenEdgesAlwaysSuperiorToMinAngle_+3A_edges2">edges2</code></td>
<td>
<p>list of edges</p>
</td></tr>
<tr><td><code id="isAngleBetweenEdgesAlwaysSuperiorToMinAngle_+3A_minangle">minAngle</code></td>
<td>
<p>the minimum angle value</p>
</td></tr>
</table>


<h3>Value</h3>

<p>TRUE if all the angle are superior to the specified value
</p>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>

<hr>
<h2 id='isBinary'>has the AFM Image heights of 0 or 1</h2><span id='topic+isBinary'></span>

<h3>Description</h3>

<p><code>isBinary</code> returns TRUE is the heights of the AFMImage is 0 or 1
</p>


<h3>Usage</h3>

<pre><code class='language-R'>isBinary(AFMImage)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="isBinary_+3A_afmimage">AFMImage</code></td>
<td>
<p>an <code><a href="#topic+AFMImage">AFMImage</a></code> from Atomic Force Microscopy</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a boolean
</p>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>

<hr>
<h2 id='loglike.normalmix'>loglike sum of density of a mixture of normals</h2><span id='topic+loglike.normalmix'></span>

<h3>Description</h3>

<p>loglike sum of density of a mixture of normals
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loglike.normalmix(x, mixture)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="loglike.normalmix_+3A_x">x</code></td>
<td>
<p>a vector of quantiles</p>
</td></tr>
<tr><td><code id="loglike.normalmix_+3A_mixture">mixture</code></td>
<td>
<p>a gaussian mixture</p>
</td></tr>
</table>

<hr>
<h2 id='makeBinaryAFMImage'>make a binary AFMImage setting all the heights different to 0 to 1.</h2><span id='topic+makeBinaryAFMImage'></span>

<h3>Description</h3>

<p><code>makeBinaryAFMImage</code> returns a binary AFMImage
</p>


<h3>Usage</h3>

<pre><code class='language-R'>makeBinaryAFMImage(AFMImage)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="makeBinaryAFMImage_+3A_afmimage">AFMImage</code></td>
<td>
<p>an <code><a href="#topic+AFMImage">AFMImage</a></code> from Atomic Force Microscopy</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an <code><a href="#topic+AFMImage">AFMImage</a></code>
</p>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>

<hr>
<h2 id='multiplyHeightsAFMImage'>multiply the heights of an AFMImage</h2><span id='topic+multiplyHeightsAFMImage'></span>

<h3>Description</h3>

<p><code>multiplyHeightsAFMImage</code> returns a simplified AFMImage
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multiplyHeightsAFMImage(AFMImage, multiplier)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="multiplyHeightsAFMImage_+3A_afmimage">AFMImage</code></td>
<td>
<p>an <code><a href="#topic+AFMImage">AFMImage</a></code> from Atomic Force Microscopy</p>
</td></tr>
<tr><td><code id="multiplyHeightsAFMImage_+3A_multiplier">multiplier</code></td>
<td>
<p>the number to multiply the heights with</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an <code><a href="#topic+AFMImage">AFMImage</a></code>
</p>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(AFMImageOfAluminiumInterface)
newAFMImage&lt;-multiplyHeightsAFMImage(AFMImageOfAluminiumInterface,10)
displayIn3D(newAFMImage,noLight=TRUE)

## End(Not run)

</code></pre>

<hr>
<h2 id='omniVariogramSlopeAnalysis-class'>AFM Image log-log experimental variogram slope analysis</h2><span id='topic+omniVariogramSlopeAnalysis-class'></span><span id='topic+omniVariogramSlopeAnalysis'></span><span id='topic+initialize+2ComniVariogramSlopeAnalysis-method'></span>

<h3>Description</h3>

<p><code>omniVariogramSlopeAnalysis</code> stores the analysis of the second slope in roughness against lenghtscale
</p>


<h3>Usage</h3>

<pre><code class='language-R'>omniVariogramSlopeAnalysis()

## S4 method for signature 'omniVariogramSlopeAnalysis'
initialize(.Object)

omniVariogramSlopeAnalysis()
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="omniVariogramSlopeAnalysis-class_+3A_.object">.Object</code></td>
<td>
<p>an omniVariogramSlopeAnalysis object</p>
</td></tr>
</table>


<h3>Slots</h3>


<dl>
<dt><code>intersection_sill</code></dt><dd><p>to be removed ?</p>
</dd>
<dt><code>sill</code></dt><dd><p>to be removed ?</p>
</dd>
<dt><code>slope</code></dt><dd><p>to be removed ?</p>
</dd>
<dt><code>yintersept</code></dt><dd><p>to be removed ?</p>
</dd>
</dl>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>

<hr>
<h2 id='performAllPSDCalculation'>Perform all the calculation for PSD exploitation</h2><span id='topic+performAllPSDCalculation'></span>

<h3>Description</h3>

<p><code><a href="#topic+performAllPSDCalculation">performAllPSDCalculation</a></code> perform all the calculation for PSD exploitation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>performAllPSDCalculation(AFMImagePSDAnalysis, AFMImage)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="performAllPSDCalculation_+3A_afmimagepsdanalysis">AFMImagePSDAnalysis</code></td>
<td>
<p>an <code><a href="#topic+AFMImagePSDAnalysis">AFMImagePSDAnalysis</a></code> to manage and store the results of PSD analysis</p>
</td></tr>
<tr><td><code id="performAllPSDCalculation_+3A_afmimage">AFMImage</code></td>
<td>
<p>an <code><a href="#topic+AFMImage">AFMImage</a></code> from Atomic Force Microscopy</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(AFM)

data(AFMImageOfNormallyDistributedHeights)

newAFMImage&lt;-AFMImageOfNormallyDistributedHeights
newAFMImage@fullfilename&lt;-"C:/Users/one/AFMImageOfNormallyDistributedHeights.txt"
psdAnalysis&lt;-AFMImagePSDAnalysis()
# Create a closure to update progress
psdAnalysis@updateProgress&lt;- function(value = NULL, detail = NULL, message = NULL) {
  if (exists("progressPSD")){
    if (!is.null(message)) {
      progressPSD$set(message = message, value = 0)
    }else{
      progressPSD$set(value = value, detail = detail)
    }
  }
}
psdAnalysis@psd1d_breaks&lt;-2^3
psdAnalysis@psd2d_truncHighLengthScale&lt;-TRUE
psdAnalysis&lt;-performAllPSDCalculation(AFMImagePSDAnalysis= psdAnalysis, AFMImage= newAFMImage)
print("done psdAnalysis")

## End(Not run)
</code></pre>

<hr>
<h2 id='performGaussianMixCalculation'>Perform  the calculation for the Gaussian mixes</h2><span id='topic+performGaussianMixCalculation'></span>

<h3>Description</h3>

<p><code><a href="#topic+performGaussianMixCalculation">performGaussianMixCalculation</a></code> perform all the calculation for PSD exploitation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>performGaussianMixCalculation(AFMImageGaussianMixAnalysis, AFMImage)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="performGaussianMixCalculation_+3A_afmimagegaussianmixanalysis">AFMImageGaussianMixAnalysis</code></td>
<td>
<p>an <code><a href="#topic+AFMImageGaussianMixAnalysis">AFMImageGaussianMixAnalysis</a></code> to manage and store the results of PSD analysis</p>
</td></tr>
<tr><td><code id="performGaussianMixCalculation_+3A_afmimage">AFMImage</code></td>
<td>
<p>an <code><a href="#topic+AFMImage">AFMImage</a></code> from Atomic Force Microscopy</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(AFM)

data(AFMImageCollagenNetwork)

AFMImage&lt;-AFMImageCollagenNetwork
AFMImage@fullfilename&lt;-"/Users/one/AFMImageCollagenNetwork.txt"
gMixAnalysis&lt;-AFMImageGaussianMixAnalysis()
# from two components
gMixAnalysis@minGaussianMix&lt;-2
# to four components
gMixAnalysis@maxGaussianMix&lt;-4
# convergence criteria
gMixAnalysis@epsilonGaussianMix&lt;-1e-4
# Create a closure to update progress
gMixAnalysis@updateProgress&lt;- function(value = NULL, detail = NULL, message = NULL) {
  if (exists("progressGaussianMix")){
    if (!is.null(message)) {
      progressGaussianMix$set(message = message, value = 0)
    }else{
      progressGaussianMix$set(value = value, detail = detail)
    }
  }
}
gMixAnalysis&lt;-performGaussianMixCalculation(AFMImageGaussianMixAnalysis= gMixAnalysis, AFMImage)
print("done performGaussianMixCalculation")

## End(Not run)
</code></pre>

<hr>
<h2 id='pnormmix'>pnormmix distribution of a mixture of normals</h2><span id='topic+pnormmix'></span>

<h3>Description</h3>

<p>pnormmix distribution of a mixture of normals
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pnormmix(q, mixture)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pnormmix_+3A_q">q</code></td>
<td>
<p>a vector of quantiles</p>
</td></tr>
<tr><td><code id="pnormmix_+3A_mixture">mixture</code></td>
<td>
<p>a gaussian mixture</p>
</td></tr>
</table>

<hr>
<h2 id='printVariogramModelEvaluations'>printVariogramModelEvaluations</h2><span id='topic+printVariogramModelEvaluations'></span>

<h3>Description</h3>

<p><code>printVariogramModelEvaluations</code> generates a graphic element containing the evaluation of all variogram models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>printVariogramModelEvaluations(
  AFMImageAnalyser,
  sampleDT,
  numberOfModelsPerPage
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="printVariogramModelEvaluations_+3A_afmimageanalyser">AFMImageAnalyser</code></td>
<td>
<p>an <code><a href="#topic+AFMImageAnalyser">AFMImageAnalyser</a></code> to be used to produce report</p>
</td></tr>
<tr><td><code id="printVariogramModelEvaluations_+3A_sampledt">sampleDT</code></td>
<td>
<p>a data.table containg the evaluation information</p>
</td></tr>
<tr><td><code id="printVariogramModelEvaluations_+3A_numberofmodelsperpage">numberOfModelsPerPage</code></td>
<td>
<p>numeric to specify the number of model evaluations per pages</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>

<hr>
<h2 id='PSD1DAgainstFrequency'>Calculate the 1D Power Spectral Density; returns a data table of PSD 1D and PSD 2D values
against spatial frequencies.<br /> As mentionned in Sidick2009, this function calculates the 
PSD against spatial frequencies in 1D from <code><a href="#topic+PSD2DAgainstFrequency">PSD2DAgainstFrequency</a></code> by using
breaks in the log space to sum PSD 2D and frequency values.</h2><span id='topic+PSD1DAgainstFrequency'></span><span id='topic+PSD1DAgainstFrequency+2CAFMImage-method'></span>

<h3>Description</h3>

<p>Calculate the 1D Power Spectral Density; returns a data table of PSD 1D and PSD 2D values
against spatial frequencies.<br /> As mentionned in Sidick2009, this function calculates the 
PSD against spatial frequencies in 1D from <code><a href="#topic+PSD2DAgainstFrequency">PSD2DAgainstFrequency</a></code> by using
breaks in the log space to sum PSD 2D and frequency values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PSD1DAgainstFrequency(AFMImage, AFMImagePSDAnalysis)

## S4 method for signature 'AFMImage'
PSD1DAgainstFrequency(AFMImage, AFMImagePSDAnalysis)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PSD1DAgainstFrequency_+3A_afmimage">AFMImage</code></td>
<td>
<p>an <code>AFMImage</code> to be analysed</p>
</td></tr>
<tr><td><code id="PSD1DAgainstFrequency_+3A_afmimagepsdanalysis">AFMImagePSDAnalysis</code></td>
<td>
<p>n <code>AFMImagePSDAnalysis</code> to store the setup and results of PSD analysis</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>PSD1DAgainstFrequency</code> returns a data table of frequencies and PSD values
</p>

<ul>
<li><p> freq: the considered frequency
</p>
</li>
<li><p> PSD: the considered PSD value
</p>
</li>
<li><p> type: PSD-1D
</p>
</li>
<li><p> fullfilename: directory and filename on the disk
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(AFM)
library(ggplot2)
library(plyr)
library(scales)
data("AFMImageOfNormallyDistributedHeights")
 newAFMImage&lt;-AFMImageOfNormallyDistributedHeights
newAFMImage@fullfilename&lt;-"C:/Users/one/AFMImageOfNormallyDistributedHeights.txt"
psdAnalysis&lt;-AFMImagePSDAnalysis()
# Create a closure to update progress
psdAnalysis@updateProgress&lt;- function(value = NULL, detail = NULL, message = NULL) {
  if (exists("progressPSD")){
   if (!is.null(message)) {
     progressPSD$set(message = message, value = 0)
   }else{
     progressPSD$set(value = value, detail = detail)
   }
  }
}
psdAnalysis@psd1d_breaks&lt;-2^3
psdAnalysis@psd2d_truncHighLengthScale&lt;-TRUE
psdAnalysis&lt;-performAllPSDCalculation(AFMImagePSDAnalysis= psdAnalysis, AFMImage= newAFMImage)
datap&lt;-psdAnalysis@psd1d
p &lt;- ggplot(data=datap)
p &lt;- p + geom_point(aes(freq, PSD, color=type),data=datap[datap$type %in% c("PSD-2D")])
p &lt;- p + geom_line(aes(freq, PSD, color=type),data=datap[datap$type %in% c("PSD-1D")],size=1.1)
p &lt;- p + scale_x_log10()
p &lt;- p + scale_y_log10()
p &lt;- p + ylab("PSD (nm^4)")
p &lt;- p + xlab("Frequency (nm^-1)")
p

## End(Not run)
</code></pre>

<hr>
<h2 id='PSD2DAgainstFrequency'>Calculate the 2D Power Spectral Density</h2><span id='topic+PSD2DAgainstFrequency'></span><span id='topic+PSD2DAgainstFrequency+2CAFMImage+2CAFMImagePSDAnalysis-method'></span><span id='topic+PSD2DAgainstFrequency+2CAFMImage-method'></span>

<h3>Description</h3>

<p>PSD2DAgainstFrequency returns a data table of PSD 2D values against spatial frequencies
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PSD2DAgainstFrequency(AFMImage, AFMImagePSDAnalysis)

## S4 method for signature 'AFMImage,AFMImagePSDAnalysis'
PSD2DAgainstFrequency(AFMImage, AFMImagePSDAnalysis)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PSD2DAgainstFrequency_+3A_afmimage">AFMImage</code></td>
<td>
<p>an <code>AFMImage</code> to be analysed</p>
</td></tr>
<tr><td><code id="PSD2DAgainstFrequency_+3A_afmimagepsdanalysis">AFMImagePSDAnalysis</code></td>
<td>
<p>an <code>AFMImagePSDAnalysis</code> to store PSD analysis results</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>PSD2DAgainstFrequency</code> returns a data table of frequencies and PSD values
</p>

<ul>
<li><p> freq: the considered frequency
</p>
</li>
<li><p> PSD: the considered PSD value
</p>
</li>
<li><p> type: PSD-2D
</p>
</li>
<li><p> fullfilename: directory and filename on the disk
</p>
</li></ul>



<h3>References</h3>

<p>Sidick2009, Erkin Sidick &quot;Power Spectral Density Specification and Analysis of Large Optical Surfaces&quot;, 2009, &quot;Modeling Aspects in Optical Metrology II, Proc. of SPIE Vol. 7390 73900L-1&quot;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(AFM)
library(ggplot2)
library(plyr)

# Calculate Power Spectrum Density in 2D against frequency
data("AFMImageOfNormallyDistributedHeights")
oneAFMImage&lt;-AFMImageOfNormallyDistributedHeights
psd2d&lt;-PSD2DAgainstFrequency(oneAFMImage)
p &lt;- ggplot(data=psd2d)
p &lt;- p + geom_point(aes(freq, PSD, color=type),subset = .(type %in% c("PSD-2D")))
p &lt;- p + geom_line(aes(freq, PSD, color=type),subset = .(type %in% c("PSD-1D")),size=1.1)
p &lt;- p + scale_x_log10()
p &lt;- p + scale_y_log10()
p &lt;- p + ylab("PSD (nm^4)")
p &lt;- p + xlab("Frequency (nm^-1)")
p &lt;- p + ggtitle(basename(oneAFMImage@fullfilename))
p

## End(Not run)
</code></pre>

<hr>
<h2 id='putAnalysisOnDisk'>Export all data from an analysis of an AFM Image as rdata file</h2><span id='topic+putAnalysisOnDisk'></span><span id='topic+putAnalysisOnDisk+2CAFMImageAnalyser-method'></span>

<h3>Description</h3>

<p>A function to export to all the data from all analysis of an <code><a href="#topic+AFMImage">AFMImage</a></code> and put them on disk as rdata file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>putAnalysisOnDisk(AFMImageAnalyser, AFMImage)

## S4 method for signature 'AFMImageAnalyser'
putAnalysisOnDisk(AFMImageAnalyser, AFMImage)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="putAnalysisOnDisk_+3A_afmimageanalyser">AFMImageAnalyser</code></td>
<td>
<p>an <code><a href="#topic+AFMImageAnalyser">AFMImageAnalyser</a></code></p>
</td></tr>
<tr><td><code id="putAnalysisOnDisk_+3A_afmimage">AFMImage</code></td>
<td>
<p>an <code><a href="#topic+AFMImage">AFMImage</a></code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>

<hr>
<h2 id='putImagesFromAnalysisOnDisk'>Put the images from all analysis on disk</h2><span id='topic+putImagesFromAnalysisOnDisk'></span>

<h3>Description</h3>

<p>A function to put on disk all the images from variogram, PSD Analysis of an <code><a href="#topic+AFMImage">AFMImage</a></code>
An AFM Image 3D representation is saved on disk thanks to the <code>rgl</code> package.
On Unix system, it is necessary to have a X server connection to be able to use the <code>rgl</code> package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>putImagesFromAnalysisOnDisk(AFMImageAnalyser, AFMImage, exportDirectory)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="putImagesFromAnalysisOnDisk_+3A_afmimageanalyser">AFMImageAnalyser</code></td>
<td>
<p>an <code><a href="#topic+AFMImageAnalyser">AFMImageAnalyser</a></code></p>
</td></tr>
<tr><td><code id="putImagesFromAnalysisOnDisk_+3A_afmimage">AFMImage</code></td>
<td>
<p>an <code><a href="#topic+AFMImage">AFMImage</a></code></p>
</td></tr>
<tr><td><code id="putImagesFromAnalysisOnDisk_+3A_exportdirectory">exportDirectory</code></td>
<td>
<p>where the images will be stored</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>

<hr>
<h2 id='removeLonguestEdge'>removeLonguestEdge</h2><span id='topic+removeLonguestEdge'></span>

<h3>Description</h3>

<p>Find and remove the longuest edge if it is unique
</p>


<h3>Usage</h3>

<pre><code class='language-R'>removeLonguestEdge(k, res, sides, myRes, vertex1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="removeLonguestEdge_+3A_k">k</code></td>
<td>
<p>an integer</p>
</td></tr>
<tr><td><code id="removeLonguestEdge_+3A_res">res</code></td>
<td>
<p>res ?</p>
</td></tr>
<tr><td><code id="removeLonguestEdge_+3A_sides">sides</code></td>
<td>
<p>data.table</p>
</td></tr>
<tr><td><code id="removeLonguestEdge_+3A_myres">myRes</code></td>
<td>
<p>data.table?</p>
</td></tr>
<tr><td><code id="removeLonguestEdge_+3A_vertex1">vertex1</code></td>
<td>
<p>a vertex ?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.table with from, to
</p>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>

<hr>
<h2 id='removeNode'>removeNode</h2><span id='topic+removeNode'></span>

<h3>Description</h3>

<p>remove a node from an AFMImage
</p>


<h3>Usage</h3>

<pre><code class='language-R'>removeNode(circleAFMImage, nodeDT)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="removeNode_+3A_circleafmimage">circleAFMImage</code></td>
<td>
<p>a <code><a href="#topic+AFMImage">AFMImage</a></code></p>
</td></tr>
<tr><td><code id="removeNode_+3A_nodedt">nodeDT</code></td>
<td>
<p>a data.table lon lat circleRadius</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an <code><a href="#topic+AFMImage">AFMImage</a></code>
</p>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>

<hr>
<h2 id='RoughnessByLengthScale'>Calculate the roughness of the sample against length scale</h2><span id='topic+RoughnessByLengthScale'></span><span id='topic+RoughnessByLengthScale+2CAFMImage-method'></span>

<h3>Description</h3>

<p>The calculation of the roughness against lengthscale is performed throught a FFT 2D calculation, PSD 2D calculation and a meshgrid of frequencies.
<code>RoughnessByLengthScale</code> returns a data.table of roughnesses against length scales
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RoughnessByLengthScale(AFMImage, AFMImagePSDAnalysis)

## S4 method for signature 'AFMImage'
RoughnessByLengthScale(AFMImage, AFMImagePSDAnalysis)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="RoughnessByLengthScale_+3A_afmimage">AFMImage</code></td>
<td>
<p>an <code><a href="#topic+AFMImage">AFMImage</a></code> from Atomic Force Microscopy</p>
</td></tr>
<tr><td><code id="RoughnessByLengthScale_+3A_afmimagepsdanalysis">AFMImagePSDAnalysis</code></td>
<td>
<p>n <code>AFMImagePSDAnalysis</code> to store the setup and results of PSD analysis</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data table of lenght scale (r) and roughness values (roughness)
</p>
 
<ul>
<li> <p>roughness: roughnesses 
</p>
</li>
<li> <p>r: length scales
</p>
</li>
<li> <p>filename: fullfilename slot of the AFMImage 
</p>
</li></ul>



<h3>Author(s)</h3>

<p>M.Beauvais
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(AFM)
library(ggplot2)

data("AFMImageOfNormallyDistributedHeights")
oneAFMImage&lt;-AFMImageOfNormallyDistributedHeights
AFMImagePSDAnalysis&lt;-AFMImagePSDAnalysis()
data&lt;-RoughnessByLengthScale(oneAFMImage, AFMImagePSDAnalysis)
r&lt;-roughness&lt;-filename&lt;-NULL
p1 &lt;- ggplot(data, aes(x=r, y=roughness, colour= basename(filename)))
p1 &lt;- p1 + geom_point()
p1 &lt;- p1 + geom_line()
p1 &lt;- p1 + ylab("roughness (nm)")
p1 &lt;- p1 + xlab("lengthscale (nm)")
p1

## End(Not run)
</code></pre>

<hr>
<h2 id='runAFMApp'>Launch the AFM shiny application</h2><span id='topic+runAFMApp'></span>

<h3>Description</h3>

<p>Launch the AFM shiny graphical interface to access most of the fonctionalities of the AFM library
</p>


<h3>Usage</h3>

<pre><code class='language-R'>runAFMApp()
</code></pre>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
install.packages("AFM")
AFM::runAFMApp()

## End(Not run)
</code></pre>

<hr>
<h2 id='sampleAFMImage'>Get a sample of an AFM image.</h2><span id='topic+sampleAFMImage'></span>

<h3>Description</h3>

<p>Random selection of heights to keep in an <code><a href="#topic+AFMImage">AFMImage</a></code>.
This function can be used to calculate quickly an approximated variogram of a large image.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sampleAFMImage(AFMImage, percentage)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sampleAFMImage_+3A_afmimage">AFMImage</code></td>
<td>
<p>an <code><a href="#topic+AFMImage">AFMImage</a></code> from Atomic Force Microscopy</p>
</td></tr>
<tr><td><code id="sampleAFMImage_+3A_percentage">percentage</code></td>
<td>
<p>percentage of heights to keep</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>sampleAFMImage</code> returns a sample of the AFMImage to boost calculation time of variogram
</p>


<h3>Value</h3>

<p>a sample of an <code><a href="#topic+AFMImage">AFMImage</a></code>
</p>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(AFM)
library(ggplot2)

data(AFMImageOfAluminiumInterface)
anAFMImageSample&lt;-sampleAFMImage(AFMImageOfAluminiumInterface,15)
variogramAnalysis&lt;-AFMImageVariogramAnalysis(sampleFitPercentage=3.43)
avario&lt;-AFM::calculateOmnidirectionalVariogram(AFMImage= anAFMImageSample, 
                                               AFMImageVariogramAnalysis= variogramAnalysis)
dist&lt;-gamma&lt;-NULL
p1 &lt;- ggplot(avario, aes(x=dist, y=gamma))
p1 &lt;- p1 + geom_point()
p1 &lt;- p1 + geom_line()
p1 &lt;- p1 + ylab("semivariance")
p1 &lt;- p1 + xlab("distance (nm)")
p1 &lt;- p1 + ggtitle("Approximation of variogram thanks to sampling")
p1

## End(Not run)

</code></pre>

<hr>
<h2 id='saveOnDisk'>Save an AFM image on disk.</h2><span id='topic+saveOnDisk'></span>

<h3>Description</h3>

<p>The function saves the an <code><a href="#topic+AFMImage">AFMImage</a></code> as a rdata file. It uses the fullfilename param of the <code><a href="#topic+AFMImage">AFMImage</a></code> and add &quot;AFMImage.rda&quot; extension to save the rdata file on disk.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>saveOnDisk(AFMImage, exportDirectory)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="saveOnDisk_+3A_afmimage">AFMImage</code></td>
<td>
<p>an <code><a href="#topic+AFMImage">AFMImage</a></code> from Atomic Force Microscopy</p>
</td></tr>
<tr><td><code id="saveOnDisk_+3A_exportdirectory">exportDirectory</code></td>
<td>
<p>an optional argument to change the directory where the rdata file will be stored on disk</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>saveOnDisk</code> save on disk an <code><a href="#topic+AFMImage">AFMImage</a></code> as rdata file
</p>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(AFM)

data(AFMImageOfAluminiumInterface)
# save the rdata file of the AFMImage in the tempdir() directory;
# select another directory to save it permanently on your hard drive
saveOnDisk(AFMImageOfAluminiumInterface, tempdir())

## End(Not run)
</code></pre>

<hr>
<h2 id='saveOnDiskIntersectionForRoughnessAgainstLengthscale'>save an image of the roughness against lenghtscale calculations</h2><span id='topic+saveOnDiskIntersectionForRoughnessAgainstLengthscale'></span>

<h3>Description</h3>

<p><code><a href="#topic+saveOnDiskIntersectionForRoughnessAgainstLengthscale">saveOnDiskIntersectionForRoughnessAgainstLengthscale</a></code> save an image of the roughness against lenghtscale calculations
</p>


<h3>Usage</h3>

<pre><code class='language-R'>saveOnDiskIntersectionForRoughnessAgainstLengthscale(
  AFMImageAnalyser,
  exportDirectory
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="saveOnDiskIntersectionForRoughnessAgainstLengthscale_+3A_afmimageanalyser">AFMImageAnalyser</code></td>
<td>
<p>an <code><a href="#topic+AFMImageAnalyser">AFMImageAnalyser</a></code> to get Roughness against lenghtscale calculation</p>
</td></tr>
<tr><td><code id="saveOnDiskIntersectionForRoughnessAgainstLengthscale_+3A_exportdirectory">exportDirectory</code></td>
<td>
<p>a directory on the file system</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>

<hr>
<h2 id='saveSpplotFromAFMImage'>Save on disk an AFMImage as a Lattice (trellis) plot</h2><span id='topic+saveSpplotFromAFMImage'></span>

<h3>Description</h3>

<p>save a Lattice (trellis) plot of an <code><a href="#topic+AFMImage">AFMImage</a></code> using the <code><a href="sp.html#topic+spplot">spplot</a></code> method of the sp package.
This function is used to evaluate visually the quality of the predicted surface when a variogram model is used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>saveSpplotFromAFMImage(
  AFMImage,
  fullfilename,
  expectedWidth,
  expectHeight,
  withoutLegend
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="saveSpplotFromAFMImage_+3A_afmimage">AFMImage</code></td>
<td>
<p>an <code><a href="#topic+AFMImage">AFMImage</a></code> from Atomic Force Microscopy</p>
</td></tr>
<tr><td><code id="saveSpplotFromAFMImage_+3A_fullfilename">fullfilename</code></td>
<td>
<p>directory and filename to save to png</p>
</td></tr>
<tr><td><code id="saveSpplotFromAFMImage_+3A_expectedwidth">expectedWidth</code></td>
<td>
<p>(optional) expected width of the saved image. Default is 400px.</p>
</td></tr>
<tr><td><code id="saveSpplotFromAFMImage_+3A_expectheight">expectHeight</code></td>
<td>
<p>(optional) expected height of the saved image. Default is 300px.</p>
</td></tr>
<tr><td><code id="saveSpplotFromAFMImage_+3A_withoutlegend">withoutLegend</code></td>
<td>
<p>(optional) set at FALSE, the cuts legend will be included in the plot. Default is FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>saveSpplotFromAFMImage</code> save a a Lattice (trellis) plot of an <code><a href="#topic+AFMImage">AFMImage</a></code> on disk
</p>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(AFM)

data(AFMImageOfAluminiumInterface)
saveSpplotFromAFMImage(AFMImageOfAluminiumInterface,
                       paste(tempdir(), "myFileWithoutLegend.png", sep="/"), 800,800, TRUE)
saveSpplotFromAFMImage(AFMImageOfAluminiumInterface, 
                       paste(tempdir(), "myFileWithLegend.png", sep="/"), 800,800, FALSE)

## End(Not run)
</code></pre>

<hr>
<h2 id='shiftedPSDuv'>Calculate the shifted PSD matrix</h2><span id='topic+shiftedPSDuv'></span>

<h3>Description</h3>

<p><code>shiftedPSDuv</code> returns the Power Spectral Density matrix in the frequency space from shifted FFT 2D
</p>


<h3>Usage</h3>

<pre><code class='language-R'>shiftedPSDuv(AFMImage)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="shiftedPSDuv_+3A_afmimage">AFMImage</code></td>
<td>
<p>an <code><a href="#topic+AFMImage">AFMImage</a></code> from Atomic Force Microscopy</p>
</td></tr>
</table>


<h3>Value</h3>

<p>(1/NM^2) * abs(shiftedFFT2Ddata)^2) with N the number of lines of the sample and M the number of samples per line of the sample
</p>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(AFM)
library(ggplot2)

data(AFMImageOfRegularPeaks)
AFMImage&lt;-AFMImageOfRegularPeaks
nMheightsData= matrix(AFMImage@data$h, nrow=AFMImage@samplesperline)
shiftedPSDuv&lt;-shiftedPSDuv(AFMImage)
a=AFMImage@scansize
b=AFMImage@scansize

M=AFMImage@sampsline
N=AFMImage@lines
NM=N*M # pixels^2
MN = M*N 
A=a*b
ab=a*b

dx=a/M
dy=b/N

um = seq( (1-(M+1)/2)/(M*dx), (M-(M+1)/2)/(M*dx), by=1/(M*dx))
vn = seq( (1-(N+1)/2)/(N*dy), (N-(N+1)/2)/(N*dy), by=1/(N*dy))
x = rep(um, times = AFMImage@lines)
y = rep(vn, each = AFMImage@sampsline)
z = as.vector(shiftedPSDuv)

data&lt;-data.frame(x=x, y=y, z=z)

p5 &lt;- qplot(x, y, data=data, colour=log10(z))
p5 &lt;- p5 + scale_colour_gradientn(colours = rainbow(7))
p5 &lt;- p5 + ylab("v")
p5 &lt;- p5 + xlab("u")
title&lt;-paste("shifted PSD of", basename(AFMImage@fullfilename))
p5 &lt;- p5 + ggtitle(title)
# Hide all the horizontal gridlines
p5 &lt;- p5 + theme(panel.grid.minor.x=element_blank(), panel.grid.major.x=element_blank())
# Hide all the vertical gridlines
p5 &lt;- p5 + theme(panel.grid.minor.y=element_blank(), panel.grid.major.y=element_blank())
p5 &lt;- p5 + theme(panel.background = element_rect(fill = 'white', colour = 'black'))
p5

## End(Not run)
</code></pre>

<hr>
<h2 id='shiftFFT2D'>Shift the quadrants of the FFT 2D</h2><span id='topic+shiftFFT2D'></span>

<h3>Description</h3>

<p><code>shiftFFT2D</code> returns the FFT 2D matrix shifted to put zero frequencies in the middle.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>shiftFFT2D(fft2data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="shiftFFT2D_+3A_fft2data">fft2data</code></td>
<td>
<p>the FFT 2D of the AFM image</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The shifted matrix
</p>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(AFM)
library(fftwtools)

data(AFMImageOfNormallyDistributedHeights)
AFMImage&lt;-AFMImageOfNormallyDistributedHeights
nMheightsData= matrix(AFMImage@data$h, nrow=AFMImage@samplesperline)
shiftedFFT2D&lt;-shiftFFT2D(fftwtools::fftw2d(nMheightsData))

## End(Not run)
</code></pre>

<hr>
<h2 id='simplifyAFMImage'>simplify an AFM image.</h2><span id='topic+simplifyAFMImage'></span>

<h3>Description</h3>

<p>The simplification is taking a very simple gridded sample of the image. 
It can be useful to speed up display.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simplifyAFMImage(AFMImage, newSamplesperline, newLines)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simplifyAFMImage_+3A_afmimage">AFMImage</code></td>
<td>
<p>an <code><a href="#topic+AFMImage">AFMImage</a></code> from Atomic Force Microscopy</p>
</td></tr>
<tr><td><code id="simplifyAFMImage_+3A_newsamplesperline">newSamplesperline</code></td>
<td>
<p>the new number of samplesperline of the AFMImage</p>
</td></tr>
<tr><td><code id="simplifyAFMImage_+3A_newlines">newLines</code></td>
<td>
<p>the new number of lines of the AFMImage</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>simplifyAFMImage</code> returns a simplified AFMImage
</p>


<h3>Value</h3>

<p>a new simplified <code><a href="#topic+AFMImage">AFMImage</a></code>
</p>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  data(AFMImageOfAluminiumInterface)
  anAFMImageExtract&lt;-simplifyAFMImage(AFMImageOfAluminiumInterface,16,16)

## End(Not run)

</code></pre>

<hr>
<h2 id='simplifyNetwork'>simplifyNetwork</h2><span id='topic+simplifyNetwork'></span>

<h3>Description</h3>

<p>simplify the network keeping only the important edges
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simplifyNetwork(..., allVertices, allEdges)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simplifyNetwork_+3A_...">...</code></td>
<td>
<p>cl: a cluster object from the parallel package</p>
</td></tr>
<tr><td><code id="simplifyNetwork_+3A_allvertices">allVertices</code></td>
<td>
<p>a data.table of vertices</p>
</td></tr>
<tr><td><code id="simplifyNetwork_+3A_alledges">allEdges</code></td>
<td>
<p>a data.table of edges</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.table of edges
</p>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>

<hr>
<h2 id='thinImage'>thin an Image in matrix format</h2><span id='topic+thinImage'></span>

<h3>Description</h3>

<p>thin an Image in matrix format
</p>


<h3>Usage</h3>

<pre><code class='language-R'>thinImage(imageMatrix)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="thinImage_+3A_imagematrix">imageMatrix</code></td>
<td>
<p>a matrix of an AFM image</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>

<hr>
<h2 id='totalRMSRoughness'>Calculate the total Root Mean Square Roughness (Rrms total)</h2><span id='topic+totalRMSRoughness'></span>

<h3>Description</h3>

<p><code>totalRMSRoughness</code> returns the total RMS roughness calculated from the variance of heights
</p>


<h3>Usage</h3>

<pre><code class='language-R'>totalRMSRoughness(AFMImage)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="totalRMSRoughness_+3A_afmimage">AFMImage</code></td>
<td>
<p>an <code><a href="#topic+AFMImage">AFMImage</a></code> from Atomic Force Microscopy</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a numeric as the square root of the variance of heights
</p>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(AFM)

data(AFMImageOfAluminiumInterface)
totalRMSRoughness&lt;-totalRMSRoughness(AFMImageOfAluminiumInterface)
print(totalRMSRoughness)

## End(Not run)

</code></pre>

<hr>
<h2 id='transformAFMImageForNetworkAnalysis'>Multiply, filter the heights and make a binary AFMImage from the transformed AFMImage</h2><span id='topic+transformAFMImageForNetworkAnalysis'></span><span id='topic+transformAFMImageForNetworkAnalysis+2CAFMImageNetworksAnalysis-method'></span><span id='topic+transformAFMImageForNetworkAnalysis+2CAFMImage-method'></span>

<h3>Description</h3>

<p><code>transformAFMImageForNetworkAnalysis</code> update  <code><a href="#topic+AFMImageNetworksAnalysis">AFMImageNetworksAnalysis</a></code> making a binary AFMImage
</p>


<h3>Usage</h3>

<pre><code class='language-R'>transformAFMImageForNetworkAnalysis(AFMImageNetworksAnalysis, AFMImage)

## S4 method for signature 'AFMImageNetworksAnalysis'
transformAFMImageForNetworkAnalysis(AFMImageNetworksAnalysis, AFMImage)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="transformAFMImageForNetworkAnalysis_+3A_afmimagenetworksanalysis">AFMImageNetworksAnalysis</code></td>
<td>
<p>n <code><a href="#topic+AFMImageNetworksAnalysis">AFMImageNetworksAnalysis</a></code> to store the results of the transformation</p>
</td></tr>
<tr><td><code id="transformAFMImageForNetworkAnalysis_+3A_afmimage">AFMImage</code></td>
<td>
<p>an <code><a href="#topic+AFMImage">AFMImage</a></code> from Atomic Force Microscopy</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>M.Beauvais
</p>

<hr>
<h2 id='updateProgress'>updateProgress</h2><span id='topic+updateProgress'></span><span id='topic+updateProgress+2CAFMImageVariogramAnalysis-method'></span>

<h3>Description</h3>

<p>is a function used by a GUI such as shiny GUI
</p>


<h3>Usage</h3>

<pre><code class='language-R'>updateProgress(AFMImageVariogramAnalysis, value, detail, message)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="updateProgress_+3A_afmimagevariogramanalysis">AFMImageVariogramAnalysis</code></td>
<td>
<p>an <code><a href="#topic+AFMImageVariogramAnalysis">AFMImageVariogramAnalysis</a></code></p>
</td></tr>
<tr><td><code id="updateProgress_+3A_value">value</code></td>
<td>
<p>shiny progress bar value</p>
</td></tr>
<tr><td><code id="updateProgress_+3A_detail">detail</code></td>
<td>
<p>shiny progress bar detail</p>
</td></tr>
<tr><td><code id="updateProgress_+3A_message">message</code></td>
<td>
<p>shiny progress bar message</p>
</td></tr>
</table>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
