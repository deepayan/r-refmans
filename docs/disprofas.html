<!DOCTYPE html><html><head><title>Help for package disprofas</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {disprofas}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#balance_observations'><p>Balance observations</p></a></li>
<li><a href='#bootstrap_f2'><p>Bootstrap f2</p></a></li>
<li><a href='#dip1'><p>Dissolution data of a reference and a test batch</p></a></li>
<li><a href='#dip2'><p>Dissolution data of one reference batch and five test batches</p></a></li>
<li><a href='#dip3'><p>Dissolution data of two different capsule formulations</p></a></li>
<li><a href='#dip4'><p>Dissolution data of two different formulations</p></a></li>
<li><a href='#dip5'><p>Fluid weights of drink cans</p></a></li>
<li><a href='#f1'><p>Dissimilarity factor f1 for dissolution data</p></a></li>
<li><a href='#f2'><p>Similarity factor f2 for dissolution data</p></a></li>
<li><a href='#gep_by_nera'><p>Points on confidence region (found by Newton-Raphson search)</p></a></li>
<li><a href='#get_f1'><p>Get the f1 dissimilarity factor</p></a></li>
<li><a href='#get_f2'><p>Get the f2 similarity factor</p></a></li>
<li><a href='#get_hotellings'><p>Hotelling's statistics (for two independent (small) samples)</p></a></li>
<li><a href='#get_jackknife_values'><p>Jackknife values</p></a></li>
<li><a href='#get_profile_portion'><p>Profile portion determination</p></a></li>
<li><a href='#get_sim_lim'><p>Similarity limit</p></a></li>
<li><a href='#get_time_points'><p>Get time points</p></a></li>
<li><a href='#make_grouping'><p>Grouping</p></a></li>
<li><a href='#mimcr'><p>Model-independent multivariate confidence region (MIMCR) procedure</p></a></li>
<li><a href='#mztia'><p>Martinez &amp; Zhao Tolerance Interval Approach</p></a></li>
<li><a href='#plot_mztia'><p>Graphical representation of the of MZTIA estimation</p></a></li>
<li><a href='#plot.bootstrap_f2'><p>Plot of the bootstrap f2 simulation</p></a></li>
<li><a href='#plot.plot_mztia'><p>Plot of the mztia simulation</p></a></li>
<li><a href='#print.bootstrap_f2'><p>Print a summary of the bootstrap f2 simulation</p></a></li>
<li><a href='#print.mimcr'><p>Print a summary of MIMCR estimation</p></a></li>
<li><a href='#print.mztia'><p>Print a summary of MZTIA estimation</p></a></li>
<li><a href='#print.plot_mztia'><p>Print a plot of MZTIA estimation</p></a></li>
<li><a href='#rand_indiv_points'><p>Randomisation of individual data points</p></a></li>
<li><a href='#summary.bootstrap_f2'><p>Summary of the bootstrap f2 simulation</p></a></li>
<li><a href='#summary.mimcr'><p>Summary of MIMCR estimation</p></a></li>
<li><a href='#summary.mztia'><p>Summary of MZTIA estimation</p></a></li>
<li><a href='#try_get_model'><p>Try getting results from expression</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Non-Parametric Dissolution Profile Analysis</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.3</td>
</tr>
<tr>
<td>Description:</td>
<td>Similarity of dissolution profiles is assessed using the
    similarity factor f2 according to the EMA guideline (European
    Medicines Agency 2010) "On the investigation of bioequivalence".
    Dissolution profiles are regarded as similar if the f2 value is
    between 50 and 100. For the applicability of the similarity factor f2,
    the variability between profiles needs to be within certain limits.
    Often, this constraint is violated. One possibility in this situation
    is to resample the measured profiles in order to obtain a bootstrap
    estimate of f2 (Shah et al. (1998) &lt;<a href="https://doi.org/10.1023%2FA%3A1011976615750">doi:10.1023/A:1011976615750</a>&gt;).
    Other alternatives are the model-independent non-parametric
    multivariate confidence region (MCR) procedure (Tsong et al. (1996)
    &lt;<a href="https://doi.org/10.1177%2F009286159603000427">doi:10.1177/009286159603000427</a>&gt;) or the T2-test for equivalence
    procedure (Hoffelder (2016)
    <a href="https://www.ecv.de/suse_item.php?suseId=Z%7Cpi%7C8430">https://www.ecv.de/suse_item.php?suseId=Z|pi|8430</a>). Functions for
    estimation of f1, f2, bootstrap f2, MCR / T2-test for equivalence
    procedure are implemented.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/piusdahinden/disprofas">https://github.com/piusdahinden/disprofas</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/piusdahinden/disprofas/issues">https://github.com/piusdahinden/disprofas/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5)</td>
</tr>
<tr>
<td>Imports:</td>
<td>boot, ggplot2</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, T2EQ</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-12-08 05:53:13 UTC; piusd</td>
</tr>
<tr>
<td>Author:</td>
<td>Pius Dahinden [aut, cre],
  Tillotts Pharma AG [cph, fnd]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Pius Dahinden &lt;pius.dahinden@tillotts.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-12-08 12:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='balance_observations'>Balance observations</h2><span id='topic+balance_observations'></span>

<h3>Description</h3>

<p>The function <code>balance_observations()</code> balances the number of
observations of two groups.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>balance_observations(data, groups, n_obs)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="balance_observations_+3A_data">data</code></td>
<td>
<p>A data frame with the dissolution profile data in wide format.</p>
</td></tr>
<tr><td><code id="balance_observations_+3A_groups">groups</code></td>
<td>
<p>A logical vector specifying different groups.</p>
</td></tr>
<tr><td><code id="balance_observations_+3A_n_obs">n_obs</code></td>
<td>
<p>An integer specifying the minimal number of observations each
group should have.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>First, the largest common value between <code>n_obs</code> and the number
of observations of the two groups specified by <code>groups</code> is sought. Then,
the number of observations of the two groups are extended according to the
value found. Extension means that the maximal possible number of
observations is duplicated in order to obtain the required number of
observations. Thus, in the data frame that is returned the two groups will
have the same number of observations. Either the number of observations of
both groups is extended (to match the number of <code>n_obs</code>), or, if
<code>n_obs</code> and the number of observations of one of the two groups is
equal, only the number of observations of one of the two groups.
</p>


<h3>Value</h3>

<p>The original data frame extended by the observations necessary to
have a balanced number of observations between the two groups.
</p>

<hr>
<h2 id='bootstrap_f2'>Bootstrap f2</h2><span id='topic+bootstrap_f2'></span>

<h3>Description</h3>

<p>The function <code>bootstrap_f2()</code> generates <code>R</code> bootstrap replicates
of the similarity factor <code class="reqn">f_2</code> based on resampling of complete profiles
(nonparametric bootstrap) or on resampling per time point the values
between profiles (parametric bootstrap). Estimates of &ldquo;normal&rdquo;,
&ldquo;basic&rdquo;, &ldquo;student&rdquo;, &ldquo;percent&rdquo; and of
&ldquo;bias-corrected, accelerated&rdquo; (BCa) percentile intervals are returned.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bootstrap_f2(
  data,
  tcol,
  grouping,
  rand_mode = "complete",
  R = 999,
  each = 12,
  new_seed = 100,
  confid = 0.9,
  use_EMA = "no",
  bounds = c(1, 85),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bootstrap_f2_+3A_data">data</code></td>
<td>
<p>A data frame with the dissolution profile data in wide format.</p>
</td></tr>
<tr><td><code id="bootstrap_f2_+3A_tcol">tcol</code></td>
<td>
<p>A vector of indices specifying the columns in <code>data</code> that
contain the % release values. The length of <code>tcol</code> must be three or
longer.</p>
</td></tr>
<tr><td><code id="bootstrap_f2_+3A_grouping">grouping</code></td>
<td>
<p>A character string specifying the column in <code>data</code> that
contains the group names (i.e. a factorial variable, e.g., for the
differentiation of batches or formulations of a drug product).</p>
</td></tr>
<tr><td><code id="bootstrap_f2_+3A_rand_mode">rand_mode</code></td>
<td>
<p>A character string indicating if complete profiles shall be
randomised (<code>"complete"</code>, the default) or individual data points
(<code>"individual"</code>).</p>
</td></tr>
<tr><td><code id="bootstrap_f2_+3A_r">R</code></td>
<td>
<p>An integer specifying the number of bootstrap replicates. The
default is <code>999</code>.</p>
</td></tr>
<tr><td><code id="bootstrap_f2_+3A_each">each</code></td>
<td>
<p>An integer specifying the number of dissolution profiles to be
selected per group per randomisation round. The default is <code>12</code>.</p>
</td></tr>
<tr><td><code id="bootstrap_f2_+3A_new_seed">new_seed</code></td>
<td>
<p>An integer for setting the seed for random number generation.
The default is <code>100</code>.</p>
</td></tr>
<tr><td><code id="bootstrap_f2_+3A_confid">confid</code></td>
<td>
<p>A numeric value between 0 and 1 specifying the confidence limit
for the calculation of the bootstrap confidence intervals. The default is
<code>0.9</code>.</p>
</td></tr>
<tr><td><code id="bootstrap_f2_+3A_use_ema">use_EMA</code></td>
<td>
<p>A character string indicating if the similarity factor
<code class="reqn">f_2</code> should be calculated according to the EMA guideline &ldquo;On
the investigation of bioequivalence&rdquo; (<code>"yes"</code>) or not (<code>"no"</code>,
the default). The default is <code>"no"</code> because the bootstrap <code class="reqn">f_2</code>
method is one of the possible solutions if the condition concerning the
variability between the profiles does not allow the evaluation of <code class="reqn">f_2</code>
according to the EMA guideline. A third option is <code>"ignore"</code>. If
<code>use_EMA</code> is <code>"yes"</code> or <code>"no"</code> the appropriate profile
portion is determined on the basis of the values of the parameter
<code>bounds</code>. If it is <code>"ignore"</code>, the complete profiles are used as
specified by the parameter <code>tcol</code>.</p>
</td></tr>
<tr><td><code id="bootstrap_f2_+3A_bounds">bounds</code></td>
<td>
<p>A numeric vector of the form <code>c(lower, upper)</code> specifying
the &ldquo;lower&rdquo; and &ldquo;upper&rdquo; limits, respectively, for the %
drug release given that <code>use_EMA</code> is <code>"no"</code>. The default is
<code>c(1, 85)</code>. Mean % release values of any of the two groups being
compared that are smaller than or equal to the lower bound are ignored and
only the first mean % release value that is greater than or equal to the
upper bound is included while all the subsequent values are ignored. If
<code>use_EMA</code> is <code>"yes"</code> the <code>bounds</code> are <code>c(1, 85)</code> per
definition.</p>
</td></tr>
<tr><td><code id="bootstrap_f2_+3A_...">...</code></td>
<td>
<p>Named parameters of the functions <code>stat.fun()</code>,
<code>ran.fun()</code> and <code>boot()</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Information on <code class="reqn">f_2</code> can be found in at least three FDA
guidances and in the guideline of the European Medicines Agency (EMA)
&ldquo;On the investigation of bioequivalence&rdquo; (EMA 2010). For the
assessment of the similarity of dissolution profiles using the similarity
factor <code class="reqn">f_2</code> according to the EMA guideline the following constraints
do apply:
</p>

<ol>
<li><p> A minimum of three time points (without zero) are necessary.
</p>
</li>
<li><p> The time points should be the same for the two formulations.
</p>
</li>
<li><p> For every time point and for each formulation at least 12 data points
are required.
</p>
</li>
<li><p> A maximum of one mean value per formulation may be &gt; 85% dissolved.
</p>
</li>
<li><p> The coefficient of variation (%CV) should be &lt; 20% for the first
time point and &lt; 10% from the second to the last time point for any
formulation.
</p>
</li></ol>

<p>Dissolution profiles are regarded as similar if the <code class="reqn">f_2</code> value is
between 50 and 100. <br />
</p>
<p>One often encountered problem is that the %CV constraint cannot be
fulfilled. One possibility in this situation is the use of the bootstrap
<code class="reqn">f_2</code> method (Shah 1998) by which the distribution of <code class="reqn">f_2</code> is
simulated to obtain an unbiased estimate of the expected value of <code class="reqn">f_2</code>
and the variability of the underlying distribution. For the <code class="reqn">f_2</code>
calculation only those parts of the profiles are taken into account where
the means (per formulation) are <code class="reqn">&gt; d</code>% dissolved (e.g., <code class="reqn">d = 1</code>)
and a maximum of one mean value per formulation is <code class="reqn">&gt; 85</code>% dissolved.
In the literature it is suggested to make use of the lower 90% bias
corrected and accelerated (BCa) confidence interval (CI) limit to come to
a decision in terms of similarity (Stevens (2015)).
</p>


<h3>Value</h3>

<p>An object of class &lsquo;<code>bootstrap_f2</code>&rsquo; is returned,
containing the following list elements:
</p>
<table>
<tr><td><code>Boot</code></td>
<td>
<p>An object of class &lsquo;<code>boot</code>&rsquo; with the corresponding
components.</p>
</td></tr>
<tr><td><code>Profile.TP</code></td>
<td>
<p>A named numeric vector of the columns in <code>data</code>
specified by <code>tcol</code> and depending on the selection of <code>use_EMA</code>.
Given that the column names contain extractable numeric information,
e.g., specifying the testing time points of the dissolution profile, it
contains the corresponding values. Elements where no numeric information
could be extracted are <code>NA</code>.</p>
</td></tr>
<tr><td><code>L</code></td>
<td>
<p>A vector of the Jackknife leave-one-out-values.</p>
</td></tr>
<tr><td><code>CI</code></td>
<td>
<p>An object of class &lsquo;<code>bootci</code>&rsquo; which contains the
intervals.</p>
</td></tr>
<tr><td><code>BCa_CI</code></td>
<td>
<p>The lower and upper limits of the BCa interval calculated
by the <code>boot.ci()</code> function from the &lsquo;<code>boot</code>&rsquo; package.</p>
</td></tr>
<tr><td><code>ShahBCa_CI</code></td>
<td>
<p>The lower and upper limits of the BCa interval calculated
according to Shah (Shah 1998).</p>
</td></tr>
</table>


<h3>References</h3>

<p>United States Food and Drug Administration (FDA). Guidance for industry:
dissolution testing of immediate release solid oral dosage forms. 1997.<br />
<a href="https://www.fda.gov/media/70936/download">https://www.fda.gov/media/70936/download</a>
</p>
<p>United States Food and Drug Administration (FDA). Guidance for industry:
immediate release solid oral dosage form: scale-up and post-approval
changes, chemistry, manufacturing and controls, <em>in vitro</em> dissolution
testing, and <em>in vivo</em> bioequivalence documentation (SUPAC-IR). 1995.<br />
<a href="https://www.fda.gov/media/70949/download">https://www.fda.gov/media/70949/download</a>
</p>
<p>European Medicines Agency (EMA), Committee for Medicinal Products for
Human Use (CHMP). Guideline on the Investigation of Bioequivalence. 2010;
CPMP/EWP/QWP/1401/98 Rev. 1.<br />
<a href="https://www.ema.europa.eu/en/documents/scientific-guideline/guideline-investigation-bioequivalence-rev1_en.pdf">https://www.ema.europa.eu/en/documents/scientific-guideline/guideline-investigation-bioequivalence-rev1_en.pdf</a>
</p>
<p>Stevens, R. E., Gray, V., Dorantes, A., Gold, L., and Pham, L. Scientific
and regulatory standards for assessing product performance using the
similarity factor, <code class="reqn">f_2</code>. <em>AAPS Journal</em>. 2015; <strong>17</strong>(2):
301-306.<br />
doi: <a href="https://doi.org/10.1208/s12248-015-9723-y">10.1208/s12248-015-9723-y</a>
</p>
<p>Shah, V. P., Tsong, Y., Sathe, P., and Liu, J. P. <em>In vitro</em> dissolution
profile comparison - statistics and analysis of the similarity factor,
<code class="reqn">f_2</code>. <em>Pharm Res</em>. 1998; <strong>15</strong>(6): 889-896.<br />
doi: <a href="https://doi.org/10.1023/A:1011976615750">10.1023/A:1011976615750</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_jackknife_values">get_jackknife_values</a></code>, <code><a href="boot.html#topic+boot">boot</a></code>,
<code><a href="boot.html#topic+boot.ci">boot.ci</a></code>, <code><a href="#topic+mimcr">mimcr</a></code>, <code><a href="#topic+mztia">mztia</a></code>.
</p>

<hr>
<h2 id='dip1'>Dissolution data of a reference and a test batch</h2><span id='topic+dip1'></span>

<h3>Description</h3>

<p>A data set containing the dissolution data of one reference batch and one
test batch of <code class="reqn">n = 6</code> tablets each, i.e. the dissolution profiles of
the % drug release observed within a period of 120 minutes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(dip1)
</code></pre>


<h3>Format</h3>

<p>A data frame with 12 observations and 10 variables:
</p>

<dl>
<dt>type</dt><dd><p>Factor with levels <code>R</code> (Reference) and <code>T</code> (Test)</p>
</dd>
<dt>tablet</dt><dd><p>Factor with levels <code>1</code> to <code>6</code> representing
individual tablets</p>
</dd>
<dt>t.5</dt><dd><p>Numeric of the % release at the 5 minutes testing point</p>
</dd>
<dt>t.10</dt><dd><p>Numeric of the % release at the 10 minutes testing point</p>
</dd>
<dt>t.15</dt><dd><p>Numeric of the % release at the 15 minutes testing point</p>
</dd>
<dt>t.20</dt><dd><p>Numeric of the % release at the 20 minutes testing point</p>
</dd>
<dt>t.30</dt><dd><p>Numeric of the % release at the 30 minutes testing point</p>
</dd>
<dt>t.60</dt><dd><p>Numeric of the % release at the 60 minutes testing point</p>
</dd>
<dt>t.90</dt><dd><p>Numeric of the % release at the 90 minutes testing point</p>
</dd>
<dt>t.120</dt><dd><p>Numeric of the % release at the 120 minutes testing point</p>
</dd>
</dl>



<h3>Source</h3>

<p>See reference: Example data set shown in Table 1.
</p>


<h3>References</h3>

<p>Tsong, Y., Hammerstrom, T., Sathe, P.M., and Shah, V.P. Statistical
assessment of mean differences between two dissolution data sets.
<em>Drug Inf J</em>. 1996; <strong>30</strong>: 1105-1112.<br />
doi: <a href="https://doi.org/10.1177/009286159603000427">10.1177/009286159603000427</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>str(dip1)
</code></pre>

<hr>
<h2 id='dip2'>Dissolution data of one reference batch and five test batches</h2><span id='topic+dip2'></span>

<h3>Description</h3>

<p>A data set containing the dissolution data of one reference batch and five
test batches of <code class="reqn">n = 12</code> tablets each, i.e. the dissolution profiles
of the % drug release observed within a period of 180 minutes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(dip2)
</code></pre>


<h3>Format</h3>

<p>A data frame with 72 observations and 8 variables:
</p>

<dl>
<dt>type</dt><dd><p>Factor with levels <code>Reference</code> and <code>Test</code></p>
</dd>
<dt>tablet</dt><dd><p>Factor with levels <code>1</code> to <code>12</code> representing
individual tablets</p>
</dd>
<dt>batch</dt><dd><p>Factor with levels <code>b0</code>, <code>b1</code>, <code>b2</code>, <code>b3</code>,
<code>b4</code> and <code>b5</code></p>
</dd>
<dt>t.0</dt><dd><p>Numeric of the % release at the initial testing point</p>
</dd>
<dt>t.30</dt><dd><p>Numeric of the % release at the 30 minutes testing point</p>
</dd>
<dt>t.60</dt><dd><p>Numeric of the % release at the 60 minutes testing point</p>
</dd>
<dt>t.90</dt><dd><p>Numeric of the % release at the 90 minutes testing point</p>
</dd>
<dt>t.180</dt><dd><p>Numeric of the % release at the 180 minutes testing point</p>
</dd>
</dl>



<h3>Source</h3>

<p>See reference: Example data set shown in Table 4.
</p>


<h3>References</h3>

<p>Shah, V. P., Tsong, Y., Sathe, P., and Liu, J. P. <em>In vitro</em> dissolution
profile comparison - statistics and analysis of the similarity factor,
<code class="reqn">f_2</code>. <em>Pharm Res</em>. 1998; <strong>15</strong>(6): 889-896.<br />
doi: <a href="https://doi.org/10.1023/A:1011976615750">10.1023/A:1011976615750</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>str(dip2)
</code></pre>

<hr>
<h2 id='dip3'>Dissolution data of two different capsule formulations</h2><span id='topic+dip3'></span>

<h3>Description</h3>

<p>A data set containing the dissolution data of one reference batch and one
test batch of <code class="reqn">n = 12</code> capsules each, i.e. the dissolution profiles
of the % drug release observed at 15, 20 and 25 minutes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(dip3)
</code></pre>


<h3>Format</h3>

<p>A data frame with 24 observations and 6 variables:
</p>

<dl>
<dt>cap</dt><dd><p>Factor with levels <code>1</code> to <code>12</code> representing individual
capsules</p>
</dd>
<dt>batch</dt><dd><p>Factor with levels <code>white</code> and <code>blue</code> representing
the colours of two different capsule formulations</p>
</dd>
<dt>type</dt><dd><p>Factor with levels <code>ref</code> (Reference) and <code>test</code>
(Test)</p>
</dd>
<dt>x.15</dt><dd><p>Numeric of the % release at the 15 minutes testing point</p>
</dd>
<dt>x.20</dt><dd><p>Numeric of the % release at the 20 minutes testing point</p>
</dd>
<dt>x.25</dt><dd><p>Numeric of the % release at the 25 minutes testing point</p>
</dd>
</dl>



<h3>Source</h3>

<p>See reference: Example data set shown in Table 1. Data set
&lsquo;<code>ex_data_JoBS</code>&rsquo; from package &lsquo;<code>T2EQ</code>&rsquo;.
</p>


<h3>References</h3>

<p>Hoffelder, T., Goessl, R., and Wellek, S. Multivariate equivalence tests for
use in pharmaceutical development. <em>J Biopharm Stat</em> (2015)
<strong>25</strong>(3): 417-437.<br />
doi: <a href="https://doi.org/10.1080/10543406.2014.920344">10.1080/10543406.2014.920344</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>str(dip3)

if (requireNamespace("T2EQ")) {
library(T2EQ)

  data(ex_data_JoBS, envir = environment())
  str(ex_data_JoBS)
  rm(ex_data_JoBS)
}
</code></pre>

<hr>
<h2 id='dip4'>Dissolution data of two different formulations</h2><span id='topic+dip4'></span>

<h3>Description</h3>

<p>A data set containing the dissolution data of one reference batch and one
test batch of <code class="reqn">n = 12</code> items each, i.e. the dissolution profiles of
the % drug release observed at 10, 20 and 30 minutes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(dip4)
</code></pre>


<h3>Format</h3>

<p>A data frame with 24 observations and 2 variables:
</p>

<dl>
<dt>type</dt><dd><p>Factor with levels <code>ref</code> (Reference) and <code>test</code>
(Test)</p>
</dd>
<dt>x.10</dt><dd><p>Numeric of the % release at the 10 minutes testing point</p>
</dd>
<dt>x.20</dt><dd><p>Numeric of the % release at the 20 minutes testing point</p>
</dd>
<dt>x.30</dt><dd><p>Numeric of the % release at the 30 minutes testing point</p>
</dd>
</dl>



<h3>Source</h3>

<p>See reference: Example data set underlying Figure 1. Data set
&lsquo;<code>ex_data_pharmind</code>&rsquo; from package &lsquo;<code>T2EQ</code>&rsquo;.
</p>


<h3>References</h3>

<p>Hoffelder, T. Highly variable dissolution profiles. Comparison of
<code class="reqn">T^2</code>-test for equivalence and <code class="reqn">f_2</code> based methods. <em>Pharm Ind</em>.
2016; <strong>78</strong>(4): 587-592.<br />
<a href="https://www.ecv.de/suse_item.php?suseId=Z%7Cpi%7C8430">https://www.ecv.de/suse_item.php?suseId=Z|pi|8430</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>str(dip4)

if (requireNamespace("T2EQ")) {
library(T2EQ)

  data(ex_data_pharmind, envir = environment())
  str(ex_data_pharmind)
  rm(ex_data_pharmind)
}
</code></pre>

<hr>
<h2 id='dip5'>Fluid weights of drink cans</h2><span id='topic+dip5'></span>

<h3>Description</h3>

<p>The <code>response</code> values of this data set correspond to the values
published in the SAS/QC(R) 13.1 (2013) User's Guide, Chapter 5 (The
CAPABILITY Procedure). The data set is described on page 199: The fluid
weights of 100 drink cans were measured in ounces. The filling process is
assumed to be in statistical control.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(dip5)
</code></pre>


<h3>Format</h3>

<p>A data frame with 100 observations and 3 variables:
</p>

<dl>
<dt>type</dt><dd><p>Factor with the single level <code>reference</code></p>
</dd>
<dt>batch</dt><dd><p>Factor with levels <code>b1</code> to <code>b100</code></p>
</dd>
<dt>weight</dt><dd><p>Weight of drink cans</p>
</dd>
</dl>



<h3>Source</h3>

<p>See reference: Chapter 5 (The CAPABILITY Procedure), Cans data set shown
on page 199.
</p>


<h3>References</h3>

<p>SAS Institute Inc. 2013. <em>SAS/QC(R) 13.1 User's Guide</em>. Cary, NC:
SAS Institute Inc.<br />
<a href="https://support.sas.com/documentation/cdl/en/qcug/66857/PDF/default/qcug.pdf">https://support.sas.com/documentation/cdl/en/qcug/66857/PDF/default/qcug.pdf</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>str(dip5)
</code></pre>

<hr>
<h2 id='f1'>Dissimilarity factor f1 for dissolution data</h2><span id='topic+f1'></span>

<h3>Description</h3>

<p>The function <code>f1()</code> calculates the dissimilarity factor <code class="reqn">f_1</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>f1(data, tcol, grouping, use_EMA = "yes", bounds = c(1, 85))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="f1_+3A_data">data</code></td>
<td>
<p>A data frame with the dissolution profile data in wide format.</p>
</td></tr>
<tr><td><code id="f1_+3A_tcol">tcol</code></td>
<td>
<p>A vector of indices specifying the columns in <code>data</code> that
contain the % release values. The length of <code>tcol</code> must be three or
longer.</p>
</td></tr>
<tr><td><code id="f1_+3A_grouping">grouping</code></td>
<td>
<p>A character string specifying the column in <code>data</code> that
contains the group names (i.e. a factorial variable, e.g., for the
differentiation of batches or formulations of a drug product).</p>
</td></tr>
<tr><td><code id="f1_+3A_use_ema">use_EMA</code></td>
<td>
<p>A character string indicating if the dissimilarity factor
<code class="reqn">f_1</code> should be calculated following the EMA guideline &ldquo;On
the investigation of bioequivalence&rdquo; (<code>"yes"</code>, the default) or not
(<code>"no"</code>), i.e. the recommendations concerning the similarity factor
<code class="reqn">f_2</code>. A third option is <code>"ignore"</code>. If <code>use_EMA</code> is
<code>"yes"</code> or <code>"no"</code> the appropriate profile portion is determined
on the basis of the values of the parameter <code>bounds</code>. If it is
<code>"ignore"</code>, the complete profiles are used as specified by the
parameter <code>tcol</code>.</p>
</td></tr>
<tr><td><code id="f1_+3A_bounds">bounds</code></td>
<td>
<p>A numeric vector of the form <code>c(lower, upper)</code> specifying
the &ldquo;lower&rdquo; and &ldquo;upper&rdquo; limits, respectively, for the %
drug release given that <code>use_EMA</code> is <code>"no"</code>. The default is
<code>c(1, 85)</code>. Mean % release values of any of the two groups being
compared that are smaller than or equal to the lower bound are ignored and
only the first mean % release value that is greater than or equal to the
upper bound is included while all the subsequent values are ignored. If
<code>use_EMA</code> is <code>"yes"</code> the <code>bounds</code> are <code>c(1, 85)</code> per
definition.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Similarity of dissolution profiles is often assessed using the
similarity factor <code class="reqn">f_2</code>, as recommended by the EMA guideline (European
Medicines Agency 2010) &ldquo;On the investigation of bioequivalence&rdquo;. The
evaluation of the similarity factor is based on the following constraints:
</p>

<ol>
<li><p> A minimum of three time points (zero excluded).
</p>
</li>
<li><p> The time points should be the same for the two formulations.
</p>
</li>
<li><p> Twelve individual values for every time point for each formulation.
</p>
</li>
<li><p> Not more than one mean value of &gt; 85% dissolved for any of the
formulations.
</p>
</li>
<li><p> The relative standard deviation or coefficient of variation of any
product should be less than 20% for the first time point and less than
10% from the second to the last time point.
</p>
</li></ol>

<p>The <em>dis</em>similarity factor, or difference factor, <code class="reqn">f_1</code>, is the
counterpart of the similarity factor <code class="reqn">f_2</code>. The difference factor
<code class="reqn">f_1</code> is a measure of the relative error between two curves. Current FDA
guidelines suggest that two profiles can be considered similar if <code class="reqn">f_1</code>
is less than <code class="reqn">15</code> (<code class="reqn">0 - 15</code>) and <code class="reqn">f_2</code> is greater than <code class="reqn">50</code>
(<code class="reqn">50 - 100</code>), which is equivalent to an average difference of 10% at
all sampling time points. The dissimilarity factor <code class="reqn">f_1</code> is calculated
by aid of the equation
</p>
<p style="text-align: center;"><code class="reqn">f_1 = 100 \times \frac{\sum_{t=1}^{n} \left( \left| \bar{R}(t) -
  \bar{T}(t) \right| \right)}{\sum_{t=1}^{n} (\bar{R}(t))} .</code>
</p>

<p>In this equation
</p>

<dl>
<dt><code class="reqn">f_1</code></dt><dd><p>is the dissimilarity factor,</p>
</dd>
<dt><code class="reqn">n</code></dt><dd><p>is the number of time points,</p>
</dd>
<dt><code class="reqn">\bar{R}(t)</code></dt><dd><p>is the mean percent reference drug
dissolved at time <code class="reqn">t</code> after initiation of the study, and</p>
</dd>
<dt><code class="reqn">\bar{T}(t)</code></dt><dd><p>is the mean percent test drug dissolved
at time <code class="reqn">t</code> after initiation of the study.</p>
</dd>
</dl>



<h3>Value</h3>

<p>A list with the following elements is returned:
</p>
<table>
<tr><td><code>f1</code></td>
<td>
<p>A numeric value representing the similarity factor <code class="reqn">f_1</code>.</p>
</td></tr>
<tr><td><code>Profile.TP</code></td>
<td>
<p>A named numeric vector of the columns in <code>data</code>
specified by <code>tcol</code> and depending on the selection of <code>use_EMA</code>.
Given that the column names contain extractable numeric information,
e.g., specifying the testing time points of the dissolution profile, it
contains the corresponding values. Elements where no numeric information
could be extracted are <code>NA</code>.</p>
</td></tr>
</table>


<h3>References</h3>

<p>United States Food and Drug Administration (FDA). Guidance for industry:
dissolution testing of immediate release solid oral dosage forms. 1997.<br />
<a href="https://www.fda.gov/media/70936/download">https://www.fda.gov/media/70936/download</a>
</p>
<p>United States Food and Drug Administration (FDA). Guidance for industry:
immediate release solid oral dosage form: scale-up and post-approval
changes, chemistry, manufacturing and controls, <em>in vitro</em> dissolution
testing, and <em>in vivo</em> bioequivalence documentation (SUPAC-IR). 1995.<br />
<a href="https://www.fda.gov/media/70949/download">https://www.fda.gov/media/70949/download</a>
</p>
<p>European Medicines Agency (EMA), Committee for Medicinal Products for
Human Use (CHMP). Guideline on the Investigation of Bioequivalence. 2010;
CPMP/EWP/QWP/1401/98 Rev. 1.<br />
<a href="https://www.ema.europa.eu/en/documents/scientific-guideline/guideline-investigation-bioequivalence-rev1_en.pdf">https://www.ema.europa.eu/en/documents/scientific-guideline/guideline-investigation-bioequivalence-rev1_en.pdf</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+f2">f2</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Dissolution data of one reference batch and one test batch of n = 6
# tablets each:
str(dip1)

# 'data.frame':	12 obs. of  10 variables:
# $ type  : Factor w/ 2 levels "R","T": 1 1 1 1 1 1 2 2 2 2 ...
# $ tablet: Factor w/ 6 levels "1","2","3","4",..: 1 2 3 4 5 6 1 2 3 4 ...
# $ t.5   : num  42.1 44.2 45.6 48.5 50.5 ...
# $ t.10  : num  59.9 60.2 55.8 60.4 61.8 ...
# $ t.15  : num  65.6 67.2 65.6 66.5 69.1 ...
# $ t.20  : num  71.8 70.8 70.5 73.1 72.8 ...
# $ t.30  : num  77.8 76.1 76.9 78.5 79 ...
# $ t.60  : num  85.7 83.3 83.9 85 86.9 ...
# $ t.90  : num  93.1 88 86.8 88 89.7 ...
# $ t.120 : num  94.2 89.6 90.1 93.4 90.8 ...

# Use of defaults, i.e. 'use_EMA = "yes"', 'bounds = c(1, 85)'
# Comparison always involves only two groups.
f1(data = dip1, tcol = 3:10, grouping = "type")

# $f1
# [1] 18.19745
#
# $Profile.TP
# t.5 t.10 t.15 t.20 t.30 t.60 t.90
#   5   10   15   20   30   60   90

# Use of 'use_EMA = "no"', 'bounds = c(5, 80)'
f1(data = dip1, tcol = 3:10, grouping = "type", use_EMA = "no",
   bounds = c(5, 80))

# $f1
# [1] 21.333
#
# $Profile.TP
# t.5 t.10 t.15 t.20 t.30 t.60
#   5   10   15   20   30   60

# Use of 'use_EMA = "no"', 'bounds = c(1, 95)'
f1(data = dip1, tcol = 3:10, grouping = "type", use_EMA = "no",
   bounds = c(1, 95))

# $f1
# [1] 16.22299
#
# $Profile.TP
# t.5  t.10  t.15  t.20  t.30  t.60  t.90 t.120
#   5    10    15    20    30    60    90   120

# In this case, the whole profiles are used. The same result is obtained
# when setting 'use_EMA = "ignore"' (ignoring values passed to 'bounds').
f1(data = dip1, tcol = 3:10, grouping = "type", use_EMA = "ignore")

# Passing in a data frame with a grouping variable with a number of levels that
# differs from two produces an error.
tmp &lt;- rbind(dip1,
             data.frame(type = "T2",
                        tablet = as.factor(1:6),
                        dip1[7:12, 3:10]))

tryCatch(
  f1(data = tmp, tcol = 3:10, grouping = "type"),
  error = function(e) message(e),
  finally = message("\nMaybe you want to remove unesed levels in data."))

# Error in f1(data = tmp, tcol = 3:10, grouping = "type") :
#   The number of levels in column type differs from 2.
</code></pre>

<hr>
<h2 id='f2'>Similarity factor f2 for dissolution data</h2><span id='topic+f2'></span>

<h3>Description</h3>

<p>The function <code>f2()</code> calculates the similarity factor <code class="reqn">f_2</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>f2(data, tcol, grouping, use_EMA = "yes", bounds = c(1, 85))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="f2_+3A_data">data</code></td>
<td>
<p>A data frame with the dissolution profile data in wide format.</p>
</td></tr>
<tr><td><code id="f2_+3A_tcol">tcol</code></td>
<td>
<p>A vector of indices specifying the columns in <code>data</code> that
contain the % release values. The length of <code>tcol</code> must be three or
longer.</p>
</td></tr>
<tr><td><code id="f2_+3A_grouping">grouping</code></td>
<td>
<p>A character string specifying the column in <code>data</code> that
contains the group names (i.e. a factorial variable, e.g., for the
differentiation of batches or formulations of a drug product).</p>
</td></tr>
<tr><td><code id="f2_+3A_use_ema">use_EMA</code></td>
<td>
<p>A character string indicating if the similarity factor
<code class="reqn">f_2</code> should be calculated following the EMA guideline &ldquo;On the
investigation of bioequivalence&rdquo; (<code>"yes"</code>, the default) or not
(<code>"no"</code>). A third option is <code>"ignore"</code>. If <code>use_EMA</code> is
<code>"yes"</code> or <code>"no"</code> the appropriate profile portion is determined
on the basis of the values of the parameter <code>bounds</code>. If it is
<code>"ignore"</code>, the complete profiles are used as specified by the
parameter <code>tcol</code>.</p>
</td></tr>
<tr><td><code id="f2_+3A_bounds">bounds</code></td>
<td>
<p>A numeric vector of the form <code>c(lower, upper)</code> specifying
the &ldquo;lower&rdquo; and &ldquo;upper&rdquo; limits, respectively, for the %
drug release given that <code>use_EMA</code> is <code>"no"</code>. The default is
<code>c(1, 85)</code>. Mean % release values of any of the two groups being
compared that are smaller than or equal to the lower bound are ignored and
only the first mean % release value that is greater than or equal to the
upper bound is included while all the subsequent values are ignored. If
<code>use_EMA</code> is <code>"yes"</code> the <code>bounds</code> are <code>c(1, 85)</code> per
definition.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Similarity of dissolution profiles is assessed using the similarity
factor <code class="reqn">f_2</code> according to the EMA guideline (European Medicines Agency
2010) &ldquo;On the investigation of bioequivalence&rdquo;. The evaluation of the
similarity factor is based on the following constraints:
</p>

<ol>
<li><p> A minimum of three time points (zero excluded).
</p>
</li>
<li><p> The time points should be the same for the two formulations.
</p>
</li>
<li><p> Twelve individual values for every time point for each formulation.
</p>
</li>
<li><p> Not more than one mean value of &gt; 85% dissolved for any of the
formulations.
</p>
</li>
<li><p> The relative standard deviation or coefficient of variation of any
product should be less than 20% for the first time point and less than
10% from the second to the last time point.
</p>
</li></ol>

<p>The similarity factor <code class="reqn">f_2</code> is calculated by aid of the equation
</p>
<p style="text-align: center;"><code class="reqn">f_2 = 50 \times \log \left(\frac{100}{\sqrt{1 + \frac{\sum_{t=1}^{n}
  \left(\bar{R}(t) - \bar{T}(t) \right)^2}{n}}} \right) .</code>
</p>

<p>In this equation
</p>

<dl>
<dt><code class="reqn">f_2</code></dt><dd><p>is the similarity factor,</p>
</dd>
<dt><code class="reqn">n</code></dt><dd><p>is the number of time points,</p>
</dd>
<dt><code class="reqn">\bar{R}(t)</code></dt><dd><p>is the mean percent reference drug
dissolved at time <code class="reqn">t</code> after initiation of the study, and</p>
</dd>
<dt><code class="reqn">\bar{T}(t)</code></dt><dd><p>is the mean percent test drug dissolved
at time <code class="reqn">t</code> after initiation of the study.</p>
</dd>
</dl>

<p>Dissolution profiles are regarded as similar if the <code class="reqn">f_2</code> value is
between <code class="reqn">50</code> and <code class="reqn">100</code>. <br />
</p>


<h3>Value</h3>

<p>A list with the following elements is returned:
</p>
<table>
<tr><td><code>f2</code></td>
<td>
<p>A numeric value representing the similarity factor <code class="reqn">f_2</code>.</p>
</td></tr>
<tr><td><code>Profile.TP</code></td>
<td>
<p>A named numeric vector of the columns in <code>data</code>
specified by <code>tcol</code> and depending on the selection of <code>use_EMA</code>.
Given that the column names contain extractable numeric information,
e.g., specifying the testing time points of the dissolution profile, it
contains the corresponding values. Elements where no numeric information
could be extracted are <code>NA</code>.</p>
</td></tr>
</table>


<h3>References</h3>

<p>United States Food and Drug Administration (FDA). Guidance for industry:
dissolution testing of immediate release solid oral dosage forms. 1997.<br />
<a href="https://www.fda.gov/media/70936/download">https://www.fda.gov/media/70936/download</a>
</p>
<p>United States Food and Drug Administration (FDA). Guidance for industry:
immediate release solid oral dosage form: scale-up and post-approval
changes, chemistry, manufacturing and controls, <em>in vitro</em> dissolution
testing, and <em>in vivo</em> bioequivalence documentation (SUPAC-IR). 1995.<br />
<a href="https://www.fda.gov/media/70949/download">https://www.fda.gov/media/70949/download</a>
</p>
<p>European Medicines Agency (EMA), Committee for Medicinal Products for
Human Use (CHMP). Guideline on the Investigation of Bioequivalence. 2010;
CPMP/EWP/QWP/1401/98 Rev. 1.<br />
<a href="https://www.ema.europa.eu/en/documents/scientific-guideline/guideline-investigation-bioequivalence-rev1_en.pdf">https://www.ema.europa.eu/en/documents/scientific-guideline/guideline-investigation-bioequivalence-rev1_en.pdf</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+f1">f1</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Dissolution data of one reference batch and one test batch of n = 6
# tablets each:
str(dip1)

# 'data.frame':	12 obs. of  10 variables:
# $ type  : Factor w/ 2 levels "R","T": 1 1 1 1 1 1 2 2 2 2 ...
# $ tablet: Factor w/ 6 levels "1","2","3","4",..: 1 2 3 4 5 6 1 2 3 4 ...
# $ t.5   : num  42.1 44.2 45.6 48.5 50.5 ...
# $ t.10  : num  59.9 60.2 55.8 60.4 61.8 ...
# $ t.15  : num  65.6 67.2 65.6 66.5 69.1 ...
# $ t.20  : num  71.8 70.8 70.5 73.1 72.8 ...
# $ t.30  : num  77.8 76.1 76.9 78.5 79 ...
# $ t.60  : num  85.7 83.3 83.9 85 86.9 ...
# $ t.90  : num  93.1 88 86.8 88 89.7 ...
# $ t.120 : num  94.2 89.6 90.1 93.4 90.8 ...

# Use of defaults, i.e. 'use_EMA = "yes"', 'bounds = c(1, 85)'
# Comparison always involves only two groups.
f2(data = dip1, tcol = 3:10, grouping = "type")

# $f2
# [1] 40.83405
#
# $Profile.TP
# t.5 t.10 t.15 t.20 t.30 t.60 t.90
#   5   10   15   20   30   60   90

# Use of 'use_EMA = "no"', 'bounds = c(5, 80)'
f2(data = dip1, tcol = 3:10, grouping = "type", use_EMA = "no",
   bounds = c(5, 80))

# $f2
# [1] 39.24385
#
# $Profile.TP
# t.5 t.10 t.15 t.20 t.30 t.60
#   5   10   15   20   30   60

# Use of 'use_EMA = "no"', 'bounds = c(1, 95)'
f2(data = dip1, tcol = 3:10, grouping = "type", use_EMA = "no",
   bounds = c(1, 95))

# $f2
# [1] 42.11197
#
# $Profile.TP
# t.5  t.10  t.15  t.20  t.30  t.60  t.90 t.120
#   5    10    15    20    30    60    90   120

# In this case, the whole profiles are used. The same result is obtained
# when setting 'use_EMA = "ignore"' (ignoring values passed to 'bounds').
f2(data = dip1, tcol = 3:10, grouping = "type", use_EMA = "ignore")

# Passing in a data frame with a grouping variable with a number of levels that
# differs from two produces an error.
tmp &lt;- rbind(dip1,
             data.frame(type = "T2",
                        tablet = as.factor(1:6),
                        dip1[7:12, 3:10]))

tryCatch(
  f2(data = tmp, tcol = 3:10, grouping = "type"),
  error = function(e) message(e),
  finally = message("\nMaybe you want to remove unesed levels in data."))

# Error in f1(data = tmp, tcol = 3:10, grouping = "type") :
#   The number of levels in column type differs from 2.
</code></pre>

<hr>
<h2 id='gep_by_nera'>Points on confidence region (found by Newton-Raphson search)</h2><span id='topic+gep_by_nera'></span>

<h3>Description</h3>

<p>The function <code>gep_by_nera()</code> is a function for finding points on
confidence region (<code class="reqn">CR</code>) bounds by aid of the &ldquo;Method of Lagrange
Multipliers&rdquo; (MLM) and by &ldquo;Newton-Raphson&rdquo; (nera) optimisation. The
multivariate confidence interval for profiles with four time points, e.g.,
is an &ldquo;ellipse&rdquo; in four dimensions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gep_by_nera(n_p, K, mean_diff, S_pool, F_crit, y, max_trial, tol)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gep_by_nera_+3A_n_p">n_p</code></td>
<td>
<p>A positive integer specifying the number of (time) points
<code class="reqn">n_p</code>.</p>
</td></tr>
<tr><td><code id="gep_by_nera_+3A_k">K</code></td>
<td>
<p>A non-negative numeric value specifying the scaling factor <code class="reqn">K</code>
for the calculation of the Hotelling's <code class="reqn">T^2</code> statistic.</p>
</td></tr>
<tr><td><code id="gep_by_nera_+3A_mean_diff">mean_diff</code></td>
<td>
<p>A vector of the mean differences between the dissolution
profiles of the reference and the test batch. It must have the length
specified by the parameter <code class="reqn">n_p</code>.</p>
</td></tr>
<tr><td><code id="gep_by_nera_+3A_s_pool">S_pool</code></td>
<td>
<p>The pooled variance-covariance matrix of the dissolution
profiles of the reference and the test batch. It must have the dimension
<code class="reqn">n_p \times n_p</code>.</p>
</td></tr>
<tr><td><code id="gep_by_nera_+3A_f_crit">F_crit</code></td>
<td>
<p>The critical <code class="reqn">F</code> value (i.e. a non-negative numeric).</p>
</td></tr>
<tr><td><code id="gep_by_nera_+3A_y">y</code></td>
<td>
<p>A numeric vector of <code class="reqn">y</code> values that serve as starting points
for the Newton-Raphson search, i.e. values supposed to lie on or close to
the confidence interval bounds. It must have a length of <code class="reqn">n_p + 1</code>.</p>
</td></tr>
<tr><td><code id="gep_by_nera_+3A_max_trial">max_trial</code></td>
<td>
<p>A positive integer specifying the maximum number of
Newton-Raphson search rounds to be performed.</p>
</td></tr>
<tr><td><code id="gep_by_nera_+3A_tol">tol</code></td>
<td>
<p>A non-negative numeric specifying the accepted minimal
difference between two consecutive search rounds.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>gep_by_nera()</code> determines the points on the
<code class="reqn">CR</code> bounds for each of the <code class="reqn">n_p</code> time points. It does so by aid
of the &ldquo;Method of Lagrange Multipliers&rdquo; (MLM) and by
&ldquo;Newton-Raphson&rdquo; (nera) optimisation, as proposed by Margaret
Connolly (Connolly 2000).
</p>
<p>For more information, see the sections &ldquo;Comparison of highly variable
dissolution profiles&rdquo; and &ldquo;Similarity limits in terms of MSD&rdquo; below.
</p>


<h3>Value</h3>

<p>A list with the following elements is returned:
</p>
<table>
<tr><td><code>points</code></td>
<td>
<p>A matrix with one column and <code class="reqn">n_p + 1</code> rows is returned,
where rows <code class="reqn">1</code> to <code class="reqn">n_p</code> represent, for each time point, the points
on the <code class="reqn">CR</code> bounds. For symmetry reasons, the points on the opposite
side are obtained by addition/subtraction. The last row in the matrix,
with index <code class="reqn">n_p + 1</code>, represents the <code class="reqn">\lambda</code> parameter of the
MLM, also known as <em>lambda multiplier method</em>, that is used to
optimise under constraint(s). The variable <code class="reqn">\lambda</code> is thus called
the <em>Lagrange multiplier</em>.</p>
</td></tr>
<tr><td><code>converged</code></td>
<td>
<p>A logical stating if the NR algorithm converged or not.</p>
</td></tr>
<tr><td><code>n.trial</code></td>
<td>
<p>Number of trials until convergence.</p>
</td></tr>
<tr><td><code>max.trial</code></td>
<td>
<p>Maximal number of trials.</p>
</td></tr>
</table>


<h3>Comparison of highly variable dissolution profiles</h3>

<p>When comparing the dissolution data of a post-approval change product and a
reference approval product, the goal is to assess the similarity between the
mean dissolution values at the observed sample time points. A widely used
method is the <code class="reqn">f_2</code> method that was introduced by Moore &amp; Flanner (1996).
Similarity testing criteria based on <code class="reqn">f_2</code> can be found in several FDA
guidelines and in the guideline of the European Medicines Agency (EMA)
&ldquo;On the investigation of bioequivalence&rdquo; (EMA 2010).
</p>
<p>In situations where within-batch variation is greater than 15%, FDA
guidelines recommend use of a multivariate confidence interval as an
alternative to the <code class="reqn">f_2</code> method. This can be done using the following
stepwise procedure:
</p>

<ol>
<li><p> Establish a similarity limit in terms of &ldquo;Multivariate
Statistical Distance&rdquo; (MSD) based on inter-batch differences in % drug
release from reference (standard approved) formulations, i.e. the so-
called &ldquo;Equivalence Margin&rdquo; (EM).
</p>
</li>
<li><p> Calculate the MSD between test and reference mean dissolutions.
</p>
</li>
<li><p> Estimate the 90% confidence interval (CI) of the true MSD as
determined in step 2.
</p>
</li>
<li><p> Compare the upper limit of the 90% CI with the similarity limit
determined in step 1. The test formulation is declared to be similar to
the reference formulation if the upper limit of the 90% CI is less than
or equal to the similarity limit.
</p>
</li></ol>



<h3>Similarity limits in terms of MSD</h3>

<p>For the calculation of the &ldquo;Multivariate Statistical Distance&rdquo; (MSD),
the procedure proposed by Tsong et al. (1996) can be considered as
well-accepted method that is actually recommended by the FDA. According
to this method, a multivariate statistical distance, called Mahalanobis
distance, is used to measure the difference between two multivariate means.
This distance measure is calculated as
</p>
<p style="text-align: center;"><code class="reqn">D_M = \sqrt{ \left( \bm{x_T} - \bm{x_R} \right)^{\top}
  \bm{S}_{pooled}^{-1} \left( \bm{x_T} - \bm{x_R} \right)} ,</code>
</p>

<p>where <code class="reqn">\bm{S}_{pooled} = \frac{\left( \bm{S}_T + \bm{S}_R \right)}{2}</code> is the sample variance-covariance matrix
pooled across the batches, <code class="reqn">\bm{x}_T</code> and <code class="reqn">\bm{x}_R</code> are
the vectors of the sample means for the test (<code class="reqn">T</code>) and reference
(<code class="reqn">R</code>) profiles, and <code class="reqn">\bm{S}_T</code> and <code class="reqn">\bm{S}_R</code> are the
variance-covariance matrices of the test and reference profiles.
</p>
<p>In order to determine the similarity limits in terms of the MSD, i.e. the
Mahalanobis distance between the two multivariate means of the dissolution
profiles of the formulations to be compared, Tsong et al. (1996) proposed
using the equation
</p>
<p style="text-align: center;"><code class="reqn">D_M^{max} = \sqrt{ \bm{d}_g^{\top} \bm{S}_{pooled}^{-1} \bm{d}_g} ,</code>
</p>

<p>where <code class="reqn">\bm{d}_g</code> is a <code class="reqn">1 \times p</code> vector with all
<code class="reqn">p</code> elements equal to an empirically defined limit <code class="reqn">\bm{d}_g</code>,
e.g., <code class="reqn">15</code>%, for the maximum tolerable difference at all time points,
and <code class="reqn">p</code> is the number of sampling points. By assuming that the data
follow a multivariate normal distribution, the 90% confidence region
(<code class="reqn">CR</code>) bounds for the true difference between the mean vectors,
<code class="reqn">\bm{\mu}_T - \bm{\mu}_R</code>, can be computed for the
resultant vector <code class="reqn">\bm{\mu}</code> to satisfy the following condition:
</p>
<p style="text-align: center;"><code class="reqn">\bm{CR} = K \left( \bm{\mu} - \left( \bm{x_T} - \bm{x_R} \right)
  \right)^{\top} \bm{S}_{pooled}^{-1} \left( \bm{\mu} - \left( \bm{x_T} -
  \bm{x_R} \right) \right) \leq F_{p, n_T + n_R - p - 1, 0.9} ,</code>
</p>

<p>where <code class="reqn">K</code> is the scaling factor that is calculated as
</p>
<p style="text-align: center;"><code class="reqn">K = \frac{n_T n_R}{n_T + n_R} \cdot \frac{n_T + n_R - p - 1}{
  \left( n_T + n_R - 2 \right) \cdot p} ,</code>
</p>

<p>and <code class="reqn">F_{p, n_T + n_R - p - 1, 0.9}</code> is the <code class="reqn">90^{th}</code> percentile of
the <code class="reqn">F</code> distribution with degrees of freedom <code class="reqn">p</code> and
<code class="reqn">n_T + n_R - p - 1</code>. It is obvious that <code class="reqn">(n_T + n_R)</code> must be greater
than <code class="reqn">(p + 1)</code>. The formula for <code class="reqn">CR</code> gives a <code class="reqn">p</code>-variate 90%
confidence region for the possible true differences. <br />
</p>


<h3>References</h3>

<p>United States Food and Drug Administration (FDA). Guidance for industry:
dissolution testing of immediate release solid oral dosage forms. 1997.<br />
<a href="https://www.fda.gov/media/70936/download">https://www.fda.gov/media/70936/download</a>
</p>
<p>United States Food and Drug Administration (FDA). Guidance for industry:
immediate release solid oral dosage form: scale-up and post-approval
changes, chemistry, manufacturing and controls, <em>in vitro</em> dissolution
testing, and <em>in vivo</em> bioequivalence documentation (SUPAC-IR). 1995.<br />
<a href="https://www.fda.gov/media/70949/download">https://www.fda.gov/media/70949/download</a>
</p>
<p>European Medicines Agency (EMA), Committee for Medicinal Products for
Human Use (CHMP). Guideline on the Investigation of Bioequivalence. 2010;
CPMP/EWP/QWP/1401/98 Rev. 1.<br />
<a href="https://www.ema.europa.eu/en/documents/scientific-guideline/guideline-investigation-bioequivalence-rev1_en.pdf">https://www.ema.europa.eu/en/documents/scientific-guideline/guideline-investigation-bioequivalence-rev1_en.pdf</a>
</p>
<p>Moore, J.W., and Flanner, H.H. Mathematical comparison of curves with an
emphasis on <em>in-vitro</em> dissolution profiles. <em>Pharm Tech</em>. 1996;
<strong>20</strong>(6): 64-74.
</p>
<p>Tsong, Y., Hammerstrom, T., Sathe, P.M., and Shah, V.P. Statistical
assessment of mean differences between two dissolution data sets.
<em>Drug Inf J</em>. 1996; <strong>30</strong>: 1105-1112.<br />
doi: <a href="https://doi.org/10.1177/009286159603000427">10.1177/009286159603000427</a>
</p>
<p>Connolly, M. SAS(R) IML Code to calculate an upper confidence limit for
multivariate statistical distance; 2000; Wyeth Lederle Vaccines, Pearl River,
NY.<br />
<a href="https://analytics.ncsu.edu/sesug/2000/p-902.pdf">https://analytics.ncsu.edu/sesug/2000/p-902.pdf</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mimcr">mimcr</a></code>, <code><a href="#topic+bootstrap_f2">bootstrap_f2</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Collecting the required information
time_points &lt;- suppressWarnings(as.numeric(gsub("([^0-9])", "",
                                                colnames(dip1))))
tico &lt;- which(!is.na(time_points))
b1 &lt;- dip1$type == "R"

n_tp &lt;- length(tico)
n_b1 &lt;- length(dip1[b1, "type"])
n_b2 &lt;- length(dip1[!b1, "type"])
df_b1 &lt;- n_tp
df_b2 &lt;- n_b1 + n_b2 - n_tp - 1
K_limit &lt;- (n_b2 * n_b1) / (n_b2 + n_b1)
K &lt;- K_limit * df_b2 / (df_b1 * (n_b2 + n_b1 - 2))

mean_b1 &lt;- apply(X = dip1[b1, tico], MARGIN = 2, FUN = mean)
mean_b2 &lt;- apply(X = dip1[!b1, tico], MARGIN = 2, FUN = mean)
mean_diff &lt;- mean_b2 - mean_b1

S_b1 &lt;- cov(dip1[b1, tico])
S_b2 &lt;- cov(dip1[!b1, tico])
S &lt;- ((n_b1 - 1) * S_b1 + (n_b2 - 1) * S_b2) / (n_b1 + n_b2 - 2)

F_crit &lt;- qf(p = (1 - 0.05), df1 = df_b1, df2 = df_b2)
y_b1 &lt;- rep(1, times = (n_tp + 1))

# Calling gep_by_nera()
res &lt;- gep_by_nera(n_p = n_tp, K = K, mean_diff = mean_diff, S_pool = S,
                   F_crit = F_crit, y = y_b1, max_trial = 100, tol = 1e-9)

# Expected result in res[["points"]]
#              [,1]
# t.5   -15.7600077
# t.10  -13.6501734
# t.15  -11.6689469
# t.20   -9.8429369
# t.30   -6.6632182
# t.60   -0.4634318
# t.90    2.2528551
# t.120   3.3249569
#       -17.6619995

# Rows t.5 to t.120 represent the points on the CR bounds.The unnamed last row
# represents the Lagrange multiplier lambda.

# If 'max_trial' is too small, the Newton-Raphson search may not converge.
tryCatch(
  gep_by_nera(n_p = n_tp, K = K, mean_diff = mean_diff, S_pool = S,
              F_crit = F_crit, y = y_b1, max_trial = 5, tol = 1e-9),
  warning = function(w) message(w),
  finally = message("\nMaybe increasing the number of max_trial could help."))
</code></pre>

<hr>
<h2 id='get_f1'>Get the f1 dissimilarity factor</h2><span id='topic+get_f1'></span>

<h3>Description</h3>

<p>The function <code>get_f1()</code> calculates the dissimilarity factor <code class="reqn">f_1</code>
for the assessment of dissolution profiles.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_f1(data, ins, tcol, grouping)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_f1_+3A_data">data</code></td>
<td>
<p>A data frame with the dissolution profile data in wide format.</p>
</td></tr>
<tr><td><code id="get_f1_+3A_ins">ins</code></td>
<td>
<p>A vector of indices generated regarding the grouping.</p>
</td></tr>
<tr><td><code id="get_f1_+3A_tcol">tcol</code></td>
<td>
<p>A vector of indices specifying the columns in <code>data</code> that
contain the % release values. The length of <code>tcol</code> must be three or
longer.</p>
</td></tr>
<tr><td><code id="get_f1_+3A_grouping">grouping</code></td>
<td>
<p>A character string specifying the column in <code>data</code> that
contains the group names (i.e. a factorial variable, e.g., for the
differentiation of batches or formulations of a drug product).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Similarity of dissolution profiles is often assessed using the
similarity factor <code class="reqn">f_2</code>, as recommended by the EMA guideline (European
Medicines Agency 2010) &ldquo;On the investigation of bioequivalence&rdquo;. The
evaluation of the similarity factor is based on the following constraints:
</p>

<ol>
<li><p> A minimum of three time points (zero excluded).
</p>
</li>
<li><p> The time points should be the same for the two formulations.
</p>
</li>
<li><p> Twelve individual values for every time point for each formulation.
</p>
</li>
<li><p> Not more than one mean value of &gt; 85% dissolved for any of the
formulations.
</p>
</li>
<li><p> The relative standard deviation or coefficient of variation of any
product should be less than 20% for the first time point and less than
10% from the second to the last time point.
</p>
</li></ol>

<p>The <em>dis</em>similarity factor, or difference factor, <code class="reqn">f_1</code>, is the
counterpart of the similarity factor <code class="reqn">f_2</code>. The difference factor
<code class="reqn">f_1</code> is a measure of the relative error between two curves. Current FDA
guidelines suggest that two profiles can be considered similar if <code class="reqn">f_1</code>
is less than <code class="reqn">15</code> (<code class="reqn">0 - 15</code>) and <code class="reqn">f_2</code> is greater than <code class="reqn">50</code>
(<code class="reqn">50 - 100</code>), which is equivalent to an average difference of 10% at
all sampling time points. The dissimilarity factor <code class="reqn">f_1</code> is calculated
by aid of the equation
</p>
<p style="text-align: center;"><code class="reqn">f_1 = 100 \times \frac{\sum_{t=1}^{n} \left( \left| \bar{R}(t) -
  \bar{T}(t) \right| \right)}{\sum_{t=1}^{n} (\bar{R}(t))} .</code>
</p>

<p>In this equation
</p>

<dl>
<dt><code class="reqn">f_1</code></dt><dd><p>is the dissimilarity factor,</p>
</dd>
<dt><code class="reqn">n</code></dt><dd><p>is the number of time points,</p>
</dd>
<dt><code class="reqn">\bar{R}(t)</code></dt><dd><p>is the mean percent reference drug
dissolved at time <code class="reqn">t</code> after initiation of the study, and</p>
</dd>
<dt><code class="reqn">\bar{T}(t)</code></dt><dd><p>is the mean percent test drug dissolved
at time <code class="reqn">t</code> after initiation of the study.</p>
</dd>
</dl>



<h3>Value</h3>

<p>The function returns the <code class="reqn">f_1</code> value.
</p>


<h3>References</h3>

<p>United States Food and Drug Administration (FDA). Guidance for industry:
dissolution testing of immediate release solid oral dosage forms. 1997.<br />
<a href="https://www.fda.gov/media/70936/download">https://www.fda.gov/media/70936/download</a>
</p>
<p>United States Food and Drug Administration (FDA). Guidance for industry:
immediate release solid oral dosage form: scale-up and post-approval
changes, chemistry, manufacturing and controls, <em>in vitro</em> dissolution
testing, and <em>in vivo</em> bioequivalence documentation (SUPAC-IR). 1995.<br />
<a href="https://www.fda.gov/media/70949/download">https://www.fda.gov/media/70949/download</a>
</p>
<p>European Medicines Agency (EMA), Committee for Medicinal Products for
Human Use (CHMP). Guideline on the Investigation of Bioequivalence. 2010;
CPMP/EWP/QWP/1401/98 Rev. 1.<br />
<a href="https://www.ema.europa.eu/en/documents/scientific-guideline/guideline-investigation-bioequivalence-rev1_en.pdf">https://www.ema.europa.eu/en/documents/scientific-guideline/guideline-investigation-bioequivalence-rev1_en.pdf</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_f2">get_f2</a></code>.
</p>

<hr>
<h2 id='get_f2'>Get the f2 similarity factor</h2><span id='topic+get_f2'></span>

<h3>Description</h3>

<p>The function <code>get_f2()</code> calculates the similarity factor <code class="reqn">f_2</code> for
the assessment of dissolution profiles.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_f2(data, ins, tcol, grouping)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_f2_+3A_data">data</code></td>
<td>
<p>A data frame with the dissolution profile data in wide format.</p>
</td></tr>
<tr><td><code id="get_f2_+3A_ins">ins</code></td>
<td>
<p>A vector of indices generated regarding the grouping.</p>
</td></tr>
<tr><td><code id="get_f2_+3A_tcol">tcol</code></td>
<td>
<p>A vector of indices specifying the columns in <code>data</code> that
contain the % release values. The length of <code>tcol</code> must be three or
longer.</p>
</td></tr>
<tr><td><code id="get_f2_+3A_grouping">grouping</code></td>
<td>
<p>A character string specifying the column in <code>data</code> that
contains the group names (i.e. a factorial variable, e.g., for the
differentiation of batches or formulations of a drug product).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Similarity of dissolution profiles is assessed using the similarity
factor <code class="reqn">f_2</code> according to the EMA guideline (European Medicines Agency
2010) &ldquo;On the investigation of bioequivalence&rdquo;. The evaluation of the
similarity factor is based on the following constraints:
</p>

<ol>
<li><p> A minimum of three time points (zero excluded).
</p>
</li>
<li><p> The time points should be the same for the two formulations.
</p>
</li>
<li><p> Twelve individual values for every time point for each formulation.
</p>
</li>
<li><p> Not more than one mean value of &gt; 85% dissolved for any of the
formulations.
</p>
</li>
<li><p> The relative standard deviation or coefficient of variation of any
product should be less than 20% for the first time point and less than
10% from the second to the last time point.
</p>
</li></ol>

<p>The similarity factor <code class="reqn">f_2</code> is calculated by aid of the equation
</p>
<p style="text-align: center;"><code class="reqn">f_2 = 50 \times \log \left(\frac{100}{\sqrt{1 + \frac{\sum_{t=1}^{n}
  \left(\bar{R}(t) - \bar{T}(t) \right)^2}{n}}} \right) .</code>
</p>

<p>In this equation
</p>

<dl>
<dt><code class="reqn">f_2</code></dt><dd><p>is the similarity factor,</p>
</dd>
<dt><code class="reqn">n</code></dt><dd><p>is the number of time points,</p>
</dd>
<dt><code class="reqn">\bar{R}(t)</code></dt><dd><p>is the mean percent reference drug
dissolved at time <code class="reqn">t</code> after initiation of the study, and</p>
</dd>
<dt><code class="reqn">\bar{T}(t)</code></dt><dd><p>is the mean percent test drug dissolved
at time <code class="reqn">t</code> after initiation of the study.</p>
</dd>
</dl>

<p>Dissolution profiles are regarded as similar if the <code class="reqn">f_2</code> value is
between <code class="reqn">50</code> and <code class="reqn">100</code>. <br />
</p>


<h3>Value</h3>

<p>The function returns the <code class="reqn">f_2</code> value.
</p>


<h3>References</h3>

<p>United States Food and Drug Administration (FDA). Guidance for industry:
dissolution testing of immediate release solid oral dosage forms. 1997.<br />
<a href="https://www.fda.gov/media/70936/download">https://www.fda.gov/media/70936/download</a>
</p>
<p>United States Food and Drug Administration (FDA). Guidance for industry:
immediate release solid oral dosage form: scale-up and post-approval
changes, chemistry, manufacturing and controls, <em>in vitro</em> dissolution
testing, and <em>in vivo</em> bioequivalence documentation (SUPAC-IR). 1995.<br />
<a href="https://www.fda.gov/media/70949/download">https://www.fda.gov/media/70949/download</a>
</p>
<p>European Medicines Agency (EMA), Committee for Medicinal Products for
Human Use (CHMP). Guideline on the Investigation of Bioequivalence. 2010;
CPMP/EWP/QWP/1401/98 Rev. 1.<br />
<a href="https://www.ema.europa.eu/en/documents/scientific-guideline/guideline-investigation-bioequivalence-rev1_en.pdf">https://www.ema.europa.eu/en/documents/scientific-guideline/guideline-investigation-bioequivalence-rev1_en.pdf</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_f1">get_f1</a></code>.
</p>

<hr>
<h2 id='get_hotellings'>Hotelling's statistics (for two independent (small) samples)</h2><span id='topic+get_hotellings'></span>

<h3>Description</h3>

<p>The function <code>get_hotellings()</code> estimates the parameters for Hotelling's
two-sample <code class="reqn">T^2</code> statistic for small samples.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_hotellings(m1, m2, signif)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_hotellings_+3A_m1">m1</code></td>
<td>
<p>A matrix with the data of the reference group.</p>
</td></tr>
<tr><td><code id="get_hotellings_+3A_m2">m2</code></td>
<td>
<p>A matrix with the same dimensions as matrix <code>m1</code>, with the
data of the test group.</p>
</td></tr>
<tr><td><code id="get_hotellings_+3A_signif">signif</code></td>
<td>
<p>A positive numeric value between <code>0</code> and <code>1</code>
specifying the significance level. The default value is <code>0.05</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The two-sample Hotelling's <code class="reqn">T^2</code> test statistic is given by
</p>
<p style="text-align: center;"><code class="reqn">T^2 = \left( \bar{\bm{x}}_1 - \bar{\bm{x}}_2 \right)^{\top}
  \left( \bm{S}_p \left( \frac{1}{n_1} + \frac{1}{n_2} \right) \right)^{-1}
  \left( \bar{\bm{x}}_1 - \bar{\bm{x}}_2 \right) .</code>
</p>

<p>For large samples, this test statistic will be approximately chi-square
distributed with <code class="reqn">p</code> degrees of freedom. However, this approximation
does not take into account the variation due to the variance-covariance
matrix estimation. Therefore, Hotelling's <code class="reqn">T^2</code> statistic
is transformed into an <code class="reqn">F</code>-statistic using the expression
</p>
<p style="text-align: center;"><code class="reqn">F = \frac{n_1 + n_2 - p - 1}{(n_1 + n_2 - 2) p} T^2 ,</code>
</p>

<p>where <code class="reqn">n_1</code> and <code class="reqn">n_2</code> are the sample sizes of the two samples being
compared and <code class="reqn">p</code> is the number of variables.
</p>
<p>Under the null hypothesis, <code class="reqn">H_0: \bm{\mu}_1 = \bm{\mu}_2</code>, this <code class="reqn">F</code>-statistic will be <code class="reqn">F</code>-distributed
with <code class="reqn">p</code> and <code class="reqn">n_1 + n_2 - p</code> degrees of freedom. <code class="reqn">H_0</code> is
rejected at significance level <code class="reqn">\alpha</code> if the <code class="reqn">F</code>-value exceeds the
critical value from the <code class="reqn">F</code>-table evaluated at <code class="reqn">\alpha</code>, i.e.
<code class="reqn">F &gt; F_{p, n_1 + n_2 - p - 1, \alpha}</code>. The null hypothesis is satisfied
if, and only if, the population means are identical for all variables. The
alternative is that at least one pair of these means is different.
</p>
<p>The following assumptions concerning the data are made:
</p>

<ul>
<li><p> The data from population <code class="reqn">i</code> is a sample from a population with
mean vector <code class="reqn">\mu_i</code>. In other words, it is assumed that there are no
sub-populations.
</p>
</li>
<li><p> The data from both populations have common variance-covariance matrix
<code class="reqn">\Sigma</code>.
</p>
</li>
<li><p> The subjects from both populations are independently sampled.
</p>
</li>
<li><p> Both populations are normally distributed.
</p>
</li></ul>



<h3>Value</h3>

<p>A list with the following elements is returned:
</p>
<table>
<tr><td><code>Parameters</code></td>
<td>
<p>Parameters determined for the estimation of
Hotelling's <code class="reqn">T^2</code>.</p>
</td></tr>
<tr><td><code>S.pool</code></td>
<td>
<p>Pooled variance-covariance matrix.</p>
</td></tr>
<tr><td><code>covs</code></td>
<td>
<p>A list with the elements <code>S.b1</code> and <code>S.b2</code>, i.e. the
variance-covariance matrices of the reference and the test group,
respectively.</p>
</td></tr>
<tr><td><code>means</code></td>
<td>
<p>A list with the elements <code>mean.b1</code>, <code>mean.b2</code> and
<code>mean.diff</code>, i.e. the average profile values (for each time point) of
the reference and the test group and the corresponding differences of
the averages, respectively.</p>
</td></tr>
</table>
<p>The <code>Parameters</code> element contains the following information:
</p>
<table>
<tr><td><code>DM</code></td>
<td>
<p>Mahalanobis distance of the samples.</p>
</td></tr>
<tr><td><code>df1</code></td>
<td>
<p>Degrees of freedom (number of variables or time points).</p>
</td></tr>
<tr><td><code>df2</code></td>
<td>
<p>Degrees of freedom (number of rows - number of variables - 1).</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>Provided significance level.</p>
</td></tr>
<tr><td><code>K</code></td>
<td>
<p>Scaling factor for <code class="reqn">F</code> to account for the distribution of the
<code class="reqn">T^2</code> statistic.</p>
</td></tr>
<tr><td><code>k</code></td>
<td>
<p>Scaling factor for the squared Mahalanobis distance to obtain
the <code class="reqn">T^2</code> statistic.</p>
</td></tr>
<tr><td><code>T2</code></td>
<td>
<p>Hotelling's <code class="reqn">T^2</code> statistic (<code class="reqn">F</code>-distributed).</p>
</td></tr>
<tr><td><code>F</code></td>
<td>
<p>Observed <code class="reqn">F</code> value.</p>
</td></tr>
<tr><td><code>F.crit</code></td>
<td>
<p>Critical <code class="reqn">F</code> value.</p>
</td></tr>
<tr><td><code>p.F</code></td>
<td>
<p><code class="reqn">p</code> value for Hotelling's <code class="reqn">T^2</code> test statistic.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Hotelling, H. The generalisation of Student's ratio. <em>Ann Math Stat</em>.
1931; <strong>2</strong>(3): 360-378.
</p>
<p>Hotelling, H. (1947) <em>Multivariate quality control illustrated by air
testing of sample bombsights</em>. In: Eisenhart, C., Hastay, M.W., and Wallis,
W.A., Eds., Techniques of Statistical Analysis, McGraw Hill, New York,
111-184.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mimcr">mimcr</a></code>, <code><a href="#topic+get_sim_lim">get_sim_lim</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Dissolution data of one reference batch and one test batch of n = 6
# tablets each:
str(dip1)

# 'data.frame':	12 obs. of  10 variables:
# $ type  : Factor w/ 2 levels "R","T": 1 1 1 1 1 1 2 2 2 2 ...
# $ tablet: Factor w/ 6 levels "1","2","3","4",..: 1 2 3 4 5 6 1 2 3 4 ...
# $ t.5   : num  42.1 44.2 45.6 48.5 50.5 ...
# $ t.10  : num  59.9 60.2 55.8 60.4 61.8 ...
# $ t.15  : num  65.6 67.2 65.6 66.5 69.1 ...
# $ t.20  : num  71.8 70.8 70.5 73.1 72.8 ...
# $ t.30  : num  77.8 76.1 76.9 78.5 79 ...
# $ t.60  : num  85.7 83.3 83.9 85 86.9 ...
# $ t.90  : num  93.1 88 86.8 88 89.7 ...
# $ t.120 : num  94.2 89.6 90.1 93.4 90.8 ...

# Estimation of the parameters for Hotelling's two-sample T2 statistic
# (for small samples)
res &lt;-
  get_hotellings(m1 = as.matrix(dip1[dip1$type == "R", c("t.15", "t.90")]),
                 m2 = as.matrix(dip1[dip1$type == "T", c("t.15", "t.90")]),
                 signif = 0.1)
res$S.pool
res$Parameters

# Expected results in res$S.pool
#          t.15     t.90
# t.15 3.395808 1.029870
# t.90 1.029870 4.434833

# Expected results in res$Parameters
#           DM          df1          df2       signif            K
# 1.044045e+01 2.000000e+00 9.000000e+00 1.000000e-01 1.350000e+00
#            k           T2            F       F.crit          p.F
# 3.000000e+00 3.270089e+02 1.471540e+02 3.006452e+00 1.335407e-07
</code></pre>

<hr>
<h2 id='get_jackknife_values'>Jackknife values</h2><span id='topic+get_jackknife_values'></span>

<h3>Description</h3>

<p>The function <code>get_jackknife_values()</code> is required for generation of
vector <code class="reqn">L</code> for the BCa confidence interval estimation by the
<code>boot.ci()</code> function from the &lsquo;<code>boot</code>&rsquo; package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_jackknife_values(grouping, stat_fun, data, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_jackknife_values_+3A_grouping">grouping</code></td>
<td>
<p>A character string specifying the column in <code>data</code> that
contains the group names (i.e. a factorial variable, e.g., for the
differentiation of batches or formulations of a drug product).</p>
</td></tr>
<tr><td><code id="get_jackknife_values_+3A_stat_fun">stat_fun</code></td>
<td>
<p>The name of the function calculating the statistic of
interest. The statistic function must return a single number.</p>
</td></tr>
<tr><td><code id="get_jackknife_values_+3A_data">data</code></td>
<td>
<p>A data frame with the dissolution profile data in wide format
and a column for the distinction of the groups to be compared.</p>
</td></tr>
<tr><td><code id="get_jackknife_values_+3A_...">...</code></td>
<td>
<p>Further arguments that may be passed down to the statistics
function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the calculation of BCa bootstrap confidence intervals empirical
influence values of the statistic of interest for the observed data are
required. If <code class="reqn">L</code> is not provided to the <code>boot.ci()</code> function from
the &lsquo;<code>boot</code>&rsquo; package, the values are calculated, if needed,
using the <code>empinf()</code> function (also from the &lsquo;<code>boot</code>&rsquo;
package). Since the results returned by <code>empinf()</code> are not appropriate
in this case, the <code class="reqn">L</code> values are determined using
<code>get_jackknife_values()</code>. The jackknife calculations are done by
calculating the leave-one-out estimates.
</p>


<h3>Value</h3>

<p>A list of the jackknife assessment with the following elements is
returned:
</p>
<table>
<tr><td><code>theta.hat</code></td>
<td>
<p>The original value of the statistic.</p>
</td></tr>
<tr><td><code>theta.jack</code></td>
<td>
<p>The jackknife value of the statistic.</p>
</td></tr>
<tr><td><code>jack.se</code></td>
<td>
<p>The jackknife standard error of the statistic.</p>
</td></tr>
<tr><td><code>jack.bias</code></td>
<td>
<p>The bias of the statistic.</p>
</td></tr>
<tr><td><code>loo.values</code></td>
<td>
<p>The leave-one-out values.</p>
</td></tr>
<tr><td><code>pseudo.values</code></td>
<td>
<p>The pseudo values.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Chen, H. Bootstrap and Jackknife Calculations in R. 2004.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bootstrap_f2">bootstrap_f2</a></code>, <code><a href="boot.html#topic+boot">boot</a></code>,
<code><a href="boot.html#topic+boot.ci">boot.ci</a></code>.
</p>

<hr>
<h2 id='get_profile_portion'>Profile portion determination</h2><span id='topic+get_profile_portion'></span>

<h3>Description</h3>

<p>The function <code>get_profile_portion()</code> determines, depending on the value
of <code>use_EMA</code>, which part of the profile will be used for the similarity
assessment (EMA: European Medicines Agency).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_profile_portion(data, tcol, groups, use_EMA = "yes", bounds = c(1, 85))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_profile_portion_+3A_data">data</code></td>
<td>
<p>A data frame with the dissolution profile data in wide format.</p>
</td></tr>
<tr><td><code id="get_profile_portion_+3A_tcol">tcol</code></td>
<td>
<p>A vector of indices specifying the columns in <code>data</code> that
contain the % release values. The length of <code>tcol</code> must be two or
longer.</p>
</td></tr>
<tr><td><code id="get_profile_portion_+3A_groups">groups</code></td>
<td>
<p>A logical vector specifying different groups.</p>
</td></tr>
<tr><td><code id="get_profile_portion_+3A_use_ema">use_EMA</code></td>
<td>
<p>A character string indicating if the similarity factor
<code class="reqn">f_2</code> should be calculated following the EMA guideline &ldquo;On the
investigation of bioequivalence&rdquo; (<code>"yes"</code>, the default) or not
(<code>"no"</code>). A third option is <code>"ignore"</code>. If <code>use_EMA</code> is
<code>"yes"</code> or <code>"no"</code> the appropriate profile portion is determined
on the basis of the values of the parameter <code>bounds</code>. If it is
<code>"ignore"</code>, the complete profiles are used as specified by the
parameter <code>tcol</code>.</p>
</td></tr>
<tr><td><code id="get_profile_portion_+3A_bounds">bounds</code></td>
<td>
<p>A numeric vector of the form <code>c(lower, upper)</code> specifying
the &ldquo;lower&rdquo; and &ldquo;upper&rdquo; limits, respectively, for the %
drug release given that <code>use_EMA</code> is <code>"no"</code>. The default is
<code>c(1, 85)</code>. Mean % release values of any of the two groups being
compared that are smaller than or equal to the lower bound are ignored and
only the first mean % release value that is greater than or equal to the
upper bound is included while all the subsequent values are ignored. If
<code>use_EMA</code> is <code>"yes"</code> the <code>bounds</code> are <code>c(1, 85)</code> per
definition.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>get_profile_portion()</code> determines which part of
a dissolution profile is used for comparison based on the recommendations of
the European Medicines Agency's guideline &ldquo;On the investigation of
bioequivalence&rdquo;. It says that profile similarity testing and any conclusions
drawn from the results can be considered valid only if the dissolution
profile has been satisfactorily characterised using a sufficient number of
time points. For immediate release formulations comparison at 15 minutes is
essential to know if complete dissolution is reached before gastric emptying.
Where more than 85% of the drug is dissolved within 15 minutes, dissolution
profiles may be accepted as similar without further mathematical evaluation.
In case more than 85% is not dissolved at 15 minutes but within 30 minutes,
at least three time points are required: the first time point before 15
minutes, the second at 15 minutes, and the third time point when the release
is close to 85%. For modified release products, the advice given in the
relevant guidance should be followed. Dissolution similarity may be
determined using the <code class="reqn">f_2</code> statistic as follows:
</p>
<p style="text-align: center;"><code class="reqn">f_2 = 50 \times \log \left(\frac{100}{\sqrt{1 + \frac{\sum_{t=1}^{n}
  \left(\bar{R}(t) - \bar{T}(t) \right)^2}{n}}} \right) .</code>
</p>

<p>In this equation
</p>

<dl>
<dt><code class="reqn">f_2</code></dt><dd><p>is the similarity factor,</p>
</dd>
<dt><code class="reqn">n</code></dt><dd><p>is the number of time points,</p>
</dd>
<dt><code class="reqn">\bar{R}(t)</code></dt><dd><p>is the mean percent reference drug
dissolved at time <code class="reqn">t</code> after initiation of the study, and</p>
</dd>
<dt><code class="reqn">\bar{T}(t)</code></dt><dd><p>is the mean percent test drug dissolved
at time <code class="reqn">t</code> after initiation of the study.</p>
</dd>
</dl>

<p>For both the reference and the test formulations, percent dissolution should
be determined. The evaluation of the similarity factor is based on the
following conditions (called &ldquo;EMA Rules&rdquo;, from the European Medicines
Agency (EMA) guideline &ldquo;On the investigation of bioequivalence&rdquo;):
</p>

<ol>
<li><p> A minimum of three time points (zero excluded).
</p>
</li>
<li><p> The time points should be the same for the two formulations.
</p>
</li>
<li><p> Twelve individual values for every time point for each formulation.
</p>
</li>
<li><p> Not more than one mean value of &gt; 85% dissolved for any of the
formulations.
</p>
</li>
<li><p> The relative standard deviation or coefficient of variation of any
product should be less than 20% for the first time point and less than
10% from the second to the last time point.
</p>
</li></ol>

<p>An <code class="reqn">f_2</code> value between 50 and 100 suggests that the two dissolution
profiles are similar.
</p>


<h3>Value</h3>

<p>The function returns a logical vector defining the appropriate
profile portion.
</p>


<h3>References</h3>

<p>European Medicines Agency (EMA), Committee for Medicinal Products for
Human Use (CHMP). Guideline on the Investigation of Bioequivalence. 2010;
CPMP/EWP/QWP/1401/98 Rev. 1.<br />
<a href="https://www.ema.europa.eu/en/documents/scientific-guideline/guideline-investigation-bioequivalence-rev1_en.pdf">https://www.ema.europa.eu/en/documents/scientific-guideline/guideline-investigation-bioequivalence-rev1_en.pdf</a>
</p>

<hr>
<h2 id='get_sim_lim'>Similarity limit</h2><span id='topic+get_sim_lim'></span>

<h3>Description</h3>

<p>The function <code>get_sim_lim()</code> estimates a similarity limit in terms of
the &ldquo;Multivariate Statistical Distance&rdquo; (MSD).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_sim_lim(mtad, lhs)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_sim_lim_+3A_mtad">mtad</code></td>
<td>
<p>A numeric value specifying the &ldquo;maximum tolerable average
difference&rdquo; (MTAD) of the profiles of two formulations at all time points
(in %). The default value is <code>10</code>. It determines the size of the
similarity limit <code class="reqn">\bm{d}_g</code>.</p>
</td></tr>
<tr><td><code id="get_sim_lim_+3A_lhs">lhs</code></td>
<td>
<p>A list of the estimates of Hotelling's two-sample <code class="reqn">T^2</code>
statistic for small samples as returned by the function
<code><a href="#topic+get_hotellings">get_hotellings</a>()</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Details about the estimation of similarity limits in terms of
the &ldquo;Multivariate Statistical Distance&rdquo; (MSD) are explained in
the corresponding section below.
</p>


<h3>Value</h3>

<p>A vector containing the following information is returned:
</p>
<table>
<tr><td><code>DM</code></td>
<td>
<p>The Mahalanobis distance of the samples.</p>
</td></tr>
<tr><td><code>df1</code></td>
<td>
<p>Degrees of freedom (number of variables or time points).</p>
</td></tr>
<tr><td><code>df2</code></td>
<td>
<p>Degrees of freedom (number of rows - number of variables - 1).</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>The provided significance level.</p>
</td></tr>
<tr><td><code>K</code></td>
<td>
<p>Scaling factor for <code class="reqn">F</code> to account for the distribution of the
<code class="reqn">T^2</code> statistic.</p>
</td></tr>
<tr><td><code>k</code></td>
<td>
<p>Scaling factor for the squared Mahalanobis distance to obtain
the <code class="reqn">T^2</code> statistic.</p>
</td></tr>
<tr><td><code>T2</code></td>
<td>
<p>Hotelling's <code class="reqn">T^2</code> statistic (<code class="reqn">F</code>-distributed).</p>
</td></tr>
<tr><td><code>F</code></td>
<td>
<p>Observed <code class="reqn">F</code> value.</p>
</td></tr>
<tr><td><code>ncp.Hoffelder</code></td>
<td>
<p>Non-centrality parameter for calculation of the <code class="reqn">F</code>
statistic (<code class="reqn">T^2</code> test procedure).</p>
</td></tr>
<tr><td><code>F.crit</code></td>
<td>
<p>Critical <code class="reqn">F</code> value (Tsong's procedure).</p>
</td></tr>
<tr><td><code>F.crit.Hoffelder</code></td>
<td>
<p>Critical <code class="reqn">F</code> value (<code class="reqn">T^2</code> test procedure).</p>
</td></tr>
<tr><td><code>p.F</code></td>
<td>
<p>The <code class="reqn">p</code> value for the Hotelling's <code class="reqn">T^2</code> test statistic.</p>
</td></tr>
<tr><td><code>p.F.Hoffelder</code></td>
<td>
<p>The <code class="reqn">p</code> value for the Hotelling's <code class="reqn">T^2</code>
statistic based on the non-central <code class="reqn">F</code> distribution.</p>
</td></tr>
<tr><td><code>MTAD</code></td>
<td>
<p>Specified &ldquo;maximum tolerable average difference&rdquo; (MTAD)
of the profiles of two formulations at each individual time point (in %).</p>
</td></tr>
<tr><td><code>Sim.Limit</code></td>
<td>
<p>Critical Mahalanobis distance or similarity limit
(Tsong's procedure).</p>
</td></tr>
</table>


<h3>Similarity limits in terms of MSD</h3>

<p>For the calculation of the &ldquo;Multivariate Statistical Distance&rdquo; (MSD),
the procedure proposed by Tsong et al. (1996) can be considered as
well-accepted method that is actually recommended by the FDA. According
to this method, a multivariate statistical distance, called Mahalanobis
distance, is used to measure the difference between two multivariate means.
This distance measure is calculated as
</p>
<p style="text-align: center;"><code class="reqn">D_M = \sqrt{ \left( \bm{x_T} - \bm{x_R} \right)^{\top}
  \bm{S}_{pooled}^{-1} \left( \bm{x_T} - \bm{x_R} \right)} ,</code>
</p>

<p>where <code class="reqn">\bm{S}_{pooled} = \frac{\left( \bm{S}_T + \bm{S}_R \right)}{2}</code> is the sample variance-covariance matrix
pooled across the batches, <code class="reqn">\bm{x}_T</code> and <code class="reqn">\bm{x}_R</code> are
the vectors of the sample means for the test (<code class="reqn">T</code>) and reference
(<code class="reqn">R</code>) profiles, and <code class="reqn">\bm{S}_T</code> and <code class="reqn">\bm{S}_R</code> are the
variance-covariance matrices of the test and reference profiles.
</p>
<p>In order to determine the similarity limits in terms of the MSD, i.e. the
Mahalanobis distance between the two multivariate means of the dissolution
profiles of the formulations to be compared, Tsong et al. (1996) proposed
using the equation
</p>
<p style="text-align: center;"><code class="reqn">D_M^{max} = \sqrt{ \bm{d}_g^{\top} \bm{S}_{pooled}^{-1} \bm{d}_g} ,</code>
</p>

<p>where <code class="reqn">\bm{d}_g</code> is a <code class="reqn">1 \times p</code> vector with all
<code class="reqn">p</code> elements equal to an empirically defined limit <code class="reqn">\bm{d}_g</code>,
e.g., <code class="reqn">15</code>%, for the maximum tolerable difference at all time points,
and <code class="reqn">p</code> is the number of sampling points. By assuming that the data
follow a multivariate normal distribution, the 90% confidence region
(<code class="reqn">CR</code>) bounds for the true difference between the mean vectors,
<code class="reqn">\bm{\mu}_T - \bm{\mu}_R</code>, can be computed for the
resultant vector <code class="reqn">\bm{\mu}</code> to satisfy the following condition:
</p>
<p style="text-align: center;"><code class="reqn">\bm{CR} = K \left( \bm{\mu} - \left( \bm{x_T} - \bm{x_R} \right)
  \right)^{\top} \bm{S}_{pooled}^{-1} \left( \bm{\mu} - \left( \bm{x_T} -
  \bm{x_R} \right) \right) \leq F_{p, n_T + n_R - p - 1, 0.9} ,</code>
</p>

<p>where <code class="reqn">K</code> is the scaling factor that is calculated as
</p>
<p style="text-align: center;"><code class="reqn">K = \frac{n_T n_R}{n_T + n_R} \cdot \frac{n_T + n_R - p - 1}{
  \left( n_T + n_R - 2 \right) \cdot p} ,</code>
</p>

<p>and <code class="reqn">F_{p, n_T + n_R - p - 1, 0.9}</code> is the <code class="reqn">90^{th}</code> percentile of
the <code class="reqn">F</code> distribution with degrees of freedom <code class="reqn">p</code> and
<code class="reqn">n_T + n_R - p - 1</code>. It is obvious that <code class="reqn">(n_T + n_R)</code> must be greater
than <code class="reqn">(p + 1)</code>. The formula for <code class="reqn">CR</code> gives a <code class="reqn">p</code>-variate 90%
confidence region for the possible true differences. <br />
</p>


<h3>T2 test for equivalence</h3>

<p>Based on the distance measure for profile comparison that was suggested by
Tsong et al. (1996), i.e. the Mahalanobis distance, Hoffelder (2016) proposed
a statistical equivalence procedure for that distance, the so-called
<code class="reqn">T^2</code> test for equivalence (T2EQ). It is used to demonstrate that the
Mahalanobis distance between reference and test group dissolution profiles
is smaller than the &ldquo;Equivalence Margin&rdquo; (EM). Decision in favour of
equivalence is taken if the <code class="reqn">p</code> value of this test statistic is smaller
than the pre-specified significance level <code class="reqn">\alpha</code>, i.e. if
<code class="reqn">p &lt; \alpha</code>. The <code class="reqn">p</code> value is calculated by aid of the formula
</p>
<p style="text-align: center;"><code class="reqn">p = F_{p, n_T + n_R - p - 1, ncp, \alpha}
  \frac{n_T + n_R - p - 1}{(n_T + n_R - 2) p} T^2 ,</code>
</p>

<p>where <code class="reqn">\alpha</code> is the significance level and <code class="reqn">ncp</code> is the so-called
&ldquo;<em>non-centrality parameter</em>&rdquo; that is calculated by
</p>
<p style="text-align: center;"><code class="reqn">\frac{n_T n_R}{n_T + n_R} \left( D_M^{max} \right)^2 .</code>
</p>

<p>The test statistic being used is Hotelling's <code class="reqn">T^2</code> that is given as
</p>
<p style="text-align: center;"><code class="reqn">T^2 = \frac{n_T n_R}{n_T + n_R} \left( \bm{x_T} - \bm{x_R}
  \right)^{\top} \bm{S}_{pooled}^{-1} \left( \bm{x_T} - \bm{x_R} \right) .</code>
</p>

<p>As mentioned elsewhere, <code class="reqn">\bm{d}_g</code> is a <code class="reqn">1 \times p</code>
vector with all <code class="reqn">p</code> elements equal to an empirically defined limit
<code class="reqn">d_g</code>. Thus, the components of the vector <code class="reqn">\bm{d}_g</code> can be
interpreted as upper bound for a kind of &ldquo;<em>average</em>&rdquo; allowed
difference between test and reference profiles, the &ldquo;<em>global
similarity limit</em>&rdquo;. Since the EMA requires that &ldquo;similarity acceptance
limits should be pre-defined and justified and not be greater than a 10%
difference&rdquo;, it is recommended to use 10%, not 15% as proposed by Tsong
et al. (1996), for the maximum tolerable difference at all time points.
</p>


<h3>References</h3>

<p>Tsong, Y., Hammerstrom, T., Sathe, P.M., and Shah, V.P. Statistical
assessment of mean differences between two dissolution data sets.
<em>Drug Inf J</em>. 1996; <strong>30</strong>: 1105-1112.<br />
doi: <a href="https://doi.org/10.1177/009286159603000427">10.1177/009286159603000427</a>
</p>
<p>Wellek S. (2010) <em>Testing statistical hypotheses of equivalence and
noninferiority</em> (2nd ed.). Chapman &amp; Hall/CRC, Boca Raton.<br />
doi: <a href="https://doi.org/10.1201/EBK1439808184">10.1201/EBK1439808184</a>
</p>
<p>Hoffelder, T. Highly variable dissolution profiles. Comparison of
<code class="reqn">T^2</code>-test for equivalence and <code class="reqn">f_2</code> based methods. <em>Pharm Ind</em>.
2016; <strong>78</strong>(4): 587-592.<br />
<a href="https://www.ecv.de/suse_item.php?suseId=Z%7Cpi%7C8430">https://www.ecv.de/suse_item.php?suseId=Z|pi|8430</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mimcr">mimcr</a></code>, <code><a href="#topic+get_hotellings">get_hotellings</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Dissolution data of one reference batch and one test batch of n = 6
# tablets each:
str(dip1)

# 'data.frame':	12 obs. of  10 variables:
# $ type  : Factor w/ 2 levels "R","T": 1 1 1 1 1 1 2 2 2 2 ...
# $ tablet: Factor w/ 6 levels "1","2","3","4",..: 1 2 3 4 5 6 1 2 3 4 ...
# $ t.5   : num  42.1 44.2 45.6 48.5 50.5 ...
# $ t.10  : num  59.9 60.2 55.8 60.4 61.8 ...
# $ t.15  : num  65.6 67.2 65.6 66.5 69.1 ...
# $ t.20  : num  71.8 70.8 70.5 73.1 72.8 ...
# $ t.30  : num  77.8 76.1 76.9 78.5 79 ...
# $ t.60  : num  85.7 83.3 83.9 85 86.9 ...
# $ t.90  : num  93.1 88 86.8 88 89.7 ...
# $ t.120 : num  94.2 89.6 90.1 93.4 90.8 ...

# Estimation of the parameters for Hotelling's two-sample T2 statistic
# (for small samples)
hs &lt;- get_hotellings(m1 = as.matrix(dip1[dip1$type == "R", c("t.15", "t.90")]),
                    m2 = as.matrix(dip1[dip1$type == "T", c("t.15", "t.90")]),
                    signif = 0.1)

# Estimation of the similarity limit in terms of the "Multivariate Statistical
# Distance" (MSD)for a "maximum tolerable average difference" (mtad) of 10
res &lt;- get_sim_lim(mtad = 15, hs)

# Expected results in res
#            DM              df1              df2            alpha
#  1.044045e+01     2.000000e+00     9.000000e+00     1.000000e-01
#             K                k               T2                F
#  1.350000e+00     3.000000e+00     3.270089e+02     1.471540e+02
# ncp.Hoffelder           F.crit F.crit.Hoffelder              p.F
#  2.782556e+02     3.006452e+00     8.357064e+01     1.335407e-07
# p.F.Hoffelder             MTAD        Sim.Limit
#  4.822832e-01     1.500000e+01     9.630777e+00
</code></pre>

<hr>
<h2 id='get_time_points'>Get time points</h2><span id='topic+get_time_points'></span>

<h3>Description</h3>

<p>The function <code>get_time_points()</code> extracts the numeric information from
a vector of character strings, if available.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_time_points(svec)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_time_points_+3A_svec">svec</code></td>
<td>
<p>A vector of character strings.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function expects a vector of character strings that contain
numeric information. If the strings contain extractable numeric information
a named numeric vector is returned, where the names are derived from the
strings provided by <code>svec</code>. For example, from the vector
<code>c("t_0", "t_5", "t_10")</code> the named numeric vector <code>(0, 5, 10)</code>
is returned, where the names correspond to the original string. If a string
does not contain any numeric information <code>NA</code> is returned.
</p>


<h3>Value</h3>

<p>A vector of the same length as <code>svec</code> with the extracted
numbers as numeric values.
</p>

<hr>
<h2 id='make_grouping'>Grouping</h2><span id='topic+make_grouping'></span>

<h3>Description</h3>

<p>The function <code>make_grouping()</code> makes the grouping according to the
<code>grouping</code> column.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_grouping(data, grouping)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="make_grouping_+3A_data">data</code></td>
<td>
<p>A data frame with the dissolution profile data in wide format
and a column for the distinction of the groups to be compared.</p>
</td></tr>
<tr><td><code id="make_grouping_+3A_grouping">grouping</code></td>
<td>
<p>A character string specifying the column in <code>data</code> that
contains the group names (i.e. a factorial variable, e.g., for the
differentiation of batches or formulations of a drug product).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If one of the two levels of the <code>grouping</code> column is named
&ldquo;references&rdquo; or &ldquo;References&rdquo; or some abbreviation thereof
(in the extreme case just &ldquo;r&rdquo;) this level will be used as reference
level. Otherwise the first level of the <code>grouping</code> column (according to
the level sorting of the column) will be assumed representing the reference
group.
</p>


<h3>Value</h3>

<p>A logical vector of length <code>nrow(data)</code> where <code>TRUE</code>
represents the reference and <code>FALSE</code> represents the test group.
</p>

<hr>
<h2 id='mimcr'>Model-independent multivariate confidence region (MIMCR) procedure</h2><span id='topic+mimcr'></span>

<h3>Description</h3>

<p>The function <code>mimcr()</code> assesses the equivalence of highly variable
dissolution profiles. It does so by applying different methods proposed in
the literature, implementing the non-parametric &ldquo;Model-Independent
Multivariate Confidence Region&rdquo; (MIMCR) procedure and the &ldquo;<code class="reqn">T^2</code>
test for equivalence&rdquo; of dissolution data as proposed by Hoffelder (2016).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mimcr(
  data,
  tcol,
  grouping,
  fit_n_obs = FALSE,
  mtad = 10,
  signif = 0.05,
  max_trial = 50,
  bounds = c(1, 85),
  tol = 1e-09
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mimcr_+3A_data">data</code></td>
<td>
<p>A data frame with the dissolution profile data in wide format.</p>
</td></tr>
<tr><td><code id="mimcr_+3A_tcol">tcol</code></td>
<td>
<p>A vector of indices specifying the columns in <code>data</code> that
contain the % release values. The length of <code>tcol</code> must be three or
longer.</p>
</td></tr>
<tr><td><code id="mimcr_+3A_grouping">grouping</code></td>
<td>
<p>A character string specifying the column in <code>data</code> that
contains the group names (i.e. a factorial variable, e.g., for the
differentiation of batches or formulations of a drug product).</p>
</td></tr>
<tr><td><code id="mimcr_+3A_fit_n_obs">fit_n_obs</code></td>
<td>
<p>A logical value specifying if the number of rows per level
in the column specified by the <code>grouping</code> parameter should be adjusted
to be equal given that they are not equal. The default is <code>FALSE</code>
because each group should have the same number of observations. If
<code>fit_n_obs</code> is <code>TRUE</code>, redundant observations from the level
with more observations are dropped, i.e. only the observations <code>1</code>
to the number of observations of the level with the fewer observations
will be used for the comparison of the two groups.</p>
</td></tr>
<tr><td><code id="mimcr_+3A_mtad">mtad</code></td>
<td>
<p>A numeric value specifying the &ldquo;maximum tolerable average
difference&rdquo; (MTAD) of the profiles of two formulations at all time points
(in %). The default value is <code>10</code>. It determines the size of the
similarity limit <code class="reqn">\bm{d}_g</code>.</p>
</td></tr>
<tr><td><code id="mimcr_+3A_signif">signif</code></td>
<td>
<p>A positive numeric value between <code>0</code> and <code>1</code>
specifying the significance level for the calculation of the
&ldquo;Confidence Region&rdquo; (CR). The coverage of CR is
<code class="reqn">(1 - signif) 100</code>%. The default value is <code>0.05</code>.</p>
</td></tr>
<tr><td><code id="mimcr_+3A_max_trial">max_trial</code></td>
<td>
<p>A positive integer specifying the maximum number of
Newton-Raphson search rounds to be performed.</p>
</td></tr>
<tr><td><code id="mimcr_+3A_bounds">bounds</code></td>
<td>
<p>A numeric vector of the form <code>c(lower, upper)</code> specifying
the &ldquo;lower&rdquo; and &ldquo;upper&rdquo; limits, respectively, for the %
drug release. The default is <code>c(1, 85)</code>. Mean % release values of
any of the two groups being compared that are smaller than or equal to the
lower bound are ignored and only the first mean % release value that is
greater than or equal to the upper bound is included while all the
subsequent values are ignored.</p>
</td></tr>
<tr><td><code id="mimcr_+3A_tol">tol</code></td>
<td>
<p>A non-negative numeric specifying the accepted minimal
difference between two consecutive search rounds.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>mimcr()</code> assesses the equivalence of highly
variable dissolution profiles by aid of a &ldquo;Model-Independent
Multivariate Confidence Region&rdquo; (MIMCR) procedure as proposed by Tsong et al.
(1996) and by aid of a &ldquo;T2 test for equivalence&rdquo; as proposed by
Hoffelder (2016).
</p>
<p>For details see the sections &ldquo;Comparison of highly variable
dissolution profiles&rdquo;, &ldquo;Similarity limits in terms of MSD&rdquo; and
&ldquo;T2 test for equivalence&rdquo; below.
</p>


<h3>Value</h3>

<p>An object of class &lsquo;<code>mimcr</code>&rsquo; is returned, containing
the following list elements:
</p>
<table>
<tr><td><code>Similarity</code></td>
<td>
<p>Conclusion concerning similarity.</p>
</td></tr>
<tr><td><code>Parameters</code></td>
<td>
<p>Parameters calculated during the assessment.</p>
</td></tr>
<tr><td><code>NR.CI</code></td>
<td>
<p>List with results from the Newton-Raphson (NR) search.</p>
</td></tr>
<tr><td><code>Profile.TP</code></td>
<td>
<p>A named numeric vector of the columns in <code>data</code>
specified by <code>tcol</code>. Given that the column names contain extractable
numeric information, e.g., specifying the testing time points of the
dissolution profile, it contains the corresponding values. Elements
where no numeric information could be extracted are <code>NA</code>.</p>
</td></tr>
</table>
<p>The <code>Parameters</code> element contains the following information:
</p>
<table>
<tr><td><code>DM</code></td>
<td>
<p>The Mahalanobis distance of the samples.</p>
</td></tr>
<tr><td><code>df1</code></td>
<td>
<p>Degrees of freedom (number of variables or time points).</p>
</td></tr>
<tr><td><code>df2</code></td>
<td>
<p>Degrees of freedom (number of rows - number of variables - 1).</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>The provided significance level.</p>
</td></tr>
<tr><td><code>K</code></td>
<td>
<p>Scaling factor for <code class="reqn">F</code> to account for the distribution of the
<code class="reqn">T^2</code> statistic.</p>
</td></tr>
<tr><td><code>k</code></td>
<td>
<p>Scaling factor for the squared Mahalanobis distance to obtain
the <code class="reqn">T^2</code> statistic.</p>
</td></tr>
<tr><td><code>T2</code></td>
<td>
<p>Hotelling's <code class="reqn">T^2</code> statistic (<code class="reqn">F</code>-distributed).</p>
</td></tr>
<tr><td><code>F</code></td>
<td>
<p>Observed <code class="reqn">F</code> value.</p>
</td></tr>
<tr><td><code>ncp.Hoffelder</code></td>
<td>
<p>Non-centrality parameter for calculation of the <code class="reqn">F</code>
statistic (<code class="reqn">T^2</code> test procedure).</p>
</td></tr>
<tr><td><code>F.crit</code></td>
<td>
<p>Critical <code class="reqn">F</code> value (Tsong's procedure).</p>
</td></tr>
<tr><td><code>F.crit.Hoffelder</code></td>
<td>
<p>Critical <code class="reqn">F</code> value (<code class="reqn">T^2</code> test procedure).</p>
</td></tr>
<tr><td><code>p.F</code></td>
<td>
<p>The <code class="reqn">p</code> value for the Hotelling's <code class="reqn">T^2</code> test statistic.</p>
</td></tr>
<tr><td><code>p.F.Hoffelder</code></td>
<td>
<p>The <code class="reqn">p</code> value for the Hotelling's <code class="reqn">T^2</code>
statistic based on the non-central <code class="reqn">F</code> distribution.</p>
</td></tr>
<tr><td><code>MTAD</code></td>
<td>
<p>Specified &ldquo;maximum tolerable average difference&rdquo; (MTAD)
of the profiles of two formulations at each individual time point (in %).</p>
</td></tr>
<tr><td><code>Sim.Limit</code></td>
<td>
<p>Critical Mahalanobis distance or similarity limit
(Tsong's procedure).</p>
</td></tr>
<tr><td><code>Obs.L</code></td>
<td>
<p>Observed lower limit (Tsong's procedure).</p>
</td></tr>
<tr><td><code>Obs.U</code></td>
<td>
<p>Observed upper limit (Tsong's procedure).</p>
</td></tr>
</table>
<p>The <code>NR.CI</code> element contains the following information:
</p>
<table>
<tr><td><code>CI</code></td>
<td>
<p>A matrix of the points on the <code class="reqn">CR</code> bounds for each time point.</p>
</td></tr>
<tr><td><code>converged</code></td>
<td>
<p>A logical specifying if the NR algorithm converged or not.</p>
</td></tr>
<tr><td><code>n.trial</code></td>
<td>
<p>Number of trials until convergence.</p>
</td></tr>
<tr><td><code>max.trial</code></td>
<td>
<p>Maximal number of trials.</p>
</td></tr>
<tr><td><code>Warning</code></td>
<td>
<p>A warning message, if applicable, or otherwise NULL.</p>
</td></tr>
<tr><td><code>Error</code></td>
<td>
<p>An error message, if applicable, or otherwise NULL.</p>
</td></tr>
</table>


<h3>Comparison of highly variable dissolution profiles</h3>

<p>When comparing the dissolution data of a post-approval change product and a
reference approval product, the goal is to assess the similarity between the
mean dissolution values at the observed sample time points. A widely used
method is the <code class="reqn">f_2</code> method that was introduced by Moore &amp; Flanner (1996).
Similarity testing criteria based on <code class="reqn">f_2</code> can be found in several FDA
guidelines and in the guideline of the European Medicines Agency (EMA)
&ldquo;On the investigation of bioequivalence&rdquo; (EMA 2010).
</p>
<p>In situations where within-batch variation is greater than 15%, FDA
guidelines recommend use of a multivariate confidence interval as an
alternative to the <code class="reqn">f_2</code> method. This can be done using the following
stepwise procedure:
</p>

<ol>
<li><p> Establish a similarity limit in terms of &ldquo;Multivariate
Statistical Distance&rdquo; (MSD) based on inter-batch differences in % drug
release from reference (standard approved) formulations, i.e. the so-
called &ldquo;Equivalence Margin&rdquo; (EM).
</p>
</li>
<li><p> Calculate the MSD between test and reference mean dissolutions.
</p>
</li>
<li><p> Estimate the 90% confidence interval (CI) of the true MSD as
determined in step 2.
</p>
</li>
<li><p> Compare the upper limit of the 90% CI with the similarity limit
determined in step 1. The test formulation is declared to be similar to
the reference formulation if the upper limit of the 90% CI is less than
or equal to the similarity limit.
</p>
</li></ol>



<h3>Similarity limits in terms of MSD</h3>

<p>For the calculation of the &ldquo;Multivariate Statistical Distance&rdquo; (MSD),
the procedure proposed by Tsong et al. (1996) can be considered as
well-accepted method that is actually recommended by the FDA. According
to this method, a multivariate statistical distance, called Mahalanobis
distance, is used to measure the difference between two multivariate means.
This distance measure is calculated as
</p>
<p style="text-align: center;"><code class="reqn">D_M = \sqrt{ \left( \bm{x_T} - \bm{x_R} \right)^{\top}
  \bm{S}_{pooled}^{-1} \left( \bm{x_T} - \bm{x_R} \right)} ,</code>
</p>

<p>where <code class="reqn">\bm{S}_{pooled} = \frac{\left( \bm{S}_T + \bm{S}_R \right)}{2}</code> is the sample variance-covariance matrix
pooled across the batches, <code class="reqn">\bm{x}_T</code> and <code class="reqn">\bm{x}_R</code> are
the vectors of the sample means for the test (<code class="reqn">T</code>) and reference
(<code class="reqn">R</code>) profiles, and <code class="reqn">\bm{S}_T</code> and <code class="reqn">\bm{S}_R</code> are the
variance-covariance matrices of the test and reference profiles.
</p>
<p>In order to determine the similarity limits in terms of the MSD, i.e. the
Mahalanobis distance between the two multivariate means of the dissolution
profiles of the formulations to be compared, Tsong et al. (1996) proposed
using the equation
</p>
<p style="text-align: center;"><code class="reqn">D_M^{max} = \sqrt{ \bm{d}_g^{\top} \bm{S}_{pooled}^{-1} \bm{d}_g} ,</code>
</p>

<p>where <code class="reqn">\bm{d}_g</code> is a <code class="reqn">1 \times p</code> vector with all
<code class="reqn">p</code> elements equal to an empirically defined limit <code class="reqn">\bm{d}_g</code>,
e.g., <code class="reqn">15</code>%, for the maximum tolerable difference at all time points,
and <code class="reqn">p</code> is the number of sampling points. By assuming that the data
follow a multivariate normal distribution, the 90% confidence region
(<code class="reqn">CR</code>) bounds for the true difference between the mean vectors,
<code class="reqn">\bm{\mu}_T - \bm{\mu}_R</code>, can be computed for the
resultant vector <code class="reqn">\bm{\mu}</code> to satisfy the following condition:
</p>
<p style="text-align: center;"><code class="reqn">\bm{CR} = K \left( \bm{\mu} - \left( \bm{x_T} - \bm{x_R} \right)
  \right)^{\top} \bm{S}_{pooled}^{-1} \left( \bm{\mu} - \left( \bm{x_T} -
  \bm{x_R} \right) \right) \leq F_{p, n_T + n_R - p - 1, 0.9} ,</code>
</p>

<p>where <code class="reqn">K</code> is the scaling factor that is calculated as
</p>
<p style="text-align: center;"><code class="reqn">K = \frac{n_T n_R}{n_T + n_R} \cdot \frac{n_T + n_R - p - 1}{
  \left( n_T + n_R - 2 \right) \cdot p} ,</code>
</p>

<p>and <code class="reqn">F_{p, n_T + n_R - p - 1, 0.9}</code> is the <code class="reqn">90^{th}</code> percentile of
the <code class="reqn">F</code> distribution with degrees of freedom <code class="reqn">p</code> and
<code class="reqn">n_T + n_R - p - 1</code>. It is obvious that <code class="reqn">(n_T + n_R)</code> must be greater
than <code class="reqn">(p + 1)</code>. The formula for <code class="reqn">CR</code> gives a <code class="reqn">p</code>-variate 90%
confidence region for the possible true differences. <br />
</p>


<h3>T2 test for equivalence</h3>

<p>Based on the distance measure for profile comparison that was suggested by
Tsong et al. (1996), i.e. the Mahalanobis distance, Hoffelder (2016) proposed
a statistical equivalence procedure for that distance, the so-called
<code class="reqn">T^2</code> test for equivalence (T2EQ). It is used to demonstrate that the
Mahalanobis distance between reference and test group dissolution profiles
is smaller than the &ldquo;Equivalence Margin&rdquo; (EM). Decision in favour of
equivalence is taken if the <code class="reqn">p</code> value of this test statistic is smaller
than the pre-specified significance level <code class="reqn">\alpha</code>, i.e. if
<code class="reqn">p &lt; \alpha</code>. The <code class="reqn">p</code> value is calculated by aid of the formula
</p>
<p style="text-align: center;"><code class="reqn">p = F_{p, n_T + n_R - p - 1, ncp, \alpha}
  \frac{n_T + n_R - p - 1}{(n_T + n_R - 2) p} T^2 ,</code>
</p>

<p>where <code class="reqn">\alpha</code> is the significance level and <code class="reqn">ncp</code> is the so-called
&ldquo;<em>non-centrality parameter</em>&rdquo; that is calculated by
</p>
<p style="text-align: center;"><code class="reqn">\frac{n_T n_R}{n_T + n_R} \left( D_M^{max} \right)^2 .</code>
</p>

<p>The test statistic being used is Hotelling's <code class="reqn">T^2</code> that is given as
</p>
<p style="text-align: center;"><code class="reqn">T^2 = \frac{n_T n_R}{n_T + n_R} \left( \bm{x_T} - \bm{x_R}
  \right)^{\top} \bm{S}_{pooled}^{-1} \left( \bm{x_T} - \bm{x_R} \right) .</code>
</p>

<p>As mentioned elsewhere, <code class="reqn">\bm{d}_g</code> is a <code class="reqn">1 \times p</code>
vector with all <code class="reqn">p</code> elements equal to an empirically defined limit
<code class="reqn">d_g</code>. Thus, the components of the vector <code class="reqn">\bm{d}_g</code> can be
interpreted as upper bound for a kind of &ldquo;<em>average</em>&rdquo; allowed
difference between test and reference profiles, the &ldquo;<em>global
similarity limit</em>&rdquo;. Since the EMA requires that &ldquo;similarity acceptance
limits should be pre-defined and justified and not be greater than a 10%
difference&rdquo;, it is recommended to use 10%, not 15% as proposed by Tsong
et al. (1996), for the maximum tolerable difference at all time points.
</p>


<h3>References</h3>

<p>United States Food and Drug Administration (FDA). Guidance for industry:
dissolution testing of immediate release solid oral dosage forms. 1997.<br />
<a href="https://www.fda.gov/media/70936/download">https://www.fda.gov/media/70936/download</a>
</p>
<p>United States Food and Drug Administration (FDA). Guidance for industry:
immediate release solid oral dosage form: scale-up and post-approval
changes, chemistry, manufacturing and controls, <em>in vitro</em> dissolution
testing, and <em>in vivo</em> bioequivalence documentation (SUPAC-IR). 1995.<br />
<a href="https://www.fda.gov/media/70949/download">https://www.fda.gov/media/70949/download</a>
</p>
<p>European Medicines Agency (EMA), Committee for Medicinal Products for
Human Use (CHMP). Guideline on the Investigation of Bioequivalence. 2010;
CPMP/EWP/QWP/1401/98 Rev. 1.<br />
<a href="https://www.ema.europa.eu/en/documents/scientific-guideline/guideline-investigation-bioequivalence-rev1_en.pdf">https://www.ema.europa.eu/en/documents/scientific-guideline/guideline-investigation-bioequivalence-rev1_en.pdf</a>
</p>
<p>Tsong, Y., Hammerstrom, T., Sathe, P.M., and Shah, V.P. Statistical
assessment of mean differences between two dissolution data sets.
<em>Drug Inf J</em>. 1996; <strong>30</strong>: 1105-1112.<br />
doi: <a href="https://doi.org/10.1177/009286159603000427">10.1177/009286159603000427</a>
</p>
<p>Tsong, Y., Hammerstrom, T., and Chen, J.J. Multipoint dissolution
specification and acceptance sampling rule based on profile modeling and
principal component analysis. <em>J Biopharm Stat</em>. 1997; <strong>7</strong>(3):
423-439.<br />
doi: <a href="https://doi.org/10.1080/10543409708835198">10.1080/10543409708835198</a>
</p>
<p>Wellek S. (2010) <em>Testing statistical hypotheses of equivalence and
noninferiority</em> (2nd ed.). Chapman &amp; Hall/CRC, Boca Raton.<br />
doi: <a href="https://doi.org/10.1201/EBK1439808184">10.1201/EBK1439808184</a>
</p>
<p>Hoffelder, T. Highly variable dissolution profiles. Comparison of
<code class="reqn">T^2</code>-test for equivalence and <code class="reqn">f_2</code> based methods. <em>Pharm Ind</em>.
2016; <strong>78</strong>(4): 587-592.<br />
<a href="https://www.ecv.de/suse_item.php?suseId=Z%7Cpi%7C8430">https://www.ecv.de/suse_item.php?suseId=Z|pi|8430</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gep_by_nera">gep_by_nera</a></code>, <code><a href="#topic+bootstrap_f2">bootstrap_f2</a></code>,
<code><a href="#topic+mztia">mztia</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Dissolution data  of one reference batch and one test batch of n = 12
# capsules each:
str(dip3)

# 'data.frame':	24 obs. of  6 variables:
# $ cap  : Factor w/ 12 levels "1","2","3","4",..: 1 2 3 4 5 6 7 8 9 10 ...
# $ batch: Factor w/ 2 levels "blue","white": 2 2 2 2 2 2 2 2 2 2 ...
# $ type : Factor w/ 2 levels "ref","test": 1 1 1 1 1 1 1 1 1 1 ...
# $ x.15 : num  49 15 56 57 6 62 23 11 9 42 ...
# $ x.20 : num  86 59 84 87 58 90 71 64 61 81 ...
# $ x.25 : num  98 96 96 99 90 97 97 92 88 96 ...

# Using the defaults, only profile time points with an average release of &gt;= 1%
# and only one time point with an average release of &gt; 85% are taken into
# account.
res1 &lt;- mimcr(data = dip3, tcol = 4:6, grouping = "batch")
res1$Similarity
res1$Parameters

# Expected results in res1$Similarity
#     Tsong Hoffelder
# "Similar" "Similar"

# Expected results in res1$Parameters
#            DM              df1              df2            alpha
#  2.384023e-01     3.000000e+00     2.000000e+01     5.000000e-02
#             K                k               T2                F
#  1.818182e+00     6.000000e+00     3.410141e-01     1.033376e-01
# ncp.Hoffelder           F.crit F.crit.Hoffelder              p.F
#  3.032296e+01     3.098391e+00     4.899274e+00     9.571526e-01
# p.F.Hoffelder             MTAD        Sim.Limit            Obs.L
#  2.890827e-08     1.000000e+01     2.248072e+00     1.067015e+00
#         Obs.U
#  1.543820e+00

# Comparison with T2-test for equivalence for dissolution data from the 'T2EQ'
# package:
if (requireNamespace("T2EQ")) {
  library(T2EQ)
  data(ex_data_JoBS)

  T2EQ.dissolution.profiles.hoffelder(
    X = as.matrix(dip3[dip3$type == "ref", c("x.15", "x.20", "x.25")]),
    Y = as.matrix(dip3[dip3$type == "test", c("x.15", "x.20", "x.25")]))
}

# Excerpt of output:
# Hotelling's T2: 			                     0.3410141
# Noncentrality parameter:                   30.32296
# Significance level: 		                    0.05
# Teststatistic: 			                        0.1033376
# Quantile of noncent. F-distribution:        4.899274
# p-value of the T2-test for equivalence: p = 2.890827e-08

# Dissolution data of one reference batch and one test batch of n = 6
# tablets each:
str(dip1)

# 'data.frame':	12 obs. of  10 variables:
# $ type  : Factor w/ 2 levels "R","T": 1 1 1 1 1 1 2 2 2 2 ...
# $ tablet: Factor w/ 6 levels "1","2","3","4",..: 1 2 3 4 5 6 1 2 3 4 ...
# $ t.5   : num  42.1 44.2 45.6 48.5 50.5 ...
# $ t.10  : num  59.9 60.2 55.8 60.4 61.8 ...
# $ t.15  : num  65.6 67.2 65.6 66.5 69.1 ...
# $ t.20  : num  71.8 70.8 70.5 73.1 72.8 ...
# $ t.30  : num  77.8 76.1 76.9 78.5 79 ...
# $ t.60  : num  85.7 83.3 83.9 85 86.9 ...
# $ t.90  : num  93.1 88 86.8 88 89.7 ...
# $ t.120 : num  94.2 89.6 90.1 93.4 90.8 ...

# Use of 'bounds = c(1, 85)'
res2 &lt;- mimcr(data = dip1, tcol = 3:10, grouping = "type", bounds = c(1, 85))
res2$Similarity
res2$Profile.TP
res2[["Parameters"]][c("p.F.Hoffelder", "Sim.Limit", "Obs.U")]

# Expected results in res2$Similarity
#        Tsong    Hoffelder
# "Dissimilar" "Dissimilar"

# Expected results in res2$Profile.TP
# t.5 t.10 t.15 t.20 t.30 t.60 t.90
#   5   10   15   20   30   60   90

# Expected results in
# res2[["Parameters"]][c("p.F.Hoffelder", "Sim.Limit", "Obs.U")]
# p.F.Hoffelder     Sim.Limit         Obs.U
#      0.740219     11.328041     31.679020

# Allow for a larger maximum tolerable average difference (MTAD), e.g., 15.
res3 &lt;- mimcr(data = dip1, tcol = 3:10, grouping = "type", mtad = 15,
              bounds = c(1, 85))
res3$Similarity
res3[["Parameters"]][c("p.F.Hoffelder", "Sim.Limit", "Obs.U")]

# Expected results in res3$Similarity
#        Tsong    Hoffelder
# "Dissimilar" "Dissimilar"

# Expected results in
# res3[["Parameters"]][c("p.F.Hoffelder", "Sim.Limit", "Obs.U")]
# p.F.Hoffelder     Sim.Limit         Obs.U
#     0.3559019    16.9920622    31.6790198

# Use default 'mtad' but set 'signif = 0.1' and use 'bounds = c(1, 95)' so that
# the complete profiles are taken into account.
res4 &lt;- mimcr(data = dip1, tcol = 3:10, grouping = "type", mtad = 10,
              signif = 0.1, bounds = c(1, 95))
res4$Similarity
res4$Profile.TP
res4[["Parameters"]][c("p.F.Hoffelder", "Sim.Limit", "Obs.U")]

# Expected results in res3$Similarity
#        Tsong    Hoffelder
# "Dissimilar" "Dissimilar"

# Expected results in res2$Profile.TP
# t.5  t.10  t.15  t.20  t.30  t.60  t.90 t.120
#   5    10    15    20    30    60    90   120

# Expected results in
# res2[["Parameters"]][c("p.F.Hoffelder", "Sim.Limit", "Obs.U")]
# p.F.Hoffelder     Sim.Limit         Obs.U
#     0.1449045    19.4271898    33.3180044

# If 'max_trial' is too small, the Newton-Raphson search may not converge.
tryCatch(
  mimcr(data = dip1, tcol = 3:10, grouping = "type", max_trial = 5),
  warning = function(w) message(w),
  finally = message("\nMaybe increasing the number of max_trial could help."))

# If 'tol' is too big, the points found by the Newton-Raphson search may not
# be located on the confidence region boundary.
tryCatch(
  mimcr(data = dip3, tcol = 4:6, grouping = "batch", tol = 1),
  warning = function(w) message(w),
  finally = message("\nMaybe making tol smaller could help."))

# Passing in a data frame with a grouping variable with a number of levels that
# differs from two produces an error.
tmp &lt;- rbind(dip1,
             data.frame(type = "T2",
                        tablet = as.factor(1:6),
                        dip1[7:12, 3:10]))

tryCatch(
  mimcr(data = tmp, tcol = 3:10, grouping = "type", bounds = c(1, 85)),
  error = function(e) message(e),
  finally = message("\nMaybe you want to remove unesed levels in data."))

# Error in mimcr(data = tmp, tcol = 3:10, grouping = "type", bounds = ,  :
#   The number of levels in column type differs from 2.
</code></pre>

<hr>
<h2 id='mztia'>Martinez &amp; Zhao Tolerance Interval Approach</h2><span id='topic+mztia'></span>

<h3>Description</h3>

<p>The <em>Martinez &amp; Zhao Tolerance Interval Approach</em> (<code>mztia</code>) is a
simple approach for the comparison of dissolution profiles. The
<code>mztia()</code> function calculates tolerance intervals (TI) at each time
point of the dissolution profiles of a set of reference batches. By aid
of a graphical display the test batches are checked to lie within the TI
boundaries or within certain limits exceeding the TI boundaries by a
specified percentage.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mztia(
  data,
  shape,
  tcol,
  grouping,
  reference,
  response = NULL,
  alpha = 0.05,
  P = 0.99,
  cap = TRUE,
  bounds = c(0, 100),
  QS = c(5, 15),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mztia_+3A_data">data</code></td>
<td>
<p>A data frame with the dissolution profile data in wide or in
long format (see parameter <code>shape</code>). If the data frame is in wide
format, it is tried to extract the information on the time points of
dissolution testing from the column names of the columns specified by
the <code>tcol</code> parameter. Thus, they must contain extractable numeric
information, e.g., <code>(t_0, t_5, t_10)</code>. If the data frame is in long
format, it must have a column of time points (column specified via the
<code>tcol</code> parameter).</p>
</td></tr>
<tr><td><code id="mztia_+3A_shape">shape</code></td>
<td>
<p>A character string specifying if the data frame is in long or
in wide format.</p>
</td></tr>
<tr><td><code id="mztia_+3A_tcol">tcol</code></td>
<td>
<p>If <code>shape</code> is <code>"wide"</code> an integer vector of indices,
if <code>shape</code> is <code>"long"</code> an integer, specifying the column(s)
containing the profile time points. If the data frame is in <code>wide</code>
format it is reshaped using the function <code><a href="stats.html#topic+reshape">reshape</a>()</code>
from the &lsquo;<code>stats</code>&rsquo; package.</p>
</td></tr>
<tr><td><code id="mztia_+3A_grouping">grouping</code></td>
<td>
<p>A character string specifying the column in <code>data</code>
that contains the group names (i.e. a factorial variable, e.g., for the
differentiation of batches or formulations of a drug product).</p>
</td></tr>
<tr><td><code id="mztia_+3A_reference">reference</code></td>
<td>
<p>A character string specifying the name of the reference
group from the <code>grouping</code> variable.</p>
</td></tr>
<tr><td><code id="mztia_+3A_response">response</code></td>
<td>
<p>A character string that is expected if <code>data</code> is
provided in long format in order to specify the column with the % drug
release values. The default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="mztia_+3A_alpha">alpha</code></td>
<td>
<p>A numeric value between 0 and 1 specifying the probability
level. The default is <code>0.05</code>.</p>
</td></tr>
<tr><td><code id="mztia_+3A_p">P</code></td>
<td>
<p>A numeric value between 0 and 1 specifying the proportion of the
population being enclosed by the tolerance interval boundaries. The
default is <code>0.99</code>.</p>
</td></tr>
<tr><td><code id="mztia_+3A_cap">cap</code></td>
<td>
<p>A logical variable specifying if the calculated tolerance limits
should be limited (i.e. <em>cap</em>ped). The default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="mztia_+3A_bounds">bounds</code></td>
<td>
<p>A numeric vector of the form <code>c(lower, upper)</code> specifying
the &ldquo;lower&rdquo; and &ldquo;upper&rdquo; limits, respectively, for the %
drug release at which the calculated tolerance interval limits should
be capped (see parameter <code class="reqn">cap</code>. This parameter is only relevant if
<code>cap = TRUE</code>. The default is <code>c(0, 100)</code>.</p>
</td></tr>
<tr><td><code id="mztia_+3A_qs">QS</code></td>
<td>
<p>A numeric vector of the form <code>c(Q S1, Q S2)</code> that specifies
the allowable deviations from the specifications in percent according to
the <code class="reqn">S1</code> and <code class="reqn">S2</code> acceptance criteria of USP chapter &lt;711&gt; on
dissolution. The default is <code>c(5, 15)</code>.</p>
</td></tr>
<tr><td><code id="mztia_+3A_...">...</code></td>
<td>
<p>Further arguments passed on to the <code><a href="stats.html#topic+reshape">reshape</a>()</code>
from the &lsquo;<code>stats</code>&rsquo; package.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The tolerance interval approach proposed by Martinez &amp; Zhao (2018)
is a simple approach for the comparison of dissolution profiles. The authors
propose to calculate for each time point of a set of reference dissolution
profiles a tolerance interval (<code class="reqn">TI</code>), i.e. intervals containing <code class="reqn">P</code>%
of the population of potential values for reference product at a probability
level of <code class="reqn">alpha / 2</code> per tail (i.e., <code class="reqn">(1 - alpha) 100</code>% confidence).
Based on these <code class="reqn">TI</code>s the dissolution profiles of the test batch(es) is
(are) compared, i.e. the corresponding data points should lie within the
<code class="reqn">TI</code>s. The <code class="reqn">TI</code>s are calculated as
</p>
<p style="text-align: center;"><code class="reqn">Y_{utl,ltl} = \bar{Y} \pm k \times s</code>
</p>

<p>where <code class="reqn">\bar{Y}</code> is the average, <code class="reqn">s</code> is the sample standard
deviation, and the factor <code class="reqn">k</code> is calculated according to Hahn (Hahn &amp;
Meeker (1991)), as proposed in Martinez &amp; Zhao (2018).
</p>
<p>Since the goal of the comparison is not to confirm simply
&ldquo;<em>statistical sameness</em>&rdquo; but &ldquo;product comparability&rdquo;,
Martinez &amp; Zhao propose allowing acceptable deviations by utilizing the
concepts described by the United States Pharmacopoeia (USP), chapter &lt;711&gt;
on dissolution, defining <em>allowable deviations from a set of product
specifications</em> (<code class="reqn">Q</code>). The <code class="reqn">TI</code>s serve as the target value <code class="reqn">Q</code>
at each sampling time. The allowable deviations about <code class="reqn">Q</code> are defined
by the <code class="reqn">S1</code> and <code class="reqn">S2</code> acceptance criteria of USP chapter &lt;711&gt; on
dissolution:
</p>

<ol>
<li><p> The <code class="reqn">S1</code> level boundary is defined by <code class="reqn">Q \pm 5</code>%
at each time point. For every 12 profiles tested, only one profile is
allowed to exceed the <code class="reqn">S1</code> bounds.
</p>
</li>
<li><p> The <code class="reqn">S2</code> level boundary is defined by <code class="reqn">Q \pm 15</code>%
at each time point. No observation from any of the test dissolution
profiles is allowed to exceed the <code class="reqn">S2</code> bounds.
</p>
</li></ol>

<p>In situations where the reference formulation itself has more than one of
twelve observations (profiles) exceeding <code class="reqn">S1</code> at one or more time points,
additional runs of the reference product must be performed. It is deemed
appropriate to use the same values of <code class="reqn">S1</code> and <code class="reqn">S2</code> across all time
points because the high variability associated with the early sampling times
is already factored into the <code class="reqn">TI</code>s.
</p>
<p><code class="reqn">TI</code> calculation according to Hahn is proposed because it appeared to be
more numerically stable and gave more consistent <code class="reqn">TI</code>s than the <code class="reqn">TI</code>
calculation method proposed by Howe (Howe 1969) when samples were very
variable. The reason might be due to the less stringent requirements
imposed by Hahn's method with respect to the normality of the data.
</p>


<h3>Value</h3>

<p>An object of class &lsquo;<code>mztia</code>&rsquo; is returned, containing the
following elements:
</p>
<table>
<tr><td><code>Variables</code></td>
<td>
<p>A list of the variables and the corresponding values.</p>
</td></tr>
<tr><td><code>Limits</code></td>
<td>
<p>A data frame of the limits calculated for each time point.</p>
</td></tr>
<tr><td><code>Data</code></td>
<td>
<p>A data frame consisting of the provided data, complemented by
the calculated tolerance interval results.</p>
</td></tr>
<tr><td><code>Profile.TP</code></td>
<td>
<p>If <code>shape</code> is <code>"wide"</code> a named numeric vector
of the columns in <code>data</code> specified by <code>tcol</code>. Given that the
column names contain extractable numeric information, e.g., specifying
the testing time points of the dissolution profile, it contains the
corresponding values. Elements where no numeric information could be
extracted are <code>NA</code>. If <code>shape</code> is <code>"long"</code> it is a numeric
value, specifying the column containing the % release values.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Martinez, M.N., and Zhao, X. A simple approach for comparing the
<em>in vitro</em> dissolution profiles of highly variable drug products: a
proposal. <em>AAPS Journal</em>. (2018); <strong>20</strong>: 78.<br />
doi: <a href="https://doi.org/10.1208/s12248-018-0238-1">10.1208/s12248-018-0238-1</a>
</p>
<p>Howe, W.G. Two-sided tolerance limits for normal populations - some
improvements. <em>J Am Stat Assoc</em>. (1969); <strong>64</strong>: 610-620.<br />
doi: <a href="https://doi.org/10.1080/01621459.1969.10500999">10.1080/01621459.1969.10500999</a>
</p>
<p>Hahn, G.J., and Meeker, W. Q. Statistical intervals: A guide for
practitioners. (1991); John Wiley &amp; Sons, New York.
Hahn's method is also described in: SAS/QC 13.1: User's Guide. Chapter 5,
sub-chapter &ldquo;Details: INTERVALS Statement&rdquo;, pp 421-424. SAS Institute
Inc. 2013. Cary, NC.<br />
<a href="https://support.sas.com/documentation/cdl/en/qcug/66857/PDF/default/qcug.pdf">https://support.sas.com/documentation/cdl/en/qcug/66857/PDF/default/qcug.pdf</a>
</p>
<p>U.S. Pharmacopoeia. 2016 U.S. Pharmacopoeia-National Formulary
(USP 39 NF 34). Volume 1. Rockville, Md: United States Pharmacopeial
Convention, Inc; 2015. &lt;711&gt; Dissolution.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bootstrap_f2">bootstrap_f2</a></code>, <code><a href="#topic+mimcr">mimcr</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Fluid weights of 100 drink cans were measured in ounces:
str(dip5)

# 'data.frame':	100 obs. of  3 variables:
#   $ type  : Factor w/ 1 level "reference": 1 1 1 1 1 1 1 1 1 1 ...
# $ batch : Factor w/ 100 levels "b1","b10","b100",..: 1 13 24 35 46 57 68 ...
# $ weight: num  12.1 12 12 12 12 ...

# Calculation of tolerance intervals
m_alpha_P &lt;- matrix(c(rep(c(0.01, 0.05, 0.1), each = 3),
                      1 - rep(c(0.1, 0.05, 0.01), times = 3)),
                    ncol = 2, byrow = FALSE)

ll &lt;-
  apply(m_alpha_P, MARGIN = 1, FUN = function(x)
    mztia(data = dip5, shape = "long", tcol = 1, grouping = "type",
          reference = "reference", response = "weight", alpha = x[1],
          P = x[2], cap = FALSE)[["Data"]][102, "weight"])
ul &lt;-
  apply(m_alpha_P, MARGIN = 1, FUN = function(x)
    mztia(data = dip5, shape = "long", tcol = 1, grouping = "type",
          reference = "reference", response = "weight", alpha = x[1],
          P = x[2], cap = FALSE)[["Data"]][103, "weight"])

# Expected results in ll and ul
rbind(ll, ul)
#        [,1]    [,2]     [,3]     [,4]     [,5]     [,6]     [,7]     [,8]
# ll 11.91648 11.8987 11.86395 11.92132 11.90446 11.87152 11.92373 11.90734
# ul 12.10212 12.1199 12.15465 12.09728 12.11414 12.14708 12.09487 12.11126
#       [,9]
# ll 11.8753
# ul 12.1433

# Use a data frame in wide format
# Dissolution data of one reference batch and one test batch of n = 6
# tablets each:
str(dip1)

# 'data.frame':	12 obs. of  10 variables:
# $ type  : Factor w/ 2 levels "R","T": 1 1 1 1 1 1 2 2 2 2 ...
# $ tablet: Factor w/ 6 levels "1","2","3","4",..: 1 2 3 4 5 6 1 2 3 4 ...
# $ t.5   : num  42.1 44.2 45.6 48.5 50.5 ...
# $ t.10  : num  59.9 60.2 55.8 60.4 61.8 ...
# $ t.15  : num  65.6 67.2 65.6 66.5 69.1 ...
# $ t.20  : num  71.8 70.8 70.5 73.1 72.8 ...
# $ t.30  : num  77.8 76.1 76.9 78.5 79 ...
# $ t.60  : num  85.7 83.3 83.9 85 86.9 ...
# $ t.90  : num  93.1 88 86.8 88 89.7 ...
# $ t.120 : num  94.2 89.6 90.1 93.4 90.8 ...

# Using the defaults; Limits are capped to the range specified by 'bounds'
res1 &lt;- mztia(data = dip1, shape = "wide", tcol = 3:10, grouping = "type",
              reference = "R")
res1$Limits

# Expected results in res1$Limits
# Time     Mean      LTL       UTL   S1.LTL    S1.UTL   S2.LTL    S2.UTL
# 1    5 46.77167 27.22641  66.31693 22.22641  71.31693 12.22641  81.31693
# 2   10 60.13333 46.15483  74.11184 41.15483  79.11184 31.15483  89.11184
# 3   15 67.27500 56.90417  77.64583 51.90417  82.64583 41.90417  92.64583
# 4   20 71.98667 65.44354  78.52979 60.44354  83.52979 50.44354  93.52979
# 5   30 78.07000 69.54259  86.59741 64.54259  91.59741 54.54259 101.59741
# 6   60 84.81667 77.20275  92.43058 72.20275  97.43058 62.20275 107.43058
# 7   90 89.09333 76.24588 100.00000 71.24588 105.00000 61.24588 115.00000
# 8  120 91.43833 80.29321 100.00000 75.29321 105.00000 65.29321 115.00000

# Without capping of limits to 105%
res2 &lt;- mztia(data = dip1, shape = "wide", tcol = 3:10, grouping = "type",
              reference = "R", cap = FALSE)
res2$Limits

# Expected results in res1$Limits
# Time     Mean      LTL       UTL   S1.LTL    S1.UTL   S2.LTL    S2.UTL
# 1    5 46.77167 27.22641  66.31693 22.22641  71.31693 12.22641  81.31693
# 2   10 60.13333 46.15483  74.11184 41.15483  79.11184 31.15483  89.11184
# 3   15 67.27500 56.90417  77.64583 51.90417  82.64583 41.90417  92.64583
# 4   20 71.98667 65.44354  78.52979 60.44354  83.52979 50.44354  93.52979
# 5   30 78.07000 69.54259  86.59741 64.54259  91.59741 54.54259 101.59741
# 6   60 84.81667 77.20275  92.43058 72.20275  97.43058 62.20275 107.43058
# 7   90 89.09333 76.24588 101.94079 71.24588 106.94079 61.24588 116.94079
# 8  120 91.43833 80.29321 102.58346 75.29321 107.58346 65.29321 117.58346

# Tolerance intervals are calculated exclusively for the level of the
# grouping variable that is specified by the reference variable. Therefore,
# the following code produces the same limits summary as in res2$Limits.
tmp &lt;- rbind(dip1,
             data.frame(type = "T2",
                        tablet = as.factor(1:6),
                        dip1[7:12, 3:10]))

res2 &lt;- mztia(data = dip1, shape = "wide", tcol = 3:10, grouping = "type",
              reference = "R", cap = FALSE)
res3 &lt;- mztia(data = tmp, shape = "wide", tcol = 3:10, grouping = "type",
              reference = "R", cap = FALSE)

isTRUE(all.equal(res2$Limits, res3$Limits))
# [1] TRUE
</code></pre>

<hr>
<h2 id='plot_mztia'>Graphical representation of the of MZTIA estimation</h2><span id='topic+plot_mztia'></span>

<h3>Description</h3>

<p>The function <code>plot_mztia()</code> makes a graphical representation of the
estimates done by the <code>mztia()</code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_mztia(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_mztia_+3A_x">x</code></td>
<td>
<p>An object of class &lsquo;<code>mztia</code>&rsquo; returned by the
<code><a href="#topic+mztia">mztia</a>()</code> function.</p>
</td></tr>
<tr><td><code id="plot_mztia_+3A_...">...</code></td>
<td>
<p>Additional parameters that can be passed on to the
<code><a href="ggplot2.html#topic+ggplot">ggplot</a>()</code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A graphical representation of the information in the <code>Data</code>
element of the object that is returned by <code>mztia()</code> function is made
by aid of the <code><a href="ggplot2.html#topic+ggplot">ggplot</a>()</code> function from the
&lsquo;<code>ggplot2</code>&rsquo; package and added as new list element to the
<code>mztia</code> object. Ideally, the data frame provided to the
<code><a href="#topic+mztia">mztia</a>()</code> function allows drawing a time course of the % drug
release values. If a single time point is available, the tolerance intervals
of the groups specified by the <code>grouping</code> parameter (e.g., for the
differentiation of batches or formulations of a drug product) are displayed.
</p>


<h3>Value</h3>

<p>An object of class &lsquo;<code>plot_mztia</code>&rsquo; is returned invisibly,
consisting of the elements of the &lsquo;<code>mztia</code>&rsquo; object and an
additional element named <code>Graph</code>. The element <code>Graph</code> is a
&lsquo;<code>ggplot</code>&rsquo; object returned by calling the
<code><a href="ggplot2.html#topic+ggplot">ggplot</a>()</code> function.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mztia">mztia</a></code>, <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Dissolution data of one reference batch and one test batch of n = 6
# tablets each:
str(dip1)

# 'data.frame':	12 obs. of  10 variables:
# $ type  : Factor w/ 2 levels "R","T": 1 1 1 1 1 1 2 2 2 2 ...
# $ tablet: Factor w/ 6 levels "1","2","3","4",..: 1 2 3 4 5 6 1 2 3 4 ...
# $ t.5   : num  42.1 44.2 45.6 48.5 50.5 ...
# $ t.10  : num  59.9 60.2 55.8 60.4 61.8 ...
# $ t.15  : num  65.6 67.2 65.6 66.5 69.1 ...
# $ t.20  : num  71.8 70.8 70.5 73.1 72.8 ...
# $ t.30  : num  77.8 76.1 76.9 78.5 79 ...
# $ t.60  : num  85.7 83.3 83.9 85 86.9 ...
# $ t.90  : num  93.1 88 86.8 88 89.7 ...
# $ t.120 : num  94.2 89.6 90.1 93.4 90.8 ...

# Analyse the data by aid of the mztia() function.
res1 &lt;- mztia(data = dip1, shape = "wide", tcol = 3:10, grouping = "type",
              reference = "R", cap = FALSE)

# The 'mztia' object can be passed on to the plot_mztia() function. This
# function does not produce any output. It returns a 'plot_mztia' object that
# is essentially an 'mztia' object augmented by a 'ggplot' object.
gg1 &lt;- plot_mztia(res1)
gg1

# Since the element gg1$Graph is a 'ggplot' object it can be used for further
# manipulation by aid of 'ggplot2' functions.
if (requireNamespace("ggplot2")) {
  library(ggplot2)

  gg1$Graph + labs(title = "Dissolution Data Assessment",
                   x = "Time [min]", y = "Drug Release [%]")
}

# Use a data frame in long format.
# Fluid weights of 100 drink cans were measured in ounces:
str(dip5)

# 'data.frame':	100 obs. of  3 variables:
# $ type  : Factor w/ 1 level "reference": 1 1 1 1 1 1 1 1 1 1 ...
# $ batch : Factor w/ 100 levels "b1","b10","b100",..: 1 13 24 35 46 57 68 ...
# $ weight: num  12.1 12 12 12 12 ...

res2 &lt;- mztia(data = dip5, shape = "long", tcol = 3, grouping = "type",
             reference = "reference", response = "weight", cap = FALSE,
             QS = c(5, 15) / 100)

gg2 &lt;- plot_mztia(res2)
gg2

if (requireNamespace("ggplot2")) {
  library(ggplot2)

  gg2$Graph + labs(title = "Tolerance Intervals",
                   x = NULL, y = "Weight [ounces]")
}
</code></pre>

<hr>
<h2 id='plot.bootstrap_f2'>Plot of the bootstrap f2 simulation</h2><span id='topic+plot.bootstrap_f2'></span>

<h3>Description</h3>

<p>This is a method for the function <code>plot()</code> for objects of class
&lsquo;<code>bootstrap_f2</code>&rsquo;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bootstrap_f2'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.bootstrap_f2_+3A_x">x</code></td>
<td>
<p>An object of class &lsquo;<code>bootstrap_f2</code>&rsquo; returned by the
<code><a href="#topic+bootstrap_f2">bootstrap_f2</a>()</code> function.</p>
</td></tr>
<tr><td><code id="plot.bootstrap_f2_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods or arguments
that can be passed down to the <code><a href="boot.html#topic+plot.boot">plot.boot</a>()</code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The element <code>Boot</code> of the &lsquo;<code>bootstrap_f2</code>&rsquo; object
that is returned by the function <code><a href="#topic+bootstrap_f2">bootstrap_f2</a>()</code> is an object
of class &lsquo;<code>boot</code>&rsquo;, generated by the function
<code><a href="boot.html#topic+boot">boot</a>()</code> from the &lsquo;<code>boot</code>&rsquo; package. Thus, the
corresponding <code>plot</code> method is used. Arguments to the
<code><a href="boot.html#topic+plot.boot">plot.boot</a>()</code> function can be passed via the <code>...</code>
parameter. In addition to making the plot the function prints the result of
Shah's lower 90% BCa confidence interval to the console.
</p>


<h3>Value</h3>

<p>The &lsquo;<code>bootstrap_f2</code>&rsquo; object passed to the <code>x</code>
parameter is returned invisibly.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bootstrap_f2">bootstrap_f2</a></code>, <code><a href="boot.html#topic+boot">boot</a></code>,
<code><a href="boot.html#topic+plot.boot">plot.boot</a></code>, <code><a href="utils.html#topic+methods">methods</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Dissolution data of one reference batch and five test batches of n = 12
# tablets each:
str(dip2)

# 'data.frame':	72 obs. of  8 variables:
# $ type  : Factor w/ 2 levels "Reference","Test": 1 1 1 1 1 1 1 1 1 1 ...
# $ tablet: Factor w/ 12 levels "1","2","3","4",..: 1 2 3 4 5 6 7 8 9 10 ...
# $ batch : Factor w/ 6 levels "b0","b1","b2",..: 1 1 1 1 1 1 1 1 1 1 ...
# $ t.0   : int  0 0 0 0 0 0 0 0 0 0 ...
# $ t.30  : num  36.1 33 35.7 32.1 36.1 34.1 32.4 39.6 34.5 38 ...
# $ t.60  : num  58.6 59.5 62.3 62.3 53.6 63.2 61.3 61.8 58 59.2 ...
# $ t.90  : num  80 80.8 83 81.3 72.6 83 80 80.4 76.9 79.3 ...
# $ t.180 : num  93.3 95.7 97.1 92.8 88.8 97.4 96.8 98.6 93.3 94 ...

# Bootstrap assessment of data (two groups) by aid of bootstrap_f2() function
# by using 'rand_mode = "complete"' (the default, randomisation of complete
# profiles)
bs1 &lt;- bootstrap_f2(data = dip2[dip2$batch %in% c("b0", "b4"), ],
                    tcol = 5:8, grouping = "batch", rand_mode = "complete",
                    R = 200, new_seed = 421, use_EMA = "no")
pbs1 &lt;- plot(bs1)

# The plot() function returns the 'plot_mztia' object invisibly.
class(bs1)
class(pbs1)

# Use of 'rand_mode = "individual"' (randomisation per time point)
bs2 &lt;- bootstrap_f2(data = dip2[dip2$batch %in% c("b0", "b4"), ],
                    tcol = 5:8, grouping = "batch", rand_mode = "individual",
                    R = 200, new_seed = 421, use_EMA = "no")
plot(bs2)
</code></pre>

<hr>
<h2 id='plot.plot_mztia'>Plot of the mztia simulation</h2><span id='topic+plot.plot_mztia'></span>

<h3>Description</h3>

<p>This is a method for the function <code>plot()</code> for objects of class
&lsquo;<code>plot_mztia</code>&rsquo;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'plot_mztia'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.plot_mztia_+3A_x">x</code></td>
<td>
<p>An object of class &lsquo;<code>plot_mztia</code>&rsquo; returned by the
<code><a href="#topic+plot_mztia">plot_mztia</a>()</code> function.</p>
</td></tr>
<tr><td><code id="plot.plot_mztia_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods or arguments
that can be passed down to the <code><a href="boot.html#topic+plot.boot">plot.boot</a>()</code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The element <code>Graph</code> of the &lsquo;<code>plot_mztia</code>&rsquo; object
that is returned by the function <code><a href="#topic+plot_mztia">plot_mztia</a>()</code> is an object
of class &lsquo;<code>ggplot</code>&rsquo;, generated by the function
<code><a href="ggplot2.html#topic+ggplot">ggplot</a>()</code> from the &lsquo;<code>ggplot2</code>&rsquo; package.
Thus, the corresponding <code>plot</code> method is used for plotting. Arguments
to the <code><a href="ggplot2.html#topic+ggplot">ggplot</a>()</code> function can be passed via the
<code>...</code> parameter.
</p>


<h3>Value</h3>

<p>The &lsquo;<code>plot_mztia</code>&rsquo; object passed to the <code>x</code>
parameter is returned invisibly.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mztia">mztia</a></code>, <code><a href="#topic+plot_mztia">plot_mztia</a></code>,
<code><a href="ggplot2.html#topic+ggplot">ggplot</a>()</code>, <code><a href="utils.html#topic+methods">methods</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Dissolution data of one reference batch and one test batch of n = 6
# tablets each:
str(dip1)

# 'data.frame':	12 obs. of  10 variables:
# $ type  : Factor w/ 2 levels "R","T": 1 1 1 1 1 1 2 2 2 2 ...
# $ tablet: Factor w/ 6 levels "1","2","3","4",..: 1 2 3 4 5 6 1 2 3 4 ...
# $ t.5   : num  42.1 44.2 45.6 48.5 50.5 ...
# $ t.10  : num  59.9 60.2 55.8 60.4 61.8 ...
# $ t.15  : num  65.6 67.2 65.6 66.5 69.1 ...
# $ t.20  : num  71.8 70.8 70.5 73.1 72.8 ...
# $ t.30  : num  77.8 76.1 76.9 78.5 79 ...
# $ t.60  : num  85.7 83.3 83.9 85 86.9 ...
# $ t.90  : num  93.1 88 86.8 88 89.7 ...
# $ t.120 : num  94.2 89.6 90.1 93.4 90.8 ...

# Assessment of data by aid of the mztia() function
res1 &lt;- mztia(data = dip1, shape = "wide", tcol = 3:10, grouping = "type",
              reference = "R", cap = FALSE)

# The 'mztia' object can be passed on to the plot_mztia() function. This
# function does not produce any output but returns a 'plot_mztia' object.
gg1 &lt;- plot_mztia(res1)
gg2 &lt;- plot(gg1)

# The plot() function returns the 'plot_mztia' object invisibly.
class(gg1)
class(gg2)
</code></pre>

<hr>
<h2 id='print.bootstrap_f2'>Print a summary of the bootstrap f2 simulation</h2><span id='topic+print.bootstrap_f2'></span>

<h3>Description</h3>

<p>This is a method for the function <code>print()</code> for objects of class
&lsquo;<code>bootstrap_f2</code>&rsquo;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bootstrap_f2'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.bootstrap_f2_+3A_x">x</code></td>
<td>
<p>An object of class &lsquo;<code>bootstrap_f2</code>&rsquo; returned by the
<code><a href="#topic+bootstrap_f2">bootstrap_f2</a>()</code> function.</p>
</td></tr>
<tr><td><code id="print.bootstrap_f2_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods or arguments
that can be passed down to the <code><a href="boot.html#topic+print.boot">print.boot</a>()</code> and
<code><a href="boot.html#topic+print.bootci">print.bootci</a>()</code> functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The elements <code>Boot</code> and <code>CI</code> of the
&lsquo;<code>bootstrap_f2</code>&rsquo; object that is returned by the function
<code><a href="#topic+bootstrap_f2">bootstrap_f2</a>()</code> are objects of type &lsquo;<code>boot</code>&rsquo; and
&lsquo;<code>bootci</code>&rsquo;, respectively, generated by the functions
<code><a href="boot.html#topic+boot">boot</a>()</code> and <code><a href="boot.html#topic+boot.ci">boot.ci</a>()</code>, respectively,
from the &lsquo;<code>boot</code>&rsquo; package. Thus, the corresponding <code>print</code>
methods are used. Arguments to the <code><a href="boot.html#topic+print.boot">print.boot</a>()</code> and
<code><a href="boot.html#topic+print.bootci">print.bootci</a>()</code> functions can be passed via the
<code>...</code> parameter.
</p>


<h3>Value</h3>

<p>The &lsquo;<code>bootstrap_f2</code>&rsquo; object passed to the <code>x</code>
parameter is returned invisibly.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bootstrap_f2">bootstrap_f2</a></code>, <code><a href="boot.html#topic+boot">boot</a></code>,
<code><a href="boot.html#topic+boot.ci">boot.ci</a></code>, <code><a href="boot.html#topic+print.boot">print.boot</a></code>,
<code><a href="boot.html#topic+print.bootci">print.bootci</a></code>, <code><a href="utils.html#topic+methods">methods</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Dissolution data of one reference batch and five test batches of n = 12
# tablets each:
str(dip2)

# 'data.frame':	72 obs. of  8 variables:
# $ type  : Factor w/ 2 levels "Reference","Test": 1 1 1 1 1 1 1 1 1 1 ...
# $ tablet: Factor w/ 12 levels "1","2","3","4",..: 1 2 3 4 5 6 7 8 9 10 ...
# $ batch : Factor w/ 6 levels "b0","b1","b2",..: 1 1 1 1 1 1 1 1 1 1 ...
# $ t.0   : int  0 0 0 0 0 0 0 0 0 0 ...
# $ t.30  : num  36.1 33 35.7 32.1 36.1 34.1 32.4 39.6 34.5 38 ...
# $ t.60  : num  58.6 59.5 62.3 62.3 53.6 63.2 61.3 61.8 58 59.2 ...
# $ t.90  : num  80 80.8 83 81.3 72.6 83 80 80.4 76.9 79.3 ...
# $ t.180 : num  93.3 95.7 97.1 92.8 88.8 97.4 96.8 98.6 93.3 94 ...

# Bootstrap assessment of data (two groups) by aid of bootstrap_f2() function
# by using 'rand_mode = "complete"' (the default, randomisation of complete
# profiles)
bs1 &lt;- bootstrap_f2(data = dip2[dip2$batch %in% c("b0", "b4"), ],
                    tcol = 5:8, grouping = "batch", rand_mode = "complete",
                    R = 200, new_seed = 421, use_EMA = "no")

# Print of a summary of the assessment
print(bs1)

# STRATIFIED BOOTSTRAP
#
#
# Call:
#   boot(data = data, statistic = get_f2, R = R, strata = data[, grouping],
#        grouping = grouping, tcol = tcol[ok])
#
#
# Bootstrap Statistics :
#   original      bias    std. error
# t1* 50.07187 -0.02553234   0.9488015
#
#
# BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
# Based on 200 bootstrap replicates
#
# CALL :
#   boot.ci(boot.out = t_boot, conf = confid, type = "all", L = jack$loo.values)
#
# Intervals :
#   Level      Normal              Basic
# 90%   (48.54, 51.66 )   (48.46, 51.71 )
#
# Level     Percentile            BCa
# 90%   (48.43, 51.68 )   (48.69, 51.99 )
# Calculations and Intervals on Original Scale
# Some BCa intervals may be unstable
#
#
# Shah's lower 90% BCa confidence interval:
#  48.64613

# Use of 'rand_mode = "individual"' (randomisation per time point)
bs2 &lt;- bootstrap_f2(data = dip2[dip2$batch %in% c("b0", "b4"), ],
                    tcol = 5:8, grouping = "batch", rand_mode = "individual",
                    R = 200, new_seed = 421, use_EMA = "no")

# Print of a summary of the assessment
print(bs2)

# PARAMETRIC BOOTSTRAP
#
#
# Call:
#   boot(data = data, statistic = get_f2, R = R, sim = "parametric",
#        ran.gen = rand_indiv_points, mle = mle, grouping = grouping,
#        tcol = tcol[ok], ins = seq_along(b1))
#
#
# Bootstrap Statistics :
#   original     bias    std. error
# t1* 50.07187 -0.1215656   0.9535517
#
#
# BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
# Based on 200 bootstrap replicates
#
# CALL :
#   boot.ci(boot.out = t_boot, conf = confid, type = "all", L = jack$loo.values)
#
# Intervals :
#   Level      Normal              Basic
# 90%   (48.62, 51.76 )   (48.44, 51.64 )
#
# Level     Percentile            BCa
# 90%   (48.50, 51.70 )   (48.88, 52.02 )
# Calculations and Intervals on Original Scale
# Some BCa intervals may be unstable
#
#
# Shah's lower 90% BCa confidence interval:
#  48.82488
</code></pre>

<hr>
<h2 id='print.mimcr'>Print a summary of MIMCR estimation</h2><span id='topic+print.mimcr'></span>

<h3>Description</h3>

<p>This is a method for the function <code>print()</code> for objects of class
&lsquo;<code>mimcr</code>&rsquo;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mimcr'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.mimcr_+3A_x">x</code></td>
<td>
<p>An object of class &lsquo;<code>mimcr</code>&rsquo; returned by the
<code><a href="#topic+mimcr">mimcr</a>()</code> function.</p>
</td></tr>
<tr><td><code id="print.mimcr_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods or arguments
that can be passed down to the <code><a href="base.html#topic+formatC">formatC</a>()</code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The most relevant information in an &lsquo;<code>mimcr</code>&rsquo; object
is printed.
</p>


<h3>Value</h3>

<p>The &lsquo;<code>mimcr</code>&rsquo; object passed to the <code>x</code>
parameter is returned invisibly.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mimcr">mimcr</a></code>, <code><a href="base.html#topic+formatC">formatC</a></code>,
<code><a href="utils.html#topic+methods">methods</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Dissolution data of one reference batch and one test batch of n = 6
# tablets each:
str(dip1)

# 'data.frame':	12 obs. of  10 variables:
# $ type  : Factor w/ 2 levels "R","T": 1 1 1 1 1 1 2 2 2 2 ...
# $ tablet: Factor w/ 6 levels "1","2","3","4",..: 1 2 3 4 5 6 1 2 3 4 ...
# $ t.5   : num  42.1 44.2 45.6 48.5 50.5 ...
# $ t.10  : num  59.9 60.2 55.8 60.4 61.8 ...
# $ t.15  : num  65.6 67.2 65.6 66.5 69.1 ...
# $ t.20  : num  71.8 70.8 70.5 73.1 72.8 ...
# $ t.30  : num  77.8 76.1 76.9 78.5 79 ...
# $ t.60  : num  85.7 83.3 83.9 85 86.9 ...
# $ t.90  : num  93.1 88 86.8 88 89.7 ...
# $ t.120 : num  94.2 89.6 90.1 93.4 90.8 ...

# Assessment of data by aid of the mimcr() function
res1 &lt;- mimcr(data = dip1, tcol = 3:10, grouping = "type")

# Print of a summary of the assessment
print(res1)

# Results of Model-Independent Multivariate Confidence Region (MIMCR)
# approach to assess equivalence of highly variable in-vitro
# dissolution profiles of two drug product formulations
#
# Did the Newton-Raphson search converge? Yes
#
# Parameters (general):
#   Significance level:                 0.05
# Degrees of freedom (1):               7
# Degrees of freedom (2):               4
# Mahalanobis distance (MD):            25.72
# (F) scaling factor K:                 0.1714
# (MD) scaling factor k:                3
# Hotelling's T2:                       1984
#
# Parameters specific for Tsong (1996) approach:
# Maximum tolerable average difference: 10
# Similarity limit:                     11.33
# Observed upper limit:                 31.68
#
# Parameters specific for Hoffelder (2016) approach:
# Noncentrality parameter:              385
# Critial F (Hoffelder):                23.16
# Probability p (Hoffelder):            0.7402
#
# Conclusions:
#       Tsong (1996):  Dissimilar
#   Hoffelder (2016):  Dissimilar

# Taking only the 15 and 90 minutes testing points into account produces a
# warning because profiles should comprise a minimum of three testing points.
res2 &lt;- mimcr(data = dip1, tcol = c(5, 9), grouping = "type", mtad = 15,
              signif = 0.1)
print(res2)

# Warning:
#   In mimcr(data = dip1, tcol = c(5, 9), grouping = "type", mtad = 15,  :
# The profiles should comprise a minimum of 3 time points. The actual profiles
# comprise 2 points only.

# Results of Model-Independent Multivariate Confidence Region (MIMCR)
# approach to assess equivalence of highly variable in-vitro
# dissolution profiles of two drug product formulations
#
# Did the Newton-Raphson search converge? Yes
#
# Parameters (general):
#   Significance level:                 0.1
# Degrees of freedom (1):               2
# Degrees of freedom (2):               9
# Mahalanobis distance (MD):            10.44
# (F) scaling factor K:                 1.35
# (MD) scaling factor k:                3
# Hotelling's T2:                       327
#
# Parameters specific for Tsong (1996) approach:
# Maximum tolerable average difference: 15
# Similarity limit:                     9.631
# Observed upper limit:                 11.93
#
# Parameters specific for Hoffelder (2016) approach:
# Noncentrality parameter:              278.3
# Critial F (Hoffelder):                83.57
# Probability p (Hoffelder):            0.4823
#
# Conclusions:
#       Tsong (1996):  Dissimilar
#   Hoffelder (2016):  Dissimilar

# Dissolution data  of one reference batch and one test batch of n = 12
# capsules each:
str(dip3)

# 'data.frame':	24 obs. of  6 variables:
# $ cap  : Factor w/ 12 levels "1","2","3","4",..: 1 2 3 4 5 6 7 8 9 10 ...
# $ batch: Factor w/ 2 levels "blue","white": 2 2 2 2 2 2 2 2 2 2 ...
# $ type : Factor w/ 2 levels "ref","test": 1 1 1 1 1 1 1 1 1 1 ...
# $ x.15 : num  49 15 56 57 6 62 23 11 9 42 ...
# $ x.20 : num  86 59 84 87 58 90 71 64 61 81 ...
# $ x.25 : num  98 96 96 99 90 97 97 92 88 96 ...

# A successful comparison:
res3 &lt;- mimcr(data = dip3, tcol = 4:6, grouping = "batch")
print(res3)

# Results of Model-Independent Multivariate Confidence Region (MIMCR)
# approach to assess equivalence of highly variable in-vitro
# dissolution profiles of two drug product formulations
#
# Did the Newton-Raphson search converge? Yes
#
# Parameters (general):
#   Significance level:                 0.05
# Degrees of freedom (1):               3
# Degrees of freedom (2):               20
# Mahalanobis distance (MD):            0.2384
# (F) scaling factor K:                 1.818
# (MD) scaling factor k:                6
# Hotelling's T2:                       0.341
#
# Parameters specific for Tsong (1996) approach:
# Maximum tolerable average difference: 10
# Similarity limit:                     2.248
# Observed upper limit:                 1.544
#
# Parameters specific for Hoffelder (2016) approach:
# Noncentrality parameter:              30.32
# Critial F (Hoffelder):                4.899
# Probability p (Hoffelder):            2.891e-08
#
# Conclusions:
#       Tsong (1996):  Similar
#   Hoffelder (2016):  Similar
</code></pre>

<hr>
<h2 id='print.mztia'>Print a summary of MZTIA estimation</h2><span id='topic+print.mztia'></span>

<h3>Description</h3>

<p>This is a method for the function <code>print()</code> for objects of class
&lsquo;<code>mztia</code>&rsquo;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mztia'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.mztia_+3A_x">x</code></td>
<td>
<p>An object of class &lsquo;<code>mztia</code>&rsquo; returned by the
<code><a href="#topic+mztia">mztia</a>()</code> function.</p>
</td></tr>
<tr><td><code id="print.mztia_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods or arguments
that can be passed down to the <code><a href="base.html#topic+print.data.frame">print.data.frame</a>()</code>
function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The &ldquo;limits&rdquo; subset (see column &ldquo;frame&rdquo;) of the data
frame that is contained in the &ldquo;Data&rdquo; element of the
&lsquo;<code>mztia</code>&rsquo; object is printed.
</p>


<h3>Value</h3>

<p>The &lsquo;<code>mztia</code>&rsquo; object passed to the <code>x</code>
parameter is returned invisibly.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mztia">mztia</a></code>, <code><a href="base.html#topic+print.data.frame">print.data.frame</a></code>,
<code><a href="utils.html#topic+methods">methods</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Dissolution data of one reference batch and one test batch of n = 6
# tablets each:
str(dip1)

# 'data.frame':	12 obs. of  10 variables:
# $ type  : Factor w/ 2 levels "R","T": 1 1 1 1 1 1 2 2 2 2 ...
# $ tablet: Factor w/ 6 levels "1","2","3","4",..: 1 2 3 4 5 6 1 2 3 4 ...
# $ t.5   : num  42.1 44.2 45.6 48.5 50.5 ...
# $ t.10  : num  59.9 60.2 55.8 60.4 61.8 ...
# $ t.15  : num  65.6 67.2 65.6 66.5 69.1 ...
# $ t.20  : num  71.8 70.8 70.5 73.1 72.8 ...
# $ t.30  : num  77.8 76.1 76.9 78.5 79 ...
# $ t.60  : num  85.7 83.3 83.9 85 86.9 ...
# $ t.90  : num  93.1 88 86.8 88 89.7 ...
# $ t.120 : num  94.2 89.6 90.1 93.4 90.8 ...

# Assessment of data (in wide format) by aid of the mztia() function
res1 &lt;- mztia(data = dip1, shape = "wide", tcol = 3:10, grouping = "type",
              reference = "R", cap = FALSE)

# Print of a summary of the assessment
print(res1)

# Results of Martinez &amp; Zhao Tolerance Interval (TI) Approach
# (TI limits calculated at each time point of the dissolution profiles of a set
# of reference batches)
#
# Time     Mean      LTL       UTL   S1.LTL    S1.UTL   S2.LTL    S2.UTL
# 1    5 46.77167 27.22641  66.31693 22.22641  71.31693 12.22641  81.31693
# 2   10 60.13333 46.15483  74.11184 41.15483  79.11184 31.15483  89.11184
# 3   15 67.27500 56.90417  77.64583 51.90417  82.64583 41.90417  92.64583
# 4   20 71.98667 65.44354  78.52979 60.44354  83.52979 50.44354  93.52979
# 5   30 78.07000 69.54259  86.59741 64.54259  91.59741 54.54259 101.59741
# 6   60 84.81667 77.20275  92.43058 72.20275  97.43058 62.20275 107.43058
# 7   90 89.09333 76.24588 101.94079 71.24588 106.94079 61.24588 116.94079
# 8  120 91.43833 80.29321 102.58346 75.29321 107.58346 65.29321 117.58346
#
# Abbreviations:
#   TL: Tolerance Interval Limit (TL); LTL: lower TL; UTL: upper TL;
#   S1: level 1 boundary (LTL - 5) or (UTL + 5); S2: level 2 boundary
#   (LTL - 15) or (UTL + 15).

# Fluid weights of 100 drink cans were measured in ounces:
str(dip5)

# 'data.frame':	100 obs. of  3 variables:
# $ type  : Factor w/ 1 level "reference": 1 1 1 1 1 1 1 1 1 1 ...
# $ batch : Factor w/ 100 levels "b1","b10","b100",..: 1 13 24 35 46 57 68 ...
# $ weight: num  12.1 12 12 12 12 ...

# Assessment of data (in long format) by aid of the mztia() function
res2 &lt;- mztia(data = dip5, shape = "long", tcol = 3, grouping = "type",
              reference = "reference", response = "weight", cap = FALSE,
              QS = c(5, 15) / 100)

# Print of a summary of the assessment
print(res2)

# Results of Martinez &amp; Zhao Tolerance Interval (TI) Approach
# (TI limits calculated at each time point of the dissolution profiles of a set
# of reference batches)
#
# Time    Mean      LTL      UTL   S1.LTL   S1.UTL   S2.LTL   S2.UTL
# 1    1 12.0093 11.87152 12.14708 11.82152 12.19708 11.72152 12.29708
#
# Abbreviations:
#   TL: Tolerance Interval Limit (TL); LTL: lower TL; UTL: upper TL;
#   S1: level 1 boundary (LTL - 0.05) or (UTL + 0.05); S2: level 2 boundary
#   (LTL - 0.15) or (UTL + 0.15).
</code></pre>

<hr>
<h2 id='print.plot_mztia'>Print a plot of MZTIA estimation</h2><span id='topic+print.plot_mztia'></span>

<h3>Description</h3>

<p>This is a method for the function <code>print()</code> for objects of class
&lsquo;<code>plot_mztia</code>&rsquo;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'plot_mztia'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.plot_mztia_+3A_x">x</code></td>
<td>
<p>An object of class &lsquo;<code>plot_mztia</code>&rsquo; returned by the
<code><a href="#topic+plot_mztia">plot_mztia</a>()</code> function.</p>
</td></tr>
<tr><td><code id="print.plot_mztia_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods or arguments
that can be passed down to the <code><a href="boot.html#topic+plot.boot">plot.boot</a>()</code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The element <code>Graph</code> of the &lsquo;<code>plot_mztia</code>&rsquo; object
that is returned by the function <code><a href="#topic+plot_mztia">plot_mztia</a>()</code> is an object
of class &lsquo;<code>ggplot</code>&rsquo;, generated by the function
<code><a href="ggplot2.html#topic+ggplot">ggplot</a>()</code> from the &lsquo;<code>ggplot2</code>&rsquo; package.
Thus, the corresponding <code>plot</code> method is used for plotting. Arguments
to the <code><a href="ggplot2.html#topic+ggplot">ggplot</a>()</code> function can be passed via the
<code>...</code> parameter.
</p>


<h3>Value</h3>

<p>The &lsquo;<code>plot_mztia</code>&rsquo; object passed to the <code>x</code>
parameter is returned invisibly.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mztia">mztia</a></code>, <code><a href="#topic+plot_mztia">plot_mztia</a></code>,
<code><a href="ggplot2.html#topic+ggplot">ggplot</a>()</code>, <code><a href="utils.html#topic+methods">methods</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Dissolution data of one reference batch and one test batch of n = 6
# tablets each:
str(dip1)

# 'data.frame':	12 obs. of  10 variables:
# $ type  : Factor w/ 2 levels "R","T": 1 1 1 1 1 1 2 2 2 2 ...
# $ tablet: Factor w/ 6 levels "1","2","3","4",..: 1 2 3 4 5 6 1 2 3 4 ...
# $ t.5   : num  42.1 44.2 45.6 48.5 50.5 ...
# $ t.10  : num  59.9 60.2 55.8 60.4 61.8 ...
# $ t.15  : num  65.6 67.2 65.6 66.5 69.1 ...
# $ t.20  : num  71.8 70.8 70.5 73.1 72.8 ...
# $ t.30  : num  77.8 76.1 76.9 78.5 79 ...
# $ t.60  : num  85.7 83.3 83.9 85 86.9 ...
# $ t.90  : num  93.1 88 86.8 88 89.7 ...
# $ t.120 : num  94.2 89.6 90.1 93.4 90.8 ...

# Assessment of data by aid of the mztia() function
res1 &lt;- mztia(data = dip1, shape = "wide", tcol = 3:10, grouping = "type",
              reference = "R", cap = FALSE)

# The 'mztia' object can be passed on to the plot_mztia() function. This
# function does not produce any output but returns a 'plot_mztia' object.
gg1 &lt;- plot_mztia(res1)
gg2 &lt;- print(gg1)

# The print() function returns the 'plot_mztia' object invisibly.
class(gg1)
class(gg2)
</code></pre>

<hr>
<h2 id='rand_indiv_points'>Randomisation of individual data points</h2><span id='topic+rand_indiv_points'></span>

<h3>Description</h3>

<p>The function <code>rand_indiv_points()</code> samples individual data points of
each profile.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rand_indiv_points(data, mle)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rand_indiv_points_+3A_data">data</code></td>
<td>
<p>A data frame with the dissolution profile data in wide format.</p>
</td></tr>
<tr><td><code id="rand_indiv_points_+3A_mle">mle</code></td>
<td>
<p>A list of further arguments required for the generation of a
randomised data frame. The first element of <code>mle</code> is a numeric value
of the number of profiles per batch and the second element is a vector of
indices of the columns containing the profile data.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>rand_indiv_points()</code> samples individual data
points of each profile. The first element of <code>mle</code> specifies the
number of indices per group (of two groups), i.e. the number of profiles
to take into account from each group. The second element of <code>mle</code>
specifies the columns in the data frame that represent the dissolution
profiles, i.e. the columns with the % release data. The data points of
each group and column are randomised.
</p>


<h3>Value</h3>

<p>A data frame representing a randomised version of the data frame
that has been handed over via the <code>data</code> parameter.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bootstrap_f2">bootstrap_f2</a></code>.
</p>

<hr>
<h2 id='summary.bootstrap_f2'>Summary of the bootstrap f2 simulation</h2><span id='topic+summary.bootstrap_f2'></span>

<h3>Description</h3>

<p>This is a method for the function <code>summary()</code> for objects of class
&lsquo;<code>bootstrap_f2</code>&rsquo;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bootstrap_f2'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.bootstrap_f2_+3A_object">object</code></td>
<td>
<p>An object of class &lsquo;<code>bootstrap_f2</code>&rsquo; returned by
the <code><a href="#topic+bootstrap_f2">bootstrap_f2</a>()</code> function.</p>
</td></tr>
<tr><td><code id="summary.bootstrap_f2_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods or arguments
that can be passed down to the <code><a href="boot.html#topic+print.boot">print.boot</a>()</code> and
<code><a href="boot.html#topic+print.bootci">print.bootci</a>()</code> functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The elements <code>Boot</code> and <code>CI</code> of the
&lsquo;<code>bootstrap_f2</code>&rsquo; object that is returned by the function
<code><a href="#topic+bootstrap_f2">bootstrap_f2</a>()</code> are objects of type &lsquo;<code>boot</code>&rsquo; and
&lsquo;<code>bootci</code>&rsquo;, respectively, generated by the functions
<code><a href="boot.html#topic+boot">boot</a>()</code> and <code><a href="boot.html#topic+boot.ci">boot.ci</a>()</code>, respectively,
from the &lsquo;<code>boot</code>&rsquo; package. Thus, the corresponding <code>print</code>
methods are used. Arguments to the <code><a href="boot.html#topic+print.boot">print.boot</a>()</code> and
<code><a href="boot.html#topic+print.bootci">print.bootci</a>()</code> functions can be passed via the
<code>...</code> parameter.
</p>


<h3>Value</h3>

<p>The &lsquo;<code>bootstrap_f2</code>&rsquo; object passed to the <code>object</code>
parameter is returned invisibly.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bootstrap_f2">bootstrap_f2</a></code>, <code><a href="boot.html#topic+boot">boot</a></code>,
<code><a href="boot.html#topic+boot.ci">boot.ci</a></code>, <code><a href="boot.html#topic+print.boot">print.boot</a></code>,
<code><a href="boot.html#topic+print.bootci">print.bootci</a></code>, <code><a href="utils.html#topic+methods">methods</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Dissolution data of one reference batch and five test batches of n = 12
# tablets each:
str(dip2)

# 'data.frame':	72 obs. of  8 variables:
# $ type  : Factor w/ 2 levels "Reference","Test": 1 1 1 1 1 1 1 1 1 1 ...
# $ tablet: Factor w/ 12 levels "1","2","3","4",..: 1 2 3 4 5 6 7 8 9 10 ...
# $ batch : Factor w/ 6 levels "b0","b1","b2",..: 1 1 1 1 1 1 1 1 1 1 ...
# $ t.0   : int  0 0 0 0 0 0 0 0 0 0 ...
# $ t.30  : num  36.1 33 35.7 32.1 36.1 34.1 32.4 39.6 34.5 38 ...
# $ t.60  : num  58.6 59.5 62.3 62.3 53.6 63.2 61.3 61.8 58 59.2 ...
# $ t.90  : num  80 80.8 83 81.3 72.6 83 80 80.4 76.9 79.3 ...
# $ t.180 : num  93.3 95.7 97.1 92.8 88.8 97.4 96.8 98.6 93.3 94 ...

# Bootstrap assessment of data (two groups) by aid of bootstrap_f2() function
# by using 'rand_mode = "complete"' (the default, randomisation of complete
# profiles)
bs1 &lt;- bootstrap_f2(data = dip2[dip2$batch %in% c("b0", "b4"), ],
                    tcol = 5:8, grouping = "batch", rand_mode = "complete",
                    R = 200, new_seed = 421, use_EMA = "no")

# Summary of the assessment
summary(bs1)

# STRATIFIED BOOTSTRAP
#
#
# Call:
#   boot(data = data, statistic = get_f2, R = R, strata = data[, grouping],
#        grouping = grouping, tcol = tcol[ok])
#
#
# Bootstrap Statistics :
#   original      bias    std. error
# t1* 50.07187 -0.02553234   0.9488015
#
#
# BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
# Based on 200 bootstrap replicates
#
# CALL :
#   boot.ci(boot.out = t_boot, conf = confid, type = "all", L = jack$loo.values)
#
# Intervals :
#   Level      Normal              Basic
# 90%   (48.54, 51.66 )   (48.46, 51.71 )
#
# Level     Percentile            BCa
# 90%   (48.43, 51.68 )   (48.69, 51.99 )
# Calculations and Intervals on Original Scale
# Some BCa intervals may be unstable
#
#
# Shah's lower 90% BCa confidence interval:
#  48.64613

# Use of 'rand_mode = "individual"' (randomisation per time point)
bs2 &lt;- bootstrap_f2(data = dip2[dip2$batch %in% c("b0", "b4"), ],
                    tcol = 5:8, grouping = "batch", rand_mode = "individual",
                    R = 200, new_seed = 421, use_EMA = "no")

# Summary of the assessment
summary(bs2)

# PARAMETRIC BOOTSTRAP
#
#
# Call:
#   boot(data = data, statistic = get_f2, R = R, sim = "parametric",
#        ran.gen = rand_indiv_points, mle = mle, grouping = grouping,
#        tcol = tcol[ok], ins = seq_along(b1))
#
#
# Bootstrap Statistics :
#   original     bias    std. error
# t1* 50.07187 -0.1215656   0.9535517
#
#
# BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
# Based on 200 bootstrap replicates
#
# CALL :
#   boot.ci(boot.out = t_boot, conf = confid, type = "all", L = jack$loo.values)
#
# Intervals :
#   Level      Normal              Basic
# 90%   (48.62, 51.76 )   (48.44, 51.64 )
#
# Level     Percentile            BCa
# 90%   (48.50, 51.70 )   (48.88, 52.02 )
# Calculations and Intervals on Original Scale
# Some BCa intervals may be unstable
#
#
# Shah's lower 90% BCa confidence interval:
#  48.82488
</code></pre>

<hr>
<h2 id='summary.mimcr'>Summary of MIMCR estimation</h2><span id='topic+summary.mimcr'></span>

<h3>Description</h3>

<p>This is a method for the function <code>summary()</code> for objects of class
&lsquo;<code>mimcr</code>&rsquo;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mimcr'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.mimcr_+3A_object">object</code></td>
<td>
<p>An object of class &lsquo;<code>mimcr</code>&rsquo; returned by the
<code><a href="#topic+mimcr">mimcr</a>()</code> function.</p>
</td></tr>
<tr><td><code id="summary.mimcr_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods or arguments
that can be passed down to the <code><a href="base.html#topic+formatC">formatC</a>()</code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The most relevant information in an &lsquo;<code>mimcr</code>&rsquo; object
is printed.
</p>


<h3>Value</h3>

<p>The &lsquo;<code>mimcr</code>&rsquo; object passed to the <code>object</code>
parameter is returned invisibly.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mimcr">mimcr</a></code>, <code><a href="base.html#topic+formatC">formatC</a></code>,
<code><a href="utils.html#topic+methods">methods</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Dissolution data of one reference batch and one test batch of n = 6
# tablets each:
str(dip1)

# 'data.frame':	12 obs. of  10 variables:
# $ type  : Factor w/ 2 levels "R","T": 1 1 1 1 1 1 2 2 2 2 ...
# $ tablet: Factor w/ 6 levels "1","2","3","4",..: 1 2 3 4 5 6 1 2 3 4 ...
# $ t.5   : num  42.1 44.2 45.6 48.5 50.5 ...
# $ t.10  : num  59.9 60.2 55.8 60.4 61.8 ...
# $ t.15  : num  65.6 67.2 65.6 66.5 69.1 ...
# $ t.20  : num  71.8 70.8 70.5 73.1 72.8 ...
# $ t.30  : num  77.8 76.1 76.9 78.5 79 ...
# $ t.60  : num  85.7 83.3 83.9 85 86.9 ...
# $ t.90  : num  93.1 88 86.8 88 89.7 ...
# $ t.120 : num  94.2 89.6 90.1 93.4 90.8 ...

# Assessment of data by aid of the mimcr() function
res1 &lt;- mimcr(data = dip1, tcol = 3:10, grouping = "type")

# Summary of the assessment
summary(res1)

# Results of Model-Independent Multivariate Confidence Region (MIMCR)
# approach to assess equivalence of highly variable in-vitro
# dissolution profiles of two drug product formulations
#
# Did the Newton-Raphson search converge? Yes
#
# Parameters (general):
#   Significance level:                 0.05
# Degrees of freedom (1):               7
# Degrees of freedom (2):               4
# Mahalanobis distance (MD):            25.72
# (F) scaling factor K:                 0.1714
# (MD) scaling factor k:                3
# Hotelling's T2:                       1984
#
# Parameters specific for Tsong (1996) approach:
# Maximum tolerable average difference: 10
# Similarity limit:                     11.33
# Observed upper limit:                 31.68
#
# Parameters specific for Hoffelder (2016) approach:
# Noncentrality parameter:              385
# Critial F (Hoffelder):                23.16
# Probability p (Hoffelder):            0.7402
#
# Conclusions:
#       Tsong (1996):  Dissimilar
#   Hoffelder (2016):  Dissimilar

# Taking only the 15 and 90 minutes testing points into account produces a
# warning because profiles should comprise a minimum of three testing points.
res2 &lt;- mimcr(data = dip1, tcol = c(5, 9), grouping = "type", mtad = 15,
              signif = 0.1)
summary(res2)

# Warning:
#   In mimcr(data = dip1, tcol = c(5, 9), grouping = "type", mtad = 15,  :
# The profiles should comprise a minimum of 3 time points. The actual profiles
# comprise 2 points only.

# Results of Model-Independent Multivariate Confidence Region (MIMCR)
# approach to assess equivalence of highly variable in-vitro
# dissolution profiles of two drug product formulations
#
# Did the Newton-Raphson search converge? Yes
#
# Parameters (general):
#   Significance level:                 0.1
# Degrees of freedom (1):               2
# Degrees of freedom (2):               9
# Mahalanobis distance (MD):            10.44
# (F) scaling factor K:                 1.35
# (MD) scaling factor k:                3
# Hotelling's T2:                       327
#
# Parameters specific for Tsong (1996) approach:
# Maximum tolerable average difference: 15
# Similarity limit:                     9.631
# Observed upper limit:                 11.93
#
# Parameters specific for Hoffelder (2016) approach:
# Noncentrality parameter:              278.3
# Critial F (Hoffelder):                83.57
# Probability p (Hoffelder):            0.4823
#
# Conclusions:
#       Tsong (1996):  Dissimilar
#   Hoffelder (2016):  Dissimilar

# Dissolution data  of one reference batch and one test batch of n = 12
# capsules each:
str(dip3)

# 'data.frame':	24 obs. of  6 variables:
# $ cap  : Factor w/ 12 levels "1","2","3","4",..: 1 2 3 4 5 6 7 8 9 10 ...
# $ batch: Factor w/ 2 levels "blue","white": 2 2 2 2 2 2 2 2 2 2 ...
# $ type : Factor w/ 2 levels "ref","test": 1 1 1 1 1 1 1 1 1 1 ...
# $ x.15 : num  49 15 56 57 6 62 23 11 9 42 ...
# $ x.20 : num  86 59 84 87 58 90 71 64 61 81 ...
# $ x.25 : num  98 96 96 99 90 97 97 92 88 96 ...

# A successful comparison:
res3 &lt;- mimcr(data = dip3, tcol = 4:6, grouping = "batch")
summary(res3)

# Results of Model-Independent Multivariate Confidence Region (MIMCR)
# approach to assess equivalence of highly variable in-vitro
# dissolution profiles of two drug product formulations
#
# Did the Newton-Raphson search converge? Yes
#
# Parameters (general):
#   Significance level:                 0.05
# Degrees of freedom (1):               3
# Degrees of freedom (2):               20
# Mahalanobis distance (MD):            0.2384
# (F) scaling factor K:                 1.818
# (MD) scaling factor k:                6
# Hotelling's T2:                       0.341
#
# Parameters specific for Tsong (1996) approach:
# Maximum tolerable average difference: 10
# Similarity limit:                     2.248
# Observed upper limit:                 1.544
#
# Parameters specific for Hoffelder (2016) approach:
# Noncentrality parameter:              30.32
# Critial F (Hoffelder):                4.899
# Probability p (Hoffelder):            2.891e-08
#
# Conclusions:
#       Tsong (1996):  Similar
#   Hoffelder (2016):  Similar
</code></pre>

<hr>
<h2 id='summary.mztia'>Summary of MZTIA estimation</h2><span id='topic+summary.mztia'></span>

<h3>Description</h3>

<p>This is a method for the function <code>summary()</code> for objects of class
&lsquo;<code>mztia</code>&rsquo;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mztia'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.mztia_+3A_object">object</code></td>
<td>
<p>An object of class &lsquo;<code>mztia</code>&rsquo; returned by the
<code><a href="#topic+mztia">mztia</a>()</code> function.</p>
</td></tr>
<tr><td><code id="summary.mztia_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods or arguments
that can be passed down to the <code><a href="base.html#topic+print.data.frame">print.data.frame</a>()</code>
function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The &ldquo;limits&rdquo; subset (see column &ldquo;frame&rdquo;) of the data
frame that is contained in the &ldquo;Data&rdquo; element of the
&lsquo;<code>mztia</code>&rsquo; object is printed.
</p>


<h3>Value</h3>

<p>The &lsquo;<code>mztia</code>&rsquo; object passed to the <code>object</code>
parameter is returned invisibly.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mztia">mztia</a></code>, <code><a href="base.html#topic+print.data.frame">print.data.frame</a></code>,
<code><a href="utils.html#topic+methods">methods</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Dissolution data of one reference batch and one test batch of n = 6
# tablets each:
str(dip1)

# 'data.frame':	12 obs. of  10 variables:
# $ type  : Factor w/ 2 levels "R","T": 1 1 1 1 1 1 2 2 2 2 ...
# $ tablet: Factor w/ 6 levels "1","2","3","4",..: 1 2 3 4 5 6 1 2 3 4 ...
# $ t.5   : num  42.1 44.2 45.6 48.5 50.5 ...
# $ t.10  : num  59.9 60.2 55.8 60.4 61.8 ...
# $ t.15  : num  65.6 67.2 65.6 66.5 69.1 ...
# $ t.20  : num  71.8 70.8 70.5 73.1 72.8 ...
# $ t.30  : num  77.8 76.1 76.9 78.5 79 ...
# $ t.60  : num  85.7 83.3 83.9 85 86.9 ...
# $ t.90  : num  93.1 88 86.8 88 89.7 ...
# $ t.120 : num  94.2 89.6 90.1 93.4 90.8 ...

# Assessment of data (in wide format) by aid of the mztia() function
res1 &lt;- mztia(data = dip1, shape = "wide", tcol = 3:10, grouping = "type",
              reference = "R", cap = FALSE)

# Summary of the assessment
summary(res1)

# Results of Martinez &amp; Zhao Tolerance Interval (TI) Approach
# (TI limits calculated at each time point of the dissolution profiles of a set
# of reference batches)
#
# Time     Mean      LTL       UTL   S1.LTL    S1.UTL   S2.LTL    S2.UTL
# 1    5 46.77167 27.22641  66.31693 22.22641  71.31693 12.22641  81.31693
# 2   10 60.13333 46.15483  74.11184 41.15483  79.11184 31.15483  89.11184
# 3   15 67.27500 56.90417  77.64583 51.90417  82.64583 41.90417  92.64583
# 4   20 71.98667 65.44354  78.52979 60.44354  83.52979 50.44354  93.52979
# 5   30 78.07000 69.54259  86.59741 64.54259  91.59741 54.54259 101.59741
# 6   60 84.81667 77.20275  92.43058 72.20275  97.43058 62.20275 107.43058
# 7   90 89.09333 76.24588 101.94079 71.24588 106.94079 61.24588 116.94079
# 8  120 91.43833 80.29321 102.58346 75.29321 107.58346 65.29321 117.58346
#
# Abbreviations:
#   TL: Tolerance Interval Limit (TL); LTL: lower TL; UTL: upper TL;
#   S1: level 1 boundary (LTL - 5) or (UTL + 5); S2: level 2 boundary
#   (LTL - 15) or (UTL + 15).

# Fluid weights of 100 drink cans were measured in ounces:
str(dip5)

# 'data.frame':	100 obs. of  3 variables:
# $ type  : Factor w/ 1 level "reference": 1 1 1 1 1 1 1 1 1 1 ...
# $ batch : Factor w/ 100 levels "b1","b10","b100",..: 1 13 24 35 46 57 68 ...
# $ weight: num  12.1 12 12 12 12 ...

# Assessment of data (in long format) by aid of the mztia() function
res2 &lt;- mztia(data = dip5, shape = "long", tcol = 3, grouping = "type",
              reference = "reference", response = "weight", cap = FALSE,
              QS = c(5, 15) / 100)

# Summary of the assessment
summary(res2)

# Results of Martinez &amp; Zhao Tolerance Interval (TI) Approach
# (TI limits calculated at each time point of the dissolution profiles of a set
# of reference batches)
#
# Time    Mean      LTL      UTL   S1.LTL   S1.UTL   S2.LTL   S2.UTL
# 1    1 12.0093 11.87152 12.14708 11.82152 12.19708 11.72152 12.29708
#
# Abbreviations:
#   TL: Tolerance Interval Limit (TL); LTL: lower TL; UTL: upper TL;
#   S1: level 1 boundary (LTL - 0.05) or (UTL + 0.05); S2: level 2 boundary
#   (LTL - 0.15) or (UTL + 0.15).
</code></pre>

<hr>
<h2 id='try_get_model'>Try getting results from expression</h2><span id='topic+try_get_model'></span>

<h3>Description</h3>

<p>The function <code>get_trial_list()</code> tries to execute the expression handed
over and returns a list of the outcome.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>try_get_model(expr)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="try_get_model_+3A_expr">expr</code></td>
<td>
<p>An expression to be executed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function tries to execute the expression handed over. It case
of an error it does not stop execution but in any case returns a list as
specified in chapter <em>Value</em>. If execution of the expression was
successful, the results are stored in element <em>Model</em>. In case of
warnings or errors, the messages are silently redirected to the elements
<em>Warning</em> or <em>Error</em>, respectively.
</p>


<h3>Value</h3>

<p>A list of length three with the following elements is returned
</p>
<table>
<tr><td><code>Model</code></td>
<td>
<p>The object returned by the expression, if applicable,
or otherwise NULL</p>
</td></tr>
<tr><td><code>Warning</code></td>
<td>
<p>A warning message, if applicable, or otherwise NULL</p>
</td></tr>
<tr><td><code>Error</code></td>
<td>
<p>An error message, if applicable, or otherwise NULL</p>
</td></tr>
</table>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
