<!DOCTYPE html><html lang="en"><head><title>Help for package Rarity</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {Rarity}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Rarity-package'>
<p>A package to calculate rarity indices for species and assemblages of species for conservation studies</p></a></li>
<li><a href='#corPlot'>
<p>Correlation plots</p></a></li>
<li><a href='#Irr'>
<p>Index of Relative Rarity</p></a></li>
<li><a href='#Isr'>
<p>Index of Summed Rarity</p></a></li>
<li><a href='#rWeights'>
<p>Calculation of rarity weights at a single or at multiple scales</p></a></li>
<li><a href='#spid.occ'>
<p>Occurrences of spiders of Western France at two different scales.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Calculation of Rarity Indices for Species and Assemblages of
Species</td>
</tr>
<tr>
<td>Version:</td>
<td>1.3-8</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-08-21</td>
</tr>
<tr>
<td>Author:</td>
<td>Boris Leroy</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Boris Leroy &lt;leroy.boris@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Allows calculation of rarity weights for species and indices of rarity for assemblages of species according to different methods (Leroy et al. 2012, Insect. Conserv. Divers. 5:159-168 &lt;<a href="https://doi.org/10.1111%2Fj.1752-4598.2011.00148.x">doi:10.1111/j.1752-4598.2011.00148.x</a>&gt;; Leroy et al. 2013, Divers. Distrib. 19:794-803 &lt;<a href="https://doi.org/10.1111%2Fddi.12040">doi:10.1111/ddi.12040</a>&gt;). </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2.0)]</td>
</tr>
<tr>
<td>Depends:</td>
<td>methods, graphics, stats</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-21 08:41:54 UTC; Farewell22</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-21 09:22:49 UTC</td>
</tr>
</table>
<hr>
<h2 id='Rarity-package'>
A package to calculate rarity indices for species and assemblages of species for conservation studies
</h2><span id='topic+Rarity-package'></span><span id='topic+Rarity'></span>

<h3>Description</h3>

<p>This package allows calculation of rarity weights for species and indices of rarity for assemblages of species according to different methods (Leroy et al. 2012, In Press).
</p>
<p>The methods developped in this package are based on occurrence (presence-absence) data. Species occurrence is transformed in rarity weights according to various methods. On the basis of the calculated rarity weights, the Index of Relative Rarity can be calculated for assemblages of species (see Leroy et al. 2012 and Leroy et al. in press)
</p>


<h3>Details</h3>

<p>This package works with two important functions.
</p>
<p>First, the function <code>rWeights</code> is designed to calculate rarity weights according to different weighting function. This package implements the flexible weighting function integrating the rarity cutoff point (Leroy et al. 2012, in press).
</p>
<p>Second, the function <code>Irr</code> is designed to calculate the Index of Relative Rarity for assemblages of species. The Index of Relative Rarity is the average of rarity weights of species in an assemblage, normalized between 0 and 1  (Leroy et al. 2012, in press).
</p>


<h3>Author(s)</h3>

<p>Boris Leroy
</p>
<p>Maintainer: Boris Leroy &lt;leroy.boris@gmail.com&gt;
</p>


<h3>References</h3>

<p>Leroy B., Petillon J., Gallon R., Canard A., &amp; Ysnel F. (2012) Improving occurrence-based rarity metrics in conservation studies by including multiple rarity cut-off points. <em>Insect Conservation and Diversity</em>, <b>5</b>, 159-168.
</p>
<p>Leroy B., Canard A., &amp; Ysnel F. In Press. Integrating multiple scales in rarity assessments of invertebrate taxa. <em>Diversity and Distributions</em>, <b>19</b>, 794-803.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  # Example dataset: occurrences of spider species at two different scales
  data(spid.occ)
  head(spid.occ)
  
  # Calculation of rarity weights
  rarity.weights &lt;- rWeights(occData = spid.occ, rCutoff = "Gaston")
  
  # Generation of a random assemblage matrix
  assemblages.matrix &lt;- cbind(assemblage.1 = sample(c(0, 1), 50, replace = TRUE),
                              assemblage.2 = sample(c(0, 1), 50, replace = TRUE),
                              assemblage.3 = sample(c(0, 1), 50, replace = TRUE),
                              assemblage.4 = sample(c(0, 1), 50, replace = TRUE),
                              assemblage.5 = sample(c(0, 1), 50, replace = TRUE))
  # Random attribution of species names
  rownames(assemblages.matrix) &lt;- sample(rownames(spid.occ), 50, replace = FALSE)
  head(assemblages.matrix)
  
  # Calculation of rarity indices of assemblages
  Irr(assemblages = assemblages.matrix, W = rarity.weights)
</code></pre>

<hr>
<h2 id='corPlot'>
Correlation plots
</h2><span id='topic+corPlot'></span>

<h3>Description</h3>

<p>Produces a scatter plot with the distribution of points according to the tested variables in the lower left triangle and the correlation values in the upper left triangle.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>corPlot(df, method = "spearman", digits = 2, na.action = "keep", ties.method = "average",
        title = "", xlab = "variable.name", ylab = "variable.name", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="corPlot_+3A_df">df</code></td>
<td>

<p>a matrix or a data.frame. The values of variables (e.g., indices) to be compared are in columns. 
</p>
</td></tr>
<tr><td><code id="corPlot_+3A_method">method</code></td>
<td>

<p><code>pearson</code>, <code>spearman</code> or <code>kendall</code>. This is the method to be used to produce the plot, according to <code><a href="stats.html#topic+cor.test">cor.test</a></code>. See details.
</p>
</td></tr>
<tr><td><code id="corPlot_+3A_digits">digits</code></td>
<td>

<p>Number of digits to round the correlation values on the plot.
</p>
</td></tr>
<tr><td><code id="corPlot_+3A_na.action">na.action</code></td>
<td>

<p>for controlling the treatment of NAs in <code>spearman</code> or <code>kendall</code> plots. If TRUE, missing values in the data are put last; if FALSE, they are put first; if NA, they are removed; if &quot;keep&quot; they are kept with rank NA. See <code><a href="base.html#topic+rank">rank</a></code>.
</p>
</td></tr>
<tr><td><code id="corPlot_+3A_ties.method">ties.method</code></td>
<td>

<p><code>average</code>, <code>first</code>, <code>random</code>, <code>max</code>, or <code>min</code>; a character string specifying how ties are treated in <code>spearman</code> or <code>kendall</code> plots. See <code><a href="base.html#topic+rank">rank</a></code> for details.
</p>
</td></tr>
<tr><td><code id="corPlot_+3A_title">title</code></td>
<td>

<p>Title of the plot.
</p>
</td></tr>
<tr><td><code id="corPlot_+3A_xlab">xlab</code></td>
<td>

<p>a character string for labelling x axes. <code>variable.name</code> (default value) will produce automatic labelling according to column names of <code>df</code>. Otherwise, either a single string can be entered, or a vector of strings of length equal to the number of columns of <code>df</code>.
</p>
</td></tr>
<tr><td><code id="corPlot_+3A_ylab">ylab</code></td>
<td>

<p>a character string for labelling y axes. <code>variable.name</code> (default value) will produce automatic labelling according to column names of <code>df</code>. Otherwise, either a single string can be entered, or a vector of strings of length equal to the number of columns of <code>df</code>.
</p>
</td></tr>
<tr><td><code id="corPlot_+3A_...">...</code></td>
<td>

<p>Further arguments to be passed to the individual plots. See <code><a href="graphics.html#topic+plot">plot</a></code> and <code><a href="graphics.html#topic+par">par</a></code>
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The lower half shows the scatter plots of values or ranks of variables. The upper half shows the corresponding correlation coefficients (significativity: 0 '***' 0.001 '**' 0.01 '*' 0.05 '-' 0.1 ' ' 1). The diagonal shows the considered variables and the number of individuals available for each.
</p>
<p>If the chosen method is <code>pearson</code>, then the actual values of the variables will be plotted. If the chosen method is a rank-based method, <code>spearman</code> or <code>kendall</code>, then the ranks will be plotted.
</p>


<h3>Warning</h3>

<p>A high number of variables will likely result in a slow generation of plots and a poor readability.
Above 10 variables, the readability is greatly reduced.
</p>


<h3>Author(s)</h3>

<p>Boris Leroy leroy.boris@gmail.com
</p>


<h3>See Also</h3>

<p><code><a href="arm.html#topic+corrplot">corrplot</a></code> in package <code>arm</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Comparisons of species occurrences estimated from 2 different scales
data(spid.occ)
corPlot(spid.occ, method = "pearson")

# Another example:
# Correlation between different variables measured on the same individuals
data(iris)
corPlot(iris[, 1:4], method = "pearson")
corPlot(iris[, 1:4], method = "spearman")
</code></pre>

<hr>
<h2 id='Irr'>
Index of Relative Rarity
</h2><span id='topic+Irr'></span><span id='topic+Irr+2Cdata.frame+2Cdata.frame-method'></span><span id='topic+Irr+2Cdata.frame+2Cmatrix-method'></span><span id='topic+Irr+2Cdata.frame+2Cvector-method'></span><span id='topic+Irr+2Cmatrix+2Cdata.frame-method'></span><span id='topic+Irr+2Cmatrix+2Cmatrix-method'></span><span id='topic+Irr+2Cmatrix+2Cvector-method'></span><span id='topic+Irr+2Cvector+2Cdata.frame-method'></span><span id='topic+Irr+2Cvector+2Cmatrix-method'></span><span id='topic+Irr+2Cvector+2Cvector-method'></span>

<h3>Description</h3>

<p>Calculates the Index of Relative Rarity for a single or a set of assemblages of species.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Irr(assemblages, W, abundance = F, Wmin = min(W), Wmax = max(W))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Irr_+3A_assemblages">assemblages</code></td>
<td>

<p><code>vector</code>, <code>matrix</code> or <code>data.frame</code>. Data of the assemblage(s) of species for which the Index will be calculated. If <code>matrix</code> or <code>data.frame</code>, species are in rows and assemblages are in columns (see details).
</p>
</td></tr>
<tr><td><code id="Irr_+3A_w">W</code></td>
<td>

<p><code>vector</code>, <code>matrix</code> or <code>data.frame</code>. Rarity weights of the species. If <code>matrix</code> or <code>data.frame</code>, species are in rows (see details). 
</p>
</td></tr>
<tr><td><code id="Irr_+3A_abundance">abundance</code></td>
<td>

<p>logical. If <code>TRUE</code>, then abundance values in <code>assemblages</code> are taken into account to calculate the Index of Relative Rarity.
</p>
</td></tr>
<tr><td><code id="Irr_+3A_wmin">Wmin</code></td>
<td>

<p>decimal or <code>vector</code>. Minimum weight(s)
</p>
</td></tr>
<tr><td><code id="Irr_+3A_wmax">Wmax</code></td>
<td>

<p>decimal or <code>vector</code>. Maximum weight(s)
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>assemblages</code> can contain a single (vector) or several (matrix or data.frame) assemblages. If <code>assemblages</code> is a vector, values must be named with species names (e.g. with <code>names(assemblages) &lt;- sp.names</code>). If <code>assemblages</code> is a matrix or a data.frame, then rows must be named with species names.
</p>
<p>All the species of <code>assemblages</code> must be contained in <code>W</code>
</p>
<p><code>W</code> can contain a single vector of rarity weights, or a matrix or a data.frame of rarity weights (e.g. to calculate different Indices of Relative Rarity for different scales). If <code>W</code> is a vector, values must be named with species names. If <code>W</code> is a matrix or a data.frame, then species are in rows and each column contains rarity weights. Rows must be named with species names.
</p>
<p>If the input of <code>rWeights</code> is directly entered, then columns <code>Q</code> (occurrence), <code>R</code> (rarity status) and <code>cut.off</code> (rarity cut-off points) will be dropped.
</p>

<ul>
<li><p>Occurrence-based Irr, normalised between 0 and 1:
</p>
<p style="text-align: center;"><code class="reqn">\frac{\frac{\sum w_i}{S} - w_{min}}{w_{max} - w_{min}}</code>
</p>

<p>where <em>wi</em> is the weight of the <em>i</em>th species in the assemblage, <em>S</em> the assemblage species richness, <em>w</em>min and <em>w</em>max the minimum and maximum weights respectively.

</p>
</li>
<li><p>Abundance-based Irr, normalised between 0 and 1:
</p>
<p style="text-align: center;"><code class="reqn">\frac{\frac{\sum a_i w_i}{N} - w_{min}}{w_{max} - w_{min}}</code>
</p>

<p>where <em>ai</em> and <em>wi</em> are respectively the abundance and weight of the <em>i</em>th species in the assemblage, <em>N</em> the total number of individuals in the assemblage, and <em>w</em>min and <em>w</em>max the minimum and maximum weights respectively.
</p>
</li></ul>

<p>Species with <code>NA</code> weights are excluded when indices are computed (they are kept for richness). 
</p>


<h3>Value</h3>

<p>A data.frame containing the Indices of Relative Rarity and the species richness of the assemblage(s).
</p>


<h3>Warning</h3>

<p>Column names of <code>W</code> with names like &quot;Q&quot;, &quot;R&quot;, &quot;cut.off&quot;, &quot;Q1&quot; &quot;Q2&quot; &quot;Q3&quot; and so on, &quot;R1&quot;, &quot;R2&quot; &quot;R3&quot; and so on, &quot;cut.off1&quot;, &quot;cut.off2&quot;, and so on will be ignored.
</p>


<h3>Author(s)</h3>

<p>Boris Leroy leroy.boris@gmail.com
</p>


<h3>References</h3>

<p>Leroy B., Petillon J., Gallon R., Canard A., &amp; Ysnel F. (2012) Improving occurrence-based rarity metrics in conservation studies by including multiple rarity cut-off points. <em>Insect Conservation and Diversity</em>, <b>5</b>, 159-168.
</p>
<p>Leroy B., Canard A., &amp; Ysnel F. 2013. Integrating multiple scales in rarity assessments of invertebrate taxa. <em>Diversity and Distributions</em>, <b>19</b>, 794-803.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rWeights">rWeights</a></code>, <code><a href="#topic+Isr">Isr</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Input rarity weights
data(spid.occ)

# Example of a single scale dataset
regional.occ &lt;- spid.occ$occurMA
names(regional.occ) &lt;- rownames(spid.occ)
head(regional.occ)

# Preparation of rarity weights
rarity.weights &lt;- rWeights(regional.occ)

# Generation of an assemblage matrix
assemblages.matrix &lt;- cbind(assemblage.1 = sample(c(0, 1), 50, replace = TRUE),
                            assemblage.2 = sample(c(0, 1), 50, replace = TRUE),
                            assemblage.3 = sample(c(0, 1), 50, replace = TRUE),
                            assemblage.4 = sample(c(0, 1), 50, replace = TRUE),
                            assemblage.5 = sample(c(0, 1), 50, replace = TRUE))
# Random attribution of names to the sampled species
rownames(assemblages.matrix) &lt;- sample(names(regional.occ), 50, replace = FALSE)
head(assemblages.matrix)

# Calculation of Irr
Irr(assemblages.matrix, rarity.weights)


# Example of a multi scale dataset
rarity.weights &lt;- rWeights(spid.occ, extended = TRUE)
head(rarity.weights)

# Generation of an assemblage matrix
assemblages.matrix &lt;- cbind(assemblage.1 = sample(c(0, 1), 50, replace = TRUE),
                            assemblage.2 = sample(c(0, 1), 50, replace = TRUE),
                            assemblage.3 = sample(c(0, 1), 50, replace = TRUE),
                            assemblage.4 = sample(c(0, 1), 50, replace = TRUE),
                            assemblage.5 = sample(c(0, 1), 50, replace = TRUE))
rownames(assemblages.matrix) &lt;- sample(names(regional.occ), 50, replace = FALSE)
head(assemblages.matrix)

# Calculation of Irr
Irr(assemblages.matrix, rarity.weights)
</code></pre>

<hr>
<h2 id='Isr'>
Index of Summed Rarity
</h2><span id='topic+Isr'></span><span id='topic+Isr+2Cdata.frame+2Cdata.frame-method'></span><span id='topic+Isr+2Cdata.frame+2Cmatrix-method'></span><span id='topic+Isr+2Cdata.frame+2Cvector-method'></span><span id='topic+Isr+2Cmatrix+2Cdata.frame-method'></span><span id='topic+Isr+2Cmatrix+2Cmatrix-method'></span><span id='topic+Isr+2Cmatrix+2Cvector-method'></span><span id='topic+Isr+2Cvector+2Cdata.frame-method'></span><span id='topic+Isr+2Cvector+2Cmatrix-method'></span><span id='topic+Isr+2Cvector+2Cvector-method'></span>

<h3>Description</h3>

<p>Calculates the Index of Relative Rarity for a single or a set of assemblages of species. The index of summed rarity consists in summing the rarity weights of species in the assemblage, with the possibility of normalising between 0 (the assemblage has only minimum-weight species) and 1 (value of the complete pool of species (see details)).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Isr(assemblages, W, abundance = FALSE, Wmin = min(W), normalise = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Isr_+3A_assemblages">assemblages</code></td>
<td>

<p><code>vector</code>, <code>matrix</code> or <code>data.frame</code>. Data of the assemblage(s) of species for which the Index will be calculated. If <code>matrix</code> or <code>data.frame</code>, species are in rows and assemblages are in columns (see details).
</p>
</td></tr>
<tr><td><code id="Isr_+3A_w">W</code></td>
<td>

<p><code>vector</code>, <code>matrix</code> or <code>data.frame</code>. Rarity weights of the species. If <code>matrix</code> or <code>data.frame</code>, species are in rows (see details). 
</p>
</td></tr>
<tr><td><code id="Isr_+3A_abundance">abundance</code></td>
<td>

<p>logical. If <code>TRUE</code>, then abundance values in <code>assemblages</code> are taken into account to calculate the Index of Relative Rarity.
</p>
</td></tr>
<tr><td><code id="Isr_+3A_wmin">Wmin</code></td>
<td>

<p>decimal or <code>vector</code>. Minimum weight(s)
</p>
</td></tr>
<tr><td><code id="Isr_+3A_normalise">normalise</code></td>
<td>

<p>logical. If <code>TRUE</code>, then the Isr will be rescaled between 0 and 1 (see formula in details). Cannot be used if <code>abundance = TRUE</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>assemblages</code> can contain a single (vector) or several (matrix or data.frame) assemblages. If <code>assemblages</code> is a vector, values must be named with species names (e.g. with <code>names(assemblages) &lt;- sp.names</code>). If <code>assemblages</code> is a matrix or a data.frame, then rows must be named with species names.
</p>
<p>All the species of <code>assemblages</code> must be contained in <code>W</code>
</p>
<p><code>W</code> can contain a single vector of rarity weights, or a matrix or a data.frame of rarity weights (e.g. to calculate different Indices of Summed Rarity for different scales). If <code>W</code> is a vector, values must be named with species names. If <code>W</code> is a matrix or a data.frame, then species are in rows and each column contains rarity weights. Rows must be named with species names.
</p>
<p>If the input of <code>rWeights</code> is directly entered, then columns <code>Q</code> (occurrence), <code>R</code> (rarity status) and <code>cut.off</code> (rarity cut-off points) will be dropped.
</p>
<p>Formula implemented in this function:
</p>

<ul>
<li><p>Occurrence-based Isr, not normalised between 0 and 1:
</p>
<p style="text-align: center;"><code class="reqn">\sum w_i</code>
</p>

<p>where <em>wi</em> is the weight of the <em>i</em>th species in the assemblage

</p>
</li>
<li><p>Abundance-based Isr, not normalised between 0 and 1:
</p>
<p style="text-align: center;"><code class="reqn">\sum a_i \times w_i</code>
</p>

<p>where <em>ai</em> and <em>wi</em> are respectively the abundance and weight of the <em>i</em>th species in the assemblage

</p>
</li>
<li><p>Occurrence-based Isr, normalised between 0 and 1:
</p>
<p style="text-align: center;"><code class="reqn">\frac{\sum(w_i - w_{min})}{\sum(W_j - w_{min})}</code>
</p>

<p>where <em>wi</em> is the weight of the <em>i</em>th species in the assemblage, <em>wmin</em> the minimum weight and <em>Wj</em> the weight of the <em>j</em>th species in the total species pool (provided in <code>W</code>).

</p>
</li></ul>

<p>Species with <code>NA</code> weights are excluded when indices are computed (they are kept for richness). 
</p>


<h3>Value</h3>

<p>A data.frame containing the Indices of Relative Rarity and the species richness of the assemblage(s).
</p>


<h3>Warning</h3>

<p>Column names of <code>W</code> with names like &quot;Q&quot;, &quot;R&quot;, &quot;cut.off&quot;, &quot;Q1&quot; &quot;Q2&quot; &quot;Q3&quot; and so on, &quot;R1&quot;, &quot;R2&quot; &quot;R3&quot; and so on, &quot;cut.off1&quot;, &quot;cut.off2&quot;, and so on will be ignored.
</p>


<h3>Author(s)</h3>

<p>Boris Leroy leroy.boris@gmail.com
</p>


<h3>References</h3>

<p>Leroy B., Petillon J., Gallon R., Canard A., &amp; Ysnel F. (2012) Improving occurrence-based rarity metrics in conservation studies by including multiple rarity cut-off points. <em>Insect Conservation and Diversity</em>, <b>5</b>, 159-168.
</p>
<p>Leroy B., Canard A., &amp; Ysnel F. 2013. Integrating multiple scales in rarity assessments of invertebrate taxa. <em>Diversity and Distributions</em>, <b>19</b>, 794-803.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rWeights">rWeights</a></code>, <code><a href="#topic+Irr">Irr</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Input rarity weights
data(spid.occ)

# Example of a single scale dataset
regional.occ &lt;- spid.occ$occurMA
names(regional.occ) &lt;- rownames(spid.occ)
head(regional.occ)

# Preparation of rarity weights
rarity.weights &lt;- rWeights(regional.occ)

# Generation of an assemblage matrix
assemblages.matrix &lt;- cbind(assemblage.1 = sample(c(0, 1), 50, replace = TRUE),
                            assemblage.2 = sample(c(0, 1), 50, replace = TRUE),
                            assemblage.3 = sample(c(0, 1), 50, replace = TRUE),
                            assemblage.4 = sample(c(0, 1), 50, replace = TRUE),
                            assemblage.5 = sample(c(0, 1), 50, replace = TRUE))
# Random attribution of names to the sampled species
rownames(assemblages.matrix) &lt;- sample(names(regional.occ), 50, replace = FALSE)
head(assemblages.matrix)

# Calculation of Isr
Isr(assemblages.matrix, rarity.weights)
Isr(assemblages.matrix, rarity.weights, normalise = TRUE)


# Example of a multi scale dataset
rarity.weights &lt;- rWeights(spid.occ, extended = TRUE)
head(rarity.weights)

# Generation of an assemblage matrix
assemblages.matrix &lt;- cbind(assemblage.1 = sample(c(0, 1), 50, replace = TRUE),
                            assemblage.2 = sample(c(0, 1), 50, replace = TRUE),
                            assemblage.3 = sample(c(0, 1), 50, replace = TRUE),
                            assemblage.4 = sample(c(0, 1), 50, replace = TRUE),
                            assemblage.5 = sample(c(0, 1), 50, replace = TRUE))
rownames(assemblages.matrix) &lt;- sample(names(regional.occ), 50, replace = FALSE)
head(assemblages.matrix)

# Calculation of Isr
Isr(assemblages.matrix, rarity.weights)
Isr(assemblages.matrix, rarity.weights, normalise = TRUE)
</code></pre>

<hr>
<h2 id='rWeights'>
Calculation of rarity weights at a single or at multiple scales
</h2><span id='topic+rWeights'></span><span id='topic+rWeights-method'></span><span id='topic+rWeights+2Cdata.frame-method'></span><span id='topic+rWeights+2Cmatrix-method'></span><span id='topic+rWeights+2Cvector-method'></span>

<h3>Description</h3>

<p>Calculate rarity weights for a single scale or for multiple scales on the basis of the selected weighting function(s).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rWeights(occData, Qmax = max(occData), Qmin = min(occData), 
         wMethods = "W", rCutoff = "Gaston", normalised = T, 
         assemblages, extended = F, rounding = 3)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rWeights_+3A_occdata">occData</code></td>
<td>

<p>vector, matrix or data.frame. Occurrence data for a single scale (vector) or several scales (matrix or data.frame). 
</p>
</td></tr>
<tr><td><code id="rWeights_+3A_qmax">Qmax</code></td>
<td>

<p>integer. Maximum occurrence (see details). By default, the maximum occurrence of the dataset is used (i.e., maximum occurrence among the provided set of species), however it can be changed to another value, e.g. to provide the number of possible sites. 
</p>
</td></tr>
<tr><td><code id="rWeights_+3A_qmin">Qmin</code></td>
<td>

<p>integer. Minimum occurrence (see details). By default, the minimum occurrence of the dataset is used (i.e., minimum occurrence among the provided set of species).
</p>
</td></tr>
<tr><td><code id="rWeights_+3A_wmethods">wMethods</code></td>
<td>

<p><code>W</code>, <code>invQ</code> or <code>oldW</code>. Chosen function to weight species occurrence (see details)
</p>
</td></tr>
<tr><td><code id="rWeights_+3A_rcutoff">rCutoff</code></td>
<td>

<p>a decimal or a vector of values between 0 and 1, or <code>Gaston</code> or <code>Leroy</code>. Indicates the rarity cutoff(s) or the method to use to calculate the rarity cutoff(s). The rarity cut-off is by default calculated as a percentage of the maximum occurrence  (see details)
</p>
</td></tr>
<tr><td><code id="rWeights_+3A_normalised">normalised</code></td>
<td>

<p>TRUE or FALSE. If TRUE, then weights are normalised between 0 and 1.
</p>
</td></tr>
<tr><td><code id="rWeights_+3A_assemblages">assemblages</code></td>
<td>

<p>matrix or data.frame. Set of assemblages of species to calculate the rarity cutoff point(s) with the <code>Leroy</code>  method (optional)
</p>
</td></tr>
<tr><td><code id="rWeights_+3A_extended">extended</code></td>
<td>

<p>TRUE or FALSE. Useful in case of multiple scales only. If TRUE, then weights will be given for every input scale in addition to multiscale weights. If FALSE, then only multiscale weights will be provided. 
</p>
</td></tr>
<tr><td><code id="rWeights_+3A_rounding">rounding</code></td>
<td>

<p>An integer or FALSE. If an integer is provided, then the values of weights will be rounded according to this value. If FALSE, weights will not be rounded.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To calculate single-scale weights, simply provide a vector with species occurrences.
To calculate multiscale rarity weights, provide either a matrix or a data.frame where species are in rows, and each column provides occurrence for a particular scale.
</p>
<p>The minimum and maximum weights can be set manually, or automatically calculated with the default parameters. Defaults parameters : if <code>occData</code> is a vector, <code>Qmin = min(Q)</code> and <code>Qmax = max(Q)</code>. If <code>occData</code> is a matrix or a data.frame, <code>Qmin = apply(occData, 2, min)</code> and <code>Qmax = apply(occData, 2, max)</code>
</p>
<p>Three weighting methods are available (more will become available later):
</p>

<ol>
<li><p><code>W</code>: This is the method described in Leroy et al. (2013). We recommend using this method for both single and multiscale weight calculations.
</p>
<p style="text-align: center;"><code class="reqn">\exp(-(\frac{Q_{i} - Q_{min}}{r_j \times Q_{max} - Q_{min}}\times0.97 + 1.05)^2)</code>
</p>

<p>where <em>Qi</em> is the occurrence of species <em>i</em>, Qmin and Qmax are respectively the minimum and maximum occurrences in the species pool and <em>r</em> is the choosen rarity cut-off point (as a percentage of occurrence).

</p>
</li>
<li><p><code>invQ</code>: This is the inverse of occurrence
</p>
<p style="text-align: center;"><code class="reqn">\frac{1}{Q_i}</code>
</p>

<p>where <em>Qi</em> is the occurrence of the <em>i</em>th species. The inverse of the occurrence should be avoided as a weighting procedure because it cannot be adjusted to the considered species pool, and it does not attribute 0 weights to common species (see discussion in Leroy et al. (2012)).

</p>
</li>
<li><p><code>oldW</code>: This is the original method described in Leroy et al. (2012). As this method was improved in Leroy et al. (2013), we recommend to rather use <code>W</code>. Formula:
</p>
<p style="text-align: center;"><code class="reqn">\exp(-(\frac{Q_i}{Q_{min}} n + 1)^2)</code>
</p>
 
<p>where <em>Qi</em> is the occurrence of species <em>i</em>, Qmin is the minimum occurrence in the species pool, and <em>n</em> is and adjustment coefficient numerically approximated to fit the choosen rarity cut-off point.

</p>
</li></ol>

<p>For methods <code>W</code> and <code>oldW</code>, a rarity cutoff point is required. The rarity cutoff point can either be entered manually (a single value for a single scale, a vector of values for multiple scales), or the methods of <code>Gaston</code> or <code>Leroy</code> can be used (see references):
</p>
<p>- <code>Gaston</code> method: the rarity cutoff point is the first quartile of species occurrences, i.e. rare species are the 25 percent species with the lowest occurrence.
</p>
<p>- <code>Leroy</code> method: the rarity cutoff point is the occurrence at which the average proportion of rare species in local assemblages is 25 percent. This method requires <code>assemblages</code> to calculate the average proportion of rare species in  assemblages.
</p>
<p><code>NA</code> are properly handled by the function.
</p>


<h3>Value</h3>

<p>A data.frame containing the results : species occurrences, rarity statuses, rarity weights and the used rarity cut-offs.
</p>
<p>-  If <code>occData</code> is a vector (single scale weights): A data.frame with 4 columns : <code>Q</code> (species occurrence), <code>R</code> (species rarity status), <code>W</code>, (species rarity weights), <code>cut.off</code> (rarity cut-off used for weight calculation)
</p>
<p>-	If <code>occData</code> is matrix or a data.frame (multiscale rarity weights): A data.frame with <em>n</em> columns <code>Q</code> (species occurrences), <em>n</em> columns <code>R</code> (species rarity statuses), one (if <code>extended = F</code>) or <em>n</em> + 1 (if <code>extended = T</code>) columns <code>W</code> (species rarity weights) where <em>n</em> is the number of scales (number of columns of <code>occData</code>), <em>n</em> columns <code>cut.off</code> (rarity cut-offs used for weight calculation).
</p>
<p>By default, weights are rounded to 3 digits, which should be sufficient in most cases. Another number of digits can also be chosen; or simply changing <code>rounding</code> to <code>FALSE</code> will remove the rounding.
</p>


<h3>Author(s)</h3>

<p>Boris Leroy leroy.boris@gmail.com
</p>


<h3>References</h3>

<p>Leroy B., Petillon J., Gallon R., Canard A., &amp; Ysnel F. (2012) Improving occurrence-based rarity metrics in conservation studies by including multiple rarity cut-off points. <em>Insect Conservation and Diversity</em>, <b>5</b>, 159-168.
</p>
<p>Leroy B., Canard A., &amp; Ysnel F. 2013. Integrating multiple scales in rarity assessments of invertebrate taxa. <em>Diversity and Distributions</em>, <b>19</b>, 794-803.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Irr">Irr</a></code>, <code><a href="#topic+Isr">Isr</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># 1. Single scale rarity weights
data(spid.occ)
head(spid.occ)

regional.occ &lt;- spid.occ$occurMA
names(regional.occ) &lt;- rownames(spid.occ)
head(regional.occ)

# Calculation of rarity weights at a single scale:
rWeights(regional.occ, rCutoff = "Gaston")
rWeights(regional.occ, rCutoff = 0.1)
rWeights(regional.occ, wMethods = "invQ")
rWeights(regional.occ, wMethods = c("W", "invQ"))

# Calculation of rarity weights with the method of Leroy
# Creating a fictive assemblage matrix of 5 assemblages
# Warning: this is to provide an example of how the function works!
# The correct use of this method requires a matrix of actually sampled species.
assemblages.matrix &lt;- cbind(assemblage.1 = sample(c(0, 1), 708, replace = TRUE),
                            assemblage.2 = sample(c(0, 1), 708, replace = TRUE),
                            assemblage.3 = sample(c(0, 1), 708, replace = TRUE),
                            assemblage.4 = sample(c(0, 1), 708, replace = TRUE),
                            assemblage.5 = sample(c(0, 1), 708, replace = TRUE))
rownames(assemblages.matrix) &lt;- names(regional.occ) # Rownames of assemblages.matrix must 
                                                 # correspond to rownames in occurrences
head(assemblages.matrix)
                                          
rWeights(regional.occ, wMethods = "W", rCutoff = "Leroy", assemblages = assemblages.matrix)

# 2. Multiscale rarity weights
data(spid.occ)
head(spid.occ)

rWeights(spid.occ, wMethods = "W", rCutoff = "Gaston")
rWeights(spid.occ, wMethods = "W", rCutoff = "Gaston", extended = TRUE)
rWeights(spid.occ, wMethods = c("W", "invQ"), rCutoff = "Gaston", extended = TRUE)
rWeights(spid.occ, wMethods = c("W", "invQ"), rCutoff = "Leroy", 
         assemblages = assemblages.matrix, extended = TRUE) # Provided that you have 
                                             # created "assemblages.matrix" as above
</code></pre>

<hr>
<h2 id='spid.occ'>
Occurrences of spiders of Western France at two different scales.
</h2><span id='topic+spid.occ'></span>

<h3>Description</h3>

<p><code>spid.occ</code> is a <code>data.frame</code> providing the occurrences of the 708 spider species of Western France at 2 different scales.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(spid.occ)</code></pre>


<h3>Format</h3>

<p>A data frame with 708 rows (species) and 2 columns.
</p>

<dl>
<dt><code>occurMA</code></dt><dd><p>a numeric vector. Occurrence of spider species at the regional scale (Western France).</p>
</dd>
<dt><code>occurWP</code></dt><dd><p>a numeric vector. Occurrence of spider species at the western Palearctic scale.</p>
</dd>
</dl>



<h3>Details</h3>

<p>The regional occurrence is obtained from our spider database of Western France. It was defined as the number of grid cells (16 x 16 cells grid, approximately 683 km^2 per cell) in which the species were found. The western Palearctic occurrence of species was defined as the number of &quot;biogeopolitical&quot; units in which species were found (Canard, 2005; taxonomy and occurrence of species updated in 2011). This estimation comes from the catalogue Islands/groups of islands were separated from continental countries for this estimation. See Leroy et al. (2013 - refs below) for a detailed description of this dataset. Note that the regional occurrence of species may have very slightly changed since the publication of the article because of small additions or modifications to our regional database.
</p>


<h3>Source</h3>

<p>Leroy B., Canard A. &amp; Ysnel F. <em>2013</em>. Integrating multiple scales in rarity assessments of invertebrate taxa. <em>Diversity and Distributions</em>, <b>19</b>, 794-803.
</p>


<h3>References</h3>

<p>Canard, A. (2005) Catalogue of spider species from Europe and the Mediterranean basin. <em>Revue Arachnologique</em>, <b>15</b>, 1-408.
</p>
<p>Petillon, J., Courtial, C., Canard, A. &amp; Ysnel, F. (2007a) First assessment of spider rarity in Western France. <em>Revista iberica de aracnologia</em>, <b>15</b>, 105-113.
</p>
<p>Ysnel, F., Petillon, J., Gerard, E. &amp; Canard, A. (2008) Assessing the conservation value of the spider fauna across the West Palearctic area. <em>Journal of Arachnology</em>, <b>36</b>, 457-463.
</p>
<p>Leroy B., Canard A., &amp; Ysnel F. 2013. Integrating multiple scales in rarity assessments of invertebrate taxa. <em>Diversity and Distributions</em>, <b>19</b>, 794-803.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(spid.occ)
head(spid.occ)
# Congruency between regional and western Palearctic occurrences
corPlot(spid.occ, method = "pearson", xlab = "Regional occurrence", 
        ylab = "Western Palearctic occurrence") # Shows the moderate congruency between regional and
                                                # biogeographic estimations of occurrence
# Calculation of multi-scale rarity weights      
rarity.weights &lt;- rWeights(spid.occ, extended = TRUE)
head(rarity.weights)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
