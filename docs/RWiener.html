<!DOCTYPE html><html><head><title>Help for package RWiener</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {RWiener}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#deprecated'><p>Wiener likelihood and criterion functions (deprecated)</p></a></li>
<li><a href='#likelihood'><p>Likelihood and criterion functions for wdm</p></a></li>
<li><a href='#miscellaneous'><p>Miscellaneous Wiener Diffusion model functions</p></a></li>
<li><a href='#plot'><p>Wiener plot function</p></a></li>
<li><a href='#RWiener+20internal'><p>Wiener functions internals</p></a></li>
<li><a href='#scorefun'><p>Extract Empirical Estimating Functions</p></a></li>
<li><a href='#tests'><p>Wiener Diffusion model test functions</p></a></li>
<li><a href='#wdm'><p>Wiener diffusion model fit function</p></a></li>
<li><a href='#wienerdist'><p>Wiener process distribution functions</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>1.3-3</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-05-04</td>
</tr>
<tr>
<td>Title:</td>
<td>Wiener Process Distribution Functions</td>
</tr>
<tr>
<td>Author:</td>
<td>Dominik Wabersich [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Dominik Wabersich &lt;dominik.wabersich@gmail.com&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>MASS</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, graphics</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/yeagle/RWiener">https://github.com/yeagle/RWiener</a></td>
</tr>
<tr>
<td>Description:</td>
<td>Provides Wiener process distribution functions,
  namely the Wiener first passage time density, CDF, quantile and random
  functions. Additionally supplies a modelling function (wdm) and further
  methods for the resulting object.</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-05-04 15:49:22 UTC; yeagle</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-05-04 19:10:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='deprecated'>Wiener likelihood and criterion functions (deprecated)</h2><span id='topic+wiener_likelihood'></span><span id='topic+wiener_deviance'></span><span id='topic+wiener_aic'></span><span id='topic+wiener_bic'></span>

<h3>Description</h3>

<p><code>wiener_likelihood</code> computes the log-likelihood for given parameter
values and data.
<code>wiener_deviance</code> computes the deviance.
<code>wiener_aic</code> computes the AIC.
<code>wiener_bic</code> computes the BIC.
These functions can be very useful in combination with the optim funcion,
to estimate parameters (see example below).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  wiener_likelihood(x, data)
  wiener_deviance(x, data)
  wiener_aic(x, data, loss=NULL)
  wiener_bic(x, data, loss=NULL)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="deprecated_+3A_x">x</code></td>
<td>
<p>vector with the four parameter values: alpha, tau, beta, delta.</p>
</td></tr>
<tr><td><code id="deprecated_+3A_data">data</code></td>
<td>
<p>dataframe with data. Needs a reaction time column and a
accuracy/response column.</p>
</td></tr>  
<tr><td><code id="deprecated_+3A_loss">loss</code></td>
<td>
<p>Defaults to NULL, which means that the default computation is
done by using -2*wiener_likelihood(x,data) in the formula. If not NULL,
this can be a function to replace the default -2*wiener_likelihood(x,data)
in the code and use a custom function instead.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The described functions are deprecated, but still fully supported. They
are kept for backwards compatibility and to ensure one can reproduce the
examples from Wabersich &amp; Vandekerckhove (2014). 
</p>
<p>These functions are simple wrapper functions for the generic R functions
reported below. 
</p>
<p>The User is encouraged to use the generic R functions instead:
<code>logLik.wdm</code>, <code>deviance.wdm</code>, <code>AIC.wdm</code>, <code>BIC.wdm</code>.
See the corresponding help pages for more information on these functions.
</p>


<h3>References</h3>

<p>Wabersich, D., &amp; Vandekerckhove, J. (2014). The RWiener package: An R
package providing distribution functions for the Wiener diffusion model.
The R Journal, 6(1), 49-56.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### Example 1: Parameter estimation
## generate random data
dat &lt;- rwiener(100,2,.3,.5,0)

## compute likelihood
wiener_likelihood(c(2,.3,.5,0), dat)

## estimate parameters with optim
onm &lt;- optim(c(1,.1,.1,1),wiener_deviance,data=dat, method="Nelder-Mead")
est &lt;- optim(onm$par,wiener_deviance,data=dat, method="BFGS",hessian=TRUE)
est$par # parameter estimates

## the following code needs the MASS package 
## Not run: sqrt(diag(MASS::ginv(est$hessian))) # sd for parameters

### Example 2: Simple model comparison
## compare two models with deviance
wiener_deviance(c(3,.3,.5,0), dat)
wiener_deviance(c(3,.3,.5,0.5), dat)
## log-likelihood difference
wiener_likelihood(c(3,.3,.5,0), dat)-wiener_likelihood(c(3,.3,.5,0.5), dat)

## Not run: 
### Example 3: likelihood-ratio test and Wald test
## Suppose we have data from 2 conditions
dat1 &lt;- rwiener(100,2,.3,.5,-.5)
dat2 &lt;- rwiener(100,2,.3,.5,.5)
onm1 &lt;- optim(c(1,.1,.1,1),wiener_deviance,data=dat1, method="Nelder-Mead")
est1 &lt;- optim(onm1$par,wiener_deviance,data=dat1, method="BFGS",hessian=TRUE)
wiener_likelihood(est1$par,dat1)+wiener_likelihood(est1$par,dat2) # combined loglike
model_ll &lt;- function(pars,delta,dat1,dat2) {
  wiener_likelihood(pars,dat1)+
    wiener_likelihood(c(pars[1:3],pars[4]+delta),dat2)
}
## likelihood-ratio test
## 0-model: delta=0; alt-model: delta=1
model_ll(est1$par,1,dat1,dat2)
## compute likelihood ratio
LR &lt;- -2*model_ll(est1$par,0,dat1,dat2)+2*model_ll(est1$par,1,dat1,dat2)
## compare with critical X^2(1) quantile, alpha=0.05
LR &gt; qchisq(0.95,1)
## get p-value from X^2(1)
pchisq(LR,1, lower.tail=FALSE)
## Wald-Test
## estimate parameter delta and test for significance
onm2 &lt;- optim(c(1,.1,.1,1),wiener_deviance,data=dat2, method="Nelder-Mead")
est2 &lt;- optim(onm2$par,wiener_deviance,data=dat2, method="BFGS",hessian=TRUE)
delta &lt;- est2$par[4]-est1$par[4]
## the following code needs the MASS package 
est1.sd &lt;- sqrt(diag(MASS::ginv(est1$hessian))) # sd for parameters
WT &lt;- (est1$par[4]-(est1$par[4]+delta))/est1.sd[4]
## compare with critical quantile N(0,1), alpha=0.05
abs(WT) &gt; qnorm(0.975)
## get p-value from N(0,1)
pnorm(WT)

## End(Not run)

### Example 4: Custom AIC loss function
many_drifts &lt;- function(x,datlist) {
  l = 0
  for (c in 1:length(datlist)) {
    l = l + wiener_deviance(x[c(1,2,3,c+3)],datlist[[c]])
  }
  return(l)
}
dat1 &lt;- rwiener(n=100, alpha=2, tau=.3, beta=.5, delta=0.5)
dat2 &lt;- rwiener(n=100, alpha=2, tau=.3, beta=.5, delta=1)
datlist &lt;- list(dat1,dat2)
wiener_aic(x=c(2,.3,.5,.5,1), data=datlist, loss=many_drifts)
</code></pre>

<hr>
<h2 id='likelihood'>Likelihood and criterion functions for wdm</h2><span id='topic+logLik.wdm'></span><span id='topic+deviance.wdm'></span><span id='topic+AIC.wdm'></span><span id='topic+BIC.wdm'></span>

<h3>Description</h3>

<p><code>logLik.wdm</code> computes the log-likelihood.
<code>deviance.wdm</code> computes the deviance.
<code>AIC.wdm</code> computes the AIC.
<code>BIC.wdm</code> computes the BIC.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'wdm'
logLik(object, ...)
## S3 method for class 'wdm'
deviance(object, ...)
## S3 method for class 'wdm'
AIC(object, ...)
## S3 method for class 'wdm'
BIC(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="likelihood_+3A_object">object</code></td>
<td>
<p>a wdm object file or a list containing a <code>$par</code>
vector with the model parameters, a <code>$data</code> data.frame with the data
and optionally a <code>$loss</code> function.</p>
</td></tr>
<tr><td><code id="likelihood_+3A_...">...</code></td>
<td>
<p>optional arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>$par</code> vector with the (four) parameter values should be in the following
order: alpha, tau, beta, delta.
</p>
<p>The <code>$data</code> data.frame with data needs a reaction time column and a
accuracy/response column.
</p>
<p>The <code>$loss</code> function defaults to NULL, which means that the default
computation is done by using the default formula.
If not NULL, this can be a function to replace the default
computation in the code and use a custom function
instead. The custom function takes two arguments: the parameter vector
and the data.frame with the data.
</p>
<p>These functions can be very useful in combination with the optim funcion,
to estimate parameters manually. Check the examples below to see how to
use the provided generic functions in a manual estimation routine.
</p>


<h3>References</h3>

<p>Wabersich, D., &amp; Vandekerckhove, J. (2014). The RWiener package: An R
package providing distribution functions for the Wiener diffusion model.
The R Journal, 6(1), 49-56.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## generate random data
dat &lt;- rwiener(100,3,.25,.5,0.8)

## fit wdm
wdm1 &lt;- wdm(dat, alpha=3, tau=.25, beta=0.5)

## compute likelihood, AIC, BIC, deviance
logLik(wdm1)
AIC(wdm1)
BIC(wdm1)
deviance(wdm1)

## Not run: 
## estimate parameters by calling optim manually
## first define necessary wrapper function
nll &lt;- function(x, data) { 
  object &lt;- wdm(data, alpha=x[1], tau=x[2], beta=x[3], delta=x[4])
  -logLik(object)
}
## call estimation routine
onm &lt;- optim(c(1,.1,.1,1),nll,data=dat, method="Nelder-Mead")
est &lt;- optim(onm$par,nll,data=dat, method="BFGS",hessian=TRUE)
est$par # parameter estimates
## use the obtained parameter estimates to create wdm object
wdm2 &lt;- wdm(dat, alpha=est$par[1], tau=est$par[2], beta=est$par[3],
  delta=est$par[4])
## now the generic functions can be used again
logLik(wdm2)

## End(Not run)
</code></pre>

<hr>
<h2 id='miscellaneous'>Miscellaneous Wiener Diffusion model functions</h2><span id='topic+is.wiener'></span><span id='topic+as.wiener'></span><span id='topic+numdata.wiener'></span><span id='topic+data.wiener'></span><span id='topic+revamp'></span><span id='topic+revamp.data.wiener'></span><span id='topic+revamp.numdata.wiener'></span><span id='topic+revamp.data.frame'></span>

<h3>Description</h3>

<p>Miscellaneous functions for the RWiener package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.wiener(data)
as.wiener(data, yvar=c("q", "resp"))
## S3 method for class 'numdata.wiener'
revamp(data, ...)
## S3 method for class 'data.wiener'
revamp(data, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="miscellaneous_+3A_data">data</code></td>
<td>
<p>can be a data.wiener and/or data.frame with data (needs a reaction time column and a
accuracy/response column). Further it can be a numdata.wiener and/or
numeric with the data as single variable (lower bound reaction times are
then represented as negative numbers, upper bound reaction times as
positive numbers).</p>
</td></tr>  
<tr><td><code id="miscellaneous_+3A_yvar">yvar</code></td>
<td>
<p>represents an optional vector, that can be used to define the
names of the reaction time column (first value) and the accuracy/response
column (second value), if a data.wiener and/or data.frame is given as
data.</p>
</td></tr>
<tr><td><code id="miscellaneous_+3A_...">...</code></td>
<td>
<p>optional arguments:
<code>yvar</code> (as described above) and <code>direction</code>: character string
that can be used to define the desired format of the returned data.
<code>"wide"</code> returns a numdata.wiener, <code>"long"</code> returns a
data.wiener.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>data.wiener</code> and <code>numdata.wiener</code> are data objects that
represent data coming from a Wiener Diffusion process. <code>data.wiener</code>
uses a data.frame with 2 columns for the 2 response variables (<code>"q"</code>
and <code>"resp"</code> by default). <code>numdata.wiener</code> emulates a single
variable representation by using a vector, that stores the responses for
the upper boundary as positive numbers and the responses for the lower
boundary as negative numbers. This is similar to the transformation:
Y=(2D-1)RT; where Y is the single variable, that preserves all the
information from the decision variable D (1 or 0) and the reaction time
variable RT.
</p>
<p>The <code>as.wiener</code> function can be used to create wiener data objects
(<code>data.wiener</code> or <code>numdata.wiener</code>), that can be used by
generic functions, e.g. <code>plot</code>.
</p>
<p><code>is.wiener</code> checks if the given data is a wiener data object
(<code>data.wiener</code> or <code>numdata.wiener</code>).
</p>
<p><code>revamp.data.wiener</code> and <code>revamp.numdat.wiener</code> can be used
to transform <code>data.wiener</code> objects to <code>numdata.wiener</code> objects
and vice versa. The generic function <code>revamp</code>(data, ...) can
be called for convenience.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## generate data
dat &lt;- rwiener(100, 4,.35,.5,0.8)

## simple function calls
is.wiener(dat)
dat &lt;- as.data.frame(dat)
dat &lt;- as.wiener(dat)
y &lt;- revamp(dat)
y
revamp(y)
</code></pre>

<hr>
<h2 id='plot'>Wiener plot function</h2><span id='topic+plot.data.wiener'></span><span id='topic+wiener_plot'></span>

<h3>Description</h3>

<p><code>plot</code> creates a density plot of correct and wrong responses
for a given dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'data.wiener'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_+3A_x">x</code></td>
<td>
<p>data.wiener object, which is basically a data.frame with data.
Needs a reaction time column and a accuracy/response column.</p>
</td></tr>  
<tr><td><code id="plot_+3A_...">...</code></td>
<td>
<p>Arguments to be passed to methods, such as graphical
parameters.</p>
</td></tr>  
</table>


<h3>References</h3>

<p>Wabersich, D., &amp; Vandekerckhove, J. (2014). The RWiener package: An R
package providing distribution functions for the Wiener diffusion model.
The R Journal, 6(1), 49-56.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## generate random data
dat &lt;- rwiener(100,2,.3,.5,0)

## plot
plot(dat)
</code></pre>

<hr>
<h2 id='RWiener+20internal'>Wiener functions internals</h2><span id='topic+verifypars'></span><span id='topic+nlogLik.wiener'></span><span id='topic+esvec'></span><span id='topic+efn'></span><span id='topic+cparvec'></span><span id='topic+mle'></span><span id='topic+wlrt'></span>

<h3>Description</h3>

<p>These functions are not to be used by the user.
</p>

<hr>
<h2 id='scorefun'>Extract Empirical Estimating Functions</h2><span id='topic+scorefun'></span><span id='topic+scorefun.wdm'></span><span id='topic+estfun'></span><span id='topic+estfun.wdm'></span>

<h3>Description</h3>

<p>!EXPERIMENTAL FUNCTION!
</p>
<p>Generic function for extracting the empirical estimating functions
of a fitted model. 
</p>
<p>!EXPERIMENTAL FUNCTION!
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scorefun(x, ...)
estfun(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="scorefun_+3A_x">x</code></td>
<td>
<p>a fitted model object.</p>
</td></tr>
<tr><td><code id="scorefun_+3A_...">...</code></td>
<td>
<p>arguments passed to methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix containing the empirical estimating functions.
Typically, this should be an <code class="reqn">n \times k</code> matrix corresponding
to <code class="reqn">n</code> observations and <code class="reqn">k</code> parameters. The columns should be named
as in <code><a href="stats.html#topic+coef">coef</a></code> or <code><a href="stats.html#topic+terms">terms</a></code>, respectively.
</p>
<p>The estimating function (or score function) for a model - <code>scorefun</code> - is the derivative of the objective function
with respect to the parameter vector. The empirical estimating functions is
the evaluation of the estimating function at the observed data (<code class="reqn">n</code> observations)
and the estimated parameters (of dimension <code class="reqn">k</code>).
</p>
<p>The <code>estfun</code> function is basically the score function, but with the
additional functionality to sum up the scores by the given covariable
<code>id</code> in the dataset.
</p>


<h3>References</h3>

<p>Zeileis A (2006), Object-Oriented Computation of Sandwich Estimators.
<em>Journal of Statistical Software</em>, <b>16</b>(9), 1&ndash;16.
URL <a href="http://www.jstatsoft.org/v16/i09/">http://www.jstatsoft.org/v16/i09/</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## generate random data
dat &lt;- rwiener(100,1,.2,.5,0.5)

## fit wdm
wdm1 &lt;- wdm(dat)

## estimating function
scores &lt;- scorefun(wdm1)

## print
head(scores)

## plot
par(mfrow=c(2,2))
plot(scores[,1]);plot(scores[,2]);plot(scores[,3]);plot(scores[,4])
</code></pre>

<hr>
<h2 id='tests'>Wiener Diffusion model test functions</h2><span id='topic+anova.wdm'></span><span id='topic+waldtest'></span><span id='topic+waldtest.wdm'></span><span id='topic+print.wwaldt'></span>

<h3>Description</h3>

<p>Calculates test scores and further information for <code><a href="#topic+wdm">wdm</a></code>
model objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ## S3 method for class 'wdm'
anova(object, ..., test="LRT")
  ## S3 method for class 'wdm'
waldtest(object, ..., theta="delta", theta0=0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tests_+3A_object">object</code></td>
<td>
<p>a wdm model object.</p>
</td></tr>
<tr><td><code id="tests_+3A_test">test</code></td>
<td>
<p>Statistical test to calculate, so far the only option is a
likelihood-ratio test (LRT).</p>
</td></tr>
<tr><td><code id="tests_+3A_...">...</code></td>
<td>
<p>Further model objects or other arguments passed to methods.</p>
</td></tr>
<tr><td><code id="tests_+3A_theta">theta</code></td>
<td>
<p>the name of the parameter to be tested.</p>
</td></tr>
<tr><td><code id="tests_+3A_theta0">theta0</code></td>
<td>
<p>the value of the parameter under the null hypothesis.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>anova.wdm</code> function calls the specified test and calculates the
test statistics and other information for two or more nested
<code><a href="#topic+wdm">wdm</a></code> model objects.
</p>
<p>The <code>waldtest.wdm</code> function can be used to conduct a Wald test for a
single parameter.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># a random dataset
dat &lt;- rbind(cbind(rwiener(100, 2,.3,.5,0), grp=factor("A", c("A","B"))),
cbind(rwiener(100,2,.3,.5,1), grp=factor("B", c("A","B"))))

# create nested wdm model objects (from specific to general)
wdm1 &lt;- wdm(dat)
wdm2 &lt;- wdm(dat,
            alpha=coef(wdm1)[1], tau=coef(wdm1)[2], beta=coef(wdm1)[3],
            xvar="grp")
wdm3 &lt;- wdm(dat,
            tau=coef(wdm1)[2],
            xvar="grp")

# conduct LRT tests
anova1 &lt;- anova(wdm1,wdm2,wdm3)
anova1

# waldtest
wt1 &lt;- waldtest(wdm1, theta="delta", theta0=0)
wt1
</code></pre>

<hr>
<h2 id='wdm'>Wiener diffusion model fit function</h2><span id='topic+wdm'></span><span id='topic+print.wdm'></span><span id='topic+vcov.wdm'></span><span id='topic+confint.wdm'></span><span id='topic+summary.wdm'></span><span id='topic+print.summary.wdm'></span>

<h3>Description</h3>

<p><code>wdm</code> creates parameter estimates for the four parameters
of the Wiener model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  wdm(data, yvar=c("q", "resp"), alpha=NULL, tau=NULL, beta=NULL,
    delta=NULL, xvar=NULL, start=NULL, fixed=0)
  ## S3 method for class 'wdm'
vcov(object, ..., method="hessian")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wdm_+3A_data">data</code></td>
<td>
<p>is the data object containing data coming from a
(hypothetical) Wiener diffusion process. For further details on the data
object, see <a href="#topic+is.wiener">is.wiener</a>.</p>
</td></tr>
<tr><td><code id="wdm_+3A_yvar">yvar</code></td>
<td>
<p>represents an optional vector, that can be used to define the
names of the reaction time column. For further details on the data
object, see <a href="#topic+is.wiener">is.wiener</a>.</p>
</td></tr>
<tr><td><code id="wdm_+3A_alpha">alpha</code></td>
<td>
<p>optional, can be used to fix the alpha parameter to the
given value.</p>
</td></tr>
<tr><td><code id="wdm_+3A_tau">tau</code></td>
<td>
<p>optional, can be used to fix the tau parameter to the given
value.</p>
</td></tr>
<tr><td><code id="wdm_+3A_beta">beta</code></td>
<td>
<p>optional, can be used to fix the beta parameter to the given
value.</p>
</td></tr>
<tr><td><code id="wdm_+3A_delta">delta</code></td>
<td>
<p>optional, can be used to fix the delta parameter to the
given value.</p>
</td></tr>
<tr><td><code id="wdm_+3A_xvar">xvar</code></td>
<td>
<p>optional: group factor variable to estimate all unfixed
parameters separate for the given groups.</p>
</td></tr>
<tr><td><code id="wdm_+3A_start">start</code></td>
<td>
<p>an optional vector with the four starting parameter values
in the following order: alpha, tau, beta, delta.</p>
</td></tr>  
<tr><td><code id="wdm_+3A_fixed">fixed</code></td>
<td>
<p>a number indicating how many of the parameters are fixed
(not free). This number will be subtracted from the number of free
parameters. Defaults to 0.</p>
</td></tr>  
<tr><td><code id="wdm_+3A_method">method</code></td>
<td>
<p>the method to use for estimating the covariance matrix of
the parameter estimates. Options are <code>"opg"</code> for outer product of
gradients or <code>"hessian"</code> to use the hessian matrix from the
estimation routine. Defaults to <code>"hessian"</code>.</p>
</td></tr>  
<tr><td><code id="wdm_+3A_object">object</code></td>
<td>
<p>a wdm object file or a list containing a <code>$par</code>
vector with the model parameters, a <code>$data</code> data.frame with the data
and optionally a <code>$loss</code> function.</p>
</td></tr>
<tr><td><code id="wdm_+3A_...">...</code></td>
<td>
<p>arguments passed to methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>wdm</code> function calls an estimation routine, to estimate the
model parameters. 
</p>
<p>If all but one parameters are fixed, a <code>"Brent
  (optim)"</code> type algorithm is used. For the estimation of more than one
parameter, first a <code>"BFGS (optim)"</code> type algorithm is tried, if
unsuccessful, a <code>"Newton type (nlm)"</code> algorithm is tried, if again
unsuccessful, a <code>"Nelder-Mead (optim)"</code> algorithm is used.
</p>
<p>In case all parameters are set to fixed values, no estimation routine is
called, but a <code>wdm</code> object will still be created.
</p>
<p>The returned <code>wdm</code> object is basically a list containing the
parameter estimates in <code>$coefficients</code>. <code>$hessian</code> contains the
numerically differentiated Hessian matrix (if available, else NULL).
<code>$data</code> contains the data passed to the <code>wdm</code> function call.
<code>$loglik</code> contains the log-likelihood value for the <code>wdm</code>
object and its parameter estimates. <code>$estpar</code> contains a vector,
that is <code>TRUE</code> if the respective parameter was estimated and
<code>FALSE</code> if the respective parameter was set to a fixed value.
Additional information is given in other list objects.
</p>
<p>The standard R functions <code>coef</code>, <code>vcov</code>, <code>confint</code>,
<code>summary</code> can be used with <code>wdm</code> objects.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## generate random data
dat &lt;- rbind(cbind(rwiener(100, 2,.3,.5,1), group=factor("A", c("A","B"))),
        cbind(rwiener(100,2,.3,.5,-1), group=factor("B", c("A", "B"))))

## fit wdm
wdm1 &lt;- wdm(dat)

## extract parameters
coef(wdm1)

## further models
wdm2 &lt;- wdm(dat, beta=.5)
wdm3 &lt;- wdm(dat, alpha=wdm1$coefficients[1], tau=wdm1$coefficients[2],
            beta=wdm1$coefficients[3], xvar="group")
</code></pre>

<hr>
<h2 id='wienerdist'>Wiener process distribution functions</h2><span id='topic+dwiener'></span><span id='topic+pwiener'></span><span id='topic+qwiener'></span><span id='topic+rwiener'></span>

<h3>Description</h3>

<p><code>dwiener</code> computes the wiener first passage time density.
<code>pwiener</code> computes the CDF for the wiener first passage time
density.
<code>qwiener</code> computes the quantile for a given CDF value.
<code>rwiener</code> generates random quantiles from a wiener process
distribution, based on the rejection based method.
For all functions, the standard deviation of the diffusion process is
fixed to 1.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  dwiener(q, alpha,tau,beta,delta, resp="upper", give_log=FALSE)
  pwiener(q, alpha,tau,beta,delta, resp="upper")
  qwiener(p, alpha,tau,beta,delta, resp="upper")
  rwiener(n, alpha,tau,beta,delta)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wienerdist_+3A_q">q</code></td>
<td>
<p>vector of quantiles.</p>
</td></tr>
<tr><td><code id="wienerdist_+3A_p">p</code></td>
<td>
<p>vector of probabilities.</p>
</td></tr>  
<tr><td><code id="wienerdist_+3A_n">n</code></td>
<td>
<p>number of observations.</p>
</td></tr>  
<tr><td><code id="wienerdist_+3A_alpha">alpha</code></td>
<td>
<p>boundary separation parameter.</p>
</td></tr>
<tr><td><code id="wienerdist_+3A_tau">tau</code></td>
<td>
<p>non-decision time parameter.</p>
</td></tr>
<tr><td><code id="wienerdist_+3A_beta">beta</code></td>
<td>
<p>bias parameter.</p>
</td></tr>
<tr><td><code id="wienerdist_+3A_delta">delta</code></td>
<td>
<p>drift rate parameter.</p>
</td></tr>
<tr><td><code id="wienerdist_+3A_resp">resp</code></td>
<td>
<p>respone: &quot;upper&quot;, &quot;lower&quot;, or &quot;both&quot;</p>
</td></tr>
<tr><td><code id="wienerdist_+3A_give_log">give_log</code></td>
<td>
<p>function returns log, if this argument is TRUE</p>
</td></tr>
</table>


<h3>References</h3>

<p>Wabersich, D., &amp; Vandekerckhove, J. (2014). The RWiener package: An R
package providing distribution functions for the Wiener diffusion model.
The R Journal, 6(1), 49-56.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## calculate density for reactiontime 1.45, upper bound and some parameters
dwiener(1.45, 2,0.3,0.5,0)

## calculate CDF for reactiontime 1.45, upper bound and some parameters
pwiener(1.45, 2,0.3,0.5,0)

## calculate quantile for CDF value of 0.5, upper bound and some parameters
qwiener(0.5, 2,0.3,0.5,0)

## generate one random value
rwiener(1, 2,0.3,0.5,0)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
