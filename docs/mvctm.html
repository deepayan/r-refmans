<!DOCTYPE html><html><head><title>Help for package mvctm</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {mvctm}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#mvctm-package'>
<p>Multivariate Variance Components Tests for Multilevel Data</p></a></li>
<li><a href='#mvctm'>
<p>Multivariate Variance Components Tests for Multilevel Data</p></a></li>
<li><a href='#permcluster'>
<p>Generates a Permuted Data Set</p></a></li>
<li><a href='#permute3levelt1'>
<p>Internal function</p></a></li>
<li><a href='#permute3levelt2'>
<p>Internal function</p></a></li>
<li><a href='#permute4levelt1'>
<p>Internal function</p></a></li>
<li><a href='#permute4levelt2'>
<p>Internal function</p></a></li>
<li><a href='#permute4levelt3'>
<p>Internal function</p></a></li>
<li><a href='#preparecluster'>
<p>Internal function</p></a></li>
<li><a href='#statvc2level'>
<p>Internal function</p></a></li>
<li><a href='#statvc3levelt1'>
<p>Internal function</p></a></li>
<li><a href='#statvc3levelt2'>
<p>Internal function</p></a></li>
<li><a href='#statvc4levelt1'>
<p>Internal function</p></a></li>
<li><a href='#statvc4levelt2'>
<p>Internal function</p></a></li>
<li><a href='#statvc4levelt3'>
<p>Internal function</p></a></li>
<li><a href='#testvc2level'>
<p>Internal function</p></a></li>
<li><a href='#testvc3levelt1'>
<p>Internal function</p></a></li>
<li><a href='#testvc3levelt2'>
<p>Internal function</p></a></li>
<li><a href='#testvc4levelt1'>
<p>Internal function</p></a></li>
<li><a href='#testvc4levelt2'>
<p>Internal function</p></a></li>
<li><a href='#testvc4levelt3'>
<p>Internal function</p></a></li>
<li><a href='#toydata'>
<p>Artificial 4-level data set</p></a></li>
<li><a href='#ystand'>
<p>Internal function</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Multivariate Variance Components Tests for Multilevel Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2018-08-01</td>
</tr>
<tr>
<td>Author:</td>
<td>Denis Larocque</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Denis Larocque &lt;denis.larocque@hec.ca&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>Formula, MNM, nlme, quantreg, Rfit, SpatialNP</td>
</tr>
<tr>
<td>Description:</td>
<td>Permutation tests for variance components for 2-level, 3-level and 4-level data with univariate or multivariate responses.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.0</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-08-01 18:35:16 UTC; 11000347</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-08-01 19:00:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='mvctm-package'>
Multivariate Variance Components Tests for Multilevel Data
</h2><span id='topic+mvctm-package'></span>

<h3>Description</h3>

<p>Permutation tests for variance components for 2-level, 3-level and 4-level data with univariate or multivariate responses.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> mvctm</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.1</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2017-03-08</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Denis Larocque
</p>
<p>Maintainer: Denis Larocque <code>&lt;denis.larocque@hec.ca&gt;</code>
</p>


<h3>References</h3>

<p>Larocque, D., Nevalainen, J. and Oja, H. (2018). Multivariate Variance Components Tests for Multilevel Data. Les Cahiers du GERAD G-2018-58.
</p>

<hr>
<h2 id='mvctm'>
Multivariate Variance Components Tests for Multilevel Data
</h2><span id='topic+mvctm'></span>

<h3>Description</h3>

<p>This function performs a permutation test for a variance component for 2-level, 3-level or 4-level data. The response can be univariate or multivariate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mvctm(fixed, cluster, data, leveltested, method = "ls", npermut = 1000, 
weight = "observation", affequiv = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mvctm_+3A_fixed">fixed</code></td>
<td>

<p>An object of class &ldquo;formula&quot; describing the fixed effects part of the model using the
variables in the data frame <code>data</code>.
</p>
</td></tr>
<tr><td><code id="mvctm_+3A_cluster">cluster</code></td>
<td>

<p>A vector giving the name of the variables in the data frame <code>data</code> to specify the clustering configuration. The order is important. For 2-level data it is a vector of dimension 1 specifying the level 1 cluster. For 3-level data, it is a vector of dimension 2. The first
element specifies the level 1 (outer) cluster and the second one specifies the level 2 (inner) cluster. For 4-level data, it is a vector of dimension 3. The first element specifies the level 1 (outer) cluster, the second one specifies the level 2 (middle) cluster, and the last one specifies the level 3 (inner) cluster.
</p>
</td></tr>
<tr><td><code id="mvctm_+3A_data">data</code></td>
<td>

<p>A data frame containing the data.
</p>
</td></tr>
<tr><td><code id="mvctm_+3A_leveltested">leveltested</code></td>
<td>

<p>An integer giving the level to be tested. It must be 1 for 2-level data, 1 or 2 for 3-level data, and 1, 2 or 3 for 4-level data. It corresponds to the element in <code>cluster</code>.
</p>
</td></tr>
<tr><td><code id="mvctm_+3A_method">method</code></td>
<td>

<p>The scores to be used. The four choices <code>"ls"</code>,  <code>"mixed"</code>, <code>"rank"</code> and <code>"sign"</code> are available. The default is <code>"ls"</code>. The choice <code>"mixed"</code> is only available for a univariate response.
</p>
</td></tr>
<tr><td><code id="mvctm_+3A_npermut">npermut</code></td>
<td>

<p>The number of random permutation used to perform the test. The default is 1000.
</p>
</td></tr>
<tr><td><code id="mvctm_+3A_weight">weight</code></td>
<td>

<p>The weight function to be used. The three choices <code>"pair"</code>, <code>"observation"</code> and <code>"cluster"</code> are available. The default is <code>"observation"</code>.
</p>
</td></tr>
<tr><td><code id="mvctm_+3A_affequiv">affequiv</code></td>
<td>

<p>Whether or not we want to use the affine-equivariant version of the tests. This is only relevant for a multivariate response and <code>method</code>=<code>"rank"</code> or <code>"sign"</code>. The default is <code>TRUE</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>With <code>method="ls"</code>, the fixed effects are estimated by ordinary least-squares. Then the test is performed on the residuals from this fit. With <code>method="mixed"</code>, the fixed effects are estimated with a linear mixed model. Then the test is performed on the marginal (population) residuals from this fit. With <code>method="rank"</code>, a rank-based method is used to estimate the fixed effects. Then the test is performed on the ranks of the residuals from this fit. Finally, with <code>method="sign"</code>, a sign-based method is used to estimate the fixed effects. Then the test is performed on the signs of the residuals from this fit. For multivariate data, spatial ranks and signs are used.
</p>
<p>With a univariate response, <code>method="sign"</code> is not recommended because
the test might be liberal. 
</p>
<p>With, <code>weight="pair"</code>,  observations in larger clusters at the level <code>leveltested</code> will have more weights. With, <code>weight="cluster"</code>, the same weight is given to each cluster at the level <code>leveltested</code>. As a compromise between these two, the default <code>weight="observation"</code>  gives an equal weight to each individual observation, with respect to the clusters at level <code>leveltested</code>.
</p>


<h3>Value</h3>

<p>A list with the following two elements:
</p>
<table>
<tr><td><code>pvalue</code></td>
<td>
<p>The p-value of the test.</p>
</td></tr>
<tr><td><code>statistic</code></td>
<td>
<p>The value of the test statistic computed on the original data.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Denis Larocque <code>&lt;denis.larocque@hec.ca&gt;</code>
</p>


<h3>References</h3>

<p>Larocque, D., Nevalainen, J. and Oja, H. (2018). Multivariate Variance Components Tests for Multilevel Data. Les Cahiers du GERAD G-2018-58.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(toydata)

# Bivariate 2-level model.
# Classroom as the clusters. 
# Only an intercept is in the fixed part of the model.
# Test based on 200 permutations
mvctm(fixed=cbind(y1,y2)~1,cluster=c("classroom"),
data=toydata,leveltested=1,npermut=200)

# Same as above but The two covariates are in the fixed part of the model.
# Test based on 1000 permutations (default).
## Not run: 
mvctm(fixed=cbind(y1,y2)~x1+x2,cluster=c("classroom"),
data=toydata,leveltested=1)

## End(Not run)

# Same as above but the rank scores are used.
## Not run: 
mvctm(fixed=cbind(y1,y2)~x1+x2,cluster=c("classroom"),
data=toydata,leveltested=1, method="rank")

## End(Not run)

# Univariate 4-level model. 
# Classrooms, nested within schools, nested within regions.
# The variance component at the region level is tested. 
# The fixed effects are estimated with a linear mixed model.
## Not run: 
mvctm(fixed=y1~x1+x2,cluster=c("region","school","classroom"),
data=toydata,leveltested=1,method="mixed")

## End(Not run)

# Same as above but the variance component at the school level is tested.
## Not run: 
mvctm(fixed=y1~x1+x2,cluster=c("region","school","classroom"),
data=toydata,leveltested=2,method="mixed")

## End(Not run)

# Same as above but the variance component at the classroom level is tested.
## Not run: 
mvctm(fixed=y1~x1+x2,cluster=c("region","school","classroom"),
data=toydata,leveltested=3,method="mixed")

## End(Not run)

# Univariate 3-level model.
# The variance component at the classroom level is tested.
# The fixed effects are removed with an M-estimator with the rlm function 
#      in the MASS package. 
# Then the residuals from this fit are used to perform the test. 
# The ~0 in the formula tells mvctm to use  mresid directly to perform 
#      the test without any centering or transformation.  
## Not run: 
library("MASS")
toydata[,"mresid"]=rlm(y1~x1+x2,data=toydata)$residuals
mvctm(fixed=mresid~0,cluster=c("school","classroom"),
data=toydata,leveltested=2)

## End(Not run)

</code></pre>

<hr>
<h2 id='permcluster'>
Generates a Permuted Data Set
</h2><span id='topic+permcluster'></span>

<h3>Description</h3>

<p>This function generates a permuted data set that can be used to perform a permutation test for a variance component for 2-level, 3-level or 4-level data. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>permcluster(cluster, data, leveltested)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="permcluster_+3A_cluster">cluster</code></td>
<td>

<p>A vector giving the name of the variables in the data frame <code>data</code> to specify the clustering configuration. The order is important. For 2-level data it is a vector of dimension 1 specifying the level 1 cluster. For 3-level data, it is a vector of dimension 2. The first
element specifies the level 1 (outer) cluster and the second one specifies the level 2 (inner) cluster. For 4-level data, it is a vector of dimension 3. The first element specifies the level 1 (outer) cluster, the second one specifies the level 2 (middle) cluster, and the last one specifies the level 3 (inner) cluster.
</p>
</td></tr>  
<tr><td><code id="permcluster_+3A_data">data</code></td>
<td>

<p>A data frame containing the data.
</p>
</td></tr>
<tr><td><code id="permcluster_+3A_leveltested">leveltested</code></td>
<td>

<p>An integer giving the level to be tested. It must be 1 for 2-level data, 1 or 2 for 3-level data, and 1, 2 or 3 for 4-level data. It corresponds to the element in <code>cluster</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a utility function that allows to perform a permutation test with another test statistic than the one in the function <code>mvctm</code>.
</p>


<h3>Value</h3>

<p>A data frame that contains the original variables plus 1, 2 or 3 new columns. For 2-level data, a single new column called <code>clusperm1</code> contains the permuted indices for the level 1 cluster. For 3-level data, two new columns called <code>clusperm1</code> and <code>clusperm2</code> contain the permuted indices for the level 1 and level 2 clusters, respectively. For 4-level data, three new columns called <code>clusperm1</code>, <code>clusperm2</code> and <code>clusperm3</code> contain the permuted indices for the level 1, level 2, and level 3 clusters, respectively.
</p>


<h3>Author(s)</h3>

<p>Denis Larocque <code>&lt;denis.larocque@hec.ca&gt;</code>
</p>


<h3>References</h3>

<p>Larocque, D., Nevalainen, J. and Oja, H. (2018). Multivariate Variance Components Tests for Multilevel Data. Les Cahiers du GERAD G-2018-58.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(toydata)

# generates a permuted data set with 2-level data

permcluster(cluster=c("classroom"),data=toydata,leveltested=1)

# generates a permuted data set with 4-level data to test for level 2

permcluster(cluster=c("region","school","classroom"),
data=toydata,leveltested=2)

# performing a permutation test with another
# test statistic might look like this

## Not run: 
pval=0
# compute the statistic with the original data. Call in stato.
for (i in 1:npermut)
{
pdata=permcluster(cluster=c("classroom"),data=toydata,leveltested=1)
# compute the statistic with pdata using the new column
# clusperm1 instead of classroom as the cluster index.
# call it statp.
pval=pval+(statp&gt;stato)
}
pval/npermut

## End(Not run)

</code></pre>

<hr>
<h2 id='permute3levelt1'>
Internal function
</h2><span id='topic+permute3levelt1'></span>

<h3>Description</h3>

<p>Used to get a random permutation of the data to test level 1 with 3-level data. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>permute3levelt1(cluster, m1, m2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="permute3levelt1_+3A_cluster">cluster</code></td>
<td>

</td></tr>
<tr><td><code id="permute3levelt1_+3A_m1">m1</code></td>
<td>

</td></tr>
<tr><td><code id="permute3levelt1_+3A_m2">m2</code></td>
<td>

</td></tr>
</table>


<h3>Author(s)</h3>

<p>Denis Larocque <code>&lt;denis.larocque@hec.ca&gt;</code>
</p>

<hr>
<h2 id='permute3levelt2'>
Internal function
</h2><span id='topic+permute3levelt2'></span>

<h3>Description</h3>

<p>Used to get a random permutation of the data to test level 2 with 3-level data. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>permute3levelt2(listind)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="permute3levelt2_+3A_listind">listind</code></td>
<td>

</td></tr>
</table>


<h3>Author(s)</h3>

<p>Denis Larocque <code>&lt;denis.larocque@hec.ca&gt;</code>
</p>

<hr>
<h2 id='permute4levelt1'>
Internal function
</h2><span id='topic+permute4levelt1'></span>

<h3>Description</h3>

<p>Used to get a random permutation of the data to test level 1 with 4-level data. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>permute4levelt1(cluster, m1, m2, m3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="permute4levelt1_+3A_cluster">cluster</code></td>
<td>

</td></tr>
<tr><td><code id="permute4levelt1_+3A_m1">m1</code></td>
<td>

</td></tr>
<tr><td><code id="permute4levelt1_+3A_m2">m2</code></td>
<td>

</td></tr>
<tr><td><code id="permute4levelt1_+3A_m3">m3</code></td>
<td>

</td></tr>
</table>


<h3>Author(s)</h3>

<p>Denis Larocque <code>&lt;denis.larocque@hec.ca&gt;</code>
</p>

<hr>
<h2 id='permute4levelt2'>
Internal function
</h2><span id='topic+permute4levelt2'></span>

<h3>Description</h3>

<p>Used to get a random permutation of the data to test level 2 with 4-level data. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>permute4levelt2(cluster, m1, m2, m3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="permute4levelt2_+3A_cluster">cluster</code></td>
<td>

</td></tr>
<tr><td><code id="permute4levelt2_+3A_m1">m1</code></td>
<td>

</td></tr>
<tr><td><code id="permute4levelt2_+3A_m2">m2</code></td>
<td>

</td></tr>
<tr><td><code id="permute4levelt2_+3A_m3">m3</code></td>
<td>

</td></tr>
</table>


<h3>Author(s)</h3>

<p>Denis Larocque <code>&lt;denis.larocque@hec.ca&gt;</code>
</p>

<hr>
<h2 id='permute4levelt3'>
Internal function
</h2><span id='topic+permute4levelt3'></span>

<h3>Description</h3>

<p>Used to get a random permutation of the data to test level 3 with 4-level data. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>permute4levelt3(listind)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="permute4levelt3_+3A_listind">listind</code></td>
<td>

</td></tr>
</table>


<h3>Author(s)</h3>

<p>Denis Larocque <code>&lt;denis.larocque@hec.ca&gt;</code>
</p>

<hr>
<h2 id='preparecluster'>
Internal function
</h2><span id='topic+preparecluster'></span>

<h3>Description</h3>

<p>Prepare the cluster configuration for use by the other functions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>preparecluster(cluster)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="preparecluster_+3A_cluster">cluster</code></td>
<td>

</td></tr>
</table>


<h3>Author(s)</h3>

<p>Denis Larocque <code>&lt;denis.larocque@hec.ca&gt;</code>
</p>

<hr>
<h2 id='statvc2level'>
Internal function
</h2><span id='topic+statvc2level'></span>

<h3>Description</h3>

<p>Compute the dependence statistic to test level 1 with 2-level data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>statvc2level(y, cluster, m1, n1, p, weight)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="statvc2level_+3A_y">y</code></td>
<td>

</td></tr>
<tr><td><code id="statvc2level_+3A_cluster">cluster</code></td>
<td>

</td></tr>
<tr><td><code id="statvc2level_+3A_m1">m1</code></td>
<td>

</td></tr>
<tr><td><code id="statvc2level_+3A_n1">n1</code></td>
<td>

</td></tr>
<tr><td><code id="statvc2level_+3A_p">p</code></td>
<td>

</td></tr>
<tr><td><code id="statvc2level_+3A_weight">weight</code></td>
<td>

</td></tr>
</table>


<h3>Author(s)</h3>

<p>Denis Larocque <code>&lt;denis.larocque@hec.ca&gt;</code>
</p>

<hr>
<h2 id='statvc3levelt1'>
Internal function
</h2><span id='topic+statvc3levelt1'></span>

<h3>Description</h3>

<p>Compute the dependence statistic to test level 1 with 3-level data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>statvc3levelt1(y, cluster, m1, m2, n2, p, weight)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="statvc3levelt1_+3A_y">y</code></td>
<td>

</td></tr>
<tr><td><code id="statvc3levelt1_+3A_cluster">cluster</code></td>
<td>

</td></tr>
<tr><td><code id="statvc3levelt1_+3A_m1">m1</code></td>
<td>

</td></tr>
<tr><td><code id="statvc3levelt1_+3A_m2">m2</code></td>
<td>

</td></tr>
<tr><td><code id="statvc3levelt1_+3A_n2">n2</code></td>
<td>

</td></tr>
<tr><td><code id="statvc3levelt1_+3A_p">p</code></td>
<td>

</td></tr>
<tr><td><code id="statvc3levelt1_+3A_weight">weight</code></td>
<td>

</td></tr>
</table>


<h3>Author(s)</h3>

<p>Denis Larocque <code>&lt;denis.larocque@hec.ca&gt;</code>
</p>

<hr>
<h2 id='statvc3levelt2'>
Internal function
</h2><span id='topic+statvc3levelt2'></span>

<h3>Description</h3>

<p>Compute the dependence statistic to test level 2 with 3-level data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>statvc3levelt2(y, cluster, m1, n1, m2, n2, p, weight)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="statvc3levelt2_+3A_y">y</code></td>
<td>

</td></tr>
<tr><td><code id="statvc3levelt2_+3A_cluster">cluster</code></td>
<td>

</td></tr>
<tr><td><code id="statvc3levelt2_+3A_m1">m1</code></td>
<td>

</td></tr>
<tr><td><code id="statvc3levelt2_+3A_n1">n1</code></td>
<td>

</td></tr>
<tr><td><code id="statvc3levelt2_+3A_m2">m2</code></td>
<td>

</td></tr>
<tr><td><code id="statvc3levelt2_+3A_n2">n2</code></td>
<td>

</td></tr>
<tr><td><code id="statvc3levelt2_+3A_p">p</code></td>
<td>

</td></tr>
<tr><td><code id="statvc3levelt2_+3A_weight">weight</code></td>
<td>

</td></tr>
</table>


<h3>Author(s)</h3>

<p>Denis Larocque <code>&lt;denis.larocque@hec.ca&gt;</code>
</p>

<hr>
<h2 id='statvc4levelt1'>
Internal function
</h2><span id='topic+statvc4levelt1'></span>

<h3>Description</h3>

<p>Compute the dependence statistic to test level 1 with 4-level data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>statvc4levelt1(y, cluster, m1, n1, m2, n2, m3, n3, p, weight)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="statvc4levelt1_+3A_y">y</code></td>
<td>

</td></tr>
<tr><td><code id="statvc4levelt1_+3A_cluster">cluster</code></td>
<td>

</td></tr>
<tr><td><code id="statvc4levelt1_+3A_m1">m1</code></td>
<td>

</td></tr>
<tr><td><code id="statvc4levelt1_+3A_n1">n1</code></td>
<td>

</td></tr>
<tr><td><code id="statvc4levelt1_+3A_m2">m2</code></td>
<td>

</td></tr>
<tr><td><code id="statvc4levelt1_+3A_n2">n2</code></td>
<td>

</td></tr>
<tr><td><code id="statvc4levelt1_+3A_m3">m3</code></td>
<td>

</td></tr>
<tr><td><code id="statvc4levelt1_+3A_n3">n3</code></td>
<td>

</td></tr>
<tr><td><code id="statvc4levelt1_+3A_p">p</code></td>
<td>

</td></tr>
<tr><td><code id="statvc4levelt1_+3A_weight">weight</code></td>
<td>

</td></tr>
</table>


<h3>Author(s)</h3>

<p>Denis Larocque <code>&lt;denis.larocque@hec.ca&gt;</code>
</p>

<hr>
<h2 id='statvc4levelt2'>
Internal function
</h2><span id='topic+statvc4levelt2'></span>

<h3>Description</h3>

<p>Compute the dependence statistic to test level 2 with 4-level data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>statvc4levelt2(y, cluster, m1, n1, m2, n2, m3, n3, p, weight)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="statvc4levelt2_+3A_y">y</code></td>
<td>

</td></tr>
<tr><td><code id="statvc4levelt2_+3A_cluster">cluster</code></td>
<td>

</td></tr>
<tr><td><code id="statvc4levelt2_+3A_m1">m1</code></td>
<td>

</td></tr>
<tr><td><code id="statvc4levelt2_+3A_n1">n1</code></td>
<td>

</td></tr>
<tr><td><code id="statvc4levelt2_+3A_m2">m2</code></td>
<td>

</td></tr>
<tr><td><code id="statvc4levelt2_+3A_n2">n2</code></td>
<td>

</td></tr>
<tr><td><code id="statvc4levelt2_+3A_m3">m3</code></td>
<td>

</td></tr>
<tr><td><code id="statvc4levelt2_+3A_n3">n3</code></td>
<td>

</td></tr>
<tr><td><code id="statvc4levelt2_+3A_p">p</code></td>
<td>

</td></tr>
<tr><td><code id="statvc4levelt2_+3A_weight">weight</code></td>
<td>

</td></tr>
</table>


<h3>Author(s)</h3>

<p>Denis Larocque <code>&lt;denis.larocque@hec.ca&gt;</code>
</p>

<hr>
<h2 id='statvc4levelt3'>
Internal function
</h2><span id='topic+statvc4levelt3'></span>

<h3>Description</h3>

<p>Compute the dependence statistic to test level 3 with 4-level data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>statvc4levelt3(y, cluster, m1, n1, m2, n2, m3, n3, p, weight)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="statvc4levelt3_+3A_y">y</code></td>
<td>

</td></tr>
<tr><td><code id="statvc4levelt3_+3A_cluster">cluster</code></td>
<td>

</td></tr>
<tr><td><code id="statvc4levelt3_+3A_m1">m1</code></td>
<td>

</td></tr>
<tr><td><code id="statvc4levelt3_+3A_n1">n1</code></td>
<td>

</td></tr>
<tr><td><code id="statvc4levelt3_+3A_m2">m2</code></td>
<td>

</td></tr>
<tr><td><code id="statvc4levelt3_+3A_n2">n2</code></td>
<td>

</td></tr>
<tr><td><code id="statvc4levelt3_+3A_m3">m3</code></td>
<td>

</td></tr>
<tr><td><code id="statvc4levelt3_+3A_n3">n3</code></td>
<td>

</td></tr>
<tr><td><code id="statvc4levelt3_+3A_p">p</code></td>
<td>

</td></tr>
<tr><td><code id="statvc4levelt3_+3A_weight">weight</code></td>
<td>

</td></tr>
</table>


<h3>Author(s)</h3>

<p>Denis Larocque <code>&lt;denis.larocque@hec.ca&gt;</code>
</p>

<hr>
<h2 id='testvc2level'>
Internal function
</h2><span id='topic+testvc2level'></span>

<h3>Description</h3>

<p>Performs the test for level 1 with 2-level data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>testvc2level(y, cluster, npermut, N, p, smat, m1, n1, weight)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="testvc2level_+3A_y">y</code></td>
<td>

</td></tr>
<tr><td><code id="testvc2level_+3A_cluster">cluster</code></td>
<td>

</td></tr>
<tr><td><code id="testvc2level_+3A_npermut">npermut</code></td>
<td>

</td></tr>
<tr><td><code id="testvc2level_+3A_n">N</code></td>
<td>

</td></tr>
<tr><td><code id="testvc2level_+3A_p">p</code></td>
<td>

</td></tr>
<tr><td><code id="testvc2level_+3A_smat">smat</code></td>
<td>

</td></tr>
<tr><td><code id="testvc2level_+3A_m1">m1</code></td>
<td>

</td></tr>
<tr><td><code id="testvc2level_+3A_n1">n1</code></td>
<td>

</td></tr>
<tr><td><code id="testvc2level_+3A_weight">weight</code></td>
<td>

</td></tr>
</table>


<h3>Author(s)</h3>

<p>Denis Larocque <code>&lt;denis.larocque@hec.ca&gt;</code>
</p>

<hr>
<h2 id='testvc3levelt1'>
Internal function
</h2><span id='topic+testvc3levelt1'></span>

<h3>Description</h3>

<p>Performs the test for level 1 with 3-level data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>testvc3levelt1(y, cluster, npermut, N, p, smat, m1, n1, m2, n2, weight)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="testvc3levelt1_+3A_y">y</code></td>
<td>

</td></tr>
<tr><td><code id="testvc3levelt1_+3A_cluster">cluster</code></td>
<td>

</td></tr>
<tr><td><code id="testvc3levelt1_+3A_npermut">npermut</code></td>
<td>

</td></tr>
<tr><td><code id="testvc3levelt1_+3A_n">N</code></td>
<td>

</td></tr>
<tr><td><code id="testvc3levelt1_+3A_p">p</code></td>
<td>

</td></tr>
<tr><td><code id="testvc3levelt1_+3A_smat">smat</code></td>
<td>

</td></tr>
<tr><td><code id="testvc3levelt1_+3A_m1">m1</code></td>
<td>

</td></tr>
<tr><td><code id="testvc3levelt1_+3A_n1">n1</code></td>
<td>

</td></tr>
<tr><td><code id="testvc3levelt1_+3A_m2">m2</code></td>
<td>

</td></tr>
<tr><td><code id="testvc3levelt1_+3A_n2">n2</code></td>
<td>

</td></tr>
<tr><td><code id="testvc3levelt1_+3A_weight">weight</code></td>
<td>

</td></tr>
</table>


<h3>Author(s)</h3>

<p>Denis Larocque <code>&lt;denis.larocque@hec.ca&gt;</code>
</p>

<hr>
<h2 id='testvc3levelt2'>
Internal function
</h2><span id='topic+testvc3levelt2'></span>

<h3>Description</h3>

<p>Performs the test for level 2 with 3-level data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>testvc3levelt2(y, cluster, npermut, N, p, smat, m1, n1, m2, n2, weight)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="testvc3levelt2_+3A_y">y</code></td>
<td>

</td></tr>
<tr><td><code id="testvc3levelt2_+3A_cluster">cluster</code></td>
<td>

</td></tr>
<tr><td><code id="testvc3levelt2_+3A_npermut">npermut</code></td>
<td>

</td></tr>
<tr><td><code id="testvc3levelt2_+3A_n">N</code></td>
<td>

</td></tr>
<tr><td><code id="testvc3levelt2_+3A_p">p</code></td>
<td>

</td></tr>
<tr><td><code id="testvc3levelt2_+3A_smat">smat</code></td>
<td>

</td></tr>
<tr><td><code id="testvc3levelt2_+3A_m1">m1</code></td>
<td>

</td></tr>
<tr><td><code id="testvc3levelt2_+3A_n1">n1</code></td>
<td>

</td></tr>
<tr><td><code id="testvc3levelt2_+3A_m2">m2</code></td>
<td>

</td></tr>
<tr><td><code id="testvc3levelt2_+3A_n2">n2</code></td>
<td>

</td></tr>
<tr><td><code id="testvc3levelt2_+3A_weight">weight</code></td>
<td>

</td></tr>
</table>


<h3>Author(s)</h3>

<p>Denis Larocque <code>&lt;denis.larocque@hec.ca&gt;</code>
</p>

<hr>
<h2 id='testvc4levelt1'>
Internal function
</h2><span id='topic+testvc4levelt1'></span>

<h3>Description</h3>

<p>Performs the test for level 1 with 4-level data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>testvc4levelt1(y, cluster, npermut, N, p, smat, m1, n1, m2, n2, m3, n3, weight)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="testvc4levelt1_+3A_y">y</code></td>
<td>

</td></tr>
<tr><td><code id="testvc4levelt1_+3A_cluster">cluster</code></td>
<td>

</td></tr>
<tr><td><code id="testvc4levelt1_+3A_npermut">npermut</code></td>
<td>

</td></tr>
<tr><td><code id="testvc4levelt1_+3A_n">N</code></td>
<td>

</td></tr>
<tr><td><code id="testvc4levelt1_+3A_p">p</code></td>
<td>

</td></tr>
<tr><td><code id="testvc4levelt1_+3A_smat">smat</code></td>
<td>

</td></tr>
<tr><td><code id="testvc4levelt1_+3A_m1">m1</code></td>
<td>

</td></tr>
<tr><td><code id="testvc4levelt1_+3A_n1">n1</code></td>
<td>

</td></tr>
<tr><td><code id="testvc4levelt1_+3A_m2">m2</code></td>
<td>

</td></tr>
<tr><td><code id="testvc4levelt1_+3A_n2">n2</code></td>
<td>

</td></tr>
<tr><td><code id="testvc4levelt1_+3A_m3">m3</code></td>
<td>

</td></tr>
<tr><td><code id="testvc4levelt1_+3A_n3">n3</code></td>
<td>

</td></tr>
<tr><td><code id="testvc4levelt1_+3A_weight">weight</code></td>
<td>

</td></tr>
</table>


<h3>Author(s)</h3>

<p>Denis Larocque <code>&lt;denis.larocque@hec.ca&gt;</code>
</p>

<hr>
<h2 id='testvc4levelt2'>
Internal function
</h2><span id='topic+testvc4levelt2'></span>

<h3>Description</h3>

<p>Performs the test for level 2 with 4-level data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>testvc4levelt2(y, cluster, npermut, N, p, smat, m1, n1, m2, n2, m3, n3, weight)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="testvc4levelt2_+3A_y">y</code></td>
<td>

</td></tr>
<tr><td><code id="testvc4levelt2_+3A_cluster">cluster</code></td>
<td>

</td></tr>
<tr><td><code id="testvc4levelt2_+3A_npermut">npermut</code></td>
<td>

</td></tr>
<tr><td><code id="testvc4levelt2_+3A_n">N</code></td>
<td>

</td></tr>
<tr><td><code id="testvc4levelt2_+3A_p">p</code></td>
<td>

</td></tr>
<tr><td><code id="testvc4levelt2_+3A_smat">smat</code></td>
<td>

</td></tr>
<tr><td><code id="testvc4levelt2_+3A_m1">m1</code></td>
<td>

</td></tr>
<tr><td><code id="testvc4levelt2_+3A_n1">n1</code></td>
<td>

</td></tr>
<tr><td><code id="testvc4levelt2_+3A_m2">m2</code></td>
<td>

</td></tr>
<tr><td><code id="testvc4levelt2_+3A_n2">n2</code></td>
<td>

</td></tr>
<tr><td><code id="testvc4levelt2_+3A_m3">m3</code></td>
<td>

</td></tr>
<tr><td><code id="testvc4levelt2_+3A_n3">n3</code></td>
<td>

</td></tr>
<tr><td><code id="testvc4levelt2_+3A_weight">weight</code></td>
<td>

</td></tr>
</table>


<h3>Author(s)</h3>

<p>Denis Larocque <code>&lt;denis.larocque@hec.ca&gt;</code>
</p>

<hr>
<h2 id='testvc4levelt3'>
Internal function
</h2><span id='topic+testvc4levelt3'></span>

<h3>Description</h3>

<p>Performs the test for level 3 with 4-level data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>testvc4levelt3(y, cluster, npermut, N, p, smat, m1, n1, m2, n2, m3, n3, weight)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="testvc4levelt3_+3A_y">y</code></td>
<td>

</td></tr>
<tr><td><code id="testvc4levelt3_+3A_cluster">cluster</code></td>
<td>

</td></tr>
<tr><td><code id="testvc4levelt3_+3A_npermut">npermut</code></td>
<td>

</td></tr>
<tr><td><code id="testvc4levelt3_+3A_n">N</code></td>
<td>

</td></tr>
<tr><td><code id="testvc4levelt3_+3A_p">p</code></td>
<td>

</td></tr>
<tr><td><code id="testvc4levelt3_+3A_smat">smat</code></td>
<td>

</td></tr>
<tr><td><code id="testvc4levelt3_+3A_m1">m1</code></td>
<td>

</td></tr>
<tr><td><code id="testvc4levelt3_+3A_n1">n1</code></td>
<td>

</td></tr>
<tr><td><code id="testvc4levelt3_+3A_m2">m2</code></td>
<td>

</td></tr>
<tr><td><code id="testvc4levelt3_+3A_n2">n2</code></td>
<td>

</td></tr>
<tr><td><code id="testvc4levelt3_+3A_m3">m3</code></td>
<td>

</td></tr>
<tr><td><code id="testvc4levelt3_+3A_n3">n3</code></td>
<td>

</td></tr>
<tr><td><code id="testvc4levelt3_+3A_weight">weight</code></td>
<td>

</td></tr>
</table>


<h3>Author(s)</h3>

<p>Denis Larocque <code>&lt;denis.larocque@hec.ca&gt;</code>
</p>

<hr>
<h2 id='toydata'>
Artificial 4-level data set
</h2><span id='topic+toydata'></span>

<h3>Description</h3>

<p>A 4-level data set with two responses and two covariates to illustrate the package mvctm. The classroom is nested within the school which is nested within the region. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(toydata)</code></pre>


<h3>Format</h3>

<p>A data frame with 150 observations on the following 7 variables.
</p>

<dl>
<dt><code>y1</code></dt><dd><p>The first response</p>
</dd>
<dt><code>y2</code></dt><dd><p>The second response</p>
</dd>
<dt><code>x1</code></dt><dd><p>The first covariate</p>
</dd>
<dt><code>x2</code></dt><dd><p>The second covariate</p>
</dd>
<dt><code>region</code></dt><dd><p>The level 1 cluster (outer)</p>
</dd>
<dt><code>school</code></dt><dd><p>The level 2 cluster (middle)</p>
</dd>
<dt><code>classroom</code></dt><dd><p>The level 3 cluster (inner)</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(toydata)
</code></pre>

<hr>
<h2 id='ystand'>
Internal function
</h2><span id='topic+ystand'></span>

<h3>Description</h3>

<p>Remove the fixed effects and transforms the residuals (if needed) prior to performing the permutation test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ystand(fixed, clustername, data, method, y, N, p, nlevel, stand, affequiv)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ystand_+3A_fixed">fixed</code></td>
<td>

</td></tr>
<tr><td><code id="ystand_+3A_clustername">clustername</code></td>
<td>

</td></tr>
<tr><td><code id="ystand_+3A_data">data</code></td>
<td>

</td></tr>
<tr><td><code id="ystand_+3A_method">method</code></td>
<td>

</td></tr>
<tr><td><code id="ystand_+3A_y">y</code></td>
<td>

</td></tr>
<tr><td><code id="ystand_+3A_n">N</code></td>
<td>

</td></tr>
<tr><td><code id="ystand_+3A_p">p</code></td>
<td>

</td></tr>
<tr><td><code id="ystand_+3A_nlevel">nlevel</code></td>
<td>

</td></tr>
<tr><td><code id="ystand_+3A_stand">stand</code></td>
<td>

</td></tr>
<tr><td><code id="ystand_+3A_affequiv">affequiv</code></td>
<td>

</td></tr>
</table>


<h3>Author(s)</h3>

<p>Denis Larocque <code>&lt;denis.larocque@hec.ca&gt;</code>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
