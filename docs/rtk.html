<!DOCTYPE html><html><head><title>Help for package rtk</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {rtk}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#rtk-package'>
<p>Rarefaction Tool Kit</p></a></li>
<li><a href='#collectors.curve'><p>collectors.curve</p></a></li>
<li><a href='#get.diversity'><p>get.diversity</p></a></li>
<li><a href='#plot'><p>Plot rarfeaction results</p></a></li>
<li><a href='#rtk'><p>Rarefy tables</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Rarefaction Tool Kit</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.6.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-06-13</td>
</tr>
<tr>
<td>Author:</td>
<td>Paul Saary, Falk Hildebrand</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Paul Saary &lt;rtk@paulsaary.de&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Rarefy data, calculate diversity and plot the results.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 0.12.3),methods</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>C++11</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-06-13 07:47:21 UTC; paul</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-06-13 09:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='rtk-package'>
Rarefaction Tool Kit
</h2><span id='topic+rtk-package'></span>

<h3>Description</h3>

<p>Rarefy data, calculate diversity and plot the results.
</p>


<h3>Details</h3>

<p>The DESCRIPTION file:
</p>

<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> rtk</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Title: </td><td style="text-align: left;"> Rarefaction Tool Kit</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 0.2.6.1</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2020-06-13</td>
</tr>
<tr>
 <td style="text-align: left;">
Author: </td><td style="text-align: left;"> Paul Saary, Falk Hildebrand</td>
</tr>
<tr>
 <td style="text-align: left;">
Maintainer: </td><td style="text-align: left;"> Paul Saary &lt;rtk@paulsaary.de&gt;</td>
</tr>
<tr>
 <td style="text-align: left;">
Description: </td><td style="text-align: left;"> Rarefy data, calculate diversity and plot the results.</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;= 2)</td>
</tr>
<tr>
 <td style="text-align: left;">
Imports: </td><td style="text-align: left;"> Rcpp (&gt;= 0.12.3),methods</td>
</tr>
<tr>
 <td style="text-align: left;">
LinkingTo: </td><td style="text-align: left;"> Rcpp</td>
</tr>
<tr>
 <td style="text-align: left;">
SystemRequirements: </td><td style="text-align: left;"> C++11</td>
</tr>
<tr>
 <td style="text-align: left;">
Suggests: </td><td style="text-align: left;"> testthat</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>


<p>Index of help topics:
</p>
<pre>
collectors.curve        collectors.curve
get.diversity           get.diversity
plot                    Plot rarfeaction results
rtk                     Rarefy tables
rtk-package             Rarefaction Tool Kit
</pre>
<p>This package might be used to rarefy data and compute diversity measures. Rarefied tables can be returned to R and be further processed.
</p>


<h3>Author(s)</h3>

<p>Paul Saary, Falk Hildebrand
</p>
<p>Maintainer: Paul Saary &lt;rtk@paulsaary.de&gt;
</p>


<h3>References</h3>

<p>Saary, Paul, et al. &quot;RTK: efficient rarefaction analysis of large datasets.&quot; Bioinformatics (2017): btx206.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rtk">rtk</a></code>, <code><a href="#topic+plot.rtk">plot.rtk</a></code>, <code><a href="#topic+collectors.curve">collectors.curve</a>
</code>
</p>

<hr>
<h2 id='collectors.curve'>collectors.curve</h2><span id='topic+collectors.curve'></span>

<h3>Description</h3>

<p> Collectorscurves visualize the richness gained by picking more samples.</p>


<h3>Usage</h3>

<pre><code class='language-R'>	collectors.curve(x, y = NULL, col = 1, times = 10, bin = 3, add = FALSE, 
	                 ylim = NULL, xlim = NULL, doPlot = TRUE, rareD = NULL, 
	                 cls = NULL, pch = 20, col2 = NULL, accumOrder = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="collectors.curve_+3A_x">x</code></td>
<td>
<p>Input a rarefaction object with one matrix and one depth or dataframe/matrix or the output of collectors.curve itself</p>
</td></tr>
<tr><td><code id="collectors.curve_+3A_y">y</code></td>
<td>
<p>secondary input matrix for comparative plots</p>
</td></tr>
<tr><td><code id="collectors.curve_+3A_col">col</code></td>
<td>
<p>fill color of the boxplots (set to c(0) for no color)</p>
</td></tr>
<tr><td><code id="collectors.curve_+3A_times">times</code></td>
<td>
<p>Number of times the sampeling of samples should be perfomed</p>
</td></tr>
<tr><td><code id="collectors.curve_+3A_bin">bin</code></td>
<td>
<p>Number of samples to be added each step. Usefull to adjust for a quick glance.</p>
</td></tr>
<tr><td><code id="collectors.curve_+3A_add">add</code></td>
<td>
<p>add the plot to an existing plot?</p>
</td></tr>
<tr><td><code id="collectors.curve_+3A_ylim">ylim</code></td>
<td>
<p>Limits for Y-scale</p>
</td></tr>
<tr><td><code id="collectors.curve_+3A_xlim">xlim</code></td>
<td>
<p>Limits for X-scale</p>
</td></tr>
<tr><td><code id="collectors.curve_+3A_doplot">doPlot</code></td>
<td>
<p>should this function plot the collectors curve, or just return an object that can be plotted later with this function?</p>
</td></tr>
<tr><td><code id="collectors.curve_+3A_rared">rareD</code></td>
<td>
<p>Depth to which rarefy the dataset using rtk</p>
</td></tr>
<tr><td><code id="collectors.curve_+3A_cls">cls</code></td>
<td>
<p>vector describing the class of each input sample</p>
</td></tr>
<tr><td><code id="collectors.curve_+3A_pch">pch</code></td>
<td>
<p>Plotting symbols</p>
</td></tr>
<tr><td><code id="collectors.curve_+3A_col2">col2</code></td>
<td>
<p>Color for the border of the boxplot, defaults to col</p>
</td></tr>
<tr><td><code id="collectors.curve_+3A_accumorder">accumOrder</code></td>
<td>
<p>accumulate successively within each class, given by cls in the order given in this vector. All classes in cls must be represented in this vector.</p>
</td></tr>
<tr><td><code id="collectors.curve_+3A_...">...</code></td>
<td>
<p>Options passed to plot or boxplot </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>collectors.curve</code> can visualize the richness a dataset has, if sampels are picked at random. It can handle rareafaction results as well as normal dataframes.
</p>


<h3>Author(s)</h3>

<p>Falk Hildebrand, Paul Saary</p>


<h3>References</h3>

<p>Saary, Paul, et al. &quot;RTK: efficient rarefaction analysis of large datasets.&quot; Bioinformatics (2017): btx206.
</p>


<h3>See Also</h3>

<p>Use <code><a href="#topic+plot.rtk">plot.rtk</a></code> for how to plot your results.</p>


<h3>Examples</h3>

<pre><code class='language-R'>require("rtk")
# Collectors Curve dataset should be broad and contain many samples (columns)
data       &lt;- matrix(sample(x = c(rep(0, 15000),rep(1:10, 100)),
                     size = 10000, replace = TRUE), ncol = 80)
data.r     &lt;- rtk(data, ReturnMatrix = 1, depth = min(colSums(data)))
# collectors curve on dataframe/matrix
collectors.curve(data, xlab = "No. of samples", ylab = "richness")
# same with rarefaction results (one matrix recommended)
collectors.curve(data.r, xlab = "No. of samples (rarefied data)", ylab = "richness")

# if you want to have an accumulated order, t compare various studies to one another:
cls          &lt;- rep_len(c("a","b","c","d"), ncol(data))  # study origin of each sample
accumOrder   &lt;- c("b","a","d","c")      # define the order, for the plot
colors       &lt;- c(1,2,3,4)
names(colors) &lt;- accumOrder # names used for legend
collectors.curve(data, xlab = "No. of samples",
                 ylab = "richness", col = colors, bin = 1,cls = cls, 
                 accumOrder = accumOrder)

</code></pre>

<hr>
<h2 id='get.diversity'>get.diversity</h2><span id='topic+get.diversity'></span><span id='topic+get.mean.diversity'></span><span id='topic+get.median.diversity'></span>

<h3>Description</h3>

<p> Collectorscurves visualize the richness gained by picking more samples.</p>


<h3>Usage</h3>

<pre><code class='language-R'>	get.diversity(obj, div = "richness", multi = FALSE)
	get.mean.diversity(obj, div = "richness")
	get.median.diversity(obj, div = "richness")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get.diversity_+3A_obj">obj</code></td>
<td>
<p>Object of type rtk</p>
</td></tr>
<tr><td><code id="get.diversity_+3A_div">div</code></td>
<td>
<p>diversity measure as string e.g &quot;richness&quot;</p>
</td></tr>
<tr><td><code id="get.diversity_+3A_multi">multi</code></td>
<td>
<p>Argument set to true if called recursivly and class should not be checked. Should not be set in normal use case.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This set of functions allows fast and easy access to calculated diversity measures by rtk.
It returns a matrix, when rarefaction was only performed to one
depth and a list of matrices or vectors if rarefaction was done for multiple depths.
</p>


<h3>Author(s)</h3>

<p>Falk Hildebrand, Paul Saary</p>


<h3>References</h3>

<p>Saary, Paul, et al. &quot;RTK: efficient rarefaction analysis of large datasets.&quot; Bioinformatics (2017): btx206.	
</p>


<h3>See Also</h3>

<p>Use <code><a href="stats.html#topic+rt">rt</a></code> before calling this function.</p>


<h3>Examples</h3>

<pre><code class='language-R'>require("rtk")
# Collectors Curve dataset should be broad and contain many samples (columns)
data            &lt;- matrix(sample(x = c(rep(0, 15000), rep(1:10, 100)),
                          size = 10000, replace = TRUE), ncol = 80)
data.r 			&lt;- rtk(data, depth = min(colSums(data)))
get.diversity(data.r)
get.median.diversity(data.r)
get.mean.diversity(data.r)
</code></pre>

<hr>
<h2 id='plot'>Plot rarfeaction results</h2><span id='topic+rarefactioncurve'></span><span id='topic+plot'></span><span id='topic+plot.rtk'></span>

<h3>Description</h3>

<p> Rarefy datasets in R or from a path. </p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rtk'
plot(x, div = c("richness"),  groups = NA, col = NULL, lty = 1,
         pch = NA, fit = "arrhenius", legend = TRUE, legend.pos = "topleft",
         log.dim = "", boxplot = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_+3A_x">x</code></td>
<td>
<p>a rare result object</p>
</td></tr>
<tr><td><code id="plot_+3A_div">div</code></td>
<td>
<p>Diversity measure to plot. Can be any of <code>c('richness', 'shannon', 'simpson', 'invsimpson', 'chao1', 'eve')</code></p>
</td></tr>
<tr><td><code id="plot_+3A_groups">groups</code></td>
<td>
<p>If grouping is desired a vector of factors corresponting to the input samples</p>
</td></tr>
<tr><td><code id="plot_+3A_col">col</code></td>
<td>
<p>Colors used for plotting. Can be a vector of any length which will be recycled if it is to small. By default a rainbow is used.</p>
</td></tr>
<tr><td><code id="plot_+3A_lty">lty</code></td>
<td>
<p>Linetypes used for plotting. Can be a vector of any length which will be recycled if it is to small.</p>
</td></tr>
<tr><td><code id="plot_+3A_pch">pch</code></td>
<td>
<p>Symbols used for plotting. Can be a vector of any length which will be recycled if it is to small.</p>
</td></tr>
<tr><td><code id="plot_+3A_fit">fit</code></td>
<td>
<p>Fit the rarefaction curve. Possible values: <code>c("arrhenius", "michaelis-menten", "logis")</code></p>
</td></tr>
<tr><td><code id="plot_+3A_legend">legend</code></td>
<td>
<p>Logical indicating if a legend should be created or not</p>
</td></tr>
<tr><td><code id="plot_+3A_legend.pos">legend.pos</code></td>
<td>
<p>Position of the said legend</p>
</td></tr>
<tr><td><code id="plot_+3A_log.dim">log.dim</code></td>
<td>
<p>Character vector indicating which scale log log transform for plotting rarefaction curves.</p>
</td></tr>
<tr><td><code id="plot_+3A_boxplot">boxplot</code></td>
<td>
<p>If a boxplot should be added to the lineplot of the rarefaction curve.</p>
</td></tr>
<tr><td><code id="plot_+3A_...">...</code></td>
<td>
<p>Other plotting input will be passed to <code>plot</code> or <code>boxplot</code> repectivly</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To create plots from the rarefaction results you can easily just call a plot on the resulting elements. This will either produce a rarefaction curve, if mor than one depth was rarefied to, or a boxplot for a single depth. Grouping of samples is possible by simply passing a vetor of the length of the samples to the option <code>groups</code>.
</p>
<p>Rarefaction curves can be fittet to either the arrhenius-equation, the michaelis-menten (<a href="stats.html#topic+SSmicmen">SSmicmen</a>) equation or the logis function <a href="stats.html#topic+SSlogis">SSlogis</a>. To disable fitting <code>fit</code> must be set to <code>FALSE</code>.
</p>


<h3>Author(s)</h3>

<p>Falk Hildebrand, Paul Saary</p>


<h3>References</h3>

<p>Saary, Paul, et al. &quot;RTK: efficient rarefaction analysis of large datasets.&quot; Bioinformatics (2017): btx206.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rtk">rtk</a></code>, <code><a href="#topic+collectors.curve">collectors.curve</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>require("rtk")
# generate semi sparse example data
data            &lt;- matrix(sample(x = c(rep(0, 1500),rep(1:10, 500),1:1000),
                          size = 120, replace = TRUE), 40)
# find the column with the lowest aboundance
samplesize      &lt;- min(colSums(data))
# rarefy the dataset, so each column contains the same number of samples
d1  &lt;- rtk(input = data, depth = samplesize)
# rarefy to different depths between 1 and samplesize
d2  &lt;- rtk(input = data, depth = round(seq(1, samplesize, length.out = 10)))

# just the richness of all three samples as boxplot
plot(d1, div = "richness")
#rarefaction curve for each sample with fit
plot(d2, div = "eveness", fit = "arrhenius", pch = c(1,2,3))
# Rarefaction curve with boxplot, sampels pooled together (grouped)
plot(d2, div = "richness", fit = FALSE, boxplot = TRUE, col = 1, groups = rep(1, ncol(data)))

</code></pre>

<hr>
<h2 id='rtk'>Rarefy tables</h2><span id='topic+rtk'></span>

<h3>Description</h3>

<p> Rarefy datasets in R or from a path. </p>


<h3>Usage</h3>

<pre><code class='language-R'>rtk(input, repeats = 10, depth = 1000, ReturnMatrix = 0, margin = 2,
    verbose = FALSE, threads = 1, tmpdir = NULL, seed = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rtk_+3A_input">input</code></td>
<td>
<p>This can be either a numeric matrix or a path to a text file in tab-delimited format on the locally available storage. The later option is for very big matrices, to avoid unnecessary memory consumption in R.</p>
</td></tr>
<tr><td><code id="rtk_+3A_repeats">repeats</code></td>
<td>
<p>Number of times to compute diversity measures. (<code>default: 10</code>)</p>
</td></tr>
<tr><td><code id="rtk_+3A_depth">depth</code></td>
<td>
<p>Number of elements per row/column to rarefy to. The so called rarefaction depth or samplesize. Can also be a vector of ints. (<code>default: 1000</code>)</p>
</td></tr>
<tr><td><code id="rtk_+3A_returnmatrix">ReturnMatrix</code></td>
<td>
<p>Number of rarefied matrices which are returned to R. Set to zero to only measure diversity. (<code>default: 1</code>)</p>
</td></tr>
<tr><td><code id="rtk_+3A_margin">margin</code></td>
<td>
<p>Indicates which margin in the matrix represents the Samples and Species. Default is to rarefy assuming columns represent single samples (margin=2). If margin=1, rows are assumed to be samples. (default: 2 (columns))</p>
</td></tr>
<tr><td><code id="rtk_+3A_verbose">verbose</code></td>
<td>
<p>If extra output should be printed to std::out or not to see progress of rarefaction. (<code>default: TRUE)</code></p>
</td></tr>
<tr><td><code id="rtk_+3A_threads">threads</code></td>
<td>
<p>Number of threads to use during rarefaction</p>
</td></tr>
<tr><td><code id="rtk_+3A_tmpdir">tmpdir</code></td>
<td>
<p>Location to store temporary files</p>
</td></tr>
<tr><td><code id="rtk_+3A_seed">seed</code></td>
<td>
<p>Set seed to integer &gt; 0 to get reproducible results. <code>default: 0</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function <code>rare</code> takes a dataset and calcualtes the diversity measures, namely the shannon diversity, richness, simpson index, the inverse simpson index, chao1 and evenness.
</p>
<p>If wished for the function can also return one or multiple rarefied matrices rarefied to one or multiple depths. Those can then also be used to create collectorcurves (see <code><a href="#topic+collectors.curve">collectors.curve</a></code>).
</p>


<h3>Value</h3>

<p>The function <code>rare</code> returns an object of class 'rarefaction',  containing the  objects <code>divvs</code>, <code>raremat</code>, <code>skipped</code>, <code>div.median</code> and <code>depths</code>. If more than one depth was computed the elements 1-4 are inside a list themself and can be acessed by the index of the desired depth.
</p>
<p>The object <code>divvs</code> contains a list of diversity measures for each sample provieded.
</p>
<p><code>raremat</code> is one or multiple rarefied matrices. Samples with not enough counts are removed, thus not all <code>raremat</code>-matrices for different depths might be of the same size. If and which sampels where excluded is denoted in the element <code>skipped</code> using the names of the respective samples.
</p>
<p><code>depths</code> just contains the input variable and might be usefull for further analysis of the results.
</p>
<p>It is possible to plot the results of the rarefaction, depending on the parameters passed to <code>rare</code>. See <code><a href="#topic+plot.rtk">plot.rtk</a></code> for examples.
</p>


<h3>Author(s)</h3>

<p>Paul Saary, Falk Hildebrand</p>


<h3>References</h3>

<p>Saary, Paul, et al. &quot;RTK: efficient rarefaction analysis of large datasets.&quot; 
Bioinformatics (2017): btx206.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.rtk">plot.rtk</a></code>, <code><a href="#topic+collectors.curve">collectors.curve</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>require("rtk")
# generate semi sparse example data
data            &lt;- matrix(sample(x = c(rep(0, 1500),rep(1:10, 500),1:1000),
                          size = 120, replace = TRUE), 10)
# find the column with the lowest aboundance
samplesize      &lt;- min(colSums(data))
# rarefy the dataset, so each column contains the same number of samples
data.rarefied   &lt;- rtk(input = data, depth = samplesize, ReturnMatrix = 1)

richness   &lt;- get.diversity(data.rarefied, div = "richness")
eveness    &lt;- get.diversity(data.rarefied, div = "eveness")

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
