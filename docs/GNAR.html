<!DOCTYPE html><html lang="en"><head><title>Help for package GNAR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {GNAR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#active_node_plot'><p>Produces an active node matrix heat-map.</p></a></li>
<li><a href='#AIC.GNARfit'>
<p>Akaike's Information Criterion for GNAR models</p></a></li>
<li><a href='#as.matrix.GNARnet'><p>Converts a GNAR networks into a weighted adjacency matrix</p></a></li>
<li><a href='#BIC.GNARfit'>
<p>Bayesian Information Criterion for GNAR models</p></a></li>
<li><a href='#coef.GNARfit'><p>Function to return coefficients of GNARfit objects</p></a></li>
<li><a href='#corbit_plot'><p>Corbit (correlation-orbit) plot, which aids model selection by visualising network autocorrelation and partial network autocorrelation.</p></a></li>
<li><a href='#fitted.GNARfit'><p>Function to return fitted values of GNARfit objects</p></a></li>
<li><a href='#fiveNode'>
<p>Example Network Time Series</p></a></li>
<li><a href='#gdpVTS'><p>Differenced GDP values for 35 countries</p></a></li>
<li><a href='#get_k_stages_adjacency_tensor'><p>Computes a list of r-stage adjacency matrices.</p></a></li>
<li><a href='#GNAR'><p>GNAR package</p></a></li>
<li><a href='#GNARdesign'><p>Function to create the GNAR design matrix</p></a></li>
<li><a href='#GNARfit'><p>Fitting function for GNAR models</p></a></li>
<li><a href='#GNARsim'><p>Simulates a GNAR process</p></a></li>
<li><a href='#GNARtoigraph'><p>Converts a GNAR network to a weighted igraph object</p></a></li>
<li><a href='#GNARXdesign'><p>Function to create the GNARX design matrix</p></a></li>
<li><a href='#GNARXfit'><p>Fitting function for GNARX models</p></a></li>
<li><a href='#GNARXsim'><p>Simulates a GNARX process</p></a></li>
<li><a href='#igraphtoGNAR'><p>Converts an igraph to GNAR network</p></a></li>
<li><a href='#is.GNARfit'><p>Function to check GNARfit objects</p></a></li>
<li><a href='#is.GNARnet'><p>Functions to check and create GNARnet objects</p></a></li>
<li><a href='#local_relevance_plot'><p>Produces a local neighbourhood relevance plot based on the distances in the underlying network.</p></a></li>
<li><a href='#logLik.GNARfit'>
<p>Log-likelihood method for GNARfit objects</p></a></li>
<li><a href='#logMVbedMVC.vts'><p>Number of COVID19 admission to mechanical ventilation beds</p></a></li>
<li><a href='#matrixtoGNAR'><p>Converts an adjacency matrix to GNAR network</p></a></li>
<li><a href='#na.row'><p>Identifies which rows of a matrix have NAs</p></a></li>
<li><a href='#nacf'><p>Computes the Network Autocorrelation Function (NACF)</p></a></li>
<li><a href='#NHSTrustMVCAug120.net'><p>Constructed network linking 140 NHS Trusts in England and Wales</p></a></li>
<li><a href='#nobs.GNARfit'>
<p>Function to return the number of observations input to GNARfit objects</p></a></li>
<li><a href='#node_relevance_plot'><p>Produces a node relevance plot, which compares the impact each node has on the network autocorrelation once a model order has been chosen.</p></a></li>
<li><a href='#NofNeighbours'><p>Calculates stage-neighbours of a network</p></a></li>
<li><a href='#plot.GNARnet'><p>Plot function for GNAR networks</p></a></li>
<li><a href='#pnacf'><p>Computes the Partial Network Autocorrelation Function (PNACF)</p></a></li>
<li><a href='#predict.GNARfit'>
<p>Prediction of a GNARfit object</p></a></li>
<li><a href='#print.GNARfit'><p>Function to print the model and coefficients of GNARfit objects</p></a></li>
<li><a href='#print.GNARnet'><p>Print function for GNAR networks</p></a></li>
<li><a href='#r_corbit_plot'><p>Produces a R-Corbit plot for the specified choice of covariate-levels and/or time-slices.</p></a></li>
<li><a href='#residToMat'><p>Converts the output of a GNARfit call to fitted and residual value matrices</p></a></li>
<li><a href='#residuals.GNARfit'><p>Function to return residuals of GNARfit objects</p></a></li>
<li><a href='#seed.nos'><p>Vector of seed numbers</p></a></li>
<li><a href='#seedToNet'><p>Produces a random network from a seed value</p></a></li>
<li><a href='#simulate.GNARfit'>
<p>Function to simulate from a GNARfit object</p></a></li>
<li><a href='#summary.GNARfit'><p>Returns model summary for a GNAR model fit</p></a></li>
<li><a href='#summary.GNARnet'><p>Summary function for GNAR networks</p></a></li>
<li><a href='#vcov.GNARfit'>
<p>Calculate variance-covariance matrix for a itted GNARfit object</p></a></li>
<li><a href='#vswind'>
<p>Wind Speed example network time series</p></a></li>
<li><a href='#weights_matrix'><p>Computes the weights matrix corresponding to the GNAR network object linked to the vector time series.</p></a></li>
<li><a href='#windnetplot'><p>Produce bespoke plot of the wind data network</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Methods for Fitting Network Time Series Models</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.4</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-09-23</td>
</tr>
<tr>
<td>Author:</td>
<td>Kathryn Leeming [aut],
  Guy Nason [aut],
  Matt Nunes [aut, cre],
  Marina Knight [ctb],
  James Wei [aut],
  Daniel Salnikov [aut],
  Mario Cortina Borja [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Matt Nunes &lt;nunesrpackages@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Simulation of, and fitting models for, Generalised Network Autoregressive (GNAR) time series models which take account of network structure, potentially with exogenous variables.  Such models are described in Knight et al. (2020) &lt;<a href="https://doi.org/10.18637%2Fjss.v096.i05">doi:10.18637/jss.v096.i05</a>&gt; and Nason and Wei (2021) &lt;<a href="https://doi.org/10.1111%2Frssa.12875">doi:10.1111/rssa.12875</a>&gt;.  Diagnostic tools for GNAR(X) models can be found in Nason et al. (2023) &lt;<a href="https://doi.org/10.48550%2FarXiv.2312.00530">doi:10.48550/arXiv.2312.00530</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R(&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>ggforce, ggplot2, ggpubr, grid, igraph, matrixcalc, rlang,
stats, viridis, wordcloud</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-10-02 06:00:06 UTC; man54</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-10-02 06:40:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='active_node_plot'>Produces an active node matrix heat-map.
</h2><span id='topic+active_node_plot'></span>

<h3>Description</h3>

<p>Produces an active node matrix heat-map, which compares the local impact each node has on all the other ones (i.e., regressing <code class="reqn">j</code> on <code class="reqn">i</code>) once a model order has been chosen. The local relevance indes is 
<code class="reqn">\mathrm{local} (i, j) := \bigg ( w_{ij} \sum_{k = 1}^{p} |\hat{\beta}_{kr}| \bigg ) \bigg \{ \sum_{l \in \mathcal{N} (i)} \sum_{r = 1}^{r^*} \sum_{k = 1}^{p}  w_{il} |\hat{\beta}_{kr}| \bigg) \bigg \}^{-1},</code>
which is closer to one the more relevant <code class="reqn">j</code> is when forecasting <code class="reqn">i</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  active_node_plot(vts, network, max_lag, r_stages)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="active_node_plot_+3A_vts">vts</code></td>
<td>
<p>Vector time series under study.</p>
</td></tr>
<tr><td><code id="active_node_plot_+3A_network">network</code></td>
<td>
<p>GNAR network object, which is the underlying network for the time series under study.</p>
</td></tr>
<tr><td><code id="active_node_plot_+3A_max_lag">max_lag</code></td>
<td>
<p>Maximum lag of the fitted GNAR model - i.e., <code class="reqn">\mathrm{GNAR}(p, [s_1, \dots, s_p]).</code></p>
</td></tr>
<tr><td><code id="active_node_plot_+3A_r_stages">r_stages</code></td>
<td>
<p>Neighbourhood regression oreder of the fitted GNAR model - i.e., <code class="reqn">(s_1, \dots, s_p)</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Produces the local influence matrix heat-map for a specific model order. Does not return any values.
</p>


<h3>Author(s)</h3>

<p>Daniel Salnikov and Guy Nason
</p>


<h3>References</h3>

<p>Nason, G.P., Salnikov, D. and Cortina-Borja, M. (2023)
New tools for network time series with an application to COVID-19
hospitalisations. <a href="https://arxiv.org/abs/2312.00530">https://arxiv.org/abs/2312.00530</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#
# Produces an active node heat-map matrix from a stationary GNAR(2, [2, 1]) simulation.
#
gnar_simulation &lt;- GNARsim(n = 100, net=fiveNet,
	alphaParams = list(rep(0.25, 5), rep(0.12, 5)), 
        betaParams = list(c(0.25, 0.13), c(0.20)), sigma=1)
#
# Active node plot
#
active_node_plot(gnar_simulation, fiveNet, 2, c(2, 1))
</code></pre>

<hr>
<h2 id='AIC.GNARfit'>
Akaike's Information Criterion for GNAR models
</h2><span id='topic+AIC.GNARfit'></span>

<h3>Description</h3>

<p>Function calculating AIC for <code>GNARfit</code> models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'GNARfit'
AIC(object, ..., k=2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AIC.GNARfit_+3A_object">object</code></td>
<td>
<p>a <code>GNARfit</code> object, output from a <a href="#topic+GNARfit">GNARfit</a> call.</p>
</td></tr>
<tr><td><code id="AIC.GNARfit_+3A_...">...</code></td>
<td>
<p>additional arguments, not used here.</p>
</td></tr>
<tr><td><code id="AIC.GNARfit_+3A_k">k</code></td>
<td>
<p>the penalty for the criterion, the default <code>k = 2</code> is the standard AIC.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Smaller AIC values correspond to better fit.
</p>


<h3>Value</h3>

<p>A numeric value corresponding to the <code>AIC</code> (or other criterion if <code>k</code> is set to something other than <code>2</code>).  Note that the value returned is the &ldquo;time-normalised&rdquo; AIC for the GNAR model, and also removes any proportionality constants in the calculation.
</p>


<h3>Note</h3>

<p>Occasionally it has been observed that when the forecast horizon has been set too high, this can result in <code>NA</code> AIC values.  This can be resolved by reducing the forecast horizon. 
If package users find this problem persists or they experience any other unexpected behaviour, please contact the package maintainer.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#AIC for two different GNAR fits for fiveNet data
#GNAR(2,[1,1])
AIC(GNARfit())
#GNAR(2,[1,0])
AIC(GNARfit(betaOrder=c(1,0)))
</code></pre>

<hr>
<h2 id='as.matrix.GNARnet'>Converts a GNAR networks into a weighted adjacency matrix</h2><span id='topic+as.matrix.GNARnet'></span>

<h3>Description</h3>

<p>Takes an input GNARnet and neighbour stage and outputs the corresponding adjacency matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'GNARnet'
as.matrix(x, stage=1, normalise=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="as.matrix.GNARnet_+3A_x">x</code></td>
<td>
<p>the network <code>GNARnet</code> object associated with the time series, containing a list with entries <code>$edges</code> and <code>$dist</code>.</p>
</td></tr>
<tr><td><code id="as.matrix.GNARnet_+3A_stage">stage</code></td>
<td>
<p>the neighbour set that the adjacency matrix is created for.</p>
</td></tr>
<tr><td><code id="as.matrix.GNARnet_+3A_normalise">normalise</code></td>
<td>
<p>whether to normalise each to non-zero row to have sum one.</p>
</td></tr>
<tr><td><code id="as.matrix.GNARnet_+3A_...">...</code></td>
<td>
<p>additional arguments, unused here.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>S3 method for class &quot;GNARnet&quot;.
</p>
<p>With normalisation this is a non-invertible transform. See <a href="#topic+NofNeighbours">NofNeighbours</a> for neighbour set definition.
</p>


<h3>Value</h3>

<p><code>as.matrix</code> performed on a <code>GNARnet</code> returns a square matrix with the number of rows and columns equal to the length of the <code>$edges</code> list. Entry <code>i,j</code> of the matrix will be non-zero if node <code>j</code> is in the <code>stage</code> neighbour set of <code>i</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#fiveNet as an adjacency matrix
as.matrix(fiveNet)
</code></pre>

<hr>
<h2 id='BIC.GNARfit'>
Bayesian Information Criterion for GNAR models
</h2><span id='topic+BIC.GNARfit'></span>

<h3>Description</h3>

<p>Function calculating BIC for <code>GNARfit</code> models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'GNARfit'
BIC(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BIC.GNARfit_+3A_object">object</code></td>
<td>
<p>a <code>GNARfit</code> object, output from a <a href="#topic+GNARfit">GNARfit</a> call.</p>
</td></tr>
<tr><td><code id="BIC.GNARfit_+3A_...">...</code></td>
<td>
<p>additional arguments, not used here.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Smaller BIC values correspond to better fit.
</p>


<h3>Value</h3>

<p>A numeric value corresponding to the <code>BIC</code>.  Note that this is the &ldquo;time-normalised&rdquo; value of the AIC for the GNAR model, and also removes any proportionality constants in the calculation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#BIC for two different GNAR fits for fiveNet data
#GNAR(2,[1,1])
BIC(GNARfit())
#GNAR(2,[1,0])
BIC(GNARfit(betaOrder=c(1,0)))
</code></pre>

<hr>
<h2 id='coef.GNARfit'>Function to return coefficients of GNARfit objects</h2><span id='topic+coef.GNARfit'></span>

<h3>Description</h3>

<p><code>coef.GNARfit</code> returns the vector of coefficients from a GNARfit object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'GNARfit'
coef(object,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="coef.GNARfit_+3A_object">object</code></td>
<td>
<p>the output of a <a href="#topic+GNARfit">GNARfit</a> call</p>
</td></tr>
<tr><td><code id="coef.GNARfit_+3A_...">...</code></td>
<td>
<p>additional arguments, unused here.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>S3 method for class &quot;GNARfit&quot;.
</p>


<h3>Value</h3>

<p><code>coef.GNARfit</code> returns a vector of coefficient values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#get the coefficients of the fiveNode data GNAR fit
coef(GNARfit())
</code></pre>

<hr>
<h2 id='corbit_plot'>Corbit (correlation-orbit) plot, which aids model selection by visualising network autocorrelation and partial network autocorrelation.
</h2><span id='topic+corbit_plot'></span>

<h3>Description</h3>

<p>Plots the GNAR network autcorrelation funciton for a choice of maximum lag and maximum r-stage depth in the network. Using the <code><a href="#topic+nacf">nacf</a></code> function for network autocorrelation and <code><a href="#topic+pnacf">pnacf</a></code> for partial network autocorrelation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>corbit_plot(vts, net, max_lag, max_stage, weight_matrix, 
viridis_color_option="viridis", size_option="absolute_val", 
partial="no", r_corbit="no", line_segment="no", rectangular_plot="no")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="corbit_plot_+3A_vts">vts</code></td>
<td>
<p>Vector time series observations for which one wishes to plot the network autocorrelation or partial network autocorrelation.
</p>
</td></tr>
<tr><td><code id="corbit_plot_+3A_net">net</code></td>
<td>
<p>GNAR network object linked to the time series under study.</p>
</td></tr>
<tr><td><code id="corbit_plot_+3A_max_lag">max_lag</code></td>
<td>
<p>Maximum lag the Corbit plot produces (i.e., number of time-steps considered for the network autocorrelaiton.)</p>
</td></tr>
<tr><td><code id="corbit_plot_+3A_max_stage">max_stage</code></td>
<td>
<p>Maximum r-stage depth considered for the Corbit plot (i.e., the number of rings in the plot). Corresponds to the length of paths in the underlying network.</p>
</td></tr>
<tr><td><code id="corbit_plot_+3A_weight_matrix">weight_matrix</code></td>
<td>
<p>A matrix which entries correspond to the weights between nodes. If this term is NULL, then this argument is equal weights between r-stage neighbours.</p>
</td></tr>
<tr><td><code id="corbit_plot_+3A_viridis_color_option">viridis_color_option</code></td>
<td>
<p>Colour scale for the Corbit plot. The default option is <code>viridis</code>, each option is colout blind friendly; see <code>viridis</code> package.</p>
</td></tr>
<tr><td><code id="corbit_plot_+3A_size_option">size_option</code></td>
<td>
<p>Point size scale for the Corbit plot. The default is the absolute value of the network autocorrelation function (i.e., <code>|nacf(h, r)|</code> or  <code>|pnacf(h, r)|)</code>. Alternate option is the coefficient of determination coming from a global-<code class="reqn">\alpha</code> model with fixed lag and stage.</p>
</td></tr>
<tr><td><code id="corbit_plot_+3A_partial">partial</code></td>
<td>
<p>Option for selecting between computing the network autocorrelation function or the partial network autocorrelation funciton. Default choice is network autocorrelation (i.e., partial=&quot;no&quot;), change argument to &quot;yes&quot; for computing the partial network autocorrelation funciton.</p>
</td></tr>
<tr><td><code id="corbit_plot_+3A_r_corbit">r_corbit</code></td>
<td>
<p>Choice for distinguishing between Corbit and R-Corbit plots, default is set to Corbit (inner function call). For producing R-Corbit plots one should use <code><a href="#topic+r_corbit_plot">r_corbit_plot</a></code>. </p>
</td></tr>
<tr><td><code id="corbit_plot_+3A_line_segment">line_segment</code></td>
<td>
<p>Default is set to no (i.e., <code>line_segment = "no"</code>). Changing the option to yes produces an alternative Corbit plot with a line segment between the first and last lags. </p>
</td></tr>
<tr><td><code id="corbit_plot_+3A_rectangular_plot">rectangular_plot</code></td>
<td>
<p>Option for producing alternative rectangular plots. Default is set to no (i.e., <code>rectangular_plot = "no"</code>). Changing it to yes (i.e., <code>rectangular_plot = "yes"</code>) produces a rectangular plot with (P)NACF values on the y-axis and lags on the x-axis, r-stages are distinguished by colour. Changing it to square (i.e., <code>rectangular_plot = "square"</code>) produces a square plot with r-stages on the y-axis and lags on the x-axis.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function computes network autocorrelation or partial network autocorrelation function values for a specific choice of maximum lag and r-stage depth, and produces the corresponing Corbit plot. Each point in a Corbit plot corresponds to the (P)NACF value, i.e., <code>(p)nacf(h, r)</code>, at a h-lag and r-stage pair. The ring number starting from the inside corresponds to r-stage depth (path length), and the numbers on the outside ring indicate time lag. The colour scale is based on the overall network autocorrelation values (i.e., the colour is set to highlight strong correlations). The dot at the centre has <code>(p)nacf(h, r)=0</code> and the smallest size for aiding comparison. Please see the RMarkdown document mentioned in <code>GNAR</code> references for plot examples.
</p>


<h3>Value</h3>

<p>Produces the specified, i.e, NACF or PNACF for a choice of lag and <code class="reqn">r</code>-stage depth, <code class="reqn">(h, r)</code>, Corbit plot. Does not print (P)NACF values, these are stored as an invisble data frame (matrix), and can be accessed by printing or calling the object produced by the <code>corbit_plot</code> call.
</p>


<h3>Author(s)</h3>

<p>Daniel Salnikov and Guy Nason.
</p>


<h3>References</h3>

<p>Nason, G.P., Salnikov, D. and Cortina-Borja, M. (2023)
New tools for network time series with an application to COVID-19
hospitalisations. <a href="https://arxiv.org/abs/2312.00530">https://arxiv.org/abs/2312.00530</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#
# Simulate 100 observations from a stationary GNAR(2, [2, 1]), where 
# fiveNet is the underlying network.
# 
gnar_simulation &lt;- GNARsim(n = 100, net=fiveNet, alphaParams = list(rep(0.25, 5), rep(0.12, 5)), 
        betaParams = list(c(0.25, 0.13), c(0.20)), sigma=1)
# We produce the corresponding Corbit plots.
corbit_plot(gnar_simulation, fiveNet, 20, 3)
corbit_plot(gnar_simulation, fiveNet, 20, 3, partial = "yes")

# If the network object comes with its own weights, then these can be added by including 
# the option weight_matrix in the corbit call.
# corbit_plot(vts, net, max_lag, max_stage, weight_matrix = object_weights_matrix)
</code></pre>

<hr>
<h2 id='fitted.GNARfit'>Function to return fitted values of GNARfit objects</h2><span id='topic+fitted.GNARfit'></span>

<h3>Description</h3>

<p><code>fitted.GNARfit</code> returns the fitted values of a GNARfit object as a matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'GNARfit'
fitted(object,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fitted.GNARfit_+3A_object">object</code></td>
<td>
<p>the output of a <a href="#topic+GNARfit">GNARfit</a> call</p>
</td></tr>
<tr><td><code id="fitted.GNARfit_+3A_...">...</code></td>
<td>
<p>additional arguments, unused here.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>S3 method for class &quot;GNARfit&quot;.
</p>


<h3>Value</h3>

<p><code>fitted.GNARfit</code> returns a <a href="stats.html#topic+ts">ts</a> object of fitted values, with <code>t-alphaOrder</code> rows and <code>nnodes</code> columns.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#get the fitted values of the fiveNode GNAR fit
fitted(GNARfit())
</code></pre>

<hr>
<h2 id='fiveNode'>
Example Network Time Series
</h2><span id='topic+fiveNode'></span><span id='topic+fiveVTS'></span><span id='topic+fiveNet'></span>

<h3>Description</h3>

<p>A multivariate time series <code>fiveVTS</code> and corresponding network <code>fiveNet</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("fiveNode")</code></pre>


<h3>Format</h3>

<p> This dataset contains two R objects:<br />
<code>fiveVTS</code> is a <a href="stats.html#topic+ts">ts</a> object with a matrix of 200 rows (t=200) and 5 columns (n=5)
<code>fiveNet</code> is a GNARnet object containing <code>$edges</code> and <code>$dist</code>. <br />
<code>edges</code> is a list of length five, with <code>edges[[i]]</code> containing the vertices that node i is connected to. <br />
<code>dist</code> is a list of length five, with <code>dist[[i]]</code> containing the length of the vertices that node i is connected to.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plot(fiveNet)
image(fiveVTS)
</code></pre>

<hr>
<h2 id='gdpVTS'>Differenced GDP values for 35 countries</h2><span id='topic+gdpVTS'></span>

<h3>Description</h3>

<p>This dataset is from the OECD (OECD (2018), Quarterly GDP (indicator). &lt;doi:10.1787/b86d1fc8-en&gt; (Accessed on 29 January 2018)) and is differenced annual growth rate for 35 countries for 1962-2013.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gdpVTS
</code></pre>


<h3>Format</h3>

<p><code>gdpVTS</code> is a <a href="stats.html#topic+ts">ts</a> object with a matrix of 52 rows (t=52) and 35 columns (n=35)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Plot using 'ts' S3 function, can only plot up to 10 columns at once
plot(gdpVTS[,1:5])

#Plot as heatmap
image(gdpVTS)
</code></pre>

<hr>
<h2 id='get_k_stages_adjacency_tensor'>Computes a list of r-stage adjacency matrices.
</h2><span id='topic+get_k_stages_adjacency_tensor'></span>

<h3>Description</h3>

<p>Computes a list of r-stage adjacency matrices, each matrix in the list inidicates whether or not nodes <code class="reqn">i</code> and <code class="reqn">j</code> are r-stage neighbours in the underlying network. Essentially <code class="reqn">[\mathbf{S}_r]_{ij} = 1 </code> if and only if <code class="reqn">d(i, j) = r</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  get_k_stages_adjacency_tensor(St_1, r)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_k_stages_adjacency_tensor_+3A_st_1">St_1</code></td>
<td>
<p>One-stage adjacency matrix (i.e., the adjacency matrix of the underlying network).</p>
</td></tr>
<tr><td><code id="get_k_stages_adjacency_tensor_+3A_r">r</code></td>
<td>
<p>Maximum r-stage for which one wishes to compute the r-stage adjacency matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List containing the adjacency matrices in ascending order.
</p>
<table role = "presentation">
<tr><td><code>\eqn{ \{ \mathbf{S}_q \}_{q=1}^{q = r} }</code></td>
<td>
<p>Each entry is the r-stage adjacency matrix at depth <code class="reqn">r</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Daniel Salnikov and Guy Nason
</p>


<h3>References</h3>

<p>Nason, G.P., Salnikov, D. and Cortina-Borja, M. (2023)
New tools for network time series with an application to COVID-19
hospitalisations. <a href="https://arxiv.org/abs/2312.00530">https://arxiv.org/abs/2312.00530</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#
# Produce the r-stage adjacency tensors for the fiveNet network.
#
get_k_stages_adjacency_tensor(as.matrix(GNARtoigraph(fiveNet)), 3)
#
</code></pre>

<hr>
<h2 id='GNAR'>GNAR package</h2><span id='topic+GNAR'></span>

<h3>Description</h3>

<p>A package to fit, predict, and simulate time series using the Generalised Network AutoRegressive (GNAR) model, potentially with exogenous variables. The main functions are <a href="#topic+GNARfit">GNARfit</a> and <a href="#topic+GNARXfit">GNARXfit</a>, which fits the model to a time series and network(s), S3 method <a href="#topic+predict.GNARfit">predict.GNARfit</a> which predicts from a fitted GNAR model, and <a href="#topic+GNARsim">GNARsim</a> which simulates from a GNAR model with specified parameters. For details of the model, see <a href="#topic+GNARfit">GNARfit</a>. The package also contains an example network time series in data file <a href="#topic+fiveNode">fiveNode</a>, with network <a href="#topic+fiveNet">fiveNet</a>, and simulated time series <a href="#topic+fiveVTS">fiveVTS</a>.</p>


<h3>References</h3>

<p>Knight, M.I., Nunes, M.A. and Nason, G.P. (2015) Modelling, detrending and decorrelation of network time series. <a href="https://arxiv.org/abs/1603.03221">arXiv preprint</a>.<br /><br />
Knight, M.I., Leeming, K., Nason, G.P. and Nunes, M. A. (2020) Generalised Network Autoregressive Processes and the GNAR package. <em>Journal of Statistical Software</em>, <b>96</b> (5), 1&ndash;36.<br /><br />
Nason G.P. and Wei J. (2022) Quantifying the economic response to COVID-19 mitigations and death rates via forecasting Purchasing Managers’ Indices using Generalised Network Autoregressive models with exogenous variables. <em>Journal of the Royal Statistical Society Series A</em>, <b>185</b> (4), 1778&ndash;1792.
</p>

<hr>
<h2 id='GNARdesign'>Function to create the GNAR design matrix</h2><span id='topic+GNARdesign'></span>

<h3>Description</h3>

<p>Creates the design matrix necessary for fitting the GNAR model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GNARdesign(vts = GNAR::fiveVTS, net = GNAR::fiveNet, alphaOrder = 2, betaOrder = c(1,1),
 fact.var = NULL, globalalpha=TRUE, tvnets=NULL, netsstart=NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GNARdesign_+3A_vts">vts</code></td>
<td>
<p>a matrix or <a href="stats.html#topic+ts">ts</a> object containing the multivariate time series to be modelled. The <code>i,j</code> entry of this matrix should be for time <code>i</code> and vertex/node <code>j</code>.</p>
</td></tr>
<tr><td><code id="GNARdesign_+3A_net">net</code></td>
<td>
<p>the (first) network associated with the time series, containing a list with entries <code>$edges</code> and <code>$dist</code>. This network should have the same number of nodes as the number of columns of the <code>vts</code> matrix.</p>
</td></tr>
<tr><td><code id="GNARdesign_+3A_alphaorder">alphaOrder</code></td>
<td>
<p>a non-negative integer specifying the maximum time-lag to model.</p>
</td></tr>
<tr><td><code id="GNARdesign_+3A_betaorder">betaOrder</code></td>
<td>
<p>a vector of length <code>alphaOrder</code> specifying the maximum neighbour set to model at each of the time-lags.</p>
</td></tr>
<tr><td><code id="GNARdesign_+3A_fact.var">fact.var</code></td>
<td>
<p>a vector of factors indicating which nodes belong to each set with different parameters to be fitted.</p>
</td></tr>
<tr><td><code id="GNARdesign_+3A_globalalpha">globalalpha</code></td>
<td>
<p>a TRUE/FALSE value indivating whether to use global alpha parameters.</p>
</td></tr>
<tr><td><code id="GNARdesign_+3A_tvnets">tvnets</code></td>
<td>
<p>a list of additional networks. Currently only NULL (the static network case) is supported.</p>
</td></tr>
<tr><td><code id="GNARdesign_+3A_netsstart">netsstart</code></td>
<td>
<p>a vector of times corresponding to the first time points for each network of <code>tvnets</code>. Currently only NULL (the static network case) is supported.</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>GNARdesign</code></td>
<td>
<p>returns a matrix containing <code>(t-alphaOrder)nnodes</code> rows and a column for each parameter to be fitted. The columns are in time-lag order, eg for GNAR(2,[1,0]) the columns are <code>alpha1</code>, <code>beta1.1</code>, <code>alpha2</code>. When a factor variable is specified the columns are labelled with the factor.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>#Design matrix to fit GNAR(2,[1,1]) to the fiveVTS data
GNARdesign()
</code></pre>

<hr>
<h2 id='GNARfit'>Fitting function for GNAR models</h2><span id='topic+GNARfit'></span>

<h3>Description</h3>

<p>Fits the GNAR model to the given inputs using <code>GNARdesign</code> and <code>lm</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GNARfit(vts=GNAR::fiveVTS, net=GNAR::fiveNet, alphaOrder=2, betaOrder=c(1,1),
 fact.var=NULL, globalalpha=TRUE, tvnets=NULL, netsstart=NULL, ErrorIfNoNei=TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GNARfit_+3A_vts">vts</code></td>
<td>
<p>a matrix containing the multivariate time series to be modelled. The <code>i,j</code> entry of this matrix should be for time <code>i</code> and vertex/node <code>j</code>.</p>
</td></tr>
<tr><td><code id="GNARfit_+3A_net">net</code></td>
<td>
<p>the (first) network associated with the time series, containing a list with entries <code>$edges</code> and <code>$dist</code>. This network should have the same number of nodes as the number of columns of the <code>vts</code> matrix.</p>
</td></tr>
<tr><td><code id="GNARfit_+3A_alphaorder">alphaOrder</code></td>
<td>
<p>a non-negative integer specifying the maximum time-lag to model.</p>
</td></tr>
<tr><td><code id="GNARfit_+3A_betaorder">betaOrder</code></td>
<td>
<p>a vector of length <code>alphaOrder</code> specifying the maximum neighbour set to model at each of the time-lags.</p>
</td></tr>
<tr><td><code id="GNARfit_+3A_fact.var">fact.var</code></td>
<td>
<p>a vector of factors indicating which nodes belong to different sets with different parameters to be fitted.</p>
</td></tr>
<tr><td><code id="GNARfit_+3A_globalalpha">globalalpha</code></td>
<td>
<p>a TRUE/FALSE value indivating whether to use global alpha parameters.</p>
</td></tr>
<tr><td><code id="GNARfit_+3A_tvnets">tvnets</code></td>
<td>
<p>a list of additional networks. Currently only NULL (the static network case) is supported.</p>
</td></tr>
<tr><td><code id="GNARfit_+3A_netsstart">netsstart</code></td>
<td>
<p>a vector of times corresponding to the first time points for each network of <code>tvnets</code>. Currently only NULL (the static network case) is supported.</p>
</td></tr>
<tr><td><code id="GNARfit_+3A_errorifnonei">ErrorIfNoNei</code></td>
<td>
<p>a TRUE/FALSE value indicating whether to stop the function call with an error if betaOrder specifies more neighbour sets than exist in the network. If FALSE the function will continue and some parameters will be NA.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The GNAR model of order <code class="reqn">(p,S)</code> is defined as
</p>
<p style="text-align: center;"><code class="reqn">X_{i,t} = \sum_{j=1}^p \left( \alpha_{i,j} X_{i,t-j} +\sum_{c=1}^C \sum_{r=1}^{S_j} \beta_{j,r, c}\sum_{q \in {N}^{(r)}_t(i)} \omega_{i,q,c}^{(t)} X_{q,t-j} \right) + u_{i,t}</code>
</p>

<p>where <code class="reqn">p</code> is the maximum time lag, <code class="reqn">S=(S_1,...,S_p)</code> and <code class="reqn">S_j </code> is the maximum stage of neighbour dependence for time lag <code class="reqn">j</code>, <code class="reqn">{N}^{(r)}_t(i)</code> is the <code class="reqn">r</code>th stage neighbour set of node <code class="reqn">i</code> at time <code class="reqn">t</code>, <code class="reqn">\omega_{i,q,c}^{(t)}</code> is the connection weight between node <code class="reqn">i</code> and node <code class="reqn">q</code> at time <code class="reqn">t</code> if the path corresponds
to covariate <code class="reqn">c</code>. Here, we consider a sum from one to zero to be zero and <code class="reqn">\{u_{i,t}\}</code>, are assumed to be independent and identically distributed at each node <code class="reqn">i</code>, with mean zero and variance <code class="reqn">\sigma_i^2</code>.
Currently, only a single network GNAR model can be fitted.
The connection weight, <code class="reqn">\omega_{i,q,c}^{(t)}</code>, is the inverse of the distance between nodes <code>i</code> and <code>q</code>, normalised so that they sum to 1 for each <code>i,t</code>.
See <a href="#topic+is.GNARnet">is.GNARnet</a> for <code>GNARnet</code> object information and example construction.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>mod</code></td>
<td>
<p>the <code>lm</code> output from fitting the GNAR model.</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>the original response values, with NAs left in.</p>
</td></tr>
<tr><td><code>dd</code></td>
<td>
<p>the output of <code>GNARdesign</code> containing the design matrix, with NAs left in.</p>
</td></tr>
<tr><td><code>frbic</code></td>
<td>
<p>inputs to other <code>GNAR</code> functions.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Knight, M.I., Nunes, M.A. and Nason, G.P. Modelling, detrending and decorrelation of network time series.
<a href="https://arxiv.org/abs/1603.03221">arXiv preprint</a>.<br /><br />
Knight, M.I., Leeming, K., Nason, G.P. and Nunes, M. A. (2020) Generalised Network Autoregressive Processes and the GNAR package. <em>Journal of Statistical Software</em>, <b>96</b> (5), 1&ndash;36.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Fit the GNAR(2,[1,1]) model to the fiveVTS data
GNARfit()

#Convert the residuals to matrix form
residToMat(GNARfit())$resid
</code></pre>

<hr>
<h2 id='GNARsim'>Simulates a GNAR process</h2><span id='topic+GNARsim'></span>

<h3>Description</h3>

<p>Simulates a GNAR process with Normally distributed innovations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GNARsim(n=200, net=GNAR::fiveNet, alphaParams=list(c(rep(0.2,5))),
 betaParams=list(c(0.5)), sigma=1, tvnets=NULL, netsstart=NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GNARsim_+3A_n">n</code></td>
<td>
<p>time length of simulation.</p>
</td></tr>
<tr><td><code id="GNARsim_+3A_net">net</code></td>
<td>
<p>network used for the GNAR simulation.</p>
</td></tr>
<tr><td><code id="GNARsim_+3A_alphaparams">alphaParams</code></td>
<td>
<p>a list containing vectors of auto-regression parameters for each time-lag.</p>
</td></tr>
<tr><td><code id="GNARsim_+3A_betaparams">betaParams</code></td>
<td>
<p>a list of equal length as <code>alphaParams</code> containing the network-regression parameters for each time-lag.</p>
</td></tr>
<tr><td><code id="GNARsim_+3A_sigma">sigma</code></td>
<td>
<p>the standard deviation for the innovations.</p>
</td></tr>
<tr><td><code id="GNARsim_+3A_tvnets">tvnets</code></td>
<td>
<p>Only NULL is currently supported.</p>
</td></tr>
<tr><td><code id="GNARsim_+3A_netsstart">netsstart</code></td>
<td>
<p>Only NULL is currently supported.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Parameter lists should not be NULL, set unused parameters to be zero. See <a href="#topic+GNARfit">GNARfit</a> for model description.
</p>


<h3>Value</h3>

<p><code>GNARsim</code> returns the multivariate time series as a <a href="stats.html#topic+ts">ts</a> object, with <code>n</code> rows and a column for each of the nodes in the network.
</p>


<h3>References</h3>

<p>Knight, M.I., Nunes, M.A. and Nason, G.P. Modelling, detrending and decorrelation of network time series.
<a href="https://arxiv.org/abs/1603.03221">arXiv preprint</a>.<br /><br />
Knight, M.I., Leeming, K., Nason, G.P. and Nunes, M. A. (2020) Generalised Network Autoregressive Processes and the GNAR package. <em>Journal of Statistical Software</em>, <b>96</b> (5), 1&ndash;36.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Simulate a GNAR(1,[1]) process with the fiveNet network
GNARsim()
</code></pre>

<hr>
<h2 id='GNARtoigraph'>Converts a GNAR network to a weighted igraph object</h2><span id='topic+GNARtoigraph'></span>

<h3>Description</h3>

<p>Takes an input network and neighbour stage and returns it in <a href="igraph.html#topic+igraph">igraph</a> form.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GNARtoigraph(net=GNAR::fiveNet, stage=1, normalise=FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GNARtoigraph_+3A_net">net</code></td>
<td>
<p>a GNARnet object containing <code>$edges</code> and <code>dist</code>.</p>
</td></tr>
<tr><td><code id="GNARtoigraph_+3A_stage">stage</code></td>
<td>
<p>the neighbour set that the adjacency matrix is created for.</p>
</td></tr>
<tr><td><code id="GNARtoigraph_+3A_normalise">normalise</code></td>
<td>
<p>whether to normalise each to non-zero row to have sum one.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>With normalisation this is a non-invertible transform. See <a href="#topic+NofNeighbours">NofNeighbours</a> for neighbour set definition. See <a href="#topic+is.GNARnet">is.GNARnet</a> for <code>GNARnet</code> object information and example construction.
</p>


<h3>Value</h3>

<p><code>GNARtoigraph</code> returns an 'igraph' object with weights as the inverse distances of the input network.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#fiveNet as an igraph object
GNARtoigraph()
</code></pre>

<hr>
<h2 id='GNARXdesign'>Function to create the GNARX design matrix</h2><span id='topic+GNARXdesign'></span>

<h3>Description</h3>

<p>Creates the design matrix necessary for fitting the GNAR model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GNARXdesign(vts = GNAR::fiveVTS, net = GNAR::fiveNet, alphaOrder = 2, betaOrder = c(1,1),
 fact.var = NULL, globalalpha=TRUE, tvnets=NULL, netsstart=NULL, lambdaOrder=NULL, 
 xvts=NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GNARXdesign_+3A_vts">vts</code></td>
<td>
<p>a matrix or <a href="stats.html#topic+ts">ts</a> object containing the multivariate time series to be modelled. The <code>i,j</code> entry of this matrix should be for time <code>i</code> and vertex/node <code>j</code>.</p>
</td></tr>
<tr><td><code id="GNARXdesign_+3A_net">net</code></td>
<td>
<p>the (first) network associated with the time series, containing a list with entries <code>$edges</code> and <code>$dist</code>. This network should have the same number of nodes as the number of columns of the <code>vts</code> matrix.</p>
</td></tr>
<tr><td><code id="GNARXdesign_+3A_alphaorder">alphaOrder</code></td>
<td>
<p>a non-negative integer specifying the maximum time-lag to model.</p>
</td></tr>
<tr><td><code id="GNARXdesign_+3A_betaorder">betaOrder</code></td>
<td>
<p>a vector of length <code>alphaOrder</code> specifying the maximum neighbour set to model at each of the time-lags.</p>
</td></tr>
<tr><td><code id="GNARXdesign_+3A_fact.var">fact.var</code></td>
<td>
<p>a vector of factors indicating which nodes belong to each set with different parameters to be fitted.</p>
</td></tr>
<tr><td><code id="GNARXdesign_+3A_globalalpha">globalalpha</code></td>
<td>
<p>a TRUE/FALSE value indivating whether to use global alpha parameters.</p>
</td></tr>
<tr><td><code id="GNARXdesign_+3A_tvnets">tvnets</code></td>
<td>
<p>a list of additional networks. Currently only NULL (the static network case) is supported.</p>
</td></tr>
<tr><td><code id="GNARXdesign_+3A_netsstart">netsstart</code></td>
<td>
<p>a vector of times corresponding to the first time points for each network of <code>tvnets</code>. Currently only NULL (the static network case) is supported.</p>
</td></tr>
<tr><td><code id="GNARXdesign_+3A_lambdaorder">lambdaOrder</code></td>
<td>
<p>a vector of the same length as <code>xvts</code> containing non-negative integers specifying the maximum time-lag of exogenous regressors to model. The <code>h</code>th element of the vector refers to the maximum lag of the <code>h</code>th exogenous regressor.</p>
</td></tr>
<tr><td><code id="GNARXdesign_+3A_xvts">xvts</code></td>
<td>
<p>a list of matrices containing values of the exogenous regressors for each vertex/node. The <code>i,j</code> entry of the <code>h</code>th element of the list refers to the value of the <code>h</code>th exogenous regressor for time <code>i</code> and vertex/node <code>j</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>GNARdesign</code></td>
<td>
<p>returns a matrix containing <code>(t-alphaOrder)nnodes</code> rows and a column for each parameter to be fitted. The columns are in time-lag order, eg for GNAR(2,[1,0]) the columns are <code>alpha1</code>, <code>beta1.1</code>, <code>alpha2</code>. When a factor variable is specified the columns are labelled with the factor. If exogenous regressors are included, the matrix takes the form given in Equation 10 of the supplement to the referenced paper.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Nason G.P. and Wei J. (2022) Quantifying the economic response to COVID-19 mitigations and death rates via forecasting Purchasing Managers’ Indices using Generalised Network Autoregressive models with exogenous variables. <em>Journal of the Royal Statistical Society Series A</em>, <b>185</b>, 1778&ndash;1792.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(1)
n = 1000
xvts=list()
xvts[[1]] = matrix(rnorm(5*n, mean=0, sd=2), nrow=n, ncol=5)
xvts[[2]] = matrix(rnorm(5*n, mean=0, sd=2), nrow=n, ncol=5)
lambdaParams=list()
lambdaParams[[1]] = c(0.5, -0.5)
lambdaParams[[2]] = c(0.3, 0.1)

# Simulate the GNARX using the exogenous variables xvts with associated parameters lambdaParams

Y_data &lt;- GNARXsim(n=n, net=GNAR::fiveNet, alphaParams=list(c(rep(0.2,5))), betaParams=list(c(0.5)),
                      sigma=1, xvts=xvts, lambdaParams=lambdaParams)

#Design matrix to fit GNARX(2,[1,1]) to the fiveVTS data

Xdesign &lt;- GNARXdesign(vts = Y_data, net = GNAR::fiveNet, globalalpha = TRUE, alphaOrder = 1,
                betaOrder = 1, xvts = xvts, lambdaOrder = c(1,1))

Xdesign
</code></pre>

<hr>
<h2 id='GNARXfit'>Fitting function for GNARX models</h2><span id='topic+GNARXfit'></span>

<h3>Description</h3>

<p>Fits the GNARX model to the given inputs using <code>GNARdesignX</code> and <code>lm</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GNARXfit(vts=GNAR::fiveVTS, net=GNAR::fiveNet, alphaOrder=2, betaOrder=c(1,1),
 fact.var=NULL, globalalpha=TRUE, tvnets=NULL, netsstart=NULL, ErrorIfNoNei=TRUE, 
 xvts=NULL, lambdaOrder=NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GNARXfit_+3A_vts">vts</code></td>
<td>
<p>a matrix containing the multivariate time series to be modelled. The <code>i,j</code> entry of this matrix should be for time <code>i</code> and vertex/node <code>j</code>.</p>
</td></tr>
<tr><td><code id="GNARXfit_+3A_net">net</code></td>
<td>
<p>the (first) network associated with the time series, containing a list with entries <code>$edges</code> and <code>$dist</code>. This network should have the same number of nodes as the number of columns of the <code>vts</code> matrix.</p>
</td></tr>
<tr><td><code id="GNARXfit_+3A_alphaorder">alphaOrder</code></td>
<td>
<p>a non-negative integer specifying the maximum time-lag to model.</p>
</td></tr>
<tr><td><code id="GNARXfit_+3A_betaorder">betaOrder</code></td>
<td>
<p>a vector of length <code>alphaOrder</code> specifying the maximum neighbour set to model at each of the time-lags.</p>
</td></tr>
<tr><td><code id="GNARXfit_+3A_fact.var">fact.var</code></td>
<td>
<p>a vector of factors indicating which nodes belong to different sets with different parameters to be fitted.</p>
</td></tr>
<tr><td><code id="GNARXfit_+3A_globalalpha">globalalpha</code></td>
<td>
<p>a TRUE/FALSE value indivating whether to use global alpha parameters.</p>
</td></tr>
<tr><td><code id="GNARXfit_+3A_tvnets">tvnets</code></td>
<td>
<p>a list of additional networks. Currently only NULL (the static network case) is supported.</p>
</td></tr>
<tr><td><code id="GNARXfit_+3A_netsstart">netsstart</code></td>
<td>
<p>a vector of times corresponding to the first time points for each network of <code>tvnets</code>. Currently only NULL (the static network case) is supported.</p>
</td></tr>
<tr><td><code id="GNARXfit_+3A_errorifnonei">ErrorIfNoNei</code></td>
<td>
<p>a TRUE/FALSE value indicating whether to stop the function call with an error if betaOrder specifies more neighbour sets than exist in the network. If FALSE the function will continue and some parameters will be NA.</p>
</td></tr>
<tr><td><code id="GNARXfit_+3A_xvts">xvts</code></td>
<td>
<p>a list of matrices containing values of the exogenous regressors for each vertex/node. The <code>i,j</code> entry of the <code>h</code>th element of the list refers to the value of the <code>h</code>th exogenous regressor for time <code>i</code> and vertex/node <code>j</code>.</p>
</td></tr>
<tr><td><code id="GNARXfit_+3A_lambdaorder">lambdaOrder</code></td>
<td>
<p>a vector of the same length as <code>xvts</code> containing non-negative integers specifying the maximum time-lag of exogenous regressors to model. The <code>h</code>th element of the vector refers to the maximum lag of the <code>h</code>th exogenous regressor.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The GNAR model of order <code class="reqn">(p,S)</code> is defined as
</p>
<p style="text-align: center;"><code class="reqn">X_{i,t} = \sum_{j=1}^p \left( \alpha_{i,j} X_{i,t-j} +\sum_{c=1}^C \sum_{r=1}^{S_j} \beta_{j,r, c}\sum_{q \in {N}^{(r)}_t(i)} \omega_{i,q,c}^{(t)} X_{q,t-j} \right) + u_{i,t}</code>
</p>

<p>where <code class="reqn">p</code> is the maximum time lag, <code class="reqn">S=(S_1,...,S_p)</code> and <code class="reqn">S_j </code> is the maximum stage of neighbour dependence for time lag <code class="reqn">j</code>, <code class="reqn">{N}^{(r)}_t(i)</code> is the <code class="reqn">r</code>th stage neighbour set of node <code class="reqn">i</code> at time <code class="reqn">t</code>, <code class="reqn">\omega_{i,q,c}^{(t)}</code> is the connection weight between node <code class="reqn">i</code> and node <code class="reqn">q</code> at time <code class="reqn">t</code> if the path corresponds
to covariate <code class="reqn">c</code>. Here, we consider a sum from one to zero to be zero and <code class="reqn">\{u_{i,t}\}</code>, are assumed to be independent and identically distributed at each node <code class="reqn">i</code>, with mean zero and variance <code class="reqn">\sigma_i^2</code>.
Currently, only a single network GNAR model can be fitted.
The connection weight, <code class="reqn">\omega_{i,q,c}^{(t)}</code>, is the inverse of the distance between nodes <code>i</code> and <code>q</code>, normalised so that they sum to 1 for each <code>i,t</code>.
See <a href="#topic+is.GNARnet">is.GNARnet</a> for <code>GNARnet</code> object information and example construction.
</p>
<p>A GNARX process of order <code class="reqn">p</code>, neighbourhood order vector <code class="reqn">s</code> of length <code class="reqn">p</code> and <code class="reqn">H</code> node-specific time series exogenous variables with order vector <code class="reqn">p'</code>, denoted 
GNARX <code class="reqn">(p, s, p')</code>, is given by
</p>
<p style="text-align: center;"><code class="reqn">
    Y_{i,t}=\sum_{j=1}^{p}\left(\alpha_{i,j}Y_{i,t-j} + \sum_{r=1}^{s_j}  \beta_{j,r} \sum_{q\in\mathcal{N}^{(r)}(i)}\omega_{i,q}Y_{q,t-j}\right)+ {\color{blue} \sum_{h=1}^H
    \sum_{j'=0}^{p'_h}
    \lambda_{h,j'} X_{h,i,t-j'}+u_{i,t}},
</code>
</p>

<p>where <code class="reqn"> u_{i, t}</code> are assumed to be set of mutually uncorrelated random variables with
mean zero and variance of <code class="reqn">\sigma^2</code>.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>mod</code></td>
<td>
<p>the <code>lm</code> output from fitting the GNAR model.</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>the original response values, with NAs left in.</p>
</td></tr>
<tr><td><code>dd</code></td>
<td>
<p>the output of <code>GNARdesign</code> containing the design matrix, with NAs left in.</p>
</td></tr>
<tr><td><code>frbic</code></td>
<td>
<p>inputs to other <code>GNAR</code> functions.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Knight, M.I., Nunes, M.A. and Nason, G.P. Modelling, detrending and decorrelation of network time series.
<a href="https://arxiv.org/abs/1603.03221">arXiv preprint</a>.<br /><br />
Knight, M.I., Leeming, K., Nason, G.P. and Nunes, M. A. (2020) Generalised Network Autoregressive Processes and the GNAR package. <em>Journal of Statistical Software</em>, <b>96</b> (5), 1&ndash;36.<br /><br />
Nason G.P. and Wei J. (2022) Quantifying the economic response to COVID-19 mitigations and death rates via forecasting Purchasing Managers’ Indices using Generalised Network Autoregressive models with 
exogenous variables. <em>Journal of the Royal Statistical Society Series A</em>, <b>185</b>, 1778&ndash;1792.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(1)
n = 1000
xvts=list()
xvts[[1]] = matrix(rnorm(5*n, mean=0, sd=2), nrow=n, ncol=5)
xvts[[2]] = matrix(rnorm(5*n, mean=0, sd=2), nrow=n, ncol=5)
lambdaParams=list()
lambdaParams[[1]] = c(0.5, -0.5)
lambdaParams[[2]] = c(0.3, 0.1)

# Simulate the GNARX using the exogenous variables xvts with associated parameters lambdaParams

Y_data &lt;- GNARXsim(n=n, net=GNAR::fiveNet, alphaParams=list(c(rep(0.2,5))), betaParams=list(c(0.5)),
                      sigma=1, xvts=xvts, lambdaParams=lambdaParams)

# fit a GNARX to the model

model &lt;- GNARXfit(vts = Y_data, net = GNAR::fiveNet,globalalpha = TRUE, alphaOrder = 1,
                betaOrder = 1, xvts = xvts, lambdaOrder = c(1,1))

# look at the residuals
residToMat(model)$resid
</code></pre>

<hr>
<h2 id='GNARXsim'>Simulates a GNARX process</h2><span id='topic+GNARXsim'></span>

<h3>Description</h3>

<p>Simulates a GNAR process with Normally distributed innovations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GNARXsim(n=200, net=GNAR::fiveNet, alphaParams=list(c(rep(0.2,5))),
	betaParams=list(c(0.5)), sigma=1, tvnets=NULL, netsstart=NULL, xvts=NULL, 
	lambdaParams=NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GNARXsim_+3A_n">n</code></td>
<td>
<p>time length of simulation.</p>
</td></tr>
<tr><td><code id="GNARXsim_+3A_net">net</code></td>
<td>
<p>network used for the GNAR simulation.</p>
</td></tr>
<tr><td><code id="GNARXsim_+3A_alphaparams">alphaParams</code></td>
<td>
<p>a list containing vectors of auto-regression parameters for each time-lag.</p>
</td></tr>
<tr><td><code id="GNARXsim_+3A_betaparams">betaParams</code></td>
<td>
<p>a list of equal length as <code>alphaParams</code> containing the network-regression parameters for each time-lag.</p>
</td></tr>
<tr><td><code id="GNARXsim_+3A_sigma">sigma</code></td>
<td>
<p>the standard deviation for the innovations.</p>
</td></tr>
<tr><td><code id="GNARXsim_+3A_tvnets">tvnets</code></td>
<td>
<p>a list of additional networks. Currently only NULL (the static network case) is supported.</p>
</td></tr>
<tr><td><code id="GNARXsim_+3A_netsstart">netsstart</code></td>
<td>
<p>a vector of times corresponding to the first time points for each network of <code>tvnets</code>. 
Currently only NULL (the static network case) is supported.</p>
</td></tr>
<tr><td><code id="GNARXsim_+3A_xvts">xvts</code></td>
<td>
<p>a list of matrices containing values of the exogenous regressors for each vertex/node. 
The <code>i,j</code> entry of the <code>h</code>th element of the list refers to the value of the <code>h</code>th exogenous 
regressor for time <code>i</code> and vertex/node <code>j</code>.</p>
</td></tr>
<tr><td><code id="GNARXsim_+3A_lambdaparams">lambdaParams</code></td>
<td>
<p>a list containing vectors of parameters associated to effect of the exogenous regressor variables for each time-lag.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Parameter lists should not be NULL, set unused parameters to be zero. See <a href="#topic+GNARXfit">GNARXfit</a> for model description.
</p>


<h3>Value</h3>

<p><code>GNARXsim</code> returns the multivariate time series as a <a href="stats.html#topic+ts">ts</a> object, with <code>n</code> rows and a column for each of the nodes in the network.
</p>


<h3>References</h3>

<p>Knight, M.I., Nunes, M.A. and Nason, G.P. Modelling, detrending and decorrelation of network time series.
<a href="https://arxiv.org/abs/1603.03221">arXiv preprint</a>.<br /><br />
Knight, M.I., Leeming, K., Nason, G.P. and Nunes, M. A. (2020) Generalised Network Autoregressive Processes and the GNAR package. <em>Journal of Statistical Software</em>, <b>96</b> (5), 1&ndash;36.<br /><br />
Nason G.P. and Wei J. (2022) Quantifying the economic response to COVID-19 mitigations and death rates via forecasting Purchasing Managers’ Indices using Generalised Network Autoregressive models with
exogenous variables. <em>Journal of the Royal Statistical Society Series A</em>, <b>185</b>, 1778&ndash;1792.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#Simulate a GNARX process with the fiveNet network

set.seed(1)
n = 1000
xvts=list()
xvts[[1]] = matrix(rnorm(5*n, mean=0, sd=2), nrow=n, ncol=5)
xvts[[2]] = matrix(rnorm(5*n, mean=0, sd=2), nrow=n, ncol=5)
lambdaParams=list()
lambdaParams[[1]] = c(0.5, -0.5)
lambdaParams[[2]] = c(0.3, 0.1)

# Simulate the GNARX using the exogenous variables xvts with associated parameters lambdaParams
 
Y_data &lt;- GNARXsim(n=n, net=GNAR::fiveNet, alphaParams=list(c(rep(0.2,5))), betaParams=list(c(0.5)),
                      sigma=1, xvts=xvts, lambdaParams=lambdaParams)

# now try to refit the model
 
model &lt;- GNARXfit(vts = Y_data, net = GNAR::fiveNet,globalalpha = TRUE, alphaOrder = 1, 
		betaOrder = 1, xvts = xvts, lambdaOrder = c(1,1))

model
</code></pre>

<hr>
<h2 id='igraphtoGNAR'>Converts an igraph to GNAR network</h2><span id='topic+igraphtoGNAR'></span>

<h3>Description</h3>

<p>Converts an 'igraph' to the <code>GNARnet</code> form for use as an input to GNAR functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>igraphtoGNAR(ig)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="igraphtoGNAR_+3A_ig">ig</code></td>
<td>
<p>an 'igraph' object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The values in the <code>$dist</code> list are the reciprocal of the values from the weighted adjacency matrix.
</p>


<h3>Value</h3>

<p><code>igraphtoGNAR</code> returns a <code>GNARnet</code>: a list with elements <code>$edges</code> and <code>$dist</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Convert fiveNet to igraph and back again
igraphtoGNAR(GNARtoigraph(fiveNet))
</code></pre>

<hr>
<h2 id='is.GNARfit'>Function to check GNARfit objects</h2><span id='topic+is.GNARfit'></span>

<h3>Description</h3>

<p><code>is.GNARfit</code> returns either TRUE or FALSE according to a series of GNARfit checks.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.GNARfit(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="is.GNARfit_+3A_x">x</code></td>
<td>
<p>the object to be tested</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>is.GNARfit</code> function checks whether the object passes a series of tests that correspond to it being the output of <a href="#topic+GNARfit">GNARfit</a>:
</p>

<ul>
<li><p> Is it a list containing <code>$mod</code> and <code>$frbic</code>
</p>
</li>
<li><p> Does it contain either <code>$y</code> and <code>$dd</code> or $<code>ys</code> and <code>$ds</code>
</p>
</li>
<li><p> Is <code>$mod</code> a <a href="stats.html#topic+lm">lm</a> object
</p>
</li>
<li><p> Does <code>$frbic</code> have the components to calculate the BIC with <a href="#topic+BIC.GNARfit">BIC.GNARfit</a>
</p>
</li></ul>



<h3>Value</h3>

<p><code>is.GNARfit</code> returns <code>TRUE</code> or <code>FALSE</code> corresponding to passing the above tests.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#check that the example fit meets the criteria above
is.GNARfit(GNARfit())
</code></pre>

<hr>
<h2 id='is.GNARnet'>Functions to check and create GNARnet objects</h2><span id='topic+is.GNARnet'></span><span id='topic+as.GNARnet'></span>

<h3>Description</h3>

<p><code>is.GNARnet</code> returns either TRUE or FALSE according to a series of GNARnet checks. <code>as.GNARnet</code> returns a GNARnet object from an input weights matrix, 'igraph' object, or a GNARnet without assigned class.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.GNARnet(x)
as.GNARnet(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="is.GNARnet_+3A_x">x</code></td>
<td>
<p>the network to be tested or object to be converted</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>is.GNARnet</code> function checks whether the network passes a series of tests:
</p>

<ul>
<li><p> Is it a list containing $edges and $dist
</p>
</li>
<li><p> Are the $edges and $dist lists of the same length
</p>
</li>
<li><p> Are each of the elements of $edges the same length as the corresponding $dist element
</p>
</li>
<li><p> Do the edges only contain valid entries, 1,...,nnodes (or <code>NULL</code>)
</p>
</li>
<li><p> Is it labelled as <code>GNARnet</code> class
</p>
</li>
<li><p> Are no duplicate edges present
</p>
</li>
<li><p> Are all distances positive
</p>
</li>
<li><p> Are there no self-loops in the network
</p>
</li></ul>

<p>The <code>as.GNARnet</code> function converts <a href="igraph.html#topic+igraph">igraph</a> objects to GNARnet form, other possible inputs are adjacency matrices, and lists with <code>$edges</code> and <code>$dist</code> entries of the correct form.
</p>


<h3>Value</h3>

<p><code>is.GNARnet</code> returns <code>TRUE</code> or <code>FALSE</code> corresponding to passing the above tests.
<code>as.GNARnet</code> returns a <code>GNARnet</code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#check that the example network meets the criteria above
is.GNARnet(fiveNet)

#convert to igraph and back again
as.GNARnet(GNARtoigraph(fiveNet))

#generate a new network with three nodes
#edges 1-&gt;2, 2-&gt;1, 2-&gt;3
#dist 1, 2, 1
#note 1-&gt;2 and 2-&gt;1 are of different lengths
threeEdge &lt;- list(c(2), c(1,3), NULL)
threeDist &lt;- list(c(1), c(2,1), NULL)
threeNet &lt;- list(edges=threeEdge, dist=threeDist)
#check if this is a GNARnet
is.GNARnet(threeNet)
#use as.GNARnet to change the class
threeNet &lt;- as.GNARnet(threeNet)
#check if this is a GNARnet now
is.GNARnet(threeNet)
</code></pre>

<hr>
<h2 id='local_relevance_plot'>Produces a local neighbourhood relevance plot based on the distances in the underlying network.
</h2><span id='topic+local_relevance_plot'></span><span id='topic+cross_correlation_plot'></span>

<h3>Description</h3>

<p>Produces a local neighbourhood relevance plot based on the distances in the underlying network. The heat-map matrix should reflect clusters if a GNAR model is valid. The size of the clusters depends on the maximum r-stage depth for neighbourhood regression, as <code class="reqn">r^*</code> gets larger, the clusters grow or intersect and cover more nodes. The relative strength of conditionally correlated nodes is <code class="reqn"> \mathrm{rscc} (i, j) := \{ d(i,j) \}^{-1} \mathbb{I} \{ d(i, j) \leq r^* \} + \{2 d(i,j) \}^{-1} \mathbb{I} \{ r^* &lt; d(i, j) \leq 2 r^* \}</code>. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  local_relevance_plot(network, r_star)
  cross_correlation_plot(h, vts)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="local_relevance_plot_+3A_network">network</code></td>
<td>
<p>GNAR network object, which is the underlying network for the time series under study.</p>
</td></tr>
<tr><td><code id="local_relevance_plot_+3A_r_star">r_star</code></td>
<td>
<p>Maximum active r-stage depth for neighbourhood regression.</p>
</td></tr>
<tr><td><code id="local_relevance_plot_+3A_h">h</code></td>
<td>
<p>The lag in the cross correlation plot.</p>
</td></tr>
<tr><td><code id="local_relevance_plot_+3A_vts">vts</code></td>
<td>
<p>The vector time series to compute the cross correlation plot on.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Produces the local relevance plot. Does not return any values.
</p>


<h3>Author(s)</h3>

<p>Daniel Salnikov and Guy Nason
</p>


<h3>References</h3>

<p>Nason, G.P., Salnikov, D. and Cortina-Borja, M. (2023)
New tools for network time series with an application to COVID-19
hospitalisations. <a href="https://arxiv.org/abs/2312.00530">https://arxiv.org/abs/2312.00530</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#
# Produces a local relevance plot, which is a heat-map matrix from a stationary 
# GNAR(1, [1]) simulation.
#
gnar_simulation &lt;- GNARsim(n = 100, net=fiveNet, alphaParams = list(rep(0.35, 5)), 
        betaParams = list(c(0.25)), sigma=1)
# Active node plot
local_relevance_plot(fiveNet, 1)
# Compare to the cross-correlation plot at one-lag
cross_correlation_plot(1, gnar_simulation)
</code></pre>

<hr>
<h2 id='logLik.GNARfit'>
Log-likelihood method for GNARfit objects
</h2><span id='topic+logLik.GNARfit'></span>

<h3>Description</h3>

<p>Returns the log-likelihood for a <code>GNARfit</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'GNARfit'
logLik(object,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="logLik.GNARfit_+3A_object">object</code></td>
<td>

<p>A <code>GNARfit</code> object generated by a <a href="#topic+GNARfit">GNARfit</a> call.
</p>
</td></tr>
<tr><td><code id="logLik.GNARfit_+3A_...">...</code></td>
<td>
<p>Optional additional arguments, not used here.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>S3 method for the GNARfit class. The function returns the value of
</p>
<p style="text-align: center;"><code class="reqn">-TN/2 \log(2 \pi) - T/2 \log(| \Sigma |) - 1/2 trace(E \Sigma^{-1} E'),</code>
</p>
<p> where <code class="reqn">T</code> is the time length of the observations, <code class="reqn">N</code> is the number of nodes, <code class="reqn">\Sigma =  E E' /T</code> is the estimated covariance matrix and <code class="reqn">E</code> is the matrix of residuals.
</p>


<h3>Value</h3>

<p>A <code>logLik</code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#calculate log-likelihood for fiveNode data
#global alphas
logLik(GNARfit())
#individual alphas
logLik(GNARfit(globalalpha=FALSE))
</code></pre>

<hr>
<h2 id='logMVbedMVC.vts'>Number of COVID19 admission to mechanical ventilation beds</h2><span id='topic+logMVbedMVC.vts'></span>

<h3>Description</h3>

<p>This matrix contains a multivariate/vector time series that counts
the number of daily admissions to mechanical ventilation beds in one of
140 NHS Trusts from 2nd April 2020 to 27th June 2021.
</p>


<h3>Format</h3>

<p>The dimension
of the matrix is 452x140. The dates and Trust ID codes are stored in
the dimnames (first and second) respectively.
</p>


<h3>SEE ALSO</h3>

<p><code><a href="#topic+corbit_plot">corbit_plot</a></code>,<code><a href="#topic+NHSTrustMVCAug120.net">NHSTrustMVCAug120.net</a></code></p>


<h3>Author(s)</h3>

<p>Daniel Salnikov and Guy Nason</p>


<h3>Source</h3>

<p>UK Coronavirus website <a href="https://ukhsa-dashboard.data.gov.uk">https://ukhsa-dashboard.data.gov.uk</a> </p>


<h3>References</h3>

<p>Nason, G.P., Salnikov, D. and Cortina-Borja, M. (2023)
New tools for network time series with an application to COVID-19
hospitalisations. <a href="https://arxiv.org/abs/2312.00530">https://arxiv.org/abs/2312.00530</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
data(logMVbedMVC.vts)
data(NHSTrustMVCAug120.net)

#
# Do a corbit plot with this data, with only three lags and one stage
#
# Note, normally max_lag and max_stage would be higher than this, the
# values are artificially small here, as otherwise the run-time restrictions
# for CRAN packaging might be exceeded. 

corbit_plot(vts=logMVbedMVC.vts, net=NHSTrustMVCAug120.net, max_lag=3, max_stage=1)

## End(Not run)

</code></pre>

<hr>
<h2 id='matrixtoGNAR'>Converts an adjacency matrix to GNAR network</h2><span id='topic+matrixtoGNAR'></span>

<h3>Description</h3>

<p>Converts an adjacency matrix to the <code>GNARnet</code> form for use as an input to GNAR functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>matrixtoGNAR(input.mat)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="matrixtoGNAR_+3A_input.mat">input.mat</code></td>
<td>
<p>an adjacency matrix whose dimension equals the number of nodes in the resulting network.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The values in the <code>$dist</code> list are the reciprocal of the values from the weighted adjacency matrix. Any self-loops (diagonal entries) and negatively weighted edges are removed.
</p>


<h3>Value</h3>

<p><code>matrixtoGNAR</code> returns a <code>GNARnet</code> list with elements <code>$edges</code> and <code>$dist</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Convert fiveNet to an adjacency matrix and back again
matrixtoGNAR(as.matrix(fiveNet))
</code></pre>

<hr>
<h2 id='na.row'>Identifies which rows of a matrix have NAs</h2><span id='topic+na.row'></span>

<h3>Description</h3>

<p>Returns a vector with elements TRUE/FALSE identifying which rows contain NA elements.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>na.row(mat)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="na.row_+3A_mat">mat</code></td>
<td>
<p>a matrix object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is used in the unstacking of residuals into a residual matrix and replacing NAs where they were previously present.</p>


<h3>Value</h3>

<p><code>na.row</code> returns a vector of length equal to the number of rows in <code>mat</code>. Each element is either TRUE or FALSE.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Check if there are and NAs in fiveVTS
na.row(fiveVTS)
</code></pre>

<hr>
<h2 id='nacf'>Computes the Network Autocorrelation Function (NACF)
</h2><span id='topic+nacf'></span>

<h3>Description</h3>

<p>Computes the NACF for a choice of lag <code class="reqn">h</code> and r-stage depth <code class="reqn">r</code>, the NACF is given by
<code class="reqn">
  \mathrm{nacf}(h, r) = \frac{\sum_{t=1}^{T - h} ( \boldsymbol{X}_{t + h} - \boldsymbol{\overline{X}})^{T} \big ( \mathbf{W} \odot \mathbf{S}_r + \mathbf{I_d} \big )
    ( \boldsymbol{X}_{t} - \boldsymbol{\overline{X}})}
    {\sum_{t=1}^{T}  ( \boldsymbol{X}_{t} - \boldsymbol{\overline{X}})^{T} \big \{ \big (1 + \lambda \big) \mathbf{I_d} \big \} ( \boldsymbol{X}_{t} - \boldsymbol{\overline{X}})},
</code>
where <code class="reqn">\lambda = \bigg [ \underset{j = 1, \dots, d}{\max} \big \{\sum_{i = 1}^d [(\mathbf{W} \odot \mathbf{W})]_{i j} \big \} \bigg ]^{\frac{1}{2}}</code> is the autocovariance bound of the GNAR process.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  nacf(h, s, weight_matrix, stages_tensor, nts_data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nacf_+3A_h">h</code></td>
<td>
<p>Lag (i.e., time-steps behind) at which the NACF is computed.</p>
</td></tr>
<tr><td><code id="nacf_+3A_s">s</code></td>
<td>
<p>r-stage depth at which the NACF is computed (i.e., shortest distance between nodes).</p>
</td></tr>
<tr><td><code id="nacf_+3A_weight_matrix">weight_matrix</code></td>
<td>
<p>Weight matrix of the GNAR process, each entry corresponds to the weight between two nodes; see <code><a href="#topic+weights_matrix">weights_matrix</a></code> </p>
</td></tr>
<tr><td><code id="nacf_+3A_stages_tensor">stages_tensor</code></td>
<td>
<p>List of r-stage adjacency matrices <code class="reqn">\mathbf{S}_r</code>, the order is ascending.</p>
</td></tr>
<tr><td><code id="nacf_+3A_nts_data">nts_data</code></td>
<td>
<p>Network time series observations, the number of rows is equal to the number of time steps, and the number of columns is equal to the number of series (variables).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the network time series contains missing values, then the weights matrix and <code class="reqn">\lambda</code> are adjusted, so that missing values do not contribute to the network autocorrelation. This is done by setting to zero the weights which correspond to a missing value and computing the new weight matrix and <code class="reqn">\lambda</code> value.
</p>


<h3>Value</h3>

<p>Returns a number between <code class="reqn">-1</code> and <code class="reqn">1</code>, which measures the linear correlation between lagged network observations - i.e., <code class="reqn">\mathrm{nacf}(h, r)</code>.
</p>


<h3>Author(s)</h3>

<p>Daniel Salnikov and Guy Nason.
</p>


<h3>References</h3>

<p>Nason, G.P., Salnikov, D. and Cortina-Borja, M. (2023)
New tools for network time series with an application to COVID-19
hospitalisations. <a href="https://arxiv.org/abs/2312.00530">https://arxiv.org/abs/2312.00530</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#
# Compute the NACF with respect to a stationary GNAR simulation
#
gnar_simulation &lt;- GNARsim(n = 100, net=fiveNet, alphaParams = list(rep(0.35, 5)), 
                           betaParams = list(c(0.25)), sigma=1)
W = weights_matrix(fiveNet)
stages_list = get_k_stages_adjacency_tensor(as.matrix(GNARtoigraph(fiveNet)), 3)
# NACF
nacf(3, 1, W, stages_list, gnar_simulation)
</code></pre>

<hr>
<h2 id='NHSTrustMVCAug120.net'>Constructed network linking 140 NHS Trusts in England and Wales</h2><span id='topic+NHSTrustMVCAug120.net'></span>

<h3>Description</h3>

<p>This matrix contains a multivariate/vector time series that counts
the number of daily admissions to mechanical ventilation beds in one of
140 NHS Trusts from 2nd April 2020 to 27th June 2021.
</p>


<h3>Format</h3>

<p>An object of class GNARnet from the GNAR package</p>


<h3>Author(s)</h3>

<p>Daniel Salnikov and Guy Nason</p>


<h3>Source</h3>

<p>UK Coronavirus website <a href="https://ukhsa-dashboard.data.gov.uk">https://ukhsa-dashboard.data.gov.uk</a> </p>


<h3>References</h3>

<p>Nason, G.P., Salnikov, D. and Cortina-Borja, M. (2023) 
New tools for network time series with an application to COVID-19
hospitalisations. <a href="https://arxiv.org/abs/2312.00530">https://arxiv.org/abs/2312.00530</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+corbit_plot">corbit_plot</a></code>,<code><a href="#topic+NHSTrustMVCAug120.net">NHSTrustMVCAug120.net</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
data(logMVbedMVC.vts)
data(NHSTrustMVCAug120.net)

#
# Plot the network and see what it is like
#
plot(NHSTrustMVCAug120.net)

#
# Do a corbit plot with this data, with only three lags and one stage
#
# Note, normally max_lag and max_stage would be higher than this, the
# values are artificially small here, as otherwise the run-time restrictions
# for CRAN packaging might be exceeded. 

corbit_plot(vts=logMVbedMVC.vts, net=NHSTrustMVCAug120.net, max_lag=3, max_stage=1)

## End(Not run)

</code></pre>

<hr>
<h2 id='nobs.GNARfit'>
Function to return the number of observations input to GNARfit objects
</h2><span id='topic+nobs.GNARfit'></span>

<h3>Description</h3>

<p><code>nobs</code> returns the number of obervations (T) of the input multivariate time series in the <code>GNARfit</code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'GNARfit'
nobs(object,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nobs.GNARfit_+3A_object">object</code></td>
<td>

<p>the output of a GNARfit or GNARpredict call
</p>
</td></tr>
<tr><td><code id="nobs.GNARfit_+3A_...">...</code></td>
<td>
<p>additional arguments, unused here.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>S3 method for class &quot;GNARfit&quot;.
</p>


<h3>Value</h3>

<p>An integer specifying the number of rows in the input <code>vts</code> to the <a href="#topic+GNARfit">GNARfit</a> function.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#observations of example fiveVTS
nobs(GNARfit())
#check this is the same as number of rows in fiveVTS
all.equal(nobs(GNARfit()), nrow(fiveVTS))
</code></pre>

<hr>
<h2 id='node_relevance_plot'>Produces a node relevance plot, which compares the impact each node has on the network autocorrelation once a model order has been chosen.
</h2><span id='topic+node_relevance_plot'></span>

<h3>Description</h3>

<p>Produces a node relevance plot based on the node relevance index <code class="reqn">\mathrm{globindex}(X_{i, t}) := \bigg (\sum_{j = 1}^{d} [\mathbf{W} \odot \mathbf{S}]_{j i} \bigg )
   \bigg \{ \underset{l \in \mathcal{K}}{\max} \bigg ( \sum_{j = 1}^{d} [\mathbf{W} \odot \mathbf{S}]_{j l} \bigg ) \bigg \}^{-1}, </code> which computes the ratio between nodes <code class="reqn">i</code> column sum for nodes in neighbourhood regressions. Nodes are ordered according to the relative contribution eahc has to the autocovariance. The nodes are ordered in ascending order.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  node_relevance_plot(network, r_star, node_names, node_label_size = 2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="node_relevance_plot_+3A_network">network</code></td>
<td>
<p>GNAR network object, which is the underlying network for the time series under study.</p>
</td></tr>
<tr><td><code id="node_relevance_plot_+3A_r_star">r_star</code></td>
<td>
<p>Maximum active r-stage depth for neighbourhood regression.</p>
</td></tr>
<tr><td><code id="node_relevance_plot_+3A_node_names">node_names</code></td>
<td>
<p>Names corresponding to each, this makes identifying nodes in the plot easier. If this argument is NULL, then the plot links to each node a number.</p>
</td></tr>
<tr><td><code id="node_relevance_plot_+3A_node_label_size">node_label_size</code></td>
<td>
<p>Text size when producing the plot. Default is 2, however, depending on the number of nodes it might be necessary to adjust the size.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data Frame consisting of two variable, the node name and the node relevance value.
</p>


<h3>Author(s)</h3>

<p>Daniel Salnikov and Guy Nason.
</p>


<h3>References</h3>

<p>Nason, G.P., Salnikov, D. and Cortina-Borja, M. (2023)
New tools for network time series with an application to COVID-19
hospitalisations. <a href="https://arxiv.org/abs/2312.00530">https://arxiv.org/abs/2312.00530</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#
# Produces a node relevance plot with respect to a stationary GNAR process 
# with underlying network fiveNet
#
# GNAR simulation
gnar_simulation &lt;- GNARsim(n = 100, net=fiveNet, alphaParams = list(rep(0.25, 5), rep(0.12, 5)), 
        betaParams = list(c(0.25, 0.13), c(0.20)), sigma=1)
# Node relevance plot without names
node_relevance_plot(network = fiveNet, r_star = 2, node_label_size = 10)
#
# Node relevance plot with names
#
node_relevance_plot(network = fiveNet, r_star = 2, node_names = c("A", "B", "C", "D", "E"), 
	node_label_size = 10)
</code></pre>

<hr>
<h2 id='NofNeighbours'>Calculates stage-neighbours of a network</h2><span id='topic+NofNeighbours'></span>

<h3>Description</h3>

<p>Calculates neighbour sets of a particular node in the network and their distances.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NofNeighbours(node=1, stage=2, net=GNAR::fiveNet)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="NofNeighbours_+3A_node">node</code></td>
<td>
<p>is an integer specifying which node to calculate the neighbours of.</p>
</td></tr>
<tr><td><code id="NofNeighbours_+3A_stage">stage</code></td>
<td>
<p>is an integer specifying the maximum neighbour-stage to calculate to.</p>
</td></tr>
<tr><td><code id="NofNeighbours_+3A_net">net</code></td>
<td>
<p>a <code>GNARnet</code> object with edge list and distance list.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that the distances are calculated as the sum along the shortest path; do not use this with a weights (rather than distance) list. Stage-<code>r</code> neighbours of node <code>i</code> are denoted <code class="reqn">N^(r)(i)</code>, and are nodes that are <code>r</code> edges (but no fewer) away from <code>i</code>. Hence stage-1 neighbours are the immediate neighbours, stage-2 neighbours are the neighbours of neighbours and so on.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>edges</code></td>
<td>
<p>is a list of length <code>stage</code>, where <code>edges[[i]]</code> is a vector containing the nodes that are stage-<code>i</code> neighbours of <code>node</code>.</p>
</td></tr>
<tr><td><code>dist</code></td>
<td>
<p>is a list of length <code>stage</code>, where <code>dist[[i]]</code> is a vector containing the distances from <code>node</code> to its stage-<code>i</code> neighbours, with ordering as in <code>edges[[i]]</code>.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>#First and second stage neighbours of node 1 in fiveNet
NofNeighbours()
</code></pre>

<hr>
<h2 id='plot.GNARnet'>Plot function for GNAR networks</h2><span id='topic+plot.GNARnet'></span>

<h3>Description</h3>

<p>Plots a GNAR network using the 'igraph' package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'GNARnet'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.GNARnet_+3A_x">x</code></td>
<td>
<p>the network<code>GNARnet</code> object associated with the time series, containing a list with entries <code>$edges</code> and <code>$dist</code>.</p>
</td></tr>
<tr><td><code id="plot.GNARnet_+3A_...">...</code></td>
<td>
<p>additional arguments for the <code>igraph</code> plotting function, see <a href="igraph.html#topic+plot.igraph">plot.igraph</a>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>S3 method for class &quot;GNARnet&quot;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Plot fiveNet
plot(fiveNet)
</code></pre>

<hr>
<h2 id='pnacf'>Computes the Partial Network Autocorrelation Function (PNACF)
</h2><span id='topic+pnacf'></span>

<h3>Description</h3>

<p>Computes the PNACF for a choice of lag <code class="reqn">h</code> and r-stage depth <code class="reqn">r</code>, the PNACF is given by
<code class="reqn">
  \mathrm{pnacf}(h, r) = \frac{\sum_{t=1}^{T - h} ( \boldsymbol{\hat{u}}_{t + h} - \boldsymbol{\overline{u}})^{T} \big ( \mathbf{W} \odot \mathbf{S}_r + \mathbf{I_d} \big )
    ( \boldsymbol{\hat{u}}_{t} - \boldsymbol{\overline{u}})}
    {\sum_{t=1}^{T}  ( \boldsymbol{\hat{u}}_{t} - \boldsymbol{\overline{u}})^{T} \big \{ \big (1 + \lambda \big) \mathbf{I_d} \big \} ( \boldsymbol{\hat{u}}_{t} - \boldsymbol{\overline{u}})},
</code>
where <code class="reqn">\hat{\boldsymbol{X}}_{t}^{h - 1, r - 1} = \sum_{k = 1}^{h - 1} ( \hat{\alpha}_k \boldsymbol{X}_{t - k} + \sum_{s = 1}^{r - 1} \hat{\beta}_{ks} \boldsymbol{Z}_{t - k}^{s}  )</code>, <code class="reqn">\boldsymbol{\hat{u}}_{t + h} = \boldsymbol{X}_{t + h} - \hat{\boldsymbol{X}}_{t + h}^{h - 1, r - 1}</code>, and <code class="reqn">\boldsymbol{\hat{u}}_{t} = \boldsymbol{X}_{t} - \hat{\boldsymbol{X}}_{t}^{h - 1, r - 1}</code> are the empirical residuals corresponding to GNAR(h -1, [r-1, ..., r - 1]) fits, <code class="reqn">\lambda</code> is the same as for the NACF; see <code><a href="#topic+nacf">nacf</a></code>, and <code class="reqn">\boldsymbol{\overline{u}}</code> is the mean of the fitted residuals
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  pnacf(h, s,  weight_matrix, stages_tensor, nts_data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pnacf_+3A_h">h</code></td>
<td>
<p>Lag (i.e., time-steps behind) at which the NACF is computed.</p>
</td></tr>
<tr><td><code id="pnacf_+3A_s">s</code></td>
<td>
<p>r-stage depth at which the NACF is computed (i.e., shortest distance between nodes).</p>
</td></tr>
<tr><td><code id="pnacf_+3A_weight_matrix">weight_matrix</code></td>
<td>
<p>Weight matrix of the GNAR process, each entry corresponds to the weight between two nodes; see <code><a href="#topic+weights_matrix">weights_matrix</a></code> </p>
</td></tr>
<tr><td><code id="pnacf_+3A_stages_tensor">stages_tensor</code></td>
<td>
<p>List of r-stage adjacency matrices <code class="reqn">\mathbf{S}_r</code>, the order is ascending.</p>
</td></tr>
<tr><td><code id="pnacf_+3A_nts_data">nts_data</code></td>
<td>
<p>Network time series observations, the number of rows is equal to the number of time steps, and the number of columns is equal to the number of series (variables).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If the network time series contains missing values, then the weights matrix and <code class="reqn">\lambda</code> are adjusted, so that missing values do not contribute to the partial network autocorrelation. This is done by setting to zero the weights which correspond to a missing value and computing the new weight matrix and <code class="reqn">\lambda</code> value.
</p>


<h3>Author(s)</h3>

<p>Daniel Salnikov and Guy Nason
</p>


<h3>References</h3>

<p>Nason, G.P., Salnikov, D. and Cortina-Borja, M. (2023)
New tools for network time series with an application to COVID-19
hospitalisations. <a href="https://arxiv.org/abs/2312.00530">https://arxiv.org/abs/2312.00530</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#
# Compute the PNACF with respect to a stationary GNAR simulation
#
gnar_simulation &lt;- GNARsim(n = 100, net=fiveNet, alphaParams = list(rep(0.35, 5)), 
                           betaParams = list(c(0.25)), sigma=1)
W = weights_matrix(fiveNet)
stages_list = get_k_stages_adjacency_tensor(as.matrix(GNARtoigraph(fiveNet)), 3)
# PNACF
pnacf(3, 1, W, stages_list, gnar_simulation)
</code></pre>

<hr>
<h2 id='predict.GNARfit'>
Prediction of a GNARfit object
</h2><span id='topic+predict.GNARfit'></span>

<h3>Description</h3>

<p>Predicts future observations from a GNARfit object, based on the fitted GNAR model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'GNARfit'
predict(object, n.ahead=1, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict.GNARfit_+3A_object">object</code></td>
<td>
<p>the output of a <a href="#topic+GNARfit">GNARfit</a> call
</p>
</td></tr>
<tr><td><code id="predict.GNARfit_+3A_n.ahead">n.ahead</code></td>
<td>
<p>the time length of the predictions</p>
</td></tr>
<tr><td><code id="predict.GNARfit_+3A_...">...</code></td>
<td>
<p>further arguments passed to the <a href="#topic+simulate.GNARfit">simulate.GNARfit</a> function, such as <code>seed</code> </p>
</td></tr>
</table>


<h3>Details</h3>

<p>S3 method for class &quot;GNARfit&quot;. This function calls <a href="#topic+simulate.GNARfit">simulate.GNARfit</a>.
</p>


<h3>Value</h3>

<p>A multivariate time series of dimension <code>n.ahead</code> x nnodes.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#simulate 5 future observations from fiveVTS
predict(GNARfit(), n.ahead=5)
</code></pre>

<hr>
<h2 id='print.GNARfit'>Function to print the model and coefficients of GNARfit objects</h2><span id='topic+print.GNARfit'></span>

<h3>Description</h3>

<p><code>print.GNARfit</code> prints model, call, and coefficients of a GNARfit object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'GNARfit'
print(x,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.GNARfit_+3A_x">x</code></td>
<td>
<p>the output of a <a href="#topic+GNARfit">GNARfit</a> call</p>
</td></tr>
<tr><td><code id="print.GNARfit_+3A_...">...</code></td>
<td>
<p>additional arguments, unused here.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>S3 method for class &quot;GNARfit&quot;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#print the information of the fiveNode GNAR fit
print(GNARfit())
</code></pre>

<hr>
<h2 id='print.GNARnet'>Print function for GNAR networks</h2><span id='topic+print.GNARnet'></span>

<h3>Description</h3>

<p>Prints information about a GNAR network.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'GNARnet'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.GNARnet_+3A_x">x</code></td>
<td>
<p>the network <code>GNARnet</code> object associated with the time series, containing a list with entries <code>$edges</code> and <code>$dist</code>.</p>
</td></tr>
<tr><td><code id="print.GNARnet_+3A_...">...</code></td>
<td>
<p>additional arguments, unused here.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>S3 method for class &quot;GNARnet&quot;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#print fiveNet information
print(fiveNet)
</code></pre>

<hr>
<h2 id='r_corbit_plot'>Produces a R-Corbit plot for the specified choice of covariate-levels and/or time-slices.
</h2><span id='topic+r_corbit_plot'></span>

<h3>Description</h3>

<p>Produces a R-Corbit plot for comparing the network autocorrelation (NACF) and partial network autocorrelation function (PNACF) values for a choice of maximum lag and maximum <code class="reqn">r</code>-stage depth. Starting from the first and continuing to the outermost ring, each ring corresponds to said choice of <code class="reqn">r</code>-stage depth. The numbers on the outermost ring are time-lags, and each dot corresponds to a specific time-slice or covariate-level.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>r_corbit_plot(vts_frames, network_list, max_lag, max_stage, weight_matrices, 
frame_names, same_net="no", viridis_color_option="viridis", size_option="absolute_val", 
partial="no", r_corbit="yes")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="r_corbit_plot_+3A_vts_frames">vts_frames</code></td>
<td>
<p>List containing the vector time series linked to each of the covariate-levels and/or time-slices, which the R-Corbit plot compares.</p>
</td></tr>
<tr><td><code id="r_corbit_plot_+3A_network_list">network_list</code></td>
<td>
<p>List of network objects for which the R-Corbit plot compares network autocorrelation or partial network autocorrelation.</p>
</td></tr>
<tr><td><code id="r_corbit_plot_+3A_max_lag">max_lag</code></td>
<td>
<p>Maximum lag for the R-Corbit plot.</p>
</td></tr>
<tr><td><code id="r_corbit_plot_+3A_max_stage">max_stage</code></td>
<td>
<p>Maximum <code class="reqn">r</code>-stage depth for the R-Corbit plot (i.e., the number of rings in the R-Corbit plot).</p>
</td></tr>
<tr><td><code id="r_corbit_plot_+3A_weight_matrices">weight_matrices</code></td>
<td>
<p>List of weigth matrices, each weight matrix corresponds to a particular choice of time-slice or covariate-level. If all the time-slices have the same weight matrix, then the argument is a list, where all the entries are equal to the unique weight matrix.</p>
</td></tr>
<tr><td><code id="r_corbit_plot_+3A_frame_names">frame_names</code></td>
<td>
<p>Indicates the name of each time-slice or covariate-level time series. Order should be the same as in the weight matrices and vector time series lists.</p>
</td></tr>
<tr><td><code id="r_corbit_plot_+3A_same_net">same_net</code></td>
<td>
<p>Indicates whether or not all time-slices or covariate-levels share the same weight matrix. Default choice is no, if the time-slices or covariate-levels share the same weight matrix, then this argument should be set to &quot;yes&quot; (i.e., same_net = &quot;yes&quot;).</p>
</td></tr>
<tr><td><code id="r_corbit_plot_+3A_viridis_color_option">viridis_color_option</code></td>
<td>
<p>Colour scale for the R-Corbit plot. The default option is <code>viridis</code>, each option is colout blind friendly.</p>
</td></tr>
<tr><td><code id="r_corbit_plot_+3A_size_option">size_option</code></td>
<td>
<p>Point size scale for the R-Corbit plot. Default is the absolute value of the network autocorrelation function (i.e., <code>|nacf(h, r)|</code> or  <code>|pnacf(h, r)|)</code>. Alternate option is the coefficient of determination coming from a global-<code class="reqn">\alpha</code> model constrained to a specific lag and stage pair.</p>
</td></tr>
<tr><td><code id="r_corbit_plot_+3A_partial">partial</code></td>
<td>
<p>Option for selecting between computing the network autocorrelation function or the partial network autocorrelation function. Default choice is network autocorrelation (i.e., partial=&quot;no&quot;). Change argument to &quot;yes&quot; for computing the partial network autocorrelation function (PNACF).</p>
</td></tr>
<tr><td><code id="r_corbit_plot_+3A_r_corbit">r_corbit</code></td>
<td>
<p>Choice for distinguishing between Corbit and R-Corbit plots, default is set to Corbit (inner function call). For producing R-Corbit plots one should use <code><a href="#topic+corbit_plot">corbit_plot</a></code>. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>R-Corbit plots compare the network autocorrelation function (NACF) and partial network autocorrelation function (PNACF) values for a choice of different time-slices and/or covariate-levels. R-Corbit plots are read in the same manner as Corbit plots <code><a href="#topic+corbit_plot">corbit_plot</a></code>, and include a legend on the right-hand side for distinguishing between covariate-levels and/or time-slices. The point at the centre is the mean value of the NACF or PNACF values arising from the time-slices and/or covariate-levels data splits. Essentially, if <code class="reqn">c \in \{1, \dots, C\}</code>, where <code class="reqn">C \in \mathbb{N}</code> is the number of covariate-levels or time-slices, then the value at the centre is <code class="reqn">\mathrm{(p)nacf}(h, r) = C^{-1} \sum_{c = 1}^{C} \mathrm{(p)nacf}_c (h, r),</code> where <code class="reqn">\mathrm{(p)nacf}_c(h, r)</code> is the (P)NACF value corresponding to the covariate-level/time-slice <code class="reqn">c</code>. The number of covariate-levels and time-slices <code class="reqn">C</code> must be equal to the length of the lists used for producing the R-Corbit plot.
</p>


<h3>Value</h3>

<p>Produces the specified, i.e., NACF or PNACF, values for a choice of lag and <code class="reqn">r</code>-stage depth, <code class="reqn">(h, r)</code>, R-Corbit plot. Does not print (P)NACF values, these are stored as invisble data frames (matrices), and can be accessed by printing or calling the object produced by the <code>r_corbit_plot</code> call. The invisible object is a list of matrices, one matrix for each covariate-level/time-slice.
</p>


<h3>Author(s)</h3>

<p>Guy Nason and Daniel Salnikov
</p>


<h3>References</h3>

<p>Nason, G.P., Salnikov, D. and Cortina-Borja, M. (2023)
New tools for network time series with an application to COVID-19
hospitalisations. <a href="https://arxiv.org/abs/2312.00530">https://arxiv.org/abs/2312.00530</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
#
# Produces a R-Corbit plot, which compares three stationary GNAR simulations, where 
# the underlying network is fiveNet.
#
# Compute the weight matrix
W = weights_matrix(fiveNet)
#
# Simulate three stationary GNAR processe
sim1 &lt;-  GNARsim(n = 100, net=fiveNet, alphaParams = list(c(0.1, 0.12, 0.16, 0.075, 0.21),
                                                          c(0.12, 0.14, 0.15, 0.6, 0.22)), 
                 betaParams = list(c(0.1, 0.16), c(0.11, 0.14)))

sim2 &lt;-  GNARsim(n = 100, net=fiveNet, alphaParams = list(rep(.25, 5)), 
                 betaParams = list(c(0.1, 0.16)))

sim3 &lt;- GNARsim(n = 100, net=fiveNet, alphaParams = list(rep(.25, 5), rep(0.13, 5)), 
                betaParams = list(c(0.1, 0.16), c(0.11)))
                
# Produce NACF R-Corbit plot with the same network and weights matrix
r_corbit_plot(list(sim1, sim2, sim3), list(fiveNet), 10, 3, list(W), 
		c("sim1", "sim2", "sim3"), same_net = "yes")
# 
# Produce PNACF R-Corbit with different networks and weight matrices
print(r_corbit_plot(list(sim1, sim2, sim3), list(fiveNet, fiveNet, fiveNet), 10, 3, list(W, W, W),
		 c("sim1", "sim2", "sim3"), same_net = "no", partial = "yes"))


## End(Not run)

</code></pre>

<hr>
<h2 id='residToMat'>Converts the output of a GNARfit call to fitted and residual value matrices</h2><span id='topic+residToMat'></span>

<h3>Description</h3>

<p>Unstacks the entries of the GNARfit fitted and residual values to return matrices of a similar form to the multivariate time series input.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>residToMat(GNARobj=GNARfit(), nnodes=5)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="residToMat_+3A_gnarobj">GNARobj</code></td>
<td>
<p>the output from the <a href="#topic+GNARfit">GNARfit</a> function</p>
</td></tr>
<tr><td><code id="residToMat_+3A_nnodes">nnodes</code></td>
<td>
<p>the number of nodes in the original network time series</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function also replaces the NAs that were removed in fitting.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>resid</code></td>
<td>
<p>is the matrix of residual values, with <code>t-alphaOrder</code> rows and <code>nnodes</code> columns.</p>
</td></tr>
<tr><td><code>fit</code></td>
<td>
<p>is the matrix of fitted values, with <code>t-alphaOrder</code> rows and <code>nnodes</code> columns.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>#Get residual and fitted matrices from GNARpredict fit of fiveVTS
residToMat()
</code></pre>

<hr>
<h2 id='residuals.GNARfit'>Function to return residuals of GNARfit objects</h2><span id='topic+residuals.GNARfit'></span>

<h3>Description</h3>

<p><code>residuals.GNARfit</code> returns the residuals of a GNARfit object as a matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'GNARfit'
residuals(object,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="residuals.GNARfit_+3A_object">object</code></td>
<td>
<p>the output of a <a href="#topic+GNARfit">GNARfit</a> call</p>
</td></tr>
<tr><td><code id="residuals.GNARfit_+3A_...">...</code></td>
<td>
<p>additional arguments, unused here.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function first checks if the object is of GNARfit class, then uses <a href="#topic+residToMat">residToMat</a> to return the residuals.
</p>


<h3>Value</h3>

<p><code>residuals.GNARfit</code> returns a 'ts' object of residuals, with <code>t-alphaOrder</code> rows and <code>nnodes</code> columns.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#get the residuals of the fiveNode GNAR fit
residuals(GNARfit())
</code></pre>

<hr>
<h2 id='seed.nos'>Vector of seed numbers</h2><span id='topic+seed.nos'></span>

<h3>Description</h3>

<p>Seed numbers for reproducible random graphs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>seed.nos
</code></pre>


<h3>Format</h3>

<p><code>seed.nos</code> is a vector of length 10,000 containing integers.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>g &lt;- seedToNet(seed.nos[1], nnodes=35, graph.prob=0.15)
plot(g, vertex.label=colnames(gdpVTS), vertex.size=0)
</code></pre>

<hr>
<h2 id='seedToNet'>Produces a random network from a seed value</h2><span id='topic+seedToNet'></span>

<h3>Description</h3>

<p>Produces a reproducible undirected Erdos-Reyni random network using a particular seed value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>seedToNet(seed.no, nnodes=34, graph.prob=0.5)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="seedToNet_+3A_seed.no">seed.no</code></td>
<td>
<p>a valid number to set the seed to.</p>
</td></tr>
<tr><td><code id="seedToNet_+3A_nnodes">nnodes</code></td>
<td>
<p>the number of nodes in the produced network.</p>
</td></tr>
<tr><td><code id="seedToNet_+3A_graph.prob">graph.prob</code></td>
<td>
<p>the probability that each pair of nodes is connected.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>graph.prob</code> effectively controls the sparsity of the network. All distances are set to 1.
</p>


<h3>Value</h3>

<p>A GNARnet object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Generate the random graph from seed 10, with 5 nodes and connection prob 0.5
seedToNet(10,nnodes=5,graph.prob=0.5)
</code></pre>

<hr>
<h2 id='simulate.GNARfit'>
Function to simulate from a GNARfit object
</h2><span id='topic+simulate.GNARfit'></span>

<h3>Description</h3>

<p>Simulates from a GNARfit object, either creating a new series or future observations of the original series based upon the fitted GNAR model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'GNARfit'
simulate(object, nsim=object$frbic$time.in, seed=NULL,
                             future=TRUE, set.noise=NULL, allcoefs=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simulate.GNARfit_+3A_object">object</code></td>
<td>
<p>the output of a <a href="#topic+GNARfit">GNARfit</a> call
</p>
</td></tr>
<tr><td><code id="simulate.GNARfit_+3A_nsim">nsim</code></td>
<td>
<p>the time length of the simulations</p>
</td></tr>
<tr><td><code id="simulate.GNARfit_+3A_seed">seed</code></td>
<td>
<p>either <code>NULL</code>, or a value to set the seed to</p>
</td></tr>
<tr><td><code id="simulate.GNARfit_+3A_future">future</code></td>
<td>
<p>whether the simulations follow on from the original time series (<code>TRUE</code>), or if <code>FALSE</code> the simulations are a new series.</p>
</td></tr>
<tr><td><code id="simulate.GNARfit_+3A_set.noise">set.noise</code></td>
<td>
<p>a value to set the standard deviation of the noise to, or if <code>NULL</code>, the estimated standard deviation from the input series will be used.</p>
</td></tr>
<tr><td><code id="simulate.GNARfit_+3A_allcoefs">allcoefs</code></td>
<td>
<p>if <code>TRUE</code>, all fitted coefficients will be used, if <code>FALSE</code> only the significant (p-val &lt; 0.05) coefficients will be used.</p>
</td></tr>
<tr><td><code id="simulate.GNARfit_+3A_...">...</code></td>
<td>
<p>additional arguments, unused here.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>S3 method for class &quot;GNARfit&quot;.
</p>


<h3>Value</h3>

<p>A multivariate time series of dimension <code>nsim</code> x nnodes.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#simulate 5 future observations from fiveVTS
simulate(GNARfit(), nsim=5)
</code></pre>

<hr>
<h2 id='summary.GNARfit'>Returns model summary for a GNAR model fit</h2><span id='topic+summary.GNARfit'></span>

<h3>Description</h3>

<p>Returns the summary of a GNARfit object, including BIC.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'GNARfit'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.GNARfit_+3A_object">object</code></td>
<td>
<p>output of a <a href="#topic+GNARfit">GNARfit</a> call.</p>
</td></tr>
<tr><td><code id="summary.GNARfit_+3A_...">...</code></td>
<td>
<p>additional arguments, unused here.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The output is the summary of the fit using <a href="stats.html#topic+summary.lm">summary.lm</a>, and BIC calculated using <a href="#topic+BIC.GNARfit">BIC.GNARfit</a>.
</p>


<h3>Value</h3>

<p><code>summary.GNARfit</code> prints the model summary and the value of the BIC.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#summary for the GNAR(2,[1,1]) model using GNARfit on fiveVTS
summary(GNARfit())
</code></pre>

<hr>
<h2 id='summary.GNARnet'>Summary function for GNAR networks</h2><span id='topic+summary.GNARnet'></span>

<h3>Description</h3>

<p>Prints brief information about a GNAR network.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'GNARnet'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.GNARnet_+3A_object">object</code></td>
<td>
<p>the network<code>GNARnet</code> object associated with the time series, containing a list with entries <code>$edges</code> and <code>$dist</code>.</p>
</td></tr>
<tr><td><code id="summary.GNARnet_+3A_...">...</code></td>
<td>
<p>additional arguments, unused here.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>S3 method for class &quot;GNARnet&quot;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#print fiveNet summary information
summary(fiveNet)
</code></pre>

<hr>
<h2 id='vcov.GNARfit'>
Calculate variance-covariance matrix for a itted GNARfit object
</h2><span id='topic+vcov.GNARfit'></span>

<h3>Description</h3>

<p>Returns the varaince-covariance matrix of the parameters of a GNARfit object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'GNARfit'
vcov(object,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="vcov.GNARfit_+3A_object">object</code></td>
<td>
<p>a GNARfit object, the output from a <a href="#topic+GNARfit">GNARfit</a> call.
</p>
</td></tr>
<tr><td><code id="vcov.GNARfit_+3A_...">...</code></td>
<td>
<p>further arguments passed to <a href="stats.html#topic+vcov">vcov</a>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>S3 method for class &quot;GNARfit&quot;.
</p>


<h3>Value</h3>

<p>A matrix of estimated covariances between the parameter estimates, this is calculated using <a href="stats.html#topic+vcov">vcov</a> for <a href="stats.html#topic+lm">lm</a> objects.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#covariance matrix of fiveNode fit
vcov(GNARfit())
</code></pre>

<hr>
<h2 id='vswind'>
Wind Speed example network time series
</h2><span id='topic+vswind'></span><span id='topic+vswindcoords'></span><span id='topic+vswindnames'></span><span id='topic+vswindnet'></span><span id='topic+vswindnetD'></span><span id='topic+vswindts'></span>

<h3>Description</h3>

<p>A suite of data objects concerning wind speed analysis.
The dataset contains a multivariate time series of wind speeds,
two network descriptions, a vector of names for weather stations,
and the coordinates of the weather stations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("vswind")</code></pre>


<h3>Format</h3>

<p> This dataset contains six R objects:<br />
<code>vswindts</code> is a <a href="stats.html#topic+ts">ts</a> object with a matrix of 721 rows (t=721) and 102 columns (n=102). This corresponds to 721 observations made through time at
102 weather stations.
<code>vswindnetD</code> is a <code>GNARnet</code>
object containing <code>$edges</code> and <code>$dist</code>. <br />
<code>edges</code> is a list of length 102, with <code>edges[[i]]</code> containing the vertices that node i is connected to. <br />
<code>dist</code> is a list of length 102, with <code>dist[[i]]</code> containing the length of the vertices that node i is connected to.
<code>vswindnet</code> is the same as <code>vswindnetD</code> except that all the distances
are replaced by 1.
<code>vswindnames</code> is a character vector of length 102 containing the wind speed
site names and
<code>vswindcoords</code> is a matrix with 102 rows (one for each wind station) and
two columns providing the x and y coordinates of the weather stations.
</p>


<h3>Source</h3>

<p>The base data were obtained from the
<a href="http://wow.metoffice.gov.uk">http://wow.metoffice.gov.uk</a> UK Met Office WeatherObservationsWebsite
distributed under the UK Open Government License
<a href="https://www.nationalarchives.gov.uk/doc/open-government-licence/version/1/open-government-licence.htm">https://www.nationalarchives.gov.uk/doc/open-government-licence/version/1/open-government-licence.htm</a>
Contains public sector information licensed under the Open Goverment
Licence v1.0.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+windnetplot">windnetplot</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>#
# The name entry for Bristol
#
vswindnames[77]
#[1] "BRIST"
#
# plot the distance network
#
## Not run: windnetplot()
</code></pre>

<hr>
<h2 id='weights_matrix'>Computes the weights matrix corresponding to the GNAR network object linked to the vector time series.
</h2><span id='topic+weights_matrix'></span>

<h3>Description</h3>

<p>Computes the weights matrix with normalised weights (i.e., add up to one) for the network time series with underlying network provided by the user. If the network is unweighted, then each r-stage neighbour is considered equally relevant, i.e., <code class="reqn">w_{ij}</code> = <code class="reqn">\{ \mathcal{N}_r (i)\}^{-1} \mathbb{I} (d(i, j) = r) </code>, where <code class="reqn">\mathbb{I}</code> is the indicator function and the distance is the shortest path in the underlying network.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>weights_matrix(network, max_r_stage)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="weights_matrix_+3A_network">network</code></td>
<td>
<p>Network linked to the vector time series under study, must be a GNARnet object.</p>
</td></tr>
<tr><td><code id="weights_matrix_+3A_max_r_stage">max_r_stage</code></td>
<td>
<p>Longest shortest path for which weights are non-zero. If not specified, then its set equal to the upper bound, which is the longest shortest path in the underlying network.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Weight matrix <code class="reqn">\mathbf{W}</code>, each entry is the weight <code class="reqn">w_{ij}</code> between a pair of nodes. The matrix is not symmetric, and each row adds up to one when considering r-stage neighbours for a particular r.
</p>


<h3>Author(s)</h3>

<p>Daniel Salnikov and Guy Nason.
</p>


<h3>References</h3>

<p>Nason, G.P., Salnikov, D. and Cortina-Borja, M. (2023)
New tools for network time series with an application to COVID-19
hospitalisations. <a href="https://arxiv.org/abs/2312.00530">https://arxiv.org/abs/2312.00530</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#
# Weights matrix linked to the mechanical ventilation beds time series. 
# This network has a longest shortest path equal to six.
# 
#data(fiveNet)
W_norm = weights_matrix(fiveNet, 6)
</code></pre>

<hr>
<h2 id='windnetplot'>Produce bespoke plot of the wind data network</h2><span id='topic+windnetplot'></span>

<h3>Description</h3>

<p>Plots the wind speed data network with distance information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>windnetplot()
</code></pre>


<h3>Arguments</h3>

<p>None.
</p>


<h3>Details</h3>

<p>The wind speed data is to be found in the <code><a href="#topic+vswind">vswind</a></code>
data set. This function contains commands, using
functionality from the <code>wordcloud</code> package, to plot the
network, with node names and edges. Distances between nodes are
plotted next to the edges.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+vswind">vswind</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: windplotnet()
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
