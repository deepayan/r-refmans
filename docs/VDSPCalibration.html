<!DOCTYPE html><html><head><title>Help for package VDSPCalibration</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {VDSPCalibration}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#VDSPCalibration-package'>
<p>Statistical Methods for Designing and Analyzing a Calibration Study</p></a></li>
<li><a href='#calfun'><p>Estimating the Calibration Equation</p></a></li>
<li><a href='#chngpt'><p>Piecewise Regression Estimation</p></a></li>
<li><a href='#samplefun'><p>Uniformly Sampling</p></a></li>
<li><a href='#samplesize'><p> Uniform Sampling Within Quartiles</p></a></li>
<li><a href='#sampletot'><p>Samples Selection</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Statistical Methods for Designing and Analyzing a Calibration
Study</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2017-09-01</td>
</tr>
<tr>
<td>Author:</td>
<td>Ramon Durazo-Arvizu, Chris Sempos, and Lu Tian</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Lu Tian &lt;lutian@stanford.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides statistical methods for the design and analysis of a calibration study, which aims for calibrating measurements using two different methods. The package includes sample size calculation, sample selection,  regression analysis with error-in measurements and change-point regression. The method is described in Tian, Durazo-Arvizu, Myers, et al. (2014) &lt;<a href="https://doi.org/10.1002%2Fsim.6235">doi:10.1002/sim.6235</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2017-09-05 18:12:29 UTC; lutian</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2017-09-05 18:19:47 UTC</td>
</tr>
</table>
<hr>
<h2 id='VDSPCalibration-package'>
Statistical Methods for Designing and Analyzing a Calibration Study
</h2><span id='topic+VDSPCalibration-package'></span><span id='topic+VDSPCalibration'></span>

<h3>Description</h3>

<p>Implements statistical methods for designing and analyzing a calibration study</p>


<h3>Details</h3>

<p>Implements statistical methods for design and analysis of a calibration study. The important functions are &quot;samplesize&quot;: for sample size estimation; &quot;sampletot&quot;: for sample selection, &quot;calfun&quot;: for estimating calibrating equation and &quot;chngpt&quot;: for estimating the piece-wise linear equation.
</p>


<h3>Author(s)</h3>

<p>Ramon Durazo-Arvizu,  Chris Sempos, and Lu Tian</p>


<h3>References</h3>

<p>Tian L., Durazo-Arvizu R. A., Myers G., Brooks S., Sarafin K., and Sempos C. T. (2014), The estimation of calibration equations for variables with heteroscedastic measurement errors, Statist. Med., 33, pages 4420-4436</p>

<hr>
<h2 id='calfun'>Estimating the Calibration Equation</h2><span id='topic+calfun'></span>

<h3>Description</h3>

<p> Estimates the calibration equation based on CV information</p>


<h3>Usage</h3>

<pre><code class='language-R'>calfun(x, y, CVx, CVy = CVx, lambda0 = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calfun_+3A_x">x</code></td>
<td>
<p>old VD measurements</p>
</td></tr>
<tr><td><code id="calfun_+3A_y">y</code></td>
<td>
<p>reference (new) VD measurements</p>
</td></tr>
<tr><td><code id="calfun_+3A_cvx">CVx</code></td>
<td>
<p>CV% of the old VD measurements</p>
</td></tr>
<tr><td><code id="calfun_+3A_cvy">CVy</code></td>
<td>
<p>CV% of the new VD measurements</p>
</td></tr>
<tr><td><code id="calfun_+3A_lambda0">lambda0</code></td>
<td>
<p>the CV ratio of the new vs old measurements</p>
</td></tr>
</table>


<h3>Details</h3>

<p> Estimation of the calibration equation. It covers 4 scenarios: Only CVx is known; only CVy is known;  both CVx and CVy are known; and  Only the ratio of CVy to CVx is known.</p>


<h3>Value</h3>

<table>
<tr><td><code>coef</code></td>
<td>
<p>estimated coefficients of the linear function</p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p>standard errors of the estimated coefficients</p>
</td></tr>
<tr><td><code>lower CI</code></td>
<td>
<p> the lower end of the 95% CI of the regression coefficients</p>
</td></tr>
<tr><td><code>upper CI</code></td>
<td>
<p> the upper end of the 95% CI of the regression coefficients</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Durazo-Arvizu, Ramon; Sempos, Chris;  Tian, Lu</p>


<h3>References</h3>

<p>Tian L., Durazo-Arvizu R. A., Myers G., Brooks S., Sarafin K., and Sempos C. T. (2014), The estimation of calibration equations for variables with heteroscedastic measurement errors, Statist. Med., 33, pages 4420-4436</p>


<h3>Examples</h3>

<pre><code class='language-R'>n=100
sigma0=10

beta0=5
beta1=1.2
CVx=0.15
CVy=0.07

lambda0=CVy^2/CVx^2

x0=runif(n, 20, 200)
y0=beta0+beta1*x0+rnorm(n)*sigma0
x=x0+x0*CVx*rnorm(n)
y=y0+y0*CVy*rnorm(n)

fit=calfun(x, y, CVx, CVy, lambda0)
fit

</code></pre>

<hr>
<h2 id='chngpt'>Piecewise Regression Estimation</h2><span id='topic+chngpt'></span>

<h3>Description</h3>

<p>Estimate a piecewise linear regression equation</p>


<h3>Usage</h3>

<pre><code class='language-R'>chngpt(x, y, start = quantile(x, probs = 0.1,

na.rm = "TRUE"),finish = quantile(x, probs = 0.9, na.rm = "TRUE"),

NbrSteps = 500)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="chngpt_+3A_x">x</code></td>
<td>

<p>old VD measurements
</p>
</td></tr>
<tr><td><code id="chngpt_+3A_y">y</code></td>
<td>

<p>reference (new) VD measurements
</p>
</td></tr>
<tr><td><code id="chngpt_+3A_start">start</code></td>
<td>

<p>lower bound of the changing point
</p>
</td></tr>
<tr><td><code id="chngpt_+3A_finish">finish</code></td>
<td>

<p>upper bound of the changing point
</p>
</td></tr>
<tr><td><code id="chngpt_+3A_nbrsteps">NbrSteps</code></td>
<td>

<p>number of points used in grid search
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function uses grid search method to fit a piecewise linear regression model with one changing point
</p>


<h3>Value</h3>

<table>
<tr><td><code>x</code></td>
<td>
<p>old VD levels</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>new VD levels</p>
</td></tr>
<tr><td><code>yfitted</code></td>
<td>
<p>calibrated VD levels based on the fitted piecewise linear regression</p>
</td></tr>
<tr><td><code>chngpt</code></td>
<td>
<p>the estimated chang point</p>
</td></tr>
<tr><td><code>coefficients</code></td>
<td>
<p>the estimated regression coefficients for the piecewise linear regression</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Durazo-Arvizu, Ramon and   Sempos, Chris </p>


<h3>References</h3>

<p>Tian L., Durazo-Arvizu R. A., Myers G., Brooks S., Sarafin K., and Sempos C. T. (2014), The estimation of calibration equations for variables with heteroscedastic measurement errors, Statist. Med., 33, pages 4420-4436
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### Generate equally spaced TEST VALUES in the interval [20,200]
set.seed(123456789)
x= 20 + 180*1:100/100
x2= (x - 95)*(x&gt;=95)

# Generate REFERENCE VALUES
y = -8 + 1.5*x - 0.85*x2 + 15*rnorm(100)

#Plot test values versus reference values along with fitted piecewise model
plot(x,y)
fit.chngpt = chngpt(x,y)
plot(fit.chngpt$x[order(fit.chngpt$yfitted)],
     fit.chngpt$y[order(fit.chngpt$yfitted)],
     xlim=c(0,200), ylim=c(0,200), xlab="25-Hydroxyvitamin D (nmol/mL), IDS",
     ylab="25-Hydroxyvitamin D (nmol/mL), LC/MS", bty="n", las=1)
lines(fit.chngpt$x[order(fit.chngpt$yfitted)],
      fit.chngpt$yfitted[order(fit.chngpt$yfitted)], lty=2,col=2, lwd=2)
abline(v=fit.chngpt$chngpt, lty=2,col=3, lwd=2)
arrows(fit.chngpt$chngpt+20 ,15, fit.chngpt$chngpt,-8, length=0.1, lwd=2, col=4)
legend(fit.chngpt$chngpt + 5,30, legend=round(fit.chngpt$chngpt, digits=1),
       bty="n", col=4)


</code></pre>

<hr>
<h2 id='samplefun'>Uniformly Sampling</h2><span id='topic+samplefun'></span>

<h3>Description</h3>

<p>Draws samples uniformly (for internal use only)</p>


<h3>Usage</h3>

<pre><code class='language-R'>samplefun(x, index, n0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="samplefun_+3A_x">x</code></td>
<td>
<p> The VD values</p>
</td></tr>
<tr><td><code id="samplefun_+3A_index">index</code></td>
<td>
<p>the index for VD value, it can be 1, 2, 3,....</p>
</td></tr>
<tr><td><code id="samplefun_+3A_n0">n0</code></td>
<td>
<p>Sample size</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Uniform sampling (internal use only)</p>


<h3>Value</h3>

<table>
<tr><td><code>index</code></td>
<td>
<p>selected ids </p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p>selected VD levels</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Durazo-Arvizu, Ramon,   Sempos, Chris and Tian, Lu</p>


<h3>See Also</h3>

 <p><code><a href="#topic+sampletot">sampletot</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>x=rnorm(100)
index=1:100
samplefun(x, index, 40)

</code></pre>

<hr>
<h2 id='samplesize'> Uniform Sampling Within Quartiles </h2><span id='topic+samplesize'></span>

<h3>Description</h3>

<p>Estimates the sample size to achived the specified precision in the estimated calibration equation. </p>


<h3>Usage</h3>

<pre><code class='language-R'>samplesize(x0, d0, cutpts = c(7.5, 42.5, 57.5, 72.5, 200), CVx, CVy)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="samplesize_+3A_x0">x0</code></td>
<td>

<p>The value at which calibration will be esitmated (e.g., 30 nmol/L)
</p>
</td></tr>
<tr><td><code id="samplesize_+3A_d0">d0</code></td>
<td>

<p>Targeted width of the 95% confidence interval of the calibrated value (e.g. 5nmol/L)
</p>
</td></tr>
<tr><td><code id="samplesize_+3A_cutpts">cutpts</code></td>
<td>

<p>Cut points used to define intervals, within which samples would be selected uniformly
</p>
</td></tr>
<tr><td><code id="samplesize_+3A_cvx">CVx</code></td>
<td>

<p>CV% of the old method (e.g. 12%)
</p>
</td></tr>
<tr><td><code id="samplesize_+3A_cvy">CVy</code></td>
<td>

<p>CV% of the reference (new) method (e.g. 5%)
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function estimates the sample size to achived the specified precision in the estimated calibration equation. The precision is defined via x0 and d0</p>


<h3>Value</h3>

<p>Required sample size to achived the specified precision in the estimated calibration equation.
</p>


<h3>Author(s)</h3>

<p>Durazo-Arvizu, Ramon,   Sempos, Chris and Tian, Lu </p>


<h3>References</h3>

<p>Tian L., Durazo-Arvizu R. A., Myers G., Brooks S., Sarafin K., and Sempos C. T. (2014), The estimation of calibration equations for variables with heteroscedastic measurement errors, Statist. Med., 33, pages 4420-4436
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
samplesize(30, 5, cutpts=c(7,42,57,72,200),0.12, 0.05)

</code></pre>

<hr>
<h2 id='sampletot'>Samples Selection</h2><span id='topic+sampletot'></span>

<h3>Description</h3>

<p>Selects samples used in a calibration study</p>


<h3>Usage</h3>

<pre><code class='language-R'>sampletot(x, index, n0, K)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sampletot_+3A_x">x</code></td>
<td>
<p>the old sample measurements needing calibration</p>
</td></tr>
<tr><td><code id="sampletot_+3A_index">index</code></td>
<td>
<p> the ID list of the old sample measurements needing calibration</p>
</td></tr>
<tr><td><code id="sampletot_+3A_n0">n0</code></td>
<td>
<p>the required sample size</p>
</td></tr>
<tr><td><code id="sampletot_+3A_k">K</code></td>
<td>
<p>the number of quantiles, it is 4 if we use quartiles (recommended)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function selectes samples used in the calibration study</p>


<h3>Value</h3>

<table>
<tr><td><code>x</code></td>
<td>
<p>the selected sample measurements to be used in the calibration study</p>
</td></tr>
<tr><td><code>index</code></td>
<td>
<p>the id list of the selected samples to be used in the calibration study</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Durazo-Arvizu, Ramon,   Sempos, Chris and Tian, Lu</p>


<h3>References</h3>

<p>Tian L., Durazo-Arvizu R. A., Myers G., Brooks S., Sarafin K., and Sempos C. T. (2014), The estimation of calibration equations for variables with heteroscedastic measurement errors, Statist. Med., 33, pages 4420-4436
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
VD.value= 60 + 25*rnorm(1000)
VD.index=1:1000

### x:     the VD value
### index: the index for VD value, it can be 1, 2, 3,....
### n0:    the number of samples we want to select
### K:     the number of quantiles, it is 4 if we use quartiles

sampletot(x=VD.value, index=VD.index, n0=100, K=4)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
