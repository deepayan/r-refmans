<!DOCTYPE html><html lang="en"><head><title>Help for package AMISforInfectiousDiseases</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {AMISforInfectiousDiseases}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#AMISforInfectiousDiseases-package'><p>AMISforInfectiousDiseases: Implement the AMIS Algorithm for Infectious Disease Models</p></a></li>
<li><a href='#amis'><p>Run the AMIS algorithm to fit a transmission model to a map</p></a></li>
<li><a href='#calculate_summaries'><p>Calculate summaries of weighted statistics</p></a></li>
<li><a href='#default_amis_params'><p>Produce list containing the default AMIS parameters</p></a></li>
<li><a href='#plot_mixture_components'><p>Wrapper function for <code>plot.Mclust()</code></p></a></li>
<li><a href='#plot.amis'><p>Plot histogram or credible interval of weighted distributions given a model fitted by <code>amis()</code></p></a></li>
<li><a href='#print.amis'><p>Print method for object of class <code>amis</code></p></a></li>
<li><a href='#sample_parameters'><p>Sample parameters from their weighted distributions given a model fitted by <code>amis()</code></p></a></li>
<li><a href='#summary.amis'><p>Summary method for object of class <code>amis</code></p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Implement the AMIS Algorithm for Infectious Disease Models</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements the Adaptive Multiple Importance Sampling (AMIS) algorithm, as described by Retkute et al. (2021, &lt;<a href="https://doi.org/10.1214%2F21-AOAS1486">doi:10.1214/21-AOAS1486</a>&gt;), to estimate key epidemiological parameters by combining outputs from a geostatistical model of infectious diseases (such as prevalence, incidence, or relative risk) with a disease transmission model. Utilising the resulting posterior distributions, the package enables forward projections at the local level.</td>
</tr>
<tr>
<td>Acknowledgements:</td>
<td>This work was supported by the NTD Modelling
Consortium grant INV-030046, funded by the Bill &amp; Melinda Gates
Foundation.</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Imports:</td>
<td>Hmisc, mclust, mnormt, Rcpp, weights</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.1)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, ggplot2, patchwork, rmarkdown, sf, viridis</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/drsimonspencer/AMISforInfectiousDiseases-dev">https://github.com/drsimonspencer/AMISforInfectiousDiseases-dev</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/drsimonspencer/AMISforInfectiousDiseases-dev/issues">https://github.com/drsimonspencer/AMISforInfectiousDiseases-dev/issues</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-01-17 05:58:43 UTC; evandro</td>
</tr>
<tr>
<td>Author:</td>
<td>Evandro Konzen <a href="https://orcid.org/0000-0002-6275-1681"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Renata Retkute <a href="https://orcid.org/0000-0002-3877-6440"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Raiha Browning <a href="https://orcid.org/0000-0002-6175-2244"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Thilbault Lestang [aut],
  Simon Spencer <a href="https://orcid.org/0000-0002-8375-5542"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  University of Warwick [cph],
  Oxford Research Software Engineering [cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Simon Spencer &lt;s.e.f.spencer@warwick.ac.uk&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-01-20 16:02:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='AMISforInfectiousDiseases-package'>AMISforInfectiousDiseases: Implement the AMIS Algorithm for Infectious Disease Models</h2><span id='topic+AMISforInfectiousDiseases'></span><span id='topic+AMISforInfectiousDiseases-package'></span>

<h3>Description</h3>

<p>Implements the Adaptive Multiple Importance Sampling (AMIS) algorithm, as described by Retkute et al. (2021, <a href="https://doi.org/10.1214/21-AOAS1486">doi:10.1214/21-AOAS1486</a>), to estimate key epidemiological parameters by combining outputs from a geostatistical model of infectious diseases (such as prevalence, incidence, or relative risk) with a disease transmission model. Utilising the resulting posterior distributions, the package enables forward projections at the local level.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Simon Spencer <a href="mailto:s.e.f.spencer@warwick.ac.uk">s.e.f.spencer@warwick.ac.uk</a> (<a href="https://orcid.org/0000-0002-8375-5542">ORCID</a>)
</p>
<p>Authors:
</p>

<ul>
<li><p> Evandro Konzen (<a href="https://orcid.org/0000-0002-6275-1681">ORCID</a>)
</p>
</li>
<li><p> Renata Retkute (<a href="https://orcid.org/0000-0002-3877-6440">ORCID</a>)
</p>
</li>
<li><p> Raiha Browning (<a href="https://orcid.org/0000-0002-6175-2244">ORCID</a>)
</p>
</li>
<li><p> Thilbault Lestang
</p>
</li></ul>

<p>Other contributors:
</p>

<ul>
<li><p> University of Warwick [copyright holder]
</p>
</li>
<li><p> Oxford Research Software Engineering [copyright holder]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/drsimonspencer/AMISforInfectiousDiseases-dev">https://github.com/drsimonspencer/AMISforInfectiousDiseases-dev</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/drsimonspencer/AMISforInfectiousDiseases-dev/issues">https://github.com/drsimonspencer/AMISforInfectiousDiseases-dev/issues</a>
</p>
</li></ul>


<hr>
<h2 id='amis'>Run the AMIS algorithm to fit a transmission model to a map</h2><span id='topic+amis'></span>

<h3>Description</h3>

<p>This implements the AMIS algorithm as described in <cite>Retkute et al. (2021)</cite>.
Each iteration of the algorithm produces a set of parameters from a proposal
distribution (the prior in the first iteration). For each parameter set, a simulation
is run from the transmission model. Then, each preceding simulation is weighted at
each location according to the distribution of prevalences (or likelihood function)
at that location. A Gaussian mixture model is then fitted to the parameter samples
with weights averaged over the active locations (ie locations that have yet to reach
the effective sample size target). This Gaussian mixture informs the proposal for the
next iteration. The algorithm continues until every location has reached the ESS target,
or the maximum number of iterations is reached.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>amis(
  prevalence_map,
  transmission_model,
  prior,
  amis_params = default_amis_params(),
  seed = NULL,
  output_dir = NULL,
  initial_amis_vals = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="amis_+3A_prevalence_map">prevalence_map</code></td>
<td>
<p>For a single timepoint, <code>"prevalence_map"</code> can be an <code class="reqn">L \times M</code> matrix or data frame containing samples from a geostatistical model,
where <code class="reqn">L</code> is the number of locations and <code class="reqn">M</code> the number of samples per location.
<br /> <br /> If there are multiple timepoints and/or a parametric <code>likelihood</code> function is to be used, <code>"prevalence_map"</code> must be a list with <code class="reqn">T</code> elements, one for each timepoint <code class="reqn">t=1,\dots,T</code>.
Each element must itself be a list with the following objects:
</p>

<dl>
<dt><code>data</code></dt><dd><p>An <code class="reqn">L \times M</code> matrix as above</p>
</dd>
<dt><code>likelihood</code></dt><dd><p>(optional) A function taking arguments:
</p>

<ul>
<li> <p><code>data</code>: A vector of length <code class="reqn">M_l</code>, where <code class="reqn">M_l</code>
is the number of samples from a geostatistical model for location <code class="reqn">l</code> or
the number of likelihood parameters;
</p>
</li>
<li> <p><code>sim_prev</code>: A numeric value for a prevalence simulated from the transmission model;
</p>
</li>
<li> <p><code>log</code>: Logical indicating if calculations are to be performed on log scale
(specified in <code>"amis_params"</code>, see below).
</p>
</li></ul>

<p>The function <code>likelihood</code> must return a numeric value representing the (log-)likelihood of
observing a simulated prevalence given the data from a particular location.
</p>
</dd>
</dl>

<p>The location names are inherited from <code>rownames(prevalence_map)</code>
if <code>"prevalence_map"</code> is a matrix, and
from <code>rownames(prevalence_map[[1]]$data)</code> if <code>"prevalence_map"</code> is a list.
<br /> <br /> If <code>likelihood</code> is not specified, then it is assumed that the data consist of
samples from a geostatistical model and a nonparametric method is used. The nonparametric
method to be used is specified in <code>"amis_params"</code> using the options
<code>breaks</code>, <code>delta</code>, or <code>sigma</code> (see <code>"amis_params"</code>).
<br /> <br /></p>
</td></tr>
<tr><td><code id="amis_+3A_transmission_model">transmission_model</code></td>
<td>
<p>A function taking arguments:
</p>

<ul>
<li> <p><code>seeds</code>: a vector of <code class="reqn">n</code> seeds;
</p>
</li>
<li> <p><code>params</code>: an <code class="reqn">n \times d</code> matrix of parameter vectors;
</p>
</li>
<li> <p><code>n_tims</code>: number of time points.
</p>
</li></ul>

<p>This function must return an <code class="reqn">n \times T</code> <b>matrix</b> of prevalences
(it must be a matrix even when <code class="reqn">T=1</code>). The vector <code>seeds</code> will be the
vector of indexes of the simulated samples. If <code>n_samples</code> new samples are
drawn within each iteration of the AMIS algorithm, then the vector <code>seeds</code> will be
<code>1:n_samples</code> at the first iteration, <code>(n_samples+1):(2*n_samples)</code> at
the second iteration, and so on.</p>
</td></tr>
<tr><td><code id="amis_+3A_prior">prior</code></td>
<td>
<p>A list containing the functions <code>dprior</code> and <code>rprior</code>
(density and random number generator, respectively).
The two arguments of <code>dprior</code> must be:
</p>

<ul>
<li><p> a <code class="reqn">d</code>-length vector of transmission model parameters; and
</p>
</li>
<li><p> a logical <code>log</code> to indicate whether to calculate log-density or not.
</p>
</li></ul>

<p>The only argument of <code>rprior</code> must be a single integer <code class="reqn">n</code> that determines the number of samples to draw.
<code>rprior</code> must produce an <code class="reqn">n \times d</code> <b>matrix</b> of parameters even when <code class="reqn">d=1</code>.
Parameter names are inherited from the <code>colnames</code> of the output of <code>rprior</code>.</p>
</td></tr>
<tr><td><code id="amis_+3A_amis_params">amis_params</code></td>
<td>
<p>A list containing control parameters for the AMIS algorithm
(<code>default_amis_params()</code> returns the default values):
</p>

<dl>
<dt><code>n_samples</code></dt><dd><p>Number of new samples drawn within each AMIS iteration. Default to <code>500</code>.</p>
</dd>
<dt><code>target_ess</code></dt><dd><p>Target effective sample size. Default to <code>500</code>.</p>
</dd>
<dt><code>max_iters</code></dt><dd><p>Maximum number of AMIS iterations. Default to <code>12</code>.</p>
</dd>
<dt><code>boundaries</code></dt><dd><p>A vector of length two with the left and right boundaries for prevalences.
Default to <code>c(0,1)</code>. If, for instance, left boundary is zero and there is no right boundary,
set <code>boundaries = c(0,Inf)</code>.</p>
</dd>
<dt><code>boundaries_param</code></dt><dd><p>If specified, it should be a <code class="reqn">d \times 2</code> matrix
with the lower and upper boundaries for the <code class="reqn">d</code> transmission model parameters. Default to <code>NULL</code>.</p>
</dd>
<dt><code>log</code></dt><dd><p>Logical indicating if calculations are to be performed on log scale. Default to <code>TRUE</code>.</p>
</dd>
<dt><code>delete_induced_prior</code></dt><dd><p>Logical indicating whether the induced prior density is to be deleted in the update of weights. Default to <code>FALSE</code>.</p>
</dd>
<dt><code>mixture_samples</code></dt><dd><p>Number of samples used to represent the weighted parameters in the mixture fitting.</p>
</dd>
<dt><code>df</code></dt><dd><p>Degrees of freedom in the <code class="reqn">t</code>-distributions, used to yield a heavy tailed proposal. Default to <code>3</code>.</p>
</dd>
<dt><code>q</code></dt><dd><p>Parameter (between 0 and 1) controlling how the weights are calculated for active locations.
Default to <code>0</code>. See Details below.</p>
</dd>
<dt><code>delta</code></dt><dd><p>Optional smoothing parameter if uniform kernel (default) is used. Default to <code>0.01</code>.</p>
</dd>
<dt><code>sigma</code></dt><dd><p>Optional smoothing parameter if Gaussian kernel is used. Default to <code>NULL</code>.</p>
</dd>
<dt><code>breaks</code></dt><dd><p>Optional vector specifying the breaks for the histogram. Default to <code>NULL</code>.
For finite <code>boundaries</code>, the first and last entries of <code>breaks</code> must be
equal to the left and right boundaries, respectively.
For non-finite <code>boundaries</code>, ensure that the range of <code>breaks</code> includes any possible prevalence value.</p>
</dd>
</dl>

<p>Uniform kernel is the default method for the density estimator of the likelihood.
If <code>sigma</code> is provided, then Gaussian kernel will be used instead.
If <code>breaks</code> is provided, then histogram-based method will be the nonparametric method being used.
Note that if <code>likelihood</code> is provided in <code>prevalence_map</code>, then a parametric method will be implemented.</p>
</td></tr>
<tr><td><code id="amis_+3A_seed">seed</code></td>
<td>
<p>Optional single value interpreted as an integer.
It is the seed for the random number generator for the AMIS algorithm. This is not the same as
the <code>seeds</code> argument passed to <code>"transmission_model"</code>.</p>
</td></tr>
<tr><td><code id="amis_+3A_output_dir">output_dir</code></td>
<td>
<p>A string specifying the local directory where to save outputs
after each iteration of the algorithm. At the end of the string,
use the correct path separator for your machine's operating system.
If the directory is specified, the outputs will be saved in a file called &lsquo;amis_output.rds&rsquo;.
Default to <code>NULL</code> (i.e. outputs are not saved in a local directory).</p>
</td></tr>
<tr><td><code id="amis_+3A_initial_amis_vals">initial_amis_vals</code></td>
<td>
<p>Optional list of intermittent outputs from a
previous run (where at least one iteration was successful). These outputs can
be saved by specifying the directory <code>"output_dir"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The average weight of parameter vectors for the set of active locations at iteration <code class="reqn">i</code> <code class="reqn">\left(A_i\right)</code>
has weights determined by how far the effective sample size for location <code class="reqn">l</code> <code class="reqn">\left(\text{ESS}_l^i\right)</code>
is from the target <code class="reqn">\left(\text{ESS}^R\right)</code>:
</p>
<p style="text-align: center;"><code class="reqn">
 \bar{w}_j^i = 
 \frac{\sum_{l \in A_i}    \left(\text{ESS}^R-\text{ESS}_l^i\right)^q \hat{w}_{lj}^i   }{
 \sum_{l \in A_i} \left(\text{ESS}^R-\text{ESS}_l^i\right)^q} , \qquad q \in [0,1].
 </code>
</p>

<p>If <code class="reqn">q=0</code> (default), the simple average of individual weights will be calculated.
If <code class="reqn">q&gt;0</code>, more weight will be assigned to locations with low ESS.
</p>


<h3>Value</h3>

<p>A list of class <code>amis</code>. If the algorithm completed <code class="reqn">I</code> iterations,
it simulated a total of <code class="reqn">N = I \times</code> <code>n_samples</code>, and therefore the list returned by <code>amis()</code> will contain:
</p>

<dl>
<dt><code>seeds</code></dt><dd><p>An <code class="reqn">N</code>-length vector with the simulation seeds that were used.</p>
</dd>
<dt><code>param</code></dt><dd><p>An <code class="reqn">N \times d</code> matrix with the <code class="reqn">d</code>-dimensional transmission model parameters simulated by the algorithm.</p>
</dd>
<dt><code>simulated_prevalences</code></dt><dd><p>An <code class="reqn">N \times T</code> matrix with the simulated prevalences, where <code class="reqn">T</code> is the number of timepoints.</p>
</dd>
<dt><code>weight_matrix</code></dt><dd><p>An <code class="reqn">N \times L</code>, where <code class="reqn">L</code> is the number of locations.</p>
</dd>
<dt><code>likelihoods</code></dt><dd><p>A <code class="reqn">T \times L \times N</code> array with the likelihood of observing a simulated prevalence in each location at each time.</p>
</dd>
<dt><code>ess</code></dt><dd><p>An <code class="reqn">L</code>-length vector with the final effective sample size (ESS) for each location.</p>
</dd>
<dt><code>prevalence_map</code></dt><dd><p>List with the prevalence map supplied by the user.</p>
</dd>
<dt><code>locations_with_no_data</code></dt><dd><p>Vector indicating which locations have no data at any time point.</p>
</dd>
<dt><code>components</code></dt><dd><p>A list of the mixture components of all iterations, containing:
</p>

<ul>
<li> <p><code>G</code>: number of components in each iteration;
</p>
</li>
<li> <p><code>probs</code>: the mixture weights;
</p>
</li>
<li> <p><code>Mean</code>: the locations of the components;
</p>
</li>
<li> <p><code>Sigma</code>: the covariance matrices of the components.
</p>
</li></ul>

</dd>
<dt><code>components_per_iteration</code></dt><dd><p>A list with the mixture components at each iteration.
This object is used in <code><a href="#topic+plot_mixture_components">plot_mixture_components</a>()</code>.</p>
</dd>
<dt><code>ess_per_iteration</code></dt><dd><p>An <code class="reqn">L \times I</code> matrix with with the ESS for each location after each iteration.</p>
</dd>
<dt><code>prior_density</code></dt><dd><p>An <code class="reqn">N</code>-length vector with the density function evaluated at the simulated parameter values.</p>
</dd>
<dt><code>amis_params</code></dt><dd><p>List supplied by the user.</p>
</dd>
<dt><code>evidence</code></dt><dd><p>A list containing an estimate of the log model evidence and corresponding log variance of this estimate for both the full likelihood model
(product over all locations), and for each location individually.</p>
</dd>
</dl>



<h3>References</h3>

<p>Retkute, R., Touloupou, P., Basanez, M. G., Hollingsworth, T. D.,
Spencer, S. E. (2021). <em>Integrating geostatistical maps and infectious disease
transmission models using adaptive multiple importance sampling.</em>
The Annals of Applied Statistics, 15(4), 1980-1998. <a href="https://doi.org/10.1214/21-AOAS1486">doi:10.1214/21-AOAS1486</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Define simple "transmission" model where prevalence equals first parameter
transmission_model_identity &lt;- function(seeds, parameters, n_tims=1) {
  return(matrix(parameters[,1], ncol=1))
}

# Generate samples for prevalence map with 3 locations given by B(2,1), B(1,1)=Uniform, B(1,2). 
set.seed(123)
L &lt;- 3    # Number of locations
M &lt;- 500 # Number of map samples
prevalence_map &lt;- matrix(NA, L, M)
for (l in 1:L) {
  prevalence_map[l,] &lt;- rbeta(M, max(1,l-1), max(1,3-l))
}
rownames(prevalence_map) &lt;- c("Here","There","Somewhere else")

# Define 2D exponential prior
rprior &lt;- function(n) {
  params &lt;- matrix(NA, n, 2)
  colnames(params) &lt;- c("a","b")
  params[,1] &lt;- rexp(n)
  params[,2] &lt;- rexp(n)
  return(params)
}
dprior &lt;- function(x, log=FALSE) {
  if (log) {
    return(sum(dexp(x, log=TRUE)))
  } else {
    return(prod(dexp(x)))
  }
}
prior &lt;- list(rprior=rprior,dprior=dprior)

# Run AMIS with default control parameters
amis_params &lt;- default_amis_params()
output &lt;- amis(prevalence_map, transmission_model_identity, prior, amis_params, seed=1)

print(output)
summary(output)

original_par &lt;- par(no.readonly = TRUE)
par(cex.lab=1.5, cex.main=1.5, mar=c(5,4.5,4,2)+0.1)

par(mfrow=c(1,2))
plot_mixture_components(output, what = "uncertainty", cex=3)
plot_mixture_components(output, what = "density", nlevels=200)

par(mfrow=c(3,3))
plot(output, what = "a", type="hist", locations=1:L, breaks=100)
plot(output, what = "b", type="hist", locations=1:L, breaks=100)
plot(output, what = "prev", type="hist", locations=1:L, time=1, breaks=100)

par(mar=c(5,7.5,4,2)+0.1)
par(mfrow=c(1,3))
plot(output, what=c("a","b","prev"), type="CI", locations=1:L, ylab=NA,
     cex=3, lwd=3, measure_central="median", display_location_names=TRUE)

calculate_summaries(output, what="prev", locations=1:L, alpha=0.05)

# Generate new samples from the weighted posterior distributions
new_samples &lt;- sample_parameters(output, n_samples = 200, locations = "Here")
head(new_samples)
plot_hist &lt;- function(column_name){
  hist(new_samples[, column_name], xlab=column_name, main=paste("Histogram of", column_name))
}
par(mfrow=c(1,3))
plot_hist("a")
plot_hist("b")
plot_hist("prevalence")

par(original_par)
</code></pre>

<hr>
<h2 id='calculate_summaries'>Calculate summaries of weighted statistics</h2><span id='topic+calculate_summaries'></span>

<h3>Description</h3>

<p>Calculate summaries of weighted statistics
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculate_summaries(
  x,
  what = "prev",
  time = 1,
  locations = NULL,
  alpha = 0.05,
  exceedance_prob_threshold = 0.35
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calculate_summaries_+3A_x">x</code></td>
<td>
<p>The output from the function <code><a href="#topic+amis">amis</a>()</code>.</p>
</td></tr>
<tr><td><code id="calculate_summaries_+3A_what">what</code></td>
<td>
<p>What statistic should be calculated the summaries from.
It must be either <code>"prev"</code> or the name of one of the model parameters. Default to <code>"prev"</code>.</p>
</td></tr>
<tr><td><code id="calculate_summaries_+3A_time">time</code></td>
<td>
<p>Time point. Only used if <code>"what"</code> is set to <code>"prev"</code>.</p>
</td></tr>
<tr><td><code id="calculate_summaries_+3A_locations">locations</code></td>
<td>
<p>Integer vector or location names identifying locations where
summaries should be calculated for. If not specified, summary statistics of
all locations will be provided.</p>
</td></tr>
<tr><td><code id="calculate_summaries_+3A_alpha">alpha</code></td>
<td>
<p>Numeric value between 0 and 1. Calculations are for the <code>(alpha/2, 1-alpha/2)</code>% quantiles.</p>
</td></tr>
<tr><td><code id="calculate_summaries_+3A_exceedance_prob_threshold">exceedance_prob_threshold</code></td>
<td>
<p>Numeric value. Default to <code>0.35</code>, i.e. the
probability that the statistic of interest (e.g. prevalence) is higher than <code>0.35</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For illustrative examples, see <code><a href="#topic+amis">amis</a>()</code>.
</p>


<h3>Value</h3>

<p>A list with mean, median, and quantiles of the weighted distribution.
</p>

<hr>
<h2 id='default_amis_params'>Produce list containing the default AMIS parameters</h2><span id='topic+default_amis_params'></span>

<h3>Description</h3>

<p>For description of AMIS parameters, see argument <code>amis_params</code> in <code><a href="#topic+amis">amis</a>()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>default_amis_params()
</code></pre>


<h3>Value</h3>

<p>List containing the default AMIS parameters.
</p>

<hr>
<h2 id='plot_mixture_components'>Wrapper function for <code><a href="mclust.html#topic+plot.Mclust">plot.Mclust</a>()</code></h2><span id='topic+plot_mixture_components'></span>

<h3>Description</h3>

<p>Wrapper function for <code><a href="mclust.html#topic+plot.Mclust">plot.Mclust</a>()</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_mixture_components(
  x,
  what = "uncertainty",
  iteration = NULL,
  datapoints = "proposed",
  main = NULL,
  xlim = NULL,
  ylim = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_mixture_components_+3A_x">x</code></td>
<td>
<p>The output from the function <code><a href="#topic+amis">amis</a>()</code>.</p>
</td></tr>
<tr><td><code id="plot_mixture_components_+3A_what">what</code></td>
<td>
<p>A string specifying the type of plot requested:
</p>

<dl>
<dt><code>"uncertainty"</code></dt><dd><p>A plot of classification uncertainty (default)</p>
</dd>
<dt><code>"density"</code></dt><dd><p>A plot of estimated density</p>
</dd>
<dt><code>"BIC"</code></dt><dd><p>A plot showing BIC values used to choose the number of components</p>
</dd>
</dl>
</td></tr>
<tr><td><code id="plot_mixture_components_+3A_iteration">iteration</code></td>
<td>
<p>Integer indicating which iteration the plot should be about.
If <code>NULL</code> (default), the plot will be for the final iteration.
See more details in <code><a href="mclust.html#topic+plot.Mclust">plot.Mclust</a>()</code>.</p>
</td></tr>
<tr><td><code id="plot_mixture_components_+3A_datapoints">datapoints</code></td>
<td>
<p>A string specifying what the datapoints should represent in the
plot of classification uncertainty:
</p>

<dl>
<dt><code>"proposed"</code></dt><dd><p>datapoints will represent the samples simulated from the mixture.
The colours indicate which mixture components the samples were simulated from.</p>
</dd>
<dt><code>"fitted"</code></dt><dd><p>datapoints will show the samples that the mixture model was fitted to,
i.e. weighted samples from the previous iteration.
The colour of a datapoint indicates the most likely mixture component the sample belongs to.</p>
</dd>
</dl>
</td></tr>
<tr><td><code id="plot_mixture_components_+3A_main">main</code></td>
<td>
<p>Title of the plot. If <code>NULL</code>, the default title will be displayed. Set to <code>NA</code> for omitting title.</p>
</td></tr>
<tr><td><code id="plot_mixture_components_+3A_xlim">xlim</code></td>
<td>
<p>The x limits of the plots. Default to <code>NULL</code></p>
</td></tr>
<tr><td><code id="plot_mixture_components_+3A_ylim">ylim</code></td>
<td>
<p>The y limits of the plots. Default to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="plot_mixture_components_+3A_...">...</code></td>
<td>
<p>Other arguments to match the <code><a href="mclust.html#topic+plot.Mclust">plot.Mclust</a>()</code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For illustrative examples, see <code><a href="#topic+amis">amis</a>()</code>.
</p>


<h3>Value</h3>

<p>A plot for model-based clustering results.
</p>

<hr>
<h2 id='plot.amis'>Plot histogram or credible interval of weighted distributions given a model fitted by <code><a href="#topic+amis">amis</a>()</code></h2><span id='topic+plot.amis'></span>

<h3>Description</h3>

<p>Plot histogram or credible interval of weighted distributions given a model fitted by <code><a href="#topic+amis">amis</a>()</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'amis'
plot(
  x,
  what = "prev",
  type = "hist",
  locations = 1,
  time = 1,
  measure_central = "mean",
  order_locations_by = NULL,
  display_location_names = FALSE,
  alpha = 0.05,
  breaks = 500,
  cex = 1,
  lwd = 1,
  xlim = NULL,
  main = NULL,
  xlab = NULL,
  ylab = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.amis_+3A_x">x</code></td>
<td>
<p>The output from the function <code><a href="#topic+amis">amis</a>()</code>.</p>
</td></tr>
<tr><td><code id="plot.amis_+3A_what">what</code></td>
<td>
<p>What posterior distribution should be plotted.
It can be <code>"prev"</code> (default) for plotting prevalences, or one of the parameter names.</p>
</td></tr>
<tr><td><code id="plot.amis_+3A_type">type</code></td>
<td>
<p>Type of plot. It can be <code>"hist"</code> (default) for histogram,
or <code>"CI"</code> for credible intervals</p>
</td></tr>
<tr><td><code id="plot.amis_+3A_locations">locations</code></td>
<td>
<p>Integer vector or location names identifying locations the plots are made for. Default to <code>1</code> (first location).</p>
</td></tr>
<tr><td><code id="plot.amis_+3A_time">time</code></td>
<td>
<p>Integer index identifying the timepoint. Default to <code>1</code>.</p>
</td></tr>
<tr><td><code id="plot.amis_+3A_measure_central">measure_central</code></td>
<td>
<p>Measure of central tendency for credible interval plots.
It can be <code>"mean"</code> (default) or <code>"median"</code>.</p>
</td></tr>
<tr><td><code id="plot.amis_+3A_order_locations_by">order_locations_by</code></td>
<td>
<p>How the credible intervals of multiple locations should be ordered.
If <code>NULL</code> (default), locations are displayed according to the argument <code>"locations"</code>.
Otherwise, it must be either <code>"prev"</code> or one of the parameter names, and then the
locations are ranked by the corresponding measure of central tendency.</p>
</td></tr>
<tr><td><code id="plot.amis_+3A_display_location_names">display_location_names</code></td>
<td>
<p>Logical indicating whether location names are to be shown or not
in credible interval plots. Default to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="plot.amis_+3A_alpha">alpha</code></td>
<td>
<p>Numeric value between 0 and 1 indicating the endpoints of the
credible intervals, which are evaluated at (alpha/2, 1-alpha/2)% quantiles.
Default (<code>0.05</code>) will create 95% credible intervals.</p>
</td></tr>
<tr><td><code id="plot.amis_+3A_breaks">breaks</code></td>
<td>
<p>Argument passed to <code><a href="weights.html#topic+wtd.hist">wtd.hist</a>()</code> for histogram plots.
Default to <code>500</code>.</p>
</td></tr>
<tr><td><code id="plot.amis_+3A_cex">cex</code></td>
<td>
<p>Argument passed to plots of credible intervals.
Default to <code>1</code>.</p>
</td></tr>
<tr><td><code id="plot.amis_+3A_lwd">lwd</code></td>
<td>
<p>Argument passed to plots of credible intervals.
Default to <code>1</code>.</p>
</td></tr>
<tr><td><code id="plot.amis_+3A_xlim">xlim</code></td>
<td>
<p>The x limits of the plots. For for credible intervals of multiple
statistics (i.e. <code>length(what)&gt;1)</code>, it must be either <code>NULL</code> or a list with
the x limits for each statistic. Default to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="plot.amis_+3A_main">main</code></td>
<td>
<p>Title for the plot.</p>
</td></tr>
<tr><td><code id="plot.amis_+3A_xlab">xlab</code></td>
<td>
<p>Lable for the x axis.</p>
</td></tr>
<tr><td><code id="plot.amis_+3A_ylab">ylab</code></td>
<td>
<p>Lable for the y axis.</p>
</td></tr>
<tr><td><code id="plot.amis_+3A_...">...</code></td>
<td>
<p>Other graphical parameters passed to <code><a href="weights.html#topic+wtd.hist">wtd.hist</a>()</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For illustrative examples, see <code><a href="#topic+amis">amis</a>()</code>.
</p>


<h3>Value</h3>

<p>A plot.
</p>

<hr>
<h2 id='print.amis'>Print method for object of class <code>amis</code></h2><span id='topic+print.amis'></span>

<h3>Description</h3>

<p>Print method for object of class <code>amis</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'amis'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.amis_+3A_x">x</code></td>
<td>
<p>The output from the function <code><a href="#topic+amis">amis</a>()</code>.</p>
</td></tr>
<tr><td><code id="print.amis_+3A_...">...</code></td>
<td>
<p>Other arguments to match the generic <code>print()</code> function</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For illustrative examples, see <code><a href="#topic+amis">amis</a>()</code>.
</p>


<h3>Value</h3>

<p>Brief description of data and model specifications used to run <code><a href="#topic+amis">amis</a>()</code>.
</p>

<hr>
<h2 id='sample_parameters'>Sample parameters from their weighted distributions given a model fitted by <code><a href="#topic+amis">amis</a>()</code></h2><span id='topic+sample_parameters'></span>

<h3>Description</h3>

<p>Sample parameters from their weighted distributions given a model fitted by <code><a href="#topic+amis">amis</a>()</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sample_parameters(x, n_samples = 200, locations = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sample_parameters_+3A_x">x</code></td>
<td>
<p>The output from the function <code><a href="#topic+amis">amis</a>()</code>.</p>
</td></tr>
<tr><td><code id="sample_parameters_+3A_n_samples">n_samples</code></td>
<td>
<p>Number of samples to draw. Default to <code>200</code>.</p>
</td></tr>
<tr><td><code id="sample_parameters_+3A_locations">locations</code></td>
<td>
<p>Integer identifying the locations. Default to <code>1</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For illustrative examples, see <code><a href="#topic+amis">amis</a>()</code>.
</p>


<h3>Value</h3>

<p>Matrix with parameter values and corresponding prevalences for each location.
</p>

<hr>
<h2 id='summary.amis'>Summary method for object of class <code>amis</code></h2><span id='topic+summary.amis'></span>

<h3>Description</h3>

<p>Summary method for object of class <code>amis</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'amis'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.amis_+3A_object">object</code></td>
<td>
<p>The output from the function <code><a href="#topic+amis">amis</a>()</code>.</p>
</td></tr>
<tr><td><code id="summary.amis_+3A_...">...</code></td>
<td>
<p>Other arguments to match the generic <code>summary()</code> function</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For illustrative examples, see <code><a href="#topic+amis">amis</a>()</code>.
</p>


<h3>Value</h3>

<p>Summary statistics of the fitted model.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
