<!DOCTYPE html><html lang="en"><head><title>Help for package dendrometeR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {dendrometeR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#climate_seg'><p>Segmenting climate and environmental data</p></a></li>
<li><a href='#cycle_stats'><p>Define stem cycles and calculate statistics for all cyclic phases</p></a></li>
<li><a href='#daily_stats'><p>Calculate daily statistics for dendrometer and environmental data</p></a></li>
<li><a href='#dendro.resolution'><p>Check the resolution of the data</p></a></li>
<li><a href='#dmCD'><p>Pre-processed dendrometer data from Camp Daniel, Canada</p></a></li>
<li><a href='#dmCDraw'><p>Raw dendrometer data from Camp Daniel, Canada</p></a></li>
<li><a href='#dmED'><p>Pre-processed dendrometer data from Eldena, Germany</p></a></li>
<li><a href='#dmEDraw'><p>Raw dendrometer data from Eldena, Germany</p></a></li>
<li><a href='#dmHS'><p>Pre-processed dendrometer data from Hinnensee, Germany</p></a></li>
<li><a href='#dmHSraw'><p>Raw dendrometer data from Hinnensee, Germany</p></a></li>
<li><a href='#envED'><p>Environmental data from Eldena, Germany</p></a></li>
<li><a href='#fill_gaps'><p>Fill gaps in dendrometer series</p></a></li>
<li><a href='#fill_plot'><p>Plot gap-filled dendrometer series</p></a></li>
<li><a href='#is.dendro'><p>Check input data</p></a></li>
<li><a href='#phase_def'><p>Define stem-cyclic phases</p></a></li>
<li><a href='#phase_plot'><p>Plot stem-cyclic phases</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Analyzing Dendrometer Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.1</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Marko Smiljanic &lt;marko.smiljanic313@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Various functions to import, verify, process and plot 
    high-resolution dendrometer data using daily and stem-cycle approaches 
    as described in Deslauriers et al, 2007 &lt;<a href="https://doi.org/10.1016%2Fj.dendro.2007.05.003">doi:10.1016/j.dendro.2007.05.003</a>&gt;. 
    For more details about the package please see: 
    Van der Maaten et al. 2016 &lt;<a href="https://doi.org/10.1016%2Fj.dendro.2016.06.001">doi:10.1016/j.dendro.2016.06.001</a>&gt;. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/smiljanicm/dendrometeR">https://github.com/smiljanicm/dendrometeR</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/smiljanicm/dendrometeR/issues">https://github.com/smiljanicm/dendrometeR/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0), forecast, graphics, grDevices, pspline, stats,
zoo</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-02-21 08:57:44 UTC; smiljanicm</td>
</tr>
<tr>
<td>Author:</td>
<td>Olivier Bouriaud [aut],
  Ernst van der Maaten [aut],
  Marieke van der Maaten-Theunissen [aut],
  Marko Smiljanic [aut, cre]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-02-21 13:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='climate_seg'>Segmenting climate and environmental data</h2><span id='topic+climate_seg'></span>

<h3>Description</h3>

<p>The function calculates means or sums, or extracts minimum or maximum values of environmental parameters for stem-cyclic phases as defined using <code><a href="#topic+cycle_stats">cycle_stats</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>climate_seg(env.data, dm.stats, value = c("mean", "min",
            "max", "sum"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="climate_seg_+3A_env.data">env.data</code></td>
<td>
<p>a <code>data.frame</code> with with a timestamp (<code>%Y-%m-%d %H:%M:%S</code> format) as row names, and a certain climate parameter (e.g., temperature or precipitation) in columns.</p>
</td></tr>
<tr><td><code id="climate_seg_+3A_dm.stats">dm.stats</code></td>
<td>
<p>a <code>list</code> as produced by <code><a href="#topic+cycle_stats">cycle_stats</a></code>.</p>
</td></tr>
<tr><td><code id="climate_seg_+3A_value">value</code></td>
<td>
<p>a <code>character</code> string of <code>"mean"</code>, <code>"min"</code>, <code>"max"</code> or <code>"sum"</code>, specifying whether means (e.g., for temperature) or sums (e.g., for precipitation) should be calculated, or minimum or maximum values should be extracted. Defaults to <code>"mean"</code>. Argument matching is performed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function segments environmental parameters according to the stem-cyclic phases as defined using <code><a href="#topic+cycle_stats">cycle_stats</a></code>. Means, sums, and minimum and maximum values can be calculated or extracted.
</p>
<p><code>env.data</code> should cover at least the same period as the dendrometer data used to define the cyclic phases, and should have the same (or a higher) temporal resolution.
</p>


<h3>Value</h3>

<p>The function returns a <code>data.frame</code> with segmented environmental data. The <code>data.frame</code> contains the following columns:
</p>
<table role = "presentation">
<tr><td><code>dmID</code></td>
<td>
<p>dendrometer ID.</p>
</td></tr>
<tr><td><code>cycle</code></td>
<td>
<p>cycle number.</p>
</td></tr>
<tr><td><code>phase</code></td>
<td>
<p>cyclic phase (1: contraction, 2: expansion, 3: stem-radius increment, 4: full cycle).</p>
</td></tr>
<tr><td><code>begin</code></td>
<td>
<p>timestamp indicating the beginning of each phase.</p>
</td></tr>
<tr><td><code>end</code></td>
<td>
<p>timestamp indicating the end of each phase.</p>
</td></tr>
<tr><td><code>...</code></td>
<td>
<p>columns with segmented environmental data (mean, min, max or sum).</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
data(dmED)
dm.gpf &lt;- fill_gaps(dmED)
dm.phase &lt;- phase_def(dm.gpf)
dm.stats &lt;- cycle_stats(dm.gpf, dm.phase)
data(envED)
clim.phase &lt;- climate_seg(envED, dm.stats, value = "mean")


</code></pre>

<hr>
<h2 id='cycle_stats'>Define stem cycles and calculate statistics for all cyclic phases</h2><span id='topic+cycle_stats'></span>

<h3>Description</h3>

<p>The function defines stem cycles from output of <code><a href="#topic+phase_def">phase_def</a></code> and calculates statistics for complete cycles as well as for the phases of contraction, expansion and stem-radius increment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cycle_stats(dm.gpf, dm.phase, sensor = 1, smooth.param = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cycle_stats_+3A_dm.gpf">dm.gpf</code></td>
<td>
<p>a <code>data.frame</code> with either gap-free or gap-filled dendrometer series as produced by <code><a href="#topic+fill_gaps">fill_gaps</a></code>.</p>
</td></tr>
<tr><td><code id="cycle_stats_+3A_dm.phase">dm.phase</code></td>
<td>
<p>a <code>data.frame</code> with numbers indicating the different stem-cyclic phases. Output of <code><a href="#topic+phase_def">phase_def</a></code>.</p>
</td></tr>
<tr><td><code id="cycle_stats_+3A_sensor">sensor</code></td>
<td>
<p>a <code>numeric</code> specifying the sensor to be used in the function. Defaults to 1 (first column in both <code>data.frames</code>).</p>
</td></tr>
<tr><td><code id="cycle_stats_+3A_smooth.param">smooth.param</code></td>
<td>
<p>a <code>numeric</code> specifying the degree of smoothing. Defaults to 1 (no smoothing).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function uses the output of <code><a href="#topic+phase_def">phase_def</a></code> to define stem cycles and to calculate statistics for all cyclic phases. These statistics include the timing and duration of each phase, as well as information on stem-size changes. The function works for single dendrometer series, which are defined by the argument <code>sensor</code>.
</p>
<p>The function includes a smoothing option (argument <code>smooth.param</code>) particularly for noisy datasets in which outliers may under- or overestimate the minimum and maximum stem size within phases and stem cycles. By default, no smoothing is performed.
</p>


<h3>Value</h3>

<p>The function returns a <code>list</code> with:
</p>
<ul>
<li><p>a <code>data.frame</code> named <code>cycleStats</code> containing the following summary statistics:</p>
</li></ul>

<table role = "presentation">
<tr><td><code>dmID</code></td>
<td>
<p>dendrometer ID.</p>
</td></tr>
<tr><td><code>cycle</code></td>
<td>
<p>cycle number.</p>
</td></tr>
<tr><td><code>phase</code></td>
<td>
<p>cyclic phase (1: contraction, 2: expansion, 3: stem-radius increment, 4: full cycle).</p>
</td></tr>
<tr><td><code>begin</code></td>
<td>
<p>timestamp indicating the beginning of each phase.</p>
</td></tr>
<tr><td><code>end</code></td>
<td>
<p>timestamp indicating the end of each phase.</p>
</td></tr>
<tr><td><code>duration_h</code></td>
<td>
<p>phase duration in hours.</p>
</td></tr>
<tr><td><code>duration_m</code></td>
<td>
<p>phase duration in minutes.</p>
</td></tr>
<tr><td><code>magnitude</code></td>
<td>
<p>magnitude of stem-size changes in each phase.</p>
</td></tr>
<tr><td><code>min</code></td>
<td>
<p>minimum stem size within each phase.</p>
</td></tr>
<tr><td><code>max</code></td>
<td>
<p>maximum stem size within each phase.</p>
</td></tr>
</table>
<ul>
<li><p>a <code>data.frame</code> named <code>cycle.df</code> containing, for all individual records, the following columns:</p>
</li></ul>

<table role = "presentation">
<tr><td><code>dmID</code></td>
<td>
<p>dendrometer ID.</p>
</td></tr>
<tr><td><code>cycle</code></td>
<td>
<p>cycle number.</p>
</td></tr>
<tr><td><code>phase</code></td>
<td>
<p>cyclic phase (1: contraction, 2: expansion, 3: stem-radius increment, 4: full cycle).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Olivier Bouriaud, Ernst van der Maaten and Marieke van der Maaten-Theunissen.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dmCD)
dm.phase &lt;- phase_def(dmCD)
dm.stats &lt;- cycle_stats(dmCD, dm.phase)

</code></pre>

<hr>
<h2 id='daily_stats'>Calculate daily statistics for dendrometer and environmental data</h2><span id='topic+daily_stats'></span>

<h3>Description</h3>

<p>The function calculates various daily statistics for dendrometer and environmental data. It either returns multiple statistics for individual sensors, or a single statistic for multiple sensors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>daily_stats(dm.data, sensor = 1, value = c("mean", "min",
            "max", "sum"), smooth.param = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="daily_stats_+3A_dm.data">dm.data</code></td>
<td>
<p>a <code>data.frame</code> with a timestamp (<code>%Y-%m-%d %H:%M:%S</code> format) as row names, and dendrometer series in columns. Output as created using code from the <code>Import dendrometer data</code> vignette, or gap-filled dendrometer series as produced by <code><a href="#topic+fill_gaps">fill_gaps</a></code>. Environmental data can be specified as well, and should be formatted as dendrometer data.</p>
</td></tr>
<tr><td><code id="daily_stats_+3A_sensor">sensor</code></td>
<td>
<p>a <code>numeric</code> or <code>character</code> string specifying the sensor(s) to be used in the function. Defaults to 1 (first column of <code>data.frame</code>). If &quot;ALL&quot; is specified, a single <code>value</code> will be calculated or extracted for all series in the <code>data.frame</code>.</p>
</td></tr>
<tr><td><code id="daily_stats_+3A_value">value</code></td>
<td>
<p>a <code>character</code> string of <code>"mean"</code>, <code>"min"</code>, <code>"max"</code> or <code>"sum"</code>, specifying the daily statistic to be calculated or extracted. Optional argument for <code>sensor = "ALL"</code>, defaults to <code>"mean"</code>. Argument matching is performed.</p>
</td></tr>
<tr><td><code id="daily_stats_+3A_smooth.param">smooth.param</code></td>
<td>
<p>a <code>numeric</code> specifying the degree of smoothing. Defaults to 1 (no smoothing). In case smoothing is applied, series should be gap-free or gap-filled.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function calculates various daily statistics for dendrometer and environmental data. For <code>sensor</code> is <code>numeric</code>, the function returns multiple statistics for a single sensor. For <code>sensor = "ALL"</code>, the function returns a single statistic (i.e. <code>"mean"</code>, <code>"min"</code>, <code>"max"</code> or <code>"sum"</code>) for all columns of the <code>data.frame</code>, whereby <code>"sum"</code> is particularly relevant for environmental parameters like precipitation.
</p>
<p>The function includes a smoothing option (argument <code>smooth.param</code>) particularly for noisy datasets in which outliers may under- or overestimate minimum and maximum stem sizes within days. By default, no smoothing is performed. Smoothing requires gap-free series.
</p>


<h3>Value</h3>

<p>The function returns:
</p>
<ul>
<li><p>for <code>sensor</code> is <code>numeric</code>, a <code>data.frame</code> containing the following columns:</p>
</li></ul>

<table role = "presentation">
<tr><td><code>dmID</code></td>
<td>
<p>dendrometer ID.</p>
</td></tr>
<tr><td><code>date</code></td>
<td>
<p>timestamp in <code>%Y-%m-%d</code> format.</p>
</td></tr>
<tr><td><code>DOY</code></td>
<td>
<p>day of year.</p>
</td></tr>
<tr><td><code>min</code></td>
<td>
<p>minimum daily stem size.</p>
</td></tr>
<tr><td><code>mean</code></td>
<td>
<p>mean daily stem size.</p>
</td></tr>
<tr><td><code>max</code></td>
<td>
<p>maximum daily stem size.</p>
</td></tr>
<tr><td><code>amplitude</code></td>
<td>
<p>amplitude of daily stem-size changes (i.e. max - min).</p>
</td></tr>
<tr><td><code>time_min</code></td>
<td>
<p>timestamp indicating the timing of the minimum.</p>
</td></tr>
<tr><td><code>time_max</code></td>
<td>
<p>timestamp indicating the timing of the maximum.</p>
</td></tr>
</table>
<ul>
<li><p>for <code>sensor</code> is <code>"ALL"</code>:</p>
</li></ul>

<p>a <code>data.frame</code> with a timestamp (<code>%Y-%m-%d</code>) as row names, and processed dendrometer or environmental data in columns (i.e. mean, minimum, maximum or sum).
</p>


<h3>Author(s)</h3>

<p>Olivier Bouriaud, Ernst van der Maaten and Marieke van der Maaten-Theunissen.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dmCD)
dm.daily &lt;- daily_stats(dmCD, sensor = 1)

data(dmED)
dm.daily &lt;- daily_stats(dmED, sensor = "ALL", value = "max")

</code></pre>

<hr>
<h2 id='dendro.resolution'>Check the resolution of the data</h2><span id='topic+dendro.resolution'></span>

<h3>Description</h3>

<p>The function provides the resolution of the dendrometer data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dendro.resolution(dm.data, unts = c("secs", "mins", "hours", "days"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dendro.resolution_+3A_dm.data">dm.data</code></td>
<td>
<p>a <code>data.frame</code> with a timestamp (<code>%Y-%m-%d %H:%M:%S</code> format) as row names, and dendrometer series in columns. Output as created using code from the <code>Import dendrometer data</code> vignette.</p>
</td></tr>
<tr><td><code id="dendro.resolution_+3A_unts">unts</code></td>
<td>
<p>a <code>character</code> string of &quot;secs&quot;, &quot;mins&quot;, &quot;hours&quot;, &quot;days&quot;, specifiying the units in which the resolution should be calculated. Defaults to <code>"secs"</code>. Argument matching is performed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns the resolution of the data in the desired unit.
</p>


<h3>Author(s)</h3>

<p>Marko Smiljanic
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dmCD, dmHS, dmED)
dendro.resolution(dmCD, unts = "hours")
dendro.resolution(dmHS, unts = "hours")
dendro.resolution(dmED, unts = "mins")

</code></pre>

<hr>
<h2 id='dmCD'>Pre-processed dendrometer data from Camp Daniel, Canada</h2><span id='topic+dmCD'></span>

<h3>Description</h3>

<p>This dataset presents a pre-processed version of <code><a href="#topic+dmCDraw">dmCDraw</a></code>, in which different time variables were converted to a timestamp using code provided in the <code>Import dendrometer data</code> vignette.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(dmCD)
</code></pre>


<h3>Format</h3>

<p>A <code>data.frame</code> with a timestamp (<code>%Y-%m-%d %H:%M:%S</code> format) as row names, and the dendrometer series in the first column.
</p>

<hr>
<h2 id='dmCDraw'>Raw dendrometer data from Camp Daniel, Canada</h2><span id='topic+dmCDraw'></span>

<h3>Description</h3>

<p>This dataset presents hourly dendrometer series for a black spruce (<em>Picea mariana</em> (Mill.) BSP) tree from Camp Daniel, Canada, for the year 2008.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(dmCDraw)
</code></pre>


<h3>Format</h3>

<p>A <code>data.frame</code> with a dendrometer series and various time variables.
</p>


<h3>Source</h3>

<p>Sergio Rossi
</p>

<hr>
<h2 id='dmED'>Pre-processed dendrometer data from Eldena, Germany</h2><span id='topic+dmED'></span>

<h3>Description</h3>

<p>This dataset presents a pre-processed version of <code><a href="#topic+dmEDraw">dmEDraw</a></code>, using code provided in the <code>Import dendrometer data</code> vignette.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(dmED)
</code></pre>


<h3>Format</h3>

<p>A <code>data.frame</code> with a timestamp (<code>%Y-%m-%d %H:%M:%S</code> format) as row names, and the two dendrometer series in the first and second column.
</p>

<hr>
<h2 id='dmEDraw'>Raw dendrometer data from Eldena, Germany</h2><span id='topic+dmEDraw'></span>

<h3>Description</h3>

<p>This dataset presents half-hourly dendrometer series for two European beech (<em>Fagus sylvatica</em> L.) trees from the monitoring plot Eldena, Germany, for the year 2015.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(dmEDraw)
</code></pre>


<h3>Format</h3>

<p>A <code>data.frame</code> with dendrometer series and a timestamp.
</p>


<h3>Source</h3>

<p>Martin Wilmking
</p>

<hr>
<h2 id='dmHS'>Pre-processed dendrometer data from Hinnensee, Germany</h2><span id='topic+dmHS'></span>

<h3>Description</h3>

<p>This dataset presents a pre-processed version of <code><a href="#topic+dmHSraw">dmHSraw</a></code>, using code provided in the <code>Import dendrometer data</code> vignette.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(dmHS)
</code></pre>


<h3>Format</h3>

<p>A <code>data.frame</code> with a timestamp (<code>%Y-%m-%d %H:%M:%S</code> format) as row names, and the dendrometer series in the first column.
</p>

<hr>
<h2 id='dmHSraw'>Raw dendrometer data from Hinnensee, Germany</h2><span id='topic+dmHSraw'></span>

<h3>Description</h3>

<p>This dataset presents half-hourly dendrometer series for a European beech (<em>Fagus sylvatica</em> L.) tree from the monitoring plot Hinnensee, Germany, for the year 2012.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(dmHSraw)
</code></pre>


<h3>Format</h3>

<p>A <code>data.frame</code> with a dendrometer series and various time variables.
</p>


<h3>Source</h3>

<p>Sonia Simard
</p>

<hr>
<h2 id='envED'>Environmental data from Eldena, Germany</h2><span id='topic+envED'></span>

<h3>Description</h3>

<p>This dataset presents some temperature data from the monitoring plot Eldena, Germany, for the year 2015.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(envED)
</code></pre>


<h3>Format</h3>

<p>A <code>data.frame</code> with a timestamp (<code>%Y-%m-%d %H:%M:%S</code> format) as row names, and air and soil temperature parameters in columns.
</p>


<h3>Source</h3>

<p>Martin Wilmking
</p>

<hr>
<h2 id='fill_gaps'>Fill gaps in dendrometer series</h2><span id='topic+fill_gaps'></span>

<h3>Description</h3>

<p>The function fills gaps in a <code>data.frame</code> with dendrometer series using an ARMA model (cf. Deslauriers et al. 2011), and is designed for single growing seasons. The function is able to fill gaps of short duration (i.e. several hours), but cannot sensibly handle long gaps.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fill_gaps(dm.data, Hz = 0.01, season = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fill_gaps_+3A_dm.data">dm.data</code></td>
<td>
<p>a <code>data.frame</code> with a timestamp (<code>%Y-%m-%d %H:%M:%S</code> format) as row names, and dendrometer series in columns. Output as created using code from the <code>Import dendrometer data</code> vignette.</p>
</td></tr>
<tr><td><code id="fill_gaps_+3A_hz">Hz</code></td>
<td>
<p>a <code>numeric</code> specifying the parameter for smoothing with ARMA gap-filling. A higher value means rougher smoothing. Defaults to 0.01.</p>
</td></tr>
<tr><td><code id="fill_gaps_+3A_season">season</code></td>
<td>
<p>a <code>logical</code> indicating whether <code><a href="forecast.html#topic+auto.arima">auto.arima</a></code> should check seasonal models; can be very slow. Defaults to FALSE, i.e. search restricted to non-seasonal models.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function uses <code><a href="forecast.html#topic+auto.arima">auto.arima</a></code> to fill missing records. The non-seasonal part of the model is specified by the three integer components: the AR order <em>p</em>, the degree of differencing <em>d</em>, and the MA order <em>q</em>. For the seasonal part of the model, the period parameter is set equal to the number of daily measurements observed in the dendrometer data. The output of the ARMA model is smoothed using <code><a href="pspline.html#topic+smooth.Pspline">smooth.Pspline</a></code>. The smoothing parameter Hz can be adjusted; defaults to 0.01.
</p>
<p>The function is designed for single growing seasons, amongst others because ARMA-based gap-filling routines will then perform best (i.e. ARMA parameters might be distinct for individual growing seasons). To allow the usage of <code><a href="#topic+fill_gaps">fill_gaps</a></code> for datasets from the Southern Hemisphere, the input data may contain two consecutive calendar years.
</p>


<h3>Value</h3>

<p>The function returns a <code>data.frame</code> with gap-filled dendrometer series.
</p>


<h3>Author(s)</h3>

<p>Olivier Bouriaud, Ernst van der Maaten, Marieke van der Maaten-Theunissen and Marko Smiljanic.
</p>


<h3>References</h3>

<p>Deslauriers, A., Rossi, S., Turcotte, A., Morin, H. and Krause, C. (2011) A three-step procedure in SAS to analyze the time series from automatic dendrometers. <em>Dendrochronologia</em> 29: 151-161.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(dmCD)

# creating some artificial gaps (for demonstration purposes):
dmCD[c(873:877,985:990),1] &lt;- NA

# slow, as also seasonal models are checked, but best possible gap-filling:
dm.gpf &lt;- fill_gaps(dmCD, Hz = 0.01, season = TRUE)


</code></pre>

<hr>
<h2 id='fill_plot'>Plot gap-filled dendrometer series</h2><span id='topic+fill_plot'></span>

<h3>Description</h3>

<p>The function creates a plot with gap-filled and original dendrometer series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fill_plot(dm.data, dm.gpf, sensor = 1, year = NULL,
          period = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fill_plot_+3A_dm.data">dm.data</code></td>
<td>
<p>a <code>data.frame</code> with a timestamp (<code>%Y-%m-%d %H:%M:%S</code> format) as row names, and dendrometer series in columns. Output as created using code from the <code>Import dendrometer data</code> vignette.</p>
</td></tr>
<tr><td><code id="fill_plot_+3A_dm.gpf">dm.gpf</code></td>
<td>
<p>a <code>data.frame</code> with gap-filled dendrometer series as produced by <code><a href="#topic+fill_gaps">fill_gaps</a></code>.</p>
</td></tr>
<tr><td><code id="fill_plot_+3A_sensor">sensor</code></td>
<td>
<p>a <code>numeric</code> specifying the sensor to be plotted (by column number). Defaults to 1 (first dendrometer series in both <code>data.frames</code>).</p>
</td></tr>
<tr><td><code id="fill_plot_+3A_year">year</code></td>
<td>
<p>a <code>numeric</code> specifying the year(s) to be plotted. Defaults to the first year in the dataset. Two consecutive years (e.g., for a growing season at the Southern Hemisphere) can be defined with <code>year = c(year1, year2)</code>.</p>
</td></tr>
<tr><td><code id="fill_plot_+3A_period">period</code></td>
<td>
<p>a <code>numeric</code> indicating the period to be plotted, specified using day of year values (begin and end). Defaults to the complete data period.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function creates a plot showing the gap-filling results for a single dendrometer series over a specified time window. Although the function is intended to plot short time periods (within a growing season), it can plot two calendar years at maximum (e.g., 2014-2015), thereby allowing the visualization of a complete growing season at the Southern Hemisphere as well.
</p>


<h3>Value</h3>

<p>Plot.
</p>


<h3>Author(s)</h3>

<p>Olivier Bouriaud, Ernst van der Maaten and Marieke van der Maaten-Theunissen.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

data(dmCD)
## creating some artificial gaps (for demonstration purposes):
dmCD[c(873:877,985:990),1] &lt;- NA
dm.gpf &lt;- fill_gaps(dmCD, Hz = 0.01)
fill_plot(dmCD, dm.gpf, period = c(137,144))


</code></pre>

<hr>
<h2 id='is.dendro'>Check input data</h2><span id='topic+is.dendro'></span>

<h3>Description</h3>

<p>The function checks whether the input data is in the required format, as described in the <code>Import</code> <code>dendrometer</code> <code>data</code> vignette.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.dendro(dm.data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="is.dendro_+3A_dm.data">dm.data</code></td>
<td>
<p>a <code>data.frame</code> with a timestamp (<code>%Y-%m-%d %H:%M:%S</code> format) as row names, and dendrometer series in columns. Output as created using code from the <code>Import dendrometer data</code> vignette.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns <code>TRUE</code> if the input data is valid and <code>FALSE</code> otherwise. In the latter case, specific error messages are given as well.
</p>


<h3>Author(s)</h3>

<p>Ernst van der Maaten, Marieke van der Maaten-Theunissen and Marko Smiljanic.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dmCD, dmHS, dmED)
is.dendro(dmCD)
is.dendro(dmHS)
is.dendro(dmED)

</code></pre>

<hr>
<h2 id='phase_def'>Define stem-cyclic phases</h2><span id='topic+phase_def'></span>

<h3>Description</h3>

<p>The function identifies and assigns each timestamp to one of the three distinct phases of contraction, expansion and stem-radius increment (Deslauriers et al. 2011) for dendrometer series from a <code>data.frame</code> with gap-free dendrometer data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>phase_def(dm.gpf, resolution = dendro.resolution(dm.gpf),
          shapeSensitivity = 0.6, minmaxDist = 0.2, minmaxSD = 2,
          radialIncrease = "max")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="phase_def_+3A_dm.gpf">dm.gpf</code></td>
<td>
<p>a <code>data.frame</code> with either gap-free or gap-filled dendrometer series as produced by <code><a href="#topic+fill_gaps">fill_gaps</a></code>.</p>
</td></tr>
<tr><td><code id="phase_def_+3A_resolution">resolution</code></td>
<td>
<p>a <code>numeric</code> specifying the resolution of the dendrometer data in seconds. Defaults to the resolution of <code>dm.gpf</code> as calculated using <code><a href="#topic+dendro.resolution">dendro.resolution</a></code>.</p>
</td></tr>
<tr><td><code id="phase_def_+3A_shapesensitivity">shapeSensitivity</code></td>
<td>
<p>a <code>numeric</code> specifying a time window, defined as proportion of a single day. Within this time window possible extrema points (i.e. minimum and maximum) in dendrometer measurements are searched for. Defaults to 0.6 (60 percent of a day). See details for further explanation.</p>
</td></tr>
<tr><td><code id="phase_def_+3A_minmaxdist">minmaxDist</code></td>
<td>
<p>a <code>numeric</code> specifying the minimum temporal distance between consecutive minimum and maximum points (i.e. in the x direction). Defaults to 0.2 (20 percent of a day).</p>
</td></tr>
<tr><td><code id="phase_def_+3A_minmaxsd">minmaxSD</code></td>
<td>
<p>a <code>numeric</code> specifying the minimum difference between consecutive minimum and maximum points expressed as a number of standard deviations (i.e. in the y direction). Defaults to 2.</p>
</td></tr>
<tr><td><code id="phase_def_+3A_radialincrease">radialIncrease</code></td>
<td>
<p>a <code>character</code> string of <code>"max", "min", "mid"</code>, specifying when the stem-radius increment phase should start, with <code>"max"</code> as the most, and <code>"min"</code> as the least conservative approach; <code>"mid"</code> is in between. See details for further explanation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function defines the stem-cyclic phases of contraction, expansion, and stem-radius increment, as described in Deslauriers et al. (2011). The function is a more robust version of the original SAS routine, as its architecture allows to handle noisy data as well.
</p>
<p>First, the function searches for minimum and maximum points within a daily time window as specified by <code>shapeSensitivity</code>. Then, the original dendrometer series are offset by <code>(1 - shapeSensitivity) / 2</code> in both directions to assure whether the identified extrema are indeed the extrema of cyclic phases. A comparison between the original and offset series allows to select all appropriate minimum and maximum values.
</p>
<p>The arguments <code>minmaxDist</code> and <code>minmaxSD</code> specify the temporal distance and the minimum difference between consecutive minimum and maximum points (i.e. in x and y direction), respectively. The argument <code>radialIncrease</code> determines from which moment on data points should be assigned to the stem-radius increment phase: when points are continuously above the previous maximum (<code>"max"</code>), when a single data point is above the previous maximum (<code>"min"</code>), or right in between <code>"min"</code> and <code>"max"</code> (<code>"mid"</code>).
</p>


<h3>Value</h3>

<p>The function returns a <code>data.frame</code> with numbers indicating the different stem-cyclic phases: (1) contraction, (2) expansion, (3) stem-radius increment for each timestamp.
</p>


<h3>Author(s)</h3>

<p>Marko Smiljanic
</p>


<h3>References</h3>

<p>Deslauriers, A., Rossi, S., Turcotte, A., Morin, H. and Krause, C. (2011) A three-step procedure in SAS to analyze the time series from automatic dendrometers. <em>Dendrochronologia</em> 29: 151-161.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dmCD)
dm.phase &lt;- phase_def(dmCD)

</code></pre>

<hr>
<h2 id='phase_plot'>Plot stem-cyclic phases</h2><span id='topic+phase_plot'></span>

<h3>Description</h3>

<p>The function creates a plot showing the three distinct phases of contraction, expansion and stem-radius increment (Deslauriers et al. 2011) for dendrometer series from a <code>data.frame</code> as produced by <code><a href="#topic+phase_def">phase_def</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>phase_plot(dm.gpf, dm.phase, sensor = NULL, period = NULL, colPhases = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="phase_plot_+3A_dm.gpf">dm.gpf</code></td>
<td>
<p>a <code>data.frame</code> with gap-filled dendrometer series as produced by <code><a href="#topic+fill_gaps">fill_gaps</a></code>.</p>
</td></tr>
<tr><td><code id="phase_plot_+3A_dm.phase">dm.phase</code></td>
<td>
<p>a <code>data.frame</code> with numbers indicating the different stem-cyclic phases. Output of <code><a href="#topic+phase_def">phase_def</a></code>.</p>
</td></tr>
<tr><td><code id="phase_plot_+3A_sensor">sensor</code></td>
<td>
<p>a <code>numeric</code> specifying the sensor to be plotted (by column number). Alternatively, <code>sensor</code> can be a <code>character</code> with column names. Concatenations and sequences are allowed for plotting phase definitions of multiple sensors at once. Defaults to all sensors in <code>dm.gpf</code> and <code>dm.phase</code>.</p>
</td></tr>
<tr><td><code id="phase_plot_+3A_period">period</code></td>
<td>
<p>a <code>numeric</code> indicating the period to be plotted, specified using day of year values (begin and end). Defaults to the complete data period. Alternatively, <code>period</code> can be a <code>character</code> of two time stamps, indicating the begin and end date of the period to be plotted.</p>
</td></tr>
<tr><td><code id="phase_plot_+3A_colphases">colPhases</code></td>
<td>
<p>a <code>vector</code> of length 3, specifying custom colors to be used for the three stem-cyclic phases. Defaults to the first three colors from the current <code><a href="grDevices.html#topic+palette">palette</a></code>.</p>
</td></tr>
<tr><td><code id="phase_plot_+3A_...">...</code></td>
<td>
<p>additional graphical parameters (see <code><a href="graphics.html#topic+par">par</a></code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function plots phases of contraction, expansion and stem-radius increment along (one or more) dendrometer series. If more series are plotted (default), colors for the different lines can be defined using the <code>col</code> argument for graphical devices (see <code><a href="graphics.html#topic+par">par</a></code>). Note: if there are not enough custom colors, the function will repeat the last one used. If no colors are defined, the current <code><a href="grDevices.html#topic+palette">palette</a></code> will be used.
</p>
<p>The time axis will be automatically labeled depending upon the length of the dendrometer series. If <code>period</code> is specified using a <code>numeric</code>, DOY values are displayed on the x-axis. In case a <code>character</code> of two time stamps is provided, axis labeling will be as follows: if series are longer than 120 days, years and months will be shown. If the length is between 30 and 120 days, months and days, and below 30 days, months, days and hours are displayed.
</p>


<h3>Value</h3>

<p>Plot showing stem-cyclic phases on dendrometer series.
</p>


<h3>Author(s)</h3>

<p>Marko Smiljanic
</p>


<h3>References</h3>

<p>Deslauriers, A., Rossi, S., Turcotte, A., Morin, H. and Krause, C. (2011) A three-step procedure in SAS to analyze the time series from automatic dendrometers. <em>Dendrochronologia</em> 29: 151-161.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dmCD)
dm.phase &lt;- phase_def(dmCD)
phase_plot(dmCD, dm.phase)

# zoom in on the dendrometer series
phase_plot(dmCD, dm.phase, period = c(133, 142))

# customization options
phase_plot(dmCD, dm.phase, period = c("2008-05-12", "2008-05-22"),
           colPhases = c("green", "cyan", "orange"),
           pch = 4, main = "Dendrometer", ylab = "Values")

# specific sensors may be selected as follows:


data(dmED)
dm.gpf &lt;- fill_gaps(dmED)
dm.phase &lt;- phase_def(dm.gpf)
phase_plot(dm.gpf, dm.phase, sensor = 1)
phase_plot(dm.gpf, dm.phase, sensor = c(2,1))
phase_plot(dm.gpf, dm.phase, sensor = "Beech03")
phase_plot(dm.gpf, dm.phase, sensor = c("Beech03", "Beech04"))


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
