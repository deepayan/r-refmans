<!DOCTYPE html><html><head><title>Help for package borrowr</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {borrowr}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#adapt'><p>Data set used in the package vignette</p></a></li>
<li><a href='#credint'><p>Posterior Credible Interval for Population Average Treatment Effect (PATE)</p></a></li>
<li><a href='#pate'><p>Population Average Treatment Effect (PATE)</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Estimate Causal Effects with Borrowing Between Data Sources</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.0</td>
</tr>
<tr>
<td>Author:</td>
<td>Jeffrey A. Boatman [aut, cre],
  David M. Vock [aut],
  Joseph S. Koopmeiners [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jeffrey A. Boatman &lt;jeffrey.boatman@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimate population average treatment effects from a primary data source 
  with borrowing from supplemental sources. Causal estimation is done with either a 
  Bayesian linear model or with Bayesian additive regression trees (BART) to adjust 
  for confounding. Borrowing is done with multisource exchangeability models (MEMs). For 
  information on BART, see Chipman, George, &amp; McCulloch (2010) &lt;<a href="https://doi.org/10.1214%2F09-AOAS285">doi:10.1214/09-AOAS285</a>&gt;. 
  For information on MEMs, see Kaizer, Koopmeiners, &amp; 
  Hobbs (2018) &lt;<a href="https://doi.org/10.1093%2Fbiostatistics%2Fkxx031">doi:10.1093/biostatistics/kxx031</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Imports:</td>
<td>mvtnorm(&ge; 1.0.8), BART(&ge; 2.1), Rcpp (&ge; 1.0.0)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, ggplot2</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-12-08 00:09:56 UTC; Jeff</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-12-08 12:50:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='adapt'>Data set used in the package vignette</h2><span id='topic+adapt'></span>

<h3>Description</h3>

<p>A simulated data set used in the package vignette. Data generating
mechanism is adapted from Hill (2011). Includes 3 data sources to illustrate
borrowing information in estimate the population average treatment effect.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>adapt
</code></pre>


<h3>Format</h3>

<p>A data frame with 180 rows and 5 variables
</p>

<dl>
<dt>y</dt><dd><p>the outcome</p>
</dd>
<dt>x</dt><dd><p>a variable associated with y and treatment</p>
</dd>
<dt>source</dt><dd><p>character variable with 3 levels: &quot;Primary&quot;, &quot;Supp1&quot;, &quot;Supp2&quot;</p>
</dd>
<dt>treatment</dt><dd><p>treatment variable. 1 = treated, 0 = untreated</p>
</dd>
<dt>compliant</dt><dd><p>compliance indicator. 1 = compliant to treatment,
0 = noncompliant to treatment</p>
</dd>
</dl>



<h3>References</h3>

<p>Hill, Jennifer L. (2011) Bayesian Nonparametric Modeling for Causal Inference.
Journal of Computational and Graphical Statistics, 20:1, 217-240.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(adapt)
head(adapt)
</code></pre>

<hr>
<h2 id='credint'>Posterior Credible Interval for Population Average Treatment Effect (PATE)</h2><span id='topic+credint'></span>

<h3>Description</h3>

<p>Computes an equal-tailed credible interval for an object of class 'pate'
</p>


<h3>Usage</h3>

<pre><code class='language-R'>credint(object, level = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="credint_+3A_object">object</code></td>
<td>
<p>An object of class pate fit by the <code>pate</code> function.</p>
</td></tr>
<tr><td><code id="credint_+3A_level">level</code></td>
<td>
<p>the credible level required</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>data(adapt)

est &lt;- pate(y ~ treatment*x + treatment*I(x ^ 2), data = adapt,
 estimator = "bayesian_lm", src_var = "source", primary_source = "Primary",
 trt_var = "treatment")

credint(est)

</code></pre>

<hr>
<h2 id='pate'>Population Average Treatment Effect (PATE)</h2><span id='topic+pate'></span>

<h3>Description</h3>

<p>Estimates the population average treatment effect from a primary data source
with potential borrowing from supplemental sources. Adjust for confounding by fitting
a conditional mean model with the treatment variable and confounding variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pate(
  formula,
  estimator = c("BART", "bayesian_lm"),
  data,
  src_var,
  primary_source,
  exch_prob,
  trt_var,
  compliance_var,
  ndpost = 1000,
  model_prior = c("none", "power", "powerlog"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pate_+3A_formula">formula</code></td>
<td>
<p>An object of class formula. The left hand side must be the outcome,
and the right hand side must include the treatment variable. To adjust for confounding,
the right hand side must also include the confounders. For the Bayesian linear model,
the use is responsible for specifying the function form.</p>
</td></tr>
<tr><td><code id="pate_+3A_estimator">estimator</code></td>
<td>
<p>&quot;bayesian_lm&quot; or &quot;BART&quot;. If &quot;bayesian_lm&quot;, a Bayesian linear model with
a normal inverse-gamma prior. If &quot;BART&quot;, Bayesian Additive Regression Trees</p>
</td></tr>
<tr><td><code id="pate_+3A_data">data</code></td>
<td>
<p>the data frame with the outcome variable and all variables in the formula</p>
</td></tr>
<tr><td><code id="pate_+3A_src_var">src_var</code></td>
<td>
<p>a character variable which variable indicates the source variable.
Must match a column name in the data.</p>
</td></tr>
<tr><td><code id="pate_+3A_primary_source">primary_source</code></td>
<td>
<p>character variable indicating the primary source. Must match
one of the values of <code>src_var</code>.</p>
</td></tr>
<tr><td><code id="pate_+3A_exch_prob">exch_prob</code></td>
<td>
<p>numeric vector giving prior probability that each source is exchangeable
with the primary source. Number of elements must be equal to the number of sources
minus 1. Each element must be between 0 and 1.
Order of probabilities should match the order returned by calling <code>levels(factor(...))</code>
on the source vector. See the vignette for an example of usage.</p>
</td></tr>
<tr><td><code id="pate_+3A_trt_var">trt_var</code></td>
<td>
<p>which variable indicates the treatment.
Must match a column name in the data. Must be coded as numeric values 0 and 1, 0 for
untreated, 1 for treated.</p>
</td></tr>
<tr><td><code id="pate_+3A_compliance_var">compliance_var</code></td>
<td>
<p>Optional argument if adjustment for confounding
due to noncompliance is needed. <code>compliance_var</code> indicates the compliance
indicator.
Must match a column name in the data. Must be coded as numeric values 0 and 1, 0 for
noncompliant, 1 for compliant. If this argument is specified, the formula must also
include the compliance variable.</p>
</td></tr>
<tr><td><code id="pate_+3A_ndpost">ndpost</code></td>
<td>
<p>number of draws from the posterior</p>
</td></tr>
<tr><td><code id="pate_+3A_model_prior">model_prior</code></td>
<td>
<p>specifices the prior probability of exchangebility of data sources. Details for priors
are given in Boatman et al. (2020).</p>
</td></tr>
<tr><td><code id="pate_+3A_...">...</code></td>
<td>
<p>additional arguments passed to BART</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To adjust for confounding, the PATE is estimated using a
model for the conditional mean given treatment and confounders. Currently,
two models are available, a Bayesian linear model with an inverse-gamma prior,
and Bayesian Additive Regression Trees (BART; Chipman &amp; McCulloch, 2010).
The user must specify a
formula for the conditional mean. This requires more thought for the
Bayesian linear model as the analyst must carefully consider the functional
form of the regression relationship. For BART, the right hand side of the
formula need only include the confounders and the treatment variable without
specification of the functional form. If there is no confounding, the right hand
side of the formula needs to include the treatment variable only.
</p>
<p>If <code>formula = "bayesian_lm"</code>, then the function fits the Bayesian linear model
</p>
<p style="text-align: center;"><code class="reqn">Y = X\beta + \epsilon, \epsilon ~ N(0, \sigma ^ 2).</code>
</p>

<p>The prior on the regression coefficients is normal with mean vector 0 and variance
matrix with diagonal elements equal to 100 and off-diagonal elements equal to 0.
The prior on <code class="reqn">\sigma ^ 2</code> is a Inverse Gamma(0.1, 0.1)
</p>
<p>If <code>formula = "BART"</code>, the function fits the Bayesian Additive Regression Trees
model, but with a modified prior on the terminal nodes. The prior on each terminal node
is
</p>
<p style="text-align: center;"><code class="reqn">N(0, \gamma\sigma ^ 2).</code>
</p>
<p> The package uses the default value
</p>
<p style="text-align: center;"><code class="reqn">\gamma = 1 / (16 * m * \hat{sigma ^ 2})</code>
</p>
<p> where <code class="reqn">m</code> is the number of trees and <code class="reqn">\hat{sigma ^ 2}</code> is the variance of <code class="reqn">Y</code>.
</p>
<p>Borrowing between data sources is done with
Multisource Exchangeability Models
(MEMs; Kaizer et al., 2018) . MEMs borrow by assuming that each supplementary data source
is either &quot;exchangeable&quot;, or not, with the primary data source. Two data sources
are considered exchangeable if their model parameters are equal. Each data source
can be exchangeable with the primary data, or not, so if there are <code class="reqn">r</code> data
sources, there are <code class="reqn">2 ^ r</code> possible configurations regarding the exchangeability
assumptions. Each of these configurations corresponds to a single MEM.
The parameters for each MEM are estimated, and we compute a posterior probability
for each. The posterior density of the PATE is a weighted posterior across all
possible MEMs.
</p>


<h3>Value</h3>

<p>A list with components:
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>The function call</p>
</td></tr>
<tr><td><code>estimator</code></td>
<td>
<p>The estimator used to adjust for confounding, &quot;bayesian_lm&quot; for
Bayesian linear model, or &quot;BART&quot; for Bayesian additive regression trees</p>
</td></tr>
<tr><td><code>EY0</code></td>
<td>
<p>Posterior draws of the expected potential outcome if all observations were
treated. One column for each MEM</p>
</td></tr>
<tr><td><code>EY1</code></td>
<td>
<p>Posterior draws of the expected potential outcome if all observations were
untreated. One column for each MEM</p>
</td></tr>
<tr><td><code>log_marg_like</code></td>
<td>
<p>Log marginal likelihood for each MEM</p>
</td></tr>
<tr><td><code>mem_pate_post</code></td>
<td>
<p>Array containing, for each MEM, posterior draws for the population
average treatment effect</p>
</td></tr>
<tr><td><code>MEMs</code></td>
<td>
<p>Matrix showing showing which data sources are exchangeable under each MEM.
1 = exchangeable.</p>
</td></tr>
<tr><td><code>pate_post</code></td>
<td>
<p>Posterior draws for the population average treatment effect. Weighted
average of <code>mem_pate_post</code>, where <code>post_probs</code> are the weights</p>
</td></tr>
<tr><td><code>post_probs</code></td>
<td>
<p>Posterior probability that each MEM (shown in the list element <code>MEMs</code>)
is the true model.</p>
</td></tr>
<tr><td><code>exch_prob</code></td>
<td>
<p>Prior probability that each source is exchangeable with the primary source.</p>
</td></tr>
<tr><td><code>beta_post_mean</code></td>
<td>
<p>If <code>estimator = "bayesian_lm"</code>, a matrix with the posterior means
of the coefficients for the primary source from each MEM. If <code>estimator = "BART"</code>, <code>NA</code></p>
</td></tr></table>
<p>.
</p>
<table>
<tr><td><code>beta_post_var</code></td>
<td>
<p>If <code>estimator</code> = <code>"bayesian_lm"</code>, a matrix with the posterior variance
of the coefficients for the primary source from each MEM. If <code>estimator = "BART"</code>, <code>NA</code></p>
</td></tr></table>
<p>.
</p>
<table>
<tr><td><code>beta_post_var</code></td>
<td>
<p>If <code>estimator = "bayesian_lm"</code>, a matrix with the posterior variance
of the coefficients for the primary source from each MEM. If <code>estimator = "BART"</code>, <code>NA</code></p>
</td></tr></table>
<p>.
</p>
<table>
<tr><td><code>non_compliance</code></td>
<td>
<p>Logical, indicating whether the model adjusted for confounding
due to noncompliance</p>
</td></tr>
</table>


<h3>References</h3>

<p>Chipman, H. &amp; McCulloch, R. (2010) BART: Bayesian additive regression trees. Annals
of Applied Statistics, 4(1): 266-298.
</p>
<p>Kaizer, Alexander M., Koopmeiners, Joseph S., Hobbs, Brian P. (2018) Bayesian
hierarchical modeling based on multisource exchangeability. Biostatistics,
19(2): 169-184.
</p>
<p>Boatman, Jeffrey A., Vock, David. M, and Koopmeiners, Joseph S. (2020) Borrowing from
Supplemental Sources to Estimate Causal Effects from a Primary Data Source. arXiv:2003.09680
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(adapt)

est &lt;- pate(y ~ treatment*x + treatment*I(x ^ 2), data = adapt,
 estimator = "bayesian_lm", src_var = "source", primary_source = "Primary",
 trt_var = "treatment")

summary(est)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
