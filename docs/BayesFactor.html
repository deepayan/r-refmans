<!DOCTYPE html><html lang="en"><head><title>Help for package BayesFactor</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {BayesFactor}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#BayesFactor-package'><p>Functions to compute Bayes factor hypothesis tests for common research designs</p>
and hypotheses.</a></li>
<li><a href='#+25same+25'><p>Compare two objects to see if they are the 'same', for some loose definition</p>
of same</a></li>
<li><a href='#+25termin+25'><p>Find a model term in a vector of model terms</p></a></li>
<li><a href='#anovaBF'><p>Function to compute Bayes factors for ANOVA designs</p></a></li>
<li><a href='#as.BFBayesFactor'><p>Function to coerce objects to the BFBayesFactor class</p></a></li>
<li><a href='#as.BFprobability'><p>Function to coerce objects to the BFprobability class</p></a></li>
<li><a href='#BFBayesFactor-class'><p>General S4 class for representing multiple Bayes factor model comparisons, all against the same model</p></a></li>
<li><a href='#BFBayesFactorList-class'><p>General S4 class for representing a collection of Bayes factor model</p>
comprisons, each against a different denominator</a></li>
<li><a href='#BFInfo'><p>Prints the version information for the BayesFactor package</p></a></li>
<li><a href='#BFManual'><p>Opens the HTML manual for the BayesFactor package</p></a></li>
<li><a href='#BFmodel-class'><p>General S4 classes for representing models for comparison</p></a></li>
<li><a href='#BFodds-class'><p>General S4 class for representing multiple odds model comparisons, all against the same model</p></a></li>
<li><a href='#BFprobability-class'><p>General S4 class for representing multiple model probability comparisons</p></a></li>
<li><a href='#compare'><p>Compare two models, with respect to some data</p></a></li>
<li><a href='#contingencyTableBF'><p>Function for Bayesian analysis of one- and two-sample designs</p></a></li>
<li><a href='#correlationBF'><p>Function for Bayesian analysis of correlations</p></a></li>
<li><a href='#enumerateGeneralModels'><p>Function for generation of nested linear models</p></a></li>
<li><a href='#extractBF'><p>Extract the Bayes factor from an object</p></a></li>
<li><a href='#extractOdds'><p>Extract the odds from an object</p></a></li>
<li><a href='#extractProbabilities'><p>Extract the probabilities from an object</p></a></li>
<li><a href='#filterBF'><p>Filter the elements of an object according to some pre-specified criteria</p></a></li>
<li><a href='#generalTestBF'><p>Function to compute Bayes factors for general designs</p></a></li>
<li><a href='#linearReg.R2stat'><p>Use R^2 statistic to compute Bayes factor for regression designs</p></a></li>
<li><a href='#lmBF'><p>Function to compute Bayes factors for specific linear models</p></a></li>
<li><a href='#logMeanExpLogs'><p>Functions to compute the logarithm of the mean (and cumulative means) of</p>
vectors of logarithms</a></li>
<li><a href='#meta.ttestBF'><p>Function for Bayesian analysis of one- and two-sample designs</p></a></li>
<li><a href='#model.matrix+2CBFBayesFactor-method'><p>Design matrices for Bayes factor linear models analyses.</p></a></li>
<li><a href='#newPriorOdds'><p>Create prior odds from a Bayes factor object</p></a></li>
<li><a href='#nWayAOV'><p>Use ANOVA design matrix to compute Bayes factors or sample posterior</p></a></li>
<li><a href='#oneWayAOV.Fstat'><p>Use F statistic to compute Bayes factor for balanced one-way designs</p></a></li>
<li><a href='#options-BayesFactor'><p>options() for package BayesFactor</p></a></li>
<li><a href='#plot.BFBayesFactor'><p>Plot a Bayes factor object</p></a></li>
<li><a href='#plot.BFBayesFactorTop'><p>Plot a Bayes factor top-down object</p></a></li>
<li><a href='#posterior'><p>Sample from the posterior distribution of one of several models.</p></a></li>
<li><a href='#priorLogodds+26lt+3B-'><p>Set prior log odds in an object</p></a></li>
<li><a href='#priorOdds+26lt+3B-'><p>Set prior odds in an object</p></a></li>
<li><a href='#proportionBF'><p>Function for Bayesian analysis of proportions</p></a></li>
<li><a href='#puzzles'><p>Puzzle completion times from Hays (1994)</p></a></li>
<li><a href='#raceDolls'><p>Hraba and Grant (1970) children's doll preference data</p></a></li>
<li><a href='#recompute'><p>Recompute a Bayes factor computation or MCMC object.</p></a></li>
<li><a href='#regressionBF'><p>Function to compute Bayes factors for regression designs</p></a></li>
<li><a href='#ttest.tstat'><p>Use t statistic to compute Bayes factor for one- and two- sample designs</p></a></li>
<li><a href='#ttestBF'><p>Function for Bayesian analysis of one- and two-sample designs</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Computation of Bayes Factors for Common Designs</td>
</tr>
<tr>
<td>Version:</td>
<td>0.9.12-4.7</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-01-23</td>
</tr>
<tr>
<td>Description:</td>
<td>A suite of functions for computing
    various Bayes factors for simple designs, including contingency tables,
    one- and two-sample designs, one-way designs, general ANOVA designs, and
    linear regression.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.2.0), coda, Matrix (&ge; 1.1-1)</td>
</tr>
<tr>
<td>Imports:</td>
<td>pbapply, mvtnorm, stringr, utils, graphics, MatrixModels, Rcpp
(&ge; 0.11.2), methods, hypergeo</td>
</tr>
<tr>
<td>Suggests:</td>
<td>doMC, foreach, testthat, knitr, markdown, rmarkdown, arm,
lme4, xtable, languageR</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://richarddmorey.github.io/BayesFactor/">https://richarddmorey.github.io/BayesFactor/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/richarddmorey/BayesFactor/issues">https://github.com/richarddmorey/BayesFactor/issues</a></td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp (&ge; 0.11.2), RcppEigen (&ge; 0.3.2.2.0)</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-01-23 17:22:16 UTC; saprm3</td>
</tr>
<tr>
<td>Author:</td>
<td>Richard D. Morey [aut, cre, cph],
  Jeffrey N. Rouder [aut],
  Tahira Jamil [ctb, cph],
  Simon Urbanek [ctb, cph],
  Karl Forner [ctb, cph],
  Alexander Ly [ctb, cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Richard D. Morey &lt;richarddmorey@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-01-24 15:02:50 UTC</td>
</tr>
</table>
<hr>
<h2 id='BayesFactor-package'>Functions to compute Bayes factor hypothesis tests for common research designs
and hypotheses.</h2><span id='topic+BayesFactor-package'></span><span id='topic+BayesFactor'></span>

<h3>Description</h3>

<p>This package contains function to compute Bayes factors for a number of
research designs and hypotheses, including t tests, ANOVA, and linear
regression, correlations, proportions, and contingency tables.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;"> Package: </td><td style="text-align: left;"> BayesFactor</td>
</tr>
<tr>
 <td style="text-align: left;"> Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;"> Version: </td><td style="text-align: left;">
0.9.12-4.7</td>
</tr>
<tr>
 <td style="text-align: left;"> Date: </td><td style="text-align: left;"> 2024-01-23</td>
</tr>
<tr>
 <td style="text-align: left;"> License: </td><td style="text-align: left;"> GPL 2.0</td>
</tr>
<tr>
 <td style="text-align: left;"> LazyLoad: </td><td style="text-align: left;">
yes</td>
</tr>
<tr>
 <td style="text-align: left;"> </td>
</tr>

</table>
<p> The following methods are currently implemented, with more to follow:
</p>
<p>general linear models (including linear mixed effects models): <code><a href="#topic+generalTestBF">generalTestBF</a></code>, <code><a href="#topic+lmBF">lmBF</a></code>
</p>
<p>linear regression: <code><a href="#topic+regressionBF">regressionBF</a></code>, <code><a href="#topic+lmBF">lmBF</a></code>,
<code><a href="#topic+linearReg.R2stat">linearReg.R2stat</a></code>;
</p>
<p>linear correlation: <code><a href="#topic+correlationBF">correlationBF</a></code>;
</p>
<p>t tests: <code><a href="#topic+ttestBF">ttestBF</a></code>, <code><a href="#topic+ttest.tstat">ttest.tstat</a></code>;
</p>
<p>meta-analytic t tests: <code><a href="#topic+meta.ttestBF">meta.ttestBF</a></code>
</p>
<p>ANOVA: <code><a href="#topic+anovaBF">anovaBF</a></code>, <code><a href="#topic+lmBF">lmBF</a></code>, <code><a href="#topic+oneWayAOV.Fstat">oneWayAOV.Fstat</a></code>;
</p>
<p>contingency tables: <code><a href="#topic+contingencyTableBF">contingencyTableBF</a></code>;
</p>
<p>single proportions: <code><a href="#topic+proportionBF">proportionBF</a></code>;
</p>
<p>linear correlations: <code><a href="#topic+correlationBF">correlationBF</a></code>;
</p>
<p>Other useful functions: <code><a href="#topic+posterior">posterior</a></code>, for sampling from posterior
distributions; <code><a href="#topic+recompute">recompute</a></code>, for re-estimating a Bayes factor or
posterior distribution; <code><a href="#topic+compare">compare</a></code>, to compare two model
posteriors; and <code><a href="#topic+plot.BFBayesFactor">plot.BFBayesFactor</a></code>, for plotting Bayes factor
objects.
</p>


<h3>Author(s)</h3>

<p>Richard D. Morey and Jeffrey N. Rouder (with contributions from Tahira Jamil)
</p>
<p>Maintainer: Richard D. Morey &lt;richarddmorey@gmail.com&gt;
</p>


<h3>References</h3>

<p>Liang, F. and Paulo, R. and Molina, G. and Clyde, M. A. and
Berger, J. O. (2008). Mixtures of g-priors for Bayesian Variable Selection.
Journal of the American Statistical Association, 103, pp. 410-423
</p>
<p>Rouder, J. N., Speckman, P. L., Sun, D., Morey, R. D., and Iverson, G.
(2009). Bayesian t-tests for accepting and rejecting the null hypothesis.
Psychonomic Bulletin &amp; Review, 16, 225-237
</p>
<p>Rouder, J. N., Morey, R. D., Speckman, P. L., Province, J. M., (2012)
Default Bayes Factors for ANOVA Designs. Journal of Mathematical Psychology.
56.  p. 356-374.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## See specific functions for examples.

</code></pre>

<hr>
<h2 id='+25same+25'>Compare two objects to see if they are the 'same', for some loose definition
of same</h2><span id='topic++25same+25'></span>

<h3>Description</h3>

<p>Compare two objects to see if they are the 'same', for some loose definition
of same
</p>


<h3>Usage</h3>

<pre><code class='language-R'>x %same% y
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="+2B25same+2B25_+3A_x">x</code></td>
<td>
<p>first object</p>
</td></tr>
<tr><td><code id="+2B25same+2B25_+3A_y">y</code></td>
<td>
<p>second object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns <code>TRUE</code> or <code>FALSE</code>
</p>

<hr>
<h2 id='+25termin+25'>Find a model term in a vector of model terms</h2><span id='topic++25termin+25'></span>

<h3>Description</h3>

<p>Find a model term in a vector of model terms
</p>


<h3>Usage</h3>

<pre><code class='language-R'>x %termin% table
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="+2B25termin+2B25_+3A_x">x</code></td>
<td>
<p>the terms to be matched</p>
</td></tr>
<tr><td><code id="+2B25termin+2B25_+3A_table">table</code></td>
<td>
<p>the terms to be matched against</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A logical vector of the same length as x, indicating if a
match was located for each element of x.
</p>

<hr>
<h2 id='anovaBF'>Function to compute Bayes factors for ANOVA designs</h2><span id='topic+anovaBF'></span>

<h3>Description</h3>

<p>This function computes Bayes factors for all main-effects and interaction
contrasts in an ANOVA design.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>anovaBF(
  formula,
  data,
  whichRandom = NULL,
  whichModels = "withmain",
  iterations = 10000,
  progress = getOption("BFprogress", interactive()),
  rscaleFixed = "medium",
  rscaleRandom = "nuisance",
  rscaleEffects = NULL,
  multicore = FALSE,
  method = "auto",
  noSample = FALSE,
  callback = function(...) as.integer(0)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="anovaBF_+3A_formula">formula</code></td>
<td>
<p>a formula containing all factors to include in the analysis
(see Examples)</p>
</td></tr>
<tr><td><code id="anovaBF_+3A_data">data</code></td>
<td>
<p>a data frame containing data for all factors in the formula</p>
</td></tr>
<tr><td><code id="anovaBF_+3A_whichrandom">whichRandom</code></td>
<td>
<p>a character vector specifying which factors are random</p>
</td></tr>
<tr><td><code id="anovaBF_+3A_whichmodels">whichModels</code></td>
<td>
<p>which set of models to compare; see Details</p>
</td></tr>
<tr><td><code id="anovaBF_+3A_iterations">iterations</code></td>
<td>
<p>How many Monte Carlo simulations to generate, if relevant</p>
</td></tr>
<tr><td><code id="anovaBF_+3A_progress">progress</code></td>
<td>
<p>if <code>TRUE</code>, show progress with a text progress bar</p>
</td></tr>
<tr><td><code id="anovaBF_+3A_rscalefixed">rscaleFixed</code></td>
<td>
<p>prior scale for standardized, reduced fixed effects. A
number of preset values can be given as strings; see Details.</p>
</td></tr>
<tr><td><code id="anovaBF_+3A_rscalerandom">rscaleRandom</code></td>
<td>
<p>prior scale for standardized random effects</p>
</td></tr>
<tr><td><code id="anovaBF_+3A_rscaleeffects">rscaleEffects</code></td>
<td>
<p>A named vector of prior settings for individual factors,
overriding rscaleFixed and rscaleRandom. Values are scales, names are factor names.</p>
</td></tr>
<tr><td><code id="anovaBF_+3A_multicore">multicore</code></td>
<td>
<p>if <code>TRUE</code> use multiple cores through the <code>doMC</code>
package. Unavailable on Windows.</p>
</td></tr>
<tr><td><code id="anovaBF_+3A_method">method</code></td>
<td>
<p>approximation method, if needed. See <code><a href="#topic+nWayAOV">nWayAOV</a></code> for
details.</p>
</td></tr>
<tr><td><code id="anovaBF_+3A_nosample">noSample</code></td>
<td>
<p>if <code>TRUE</code>, do not sample, instead returning NA.</p>
</td></tr>
<tr><td><code id="anovaBF_+3A_callback">callback</code></td>
<td>
<p>callback function for third-party interfaces</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Models, priors, and methods of computation are provided in Rouder et al.
(2012).
</p>
<p>The ANOVA model for a vector of observations <code class="reqn">y</code> is </p>
<p style="text-align: center;"><code class="reqn"> y = \mu + X_1
\theta_1 + \ldots + X_p\theta_p +\epsilon,</code>
</p>
<p> where
<code class="reqn">\theta_1,\ldots,\theta_p</code> are vectors of main-effect and interaction
effects, <code class="reqn">X_1,\ldots,X_p</code> are corresponding design matrices, and
<code class="reqn">\epsilon</code> is a vector of zero-centered noise terms with variance
<code class="reqn">\sigma^2</code>.  Zellner and Siow (1980) inspired g-priors are placed on
effects, but with a separate g-prior parameter for each covariate:
</p>
<p style="text-align: center;"><code class="reqn">\theta_1~N(0,g_1\sigma^2), \ldots,  \theta_p~N(0,g_p \sigma^2).</code>
</p>
<p>  A
Jeffries prior is placed on <code class="reqn">\mu</code> and <code class="reqn">\sigma^2</code>.  Independent
scaled inverse-chi-square priors with one degree of freedom are placed on
<code class="reqn">g_1,\ldots,g_p</code>.  The square-root of the scale for g's corresponding to
fixed and random effects is given by <code>rscaleFixed</code> and
<code>rscaleRandom</code>, respectively.
</p>
<p>When a factor is treated as random, there are as many main effect terms in
the vector <code class="reqn">\theta</code> as levels.  When a factor is treated as fixed, the
sums-to-zero linear constraint is enforced by centering the corresponding
design matrix, and there is one fewer main effect terms as levels.  The
Cornfield-Tukey model of interactions is assumed.  Details are provided in
Rouder et al. (2012)
</p>
<p>Bayes factors are computed by integrating the likelihood with respect to the
priors on parameters.  The integration of all parameters except
<code class="reqn">g_1,\ldots,g_p</code> may be expressed in closed-form; the integration of
<code class="reqn">g_1,\ldots,g_p</code> is performed through Monte Carlo sampling, and
<code>iterations</code> is the number of iterations used to estimate the Bayes
factor.
</p>
<p><code>anovaBF</code> computes Bayes factors for either all submodels or select
submodels missing a single main effect or covariate, depending on the
argument <code>whichModels</code>. If no random factors are specified, the null
model assumed by <code>anovaBF</code> is the grand-mean only model. If random
factors are specified, the null model is the model with an additive model on
all random factors, plus a grand mean. Thus, <code>anovaBF</code> does not
currently test random factors. Testing random factors is possible with
<code><a href="#topic+lmBF">lmBF</a></code>.
</p>
<p>The argument <code>whichModels</code> controls which models are tested. Possible
values are 'all', 'withmain', 'top', and 'bottom'. Setting
<code>whichModels</code> to 'all' will test all models that can be created by
including or not including a main effect or interaction. 'top' will test all
models that can be created by removing or leaving in a main effect or
interaction term from the full model. 'bottom' creates models by adding
single factors or interactions to the null model. 'withmain' will test all
models, with the constraint that if an interaction is included, the
corresponding main effects are also included.
</p>
<p>For the <code>rscaleFixed</code> and <code>rscaleRandom</code> arguments, several named
values are recognized: &quot;medium&quot;, &quot;wide&quot;, and &quot;ultrawide&quot;, corresponding to
<code class="reqn">r</code> scale values of 1/2, <code class="reqn">\sqrt{2}/2</code>, and 1,
respectively. In addition, <code>rscaleRandom</code> can be set to the &quot;nuisance&quot;,
which sets <code class="reqn">r=1</code> (and is thus equivalent to &quot;ultrawide&quot;). The &quot;nuisance&quot;
setting is for medium-to-large-sized effects assumed to be in the data but
typically not of interest, such as variance due to participants.
</p>


<h3>Value</h3>

<p>An object of class <code>BFBayesFactor</code>, containing the computed
model comparisons. Bayes factors can be extracted using extractBF(), as.vector()
or as.data.frame().
</p>


<h3>Note</h3>

<p>The function <code>anovaBF</code> will compute Bayes factors for all
possible combinations of fixed factors and interactions, against the null
hypothesis that <em>all</em> effects are 0. The total number of tests
computed will be <code class="reqn">2^{2^K - 1}</code> for <code class="reqn">K</code> fixed factors.
This number increases very quickly with the number of factors. For
instance, for a five-way ANOVA, the total number of tests exceeds two
billion. Even though each test takes a fraction of a second, the time
taken for all tests could exceed your lifetime. An option is included to
prevent this: <code>options('BFMaxModels')</code>, which defaults to 50,000, is
the maximum number of models that 'anovaBF' will analyze at once. This can
be increased by increasing the option value.
</p>
<p>It is possible to reduce the number of models tested by only testing the
most complex model and every restriction that can be formed by removing
one factor or interaction using the <code>whichModels</code> argument. Setting
this argument to 'top' reduces the number of tests to <code class="reqn">2^K-1</code>, which
is more manageable. The Bayes factor for each restriction against the most
complex model can be interpreted as a test of the removed
factor/interaction. Setting <code>whichModels</code> to 'withmain' will not
reduce the number of tests as much as 'top' but the results may be more
interpretable, since an interaction is only allowed when all interacting
effects (main or interaction) are also included in the model.
</p>


<h3>Author(s)</h3>

<p>Richard D. Morey (<a href="mailto:richarddmorey@gmail.com">richarddmorey@gmail.com</a>)
</p>


<h3>References</h3>

<p>Gelman, A. (2005) Analysis of Variance&mdash;why it is more
important than ever.  Annals of Statistics, 33, pp. 1-53.
</p>
<p>Rouder, J. N., Morey, R. D., Speckman, P. L., Province, J. M., (2012)
Default Bayes Factors for ANOVA Designs. Journal of Mathematical
Psychology.  56.  p. 356-374.
</p>
<p>Zellner, A. and Siow, A., (1980) Posterior Odds Ratios for Selected
Regression Hypotheses.  In Bayesian Statistics: Proceedings of the First
Interanational Meeting held in Valencia (Spain).  Bernardo, J. M.,
Lindley, D. V., and Smith A. F. M. (eds), pp. 585-603.  University of
Valencia.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lmBF">lmBF</a></code>, for testing specific models, and
<code><a href="#topic+regressionBF">regressionBF</a></code> for the function similar to <code>anovaBF</code> for
linear regression models.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Classical example, taken from t.test() example
## Student's sleep data
data(sleep)
plot(extra ~ group, data = sleep)

## traditional ANOVA gives a p value of 0.00283
summary(aov(extra ~ group + Error(ID/group), data = sleep))

## Gives a Bayes factor of about 11.6
## in favor of the alternative hypothesis
anovaBF(extra ~ group + ID, data = sleep, whichRandom = "ID",
    progress=FALSE)

## Demonstrate top-down testing
data(puzzles)
result = anovaBF(RT ~ shape*color + ID, data = puzzles, whichRandom = "ID",
    whichModels = 'top', progress=FALSE)
result

## In orthogonal designs, the top down Bayes factor can be
## interpreted as a test of the omitted effect
</code></pre>

<hr>
<h2 id='as.BFBayesFactor'>Function to coerce objects to the BFBayesFactor class</h2><span id='topic+as.BFBayesFactor'></span>

<h3>Description</h3>

<p>This function coerces objects to the BFBayesFactor class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.BFBayesFactor(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="as.BFBayesFactor_+3A_object">object</code></td>
<td>
<p>an object of appropriate class (for now, BFBayesFactorTop)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function to coerce objects to the BFBayesFactor class
</p>
<p>Currently, this function will only work with objects of class
<code>BFBayesFactorTop</code>, which are output from the functions <code>anovaBF</code>
and <code>regressionBF</code> when the <code>whichModels</code> argument is set to
<code>'top'</code>
</p>


<h3>Value</h3>

<p>An object of class <code>BFBayesFactor</code>
</p>


<h3>Author(s)</h3>

<p>Richard D. Morey (<a href="mailto:richarddmorey@gmail.com">richarddmorey@gmail.com</a>)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+regressionBF">regressionBF</a></code>, <code>anovaBF</code> whose output is
appropriate for use with this function when <code>whichModels='top'</code>
</p>

<hr>
<h2 id='as.BFprobability'>Function to coerce objects to the BFprobability class</h2><span id='topic+as.BFprobability'></span>

<h3>Description</h3>

<p>This function coerces objects to the BFprobability class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.BFprobability(object, normalize = NULL, lognormalize = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="as.BFprobability_+3A_object">object</code></td>
<td>
<p>an object of appropriate class (BFodds)</p>
</td></tr>
<tr><td><code id="as.BFprobability_+3A_normalize">normalize</code></td>
<td>
<p>the sum of the probabilities for all models in the object (1 by default)</p>
</td></tr>
<tr><td><code id="as.BFprobability_+3A_lognormalize">lognormalize</code></td>
<td>
<p>alternative to <code>normalize</code>; the
logarithm of the normalization constant (0 by default)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function to coerce objects to the BFprobability class
</p>
<p>Currently, this function will only work with objects of class
<code>BFOdds</code>.
</p>


<h3>Value</h3>

<p>An object of class <code>BFprobability</code>
</p>


<h3>Author(s)</h3>

<p>Richard D. Morey (<a href="mailto:richarddmorey@gmail.com">richarddmorey@gmail.com</a>)
</p>

<hr>
<h2 id='BFBayesFactor-class'>General S4 class for representing multiple Bayes factor model comparisons, all against the same model</h2><span id='topic+BFBayesFactor-class'></span><span id='topic+BFBayesFactorTop-class'></span><span id='topic++2F+2Cnumeric+2CBFBayesFactor-method'></span><span id='topic++2F+2CBFBayesFactor+2CBFBayesFactor-method'></span><span id='topic++5B+2CBFBayesFactor+2Cindex+2Cmissing+2Cmissing-method'></span><span id='topic+t+2CBFBayesFactor-method'></span><span id='topic+which.max+2CBFBayesFactor-method'></span><span id='topic+which.min+2CBFBayesFactor-method'></span><span id='topic+is.na+2CBFBayesFactor-method'></span><span id='topic++2A+2CBFBayesFactor+2CBFodds-method'></span><span id='topic++5B+2CBFBayesFactorTop+2Cindex+2Cmissing+2Cmissing-method'></span>

<h3>Description</h3>

<p>The <code>BFBayesFactor</code> class is a general S4 class for representing models model comparison via Bayes factor.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'numeric,BFBayesFactor'
e1 / e2

## S4 method for signature 'BFBayesFactor,BFBayesFactor'
e1 / e2

## S4 method for signature 'BFBayesFactor,index,missing,missing'
x[i, j, ..., drop = TRUE]

## S4 method for signature 'BFBayesFactor'
t(x)

## S4 method for signature 'BFBayesFactor'
which.max(x)

## S4 method for signature 'BFBayesFactor'
which.min(x)

## S4 method for signature 'BFBayesFactor'
is.na(x)

## S4 method for signature 'BFBayesFactor,BFodds'
e1 * e2

## S4 method for signature 'BFBayesFactorTop,index,missing,missing'
x[i, j, ..., drop = TRUE]
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BFBayesFactor-class_+3A_e1">e1</code></td>
<td>
<p>Numerator of the ratio</p>
</td></tr>
<tr><td><code id="BFBayesFactor-class_+3A_e2">e2</code></td>
<td>
<p>Denominator of the ratio</p>
</td></tr>
<tr><td><code id="BFBayesFactor-class_+3A_x">x</code></td>
<td>
<p>BFBayesFactor object</p>
</td></tr>
<tr><td><code id="BFBayesFactor-class_+3A_i">i</code></td>
<td>
<p>indices indicating elements to extract</p>
</td></tr>
<tr><td><code id="BFBayesFactor-class_+3A_j">j</code></td>
<td>
<p>unused for BFBayesFactor objects</p>
</td></tr>
<tr><td><code id="BFBayesFactor-class_+3A_...">...</code></td>
<td>
<p>further arguments passed to related methods</p>
</td></tr>
<tr><td><code id="BFBayesFactor-class_+3A_drop">drop</code></td>
<td>
<p>unused</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>BFBayesFactor</code> objects can be inverted by taking the reciprocal and can
be divided by one another, provided both objects have the same denominator. In addition,
the <code>t</code> (transpose) method can be used to invert Bayes factor objects.
</p>

<p>The <code>BFBayesFactor</code> class has the following slots defined:
</p>
<dl>
<dt>numerator</dt><dd><p>a list of models all inheriting <code>BFmodel</code>, each providing a single denominator</p>
</dd>
<dt>denominator</dt><dd><p>a single <code>BFmodel</code> object serving as the denominator for all model comparisons</p>
</dd>
<dt>bayesFactor</dt><dd><p>a data frame containing information about the comparison between each numerator and the denominator</p>
</dd>
<dt>data</dt><dd><p>a data frame containing the data used for the comparison</p>
</dd>
<dt>version</dt><dd><p>character string giving the version and revision number of the package that the model was created in</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>## Compute some Bayes factors to demonstrate division and indexing
data(puzzles)
bfs &lt;- anovaBF(RT ~ shape*color + ID, data = puzzles, whichRandom = "ID", progress=FALSE)

## First and second models can be separated; they remain BFBayesFactor objects
b1 = bfs[1]
b2 = bfs[2]
b1

## We can invert them, or divide them to obtain new model comparisons
1/b1
b1 / b2

## Use transpose to create a BFBayesFactorList
t(bfs)
</code></pre>

<hr>
<h2 id='BFBayesFactorList-class'>General S4 class for representing a collection of Bayes factor model
comprisons, each against a different denominator</h2><span id='topic+BFBayesFactorList-class'></span><span id='topic+t+2CBFBayesFactorList-method'></span><span id='topic++2F+2Cnumeric+2CBFBayesFactorList-method'></span><span id='topic++5B+2CBFBayesFactorList+2Cindex+2Cindex+2Cmissing-method'></span><span id='topic++5B+2CBFBayesFactorList+2Cindex+2Cmissing+2Cmissing-method'></span><span id='topic++5B+2CBFBayesFactorList+2Cmissing+2Cindex+2Cmissing-method'></span>

<h3>Description</h3>

<p>The <code>BFBayesFactorList</code> class is a general S4 class for representing
models model comparison via Bayes factor. See the examples for demonstrations
of BFBayesFactorList methods.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'BFBayesFactorList'
t(x)

## S4 method for signature 'numeric,BFBayesFactorList'
e1 / e2

## S4 method for signature 'BFBayesFactorList,index,index,missing'
x[i, j, ..., drop = TRUE]

## S4 method for signature 'BFBayesFactorList,index,missing,missing'
x[i, j, ..., drop = TRUE]

## S4 method for signature 'BFBayesFactorList,missing,index,missing'
x[i, j, ..., drop = TRUE]
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BFBayesFactorList-class_+3A_x">x</code></td>
<td>
<p>a BFBayesFactorList object</p>
</td></tr>
<tr><td><code id="BFBayesFactorList-class_+3A_e1">e1</code></td>
<td>
<p>Numerator of the ratio</p>
</td></tr>
<tr><td><code id="BFBayesFactorList-class_+3A_e2">e2</code></td>
<td>
<p>Denominator of the ratio</p>
</td></tr>
<tr><td><code id="BFBayesFactorList-class_+3A_i">i</code></td>
<td>
<p>indices specifying rows to extract</p>
</td></tr>
<tr><td><code id="BFBayesFactorList-class_+3A_j">j</code></td>
<td>
<p>indices specifying columns to extract</p>
</td></tr>
<tr><td><code id="BFBayesFactorList-class_+3A_...">...</code></td>
<td>
<p>further arguments passed to related methods</p>
</td></tr>
<tr><td><code id="BFBayesFactorList-class_+3A_drop">drop</code></td>
<td>
<p>unused</p>
</td></tr>
</table>


<h3>Details</h3>

 <p><code>BFBayesFactorList</code> objects inherit from lists, and contain a
single slot:
</p>
<dl>
<dt>version</dt><dd><p>character string giving the version and revision number of the
package that the model was created in</p>
</dd>
</dl>
<p>Each element of the list contains a single
<code>"<a href="#topic+BFBayesFactor-class">BFBayesFactor</a>"</code> object. Each element of
the list must have the same numerators, in the same order, as all the others.
The list object is displayed as a matrix of Bayes factors. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Compute some Bayes factors to demonstrate Bayes factor lists
data(puzzles)
bfs &lt;- anovaBF(RT ~ shape*color + ID, data = puzzles, whichRandom = "ID", progress=FALSE)

## Create a matrix of Bayes factors
bfList &lt;- bfs / bfs
bfList

## Use indexing to select parts of the 'matrix'
bfList[1,]
bfList[,1]

## We can use the t (transpose) function as well, to get back a BFBayesFactor
t(bfList[2,])

## Or transpose the whole matrix
t(bfList)
</code></pre>

<hr>
<h2 id='BFInfo'>Prints the version information for the BayesFactor package</h2><span id='topic+BFInfo'></span>

<h3>Description</h3>

<p>Prints the version, revision, and date information for the BayesFactor package
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BFInfo(print = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BFInfo_+3A_print">print</code></td>
<td>
<p>if <code>TRUE</code>, print version information to the console</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function prints the version and revision information for the BayesFactor
package.
</p>


<h3>Value</h3>

<p><code>BFInfo</code> returns a character string containing the version and
revision number of the package..
</p>


<h3>Author(s)</h3>

<p>Richard D. Morey (<a href="mailto:richarddmorey@gmail.com">richarddmorey@gmail.com</a>)
</p>

<hr>
<h2 id='BFManual'>Opens the HTML manual for the BayesFactor package</h2><span id='topic+BFManual'></span>

<h3>Description</h3>

<p>This function opens the HTML manual for the BayesFactor package in whatever
browser is configured.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BFManual()
</code></pre>


<h3>Details</h3>

<p>This function opens the HTML manual for the BayesFactor package in whatever
browser is configured.
</p>


<h3>Value</h3>

<p><code>BFManual</code> returns <code>NULL</code> invisibly.
</p>


<h3>Author(s)</h3>

<p>Richard D. Morey (<a href="mailto:richarddmorey@gmail.com">richarddmorey@gmail.com</a>)
</p>

<hr>
<h2 id='BFmodel-class'>General S4 classes for representing models for comparison</h2><span id='topic+BFmodel-class'></span><span id='topic+BFcorrelation-class'></span><span id='topic+BFproportion-class'></span><span id='topic+BFcontingencyTable-class'></span><span id='topic+BFlinearModel-class'></span><span id='topic+BFoneSample-class'></span><span id='topic+BFindepSample-class'></span>

<h3>Description</h3>

<p>The <code>BFmodel</code> is a general S4 class for representing models for comparison. The more classes
<code>BFlinearModel</code>, <code>BFindepSample</code>, and <code>BFoneSample</code> inherit directly from <code>BFmodel</code>.
</p>


<h3>Details</h3>


<p>These model classes all have the following slots defined:
</p>
<dl>
<dt>type</dt><dd><p>Model type</p>
</dd>
<dt>identifier</dt><dd><p>a list uniquely identifying the model from other models of the same type</p>
</dd>
<dt>prior</dt><dd><p>list giving appropriate prior settings for the model</p>
</dd>
<dt>dataTypes</dt><dd><p>a character vector whose names are possible columns in the data; elements specify the corresponding data type, currently one of c(&quot;fixed&quot;,&quot;random&quot;,&quot;continuous&quot;)</p>
</dd>
<dt>shortName</dt><dd><p>a short, readable identifying string</p>
</dd>
<dt>longName</dt><dd><p>a longer, readable identifying string</p>
</dd>
<dt>analysis</dt><dd><p>object storing information about a previous analysis of this model</p>
</dd>
<dt>version</dt><dd><p>character string giving the version and revision number of the package that the model was created in</p>
</dd>
</dl>


<hr>
<h2 id='BFodds-class'>General S4 class for representing multiple odds model comparisons, all against the same model</h2><span id='topic+BFodds-class'></span><span id='topic++2F+2Cnumeric+2CBFodds-method'></span><span id='topic++2F+2CBFodds+2CBFodds-method'></span><span id='topic++2A+2CBFodds+2CBFBayesFactor-method'></span><span id='topic++5B+2CBFodds+2Cindex+2Cmissing+2Cmissing-method'></span>

<h3>Description</h3>

<p>The <code>BFodds</code> class is a general S4 class for representing models model comparison via prior or posterior odds.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'numeric,BFodds'
e1 / e2

## S4 method for signature 'BFodds,BFodds'
e1 / e2

## S4 method for signature 'BFodds,BFBayesFactor'
e1 * e2

## S4 method for signature 'BFodds,index,missing,missing'
x[i, j, ..., drop = TRUE]
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BFodds-class_+3A_e1">e1</code></td>
<td>
<p>Numerator of the ratio</p>
</td></tr>
<tr><td><code id="BFodds-class_+3A_e2">e2</code></td>
<td>
<p>Denominator of the ratio</p>
</td></tr>
<tr><td><code id="BFodds-class_+3A_x">x</code></td>
<td>
<p>BFodds object</p>
</td></tr>
<tr><td><code id="BFodds-class_+3A_i">i</code></td>
<td>
<p>indices indicating elements to extract</p>
</td></tr>
<tr><td><code id="BFodds-class_+3A_j">j</code></td>
<td>
<p>unused for BFodds objects</p>
</td></tr>
<tr><td><code id="BFodds-class_+3A_...">...</code></td>
<td>
<p>further arguments passed to related methods</p>
</td></tr>
<tr><td><code id="BFodds-class_+3A_drop">drop</code></td>
<td>
<p>unused</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>BFodds</code> objects can be inverted by taking the reciprocal and can
be divided by one another, provided both objects have the same denominator. In addition,
the <code>t</code> (transpose) method can be used to invert odds objects.
</p>

<p>The <code>BFodds</code> class has the following slots defined:
</p>
<dl>
<dt>numerator</dt><dd><p>a list of models all inheriting <code>BFmodel</code>, each providing a single numerator</p>
</dd>
<dt>denominator</dt><dd><p>a single <code>BFmodel</code> object serving as the denominator for all model comparisons</p>
</dd>
<dt>logodds</dt><dd><p>a data frame containing information about the (log) prior odds between each numerator and the denominator</p>
</dd>
<dt>bayesFactor</dt><dd><p>a <code>BFBayesFactor</code> object (possibly) containing the evidence from the data.</p>
</dd>
<dt>version</dt><dd><p>character string giving the version and revision number of the package that the model was created in</p>
</dd>
</dl>


<hr>
<h2 id='BFprobability-class'>General S4 class for representing multiple model probability comparisons</h2><span id='topic+BFprobability-class'></span><span id='topic++2F+2CBFprobability+2Cnumeric-method'></span><span id='topic+-+2CBFprobability+2Cnumeric-method'></span><span id='topic++5B+2CBFprobability+2Cindex+2Cmissing+2Cmissing-method'></span><span id='topic+filterBF+2CBFprobability+2Ccharacter-method'></span>

<h3>Description</h3>

<p>The <code>BFprobability</code> class is a general S4 class for representing models model comparison via prior or posterior probabilities.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'BFprobability,numeric'
e1 / e2

## S4 method for signature 'BFprobability,numeric'
e1 - e2

## S4 method for signature 'BFprobability,index,missing,missing'
x[i, j, ..., drop = TRUE]

## S4 method for signature 'BFprobability,character'
filterBF(x, name, perl = FALSE, fixed = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BFprobability-class_+3A_e1">e1</code></td>
<td>
<p>BFprobability object</p>
</td></tr>
<tr><td><code id="BFprobability-class_+3A_e2">e2</code></td>
<td>
<p>new normalization constant</p>
</td></tr>
<tr><td><code id="BFprobability-class_+3A_x">x</code></td>
<td>
<p>BFprobability object</p>
</td></tr>
<tr><td><code id="BFprobability-class_+3A_i">i</code></td>
<td>
<p>indices indicating elements to extract</p>
</td></tr>
<tr><td><code id="BFprobability-class_+3A_j">j</code></td>
<td>
<p>unused for BFprobability objects</p>
</td></tr>
<tr><td><code id="BFprobability-class_+3A_...">...</code></td>
<td>
<p>further arguments passed to related methods</p>
</td></tr>
<tr><td><code id="BFprobability-class_+3A_drop">drop</code></td>
<td>
<p>unused</p>
</td></tr>
<tr><td><code id="BFprobability-class_+3A_name">name</code></td>
<td>
<p>regular expression to search name</p>
</td></tr>
<tr><td><code id="BFprobability-class_+3A_perl">perl</code></td>
<td>
<p>logical. Should perl-compatible regexps be used? See ?grepl for details.</p>
</td></tr>
<tr><td><code id="BFprobability-class_+3A_fixed">fixed</code></td>
<td>
<p>logical. If TRUE, pattern is a string to be matched as is. See ?grepl for details.</p>
</td></tr>
</table>


<h3>Details</h3>


<p>The <code>BFprobability</code> class has the following slots defined:
</p>
<dl>
<dt>odds</dt><dd><p>A BFodds object containing the models from which to compute the probabilities</p>
</dd>
<dt>normalize</dt><dd><p>the sum of the probabilities of all models (will often be 1.0)</p>
</dd>
<dt>version</dt><dd><p>character string giving the version and revision number of the package that the model was created in</p>
</dd>
</dl>


<hr>
<h2 id='compare'>Compare two models, with respect to some data</h2><span id='topic+compare'></span><span id='topic+compare+2CBFoneSample+2Cmissing+2Cdata.frame-method'></span><span id='topic+compare+2CBFlinearModel+2CBFlinearModel+2Cdata.frame-method'></span><span id='topic+compare+2CBFindepSample+2Cmissing+2Cdata.frame-method'></span><span id='topic+compare+2CBFlinearModel+2Cmissing+2Cdata.frame-method'></span><span id='topic+compare+2CBFmetat+2Cmissing+2Cdata.frame-method'></span><span id='topic+compare+2CBFproportion+2Cmissing+2Cdata.frame-method'></span><span id='topic+compare+2CBFcontingencyTable+2CBFcontingencyTable+2Cdata.frame-method'></span><span id='topic+compare+2CBFcontingencyTable+2Cmissing+2Cdata.frame-method'></span><span id='topic+compare+2CBFcorrelation+2Cmissing+2Cdata.frame-method'></span><span id='topic+compare+2CBFmcmc+2CBFmcmc+2CANY-method'></span><span id='topic+compare+2CBFmcmc+2Cmissing+2CANY-method'></span>

<h3>Description</h3>

<p>This method is used primarily in the backend, and will only rarely be called
by the end user. But see the examples below for a demonstration.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compare(numerator, denominator, data, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compare_+3A_numerator">numerator</code></td>
<td>
<p>first model</p>
</td></tr>
<tr><td><code id="compare_+3A_denominator">denominator</code></td>
<td>
<p>second model (if omitted, compare to predefined null)</p>
</td></tr>
<tr><td><code id="compare_+3A_data">data</code></td>
<td>
<p>data for the comparison</p>
</td></tr>
<tr><td><code id="compare_+3A_...">...</code></td>
<td>
<p>arguments passed to and from related methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The compare function will return a model comparison object, typically
a Bayes factor
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Sample from the posteriors for two models
data(puzzles)

## Main effects model; result is a BFmcmc object, inheriting
## mcmc from the coda package
mod1 = lmBF(RT ~ shape + color + ID, data = puzzles, whichRandom = "ID",
   progress = FALSE, posterior = TRUE, iterations = 1000)

plot(mod1)

## Full model
mod2 = lmBF(RT ~ shape*color + ID, data = puzzles, whichRandom = "ID",
   progress = FALSE, posterior = TRUE, iterations = 1000)

## Each BFmcmc object contains the model used to generate it, so we
## can compare them (data is not needed, it is contained in the objects):

compare(mod1, mod2)
</code></pre>

<hr>
<h2 id='contingencyTableBF'>Function for Bayesian analysis of one- and two-sample designs</h2><span id='topic+contingencyTableBF'></span>

<h3>Description</h3>

<p>This function computes Bayes factors for contingency tables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>contingencyTableBF(
  x,
  sampleType,
  fixedMargin = NULL,
  priorConcentration = 1,
  posterior = FALSE,
  callback = function(...) as.integer(0),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="contingencyTableBF_+3A_x">x</code></td>
<td>
<p>an m by n matrix of counts (integers m,n &gt; 1)</p>
</td></tr>
<tr><td><code id="contingencyTableBF_+3A_sampletype">sampleType</code></td>
<td>
<p>the sampling plan (see details)</p>
</td></tr>
<tr><td><code id="contingencyTableBF_+3A_fixedmargin">fixedMargin</code></td>
<td>
<p>for the independent multinomial sampling plan, which margin is fixed (&quot;rows&quot; or &quot;cols&quot;)</p>
</td></tr>
<tr><td><code id="contingencyTableBF_+3A_priorconcentration">priorConcentration</code></td>
<td>
<p>prior concentration parameter, set to 1 by default (see details)</p>
</td></tr>
<tr><td><code id="contingencyTableBF_+3A_posterior">posterior</code></td>
<td>
<p>if <code>TRUE</code>, return samples from the posterior instead
of Bayes factor</p>
</td></tr>
<tr><td><code id="contingencyTableBF_+3A_callback">callback</code></td>
<td>
<p>callback function for third-party interfaces</p>
</td></tr>
<tr><td><code id="contingencyTableBF_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to or from methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Bayes factor provided by <code>contingencyTableBF</code> tests the independence assumption in
contingency tables under various sampling plans, each of which is described below.
See Gunel and Dickey (1974) for more details.
</p>
<p>For <code>sampleType="poisson"</code>, the sampling plan is assumed to be
one in which observations occur as a poisson process with an overall
rate, and then assignment to particular factor levels occurs with
fixed probability. Under the null hypothesis, the assignments to the
two factors are independent. Importantly, the total N is not fixed.
</p>
<p>For <code>sampleType="jointMulti"</code> (joint multinomial), the sampling
plan is assumed to be one in which the total N is fixed, and observations
are assigned to cells with fixed probability. Under the null hypothesis, the
assignments to the two factors are independent.
</p>
<p>For <code>sampleType="indepMulti"</code> (independent multinomial), the
sampling plan is assumed to be one in which row or column totals are fixed,
and each row or column is assumed to be multinomially distributed.
Under the null hypothesis, each row or column is assumed to have the
same multinomial probabilities. The fixed margin must be given by
the <code>fixedMargin</code> argument.
</p>
<p>For <code>sampleType="hypergeom"</code> (hypergeometric), the sampling
plan is assumed to be one in which both the row and column totals are fixed.
Under the null hypothesis, the cell counts are assumed to be governed by the
hypergeometric distribution.
</p>
<p>For all models, the argument <code>priorConcentration</code> indexes
the expected deviation from the null hypothesis under the alternative,
and corresponds to Gunel and Dickey's (1974) &quot;a&quot; parameter.
</p>


<h3>Value</h3>

<p>If <code>posterior</code> is <code>FALSE</code>, an object of class
<code>BFBayesFactor</code> containing the computed model comparisons is
returned.
</p>
<p>If <code>posterior</code> is <code>TRUE</code>, an object of class <code>BFmcmc</code>,
containing MCMC samples from the posterior is returned.
</p>


<h3>Note</h3>

<p>Posterior sampling for the hypergeometric model under the alternative
has not yet been implemented.
</p>


<h3>Author(s)</h3>

<p>Richard D. Morey (<a href="mailto:richarddmorey@gmail.com">richarddmorey@gmail.com</a>)
</p>
<p>Tahira Jamil (<a href="mailto:tahjamil@gmail.com">tahjamil@gmail.com</a>)
</p>


<h3>References</h3>

<p>Gunel, E. and Dickey, J., (1974)
Bayes Factors for Independence in Contingency Tables. Biometrika, 61, 545-557
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Hraba and Grant (1970) doll race data
data(raceDolls)

## Compute Bayes factor for independent binomial design, with
## columns as the fixed margin
bf = contingencyTableBF(raceDolls, sampleType = "indepMulti", fixedMargin = "cols")
bf

## Posterior distribution of difference in probabilities, under alternative
chains = posterior(bf, iterations = 10000)
sameRaceGivenWhite = chains[,"pi[1,1]"] / chains[,"pi[*,1]"]
sameRaceGivenBlack = chains[,"pi[1,2]"] / chains[,"pi[*,2]"]
hist(sameRaceGivenWhite - sameRaceGivenBlack, xlab = "Probability increase",
  main = "Increase in probability of child picking\nsame race doll (white - black)",
  freq=FALSE, yaxt='n')
box()

</code></pre>

<hr>
<h2 id='correlationBF'>Function for Bayesian analysis of correlations</h2><span id='topic+correlationBF'></span>

<h3>Description</h3>

<p>Bayes factors or posterior samples for correlations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>correlationBF(
  y,
  x,
  rscale = "medium",
  nullInterval = NULL,
  posterior = FALSE,
  callback = function(...) as.integer(0),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="correlationBF_+3A_y">y</code></td>
<td>
<p>first continuous variable</p>
</td></tr>
<tr><td><code id="correlationBF_+3A_x">x</code></td>
<td>
<p>second continuous variable</p>
</td></tr>
<tr><td><code id="correlationBF_+3A_rscale">rscale</code></td>
<td>
<p>prior scale.  A number of preset values can be given as
strings; see Details.</p>
</td></tr>
<tr><td><code id="correlationBF_+3A_nullinterval">nullInterval</code></td>
<td>
<p>optional vector of length 2 containing
lower and upper bounds of an interval hypothesis to test, in correlation units</p>
</td></tr>
<tr><td><code id="correlationBF_+3A_posterior">posterior</code></td>
<td>
<p>if <code>TRUE</code>, return samples from the posterior instead
of Bayes factor</p>
</td></tr>
<tr><td><code id="correlationBF_+3A_callback">callback</code></td>
<td>
<p>callback function for third-party interfaces</p>
</td></tr>
<tr><td><code id="correlationBF_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to or from methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Bayes factor provided by <code>ttestBF</code> tests the null hypothesis that
the true linear correlation <code class="reqn">\rho</code> between two samples (<code class="reqn">y</code> and <code class="reqn">x</code>)
of size <code class="reqn">n</code> from normal populations is equal to 0. The Bayes factor is based on Jeffreys (1961)
test for linear correlation. Noninformative priors are assumed for the population means and
variances of the two population; a shifted, scaled beta(1/rscale,1/rscale) prior distribution
is assumed for <code class="reqn">\rho</code> (note that <code>rscale</code> is called <code class="reqn">\kappa</code> by
Ly et al. 2015; we call it <code>rscale</code> for consistency with other BayesFactor functions).
</p>
<p>For the <code>rscale</code> argument, several named values are recognized:
&quot;medium.narrow&quot;, &quot;medium&quot;, &quot;wide&quot;, and &quot;ultrawide&quot;. These correspond
to <code class="reqn">r</code> scale values of <code class="reqn">1/\sqrt(27)</code>, <code class="reqn">1/3</code>,
<code class="reqn">1/\sqrt(3)</code> and 1, respectively.
</p>
<p>The Bayes factor is computed via several different methods.
</p>


<h3>Value</h3>

<p>If <code>posterior</code> is <code>FALSE</code>, an object of class
<code>BFBayesFactor</code> containing the computed model comparisons is
returned. If <code>nullInterval</code> is defined, then two Bayes factors will
be computed: The Bayes factor for the interval against the null hypothesis
that the probability is 0, and the corresponding Bayes factor for
the complement of the interval.
</p>
<p>If <code>posterior</code> is <code>TRUE</code>, an object of class <code>BFmcmc</code>,
containing MCMC samples from the posterior is returned.
</p>


<h3>Author(s)</h3>

<p>Richard D. Morey (<a href="mailto:richarddmorey@gmail.com">richarddmorey@gmail.com</a>)
</p>


<h3>References</h3>

<p>Ly, A., Verhagen, A. J. &amp; Wagenmakers, E.-J. (2015).
Harold Jeffreys's Default Bayes Factor Hypothesis Tests: Explanation, Extension, and Application in Psychology.
Journal of Mathematical Psychology, Available online 28 August 2015, https://dx.doi.org/10.1016/j.jmp.2015.06.004.
</p>
<p>Jeffreys, H. (1961). Theory of probability, 3rd edn. Oxford, UK: Oxford University Press.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+cor.test">cor.test</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>bf = correlationBF(y = iris$Sepal.Length, x = iris$Sepal.Width)
bf
## Sample from the corresponding posterior distribution
samples = correlationBF(y = iris$Sepal.Length, x = iris$Sepal.Width,
          posterior = TRUE, iterations = 10000)
plot(samples[,"rho"])
</code></pre>

<hr>
<h2 id='enumerateGeneralModels'>Function for generation of nested linear models</h2><span id='topic+enumerateGeneralModels'></span>

<h3>Description</h3>

<p>Generate lists of nested models, given a model formula
</p>


<h3>Usage</h3>

<pre><code class='language-R'>enumerateGeneralModels(
  fmla,
  whichModels,
  neverExclude = NULL,
  includeBottom = TRUE,
  data = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="enumerateGeneralModels_+3A_fmla">fmla</code></td>
<td>
<p>formula for the &quot;full&quot; model</p>
</td></tr>
<tr><td><code id="enumerateGeneralModels_+3A_whichmodels">whichModels</code></td>
<td>
<p>which subsets of models to generate</p>
</td></tr>
<tr><td><code id="enumerateGeneralModels_+3A_neverexclude">neverExclude</code></td>
<td>
<p>a character vector of terms to never remove</p>
</td></tr>
<tr><td><code id="enumerateGeneralModels_+3A_includebottom">includeBottom</code></td>
<td>
<p>Include the base model containing only <code>neverExclude</code> terms</p>
</td></tr>
<tr><td><code id="enumerateGeneralModels_+3A_data">data</code></td>
<td>
<p>a data frame containing the columns mentioned in <code>fmla</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a backend function not intended for users. It is exposed for third-party
applications.
</p>

<hr>
<h2 id='extractBF'>Extract the Bayes factor from an object</h2><span id='topic+extractBF'></span><span id='topic+extractBF+2CBFBayesFactor-method'></span>

<h3>Description</h3>

<p>Extract the Bayes factor from an object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extractBF(x, logbf = FALSE, onlybf = FALSE)

## S4 method for signature 'BFBayesFactor'
extractBF(x, logbf = FALSE, onlybf = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extractBF_+3A_x">x</code></td>
<td>
<p>object from which to extract the Bayes factors</p>
</td></tr>
<tr><td><code id="extractBF_+3A_logbf">logbf</code></td>
<td>
<p>return the logarithm of the Bayes factors</p>
</td></tr>
<tr><td><code id="extractBF_+3A_onlybf">onlybf</code></td>
<td>
<p>return a vector of only the Bayes factors</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns an object containing Bayes factors extracted from the object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Sample from the posteriors for two models
data(puzzles)

bf = lmBF(RT ~ shape*color + ID, data = puzzles, whichRandom="ID", progress=FALSE)

extractBF(bf)
</code></pre>

<hr>
<h2 id='extractOdds'>Extract the odds from an object</h2><span id='topic+extractOdds'></span><span id='topic+extractOdds+2CBFodds-method'></span>

<h3>Description</h3>

<p>Extract the odds from an object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extractOdds(x, logodds = FALSE, onlyodds = FALSE)

## S4 method for signature 'BFodds'
extractOdds(x, logodds = FALSE, onlyodds = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extractOdds_+3A_x">x</code></td>
<td>
<p>object from which to extract</p>
</td></tr>
<tr><td><code id="extractOdds_+3A_logodds">logodds</code></td>
<td>
<p>return the logarithm</p>
</td></tr>
<tr><td><code id="extractOdds_+3A_onlyodds">onlyodds</code></td>
<td>
<p>return a vector of only the odds</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns an object containing odds extracted from the object
</p>

<hr>
<h2 id='extractProbabilities'>Extract the probabilities from an object</h2><span id='topic+extractProbabilities'></span><span id='topic+extractProbabilities+2CBFprobability-method'></span>

<h3>Description</h3>

<p>Extract the probabilities from an object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extractProbabilities(x, logprobs = FALSE, onlyprobs = FALSE)

## S4 method for signature 'BFprobability'
extractProbabilities(x, logprobs = FALSE, onlyprobs = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extractProbabilities_+3A_x">x</code></td>
<td>
<p>object from which to extract</p>
</td></tr>
<tr><td><code id="extractProbabilities_+3A_logprobs">logprobs</code></td>
<td>
<p>return the logarithm</p>
</td></tr>
<tr><td><code id="extractProbabilities_+3A_onlyprobs">onlyprobs</code></td>
<td>
<p>return a vector of only the probabilities</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns an object containing probabilities extracted from the object
</p>

<hr>
<h2 id='filterBF'>Filter the elements of an object according to some pre-specified criteria</h2><span id='topic+filterBF'></span>

<h3>Description</h3>

<p>Filter the elements of an object according to some pre-specified criteria
</p>


<h3>Usage</h3>

<pre><code class='language-R'>filterBF(x, name, perl = FALSE, fixed = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="filterBF_+3A_x">x</code></td>
<td>
<p>object</p>
</td></tr>
<tr><td><code id="filterBF_+3A_name">name</code></td>
<td>
<p>regular expression to search name</p>
</td></tr>
<tr><td><code id="filterBF_+3A_perl">perl</code></td>
<td>
<p>logical. Should perl-compatible regexps be used? See ?grepl for details.</p>
</td></tr>
<tr><td><code id="filterBF_+3A_fixed">fixed</code></td>
<td>
<p>logical. If TRUE, pattern is a string to be matched as is. See ?grepl for details.</p>
</td></tr>
<tr><td><code id="filterBF_+3A_...">...</code></td>
<td>
<p>arguments passed to and from related methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a filtered object
</p>

<hr>
<h2 id='generalTestBF'>Function to compute Bayes factors for general designs</h2><span id='topic+generalTestBF'></span>

<h3>Description</h3>

<p>This function computes Bayes factors corresponding to restrictions on a full model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>generalTestBF(
  formula,
  data,
  whichRandom = NULL,
  whichModels = "withmain",
  neverExclude = NULL,
  iterations = 10000,
  progress = getOption("BFprogress", interactive()),
  rscaleFixed = "medium",
  rscaleRandom = "nuisance",
  rscaleCont = "medium",
  rscaleEffects = NULL,
  multicore = FALSE,
  method = "auto",
  noSample = FALSE,
  callback = function(...) as.integer(0)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="generalTestBF_+3A_formula">formula</code></td>
<td>
<p>a formula containing the full model for the analysis
(see Examples)</p>
</td></tr>
<tr><td><code id="generalTestBF_+3A_data">data</code></td>
<td>
<p>a data frame containing data for all factors in the formula</p>
</td></tr>
<tr><td><code id="generalTestBF_+3A_whichrandom">whichRandom</code></td>
<td>
<p>a character vector specifying which factors are random</p>
</td></tr>
<tr><td><code id="generalTestBF_+3A_whichmodels">whichModels</code></td>
<td>
<p>which set of models to compare; see Details</p>
</td></tr>
<tr><td><code id="generalTestBF_+3A_neverexclude">neverExclude</code></td>
<td>
<p>a character vector containing a regular expression (see
help for <a href="base.html#topic+regex">regex</a> for details) that indicates which terms to always keep
in the analysis</p>
</td></tr>
<tr><td><code id="generalTestBF_+3A_iterations">iterations</code></td>
<td>
<p>How many Monte Carlo simulations to generate, if relevant</p>
</td></tr>
<tr><td><code id="generalTestBF_+3A_progress">progress</code></td>
<td>
<p>if <code>TRUE</code>, show progress with a text progress bar</p>
</td></tr>
<tr><td><code id="generalTestBF_+3A_rscalefixed">rscaleFixed</code></td>
<td>
<p>prior scale for standardized, reduced fixed effects. A
number of preset values can be given as strings; see Details.</p>
</td></tr>
<tr><td><code id="generalTestBF_+3A_rscalerandom">rscaleRandom</code></td>
<td>
<p>prior scale for standardized random effects</p>
</td></tr>
<tr><td><code id="generalTestBF_+3A_rscalecont">rscaleCont</code></td>
<td>
<p>prior scale for standardized slopes</p>
</td></tr>
<tr><td><code id="generalTestBF_+3A_rscaleeffects">rscaleEffects</code></td>
<td>
<p>A named vector of prior settings for individual factors,
overriding rscaleFixed and rscaleRandom. Values are scales, names are factor names.</p>
</td></tr>
<tr><td><code id="generalTestBF_+3A_multicore">multicore</code></td>
<td>
<p>if <code>TRUE</code> use multiple cores through the <code>doMC</code>
package. Unavailable on Windows.</p>
</td></tr>
<tr><td><code id="generalTestBF_+3A_method">method</code></td>
<td>
<p>approximation method, if needed. See <code><a href="#topic+nWayAOV">nWayAOV</a></code> for
details.</p>
</td></tr>
<tr><td><code id="generalTestBF_+3A_nosample">noSample</code></td>
<td>
<p>if <code>TRUE</code>, do not sample, instead returning NA.</p>
</td></tr>
<tr><td><code id="generalTestBF_+3A_callback">callback</code></td>
<td>
<p>callback function for third-party interfaces</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See the help for <code><a href="#topic+anovaBF">anovaBF</a></code> and <code><a href="#topic+anovaBF">anovaBF</a></code> or details.
</p>
<p>Models, priors, and methods of computation are provided in Rouder et al.
(2012) and Liang et al (2008).
</p>


<h3>Value</h3>

<p>An object of class <code>BFBayesFactor</code>, containing the computed
model comparisons
</p>


<h3>Note</h3>

<p>The function <code>generalTestBF</code> can compute Bayes factors for all
restrictions of a full model against the null
hypothesis that all effects are 0. The total number of tests
computed &ndash; if all tests are requested &ndash; will be <code class="reqn">2^K-1</code>
for <code class="reqn">K</code> factors or covariates.
This number increases very quickly with the number of tested predictors. An option is included to
prevent testing too many models: <code>options('BFMaxModels')</code>, which defaults to 50,000, is
the maximum number of models that will be analyzed at once. This can
be increased by increased using <code><a href="base.html#topic+options">options</a></code>.
</p>
<p>It is possible to reduce the number of models tested by only testing the
most complex model and every restriction that can be formed by removing
one factor or interaction using the <code>whichModels</code> argument. See the
help for <code><a href="#topic+anovaBF">anovaBF</a></code> for details.
</p>


<h3>Author(s)</h3>

<p>Richard D. Morey (<a href="mailto:richarddmorey@gmail.com">richarddmorey@gmail.com</a>)
</p>


<h3>References</h3>

<p>Rouder, J. N., Morey, R. D., Speckman, P. L., Province, J. M., (2012)
Default Bayes Factors for ANOVA Designs. Journal of Mathematical
Psychology.  56.  p. 356-374.
</p>
<p>Liang, F. and Paulo, R. and Molina, G. and Clyde, M. A. and
Berger, J. O. (2008). Mixtures of g-priors for Bayesian Variable
Selection. Journal of the American Statistical Association, 103, pp.
410-423
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lmBF">lmBF</a></code>, for testing specific models, and
<code><a href="#topic+regressionBF">regressionBF</a></code> and <code>anovaBF</code> for other functions for
testing multiple models simultaneously.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Puzzles example: see ?puzzles and ?anovaBF
data(puzzles)
## neverExclude argument makes sure that participant factor ID
## is in all models
result = generalTestBF(RT ~ shape*color + ID, data = puzzles, whichRandom = "ID",
neverExclude="ID", progress=FALSE)
result

</code></pre>

<hr>
<h2 id='linearReg.R2stat'>Use R^2 statistic to compute Bayes factor for regression designs</h2><span id='topic+linearReg.R2stat'></span>

<h3>Description</h3>

<p>Using the classical R^2 test statistic for (linear) regression designs, this
function computes the corresponding Bayes factor test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>linearReg.R2stat(N, p, R2, rscale = "medium", simple = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="linearReg.R2stat_+3A_n">N</code></td>
<td>
<p>number of observations</p>
</td></tr>
<tr><td><code id="linearReg.R2stat_+3A_p">p</code></td>
<td>
<p>number of predictors in model, excluding intercept</p>
</td></tr>
<tr><td><code id="linearReg.R2stat_+3A_r2">R2</code></td>
<td>
<p>proportion of variance accounted for by the predictors, excluding
intercept</p>
</td></tr>
<tr><td><code id="linearReg.R2stat_+3A_rscale">rscale</code></td>
<td>
<p>numeric prior scale</p>
</td></tr>
<tr><td><code id="linearReg.R2stat_+3A_simple">simple</code></td>
<td>
<p>if <code>TRUE</code>, return only the Bayes factor</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function can be used to compute the Bayes factor corresponding to a
multiple regression, using the classical R^2 (coefficient of determination)
statistic.  It can be used when you don't have access to the full data set
for analysis by <code><a href="#topic+lmBF">lmBF</a></code>, but you do have the test statistic.
</p>
<p>For details about the model, see the help for <code><a href="#topic+regressionBF">regressionBF</a></code>,
and the references therein.
</p>
<p>The Bayes factor is computed via Gaussian quadrature.
</p>


<h3>Value</h3>

<p>If <code>simple</code> is <code>TRUE</code>, returns the Bayes factor (against the
intercept-only null). If <code>FALSE</code>, the function returns a
vector of length 3 containing the computed log(e) Bayes factor,
along with a proportional error estimate on the Bayes factor and the method used to compute it.
</p>


<h3>Author(s)</h3>

<p>Richard D. Morey (<a href="mailto:richarddmorey@gmail.com">richarddmorey@gmail.com</a>) and Jeffrey N.
Rouder (<a href="mailto:rouderj@missouri.edu">rouderj@missouri.edu</a>)
</p>


<h3>References</h3>

<p>Liang, F. and Paulo, R. and Molina, G. and Clyde, M. A. and
Berger, J. O. (2008). Mixtures of g-priors for Bayesian Variable
Selection. Journal of the American Statistical Association, 103, pp.
410-423
</p>
<p>Rouder, J. N.  and Morey, R. D. (in press, Multivariate Behavioral Research). Bayesian testing in
regression.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+integrate">integrate</a></code>, <code><a href="stats.html#topic+lm">lm</a></code>; see
<code><a href="#topic+lmBF">lmBF</a></code> for the intended interface to this function, using
the full data set.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Use attitude data set
data(attitude)
## Scatterplot
lm1 = lm(rating~complaints,data=attitude)
plot(attitude$complaints,attitude$rating)
abline(lm1)
## Traditional analysis
## p value is highly significant
summary(lm1)

## Bayes factor
## The Bayes factor is over 400,000;
## the data strongly favor hypothesis that
## the slope is not 0.
result = linearReg.R2stat(30,1,0.6813)
exp(result[['bf']])
</code></pre>

<hr>
<h2 id='lmBF'>Function to compute Bayes factors for specific linear models</h2><span id='topic+lmBF'></span>

<h3>Description</h3>

<p>This function computes Bayes factors, or samples from the posterior, of
specific linear models (either ANOVA or regression).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lmBF(
  formula,
  data,
  whichRandom = NULL,
  rscaleFixed = "medium",
  rscaleRandom = "nuisance",
  rscaleCont = "medium",
  rscaleEffects = NULL,
  posterior = FALSE,
  progress = getOption("BFprogress", interactive()),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lmBF_+3A_formula">formula</code></td>
<td>
<p>a formula containing all factors to include in the analysis
(see Examples)</p>
</td></tr>
<tr><td><code id="lmBF_+3A_data">data</code></td>
<td>
<p>a data frame containing data for all factors in the formula</p>
</td></tr>
<tr><td><code id="lmBF_+3A_whichrandom">whichRandom</code></td>
<td>
<p>a character vector specifying which factors are random</p>
</td></tr>
<tr><td><code id="lmBF_+3A_rscalefixed">rscaleFixed</code></td>
<td>
<p>prior scale for standardized, reduced fixed effects. A
number of preset values can be given as strings; see Details.</p>
</td></tr>
<tr><td><code id="lmBF_+3A_rscalerandom">rscaleRandom</code></td>
<td>
<p>prior scale for standardized random effects</p>
</td></tr>
<tr><td><code id="lmBF_+3A_rscalecont">rscaleCont</code></td>
<td>
<p>prior scale for standardized slopes. A
number of preset values can be given as strings; see Details.</p>
</td></tr>
<tr><td><code id="lmBF_+3A_rscaleeffects">rscaleEffects</code></td>
<td>
<p>A named vector of prior settings for individual factors,
overriding rscaleFixed and rscaleRandom. Values are scales, names are factor names.</p>
</td></tr>
<tr><td><code id="lmBF_+3A_posterior">posterior</code></td>
<td>
<p>if <code>TRUE</code>, return samples from the posterior
distribution instead of the Bayes factor</p>
</td></tr>
<tr><td><code id="lmBF_+3A_progress">progress</code></td>
<td>
<p>if <code>TRUE</code>, show progress with a text progress bar</p>
</td></tr>
<tr><td><code id="lmBF_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to or from methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function provides an interface for computing Bayes factors  for
specific linear models against the intercept-only null; other tests may be
obtained by computing two models and dividing their Bayes factors. Specifics
about the priors for regression models &ndash; and possible settings for
<code>rscaleCont</code> &ndash; can be found in the help for <code><a href="#topic+regressionBF">regressionBF</a></code>;
likewise, details for ANOVA models &ndash; and settings for <code>rscaleFixed</code>
and <code>rscaleRandom</code> &ndash; can be found in the help for <code><a href="#topic+anovaBF">anovaBF</a></code>.
</p>
<p>Currently, the function does not allow for general linear models, containing
both continuous and categorical predcitors, but this support will be added
in the future.
</p>


<h3>Value</h3>

<p>If <code>posterior</code> is <code>FALSE</code>, an object of class
<code>BFBayesFactor</code>, containing the computed model comparisons is
returned. Otherwise, an object of class <code>BFmcmc</code>, containing MCMC
samples from the posterior is returned.
</p>


<h3>Author(s)</h3>

<p>Richard D. Morey (<a href="mailto:richarddmorey@gmail.com">richarddmorey@gmail.com</a>)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+regressionBF">regressionBF</a></code> and <code>anovaBF</code> for
testing many regression or ANOVA models simultaneously.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Puzzles data; see ?puzzles for details
data(puzzles)
## Bayes factor of full model against null
bfFull = lmBF(RT ~ shape + color + shape:color + ID, data = puzzles, whichRandom = "ID")

## Bayes factor of main effects only against null
bfMain = lmBF(RT ~ shape + color + ID, data = puzzles, whichRandom = "ID")

## Compare the main-effects only model to the full model
bfMain / bfFull

## sample from the posterior of the full model
samples = lmBF(RT ~ shape + color + shape:color + ID,
           data = puzzles, whichRandom = "ID", posterior = TRUE,
           iterations = 1000)

## Aother way to sample from the posterior of the full model
samples2 = posterior(bfFull, iterations = 1000)
</code></pre>

<hr>
<h2 id='logMeanExpLogs'>Functions to compute the logarithm of the mean (and cumulative means) of
vectors of logarithms</h2><span id='topic+logMeanExpLogs'></span><span id='topic+logCumMeanExpLogs'></span><span id='topic+logSummaryStats'></span>

<h3>Description</h3>

<p>Given a vector of numeric values of real values represented in log form,
<code>logMeanExpLogs</code> computes the logarithm of the mean of the
(exponentiated) values. <code>logCumMeanExpLogs</code> computes the logarithm of
the cumulative mean.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logMeanExpLogs(v)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="logMeanExpLogs_+3A_v">v</code></td>
<td>
<p>A vector of (log) values</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given a vector of values of log values <var>v</var>, one could compute
<code>log(mean(exp(v)))</code> in R. However, exponentiating and summing will cause
a loss of precision, and possibly an overflow. These functions use the
identity </p>
<p style="text-align: center;"><code class="reqn">\log(e^a + e^b) = a + \log(1+e^{b-a})</code>
</p>
<p> and the method of computing <code class="reqn">\log(1+e^x)</code>
that avoids overflow (see the references). The code is written in C for very
fast computations.
</p>


<h3>Value</h3>

<p><code>logMeanExpLogs</code> returns a single value,
<code>logCumMeanExpLogs</code> returns a vector of values of the same length as
<var>v</var>, and <code>logSummaryStats</code> returns a list of the
log mean, log variance, and cumulative log means.
</p>


<h3>Author(s)</h3>

<p>Richard D. Morey (<a href="mailto:richarddmorey@gmail.com">richarddmorey@gmail.com</a>)
</p>


<h3>References</h3>

<p>For details of the approximation of <code class="reqn">\log(1+e^x)</code>
used to prevent loss of precision, see
<a href="https://www.codeproject.com/Articles/25294/Avoiding-Overflow-Underflow-and-Loss-of-Precision">https://www.codeproject.com/Articles/25294/Avoiding-Overflow-Underflow-and-Loss-of-Precision</a> and
<a href="https://www.johndcook.com/blog/standard_deviation/">https://www.johndcook.com/blog/standard_deviation/</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Sample 100 values
y = log(rexp(100,1))

# These will give the same value,
# since e^y is "small"
logMeanExpLogs(y)
log(mean(exp(y)))

# We can make e^x overflow by multiplying
# e^y by e^1000
largeVals = y + 1000

# This will return 1000 + log(mean(exp(y)))
logMeanExpLogs(largeVals)

# This will overflow
log(mean(exp(largeVals)))

</code></pre>

<hr>
<h2 id='meta.ttestBF'>Function for Bayesian analysis of one- and two-sample designs</h2><span id='topic+meta.ttestBF'></span>

<h3>Description</h3>

<p>This function computes mata-analytic Bayes factors, or samples from the posterior, for
one- and two-sample designs where multiple t values have been observed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>meta.ttestBF(
  t,
  n1,
  n2 = NULL,
  nullInterval = NULL,
  rscale = "medium",
  posterior = FALSE,
  callback = function(...) as.integer(0),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="meta.ttestBF_+3A_t">t</code></td>
<td>
<p>a vector of t statistics</p>
</td></tr>
<tr><td><code id="meta.ttestBF_+3A_n1">n1</code></td>
<td>
<p>a vector of sample sizes for the first (or only) condition</p>
</td></tr>
<tr><td><code id="meta.ttestBF_+3A_n2">n2</code></td>
<td>
<p>a vector of sample sizes. If <code>NULL</code>, a one-sample design is assumed</p>
</td></tr>
<tr><td><code id="meta.ttestBF_+3A_nullinterval">nullInterval</code></td>
<td>
<p>optional vector of length 2 containing lower and upper bounds of
an interval hypothesis to test, in standardized units</p>
</td></tr>
<tr><td><code id="meta.ttestBF_+3A_rscale">rscale</code></td>
<td>
<p>prior scale.  A number of preset values can be given as
strings; see Details.</p>
</td></tr>
<tr><td><code id="meta.ttestBF_+3A_posterior">posterior</code></td>
<td>
<p>if <code>TRUE</code>, return samples from the posterior instead
of Bayes factor</p>
</td></tr>
<tr><td><code id="meta.ttestBF_+3A_callback">callback</code></td>
<td>
<p>callback function for third-party interfaces</p>
</td></tr>
<tr><td><code id="meta.ttestBF_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to or from methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Bayes factor provided by <code>meta.ttestBF</code> tests the null hypothesis that
the true effect size (or alternatively, the noncentrality parameters) underlying a
set of t statistics is 0. Specifically, the Bayes factor compares two
hypotheses: that the standardized effect size is 0, or that the standardized
effect size is not 0. Note that there is assumed to be a single, common effect size
<code class="reqn">\delta</code> underlying all t statistics. For one-sample tests, the standardized effect size is
<code class="reqn">(\mu-\mu_0)/\sigma</code>; for two sample tests, the
standardized effect size is <code class="reqn">(\mu_2-\mu_1)/\sigma</code>.
</p>
<p>A Cauchy prior is placed on the standardized effect size.
The <code>rscale</code> argument controls the scale of the prior distribution,
with <code>rscale=1</code> yielding a standard Cauchy prior. See the help for
<code><a href="#topic+ttestBF">ttestBF</a></code> and the references below for more details.
</p>
<p>The Bayes factor is computed via Gaussian quadrature. Posterior samples are
drawn via independent-candidate Metropolis-Hastings.
</p>


<h3>Value</h3>

<p>If <code>posterior</code> is <code>FALSE</code>, an object of class
<code>BFBayesFactor</code> containing the computed model comparisons is
returned. If <code>nullInterval</code> is defined, then two Bayes factors will
be computed: The Bayes factor for the interval against the null hypothesis
that the standardized effect is 0, and the corresponding Bayes factor for
the compliment of the interval.
</p>
<p>If <code>posterior</code> is <code>TRUE</code>, an object of class <code>BFmcmc</code>,
containing MCMC samples from the posterior is returned.
</p>


<h3>Note</h3>

<p>To obtain the same Bayes factors as Rouder and Morey (2011),
change the prior scale to 1.
</p>


<h3>Author(s)</h3>

<p>Richard D. Morey (<a href="mailto:richarddmorey@gmail.com">richarddmorey@gmail.com</a>)
</p>


<h3>References</h3>

<p>Morey, R. D. &amp; Rouder, J. N. (2011). Bayes Factor Approaches for Testing
Interval Null Hypotheses. Psychological Methods, 16, 406-419
</p>
<p>Rouder, J. N., Speckman, P. L., Sun, D., Morey, R. D., &amp; Iverson, G.
(2009). Bayesian t-tests for accepting and rejecting the null hypothesis.
Psychonomic Bulletin &amp; Review, 16, 225-237
</p>
<p>Rouder, J. N. &amp; Morey, R. D. (2011). A Bayes Factor Meta-Analysis of Bem's ESP Claim.
Psychonomic Bulletin &amp; Review, 18, 682-689
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ttestBF">ttestBF</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Bem's (2010) data (see Rouder &amp; Morey, 2011)
t=c(-.15,2.39,2.42,2.43)
N=c(100,150,97,99)

## Using rscale=1 and one-sided test to be
## consistent with Rouder &amp; Morey (2011)
bf = meta.ttestBF(t, N, rscale=1, nullInterval=c(0, Inf))
bf[1]

## plot posterior distribution of delta, assuming alternative
## turn off progress bar for example
samples = posterior(bf[1], iterations = 1000, progress = FALSE)
## Note that posterior() respects the nullInterval
plot(samples)
summary(samples)
</code></pre>

<hr>
<h2 id='model.matrix+2CBFBayesFactor-method'>Design matrices for Bayes factor linear models analyses.</h2><span id='topic+model.matrix+2CBFBayesFactor-method'></span><span id='topic+model.matrix+2CBFBayesFactor'></span><span id='topic+model.matrix+2CBFBayesFactorTop-method'></span>

<h3>Description</h3>

<p>This function returns the design matrix used for computation of the Bayes factor
for the numerator of a <code>BFBayesFactor</code> object. There must not be more
than one numerator in the <code>BFBayesFactor</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'BFBayesFactor'
model.matrix(object, ...)

## S4 method for signature 'BFBayesFactorTop'
model.matrix(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="model.matrix+2B2CBFBayesFactor-method_+3A_object">object</code></td>
<td>
<p>a BayesFactor object with a single numerator</p>
</td></tr>
<tr><td><code id="model.matrix+2B2CBFBayesFactor-method_+3A_...">...</code></td>
<td>
<p>arguments passed to and from related methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the design matrix for the corresponding model. The 'gMap' attribute of the returned
matrix contains the mapping from columns of the design matrix to g parameters
</p>


<h3>References</h3>

<p>Rouder, J. N., Morey, R. D., Speckman, P. L., Province, J. M., (2012)
Default Bayes Factors for ANOVA Designs. Journal of Mathematical
Psychology.  56.  p. 356-374.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Gets the design matrix for a simple analysis
data(sleep)

bf = anovaBF(extra ~ group + ID, data = sleep, whichRandom="ID", progress=FALSE)
X = model.matrix(bf)

## Show dimensions of X (should be 20 by 12)
dim(X)
</code></pre>

<hr>
<h2 id='newPriorOdds'>Create prior odds from a Bayes factor object</h2><span id='topic+newPriorOdds'></span>

<h3>Description</h3>

<p>Create a prior odds object from a Bayes factor object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>newPriorOdds(bf, type = "equal")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="newPriorOdds_+3A_bf">bf</code></td>
<td>
<p>A BFBayesFactor object, eg, from an analysis</p>
</td></tr>
<tr><td><code id="newPriorOdds_+3A_type">type</code></td>
<td>
<p>The type of prior odds to create (by default &quot;equal&quot;; see details)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function takes a Bayes factor object and, using its structure and
specified type of prior odds, will create a prior odds object.
</p>
<p>For now, the only type is &quot;equal&quot;, which assigns equal prior odds to all
models.
</p>


<h3>Value</h3>

<p>A (prior) BFodds object, which can then be multiplied by the
BFBayesFactor object to obtain posterior odds.
</p>


<h3>Author(s)</h3>

<p>Richard D. Morey (<a href="mailto:richarddmorey@gmail.com">richarddmorey@gmail.com</a>)
</p>

<hr>
<h2 id='nWayAOV'>Use ANOVA design matrix to compute Bayes factors or sample posterior</h2><span id='topic+nWayAOV'></span>

<h3>Description</h3>

<p>Computes a single Bayes factor, or samples from the posterior, for an ANOVA
model defined by a design matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nWayAOV(
  y,
  X,
  gMap,
  rscale,
  iterations = 10000,
  progress = getOption("BFprogress", interactive()),
  callback = function(...) as.integer(0),
  gibbs = NULL,
  posterior = FALSE,
  ignoreCols = NULL,
  thin = 1,
  method = "auto",
  continuous = FALSE,
  noSample = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nWayAOV_+3A_y">y</code></td>
<td>
<p>vector of observations</p>
</td></tr>
<tr><td><code id="nWayAOV_+3A_x">X</code></td>
<td>
<p>design matrix whose number of rows match <code>length(y)</code>.</p>
</td></tr>
<tr><td><code id="nWayAOV_+3A_gmap">gMap</code></td>
<td>
<p>vector grouping the columns of <code>X</code> (see Details).</p>
</td></tr>
<tr><td><code id="nWayAOV_+3A_rscale">rscale</code></td>
<td>
<p>a vector of prior scale(s) of appropriate length (see
Details).</p>
</td></tr>
<tr><td><code id="nWayAOV_+3A_iterations">iterations</code></td>
<td>
<p>Number of Monte Carlo samples used to estimate Bayes
factor or posterior</p>
</td></tr>
<tr><td><code id="nWayAOV_+3A_progress">progress</code></td>
<td>
<p>if <code>TRUE</code>, show progress with a text progress bar</p>
</td></tr>
<tr><td><code id="nWayAOV_+3A_callback">callback</code></td>
<td>
<p>callback function for third-party interfaces</p>
</td></tr>
<tr><td><code id="nWayAOV_+3A_gibbs">gibbs</code></td>
<td>
<p>will be deprecated. See <code>posterior</code></p>
</td></tr>
<tr><td><code id="nWayAOV_+3A_posterior">posterior</code></td>
<td>
<p>if <code>TRUE</code>, return samples from the posterior using
Gibbs sampling, instead of the Bayes factor</p>
</td></tr>
<tr><td><code id="nWayAOV_+3A_ignorecols">ignoreCols</code></td>
<td>
<p>if <code>NULL</code> and <code>posterior=TRUE</code>, all parameter
estimates are returned in the MCMC object. If not <code>NULL</code>, a vector of
length P-1 (where P is number of columns in the design matrix) giving which
effect estimates to ignore in output</p>
</td></tr>
<tr><td><code id="nWayAOV_+3A_thin">thin</code></td>
<td>
<p>MCMC chain to every <code>thin</code> iterations. Default of 1 means
no thinning. Only used if <code>posterior=TRUE</code></p>
</td></tr>
<tr><td><code id="nWayAOV_+3A_method">method</code></td>
<td>
<p>the integration method (only valid if <code>posterior=FALSE</code>); one
of &quot;simple&quot;, &quot;importance&quot;, &quot;laplace&quot;, or &quot;auto&quot;</p>
</td></tr>
<tr><td><code id="nWayAOV_+3A_continuous">continuous</code></td>
<td>
<p>either FALSE if no continuous covariates are included, or
a logical vector of length equal to number of columns of X indicating
which columns of the design matrix represent continuous covariates</p>
</td></tr>
<tr><td><code id="nWayAOV_+3A_nosample">noSample</code></td>
<td>
<p>if <code>TRUE</code>, do not sample, instead returning NA. This is
intended to be used with functions generating and testing many models at one time,
such as <code><a href="#topic+anovaBF">anovaBF</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is not meant to be called by end-users, although
technically-minded users can call this function for flexibility beyond what
the other functions in this package provide. See <code><a href="#topic+lmBF">lmBF</a></code> for a
user-friendly front-end to this function. Details about the priors can be
found in the help for <code><a href="#topic+anovaBF">anovaBF</a></code> and the references therein.
</p>
<p>Argument <code>gMap</code> provides a way of grouping columns of
the design matrix as a factor; the effects in each group will share a common
<code class="reqn">g</code> parameter. <code>gMap</code> should be a vector of the same length as the number of
nonconstant rows in <code>X</code>. It will contain all integers from 0 to
<code class="reqn">N_g-1</code>, where <code class="reqn">N_g</code> is the total number of <code class="reqn">g</code>
parameters. Each element of <code>gMap</code> specifies the group to which that
column belongs.
</p>
<p>If all columns belonging to a group are adjacent, <code>struc</code> can instead
be used to compactly represent the groupings. <code>struc</code> is a vector of
length <code class="reqn">N_g</code>. Each element specifies the number columns in the
group.
</p>
<p>The vector <code>rscale</code> should be of length <code class="reqn">N_g</code>, and contain the
prior scales of the standardized effects. See Rouder et al. (2012) for more
details and the help for <code><a href="#topic+anovaBF">anovaBF</a></code> for some typical values.
</p>
<p>The method used to estimate the Bayes factor depends on the <code>method</code>
argument. &quot;simple&quot; is most accurate for small to moderate sample sizes, and
uses the Monte Carlo sampling method described in Rouder et al. (2012).
&quot;importance&quot; uses an importance sampling algorithm with an importance
distribution that is multivariate normal on log(g). &quot;laplace&quot; does not
sample, but uses a Laplace approximation to the integral. It is expected to
be more accurate for large sample sizes, where MC sampling is slow. If
<code>method="auto"</code>, then an initial run with both samplers is done, and
the sampling method that yields the least-variable samples is chosen. The
number of initial test iterations is determined by
<code>options(BFpretestIterations)</code>.
</p>
<p>If posterior samples are requested, the posterior is sampled with a Gibbs
sampler.
</p>


<h3>Value</h3>

<p>If <code>posterior</code> is <code>FALSE</code>, a vector of length 2 containing
the computed log(e) Bayes factor (against the intercept-only null), along
with a proportional error estimate on the Bayes factor. Otherwise, an
object of class <code>mcmc</code>, containing MCMC samples from the posterior is
returned.
</p>


<h3>Note</h3>

<p>Argument <code>struc</code> has been deprecated. Use <code>gMap</code>, which is the <code><a href="base.html#topic+inverse.rle">inverse.rle</a></code> of <code>struc</code>,
minus 1.
</p>


<h3>Author(s)</h3>

<p>Richard D. Morey (<a href="mailto:richarddmorey@gmail.com">richarddmorey@gmail.com</a>), Jeffery N.
Rouder (<a href="mailto:rouderj@missouri.edu">rouderj@missouri.edu</a>)
</p>


<h3>References</h3>

<p>Rouder, J. N., Morey, R. D., Speckman, P. L., Province, J. M.,
(2012) Default Bayes Factors for ANOVA Designs. Journal of Mathematical
Psychology.  56.  p. 356-374.
</p>


<h3>See Also</h3>

<p>See <code><a href="#topic+lmBF">lmBF</a></code> for the user-friendly front end to this
function; see <code><a href="#topic+regressionBF">regressionBF</a></code> and <code>anovaBF</code> for testing
many regression or ANOVA models simultaneously.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Classical example, taken from t.test() example
## Student's sleep data
data(sleep)
plot(extra ~ group, data = sleep)

## traditional ANOVA gives a p value of 0.00283
summary(aov(extra ~ group + Error(ID/group), data = sleep))

## Build design matrix
group.column &lt;- rep(1/c(-sqrt(2),sqrt(2)),each=10)
subject.matrix &lt;- model.matrix(~sleep$ID - 1,data=sleep$ID)
## Note that we include no constant column
X &lt;- cbind(group.column, subject.matrix)

## (log) Bayes factor of full model against grand-mean only model
bf.full &lt;- nWayAOV(y = sleep$extra, X = X, gMap = c(0,rep(1,10)), rscale=c(.5,1))
exp(bf.full[['bf']])

## Compare with lmBF result (should be about the same, give or take 1%)
bf.full2 &lt;- lmBF(extra ~ group + ID, data = sleep, whichRandom = "ID")
bf.full2
</code></pre>

<hr>
<h2 id='oneWayAOV.Fstat'>Use F statistic to compute Bayes factor for balanced one-way designs</h2><span id='topic+oneWayAOV.Fstat'></span>

<h3>Description</h3>

<p>Using the classical F test statistic for a balanced one-way design, this function computes the corresponding Bayes factor test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>oneWayAOV.Fstat(F, N, J, rscale = "medium", simple = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="oneWayAOV.Fstat_+3A_f">F</code></td>
<td>
<p>F statistic from classical ANOVA</p>
</td></tr>
<tr><td><code id="oneWayAOV.Fstat_+3A_n">N</code></td>
<td>
<p>number of observations per cell or group</p>
</td></tr>
<tr><td><code id="oneWayAOV.Fstat_+3A_j">J</code></td>
<td>
<p>number of cells or groups</p>
</td></tr>
<tr><td><code id="oneWayAOV.Fstat_+3A_rscale">rscale</code></td>
<td>
<p>numeric prior scale</p>
</td></tr>
<tr><td><code id="oneWayAOV.Fstat_+3A_simple">simple</code></td>
<td>
<p>if <code>TRUE</code>, return only the Bayes factor</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For F statistics computed from balanced one-way designs, this function can
be used to compute the Bayes factor testing the model that all group means
are not equal to the grand mean, versus the null model that all group means
are equal. It can be used when you don't have access to the full data set
for analysis by <code><a href="#topic+lmBF">lmBF</a></code>, but you do have the test statistic.
</p>
<p>For details about the model, see the help for <code><a href="#topic+anovaBF">anovaBF</a></code>, and the references therein.
</p>
<p>The Bayes factor is computed via Gaussian quadrature.
</p>


<h3>Value</h3>

<p>If <code>simple</code> is <code>TRUE</code>, returns the Bayes factor (against the 
intercept-only null). If <code>FALSE</code>, the function returns a 
vector of length 3 containing the computed log(e) Bayes factor,
along with a proportional error estimate on the Bayes factor and the method used to compute it.
</p>


<h3>Note</h3>

<p><code>oneWayAOV.Fstat</code> should only be used with F values obtained from
balanced designs.
</p>


<h3>Author(s)</h3>

<p>Richard D. Morey (<a href="mailto:richarddmorey@gmail.com">richarddmorey@gmail.com</a>)
</p>


<h3>References</h3>

<p>Morey, R. D., Rouder, J. N., Pratte, M. S., and Speckman, P. L.
(2011). Using MCMC chain outputs to efficiently estimate Bayes factors.
Journal of Mathematical Psychology, 55, 368-378
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+integrate">integrate</a></code>, <code><a href="stats.html#topic+aov">aov</a></code>; see <code><a href="#topic+lmBF">lmBF</a></code> for the intended interface to this function, using the full data set.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Example data "InsectSprays" - see ?InsectSprays
require(stats); require(graphics)
boxplot(count ~ spray, data = InsectSprays, xlab = "Type of spray", 
        ylab = "Insect count", main = "InsectSprays data", varwidth = TRUE, 
        col = "lightgray")

## Classical analysis (with transformation)
classical &lt;- aov(sqrt(count) ~ spray, data = InsectSprays)
plot(classical)
summary(classical)

## Bayes factor (a very large number)
Fvalue &lt;- anova(classical)$"F value"[1]
result &lt;- oneWayAOV.Fstat(Fvalue, N=12, J=6)
exp(result[['bf']])
</code></pre>

<hr>
<h2 id='options-BayesFactor'>options() for package BayesFactor</h2><span id='topic+options-BayesFactor'></span>

<h3>Description</h3>

<p>Options that can be set for the BayesFactor package
</p>


<h3>Details</h3>

<p>The BayesFactor package has numerous options that can be set to globally 
change the behavior of the functions in the package. These options can be
changed using <code><a href="base.html#topic+options">options</a></code>().
</p>

<dl>
<dt><code>BFMaxModels</code></dt><dd><p>Integer; maximum number of models to analyze in <code><a href="#topic+anovaBF">anovaBF</a></code> or <code><a href="#topic+regressionBF">regressionBF</a></code></p>
</dd> 
<dt><code>BFprogress</code></dt><dd><p>If <code>TRUE</code>, progress bars are on by default; if <code>FALSE</code>, they are disabled by default.</p>
</dd>
<dt><code>BFpretestIterations</code></dt><dd><p>Integer; if sampling is needed to compute the Bayes factor, the package attempts to 
choose the most efficient sampler. This option controls the number of initial test iterations.</p>
</dd>
<dt><code>BFapproxOptimizer</code></dt><dd><p><code>"nlm"</code> or <code>"optim"</code>; changes the optimization function used for the importance sampler. If one fails, try the other.</p>
</dd>
<dt><code>BFapproxLimits</code></dt><dd><p>Vector of length two containing the lower and upper limits on 
on <code>log(g)</code> before the the posterior returns <code>-Inf</code>. This only affects the initial optimization step for the importance sampler.</p>
</dd>
<dt><code>BFfactorsMax</code></dt><dd><p>Maximum number of factors to try to do enumeration with in generalTestBF.</p>
</dd>
<dt><code>BFcheckProbabilityList</code></dt><dd><p>Check for duplicate models when creating BFprobability objects?</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="base.html#topic+options">options</a></code>
</p>

<hr>
<h2 id='plot.BFBayesFactor'>Plot a Bayes factor object</h2><span id='topic+plot.BFBayesFactor'></span>

<h3>Description</h3>

<p>Plot a Bayes factor object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'BFBayesFactor'
plot(
  x,
  include1 = TRUE,
  addDenom = FALSE,
  sortbf = TRUE,
  logbase = c("log10", "log2", "ln"),
  marginExpand = 0.4,
  cols = c("wheat", "lightslateblue"),
  main = paste("vs.", x@denominator@longName),
  pars = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.BFBayesFactor_+3A_x">x</code></td>
<td>
<p>a BFBayesFactor object</p>
</td></tr>
<tr><td><code id="plot.BFBayesFactor_+3A_include1">include1</code></td>
<td>
<p>if <code>TRUE</code>, ensure that Bayes factor = 1 is on the plot</p>
</td></tr>
<tr><td><code id="plot.BFBayesFactor_+3A_adddenom">addDenom</code></td>
<td>
<p>if <code>TRUE</code>, add the denominator model into the group</p>
</td></tr>
<tr><td><code id="plot.BFBayesFactor_+3A_sortbf">sortbf</code></td>
<td>
<p>sort the Bayes factors before plotting them? Defaults to
<code>TRUE</code></p>
</td></tr>
<tr><td><code id="plot.BFBayesFactor_+3A_logbase">logbase</code></td>
<td>
<p>the base of the log Bayes factors in the plot</p>
</td></tr>
<tr><td><code id="plot.BFBayesFactor_+3A_marginexpand">marginExpand</code></td>
<td>
<p>an expansion factor for the left margin, in case more
space is needed for model names</p>
</td></tr>
<tr><td><code id="plot.BFBayesFactor_+3A_cols">cols</code></td>
<td>
<p>a vector of length two of valid color names or numbers</p>
</td></tr>
<tr><td><code id="plot.BFBayesFactor_+3A_main">main</code></td>
<td>
<p>a character vector for the plot title</p>
</td></tr>
<tr><td><code id="plot.BFBayesFactor_+3A_pars">pars</code></td>
<td>
<p>a list of par() settings</p>
</td></tr>
<tr><td><code id="plot.BFBayesFactor_+3A_...">...</code></td>
<td>
<p>additional arguments to pass to barplot()</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function creates a barplot of the (log) Bayes factors in a Bayes factor
object. Error bars are added (though in many cases they may be too small to
see) in red to show the error in estimation of the Bayes factor. If a red question mark
appears next to a bar, then that Bayes factor has no error estimate available.
</p>


<h3>Author(s)</h3>

<p>Richard D. Morey (<a href="mailto:richarddmorey@gmail.com">richarddmorey@gmail.com</a>)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(puzzles)

bfs = anovaBF(RT ~ shape*color + ID, data = puzzles, whichRandom="ID", progress=FALSE)
plot(bfs)
</code></pre>

<hr>
<h2 id='plot.BFBayesFactorTop'>Plot a Bayes factor top-down object</h2><span id='topic+plot.BFBayesFactorTop'></span>

<h3>Description</h3>

<p>Plot a Bayes factor top-down object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'BFBayesFactorTop'
plot(
  x,
  include1 = TRUE,
  addDenom = FALSE,
  sortbf = FALSE,
  logbase = c("log10", "log2", "ln"),
  marginExpand = 0.4,
  pars = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.BFBayesFactorTop_+3A_x">x</code></td>
<td>
<p>a BFBayesFactorTop object</p>
</td></tr>
<tr><td><code id="plot.BFBayesFactorTop_+3A_include1">include1</code></td>
<td>
<p>if <code>TRUE</code>, ensure that Bayes factor = 1 is on the plot</p>
</td></tr>
<tr><td><code id="plot.BFBayesFactorTop_+3A_adddenom">addDenom</code></td>
<td>
<p>if <code>TRUE</code>, add the denominator model into the group</p>
</td></tr>
<tr><td><code id="plot.BFBayesFactorTop_+3A_sortbf">sortbf</code></td>
<td>
<p>sort the Bayes factors before plotting them? Defaults to
<code>TRUE</code></p>
</td></tr>
<tr><td><code id="plot.BFBayesFactorTop_+3A_logbase">logbase</code></td>
<td>
<p>the base of the log Bayes factors in the plot</p>
</td></tr>
<tr><td><code id="plot.BFBayesFactorTop_+3A_marginexpand">marginExpand</code></td>
<td>
<p>an expansion factor for the left margin, in case more
space is needed for model names</p>
</td></tr>
<tr><td><code id="plot.BFBayesFactorTop_+3A_pars">pars</code></td>
<td>
<p>a list of par() settings</p>
</td></tr>
<tr><td><code id="plot.BFBayesFactorTop_+3A_...">...</code></td>
<td>
<p>additional arguments to pass to barplot()</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function creates a barplot of the (log) Bayes factors in a Bayes factor
object. Error bars are added (though in many cases they may be too small to
see) in red to show the error in estimation of the Bayes factor. If a red question mark
appears next to a bar, then that Bayes factor has no error estimate available.
</p>


<h3>Author(s)</h3>

<p>Richard D. Morey (<a href="mailto:richarddmorey@gmail.com">richarddmorey@gmail.com</a>)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(puzzles)

bfs = anovaBF(RT ~ shape*color + ID, data = puzzles, whichRandom="ID",
        whichModels='top', progress=FALSE)
plot(bfs)
</code></pre>

<hr>
<h2 id='posterior'>Sample from the posterior distribution of one of several models.</h2><span id='topic+posterior'></span><span id='topic+posterior+2CBFmodel+2Cmissing+2Cdata.frame+2Cmissing-method'></span><span id='topic+posterior+2CBFBayesFactor+2Cmissing+2Cmissing+2Cmissing-method'></span><span id='topic+posterior+2CBFBayesFactor+2Cnumeric+2Cmissing+2Cnumeric-method'></span><span id='topic+posterior+2CBFBayesFactor+2Cmissing+2Cmissing+2Cnumeric-method'></span><span id='topic+posterior+2CBFlinearModel+2Cmissing+2Cdata.frame+2Cnumeric-method'></span><span id='topic+posterior+2CBFindepSample+2Cmissing+2Cdata.frame+2Cnumeric-method'></span><span id='topic+posterior+2CBFcontingencyTable+2Cmissing+2Cdata.frame+2Cnumeric-method'></span><span id='topic+posterior+2CBFoneSample+2Cmissing+2Cdata.frame+2Cnumeric-method'></span><span id='topic+posterior+2CBFmetat+2Cmissing+2Cdata.frame+2Cnumeric-method'></span><span id='topic+posterior+2CBFproportion+2Cmissing+2Cdata.frame+2Cnumeric-method'></span><span id='topic+posterior+2CBFcorrelation+2Cmissing+2Cdata.frame+2Cnumeric-method'></span>

<h3>Description</h3>

<p>This function samples from the posterior distribution of a <code>BFmodel</code>,
which can be obtained from a <code>BFBayesFactor</code> object. If there is more
than one numerator in the <code>BFBayesFactor</code> object, the <code>index</code>
argument can be passed to select one numerator.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>posterior(model, index, data, iterations, ...)

## S4 method for signature 'BFmodel,missing,data.frame,missing'
posterior(model, index, data, iterations, ...)

## S4 method for signature 'BFBayesFactor,missing,missing,missing'
posterior(model, index, data, iterations, ...)

## S4 method for signature 'BFBayesFactor,numeric,missing,numeric'
posterior(model, index, data, iterations, ...)

## S4 method for signature 'BFBayesFactor,missing,missing,numeric'
posterior(model, index = NULL, data, iterations, ...)

## S4 method for signature 'BFlinearModel,missing,data.frame,numeric'
posterior(model, index = NULL, data, iterations, ...)

## S4 method for signature 'BFindepSample,missing,data.frame,numeric'
posterior(model, index = NULL, data, iterations, ...)

## S4 method for signature 'BFcontingencyTable,missing,data.frame,numeric'
posterior(model, index = NULL, data, iterations, ...)

## S4 method for signature 'BFoneSample,missing,data.frame,numeric'
posterior(model, index = NULL, data, iterations, ...)

## S4 method for signature 'BFmetat,missing,data.frame,numeric'
posterior(model, index = NULL, data, iterations, ...)

## S4 method for signature 'BFproportion,missing,data.frame,numeric'
posterior(model, index = NULL, data, iterations, ...)

## S4 method for signature 'BFcorrelation,missing,data.frame,numeric'
posterior(model, index = NULL, data, iterations, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="posterior_+3A_model">model</code></td>
<td>
<p>or set of models from which to sample</p>
</td></tr>
<tr><td><code id="posterior_+3A_index">index</code></td>
<td>
<p>the index within the set of models giving the desired model</p>
</td></tr>
<tr><td><code id="posterior_+3A_data">data</code></td>
<td>
<p>the data to be conditioned on</p>
</td></tr>
<tr><td><code id="posterior_+3A_iterations">iterations</code></td>
<td>
<p>the number of iterations to sample</p>
</td></tr>
<tr><td><code id="posterior_+3A_...">...</code></td>
<td>
<p>arguments passed to and from related methods</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The data argument is used internally, and will y not be needed by
end-users.
</p>
<p>Note that if there are fixed effects in the model, the reduced
parameterzation used internally (see help for <code><a href="#topic+anovaBF">anovaBF</a></code>) is
unreduced. For a factor with two levels, the chain will contain two effect
estimates that sum to 0.
</p>
<p>Two useful arguments that can be passed to related methods are <code>thin</code>
and <code>columnFilter</code>, currently implemented for methods using
<code>nWayAOV</code> (models with more than one categorical covariate, or a mix of
categorical and continuous covariates). <code>thin</code>, an integer, will keep
only every <code>thin</code> iterations. The default is <code>thin=1</code>, which keeps
all iterations. Argument <code>columnFilter</code> is either <code>NULL</code> (for no
filtering) or a character vector of extended regular expressions (see
<a href="base.html#topic+regex">regex</a> help for details). Any column from an effect that matches one of
the filters will not be saved.
</p>


<h3>Value</h3>

<p>Returns an object containing samples from the posterior distribution
of the specified model
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Sample from the posteriors for two models
data(sleep)

bf = lmBF(extra ~ group + ID, data = sleep, whichRandom="ID", progress=FALSE)

## sample from the posterior of the numerator model
## data argument not needed - it is included in the Bayes factor object
chains = posterior(bf, iterations = 1000, progress = FALSE)

plot(chains)

## demonstrate column filtering by filtering out participant effects
data(puzzles)
bf = lmBF(RT ~ shape + color + shape:color + ID, data=puzzles)
chains = posterior(bf, iterations = 1000, progress = FALSE, columnFilter="^ID$")
colnames(chains) # Contains no participant effects
</code></pre>

<hr>
<h2 id='priorLogodds+26lt+3B-'>Set prior log odds in an object</h2><span id='topic+priorLogodds+3C-'></span><span id='topic+priorLogodds+3C-+2CBFodds+2Cnumeric-method'></span>

<h3>Description</h3>

<p>Set prior log odds in an object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>priorLogodds(object) &lt;- value

## S4 replacement method for signature 'BFodds,numeric'
priorLogodds(object) &lt;- value
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="priorLogodds+2B26lt+2B3B-_+3A_object">object</code></td>
<td>
<p>object in which to set log odds</p>
</td></tr>
<tr><td><code id="priorLogodds+2B26lt+2B3B-_+3A_value">value</code></td>
<td>
<p>log odds</p>
</td></tr>
</table>

<hr>
<h2 id='priorOdds+26lt+3B-'>Set prior odds in an object</h2><span id='topic+priorOdds+3C-'></span><span id='topic+priorOdds+3C-+2CBFodds+2Cnumeric-method'></span>

<h3>Description</h3>

<p>Set prior odds in an object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>priorOdds(object) &lt;- value

## S4 replacement method for signature 'BFodds,numeric'
priorOdds(object) &lt;- value
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="priorOdds+2B26lt+2B3B-_+3A_object">object</code></td>
<td>
<p>object in which to set odds</p>
</td></tr>
<tr><td><code id="priorOdds+2B26lt+2B3B-_+3A_value">value</code></td>
<td>
<p>odds</p>
</td></tr>
</table>

<hr>
<h2 id='proportionBF'>Function for Bayesian analysis of proportions</h2><span id='topic+proportionBF'></span>

<h3>Description</h3>

<p>Bayes factors or posterior samples for binomial, geometric, or neg. binomial data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>proportionBF(
  y,
  N,
  p,
  rscale = "medium",
  nullInterval = NULL,
  posterior = FALSE,
  callback = function(...) as.integer(0),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="proportionBF_+3A_y">y</code></td>
<td>
<p>a vector of successes</p>
</td></tr>
<tr><td><code id="proportionBF_+3A_n">N</code></td>
<td>
<p>a vector of total number of observations</p>
</td></tr>
<tr><td><code id="proportionBF_+3A_p">p</code></td>
<td>
<p>the null value for the probability of a success to be tested against</p>
</td></tr>
<tr><td><code id="proportionBF_+3A_rscale">rscale</code></td>
<td>
<p>prior scale.  A number of preset values can be given as
strings; see Details.</p>
</td></tr>
<tr><td><code id="proportionBF_+3A_nullinterval">nullInterval</code></td>
<td>
<p>optional vector of length 2 containing
lower and upper bounds of an interval hypothesis to test, in probability units</p>
</td></tr>
<tr><td><code id="proportionBF_+3A_posterior">posterior</code></td>
<td>
<p>if <code>TRUE</code>, return samples from the posterior instead
of Bayes factor</p>
</td></tr>
<tr><td><code id="proportionBF_+3A_callback">callback</code></td>
<td>
<p>callback function for third-party interfaces</p>
</td></tr>
<tr><td><code id="proportionBF_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to or from methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given count data modeled as a binomial, geometric, or negative binomial random variable,
the Bayes factor provided by <code>proportionBF</code> tests the null hypothesis that
the probability of a success is <code class="reqn">p_0</code> (argument <code>p</code>). Specifically,
the Bayes factor compares two hypotheses: that the probability is <code class="reqn">p_0</code>, or
probability is not <code class="reqn">p_0</code>. Currently, the default alternative is that
</p>
<p style="text-align: center;"><code class="reqn">\lambda~logistic(\lambda_0,r)</code>
</p>
<p> where
<code class="reqn">\lambda_0=logit(p_0)</code> and
<code class="reqn">\lambda=logit(p)</code>. <code class="reqn">r</code> serves as a prior scale parameter.
</p>
<p>For the <code>rscale</code> argument, several named values are recognized:
&quot;medium&quot;, &quot;wide&quot;, and &quot;ultrawide&quot;. These correspond
to <code class="reqn">r</code> scale values of <code class="reqn">1/2</code>, <code class="reqn">\sqrt{2}/2</code>, and 1,
respectively.
</p>
<p>The Bayes factor is computed via Gaussian quadrature, and posterior
samples are drawn via independence Metropolis-Hastings.
</p>


<h3>Value</h3>

<p>If <code>posterior</code> is <code>FALSE</code>, an object of class
<code>BFBayesFactor</code> containing the computed model comparisons is
returned. If <code>nullInterval</code> is defined, then two Bayes factors will
be computed: The Bayes factor for the interval against the null hypothesis
that the probability is <code class="reqn">p_0</code>, and the corresponding Bayes factor for
the compliment of the interval.
</p>
<p>If <code>posterior</code> is <code>TRUE</code>, an object of class <code>BFmcmc</code>,
containing MCMC samples from the posterior is returned.
</p>


<h3>Author(s)</h3>

<p>Richard D. Morey (<a href="mailto:richarddmorey@gmail.com">richarddmorey@gmail.com</a>)
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+prop.test">prop.test</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>bf = proportionBF(y = 15, N = 25, p = .5)
bf
## Sample from the corresponding posterior distribution
samples =proportionBF(y = 15, N = 25, p = .5, posterior = TRUE, iterations = 10000)
plot(samples[,"p"])
</code></pre>

<hr>
<h2 id='puzzles'>Puzzle completion times from Hays (1994)</h2><span id='topic+puzzles'></span>

<h3>Description</h3>

<p>Puzzle completion time example data from Hays (1994).
</p>


<h3>Format</h3>

<p>A data frame with 48 observations on 3 variables.  </p>

<dl>
<dt>RT</dt><dd><p>Puzzle completion time, in minutes</p>
</dd> <dt>ID</dt><dd><p>the
subject identifier</p>
</dd> <dt>shape</dt><dd><p>shape of the puzzle (round or
square)</p>
</dd> <dt>color</dt><dd><p>color content of the puzzle (monochromatic or
color)</p>
</dd> </dl>



<h3>Details</h3>

<p>Hays (1994; section 13.21, table 13.21.2, p. 570) describes a experiment
wherein 12 participants complete four puzzles each. Puzzles could be either
square or round, and either monochromatic or in color. Each participant
completed every combination of the two factors.
</p>


<h3>Source</h3>

<p>Hays, W. L. (1994), Statistics (5th edition), Harcourt Brace, Fort
Worth, Texas
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(puzzles)

## classical ANOVA
## Both color and shape are significant, interaction is not
classical &lt;- aov(RT ~ shape*color + Error(ID/(shape*color)), data=puzzles)
summary(classical)

## Bayes Factor
## Best model is main effects model, no interaction
anovaBF(RT ~ shape*color + ID, data = puzzles, whichRandom = "ID", progress=FALSE)


</code></pre>

<hr>
<h2 id='raceDolls'>Hraba and Grant (1970) children's doll preference data</h2><span id='topic+raceDolls'></span>

<h3>Description</h3>

<p>Hraba and Grant (1970) describe a replication of Clark and Clark (1947) in which
black and white children from Lincoln, Nebraska were shown dolls that were either black
or white. They were then asked a series of questions, including &quot;Give me the doll that is
a nice doll.&quot; This data set contains the frequency of children giving the same-race or different race doll in
response to this question.
</p>


<h3>Format</h3>

<p>A matrix with 2 rows and 2 columns. Rows give doll preference; colums give the
race of the child.
</p>


<h3>Source</h3>

<p>Hraba, J. and Grant, G. (1970). Black is Beautiful: A reexamination of
racial preference and identification. Journal of Personality and Social Psychology, 16, 398-402.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(raceDolls)

## chi-square test
## Barely significant with continuity correction
chisq.test(raceDolls)

## Bayes factor test (assuming independent binomial sampling plan)
## Very little evidence for the alternative of lack of independence
bf = contingencyTableBF(raceDolls, sampleType = "indepMulti", fixedMargin = "cols")
bf
</code></pre>

<hr>
<h2 id='recompute'>Recompute a Bayes factor computation or MCMC object.</h2><span id='topic+recompute'></span><span id='topic+recompute+2CBFBayesFactor-method'></span><span id='topic+recompute+2CBFBayesFactorTop-method'></span><span id='topic+recompute+2CBFmcmc-method'></span><span id='topic+recompute+2CBFodds-method'></span>

<h3>Description</h3>

<p>Take an object and redo the computation (useful for sampling). In cases where sampling is
used to compute the Bayes factor, the estimate of the precision of new samples will be added
to the estimate precision of the old sample will be added to produce a new estimate of the
precision.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>recompute(
  x,
  progress = getOption("BFprogress", interactive()),
  multicore = FALSE,
  callback = function(...) as.integer(0),
  ...
)

## S4 method for signature 'BFBayesFactor'
recompute(
  x,
  progress = getOption("BFprogress", interactive()),
  multicore = FALSE,
  callback = function(...) as.integer(0),
  ...
)

## S4 method for signature 'BFBayesFactorTop'
recompute(
  x,
  progress = getOption("BFprogress", interactive()),
  multicore = FALSE,
  callback = function(...) as.integer(0),
  ...
)

## S4 method for signature 'BFmcmc'
recompute(
  x,
  progress = getOption("BFprogress", interactive()),
  multicore = FALSE,
  callback = function(...) as.integer(0),
  ...
)

## S4 method for signature 'BFodds'
recompute(
  x,
  progress = getOption("BFprogress", interactive()),
  multicore = FALSE,
  callback = function(...) as.integer(0),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="recompute_+3A_x">x</code></td>
<td>
<p>object to recompute</p>
</td></tr>
<tr><td><code id="recompute_+3A_progress">progress</code></td>
<td>
<p>report progress of the computation?</p>
</td></tr>
<tr><td><code id="recompute_+3A_multicore">multicore</code></td>
<td>
<p>Use multicore, if available</p>
</td></tr>
<tr><td><code id="recompute_+3A_callback">callback</code></td>
<td>
<p>callback function for third-party interfaces</p>
</td></tr>
<tr><td><code id="recompute_+3A_...">...</code></td>
<td>
<p>arguments passed to and from related methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns an object of the same type, after repeating the sampling (perhaps with more iterations)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Sample from the posteriors for two models
data(puzzles)

## Main effects model; result is a BFmcmc object, inheriting
## mcmc from the coda package
bf = lmBF(RT ~ shape + color + ID, data = puzzles, whichRandom = "ID",
   progress = FALSE)

## recompute Bayes factor object
recompute(bf, iterations = 1000, progress = FALSE)

## Sample from posterior distribution of model above, and recompute:
chains = posterior(bf, iterations = 1000, progress = FALSE)
newChains = recompute(chains, iterations = 1000, progress=FALSE)
</code></pre>

<hr>
<h2 id='regressionBF'>Function to compute Bayes factors for regression designs</h2><span id='topic+regressionBF'></span>

<h3>Description</h3>

<p>This function simultaneously computes Bayes factors for groups of models in
regression designs
</p>


<h3>Usage</h3>

<pre><code class='language-R'>regressionBF(
  formula,
  data,
  whichModels = "all",
  progress = getOption("BFprogress", interactive()),
  rscaleCont = "medium",
  callback = function(...) as.integer(0),
  noSample = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="regressionBF_+3A_formula">formula</code></td>
<td>
<p>a formula containing all covariates to include in the
analysis (see Examples)</p>
</td></tr>
<tr><td><code id="regressionBF_+3A_data">data</code></td>
<td>
<p>a data frame containing data for all factors in the formula</p>
</td></tr>
<tr><td><code id="regressionBF_+3A_whichmodels">whichModels</code></td>
<td>
<p>which set of models to compare; see Details</p>
</td></tr>
<tr><td><code id="regressionBF_+3A_progress">progress</code></td>
<td>
<p>if <code>TRUE</code>, show progress with a text progress bar</p>
</td></tr>
<tr><td><code id="regressionBF_+3A_rscalecont">rscaleCont</code></td>
<td>
<p>prior scale on all standardized slopes</p>
</td></tr>
<tr><td><code id="regressionBF_+3A_callback">callback</code></td>
<td>
<p>callback function for third-party interfaces</p>
</td></tr>
<tr><td><code id="regressionBF_+3A_nosample">noSample</code></td>
<td>
<p>if <code>TRUE</code>, do not sample, instead returning NA.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>regressionBF</code> computes Bayes factors to test the hypothesis that
slopes are 0 against the alternative that all slopes are nonzero.
</p>
<p>The vector of observations <code class="reqn">y</code> is assumed to be distributed as </p>
<p style="text-align: center;"><code class="reqn">y ~
Normal(\alpha 1 + X\beta, \sigma^2 I).</code>
</p>
<p> The joint prior on
<code class="reqn">\alpha,\sigma^2</code> is proportional to <code class="reqn">1/\sigma^2</code>, the prior on
<code class="reqn">\beta</code> is </p>
<p style="text-align: center;"><code class="reqn">\beta ~ Normal(0, N g \sigma^2(X'X)^{-1}).</code>
</p>
<p> where
<code class="reqn">g ~ InverseGamma(1/2,r/2)</code>. See Liang et al. (2008) section 3 for
details.
</p>
<p>Possible values for <code>whichModels</code> are 'all', 'top', and 'bottom', where
'all' computes Bayes factors for all models, 'top' computes the Bayes
factors for models that have one covariate missing from the full model, and
'bottom' computes the Bayes factors for all models containing a single
covariate. Caution should be used when interpreting the results; when the
results of 'top' testing is interpreted as a test of each covariate, the
test is conditional on all other covariates being in the model (and likewise
'bottom' testing is conditional on no other covariates being in the model).
</p>
<p>An option is included to prevent analyzing too many models at once:
<code>options('BFMaxModels')</code>, which defaults to 50,000, is the maximum
number of models that 'regressionBF' will analyze at once. This can be
increased by increasing the option value.
</p>
<p>For the <code>rscaleCont</code> argument, several named values are recongized:
&quot;medium&quot;, &quot;wide&quot;, and &quot;ultrawide&quot;, which correspond <code class="reqn">r</code> scales of
<code class="reqn">\sqrt{2}/4</code>, 1/2, and <code class="reqn">\sqrt{2}/2</code>,
respectively. These values were chosen to yield consistent Bayes factors
with <code><a href="#topic+anovaBF">anovaBF</a></code>.
</p>


<h3>Value</h3>

<p>An object of class <code>BFBayesFactor</code>, containing the computed
model comparisons
</p>


<h3>Author(s)</h3>

<p>Richard D. Morey (<a href="mailto:richarddmorey@gmail.com">richarddmorey@gmail.com</a>)
</p>


<h3>References</h3>

<p>Liang, F. and Paulo, R. and Molina, G. and Clyde, M. A. and
Berger, J. O. (2008). Mixtures of g-priors for Bayesian Variable
Selection. Journal of the American Statistical Association, 103, pp.
410-423
</p>
<p>Rouder, J. N.  and Morey, R. D. (in press). Bayesian testing in
regression. Multivariate Behavioral Research.
</p>
<p>Zellner, A. and Siow, A., (1980) Posterior Odds Ratios for Selected
Regression Hypotheses.  In Bayesian Statistics: Proceedings of the First
Interanational Meeting held in Valencia (Spain).  Bernardo, J. M.,
Lindley, D. V., and Smith A. F. M. (eds), pp. 585-603.  University of
Valencia.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lmBF">lmBF</a></code>, for testing specific models, and
<code><a href="#topic+anovaBF">anovaBF</a></code> for the function similar to <code>regressionBF</code> for
ANOVA models.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## See help(attitude) for details about the data set
data(attitude)

## Classical regression
summary(fm1 &lt;- lm(rating ~ ., data = attitude))

## Compute Bayes factors for all regression models
output = regressionBF(rating ~ ., data = attitude, progress=FALSE)
head(output)
## Best model is 'complaints' only

## Compute all Bayes factors against the full model, and
## look again at best models
head(output / output[63])

</code></pre>

<hr>
<h2 id='ttest.tstat'>Use t statistic to compute Bayes factor for one- and two- sample designs</h2><span id='topic+ttest.tstat'></span>

<h3>Description</h3>

<p>Using the classical t test statistic for a one- or two-sample design, this
function computes the corresponding Bayes factor test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ttest.tstat(
  t,
  n1,
  n2 = 0,
  nullInterval = NULL,
  rscale = "medium",
  complement = FALSE,
  simple = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ttest.tstat_+3A_t">t</code></td>
<td>
<p>classical t statistic</p>
</td></tr>
<tr><td><code id="ttest.tstat_+3A_n1">n1</code></td>
<td>
<p>size of first group (or only group, for one-sample tests)</p>
</td></tr>
<tr><td><code id="ttest.tstat_+3A_n2">n2</code></td>
<td>
<p>size of second group, for independent-groups tests</p>
</td></tr>
<tr><td><code id="ttest.tstat_+3A_nullinterval">nullInterval</code></td>
<td>
<p>optional vector of length 2 containing lower and upper bounds of an interval hypothesis to test, in standardized units</p>
</td></tr>
<tr><td><code id="ttest.tstat_+3A_rscale">rscale</code></td>
<td>
<p>numeric prior scale</p>
</td></tr>
<tr><td><code id="ttest.tstat_+3A_complement">complement</code></td>
<td>
<p>if <code>TRUE</code>, compute the Bayes factor against the complement of the interval</p>
</td></tr>
<tr><td><code id="ttest.tstat_+3A_simple">simple</code></td>
<td>
<p>if <code>TRUE</code>, return only the Bayes factor</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function can be used to compute the Bayes factor corresponding to a
one-sample, a paired-sample, or an independent-groups t test, using the
classical t statistic.  It can be used when you don't have access to the
full data set for analysis by <code><a href="#topic+ttestBF">ttestBF</a></code>, but you do have the
test statistic.
</p>
<p>For details about the model, see the help for <code><a href="#topic+ttestBF">ttestBF</a></code>, and the
references therein.
</p>
<p>The Bayes factor is computed via Gaussian quadrature.
</p>


<h3>Value</h3>

<p>If <code>simple</code> is <code>TRUE</code>, returns the Bayes factor (against the
null). If <code>FALSE</code>, the function returns a
vector of length 3 containing the computed log(e) Bayes factor,
along with a proportional error estimate on the Bayes factor and the method used to compute it.
</p>


<h3>Note</h3>

<p>In version 0.9.9, the behaviour of this function has changed in order to produce more uniform results. In
version 0.9.8 and before, this function returned two Bayes factors when <code>nullInterval</code> was
non-<code>NULL</code>: the Bayes factor for the interval versus the null, and the Bayes factor for the complement of
the interval versus the null. Starting in version 0.9.9, in order to get the Bayes factor for the complement, it is required to
set the <code>complement</code> argument to <code>TRUE</code>, and the function only returns one Bayes factor.
</p>


<h3>Author(s)</h3>

<p>Richard D. Morey (<a href="mailto:richarddmorey@gmail.com">richarddmorey@gmail.com</a>) and Jeffrey N.
Rouder (<a href="mailto:rouderj@missouri.edu">rouderj@missouri.edu</a>)
</p>


<h3>References</h3>

<p>Morey, R. D. &amp; Rouder, J. N. (2011). Bayes Factor Approaches for
Testing Interval Null Hypotheses. Psychological Methods, 16, 406-419
</p>
<p>Rouder, J. N., Speckman, P. L., Sun, D., Morey, R. D., &amp; Iverson, G.
(2009). Bayesian t-tests for accepting and rejecting the null hypothesis.
Psychonomic Bulletin &amp; Review, 16, 225-237
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+integrate">integrate</a></code>, <code><a href="stats.html#topic+t.test">t.test</a></code>; see
<code><a href="#topic+ttestBF">ttestBF</a></code> for the intended interface to this function, using
the full data set.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Classical example: Student's sleep data
data(sleep)
plot(extra ~ group, data = sleep)

## t.test() gives a t value of -4.0621
t.test(sleep$extra[1:10], sleep$extra[11:20], paired=TRUE)
## Gives a Bayes factor of about 15
## in favor of the alternative hypothesis
result &lt;- ttest.tstat(t = -4.0621, n1 = 10)
exp(result[['bf']])
</code></pre>

<hr>
<h2 id='ttestBF'>Function for Bayesian analysis of one- and two-sample designs</h2><span id='topic+ttestBF'></span>

<h3>Description</h3>

<p>This function computes Bayes factors, or samples from the posterior, for
one- and two-sample designs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ttestBF(
  x = NULL,
  y = NULL,
  formula = NULL,
  mu = 0,
  nullInterval = NULL,
  paired = FALSE,
  data = NULL,
  rscale = "medium",
  posterior = FALSE,
  callback = function(...) as.integer(0),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ttestBF_+3A_x">x</code></td>
<td>
<p>a vector of observations for the first (or only) group</p>
</td></tr>
<tr><td><code id="ttestBF_+3A_y">y</code></td>
<td>
<p>a vector of observations for the second group (or condition, for
paired)</p>
</td></tr>
<tr><td><code id="ttestBF_+3A_formula">formula</code></td>
<td>
<p>for independent-group designs, a (optional) formula
describing the model</p>
</td></tr>
<tr><td><code id="ttestBF_+3A_mu">mu</code></td>
<td>
<p>for one-sample and paired designs, the null value of the mean (or
mean difference)</p>
</td></tr>
<tr><td><code id="ttestBF_+3A_nullinterval">nullInterval</code></td>
<td>
<p>optional vector of length 2 containing lower and upper bounds of an interval hypothesis to test, in standardized units</p>
</td></tr>
<tr><td><code id="ttestBF_+3A_paired">paired</code></td>
<td>
<p>if <code>TRUE</code>, observations are paired</p>
</td></tr>
<tr><td><code id="ttestBF_+3A_data">data</code></td>
<td>
<p>for use with <code>formula</code>, a data frame containing all the
data</p>
</td></tr>
<tr><td><code id="ttestBF_+3A_rscale">rscale</code></td>
<td>
<p>prior scale.  A number of preset values can be given as
strings; see Details.</p>
</td></tr>
<tr><td><code id="ttestBF_+3A_posterior">posterior</code></td>
<td>
<p>if <code>TRUE</code>, return samples from the posterior instead
of Bayes factor</p>
</td></tr>
<tr><td><code id="ttestBF_+3A_callback">callback</code></td>
<td>
<p>callback function for third-party interfaces</p>
</td></tr>
<tr><td><code id="ttestBF_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to or from methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Bayes factor provided by <code>ttestBF</code> tests the null hypothesis that
the mean (or mean difference) of a normal population is <code class="reqn">\mu_0</code>
(argument <code>mu</code>). Specifically, the Bayes factor compares two
hypotheses: that the standardized effect size is 0, or that the standardized
effect size is not 0. For one-sample tests, the standardized effect size is
<code class="reqn">(\mu-\mu_0)/\sigma</code>; for two sample tests, the
standardized effect size is <code class="reqn">(\mu_2-\mu_1)/\sigma</code>.
</p>
<p>A noninformative Jeffreys prior is placed on the variance of the normal
population, while a Cauchy prior is placed on the standardized effect size.
The <code>rscale</code> argument controls the scale of the prior distribution,
with <code>rscale=1</code> yielding a standard Cauchy prior. See the references
below for more details.
</p>
<p>For the <code>rscale</code> argument, several named values are recognized:
&quot;medium&quot;, &quot;wide&quot;, and &quot;ultrawide&quot;. These correspond
to <code class="reqn">r</code> scale values of <code class="reqn">\sqrt{2}/2</code>, 1, and <code class="reqn">\sqrt{2}</code>
respectively.
</p>
<p>The Bayes factor is computed via Gaussian quadrature.
</p>


<h3>Value</h3>

<p>If <code>posterior</code> is <code>FALSE</code>, an object of class
<code>BFBayesFactor</code> containing the computed model comparisons is
returned. If <code>nullInterval</code> is defined, then two Bayes factors will
be computed: The Bayes factor for the interval against the null hypothesis
that the standardized effect is 0, and the corresponding Bayes factor for
the compliment of the interval.
</p>
<p>If <code>posterior</code> is <code>TRUE</code>, an object of class <code>BFmcmc</code>,
containing MCMC samples from the posterior is returned.
</p>


<h3>Note</h3>

<p>The default priors have changed from 1 to <code class="reqn">\sqrt{2}/2</code>. The
factor of <code class="reqn">\sqrt{2}</code>  is to be consistent
with Morey et al. (2011) and
Rouder et al. (2012), and the factor of <code class="reqn">1/2</code> in both is to better scale the
expected effect sizes; the previous scaling put more weight on larger
effect sizes. To obtain the same Bayes factors as Rouder et al. (2009),
change the prior scale to 1.
</p>


<h3>Author(s)</h3>

<p>Richard D. Morey (<a href="mailto:richarddmorey@gmail.com">richarddmorey@gmail.com</a>)
</p>


<h3>References</h3>

<p>Morey, R. D., Rouder, J. N., Pratte, M. S., &amp; Speckman, P. L.
(2011). Using MCMC chain outputs to efficiently estimate Bayes factors.
Journal of Mathematical Psychology, 55, 368-378
</p>
<p>Morey, R. D. &amp; Rouder, J. N. (2011). Bayes Factor Approaches for Testing
Interval Null Hypotheses. Psychological Methods, 16, 406-419
</p>
<p>Rouder, J. N., Speckman, P. L., Sun, D., Morey, R. D., &amp; Iverson, G.
(2009). Bayesian t-tests for accepting and rejecting the null hypothesis.
Psychonomic Bulletin &amp; Review, 16, 225-237
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+integrate">integrate</a></code>, <code><a href="stats.html#topic+t.test">t.test</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Sleep data from t test example
data(sleep)
plot(extra ~ group, data = sleep)

## paired t test
ttestBF(x = sleep$extra[sleep$group==1], y = sleep$extra[sleep$group==2], paired=TRUE)

## Sample from the corresponding posterior distribution
samples = ttestBF(x = sleep$extra[sleep$group==1],
           y = sleep$extra[sleep$group==2], paired=TRUE,
           posterior = TRUE, iterations = 1000)
plot(samples[,"mu"])
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
