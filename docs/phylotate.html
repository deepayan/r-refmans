<!DOCTYPE html><html><head><title>Help for package phylotate</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {phylotate}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#finches'><p>NEXUS data example</p></a></li>
<li><a href='#mb_attrs'><p>Parse MrBayes-supplied attributes from a NEXUS file</p></a></li>
<li><a href='#parse_annotated'><p>Parse an annotated phylogenetic tree</p></a></li>
<li><a href='#phylotate-package'><p>Phylogenies with Annotations</p></a></li>
<li><a href='#print_annotated'><p>Serialize an annotated phylogenetic tree</p></a></li>
<li><a href='#read_annotated'><p>Read an annotated phylogenetic tree</p></a></li>
<li><a href='#write_annotated'><p>Write an annotated phylogenetic tree to a file</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Phylogenies with Annotations</td>
</tr>
<tr>
<td>Version:</td>
<td>1.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-06-29</td>
</tr>
<tr>
<td>Author:</td>
<td>Daniel Beer [aut], Anusha Beer [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Daniel Beer &lt;dlbeer@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions to read and write APE-compatible phylogenetic
  trees in NEXUS and Newick formats, while preserving annotations.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>ape</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Collate:</td>
<td>'utility.R' 'tokenize.R' 'newick.R' 'nexus.R' 'format.R'
'mbattrs.R'</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-06-29 00:42:39 UTC; dlbeer</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-06-29 21:00:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='finches'>NEXUS data example</h2><span id='topic+finches'></span>

<h3>Description</h3>

<p>A simple tree generated by MrBayes using the sequences for Darwin's
finches from the example distributed with BEAST.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(finches)</code></pre>

<hr>
<h2 id='mb_attrs'>Parse MrBayes-supplied attributes from a NEXUS file</h2><span id='topic+mb_attrs'></span>

<h3>Description</h3>

<p>This function takes a tree object and produces a dataframe containing
attributes attached to each node by MrBayes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mb_attrs(tree)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mb_attrs_+3A_tree">tree</code></td>
<td>
<p>an object of type <code>"phylo"</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The returned dataframe contains one row per node, and one column per
attribute. The attributes parsed are <code>prob</code>, <code>prob_stddev</code>,
<code>length_mean</code>, <code>length_median</code>, <code>length_95_HPD_low</code>,
and <code>length_95_HPD_high</code>.
</p>
<p>Attributes which are derivable from the others are not parsed (for example,
the <code>prob_percent</code> attribute is not parsed, since it's <code>prob</code>
times 100.
</p>


<h3>Value</h3>

<p>A dataframe of attributes.
</p>


<h3>Author(s)</h3>

<p>Anusha Beer <a href="mailto:anbeer29@gmail.com">anbeer29@gmail.com</a></p>


<h3>See Also</h3>

<p><code><a href="#topic+parse_annotated">parse_annotated</a></code>,
<code><a href="#topic+read_annotated">read_annotated</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  # Parse the example data included with this package
  data(finches)
  t &lt;- parse_annotated(finches, format="nexus")

  # Obtain a table of MrBayes attributes for each node
  attrs &lt;- mb_attrs(t)
</code></pre>

<hr>
<h2 id='parse_annotated'>Parse an annotated phylogenetic tree</h2><span id='topic+parse_annotated'></span>

<h3>Description</h3>

<p>This function takes the given text string, containing data in either
NEXUS or Newick format, and returns annotated phylogenetic trees.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>parse_annotated(str, format="nexus")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="parse_annotated_+3A_str">str</code></td>
<td>
<p>a text string, containing tree data</p>
</td></tr>
<tr><td><code id="parse_annotated_+3A_format">format</code></td>
<td>
<p>a format specifier; either <code>"nexus"</code> or <code>"newick"</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The given file text is parsed and a tree object is constructed which
can be used with the functions in the <span class="pkg">ape</span> package. Annotations
of the kind produced by, for example, MrBayes, are parsed and
preserved in the returned object.
</p>
<p>In addition to <code>edge</code>, <code>edge.length</code> and <code>tip.label</code>,
two additional vectors are added. These are <code>node.comment</code> and
<code>node.distance.comment</code>. These contain annotations associated
with nodes and their distance values. These arrays are indexed by node
number, not by edge. The reason for this is that this ensures that the
object will remain in a valid state after a call to <code>reorder</code>
which might change the ordering of the edge arrays without being aware
of annotations. If you need to obtain annotations in edge-order,
subset by the second column of the <code>edge</code> array.
</p>


<h3>Value</h3>

<p>an object of type <code>"phylo"</code> or <code>"multiPhylo"</code>, augmented with
node annotations.
</p>


<h3>Author(s)</h3>

<p>Daniel Beer <a href="mailto:dlbeer@gmail.com">dlbeer@gmail.com</a></p>


<h3>References</h3>

<p>Paradis, E. Definition of Formats for Coding Phylogenetic Trees in R.
<a href="http://ape-package.ird.fr/misc/FormatTreeR_24Oct2012.pdf">http://ape-package.ird.fr/misc/FormatTreeR_24Oct2012.pdf</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+print_annotated">print_annotated</a></code>,
<code><a href="#topic+read_annotated">read_annotated</a></code>,
<code><a href="#topic+write_annotated">write_annotated</a></code>,
<code><a href="#topic+finches">finches</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  # Parse the example data included with this package
  data(finches)
  t &lt;- parse_annotated(finches, format="nexus")

  # Obtain annotations in edge-order, rather than node-order
  edge.comment &lt;- t$node.comment[t$edge[,2]]
</code></pre>

<hr>
<h2 id='phylotate-package'>Phylogenies with Annotations</h2><span id='topic+phylotate-package'></span><span id='topic+phylotate'></span>

<h3>Description</h3>

<p><span class="pkg">phylotate</span> provides functions that allow you to read and write
NEXUS and Newick trees containing annotations, including those
produced by MrBayes.
</p>
<p>It does this by extending <span class="pkg">ape</span>'s <code>phylo</code> object type with
extra data members containing per-node annotation information. This
information is stored in such a way that it can be manipulated easily
and will survive most manipulations using standard <span class="pkg">ape</span> functions
(e.g. <code><a href="stats.html#topic+reorder">reorder</a></code>, <code>chronopl</code>).
</p>
<p>See the documentation for the <code><a href="#topic+parse_annotated">parse_annotated</a></code> function
for more information on how annotations are stored internally.
</p>
<p>The functions you probably want to use for most things are
<code><a href="#topic+read_annotated">read_annotated</a></code> and <code><a href="#topic+write_annotated">write_annotated</a></code>.
</p>


<h3>Author(s)</h3>

<p>Daniel Beer <a href="mailto:dlbeer@gmail.com">dlbeer@gmail.com</a>,
Anusha Beer <a href="mailto:anbeer29@gmail.com">anbeer29@gmail.com</a></p>

<hr>
<h2 id='print_annotated'>Serialize an annotated phylogenetic tree</h2><span id='topic+print_annotated'></span>

<h3>Description</h3>

<p>This function takes the given tree object and returns a string
representing the tree in the requested format. The difference between
the <code>"newick"</code> and <code>"newick.named"</code> formats is that the
former uses only node numbers in its output, whereas the latter uses
the tip labels (sanitized and deduplicated if necessary).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>print_annotated(tree, format="nexus")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print_annotated_+3A_tree">tree</code></td>
<td>
<p>a phylogentic tree, with optional annotations</p>
</td></tr>
<tr><td><code id="print_annotated_+3A_format">format</code></td>
<td>
<p>a format specifier; either <code>"nexus"</code>,
<code>"newick"</code>, or <code>"newick.named"</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The tree object should be either a <code>"phylo"</code> or
<code>"multiPhylo"</code> object. It may optionally be augmented with
annotations, as described in the documentation for the
<code><a href="#topic+parse_annotated">parse_annotated</a></code> function.
</p>
<p>The output is a string suitable for writing to a file.
</p>


<h3>Value</h3>

<p>a string containing a serialized tree.
</p>


<h3>Author(s)</h3>

<p>Daniel Beer <a href="mailto:dlbeer@gmail.com">dlbeer@gmail.com</a></p>


<h3>See Also</h3>

<p><code><a href="#topic+parse_annotated">parse_annotated</a></code>,
<code><a href="#topic+read_annotated">read_annotated</a></code>,
<code><a href="#topic+write_annotated">write_annotated</a></code>
</p>

<hr>
<h2 id='read_annotated'>Read an annotated phylogenetic tree</h2><span id='topic+read_annotated'></span>

<h3>Description</h3>

<p>This function takes the given file, containing data in either NEXUS or
Newick format, and returns annotated phylogenetic trees.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_annotated(filename, format="nexus")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read_annotated_+3A_filename">filename</code></td>
<td>
<p>a file to read tree data from</p>
</td></tr>
<tr><td><code id="read_annotated_+3A_format">format</code></td>
<td>
<p>a format specifier; either <code>"nexus"</code> or <code>"newick"</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The given file text is parsed and a tree object is constructed which
can be used with the functions in the <span class="pkg">ape</span> package. Annotations
of the kind produced by, for example, MrBayes, are parsed and
preserved in the returned object.
</p>
<p>See <code><a href="#topic+parse_annotated">parse_annotated</a></code> for more information about the
structure of the returned value.
</p>


<h3>Value</h3>

<p>an object of type <code>"phylo"</code> or <code>"multiPhylo"</code>, augmented with
node annotations.
</p>


<h3>Author(s)</h3>

<p>Daniel Beer <a href="mailto:dlbeer@gmail.com">dlbeer@gmail.com</a></p>


<h3>See Also</h3>

<p><code><a href="#topic+print_annotated">print_annotated</a></code>,
<code><a href="#topic+parse_annotated">parse_annotated</a></code>,
<code><a href="#topic+write_annotated">write_annotated</a></code>
</p>

<hr>
<h2 id='write_annotated'>Write an annotated phylogenetic tree to a file</h2><span id='topic+write_annotated'></span>

<h3>Description</h3>

<p>This function takes the given tree object and returns a string
representing the tree in the requested format. The difference between
the <code>"newick"</code> and <code>"newick.named"</code> formats is that the
former uses only node numbers in its output, whereas the latter uses
the tip labels (sanitized and deduplicated if necessary).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write_annotated(tree, filename, format="nexus")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="write_annotated_+3A_tree">tree</code></td>
<td>
<p>a phylogentic tree, with optional annotations</p>
</td></tr>
<tr><td><code id="write_annotated_+3A_filename">filename</code></td>
<td>
<p>a file to write no</p>
</td></tr>
<tr><td><code id="write_annotated_+3A_format">format</code></td>
<td>
<p>a format specifier; either <code>"nexus"</code>,
<code>"newick"</code>, or <code>"newick.named"</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The tree object should be either a <code>"phylo"</code> or
<code>"multiPhylo"</code> object. It may optionally be augmented with
annotations, as described in the documentation for the
<code><a href="#topic+parse_annotated">parse_annotated</a></code> function.
</p>


<h3>Author(s)</h3>

<p>Daniel Beer <a href="mailto:dlbeer@gmail.com">dlbeer@gmail.com</a></p>


<h3>See Also</h3>

<p><code><a href="#topic+parse_annotated">parse_annotated</a></code>,
<code><a href="#topic+print_annotated">print_annotated</a></code>,
<code><a href="#topic+read_annotated">read_annotated</a></code>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
