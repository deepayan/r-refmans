<!DOCTYPE html><html lang="en"><head><title>Help for package MetaStan</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {MetaStan}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#MetaStan-package'><p>The 'MetaStan' package.</p></a></li>
<li><a href='#compare_MBMA'><p>Compare MBMA fits using LOO-IC</p></a></li>
<li><a href='#convert_data_arm'><p>Convert contrast-based dataset to arm-based dataset (deprecated)</p></a></li>
<li><a href='#create_MetaStan_dat'><p>Prepare model-based meta-analysis dataset for Stan.</p></a></li>
<li><a href='#dat.Berkey1995'><p>Trials investigating effectiveness of the BCG vaccine against TB</p></a></li>
<li><a href='#dat.Boucher2016'><p>PARESTHESIA RATES WITH TOPIRAMATE IN MIGRAINE PROPHYLAXIS TRIALS</p></a></li>
<li><a href='#dat.Boucher2016.pairwise'><p>PARESTHESIA RATES WITH TOPIRAMATE IN MIGRAINE PROPHYLAXIS TRIALS</p></a></li>
<li><a href='#dat.Crins2014'><p>Pediatric liver transplant example data</p></a></li>
<li><a href='#dat.Eletriptan'><p>Migraine pain relief example (Eletriptan)</p></a></li>
<li><a href='#forest_plot'><p>Plot a forest plot</p></a></li>
<li><a href='#MBMA_stan'><p>Fitting a model-based meta-analysis model using Stan</p></a></li>
<li><a href='#meta_stan'><p>Fitting a meta-analysis model using Stan</p></a></li>
<li><a href='#plot.MBMA_stan'><p>Plot a dose-response plot</p></a></li>
<li><a href='#print.MBMA_stan'><p>Print MBMA object</p></a></li>
<li><a href='#print.meta_stan'><p>Print meta_stan object</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Title:</td>
<td>Bayesian Meta-Analysis via 'Stan'</td>
</tr>
<tr>
<td>Description:</td>
<td>Performs Bayesian meta-analysis, meta-regression and model-based meta-analysis 
             using 'Stan'. Includes binomial-normal hierarchical models and option to use 
             weakly informative priors for the heterogeneity parameter and the treatment effect 
             parameter which are described in Guenhan, Roever, and Friede (2020) &lt;<a href="https://doi.org/10.1002%2Fjrsm.1370">doi:10.1002/jrsm.1370</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-12-23</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>ByteCompile:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 0.12.17), methods, rstan (&ge; 2.18.1), rstantools (&ge;
1.5.0), loo (&ge; 2.0), forestplot (&ge; 1.6), metafor (&ge; 2.0-0),
HDInterval, coda</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, knitr, rmarkdown, ggplot2, shinystan, vdiffr</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>StanHeaders (&ge; 2.18.0), rstan (&ge; 2.18.1), BH (&ge;
1.66.0-1), Rcpp (&ge; 0.12.17), RcppEigen (&ge; 0.3.3.4.0),
RcppParallel (&ge; 5.0.1),</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>GNU make</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/gunhanb/MetaStan">https://github.com/gunhanb/MetaStan</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/gunhanb/MetaStan/issues">https://github.com/gunhanb/MetaStan/issues</a></td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-01-22 10:25:53 UTC; M305767</td>
</tr>
<tr>
<td>Author:</td>
<td>Burak Kuersad Guenhan
    <a href="https://orcid.org/0000-0002-7454-8680"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre],
  Christian Roever <a href="https://orcid.org/0000-0002-6911-698X"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Trustees of Columbia University [cph] (src/init.cpp, tools/make_cpp.R,
    R/stanmodels.R)</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Burak Kuersad Guenhan &lt;burakgunhan@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-01-22 12:22:46 UTC</td>
</tr>
</table>
<hr>
<h2 id='MetaStan-package'>The 'MetaStan' package.</h2><span id='topic+MetaStan-package'></span><span id='topic+MetaStan'></span>

<h3>Description</h3>

<p>Fitting Bayesian meta-analysis models via Rstan.
</p>


<h3>Details</h3>

<p>To fit meta-analysis models using frequentist methods, there are many R packages
available including 'metafor'. On the other hand, Bayesian estimation methods such as
Markov chain Monte Carlo (MCMC) are very attractive for meta-analysis, especially
because they can be used to fit more complicated models. These include binomial-normal
hierarchical models and beta-binomial models which are based on the exact distributional
assumptions unlike (commonly used) normal-normal hierarchical model. Another advantage of
Bayesian methods to be able to use informative prior distributions for example to
regularize heterogeneity estimates in case of low number of studies. Thus, we developed
'MetaStan' which uses Stan (a modern MCMC engine) to fit several pairwise meta-analysis
models including binomial-normal hierarchical model and beta-binomial model. This package is
also the accompanying package of Guenhan et al (2020). Another important functionality of the
package is the model-based meta-analysis models.
</p>


<h3>Author(s)</h3>

<p>Burak Kuersad Guenhan &lt;burak.gunhan@med.uni-goettingen.de&gt;
</p>


<h3>References</h3>

<p>Stan Development Team (2018). RStan: the R interface to Stan. R package version 2.17.3.
http://mc-stan.org
</p>
<p>Günhan, B and Röver, C and Friede, T (2020). Random-effects meta-analysis of few studies
involving rare events. Research Synthesis Methods. doi = 10.1002/jrsm.1370.
</p>

<hr>
<h2 id='compare_MBMA'>Compare MBMA fits using LOO-IC</h2><span id='topic+compare_MBMA'></span>

<h3>Description</h3>

<p>Takes a vector of <code>MBMA_stan</code> fits and give
the model comparison results based on LOO-IC criteria. This
is useful to compare different dose-response models. The function
depends on <code>loo_compare</code> function from <code>loo</code> package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compare_MBMA(model_list, digits = 2, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compare_MBMA_+3A_model_list">model_list</code></td>
<td>
<p>A vector of <code>MBMA_stan</code> object.</p>
</td></tr>
<tr><td><code id="compare_MBMA_+3A_digits">digits</code></td>
<td>
<p>An integer indicating the number of decimal places.</p>
</td></tr>
<tr><td><code id="compare_MBMA_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Vehtari, A, A Gelman, and J Gabry (Sept. 2017).
&quot;Practical Bayesian model evaluation using leave one-out
cross-validation and WAIC.&quot; In: Statistics and Computing 27.5, pp. 1413–1432.
</p>


<h3>See Also</h3>

<p><code>loo::loo_compare</code>
</p>

<hr>
<h2 id='convert_data_arm'>Convert contrast-based dataset to arm-based dataset (deprecated)</h2><span id='topic+convert_data_arm'></span>

<h3>Description</h3>

<p><code>convert_data_arm</code> creates a dataframe to fit a meta-analysis
model using <code>meta_Stan</code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>convert_data_arm(nt, nc, pt, pc, pub, data = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="convert_data_arm_+3A_nt">nt</code></td>
<td>
<p>Number of subjects in treatment arm</p>
</td></tr>
<tr><td><code id="convert_data_arm_+3A_nc">nc</code></td>
<td>
<p>Number of subjects in control arm</p>
</td></tr>
<tr><td><code id="convert_data_arm_+3A_pt">pt</code></td>
<td>
<p>Number of events in treatment arm</p>
</td></tr>
<tr><td><code id="convert_data_arm_+3A_pc">pc</code></td>
<td>
<p>Number of events in treatment arm</p>
</td></tr>
<tr><td><code id="convert_data_arm_+3A_pub">pub</code></td>
<td>
<p>The corresponding publication</p>
</td></tr>
<tr><td><code id="convert_data_arm_+3A_data">data</code></td>
<td>
<p>Optional data frame containing the variables given to the arguments above.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Create arm-based dataset
data('dat.Crins2014', package = "MetaStan")
dat_converted &lt;- convert_data_arm(exp.total, cont.total,
                                  exp.AR.events, cont.AR.events,
                                  publication, data = dat.Crins2014)


</code></pre>

<hr>
<h2 id='create_MetaStan_dat'>Prepare model-based meta-analysis dataset for Stan.</h2><span id='topic+create_MetaStan_dat'></span>

<h3>Description</h3>

<p><code>create_MetaStan_dat</code> converts datasets in the one-study-per-row
format to one-arm-per-row format,
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_MetaStan_dat(
  dat = NULL,
  armVars = c(dose = "d", responders = "r", sampleSize = "n"),
  nArmsVar = "nd"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="create_MetaStan_dat_+3A_dat">dat</code></td>
<td>
<p>Data in one-study-per-row format.</p>
</td></tr>
<tr><td><code id="create_MetaStan_dat_+3A_armvars">armVars</code></td>
<td>
<p>Vector of per-arm variables
The name of each component will be the column name in the resulting dataset.</p>
</td></tr>
<tr><td><code id="create_MetaStan_dat_+3A_narmsvar">nArmsVar</code></td>
<td>
<p>Variable holding the number of arms for each study.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The resulting data.frame can be used as data argument in <code>MBMA_stan</code>.
</p>


<h3>Value</h3>

<p>A data frame with the generated columns.
</p>


<h3>Author(s)</h3>

<p>Burak Kuersad Guenhan, <a href="mailto:burak.gunhan@med.uni-goettingen.de">burak.gunhan@med.uni-goettingen.de</a>
and Gert van Valkenhoef
</p>


<h3>See Also</h3>

<p><code>gemtc::mtc.data.studyrow</code> and <code>nmaINLA::create_INLA_dat</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data('dat.Eletriptan')
## Create the dataset suitable for MBMA_stan
EletriptanDat &lt;- create_MetaStan_dat(dat = dat.Eletriptan,
                                     armVars = c(dose = "d",
                                                 responders = "r",
                                                 sampleSize = "n"),
                                     nArmsVar = 'nd')
## Check that the data are correct
print(EletriptanDat)

## End(Not run)
</code></pre>

<hr>
<h2 id='dat.Berkey1995'>Trials investigating effectiveness of the BCG vaccine against TB</h2><span id='topic+dat.Berkey1995'></span>

<h3>Description</h3>

<p>A dataset containing the results from 13 trials examining the efficacy
of Bacillus Calmette-Guerin (BCG) vaccine against tuberculosis (TB).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dat.Berkey1995
</code></pre>


<h3>Format</h3>

<p>A data frame with following coloumns
</p>

<dl>
<dt>Trial</dt><dd><p>Trial number</p>
</dd>
<dt>r1</dt><dd><p>number of TB events in treatment arm</p>
</dd>
<dt>n1</dt><dd><p>number of subjects in treatment arm</p>
</dd>
<dt>r2</dt><dd><p>number of TB events in control arm</p>
</dd>
<dt>n2</dt><dd><p>number of subjects in control arm</p>
</dd>
<dt>Latitude</dt><dd><p>absolute latitude of the study location</p>
</dd>
<dt>publication</dt><dd><p>author and date</p>
</dd>
</dl>



<h3>Source</h3>

<p>Berkey, C.S., Hoaglin, D.C., Mosteller, F. and Colditz,
G.A., 1995. A random-effects regression model for meta-analysis.
Statistics in medicine, 14(4), pp.395-411
</p>

<hr>
<h2 id='dat.Boucher2016'>PARESTHESIA RATES WITH TOPIRAMATE IN MIGRAINE PROPHYLAXIS TRIALS</h2><span id='topic+dat.Boucher2016'></span>

<h3>Description</h3>

<p>Numbers of patients and events (paresthesia rates)
in experimental and control groups of 6 studies.
It is in one-study-per-row format.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dat.Boucher2016
</code></pre>


<h3>Format</h3>

<p>A data frame with following coloumns
</p>

<dl>
<dt>d1</dt><dd><p>dose (mg) in the first arm (placebo)</p>
</dd>
<dt>r1</dt><dd><p>number of events in the first arm (placebo)</p>
</dd>
<dt>n1</dt><dd><p>number of patients in the first arm (placebo)</p>
</dd>
<dt>d2</dt><dd><p>dose (mg) in the second arm </p>
</dd>
<dt>r2</dt><dd><p>number of events in the second arm</p>
</dd>
<dt>n2</dt><dd><p>number of patients in the second arm</p>
</dd>
<dt>d3</dt><dd><p>dose (mg) in the third arm</p>
</dd>
<dt>r3</dt><dd><p>number of events in the third arm</p>
</dd>
<dt>n3</dt><dd><p>number of patients in the third arm</p>
</dd>
<dt>d4</dt><dd><p>dose (mg) in the fourth arm</p>
</dd>
<dt>r4</dt><dd><p>number of events in the fourth arm</p>
</dd>
<dt>n4</dt><dd><p>number of patients in the fourth arm</p>
</dd>
<dt>nd</dt><dd><p>number of treatment arms</p>
</dd>
</dl>



<h3>Source</h3>

<p>Boucher M, and Bennets M. The Many Flavors of
Model-Based Meta-Analysis: Part I - Introduction and Landmark Data.
CPT Pharmacometrics Syst. Pharmacol. (2016) 5, 54-64; doi:10.1002/psp4.12041
</p>

<hr>
<h2 id='dat.Boucher2016.pairwise'>PARESTHESIA RATES WITH TOPIRAMATE IN MIGRAINE PROPHYLAXIS TRIALS</h2><span id='topic+dat.Boucher2016.pairwise'></span>

<h3>Description</h3>

<p>Numbers of patients and events (paresthesia rates)
in experimental and control groups of 6 studies.
It is in one-study-per-row format. Only the arm with 200 mg
is included.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dat.Boucher2016.pairwise
</code></pre>


<h3>Format</h3>

<p>A data frame with following coloumns
</p>

<dl>
<dt>study</dt><dd><p>Study ID</p>
</dd>
<dt>duration</dt><dd><p>Durtaion of the study</p>
</dd>
<dt>r1</dt><dd><p>number of events in the first arm (placebo)</p>
</dd>
<dt>n1</dt><dd><p>number of patients in the first arm (placebo)</p>
</dd>
<dt>r2</dt><dd><p>number of events in the second arm</p>
</dd>
<dt>n2</dt><dd><p>number of patients in the second arm</p>
</dd>
</dl>



<h3>Source</h3>

<p>Boucher M, and Bennets M. The Many Flavors of
Model-Based Meta-Analysis: Part I - Introduction and
Landmark Data.
CPT Pharmacometrics Syst. Pharmacol. (2016) 5, 54-64;
doi:10.1002/psp4.12041
</p>

<hr>
<h2 id='dat.Crins2014'>Pediatric liver transplant example data</h2><span id='topic+dat.Crins2014'></span>

<h3>Description</h3>

<p>Numbers of cases and events (PTLDs or deaths)
in experimental and control groups of six studies.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dat.Crins2014
</code></pre>


<h3>Format</h3>

<p>A data frame with following columns
</p>

<dl>
<dt>publication</dt><dd><p>publication identifier (first author and publication year)</p>
</dd>
<dt>year</dt><dd><p>publication year</p>
</dd>
<dt>randomized</dt><dd><p>randomization status (y/n)</p>
</dd>
<dt>control.type</dt><dd><p>type of control group (&quot;concurrent&quot; or &quot;historical&quot;)</p>
</dd>
<dt>comparison</dt><dd><p>type of comparison (&quot;IL-2RA only&quot;, &quot;delayed CNI&quot;, or &quot;no/low steroids&quot;)</p>
</dd>
<dt>followup</dt><dd><p>t	 follow-up time in months</p>
</dd>
<dt>exp.AR.events</dt><dd><p>number of AR events in experimental group</p>
</dd>
<dt>exp.PTLD.events</dt><dd><p>number of PTLD events in experimental group</p>
</dd>
<dt>exp.deaths</dt><dd><p>number of deaths in experimental group</p>
</dd>
<dt>exp.total</dt><dd><p>number of patients in experimental group</p>
</dd>
<dt>exp.SRR.events</dt><dd><p>number of SRR events in experimental group</p>
</dd>
<dt>cont.AR.events</dt><dd><p>number of AR events in control group</p>
</dd>
<dt>cont.SRR.events</dt><dd><p>number of SRR events in control group</p>
</dd>
<dt>cont.PTLD.events</dt><dd><p>number of PTLD events in control group</p>
</dd>
<dt>cont.deaths</dt><dd><p>number of deaths in control group</p>
</dd>
<dt>cont.total</dt><dd><p>number of patients in control group</p>
</dd>
<dt>r2</dt><dd><p>number of AR events in experimental group</p>
</dd>
<dt>n1</dt><dd><p>number of patients in control group</p>
</dd>
<dt>n2</dt><dd><p>number of patients in experimental group</p>
</dd>
<dt>r1</dt><dd><p>number of AR events in control group</p>
</dd>
</dl>



<h3>Source</h3>

<p>N.D. Crins, C. Roever, A.D. Goralczyk, T. Friede. Interleukin-2
receptor antagonists for pediatric liver transplant recipients:
A systematic review and meta-analysis of controlled studies. Pediatric
Transplantation, 18(8):839-850, 2014.
</p>

<hr>
<h2 id='dat.Eletriptan'>Migraine pain relief example (Eletriptan)</h2><span id='topic+dat.Eletriptan'></span>

<h3>Description</h3>

<p>Numbers of patients and events (headcahe free at 2 hours)
in experimental and control groups of 12 studies.
It is in one-study-per-row format.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dat.Eletriptan
</code></pre>


<h3>Format</h3>

<p>A data frame with following coloumns
</p>

<dl>
<dt>ID</dt><dd><p>trial ID</p>
</dd>
<dt>d1</dt><dd><p>dose (mg) in the first arm (placebo)</p>
</dd>
<dt>r1</dt><dd><p>number of events in the first arm (placebo)</p>
</dd>
<dt>n1</dt><dd><p>number of patients in the first arm (placebo)</p>
</dd>
<dt>d2</dt><dd><p>dose (mg) in the second arm </p>
</dd>
<dt>r2</dt><dd><p>number of events in the second arm</p>
</dd>
<dt>n2</dt><dd><p>number of patients in the second arm</p>
</dd>
<dt>d3</dt><dd><p>dose (mg) in the third arm</p>
</dd>
<dt>r3</dt><dd><p>number of events in the third arm</p>
</dd>
<dt>n3</dt><dd><p>number of patients in the third arm</p>
</dd>
<dt>d4</dt><dd><p>dose (mg) in the fourth arm</p>
</dd>
<dt>r4</dt><dd><p>number of events in the fourth arm</p>
</dd>
<dt>n4</dt><dd><p>number of patients in the fourth arm</p>
</dd>
<dt>nd</dt><dd><p>number of treatment arms</p>
</dd>
</dl>



<h3>Source</h3>

<p>Thorlund, K., Mills, E., Wu, P., Ramos, E.,
Chatterjee, A., Druyts, E., and Goadsby, P. (2014).
Comparative efficacy of triptans for the abortive treatment
of migraine: A multiple treatment comparison meta-analysis.
Cephalalgia, 34(4):258-267.
</p>

<hr>
<h2 id='forest_plot'>Plot a forest plot</h2><span id='topic+forest_plot'></span>

<h3>Description</h3>

<p>Takes a <code>meta_stan</code> object which is obtained by function <code>meta_stan</code> and plot
a forestplot, showing individual estimates along with their 95 percent credible intervals,
resulting effect estimate and prediction interval.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>forest_plot(
  x = NULL,
  labels = NULL,
  digits = 2,
  boxsize = 0.3,
  heterogeneity = TRUE,
  col,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="forest_plot_+3A_x">x</code></td>
<td>
<p>A <code>meta_stan</code> object.</p>
</td></tr>
<tr><td><code id="forest_plot_+3A_labels">labels</code></td>
<td>
<p>Optional vector with labels for the studies (publication author/year).</p>
</td></tr>
<tr><td><code id="forest_plot_+3A_digits">digits</code></td>
<td>
<p>A numerical value specifying the number of significant digits to be shown.
Default is 2.</p>
</td></tr>
<tr><td><code id="forest_plot_+3A_boxsize">boxsize</code></td>
<td>
<p>A numerical value specifying the box size. Default is 0.3.</p>
</td></tr>
<tr><td><code id="forest_plot_+3A_heterogeneity">heterogeneity</code></td>
<td>
<p>A logical value to include heterogeneity estimates (DEFAULT = TRUE)</p>
</td></tr>
<tr><td><code id="forest_plot_+3A_col">col</code></td>
<td>
<p>A function specifying the colors. See <code>forestplot::fpColors</code> for details.</p>
</td></tr>
<tr><td><code id="forest_plot_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The return value is invisible <code>NULL</code>.
</p>


<h3>Author(s)</h3>

<p>Christian Roever and Burak Kuersad Guenhan
</p>


<h3>Source</h3>

<p>This function is based <code>foresplot</code> function from <code>foresplot</code>
R package.
</p>


<h3>See Also</h3>

<p><code>foresplot::foresplot</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data('dat.Crins2014', package = "MetaStan")
dat_long &lt;- create_MetaStan_dat(dat = dat.Crins2014,
                                    armVars = c(responders = "r", sampleSize = "n"))
bnhm.Crins  &lt;- meta_stan(data = dat_long, likelihood = "binomial",
                         mu_prior = c(0, 10), theta_prior = c(0, 100),
                         tau_prior =  0.5)
forest_plot(bnhm.Crins, xlab = "log-OR", labels = dat.Crins2014$publication)


## End(Not run)
</code></pre>

<hr>
<h2 id='MBMA_stan'>Fitting a model-based meta-analysis model using Stan</h2><span id='topic+MBMA_stan'></span>

<h3>Description</h3>

<p>'MBMA_stan' fits a model-based meta-analysis model using Stan.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MBMA_stan(
  data = NULL,
  likelihood = NULL,
  dose_response = "emax",
  mu_prior = c(0, 10),
  Emax_prior = c(0, 100),
  alpha_prior = c(0, 100),
  tau_prior = 0.5,
  tau_prior_dist = "half-normal",
  ED50_prior = c(-2.5, 1.8),
  ED50_prior_dist = "functional",
  gamma_prior = c(1, 2),
  Pred_doses,
  re = TRUE,
  ncp = TRUE,
  chains = 4,
  iter = 2000,
  warmup = 1000,
  adapt_delta = 0.95,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MBMA_stan_+3A_data">data</code></td>
<td>
<p>An object of 'create_MBMA_dat'.</p>
</td></tr>
<tr><td><code id="MBMA_stan_+3A_likelihood">likelihood</code></td>
<td>
<p>A string specifying the likelihood of distributions defining the statistical
model. Options include &quot;normal&quot;, &quot;binomial&quot;, and &quot;Poisson&quot;.</p>
</td></tr>
<tr><td><code id="MBMA_stan_+3A_dose_response">dose_response</code></td>
<td>
<p>A string specifying the function defining the dose-response model.
Options include &quot;linear&quot;, &quot;log-linear&quot;, &quot;emax&quot;, and &quot;sigmoidal&quot;.</p>
</td></tr>
<tr><td><code id="MBMA_stan_+3A_mu_prior">mu_prior</code></td>
<td>
<p>A numerical vector specifying the parameter of the normal prior
density for baseline risks, first value is parameter for mean, second is for variance.
Default is c(0, 10).</p>
</td></tr>
<tr><td><code id="MBMA_stan_+3A_emax_prior">Emax_prior</code></td>
<td>
<p>A numerical vector specifying the parameter of the normal prior
density for Emax parameter, first value is parameter for mean, second
is for standard deviation. Default is c(0, 10). Needed for emax and sigmoidal models.</p>
</td></tr>
<tr><td><code id="MBMA_stan_+3A_alpha_prior">alpha_prior</code></td>
<td>
<p>A numerical vector specifying the parameter of the normal prior
density for the alpha parameter, first value is parameter for mean, second is for variance.
Default is c(0, 10). Needed for linear and linear log-dose models.</p>
</td></tr>
<tr><td><code id="MBMA_stan_+3A_tau_prior">tau_prior</code></td>
<td>
<p>A numerical value specifying the standard dev. of the prior density
for heterogenety stdev. Default is 0.5.</p>
</td></tr>
<tr><td><code id="MBMA_stan_+3A_tau_prior_dist">tau_prior_dist</code></td>
<td>
<p>A string specifying the prior density for the heterogeneity standard deviation,
option is 'half-normal' for half-normal prior, 'uniform' for uniform prior, 'half-cauchy' for
half-cauchy prior.</p>
</td></tr>
<tr><td><code id="MBMA_stan_+3A_ed50_prior">ED50_prior</code></td>
<td>
<p>A numerical vector specifying the parameter of the normal prior
density for ED50 parameter, first value is parameter for mean, second
is for standard deviation. Default is c(0, 10). Needed for emax and sigmoidal models.</p>
</td></tr>
<tr><td><code id="MBMA_stan_+3A_ed50_prior_dist">ED50_prior_dist</code></td>
<td>
<p>A string specifying the prior density for the ED50 parameter,
'functional' is for a functional uniform prior, 'half-normal' for uniform prior, 'half-cauchy' for
half-cauchy prior.</p>
</td></tr>
<tr><td><code id="MBMA_stan_+3A_gamma_prior">gamma_prior</code></td>
<td>
<p>A numerical vector specifying the parameter of the normal prior
density for gamma parameter, first value is parameter for mean, second
is for standard deviation. Default is c(1, 2). Needed for sigmoidal model.</p>
</td></tr>
<tr><td><code id="MBMA_stan_+3A_pred_doses">Pred_doses</code></td>
<td>
<p>A numerical vector specifying the doses which prediction will be made.</p>
</td></tr>
<tr><td><code id="MBMA_stan_+3A_re">re</code></td>
<td>
<p>A string specifying whether random-effects are included to the model. When 'FALSE', the
model corresponds to a fixed-effects model. The default is 'TRUE'.</p>
</td></tr>
<tr><td><code id="MBMA_stan_+3A_ncp">ncp</code></td>
<td>
<p>A string specifying whether to use a non-centered parametrization.
The default is 'TRUE'.</p>
</td></tr>
<tr><td><code id="MBMA_stan_+3A_chains">chains</code></td>
<td>
<p>A positive integer specifying the number of Markov chains.
The default is 4.</p>
</td></tr>
<tr><td><code id="MBMA_stan_+3A_iter">iter</code></td>
<td>
<p>A positive integer specifying the number of iterations for each chain
(including warmup). The default is 2000.</p>
</td></tr>
<tr><td><code id="MBMA_stan_+3A_warmup">warmup</code></td>
<td>
<p>A positive integer specifying the number of warmup (aka burnin)
iterations per chain. The default is 1000.</p>
</td></tr>
<tr><td><code id="MBMA_stan_+3A_adapt_delta">adapt_delta</code></td>
<td>
<p>A numerical value specfying the target average proposal acceptance
probability for adaptation. See Stan manual for details. Default is 0.95. In general
you should not need to change adapt_delta unless you see a warning message about
divergent transitions, in which case you can increase adapt_delta from the
default to a value closer to 1 (e.g. from 0.95 to 0.99, or from 0.99 to 0.999, etc).</p>
</td></tr>
<tr><td><code id="MBMA_stan_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of class 'stanfit' returned by 'rstan::sampling'
</p>


<h3>References</h3>

<p>Boucher M, et al. The many flavors of model-based meta-analysis:
Part I-Introduction and landmark data. <em>CPT: Pharmacometrics and Systems Pharmacology</em>.
2016;5:54-64.
</p>
<p>Guenhan BK, Roever C, Friede T. MetaStan: An R package for meta-analysis
and model-based meta-analysis using Stan. In preparation.
</p>
<p>Mawdsley D, et al. Model-based network meta-analysis: A
framework for evidence synthesis of clinical trial data.
<em>CPT: Pharmacometrics and Systems Pharmacology</em>. 2016;5:393-401.
</p>
<p>Zhang J, et al. (2014). Network meta-analysis of randomized
clinical trials: Reporting the proper summaries. <em>Clinical Trials</em>.
11(2), 246–262.
</p>
<p>Dias S, et al. Absolute or relative effects?
Arm-based synthesis of trial data. <em>Research Synthesis Methods</em>.
2016;7:23–28.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## Load the dataset
data('dat.Eletriptan', package = "MetaStan")
datMBMA = create_MetaStan_dat(dat = dat.Eletriptan,
                              armVars = c(dose = "d",
                                          responders = "r",
                                          sampleSize = "n"),
                              nArmsVar = "nd")

MBMA.Emax  &lt;- MBMA_stan(data = datMBMA,
                        likelihood = "binomial",
                        dose_response = "emax",
                        Pred_doses = seq(0, 80, length.out = 11),
                        mu_prior = c(0, 100),
                        Emax_prior = c(0, 100),
                        tau_prior_dist = "half-normal",
                        tau_prior = 0.5)
plot(MBMA.Emax) + ggplot2::xlab("Doses (mg)") + ggplot2::ylab("response probabilities")


## End(Not run)

</code></pre>

<hr>
<h2 id='meta_stan'>Fitting a meta-analysis model using Stan</h2><span id='topic+meta_stan'></span>

<h3>Description</h3>

<p>'meta_stan' fits a meta-analysis model using Stan.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>meta_stan(
  data = NULL,
  likelihood = NULL,
  mu_prior = c(0, 10),
  theta_prior = NULL,
  tau_prior = 0.5,
  tau_prior_dist = "half-normal",
  beta_prior = c(0, 100),
  delta = NULL,
  param = "Smith",
  re = TRUE,
  ncp = TRUE,
  interval.type = "shortest",
  mreg = FALSE,
  cov = NULL,
  chains = 4,
  iter = 2000,
  warmup = 1000,
  adapt_delta = 0.95,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="meta_stan_+3A_data">data</code></td>
<td>
<p>Data frame created by 'create_MetaStan_dat'</p>
</td></tr>
<tr><td><code id="meta_stan_+3A_likelihood">likelihood</code></td>
<td>
<p>A string specifying the likelihood function defining the statistical
model. Options include  'normal', 'binomial', and 'Poisson'.</p>
</td></tr>
<tr><td><code id="meta_stan_+3A_mu_prior">mu_prior</code></td>
<td>
<p>A numerical vector specifying the parameter of the normal prior
density for baseline risks, first value is parameter for mean, second is for variance.
Default is c(0, 10).</p>
</td></tr>
<tr><td><code id="meta_stan_+3A_theta_prior">theta_prior</code></td>
<td>
<p>A numerical vector specifying the parameter of the normal prior
density for treatment effect estimate, first value is parameter for mean, second
is for variance. Default is NULL.</p>
</td></tr>
<tr><td><code id="meta_stan_+3A_tau_prior">tau_prior</code></td>
<td>
<p>A numerical value specifying the standard dev. of the prior density
for heterogeneity stdev. Default is 0.5.</p>
</td></tr>
<tr><td><code id="meta_stan_+3A_tau_prior_dist">tau_prior_dist</code></td>
<td>
<p>A string specifying the prior density for the heterogeneity standard deviation,
option is 'half-normal' for half-normal prior, 'uniform' for uniform prior, 'half-cauchy' for
half-cauchy prior.</p>
</td></tr>
<tr><td><code id="meta_stan_+3A_beta_prior">beta_prior</code></td>
<td>
<p>A numerical vector specifying the parameter of the normal prior
density for beta coefficients in a meta-regression model, first value is parameter for mean, second
is for variance. Default is c(0, 100).</p>
</td></tr>
<tr><td><code id="meta_stan_+3A_delta">delta</code></td>
<td>
<p>A numerical value specifying the upper bound of the a priori interval for
treatment effect on odds ratio scale (<em>Guenhan et al (2020)</em>). This is used to calculate
a normal weakly informative prior.
for theta. Thus when this argument is specified, 'theta' should be left empty. Default is NULL.</p>
</td></tr>
<tr><td><code id="meta_stan_+3A_param">param</code></td>
<td>
<p>Paramteriztaion used. The default is the 'Smith' model suggested by
Smith et al (1995). The alternative is 'Higgins' is the common meta-analysis
model (Simmonds and Higgins, 2014).</p>
</td></tr>
<tr><td><code id="meta_stan_+3A_re">re</code></td>
<td>
<p>A string specifying whether random-effects are included to the model. When 'FALSE', the
model corresponds to a fixed-effects model. The default is 'TRUE'.</p>
</td></tr>
<tr><td><code id="meta_stan_+3A_ncp">ncp</code></td>
<td>
<p>A string specifying whether to use a non-centered parametrization.
The default is 'TRUE'.</p>
</td></tr>
<tr><td><code id="meta_stan_+3A_interval.type">interval.type</code></td>
<td>
<p>A string specifying the type of interval estimate. Options
include
shortest credible interval 'shortest' (default) and qui-tailed credible interval
'central'.</p>
</td></tr>
<tr><td><code id="meta_stan_+3A_mreg">mreg</code></td>
<td>
<p>A string specifying whether to fit a meta-regression model.
The default is 'FALSE'.</p>
</td></tr>
<tr><td><code id="meta_stan_+3A_cov">cov</code></td>
<td>
<p>A numeric vector or matrix specifying trial-level covariates (in each row).
This is needed when 'mreg = TRUE'.</p>
</td></tr>
<tr><td><code id="meta_stan_+3A_chains">chains</code></td>
<td>
<p>A positive integer specifying the number of Markov chains.
The default is 4.</p>
</td></tr>
<tr><td><code id="meta_stan_+3A_iter">iter</code></td>
<td>
<p>A positive integer specifying the number of iterations for each chain
(including warmup). The default is 2000.</p>
</td></tr>
<tr><td><code id="meta_stan_+3A_warmup">warmup</code></td>
<td>
<p>A positive integer specifying the number of warmup (aka burnin)
iterations per chain. The default is 1000.</p>
</td></tr>
<tr><td><code id="meta_stan_+3A_adapt_delta">adapt_delta</code></td>
<td>
<p>A numerical value specifying the target average proposal acceptance
probability for adaptation. See Stan manual for details. Default is 0.95. In general
you should not need to change adapt_delta unless you see a warning message about
divergent transitions, in which case you can increase adapt_delta from the
default to a value closer to 1 (e.g. from 0.95 to 0.99, or from 0.99 to 0.999, etc).</p>
</td></tr>
<tr><td><code id="meta_stan_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of class 'MetaStan'.
</p>


<h3>References</h3>

<p>Guenhan BK, Roever C, Friede T. MetaStan: An R package for meta-analysis
and model-based meta-analysis using Stan. In preparation.
</p>
<p>Guenhan BK, Roever C, Friede T. Random-effects meta-analysis of
few studies involving
rare events <em>Resarch Synthesis Methods</em> 2020; doi:10.1002/jrsm.1370.
</p>
<p>Jackson D, Law M, Stijnen T, Viechtbauer W, White IR. A comparison of 7
random-effects models for meta-analyses that estimate the summary odds ratio.
<em>Stat Med</em> 2018;37:1059&ndash;1085.
</p>
<p>Kuss O. Statistical methods for meta-analyses including information
from studies without any events-add nothing to nothing and succeed nevertheless,
<em>Stat Med</em>, 2015; 4; 1097&ndash;1116, doi: 10.1002/sim.6383.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

## TB dataset
data('dat.Berkey1995', package = "MetaStan")
## Fitting a Binomial-Normal Hierarchical model using WIP priors
dat_MetaStan &lt;- create_MetaStan_dat(dat = dat.Berkey1995,
                                    armVars = c(responders = "r", sampleSize = "n"))

 ma.stan  &lt;- meta_stan(data = dat_MetaStan,
                           likelihood = "binomial",
                           mu_prior = c(0, 10),
                           theta_prior = c(0, 100),
                           tau_prior = 0.5,
                           tau_prior_dist = "half-normal")
print(ma.stan)
forest_plot(ma.stan)


meta.reg.stan  &lt;- meta_stan(data = dat_MetaStan,
                           likelihood = "binomial",
                           mu_prior = c(0, 10),
                           theta_prior = c(0, 100),
                           tau_prior = 0.5,
                           tau_prior_dist = "half-normal",
                           mreg = TRUE,
                           cov = dat.Berkey1995$Latitude)

print(meta.reg.stan)

## End(Not run)

</code></pre>

<hr>
<h2 id='plot.MBMA_stan'>Plot a dose-response plot</h2><span id='topic+plot.MBMA_stan'></span>

<h3>Description</h3>

<p>Takes a <code>MBMA_stan</code> object which is obtained by function <code>MBMA_stan</code> and plot
a dose-response plot, showing observed event probabilities and the estimated dose-response
function with pointwise 95
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'MBMA_stan'
plot(x = MBMA.stan, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.MBMA_stan_+3A_x">x</code></td>
<td>
<p>A <code>MBMA_stan</code> object.</p>
</td></tr>
<tr><td><code id="plot.MBMA_stan_+3A_...">...</code></td>
<td>
<p>Further arguments passed to ggplot.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The return value is invisible <code>NULL</code>.
</p>


<h3>Author(s)</h3>

<p>Christian Roever and Burak Kuersad Guenhan
</p>


<h3>Source</h3>

<p>This function uses <code>ggplot</code> function from <code>ggplot2</code>
R package.
</p>


<h3>See Also</h3>

<p><code>ggplot2::ggplot</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data('dat.Eletriptan', package = "MetaStan")
datMBMA = create_MetaStan_dat(dat = dat.Eletriptan,
                              armVars = c(dose = "d",
                                          responders = "r",
                                          sampleSize = "n"),
                              nArmsVar = "nd")

MBMA.Emax  &lt;- MBMA_stan(data = datMBMA,
                        likelihood = "binomial",
                        dose_response = "emax",
                        Pred_doses = seq(0, 80, length.out = 11),
                        mu_prior = c(0, 100),
                        Emax_prior = c(0, 100),
                        tau_prior_dist = "half-normal",
                        tau_prior = 0.5)
plot(MBMA.Emax) + ggplot2::xlab("Doses (mg)") + ggplot2::ylab("response probabilities")


## End(Not run)
</code></pre>

<hr>
<h2 id='print.MBMA_stan'>Print MBMA object</h2><span id='topic+print.MBMA_stan'></span>

<h3>Description</h3>

<p>Takes an <code>MBMA_stan</code> object which is obtained by function <code>MBMA_stan</code> and print
the model and data information such as model type used in the model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'MBMA_stan'
print(x, digits = 2, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.MBMA_stan_+3A_x">x</code></td>
<td>
<p>A <code>MBMA_stan</code> object.</p>
</td></tr>
<tr><td><code id="print.MBMA_stan_+3A_digits">digits</code></td>
<td>
<p>An integer indicating the number of decimal places.</p>
</td></tr>
<tr><td><code id="print.MBMA_stan_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The return value is invisible <code>NULL</code>
</p>

<hr>
<h2 id='print.meta_stan'>Print meta_stan object</h2><span id='topic+print.meta_stan'></span>

<h3>Description</h3>

<p>Takes an <code>meta_stan</code> object which is obtained by function <code>meta_stan</code> and print
the model and data information such as model type used in the model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'meta_stan'
print(x, digits = 2, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.meta_stan_+3A_x">x</code></td>
<td>
<p>A <code>meta_stan</code> object.</p>
</td></tr>
<tr><td><code id="print.meta_stan_+3A_digits">digits</code></td>
<td>
<p>An integer indicating the number of decimal places.</p>
</td></tr>
<tr><td><code id="print.meta_stan_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The return value is invisible <code>NULL</code>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
