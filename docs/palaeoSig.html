<!DOCTYPE html><html><head><title>Help for package palaeoSig</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {palaeoSig}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#abundances'><p> Generates abundances</p>
</a></li>
<li><a href='#agelme'><p> Estimation of the relationship between Calibrated age and depth</p></a></li>
<li><a href='#anamorph'><p> Anamorph</p></a></li>
<li><a href='#arctic.pollen'><p>Arctic Pollen and associated environmental data</p></a></li>
<li><a href='#Atlantic'><p>Atlantic core-top foram assemblages</p></a></li>
<li><a href='#centipede_plot'><p>centipede_plot</p></a></li>
<li><a href='#cor.mat.fun'><p> Generates correlation matrix</p>
</a></li>
<li><a href='#coverage_plot'><p>coverage_plot</p></a></li>
<li><a href='#Hill.N2.core'>
<p>Calculate the effective number of species in the fossil data</p></a></li>
<li><a href='#jointsig'><p>Test if two variables jointly control changes in fossil data</p></a></li>
<li><a href='#make.env'><p> Generates environmental variables</p>
</a></li>
<li><a href='#make.set'><p> Function to simulate species data</p>
</a></li>
<li><a href='#multi.mat'><p> MAT for multiple variables</p></a></li>
<li><a href='#obs.cor'><p>Weighted correlation between weighted averaging optima and constrained</p>
ordination species scores.</a></li>
<li><a href='#palaeoSig-package'>
<p>Significance Tests of Quantitative Palaeoenvironmental Reconstructions</p></a></li>
<li><a href='#plot.fittedAgelme'><p>Plots fitted agelme model and dates</p></a></li>
<li><a href='#plot.RNE'><p>Random, neighbour, environment deletion analysis for transfer function</p>
models</a></li>
<li><a href='#predict.agelme'><p> Predicts the Calibrated age</p></a></li>
<li><a href='#randomTF'><p>Proportion of variance in the fossil data explained by an</p>
environmental reconstruction</a></li>
<li><a href='#species'><p> Generates species response parameters for n dimensions</p>
</a></li>
<li><a href='#STOR'><p>Storsandsvatnet</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Significance Tests for Palaeoenvironmental Reconstructions</td>
</tr>
<tr>
<td>Version:</td>
<td>2.1-3</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/richardjtelford/palaeoSig">https://github.com/richardjtelford/palaeoSig</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/richardjtelford/palaeoSig/issues">https://github.com/richardjtelford/palaeoSig/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.1)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>units, knitr, rmarkdown, gstat, sf, analogue, testthat (&ge;
3.0.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>TeachingDemos, rioja, mgcv, MASS, tibble, dplyr, magrittr,
ggplot2, forcats (&ge; 1.0.0), assertr, vegan, rlang, ggrepel,
tidyr, purrr (&ge; 1.0.0)</td>
</tr>
<tr>
<td>Description:</td>
<td>Several tests of quantitative palaeoenvironmental reconstructions 
  from microfossil assemblages, including the null model tests of the 
  statistically significant of reconstructions developed by Telford and Birks
  (2011) &lt;<a href="https://doi.org/10.1016%2Fj.quascirev.2011.03.002">doi:10.1016/j.quascirev.2011.03.002</a>&gt;, and tests of the effect of 
  spatial autocorrelation on transfer function model performance using methods 
  from Telford and Birks (2009) &lt;<a href="https://doi.org/10.1016%2Fj.quascirev.2008.12.020">doi:10.1016/j.quascirev.2008.12.020</a>&gt; and 
  Trachsel and Telford (2016) &lt;<a href="https://doi.org/10.5194%2Fcp-12-1215-2016">doi:10.5194/cp-12-1215-2016</a>&gt;. Age-depth models with 
  generalized mixed-effect regression from Heegaard et al (2005)
  &lt;<a href="https://doi.org/10.1191%2F0959683605hl836rr">doi:10.1191/0959683605hl836rr</a>&gt; are also included.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Language:</td>
<td>en-GB</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-03-09 20:02:58 UTC; gbsrt</td>
</tr>
<tr>
<td>Author:</td>
<td>Richard Telford [aut, cre, cph],
  Mathias Trachsel [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Richard Telford &lt;Richard.Telford@uib.no&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-03-10 09:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='abundances'> Generates abundances

</h2><span id='topic+abundances'></span>

<h3>Description</h3>

<p> Generates species abundances based on species response functions and environmental variables.  

</p>


<h3>Usage</h3>

<pre><code class='language-R'>abundances(env, spp, nc)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="abundances_+3A_env">env</code></td>
<td>
<p> Environmental variables. Usually generated by <code><a href="#topic+make.env">make.env</a></code>. Users may as well supply own environmental variables. 

</p>
</td></tr>
<tr><td><code id="abundances_+3A_spp">spp</code></td>
<td>
<p> Species parameters. Usually generated by <code><a href="#topic+species">species</a></code>.

</p>
</td></tr>
<tr><td><code id="abundances_+3A_nc">nc</code></td>
<td>
<p>  Number of counts to be simulated. If omitted no simulation of the counting process is carried out. 

</p>
</td></tr>
</table>


<h3>Value</h3>

 


<table>
<tr><td><code>spp</code></td>
<td>
<p>Data frame containing species abundances.</p>
</td></tr>
<tr><td><code>env</code></td>
<td>
<p>Data frame containing environmental variables.</p>
</td></tr>

</table>


<h3>Author(s)</h3>

<p> Mathias Trachsel and Richard J Telford

</p>


<h3>References</h3>

<p> Minchin, P.R. (1987) Multidimensional Community Patterns: Towards a Comprehensive Model. Vegetatio, 71, 145-156.
</p>



<h3>See Also</h3>

<p><code><a href="#topic+make.env">make.env</a></code>, <code><a href="#topic+species">species</a></code>  

</p>


<h3>Examples</h3>

<pre><code class='language-R'>spec &lt;- species(nspp = 30,ndim = 10,Amax = runif,fun = runif, xpar = c(-50,150),
    srange = 200, alpha = 4, gamma = 4)
env.var &lt;- make.env(100,elen =rep(100,10),emean = rep(50,10), edistr ='uniform',
    ndim = 10)
spec.abun &lt;- abundances(env.var,spec,200)
</code></pre>

<hr>
<h2 id='agelme'> Estimation of the relationship between Calibrated age and depth </h2><span id='topic+agelme'></span>

<h3>Description</h3>

<p>Estimates the relationship of Calibrated age and depth for palaeorecords. The function uses a smooth spline
of the mgcv library by Simon Wood. It produces predicted confidence interval for the relationship approximating 
a mixed effect model, as there are two levels of uncertainty, i.e. within dated object and between dated objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>agelme(depup, depdo, bpup, bpdo, use, weights=c(1,rep(0,length(depup)-1)), 
    vspan=1, k=length(depup)-1, m=2, diagnostic=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="agelme_+3A_depup">depup</code></td>
<td>
<p> The upper depths of the dated slides </p>
</td></tr>
<tr><td><code id="agelme_+3A_depdo">depdo</code></td>
<td>
<p> The lower depths of the dated slides </p>
</td></tr>
<tr><td><code id="agelme_+3A_bpup">bpup</code></td>
<td>
<p> The younger calibrated ages of the dated slides </p>
</td></tr>
<tr><td><code id="agelme_+3A_bpdo">bpdo</code></td>
<td>
<p> The older calibrated ages of the dated slides </p>
</td></tr>
<tr><td><code id="agelme_+3A_use">use</code></td>
<td>
<p> Logical vector of dates to include in the model. Default is to use all.</p>
</td></tr>
<tr><td><code id="agelme_+3A_weights">weights</code></td>
<td>
<p> Weights to be used for the estimation, default is fixed top-layer followed by inverse variance of within dated object </p>
</td></tr>
<tr><td><code id="agelme_+3A_vspan">vspan</code></td>
<td>
<p> The span to be used for the diagnostic plots, default span = 1 </p>
</td></tr>
<tr><td><code id="agelme_+3A_k">k</code></td>
<td>
<p> Number of base function to start the shrinkage in the gam estimation procedure </p>
</td></tr>
<tr><td><code id="agelme_+3A_m">m</code></td>
<td>
<p>The order of penalty for the term, i.e. the degree of continuity at the knots (default, m = 2 gives cubic smooth spline) </p>
</td></tr>
<tr><td><code id="agelme_+3A_diagnostic">diagnostic</code></td>
<td>
<p>Logical, should diagnostic plots be made.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that the fixation of the top layer is done by a weight = 1, whereas the other weights follows inverse variance within object.
</p>
<p>The diagnostic plots is used to check the quality of the estimation and to see if there is a need for an assumption of between
object variance proportional to mean. The latter however is rarely encountered for palaeodata.
</p>


<h3>Value</h3>

<table>
<tr><td><code>tdf</code></td>
<td>
<p>Degrees of freedom used by the cubic smooth spline, a vector with first value for constant variance and second vector for variance equal to mu.</p>
</td></tr>
<tr><td><code>weights</code></td>
<td>
<p>A vector of the weights used by the cubic smooth spline </p>
</td></tr>


<tr><td><code>RES</code></td>
<td>
<p>A vector of the Residual sum of squares</p>
</td></tr>
<tr><td><code>Models</code></td>
<td>
<p>A list with the models from the cubic smooth spline, constant and mu variance, respectively</p>
</td></tr>
<tr><td><code>Data</code></td>
<td>
<p>A data.frame including the data used for the estimation</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Einar Heegaard &lt;einar.heegaard@bio.uib.no&gt; </p>


<h3>References</h3>

<p> Heegaard, E., Birks, HJB. &amp; Telford, RJ. 2005. Relationships between calibrated ages and depth in stratigraphical sequences: an estimation procedure by mixed-effect regression. The Holocene 15: 612-618</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(STOR)

fit.mod &lt;- with(STOR,agelme(depthup,depthdo,cageup,cagedo))

#Predicting using the constant variance model,
#for each cm between 70 and 400 cm.
fit.pre &lt;- predict(fit.mod,1,70:400)
plot(fit.pre)

</code></pre>

<hr>
<h2 id='anamorph'> Anamorph </h2><span id='topic+anamorph'></span>

<h3>Description</h3>

<p>Creates functions that transform arbitrary distributions into a Gaussian distributions, and vice versa.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>anamorph(x, k, plot = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="anamorph_+3A_x">x</code></td>
<td>
<p> data </p>
</td></tr>
<tr><td><code id="anamorph_+3A_k">k</code></td>
<td>
<p> number of Hermite polynomials </p>
</td></tr>
<tr><td><code id="anamorph_+3A_plot">plot</code></td>
<td>
<p> plot </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Increasing k can give a better fit.
</p>


<h3>Value</h3>

<p>Returns two function in a list
</p>
<table>
<tr><td><code>xtog</code></td>
<td>
<p>Function to transform arbitrary variable x into a Gaussian distribution</p>
</td></tr>
<tr><td><code>gtox</code></td>
<td>
<p>The back transformation</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Richard Telford <a href="mailto:Richard.Telford@bio.uib.no">Richard.Telford@bio.uib.no</a>  </p>


<h3>References</h3>

<p> Wackernagel, H. (2003) <em>Multivariate Geostatistics.</em> 3rd edition, Springer-Verlag, Berlin. </p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(42)
x &lt;- c(rnorm(50, 0, 1), rnorm(50, 6, 1))
hist(x)
ana.fun &lt;- anamorph(x, 30, plot = TRUE)
xg &lt;- ana.fun$xtog(x)
qqnorm(xg)
qqline(xg)
all.equal(x, ana.fun$gtox(xg))
</code></pre>

<hr>
<h2 id='arctic.pollen'>Arctic Pollen and associated environmental data</h2><span id='topic+arctic.pollen'></span><span id='topic+arctic.env'></span>

<h3>Description</h3>

<p>Arctic pollen percent data and associated environmental data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(arctic.pollen)
data(arctic.env)
</code></pre>


<h3>Format</h3>


<dl>
<dt>arctic.pollen</dt><dd><p>A data frame with 828 observations on the percentage
of 39 pollen taxa</p>
</dd>
<dt>arctic.env</dt><dd><p>Environmental data for the pollen sites</p>
</dd>
</dl>



<h3>Source</h3>

<p>Data extracted from North American Pollen Database and
New <em>et al.</em> (2002) by Fréchette <em>et al.</em> (2008).
Following Fréchette (Pers. Comm.), three duplicate sites have been deleted.
</p>


<h3>References</h3>

<p>Fréchette, B., de Vernal, A., Guiot, J., Wolfe, A. P., Miller,
G. H., Fredskild, B., Kerwin, M. W. and Richard, P. J. H. (2008)
Methodological basis for quantitative reconstruction of air temperature and
sunshine from pollen assemblages in Arctic Canada and Greenland.
<em>Quaternary Science Reviews</em> <b>27</b>, 1197&ndash;1216
<a href="https://doi.org/10.1016/j.quascirev.2008.02.016">doi:10.1016/j.quascirev.2008.02.016</a>
</p>

<hr>
<h2 id='Atlantic'>Atlantic core-top foram assemblages</h2><span id='topic+Atlantic'></span>

<h3>Description</h3>

<p>A dataset containing over 1000 foram assemblages from the Atlantic from
Kucera et al (2005) and the 50m SST for the warmest season. Rare taxa and
co-located assemblages are removed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Atlantic)
</code></pre>


<h3>Format</h3>

<p>A data frame with 1093 rows and 33 variables.
summ50 is 50m water temperature of the warmest season
</p>


<h3>Source</h3>

<p><a href="https://doi.org/10.1594/PANGAEA.227322">doi:10.1594/PANGAEA.227322</a>
<a href="https://www.nodc.noaa.gov/cgi-bin/OC5/woa13/woa13.pl?parameter=t">https://www.nodc.noaa.gov/cgi-bin/OC5/woa13/woa13.pl?parameter=t</a>
</p>

<hr>
<h2 id='centipede_plot'>centipede_plot</h2><span id='topic+centipede_plot'></span>

<h3>Description</h3>

<p>Plot of species WA optima and tolerance
</p>


<h3>Usage</h3>

<pre><code class='language-R'>centipede_plot(x, spp, minN2 = 1, mult = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="centipede_plot_+3A_x">x</code></td>
<td>
<p>A tolerance weighted weighted-average model from
<code><a href="rioja.html#topic+WA">WA</a></code></p>
</td></tr>
<tr><td><code id="centipede_plot_+3A_spp">spp</code></td>
<td>
<p>data.frame of species data used to train the WA model</p>
</td></tr>
<tr><td><code id="centipede_plot_+3A_minn2">minN2</code></td>
<td>
<p>numeric giving minimum N2 for inclusion in plot</p>
</td></tr>
<tr><td><code id="centipede_plot_+3A_mult">mult</code></td>
<td>
<p>numeric multiplier for the tolerances</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Extracts and sorts <code><a href="rioja.html#topic+WA">WA</a></code> optima and tolerances and
generates a ggplot.
Tends only to work well when there are a reasonable number of taxa,
otherwise it is difficult to read the names on the axis.
Rare taxa can be excluded with the <code>minN2</code> argument.
The <code>tol.cut</code> argument in <code><a href="rioja.html#topic+WA">WA</a></code> may need to be set to
prevent very small tolerances in rare taxa.
This function is very similar to the <code><a href="analogue.html#topic+caterpillar">caterpillar</a></code>
plot, but produces a ggplot
</p>


<h3>Value</h3>

<p>A <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(rioja)
data(SWAP)
mod &lt;- WA(SWAP$spec, SWAP$pH, tolDW = TRUE)
coef(mod)
centipede_plot(mod, spp = SWAP$spec, minN2 = 20)
</code></pre>

<hr>
<h2 id='cor.mat.fun'> Generates correlation matrix 

</h2><span id='topic+cor.mat.fun'></span>

<h3>Description</h3>

<p> Generates a correlation matrix for the environmental variables generated in <code><a href="#topic+make.env">make.env</a></code> and for correlated species optima in <code><a href="#topic+species">species</a></code>. Only used when correlated environmental variables or optima are generated.  

</p>


<h3>Usage</h3>

<pre><code class='language-R'>cor.mat.fun(ndim, cors)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cor.mat.fun_+3A_ndim">ndim</code></td>
<td>
<p> Number of environmental variables that are subsequently generated with <code><a href="#topic+make.env">make.env</a></code>.

</p>
</td></tr>
<tr><td><code id="cor.mat.fun_+3A_cors">cors</code></td>
<td>
<p> List of correlations between environmental variables. Each element of the list consists of three numbers, the first two numbers indicate the variables that are correlated, the third number is the correlation coefficient. If correlations between two variables are omitted the correlation remains 0.      

</p>
</td></tr>
</table>


<h3>Value</h3>

<p> Correlation matrix





</p>


<h3>Author(s)</h3>

<p> Mathias Trachsel

</p>


<h3>See Also</h3>

 <p><code><a href="#topic+make.env">make.env</a></code>, <code><a href="#topic+species">species</a></code>

</p>


<h3>Examples</h3>

<pre><code class='language-R'>correlations &lt;- list(c(1, 2, 0.5), c(1, 4, 0.1), c(2, 5, 0.6))
cor.mat &lt;-  cor.mat.fun(5, correlations)


</code></pre>

<hr>
<h2 id='coverage_plot'>coverage_plot</h2><span id='topic+coverage_plot'></span>

<h3>Description</h3>

<p>A simple diagnostic plot showing the coverage of fossil taxa in
modern calibration set
</p>


<h3>Usage</h3>

<pre><code class='language-R'>coverage_plot(spp, fos, n2_rare = 5, label = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coverage_plot_+3A_spp">spp</code></td>
<td>
<p>data.frame of modern species abundances</p>
</td></tr>
<tr><td><code id="coverage_plot_+3A_fos">fos</code></td>
<td>
<p>data.frame of fossil species abundances</p>
</td></tr>
<tr><td><code id="coverage_plot_+3A_n2_rare">n2_rare</code></td>
<td>
<p>numeric value of Hill's N2 below which species are
highlighted as rare</p>
</td></tr>
<tr><td><code id="coverage_plot_+3A_label">label</code></td>
<td>
<p>numeric label taxa where maximum fossil abundance -
maximum modern abundance &gt; label.
Defaults to NULL which does not add labels</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Finds the maximum abundance of fossil taxa and plots this against
the maximum abundance the taxa in the modern calibration set.
Taxa with a Hill's N2 less than <code>rare</code> in the calibration set are
highlighted in blue.
Taxa absent from the calibration set are highlighted in red.
If there are many taxa above the 1:1 line, or important fossil taxa have a
low N2 in the calibration set,
reconstructions should be interpreted with caution.
</p>


<h3>Value</h3>

<p>A <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("SWAP", package = "rioja")
data("RLGH", package = "rioja")
coverage_plot(spp = SWAP$spec, fos = RLGH$spec, n2_rare = 5, label = 0)

</code></pre>

<hr>
<h2 id='Hill.N2.core'>
Calculate the effective number of species in the fossil data
</h2><span id='topic+Hill.N2.core'></span>

<h3>Description</h3>

<p>Gives a measure of the species diversity in the fossil data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Hill.N2.core(spp)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Hill.N2.core_+3A_spp">spp</code></td>
<td>

<p>Species data
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Uses <code>Hill.N2</code> from the rioja package 
</p>


<h3>Value</h3>

<p>Minimum, first quartile and median effective number of species
</p>


<h3>Note</h3>

<p>If the effective number of species is small, WA based reconstructions are unlikely to be significant, and MAT based reconstructions should be tested instead.
</p>


<h3>Author(s)</h3>

<p>Richard Telford
</p>


<h3>References</h3>

<p>Hill, M. O. (1973) Diversity and evenness: a unifying notation and its consequences. <em>Ecology</em> <b>54</b>: 427&ndash;432. 
</p>


<h3>See Also</h3>

<p><code>Hill.N2</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(rioja)
data(RLGH)

Hill.N2.core(RLGH$spec)
</code></pre>

<hr>
<h2 id='jointsig'>Test if two variables jointly control changes in fossil data</h2><span id='topic+jointsig'></span><span id='topic+plot.js'></span>

<h3>Description</h3>

<p>Generates synthetic variables with different proportion of two
environmental variables, and tests how much variance in the fossil data
reconstructions of these synthetic variables explain.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>jointsig(spp, fos, var1, var2, method = "randomTF", n = 99, r = 32, ...)

## S3 method for class 'js'
plot(x, names.v1, names.v2, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="jointsig_+3A_spp">spp</code></td>
<td>
<p>Data frame of modern training set species data, transformed as
required, for example with sqrt</p>
</td></tr>
<tr><td><code id="jointsig_+3A_fos">fos</code></td>
<td>
<p>Data frame of fossil species data, with same species codes and
transformations as spp</p>
</td></tr>
<tr><td><code id="jointsig_+3A_var1">var1</code></td>
<td>
<p>Training set environmental variable 1</p>
</td></tr>
<tr><td><code id="jointsig_+3A_var2">var2</code></td>
<td>
<p>Training set environmental variable 2</p>
</td></tr>
<tr><td><code id="jointsig_+3A_method">method</code></td>
<td>
<p>Which significance test to use.
Current option are randomTF and obs.cor.
The latter may give strange results - use with caution.</p>
</td></tr>
<tr><td><code id="jointsig_+3A_n">n</code></td>
<td>
<p>number of random training sets used to generate the null model</p>
</td></tr>
<tr><td><code id="jointsig_+3A_r">r</code></td>
<td>
<p>How many synthetic variables to make. More is better but slower</p>
</td></tr>
<tr><td><code id="jointsig_+3A_...">...</code></td>
<td>
<p>Other arguments to plot</p>
</td></tr>
<tr><td><code id="jointsig_+3A_x">x</code></td>
<td>
<p>Output from jointsig</p>
</td></tr>
<tr><td><code id="jointsig_+3A_names.v1">names.v1</code></td>
<td>
<p>Vector length 2 with names of the end members of the first
environmental variable, e.g., c(&quot;cold&quot;, &quot;warm&quot;) for temperature.</p>
</td></tr>
<tr><td><code id="jointsig_+3A_names.v2">names.v2</code></td>
<td>
<p>Ditto for the second variable.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>With <code>method="randomTF"</code>, the function calculates the proportion of
variance in the fossil data explained by transfer function reconstructions of
synthetic variables.
The synthetic variables are composed of two environmental variables, weighted
between -1 and +1, so to represent a circle.
This is compared with a null distribution of the proportion of variance
explained by reconstructions based on random environmental variables.
Any transfer function in the rioja library can be used.
With method=&quot;obs.cor&quot;, the aim is the same, but the function reports the
correlation between the species weighted average optima on the synthetic
variables and the species first axis scores.
This option has some pathological behaviour and should probably be avoided.
</p>


<h3>Value</h3>

<p>A list with components
</p>

<ul>
<li><p>PCA The unconstrained ordination of the fossil data.
</p>
</li>
<li><p>preds A list of the containing the reconstructions for each
environmental variable.
</p>
</li>
<li><p>MAX Proportion of the variance explained by the first axis of the
unconstrained ordination. This is the maximum amount that a reconstruction
of a single variable can explain.
</p>
</li>
<li><p>EX The proportion of the variance in the fossil data explained by
each reconstruction.
</p>
</li>
<li><p>sim.ex The proportion of variance explained by each of the random
environmental variables.
</p>
</li>
<li><p>sig The p-value of each reconstruction.
</p>
</li></ul>



<h3>Functions</h3>


<ul>
<li> <p><code>plot(js)</code>: Plot js object
</p>
</li></ul>


<h3>Author(s)</h3>

<p>Richard Telford <a href="mailto:richard.telford@bio.uib.no">richard.telford@bio.uib.no</a>
</p>


<h3>References</h3>

<p>Unpublished method - use with caution. Can give spurious results
with weighted averaging.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+randomTF">randomTF</a></code>,<code><a href="#topic+obs.cor">obs.cor</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(rioja)
data(SWAP)
data(RLGH)

rlgh.js &lt;- jointsig(
  spp = sqrt(SWAP$spec),
  fos = sqrt(RLGH$spec),
  var1 = SWAP$pH,
  var2 = sample(SWAP$pH),
  method = "randomTF",
  n = 49, r = 32, fun = WA, col = 1
)
# nonsense second variable

plot(rlgh.js, c("acid", "alkaline"), c("down", "up"))
</code></pre>

<hr>
<h2 id='make.env'> Generates environmental variables

</h2><span id='topic+make.env'></span>

<h3>Description</h3>

<p> Generates environmental variables used for generating species abundances. Environmental variables may be correlated, and may follow different distributions. 

</p>


<h3>Usage</h3>

<pre><code class='language-R'>make.env(n, elen, emean, edistr, ecor, ndim)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="make.env_+3A_n">n</code></td>
<td>
<p> Number of samples to be generated.

</p>
</td></tr>
<tr><td><code id="make.env_+3A_elen">elen</code></td>
<td>
<p> Range of the environmental variables. Single number or vector of length ndim.  

</p>
</td></tr>
<tr><td><code id="make.env_+3A_emean">emean</code></td>
<td>
<p> Mean of the environmental variables. Single number or vector of length ndim. 

</p>
</td></tr>
<tr><td><code id="make.env_+3A_edistr">edistr</code></td>
<td>
<p> Distribution of the environmental variables. Currently 'uniform' and 'Gaussian' are supported.  

</p>
</td></tr>
<tr><td><code id="make.env_+3A_ecor">ecor</code></td>
<td>
<p> Correlation matrix of the environmental variables supplied by user. Object generated by <code><a href="#topic+cor.mat.fun">cor.mat.fun</a></code>. If omitted environmental variables are not correlated.

</p>
</td></tr>
<tr><td><code id="make.env_+3A_ndim">ndim</code></td>
<td>
<p> Number of environmental variables to generate. 

</p>
</td></tr>
</table>


<h3>Value</h3>

<p> Matrix of environmental variables. n rows and ndim columns. 





</p>


<h3>Author(s)</h3>

<p> Mathias Trachsel and Richard J. Telford

</p>


<h3>References</h3>

<p> Minchin, P.R. (1987) Multidimensional Community Patterns: Towards a Comprehensive Model. Vegetatio, 71, 145-156.

</p>


<h3>See Also</h3>

 <p><code><a href="#topic+cor.mat.fun">cor.mat.fun</a></code>

</p>


<h3>Examples</h3>

<pre><code class='language-R'> 
env.vars &lt;- make.env(100,elen =rep(100,10),emean = rep(50,10), edistr ='uniform',ndim = 10)
</code></pre>

<hr>
<h2 id='make.set'> Function to simulate species data

</h2><span id='topic+make.set'></span>

<h3>Description</h3>

<p> Function to simulate species data following Minchin (1987). This functions generates species response functions, simulates environmental variables and simulates species assemblages based on species response functions and environmental variables. Users can as well supply own species parameters (e.g. when simulating calibration and fossil datasets) and own environmental variables. 

</p>


<h3>Usage</h3>

<pre><code class='language-R'>make.set(ndim, n, elen, emean, edistr, ecor, cnt, spec, env,...)
</code></pre>


<h3>Arguments</h3>

 
<table>
<tr><td><code id="make.set_+3A_ndim">ndim</code></td>
<td>
<p> Number of environmental variables to generate. 

</p>
</td></tr>
<tr><td><code id="make.set_+3A_n">n</code></td>
<td>
<p> Number of samples to be generated.

</p>
</td></tr>
<tr><td><code id="make.set_+3A_elen">elen</code></td>
<td>
<p> Range of the environmental variables. Single number or vector of length ndim.  

</p>
</td></tr>
<tr><td><code id="make.set_+3A_emean">emean</code></td>
<td>
<p> Mean of the environmental variables. Single number or vector of length ndim. 

</p>
</td></tr>
<tr><td><code id="make.set_+3A_edistr">edistr</code></td>
<td>
<p> Distribution of the environmental variables. Currently 'uniform' and 'Gaussian' are supported.  

</p>
</td></tr>
<tr><td><code id="make.set_+3A_ecor">ecor</code></td>
<td>
<p> Correlation matrix of the environmental variables supplied by user. Object generated by <code><a href="#topic+cor.mat.fun">cor.mat.fun</a></code>. If omitted environmental variables are uncorrelated.

</p>
</td></tr>
<tr><td><code id="make.set_+3A_cnt">cnt</code></td>
<td>
<p> Number of counts to be simulated.

</p>
</td></tr>
<tr><td><code id="make.set_+3A_spec">spec</code></td>
<td>
<p> Users may supply their own species parameters.

</p>
</td></tr>              
<tr><td><code id="make.set_+3A_env">env</code></td>
<td>
<p>  Users may supply their own environmental variables.

</p>
</td></tr>   
<tr><td><code id="make.set_+3A_...">...</code></td>
<td>
<p> Arguments passed to <code><a href="#topic+species">species</a></code>
</p>
</td></tr>  
</table>


<h3>Value</h3>

<table>
<tr><td><code>spp</code></td>
<td>
<p>Species abundance data.</p>
</td></tr>
<tr><td><code>env</code></td>
<td>
<p>Environmental variables used to simulate species abundance data.</p>
</td></tr>
<tr><td><code>spec</code></td>
<td>
<p>Species parameters.</p>
</td></tr>





</table>


<h3>Author(s)</h3>

<p> Mathias Trachsel and Richard J. Telford

</p>


<h3>References</h3>

<p> Minchin, P.R. (1987) Multidimensional Community Patterns: Towards a Comprehensive Model. Vegetatio, 71, 145-156.

</p>


<h3>See Also</h3>

  <p><code><a href="#topic+make.env">make.env</a></code>, <code><a href="#topic+species">species</a></code>, <code><a href="#topic+cor.mat.fun">cor.mat.fun</a></code>

</p>


<h3>Examples</h3>

<pre><code class='language-R'>calib &lt;- make.set(nspp = 90,ndim = 3,Amax = runif,fun = runif, xpar = c(-50,150), 
    srange = 400, alpha = 4, gamma = 4,n = 100,elen =rep(100,3),emean = rep(50,3),
    edistr ='uniform', cnt = 1000)

# Provide species parameters generated above, so that the fossil data use the 
#    same species parameters.
fos &lt;- make.set(ndim = 3,n = 100,elen =rep(100,3),emean = rep(50,3), edistr ='uniform',
    cnt = 1000, spec = calib$spec)  

# Supplying own environmental variables and species parameters.
env.vars &lt;- make.env(100,elen =rep(100,3),emean = rep(50,3), edistr ='uniform',ndim = 3)
fos &lt;- make.set(cnt = 1000, spec = calib$spec, env = env.vars)  


</code></pre>

<hr>
<h2 id='multi.mat'> MAT for multiple variables </h2><span id='topic+multi.mat'></span>

<h3>Description</h3>

<p>MAT for many environmental variables simultaneously. More efficient than calculating them separately for each variable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multi.mat(training.spp, envs, core.spp, noanalogues = 10, method = "sq-chord",
    run = "both")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="multi.mat_+3A_training.spp">training.spp</code></td>
<td>
<p> Community data </p>
</td></tr>
<tr><td><code id="multi.mat_+3A_envs">envs</code></td>
<td>
<p> Environmental variables - or simulations </p>
</td></tr>
<tr><td><code id="multi.mat_+3A_core.spp">core.spp</code></td>
<td>
<p> Optional fossil data to make predictions for</p>
</td></tr>
<tr><td><code id="multi.mat_+3A_noanalogues">noanalogues</code></td>
<td>
<p> Number of analogues to use </p>
</td></tr>
<tr><td><code id="multi.mat_+3A_method">method</code></td>
<td>
<p> distance metric to use </p>
</td></tr>
<tr><td><code id="multi.mat_+3A_run">run</code></td>
<td>
<p> Return LOO predictions or predictions for fossil data  </p>
</td></tr>
</table>


<h3>Value</h3>

<p>Matrix of predictions
</p>


<h3>Author(s)</h3>

<p> Richard Telford <a href="mailto:Richard.Telford@bio.uib.no">Richard.Telford@bio.uib.no</a>  </p>


<h3>References</h3>

<p> Telford, R. J. and Birks, H. J. B. (2009) Evaluation of transfer functions in spatially structured environments. <em>Quaternary Science Reviews</em> <b>28</b>: 1309&ndash;1316. <a href="https://doi.org/10.1016/j.quascirev.2008.12.020">doi:10.1016/j.quascirev.2008.12.020</a>  </p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(arctic.env)
data(arctic.pollen)

mMAT &lt;- multi.mat(arctic.pollen, arctic.env[,9:67], noanalogues = 5)

</code></pre>

<hr>
<h2 id='obs.cor'>Weighted correlation between weighted averaging optima and constrained
ordination species scores.</h2><span id='topic+obs.cor'></span><span id='topic+plot.obscor'></span><span id='topic+identify.obscor'></span><span id='topic+autoplot.obscor'></span>

<h3>Description</h3>

<p>obs.cor calculates the weighted correlation between the species
weighted average optima and the axis one species scores of an ordination
constrained by the WA reconstruction.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>obs.cor(
  spp,
  env,
  fos,
  ord = rda,
  n = 99,
  min.occur = 1,
  autosim,
  permute = FALSE
)

## S3 method for class 'obscor'
plot(
  x,
  xlab,
  ylab,
  f = 5,
  which = 1,
  variable_names = "env",
  abun = "abun.calib",
  p_val = 0.05,
  ...
)

## S3 method for class 'obscor'
identify(x, labels, ...)

## S3 method for class 'obscor'
autoplot(
  object,
  which = 1,
  variable_names = "env",
  abun = "abun.calib",
  p_val = 0.05,
  nbins = 20,
  top = 0.7,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="obs.cor_+3A_spp">spp</code></td>
<td>
<p>Data frame of modern training set species data, transformed if
required, for example with <code>sqrt</code></p>
</td></tr>
<tr><td><code id="obs.cor_+3A_env">env</code></td>
<td>
<p>Vector of a single environmental variable</p>
</td></tr>
<tr><td><code id="obs.cor_+3A_fos">fos</code></td>
<td>
<p>Data frame of fossil species data. Species codes and
transformations should match those in spp.</p>
</td></tr>
<tr><td><code id="obs.cor_+3A_ord">ord</code></td>
<td>
<p>Constrained ordination method to use.
<code><a href="vegan.html#topic+rda">rda</a></code> is the default,
<code><a href="vegan.html#topic+cca">cca</a></code> should also work.
<code><a href="vegan.html#topic+capscale">capscale</a></code> won't work without modifications to the code
(or a wrapper).</p>
</td></tr>
<tr><td><code id="obs.cor_+3A_n">n</code></td>
<td>
<p>number of random training sets. More is better.</p>
</td></tr>
<tr><td><code id="obs.cor_+3A_min.occur">min.occur</code></td>
<td>
<p>Minimum number of occurrences of species in the species and
fossil data.</p>
</td></tr>
<tr><td><code id="obs.cor_+3A_autosim">autosim</code></td>
<td>
<p>Optional data frame of random values. This is useful if the
training set is spatially autocorrelated and the supplied data frame contains
autocorrelated random variables.
If <code>autosim</code> is missing, and <code>permute</code> is <code>FALSE</code>, the
transfer functions are trained on random variables drawn from a uniform
distribution.</p>
</td></tr>
<tr><td><code id="obs.cor_+3A_permute">permute</code></td>
<td>
<p>logical value. Generate random environmental variables by
permuting existing variable.
Only possible if there is only one environmental variable and <code>autosim</code>
is missing.</p>
</td></tr>
<tr><td><code id="obs.cor_+3A_x">x</code></td>
<td>
<p>An obscor object.</p>
</td></tr>
<tr><td><code id="obs.cor_+3A_xlab">xlab</code></td>
<td>
<p>X-axis label if the default is unsatisfactory.</p>
</td></tr>
<tr><td><code id="obs.cor_+3A_ylab">ylab</code></td>
<td>
<p>Y-axis label if the default is unsatisfactory.</p>
</td></tr>
<tr><td><code id="obs.cor_+3A_f">f</code></td>
<td>
<p>Scale factor for the abundances, the maximum cex of points for the
which=1 plot.</p>
</td></tr>
<tr><td><code id="obs.cor_+3A_which">which</code></td>
<td>
<p>Which type of plot. which = 1 gives a plot of RDA scores against
species optima. which = 2 gives a histogram showing the null distribution of
correlations between RDA scores and species optima, together with the
observed correlation.</p>
</td></tr>
<tr><td><code id="obs.cor_+3A_variable_names">variable_names</code></td>
<td>
<p>Name of environmental variable (only 1 currently) for
the label on the observed correlation with which = 2</p>
</td></tr>
<tr><td><code id="obs.cor_+3A_abun">abun</code></td>
<td>
<p>Which species weighting required for plots. See details</p>
</td></tr>
<tr><td><code id="obs.cor_+3A_p_val">p_val</code></td>
<td>
<p>P value to draw a line vertical line at (with which=2)</p>
</td></tr>
<tr><td><code id="obs.cor_+3A_...">...</code></td>
<td>
<p>Other arguments to plot or identify</p>
</td></tr>
<tr><td><code id="obs.cor_+3A_labels">labels</code></td>
<td>
<p>Labels for the points in identify. By default, the species
names from intersection of colnames(spp) and colnames(fos) are used.</p>
</td></tr>
<tr><td><code id="obs.cor_+3A_object">object</code></td>
<td>
<p>An obscor object.</p>
</td></tr>
<tr><td><code id="obs.cor_+3A_nbins">nbins</code></td>
<td>
<p>integer giving number of bins for the histogram</p>
</td></tr>
<tr><td><code id="obs.cor_+3A_top">top</code></td>
<td>
<p>Proportion of the figure below the environmental name labels.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Obs.cor calculates the (weighted) correlation between the species
WA optima in the calibration set and their ordination axis one scores in the
fossil data. Seven different weights for the species are implemented.
</p>

<ul>
<li><p>&quot;abun.fos&quot; - weight by the mean abundance in the fossil data.
</p>
</li>
<li><p>&quot;abun.calib&quot; - weight by the mean abundance in the calibration data
</p>
</li>
<li><p>&quot;abun.joint&quot; - weight by the product of the mean abundance in the
fossil and calibration data
</p>
</li>
<li><p>&quot;n2.fos&quot; - weight by the effective number of occurrences
(Hill's N2) of each species in the fossil data
</p>
</li>
<li><p>&quot;n2.calib&quot; - weight by the effective number of occurrences
(Hill's N2) of each species in the calibration data
</p>
</li>
<li><p>&quot;n2.joint&quot; - weight by the product of n2.calib and n2.fos
</p>
</li>
<li><p>&quot;unweighted&quot; - all species receive same weight.
This is unlikely to be the best option but is included for completeness.
</p>
</li></ul>

<p>It is unclear which of these weights is likely to be best:
research is in progress.
A square root transformation of the species data is often useful. n = 99
is too small in practice to give a smooth histogram of the null model.
n = 999 is better.
</p>


<h3>Value</h3>

<p>obs.cor returns an obscor object, which is a list
</p>

<ul>
<li><p>ob Observed correlation. Data.frame with columns Optima, RDA1 and
abun containing the species optima, ordination axis 1 scores, and
abundance used to weight the species respectively and a vector containing
the weighted and unweighted correlations between species optima and
ordination scores.
</p>
</li>
<li><p>sim Matrix with the correlation between species weighted average
optima and ordination scores in the first column and the weighted
correlation in the second column. Each row represents a different random
environmental variable.
</p>
</li>
<li><p>sigs p-value for the observed correlation between species weighted
average optima and ordination scores for each of the weights.
</p>
</li></ul>



<h3>Functions</h3>


<ul>
<li> <p><code>plot(obscor)</code>: Plots for obscor object
</p>
</li>
<li> <p><code>identify(obscor)</code>: Identify species on obs.cor plot
</p>
</li>
<li> <p><code>autoplot(obscor)</code>: autoplot for obscor object
</p>
</li></ul>


<h3>Note</h3>

<p>The test of the weighted correlation between species optima and
ordination axis scores is more powerful, especially with a small number of
fossil observations, that the test of variance explained in
<code><a href="#topic+randomTF">randomTF</a></code> but is only applicable to WA and will have a large
type II error if there are few species.
</p>


<h3>Author(s)</h3>

<p>Richard Telford <a href="mailto:richard.telford@uib.no">richard.telford@uib.no</a>
</p>


<h3>References</h3>

<p>Telford, R. J. and Birks, H. J. B. (2011) A novel method for
assessing the statistical significance of quantitative reconstructions
inferred from biotic assemblages. <em>Quaternary Science Reviews</em>
<b>30</b>: 1272&ndash;1278.
<a href="https://doi.org/10.1016/j.quascirev.2011.03.002">doi:10.1016/j.quascirev.2011.03.002</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+randomTF">randomTF</a></code>, <code><a href="rioja.html#topic+WA">WA</a></code>,
<code><a href="vegan.html#topic+rda">rda</a></code>, <code><a href="vegan.html#topic+cca">cca</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(rioja)
data(SWAP)
data(RLGH)
rlgh.obs &lt;- obs.cor(
  spp = sqrt(SWAP$spec),
  env = SWAP$pH,
  fos = sqrt(RLGH$spec),
  n = 49 # low number for speed
)
rlgh.obs$sig
plot(rlgh.obs, which = 1)
plot(rlgh.obs, which = 2)

require(ggplot2)
autoplot(rlgh.obs, which = 1)
autoplot(rlgh.obs, which = 2, variable_names = "pH")
</code></pre>

<hr>
<h2 id='palaeoSig-package'>
Significance Tests of Quantitative Palaeoenvironmental Reconstructions 
</h2><span id='topic+palaeoSig-package'></span><span id='topic+palaeoSig'></span>

<h3>Description</h3>

<p>Significance tests for quantitative palaeoenvironmental reconstructions derived from transfer functions.
Functions from the <span class="pkg">autocorTF</span> package are now included in <span class="pkg">palaeoSig</span>.
</p>


<h3>Details</h3>

<p>This package includes:
</p>
<p>significance tests for quantitative palaeoenvironmental reconstructions (<code><a href="#topic+randomTF">randomTF</a></code>, <code><a href="#topic+obs.cor">obs.cor</a></code>)  
</p>
<p>graphical methods to show autocorrelation in transfer functions (<code><a href="#topic+rne">rne</a></code>)                                       
</p>
<p>null model test of transfer functions performance in a spatially autocorrelated environment - see vignette. 
</p>
<p>Several functions have from <span class="pkg">autocorTF</span> version 1.0 and <span class="pkg">palaeoSig</span> version 1.0 have been rewritten or replaced with more flexible or user friendly functions. See <code>news(package="palaeoSig")</code> for details.
</p>
<p>See also my blog at https://quantpalaeo.wordpress.com/
</p>

<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> palaeoSig</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 2.0-7</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2022-11-29</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL - 3</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Richard Telford <a href="mailto:richard.telford@uib.no">richard.telford@uib.no</a>
</p>


<h3>References</h3>

<p>Telford, R. J. and Birks, H. J. B. (2009) Evaluation of transfer functions in spatially structured environments. <em>Quaternary Science Reviews</em> <b>28</b>: 1309&ndash;1316. <a href="https://doi.org/10.1016/j.quascirev.2008.12.020">doi:10.1016/j.quascirev.2008.12.020</a>  
</p>
<p>Telford, R. J. and Birks, H. J. B. (2011) A novel method for assessing the statistical significance of quantitative reconstructions inferred from biotic assemblages. <em>Quaternary Science Reviews</em> <b>30</b>: 1272&ndash;1278. <a href="https://doi.org/10.1016/j.quascirev.2011.03.002">doi:10.1016/j.quascirev.2011.03.002</a>
</p>


<h3>See Also</h3>

<p><code><a href="rioja.html#topic+rioja-package">rioja</a></code>, <code><a href="vegan.html#topic+rda">rda</a></code>
</p>

<hr>
<h2 id='plot.fittedAgelme'>Plots fitted agelme model and dates</h2><span id='topic+plot.fittedAgelme'></span>

<h3>Description</h3>

<p>Plots fitted agelme model and dates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'fittedAgelme'
plot(x, main, xlab = "Depth", ylab = "Calibrated Age", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.fittedAgelme_+3A_x">x</code></td>
<td>
<p>Fitted agelme model.</p>
</td></tr>
<tr><td><code id="plot.fittedAgelme_+3A_main">main</code></td>
<td>
<p>Title of the plot.</p>
</td></tr>
<tr><td><code id="plot.fittedAgelme_+3A_xlab">xlab</code></td>
<td>
<p>x axis label of the plot.</p>
</td></tr>
<tr><td><code id="plot.fittedAgelme_+3A_ylab">ylab</code></td>
<td>
<p>y axis label of the plot.</p>
</td></tr>
<tr><td><code id="plot.fittedAgelme_+3A_...">...</code></td>
<td>
<p>Other arguments to plot.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>data(STOR)
fit.mod &lt;- with(STOR, agelme(depthup, depthdo, cageup, cagedo))
#Predicting using the constant variance model,
#for each cm between 70 and 400 cm.
fit.pre &lt;- predict(fit.mod, 1, 70:400)
plot(fit.pre)
</code></pre>

<hr>
<h2 id='plot.RNE'>Random, neighbour, environment deletion analysis for transfer function
models</h2><span id='topic+plot.RNE'></span><span id='topic+rne'></span>

<h3>Description</h3>

<p>Calculates effect of deleting sites from training set at random,
from a geographic neighbourhood, or from an environmental neighbourhood.
A simple graphical technique for gauging the effect of spatial
autocorrelation on the transfer function model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'RNE'
plot(x, which = 1, ylim, ...)

rne(
  y,
  env,
  geodist,
  fun,
  neighbours,
  subsets = c(1, 0.75, 0.5, 0.25, 0.1),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.RNE_+3A_x">x</code></td>
<td>
<p>RNE object to be plotted</p>
</td></tr>
<tr><td><code id="plot.RNE_+3A_which">which</code></td>
<td>
<p>Which column of the results to plot eg if more than one WAPLS
component is calculated</p>
</td></tr>
<tr><td><code id="plot.RNE_+3A_ylim">ylim</code></td>
<td>
<p>Y-limits of the plot</p>
</td></tr>
<tr><td><code id="plot.RNE_+3A_...">...</code></td>
<td>
<p>Arguments passed to fun</p>
</td></tr>
<tr><td><code id="plot.RNE_+3A_y">y</code></td>
<td>
<p>Community data, or distance object, or distance matrix</p>
</td></tr>
<tr><td><code id="plot.RNE_+3A_env">env</code></td>
<td>
<p>Environmental variable</p>
</td></tr>
<tr><td><code id="plot.RNE_+3A_geodist">geodist</code></td>
<td>
<p>Matrix of geographical distances between sites</p>
</td></tr>
<tr><td><code id="plot.RNE_+3A_fun">fun</code></td>
<td>
<p>Transfer function</p>
</td></tr>
<tr><td><code id="plot.RNE_+3A_neighbours">neighbours</code></td>
<td>
<p>Neighbourhood radii</p>
</td></tr>
<tr><td><code id="plot.RNE_+3A_subsets">subsets</code></td>
<td>
<p>Proportion of sites to retain in random deletion</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Finds the leave-one-out transfer function performance if sites are
deleted at random, from a
neighbourhood zone, or by deleting environmentally close sites.
</p>
<p>Prior to version 2.1, this function would repeat the random removal 10 times
to reduce variance in results.
This is no longer done as the variance is small for large training sets,
it took a long time, and treats one treatment of the data differently.
</p>


<h3>Value</h3>

<p>Returns an RNE object, list with two components
</p>

<ul>
<li><p>random Performance with random deletion.
</p>
</li>
<li><p>neighbour Performance with deletion by neighbourhood,
or environment
</p>
</li></ul>



<h3>Functions</h3>


<ul>
<li> <p><code>plot(RNE)</code>: Plot RNE object
</p>
</li></ul>


<h3>Author(s)</h3>

<p>Richard Telford <a href="mailto:Richard.Telford@bio.uib.no">Richard.Telford@bio.uib.no</a>
</p>


<h3>References</h3>

<p>Telford, R. J. and Birks, H. J. B. (2009) Evaluation of transfer
functions in spatially structured environments.
<em>Quaternary Science Reviews</em> <b>28</b>: 1309&ndash;1316.
<a href="https://doi.org/10.1016/j.quascirev.2008.12.020">doi:10.1016/j.quascirev.2008.12.020</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(rioja)
require(sf)
data(arctic.env)
data(arctic.pollen)

# using just the first 100 sites so that code runs quickly (about 15 seconds for all 828 sites)

# convert environmental data into an sf object
arctic.env &lt;- st_as_sf(
  x = arctic.env,
  coords = c("Longitude", "Latitude"),
  crs = 4326
)

# find great circle distances and remove units
arctic.dist &lt;- st_distance(arctic.env[1:100, ]) |&gt;
  units::set_units("km") |&gt;
  units::set_units(NULL)

# rne
arctic.rne &lt;- rne(
  y = arctic.pollen[1:100, ], env = arctic.env$tjul[1:100],
  geodist = arctic.dist, fun = MAT, neighbours = c(0, 200),
  subsets = c(1, .5), k = 5
)

plot(arctic.rne)
</code></pre>

<hr>
<h2 id='predict.agelme'> Predicts the Calibrated age </h2><span id='topic+predict.agelme'></span>

<h3>Description</h3>

<p>This function uses the output from 'agelme' to predict the Calibrated ages for specified depths.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'agelme'
predict(object, v = 1, depth,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.agelme_+3A_object">object</code></td>
<td>
<p> An 'agelme' model </p>
</td></tr>
<tr><td><code id="predict.agelme_+3A_v">v</code></td>
<td>
<p>Using constant (1) or mu (2) variance </p>
</td></tr>
<tr><td><code id="predict.agelme_+3A_depth">depth</code></td>
<td>
<p> A vector of the depths to be predicted </p>
</td></tr>
<tr><td><code id="predict.agelme_+3A_...">...</code></td>
<td>
<p>Other arguments, currently unused.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with three items
</p>

<ul>
<li><p>v Whether constant variance or mu variance used.
</p>
</li>
<li><p>fit A data.frame of the predictions including 95% confidence interval.
</p>

<ul>
<li><p>DepthThe depths for the predicted ages
</p>
</li>
<li><p>EstagePredicted age
</p>
</li>
<li><p>LowlimLower 95% confidence interval
</p>
</li>
<li><p>UpplimUpper 95% confidence interval
</p>
</li>
<li><p>TsdTotal standard deviation
</p>
</li></ul>

</li>
<li><p>data A data.frame containing the age and depth information of the radiocarbon dates.
</p>
</li></ul>



<h3>Author(s)</h3>

<p> Einar Heegaard &lt;einar.heegaard@bio.bui.no </p>


<h3>References</h3>

<p> Heegaard, E., Birks, HJB. &amp; Telford, RJ. 2005. Relationships between calibrated ages and depth in stratigraphical sequences: an estimation procedure by mixed-effect regression. The Holocene 15: 612-618</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(STOR)

fit.mod &lt;- with(STOR,agelme(depthup,depthdo,cageup,cagedo))

#Predicting using the constant variance model,
#for each cm between 70 and 400 cm.
fit.pre &lt;- predict(fit.mod,1,70:400)
plot(fit.pre)
</code></pre>

<hr>
<h2 id='randomTF'>Proportion of variance in the fossil data explained by an
environmental reconstruction</h2><span id='topic+randomTF'></span><span id='topic+plot.palaeoSig'></span><span id='topic+autoplot.palaeoSig'></span>

<h3>Description</h3>

<p>Calculate the proportion of variance in the fossil data
explained by an environmental reconstruction with a constrained ordination.
This value is compared with a null distribution calculated as the proportion
of variance in the fossil data explained by reconstructions from transfer
functions trained on random data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>randomTF(
  spp,
  env,
  fos,
  n = 99,
  fun,
  col,
  condition = NULL,
  autosim,
  ord = rda,
  permute = FALSE,
  models,
  make_models = FALSE,
  ...
)

## S3 method for class 'palaeoSig'
plot(x, variable_names, top = 0.7, adj = c(0, 0.5), p_val = 0.05, ...)

## S3 method for class 'palaeoSig'
autoplot(object, variable_names, nbins = 20, top = 0.7, p_val = 0.05, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="randomTF_+3A_spp">spp</code></td>
<td>
<p>Data frame of modern training set species data, transformed as
required for example with <code>sqrt</code></p>
</td></tr>
<tr><td><code id="randomTF_+3A_env">env</code></td>
<td>
<p>Data frame of training set environmental variables or vector with
single environmental variable</p>
</td></tr>
<tr><td><code id="randomTF_+3A_fos">fos</code></td>
<td>
<p>Data frame of fossil species data, with same species codes and
transformations as <code>spp</code></p>
</td></tr>
<tr><td><code id="randomTF_+3A_n">n</code></td>
<td>
<p>number of random training sets. More is better.</p>
</td></tr>
<tr><td><code id="randomTF_+3A_fun">fun</code></td>
<td>
<p>Transfer function method.
Additional arguments to <code>fun</code> can be passed with <code>...</code></p>
</td></tr>
<tr><td><code id="randomTF_+3A_col">col</code></td>
<td>
<p>Some transfer functions return more than one column of results,
for example with different <code><a href="rioja.html#topic+WAPLS">WAPLS</a></code> components.
<code>col</code> selects which column of the reconstructions to use.
See the relevant transfer function method help file.</p>
</td></tr>
<tr><td><code id="randomTF_+3A_condition">condition</code></td>
<td>
<p>Optional data frame of reconstructions to partial out when
testing if multiple independent reconstructions are possible.</p>
</td></tr>
<tr><td><code id="randomTF_+3A_autosim">autosim</code></td>
<td>
<p>Optional data frame of random values.
This is useful if the training set is spatially autocorrelated and the
supplied data frame contains autocorrelated random variables.
If <code>autosim</code> is missing, and <code>permute</code> is <code>FALSE</code>, the
transfer functions are trained on random variables drawn from a uniform
distribution.</p>
</td></tr>
<tr><td><code id="randomTF_+3A_ord">ord</code></td>
<td>
<p>Constrained ordination method to use. <code><a href="vegan.html#topic+rda">rda</a></code> is
the default, <code><a href="vegan.html#topic+cca">cca</a></code> should also work.
<code><a href="vegan.html#topic+capscale">capscale</a></code> won't work without modifications to the code
(or a wrapper).</p>
</td></tr>
<tr><td><code id="randomTF_+3A_permute">permute</code></td>
<td>
<p>logical value. Generate random environmental variables by
permuting existing variable. Only possible if there is only one environmental
variable and <code>autosim</code> is missing.</p>
</td></tr>
<tr><td><code id="randomTF_+3A_models">models</code></td>
<td>
<p>list of models made by <code>randomTF</code> with argument
<code>make_models = TRUE</code></p>
</td></tr>
<tr><td><code id="randomTF_+3A_make_models">make_models</code></td>
<td>
<p>logical, should a list of transfer functions trained on
random data be returned</p>
</td></tr>
<tr><td><code id="randomTF_+3A_...">...</code></td>
<td>
<p>Other arguments to the transfer function. For example to change
the distance metric in <code><a href="rioja.html#topic+MAT">MAT</a></code>.
Also extra arguments to plot.</p>
</td></tr>
<tr><td><code id="randomTF_+3A_x">x</code></td>
<td>
<p>Output from randomTF</p>
</td></tr>
<tr><td><code id="randomTF_+3A_variable_names">variable_names</code></td>
<td>
<p>Names of environmental variables. If missing, taken
from <code>env</code> data.frame.</p>
</td></tr>
<tr><td><code id="randomTF_+3A_top">top</code></td>
<td>
<p>Proportion of the figure below the environmental name labels.</p>
</td></tr>
<tr><td><code id="randomTF_+3A_adj">adj</code></td>
<td>
<p>Adjust the position that the environmental names are plotted at.</p>
</td></tr>
<tr><td><code id="randomTF_+3A_p_val">p_val</code></td>
<td>
<p>P value to draw a line vertical line at (with which=2)</p>
</td></tr>
<tr><td><code id="randomTF_+3A_object">object</code></td>
<td>
<p>Output from randomTF</p>
</td></tr>
<tr><td><code id="randomTF_+3A_nbins">nbins</code></td>
<td>
<p>integer giving number of bins for the histogram</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function calculates the proportion of variance in the fossil
data explained by the transfer function reconstruction.
This is compared with a null distribution of the proportion of variance
explained by reconstructions based on random environmental variables.
Reconstructions can be partialled out to test if multiple reconstructions are
statistically significant. If the environment is spatially autocorrelated, a
red-noise null should be used instead of the default white noise null.
Red noise environmental variables can be generated with the <span class="pkg">gstat</span>
package.
</p>
<p>Any transfer function in the <span class="pkg">rioja</span> package can be used. Other methods
(e.g. random forests) can be used by making a wrapper function.
</p>
<p>If reconstructions from several sites are to be tested using the same
training set it can be much faster to train the models on random
environmental data once and then use them repeatedly.
This can be done with <code>make_models = TRUE</code> and then running
<code>randomTF</code> again giving the resultant models to the <code>models</code>
argument.
<code>make_models</code> does not work with MAT.
</p>
<p>For some transfer function methods, including <code>WA</code>, the code can be made
somewhat faster by coercing the modern and fossil species data to matrices
(<code>spp &lt;- as.matrix(spp)</code>), otherwise <code>WA</code> has to do this repeatedly.
With <code>MAT</code>, this should not be done as it might cause an error.
</p>


<h3>Value</h3>

<p>A list with components
</p>

<ul>
<li><p>PCA The unconstrained ordination of the fossil data.
</p>
</li>
<li><p>preds A list of the containing the reconstructions for each
environmental variable.
</p>
</li>
<li><p>MAX Proportion of the variance explained by the first axis of the
unconstrained ordination.
This is the maximum amount that a reconstruction of a single variable can
explain.
</p>
</li>
<li><p>EX The proportion of the variance in the fossil data explained by
each reconstruction.
</p>
</li>
<li><p>sim.ex The proportion of variance explained by each of the random
environmental variables.
</p>
</li>
<li><p>sig The p-value of each reconstruction.
</p>
</li></ul>

<p>If <code>make_models = TRUE</code>, a list of transfer function models is returned.
</p>
<p><code>autoplot.palaeoSig</code> returns a <code>ggplot2</code> object
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>plot(palaeoSig)</code>: Plot palaeoSig object
</p>
</li>
<li> <p><code>autoplot(palaeoSig)</code>: autoplot function for palaeoSig object
</p>
</li></ul>


<h3>Note</h3>

<p>If there are only a few fossil levels, <code><a href="#topic+obs.cor">obs.cor</a></code> might have
more power.
If there are few taxa, tests on <code><a href="rioja.html#topic+MAT">MAT</a></code> reconstructions have
more statistical power than those based on <code><a href="rioja.html#topic+WA">WA</a></code>.
</p>


<h3>Author(s)</h3>

<p>Richard Telford <a href="mailto:richard.telford@uib.no">richard.telford@uib.no</a>
</p>


<h3>References</h3>

<p>Telford, R. J. and Birks, H. J. B. (2011) A novel method for
assessing the statistical significance of quantitative reconstructions
inferred from biotic assemblages. <em>Quaternary Science Reviews</em>
<b>30</b>: 1272&ndash;1278.
<a href="https://doi.org/10.1016/j.quascirev.2011.03.002">doi:10.1016/j.quascirev.2011.03.002</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+obs.cor">obs.cor</a></code>, <code><a href="rioja.html#topic+WA">WA</a></code>,
<code><a href="rioja.html#topic+MAT">MAT</a></code>, <code><a href="rioja.html#topic+WAPLS">WAPLS</a></code>,
<code><a href="vegan.html#topic+rda">rda</a></code>, <code><a href="vegan.html#topic+cca">cca</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(rioja)
data(SWAP)
data(RLGH)
rlghr &lt;- randomTF(
  spp = sqrt(SWAP$spec), env = data.frame(pH = SWAP$pH),
  fos = sqrt(RLGH$spec), n = 49, fun = WA, col = "WA.inv"
)
rlghr$sig
plot(rlghr, "pH")

require("ggplot2")
autoplot(rlghr, "pH")
</code></pre>

<hr>
<h2 id='species'> Generates species response parameters for n dimensions

</h2><span id='topic+species'></span>

<h3>Description</h3>

<p> Generates species response parameters to n environmental variables following Minchin (1987). 

</p>


<h3>Usage</h3>

<pre><code class='language-R'>species(nspp = 30, Amax, fun, xpar, srange, alpha = 4, 
        gamma= 4, ndim, sdistr, ocor, odistr)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="species_+3A_nspp">nspp</code></td>
<td>
<p> Number of species to be generated.

</p>
</td></tr>
<tr><td><code id="species_+3A_amax">Amax</code></td>
<td>
<p> Maximum abundance of a species. 'Amax' currently allows three options: i) a function how to generate maximum abundances (e.g. 'runif', 'rgamma') ii) a vector of length 'nspp'  iii) a single number that is used as maximum abundance for all the species.  

</p>
</td></tr>
<tr><td><code id="species_+3A_fun">fun</code></td>
<td>
<p> Function to generate species optima (e.g. 'rnorm', 'runif'). The two parameters in 'xpar' are passed to function 'fun'. If omitted species optima are generated 
at regular intervals between the two values in 'xpar'.  

</p>
</td></tr>   
<tr><td><code id="species_+3A_xpar">xpar</code></td>
<td>
<p> Two numbers describing a distribution e.g mu and sigma for a normal distribution, lower and upper bound for a random uniform distribution. 

</p>
</td></tr>
<tr><td><code id="species_+3A_srange">srange</code></td>
<td>
<p> Length of the ecological gradient to which individual species respond. Either one number or a matrix with 'nspp' rows and 'ndim' columns. If 'srange' should be different for different environmental variables a simpler solution is to change argument elen in <code><a href="#topic+make.env">make.env</a></code> accordingly. E.g. 'elen = c(100,50,50)' when using three environmental gradients.  

</p>
</td></tr>    
<tr><td><code id="species_+3A_alpha">alpha</code></td>
<td>
<p> Shape parameter of the beta distribution. One number or a matrix with 'nspp' rows and 'ndim' columns.

</p>
</td></tr>
<tr><td><code id="species_+3A_gamma">gamma</code></td>
<td>
<p> Shape parameter of the beta distribution. One number or a matrix with 'nspp' rows and 'ndim' columns.

</p>
</td></tr>
<tr><td><code id="species_+3A_ndim">ndim</code></td>
<td>
<p> Number of environmental variables to which generated species should respond.

</p>
</td></tr>
<tr><td><code id="species_+3A_sdistr">sdistr</code></td>
<td>
<p> Users may supply own distributions of species optima. Matrix with 'nspp' rows and 'ndim' columns (as well in the special case of 'ndim = 1').  

</p>
</td></tr>
<tr><td><code id="species_+3A_ocor">ocor</code></td>
<td>
<p> Correlation matrix of the species optima. May be generated by code <a href="#topic+cor.mat.fun">cor.mat.fun</a>. 

</p>
</td></tr>
<tr><td><code id="species_+3A_odistr">odistr</code></td>
<td>
<p> Distribution of the correlated optima either 'uniform' or 'Gaussian'

</p>
</td></tr>
</table>


<h3>Details</h3>

<p> Details on the exact generation of species response functions from parameters 'Amax', 'm', 'r', 'gamma' and 'alpha' are given in Minchin (1987). Species response curves are determined by five parameters: a parameter determining the maximum abundance ('Amax') and one describing the location ('m') of this mode. A parameter determining to which environmental range the species respond ('srange' in the input 'r' in the output) and two parameters ('alpha', 'gamma') describing the shape of the species response function. If 'alpha' = 'gamma' the response curve is symmetric ('alpha' = 'gamma' = 4, yields Gaussian distributions). Additionally, species optima for several environmental variables may be correlated. Currently this is only possible for gaussian or uniform distributions of species optima. Users may as well supply previously generated optima (e.g. optima similar to a real dataset). 
</p>



<h3>Value</h3>

<p> List with 'ndim' elements. Each list contains the species response parameters to one environmental gradient.     





</p>


<h3>Author(s)</h3>

<p> Mathias Trachsel and Richard J. Telford

</p>


<h3>References</h3>

<p> Minchin, P.R. (1987) Multidimensional Community Patterns: Towards a Comprehensive Model. Vegetatio, 71, 145-156.

</p>


<h3>Examples</h3>

<pre><code class='language-R'>spec.par &lt;- species(nspp = 30, Amax = runif, srange = 200, fun = runif, xpar = c(-50, 150),  
ndim = 5, alpha = 4, gamma = 4)
spec.par &lt;- species(nspp = 30, ndim = 3, Amax = runif, xpar = c(-50, 150), 
srange = 200, alpha = 4, gamma = 4) 

# example where srange, alpha and gamma are different for each species and environmental gradient. 
spec.par &lt;- species(nspp = 30, ndim = 3, Amax = runif, xpar = c(-50, 150), 
srange = matrix(ncol = 3, runif(90, 100, 200)), alpha = matrix(ncol = 3, runif(90, 1, 5)), 
gamma = matrix(ncol = 3, runif(90, 1, 5)))

# example where species optima are correlated
correlations &lt;- list(c(1, 2, 0.5), c(1, 3, 0.3), c(2, 3, 0.1))
spec.cor.mat &lt;- cor.mat.fun(3, correlations)
spec.par &lt;- species(nspp = 30, ndim = 3, Amax = runif, xpar = c(50, 50), srange = 200, 
alpha = 4, gamma = 4,ocor = spec.cor.mat, odistr = 'Gaussian')           

# example for species response curves (users should alter alpha and gamma)
spec.par &lt;- species(nspp = 1, Amax = 200, srange = 200, fun = runif, xpar = c(50, 50),  
    ndim = 1, alpha = 3, gamma = 1)
env &lt;- -50:150
response &lt;- palaeoSig:::make.abundances(env = -50:150, param = spec.par[[1]]$spp)
plot(env, response, type='l') 
                                                                                                       
</code></pre>

<hr>
<h2 id='STOR'>Storsandsvatnet</h2><span id='topic+STOR'></span>

<h3>Description</h3>

<p>Storsandsvatnet is a lake in western Norway. From the sediments
a core was obtained, and 11 samples was submitted for radiocarbon dating.
The data contain the depths of the slides dated and the younger and older
calibrated ages for each slide.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(STOR)
</code></pre>


<h3>Format</h3>

<p>A data.frame with 11 observations on the following 4 variables.
</p>

<dl>
<dt>depthup</dt><dd><p>The upper border of the dated slide</p>
</dd>
<dt>depthdo</dt><dd><p>The lower border of the dated slide</p>
</dd>
<dt>cageup</dt><dd><p>The younger calibrated age of the dated slide</p>
</dd>
<dt>cagedo</dt><dd><p>The older calibrated age of the dated slide</p>
</dd>
</dl>



<h3>Details</h3>

<p>The calibrated ages is obtained by calibration of the radiocarbon
dates.
The borders represent mean calibrated age +/- 1 SD of calibrated age.
</p>


<h3>Source</h3>

<p>The data are unpublished and provided by H. John B. Birks
<a href="mailto:john.birks@bio.uib.no">john.birks@bio.uib.no</a> and Sylvia M. Peglar
</p>


<h3>References</h3>

<p>Heegaard, E., Birks, HJB. &amp; Telford, RJ. 2005. Relationships
between calibrated ages and depth in stratigraphical sequences: an estimation
procedure by mixed-effect regression. The Holocene 15: 612-618 <a href="https://doi.org/10.1191/0959683605hl836rr">doi:10.1191/0959683605hl836rr</a>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
