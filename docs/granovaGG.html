<!DOCTYPE html><html><head><title>Help for package granovaGG</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {granovaGG}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#anorexia'><p>Anorexia Data on Weight Change</p></a></li>
<li><a href='#anorexia.sub'><p>Family Treatment Weight change data for young female anorexia patients (subset).</p></a></li>
<li><a href='#arousal'><p>Arousal in Rats</p></a></li>
<li><a href='#blood_lead'><p>Blood lead levels of lead workers' children matched with similar control</p>
children.</a></li>
<li><a href='#granovaGG-package'><p>Elemental Graphics for Analysis of Variance Using ggplot2</p></a></li>
<li><a href='#granovagg.1w'><p>Elemental Graphic Display for One-Way ANOVA</p></a></li>
<li><a href='#granovagg.contr'><p>Elemental Graphic Display for Contrast Effect of ANOVA</p></a></li>
<li><a href='#granovagg.ds'><p>Elemental Graphic for Display of Dependent Sample Data</p></a></li>
<li><a href='#poison'><p>Poison data from Biological Experiment</p></a></li>
<li><a href='#rat'><p>Weight gains of rats fed different diets</p></a></li>
<li><a href='#shoes'><p>Shoe wear data of Box, Hunter and Hunter</p></a></li>
<li><a href='#tobacco'><p>Virus Preparation on Tobacco Leaves</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>1.4.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-11-22</td>
</tr>
<tr>
<td>Title:</td>
<td>Graphical Analysis of Variance Using ggplot2</td>
</tr>
<tr>
<td>Description:</td>
<td>Create what we call Elemental Graphics for display of
    anova results. The term elemental derives from the fact
    that each function is aimed at construction of
    graphical displays that afford direct visualizations of
    data with respect to the fundamental questions that
    drive the particular anova methods. This package
    represents a modification of the original granova
    package; the key change is to use 'ggplot2', Hadley
    Wickham's package based on Grammar of Graphics concepts
    (due to Wilkinson). The main function is granovagg.1w()
    (a graphic for one way ANOVA); two other functions
    (granovagg.ds() and granovagg.contr()) are to construct
    graphics for dependent sample analyses and
    contrast-based analyses respectively. (The function
    granova.2w(), which entails dynamic displays of data, is
    not currently part of 'granovaGG'.) The 'granovaGG'
    functions are to display data for any number of groups,
    regardless of their sizes (however, very large data
    sets or numbers of groups can be problematic). For
    granovagg.1w() a specialized approach is used to
    construct data-based contrast vectors for which anova
    data are displayed. The result is that the graphics use
    a straight line to facilitate clear interpretations
    while being faithful to the standard effect test in
    anova. The graphic results are complementary to
    standard summary tables; indeed, numerical summary
    statistics are provided as side effects of the graphic
    constructions. granovagg.ds() and granovagg.contr() provide
    graphic displays and numerical outputs for a dependent
    sample and contrast-based analyses. The graphics based
    on these functions can be especially helpful for
    learning how the respective methods work to answer the
    basic question(s) that drive the analyses. This means
    they can be particularly helpful for students and
    non-statistician analysts. But these methods can be of
    assistance for work-a-day applications of many kinds,
    as they can help to identify outliers, clusters or
    patterns, as well as highlight the role of non-linear
    transformations of data. In the case of granovagg.1w()
    and granovagg.ds() several arguments are provided to
    facilitate flexibility in the construction of graphics
    that accommodate diverse features of data, according to
    their corresponding display requirements. See the help
    files for individual functions.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/briandk/granovaGG">https://github.com/briandk/granovaGG</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/briandk/granovaGG/issues">https://github.com/briandk/granovaGG/issues</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.14.0),</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr, ggplot2 (&ge; 0.9.2), magrittr, RColorBrewer, tibble,
tidyr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Collate:</td>
<td>'granovaGG-package.R' 'granovagg.1w-helpers.R'
'theme-defaults.R' 'shared-functions.R' 'granovagg.1w.R'
'granovagg.contr.R' 'granovagg.ds.R'</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-11-22 22:46:24 UTC; briandk</td>
</tr>
<tr>
<td>Author:</td>
<td>Brian A. Danielak <a href="https://orcid.org/0000-0003-4279-6708"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre, cph],
  Robert M. Pruzek [aut],
  William E. J. Doane
    <a href="https://orcid.org/0000-0002-5047-8286"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [ctb],
  James E. Helmreich [ctb],
  Jason Bryer [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Brian A. Danielak &lt;briandanielak+granovagg@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-11-23 08:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='anorexia'>Anorexia Data on Weight Change</h2><span id='topic+anorexia'></span>

<h3>Description</h3>

<p>The anorexia data frame has 72 rows and 3 columns. Weight change data for young female anorexia patients.
</p>


<h3>Format</h3>

<p>A dataframe with 72 observations of three variables:
</p>

<dl>
<dt>Treat</dt><dd><p>Factor of three levels: &quot;<code>Cont</code>&quot; (control), &quot;<code>CBT</code>&quot; (Cognitive Behavioural treatment) and &quot;<code>FT</code>&quot; (family treatment).</p>
</dd>
<dt>Prewt</dt><dd><p>Pretreatment weight of subject, in pounds.</p>
</dd>
<dt>Postwt</dt><dd><p>Postreatment weight of subject, in pounds.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Hand, D. J., Daly, F., McConway, K., Lunn, D. and Ostrowski, E. eds
(1993) A Handbook of Small Data Sets. Chapman &amp; Hall, Data set 285 (p.
229)
</p>


<h3>References</h3>

<p>Venables, W. N. and Ripley, B. D. (2002) Modern Applied
Statistics with S. Fourth edition. Springer.
</p>

<hr>
<h2 id='anorexia.sub'>Family Treatment Weight change data for young female anorexia patients (subset).</h2><span id='topic+anorexia.sub'></span>

<h3>Description</h3>

<p>The MASS package includes the dataset <code>anorexia</code>, containing pre and
post treatment weights for young female anorexia patients.  This is a subset
of those data, containing only those patients who received Family Treatment.
</p>


<h3>Format</h3>

<p>A dataframe with 17 observations on the following 2 variables, no
NAs.
</p>

<dl>
<dt><code>Prewt</code></dt><dd><p>Pretreatment weight of subject, in pounds.</p>
</dd>
<dt><code>Postwt</code></dt><dd><p>Postreatment weight of subject, in pounds.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Hand, D. J., Daly, F., McConway, K., Lunn, D. and Ostrowski, E. eds
(1993) A Handbook of Small Data Sets. Chapman &amp; Hall, Data set 285 (p.
229)
</p>


<h3>References</h3>

<p>Venables, W. N. and Ripley, B. D. (2002) Modern Applied
Statistics with S. Fourth edition. Springer.
</p>

<hr>
<h2 id='arousal'>Arousal in Rats</h2><span id='topic+arousal'></span>

<h3>Description</h3>

<p>40 rats were given divided randomly into four groups and assigned to one of
four treatments: placebo, drug A, drug B, or both drug A and drug B.
Response is a standard measure of physiological arousal.
</p>


<h3>Format</h3>

<p>A data frame with 40 observations, 10 in each of 4 columns the
corresponding to placebo, drug A, drug B and both drug A and drug B; no
NAs.
</p>

<dl>
<dt>Placebo</dt><dd><p>Rats receiving a placebo treatment.</p>
</dd>
<dt>Drug.A</dt><dd><p>Rats receiving only drug A.</p>
</dd>
<dt>Drug.B</dt><dd><p>Rats receiving only drug B.</p>
</dd>
<dt>Drug.A.B</dt><dd><p>Rats receiving both drug A and drug B.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Richard Lowry. Concepts &amp; Applications of Inferential Statistics.
Vassar College, Poughkeepsie, N.Y., 2010,
http://faculty.vassar.edu/lowry/webtext.html
</p>

<hr>
<h2 id='blood_lead'>Blood lead levels of lead workers' children matched with similar control
children.</h2><span id='topic+blood_lead'></span>

<h3>Description</h3>

<p>Children of parents who had worked in a factory where lead was used in
making batteries were matched by age, exposure to traffic, and neighborhood
with children whose parents did not work in lead-related industries. Whole
blood was assessed for lead content yielding measurements in mg/dl
</p>


<h3>Format</h3>

<p>A dataframe with 33 observations on the following 2 variables, no
NAs.
</p>

<dl>
<dt>Exposed</dt><dd><p>Blood lead level of exposed child, mg/dl.</p>
</dd>
<dt>Control</dt><dd><p>Blood lead level of exposed child, mg/dl.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Morton, D., Saah, A., Silberg, S., Owens, W., Roberts, M., Saah, M.
(1982). Lead absorption in children of employees in a lead related
industry. American Journal of Epidemiology, 115:549-555.
</p>


<h3>References</h3>

<p>See discussion in Section 2.5 of Enhancing Dependent Sample
Analyses with Graphics, Journal of Statistics Education Volume 17, Number
1 (March 2009).
</p>

<hr>
<h2 id='granovaGG-package'>Elemental Graphics for Analysis of Variance Using ggplot2</h2><span id='topic+granovaGG-package'></span><span id='topic+granovaGG'></span>

<h3>Description</h3>

<p>This collection of functions in granovaGG provides what we call
elemental graphics for display of anova results. The term
elemental derives from the fact that each function is
aimed at construction of graphical displays that afford
direct visualizations of data with respect to the
fundamental questions that drive the particular anova
methods. This package represents a modification of the
original granova package; the key change is to use ggplot2,
Hadley Wickham's package based on Grammar of Graphics
concepts (due to Wilkinson). The main function is granovagg.1w
(a graphic for one way anova); two other functions (granovagg.ds
and granovagg.contr) are to construct graphics for dependent
sample analyses and contrast-based analyses respectively. (The
function granova.2w, which entails dynamic displays of data, is
not currently part of granovaGG.) The granovaGG functions are
to display data for any number of groups, regardless of
their sizes (however, very large data sets or numbers of
groups can be problematic). For granovagg.1w a
specialized approach is used to construct data-based
contrast vectors for which anova data are displayed. The
result is that the graphics use a straight line to facilitate clear
interpretations while being faithful to the standard
effect test in anova. The graphic results are
complementary to standard summary tables; indeed, numerical
summary statistics are provided as side effects of the graphic
constructions. granovagg.ds and granovagg.contr provide
graphic displays and numerical outputs for a dependent
sample and contrast-based analyses. The graphics based on
these functions can be especially helpful for learning
how the respective methods work to answer the basic
question(s) that drive the analyses. This means they can be particularly
helpful for students and non-statistician analysts. But
these methods can be of assistance for work-a-day
applications of many kinds, as they can help to
identify outliers, clusters or patterns, as well as
highlight the role of non-linear transformations of data.
In the case of granovagg.1w and granovagg.ds
several arguments are provided to facilitate flexibility
in the construction of graphics that accommodate diverse
features of data, according to their corresponding
display requirements. See the help files for individual
functions.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
  Package: </td><td style="text-align: left;"> granovaGG</td>
</tr>
<tr>
 <td style="text-align: left;">
  Version: </td><td style="text-align: left;"> 1.0</td>
</tr>
<tr>
 <td style="text-align: left;">
  License: </td><td style="text-align: left;"> GPL (&gt;= 2)</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Brian A. Danielak <a href="mailto:brian@briandk.com">brian@briandk.com</a><br />
Robert M. Pruzek <a href="mailto:RMPruzek@yahoo.com">RMPruzek@yahoo.com</a>
</p>
<p>with contributions by:<br />
William E. J. Doane <a href="mailto:wil@DrDoane.com">wil@DrDoane.com</a><br />
James E. Helmreich <a href="mailto:James.Helmreich@Marist.edu">James.Helmreich@Marist.edu</a><br />
Jason Bryer <a href="mailto:jason@bryer.org">jason@bryer.org</a>
</p>


<h3>References</h3>

<p>Wickham, H. (2009). Ggplot2: Elegant Graphics for Data Analysis. New York: Springer.
</p>
<p>Wilkinson, L. (1999). The Grammar of Graphics. Statistics and computing. New York: Springer.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+granovagg.1w">granovagg.1w</a></code> <code><a href="#topic+granovagg.ds">granovagg.ds</a></code>
<code><a href="#topic+granovagg.contr">granovagg.contr</a></code>
</p>

<hr>
<h2 id='granovagg.1w'>Elemental Graphic Display for One-Way ANOVA</h2><span id='topic+granovagg.1w'></span>

<h3>Description</h3>

<p>Graphic to display data for a one-way analysis of
variance &ndash; that is for unstructured groups. Also to help understand
how data play out in the context of the basic one-way model,
how the F statistic is generated for the data at hand,
etc. The graphic may be called 'elemental' or 'natural'
because it is built upon the central question that drives
one-way ANOVA (see details below).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>granovagg.1w(
  data,
  group = NULL,
  h.rng = 1,
  v.rng = 1,
  jj = NULL,
  dg = 2,
  resid = FALSE,
  print.squares = TRUE,
  xlab = "default_x_label",
  ylab = "default_y_label",
  main = "default_granova_title",
  plot.theme = "theme_granova_1w",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="granovagg.1w_+3A_data">data</code></td>
<td>
<p>Dataframe or vector. If a dataframe, the two or more columns
are taken to be groups of equal size (whence <code>group</code> is NULL).  If
<code>data</code> is a vector, <code>group</code> must be a vector, perhaps a factor,
that indicates groups (unequal group sizes allowed with this option).</p>
</td></tr>
<tr><td><code id="granovagg.1w_+3A_group">group</code></td>
<td>
<p>Group indicator, generally a factor in case <code>data</code> is a
vector.</p>
</td></tr>
<tr><td><code id="granovagg.1w_+3A_h.rng">h.rng</code></td>
<td>
<p>Numeric; controls the horizontal spread of groups, default =
1</p>
</td></tr>
<tr><td><code id="granovagg.1w_+3A_v.rng">v.rng</code></td>
<td>
<p>Numeric; controls the vertical spread of points, default =
1.</p>
</td></tr>
<tr><td><code id="granovagg.1w_+3A_jj">jj</code></td>
<td>
<p>Numeric; sets horiz. jittering level of points. <code>jj</code> gets passed as the
<code>amount</code> parameter to <code><a href="base.html#topic+jitter">jitter</a></code>.
When <code>jj = NULL</code> (the default behavior), the degree of jitter will take on a sensible value.
In addition, if pairs of ordered means are close to one another and <code>jj = NULL</code>,
the degree of jitter will default to the smallest difference between two adjacent contrasts.</p>
</td></tr>
<tr><td><code id="granovagg.1w_+3A_dg">dg</code></td>
<td>
<p>Numeric; sets number of decimal points in output display, default = 2</p>
</td></tr>
<tr><td><code id="granovagg.1w_+3A_resid">resid</code></td>
<td>
<p>Logical; displays marginal distribution of residuals (as a
'rug') on right side (wrt grand mean), default = FALSE.</p>
</td></tr>
<tr><td><code id="granovagg.1w_+3A_print.squares">print.squares</code></td>
<td>
<p>Logical; displays graphical squares for visualizing the F-statistic as a ratio
of MS-between to MS-within</p>
</td></tr>
<tr><td><code id="granovagg.1w_+3A_xlab">xlab</code></td>
<td>
<p>Character; horizontal axis label, can be supplied by user, default = <code>"default_x_label"</code>,
which leads to a generic x-axis label (&quot;Contrast coefficients based on group means&quot;).</p>
</td></tr>
<tr><td><code id="granovagg.1w_+3A_ylab">ylab</code></td>
<td>
<p>Character; vertical axis label, can be supplied by user, default = <code>"default_y_label"</code>,
which leads to a generic y-axis label (&quot;Dependent variable (response)&quot;).</p>
</td></tr>
<tr><td><code id="granovagg.1w_+3A_main">main</code></td>
<td>
<p>Character; main label, top of graphic; can be supplied by user,
default = <code>"default_granova_title"</code>, which will print a generic title for graphic.</p>
</td></tr>
<tr><td><code id="granovagg.1w_+3A_plot.theme">plot.theme</code></td>
<td>
<p>argument indicating a ggplot2 theme to apply to the
graphic; defaults to a customized theme created for the one-way graphic</p>
</td></tr>
<tr><td><code id="granovagg.1w_+3A_...">...</code></td>
<td>
<p>Optional arguments to/from other functions</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The one-way ANOVA graphic shows how the comparison of unstructured
groups, viz. their means, entails a particular linear combination (L.C.)
of the group means. In particular, we use the fact that the numerator of
the one-way F statistic, the mean square between (MS.B), is a linear combination
of the group means; each weight &ndash; one for each group &ndash; in the L.C. is (principally)
a function of the difference between the group's mean and the grand
mean, viz., (M~j~ - M..) where M~j~ denotes the jth group's mean, and M.. denotes
the grand mean. The L.C. can be written as a sum of products of the form
MS.B = Sum((1/df.B)(n_j (M_j - M..) M_j)) for j = 1...J.
The denominator of the F-statistic, MS.W
(mean square within), can be described as a 'scaling factor'. It is just the (weighted)
average of the variances of the J groups (j = 1 ... J). (n~j~'s are group sizes.)
The differences (M~j~ - M..) are themselves the 'effects' in the analysis.
When the effects are plotted against the group means (the horizontal and
vertical axes) a straight line necessarily ensues. Group means are plotted as
triangles along this line. Once the means have been plotted, the data points
(jittered) for the groups are displayed (vertical axis) with respect to the
respective contrasts. Since the group means are just the fitted values in
one-way ANOVA, and the deviations of the scores within groups are the residuals
(subsetted by groups), the graphic can be seen as showing fitted vs. residual
values for the line that shows the locus of ordered group means &ndash; from the smallest
on the left) the the largest (on the right). If desired, the aggregate of all
such residuals can be plotted (as a rug plot) on the right margin of the
graphic centered on the grand mean (large green dot in 'middle'). The use of
effects to locate groups this way yields what we term an 'elemental'
graphic because it is based on the central question that drives one-way
ANOVA.
</p>
<p>Note that groups need not have the same size, nor do data need to
reflect any particular distributional characteristics. Finally, the gray bars
(one for each group) at the bottom of the graphic show the relative sizes of
the group standard deviations with referene to the 'average' group s.d. (more precisely,
the square root of the MS.W). This 'average' corresponds to the thin white
line that runs horizontally across these bars.
</p>


<h3>Value</h3>

<p>Returns a plot object of class <code>ggplot</code>. The function also provides printed output including by-group
statistical summaries and information about groups that might be overplotted (if applicable):
</p>
<table>
<tr><td><code>group</code></td>
<td>
<p>group names</p>
</td></tr>
<tr><td><code>group means</code></td>
<td>
<p>means for each group</p>
</td></tr>
<tr><td><code>trimmed.mean</code></td>
<td>
<p>20% trimmed group means</p>
</td></tr>
<tr><td><code>contrast</code></td>
<td>
<p>Contrasts (group main effects)</p>
</td></tr>
<tr><td><code>variance</code></td>
<td>
<p>variances</p>
</td></tr>
<tr><td><code>standard.deviation</code></td>
<td>
<p>standard deviations</p>
</td></tr>
<tr><td><code>group.size</code></td>
<td>
<p>group sizes</p>
</td></tr>
<tr><td><code>overplotting information</code></td>
<td>
<p>Information about groups that, due to their close means, may be overplotted</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Brian A. Danielak <a href="mailto:brian@briandk.com">brian@briandk.com</a><br />
Robert M. Pruzek <a href="mailto:RMPruzek@yahoo.com">RMPruzek@yahoo.com</a>
</p>
<p>with contributions by:<br />
William E. J. Doane <a href="mailto:wil@drdoane.com">wil@drdoane.com</a><br />
James E. Helmreich <a href="mailto:James.Helmreich@Marist.edu">James.Helmreich@Marist.edu</a><br />
Jason Bryer <a href="mailto:jason@bryer.org">jason@bryer.org</a>
</p>


<h3>References</h3>

<p>Fundamentals of Exploratory Analysis of Variance, Hoaglin D.,
Mosteller F. and Tukey J. eds., Wiley, 1991.
</p>
<p>Wickham, H. (2009). Ggplot2: Elegant Graphics for Data Analysis. New York: Springer.
</p>
<p>Wilkinson, L. (1999). The Grammar of Graphics. Statistics and computing. New York: Springer.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+granovagg.contr">granovagg.contr</a></code>,
<code><a href="#topic+granovagg.ds">granovagg.ds</a></code>, <code><a href="#topic+granovaGG">granovaGG</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(arousal)
#Drug A
granovagg.1w(arousal[,1:2], h.rng = 1.6, v.rng = 0.5)

###

data(anorexia)
wt.gain &lt;- anorexia[, 3] - anorexia[, 2]
granovagg.1w(wt.gain, group = anorexia[, 1])

###

data(poison)
##Note violation of constant variance across groups in following graphic.
granovagg.1w(poison$SurvTime, group = poison$Group, ylab = "Survival Time")
##RateSurvTime = SurvTime^-1
granovagg.1w(poison$RateSurvTime, group = poison$Group,
ylab = "Survival Rate = Inverse of Survival Time")

##Nonparametric version: RateSurvTime ranked and rescaled
##to be comparable to RateSurvTime;
##note labels as well as residual (rug) plot below.
granovagg.1w(poison$RankRateSurvTime, group = poison$Group,
ylab = "Ranked and Centered Survival Rates",
main = "One-way ANOVA display, poison data (ignoring 2-way set-up)",
res = TRUE)

###

data(chickwts)
?chickwts # An explanation of the chickwts dataset
with(chickwts, granovagg.1w(weight, group = feed)) # Modeling weight as explained by feed type
</code></pre>

<hr>
<h2 id='granovagg.contr'>Elemental Graphic Display for Contrast Effect of ANOVA</h2><span id='topic+granovagg.contr'></span>

<h3>Description</h3>

<p>Provides graphic displays that shows data and effects for a priori contrasts
in ANOVA contexts; also corresponding numerical results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>granovagg.contr(
  data,
  contrasts,
  ylab = "default_y_label",
  plot.theme = "theme_granova_contr",
  jj = 1,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="granovagg.contr_+3A_data">data</code></td>
<td>
<p>Vector of scores for all equally sized groups, or a data.fame or
matrix where each column represents a group.</p>
</td></tr>
<tr><td><code id="granovagg.contr_+3A_contrasts">contrasts</code></td>
<td>
<p>Matrix of column contrasts with dimensions (number of
groups [G]) x (number of contrasts) [generally (G x G-1)].</p>
</td></tr>
<tr><td><code id="granovagg.contr_+3A_ylab">ylab</code></td>
<td>
<p>Character; y axis label. Defaults to a generic granova title.</p>
</td></tr>
<tr><td><code id="granovagg.contr_+3A_plot.theme">plot.theme</code></td>
<td>
<p>argument indicating a ggplot2 theme to apply to the
graphic; defaults to a customized theme created for the contrast graphic</p>
</td></tr>
<tr><td><code id="granovagg.contr_+3A_jj">jj</code></td>
<td>
<p>Numeric; controls <code><a href="base.html#topic+jitter">jitter</a></code> and allows you to control the
degree of jitter in the contrast plots. <code>jj</code> is divided by 100 and passed as the <code>width</code>
parameter to <code><a href="ggplot2.html#topic+position_jitter">position_jitter</a></code>.</p>
</td></tr>
<tr><td><code id="granovagg.contr_+3A_...">...</code></td>
<td>
<p>Optional arguments to/from other functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function provides graphic displays of contrast effects for prespecified
contrasts in ANOVA. Data points are displayed as relevant for each contrast
based on comparing groups according to the positive and negative contrast
coefficients for each contrast on the horizontal axis, against response
values on the vertical axis. Data points corresponding to groups not being
compared in any contrast (coefficients of zero) are ignored. For each
contrast (generally as part of a 2 x 2 panel) a line segment is given that
compares the (weighted) mean of the response variable for the negative
coefficients versus the positive coefficients. Standardized contrasts are
used, wherein the sum of (magnitudes) of negative coefficients is unity; and
the same for positive coefficients. If a line is &lsquo;notably&rsquo; different from
horizontal (i.e. slope of zero), a &lsquo;notable&rsquo; effect has been identified;
however, the question of statistical significance generally depends on a
sound context-based estimate of standard error for the corresponding effect.
This means that while summary aov numerical results and test statistics are
presented (see below), the appropriateness of the default standard error
generally requires the analyst's judgment. The response values are to be
input in (a stacked) form, i.e. as a vector, for all cells (cf. arg. ylab).
The matrix of contrast vectors <code>contrasts</code> must have G rows (the number
of groups), and a number of columns equal to the number of prespecified
contrasts, at most G-1. If the number of columns of <code>contrasts</code> is G-1,
then the number per group, or cell size, is taken to be
<code>length(data)/G</code>, where <code>G = nrow(contrasts)</code>.
</p>
<p>If the number of columns of <code>contrasts</code> is less than G-1 then the user
must stipulate <code>npg</code>, the number in each group or cell.  The function
is designed for the case when all cell sizes are the same, and may be most
helpful when the a priori contrasts are mutually orthogonal (e.g., in power
of 2 designs, or their fractional counterparts; also when specific row or
column comparisons, or their interactions (see the example below based on
rat weight gain data)). It is not essential that contrasts be mutually
orthogonal; but mutual linear independence is required. (When factor levels
correspond to some underlying continuum a standard application might use
<code>con = contr.poly(G)</code>, for G the number of groups; consider also
<code>contr.helmert(G)</code>.)  The final plot in each application shows the data
for all groups or cells in the design, where groups are simply numbered from
1:G, for G the number of groups, on the horizontal axis, versus the response
values on the vertical axis.
</p>


<h3>Value</h3>

<p>a list of ggplot objects, one element per plot. That allows you to access any individual plot
or plots, then modify them as you wish (with ggplot2 commands, for example).
</p>
<p>The function also provides printed output:
</p>
<table>
<tr><td><code>Weighted Means</code></td>
<td>
<p>Table showing the (weighted) means for positive
and negative coefficients for each (row) contrast, and for each row, the
difference between these means, and the standardized effect size in the
final column.</p>
</td></tr>
<tr><td><code>summary.lm</code></td>
<td>
<p>Summary results for a linear
model analysis based on the R function <code>lm</code> (When effects are simple,
as in an equal n's power of 2 design, mean differences will generally
correspond to the linear regression coefficients as seen in the <code>lm</code>
summary results.)</p>
</td></tr>
<tr><td><code>Contrasts</code></td>
<td>
<p>The contrast matrix you specified.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Brian A. Danielak <a href="mailto:brian@briandk.com">brian@briandk.com</a><br />
Robert M. Pruzek <a href="mailto:RMPruzek@yahoo.com">RMPruzek@yahoo.com</a>
</p>
<p>with contributions by:<br />
William E. J. Doane <a href="mailto:wil@drdoane.com">wil@drdoane.com</a><br />
James E. Helmreich <a href="mailto:James.Helmreich@Marist.edu">James.Helmreich@Marist.edu</a><br />
Jason Bryer <a href="mailto:jason@bryer.org">jason@bryer.org</a>
</p>


<h3>References</h3>

<p>Wickham, H. (2009). Ggplot2: Elegant Graphics for Data Analysis. New York: Springer.
</p>
<p>Wilkinson, L. (1999). The Grammar of Graphics. Statistics and computing. New York: Springer.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+granovagg.1w">granovagg.1w</a></code>,
<code><a href="#topic+granovagg.ds">granovagg.ds</a></code>, <code><a href="#topic+granovaGG">granovaGG</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(arousal)  
contrasts22 &lt;- data.frame( c(-.5,-.5,.5,.5), 
  c(-.5,.5,-.5,.5), c(.5,-.5,-.5,.5) )
names(contrasts22) &lt;- c("Drug.A", "Drug.B", "Drug.A.B")
granovagg.contr(arousal, contrasts = contrasts22)
  
data(rat)
dat6 &lt;- matrix(c(1, 1, 1, -1, -1, -1, -1, 1, 0, -1, 1, 0, 1, 1, -2, 
    1, 1, -2, -1, 1, 0, 1, -1, 0, 1, 1, -2, -1, -1, 2), ncol = 5)
granovagg.contr(rat[,1], contrasts = dat6, ylab = "Rat Weight Gain", 
  xlab = c("Amount 1 vs. Amount 2", "Type 1 vs. Type 2", 
  "Type 1 &amp; 2 vs Type 3", "Interaction of Amount and Type 1 &amp; 2", 
  "Interaction of Amount and  Type (1, 2), 3"))
#Polynomial Contrasts 
granovagg.contr(rat[,1],contrasts = contr.poly(6))

#based on random data 
data.random &lt;- rt(64, 5)
granovagg.contr(data.random, contrasts = contr.helmert(8), 
  ylab = "Random Data")
</code></pre>

<hr>
<h2 id='granovagg.ds'>Elemental Graphic for Display of Dependent Sample Data</h2><span id='topic+granovagg.ds'></span>

<h3>Description</h3>

<p>Plots dependent sample data beginning from a scatterplot for the X,Y pairs;
proceeds to display difference scores as point projections; also X and Y
means, as well as the mean of the difference scores.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>granovagg.ds(
  data = NULL,
  revc = FALSE,
  main = "default_granova_title",
  xlab = NULL,
  ylab = NULL,
  conf.level = 0.95,
  plot.theme = "theme_granova_ds",
  northeast.padding = 0,
  southwest.padding = 0,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="granovagg.ds_+3A_data">data</code></td>
<td>
<p>is an n X 2 dataframe or matrix. First column defines X
(intially for horzontal axis), the second defines Y.</p>
</td></tr>
<tr><td><code id="granovagg.ds_+3A_revc">revc</code></td>
<td>
<p>reverses X,Y specifications</p>
</td></tr>
<tr><td><code id="granovagg.ds_+3A_main">main</code></td>
<td>
<p>optional main title (as character); can be supplied by user. The default value is
<code>"default_granova_title"</code>, which will print a generic title for the graphic.</p>
</td></tr>
<tr><td><code id="granovagg.ds_+3A_xlab">xlab</code></td>
<td>
<p>optional label (as character) for horizontal axis. If not
defined, axis labels are taken from colnames of data.</p>
</td></tr>
<tr><td><code id="granovagg.ds_+3A_ylab">ylab</code></td>
<td>
<p>optional label (as character) for vertical axis. If not
defined, axis labels are taken from colnames of data.</p>
</td></tr>
<tr><td><code id="granovagg.ds_+3A_conf.level">conf.level</code></td>
<td>
<p>The confidence level at which to perform a dependent sample t-test.
Defaults to <code>0.95</code> (95% Confidence)</p>
</td></tr>
<tr><td><code id="granovagg.ds_+3A_plot.theme">plot.theme</code></td>
<td>
<p>argument indicating a ggplot2 theme to apply to the
graphic; defaults to a customized theme created for the dependent sample graphic</p>
</td></tr>
<tr><td><code id="granovagg.ds_+3A_northeast.padding">northeast.padding</code></td>
<td>
<p>(numeric) extends axes toward lower left,
effectively moving data points to the southwest. Defaults to zero padding.</p>
</td></tr>
<tr><td><code id="granovagg.ds_+3A_southwest.padding">southwest.padding</code></td>
<td>
<p>(numeric) extends axes toward upper right,
effectively moving data points to the southwest. Defaults to zero padding.
Making both southwest and northeast padding smaller moves points farther apart,
while making both larger moves data points closer together.</p>
</td></tr>
<tr><td><code id="granovagg.ds_+3A_...">...</code></td>
<td>
<p>Optional arguments to/from other functions</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Paired X and Y values are plotted as scatterplot. The identity reference line
(for Y = X) is drawn. Parallel projections of data points to (a lower-left)
line segment show how each point relates to its X-Y = D difference;
semitransparent &quot;shadow&quot; points are used to display the distribution of
difference scores, with thin grey lines leading from each raw datapoint to
its shadow projection on the difference distribution. The range of that
difference score distribution is drawn as a blue line beneath the shadow
points and the mean difference is displayed as a heavy dashed purple line,
parallel to the identity reference line. Means for X and Y are also plotted
(as thin dashed vertical and horizontal lines), and rug plots are shown for
the distributions of X (at the top of graphic) and Y (on the right side). The
95% confidence interval for the population mean difference is also shown
graphically as a green band, perpendicular to the mean treatment effect line.
Because all data points are plotted relative to the identity line, and
summary results are shown graphically, clusters, data trends, outliers, and
possible uses of transformations are readily seen, possibly to be
accommodated.
</p>
<p>In summary, the graphic shows all initial data points relative to the
identity line, adds projections (to the 'north' and 'east') showing the
marginal distributions of X and Y, as well as projections to the 'southwest'
where the difference scores for each point are drawn. Means for all three
distributions are shown using straight lines; the confidence interval for the
population mean difference score is also shown. Summary statistics are
printed as side effects of running the function for the dependent sample
analysis.
</p>


<h3>Value</h3>

<p>Returns a plot object of class <code>ggplot</code>.
</p>


<h3>Author(s)</h3>

<p>Brian A. Danielak <a href="mailto:brian@briandk.com">brian@briandk.com</a><br />
Robert M. Pruzek <a href="mailto:RMPruzek@yahoo.com">RMPruzek@yahoo.com</a>
</p>
<p>with contributions by:<br />
William E. J. Doane <a href="mailto:wil@drdoane.com">wil@drdoane.com</a><br />
James E. Helmreich <a href="mailto:James.Helmreich@Marist.edu">James.Helmreich@Marist.edu</a><br />
Jason Bryer <a href="mailto:jason@bryer.org">jason@bryer.org</a>
</p>


<h3>References</h3>

<p>Pruzek, R. M., &amp; Helmreich, J. E. (2009). Enhancing Dependent Sample Analyses with Graphics. Journal of Statistics Education, 17(1), 21.
</p>
<p>Wickham, H. (2009). Ggplot2: Elegant Graphics for Data Analysis. New York: Springer.
</p>
<p>Wilkinson, L. (1999). The Grammar of Graphics. Statistics and computing. New York: Springer.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+granovagg.1w">granovagg.1w</a></code>,
<code><a href="#topic+granovagg.ds">granovagg.ds</a></code>, <code><a href="#topic+granovaGG">granovaGG</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### Using granovagg.ds to examine trends or effects for repeated measures data.

# This example corresponds to case 1b in Pruzek and Helmreich (2009). In this
# graphic we're looking for the effect of Family Treatment on patients with anorexia.

data(anorexia.sub)

granovagg.ds(anorexia.sub,
             revc = TRUE,
             main = "Assessment Plot for weights to assess \
                    Family Therapy treatment for Anorexia Patients",
             xlab = "Weight after therapy (lbs.)",
             ylab = "Weight before therapy (lbs.)"
)

### Using granovagg.ds to compare two experimental treatments (with blocking)

# This example corresponds to case 2a in Pruzek and Helmreich (2009). For this
# data, we're comparing the effects of two different virus preparations on the
# number of lesions produced on a tobacco leaf.

data(tobacco)
granovagg.ds(tobacco[, c("prep1", "prep2")],
             main = "Local Lesions on Tobacco Leaves",
             xlab = "Virus Preparation 1",
             ylab = "Virus Preparation 2"
)

### Using granovagg.ds to compare two experimental treatments (with blocking)

# This example corresponds to case 2a in Pruzek and Helmreich (2009). For this
# data, we're comparing the wear resistance of two different shoe sole
# materials, each randomly assigned to the feet of 10 boys.

data(shoes)
granovagg.ds(shoes,
             revc = TRUE,
             main = "Shoe Wear",
             xlab = "Sole Material B",
             ylab = "Sole Material A",
)

### Using granovagg.ds to compare matched individuals for two treatments

# This example corresponds to case 2b in Pruzek and Helmreich (2009). For this
# data, we're examining the level of lead (in mg/dl) present in the blood of
# children. Children of parents who had worked in a factory where lead was used
# in making batteries were matched by age, exposure to traffic, and neighborhood
# with children whose parents did not work in lead-related industries.

data(blood_lead)
granovagg.ds(blood_lead,
             sw = .1,
             main = "Dependent Sample Assessment Plot
             Blood Lead Levels of Matched Pairs of Children",
             xlab = "Exposed (mg/dl)",
             ylab = "Control (mg/dl)"
)
</code></pre>

<hr>
<h2 id='poison'>Poison data from Biological Experiment</h2><span id='topic+poison'></span>

<h3>Description</h3>

<p>Survial times of animals in a 3 x 4 factorial experiment involving poisons
(3 levels) and various treatments (four levels), as described in Chapter 8
of Box, Hunter and Hunter.
</p>


<h3>Format</h3>

<p>This data frame was originally <code>poison.data</code> from the package
<code>BHH2</code>, but as presented here has added columns; no NAs. </p>

<dl>
<dt>Poison</dt><dd><p>Factor with three levels I, II, and III.</p>
</dd>
<dt>Treatment</dt><dd><p>Factor with four levels, A, B, C, and D.</p>
</dd>
<dt>Group</dt><dd><p>Factor with 12 levels, 1:12.</p>
</dd>
<dt>SurvTime</dt><dd><p>Numeric; survival time.</p>
</dd>
<dt>RateSurvTime</dt><dd><p>Numeric; inverse of SurvTime</p>
</dd>
<dt>RankRateSurvTime</dt><dd><p>Numeric; <code>RateSurvTime</code> scores have
been converted to ranks, and then rescaled to have the same median as and
a spread comparable to <code>RateSurvTime</code></p>
</dd> </dl>



<h3>Source</h3>

<p>Box, G. E. P. and D. R. Cox, An Analysis of Transformations (with
discussion), Journal of the Royal Statistical Society, Series B, Vol. 26,
No. 2, pp. 211 - 254.
</p>


<h3>References</h3>

<p>Box G. E. P, Hunter, J. S. and Hunter, W. C. (2005). Statistics
for Experimenters II. New York: Wiley.
</p>

<hr>
<h2 id='rat'>Weight gains of rats fed different diets</h2><span id='topic+rat'></span>

<h3>Description</h3>

<p>60 rats were fed varying diets to see which produced the greatest weight
gain.  Two diet factors were protein type: beef, pork, chicken and protein
level: high and low.
</p>


<h3>Format</h3>

<p>A data frame with 60 observations on the following 3 variables, no
NAs.
</p>

<dl>
<dt>Weight.Gain</dt><dd><p>Weight gain (grams) of rats fed the diets.</p>
</dd>
<dt>Diet.Amount</dt><dd><p>Amount of protein in diet: 1 = High, 2 = Low.</p>
</dd>
<dt>Diet.Type</dt><dd><p>Type of protein in diet: 1 = Beef, 2 = Pork, 3 =
Cereal.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Fundamentals of Exploratory Analysis of Variance, Hoaglin D.,
Mosteller F. and Tukey J. eds., Wiley, 1991, p. 100; originally from
Statistical Methods, 7th ed, Snedecor G. and Cochran W. (1980), Iowa State
Press.
</p>

<hr>
<h2 id='shoes'>Shoe wear data of Box, Hunter and Hunter</h2><span id='topic+shoes'></span>

<h3>Description</h3>

<p>A list of two vectors, giving the wear of shoes of materials A and B for one foot each of ten boys.
</p>


<h3>Source</h3>

<p>G. E. P. Box, W. G. Hunter and J. S. Hunter (1978) <em>Statistics for Experimenters</em>. Wiley, p. 100
</p>


<h3>References</h3>

<p>Venables, W. N. and Ripley, B. D. (2002) <em>Modern Applied Statistics with S</em>. Fourth edition. Springer.
</p>

<hr>
<h2 id='tobacco'>Virus Preparation on Tobacco Leaves</h2><span id='topic+tobacco'></span>

<h3>Description</h3>

<p>This data is taken from Snedecor and Cochran (1980) and corresponds to a true
matched pairs experiment. The data originally came from Youden and Beale in
1934 who &quot;wished to find out if two preparations of a virus would produce
different effects on tobacco plants. Half a leaf of a tobacco plant was
rubbed with cheesecloth soaked in one preparation of the virus extract, and
the second half was rubbed similarly with the second extract.&quot; (Page 86,
Snedecor and Cochran, 1980) Each of the 8 points in the figure corresponds to
the numbers of lesions on the two halves of one leaf with sides that had been
treated differently.
</p>


<h3>Format</h3>

<p>A dataframe with 8 observations on the following 2 variables, no NAs
</p>

<dl>
<dt>prep1</dt><dd><p>Virus Preparation 1</p>
</dd>
<dt>prep2</dt><dd><p>Virus Preparation 2</p>
</dd>
</dl>



<h3>Source</h3>

<p>Youden, W. J., Beale, H. P. (1934). A statistical study of the local
lesion method for estimating tobacco mosaic virus. In Contributions from
Boyce Thompson Institute 6, page 437.
</p>


<h3>References</h3>

<p>Snedecor, W., Cochran, W. (1980). Statistical methods. Iowa State
University Press, Ames Iowa, seventh edition.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
