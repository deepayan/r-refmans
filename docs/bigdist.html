<!DOCTYPE html><html><head><title>Help for package bigdist</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {bigdist}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#package_bigdist'><p>Package: bigdist</p></a></li>
<li><a href='#as_bigdist'><p>Convert to bigdist</p></a></li>
<li><a href='#bigdist'><p>Read or Create a distance matrix on disk</p></a></li>
<li><a href='#bigdist_extract'><p>Extract parts of bigdist</p></a></li>
<li><a href='#bigdist_replace'><p>Replace parts of bigdist</p></a></li>
<li><a href='#bigdist_size'><p>Size of bigdist</p></a></li>
<li><a href='#bigdist_subset'><p>Subset parts of bigdist</p></a></li>
<li><a href='#colStartIndex'><p>Get the column start index</p></a></li>
<li><a href='#dist_ij_k'><p>Vectorized version of dist_ij_k_</p></a></li>
<li><a href='#dist_ij_k_'><p>Convert ij index to k index</p></a></li>
<li><a href='#dist_k_ij'><p>Vectorized version of dist_k_ij_</p></a></li>
<li><a href='#dist_k_ij_'><p>Convert kth index to ij index</p></a></li>
<li><a href='#distIndex'><p>Compute distance between a row and its subsequent rows</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Store Distance Matrices on Disk</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.4</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides utilities to compute, store and access distance matrices on disk as file-backed matrices provided by the 'bigstatsr' package. File-backed distance matrices are stored as a symmetric matrix to facilitate out-of-memory operations on file-backed matrix while the in-memory 'dist' object stores only the lower diagonal elements. 'disto' provides an unified interface to work with in-memory and disk-based distance matrices.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/talegari/bigdist">https://github.com/talegari/bigdist</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/talegari/bigdist/issues">https://github.com/talegari/bigdist/issues</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>assertthat (&ge; 0.2.0), bigstatsr (&ge; 0.9.1), proxy (&ge;
0.4.21), furrr (&ge; 0.1.0), utils,</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.4.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>stats, spelling (&ge; 2.0), testthat (&ge; 2.0.1),</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.0</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-03-16 11:53:05 UTC; srikanth</td>
</tr>
<tr>
<td>Author:</td>
<td>Komala Sheshachala Srikanth [aut, cre],
  Florian Privé [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Komala Sheshachala Srikanth &lt;sri.teach@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-03-16 14:13:30 UTC</td>
</tr>
</table>
<hr>
<h2 id='package_bigdist'>Package: bigdist</h2><span id='topic+package_bigdist'></span><span id='topic+_PACKAGE'></span><span id='topic+package_bigdist-package'></span>

<h3>Description</h3>

<p>bigdist package facilitates storing distance matrices on disk as
'file-backed matrix' (FBM) using <span class="pkg">bigstatsr</span> package. The FBM stores a
symmetric matrix. Each distance is stored as a 'float/double' approximately
requiring 4 or 8 bytes. The resulting file size will approximately be $8 *
size^2$ where size is nrow/ncol of the data matrix. Working with bigdist
package requires working knowledge of <span class="pkg">bigstatsr</span> package.
</p>

<ul>
<li><p> bigdist: (function) Create  or connect to distance matrix on disk.
</p>
</li>
<li><p> as_bigdist: (method) Convert to 'bigdist' class.
</p>
</li></ul>

<p><span class="pkg">disto</span> package provides a unified interface to distance matrices
in-memory (class 'dist') or on disk (class 'bigdist').
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Komala Sheshachala Srikanth <a href="mailto:sri.teach@gmail.com">sri.teach@gmail.com</a>
</p>
<p>Other contributors:
</p>

<ul>
<li><p> Florian Privé <a href="mailto:florian.prive.21@gmail.com">florian.prive.21@gmail.com</a> [contributor]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/talegari/bigdist">https://github.com/talegari/bigdist</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/talegari/bigdist/issues">https://github.com/talegari/bigdist/issues</a>
</p>
</li></ul>


<hr>
<h2 id='as_bigdist'>Convert to bigdist</h2><span id='topic+as_bigdist'></span>

<h3>Description</h3>

<p>Generic to convert an object of class 'bigdist'
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as_bigdist(x, file, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as_bigdist_+3A_x">x</code></td>
<td>
<p>Object coercible to bigdist</p>
</td></tr>
<tr><td><code id="as_bigdist_+3A_file">file</code></td>
<td>
<p>File to write the 'bigdist' matrix</p>
</td></tr>
<tr><td><code id="as_bigdist_+3A_...">...</code></td>
<td>
<p>additional arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Writing distances to FBM can be parallelized by setting up a future
backend
</p>


<h3>Value</h3>

<p>An object of class 'bigdist'
</p>


<h3>Examples</h3>

<pre><code class='language-R'>temp3 &lt;- as_bigdist(dist(mtcars), file = file.path(tempdir(), "temp_ex4"))
temp3
</code></pre>

<hr>
<h2 id='bigdist'>Read or Create a distance matrix on disk</h2><span id='topic+bigdist'></span>

<h3>Description</h3>

<p>Computes distances via <code><a href="proxy.html#topic+dist">dist</a></code> and saves then
as file-backed matrix(FBM) using <span class="pkg">bigstatsr</span> package or connects
existing FBM backup file on disk.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bigdist(mat, file, method = "euclidean", type = "float")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bigdist_+3A_mat">mat</code></td>
<td>
<p>Numeric matrix. When missing, attempts to connect to existing
backup file. See 'file' argument.</p>
</td></tr>
<tr><td><code id="bigdist_+3A_file">file</code></td>
<td>
<p>(string) Name of the backing file to be created or an existing
backup file. Do not include trailing &quot;.bk&quot;. See details for the backup file
format.</p>
</td></tr>
<tr><td><code id="bigdist_+3A_method">method</code></td>
<td>
<p>(string or function) See method argument of
<code><a href="proxy.html#topic+dist">dist</a></code>. This ignored when mat is missing.</p>
</td></tr>
<tr><td><code id="bigdist_+3A_type">type</code></td>
<td>
<p>(string, default: 'float') Storage type of FBM. See
<code><a href="bigstatsr.html#topic+FBM">FBM</a></code>. This ignored when mat is missing.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>bigdist class is a list where the key 'fbm' holds the FBM
connection. The filename format is of the form &lt;somename&gt;_&lt;size&gt;_&lt;type&gt;.bk
where size is the number of observations and type is the data type like
'double', 'float'.
</p>
<p><span class="pkg">bigstatsr</span> package stores matrices on disk and allows efficient
computation on them. The <span class="pkg">disto</span> provides a unified frontend to read
parts of distance matrices and apply functions over rows/columns. For
efficient operations, write C++ functions to talk to <span class="pkg">bigstatsr</span>'s
<code><a href="bigstatsr.html#topic+FBM">FBM</a></code>.
</p>
<p>The distance computation and writing to FBM may be parallelized by setting
a future backend
</p>


<h3>Value</h3>

<p>An object of class 'bigdist'.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># basics of 'bigdist'
# create a random matrix
set.seed(1)
amat &lt;- matrix(rnorm(1e3), ncol = 10)
td   &lt;- tempdir()

# create a bigdist object with FBM (file-backed matrix) on disk
temp &lt;- bigdist(mat = amat, file = file.path(td, "temp_ex1"))
temp
temp$fbm$backingfile
temp$fbm[1, 2]

# connect to FBM on disk as a bigdist object
temp2 &lt;- bigdist(file = file.path(td, "temp_ex1_100_float"))
temp2
temp2$fbm[1,2]

# check the size of bigdist object
bigdist_size(temp)

# bigdist accessors

# ij
bigdist_extract(temp, 1, 2)
bigdist_extract(temp, 1:2, 3:4)
bigdist_extract(temp, 1:2, 3:4, product = "inner")
dim(bigdist_extract(temp, 1:2,))
dim(bigdist_extract(temp, , 3:4))

# k (lower trianle indexing)
bigdist_extract(temp, k = 3:7)

# bigdist replacers

# ij
bigdist_replace(temp, 1, 2, 10)
bigdist_extract(temp, 1, 2)
bigdist_replace(temp, 1:2, 3:4, 11:12)
bigdist_extract(temp, 1:2, 3:4, product = "inner")

# k (lower trianle indexing)
bigdist_replace(temp, k = 3:7, value = 51:55)
bigdist_extract(temp, k = 3:7)

# subset a bigdist object
temp_subset &lt;- bigdist_subset(temp, index = 21:30, file = file.path(td, "temp_ex2"))
temp_subset
temp_subset$fbm$backingfile

# convert a dist object(in memory) to a bigdist object
temp3 &lt;- as_bigdist(dist(mtcars), file = file.path(td, "temp_ex3"))
temp3
</code></pre>

<hr>
<h2 id='bigdist_extract'>Extract parts of bigdist</h2><span id='topic+bigdist_extract'></span>

<h3>Description</h3>

<p>Extract parts of bigdist
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bigdist_extract(x, i, j, k, product = "outer")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bigdist_extract_+3A_x">x</code></td>
<td>
<p>Object of class 'bigdist'</p>
</td></tr>
<tr><td><code id="bigdist_extract_+3A_i">i</code></td>
<td>
<p>(integer vector) row positions</p>
</td></tr>
<tr><td><code id="bigdist_extract_+3A_j">j</code></td>
<td>
<p>(integer vector) column positions</p>
</td></tr>
<tr><td><code id="bigdist_extract_+3A_k">k</code></td>
<td>
<p>(integer vector) positions</p>
</td></tr>
<tr><td><code id="bigdist_extract_+3A_product">product</code></td>
<td>
<p>(string) One among: 'inner', 'outer'(default)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In k-mode, both i and j should be missing and k should not be
missing. In ij-mode, k should be missing and both i and j are optional. If
i or j are missing, they are interpreted as all values of i or j (similar
to matrix or dataframe subsetting).
</p>


<h3>Value</h3>

<p>A matrix or vector of distances when product is 'outer' and 'inner'
respectively
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1)
amat &lt;- matrix(rnorm(1e3), ncol = 10)
td   &lt;- tempdir()
temp &lt;- bigdist(mat = amat, file = file.path(td, "temp_ex6"))
bigdist_extract(temp, 1, 2)
bigdist_extract(temp, 1:2, 3:4)
bigdist_extract(temp, 1:2, 3:4, product = "inner")
dim(bigdist_extract(temp, 1:2,))
dim(bigdist_extract(temp, , 3:4))
</code></pre>

<hr>
<h2 id='bigdist_replace'>Replace parts of bigdist</h2><span id='topic+bigdist_replace'></span>

<h3>Description</h3>

<p>Replace parts of bigdist
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bigdist_replace(x, i, j, value, k)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bigdist_replace_+3A_x">x</code></td>
<td>
<p>Object of class 'bigdist'</p>
</td></tr>
<tr><td><code id="bigdist_replace_+3A_i">i</code></td>
<td>
<p>(integer vector) row positions</p>
</td></tr>
<tr><td><code id="bigdist_replace_+3A_j">j</code></td>
<td>
<p>(integer vector) column positions</p>
</td></tr>
<tr><td><code id="bigdist_replace_+3A_value">value</code></td>
<td>
<p>(integer/numeric vector) Values to replace</p>
</td></tr>
<tr><td><code id="bigdist_replace_+3A_k">k</code></td>
<td>
<p>(integer vector) positions</p>
</td></tr>
</table>


<h3>Details</h3>

<p>There are two modes to specify the positions:
</p>

<ul>
<li><p> ij-mode where i and j are specified and k is missing. If i or j are
missing, they are interpreted as all values of i or j (similar to matrix or
dataframe subsetting). Lengths of i, j are required to be same. If 'value'
is singleton, then it is extended to the length of i or j. Else, 'value'
should have same length as i or j.
</p>
</li>
<li><p> k-mode where  k is present and both i and k are missing. k is the
positions in the dist object. If 'value' is singleton, then it is extended
to the length of k. Else, 'value' should have same length as k.
</p>
</li></ul>



<h3>Value</h3>

<p>bigdist object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1)
amat &lt;- matrix(rnorm(1e3), ncol = 10)
td   &lt;- tempdir()
temp &lt;- bigdist(mat = amat, file = file.path(td, "temp_ex7"))
bigdist_replace(temp, 1, 2, 10)
bigdist_extract(temp, 1, 2)
bigdist_replace(temp, 1:2, 3:4, 11:12)
bigdist_extract(temp, 1:2, 3:4, product = "inner")
</code></pre>

<hr>
<h2 id='bigdist_size'>Size of bigdist</h2><span id='topic+bigdist_size'></span>

<h3>Description</h3>

<p>Size of bigdist
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bigdist_size(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bigdist_size_+3A_x">x</code></td>
<td>
<p>Object of class 'bigdist'</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1)
amat &lt;- matrix(rnorm(1e3), ncol = 10)
td   &lt;- tempdir()
temp &lt;- bigdist(mat = amat, file = file.path(td, "temp_ex5"))
bigdist_size(temp)
</code></pre>

<hr>
<h2 id='bigdist_subset'>Subset parts of bigdist</h2><span id='topic+bigdist_subset'></span>

<h3>Description</h3>

<p>Subset parts of bigdist
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bigdist_subset(x, index, file)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bigdist_subset_+3A_x">x</code></td>
<td>
<p>Object of class 'bigdist'</p>
</td></tr>
<tr><td><code id="bigdist_subset_+3A_index">index</code></td>
<td>
<p>Indexes of the bigdist to be subset as a bigdist</p>
</td></tr>
<tr><td><code id="bigdist_subset_+3A_file">file</code></td>
<td>
<p>(string) Name of the backing file to be created. Do not include
trailing &quot;.bk&quot;. See details for the backup file format.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The filename format is of the form &lt;somename&gt;_&lt;size&gt;_&lt;type&gt;.bk where
size is the number of observations and type is the data type like 'double',
'float'.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1)
amat &lt;- matrix(rnorm(1e3), ncol = 10)
td   &lt;- tempdir()
temp &lt;- bigdist(mat = amat, file = file.path(td, "temp_ex8"))
temp_subset &lt;- bigdist_subset(temp, index = 21:30, file = file.path(td, "temp_ex9"))
temp_subset
temp_subset$fbm$backingfile
</code></pre>

<hr>
<h2 id='colStartIndex'>Get the column start index</h2><span id='topic+colStartIndex'></span>

<h3>Description</h3>

<p>Get the index of the dist object corresponding to some column
start in the symmetric form of the distance matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>colStartIndex(i, size)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="colStartIndex_+3A_i">i</code></td>
<td>
<p>Column number</p>
</td></tr>
<tr><td><code id="colStartIndex_+3A_size">size</code></td>
<td>
<p>Size of the dist object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An index of dist object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>colStartIndex(2, 10)
</code></pre>

<hr>
<h2 id='dist_ij_k'>Vectorized version of dist_ij_k_</h2><span id='topic+dist_ij_k'></span>

<h3>Description</h3>

<p>Convert ij indexes to k indexes for a dist object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dist_ij_k(i, j, size)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dist_ij_k_+3A_i">i</code></td>
<td>
<p>row indexes</p>
</td></tr>
<tr><td><code id="dist_ij_k_+3A_j">j</code></td>
<td>
<p>column indexes</p>
</td></tr>
<tr><td><code id="dist_ij_k_+3A_size">size</code></td>
<td>
<p>value of size attribute of the dist object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>k indexes
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dist_ij_k(1:3, 4:6, 10)
</code></pre>

<hr>
<h2 id='dist_ij_k_'>Convert ij index to k index</h2><span id='topic+dist_ij_k_'></span>

<h3>Description</h3>

<p>Convert ij index to k index for a dist object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dist_ij_k_(i, j, size)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dist_ij_k__+3A_i">i</code></td>
<td>
<p>row index</p>
</td></tr>
<tr><td><code id="dist_ij_k__+3A_j">j</code></td>
<td>
<p>column index</p>
</td></tr>
<tr><td><code id="dist_ij_k__+3A_size">size</code></td>
<td>
<p>value of size attribute of the dist object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>k index
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dist_ij_k_(1, 3, 10)
</code></pre>

<hr>
<h2 id='dist_k_ij'>Vectorized version of dist_k_ij_</h2><span id='topic+dist_k_ij'></span>

<h3>Description</h3>

<p>Convert kth indexes to ij indexes of a dist object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dist_k_ij(k, size)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dist_k_ij_+3A_k">k</code></td>
<td>
<p>kth indexes</p>
</td></tr>
<tr><td><code id="dist_k_ij_+3A_size">size</code></td>
<td>
<p>value of size attribute of the dist object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ij indexes as 2*n matrix where n is length of k vector
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dist_k_ij(4:6, 10:12)
</code></pre>

<hr>
<h2 id='dist_k_ij_'>Convert kth index to ij index</h2><span id='topic+dist_k_ij_'></span>

<h3>Description</h3>

<p>Convert kth index to ij index of a dist object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dist_k_ij_(k, size)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dist_k_ij__+3A_k">k</code></td>
<td>
<p>kth index</p>
</td></tr>
<tr><td><code id="dist_k_ij__+3A_size">size</code></td>
<td>
<p>value of size attribute of the dist object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ij index as a length two integer vector
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dist_k_ij_(4, 10)
</code></pre>

<hr>
<h2 id='distIndex'>Compute distance between a row and its subsequent rows</h2><span id='topic+distIndex'></span>

<h3>Description</h3>

<p>Computes distance between row i and rows i + 1, i + 2, ..., n
where n is the total number of rows
</p>


<h3>Usage</h3>

<pre><code class='language-R'>distIndex(i, mat, method, size)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="distIndex_+3A_i">i</code></td>
<td>
<p>row index</p>
</td></tr>
<tr><td><code id="distIndex_+3A_mat">mat</code></td>
<td>
<p>numeric matrix</p>
</td></tr>
<tr><td><code id="distIndex_+3A_method">method</code></td>
<td>
<p>method is passed to <code><a href="proxy.html#topic+dist">dist</a></code></p>
</td></tr>
<tr><td><code id="distIndex_+3A_size">size</code></td>
<td>
<p>Number of rows of mat</p>
</td></tr>
</table>


<h3>Value</h3>

<p>(numeric vector) Vector of n - i distances where n is the total
number of rows
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
