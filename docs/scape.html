<!DOCTYPE html><html><head><title>Help for package scape</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {scape}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#estN'><p>Estimate Effective Sample Size</p></a></li>
<li><a href='#estSigmaI'><p>Estimate Abundance Index Sigma</p></a></li>
<li><a href='#estSigmaR'><p>Estimate Recruitment Sigma</p></a></li>
<li><a href='#getN'><p>Extract Sample Size</p></a></li>
<li><a href='#getSigmaI'><p>Extract Abundance Index Sigma</p></a></li>
<li><a href='#getSigmaR'><p>Extract Recruitment sigma</p></a></li>
<li><a href='#importADCAM'><p>Import ADCAM Model Results</p></a></li>
<li><a href='#importCol'><p>Import Coleraine Model Results</p></a></li>
<li><a href='#importMCMC'><p>Import Coleraine MCMC Results</p></a></li>
<li><a href='#importProj'><p>Import Coleraine MCMC Projections</p></a></li>
<li><a href='#iterate'><p>Get Candidate Sigmas and Sample Sizes</p></a></li>
<li><a href='#plotB'><p>Plot Biomass, Recruitment, and Landings</p></a></li>
<li><a href='#plotCA'><p>Plot Catch at Age</p></a></li>
<li><a href='#plotCL'><p>Plot Catch at Length</p></a></li>
<li><a href='#plotIndex'><p>Plot Abundance Index</p></a></li>
<li><a href='#plotLA'><p>Plot Length at Age</p></a></li>
<li><a href='#plotN'><p>Plot Numbers at Age</p></a></li>
<li><a href='#plotSel'><p>Plot Selectivity and Maturity</p></a></li>
<li><a href='#scape-package'><p>Statistical Catch-at-Age Plotting Environment</p></a></li>
<li><a href='#x.cod'><p>Cod Assessment</p></a></li>
<li><a href='#x.ling'><p>Ling Assessment</p></a></li>
<li><a href='#x.oreo'><p>Oreo Assessment</p></a></li>
<li><a href='#x.saithe'><p>Saithe Assessment</p></a></li>
<li><a href='#x.sbw'><p>Whiting Assessment</p></a></li>
<li><a href='#xmcmc'><p>MCMC Results from Cod Assessment</p></a></li>
<li><a href='#xproj'><p>MCMC Projections from Cod Assessment</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>2.3.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-11-23</td>
</tr>
<tr>
<td>Title:</td>
<td>Statistical Catch-at-Age Plotting Environment</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, utils, coda, Hmisc, lattice</td>
</tr>
<tr>
<td>Suggests:</td>
<td>gdata</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>Description:</td>
<td>Import, plot, and diagnose results from statistical
  catch-at-age models, used in fisheries stock assessment.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-11-23 12:55:53 UTC; arnima</td>
</tr>
<tr>
<td>Author:</td>
<td>Arni Magnusson [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Arni Magnusson &lt;thisisarni@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-11-23 15:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='estN'>Estimate Effective Sample Size</h2><span id='topic+estN'></span><span id='topic+estN.int'></span>

<h3>Description</h3>

<p>Estimate the effective sample size for catch-at-age or catch-at-length
data, based on the multinomial distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estN(model, what="CAc", series=NULL, init=NULL, FUN=mean, ceiling=Inf,
     digits=0)

estN.int(P, Phat)  # internal function
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estN_+3A_model">model</code></td>
<td>
<p>fitted <code>scape</code> model containing catch-at-age and/or
catch-at-length data.</p>
</td></tr>
<tr><td><code id="estN_+3A_what">what</code></td>
<td>
<p>name of model element: <code>"CAc"</code>, <code>"CAs"</code>,
<code>"CLc"</code>, or <code>"CLs"</code>.</p>
</td></tr>
<tr><td><code id="estN_+3A_series">series</code></td>
<td>
<p>vector of strings indicating which gears or surveys to
analyze (all by default).</p>
</td></tr>
<tr><td><code id="estN_+3A_init">init</code></td>
<td>
<p>initial sample size, determining the relative pattern of
the effective sample size between years.</p>
</td></tr>
<tr><td><code id="estN_+3A_fun">FUN</code></td>
<td>
<p>function to standardize the effective sample size.</p>
</td></tr>
<tr><td><code id="estN_+3A_ceiling">ceiling</code></td>
<td>
<p>largest possible sample size in one year.</p>
</td></tr>
<tr><td><code id="estN_+3A_digits">digits</code></td>
<td>
<p>number of decimal places to use when rounding, or
<code>NULL</code> to suppress rounding.</p>
</td></tr>
<tr><td><code id="estN_+3A_p">P</code></td>
<td>
<p>observed catch-at-age or catch-at-length matrix.</p>
</td></tr>
<tr><td><code id="estN_+3A_phat">Phat</code></td>
<td>
<p>fitted catch-at-age or catch-at-length matrix.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>init</code> sample sizes set a fixed pattern for the relative
sample sizes between years. For example, if there are two years of
catch-at-age data and the initial sample sizes are 100 in year 1 and
200 in year 2, the effective sample size will be two times greater in
year 2 than in year 1, although both will be scaled up or down
depending on how closely the model fits the catch-at-age data. The
value of <code>init</code> can be one of the following:
</p>

<dl>
<dt><code>NULL</code></dt><dd><p>means read the initial sample sizes from the
existing <code>SS</code> column (default).</p>
</dd>
<dt>model</dt><dd><p>means read the initial sample sizes from the <code>SS</code>
column in that model (object of class <code>scape</code>).</p>
</dd>
<dt>numeric vector</dt><dd><p>means those are the initial sample sizes (same
length as the number of years).</p>
</dd>
<dt><code>FALSE</code></dt><dd><p>means ignore the initial sample sizes and use
the empirical multinomial sample size (<code class="reqn">\hat n</code>) in each
year.</p>
</dd>
<dt><code>1</code></dt><dd><p>means calculate one effective sample size to use
across all years, e.g. the mean or median of <code class="reqn">\hat n</code>.</p>
</dd>
</dl>

<p>The idea behind <code>FUN=mean</code> is to guarantee that regardless of the
value of <code>init</code>, the mean effective sample size will always be
the same. Other functions can be used to a similar effect, such as
<code>FUN=median</code>.
</p>
<p>The <code>estN</code> function is implemented for basic single-sex datasets.
If the data are sex-specific, <code>estN</code> pools (averages) the sexes
before estimating effective sample sizes. The general function
<code>estN.int</code>, on the other hand, is suitable for analyzing any
datasets in <code>matrix</code> format. The &lsquo;<span class="samp">&#8288;int&#8288;</span>&rsquo; in <code>estN.int</code>
stands for internal (not integer), analogous to <code>rep.int</code>,
<code>seq.int</code>, <code>sort.int</code>, and similar functions.
</p>


<h3>Value</h3>

<p>Numeric vector of effective sample sizes (one value if <code>init=1</code>),
or a list of such vectors when analyzing multiple series.
</p>


<h3>Note</h3>

<p>This function uses the empirical multinomial sample size to estimate
an effective sample size, which may be appropriate as likelihood
weights for catch-at-age and catch-at-length data. The better the
model fits the data, the larger the effective sample size. See
McAllister and Ianelli (1997), Gavaris and Ianelli (2002), and
Magnusson et al. (2013).
</p>
<p><code>estN</code> can be used iteratively, along with
<code><a href="#topic+estSigmaI">estSigmaI</a></code> and <code><a href="#topic+estSigmaR">estSigmaR</a></code> to assign
likelihood weights that are indicated by the model fit to the data.
Sigmas and sample sizes are then adjusted between model runs, until
they converge. The <code>iterate</code> function facilitates this procedure.
</p>
<p>If <code class="reqn">P_{t,a}</code> is the observed proportion of fish at age (or
length bin) <code class="reqn">a</code> in year <code class="reqn">t</code>, and <code class="reqn">\hat P_{t,a}</code>
is the fitted proportion, then the estimated sample size in that year
is:
</p>
<p style="text-align: center;"><code class="reqn">\hat n_t=\left.\sum_a{\hat P_{t,a}(1-\hat
      P_{t,a})}\right/\sum_a{(P_{t,a}-\hat P_{t,a})^2}</code>
</p>

<p>Due to the non-random and non-independent nature of sampling fish, the
effective sample size, for statistical purposes, is much less than the
number of fish sampled. Common starting points include using the
number of tows as the sample size in each year, or using the empirical
multinomial sample sizes. Those &ldquo;initial&rdquo; sample sizes can then
be scaled up or down. Sample sizes between 20 and 200 are common in
the stock assessment literature.
</p>


<h3>References</h3>

<p>Gavaris, S. and Ianelli, J. N. (2002) Statistical issues in fisheries'
stock assessments. <em>Scandinavian Journal of Statistics</em>,
<b>29</b>, 245&ndash;271.
</p>
<p>Magnusson, A., Punt, A. E. and Hilborn, R. (2013) Measuring
uncertainty in fisheries stock assessment: the delta method,
bootstrap, and MCMC. <em>Fish and Fisheries</em>, <b>14</b>, 325&ndash;342.
</p>
<p>McAllister, M. K. and Ianelli, J. N. (1997) Bayesian stock assessment
using catch-age data and the sampling-importance resampling algorithm.
<em>Canadian Journal of Fisheries and Aquaticic Sciences</em>,
<b>54</b>, 284&ndash;300.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+getN">getN</a></code>, <code><a href="#topic+getSigmaI">getSigmaI</a></code>, <code><a href="#topic+getSigmaR">getSigmaR</a></code>,
<code>estN</code>, <code><a href="#topic+estSigmaI">estSigmaI</a></code>, and <code><a href="#topic+estSigmaR">estSigmaR</a></code>
extract and estimate sample sizes and sigmas.
</p>
<p><code><a href="#topic+iterate">iterate</a></code> combines all the <code>get*</code> and <code>est*</code>
functions in one call.
</p>
<p><code><a href="#topic+plotCA">plotCA</a></code> and <code><a href="#topic+plotCL">plotCL</a></code> show what is behind the
sample-size estimation.
</p>
<p><code><a href="#topic+scape-package">scape-package</a></code> gives an overview of the package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Exploring candidate sample sizes:

getN(x.sbw)     # sample sizes used in assessment: number of tows
estN(x.sbw)     # effective sample size, given data (tows) and model fit
estN(x.sbw, ceiling=200)  # could use this
estN(x.sbw, init=FALSE)   # from model fit, disregarding tows
plotCA(x.sbw)             # years with good fit =&gt; large sample size
estN(x.sbw, init=1)       # one sample size across all years
estN(x.sbw, init=c(rep(1,14),rep(2,9)))  # two sampling periods

## Same mean, regardless of init:

mean(estN(x.sbw, digits=NULL))
mean(estN(x.sbw, digits=NULL, init=FALSE))
mean(estN(x.sbw, digits=NULL, init=1))
mean(estN(x.sbw, digits=NULL, init=c(rep(1,14),rep(2,9))))

## Same median, regardless of init:

median(estN(x.sbw, FUN=median, digits=NULL))
median(estN(x.sbw, FUN=median, digits=NULL, init=FALSE))
median(estN(x.sbw, FUN=median, digits=NULL, init=1))
median(estN(x.sbw, FUN=median, digits=NULL, init=c(rep(1,14),rep(2,9))))

## Multiple series:

getN(x.ling, "CLc")              # sample size used in assessment
getN(x.ling, "CLc", digits=0)    # rounded
estN(x.ling, "CLc")              # model fit implies larger sample sizes

getN(x.ling, "CLc", series="1", digits=0)  # get one series
estN(x.ling, "CLc", series="1")            # estimate one series
</code></pre>

<hr>
<h2 id='estSigmaI'>Estimate Abundance Index Sigma</h2><span id='topic+estSigmaI'></span>

<h3>Description</h3>

<p>Estimate the effective sigma (magnitude of observation noise) for a
survey or commercial abundance index, based on the empirical standard
deviation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estSigmaI(model, what="s", series=NULL, init=NULL, FUN=mean, p=1,
          digits=2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estSigmaI_+3A_model">model</code></td>
<td>
<p>fitted <code>scape</code> model containing element <code>CPUE</code>
and/or <code>Survey</code>.</p>
</td></tr>
<tr><td><code id="estSigmaI_+3A_what">what</code></td>
<td>
<p>which effective sigma to estimate: <code>"c"</code>[ommercial]
or <code>"s"</code>[urvey] abundance index.</p>
</td></tr>
<tr><td><code id="estSigmaI_+3A_series">series</code></td>
<td>
<p>vector of strings indicating which gears or surveys to
analyze (all by default).</p>
</td></tr>
<tr><td><code id="estSigmaI_+3A_init">init</code></td>
<td>
<p>initial sigma, determining the relative pattern of the
effective sigmas between years.</p>
</td></tr>
<tr><td><code id="estSigmaI_+3A_fun">FUN</code></td>
<td>
<p>function to use when scaling a vector of sigmas.</p>
</td></tr>
<tr><td><code id="estSigmaI_+3A_p">p</code></td>
<td>
<p>effective number of parameters estimated in the model.</p>
</td></tr>
<tr><td><code id="estSigmaI_+3A_digits">digits</code></td>
<td>
<p>number of decimal places to use when rounding, or
<code>NULL</code> to suppress rounding.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>init</code> sigmas set a fixed pattern for the relative sigmas
between years. For example, if there are two years of abundance index
data and the initial sigmas are 0.1 in year 1 and 0.2 in year 2, the
effective sigma will be two times greater in year 2 than in year 1,
although both will be scaled up or down depending on how closely the
model fits the abundance index. The value of <code>init</code> can be one of
the following:
</p>

<dl>
<dt><code>NULL</code></dt><dd><p>means read the initial sigmas from the existing
<code>CV</code> column (default).</p>
</dd>
<dt>model</dt><dd><p>means read the initial sigmas from the <code>CV</code> column
in that model (object of class <code>scape</code>).</p>
</dd>
<dt>numeric vector</dt><dd><p>means those are the initial sigmas (same
length as the number of years).</p>
</dd>
<dt><code>FALSE</code> or <code>1</code></dt><dd><p>means use one effective sigma
(<code class="reqn">\hat sigma</code>) across all years.</p>
</dd>
</dl>

<p>The idea behind <code>FUN=mean</code> is to guarantee that regardless of the
value of <code>init</code>, the mean effective sigma will always be the
same. Other functions can be used to a similar effect, such as
<code>FUN=median</code>.
</p>


<h3>Value</h3>

<p>Numeric vector of effective sigmas (one value if <code>init=1</code>), or a
list of such vectors when analyzing multiple series.
</p>


<h3>Note</h3>

<p>This function uses the empirical standard deviation to estimate an
effective sigma, which may be appropriate as likelihood weights for
abundance index data. The better the model fits the data, the smaller
the effective sigma.
</p>
<p><code>estSigmaI</code> can be used iteratively, along with
<code><a href="#topic+estN">estN</a></code> and <code><a href="#topic+estSigmaR">estSigmaR</a></code> to assign likelihood
weights that are indicated by the model fit to the data. Sigmas and
sample sizes are then adjusted between model runs, until they
converge. The <code>iterate</code> function facilitates this procedure.
</p>
<p>If <code class="reqn">rss</code> is the residual sum of squares in log space, <code class="reqn">n</code> is
the number of abundance index data points, and <code class="reqn">p</code> is the
effective number of parameters estimated in the model, then the
estimated effective sigma is:
</p>
<p style="text-align: center;"><code class="reqn">\hat\sigma=\sqrt{\frac{rss}{n-p}}</code>
</p>

<p>There is no simple way to calculate <code class="reqn">p</code> for statistical
catch-at-age models. The default value of 1 is likely to underestimate
the true magnitude of observation noise.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+getN">getN</a></code>, <code><a href="#topic+getSigmaI">getSigmaI</a></code>, <code><a href="#topic+getSigmaR">getSigmaR</a></code>,
<code><a href="#topic+estN">estN</a></code>, <code>estSigmaI</code>, and <code><a href="#topic+estSigmaR">estSigmaR</a></code>
extract and estimate sample sizes and sigmas.
</p>
<p><code><a href="#topic+iterate">iterate</a></code> combines all the <code>get*</code> and <code>est*</code>
functions in one call.
</p>
<p><code><a href="#topic+plotIndex">plotIndex</a></code> shows what is behind the sigma estimation.
</p>
<p><code><a href="#topic+scape-package">scape-package</a></code> gives an overview of the package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Exploring candidate sigmas:

getSigmaI(x.cod)       # sigma used in assessment 0.20
estSigmaI(x.cod)       # model fit implies 0.17
plotIndex(x.cod)       # model fit
estSigmaI(x.cod, p=8)  # eight estimated parameters implies 0.22

getSigmaI(x.sbw)          # sigma used in assessment
estSigmaI(x.sbw)          # model fit implies smaller sigma
estSigmaI(x.sbw, init=1)  # could use 0.17 in all years

## Same mean, regardless of init:

mean(estSigmaI(x.sbw, digits=NULL))
mean(estSigmaI(x.sbw, digits=NULL, init=1))

## Same median, regardless of init:

median(estSigmaI(x.sbw, FUN=median, digits=NULL))
median(estSigmaI(x.sbw, FUN=median, digits=NULL, init=1))

## Multiple series:

getSigmaI(x.oreo, "c")                 # sigma used in assessment
getSigmaI(x.oreo, "c", digits=2)       # rounded
estSigmaI(x.oreo, "c")                 # model fit implies smaller sigma
estSigmaI(x.oreo, "c", init=1)         # could use 0.19 in all years
estSigmaI(x.oreo, "c", init=1, digits=3)  # series 2 slightly worse fit
# estSigmaI(x.oreo, "c", init=1, p=11) # more parameters than datapoints

getSigmaI(x.oreo, "c", series="Series 2-1")  # get one series
estSigmaI(x.oreo, "c", series="Series 2-1")  # estimate one series
</code></pre>

<hr>
<h2 id='estSigmaR'>Estimate Recruitment Sigma</h2><span id='topic+estSigmaR'></span>

<h3>Description</h3>

<p>Estimate sigma R (recruitment variability), based on the empirical
standard deviation of recruitment deviates in log space.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estSigmaR(model, digits=2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estSigmaR_+3A_model">model</code></td>
<td>
<p>fitted <code>scape</code> model containing element <code>Dev</code>.</p>
</td></tr>
<tr><td><code id="estSigmaR_+3A_digits">digits</code></td>
<td>
<p>number of decimal places to use when rounding, or
<code>NULL</code> to suppress rounding.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of two numbers, estimating recruitment variability based on (1)
the estimated age composition in the first year, and (2) subsequent
annual recruitment.
</p>


<h3>Note</h3>

<p>This function uses the empirical standard deviation to estimate sigma
R, which may be appropriate as likelihood penalty (or Bayesian prior
distribution) for recruitment deviates from the stock-recruitment
curve. The smaller the estimated recruitment deviates, the smaller the
estimated sigma R.
</p>
<p><code>estSigmaR</code> can be used iteratively, along with
<code><a href="#topic+estN">estN</a></code> and <code><a href="#topic+estSigmaI">estSigmaI</a></code> to assign likelihood
weights that are indicated by the model fit to the data. Sigmas and
sample sizes are then adjusted between model runs, until they
converge. The <code>iterate</code> function facilitates this procedure.
</p>
<p>If <code class="reqn">ss</code> is the sum of squared recruitment deviates in log space
and <code class="reqn">n</code> is the number of estimated recruitment deviates, then the
estimated sigma R is:
</p>
<p style="text-align: center;"><code class="reqn">\sigma_R=\sqrt{\frac{ss}{n}}</code>
</p>

<p>The denominator is neither <code class="reqn">n-</code>1 nor <code class="reqn">n-p</code>, since <code class="reqn">ss</code> is
based on deviates from zero and not the mean, and the deviates do not
converge to zero as the number of model parameters increases.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+getN">getN</a></code>, <code><a href="#topic+getSigmaI">getSigmaI</a></code>, <code><a href="#topic+getSigmaR">getSigmaR</a></code>,
<code><a href="#topic+estN">estN</a></code>, <code><a href="#topic+estSigmaI">estSigmaI</a></code>, and <code>estSigmaR</code>
extract and estimate sample sizes and sigmas.
</p>
<p><code><a href="#topic+iterate">iterate</a></code> combines all the <code>get*</code> and <code>est*</code>
functions in one call.
</p>
<p><code><a href="#topic+plotN">plotN</a></code> and <code><a href="#topic+plotB">plotB</a>(..., what="s")</code> show what
is behind the sigma R estimation.
</p>
<p><code><a href="#topic+scape-package">scape-package</a></code> gives an overview of the package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>getSigmaR(x.cod)  # sigmaR used in assessment 0.5 and 1.0
estSigmaR(x.cod)  # model estimates imply 0.20 and 0.52

getSigmaR(x.ling)  # 0.6, deterministic age distribution in first year
estSigmaR(x.ling)  # model estimates imply 0.36

getSigmaR(x.sbw)
estSigmaR(x.sbw)  # large deviates in first year
plotN(x.sbw)      # enormous plus group and 1991 cohort

# x.oreo assessment had deterministic recruitment, so no deviates
</code></pre>

<hr>
<h2 id='getN'>Extract Sample Size</h2><span id='topic+getN'></span>

<h3>Description</h3>

<p>Extract the sample size that was used in a model, from catch-at-age or
catch-at-length data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getN(model, what="CAc", series=NULL, digits=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getN_+3A_model">model</code></td>
<td>
<p>fitted <code>scape</code> model containing catch-at-age and/or
catch-at-length data.</p>
</td></tr>
<tr><td><code id="getN_+3A_what">what</code></td>
<td>
<p>name of model element: <code>"CAc"</code>, <code>"CAs"</code>,
<code>"CLc"</code>, or <code>"CLs"</code>.</p>
</td></tr>
<tr><td><code id="getN_+3A_series">series</code></td>
<td>
<p>vector of strings indicating which gears or surveys to
analyze (all by default).</p>
</td></tr>
<tr><td><code id="getN_+3A_digits">digits</code></td>
<td>
<p>number of decimal places to use when rounding, or
<code>NULL</code> to suppress rounding.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric vector of year-specific sample sizes, or a list of such
vectors when analyzing multiple series.
</p>


<h3>Note</h3>

<p>Thin wrapper to access <code>model$element$SS</code>, providing a uniform
interface with other <code>get*</code> and <code>est*</code> functions.
</p>
<p>See discussion in the <code><a href="#topic+estN">estN</a></code> documentation.
</p>


<h3>See Also</h3>

<p><code>getN</code>, <code><a href="#topic+getSigmaI">getSigmaI</a></code>, <code><a href="#topic+getSigmaR">getSigmaR</a></code>,
<code><a href="#topic+estN">estN</a></code>, <code><a href="#topic+estSigmaI">estSigmaI</a></code>, and
<code><a href="#topic+estSigmaR">estSigmaR</a></code> extract and estimate sample sizes and sigmas.
</p>
<p><code><a href="#topic+scape-package">scape-package</a></code> gives an overview of the package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Exploring candidate sample sizes:

getN(x.sbw)  # sample sizes used in assessment: number of tows
estN(x.sbw)  # effective sample size, given data (tows) and model fit

## Multiple series:

getN(x.ling, "CLc")              # sample size used in assessment
getN(x.ling, "CLc", digits=0)    # rounded
estN(x.ling, "CLc")              # model fit implies larger sample sizes

getN(x.ling, "CLc", series="1", digits=0)  # get one series
estN(x.ling, "CLc", series="1")            # estimate one series
</code></pre>

<hr>
<h2 id='getSigmaI'>Extract Abundance Index Sigma</h2><span id='topic+getSigmaI'></span>

<h3>Description</h3>

<p>Extract the sigma (magnitude of observation noise) that was used in a
model, from survey or commercial abundance index data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getSigmaI(model, what="s", series=NULL, digits=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getSigmaI_+3A_model">model</code></td>
<td>
<p>fitted <code>scape</code> model containing element <code>CPUE</code>
and/or <code>Survey</code>.</p>
</td></tr>
<tr><td><code id="getSigmaI_+3A_what">what</code></td>
<td>
<p>which sigma to extract: <code>"c"</code>[ommercial] or
<code>"s"</code>[urvey] abundance index.</p>
</td></tr>
<tr><td><code id="getSigmaI_+3A_series">series</code></td>
<td>
<p>vector of strings indicating which gears or surveys to
analyze (all by default).</p>
</td></tr>
<tr><td><code id="getSigmaI_+3A_digits">digits</code></td>
<td>
<p>number of decimal places to use when rounding, or
<code>NULL</code> to suppress rounding.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric vector of year-specific sigmas, or a list of such vectors when
analyzing multiple series.
</p>


<h3>Note</h3>

<p>Thin wrapper to access <code>model$element$CV</code>, providing a uniform
interface with other <code>get*</code> and <code>est*</code> functions.
</p>
<p>See discussion in the <code><a href="#topic+estSigmaI">estSigmaI</a></code> documentation.
</p>


<h3>See Also</h3>

<p><code>getN</code>, <code><a href="#topic+getSigmaI">getSigmaI</a></code>, <code><a href="#topic+getSigmaR">getSigmaR</a></code>,
<code><a href="#topic+estN">estN</a></code>, <code><a href="#topic+estSigmaI">estSigmaI</a></code>, and
<code><a href="#topic+estSigmaR">estSigmaR</a></code> extract and estimate sample sizes and sigmas.
</p>
<p><code><a href="#topic+scape-package">scape-package</a></code> gives an overview of the package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Exploring candidate sigmas:

getSigmaI(x.cod)  # sigma used in assessment 0.20
estSigmaI(x.cod)  # model fit implies 0.17

## Multiple series:

getSigmaI(x.oreo, "c")                 # sigma used in assessment
getSigmaI(x.oreo, "c", digits=2)       # rounded
estSigmaI(x.oreo, "c")                 # model fit implies smaller sigma

getSigmaI(x.oreo, "c", series="Series 2-1")  # get one series
estSigmaI(x.oreo, "c", series="Series 2-1")  # estimate one series
</code></pre>

<hr>
<h2 id='getSigmaR'>Extract Recruitment sigma</h2><span id='topic+getSigmaR'></span>

<h3>Description</h3>

<p>Extract sigma R (recruitment variability) that was used in a model, as
indicated in the <code>Dev$sigmaR</code> model component.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getSigmaR(model, digits=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getSigmaR_+3A_model">model</code></td>
<td>
<p>fitted <code>scape</code> model containing element <code>Dev</code>.</p>
</td></tr>
<tr><td><code id="getSigmaR_+3A_digits">digits</code></td>
<td>
<p>digits</p>
</td></tr></table>
<p>number of decimal places to use when rounding,
or <code>NULL</code> to suppress rounding.
</p>


<h3>Value</h3>

<p>Vector of two numbers, representing recruitment variability in (1) the
estimated age composition in the first year, and (2) subsequent annual
recruitment.
</p>


<h3>Note</h3>

<p>Thin wrapper to access <code>model$Dev$sigmaR</code>, providing a uniform
interface with other <code>get*</code> and <code>est*</code> functions.
</p>
<p>See discussion in the <code><a href="#topic+estSigmaR">estSigmaR</a></code> documentation.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+getN">getN</a></code>, <code><a href="#topic+getSigmaI">getSigmaI</a></code>, <code>getSigmaR</code>,
<code><a href="#topic+estN">estN</a></code>, <code><a href="#topic+estSigmaI">estSigmaI</a></code>, and
<code><a href="#topic+estSigmaR">estSigmaR</a></code> extract and estimate sample sizes and sigmas.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>getSigmaR(x.cod)  # sigmaR used in assessment 0.5 and 1.0
estSigmaR(x.cod)  # model estimates imply 0.20 and 0.52

getSigmaR(x.ling)  # 0.6, deterministic age distribution in first year
estSigmaR(x.ling)  # model estimates imply 0.36

getSigmaR(x.sbw)
estSigmaR(x.sbw)  # large deviates in first year
plotN(x.sbw)      # enormous plus group and 1991 cohort

# x.oreo assessment had deterministic recruitment, so no deviates
</code></pre>

<hr>
<h2 id='importADCAM'>Import ADCAM Model Results</h2><span id='topic+importADCAM'></span>

<h3>Description</h3>

<p>Import ADCAM model results into a standard format suitable for
plotting.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>importADCAM(dir)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="importADCAM_+3A_dir">dir</code></td>
<td>
<p>directory containing the results files
(&lsquo;<span class="file">resultsbyyearandage</span>&rsquo;, &lsquo;<span class="file">resultsbyyear</span>&rsquo;,
&lsquo;<span class="file">resultsbyage</span>&rsquo;), as well as the input file
&lsquo;<span class="file">catchparameters</span>&rsquo; specifying selectivity periods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of class <code>scape</code> containing the following elements:
</p>
<table>
<tr><td><code>N</code></td>
<td>
<p>predicted numbers at age</p>
</td></tr>
<tr><td><code>B</code></td>
<td>
<p>predicted biomass, recruitment, and observed landings (year
things)</p>
</td></tr>
<tr><td><code>Sel</code></td>
<td>
<p>predicted selectivity and observed maturity (age things)</p>
</td></tr>
<tr><td><code>Dev</code></td>
<td>
<p>predicted recruitment deviates from the stock-recruitment
curve</p>
</td></tr>
<tr><td><code>Survey</code></td>
<td>
<p>survey abundance index and fit</p>
</td></tr>
<tr><td><code>CAc</code></td>
<td>
<p>commercial C@A (catch at age) and fit</p>
</td></tr>
<tr><td><code>CAs</code></td>
<td>
<p>survey C@A (catch at age) and fit</p>
</td></tr>
</table>


<h3>Note</h3>

<p><code>B$VB</code> is reference biomass.
</p>
<p><code>Survey$CV</code> is <code>0</code> to give <code>plotIndex</code> sensible y-axis
limits.
</p>
<p><code>CAc$SS</code> and <code>CAs$SS</code> are the
<code>log(obs+const) - log(fit+const)</code> residuals used in the ADCAM
likelihood.
</p>


<h3>References</h3>

<p>Bjornsson, H. and A. Magnusson. (2009) <em>ADCAM user manual (draft
version).</em> ICES CM 2009/ACOM:56, Annex 6.
</p>


<h3>See Also</h3>

<p><code><a href="utils.html#topic+read.table">read.table</a></code>, <code><a href="base.html#topic+readLines">readLines</a></code>, and
<code><a href="base.html#topic+scan">scan</a></code> import any data.
</p>
<p><code><a href="#topic+x.saithe">x.saithe</a></code> was created using <code>importADCAM</code>.
</p>
<p><code><a href="#topic+importCol">importCol</a></code> imports Coleraine model results.
</p>
<p><code><a href="#topic+scape-package">scape-package</a></code> gives an overview of the package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>path &lt;- system.file("example/saithe", package="scape")
saithe &lt;- importADCAM(path)
</code></pre>

<hr>
<h2 id='importCol'>Import Coleraine Model Results</h2><span id='topic+importCol'></span>

<h3>Description</h3>

<p>Import Coleraine model results from &lsquo;<span class="file">.res</span>&rsquo; file, and rearrange
into a standard format suitable for plotting.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>importCol(res.file, Dev=FALSE, CPUE=FALSE, Survey=FALSE, CAc=FALSE,
          CAs=FALSE, CLc=FALSE, CLs=FALSE, LA=FALSE, quiet=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="importCol_+3A_res.file">res.file</code></td>
<td>
<p>name of Coleraine model results file to import.</p>
</td></tr>
<tr><td><code id="importCol_+3A_dev">Dev</code></td>
<td>
<p>whether recruitment deviates were estimated in model.</p>
</td></tr>
<tr><td><code id="importCol_+3A_cpue">CPUE</code></td>
<td>
<p>whether model was fitted to catch-per-unit-effort data.</p>
</td></tr>
<tr><td><code id="importCol_+3A_survey">Survey</code></td>
<td>
<p>whether model was fitted to survey abundance index
data.</p>
</td></tr>
<tr><td><code id="importCol_+3A_cac">CAc</code></td>
<td>
<p>whether model was fitted to commercial catch-at-age data.</p>
</td></tr>
<tr><td><code id="importCol_+3A_cas">CAs</code></td>
<td>
<p>whether model was fitted to survey catch-at-age data.</p>
</td></tr>
<tr><td><code id="importCol_+3A_clc">CLc</code></td>
<td>
<p>whether model was fitted to commercial catch-at-length
data.</p>
</td></tr>
<tr><td><code id="importCol_+3A_cls">CLs</code></td>
<td>
<p>whether model was fitted to survey catch-at-length data.</p>
</td></tr>
<tr><td><code id="importCol_+3A_la">LA</code></td>
<td>
<p>whether model was fitted to length-at-age data.</p>
</td></tr>
<tr><td><code id="importCol_+3A_quiet">quiet</code></td>
<td>
<p>whether to report progress while parsing file.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of class <code>scape</code> containing at least <code>N</code>, <code>B</code>,
and <code>Sel</code>. The other elements may or may not be included in the
list, depending on how <code>importCol</code> was called:
</p>
<table>
<tr><td><code>N</code></td>
<td>
<p>predicted numbers at age</p>
</td></tr>
<tr><td><code>B</code></td>
<td>
<p>predicted biomass, recruitment, and observed landings (year
things)</p>
</td></tr>
<tr><td><code>Sel</code></td>
<td>
<p>predicted selectivity and observed maturity (age things)</p>
</td></tr>
<tr><td><code>Dev</code></td>
<td>
<p>predicted recruitment deviates from the stock-recruitment
curve</p>
</td></tr>
<tr><td><code>CPUE</code>, <code>Survey</code></td>
<td>
<p>commercial and survey abundance index and fit</p>
</td></tr>
<tr><td><code>CAc</code>, <code>CAs</code></td>
<td>
<p>commercial and survey C@A (catch at age) and fit</p>
</td></tr>
<tr><td><code>CLc</code>, <code>CLs</code></td>
<td>
<p>commercial and survey C@L (catch at length) and fit</p>
</td></tr>
<tr><td><code>LA</code></td>
<td>
<p>observed L@A and fit</p>
</td></tr>
</table>


<h3>Note</h3>

<p>This import function is implemented for the Coleraine statistical
catch-at-age software, and can serve as a template for <span class="pkg">scape</span>
users who would like to implement import functions for specific stock
assessment software.
</p>
<p>The functions <code>ll</code> (package <span class="pkg">gdata</span>) and <code>head</code> are
recommended for browsing nested objects, e.g. <code>ll(x.cod)</code>,
<code>ll(x.cod$N)</code>, and <code>head(x.cod$N)</code>.
</p>


<h3>References</h3>

<p>Hilborn, R., Maunder, M., Parma, A., Ernst, B., Payne, J. and Starr,
P. (2003) <em>Coleraine: A generalized age-structured stock
assessment model.</em> User's manual version 2.0. University of
Washington Report SAFS-UW-0116.
</p>


<h3>See Also</h3>

<p><code><a href="utils.html#topic+read.table">read.table</a></code>, <code><a href="base.html#topic+readLines">readLines</a></code>, and
<code><a href="base.html#topic+scan">scan</a></code> import any data.
</p>
<p><code><a href="#topic+x.cod">x.cod</a></code>, <code><a href="#topic+x.ling">x.ling</a></code>, <code><a href="#topic+x.oreo">x.oreo</a></code>, and
<code><a href="#topic+x.sbw">x.sbw</a></code> were created using <code>importCol</code>.
</p>
<p><code><a href="#topic+importADCAM">importADCAM</a></code> imports ADCAM model results.
</p>
<p><code><a href="#topic+scape-package">scape-package</a></code> gives an overview of the package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>path &lt;- system.file("example/cod.res", package="scape")
cod &lt;- importCol(path, Dev=TRUE, Survey=TRUE, CAc=TRUE, CAs=TRUE)
</code></pre>

<hr>
<h2 id='importMCMC'>Import Coleraine MCMC Results</h2><span id='topic+importMCMC'></span>

<h3>Description</h3>

<p>Import Coleraine MCMC traces for likelihoods, parameters, spawning
biomass, and recruitment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>importMCMC(dir, coda=FALSE, quiet=TRUE, pretty.labels=FALSE,
           l.choose=NULL, p.choose=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="importMCMC_+3A_dir">dir</code></td>
<td>
<p>directory containing the files &lsquo;<span class="file">mcmclike.out</span>&rsquo;,
&lsquo;<span class="file">params.pst</span>&rsquo;, &lsquo;<span class="file">spawbiom.pst</span>&rsquo; and &lsquo;<span class="file">recruits.pst</span>&rsquo;.</p>
</td></tr>
<tr><td><code id="importMCMC_+3A_coda">coda</code></td>
<td>
<p>whether data frames should be coerced to class <code>mcmc</code>
using the <span class="pkg">coda</span> package.</p>
</td></tr>
<tr><td><code id="importMCMC_+3A_quiet">quiet</code></td>
<td>
<p>whether to report progress while parsing files in
directory.</p>
</td></tr>
<tr><td><code id="importMCMC_+3A_pretty.labels">pretty.labels</code></td>
<td>
<p>whether likelihood and parameter columns should
be renamed</p>
</td></tr>
<tr><td><code id="importMCMC_+3A_l.choose">l.choose</code></td>
<td>
<p>vector of strings, indicating which likelihood
components to import, or <code>NULL</code> to import all.</p>
</td></tr>
<tr><td><code id="importMCMC_+3A_p.choose">p.choose</code></td>
<td>
<p>vector of strings, indicating which parameters to
import, or <code>NULL</code> to import all.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing:
</p>
<table>
<tr><td><code>L</code></td>
<td>
<p>likelihoods</p>
</td></tr>
<tr><td><code>P</code></td>
<td>
<p>parameters</p>
</td></tr>
<tr><td><code>B</code></td>
<td>
<p>biomass by year</p>
</td></tr>
<tr><td><code>R</code></td>
<td>
<p>recruitment by year</p>
</td></tr>
</table>
<p>as data frames, or <code>mcmc</code> objects if <code>coda=TRUE</code>.
</p>


<h3>Note</h3>

<p>The functions <code>ll</code> (package <span class="pkg">gdata</span>) and <code>head</code> are
recommended for browsing nested objects, e.g. <code>ll(xmcmc)</code>,
<code>ll(xmcmc$P)</code>, and <code>head(xmcmc$P)</code>.
</p>
<p>The <span class="pkg">plotMCMC</span> package is recommended for plotting MCMC
diagnostics and posteriors.
</p>


<h3>References</h3>

<p>Hilborn, R., Maunder, M., Parma, A., Ernst, B., Payne, J. and Starr,
P. (2003) <em>Coleraine: A generalized age-structured stock
assessment model.</em> User's manual version 2.0. University of
Washington Report SAFS-UW-0116.
</p>


<h3>See Also</h3>

<p><code><a href="utils.html#topic+read.table">read.table</a></code>, <code><a href="base.html#topic+readLines">readLines</a></code>, and
<code><a href="base.html#topic+scan">scan</a></code> import any data.
</p>
<p><code>importMCMC</code> and <code><a href="#topic+importProj">importProj</a></code> import Coleraine MCMC
results.
</p>
<p><code><a href="#topic+xmcmc">xmcmc</a></code> was created using <code>importMCMC</code>.
</p>
<p><code><a href="#topic+scape-package">scape-package</a></code> gives an overview of the package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>path &lt;- system.file("example/mcmc", package="scape")
mcmc &lt;- importMCMC(path)  # or rename and select particular elements:
mcmc &lt;- importMCMC(path, pretty.labels=TRUE,
                   l.choose=c("CAc","CAs","Survey","Prior","Total"),
                   p.choose=c("R0","Rinit","uinit","cSleft","cSfull",
                              "sSleft","sSfull","logq"))
</code></pre>

<hr>
<h2 id='importProj'>Import Coleraine MCMC Projections</h2><span id='topic+importProj'></span>

<h3>Description</h3>

<p>Import Coleraine MCMC traces for spawning biomass and catch, projected
into the near future.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>importProj(dir, coda=FALSE, quiet=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="importProj_+3A_dir">dir</code></td>
<td>
<p>directory containing the files &lsquo;<span class="file">strategy.out</span>&rsquo;,
&lsquo;<span class="file">projspbm.pst</span>&rsquo; and &lsquo;<span class="file">procatch.pst</span>&rsquo;.</p>
</td></tr>
<tr><td><code id="importProj_+3A_coda">coda</code></td>
<td>
<p>whether data frames should be coerced to class <code>mcmc</code>
using the <span class="pkg">coda</span> package.</p>
</td></tr>
<tr><td><code id="importProj_+3A_quiet">quiet</code></td>
<td>
<p>whether to report progress while parsing files in
directory.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing:
</p>
<table>
<tr><td><code>B</code></td>
<td>
<p>biomass by catch policy and year</p>
</td></tr>
<tr><td><code>Y</code></td>
<td>
<p>catch by catch policy and year</p>
</td></tr>
</table>
<p>as lists of data frames, or <code>mcmc</code> objects if <code>coda=TRUE</code>.
</p>


<h3>Note</h3>

<p>MCMC projections can be used to evaluate the short-term outcome of
harvest policies (constant catch or constant harvest rate), given the
uncertainty about parameter values and random future recruitment.
</p>
<p>The functions <code>ll</code> (package <span class="pkg">gdata</span>) and <code>head</code> are
recommended for browsing nested objects, e.g. <code>ll(xproj)</code>,
<code>ll(xproj$B)</code>, <code>ll(xproj$B$"0.2")</code>, and
<code>head(xproj$B$"0.2")</code>.
</p>
<p>The <span class="pkg">plotMCMC</span> package is recommended for plotting MCMC
diagnostics and posteriors.
</p>


<h3>References</h3>

<p>Hilborn, R., Maunder, M., Parma, A., Ernst, B., Payne, J. and Starr,
P. (2003) <em>Coleraine: A generalized age-structured stock
assessment model.</em> User's manual version 2.0. University of
Washington Report SAFS-UW-0116.
</p>


<h3>See Also</h3>

<p><code><a href="utils.html#topic+read.table">read.table</a></code>, <code><a href="base.html#topic+readLines">readLines</a></code>, and
<code><a href="base.html#topic+scan">scan</a></code> import any data.
</p>
<p><code><a href="#topic+importMCMC">importMCMC</a></code> and <code>importProj</code> import Coleraine MCMC
results.
</p>
<p><code><a href="#topic+xproj">xproj</a></code> was created using <code>importProj</code>.
</p>
<p><code><a href="#topic+scape-package">scape-package</a></code> gives an overview of the package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>path &lt;- system.file("example/mcmc", package="scape")
proj &lt;- importProj(path)
</code></pre>

<hr>
<h2 id='iterate'>Get Candidate Sigmas and Sample Sizes</h2><span id='topic+iterate'></span>

<h3>Description</h3>

<p>Compare current sigmas and sample sizes with candidate values, by
running variations of <code>estSigmaR</code>, <code>estN</code>, and
<code>estSigmaI</code> on all model components.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>iterate(model, ceiling=Inf, p=1, digits.n=0, digits.sigma=2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="iterate_+3A_model">model</code></td>
<td>
<p>fitted <code>scape</code> model.</p>
</td></tr>
<tr><td><code id="iterate_+3A_ceiling">ceiling</code></td>
<td>
<p>largest possible sample size in one year, passed to
<code>estN</code>.</p>
</td></tr>
<tr><td><code id="iterate_+3A_p">p</code></td>
<td>
<p>effective number of parameters estimated in the model, passed
to <code>estSigmaI</code>.</p>
</td></tr>
<tr><td><code id="iterate_+3A_digits.n">digits.n</code></td>
<td>
<p>number of decimal places to use when rounding sample
sizes, or <code>NULL</code> to suppress rounding.</p>
</td></tr>
<tr><td><code id="iterate_+3A_digits.sigma">digits.sigma</code></td>
<td>
<p>number of decimal places to use when rounding
sigmas, or <code>NULL</code> to suppress rounding.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List containing data frames summarizing current sigmas and sample
sizes, as well as candidate values. The following abbreviations are
used in column names:
</p>

<dl>
<dt>sigmahat</dt><dd><p>candidate sigma, the empirical standard deviation.</p>
</dd>
<dt>nhat</dt><dd><p>candidate sample sizes, the empirical multinomial sample
sizes.</p>
</dd>
<dt>candbar</dt><dd><p>vector of candidate values, whose mean equals
<code>sigmahat</code> or <code>nhat</code>.</p>
</dd>
<dt>candmed</dt><dd><p>vector of candidate values, whose median equals
<code>sigmahat</code> or <code>nhat</code>.</p>
</dd>
<dt>candbar1</dt><dd><p>vector of identical candidate values, the mean of
<code>nhat</code>.</p>
</dd>
<dt>candmed1</dt><dd><p>vector of identical candidate values, the median of
<code>nhat</code>.</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+getN">getN</a></code>, <code><a href="#topic+getSigmaI">getSigmaI</a></code>, <code><a href="#topic+getSigmaR">getSigmaR</a></code>,
<code><a href="#topic+estN">estN</a></code>, <code><a href="#topic+estSigmaI">estSigmaI</a></code>, and
<code><a href="#topic+estSigmaR">estSigmaR</a></code> extract and estimate sample sizes and sigmas.
</p>
<p><code>iterate</code> combines all the <code>get*</code> and <code>est*</code>
functions in one call.
</p>
<p><code><a href="#topic+scape-package">scape-package</a></code> gives an overview of the package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>iterate(x.cod)
iterate(x.ling)
iterate(x.oreo)
iterate(x.sbw)
</code></pre>

<hr>
<h2 id='plotB'>Plot Biomass, Recruitment, and Landings</h2><span id='topic+plotB'></span>

<h3>Description</h3>

<p>Plot <code>scape</code> model predicted biomass, stock recruitment, and
landings.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotB(model, what="d", series=NULL, years=NULL, axes=TRUE, div=1,
      legend="bottom", main="", xlab="", ylab="", cex.main=1.2,
      cex.legend=1, cex.lab=1, cex.axis=0.8, las=1,
      tck=c(1,what=="d")/2, tick.number=5, lty.grid=3, col.grid="white",
      pch=16, cex.points=0.8, col.points="black", lty.lines=1:3,
      lwd.lines=2, col.lines="black", ratio.bars=3, col.bars="gray",
      plot=TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotB_+3A_model">model</code></td>
<td>
<p>fitted <code>scape</code> model.</p>
</td></tr>
<tr><td><code id="plotB_+3A_what">what</code></td>
<td>
<p>what to plot: <code>"d"</code>[efault], <code>"s"</code>[tock
recruitment], or <code>"l"</code>[andings].</p>
</td></tr>
<tr><td><code id="plotB_+3A_series">series</code></td>
<td>
<p>vector of strings indicating which column names in
<code>model$B</code> data frame to plot (all by default).</p>
</td></tr>
<tr><td><code id="plotB_+3A_years">years</code></td>
<td>
<p>vector of numbers indicating which years to include (all
by default).</p>
</td></tr>
<tr><td><code id="plotB_+3A_axes">axes</code></td>
<td>
<p>whether to plot axis values.</p>
</td></tr>
<tr><td><code id="plotB_+3A_div">div</code></td>
<td>
<p>denominator to shorten values on the y axis, or a vector
with two elements referring to x and y axis.</p>
</td></tr>
<tr><td><code id="plotB_+3A_legend">legend</code></td>
<td>
<p>legend location: <code>"bottom"</code>, <code>"left"</code>,
<code>"top"</code>, <code>"right"</code>, or <code>""</code> to suppress legend.</p>
</td></tr>
<tr><td><code id="plotB_+3A_main">main</code></td>
<td>
<p>main title.</p>
</td></tr>
<tr><td><code id="plotB_+3A_xlab">xlab</code></td>
<td>
<p>x-axis label.</p>
</td></tr>
<tr><td><code id="plotB_+3A_ylab">ylab</code></td>
<td>
<p>y-axis label.</p>
</td></tr>
<tr><td><code id="plotB_+3A_cex.main">cex.main</code></td>
<td>
<p>size of main title.</p>
</td></tr>
<tr><td><code id="plotB_+3A_cex.legend">cex.legend</code></td>
<td>
<p>size of legend text.</p>
</td></tr>
<tr><td><code id="plotB_+3A_cex.lab">cex.lab</code></td>
<td>
<p>size of axis labels.</p>
</td></tr>
<tr><td><code id="plotB_+3A_cex.axis">cex.axis</code></td>
<td>
<p>size of tick labels.</p>
</td></tr>
<tr><td><code id="plotB_+3A_las">las</code></td>
<td>
<p>orientation of tick labels: 0=parallel, 1=horizontal,
2=perpendicular, 3=vertical.</p>
</td></tr>
<tr><td><code id="plotB_+3A_tck">tck</code></td>
<td>
<p>tick mark length.</p>
</td></tr>
<tr><td><code id="plotB_+3A_tick.number">tick.number</code></td>
<td>
<p>number of tick marks.</p>
</td></tr>
<tr><td><code id="plotB_+3A_lty.grid">lty.grid</code></td>
<td>
<p>line type of gridlines.</p>
</td></tr>
<tr><td><code id="plotB_+3A_col.grid">col.grid</code></td>
<td>
<p>color of gridlines.</p>
</td></tr>
<tr><td><code id="plotB_+3A_pch">pch</code></td>
<td>
<p>symbol for points.</p>
</td></tr>
<tr><td><code id="plotB_+3A_cex.points">cex.points</code></td>
<td>
<p>size of points.</p>
</td></tr>
<tr><td><code id="plotB_+3A_col.points">col.points</code></td>
<td>
<p>color of points.</p>
</td></tr>
<tr><td><code id="plotB_+3A_lty.lines">lty.lines</code></td>
<td>
<p>line type of main lines.</p>
</td></tr>
<tr><td><code id="plotB_+3A_lwd.lines">lwd.lines</code></td>
<td>
<p>line width of main lines.</p>
</td></tr>
<tr><td><code id="plotB_+3A_col.lines">col.lines</code></td>
<td>
<p>color of main lines.</p>
</td></tr>
<tr><td><code id="plotB_+3A_ratio.bars">ratio.bars</code></td>
<td>
<p>width of bars.</p>
</td></tr>
<tr><td><code id="plotB_+3A_col.bars">col.bars</code></td>
<td>
<p>color of bars.</p>
</td></tr>
<tr><td><code id="plotB_+3A_plot">plot</code></td>
<td>
<p>whether to draw plot.</p>
</td></tr>
<tr><td><code id="plotB_+3A_...">...</code></td>
<td>
<p>passed to <code>xyplot</code> and <code>panel.superpose</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>"d"</code>[efault] plot shows spawning biomass and vulnerable
biomass as lines, and landings as bars, on the same scale.
</p>


<h3>Value</h3>

<p>When <code>plot=TRUE</code>, a trellis plot is drawn and a data frame is
returned, containing the data used for plotting. When
<code>plot=FALSE</code>, a trellis object is returned.
</p>


<h3>Note</h3>

<p>The <code>Args</code> function from the <span class="pkg">gdata</span> package is recommended
for reviewing the arguments, instead of <code>args</code>.
</p>


<h3>See Also</h3>

<p><code><a href="lattice.html#topic+xyplot">xyplot</a></code>, <code><a href="lattice.html#topic+panel.barchart">panel.barchart</a></code>,
and <code><a href="lattice.html#topic+panel.superpose">panel.superpose</a></code> are the underlying drawing
functions.
</p>
<p><code><a href="#topic+plotCA">plotCA</a></code>, <code><a href="#topic+plotCL">plotCL</a></code>, <code><a href="#topic+plotIndex">plotIndex</a></code>,
and <code><a href="#topic+plotLA">plotLA</a></code> plot model fit and data.
</p>
<p><code>plotB</code>, <code><a href="#topic+plotN">plotN</a></code>, and <code><a href="#topic+plotSel">plotSel</a></code> plot
derived quantities.
</p>
<p><code><a href="#topic+scape-package">scape-package</a></code> gives an overview of the package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plotB(x.ling, series=c("VB.1","VB.2","Y"), div=1000, xlab="Year\n",
      ylab="Biomass and landings (kt)")

plotB(x.ling, "s", div=1000, xlab="Biomass age 4+ (kt)",
      ylab="Recruitment (million one-year-olds)")
</code></pre>

<hr>
<h2 id='plotCA'>Plot Catch at Age</h2><span id='topic+plotCA'></span>

<h3>Description</h3>

<p>Plot <code>scape</code> model fit to catch-at-age data.</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotCA(model, what="c", fit=TRUE, swap=FALSE, series=NULL, sex=NULL,
       years=NULL, ages=NULL, axes=TRUE, same.limits=TRUE, log=FALSE,
       base=10, eps.log=1e-5, main="", xlab="", ylab="", cex.main=1.2,
       cex.lab=1, cex.axis=0.8, cex.strip=0.8, col.strip="gray95",
       strip=strip.custom(bg=col.strip), las=!fit, tck=c(1,fit)/2,
       tick.number=5, lty.grid=3, col.grid="gray", pch=16,
       cex.points=0.5, col.points="black", lty.lines=1, lwd.lines=2,
       col.lines=c("red","blue"), plot=TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotCA_+3A_model">model</code></td>
<td>
<p>fitted <code>scape</code> model containing element <code>CAc</code>
and/or <code>CAs</code>.</p>
</td></tr>
<tr><td><code id="plotCA_+3A_what">what</code></td>
<td>
<p>what to plot: <code>"c"</code>[ommercial] or <code>"s"</code>[urvey]
catch at age.</p>
</td></tr>
<tr><td><code id="plotCA_+3A_fit">fit</code></td>
<td>
<p>whether to overlay fitted values on observed data.</p>
</td></tr>
<tr><td><code id="plotCA_+3A_swap">swap</code></td>
<td>
<p>whether to swap ages and years between axes or panels.</p>
</td></tr>
<tr><td><code id="plotCA_+3A_series">series</code></td>
<td>
<p>string indicating which gear or survey to plot (first by
default).</p>
</td></tr>
<tr><td><code id="plotCA_+3A_sex">sex</code></td>
<td>
<p>string indicating which sex to plot (both by default).</p>
</td></tr>
<tr><td><code id="plotCA_+3A_years">years</code></td>
<td>
<p>vector of numbers indicating which years to plot (all by
default).</p>
</td></tr>
<tr><td><code id="plotCA_+3A_ages">ages</code></td>
<td>
<p>vector of numbers indicating which ages to plot (all by
default).</p>
</td></tr>
<tr><td><code id="plotCA_+3A_axes">axes</code></td>
<td>
<p>whether to plot axis values.</p>
</td></tr>
<tr><td><code id="plotCA_+3A_same.limits">same.limits</code></td>
<td>
<p>whether panels should have same y-axis limits.</p>
</td></tr>
<tr><td><code id="plotCA_+3A_log">log</code></td>
<td>
<p>whether to log-transform values.</p>
</td></tr>
<tr><td><code id="plotCA_+3A_base">base</code></td>
<td>
<p>logarithm base.</p>
</td></tr>
<tr><td><code id="plotCA_+3A_eps.log">eps.log</code></td>
<td>
<p>small number to add before log-transforming to avoid
log 0.</p>
</td></tr>
<tr><td><code id="plotCA_+3A_main">main</code></td>
<td>
<p>main title.</p>
</td></tr>
<tr><td><code id="plotCA_+3A_xlab">xlab</code></td>
<td>
<p>x-axis label.</p>
</td></tr>
<tr><td><code id="plotCA_+3A_ylab">ylab</code></td>
<td>
<p>y-axis label.</p>
</td></tr>
<tr><td><code id="plotCA_+3A_cex.main">cex.main</code></td>
<td>
<p>size of main title.</p>
</td></tr>
<tr><td><code id="plotCA_+3A_cex.lab">cex.lab</code></td>
<td>
<p>size of axis labels.</p>
</td></tr>
<tr><td><code id="plotCA_+3A_cex.axis">cex.axis</code></td>
<td>
<p>size of tick labels.</p>
</td></tr>
<tr><td><code id="plotCA_+3A_cex.strip">cex.strip</code></td>
<td>
<p>size of strip labels.</p>
</td></tr>
<tr><td><code id="plotCA_+3A_col.strip">col.strip</code></td>
<td>
<p>color of strip labels.</p>
</td></tr>
<tr><td><code id="plotCA_+3A_strip">strip</code></td>
<td>
<p>logical flag (whether to plot strip labels), or a
function passed to <code>xyplot</code>.</p>
</td></tr>
<tr><td><code id="plotCA_+3A_las">las</code></td>
<td>
<p>orientation of tick labels: 0=parallel, 1=horizontal,
2=perpendicular, 3=vertical.</p>
</td></tr>
<tr><td><code id="plotCA_+3A_tck">tck</code></td>
<td>
<p>tick mark length.</p>
</td></tr>
<tr><td><code id="plotCA_+3A_tick.number">tick.number</code></td>
<td>
<p>number of tick marks.</p>
</td></tr>
<tr><td><code id="plotCA_+3A_lty.grid">lty.grid</code></td>
<td>
<p>line type of gridlines.</p>
</td></tr>
<tr><td><code id="plotCA_+3A_col.grid">col.grid</code></td>
<td>
<p>color of gridlines.</p>
</td></tr>
<tr><td><code id="plotCA_+3A_pch">pch</code></td>
<td>
<p>symbol for points.</p>
</td></tr>
<tr><td><code id="plotCA_+3A_cex.points">cex.points</code></td>
<td>
<p>size of points.</p>
</td></tr>
<tr><td><code id="plotCA_+3A_col.points">col.points</code></td>
<td>
<p>color of points.</p>
</td></tr>
<tr><td><code id="plotCA_+3A_lty.lines">lty.lines</code></td>
<td>
<p>line type of main lines, possibly a vector where
element 2 refers to males.</p>
</td></tr>
<tr><td><code id="plotCA_+3A_lwd.lines">lwd.lines</code></td>
<td>
<p>line width of main lines, possibly a vector where
element 2 refers to males.</p>
</td></tr>
<tr><td><code id="plotCA_+3A_col.lines">col.lines</code></td>
<td>
<p>color of main lines, possibly a vector where element
2 refers to males.</p>
</td></tr>
<tr><td><code id="plotCA_+3A_plot">plot</code></td>
<td>
<p>whether to draw plot.</p>
</td></tr>
<tr><td><code id="plotCA_+3A_...">...</code></td>
<td>
<p>passed to <code>xyplot</code>, <code>panel.xyplot</code>,
<code>panel.superpose</code>, and <code>panel.superpose.2</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>When <code>plot=TRUE</code>, a trellis plot is drawn and a data frame is
returned, containing the data used for plotting. When
<code>plot=FALSE</code>, a trellis object is returned.
</p>


<h3>Note</h3>

<p>The <code>Args</code> function from the <span class="pkg">gdata</span> package is recommended
for reviewing the arguments, instead of <code>args</code>.
</p>


<h3>See Also</h3>

<p><code><a href="lattice.html#topic+xyplot">xyplot</a></code>, <code><a href="lattice.html#topic+panel.xyplot">panel.xyplot</a></code>,
and <code><a href="lattice.html#topic+panel.superpose">panel.superpose</a></code> are the underlying drawing
functions.
</p>
<p><code>plotCA</code>, <code><a href="#topic+plotCL">plotCL</a></code>, <code><a href="#topic+plotIndex">plotIndex</a></code>, and
<code><a href="#topic+plotLA">plotLA</a></code> plot model fit and data.
</p>
<p><code><a href="#topic+plotB">plotB</a></code>, <code><a href="#topic+plotN">plotN</a></code>, and <code><a href="#topic+plotSel">plotSel</a></code>
plot derived quantities.
</p>
<p><code><a href="#topic+scape-package">scape-package</a></code> gives an overview of the package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plotCA(x.sbw, fit=FALSE, strip=FALSE, xlab="Age", ylab="Year",
       tick.number=10)

plotCA(x.cod, xlab="Age", ylab="Proportion in catch", cex.strip=0.7,
       cex.axis=0.7, col.lines="brown", layout=c(8,4))

plotCA(x.cod, xlab="Age", ylab="Proportion in catch", cex.strip=0.7,
       cex.axis=0.7, col.lines="brown", layout=c(2,4), swap=TRUE,
       ages=3:10, same.limits=FALSE)

plotCA(x.ling, "s", col.points=c("red","blue"), lty.lines=0, xlab="Age",
       ylab="Observed proportion in survey", tck=0.5, cex.strip=0.7,
       cex.axis=0.7)

plotCA(x.ling, "s", xlab="Age", ylab="Observed proportion in survey",
       fit=FALSE, cex.strip=0.7, cex.axis=0.7, tck=0.5, layout=c(5,2))

plotCA(x.ling, "s", xlab="Age", ylab="Observed proportion in survey",
       fit=FALSE, cex.strip=0.7, cex.axis=0.7, tck=0.5, layout=c(5,6),
       swap=TRUE)
</code></pre>

<hr>
<h2 id='plotCL'>Plot Catch at Length</h2><span id='topic+plotCL'></span>

<h3>Description</h3>

<p>Plot <code>scape</code> model fit to catch-at-length data.</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotCL(model, what="c", fit=TRUE, swap=FALSE, series=NULL, sex=NULL,
       years=NULL, lengths=NULL, axes=TRUE, same.limits=TRUE, log=FALSE,
       base=10, eps.log=1e-5, main="", xlab="", ylab="", cex.main=1.2,
       cex.lab=1, cex.axis=0.8, cex.strip=0.8, col.strip="gray95",
       strip=strip.custom(bg=col.strip), las=!fit, tck=c(1,fit)/2,
       tick.number=5, lty.grid=3, col.grid="gray", pch=16,
       cex.points=0.5, col.points="black", lty.lines=1, lwd.lines=2,
       col.lines=c("red","blue"), plot=TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotCL_+3A_model">model</code></td>
<td>
<p>fitted <code>scape</code> model containing element <code>CLc</code>
and/or <code>CLs</code>.</p>
</td></tr>
<tr><td><code id="plotCL_+3A_what">what</code></td>
<td>
<p>what to plot: <code>"c"</code>[ommercial] or <code>"s"</code>[urvey]
catch at length.</p>
</td></tr>
<tr><td><code id="plotCL_+3A_fit">fit</code></td>
<td>
<p>whether to overlay fitted values on observed data.</p>
</td></tr>
<tr><td><code id="plotCL_+3A_swap">swap</code></td>
<td>
<p>whether to swap lengths and years between axes or panels.</p>
</td></tr>
<tr><td><code id="plotCL_+3A_series">series</code></td>
<td>
<p>string indicating which gear or survey to plot (first by
default).</p>
</td></tr>
<tr><td><code id="plotCL_+3A_sex">sex</code></td>
<td>
<p>string indicating which sex to plot (both by default).</p>
</td></tr>
<tr><td><code id="plotCL_+3A_years">years</code></td>
<td>
<p>vector of numbers indicating which years to plot plot
(all by default).</p>
</td></tr>
<tr><td><code id="plotCL_+3A_lengths">lengths</code></td>
<td>
<p>vector of numbers indicating which lengths to plot (all
by default).</p>
</td></tr>
<tr><td><code id="plotCL_+3A_axes">axes</code></td>
<td>
<p>whether to plot axis values.</p>
</td></tr>
<tr><td><code id="plotCL_+3A_same.limits">same.limits</code></td>
<td>
<p>whether panels should have same y-axis limits.</p>
</td></tr>
<tr><td><code id="plotCL_+3A_log">log</code></td>
<td>
<p>whether to log-transform values.</p>
</td></tr>
<tr><td><code id="plotCL_+3A_base">base</code></td>
<td>
<p>logarithm base.</p>
</td></tr>
<tr><td><code id="plotCL_+3A_eps.log">eps.log</code></td>
<td>
<p>small number to add before log-transforming to avoid
log 0.</p>
</td></tr>
<tr><td><code id="plotCL_+3A_main">main</code></td>
<td>
<p>main title.</p>
</td></tr>
<tr><td><code id="plotCL_+3A_xlab">xlab</code></td>
<td>
<p>x-axis label.</p>
</td></tr>
<tr><td><code id="plotCL_+3A_ylab">ylab</code></td>
<td>
<p>y-axis label.</p>
</td></tr>
<tr><td><code id="plotCL_+3A_cex.main">cex.main</code></td>
<td>
<p>size of main title.</p>
</td></tr>
<tr><td><code id="plotCL_+3A_cex.lab">cex.lab</code></td>
<td>
<p>size of axis labels.</p>
</td></tr>
<tr><td><code id="plotCL_+3A_cex.axis">cex.axis</code></td>
<td>
<p>size of tick labels.</p>
</td></tr>
<tr><td><code id="plotCL_+3A_cex.strip">cex.strip</code></td>
<td>
<p>size of strip labels.</p>
</td></tr>
<tr><td><code id="plotCL_+3A_col.strip">col.strip</code></td>
<td>
<p>color of strip labels.</p>
</td></tr>
<tr><td><code id="plotCL_+3A_strip">strip</code></td>
<td>
<p>logical flag (whether to plot strip labels), or a
function passed to <code>xyplot</code>.</p>
</td></tr>
<tr><td><code id="plotCL_+3A_las">las</code></td>
<td>
<p>orientation of tick labels: 0=parallel, 1=horizontal,
2=perpendicular, 3=vertical.</p>
</td></tr>
<tr><td><code id="plotCL_+3A_tck">tck</code></td>
<td>
<p>tick mark length.</p>
</td></tr>
<tr><td><code id="plotCL_+3A_tick.number">tick.number</code></td>
<td>
<p>number of tick marks.</p>
</td></tr>
<tr><td><code id="plotCL_+3A_lty.grid">lty.grid</code></td>
<td>
<p>line type of gridlines.</p>
</td></tr>
<tr><td><code id="plotCL_+3A_col.grid">col.grid</code></td>
<td>
<p>color of gridlines.</p>
</td></tr>
<tr><td><code id="plotCL_+3A_pch">pch</code></td>
<td>
<p>symbol for points.</p>
</td></tr>
<tr><td><code id="plotCL_+3A_cex.points">cex.points</code></td>
<td>
<p>size of points.</p>
</td></tr>
<tr><td><code id="plotCL_+3A_col.points">col.points</code></td>
<td>
<p>color of points.</p>
</td></tr>
<tr><td><code id="plotCL_+3A_lty.lines">lty.lines</code></td>
<td>
<p>line type of main lines, possibly a vector where
element 2 refers to males.</p>
</td></tr>
<tr><td><code id="plotCL_+3A_lwd.lines">lwd.lines</code></td>
<td>
<p>line width of main lines, possibly a vector where
element 2 refers to males.</p>
</td></tr>
<tr><td><code id="plotCL_+3A_col.lines">col.lines</code></td>
<td>
<p>color of main lines, possibly a vector where element
2 refers to males.</p>
</td></tr>
<tr><td><code id="plotCL_+3A_plot">plot</code></td>
<td>
<p>whether to draw plot.</p>
</td></tr>
<tr><td><code id="plotCL_+3A_...">...</code></td>
<td>
<p>passed to <code>xyplot</code>, <code>panel.xyplot</code>,
<code>panel.superpose</code>, and <code>panel.superpose.2</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>When <code>plot=TRUE</code>, a trellis plot is drawn and a data frame is
returned, containing the data used for plotting. When
<code>plot=FALSE</code>, a trellis object is returned.
</p>


<h3>Note</h3>

<p>The <code>Args</code> function from the <span class="pkg">gdata</span> package is recommended
for reviewing the arguments, instead of <code>args</code>.
</p>


<h3>See Also</h3>

<p><code><a href="lattice.html#topic+xyplot">xyplot</a></code>, <code><a href="lattice.html#topic+panel.xyplot">panel.xyplot</a></code>,
and <code><a href="lattice.html#topic+panel.superpose">panel.superpose</a></code> are the underlying drawing
functions.
</p>
<p><code><a href="#topic+plotCA">plotCA</a></code>, <code>plotCL</code>, <code><a href="#topic+plotIndex">plotIndex</a></code>, and
<code><a href="#topic+plotLA">plotLA</a></code> plot model fit and data.
</p>
<p><code><a href="#topic+plotB">plotB</a></code>, <code><a href="#topic+plotN">plotN</a></code>, and <code><a href="#topic+plotSel">plotSel</a></code>
plot derived quantities.
</p>
<p><code><a href="#topic+scape-package">scape-package</a></code> gives an overview of the package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plotCL(x.ling, fit=FALSE, strip=FALSE, series="1", sex="Female",
       xlab="Length (cm)", ylab="Year")

plotCL(x.oreo, xlab="Length (cm)", ylab="Proportion in catch")

plotCL(x.oreo, "s", layout=c(2,1), xlab="Length (cm)",
       ylab="Observed proportion in survey", cex.points=0.8,
       col.points=c("red","blue"), lty.lines=0)

plotCL(x.ling, fit=FALSE, series="2", xlab="Length (cm)",
       ylab="Observed proportion in trawl catch", tck=0.5)

plotCL(x.ling, series="2", swap=TRUE, lengths=70:150, lty.grid=0)
</code></pre>

<hr>
<h2 id='plotIndex'>Plot Abundance Index</h2><span id='topic+plotIndex'></span>

<h3>Description</h3>

<p>Plot <code>scape</code> model fit to abundance index data.</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotIndex(model, what="s", series=NULL, axes=TRUE, same.limits=FALSE,
          between=list(x=axes,y=axes), ylim=NULL, q=1, bar=1, log=FALSE,
          base=10, main="", xlab="", ylab="", cex.main=1.2, cex.lab=1,
          cex.axis=0.8, cex.strip=0.8, col.strip="gray95",
          strip=strip.custom(bg=col.strip), las=1, tck=c(1,0)/2,
          tick.number=5, lty.grid=3, col.grid="white", pch=16,
          cex.points=1.2, col.points="black", lty.lines=1, lwd.lines=4,
          col.lines="dimgray", lty.bar=1, plot=TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotIndex_+3A_model">model</code></td>
<td>
<p>fitted <code>scape</code> model containing element <code>CPUE</code>
and/or <code>Survey</code>.</p>
</td></tr>
<tr><td><code id="plotIndex_+3A_what">what</code></td>
<td>
<p>what to plot: <code>"c"</code>[ommercial] or <code>"s"</code>[urvey]
abundance index.</p>
</td></tr>
<tr><td><code id="plotIndex_+3A_series">series</code></td>
<td>
<p>vector of strings indicating which gears or surveys to
plot (all by default).</p>
</td></tr>
<tr><td><code id="plotIndex_+3A_axes">axes</code></td>
<td>
<p>whether to plot axis values.</p>
</td></tr>
<tr><td><code id="plotIndex_+3A_same.limits">same.limits</code></td>
<td>
<p>whether panels should have same y-axis limits.</p>
</td></tr>
<tr><td><code id="plotIndex_+3A_between">between</code></td>
<td>
<p>list with <code>x</code> and <code>y</code> indicating panel
spacing.</p>
</td></tr>
<tr><td><code id="plotIndex_+3A_ylim">ylim</code></td>
<td>
<p>vector with lower and upper y-axis limits.</p>
</td></tr>
<tr><td><code id="plotIndex_+3A_q">q</code></td>
<td>
<p>denominator to scale the y axis, e.g. to vulnerable biomass.
Similar to the <code>div</code> argument in <code>plotN</code> and
<code>plotB</code>.</p>
</td></tr>
<tr><td><code id="plotIndex_+3A_bar">bar</code></td>
<td>
<p>extent of error bars relative to standard error.</p>
</td></tr>
<tr><td><code id="plotIndex_+3A_log">log</code></td>
<td>
<p>whether to log-transform values.</p>
</td></tr>
<tr><td><code id="plotIndex_+3A_base">base</code></td>
<td>
<p>logarithm base.</p>
</td></tr>
<tr><td><code id="plotIndex_+3A_main">main</code></td>
<td>
<p>main title.</p>
</td></tr>
<tr><td><code id="plotIndex_+3A_xlab">xlab</code></td>
<td>
<p>x-axis label.</p>
</td></tr>
<tr><td><code id="plotIndex_+3A_ylab">ylab</code></td>
<td>
<p>y-axis label.</p>
</td></tr>
<tr><td><code id="plotIndex_+3A_cex.main">cex.main</code></td>
<td>
<p>size of main title.</p>
</td></tr>
<tr><td><code id="plotIndex_+3A_cex.lab">cex.lab</code></td>
<td>
<p>size of axis labels.</p>
</td></tr>
<tr><td><code id="plotIndex_+3A_cex.axis">cex.axis</code></td>
<td>
<p>size of tick labels.</p>
</td></tr>
<tr><td><code id="plotIndex_+3A_cex.strip">cex.strip</code></td>
<td>
<p>size of strip labels.</p>
</td></tr>
<tr><td><code id="plotIndex_+3A_col.strip">col.strip</code></td>
<td>
<p>color of strip labels.</p>
</td></tr>
<tr><td><code id="plotIndex_+3A_strip">strip</code></td>
<td>
<p>logical flag (whether to plot strip labels), or a
function passed to <code>xyplot</code>.</p>
</td></tr>
<tr><td><code id="plotIndex_+3A_las">las</code></td>
<td>
<p>orientation of tick labels: 0=parallel, 1=horizontal,
2=perpendicular, 3=vertical.</p>
</td></tr>
<tr><td><code id="plotIndex_+3A_tck">tck</code></td>
<td>
<p>tick mark length.</p>
</td></tr>
<tr><td><code id="plotIndex_+3A_tick.number">tick.number</code></td>
<td>
<p>number of tick marks.</p>
</td></tr>
<tr><td><code id="plotIndex_+3A_lty.grid">lty.grid</code></td>
<td>
<p>line type of gridlines.</p>
</td></tr>
<tr><td><code id="plotIndex_+3A_col.grid">col.grid</code></td>
<td>
<p>color of gridlines.</p>
</td></tr>
<tr><td><code id="plotIndex_+3A_pch">pch</code></td>
<td>
<p>symbol for points.</p>
</td></tr>
<tr><td><code id="plotIndex_+3A_cex.points">cex.points</code></td>
<td>
<p>size of points.</p>
</td></tr>
<tr><td><code id="plotIndex_+3A_col.points">col.points</code></td>
<td>
<p>color of points and error bars.</p>
</td></tr>
<tr><td><code id="plotIndex_+3A_lty.lines">lty.lines</code></td>
<td>
<p>line type of main lines.</p>
</td></tr>
<tr><td><code id="plotIndex_+3A_lwd.lines">lwd.lines</code></td>
<td>
<p>line width of main lines.</p>
</td></tr>
<tr><td><code id="plotIndex_+3A_col.lines">col.lines</code></td>
<td>
<p>color of main lines.</p>
</td></tr>
<tr><td><code id="plotIndex_+3A_lty.bar">lty.bar</code></td>
<td>
<p>line type of error bars.</p>
</td></tr>
<tr><td><code id="plotIndex_+3A_plot">plot</code></td>
<td>
<p>whether to draw plot.</p>
</td></tr>
<tr><td><code id="plotIndex_+3A_...">...</code></td>
<td>
<p>passed to <code>xyplot</code>, <code>panel.xyplot</code>, and
<code>panel.xYplot</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>When <code>plot=TRUE</code>, a trellis plot is drawn and a data frame is
returned, containing the data used for plotting. When
<code>plot=FALSE</code>, a trellis object is returned.
</p>


<h3>Note</h3>

<p>The <code>Args</code> function from the <span class="pkg">gdata</span> package is recommended
for reviewing the arguments, instead of <code>args</code>.
</p>


<h3>See Also</h3>

<p><code><a href="lattice.html#topic+xyplot">xyplot</a></code>, <code><a href="lattice.html#topic+panel.xyplot">panel.xyplot</a></code>,
and <code><a href="Hmisc.html#topic+panel.xYplot">panel.xYplot</a></code> are the underlying drawing
functions.
</p>
<p><code><a href="#topic+plotCA">plotCA</a></code>, <code><a href="#topic+plotCL">plotCL</a></code>, <code>plotIndex</code>, and
<code><a href="#topic+plotLA">plotLA</a></code> plot model fit and data.
</p>
<p><code><a href="#topic+plotB">plotB</a></code>, <code><a href="#topic+plotN">plotN</a></code>, and <code><a href="#topic+plotSel">plotSel</a></code>
plot derived quantities.
</p>
<p><code><a href="#topic+scape-package">scape-package</a></code> gives an overview of the package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plotIndex(x.cod, xlab="Year", ylab="Survey abundance index",
          strip=FALSE)

plotIndex(x.oreo, "c", series="Series 1-1", xlim=c(1981,1990))

plotIndex(x.oreo, "c", xlim=list(c(1981,1990),c(1992,2002)),
          xlab="Year", ylab="Observed CPUE",
          col.points=c("salmon","seagreen"), lty.lines=0)
</code></pre>

<hr>
<h2 id='plotLA'>Plot Length at Age</h2><span id='topic+plotLA'></span>

<h3>Description</h3>

<p>Plot <code>scape</code> model fit to length-at-age data.</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotLA(model, together=FALSE, sex=NULL, axes=TRUE, same.limits=TRUE,
       between=list(x=axes,y=axes), ylim=NULL, bands=1, main="",
       xlab="", ylab="", cex.main=1.2, cex.lab=1, cex.axis=0.8,
       cex.strip=0.8, col.strip="gray95",
       strip=strip.custom(bg=col.strip), las=1, tck=0, tick.number=5,
       lty.grid=3, col.grid="gray", pch=16, cex.points=0.5,
       col.points="black", lty.lines=1, lwd.lines=4,
       col.lines=c("red","blue"), lty.bands=2*(!together), lwd.bands=1,
       col.bands="black", plot=TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotLA_+3A_model">model</code></td>
<td>
<p>fitted <code>scape</code> model containing element <code>LA</code>.</p>
</td></tr>
<tr><td><code id="plotLA_+3A_together">together</code></td>
<td>
<p>whether to plot both sexes in one panel.</p>
</td></tr>
<tr><td><code id="plotLA_+3A_sex">sex</code></td>
<td>
<p>string indicating which sex to plot (both by default).</p>
</td></tr>
<tr><td><code id="plotLA_+3A_axes">axes</code></td>
<td>
<p>whether to plot axis values.</p>
</td></tr>
<tr><td><code id="plotLA_+3A_same.limits">same.limits</code></td>
<td>
<p>whether panels should have same y-axis limits.</p>
</td></tr>
<tr><td><code id="plotLA_+3A_between">between</code></td>
<td>
<p>list with <code>x</code> and <code>y</code> indicating panel
spacing.</p>
</td></tr>
<tr><td><code id="plotLA_+3A_ylim">ylim</code></td>
<td>
<p>vector with lower and upper y-axis limits.</p>
</td></tr>
<tr><td><code id="plotLA_+3A_bands">bands</code></td>
<td>
<p>extent of error bands relative to standard error.</p>
</td></tr>
<tr><td><code id="plotLA_+3A_main">main</code></td>
<td>
<p>main title.</p>
</td></tr>
<tr><td><code id="plotLA_+3A_xlab">xlab</code></td>
<td>
<p>x-axis label.</p>
</td></tr>
<tr><td><code id="plotLA_+3A_ylab">ylab</code></td>
<td>
<p>y-axis label.</p>
</td></tr>
<tr><td><code id="plotLA_+3A_cex.main">cex.main</code></td>
<td>
<p>size of main title.</p>
</td></tr>
<tr><td><code id="plotLA_+3A_cex.lab">cex.lab</code></td>
<td>
<p>size of axis labels.</p>
</td></tr>
<tr><td><code id="plotLA_+3A_cex.axis">cex.axis</code></td>
<td>
<p>size of tick labels.</p>
</td></tr>
<tr><td><code id="plotLA_+3A_cex.strip">cex.strip</code></td>
<td>
<p>size of strip labels.</p>
</td></tr>
<tr><td><code id="plotLA_+3A_col.strip">col.strip</code></td>
<td>
<p>color of strip labels.</p>
</td></tr>
<tr><td><code id="plotLA_+3A_strip">strip</code></td>
<td>
<p>logical flag (whether to plot strip labels), or a
function passed to <code>xyplot</code>.</p>
</td></tr>
<tr><td><code id="plotLA_+3A_las">las</code></td>
<td>
<p>orientation of tick labels: 0=parallel, 1=horizontal,
2=perpendicular, 3=vertical.</p>
</td></tr>
<tr><td><code id="plotLA_+3A_tck">tck</code></td>
<td>
<p>tick mark length.</p>
</td></tr>
<tr><td><code id="plotLA_+3A_tick.number">tick.number</code></td>
<td>
<p>number of tick marks.</p>
</td></tr>
<tr><td><code id="plotLA_+3A_lty.grid">lty.grid</code></td>
<td>
<p>line type of gridlines.</p>
</td></tr>
<tr><td><code id="plotLA_+3A_col.grid">col.grid</code></td>
<td>
<p>color of gridlines.</p>
</td></tr>
<tr><td><code id="plotLA_+3A_pch">pch</code></td>
<td>
<p>symbol for points, possibly a vector where element 2 refers
to males.</p>
</td></tr>
<tr><td><code id="plotLA_+3A_cex.points">cex.points</code></td>
<td>
<p>size of points, possibly a vector where element 2
refers to males.</p>
</td></tr>
<tr><td><code id="plotLA_+3A_col.points">col.points</code></td>
<td>
<p>color of points, possibly a vector where element 2
refers to males.</p>
</td></tr>
<tr><td><code id="plotLA_+3A_lty.lines">lty.lines</code></td>
<td>
<p>line type of main lines, possibly a vector where
element 2 refers to males.</p>
</td></tr>
<tr><td><code id="plotLA_+3A_lwd.lines">lwd.lines</code></td>
<td>
<p>line width of main lines, possibly a vector where
element 2 refers to males.</p>
</td></tr>
<tr><td><code id="plotLA_+3A_col.lines">col.lines</code></td>
<td>
<p>color of main lines, possibly a vector where element
2 refers to males.</p>
</td></tr>
<tr><td><code id="plotLA_+3A_lty.bands">lty.bands</code></td>
<td>
<p>line type of error bands.</p>
</td></tr>
<tr><td><code id="plotLA_+3A_lwd.bands">lwd.bands</code></td>
<td>
<p>line width of error bands.</p>
</td></tr>
<tr><td><code id="plotLA_+3A_col.bands">col.bands</code></td>
<td>
<p>color of error bands, possibly a vector where element
2 refers to males.</p>
</td></tr>
<tr><td><code id="plotLA_+3A_plot">plot</code></td>
<td>
<p>whether to draw plot.</p>
</td></tr>
<tr><td><code id="plotLA_+3A_...">...</code></td>
<td>
<p>passed to <code>xyplot</code> and <code>panel.superpose.2</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>When <code>plot=TRUE</code>, a trellis plot is drawn and a data frame is
returned, containing the data used for plotting. When
<code>plot=FALSE</code>, a trellis object is returned.
</p>


<h3>Note</h3>

<p>The <code>Args</code> function from the <span class="pkg">gdata</span> package is recommended
for reviewing the arguments, instead of <code>args</code>.
</p>


<h3>See Also</h3>

<p><code><a href="lattice.html#topic+xyplot">xyplot</a></code>, <code><a href="lattice.html#topic+panel.xyplot">panel.xyplot</a></code>,
and <code><a href="lattice.html#topic+panel.superpose">panel.superpose</a></code> are the underlying drawing
functions.
</p>
<p><code><a href="#topic+plotCA">plotCA</a></code>, <code><a href="#topic+plotCL">plotCL</a></code>, <code><a href="#topic+plotIndex">plotIndex</a></code>,
and <code>plotLA</code> plot model fit and data.
</p>
<p><code><a href="#topic+plotB">plotB</a></code>, <code><a href="#topic+plotN">plotN</a></code>, and <code><a href="#topic+plotSel">plotSel</a></code>
plot derived quantities.
</p>
<p><code><a href="#topic+scape-package">scape-package</a></code> gives an overview of the package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plotLA(x.oreo, xlab="Age", ylab="Length (cm)")

mykey &lt;- list(text=list(lab=c("Female","Male")), space="right",
              lines=list(lwd=4,col=c("red","blue")))
plotLA(x.oreo, together=TRUE, xlab="Age", ylab="Length (cm)", pch=NA,
       key=mykey)

mykey &lt;- list(text=list(lab=c("Female","Male")), space="right",
              points=list(pch=16,cex=0.5,col=c("red","blue")))
plotLA(x.oreo, together=TRUE, xlab="Age", ylab="Length (cm)",
       col.points=c("red","blue"), lty.lines=0, key=mykey)
</code></pre>

<hr>
<h2 id='plotN'>Plot Numbers at Age</h2><span id='topic+plotN'></span>

<h3>Description</h3>

<p>Plot <code>scape</code> model predicted numbers at age.</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotN(model, what="d", swap=FALSE, years=NULL, ages=NULL, axes=TRUE,
      same.limits=TRUE, div=1, log=FALSE, base=10, main="", xlab="",
      ylab="", cex.main=1.2, cex.lab=1, cex.axis=0.8, cex.strip=0.8,
      col.strip="gray95", strip=strip.custom(bg=col.strip),
      las=(what=="b"), tck=c(1,what=="b")/2, tick.number=10, lty.grid=3,
      col.grid="white", pch=16, cex.points=1, col.points="black",
      ratio.bars=3, col.bars="gray", plot=TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotN_+3A_model">model</code></td>
<td>
<p>fitted <code>scape</code> model.</p>
</td></tr>
<tr><td><code id="plotN_+3A_what">what</code></td>
<td>
<p>what to plot: <code>"d"</code>[efault],
<code>"i"</code>[nitial year], <code>"l"</code>[ast year],
<code>"r"</code>[ecruitment], <code>"p"</code>[panels], <code>"b"</code>[ubble plot].</p>
</td></tr>
<tr><td><code id="plotN_+3A_swap">swap</code></td>
<td>
<p>whether to swap ages and years between axes or panels.</p>
</td></tr>
<tr><td><code id="plotN_+3A_years">years</code></td>
<td>
<p>vector of numbers indicating which years to plot (all by
default).</p>
</td></tr>
<tr><td><code id="plotN_+3A_ages">ages</code></td>
<td>
<p>vector of numbers indicating which ages to plot (all by
default).</p>
</td></tr>
<tr><td><code id="plotN_+3A_axes">axes</code></td>
<td>
<p>whether to plot axis values.</p>
</td></tr>
<tr><td><code id="plotN_+3A_same.limits">same.limits</code></td>
<td>
<p>whether panels should have same y-axis limits.</p>
</td></tr>
<tr><td><code id="plotN_+3A_div">div</code></td>
<td>
<p>denominator to shorten values on the y axis.</p>
</td></tr>
<tr><td><code id="plotN_+3A_log">log</code></td>
<td>
<p>whether to log-transform values.</p>
</td></tr>
<tr><td><code id="plotN_+3A_base">base</code></td>
<td>
<p>logarithm base.</p>
</td></tr>
<tr><td><code id="plotN_+3A_main">main</code></td>
<td>
<p>main title.</p>
</td></tr>
<tr><td><code id="plotN_+3A_xlab">xlab</code></td>
<td>
<p>x-axis label.</p>
</td></tr>
<tr><td><code id="plotN_+3A_ylab">ylab</code></td>
<td>
<p>y-axis label.</p>
</td></tr>
<tr><td><code id="plotN_+3A_cex.main">cex.main</code></td>
<td>
<p>size of main title.</p>
</td></tr>
<tr><td><code id="plotN_+3A_cex.lab">cex.lab</code></td>
<td>
<p>size of axis labels.</p>
</td></tr>
<tr><td><code id="plotN_+3A_cex.axis">cex.axis</code></td>
<td>
<p>size of tick labels.</p>
</td></tr>
<tr><td><code id="plotN_+3A_cex.strip">cex.strip</code></td>
<td>
<p>size of strip labels.</p>
</td></tr>
<tr><td><code id="plotN_+3A_col.strip">col.strip</code></td>
<td>
<p>color of strip labels.</p>
</td></tr>
<tr><td><code id="plotN_+3A_strip">strip</code></td>
<td>
<p>logical flag (whether to plot strip labels), or a
function passed to <code>xyplot</code>.</p>
</td></tr>
<tr><td><code id="plotN_+3A_las">las</code></td>
<td>
<p>orientation of tick labels: 0=parallel, 1=horizontal,
2=perpendicular, 3=vertical.</p>
</td></tr>
<tr><td><code id="plotN_+3A_tck">tck</code></td>
<td>
<p>tick mark length.</p>
</td></tr>
<tr><td><code id="plotN_+3A_tick.number">tick.number</code></td>
<td>
<p>number of tick marks.</p>
</td></tr>
<tr><td><code id="plotN_+3A_lty.grid">lty.grid</code></td>
<td>
<p>line type of gridlines.</p>
</td></tr>
<tr><td><code id="plotN_+3A_col.grid">col.grid</code></td>
<td>
<p>color of gridlines.</p>
</td></tr>
<tr><td><code id="plotN_+3A_pch">pch</code></td>
<td>
<p>symbol for points.</p>
</td></tr>
<tr><td><code id="plotN_+3A_cex.points">cex.points</code></td>
<td>
<p>size of points.</p>
</td></tr>
<tr><td><code id="plotN_+3A_col.points">col.points</code></td>
<td>
<p>color of points.</p>
</td></tr>
<tr><td><code id="plotN_+3A_ratio.bars">ratio.bars</code></td>
<td>
<p>width of bars.</p>
</td></tr>
<tr><td><code id="plotN_+3A_col.bars">col.bars</code></td>
<td>
<p>color of bars.</p>
</td></tr>
<tr><td><code id="plotN_+3A_plot">plot</code></td>
<td>
<p>whether to draw plot.</p>
</td></tr>
<tr><td><code id="plotN_+3A_...">...</code></td>
<td>
<p>passed to <code>xyplot</code>, <code>panel.barchart</code>, and
<code>panel.xyplot</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>"d"</code>[efault] plot is a combination of
<code>"i"</code>[nitial year] and <code>"r"</code>[ecruitment].
</p>


<h3>Value</h3>

<p>When <code>plot=TRUE</code>, a trellis plot is drawn and a data frame is
returned, containing the data used for plotting. When
<code>plot=FALSE</code>, a trellis object is returned.
</p>


<h3>Note</h3>

<p>The <code>Args</code> function from the <span class="pkg">gdata</span> package is recommended
for reviewing the arguments, instead of <code>args</code>.
</p>


<h3>See Also</h3>

<p><code><a href="lattice.html#topic+xyplot">xyplot</a></code>, <code><a href="lattice.html#topic+panel.xyplot">panel.xyplot</a></code>,
and <code><a href="lattice.html#topic+panel.barchart">panel.barchart</a></code> are the underlying drawing
functions.
</p>
<p><code><a href="#topic+plotCA">plotCA</a></code>, <code><a href="#topic+plotCL">plotCL</a></code>, <code><a href="#topic+plotIndex">plotIndex</a></code>,
and <code><a href="#topic+plotLA">plotLA</a></code> plot model fit and data.
</p>
<p><code><a href="#topic+plotB">plotB</a></code>, <code>plotN</code>, and <code><a href="#topic+plotSel">plotSel</a></code> plot
derived quantities.
</p>
<p><code><a href="#topic+scape-package">scape-package</a></code> gives an overview of the package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plotN(x.cod, div=1000, xlab=c("Age (years)","Year"),
      ylab="Individuals (million)")

plotN(x.cod, "l", div=1000, xlab="Age", ylab="Individuals (million)")

plotN(x.cod, "r", age=3, div=1000, xlim=c(1967,2002))

plotN(x.cod, "p", div=1000, ages=3:10, xlim=c(2,11), xlab="Age",
      ylab="Individuals (million)", cex.strip=0.7, cex.axis=0.7,
      tck=0.5)

plotN(x.cod, "b", xlab="Age (years)", ylab="Year", cex.points=0.7)
</code></pre>

<hr>
<h2 id='plotSel'>Plot Selectivity and Maturity</h2><span id='topic+plotSel'></span>

<h3>Description</h3>

<p>Plot <code>scape</code> model predicted selectivity and observed maturity.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotSel(model, together=FALSE, series=NULL, sex=NULL, axes=TRUE,
        legend="bottom", main="", xlab="", ylab="", cex.main=1.2,
        cex.legend=1, cex.lab=1, cex.axis=0.8, cex.strip=0.8,
        col.strip="gray95", strip=strip.custom(bg=col.strip), las=1,
        tck=0, tick.number=5, lty.grid=3, col.grid="gray", pch="m",
        cex.points=1, col.points="black", lty.lines=1, lwd.lines=4,
        col.lines=c("red","blue"), plot=TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotSel_+3A_model">model</code></td>
<td>
<p>fitted <code>scape</code> model.</p>
</td></tr>
<tr><td><code id="plotSel_+3A_together">together</code></td>
<td>
<p>whether to plot gears in one panel.</p>
</td></tr>
<tr><td><code id="plotSel_+3A_series">series</code></td>
<td>
<p>vector of strings indicating which gears or surveys to
plot (all by default).</p>
</td></tr>
<tr><td><code id="plotSel_+3A_sex">sex</code></td>
<td>
<p>string indicating which sex to plot (both by default).</p>
</td></tr>
<tr><td><code id="plotSel_+3A_axes">axes</code></td>
<td>
<p>whether to plot axis values.</p>
</td></tr>
<tr><td><code id="plotSel_+3A_legend">legend</code></td>
<td>
<p>legend location: <code>"bottom"</code>, <code>"left"</code>,
<code>"top"</code>, <code>"right"</code>, or <code>""</code> to suppress legend.</p>
</td></tr>
<tr><td><code id="plotSel_+3A_main">main</code></td>
<td>
<p>main title.</p>
</td></tr>
<tr><td><code id="plotSel_+3A_xlab">xlab</code></td>
<td>
<p>x-axis label.</p>
</td></tr>
<tr><td><code id="plotSel_+3A_ylab">ylab</code></td>
<td>
<p>y-axis label.</p>
</td></tr>
<tr><td><code id="plotSel_+3A_cex.main">cex.main</code></td>
<td>
<p>size of main title.</p>
</td></tr>
<tr><td><code id="plotSel_+3A_cex.legend">cex.legend</code></td>
<td>
<p>size of legend text.</p>
</td></tr>
<tr><td><code id="plotSel_+3A_cex.lab">cex.lab</code></td>
<td>
<p>size of axis labels.</p>
</td></tr>
<tr><td><code id="plotSel_+3A_cex.axis">cex.axis</code></td>
<td>
<p>size of tick labels.</p>
</td></tr>
<tr><td><code id="plotSel_+3A_cex.strip">cex.strip</code></td>
<td>
<p>size of strip labels.</p>
</td></tr>
<tr><td><code id="plotSel_+3A_strip">strip</code></td>
<td>
<p>logical flag (whether to plot strip labels), or a
function passed to <code>xyplot</code>.</p>
</td></tr>
<tr><td><code id="plotSel_+3A_col.strip">col.strip</code></td>
<td>
<p>color of strip labels.</p>
</td></tr>
<tr><td><code id="plotSel_+3A_las">las</code></td>
<td>
<p>orientation of tick labels: 0=parallel, 1=horizontal,
2=perpendicular, 3=vertical.</p>
</td></tr>
<tr><td><code id="plotSel_+3A_tck">tck</code></td>
<td>
<p>tick mark length.</p>
</td></tr>
<tr><td><code id="plotSel_+3A_tick.number">tick.number</code></td>
<td>
<p>number of tick marks.</p>
</td></tr>
<tr><td><code id="plotSel_+3A_lty.grid">lty.grid</code></td>
<td>
<p>line type of gridlines.</p>
</td></tr>
<tr><td><code id="plotSel_+3A_col.grid">col.grid</code></td>
<td>
<p>color of gridlines.</p>
</td></tr>
<tr><td><code id="plotSel_+3A_pch">pch</code></td>
<td>
<p>symbol for points.</p>
</td></tr>
<tr><td><code id="plotSel_+3A_cex.points">cex.points</code></td>
<td>
<p>size of points.</p>
</td></tr>
<tr><td><code id="plotSel_+3A_col.points">col.points</code></td>
<td>
<p>color of points.</p>
</td></tr>
<tr><td><code id="plotSel_+3A_lty.lines">lty.lines</code></td>
<td>
<p>line type of main lines.</p>
</td></tr>
<tr><td><code id="plotSel_+3A_lwd.lines">lwd.lines</code></td>
<td>
<p>line width of main lines.</p>
</td></tr>
<tr><td><code id="plotSel_+3A_col.lines">col.lines</code></td>
<td>
<p>color of main lines.</p>
</td></tr>
<tr><td><code id="plotSel_+3A_plot">plot</code></td>
<td>
<p>whether to draw plot.</p>
</td></tr>
<tr><td><code id="plotSel_+3A_...">...</code></td>
<td>
<p>passed to <code>xyplot</code>, <code>panel.points</code>,
<code>panel.lines</code>, and <code>panel.superpose</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>When <code>plot=TRUE</code>, a trellis plot is drawn and a data frame is
returned, containing the data used for plotting. When
<code>plot=FALSE</code>, a trellis object is returned.
</p>


<h3>Note</h3>

<p>The <code>Args</code> function from the <span class="pkg">gdata</span> package is recommended
for reviewing the arguments, instead of <code>args</code>.
</p>


<h3>See Also</h3>

<p><code><a href="lattice.html#topic+xyplot">xyplot</a></code>, <code><a href="lattice.html#topic+panel.points">panel.points</a></code>,
<code><a href="lattice.html#topic+panel.lines">panel.lines</a></code>, and
<code><a href="lattice.html#topic+panel.superpose">panel.superpose</a></code> are the underlying drawing
functions.
</p>
<p><code><a href="#topic+plotCA">plotCA</a></code>, <code><a href="#topic+plotCL">plotCL</a></code>, <code><a href="#topic+plotIndex">plotIndex</a></code>,
and <code><a href="#topic+plotLA">plotLA</a></code> plot model fit and data.
</p>
<p><code><a href="#topic+plotB">plotB</a></code>, <code><a href="#topic+plotN">plotN</a></code>, and <code>plotSel</code> plot
derived quantities.
</p>
<p><code><a href="#topic+scape-package">scape-package</a></code> gives an overview of the package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plotSel(x.ling, xlab="Age", ylab="Selectivity and maturity")

plotSel(x.cod, together=TRUE, xlab="Age\n", ylab="Selectivity",
        pch=NA, col.lines=c("coral","navyblue"), strip=FALSE)
</code></pre>

<hr>
<h2 id='scape-package'>Statistical Catch-at-Age Plotting Environment</h2><span id='topic+scape-package'></span><span id='topic+scape'></span>

<h3>Description</h3>

<p>Import and plot results from statistical catch-at-age models, used in
fisheries stock assessments.
</p>


<h3>Details</h3>

<p><em>Import model results:</em>
</p>

<table>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+importADCAM">importADCAM</a></code> </td><td style="text-align: left;"> ADCAM model results</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+importCol">importCol</a></code>   </td><td style="text-align: left;"> Coleraine model results
  </td>
</tr>

</table>

<p><em>Plot model fit to data:</em>
</p>

<table>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+plotCA">plotCA</a></code>    </td><td style="text-align: left;"> catch at age</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+plotCL">plotCL</a></code>    </td><td style="text-align: left;"> catch at length</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+plotIndex">plotIndex</a></code> </td><td style="text-align: left;"> abundance index</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+plotLA">plotLA</a></code>    </td><td style="text-align: left;"> length at age
  </td>
</tr>

</table>

<p><em>Plot derived quantities:</em>
</p>

<table>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+plotB">plotB</a></code>   </td><td style="text-align: left;"> biomass, recruitment, and landings</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+plotN">plotN</a></code>   </td><td style="text-align: left;"> numbers at age</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+plotSel">plotSel</a></code> </td><td style="text-align: left;"> selectivity and maturity
  </td>
</tr>

</table>

<p><em>Sigmas and sample sizes:</em>
</p>

<table>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+getN">getN</a></code>, <code><a href="#topic+getSigmaI">getSigmaI</a></code>, <code><a href="#topic+getSigmaR">getSigmaR</a></code>
    </td><td style="text-align: left;"> extract</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+estN">estN</a></code>, <code><a href="#topic+estSigmaI">estSigmaI</a></code>, <code><a href="#topic+estSigmaR">estSigmaR</a></code>
    </td><td style="text-align: left;"> estimate</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+iterate">iterate</a></code> </td><td style="text-align: left;"> combine all <code>get*</code> and
    <code>est*</code></td>
</tr>
<tr>
 <td style="text-align: left;">
  </td>
</tr>

</table>

<p><em>Import MCMC results:</em>
</p>

<table>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+importMCMC">importMCMC</a></code> </td><td style="text-align: left;"> traces of likelihoods, parameters,
    biomass and recruitment</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+importProj">importProj</a></code> </td><td style="text-align: left;"> medium-term projections of biomass and
    catch
  </td>
</tr>

</table>

<p><em>Examples:</em>
</p>

<table>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+x.cod">x.cod</a></code>, <code><a href="#topic+x.ling">x.ling</a></code>, <code><a href="#topic+x.oreo">x.oreo</a></code>,
    <code><a href="#topic+x.saithe">x.saithe</a></code>, <code><a href="#topic+x.sbw">x.sbw</a></code> </td><td style="text-align: left;"> cod, ling, oreo,
    and whiting assessments</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+xmcmc">xmcmc</a></code>, <code><a href="#topic+xproj">xproj</a></code> </td><td style="text-align: left;"> MCMC results
  </td>
</tr>

</table>



<h3>Note</h3>

<p><code>browseVignettes()</code> shows the vignettes, found in the
&lsquo;<span class="file">scape/doc</span>&rsquo; directory.
</p>


<h3>Author(s)</h3>

<p>Arni Magnusson.</p>


<h3>References</h3>

<p>Magnusson, A. (2005) <em>R goes fishing: Analyzing fisheries data
using AD Model Builder and R.</em> Proceedings of the 4th International
Workshop on Distributed Statistical Computing.
</p>
<p>Magnusson, A. and Hilborn, R. (2007) What makes fisheries data
informative? <em>Fish and Fisheries</em>, <b>8</b>, 337&ndash;358.
</p>
<p>Magnusson, A., Punt, A. E. and Hilborn, R. (2013) Measuring
uncertainty in fisheries stock assessment: the delta method,
bootstrap, and MCMC. <em>Fish and Fisheries</em>, <b>14</b>, 325&ndash;342.
</p>


<h3>See Also</h3>

<p>Most <span class="pkg">scape</span> graphics are <code>trellis</code> plots, rendered with the
<span class="pkg">lattice</span> package.
</p>
<p>The functions <code>Args</code> and <code>ll</code> (package <span class="pkg">gdata</span>) can be
useful for browsing unwieldy functions and objects.
</p>
<p>The <span class="pkg">plotMCMC</span> package can be used to diagnose the results of MCMC
analysis.
</p>

<hr>
<h2 id='x.cod'>Cod Assessment</h2><span id='topic+x.cod'></span>

<h3>Description</h3>

<p>Stock assessment data and model fit for cod (<em>Gadus morhua</em>) in
Icelandic waters, using a Coleraine statistical catch-at-age model.
</p>
<p>This is a single-sex model with 10 age classes, the catch data
starting in 1971 and ending in 2003. The model was fitted to three
data components: survey abundance index, commercial catch at age, and
survey catch at age.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>x.cod</code></pre>


<h3>Format</h3>

<p>List of class <code>scape</code> containing:
</p>

<table>
<tr>
 <td style="text-align: left;">
    <code>N</code></td><td style="text-align: left;"> predicted numbers at age</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>B</code></td><td style="text-align: left;"> predicted biomass, recruitment, and observed landings
    (year things)</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>Sel</code></td><td style="text-align: left;"> predicted selectivity and observed maturity (age
    things)</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>Dev</code></td><td style="text-align: left;"> predicted recruitment deviates from the
    stock-recruitment curve</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>Survey</code></td><td style="text-align: left;"> survey abundance index and fit</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>CAc</code></td><td style="text-align: left;"> commercial C@A (catch at age) and fit</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>CAs</code></td><td style="text-align: left;"> survey C@A and fit</td>
</tr>
<tr>
 <td style="text-align: left;">
  </td>
</tr>

</table>



<h3>Details</h3>

<p>Hilborn et al. (2003) give a general description of the Coleraine
generalized model. Magnusson and Hilborn (2007) describe the model
used in this assessment.
</p>
<p>A maturity vector of zeros and ones was used to predict the biomass of
age 4 and older, the quantity of main interest for the management of
this stock.
</p>
<p>Estimated parameters: R0, Rinit, uinit, Sleft[commercial], Sfull[c],
Sleft[survey], Sfull[s], q, and 41 recruitment deviates.
</p>


<h3>Note</h3>

<p>The list was imported from the file &lsquo;<span class="file">scape/example/cod.res</span>&rsquo; using
<code>importCol</code>.
</p>
<p>The functions <code>ll</code> (package <span class="pkg">gdata</span>) and <code>head</code> are
recommended for browsing nested objects, e.g. <code>ll(x.cod)</code>,
<code>ll(x.cod$N)</code>, and <code>head(x.cod$N)</code>.
</p>


<h3>Source</h3>

<p>Magnusson, A. (2003) <em>Coleraine assessment of the Icelandic cod
stock.</em> ICES North Western Working Group (NWWG) WD 31.
</p>
<p>Marine Research Institute (2003) <em>State of marine stocks in
Icelandic waters 2002/2003.</em> Marine Research in Iceland 97.
</p>


<h3>References</h3>

<p>Hilborn, R., Maunder, M., Parma, A., Ernst, B., Payne, J. and Starr,
P. (2003) <em>Coleraine: A generalized age-structured stock
assessment model.</em> User's manual version 2.0. University of
Washington Report SAFS-UW-0116.
</p>
<p>Magnusson, A. and Hilborn, R. (2007) What makes fisheries data
informative? <em>Fish and Fisheries</em>, <b>8</b>, 337&ndash;358.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+importCol">importCol</a></code> was used to import the fitted model.
</p>
<p><code>x.cod</code>, <code><a href="#topic+x.ling">x.ling</a></code>, <code><a href="#topic+x.oreo">x.oreo</a></code>,
<code><a href="#topic+x.saithe">x.saithe</a></code>, and <code><a href="#topic+x.sbw">x.sbw</a></code> are fitted
<code>scape</code> models to explore.
</p>
<p><code><a href="#topic+xmcmc">xmcmc</a></code> and <code><a href="#topic+xproj">xproj</a></code> are MCMC results and
projections for the <code>x.cod</code> model run.
</p>
<p><code><a href="#topic+scape-package">scape-package</a></code> gives an overview of the package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plotB(x.cod)
plotCA(x.cod, "c")
plotCA(x.cod, "s")
plotIndex(x.cod, "s")
plotN(x.cod)
plotSel(x.cod)
</code></pre>

<hr>
<h2 id='x.ling'>Ling Assessment</h2><span id='topic+x.ling'></span>

<h3>Description</h3>

<p>Stock assessment data and model fit for ling (<em>Genypterus
blacodes</em>) in New Zealand waters, using a Coleraine statistical
catch-at-age model.
</p>
<p>This is a two-sex model with 30 age classes and 29 length classes, the
catch data starting in 1973 and ending in 2000. The model was fitted
to five data components: longline abundance index, survey abundance
index, survey catch at age, longline catch at length, and trawl catch
at length.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>x.ling</code></pre>


<h3>Format</h3>

<p>List of class <code>scape</code> containing:
</p>

<table>
<tr>
 <td style="text-align: left;">
    <code>N</code></td><td style="text-align: left;"> predicted numbers at age</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>B</code></td><td style="text-align: left;"> predicted biomass, recruitment, and observed landings
    (year things)</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>Sel</code></td><td style="text-align: left;"> predicted selectivity and observed maturity (age
    things)</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>Dev</code></td><td style="text-align: left;"> predicted recruitment deviates from the
    stock-recruitment curve</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>CPUE</code></td><td style="text-align: left;"> commercial abundance index and fit</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>Survey</code></td><td style="text-align: left;"> survey abundance index and fit</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>CAs</code></td><td style="text-align: left;"> survey C@A (catch at age) and fit</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>CLc</code></td><td style="text-align: left;"> commercial C@L (catch at length) and fit</td>
</tr>
<tr>
 <td style="text-align: left;">
  </td>
</tr>

</table>



<h3>Details</h3>

<p>Hilborn et al. (2003) give a general description of the Coleraine
generalized model.
</p>
<p>Estimated parameters: R0, Rinit, Sleft[trawl], Sfemale[t], Smale[t],
Sright[t], Sleft[longline], Sfemale[l], Smale[l], Sright[l],
Sleft[survey], Sfemale[s], Smale[s], Sright[s], q[l], q[s], and 29
recruitment deviates.
</p>


<h3>Note</h3>

<p>The list was imported from the file &lsquo;<span class="file">scape/example/ling.res</span>&rsquo;
using <code>importCol</code>.
</p>
<p>The functions <code>ll</code> (package <span class="pkg">gdata</span>) and <code>head</code> are
recommended for browsing nested objects, e.g. <code>ll(x.ling)</code>,
<code>ll(x.ling$N)</code>, and <code>head(x.ling$N)</code>.
</p>


<h3>Source</h3>

<p>Annala, J. H., Sullivan, K. J., O'Brien, C. J. and Smith, N. W. M.,
eds. (2001) <em>Report from the Fishery Assessment Plenary: Stock
assessments and yield estimates.</em> NIWA, Wellington.
</p>
<p>Magnusson, A. (2001) <em>SeaFIC assessment of Chatham Rise ling (LIN
3 and 4).</em> Middle Depths Working Group Doc. 11. Report for the New
Zealand Ministry of Fisheries.
</p>


<h3>References</h3>

<p>Hilborn, R., Maunder, M., Parma, A., Ernst, B., Payne, J. and Starr,
P. (2003) <em>Coleraine: A generalized age-structured stock
assessment model.</em> User's manual version 2.0. University of
Washington Report SAFS-UW-0116.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+importCol">importCol</a></code> was used to import the fitted model.
</p>
<p><code><a href="#topic+x.cod">x.cod</a></code>, <code>x.ling</code>, <code><a href="#topic+x.oreo">x.oreo</a></code>,
<code><a href="#topic+x.saithe">x.saithe</a></code>, and <code><a href="#topic+x.sbw">x.sbw</a></code> are fitted
<code>scape</code> models to explore.
</p>
<p><code><a href="#topic+scape-package">scape-package</a></code> gives an overview of the package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plotB(x.ling)
plotCA(x.ling, "s")
plotCL(x.ling, "c", series="1")
plotCL(x.ling, "c", series="2")
plotIndex(x.ling, "c")
plotIndex(x.ling, "s")
plotN(x.ling)
plotSel(x.ling)
</code></pre>

<hr>
<h2 id='x.oreo'>Oreo Assessment</h2><span id='topic+x.oreo'></span>

<h3>Description</h3>

<p>Stock assessment data and model fit for smooth oreo
(<em>Pseudocyttus maculatus</em>) in New Zealand waters, using a
Coleraine statistical catch-at-age model.
</p>
<p>This is a two-sex model with 80 age classes and 44 length classes, the
catch data starting in 1979 and ending in 2001. The model was fitted
to seven data components: pre-GPS commercial abundance index, post-GPS
commercial abundance index, survey abundance index, commercial catch
at length, survey catch at length, female length at age, and male
length at age.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>x.oreo</code></pre>


<h3>Format</h3>

<p>List of class <code>scape</code> containing:
</p>

<table>
<tr>
 <td style="text-align: left;">
    <code>N</code></td><td style="text-align: left;"> predicted numbers at age</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>B</code></td><td style="text-align: left;"> predicted biomass, recruitment, and observed landings
    (year things)</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>Sel</code></td><td style="text-align: left;"> predicted selectivity and observed maturity (age
    things)</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>CPUE</code></td><td style="text-align: left;"> commercial abundance index and fit</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>Survey</code></td><td style="text-align: left;"> survey abundance index and fit</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>CLc</code></td><td style="text-align: left;"> commercial C@L (catch at length) and fit</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>CLs</code></td><td style="text-align: left;"> survey C@L and fit</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>LA</code></td><td style="text-align: left;"> observed L@A (length at age)</td>
</tr>
<tr>
 <td style="text-align: left;">
  </td>
</tr>

</table>



<h3>Details</h3>

<p>Hilborn et al. (2003) give a general description of the Coleraine
generalized model.
</p>
<p>Since relatively few smooth oreo individuals have been aged, this
assessment admits uncertainty about the von Bertalanffy growth curve,
which is estimated for each sex. The acoustic survey abundance
estimate is considered absolute, so q[survey] is fixed at 1.
</p>
<p>Estimated parameters: R0, Sfull[commercial], Sfull[survey],
q[pre-GPS], q[post-GPS], L80female, L80male, Kfemale, Kmale, CVfemale,
and CVmale.
</p>


<h3>Note</h3>

<p>The list was imported from the files &lsquo;<span class="file">scape/example/oreo.res</span>&rsquo;,
&lsquo;<span class="file">oreo.txt</span>&rsquo;, and &lsquo;<span class="file">l\_at\_age.dat</span>&rsquo; using <code>importCol</code>.
</p>
<p>The functions <code>ll</code> (package <span class="pkg">gdata</span>) and <code>head</code> are
recommended for browsing nested objects, e.g. <code>ll(x.oreo)</code>,
<code>ll(x.oreo$N)</code>, and <code>head(x.oreo$N)</code>.
</p>


<h3>Source</h3>

<p>Annala, J. H., Sullivan, K. J., O'Brien, C. J., Smith, N. W. M. and
Grayling S. M., eds. (2003) <em>Report from the Fishery Assessment
Plenary: Stock assessments and yield estimates.</em> Ministry of
Fisheries, Wellington.
</p>


<h3>References</h3>

<p>Hilborn, R., Maunder, M., Parma, A., Ernst, B., Payne, J. and Starr,
P. (2003) <em>Coleraine: A generalized age-structured stock
assessment model.</em> User's manual version 2.0. University of
Washington Report SAFS-UW-0116.
</p>
<p>Magnusson, A. (2003) <em>Stock assessment of Chatham Rise smooth
oreo (SSO4).</em> Deepwater Working Group Doc. 16. Report for the New
Zealand Ministry of Fisheries.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+importCol">importCol</a></code> was used to import the fitted model.
</p>
<p><code><a href="#topic+x.cod">x.cod</a></code>, <code><a href="#topic+x.ling">x.ling</a></code>, <code>x.oreo</code>,
<code><a href="#topic+x.saithe">x.saithe</a></code>, and <code><a href="#topic+x.sbw">x.sbw</a></code> are fitted
<code>scape</code> models to explore.
</p>
<p><code><a href="#topic+scape-package">scape-package</a></code> gives an overview of the package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plotB(x.oreo)
plotCL(x.oreo, "c")
plotCL(x.oreo, "s")
plotIndex(x.oreo, "c")
plotIndex(x.oreo, "s")
plotLA(x.oreo)
plotN(x.oreo)
plotSel(x.oreo)
</code></pre>

<hr>
<h2 id='x.saithe'>Saithe Assessment</h2><span id='topic+x.saithe'></span>

<h3>Description</h3>

<p>Stock assessment data and model fit for saithe
(<em>Pollachius virens</em>) in Icelandic waters, using an ADCAM-type
(separable) catch-at-age model.
</p>
<p>This is a single-sex model with 14 age classes, the catch data
starting in 1980 and ending in 2014. The model was fitted to two data
components: survey abundance index and commercial catch at age.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>x.saithe</code></pre>


<h3>Format</h3>

<p>List of class <code>scape</code> containing:
</p>

<table>
<tr>
 <td style="text-align: left;">
    <code>N</code></td><td style="text-align: left;"> predicted numbers at age</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>B</code></td><td style="text-align: left;"> predicted biomass, recruitment, and observed landings
    (year things)</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>Sel</code></td><td style="text-align: left;"> predicted selectivity and observed maturity (age
    things)</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>Dev</code></td><td style="text-align: left;"> predicted recruitment deviates from the
    stock-recruitment curve</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>Survey</code></td><td style="text-align: left;"> survey abundance index and fit</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>CAc</code></td><td style="text-align: left;"> commercial C@A (catch at age) and fit</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>CAs</code></td><td style="text-align: left;"> survey C@A and fit</td>
</tr>
<tr>
 <td style="text-align: left;">
  </td>
</tr>

</table>



<h3>Details</h3>

<p>Bjornsson and Magnusson (2009) give a general description of the ADCAM
modelling platform. The specific model used in this assessment is
described in the ICES (2015) assessment report.
</p>
<p>Fleet selectivity is modelled with three periods: 1980-1996,
1997-2003, and 2004 onwards.
</p>


<h3>Note</h3>

<p>The list was imported from results files in the directory
&lsquo;<span class="file">scape/example/saithe</span>&rsquo; using <code>importADCAM</code>.
</p>
<p>The functions <code>ll</code> (package <span class="pkg">gdata</span>) and <code>head</code> are
recommended for browsing nested objects, e.g. <code>ll(x.saithe)</code>,
<code>ll(x.saithe$N)</code>, and <code>head(x.saithe$N)</code>.
</p>


<h3>Source</h3>

<p>ICES (2015) <em>Report of the North-Western Working Group (NWWG).</em>
ICES CM 2015/ACOM:07.
</p>


<h3>References</h3>

<p>Bjornsson, H. and A. Magnusson. (2009) <em>ADCAM user manual (draft
version).</em> ICES CM 2009/ACOM:56, Annex 6.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+importADCAM">importADCAM</a></code> was used to import the fitted model.
</p>
<p><code><a href="#topic+x.cod">x.cod</a></code>, <code><a href="#topic+x.ling">x.ling</a></code>, <code><a href="#topic+x.oreo">x.oreo</a></code>,
<code>x.saithe</code>, and <code><a href="#topic+x.sbw">x.sbw</a></code> are fitted <code>scape</code>
models to explore.
</p>
<p><code><a href="#topic+scape-package">scape-package</a></code> gives an overview of the package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plotB(x.saithe)
plotCA(x.saithe, "c")
plotCA(x.saithe, "s")
plotIndex(x.saithe, "s")
plotN(x.saithe)
plotSel(x.saithe)
</code></pre>

<hr>
<h2 id='x.sbw'>Whiting Assessment</h2><span id='topic+x.sbw'></span>

<h3>Description</h3>

<p>Stock assessment data and model fit for southern blue whiting
(<em>Micromesistius australis</em>) in New Zealand waters, using a
Coleraine statistical catch-at-age model.
</p>
<p>This is a single-sex model with 11 age classes, the catch data
starting in 1979 and ending in 2002. The model was fitted to two data
components: survey abundance index and commercial catch at age.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>x.sbw</code></pre>


<h3>Format</h3>

<p>List of class <code>scape</code> containing:
</p>

<table>
<tr>
 <td style="text-align: left;">
    <code>N</code></td><td style="text-align: left;"> predicted numbers at age</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>B</code></td><td style="text-align: left;"> predicted biomass, recruitment, and observed landings
    (year things)</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>Sel</code></td><td style="text-align: left;"> predicted selectivity and observed maturity (age
    things)</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>Dev</code></td><td style="text-align: left;"> predicted recruitment deviates from the
    stock-recruitment curve</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>Survey</code></td><td style="text-align: left;"> survey abundance index and fit</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>CAc</code></td><td style="text-align: left;"> commercial C@A (catch at age) and fit</td>
</tr>
<tr>
 <td style="text-align: left;">
  </td>
</tr>

</table>



<h3>Details</h3>

<p>Hilborn et al. (2003) give a general description of the Coleraine
generalized model.
</p>
<p>The survey abundance index was preprocessed so that it contains only
age 4 and older.
</p>
<p>Estimated parameters: R0, Rinit, Rplus, Sleft[commercial], Sfull[c],
q, and 33 recruitment deviates.
</p>


<h3>Note</h3>

<p>The list was imported from the file &lsquo;<span class="file">scape/example/sbw.res</span>&rsquo; using
<code>importCol</code>.
</p>
<p>The functions <code>ll</code> (package <span class="pkg">gdata</span>) and <code>head</code> are
recommended for browsing nested objects, e.g. <code>ll(x.sbw)</code>,
<code>ll(x.sbw$N)</code>, and <code>head(x.sbw$N)</code>.
</p>


<h3>Source</h3>

<p>Annala, J. H., Sullivan, K. J., O'Brien, C. J., Smith, N. W. M. and
Grayling S. M., eds. (2003) <em>Report from the Fishery Assessment
Plenary: Stock assessments and yield estimates.</em> Ministry of
Fisheries, Wellington.
</p>


<h3>References</h3>

<p>Branch, T. A., Magnusson, A., Hilborn, R. and Starr, P. J. (2002)
<em>Stock assessment of the Campbell Island Rise population of
southern blue whiting (Micromesistius australis) for the 2000&ndash;01
fishing season</em>. University of Washington Report SAFS-UW-0107.
</p>
<p>Hilborn, R., Maunder, M., Parma, A., Ernst, B., Payne, J. and Starr,
P. (2003) <em>Coleraine: A generalized age-structured stock
assessment model.</em> User's manual version 2.0. University of
Washington Report SAFS-UW-0116.
</p>
<p>Magnusson, A. and Hilborn, R. 2004. <em>What is it in fisheries data
that tells us about population abundance?</em> Poster presented at the
4th World Fisheries Congress, Vancouver, BC.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+importCol">importCol</a></code> was used to import the fitted model.
</p>
<p><code><a href="#topic+x.cod">x.cod</a></code>, <code><a href="#topic+x.ling">x.ling</a></code>, <code><a href="#topic+x.oreo">x.oreo</a></code>,
<code><a href="#topic+x.saithe">x.saithe</a></code>, and <code>x.sbw</code> are fitted <code>scape</code>
models to explore.
</p>
<p><code><a href="#topic+scape-package">scape-package</a></code> gives an overview of the package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plotB(x.sbw)
plotCA(x.sbw, "c")
plotIndex(x.sbw, "s")
plotN(x.sbw)
plotSel(x.sbw)
</code></pre>

<hr>
<h2 id='xmcmc'>MCMC Results from Cod Assessment</h2><span id='topic+xmcmc'></span>

<h3>Description</h3>

<p>Markov chain Monte Carlo results from stock assessment of cod
(<em>Gadus morhua</em>) in Icelandic waters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xmcmc</code></pre>


<h3>Format</h3>

<p>List containing four data frames:
</p>

<table>
<tr>
 <td style="text-align: left;">
    <code>L</code></td><td style="text-align: left;"> likelihood components: <code>CAc</code> (commercial catch at
    age), <code>CAs</code> (survey catch at age), <code>Survey</code> (survey
    abundance index), <code>Prior</code> (penalty for priors), <code>Total</code>
    (sum of all likelihood components; the objective function).</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>P</code></td><td style="text-align: left;"> estimated parameters: <code>R0</code> (average virgin
    recruitment), <code>Rinit</code> (initial recruitment scaler),
    <code>uinit</code> (initial harvest rate), <code>cSleft</code> (left-side slope
    of commercial selectivity curve), <code>cSfull</code> (age at full
    commercial selectivity), <code>sSleft</code> (left-side slope of survey
    selectivity curve), <code>sSfull</code> (age at full survey selectivity),
    <code>logq</code> (log-transformed survey catchability).</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>B</code></td><td style="text-align: left;"> predicted biomass (age 4+) by year.</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>R</code></td><td style="text-align: left;"> predicted recruitment by year.</td>
</tr>
<tr>
 <td style="text-align: left;">
  </td>
</tr>

</table>



<h3>Details</h3>

<p>See the <code><a href="#topic+x.cod">x.cod</a></code> help page for details about the data and
model.
</p>


<h3>Note</h3>

<p>The list was imported from the files &lsquo;<span class="file">mcmclike.out</span>&rsquo;,
&lsquo;<span class="file">params.pst</span>&rsquo;, &lsquo;<span class="file">spawbiom.pst</span>&rsquo; and &lsquo;<span class="file">recruits.pst</span>&rsquo;, using
the <code>importMCMC()</code> function. These files can be found in the
&lsquo;<span class="file">scape/example/mcmc</span>&rsquo; directory.
</p>
<p>The functions <code>ll</code> (package <span class="pkg">gdata</span>) and <code>head</code>
are recommended for browsing nested objects, e.g. <code>ll(xmcmc)</code>,
<code>ll(xmcmc$P)</code>, and <code>head(xmcmc$P)</code>.
</p>
<p>The <span class="pkg">plotMCMC</span> package is recommended for plotting MCMC
diagnostics and posteriors.
</p>


<h3>References</h3>

<p>Magnusson, A., Punt, A. E. and Hilborn, R. (2013) Measuring
uncertainty in fisheries stock assessment: the delta method,
bootstrap, and MCMC. <em>Fish and Fisheries</em>, <b>14</b>, 325&ndash;342.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+importMCMC">importMCMC</a></code> was used to import the MCMC results.
</p>
<p><code>xmcmc</code> and <code><a href="#topic+xproj">xproj</a></code> are MCMC results and projections
for the <code><a href="#topic+x.cod">x.cod</a></code> model run.
</p>
<p><code><a href="#topic+scape-package">scape-package</a></code> gives an overview of the package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># See examples in package 'plotMCMC'
</code></pre>

<hr>
<h2 id='xproj'>MCMC Projections from Cod Assessment</h2><span id='topic+xproj'></span>

<h3>Description</h3>

<p>Markov chain Monte Carlo projections from stock assessment of cod
(<em>Gadus morhua</em>) in Icelandic waters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xproj</code></pre>


<h3>Format</h3>

<p>List containing two lists:
</p>

<table>
<tr>
 <td style="text-align: left;">
    <code>B</code></td><td style="text-align: left;"> projected biomass by year, given a constant harvest
    rate policy: <code>"0"</code>, <code>"0.05"</code>, ..., <code>"0.50"</code>.</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>Y</code></td><td style="text-align: left;"> projected catch by year, given a constant harvest rate
    policy: <code>"0"</code>, <code>"0.05"</code>, ..., <code>"0.50"</code>.</td>
</tr>
<tr>
 <td style="text-align: left;">
  </td>
</tr>

</table>



<h3>Details</h3>

<p>MCMC projections can be used to evaluate the medium-term outcome of
harvest policies (in this case, a certain fixed harvest rate), given
the uncertainty about parameter values and random future recruitment.
</p>
<p>See the <code><a href="#topic+x.cod">x.cod</a></code> help page for details about the data and
model.
</p>


<h3>Note</h3>

<p>The list was imported from the files &lsquo;<span class="file">strategy.out</span>&rsquo;,
&lsquo;<span class="file">projspbm.out</span>&rsquo; and &lsquo;<span class="file">procatch.out</span>&rsquo;, using the
<code>importProj()</code> function. These files can be found in the
&lsquo;<span class="file">scape/example/mcmc</span>&rsquo; directory.
</p>
<p>The functions <code>ll</code> (package <span class="pkg">gdata</span>) and <code>head</code>
are recommended for browsing nested objects, e.g. <code>ll(xproj)</code>,
<code>ll(xproj$B)</code>, <code>ll(xproj$B$"0.25")</code>, and
<code>head(xproj$B$"0.25")</code>.
</p>
<p>The <span class="pkg">plotMCMC</span> package is recommended for plotting MCMC
diagnostics and posteriors.
</p>


<h3>References</h3>

<p>Magnusson, A., Punt, A. E. and Hilborn, R. (2013) Measuring
uncertainty in fisheries stock assessment: the delta method,
bootstrap, and MCMC. <em>Fish and Fisheries</em>, <b>14</b>, 325&ndash;342.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+importProj">importProj</a></code> was used to import the MCMC projections.
</p>
<p><code><a href="#topic+xmcmc">xmcmc</a></code> and <code>xproj</code> are MCMC results and projections
for the <code><a href="#topic+x.cod">x.cod</a></code> model run.
</p>
<p><code><a href="#topic+scape-package">scape-package</a></code> gives an overview of the package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># See examples in package 'plotMCMC'
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
