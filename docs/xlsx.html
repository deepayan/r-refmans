<!DOCTYPE html><html><head><title>Help for package xlsx</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {xlsx}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#addDataFrame'><p>Add a <code>data.frame</code> to a sheet.</p></a></li>
<li><a href='#addHyperlink'><p>Add a hyperlink to a cell.</p></a></li>
<li><a href='#Cell'><p>Functions to manipulate cells.</p></a></li>
<li><a href='#CellBlock'><p>Create and style a block of cells.</p></a></li>
<li><a href='#CellStyle'><p>Functions to manipulate cells.</p></a></li>
<li><a href='#CellStyle-plus'><p>CellStyle construction.</p></a></li>
<li><a href='#Comment'><p>Functions to manipulate cell comments.</p></a></li>
<li><a href='#forceFormulaRefresh'><p>Force Refresh Pivot Tables and Formulae</p></a></li>
<li><a href='#is.Alignment'><p>Create an Alignment object.</p></a></li>
<li><a href='#is.Border'><p>Create an Border object.</p></a></li>
<li><a href='#is.CellProtection'><p>Create a CellProtection object.</p></a></li>
<li><a href='#is.DataFormat'><p>Create an DataFormat object.</p></a></li>
<li><a href='#is.Fill'><p>Create an Fill object.</p></a></li>
<li><a href='#is.Font'><p>Create a Font object.</p></a></li>
<li><a href='#NamedRanges'><p>Functions to manipulate (contiguous) named ranges.</p></a></li>
<li><a href='#OtherEffects'><p>Functions to do various spreadsheets effects.</p></a></li>
<li><a href='#Picture'><p>Functions to manipulate images in a spreadsheet.</p></a></li>
<li><a href='#POI_constants'><p>Constants used in the project.</p></a></li>
<li><a href='#PrintSetup'><p>Function to manipulate print setup.</p></a></li>
<li><a href='#read.xlsx'><p>Read the contents of a worksheet into an R <code>data.frame</code>.</p></a></li>
<li><a href='#readColumns'><p>Read a contiguous set of columns from sheet into an R data.frame</p></a></li>
<li><a href='#readRows'><p>Read a contiguous set of rows into an R matrix</p></a></li>
<li><a href='#Row'><p>Functions to manipulate rows of a worksheet.</p></a></li>
<li><a href='#set_java_tmp_dir'><p>Set Java Temp Directory</p></a></li>
<li><a href='#Sheet'><p>Functions to manipulate worksheets.</p></a></li>
<li><a href='#Workbook'><p>Functions to manipulate Excel 2007 workbooks.</p></a></li>
<li><a href='#write.xlsx'><p>Write a data.frame to an Excel workbook.</p></a></li>
<li><a href='#xlsx-package'><p>Read, write, format Excel 2007 and Excel 97/2000/XP/2003 files</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Read, Write, Format Excel 2007 and Excel 97/2000/XP/2003 Files</td>
</tr>
<tr>
<td>Version:</td>
<td>0.6.5</td>
</tr>
<tr>
<td>Imports:</td>
<td>rJava, xlsxjars, grDevices, utils</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>Description:</td>
<td>Provide R functions to read/write/format Excel 2007 and Excel 97/2000/XP/2003 file formats.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/colearendt/xlsx">https://github.com/colearendt/xlsx</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/colearendt/xlsx/issues">https://github.com/colearendt/xlsx/issues</a></td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>java (&gt;= 1.6)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>rprojroot, testthat, covr, tibble, knitr, rmarkdown</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.0</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-11-10 12:06:13 UTC; carendt</td>
</tr>
<tr>
<td>Author:</td>
<td>Adrian Dragulescu [aut],
  Cole Arendt [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Cole Arendt &lt;cole.arendt@outlook.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-11-10 15:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='addDataFrame'>Add a <code>data.frame</code> to a sheet.</h2><span id='topic+addDataFrame'></span>

<h3>Description</h3>

<p>Add a <code>data.frame</code> to a sheet, allowing for different column styles.
Useful when constructing the spreadsheet from scratch.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>addDataFrame(
  x,
  sheet,
  col.names = TRUE,
  row.names = TRUE,
  startRow = 1,
  startColumn = 1,
  colStyle = NULL,
  colnamesStyle = NULL,
  rownamesStyle = NULL,
  showNA = FALSE,
  characterNA = "",
  byrow = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="addDataFrame_+3A_x">x</code></td>
<td>
<p>a <code>data.frame</code>.</p>
</td></tr>
<tr><td><code id="addDataFrame_+3A_sheet">sheet</code></td>
<td>
<p>a <code><a href="#topic+Sheet">Sheet</a></code> object.</p>
</td></tr>
<tr><td><code id="addDataFrame_+3A_col.names">col.names</code></td>
<td>
<p>a logical value indicating if the column names of <code>x</code>
are to be written along with <code>x</code> to the file.</p>
</td></tr>
<tr><td><code id="addDataFrame_+3A_row.names">row.names</code></td>
<td>
<p>a logical value indicating whether the row names of
<code>x</code> are to be written along with <code>x</code> to the file.</p>
</td></tr>
<tr><td><code id="addDataFrame_+3A_startrow">startRow</code></td>
<td>
<p>a numeric value for the starting row.</p>
</td></tr>
<tr><td><code id="addDataFrame_+3A_startcolumn">startColumn</code></td>
<td>
<p>a numeric value for the starting column.</p>
</td></tr>
<tr><td><code id="addDataFrame_+3A_colstyle">colStyle</code></td>
<td>
<p>a list of <code><a href="#topic+CellStyle">CellStyle</a></code>.  If the name of the list
element is the column number, it will be used to set the style of the
column.  Columns of type <code>Date</code> and <code>POSIXct</code> are styled
automatically even if <code>colSyle=NULL</code>.</p>
</td></tr>
<tr><td><code id="addDataFrame_+3A_colnamesstyle">colnamesStyle</code></td>
<td>
<p>a <code><a href="#topic+CellStyle">CellStyle</a></code> object to customize the table
header.</p>
</td></tr>
<tr><td><code id="addDataFrame_+3A_rownamesstyle">rownamesStyle</code></td>
<td>
<p>a <code><a href="#topic+CellStyle">CellStyle</a></code> object to customize the row
names (if <code>row.names=TRUE</code>).</p>
</td></tr>
<tr><td><code id="addDataFrame_+3A_showna">showNA</code></td>
<td>
<p>a boolean value to control how NA's are displayed on the
sheet.  If <code>FALSE</code>, NA values will be represented as blank cells.</p>
</td></tr>
<tr><td><code id="addDataFrame_+3A_characterna">characterNA</code></td>
<td>
<p>a string value to control how character NA will be shown
in the spreadsheet.</p>
</td></tr>
<tr><td><code id="addDataFrame_+3A_byrow">byrow</code></td>
<td>
<p>a logical value indicating if the data.frame should be added to
the sheet in row wise fashion.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Starting with version 0.5.0 this function uses the functionality provided by
<code>CellBlock</code> which results in a significant improvement in performance
compared with a cell by cell application of <code><a href="#topic+setCellValue">setCellValue</a></code> and
with other previous atempts.
</p>
<p>It is difficult to treat <code>NA</code>'s consistently between R and Excel via
Java.  Most likely, users of Excel will want to see <code>NA</code>'s as blank
cells.  In R character <code>NA</code>'s are simply characters, which for Excel
means &quot;NA&quot;.
</p>
<p>The default formats for Date and DateTime columns can be changed via the two
package options <code>xlsx.date.format</code> and <code>xlsx.datetime.format</code>.
They need to be specified in Java date format
<a href="https://docs.oracle.com/javase/7/docs/api/java/text/SimpleDateFormat.html">https://docs.oracle.com/javase/7/docs/api/java/text/SimpleDateFormat.html</a>.
</p>


<h3>Value</h3>

<p>None.  The modification to the workbook is done in place.
</p>


<h3>Author(s)</h3>

<p>Adrian Dragulescu
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

  wb &lt;- createWorkbook()
  sheet  &lt;- createSheet(wb, sheetName="addDataFrame1")
  data &lt;- data.frame(mon=month.abb[1:10], day=1:10, year=2000:2009,
    date=seq(as.Date("1999-01-01"), by="1 year", length.out=10),
    bool=c(TRUE, FALSE), log=log(1:10),
    rnorm=10000*rnorm(10),
    datetime=seq(as.POSIXct("2011-11-06 00:00:00", tz="GMT"), by="1 hour",
      length.out=10))
  cs1 &lt;- CellStyle(wb) + Font(wb, isItalic=TRUE)           # rowcolumns
  cs2 &lt;- CellStyle(wb) + Font(wb, color="blue")
  cs3 &lt;- CellStyle(wb) + Font(wb, isBold=TRUE) + Border()  # header
  addDataFrame(data, sheet, startRow=3, startColumn=2, colnamesStyle=cs3,
    rownamesStyle=cs1, colStyle=list(`2`=cs2, `3`=cs2))

  # to change the default date format use something like this
  # options(xlsx.date.format="dd MMM, yyyy")


  # Don't forget to save the workbook ...
  # saveWorkbook(wb, file)

</code></pre>

<hr>
<h2 id='addHyperlink'>Add a hyperlink to a cell.</h2><span id='topic+addHyperlink'></span>

<h3>Description</h3>

<p>Add a hyperlink to a cell to point to an external resource.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>addHyperlink(
  cell,
  address,
  linkType = c("URL", "DOCUMENT", "EMAIL", "FILE"),
  hyperlinkStyle = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="addHyperlink_+3A_cell">cell</code></td>
<td>
<p>a <code><a href="#topic+Cell">Cell</a></code> object.</p>
</td></tr>
<tr><td><code id="addHyperlink_+3A_address">address</code></td>
<td>
<p>a string pointing to the resource.</p>
</td></tr>
<tr><td><code id="addHyperlink_+3A_linktype">linkType</code></td>
<td>
<p>a the type of the resource.</p>
</td></tr>
<tr><td><code id="addHyperlink_+3A_hyperlinkstyle">hyperlinkStyle</code></td>
<td>
<p>a <code><a href="#topic+CellStyle">CellStyle</a></code> object.  If <code>NULL</code> a
default cell style is created, blue underlined font.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The cell needs to have content before you add a hyperlink to it.  The
contents of the cells don't need to be the same as the address of the
hyperlink.  See the examples.
</p>


<h3>Value</h3>

<p>None.  The modification to the cell is done in place.
</p>


<h3>Author(s)</h3>

<p>Adrian Dragulescu
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

  wb &lt;- createWorkbook()
  sheet1 &lt;- createSheet(wb, "Sheet1")
  rows   &lt;- createRow(sheet1, 1:10)              # 10 rows
  cells  &lt;- createCell(rows, colIndex=1:8)       # 8 columns

  ## Add hyperlinks to a cell
  cell &lt;- cells[[1,1]]
  address &lt;- "https://poi.apache.org/"
  setCellValue(cell, "click me!")
  addHyperlink(cell, address)

  # Don't forget to save the workbook ...

</code></pre>

<hr>
<h2 id='Cell'>Functions to manipulate cells.</h2><span id='topic+Cell'></span><span id='topic+createCell'></span><span id='topic+getCells'></span><span id='topic+setCellValue'></span><span id='topic+getCellValue'></span>

<h3>Description</h3>

<p>Functions to manipulate cells.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>createCell(row, colIndex = 1:5)

getCells(row, colIndex = NULL, simplify = TRUE)

setCellValue(cell, value, richTextString = FALSE, showNA = TRUE)

getCellValue(cell, keepFormulas = FALSE, encoding = "unknown")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Cell_+3A_row">row</code></td>
<td>
<p>a list of row objects. See <code>Row</code>.</p>
</td></tr>
<tr><td><code id="Cell_+3A_colindex">colIndex</code></td>
<td>
<p>a numeric vector specifying the index of columns.</p>
</td></tr>
<tr><td><code id="Cell_+3A_simplify">simplify</code></td>
<td>
<p>a logical value.  If <code>TRUE</code>, the result will be
unlisted.</p>
</td></tr>
<tr><td><code id="Cell_+3A_cell">cell</code></td>
<td>
<p>a <code>Cell</code> object.</p>
</td></tr>
<tr><td><code id="Cell_+3A_value">value</code></td>
<td>
<p>an R variable of length one.</p>
</td></tr>
<tr><td><code id="Cell_+3A_richtextstring">richTextString</code></td>
<td>
<p>a logical value indicating if the value should be
inserted into the Excel cell as rich text.</p>
</td></tr>
<tr><td><code id="Cell_+3A_showna">showNA</code></td>
<td>
<p>a logical value.  If <code>TRUE</code> the cell will contain the
&quot;#N/A&quot; value, if <code>FALSE</code> they will be skipped.  The default value was
chosen to remain compatible with previous versions of the function.</p>
</td></tr>
<tr><td><code id="Cell_+3A_keepformulas">keepFormulas</code></td>
<td>
<p>a logical value.  If <code>TRUE</code> the formulas will be
returned as characters instead of being explicitly evaluated.</p>
</td></tr>
<tr><td><code id="Cell_+3A_encoding">encoding</code></td>
<td>
<p>A character value to set the encoding, for example &quot;UTF-8&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>setCellValue</code> writes the content of an R variable into the cell.
<code>Date</code> and <code>POSIXct</code> objects are passed in as numerical values.
To format them as dates in Excel see <code><a href="#topic+CellStyle">CellStyle</a></code>.
</p>
<p>These functions are not vectorized and should be used only for small
spreadsheets.  Use <code>CellBlock</code> functionality to efficiently read/write
parts of a spreadsheet.
</p>


<h3>Value</h3>

<p><code>createCell</code> creates a matrix of lists, each element of the list being
a java object reference to an object of type Cell representing an empty
cell.  The dimnames of this matrix are taken from the names of the rows and
the <code>colIndex</code> variable.
</p>
<p><code>getCells</code> returns a list of java object references for all the cells
in the row if <code>colIndex</code> is <code>NULL</code>.  If you want to extract only a
specific columns, set <code>colIndex</code> to the column indices you are
interested.
</p>
<p><code>getCellValue</code> returns the value in the cell as an R object.  Type
conversions are done behind the scene.  This function is not vectorized.
</p>


<h3>Author(s)</h3>

<p>Adrian Dragulescu
</p>


<h3>See Also</h3>

<p>To format cells, see <code><a href="#topic+CellStyle">CellStyle</a></code>.  For rows see
<code><a href="#topic+Row">Row</a></code>, for sheets see <code><a href="#topic+Sheet">Sheet</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

file &lt;- system.file("tests", "test_import.xlsx", package = "xlsx")

wb &lt;- loadWorkbook(file)  
sheets &lt;- getSheets(wb)

sheet &lt;- sheets[['mixedTypes']]      # get second sheet
rows  &lt;- getRows(sheet)   # get all the rows

cells &lt;- getCells(rows)   # returns all non empty cells

values &lt;- lapply(cells, getCellValue) # extract the values

# write the months of the year in the first column of the spreadsheet
ind &lt;- paste(2:13, ".2", sep="")
mapply(setCellValue, cells[ind], month.name)

####################################################################
# make a new workbook with one sheet and 5x5 cells
wb &lt;- createWorkbook()
sheet &lt;- createSheet(wb, "Sheet1")
rows  &lt;- createRow(sheet, rowIndex=1:5)
cells &lt;- createCell(rows, colIndex=1:5) 

# populate the first column with Dates
days &lt;- seq(as.Date("2013-01-01"), by="1 day", length.out=5)
mapply(setCellValue, cells[,1], days)

 

</code></pre>

<hr>
<h2 id='CellBlock'>Create and style a block of cells.</h2><span id='topic+CellBlock'></span><span id='topic+is.CellBlock'></span><span id='topic+CellBlock.default'></span><span id='topic+CB.setColData'></span><span id='topic+CB.setRowData'></span><span id='topic+CB.setMatrixData'></span><span id='topic+CB.setFill'></span><span id='topic+CB.setFont'></span><span id='topic+CB.setBorder'></span>

<h3>Description</h3>

<p>Functions to create and style (not read) a block of cells.  Use it to
set/update cell values and cell styles in an efficient manner.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CellBlock(sheet, startRow, startColumn, noRows, noColumns, create = TRUE)

is.CellBlock(cellBlock)

## Default S3 method:
CellBlock(sheet, startRow, startColumn, noRows, noColumns, create = TRUE)

CB.setColData(
  cellBlock,
  x,
  colIndex,
  rowOffset = 0,
  showNA = TRUE,
  colStyle = NULL
)

CB.setRowData(
  cellBlock,
  x,
  rowIndex,
  colOffset = 0,
  showNA = TRUE,
  rowStyle = NULL
)

CB.setMatrixData(
  cellBlock,
  x,
  startRow,
  startColumn,
  showNA = TRUE,
  cellStyle = NULL
)

CB.setFill(cellBlock, fill, rowIndex, colIndex)

CB.setFont(cellBlock, font, rowIndex, colIndex)

CB.setBorder(cellBlock, border, rowIndex, colIndex)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CellBlock_+3A_sheet">sheet</code></td>
<td>
<p>a <code><a href="#topic+Sheet">Sheet</a></code> object.</p>
</td></tr>
<tr><td><code id="CellBlock_+3A_startrow">startRow</code></td>
<td>
<p>a numeric value for the starting row.</p>
</td></tr>
<tr><td><code id="CellBlock_+3A_startcolumn">startColumn</code></td>
<td>
<p>a numeric value for the starting column.</p>
</td></tr>
<tr><td><code id="CellBlock_+3A_norows">noRows</code></td>
<td>
<p>a numeric value to specify the number of rows for the block.</p>
</td></tr>
<tr><td><code id="CellBlock_+3A_nocolumns">noColumns</code></td>
<td>
<p>a numeric value to specify the number of columns for the
block.</p>
</td></tr>
<tr><td><code id="CellBlock_+3A_create">create</code></td>
<td>
<p>If <code>TRUE</code> cells will be created if they don't exist, if
<code>FALSE</code> only existing cells will be used.  If cells don't exist (on a
new sheet for example), you have to use <code>TRUE</code>.  On an existing sheet
with data, use <code>TRUE</code> if you want to blank out an existing cell block.
Use <code>FALSE</code> if you want to keep the styling of existing cells, but just
modify the value of the cell.</p>
</td></tr>
<tr><td><code id="CellBlock_+3A_cellblock">cellBlock</code></td>
<td>
<p>a cell block object as returned by <code><a href="#topic+CellBlock">CellBlock</a></code>.</p>
</td></tr>
<tr><td><code id="CellBlock_+3A_x">x</code></td>
<td>
<p>the data you want to add to the cell block, a vector or a matrix
depending on the function.</p>
</td></tr>
<tr><td><code id="CellBlock_+3A_colindex">colIndex</code></td>
<td>
<p>a numeric vector specifiying the columns you want relative
to the <code>startColumn</code>.</p>
</td></tr>
<tr><td><code id="CellBlock_+3A_rowoffset">rowOffset</code></td>
<td>
<p>a numeric value for the starting row.</p>
</td></tr>
<tr><td><code id="CellBlock_+3A_showna">showNA</code></td>
<td>
<p>a logical value.  If set to <code>FALSE</code>, NA values will be
left as empty cells.</p>
</td></tr>
<tr><td><code id="CellBlock_+3A_colstyle">colStyle</code></td>
<td>
<p>a <code><a href="#topic+CellStyle">CellStyle</a></code> object used to style the column.</p>
</td></tr>
<tr><td><code id="CellBlock_+3A_rowindex">rowIndex</code></td>
<td>
<p>a numeric vector specifiying the rows you want relative to
the <code>startRow</code>.</p>
</td></tr>
<tr><td><code id="CellBlock_+3A_coloffset">colOffset</code></td>
<td>
<p>a numeric value for the starting column.</p>
</td></tr>
<tr><td><code id="CellBlock_+3A_rowstyle">rowStyle</code></td>
<td>
<p>a <code><a href="#topic+CellStyle">CellStyle</a></code> object used to style the row.</p>
</td></tr>
<tr><td><code id="CellBlock_+3A_cellstyle">cellStyle</code></td>
<td>
<p>a <code><a href="#topic+CellStyle">CellStyle</a></code> object.</p>
</td></tr>
<tr><td><code id="CellBlock_+3A_fill">fill</code></td>
<td>
<p>a Fill object, as returned by <code><a href="#topic+Fill">Fill</a></code>.</p>
</td></tr>
<tr><td><code id="CellBlock_+3A_font">font</code></td>
<td>
<p>a Font object, as returned by <code><a href="#topic+Font">Font</a></code>.</p>
</td></tr>
<tr><td><code id="CellBlock_+3A_border">border</code></td>
<td>
<p>a Border object, as returned by <code><a href="#topic+Border">Border</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Introduced in version 0.5.0 of the package, these functions speed up the
creation and styling of cells that are part of a &quot;cell block&quot; (a rectangular
shaped group of cells).  Use the functions above if you want to create
efficiently a complex sheet with many styles.  A simple by-column styling
can be done by directly using <code><a href="#topic+addDataFrame">addDataFrame</a></code>.  With the
functionality provided here you can efficiently style individual cells, see
the example.
</p>
<p>It is difficult to treat <code>NA</code>'s consistently between R and Excel via
Java.  Most likely, users of Excel will want to see <code>NA</code>'s as blank
cells.  In R character <code>NA</code>'s are simply characters, which for Excel
means &quot;NA&quot;.
</p>
<p>If you try to set more data to the block than you have cells in the block,
only the existing cells will be set.
</p>
<p>Note that when modifying the style of a group of cells, the changes are made
to the pairs defined by <code>(rowIndex, colIndex)</code>.  This implies that the
length of <code>rowIndex</code> and <code>colIndex</code> are the same value.  An
exception is made when either <code>rowIndex</code> or <code>colIndex</code> have length
one, when they will be expanded internally to match the length of the other
index.
</p>
<p>Function <code>CB.setMatrixData</code> works for numeric or character matrices.
If the matrix <code>x</code> is not of numeric type it will be converted to a
character matrix.
</p>


<h3>Value</h3>

<p>For <code>CellBlock</code> a cell block object.
</p>
<p>For <code>CB.setColData</code>, <code>CB.setRowData</code>, <code>CB.setMatrixData</code>,
<code>CB.setFill</code>, <code>CB.setFont</code>, <code>CB.setBorder</code> nothing as he
modification to the workbook is done in place.
</p>


<h3>Author(s)</h3>

<p>Adrian Dragulescu
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

  wb &lt;- createWorkbook()
  sheet  &lt;- createSheet(wb, sheetName="CellBlock")

  cb &lt;- CellBlock(sheet, 7, 3, 1000, 60)
  CB.setColData(cb, 1:100, 1)    # set a column
  CB.setRowData(cb, 1:50, 1)     # set a row

  # add a matrix, and style it
  cs &lt;- CellStyle(wb) + DataFormat("#,##0.00")
  x  &lt;- matrix(rnorm(900*45), nrow=900)
  CB.setMatrixData(cb, x, 10, 4, cellStyle=cs)

  # highlight the negative numbers in red
  fill &lt;- Fill(foregroundColor = "red", backgroundColor="red")
  ind  &lt;- which(x &lt; 0, arr.ind=TRUE)
  CB.setFill(cb, fill, ind[,1]+9, ind[,2]+3)  # note the indices offset

  # set the border on the top row of the Cell Block
  border &lt;-  Border(color="blue", position=c("TOP", "BOTTOM"),
    pen=c("BORDER_THIN", "BORDER_THICK"))
  CB.setBorder(cb, border, 1, 1:1000)


  # Don't forget to save the workbook ...
  # saveWorkbook(wb, file)


</code></pre>

<hr>
<h2 id='CellStyle'>Functions to manipulate cells.</h2><span id='topic+CellStyle'></span><span id='topic+is.CellStyle'></span><span id='topic+CellStyle.default'></span><span id='topic+setCellStyle'></span><span id='topic+getCellStyle'></span>

<h3>Description</h3>

<p>Create and set cell styles.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CellStyle(
  wb,
  dataFormat = NULL,
  alignment = NULL,
  border = NULL,
  fill = NULL,
  font = NULL,
  cellProtection = NULL
)

is.CellStyle(x)

## Default S3 method:
CellStyle(
  wb,
  dataFormat = NULL,
  alignment = NULL,
  border = NULL,
  fill = NULL,
  font = NULL,
  cellProtection = NULL
)

setCellStyle(cell, cellStyle)

getCellStyle(cell)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CellStyle_+3A_wb">wb</code></td>
<td>
<p>a workbook object as returned by <code><a href="#topic+createWorkbook">createWorkbook</a></code> or
<code><a href="#topic+loadWorkbook">loadWorkbook</a></code>.</p>
</td></tr>
<tr><td><code id="CellStyle_+3A_dataformat">dataFormat</code></td>
<td>
<p>a <code><a href="#topic+DataFormat">DataFormat</a></code> object.</p>
</td></tr>
<tr><td><code id="CellStyle_+3A_alignment">alignment</code></td>
<td>
<p>a <code><a href="#topic+Alignment">Alignment</a></code> object.</p>
</td></tr>
<tr><td><code id="CellStyle_+3A_border">border</code></td>
<td>
<p>a <code><a href="#topic+Border">Border</a></code> object.</p>
</td></tr>
<tr><td><code id="CellStyle_+3A_fill">fill</code></td>
<td>
<p>a <code><a href="#topic+Fill">Fill</a></code> object.</p>
</td></tr>
<tr><td><code id="CellStyle_+3A_font">font</code></td>
<td>
<p>a <code><a href="#topic+Font">Font</a></code> object.</p>
</td></tr>
<tr><td><code id="CellStyle_+3A_cellprotection">cellProtection</code></td>
<td>
<p>a <code><a href="#topic+CellProtection">CellProtection</a></code> object.</p>
</td></tr>
<tr><td><code id="CellStyle_+3A_x">x</code></td>
<td>
<p>a <code>CellStyle</code> object.</p>
</td></tr>
<tr><td><code id="CellStyle_+3A_cell">cell</code></td>
<td>
<p>a <code><a href="#topic+Cell">Cell</a></code> object.</p>
</td></tr>
<tr><td><code id="CellStyle_+3A_cellstyle">cellStyle</code></td>
<td>
<p>a <code>CellStyle</code> object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>setCellStyle</code> sets the <code>CellStyle</code> to one <code>Cell</code> object.
</p>
<p>You need to have a <code>Workbook</code> object to attach a <code>CellStyle</code>
object to it.
</p>
<p>Since OS X 10.5 Apple dropped support for AWT on the main thread, so
essentially you cannot use any graphics classes in R on OS X 10.5 since R is
single-threaded. (verbatim from Simon Urbanek).  This implies that setting
colors on Mac will not work as is!  A set of about 50 basic colors are still
available please see the javadocs.
</p>
<p>For Excel 95/2000/XP/2003 the choice of colors is limited.  See
<code>INDEXED_COLORS_</code> for the list of available colors.
</p>
<p>Unspecified values for arguments are taken from the system locale.
</p>


<h3>Value</h3>

<p><code>createCellStyle</code> creates a CellStyle object.
</p>
<p><code>is.CellStyle</code> returns <code>TRUE</code> if the argument is of class
&quot;CellStyle&quot; and <code>FALSE</code> otherwise.
</p>


<h3>Author(s)</h3>

<p>Adrian Dragulescu
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
  wb &lt;- createWorkbook()
  sheet &lt;- createSheet(wb, "Sheet1")

  rows  &lt;- createRow(sheet, rowIndex=1)

  cell.1 &lt;- createCell(rows, colIndex=1)[[1,1]]
  setCellValue(cell.1, "Hello R!")

  cs &lt;- CellStyle(wb) +
    Font(wb, heightInPoints=20, isBold=TRUE, isItalic=TRUE,
      name="Courier New", color="orange") +
    Fill(backgroundColor="lavender", foregroundColor="lavender",
      pattern="SOLID_FOREGROUND") +
    Alignment(h="ALIGN_RIGHT")

  setCellStyle(cell.1, cellStyle1)

  # you need to save the workbook now if you want to see this art

## End(Not run)
</code></pre>

<hr>
<h2 id='CellStyle-plus'>CellStyle construction.</h2><span id='topic+CellStyle-plus'></span><span id='topic++2B.CellStyle'></span>

<h3>Description</h3>

<p>Create cell styles.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'CellStyle'
cs1 + object
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CellStyle-plus_+3A_cs1">cs1</code></td>
<td>
<p>a <code><a href="#topic+CellStyle">CellStyle</a></code> object.</p>
</td></tr>
<tr><td><code id="CellStyle-plus_+3A_object">object</code></td>
<td>
<p>an object to add.  The object can be another
<code><a href="#topic+CellStyle">CellStyle</a></code>, a <code><a href="#topic+DataFormat">DataFormat</a></code>, a
<code><a href="#topic+Alignment">Alignment</a></code>, a <code><a href="#topic+Border">Border</a></code>, a <code><a href="#topic+Fill">Fill</a></code>, a
<code><a href="#topic+Font">Font</a></code>, or a <code><a href="#topic+CellProtection">CellProtection</a></code> object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The style of the argument object takes precedence over the style of argument
cs1.
</p>


<h3>Value</h3>

<p>A CellStyle object.
</p>


<h3>Author(s)</h3>

<p>Adrian Dragulescu
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
  cs &lt;- CellStyle(wb) +
    Font(wb, heightInPoints=20, isBold=TRUE, isItalic=TRUE,
      name="Courier New", color="orange") +
    Fill(backgroundColor="lavender", foregroundColor="lavender",
      pattern="SOLID_FOREGROUND") +
    Alignment(h="ALIGN_RIGHT")

  setCellStyle(cell.1, cellStyle1)

  # you need to save the workbook now if you want to see this art

## End(Not run)

</code></pre>

<hr>
<h2 id='Comment'>Functions to manipulate cell comments.</h2><span id='topic+Comment'></span><span id='topic+createCellComment'></span><span id='topic+removeCellComment'></span><span id='topic+getCellComment'></span>

<h3>Description</h3>

<p>These functions are not vectorized.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>createCellComment(cell, string, author = NULL, visible = TRUE)

removeCellComment(cell)

getCellComment(cell)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Comment_+3A_cell">cell</code></td>
<td>
<p>a <code>Cell</code> object.</p>
</td></tr>
<tr><td><code id="Comment_+3A_string">string</code></td>
<td>
<p>a string for the comment.</p>
</td></tr>
<tr><td><code id="Comment_+3A_author">author</code></td>
<td>
<p>a string with the author's name</p>
</td></tr>
<tr><td><code id="Comment_+3A_visible">visible</code></td>
<td>
<p>a logical value.  If <code>TRUE</code> the comment will be visible.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>createCellComment</code> creates a <code>Comment</code> object.
</p>
<p><code>getCellComment</code> returns a the <code>Comment</code> object if it exists.
</p>
<p><code>removeCellComment</code> removes a comment from the given cell.
</p>


<h3>Author(s)</h3>

<p>Adrian Dragulescu
</p>


<h3>See Also</h3>

<p>For cells, see <code><a href="#topic+Cell">Cell</a></code>.  To format cells, see
<code><a href="#topic+CellStyle">CellStyle</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

  wb &lt;- createWorkbook()
  sheet1 &lt;- createSheet(wb, "Sheet1")
  rows   &lt;- createRow(sheet1, rowIndex=1:10)     # 10 rows
  cells  &lt;- createCell(rows, colIndex=1:8)       # 8 columns

  cell1 &lt;- cells[[1,1]]
  setCellValue(cell1, 1)   # add value 1 to cell A1

  # create a cell comment
  createCellComment(cell1, "Cogito", author="Descartes")


  # extract the comments
  comment &lt;- getCellComment(cell1)
  stopifnot(comment$getAuthor()=="Descartes")
  stopifnot(comment$getString()$toString()=="Cogito")

  # don't forget to save your workbook!

</code></pre>

<hr>
<h2 id='forceFormulaRefresh'>Force Refresh Pivot Tables and Formulae</h2><span id='topic+forceFormulaRefresh'></span><span id='topic+forcePivotTableRefresh'></span>

<h3>Description</h3>

<p>Functions to force formula calculation or refresh of pivot
tables when the Excel file is opened.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>forceFormulaRefresh(file, output = NULL, verbose = FALSE)

forcePivotTableRefresh(file, output = NULL, verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="forceFormulaRefresh_+3A_file">file</code></td>
<td>
<p>the path of the source file where formulae/pivot table needs to be refreshed</p>
</td></tr>
<tr><td><code id="forceFormulaRefresh_+3A_output">output</code></td>
<td>
<p>the path of the output file.  If it is <code>NULL</code> then the source file will be overwritten</p>
</td></tr>
<tr><td><code id="forceFormulaRefresh_+3A_verbose">verbose</code></td>
<td>
<p>Whether to make logging more verbose</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>forcePivotTableRefresh</code> forces pivot tables to be refreshed when the Excel file is opened.
<code>forceFormulaRefresh</code> forces formulae to be recalculated when the Excel file is opened.
</p>


<h3>Value</h3>

<p>Does not return any results
</p>


<h3>Author(s)</h3>

<p>Tom Kwong
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Patch a file where its pivot tables are not recalculated when the file is opened
## Not run: 
forcePivotTableRefresh("/tmp/file.xlsx")
forcePivotTableRefresh("/tmp/file.xlsx", "/tmp/fixed_file.xlsx")

## End(Not run)
# Patch a file where its formulae are not recalculated when the file is opened
## Not run: 
forceFormulaRefresh("/tmp/file.xlsx")
forceFormulaRefresh("/tmp/file.xlsx", "/tmp/fixed_file.xlsx")

## End(Not run)


</code></pre>

<hr>
<h2 id='is.Alignment'>Create an Alignment object.</h2><span id='topic+is.Alignment'></span><span id='topic+Alignment'></span>

<h3>Description</h3>

<p>Create an Alignment object, useful when working with cell styles.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.Alignment(x)

Alignment(
  horizontal = NULL,
  vertical = NULL,
  wrapText = FALSE,
  rotation = 0,
  indent = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is.Alignment_+3A_x">x</code></td>
<td>
<p>An Alignment object, as returned by <code>Alignment</code>.</p>
</td></tr>
<tr><td><code id="is.Alignment_+3A_horizontal">horizontal</code></td>
<td>
<p>a character value specifying the horizontal alignment.
Valid values come from constant <code>HALIGN_STYLES_</code>.</p>
</td></tr>
<tr><td><code id="is.Alignment_+3A_vertical">vertical</code></td>
<td>
<p>a character value specifying the vertical alignment.  Valid
values come from constant <code>VALIGN_STYLES_</code>.</p>
</td></tr>
<tr><td><code id="is.Alignment_+3A_wraptext">wrapText</code></td>
<td>
<p>a logical indicating if the text should be wrapped.</p>
</td></tr>
<tr><td><code id="is.Alignment_+3A_rotation">rotation</code></td>
<td>
<p>a numerical value indicating the degrees you want to rotate
the text in the cell.</p>
</td></tr>
<tr><td><code id="is.Alignment_+3A_indent">indent</code></td>
<td>
<p>a numerical value indicating the number of spaces you want to
indent the text in the cell.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>Alignment</code> returns a list with components from the input
argument, and a class attribute &quot;Alignment&quot;.  Alignment objects are used
when constructing cell styles.
</p>
<p><code>is.Alignment</code> returns <code>TRUE</code> if the argument is of class
&quot;Alignment&quot; and <code>FALSE</code> otherwise.
</p>


<h3>Author(s)</h3>

<p>Adrian Dragulescu
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CellStyle">CellStyle</a></code> for using the a <code>Alignment</code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

  # you can just use h for horizontal, since R does the matching for you
  a1 &lt;-  Alignment(h="ALIGN_CENTER", rotation=90) # centered and rotated!

</code></pre>

<hr>
<h2 id='is.Border'>Create an Border object.</h2><span id='topic+is.Border'></span><span id='topic+Border'></span>

<h3>Description</h3>

<p>Create an Border object, useful when working with cell styles.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.Border(x)

Border(color = "black", position = "BOTTOM", pen = "BORDER_THIN")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is.Border_+3A_x">x</code></td>
<td>
<p>An Border object, as returned by <code>Border</code>.</p>
</td></tr>
<tr><td><code id="is.Border_+3A_color">color</code></td>
<td>
<p>a character vector specifiying the font color.  Any color names
as returned by <code><a href="grDevices.html#topic+colors">colors</a></code> can be used.  Or, a hex
character, e.g. &quot;#FF0000&quot; for red.  For Excel 95 workbooks, only a subset of
colors is available, see the constant <code>INDEXED_COLORS_</code>.</p>
</td></tr>
<tr><td><code id="is.Border_+3A_position">position</code></td>
<td>
<p>a character vector specifying the border position.  Valid
values are &quot;BOTTOM&quot;, &quot;LEFT&quot;, &quot;TOP&quot;, &quot;RIGHT&quot;.</p>
</td></tr>
<tr><td><code id="is.Border_+3A_pen">pen</code></td>
<td>
<p>a character vector specifying the pen style.  Valid values come
from constant <code>BORDER_STYLES_</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The values for the color, position, or pen arguments are replicated to the
longest of them.
</p>


<h3>Value</h3>

<p><code>Border</code> returns a list with components from the input
argument, and a class attribute &quot;Border&quot;.  Border objects are used when
constructing cell styles.
</p>
<p><code>is.Border</code> returns <code>TRUE</code> if the argument is of class &quot;Border&quot;
and <code>FALSE</code> otherwise.
</p>


<h3>Author(s)</h3>

<p>Adrian Dragulescu
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CellStyle">CellStyle</a></code> for using the a <code>Border</code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

  border &lt;-  Border(color="red", position=c("TOP", "BOTTOM"),
    pen=c("BORDER_THIN", "BORDER_THICK"))

</code></pre>

<hr>
<h2 id='is.CellProtection'>Create a CellProtection object.</h2><span id='topic+is.CellProtection'></span><span id='topic+CellProtection'></span>

<h3>Description</h3>

<p>Create a CellProtection object used for cell styles.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.CellProtection(x)

CellProtection(locked = TRUE, hidden = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is.CellProtection_+3A_x">x</code></td>
<td>
<p>A CellProtection object, as returned by <code>CellProtection</code>.</p>
</td></tr>
<tr><td><code id="is.CellProtection_+3A_locked">locked</code></td>
<td>
<p>a logical indicating the cell is locked.</p>
</td></tr>
<tr><td><code id="is.CellProtection_+3A_hidden">hidden</code></td>
<td>
<p>a logical indicating the cell is hidden.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>CellProtection</code> returns a list with components from the input
argument, and a class attribute &quot;CellProtection&quot;.  CellProtection objects
are used when constructing cell styles.
</p>
<p><code>is.CellProtection</code> returns <code>TRUE</code> if the argument is of class
&quot;CellProtection&quot; and <code>FALSE</code> otherwise.
</p>


<h3>Author(s)</h3>

<p>Adrian Dragulescu
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CellStyle">CellStyle</a></code> for using the a <code>CellProtection</code>
object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

  font &lt;-  CellProtection(locked=TRUE)

</code></pre>

<hr>
<h2 id='is.DataFormat'>Create an DataFormat object.</h2><span id='topic+is.DataFormat'></span><span id='topic+DataFormat'></span>

<h3>Description</h3>

<p>Create an DataFormat object, useful when working with cell styles.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.DataFormat(df)

DataFormat(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is.DataFormat_+3A_df">df</code></td>
<td>
<p>An DataFormat object, as returned by <code>DataFormat</code>.</p>
</td></tr>
<tr><td><code id="is.DataFormat_+3A_x">x</code></td>
<td>
<p>a character value specifying the data format.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Specifying the <code>dataFormat</code> argument allows you to format the cell.
For example, &quot;#,##0.00&quot; corresponds to using a comma separator for powers of
1000 with two decimal places, &quot;m/d/yyyy&quot; can be used to format dates and is
the equivalent of 's MM/DD/YYYY format.  To format datetimes use &quot;m/d/yyyy
h:mm:ss;@&quot;.  To show negative values in red within parantheses with two
decimals and commas after power of 1000 use &quot;#,##0.00_);[Red](#,##0.00)&quot;.  I
am not aware of an official way to discover these strings.  I find them out
by recording a macro that formats a specific cell and then checking out the
resulting VBA code.  From there you can read the <code>dataFormat</code> code.
</p>


<h3>Value</h3>

<p><code>DataFormat</code> returns a list one component dataFormat, and a
class attribute &quot;DataFormat&quot;.  DataFormat objects are used when constructing
cell styles.
</p>
<p><code>is.DataFormat</code> returns <code>TRUE</code> if the argument is of class
&quot;DataFormat&quot; and <code>FALSE</code> otherwise.
</p>


<h3>Author(s)</h3>

<p>Adrian Dragulescu
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CellStyle">CellStyle</a></code> for using the a <code>DataFormat</code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  df &lt;-  DataFormat("#,##0.00")

</code></pre>

<hr>
<h2 id='is.Fill'>Create an Fill object.</h2><span id='topic+is.Fill'></span><span id='topic+Fill'></span>

<h3>Description</h3>

<p>Create an Fill object, useful when working with cell styles.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.Fill(x)

Fill(
  foregroundColor = "lightblue",
  backgroundColor = "lightblue",
  pattern = "SOLID_FOREGROUND"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is.Fill_+3A_x">x</code></td>
<td>
<p>a Fill object, as returned by <code>Fill</code>.</p>
</td></tr>
<tr><td><code id="is.Fill_+3A_foregroundcolor">foregroundColor</code></td>
<td>
<p>a character vector specifiying the foreground color.
Any color names as returned by <code><a href="grDevices.html#topic+colors">colors</a></code> can be used.
Or, a hex character, e.g. &quot;#FF0000&quot; for red.  For Excel 95 workbooks, only a
subset of colors is available, see the constant <code>INDEXED_COLORS_</code>.</p>
</td></tr>
<tr><td><code id="is.Fill_+3A_backgroundcolor">backgroundColor</code></td>
<td>
<p>a character vector specifiying the foreground color.
Any color names as returned by <code><a href="grDevices.html#topic+colors">colors</a></code> can be used.
Or, a hex character, e.g. &quot;#FF0000&quot; for red.  For Excel 95 workbooks, only a
subset of colors is available, see the constant <code>INDEXED_COLORS_</code>.</p>
</td></tr>
<tr><td><code id="is.Fill_+3A_pattern">pattern</code></td>
<td>
<p>a character vector specifying the fill pattern style.  Valid
values come from constant <code>FILL_STYLES_</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>Fill</code> returns a list with components from the input argument,
and a class attribute &quot;Fill&quot;.  Fill objects are used when constructing cell
styles.
</p>
<p><code>is.Fill</code> returns <code>TRUE</code> if the argument is of class &quot;Fill&quot; and
<code>FALSE</code> otherwise.
</p>


<h3>Author(s)</h3>

<p>Adrian Dragulescu
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CellStyle">CellStyle</a></code> for using the a <code>Fill</code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  fill &lt;-  Fill()

</code></pre>

<hr>
<h2 id='is.Font'>Create a Font object.</h2><span id='topic+is.Font'></span><span id='topic+Font'></span>

<h3>Description</h3>

<p>Create a Font object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.Font(x)

Font(
  wb,
  color = NULL,
  heightInPoints = NULL,
  name = NULL,
  isItalic = FALSE,
  isStrikeout = FALSE,
  isBold = FALSE,
  underline = NULL,
  boldweight = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is.Font_+3A_x">x</code></td>
<td>
<p>A Font object, as returned by <code>Font</code>.</p>
</td></tr>
<tr><td><code id="is.Font_+3A_wb">wb</code></td>
<td>
<p>a workbook object as returned by <code><a href="#topic+createWorkbook">createWorkbook</a></code> or
<code><a href="#topic+loadWorkbook">loadWorkbook</a></code>.</p>
</td></tr>
<tr><td><code id="is.Font_+3A_color">color</code></td>
<td>
<p>a character specifiying the font color.  Any color names as
returned by <code><a href="grDevices.html#topic+colors">colors</a></code> can be used.  Or, a hex
character, e.g. &quot;#FF0000&quot; for red.  For Excel 95 workbooks, only a subset of
colors is available, see the constant <code>INDEXED_COLORS_</code>.</p>
</td></tr>
<tr><td><code id="is.Font_+3A_heightinpoints">heightInPoints</code></td>
<td>
<p>a numeric value specifying the font height.  Usual
values are 10, 12, 14, etc.</p>
</td></tr>
<tr><td><code id="is.Font_+3A_name">name</code></td>
<td>
<p>a character value for the font to use.  All values that you see
in Excel should be available, e.g. &quot;Courier New&quot;.</p>
</td></tr>
<tr><td><code id="is.Font_+3A_isitalic">isItalic</code></td>
<td>
<p>a logical indicating the font should be italic.</p>
</td></tr>
<tr><td><code id="is.Font_+3A_isstrikeout">isStrikeout</code></td>
<td>
<p>a logical indicating the font should be stiked out.</p>
</td></tr>
<tr><td><code id="is.Font_+3A_isbold">isBold</code></td>
<td>
<p>a logical indicating the font should be bold.</p>
</td></tr>
<tr><td><code id="is.Font_+3A_underline">underline</code></td>
<td>
<p>a numeric value specifying the thickness of the underline.
Allowed values are 0, 1, 2.</p>
</td></tr>
<tr><td><code id="is.Font_+3A_boldweight">boldweight</code></td>
<td>
<p>a numeric value indicating bold weight.  Normal is 400,
regular bold is 700.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Default values for <code>NULL</code> parameters are taken from Excel.  So the
default font color is black, the default font name is &quot;Calibri&quot;, and the
font height in points is 11.
</p>
<p>For Excel 95/2000/XP/2003, it is impossible to set the font to bold.  This
limitation may be removed in the future.
</p>
<p>NOTE: You need to have a <code>Workbook</code> object to attach a <code>Font</code>
object to it.
</p>


<h3>Value</h3>

<p><code>Font</code> returns a list with a java reference to a <code>Font</code>
object, and a class attribute &quot;Font&quot;.
</p>
<p><code>is.Font</code> returns <code>TRUE</code> if the argument is of class &quot;Font&quot; and
<code>FALSE</code> otherwise.
</p>


<h3>Author(s)</h3>

<p>Adrian Dragulescu
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CellStyle">CellStyle</a></code> for using the a <code>Font</code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
  font &lt;-  Font(wb, color="blue", isItalic=TRUE)

## End(Not run)

</code></pre>

<hr>
<h2 id='NamedRanges'>Functions to manipulate (contiguous) named ranges.</h2><span id='topic+NamedRanges'></span><span id='topic+createRange'></span><span id='topic+getRanges'></span><span id='topic+readRange'></span>

<h3>Description</h3>

<p>These functions are provided for convenience only.  Use directly the Java
API to access additional functionality.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>createRange(rangeName, firstCell, lastCell)

getRanges(wb)

readRange(range, sheet, colClasses = "character")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="NamedRanges_+3A_rangename">rangeName</code></td>
<td>
<p>a character specifying the name of the name to create.</p>
</td></tr>
<tr><td><code id="NamedRanges_+3A_firstcell">firstCell</code></td>
<td>
<p>a cell object corresponding to the top left cell in the
range.</p>
</td></tr>
<tr><td><code id="NamedRanges_+3A_lastcell">lastCell</code></td>
<td>
<p>a cell object corresponding to the bottom right cell in the
range.</p>
</td></tr>
<tr><td><code id="NamedRanges_+3A_wb">wb</code></td>
<td>
<p>a workbook object as returned by <code>createWorksheet</code> or
<code>loadWorksheet</code>.</p>
</td></tr>
<tr><td><code id="NamedRanges_+3A_range">range</code></td>
<td>
<p>a range object as returned by <code>getRanges</code>.</p>
</td></tr>
<tr><td><code id="NamedRanges_+3A_sheet">sheet</code></td>
<td>
<p>a sheet object as returned by <code>getSheets</code>.</p>
</td></tr>
<tr><td><code id="NamedRanges_+3A_colclasses">colClasses</code></td>
<td>
<p>the type of the columns supported.  Only <code>numeric</code>
and <code>character</code> are supported.  See <code><a href="#topic+read.xlsx2">read.xlsx2</a></code> for more
details.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>getRanges</code> returns the existing ranges as a list.
</p>
<p><code>readRange</code> reads the range into a data.frame.
</p>
<p><code>createRange</code> returns the created range object.
</p>


<h3>Author(s)</h3>

<p>Adrian Dragulescu
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

file &lt;- system.file("tests", "test_import.xlsx", package = "xlsx")

wb &lt;- loadWorkbook(file)
sheet &lt;- getSheets(wb)[["deletedFields"]]
ranges &lt;- getRanges(wb)

# the call below fails on cran tests for MacOS.  You should see the
# FAQ: https://code.google.com/p/rexcel/wiki/FAQ
#res  &lt;- readRange(ranges[[1]], sheet, colClasses="numeric") # read it

ranges[[1]]$getNameName()  # get its name

# see all the available java methods that you can call
rJava::.jmethods(ranges[[1]])

# create a new named range
firstCell &lt;- sheet$getRow(14L)$getCell(4L)
lastCell  &lt;- sheet$getRow(20L)$getCell(7L)
rangeName &lt;- "Test2"
# same issue on MacOS
#createRange(rangeName, firstCell, lastCell)


</code></pre>

<hr>
<h2 id='OtherEffects'>Functions to do various spreadsheets effects.</h2><span id='topic+OtherEffects'></span><span id='topic+addAutoFilter'></span><span id='topic+addMergedRegion'></span><span id='topic+removeMergedRegion'></span><span id='topic+autoSizeColumn'></span><span id='topic+createFreezePane'></span><span id='topic+createSplitPane'></span><span id='topic+setColumnWidth'></span><span id='topic+setPrintArea'></span><span id='topic+setZoom'></span>

<h3>Description</h3>

<p>Function <code>autoSizeColumn</code> expands the column width to match the column
contents thus removing the ###### that you get when cell contents are larger
than cell width.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>addAutoFilter(sheet, cellRange)

addMergedRegion(sheet, startRow, endRow, startColumn, endColumn)

removeMergedRegion(sheet, ind)

autoSizeColumn(sheet, colIndex)

createFreezePane(
  sheet,
  rowSplit,
  colSplit,
  startRow = NULL,
  startColumn = NULL
)

createSplitPane(
  sheet,
  xSplitPos = 2000,
  ySplitPos = 2000,
  startRow = 1,
  startColumn = 1,
  position = "PANE_LOWER_LEFT"
)

setColumnWidth(sheet, colIndex, colWidth)

setPrintArea(wb, sheetIndex, startColumn, endColumn, startRow, endRow)

setZoom(sheet, numerator = 100, denominator = 100)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="OtherEffects_+3A_sheet">sheet</code></td>
<td>
<p>a <code><a href="#topic+Worksheet">Worksheet</a></code> object.</p>
</td></tr>
<tr><td><code id="OtherEffects_+3A_cellrange">cellRange</code></td>
<td>
<p>a string specifying the cell range.  For example a standard
area ref (e.g. &quot;B1:D8&quot;). May be a single cell ref (e.g. &quot;B5&quot;) in which case
the result is a 1 x 1 cell range. May also be a whole row range (e.g.
&quot;3:5&quot;), or a whole column range (e.g. &quot;C:F&quot;)</p>
</td></tr>
<tr><td><code id="OtherEffects_+3A_startrow">startRow</code></td>
<td>
<p>a numeric value for the starting row.</p>
</td></tr>
<tr><td><code id="OtherEffects_+3A_endrow">endRow</code></td>
<td>
<p>a numeric value for the ending row.</p>
</td></tr>
<tr><td><code id="OtherEffects_+3A_startcolumn">startColumn</code></td>
<td>
<p>a numeric value for the starting column.</p>
</td></tr>
<tr><td><code id="OtherEffects_+3A_endcolumn">endColumn</code></td>
<td>
<p>a numeric value for the ending column.</p>
</td></tr>
<tr><td><code id="OtherEffects_+3A_ind">ind</code></td>
<td>
<p>a numeric value indicating which merged region you want to
remove.</p>
</td></tr>
<tr><td><code id="OtherEffects_+3A_colindex">colIndex</code></td>
<td>
<p>a numeric vector specifiying the columns you want to auto
size.</p>
</td></tr>
<tr><td><code id="OtherEffects_+3A_rowsplit">rowSplit</code></td>
<td>
<p>a numeric value for the row to split.</p>
</td></tr>
<tr><td><code id="OtherEffects_+3A_colsplit">colSplit</code></td>
<td>
<p>a numeric value for the column to split.</p>
</td></tr>
<tr><td><code id="OtherEffects_+3A_xsplitpos">xSplitPos</code></td>
<td>
<p>a numeric value for the horizontal position of split in
1/20 of a point.</p>
</td></tr>
<tr><td><code id="OtherEffects_+3A_ysplitpos">ySplitPos</code></td>
<td>
<p>a numeric value for the vertical position of split in 1/20
of a point.</p>
</td></tr>
<tr><td><code id="OtherEffects_+3A_position">position</code></td>
<td>
<p>a character.  Valid value are &quot;PANE_LOWER_LEFT&quot;,
&quot;PANE_LOWER_RIGHT&quot;, &quot;PANE_UPPER_LEFT&quot;, &quot;PANE_UPPER_RIGHT&quot;.</p>
</td></tr>
<tr><td><code id="OtherEffects_+3A_colwidth">colWidth</code></td>
<td>
<p>a numeric value to specify the width of the column.  The
units are in 1/256ths of a character width.</p>
</td></tr>
<tr><td><code id="OtherEffects_+3A_wb">wb</code></td>
<td>
<p>a <code><a href="#topic+Workbook">Workbook</a></code> object.</p>
</td></tr>
<tr><td><code id="OtherEffects_+3A_sheetindex">sheetIndex</code></td>
<td>
<p>a numeric value for the worksheet index.</p>
</td></tr>
<tr><td><code id="OtherEffects_+3A_numerator">numerator</code></td>
<td>
<p>a numeric value representing the numerator of the zoom
ratio.</p>
</td></tr>
<tr><td><code id="OtherEffects_+3A_denominator">denominator</code></td>
<td>
<p>a numeric value representing the denomiator of the zoom
ratio.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>You may need other functionality that is not exposed.  Take a look at the
java docs and the source code of these functions for how you can implement
it in R.
</p>


<h3>Value</h3>

<p><code>addMergedRegion</code> returns a numeric value to label the merged
region.  You should use this value as the <code>ind</code> if you want to
<code>removeMergedRegion</code>.
</p>


<h3>Author(s)</h3>

<p>Adrian Dragulescu
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

  wb &lt;- createWorkbook()
  sheet1 &lt;- createSheet(wb, "Sheet1")
  rows   &lt;- createRow(sheet1, 1:10)              # 10 rows
  cells  &lt;- createCell(rows, colIndex=1:8)       # 8 columns

  ## Merge cells
  setCellValue(cells[[1,1]], "A title that spans 3 columns")
  addMergedRegion(sheet1, 1, 1, 1, 3)

  ## Set zoom 2:1
  setZoom(sheet1, 200, 100)

  sheet2 &lt;- createSheet(wb, "Sheet2")
  rows  &lt;- createRow(sheet2, 1:10)              # 10 rows
  cells &lt;- createCell(rows, colIndex=1:8)       # 8 columns
  #createFreezePane(sheet2, 1, 1, 1, 1)
  createFreezePane(sheet2, 5, 5, 8, 8)

  sheet3 &lt;- createSheet(wb, "Sheet3")
  rows  &lt;- createRow(sheet3, 1:10)              # 10 rows
  cells &lt;- createCell(rows, colIndex=1:8)       # 8 columns
  createSplitPane(sheet3, 2000, 2000, 1, 1, "PANE_LOWER_LEFT")

  # set the column width of first column to 25 characters wide
  setColumnWidth(sheet1, 1, 25)

  # add a filter on the 3rd row, columns C:E
  addAutoFilter(sheet1, "C3:E3")

  # Don't forget to save the workbook ...

</code></pre>

<hr>
<h2 id='Picture'>Functions to manipulate images in a spreadsheet.</h2><span id='topic+Picture'></span><span id='topic+addPicture'></span>

<h3>Description</h3>

<p>For now, the following image types are supported: dib, emf, jpeg, pict, png,
wmf.  Please note, that scaling works correctly only for workbooks with the
default font size (Calibri 11pt for .xlsx). If the default font is changed
the resized image can be streched vertically or horizontally.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>addPicture(file, sheet, scale = 1, startRow = 1, startColumn = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Picture_+3A_file">file</code></td>
<td>
<p>the absolute path to the image file.</p>
</td></tr>
<tr><td><code id="Picture_+3A_sheet">sheet</code></td>
<td>
<p>a worksheet object as returned by <code>createSheet</code> or by
subsetting <code>getSheets</code>.  The picture will be added on this sheet at
position <code>startRow</code>, <code>startColumn</code>.</p>
</td></tr>
<tr><td><code id="Picture_+3A_scale">scale</code></td>
<td>
<p>a numeric specifying the scale factor for the image.</p>
</td></tr>
<tr><td><code id="Picture_+3A_startrow">startRow</code></td>
<td>
<p>a numeric specifying the row of the upper left corner of the
image.</p>
</td></tr>
<tr><td><code id="Picture_+3A_startcolumn">startColumn</code></td>
<td>
<p>a numeric specifying the column of the upper left corner
of the image.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Don't know how to remove an existing image yet.
</p>


<h3>Value</h3>

<p><code>addPicture</code> a java object references pointing to the picture.
</p>


<h3>Author(s)</h3>

<p>Adrian Dragulescu
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

file &lt;- system.file("tests", "log_plot.jpeg", package = "xlsx")

wb &lt;- createWorkbook()
sheet &lt;- createSheet(wb, "Sheet1")

addPicture(file, sheet)

# don't forget to save the workbook!


</code></pre>

<hr>
<h2 id='POI_constants'>Constants used in the project.</h2><span id='topic+POI_constants'></span><span id='topic+HALIGN_STYLES_'></span><span id='topic+VALIGN_STYLES_'></span><span id='topic+BORDER_STYLES_'></span><span id='topic+FILL_STYLES_'></span><span id='topic+CELL_STYLES_'></span><span id='topic+INDEXED_COLORS_'></span>

<h3>Description</h3>

<p>Document some Apache POI constants used in the project.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>HALIGN_STYLES_

VALIGN_STYLES_

BORDER_STYLES_

FILL_STYLES_

CELL_STYLES_

INDEXED_COLORS_
</code></pre>


<h3>Format</h3>

<p>An object of class <code>numeric</code> of length 7.
</p>
<p>An object of class <code>numeric</code> of length 4.
</p>
<p>An object of class <code>numeric</code> of length 14.
</p>
<p>An object of class <code>numeric</code> of length 19.
</p>
<p>An object of class <code>numeric</code> of length 44.
</p>
<p>An object of class <code>numeric</code> of length 48.
</p>


<h3>Value</h3>

<p>A named vector.
</p>


<h3>Author(s)</h3>

<p>Adrian Dragulescu
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CellStyle">CellStyle</a></code> for using the <code>POI_constants</code>.
</p>

<hr>
<h2 id='PrintSetup'>Function to manipulate print setup.</h2><span id='topic+PrintSetup'></span><span id='topic+printSetup'></span>

<h3>Description</h3>

<p>Other settings are available but not exposed.  Please see the java docs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>printSetup(
  sheet,
  fitHeight = NULL,
  fitWidth = NULL,
  copies = NULL,
  draft = NULL,
  footerMargin = NULL,
  headerMargin = NULL,
  landscape = FALSE,
  pageStart = NULL,
  paperSize = NULL,
  noColor = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PrintSetup_+3A_sheet">sheet</code></td>
<td>
<p>a worksheet object <code><a href="#topic+Worksheet">Worksheet</a></code>.</p>
</td></tr>
<tr><td><code id="PrintSetup_+3A_fitheight">fitHeight</code></td>
<td>
<p>numeric value to set the number of pages high to fit the
sheet in.</p>
</td></tr>
<tr><td><code id="PrintSetup_+3A_fitwidth">fitWidth</code></td>
<td>
<p>numeric value to set the number of pages wide to fit the
sheet in.</p>
</td></tr>
<tr><td><code id="PrintSetup_+3A_copies">copies</code></td>
<td>
<p>numeric value to set the number of copies.</p>
</td></tr>
<tr><td><code id="PrintSetup_+3A_draft">draft</code></td>
<td>
<p>logical indicating if it's a draft or not.</p>
</td></tr>
<tr><td><code id="PrintSetup_+3A_footermargin">footerMargin</code></td>
<td>
<p>numeric value to set the footer margin.</p>
</td></tr>
<tr><td><code id="PrintSetup_+3A_headermargin">headerMargin</code></td>
<td>
<p>numeric value to set the header margin.</p>
</td></tr>
<tr><td><code id="PrintSetup_+3A_landscape">landscape</code></td>
<td>
<p>logical value to specify the paper orientation.</p>
</td></tr>
<tr><td><code id="PrintSetup_+3A_pagestart">pageStart</code></td>
<td>
<p>numeric value from where to start the page numbering.</p>
</td></tr>
<tr><td><code id="PrintSetup_+3A_papersize">paperSize</code></td>
<td>
<p>character to set the paper size.  Valid values are
&quot;A4_PAPERSIZE&quot;, &quot;A5_PAPERSIZE&quot;, &quot;ENVELOPE_10_PAPERSIZE&quot;,
&quot;ENVELOPE_CS_PAPERSIZE&quot;, &quot;ENVELOPE_DL_PAPERSIZE&quot;,
&quot;ENVELOPE_MONARCH_PAPERSIZE&quot;, &quot;EXECUTIVE_PAPERSIZE&quot;, &quot;LEGAL_PAPERSIZE&quot;,
&quot;LETTER_PAPERSIZE&quot;.</p>
</td></tr>
<tr><td><code id="PrintSetup_+3A_nocolor">noColor</code></td>
<td>
<p>logical value to indicate if the prints should be color or
not.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A reference to a java PrintSetup object.
</p>


<h3>Author(s)</h3>

<p>Adrian Dragulescu
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

wb &lt;- createWorkbook()
sheet &lt;- createSheet(wb, "Sheet1")
ps   &lt;- printSetup(sheet, landscape=TRUE, copies=3)


</code></pre>

<hr>
<h2 id='read.xlsx'>Read the contents of a worksheet into an R <code>data.frame</code>.</h2><span id='topic+read.xlsx'></span><span id='topic+read.xlsx2'></span>

<h3>Description</h3>

<p>The <code>read.xlsx</code> function provides a high level API for reading data
from an Excel worksheet.  It calls several low level functions in the
process.  Its goal is to provide the conveniency of
<code><a href="utils.html#topic+read.table">read.table</a></code> by borrowing from its signature.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read.xlsx(
  file,
  sheetIndex,
  sheetName = NULL,
  rowIndex = NULL,
  startRow = NULL,
  endRow = NULL,
  colIndex = NULL,
  as.data.frame = TRUE,
  header = TRUE,
  colClasses = NA,
  keepFormulas = FALSE,
  encoding = "unknown",
  password = NULL,
  ...
)

read.xlsx2(
  file,
  sheetIndex,
  sheetName = NULL,
  startRow = 1,
  colIndex = NULL,
  endRow = NULL,
  as.data.frame = TRUE,
  header = TRUE,
  colClasses = "character",
  password = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read.xlsx_+3A_file">file</code></td>
<td>
<p>the path to the file to read.</p>
</td></tr>
<tr><td><code id="read.xlsx_+3A_sheetindex">sheetIndex</code></td>
<td>
<p>a number representing the sheet index in the workbook.</p>
</td></tr>
<tr><td><code id="read.xlsx_+3A_sheetname">sheetName</code></td>
<td>
<p>a character string with the sheet name.</p>
</td></tr>
<tr><td><code id="read.xlsx_+3A_rowindex">rowIndex</code></td>
<td>
<p>a numeric vector indicating the rows you want to extract.
If <code>NULL</code>, all rows found will be extracted, unless <code>startRow</code> or
<code>endRow</code> are specified.</p>
</td></tr>
<tr><td><code id="read.xlsx_+3A_startrow">startRow</code></td>
<td>
<p>a number specifying the index of starting row.  For
<code>read.xlsx</code> this argument is active only if <code>rowIndex</code> is
<code>NULL</code>.</p>
</td></tr>
<tr><td><code id="read.xlsx_+3A_endrow">endRow</code></td>
<td>
<p>a number specifying the index of the last row to pull.  If
<code>NULL</code>, read all the rows in the sheet.  For <code>read.xlsx</code> this
argument is active only if <code>rowIndex</code> is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="read.xlsx_+3A_colindex">colIndex</code></td>
<td>
<p>a numeric vector indicating the cols you want to extract.
If <code>NULL</code>, all columns found will be extracted.</p>
</td></tr>
<tr><td><code id="read.xlsx_+3A_as.data.frame">as.data.frame</code></td>
<td>
<p>a logical value indicating if the result should be
coerced into a <code>data.frame</code>.  If <code>FALSE</code>, the result is a list
with one element for each column.</p>
</td></tr>
<tr><td><code id="read.xlsx_+3A_header">header</code></td>
<td>
<p>a logical value indicating whether the first row corresponding
to the first element of the <code>rowIndex</code> vector contains the names of the
variables.</p>
</td></tr>
<tr><td><code id="read.xlsx_+3A_colclasses">colClasses</code></td>
<td>
<p>For <code>read.xlsx</code> a character vector that represent the
class of each column.  Recycled as necessary, or if the character vector is
named, unspecified values are taken to be <code>NA</code>.  For <code>read.xlsx2</code>
see <code><a href="#topic+readColumns">readColumns</a></code>.</p>
</td></tr>
<tr><td><code id="read.xlsx_+3A_keepformulas">keepFormulas</code></td>
<td>
<p>a logical value indicating if Excel formulas should be
shown as text in and not evaluated before bringing them in.</p>
</td></tr>
<tr><td><code id="read.xlsx_+3A_encoding">encoding</code></td>
<td>
<p>encoding to be assumed for input strings.  See
<code><a href="utils.html#topic+read.table">read.table</a></code>.</p>
</td></tr>
<tr><td><code id="read.xlsx_+3A_password">password</code></td>
<td>
<p>a String with the password.</p>
</td></tr>
<tr><td><code id="read.xlsx_+3A_...">...</code></td>
<td>
<p>other arguments to <code>data.frame</code>, for example
<code>stringsAsFactors</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function pulls the value of each non empty cell in the worksheet into a
vector of type <code>list</code> by preserving the data type.  If
<code>as.data.frame=TRUE</code>, this vector of lists is then formatted into a
rectangular shape.  Special care is needed for worksheets with ragged data.
</p>
<p>An attempt is made to guess the class type of the variable corresponding to
each column in the worksheet from the type of the first non empty cell in
that column.  If you need to impose a specific class type on a variable, use
the <code>colClasses</code> argument.  It is recommended to specify the column
classes and not rely on <code>R</code> to guess them, unless in very simple cases.
</p>
<p>Excel internally stores dates and datetimes as numeric values, and does not
keep track of time zones and DST.  When a datetime column is brought into ,
it is converted to <code>POSIXct</code> class with a <em>GMT</em> timezone.
Occasional rounding errors may appear and the and Excel string
representation my differ by one second.  For <code>read.xlsx2</code> bring in a
datetime column as a numeric one and then convert to class <code>POSIXct</code> or
<code>Date</code>.  Also rounding the <code>POSIXct</code> column in R usually does the
trick too.
</p>
<p>The <code>read.xlsx2</code> function does more work in Java so it achieves better
performance (an order of magnitude faster on sheets with 100,000 cells or
more).  The result of <code>read.xlsx2</code> will in general be different from
<code>read.xlsx</code>, because internally <code>read.xlsx2</code> uses
<code>readColumns</code> which is tailored for tabular data.
</p>
<p>Reading of password protected workbooks is supported for Excel 2007 OOXML
format only.
</p>


<h3>Value</h3>

<p>A data.frame or a list, depending on the <code>as.data.frame</code>
argument.  If some of the columns are read as NA's it's an indication that
the <code>colClasses</code> argument has not been set properly.
</p>
<p>If the sheet is empty, return <code>NULL</code>.  If the sheet does not exist,
return an error.
</p>


<h3>Author(s)</h3>

<p>Adrian Dragulescu
</p>


<h3>See Also</h3>

<p><code><a href="#topic+write.xlsx">write.xlsx</a></code> for writing <code>xlsx</code> documents.  See
also <code><a href="#topic+readColumns">readColumns</a></code> for reading only a set of columns into R.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 

file &lt;- system.file("tests", "test_import.xlsx", package = "xlsx")
res &lt;- read.xlsx(file, 1)  # read first sheet
head(res)
#          NA. Population Income Illiteracy Life.Exp Murder HS.Grad Frost   Area
# 1    Alabama       3615   3624        2.1    69.05   15.1    41.3    20  50708
# 2     Alaska        365   6315        1.5    69.31   11.3    66.7   152 566432
# 3    Arizona       2212   4530        1.8    70.55    7.8    58.1    15 113417
# 4   Arkansas       2110   3378        1.9    70.66   10.1    39.9    65  51945
# 5 California      21198   5114        1.1    71.71   10.3    62.6    20 156361
# 6   Colorado       2541   4884        0.7    72.06    6.8    63.9   166 103766
# &gt;


# To convert an Excel datetime colum to POSIXct, do something like:
#   as.POSIXct((x-25569)*86400, tz="GMT", origin="1970-01-01")
# For Dates, use a conversion like:
#   as.Date(x-25569, origin="1970-01-01")

res2 &lt;- read.xlsx2(file, 1)


## End(Not run)

</code></pre>

<hr>
<h2 id='readColumns'>Read a contiguous set of columns from sheet into an R data.frame</h2><span id='topic+readColumns'></span>

<h3>Description</h3>

<p>Read a contiguous set of columns from sheet into an R data.frame.  Uses the
<code>RInterface</code> for speed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>readColumns(
  sheet,
  startColumn,
  endColumn,
  startRow,
  endRow = NULL,
  as.data.frame = TRUE,
  header = TRUE,
  colClasses = NA,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="readColumns_+3A_sheet">sheet</code></td>
<td>
<p>a <code><a href="#topic+Worksheet">Worksheet</a></code> object.</p>
</td></tr>
<tr><td><code id="readColumns_+3A_startcolumn">startColumn</code></td>
<td>
<p>a numeric value for the starting column.</p>
</td></tr>
<tr><td><code id="readColumns_+3A_endcolumn">endColumn</code></td>
<td>
<p>a numeric value for the ending column.</p>
</td></tr>
<tr><td><code id="readColumns_+3A_startrow">startRow</code></td>
<td>
<p>a numeric value for the starting row.</p>
</td></tr>
<tr><td><code id="readColumns_+3A_endrow">endRow</code></td>
<td>
<p>a numeric value for the ending row.  If <code>NULL</code> it reads
all the rows in the sheet.  If you request more than the existing rows in
the sheet, the result will be truncated by the actual row number.</p>
</td></tr>
<tr><td><code id="readColumns_+3A_as.data.frame">as.data.frame</code></td>
<td>
<p>a logical value indicating if the result should be
coerced into a <code>data.frame</code>.  If <code>FALSE</code>, the result is a list
with one element for each column.</p>
</td></tr>
<tr><td><code id="readColumns_+3A_header">header</code></td>
<td>
<p>a logical value indicating whether the first row corresponding
to the first element of the <code>rowIndex</code> vector contains the names of the
variables.</p>
</td></tr>
<tr><td><code id="readColumns_+3A_colclasses">colClasses</code></td>
<td>
<p>a character vector that represents the class of each
column.  Recycled as necessary, or if <code>NA</code> an attempt is made to guess
the type of each column by reading the first row of data.  Only
<code>numeric</code>, <code>character</code>, <code>Date</code>, <code>POSIXct</code>, column types
are accepted.  Anything else will be coverted to a <code>character</code> type.
If the length is less than the number of columns requested, replicate it.</p>
</td></tr>
<tr><td><code id="readColumns_+3A_...">...</code></td>
<td>
<p>other arguments to <code>data.frame</code>, for example
<code>stringsAsFactors</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Use the <code>readColumns</code> function when you want to read a rectangular
block of data from an Excel worksheet.  If you request columns which are
blank, these will be read in as empty character &quot;&quot; columns. Internally, the
loop over columns is done in R, the loop over rows is done in Java, so this
function achieves good performance when number of rows &gt;&gt; number of columns.
</p>
<p>Excel internally stores dates and datetimes as numeric values, and does not
keep track of time zones and DST.  When a numeric column is formatted as a
datetime, it will be converted into <code>POSIXct</code> class with a <em>GMT</em>
timezone.  If you need a <code>Date</code> column, you need to specify explicitly
using <code>colClasses</code> argument.
</p>
<p>For a numeric column Excels's errors and blank cells will be returned as NaN
values.  Excel's <code>#N/A</code> will be returned as NA.  Formulas will be
evaluated. For a chracter column, blank cells will be returned as &quot;&quot;.
</p>


<h3>Value</h3>

<p>A data.frame or a list, depending on the <code>as.data.frame</code>
argument.
</p>


<h3>Author(s)</h3>

<p>Adrian Dragulescu
</p>


<h3>See Also</h3>

<p><code><a href="#topic+read.xlsx2">read.xlsx2</a></code> for reading entire sheets.  See also
<code><a href="#topic+addDataFrame">addDataFrame</a></code> for writing a <code>data.frame</code> to a sheet.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 

  file &lt;- system.file("tests", "test_import.xlsx", package = "xlsx")

  wb     &lt;- loadWorkbook(file)
  sheets &lt;- getSheets(wb)

  sheet &lt;- sheets[["all"]]
  res &lt;- readColumns(sheet, startColumn=3, endColumn=10, startRow=3,
    endRow=7)

  sheet &lt;- sheets[["NAs"]]
  res &lt;- readColumns(sheet, 1, 6, 1,  colClasses=c("Date", "character",
    "integer", rep("numeric", 2),  "POSIXct"))



## End(Not run)

</code></pre>

<hr>
<h2 id='readRows'>Read a contiguous set of rows into an R matrix</h2><span id='topic+readRows'></span>

<h3>Description</h3>

<p>Read a contiguous set of rows into an R character matrix.  Uses the
<code>RInterface</code> for speed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>readRows(sheet, startRow, endRow, startColumn, endColumn = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="readRows_+3A_sheet">sheet</code></td>
<td>
<p>a <code><a href="#topic+Worksheet">Worksheet</a></code> object.</p>
</td></tr>
<tr><td><code id="readRows_+3A_startrow">startRow</code></td>
<td>
<p>a numeric value for the starting row.</p>
</td></tr>
<tr><td><code id="readRows_+3A_endrow">endRow</code></td>
<td>
<p>a numeric value for the ending row.  If <code>NULL</code> it reads
all the rows in the sheet.</p>
</td></tr>
<tr><td><code id="readRows_+3A_startcolumn">startColumn</code></td>
<td>
<p>a numeric value for the starting column.</p>
</td></tr>
<tr><td><code id="readRows_+3A_endcolumn">endColumn</code></td>
<td>
<p>a numeric value for the ending column.  Empty cells will be
returned as &quot;&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Use the <code>readRows</code> function when you want to read a row or a block
block of data from an Excel worksheet.  Internally, the loop over rows is
done in R, and the loop over columns is done in Java, so this function
achieves good performance when number of rows &lt;&lt; number of columns.
</p>
<p>In general, you should prefer the function <code><a href="#topic+readColumns">readColumns</a></code> over
this one.
</p>


<h3>Value</h3>

<p>A character matrix.
</p>


<h3>Author(s)</h3>

<p>Adrian Dragulescu
</p>


<h3>See Also</h3>

<p><code><a href="#topic+read.xlsx2">read.xlsx2</a></code> for reading entire sheets.  See also
<code><a href="#topic+addDataFrame">addDataFrame</a></code> for writing a <code>data.frame</code> to a sheet.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 

  file &lt;- system.file("tests", "test_import.xlsx", package = "xlsx")

  wb     &lt;- loadWorkbook(file)
  sheets &lt;- getSheets(wb)

  sheet &lt;- sheets[["all"]]
  res &lt;- readRows(sheet, startRow=3, endRow=7, startColumn=3, endColumn=10)




## End(Not run)

</code></pre>

<hr>
<h2 id='Row'>Functions to manipulate rows of a worksheet.</h2><span id='topic+Row'></span><span id='topic+createRow'></span><span id='topic+getRows'></span><span id='topic+removeRow'></span><span id='topic+setRowHeight'></span>

<h3>Description</h3>

<p><code>removeRow</code> is just a convenience wrapper to remove the rows from the
sheet (before saving).  Internally it calls <code>lapply</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>createRow(sheet, rowIndex = 1:5)

getRows(sheet, rowIndex = NULL)

removeRow(sheet, rows = NULL)

setRowHeight(rows, inPoints, multiplier = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Row_+3A_sheet">sheet</code></td>
<td>
<p>a worksheet object as returned by <code>createSheet</code> or by
subsetting <code>getSheets</code>.</p>
</td></tr>
<tr><td><code id="Row_+3A_rowindex">rowIndex</code></td>
<td>
<p>a numeric vector specifying the index of rows to create.
For <code>getRows</code>, a <code>NULL</code> value will return all non empty rows.</p>
</td></tr>
<tr><td><code id="Row_+3A_rows">rows</code></td>
<td>
<p>a list of <code>Row</code> objects.</p>
</td></tr>
<tr><td><code id="Row_+3A_inpoints">inPoints</code></td>
<td>
<p>a numeric value to specify the height of the row in points.</p>
</td></tr>
<tr><td><code id="Row_+3A_multiplier">multiplier</code></td>
<td>
<p>a numeric value to specify the multiple of default row
height in points.  If this value is set, it takes precedence over the
<code>inPoints</code> argument.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>For <code>getRows</code> a list of java object references each pointing to
a row.  The list is named with the row number.
</p>


<h3>Author(s)</h3>

<p>Adrian Dragulescu
</p>


<h3>See Also</h3>

<p>To extract the cells from a given row, see <code><a href="#topic+Cell">Cell</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

file &lt;- system.file("tests", "test_import.xlsx", package = "xlsx")

wb &lt;- loadWorkbook(file)
sheets &lt;- getSheets(wb)

sheet &lt;- sheets[[2]]
rows  &lt;- getRows(sheet)  # get all the rows

# see all the available java methods that you can call
rJava::.jmethods(rows[[1]])

# for example
rows[[1]]$getRowNum()   # zero based index in Java

removeRow(sheet, rows)  # remove them all

# create some row
rows  &lt;- createRow(sheet, rowIndex=1:5)
setRowHeight( rows, multiplier=3)  # 3 times bigger rows than the default



</code></pre>

<hr>
<h2 id='set_java_tmp_dir'>Set Java Temp Directory</h2><span id='topic+set_java_tmp_dir'></span><span id='topic+get_java_tmp_dir'></span>

<h3>Description</h3>

<p>Java sets the java temp directory to '/tmp' by default. However, this is
usually not desirable in R. As a result, this function allows changing that
behavior. Further, this function is fired on package load to ensure all
temp files are written to the R temp directory.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>set_java_tmp_dir(tmp_dir = tempdir())

get_java_tmp_dir()
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="set_java_tmp_dir_+3A_tmp_dir">tmp_dir</code></td>
<td>
<p>optional. The new temp directory. Defaults to the R temp
directory</p>
</td></tr>
</table>


<h3>Details</h3>

<p>On package load, we use 'getOption(&quot;xlsx.tempdir&quot;, tempdir())' for the
default value, in case you want to have this value set by an option.
</p>


<h3>Value</h3>

<p>The previous java temp directory (prior to any changes).
</p>

<hr>
<h2 id='Sheet'>Functions to manipulate worksheets.</h2><span id='topic+Sheet'></span><span id='topic+Worksheet'></span><span id='topic+getSheets'></span><span id='topic+createSheet'></span><span id='topic+removeSheet'></span>

<h3>Description</h3>

<p>Functions to manipulate worksheets.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getSheets(wb)

createSheet(wb, sheetName = "Sheet1")

removeSheet(wb, sheetName = "Sheet1")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Sheet_+3A_wb">wb</code></td>
<td>
<p>a workbook object as returned by <code>createWorksheet</code> or
<code>loadWorksheet</code>.</p>
</td></tr>
<tr><td><code id="Sheet_+3A_sheetname">sheetName</code></td>
<td>
<p>a character specifying the name of the worksheet to create,
or remove.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>createSheet</code> returns the created <code>Sheet</code> object.
</p>
<p><code>getSheets</code> returns a list of java object references each pointing to
an worksheet.  The list is named with the sheet names.
</p>


<h3>Author(s)</h3>

<p>Adrian Dragulescu
</p>


<h3>See Also</h3>

<p>To extract rows from a given sheet, see <code><a href="#topic+Row">Row</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

file &lt;- system.file("tests", "test_import.xlsx", package = "xlsx")

wb &lt;- loadWorkbook(file)
sheets &lt;- getSheets(wb)

sheet  &lt;- sheets[[2]]  # extract the second sheet

# see all the available java methods that you can call
rJava::.jmethods(sheet)

# for example
sheet$getLastRowNum()

</code></pre>

<hr>
<h2 id='Workbook'>Functions to manipulate Excel 2007 workbooks.</h2><span id='topic+Workbook'></span><span id='topic+createWorkbook'></span><span id='topic+loadWorkbook'></span><span id='topic+saveWorkbook'></span>

<h3>Description</h3>

<p><code>createWorkbook</code> creates an empty workbook object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>createWorkbook(type = "xlsx")

loadWorkbook(file, password = NULL)

saveWorkbook(wb, file, password = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Workbook_+3A_type">type</code></td>
<td>
<p>a String, either <code>xlsx</code> for Excel 2007 OOXML format, or
<code>xls</code> for Excel 95 binary format.</p>
</td></tr>
<tr><td><code id="Workbook_+3A_file">file</code></td>
<td>
<p>the path to the file you intend to read or write.  Can be an xls
or xlsx format.</p>
</td></tr>
<tr><td><code id="Workbook_+3A_password">password</code></td>
<td>
<p>a String with the password.</p>
</td></tr>
<tr><td><code id="Workbook_+3A_wb">wb</code></td>
<td>
<p>a workbook object as returned by <code>createWorkbook</code> or
<code>loadWorkbook</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>loadWorkbook</code> loads a workbook from a file.
</p>
<p><code>saveWorkbook</code> saves an existing workook to an Excel 2007 file.
</p>
<p>Reading or writing of password protected workbooks is supported for Excel
2007 OOXML format only.  Note that in Linux, LibreOffice is not able to read
password protected spreadsheets.
</p>


<h3>Value</h3>

<p><code>createWorkbook</code> returns a java object reference pointing to an
empty workbook object.
</p>
<p><code>loadWorkbook</code> creates a java object reference corresponding to the
file to load.
</p>


<h3>Author(s)</h3>

<p>Adrian Dragulescu
</p>


<h3>See Also</h3>

<p><code><a href="#topic+write.xlsx">write.xlsx</a></code> for writing a <code>data.frame</code> to an
<code>xlsx</code> file.  <code><a href="#topic+read.xlsx">read.xlsx</a></code> for reading the content of a
<code>xlsx</code> worksheet into a <code>data.frame</code>.  To extract worksheets and
manipulate them, see <code><a href="#topic+Worksheet">Worksheet</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

wb &lt;- createWorkbook()

# see all the available java methods that you can call
rJava::.jmethods(wb)

# for example
wb$getNumberOfSheets()   # no sheet yet!

# loadWorkbook("C:/Temp/myFile.xls")

</code></pre>

<hr>
<h2 id='write.xlsx'>Write a data.frame to an Excel workbook.</h2><span id='topic+write.xlsx'></span><span id='topic+write.xlsx2'></span>

<h3>Description</h3>

<p>Write a <code>data.frame</code> to an Excel workbook.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write.xlsx(
  x,
  file,
  sheetName = "Sheet1",
  col.names = TRUE,
  row.names = TRUE,
  append = FALSE,
  showNA = TRUE,
  password = NULL
)

write.xlsx2(
  x,
  file,
  sheetName = "Sheet1",
  col.names = TRUE,
  row.names = TRUE,
  append = FALSE,
  password = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="write.xlsx_+3A_x">x</code></td>
<td>
<p>a <code>data.frame</code> to write to the workbook.</p>
</td></tr>
<tr><td><code id="write.xlsx_+3A_file">file</code></td>
<td>
<p>the path to the output file.</p>
</td></tr>
<tr><td><code id="write.xlsx_+3A_sheetname">sheetName</code></td>
<td>
<p>a character string with the sheet name.</p>
</td></tr>
<tr><td><code id="write.xlsx_+3A_col.names">col.names</code></td>
<td>
<p>a logical value indicating if the column names of <code>x</code>
are to be written along with <code>x</code> to the file.</p>
</td></tr>
<tr><td><code id="write.xlsx_+3A_row.names">row.names</code></td>
<td>
<p>a logical value indicating whether the row names of
<code>x</code> are to be written along with <code>x</code> to the file.</p>
</td></tr>
<tr><td><code id="write.xlsx_+3A_append">append</code></td>
<td>
<p>a logical value indicating if <code>x</code> should be appended to
an existing file.  If <code>TRUE</code> the file is read from disk.</p>
</td></tr>
<tr><td><code id="write.xlsx_+3A_showna">showNA</code></td>
<td>
<p>a logical value.  If set to <code>FALSE</code>, NA values will be
left as empty cells.</p>
</td></tr>
<tr><td><code id="write.xlsx_+3A_password">password</code></td>
<td>
<p>a String with the password.</p>
</td></tr>
<tr><td><code id="write.xlsx_+3A_...">...</code></td>
<td>
<p>other arguments to <code>addDataFrame</code> in the case of
<code>read.xlsx2</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function provides a high level API for writing a <code>data.frame</code> to
an Excel 2007 worksheet.  It calls several low level functions in the
process.  Its goal is to provide the conveniency of
<code><a href="utils.html#topic+write.csv">write.csv</a></code> by borrowing from its signature.
</p>
<p>Internally, <code>write.xlsx</code> uses a double loop in over all the elements of
the <code>data.frame</code> so performance for very large <code>data.frame</code> may be
an issue.  Please report if you experience slow performance.  Dates and
POSIXct classes are formatted separately after the insertion.  This also
adds to processing time.
</p>
<p>If <code>x</code> is not a <code>data.frame</code> it will be converted to one.
</p>
<p>Function <code>write.xlsx2</code> uses <code>addDataFrame</code> which speeds up the
execution compared to <code>write.xlsx</code> by an order of magnitude for large
spreadsheets (with more than 100,000 cells).
</p>
<p>The default formats for Date and DateTime columns can be changed via the two
package options <code>xlsx.date.format</code> and <code>xlsx.datetime.format</code>.
They need to be specified in Java date format
<a href="https://docs.oracle.com/javase/7/docs/api/java/text/SimpleDateFormat.html">https://docs.oracle.com/javase/7/docs/api/java/text/SimpleDateFormat.html</a>.
</p>
<p>Writing of password protected workbooks is supported for Excel 2007 OOXML
format only.  Note that in Linux, LibreOffice is not able to read password
protected spreadsheets.
</p>


<h3>Author(s)</h3>

<p>Adrian Dragulescu
</p>


<h3>See Also</h3>

<p><code><a href="#topic+read.xlsx">read.xlsx</a></code> for reading <code>xlsx</code> documents.  See
also <code><a href="#topic+addDataFrame">addDataFrame</a></code> for writing a <code>data.frame</code> to a sheet.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 

file &lt;- paste(tempdir(), "/usarrests.xlsx", sep="")
res &lt;- write.xlsx(USArrests, file)

# to change the default date format
oldOpt &lt;- options()
options(xlsx.date.format="dd MMM, yyyy")
write.xlsx(x, sheet) # where x is a data.frame with a Date column.
options(oldOpt)      # revert back to defaults


## End(Not run)

</code></pre>

<hr>
<h2 id='xlsx-package'>Read, write, format Excel 2007 and Excel 97/2000/XP/2003 files</h2><span id='topic+xlsx-package'></span><span id='topic+xlsx'></span>

<h3>Description</h3>

<p>The <code>xlsx</code> package gives programatic control of Excel files using R.  A
high level API allows the user to read a sheet of an xlsx document into a
<code>data.frame</code> and write a <code>data.frame</code> to a file.  Lower level
functionality permits the direct manipulation of sheets, rows and cells.
For example, the user has control to set colors, fonts, data formats, add
borders, hide/unhide sheets, add/remove rows, add/remove sheets, etc.
</p>


<h3>Details</h3>

<p>Behind the scenes, the <code>xlsx</code> package uses a java library from the
Apache project, <a href="https://poi.apache.org/index.html">https://poi.apache.org/index.html</a>.  This Apache project
provides a Java API to Microsoft Documents (Excel, Word, PowerPoint,
Outlook, Visio, etc.)  By using the <code>rJava</code> package that links and
Java, we can piggyback on the excellent work already done by the folks at
the Apache project and provide this functionality in R.  The <code>xlsx</code>
package uses only a subset of the Apache POI project, namely the one dealing
with Excel files.  All the necessary jar files are kept in package
<code>xlsxjars</code> that is imported by package <code>xlsx</code>.
</p>
<p>A collection of tests that can be used as examples are located in folder
<code>/tests/</code>.  They are a good source of examples of how to use the
package.
</p>
<p>Please see <a href="https://github.com/colearendt/xlsx/">https://github.com/colearendt/xlsx/</a> for a Wiki and the
development version.  To report a bug, use the Issues page at
<a href="https://github.com/colearendt/xlsx/issues">https://github.com/colearendt/xlsx/issues</a>.
</p>

<table>
<tr>
 <td style="text-align: left;"> Package: </td><td style="text-align: left;"> xlsx</td>
</tr>
<tr>
 <td style="text-align: left;"> Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;"> Version: </td><td style="text-align: left;">
0.6.0</td>
</tr>
<tr>
 <td style="text-align: left;"> Date: </td><td style="text-align: left;"> 2015-11-29</td>
</tr>
<tr>
 <td style="text-align: left;"> License: </td><td style="text-align: left;"> GPL-3</td>
</tr>
<tr>
 <td style="text-align: left;"> </td>
</tr>

</table>



<h3>References</h3>

<p>Apache POI project for Microsoft Excel format:
<a href="https://poi.apache.org/components/spreadsheet/index.html">https://poi.apache.org/components/spreadsheet/index.html</a>.
</p>
<p>The Java Doc detailing the classes:
<a href="https://poi.apache.org/apidocs/index.html">https://poi.apache.org/apidocs/index.html</a>.  This can be useful if you
are looking for something that is not exposed in R as it may be available on
the Java side.  Inspecting the source code for some the the functions in
this package can show you how to do it (even if you are Java shy.)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Workbook">Workbook</a></code> for ways to work with <code>Workbook</code>
objects.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 

library(xlsx)

# example of reading xlsx sheets
file &lt;- system.file("tests", "test_import.xlsx", package = "xlsx")
res &lt;- read.xlsx(file, 2)  # read the second sheet

# example of writing xlsx sheets
file &lt;- paste(tempfile(), "xlsx", sep=".")
write.xlsx(USArrests, file=file)


## End(Not run)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
