<!DOCTYPE html><html><head><title>Help for package tidytree</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {tidytree}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ancestor'><p>ancestor</p></a></li>
<li><a href='#as.treedata'><p>as.treedata</p></a></li>
<li><a href='#as.ultrametric'><p>as.ultrametric</p></a></li>
<li><a href='#child'><p>child</p></a></li>
<li><a href='#drop.tip'><p>drop.tip method</p></a></li>
<li><a href='#get_tree_data'><p>get_tree_data</p></a></li>
<li><a href='#get.data'><p>get.data method</p></a></li>
<li><a href='#get.fields'><p>get.fields method</p></a></li>
<li><a href='#get.treetext'><p>get.treetext method</p></a></li>
<li><a href='#getNodeNum'><p>getNodeNum</p></a></li>
<li><a href='#groupClade'><p>groupClade</p></a></li>
<li><a href='#groupOTU'><p>groupOTU</p></a></li>
<li><a href='#isTip'><p>isTip</p></a></li>
<li><a href='#MRCA'><p>MRCA</p></a></li>
<li><a href='#Nnode.treedata'><p>Nnode</p></a></li>
<li><a href='#node.label'><p>extract the node label of phylo, treedata or tbl_tree</p></a></li>
<li><a href='#nodeid'><p>nodeid</p></a></li>
<li><a href='#nodelab'><p>nodelab</p></a></li>
<li><a href='#offspring'><p>offspring</p></a></li>
<li><a href='#parent'><p>parent</p></a></li>
<li><a href='#reexports'><p>Objects exported from other packages</p></a></li>
<li><a href='#root.treedata'><p>root</p></a></li>
<li><a href='#rootnode'><p>rootnode</p></a></li>
<li><a href='#show'><p>show method</p></a></li>
<li><a href='#sibling'><p>sibling</p></a></li>
<li><a href='#td-label-assign'><p>the tip or internal node label assign of tbl_tree phylo and treedata</p></a></li>
<li><a href='#tip.label'><p>extract the tip label of phylo treedata or tbl_tree</p></a></li>
<li><a href='#tree_subset'><p>Subset tree objects by related nodes</p></a></li>
<li><a href='#treedata'><p>treedata</p></a></li>
<li><a href='#treedata-class'><p>Class &quot;treedata&quot;</p>
This class stores phylogenetic tree with associated data</a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>A Tidy Tool for Phylogenetic Tree Data Manipulation</td>
</tr>
<tr>
<td>Version:</td>
<td>0.4.6</td>
</tr>
<tr>
<td>Description:</td>
<td>Phylogenetic tree generally contains multiple components including node, edge, branch and associated data. 'tidytree' provides an approach to convert tree object to tidy data frame as well as provides tidy interfaces to manipulate tree data.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.4.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>ape, dplyr, lazyeval, magrittr, methods, rlang, tibble, tidyr,
tidyselect, yulab.utils (&ge; 0.0.4), pillar, cli</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, prettydoc, testthat, utils</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>ByteCompile:</td>
<td>true</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/Artistic-2.0">Artistic-2.0</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://www.amazon.com/Integration-Manipulation-Visualization-Phylogenetic-Computational-ebook/dp/B0B5NLZR1Z/">https://www.amazon.com/Integration-Manipulation-Visualization-Phylogenetic-Computational-ebook/dp/B0B5NLZR1Z/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/YuLab-SMU/tidytree/issues">https://github.com/YuLab-SMU/tidytree/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-12-12 11:11:12 UTC; HUAWEI</td>
</tr>
<tr>
<td>Author:</td>
<td>Guangchuang Yu <a href="https://orcid.org/0000-0002-6485-8781"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre, cph],
  Bradley Jones [ctb],
  Zebulun Arendsee [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Guangchuang Yu &lt;guangchuangyu@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-12-12 11:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='ancestor'>ancestor</h2><span id='topic+ancestor'></span><span id='topic+ancestor.tbl_tree'></span>

<h3>Description</h3>

<p>access ancestor data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ancestor(.data, .node, ...)

## S3 method for class 'tbl_tree'
ancestor(.data, .node, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ancestor_+3A_.data">.data</code></td>
<td>
<p>phylo or tbl_tree object</p>
</td></tr>
<tr><td><code id="ancestor_+3A_.node">.node</code></td>
<td>
<p>node number</p>
</td></tr>
<tr><td><code id="ancestor_+3A_...">...</code></td>
<td>
<p>additional parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ancestor data
</p>


<h3>Author(s)</h3>

<p>Guangchuang Yu
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ape)
tree &lt;- rtree(4)
x &lt;- as_tibble(tree)
ancestor(x, 3)
</code></pre>

<hr>
<h2 id='as.treedata'>as.treedata</h2><span id='topic+as.treedata'></span><span id='topic+as.treedata.tbl_tree'></span>

<h3>Description</h3>

<p>convert a tree object to treedata object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.treedata(tree, ...)

## S3 method for class 'tbl_tree'
as.treedata(tree, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.treedata_+3A_tree">tree</code></td>
<td>
<p>tree object</p>
</td></tr>
<tr><td><code id="as.treedata_+3A_...">...</code></td>
<td>
<p>additional parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>treedata object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ape)
set.seed(2017)
tree &lt;- rtree(4)
d &lt;- tibble(label = paste0('t', 1:4),
           trait = rnorm(4))
x &lt;- as_tibble(tree)
full_join(x, d, by = 'label') %&gt;% as.treedata
</code></pre>

<hr>
<h2 id='as.ultrametric'>as.ultrametric</h2><span id='topic+as.ultrametric'></span>

<h3>Description</h3>

<p>as.ultrametric
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.ultrametric(tree, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.ultrametric_+3A_tree">tree</code></td>
<td>
<p>tree object</p>
</td></tr>
<tr><td><code id="as.ultrametric_+3A_...">...</code></td>
<td>
<p>additional parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>treedata or phylo object
</p>

<hr>
<h2 id='child'>child</h2><span id='topic+child'></span><span id='topic+child.tbl_tree'></span>

<h3>Description</h3>

<p>access child data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>child(.data, .node, ...)

## S3 method for class 'tbl_tree'
child(.data, .node, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="child_+3A_.data">.data</code></td>
<td>
<p>phylo or tbl_tree object</p>
</td></tr>
<tr><td><code id="child_+3A_.node">.node</code></td>
<td>
<p>node number</p>
</td></tr>
<tr><td><code id="child_+3A_...">...</code></td>
<td>
<p>additional parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>child data
</p>


<h3>Author(s)</h3>

<p>Guangchuang Yu
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ape)
tree &lt;- rtree(4)
x &lt;- as_tibble(tree)
child(x, 4)
</code></pre>

<hr>
<h2 id='drop.tip'>drop.tip method</h2><span id='topic+drop.tip'></span><span id='topic+keep.tip'></span><span id='topic+drop.tip+2Ctreedata-method'></span><span id='topic+drop.tip+2Ctreedata'></span><span id='topic+drop.tip+2Cphylo-method'></span><span id='topic+drop.tip+2Cphylo'></span><span id='topic+keep.tip+2Ctreedata-method'></span><span id='topic+keep.tip+2Cphylo-method'></span>

<h3>Description</h3>

<p>drop.tip method
</p>


<h3>Usage</h3>

<pre><code class='language-R'>drop.tip(object, tip, ...)

keep.tip(object, tip, ...)

## S4 method for signature 'treedata'
drop.tip(object, tip, ...)

## S4 method for signature 'phylo'
drop.tip(object, tip, ...)

## S4 method for signature 'treedata'
keep.tip(object, tip, ...)

## S4 method for signature 'phylo'
keep.tip(object, tip, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="drop.tip_+3A_object">object</code></td>
<td>
<p>A treedata or phylo object</p>
</td></tr>
<tr><td><code id="drop.tip_+3A_tip">tip</code></td>
<td>
<p>a vector of mode numeric or character specifying the tips to delete</p>
</td></tr>
<tr><td><code id="drop.tip_+3A_...">...</code></td>
<td>
<p>additional parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>updated object
</p>


<h3>Author(s)</h3>

<p>Casey Dunn <a href="http://dunnlab.org">http://dunnlab.org</a>  and Guangchuang Yu <a href="https://guangchuangyu.github.io">https://guangchuangyu.github.io</a>
</p>


<h3>Source</h3>

<p>drop.tip for phylo object is a wrapper method of ape::drop.tip
from the ape package. The documentation you should
read for the drop.tip function can be found here: <a href="ape.html#topic+drop.tip">drop.tip</a>
</p>


<h3>See Also</h3>

<p><a href="ape.html#topic+drop.tip">drop.tip</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(tidytree)
set.seed(123)
tr &lt;- ape::rtree(6)
da &lt;- data.frame(id=tip.label(tr), value = letters[seq_len(6)])
trda &lt;- tr %&gt;% dplyr::left_join(da, by = c('label'='id'))
tr1 &lt;- drop.tip(tr, c("t2", "t1"))
tr2 &lt;- keep.tip(tr, c("t2", "t1"))
</code></pre>

<hr>
<h2 id='get_tree_data'>get_tree_data</h2><span id='topic+get_tree_data'></span>

<h3>Description</h3>

<p>get associated data stored in treedata object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_tree_data(tree_object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_tree_data_+3A_tree_object">tree_object</code></td>
<td>
<p>a <code>treedata</code> object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>tbl_df
</p>


<h3>Author(s)</h3>

<p>guangchuang yu
</p>

<hr>
<h2 id='get.data'>get.data method</h2><span id='topic+get.data'></span><span id='topic+get.data+2Ctreedata-method'></span>

<h3>Description</h3>

<p>get.data method
</p>
<p>get.data method
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.data(object, ...)

## S4 method for signature 'treedata'
get.data(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get.data_+3A_object">object</code></td>
<td>
<p><code>treedata</code> object</p>
</td></tr>
<tr><td><code id="get.data_+3A_...">...</code></td>
<td>
<p>additional parameter</p>
</td></tr>
</table>


<h3>Value</h3>

<p>associated data of phylogeny
</p>

<hr>
<h2 id='get.fields'>get.fields method</h2><span id='topic+get.fields'></span><span id='topic+get.fields+2Ctreedata-method'></span><span id='topic+get.fields+2Ctreedata'></span>

<h3>Description</h3>

<p>get.fields method
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.fields(object, ...)

## S4 method for signature 'treedata'
get.fields(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get.fields_+3A_object">object</code></td>
<td>
<p><code>treedata</code> object</p>
</td></tr>
<tr><td><code id="get.fields_+3A_...">...</code></td>
<td>
<p>additional parameter</p>
</td></tr>
</table>


<h3>Value</h3>

<p>available annotation variables
</p>

<hr>
<h2 id='get.treetext'>get.treetext method</h2><span id='topic+get.treetext'></span><span id='topic+get.treetext+2Ctreedata-method'></span>

<h3>Description</h3>

<p>access tree text (newick text) from tree object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.treetext(object, ...)

## S4 method for signature 'treedata'
get.treetext(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get.treetext_+3A_object">object</code></td>
<td>
<p>treedata object</p>
</td></tr>
<tr><td><code id="get.treetext_+3A_...">...</code></td>
<td>
<p>additional parameter</p>
</td></tr>
</table>


<h3>Value</h3>

<p>phylo object
</p>

<hr>
<h2 id='getNodeNum'>getNodeNum</h2><span id='topic+getNodeNum'></span>

<h3>Description</h3>

<p>calculate total number of nodes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getNodeNum(tree)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getNodeNum_+3A_tree">tree</code></td>
<td>
<p>tree object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>number
</p>


<h3>Author(s)</h3>

<p>Guangchuang Yu
</p>


<h3>Examples</h3>

<pre><code class='language-R'>getNodeNum(rtree(30))
</code></pre>

<hr>
<h2 id='groupClade'>groupClade</h2><span id='topic+groupClade'></span>

<h3>Description</h3>

<p>grouping clades
</p>


<h3>Usage</h3>

<pre><code class='language-R'>groupClade(.data, .node, group_name = "group", overlap = "overwrite", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="groupClade_+3A_.data">.data</code></td>
<td>
<p>tree object (phylo, treedata, tbl_tree, ggtree etc.)</p>
</td></tr>
<tr><td><code id="groupClade_+3A_.node">.node</code></td>
<td>
<p>selected nodes</p>
</td></tr>
<tr><td><code id="groupClade_+3A_group_name">group_name</code></td>
<td>
<p>character the name of the group cluster, default is <code>group</code>.</p>
</td></tr>
<tr><td><code id="groupClade_+3A_overlap">overlap</code></td>
<td>
<p>character one of <code>overwrite</code>,<code>origin</code> and <code>abandon</code>,
default is <code>overwrite</code>.</p>
</td></tr>
<tr><td><code id="groupClade_+3A_...">...</code></td>
<td>
<p>additional parameter</p>
</td></tr>
</table>


<h3>Value</h3>

<p>updated tree with group information or group index
</p>


<h3>Author(s)</h3>

<p>Guangchuang Yu
</p>

<hr>
<h2 id='groupOTU'>groupOTU</h2><span id='topic+groupOTU'></span>

<h3>Description</h3>

<p>grouping OTUs
</p>


<h3>Usage</h3>

<pre><code class='language-R'>groupOTU(.data, .node, group_name = "group", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="groupOTU_+3A_.data">.data</code></td>
<td>
<p>tree object (phylo, treedata, tbl_tree, ggtree etc.)</p>
</td></tr>
<tr><td><code id="groupOTU_+3A_.node">.node</code></td>
<td>
<p>selected nodes</p>
</td></tr>
<tr><td><code id="groupOTU_+3A_group_name">group_name</code></td>
<td>
<p>character the name of the group cluster, default is <code>group</code>.</p>
</td></tr>
<tr><td><code id="groupOTU_+3A_...">...</code></td>
<td>
<p>additional parameter</p>
</td></tr>
</table>


<h3>Value</h3>

<p>updated tree with group information or group index
</p>


<h3>Author(s)</h3>

<p>Guangchuang Yu
</p>

<hr>
<h2 id='isTip'>isTip</h2><span id='topic+isTip'></span><span id='topic+isTip.tbl_tree'></span><span id='topic+isTip.phylo'></span><span id='topic+isTip.treedata'></span>

<h3>Description</h3>

<p>whether the node is a tip
</p>


<h3>Usage</h3>

<pre><code class='language-R'>isTip(.data, .node, ...)

## S3 method for class 'tbl_tree'
isTip(.data, .node, ...)

## S3 method for class 'phylo'
isTip(.data, .node, ...)

## S3 method for class 'treedata'
isTip(.data, .node, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="isTip_+3A_.data">.data</code></td>
<td>
<p>phylo, treedata or tbl_tree object</p>
</td></tr>
<tr><td><code id="isTip_+3A_.node">.node</code></td>
<td>
<p>node number</p>
</td></tr>
<tr><td><code id="isTip_+3A_...">...</code></td>
<td>
<p>additional parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>logical value
</p>


<h3>Author(s)</h3>

<p>Guangchuang Yu
</p>

<hr>
<h2 id='MRCA'>MRCA</h2><span id='topic+MRCA'></span>

<h3>Description</h3>

<p>access most recent common ancestor data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MRCA(.data, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MRCA_+3A_.data">.data</code></td>
<td>
<p>phylo or tbl_tree object</p>
</td></tr>
<tr><td><code id="MRCA_+3A_...">...</code></td>
<td>
<p>additional parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>MRCA data
</p>


<h3>Author(s)</h3>

<p>Guangchuang Yu
</p>

<hr>
<h2 id='Nnode.treedata'>Nnode</h2><span id='topic+Nnode.treedata'></span>

<h3>Description</h3>

<p>number of nodes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'treedata'
Nnode(phy, internal.only = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Nnode.treedata_+3A_phy">phy</code></td>
<td>
<p>treedata object</p>
</td></tr>
<tr><td><code id="Nnode.treedata_+3A_internal.only">internal.only</code></td>
<td>
<p>whether only count internal nodes</p>
</td></tr>
<tr><td><code id="Nnode.treedata_+3A_...">...</code></td>
<td>
<p>additional parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>number of nodes
</p>


<h3>Author(s)</h3>

<p>Guangchuang Yu
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Nnode(rtree(30))
</code></pre>

<hr>
<h2 id='node.label'>extract the node label of phylo, treedata or tbl_tree</h2><span id='topic+node.label'></span>

<h3>Description</h3>

<p>extract the node label of phylo, treedata or tbl_tree
</p>


<h3>Usage</h3>

<pre><code class='language-R'>node.label(x, node = "internal", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="node.label_+3A_x">x</code></td>
<td>
<p>object, should be one of <code>treedata</code>,<code>phylo</code> or <code>tbl_tree</code>.</p>
</td></tr>
<tr><td><code id="node.label_+3A_node">node</code></td>
<td>
<p>character, to extract which type node label,
default is <code>internal</code>, should be one of <code>internal</code>,
<code>external</code>, <code>all</code>, <code>tip</code>.</p>
</td></tr>
<tr><td><code id="node.label_+3A_...">...</code></td>
<td>
<p>additional parameters.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>label character vector.
</p>

<hr>
<h2 id='nodeid'>nodeid</h2><span id='topic+nodeid'></span>

<h3>Description</h3>

<p>convert tree label to internal node number
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nodeid(tree, label)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nodeid_+3A_tree">tree</code></td>
<td>
<p>tree object</p>
</td></tr>
<tr><td><code id="nodeid_+3A_label">label</code></td>
<td>
<p>tip/node label(s)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>node number
</p>


<h3>Author(s)</h3>

<p>Guangchuang Yu
</p>

<hr>
<h2 id='nodelab'>nodelab</h2><span id='topic+nodelab'></span>

<h3>Description</h3>

<p>convert internal node number tip/node label
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nodelab(tree, id)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nodelab_+3A_tree">tree</code></td>
<td>
<p>tree object</p>
</td></tr>
<tr><td><code id="nodelab_+3A_id">id</code></td>
<td>
<p>node number</p>
</td></tr>
</table>


<h3>Value</h3>

<p>tip/node label(s)
</p>


<h3>Author(s)</h3>

<p>Guangchuang Yu
</p>

<hr>
<h2 id='offspring'>offspring</h2><span id='topic+offspring'></span><span id='topic+offspring.tbl_tree'></span>

<h3>Description</h3>

<p>access offspring data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>offspring(.data, .node, tiponly, self_include, ...)

## S3 method for class 'tbl_tree'
offspring(.data, .node, tiponly = FALSE, self_include = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="offspring_+3A_.data">.data</code></td>
<td>
<p>phylo or tbl_tree object</p>
</td></tr>
<tr><td><code id="offspring_+3A_.node">.node</code></td>
<td>
<p>node number</p>
</td></tr>
<tr><td><code id="offspring_+3A_tiponly">tiponly</code></td>
<td>
<p>whether only return tip nodes</p>
</td></tr>
<tr><td><code id="offspring_+3A_self_include">self_include</code></td>
<td>
<p>whether include the input node,
only applicable for tiponly = FALSE</p>
</td></tr>
<tr><td><code id="offspring_+3A_...">...</code></td>
<td>
<p>additional parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>offspring data
</p>


<h3>Author(s)</h3>

<p>Guangchuang Yu
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ape)
tree &lt;- rtree(4)
x &lt;- as_tibble(tree)
offspring(x, 4)
</code></pre>

<hr>
<h2 id='parent'>parent</h2><span id='topic+parent'></span><span id='topic+parent.tbl_tree'></span>

<h3>Description</h3>

<p>access parent data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>parent(.data, .node, ...)

## S3 method for class 'tbl_tree'
parent(.data, .node, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="parent_+3A_.data">.data</code></td>
<td>
<p>phylo or tbl_tree object</p>
</td></tr>
<tr><td><code id="parent_+3A_.node">.node</code></td>
<td>
<p>node number</p>
</td></tr>
<tr><td><code id="parent_+3A_...">...</code></td>
<td>
<p>additional parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>parent data
</p>


<h3>Author(s)</h3>

<p>Guangchuang Yu
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ape)
tree &lt;- rtree(4)
x &lt;- as_tibble(tree)
parent(x, 2)
</code></pre>

<hr>
<h2 id='reexports'>Objects exported from other packages</h2><span id='topic+reexports'></span><span id='topic+as.phylo'></span><span id='topic+Nnode'></span><span id='topic+rtree'></span><span id='topic+read.tree'></span><span id='topic+Ntip'></span><span id='topic+is.rooted'></span><span id='topic+root'></span><span id='topic++25+3E+25'></span><span id='topic++25+3C+3E+25'></span><span id='topic+as_tibble'></span><span id='topic+tibble'></span><span id='topic+filter'></span><span id='topic+arrange'></span><span id='topic+select'></span><span id='topic+rename'></span><span id='topic+mutate'></span><span id='topic+transmute'></span><span id='topic+summarise'></span><span id='topic+summarize'></span><span id='topic+full_join'></span><span id='topic+.data'></span><span id='topic+left_join'></span><span id='topic+pull'></span><span id='topic+unnest'></span>

<h3>Description</h3>

<p>These objects are imported from other packages. Follow the links
below to see their documentation.
</p>

<dl>
<dt>ape</dt><dd><p><code><a href="ape.html#topic+as.phylo">as.phylo</a></code>, <code><a href="ape.html#topic+as.phylo">as.phylo</a></code>, <code><a href="ape.html#topic+root">is.rooted</a></code>, <code><a href="ape.html#topic+summary.phylo">Nnode</a></code>, <code><a href="ape.html#topic+summary.phylo">Ntip</a></code>, <code><a href="ape.html#topic+read.tree">read.tree</a></code>, <code><a href="ape.html#topic+root">root</a></code>, <code><a href="ape.html#topic+rtree">rtree</a></code></p>
</dd>
<dt>dplyr</dt><dd><p><code><a href="dplyr.html#topic+arrange">arrange</a></code>, <code><a href="dplyr.html#topic+filter">filter</a></code>, <code><a href="dplyr.html#topic+mutate-joins">full_join</a></code>, <code><a href="dplyr.html#topic+mutate-joins">left_join</a></code>, <code><a href="dplyr.html#topic+mutate">mutate</a></code>, <code><a href="dplyr.html#topic+pull">pull</a></code>, <code><a href="dplyr.html#topic+rename">rename</a></code>, <code><a href="dplyr.html#topic+rename">rename</a></code>, <code><a href="dplyr.html#topic+select">select</a></code>, <code><a href="dplyr.html#topic+summarise">summarise</a></code>, <code><a href="dplyr.html#topic+summarise">summarize</a></code>, <code><a href="dplyr.html#topic+transmute">transmute</a></code></p>
</dd>
<dt>magrittr</dt><dd><p><code><a href="magrittr.html#topic+compound">%&lt;&gt;%</a></code>, <code><a href="magrittr.html#topic+pipe">%&gt;%</a></code></p>
</dd>
<dt>rlang</dt><dd><p><code><a href="rlang.html#topic+dot-data">.data</a></code></p>
</dd>
<dt>tibble</dt><dd><p><code><a href="tibble.html#topic+as_tibble">as_tibble</a></code>, <code><a href="tibble.html#topic+tibble">tibble</a></code></p>
</dd>
<dt>tidyr</dt><dd><p><code><a href="tidyr.html#topic+unnest">unnest</a></code></p>
</dd>
</dl>

<hr>
<h2 id='root.treedata'>root</h2><span id='topic+root.treedata'></span>

<h3>Description</h3>

<p>re-root a tree
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'treedata'
root(phy, outgroup, node = NULL, edgelabel = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="root.treedata_+3A_phy">phy</code></td>
<td>
<p>tree object</p>
</td></tr>
<tr><td><code id="root.treedata_+3A_outgroup">outgroup</code></td>
<td>
<p>a vector of mode numeric or character specifying the new outgroup</p>
</td></tr>
<tr><td><code id="root.treedata_+3A_node">node</code></td>
<td>
<p>node to reroot</p>
</td></tr>
<tr><td><code id="root.treedata_+3A_edgelabel">edgelabel</code></td>
<td>
<p>a logical value specifying whether to treat node labels as
edge labels and thus eventually switching them so that they are associated
with the correct edges.</p>
</td></tr>
<tr><td><code id="root.treedata_+3A_...">...</code></td>
<td>
<p>additional parameters passed to ape::root.phylo</p>
</td></tr>
</table>


<h3>Value</h3>

<p>rerooted treedata
</p>

<hr>
<h2 id='rootnode'>rootnode</h2><span id='topic+rootnode'></span>

<h3>Description</h3>

<p>access root node data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rootnode(.data, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rootnode_+3A_.data">.data</code></td>
<td>
<p>phylo or tbl_tree object</p>
</td></tr>
<tr><td><code id="rootnode_+3A_...">...</code></td>
<td>
<p>additional parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>root node data
</p>


<h3>Author(s)</h3>

<p>Guangchuang Yu
</p>

<hr>
<h2 id='show'>show method</h2><span id='topic+show'></span>

<h3>Description</h3>

<p>show method for <code>treedata</code> instance
</p>


<h3>Usage</h3>

<pre><code class='language-R'>show(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="show_+3A_object">object</code></td>
<td>
<p><code>treedata</code> object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>print info
</p>


<h3>Author(s)</h3>

<p>Guangchuang Yu <a href="https://guangchuangyu.github.io">https://guangchuangyu.github.io</a>
</p>

<hr>
<h2 id='sibling'>sibling</h2><span id='topic+sibling'></span>

<h3>Description</h3>

<p>access sibling data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sibling(.data, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sibling_+3A_.data">.data</code></td>
<td>
<p>phylo or tbl_tree object</p>
</td></tr>
<tr><td><code id="sibling_+3A_...">...</code></td>
<td>
<p>additional parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>sibling
</p>


<h3>Author(s)</h3>

<p>Guangchuang Yu
</p>

<hr>
<h2 id='td-label-assign'>the tip or internal node label assign of tbl_tree phylo and treedata</h2><span id='topic+td-label-assign'></span><span id='topic+tip.label+3C-'></span><span id='topic+node.label+3C-'></span><span id='topic+node.label+3C-.phylo'></span><span id='topic+node.label+3C-.treedata'></span><span id='topic+node.label+3C-.tbl_tree'></span><span id='topic+tip.label+3C-.phylo'></span><span id='topic+tip.label+3C-.treedata'></span><span id='topic+tip.label+3C-.tbl_tree'></span>

<h3>Description</h3>

<p>the tip or internal node label assign of tbl_tree phylo and treedata
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tip.label(x) &lt;- value

node.label(x) &lt;- value

## S3 replacement method for class 'phylo'
node.label(x) &lt;- value

## S3 replacement method for class 'treedata'
node.label(x) &lt;- value

## S3 replacement method for class 'tbl_tree'
node.label(x) &lt;- value

## S3 replacement method for class 'phylo'
tip.label(x) &lt;- value

## S3 replacement method for class 'treedata'
tip.label(x) &lt;- value

## S3 replacement method for class 'tbl_tree'
tip.label(x) &lt;- value
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="td-label-assign_+3A_x">x</code></td>
<td>
<p>object, should be one of <code>tbl_tree</code>, <code>phylo</code> or <code>treedata</code></p>
</td></tr>
<tr><td><code id="td-label-assign_+3A_value">value</code></td>
<td>
<p>character, the character vector</p>
</td></tr>
</table>

<hr>
<h2 id='tip.label'>extract the tip label of phylo treedata or tbl_tree</h2><span id='topic+tip.label'></span>

<h3>Description</h3>

<p>extract the tip label of phylo treedata or tbl_tree
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tip.label(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tip.label_+3A_x">x</code></td>
<td>
<p>object, should be one of <code>treedata</code>,<code>phylo</code> or <code>tbl_tree</code>.</p>
</td></tr>
<tr><td><code id="tip.label_+3A_...">...</code></td>
<td>
<p>additional parameters.</p>
</td></tr>
</table>

<hr>
<h2 id='tree_subset'>Subset tree objects by related nodes</h2><span id='topic+tree_subset'></span><span id='topic+tree_subset.phylo'></span><span id='topic+tree_subset.treedata'></span>

<h3>Description</h3>

<p>This function allows for a tree object to be subset by specifying a
node and returns all related nodes within a selected number of
levels
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tree_subset(
  tree,
  node,
  levels_back = 5,
  group_node = TRUE,
  group_name = "group",
  root_edge = TRUE
)

## S3 method for class 'phylo'
tree_subset(
  tree,
  node,
  levels_back = 5,
  group_node = TRUE,
  group_name = "group",
  root_edge = TRUE
)

## S3 method for class 'treedata'
tree_subset(
  tree,
  node,
  levels_back = 5,
  group_node = TRUE,
  group_name = "group",
  root_edge = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tree_subset_+3A_tree">tree</code></td>
<td>
<p>a tree object of class phylo</p>
</td></tr>
<tr><td><code id="tree_subset_+3A_node">node</code></td>
<td>
<p>either a tip label or a node number for the given
tree that will be the focus of the subsetted tree</p>
</td></tr>
<tr><td><code id="tree_subset_+3A_levels_back">levels_back</code></td>
<td>
<p>a number specifying how many nodes back from
the selected node the subsetted tree should include</p>
</td></tr>
<tr><td><code id="tree_subset_+3A_group_node">group_node</code></td>
<td>
<p>whether add grouping information of selected node</p>
</td></tr>
<tr><td><code id="tree_subset_+3A_group_name">group_name</code></td>
<td>
<p>group name (default 'group') for storing grouping information if group_node = TRUE</p>
</td></tr>
<tr><td><code id="tree_subset_+3A_root_edge">root_edge</code></td>
<td>
<p>If TRUE (by default), set root.edge to path length of orginal root to the root of subset tree</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function will take a tree and a specified node from
that tree and subset the tree showing all relatives back to a specified
number of nodes. This function allows for a combination of
<code>ancestor</code> and <code>offspring</code> to return a subsetted
tree that is of class phylo. This allows for easy graphing of the tree
with <code>ggtree</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)
tree &lt;- ape::rtree(6)
sub_tree &lt;- tree_subset(tree, node = "t1", levels_back = 2)
</code></pre>

<hr>
<h2 id='treedata'>treedata</h2><span id='topic+treedata'></span>

<h3>Description</h3>

<p>treedata object contructor
</p>


<h3>Usage</h3>

<pre><code class='language-R'>treedata(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="treedata_+3A_...">...</code></td>
<td>
<p>parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>treedata object
</p>


<h3>Author(s)</h3>

<p>guangchuang yu
</p>

<hr>
<h2 id='treedata-class'>Class &quot;treedata&quot;
This class stores phylogenetic tree with associated data</h2><span id='topic+treedata-class'></span><span id='topic+show+2Ctreedata-method'></span>

<h3>Description</h3>

<p>Class &quot;treedata&quot;
This class stores phylogenetic tree with associated data
</p>


<h3>Slots</h3>


<dl>
<dt><code>file</code></dt><dd><p>tree file</p>
</dd>
<dt><code>treetext</code></dt><dd><p>newick tree string</p>
</dd>
<dt><code>phylo</code></dt><dd><p>phylo object for tree structure</p>
</dd>
<dt><code>data</code></dt><dd><p>associated data</p>
</dd>
<dt><code>extraInfo</code></dt><dd><p>extra information, reserve for merge_tree</p>
</dd>
<dt><code>tip_seq</code></dt><dd><p>tip sequences</p>
</dd>
<dt><code>anc_seq</code></dt><dd><p>ancestral sequences</p>
</dd>
<dt><code>seq_type</code></dt><dd><p>sequence type, one of NT or AA</p>
</dd>
<dt><code>tipseq_file</code></dt><dd><p>tip sequence file</p>
</dd>
<dt><code>ancseq_file</code></dt><dd><p>ancestral sequence file</p>
</dd>
<dt><code>info</code></dt><dd><p>extra information, e.g. metadata, software version etc.</p>
</dd>
</dl>


<h3>Author(s)</h3>

<p>Guangchuang Yu <a href="https://guangchuangyu.github.io">https://guangchuangyu.github.io</a>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
