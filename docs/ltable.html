<!DOCTYPE html><html><head><title>Help for package ltable</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ltable}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#+5B+2CpowerClass-method'><p> Method for Function <code>[</code></p></a></li>
<li><a href='#+5B+26lt+3B-+2CpowerClass-method'><p>Method for Function <code>[&lt;-</code></p></a></li>
<li><a href='#BCdata'>
<p>Breast cancer data to model risk</p></a></li>
<li><a href='#ltable-package'>
<p>ltable</p></a></li>
<li><a href='#MCLogLin'><p>Function <em>MCLogLin</em></p></a></li>
<li><a href='#MCPower'><p>Function <em>MCPower</em></p></a></li>
<li><a href='#plot+2CpowerClass-method'><p> Method for Function <code>plot</code></p></a></li>
<li><a href='#powerClass-class'><p>Class <code>"powerClass"</code></p></a></li>
<li><a href='#print+2CpowerClass-method'><p> Method for Function <code>print</code></p></a></li>
<li><a href='#sdata'>
<p>Simple Data.</p></a></li>
<li><a href='#SimData'>
<p>Simulated interval censored survival data to model hazard.</p></a></li>
<li><a href='#SMdata'>
<p>Heart surgery data to model standardized (mortality) ratio.</p></a></li>
<li><a href='#table_f'><p>Function <em>table_f</em></p></a></li>
<li><a href='#tableToData'><p>Function <em>tableToData</em></p></a></li>
<li><a href='#tdata'>
<p>Tromboembolism Data.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Easy to Make (Lazy) Tables</td>
</tr>
<tr>
<td>Version:</td>
<td>2.0.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-08-16</td>
</tr>
<tr>
<td>Author:</td>
<td>Ocheredko Oleksandr</td>
</tr>
<tr>
<td>Description:</td>
<td>Constructs tables of counts and proportions out of data sets with possibility to insert tables to Excel, Word, HTML, and PDF documents. Transforms tables to data suitable for modelling. Features Gibbs sampling based log-linear (NB2) and power analyses (original by Oleksandr Ocheredko &lt;<a href="https://doi.org/10.35566%2Fisdsa2019c5">doi:10.35566/isdsa2019c5</a>&gt;) for tabulated data.  </td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Ocheredko Oleksandr &lt;Ocheredko@yahoo.com&gt;</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.1.0), methods, clipr</td>
</tr>
<tr>
<td>Imports:</td>
<td>graphics, stats</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, datasets</td>
</tr>
<tr>
<td>Collate:</td>
<td>MCLogLin.R MCPower.R Plot.R PrintPower.R table_f.R
tableToData.R</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-16 16:50:52 UTC; macbook</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-16 17:14:35 UTC</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
</table>
<hr>
<h2 id='+5B+2CpowerClass-method'> Method for Function <code>[</code></h2><span id='topic++5B+2CpowerClass-method'></span>

<h3>Description</h3>

<p>Method for function <code>[</code> with <br />
<code>signature(x = "powerClass")</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'powerClass'
x[i, j, drop]
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="+2B5B+2B2CpowerClass-method_+3A_x">x</code></td>
<td>
<p>the name of <em>powerClass</em> object.</p>
</td></tr>
<tr><td><code id="+2B5B+2B2CpowerClass-method_+3A_i">i</code></td>
<td>
<p>the name of the slot of the object</p>
</td></tr>
<tr><td><code id="+2B5B+2B2CpowerClass-method_+3A_j">j</code></td>
<td>
<p>picks up j-th element of the list in slot with name &amp;i.</p>
</td></tr>
<tr><td><code id="+2B5B+2B2CpowerClass-method_+3A_drop">drop</code></td>
<td>
<p>not used</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Method provides access to slots of <em>powerClass</em> object. Its structure delivered in <em>powerClass-class</em> index. Access to particular vectors of lists supplied with $ operator. For example, log-linear reg.coefficients estimates of smallest size data accessible by obj[&quot;estim&quot;, 1]$betas, errors can be obtained by analogue: obj[&quot;estim&quot;, 1]$errors. Power values extraction slightly differs: obj[&quot;power11&quot;, 1]&amp;power extracts power values vector for 1st effect given 11th (largest) sample size. By analogue we get vector of z-scores for second effect given smallest sample size by obj[&quot;power1&quot;, 2]&amp;z.      
See <em>powerClass-class</em> index.</p>


<h3>Methods</h3>


<dl>
<dt><code>signature(x = "powerClass", i = "character", j = "integer", drop = "logical")</code></dt><dd>
<p>Method for function <code>[</code> for object of S4 class <em>powerClass</em>.<br /> 
</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>require(ltable)
require(ltable)
data(tdata, package="ltable")
## For better illustration You should increase draw and burnin pars
pres&lt;-MCPower(Counts~smoker +contraceptive +tromb +  
contraceptive*tromb, scale_max=1.5, effect="contraceptive*tromb", 
data=tdata, draw=1000, burnin=300)
# get call
pres["cal"]
# get effect contrasts names
pres["effectsname"]
# get Jacobian reciprocal condition number in smallest sample
pres["estim",1]$Jacobian_rcnumber
# get chisq/n in smallest sample
pres["estim",1]$chi_sq
# get LogLikelihood
pres["estim",1]$LL
# get initial deviation between observed and expected counts
pres["estim",1]$dev0
# get final deviation between observed and expected counts
pres["estim",1]$dev

</code></pre>

<hr>
<h2 id='+5B+26lt+3B-+2CpowerClass-method'>Method for Function <code>[&lt;-</code>
</h2><span id='topic++5B+3C-+2CpowerClass-method'></span>

<h3>Description</h3>

<p>Method for function <code>[&lt;-</code> with <br />
<code>signature(x = "powerClass")</code>
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="+2B5B+2B26lt+2B3B-+2B2CpowerClass-method_+3A_x">x</code></td>
<td>
<p>the name of <em>powerClass</em> object.</p>
</td></tr>
<tr><td><code id="+2B5B+2B26lt+2B3B-+2B2CpowerClass-method_+3A_i">i</code></td>
<td>
<p>the name of the slot of the object</p>
</td></tr>
<tr><td><code id="+2B5B+2B26lt+2B3B-+2B2CpowerClass-method_+3A_j">j</code></td>
<td>
<p>picks up j-th element of the list in slot with name &amp;i.</p>
</td></tr>
<tr><td><code id="+2B5B+2B26lt+2B3B-+2B2CpowerClass-method_+3A_value">value</code></td>
<td>
<p>values to set</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Set method provides access to slots of <em>powerClass</em> object. Its structure delivered in <em>powerClass-class</em> index. Access to particular vectors of lists supplied with $ operator. For example, log-linear reg.coefficients estimates of smallest size data accessible by obj[&quot;estim&quot;, 1]$betas, errors can be obtained by analogue: obj[&quot;estim&quot;, 1]$errors. Power values extraction slightly differs: obj[&quot;power11&quot;, 1]&amp;power extracts power values vector for 1st effect given 11th (largest) sample size. By analogue we get vector of z-scores for second effect given smallest sample size by obj[&quot;power1&quot;, 2]&amp;z. It's hardly matter of practicality to  employ set method but for programming purpose.     
See <em>powerClass-class</em> index.</p>


<h3>Methods</h3>


<dl>
<dt><code>signature(x = "powerClass", i = "character", j = "integer", value = "ANY")</code></dt><dd>
<p>Method for function <code>[&lt;-</code> for object of S4 class <em>powerClass</em>.<br /> 
</p>
</dd>
</dl>


<hr>
<h2 id='BCdata'>
Breast cancer data to model risk
</h2><span id='topic+BCdata'></span>

<h3>Description</h3>

<p>Breast cancer rates in Iceland by year of birth (11 cohorts from 1840-1849 to 1940-1949) and by age (13 groups from 20-24 to 80-84 years). Analysed by Breslow and Clayton (1993). Data is used also in BUGS Example &ldquo;Ice: non-parametric smoothing in an age-cohort model&rdquo;. Data supplied with file <em>offsetdata.rda</em>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(BCdata)</code></pre>


<h3>Format</h3>

<p>Description of data frames:
</p>

<p><var>Fields:</var>
</p>

<table>
<tr>
 <td style="text-align: right;">
    1. </td><td style="text-align: left;"> age </td><td style="text-align: left;"> Age group: 1-13  </td><td style="text-align: left;"> numeric </td>
</tr>
<tr>
 <td style="text-align: right;">
    2. </td><td style="text-align: left;"> year </td><td style="text-align: left;"> Birth cohort: 1-11 </td><td style="text-align: left;"> numeric </td>
</tr>
<tr>
 <td style="text-align: right;">
    3. </td><td style="text-align: left;"> cases </td><td style="text-align: left;"> Breast cancer counts </td><td style="text-align: left;"> numeric </td>
</tr>
<tr>
 <td style="text-align: right;">
    4. </td><td style="text-align: left;"> pyr </td><td style="text-align: left;"> Person-years of risk </td><td style="text-align: left;"> numeric </td>
</tr>
<tr>
 <td style="text-align: right;">
                </td>
</tr>

</table>




<h3>References</h3>

<p>BUGS. Examples Volume 2. <a href="https://www.mrc-bsu.cam.ac.uk/wp-content/uploads/WinBUGS_Vol2.pdf">https://www.mrc-bsu.cam.ac.uk/wp-content/uploads/WinBUGS_Vol2.pdf</a> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(ltable)
data(BCdata, package="ltable")
res1&lt;-MCLogLin(cases~age*year, offset=pyr, data=BCdata, draw=1500, burnin=500)
</code></pre>

<hr>
<h2 id='ltable-package'>
ltable</h2><span id='topic+ltable'></span>

<h3>Description</h3>

<p><b>Constructs tables of counts and proportions out of data sets. Performs log-linear and power analyzes of tabulated data</b>
</p>


<h3>Details</h3>

<p>Gibbs sampling based log-linear analysis features some advantages against <em>glm {stats}</em>, first of all due to fixing overdispersion by NB2 posterior marginal distribution of counts that insures distinctly less biased covariance estimates, pivot issue for implemented power analysis. In some instances hypothesis testing of higher order effects disagrees with that of <em>glm {stats}</em> on account of larger NB2 model based errors estimates. Another though related enhancement is distinct better fit assessed by sum of squared differences between observed and expected counts. Results of power analysis backed up with MCMC BUGS delivered approach (reference 2).  
</p>


<h3>Note</h3>

<p>You can:
</p>

<ol>
<li><p>construct tables with data set fields of factor, character, logical, and numeric classes;
</p>
</li>
<li><p>insert tables into Excel and Word documents using clipboard, into LaTeX, HTML, Markdown and reStructuredText documents by the knitr::kable agency;
</p>
</li>
<li><p>perform Gibbs sampling based log-linear analysis;
</p>
</li>
<li><p>perform power analysis of selected effect.
</p>
</li></ol>



<h3>Author(s)</h3>

<p>Ocheredko Oleksandr
<a href="mailto:Ocheredko@yahoo.com">Ocheredko@yahoo.com</a>
</p>


<h3>References</h3>

<p>Ocheredko O.M. MCMC Bootstrap Based Approach to Power and Sample Size Evaluation. <a href="https://www.amazon.com/gp/product/1946728039/">https://www.amazon.com/gp/product/1946728039/</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>require(ltable)
data(sdata, package="ltable")
table_f(sdata, "a")
table_f(sdata, "a", MV=TRUE, extended=TRUE)
table_f(sdata, "a,b,c")
knitr::kable(table_f(sdata, "a,b,c,d", type=2, digits=3))
table_f(sdata, "b,c,a,d", MV=TRUE, extended=TRUE, cb=TRUE)
</code></pre>

<hr>
<h2 id='MCLogLin'>Function <em>MCLogLin</em></h2><span id='topic+MCLogLin'></span>

<h3>Description</h3>

<p>Performs log-linear analyses for constructed tabulated data based on Gibbs sampler with NB2 posterior marginal distribution for counts
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MCLogLin(formula, data, offset, contrasts=NULL, XLB=-100, XUB=100, a=0.1, b=0.1,
DIC=FALSE, pcov=FALSE, draw=10000, burnin=3000 )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MCLogLin_+3A_formula">formula</code></td>
<td>
<p>a symbolic description of the model to be fit.</p>
</td></tr>
<tr><td><code id="MCLogLin_+3A_data">data</code></td>
<td>
<p>name of the data set; object of <em>data.frame</em> class</p>
</td></tr>
<tr><td><code id="MCLogLin_+3A_offset">offset</code></td>
<td>
<p>variable in the data set to be used as offset.</p>
</td></tr>
<tr><td><code id="MCLogLin_+3A_contrasts">contrasts</code></td>
<td>
<p>serves to choose types of contrasts to study effects of factors, the same with <em>glm{stats}</em>), orthogonal polynomials by default</p>
</td></tr>
<tr><td><code id="MCLogLin_+3A_xlb">XLB</code></td>
<td>
<p>the vector of smallest possible values of regression effects <em>betas</em>; can be number if pertains to all <em>betas</em>.</p>
</td></tr>
<tr><td><code id="MCLogLin_+3A_xub">XUB</code></td>
<td>
<p>the vector of largest possible values of regression effects <em>betas</em>; can be number if pertains to all <em>betas</em>.</p>
</td></tr>
<tr><td><code id="MCLogLin_+3A_a">a</code></td>
<td>
<p>the value of shape parameter of gamma distributed inverce dispersion parameter (<em>phi</em>), i.e., <em>phi~Ga(a,b)</em>, so that mean(phi)=a/b and var(phi)=a/b^2</p>
</td></tr>
<tr><td><code id="MCLogLin_+3A_b">b</code></td>
<td>
<p>the value of rate (1/scale) parameter of gamma distributed inverce dispersion parameter (<em>phi</em>), i.e., <em>phi~Ga(a,b)</em>, so that mean(phi)=a/b and var(phi)=a/b^2</p>
</td></tr>
<tr><td><code id="MCLogLin_+3A_dic">DIC</code></td>
<td>
<p>requests print of deviance information criteria and its components</p>
</td></tr>
<tr><td><code id="MCLogLin_+3A_pcov">pcov</code></td>
<td>
<p>requests print of covariance and correlation matricies of the model parameters</p>
</td></tr>
<tr><td><code id="MCLogLin_+3A_draw">draw</code></td>
<td>
<p>indicates requested number of samples</p>
</td></tr>
<tr><td><code id="MCLogLin_+3A_burnin">burnin</code></td>
<td>
<p>indicates requested number of initial samples to discard</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p>Performs log-linear modelling with supplied data by using Gibbs sampler.
</p>
</li>
<li><p>Printing output includes standard table of parameters estimates, goodness of fit indicators, analysis of residuals. On the prompt it prints the deviance information criteria with its components as well as covariance and correlation matricies of the model parameters. By using parameter (<em>offset</em>) one can model risks and relative risks instead of counts.
</p>
</li></ul>



<h3>Value</h3>

<p>returns a matrix with columns of chains of sampled values of model parameters (expected counts, regression coefficients, inverce dispersion parameter) to be studied by MCMC facilitating packages (e.g., coda, mcmc, mcmcplot, etc.)</p>


<h3>Note</h3>

<p>Function provides better conditioned variance matrix estimates against function <em>stats::glm</em>, which is particular important for high order effects and power analysis. Particularly suggestive is to check the model fit first. Jacobian reciprocal condition number near zero indicates solution instability. If <em>chisq/n</em> &gt;&gt; 1,  the error estimates obtained from the covariance matrix will be too small and should be multiplied by square root of <em>chisq/dof</em>. Poor fit will result from the use of an inappropriate model and jeopardizes the validity of power analysis.<br /> It's recommended to keep difference between pars <em>draw</em> and <em>burnin</em> at least 3000.   
</p>


<h3>Author(s)</h3>

<p>Ocheredko Oleksandr
<a href="mailto:Ocheredko@yahoo.com">Ocheredko@yahoo.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+glm">glm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(ltable)
data(tdata, package="ltable")
## For better illustration You should increase draw and burnin pars
res1&lt;-MCLogLin(Counts~smoker +contraceptive +tromb +
contraceptive*tromb, data=tdata, draw=1500, burnin=500)


data(iris)
iriscut&lt;-with(iris, data.frame(PL=cut(Petal.Length,3),
                               PW=cut(Petal.Width,3)))
irist&lt;-table_f(iriscut,"PL,PW")
irisd&lt;-tableToData(irist, ordered="PL,PW")
res2&lt;-ltable::MCLogLin(Counts~PW+PL+PW*PL, DIC=TRUE, data=irisd,
draw=1500, burnin=500)



</code></pre>

<hr>
<h2 id='MCPower'>Function <em>MCPower</em></h2><span id='topic+MCPower'></span>

<h3>Description</h3>

<p>Performs power analyses for constructed tabulated data based on based on Gibbs sampler with NB2 posterior marginal distribution for counts
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MCPower(formula, data, offset, contrasts=NULL, XLB=-100, XUB=100, a=0.1, b=0.1,
scale_min=1, scale_max=5, effect, p_alpha=0.05, draw=10000, burnin=3000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MCPower_+3A_formula">formula</code></td>
<td>
<p>a symbolic description of the model to be fit.</p>
</td></tr>
<tr><td><code id="MCPower_+3A_data">data</code></td>
<td>
<p>name of the data set; object of <em>data.frame</em> class</p>
</td></tr>
<tr><td><code id="MCPower_+3A_offset">offset</code></td>
<td>
<p>variable in the data set to be used as offset.</p>
</td></tr>
<tr><td><code id="MCPower_+3A_contrasts">contrasts</code></td>
<td>
<p>serves to choose types of contrasts to study effects of factors, same with <em>glm{stats}</em>), orthogonal polynomials by default</p>
</td></tr>
<tr><td><code id="MCPower_+3A_xlb">XLB</code></td>
<td>
<p>the vector of smallest possible values of regression effects <em>betas</em>; can be number if pertains to all <em>betas</em>.</p>
</td></tr>
<tr><td><code id="MCPower_+3A_xub">XUB</code></td>
<td>
<p>the vector of largest possible values of regression effects <em>betas</em>; can be number if pertains to all <em>betas</em>.</p>
</td></tr>
<tr><td><code id="MCPower_+3A_a">a</code></td>
<td>
<p>the value of shape parameter of gamma distributed inverce dispersion parameter (<em>phi</em>), i.e., <em>phi~Ga(a,b)</em>, so that mean(phi)=a/b and var(phi)=a/b^2</p>
</td></tr>
<tr><td><code id="MCPower_+3A_b">b</code></td>
<td>
<p>the value of rate (1/scale) parameter of gamma distributed inverce dispersion parameter (<em>phi</em>), i.e., <em>phi~Ga(a,b)</em>, so that mean(phi)=a/b and var(phi)=a/b^2</p>
</td></tr>
<tr><td><code id="MCPower_+3A_scale_min">scale_min</code></td>
<td>
<p>the smallest number of sample size scale range, 1 signifies the given data sample size (observed total counts).</p>
</td></tr>
<tr><td><code id="MCPower_+3A_scale_max">scale_max</code></td>
<td>
<p>the max number of sample size considered in power analysis. 5 by default means 5 times augmented observed counts</p>
</td></tr>
<tr><td><code id="MCPower_+3A_effect">effect</code></td>
<td>
<p>quoted effect tested by hypothesis; it should be one from the model formula, of second or higher order, introduced by * delimiter, i.e., &quot;y*x&quot;, &quot;y1*y2*x1*x2&quot;, etc.</p>
</td></tr>
<tr><td><code id="MCPower_+3A_p_alpha">p_alpha</code></td>
<td>
<p>serves to signify Z to check simulated z-scores against in power analysis, 0.05 by default</p>
</td></tr>
<tr><td><code id="MCPower_+3A_draw">draw</code></td>
<td>
<p>indicates requested number of samples</p>
</td></tr>
<tr><td><code id="MCPower_+3A_burnin">burnin</code></td>
<td>
<p>indicates requested number of initial samples to discard</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p>Performs power analysis in a given range of sample sizes (scale_min - scale_max).
</p>
</li>
<li><p>Creates object of S4 class <em>PowerClass</em>  with accessing methods
</p>
</li></ul>



<h3>Value</h3>

<p>returns object of S4 class <em>PowerClass</em> </p>


<h3>Note</h3>

<p>The inspected sample size range defined by scale_min - scale_max automatically is divided into 11 consecutive values investigated by function. Given the results one can change sample size range, for example to scrutinize some particular interval to ensure power and p-value.<br />  Function provides better conditioned variance matrix estimates against function <em>stats::glm</em> by the auspicity of NB2 dispersion parameter, coping with overdispersion in counts distribution, which is particular important for high order effects and power analysis. Particularly suggestive is to check the model fit first. Jacobian reciprocal condition number near zero indicates solution instability. If <em>chisq/n</em> &gt;&gt; 1,  the error estimates obtained from the covariance matrix will be too small and should be multiplied by square root of <em>chisq/dof</em>. Poor fit will result from the use of an inappropriate model and jeopardizes the validity of power analysis. <br /> The drawback is failure to tackle singularity of order 5 or higher of Hessian matrix. Code returns error &quot;Sorry, can't proceed with singular Hessian matrix.&quot; On such rare occasions please use ltable v.2.0.1 available for Unix (MacOS) machines. Function PowerPoisson performs log-linear and power analyses based on Levenberg-Marquardt algorithm which is distribution-free (so, Poisson in name of function is misleading). The only inconvenience is that GSL: GNU Scientific Library has to be installed first. <br /> See-saw dynamic of either power or test curves is caused by Jacobian singularity, that indicates solution instability. <br /> Flat profiles given low test or power values are indicative for insignificance of tested effect. <br /> Flat profiles with z-values above 2 or power values that exceed 0.8 are indicative for significance of tested effect. On such occasions decrease both scale parameters to inspect smaller samples.   
</p>


<h3>Author(s)</h3>

<p>Ocheredko Oleksandr
<a href="mailto:Ocheredko@yahoo.com">Ocheredko@yahoo.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+glm">glm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(ltable)
data(tdata, package="ltable")
## For better illustration You should increase draw and burnin pars
pres1&lt;-MCPower(Counts~smoker +contraceptive +tromb +contraceptive*tromb,
scale_min=0.5, scale_max=1.5, effect="contraceptive*tromb", data=tdata, 
draw=1000, burnin=300)
print(pres1, "model")
print(pres1)
plot(pres1, stencil=3)

</code></pre>

<hr>
<h2 id='plot+2CpowerClass-method'> Method for Function <code>plot</code></h2><span id='topic+plot+2CpowerClass-method'></span>

<h3>Description</h3>

<p>Method for function <code>plot</code> with <br />
<code>signature(x = "powerClass")</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'powerClass'
plot(x, stencil, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot+2B2CpowerClass-method_+3A_x">x</code></td>
<td>
<p>the name of <em>powerClass</em> object.</p>
</td></tr>
<tr><td><code id="plot+2B2CpowerClass-method_+3A_stencil">stencil</code></td>
<td>
<p>an optional arg containing 4 choices of print: missing(default), 1, 2, 3. See details.</p>
</td></tr>
<tr><td><code id="plot+2B2CpowerClass-method_+3A_...">...</code></td>
<td>
<p>not used</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The second argument <em>stencil</em> controls &quot;what and how&quot; to plot. <em>stencil=missing</em> (default) plots stand-alone images of z-score and power distributions along the range of sample sizes (see <em>print-method</em> for details on the range).<br />
<em>stencil=1</em> chooses z-score distributions to plot in stand-along fashion.<br />
<em>stencil=2</em> chooses power distributions to plot in stand-along fashion.<br />
<em>stencil=3</em> controls to plot z-score and power distributions paired alongside.<br />
Also, Q0.05, Q01, Q0.5 (median) quantiles are graphed in lines.   
</p>


<h3>Methods</h3>


<dl>
<dt><code>signature(x = "powerClass")</code></dt><dd>
<p>Method for function <code>plot</code> for object of S4 class <em>powerClass</em>.<br />
</p>
</dd>
</dl>


<h3>Examples</h3>

<pre><code class='language-R'>require(ltable)
data(tdata, package="ltable")
## For better illustration You should increase draw and burnin pars
pres&lt;-MCPower(Counts~smoker +contraceptive +tromb +  
contraceptive*tromb, scale_max=1.5, effect="contraceptive*tromb", 
data=tdata, draw=1000, burnin=300)
plot(pres)
plot(pres, stencil=3)
</code></pre>

<hr>
<h2 id='powerClass-class'>Class <code>"powerClass"</code></h2><span id='topic+powerClass-class'></span>

<h3>Description</h3>

<p>Objects of S4 class <em>powerClass</em> are exceptionally suitable for suggested approach to power analysis. Class serves a purpose of container of odds and ends of magnitude of information both on log-linear estimates and fit statistics as well as on the power analysis results, i.e., alpha and beta errors distributions across 11 sample sizes. Class also supported by getters and setters, text and graphic outputs. 
</p>


<h3>Objects from the Class</h3>

<p>Objects can be created by calls of the form <code>new("powerClass", ...)</code>.
</p>


<h3>Slots</h3>


<dl>
<dt><code>varnames</code>:</dt><dd><p>Vector of mode <code>"character"</code> lists names of columns in design matrix.</p>
</dd>
<dt><code>effectsname</code>:</dt><dd><p>Vector of mode <code>"character"</code> lists names of columns in design matrix that constitute effect under study. Latter is given by arg <em>effect</em> in function <em>PowerPoisson.</em></p>
</dd>
<dt><code>cal</code>:</dt><dd><p>Object of class <code>"call"</code> saves the function call.</p>
</dd>
<dt><code>Ntotal</code>:</dt><dd><p>Vector of mode <code>"numeric"</code>. Contains sample size of the data, scale_min, scale_max values</p>
</dd>
<dt><code>estim</code>:</dt><dd><p>Object of class <code>"list"</code> List of 11 lists of log-linear parameters estimates and model fit statistics across 11 sample sizes</p>
</dd>
<dt><code>power1</code>:</dt><dd><p>Object of class <code>"list"</code>. Contains lists for each column (contrast) of design matrix involved in effect under study. Each such list containes numeric vectors of values of simulated reg.coefficients, z-scores, power. Slot <code>power1</code> keeps the data pertaining to smallest sample size</p>
</dd>
<dt><code>power2</code>:</dt><dd><p>power2:power11 slots envelop the same structured information across consecutive sample sizes 2:11(largest).</p>
</dd>
<dt><code>power3</code>:</dt><dd><p>-//-</p>
</dd>
<dt><code>power4</code>:</dt><dd><p>-//-</p>
</dd>
<dt><code>power5</code>:</dt><dd><p>-//-</p>
</dd>
<dt><code>power6</code>:</dt><dd><p>-//-</p>
</dd>
<dt><code>power7</code>:</dt><dd><p>-//-</p>
</dd>
<dt><code>power8</code>:</dt><dd><p>-//-</p>
</dd>
<dt><code>power9</code>:</dt><dd><p>-//-</p>
</dd>
<dt><code>power10</code>:</dt><dd><p>-//-</p>
</dd>
<dt><code>power11</code>:</dt><dd><p>-//-</p>
</dd>   
</dl>


<h3>Methods</h3>


<dl>
<dt>[</dt><dd><p><code>signature(x = "powerClass", i = "character", j = "integer", drop = "logical")</code>: getter, see Method for Function <code>[</code></p>
</dd>
<dt>[&lt;-</dt><dd><p><code>signature(x = "powerClass", i = "character", j = "integer", value)</code>: setter, see Method for Function <code>[&lt;-</code></p>
</dd>
<dt>plot</dt><dd><p><code>signature(x = "powerClass")</code>: plots images of z-score and power distributions along the range of sample sizes</p>
</dd>
<dt>print</dt><dd><p><code>signature(x = "powerClass")</code>:  prints estimated log-linear model parameters and fit statistics as well as results of power analysis along the range of sample sizes</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Ocheredko Oleksandr
<a href="mailto:Ocheredko@yahoo.com">Ocheredko@yahoo.com</a>
</p>


<h3>References</h3>

<p>Ocheredko O.M. MCMC Bootstrap Based Approach to Power and Sample Size Evaluation. <a href="https://www.amazon.com/gp/product/1946728039/">https://www.amazon.com/gp/product/1946728039/</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>require(ltable)
showClass("powerClass")
new("powerClass")
data(tdata, package="ltable")
## For better illustration You should increase draw and burnin pars
pres&lt;-MCPower(Counts~smoker +contraceptive +tromb +  
contraceptive*tromb, scale_max=1.5, effect="contraceptive*tromb", 
draw=1000, burnin=300, data=tdata)
print(pres)
plot(pres,3)
pres["estim", 1]$betas
pres["power11", 1]$power
pres["power1", 1]$z
</code></pre>

<hr>
<h2 id='print+2CpowerClass-method'> Method for Function <code>print</code>  </h2><span id='topic+print+2CpowerClass-method'></span>

<h3>Description</h3>

<p>Method for function <code>print</code> with <br />
<code>signature(x = "powerClass")</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'powerClass'
print(x, choice, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print+2B2CpowerClass-method_+3A_x">x</code></td>
<td>
<p>the name of <em>powerClass</em> object.</p>
</td></tr>
<tr><td><code id="print+2B2CpowerClass-method_+3A_choice">choice</code></td>
<td>
<p>an optional arg containing two choices of print: &quot;power&quot; (by default) prints the results of power analysis, while &quot;model&quot; prints estimated log-linear model parameters and fit statistics.</p>
</td></tr>
<tr><td><code id="print+2B2CpowerClass-method_+3A_...">...</code></td>
<td>
<p>not used</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Fit statistic <em>Jacobian reciprocal condition number</em> measures the inverse sensitivity of the solution to small perturbations in the input data. It tends to zero as <em>J</em> tends to singularity indicating solution instability. <br />
The value of ch-squared per degree of freedom <em>chisq/dof</em> approximately 1 indicates a good fit. If <em>chisq/dof</em> &gt;&gt; 1  the error estimates obtained from the covariance matrix will be too small and should be multiplied by square root of <em>chisq/dof</em>. <br />
Poor fit will result from the use of an inappropriate model.<br /> 
BEWARE: Poor fit jeopardizes the validity of power analysis.
</p>


<h3>Methods</h3>


<dl>
<dt><code>signature(x = "powerClass")</code></dt><dd>
<p>Method for function <code>print</code> for object of S4 class <em>powerClass</em>.<br /> The second argument <em>choice</em> controls information to print. It's advisable to start printing with arg <em>choice=&quot;model&quot;</em>. Besides estimated log-linear model parameters, fit statistics printed for input data given arg <em>scale_min</em>=1 in function <em>PowerPoisson</em>. Otherwise, it prints results for augmented scale_min*data counts. Of particular importance is <em>Jacobian reciprocal condition number</em> and <em>chisq/dof</em>. See details.<br />
Arg <em>choice=&quot;power&quot;</em> prints results of power analysis in given range of sample size regulated by args <em>scale_min, scale_max</em> in function <em>PowerPoisson</em>. These are multiplyers for observed data counts. Range is divided into 11 even-spaced subsequent sample sizes. Each is described in printed quantiles (Q0.025, Q0.05, Q0.1, Q0.2, Q0.3, Q0.4, Q0.5) of power and z-score distributions. It's suggestive to use Q0.025 in making decision.  Given the results one can change sample size range, for example to scrutinize some particular interval to ensure power and p-value.    
</p>
</dd>
</dl>


<h3>Examples</h3>

<pre><code class='language-R'>require(ltable)
data(tdata, package="ltable")
## For better illustration You should increase draw and burnin pars
pres&lt;-MCPower(Counts~smoker +contraceptive +tromb +
contraceptive*tromb, scale_min = 0.5, scale_max=1.5, 
effect="contraceptive*tromb", data=tdata, draw=1000, burnin=300)
print(pres, "model")
print(pres, "power")

</code></pre>

<hr>
<h2 id='sdata'>
Simple Data.
</h2><span id='topic+sdata'></span>

<h3>Description</h3>

<p>This data has no other meaning and purpose except for package functionality presentation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(sdata)</code></pre>


<h3>Format</h3>

<p>A data frame with 22 observations (some values are purposely missing) on the following 4 variables.
</p>

<dl>
<dt><code>a</code></dt><dd><p>a logical vector</p>
</dd>
<dt><code>b</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>c</code></dt><dd><p>a factor with levels <code>female</code> and <code>male</code></p>
</dd>
<dt><code>d</code></dt><dd><p>a character vector with variants &quot;A&quot; and &quot;B&quot;</p>
</dd>
</dl>



<h3>Details</h3>

<p>You can construct tables with data set fields of factor, character, logical, and numeric classes.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sdata, package="ltable")
</code></pre>

<hr>
<h2 id='SimData'>
Simulated interval censored survival data to model hazard.
</h2><span id='topic+SimData'></span>

<h3>Description</h3>

<p>Simulated interval censored survival data. For details see user guide <em>ltable2.0.3.pdf</em>. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(SimData)</code></pre>


<h3>Format</h3>

<p>Description of data frames:
</p>

<p><var>Fields:</var>
</p>

<table>
<tr>
 <td style="text-align: right;">
    1. </td><td style="text-align: left;"> T </td><td style="text-align: left;"> Treatment status: 0-1 </td><td style="text-align: left;"> numeric </td>
</tr>
<tr>
 <td style="text-align: right;">
    2. </td><td style="text-align: left;"> C </td><td style="text-align: left;"> Comorbidity free status: 0-1 </td><td style="text-align: left;"> numeric </td>
</tr>
<tr>
 <td style="text-align: right;">
    3. </td><td style="text-align: left;"> Year </td><td style="text-align: left;"> Year of event: 1-3 </td><td style="text-align: left;"> numeric </td>
</tr>
<tr>
 <td style="text-align: right;">
    4. </td><td style="text-align: left;"> Counts </td><td style="text-align: left;"> Generated number of events </td><td style="text-align: left;"> numeric </td>
</tr>
<tr>
 <td style="text-align: right;">
    5. </td><td style="text-align: left;"> Year2 </td><td style="text-align: left;"> Dummy var. of Year2: 0-1 </td><td style="text-align: left;"> numeric </td>
</tr>
<tr>
 <td style="text-align: right;">
    6. </td><td style="text-align: left;"> Year3 </td><td style="text-align: left;"> Dummy var. of Year3: 0-1 </td><td style="text-align: left;"> numeric </td>
</tr>
<tr>
 <td style="text-align: right;">
    7. </td><td style="text-align: left;"> offset </td><td style="text-align: left;"> Person-years of risk </td><td style="text-align: left;"> numeric </td>
</tr>
<tr>
 <td style="text-align: right;">
                </td>
</tr>

</table>




<h3>Examples</h3>

<pre><code class='language-R'>require(ltable)
data(SimData, package="ltable")
res3&lt;-MCLogLin(Counts~Year2+Year3+T+C, offset=offset, data=SimData, draw=1500, burnin=500)
</code></pre>

<hr>
<h2 id='SMdata'>
Heart surgery data to model standardized (mortality) ratio.
</h2><span id='topic+SMdata'></span>

<h3>Description</h3>

<p>Counts of patient deaths following heart transplant surgery in 131 hospitals in the US between October 1987 and December 1989. These were analysed by Christiansen and Morris (1996, 1997). Data is also analysed by Peter D. Congdon. Data supplied with file <em>offsetdata.rda</em>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(SMdata)</code></pre>


<h3>Format</h3>

<p>Description of data frames:
</p>

<p><var>Fields:</var>
</p>

<table>
<tr>
 <td style="text-align: right;">
    1. </td><td style="text-align: left;"> y </td><td style="text-align: left;"> Number of Deaths </td><td style="text-align: left;"> numeric </td>
</tr>
<tr>
 <td style="text-align: right;">
    2. </td><td style="text-align: left;"> o </td><td style="text-align: left;"> Number of Expected Deaths </td><td style="text-align: left;"> numeric </td>
</tr>
<tr>
 <td style="text-align: right;">
                </td>
</tr>

</table>




<h3>References</h3>

<p>Peter D. Congdon. Bayesian Hierarchical Models With Applications Using R (2020) Second Edition. Example 4.5 Hospital Mortality, p.125-26.</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(ltable)
data(SMdata, package="ltable")
res2&lt;-MCLogLin(y~1, offset=o, data=SMdata, draw=1500, burnin=500, DIC=TRUE)
</code></pre>

<hr>
<h2 id='table_f'>Function <em>table_f</em></h2><span id='topic+table_f'></span>

<h3>Description</h3>

<p>Constructs tables of counts and proportions out of data sets.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>table_f(data, datavars, type=1, digits=2, extended=FALSE, MV=FALSE, cb=FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="table_f_+3A_data">data</code></td>
<td>
<p>name of the data set; object of <em>data.frame</em> class</p>
</td></tr>
<tr><td><code id="table_f_+3A_datavars">datavars</code></td>
<td>
<p>the character string that lists field names separated by comma in the order of presentation in the table: first has its sorted levels rolled out vertically leftmost, the last has its sorted levels spread by columns</p>
</td></tr>
<tr><td><code id="table_f_+3A_type">type</code></td>
<td>
<p>the type of table: 1 (default) - count table; 2 - proportions by rows; 3 - proportions by columns; 4 - frequencies</p>
</td></tr>
<tr><td><code id="table_f_+3A_digits">digits</code></td>
<td>
<p>formats output digits number, applied only to proportions, default is 2</p>
</td></tr>
<tr><td><code id="table_f_+3A_extended">extended</code></td>
<td>
<p>TRUE adds margins of counts, applied only for proportions and frequencies, FALSE by default</p>
</td></tr>
<tr><td><code id="table_f_+3A_mv">MV</code></td>
<td>
<p>includes missing values into tabulation, operates with type=1 only, FALSE by default</p>
</td></tr>
<tr><td><code id="table_f_+3A_cb">cb</code></td>
<td>
<p>TRUE permits to copy the table to clipboard,  FALSE by default</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p>You can construct table with data set fields of factor, character, logical, and numeric classes.
</p>
</li>
<li><p>To insert table into Word document first open Excel, choose left high corner of placement by mouse click and use Ctrl+V combination or click on the Paste icon (the clipboard), then use Ctrl+C, open Word document, use Ctrl+V to place the table.
</p>
</li>
<li><p>If You want to use clipboard to insert table into Word document use option cb=TRUE. You will be asked to confirm, for previous information of clipboard would be lost.
</p>
</li></ul>



<h3>Value</h3>

<p>returns object of class <em>data.frame</em> </p>


<h3>Note</h3>

<p>Abstain from putting continuous variables or too many factor variables into <em>datavars</em> list to keep table legible. Put factor variable with numerous levels at the end of the list. 
</p>


<h3>Author(s)</h3>

<p>Ocheredko Oleksandr
<a href="mailto:Ocheredko@yahoo.com">Ocheredko@yahoo.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sdata, package="ltable")
table_f(sdata, "a")
table_f(sdata, "a", MV=TRUE, extended=TRUE)
knitr::kable(table_f(sdata, "a,b,c"))
table_f(sdata, "a,b,c,d", type=2, digits=3)
table_f(sdata, "b,c,a,d", MV=TRUE, extended=TRUE, cb=TRUE)
</code></pre>

<hr>
<h2 id='tableToData'>Function <em>tableToData</em></h2><span id='topic+tableToData'></span>

<h3>Description</h3>

<p>Constructs <em>data.frames</em> that fit <em>glm{stats}</em> or <em>MCLogLin{ltable}</em>, <em>MCPower{ltable}</em> modelling out of tables created with function <em>table_f{ltable}</em>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tableToData(tname, numerictype="", orderedtype="")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tableToData_+3A_tname">tname</code></td>
<td>
<p>name of the tables created with function <em>table_f</em>; object of <em>data.frame</em> class</p>
</td></tr>
<tr><td><code id="tableToData_+3A_numerictype">numerictype</code></td>
<td>
<p>the character string that lists variable names separated by comma to be transformed to numeric class. Variable &quot;Counts&quot; shouldn't be listed</p>
</td></tr>
<tr><td><code id="tableToData_+3A_orderedtype">orderedtype</code></td>
<td>
<p>the character string that lists variable names separated by comma to be transformed to ordered factor class. Variable &quot;Counts&quot; shouldn't be listed</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p>Variables of character and logical classes shape the same design as does the factor class, therefore there is no need to change them to factors.
</p>
</li>
<li><p>Check the input and output. It's not a problem to have huge counts together with zero counts for NB2 model used in <em>ltable</em>. Still good practice to proceed with power analisis is to have data without zero counts. It's in no way detrimental as in the case of the Poisson GLM, having the mean and variance equality. The implication with Poisson GLM is that as the mean tends to zero, so must the variance. Still we do have some uncertainty about this fitted value. Of the same nature (but converse) problem is with cells of large counts.
</p>
</li>
<li><p>You can build the data by hand and skip this functionality.
</p>
</li></ul>



<h3>Value</h3>

<p>returns object of class <em>data.frame</em> </p>


<h3>Author(s)</h3>

<p>Ocheredko Oleksandr
<a href="mailto:Ocheredko@yahoo.com">Ocheredko@yahoo.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+reshape">reshape</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(ltable)
data(iris)
iriscut&lt;-with(iris, data.frame(PL=cut(Petal.Length,3),
                               PW=cut(Petal.Width,3)))
irist&lt;-table_f(iriscut,"PL,PW")
irisd&lt;-tableToData(irist, ordered="PL,PW")

</code></pre>

<hr>
<h2 id='tdata'>
Tromboembolism Data.
</h2><span id='topic+tdata'></span>

<h3>Description</h3>

<p>Case-control data first considered by Worcester, J (1971). The data cross-classify tromboembolism and control patients by two risk factors: oral contraceptive user and smoking. Test quantifies boosting effect of contraceptive on odds of tromboembolism. <br /> Data used in examples of power analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(tdata)</code></pre>


<h3>Format</h3>

<p>A grouped data frame with 8 rows of factors' levels combinations. Factors are: smoking status (Yes, No), contraceptive usage (Yes, No), thromboembolism status (Trombol, Control).
</p>

<dl>
<dt><code>smoker</code></dt><dd><p>a character vector</p>
</dd>
<dt><code>contraceptive</code></dt><dd><p>a character vector</p>
</dd>
<dt><code>tromb</code></dt><dd><p>a character vector</p>
</dd>
<dt><code>Counts</code></dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>Details</h3>

<p>One can use tables created by function <em>table_f</em> transformed with function <em>tableToData</em> to appropriate data.frame format with fields of factor, character, logical, and numeric classes. Or one can build data by hand with <em>data.frame</em> facility.
</p>


<h3>References</h3>

<p>Worcester, J (1971). The relative odds in the 2 by 3 contingency table. American Journal of Epidemiology, 93, 145-149.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(tdata, package="ltable")
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
