<!DOCTYPE html><html><head><title>Help for package aldvmm</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {aldvmm}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#aldvmm-package'><p>aldvmm: Adjusted Limited Dependent Variable Mixture Models</p></a></li>
<li><a href='#aldvmm'><p>Fitting Adjusted Limited Dependent Variable Mixture Models</p></a></li>
<li><a href='#aldvmm.check'><p>Checking the Validity of Objects Supplied to</p>
<code>aldvmm</code></a></li>
<li><a href='#aldvmm.cv'><p>Numerical Approximation of Covariance Matrix</p></a></li>
<li><a href='#aldvmm.getnames'><p>Creating Names of Parameter Vectors</p></a></li>
<li><a href='#aldvmm.getpar'><p>Extracting Parameters from Parameter Vector into Nested List.</p></a></li>
<li><a href='#aldvmm.gof'><p>Calculating Goodness of Fit Measures</p></a></li>
<li><a href='#aldvmm.gr'><p>Calculating Numeric Gradients of the Negative Log-Likelihood</p></a></li>
<li><a href='#aldvmm.init'><p>Creating Initial Values</p></a></li>
<li><a href='#aldvmm.ll'><p>Calculating the Negative Log-Likelihood of the Adjusted Limited Dependent</p>
Variable Mixture Model</a></li>
<li><a href='#aldvmm.mm'><p>Creating Design Matrices</p></a></li>
<li><a href='#aldvmm.pred'><p>Predicting Expected Values from Adjusted Limited Dependent Variable Mixture</p>
Models</a></li>
<li><a href='#aldvmm.sc'><p>Calculating analytical Gradients of the Negative Log-Likelihood for each observation</p></a></li>
<li><a href='#aldvmm.sefit'><p>Calculating Standard Errors of Fitted and Predicted Outcomes</p></a></li>
<li><a href='#aldvmm.sum'><p>Creating Summary Table</p></a></li>
<li><a href='#aldvmm.tm'><p>Creating Terms Objects</p></a></li>
<li><a href='#coef.aldvmm'><p>Extract Coefficients of Adjusted Limited Dependent Variable Mixture</p>
Model Fits</a></li>
<li><a href='#estfun.aldvmm'><p>Create Matrix of Adjusted Limited Dependent Variable Mixture Model Gradients per Observation</p></a></li>
<li><a href='#formula.aldvmm'><p>Extract Adjusted Limited Dependent Variable Mixture Model Formula</p></a></li>
<li><a href='#model.matrix.aldvmm'><p>Extract Adjusted Limited Dependent Variable Mixture Model Model Matrices</p></a></li>
<li><a href='#nobs.aldvmm'><p>Extract Adjusted Limited Dependent Variable Mixture Model Number of Observations</p></a></li>
<li><a href='#predict.aldvmm'><p>Predict Method for Adjusted Limited Dependent Variable Mixture Model Fits</p></a></li>
<li><a href='#print.aldvmm'><p>Print Adjusted Limited Dependent Variable Mixture Model Fits</p></a></li>
<li><a href='#print.summary.aldvmm'><p>Printing Adjusted Limited Dependent Variable Mixture Model Summaries</p></a></li>
<li><a href='#residuals.aldvmm'><p>Extract Adjusted Limited Dependent Variable Mixture Model Residuals</p></a></li>
<li><a href='#summary.aldvmm'><p>Summarizing Adjusted Limited Dependent Variable Mixture Model Fits</p></a></li>
<li><a href='#terms.aldvmm'><p>Extract Adjusted Limited Dependent Variable Mixture Model Terms</p></a></li>
<li><a href='#update.aldvmm'><p>Update Adjusted Limited Dependent Variable Mixture Model Fit</p></a></li>
<li><a href='#utility'><p>Simulated Example Data of Health State Utilities.</p></a></li>
<li><a href='#vcov.aldvmm'><p>Extract Adjusted Limited Dependent Variable Mixture Model Covariance Matrix</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Adjusted Limited Dependent Variable Mixture Models</td>
</tr>
<tr>
<td>Version:</td>
<td>0.8.8</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-10-26</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Description:</td>
<td>The goal of the package 'aldvmm' is to fit adjusted limited 
    dependent variable mixture models of health state utilities. Adjusted 
    limited dependent variable mixture models are finite mixtures of normal 
    distributions with an accumulation of density mass at the limits, and a gap 
    between 100% quality of life and the next smaller utility value. The 
    package 'aldvmm' uses the likelihood and expected value functions proposed 
    by Hernandez Alava and Wailoo (2015) &lt;<a href="https://doi.org/10.1177%2F1536867X1501500307">doi:10.1177/1536867X1501500307</a>&gt; using 
    normal component distributions and a multinomial logit model of 
    probabilities of component membership.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Imports:</td>
<td>numDeriv, stats, checkmate, optimx, Formula, sandwich, lmtest</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/pletschm/aldvmm/">https://github.com/pletschm/aldvmm/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/pletschm/aldvmm/issues">https://github.com/pletschm/aldvmm/issues</a></td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, kableExtra, markdown, tinytex, testthat (&ge; 3.0.0),
covr, rmarkdown, bookdown, xtable, ggplot2, scales, reshape2</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-10-26 18:52:30 UTC; Mark</td>
</tr>
<tr>
<td>Author:</td>
<td>Mark Pletscher [aut, cre, cph],
  Achim Zeileis <a href="https://orcid.org/0000-0003-0918-3766"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Mark Pletscher &lt;pletscher.mark@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-10-28 05:40:08 UTC</td>
</tr>
</table>
<hr>
<h2 id='aldvmm-package'>aldvmm: Adjusted Limited Dependent Variable Mixture Models</h2><span id='topic+aldvmm-package'></span>

<h3>Description</h3>

<p>The goal of the package 'aldvmm' is to fit adjusted limited dependent
variable mixture models of health state utilities. Adjusted limited
dependent variable mixture models are finite mixtures of normal
distributions with an accumulation of density mass at the limits, and a gap
between 100% quality of life and the next smaller utility value. The
package 'aldvmm' uses the likelihood and expected value functions proposed
by Hernandez Alava and Wailoo (2015) &lt;doi: 10.1177/1536867X1501500307&gt; using
normal component distributions and a multinomial logit model of
probabilities of component membership.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(utility)

 fit &lt;- aldvmm(eq5d ~ age + female | 1,
               data = utility,
               psi = c(0.883, -0.594),
               ncmp = 2)

 summary(fit)

 yhat &lt;- predict(fit)

</code></pre>

<hr>
<h2 id='aldvmm'>Fitting Adjusted Limited Dependent Variable Mixture Models</h2><span id='topic+aldvmm'></span>

<h3>Description</h3>

<p>The function <code><a href="#topic+aldvmm">aldvmm</a></code> fits adjusted limited dependent variable mixture models
of health state utilities. Adjusted limited dependent variable mixture
models are finite mixtures of normal distributions with an accumulation of
density mass at the limits, and a gap between 100% quality of life and
the next smaller utility value. The package <code>aldvmm</code> uses the
likelihood and expected value functions proposed by Hernandez Alava and
Wailoo (2015) using normal component distributions and a multinomial logit
model of probabilities of component membership.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aldvmm(
  formula,
  data,
  subset = NULL,
  psi,
  ncmp = 2,
  dist = "normal",
  optim.method = NULL,
  optim.control = list(trace = FALSE),
  optim.grad = TRUE,
  init.method = "zero",
  init.est = NULL,
  init.lo = NULL,
  init.hi = NULL,
  se.fit = FALSE,
  model = TRUE,
  level = 0.95,
  na.action = "na.omit"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aldvmm_+3A_formula">formula</code></td>
<td>
<p>an object of class &quot;formula&quot; with a symbolic
description of the model to be fitted. The model formula takes the form
<code>y ~ x1 + x2 | x1 + x4</code>, where the <code>|</code> delimiter separates the
model for expected values of normal distributions (left) and the
multinomial logit model of probabilities of component membership (right).</p>
</td></tr>
<tr><td><code id="aldvmm_+3A_data">data</code></td>
<td>
<p>a data frame, list or environment (or object coercible to a data
frame by 
<code><a href="base.html#topic+as.data.frame">as.data.frame</a></code>) 
including data on outcomes and explanatory variables in <code>'formula'</code>.</p>
</td></tr>
<tr><td><code id="aldvmm_+3A_subset">subset</code></td>
<td>
<p>an optional numeric vector of row indices of the subset of the model 
matrix used in the estimation. <code>'subset'</code> can be longer than the 
number of rows in <code>data</code> and include repeated values for re-sampling 
purposes.</p>
</td></tr>
<tr><td><code id="aldvmm_+3A_psi">psi</code></td>
<td>
<p>a numeric vector of minimum and maximum possible utility values
smaller than or equal to 1 (e.g. <code>c(-0.594, 0.883)</code>). The potential
gap between the maximum value and 1 represents an area with zero density
in the value set from which utilities were obtained. The order of the
minimum and maximum limits in <code>'psi'</code> does not matter.</p>
</td></tr>
<tr><td><code id="aldvmm_+3A_ncmp">ncmp</code></td>
<td>
<p>a numeric value of the number of components that are mixed. The
default value is 2. A value of 1 represents a tobit model with a gap
between 1 and the maximum value in <code>'psi'</code>.</p>
</td></tr>
<tr><td><code id="aldvmm_+3A_dist">dist</code></td>
<td>
<p>an optional character value of the distribution used in the
components. In this release, only the normal distribution is
available, and the default value is set to <code>"normal"</code>.</p>
</td></tr>
<tr><td><code id="aldvmm_+3A_optim.method">optim.method</code></td>
<td>
<p>an optional character value of one of the following
<code><a href="optimx.html#topic+optimr">optimr</a></code>
methods: <code>"Nelder-Mead"</code>, <code>"BFGS"</code>, <code>"CG"</code>,
<code>"L-BFGS-B"</code>, <code>"nlminb"</code>, <code>"Rcgmin"</code>, <code>"Rvmmin"</code> and
<code>"hjn"</code>. The default method is <code>"BFGS"</code>. The method
<code>"L-BFGS-B"</code> is used when lower and/or upper constraints are set
using <code>'init.lo'</code> and <code>'init.hi'</code>. The method <code>"nlm"</code>
cannot be used in the <code>'aldvmm'</code> package.</p>
</td></tr>
<tr><td><code id="aldvmm_+3A_optim.control">optim.control</code></td>
<td>
<p>an optional list of
<code><a href="optimx.html#topic+optimr">optimr</a></code>
control parameters.</p>
</td></tr>
<tr><td><code id="aldvmm_+3A_optim.grad">optim.grad</code></td>
<td>
<p>an optional logical value indicating if an analytical
gradient should be used in
<code><a href="optimx.html#topic+optimr">optimr</a></code>
methods that can use this information. The default value is <code>TRUE</code>.
If <code>'optim.grad'</code> is set to <code>FALSE</code>, a finite difference
approximation is used.</p>
</td></tr>
<tr><td><code id="aldvmm_+3A_init.method">init.method</code></td>
<td>
<p>an optional character value indicating the method for
obtaining initial values. The following values are available:
<code>"zero"</code>, <code>"random"</code>, <code>"constant"</code> and <code>"sann"</code>. The
default value is <code>"zero"</code>.</p>
</td></tr>
<tr><td><code id="aldvmm_+3A_init.est">init.est</code></td>
<td>
<p>an optional numeric vector of user-defined initial values.
User-defined initial values override the <code>'init.method'</code> argument.
Initial values have to follow the same order as parameter estimates in the
return value <code>'coef'</code>.</p>
</td></tr>
<tr><td><code id="aldvmm_+3A_init.lo">init.lo</code></td>
<td>
<p>an optional numeric vector of user-defined lower limits for
constrained optimization. When <code>'init.lo'</code> is not <code>NULL</code>, the
optimization method <code>"L-BFGS-B"</code> is used. Lower limits of parameters
have to follow the same order as parameter estimates in the return value
<code>'coef'</code>.</p>
</td></tr>
<tr><td><code id="aldvmm_+3A_init.hi">init.hi</code></td>
<td>
<p>an optional numeric vector of user-defined upper limits for
constrained optimization. When <code>'init.hi'</code> is not <code>NULL</code>, the
optimization method <code>"L-BFGS-B"</code> is used. Upper limits of parameters
have to follow the same order as parameter estimates in the return value
<code>'coef'</code>.</p>
</td></tr>
<tr><td><code id="aldvmm_+3A_se.fit">se.fit</code></td>
<td>
<p>an optional logical value indicating whether standard errors
of fitted values are calculated. The default value is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="aldvmm_+3A_model">model</code></td>
<td>
<p>an optional logical value indicating whether the estimation 
data frame is returned in the output object. The default value is 
<code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="aldvmm_+3A_level">level</code></td>
<td>
<p>a numeric value of the significance level for confidence bands
of fitted values. The default value is 0.95.</p>
</td></tr>
<tr><td><code id="aldvmm_+3A_na.action">na.action</code></td>
<td>
<p>a character value passed to 
argument <code>'na.action'</code> of the function 
<code><a href="stats.html#topic+model.frame">model.frame</a></code> 
in the preparation of the model matrix. The default value is 
<code>"na.omit"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code><a href="#topic+aldvmm">aldvmm</a></code> fits
an adjusted limited dependent variable mixture model using the likelihood
and expected value functions from Hernandez Alava and Wailoo (2015).  The
model accounts for latent classes, multi-modality, minimum and maximum
utility values and potential gaps between 1 and the next smaller utility
value.  Adjusted limited dependent variable mixture models combine
multiple component distributions with a multinomial logit model of the
probabilities of component membership. The standard deviations of normal
distributions are estimated and reported as log-transformed values which
enter the likelihood function as exponentiated values to ensure
non-negative values.
</p>
<p>The minimum utility and the largest utility smaller than or equal to 1 are
supplied in the argument <code>'psi'</code>.  The number of
distributions/components that are mixed is set by the argument
<code>'ncmp'</code>. When <code>'ncmp'</code> is set to 1 the procedure estimates a
tobit model with a gap between 1 and the maximum utility value in
<code>'psi'</code>.  The current version only allows finite mixtures of normal
distributions.
</p>
<p>The <code>'formula'</code> object can include a <code>|</code> delimiter to separate
formulae for expected values in components (left) and the multinomial
logit model of probabilities of group membership (right).  If no <code>|</code>
delimiter is used, the same formula will be used for expected values in
components and the multinomial logit of the probabilities of component
membership.
</p>
<p><code><a href="#topic+aldvmm">aldvmm</a></code> uses
<code><a href="optimx.html#topic+optimr">optimr</a></code> for
maximum likelihood estimation of model parameters.  The argument
<code>'optim.method'</code> accepts the following methods: <code>"Nelder-Mead"</code>,
<code>"BFGS"</code>, <code>"CG"</code>, <code>"L-BFGS-B"</code>, <code>"nlminb"</code>,
<code>"Rcgmin"</code>, <code>"Rvmmin"</code> and <code>"hjn"</code>. The default method is
<code>"BFGS"</code>.  The method <code>"nlm"</code> cannot be used in
<code><a href="#topic+aldvmm">aldvmm</a></code> because it
requires a different implementation of the likelihood function. The
argument <code>'optim.control'</code> accepts a list of
<code><a href="optimx.html#topic+optimr">optimr</a></code>
control parameters.  If <code>'optim.grad'</code> is set to <code>TRUE</code> the
function
<code><a href="optimx.html#topic+optimr">optimr</a></code> uses
analytical gradients during the optimization procedure for all methods 
that allow for this approach. If <code>'optim.grad'</code> is set to 
<code>FALSE</code> or a method cannot use gradients, a finite difference 
approximation is used. The hessian matrix at maximum likelihood parameters 
is approximated numerically using 
<code><a href="numDeriv.html#topic+hessian">hessian</a></code>.
</p>
<p><code>'init.method'</code> accepts four values of methods for generating initial
values: <code>"zero"</code>, <code>"random"</code>, <code>"constant"</code>, <code>"sann"</code>.
The method <code>"zero"</code> sets initial values of all parameters to 0. The
method <code>"random"</code> draws random starting values from a standard normal
distribution.  The method <code>"constant"</code> estimates a constant-only
model and uses estimates as initial values of intercepts and standard
errors and 0 for all other parameters.  The method <code>"sann"</code> estimates
the full model using the simulated annealing optimization method in
<code><a href="stats.html#topic+optim">optim</a></code> and uses
parameter estimates as initial values.  When user-specified initial values
are supplied in <code>'init.est'</code>, the argument <code>'init.method'</code> is
ignored.
</p>
<p>By default, <code><a href="#topic+aldvmm">aldvmm</a></code>
performs unconstrained optimization with upper and lower limits at
<code>-Inf</code> and <code>Inf</code>.  When user-defined lower and upper limits are
supplied to <code>'init.lo'</code> and/or <code>'init.hi'</code>, these default limits
are replaced with the user-specified values, and the method
<code>"L-BFGS-B"</code> is used for box-constrained optimization instead of the
user defined <code>'optim.method'</code>.  It is possible to only set either
maximum or minimum limits.  When initial values supplied to 
<code>'init.est'</code> or from default methods lie outside the limits, the 
in-feasible values will be set to the limits using the function 
<code><a href="optimx.html#topic+bmchk">bmchk</a></code>.
</p>
<p>The function <code>aldvmm()</code> returns the negative log-likelihood, Akaike 
information criterion and Bayesian information criterion. Smaller values 
of these measures indicate better fit.
</p>
<p>If <code>'se.fit'</code> is set to <code>TRUE</code>, standard errors of fitted values
are calculated using the delta method.  The standard errors of fitted
values in the estimation data set are calculated as <code class="reqn">se_{fit} =
  \sqrt{G^{t} \Sigma G}</code>, where <code class="reqn">G</code>
is the gradient of a fitted value with respect to changes of parameter
estimates, and <code class="reqn">\Sigma</code> is the estimated covariance matrix of
parameters (Dowd et al., 2014).  The standard errors of predicted values
in new data sets are calculated as <code class="reqn">se_{pred} = \sqrt{MSE + G^{t}
  \Sigma G}</code>, where
<code class="reqn">MSE</code> is the mean squared error of fitted versus observed
outcomes in the original estimation data (Whitmore, 1986).
</p>
<p>The generic function
<code><a href="base.html#topic+summary">summary</a></code> can be
used to obtain or print a summary of the results. The generic function
<code><a href="stats.html#topic+predict">predict</a></code> can
be used to obtain predicted values and standard errors of predictions in
new data.
</p>


<h3>Value</h3>

<p><code><a href="#topic+aldvmm">aldvmm</a></code>
returns an object of class &quot;aldvmm&quot;. An object of class
&quot;aldvmm&quot; is a list containing the following objects. </p>
<table>
<tr><td><code>coef</code></td>
<td>
<p>a
numeric vector of parameter estimates.</p>
</td></tr> <tr><td><code>hessian</code></td>
<td>
<p>a numeric 
matrix object with second partial derivatives of the likelihood function.</p>
</td></tr>
<tr><td><code>cov</code></td>
<td>
<p>a numeric matrix object with covariances of parameters.</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>a scalar representing the number of observations that were 
used in the estimation.</p>
</td></tr>
<tr><td><code>k</code></td>
<td>
<p>a scalar representing the number of components that were
mixed.</p>
</td></tr>
<tr><td><code>df.null</code></td>
<td>
<p>an integer value of the residual 
degrees of freedom of a null model including intercepts and standard 
errors.</p>
</td></tr>
<tr><td><code>df.residual</code></td>
<td>
<p>an integer value of the residual 
degrees of freedom..</p>
</td></tr>
<tr><td><code>iter</code></td>
<td>
<p>an integer value of the number of iterations used in 
optimization.</p>
</td></tr>
<tr><td><code>convergence</code></td>
<td>
<p>an integer value indicating convergence. &quot;0&quot; 
indicates successful completion.</p>
</td></tr>
<tr><td><code>gof</code></td>
<td>
<p>a list including the following elements. </p>

<dl>
<dt><code>ll</code></dt><dd><p>a numeric value of the negative log-likelihood
<code class="reqn">-ll</code>.</p>
</dd> 
<dt><code>aic</code></dt><dd><p>a numeric value of the Akaike information
criterion <code class="reqn">AIC = 2n_{par} - 2ll</code>.</p>
</dd>
<dt><code>bic</code></dt><dd><p>a numeric value of the Bayesian information criterion
<code class="reqn">BIC = n_{par}*log(n_{obs}) - 2ll</code>.</p>
</dd>
<dt><code>mse</code></dt><dd><p>a numeric value of the mean squared error <code class="reqn">\sum{(y -
  \hat{y})^2}/(n_{obs} - n_{par})</code>.</p>
</dd>
<dt><code>mae</code></dt><dd><p>a numeric value of the mean absolute error <code class="reqn">\sum{|y
  - \hat{y}|}/(n_{obs} - n_{par})</code>.</p>
</dd></dl>
</td></tr>
<tr><td><code>pred</code></td>
<td>
<p>a list including the following elements. </p>

<dl>
<dt><code>y</code></dt><dd><p>a numeric vector of observed outcomes in <code>'data'</code>.</p>
</dd>
<dt><code>yhat</code></dt><dd><p>a numeric vector of fitted values.</p>
</dd> <dt><code>res</code></dt><dd><p>a
numeric vector of residuals.</p>
</dd> <dt><code>se.fit</code></dt><dd><p>a numeric vector of the
standard error of fitted values.</p>
</dd> <dt><code>lower.fit</code></dt><dd><p>a numeric vector
of 95% lower confidence limits of fitted values.</p>
</dd>
<dt><code>upper.fit</code></dt><dd><p>a numeric vector of 95% upper confidence limits
of fitted values</p>
</dd> <dt><code>prob</code></dt><dd><p>a numeric matrix of expected 
probabilities of group membership per individual in <code>'data'</code>.</p>
</dd> </dl>
</td></tr>
<tr><td><code>init</code></td>
<td>
<p>a list including the following elements. </p>

<dl>
<dt><code>est</code></dt><dd><p>a numeric vector of initial parameter estimates.</p>
</dd>
<dt><code>lo</code></dt><dd><p>a numeric vector of lower limits of parameter estimates.</p>
</dd>
<dt><code>hi</code></dt><dd><p>a numeric vector of upper limits of parameter
estimates.</p>
</dd></dl>
 </td></tr>
<tr><td><code>call</code></td>
<td>
<p>a character value including the model call captured by
<code><a href="base.html#topic+match.call">match.call</a></code>.</p>
</td></tr>
<tr><td><code>formula</code></td>
<td>
<p>an object of class &quot;formula&quot; supplied to argument 
<code>'formula'</code>.</p>
</td></tr>
<tr><td><code>terms</code></td>
<td>
<p>a list of objects of class &quot;terms&quot; for the 
model of component means (&quot;beta&quot;), probabilities of component membership 
(&quot;delta&quot;) and the full model (&quot;full&quot;).</p>
</td></tr>
<tr><td><code>contrasts</code></td>
<td>
<p>a nested list of character values showing 
contrasts of factors used in models of component means (&quot;beta&quot;) and 
probabilities of component membership (&quot;delta&quot;).</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>a data frame created by 
<code><a href="stats.html#topic+model.frame">model.frame</a></code> 
including estimation data with additional attributes.</p>
</td></tr>
<tr><td><code>psi</code></td>
<td>
<p>a numeric vector with the minimum and maximum utility
below 1 in <code>'data'</code>.</p>
</td></tr>
<tr><td><code>dist</code></td>
<td>
<p>a character value indicating the used component 
distributions.</p>
</td></tr>
<tr><td><code>label</code></td>
<td>
<p>a list including the following elements. </p>

<dl>
<dt><code>lcoef</code></dt><dd><p>a character vector of labels for objects including
results on distributions (default <code>"beta"</code>) and the probabilities of
component membership (default <code>"delta"</code>).</p>
</dd> <dt><code>lcpar</code></dt><dd><p>a
character vector of labels for objects including constant distribution
parameters (default <code>"sigma"</code> for <code>dist = "normal"</code>).</p>
</dd>
<dt><code>lcmp</code></dt><dd><p>a character value of the label for objects including
results on different components (default &quot;Comp&quot;)</p>
</dd> <dt><code>lvar</code></dt><dd><p>a
list including 2 character vectors of covariate names for model parameters
of distributions (<code>"beta"</code>) and the multinomial logit
(<code>"delta"</code>).</p>
</dd> </dl>
 </td></tr>
<tr><td><code>optim.method</code></td>
<td>
<p>a character value of the used
<code><a href="optimx.html#topic+optimr">optimr</a></code>
method.</p>
</td></tr>
<tr><td><code>level</code></td>
<td>
<p>a numeric value of the confidence level used for 
reporting.</p>
</td></tr>
<tr><td><code>na.action</code></td>
<td>
<p>an object of class &quot;omit&quot; extracted from the 
&quot;na.action&quot; attribute of the data frame created by 
<code><a href="stats.html#topic+model.frame">model.frame</a></code> 
in the preparation of model matrices.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Alava, M. H. and Wailoo, A. (2015) Fitting adjusted limited
dependent variable mixture models to EQ-5D. <em>The Stata Journal</em>,
<b>15(3)</b>, 737&ndash;750. <a href="https://doi.org/10.1177/1536867X1501500307">doi:10.1177/1536867X1501500307</a>
</p>
<p>Dowd, B. E., Greene, W. H., and Norton, E. C. (2014) Computation of
standard errors. <em>Health services research</em>, <b>49(2)</b>, 731&ndash;750.
<a href="https://doi.org/10.1111/1475-6773.12122">doi:10.1111/1475-6773.12122</a>
</p>
<p>Whitmore, G. A. (1986) Prediction limits for a univariate normal
observation. <em>The American Statistician</em>, <b>40(2)</b>, 141&ndash;143.
<a href="https://doi.org/10.1080/00031305.1986.10475378">doi:10.1080/00031305.1986.10475378</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(utility)

 fit &lt;- aldvmm(eq5d ~ age + female | 1,
               data = utility,
               psi = c(0.883, -0.594),
               ncmp = 2)

 summary(fit)

 yhat &lt;- predict(fit)

</code></pre>

<hr>
<h2 id='aldvmm.check'>Checking the Validity of Objects Supplied to
<code><a href="#topic+aldvmm">aldvmm</a></code></h2><span id='topic+aldvmm.check'></span>

<h3>Description</h3>

<p><code><a href="#topic+aldvmm.check">aldvmm.check</a></code>
runs validity checks of objects supplied to
<code><a href="#topic+aldvmm">aldvmm</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aldvmm.check(
  formula,
  data,
  subset,
  psi,
  ncmp,
  dist,
  optim.method,
  optim.control,
  optim.grad,
  init.method,
  init.est,
  init.lo,
  init.hi,
  se.fit,
  model,
  level,
  na.action,
  lcoef,
  lcpar,
  lcmp
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aldvmm.check_+3A_formula">formula</code></td>
<td>
<p>an object of class &quot;formula&quot; with a symbolic
description of the model to be fitted. The model formula takes the form
<code>y ~ x1 + x2 | x1 + x4</code>, where the <code>|</code> delimiter separates the
model for expected values of normal distributions (left) and the
multinomial logit model of probabilities of component membership (right).</p>
</td></tr>
<tr><td><code id="aldvmm.check_+3A_data">data</code></td>
<td>
<p>a data frame, list or environment (or object coercible to a data
frame by 
<code><a href="base.html#topic+as.data.frame">as.data.frame</a></code>) 
including data on outcomes and explanatory variables in <code>'formula'</code>.</p>
</td></tr>
<tr><td><code id="aldvmm.check_+3A_subset">subset</code></td>
<td>
<p>an optional numeric vector of row indices of the subset of the model 
matrix used in the estimation. <code>'subset'</code> can be longer than the 
number of rows in <code>data</code> and include repeated values for re-sampling 
purposes.</p>
</td></tr>
<tr><td><code id="aldvmm.check_+3A_psi">psi</code></td>
<td>
<p>a numeric vector of minimum and maximum possible utility values
smaller than or equal to 1 (e.g. <code>c(-0.594, 0.883)</code>). The potential
gap between the maximum value and 1 represents an area with zero density
in the value set from which utilities were obtained. The order of the
minimum and maximum limits in <code>'psi'</code> does not matter.</p>
</td></tr>
<tr><td><code id="aldvmm.check_+3A_ncmp">ncmp</code></td>
<td>
<p>a numeric value of the number of components that are mixed. The
default value is 2. A value of 1 represents a tobit model with a gap
between 1 and the maximum value in <code>'psi'</code>.</p>
</td></tr>
<tr><td><code id="aldvmm.check_+3A_dist">dist</code></td>
<td>
<p>an optional character value of the distribution used in the
components. In this release, only the normal distribution is
available, and the default value is set to <code>"normal"</code>.</p>
</td></tr>
<tr><td><code id="aldvmm.check_+3A_optim.method">optim.method</code></td>
<td>
<p>an optional character value of one of the following
<code><a href="optimx.html#topic+optimr">optimr</a></code>
methods: <code>"Nelder-Mead"</code>, <code>"BFGS"</code>, <code>"CG"</code>,
<code>"L-BFGS-B"</code>, <code>"nlminb"</code>, <code>"Rcgmin"</code>, <code>"Rvmmin"</code> and
<code>"hjn"</code>. The default method is <code>"BFGS"</code>. The method
<code>"L-BFGS-B"</code> is used when lower and/or upper constraints are set
using <code>'init.lo'</code> and <code>'init.hi'</code>. The method <code>"nlm"</code>
cannot be used in the <code>'aldvmm'</code> package.</p>
</td></tr>
<tr><td><code id="aldvmm.check_+3A_optim.control">optim.control</code></td>
<td>
<p>an optional list of
<code><a href="optimx.html#topic+optimr">optimr</a></code>
control parameters.</p>
</td></tr>
<tr><td><code id="aldvmm.check_+3A_optim.grad">optim.grad</code></td>
<td>
<p>an optional logical value indicating if an analytical
gradient should be used in
<code><a href="optimx.html#topic+optimr">optimr</a></code>
methods that can use this information. The default value is <code>TRUE</code>.
If <code>'optim.grad'</code> is set to <code>FALSE</code>, a finite difference
approximation is used.</p>
</td></tr>
<tr><td><code id="aldvmm.check_+3A_init.method">init.method</code></td>
<td>
<p>an optional character value indicating the method for
obtaining initial values. The following values are available:
<code>"zero"</code>, <code>"random"</code>, <code>"constant"</code> and <code>"sann"</code>. The
default value is <code>"zero"</code>.</p>
</td></tr>
<tr><td><code id="aldvmm.check_+3A_init.est">init.est</code></td>
<td>
<p>an optional numeric vector of user-defined initial values.
User-defined initial values override the <code>'init.method'</code> argument.
Initial values have to follow the same order as parameter estimates in the
return value <code>'coef'</code>.</p>
</td></tr>
<tr><td><code id="aldvmm.check_+3A_init.lo">init.lo</code></td>
<td>
<p>an optional numeric vector of user-defined lower limits for
constrained optimization. When <code>'init.lo'</code> is not <code>NULL</code>, the
optimization method <code>"L-BFGS-B"</code> is used. Lower limits of parameters
have to follow the same order as parameter estimates in the return value
<code>'coef'</code>.</p>
</td></tr>
<tr><td><code id="aldvmm.check_+3A_init.hi">init.hi</code></td>
<td>
<p>an optional numeric vector of user-defined upper limits for
constrained optimization. When <code>'init.hi'</code> is not <code>NULL</code>, the
optimization method <code>"L-BFGS-B"</code> is used. Upper limits of parameters
have to follow the same order as parameter estimates in the return value
<code>'coef'</code>.</p>
</td></tr>
<tr><td><code id="aldvmm.check_+3A_se.fit">se.fit</code></td>
<td>
<p>an optional logical value indicating whether standard errors
of fitted values are calculated. The default value is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="aldvmm.check_+3A_model">model</code></td>
<td>
<p>an optional logical value indicating whether the estimation 
data frame is returned in the output object. The default value is 
<code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="aldvmm.check_+3A_level">level</code></td>
<td>
<p>a numeric value of the significance level for confidence bands
of fitted values. The default value is 0.95.</p>
</td></tr>
<tr><td><code id="aldvmm.check_+3A_na.action">na.action</code></td>
<td>
<p>a character value passed to 
argument <code>'na.action'</code> of the function 
<code><a href="stats.html#topic+model.frame">model.frame</a></code> 
in the preparation of the model matrix. The default value is 
<code>"na.omit"</code>.</p>
</td></tr>
<tr><td><code id="aldvmm.check_+3A_lcoef">lcoef</code></td>
<td>
<p>a character vector of length 2 with labels of objects including
regression coefficients of component distributions (default <code>"beta"</code>)
and coefficients of probabilities of component membership (default
<code>"delta"</code>).</p>
</td></tr>
<tr><td><code id="aldvmm.check_+3A_lcpar">lcpar</code></td>
<td>
<p>a character vector with the labels of objects including
constant parameters of component distributions (e.g. the standard
deviation of the normal distribution). The length of <code>'lcpar'</code>
depends on the distribution supplied to <code>'dist'</code>.</p>
</td></tr>
<tr><td><code id="aldvmm.check_+3A_lcmp">lcmp</code></td>
<td>
<p>a character value representing a stub (default <code>"Comp"</code>)
for labeling objects including regression coefficients in different
components (e.g. &quot;Comp1&quot;, &quot;Comp2&quot;, ...). This label is also used in
summary tables returned by
<code><a href="#topic+summary.aldvmm">summary.aldvmm</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code><a href="#topic+aldvmm.check">aldvmm.check</a></code>
checks the validity of arguments of
<code><a href="#topic+aldvmm">aldvmm</a></code>.
</p>


<h3>Value</h3>

<p><code>aldvmm.check</code> returns warnings or stops the execution of
<code><a href="#topic+aldvmm">aldvmm</a></code> if validity
checks fail.
</p>

<hr>
<h2 id='aldvmm.cv'>Numerical Approximation of Covariance Matrix</h2><span id='topic+aldvmm.cv'></span>

<h3>Description</h3>

<p><code><a href="#topic+aldvmm.cv">aldvmm.cv</a></code> performs
a numerical approximation of the covariance matrix of parameter estimates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aldvmm.cv(ll, par, X, y, dist, psi, ncmp, lcoef, lcpar, lcmp, optim.method)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aldvmm.cv_+3A_ll">ll</code></td>
<td>
<p>a function returning the negative log-likelihood of the adjusted
limited dependent variable mixture model as a scalar result
(<code><a href="#topic+aldvmm.ll">aldvmm.ll</a></code>).</p>
</td></tr>
<tr><td><code id="aldvmm.cv_+3A_par">par</code></td>
<td>
<p>a named numeric vector of parameter values.</p>
</td></tr>
<tr><td><code id="aldvmm.cv_+3A_x">X</code></td>
<td>
<p>a list of design matrices returned by
<code><a href="#topic+aldvmm.mm">aldvmm.mm</a></code>.
<code>'X'</code> is of length 2 and includes a design matrix for the model of
component distributions and a design matrix for the model of probabilities
of group membership.</p>
</td></tr>
<tr><td><code id="aldvmm.cv_+3A_y">y</code></td>
<td>
<p>a numeric vector of observed outcomes from complete observations in
<code>'data'</code> supplied to
<code><a href="#topic+aldvmm">aldvmm</a></code>.</p>
</td></tr>
<tr><td><code id="aldvmm.cv_+3A_dist">dist</code></td>
<td>
<p>an optional character value of the distribution used in the
components. In this release, only the normal distribution is
available, and the default value is set to <code>"normal"</code>.</p>
</td></tr>
<tr><td><code id="aldvmm.cv_+3A_psi">psi</code></td>
<td>
<p>a numeric vector of minimum and maximum possible utility values
smaller than or equal to 1 (e.g. <code>c(-0.594, 0.883)</code>). The potential
gap between the maximum value and 1 represents an area with zero density
in the value set from which utilities were obtained. The order of the
minimum and maximum limits in <code>'psi'</code> does not matter.</p>
</td></tr>
<tr><td><code id="aldvmm.cv_+3A_ncmp">ncmp</code></td>
<td>
<p>a numeric value of the number of components that are mixed. The
default value is 2. A value of 1 represents a tobit model with a gap
between 1 and the maximum value in <code>'psi'</code>.</p>
</td></tr>
<tr><td><code id="aldvmm.cv_+3A_lcoef">lcoef</code></td>
<td>
<p>a character vector of length 2 with labels of objects including
regression coefficients of component distributions (default <code>"beta"</code>)
and coefficients of probabilities of component membership (default
<code>"delta"</code>).</p>
</td></tr>
<tr><td><code id="aldvmm.cv_+3A_lcpar">lcpar</code></td>
<td>
<p>a character vector with the labels of objects including
constant parameters of component distributions (e.g. the standard
deviation of the normal distribution). The length of <code>'lcpar'</code>
depends on the distribution supplied to <code>'dist'</code>.</p>
</td></tr>
<tr><td><code id="aldvmm.cv_+3A_lcmp">lcmp</code></td>
<td>
<p>a character value representing a stub (default <code>"Comp"</code>)
for labeling objects including regression coefficients in different
components (e.g. &quot;Comp1&quot;, &quot;Comp2&quot;, ...). This label is also used in
summary tables returned by
<code><a href="#topic+summary.aldvmm">summary.aldvmm</a></code>.</p>
</td></tr>
<tr><td><code id="aldvmm.cv_+3A_optim.method">optim.method</code></td>
<td>
<p>an optional character value of one of the following
<code><a href="optimx.html#topic+optimr">optimr</a></code>
methods: <code>"Nelder-Mead"</code>, <code>"BFGS"</code>, <code>"CG"</code>,
<code>"L-BFGS-B"</code>, <code>"nlminb"</code>, <code>"Rcgmin"</code>, <code>"Rvmmin"</code> and
<code>"hjn"</code>. The default method is <code>"BFGS"</code>. The method
<code>"L-BFGS-B"</code> is used when lower and/or upper constraints are set
using <code>'init.lo'</code> and <code>'init.hi'</code>. The method <code>"nlm"</code>
cannot be used in the <code>'aldvmm'</code> package.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code><a href="#topic+aldvmm.cv">aldvmm.cv</a></code>
uses
<code><a href="numDeriv.html#topic+hessian">hessian</a></code>
to calculate the hessian matrix of the log-likelihood function supplied to
<code>'ll'</code> at parameter values supplied to <code>'par'</code>.
</p>


<h3>Value</h3>

<p><code>aldvmm.cv</code> returns a list with the following objects.
</p>
<table>
<tr><td><code>hessian</code></td>
<td>
<p>a numeric matrix with second-order partial
derivatives of the likelihood function <code>'ll'</code>.</p>
</td></tr> <tr><td><code>cv</code></td>
<td>
<p>a
numeric matrix with covariances/variances of parameters in <code>'par'</code>.</p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p>a numeric vector of standard errors of parameters in
<code>'par'</code>.</p>
</td></tr> <tr><td><code>z</code></td>
<td>
<p>a numeric vector of z-values of parameters
in <code>'par'</code>.</p>
</td></tr> <tr><td><code>p</code></td>
<td>
<p>a numeric vector of p-values of
parameter estimates.</p>
</td></tr> <tr><td><code>upper</code></td>
<td>
<p>a numeric vector of upper 95%
confidence limits of parameter estimates in <code>'par'</code>.</p>
</td></tr>
<tr><td><code>lower</code></td>
<td>
<p>a numeric vector of lower 95% confidence limits of
parameter estimates in <code>'par'</code>.</p>
</td></tr>
</table>

<hr>
<h2 id='aldvmm.getnames'>Creating Names of Parameter Vectors</h2><span id='topic+aldvmm.getnames'></span>

<h3>Description</h3>

<p><code><a href="#topic+aldvmm.getnames">aldvmm.getnames</a></code>
creates names of parameter vectors used in
<code><a href="#topic+aldvmm">aldvmm</a></code>. The order of
the elements in <code>'lcoef'</code> and <code>'lcpar'</code> determines the order of
parameters and the structure of summary tables returned by
<code><a href="#topic+summary.aldvmm">summary.aldvmm</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aldvmm.getnames(X, names, lcoef, lcpar, lcmp, ncmp)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aldvmm.getnames_+3A_x">X</code></td>
<td>
<p>a list of design matrices returned by
<code><a href="#topic+aldvmm.mm">aldvmm.mm</a></code>.
<code>'X'</code> is of length 2 and includes a design matrix for the model of
component distributions and a design matrix for the model of probabilities
of group membership.</p>
</td></tr>
<tr><td><code id="aldvmm.getnames_+3A_names">names</code></td>
<td>
<p>a character vector of names of considered elements
(distributions <code>"beta"</code>, multinomial logit <code>"delta"</code> or constant
distribution parameters, i.e. <code>"lnsigma"</code>). The elements in
<code>'names'</code> are combined with covariate names in <code>'X'</code> and
component labels in <code>'lcmp'</code> to create a vector of names of parameter
vectors.</p>
</td></tr>
<tr><td><code id="aldvmm.getnames_+3A_lcoef">lcoef</code></td>
<td>
<p>a character vector of length 2 with labels of objects including
regression coefficients of component distributions (default <code>"beta"</code>)
and coefficients of probabilities of component membership (default
<code>"delta"</code>).</p>
</td></tr>
<tr><td><code id="aldvmm.getnames_+3A_lcpar">lcpar</code></td>
<td>
<p>a character vector with the labels of objects including
constant parameters of component distributions (e.g. the standard
deviation of the normal distribution). The length of <code>'lcpar'</code>
depends on the distribution supplied to <code>'dist'</code>.</p>
</td></tr>
<tr><td><code id="aldvmm.getnames_+3A_lcmp">lcmp</code></td>
<td>
<p>a character value representing a stub (default <code>"Comp"</code>)
for labeling objects including regression coefficients in different
components (e.g. &quot;Comp1&quot;, &quot;Comp2&quot;, ...). This label is also used in
summary tables returned by
<code><a href="#topic+summary.aldvmm">summary.aldvmm</a></code>.</p>
</td></tr>
<tr><td><code id="aldvmm.getnames_+3A_ncmp">ncmp</code></td>
<td>
<p>a numeric value of the number of components that are mixed. The
default value is 2. A value of 1 represents a tobit model with a gap
between 1 and the maximum value in <code>'psi'</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a character vector of names of parameter vectors used in
<code><a href="#topic+aldvmm">aldvmm</a></code>.
</p>

<hr>
<h2 id='aldvmm.getpar'>Extracting Parameters from Parameter Vector into Nested List.</h2><span id='topic+aldvmm.getpar'></span>

<h3>Description</h3>

<p><code>aldvmm.getpar()</code> extracts parameters from parameter vectors into nested
lists.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aldvmm.getpar(par, lcoef, lcmp, lcpar, ncmp)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aldvmm.getpar_+3A_par">par</code></td>
<td>
<p>a named numeric vector of parameter values.</p>
</td></tr>
<tr><td><code id="aldvmm.getpar_+3A_lcoef">lcoef</code></td>
<td>
<p>a character vector of length 2 with labels of objects including
regression coefficients of component distributions (default <code>"beta"</code>)
and coefficients of probabilities of component membership (default
<code>"delta"</code>).</p>
</td></tr>
<tr><td><code id="aldvmm.getpar_+3A_lcmp">lcmp</code></td>
<td>
<p>a character value representing a stub (default <code>"Comp"</code>)
for labeling objects including regression coefficients in different
components (e.g. &quot;Comp1&quot;, &quot;Comp2&quot;, ...). This label is also used in
summary tables returned by
<code><a href="#topic+summary.aldvmm">summary.aldvmm</a></code>.</p>
</td></tr>
<tr><td><code id="aldvmm.getpar_+3A_lcpar">lcpar</code></td>
<td>
<p>a character vector with the labels of objects including
constant parameters of component distributions (e.g. the standard
deviation of the normal distribution). The length of <code>'lcpar'</code>
depends on the distribution supplied to <code>'dist'</code>.</p>
</td></tr>
<tr><td><code id="aldvmm.getpar_+3A_ncmp">ncmp</code></td>
<td>
<p>a numeric value of the number of components that are mixed. The
default value is 2. A value of 1 represents a tobit model with a gap
between 1 and the maximum value in <code>'psi'</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code><a href="#topic+aldvmm.getpar">aldvmm.getpar</a></code>
identifies parameters that belong to coefficients of component distributions
(label <code>"beta"</code>), coefficients of the multinomial logit model of
probabilities of component membership (label <code>"delta"</code>), constant
parameters of component distributions (label <code>"lnsigma"</code> for
<code>dist=="normal"</code>), and <code>1:K</code> components (labels &quot;Comp1&quot; ...
&quot;CompK&quot;)) based on parameter names generated by
<code><a href="#topic+aldvmm.getnames">aldvmm.getnames</a></code>.
</p>


<h3>Value</h3>

<p>a named nested list with parameter vectors for <code>"beta"</code>,
<code>"delta"</code> and <code>"lnsigma"</code> within all <code>1:K</code> components. The
names of the list correspond to the labels in <code>'lcoef'</code>,
<code>'lcpar'</code> and <code>'lcmp'</code>.
</p>

<hr>
<h2 id='aldvmm.gof'>Calculating Goodness of Fit Measures</h2><span id='topic+aldvmm.gof'></span>

<h3>Description</h3>

<p><code><a href="#topic+aldvmm.gof">aldvmm.gof</a></code>
calculates residual- and likelihood-based goodness of fit measures.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aldvmm.gof(res, par, ll)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aldvmm.gof_+3A_res">res</code></td>
<td>
<p>a numeric vector of residuals of all observations in the
estimation data.</p>
</td></tr>
<tr><td><code id="aldvmm.gof_+3A_par">par</code></td>
<td>
<p>a named numeric vector of parameter estimates.</p>
</td></tr>
<tr><td><code id="aldvmm.gof_+3A_ll">ll</code></td>
<td>
<p>a numeric value of the log-likelihood.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code><a href="#topic+aldvmm.gof">aldvmm.gof</a></code>
calculates mean squared errors as <code class="reqn">MSE = \frac{\sum_{i = 1}^{n} (y_{i}
  - \hat{y}_{i})^2}{n - k}</code>, and mean absolute
errors as <code class="reqn">MAE = \frac{\sum_{i = 1}^{n} y_{i} - \hat{y}_{i}}{n -
  k}</code>, where <code class="reqn">y_{i}</code> denotes observed
outcomes, <code class="reqn">\hat{y}_{i}</code> denotes fitted values, <code class="reqn">n</code>
denotes the sample size, and <code class="reqn">k</code> denotes the number of parameters.
The Akaike information criterion is calculated as <code class="reqn">2k - 2ll</code>, and the Bayesian information criterion is calculated as
<code class="reqn">k\log(n) - 2ll</code>, where <code class="reqn">ll</code> denotes the
log-likelihood.
</p>


<h3>Value</h3>

<p><code><a href="#topic+aldvmm.gof">aldvmm.gof</a></code>
returns a list including the following objects. </p>
<table>
<tr><td><code>mse</code></td>
<td>
<p>a
numeric value of the mean squared error of observed versus fitted
outcomes.</p>
</td></tr> <tr><td><code>mae</code></td>
<td>
<p>a numeric value of the mean absolute error of
observed versus fitted outcomes.</p>
</td></tr> <tr><td><code>ll</code></td>
<td>
<p>a numeric value of the
negative log-likelihood.</p>
</td></tr> <tr><td><code>aic</code></td>
<td>
<p>a numeric value of the Akaike
information criterion.</p>
</td></tr> <tr><td><code>bic</code></td>
<td>
<p>a numeric value of the Bayesian
information criterion.</p>
</td></tr>
</table>

<hr>
<h2 id='aldvmm.gr'>Calculating Numeric Gradients of the Negative Log-Likelihood</h2><span id='topic+aldvmm.gr'></span>

<h3>Description</h3>

<p><code><a href="#topic+aldvmm.gr">aldvmm.gr</a></code>
calculates numerical gradients of the negative log-likelihood of the entire
estimation data with respect to parameter values in <code>'par'</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aldvmm.gr(par, X, y, psi, dist, ncmp, lcoef, lcmp, lcpar, optim.method)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aldvmm.gr_+3A_par">par</code></td>
<td>
<p>a named numeric vector of parameter values.</p>
</td></tr>
<tr><td><code id="aldvmm.gr_+3A_x">X</code></td>
<td>
<p>a list of design matrices returned by
<code><a href="#topic+aldvmm.mm">aldvmm.mm</a></code>.
<code>'X'</code> is of length 2 and includes a design matrix for the model of
component distributions and a design matrix for the model of probabilities
of group membership.</p>
</td></tr>
<tr><td><code id="aldvmm.gr_+3A_y">y</code></td>
<td>
<p>a numeric vector of observed outcomes from complete observations in
<code>'data'</code> supplied to
<code><a href="#topic+aldvmm">aldvmm</a></code>.</p>
</td></tr>
<tr><td><code id="aldvmm.gr_+3A_psi">psi</code></td>
<td>
<p>a numeric vector of minimum and maximum possible utility values
smaller than or equal to 1 (e.g. <code>c(-0.594, 0.883)</code>). The potential
gap between the maximum value and 1 represents an area with zero density
in the value set from which utilities were obtained. The order of the
minimum and maximum limits in <code>'psi'</code> does not matter.</p>
</td></tr>
<tr><td><code id="aldvmm.gr_+3A_dist">dist</code></td>
<td>
<p>an optional character value of the distribution used in the
components. In this release, only the normal distribution is
available, and the default value is set to <code>"normal"</code>.</p>
</td></tr>
<tr><td><code id="aldvmm.gr_+3A_ncmp">ncmp</code></td>
<td>
<p>a numeric value of the number of components that are mixed. The
default value is 2. A value of 1 represents a tobit model with a gap
between 1 and the maximum value in <code>'psi'</code>.</p>
</td></tr>
<tr><td><code id="aldvmm.gr_+3A_lcoef">lcoef</code></td>
<td>
<p>a character vector of length 2 with labels of objects including
regression coefficients of component distributions (default <code>"beta"</code>)
and coefficients of probabilities of component membership (default
<code>"delta"</code>).</p>
</td></tr>
<tr><td><code id="aldvmm.gr_+3A_lcmp">lcmp</code></td>
<td>
<p>a character value representing a stub (default <code>"Comp"</code>)
for labeling objects including regression coefficients in different
components (e.g. &quot;Comp1&quot;, &quot;Comp2&quot;, ...). This label is also used in
summary tables returned by
<code><a href="#topic+summary.aldvmm">summary.aldvmm</a></code>.</p>
</td></tr>
<tr><td><code id="aldvmm.gr_+3A_lcpar">lcpar</code></td>
<td>
<p>a character vector with the labels of objects including
constant parameters of component distributions (e.g. the standard
deviation of the normal distribution). The length of <code>'lcpar'</code>
depends on the distribution supplied to <code>'dist'</code>.</p>
</td></tr>
<tr><td><code id="aldvmm.gr_+3A_optim.method">optim.method</code></td>
<td>
<p>an optional character value of one of the following
<code><a href="optimx.html#topic+optimr">optimr</a></code>
methods: <code>"Nelder-Mead"</code>, <code>"BFGS"</code>, <code>"CG"</code>,
<code>"L-BFGS-B"</code>, <code>"nlminb"</code>, <code>"Rcgmin"</code>, <code>"Rvmmin"</code> and
<code>"hjn"</code>. The default method is <code>"BFGS"</code>. The method
<code>"L-BFGS-B"</code> is used when lower and/or upper constraints are set
using <code>'init.lo'</code> and <code>'init.hi'</code>. The method <code>"nlm"</code>
cannot be used in the <code>'aldvmm'</code> package.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code><a href="#topic+aldvmm.gr">aldvmm.gr</a></code>
uses <code><a href="#topic+aldvmm.sc">aldvmm.sc</a></code> to
calculate analytical gradients of the negative log-likelihood.
</p>
<p>If <code>'par'</code> includes infinite values 
<code><a href="#topic+aldvmm.gr">aldvmm.gr</a></code> returns a 
gradient of zero.
</p>


<h3>Value</h3>

<p>a named numeric vector of first derivatives of the negative
log-likelihood of the data with respect to parameters in <code>'par'</code>.
</p>

<hr>
<h2 id='aldvmm.init'>Creating Initial Values</h2><span id='topic+aldvmm.init'></span>

<h3>Description</h3>

<p><code><a href="#topic+aldvmm.init">aldvmm.init</a></code>
creates initial values for the minimization of the negative log-likelihood
returned by
<code><a href="#topic+aldvmm.ll">aldvmm.ll</a></code> using
<code><a href="optimx.html#topic+optimr">optimr</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aldvmm.init(
  X,
  y,
  psi,
  ncmp,
  dist,
  init.method,
  init.est,
  init.lo,
  init.hi,
  optim.method,
  optim.control = list(),
  optim.grad,
  lcoef,
  lcpar,
  lcmp
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aldvmm.init_+3A_x">X</code></td>
<td>
<p>a list of design matrices returned by
<code><a href="#topic+aldvmm.mm">aldvmm.mm</a></code>.
<code>'X'</code> is of length 2 and includes a design matrix for the model of
component distributions and a design matrix for the model of probabilities
of group membership.</p>
</td></tr>
<tr><td><code id="aldvmm.init_+3A_y">y</code></td>
<td>
<p>a numeric vector of observed outcomes from complete observations in
<code>'data'</code> supplied to
<code><a href="#topic+aldvmm">aldvmm</a></code>.</p>
</td></tr>
<tr><td><code id="aldvmm.init_+3A_psi">psi</code></td>
<td>
<p>a numeric vector of minimum and maximum possible utility values
smaller than or equal to 1 (e.g. <code>c(-0.594, 0.883)</code>). The potential
gap between the maximum value and 1 represents an area with zero density
in the value set from which utilities were obtained. The order of the
minimum and maximum limits in <code>'psi'</code> does not matter.</p>
</td></tr>
<tr><td><code id="aldvmm.init_+3A_ncmp">ncmp</code></td>
<td>
<p>a numeric value of the number of components that are mixed. The
default value is 2. A value of 1 represents a tobit model with a gap
between 1 and the maximum value in <code>'psi'</code>.</p>
</td></tr>
<tr><td><code id="aldvmm.init_+3A_dist">dist</code></td>
<td>
<p>an optional character value of the distribution used in the
components. In this release, only the normal distribution is
available, and the default value is set to <code>"normal"</code>.</p>
</td></tr>
<tr><td><code id="aldvmm.init_+3A_init.method">init.method</code></td>
<td>
<p>an optional character value indicating the method for
obtaining initial values. The following values are available:
<code>"zero"</code>, <code>"random"</code>, <code>"constant"</code> and <code>"sann"</code>. The
default value is <code>"zero"</code>.</p>
</td></tr>
<tr><td><code id="aldvmm.init_+3A_init.est">init.est</code></td>
<td>
<p>an optional numeric vector of user-defined initial values.
User-defined initial values override the <code>'init.method'</code> argument.
Initial values have to follow the same order as parameter estimates in the
return value <code>'coef'</code>.</p>
</td></tr>
<tr><td><code id="aldvmm.init_+3A_init.lo">init.lo</code></td>
<td>
<p>an optional numeric vector of user-defined lower limits for
constrained optimization. When <code>'init.lo'</code> is not <code>NULL</code>, the
optimization method <code>"L-BFGS-B"</code> is used. Lower limits of parameters
have to follow the same order as parameter estimates in the return value
<code>'coef'</code>.</p>
</td></tr>
<tr><td><code id="aldvmm.init_+3A_init.hi">init.hi</code></td>
<td>
<p>an optional numeric vector of user-defined upper limits for
constrained optimization. When <code>'init.hi'</code> is not <code>NULL</code>, the
optimization method <code>"L-BFGS-B"</code> is used. Upper limits of parameters
have to follow the same order as parameter estimates in the return value
<code>'coef'</code>.</p>
</td></tr>
<tr><td><code id="aldvmm.init_+3A_optim.method">optim.method</code></td>
<td>
<p>an optional character value of one of the following
<code><a href="optimx.html#topic+optimr">optimr</a></code>
methods: <code>"Nelder-Mead"</code>, <code>"BFGS"</code>, <code>"CG"</code>,
<code>"L-BFGS-B"</code>, <code>"nlminb"</code>, <code>"Rcgmin"</code>, <code>"Rvmmin"</code> and
<code>"hjn"</code>. The default method is <code>"BFGS"</code>. The method
<code>"L-BFGS-B"</code> is used when lower and/or upper constraints are set
using <code>'init.lo'</code> and <code>'init.hi'</code>. The method <code>"nlm"</code>
cannot be used in the <code>'aldvmm'</code> package.</p>
</td></tr>
<tr><td><code id="aldvmm.init_+3A_optim.control">optim.control</code></td>
<td>
<p>an optional list of
<code><a href="optimx.html#topic+optimr">optimr</a></code>
control parameters.</p>
</td></tr>
<tr><td><code id="aldvmm.init_+3A_optim.grad">optim.grad</code></td>
<td>
<p>an optional logical value indicating if an analytical
gradient should be used in
<code><a href="optimx.html#topic+optimr">optimr</a></code>
methods that can use this information. The default value is <code>TRUE</code>.
If <code>'optim.grad'</code> is set to <code>FALSE</code>, a finite difference
approximation is used.</p>
</td></tr>
<tr><td><code id="aldvmm.init_+3A_lcoef">lcoef</code></td>
<td>
<p>a character vector of length 2 with labels of objects including
regression coefficients of component distributions (default <code>"beta"</code>)
and coefficients of probabilities of component membership (default
<code>"delta"</code>).</p>
</td></tr>
<tr><td><code id="aldvmm.init_+3A_lcpar">lcpar</code></td>
<td>
<p>a character vector with the labels of objects including
constant parameters of component distributions (e.g. the standard
deviation of the normal distribution). The length of <code>'lcpar'</code>
depends on the distribution supplied to <code>'dist'</code>.</p>
</td></tr>
<tr><td><code id="aldvmm.init_+3A_lcmp">lcmp</code></td>
<td>
<p>a character value representing a stub (default <code>"Comp"</code>)
for labeling objects including regression coefficients in different
components (e.g. &quot;Comp1&quot;, &quot;Comp2&quot;, ...). This label is also used in
summary tables returned by
<code><a href="#topic+summary.aldvmm">summary.aldvmm</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>'init.method'</code> accepts four methods for generating initial
values: <code>"zero"</code>, <code>"random"</code>, <code>"constant"</code>, <code>"sann"</code>.
The method <code>"zero"</code> sets initial values of all parameters to 0. The
method <code>"random"</code> draws random starting values from a standard normal
distribution.  The method <code>"constant"</code> estimates a constant-only
model and uses estimates as initial values for intercepts and constant
distribution parameters and 0 for all other parameters.  The method
<code>"sann"</code> estimates the full model using the simulated annealing
optimization method and uses all parameter estimates as initial values.
When user-specified initial values are supplied in <code>'init.est'</code>, the
argument <code>'init.method'</code> is ignored.
</p>
<p>By default, <code><a href="#topic+aldvmm">aldvmm</a></code>
performs unconstrained optimization with upper and lower limits at
<code>-Inf</code> and <code>Inf</code>.  When user-defined lower and upper limits are
supplied to <code>'init.lo'</code> and/or <code>'init-hi'</code>, these default limits
are replaced with the user-specified values, and the method
<code>"L-BFGS-B"</code> is used for box-constrained optimization instead of the
user defined <code>'optim.method'</code>.  It is possible to only set either
maximum or minimum limits.  When initial values supplied to 
<code>'init.est'</code> or from default methods lie outside the limits, the 
in-feasible values will be set to the limits using the function 
<code><a href="optimx.html#topic+bmchk">bmchk</a></code>.
</p>


<h3>Value</h3>

<p><code><a href="#topic+aldvmm.init">aldvmm.init</a></code>
returns a list with the following objects. </p>
<table>
<tr><td><code>est</code></td>
<td>
<p>a numeric
vector of initial values of parameters.</p>
</td></tr>
<tr><td><code>lo</code></td>
<td>
<p>a numeric vector of lower limits of parameters.</p>
</td></tr>
<tr><td><code>hi</code></td>
<td>
<p>a numeric vector of upper limits of parameters.</p>
</td></tr>
</table>

<hr>
<h2 id='aldvmm.ll'>Calculating the Negative Log-Likelihood of the Adjusted Limited Dependent
Variable Mixture Model</h2><span id='topic+aldvmm.ll'></span>

<h3>Description</h3>

<p><code><a href="#topic+aldvmm.ll">aldvmm.ll</a></code>
calculates the negative log-likelihood of <code>'data'</code> supplied to
<code><a href="#topic+aldvmm">aldvmm</a></code> at the
parameter values in <code>'par'</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aldvmm.ll(par, X, y, psi, ncmp, dist, lcoef, lcpar, lcmp, optim.method)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aldvmm.ll_+3A_par">par</code></td>
<td>
<p>a named numeric vector of parameter values.</p>
</td></tr>
<tr><td><code id="aldvmm.ll_+3A_x">X</code></td>
<td>
<p>a list of design matrices returned by
<code><a href="#topic+aldvmm.mm">aldvmm.mm</a></code>.
<code>'X'</code> is of length 2 and includes a design matrix for the model of
component distributions and a design matrix for the model of probabilities
of group membership.</p>
</td></tr>
<tr><td><code id="aldvmm.ll_+3A_y">y</code></td>
<td>
<p>a numeric vector of observed outcomes from complete observations in
<code>'data'</code> supplied to
<code><a href="#topic+aldvmm">aldvmm</a></code>.</p>
</td></tr>
<tr><td><code id="aldvmm.ll_+3A_psi">psi</code></td>
<td>
<p>a numeric vector of minimum and maximum possible utility values
smaller than or equal to 1 (e.g. <code>c(-0.594, 0.883)</code>). The potential
gap between the maximum value and 1 represents an area with zero density
in the value set from which utilities were obtained. The order of the
minimum and maximum limits in <code>'psi'</code> does not matter.</p>
</td></tr>
<tr><td><code id="aldvmm.ll_+3A_ncmp">ncmp</code></td>
<td>
<p>a numeric value of the number of components that are mixed. The
default value is 2. A value of 1 represents a tobit model with a gap
between 1 and the maximum value in <code>'psi'</code>.</p>
</td></tr>
<tr><td><code id="aldvmm.ll_+3A_dist">dist</code></td>
<td>
<p>an optional character value of the distribution used in the
components. In this release, only the normal distribution is
available, and the default value is set to <code>"normal"</code>.</p>
</td></tr>
<tr><td><code id="aldvmm.ll_+3A_lcoef">lcoef</code></td>
<td>
<p>a character vector of length 2 with labels of objects including
regression coefficients of component distributions (default <code>"beta"</code>)
and coefficients of probabilities of component membership (default
<code>"delta"</code>).</p>
</td></tr>
<tr><td><code id="aldvmm.ll_+3A_lcpar">lcpar</code></td>
<td>
<p>a character vector with the labels of objects including
constant parameters of component distributions (e.g. the standard
deviation of the normal distribution). The length of <code>'lcpar'</code>
depends on the distribution supplied to <code>'dist'</code>.</p>
</td></tr>
<tr><td><code id="aldvmm.ll_+3A_lcmp">lcmp</code></td>
<td>
<p>a character value representing a stub (default <code>"Comp"</code>)
for labeling objects including regression coefficients in different
components (e.g. &quot;Comp1&quot;, &quot;Comp2&quot;, ...). This label is also used in
summary tables returned by
<code><a href="#topic+summary.aldvmm">summary.aldvmm</a></code>.</p>
</td></tr>
<tr><td><code id="aldvmm.ll_+3A_optim.method">optim.method</code></td>
<td>
<p>an optional character value of one of the following
<code><a href="optimx.html#topic+optimr">optimr</a></code>
methods: <code>"Nelder-Mead"</code>, <code>"BFGS"</code>, <code>"CG"</code>,
<code>"L-BFGS-B"</code>, <code>"nlminb"</code>, <code>"Rcgmin"</code>, <code>"Rvmmin"</code> and
<code>"hjn"</code>. The default method is <code>"BFGS"</code>. The method
<code>"L-BFGS-B"</code> is used when lower and/or upper constraints are set
using <code>'init.lo'</code> and <code>'init.hi'</code>. The method <code>"nlm"</code>
cannot be used in the <code>'aldvmm'</code> package.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code><a href="#topic+aldvmm.ll">aldvmm.ll</a></code>
calculates the negative log-likelihood of the adjusted limited dependent
variable mixture model using the likelihood function published in
Hernandez Alava and Wailoo (2015). Constant distribution parameters that
need to be non-negative (i.e. the standard deviations of normal
distributions) enter the likelihood function as log-transformed values.
</p>
<p>As the &quot;L-BFGS-B&quot; and &quot;Rcgmin&quot; methods in
<code><a href="optimx.html#topic+optimr">optimr</a></code> fail
if they encounter infinite values, the log-likelihood function takes the
value -1e+20 if it is infinite during these algorithms.
</p>
<p>The names of the parameter vector supplied to <code>'par'</code> must be
generated using <code><a href="#topic+aldvmm.getnames">aldvmm.getnames</a></code> because they will be inherited by return values
of other functions in the package <code>'aldvmm'</code>. The names will also be
used in the extraction of parameters from parameter vectors into nested
lists using
<code><a href="#topic+aldvmm.getpar">aldvmm.getpar</a></code>.
</p>


<h3>Value</h3>

<p>a scalar of the negative log-likelihood of the data at parameter
values in <code>'par'</code>.
</p>


<h3>References</h3>

<p>Alava, M. H. and Wailoo, A. (2015) Fitting adjusted limited
dependent variable mixture models to EQ-5D. <em>The Stata Journal</em>,
<b>15(3)</b>, 737&ndash;750. <a href="https://doi.org/10.1177/1536867X1501500307">doi:10.1177/1536867X1501500307</a> <br />
</p>

<hr>
<h2 id='aldvmm.mm'>Creating Design Matrices</h2><span id='topic+aldvmm.mm'></span>

<h3>Description</h3>

<p><code><a href="#topic+aldvmm.mm">aldvmm.mm</a></code> creates
a list of two design matrices, one of the model of component distributions
(<code>"beta"</code>) and one of the model of probabilities of component
membership (<code>"delta"</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aldvmm.mm(mf, Formula, ncmp, lcoef)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aldvmm.mm_+3A_mf">mf</code></td>
<td>
<p>a data frame created by 
<code><a href="stats.html#topic+model.frame">model.frame</a></code> 
including the variables used in formula supplied to 
<code><a href="#topic+aldvmm">aldvmm</a></code> plus additional 
attributes, including an object of class &quot;terms&quot; derived from 
'formula'.</p>
</td></tr>
<tr><td><code id="aldvmm.mm_+3A_formula">Formula</code></td>
<td>
<p>an object of class &quot;Formula&quot; created by 
<code><a href="Formula.html#topic+Formula">Formula</a></code> based 
on the <code>formula</code> supplied to 
<code><a href="#topic+aldvmm">aldvmm</a></code>.</p>
</td></tr>
<tr><td><code id="aldvmm.mm_+3A_ncmp">ncmp</code></td>
<td>
<p>a numeric value of the number of components that are mixed. The
default value is 2. A value of 1 represents a tobit model with a gap
between 1 and the maximum value in <code>'psi'</code>.</p>
</td></tr>
<tr><td><code id="aldvmm.mm_+3A_lcoef">lcoef</code></td>
<td>
<p>a character vector of length 2 with labels of objects including
regression coefficients of component distributions (default <code>"beta"</code>)
and coefficients of probabilities of component membership (default
<code>"delta"</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code><a href="#topic+aldvmm.mm">aldvmm.mm</a></code>
uses
<code><a href="stats.html#topic+model.matrix">model.matrix</a></code>
to create design matrices for models of component distributions
(<code>"beta"</code>) and probabilities of component membership (<code>"delta"</code>)
based on a &quot;Formula&quot; object created by 
<code><a href="Formula.html#topic+Formula">Formula</a></code> 
and a model frame created by 
<code><a href="stats.html#topic+model.frame">model.frame</a></code>. 
The design matrix for probabilities of group membership is only created if
more than one components are specified in <code>'ncmp'</code>.
</p>


<h3>Value</h3>

<p>a named list of numeric matrices. </p>
<table>
<tr><td><code>beta</code></td>
<td>
<p>a numeric
design matrix for the model of component distributions.</p>
</td></tr>
<tr><td><code>delta</code></td>
<td>
<p>a numeric design matrix of the multinomial logit model
of probabilities of component membership.</p>
</td></tr>
</table>

<hr>
<h2 id='aldvmm.pred'>Predicting Expected Values from Adjusted Limited Dependent Variable Mixture
Models</h2><span id='topic+aldvmm.pred'></span>

<h3>Description</h3>

<p><code><a href="#topic+aldvmm.pred">aldvmm.pred</a></code> makes
predictions of observations in design matrices in <code>'X'</code> using parameter
estimates returned by
<code><a href="#topic+aldvmm">aldvmm</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aldvmm.pred(par, X, y = NULL, psi, ncmp, dist, lcoef, lcpar, lcmp)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aldvmm.pred_+3A_par">par</code></td>
<td>
<p>a named numeric vector of parameter values.</p>
</td></tr>
<tr><td><code id="aldvmm.pred_+3A_x">X</code></td>
<td>
<p>a list of design matrices returned by
<code><a href="#topic+aldvmm.mm">aldvmm.mm</a></code>.
<code>'X'</code> is of length 2 and includes a design matrix for the model of
component distributions and a design matrix for the model of probabilities
of group membership.</p>
</td></tr>
<tr><td><code id="aldvmm.pred_+3A_y">y</code></td>
<td>
<p>a numeric vector of observed outcomes from complete observations in
<code>'data'</code> supplied to
<code><a href="#topic+aldvmm">aldvmm</a></code>.</p>
</td></tr>
<tr><td><code id="aldvmm.pred_+3A_psi">psi</code></td>
<td>
<p>a numeric vector of minimum and maximum possible utility values
smaller than or equal to 1 (e.g. <code>c(-0.594, 0.883)</code>). The potential
gap between the maximum value and 1 represents an area with zero density
in the value set from which utilities were obtained. The order of the
minimum and maximum limits in <code>'psi'</code> does not matter.</p>
</td></tr>
<tr><td><code id="aldvmm.pred_+3A_ncmp">ncmp</code></td>
<td>
<p>a numeric value of the number of components that are mixed. The
default value is 2. A value of 1 represents a tobit model with a gap
between 1 and the maximum value in <code>'psi'</code>.</p>
</td></tr>
<tr><td><code id="aldvmm.pred_+3A_dist">dist</code></td>
<td>
<p>an optional character value of the distribution used in the
components. In this release, only the normal distribution is
available, and the default value is set to <code>"normal"</code>.</p>
</td></tr>
<tr><td><code id="aldvmm.pred_+3A_lcoef">lcoef</code></td>
<td>
<p>a character vector of length 2 with labels of objects including
regression coefficients of component distributions (default <code>"beta"</code>)
and coefficients of probabilities of component membership (default
<code>"delta"</code>).</p>
</td></tr>
<tr><td><code id="aldvmm.pred_+3A_lcpar">lcpar</code></td>
<td>
<p>a character vector with the labels of objects including
constant parameters of component distributions (e.g. the standard
deviation of the normal distribution). The length of <code>'lcpar'</code>
depends on the distribution supplied to <code>'dist'</code>.</p>
</td></tr>
<tr><td><code id="aldvmm.pred_+3A_lcmp">lcmp</code></td>
<td>
<p>a character value representing a stub (default <code>"Comp"</code>)
for labeling objects including regression coefficients in different
components (e.g. &quot;Comp1&quot;, &quot;Comp2&quot;, ...). This label is also used in
summary tables returned by
<code><a href="#topic+summary.aldvmm">summary.aldvmm</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code><a href="#topic+aldvmm.pred">aldvmm.pred</a></code>
calculates expected values for observations in design matrices in <code>'X'</code>
using the expected value function published in Hernandez Alava and Wailoo
(2015). Constant distribution parameters that need to be non-negative (i.e.
standard deviations of normal distributions) enter the expected value
function as log-transformed values.
</p>


<h3>Value</h3>

<p>a list of of predicted outcomes including the following elements.
</p>
<table>
<tr><td><code>y</code></td>
<td>
<p>a numeric vector of observed outcomes in <code>'data'</code>.</p>
</td></tr>
<tr><td><code>yhat</code></td>
<td>
<p>a numeric vector of fitted values.</p>
</td></tr> <tr><td><code>res</code></td>
<td>
<p>a
numeric vector of residuals.</p>
</td></tr> <tr><td><code>prob</code></td>
<td>
<p>a numeric matrix of expected 
probabilities of group membership per individual in <code>'data'</code>.</p>
</td></tr>
</table>

<hr>
<h2 id='aldvmm.sc'>Calculating analytical Gradients of the Negative Log-Likelihood for each observation</h2><span id='topic+aldvmm.sc'></span>

<h3>Description</h3>

<p><code><a href="#topic+aldvmm.sc">aldvmm.sc</a></code>
calculates analytical gradients of the negative log-likelihood with respect 
to parameter values in <code>'par'</code> for each observation in the estimation 
data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aldvmm.sc(
  par,
  X,
  y,
  psi,
  dist,
  ncmp,
  lcoef = lcoef,
  lcmp = lcmp,
  lcpar = lcpar,
  optim.method
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aldvmm.sc_+3A_par">par</code></td>
<td>
<p>a named numeric vector of parameter values.</p>
</td></tr>
<tr><td><code id="aldvmm.sc_+3A_x">X</code></td>
<td>
<p>a list of design matrices returned by
<code><a href="#topic+aldvmm.mm">aldvmm.mm</a></code>.
<code>'X'</code> is of length 2 and includes a design matrix for the model of
component distributions and a design matrix for the model of probabilities
of group membership.</p>
</td></tr>
<tr><td><code id="aldvmm.sc_+3A_y">y</code></td>
<td>
<p>a numeric vector of observed outcomes from complete observations in
<code>'data'</code> supplied to
<code><a href="#topic+aldvmm">aldvmm</a></code>.</p>
</td></tr>
<tr><td><code id="aldvmm.sc_+3A_psi">psi</code></td>
<td>
<p>a numeric vector of minimum and maximum possible utility values
smaller than or equal to 1 (e.g. <code>c(-0.594, 0.883)</code>). The potential
gap between the maximum value and 1 represents an area with zero density
in the value set from which utilities were obtained. The order of the
minimum and maximum limits in <code>'psi'</code> does not matter.</p>
</td></tr>
<tr><td><code id="aldvmm.sc_+3A_dist">dist</code></td>
<td>
<p>an optional character value of the distribution used in the
components. In this release, only the normal distribution is
available, and the default value is set to <code>"normal"</code>.</p>
</td></tr>
<tr><td><code id="aldvmm.sc_+3A_ncmp">ncmp</code></td>
<td>
<p>a numeric value of the number of components that are mixed. The
default value is 2. A value of 1 represents a tobit model with a gap
between 1 and the maximum value in <code>'psi'</code>.</p>
</td></tr>
<tr><td><code id="aldvmm.sc_+3A_lcoef">lcoef</code></td>
<td>
<p>a character vector of length 2 with labels of objects including
regression coefficients of component distributions (default <code>"beta"</code>)
and coefficients of probabilities of component membership (default
<code>"delta"</code>).</p>
</td></tr>
<tr><td><code id="aldvmm.sc_+3A_lcmp">lcmp</code></td>
<td>
<p>a character value representing a stub (default <code>"Comp"</code>)
for labeling objects including regression coefficients in different
components (e.g. &quot;Comp1&quot;, &quot;Comp2&quot;, ...). This label is also used in
summary tables returned by
<code><a href="#topic+summary.aldvmm">summary.aldvmm</a></code>.</p>
</td></tr>
<tr><td><code id="aldvmm.sc_+3A_lcpar">lcpar</code></td>
<td>
<p>a character vector with the labels of objects including
constant parameters of component distributions (e.g. the standard
deviation of the normal distribution). The length of <code>'lcpar'</code>
depends on the distribution supplied to <code>'dist'</code>.</p>
</td></tr>
<tr><td><code id="aldvmm.sc_+3A_optim.method">optim.method</code></td>
<td>
<p>an optional character value of one of the following
<code><a href="optimx.html#topic+optimr">optimr</a></code>
methods: <code>"Nelder-Mead"</code>, <code>"BFGS"</code>, <code>"CG"</code>,
<code>"L-BFGS-B"</code>, <code>"nlminb"</code>, <code>"Rcgmin"</code>, <code>"Rvmmin"</code> and
<code>"hjn"</code>. The default method is <code>"BFGS"</code>. The method
<code>"L-BFGS-B"</code> is used when lower and/or upper constraints are set
using <code>'init.lo'</code> and <code>'init.hi'</code>. The method <code>"nlm"</code>
cannot be used in the <code>'aldvmm'</code> package.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code><a href="#topic+aldvmm.sc">aldvmm.sc</a></code>
calculates gradients of the negative log-likelihood.
</p>


<h3>Value</h3>

<p>a named numeric matrix of first derivatives of the negative
log-likelihood of the data with respect to parameters in <code>'par'</code>.
</p>

<hr>
<h2 id='aldvmm.sefit'>Calculating Standard Errors of Fitted and Predicted Outcomes</h2><span id='topic+aldvmm.sefit'></span>

<h3>Description</h3>

<p><code><a href="#topic+aldvmm.sefit">aldvmm.sefit</a></code>
calculates standard errors of fitted and predicted outcomes using the delta
method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aldvmm.sefit(
  par,
  yhat,
  X,
  type,
  psi,
  cv,
  mse = NA,
  ncmp,
  dist,
  level,
  lcoef,
  lcmp,
  lcpar
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aldvmm.sefit_+3A_par">par</code></td>
<td>
<p>a named numeric vector of parameter values.</p>
</td></tr>
<tr><td><code id="aldvmm.sefit_+3A_yhat">yhat</code></td>
<td>
<p>a numeric vector of predicted outcomes returned by
<code><a href="#topic+aldvmm.pred">aldvmm.pred</a></code>.</p>
</td></tr>
<tr><td><code id="aldvmm.sefit_+3A_x">X</code></td>
<td>
<p>a list of design matrices returned by
<code><a href="#topic+aldvmm.mm">aldvmm.mm</a></code>.
<code>'X'</code> is of length 2 and includes a design matrix for the model of
component distributions and a design matrix for the model of probabilities
of group membership.</p>
</td></tr>
<tr><td><code id="aldvmm.sefit_+3A_type">type</code></td>
<td>
<p>a character value of either 'fit' or 'pred' indicating whether
the standard error of the fit ('fit') or the standard error of predictions
in new data ('pred') are calculated.</p>
</td></tr>
<tr><td><code id="aldvmm.sefit_+3A_psi">psi</code></td>
<td>
<p>a numeric vector of minimum and maximum possible utility values
smaller than or equal to 1 (e.g. <code>c(-0.594, 0.883)</code>). The potential
gap between the maximum value and 1 represents an area with zero density
in the value set from which utilities were obtained. The order of the
minimum and maximum limits in <code>'psi'</code> does not matter.</p>
</td></tr>
<tr><td><code id="aldvmm.sefit_+3A_cv">cv</code></td>
<td>
<p>a numeric matrix with covariances/variances of parameter estimates
returned by
<code><a href="#topic+aldvmm.cv">aldvmm.cv</a></code>.</p>
</td></tr>
<tr><td><code id="aldvmm.sefit_+3A_mse">mse</code></td>
<td>
<p>a numeric value of the mean squared error of observed versus
predicted outcomes <code class="reqn">\sum{(y - \hat{y})^2}/(n_{obs} - n_{par})</code> for all observations in model matrices
<code>'X'</code> supplied to
<code><a href="#topic+aldvmm.ll">aldvmm.ll</a></code>.</p>
</td></tr>
<tr><td><code id="aldvmm.sefit_+3A_ncmp">ncmp</code></td>
<td>
<p>a numeric value of the number of components that are mixed. The
default value is 2. A value of 1 represents a tobit model with a gap
between 1 and the maximum value in <code>'psi'</code>.</p>
</td></tr>
<tr><td><code id="aldvmm.sefit_+3A_dist">dist</code></td>
<td>
<p>an optional character value of the distribution used in the
components. In this release, only the normal distribution is
available, and the default value is set to <code>"normal"</code>.</p>
</td></tr>
<tr><td><code id="aldvmm.sefit_+3A_level">level</code></td>
<td>
<p>a numeric value of the significance level for confidence bands
of fitted values. The default value is 0.95.</p>
</td></tr>
<tr><td><code id="aldvmm.sefit_+3A_lcoef">lcoef</code></td>
<td>
<p>a character vector of length 2 with labels of objects including
regression coefficients of component distributions (default <code>"beta"</code>)
and coefficients of probabilities of component membership (default
<code>"delta"</code>).</p>
</td></tr>
<tr><td><code id="aldvmm.sefit_+3A_lcmp">lcmp</code></td>
<td>
<p>a character value representing a stub (default <code>"Comp"</code>)
for labeling objects including regression coefficients in different
components (e.g. &quot;Comp1&quot;, &quot;Comp2&quot;, ...). This label is also used in
summary tables returned by
<code><a href="#topic+summary.aldvmm">summary.aldvmm</a></code>.</p>
</td></tr>
<tr><td><code id="aldvmm.sefit_+3A_lcpar">lcpar</code></td>
<td>
<p>a character vector with the labels of objects including
constant parameters of component distributions (e.g. the standard
deviation of the normal distribution). The length of <code>'lcpar'</code>
depends on the distribution supplied to <code>'dist'</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code><a href="#topic+aldvmm.sefit">aldvmm.sefit</a></code>
calculates standard errors of fitted values using the delta method. Standard
errors of fitted values in the estimation data set are calculated as
<code class="reqn">se_{fit} = \sqrt{G^{t} \Sigma G}</code>,
where <code class="reqn">G</code> is the gradient of a fitted value with respect to changes of
parameter estimates, and <code class="reqn">\Sigma</code> is the estimated covariance matrix of
parameters (Dowd et al., 2014).  Standard errors of predicted values in new
data sets are calculated as <code class="reqn">se_{pred} = \sqrt{MSE + G^{t} \Sigma
G}</code>, where <code class="reqn">MSE</code> is the
mean squared error of fitted versus observed outcomes in the original
estimation data (Whitmore, 1986).  The gradients of fitted values with
respect to parameter estimates are approximated numerically using
<code><a href="numDeriv.html#topic+jacobian">jacobian</a></code>.
</p>


<h3>Value</h3>

<p>a named numeric vector of standard errors of fitted or predicted
outcomes. The names of the elements in the vector are identical to the row
names of design matrices in <code>'X'</code>
</p>


<h3>References</h3>

<p>Whitmore, G. A. (1986). Prediction limits for a univariate
normal observation. The American Statistician, 40(2), 141-143.
https://doi.org/10.1080/00031305.1986.10475378 <br />
</p>
<p>Dowd, B. E., Greene, W. H., and Norton, E. C. (2014) Computation of
standard errors. <em>Health services research</em>, <b>49(2)</b>, 731&ndash;750.
<a href="https://doi.org/10.1111/1475-6773.12122">doi:10.1111/1475-6773.12122</a>
</p>

<hr>
<h2 id='aldvmm.sum'>Creating Summary Table</h2><span id='topic+aldvmm.sum'></span>

<h3>Description</h3>

<p><code><a href="#topic+aldvmm.sum">aldvmm.sum</a></code>
creates a summary table of regression results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aldvmm.sum(object, digits = max(3L, getOption("digits") - 3L), level = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aldvmm.sum_+3A_object">object</code></td>
<td>
<p>an <code><a href="#topic+aldvmm">aldvmm</a></code> model fit object of class &quot;aldvmm&quot;.</p>
</td></tr>
<tr><td><code id="aldvmm.sum_+3A_digits">digits</code></td>
<td>
<p>a numeric value of the number of digits in the reporting
table.</p>
</td></tr>
<tr><td><code id="aldvmm.sum_+3A_level">level</code></td>
<td>
<p>a numeric value of the confidence level.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>data.frame</code> object with a summary table of regression results.
</p>

<hr>
<h2 id='aldvmm.tm'>Creating Terms Objects</h2><span id='topic+aldvmm.tm'></span>

<h3>Description</h3>

<p><code><a href="#topic+aldvmm.tm">aldvmm.tm</a></code> creates
a list of up to three &quot;terms&quot; objects, one of the model of component distributions
(<code>"beta"</code>), one of the model of probabilities of component
membership (<code>"delta"</code>) and one for the full model (<code>"full"</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aldvmm.tm(mf, Formula, ncmp, lcoef)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aldvmm.tm_+3A_mf">mf</code></td>
<td>
<p>a data frame created by 
<code><a href="stats.html#topic+model.frame">model.frame</a></code> 
including the variables used in <code>'formula'</code> supplied to 
<code><a href="#topic+aldvmm">aldvmm</a></code> plus 
additional attributes derived from <code>'formula'</code>.</p>
</td></tr>
<tr><td><code id="aldvmm.tm_+3A_formula">Formula</code></td>
<td>
<p>an object of class &quot;Formula&quot; created by 
<code><a href="Formula.html#topic+Formula">Formula</a></code> 
based on the <code>'formula'</code> supplied to 
<code><a href="#topic+aldvmm">aldvmm</a></code>.</p>
</td></tr>
<tr><td><code id="aldvmm.tm_+3A_ncmp">ncmp</code></td>
<td>
<p>a numeric value of the number of components that are mixed. The
default value is 2. A value of 1 represents a tobit model with a gap
between 1 and the maximum value in <code>'psi'</code>.</p>
</td></tr>
<tr><td><code id="aldvmm.tm_+3A_lcoef">lcoef</code></td>
<td>
<p>a character vector of length 2 with labels of objects including
regression coefficients of component distributions (default <code>"beta"</code>)
and coefficients of probabilities of component membership (default
<code>"delta"</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code><a href="#topic+aldvmm.tm">aldvmm.tm</a></code>
uses
<code><a href="stats.html#topic+terms">terms</a></code>
to create &quot;terms&quot; objects based on a &quot;Formula&quot; object 
created by 
<code><a href="Formula.html#topic+Formula">Formula</a></code> 
and a model frame created by 
<code><a href="stats.html#topic+model.frame">model.frame</a></code>. 
The &quot;terms&quot; object for probabilities of group membership is only created if
more than one components are specified in <code>'ncmp'</code>.
</p>


<h3>Value</h3>

<p>a named list of objects of class &quot;terms&quot;. 
</p>
<table>
<tr><td><code>beta</code></td>
<td>
<p>a &quot;terms&quot; object for the model of component 
distributions.</p>
</td></tr>
<tr><td><code>delta</code></td>
<td>
<p>a &quot;terms&quot; object of the multinomial logit model
of probabilities of component membership.</p>
</td></tr>
<tr><td><code>full</code></td>
<td>
<p>a &quot;terms&quot; object of the full model.</p>
</td></tr>
</table>

<hr>
<h2 id='coef.aldvmm'>Extract Coefficients of Adjusted Limited Dependent Variable Mixture 
Model Fits</h2><span id='topic+coef.aldvmm'></span>

<h3>Description</h3>

<p>The method <code>coef.aldvmm</code> for the generic function
<code><a href="stats.html#topic+coef">coef</a></code> extracts the 
vector of coefficients from an object of class &quot;aldvmm&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'aldvmm'
coef(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coef.aldvmm_+3A_object">object</code></td>
<td>
<p>an object inheriting from class &quot;aldvmm&quot;.</p>
</td></tr>
<tr><td><code id="coef.aldvmm_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a named numeric vector of parameter estimates.
</p>

<hr>
<h2 id='estfun.aldvmm'>Create Matrix of Adjusted Limited Dependent Variable Mixture Model Gradients per Observation</h2><span id='topic+estfun.aldvmm'></span>

<h3>Description</h3>

<p>The method <code>estfun.aldvmm</code> for the generic function 
<code><a href="sandwich.html#topic+estfun">estfun</a></code> calculates the gradient of the aldvmm 
log-likelihood using with respect to parameter values for each observation
<code><a href="#topic+aldvmm.sc">aldvmm.sc</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'aldvmm'
estfun(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estfun.aldvmm_+3A_x">x</code></td>
<td>
<p>an object inheriting from class &quot;aldvmm&quot;.</p>
</td></tr>
<tr><td><code id="estfun.aldvmm_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a numeric matrix of gradients with one row per 
observation and one column per parameter.
</p>

<hr>
<h2 id='formula.aldvmm'>Extract Adjusted Limited Dependent Variable Mixture Model Formula</h2><span id='topic+formula.aldvmm'></span>

<h3>Description</h3>

<p>The method <code>formula.aldvmm</code> for the generic function
<code><a href="stats.html#topic+formula">formula</a></code> returns the 
formula object from an object of class &quot;aldvmm&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'aldvmm'
formula(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="formula.aldvmm_+3A_x">x</code></td>
<td>
<p>an object inheriting from class &quot;aldvmm&quot;.</p>
</td></tr>
<tr><td><code id="formula.aldvmm_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of class &quot;formula&quot;
</p>

<hr>
<h2 id='model.matrix.aldvmm'>Extract Adjusted Limited Dependent Variable Mixture Model Model Matrices</h2><span id='topic+model.matrix.aldvmm'></span>

<h3>Description</h3>

<p>The method
<code>model.matrix.aldvmm</code> for the generic function <code><a href="stats.html#topic+model.matrix">model.matrix</a></code> extracts a list of model matrices from an object 
of class &quot;aldvmm&quot; using the function 
<code><a href="#topic+aldvmm.mm">aldvmm.mm</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'aldvmm'
model.matrix(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="model.matrix.aldvmm_+3A_object">object</code></td>
<td>
<p>an object inheriting from class &quot;aldvmm&quot;.</p>
</td></tr>
<tr><td><code id="model.matrix.aldvmm_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a named list of numeric matrices. 
</p>
<table>
<tr><td><code>beta</code></td>
<td>
<p>a numeric design matrix for the model of component 
distributions.</p>
</td></tr>
<tr><td><code>delta</code></td>
<td>
<p>a numeric design matrix of the multinomial logit model
of probabilities of component membership.</p>
</td></tr>
</table>

<hr>
<h2 id='nobs.aldvmm'>Extract Adjusted Limited Dependent Variable Mixture Model Number of Observations</h2><span id='topic+nobs.aldvmm'></span>

<h3>Description</h3>

<p>The method <code>nobs.aldvmm</code> for the generic function
<code><a href="stats.html#topic+nobs">nobs</a></code> extracts the 
number of observations from an object of class &quot;aldvmm&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'aldvmm'
nobs(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nobs.aldvmm_+3A_object">object</code></td>
<td>
<p>an object inheriting from class &quot;aldvmm&quot;.</p>
</td></tr>
<tr><td><code id="nobs.aldvmm_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a scalar of the number of complete 
observations.
</p>

<hr>
<h2 id='predict.aldvmm'>Predict Method for Adjusted Limited Dependent Variable Mixture Model Fits</h2><span id='topic+predict.aldvmm'></span>

<h3>Description</h3>

<p>The method <code>predict.aldvmm</code> for the generic function
<code><a href="stats.html#topic+predict">predict</a></code> calls
<code><a href="#topic+aldvmm.pred">aldvmm.pred</a></code> and <code><a href="#topic+aldvmm.sefit">aldvmm.sefit</a></code> to
predict outcomes and their standard errors in new data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'aldvmm'
predict(
  object,
  newdata = NULL,
  se.fit = FALSE,
  type = "pred",
  level = 0.95,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.aldvmm_+3A_object">object</code></td>
<td>
<p>an object inheriting from class 'aldvmm'.</p>
</td></tr>
<tr><td><code id="predict.aldvmm_+3A_newdata">newdata</code></td>
<td>
<p>a data frame, list or environment (or object coercible to a
data frame by <br /> <code><a href="base.html#topic+as.data.frame">as.data.frame</a></code>) including explanatory variables for
prediction.</p>
</td></tr>
<tr><td><code id="predict.aldvmm_+3A_se.fit">se.fit</code></td>
<td>
<p>an optional logical value indicating whether standard errors
of fitted values are calculated. The default value is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="predict.aldvmm_+3A_type">type</code></td>
<td>
<p>a character value of either 'fit' or 'pred' indicating whether
the standard error of the fit ('fit') or the standard error of predictions
in new data ('pred') are calculated.</p>
</td></tr>
<tr><td><code id="predict.aldvmm_+3A_level">level</code></td>
<td>
<p>a numeric value of the significance level for confidence bands
of fitted values. The default value is 0.95.</p>
</td></tr>
<tr><td><code id="predict.aldvmm_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a named list of numeric vectors of predicted outcomes, standard
errors and confidence or prediction intervals.
</p>

<hr>
<h2 id='print.aldvmm'>Print Adjusted Limited Dependent Variable Mixture Model Fits</h2><span id='topic+print.aldvmm'></span>

<h3>Description</h3>

<p>The method <code>print.aldvmm</code> for the generic function
<code><a href="base.html#topic+print">print</a></code> prints a 
summary of an object of class &quot;aldvmm&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'aldvmm'
print(x, digits = max(3L, getOption("digits") - 3L), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.aldvmm_+3A_x">x</code></td>
<td>
<p>an object inheriting from class &quot;aldvmm&quot;.</p>
</td></tr>
<tr><td><code id="print.aldvmm_+3A_digits">digits</code></td>
<td>
<p>an integer value of the number of digits in the printed 
output.</p>
</td></tr>
<tr><td><code id="print.aldvmm_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>

<hr>
<h2 id='print.summary.aldvmm'>Printing Adjusted Limited Dependent Variable Mixture Model Summaries</h2><span id='topic+print.summary.aldvmm'></span>

<h3>Description</h3>

<p>The method <code>print.summary.aldvmm</code> for the generic function
<code><a href="base.html#topic+print">print</a></code> prints a 
summary of an object of class &quot;summary.aldvmm&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.aldvmm'
print(x, digits = max(3L, getOption("digits") - 3L), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.summary.aldvmm_+3A_x">x</code></td>
<td>
<p>an object inheriting from class 'summary.aldvmm'.</p>
</td></tr>
<tr><td><code id="print.summary.aldvmm_+3A_digits">digits</code></td>
<td>
<p>an integer value of the number of digits in the output table.</p>
</td></tr>
<tr><td><code id="print.summary.aldvmm_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>

<hr>
<h2 id='residuals.aldvmm'>Extract Adjusted Limited Dependent Variable Mixture Model Residuals</h2><span id='topic+residuals.aldvmm'></span>

<h3>Description</h3>

<p>The method <code>residuals.aldvmm</code> for the generic function
<code><a href="stats.html#topic+residuals">residuals</a></code> returns the 
covariance matrix from an object of class &quot;aldvmm&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'aldvmm'
residuals(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="residuals.aldvmm_+3A_object">object</code></td>
<td>
<p>an object inheriting from class &quot;aldvmm&quot;.</p>
</td></tr>
<tr><td><code id="residuals.aldvmm_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a numeric vector of residuals.
</p>

<hr>
<h2 id='summary.aldvmm'>Summarizing Adjusted Limited Dependent Variable Mixture Model Fits</h2><span id='topic+summary.aldvmm'></span>

<h3>Description</h3>

<p>The method <code>summary.aldvmm</code> for the generic function
<code><a href="base.html#topic+summary">summary</a></code> creates 
an object of class &quot;summary.aldvmm&quot; including key results from an object of 
class &quot;aldvmm&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'aldvmm'
summary(object, digits = max(3L, getOption("digits") - 3L), level = 0.95, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.aldvmm_+3A_object">object</code></td>
<td>
<p>an object inheriting from class 'aldvmm'.</p>
</td></tr>
<tr><td><code id="summary.aldvmm_+3A_digits">digits</code></td>
<td>
<p>an integer value of the number of digits in the output table.</p>
</td></tr>
<tr><td><code id="summary.aldvmm_+3A_level">level</code></td>
<td>
<p>a numeric value of the confidence interval between 0 and 1.</p>
</td></tr>
<tr><td><code id="summary.aldvmm_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>summary.aldvmm</code> returns an object of class &quot;summary.aldvmm&quot; 
including the following elements. 
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>a character value including the model call captured by
<code><a href="base.html#topic+match.call">match.call</a></code>.</p>
</td></tr>
<tr><td><code>summary</code></td>
<td>
<p>a data frame generated by 
<code><a href="#topic+aldvmm.sum">aldvmm.sum</a></code> 
including a formatted summary of model results for printing.</p>
</td></tr>
<tr><td><code>terms</code></td>
<td>
<p>a list of objects of class
<code><a href="stats.html#topic+terms">terms</a></code>.</p>
</td></tr>
<tr><td><code>contrasts</code></td>
<td>
<p>a nested list of character values showing 
contrasts of factors used in models of component means (&quot;beta&quot;) and 
probabilities of component membership (&quot;delta&quot;).</p>
</td></tr>
<tr><td><code>coef</code></td>
<td>
<p>a
numeric vector of parameter estimates.</p>
</td></tr>
<tr><td><code>cov</code></td>
<td>
<p>a numeric matrix object with covariances of parameters.</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>a scalar representing the number of complete observations
with no missing values that were used in the estimation.</p>
</td></tr>
<tr><td><code>df.residual</code></td>
<td>
<p>an integer value of the residual 
degrees of freedom.</p>
</td></tr>
<tr><td><code>df.null</code></td>
<td>
<p>an integer value of the residual 
degrees of freedom of a null model including intercepts and standard errors.</p>
</td></tr>
<tr><td><code>iter</code></td>
<td>
<p>an integer value of the number of iterations used in 
optimization.</p>
</td></tr>
<tr><td><code>ll</code></td>
<td>
<p>a numeric value of the negative log-likelihood
<code class="reqn">-ll</code>.</p>
</td></tr>
<tr><td><code>aic</code></td>
<td>
<p>a numeric value of the Akaike information
criterion <code class="reqn">AIC = 2n_{par} - 2ll</code>.</p>
</td></tr>
<tr><td><code>bic</code></td>
<td>
<p>a numeric value of the Bayesian information criterion
<code class="reqn">BIC = n_{par}*log(n_{obs}) - 2ll</code>.</p>
</td></tr>
<tr><td><code>k</code></td>
<td>
<p>a numeric value of the number of components.</p>
</td></tr>
<tr><td><code>lcoef</code></td>
<td>
<p>a character vector of labels for objects including
results on distributions (default <code>"beta"</code>) and the probabilities of
component membership (default <code>"delta"</code>).</p>
</td></tr> 
<tr><td><code>lcpar</code></td>
<td>
<p>a
character vector of labels for objects including constant distribution
parameters (default <code>"sigma"</code> for <code>dist = "normal"</code>).</p>
</td></tr>
<tr><td><code>lcmp</code></td>
<td>
<p>a character value of the label for objects including
results on different components (default &quot;Comp&quot;)</p>
</td></tr> 
<tr><td><code>lvar</code></td>
<td>
<p>a
list including 2 character vectors of covariate names for model parameters
of distributions (<code>"beta"</code>) and the multinomial logit
(<code>"delta"</code>).</p>
</td></tr>
</table>

<hr>
<h2 id='terms.aldvmm'>Extract Adjusted Limited Dependent Variable Mixture Model Terms</h2><span id='topic+terms.aldvmm'></span>

<h3>Description</h3>

<p>The method <code>terms.aldvmm</code> for the generic function
<code><a href="stats.html#topic+terms">terms</a></code> returns the 
terms object for the combined model of component means and probabilities of
component membership from an object of class &quot;aldvmm&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'aldvmm'
terms(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="terms.aldvmm_+3A_x">x</code></td>
<td>
<p>an object inheriting from class &quot;aldvmm&quot;.</p>
</td></tr>
<tr><td><code id="terms.aldvmm_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of class &quot;terms&quot;
</p>

<hr>
<h2 id='update.aldvmm'>Update Adjusted Limited Dependent Variable Mixture Model Fit</h2><span id='topic+update.aldvmm'></span>

<h3>Description</h3>

<p>The method <code>update.aldvmm</code> for the generic function
<code><a href="stats.html#topic+update">update</a></code>
re-estimates an object of class &quot;aldvmm&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'aldvmm'
update(object, formula., ..., evaluate = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="update.aldvmm_+3A_object">object</code></td>
<td>
<p>an object inheriting from class &quot;aldvmm&quot;.</p>
</td></tr>
<tr><td><code id="update.aldvmm_+3A_formula.">formula.</code></td>
<td>
<p>a formula object representing the new model.</p>
</td></tr>
<tr><td><code id="update.aldvmm_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
<tr><td><code id="update.aldvmm_+3A_evaluate">evaluate</code></td>
<td>
<p>a logical value indicating if the model should be
re-estimated (TRUE) or not (FALSE).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of class &quot;aldvmm&quot;
</p>

<hr>
<h2 id='utility'>Simulated Example Data of Health State Utilities.</h2><span id='topic+utility'></span>

<h3>Description</h3>

<p><code><a href="#topic+utility">utility</a></code> is
a simulated data frame including health state utilities and patients' age
and sex.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>utility
</code></pre>


<h3>Format</h3>

<p>A data frame with 200 rows and 3 variables:</p>

<table>
<tr>
 <td style="text-align: left;">
  <code>utility</code> </td><td style="text-align: left;"> a utility value {[-0.594, 0.883], 1}. </td>
</tr>
<tr>
 <td style="text-align: left;"> </td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
  <code>age</code> </td><td style="text-align: left;"> Age in years. </td>
</tr>
<tr>
 <td style="text-align: left;"> </td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;"> <code>female</code> </td><td style="text-align: left;"> Indicator of
  female sex. </td>
</tr>
<tr>
 <td style="text-align: left;"> </td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;"> </td>
</tr>

</table>



<h3>Examples</h3>

<pre><code class='language-R'>set.seed(101010101)
utility                 &lt;- data.frame(female = rbinom(size = 1,
                                      n      = 200,
                                      p      = 0.6))
utility[, 'age']        &lt;- stats::rnorm(n    = 200,
                                        mean = 50 + utility$female*10,
                                        sd   = 15)
utility[1:50, 'eq5d']   &lt;- stats::rnorm(n    = 50,
                                        mean = 0 - 0.1 *
                                              utility[1:50, 'female'] +
                                              0.0005 * utility[1:50, 'age'],
                                        sd   = 0.1)
utility[51:200, 'eq5d'] &lt;- stats::rnorm(n    = 150,
                                        mean = 0.5 +
                                           0.1 * utility[51:200, 'female'] +
                                           0.0001*utility[51:200, 'age'],
                                        sd   = 0.2)
utility[utility$eq5d&lt;(-0.594), 'eq5d'] &lt;- -0.594
utility[utility$eq5d&gt;0.883, 'eq5d'] &lt;- 1
hist(utility$eq5d, breaks = 50)

</code></pre>

<hr>
<h2 id='vcov.aldvmm'>Extract Adjusted Limited Dependent Variable Mixture Model Covariance Matrix</h2><span id='topic+vcov.aldvmm'></span>

<h3>Description</h3>

<p>The method <code>vcov.aldvmm</code> for the generic function
<code><a href="stats.html#topic+vcov">vcov</a></code> returns the 
covariance matrix from an object of class &quot;aldvmm&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'aldvmm'
vcov(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vcov.aldvmm_+3A_object">object</code></td>
<td>
<p>an object inheriting from class &quot;aldvmm&quot;.</p>
</td></tr>
<tr><td><code id="vcov.aldvmm_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a numeric matrix.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
